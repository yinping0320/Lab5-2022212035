/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Injectable } from '@angular/core';
import { WindowVariableService } from '../window-service/window-variable.service';
import * as i0 from "@angular/core";
/**
 * @record
 */
function TabEntity() { }
if (false) {
    /** @type {?} */
    TabEntity.prototype.tabId;
    /** @type {?|undefined} */
    TabEntity.prototype.code;
    /** @type {?|undefined} */
    TabEntity.prototype.name;
    /** @type {?} */
    TabEntity.prototype.appType;
    /** @type {?} */
    TabEntity.prototype.funcId;
    /** @type {?} */
    TabEntity.prototype.appId;
    /** @type {?} */
    TabEntity.prototype.appEntrance;
}
var TabEntityService = /** @class */ (function () {
    function TabEntityService() {
        this.nameSpace = 'gsp-rtf-tabarr-service';
        this.tabarrayKey = 'tab-arry';
        this.windowService = new WindowVariableService();
        this.topWin = this.windowService.getTopWindow();
        this.topWin[this.nameSpace] = this.topWin[this.nameSpace] || {};
    }
    /**
     * @param {?} tabs
     * @return {?}
     */
    TabEntityService.prototype.setTabs = /**
     * @param {?} tabs
     * @return {?}
     */
    function (tabs) {
        if (!tabs || tabs.length === 0) {
            return;
        }
        /** @type {?} */
        var copy = this.deepClone(tabs);
        this.topWin[this.nameSpace][this.tabarrayKey] = copy;
    };
    /**
     * @return {?}
     */
    TabEntityService.prototype.getTabs = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var tabs = this.topWin[this.nameSpace][this.tabarrayKey] || [];
        if (!tabs || tabs.length === 0) {
            return tabs;
        }
        return this.deepClone(tabs);
    };
    /**
     * @param {?} tab
     * @return {?}
     */
    TabEntityService.prototype.setActiveTab = /**
     * @param {?} tab
     * @return {?}
     */
    function (tab) {
        /** @type {?} */
        var tabs = this.getTabs();
        /** @type {?} */
        var activeOld = tabs.find((/**
         * @param {?} t
         * @return {?}
         */
        function (t) { return t.active; }));
        if (!tab) {
            if (!!activeOld) {
                activeOld.active = false;
            }
            return;
        }
        if (tabs.length > 0) {
            /** @type {?} */
            var activeNew = tabs.find((/**
             * @param {?} t
             * @return {?}
             */
            function (t) { return t.id === tab.id; }));
            if (!activeNew) {
                activeNew = tab;
                if (!!activeOld) {
                    activeOld.active = false;
                }
                activeNew.active = true;
                tabs.push(activeNew);
            }
            else {
                if (!!activeOld) {
                    if (activeOld === activeNew) {
                        return;
                    }
                    else {
                        activeOld.active = false;
                        activeNew.active = true;
                    }
                }
                else {
                    activeNew.active = true;
                }
            }
            this.setTabs(tabs);
        }
    };
    /**
     * @return {?}
     */
    TabEntityService.prototype.getActiveTab = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var tabs = this.getTabs();
        /** @type {?} */
        var activeTab = tabs && tabs.find((/**
         * @param {?} t
         * @return {?}
         */
        function (t) { return t.active; }));
        /** @type {?} */
        var res = activeTab && {
            tabId: activeTab.id,
            appType: activeTab.appType,
            funcId: activeTab.funcId,
            appId: activeTab.appId,
            appEntrance: activeTab.appEntrance,
            name: activeTab.FuncName
        };
        return res;
    };
    /**
     * @private
     * @param {?} target
     * @return {?}
     */
    TabEntityService.prototype.deepClone = /**
     * @private
     * @param {?} target
     * @return {?}
     */
    function (target) {
        /** @type {?} */
        var result;
        if (typeof target === 'object') {
            if (Array.isArray(target)) {
                result = [];
                for (var i in target) {
                    result.push(this.deepClone(target[i]));
                }
            }
            else if (target === null) {
                result = null;
            }
            else if (target.constructor === RegExp) {
                result = target;
            }
            else {
                result = {};
                for (var i in target) {
                    result[i] = this.deepClone(target[i]);
                }
            }
        }
        else {
            result = target;
        }
        return result;
    };
    TabEntityService.decorators = [
        { type: Injectable, args: [{
                    providedIn: 'root'
                },] }
    ];
    /** @nocollapse */
    TabEntityService.ctorParameters = function () { return []; };
    /** @nocollapse */ TabEntityService.ngInjectableDef = i0.defineInjectable({ factory: function TabEntityService_Factory() { return new TabEntityService(); }, token: TabEntityService, providedIn: "root" });
    return TabEntityService;
}());
export { TabEntityService };
if (false) {
    /**
     * @type {?}
     * @private
     */
    TabEntityService.prototype.nameSpace;
    /**
     * @type {?}
     * @private
     */
    TabEntityService.prototype.tabarrayKey;
    /**
     * @type {?}
     * @private
     */
    TabEntityService.prototype.windowService;
    /**
     * @type {?}
     * @private
     */
    TabEntityService.prototype.topWin;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidGFiLWVudGl0eS5zZXJ2aWNlLmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGVjcC1jYWYvY2FmLWNvbW1vbi8iLCJzb3VyY2VzIjpbImxpYi9zZXJ2aWNlcy90YWJzZXJ2aWNlL3RhYi1lbnRpdHkuc2VydmljZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7O0FBQUEsT0FBTyxFQUFFLFVBQVUsRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUMzQyxPQUFPLEVBQUUscUJBQXFCLEVBQUUsTUFBTSwyQ0FBMkMsQ0FBQzs7Ozs7QUFFbEYsd0JBUUM7OztJQVBHLDBCQUFjOztJQUNkLHlCQUFjOztJQUNkLHlCQUFjOztJQUNkLDRCQUFnQjs7SUFDaEIsMkJBQWU7O0lBQ2YsMEJBQWM7O0lBQ2QsZ0NBQW9COztBQUd4QjtJQVdJO1FBTlEsY0FBUyxHQUFHLHdCQUF3QixDQUFDO1FBQ3JDLGdCQUFXLEdBQUcsVUFBVSxDQUFDO1FBTTdCLElBQUksQ0FBQyxhQUFhLEdBQUcsSUFBSSxxQkFBcUIsRUFBRSxDQUFDO1FBQ2pELElBQUksQ0FBQyxNQUFNLEdBQUcsSUFBSSxDQUFDLGFBQWEsQ0FBQyxZQUFZLEVBQUUsQ0FBQztRQUNoRCxJQUFJLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUMsR0FBRyxJQUFJLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUMsSUFBSSxFQUFFLENBQUM7SUFDcEUsQ0FBQzs7Ozs7SUFFTSxrQ0FBTzs7OztJQUFkLFVBQWUsSUFBVztRQUN0QixJQUFJLENBQUMsSUFBSSxJQUFJLElBQUksQ0FBQyxNQUFNLEtBQUssQ0FBQyxFQUFFO1lBQzVCLE9BQU87U0FDVjs7WUFDSyxJQUFJLEdBQUcsSUFBSSxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUM7UUFDakMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxHQUFHLElBQUksQ0FBQztJQUN6RCxDQUFD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QyxJQUFJLENBQUMsU0FBUyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUE7aUJBQ3pDO2FBQ0o7aUJBQU0sSUFBSSxNQUFNLEtBQUssSUFBSSxFQUFFO2dCQUN4QixNQUFNLEdBQUcsSUFBSSxDQUFDO2FBQ2pCO2lCQUFNLElBQUksTUFBTSxDQUFDLFdBQVcsS0FBSyxNQUFNLEVBQUU7Z0JBQ3RDLE1BQU0sR0FBRyxNQUFNLENBQUM7YUFDbkI7aUJBQU07Z0JBQ0gsTUFBTSxHQUFHLEVBQUUsQ0FBQztnQkFDWixLQUFLLElBQUksQ0FBQyxJQUFJLE1BQU0sRUFBRTtvQkFDbEIsTUFBTSxDQUFDLENBQUMsQ0FBQyxHQUFHLElBQUksQ0FBQyxTQUFTLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7aUJBQ3pDO2FBQ0o7U0FDSjthQUFNO1lBQ0gsTUFBTSxHQUFHLE1BQU0sQ0FBQztTQUNuQjtRQUNELE9BQU8sTUFBTSxDQUFDO0lBQ2xCLENBQUM7O2dCQXhHSixVQUFVLFNBQUM7b0JBQ1IsVUFBVSxFQUFFLE1BQU07aUJBQ3JCOzs7OzsyQkFmRDtDQXNIQyxBQXpHRCxJQXlHQztTQXRHWSxnQkFBZ0I7Ozs7OztJQUV6QixxQ0FBNkM7Ozs7O0lBQzdDLHVDQUFpQzs7Ozs7SUFDakMseUNBQTZDOzs7OztJQUM3QyxrQ0FBdUIiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBJbmplY3RhYmxlIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IFdpbmRvd1ZhcmlhYmxlU2VydmljZSB9IGZyb20gJy4uL3dpbmRvdy1zZXJ2aWNlL3dpbmRvdy12YXJpYWJsZS5zZXJ2aWNlJztcclxuXHJcbmludGVyZmFjZSBUYWJFbnRpdHkge1xyXG4gICAgdGFiSWQ6IHN0cmluZztcclxuICAgIGNvZGU/OiBzdHJpbmc7XHJcbiAgICBuYW1lPzogc3RyaW5nO1xyXG4gICAgYXBwVHlwZTogc3RyaW5nO1xyXG4gICAgZnVuY0lkOiBzdHJpbmc7XHJcbiAgICBhcHBJZDogc3RyaW5nO1xyXG4gICAgYXBwRW50cmFuY2U6IHN0cmluZztcclxufVxyXG5cclxuQEluamVjdGFibGUoe1xyXG4gICAgcHJvdmlkZWRJbjogJ3Jvb3QnXHJcbn0pXHJcbmV4cG9ydCBjbGFzcyBUYWJFbnRpdHlTZXJ2aWNlIHtcclxuXHJcbiAgICBwcml2YXRlIG5hbWVTcGFjZSA9ICdnc3AtcnRmLXRhYmFyci1zZXJ2aWNlJztcclxuICAgIHByaXZhdGUgdGFiYXJyYXlLZXkgPSAndGFiLWFycnknO1xyXG4gICAgcHJpdmF0ZSB3aW5kb3dTZXJ2aWNlOiBXaW5kb3dWYXJpYWJsZVNlcnZpY2U7XHJcbiAgICBwcml2YXRlIHRvcFdpbjogV2luZG93O1xyXG5cclxuXHJcbiAgICBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICB0aGlzLndpbmRvd1NlcnZpY2UgPSBuZXcgV2luZG93VmFyaWFibGVTZXJ2aWNlKCk7XHJcbiAgICAgICAgdGhpcy50b3BXaW4gPSB0aGlzLndpbmRvd1NlcnZpY2UuZ2V0VG9wV2luZG93KCk7XHJcbiAgICAgICAgdGhpcy50b3BXaW5bdGhpcy5uYW1lU3BhY2VdID0gdGhpcy50b3BXaW5bdGhpcy5uYW1lU3BhY2VdIHx8IHt9O1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBzZXRUYWJzKHRhYnM6IGFueVtdKSB7XHJcbiAgICAgICAgaWYgKCF0YWJzIHx8IHRhYnMubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgY29weSA9IHRoaXMuZGVlcENsb25lKHRhYnMpO1xyXG4gICAgICAgIHRoaXMudG9wV2luW3RoaXMubmFtZVNwYWNlXVt0aGlzLnRhYmFycmF5S2V5XSA9IGNvcHk7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGdldFRhYnMoKTogYW55W10ge1xyXG4gICAgICAgIGNvbnN0IHRhYnMgPSB0aGlzLnRvcFdpblt0aGlzLm5hbWVTcGFjZV1bdGhpcy50YWJhcnJheUtleV0gfHwgW107XHJcbiAgICAgICAgaWYgKCF0YWJzIHx8IHRhYnMubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0YWJzO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdGhpcy5kZWVwQ2xvbmUodGFicyk7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIHNldEFjdGl2ZVRhYih0YWI6IGFueSkge1xyXG4gICAgICAgIGNvbnN0IHRhYnM6IGFueVtdID0gdGhpcy5nZXRUYWJzKCk7XHJcbiAgICAgICAgY29uc3QgYWN0aXZlT2xkID0gdGFicy5maW5kKHQgPT4gdC5hY3RpdmUpO1xyXG4gICAgICAgIGlmICghdGFiKSB7XHJcbiAgICAgICAgICAgIGlmICghIWFjdGl2ZU9sZCkge1xyXG4gICAgICAgICAgICAgICAgYWN0aXZlT2xkLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICh0YWJzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgbGV0IGFjdGl2ZU5ldyA9IHRhYnMuZmluZCh0ID0+IHQuaWQgPT09IHRhYi5pZCk7XHJcbiAgICAgICAgICAgIGlmICghYWN0aXZlTmV3KSB7XHJcbiAgICAgICAgICAgICAgICBhY3RpdmVOZXcgPSB0YWI7XHJcbiAgICAgICAgICAgICAgICBpZiAoISFhY3RpdmVPbGQpIHtcclxuICAgICAgICAgICAgICAgICAgICBhY3RpdmVPbGQuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBhY3RpdmVOZXcuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIHRhYnMucHVzaChhY3RpdmVOZXcpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgaWYgKCEhYWN0aXZlT2xkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGFjdGl2ZU9sZCA9PT0gYWN0aXZlTmV3KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhY3RpdmVPbGQuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGl2ZU5ldy5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYWN0aXZlTmV3LmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5zZXRUYWJzKHRhYnMpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgZ2V0QWN0aXZlVGFiKCk6IGFueSB7XHJcbiAgICAgICAgY29uc3QgdGFiczogYW55W10gPSB0aGlzLmdldFRhYnMoKTtcclxuICAgICAgICBjb25zdCBhY3RpdmVUYWIgPSB0YWJzICYmIHRhYnMuZmluZCh0ID0+IHQuYWN0aXZlKTtcclxuICAgICAgICBjb25zdCByZXM6IFRhYkVudGl0eSA9IGFjdGl2ZVRhYiAmJiB7XHJcbiAgICAgICAgICAgIHRhYklkOiBhY3RpdmVUYWIuaWQsXHJcbiAgICAgICAgICAgIGFwcFR5cGU6IGFjdGl2ZVRhYi5hcHBUeXBlLFxyXG4gICAgICAgICAgICBmdW5jSWQ6IGFjdGl2ZVRhYi5mdW5jSWQsXHJcbiAgICAgICAgICAgIGFwcElkOiBhY3RpdmVUYWIuYXBwSWQsXHJcbiAgICAgICAgICAgIGFwcEVudHJhbmNlOiBhY3RpdmVUYWIuYXBwRW50cmFuY2UsXHJcbiAgICAgICAgICAgIG5hbWU6IGFjdGl2ZVRhYi5GdW5jTmFtZVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgcmV0dXJuIHJlcztcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGRlZXBDbG9uZSh0YXJnZXQ6IGFueSk6IGFueSB7XHJcbiAgICAgICAgbGV0IHJlc3VsdDtcclxuICAgICAgICBpZiAodHlwZW9mIHRhcmdldCA9PT0gJ29iamVjdCcpIHtcclxuICAgICAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkodGFyZ2V0KSkge1xyXG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gW107XHJcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBpIGluIHRhcmdldCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdC5wdXNoKHRoaXMuZGVlcENsb25lKHRhcmdldFtpXSkpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodGFyZ2V0ID09PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICByZXN1bHQgPSBudWxsO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHRhcmdldC5jb25zdHJ1Y3RvciA9PT0gUmVnRXhwKSB7XHJcbiAgICAgICAgICAgICAgICByZXN1bHQgPSB0YXJnZXQ7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByZXN1bHQgPSB7fTtcclxuICAgICAgICAgICAgICAgIGZvciAobGV0IGkgaW4gdGFyZ2V0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0W2ldID0gdGhpcy5kZWVwQ2xvbmUodGFyZ2V0W2ldKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHJlc3VsdCA9IHRhcmdldDtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgIH1cclxufVxyXG4iXX0=