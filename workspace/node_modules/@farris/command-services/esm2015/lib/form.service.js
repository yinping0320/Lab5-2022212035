import { Injectable, Injector } from "@angular/core";
import { AppContext, Repository } from "@farris/devkit";
export class FormService {
    constructor(injector, appContext, repository) {
        this.injector = injector;
        this.appContext = appContext;
        this.repository = repository;
    }
    /**
     * 根据字段路径获取该字段在卡片或表格中的索引
     * @param source ngFormControls或any[][]
     * @param propertyPath 字段除bindingPath之外的完整路径
     * @returns
     */
    getIndex(source, propertyPath) {
        if (Array.isArray(source)) {
            const combine = source.reduce((result, group) => {
                return result.concat(group);
            }, []);
            return combine.findIndex((item) => item.field === propertyPath);
        }
        else if (Object.prototype.toString.call(source) === '[object Object]') {
            return Object.keys(source).findIndex(key => source[key].binding === propertyPath);
        }
    }
}
FormService.decorators = [
    { type: Injectable }
];
/** @nocollapse */
FormService.ctorParameters = () => [
    { type: Injector },
    { type: AppContext },
    { type: Repository }
];
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZm9ybS5zZXJ2aWNlLmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGZhcnJpcy9jb21tYW5kLXNlcnZpY2VzLyIsInNvdXJjZXMiOlsibGliL2Zvcm0uc2VydmljZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsVUFBVSxFQUFFLFFBQVEsRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUNyRCxPQUFPLEVBQUUsVUFBVSxFQUFtRSxVQUFVLEVBQUUsTUFBTSxnQkFBZ0IsQ0FBQztBQUd6SCxNQUFNLE9BQU8sV0FBVztJQUN0QixZQUNVLFFBQWtCLEVBQ2xCLFVBQXNCLEVBQ3RCLFVBQThCO1FBRjlCLGFBQVEsR0FBUixRQUFRLENBQVU7UUFDbEIsZUFBVSxHQUFWLFVBQVUsQ0FBWTtRQUN0QixlQUFVLEdBQVYsVUFBVSxDQUFvQjtJQUV4QyxDQUFDO0lBQ0Q7Ozs7O09BS0c7SUFDSSxRQUFRLENBQUMsTUFBeUQsRUFBRSxZQUFvQjtRQUM3RixJQUFJLEtBQUssQ0FBQyxPQUFPLENBQUMsTUFBTSxDQUFDLEVBQUU7WUFDekIsTUFBTSxPQUFPLEdBQVUsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLE1BQWEsRUFBRSxLQUFZLEVBQUUsRUFBRTtnQkFDbkUsT0FBTyxNQUFNLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFDO1lBQzlCLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQztZQUNQLE9BQU8sT0FBTyxDQUFDLFNBQVMsQ0FBQyxDQUFDLElBQVMsRUFBRSxFQUFFLENBQUMsSUFBSSxDQUFDLEtBQUssS0FBSyxZQUFZLENBQUMsQ0FBQztTQUN0RTthQUFNLElBQUksTUFBTSxDQUFDLFNBQVMsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxLQUFLLGlCQUFpQixFQUFFO1lBQ3ZFLE9BQU8sTUFBTSxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQyxTQUFTLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUMsT0FBTyxLQUFLLFlBQVksQ0FBQyxDQUFDO1NBQ25GO0lBQ0gsQ0FBQzs7O1lBdkJGLFVBQVU7Ozs7WUFIVSxRQUFRO1lBQ3BCLFVBQVU7WUFBbUUsVUFBVSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEluamVjdGFibGUsIEluamVjdG9yIH0gZnJvbSBcIkBhbmd1bGFyL2NvcmVcIjtcclxuaW1wb3J0IHsgQXBwQ29udGV4dCwgRGF0YVByb3BJbmZvLCBEYXRhVHlwZUluZm8sIEVudGl0eSwgRnJhbWVDb250ZXh0LCBOZ0Zvcm1Db250cm9sLCBSZXBvc2l0b3J5IH0gZnJvbSBcIkBmYXJyaXMvZGV2a2l0XCI7XHJcblxyXG5ASW5qZWN0YWJsZSgpXHJcbmV4cG9ydCBjbGFzcyBGb3JtU2VydmljZSB7XHJcbiAgY29uc3RydWN0b3IoXHJcbiAgICBwcml2YXRlIGluamVjdG9yOiBJbmplY3RvcixcclxuICAgIHByaXZhdGUgYXBwQ29udGV4dDogQXBwQ29udGV4dCxcclxuICAgIHByaXZhdGUgcmVwb3NpdG9yeTogUmVwb3NpdG9yeTxFbnRpdHk+XHJcbiAgKSB7XHJcbiAgfVxyXG4gIC8qKlxyXG4gICAqIOagueaNruWtl+autei3r+W+hOiOt+WPluivpeWtl+auteWcqOWNoeeJh+aIluihqOagvOS4reeahOe0ouW8lVxyXG4gICAqIEBwYXJhbSBzb3VyY2UgbmdGb3JtQ29udHJvbHPmiJZhbnlbXVtdXHJcbiAgICogQHBhcmFtIHByb3BlcnR5UGF0aCDlrZfmrrXpmaRiaW5kaW5nUGF0aOS5i+WklueahOWujOaVtOi3r+W+hFxyXG4gICAqIEByZXR1cm5zIFxyXG4gICAqL1xyXG4gIHB1YmxpYyBnZXRJbmRleChzb3VyY2U6IHsgW3Byb3BlcnR5TmFtZTogc3RyaW5nXTogTmdGb3JtQ29udHJvbCB9IHwgYW55W10sIHByb3BlcnR5UGF0aDogc3RyaW5nKSB7XHJcbiAgICBpZiAoQXJyYXkuaXNBcnJheShzb3VyY2UpKSB7XHJcbiAgICAgIGNvbnN0IGNvbWJpbmU6IGFueVtdID0gc291cmNlLnJlZHVjZSgocmVzdWx0OiBhbnlbXSwgZ3JvdXA6IGFueVtdKSA9PiB7XHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdC5jb25jYXQoZ3JvdXApO1xyXG4gICAgICB9LCBbXSk7XHJcbiAgICAgIHJldHVybiBjb21iaW5lLmZpbmRJbmRleCgoaXRlbTogYW55KSA9PiBpdGVtLmZpZWxkID09PSBwcm9wZXJ0eVBhdGgpO1xyXG4gICAgfSBlbHNlIGlmIChPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoc291cmNlKSA9PT0gJ1tvYmplY3QgT2JqZWN0XScpIHtcclxuICAgICAgcmV0dXJuIE9iamVjdC5rZXlzKHNvdXJjZSkuZmluZEluZGV4KGtleSA9PiBzb3VyY2Vba2V5XS5iaW5kaW5nID09PSBwcm9wZXJ0eVBhdGgpO1xyXG4gICAgfVxyXG4gIH1cclxuICBcclxufSJdfQ==