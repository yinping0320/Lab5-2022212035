import { Injectable } from '@angular/core';
import { ViewModel } from '@farris/devkit';
import { FilterConditionService } from '../filter-condition.service';
import { CommandService } from '../command-service';
var FilterConditionDataService = /** @class */ (function () {
    function FilterConditionDataService(viewModel, filterConditionService, commandService) {
        this.viewModel = viewModel;
        this.filterConditionService = filterConditionService;
        this.commandService = commandService;
    }
    /**
     * 执行过滤
     * @param commandName 命令名称
     * @param frameId 命令所在的frameId
     */
    FilterConditionDataService.prototype.filter = function (commandName, frameId) {
        var self = this;
        var filters = self.context && self.context.eventParam && self.context.eventParam.data || [];
        if (typeof (filters) === 'string') {
            filters = JSON.parse(filters);
        }
        // 查询时重置页码为第一页
        this.viewModel.frameContext.repository.entityCollection.pageIndex = 1;
        this.viewModel.frameContext.repository.filterConditionManager.setConditions(this.viewModel.bindingPath, filters);
        return this.commandService.execute(commandName, frameId);
    };
    FilterConditionDataService.decorators = [
        { type: Injectable }
    ];
    /** @nocollapse */
    FilterConditionDataService.ctorParameters = function () { return [
        { type: ViewModel },
        { type: FilterConditionService },
        { type: CommandService }
    ]; };
    return FilterConditionDataService;
}());
export { FilterConditionDataService };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZmlsdGVyLWNvbmRpdGlvbi1kYXRhLnNlcnZpY2UuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZmFycmlzL2NvbW1hbmQtc2VydmljZXMvIiwic291cmNlcyI6WyJsaWIvZGF0YS1zZXJ2aWNlcy9maWx0ZXItY29uZGl0aW9uLWRhdGEuc2VydmljZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsVUFBVSxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBQzNDLE9BQU8sRUFBRSxTQUFTLEVBQUUsTUFBTSxnQkFBZ0IsQ0FBQztBQUMzQyxPQUFPLEVBQUUsc0JBQXNCLEVBQUUsTUFBTSw2QkFBNkIsQ0FBQztBQUNyRSxPQUFPLEVBQUUsY0FBYyxFQUFFLE1BQU0sb0JBQW9CLENBQUM7QUFFcEQ7SUFFSSxvQ0FDWSxTQUFvQixFQUNwQixzQkFBOEMsRUFDOUMsY0FBOEI7UUFGOUIsY0FBUyxHQUFULFNBQVMsQ0FBVztRQUNwQiwyQkFBc0IsR0FBdEIsc0JBQXNCLENBQXdCO1FBQzlDLG1CQUFjLEdBQWQsY0FBYyxDQUFnQjtJQUN0QyxDQUFDO0lBRUw7Ozs7T0FJRztJQUNJLDJDQUFNLEdBQWIsVUFBYyxXQUFtQixFQUFFLE9BQWU7UUFDOUMsSUFBTSxJQUFJLEdBQVEsSUFBSSxDQUFDO1FBQ3ZCLElBQUksT0FBTyxHQUFHLElBQUksQ0FBQyxPQUFPLElBQUksSUFBSSxDQUFDLE9BQU8sQ0FBQyxVQUFVLElBQUksSUFBSSxDQUFDLE9BQU8sQ0FBQyxVQUFVLENBQUMsSUFBSSxJQUFJLEVBQUUsQ0FBQztRQUM1RixJQUFJLE9BQU8sQ0FBQyxPQUFPLENBQUMsS0FBSyxRQUFRLEVBQUU7WUFDL0IsT0FBTyxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLENBQUM7U0FDakM7UUFDRCxjQUFjO1FBQ2QsSUFBSSxDQUFDLFNBQVMsQ0FBQyxZQUFZLENBQUMsVUFBVSxDQUFDLGdCQUFnQixDQUFDLFNBQVMsR0FBRyxDQUFDLENBQUM7UUFDdEUsSUFBSSxDQUFDLFNBQVMsQ0FBQyxZQUFZLENBQUMsVUFBVSxDQUFDLHNCQUFzQixDQUFDLGFBQWEsQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLFdBQVcsRUFBRSxPQUFPLENBQUMsQ0FBQztRQUNqSCxPQUFPLElBQUksQ0FBQyxjQUFjLENBQUMsT0FBTyxDQUFDLFdBQVcsRUFBRSxPQUFPLENBQUMsQ0FBQztJQUM3RCxDQUFDOztnQkF2QkosVUFBVTs7OztnQkFKRixTQUFTO2dCQUNULHNCQUFzQjtnQkFDdEIsY0FBYzs7SUEwQnZCLGlDQUFDO0NBQUEsQUF4QkQsSUF3QkM7QUFDRCxPQUFPLEVBQUUsMEJBQTBCLEVBQUUsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEluamVjdGFibGUgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgVmlld01vZGVsIH0gZnJvbSAnQGZhcnJpcy9kZXZraXQnO1xyXG5pbXBvcnQgeyBGaWx0ZXJDb25kaXRpb25TZXJ2aWNlIH0gZnJvbSAnLi4vZmlsdGVyLWNvbmRpdGlvbi5zZXJ2aWNlJztcclxuaW1wb3J0IHsgQ29tbWFuZFNlcnZpY2UgfSBmcm9tICcuLi9jb21tYW5kLXNlcnZpY2UnO1xyXG5cclxuQEluamVjdGFibGUoKVxyXG5jbGFzcyBGaWx0ZXJDb25kaXRpb25EYXRhU2VydmljZSB7XHJcbiAgICBjb25zdHJ1Y3RvcihcclxuICAgICAgICBwcml2YXRlIHZpZXdNb2RlbDogVmlld01vZGVsLFxyXG4gICAgICAgIHByaXZhdGUgZmlsdGVyQ29uZGl0aW9uU2VydmljZTogRmlsdGVyQ29uZGl0aW9uU2VydmljZSxcclxuICAgICAgICBwcml2YXRlIGNvbW1hbmRTZXJ2aWNlOiBDb21tYW5kU2VydmljZVxyXG4gICAgKSB7IH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOaJp+ihjOi/h+a7pFxyXG4gICAgICogQHBhcmFtIGNvbW1hbmROYW1lIOWRveS7pOWQjeensFxyXG4gICAgICogQHBhcmFtIGZyYW1lSWQg5ZG95Luk5omA5Zyo55qEZnJhbWVJZFxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgZmlsdGVyKGNvbW1hbmROYW1lOiBzdHJpbmcsIGZyYW1lSWQ6IHN0cmluZykge1xyXG4gICAgICAgIGNvbnN0IHNlbGY6IGFueSA9IHRoaXM7XHJcbiAgICAgICAgbGV0IGZpbHRlcnMgPSBzZWxmLmNvbnRleHQgJiYgc2VsZi5jb250ZXh0LmV2ZW50UGFyYW0gJiYgc2VsZi5jb250ZXh0LmV2ZW50UGFyYW0uZGF0YSB8fCBbXTtcclxuICAgICAgICBpZiAodHlwZW9mIChmaWx0ZXJzKSA9PT0gJ3N0cmluZycpIHtcclxuICAgICAgICAgICAgZmlsdGVycyA9IEpTT04ucGFyc2UoZmlsdGVycyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIOafpeivouaXtumHjee9rumhteeggeS4uuesrOS4gOmhtVxyXG4gICAgICAgIHRoaXMudmlld01vZGVsLmZyYW1lQ29udGV4dC5yZXBvc2l0b3J5LmVudGl0eUNvbGxlY3Rpb24ucGFnZUluZGV4ID0gMTtcclxuICAgICAgICB0aGlzLnZpZXdNb2RlbC5mcmFtZUNvbnRleHQucmVwb3NpdG9yeS5maWx0ZXJDb25kaXRpb25NYW5hZ2VyLnNldENvbmRpdGlvbnModGhpcy52aWV3TW9kZWwuYmluZGluZ1BhdGgsIGZpbHRlcnMpO1xyXG4gICAgICAgIHJldHVybiB0aGlzLmNvbW1hbmRTZXJ2aWNlLmV4ZWN1dGUoY29tbWFuZE5hbWUsIGZyYW1lSWQpO1xyXG4gICAgfVxyXG59XHJcbmV4cG9ydCB7IEZpbHRlckNvbmRpdGlvbkRhdGFTZXJ2aWNlIH07XHJcbiJdfQ==