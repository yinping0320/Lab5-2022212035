import { UID } from '@farris/devkit';
var MessagePipe = /** @class */ (function () {
    function MessagePipe(token, rtfService) {
        this.token = token;
        this.rtfService = rtfService;
    }
    /**
     * 向管道发送消息
     * @param message 消息
     */
    MessagePipe.prototype.sendMessage = function (message) {
        this.rtfService.subjectNotify(this.token, message);
        return this;
    };
    /**
     * 监听管道消息
     * @param handler 消息处理器
     */
    MessagePipe.prototype.listen = function (handler) {
        var _this = this;
        var observerToken = UID.create();
        this.rtfService.subjectResponse(this.token, handler, observerToken);
        var unListen = function () {
            _this.rtfService.responseUnSubscribe(_this.token, observerToken);
        };
        return unListen;
    };
    /**
     * 销毁管道
     */
    MessagePipe.prototype.destory = function () {
        this.rtfService.subjectRemove(this.token);
    };
    return MessagePipe;
}());
export { MessagePipe };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWVzc2FnZS1waXBlLmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGZhcnJpcy9jb21tYW5kLXNlcnZpY2VzLyIsInNvdXJjZXMiOlsibGliL3J0Zi1tZXNzYWdlL21lc3NhZ2UtcGlwZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFDQSxPQUFPLEVBQUUsR0FBRyxFQUFFLE1BQU0sZ0JBQWdCLENBQUM7QUFFckM7SUFDSSxxQkFBbUIsS0FBYSxFQUFVLFVBQW1DO1FBQTFELFVBQUssR0FBTCxLQUFLLENBQVE7UUFBVSxlQUFVLEdBQVYsVUFBVSxDQUF5QjtJQUFJLENBQUM7SUFDbEY7OztPQUdHO0lBQ0ksaUNBQVcsR0FBbEIsVUFBbUIsT0FBWTtRQUMzQixJQUFJLENBQUMsVUFBVSxDQUFDLGFBQWEsQ0FBQyxJQUFJLENBQUMsS0FBSyxFQUFFLE9BQU8sQ0FBQyxDQUFDO1FBQ25ELE9BQU8sSUFBSSxDQUFDO0lBQ2hCLENBQUM7SUFDRDs7O09BR0c7SUFDSSw0QkFBTSxHQUFiLFVBQWMsT0FBNEI7UUFBMUMsaUJBT0M7UUFORyxJQUFNLGFBQWEsR0FBRyxHQUFHLENBQUMsTUFBTSxFQUFFLENBQUM7UUFDbkMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxlQUFlLENBQUMsSUFBSSxDQUFDLEtBQUssRUFBRSxPQUFPLEVBQUUsYUFBYSxDQUFDLENBQUM7UUFDcEUsSUFBTSxRQUFRLEdBQUc7WUFDYixLQUFJLENBQUMsVUFBVSxDQUFDLG1CQUFtQixDQUFDLEtBQUksQ0FBQyxLQUFLLEVBQUUsYUFBYSxDQUFDLENBQUM7UUFDbkUsQ0FBQyxDQUFDO1FBQ0YsT0FBTyxRQUFRLENBQUM7SUFDcEIsQ0FBQztJQUNEOztPQUVHO0lBQ0ksNkJBQU8sR0FBZDtRQUNJLElBQUksQ0FBQyxVQUFVLENBQUMsYUFBYSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQztJQUM5QyxDQUFDO0lBQ0wsa0JBQUM7QUFBRCxDQUFDLEFBNUJELElBNEJDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUnVudGltZUZyYW1ld29ya1NlcnZpY2UgfSBmcm9tICcuLi9ydGYtc2VydmljZSc7XHJcbmltcG9ydCB7IFVJRCB9IGZyb20gJ0BmYXJyaXMvZGV2a2l0JztcclxuXHJcbmV4cG9ydCBjbGFzcyBNZXNzYWdlUGlwZSB7XHJcbiAgICBjb25zdHJ1Y3RvcihwdWJsaWMgdG9rZW46IHN0cmluZywgcHJpdmF0ZSBydGZTZXJ2aWNlOiBSdW50aW1lRnJhbWV3b3JrU2VydmljZSkgeyB9XHJcbiAgICAvKipcclxuICAgICAqIOWQkeeuoemBk+WPkemAgea2iOaBr1xyXG4gICAgICogQHBhcmFtIG1lc3NhZ2Ug5raI5oGvXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBzZW5kTWVzc2FnZShtZXNzYWdlOiBhbnkpIHtcclxuICAgICAgICB0aGlzLnJ0ZlNlcnZpY2Uuc3ViamVjdE5vdGlmeSh0aGlzLnRva2VuLCBtZXNzYWdlKTtcclxuICAgICAgICByZXR1cm4gdGhpcztcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICog55uR5ZCs566h6YGT5raI5oGvXHJcbiAgICAgKiBAcGFyYW0gaGFuZGxlciDmtojmga/lpITnkIblmahcclxuICAgICAqL1xyXG4gICAgcHVibGljIGxpc3RlbihoYW5kbGVyOiAoZGF0YTogYW55KSA9PiB2b2lkKTogKCkgPT4gdm9pZCB7XHJcbiAgICAgICAgY29uc3Qgb2JzZXJ2ZXJUb2tlbiA9IFVJRC5jcmVhdGUoKTtcclxuICAgICAgICB0aGlzLnJ0ZlNlcnZpY2Uuc3ViamVjdFJlc3BvbnNlKHRoaXMudG9rZW4sIGhhbmRsZXIsIG9ic2VydmVyVG9rZW4pO1xyXG4gICAgICAgIGNvbnN0IHVuTGlzdGVuID0gKCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLnJ0ZlNlcnZpY2UucmVzcG9uc2VVblN1YnNjcmliZSh0aGlzLnRva2VuLCBvYnNlcnZlclRva2VuKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHJldHVybiB1bkxpc3RlbjtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICog6ZSA5q+B566h6YGTXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBkZXN0b3J5KCkge1xyXG4gICAgICAgIHRoaXMucnRmU2VydmljZS5zdWJqZWN0UmVtb3ZlKHRoaXMudG9rZW4pO1xyXG4gICAgfVxyXG59XHJcbiJdfQ==