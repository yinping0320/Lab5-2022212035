import { empty } from 'rxjs';
import { map } from 'rxjs/operators';
/**
 * 权限
 */
var Authority = /** @class */ (function () {
    function Authority() {
        this.operationLabelMap = new Map();
        this.authOfLabel = new Map();
    }
    /**
     * 设置label到operation id的映射
     * @param labelMap
     */
    Authority.prototype.setLabelMap = function (labelMap) {
        var _this = this;
        for (var i in labelMap) {
            this.operationLabelMap.set(i, labelMap[i]);
        }
        this.operationLabelMap.forEach(function (opId, label) {
            _this[label] = false;
        });
    };
    /**
     * 初始化权限的值
     */
    Authority.prototype.initialize = function (authorityService) {
        var _this = this;
        if (this.operationLabelMap && this.operationLabelMap.size > 0) {
            return authorityService.queryOperationAuthority(Array.from(this.operationLabelMap.values())).pipe(map(function (operationAuth) {
                _this.operationLabelMap.forEach(function (opId, label) {
                    _this.authOfLabel.set(label, operationAuth.has(opId) ? operationAuth.get(opId) : false);
                });
            }));
        }
        else {
            return empty();
        }
    };
    /**
     * 返回操作权限，即用户是否拥有Label所对应的权限
     * @param label 标签，可以是button id等
     */
    Authority.prototype.hasOperation = function (label) {
        return this.authOfLabel.has(label) && this.authOfLabel.get(label);
    };
    return Authority;
}());
export { Authority };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXV0aG9yaXR5LmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGZhcnJpcy9jb21tYW5kLXNlcnZpY2VzLyIsInNvdXJjZXMiOlsibGliL2F1dGhvcml0eS9hdXRob3JpdHkudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQ0EsT0FBTyxFQUFhLEtBQUssRUFBQyxNQUFNLE1BQU0sQ0FBQztBQUN2QyxPQUFPLEVBQUUsR0FBRyxFQUFFLE1BQU0sZ0JBQWdCLENBQUM7QUFFckM7O0dBRUc7QUFDSDtJQUVJO1FBQ0ksSUFBSSxDQUFDLGlCQUFpQixHQUFHLElBQUksR0FBRyxFQUFrQixDQUFDO1FBQ25ELElBQUksQ0FBQyxXQUFXLEdBQUcsSUFBSSxHQUFHLEVBQW1CLENBQUM7SUFDbEQsQ0FBQztJQVlEOzs7T0FHRztJQUNPLCtCQUFXLEdBQXJCLFVBQXNCLFFBQWdCO1FBQXRDLGlCQU9DO1FBTkcsS0FBSSxJQUFJLENBQUMsSUFBSSxRQUFRLEVBQUU7WUFDbkIsSUFBSSxDQUFDLGlCQUFpQixDQUFDLEdBQUcsQ0FBQyxDQUFDLEVBQUUsUUFBUSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7U0FDOUM7UUFDRCxJQUFJLENBQUMsaUJBQWlCLENBQUMsT0FBTyxDQUFDLFVBQUMsSUFBSSxFQUFFLEtBQUs7WUFDdkMsS0FBSSxDQUFDLEtBQUssQ0FBQyxHQUFHLEtBQUssQ0FBQztRQUN4QixDQUFDLENBQUMsQ0FBQztJQUNQLENBQUM7SUFFRDs7T0FFRztJQUNILDhCQUFVLEdBQVYsVUFBVyxnQkFBa0M7UUFBN0MsaUJBWUM7UUFYRyxJQUFHLElBQUksQ0FBQyxpQkFBaUIsSUFBSSxJQUFJLENBQUMsaUJBQWlCLENBQUMsSUFBSSxHQUFDLENBQUMsRUFBRTtZQUN4RCxPQUFPLGdCQUFnQixDQUFDLHVCQUF1QixDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLGlCQUFpQixDQUFDLE1BQU0sRUFBRSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQzdGLEdBQUcsQ0FBQyxVQUFDLGFBQWE7Z0JBQ2QsS0FBSSxDQUFDLGlCQUFpQixDQUFDLE9BQU8sQ0FBQyxVQUFDLElBQUksRUFBRSxLQUFLO29CQUN2QyxLQUFJLENBQUMsV0FBVyxDQUFDLEdBQUcsQ0FBQyxLQUFLLEVBQUUsYUFBYSxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsYUFBYSxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUM7Z0JBQzNGLENBQUMsQ0FBQyxDQUFDO1lBQ1AsQ0FBQyxDQUFDLENBQ0wsQ0FBQztTQUNMO2FBQUk7WUFDRCxPQUFPLEtBQUssRUFBRSxDQUFDO1NBQ2xCO0lBQ0wsQ0FBQztJQUVEOzs7T0FHRztJQUNILGdDQUFZLEdBQVosVUFBYSxLQUFZO1FBQ3JCLE9BQU8sSUFBSSxDQUFDLFdBQVcsQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDLElBQUksSUFBSSxDQUFDLFdBQVcsQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDLENBQUM7SUFDdEUsQ0FBQztJQUlMLGdCQUFDO0FBQUQsQ0FBQyxBQXpERCxJQXlEQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEF1dGhvcml0eVNlcnZpY2UgfSBmcm9tICcuL2F1dGhvcml0eS5zZXJ2aWNlJztcclxuaW1wb3J0IHtPYnNlcnZhYmxlLCBlbXB0eX0gZnJvbSAncnhqcyc7XHJcbmltcG9ydCB7IG1hcCB9IGZyb20gJ3J4anMvb3BlcmF0b3JzJztcclxuXHJcbi8qKlxyXG4gKiDmnYPpmZBcclxuICovXHJcbmV4cG9ydCBjbGFzcyBBdXRob3JpdHkge1xyXG4gICAgXHJcbiAgICBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICB0aGlzLm9wZXJhdGlvbkxhYmVsTWFwID0gbmV3IE1hcDxzdHJpbmcsIHN0cmluZz4oKTtcclxuICAgICAgICB0aGlzLmF1dGhPZkxhYmVsID0gbmV3IE1hcDxzdHJpbmcsIGJvb2xlYW4+KCk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDku45sYWJlbOWIsOaTjeS9nOadg+mZkElE55qE5pig5bCE77yMbGFiZWzlj6/ku6XmmK9idXR0b24gaWTnrYlcclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBvcGVyYXRpb25MYWJlbE1hcDogTWFwPHN0cmluZywgc3RyaW5nPjtcclxuXHJcbiAgICAvKipcclxuICAgICAqIOiusOW9lWxhYmVs5a+55LqO55qE5pON5L2c5p2D6ZmQ77yM5piv5ZCm6YCa6L+HXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgYXV0aE9mTGFiZWw6IE1hcDxzdHJpbmcsIGJvb2xlYW4+O1xyXG5cclxuICAgIC8qKlxyXG4gICAgICog6K6+572ubGFiZWzliLBvcGVyYXRpb24gaWTnmoTmmKDlsIRcclxuICAgICAqIEBwYXJhbSBsYWJlbE1hcCBcclxuICAgICAqL1xyXG4gICAgcHJvdGVjdGVkIHNldExhYmVsTWFwKGxhYmVsTWFwOiBPYmplY3QpIHtcclxuICAgICAgICBmb3IodmFyIGkgaW4gbGFiZWxNYXApIHtcclxuICAgICAgICAgICAgdGhpcy5vcGVyYXRpb25MYWJlbE1hcC5zZXQoaSwgbGFiZWxNYXBbaV0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLm9wZXJhdGlvbkxhYmVsTWFwLmZvckVhY2goKG9wSWQsIGxhYmVsKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXNbbGFiZWxdID0gZmFsc2U7XHJcbiAgICAgICAgfSk7ICAgICAgICBcclxuICAgIH1cclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiDliJ3lp4vljJbmnYPpmZDnmoTlgLxcclxuICAgICAqL1xyXG4gICAgaW5pdGlhbGl6ZShhdXRob3JpdHlTZXJ2aWNlOiBBdXRob3JpdHlTZXJ2aWNlKTogT2JzZXJ2YWJsZTx2b2lkPiB7XHJcbiAgICAgICAgaWYodGhpcy5vcGVyYXRpb25MYWJlbE1hcCAmJiB0aGlzLm9wZXJhdGlvbkxhYmVsTWFwLnNpemU+MCkge1xyXG4gICAgICAgICAgICByZXR1cm4gYXV0aG9yaXR5U2VydmljZS5xdWVyeU9wZXJhdGlvbkF1dGhvcml0eShBcnJheS5mcm9tKHRoaXMub3BlcmF0aW9uTGFiZWxNYXAudmFsdWVzKCkpKS5waXBlKFxyXG4gICAgICAgICAgICAgICAgbWFwKChvcGVyYXRpb25BdXRoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vcGVyYXRpb25MYWJlbE1hcC5mb3JFYWNoKChvcElkLCBsYWJlbCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmF1dGhPZkxhYmVsLnNldChsYWJlbCwgb3BlcmF0aW9uQXV0aC5oYXMob3BJZCkgPyBvcGVyYXRpb25BdXRoLmdldChvcElkKSA6IGZhbHNlKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgIHJldHVybiBlbXB0eSgpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOi/lOWbnuaTjeS9nOadg+mZkO+8jOWNs+eUqOaIt+aYr+WQpuaLpeaciUxhYmVs5omA5a+55bqU55qE5p2D6ZmQXHJcbiAgICAgKiBAcGFyYW0gbGFiZWwg5qCH562+77yM5Y+v5Lul5pivYnV0dG9uIGlk562JXHJcbiAgICAgKi9cclxuICAgIGhhc09wZXJhdGlvbihsYWJlbDpzdHJpbmcpIHsgICAgICAgIFxyXG4gICAgICAgIHJldHVybiB0aGlzLmF1dGhPZkxhYmVsLmhhcyhsYWJlbCkgJiYgdGhpcy5hdXRoT2ZMYWJlbC5nZXQobGFiZWwpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIOi/lOWbnuWtl+auteadg+mZkFxyXG4gICAgLy8gaGFzRmllbGQoZmllbGQ6c3RyaW5nKVxyXG59Il19