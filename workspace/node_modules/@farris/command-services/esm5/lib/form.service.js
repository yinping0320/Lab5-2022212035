import { Injectable, Injector } from "@angular/core";
import { AppContext, Repository } from "@farris/devkit";
var FormService = /** @class */ (function () {
    function FormService(injector, appContext, repository) {
        this.injector = injector;
        this.appContext = appContext;
        this.repository = repository;
    }
    /**
     * 根据字段路径获取该字段在卡片或表格中的索引
     * @param source ngFormControls或any[][]
     * @param propertyPath 字段除bindingPath之外的完整路径
     * @returns
     */
    FormService.prototype.getIndex = function (source, propertyPath) {
        if (Array.isArray(source)) {
            var combine = source.reduce(function (result, group) {
                return result.concat(group);
            }, []);
            return combine.findIndex(function (item) { return item.field === propertyPath; });
        }
        else if (Object.prototype.toString.call(source) === '[object Object]') {
            return Object.keys(source).findIndex(function (key) { return source[key].binding === propertyPath; });
        }
    };
    FormService.decorators = [
        { type: Injectable }
    ];
    /** @nocollapse */
    FormService.ctorParameters = function () { return [
        { type: Injector },
        { type: AppContext },
        { type: Repository }
    ]; };
    return FormService;
}());
export { FormService };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZm9ybS5zZXJ2aWNlLmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGZhcnJpcy9jb21tYW5kLXNlcnZpY2VzLyIsInNvdXJjZXMiOlsibGliL2Zvcm0uc2VydmljZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsVUFBVSxFQUFFLFFBQVEsRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUNyRCxPQUFPLEVBQUUsVUFBVSxFQUFtRSxVQUFVLEVBQUUsTUFBTSxnQkFBZ0IsQ0FBQztBQUV6SDtJQUVFLHFCQUNVLFFBQWtCLEVBQ2xCLFVBQXNCLEVBQ3RCLFVBQThCO1FBRjlCLGFBQVEsR0FBUixRQUFRLENBQVU7UUFDbEIsZUFBVSxHQUFWLFVBQVUsQ0FBWTtRQUN0QixlQUFVLEdBQVYsVUFBVSxDQUFvQjtJQUV4QyxDQUFDO0lBQ0Q7Ozs7O09BS0c7SUFDSSw4QkFBUSxHQUFmLFVBQWdCLE1BQXlELEVBQUUsWUFBb0I7UUFDN0YsSUFBSSxLQUFLLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBQyxFQUFFO1lBQ3pCLElBQU0sT0FBTyxHQUFVLE1BQU0sQ0FBQyxNQUFNLENBQUMsVUFBQyxNQUFhLEVBQUUsS0FBWTtnQkFDL0QsT0FBTyxNQUFNLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFDO1lBQzlCLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQztZQUNQLE9BQU8sT0FBTyxDQUFDLFNBQVMsQ0FBQyxVQUFDLElBQVMsSUFBSyxPQUFBLElBQUksQ0FBQyxLQUFLLEtBQUssWUFBWSxFQUEzQixDQUEyQixDQUFDLENBQUM7U0FDdEU7YUFBTSxJQUFJLE1BQU0sQ0FBQyxTQUFTLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsS0FBSyxpQkFBaUIsRUFBRTtZQUN2RSxPQUFPLE1BQU0sQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUMsU0FBUyxDQUFDLFVBQUEsR0FBRyxJQUFJLE9BQUEsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDLE9BQU8sS0FBSyxZQUFZLEVBQXBDLENBQW9DLENBQUMsQ0FBQztTQUNuRjtJQUNILENBQUM7O2dCQXZCRixVQUFVOzs7O2dCQUhVLFFBQVE7Z0JBQ3BCLFVBQVU7Z0JBQW1FLFVBQVU7O0lBMkJoRyxrQkFBQztDQUFBLEFBekJELElBeUJDO1NBeEJZLFdBQVciLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBJbmplY3RhYmxlLCBJbmplY3RvciB9IGZyb20gXCJAYW5ndWxhci9jb3JlXCI7XHJcbmltcG9ydCB7IEFwcENvbnRleHQsIERhdGFQcm9wSW5mbywgRGF0YVR5cGVJbmZvLCBFbnRpdHksIEZyYW1lQ29udGV4dCwgTmdGb3JtQ29udHJvbCwgUmVwb3NpdG9yeSB9IGZyb20gXCJAZmFycmlzL2RldmtpdFwiO1xyXG5cclxuQEluamVjdGFibGUoKVxyXG5leHBvcnQgY2xhc3MgRm9ybVNlcnZpY2Uge1xyXG4gIGNvbnN0cnVjdG9yKFxyXG4gICAgcHJpdmF0ZSBpbmplY3RvcjogSW5qZWN0b3IsXHJcbiAgICBwcml2YXRlIGFwcENvbnRleHQ6IEFwcENvbnRleHQsXHJcbiAgICBwcml2YXRlIHJlcG9zaXRvcnk6IFJlcG9zaXRvcnk8RW50aXR5PlxyXG4gICkge1xyXG4gIH1cclxuICAvKipcclxuICAgKiDmoLnmja7lrZfmrrXot6/lvoTojrflj5bor6XlrZfmrrXlnKjljaHniYfmiJbooajmoLzkuK3nmoTntKLlvJVcclxuICAgKiBAcGFyYW0gc291cmNlIG5nRm9ybUNvbnRyb2xz5oiWYW55W11bXVxyXG4gICAqIEBwYXJhbSBwcm9wZXJ0eVBhdGgg5a2X5q616ZmkYmluZGluZ1BhdGjkuYvlpJbnmoTlrozmlbTot6/lvoRcclxuICAgKiBAcmV0dXJucyBcclxuICAgKi9cclxuICBwdWJsaWMgZ2V0SW5kZXgoc291cmNlOiB7IFtwcm9wZXJ0eU5hbWU6IHN0cmluZ106IE5nRm9ybUNvbnRyb2wgfSB8IGFueVtdLCBwcm9wZXJ0eVBhdGg6IHN0cmluZykge1xyXG4gICAgaWYgKEFycmF5LmlzQXJyYXkoc291cmNlKSkge1xyXG4gICAgICBjb25zdCBjb21iaW5lOiBhbnlbXSA9IHNvdXJjZS5yZWR1Y2UoKHJlc3VsdDogYW55W10sIGdyb3VwOiBhbnlbXSkgPT4ge1xyXG4gICAgICAgIHJldHVybiByZXN1bHQuY29uY2F0KGdyb3VwKTtcclxuICAgICAgfSwgW10pO1xyXG4gICAgICByZXR1cm4gY29tYmluZS5maW5kSW5kZXgoKGl0ZW06IGFueSkgPT4gaXRlbS5maWVsZCA9PT0gcHJvcGVydHlQYXRoKTtcclxuICAgIH0gZWxzZSBpZiAoT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKHNvdXJjZSkgPT09ICdbb2JqZWN0IE9iamVjdF0nKSB7XHJcbiAgICAgIHJldHVybiBPYmplY3Qua2V5cyhzb3VyY2UpLmZpbmRJbmRleChrZXkgPT4gc291cmNlW2tleV0uYmluZGluZyA9PT0gcHJvcGVydHlQYXRoKTtcclxuICAgIH1cclxuICB9XHJcbiAgXHJcbn0iXX0=