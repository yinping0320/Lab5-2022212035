import { Injectable } from "@angular/core";
var FormControlService = /** @class */ (function () {
    function FormControlService() {
    }
    FormControlService.prototype.getFormControlsByFrameContext = function (frameContext) {
        return frameContext && frameContext.form && frameContext.form.ngFormControls || null;
    };
    /**
     * 通过binding元数据获取NgFormControl
     * @param frameContext
     * @param binding binding
     * @returns
     */
    FormControlService.prototype.getFormControlByBinding = function (frameContext, binding) {
        var ngFormControls = this.getFormControlsByFrameContext(frameContext);
        if (!ngFormControls) {
            return null;
        }
        return Object.values(ngFormControls).find(function (ngFormControl) { return ngFormControl && ngFormControl.binding === binding; });
    };
    /**
     *
     * @param frameContext frameContext
     * @param fullPath
     * @returns
     */
    FormControlService.prototype.getFormControlIndexByFullPath = function (frameContext, fullPath) {
        var ngFormControls = this.getFormControlsByFrameContext(frameContext);
        if (!ngFormControls) {
            return null;
        }
        var bindings = fullPath.split('/').filter(function (p) { return p; });
        return Object.values(ngFormControls).findIndex(function (ngFormControl) {
            if (!ngFormControl) {
                return false;
            }
            var bindingPath = frameContext.viewModel.bindingPath;
            var bindingPaths = bindingPath.split('/').filter(function (p) { return p; });
            var formControlBindingPaths = ngFormControl.binding.split('.').filter(function (p) { return p; });
            var fullPath = bindingPaths.concat(formControlBindingPaths);
            return fullPath.join('/') === bindings.join('/');
        });
    };
    /**
     * 通过binding元数据获取NgFormControl位置
     * @param frameContext
     * @param binding binding
     * @returns 从0开始
     */
    FormControlService.prototype.getFormControlIndexByBinding = function (frameContext, binding) {
        var ngFormControls = this.getFormControlsByFrameContext(frameContext);
        if (!ngFormControls) {
            return null;
        }
        return Object.values(ngFormControls).findIndex(function (ngFormControl) { return ngFormControl && ngFormControl.binding === binding; });
    };
    FormControlService.decorators = [
        { type: Injectable }
    ];
    /** @nocollapse */
    FormControlService.ctorParameters = function () { return []; };
    return FormControlService;
}());
export { FormControlService };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZm9ybS1jb250cm9sLnNlcnZpY2UuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZmFycmlzL2NvbW1hbmQtc2VydmljZXMvIiwic291cmNlcyI6WyJsaWIvZm9ybS1jb250cm9sLnNlcnZpY2UudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLFVBQVUsRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUczQztJQUVFO0lBQWdCLENBQUM7SUFDViwwREFBNkIsR0FBcEMsVUFBcUMsWUFBMEI7UUFDN0QsT0FBTyxZQUFZLElBQUksWUFBWSxDQUFDLElBQUksSUFBSSxZQUFZLENBQUMsSUFBSSxDQUFDLGNBQWMsSUFBSSxJQUFJLENBQUM7SUFDdkYsQ0FBQztJQUNEOzs7OztPQUtHO0lBQ0ksb0RBQXVCLEdBQTlCLFVBQStCLFlBQTBCLEVBQUUsT0FBZTtRQUN4RSxJQUFNLGNBQWMsR0FBRyxJQUFJLENBQUMsNkJBQTZCLENBQUMsWUFBWSxDQUFDLENBQUM7UUFDeEUsSUFBSSxDQUFDLGNBQWMsRUFBRTtZQUNuQixPQUFPLElBQUksQ0FBQztTQUNiO1FBQ0QsT0FBTyxNQUFNLENBQUMsTUFBTSxDQUFDLGNBQWMsQ0FBQyxDQUFDLElBQUksQ0FBQyxVQUFDLGFBQTRCLElBQUssT0FBQSxhQUFhLElBQUksYUFBYSxDQUFDLE9BQU8sS0FBSyxPQUFPLEVBQWxELENBQWtELENBQUMsQ0FBQztJQUVsSSxDQUFDO0lBQ0Q7Ozs7O09BS0c7SUFDSSwwREFBNkIsR0FBcEMsVUFBcUMsWUFBMEIsRUFBRSxRQUFnQjtRQUMvRSxJQUFNLGNBQWMsR0FBRyxJQUFJLENBQUMsNkJBQTZCLENBQUMsWUFBWSxDQUFDLENBQUM7UUFDeEUsSUFBSSxDQUFDLGNBQWMsRUFBRTtZQUNuQixPQUFPLElBQUksQ0FBQztTQUNiO1FBQ0QsSUFBTSxRQUFRLEdBQUcsUUFBUSxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQyxNQUFNLENBQUMsVUFBQSxDQUFDLElBQUksT0FBQSxDQUFDLEVBQUQsQ0FBQyxDQUFDLENBQUM7UUFDcEQsT0FBTyxNQUFNLENBQUMsTUFBTSxDQUFDLGNBQWMsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxVQUFDLGFBQTRCO1lBQzFFLElBQUksQ0FBQyxhQUFhLEVBQUU7Z0JBQ2xCLE9BQU8sS0FBSyxDQUFDO2FBQ2Q7WUFDRCxJQUFNLFdBQVcsR0FBRyxZQUFZLENBQUMsU0FBUyxDQUFDLFdBQVcsQ0FBQztZQUN2RCxJQUFNLFlBQVksR0FBRyxXQUFXLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxVQUFBLENBQUMsSUFBSSxPQUFBLENBQUMsRUFBRCxDQUFDLENBQUMsQ0FBQztZQUMzRCxJQUFNLHVCQUF1QixHQUFHLGFBQWEsQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxVQUFBLENBQUMsSUFBSSxPQUFBLENBQUMsRUFBRCxDQUFDLENBQUMsQ0FBQztZQUNoRixJQUFNLFFBQVEsR0FBRyxZQUFZLENBQUMsTUFBTSxDQUFDLHVCQUF1QixDQUFDLENBQUM7WUFDOUQsT0FBTyxRQUFRLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxLQUFLLFFBQVEsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUM7UUFDbkQsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDO0lBQ0Q7Ozs7O09BS0c7SUFDSSx5REFBNEIsR0FBbkMsVUFBb0MsWUFBMEIsRUFBRSxPQUFlO1FBQzdFLElBQU0sY0FBYyxHQUFHLElBQUksQ0FBQyw2QkFBNkIsQ0FBQyxZQUFZLENBQUMsQ0FBQztRQUN4RSxJQUFJLENBQUMsY0FBYyxFQUFFO1lBQ25CLE9BQU8sSUFBSSxDQUFDO1NBQ2I7UUFDRCxPQUFPLE1BQU0sQ0FBQyxNQUFNLENBQUMsY0FBYyxDQUFDLENBQUMsU0FBUyxDQUFDLFVBQUMsYUFBNEIsSUFBSyxPQUFBLGFBQWEsSUFBSSxhQUFhLENBQUMsT0FBTyxLQUFLLE9BQU8sRUFBbEQsQ0FBa0QsQ0FBQyxDQUFDO0lBQ3ZJLENBQUM7O2dCQXZERixVQUFVOzs7O0lBd0RYLHlCQUFDO0NBQUEsQUF4REQsSUF3REM7U0F2RFksa0JBQWtCIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgSW5qZWN0YWJsZSB9IGZyb20gXCJAYW5ndWxhci9jb3JlXCI7XHJcbmltcG9ydCB7IEZyYW1lQ29udGV4dCwgTmdGb3JtQ29udHJvbCB9IGZyb20gXCJAZmFycmlzL2RldmtpdFwiO1xyXG5cclxuQEluamVjdGFibGUoKVxyXG5leHBvcnQgY2xhc3MgRm9ybUNvbnRyb2xTZXJ2aWNlIHtcclxuICBjb25zdHJ1Y3RvcigpIHsgfVxyXG4gIHB1YmxpYyBnZXRGb3JtQ29udHJvbHNCeUZyYW1lQ29udGV4dChmcmFtZUNvbnRleHQ6IEZyYW1lQ29udGV4dCk6IHsgW3Byb3BlcnR5TmFtZTogc3RyaW5nXTogTmdGb3JtQ29udHJvbCB9IHwgbnVsbCB7XHJcbiAgICByZXR1cm4gZnJhbWVDb250ZXh0ICYmIGZyYW1lQ29udGV4dC5mb3JtICYmIGZyYW1lQ29udGV4dC5mb3JtLm5nRm9ybUNvbnRyb2xzIHx8IG51bGw7XHJcbiAgfVxyXG4gIC8qKlxyXG4gICAqIOmAmui/h2JpbmRpbmflhYPmlbDmja7ojrflj5ZOZ0Zvcm1Db250cm9sXHJcbiAgICogQHBhcmFtIGZyYW1lQ29udGV4dCBcclxuICAgKiBAcGFyYW0gYmluZGluZyBiaW5kaW5nXHJcbiAgICogQHJldHVybnMgXHJcbiAgICovXHJcbiAgcHVibGljIGdldEZvcm1Db250cm9sQnlCaW5kaW5nKGZyYW1lQ29udGV4dDogRnJhbWVDb250ZXh0LCBiaW5kaW5nOiBzdHJpbmcpOiBOZ0Zvcm1Db250cm9sIHtcclxuICAgIGNvbnN0IG5nRm9ybUNvbnRyb2xzID0gdGhpcy5nZXRGb3JtQ29udHJvbHNCeUZyYW1lQ29udGV4dChmcmFtZUNvbnRleHQpO1xyXG4gICAgaWYgKCFuZ0Zvcm1Db250cm9scykge1xyXG4gICAgICByZXR1cm4gbnVsbDtcclxuICAgIH1cclxuICAgIHJldHVybiBPYmplY3QudmFsdWVzKG5nRm9ybUNvbnRyb2xzKS5maW5kKChuZ0Zvcm1Db250cm9sOiBOZ0Zvcm1Db250cm9sKSA9PiBuZ0Zvcm1Db250cm9sICYmIG5nRm9ybUNvbnRyb2wuYmluZGluZyA9PT0gYmluZGluZyk7XHJcblxyXG4gIH1cclxuICAvKipcclxuICAgKiBcclxuICAgKiBAcGFyYW0gZnJhbWVDb250ZXh0IGZyYW1lQ29udGV4dFxyXG4gICAqIEBwYXJhbSBmdWxsUGF0aCBcclxuICAgKiBAcmV0dXJucyBcclxuICAgKi9cclxuICBwdWJsaWMgZ2V0Rm9ybUNvbnRyb2xJbmRleEJ5RnVsbFBhdGgoZnJhbWVDb250ZXh0OiBGcmFtZUNvbnRleHQsIGZ1bGxQYXRoOiBzdHJpbmcpOiBudW1iZXIge1xyXG4gICAgY29uc3QgbmdGb3JtQ29udHJvbHMgPSB0aGlzLmdldEZvcm1Db250cm9sc0J5RnJhbWVDb250ZXh0KGZyYW1lQ29udGV4dCk7XHJcbiAgICBpZiAoIW5nRm9ybUNvbnRyb2xzKSB7XHJcbiAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfVxyXG4gICAgY29uc3QgYmluZGluZ3MgPSBmdWxsUGF0aC5zcGxpdCgnLycpLmZpbHRlcihwID0+IHApO1xyXG4gICAgcmV0dXJuIE9iamVjdC52YWx1ZXMobmdGb3JtQ29udHJvbHMpLmZpbmRJbmRleCgobmdGb3JtQ29udHJvbDogTmdGb3JtQ29udHJvbCkgPT4ge1xyXG4gICAgICBpZiAoIW5nRm9ybUNvbnRyb2wpIHtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgIH1cclxuICAgICAgY29uc3QgYmluZGluZ1BhdGggPSBmcmFtZUNvbnRleHQudmlld01vZGVsLmJpbmRpbmdQYXRoO1xyXG4gICAgICBjb25zdCBiaW5kaW5nUGF0aHMgPSBiaW5kaW5nUGF0aC5zcGxpdCgnLycpLmZpbHRlcihwID0+IHApO1xyXG4gICAgICBjb25zdCBmb3JtQ29udHJvbEJpbmRpbmdQYXRocyA9IG5nRm9ybUNvbnRyb2wuYmluZGluZy5zcGxpdCgnLicpLmZpbHRlcihwID0+IHApO1xyXG4gICAgICBjb25zdCBmdWxsUGF0aCA9IGJpbmRpbmdQYXRocy5jb25jYXQoZm9ybUNvbnRyb2xCaW5kaW5nUGF0aHMpO1xyXG4gICAgICByZXR1cm4gZnVsbFBhdGguam9pbignLycpID09PSBiaW5kaW5ncy5qb2luKCcvJyk7XHJcbiAgICB9KTtcclxuICB9XHJcbiAgLyoqXHJcbiAgICog6YCa6L+HYmluZGluZ+WFg+aVsOaNruiOt+WPlk5nRm9ybUNvbnRyb2zkvY3nva5cclxuICAgKiBAcGFyYW0gZnJhbWVDb250ZXh0IFxyXG4gICAqIEBwYXJhbSBiaW5kaW5nIGJpbmRpbmdcclxuICAgKiBAcmV0dXJucyDku44w5byA5aeLXHJcbiAgICovXHJcbiAgcHVibGljIGdldEZvcm1Db250cm9sSW5kZXhCeUJpbmRpbmcoZnJhbWVDb250ZXh0OiBGcmFtZUNvbnRleHQsIGJpbmRpbmc6IHN0cmluZyk6IG51bWJlciB7XHJcbiAgICBjb25zdCBuZ0Zvcm1Db250cm9scyA9IHRoaXMuZ2V0Rm9ybUNvbnRyb2xzQnlGcmFtZUNvbnRleHQoZnJhbWVDb250ZXh0KTtcclxuICAgIGlmICghbmdGb3JtQ29udHJvbHMpIHtcclxuICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gT2JqZWN0LnZhbHVlcyhuZ0Zvcm1Db250cm9scykuZmluZEluZGV4KChuZ0Zvcm1Db250cm9sOiBOZ0Zvcm1Db250cm9sKSA9PiBuZ0Zvcm1Db250cm9sICYmIG5nRm9ybUNvbnRyb2wuYmluZGluZyA9PT0gYmluZGluZyk7XHJcbiAgfVxyXG59Il19