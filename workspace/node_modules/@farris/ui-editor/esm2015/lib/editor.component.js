/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { isPlatformBrowser } from '@angular/common';
import { Component, ElementRef, forwardRef, Inject, Input, NgZone, PLATFORM_ID, InjectionToken, Optional, Injector, LOCALE_ID, HostBinding, ViewEncapsulation, Renderer2 } from '@angular/core';
import { NG_VALUE_ACCESSOR } from '@angular/forms';
import { getTinymce } from './TinyMCE';
import { bindHandlers, isTextarea, mergePlugins, uuid, noop, isNullOrUndefined } from './utils/Utils';
import { Events } from './Events';
import { ScriptLoader } from './utils/ScriptLoader';
import { EditorService } from './editor.service';
import { NavigationEnd, NavigationStart, Router } from '@angular/router';
import { appendPerfixForUri, Convert2HtmlEditorToolbars, OverLayHiddenService, WEBAPI_PREFIX_TOKEN } from '@farris/ui-common';
import { LocaleService } from '@farris/ui-locale';
import { NotifyService } from '@farris/ui-notify';
import { EDITOR_LOCALES } from './utils/editor.locale';
/** @type {?} */
export const TINYMCE_SCRIPT_SRC = new InjectionToken('TINYMCE_SCRIPT_SRC');
/** @type {?} */
const EDITOR_COMPONENT_VALUE_ACCESSOR = {
    provide: NG_VALUE_ACCESSOR,
    useExisting: forwardRef((/**
     * @return {?}
     */
    () => EditorComponent)),
    multi: true
};
export class EditorComponent extends Events {
    /**
     * @param {?} elementRef
     * @param {?} ngZone
     * @param {?} platformId
     * @param {?} injector
     * @param {?=} tinymceScriptSrc
     */
    constructor(elementRef, ngZone, platformId, injector, tinymceScriptSrc) {
        super();
        this.platformId = platformId;
        this.injector = injector;
        this.tinymceScriptSrc = tinymceScriptSrc;
        this.rootClass = 'farris-editor';
        this.customToolbar = false;
        /**
         * 限制上传图片大小, 默认为 false不限制上传图片的大小
         */
        this.limitImageSize = false;
        /**
         * 允许上传图片最大字节数，单位 kb
         */
        this.maxImgSize = 500;
        this.localeIds = {
            'en': 'es',
            'zh-CHS': 'zh_CN',
            'zh-CHT': 'zh_CHT'
        };
        this.currentLocale = 'zh-CHS';
        this.cloudChannel = '5';
        this.apiKey = 'no-api-key';
        // @Input() public init: Record<string, any> | undefined;
        this.editorId = '';
        this.modelEvents = 'change keyup undo redo';
        this.height = 100;
        /**
         * \@Deprecated 请使用 maxHeight
         */
        this.autoresizeMaxHeight = 800;
        /**
         * 只读时的最大高度，默认为 800px
         */
        this.maxHeight = 800;
        this.minHeight = 100;
        this.autoHeight = true;
        this.showBorder = true;
        this._fontFamilyList = ['Microsoft YaHei', 'Helvetica Neue', 'PingFang SC',
            'sans-serif', 'simsun', 'serif', 'SimHei', 'arial',
            'helvetica', 'arial black', 'avant garde', 'book antiqua', 'palatino', 'FangSong'];
        this._defaultFontFamily = 'Microsoft YaHei';
        this.onTouchedCallback = noop;
        this.onChangeCallback = noop;
        this.__WEBPAGEURL__ = '';
        this.editorBodyCls = 'mce-content-body';
        this.overLayService = null;
        this.basePath = '';
        this._elementRef = elementRef;
        this.ngZone = ngZone;
        this._render = this.injector.get(Renderer2);
        this.basePath = this.injector.get(WEBAPI_PREFIX_TOKEN, '');
        this.initialise = this.initialise.bind(this);
        if (this.injector) {
            this.currentLocale = this.injector.get(LOCALE_ID);
            this.editorService = this.injector.get(EditorService);
            this.localeSer = this.injector.get(LocaleService, null);
            this.notifySer = this.injector.get(NotifyService, null);
            if (this.localeSer) {
                this.localeSer.setLocaleData(EDITOR_LOCALES);
            }
            this.router = this.injector.get(Router, null);
            if (this.router) {
                this.router.events.subscribe((/**
                 * @param {?} e
                 * @return {?}
                 */
                (e) => {
                    if (e instanceof NavigationStart) {
                        if (!this.__WEBPAGEURL__) {
                            this.__WEBPAGEURL__ = e.url;
                        }
                    }
                    else if (e instanceof NavigationEnd) {
                        if (this.__WEBPAGEURL__ === e.url && this.editor) {
                            // console.log(this.editor);
                            this.editor.destroy();
                            this.initialise(!1);
                        }
                    }
                }));
            }
        }
        this.overLayService = new OverLayHiddenService();
    }
    /**
     * @return {?}
     */
    get disabledClass() {
        return this._disabled;
    }
    /**
     * @return {?}
     */
    get readonlyClass() {
        return this._readOnly;
    }
    /**
     * @param {?} val
     * @return {?}
     */
    set disabled(val) {
        this._disabled = val;
        if (this._editor && this._editor.initialized) {
            this._editor.setMode(val ? 'readonly' : 'design');
            this.setDivElement(val);
            this.editorBlured();
        }
    }
    /**
     * @return {?}
     */
    get disabled() {
        return this._disabled;
    }
    /**
     * @param {?} val
     * @return {?}
     */
    set readOnly(val) {
        this._readOnly = val;
        if (this._editor && this._editor.initialized) {
            this._editor.setMode(val ? 'readonly' : 'design');
            this.setDivElement(val);
            this.editorBlured();
            if (!val) {
                this._editor.undoManager.clear();
            }
        }
    }
    /**
     * @return {?}
     */
    get readOnly() {
        return this._readOnly;
    }
    /**
     * @return {?}
     */
    get editor() {
        return this._editor;
    }
    /**
     * @param {?} val
     * @return {?}
     */
    set fontFamilyList(val) {
        if (val) {
            this._fontFamilyList = val;
        }
    }
    /**
     * @return {?}
     */
    get fontFamilyList() {
        return this._fontFamilyList;
    }
    /**
     * @param {?} val
     * @return {?}
     */
    set defaultFontFamily(val) {
        if (val) {
            this._defaultFontFamily = val;
        }
    }
    /**
     * @return {?}
     */
    get defaultFontFamily() {
        return this._defaultFontFamily;
    }
    /**
     * @return {?}
     */
    ngOnInit() {
        /** @type {?} */
        const _this = this;
        this.init = {
            selector: 'textarea',
            menubar: false,
            inline: false,
            // statusbar: false,
            plugins: [
                'advlist autolink lists link image charmap print preview anchor textcolor powerpaste',
                'searchreplace visualblocks code fullscreen',
                'insertdatetime media table image imagetools code help nonbreaking'
            ],
            language: this.localeIds[this.currentLocale],
            // toolbar定义快捷栏的操作, | 用来分隔显示
            toolbar: 'undo redo | formatselect fontsizeselect fontselect | \
                        bold italic underline strikethrough forecolor backcolor link | \
                        alignleft aligncenter alignright alignjustify | \
                        bullist numlist outdent indent table image | removeformat',
            min_height: 100,
            // max_height: 400,
            block_formats: 'Paragraph=p;Heading 1=h1;Heading 2=h2;Heading 3=h3;Heading 4=h4;Heading 5=h5;Heading 6=h6',
            fontsize_formats: '12px 14px 16px 18px 24px 36px 48px 56px 72px',
            font_formats: '微软雅黑=Microsoft YaHei,Helvetica Neue,PingFang SC,sans-serif;苹果苹方=PingFang SC,Microsoft YaHei,sans-serif;\
                            宋体=simsun,serif;仿宋体=FangSong,serif;黑体=SimHei,sans-serif;Arial=arial,helvetica,sans-serif;\
                            Arial Black=arial black,avant garde;Book Antiqua=book antiqua,palatino;',
            images_upload_url: 'postAcceptor.php',
            images_upload_handler: (/**
             * @param {?} blobInfo
             * @param {?} success
             * @param {?} failure
             * @param {?} AA
             * @return {?}
             */
            function (blobInfo, success, failure, AA) {
                if (_this.beforeUpload) {
                    _this.beforeUpload(blobInfo).subscribe((/**
                     * @param {?} res
                     * @return {?}
                     */
                    res => {
                        success(res);
                    }), (/**
                     * @param {?} error
                     * @return {?}
                     */
                    error => {
                        failure(error);
                        return;
                    }));
                }
                else {
                    /** @type {?} */
                    const blob = blobInfo.blob();
                    /** @type {?} */
                    const canUpload = _this.limitImageSize ? blob.size <= (_this.maxImgSize || 500) * 1024 : true;
                    if (canUpload) {
                        /** @type {?} */
                        const reader = new FileReader();
                        reader.readAsDataURL(blob);
                        reader.onload = (/**
                         * @return {?}
                         */
                        function () {
                            // tfs 553121
                            if (_this.trim(AA.toString()) === 'function(){}') {
                                success(this.result);
                            }
                        });
                    }
                    else {
                        /** @type {?} */
                        const imgIdx = _this.editor.undoManager.data.findIndex((/**
                         * @param {?} n
                         * @return {?}
                         */
                        n => n.content.indexOf(blobInfo.blobUri()) > -1));
                        if (imgIdx > -1) {
                            _this.editor.undoManager.undo();
                            _this.editor.undoManager.data.splice(imgIdx, 1);
                            // const delImgs = _this.editor.dom.select('img[src="'+blobInfo.blobUri()+'"]');
                            // if (delImgs && delImgs.length) {
                            //     delImgs.forEach(n => {
                            //         n.remove();
                            //     });
                            // }
                        }
                        /** @type {?} */
                        let errMsg = `上传的图片不得大于${_this.maxImgSize}kb`;
                        if (_this.localeSer) {
                            /** @type {?} */
                            let _errMsg = _this.localeSer.getValue('farris-editor.maximgsize');
                            if (_errMsg) {
                                _errMsg = _errMsg.replace('{0}', `${_this.maxImgSize}kb`);
                                errMsg = _errMsg;
                            }
                        }
                        if (_this.notifySer) {
                            if (_this.trim(AA.toString()) === 'function(){}') {
                                _this.notifySer.warning({ msg: errMsg, timeout: 2000 });
                            }
                            /** @type {?} */
                            const mce_loading = document.querySelector('.mce-throbber');
                            if (mce_loading) {
                                mce_loading.remove();
                            }
                        }
                        else {
                            failure(errMsg);
                        }
                        // 不加此句，在内容为空时粘贴图片尺寸过大时，编辑器会得不到焦点
                        if (!_this.editor.getContent()) {
                            _this.editor.setContent(' ');
                        }
                        return;
                    }
                }
            }),
            branding: false,
            readonly: false,
            setup: null,
            end_container_on_empty_block: true,
            powerpaste_word_import: 'propmt',
            powerpaste_html_import: 'propmt',
            powerpaste_allow_local_images: true,
            paste_data_images: true,
            autoresize_min_height: 100,
            autoresize_max_height: this.maxHeight,
            autoresize_on_init: true,
            autoresize_overflow_padding: 0,
            nonbreaking_force_tab: true,
            default_link_target: '_blank'
        };
    }
    /**
     * @private
     * @return {?}
     */
    editorBlured() {
        setTimeout((/**
         * @return {?}
         */
        () => {
            /** @type {?} */
            const tinyBody = this._editor.iframeElement.contentWindow.document.getElementsByClassName(this.editorBodyCls);
            if (tinyBody && tinyBody.length) {
                tinyBody[0].blur();
            }
        }), 100);
    }
    /**
     * @param {?} value
     * @return {?}
     */
    writeValue(value) {
        if (this._editor && this._editor.initialized) {
            this._editor.setContent(isNullOrUndefined(value) ? '' : value);
            this._divElement.innerHTML = (isNullOrUndefined(value) ? '' : value);
        }
        else {
            this.initialValue = value === null ? undefined : value;
        }
        if (!this.__WEBPAGEURL__ && this.router) {
            this.__WEBPAGEURL__ = this.router.url;
        }
    }
    /**
     * @param {?} fn
     * @return {?}
     */
    registerOnChange(fn) {
        this.onChangeCallback = fn;
    }
    /**
     * @param {?} fn
     * @return {?}
     */
    registerOnTouched(fn) {
        this.onTouchedCallback = fn;
    }
    /**
     * @param {?} isDisabled
     * @return {?}
     */
    setDisabledState(isDisabled) {
        if (this._editor) {
            this._editor.setMode(isDisabled ? 'readonly' : 'design');
        }
        else if (isDisabled) {
            this.init = Object.assign({}, this.init, { readonly: true });
        }
    }
    /**
     * @return {?}
     */
    ngAfterViewInit() {
        if (isPlatformBrowser(this.platformId)) {
            this.editorId = this.editorId || uuid('tiny-angular');
            this.inline = typeof this.inline !== 'undefined' ?
                (typeof this.inline === 'boolean' ? this.inline : true) : this.init && this.init.inline;
            this.createElement();
            this.init.selector = '#' + this.editorId;
            if (getTinymce()) {
                this.initialise();
            }
            else if (this._element && this._element.ownerDocument) {
                ScriptLoader.load(this._element.ownerDocument, this.getScriptSrc(), this.initialise);
            }
        }
    }
    /**
     * @return {?}
     */
    ngOnDestroy() {
        this.__WEBPAGEURL__ = '';
        if (this._editor) {
            this._editor.remove();
            this._editor = null;
            this._divElement = null;
        }
        if (this.overLayService) {
            this.overLayService.destory(this._elementRef.nativeElement);
            this.overLayService = null;
        }
    }
    /**
     * @return {?}
     */
    createElement() {
        /** @type {?} */
        const tagName = typeof this.tagName === 'string' ? this.tagName : 'div';
        this._element = document.createElement(this.inline ? tagName : 'textarea');
        this._element.setAttribute('class', 'd-none');
        this._divElement = document.createElement('div');
        if (this.showBorder) {
            this._divElement.className = 'farris-editor-placeholder';
        }
        else {
            this._divElement.className = 'farris-editor-placeholder farris-editor-placeholder-border';
        }
        if (this.maxHeight) {
            this._render.setStyle(this._divElement, 'max-height', this.maxHeight + 'px');
        }
        if (this._element) {
            this._element.id = this.editorId;
            if (isTextarea(this._element)) {
                this._element.style.visibility = 'hidden';
            }
            this._elementRef.nativeElement.appendChild(this._element);
            this._elementRef.nativeElement.appendChild(this._divElement);
        }
    }
    /**
     * @param {?=} isfirstInit
     * @return {?}
     */
    initialise(isfirstInit = true) {
        /** @type {?} */
        let autoResizePlugin = '';
        this.minHeight = this.minHeight || 100;
        if (this.autoHeight) {
            autoResizePlugin = 'autoresize';
            this.maxHeight = this.maxHeight || 800;
        }
        else {
            this.height = this.height || this.minHeight;
        }
        /** @type {?} */
        const finalInit = Object.assign({}, this.init, { target: this._element, inline: this.inline, plugins: mergePlugins(this.init && this.init.plugins, [this.plugins, autoResizePlugin]), toolbar: this.init && this.init.toolbar, height: this.height, autoresize_max_height: this.maxHeight, max_height: this.maxHeight, setup: (/**
             * @param {?} editor
             * @return {?}
             */
            (editor) => {
                this._editor = editor;
                editor.on('init', (/**
                 * @param {?} e
                 * @return {?}
                 */
                (e) => {
                    this.initEditor(editor, isfirstInit);
                    if (this._readOnly || this._disabled) {
                        this._editor.setMode('readonly');
                    }
                    else {
                        this._editor.setMode('design');
                    }
                    setTimeout((/**
                     * @return {?}
                     */
                    () => {
                        this.setDivElement(this._readOnly || this._disabled);
                        e.target.editorCommands.execCommand("fontName", false, this.defaultFontFamily);
                        // tfs Bug 506916: 高级富文本：插入表格，打开其他菜单表格工具栏仍显示
                        // tfs Bug 532085: 高级富文本：编辑数据选择图片之后，滚动鼠标，点击其他区域，图片上的工具栏不消失
                        /** @type {?} */
                        const hiddenToolbar = (/**
                         * @return {?}
                         */
                        () => {
                            /** @type {?} */
                            const _toolbar = document.querySelectorAll('[aria-label="Inline toolbar"]');
                            if (_toolbar && _toolbar.length) {
                                _toolbar.forEach((/**
                                 * @param {?} t
                                 * @return {?}
                                 */
                                (t) => {
                                    t.style.display = 'none';
                                }));
                            }
                        });
                        this._elementRef.nativeElement.querySelector('.mce-container-body').addEventListener('click', hiddenToolbar);
                        this.overLayService.registerMouseEvent(this._elementRef.nativeElement, hiddenToolbar, { mouseDown: false, scroll: true });
                    }), 0);
                    this.editor.limitImageSize = this.limitImageSize;
                    this.editor.maxImgSize = this.maxImgSize;
                    this.editor.images_drop_handler = (/**
                     * @param {?} e
                     * @return {?}
                     */
                    (e) => {
                        // console.log('image drop', e);
                        if (e && e.length && !document.querySelector('farris-notify-container')) {
                            /** @type {?} */
                            const imgNames = e.map((/**
                             * @param {?} n
                             * @return {?}
                             */
                            n => n.name)).join(', ');
                            /** @type {?} */
                            const errmsg = this.localeSer.getValue('farris-editor.dropimg').replace('{0}', imgNames).replace('{1}', `${this.maxImgSize}kb`);
                            if (this.notifySer) {
                                this.notifySer.warning(errmsg);
                            }
                            else {
                                this.editor.notificationManager.open({ text: errmsg, type: 'error' });
                            }
                        }
                    });
                }));
                editor.on('PastePostProcess', (/**
                 * @param {?} data
                 * @return {?}
                 */
                (data) => {
                    this.replaceFontFamily(data.node);
                }));
                bindHandlers(this, editor);
                if (this.init && typeof this.init.setup === 'function') {
                    this.init.setup(editor);
                }
            }) });
        if (this.customToolbar) {
            finalInit.toolbar = Convert2HtmlEditorToolbars('advanced', this.toolbar);
        }
        if (isTextarea(this._element)) {
            this._element.style.visibility = '';
        }
        this.ngZone.runOutsideAngular((/**
         * @return {?}
         */
        () => {
            setTimeout((/**
             * @return {?}
             */
            () => {
                getTinymce().init(finalInit);
            }), 100);
        }));
    }
    /**
     * @return {?}
     */
    refresh() {
        if (this.editor) {
            this.editor.destroy();
        }
        this.initialise(false);
    }
    /**
     * @param {?} toolbar
     * @return {?}
     */
    setToolbar(toolbar) {
        this.toolbar = toolbar;
        this.refresh();
    }
    /**
     * @private
     * @param {?} readonly
     * @return {?}
     */
    setDivElement(readonly) {
        if (readonly) {
            this._divElement.classList.remove('d-none');
            this._render.removeStyle(this._divElement, 'height');
            if (this._editor && this._editor.initialized) {
                this._divElement.innerHTML = this._editor.getContent({ format: this.outputFormat });
            }
        }
        else {
            this._divElement.classList.add('d-none');
            this._render.setStyle(this._divElement, 'height', this.height + 'px');
            if (this._editor && this._editor.initialized) {
                this._divElement.innerHTML = '';
            }
        }
    }
    /**
     * @private
     * @return {?}
     */
    getScriptSrc() {
        return isNullOrUndefined(this.tinymceScriptSrc) ?
            `https://cdn.tiny.cloud/1/${this.apiKey}/tinymce/${this.cloudChannel}/tinymce.min.js` :
            appendPerfixForUri ? appendPerfixForUri(this.tinymceScriptSrc, this.basePath) : this.tinymceScriptSrc;
    }
    /**
     * @private
     * @param {?} editor
     * @param {?} isfirstInit
     * @return {?}
     */
    initEditor(editor, isfirstInit) {
        editor.on('blur', (/**
         * @return {?}
         */
        () => this.ngZone.run((/**
         * @return {?}
         */
        () => this.onTouchedCallback()))));
        editor.on(this.modelEvents, (/**
         * @return {?}
         */
        () => {
            this.ngZone.run((/**
             * @return {?}
             */
            () => {
                this.onChangeCallback(editor.getContent({ format: this.outputFormat }));
                this._divElement.innerHTML = editor.getContent({ format: this.outputFormat });
            }));
            // console.log(editor.getContent({ format: this.outputFormat }));
        }));
        if (typeof this.initialValue === 'string' && isfirstInit) {
            this.ngZone.run((/**
             * @return {?}
             */
            () => {
                editor.setContent(this.initialValue);
                this._divElement.innerHTML = this.initialValue;
                this.onChangeCallback(editor.getContent({ format: this.outputFormat }));
            }));
        }
    }
    /**
     * @private
     * @param {?} el
     * @return {?}
     */
    replaceFontFamily(el) {
        if (el.nodeName === 'IMG') {
            return;
        }
        if (el.children && el.children.length) {
            for (let k = 0; k < el.children.length; k++) {
                this.replaceFontFamily(el.children[k]);
            }
        }
        /** @type {?} */
        let ff = el.style.fontFamily;
        /** @type {?} */
        let face = el.getAttribute('face');
        if (ff) {
            /** @type {?} */
            let fonts = ff.split(',');
            /** @type {?} */
            let r = this.getFontFamilyArray(fonts);
            el.style.fontFamily = r;
        }
        if (face) {
            /** @type {?} */
            let faces = face.split(',');
            /** @type {?} */
            let r = this.getFontFamilyArray(faces);
            el.setAttribute('face', r);
        }
    }
    /**
     * @private
     * @param {?} fonts
     * @param {?=} zcFontArr
     * @return {?}
     */
    getFontFamilyArray(fonts, zcFontArr = this._fontFamilyList) {
        /** @type {?} */
        let ss = [];
        fonts.forEach((/**
         * @param {?} n
         * @return {?}
         */
        n => {
            if (zcFontArr.find((/**
             * @param {?} f
             * @return {?}
             */
            f => f === this.trim(n)))) {
                ss.push(this.trim(n));
            }
        }));
        /** @type {?} */
        let r = ss.join(',');
        if (!r) {
            r = this._defaultFontFamily;
        }
        return r;
    }
    /**
     * @private
     * @param {?} str
     * @return {?}
     */
    trim(str) {
        return str.replace(/^\s*|\s*$/g, '');
    }
}
EditorComponent.decorators = [
    { type: Component, args: [{
                selector: 'farris-editor',
                template: '<ng-template></ng-template>',
                providers: [EDITOR_COMPONENT_VALUE_ACCESSOR],
                encapsulation: ViewEncapsulation.None,
                styles: [":host{display:block}.farris-editor .mce-tinymce .mce-toolbar .mce-btn-group>div{white-space:pre-wrap}.farris-editor .mce-tinymce{box-sizing:border-box;box-shadow:none}.farris-editor .mce-panel,.farris-editor .mce-tinymce{border-color:#d8dce6}.farris-editor.farris-editor-disabled .mce-statusbar,.farris-editor.farris-editor-disabled .mce-top-part,.farris-editor.farris-editor-readonly .mce-statusbar,.farris-editor.farris-editor-readonly .mce-top-part{display:none}.farris-editor.farris-editor-disabled .mce-edit-area,.farris-editor.farris-editor-readonly .mce-edit-area{border-top:none}.farris-editor.farris-editor-disabled.farris-editor-border .mce-tinymce,.farris-editor.farris-editor-readonly.farris-editor-border .mce-tinymce{border-width:0 0 1px!important}"]
            }] }
];
/** @nocollapse */
EditorComponent.ctorParameters = () => [
    { type: ElementRef },
    { type: NgZone },
    { type: Object, decorators: [{ type: Inject, args: [PLATFORM_ID,] }] },
    { type: Injector, decorators: [{ type: Optional }] },
    { type: String, decorators: [{ type: Optional }, { type: Inject, args: [TINYMCE_SCRIPT_SRC,] }] }
];
EditorComponent.propDecorators = {
    rootClass: [{ type: HostBinding, args: ['class',] }],
    disabledClass: [{ type: HostBinding, args: ['class.farris-editor-disabled',] }],
    readonlyClass: [{ type: HostBinding, args: ['class.farris-editor-readonly',] }],
    disabled: [{ type: Input }],
    customToolbar: [{ type: Input }],
    limitImageSize: [{ type: Input }],
    maxImgSize: [{ type: Input }],
    readOnly: [{ type: Input }],
    cloudChannel: [{ type: Input }],
    apiKey: [{ type: Input }],
    editorId: [{ type: Input }],
    initialValue: [{ type: Input }],
    outputFormat: [{ type: Input }],
    inline: [{ type: Input }],
    tagName: [{ type: Input }],
    plugins: [{ type: Input }],
    toolbar: [{ type: Input }],
    modelEvents: [{ type: Input }],
    height: [{ type: Input }],
    autoresizeMaxHeight: [{ type: Input }],
    maxHeight: [{ type: Input }],
    minHeight: [{ type: Input }],
    autoHeight: [{ type: Input }],
    showBorder: [{ type: Input }, { type: HostBinding, args: ['class.farris-editor-border',] }],
    fontFamilyList: [{ type: Input }],
    defaultFontFamily: [{ type: Input }],
    beforeUpload: [{ type: Input }]
};
if (false) {
    /** @type {?} */
    EditorComponent.prototype.rootClass;
    /** @type {?} */
    EditorComponent.prototype.customToolbar;
    /**
     * 限制上传图片大小, 默认为 false不限制上传图片的大小
     * @type {?}
     */
    EditorComponent.prototype.limitImageSize;
    /**
     * 允许上传图片最大字节数，单位 kb
     * @type {?}
     */
    EditorComponent.prototype.maxImgSize;
    /** @type {?} */
    EditorComponent.prototype.ngZone;
    /** @type {?} */
    EditorComponent.prototype.localeIds;
    /** @type {?} */
    EditorComponent.prototype.currentLocale;
    /** @type {?} */
    EditorComponent.prototype.cloudChannel;
    /** @type {?} */
    EditorComponent.prototype.apiKey;
    /** @type {?} */
    EditorComponent.prototype.editorId;
    /** @type {?} */
    EditorComponent.prototype.initialValue;
    /** @type {?} */
    EditorComponent.prototype.outputFormat;
    /** @type {?} */
    EditorComponent.prototype.inline;
    /** @type {?} */
    EditorComponent.prototype.tagName;
    /** @type {?} */
    EditorComponent.prototype.plugins;
    /** @type {?} */
    EditorComponent.prototype.toolbar;
    /** @type {?} */
    EditorComponent.prototype.modelEvents;
    /** @type {?} */
    EditorComponent.prototype.height;
    /**
     * \@Deprecated 请使用 maxHeight
     * @type {?}
     */
    EditorComponent.prototype.autoresizeMaxHeight;
    /**
     * 只读时的最大高度，默认为 800px
     * @type {?}
     */
    EditorComponent.prototype.maxHeight;
    /** @type {?} */
    EditorComponent.prototype.minHeight;
    /** @type {?} */
    EditorComponent.prototype.autoHeight;
    /** @type {?} */
    EditorComponent.prototype.showBorder;
    /** @type {?} */
    EditorComponent.prototype._fontFamilyList;
    /** @type {?} */
    EditorComponent.prototype._defaultFontFamily;
    /** @type {?} */
    EditorComponent.prototype.beforeUpload;
    /**
     * @type {?}
     * @private
     */
    EditorComponent.prototype.init;
    /**
     * @type {?}
     * @private
     */
    EditorComponent.prototype._elementRef;
    /**
     * @type {?}
     * @private
     */
    EditorComponent.prototype._element;
    /**
     * @type {?}
     * @private
     */
    EditorComponent.prototype._disabled;
    /**
     * @type {?}
     * @private
     */
    EditorComponent.prototype._readOnly;
    /**
     * @type {?}
     * @private
     */
    EditorComponent.prototype._editor;
    /**
     * @type {?}
     * @private
     */
    EditorComponent.prototype._divElement;
    /**
     * @type {?}
     * @private
     */
    EditorComponent.prototype.onTouchedCallback;
    /**
     * @type {?}
     * @private
     */
    EditorComponent.prototype.onChangeCallback;
    /** @type {?} */
    EditorComponent.prototype.editorService;
    /** @type {?} */
    EditorComponent.prototype._render;
    /**
     * @type {?}
     * @private
     */
    EditorComponent.prototype.router;
    /**
     * @type {?}
     * @private
     */
    EditorComponent.prototype.__WEBPAGEURL__;
    /**
     * @type {?}
     * @private
     */
    EditorComponent.prototype.editorBodyCls;
    /**
     * @type {?}
     * @private
     */
    EditorComponent.prototype.overLayService;
    /**
     * @type {?}
     * @private
     */
    EditorComponent.prototype.localeSer;
    /**
     * @type {?}
     * @private
     */
    EditorComponent.prototype.notifySer;
    /**
     * @type {?}
     * @private
     */
    EditorComponent.prototype.basePath;
    /**
     * @type {?}
     * @private
     */
    EditorComponent.prototype.platformId;
    /**
     * @type {?}
     * @private
     */
    EditorComponent.prototype.injector;
    /**
     * @type {?}
     * @private
     */
    EditorComponent.prototype.tinymceScriptSrc;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZWRpdG9yLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BmYXJyaXMvdWktZWRpdG9yLyIsInNvdXJjZXMiOlsibGliL2VkaXRvci5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUFBLE9BQU8sRUFBRSxpQkFBaUIsRUFBRSxNQUFNLGlCQUFpQixDQUFDO0FBQ3BELE9BQU8sRUFBaUIsU0FBUyxFQUFFLFVBQVUsRUFBRSxVQUFVLEVBQUUsTUFBTSxFQUFFLEtBQUssRUFBRSxNQUFNLEVBQWEsV0FBVyxFQUFFLGNBQWMsRUFDcEgsUUFBUSxFQUFFLFFBQVEsRUFBRSxTQUFTLEVBQVUsV0FBVyxFQUFFLGlCQUFpQixFQUFFLFNBQVMsRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUM1RyxPQUFPLEVBQXdCLGlCQUFpQixFQUFFLE1BQU0sZ0JBQWdCLENBQUM7QUFFekUsT0FBTyxFQUFFLFVBQVUsRUFBRSxNQUFNLFdBQVcsQ0FBQztBQUN2QyxPQUFPLEVBQUUsWUFBWSxFQUFFLFVBQVUsRUFBRSxZQUFZLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxpQkFBaUIsRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUN0RyxPQUFPLEVBQUUsTUFBTSxFQUFFLE1BQU0sVUFBVSxDQUFDO0FBQ2xDLE9BQU8sRUFBRSxZQUFZLEVBQUUsTUFBTSxzQkFBc0IsQ0FBQztBQUNwRCxPQUFPLEVBQUUsYUFBYSxFQUFFLE1BQU0sa0JBQWtCLENBQUM7QUFDakQsT0FBTyxFQUFFLGFBQWEsRUFBRSxlQUFlLEVBQUUsTUFBTSxFQUFFLE1BQU0saUJBQWlCLENBQUM7QUFDekUsT0FBTyxFQUFFLGtCQUFrQixFQUFFLDBCQUEwQixFQUFFLG9CQUFvQixFQUEwQixtQkFBbUIsRUFBRSxNQUFNLG1CQUFtQixDQUFDO0FBQ3RKLE9BQU8sRUFBRSxhQUFhLEVBQUUsTUFBTSxtQkFBbUIsQ0FBQztBQUNsRCxPQUFPLEVBQUUsYUFBYSxFQUFFLE1BQU0sbUJBQW1CLENB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TCxLQUFLO3lCQUVMLEtBQUs7eUJBSUwsS0FBSyxZQUNMLFdBQVcsU0FBQyw0QkFBNEI7NkJBS3hDLEtBQUs7Z0NBWUwsS0FBSzsyQkFXTCxLQUFLOzs7O0lBakhOLG9DQUFrRDs7SUFxQmxELHdDQUErQjs7Ozs7SUFHL0IseUNBQWdDOzs7OztJQUVoQyxxQ0FBMEI7O0lBeUIxQixpQ0FBc0I7O0lBQ3RCLG9DQUlFOztJQUNGLHdDQUF5Qjs7SUFFekIsdUNBQW1DOztJQUNuQyxpQ0FBc0M7O0lBRXRDLG1DQUE4Qjs7SUFDOUIsdUNBQWlEOztJQUNqRCx1Q0FBMEQ7O0lBQzFELGlDQUE0Qzs7SUFDNUMsa0NBQTRDOztJQUM1QyxrQ0FBNEM7O0lBQzVDLGtDQUFnRDs7SUFDaEQsc0NBQXVEOztJQUN2RCxpQ0FBNkI7Ozs7O0lBSTdCLDhDQUEwQzs7Ozs7SUFFMUMsb0NBQWdDOztJQUVoQyxvQ0FBeUI7O0lBRXpCLHFDQUEyQjs7SUFJM0IscUNBQzZEOztJQUU3RCwwQ0FFbUg7O0lBWW5ILDZDQUF1Qzs7SUFZdkMsdUNBQXlEOzs7OztJQUV6RCwrQkFBa0I7Ozs7O0lBQ2xCLHNDQUFnQzs7Ozs7SUFDaEMsbUNBQXNDOzs7OztJQUN0QyxvQ0FBdUM7Ozs7O0lBQ3ZDLG9DQUF1Qzs7Ozs7SUFDdkMsa0NBQXFCOzs7OztJQUNyQixzQ0FBeUM7Ozs7O0lBRXpDLDRDQUFpQzs7Ozs7SUFDakMsMkNBQWdDOztJQUNoQyx3Q0FBNkI7O0lBQzdCLGtDQUEwQjs7Ozs7SUFFMUIsaUNBQXVCOzs7OztJQUN2Qix5Q0FBNEI7Ozs7O0lBQzVCLHdDQUEyQzs7Ozs7SUFDM0MseUNBQW9EOzs7OztJQUVwRCxvQ0FBaUM7Ozs7O0lBQ2pDLG9DQUFpQzs7Ozs7SUFFakMsbUNBQXNCOzs7OztJQUtsQixxQ0FBK0M7Ozs7O0lBQy9DLG1DQUFzQzs7Ozs7SUFDdEMsMkNBQXlFIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgaXNQbGF0Zm9ybUJyb3dzZXIgfSBmcm9tICdAYW5ndWxhci9jb21tb24nO1xyXG5pbXBvcnQgeyBBZnRlclZpZXdJbml0LCBDb21wb25lbnQsIEVsZW1lbnRSZWYsIGZvcndhcmRSZWYsIEluamVjdCwgSW5wdXQsIE5nWm9uZSwgT25EZXN0cm95LCBQTEFURk9STV9JRCwgSW5qZWN0aW9uVG9rZW4sXHJcbiAgICBPcHRpb25hbCwgSW5qZWN0b3IsIExPQ0FMRV9JRCwgT25Jbml0LCBIb3N0QmluZGluZywgVmlld0VuY2Fwc3VsYXRpb24sIFJlbmRlcmVyMiB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBDb250cm9sVmFsdWVBY2Nlc3NvciwgTkdfVkFMVUVfQUNDRVNTT1IgfSBmcm9tICdAYW5ndWxhci9mb3Jtcyc7XHJcbmltcG9ydCB7IE9ic2VydmFibGUgfSBmcm9tICdyeGpzJztcclxuaW1wb3J0IHsgZ2V0VGlueW1jZSB9IGZyb20gJy4vVGlueU1DRSc7XHJcbmltcG9ydCB7IGJpbmRIYW5kbGVycywgaXNUZXh0YXJlYSwgbWVyZ2VQbHVnaW5zLCB1dWlkLCBub29wLCBpc051bGxPclVuZGVmaW5lZCB9IGZyb20gJy4vdXRpbHMvVXRpbHMnO1xyXG5pbXBvcnQgeyBFdmVudHMgfSBmcm9tICcuL0V2ZW50cyc7XHJcbmltcG9ydCB7IFNjcmlwdExvYWRlciB9IGZyb20gJy4vdXRpbHMvU2NyaXB0TG9hZGVyJztcclxuaW1wb3J0IHsgRWRpdG9yU2VydmljZSB9IGZyb20gJy4vZWRpdG9yLnNlcnZpY2UnO1xyXG5pbXBvcnQgeyBOYXZpZ2F0aW9uRW5kLCBOYXZpZ2F0aW9uU3RhcnQsIFJvdXRlciB9IGZyb20gJ0Bhbmd1bGFyL3JvdXRlcic7XHJcbmltcG9ydCB7IGFwcGVuZFBlcmZpeEZvclVyaSwgQ29udmVydDJIdG1sRWRpdG9yVG9vbGJhcnMsIE92ZXJMYXlIaWRkZW5TZXJ2aWNlLCBSaWNoVGV4dEVkaXRvclRvb2xiYXJzLCBXRUJBUElfUFJFRklYX1RPS0VOIH0gZnJvbSAnQGZhcnJpcy91aS1jb21tb24nO1xyXG5pbXBvcnQgeyBMb2NhbGVTZXJ2aWNlIH0gZnJvbSAnQGZhcnJpcy91aS1sb2NhbGUnO1xyXG5pbXBvcnQgeyBOb3RpZnlTZXJ2aWNlIH0gZnJvbSAnQGZhcnJpcy91aS1ub3RpZnknO1xyXG5cclxuaW1wb3J0IHsgRURJVE9SX0xPQ0FMRVMgfSBmcm9tICcuL3V0aWxzL2VkaXRvci5sb2NhbGUnO1xyXG5cclxuXHJcbmV4cG9ydCBjb25zdCBUSU5ZTUNFX1NDUklQVF9TUkMgPSBuZXcgSW5qZWN0aW9uVG9rZW48c3RyaW5nPignVElOWU1DRV9TQ1JJUFRfU1JDJyk7XHJcblxyXG5jb25zdCBFRElUT1JfQ09NUE9ORU5UX1ZBTFVFX0FDQ0VTU09SID0ge1xyXG4gICAgcHJvdmlkZTogTkdfVkFMVUVfQUNDRVNTT1IsXHJcbiAgICB1c2VFeGlzdGluZzogZm9yd2FyZFJlZigoKSA9PiBFZGl0b3JDb21wb25lbnQpLFxyXG4gICAgbXVsdGk6IHRydWVcclxufTtcclxuXHJcbkBDb21wb25lbnQoe1xyXG4gICAgc2VsZWN0b3I6ICdmYXJyaXMtZWRpdG9yJyxcclxuICAgIHRlbXBsYXRlOiAnPG5nLXRlbXBsYXRlPjwvbmctdGVtcGxhdGU+JyxcclxuICAgIHN0eWxlVXJsczogWycuL2VkaXRvci5jb21wb25lbnQuc2NzcyddLFxyXG4gICAgcHJvdmlkZXJzOiBbRURJVE9SX0NPTVBPTkVOVF9WQUxVRV9BQ0NFU1NPUl0sXHJcbiAgICBlbmNhcHN1bGF0aW9uOiBWaWV3RW5jYXBzdWxhdGlvbi5Ob25lXHJcbn0pXHJcbmV4cG9ydCBjbGFzcyBFZGl0b3JDb21wb25lbnQgZXh0ZW5kcyBFdmVudHMgaW1wbGVtZW50cyBPbkluaXQsIEFmdGVyVmlld0luaXQsIENvbnRyb2xWYWx1ZUFjY2Vzc29yLCBPbkRlc3Ryb3kge1xyXG4gICAgQEhvc3RCaW5kaW5nKCdjbGFzcycpIHJvb3RDbGFzcyA9ICdmYXJyaXMtZWRpdG9yJztcclxuICAgIEBIb3N0QmluZGluZygnY2xhc3MuZmFycmlzLWVkaXRvci1kaXNhYmxlZCcpXHJcbiAgICBnZXQgZGlzYWJsZWRDbGFzcygpOiBib29sZWFuIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fZGlzYWJsZWQ7XHJcbiAgICB9XHJcbiAgICBASG9zdEJpbmRpbmcoJ2NsYXNzLmZhcnJpcy1lZGl0b3ItcmVhZG9ubHknKVxyXG4gICAgZ2V0IHJlYWRvbmx5Q2xhc3MoKTogYm9vbGVhbiB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX3JlYWRPbmx5O1xyXG4gICAgfVxyXG4gICAgQElucHV0KClcclxuICAgIHNldCBkaXNhYmxlZCh2YWwpIHtcclxuICAgICAgICB0aGlzLl9kaXNhYmxlZCA9IHZhbDtcclxuICAgICAgICBpZiAodGhpcy5fZWRpdG9yICYmIHRoaXMuX2VkaXRvci5pbml0aWFsaXplZCkge1xyXG4gICAgICAgICAgICB0aGlzLl9lZGl0b3Iuc2V0TW9kZSh2YWwgPyAncmVhZG9ubHknIDogJ2Rlc2lnbicpO1xyXG4gICAgICAgICAgICB0aGlzLnNldERpdkVsZW1lbnQodmFsKTtcclxuICAgICAgICAgICAgdGhpcy5lZGl0b3JCbHVyZWQoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBnZXQgZGlzYWJsZWQoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2Rpc2FibGVkO1xyXG4gICAgfVxyXG4gICAgQElucHV0KCkgY3VzdG9tVG9vbGJhciA9IGZhbHNlO1xyXG5cclxuICAgIC8qKiDpmZDliLbkuIrkvKDlm77niYflpKflsI8sIOm7mOiupOS4uiBmYWxzZeS4jemZkOWItuS4iuS8oOWbvueJh+eahOWkp+WwjyAqL1xyXG4gICAgQElucHV0KCkgbGltaXRJbWFnZVNpemUgPSBmYWxzZTtcclxuICAgIC8qKiDlhYHorrjkuIrkvKDlm77niYfmnIDlpKflrZfoioLmlbDvvIzljZXkvY0ga2IgICovXHJcbiAgICBASW5wdXQoKSBtYXhJbWdTaXplID0gNTAwO1xyXG5cclxuICAgIEBJbnB1dCgpXHJcbiAgICBzZXQgcmVhZE9ubHkodmFsKSB7XHJcbiAgICAgICAgdGhpcy5fcmVhZE9ubHkgPSB2YWw7XHJcbiAgICAgICAgaWYgKHRoaXMuX2VkaXRvciAmJiB0aGlzLl9lZGl0b3IuaW5pdGlhbGl6ZWQpIHtcclxuICAgICAgICAgICAgdGhpcy5fZWRpdG9yLnNldE1vZGUodmFsID8gJ3JlYWRvbmx5JyA6ICdkZXNpZ24nKTtcclxuICAgICAgICAgICAgdGhpcy5zZXREaXZFbGVtZW50KHZhbCk7XHJcbiAgICAgICAgICAgIHRoaXMuZWRpdG9yQmx1cmVkKCk7XHJcblxyXG4gICAgICAgICAgICBpZiAoIXZhbCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fZWRpdG9yLnVuZG9NYW5hZ2VyLmNsZWFyKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG5cclxuICAgIGdldCByZWFkT25seSgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fcmVhZE9ubHk7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0IGVkaXRvcigpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fZWRpdG9yO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBuZ1pvbmU6IE5nWm9uZTtcclxuICAgIGxvY2FsZUlkcyA9IHtcclxuICAgICAgICAnZW4nOiAnZXMnLFxyXG4gICAgICAgICd6aC1DSFMnOiAnemhfQ04nLFxyXG4gICAgICAgICd6aC1DSFQnOiAnemhfQ0hUJ1xyXG4gICAgfTtcclxuICAgIGN1cnJlbnRMb2NhbGUgPSAnemgtQ0hTJztcclxuXHJcbiAgICBASW5wdXQoKSBwdWJsaWMgY2xvdWRDaGFubmVsID0gJzUnO1xyXG4gICAgQElucHV0KCkgcHVibGljIGFwaUtleSA9ICduby1hcGkta2V5JztcclxuICAgIC8vIEBJbnB1dCgpIHB1YmxpYyBpbml0OiBSZWNvcmQ8c3RyaW5nLCBhbnk+IHwgdW5kZWZpbmVkO1xyXG4gICAgQElucHV0KCkgcHVibGljIGVkaXRvcklkID0gJyc7XHJcbiAgICBASW5wdXQoKSBwdWJsaWMgaW5pdGlhbFZhbHVlOiBzdHJpbmcgfCB1bmRlZmluZWQ7XHJcbiAgICBASW5wdXQoKSBwdWJsaWMgb3V0cHV0Rm9ybWF0OiAnaHRtbCcgfCAndGV4dCcgfCB1bmRlZmluZWQ7XHJcbiAgICBASW5wdXQoKSBwdWJsaWMgaW5saW5lOiBib29sZWFuIHwgdW5kZWZpbmVkO1xyXG4gICAgQElucHV0KCkgcHVibGljIHRhZ05hbWU6IHN0cmluZyB8IHVuZGVmaW5lZDtcclxuICAgIEBJbnB1dCgpIHB1YmxpYyBwbHVnaW5zOiBzdHJpbmcgfCB1bmRlZmluZWQ7XHJcbiAgICBASW5wdXQoKSBwdWJsaWMgdG9vbGJhcjogUmljaFRleHRFZGl0b3JUb29sYmFycztcclxuICAgIEBJbnB1dCgpIHB1YmxpYyBtb2RlbEV2ZW50cyA9ICdjaGFuZ2Uga2V5dXAgdW5kbyByZWRvJztcclxuICAgIEBJbnB1dCgpIHB1YmxpYyBoZWlnaHQgPSAxMDA7XHJcbiAgICAvKipcclxuICAgICAqIEBEZXByZWNhdGVkIOivt+S9v+eUqCBtYXhIZWlnaHRcclxuICAgICAqL1xyXG4gICAgQElucHV0KCkgcHVibGljIGF1dG9yZXNpemVNYXhIZWlnaHQgPSA4MDA7XHJcbiAgICAvKiog5Y+q6K+75pe255qE5pyA5aSn6auY5bqm77yM6buY6K6k5Li6IDgwMHB4ICovXHJcbiAgICBASW5wdXQoKSBwdWJsaWMgbWF4SGVpZ2h0ID0gODAwO1xyXG5cclxuICAgIEBJbnB1dCgpIG1pbkhlaWdodCA9IDEwMDtcclxuXHJcbiAgICBASW5wdXQoKSBhdXRvSGVpZ2h0ID0gdHJ1ZTtcclxuXHJcblxyXG5cclxuICAgIEBJbnB1dCgpXHJcbiAgICBASG9zdEJpbmRpbmcoJ2NsYXNzLmZhcnJpcy1lZGl0b3ItYm9yZGVyJykgc2hvd0JvcmRlciA9IHRydWU7XHJcblxyXG4gICAgX2ZvbnRGYW1pbHlMaXN0OiBBcnJheTxzdHJpbmc+ID0gWydNaWNyb3NvZnQgWWFIZWknLCAnSGVsdmV0aWNhIE5ldWUnLCAnUGluZ0ZhbmcgU0MnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3NhbnMtc2VyaWYnLCAnc2ltc3VuJywgJ3NlcmlmJywgJ1NpbUhlaScsICdhcmlhbCcsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdoZWx2ZXRpY2EnLCAnYXJpYWwgYmxhY2snLCAnYXZhbnQgZ2FyZGUnLCAnYm9vayBhbnRpcXVhJywgJ3BhbGF0aW5vJywgJ0ZhbmdTb25nJ107XHJcbiAgICBASW5wdXQoKVxyXG4gICAgc2V0IGZvbnRGYW1pbHlMaXN0KHZhbCkge1xyXG4gICAgICAgIGlmICh2YWwpIHtcclxuICAgICAgICAgICAgdGhpcy5fZm9udEZhbWlseUxpc3QgPSB2YWw7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGdldCBmb250RmFtaWx5TGlzdCgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fZm9udEZhbWlseUxpc3Q7XHJcbiAgICB9XHJcblxyXG4gICAgX2RlZmF1bHRGb250RmFtaWx5ID0gJ01pY3Jvc29mdCBZYUhlaSc7XHJcbiAgICBASW5wdXQoKVxyXG4gICAgc2V0IGRlZmF1bHRGb250RmFtaWx5KHZhbCkge1xyXG4gICAgICAgIGlmICh2YWwpIHtcclxuICAgICAgICAgICAgdGhpcy5fZGVmYXVsdEZvbnRGYW1pbHkgPSB2YWw7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGdldCBkZWZhdWx0Rm9udEZhbWlseSgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fZGVmYXVsdEZvbnRGYW1pbHk7XHJcbiAgICB9XHJcblxyXG4gICAgQElucHV0KCkgYmVmb3JlVXBsb2FkOiAoZmlsZU9iaj86IHt9KSA9PiBPYnNlcnZhYmxlPGFueT47XHJcblxyXG4gICAgcHJpdmF0ZSBpbml0OiBhbnk7XHJcbiAgICBwcml2YXRlIF9lbGVtZW50UmVmOiBFbGVtZW50UmVmO1xyXG4gICAgcHJpdmF0ZSBfZWxlbWVudDogRWxlbWVudCB8IHVuZGVmaW5lZDtcclxuICAgIHByaXZhdGUgX2Rpc2FibGVkOiBib29sZWFuIHwgdW5kZWZpbmVkO1xyXG4gICAgcHJpdmF0ZSBfcmVhZE9ubHk6IGJvb2xlYW4gfCB1bmRlZmluZWQ7XHJcbiAgICBwcml2YXRlIF9lZGl0b3I6IGFueTtcclxuICAgIHByaXZhdGUgX2RpdkVsZW1lbnQ6IEVsZW1lbnQgfCB1bmRlZmluZWQ7XHJcblxyXG4gICAgcHJpdmF0ZSBvblRvdWNoZWRDYWxsYmFjayA9IG5vb3A7XHJcbiAgICBwcml2YXRlIG9uQ2hhbmdlQ2FsbGJhY2sgPSBub29wO1xyXG4gICAgZWRpdG9yU2VydmljZTogRWRpdG9yU2VydmljZTtcclxuICAgIHB1YmxpYyBfcmVuZGVyOiBSZW5kZXJlcjI7XHJcblxyXG4gICAgcHJpdmF0ZSByb3V0ZXI6IFJvdXRlcjtcclxuICAgIHByaXZhdGUgX19XRUJQQUdFVVJMX18gPSAnJztcclxuICAgIHByaXZhdGUgZWRpdG9yQm9keUNscyA9ICdtY2UtY29udGVudC1ib2R5JztcclxuICAgIHByaXZhdGUgb3ZlckxheVNlcnZpY2U6IE92ZXJMYXlIaWRkZW5TZXJ2aWNlID0gbnVsbDtcclxuXHJcbiAgICBwcml2YXRlIGxvY2FsZVNlcjogTG9jYWxlU2VydmljZTtcclxuICAgIHByaXZhdGUgbm90aWZ5U2VyOiBOb3RpZnlTZXJ2aWNlO1xyXG5cclxuICAgIHByaXZhdGUgYmFzZVBhdGggPSAnJztcclxuXHJcbiAgICBjb25zdHJ1Y3RvcihcclxuICAgICAgICBlbGVtZW50UmVmOiBFbGVtZW50UmVmLFxyXG4gICAgICAgIG5nWm9uZTogTmdab25lLFxyXG4gICAgICAgIEBJbmplY3QoUExBVEZPUk1fSUQpIHByaXZhdGUgcGxhdGZvcm1JZDogT2JqZWN0LFxyXG4gICAgICAgIEBPcHRpb25hbCgpIHByaXZhdGUgaW5qZWN0b3I6IEluamVjdG9yLFxyXG4gICAgICAgIEBPcHRpb25hbCgpIEBJbmplY3QoVElOWU1DRV9TQ1JJUFRfU1JDKSBwcml2YXRlIHRpbnltY2VTY3JpcHRTcmM/OiBzdHJpbmdcclxuICAgICkge1xyXG4gICAgICAgIHN1cGVyKCk7XHJcbiAgICAgICAgdGhpcy5fZWxlbWVudFJlZiA9IGVsZW1lbnRSZWY7XHJcbiAgICAgICAgdGhpcy5uZ1pvbmUgPSBuZ1pvbmU7XHJcbiAgICAgICAgdGhpcy5fcmVuZGVyID0gdGhpcy5pbmplY3Rvci5nZXQoUmVuZGVyZXIyKTtcclxuXHJcbiAgICAgICAgdGhpcy5iYXNlUGF0aCA9IHRoaXMuaW5qZWN0b3IuZ2V0KFdFQkFQSV9QUkVGSVhfVE9LRU4sICcnKTtcclxuXHJcbiAgICAgICAgdGhpcy5pbml0aWFsaXNlID0gdGhpcy5pbml0aWFsaXNlLmJpbmQodGhpcyk7XHJcbiAgICAgICAgaWYgKHRoaXMuaW5qZWN0b3IpIHtcclxuICAgICAgICAgICAgdGhpcy5jdXJyZW50TG9jYWxlID0gdGhpcy5pbmplY3Rvci5nZXQoTE9DQUxFX0lEKTtcclxuICAgICAgICAgICAgdGhpcy5lZGl0b3JTZXJ2aWNlID0gdGhpcy5pbmplY3Rvci5nZXQoRWRpdG9yU2VydmljZSk7XHJcblxyXG4gICAgICAgICAgICB0aGlzLmxvY2FsZVNlciA9IHRoaXMuaW5qZWN0b3IuZ2V0KExvY2FsZVNlcnZpY2UsIG51bGwpO1xyXG4gICAgICAgICAgICB0aGlzLm5vdGlmeVNlciA9IHRoaXMuaW5qZWN0b3IuZ2V0KE5vdGlmeVNlcnZpY2UsIG51bGwpO1xyXG5cclxuICAgICAgICAgICAgaWYgKHRoaXMubG9jYWxlU2VyKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmxvY2FsZVNlci5zZXRMb2NhbGVEYXRhKEVESVRPUl9MT0NBTEVTKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdGhpcy5yb3V0ZXIgPSB0aGlzLmluamVjdG9yLmdldChSb3V0ZXIsIG51bGwpO1xyXG4gICAgICAgICAgICBpZiAodGhpcy5yb3V0ZXIpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMucm91dGVyLmV2ZW50cy5zdWJzY3JpYmUoKGU6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChlIGluc3RhbmNlb2YgTmF2aWdhdGlvblN0YXJ0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5fX1dFQlBBR0VVUkxfXykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fX1dFQlBBR0VVUkxfXyA9IGUudXJsO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChlIGluc3RhbmNlb2YgTmF2aWdhdGlvbkVuZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5fX1dFQlBBR0VVUkxfXyA9PT0gZS51cmwgJiYgdGhpcy5lZGl0b3IpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKHRoaXMuZWRpdG9yKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZWRpdG9yLmRlc3Ryb3koKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaW5pdGlhbGlzZSghMSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5vdmVyTGF5U2VydmljZSA9IG5ldyBPdmVyTGF5SGlkZGVuU2VydmljZSgpO1xyXG4gICAgfVxyXG5cclxuICAgIG5nT25Jbml0KCkge1xyXG4gICAgICAgIGNvbnN0IF90aGlzID0gdGhpcztcclxuXHJcbiAgICAgICAgdGhpcy5pbml0ID0ge1xyXG4gICAgICAgICAgICBzZWxlY3RvcjogJ3RleHRhcmVhJyxcclxuICAgICAgICAgICAgbWVudWJhcjogZmFsc2UsXHJcbiAgICAgICAgICAgIGlubGluZTogZmFsc2UsXHJcbiAgICAgICAgICAgIC8vIHN0YXR1c2JhcjogZmFsc2UsXHJcbiAgICAgICAgICAgIHBsdWdpbnM6IFtcclxuICAgICAgICAgICAgICAgICdhZHZsaXN0IGF1dG9saW5rIGxpc3RzIGxpbmsgaW1hZ2UgY2hhcm1hcCBwcmludCBwcmV2aWV3IGFuY2hvciB0ZXh0Y29sb3IgcG93ZXJwYXN0ZScsXHJcbiAgICAgICAgICAgICAgICAnc2VhcmNocmVwbGFjZSB2aXN1YWxibG9ja3MgY29kZSBmdWxsc2NyZWVuJyxcclxuICAgICAgICAgICAgICAgICdpbnNlcnRkYXRldGltZSBtZWRpYSB0YWJsZSBpbWFnZSBpbWFnZXRvb2xzIGNvZGUgaGVscCBub25icmVha2luZydcclxuICAgICAgICAgICAgXSxcclxuICAgICAgICAgICAgbGFuZ3VhZ2U6IHRoaXMubG9jYWxlSWRzW3RoaXMuY3VycmVudExvY2FsZV0sXHJcbiAgICAgICAgICAgIC8vIHRvb2xiYXLlrprkuYnlv6vmjbfmoI/nmoTmk43kvZwsIHwg55So5p2l5YiG6ZqU5pi+56S6XHJcbiAgICAgICAgICAgIHRvb2xiYXI6ICd1bmRvIHJlZG8gfCBmb3JtYXRzZWxlY3QgZm9udHNpemVzZWxlY3QgZm9udHNlbGVjdCB8IFxcXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJvbGQgaXRhbGljIHVuZGVybGluZSBzdHJpa2V0aHJvdWdoIGZvcmVjb2xvciBiYWNrY29sb3IgbGluayB8IFxcXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFsaWdubGVmdCBhbGlnbmNlbnRlciBhbGlnbnJpZ2h0IGFsaWduanVzdGlmeSB8IFxcXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJ1bGxpc3QgbnVtbGlzdCBvdXRkZW50IGluZGVudCB0YWJsZSBpbWFnZSB8IHJlbW92ZWZvcm1hdCcsXHJcbiAgICAgICAgICAgIG1pbl9oZWlnaHQ6IDEwMCxcclxuICAgICAgICAgICAgLy8gbWF4X2hlaWdodDogNDAwLFxyXG4gICAgICAgICAgICBibG9ja19mb3JtYXRzOiAnUGFyYWdyYXBoPXA7SGVhZGluZyAxPWgxO0hlYWRpbmcgMj1oMjtIZWFkaW5nIDM9aDM7SGVhZGluZyA0PWg0O0hlYWRpbmcgNT1oNTtIZWFkaW5nIDY9aDYnLFxyXG4gICAgICAgICAgICBmb250c2l6ZV9mb3JtYXRzOiAnMTJweCAxNHB4IDE2cHggMThweCAyNHB4IDM2cHggNDhweCA1NnB4IDcycHgnLFxyXG4gICAgICAgICAgICBmb250X2Zvcm1hdHM6ICflvq7ova/pm4Xpu5E9TWljcm9zb2Z0IFlhSGVpLEhlbHZldGljYSBOZXVlLFBpbmdGYW5nIFNDLHNhbnMtc2VyaWY76Iu55p6c6Iu55pa5PVBpbmdGYW5nIFNDLE1pY3Jvc29mdCBZYUhlaSxzYW5zLXNlcmlmO1xcXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICDlrovkvZM9c2ltc3VuLHNlcmlmO+S7v+Wui+S9kz1GYW5nU29uZyxzZXJpZjvpu5HkvZM9U2ltSGVpLHNhbnMtc2VyaWY7QXJpYWw9YXJpYWwsaGVsdmV0aWNhLHNhbnMtc2VyaWY7XFxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIEFyaWFsIEJsYWNrPWFyaWFsIGJsYWNrLGF2YW50IGdhcmRlO0Jvb2sgQW50aXF1YT1ib29rIGFudGlxdWEscGFsYXRpbm87JyxcclxuICAgICAgICAgICAgaW1hZ2VzX3VwbG9hZF91cmw6ICdwb3N0QWNjZXB0b3IucGhwJyxcclxuICAgICAgICAgICAgaW1hZ2VzX3VwbG9hZF9oYW5kbGVyOiBmdW5jdGlvbiAoYmxvYkluZm8sIHN1Y2Nlc3MsIGZhaWx1cmUsIEFBKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoX3RoaXMuYmVmb3JlVXBsb2FkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMuYmVmb3JlVXBsb2FkKGJsb2JJbmZvKS5zdWJzY3JpYmUocmVzID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3MocmVzKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZmFpbHVyZShlcnJvcik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBibG9iID0gYmxvYkluZm8uYmxvYigpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGNhblVwbG9hZCA9IF90aGlzLmxpbWl0SW1hZ2VTaXplID8gYmxvYi5zaXplIDw9IChfdGhpcy5tYXhJbWdTaXplIHx8IDUwMCkgKiAxMDI0OiB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmKGNhblVwbG9hZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZWFkZXIucmVhZEFzRGF0YVVSTChibG9iKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVhZGVyLm9ubG9hZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRmcyA1NTMxMjFcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKF90aGlzLnRyaW0oQUEudG9TdHJpbmcoKSkgPT09ICdmdW5jdGlvbigpe30nKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2Vzcyh0aGlzLnJlc3VsdCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBpbWdJZHggPSBfdGhpcy5lZGl0b3IudW5kb01hbmFnZXIuZGF0YS5maW5kSW5kZXgobj0+bi5jb250ZW50LmluZGV4T2YoYmxvYkluZm8uYmxvYlVyaSgpKSA+IC0xKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGltZ0lkeCA+IC0xKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5lZGl0b3IudW5kb01hbmFnZXIudW5kbygpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuZWRpdG9yLnVuZG9NYW5hZ2VyLmRhdGEuc3BsaWNlKGltZ0lkeCwgMSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBjb25zdCBkZWxJbWdzID0gX3RoaXMuZWRpdG9yLmRvbS5zZWxlY3QoJ2ltZ1tzcmM9XCInK2Jsb2JJbmZvLmJsb2JVcmkoKSsnXCJdJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBpZiAoZGVsSW1ncyAmJiBkZWxJbWdzLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gICAgIGRlbEltZ3MuZm9yRWFjaChuID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vICAgICAgICAgbi5yZW1vdmUoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgZXJyTXNnID0gYOS4iuS8oOeahOWbvueJh+S4jeW+l+Wkp+S6jiR7X3RoaXMubWF4SW1nU2l6ZX1rYmA7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoX3RoaXMubG9jYWxlU2VyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgX2Vyck1zZyA9IF90aGlzLmxvY2FsZVNlci5nZXRWYWx1ZSgnZmFycmlzLWVkaXRvci5tYXhpbWdzaXplJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoX2Vyck1zZykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9lcnJNc2cgPSBfZXJyTXNnLnJlcGxhY2UoJ3swfScsIGAke190aGlzLm1heEltZ1NpemV9a2JgKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJNc2cgPSBfZXJyTXNnO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoX3RoaXMubm90aWZ5U2VyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoX3RoaXMudHJpbShBQS50b1N0cmluZygpKSA9PT0gJ2Z1bmN0aW9uKCl7fScpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5ub3RpZnlTZXIud2FybmluZyh7bXNnOiBlcnJNc2csIHRpbWVvdXQ6IDIwMDB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG1jZV9sb2FkaW5nID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1jZS10aHJvYmJlcicpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG1jZV9sb2FkaW5nKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWNlX2xvYWRpbmcucmVtb3ZlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmYWlsdXJlKGVyck1zZyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyDkuI3liqDmraTlj6XvvIzlnKjlhoXlrrnkuLrnqbrml7bnspjotLTlm77niYflsLrlr7jov4flpKfml7bvvIznvJbovpHlmajkvJrlvpfkuI3liLDnhKbngrlcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYoIV90aGlzLmVkaXRvci5nZXRDb250ZW50KCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLmVkaXRvci5zZXRDb250ZW50KCcgJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgYnJhbmRpbmc6IGZhbHNlLFxyXG4gICAgICAgICAgICByZWFkb25seTogZmFsc2UsXHJcbiAgICAgICAgICAgIHNldHVwOiBudWxsLFxyXG4gICAgICAgICAgICBlbmRfY29udGFpbmVyX29uX2VtcHR5X2Jsb2NrOiB0cnVlLFxyXG4gICAgICAgICAgICBwb3dlcnBhc3RlX3dvcmRfaW1wb3J0OiAncHJvcG10JyxcclxuICAgICAgICAgICAgcG93ZXJwYXN0ZV9odG1sX2ltcG9ydDogJ3Byb3BtdCcsXHJcbiAgICAgICAgICAgIHBvd2VycGFzdGVfYWxsb3dfbG9jYWxfaW1hZ2VzOiB0cnVlLFxyXG4gICAgICAgICAgICBwYXN0ZV9kYXRhX2ltYWdlczogdHJ1ZSxcclxuICAgICAgICAgICAgYXV0b3Jlc2l6ZV9taW5faGVpZ2h0OiAxMDAsXHJcbiAgICAgICAgICAgIGF1dG9yZXNpemVfbWF4X2hlaWdodDogdGhpcy5tYXhIZWlnaHQsXHJcbiAgICAgICAgICAgIGF1dG9yZXNpemVfb25faW5pdDogdHJ1ZSxcclxuICAgICAgICAgICAgYXV0b3Jlc2l6ZV9vdmVyZmxvd19wYWRkaW5nOiAwLFxyXG4gICAgICAgICAgICBub25icmVha2luZ19mb3JjZV90YWI6IHRydWUsXHJcbiAgICAgICAgICAgIGRlZmF1bHRfbGlua190YXJnZXQ6ICdfYmxhbmsnXHJcbiAgICAgICAgfTtcclxuICAgIH1cclxuXHJcbiAgICBcclxuXHJcblxyXG4gICAgcHJpdmF0ZSBlZGl0b3JCbHVyZWQoKSB7XHJcbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHRpbnlCb2R5ID0gdGhpcy5fZWRpdG9yLmlmcmFtZUVsZW1lbnQuY29udGVudFdpbmRvdy5kb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKHRoaXMuZWRpdG9yQm9keUNscyk7XHJcbiAgICAgICAgICAgIGlmICh0aW55Qm9keSAmJiB0aW55Qm9keS5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgIHRpbnlCb2R5WzBdLmJsdXIoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sIDEwMCk7XHJcbiAgICB9XHJcblxyXG5cclxuICAgIHB1YmxpYyB3cml0ZVZhbHVlKHZhbHVlOiBzdHJpbmcgfCBudWxsKTogdm9pZCB7XHJcbiAgICAgICAgaWYgKHRoaXMuX2VkaXRvciAmJiB0aGlzLl9lZGl0b3IuaW5pdGlhbGl6ZWQpIHtcclxuICAgICAgICAgICAgdGhpcy5fZWRpdG9yLnNldENvbnRlbnQoaXNOdWxsT3JVbmRlZmluZWQodmFsdWUpID8gJycgOiB2YWx1ZSk7XHJcbiAgICAgICAgICAgIHRoaXMuX2RpdkVsZW1lbnQuaW5uZXJIVE1MID0gKGlzTnVsbE9yVW5kZWZpbmVkKHZhbHVlKSA/ICcnIDogdmFsdWUpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuaW5pdGlhbFZhbHVlID0gdmFsdWUgPT09IG51bGwgPyB1bmRlZmluZWQgOiB2YWx1ZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICghdGhpcy5fX1dFQlBBR0VVUkxfXyAmJiB0aGlzLnJvdXRlcikge1xyXG4gICAgICAgICAgICB0aGlzLl9fV0VCUEFHRVVSTF9fID0gdGhpcy5yb3V0ZXIudXJsO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgcmVnaXN0ZXJPbkNoYW5nZShmbjogKF86IGFueSkgPT4gdm9pZCk6IHZvaWQge1xyXG4gICAgICAgIHRoaXMub25DaGFuZ2VDYWxsYmFjayA9IGZuO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyByZWdpc3Rlck9uVG91Y2hlZChmbjogYW55KTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy5vblRvdWNoZWRDYWxsYmFjayA9IGZuO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBzZXREaXNhYmxlZFN0YXRlKGlzRGlzYWJsZWQ6IGJvb2xlYW4pIHtcclxuICAgICAgICBpZiAodGhpcy5fZWRpdG9yKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2VkaXRvci5zZXRNb2RlKGlzRGlzYWJsZWQgPyAncmVhZG9ubHknIDogJ2Rlc2lnbicpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoaXNEaXNhYmxlZCkge1xyXG4gICAgICAgICAgICB0aGlzLmluaXQgPSB7IC4uLnRoaXMuaW5pdCwgcmVhZG9ubHk6IHRydWUgfTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIG5nQWZ0ZXJWaWV3SW5pdCgpIHtcclxuICAgICAgICBpZiAoaXNQbGF0Zm9ybUJyb3dzZXIodGhpcy5wbGF0Zm9ybUlkKSkge1xyXG4gICAgICAgICAgICB0aGlzLmVkaXRvcklkID0gdGhpcy5lZGl0b3JJZCB8fCB1dWlkKCd0aW55LWFuZ3VsYXInKTtcclxuICAgICAgICAgICAgdGhpcy5pbmxpbmUgPSB0eXBlb2YgdGhpcy5pbmxpbmUgIT09ICd1bmRlZmluZWQnID9cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICh0eXBlb2YgdGhpcy5pbmxpbmUgPT09ICdib29sZWFuJyA/IHRoaXMuaW5saW5lIDogdHJ1ZSkgOiB0aGlzLmluaXQgJiYgdGhpcy5pbml0LmlubGluZTtcclxuICAgICAgICAgICAgdGhpcy5jcmVhdGVFbGVtZW50KCk7XHJcbiAgICAgICAgICAgIHRoaXMuaW5pdC5zZWxlY3RvciA9ICcjJyArIHRoaXMuZWRpdG9ySWQ7XHJcbiAgICAgICAgICAgIGlmIChnZXRUaW55bWNlKCkpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuaW5pdGlhbGlzZSgpO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMuX2VsZW1lbnQgJiYgdGhpcy5fZWxlbWVudC5vd25lckRvY3VtZW50KSB7XHJcbiAgICAgICAgICAgICAgICBTY3JpcHRMb2FkZXIubG9hZChcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9lbGVtZW50Lm93bmVyRG9jdW1lbnQsXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5nZXRTY3JpcHRTcmMoKSxcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmluaXRpYWxpc2VcclxuICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIG5nT25EZXN0cm95KCkge1xyXG4gICAgICAgIHRoaXMuX19XRUJQQUdFVVJMX18gPSAnJztcclxuICAgICAgICBpZiAodGhpcy5fZWRpdG9yKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2VkaXRvci5yZW1vdmUoKTtcclxuICAgICAgICAgICAgdGhpcy5fZWRpdG9yID0gbnVsbDtcclxuICAgICAgICAgICAgdGhpcy5fZGl2RWxlbWVudCA9IG51bGw7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAodGhpcy5vdmVyTGF5U2VydmljZSkge1xyXG4gICAgICAgICAgICB0aGlzLm92ZXJMYXlTZXJ2aWNlLmRlc3RvcnkodGhpcy5fZWxlbWVudFJlZi5uYXRpdmVFbGVtZW50KTtcclxuICAgICAgICAgICAgdGhpcy5vdmVyTGF5U2VydmljZSA9IG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBjcmVhdGVFbGVtZW50KCkge1xyXG4gICAgICAgIGNvbnN0IHRhZ05hbWUgPSB0eXBlb2YgdGhpcy50YWdOYW1lID09PSAnc3RyaW5nJyA/IHRoaXMudGFnTmFtZSA6ICdkaXYnO1xyXG4gICAgICAgIHRoaXMuX2VsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KHRoaXMuaW5saW5lID8gdGFnTmFtZSA6ICd0ZXh0YXJlYScpO1xyXG4gICAgICAgIHRoaXMuX2VsZW1lbnQuc2V0QXR0cmlidXRlKCdjbGFzcycsICdkLW5vbmUnKTtcclxuICAgICAgICB0aGlzLl9kaXZFbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICAgICAgaWYgKHRoaXMuc2hvd0JvcmRlcikge1xyXG4gICAgICAgICAgICB0aGlzLl9kaXZFbGVtZW50LmNsYXNzTmFtZSA9ICdmYXJyaXMtZWRpdG9yLXBsYWNlaG9sZGVyJztcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLl9kaXZFbGVtZW50LmNsYXNzTmFtZSA9ICdmYXJyaXMtZWRpdG9yLXBsYWNlaG9sZGVyIGZhcnJpcy1lZGl0b3ItcGxhY2Vob2xkZXItYm9yZGVyJztcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgaWYgKHRoaXMubWF4SGVpZ2h0KSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3JlbmRlci5zZXRTdHlsZSh0aGlzLl9kaXZFbGVtZW50LCAnbWF4LWhlaWdodCcsIHRoaXMubWF4SGVpZ2h0ICsgJ3B4Jyk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAodGhpcy5fZWxlbWVudCkge1xyXG4gICAgICAgICAgICB0aGlzLl9lbGVtZW50LmlkID0gdGhpcy5lZGl0b3JJZDtcclxuICAgICAgICAgICAgaWYgKGlzVGV4dGFyZWEodGhpcy5fZWxlbWVudCkpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2VsZW1lbnQuc3R5bGUudmlzaWJpbGl0eSA9ICdoaWRkZW4nO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMuX2VsZW1lbnRSZWYubmF0aXZlRWxlbWVudC5hcHBlbmRDaGlsZCh0aGlzLl9lbGVtZW50KTtcclxuICAgICAgICAgICAgdGhpcy5fZWxlbWVudFJlZi5uYXRpdmVFbGVtZW50LmFwcGVuZENoaWxkKHRoaXMuX2RpdkVsZW1lbnQpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgaW5pdGlhbGlzZShpc2ZpcnN0SW5pdCA9IHRydWUpIHtcclxuXHJcbiAgICAgICAgbGV0IGF1dG9SZXNpemVQbHVnaW4gPSAnJztcclxuICAgICAgICB0aGlzLm1pbkhlaWdodCA9IHRoaXMubWluSGVpZ2h0IHx8IDEwMDtcclxuICAgICAgICBpZiAodGhpcy5hdXRvSGVpZ2h0KSB7XHJcbiAgICAgICAgICAgIGF1dG9SZXNpemVQbHVnaW4gPSAnYXV0b3Jlc2l6ZSc7XHJcbiAgICAgICAgICAgIHRoaXMubWF4SGVpZ2h0ID0gdGhpcy5tYXhIZWlnaHQgfHwgODAwO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuaGVpZ2h0ID0gdGhpcy5oZWlnaHQgfHwgdGhpcy5taW5IZWlnaHQ7XHJcbiAgICAgICAgfVxyXG5cclxuXHJcbiAgICAgICAgY29uc3QgZmluYWxJbml0ID0ge1xyXG4gICAgICAgICAgICAuLi50aGlzLmluaXQsXHJcbiAgICAgICAgICAgIHRhcmdldDogdGhpcy5fZWxlbWVudCxcclxuICAgICAgICAgICAgaW5saW5lOiB0aGlzLmlubGluZSxcclxuICAgICAgICAgICAgLy8gcmVhZG9ubHk6IHRoaXMuZGlzYWJsZWQgfHwgdGhpcy5yZWFkT25seSxcclxuICAgICAgICAgICAgcGx1Z2luczogbWVyZ2VQbHVnaW5zKHRoaXMuaW5pdCAmJiB0aGlzLmluaXQucGx1Z2lucywgW3RoaXMucGx1Z2lucywgYXV0b1Jlc2l6ZVBsdWdpbl0pLFxyXG4gICAgICAgICAgICB0b29sYmFyOiB0aGlzLmluaXQgJiYgdGhpcy5pbml0LnRvb2xiYXIsXHJcbiAgICAgICAgICAgIGhlaWdodDogdGhpcy5oZWlnaHQsXHJcbiAgICAgICAgICAgIGF1dG9yZXNpemVfbWF4X2hlaWdodDogdGhpcy5tYXhIZWlnaHQsXHJcbiAgICAgICAgICAgIG1heF9oZWlnaHQgOiB0aGlzLm1heEhlaWdodCxcclxuICAgICAgICAgICAgc2V0dXA6IChlZGl0b3I6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fZWRpdG9yID0gZWRpdG9yO1xyXG4gICAgICAgICAgICAgICAgZWRpdG9yLm9uKCdpbml0JywgKGUpID0+IHtcclxuICAgICAgICAgICAgICAgICAgIHRoaXMuaW5pdEVkaXRvcihlZGl0b3IsIGlzZmlyc3RJbml0KTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5fcmVhZE9ubHkgfHwgdGhpcy5fZGlzYWJsZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fZWRpdG9yLnNldE1vZGUoJ3JlYWRvbmx5Jyk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fZWRpdG9yLnNldE1vZGUoJ2Rlc2lnbicpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXREaXZFbGVtZW50KHRoaXMuX3JlYWRPbmx5IHx8IHRoaXMuX2Rpc2FibGVkKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZS50YXJnZXQuZWRpdG9yQ29tbWFuZHMuZXhlY0NvbW1hbmQoXCJmb250TmFtZVwiLCBmYWxzZSwgdGhpcy5kZWZhdWx0Rm9udEZhbWlseSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB0ZnMgQnVnIDUwNjkxNjog6auY57qn5a+M5paH5pys77ya5o+S5YWl6KGo5qC877yM5omT5byA5YW25LuW6I+c5Y2V6KGo5qC85bel5YW35qCP5LuN5pi+56S6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRmcyBCdWcgNTMyMDg1OiDpq5jnuqflr4zmlofmnKzvvJrnvJbovpHmlbDmja7pgInmi6nlm77niYfkuYvlkI7vvIzmu5rliqjpvKDmoIfvvIzngrnlh7vlhbbku5bljLrln5/vvIzlm77niYfkuIrnmoTlt6XlhbfmoI/kuI3mtojlpLFcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgaGlkZGVuVG9vbGJhciA9ICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IF90b29sYmFyOiBhbnkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCdbYXJpYS1sYWJlbD1cIklubGluZSB0b29sYmFyXCJdJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoX3Rvb2xiYXIgJiYgX3Rvb2xiYXIubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3Rvb2xiYXIuZm9yRWFjaCgodDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQuc3R5bGUuZGlzcGxheSA9ICdub25lJztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fZWxlbWVudFJlZi5uYXRpdmVFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tY2UtY29udGFpbmVyLWJvZHknKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGhpZGRlblRvb2xiYXIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm92ZXJMYXlTZXJ2aWNlLnJlZ2lzdGVyTW91c2VFdmVudCh0aGlzLl9lbGVtZW50UmVmLm5hdGl2ZUVsZW1lbnQsIGhpZGRlblRvb2xiYXIsIHsgbW91c2VEb3duOiBmYWxzZSwgc2Nyb2xsOiB0cnVlIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB9LCAwKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5lZGl0b3IubGltaXRJbWFnZVNpemUgPSB0aGlzLmxpbWl0SW1hZ2VTaXplO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZWRpdG9yLm1heEltZ1NpemUgPSB0aGlzLm1heEltZ1NpemU7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZWRpdG9yLmltYWdlc19kcm9wX2hhbmRsZXIgPSAoZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZygnaW1hZ2UgZHJvcCcsIGUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZSAmJiBlLmxlbmd0aCAmJiAhZG9jdW1lbnQucXVlcnlTZWxlY3RvcignZmFycmlzLW5vdGlmeS1jb250YWluZXInKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgaW1nTmFtZXMgPSBlLm1hcChuID0+IG4ubmFtZSkuam9pbignLCAnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGVycm1zZyA9IHRoaXMubG9jYWxlU2VyLmdldFZhbHVlKCdmYXJyaXMtZWRpdG9yLmRyb3BpbWcnKS5yZXBsYWNlKCd7MH0nLCBpbWdOYW1lcykucmVwbGFjZSgnezF9JywgYCR7dGhpcy5tYXhJbWdTaXplfWtiYCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5ub3RpZnlTZXIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm5vdGlmeVNlci53YXJuaW5nKGVycm1zZyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZWRpdG9yLm5vdGlmaWNhdGlvbk1hbmFnZXIub3Blbih7dGV4dDogZXJybXNnLCB0eXBlOiAnZXJyb3InfSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgZWRpdG9yLm9uKCdQYXN0ZVBvc3RQcm9jZXNzJywgKGRhdGEpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnJlcGxhY2VGb250RmFtaWx5KGRhdGEubm9kZSk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIGJpbmRIYW5kbGVycyh0aGlzLCBlZGl0b3IpO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmluaXQgJiYgdHlwZW9mIHRoaXMuaW5pdC5zZXR1cCA9PT0gJ2Z1bmN0aW9uJykge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaW5pdC5zZXR1cChlZGl0b3IpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgaWYgKHRoaXMuY3VzdG9tVG9vbGJhcikge1xyXG4gICAgICAgICAgICBmaW5hbEluaXQudG9vbGJhciA9IENvbnZlcnQySHRtbEVkaXRvclRvb2xiYXJzKCdhZHZhbmNlZCcsIHRoaXMudG9vbGJhcik7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoaXNUZXh0YXJlYSh0aGlzLl9lbGVtZW50KSkge1xyXG4gICAgICAgICAgICB0aGlzLl9lbGVtZW50LnN0eWxlLnZpc2liaWxpdHkgPSAnJztcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMubmdab25lLnJ1bk91dHNpZGVBbmd1bGFyKCgpID0+IHtcclxuICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBnZXRUaW55bWNlKCkuaW5pdChmaW5hbEluaXQpO1xyXG4gICAgICAgICAgICB9LCAxMDApO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIHJlZnJlc2goKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuZWRpdG9yKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZWRpdG9yLmRlc3Ryb3koKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5pbml0aWFsaXNlKGZhbHNlKTtcclxuICAgIH1cclxuXHJcbiAgICBzZXRUb29sYmFyKHRvb2xiYXI6IFJpY2hUZXh0RWRpdG9yVG9vbGJhcnMpIHtcclxuICAgICAgICB0aGlzLnRvb2xiYXIgPSB0b29sYmFyO1xyXG4gICAgICAgIHRoaXMucmVmcmVzaCgpO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgc2V0RGl2RWxlbWVudChyZWFkb25seSkge1xyXG4gICAgICAgIGlmIChyZWFkb25seSkge1xyXG4gICAgICAgICAgICB0aGlzLl9kaXZFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ2Qtbm9uZScpO1xyXG4gICAgICAgICAgICB0aGlzLl9yZW5kZXIucmVtb3ZlU3R5bGUodGhpcy5fZGl2RWxlbWVudCwgJ2hlaWdodCcpO1xyXG5cclxuICAgICAgICAgICAgaWYodGhpcy5fZWRpdG9yICYmIHRoaXMuX2VkaXRvci5pbml0aWFsaXplZCl7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9kaXZFbGVtZW50LmlubmVySFRNTCA9IHRoaXMuX2VkaXRvci5nZXRDb250ZW50KHsgZm9ybWF0OiB0aGlzLm91dHB1dEZvcm1hdCB9KTtcclxuICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2RpdkVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnZC1ub25lJyk7XHJcbiAgICAgICAgICAgIHRoaXMuX3JlbmRlci5zZXRTdHlsZSh0aGlzLl9kaXZFbGVtZW50LCAnaGVpZ2h0JywgdGhpcy5oZWlnaHQgKyAncHgnKTtcclxuXHJcbiAgICAgICAgICAgIGlmKHRoaXMuX2VkaXRvciAmJiB0aGlzLl9lZGl0b3IuaW5pdGlhbGl6ZWQpe1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fZGl2RWxlbWVudC5pbm5lckhUTUwgPSAnJztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgIFxyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgZ2V0U2NyaXB0U3JjKCkge1xyXG4gICAgICAgIHJldHVybiBpc051bGxPclVuZGVmaW5lZCh0aGlzLnRpbnltY2VTY3JpcHRTcmMpID9cclxuICAgICAgICAgICAgYGh0dHBzOi8vY2RuLnRpbnkuY2xvdWQvMS8ke3RoaXMuYXBpS2V5fS90aW55bWNlLyR7dGhpcy5jbG91ZENoYW5uZWx9L3RpbnltY2UubWluLmpzYCA6XHJcbiAgICAgICAgICAgIGFwcGVuZFBlcmZpeEZvclVyaT8gYXBwZW5kUGVyZml4Rm9yVXJpKHRoaXMudGlueW1jZVNjcmlwdFNyYywgdGhpcy5iYXNlUGF0aCkgOiB0aGlzLnRpbnltY2VTY3JpcHRTcmM7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBpbml0RWRpdG9yKGVkaXRvcjogYW55LCBpc2ZpcnN0SW5pdCkge1xyXG5cclxuICAgICAgICBlZGl0b3Iub24oJ2JsdXInLCAoKSA9PiB0aGlzLm5nWm9uZS5ydW4oKCkgPT4gdGhpcy5vblRvdWNoZWRDYWxsYmFjaygpKSk7XHJcbiAgICAgICAgZWRpdG9yLm9uKHRoaXMubW9kZWxFdmVudHMsICgpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5uZ1pvbmUucnVuKCgpID0+IHtcclxuICAgICAgICAgICAgICAgIHRoaXMub25DaGFuZ2VDYWxsYmFjayhlZGl0b3IuZ2V0Q29udGVudCh7IGZvcm1hdDogdGhpcy5vdXRwdXRGb3JtYXQgfSkpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fZGl2RWxlbWVudC5pbm5lckhUTUwgPSBlZGl0b3IuZ2V0Q29udGVudCh7IGZvcm1hdDogdGhpcy5vdXRwdXRGb3JtYXQgfSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhlZGl0b3IuZ2V0Q29udGVudCh7IGZvcm1hdDogdGhpcy5vdXRwdXRGb3JtYXQgfSkpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGlmICh0eXBlb2YgdGhpcy5pbml0aWFsVmFsdWUgPT09ICdzdHJpbmcnICYmIGlzZmlyc3RJbml0KSB7XHJcbiAgICAgICAgICAgIHRoaXMubmdab25lLnJ1bigoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBlZGl0b3Iuc2V0Q29udGVudCh0aGlzLmluaXRpYWxWYWx1ZSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9kaXZFbGVtZW50LmlubmVySFRNTCA9IHRoaXMuaW5pdGlhbFZhbHVlO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5vbkNoYW5nZUNhbGxiYWNrKGVkaXRvci5nZXRDb250ZW50KHsgZm9ybWF0OiB0aGlzLm91dHB1dEZvcm1hdCB9KSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIHJlcGxhY2VGb250RmFtaWx5KGVsKSB7XHJcblxyXG4gICAgICAgIGlmIChlbC5ub2RlTmFtZSA9PT0gJ0lNRycpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKGVsLmNoaWxkcmVuICYmIGVsLmNoaWxkcmVuLmxlbmd0aCkge1xyXG4gICAgICAgICAgICBmb3IgKGxldCBrID0gMDsgayA8IGVsLmNoaWxkcmVuLmxlbmd0aDsgaysrKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnJlcGxhY2VGb250RmFtaWx5KGVsLmNoaWxkcmVuW2tdKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBsZXQgZmYgPSBlbC5zdHlsZS5mb250RmFtaWx5O1xyXG4gICAgICAgIGxldCBmYWNlID0gZWwuZ2V0QXR0cmlidXRlKCdmYWNlJyk7XHJcbiAgICAgICAgaWYgKGZmKSB7XHJcbiAgICAgICAgICAgIGxldCBmb250cyA9IGZmLnNwbGl0KCcsJyk7XHJcbiAgICAgICAgICAgIGxldCByID0gdGhpcy5nZXRGb250RmFtaWx5QXJyYXkoZm9udHMpO1xyXG4gICAgICAgICAgICBlbC5zdHlsZS5mb250RmFtaWx5ID0gcjtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGZhY2UpIHtcclxuICAgICAgICAgICAgbGV0IGZhY2VzID0gZmFjZS5zcGxpdCgnLCcpO1xyXG4gICAgICAgICAgICBsZXQgciA9IHRoaXMuZ2V0Rm9udEZhbWlseUFycmF5KGZhY2VzKTtcclxuICAgICAgICAgICAgZWwuc2V0QXR0cmlidXRlKCdmYWNlJywgcik7XHJcbiAgICAgICAgfVxyXG5cclxuICAgIH1cclxuICAgIHByaXZhdGUgZ2V0Rm9udEZhbWlseUFycmF5KGZvbnRzLCB6Y0ZvbnRBcnIgPSB0aGlzLl9mb250RmFtaWx5TGlzdCkge1xyXG4gICAgICAgIGxldCBzcyA9IFtdO1xyXG4gICAgICAgIGZvbnRzLmZvckVhY2gobiA9PiB7XHJcbiAgICAgICAgICAgIGlmICh6Y0ZvbnRBcnIuZmluZChmID0+IGYgPT09IHRoaXMudHJpbShuKSkpIHtcclxuICAgICAgICAgICAgICAgIHNzLnB1c2godGhpcy50cmltKG4pKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICB9KTtcclxuICAgICAgICBsZXQgciA9IHNzLmpvaW4oJywnKTtcclxuICAgICAgICBpZiAoIXIpIHtcclxuICAgICAgICAgICAgciA9IHRoaXMuX2RlZmF1bHRGb250RmFtaWx5O1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcjtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIHRyaW0oc3RyKSB7XHJcbiAgICAgICAgcmV0dXJuIHN0ci5yZXBsYWNlKC9eXFxzKnxcXHMqJC9nLCAnJyk7XHJcbiAgICB9XHJcbn1cclxuIl19