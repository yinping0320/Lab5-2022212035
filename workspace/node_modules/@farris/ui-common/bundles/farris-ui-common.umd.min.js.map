{"version":3,"sources":["ng://@farris/ui-common/lib/directives/farris-template.directive.ts","node_modules/tslib/tslib.es6.js","ng://@farris/ui-common/lib/directives/resize-observer.directive.ts","ng://@farris/ui-common/lib/directives/component-template.directive.ts","ng://@farris/ui-common/lib/common.utils.ts","ng://@farris/ui-common/lib/safe.pipe.ts","ng://@farris/ui-common/lib/encrypt.ts","ng://@farris/ui-common/lib/id.service.ts","ng://@farris/ui-common/lib/replaceX.pipe.ts","ng://@farris/ui-common/lib/service/runtime-state.service.ts","ng://@farris/ui-common/lib/directives/getvalue.pipe.ts","ng://@farris/ui-common/lib/service/overlay-hidden.service.ts","ng://@farris/ui-common/lib/common.module.ts","ng://@farris/ui-common/lib/service/base-data.facade.service.ts","ng://@farris/ui-common/lib/service/farris-instance.service.ts","ng://@farris/ui-common/lib/service/debug.service.ts","ng://@farris/ui-common/lib/request-animation.ts","ng://@farris/ui-common/lib/rich-text-commands.ts","ng://@farris/ui-common/lib/webapi-prefix-token.ts"],"names":["FarrisTemplateDirective","prototype","getType","this","name","Directive","args","selector","TemplateRef","Input","template","__assign","Object","assign","t","s","i","n","arguments","length","p","hasOwnProperty","call","apply","__values","o","m","Symbol","iterator","next","value","done","__read","r","e","ar","push","error","__spread","concat","entriesMap","WeakMap","ro","ResizeObserver","entries","entries_1","tslib_1.__values","entries_1_1","entry","has","target","get","_resizeCallback","ResizeObserverDirective","getBoundingClientRect","resize","emit","ngOnInit","nativeElement","el","set","observe","ngOnDestroy","unobserve","delete","ElementRef","Output","EventEmitter","FarrisComponentTemplateDirective","renderTemplate","ngOnChanges","changes","ctx","isFirstChange","_expandCtxToThis","expandContext","renderContext","_this","templateComponentIns","keys","forEach","instance","_getCmpRef","append","location","changeDetectorRef","detectChanges","cmpRef","createInstance","column","templateType","componentType","headerComponentType","cmptype","ngBaseDef","cfr","resolveComponentFactory","create","injector","Injector","ComponentFactoryResolver","CommonUtils","keyIsInData","field","data","noProperty","split","reduce","obj","key","getValue","safe","resultVal","indexOf","formatterValue","setValue","val","nest","lastObj_1","_fields","c","pop","getEnumItem","enumData","valueField","find","_getEnumTitleFromColumn","col","formatter","type","options","getEnumTitleFromColumnOptions","getEnumTitle","opts","textField","item","escapeHtml","str","undefined","replace","unescapeHtml","getTextWidth","txt","font","context","document","createElement","getContext","metrics","measureText","Math","round","width","removeStyleSheet","id","styleElement","querySelector","remove","createStyleSheet","styleSheetId","htmlHead","styleEleId","innerText","appendChild","getStyleSheet","styleSheets","styleSheet","styleSheets_1","styleSheets_1_1","stylesheet","ownerNode","appendCssRules","rules","rules_1","rules_1_1","rule","ruleName","slice","removedCssRule","removeCssRule","cssText","addRule","_newRule","insertRule","appendCssRules2","rules_2","rules_2_1","getCssRule","cssRules","cssRules_1","cssRules_1_1","selectorText","ii","cssRule","toLowerCase","deleteRule","removeRule","isNullOrUndefined","isIE","uA","window","navigator","userAgent","test","buildSortString","sorts","cfs","buildSqlWhere","conditions","getBrowserType","ua","ie","op","sa","ch","ff","getFFVer","b","parseFloat","substring","lastIndexOf","getQueryString","locationSearch","reg","RegExp","_search","search","match","getFloatingLayerIndex","upperLayers","overlays","Array","from","body","querySelectorAll","join","filter","map","_a","getComputedStyle","display","zIndex","parseInt","maxZindex","max","clickContinuity","callback","clickTatgatNum","clearTimeout","setTimeout","regBodyKeydownEvent","enterFn","escFn","keydownHandle","$event","preventDefault","stopPropagation","addEventListener","removeEventListener","Injectable","providedIn","ColumnFormatService","FarrisSafePipe","transform","sanitizer","bypassSecurityTrustHtml","bypassSecurityTrustStyle","bypassSecurityTrustScript","bypassSecurityTrustUrl","bypassSecurityTrustResourceUrl","Error","Pipe","DomSanitizer","b64pad","chrsz","encrypt","binl2hex","binarray","hex_tab","charAt","core_encrypt","str2binl","binl2b64","triplet","j","binl2str","bin","mask","String","fromCharCode","x","len","a","d","olda","oldb","oldc","oldd","encrypt_ff","encrypt_gg","encrypt_hh","encrypt_ii","safe_add","encrypt_cmn","q","bit_rol","num","cnt","y","lsw","charCodeAt","IdService","generate","guid","_crypto","crypto","getRandomValues","Uint8Array","toString","uuid","timestamp","Date","now","valueOf","previous","FarrisReplaceXPipe","_i","v","DefaultRuntimeState","form","model","RuntimeStateService","newVal","_state","merge","stateSubject","keyPath","utils","destroy","_formState","_lookupState","lookup","setLookupInstance","updateFormState","getFormState","eventPath","evt","path","composedPath","getParents","node","memo","parentNode","BehaviorSubject","state$","asObservable","form$","pipe","state","lookupIsPending$","f","pending","cloneDeep","GetValuePipe","OverLayOptionDefaults","onlyTopWindow","mouseWheel","mouseDown","scroll","mouseUp","click","OverLayHiddenService","iframeEventHandle","action","iframes","_documentClickEvent","eventsMap","iframes_1","iframes_1_1","iframeDoc","contentDocument","removeMouseEvent","top","destory","registerMouseEvent","FarrisCommonModule","forRoot","ngModule","providers","NgModule","declarations","imports","exports","BaseDataFacadeService","initData","idField","disabled","disableExpress","disabledField","updateState","newState","store","initState","isSelect","selections","loadData","selectValues","separator","_data","setSelections","getSelections","selectedItems","multiSelect","selectAll","unSelectAll","clearSelections","selectItem","index","idfield","items","cloneArray","unSelectItem","arr","_initState","data$","FarrisComponentInstanceService","add","DebugService","destroy$","complete","writeMessage","msg","isDebug","console","log","warn","info","useDebugMode","debugSub","fromEvent","takeUntil","subscribe","ctrlKey","shiftKey","Subject","availablePrefixes","reqAnimFrame","getRequestAnimationFrame","requestAnimationFrame","bind","prefix","requestAnimationFramePolyfill","lastTime","currTime","getTime","timeToCall","RICH_COMMANDS","concise","visible","code","cls","title","list","header","advanced","WEBAPI_PREFIX_TOKEN","InjectionToken","cancelRequestAnimationFrame","cancelAnimationFrame","Convert2HtmlEditorToolbars","toolbars","typ","allCMDs","configs","values","groupName","flat","isArray","unshift","appendPerfixForUri","uri","perfix"],"mappings":"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","sourcesContent":["import { Directive, Input, TemplateRef } from '@angular/core';\r\n\r\n@Directive({\r\n    selector: '[farrisTemplate]'\r\n})\r\nexport class FarrisTemplateDirective {\r\n\r\n    @Input() type: string;\r\n    @Input('farrisTemplate') name: string;\r\n\r\n    constructor(public template: TemplateRef<any>) {}\r\n\r\n    getType(): string {\r\n        return this.name;\r\n    }\r\n}\r\n\r\n","/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport function __exportStar(m, exports) {\r\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\n\r\nexport function __values(o) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator], i = 0;\r\n    if (m) return m.call(o);\r\n    return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n    result.default = mod;\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n","import { Directive, Output, ElementRef, OnDestroy, OnInit, EventEmitter, Input } from '@angular/core';\r\nimport ResizeObserver from 'resize-observer-polyfill';\r\n\r\n\r\nconst entriesMap = new WeakMap();\r\n\r\nconst ro = new ResizeObserver(entries => {\r\n    for (const entry of entries) {\r\n        if (entriesMap.has(entry.target)) {\r\n            const comp = entriesMap.get(entry.target);\r\n            comp._resizeCallback(entry);\r\n        }\r\n    }\r\n});\r\n\r\n@Directive({\r\n    selector: '[resizeObserver]'\r\n})\r\nexport class ResizeObserverDirective implements OnInit, OnDestroy {\r\n    @Input('resizeObserver') target: ElementRef;\r\n\r\n    @Output() resize = new EventEmitter();\r\n\r\n    constructor(public el: ElementRef) {\r\n    }\r\n\r\n\r\n    _resizeCallback(entry) {\r\n        entry['bindintClientRect'] = entry.target.getBoundingClientRect();\r\n        this.resize.emit(entry);\r\n    }\r\n\r\n    ngOnInit() {\r\n        const target = this.target ?  this.target.nativeElement : this.el.nativeElement;\r\n        entriesMap.set(target, this);\r\n        ro.observe(target);\r\n    }\r\n\r\n    ngOnDestroy() {\r\n        const target = this.el.nativeElement;\r\n        ro.unobserve(target);\r\n        entriesMap.delete(target);\r\n    }\r\n\r\n}\r\n","import { ComponentFactoryResolver, ComponentRef, Directive, ElementRef, Injector, Input, OnChanges, OnInit, SimpleChange, SimpleChanges } from '@angular/core';\r\nimport { DataColumn } from '@farris/ui-common/column';\r\n\r\nexport interface ITemplateComponent {\r\n    ctx: any,\r\n    renderContext?: any;\r\n}\r\n\r\nexport type ComponentTemplateFn = () => Partial<ITemplateComponent> | ComponentRef<Partial<ITemplateComponent>>;\r\nexport type ComponentTemplateRef = Partial<ITemplateComponent> | ComponentRef<Partial<ITemplateComponent>> | ComponentTemplateFn;\r\n\r\n@Directive({ selector: '[component-template]' })\r\nexport class FarrisComponentTemplateDirective implements OnInit, OnChanges {\r\n\r\n    @Input('component-template') column: DataColumn;\r\n    @Input() cmpRef: ComponentRef<any> = null;\r\n\r\n    @Input() ctx: any;\r\n    @Input() renderContext: any\r\n\r\n    @Input() templateType: 'head'|'cell'|'footer'|'empty'|'normal' = 'cell';\r\n    templateComponentIns: ComponentRef<any>;\r\n    constructor(private injector: Injector, private el: ElementRef, private cfr: ComponentFactoryResolver) { }\r\n\r\n    ngOnInit() {\r\n        this.renderTemplate();\r\n    }\r\n\r\n    ngOnChanges(changes: SimpleChanges) {\r\n        if (changes.ctx && !changes.ctx.isFirstChange()) {\r\n            this._expandCtxToThis();\r\n        }\r\n    }\r\n\r\n\r\n    private _expandCtxToThis() {\r\n        this.expandContext(this.ctx);\r\n        this.expandContext(this.renderContext);\r\n    }\r\n\r\n    private expandContext(ctx: any) {\r\n        if (this.templateComponentIns && ctx) {\r\n            Object.keys(ctx).forEach(n => {\r\n                this.templateComponentIns.instance[n] = ctx[n];\r\n            });\r\n        }\r\n    }\r\n\r\n    private renderTemplate() {\r\n        this.templateComponentIns = this._getCmpRef();\r\n        if (this.templateComponentIns) {\r\n            this._expandCtxToThis();\r\n            this.templateComponentIns.instance.ctx = this.ctx;\r\n            this.el.nativeElement.append(this.templateComponentIns.location.nativeElement);\r\n            this.templateComponentIns.changeDetectorRef.detectChanges();\r\n        }\r\n    }\r\n\r\n    private _getCmpRef() {\r\n        if (this.cmpRef) {\r\n            return this.createInstance(this.cmpRef);\r\n        }\r\n\r\n        if (this.column) {\r\n            if (this.templateType == 'cell') {\r\n                if (this.column.componentType) {\r\n                    return this.createInstance(this.column.componentType);\r\n                }\r\n            } else {\r\n                if (this.column.headerComponentType) {\r\n                    return this.createInstance(this.column.headerComponentType);\r\n                }\r\n            }\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    private createInstance(cmptype: any): ComponentRef<any> {\r\n\r\n        if (!cmptype) {\r\n            return null;\r\n        }\r\n\r\n        let templateComponentIns = null;\r\n        if (!cmptype.ngBaseDef && typeof cmptype === 'function') {\r\n            templateComponentIns = cmptype();\r\n        } else {\r\n            if (!cmptype['instance']) {\r\n                const cellTemplateCmp = this.cfr.resolveComponentFactory(cmptype as any);\r\n                templateComponentIns = cellTemplateCmp.create(this.injector);\r\n            } else {\r\n                templateComponentIns = cmptype;\r\n            }\r\n        }\r\n\r\n        return templateComponentIns\r\n    }\r\n}\r\n","import { Injectable, Optional } from '@angular/core';\r\nimport { DataColumn, ColumnFormatter, EnumFormatOptions, ColumnFormatService } from '@farris/ui-common/column';\r\n\r\n@Injectable({\r\n    providedIn: 'root'\r\n})\r\nexport class CommonUtils {\r\n    private cfs: ColumnFormatService = null;\r\n    constructor() {\r\n        if (!this.cfs) {\r\n            this.cfs = new ColumnFormatService(null, null);\r\n        }\r\n    }\r\n\r\n    keyIsInData(field, data) {\r\n        const noProperty = 'no property';\r\n        const val = field.split('.').reduce((obj, key) => {\r\n            if (obj && obj.hasOwnProperty(key)) {\r\n                return obj[key];\r\n            } else {\r\n                return noProperty;\r\n            }\r\n        }, data);\r\n\r\n        return val != noProperty;\r\n    }\r\n\r\n    /**\r\n     *  field:  user.firstName | name \r\n     * data: JSON\r\n     * safe: true, html false\r\n     */\r\n    getValue(field: string, data: any, safe = false) {\r\n        if (!data) {\r\n            return  '';\r\n        }\r\n        let resultVal = '';\r\n        if (field.indexOf('.') === -1 && data.hasOwnProperty(field)) {\r\n            resultVal = data[field];\r\n        } else {\r\n            resultVal = field.split('.').reduce((obj, key) => {\r\n                if (obj) {\r\n                    return obj[key];\r\n                } else {\r\n                    return null;\r\n                }\r\n            }, data);\r\n        }\r\n\r\n        if (safe) {\r\n            return this.formatterValue(resultVal);\r\n        } else {\r\n            return resultVal;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param obj \r\n     * @param field \r\n     * @param val \r\n     * @param nest  true\r\n     */\r\n    setValue(obj: { [key: string]: any }, field: string, val: any, nest = true) {\r\n        if (field) {\r\n            if (field.indexOf('.') > -1 && nest) {\r\n                let lastObj = null;\r\n                const _fields = field.split('.');\r\n                _fields.reduce( (c, p) => {\r\n                    lastObj = c;\r\n                    return c[p];\r\n                }, obj);\r\n\r\n                if (lastObj) {\r\n                    lastObj[_fields.pop()] = val;\r\n                }\r\n            } else {\r\n                obj[field] = val;\r\n            }\r\n        }\r\n    }\r\n\r\n    getEnumItem(value: any, enumData: any[], valueField) {\r\n        const item = enumData.find(n => n[valueField] == value);\r\n        return item;\r\n    }\r\n\r\n    private _getEnumTitleFromColumn(value: any, col: any) {\r\n        const _col = col as DataColumn;\r\n        const formatter = _col.formatter as ColumnFormatter;\r\n        if (formatter && typeof formatter === 'object') {\r\n            if (formatter.type === 'enum' && formatter.options) {\r\n                return this.getEnumTitleFromColumnOptions(value, formatter.options);\r\n            }\r\n        }\r\n        return value;\r\n    }\r\n\r\n    getEnumTitle(col: DataColumn, data: any ) {\r\n        const val = this.getValue(col.field, data);\r\n        return this._getEnumTitleFromColumn(val, col);\r\n    }\r\n\r\n    getEnumTitleFromColumnOptions(value: any, opts: any) {\r\n        const { data, valueField, textField } = opts;\r\n        const item = this.getEnumItem(value, data, valueField);\r\n        if (item) {\r\n            return item[textField];\r\n        } else {\r\n            return value;\r\n        }\r\n    }\r\n\r\n    escapeHtml(str) {\r\n        if (str === null || str === undefined) {\r\n            return  '';\r\n        }\r\n        return str\r\n        .replace(/&/g, '&amp;')\r\n        .replace(/</g, '&lt;')\r\n        .replace(/>/g, '&gt;')\r\n        .replace(/\\\"/g, '&quot;')\r\n        .replace(/\\'/g, '&#39;')\r\n        .replace(/\\//g, '&#x2F;');\r\n    }\r\n\r\n    unescapeHtml(str) {\r\n        if (str === null || str === undefined) {\r\n            return  '';\r\n        }\r\n        return str\r\n        .replace(/&amp;/g, '&')\r\n        .replace(/&lt;/g, '<')\r\n        .replace(/&gt;/g, '>')\r\n        .replace(/&quot;/g, '\"')\r\n        .replace(/&#39;/g, '\\'')\r\n        .replace(/&#x2F;/g, '/');\r\n    }\r\n\r\n\r\n    private formatterValue(val: any) {\r\n        if (val === null || val === undefined || val === '') {\r\n            return '';\r\n        }\r\n\r\n        if (typeof val === 'string') {\r\n            return this.escapeHtml(val);\r\n        }\r\n\r\n        return val;\r\n    }\r\n\r\n    /**  */\r\n    getTextWidth(txt: string, font) {\r\n        // const frag = document.createDocumentFragment();\r\n        const canvas = document.createElement('canvas');\r\n        const context = canvas.getContext('2d');\r\n        context.font = font;\r\n        const metrics = context.measureText(txt);\r\n        return Math.round(metrics.width);\r\n    }\r\n\r\n    removeStyleSheet(id: string) {\r\n        const styleElement = document.querySelector('#' + id);\r\n        if (styleElement) {\r\n            styleElement.remove();\r\n        }\r\n    }\r\n\r\n    createStyleSheet(styleSheetId: string): HTMLStyleElement {\r\n        const htmlHead = document.querySelector('head');\r\n\r\n        const styleEleId = styleSheetId;\r\n        let styleElement = null;\r\n        if (document.querySelector('#' + styleEleId)) {\r\n            styleElement = document.querySelector('#' + styleEleId);\r\n            styleElement.innerText = '';\r\n        } else {\r\n            styleElement = document.createElement('style');\r\n            styleElement.id = styleEleId;\r\n            htmlHead.appendChild(styleElement);\r\n        }\r\n\r\n        return styleElement;\r\n    }\r\n\r\n    getStyleSheet(styleSheetId) {\r\n        const styleSheets = document.styleSheets as any;\r\n        let styleSheet = null;\r\n        for (const stylesheet of styleSheets) {\r\n            if ((stylesheet.ownerNode || stylesheet['owningElement']).id === styleSheetId) {\r\n                styleSheet = stylesheet;\r\n                break;\r\n            }\r\n        }\r\n\r\n        return styleSheet;\r\n    }\r\n\r\n    /**  */\r\n    appendCssRules(rules: string[], styleSheet) {\r\n        for (const rule of rules) {\r\n            const ruleName = rule.slice(0, rule.indexOf('{'));\r\n            const removedCssRule = this.removeCssRule(ruleName, styleSheet);\r\n            let cssText = '';\r\n            if (removedCssRule) {\r\n                cssText += removedCssRule.cssText.slice(removedCssRule.cssText.indexOf('{') + 1, removedCssRule.cssText.indexOf('}'));\r\n            }\r\n            cssText += rule.slice(rule.indexOf('{') + 1, rule.indexOf('}')).replace(/\"/g, '').replace(/,/g, ';') + ';';\r\n            if (styleSheet.addRule) {\r\n                styleSheet.addRule(ruleName, cssText, 0);\r\n            } else {\r\n                const _newRule = `${ruleName}{ ${cssText} }`;\r\n                styleSheet.insertRule(_newRule, 0);\r\n            }\r\n        }\r\n    }\r\n\r\n    /**  */\r\n    appendCssRules2(rules: string[], styleSheet) {\r\n        for (const rule of rules) {\r\n            const ruleName = rule.slice(0, rule.indexOf('{'));\r\n            const removedCssRule = this.removeCssRule(ruleName, styleSheet);\r\n            const cssText = rule.slice(rule.indexOf('{') + 1, rule.indexOf('}')).replace(/\"/g, '').replace(/,/g, ';') + ';';\r\n            if (styleSheet.addRule) {\r\n                styleSheet.addRule(ruleName, cssText, 0);\r\n            } else {\r\n                const _newRule = `${ruleName}{ ${cssText} }`;\r\n                styleSheet.insertRule(_newRule, 0);\r\n            }\r\n        }\r\n    }\r\n\r\n    getCssRule(ruleName: string, styleSheet) {\r\n        const cssRules = (styleSheet.cssRules || styleSheet.rules) as any;\r\n        let r = null;\r\n        for (const rule of cssRules) {\r\n            if (rule.selectorText == ruleName) {\r\n                r = rule;\r\n            }\r\n        }\r\n\r\n        return r;\r\n    }\r\n\r\n    removeCssRule(ruleName: string, styleSheet ) {\r\n        const cssRules = (styleSheet.cssRules || styleSheet.rules) as any;\r\n        let ii = 0;\r\n        let cssRule: any = false;\r\n        do {\r\n            cssRule = cssRules[ii];\r\n            if (cssRule) {\r\n                if (cssRule.selectorText.toLowerCase() == ruleName.toLowerCase()) {\r\n                    if (styleSheet.cssRules) {\r\n                        styleSheet.deleteRule(ii);\r\n                    } else {\r\n                        styleSheet.removeRule(ii);\r\n                    }\r\n\r\n                    return cssRule;\r\n                }\r\n            }\r\n            ii++;\r\n        } while (cssRule);\r\n    }\r\n\r\n    isNullOrUndefined(val: any) {\r\n        return val === null || val === undefined;\r\n    }\r\n\r\n    isIE() {\r\n        const uA = window.navigator.userAgent;\r\n        return /msie\\s|trident\\/|edge\\//i.test(uA) && !!('uniqueID' in document || 'documentMode' in document || ('ActiveXObject' in window) || 'MSInputMethodContext' in window);\r\n    }\r\n\r\n    buildSortString(sorts: any[]): string {\r\n        return this.cfs.buildSortString(sorts);\r\n    }\r\n\r\n    buildSqlWhere(conditions: any[]): string {\r\n        return this.cfs.buildSqlWhere(conditions);\r\n    }\r\n\r\n    getBrowserType() {\r\n        const ua = navigator.userAgent.toLowerCase();  // \r\n        const info = {\r\n            ie : /msie/ .test(ua) && !/opera/ .test(ua),  //  IE\r\n            op : /opera/ .test(ua),  //  Opera\r\n            sa : /version.*safari/.test(ua),  // Safari\r\n            ch : /chrome/.test(ua),  //  Chrome\r\n            ff : /gecko/.test(ua) && !/webkit/.test(ua)  // Firefox\r\n        };\r\n\r\n        return info;\r\n    }\r\n\r\n\r\n    getFFVer() {\r\n        const ua = navigator.userAgent;\r\n        const b = ua.indexOf('Firefox/');\r\n        if (b < 0) {\r\n            return 0;\r\n        }\r\n        return parseFloat (ua.substring(b + 8, ua.lastIndexOf('\\.')));\r\n    }\r\n\r\n    getQueryString(name, locationSearch = '') {\r\n        var reg = new RegExp(\"(^|&)\" + name + \"=([^&]*)(&|$)\", \"i\");\r\n        let _search = window.location.search;\r\n        if (locationSearch) {\r\n            _search = locationSearch;\r\n        }\r\n        var r = _search.substring(1).match(reg);\r\n        if (r != null) return (r[2]); return null;\r\n    }\r\n\r\n    /**\r\n     * bodyzIndex, zindex\r\n     */\r\n    getFloatingLayerIndex(upperLayers = 1) {\r\n\r\n        const selectors = [\r\n            'body>.f-datagrid-settings-simple-host',\r\n            'body>div', \r\n            'body>farris-dialog>.farris-modal.show',\r\n            'body>.farris-modal.show', \r\n            'body>farris-filter-panel>.f-filter-panel-wrapper', \r\n            'body .f-sidebar-show>.f-sidebar-main',\r\n            'body>.popover.show',\r\n            'body>filter-row-panel>.f-datagrid-filter-panel',\r\n            'body>.f-section-maximize'\r\n        ];\r\n\r\n        const overlays = Array.from(document.body.querySelectorAll(selectors.join(','))).filter(n => n).map(n => {\r\n            const { display, zIndex } = window.getComputedStyle(n);\r\n            if (display === 'none') {\r\n                return 0;\r\n            }\r\n            return parseInt(zIndex, 10);\r\n        }).filter(n => n);\r\n        let maxZindex = Math.max(...overlays);\r\n        if (maxZindex < 1040) {\r\n            maxZindex = 1040;\r\n        }\r\n        return maxZindex + upperLayers;\r\n    }\r\n\r\n    /** Ncallback; 10 */\r\n    clickContinuity(callback: () => void,clickTatgatNum = 10) {\r\n\r\n        if (this['clickCountNow'] === undefined) {\r\n            this['clickCountNow'] = 0;\r\n        }\r\n\r\n        // \r\n        if (this['clickCountNow'] < clickTatgatNum - 1) {\r\n            // \r\n            if (this['clickTimer']) {\r\n                clearTimeout(this['clickTimer']);\r\n                this['clickTimer'] = null;\r\n            }\r\n            // +1\r\n            this['clickCountNow']++;\r\n            // \r\n            // console.log(`clickCountNow`, this['clickCountNow'])\r\n            // 300\r\n            this['clickTimer'] = setTimeout(() => {\r\n                this['clickCountNow'] = 0;\r\n            }, 300)\r\n        } else {\r\n            // +1\r\n            this['clickCountNow']++;\r\n            // \r\n            // console.log(`${this['clickCountNow']}`, ``)\r\n\r\n            if (callback) {\r\n                callback();\r\n            }\r\n\r\n            // \r\n            if (this['clickTimer']) {\r\n                clearTimeout(this['clickTimer']);\r\n                this['clickTimer'] = null;\r\n            }\r\n            // \r\n            this['clickCountNow'] = 0;\r\n    \r\n        }\r\n    }\r\n    \r\n    regBodyKeydownEvent(enterFn?: () => void, escFn?: () => void) {\r\n        const keydownHandle = ($event: KeyboardEvent) => {\r\n            if ($event.key !== 'Escape' && $event.key !== 'Enter') {\r\n                return;\r\n            }\r\n            $event.preventDefault();\r\n            $event.stopPropagation();\r\n\r\n            if ($event.key == 'Enter' && enterFn) {\r\n                // \r\n                enterFn();\r\n            } else {\r\n                escFn && escFn();\r\n            }\r\n        }\r\n        document.body.addEventListener('keydown', keydownHandle , true);\r\n        return () => {\r\n            document.body.removeEventListener('keydown', keydownHandle, true);\r\n        }\r\n    }\r\n}\r\n","\r\nimport { Pipe, PipeTransform } from '@angular/core';\r\nimport { DomSanitizer, SafeHtml, SafeStyle, SafeScript, SafeUrl, SafeResourceUrl } from '@angular/platform-browser';\r\n\r\n@Pipe({\r\n    name: 'safe'\r\n})\r\nexport class FarrisSafePipe implements PipeTransform {\r\n\r\n    constructor(protected sanitizer: DomSanitizer) { }\r\n\r\n    public transform(value: any, type: string): SafeHtml | SafeStyle | SafeScript | SafeUrl | SafeResourceUrl {\r\n        switch (type) {\r\n            case 'html': return this.sanitizer.bypassSecurityTrustHtml(value);\r\n            case 'style': return this.sanitizer.bypassSecurityTrustStyle(value);\r\n            case 'script': return this.sanitizer.bypassSecurityTrustScript(value);\r\n            case 'url': return this.sanitizer.bypassSecurityTrustUrl(value);\r\n            case 'resourceUrl': return this.sanitizer.bypassSecurityTrustResourceUrl(value);\r\n            default: throw new Error(`Invalid safe type specified: ${type}`);\r\n        }\r\n    }\r\n\r\n}\r\n","/*\r\n * Configurable variables. You may need to tweak these to be compatible with\r\n * the server-side, but the defaults work in most cases.\r\n */\r\nconst hexcase = 0; /* hex output format. 0 - lowercase; 1 - uppercase        */\r\nconst b64pad = ''; /* base-64 pad character. \"=\" for strict RFC compliance   */\r\nconst chrsz = 8; /* bits per input character. 8 - ASCII; 16 - Unicode      */\r\n\r\n\r\nexport function encrypt(s: string, type = 'hex') {\r\n        if (type === 'hex') {\r\n            return binl2hex(core_encrypt(str2binl(s), s.length * chrsz));\r\n        } else if (type === 'b64') {\r\n            return binl2b64(core_encrypt(str2binl(s), s.length * chrsz));\r\n        } else {\r\n            return binl2str(core_encrypt(str2binl(s), s.length * chrsz));\r\n        }\r\n}\r\nexport function hmac_encrypt(key, data, type = 'hex') {\r\n    if (type === 'hex') {\r\n        return binl2hex(core_hmac_encrypt(key, data));\r\n    } else if (type === 'b64') {\r\n        return binl2b64(core_hmac_encrypt(key, data));\r\n    } else {\r\n        return binl2str(core_hmac_encrypt(key, data));\r\n    }\r\n}\r\n/*\r\n * These are the functions you'll usually want to call\r\n * They take string arguments and return either hex or base-64 encoded strings\r\n */\r\n// export function hex_encrypt(s: string) {\r\n//     return binl2hex(core_encrypt(str2binl(s), s.length * chrsz));\r\n// }\r\n// export function b64_encrypt(s: string) {\r\n//     return binl2b64(core_encrypt(str2binl(s), s.length * chrsz));\r\n// }\r\n// export function str_encrypt(s: string) {\r\n//     return binl2str(core_encrypt(str2binl(s), s.length * chrsz));\r\n// }\r\n// export function hex_hmac_encrypt(key, data) {\r\n//     return binl2hex(core_hmac_encrypt(key, data));\r\n// }\r\n// export function b64_hmac_encrypt(key, data) {\r\n//     return binl2b64(core_hmac_encrypt(key, data));\r\n// }\r\n// export function str_hmac_encrypt(key, data) {\r\n//     return binl2str(core_hmac_encrypt(key, data));\r\n// }\r\n\r\n/*\r\n * Perform a simple self-test to see if the VM is working\r\n */\r\n// function encrypt_vm_test() {\r\n//     return hex_encrypt('abc') === '900150983cd24fb0d6963f7d28e17f72';\r\n// }\r\n/*\r\n * Calculate the encrypt of an array of little-endian words, and a bit length\r\n */\r\nfunction core_encrypt(x: any, len: number) {\r\n    /* append padding */\r\n    x[len >> 5] |= 0x80 << len % 32;\r\n    x[(((len + 64) >>> 9) << 4) + 14] = len;\r\n\r\n    let a = 1732584193;\r\n    let b = -271733879;\r\n    let c = -1732584194;\r\n    let d = 271733878;\r\n\r\n    for (let i = 0; i < x.length; i += 16) {\r\n        const olda = a;\r\n        const oldb = b;\r\n        const oldc = c;\r\n        const oldd = d;\r\n\r\n        a = encrypt_ff(a, b, c, d, x[i + 0], 7, -680876936);\r\n        d = encrypt_ff(d, a, b, c, x[i + 1], 12, -389564586);\r\n        c = encrypt_ff(c, d, a, b, x[i + 2], 17, 606105819);\r\n        b = encrypt_ff(b, c, d, a, x[i + 3], 22, -1044525330);\r\n        a = encrypt_ff(a, b, c, d, x[i + 4], 7, -176418897);\r\n        d = encrypt_ff(d, a, b, c, x[i + 5], 12, 1200080426);\r\n        c = encrypt_ff(c, d, a, b, x[i + 6], 17, -1473231341);\r\n        b = encrypt_ff(b, c, d, a, x[i + 7], 22, -45705983);\r\n        a = encrypt_ff(a, b, c, d, x[i + 8], 7, 1770035416);\r\n        d = encrypt_ff(d, a, b, c, x[i + 9], 12, -1958414417);\r\n        c = encrypt_ff(c, d, a, b, x[i + 10], 17, -42063);\r\n        b = encrypt_ff(b, c, d, a, x[i + 11], 22, -1990404162);\r\n        a = encrypt_ff(a, b, c, d, x[i + 12], 7, 1804603682);\r\n        d = encrypt_ff(d, a, b, c, x[i + 13], 12, -40341101);\r\n        c = encrypt_ff(c, d, a, b, x[i + 14], 17, -1502002290);\r\n        b = encrypt_ff(b, c, d, a, x[i + 15], 22, 1236535329);\r\n\r\n        a = encrypt_gg(a, b, c, d, x[i + 1], 5, -165796510);\r\n        d = encrypt_gg(d, a, b, c, x[i + 6], 9, -1069501632);\r\n        c = encrypt_gg(c, d, a, b, x[i + 11], 14, 643717713);\r\n        b = encrypt_gg(b, c, d, a, x[i + 0], 20, -373897302);\r\n        a = encrypt_gg(a, b, c, d, x[i + 5], 5, -701558691);\r\n        d = encrypt_gg(d, a, b, c, x[i + 10], 9, 38016083);\r\n        c = encrypt_gg(c, d, a, b, x[i + 15], 14, -660478335);\r\n        b = encrypt_gg(b, c, d, a, x[i + 4], 20, -405537848);\r\n        a = encrypt_gg(a, b, c, d, x[i + 9], 5, 568446438);\r\n        d = encrypt_gg(d, a, b, c, x[i + 14], 9, -1019803690);\r\n        c = encrypt_gg(c, d, a, b, x[i + 3], 14, -187363961);\r\n        b = encrypt_gg(b, c, d, a, x[i + 8], 20, 1163531501);\r\n        a = encrypt_gg(a, b, c, d, x[i + 13], 5, -1444681467);\r\n        d = encrypt_gg(d, a, b, c, x[i + 2], 9, -51403784);\r\n        c = encrypt_gg(c, d, a, b, x[i + 7], 14, 1735328473);\r\n        b = encrypt_gg(b, c, d, a, x[i + 12], 20, -1926607734);\r\n\r\n        a = encrypt_hh(a, b, c, d, x[i + 5], 4, -378558);\r\n        d = encrypt_hh(d, a, b, c, x[i + 8], 11, -2022574463);\r\n        c = encrypt_hh(c, d, a, b, x[i + 11], 16, 1839030562);\r\n        b = encrypt_hh(b, c, d, a, x[i + 14], 23, -35309556);\r\n        a = encrypt_hh(a, b, c, d, x[i + 1], 4, -1530992060);\r\n        d = encrypt_hh(d, a, b, c, x[i + 4], 11, 1272893353);\r\n        c = encrypt_hh(c, d, a, b, x[i + 7], 16, -155497632);\r\n        b = encrypt_hh(b, c, d, a, x[i + 10], 23, -1094730640);\r\n        a = encrypt_hh(a, b, c, d, x[i + 13], 4, 681279174);\r\n        d = encrypt_hh(d, a, b, c, x[i + 0], 11, -358537222);\r\n        c = encrypt_hh(c, d, a, b, x[i + 3], 16, -722521979);\r\n        b = encrypt_hh(b, c, d, a, x[i + 6], 23, 76029189);\r\n        a = encrypt_hh(a, b, c, d, x[i + 9], 4, -640364487);\r\n        d = encrypt_hh(d, a, b, c, x[i + 12], 11, -421815835);\r\n        c = encrypt_hh(c, d, a, b, x[i + 15], 16, 530742520);\r\n        b = encrypt_hh(b, c, d, a, x[i + 2], 23, -995338651);\r\n\r\n        a = encrypt_ii(a, b, c, d, x[i + 0], 6, -198630844);\r\n        d = encrypt_ii(d, a, b, c, x[i + 7], 10, 1126891415);\r\n        c = encrypt_ii(c, d, a, b, x[i + 14], 15, -1416354905);\r\n        b = encrypt_ii(b, c, d, a, x[i + 5], 21, -57434055);\r\n        a = encrypt_ii(a, b, c, d, x[i + 12], 6, 1700485571);\r\n        d = encrypt_ii(d, a, b, c, x[i + 3], 10, -1894986606);\r\n        c = encrypt_ii(c, d, a, b, x[i + 10], 15, -1051523);\r\n        b = encrypt_ii(b, c, d, a, x[i + 1], 21, -2054922799);\r\n        a = encrypt_ii(a, b, c, d, x[i + 8], 6, 1873313359);\r\n        d = encrypt_ii(d, a, b, c, x[i + 15], 10, -30611744);\r\n        c = encrypt_ii(c, d, a, b, x[i + 6], 15, -1560198380);\r\n        b = encrypt_ii(b, c, d, a, x[i + 13], 21, 1309151649);\r\n        a = encrypt_ii(a, b, c, d, x[i + 4], 6, -145523070);\r\n        d = encrypt_ii(d, a, b, c, x[i + 11], 10, -1120210379);\r\n        c = encrypt_ii(c, d, a, b, x[i + 2], 15, 718787259);\r\n        b = encrypt_ii(b, c, d, a, x[i + 9], 21, -343485551);\r\n\r\n        a = safe_add(a, olda);\r\n        b = safe_add(b, oldb);\r\n        c = safe_add(c, oldc);\r\n        d = safe_add(d, oldd);\r\n    }\r\n    return Array(a, b, c, d);\r\n}\r\n\r\n/*\r\n * These functions implement the four basic operations the algorithm uses.\r\n */\r\nfunction encrypt_cmn(q, a, b, x, s, t) {\r\n    return safe_add(bit_rol(safe_add(safe_add(a, q), safe_add(x, t)), s), b);\r\n}\r\nfunction encrypt_ff(a, b, c, d, x, s, t) {\r\n    return encrypt_cmn((b & c) | (~b & d), a, b, x, s, t);\r\n}\r\nfunction encrypt_gg(a, b, c, d, x, s, t) {\r\n    return encrypt_cmn((b & d) | (c & ~d), a, b, x, s, t);\r\n}\r\nfunction encrypt_hh(a, b, c, d, x, s, t) {\r\n    return encrypt_cmn(b ^ c ^ d, a, b, x, s, t);\r\n}\r\nfunction encrypt_ii(a, b, c, d, x, s, t) {\r\n    return encrypt_cmn(c ^ (b | ~d), a, b, x, s, t);\r\n}\r\n\r\n/*\r\n * Calculate the HMAC-encrypt, of a key and some data\r\n */\r\nfunction core_hmac_encrypt(key, data) {\r\n    let bkey = str2binl(key);\r\n    if (bkey.length > 16) {\r\n        bkey = core_encrypt(bkey, key.length * chrsz);\r\n    }\r\n\r\n    const ipad = Array(16);\r\n    const opad = Array(16);\r\n    for (let i = 0; i < 16; i++) {\r\n        ipad[i] = bkey[i] ^ 0x36363636;\r\n        opad[i] = bkey[i] ^ 0x5c5c5c5c;\r\n    }\r\n\r\n    const hash = core_encrypt(ipad.concat(str2binl(data)), 512 + data.length * chrsz);\r\n    return core_encrypt(opad.concat(hash), 512 + 128);\r\n}\r\n\r\n/*\r\n * Add integers, wrapping at 2^32. This uses 16-bit operations internally\r\n * to work around bugs in some JS interpreters.\r\n */\r\nfunction safe_add(x, y) {\r\n    const lsw = (x & 0xffff) + (y & 0xffff);\r\n    const msw = (x >> 16) + (y >> 16) + (lsw >> 16);\r\n    return (msw << 16) | (lsw & 0xffff);\r\n}\r\n\r\n/*\r\n * Bitwise rotate a 32-bit number to the left.\r\n */\r\nfunction bit_rol(num, cnt) {\r\n    return (num << cnt) | (num >>> (32 - cnt));\r\n}\r\n\r\n/*\r\n * Convert a string to an array of little-endian words\r\n * If chrsz is ASCII, characters >255 have their hi-byte silently ignored.\r\n */\r\nfunction str2binl(str: string): any[] {\r\n    const bin = Array();\r\n    const mask = (1 << chrsz) - 1;\r\n    for (let i = 0; i < str.length * chrsz; i += chrsz) {\r\n        bin[i >> 5] |= (str.charCodeAt(i / chrsz) & mask) << i % 32;\r\n    }\r\n    return bin;\r\n}\r\n\r\n/*\r\n * Convert an array of little-endian words to a string\r\n */\r\nfunction binl2str(bin) {\r\n    let str = '';\r\n    const mask = (1 << chrsz) - 1;\r\n    for (let i = 0; i < bin.length * 32; i += chrsz) {\r\n        str += String.fromCharCode((bin[i >> 5] >>> i % 32) & mask);\r\n    }\r\n    return str;\r\n}\r\n\r\n/*\r\n * Convert an array of little-endian words to a hex string.\r\n */\r\nfunction binl2hex(binarray) {\r\n    // tslint:disable-next-line: variable-name\r\n    const hex_tab = hexcase ? '0123456789ABCDEF' : '0123456789abcdef';\r\n    let str = '';\r\n    for (let i = 0; i < binarray.length * 4; i++) {\r\n        str +=\r\n            hex_tab.charAt((binarray[i >> 2] >> ((i % 4) * 8 + 4)) & 0xf) +\r\n            hex_tab.charAt((binarray[i >> 2] >> ((i % 4) * 8)) & 0xf);\r\n    }\r\n    return str;\r\n}\r\n\r\n/*\r\n * Convert an array of little-endian words to a base-64 string\r\n */\r\nfunction binl2b64(binarray) {\r\n    const tab = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';\r\n    let str = '';\r\n    for (let i = 0; i < binarray.length * 4; i += 3) {\r\n        const triplet =\r\n            (((binarray[i >> 2] >> (8 * (i % 4))) & 0xff) << 16) |\r\n            (((binarray[(i + 1) >> 2] >> (8 * ((i + 1) % 4))) & 0xff) << 8) |\r\n            ((binarray[(i + 2) >> 2] >> (8 * ((i + 2) % 4))) & 0xff);\r\n        for (let j = 0; j < 4; j++) {\r\n            if (i * 8 + j * 6 > binarray.length * 32) {\r\n                str += b64pad;\r\n            } else {\r\n                str += tab.charAt((triplet >> (6 * (3 - j))) & 0x3f);\r\n            }\r\n        }\r\n    }\r\n    return str;\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { encrypt } from './encrypt';\r\n\r\n\r\n\r\n@Injectable()\r\nexport class IdService {\r\n    private static previous = 0;\r\n    generate() {\r\n        return this.guid();\r\n    }\r\n    encrypt(str: string, type = 'hex') {\r\n        return encrypt(str, type);\r\n    }\r\n    guid() {\r\n        const _crypto = window.crypto ? crypto : window['msCrypto'];\r\n        if (_crypto) {\r\n            return (([1e7] as any) + -1e3 + -4e3 + -8e3 + -1e11).replace(/[018]/g, c =>\r\n                (c ^ (_crypto.getRandomValues(new Uint8Array(1))[0] & (15 >> (c / 4)))).toString(16)\r\n            );\r\n        } else {\r\n            return this.uuid();\r\n        }\r\n    }\r\n\r\n    uuid() {\r\n        const timestamp = Date.now().valueOf();\r\n        let uuid = 0;\r\n\r\n        if (timestamp > IdService.previous) {\r\n            IdService.previous = timestamp;\r\n            uuid = timestamp;\r\n        } else {\r\n            IdService.previous = IdService.previous + 100;\r\n            uuid = IdService.previous;\r\n        }\r\n\r\n        return uuid.toString(16);\r\n    }\r\n}\r\n","import { Pipe, PipeTransform } from '@angular/core';\r\n\r\n/**\r\n * \r\n * let message = \" {0} {1}\"\r\n * template:\r\n * <h1>{{ message| replaceX: '', '' }}</h1>\r\n * resule:\r\n * <h1>  </h1>\r\n */\r\n@Pipe({name: 'replaceX'})\r\nexport class FarrisReplaceXPipe implements PipeTransform {\r\n    transform(value: any, ...args: any[]) {\r\n        args.forEach((v, i) => {\r\n            value = value.replace(`{${i}}`, v);\r\n        });\r\n\r\n        return value;\r\n    }\r\n}\r\n","import { cloneDeep } from 'lodash-es';\r\n/*\r\n * @Author: (Lucas Huang)\r\n * @Date: 2019-06-16 13:44:59\r\n * @LastEditors: (Lucas Huang)\r\n * @LastEditTime: 2019-08-15 09:47:34\r\n * @QQ: 1055818239\r\n * @Version: v0.0.1\r\n */\r\nimport { BehaviorSubject, Observable } from 'rxjs';\r\nimport { Injectable } from '@angular/core';\r\nimport {merge} from 'lodash-es';\r\nimport { map } from 'rxjs/operators';\r\nimport { CommonUtils } from './../common.utils';\r\n\r\n\r\nexport interface RuntimeState {\r\n    form?: { [key: string]: any};\r\n    model?: { [key: string]: any};\r\n}\r\n\r\nconst DefaultRuntimeState: RuntimeState = {\r\n    form: {},\r\n    model: {}\r\n};\r\n\r\n\r\n@Injectable({\r\n    providedIn: 'root'\r\n})\r\nexport class RuntimeStateService {\r\n\r\n    private _state: RuntimeState;\r\n\r\n    private stateSubject = new BehaviorSubject<RuntimeState>({});\r\n\r\n    state$: Observable<RuntimeState> = this.stateSubject.asObservable();\r\n\r\n    form$:Observable<any> = this.state$.pipe(\r\n                    map((state: RuntimeState) => state.form));\r\n\r\n    lookupIsPending$: Observable<boolean> = this.form$.pipe( map(f => f.lookup.pending) );\r\n\r\n    private _formState: any;\r\n    private _lookupState: any;\r\n\r\n    constructor(private utils: CommonUtils) {\r\n        this._state = cloneDeep(DefaultRuntimeState);\r\n        this._formState = this._state.form;\r\n        this._lookupState = this._formState.lookup;\r\n    }\r\n\r\n    private setValue(newVal: { [key: string]: any }) {\r\n        if (newVal) {\r\n            this._state = merge(this._state, newVal);\r\n            this.stateSubject.next(this._state);\r\n        }\r\n    }\r\n\r\n    private getValue(keyPath: string) {\r\n        return this.utils.getValue(keyPath, this._state);\r\n    }\r\n\r\n    destroy() {\r\n        this._state = {\r\n            form: {},\r\n            model: {}\r\n        };\r\n        this._formState = this._state.form;\r\n        this._lookupState = this._formState.lookup;\r\n        this.stateSubject.next(this._state);\r\n    }\r\n\r\n    setLookupInstance(el: any) {\r\n        this.setValue({form: { lookup: { instance: el }}});\r\n    }\r\n\r\n    updateFormState(newVal: {[key: string]: any}) {\r\n        this.setValue({ form: newVal });\r\n    }\r\n\r\n    getFormState(keyPath: string) {\r\n        return this.getValue('form.' + keyPath);\r\n    }\r\n\r\n    eventPath(evt: any) {\r\n        const path = (evt.composedPath && evt.composedPath()) || evt.path, target = evt.target;\r\n\r\n        if (path != null) {\r\n            return (path.indexOf(window) < 0) ? path.concat(window) : path;\r\n        }\r\n\r\n        if (target === window) {\r\n            return [window];\r\n        }\r\n\r\n        const getParents = (node, memo = undefined) => {\r\n            memo = memo || [];\r\n            const parentNode = node.parentNode;\r\n\r\n            if (!parentNode) {\r\n                return memo;\r\n            } else {\r\n                return getParents(parentNode, memo.concat(parentNode));\r\n            }\r\n        };\r\n\r\n        return [target].concat(getParents(target), window);\r\n    }\r\n}\r\n","import { Pipe, PipeTransform } from '@angular/core';\r\nimport { CommonUtils } from '../common.utils';\r\n\r\n@Pipe({\r\n    name: 'getvalue'\r\n})\r\n\r\nexport class GetValuePipe implements PipeTransform {\r\n\r\n    constructor(private utils: CommonUtils) {}\r\n\r\n    transform(field: any, ...args: any[]): any {\r\n        return this.utils.getValue(field, args[0], args[1]);\r\n    }\r\n}","import { Injectable } from \"@angular/core\";\r\n\r\n\r\nexport interface OverLayOption {\r\n    /** top Window  */\r\n    onlyTopWindow?: boolean;\r\n    /**  */\r\n    mouseWheel?: boolean;\r\n    mouseDown?: boolean;\r\n    scroll?: boolean;\r\n    mouseUp?: boolean;\r\n    click?: boolean;\r\n}\r\n\r\nconst OverLayOptionDefaults: OverLayOption = {\r\n    onlyTopWindow: false,\r\n    mouseWheel: true,\r\n    mouseDown: true,\r\n    scroll: false,\r\n    mouseUp: false,\r\n    click: false\r\n}\r\n@Injectable()\r\nexport class OverLayHiddenService {\r\n    \r\n    private eventsMap = new WeakMap();\r\n\r\n    private iframeEventHandle(el: any, action: 'addEventListener' | 'removeEventListener') {\r\n        const iframes = Array.from(document.querySelectorAll('iframe'));\r\n        if (iframes && iframes.length) {\r\n            let _documentClickEvent = this.eventsMap.get(el);\r\n            for (const iframe of iframes) {\r\n                const iframeDoc = iframe.contentDocument;\r\n                if (iframeDoc) {\r\n                    iframeDoc[action]('mousedown', _documentClickEvent);\r\n                    iframeDoc[action]('mousewheel', _documentClickEvent);\r\n                    iframeDoc[action]('DOMMouseScroll', _documentClickEvent);\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    private removeMouseEvent(el: Element) {\r\n        let _documentClickEvent = this.eventsMap.get(el)\r\n        if (_documentClickEvent) {\r\n            document.removeEventListener('mousedown', _documentClickEvent, true);\r\n            document.removeEventListener('mousewheel', _documentClickEvent, true);\r\n            document.removeEventListener('DOMMouseScroll', _documentClickEvent, true);\r\n\r\n            if (top !== window) {\r\n                top.document.body.removeEventListener('mousedown', _documentClickEvent, true);\r\n            }\r\n\r\n            this.iframeEventHandle(el, 'removeEventListener');\r\n            _documentClickEvent = null;\r\n\r\n            this.eventsMap.delete(el);\r\n        }\r\n    }\r\n\r\n    destory(el) {\r\n        this.removeMouseEvent(el);\r\n    }\r\n\r\n    registerMouseEvent(el: any, _documentClickEvent: (e) => void, options?: OverLayOption) {\r\n        \r\n        // const _documentClickEvent1 = (e) => {\r\n        //     if (e && e.target && e.target.nodeName.toLowerCase() == 'svg') {\r\n        //         return;\r\n        //     }\r\n\r\n        //     _documentClickEvent(e);\r\n        // }\r\n\r\n\r\n        if (this.eventsMap.has(el)) {\r\n            return;\r\n        } else {\r\n            this.eventsMap.set(el, _documentClickEvent);\r\n\r\n        }\r\n\r\n        if (!options) {\r\n            options = OverLayOptionDefaults;\r\n        } else {\r\n            options = Object.assign( {}, OverLayOptionDefaults, options);\r\n        }\r\n\r\n\r\n        if (options.onlyTopWindow && top !== window) {\r\n            top.document.body.addEventListener('mousedown', _documentClickEvent, true);\r\n        } else {\r\n            if (options.mouseDown) {\r\n                //  mousedown  panel\r\n                document.addEventListener('mousedown', _documentClickEvent, true);\r\n            }\r\n\r\n            if (options.mouseWheel) {\r\n                document.addEventListener('mousewheel', _documentClickEvent, true);\r\n                document.addEventListener('DOMMouseScroll', _documentClickEvent, true);\r\n            }\r\n\r\n            if (options.scroll) {\r\n                document.addEventListener('scroll', _documentClickEvent, true);\r\n            }\r\n\r\n            if (options.mouseUp) {\r\n                document.addEventListener('mouseup', _documentClickEvent);\r\n            }\r\n\r\n            if (options.click) {\r\n                document.addEventListener('click', _documentClickEvent);\r\n            }\r\n\r\n\r\n            if (top !== window) {\r\n                top.document.body.addEventListener('mousedown', _documentClickEvent, true);\r\n            }\r\n\r\n            this.iframeEventHandle(el, 'addEventListener');\r\n        }\r\n\r\n        return () => {\r\n            this.destory(el);\r\n        }\r\n    }\r\n}","/*\r\n * @Author: (Lucas Huang)\r\n * @Date: 2019-06-16 13:44:59\r\n * @LastEditors: (Lucas Huang)\r\n * @LastEditTime: 2019-10-24 13:49:33\r\n * @QQ: 1055818239\r\n * @Version: v0.0.1\r\n */\r\nimport { NgModule, ModuleWithProviders } from '@angular/core';\r\nimport { FarrisSafePipe } from './safe.pipe';\r\nimport { FarrisTemplateDirective } from './directives/farris-template.directive';\r\nimport { IdService } from './id.service';\r\nimport { ResizeObserverDirective } from './directives/resize-observer.directive';\r\nimport { FarrisReplaceXPipe } from './replaceX.pipe';\r\nimport { RuntimeStateService } from './service/runtime-state.service';\r\nimport { CommonUtils } from './common.utils';\r\nimport { GetValuePipe } from './directives/getvalue.pipe';\r\nimport { FarrisComponentTemplateDirective } from './directives/component-template.directive';\r\nimport { OverLayHiddenService } from './service/overlay-hidden.service';\r\n\r\n@NgModule({\r\n    declarations: [\r\n        FarrisSafePipe,\r\n        FarrisTemplateDirective,\r\n        ResizeObserverDirective,\r\n        FarrisReplaceXPipe,\r\n        GetValuePipe,\r\n        FarrisComponentTemplateDirective\r\n    ],\r\n    imports: [\r\n    ],\r\n    exports: [\r\n        FarrisSafePipe,\r\n        FarrisTemplateDirective,\r\n        ResizeObserverDirective,\r\n        FarrisReplaceXPipe,\r\n        GetValuePipe,\r\n        FarrisComponentTemplateDirective\r\n    ]\r\n})\r\nexport class FarrisCommonModule {\r\n    static forRoot(): ModuleWithProviders {\r\n        return {\r\n            ngModule: FarrisCommonModule,\r\n            providers: [\r\n                CommonUtils,\r\n                RuntimeStateService,\r\n                IdService,\r\n                OverLayHiddenService\r\n            ]\r\n        };\r\n    }\r\n}\r\n","import { FarrisDataState } from './farris-dataitem';\r\nimport { BehaviorSubject, Observable } from 'rxjs';\r\nimport { map } from 'rxjs/operators';\r\n\r\nexport class BaseDataFacadeService<T extends FarrisDataState> {\r\n    protected _state = this._initState;\r\n    disableExpress: (item) => boolean;\r\n\r\n    readonly store  = new BehaviorSubject<T>(this._state);\r\n    readonly state$ = this.store.asObservable();\r\n\r\n    data$: Observable<any> = this.state$.pipe(map((state: T) => state.data));\r\n\r\n    constructor(private _initState: T) {\r\n    }\r\n\r\n    private initData(data: any) {\r\n        return data.map(d => {\r\n            const _id = d[this._state.idField];\r\n            const disable = () => {\r\n                return this.disableExpress ? this.disableExpress(d) : d[this._state.disabledField] ? true: false;\r\n            };\r\n            return {\r\n                id: _id,\r\n                data: d,\r\n                disabled: disable(),\r\n            };\r\n        });\r\n    }\r\n\r\n    protected updateState(state: any) {\r\n        const newState = {...this._state, ...state};\r\n        this.store.next(this._state = newState);\r\n    }\r\n\r\n    initState(state: any) {\r\n        this.updateState(state);\r\n    }\r\n\r\n    isSelect(id: any) {\r\n        if (this._state.selections && this._state.selections.length) {\r\n            return this._state.selections.find(item => !!item ? item[this._state.idField] == id : false) !== undefined;\r\n        }\r\n        return false;\r\n    }\r\n\r\n\r\n    loadData(data: any, selectValues: string = '', separator = ',') {\r\n        if (data) {\r\n            const _data = this.initData(data);\r\n            this.updateState({...this._state, data: _data});\r\n\r\n            if (selectValues) {\r\n                this.setSelections(selectValues, separator);\r\n            } else {\r\n                this._state.selections = [];\r\n            }\r\n        } else {\r\n            this.updateState({ data: [], selections: [] });\r\n        }\r\n    }\r\n\r\n    getSelections() {\r\n        return this._state.selections;\r\n    }\r\n\r\n    setSelections(selectValues: string, separator = ',') {\r\n        if (selectValues) {\r\n            let selectedItems = [];\r\n            if (this._state.multiSelect) {\r\n                selectedItems = selectValues.split(separator).map( val => {\r\n                    return this._state.data.find(d => d.data[this._state.valueField] + '' == val);\r\n                }).map( n => {\r\n                    return n ? n.data : '';\r\n                }).filter(n => n);\r\n            } else {\r\n                selectedItems = [this._state.data.find(d => d.data[this._state.valueField] + '' == selectValues)];\r\n            }\r\n            this.updateState({selections: selectedItems });\r\n        }\r\n    }\r\n\r\n    selectAll() {\r\n        this.updateState({selections: this._state.data.map(n => n.data) });\r\n    }\r\n\r\n    unSelectAll() {\r\n        this.clearSelections();\r\n    }\r\n\r\n    selectItem(data: any, index?: number) {\r\n        const idfield = this._state.idField;\r\n        let selections = this.getSelections();\r\n\r\n        const id = data[idfield];\r\n        if (!this._state.multiSelect) {\r\n            if (!this.isSelect(id)) {\r\n                selections = [ data ];\r\n            }\r\n        } else {\r\n            if (!this.isSelect(id)) {\r\n                selections.push(data);\r\n            }\r\n        }\r\n\r\n        const items = this.cloneArray(selections);\r\n\r\n        this.updateState({selections: items});\r\n    }\r\n\r\n    unSelectItem(data: any) {\r\n        const idfield = this._state.idField;\r\n        let selections = this.getSelections();\r\n        const id = data[idfield];\r\n        if (!this._state.multiSelect) {\r\n            selections = [];\r\n        } else {\r\n            selections = selections.filter(n => n[idfield] != id) ;\r\n        }\r\n\r\n        const items = this.cloneArray(selections);\r\n        this.updateState({selections: items});\r\n    }\r\n\r\n    clearSelections() {\r\n        this.updateState({selections: []});\r\n    }\r\n\r\n    private cloneArray(arr: any[]) {\r\n        if (arr && arr.length) {\r\n            return arr.map( n => n);\r\n        }\r\n\r\n        return arr;\r\n    }\r\n}\r\n","import { Injectable } from '@angular/core';\r\n\r\n@Injectable({\r\n    providedIn: 'root'\r\n})\r\nexport class FarrisComponentInstanceService {\r\n\r\n    private _state = new WeakMap();\r\n\r\n    constructor() {}\r\n\r\n    add(key: any, value: any) {\r\n        this._state.set(key, value);\r\n    }\r\n\r\n    get(key: any) {\r\n        return this._state.get(key);\r\n    }\r\n\r\n    destroy(key: any) {\r\n        this._state.set(key, null);\r\n        this._state.delete(key);\r\n    }\r\n}\r\n\r\n","import { Injector } from '@angular/core';\r\nimport { Injectable, InjectionToken } from '@angular/core';\r\nimport { fromEvent, Subject, Subscription } from 'rxjs';\r\nimport { takeUntil } from 'rxjs/operators';\r\n\r\n\r\n@Injectable({\r\n    providedIn: 'root'\r\n})\r\nexport class DebugService {\r\n    isDebug = false;\r\n    \r\n    private destroy$ = new Subject();\r\n    private debugSub: Subscription = null;\r\n\r\n    constructor() {\r\n    }\r\n\r\n    destroy() {\r\n        this.destroy$.next();\r\n        this.destroy$.complete();\r\n    }\r\n\r\n    private writeMessage( type: 'log' | 'warn' | 'error' | 'info', ...msg: any) {\r\n        if (this.isDebug) {\r\n            console[type](...msg);\r\n        }\r\n    }\r\n\r\n    log(...msg: any) {\r\n        this.writeMessage('log', msg);\r\n    }\r\n\r\n    warn(...msg: any) {\r\n        this.writeMessage('warn', msg);\r\n    }\r\n\r\n    error(...msg: any) {\r\n        this.writeMessage('error', msg);\r\n    }\r\n\r\n    info(...msg: any) {\r\n        this.writeMessage('info', msg);\r\n    }\r\n\r\n    useDebugMode() {\r\n        if (!this.debugSub) {\r\n            this.debugSub = fromEvent(document.body, 'keydown').pipe(\r\n                takeUntil(this.destroy$)\r\n            ).subscribe( (e: KeyboardEvent) => {\r\n                if (e.ctrlKey && e.shiftKey && e.key === 'D') {\r\n                    e.preventDefault();\r\n                    e.stopPropagation();\r\n                    this.isDebug = !this.isDebug;\r\n                    // console.log(`%c Farris debug mode is ${ this.isDebug ? 'startting' : 'stopped'}.`, 'color: blue; font-weight:bold;font-size:16px')\r\n                    console.log(`%c Farris debug mode is ${  this.isDebug ? 'startting' : 'stopped'}.`, `color: ${  this.isDebug? 'green': 'red' }; font-weight:bold;font-size:16px`)\r\n                }\r\n            });\r\n        }\r\n\r\n        return this.debugSub;\r\n    }\r\n}\r\n","// tslint:disable:no-any typedef no-invalid-this\r\nconst availablePrefixes = ['moz', 'ms', 'webkit'];\r\n\r\nfunction requestAnimationFramePolyfill(): typeof requestAnimationFrame {\r\n    let lastTime = 0;\r\n    return (callback: FrameRequestCallback): any => {\r\n        const currTime = new Date().getTime();\r\n        const timeToCall = Math.max(0, 16 - (currTime - lastTime));\r\n        const id = setTimeout(() => {\r\n            callback(currTime + timeToCall);\r\n        }, timeToCall);\r\n        lastTime = currTime + timeToCall;\r\n        return id;\r\n    };\r\n}\r\n\r\nfunction getRequestAnimationFrame(): typeof requestAnimationFrame {\r\n    if (typeof window === 'undefined') {\r\n        return () => 0;\r\n    }\r\n    if (window.requestAnimationFrame) {\r\n        // https://github.com/vuejs/vue/issues/4465\r\n        return window.requestAnimationFrame.bind(window);\r\n    }\r\n\r\n    const prefix = availablePrefixes.filter(key => `${key}RequestAnimationFrame` in window)[0];\r\n\r\n    return prefix ? (window as any)[`${prefix}RequestAnimationFrame`] : requestAnimationFramePolyfill();\r\n}\r\nexport function cancelRequestAnimationFrame(id: number): any {\r\n    if (typeof window === 'undefined') {\r\n        return null;\r\n    }\r\n    if (window.cancelAnimationFrame) {\r\n        return window.cancelAnimationFrame(id);\r\n    }\r\n    const prefix = availablePrefixes.filter(\r\n        key => `${key}CancelAnimationFrame` in window || `${key}CancelRequestAnimationFrame` in window\r\n    )[0];\r\n\r\n    return prefix\r\n        ? ((window as any)[`${prefix}CancelAnimationFrame`] || (window as any)[`${prefix}CancelRequestAnimationFrame`])\r\n              // @ts-ignore\r\n              .call(this, id)\r\n        : clearTimeout(id);\r\n}\r\n\r\nexport const reqAnimFrame = getRequestAnimationFrame();\r\n","\r\n\r\nexport interface RichCommandGroup {\r\n    groupName: string;\r\n    values: Array<string | RichEditorCommand>;\r\n    selected?: boolean;\r\n}\r\n\r\nexport type SelectedCommand = Array<string | RichCommandGroup>;\r\n\r\n/**  */\r\nexport type RichTextEditorToolbars = SelectedCommand;\r\n\r\n\r\nexport interface RichEditorCommand {\r\n    code: string;\r\n    cls: string;\r\n    title: string;\r\n    value: any;\r\n    selected?: boolean;\r\n    visible?: boolean;\r\n}\r\n// ['bold', 'italic', 'code-block', { header: 1 }, { header: 2 }, { list: 'ordered' }, { list: 'bullet' }, 'image']\r\nexport const RICH_COMMANDS = {\r\n    concise: [\r\n        // { visible: true, code: 'formatselect', cls: 'mr-1 f-icon f-icon-convert-lowercase', title: '&', value: [{ header: [1, 2, 3, 4, 5, 6, false] }] },\r\n        // { visible: true, code: 'fontselect', cls: 'mr-1 f-icon f-icon-font-family', title: '', value: [{ font: ['Microsoft-YaHei', 'SimSun', 'SimHei', 'KaiTi', 'FangSong', 'Arial', 'Times', 'sans-serif'] }] },\r\n        // { visible: true, code: 'fontsizeselect', cls: 'mr-1 f-icon f-icon-font-size', title: '', value: [{ size: ['small', false, 'large', 'huge'] }] },\r\n        { visible: true, code: 'bold', cls: 'mr-1 rich-toolbar-icons rich-bold', title: '', value: ['bold'] },\r\n        { visible: true, code: 'italic', cls: 'mr-1 rich-toolbar-icons rich-italic', title: '', value: ['italic'] },\r\n        { visible: true, code: 'underline', cls: 'mr-1 rich-toolbar-icons rich-underline', title: '', value: ['underline'] },\r\n        { visible: true, code: 'strike', cls: 'mr-1 rich-toolbar-icons rich-strike', title: '', value: ['strike'] },\r\n        { visible: true, code: 'numlist', cls: 'mr-1 rich-toolbar-icons rich-ordered', title: '', value: [{ list: 'ordered' }] },\r\n        { visible: true, code: 'bullist', cls: 'mr-1 rich-toolbar-icons rich-bullet', title: '', value: [{ list: 'bullet' }] },\r\n        // { visible: true, code: 'outdent', cls: 'mr-1 rich-toolbar-icons rich-indent-1', title: '', value: [{ indent: '-1' }] },\r\n        // { visible: true, code: 'indent', cls: 'mr-1 rich-toolbar-icons rich-indent1', title: '', value: [{ indent: '+1' }] },\r\n        // { visible: true, code: 'forecolor', cls: 'mr-1 rich-toolbar-icons rich-color', title: '', value: [{ color: [] }] },\r\n        // { visible: true, code: 'backcolor', cls: 'mr-1 rich-toolbar-icons rich-background', title: '', value: [{ background: [] }] },\r\n        // { visible: true, code: 'link', cls: 'mr-1 rich-toolbar-icons rich-link', title: '', value: ['link'] },\r\n        // { visible: true, code: 'removeformat', cls: 'mr-1 rich-toolbar-icons rich-clear', title: '', value: ['clean'] },\r\n        // { visible: true, code: 'blockquote', cls: 'mr-1 rich-toolbar-icons rich-blockquote', title: '', value: ['blockquote'] },\r\n        { visible: true, code: 'code-block', cls: 'mr-1 rich-toolbar-icons rich-code-block', title: '', value: ['code-block'] },\r\n        { visible: true, code: 'header1', cls: 'mr-1 rich-toolbar-icons rich-header1', title: ' 1', value: [{ header: 1 }] },\r\n        { visible: true, code: 'header2', cls: 'mr-1 rich-toolbar-icons rich-header2', title: ' 2', value: [{ header: 2 }] },\r\n        { visible: true, code: 'image', cls: 'mr-1 rich-toolbar-icons rich-image', title: '', value: ['image'] },\r\n        // { visible: true, code: 'sub', cls: 'mr-1 rich-toolbar-icons rich-sub', title: '', value: [{ script: 'sub' }] },\r\n        // { visible: true, code: 'super', cls: 'mr-1 rich-toolbar-icons rich-super', title: '', value: [{ script: 'super' }] },\r\n        // { visible: true, code: 'video', cls: 'mr-1 rich-toolbar-icons rich-video', title: '', value: ['video'] },\r\n        // { visible: true, code: 'align', cls: 'mr-1 rich-toolbar-icons rich-align', title: '', value: [{align: []}] }\r\n    ],\r\n    advanced: [\r\n        {\r\n            visible: true, code: 'undo',\r\n            cls: 'mr-1 f-icon f-icon-undo',\r\n            title: '',\r\n            value: 'undo'\r\n        },\r\n        {\r\n            visible: true, code: 'redo',\r\n            cls: 'mr-1 f-icon f-icon-redo',\r\n            title: '',\r\n            value: 'redo'\r\n        },\r\n        {\r\n            visible: true, code: 'formatselect',\r\n            cls: 'mr-1 f-icon f-icon-convert-lowercase',\r\n            title: '&',\r\n            value: 'formatselect'\r\n        },\r\n        {\r\n            visible: true, code: 'fontselect',\r\n            cls: 'mr-1 f-icon f-icon-font-family',\r\n            title: '',\r\n            value: 'fontselect'\r\n        },\r\n        {\r\n            visible: true, code: 'fontsizeselect',\r\n            cls: 'mr-1 f-icon f-icon-font-size',\r\n            title: '',\r\n            value: 'fontsizeselect'\r\n        },\r\n        {\r\n            visible: true, code: 'bold',\r\n            cls: 'mr-1 rich-toolbar-icons rich-bold',\r\n            title: '',\r\n            value: 'bold'\r\n        },\r\n        {\r\n            visible: true, code: 'italic',\r\n            cls: 'mr-1 rich-toolbar-icons rich-italic',\r\n            title: '',\r\n            value: 'italic'\r\n        },\r\n        {\r\n            visible: true, code: 'underline',\r\n            cls: 'mr-1 rich-toolbar-icons rich-underline',\r\n            title: '',\r\n            value: 'underline'\r\n        },\r\n        {\r\n            visible: true, code: 'strike',\r\n            cls: 'mr-1 rich-toolbar-icons rich-strike',\r\n            title: '',\r\n            value: 'strikethrough'\r\n        },\r\n        {\r\n            visible: true, code: 'numlist',\r\n            cls: 'mr-1 rich-toolbar-icons rich-ordered',\r\n            title: '',\r\n            value: 'numlist'\r\n        },\r\n        {\r\n            visible: true, code: 'bullist',\r\n            cls: 'mr-1 rich-toolbar-icons rich-bullet',\r\n            title: '',\r\n            value: 'bullist'\r\n        },\r\n        {\r\n            visible: true, code: 'outdent',\r\n            cls: 'mr-1 rich-toolbar-icons rich-indent-1',\r\n            title: '',\r\n            value: 'outdent'\r\n        },\r\n        {\r\n            visible: true, code: 'indent',\r\n            cls: 'mr-1 rich-toolbar-icons rich-indent1',\r\n            title: '',\r\n            value: 'indent'\r\n        },\r\n        {\r\n            visible: true, code: 'forecolor',\r\n            cls: 'mr-1 rich-toolbar-icons rich-color',\r\n            title: '',\r\n            value: 'forecolor'\r\n        },\r\n        {\r\n            visible: true, code: 'backcolor',\r\n            cls: 'mr-1 rich-toolbar-icons rich-background',\r\n            title: '',\r\n            value: 'backcolor'\r\n        },\r\n        {\r\n            visible: true, code: 'image',\r\n            cls: 'mr-1 rich-toolbar-icons rich-image',\r\n            title: '',\r\n            value: 'image'\r\n        },\r\n        {\r\n            visible: true, code: 'link',\r\n            cls: 'mr-1 rich-toolbar-icons rich-link',\r\n            title: '',\r\n            value: 'link'\r\n        },\r\n        {\r\n            visible: true, code: 'removeformat',\r\n            cls: 'mr-1 rich-toolbar-icons rich-clear',\r\n            title: '',\r\n            value: 'removeformat'\r\n        },\r\n        {\r\n            visible: true, code: 'alignleft',\r\n            cls: 'mr-1 f-icon f-icon-align-left',\r\n            title: '',\r\n            value: 'alignleft'\r\n        },\r\n        {\r\n            visible: true, code: 'aligncenter',\r\n            cls: 'mr-1 f-icon f-icon-align-center',\r\n            title: '',\r\n            value: 'aligncenter'\r\n        },\r\n        {\r\n            visible: true, code: 'alignright',\r\n            cls: 'mr-1 f-icon f-icon-align-right',\r\n            title: '',\r\n            value: 'alignright'\r\n        },\r\n        {\r\n            visible: true, code: 'alignjustify',\r\n            cls: 'mr-1 f-icon f-icon-align-justify',\r\n            title: '',\r\n            value: 'alignjustify'\r\n        },\r\n        {\r\n            visible: true, code: 'table',\r\n            cls: 'mr-1 f-icon f-icon-table',\r\n            title: '',\r\n            value: 'table'\r\n        }\r\n    ]\r\n};\r\n\r\n/**\r\n * \r\n * @param designerData \r\n */\r\nexport function Convert2HtmlEditorToolbars(type: 'advanced' | 'concise', toolbars: RichTextEditorToolbars) {\r\n    if (!toolbars || !toolbars.length) {\r\n        return null;\r\n    }\r\n\r\n    const typ: string = type.toLowerCase();\r\n    const tools: any = toolbars;\r\n\r\n    const allCMDs = RICH_COMMANDS[typ];\r\n    const toolbarItems = tools.map(n => {\r\n        if (typeof n === 'object') {\r\n            n.values = n.values.map((s: string) => {\r\n                return allCMDs.find(c => c.code === s);\r\n            }).filter(t => t);\r\n\r\n            return n;\r\n        } else {\r\n            return allCMDs.find(c => c.code === n);\r\n        }\r\n    }).filter(t => t);\r\n\r\n    const configs = toolbarItems.map(n => {\r\n        if (n.groupName) {\r\n            if (typ === 'concise') {\r\n                return n.values.map(v => v.value).flat();\r\n            }\r\n            return n.values.map(v => v.value);\r\n        }\r\n        return n.value;\r\n    }).filter(n => n.length);\r\n\r\n    if (typ === 'concise') {\r\n        return configs;\r\n    } else if (typ === 'advanced') {\r\n        return configs.map((n, i) => {\r\n            if (Array.isArray(n)) {\r\n                if (i === 0) {\r\n                    n.push('|');\r\n                }\r\n                if (i > 0) {\r\n                    n.unshift('|');\r\n                }\r\n            }\r\n            return n;\r\n        }).flat().join(' ');\r\n    }\r\n}\r\n","import { InjectionToken } from \"@angular/core\";\r\n\r\nexport const WEBAPI_PREFIX_TOKEN = new InjectionToken<string>('web api prefix string.');\r\n\r\nexport function appendPerfixForUri(uri: string, perfix: string = '') {\r\n    if (perfix) {\r\n        perfix = perfix.replace(/\\/\\//g, '/').replace(/\\\\/g, '/');\r\n        if (perfix[perfix.length - 1] == '/' && uri[0] == '/') {\r\n            return perfix + uri.substring(1);\r\n        }\r\n\r\n        return perfix + uri;\r\n    }\r\n\r\n    return uri;\r\n}"]}