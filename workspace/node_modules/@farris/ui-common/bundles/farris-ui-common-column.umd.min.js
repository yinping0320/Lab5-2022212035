!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports,require("@farris/ui-common/types"),require("@farris/ui-common/date"),require("@farris/ui-common/number"),require("@angular/core")):"function"==typeof define&&define.amd?define("@farris/ui-common/column",["exports","@farris/ui-common/types","@farris/ui-common/date","@farris/ui-common/number","@angular/core"],r):r((e.farris=e.farris||{},e.farris["ui-common"]=e.farris["ui-common"]||{},e.farris["ui-common"].column={}),e.farris["ui-common"].types,e.farris["ui-common"].date,e.farris["ui-common"].number,e.ng.core)}(this,function(e,u,r,t,o){"use strict";var a=function(){return(a=Object.assign||function(e){for(var r,t=1,o=arguments.length;t<o;t++)for(var n in r=arguments[t])Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n]);return e}).apply(this,arguments)};var n=(i.prototype.format=function(e,r,t,o){if(t){if("function"==typeof t)return o=o||{},t(e,r,a({date:this.datehelper,number:this.numberhelper,format:this},o));if(t.type){var n=t;switch(n.type){case"datetime":return this.dateTimeFormat(e,n.options);case"timeago":var i=n.options.locale;return this.datehelper.relativeTime(e,i||"zh-CHS");case"number":return this.numberFormat(e,n.options);case"enum":return this.enumFormat(e,n.options);case"image":return this.imageFormat(e,n.options);case"boolean":case"boolean2":return this.booleanFormat(e,n.options);default:return e}}}return e},i.prototype.dateTimeFormat=function(e,r){if(e){var t="yyyy-MM-dd";if("string"==typeof r?t=r:"object"==typeof r&&(t=r.format||"yyyy-MM-dd"),t=t.replace("YYYY","yyyy").replace("-DD","-dd"),"object"==typeof r&&r.dateRange){var o=r.dateRangeDatesDelimiter||"~",n=function p(e,r){var t="function"==typeof Symbol&&e[Symbol.iterator];if(!t)return e;var o,n,i=t.call(e),a=[];try{for(;(void 0===r||0<r--)&&!(o=i.next()).done;)a.push(o.value)}catch(u){n={error:u}}finally{try{o&&!o.done&&(t=i["return"])&&t.call(i)}finally{if(n)throw n.error}}return a}(e.split(o),2),i=n[0],a=n[1];return(i=this.datehelper.formatTo(i,t))+o+(a=this.datehelper.formatTo(a,t))}return this.datehelper.formatTo(e,t)}return e},i.prototype.numberFormat=function(e,r){return this.numberhelper.formatNumber(e,r)},i.prototype.enumFormat=function(e,t){if(e!==undefined&&null!==e||(e=""),t&&t.data&&t.data.length){var r=e.toString(),o=[r];-1<r.indexOf(",")&&(o=r.split(","));var n=[];return o.forEach(function(r){var e=t.data.find(function(e){return e[t.valueField].toString()==r});e&&n.push(e[t.textField])}),n.length?n.join(","):e}return e},i.prototype.imageFormat=function(e,r){if(e){if(r){var t=['<img src="'+e+'" '];return r.width&&t.push('width="'+r.width+'"'),r.height&&t.push('height="'+r.height+'"'),t.push(">"),t.join("")}return'<img src="'+e+'">'}return e},i.prototype.booleanFormat=function(e,r){if(e===undefined)return"";if(r){var t=e?r.trueText:r.falseText;return null===t||t===undefined?e:t}return e},i.prototype.convertCompare=function(r){var e=u.CompareOperators.find(function(e){return e.value===r});if(e)return e.label},i.prototype.buildSortString=function(e){if(e&&e.length){var r=e.map(function(e){return e.sortField+" "+u.SortType[e.sortType].toString().toLowerCase()+","}).join(" ");return r=r&&r.substr(0,r.length-1)}return""},i.prototype.buildSqlWhere=function(e){var n=this;if(e&&e.length){var i=[],a=e.filter(function(e){return""!==e.filterField});return a.forEach(function(e,r){if(e.filterField){i.push(e.lbracket),i.push(e.filterField);var t=parseInt(e.compare.toString(),10),o=n.convertCompare(t);i.push(" "+o.replace(/\%/g,"").replace("...","")),t===u.Compare.Like||t===u.Compare.NotLike||t===u.Compare.NotLikeEndWith||t===u.Compare.LikeEndWith?(i.push("'"),i.push("%")):(i.push(" "),i.push("'")),t===u.Compare.In||t===u.Compare.NotIn?i.push(e.value.replace(/\r\n/g,",")):i.push(e.value),t!==u.Compare.Like&&t!==u.Compare.NotLike&&t!==u.Compare.LikeStartWith&&t!==u.Compare.NotLikeStartWith||i.push("%"),i.push("'"),i.push(e.rbracket),i.push(" "),r!==a.length-1&&(i.push(e.relation===u.FilterRelation.Empty?"":u.FilterRelation[e.relation].toString().toLowerCase()),i.push(" "))}}),i.join("")}return""},i.decorators=[{type:o.Injectable,args:[{providedIn:"root"}]}],i.ctorParameters=function(){return[{type:r.DateTimeHelperService},{type:t.NumberHelperService}]},i.ngInjectableDef=o.defineInjectable({factory:function(){return new i(o.inject(r.DateTimeHelperService),o.inject(t.NumberHelperService))},token:i,providedIn:"root"}),i);function i(e,r){this.datehelper=e,this.numberhelper=r}var p=(m.prototype.transform=function(e,r){for(var t=[],o=2;o<arguments.length;o++)t[o-2]=arguments[o];var n=t[0];return r&&r.formatter?this.colmunFormatSer.format(e,n,r.formatter):e},m.decorators=[{type:o.Pipe,args:[{name:"columnformatter"}]}],m.ctorParameters=function(){return[{type:o.Injector},{type:n}]},m);function m(e,r){this.injector=e,this.colmunFormatSer=r}var f=(s.forRoot=function(){return{ngModule:s,providers:[n]}},s.decorators=[{type:o.NgModule,args:[{imports:[r.DateHelperModule.forRoot(),t.NumberHelperModule.forRoot()],exports:[p],declarations:[p],providers:[]}]}],s);function s(){}e.ColumnFormatService=n,e.DataColumnModule=f,e.ColumnFormatterPipe=p,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=farris-ui-common-column.umd.min.js.map