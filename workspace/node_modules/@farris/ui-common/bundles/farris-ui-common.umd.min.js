!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("resize-observer-polyfill"),require("@farris/ui-common/column"),require("@angular/platform-browser"),require("lodash-es"),require("rxjs"),require("rxjs/operators"),require("@angular/core")):"function"==typeof define&&define.amd?define("@farris/ui-common",["exports","resize-observer-polyfill","@farris/ui-common/column","@angular/platform-browser","lodash-es","rxjs","rxjs/operators","@angular/core"],t):t((e.farris=e.farris||{},e.farris["ui-common"]={}),e.ResizeObserver,e.farris["ui-common"].column,e.ng.platformBrowser,e.lodashEs,e.rxjs,e.rxjs.operators,e.ng.core)}(this,function(e,t,r,n,o,i,a,s){"use strict";t=t&&t.hasOwnProperty("default")?t["default"]:t;var c=(l.prototype.getType=function(){return this.name},l.decorators=[{type:s.Directive,args:[{selector:"[farrisTemplate]"}]}],l.ctorParameters=function(){return[{type:s.TemplateRef}]},l.propDecorators={type:[{type:s.Input}],name:[{type:s.Input,args:["farrisTemplate"]}]},l);function l(e){this.template=e}var u=function(){return(u=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function d(e){var t="function"==typeof Symbol&&e[Symbol.iterator],r=0;return t?t.call(e):{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}}}function p(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(n=i.next()).done;)a.push(n.value)}catch(s){o={error:s}}finally{try{n&&!n.done&&(r=i["return"])&&r.call(i)}finally{if(o)throw o.error}}return a}function f(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(p(arguments[t]));return e}var h=new WeakMap,m=new t(function(e){var t,r;try{for(var n=d(e),o=n.next();!o.done;o=n.next()){var i=o.value;if(h.has(i.target))h.get(i.target)._resizeCallback(i)}}catch(a){t={error:a}}finally{try{o&&!o.done&&(r=n["return"])&&r.call(n)}finally{if(t)throw t.error}}}),v=(y.prototype._resizeCallback=function(e){e.bindintClientRect=e.target.getBoundingClientRect(),this.resize.emit(e)},y.prototype.ngOnInit=function(){var e=this.target?this.target.nativeElement:this.el.nativeElement;h.set(e,this),m.observe(e)},y.prototype.ngOnDestroy=function(){var e=this.el.nativeElement;m.unobserve(e),h["delete"](e)},y.decorators=[{type:s.Directive,args:[{selector:"[resizeObserver]"}]}],y.ctorParameters=function(){return[{type:s.ElementRef}]},y.propDecorators={target:[{type:s.Input,args:["resizeObserver"]}],resize:[{type:s.Output}]},y);function y(e){this.el=e,this.resize=new s.EventEmitter}var g=(b.prototype.ngOnInit=function(){this.renderTemplate()},b.prototype.ngOnChanges=function(e){e.ctx&&!e.ctx.isFirstChange()&&this._expandCtxToThis()},b.prototype._expandCtxToThis=function(){this.expandContext(this.ctx),this.expandContext(this.renderContext)},b.prototype.expandContext=function(t){var r=this;this.templateComponentIns&&t&&Object.keys(t).forEach(function(e){r.templateComponentIns.instance[e]=t[e]})},b.prototype.renderTemplate=function(){this.templateComponentIns=this._getCmpRef(),this.templateComponentIns&&(this._expandCtxToThis(),this.templateComponentIns.instance.ctx=this.ctx,this.el.nativeElement.append(this.templateComponentIns.location.nativeElement),this.templateComponentIns.changeDetectorRef.detectChanges())},b.prototype._getCmpRef=function(){if(this.cmpRef)return this.createInstance(this.cmpRef);if(this.column)if("cell"==this.templateType){if(this.column.componentType)return this.createInstance(this.column.componentType)}else if(this.column.headerComponentType)return this.createInstance(this.column.headerComponentType);return null},b.prototype.createInstance=function(e){if(!e)return null;return e.ngBaseDef||"function"!=typeof e?e.instance?e:this.cfr.resolveComponentFactory(e).create(this.injector):e()},b.decorators=[{type:s.Directive,args:[{selector:"[component-template]"}]}],b.ctorParameters=function(){return[{type:s.Injector},{type:s.ElementRef},{type:s.ComponentFactoryResolver}]},b.propDecorators={column:[{type:s.Input,args:["component-template"]}],cmpRef:[{type:s.Input}],ctx:[{type:s.Input}],renderContext:[{type:s.Input}],templateType:[{type:s.Input}]},b);function b(e,t,r){this.injector=e,this.el=t,this.cfr=r,this.cmpRef=null,this.templateType="cell"}var w=(S.prototype.keyIsInData=function(e,t){var r="no property";return e.split(".").reduce(function(e,t){return e&&e.hasOwnProperty(t)?e[t]:r},t)!=r},S.prototype.getValue=function(e,t,r){if(void 0===r&&(r=!1),!t)return"";var n="";return n=-1===e.indexOf(".")&&t.hasOwnProperty(e)?t[e]:e.split(".").reduce(function(e,t){return e?e[t]:null},t),r?this.formatterValue(n):n},S.prototype.setValue=function(e,t,r,n){if(void 0===n&&(n=!0),t)if(-1<t.indexOf(".")&&n){var o=null,i=t.split(".");i.reduce(function(e,t){return(o=e)[t]},e),o&&(o[i.pop()]=r)}else e[t]=r},S.prototype.getEnumItem=function(t,e,r){return e.find(function(e){return e[r]==t})},S.prototype._getEnumTitleFromColumn=function(e,t){var r=t.formatter;return r&&"object"==typeof r&&"enum"===r.type&&r.options?this.getEnumTitleFromColumnOptions(e,r.options):e},S.prototype.getEnumTitle=function(e,t){var r=this.getValue(e.field,t);return this._getEnumTitleFromColumn(r,e)},S.prototype.getEnumTitleFromColumnOptions=function(e,t){var r=t.data,n=t.valueField,o=t.textField,i=this.getEnumItem(e,r,n);return i?i[o]:e},S.prototype.escapeHtml=function(e){return null===e||e===undefined?"":e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\"/g,"&quot;").replace(/\'/g,"&#39;").replace(/\//g,"&#x2F;")},S.prototype.unescapeHtml=function(e){return null===e||e===undefined?"":e.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#39;/g,"'").replace(/&#x2F;/g,"/")},S.prototype.formatterValue=function(e){return null===e||e===undefined||""===e?"":"string"==typeof e?this.escapeHtml(e):e},S.prototype.getTextWidth=function(e,t){var r=document.createElement("canvas").getContext("2d");r.font=t;var n=r.measureText(e);return Math.round(n.width)},S.prototype.removeStyleSheet=function(e){var t=document.querySelector("#"+e);t&&t.remove()},S.prototype.createStyleSheet=function(e){var t=document.querySelector("head"),r=e,n=null;return document.querySelector("#"+r)?(n=document.querySelector("#"+r)).innerText="":((n=document.createElement("style")).id=r,t.appendChild(n)),n},S.prototype.getStyleSheet=function(e){var t,r,n=document.styleSheets,o=null;try{for(var i=d(n),a=i.next();!a.done;a=i.next()){var s=a.value;if((s.ownerNode||s.owningElement).id===e){o=s;break}}}catch(c){t={error:c}}finally{try{a&&!a.done&&(r=i["return"])&&r.call(i)}finally{if(t)throw t.error}}return o},S.prototype.appendCssRules=function(e,t){var r,n;try{for(var o=d(e),i=o.next();!i.done;i=o.next()){var a=i.value,s=a.slice(0,a.indexOf("{")),c=this.removeCssRule(s,t),l="";if(c&&(l+=c.cssText.slice(c.cssText.indexOf("{")+1,c.cssText.indexOf("}"))),l+=a.slice(a.indexOf("{")+1,a.indexOf("}")).replace(/"/g,"").replace(/,/g,";")+";",t.addRule)t.addRule(s,l,0);else{var u=s+"{ "+l+" }";t.insertRule(u,0)}}}catch(p){r={error:p}}finally{try{i&&!i.done&&(n=o["return"])&&n.call(o)}finally{if(r)throw r.error}}},S.prototype.appendCssRules2=function(e,t){var r,n;try{for(var o=d(e),i=o.next();!i.done;i=o.next()){var a=i.value,s=a.slice(0,a.indexOf("{")),c=(this.removeCssRule(s,t),a.slice(a.indexOf("{")+1,a.indexOf("}")).replace(/"/g,"").replace(/,/g,";")+";");if(t.addRule)t.addRule(s,c,0);else{var l=s+"{ "+c+" }";t.insertRule(l,0)}}}catch(u){r={error:u}}finally{try{i&&!i.done&&(n=o["return"])&&n.call(o)}finally{if(r)throw r.error}}},S.prototype.getCssRule=function(e,t){var r,n,o=t.cssRules||t.rules,i=null;try{for(var a=d(o),s=a.next();!s.done;s=a.next()){var c=s.value;c.selectorText==e&&(i=c)}}catch(l){r={error:l}}finally{try{s&&!s.done&&(n=a["return"])&&n.call(a)}finally{if(r)throw r.error}}return i},S.prototype.removeCssRule=function(e,t){var r=t.cssRules||t.rules,n=0,o=!1;do{if((o=r[n])&&o.selectorText.toLowerCase()==e.toLowerCase())return t.cssRules?t.deleteRule(n):t.removeRule(n),o;n++}while(o)},S.prototype.isNullOrUndefined=function(e){return null===e||e===undefined},S.prototype.isIE=function(){var e=window.navigator.userAgent;return/msie\s|trident\/|edge\//i.test(e)&&!!("uniqueID"in document||"documentMode"in document||"ActiveXObject"in window||"MSInputMethodContext"in window)},S.prototype.buildSortString=function(e){return this.cfs.buildSortString(e)},S.prototype.buildSqlWhere=function(e){return this.cfs.buildSqlWhere(e)},S.prototype.getBrowserType=function(){var e=navigator.userAgent.toLowerCase();return{ie:/msie/.test(e)&&!/opera/.test(e),op:/opera/.test(e),sa:/version.*safari/.test(e),ch:/chrome/.test(e),ff:/gecko/.test(e)&&!/webkit/.test(e)}},S.prototype.getFFVer=function(){var e=navigator.userAgent,t=e.indexOf("Firefox/");return t<0?0:parseFloat(e.substring(t+8,e.lastIndexOf(".")))},S.prototype.getQueryString=function(e,t){void 0===t&&(t="");var r=new RegExp("(^|&)"+e+"=([^&]*)(&|$)","i"),n=window.location.search;t&&(n=t);var o=n.substring(1).match(r);return null!=o?o[2]:null},S.prototype.getFloatingLayerIndex=function(e){void 0===e&&(e=1);var t=Array.from(document.body.querySelectorAll(["body>.f-datagrid-settings-simple-host","body>div","body>farris-dialog>.farris-modal.show","body>.farris-modal.show","body>farris-filter-panel>.f-filter-panel-wrapper","body .f-sidebar-show>.f-sidebar-main","body>.popover.show","body>filter-row-panel>.f-datagrid-filter-panel","body>.f-section-maximize"].join(","))).filter(function(e){return e}).map(function(e){var t=window.getComputedStyle(e),r=t.display,n=t.zIndex;return"none"===r?0:parseInt(n,10)}).filter(function(e){return e}),r=Math.max.apply(Math,f(t));return r<1040&&(r=1040),r+e},S.prototype.clickContinuity=function(e,t){var r=this;void 0===t&&(t=10),this.clickCountNow===undefined&&(this.clickCountNow=0),this.clickCountNow<t-1?(this.clickTimer&&(clearTimeout(this.clickTimer),this.clickTimer=null),this.clickCountNow++,this.clickTimer=setTimeout(function(){r.clickCountNow=0},300)):(this.clickCountNow++,e&&e(),this.clickTimer&&(clearTimeout(this.clickTimer),this.clickTimer=null),this.clickCountNow=0)},S.prototype.regBodyKeydownEvent=function(t,r){var e=function(e){"Escape"!==e.key&&"Enter"!==e.key||(e.preventDefault(),e.stopPropagation(),"Enter"==e.key&&t?t():r&&r())};return document.body.addEventListener("keydown",e,!0),function(){document.body.removeEventListener("keydown",e,!0)}},S.decorators=[{type:s.Injectable,args:[{providedIn:"root"}]}],S.ctorParameters=function(){return[]},S.ngInjectableDef=s.defineInjectable({factory:function(){return new S},token:S,providedIn:"root"}),S);function S(){this.cfs=null,this.cfs||(this.cfs=new r.ColumnFormatService(null,null))}var x=(C.prototype.transform=function(e,t){switch(t){case"html":return this.sanitizer.bypassSecurityTrustHtml(e);case"style":return this.sanitizer.bypassSecurityTrustStyle(e);case"script":return this.sanitizer.bypassSecurityTrustScript(e);case"url":return this.sanitizer.bypassSecurityTrustUrl(e);case"resourceUrl":return this.sanitizer.bypassSecurityTrustResourceUrl(e);default:throw new Error("Invalid safe type specified: "+t)}},C.decorators=[{type:s.Pipe,args:[{name:"safe"}]}],C.ctorParameters=function(){return[{type:n.DomSanitizer}]},C);function C(e){this.sanitizer=e}var I="",k=8;function E(e,t){return void 0===t&&(t="hex"),"hex"===t?function o(e){for(var t="0123456789abcdef",r="",n=0;n<4*e.length;n++)r+=t.charAt(e[n>>2]>>n%4*8+4&15)+t.charAt(e[n>>2]>>n%4*8&15);return r}(T(M(e),e.length*k)):"b64"===t?function i(e){for(var t="",r=0;r<4*e.length;r+=3)for(var n=(e[r>>2]>>r%4*8&255)<<16|(e[r+1>>2]>>(r+1)%4*8&255)<<8|e[r+2>>2]>>(r+2)%4*8&255,o=0;o<4;o++)8*r+6*o>32*e.length?t+=I:t+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(n>>6*(3-o)&63);return t}(T(M(e),e.length*k)):function a(e){for(var t="",r=(1<<k)-1,n=0;n<32*e.length;n+=k)t+=String.fromCharCode(e[n>>5]>>>n%32&r);return t}(T(M(e),e.length*k))}function T(e,t){e[t>>5]|=128<<t%32,e[14+(t+64>>>9<<4)]=t;for(var r=1732584193,n=-271733879,o=-1732584194,i=271733878,a=0;a<e.length;a+=16){var s=r,c=n,l=o,u=i;r=F(r,n,o,i,e[a+0],7,-680876936),i=F(i,r,n,o,e[a+1],12,-389564586),o=F(o,i,r,n,e[a+2],17,606105819),n=F(n,o,i,r,e[a+3],22,-1044525330),r=F(r,n,o,i,e[a+4],7,-176418897),i=F(i,r,n,o,e[a+5],12,1200080426),o=F(o,i,r,n,e[a+6],17,-1473231341),n=F(n,o,i,r,e[a+7],22,-45705983),r=F(r,n,o,i,e[a+8],7,1770035416),i=F(i,r,n,o,e[a+9],12,-1958414417),o=F(o,i,r,n,e[a+10],17,-42063),n=F(n,o,i,r,e[a+11],22,-1990404162),r=F(r,n,o,i,e[a+12],7,1804603682),i=F(i,r,n,o,e[a+13],12,-40341101),o=F(o,i,r,n,e[a+14],17,-1502002290),r=j(r,n=F(n,o,i,r,e[a+15],22,1236535329),o,i,e[a+1],5,-165796510),i=j(i,r,n,o,e[a+6],9,-1069501632),o=j(o,i,r,n,e[a+11],14,643717713),n=j(n,o,i,r,e[a+0],20,-373897302),r=j(r,n,o,i,e[a+5],5,-701558691),i=j(i,r,n,o,e[a+10],9,38016083),o=j(o,i,r,n,e[a+15],14,-660478335),n=j(n,o,i,r,e[a+4],20,-405537848),r=j(r,n,o,i,e[a+9],5,568446438),i=j(i,r,n,o,e[a+14],9,-1019803690),o=j(o,i,r,n,e[a+3],14,-187363961),n=j(n,o,i,r,e[a+8],20,1163531501),r=j(r,n,o,i,e[a+13],5,-1444681467),i=j(i,r,n,o,e[a+2],9,-51403784),o=j(o,i,r,n,e[a+7],14,1735328473),r=R(r,n=j(n,o,i,r,e[a+12],20,-1926607734),o,i,e[a+5],4,-378558),i=R(i,r,n,o,e[a+8],11,-2022574463),o=R(o,i,r,n,e[a+11],16,1839030562),n=R(n,o,i,r,e[a+14],23,-35309556),r=R(r,n,o,i,e[a+1],4,-1530992060),i=R(i,r,n,o,e[a+4],11,1272893353),o=R(o,i,r,n,e[a+7],16,-155497632),n=R(n,o,i,r,e[a+10],23,-1094730640),r=R(r,n,o,i,e[a+13],4,681279174),i=R(i,r,n,o,e[a+0],11,-358537222),o=R(o,i,r,n,e[a+3],16,-722521979),n=R(n,o,i,r,e[a+6],23,76029189),r=R(r,n,o,i,e[a+9],4,-640364487),i=R(i,r,n,o,e[a+12],11,-421815835),o=R(o,i,r,n,e[a+15],16,530742520),r=D(r,n=R(n,o,i,r,e[a+2],23,-995338651),o,i,e[a+0],6,-198630844),i=D(i,r,n,o,e[a+7],10,1126891415),o=D(o,i,r,n,e[a+14],15,-1416354905),n=D(n,o,i,r,e[a+5],21,-57434055),r=D(r,n,o,i,e[a+12],6,1700485571),i=D(i,r,n,o,e[a+3],10,-1894986606),o=D(o,i,r,n,e[a+10],15,-1051523),n=D(n,o,i,r,e[a+1],21,-2054922799),r=D(r,n,o,i,e[a+8],6,1873313359),i=D(i,r,n,o,e[a+15],10,-30611744),o=D(o,i,r,n,e[a+6],15,-1560198380),n=D(n,o,i,r,e[a+13],21,1309151649),r=D(r,n,o,i,e[a+4],6,-145523070),i=D(i,r,n,o,e[a+11],10,-1120210379),o=D(o,i,r,n,e[a+2],15,718787259),n=D(n,o,i,r,e[a+9],21,-343485551),r=O(r,s),n=O(n,c),o=O(o,l),i=O(i,u)}return Array(r,n,o,i)}function _(e,t,r,n,o,i){return O(function a(e,t){return e<<t|e>>>32-t}(O(O(t,e),O(n,i)),o),r)}function F(e,t,r,n,o,i,a){return _(t&r|~t&n,e,t,o,i,a)}function j(e,t,r,n,o,i,a){return _(t&n|r&~n,e,t,o,i,a)}function R(e,t,r,n,o,i,a){return _(t^r^n,e,t,o,i,a)}function D(e,t,r,n,o,i,a){return _(r^(t|~n),e,t,o,i,a)}function O(e,t){var r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r}function M(e){for(var t=Array(),r=(1<<k)-1,n=0;n<e.length*k;n+=k)t[n>>5]|=(e.charCodeAt(n/k)&r)<<n%32;return t}var A=(P.prototype.generate=function(){return this.guid()},P.prototype.encrypt=function(e,t){return void 0===t&&(t="hex"),E(e,t)},P.prototype.guid=function(){var t=window.crypto?crypto:window.msCrypto;return t?([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,function(e){return(e^t.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16)}):this.uuid()},P.prototype.uuid=function(){var e=Date.now().valueOf();return(P.previous=P.previous<e?e:P.previous+100).toString(16)},P.previous=0,P.decorators=[{type:s.Injectable}],P);function P(){}var q=(z.prototype.transform=function(r){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];return e.forEach(function(e,t){r=r.replace("{"+t+"}",e)}),r},z.decorators=[{type:s.Pipe,args:[{name:"replaceX"}]}],z);function z(){}var L={form:{},model:{}},V=(N.prototype.setValue=function(e){e&&(this._state=o.merge(this._state,e),this.stateSubject.next(this._state))},N.prototype.getValue=function(e){return this.utils.getValue(e,this._state)},N.prototype.destroy=function(){this._state={form:{},model:{}},this._formState=this._state.form,this._lookupState=this._formState.lookup,this.stateSubject.next(this._state)},N.prototype.setLookupInstance=function(e){this.setValue({form:{lookup:{instance:e}}})},N.prototype.updateFormState=function(e){this.setValue({form:e})},N.prototype.getFormState=function(e){return this.getValue("form."+e)},N.prototype.eventPath=function(e){var t=e.composedPath&&e.composedPath()||e.path,r=e.target;if(null!=t)return t.indexOf(window)<0?t.concat(window):t;if(r===window)return[window];var n=function(e,t){void 0===t&&(t=undefined),t=t||[];var r=e.parentNode;return r?n(r,t.concat(r)):t};return[r].concat(n(r),window)},N.decorators=[{type:s.Injectable,args:[{providedIn:"root"}]}],N.ctorParameters=function(){return[{type:w}]},N.ngInjectableDef=s.defineInjectable({factory:function(){return new N(s.inject(w))},token:N,providedIn:"root"}),N);function N(e){this.utils=e,this.stateSubject=new i.BehaviorSubject({}),this.state$=this.stateSubject.asObservable(),this.form$=this.state$.pipe(a.map(function(e){return e.form})),this.lookupIsPending$=this.form$.pipe(a.map(function(e){return e.lookup.pending})),this._state=o.cloneDeep(L),this._formState=this._state.form,this._lookupState=this._formState.lookup}var $=(W.prototype.transform=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return this.utils.getValue(e,t[0],t[1])},W.decorators=[{type:s.Pipe,args:[{name:"getvalue"}]}],W.ctorParameters=function(){return[{type:w}]},W);function W(e){this.utils=e}var H={onlyTopWindow:!1,mouseWheel:!0,mouseDown:!0,scroll:!1,mouseUp:!1,click:!1},U=(B.prototype.iframeEventHandle=function(e,t){var r,n,o=Array.from(document.querySelectorAll("iframe"));if(o&&o.length){var i=this.eventsMap.get(e);try{for(var a=d(o),s=a.next();!s.done;s=a.next()){var c=s.value.contentDocument;c&&(c[t]("mousedown",i),c[t]("mousewheel",i),c[t]("DOMMouseScroll",i))}}catch(l){r={error:l}}finally{try{s&&!s.done&&(n=a["return"])&&n.call(a)}finally{if(r)throw r.error}}}},B.prototype.removeMouseEvent=function(e){var t=this.eventsMap.get(e);t&&(document.removeEventListener("mousedown",t,!0),document.removeEventListener("mousewheel",t,!0),document.removeEventListener("DOMMouseScroll",t,!0),top!==window&&top.document.body.removeEventListener("mousedown",t,!0),this.iframeEventHandle(e,"removeEventListener"),t=null,this.eventsMap["delete"](e))},B.prototype.destory=function(e){this.removeMouseEvent(e)},B.prototype.registerMouseEvent=function(e,t,r){var n=this;if(!this.eventsMap.has(e))return this.eventsMap.set(e,t),(r=r?Object.assign({},H,r):H).onlyTopWindow&&top!==window?top.document.body.addEventListener("mousedown",t,!0):(r.mouseDown&&document.addEventListener("mousedown",t,!0),r.mouseWheel&&(document.addEventListener("mousewheel",t,!0),document.addEventListener("DOMMouseScroll",t,!0)),r.scroll&&document.addEventListener("scroll",t,!0),r.mouseUp&&document.addEventListener("mouseup",t),r.click&&document.addEventListener("click",t),top!==window&&top.document.body.addEventListener("mousedown",t,!0),this.iframeEventHandle(e,"addEventListener")),function(){n.destory(e)}},B.decorators=[{type:s.Injectable}],B);function B(){this.eventsMap=new WeakMap}var K=(X.forRoot=function(){return{ngModule:X,providers:[w,V,A,U]}},X.decorators=[{type:s.NgModule,args:[{declarations:[x,c,v,q,$,g],imports:[],exports:[x,c,v,q,$,g]}]}],X);function X(){}var G=(Q.prototype.initData=function(e){var t=this;return e.map(function(e){return{id:e[t._state.idField],data:e,disabled:t.disableExpress?t.disableExpress(e):!!e[t._state.disabledField]}})},Q.prototype.updateState=function(e){var t=u({},this._state,e);this.store.next(this._state=t)},Q.prototype.initState=function(e){this.updateState(e)},Q.prototype.isSelect=function(t){var r=this;return!(!this._state.selections||!this._state.selections.length)&&this._state.selections.find(function(e){return!!e&&e[r._state.idField]==t})!==undefined},Q.prototype.loadData=function(e,t,r){if(void 0===t&&(t=""),void 0===r&&(r=","),e){var n=this.initData(e);this.updateState(u({},this._state,{data:n})),t?this.setSelections(t,r):this._state.selections=[]}else this.updateState({data:[],selections:[]})},Q.prototype.getSelections=function(){return this._state.selections},Q.prototype.setSelections=function(t,e){var r=this;if(void 0===e&&(e=","),t){var n=[];n=this._state.multiSelect?t.split(e).map(function(t){return r._state.data.find(function(e){return e.data[r._state.valueField]+""==t})}).map(function(e){return e?e.data:""}).filter(function(e){return e}):[this._state.data.find(function(e){return e.data[r._state.valueField]+""==t})],this.updateState({selections:n})}},Q.prototype.selectAll=function(){this.updateState({selections:this._state.data.map(function(e){return e.data})})},Q.prototype.unSelectAll=function(){this.clearSelections()},Q.prototype.selectItem=function(e,t){var r=this._state.idField,n=this.getSelections(),o=e[r];this._state.multiSelect?this.isSelect(o)||n.push(e):this.isSelect(o)||(n=[e]);var i=this.cloneArray(n);this.updateState({selections:i})},Q.prototype.unSelectItem=function(e){var t=this._state.idField,r=this.getSelections(),n=e[t];r=this._state.multiSelect?r.filter(function(e){return e[t]!=n}):[];var o=this.cloneArray(r);this.updateState({selections:o})},Q.prototype.clearSelections=function(){this.updateState({selections:[]})},Q.prototype.cloneArray=function(e){return e&&e.length?e.map(function(e){return e}):e},Q);function Q(e){this._initState=e,this._state=this._initState,this.store=new i.BehaviorSubject(this._state),this.state$=this.store.asObservable(),this.data$=this.state$.pipe(a.map(function(e){return e.data}))}var J=(Y.prototype.add=function(e,t){this._state.set(e,t)},Y.prototype.get=function(e){return this._state.get(e)},Y.prototype.destroy=function(e){this._state.set(e,null),this._state["delete"](e)},Y.decorators=[{type:s.Injectable,args:[{providedIn:"root"}]}],Y.ctorParameters=function(){return[]},Y.ngInjectableDef=s.defineInjectable({factory:function(){return new Y},token:Y,providedIn:"root"}),Y);function Y(){this._state=new WeakMap}var Z=(ee.prototype.destroy=function(){this.destroy$.next(),this.destroy$.complete()},ee.prototype.writeMessage=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];this.isDebug&&console[e].apply(console,f(t))},ee.prototype.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.writeMessage("log",e)},ee.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.writeMessage("warn",e)},ee.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.writeMessage("error",e)},ee.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.writeMessage("info",e)},ee.prototype.useDebugMode=function(){var t=this;return this.debugSub||(this.debugSub=i.fromEvent(document.body,"keydown").pipe(a.takeUntil(this.destroy$)).subscribe(function(e){e.ctrlKey&&e.shiftKey&&"D"===e.key&&(e.preventDefault(),e.stopPropagation(),t.isDebug=!t.isDebug,console.log("%c🪲 Farris debug mode is "+(t.isDebug?"startting":"stopped")+".🪲","color: "+(t.isDebug?"green":"red")+"; font-weight:bold;font-size:16px"))})),this.debugSub},ee.decorators=[{type:s.Injectable,args:[{providedIn:"root"}]}],ee.ctorParameters=function(){return[]},ee.ngInjectableDef=s.defineInjectable({factory:function(){return new ee},token:ee,providedIn:"root"}),ee);function ee(){this.isDebug=!1,this.destroy$=new i.Subject,this.debugSub=null}var te=["moz","ms","webkit"];var re=function ie(){if("undefined"==typeof window)return function(){return 0};if(window.requestAnimationFrame)return window.requestAnimationFrame.bind(window);var e=te.filter(function(e){return e+"RequestAnimationFrame"in window})[0];return e?window[e+"RequestAnimationFrame"]:function t(){var o=0;return function(e){var t=(new Date).getTime(),r=Math.max(0,16-(t-o)),n=setTimeout(function(){e(t+r)},r);return o=t+r,n}}()}(),ne={concise:[{visible:!0,code:"bold",cls:"mr-1 rich-toolbar-icons rich-bold",title:"加粗",value:["bold"]},{visible:!0,code:"italic",cls:"mr-1 rich-toolbar-icons rich-italic",title:"倾斜",value:["italic"]},{visible:!0,code:"underline",cls:"mr-1 rich-toolbar-icons rich-underline",title:"下划线",value:["underline"]},{visible:!0,code:"strike",cls:"mr-1 rich-toolbar-icons rich-strike",title:"删除线",value:["strike"]},{visible:!0,code:"numlist",cls:"mr-1 rich-toolbar-icons rich-ordered",title:"有序列表",value:[{list:"ordered"}]},{visible:!0,code:"bullist",cls:"mr-1 rich-toolbar-icons rich-bullet",title:"无序列表",value:[{list:"bullet"}]},{visible:!0,code:"code-block",cls:"mr-1 rich-toolbar-icons rich-code-block",title:"代码块",value:["code-block"]},{visible:!0,code:"header1",cls:"mr-1 rich-toolbar-icons rich-header1",title:"标题 1",value:[{header:1}]},{visible:!0,code:"header2",cls:"mr-1 rich-toolbar-icons rich-header2",title:"标题 2",value:[{header:2}]},{visible:!0,code:"image",cls:"mr-1 rich-toolbar-icons rich-image",title:"插入图片",value:["image"]}],advanced:[{visible:!0,code:"undo",cls:"mr-1 f-icon f-icon-undo",title:"撤消",value:"undo"},{visible:!0,code:"redo",cls:"mr-1 f-icon f-icon-redo",title:"重复",value:"redo"},{visible:!0,code:"formatselect",cls:"mr-1 f-icon f-icon-convert-lowercase",title:"段落&标题",value:"formatselect"},{visible:!0,code:"fontselect",cls:"mr-1 f-icon f-icon-font-family",title:"字体",value:"fontselect"},{visible:!0,code:"fontsizeselect",cls:"mr-1 f-icon f-icon-font-size",title:"字号",value:"fontsizeselect"},{visible:!0,code:"bold",cls:"mr-1 rich-toolbar-icons rich-bold",title:"加粗",value:"bold"},{visible:!0,code:"italic",cls:"mr-1 rich-toolbar-icons rich-italic",title:"倾斜",value:"italic"},{visible:!0,code:"underline",cls:"mr-1 rich-toolbar-icons rich-underline",title:"下划线",value:"underline"},{visible:!0,code:"strike",cls:"mr-1 rich-toolbar-icons rich-strike",title:"删除线",value:"strikethrough"},{visible:!0,code:"numlist",cls:"mr-1 rich-toolbar-icons rich-ordered",title:"有序列表",value:"numlist"},{visible:!0,code:"bullist",cls:"mr-1 rich-toolbar-icons rich-bullet",title:"无序列表",value:"bullist"},{visible:!0,code:"outdent",cls:"mr-1 rich-toolbar-icons rich-indent-1",title:"取消缩进",value:"outdent"},{visible:!0,code:"indent",cls:"mr-1 rich-toolbar-icons rich-indent1",title:"缩进",value:"indent"},{visible:!0,code:"forecolor",cls:"mr-1 rich-toolbar-icons rich-color",title:"文本颜色",value:"forecolor"},{visible:!0,code:"backcolor",cls:"mr-1 rich-toolbar-icons rich-background",title:"背景色",value:"backcolor"},{visible:!0,code:"image",cls:"mr-1 rich-toolbar-icons rich-image",title:"插入图片",value:"image"},{visible:!0,code:"link",cls:"mr-1 rich-toolbar-icons rich-link",title:"插入链接",value:"link"},{visible:!0,code:"removeformat",cls:"mr-1 rich-toolbar-icons rich-clear",title:"清除格式",value:"removeformat"},{visible:!0,code:"alignleft",cls:"mr-1 f-icon f-icon-align-left",title:"左对齐",value:"alignleft"},{visible:!0,code:"aligncenter",cls:"mr-1 f-icon f-icon-align-center",title:"居中对齐",value:"aligncenter"},{visible:!0,code:"alignright",cls:"mr-1 f-icon f-icon-align-right",title:"右对齐",value:"alignright"},{visible:!0,code:"alignjustify",cls:"mr-1 f-icon f-icon-align-justify",title:"两端对齐",value:"alignjustify"},{visible:!0,code:"table",cls:"mr-1 f-icon f-icon-table",title:"表格",value:"table"}]};var oe=new s.InjectionToken("web api prefix string.");e.FarrisTemplateDirective=c,e.ResizeObserverDirective=v,e.FarrisComponentTemplateDirective=g,e.CommonUtils=w,e.FarrisSafePipe=x,e.FarrisCommonModule=K,e.IdService=A,e.BaseDataFacadeService=G,e.RuntimeStateService=V,e.FarrisComponentInstanceService=J,e.DebugService=Z,e.OverLayHiddenService=U,e.FarrisReplaceXPipe=q,e.cancelRequestAnimationFrame=function ae(e){if("undefined"==typeof window)return null;if(window.cancelAnimationFrame)return window.cancelAnimationFrame(e);var t=te.filter(function(e){return e+"CancelAnimationFrame"in window||e+"CancelRequestAnimationFrame"in window})[0];return t?(window[t+"CancelAnimationFrame"]||window[t+"CancelRequestAnimationFrame"]).call(this,e):clearTimeout(e)},e.reqAnimFrame=re,e.Convert2HtmlEditorToolbars=function se(e,t){if(!t||!t.length)return null;var r=e.toLowerCase(),n=ne[r],o=t.map(function(t){return"object"==typeof t?(t.values=t.values.map(function(t){return n.find(function(e){return e.code===t})}).filter(function(e){return e}),t):n.find(function(e){return e.code===t})}).filter(function(e){return e}).map(function(e){return e.groupName?"concise"===r?e.values.map(function(e){return e.value}).flat():e.values.map(function(e){return e.value}):e.value}).filter(function(e){return e.length});return"concise"===r?o:"advanced"===r?o.map(function(e,t){return Array.isArray(e)&&(0===t&&e.push("|"),0<t&&e.unshift("|")),e}).flat().join(" "):void 0},e.RICH_COMMANDS=ne,e.GetValuePipe=$,e.appendPerfixForUri=function ce(e,t){return void 0===t&&(t=""),t?"/"==(t=t.replace(/\/\//g,"/").replace(/\\/g,"/"))[t.length-1]&&"/"==e[0]?t+e.substring(1):t+e:e},e.WEBAPI_PREFIX_TOKEN=oe,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=farris-ui-common.umd.min.js.map