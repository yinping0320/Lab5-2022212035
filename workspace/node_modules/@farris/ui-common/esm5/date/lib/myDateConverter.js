/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
var MyDateConverter = /** @class */ (function () {
    function MyDateConverter() {
        var _this = this;
        this.MONTHNAMES = 'January February March April May June July August September October November December'.split(' ');
        this.MONTHNAMES_LOOKUP = { 'jan': 1, 'feb': 2, 'mar': 3, 'apr': 4, 'may': 5, 'jun': 6, 'jul': 7, 'aug': 8, 'sep': 9, 'oct': 10, 'nov': 11, 'dec': 12 };
        /**
         * \@var {Array}  Abbreviated names for the months of the year
         */
        this.ABBR_MONTHNAMES = 'Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec'.split(' ');
        /**
         * \@var {Array}  Names for the days of the week from Sunday to Saturday
         */
        this.DAYNAMES = 'Sunday Monday Tuesday Wednesday Thursday Friday Saturday'.split(' ');
        this.DAYNAMES_LOOKUP = { 'sun': 0, 'mon': 1, 'tue': 2, 'wed': 3, 'thu': 4, 'fri': 5, 'sat': 6 };
        /**
         * \@var {Array}  Abbreviated names for the days of the week from Sunday to Saturday
         */
        this.ABBR_DAYNAMES = 'Sun Mon Tue Wed Thu Fri Sat'.split(' ');
        this.regexes = {
            YEAR: '[1-9]\\d{3}',
            MONTH: '1[0-2]|0?[1-9]',
            MONTH2: '1[0-2]|0[1-9]',
            MONTHNAME: 'jan|january|feb|february|mar|march|apr|april|may|jun|june|jul|july|aug|august|sep|september|oct|october|nov|november|dec|december',
            DAYNAME: 'mon|monday|tue|tuesday|wed|wednesday|thu|thursday|fri|friday|sat|saturday|sun|sunday',
            DAY: '3[01]|[12]\\d|0?[1-9]',
            DAY2: '3[01]|[12]\\d|0[1-9]',
            TIMEZONE: '[+-][01]\\d\\:?[0-5]\\d',
            H24: '[01]\\d|2[0-3]',
            MIN: '[0-5]\\d',
            SEC: '[0-5]\\d',
            MS: '\\d{3,}',
            H12: '0?[1-9]|1[012]',
            AMPM: 'am|pm',
            UNIT: 'year|month|week|day|hour|minute|second|millisecond'
        };
        this.patterns = [
            // 2010-03-15
            [
                'iso_8601',
                this.makePattern('^(_YEAR_)-(_MONTH_)-(_DAY_)$'),
                '$2/$3/$1'
            ],
            // 3-15-2010
            [
                'us',
                this.makePattern('^(_MONTH_)([\\/-])(_DAY_)\\2(_YEAR_)$'),
                '$1/$3/$4'
            ],
            // 15.03.2010
            [
                'world',
                this.makePattern('^(_DAY_)([\\/\\.])(_MONTH_)\\2(_YEAR_)$'),
                '$3/$1/$4'
            ],
            // 15-Mar-2010, 8 Dec 2011, "Thu, 8 Dec 2011"
            [
                'chicago',
                this.makePattern('^(?:(?:_DAYNAME_),? )?(_DAY_)([ -])(_MONTHNAME_)\\2(_YEAR_)$'),
                '$3 $1, $4'
            ],
            // "March 4, 2012", "Mar 4 2012", "Sun Mar 4 2012"
            [
                'conversational',
                this.makePattern('^(?:(?:_DAYNAME_),? )?(_MONTHNAME_) (_DAY_),? (_YEAR_)$'),
                '$1 $2, $3'
            ],
            // Tue Jun 22 17:47:27 +0000 2010
            [
                'month_day_time_year',
                this.makePattern('^(?:_DAYNAME_) (_MONTHNAME_) (_DAY_) ((?:_H24_)\\:(?:_MIN_)(?:\\:_SEC_)?) (_TIMEZONE_) (_YEAR_)$'),
                (/**
                 * @param {?} m
                 * @return {?}
                 */
                function (m) {
                    /** @type {?} */
                    var month = _this.zeroPad(_this.getMonthByName(m[1]), 2);
                    /** @type {?} */
                    var day = _this.zeroPad(m[2], 2);
                    /** @type {?} */
                    var date = _this.create(m[5] + '-' + month + '-' + day + 'T' + m[3] + m[4]);
                    if (isNaN(date)) {
                        return false;
                    }
                    return date;
                })
            ],
            // @123456789
            [
                'unix',
                /^@(-?\d+)$/,
                (/**
                 * @param {?} match
                 * @return {?}
                 */
                function (match) {
                    return _this.create(parseInt(match[1], 10) * 1000);
                })
            ],
            // 24-hour time (This will help catch Date objects that are casted to a string)
            [
                '24_hour',
                this.makePattern('^(?:(.+?)(?: |T))?(_H24_)\\:(_MIN_)(?:\\:(_SEC_)(?:\\.(_MS_))?)? ?(?:GMT)?(_TIMEZONE_)?(?: \\([A-Z]+\\))?$'),
                (/**
                 * @param {?} match
                 * @return {?}
                 */
                function (match) {
                    /** @type {?} */
                    var d;
                    if (match[1]) {
                        d = _this.create(match[1]);
                        if (isNaN(d)) {
                            return false;
                        }
                    }
                    else {
                        d = new Date();
                        d.setMilliseconds(0);
                    }
                    d.setHours(parseFloat(match[2]), parseFloat(match[3]), parseFloat(match[4] || 0));
                    if (match[5]) {
                        d.setMilliseconds(+String(match[5]).slice(0, 3));
                    }
                    if (match[6]) {
                        d.setUTCOffsetString(match[6]);
                    }
                    return d;
                })
            ],
            // 12-hour time
            [
                '12_hour',
                this.makePattern('^(?:(.+) )?(_H12_)(?:\\:(_MIN_)(?:\\:(_SEC_))?)? ?(_AMPM_)$'),
                (/**
                 * @param {?} match
                 * @return {?}
                 */
                function (match) {
                    /** @type {?} */
                    var d;
                    if (match[1]) {
                        d = _this.create(match[1]);
                        if (isNaN(d)) {
                            return false;
                        }
                    }
                    else {
                        d = new Date();
                        d.setMilliseconds(0);
                    }
                    /** @type {?} */
                    var hour = parseFloat(match[2]);
                    hour = match[5].toLowerCase() == 'am' ? (hour == 12 ? 0 : hour) : (hour == 12 ? 12 : hour + 12);
                    d.setHours(hour, parseFloat(match[3] || 0), parseFloat(match[4] || 0));
                    return d;
                })
            ]
        ];
    }
    /**
     * @param {?} code
     * @return {?}
     */
    MyDateConverter.prototype.makePattern = /**
     * @param {?} code
     * @return {?}
     */
    function (code) {
        var _this = this;
        code = code.replace(/_([A-Z][A-Z0-9]+)_/g, (/**
         * @param {?} $0
         * @param {?} $1
         * @return {?}
         */
        function ($0, $1) {
            return _this.regexes[$1];
        }));
        return new RegExp(code, 'i');
    };
    /**
     * @param {?} monthname
     * @return {?}
     */
    MyDateConverter.prototype.getMonthByName = /**
     * @param {?} monthname
     * @return {?}
     */
    function (monthname) {
        return this.MONTHNAMES_LOOKUP[String(monthname).slice(0, 3).toLowerCase()];
    };
    /**
     * @param {?} dayname
     * @return {?}
     */
    MyDateConverter.prototype.getWeekdayByName = /**
     * @param {?} dayname
     * @return {?}
     */
    function (dayname) {
        return this.DAYNAMES_LOOKUP[String(dayname).slice(0, 3).toLowerCase()];
    };
    /**
     * @private
     * @param {?} num
     * @param {?} digits
     * @return {?}
     */
    MyDateConverter.prototype.zeroPad = /**
     * @private
     * @param {?} num
     * @param {?} digits
     * @return {?}
     */
    function (num, digits) {
        switch (digits - String(num).length) {
            case 2: return '00' + num;
            case 1: return '0' + num;
        }
        return num;
    };
    /**
     * @param {?} date
     * @return {?}
     */
    MyDateConverter.prototype.create = /**
     * @param {?} date
     * @return {?}
     */
    function (date) {
        // 0 arguments or date is undefined
        if (typeof date == 'undefined') {
            return Date.now();
        }
        // If the passed value is already a date object, return it
        if (date instanceof Date) {
            return date;
        }
        /** @type {?} */
        var a = arguments;
        switch (a.length) {
            case 1:
                // If the passed value is an integer, interpret it as ms past epoch
                if (Object.prototype.toString.call(date) == '[object Number]') {
                    return new Date(date);
                }
                // trim the date
                date = String(date).replace(/^\s*(.*)\s*$/, '$1');
                // normalize whitespace
                date = date.replace(/\s{2,}/g, ' ');
                if (date === '') {
                    return Date.now();
                }
                /** @type {?} */
                var i = 0;
                /** @type {?} */
                var pattern;
                /** @type {?} */
                var ms;
                /** @type {?} */
                var obj;
                /** @type {?} */
                var match;
                /** @type {?} */
                var regex;
                /** @type {?} */
                var fn;
                // try each of our patterns
                while ((pattern = this.patterns[i++])) {
                    if (typeof pattern[0] == 'string') {
                        // pattern[0] is the name of the pattern
                        regex = pattern[1];
                        fn = pattern[2];
                    }
                    else {
                        // backwards compatibility with version 3.1
                        regex = pattern[0];
                        fn = pattern[1];
                    }
                    if (!(match = date.match(regex))) {
                        continue;
                    }
                    if (typeof fn == 'function') {
                        obj = fn(match, date);
                        if (obj instanceof Date) {
                            return obj;
                        }
                    }
                    else {
                        // fn is not a function but a string replace command
                        ms = Date.parse(date.replace(regex, fn));
                        if (!isNaN(ms)) {
                            return new Date(ms);
                        }
                    }
                }
                return NaN;
            case 2: return new Date(a[0], a[1], 1);
            case 3: return new Date(a[0], a[1], a[2]);
            case 4: return new Date(a[0], a[1], a[2], a[3]);
            case 5: return new Date(a[0], a[1], a[2], a[3], a[4]);
            case 6: return new Date(a[0], a[1], a[2], a[3], a[4], a[5]);
            default: return new Date(a[0], a[1], a[2], a[3], a[4], a[5], a[6]);
        }
    };
    return MyDateConverter;
}());
export { MyDateConverter };
if (false) {
    /**
     * @type {?}
     * @private
     */
    MyDateConverter.prototype.MONTHNAMES;
    /**
     * @type {?}
     * @private
     */
    MyDateConverter.prototype.MONTHNAMES_LOOKUP;
    /**
     * \@var {Array}  Abbreviated names for the months of the year
     * @type {?}
     * @private
     */
    MyDateConverter.prototype.ABBR_MONTHNAMES;
    /**
     * \@var {Array}  Names for the days of the week from Sunday to Saturday
     * @type {?}
     * @private
     */
    MyDateConverter.prototype.DAYNAMES;
    /**
     * @type {?}
     * @private
     */
    MyDateConverter.prototype.DAYNAMES_LOOKUP;
    /**
     * \@var {Array}  Abbreviated names for the days of the week from Sunday to Saturday
     * @type {?}
     * @private
     */
    MyDateConverter.prototype.ABBR_DAYNAMES;
    /** @type {?} */
    MyDateConverter.prototype.regexes;
    /** @type {?} */
    MyDateConverter.prototype.patterns;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibXlEYXRlQ29udmVydGVyLmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGZhcnJpcy91aS1jb21tb24vZGF0ZS8iLCJzb3VyY2VzIjpbImxpYi9teURhdGVDb252ZXJ0ZXIudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUFBO0lBQUE7UUFBQSxpQkFtT0M7UUFsT1csZUFBVSxHQUFHLHVGQUF1RixDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQztRQUNoSCxzQkFBaUIsR0FBRyxFQUFFLEtBQUssRUFBRSxDQUFDLEVBQUUsS0FBSyxFQUFFLENBQUMsRUFBRSxLQUFLLEVBQUUsQ0FBQyxFQUFFLEtBQUssRUFBRSxDQUFDLEVBQUUsS0FBSyxFQUFFLENBQUMsRUFBRSxLQUFLLEVBQUUsQ0FBQyxFQUFFLEtBQUssRUFBRSxDQUFDLEVBQUUsS0FBSyxFQUFFLENBQUMsRUFBRSxLQUFLLEVBQUUsQ0FBQyxFQUFFLEtBQUssRUFBRSxFQUFFLEVBQUUsS0FBSyxFQUFFLEVBQUUsRUFBRSxLQUFLLEVBQUUsRUFBRSxFQUFFLENBQUM7Ozs7UUFJbEosb0JBQWUsR0FBRyxpREFBaUQsQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLENBQUM7Ozs7UUFJL0UsYUFBUSxHQUFHLDBEQUEwRCxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQztRQUNqRixvQkFBZSxHQUFHLEVBQUUsS0FBSyxFQUFFLENBQUMsRUFBRSxLQUFLLEVBQUUsQ0FBQyxFQUFFLEtBQUssRUFBRSxDQUFDLEVBQUUsS0FBSyxFQUFFLENBQUMsRUFBRSxLQUFLLEVBQUUsQ0FBQyxFQUFFLEtBQUssRUFBRSxDQUFDLEVBQUUsS0FBSyxFQUFFLENBQUMsRUFBRSxDQUFDOzs7O1FBSTNGLGtCQUFhLEdBQUcsNkJBQTZCLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDO1FBQ2pFLFlBQU8sR0FBRztZQUNOLElBQUksRUFBRSxhQUFhO1lBQ25CLEtBQUssRUFBRSxnQkFBZ0I7WUFDdkIsTUFBTSxF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QkFDdkI7cUJBQ0o7aUJBQ0o7Z0JBQ0QsT0FBTyxHQUFHLENBQUM7WUFDZixLQUFLLENBQUMsQ0FBQyxDQUFDLE9BQU8sSUFBSSxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQztZQUN2QyxLQUFLLENBQUMsQ0FBQyxDQUFDLE9BQU8sSUFBSSxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUMxQyxLQUFLLENBQUMsQ0FBQyxDQUFDLE9BQU8sSUFBSSxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDaEQsS0FBSyxDQUFDLENBQUMsQ0FBQyxPQUFPLElBQUksSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUN0RCxLQUFLLENBQUMsQ0FBQyxDQUFDLE9BQU8sSUFBSSxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUM1RCxPQUFPLENBQUMsQ0FBQyxPQUFPLElBQUksSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO1NBQ3RFO0lBQ0wsQ0FBQztJQUNMLHNCQUFDO0FBQUQsQ0FBQyxBQW5PRCxJQW1PQzs7Ozs7OztJQWxPRyxxQ0FBd0g7Ozs7O0lBQ3hILDRDQUEwSjs7Ozs7O0lBSTFKLDBDQUF1Rjs7Ozs7O0lBSXZGLG1DQUF5Rjs7Ozs7SUFDekYsMENBQW1HOzs7Ozs7SUFJbkcsd0NBQWlFOztJQUNqRSxrQ0FnQkU7O0lBRUYsbUNBNEdFIiwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGNsYXNzIE15RGF0ZUNvbnZlcnRlciB7XHJcbiAgICBwcml2YXRlIE1PTlRITkFNRVMgPSAnSmFudWFyeSBGZWJydWFyeSBNYXJjaCBBcHJpbCBNYXkgSnVuZSBKdWx5IEF1Z3VzdCBTZXB0ZW1iZXIgT2N0b2JlciBOb3ZlbWJlciBEZWNlbWJlcicuc3BsaXQoJyAnKTtcclxuICAgIHByaXZhdGUgTU9OVEhOQU1FU19MT09LVVAgPSB7ICdqYW4nOiAxLCAnZmViJzogMiwgJ21hcic6IDMsICdhcHInOiA0LCAnbWF5JzogNSwgJ2p1bic6IDYsICdqdWwnOiA3LCAnYXVnJzogOCwgJ3NlcCc6IDksICdvY3QnOiAxMCwgJ25vdic6IDExLCAnZGVjJzogMTIgfTtcclxuICAgIC8qKlxyXG4gICAgICogQHZhciB7QXJyYXl9ICBBYmJyZXZpYXRlZCBuYW1lcyBmb3IgdGhlIG1vbnRocyBvZiB0aGUgeWVhclxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIEFCQlJfTU9OVEhOQU1FUyA9ICdKYW4gRmViIE1hciBBcHIgTWF5IEp1biBKdWwgQXVnIFNlcCBPY3QgTm92IERlYycuc3BsaXQoJyAnKTtcclxuICAgIC8qKlxyXG4gICAgICogQHZhciB7QXJyYXl9ICBOYW1lcyBmb3IgdGhlIGRheXMgb2YgdGhlIHdlZWsgZnJvbSBTdW5kYXkgdG8gU2F0dXJkYXlcclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBEQVlOQU1FUyA9ICdTdW5kYXkgTW9uZGF5IFR1ZXNkYXkgV2VkbmVzZGF5IFRodXJzZGF5IEZyaWRheSBTYXR1cmRheScuc3BsaXQoJyAnKTtcclxuICAgIHByaXZhdGUgREFZTkFNRVNfTE9PS1VQID0geyAnc3VuJzogMCwgJ21vbic6IDEsICd0dWUnOiAyLCAnd2VkJzogMywgJ3RodSc6IDQsICdmcmknOiA1LCAnc2F0JzogNiB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBAdmFyIHtBcnJheX0gIEFiYnJldmlhdGVkIG5hbWVzIGZvciB0aGUgZGF5cyBvZiB0aGUgd2VlayBmcm9tIFN1bmRheSB0byBTYXR1cmRheVxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIEFCQlJfREFZTkFNRVMgPSAnU3VuIE1vbiBUdWUgV2VkIFRodSBGcmkgU2F0Jy5zcGxpdCgnICcpO1xyXG4gICAgcmVnZXhlcyA9IHtcclxuICAgICAgICBZRUFSOiAnWzEtOV1cXFxcZHszfScsXHJcbiAgICAgICAgTU9OVEg6ICcxWzAtMl18MD9bMS05XScsXHJcbiAgICAgICAgTU9OVEgyOiAnMVswLTJdfDBbMS05XScsXHJcbiAgICAgICAgTU9OVEhOQU1FOiAnamFufGphbnVhcnl8ZmVifGZlYnJ1YXJ5fG1hcnxtYXJjaHxhcHJ8YXByaWx8bWF5fGp1bnxqdW5lfGp1bHxqdWx5fGF1Z3xhdWd1c3R8c2VwfHNlcHRlbWJlcnxvY3R8b2N0b2Jlcnxub3Z8bm92ZW1iZXJ8ZGVjfGRlY2VtYmVyJyxcclxuICAgICAgICBEQVlOQU1FOiAnbW9ufG1vbmRheXx0dWV8dHVlc2RheXx3ZWR8d2VkbmVzZGF5fHRodXx0aHVyc2RheXxmcml8ZnJpZGF5fHNhdHxzYXR1cmRheXxzdW58c3VuZGF5JyxcclxuICAgICAgICBEQVk6ICczWzAxXXxbMTJdXFxcXGR8MD9bMS05XScsXHJcbiAgICAgICAgREFZMjogJzNbMDFdfFsxMl1cXFxcZHwwWzEtOV0nLFxyXG4gICAgICAgIFRJTUVaT05FOiAnWystXVswMV1cXFxcZFxcXFw6P1swLTVdXFxcXGQnLFxyXG4gICAgICAgIEgyNDogJ1swMV1cXFxcZHwyWzAtM10nLFxyXG4gICAgICAgIE1JTjogJ1swLTVdXFxcXGQnLFxyXG4gICAgICAgIFNFQzogJ1swLTVdXFxcXGQnLFxyXG4gICAgICAgIE1TOiAnXFxcXGR7Myx9JyxcclxuICAgICAgICBIMTI6ICcwP1sxLTldfDFbMDEyXScsXHJcbiAgICAgICAgQU1QTTogJ2FtfHBtJyxcclxuICAgICAgICBVTklUOiAneWVhcnxtb250aHx3ZWVrfGRheXxob3VyfG1pbnV0ZXxzZWNvbmR8bWlsbGlzZWNvbmQnXHJcbiAgICB9O1xyXG5cclxuICAgIHBhdHRlcm5zID0gW1xyXG4gICAgICAgIC8vIDIwMTAtMDMtMTVcclxuICAgICAgICBbXHJcbiAgICAgICAgICAgICdpc29fODYwMScsXHJcbiAgICAgICAgICAgIHRoaXMubWFrZVBhdHRlcm4oJ14oX1lFQVJfKS0oX01PTlRIXyktKF9EQVlfKSQnKSxcclxuICAgICAgICAgICAgJyQyLyQzLyQxJ1xyXG4gICAgICAgIF0sXHJcblxyXG4gICAgICAgIC8vIDMtMTUtMjAxMFxyXG4gICAgICAgIFtcclxuICAgICAgICAgICAgJ3VzJyxcclxuICAgICAgICAgICAgdGhpcy5tYWtlUGF0dGVybignXihfTU9OVEhfKShbXFxcXC8tXSkoX0RBWV8pXFxcXDIoX1lFQVJfKSQnKSxcclxuICAgICAgICAgICAgJyQxLyQzLyQ0J1xyXG4gICAgICAgIF0sXHJcblxyXG4gICAgICAgIC8vIDE1LjAzLjIwMTBcclxuICAgICAgICBbXHJcbiAgICAgICAgICAgICd3b3JsZCcsXHJcbiAgICAgICAgICAgIHRoaXMubWFrZVBhdHRlcm4oJ14oX0RBWV8pKFtcXFxcL1xcXFwuXSkoX01PTlRIXylcXFxcMihfWUVBUl8pJCcpLFxyXG4gICAgICAgICAgICAnJDMvJDEvJDQnXHJcbiAgICAgICAgXSxcclxuXHJcbiAgICAgICAgLy8gMTUtTWFyLTIwMTAsIDggRGVjIDIwMTEsIFwiVGh1LCA4IERlYyAyMDExXCJcclxuICAgICAgICBbXHJcbiAgICAgICAgICAgICdjaGljYWdvJyxcclxuICAgICAgICAgICAgdGhpcy5tYWtlUGF0dGVybignXig/Oig/Ol9EQVlOQU1FXyksPyApPyhfREFZXykoWyAtXSkoX01PTlRITkFNRV8pXFxcXDIoX1lFQVJfKSQnKSxcclxuICAgICAgICAgICAgJyQzICQxLCAkNCdcclxuICAgICAgICBdLFxyXG5cclxuICAgICAgICAvLyBcIk1hcmNoIDQsIDIwMTJcIiwgXCJNYXIgNCAyMDEyXCIsIFwiU3VuIE1hciA0IDIwMTJcIlxyXG4gICAgICAgIFtcclxuICAgICAgICAgICAgJ2NvbnZlcnNhdGlvbmFsJyxcclxuICAgICAgICAgICAgdGhpcy5tYWtlUGF0dGVybignXig/Oig/Ol9EQVlOQU1FXyksPyApPyhfTU9OVEhOQU1FXykgKF9EQVlfKSw/IChfWUVBUl8pJCcpLFxyXG4gICAgICAgICAgICAnJDEgJDIsICQzJ1xyXG4gICAgICAgIF0sXHJcblxyXG4gICAgICAgIC8vIFR1ZSBKdW4gMjIgMTc6NDc6MjcgKzAwMDAgMjAxMFxyXG4gICAgICAgIFtcclxuICAgICAgICAgICAgJ21vbnRoX2RheV90aW1lX3llYXInLFxyXG4gICAgICAgICAgICB0aGlzLm1ha2VQYXR0ZXJuKCdeKD86X0RBWU5BTUVfKSAoX01PTlRITkFNRV8pIChfREFZXykgKCg/Ol9IMjRfKVxcXFw6KD86X01JTl8pKD86XFxcXDpfU0VDXyk/KSAoX1RJTUVaT05FXykgKF9ZRUFSXykkJyksXHJcbiAgICAgICAgICAgIChtKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBtb250aCA9IHRoaXMuemVyb1BhZCh0aGlzLmdldE1vbnRoQnlOYW1lKG1bMV0pLCAyKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGRheSA9IHRoaXMuemVyb1BhZChtWzJdLCAyKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGRhdGU6IGFueSA9IHRoaXMuY3JlYXRlKG1bNV0gKyAnLScgKyBtb250aCArICctJyArIGRheSArICdUJyArIG1bM10gKyBtWzRdKTtcclxuICAgICAgICAgICAgICAgIGlmIChpc05hTihkYXRlKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBkYXRlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgXSxcclxuXHJcbiAgICAgICAgLy8gQDEyMzQ1Njc4OVxyXG4gICAgICAgIFtcclxuICAgICAgICAgICAgJ3VuaXgnLFxyXG4gICAgICAgICAgICAvXkAoLT9cXGQrKSQvLFxyXG4gICAgICAgICAgICAobWF0Y2gpID0+IHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmNyZWF0ZShwYXJzZUludChtYXRjaFsxXSwgMTApICogMTAwMCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICBdLFxyXG5cclxuICAgICAgICAvLyAyNC1ob3VyIHRpbWUgKFRoaXMgd2lsbCBoZWxwIGNhdGNoIERhdGUgb2JqZWN0cyB0aGF0IGFyZSBjYXN0ZWQgdG8gYSBzdHJpbmcpXHJcbiAgICAgICAgW1xyXG4gICAgICAgICAgICAnMjRfaG91cicsXHJcbiAgICAgICAgICAgIHRoaXMubWFrZVBhdHRlcm4oJ14oPzooLis/KSg/OiB8VCkpPyhfSDI0XylcXFxcOihfTUlOXykoPzpcXFxcOihfU0VDXykoPzpcXFxcLihfTVNfKSk/KT8gPyg/OkdNVCk/KF9USU1FWk9ORV8pPyg/OiBcXFxcKFtBLVpdK1xcXFwpKT8kJyksXHJcbiAgICAgICAgICAgIChtYXRjaCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgbGV0IGQ7XHJcbiAgICAgICAgICAgICAgICBpZiAobWF0Y2hbMV0pIHtcclxuICAgICAgICAgICAgICAgICAgICBkID0gdGhpcy5jcmVhdGUobWF0Y2hbMV0pO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChpc05hTihkKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBkID0gbmV3IERhdGUoKTtcclxuICAgICAgICAgICAgICAgICAgICBkLnNldE1pbGxpc2Vjb25kcygwKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGQuc2V0SG91cnMocGFyc2VGbG9hdChtYXRjaFsyXSksIHBhcnNlRmxvYXQobWF0Y2hbM10pLCBwYXJzZUZsb2F0KG1hdGNoWzRdIHx8IDApKTtcclxuICAgICAgICAgICAgICAgIGlmIChtYXRjaFs1XSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGQuc2V0TWlsbGlzZWNvbmRzKCtTdHJpbmcobWF0Y2hbNV0pLnNsaWNlKDAsIDMpKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChtYXRjaFs2XSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGQuc2V0VVRDT2Zmc2V0U3RyaW5nKG1hdGNoWzZdKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBkO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgXSxcclxuXHJcbiAgICAgICAgLy8gMTItaG91ciB0aW1lXHJcbiAgICAgICAgW1xyXG4gICAgICAgICAgICAnMTJfaG91cicsXHJcbiAgICAgICAgICAgIHRoaXMubWFrZVBhdHRlcm4oJ14oPzooLispICk/KF9IMTJfKSg/OlxcXFw6KF9NSU5fKSg/OlxcXFw6KF9TRUNfKSk/KT8gPyhfQU1QTV8pJCcpLFxyXG4gICAgICAgICAgICAobWF0Y2gpID0+IHtcclxuICAgICAgICAgICAgICAgIGxldCBkO1xyXG4gICAgICAgICAgICAgICAgaWYgKG1hdGNoWzFdKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZCA9IHRoaXMuY3JlYXRlKG1hdGNoWzFdKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoaXNOYU4oZCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZCA9IG5ldyBEYXRlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgZC5zZXRNaWxsaXNlY29uZHMoMCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBsZXQgaG91ciA9IHBhcnNlRmxvYXQobWF0Y2hbMl0pO1xyXG4gICAgICAgICAgICAgICAgaG91ciA9IG1hdGNoWzVdLnRvTG93ZXJDYXNlKCkgPT0gJ2FtJyA/IChob3VyID09IDEyID8gMCA6IGhvdXIpIDogKGhvdXIgPT0gMTIgPyAxMiA6IGhvdXIgKyAxMik7XHJcbiAgICAgICAgICAgICAgICBkLnNldEhvdXJzKGhvdXIsIHBhcnNlRmxvYXQobWF0Y2hbM10gfHwgMCksIHBhcnNlRmxvYXQobWF0Y2hbNF0gfHwgMCkpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICBdXHJcblxyXG4gICAgXTtcclxuXHJcbiAgICBtYWtlUGF0dGVybihjb2RlKSB7XHJcbiAgICAgICAgY29kZSA9IGNvZGUucmVwbGFjZSgvXyhbQS1aXVtBLVowLTldKylfL2csICgkMCwgJDEpID0+IHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMucmVnZXhlc1skMV07XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBSZWdFeHAoY29kZSwgJ2knKTtcclxuICAgIH1cclxuXHJcbiAgICBnZXRNb250aEJ5TmFtZShtb250aG5hbWUpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5NT05USE5BTUVTX0xPT0tVUFtTdHJpbmcobW9udGhuYW1lKS5zbGljZSgwLCAzKS50b0xvd2VyQ2FzZSgpXTtcclxuICAgIH1cclxuXHJcbiAgICBnZXRXZWVrZGF5QnlOYW1lKGRheW5hbWUpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5EQVlOQU1FU19MT09LVVBbU3RyaW5nKGRheW5hbWUpLnNsaWNlKDAsIDMpLnRvTG93ZXJDYXNlKCldO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgemVyb1BhZChudW0sIGRpZ2l0cykge1xyXG4gICAgICAgIHN3aXRjaCAoZGlnaXRzIC0gU3RyaW5nKG51bSkubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIGNhc2UgMjogcmV0dXJuICcwMCcgKyBudW07XHJcbiAgICAgICAgICAgIGNhc2UgMTogcmV0dXJuICcwJyArIG51bTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG51bTtcclxuICAgIH1cclxuXHJcbiAgICBjcmVhdGUoZGF0ZSkge1xyXG4gICAgICAgIC8vIDAgYXJndW1lbnRzIG9yIGRhdGUgaXMgdW5kZWZpbmVkXHJcbiAgICAgICAgaWYgKHR5cGVvZiBkYXRlID09ICd1bmRlZmluZWQnKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBEYXRlLm5vdygpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBJZiB0aGUgcGFzc2VkIHZhbHVlIGlzIGFscmVhZHkgYSBkYXRlIG9iamVjdCwgcmV0dXJuIGl0XHJcbiAgICAgICAgaWYgKGRhdGUgaW5zdGFuY2VvZiBEYXRlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBkYXRlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCBhID0gYXJndW1lbnRzO1xyXG4gICAgICAgIHN3aXRjaCAoYS5sZW5ndGgpIHtcclxuICAgICAgICAgICAgY2FzZSAxOlxyXG4gICAgICAgICAgICAgICAgLy8gSWYgdGhlIHBhc3NlZCB2YWx1ZSBpcyBhbiBpbnRlZ2VyLCBpbnRlcnByZXQgaXQgYXMgbXMgcGFzdCBlcG9jaFxyXG4gICAgICAgICAgICAgICAgaWYgKE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChkYXRlKSA9PSAnW29iamVjdCBOdW1iZXJdJykge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgRGF0ZShkYXRlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIC8vIHRyaW0gdGhlIGRhdGVcclxuICAgICAgICAgICAgICAgIGRhdGUgPSBTdHJpbmcoZGF0ZSkucmVwbGFjZSgvXlxccyooLiopXFxzKiQvLCAnJDEnKTtcclxuICAgICAgICAgICAgICAgIC8vIG5vcm1hbGl6ZSB3aGl0ZXNwYWNlXHJcbiAgICAgICAgICAgICAgICBkYXRlID0gZGF0ZS5yZXBsYWNlKC9cXHN7Mix9L2csICcgJyk7XHJcbiAgICAgICAgICAgICAgICBpZiAoZGF0ZSA9PT0gJycpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gRGF0ZS5ub3coKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHZhciBpID0gMCwgcGF0dGVybiwgbXMsIG9iaiwgbWF0Y2gsIHJlZ2V4LCBmbjtcclxuICAgICAgICAgICAgICAgIC8vIHRyeSBlYWNoIG9mIG91ciBwYXR0ZXJuc1xyXG4gICAgICAgICAgICAgICAgd2hpbGUgKChwYXR0ZXJuID0gdGhpcy5wYXR0ZXJuc1tpKytdKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgcGF0dGVyblswXSA9PSAnc3RyaW5nJykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBwYXR0ZXJuWzBdIGlzIHRoZSBuYW1lIG9mIHRoZSBwYXR0ZXJuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlZ2V4ID0gcGF0dGVyblsxXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZm4gPSBwYXR0ZXJuWzJdO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGJhY2t3YXJkcyBjb21wYXRpYmlsaXR5IHdpdGggdmVyc2lvbiAzLjFcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVnZXggPSBwYXR0ZXJuWzBdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmbiA9IHBhdHRlcm5bMV07XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmICghKG1hdGNoID0gZGF0ZS5tYXRjaChyZWdleCkpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGZuID09ICdmdW5jdGlvbicpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgb2JqID0gZm4obWF0Y2gsIGRhdGUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAob2JqIGluc3RhbmNlb2YgRGF0ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG9iajtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGZuIGlzIG5vdCBhIGZ1bmN0aW9uIGJ1dCBhIHN0cmluZyByZXBsYWNlIGNvbW1hbmRcclxuICAgICAgICAgICAgICAgICAgICAgICAgbXMgPSBEYXRlLnBhcnNlKGRhdGUucmVwbGFjZShyZWdleCwgZm4pKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFpc05hTihtcykpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgRGF0ZShtcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gTmFOO1xyXG4gICAgICAgICAgICBjYXNlIDI6IHJldHVybiBuZXcgRGF0ZShhWzBdLCBhWzFdLCAxKTtcclxuICAgICAgICAgICAgY2FzZSAzOiByZXR1cm4gbmV3IERhdGUoYVswXSwgYVsxXSwgYVsyXSk7XHJcbiAgICAgICAgICAgIGNhc2UgNDogcmV0dXJuIG5ldyBEYXRlKGFbMF0sIGFbMV0sIGFbMl0sIGFbM10pO1xyXG4gICAgICAgICAgICBjYXNlIDU6IHJldHVybiBuZXcgRGF0ZShhWzBdLCBhWzFdLCBhWzJdLCBhWzNdLCBhWzRdKTtcclxuICAgICAgICAgICAgY2FzZSA2OiByZXR1cm4gbmV3IERhdGUoYVswXSwgYVsxXSwgYVsyXSwgYVszXSwgYVs0XSwgYVs1XSk7XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6IHJldHVybiBuZXcgRGF0ZShhWzBdLCBhWzFdLCBhWzJdLCBhWzNdLCBhWzRdLCBhWzVdLCBhWzZdKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuIl19