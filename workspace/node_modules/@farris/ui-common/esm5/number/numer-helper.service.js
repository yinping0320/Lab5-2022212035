/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Injectable } from '@angular/core';
import { BigNumber } from 'bignumber.js';
import * as i0 from "@angular/core";
var NumberHelperService = /** @class */ (function () {
    function NumberHelperService() {
    }
    /**
     * @param {?} value
     * @param {?=} opts
     * @return {?}
     */
    NumberHelperService.prototype.formatMoney = /**
     * @param {?} value
     * @param {?=} opts
     * @return {?}
     */
    function (value, opts) {
        if (opts === void 0) { opts = {}; }
        return this.formatValue(value, opts);
    };
    /**
     * @param {?} value
     * @param {?=} opts
     * @return {?}
     */
    NumberHelperService.prototype.formatNumber = /**
     * @param {?} value
     * @param {?=} opts
     * @return {?}
     */
    function (value, opts) {
        if (opts === void 0) { opts = {}; }
        return this.formatValue(value, opts);
    };
    /**
     * @param {?} value
     * @param {?=} opts
     * @return {?}
     */
    NumberHelperService.prototype.unformat = /**
     * @param {?} value
     * @param {?=} opts
     * @return {?}
     */
    function (value, opts) {
        if (opts === void 0) { opts = {}; }
        return this._unformat(value, opts);
    };
    /** 获取最大值 */
    /**
     * 获取最大值
     * @param {?} n1
     * @param {?=} n2
     * @return {?}
     */
    NumberHelperService.prototype.max = /**
     * 获取最大值
     * @param {?} n1
     * @param {?=} n2
     * @return {?}
     */
    function (n1, n2) {
        if (n2 === void 0) { n2 = null; }
        if (Array.isArray(n1)) {
            return BigNumber.max.apply(null, n1).toFixed();
        }
        else {
            if (n1 && n2) {
                return BigNumber.maximum(n1, n2).toFixed();
            }
            else {
                console.error("\u8BF7\u63D0\u4F9B\u6BD4\u8F83\u7684\u503Cn1\u3001n2.");
            }
        }
    };
    /** 最小值 */
    /**
     * 最小值
     * @param {?} n1
     * @param {?=} n2
     * @return {?}
     */
    NumberHelperService.prototype.min = /**
     * 最小值
     * @param {?} n1
     * @param {?=} n2
     * @return {?}
     */
    function (n1, n2) {
        if (n2 === void 0) { n2 = null; }
        if (Array.isArray(n1)) {
            return BigNumber.min.apply(null, n1).toFixed();
        }
        else {
            if (n1 && n2) {
                return BigNumber.minimum(n1, n2).toFixed();
            }
            else {
                console.error("\u8BF7\u63D0\u4F9B\u6BD4\u8F83\u7684\u503Cn1\u3001n2.");
            }
        }
    };
    /** 求和 */
    /**
     * 求和
     * @param {?} n1
     * @return {?}
     */
    NumberHelperService.prototype.sum = /**
     * 求和
     * @param {?} n1
     * @return {?}
     */
    function (n1) {
        return BigNumber.sum.apply(null, n1).toFixed();
    };
    /** 平均数 */
    /**
     * 平均数
     * @param {?} n1
     * @param {?} len
     * @return {?}
     */
    NumberHelperService.prototype.avg = /**
     * 平均数
     * @param {?} n1
     * @param {?} len
     * @return {?}
     */
    function (n1, len) {
        return new BigNumber(n1).div(len).toFixed();
    };
    /**  加法 */
    /**
     * 加法
     * @param {?} n1
     * @param {?} n2
     * @return {?}
     */
    NumberHelperService.prototype.plus = /**
     * 加法
     * @param {?} n1
     * @param {?} n2
     * @return {?}
     */
    function (n1, n2) {
        return new BigNumber(n1).plus(n2).toFixed();
    };
    /** 乘法 */
    /**
     * 乘法
     * @param {?} n1
     * @param {?} n2
     * @return {?}
     */
    NumberHelperService.prototype.multiplied = /**
     * 乘法
     * @param {?} n1
     * @param {?} n2
     * @return {?}
     */
    function (n1, n2) {
        new BigNumber(n1).times(n2).toFixed();
    };
    /** 减法 */
    /**
     * 减法
     * @param {?} n1
     * @param {?} n2
     * @return {?}
     */
    NumberHelperService.prototype.minus = /**
     * 减法
     * @param {?} n1
     * @param {?} n2
     * @return {?}
     */
    function (n1, n2) {
        return new BigNumber(n1).minus(n2).toFixed();
    };
    /** 是否相等 */
    /**
     * 是否相等
     * @param {?} n1
     * @param {?} n2
     * @return {?}
     */
    NumberHelperService.prototype.eq = /**
     * 是否相等
     * @param {?} n1
     * @param {?} n2
     * @return {?}
     */
    function (n1, n2) {
        return new BigNumber(n1).eq(n2);
    };
    /**
     * @param {?} n1
     * @param {?} n2
     * @return {?}
     */
    NumberHelperService.prototype.lt = /**
     * @param {?} n1
     * @param {?} n2
     * @return {?}
     */
    function (n1, n2) {
        return new BigNumber(n1).lt(n2);
    };
    /**
     * @param {?} n1
     * @param {?} n2
     * @return {?}
     */
    NumberHelperService.prototype.gt = /**
     * @param {?} n1
     * @param {?} n2
     * @return {?}
     */
    function (n1, n2) {
        return new BigNumber(n1).gt(n2);
    };
    /**
     * @param {?} n1
     * @return {?}
     */
    NumberHelperService.prototype.toNumber = /**
     * @param {?} n1
     * @return {?}
     */
    function (n1) {
        return new BigNumber(n1).toNumber();
    };
    /**
     * @param {?} n1
     * @param {?=} precision
     * @return {?}
     */
    NumberHelperService.prototype.toFixed = /**
     * @param {?} n1
     * @param {?=} precision
     * @return {?}
     */
    function (n1, precision) {
        if (precision === void 0) { precision = 0; }
        return new BigNumber(n1).toFixed(precision);
    };
    /**
     * @param {?} money
     * @return {?}
     */
    NumberHelperService.prototype.convertCurrency = /**
     * @param {?} money
     * @return {?}
     */
    function (money) {
        // 汉字的数字
        /** @type {?} */
        var cnNums = new Array('零', '壹', '贰', '叁', '肆', '伍', '陆', '柒', '捌', '玖');
        // 基本单位
        /** @type {?} */
        var cnIntRadice = new Array('', '拾', '佰', '仟');
        // 对应整数部分扩展单位
        /** @type {?} */
        var cnIntUnits = new Array('', '万', '亿', '兆');
        // 对应小数部分单位
        /** @type {?} */
        var cnDecUnits = new Array('角', '分', '毫', '厘');
        // 整数金额时后面跟的字符
        /** @type {?} */
        var cnInteger = '整';
        // 整型完以后的单位
        /** @type {?} */
        var cnIntLast = '元';
        // 最大处理的数字
        /** @type {?} */
        var maxNum = 999999999999999.9999;
        // 金额整数部分
        /** @type {?} */
        var integerNum;
        // 金额小数部分
        /** @type {?} */
        var decimalNum;
        // 输出的中文金额字符串
        /** @type {?} */
        var chineseStr = '';
        // 分离金额后用的数组，预定义
        /** @type {?} */
        var parts;
        if (money == '') {
            return '';
        }
        money = parseFloat(money);
        if (money >= maxNum) {
            // 超出最大处理数字
            return '';
        }
        if (money === 0) {
            chineseStr = cnNums[0] + cnIntLast + cnInteger;
            return chineseStr;
        }
        // 转换为字符串
        money = money.toString();
        if (money.indexOf('.') === -1) {
            integerNum = money;
            decimalNum = '';
        }
        else {
            parts = money.split('.');
            integerNum = parts[0];
            decimalNum = parts[1].substr(0, 4);
        }
        // 获取整型部分转换
        if (parseInt(integerNum, 10) > 0) {
            /** @type {?} */
            var zeroCount = 0;
            /** @type {?} */
            var IntLen = integerNum.length;
            for (var i = 0; i < IntLen; i++) {
                /** @type {?} */
                var n = integerNum.substr(i, 1);
                /** @type {?} */
                var p = IntLen - i - 1;
                /** @type {?} */
                var q = p / 4;
                /** @type {?} */
                var m = p % 4;
                if (n == '0') {
                    zeroCount++;
                }
                else {
                    if (zeroCount > 0) {
                        chineseStr += cnNums[0];
                    }
                    // 归零
                    zeroCount = 0;
                    chineseStr += cnNums[parseInt(n, 10)] + cnIntRadice[m];
                }
                if (m == 0 && zeroCount < 4) {
                    chineseStr += cnIntUnits[q];
                }
            }
            chineseStr += cnIntLast;
        }
        // 小数部分
        if (decimalNum !== '') {
            /** @type {?} */
            var decLen = decimalNum.length;
            for (var i = 0; i < decLen; i++) {
                /** @type {?} */
                var n = decimalNum.substr(i, 1);
                if (n !== '0') {
                    chineseStr += cnNums[Number(n)] + cnDecUnits[i];
                }
            }
        }
        if (chineseStr === '') {
            chineseStr += cnNums[0] + cnIntLast + cnInteger;
        }
        else if (decimalNum === '') {
            chineseStr += cnInteger;
        }
        return chineseStr;
    };
    /**
     * @private
     * @param {?} val
     * @param {?} opts
     * @return {?}
     */
    NumberHelperService.prototype._unformat = /**
     * @private
     * @param {?} val
     * @param {?} opts
     * @return {?}
     */
    function (val, opts) {
        val = (val === null || val === undefined || isNaN(val)) ? '' : String(val);
        if (opts) {
            // 去前缀
            if (opts.prefix) {
                val = val.replace(new RegExp(opts.prefix, 'g'), '');
            }
            // 去后缀
            if (opts.suffix) {
                val = val.replace(new RegExp(opts.suffix, 'g'), '');
            }
            // 去掉千分位分隔符
            val = val.replace(/\,/g, '');
        }
        return val;
    };
    /**
     * @private
     * @param {?} value
     * @param {?} opts
     * @return {?}
     */
    NumberHelperService.prototype.formatValue = /**
     * @private
     * @param {?} value
     * @param {?} opts
     * @return {?}
     */
    function (value, opts) {
        /** @type {?} */
        var bignum = new BigNumber(value);
        /** @type {?} */
        var fmt = {
            prefix: opts.prefix || '',
            suffix: opts.suffix || '',
            decimalSeparator: opts.decimal || '.',
            groupSeparator: opts.thousand || '',
            groupSize: 3
        };
        if (bignum.isNaN()) {
            return '';
        }
        /** @type {?} */
        var precision = opts.precision || 0;
        precision = Number(precision);
        return bignum.toFormat(precision, fmt);
    };
    NumberHelperService.decorators = [
        { type: Injectable, args: [{
                    providedIn: 'root'
                },] }
    ];
    /** @nocollapse */
    NumberHelperService.ctorParameters = function () { return []; };
    /** @nocollapse */ NumberHelperService.ngInjectableDef = i0.defineInjectable({ factory: function NumberHelperService_Factory() { return new NumberHelperService(); }, token: NumberHelperService, providedIn: "root" });
    return NumberHelperService;
}());
export { NumberHelperService };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibnVtZXItaGVscGVyLnNlcnZpY2UuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZmFycmlzL3VpLWNvbW1vbi9udW1iZXIvIiwic291cmNlcyI6WyJudW1lci1oZWxwZXIuc2VydmljZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7O0FBQUEsT0FBTyxFQUFFLFVBQVUsRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUMzQyxPQUFPLEVBQUUsU0FBUyxFQUFFLE1BQU0sY0FBYyxDQUFDOztBQUl6QztJQUlJO0lBQWdCLENBQUM7Ozs7OztJQUVqQix5Q0FBVzs7Ozs7SUFBWCxVQUFZLEtBQUssRUFBRSxJQUFjO1FBQWQscUJBQUEsRUFBQSxTQUFjO1FBQzdCLE9BQU8sSUFBSSxDQUFDLFdBQVcsQ0FBQyxLQUFLLEVBQUUsSUFBSSxDQUFDLENBQUM7SUFDekMsQ0FBQzs7Ozs7O0lBRUQsMENBQVk7Ozs7O0lBQVosVUFBYSxLQUFLLEVBQUUsSUFBYztRQUFkLHFCQUFBLEVBQUEsU0FBYztRQUM5QixPQUFPLElBQUksQ0FBQyxXQUFXLENBQUMsS0FBSyxFQUFFLElBQUksQ0FBQyxDQUFDO0lBQ3pDLENBQUM7Ozs7OztJQUVELHNDQUFROzs7OztJQUFSLFVBQVMsS0FBSyxFQUFFLElBQWM7UUFBZCxxQkFBQSxFQUFBLFNBQWM7UUFDMUIsT0FBTyxJQUFJLENBQUMsU0FBUyxDQUFDLEtBQUssRUFBRSxJQUFJLENBQUMsQ0FBQztJQUN2QyxDQUFDO0lBRUQsWUFBWTs7Ozs7OztJQUNaLGlDQUFHOzs7Ozs7SUFBSCxVQUFJLEVBQU8sRUFBRSxFQUFTO1FBQVQsbUJBQUEsRUFBQSxTQUFTO1FBQ2xCLElBQUksS0FBSyxDQUFDLE9BQU8sQ0FBQyxFQUFFLENBQUMsRUFBRTtZQUNuQixPQUFPLFNBQVMsQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDLElBQUksRUFBRSxFQUFFLENBQUMsQ0FBQyxPQUFPLEVBQUUsQ0FBQztTQUNsRDthQUFNO1lBQ0gsSUFBSSxFQUFFLElBQUksRUFB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QU0sQ0FBQyxRQUFRLENBQUMsU0FBUyxFQUFFLEdBQUcsQ0FBQyxDQUFDO0lBQzNDLENBQUM7O2dCQXJOSixVQUFVLFNBQUM7b0JBQ1IsVUFBVSxFQUFFLE1BQU07aUJBQ3JCOzs7Ozs4QkFQRDtDQTJOQyxBQXRORCxJQXNOQztTQW5OWSxtQkFBbUIiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBJbmplY3RhYmxlIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IEJpZ051bWJlciB9IGZyb20gJ2JpZ251bWJlci5qcyc7XHJcblxyXG5leHBvcnQgdHlwZSBOdW1iZXJUeXBlID0gc3RyaW5nIHwgbnVtYmVyO1xyXG5cclxuQEluamVjdGFibGUoe1xyXG4gICAgcHJvdmlkZWRJbjogJ3Jvb3QnXHJcbn0pXHJcbmV4cG9ydCBjbGFzcyBOdW1iZXJIZWxwZXJTZXJ2aWNlIHtcclxuICAgIGNvbnN0cnVjdG9yKCkgeyB9XHJcblxyXG4gICAgZm9ybWF0TW9uZXkodmFsdWUsIG9wdHM6IGFueSA9IHt9KTogc3RyaW5nIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5mb3JtYXRWYWx1ZSh2YWx1ZSwgb3B0cyk7XHJcbiAgICB9XHJcblxyXG4gICAgZm9ybWF0TnVtYmVyKHZhbHVlLCBvcHRzOiBhbnkgPSB7fSk6IHN0cmluZyB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZm9ybWF0VmFsdWUodmFsdWUsIG9wdHMpO1xyXG4gICAgfVxyXG5cclxuICAgIHVuZm9ybWF0KHZhbHVlLCBvcHRzOiBhbnkgPSB7fSkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl91bmZvcm1hdCh2YWx1ZSwgb3B0cyk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqIOiOt+WPluacgOWkp+WAvCAqL1xyXG4gICAgbWF4KG4xOiBhbnksIG4yID0gbnVsbCkge1xyXG4gICAgICAgIGlmIChBcnJheS5pc0FycmF5KG4xKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gQmlnTnVtYmVyLm1heC5hcHBseShudWxsLCBuMSkudG9GaXhlZCgpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGlmIChuMSAmJiBuMikge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIEJpZ051bWJlci5tYXhpbXVtKG4xLCBuMikudG9GaXhlZCgpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihg6K+35o+Q5L6b5q+U6L6D55qE5YC8bjHjgIFuMi5gKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvKiog5pyA5bCP5YC8ICovXHJcbiAgICBtaW4objE6IGFueSwgbjIgPSBudWxsKSB7XHJcbiAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkobjEpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBCaWdOdW1iZXIubWluLmFwcGx5KG51bGwsIG4xKS50b0ZpeGVkKCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgaWYgKG4xICYmIG4yKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gQmlnTnVtYmVyLm1pbmltdW0objEsIG4yKS50b0ZpeGVkKCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGDor7fmj5Dkvpvmr5TovoPnmoTlgLxuMeOAgW4yLmApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8qKiDmsYLlkowgKi9cclxuICAgIHN1bShuMTogTnVtYmVyVHlwZVtdKSB7XHJcbiAgICAgICAgcmV0dXJuIEJpZ051bWJlci5zdW0uYXBwbHkobnVsbCwgbjEpLnRvRml4ZWQoKTtcclxuICAgIH1cclxuXHJcbiAgICAvKiog5bmz5Z2H5pWwICovXHJcbiAgICBhdmcobjE6IE51bWJlclR5cGUsIGxlbjogbnVtYmVyKSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBCaWdOdW1iZXIobjEpLmRpdihsZW4pLnRvRml4ZWQoKTtcclxuICAgIH1cclxuXHJcbiAgICAvKiogIOWKoOazlSAqL1xyXG4gICAgcGx1cyhuMTogTnVtYmVyVHlwZSwgbjI6IE51bWJlclR5cGUpIHtcclxuICAgICAgICByZXR1cm4gbmV3IEJpZ051bWJlcihuMSkucGx1cyhuMikudG9GaXhlZCgpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKiDkuZjms5UgKi9cclxuICAgIG11bHRpcGxpZWQobjE6IE51bWJlclR5cGUsIG4yOiBOdW1iZXJUeXBlKSB7XHJcbiAgICAgICAgbmV3IEJpZ051bWJlcihuMSkudGltZXMobjIpLnRvRml4ZWQoKTtcclxuICAgIH1cclxuXHJcbiAgICAvKiog5YeP5rOVICovXHJcbiAgICBtaW51cyhuMTogTnVtYmVyVHlwZSwgbjI6IE51bWJlclR5cGUpIHtcclxuICAgICAgICByZXR1cm4gbmV3IEJpZ051bWJlcihuMSkubWludXMobjIpLnRvRml4ZWQoKTtcclxuICAgIH1cclxuXHJcbiAgICAvKiog5piv5ZCm55u4562JICovXHJcbiAgICBlcShuMTogTnVtYmVyVHlwZSwgbjI6IE51bWJlclR5cGUpOiBib29sZWFuIHtcclxuICAgICAgICByZXR1cm4gbmV3IEJpZ051bWJlcihuMSkuZXEobjIpO1xyXG4gICAgfVxyXG5cclxuICAgIGx0KG4xOiBOdW1iZXJUeXBlLCBuMjogTnVtYmVyVHlwZSk6IGJvb2xlYW4ge1xyXG4gICAgICAgIHJldHVybiBuZXcgQmlnTnVtYmVyKG4xKS5sdChuMik7XHJcbiAgICB9XHJcbiAgICBndChuMTogTnVtYmVyVHlwZSwgbjI6IE51bWJlclR5cGUpOiBib29sZWFuIHtcclxuICAgICAgICByZXR1cm4gbmV3IEJpZ051bWJlcihuMSkuZ3QobjIpO1xyXG4gICAgfVxyXG5cclxuICAgIHRvTnVtYmVyKG4xOiBzdHJpbmcpIHtcclxuICAgICAgICByZXR1cm4gbmV3IEJpZ051bWJlcihuMSkudG9OdW1iZXIoKTtcclxuICAgIH1cclxuXHJcbiAgICB0b0ZpeGVkKG4xOiBzdHJpbmcsIHByZWNpc2lvbjogbnVtYmVyID0gMCkge1xyXG4gICAgICAgIHJldHVybiBuZXcgQmlnTnVtYmVyKG4xKS50b0ZpeGVkKHByZWNpc2lvbik7XHJcbiAgICB9XHJcblxyXG4gICAgY29udmVydEN1cnJlbmN5KG1vbmV5KSB7XHJcbiAgICAgICAgLy8g5rGJ5a2X55qE5pWw5a2XXHJcbiAgICAgICAgY29uc3QgY25OdW1zID0gbmV3IEFycmF5KCfpm7YnLCAn5aO5JywgJ+i0sCcsICflj4EnLCAn6IKGJywgJ+S8jScsICfpmYYnLCAn5p+SJywgJ+aNjCcsICfnjpYnKTtcclxuICAgICAgICAvLyDln7rmnKzljZXkvY1cclxuICAgICAgICBjb25zdCBjbkludFJhZGljZSA9IG5ldyBBcnJheSgnJywgJ+aLvicsICfkvbAnLCAn5LufJyk7XHJcbiAgICAgICAgLy8g5a+55bqU5pW05pWw6YOo5YiG5omp5bGV5Y2V5L2NXHJcbiAgICAgICAgY29uc3QgY25JbnRVbml0cyA9IG5ldyBBcnJheSgnJywgJ+S4hycsICfkur8nLCAn5YWGJyk7XHJcbiAgICAgICAgLy8g5a+55bqU5bCP5pWw6YOo5YiG5Y2V5L2NXHJcbiAgICAgICAgY29uc3QgY25EZWNVbml0cyA9IG5ldyBBcnJheSgn6KeSJywgJ+WIhicsICfmr6snLCAn5Y6YJyk7XHJcbiAgICAgICAgLy8g5pW05pWw6YeR6aKd5pe25ZCO6Z2i6Lef55qE5a2X56ymXHJcbiAgICAgICAgY29uc3QgY25JbnRlZ2VyID0gJ+aVtCc7XHJcbiAgICAgICAgLy8g5pW05Z6L5a6M5Lul5ZCO55qE5Y2V5L2NXHJcbiAgICAgICAgY29uc3QgY25JbnRMYXN0ID0gJ+WFgyc7XHJcbiAgICAgICAgLy8g5pyA5aSn5aSE55CG55qE5pWw5a2XXHJcbiAgICAgICAgY29uc3QgbWF4TnVtID0gOTk5OTk5OTk5OTk5OTk5Ljk5OTk7XHJcbiAgICAgICAgLy8g6YeR6aKd5pW05pWw6YOo5YiGXHJcbiAgICAgICAgbGV0IGludGVnZXJOdW07XHJcbiAgICAgICAgLy8g6YeR6aKd5bCP5pWw6YOo5YiGXHJcbiAgICAgICAgbGV0IGRlY2ltYWxOdW07XHJcbiAgICAgICAgLy8g6L6T5Ye655qE5Lit5paH6YeR6aKd5a2X56ym5LiyXHJcbiAgICAgICAgbGV0IGNoaW5lc2VTdHIgPSAnJztcclxuICAgICAgICAvLyDliIbnprvph5Hpop3lkI7nlKjnmoTmlbDnu4TvvIzpooTlrprkuYlcclxuICAgICAgICBsZXQgcGFydHM7XHJcbiAgICAgICAgaWYgKG1vbmV5ID09ICcnKSB7IHJldHVybiAnJzsgfVxyXG4gICAgICAgIG1vbmV5ID0gcGFyc2VGbG9hdChtb25leSk7XHJcbiAgICAgICAgaWYgKG1vbmV5ID49IG1heE51bSkge1xyXG4gICAgICAgICAgICAvLyDotoXlh7rmnIDlpKflpITnkIbmlbDlrZdcclxuICAgICAgICAgICAgcmV0dXJuICcnO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAobW9uZXkgPT09IDApIHtcclxuICAgICAgICAgICAgY2hpbmVzZVN0ciA9IGNuTnVtc1swXSArIGNuSW50TGFzdCArIGNuSW50ZWdlcjtcclxuICAgICAgICAgICAgcmV0dXJuIGNoaW5lc2VTdHI7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIOi9rOaNouS4uuWtl+espuS4slxyXG4gICAgICAgIG1vbmV5ID0gbW9uZXkudG9TdHJpbmcoKTtcclxuICAgICAgICBpZiAobW9uZXkuaW5kZXhPZignLicpID09PSAtMSkge1xyXG4gICAgICAgICAgICBpbnRlZ2VyTnVtID0gbW9uZXk7XHJcbiAgICAgICAgICAgIGRlY2ltYWxOdW0gPSAnJztcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBwYXJ0cyA9IG1vbmV5LnNwbGl0KCcuJyk7XHJcbiAgICAgICAgICAgIGludGVnZXJOdW0gPSBwYXJ0c1swXTtcclxuICAgICAgICAgICAgZGVjaW1hbE51bSA9IHBhcnRzWzFdLnN1YnN0cigwLCA0KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8g6I635Y+W5pW05Z6L6YOo5YiG6L2s5o2iXHJcbiAgICAgICAgaWYgKHBhcnNlSW50KGludGVnZXJOdW0sIDEwKSA+IDApIHtcclxuICAgICAgICAgICAgbGV0IHplcm9Db3VudCA9IDA7XHJcbiAgICAgICAgICAgIGNvbnN0IEludExlbiA9IGludGVnZXJOdW0ubGVuZ3RoO1xyXG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IEludExlbjsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBuID0gaW50ZWdlck51bS5zdWJzdHIoaSwgMSk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBwID0gSW50TGVuIC0gaSAtIDE7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBxID0gcCAvIDQ7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBtID0gcCAlIDQ7XHJcbiAgICAgICAgICAgICAgICBpZiAobiA9PSAnMCcpIHtcclxuICAgICAgICAgICAgICAgICAgICB6ZXJvQ291bnQrKztcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHplcm9Db3VudCA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2hpbmVzZVN0ciArPSBjbk51bXNbMF07XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIC8vIOW9kumbtlxyXG4gICAgICAgICAgICAgICAgICAgIHplcm9Db3VudCA9IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgY2hpbmVzZVN0ciArPSBjbk51bXNbcGFyc2VJbnQobiwgMTApXSArIGNuSW50UmFkaWNlW21dO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKG0gPT0gMCAmJiB6ZXJvQ291bnQgPCA0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2hpbmVzZVN0ciArPSBjbkludFVuaXRzW3FdO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNoaW5lc2VTdHIgKz0gY25JbnRMYXN0O1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyDlsI/mlbDpg6jliIZcclxuICAgICAgICBpZiAoZGVjaW1hbE51bSAhPT0gJycpIHtcclxuICAgICAgICAgICAgY29uc3QgZGVjTGVuID0gZGVjaW1hbE51bS5sZW5ndGg7XHJcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZGVjTGVuOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIGxldCBuID0gZGVjaW1hbE51bS5zdWJzdHIoaSwgMSk7XHJcbiAgICAgICAgICAgICAgICBpZiAobiAhPT0gJzAnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2hpbmVzZVN0ciArPSBjbk51bXNbTnVtYmVyKG4pXSArIGNuRGVjVW5pdHNbaV07XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGNoaW5lc2VTdHIgPT09ICcnKSB7XHJcbiAgICAgICAgICAgIGNoaW5lc2VTdHIgKz0gY25OdW1zWzBdICsgY25JbnRMYXN0ICsgY25JbnRlZ2VyO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoZGVjaW1hbE51bSA9PT0gJycpIHtcclxuICAgICAgICAgICAgY2hpbmVzZVN0ciArPSBjbkludGVnZXI7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBjaGluZXNlU3RyO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIF91bmZvcm1hdCh2YWwsIG9wdHMpIHtcclxuICAgICAgICB2YWwgPSAodmFsID09PSBudWxsIHx8IHZhbCA9PT0gdW5kZWZpbmVkIHx8IGlzTmFOKHZhbCkpID8gJycgOiBTdHJpbmcodmFsKTtcclxuICAgICAgICBpZiAob3B0cykge1xyXG4gICAgICAgICAgICAvLyDljrvliY3nvIBcclxuICAgICAgICAgICAgaWYgKG9wdHMucHJlZml4KSB7XHJcbiAgICAgICAgICAgICAgICB2YWwgPSB2YWwucmVwbGFjZShuZXcgUmVnRXhwKG9wdHMucHJlZml4LCAnZycpLCAnJyk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC8vIOWOu+WQjue8gFxyXG4gICAgICAgICAgICBpZiAob3B0cy5zdWZmaXgpIHtcclxuICAgICAgICAgICAgICAgIHZhbCA9IHZhbC5yZXBsYWNlKG5ldyBSZWdFeHAob3B0cy5zdWZmaXgsICdnJyksICcnKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgLy8g5Y675o6J5Y2D5YiG5L2N5YiG6ZqU56ymXHJcbiAgICAgICAgICAgIHZhbCA9IHZhbC5yZXBsYWNlKC9cXCwvZywgJycpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdmFsO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgZm9ybWF0VmFsdWUodmFsdWUsIG9wdHM6IGFueSkge1xyXG4gICAgICAgIGNvbnN0IGJpZ251bSA9IG5ldyBCaWdOdW1iZXIodmFsdWUpO1xyXG4gICAgICAgIGNvbnN0IGZtdCA9IHtcclxuICAgICAgICAgICAgcHJlZml4OiBvcHRzLnByZWZpeCB8fCAnJyxcclxuICAgICAgICAgICAgc3VmZml4OiBvcHRzLnN1ZmZpeCB8fCAnJyxcclxuICAgICAgICAgICAgZGVjaW1hbFNlcGFyYXRvcjogb3B0cy5kZWNpbWFsIHx8ICcuJyxcclxuICAgICAgICAgICAgZ3JvdXBTZXBhcmF0b3I6IG9wdHMudGhvdXNhbmQgfHwgJycsXHJcbiAgICAgICAgICAgIGdyb3VwU2l6ZTogM1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIGlmIChiaWdudW0uaXNOYU4oKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gJyc7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBsZXQgcHJlY2lzaW9uID0gb3B0cy5wcmVjaXNpb24gfHwgMDtcclxuICAgICAgICBwcmVjaXNpb24gPSBOdW1iZXIocHJlY2lzaW9uKTtcclxuXHJcbiAgICAgICAgcmV0dXJuIGJpZ251bS50b0Zvcm1hdChwcmVjaXNpb24sIGZtdCk7XHJcbiAgICB9XHJcbn1cclxuIl19