/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
import { Injectable } from '@angular/core';
import { ColumnFormatService } from '@farris/ui-common/column';
import * as i0 from "@angular/core";
var CommonUtils = /** @class */ (function () {
    function CommonUtils() {
        this.cfs = null;
        if (!this.cfs) {
            this.cfs = new ColumnFormatService(null, null);
        }
    }
    /**
     * @param {?} field
     * @param {?} data
     * @return {?}
     */
    CommonUtils.prototype.keyIsInData = /**
     * @param {?} field
     * @param {?} data
     * @return {?}
     */
    function (field, data) {
        /** @type {?} */
        var noProperty = 'no property';
        /** @type {?} */
        var val = field.split('.').reduce((/**
         * @param {?} obj
         * @param {?} key
         * @return {?}
         */
        function (obj, key) {
            if (obj && obj.hasOwnProperty(key)) {
                return obj[key];
            }
            else {
                return noProperty;
            }
        }), data);
        return val != noProperty;
    };
    /**
     * 获取对象中指定字段的值。 field: 可以为带有层级结构的路径，如： user.firstName | name 等
     * data: 获取字段的数据源，一般为JSON对象
     * safe: 为true, 将html字符进行转码输出，默认为 false
     */
    /**
     * 获取对象中指定字段的值。 field: 可以为带有层级结构的路径，如： user.firstName | name 等
     * data: 获取字段的数据源，一般为JSON对象
     * safe: 为true, 将html字符进行转码输出，默认为 false
     * @param {?} field
     * @param {?} data
     * @param {?=} safe
     * @return {?}
     */
    CommonUtils.prototype.getValue = /**
     * 获取对象中指定字段的值。 field: 可以为带有层级结构的路径，如： user.firstName | name 等
     * data: 获取字段的数据源，一般为JSON对象
     * safe: 为true, 将html字符进行转码输出，默认为 false
     * @param {?} field
     * @param {?} data
     * @param {?=} safe
     * @return {?}
     */
    function (field, data, safe) {
        if (safe === void 0) { safe = false; }
        if (!data) {
            return '';
        }
        /** @type {?} */
        var resultVal = '';
        if (field.indexOf('.') === -1 && data.hasOwnProperty(field)) {
            resultVal = data[field];
        }
        else {
            resultVal = field.split('.').reduce((/**
             * @param {?} obj
             * @param {?} key
             * @return {?}
             */
            function (obj, key) {
                if (obj) {
                    return obj[key];
                }
                else {
                    return null;
                }
            }), data);
        }
        if (safe) {
            return this.formatterValue(resultVal);
        }
        else {
            return resultVal;
        }
    };
    /**
     * 更新指定对象中某个字段的值
     * @param obj 被更新对象
     * @param field 被更新字段
     * @param val 新值
     * @param nest 是否为嵌套，默认为 true
     */
    /**
     * 更新指定对象中某个字段的值
     * @param {?} obj 被更新对象
     * @param {?} field 被更新字段
     * @param {?} val 新值
     * @param {?=} nest 是否为嵌套，默认为 true
     * @return {?}
     */
    CommonUtils.prototype.setValue = /**
     * 更新指定对象中某个字段的值
     * @param {?} obj 被更新对象
     * @param {?} field 被更新字段
     * @param {?} val 新值
     * @param {?=} nest 是否为嵌套，默认为 true
     * @return {?}
     */
    function (obj, field, val, nest) {
        if (nest === void 0) { nest = true; }
        if (field) {
            if (field.indexOf('.') > -1 && nest) {
                /** @type {?} */
                var lastObj_1 = null;
                /** @type {?} */
                var _fields = field.split('.');
                _fields.reduce((/**
                 * @param {?} c
                 * @param {?} p
                 * @return {?}
                 */
                function (c, p) {
                    lastObj_1 = c;
                    return c[p];
                }), obj);
                if (lastObj_1) {
                    lastObj_1[_fields.pop()] = val;
                }
            }
            else {
                obj[field] = val;
            }
        }
    };
    /**
     * @param {?} value
     * @param {?} enumData
     * @param {?} valueField
     * @return {?}
     */
    CommonUtils.prototype.getEnumItem = /**
     * @param {?} value
     * @param {?} enumData
     * @param {?} valueField
     * @return {?}
     */
    function (value, enumData, valueField) {
        /** @type {?} */
        var item = enumData.find((/**
         * @param {?} n
         * @return {?}
         */
        function (n) { return n[valueField] == value; }));
        return item;
    };
    /**
     * @private
     * @param {?} value
     * @param {?} col
     * @return {?}
     */
    CommonUtils.prototype._getEnumTitleFromColumn = /**
     * @private
     * @param {?} value
     * @param {?} col
     * @return {?}
     */
    function (value, col) {
        /** @type {?} */
        var _col = (/** @type {?} */ (col));
        /** @type {?} */
        var formatter = (/** @type {?} */ (_col.formatter));
        if (formatter && typeof formatter === 'object') {
            if (formatter.type === 'enum' && formatter.options) {
                return this.getEnumTitleFromColumnOptions(value, formatter.options);
            }
        }
        return value;
    };
    /**
     * @param {?} col
     * @param {?} data
     * @return {?}
     */
    CommonUtils.prototype.getEnumTitle = /**
     * @param {?} col
     * @param {?} data
     * @return {?}
     */
    function (col, data) {
        /** @type {?} */
        var val = this.getValue(col.field, data);
        return this._getEnumTitleFromColumn(val, col);
    };
    /**
     * @param {?} value
     * @param {?} opts
     * @return {?}
     */
    CommonUtils.prototype.getEnumTitleFromColumnOptions = /**
     * @param {?} value
     * @param {?} opts
     * @return {?}
     */
    function (value, opts) {
        var data = opts.data, valueField = opts.valueField, textField = opts.textField;
        /** @type {?} */
        var item = this.getEnumItem(value, data, valueField);
        if (item) {
            return item[textField];
        }
        else {
            return value;
        }
    };
    /**
     * @param {?} str
     * @return {?}
     */
    CommonUtils.prototype.escapeHtml = /**
     * @param {?} str
     * @return {?}
     */
    function (str) {
        if (str === null || str === undefined) {
            return '';
        }
        return str
            .replace(/&/g, '&amp;')
            .replace(/</g, '&lt;')
            .replace(/>/g, '&gt;')
            .replace(/\"/g, '&quot;')
            .replace(/\'/g, '&#39;')
            .replace(/\//g, '&#x2F;');
    };
    /**
     * @param {?} str
     * @return {?}
     */
    CommonUtils.prototype.unescapeHtml = /**
     * @param {?} str
     * @return {?}
     */
    function (str) {
        if (str === null || str === undefined) {
            return '';
        }
        return str
            .replace(/&amp;/g, '&')
            .replace(/&lt;/g, '<')
            .replace(/&gt;/g, '>')
            .replace(/&quot;/g, '"')
            .replace(/&#39;/g, '\'')
            .replace(/&#x2F;/g, '/');
    };
    /**
     * @private
     * @param {?} val
     * @return {?}
     */
    CommonUtils.prototype.formatterValue = /**
     * @private
     * @param {?} val
     * @return {?}
     */
    function (val) {
        if (val === null || val === undefined || val === '') {
            return '';
        }
        if (typeof val === 'string') {
            return this.escapeHtml(val);
        }
        return val;
    };
    /** 获取字符串在页面中的真实宽度 */
    /**
     * 获取字符串在页面中的真实宽度
     * @param {?} txt
     * @param {?} font
     * @return {?}
     */
    CommonUtils.prototype.getTextWidth = /**
     * 获取字符串在页面中的真实宽度
     * @param {?} txt
     * @param {?} font
     * @return {?}
     */
    function (txt, font) {
        // const frag = document.createDocumentFragment();
        /** @type {?} */
        var canvas = document.createElement('canvas');
        /** @type {?} */
        var context = canvas.getContext('2d');
        context.font = font;
        /** @type {?} */
        var metrics = context.measureText(txt);
        return Math.round(metrics.width);
    };
    /**
     * @param {?} id
     * @return {?}
     */
    CommonUtils.prototype.removeStyleSheet = /**
     * @param {?} id
     * @return {?}
     */
    function (id) {
        /** @type {?} */
        var styleElement = document.querySelector('#' + id);
        if (styleElement) {
            styleElement.remove();
        }
    };
    /**
     * @param {?} styleSheetId
     * @return {?}
     */
    CommonUtils.prototype.createStyleSheet = /**
     * @param {?} styleSheetId
     * @return {?}
     */
    function (styleSheetId) {
        /** @type {?} */
        var htmlHead = document.querySelector('head');
        /** @type {?} */
        var styleEleId = styleSheetId;
        /** @type {?} */
        var styleElement = null;
        if (document.querySelector('#' + styleEleId)) {
            styleElement = document.querySelector('#' + styleEleId);
            styleElement.innerText = '';
        }
        else {
            styleElement = document.createElement('style');
            styleElement.id = styleEleId;
            htmlHead.appendChild(styleElement);
        }
        return styleElement;
    };
    /**
     * @param {?} styleSheetId
     * @return {?}
     */
    CommonUtils.prototype.getStyleSheet = /**
     * @param {?} styleSheetId
     * @return {?}
     */
    function (styleSheetId) {
        var e_1, _a;
        /** @type {?} */
        var styleSheets = (/** @type {?} */ (document.styleSheets));
        /** @type {?} */
        var styleSheet = null;
        try {
            for (var styleSheets_1 = tslib_1.__values(styleSheets), styleSheets_1_1 = styleSheets_1.next(); !styleSheets_1_1.done; styleSheets_1_1 = styleSheets_1.next()) {
                var stylesheet = styleSheets_1_1.value;
                if ((stylesheet.ownerNode || stylesheet['owningElement']).id === styleSheetId) {
                    styleSheet = stylesheet;
                    break;
                }
            }
        }
        catch (e_1_1) { e_1 = { error: e_1_1 }; }
        finally {
            try {
                if (styleSheets_1_1 && !styleSheets_1_1.done && (_a = styleSheets_1.return)) _a.call(styleSheets_1);
            }
            finally { if (e_1) throw e_1.error; }
        }
        return styleSheet;
    };
    /** 与现有样式合并 */
    /**
     * 与现有样式合并
     * @param {?} rules
     * @param {?} styleSheet
     * @return {?}
     */
    CommonUtils.prototype.appendCssRules = /**
     * 与现有样式合并
     * @param {?} rules
     * @param {?} styleSheet
     * @return {?}
     */
    function (rules, styleSheet) {
        var e_2, _a;
        try {
            for (var rules_1 = tslib_1.__values(rules), rules_1_1 = rules_1.next(); !rules_1_1.done; rules_1_1 = rules_1.next()) {
                var rule = rules_1_1.value;
                /** @type {?} */
                var ruleName = rule.slice(0, rule.indexOf('{'));
                /** @type {?} */
                var removedCssRule = this.removeCssRule(ruleName, styleSheet);
                /** @type {?} */
                var cssText = '';
                if (removedCssRule) {
                    cssText += removedCssRule.cssText.slice(removedCssRule.cssText.indexOf('{') + 1, removedCssRule.cssText.indexOf('}'));
                }
                cssText += rule.slice(rule.indexOf('{') + 1, rule.indexOf('}')).replace(/"/g, '').replace(/,/g, ';') + ';';
                if (styleSheet.addRule) {
                    styleSheet.addRule(ruleName, cssText, 0);
                }
                else {
                    /** @type {?} */
                    var _newRule = ruleName + "{ " + cssText + " }";
                    styleSheet.insertRule(_newRule, 0);
                }
            }
        }
        catch (e_2_1) { e_2 = { error: e_2_1 }; }
        finally {
            try {
                if (rules_1_1 && !rules_1_1.done && (_a = rules_1.return)) _a.call(rules_1);
            }
            finally { if (e_2) throw e_2.error; }
        }
    };
    /** 覆盖现有的样式 */
    /**
     * 覆盖现有的样式
     * @param {?} rules
     * @param {?} styleSheet
     * @return {?}
     */
    CommonUtils.prototype.appendCssRules2 = /**
     * 覆盖现有的样式
     * @param {?} rules
     * @param {?} styleSheet
     * @return {?}
     */
    function (rules, styleSheet) {
        var e_3, _a;
        try {
            for (var rules_2 = tslib_1.__values(rules), rules_2_1 = rules_2.next(); !rules_2_1.done; rules_2_1 = rules_2.next()) {
                var rule = rules_2_1.value;
                /** @type {?} */
                var ruleName = rule.slice(0, rule.indexOf('{'));
                /** @type {?} */
                var removedCssRule = this.removeCssRule(ruleName, styleSheet);
                /** @type {?} */
                var cssText = rule.slice(rule.indexOf('{') + 1, rule.indexOf('}')).replace(/"/g, '').replace(/,/g, ';') + ';';
                if (styleSheet.addRule) {
                    styleSheet.addRule(ruleName, cssText, 0);
                }
                else {
                    /** @type {?} */
                    var _newRule = ruleName + "{ " + cssText + " }";
                    styleSheet.insertRule(_newRule, 0);
                }
            }
        }
        catch (e_3_1) { e_3 = { error: e_3_1 }; }
        finally {
            try {
                if (rules_2_1 && !rules_2_1.done && (_a = rules_2.return)) _a.call(rules_2);
            }
            finally { if (e_3) throw e_3.error; }
        }
    };
    /**
     * @param {?} ruleName
     * @param {?} styleSheet
     * @return {?}
     */
    CommonUtils.prototype.getCssRule = /**
     * @param {?} ruleName
     * @param {?} styleSheet
     * @return {?}
     */
    function (ruleName, styleSheet) {
        var e_4, _a;
        /** @type {?} */
        var cssRules = (/** @type {?} */ ((styleSheet.cssRules || styleSheet.rules)));
        /** @type {?} */
        var r = null;
        try {
            for (var cssRules_1 = tslib_1.__values(cssRules), cssRules_1_1 = cssRules_1.next(); !cssRules_1_1.done; cssRules_1_1 = cssRules_1.next()) {
                var rule = cssRules_1_1.value;
                if (rule.selectorText == ruleName) {
                    r = rule;
                }
            }
        }
        catch (e_4_1) { e_4 = { error: e_4_1 }; }
        finally {
            try {
                if (cssRules_1_1 && !cssRules_1_1.done && (_a = cssRules_1.return)) _a.call(cssRules_1);
            }
            finally { if (e_4) throw e_4.error; }
        }
        return r;
    };
    /**
     * @param {?} ruleName
     * @param {?} styleSheet
     * @return {?}
     */
    CommonUtils.prototype.removeCssRule = /**
     * @param {?} ruleName
     * @param {?} styleSheet
     * @return {?}
     */
    function (ruleName, styleSheet) {
        /** @type {?} */
        var cssRules = (/** @type {?} */ ((styleSheet.cssRules || styleSheet.rules)));
        /** @type {?} */
        var ii = 0;
        /** @type {?} */
        var cssRule = false;
        do {
            cssRule = cssRules[ii];
            if (cssRule) {
                if (cssRule.selectorText.toLowerCase() == ruleName.toLowerCase()) {
                    if (styleSheet.cssRules) {
                        styleSheet.deleteRule(ii);
                    }
                    else {
                        styleSheet.removeRule(ii);
                    }
                    return cssRule;
                }
            }
            ii++;
        } while (cssRule);
    };
    /**
     * @param {?} val
     * @return {?}
     */
    CommonUtils.prototype.isNullOrUndefined = /**
     * @param {?} val
     * @return {?}
     */
    function (val) {
        return val === null || val === undefined;
    };
    /**
     * @return {?}
     */
    CommonUtils.prototype.isIE = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var uA = window.navigator.userAgent;
        return /msie\s|trident\/|edge\//i.test(uA) && !!('uniqueID' in document || 'documentMode' in document || ('ActiveXObject' in window) || 'MSInputMethodContext' in window);
    };
    /**
     * @param {?} sorts
     * @return {?}
     */
    CommonUtils.prototype.buildSortString = /**
     * @param {?} sorts
     * @return {?}
     */
    function (sorts) {
        return this.cfs.buildSortString(sorts);
    };
    /**
     * @param {?} conditions
     * @return {?}
     */
    CommonUtils.prototype.buildSqlWhere = /**
     * @param {?} conditions
     * @return {?}
     */
    function (conditions) {
        return this.cfs.buildSqlWhere(conditions);
    };
    /**
     * @return {?}
     */
    CommonUtils.prototype.getBrowserType = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var ua = navigator.userAgent.toLowerCase();
        // 获取用户端信息
        /** @type {?} */
        var info = {
            ie: /msie/.test(ua) && !/opera/.test(ua),
            //  匹配IE浏览器
            op: /opera/.test(ua),
            //  匹配Opera浏览器
            sa: /version.*safari/.test(ua),
            // 匹配Safari浏览器
            ch: /chrome/.test(ua),
            //  匹配Chrome浏览器
            ff: /gecko/.test(ua) && !/webkit/.test(ua) // 匹配Firefox浏览器
        };
        return info;
    };
    /**
     * @return {?}
     */
    CommonUtils.prototype.getFFVer = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var ua = navigator.userAgent;
        /** @type {?} */
        var b = ua.indexOf('Firefox/');
        if (b < 0) {
            return 0;
        }
        return parseFloat(ua.substring(b + 8, ua.lastIndexOf('\.')));
    };
    /**
     * @param {?} name
     * @param {?=} locationSearch
     * @return {?}
     */
    CommonUtils.prototype.getQueryString = /**
     * @param {?} name
     * @param {?=} locationSearch
     * @return {?}
     */
    function (name, locationSearch) {
        if (locationSearch === void 0) { locationSearch = ''; }
        /** @type {?} */
        var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)", "i");
        /** @type {?} */
        var _search = window.location.search;
        if (locationSearch) {
            _search = locationSearch;
        }
        /** @type {?} */
        var r = _search.substring(1).match(reg);
        if (r != null)
            return (r[2]);
        return null;
    };
    /**
     * 获取页面中body下所有元素的zIndex, 并返回下个浮层的新zindex
     */
    /**
     * 获取页面中body下所有元素的zIndex, 并返回下个浮层的新zindex
     * @param {?=} upperLayers
     * @return {?}
     */
    CommonUtils.prototype.getFloatingLayerIndex = /**
     * 获取页面中body下所有元素的zIndex, 并返回下个浮层的新zindex
     * @param {?=} upperLayers
     * @return {?}
     */
    function (upperLayers) {
        if (upperLayers === void 0) { upperLayers = 1; }
        /** @type {?} */
        var selectors = [
            'body>.f-datagrid-settings-simple-host',
            'body>div',
            'body>farris-dialog>.farris-modal.show',
            'body>.farris-modal.show',
            'body>farris-filter-panel>.f-filter-panel-wrapper',
            'body .f-sidebar-show>.f-sidebar-main',
            'body>.popover.show',
            'body>filter-row-panel>.f-datagrid-filter-panel',
            'body>.f-section-maximize'
        ];
        /** @type {?} */
        var overlays = Array.from(document.body.querySelectorAll(selectors.join(','))).filter((/**
         * @param {?} n
         * @return {?}
         */
        function (n) { return n; })).map((/**
         * @param {?} n
         * @return {?}
         */
        function (n) {
            var _a = window.getComputedStyle(n), display = _a.display, zIndex = _a.zIndex;
            if (display === 'none') {
                return 0;
            }
            return parseInt(zIndex, 10);
        })).filter((/**
         * @param {?} n
         * @return {?}
         */
        function (n) { return n; }));
        /** @type {?} */
        var maxZindex = Math.max.apply(Math, tslib_1.__spread(overlays));
        if (maxZindex < 1040) {
            maxZindex = 1040;
        }
        return maxZindex + upperLayers;
    };
    /** 点击N次后，执行callback; 默认点击10次后执行 */
    /**
     * 点击N次后，执行callback; 默认点击10次后执行
     * @param {?} callback
     * @param {?=} clickTatgatNum
     * @return {?}
     */
    CommonUtils.prototype.clickContinuity = /**
     * 点击N次后，执行callback; 默认点击10次后执行
     * @param {?} callback
     * @param {?=} clickTatgatNum
     * @return {?}
     */
    function (callback, clickTatgatNum) {
        var _this = this;
        if (clickTatgatNum === void 0) { clickTatgatNum = 10; }
        if (this['clickCountNow'] === undefined) {
            this['clickCountNow'] = 0;
        }
        // 连续点击次数小于指定次数时
        if (this['clickCountNow'] < clickTatgatNum - 1) {
            // 清除定时器
            if (this['clickTimer']) {
                clearTimeout(this['clickTimer']);
                this['clickTimer'] = null;
            }
            // 点击次数+1
            this['clickCountNow']++;
            // 打印次数日志
            // console.log(`clickCountNow`, this['clickCountNow'])
            // 设置定时器，大于300毫秒点击不算连续点击
            this['clickTimer'] = setTimeout((/**
             * @return {?}
             */
            function () {
                _this['clickCountNow'] = 0;
            }), 300);
        }
        else {
            // 点击次数+1（此时已大于等于指定点击次数）
            this['clickCountNow']++;
            // 打印日志
            // console.log(`连续点击了${this['clickCountNow']}次`, `做点什么`)
            if (callback) {
                callback();
            }
            // 清除定时器
            if (this['clickTimer']) {
                clearTimeout(this['clickTimer']);
                this['clickTimer'] = null;
            }
            // 点击次数归零，重新计数
            this['clickCountNow'] = 0;
        }
    };
    /**
     * @param {?=} enterFn
     * @param {?=} escFn
     * @return {?}
     */
    CommonUtils.prototype.regBodyKeydownEvent = /**
     * @param {?=} enterFn
     * @param {?=} escFn
     * @return {?}
     */
    function (enterFn, escFn) {
        /** @type {?} */
        var keydownHandle = (/**
         * @param {?} $event
         * @return {?}
         */
        function ($event) {
            if ($event.key !== 'Escape' && $event.key !== 'Enter') {
                return;
            }
            $event.preventDefault();
            $event.stopPropagation();
            if ($event.key == 'Enter' && enterFn) {
                // 执行查询
                enterFn();
            }
            else {
                escFn && escFn();
            }
        });
        document.body.addEventListener('keydown', keydownHandle, true);
        return (/**
         * @return {?}
         */
        function () {
            document.body.removeEventListener('keydown', keydownHandle, true);
        });
    };
    CommonUtils.decorators = [
        { type: Injectable, args: [{
                    providedIn: 'root'
                },] }
    ];
    /** @nocollapse */
    CommonUtils.ctorParameters = function () { return []; };
    /** @nocollapse */ CommonUtils.ngInjectableDef = i0.defineInjectable({ factory: function CommonUtils_Factory() { return new CommonUtils(); }, token: CommonUtils, providedIn: "root" });
    return CommonUtils;
}());
export { CommonUtils };
if (false) {
    /**
     * @type {?}
     * @private
     */
    CommonUtils.prototype.cfs;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29tbW9uLnV0aWxzLmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGZhcnJpcy91aS1jb21tb24vIiwic291cmNlcyI6WyJsaWIvY29tbW9uLnV0aWxzLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7O0FBQUEsT0FBTyxFQUFFLFVBQVUsRUFBWSxNQUFNLGVBQWUsQ0FBQztBQUNyRCxPQUFPLEVBQWtELG1CQUFtQixFQUFFLE1BQU0sMEJBQTBCLENBQUM7O0FBRS9HO0lBS0k7UUFEUSxRQUFHLEdBQXdCLElBQUksQ0FBQztRQUVwQyxJQUFJLENBQUMsSUFBSSxDQUFDLEdBQUcsRUFBRTtZQUNYLElBQUksQ0FBQyxHQUFHLEdBQUcsSUFBSSxtQkFBbUIsQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDLENBQUM7U0FDbEQ7SUFDTCxDQUFDOzs7Ozs7SUFFRCxpQ0FBVzs7Ozs7SUFBWCxVQUFZLEtBQUssRUFBRSxJQUFJOztZQUNiLFVBQVUsR0FBRyxhQUFhOztZQUMxQixHQUFHLEdBQUcsS0FBSyxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQyxNQUFNOzs7OztRQUFDLFVBQUMsR0FBRyxFQUFFLEdBQUc7WUFDekMsSUFBSSxHQUFHLElBQUksR0FBRyxDQUFDLGNBQWMsQ0FBQyxHQUFHLENBQUMsRUFBRTtnQkFDaEMsT0FBTyxHQUFHLENBQUMsR0FBRyxDQUFDLENBQUM7YUFDbkI7aUJBQU07Z0JBQ0gsT0FBTyxVQUFVLENBQUM7YUFDckI7UUFDTCxDQUFDLEdBQUUsSUFBSSxDQUFDO1FBRVIsT0FBTyxHQUFHLElBQUksVUFBVSxDQUFDO0lBQzdCLENBQUM7SUFFRDs7OztPQUlHOzs7Ozs7Ozs7O0lBQ0gsOEJBQVE7Ozs7Ozs7OztJQUFSLFVBQVMsS0FBYSxFQUFFLElBQVMsRUFBRSxJQUFZO1FBQVoscUJBQUEsRUFBQSxZQUFZO1FBQzNDLElBQUksQ0FBQyxJQUFJLEVBQUU7WUFDUCxPQUFRLEVBQUUsQ0FBQztTQUNkOztZQUNHLFNBQVMsR0FBRyxFQUFF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b25hbCB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBEYXRhQ29sdW1uLCBDb2x1bW5Gb3JtYXR0ZXIsIEVudW1Gb3JtYXRPcHRpb25zLCBDb2x1bW5Gb3JtYXRTZXJ2aWNlIH0gZnJvbSAnQGZhcnJpcy91aS1jb21tb24vY29sdW1uJztcclxuXHJcbkBJbmplY3RhYmxlKHtcclxuICAgIHByb3ZpZGVkSW46ICdyb290J1xyXG59KVxyXG5leHBvcnQgY2xhc3MgQ29tbW9uVXRpbHMge1xyXG4gICAgcHJpdmF0ZSBjZnM6IENvbHVtbkZvcm1hdFNlcnZpY2UgPSBudWxsO1xyXG4gICAgY29uc3RydWN0b3IoKSB7XHJcbiAgICAgICAgaWYgKCF0aGlzLmNmcykge1xyXG4gICAgICAgICAgICB0aGlzLmNmcyA9IG5ldyBDb2x1bW5Gb3JtYXRTZXJ2aWNlKG51bGwsIG51bGwpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBrZXlJc0luRGF0YShmaWVsZCwgZGF0YSkge1xyXG4gICAgICAgIGNvbnN0IG5vUHJvcGVydHkgPSAnbm8gcHJvcGVydHknO1xyXG4gICAgICAgIGNvbnN0IHZhbCA9IGZpZWxkLnNwbGl0KCcuJykucmVkdWNlKChvYmosIGtleSkgPT4ge1xyXG4gICAgICAgICAgICBpZiAob2JqICYmIG9iai5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gb2JqW2tleV07XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbm9Qcm9wZXJ0eTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sIGRhdGEpO1xyXG5cclxuICAgICAgICByZXR1cm4gdmFsICE9IG5vUHJvcGVydHk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDojrflj5blr7nosaHkuK3mjIflrprlrZfmrrXnmoTlgLzjgIIgZmllbGQ6IOWPr+S7peS4uuW4puacieWxgue6p+e7k+aehOeahOi3r+W+hO+8jOWmgu+8miB1c2VyLmZpcnN0TmFtZSB8IG5hbWUg562JXHJcbiAgICAgKiBkYXRhOiDojrflj5blrZfmrrXnmoTmlbDmja7mupDvvIzkuIDoiKzkuLpKU09O5a+56LGhXHJcbiAgICAgKiBzYWZlOiDkuLp0cnVlLCDlsIZodG1s5a2X56ym6L+b6KGM6L2s56CB6L6T5Ye677yM6buY6K6k5Li6IGZhbHNlXHJcbiAgICAgKi9cclxuICAgIGdldFZhbHVlKGZpZWxkOiBzdHJpbmcsIGRhdGE6IGFueSwgc2FmZSA9IGZhbHNlKSB7XHJcbiAgICAgICAgaWYgKCFkYXRhKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAgJyc7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGxldCByZXN1bHRWYWwgPSAnJztcclxuICAgICAgICBpZiAoZmllbGQuaW5kZXhPZignLicpID09PSAtMSAmJiBkYXRhLmhhc093blByb3BlcnR5KGZpZWxkKSkge1xyXG4gICAgICAgICAgICByZXN1bHRWYWwgPSBkYXRhW2ZpZWxkXTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZXN1bHRWYWwgPSBmaWVsZC5zcGxpdCgnLicpLnJlZHVjZSgob2JqLCBrZXkpID0+IHtcclxuICAgICAgICAgICAgICAgIGlmIChvYmopIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gb2JqW2tleV07XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LCBkYXRhKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChzYWZlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmZvcm1hdHRlclZhbHVlKHJlc3VsdFZhbCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdFZhbDtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDmm7TmlrDmjIflrprlr7nosaHkuK3mn5DkuKrlrZfmrrXnmoTlgLxcclxuICAgICAqIEBwYXJhbSBvYmog6KKr5pu05paw5a+56LGhXHJcbiAgICAgKiBAcGFyYW0gZmllbGQg6KKr5pu05paw5a2X5q61XHJcbiAgICAgKiBAcGFyYW0gdmFsIOaWsOWAvFxyXG4gICAgICogQHBhcmFtIG5lc3Qg5piv5ZCm5Li65bWM5aWX77yM6buY6K6k5Li6IHRydWVcclxuICAgICAqL1xyXG4gICAgc2V0VmFsdWUob2JqOiB7IFtrZXk6IHN0cmluZ106IGFueSB9LCBmaWVsZDogc3RyaW5nLCB2YWw6IGFueSwgbmVzdCA9IHRydWUpIHtcclxuICAgICAgICBpZiAoZmllbGQpIHtcclxuICAgICAgICAgICAgaWYgKGZpZWxkLmluZGV4T2YoJy4nKSA+IC0xICYmIG5lc3QpIHtcclxuICAgICAgICAgICAgICAgIGxldCBsYXN0T2JqID0gbnVsbDtcclxuICAgICAgICAgICAgICAgIGNvbnN0IF9maWVsZHMgPSBmaWVsZC5zcGxpdCgnLicpO1xyXG4gICAgICAgICAgICAgICAgX2ZpZWxkcy5yZWR1Y2UoIChjLCBwKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgbGFzdE9iaiA9IGM7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNbcF07XHJcbiAgICAgICAgICAgICAgICB9LCBvYmopO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmIChsYXN0T2JqKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbGFzdE9ialtfZmllbGRzLnBvcCgpXSA9IHZhbDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIG9ialtmaWVsZF0gPSB2YWw7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0RW51bUl0ZW0odmFsdWU6IGFueSwgZW51bURhdGE6IGFueVtdLCB2YWx1ZUZpZWxkKSB7XHJcbiAgICAgICAgY29uc3QgaXRlbSA9IGVudW1EYXRhLmZpbmQobiA9PiBuW3ZhbHVlRmllbGRdID09IHZhbHVlKTtcclxuICAgICAgICByZXR1cm4gaXRlbTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIF9nZXRFbnVtVGl0bGVGcm9tQ29sdW1uKHZhbHVlOiBhbnksIGNvbDogYW55KSB7XHJcbiAgICAgICAgY29uc3QgX2NvbCA9IGNvbCBhcyBEYXRhQ29sdW1uO1xyXG4gICAgICAgIGNvbnN0IGZvcm1hdHRlciA9IF9jb2wuZm9ybWF0dGVyIGFzIENvbHVtbkZvcm1hdHRlcjtcclxuICAgICAgICBpZiAoZm9ybWF0dGVyICYmIHR5cGVvZiBmb3JtYXR0ZXIgPT09ICdvYmplY3QnKSB7XHJcbiAgICAgICAgICAgIGlmIChmb3JtYXR0ZXIudHlwZSA9PT0gJ2VudW0nICYmIGZvcm1hdHRlci5vcHRpb25zKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5nZXRFbnVtVGl0bGVGcm9tQ29sdW1uT3B0aW9ucyh2YWx1ZSwgZm9ybWF0dGVyLm9wdGlvbnMpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB2YWx1ZTtcclxuICAgIH1cclxuXHJcbiAgICBnZXRFbnVtVGl0bGUoY29sOiBEYXRhQ29sdW1uLCBkYXRhOiBhbnkgKSB7XHJcbiAgICAgICAgY29uc3QgdmFsID0gdGhpcy5nZXRWYWx1ZShjb2wuZmllbGQsIGRhdGEpO1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9nZXRFbnVtVGl0bGVGcm9tQ29sdW1uKHZhbCwgY29sKTtcclxuICAgIH1cclxuXHJcbiAgICBnZXRFbnVtVGl0bGVGcm9tQ29sdW1uT3B0aW9ucyh2YWx1ZTogYW55LCBvcHRzOiBhbnkpIHtcclxuICAgICAgICBjb25zdCB7IGRhdGEsIHZhbHVlRmllbGQsIHRleHRGaWVsZCB9ID0gb3B0cztcclxuICAgICAgICBjb25zdCBpdGVtID0gdGhpcy5nZXRFbnVtSXRlbSh2YWx1ZSwgZGF0YSwgdmFsdWVGaWVsZCk7XHJcbiAgICAgICAgaWYgKGl0ZW0pIHtcclxuICAgICAgICAgICAgcmV0dXJuIGl0ZW1bdGV4dEZpZWxkXTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gdmFsdWU7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGVzY2FwZUh0bWwoc3RyKSB7XHJcbiAgICAgICAgaWYgKHN0ciA9PT0gbnVsbCB8fCBzdHIgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICByZXR1cm4gICcnO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gc3RyXHJcbiAgICAgICAgLnJlcGxhY2UoLyYvZywgJyZhbXA7JylcclxuICAgICAgICAucmVwbGFjZSgvPC9nLCAnJmx0OycpXHJcbiAgICAgICAgLnJlcGxhY2UoLz4vZywgJyZndDsnKVxyXG4gICAgICAgIC5yZXBsYWNlKC9cXFwiL2csICcmcXVvdDsnKVxyXG4gICAgICAgIC5yZXBsYWNlKC9cXCcvZywgJyYjMzk7JylcclxuICAgICAgICAucmVwbGFjZSgvXFwvL2csICcmI3gyRjsnKTtcclxuICAgIH1cclxuXHJcbiAgICB1bmVzY2FwZUh0bWwoc3RyKSB7XHJcbiAgICAgICAgaWYgKHN0ciA9PT0gbnVsbCB8fCBzdHIgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICByZXR1cm4gICcnO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gc3RyXHJcbiAgICAgICAgLnJlcGxhY2UoLyZhbXA7L2csICcmJylcclxuICAgICAgICAucmVwbGFjZSgvJmx0Oy9nLCAnPCcpXHJcbiAgICAgICAgLnJlcGxhY2UoLyZndDsvZywgJz4nKVxyXG4gICAgICAgIC5yZXBsYWNlKC8mcXVvdDsvZywgJ1wiJylcclxuICAgICAgICAucmVwbGFjZSgvJiMzOTsvZywgJ1xcJycpXHJcbiAgICAgICAgLnJlcGxhY2UoLyYjeDJGOy9nLCAnLycpO1xyXG4gICAgfVxyXG5cclxuXHJcbiAgICBwcml2YXRlIGZvcm1hdHRlclZhbHVlKHZhbDogYW55KSB7XHJcbiAgICAgICAgaWYgKHZhbCA9PT0gbnVsbCB8fCB2YWwgPT09IHVuZGVmaW5lZCB8fCB2YWwgPT09ICcnKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAnJztcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICh0eXBlb2YgdmFsID09PSAnc3RyaW5nJykge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5lc2NhcGVIdG1sKHZhbCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gdmFsO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKiDojrflj5blrZfnrKbkuLLlnKjpobXpnaLkuK3nmoTnnJ/lrp7lrr3luqYgKi9cclxuICAgIGdldFRleHRXaWR0aCh0eHQ6IHN0cmluZywgZm9udCkge1xyXG4gICAgICAgIC8vIGNvbnN0IGZyYWcgPSBkb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7XHJcbiAgICAgICAgY29uc3QgY2FudmFzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnY2FudmFzJyk7XHJcbiAgICAgICAgY29uc3QgY29udGV4dCA9IGNhbnZhcy5nZXRDb250ZXh0KCcyZCcpO1xyXG4gICAgICAgIGNvbnRleHQuZm9udCA9IGZvbnQ7XHJcbiAgICAgICAgY29uc3QgbWV0cmljcyA9IGNvbnRleHQubWVhc3VyZVRleHQodHh0KTtcclxuICAgICAgICByZXR1cm4gTWF0aC5yb3VuZChtZXRyaWNzLndpZHRoKTtcclxuICAgIH1cclxuXHJcbiAgICByZW1vdmVTdHlsZVNoZWV0KGlkOiBzdHJpbmcpIHtcclxuICAgICAgICBjb25zdCBzdHlsZUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjJyArIGlkKTtcclxuICAgICAgICBpZiAoc3R5bGVFbGVtZW50KSB7XHJcbiAgICAgICAgICAgIHN0eWxlRWxlbWVudC5yZW1vdmUoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgY3JlYXRlU3R5bGVTaGVldChzdHlsZVNoZWV0SWQ6IHN0cmluZyk6IEhUTUxTdHlsZUVsZW1lbnQge1xyXG4gICAgICAgIGNvbnN0IGh0bWxIZWFkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignaGVhZCcpO1xyXG5cclxuICAgICAgICBjb25zdCBzdHlsZUVsZUlkID0gc3R5bGVTaGVldElkO1xyXG4gICAgICAgIGxldCBzdHlsZUVsZW1lbnQgPSBudWxsO1xyXG4gICAgICAgIGlmIChkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjJyArIHN0eWxlRWxlSWQpKSB7XHJcbiAgICAgICAgICAgIHN0eWxlRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyMnICsgc3R5bGVFbGVJZCk7XHJcbiAgICAgICAgICAgIHN0eWxlRWxlbWVudC5pbm5lclRleHQgPSAnJztcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBzdHlsZUVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzdHlsZScpO1xyXG4gICAgICAgICAgICBzdHlsZUVsZW1lbnQuaWQgPSBzdHlsZUVsZUlkO1xyXG4gICAgICAgICAgICBodG1sSGVhZC5hcHBlbmRDaGlsZChzdHlsZUVsZW1lbnQpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHN0eWxlRWxlbWVudDtcclxuICAgIH1cclxuXHJcbiAgICBnZXRTdHlsZVNoZWV0KHN0eWxlU2hlZXRJZCkge1xyXG4gICAgICAgIGNvbnN0IHN0eWxlU2hlZXRzID0gZG9jdW1lbnQuc3R5bGVTaGVldHMgYXMgYW55O1xyXG4gICAgICAgIGxldCBzdHlsZVNoZWV0ID0gbnVsbDtcclxuICAgICAgICBmb3IgKGNvbnN0IHN0eWxlc2hlZXQgb2Ygc3R5bGVTaGVldHMpIHtcclxuICAgICAgICAgICAgaWYgKChzdHlsZXNoZWV0Lm93bmVyTm9kZSB8fCBzdHlsZXNoZWV0Wydvd25pbmdFbGVtZW50J10pLmlkID09PSBzdHlsZVNoZWV0SWQpIHtcclxuICAgICAgICAgICAgICAgIHN0eWxlU2hlZXQgPSBzdHlsZXNoZWV0O1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBzdHlsZVNoZWV0O1xyXG4gICAgfVxyXG5cclxuICAgIC8qKiDkuI7njrDmnInmoLflvI/lkIjlubYgKi9cclxuICAgIGFwcGVuZENzc1J1bGVzKHJ1bGVzOiBzdHJpbmdbXSwgc3R5bGVTaGVldCkge1xyXG4gICAgICAgIGZvciAoY29uc3QgcnVsZSBvZiBydWxlcykge1xyXG4gICAgICAgICAgICBjb25zdCBydWxlTmFtZSA9IHJ1bGUuc2xpY2UoMCwgcnVsZS5pbmRleE9mKCd7JykpO1xyXG4gICAgICAgICAgICBjb25zdCByZW1vdmVkQ3NzUnVsZSA9IHRoaXMucmVtb3ZlQ3NzUnVsZShydWxlTmFtZSwgc3R5bGVTaGVldCk7XHJcbiAgICAgICAgICAgIGxldCBjc3NUZXh0ID0gJyc7XHJcbiAgICAgICAgICAgIGlmIChyZW1vdmVkQ3NzUnVsZSkge1xyXG4gICAgICAgICAgICAgICAgY3NzVGV4dCArPSByZW1vdmVkQ3NzUnVsZS5jc3NUZXh0LnNsaWNlKHJlbW92ZWRDc3NSdWxlLmNzc1RleHQuaW5kZXhPZigneycpICsgMSwgcmVtb3ZlZENzc1J1bGUuY3NzVGV4dC5pbmRleE9mKCd9JykpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNzc1RleHQgKz0gcnVsZS5zbGljZShydWxlLmluZGV4T2YoJ3snKSArIDEsIHJ1bGUuaW5kZXhPZignfScpKS5yZXBsYWNlKC9cIi9nLCAnJykucmVwbGFjZSgvLC9nLCAnOycpICsgJzsnO1xyXG4gICAgICAgICAgICBpZiAoc3R5bGVTaGVldC5hZGRSdWxlKSB7XHJcbiAgICAgICAgICAgICAgICBzdHlsZVNoZWV0LmFkZFJ1bGUocnVsZU5hbWUsIGNzc1RleHQsIDApO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgX25ld1J1bGUgPSBgJHtydWxlTmFtZX17ICR7Y3NzVGV4dH0gfWA7XHJcbiAgICAgICAgICAgICAgICBzdHlsZVNoZWV0Lmluc2VydFJ1bGUoX25ld1J1bGUsIDApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8qKiDopobnm5bnjrDmnInnmoTmoLflvI8gKi9cclxuICAgIGFwcGVuZENzc1J1bGVzMihydWxlczogc3RyaW5nW10sIHN0eWxlU2hlZXQpIHtcclxuICAgICAgICBmb3IgKGNvbnN0IHJ1bGUgb2YgcnVsZXMpIHtcclxuICAgICAgICAgICAgY29uc3QgcnVsZU5hbWUgPSBydWxlLnNsaWNlKDAsIHJ1bGUuaW5kZXhPZigneycpKTtcclxuICAgICAgICAgICAgY29uc3QgcmVtb3ZlZENzc1J1bGUgPSB0aGlzLnJlbW92ZUNzc1J1bGUocnVsZU5hbWUsIHN0eWxlU2hlZXQpO1xyXG4gICAgICAgICAgICBjb25zdCBjc3NUZXh0ID0gcnVsZS5zbGljZShydWxlLmluZGV4T2YoJ3snKSArIDEsIHJ1bGUuaW5kZXhPZignfScpKS5yZXBsYWNlKC9cIi9nLCAnJykucmVwbGFjZSgvLC9nLCAnOycpICsgJzsnO1xyXG4gICAgICAgICAgICBpZiAoc3R5bGVTaGVldC5hZGRSdWxlKSB7XHJcbiAgICAgICAgICAgICAgICBzdHlsZVNoZWV0LmFkZFJ1bGUocnVsZU5hbWUsIGNzc1RleHQsIDApO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgX25ld1J1bGUgPSBgJHtydWxlTmFtZX17ICR7Y3NzVGV4dH0gfWA7XHJcbiAgICAgICAgICAgICAgICBzdHlsZVNoZWV0Lmluc2VydFJ1bGUoX25ld1J1bGUsIDApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGdldENzc1J1bGUocnVsZU5hbWU6IHN0cmluZywgc3R5bGVTaGVldCkge1xyXG4gICAgICAgIGNvbnN0IGNzc1J1bGVzID0gKHN0eWxlU2hlZXQuY3NzUnVsZXMgfHwgc3R5bGVTaGVldC5ydWxlcykgYXMgYW55O1xyXG4gICAgICAgIGxldCByID0gbnVsbDtcclxuICAgICAgICBmb3IgKGNvbnN0IHJ1bGUgb2YgY3NzUnVsZXMpIHtcclxuICAgICAgICAgICAgaWYgKHJ1bGUuc2VsZWN0b3JUZXh0ID09IHJ1bGVOYW1lKSB7XHJcbiAgICAgICAgICAgICAgICByID0gcnVsZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHI7XHJcbiAgICB9XHJcblxyXG4gICAgcmVtb3ZlQ3NzUnVsZShydWxlTmFtZTogc3RyaW5nLCBzdHlsZVNoZWV0ICkge1xyXG4gICAgICAgIGNvbnN0IGNzc1J1bGVzID0gKHN0eWxlU2hlZXQuY3NzUnVsZXMgfHwgc3R5bGVTaGVldC5ydWxlcykgYXMgYW55O1xyXG4gICAgICAgIGxldCBpaSA9IDA7XHJcbiAgICAgICAgbGV0IGNzc1J1bGU6IGFueSA9IGZhbHNlO1xyXG4gICAgICAgIGRvIHtcclxuICAgICAgICAgICAgY3NzUnVsZSA9IGNzc1J1bGVzW2lpXTtcclxuICAgICAgICAgICAgaWYgKGNzc1J1bGUpIHtcclxuICAgICAgICAgICAgICAgIGlmIChjc3NSdWxlLnNlbGVjdG9yVGV4dC50b0xvd2VyQ2FzZSgpID09IHJ1bGVOYW1lLnRvTG93ZXJDYXNlKCkpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoc3R5bGVTaGVldC5jc3NSdWxlcykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzdHlsZVNoZWV0LmRlbGV0ZVJ1bGUoaWkpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlU2hlZXQucmVtb3ZlUnVsZShpaSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gY3NzUnVsZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpaSsrO1xyXG4gICAgICAgIH0gd2hpbGUgKGNzc1J1bGUpO1xyXG4gICAgfVxyXG5cclxuICAgIGlzTnVsbE9yVW5kZWZpbmVkKHZhbDogYW55KSB7XHJcbiAgICAgICAgcmV0dXJuIHZhbCA9PT0gbnVsbCB8fCB2YWwgPT09IHVuZGVmaW5lZDtcclxuICAgIH1cclxuXHJcbiAgICBpc0lFKCkge1xyXG4gICAgICAgIGNvbnN0IHVBID0gd2luZG93Lm5hdmlnYXRvci51c2VyQWdlbnQ7XHJcbiAgICAgICAgcmV0dXJuIC9tc2llXFxzfHRyaWRlbnRcXC98ZWRnZVxcLy9pLnRlc3QodUEpICYmICEhKCd1bmlxdWVJRCcgaW4gZG9jdW1lbnQgfHwgJ2RvY3VtZW50TW9kZScgaW4gZG9jdW1lbnQgfHwgKCdBY3RpdmVYT2JqZWN0JyBpbiB3aW5kb3cpIHx8ICdNU0lucHV0TWV0aG9kQ29udGV4dCcgaW4gd2luZG93KTtcclxuICAgIH1cclxuXHJcbiAgICBidWlsZFNvcnRTdHJpbmcoc29ydHM6IGFueVtdKTogc3RyaW5nIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5jZnMuYnVpbGRTb3J0U3RyaW5nKHNvcnRzKTtcclxuICAgIH1cclxuXHJcbiAgICBidWlsZFNxbFdoZXJlKGNvbmRpdGlvbnM6IGFueVtdKTogc3RyaW5nIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5jZnMuYnVpbGRTcWxXaGVyZShjb25kaXRpb25zKTtcclxuICAgIH1cclxuXHJcbiAgICBnZXRCcm93c2VyVHlwZSgpIHtcclxuICAgICAgICBjb25zdCB1YSA9IG5hdmlnYXRvci51c2VyQWdlbnQudG9Mb3dlckNhc2UoKTsgIC8vIOiOt+WPlueUqOaIt+err+S/oeaBr1xyXG4gICAgICAgIGNvbnN0IGluZm8gPSB7XHJcbiAgICAgICAgICAgIGllIDogL21zaWUvIC50ZXN0KHVhKSAmJiAhL29wZXJhLyAudGVzdCh1YSksICAvLyAg5Yy56YWNSUXmtY/op4jlmahcclxuICAgICAgICAgICAgb3AgOiAvb3BlcmEvIC50ZXN0KHVhKSwgIC8vICDljLnphY1PcGVyYea1j+iniOWZqFxyXG4gICAgICAgICAgICBzYSA6IC92ZXJzaW9uLipzYWZhcmkvLnRlc3QodWEpLCAgLy8g5Yy56YWNU2FmYXJp5rWP6KeI5ZmoXHJcbiAgICAgICAgICAgIGNoIDogL2Nocm9tZS8udGVzdCh1YSksICAvLyAg5Yy56YWNQ2hyb21l5rWP6KeI5ZmoXHJcbiAgICAgICAgICAgIGZmIDogL2dlY2tvLy50ZXN0KHVhKSAmJiAhL3dlYmtpdC8udGVzdCh1YSkgIC8vIOWMuemFjUZpcmVmb3jmtY/op4jlmahcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICByZXR1cm4gaW5mbztcclxuICAgIH1cclxuXHJcblxyXG4gICAgZ2V0RkZWZXIoKSB7XHJcbiAgICAgICAgY29uc3QgdWEgPSBuYXZpZ2F0b3IudXNlckFnZW50O1xyXG4gICAgICAgIGNvbnN0IGIgPSB1YS5pbmRleE9mKCdGaXJlZm94LycpO1xyXG4gICAgICAgIGlmIChiIDwgMCkge1xyXG4gICAgICAgICAgICByZXR1cm4gMDtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHBhcnNlRmxvYXQgKHVhLnN1YnN0cmluZyhiICsgOCwgdWEubGFzdEluZGV4T2YoJ1xcLicpKSk7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0UXVlcnlTdHJpbmcobmFtZSwgbG9jYXRpb25TZWFyY2ggPSAnJykge1xyXG4gICAgICAgIHZhciByZWcgPSBuZXcgUmVnRXhwKFwiKF58JilcIiArIG5hbWUgKyBcIj0oW14mXSopKCZ8JClcIiwgXCJpXCIpO1xyXG4gICAgICAgIGxldCBfc2VhcmNoID0gd2luZG93LmxvY2F0aW9uLnNlYXJjaDtcclxuICAgICAgICBpZiAobG9jYXRpb25TZWFyY2gpIHtcclxuICAgICAgICAgICAgX3NlYXJjaCA9IGxvY2F0aW9uU2VhcmNoO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgciA9IF9zZWFyY2guc3Vic3RyaW5nKDEpLm1hdGNoKHJlZyk7XHJcbiAgICAgICAgaWYgKHIgIT0gbnVsbCkgcmV0dXJuIChyWzJdKTsgcmV0dXJuIG51bGw7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDojrflj5bpobXpnaLkuK1ib2R55LiL5omA5pyJ5YWD57Sg55qEekluZGV4LCDlubbov5Tlm57kuIvkuKrmta7lsYLnmoTmlrB6aW5kZXhcclxuICAgICAqL1xyXG4gICAgZ2V0RmxvYXRpbmdMYXllckluZGV4KHVwcGVyTGF5ZXJzID0gMSkge1xyXG5cclxuICAgICAgICBjb25zdCBzZWxlY3RvcnMgPSBbXHJcbiAgICAgICAgICAgICdib2R5Pi5mLWRhdGFncmlkLXNldHRpbmdzLXNpbXBsZS1ob3N0JyxcclxuICAgICAgICAgICAgJ2JvZHk+ZGl2JywgXHJcbiAgICAgICAgICAgICdib2R5PmZhcnJpcy1kaWFsb2c+LmZhcnJpcy1tb2RhbC5zaG93JyxcclxuICAgICAgICAgICAgJ2JvZHk+LmZhcnJpcy1tb2RhbC5zaG93JywgXHJcbiAgICAgICAgICAgICdib2R5PmZhcnJpcy1maWx0ZXItcGFuZWw+LmYtZmlsdGVyLXBhbmVsLXdyYXBwZXInLCBcclxuICAgICAgICAgICAgJ2JvZHkgLmYtc2lkZWJhci1zaG93Pi5mLXNpZGViYXItbWFpbicsXHJcbiAgICAgICAgICAgICdib2R5Pi5wb3BvdmVyLnNob3cnLFxyXG4gICAgICAgICAgICAnYm9keT5maWx0ZXItcm93LXBhbmVsPi5mLWRhdGFncmlkLWZpbHRlci1wYW5lbCcsXHJcbiAgICAgICAgICAgICdib2R5Pi5mLXNlY3Rpb24tbWF4aW1pemUnXHJcbiAgICAgICAgXTtcclxuXHJcbiAgICAgICAgY29uc3Qgb3ZlcmxheXMgPSBBcnJheS5mcm9tKGRvY3VtZW50LmJvZHkucXVlcnlTZWxlY3RvckFsbChzZWxlY3RvcnMuam9pbignLCcpKSkuZmlsdGVyKG4gPT4gbikubWFwKG4gPT4ge1xyXG4gICAgICAgICAgICBjb25zdCB7IGRpc3BsYXksIHpJbmRleCB9ID0gd2luZG93LmdldENvbXB1dGVkU3R5bGUobik7XHJcbiAgICAgICAgICAgIGlmIChkaXNwbGF5ID09PSAnbm9uZScpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiAwO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBwYXJzZUludCh6SW5kZXgsIDEwKTtcclxuICAgICAgICB9KS5maWx0ZXIobiA9PiBuKTtcclxuICAgICAgICBsZXQgbWF4WmluZGV4ID0gTWF0aC5tYXgoLi4ub3ZlcmxheXMpO1xyXG4gICAgICAgIGlmIChtYXhaaW5kZXggPCAxMDQwKSB7XHJcbiAgICAgICAgICAgIG1heFppbmRleCA9IDEwNDA7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBtYXhaaW5kZXggKyB1cHBlckxheWVycztcclxuICAgIH1cclxuXHJcbiAgICAvKiog54K55Ye7TuasoeWQju+8jOaJp+ihjGNhbGxiYWNrOyDpu5jorqTngrnlh7sxMOasoeWQjuaJp+ihjCAqL1xyXG4gICAgY2xpY2tDb250aW51aXR5KGNhbGxiYWNrOiAoKSA9PiB2b2lkLGNsaWNrVGF0Z2F0TnVtID0gMTApIHtcclxuXHJcbiAgICAgICAgaWYgKHRoaXNbJ2NsaWNrQ291bnROb3cnXSA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIHRoaXNbJ2NsaWNrQ291bnROb3cnXSA9IDA7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyDov57nu63ngrnlh7vmrKHmlbDlsI/kuo7mjIflrprmrKHmlbDml7ZcclxuICAgICAgICBpZiAodGhpc1snY2xpY2tDb3VudE5vdyddIDwgY2xpY2tUYXRnYXROdW0gLSAxKSB7XHJcbiAgICAgICAgICAgIC8vIOa4hemZpOWumuaXtuWZqFxyXG4gICAgICAgICAgICBpZiAodGhpc1snY2xpY2tUaW1lciddKSB7XHJcbiAgICAgICAgICAgICAgICBjbGVhclRpbWVvdXQodGhpc1snY2xpY2tUaW1lciddKTtcclxuICAgICAgICAgICAgICAgIHRoaXNbJ2NsaWNrVGltZXInXSA9IG51bGw7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy8g54K55Ye75qyh5pWwKzFcclxuICAgICAgICAgICAgdGhpc1snY2xpY2tDb3VudE5vdyddKys7XHJcbiAgICAgICAgICAgIC8vIOaJk+WNsOasoeaVsOaXpeW/l1xyXG4gICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhgY2xpY2tDb3VudE5vd2AsIHRoaXNbJ2NsaWNrQ291bnROb3cnXSlcclxuICAgICAgICAgICAgLy8g6K6+572u5a6a5pe25Zmo77yM5aSn5LqOMzAw5q+r56eS54K55Ye75LiN566X6L+e57ut54K55Ye7XHJcbiAgICAgICAgICAgIHRoaXNbJ2NsaWNrVGltZXInXSA9IHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgdGhpc1snY2xpY2tDb3VudE5vdyddID0gMDtcclxuICAgICAgICAgICAgfSwgMzAwKVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIC8vIOeCueWHu+asoeaVsCsx77yI5q2k5pe25bey5aSn5LqO562J5LqO5oyH5a6a54K55Ye75qyh5pWw77yJXHJcbiAgICAgICAgICAgIHRoaXNbJ2NsaWNrQ291bnROb3cnXSsrO1xyXG4gICAgICAgICAgICAvLyDmiZPljbDml6Xlv5dcclxuICAgICAgICAgICAgLy8gY29uc29sZS5sb2coYOi/nue7reeCueWHu+S6hiR7dGhpc1snY2xpY2tDb3VudE5vdyddfeasoWAsIGDlgZrngrnku4DkuYhgKVxyXG5cclxuICAgICAgICAgICAgaWYgKGNhbGxiYWNrKSB7XHJcbiAgICAgICAgICAgICAgICBjYWxsYmFjaygpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvLyDmuIXpmaTlrprml7blmahcclxuICAgICAgICAgICAgaWYgKHRoaXNbJ2NsaWNrVGltZXInXSkge1xyXG4gICAgICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHRoaXNbJ2NsaWNrVGltZXInXSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzWydjbGlja1RpbWVyJ10gPSBudWxsO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vIOeCueWHu+asoeaVsOW9kumbtu+8jOmHjeaWsOiuoeaVsFxyXG4gICAgICAgICAgICB0aGlzWydjbGlja0NvdW50Tm93J10gPSAwO1xyXG4gICAgXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICByZWdCb2R5S2V5ZG93bkV2ZW50KGVudGVyRm4/OiAoKSA9PiB2b2lkLCBlc2NGbj86ICgpID0+IHZvaWQpIHtcclxuICAgICAgICBjb25zdCBrZXlkb3duSGFuZGxlID0gKCRldmVudDogS2V5Ym9hcmRFdmVudCkgPT4ge1xyXG4gICAgICAgICAgICBpZiAoJGV2ZW50LmtleSAhPT0gJ0VzY2FwZScgJiYgJGV2ZW50LmtleSAhPT0gJ0VudGVyJykge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICRldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICAkZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XHJcblxyXG4gICAgICAgICAgICBpZiAoJGV2ZW50LmtleSA9PSAnRW50ZXInICYmIGVudGVyRm4pIHtcclxuICAgICAgICAgICAgICAgIC8vIOaJp+ihjOafpeivolxyXG4gICAgICAgICAgICAgICAgZW50ZXJGbigpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgZXNjRm4gJiYgZXNjRm4oKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBkb2N1bWVudC5ib2R5LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCBrZXlkb3duSGFuZGxlICwgdHJ1ZSk7XHJcbiAgICAgICAgcmV0dXJuICgpID0+IHtcclxuICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5yZW1vdmVFdmVudExpc3RlbmVyKCdrZXlkb3duJywga2V5ZG93bkhhbmRsZSwgdHJ1ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcbiJdfQ==