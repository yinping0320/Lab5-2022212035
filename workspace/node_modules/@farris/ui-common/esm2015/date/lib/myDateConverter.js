/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
export class MyDateConverter {
    constructor() {
        this.MONTHNAMES = 'January February March April May June July August September October November December'.split(' ');
        this.MONTHNAMES_LOOKUP = { 'jan': 1, 'feb': 2, 'mar': 3, 'apr': 4, 'may': 5, 'jun': 6, 'jul': 7, 'aug': 8, 'sep': 9, 'oct': 10, 'nov': 11, 'dec': 12 };
        /**
         * \@var {Array}  Abbreviated names for the months of the year
         */
        this.ABBR_MONTHNAMES = 'Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec'.split(' ');
        /**
         * \@var {Array}  Names for the days of the week from Sunday to Saturday
         */
        this.DAYNAMES = 'Sunday Monday Tuesday Wednesday Thursday Friday Saturday'.split(' ');
        this.DAYNAMES_LOOKUP = { 'sun': 0, 'mon': 1, 'tue': 2, 'wed': 3, 'thu': 4, 'fri': 5, 'sat': 6 };
        /**
         * \@var {Array}  Abbreviated names for the days of the week from Sunday to Saturday
         */
        this.ABBR_DAYNAMES = 'Sun Mon Tue Wed Thu Fri Sat'.split(' ');
        this.regexes = {
            YEAR: '[1-9]\\d{3}',
            MONTH: '1[0-2]|0?[1-9]',
            MONTH2: '1[0-2]|0[1-9]',
            MONTHNAME: 'jan|january|feb|february|mar|march|apr|april|may|jun|june|jul|july|aug|august|sep|september|oct|october|nov|november|dec|december',
            DAYNAME: 'mon|monday|tue|tuesday|wed|wednesday|thu|thursday|fri|friday|sat|saturday|sun|sunday',
            DAY: '3[01]|[12]\\d|0?[1-9]',
            DAY2: '3[01]|[12]\\d|0[1-9]',
            TIMEZONE: '[+-][01]\\d\\:?[0-5]\\d',
            H24: '[01]\\d|2[0-3]',
            MIN: '[0-5]\\d',
            SEC: '[0-5]\\d',
            MS: '\\d{3,}',
            H12: '0?[1-9]|1[012]',
            AMPM: 'am|pm',
            UNIT: 'year|month|week|day|hour|minute|second|millisecond'
        };
        this.patterns = [
            // 2010-03-15
            [
                'iso_8601',
                this.makePattern('^(_YEAR_)-(_MONTH_)-(_DAY_)$'),
                '$2/$3/$1'
            ],
            // 3-15-2010
            [
                'us',
                this.makePattern('^(_MONTH_)([\\/-])(_DAY_)\\2(_YEAR_)$'),
                '$1/$3/$4'
            ],
            // 15.03.2010
            [
                'world',
                this.makePattern('^(_DAY_)([\\/\\.])(_MONTH_)\\2(_YEAR_)$'),
                '$3/$1/$4'
            ],
            // 15-Mar-2010, 8 Dec 2011, "Thu, 8 Dec 2011"
            [
                'chicago',
                this.makePattern('^(?:(?:_DAYNAME_),? )?(_DAY_)([ -])(_MONTHNAME_)\\2(_YEAR_)$'),
                '$3 $1, $4'
            ],
            // "March 4, 2012", "Mar 4 2012", "Sun Mar 4 2012"
            [
                'conversational',
                this.makePattern('^(?:(?:_DAYNAME_),? )?(_MONTHNAME_) (_DAY_),? (_YEAR_)$'),
                '$1 $2, $3'
            ],
            // Tue Jun 22 17:47:27 +0000 2010
            [
                'month_day_time_year',
                this.makePattern('^(?:_DAYNAME_) (_MONTHNAME_) (_DAY_) ((?:_H24_)\\:(?:_MIN_)(?:\\:_SEC_)?) (_TIMEZONE_) (_YEAR_)$'),
                (/**
                 * @param {?} m
                 * @return {?}
                 */
                (m) => {
                    /** @type {?} */
                    const month = this.zeroPad(this.getMonthByName(m[1]), 2);
                    /** @type {?} */
                    const day = this.zeroPad(m[2], 2);
                    /** @type {?} */
                    const date = this.create(m[5] + '-' + month + '-' + day + 'T' + m[3] + m[4]);
                    if (isNaN(date)) {
                        return false;
                    }
                    return date;
                })
            ],
            // @123456789
            [
                'unix',
                /^@(-?\d+)$/,
                (/**
                 * @param {?} match
                 * @return {?}
                 */
                (match) => {
                    return this.create(parseInt(match[1], 10) * 1000);
                })
            ],
            // 24-hour time (This will help catch Date objects that are casted to a string)
            [
                '24_hour',
                this.makePattern('^(?:(.+?)(?: |T))?(_H24_)\\:(_MIN_)(?:\\:(_SEC_)(?:\\.(_MS_))?)? ?(?:GMT)?(_TIMEZONE_)?(?: \\([A-Z]+\\))?$'),
                (/**
                 * @param {?} match
                 * @return {?}
                 */
                (match) => {
                    /** @type {?} */
                    let d;
                    if (match[1]) {
                        d = this.create(match[1]);
                        if (isNaN(d)) {
                            return false;
                        }
                    }
                    else {
                        d = new Date();
                        d.setMilliseconds(0);
                    }
                    d.setHours(parseFloat(match[2]), parseFloat(match[3]), parseFloat(match[4] || 0));
                    if (match[5]) {
                        d.setMilliseconds(+String(match[5]).slice(0, 3));
                    }
                    if (match[6]) {
                        d.setUTCOffsetString(match[6]);
                    }
                    return d;
                })
            ],
            // 12-hour time
            [
                '12_hour',
                this.makePattern('^(?:(.+) )?(_H12_)(?:\\:(_MIN_)(?:\\:(_SEC_))?)? ?(_AMPM_)$'),
                (/**
                 * @param {?} match
                 * @return {?}
                 */
                (match) => {
                    /** @type {?} */
                    let d;
                    if (match[1]) {
                        d = this.create(match[1]);
                        if (isNaN(d)) {
                            return false;
                        }
                    }
                    else {
                        d = new Date();
                        d.setMilliseconds(0);
                    }
                    /** @type {?} */
                    let hour = parseFloat(match[2]);
                    hour = match[5].toLowerCase() == 'am' ? (hour == 12 ? 0 : hour) : (hour == 12 ? 12 : hour + 12);
                    d.setHours(hour, parseFloat(match[3] || 0), parseFloat(match[4] || 0));
                    return d;
                })
            ]
        ];
    }
    /**
     * @param {?} code
     * @return {?}
     */
    makePattern(code) {
        code = code.replace(/_([A-Z][A-Z0-9]+)_/g, (/**
         * @param {?} $0
         * @param {?} $1
         * @return {?}
         */
        ($0, $1) => {
            return this.regexes[$1];
        }));
        return new RegExp(code, 'i');
    }
    /**
     * @param {?} monthname
     * @return {?}
     */
    getMonthByName(monthname) {
        return this.MONTHNAMES_LOOKUP[String(monthname).slice(0, 3).toLowerCase()];
    }
    /**
     * @param {?} dayname
     * @return {?}
     */
    getWeekdayByName(dayname) {
        return this.DAYNAMES_LOOKUP[String(dayname).slice(0, 3).toLowerCase()];
    }
    /**
     * @private
     * @param {?} num
     * @param {?} digits
     * @return {?}
     */
    zeroPad(num, digits) {
        switch (digits - String(num).length) {
            case 2: return '00' + num;
            case 1: return '0' + num;
        }
        return num;
    }
    /**
     * @param {?} date
     * @return {?}
     */
    create(date) {
        // 0 arguments or date is undefined
        if (typeof date == 'undefined') {
            return Date.now();
        }
        // If the passed value is already a date object, return it
        if (date instanceof Date) {
            return date;
        }
        /** @type {?} */
        const a = arguments;
        switch (a.length) {
            case 1:
                // If the passed value is an integer, interpret it as ms past epoch
                if (Object.prototype.toString.call(date) == '[object Number]') {
                    return new Date(date);
                }
                // trim the date
                date = String(date).replace(/^\s*(.*)\s*$/, '$1');
                // normalize whitespace
                date = date.replace(/\s{2,}/g, ' ');
                if (date === '') {
                    return Date.now();
                }
                /** @type {?} */
                var i = 0;
                /** @type {?} */
                var pattern;
                /** @type {?} */
                var ms;
                /** @type {?} */
                var obj;
                /** @type {?} */
                var match;
                /** @type {?} */
                var regex;
                /** @type {?} */
                var fn;
                // try each of our patterns
                while ((pattern = this.patterns[i++])) {
                    if (typeof pattern[0] == 'string') {
                        // pattern[0] is the name of the pattern
                        regex = pattern[1];
                        fn = pattern[2];
                    }
                    else {
                        // backwards compatibility with version 3.1
                        regex = pattern[0];
                        fn = pattern[1];
                    }
                    if (!(match = date.match(regex))) {
                        continue;
                    }
                    if (typeof fn == 'function') {
                        obj = fn(match, date);
                        if (obj instanceof Date) {
                            return obj;
                        }
                    }
                    else {
                        // fn is not a function but a string replace command
                        ms = Date.parse(date.replace(regex, fn));
                        if (!isNaN(ms)) {
                            return new Date(ms);
                        }
                    }
                }
                return NaN;
            case 2: return new Date(a[0], a[1], 1);
            case 3: return new Date(a[0], a[1], a[2]);
            case 4: return new Date(a[0], a[1], a[2], a[3]);
            case 5: return new Date(a[0], a[1], a[2], a[3], a[4]);
            case 6: return new Date(a[0], a[1], a[2], a[3], a[4], a[5]);
            default: return new Date(a[0], a[1], a[2], a[3], a[4], a[5], a[6]);
        }
    }
}
if (false) {
    /**
     * @type {?}
     * @private
     */
    MyDateConverter.prototype.MONTHNAMES;
    /**
     * @type {?}
     * @private
     */
    MyDateConverter.prototype.MONTHNAMES_LOOKUP;
    /**
     * \@var {Array}  Abbreviated names for the months of the year
     * @type {?}
     * @private
     */
    MyDateConverter.prototype.ABBR_MONTHNAMES;
    /**
     * \@var {Array}  Names for the days of the week from Sunday to Saturday
     * @type {?}
     * @private
     */
    MyDateConverter.prototype.DAYNAMES;
    /**
     * @type {?}
     * @private
     */
    MyDateConverter.prototype.DAYNAMES_LOOKUP;
    /**
     * \@var {Array}  Abbreviated names for the days of the week from Sunday to Saturday
     * @type {?}
     * @private
     */
    MyDateConverter.prototype.ABBR_DAYNAMES;
    /** @type {?} */
    MyDateConverter.prototype.regexes;
    /** @type {?} */
    MyDateConverter.prototype.patterns;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibXlEYXRlQ29udmVydGVyLmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGZhcnJpcy91aS1jb21tb24vZGF0ZS8iLCJzb3VyY2VzIjpbImxpYi9teURhdGVDb252ZXJ0ZXIudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUFBLE1BQU0sT0FBTyxlQUFlO0lBQTVCO1FBQ1ksZUFBVSxHQUFHLHVGQUF1RixDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQztRQUNoSCxzQkFBaUIsR0FBRyxFQUFFLEtBQUssRUFBRSxDQUFDLEVBQUUsS0FBSyxFQUFFLENBQUMsRUFBRSxLQUFLLEVBQUUsQ0FBQyxFQUFFLEtBQUssRUFBRSxDQUFDLEVBQUUsS0FBSyxFQUFFLENBQUMsRUFBRSxLQUFLLEVBQUUsQ0FBQyxFQUFFLEtBQUssRUFBRSxDQUFDLEVBQUUsS0FBSyxFQUFFLENBQUMsRUFBRSxLQUFLLEVBQUUsQ0FBQyxFQUFFLEtBQUssRUFBRSxFQUFFLEVBQUUsS0FBSyxFQUFFLEVBQUUsRUFBRSxLQUFLLEVBQUUsRUFBRSxFQUFFLENBQUM7Ozs7UUFJbEosb0JBQWUsR0FBRyxpREFBaUQsQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLENBQUM7Ozs7UUFJL0UsYUFBUSxHQUFHLDBEQUEwRCxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQztRQUNqRixvQkFBZSxHQUFHLEVBQUUsS0FBSyxFQUFFLENBQUMsRUFBRSxLQUFLLEVBQUUsQ0FBQyxFQUFFLEtBQUssRUFBRSxDQUFDLEVBQUUsS0FBSyxFQUFFLENBQUMsRUFBRSxLQUFLLEVBQUUsQ0FBQyxFQUFFLEtBQUssRUFBRSxDQUFDLEVBQUUsS0FBSyxFQUFFLENBQUMsRUFBRSxDQUFDOzs7O1FBSTNGLGtCQUFhLEdBQUcsNkJBQTZCLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDO1FBQ2pFLFlBQU8sR0FBRztZQUNOLElBQUksRUFBRSxhQUFhO1lBQ25CLEtBQUssRUFBRSxnQkFBZ0I7WUFDdkIsTUFB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QUNKO2lCQUNKO2dCQUNELE9BQU8sR0FBRyxDQUFDO1lBQ2YsS0FBSyxDQUFDLENBQUMsQ0FBQyxPQUFPLElBQUksSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUM7WUFDdkMsS0FBSyxDQUFDLENBQUMsQ0FBQyxPQUFPLElBQUksSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDMUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxPQUFPLElBQUksSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBQ2hELEtBQUssQ0FBQyxDQUFDLENBQUMsT0FBTyxJQUFJLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDdEQsS0FBSyxDQUFDLENBQUMsQ0FBQyxPQUFPLElBQUksSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDNUQsT0FBTyxDQUFDLENBQUMsT0FBTyxJQUFJLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztTQUN0RTtJQUNMLENBQUM7Q0FDSjs7Ozs7O0lBbE9HLHFDQUF3SDs7Ozs7SUFDeEgsNENBQTBKOzs7Ozs7SUFJMUosMENBQXVGOzs7Ozs7SUFJdkYsbUNBQXlGOzs7OztJQUN6RiwwQ0FBbUc7Ozs7OztJQUluRyx3Q0FBaUU7O0lBQ2pFLGtDQWdCRTs7SUFFRixtQ0E0R0UiLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgY2xhc3MgTXlEYXRlQ29udmVydGVyIHtcclxuICAgIHByaXZhdGUgTU9OVEhOQU1FUyA9ICdKYW51YXJ5IEZlYnJ1YXJ5IE1hcmNoIEFwcmlsIE1heSBKdW5lIEp1bHkgQXVndXN0IFNlcHRlbWJlciBPY3RvYmVyIE5vdmVtYmVyIERlY2VtYmVyJy5zcGxpdCgnICcpO1xyXG4gICAgcHJpdmF0ZSBNT05USE5BTUVTX0xPT0tVUCA9IHsgJ2phbic6IDEsICdmZWInOiAyLCAnbWFyJzogMywgJ2Fwcic6IDQsICdtYXknOiA1LCAnanVuJzogNiwgJ2p1bCc6IDcsICdhdWcnOiA4LCAnc2VwJzogOSwgJ29jdCc6IDEwLCAnbm92JzogMTEsICdkZWMnOiAxMiB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBAdmFyIHtBcnJheX0gIEFiYnJldmlhdGVkIG5hbWVzIGZvciB0aGUgbW9udGhzIG9mIHRoZSB5ZWFyXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgQUJCUl9NT05USE5BTUVTID0gJ0phbiBGZWIgTWFyIEFwciBNYXkgSnVuIEp1bCBBdWcgU2VwIE9jdCBOb3YgRGVjJy5zcGxpdCgnICcpO1xyXG4gICAgLyoqXHJcbiAgICAgKiBAdmFyIHtBcnJheX0gIE5hbWVzIGZvciB0aGUgZGF5cyBvZiB0aGUgd2VlayBmcm9tIFN1bmRheSB0byBTYXR1cmRheVxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIERBWU5BTUVTID0gJ1N1bmRheSBNb25kYXkgVHVlc2RheSBXZWRuZXNkYXkgVGh1cnNkYXkgRnJpZGF5IFNhdHVyZGF5Jy5zcGxpdCgnICcpO1xyXG4gICAgcHJpdmF0ZSBEQVlOQU1FU19MT09LVVAgPSB7ICdzdW4nOiAwLCAnbW9uJzogMSwgJ3R1ZSc6IDIsICd3ZWQnOiAzLCAndGh1JzogNCwgJ2ZyaSc6IDUsICdzYXQnOiA2IH07XHJcbiAgICAvKipcclxuICAgICAqIEB2YXIge0FycmF5fSAgQWJicmV2aWF0ZWQgbmFtZXMgZm9yIHRoZSBkYXlzIG9mIHRoZSB3ZWVrIGZyb20gU3VuZGF5IHRvIFNhdHVyZGF5XHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgQUJCUl9EQVlOQU1FUyA9ICdTdW4gTW9uIFR1ZSBXZWQgVGh1IEZyaSBTYXQnLnNwbGl0KCcgJyk7XHJcbiAgICByZWdleGVzID0ge1xyXG4gICAgICAgIFlFQVI6ICdbMS05XVxcXFxkezN9JyxcclxuICAgICAgICBNT05USDogJzFbMC0yXXwwP1sxLTldJyxcclxuICAgICAgICBNT05USDI6ICcxWzAtMl18MFsxLTldJyxcclxuICAgICAgICBNT05USE5BTUU6ICdqYW58amFudWFyeXxmZWJ8ZmVicnVhcnl8bWFyfG1hcmNofGFwcnxhcHJpbHxtYXl8anVufGp1bmV8anVsfGp1bHl8YXVnfGF1Z3VzdHxzZXB8c2VwdGVtYmVyfG9jdHxvY3RvYmVyfG5vdnxub3ZlbWJlcnxkZWN8ZGVjZW1iZXInLFxyXG4gICAgICAgIERBWU5BTUU6ICdtb258bW9uZGF5fHR1ZXx0dWVzZGF5fHdlZHx3ZWRuZXNkYXl8dGh1fHRodXJzZGF5fGZyaXxmcmlkYXl8c2F0fHNhdHVyZGF5fHN1bnxzdW5kYXknLFxyXG4gICAgICAgIERBWTogJzNbMDFdfFsxMl1cXFxcZHwwP1sxLTldJyxcclxuICAgICAgICBEQVkyOiAnM1swMV18WzEyXVxcXFxkfDBbMS05XScsXHJcbiAgICAgICAgVElNRVpPTkU6ICdbKy1dWzAxXVxcXFxkXFxcXDo/WzAtNV1cXFxcZCcsXHJcbiAgICAgICAgSDI0OiAnWzAxXVxcXFxkfDJbMC0zXScsXHJcbiAgICAgICAgTUlOOiAnWzAtNV1cXFxcZCcsXHJcbiAgICAgICAgU0VDOiAnWzAtNV1cXFxcZCcsXHJcbiAgICAgICAgTVM6ICdcXFxcZHszLH0nLFxyXG4gICAgICAgIEgxMjogJzA/WzEtOV18MVswMTJdJyxcclxuICAgICAgICBBTVBNOiAnYW18cG0nLFxyXG4gICAgICAgIFVOSVQ6ICd5ZWFyfG1vbnRofHdlZWt8ZGF5fGhvdXJ8bWludXRlfHNlY29uZHxtaWxsaXNlY29uZCdcclxuICAgIH07XHJcblxyXG4gICAgcGF0dGVybnMgPSBbXHJcbiAgICAgICAgLy8gMjAxMC0wMy0xNVxyXG4gICAgICAgIFtcclxuICAgICAgICAgICAgJ2lzb184NjAxJyxcclxuICAgICAgICAgICAgdGhpcy5tYWtlUGF0dGVybignXihfWUVBUl8pLShfTU9OVEhfKS0oX0RBWV8pJCcpLFxyXG4gICAgICAgICAgICAnJDIvJDMvJDEnXHJcbiAgICAgICAgXSxcclxuXHJcbiAgICAgICAgLy8gMy0xNS0yMDEwXHJcbiAgICAgICAgW1xyXG4gICAgICAgICAgICAndXMnLFxyXG4gICAgICAgICAgICB0aGlzLm1ha2VQYXR0ZXJuKCdeKF9NT05USF8pKFtcXFxcLy1dKShfREFZXylcXFxcMihfWUVBUl8pJCcpLFxyXG4gICAgICAgICAgICAnJDEvJDMvJDQnXHJcbiAgICAgICAgXSxcclxuXHJcbiAgICAgICAgLy8gMTUuMDMuMjAxMFxyXG4gICAgICAgIFtcclxuICAgICAgICAgICAgJ3dvcmxkJyxcclxuICAgICAgICAgICAgdGhpcy5tYWtlUGF0dGVybignXihfREFZXykoW1xcXFwvXFxcXC5dKShfTU9OVEhfKVxcXFwyKF9ZRUFSXykkJyksXHJcbiAgICAgICAgICAgICckMy8kMS8kNCdcclxuICAgICAgICBdLFxyXG5cclxuICAgICAgICAvLyAxNS1NYXItMjAxMCwgOCBEZWMgMjAxMSwgXCJUaHUsIDggRGVjIDIwMTFcIlxyXG4gICAgICAgIFtcclxuICAgICAgICAgICAgJ2NoaWNhZ28nLFxyXG4gICAgICAgICAgICB0aGlzLm1ha2VQYXR0ZXJuKCdeKD86KD86X0RBWU5BTUVfKSw/ICk/KF9EQVlfKShbIC1dKShfTU9OVEhOQU1FXylcXFxcMihfWUVBUl8pJCcpLFxyXG4gICAgICAgICAgICAnJDMgJDEsICQ0J1xyXG4gICAgICAgIF0sXHJcblxyXG4gICAgICAgIC8vIFwiTWFyY2ggNCwgMjAxMlwiLCBcIk1hciA0IDIwMTJcIiwgXCJTdW4gTWFyIDQgMjAxMlwiXHJcbiAgICAgICAgW1xyXG4gICAgICAgICAgICAnY29udmVyc2F0aW9uYWwnLFxyXG4gICAgICAgICAgICB0aGlzLm1ha2VQYXR0ZXJuKCdeKD86KD86X0RBWU5BTUVfKSw/ICk/KF9NT05USE5BTUVfKSAoX0RBWV8pLD8gKF9ZRUFSXykkJyksXHJcbiAgICAgICAgICAgICckMSAkMiwgJDMnXHJcbiAgICAgICAgXSxcclxuXHJcbiAgICAgICAgLy8gVHVlIEp1biAyMiAxNzo0NzoyNyArMDAwMCAyMDEwXHJcbiAgICAgICAgW1xyXG4gICAgICAgICAgICAnbW9udGhfZGF5X3RpbWVfeWVhcicsXHJcbiAgICAgICAgICAgIHRoaXMubWFrZVBhdHRlcm4oJ14oPzpfREFZTkFNRV8pIChfTU9OVEhOQU1FXykgKF9EQVlfKSAoKD86X0gyNF8pXFxcXDooPzpfTUlOXykoPzpcXFxcOl9TRUNfKT8pIChfVElNRVpPTkVfKSAoX1lFQVJfKSQnKSxcclxuICAgICAgICAgICAgKG0pID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG1vbnRoID0gdGhpcy56ZXJvUGFkKHRoaXMuZ2V0TW9udGhCeU5hbWUobVsxXSksIDIpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZGF5ID0gdGhpcy56ZXJvUGFkKG1bMl0sIDIpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZGF0ZTogYW55ID0gdGhpcy5jcmVhdGUobVs1XSArICctJyArIG1vbnRoICsgJy0nICsgZGF5ICsgJ1QnICsgbVszXSArIG1bNF0pO1xyXG4gICAgICAgICAgICAgICAgaWYgKGlzTmFOKGRhdGUpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGRhdGU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICBdLFxyXG5cclxuICAgICAgICAvLyBAMTIzNDU2Nzg5XHJcbiAgICAgICAgW1xyXG4gICAgICAgICAgICAndW5peCcsXHJcbiAgICAgICAgICAgIC9eQCgtP1xcZCspJC8sXHJcbiAgICAgICAgICAgIChtYXRjaCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuY3JlYXRlKHBhcnNlSW50KG1hdGNoWzFdLCAxMCkgKiAxMDAwKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIF0sXHJcblxyXG4gICAgICAgIC8vIDI0LWhvdXIgdGltZSAoVGhpcyB3aWxsIGhlbHAgY2F0Y2ggRGF0ZSBvYmplY3RzIHRoYXQgYXJlIGNhc3RlZCB0byBhIHN0cmluZylcclxuICAgICAgICBbXHJcbiAgICAgICAgICAgICcyNF9ob3VyJyxcclxuICAgICAgICAgICAgdGhpcy5tYWtlUGF0dGVybignXig/OiguKz8pKD86IHxUKSk/KF9IMjRfKVxcXFw6KF9NSU5fKSg/OlxcXFw6KF9TRUNfKSg/OlxcXFwuKF9NU18pKT8pPyA/KD86R01UKT8oX1RJTUVaT05FXyk/KD86IFxcXFwoW0EtWl0rXFxcXCkpPyQnKSxcclxuICAgICAgICAgICAgKG1hdGNoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBsZXQgZDtcclxuICAgICAgICAgICAgICAgIGlmIChtYXRjaFsxXSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGQgPSB0aGlzLmNyZWF0ZShtYXRjaFsxXSk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGlzTmFOKGQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGQgPSBuZXcgRGF0ZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIGQuc2V0TWlsbGlzZWNvbmRzKDApO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZC5zZXRIb3VycyhwYXJzZUZsb2F0KG1hdGNoWzJdKSwgcGFyc2VGbG9hdChtYXRjaFszXSksIHBhcnNlRmxvYXQobWF0Y2hbNF0gfHwgMCkpO1xyXG4gICAgICAgICAgICAgICAgaWYgKG1hdGNoWzVdKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZC5zZXRNaWxsaXNlY29uZHMoK1N0cmluZyhtYXRjaFs1XSkuc2xpY2UoMCwgMykpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKG1hdGNoWzZdKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZC5zZXRVVENPZmZzZXRTdHJpbmcobWF0Y2hbNl0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICBdLFxyXG5cclxuICAgICAgICAvLyAxMi1ob3VyIHRpbWVcclxuICAgICAgICBbXHJcbiAgICAgICAgICAgICcxMl9ob3VyJyxcclxuICAgICAgICAgICAgdGhpcy5tYWtlUGF0dGVybignXig/OiguKykgKT8oX0gxMl8pKD86XFxcXDooX01JTl8pKD86XFxcXDooX1NFQ18pKT8pPyA/KF9BTVBNXykkJyksXHJcbiAgICAgICAgICAgIChtYXRjaCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgbGV0IGQ7XHJcbiAgICAgICAgICAgICAgICBpZiAobWF0Y2hbMV0pIHtcclxuICAgICAgICAgICAgICAgICAgICBkID0gdGhpcy5jcmVhdGUobWF0Y2hbMV0pO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChpc05hTihkKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBkID0gbmV3IERhdGUoKTtcclxuICAgICAgICAgICAgICAgICAgICBkLnNldE1pbGxpc2Vjb25kcygwKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGxldCBob3VyID0gcGFyc2VGbG9hdChtYXRjaFsyXSk7XHJcbiAgICAgICAgICAgICAgICBob3VyID0gbWF0Y2hbNV0udG9Mb3dlckNhc2UoKSA9PSAnYW0nID8gKGhvdXIgPT0gMTIgPyAwIDogaG91cikgOiAoaG91ciA9PSAxMiA/IDEyIDogaG91ciArIDEyKTtcclxuICAgICAgICAgICAgICAgIGQuc2V0SG91cnMoaG91ciwgcGFyc2VGbG9hdChtYXRjaFszXSB8fCAwKSwgcGFyc2VGbG9hdChtYXRjaFs0XSB8fCAwKSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIF1cclxuXHJcbiAgICBdO1xyXG5cclxuICAgIG1ha2VQYXR0ZXJuKGNvZGUpIHtcclxuICAgICAgICBjb2RlID0gY29kZS5yZXBsYWNlKC9fKFtBLVpdW0EtWjAtOV0rKV8vZywgKCQwLCAkMSkgPT4ge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5yZWdleGVzWyQxXTtcclxuICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4gbmV3IFJlZ0V4cChjb2RlLCAnaScpO1xyXG4gICAgfVxyXG5cclxuICAgIGdldE1vbnRoQnlOYW1lKG1vbnRobmFtZSkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLk1PTlRITkFNRVNfTE9PS1VQW1N0cmluZyhtb250aG5hbWUpLnNsaWNlKDAsIDMpLnRvTG93ZXJDYXNlKCldO1xyXG4gICAgfVxyXG5cclxuICAgIGdldFdlZWtkYXlCeU5hbWUoZGF5bmFtZSkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLkRBWU5BTUVTX0xPT0tVUFtTdHJpbmcoZGF5bmFtZSkuc2xpY2UoMCwgMykudG9Mb3dlckNhc2UoKV07XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSB6ZXJvUGFkKG51bSwgZGlnaXRzKSB7XHJcbiAgICAgICAgc3dpdGNoIChkaWdpdHMgLSBTdHJpbmcobnVtKS5sZW5ndGgpIHtcclxuICAgICAgICAgICAgY2FzZSAyOiByZXR1cm4gJzAwJyArIG51bTtcclxuICAgICAgICAgICAgY2FzZSAxOiByZXR1cm4gJzAnICsgbnVtO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gbnVtO1xyXG4gICAgfVxyXG5cclxuICAgIGNyZWF0ZShkYXRlKSB7XHJcbiAgICAgICAgLy8gMCBhcmd1bWVudHMgb3IgZGF0ZSBpcyB1bmRlZmluZWRcclxuICAgICAgICBpZiAodHlwZW9mIGRhdGUgPT0gJ3VuZGVmaW5lZCcpIHtcclxuICAgICAgICAgICAgcmV0dXJuIERhdGUubm93KCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIElmIHRoZSBwYXNzZWQgdmFsdWUgaXMgYWxyZWFkeSBhIGRhdGUgb2JqZWN0LCByZXR1cm4gaXRcclxuICAgICAgICBpZiAoZGF0ZSBpbnN0YW5jZW9mIERhdGUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGRhdGU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IGEgPSBhcmd1bWVudHM7XHJcbiAgICAgICAgc3dpdGNoIChhLmxlbmd0aCkge1xyXG4gICAgICAgICAgICBjYXNlIDE6XHJcbiAgICAgICAgICAgICAgICAvLyBJZiB0aGUgcGFzc2VkIHZhbHVlIGlzIGFuIGludGVnZXIsIGludGVycHJldCBpdCBhcyBtcyBwYXN0IGVwb2NoXHJcbiAgICAgICAgICAgICAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKGRhdGUpID09ICdbb2JqZWN0IE51bWJlcl0nKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBEYXRlKGRhdGUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgLy8gdHJpbSB0aGUgZGF0ZVxyXG4gICAgICAgICAgICAgICAgZGF0ZSA9IFN0cmluZyhkYXRlKS5yZXBsYWNlKC9eXFxzKiguKilcXHMqJC8sICckMScpO1xyXG4gICAgICAgICAgICAgICAgLy8gbm9ybWFsaXplIHdoaXRlc3BhY2VcclxuICAgICAgICAgICAgICAgIGRhdGUgPSBkYXRlLnJlcGxhY2UoL1xcc3syLH0vZywgJyAnKTtcclxuICAgICAgICAgICAgICAgIGlmIChkYXRlID09PSAnJykge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBEYXRlLm5vdygpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdmFyIGkgPSAwLCBwYXR0ZXJuLCBtcywgb2JqLCBtYXRjaCwgcmVnZXgsIGZuO1xyXG4gICAgICAgICAgICAgICAgLy8gdHJ5IGVhY2ggb2Ygb3VyIHBhdHRlcm5zXHJcbiAgICAgICAgICAgICAgICB3aGlsZSAoKHBhdHRlcm4gPSB0aGlzLnBhdHRlcm5zW2krK10pKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBwYXR0ZXJuWzBdID09ICdzdHJpbmcnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHBhdHRlcm5bMF0gaXMgdGhlIG5hbWUgb2YgdGhlIHBhdHRlcm5cclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVnZXggPSBwYXR0ZXJuWzFdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmbiA9IHBhdHRlcm5bMl07XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gYmFja3dhcmRzIGNvbXBhdGliaWxpdHkgd2l0aCB2ZXJzaW9uIDMuMVxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZWdleCA9IHBhdHRlcm5bMF07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZuID0gcGF0dGVyblsxXTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCEobWF0Y2ggPSBkYXRlLm1hdGNoKHJlZ2V4KSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgZm4gPT0gJ2Z1bmN0aW9uJykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBvYmogPSBmbihtYXRjaCwgZGF0ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvYmogaW5zdGFuY2VvZiBEYXRlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gb2JqO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gZm4gaXMgbm90IGEgZnVuY3Rpb24gYnV0IGEgc3RyaW5nIHJlcGxhY2UgY29tbWFuZFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBtcyA9IERhdGUucGFyc2UoZGF0ZS5yZXBsYWNlKHJlZ2V4LCBmbikpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWlzTmFOKG1zKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBEYXRlKG1zKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBOYU47XHJcbiAgICAgICAgICAgIGNhc2UgMjogcmV0dXJuIG5ldyBEYXRlKGFbMF0sIGFbMV0sIDEpO1xyXG4gICAgICAgICAgICBjYXNlIDM6IHJldHVybiBuZXcgRGF0ZShhWzBdLCBhWzFdLCBhWzJdKTtcclxuICAgICAgICAgICAgY2FzZSA0OiByZXR1cm4gbmV3IERhdGUoYVswXSwgYVsxXSwgYVsyXSwgYVszXSk7XHJcbiAgICAgICAgICAgIGNhc2UgNTogcmV0dXJuIG5ldyBEYXRlKGFbMF0sIGFbMV0sIGFbMl0sIGFbM10sIGFbNF0pO1xyXG4gICAgICAgICAgICBjYXNlIDY6IHJldHVybiBuZXcgRGF0ZShhWzBdLCBhWzFdLCBhWzJdLCBhWzNdLCBhWzRdLCBhWzVdKTtcclxuICAgICAgICAgICAgZGVmYXVsdDogcmV0dXJuIG5ldyBEYXRlKGFbMF0sIGFbMV0sIGFbMl0sIGFbM10sIGFbNF0sIGFbNV0sIGFbNl0pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG4iXX0=