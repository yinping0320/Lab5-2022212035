/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { EventEmitter } from '@angular/core';
import { Component, ElementRef, ChangeDetectorRef, Inject, Renderer2, Injector, Input, ViewChild, forwardRef, ViewEncapsulation, Output } from '@angular/core';
import { DOCUMENT } from '@angular/common';
import { take, debounceTime, delay } from 'rxjs/operators';
import { BaseComboComponent, ComboService } from '@farris/ui-combo-list';
import { NG_VALUE_ACCESSOR } from '@angular/forms';
import { LookupUtils } from '@farris/ui-lookup';
import { TreeTableComponent } from '@farris/ui-treetable';
import { DataTableComponent } from '@farris/ui-datatable';
import { Subject } from 'rxjs';
import { IdService } from '@farris/ui-common';
/** @type {?} */
const INPUT_COMBO_VALUE_ACCESSOR = {
    provide: NG_VALUE_ACCESSOR,
    // tslint:disable-next-line: no-use-before-declare
    useExisting: forwardRef((/**
     * @return {?}
     */
    () => ComboLookupComponent)),
    multi: true
};
export class ComboLookupComponent extends BaseComboComponent {
    /**
     * @param {?} el
     * @param {?} cdr
     * @param {?} document
     * @param {?} render
     * @param {?} comboService
     * @param {?} injector
     */
    constructor(el, cdr, document, render, comboService, injector) {
        super(el, cdr, document, render, comboService, injector);
        this.el = el;
        this.cdr = cdr;
        this.document = document;
        this.render = render;
        this.comboService = comboService;
        this.injector = injector;
        this.panelHeight = 300;
        this.comPosition = {
            'height.px': this.panelHeight
        };
        this.showHeader = true;
        this.useTreeView = false;
        /**
         * -1: 不展开； 0: 全部展开；>0: 展开到指定级数
         */
        this.expandLevel = -1;
        /**
         * 树表启用过滤行
         */
        this.enableFilterRow = false;
        this.cascade = {
            enable: false,
            up: false,
            down: false
        };
        /**
         * 树形帮助数据加载方式： default: 内置取数； loadall: 加载所有 layerload：分层加载
         */
        this.loadTreeDataType = 'default';
        /**
         * 启用构造完整树过滤
         */
        this.enableFullTree = true;
        this.pageChanged = new EventEmitter();
        this.pageSizeChanged = new EventEmitter();
        /**
         * 使用表单映射，默认 false
         */
        this.useFormDataMapping = false;
        this.loadFinish = false;
        this.pageInfo = { pageSize: 20, pageIndex: 1, total: 0 };
        this.tt$ = new Subject();
        this.loaded$ = new Subject();
        this._searchKeyWords = '';
        this.loadDataType = 'all';
        this.idSer = this.injector.get(IdService, null);
        if (!this.idSer) {
            this.idSer = new IdService();
        }
    }
    // 树列表默认展开层级。 -1： 不展开； 0： 全部展开； >0:  展开到指定级数；
    /**
     * @param {?} value
     * @return {?}
     */
    set columns(value) {
        this._columns = value;
    }
    /**
     * @return {?}
     */
    get columns() {
        /** @type {?} */
        let cols = this._columns !== undefined && this._columns.length > 0 ? this._columns : this.comboService.columns;
        if (this.useTreeView && cols.length > 1) {
            cols = cols.filter((/**
             * @param {?} n
             * @return {?}
             */
            n => n.field === this.textField));
        }
        return cols;
    }
    /**
     * @param {?} value
     * @return {?}
     */
    set pagination(value) {
        this._pagination = value;
    }
    /**
     * @return {?}
     */
    get pagination() {
        if (this._pagination !== undefined) {
            return this._pagination;
        }
        else {
            return this.comboService.pageInfo && this.pageInfo.enablePager ? this.pageInfo.enablePager : false;
        }
    }
    /**
     * @param {?} val
     * @return {?}
     */
    set displayType(val) {
        this.comboService.displayType = val + '';
    }
    /**
     * @return {?}
     */
    get displayType() {
        return this.comboService.displayType;
    }
    /**
     * @param {?} cmf
     * @return {?}
     */
    set treeCmpRef(cmf) {
        if (cmf) {
            cmf.cascadeCheck = this.cascade.enable;
            cmf.cascadeDown = this.cascade.down;
            cmf.cascadeUp = this.cascade.up;
            this.tt$.next(cmf);
        }
        this._treeCmpRef = cmf;
    }
    /**
     * @return {?}
     */
    get treeCmpRef() {
        return this._treeCmpRef;
    }
    /**
     * @param {?} cmf
     * @return {?}
     */
    set tableCmpRef(cmf) {
        if (cmf && this.pagination) {
            this.loaded$.pipe(take(1)).subscribe((/**
             * @param {?} e
             * @return {?}
             */
            e => {
                // console.log(this._tableCmpRef, cmf);
                cmf.loadData({
                    pageSize: this.pageInfo.pageSize,
                    total: this.pageInfo.total,
                    data: this.data,
                    pageIndex: this.pageInfo.pageIndex
                });
            }));
        }
        if (!this._tableCmpRef && this.loadFinish && cmf) {
            cmf.loadData({
                pageSize: this.pageInfo.pageSize,
                total: this.pageInfo.total,
                data: this.data,
                pageIndex: this.pageInfo.pageIndex
            });
        }
        this._tableCmpRef = cmf;
    }
    /**
     * @return {?}
     */
    ngOnInit() {
        super.ngOnInit();
        this.treeClientSearch.pipe(debounceTime(300)).subscribe((/**
         * @param {?} value
         * @return {?}
         */
        (value) => {
            if (!this.remoteSearch && this.treeCmpRef) {
                this.treeCmpRef.searchHandle.search(this.textField, value);
            }
        }));
        this.comboService.treeInfo$.subscribe((/**
         * @param {?} t
         * @return {?}
         */
        (t) => {
            if (t) {
                if (this.loadTreeDataType === 'default') {
                    this.loadDataType = t.loadDataType;
                }
                this.treeInfo = Object.assign(this.treeInfo || {}, t);
            }
        }));
    }
    /**
     * @protected
     * @param {?} selections
     * @return {?}
     */
    onSelectionsChange(selections) {
        if (this.displayType === 'LOOKUPLIST') {
            if (!this.multiSelect) {
                this.ownSelections = selections[0] ? selections[0] : {};
            }
            else {
                this.ownSelections = {};
                this.comboService.selections.forEach((/**
                 * @param {?} item
                 * @return {?}
                 */
                item => {
                    this.ownSelections[item[this.idField]] = item;
                }));
            }
            this.pageInfo = Object.assign({}, this.pageInfo, this.comboService.pageInfo);
            this.loadFinish = true;
            this.cdr.detectChanges();
            this.loaded$.next(this.pageInfo);
        }
        else {
            if (this.treeCmpRef) {
                this.initTreeData();
            }
            else {
                this.tt$.pipe(take(1)).subscribe((/**
                 * @param {?} cmf
                 * @return {?}
                 */
                (cmf) => {
                    this.treeCmpRef = cmf;
                    this.initTreeData();
                    // cmf.checkedNodes(ids, true, false);
                    // cmf.updateSerializedValue();
                }));
            }
        }
    }
    /**
     * @private
     * @param {?} nodes
     * @param {?} expandLayer
     * @return {?}
     */
    setTreeNodeExpandBy(nodes, expandLayer) {
        if (!nodes || !nodes.length) {
            return;
        }
        nodes.forEach((/**
         * @param {?} n
         * @return {?}
         */
        (n) => {
            /** @type {?} */
            const layer = n.data[this.treeInfo.dataField].layer;
            n.expanded = layer <= expandLayer ? true : n.expanded;
            if (n.children && n.children.length && layer + 1 <= expandLayer) {
                this.setTreeNodeExpandBy(n.children, expandLayer);
            }
        }));
    }
    /**
     * @private
     * @return {?}
     */
    initTreeData() {
        /** @type {?} */
        const __selections = this.comboService.selections.filter((/**
         * @param {?} n
         * @return {?}
         */
        n => n !== null && n !== undefined));
        /** @type {?} */
        const ids = [];
        this.ownSelections = __selections.map((/**
         * @param {?} item
         * @return {?}
         */
        item => {
            ids.push(item[this.idField]);
            return { data: item, id: item[this.idField] };
        }));
        this.treeCmpRef.selections = this.ownSelections;
        this.treeCmpRef.checkeds = this.ownSelections;
        if (this.expandLevel != -1 && this.loadDataType == 'all') {
            if (this.expandLevel > 0) {
                this.setTreeNodeExpandBy(this.treeCmpRef.data, this.expandLevel);
                this.treeCmpRef.updateSerializedValue();
            }
            else {
                this.treeCmpRef.expandAll();
            }
        }
        if (this.comboService.data && this.comboService.data.length) {
            if (this.treeCmpRef.checkValues && this.treeCmpRef.checkValues.length) {
                if (this.multiSelect) {
                    this.treeCmpRef.checkedNodes(this.treeCmpRef.checkValues);
                    this.treeCmpRef.selectNodes(this.treeCmpRef.checkValues);
                }
                else {
                    this.treeCmpRef.selectNodes(this.treeCmpRef.checkValues);
                }
            }
        }
    }
    /**
     * @private
     * @return {?}
     */
    isTree() {
        return this.displayType === 'LOOKUPTREELIST';
    }
    /**
     * @param {?=} clearMapFields
     * @return {?}
     */
    updateMappingFieldValue(clearMapFields = false) {
        if (this.ngControl && this.ngControl.formDirective &&
            this.ngControl.formDirective.form && this.ngControl.formDirective.form.bindingData) {
            /** @type {?} */
            const bindingData = this.ngControl.formDirective.form.bindingData;
            /** @type {?} */
            const bindingPath = this.ngControl.formDirective.form.bindingPath;
            /** @type {?} */
            let pathArr = [];
            if (bindingPath) {
                pathArr = bindingPath.split('/').filter((/**
                 * @param {?} n
                 * @return {?}
                 */
                n => n !== ''));
            }
            this.mappingField = this.mappingField ? this.mappingField : {};
            if (this.mapFields) {
                /** @type {?} */
                const helpFields = Object.keys(this.mapFields);
                helpFields.forEach((/**
                 * @param {?} f
                 * @return {?}
                 */
                (f) => {
                    /** @type {?} */
                    const fieldNames = this.mapFields[f] ? this.mapFields[f] : '';
                    /** @type {?} */
                    let value = '';
                    if (!clearMapFields) {
                        /** @type {?} */
                        const text = this.comboService.selections && this.comboService.selections.map((/**
                         * @param {?} item
                         * @return {?}
                         */
                        item => {
                            return this.comboService.getValueByObj(f, item);
                        })).filter((/**
                         * @param {?} n
                         * @return {?}
                         */
                        n => n !== null)).join(this.separator);
                        // value = text ? text : this.displayText ? this.displayText : '';
                        value = text || '';
                    }
                    if (fieldNames) {
                        fieldNames.split(',').forEach((/**
                         * @param {?} fieldName
                         * @return {?}
                         */
                        (fieldName) => {
                            /** @type {?} */
                            let _val = value;
                            if (this.nosearch && fieldName === this.ngControl.name) {
                                _val = this.displayText;
                            }
                            if (bindingData.setValue) {
                                if (!this.useFormDataMapping) {
                                    bindingData.setValue(pathArr.concat(fieldName.split('.')), _val, true, true);
                                }
                            }
                            else {
                                this.commonUtils.setValue(bindingData, fieldName, value);
                            }
                        }));
                    }
                }));
            }
        }
    }
    /**
     * @return {?}
     */
    updateSelectedValues() {
        if (this.ngControl &&
            this.ngControl.formDirective &&
            this.ngControl.formDirective.form &&
            this.ngControl.formDirective.form.bindingData) {
            /** @type {?} */
            const bindingData = this.ngControl.formDirective.form.bindingData;
            /** @type {?} */
            const bindingPath = this.ngControl.formDirective.form.bindingPath;
            /** @type {?} */
            let pathArr = [];
            if (bindingPath) {
                pathArr = bindingPath.split('/').filter((/**
                 * @param {?} n
                 * @return {?}
                 */
                n => n !== ''));
            }
            /** @type {?} */
            let targetField = this.mappingField ? this.mapFields[this.idField] : '';
            if (targetField && targetField.indexOf(',') > -1) {
                targetField = targetField.split(',')[0];
            }
            // this.mappingField = this.mappingField ? this.mappingField : '';
            if (targetField && bindingData.getValue) {
                this.selectedValues = bindingData.getValue(pathArr.concat(targetField.split('.'))) || '';
            }
            else if (targetField) {
                this.selectedValues = this.commonUtils.getValue(targetField, bindingData) || '';
            }
            else {
                // 兼容为设置idField 字段映射的情况，此情况使用 valueField
                targetField = this.mappingField ? this.mapFields[this.textField] : '';
                if (targetField && bindingData.getValue) {
                    this.comboService['__SELECTEDIDS__'] = this.comboService.getValue(this.idField);
                    this.selectedValues = bindingData.getValue(pathArr.concat(targetField.split('.'))) || '';
                }
            }
        }
        else {
            // UI state binding
            if (this.el.nativeElement['__zone_symbol__UIStateBindingChangefalse']) {
                // this.selectedValues = this.comboService.getValue(this.textField);
                this.selectedValues = this.displayText;
            }
        }
    }
    /**
     * @param {?} row
     * @return {?}
     */
    onSelectRows(row) {
        if (this.displayType === 'LOOKUPLIST') {
            const { data, index } = row;
            this.comboService.selectItem(data, index);
            this.selectChange.emit({ data, index, instance: this }); // UI-STATE-BINDING 中使用
        }
        else if (this.displayType === 'LOOKUPTREELIST') {
            const { node } = row;
            if (row.nodes) {
                this.comboService.selectItem(row.nodes.map((/**
                 * @param {?} n
                 * @return {?}
                 */
                n => n.data)));
            }
            else {
                this.comboService.selectItem(node.data);
            }
            this.selectChange.emit(node);
        }
        this.updateTextAndValues();
        if (!this.multiSelect) {
            this.comboService.isOpen$.next(false);
        }
    }
    /**
     * @param {?} row
     * @return {?}
     */
    onUnSelectRows(row) {
        if (this.displayType === 'LOOKUPLIST') {
            const { data } = row;
            this.comboService.unSelectItem(data);
        }
        else if (this.displayType === 'LOOKUPTREELIST') {
            const { node } = row;
            this.comboService.unSelectItem(node.data);
            this.selectChange.emit(node);
        }
        this.updateTextAndValues();
    }
    /**
     * @param {?} ev
     * @return {?}
     */
    onCheckAll(ev) {
        /** @type {?} */
        let state;
        /** @type {?} */
        let selections = [];
        if (this.displayType === 'LOOKUPTREELIST') {
            state = ev.checked;
            selections = this.treeCmpRef.state.rowNodes
                .filter((/**
             * @param {?} n
             * @return {?}
             */
            n => n.node.selectable === undefined || n.node.selectable))
                .map((/**
             * @param {?} r
             * @return {?}
             */
            r => r.node.data));
        }
        else {
            state = ev;
            selections = this.data;
        }
        if (state) {
            this.comboService.selectAll(selections);
        }
        else {
            this.comboService.unSelectAll(selections);
        }
        this.updateTextAndValues();
    }
    /**
     * @private
     * @return {?}
     */
    updateTextAndValues() {
        this.comboService['__SELECTEDIDS__'] = this.comboService.getValue(this.idField);
        this.selectedValues = this.comboService['__SELECTEDIDS__'];
        if (!this.multiSelect) {
            this.updateSelectedValues();
        }
        /** @type {?} */
        const _displayText = this.comboService.getValue(this.textField);
        this.onValueChange({ text: _displayText, value: this.comboService['__SELECTEDIDS__'], selections: this.selections });
    }
    /**
     * @param {?} $event
     * @return {?}
     */
    onKeyup($event) {
        // console.log('key up', $event);
    }
    /**
     * @param {?} $event
     * @return {?}
     */
    onKeydown($event) {
        // console.log('key down', $event);
        if ($event.key === 'Tab') {
            this.hide(false);
        }
        if ($event.key === 'Enter') {
            $event.stopPropagation();
            if (this._searchKeyWords && !this.multiSelect) {
                if (this.displayType === 'LOOKUPLIST') {
                    this.onSelectRows({ data: this._tableCmpRef.selections });
                }
                else if (this.displayType === 'LOOKUPTREELIST') {
                    // this.treeCmpRef.selectNode()
                }
            }
        }
    }
    /**
     * @param {?} event
     * @return {?}
     */
    onPageChanged(event) {
        if (this.uri) {
            this.getData(event).subscribe((/**
             * @param {?} data
             * @return {?}
             */
            data => this.comboService.loadLookUpDataTable(data, !!event.sortName)));
        }
        else {
            this.pageChanged.emit(event);
        }
    }
    /**
     * @param {?} event
     * @return {?}
     */
    onPageSizeChanged(event) {
        if (this.uri) {
            this.getData(event).subscribe((/**
             * @param {?} data
             * @return {?}
             */
            data => this.comboService.loadLookUpDataTable(data, !!event.sortName)));
        }
        else {
            this.pageSizeChanged.emit(event);
        }
    }
    /**
     * @param {?} event
     * @return {?}
     */
    onColumnSorted(event) {
        const { sortName, sortOrder } = Object.assign({}, event);
        this.getData({ sortName, sortOrder }, 'search').subscribe((/**
         * @param {?} data
         * @return {?}
         */
        data => {
            this.comboService.loadLookUpDataTable(data, true);
        }));
    }
    /**
     * @return {?}
     */
    onClear() {
        this.ownSelections = [];
        if (this.isTree() && this.treeCmpRef) {
            this.treeCmpRef.clearAll();
        }
        super.onClear();
    }
    /**
     * @private
     * @param {?} parentPath
     * @param {?} parentLayer
     * @param {?} searchData
     * @return {?}
     */
    getChildren(parentPath, parentLayer, searchData) {
        /** @type {?} */
        const search = Object.assign({ parentLayer, category: 'children' }, searchData);
        if (this.treeInfo.layerType === 'parentId') {
            search['parentId'] = parentPath;
        }
        else {
            search['parentPath'] = parentPath;
        }
        /** @type {?} */
        const param = {
            searchValue: JSON.stringify(search),
            customData: this.customData,
            enableFullTree: this.enableFullTree,
            loadTreeDataType: this.loadTreeDataType
        };
        if (this._searchKeyWords) {
            param.enableFullTree = false;
            param.loadTreeDataType = 'layerload';
            if (this.treeInfo.layerType === 'parentId') {
                // 树形帮助查询后，展开节点时将相关查询参数传递到后端 2022-09-13
                search.searchValue = '';
                search.searchField = '*';
            }
            param.searchValue = JSON.stringify(search);
        }
        /** @type {?} */
        const tt = (/** @type {?} */ (this.treeCmpRef));
        if (tt && tt.sortName) {
            Object.assign(param, {
                sortName: tt.sortName,
                sortOrder: tt.sortOrder
            });
        }
        return this.comboService.getData(param, 'get', true);
    }
    /**
     * @param {?=} event
     * @param {?=} type
     * @return {?}
     */
    getData(event, type = 'all') {
        event = event || {};
        if (this._searchKeyWords) {
            event.search = {
                field: '*',
                value: this._searchKeyWords
            };
        }
        /** @type {?} */
        const params = this.buildQueryParams(event, type);
        return this.comboService.getData(params);
    }
    /**
     * 构选查询参数
     * @private
     * @param {?=} event
     * @param {?=} type
     * @return {?}
     */
    buildQueryParams(event, type = 'all') {
        /** @type {?} */
        const params = {};
        /** @type {?} */
        const searchParam = { category: type };
        if (event) {
            if (event.pageInfo) {
                params['pageIndex'] = event.pageInfo.pageIndex;
                params['pageSize'] = event.pageInfo.pageSize;
            }
            if (event.search) {
                searchParam['searchField'] = event.search.field;
                searchParam['searchValue'] = event.search.value;
            }
            if (event.sortName) {
                searchParam['sortName'] = event.sortName;
            }
            if (event.sortOrder) {
                searchParam['sortOrder'] = event.sortOrder;
            }
        }
        params['searchValue'] = JSON.stringify(searchParam);
        if (this.customData) {
            params['customData'] = this.customData;
        }
        return params;
    }
    /**
     * @param {?} value
     * @param {?} field
     * @return {?}
     */
    filterDataOnServer(value, field) {
        /** @type {?} */
        let search = { search: { field, value } };
        if (value) {
            this._searchKeyWords = value;
        }
        else {
            this._searchKeyWords = '';
            search = null;
        }
        /** @type {?} */
        const params = this.buildQueryParams(search, 'search');
        if (!this.isOpen) {
            if (this.nosearch) {
                return;
            }
            this.isOpen = true;
            this.comboService.isOpen$.next({ isOpen: this.isOpen, search: params });
            return;
        }
        this.comboService.serachValue$.next(params);
    }
    /**
     * @param {?} tn
     * @return {?}
     */
    onExpandNode(tn) {
        if (tn.leaf || tn['showLoading']) {
            return;
        }
        if (!tn.children || !tn.children.length) {
            /** @type {?} */
            let parentPath = '';
            /** @type {?} */
            let parentLayer = -1;
            const { field = '*', value = '' } = {
                value: this._searchKeyWords
            };
            /** @type {?} */
            const treeInfoField = this.treeInfo.dataField;
            if (this.treeInfo.layerType === 'parentId') {
                // 父ID加载方式
                parentPath = tn['id'];
                parentLayer = tn.data[treeInfoField][this.treeInfo.layerField];
            }
            else {
                if (treeInfoField) {
                    parentPath = tn.data[treeInfoField][this.treeInfo.pathField];
                    parentLayer = tn.data[treeInfoField][this.treeInfo.layerField];
                }
                else {
                    this.treeCmpRef.writeConsole('未找到分级信息。');
                }
            }
            this.getChildren(parentPath, parentLayer, {
                searchField: field === '*' ? '*' : field,
                searchValue: value
            }).subscribe((/**
             * @param {?} data
             * @return {?}
             */
            data => {
                if (tn && data.items && data.items.length) {
                    /** @type {?} */
                    const nodes = this.comboService.checkNodeCanBeSelect(data.items, false);
                    this.treeCmpRef.appendChildren(nodes, tn);
                }
                this.treeCmpRef.detectChanges();
                // if (this.selectedValues && this.selectedValues.length) {
                //     this.treeCmpRef.checkedNodes(this.selectedValues.split(','));
                // }
                /** @type {?} */
                const ids = this.comboService['__SELECTEDIDS__'];
                if (ids && ids.length) {
                    /** @type {?} */
                    const idArr = ids.split(this.separator);
                    if (this.multiSelect) {
                        this.treeCmpRef.checkedNodes(idArr);
                    }
                    this.treeCmpRef.selectNodes(idArr);
                }
                this.treeCmpRef.psRef.directiveRef.update();
            }));
        }
    }
    /**
     * @protected
     * @return {?}
     */
    initDatasChangeAction() {
        this.comboService.data$.pipe(delay(120)).subscribe((/**
         * @param {?} data
         * @return {?}
         */
        data => {
            // 帮助数据异步自定义取数；
            // 帮助配置界面
            if (!this.uri && data && data.length) {
                this.updateSelections(this.selectedValues, data);
                // TFS 574365
                /** @type {?} */
                let txt = this.comboService.getValue(this.textField);
                txt = txt ? txt : this.nosearch ? this.displayText : '';
                this.displayText = txt;
                this['originalText'] = this.displayText;
            }
            if (this._searchKeyWords && data && data.length && !this.multiSelect) {
                if (this.displayType === 'LOOKUPLIST') {
                    this._tableCmpRef.selections = data[0];
                    this._tableCmpRef.cd.detectChanges();
                }
                else if (this.displayType === 'LOOKUPTREELIST') {
                    // this.treeCmpRef.selectNode()
                    /** @type {?} */
                    const nodes = this.comboService.checkNodeCanBeSelect(data.items, false);
                }
            }
        }));
    }
}
ComboLookupComponent.decorators = [
    { type: Component, args: [{
                // tslint:disable-next-line: component-selector
                selector: 'farris-combo-lookup',
                template: "<input-group\r\n    #input\r\n    [attr.title]=\"enableTitle ? displayText : ''\"\r\n    [class.actived]=\"isOpen\"\r\n    [(value)]=\"displayText\"\r\n    [forcePlaceholder]=\"forcePlaceholder\"\r\n    [disabled]=\"disabled\"\r\n    [readonly]=\"readonly\"\r\n    [editable]=\"editable\"\r\n    [groupText]=\"groupIcon\"\r\n    [placeholder]=\"placeholder\"\r\n    [enableClear]=\"enableClear\"\r\n    (clickHandle)=\"onClick()\"\r\n    (inputClick)=\"onInputclick($event)\"\r\n    (blurHandle)=\"onBlur($event)\"\r\n    (focusHandle)=\"onFocus($event)\"\r\n    (valueChange)=\"onTextChange($event)\"\r\n    (clear)=\"onClear()\"\r\n    (keyupHandle)=\"onKeyup($event)\"\r\n    (keydownHandle)=\"onKeydown($event)\"\r\n    [maxLength]=\"maxLength\" \r\n    style=\"display: block;\"\r\n>\r\n</input-group>\r\n<div class=\"comboPanel f-area-hide\" *ngIf=\"isOpen\"  #comboPanel style=\"overflow: hidden; height: 100%; width: 100%\" >\r\n    <farris-datatable\r\n        *ngIf=\"displayType === 'LOOKUPLIST'\"\r\n        #dt\r\n        [width]=\"panelWidth\"\r\n        [height]=\"panelHeight\"\r\n        [columns]=\"columns\"\r\n        [data]=\"comboService.data$ | async\"\r\n        [selections]=\"ownSelections\"\r\n        [idField]=\"idField\"\r\n        [singleSelect]=\"!multiSelect\"\r\n        [pagination] = \"pagination\"\r\n        [pageSize]=\"pageInfo.pageSize\"\r\n        [pageIndex]=\"pageInfo.pageIndex\"\r\n        [pageList]=\"pageInfo.pageList\"\r\n        [total]=\"pageInfo.total\"\r\n        [pagerViewMode]=\"'simple'\"\r\n        [showPageInfo]=\"false\" \r\n        [showPageNumber]=\"false\" \r\n        [showPageList]=\"false\"\r\n        [remoteSort]=\"false\"\r\n        [showHeader]=\"showHeader\"\r\n        (selectRows)=\"onSelectRows($event)\"\r\n        (unSelectRow)=\"onUnSelectRows($event)\"\r\n        (checkAll)=\"onCheckAll($event)\"\r\n        (pageChanged)=\"onPageChanged($event)\"\r\n        (pageSizeChanged)=\"onPageSizeChanged($event)\"\r\n        (columnSorted)=\"onColumnSorted($event)\"\r\n    ></farris-datatable>\r\n\r\n    <farris-treetable #tt\r\n        *ngIf=\"displayType === 'LOOKUPTREELIST'\"\r\n        [showHeader]=\"!useTreeView && showHeader\"\r\n        [showBorder]=\"!useTreeView\" \r\n        [showHeader]=\"!useTreeView\"\r\n        [expandLevel]=\"expandLevel\"\r\n        [virtualized]=\"true\"\r\n        [enableFilterRow]=\"enableFilterRow\"\r\n        [columns]=\"columns\"\r\n        [singleSelect]=\"!multiSelect\"\r\n        [idField]=\"idField\"\r\n        [data]=\"comboService.data$ | async\"\r\n        [checkOnSelect]=\"true\"\r\n        [selectOnCheck]=\"true\"\r\n        [fixedHeader]=\"true\"\r\n        [showCheckbox]=\"multiSelect\"\r\n        [fit]=\"true\"\r\n        [remoteSort]=\"false\"\r\n        [loadDataType]=\"loadDataType\"\r\n        (nodeSelected)=\"onSelectRows($event)\"\r\n        (nodeUnSelect)=\"onUnSelectRows($event)\"\r\n        (nodeChecked)=\"onSelectRows($event)\"\r\n        (nodeUnChecked)=\"onUnSelectRows($event)\"\r\n        (checkAll)=\"onCheckAll($event)\"\r\n        (unCheckAll)=\"onCheckAll($event)\"\r\n        (expand)=\"onExpandNode($event)\"\r\n        \r\n    ></farris-treetable>\r\n</div>\r\n<!--\r\n    [width]=\"panelWidth\"\r\n    [height]=\"panelHeight\"\r\n     -->",
                encapsulation: ViewEncapsulation.None,
                // styleUrls: ['./combo-lookup.component.scss'],
                providers: [INPUT_COMBO_VALUE_ACCESSOR, ComboService, LookupUtils]
            }] }
];
/** @nocollapse */
ComboLookupComponent.ctorParameters = () => [
    { type: ElementRef },
    { type: ChangeDetectorRef },
    { type: undefined, decorators: [{ type: Inject, args: [DOCUMENT,] }] },
    { type: Renderer2 },
    { type: ComboService },
    { type: Injector }
];
ComboLookupComponent.propDecorators = {
    showHeader: [{ type: Input }],
    useTreeView: [{ type: Input }],
    columns: [{ type: Input }],
    pagination: [{ type: Input }],
    displayType: [{ type: Input }],
    expandLevel: [{ type: Input }],
    enableFilterRow: [{ type: Input }],
    treeCmpRef: [{ type: ViewChild, args: ['tt',] }],
    tableCmpRef: [{ type: ViewChild, args: ['dt',] }],
    cascade: [{ type: Input }],
    treeInfo: [{ type: Input }],
    loadTreeDataType: [{ type: Input }],
    enableFullTree: [{ type: Input }],
    pageChanged: [{ type: Output }],
    pageSizeChanged: [{ type: Output }],
    useFormDataMapping: [{ type: Input }]
};
if (false) {
    /** @type {?} */
    ComboLookupComponent.prototype.panelHeight;
    /** @type {?} */
    ComboLookupComponent.prototype.comPosition;
    /** @type {?} */
    ComboLookupComponent.prototype.showHeader;
    /** @type {?} */
    ComboLookupComponent.prototype.useTreeView;
    /**
     * -1: 不展开； 0: 全部展开；>0: 展开到指定级数
     * @type {?}
     */
    ComboLookupComponent.prototype.expandLevel;
    /**
     * 树表启用过滤行
     * @type {?}
     */
    ComboLookupComponent.prototype.enableFilterRow;
    /** @type {?} */
    ComboLookupComponent.prototype.cascade;
    /** @type {?} */
    ComboLookupComponent.prototype.treeInfo;
    /**
     * 树形帮助数据加载方式： default: 内置取数； loadall: 加载所有 layerload：分层加载
     * @type {?}
     */
    ComboLookupComponent.prototype.loadTreeDataType;
    /**
     * 启用构造完整树过滤
     * @type {?}
     */
    ComboLookupComponent.prototype.enableFullTree;
    /** @type {?} */
    ComboLookupComponent.prototype.pageChanged;
    /** @type {?} */
    ComboLookupComponent.prototype.pageSizeChanged;
    /**
     * 使用表单映射，默认 false
     * @type {?}
     */
    ComboLookupComponent.prototype.useFormDataMapping;
    /** @type {?} */
    ComboLookupComponent.prototype.ownSelections;
    /** @type {?} */
    ComboLookupComponent.prototype.loadFinish;
    /** @type {?} */
    ComboLookupComponent.prototype.pageInfo;
    /**
     * @type {?}
     * @private
     */
    ComboLookupComponent.prototype.tt$;
    /**
     * @type {?}
     * @private
     */
    ComboLookupComponent.prototype.loaded$;
    /**
     * @type {?}
     * @private
     */
    ComboLookupComponent.prototype._columns;
    /**
     * @type {?}
     * @private
     */
    ComboLookupComponent.prototype._pagination;
    /**
     * @type {?}
     * @private
     */
    ComboLookupComponent.prototype._tableCmpRef;
    /**
     * @type {?}
     * @private
     */
    ComboLookupComponent.prototype._treeCmpRef;
    /**
     * @type {?}
     * @private
     */
    ComboLookupComponent.prototype._searchKeyWords;
    /** @type {?} */
    ComboLookupComponent.prototype.loadDataType;
    /**
     * @type {?}
     * @private
     */
    ComboLookupComponent.prototype.idSer;
    /** @type {?} */
    ComboLookupComponent.prototype.el;
    /** @type {?} */
    ComboLookupComponent.prototype.cdr;
    /** @type {?} */
    ComboLookupComponent.prototype.document;
    /** @type {?} */
    ComboLookupComponent.prototype.render;
    /** @type {?} */
    ComboLookupComponent.prototype.comboService;
    /** @type {?} */
    ComboLookupComponent.prototype.injector;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29tYm8tbG9va3VwLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BmYXJyaXMvdWktY29tYm8tbG9va3VwLyIsInNvdXJjZXMiOlsibGliL2NvbWJvLWxvb2t1cC5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUFBLE9BQU8sRUFBRSxZQUFZLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFDN0MsT0FBTyxFQUNILFNBQVMsRUFBVSxVQUFVLEVBQUUsaUJBQWlCLEVBQUUsTUFBTSxFQUFFLFNBQVMsRUFDbkUsUUFBUSxFQUFFLEtBQUssRUFBRSxTQUFTLEVBQUUsVUFBVSxFQUFFLGlCQUFpQixFQUFvQixNQUFNLEVBQ3RGLE1BQU0sZUFBZSxDQUFDO0FBQ3ZCLE9BQU8sRUFBRSxRQUFRLEVBQUUsTUFBTSxpQkFBaUIsQ0FBQztBQUMzQyxPQUFPLEVBQVEsSUFBSSxFQUEwQixZQUFZLEVBQUUsS0FBSyxFQUFFLE1BQU0sZ0JBQWdCLENBQUM7QUFDekYsT0FBTyxFQUFFLGtCQUFrQixFQUFFLFlBQVksRUFBRSxNQUFNLHVCQUF1QixDQUFDO0FBQ3pFLE9BQU8sRUFBRSxpQkFBaUIsRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBQ25ELE9BQU8sRUFBRSxXQUFXLEVBQVksTUFBTSxtQkFBbUIsQ0FBQztBQUMxRCxPQUFPLEVBQVksa0JBQWtCLEVBQUUsTUFBTSxzQkFBc0IsQ0FBQztBQUNwRSxPQUFPLEVBQUUsa0JBQWtCLEVBQUUsTUFBTSxzQkFBc0IsQ0FBQztBQUMxRCxPQUFPLEVBQUUsT0FBTyxFQUEyQixNQUFNLE1BQU0sQ0FBQztBQUN4RCxPQUFPLEVBQUUsU0FBUyxFQUFFLE1BQU0sbUJBQW1CLENBQUM7O01BRXhDLDBCQUEwQixHQUFRO0lBQ3BDLE9BQU8sRUFBRSxpQkFBaUI7O0lBRTFCLFdBQVcsRUFBRSxVQUFVOzs7SUFBQyxHQUFHLEVBQUUsQ0FBQyxvQkFBb0IsRUFBQztJQUNuRCxLQUFLLEVBQUUsSUFBSTtDQUNk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Q0FBNkI7Ozs7O0lBaUM3QiwyQ0FBMEI7Ozs7O0lBRzFCLCtDQUFpQzs7SUF3Q2pDLHVDQUlFOztJQUVGLHdDQUE0Qjs7Ozs7SUFHNUIsZ0RBQTJFOzs7OztJQUUzRSw4Q0FBK0I7O0lBRS9CLDJDQUEyQzs7SUFDM0MsK0NBQStDOzs7OztJQUUvQyxrREFBb0M7O0lBRXBDLDZDQUFtQjs7SUFDbkIsMENBQW1COztJQUNuQix3Q0FBeUQ7Ozs7O0lBQ3pELG1DQUE0Qjs7Ozs7SUFDNUIsdUNBQWdDOzs7OztJQUNoQyx3Q0FBd0I7Ozs7O0lBQ3hCLDJDQUE2Qjs7Ozs7SUFDN0IsNENBQTBCOzs7OztJQUMxQiwyQ0FBeUI7Ozs7O0lBQ3pCLCtDQUE2Qjs7SUFFN0IsNENBQXFCOzs7OztJQUVyQixxQ0FBeUI7O0lBR3JCLGtDQUFxQjs7SUFDckIsbUNBQTZCOztJQUM3Qix3Q0FBc0M7O0lBQ3RDLHNDQUF3Qjs7SUFDeEIsNENBQWlDOztJQUNqQyx3Q0FBeUIiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBFdmVudEVtaXR0ZXIgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHtcclxuICAgIENvbXBvbmVudCwgT25Jbml0LCBFbGVtZW50UmVmLCBDaGFuZ2VEZXRlY3RvclJlZiwgSW5qZWN0LCBSZW5kZXJlcjIsXHJcbiAgICBJbmplY3RvciwgSW5wdXQsIFZpZXdDaGlsZCwgZm9yd2FyZFJlZiwgVmlld0VuY2Fwc3VsYXRpb24sIEFmdGVyVmlld0NoZWNrZWQsIE91dHB1dFxyXG59IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBET0NVTUVOVCB9IGZyb20gJ0Bhbmd1bGFyL2NvbW1vbic7XHJcbmltcG9ydCB7IHNraXAsIHRha2UsIGZpbHRlciwgdGFrZVVudGlsLCBtYXAsIGRlYm91bmNlVGltZSwgZGVsYXkgfSBmcm9tICdyeGpzL29wZXJhdG9ycyc7XHJcbmltcG9ydCB7IEJhc2VDb21ib0NvbXBvbmVudCwgQ29tYm9TZXJ2aWNlIH0gZnJvbSAnQGZhcnJpcy91aS1jb21iby1saXN0JztcclxuaW1wb3J0IHsgTkdfVkFMVUVfQUNDRVNTT1IgfSBmcm9tICdAYW5ndWxhci9mb3Jtcyc7XHJcbmltcG9ydCB7IExvb2t1cFV0aWxzLCBUcmVlSW5mbyB9IGZyb20gJ0BmYXJyaXMvdWktbG9va3VwJztcclxuaW1wb3J0IHsgVHJlZU5vZGUsIFRyZWVUYWJsZUNvbXBvbmVudCB9IGZyb20gJ0BmYXJyaXMvdWktdHJlZXRhYmxlJztcclxuaW1wb3J0IHsgRGF0YVRhYmxlQ29tcG9uZW50IH0gZnJvbSAnQGZhcnJpcy91aS1kYXRhdGFibGUnO1xyXG5pbXBvcnQgeyBTdWJqZWN0LCBmb3JrSm9pbiwgaW50ZXJ2YWwsIHppcCB9IGZyb20gJ3J4anMnO1xyXG5pbXBvcnQgeyBJZFNlcnZpY2UgfSBmcm9tICdAZmFycmlzL3VpLWNvbW1vbic7XHJcblxyXG5jb25zdCBJTlBVVF9DT01CT19WQUxVRV9BQ0NFU1NPUjogYW55ID0ge1xyXG4gICAgcHJvdmlkZTogTkdfVkFMVUVfQUNDRVNTT1IsXHJcbiAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6IG5vLXVzZS1iZWZvcmUtZGVjbGFyZVxyXG4gICAgdXNlRXhpc3Rpbmc6IGZvcndhcmRSZWYoKCkgPT4gQ29tYm9Mb29rdXBDb21wb25lbnQpLFxyXG4gICAgbXVsdGk6IHRydWVcclxufTtcclxuXHJcbkBDb21wb25lbnQoe1xyXG4gICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOiBjb21wb25lbnQtc2VsZWN0b3JcclxuICAgIHNlbGVjdG9yOiAnZmFycmlzLWNvbWJvLWxvb2t1cCcsXHJcbiAgICB0ZW1wbGF0ZVVybDogJy4vY29tYm8tbG9va3VwLmNvbXBvbmVudC5odG1sJyxcclxuICAgIGVuY2Fwc3VsYXRpb246IFZpZXdFbmNhcHN1bGF0aW9uLk5vbmUsXHJcbiAgICAvLyBzdHlsZVVybHM6IFsnLi9jb21iby1sb29rdXAuY29tcG9uZW50LnNjc3MnXSxcclxuICAgIHByb3ZpZGVyczogW0lOUFVUX0NPTUJPX1ZBTFVFX0FDQ0VTU09SLCBDb21ib1NlcnZpY2UsIExvb2t1cFV0aWxzXVxyXG59KVxyXG5leHBvcnQgY2xhc3MgQ29tYm9Mb29rdXBDb21wb25lbnQgZXh0ZW5kcyBCYXNlQ29tYm9Db21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQge1xyXG4gICAgcGFuZWxIZWlnaHQgPSAzMDA7XHJcblxyXG4gICAgY29tUG9zaXRpb24gPSB7XHJcbiAgICAgICAgJ2hlaWdodC5weCc6IHRoaXMucGFuZWxIZWlnaHRcclxuICAgIH07XHJcblxyXG4gICAgQElucHV0KCkgc2hvd0hlYWRlciA9IHRydWU7XHJcblxyXG4gICAgQElucHV0KCkgdXNlVHJlZVZpZXcgPSBmYWxzZTtcclxuICAgIC8vIOagkeWIl+ihqOm7mOiupOWxleW8gOWxgue6p+OAgiAtMe+8miDkuI3lsZXlvIDvvJsgMO+8miDlhajpg6jlsZXlvIDvvJsgPjA6ICDlsZXlvIDliLDmjIflrprnuqfmlbDvvJtcclxuICAgIEBJbnB1dCgpXHJcbiAgICBzZXQgY29sdW1ucyh2YWx1ZTogYW55W10pIHtcclxuICAgICAgICB0aGlzLl9jb2x1bW5zID0gdmFsdWU7XHJcbiAgICB9XHJcbiAgICBnZXQgY29sdW1ucygpOiBhbnlbXSB7XHJcbiAgICAgICAgbGV0IGNvbHMgPSB0aGlzLl9jb2x1bW5zICE9PSB1bmRlZmluZWQgJiYgdGhpcy5fY29sdW1ucy5sZW5ndGggPiAwID8gdGhpcy5fY29sdW1ucyA6IHRoaXMuY29tYm9TZXJ2aWNlLmNvbHVtbnM7XHJcbiAgICAgICAgaWYgKHRoaXMudXNlVHJlZVZpZXcgJiYgY29scy5sZW5ndGggPiAxKSB7XHJcbiAgICAgICAgICAgIGNvbHMgPSBjb2xzLmZpbHRlcihuID0+IG4uZmllbGQgPT09IHRoaXMudGV4dEZpZWxkKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGNvbHM7XHJcbiAgICB9XHJcbiAgICBASW5wdXQoKVxyXG4gICAgc2V0IHBhZ2luYXRpb24odmFsdWU6IGJvb2xlYW4pIHtcclxuICAgICAgICB0aGlzLl9wYWdpbmF0aW9uID0gdmFsdWU7XHJcbiAgICB9XHJcbiAgICBnZXQgcGFnaW5hdGlvbigpIHtcclxuICAgICAgICBpZiAodGhpcy5fcGFnaW5hdGlvbiAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9wYWdpbmF0aW9uO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmNvbWJvU2VydmljZS5wYWdlSW5mbyAmJiB0aGlzLnBhZ2VJbmZvLmVuYWJsZVBhZ2VyID8gdGhpcy5wYWdlSW5mby5lbmFibGVQYWdlciA6IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIEBJbnB1dCgpXHJcbiAgICBzZXQgZGlzcGxheVR5cGUodmFsOiBzdHJpbmcpIHtcclxuICAgICAgICB0aGlzLmNvbWJvU2VydmljZS5kaXNwbGF5VHlwZSA9IHZhbCArICcnO1xyXG4gICAgfVxyXG4gICAgZ2V0IGRpc3BsYXlUeXBlKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmNvbWJvU2VydmljZS5kaXNwbGF5VHlwZTtcclxuICAgIH1cclxuXHJcbiAgICAvKiogLTE6IOS4jeWxleW8gO+8myAwOiDlhajpg6jlsZXlvIDvvJs+MDog5bGV5byA5Yiw5oyH5a6a57qn5pWwICovXHJcbiAgICBASW5wdXQoKSBleHBhbmRMZXZlbCA9IC0xO1xyXG5cclxuICAgIC8qKiDmoJHooajlkK/nlKjov4fmu6TooYwgKi9cclxuICAgIEBJbnB1dCgpIGVuYWJsZUZpbHRlclJvdyA9IGZhbHNlO1xyXG5cclxuICAgIEBWaWV3Q2hpbGQoJ3R0JylcclxuICAgIHNldCB0cmVlQ21wUmVmKGNtZjogVHJlZVRhYmxlQ29tcG9uZW50KSB7XHJcbiAgICAgICAgaWYgKGNtZikge1xyXG4gICAgICAgICAgICBjbWYuY2FzY2FkZUNoZWNrID0gdGhpcy5jYXNjYWRlLmVuYWJsZTtcclxuICAgICAgICAgICAgY21mLmNhc2NhZGVEb3duID0gdGhpcy5jYXNjYWRlLmRvd247XHJcbiAgICAgICAgICAgIGNtZi5jYXNjYWRlVXAgPSB0aGlzLmNhc2NhZGUudXA7XHJcblxyXG4gICAgICAgICAgICB0aGlzLnR0JC5uZXh0KGNtZik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuX3RyZWVDbXBSZWYgPSBjbWY7XHJcbiAgICB9XHJcbiAgICBnZXQgdHJlZUNtcFJlZigpOiBUcmVlVGFibGVDb21wb25lbnQge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl90cmVlQ21wUmVmO1xyXG4gICAgfVxyXG4gICAgQFZpZXdDaGlsZCgnZHQnKVxyXG4gICAgc2V0IHRhYmxlQ21wUmVmKGNtZjogRGF0YVRhYmxlQ29tcG9uZW50KSB7XHJcbiAgICAgICAgaWYgKGNtZiAmJiB0aGlzLnBhZ2luYXRpb24pIHtcclxuICAgICAgICAgICAgdGhpcy5sb2FkZWQkLnBpcGUodGFrZSgxKSkuc3Vic2NyaWJlKGUgPT4ge1xyXG4gICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2codGhpcy5fdGFibGVDbXBSZWYsIGNtZik7XHJcbiAgICAgICAgICAgICAgICBjbWYubG9hZERhdGEoe1xyXG4gICAgICAgICAgICAgICAgICAgIHBhZ2VTaXplOiB0aGlzLnBhZ2VJbmZvLnBhZ2VTaXplLFxyXG4gICAgICAgICAgICAgICAgICAgIHRvdGFsOiB0aGlzLnBhZ2VJbmZvLnRvdGFsLFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHRoaXMuZGF0YSxcclxuICAgICAgICAgICAgICAgICAgICBwYWdlSW5kZXg6IHRoaXMucGFnZUluZm8ucGFnZUluZGV4XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICghdGhpcy5fdGFibGVDbXBSZWYgJiYgdGhpcy5sb2FkRmluaXNoICYmIGNtZikge1xyXG4gICAgICAgICAgICBjbWYubG9hZERhdGEoe1xyXG4gICAgICAgICAgICAgICAgcGFnZVNpemU6IHRoaXMucGFnZUluZm8ucGFnZVNpemUsXHJcbiAgICAgICAgICAgICAgICB0b3RhbDogdGhpcy5wYWdlSW5mby50b3RhbCxcclxuICAgICAgICAgICAgICAgIGRhdGE6IHRoaXMuZGF0YSxcclxuICAgICAgICAgICAgICAgIHBhZ2VJbmRleDogdGhpcy5wYWdlSW5mby5wYWdlSW5kZXhcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuX3RhYmxlQ21wUmVmID0gY21mO1xyXG4gICAgfVxyXG5cclxuICAgIEBJbnB1dCgpIGNhc2NhZGUgPSB7XHJcbiAgICAgICAgZW5hYmxlOiBmYWxzZSxcclxuICAgICAgICB1cDogZmFsc2UsXHJcbiAgICAgICAgZG93bjogZmFsc2VcclxuICAgIH07XHJcblxyXG4gICAgQElucHV0KCkgdHJlZUluZm86IFRyZWVJbmZvO1xyXG5cclxuICAgIC8qKiDmoJHlvaLluK7liqnmlbDmja7liqDovb3mlrnlvI/vvJogZGVmYXVsdDog5YaF572u5Y+W5pWw77ybIGxvYWRhbGw6IOWKoOi9veaJgOaciSBsYXllcmxvYWTvvJrliIblsYLliqDovb0gKi9cclxuICAgIEBJbnB1dCgpIGxvYWRUcmVlRGF0YVR5cGU6ICdkZWZhdWx0JyB8ICdsb2FkYWxsJyB8ICdsYXllcmxvYWQnID0gJ2RlZmF1bHQnO1xyXG4gICAgLyoqIOWQr+eUqOaehOmAoOWujOaVtOagkei/h+a7pCAqL1xyXG4gICAgQElucHV0KCkgZW5hYmxlRnVsbFRyZWUgPSB0cnVlO1xyXG5cclxuICAgIEBPdXRwdXQoKSBwYWdlQ2hhbmdlZCA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcclxuICAgIEBPdXRwdXQoKSBwYWdlU2l6ZUNoYW5nZWQgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XHJcbiAgICAvKiog5L2/55So6KGo5Y2V5pig5bCE77yM6buY6K6kIGZhbHNlICovXHJcbiAgICBASW5wdXQoKSB1c2VGb3JtRGF0YU1hcHBpbmcgPSBmYWxzZTtcclxuXHJcbiAgICBvd25TZWxlY3Rpb25zOiBhbnk7XHJcbiAgICBsb2FkRmluaXNoID0gZmFsc2U7XHJcbiAgICBwYWdlSW5mbzogYW55ID0geyBwYWdlU2l6ZTogMjAsIHBhZ2VJbmRleDogMSwgdG90YWw6IDAgfTtcclxuICAgIHByaXZhdGUgdHQkID0gbmV3IFN1YmplY3QoKTtcclxuICAgIHByaXZhdGUgbG9hZGVkJCA9IG5ldyBTdWJqZWN0KCk7XHJcbiAgICBwcml2YXRlIF9jb2x1bW5zOiBhbnlbXTtcclxuICAgIHByaXZhdGUgX3BhZ2luYXRpb246IGJvb2xlYW47XHJcbiAgICBwcml2YXRlIF90YWJsZUNtcFJlZjogYW55O1xyXG4gICAgcHJpdmF0ZSBfdHJlZUNtcFJlZjogYW55O1xyXG4gICAgcHJpdmF0ZSBfc2VhcmNoS2V5V29yZHMgPSAnJztcclxuXHJcbiAgICBsb2FkRGF0YVR5cGUgPSAnYWxsJztcclxuXHJcbiAgICBwcml2YXRlIGlkU2VyOiBJZFNlcnZpY2U7XHJcblxyXG4gICAgY29uc3RydWN0b3IoXHJcbiAgICAgICAgcHVibGljIGVsOiBFbGVtZW50UmVmLFxyXG4gICAgICAgIHB1YmxpYyBjZHI6IENoYW5nZURldGVjdG9yUmVmLFxyXG4gICAgICAgIEBJbmplY3QoRE9DVU1FTlQpIHB1YmxpYyBkb2N1bWVudDogYW55LFxyXG4gICAgICAgIHB1YmxpYyByZW5kZXI6IFJlbmRlcmVyMixcclxuICAgICAgICBwdWJsaWMgY29tYm9TZXJ2aWNlOiBDb21ib1NlcnZpY2UsXHJcbiAgICAgICAgcHVibGljIGluamVjdG9yOiBJbmplY3RvclxyXG4gICAgKSB7XHJcbiAgICAgICAgc3VwZXIoZWwsIGNkciwgZG9jdW1lbnQsIHJlbmRlciwgY29tYm9TZXJ2aWNlLCBpbmplY3Rvcik7XHJcbiAgICAgICAgdGhpcy5pZFNlciA9IHRoaXMuaW5qZWN0b3IuZ2V0KElkU2VydmljZSwgbnVsbCk7XHJcbiAgICAgICAgaWYgKCF0aGlzLmlkU2VyKSB7XHJcbiAgICAgICAgICAgIHRoaXMuaWRTZXIgPSBuZXcgSWRTZXJ2aWNlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIG5nT25Jbml0KCkge1xyXG4gICAgICAgIHN1cGVyLm5nT25Jbml0KCk7XHJcblxyXG4gICAgICAgIHRoaXMudHJlZUNsaWVudFNlYXJjaC5waXBlKGRlYm91bmNlVGltZSgzMDApKS5zdWJzY3JpYmUoKHZhbHVlOiBzdHJpbmcpID0+IHtcclxuICAgICAgICAgICAgaWYgKCF0aGlzLnJlbW90ZVNlYXJjaCAmJiB0aGlzLnRyZWVDbXBSZWYpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMudHJlZUNtcFJlZi5zZWFyY2hIYW5kbGUuc2VhcmNoKHRoaXMudGV4dEZpZWxkLCB2YWx1ZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgdGhpcy5jb21ib1NlcnZpY2UudHJlZUluZm8kLnN1YnNjcmliZSggKHQ6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICBpZiAodCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMubG9hZFRyZWVEYXRhVHlwZSA9PT0gJ2RlZmF1bHQnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2FkRGF0YVR5cGUgPSB0LmxvYWREYXRhVHlwZTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICB0aGlzLnRyZWVJbmZvID0gT2JqZWN0LmFzc2lnbih0aGlzLnRyZWVJbmZvfHwge30sIHQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJvdGVjdGVkIG9uU2VsZWN0aW9uc0NoYW5nZShzZWxlY3Rpb25zOiBhbnlbXSkge1xyXG4gICAgICAgIGlmICh0aGlzLmRpc3BsYXlUeXBlID09PSAnTE9PS1VQTElTVCcpIHtcclxuICAgICAgICAgICAgaWYgKCF0aGlzLm11bHRpU2VsZWN0KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm93blNlbGVjdGlvbnMgPSBzZWxlY3Rpb25zWzBdID8gIHNlbGVjdGlvbnNbMF0gOiB7fTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHRoaXMub3duU2VsZWN0aW9ucyA9IHt9O1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jb21ib1NlcnZpY2Uuc2VsZWN0aW9ucy5mb3JFYWNoKGl0ZW0gPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMub3duU2VsZWN0aW9uc1tpdGVtW3RoaXMuaWRGaWVsZF1dID0gaXRlbTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMucGFnZUluZm8gPSB7IC4uLnRoaXMucGFnZUluZm8sIC4uLnRoaXMuY29tYm9TZXJ2aWNlLnBhZ2VJbmZvIH07XHJcbiAgICAgICAgICAgIHRoaXMubG9hZEZpbmlzaCA9IHRydWU7XHJcbiAgICAgICAgICAgIHRoaXMuY2RyLmRldGVjdENoYW5nZXMoKTtcclxuICAgICAgICAgICAgdGhpcy5sb2FkZWQkLm5leHQodGhpcy5wYWdlSW5mbyk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMudHJlZUNtcFJlZikge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5pbml0VHJlZURhdGEoKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHRoaXMudHQkLnBpcGUodGFrZSgxKSkuc3Vic2NyaWJlKChjbWY6IFRyZWVUYWJsZUNvbXBvbmVudCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMudHJlZUNtcFJlZiA9IGNtZjtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmluaXRUcmVlRGF0YSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIGNtZi5jaGVja2VkTm9kZXMoaWRzLCB0cnVlLCBmYWxzZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gY21mLnVwZGF0ZVNlcmlhbGl6ZWRWYWx1ZSgpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBzZXRUcmVlTm9kZUV4cGFuZEJ5KG5vZGVzOiBUcmVlTm9kZVtdLCBleHBhbmRMYXllcikge1xyXG4gICAgICAgIGlmICghbm9kZXMgfHwgIW5vZGVzLmxlbmd0aCkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIG5vZGVzLmZvckVhY2goKG46IFRyZWVOb2RlKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGxheWVyID0gbi5kYXRhW3RoaXMudHJlZUluZm8uZGF0YUZpZWxkXS5sYXllcjtcclxuICAgICAgICAgICAgbi5leHBhbmRlZCA9IGxheWVyIDw9IGV4cGFuZExheWVyID8gdHJ1ZSA6IG4uZXhwYW5kZWQ7XHJcbiAgICAgICAgICAgIGlmIChuLmNoaWxkcmVuICYmIG4uY2hpbGRyZW4ubGVuZ3RoICYmIGxheWVyICsgMSA8PSBleHBhbmRMYXllcikge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXRUcmVlTm9kZUV4cGFuZEJ5KG4uY2hpbGRyZW4sIGV4cGFuZExheWVyKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgaW5pdFRyZWVEYXRhKCkge1xyXG4gICAgICAgIGNvbnN0IF9fc2VsZWN0aW9ucyA9IHRoaXMuY29tYm9TZXJ2aWNlLnNlbGVjdGlvbnMuZmlsdGVyKG4gPT4gbiAhPT0gbnVsbCAmJiBuICE9PSB1bmRlZmluZWQpO1xyXG4gICAgICAgIGNvbnN0IGlkcyA9IFtdO1xyXG4gICAgICAgIHRoaXMub3duU2VsZWN0aW9ucyA9IF9fc2VsZWN0aW9ucy5tYXAoaXRlbSA9PiB7XHJcbiAgICAgICAgICAgIGlkcy5wdXNoKGl0ZW1bdGhpcy5pZEZpZWxkXSk7XHJcbiAgICAgICAgICAgIHJldHVybiB7IGRhdGE6IGl0ZW0sIGlkOiBpdGVtW3RoaXMuaWRGaWVsZF0gfTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLnRyZWVDbXBSZWYuc2VsZWN0aW9ucyA9IHRoaXMub3duU2VsZWN0aW9ucztcclxuICAgICAgICB0aGlzLnRyZWVDbXBSZWYuY2hlY2tlZHMgPSB0aGlzLm93blNlbGVjdGlvbnM7XHJcblxyXG4gICAgICAgIGlmICh0aGlzLmV4cGFuZExldmVsICE9IC0xICYmIHRoaXMubG9hZERhdGFUeXBlID09ICdhbGwnICkge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5leHBhbmRMZXZlbCA+IDApIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0VHJlZU5vZGVFeHBhbmRCeSh0aGlzLnRyZWVDbXBSZWYuZGF0YSwgdGhpcy5leHBhbmRMZXZlbCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnRyZWVDbXBSZWYudXBkYXRlU2VyaWFsaXplZFZhbHVlKCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnRyZWVDbXBSZWYuZXhwYW5kQWxsKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICh0aGlzLmNvbWJvU2VydmljZS5kYXRhICYmIHRoaXMuY29tYm9TZXJ2aWNlLmRhdGEubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLnRyZWVDbXBSZWYuY2hlY2tWYWx1ZXMgJiYgdGhpcy50cmVlQ21wUmVmLmNoZWNrVmFsdWVzLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMubXVsdGlTZWxlY3QpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnRyZWVDbXBSZWYuY2hlY2tlZE5vZGVzKHRoaXMudHJlZUNtcFJlZi5jaGVja1ZhbHVlcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy50cmVlQ21wUmVmLnNlbGVjdE5vZGVzKHRoaXMudHJlZUNtcFJlZi5jaGVja1ZhbHVlcyk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMudHJlZUNtcFJlZi5zZWxlY3ROb2Rlcyh0aGlzLnRyZWVDbXBSZWYuY2hlY2tWYWx1ZXMpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuXHJcbiAgICBwcml2YXRlIGlzVHJlZSgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5kaXNwbGF5VHlwZSA9PT0gJ0xPT0tVUFRSRUVMSVNUJztcclxuICAgIH1cclxuXHJcblxyXG4gICAgdXBkYXRlTWFwcGluZ0ZpZWxkVmFsdWUoY2xlYXJNYXBGaWVsZHMgPSBmYWxzZSkge1xyXG4gICAgICAgIGlmICggdGhpcy5uZ0NvbnRyb2wgJiYgdGhpcy5uZ0NvbnRyb2wuZm9ybURpcmVjdGl2ZSAmJlxyXG4gICAgICAgICAgICB0aGlzLm5nQ29udHJvbC5mb3JtRGlyZWN0aXZlLmZvcm0gJiYgdGhpcy5uZ0NvbnRyb2wuZm9ybURpcmVjdGl2ZS5mb3JtLmJpbmRpbmdEYXRhXHJcbiAgICAgICAgKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGJpbmRpbmdEYXRhID0gdGhpcy5uZ0NvbnRyb2wuZm9ybURpcmVjdGl2ZS5mb3JtLmJpbmRpbmdEYXRhO1xyXG4gICAgICAgICAgICBjb25zdCBiaW5kaW5nUGF0aCA9IHRoaXMubmdDb250cm9sLmZvcm1EaXJlY3RpdmUuZm9ybS5iaW5kaW5nUGF0aDtcclxuICAgICAgICAgICAgbGV0IHBhdGhBcnIgPSBbXTtcclxuICAgICAgICAgICAgaWYgKGJpbmRpbmdQYXRoKSB7XHJcbiAgICAgICAgICAgICAgICBwYXRoQXJyID0gYmluZGluZ1BhdGguc3BsaXQoJy8nKS5maWx0ZXIobiA9PiBuICE9PSAnJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5tYXBwaW5nRmllbGQgPSB0aGlzLm1hcHBpbmdGaWVsZCA/IHRoaXMubWFwcGluZ0ZpZWxkIDoge307XHJcbiAgICAgICAgICAgIGlmICh0aGlzLm1hcEZpZWxkcykge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaGVscEZpZWxkcyA9IE9iamVjdC5rZXlzKHRoaXMubWFwRmllbGRzKTtcclxuICAgICAgICAgICAgICAgIGhlbHBGaWVsZHMuZm9yRWFjaCgoZjogYW55KSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZmllbGROYW1lcyA9IHRoaXMubWFwRmllbGRzW2ZdID8gdGhpcy5tYXBGaWVsZHNbZl0gOiAnJztcclxuICAgICAgICAgICAgICAgICAgICBsZXQgdmFsdWUgPSAnJztcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIWNsZWFyTWFwRmllbGRzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHRleHQgPSB0aGlzLmNvbWJvU2VydmljZS5zZWxlY3Rpb25zICYmIHRoaXMuY29tYm9TZXJ2aWNlLnNlbGVjdGlvbnMubWFwKGl0ZW0gPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuY29tYm9TZXJ2aWNlLmdldFZhbHVlQnlPYmooZiwgaXRlbSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pLmZpbHRlcihuID0+IG4gIT09IG51bGwpLmpvaW4odGhpcy5zZXBhcmF0b3IpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB2YWx1ZSA9IHRleHQgPyB0ZXh0IDogdGhpcy5kaXNwbGF5VGV4dCA/IHRoaXMuZGlzcGxheVRleHQgOiAnJztcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSB0ZXh0IHx8ICcnO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGZpZWxkTmFtZXMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZmllbGROYW1lcy5zcGxpdCgnLCcpLmZvckVhY2goKGZpZWxkTmFtZTogYW55KSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgX3ZhbCA9IHZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMubm9zZWFyY2ggJiYgZmllbGROYW1lID09PSB0aGlzLm5nQ29udHJvbC5uYW1lKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3ZhbCA9IHRoaXMuZGlzcGxheVRleHQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYmluZGluZ0RhdGEuc2V0VmFsdWUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoICF0aGlzLnVzZUZvcm1EYXRhTWFwcGluZykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiaW5kaW5nRGF0YS5zZXRWYWx1ZSggcGF0aEFyci5jb25jYXQoZmllbGROYW1lLnNwbGl0KCcuJykpLCBfdmFsLCB0cnVlLCB0cnVlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY29tbW9uVXRpbHMuc2V0VmFsdWUoYmluZGluZ0RhdGEsIGZpZWxkTmFtZSwgdmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgdXBkYXRlU2VsZWN0ZWRWYWx1ZXMoKSB7XHJcbiAgICAgICAgaWYgKFxyXG4gICAgICAgICAgICB0aGlzLm5nQ29udHJvbCAmJlxyXG4gICAgICAgICAgICB0aGlzLm5nQ29udHJvbC5mb3JtRGlyZWN0aXZlICYmXHJcbiAgICAgICAgICAgIHRoaXMubmdDb250cm9sLmZvcm1EaXJlY3RpdmUuZm9ybSAmJlxyXG4gICAgICAgICAgICB0aGlzLm5nQ29udHJvbC5mb3JtRGlyZWN0aXZlLmZvcm0uYmluZGluZ0RhdGFcclxuICAgICAgICApIHtcclxuICAgICAgICAgICAgY29uc3QgYmluZGluZ0RhdGEgPSB0aGlzLm5nQ29udHJvbC5mb3JtRGlyZWN0aXZlLmZvcm0uYmluZGluZ0RhdGE7XHJcbiAgICAgICAgICAgIGNvbnN0IGJpbmRpbmdQYXRoID0gdGhpcy5uZ0NvbnRyb2wuZm9ybURpcmVjdGl2ZS5mb3JtLmJpbmRpbmdQYXRoO1xyXG4gICAgICAgICAgICBsZXQgcGF0aEFyciA9IFtdO1xyXG4gICAgICAgICAgICBpZiAoYmluZGluZ1BhdGgpIHtcclxuICAgICAgICAgICAgICAgIHBhdGhBcnIgPSBiaW5kaW5nUGF0aC5zcGxpdCgnLycpLmZpbHRlcihuID0+IG4gIT09ICcnKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBsZXQgdGFyZ2V0RmllbGQgPSB0aGlzLm1hcHBpbmdGaWVsZCA/IHRoaXMubWFwRmllbGRzW3RoaXMuaWRGaWVsZF0gOiAnJztcclxuXHJcbiAgICAgICAgICAgIGlmICh0YXJnZXRGaWVsZCAmJiB0YXJnZXRGaWVsZC5pbmRleE9mKCcsJykgPiAtMSkge1xyXG4gICAgICAgICAgICAgICAgdGFyZ2V0RmllbGQgPSB0YXJnZXRGaWVsZC5zcGxpdCgnLCcpWzBdO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvLyB0aGlzLm1hcHBpbmdGaWVsZCA9IHRoaXMubWFwcGluZ0ZpZWxkID8gdGhpcy5tYXBwaW5nRmllbGQgOiAnJztcclxuICAgICAgICAgICAgaWYgKHRhcmdldEZpZWxkICYmIGJpbmRpbmdEYXRhLmdldFZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGVkVmFsdWVzID0gYmluZGluZ0RhdGEuZ2V0VmFsdWUocGF0aEFyci5jb25jYXQodGFyZ2V0RmllbGQuc3BsaXQoJy4nKSkpIHx8ICcnO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHRhcmdldEZpZWxkKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGVkVmFsdWVzID0gdGhpcy5jb21tb25VdGlscy5nZXRWYWx1ZSh0YXJnZXRGaWVsZCwgYmluZGluZ0RhdGEpIHx8ICcnO1xyXG4gICAgICAgICAgICB9IFxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIC8vIOWFvOWuueS4uuiuvue9rmlkRmllbGQg5a2X5q615pig5bCE55qE5oOF5Ya177yM5q2k5oOF5Ya15L2/55SoIHZhbHVlRmllbGRcclxuICAgICAgICAgICAgICAgIHRhcmdldEZpZWxkID0gdGhpcy5tYXBwaW5nRmllbGQgPyB0aGlzLm1hcEZpZWxkc1t0aGlzLnRleHRGaWVsZF0gOiAnJztcclxuICAgICAgICAgICAgICAgIGlmICh0YXJnZXRGaWVsZCAmJiBiaW5kaW5nRGF0YS5nZXRWYWx1ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY29tYm9TZXJ2aWNlWydfX1NFTEVDVEVESURTX18nXSA9IHRoaXMuY29tYm9TZXJ2aWNlLmdldFZhbHVlKHRoaXMuaWRGaWVsZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RlZFZhbHVlcyA9ICBiaW5kaW5nRGF0YS5nZXRWYWx1ZShwYXRoQXJyLmNvbmNhdCh0YXJnZXRGaWVsZC5zcGxpdCgnLicpKSkgfHwgJyc7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0gXHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgLy8gVUkgc3RhdGUgYmluZGluZ1xyXG4gICAgICAgICAgICBpZiAodGhpcy5lbC5uYXRpdmVFbGVtZW50WydfX3pvbmVfc3ltYm9sX19VSVN0YXRlQmluZGluZ0NoYW5nZWZhbHNlJ10pIHtcclxuICAgICAgICAgICAgICAgIC8vIHRoaXMuc2VsZWN0ZWRWYWx1ZXMgPSB0aGlzLmNvbWJvU2VydmljZS5nZXRWYWx1ZSh0aGlzLnRleHRGaWVsZCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGVkVmFsdWVzID0gdGhpcy5kaXNwbGF5VGV4dDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBvblNlbGVjdFJvd3Mocm93KSB7XHJcbiAgICAgICAgaWYgKHRoaXMuZGlzcGxheVR5cGUgPT09ICdMT09LVVBMSVNUJykge1xyXG4gICAgICAgICAgICBjb25zdCB7IGRhdGEsIGluZGV4IH0gPSByb3c7XHJcbiAgICAgICAgICAgIHRoaXMuY29tYm9TZXJ2aWNlLnNlbGVjdEl0ZW0oZGF0YSwgaW5kZXgpO1xyXG4gICAgICAgICAgICB0aGlzLnNlbGVjdENoYW5nZS5lbWl0KHsgZGF0YSwgaW5kZXgsIGluc3RhbmNlOiB0aGlzIH0pOyAvLyBVSS1TVEFURS1CSU5ESU5HIOS4reS9v+eUqFxyXG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy5kaXNwbGF5VHlwZSA9PT0gJ0xPT0tVUFRSRUVMSVNUJykge1xyXG4gICAgICAgICAgICBjb25zdCB7IG5vZGUgfSA9IHJvdztcclxuICAgICAgICAgICAgaWYgKHJvdy5ub2Rlcykge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jb21ib1NlcnZpY2Uuc2VsZWN0SXRlbShyb3cubm9kZXMubWFwKG4gPT4gbi5kYXRhKSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNvbWJvU2VydmljZS5zZWxlY3RJdGVtKG5vZGUuZGF0YSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5zZWxlY3RDaGFuZ2UuZW1pdChub2RlKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMudXBkYXRlVGV4dEFuZFZhbHVlcygpO1xyXG4gICAgICAgIGlmICghdGhpcy5tdWx0aVNlbGVjdCkge1xyXG4gICAgICAgICAgICB0aGlzLmNvbWJvU2VydmljZS5pc09wZW4kLm5leHQoZmFsc2UpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBvblVuU2VsZWN0Um93cyhyb3cpIHtcclxuICAgICAgICBpZiAodGhpcy5kaXNwbGF5VHlwZSA9PT0gJ0xPT0tVUExJU1QnKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHsgZGF0YSB9ID0gcm93O1xyXG4gICAgICAgICAgICB0aGlzLmNvbWJvU2VydmljZS51blNlbGVjdEl0ZW0oZGF0YSk7XHJcbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLmRpc3BsYXlUeXBlID09PSAnTE9PS1VQVFJFRUxJU1QnKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHsgbm9kZSB9ID0gcm93O1xyXG4gICAgICAgICAgICB0aGlzLmNvbWJvU2VydmljZS51blNlbGVjdEl0ZW0obm9kZS5kYXRhKTtcclxuICAgICAgICAgICAgdGhpcy5zZWxlY3RDaGFuZ2UuZW1pdChub2RlKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMudXBkYXRlVGV4dEFuZFZhbHVlcygpO1xyXG4gICAgfVxyXG5cclxuICAgIG9uQ2hlY2tBbGwoZXYpIHtcclxuICAgICAgICBsZXQgc3RhdGU7XHJcbiAgICAgICAgbGV0IHNlbGVjdGlvbnMgPSBbXTtcclxuICAgICAgICBpZiAodGhpcy5kaXNwbGF5VHlwZSA9PT0gJ0xPT0tVUFRSRUVMSVNUJykge1xyXG4gICAgICAgICAgICBzdGF0ZSA9IGV2LmNoZWNrZWQ7XHJcbiAgICAgICAgICAgIHNlbGVjdGlvbnMgPSB0aGlzLnRyZWVDbXBSZWYuc3RhdGUucm93Tm9kZXNcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5maWx0ZXIobiA9PiBuLm5vZGUuc2VsZWN0YWJsZSA9PT0gdW5kZWZpbmVkIHx8IG4ubm9kZS5zZWxlY3RhYmxlIClcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5tYXAociA9PiByLm5vZGUuZGF0YSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgc3RhdGUgPSBldjtcclxuICAgICAgICAgICAgc2VsZWN0aW9ucyA9IHRoaXMuZGF0YTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChzdGF0ZSkge1xyXG4gICAgICAgICAgICB0aGlzLmNvbWJvU2VydmljZS5zZWxlY3RBbGwoc2VsZWN0aW9ucyk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5jb21ib1NlcnZpY2UudW5TZWxlY3RBbGwoc2VsZWN0aW9ucyk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLnVwZGF0ZVRleHRBbmRWYWx1ZXMoKTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIHVwZGF0ZVRleHRBbmRWYWx1ZXMoKSB7XHJcbiAgICAgICAgdGhpcy5jb21ib1NlcnZpY2VbJ19fU0VMRUNURURJRFNfXyddID0gdGhpcy5jb21ib1NlcnZpY2UuZ2V0VmFsdWUodGhpcy5pZEZpZWxkKTtcclxuICAgICAgICB0aGlzLnNlbGVjdGVkVmFsdWVzID0gdGhpcy5jb21ib1NlcnZpY2VbJ19fU0VMRUNURURJRFNfXyddO1xyXG4gICAgICAgIGlmICghdGhpcy5tdWx0aVNlbGVjdCkge1xyXG4gICAgICAgICAgICB0aGlzLnVwZGF0ZVNlbGVjdGVkVmFsdWVzKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IF9kaXNwbGF5VGV4dCA9IHRoaXMuY29tYm9TZXJ2aWNlLmdldFZhbHVlKHRoaXMudGV4dEZpZWxkKTtcclxuICAgICAgICB0aGlzLm9uVmFsdWVDaGFuZ2UoeyB0ZXh0OiBfZGlzcGxheVRleHQsIHZhbHVlOiB0aGlzLmNvbWJvU2VydmljZVsnX19TRUxFQ1RFRElEU19fJ10sIHNlbGVjdGlvbnM6IHRoaXMuc2VsZWN0aW9ucyB9KTtcclxuICAgIH1cclxuXHJcbiAgICBvbktleXVwKCRldmVudCkge1xyXG4gICAgICAgIC8vIGNvbnNvbGUubG9nKCdrZXkgdXAnLCAkZXZlbnQpO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBvbktleWRvd24oJGV2ZW50OiBLZXlib2FyZEV2ZW50KSB7XHJcbiAgICAgICAgLy8gY29uc29sZS5sb2coJ2tleSBkb3duJywgJGV2ZW50KTtcclxuICAgICAgICBpZiAoJGV2ZW50LmtleSA9PT0gJ1RhYicpIHtcclxuICAgICAgICAgICAgdGhpcy5oaWRlKGZhbHNlKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICgkZXZlbnQua2V5ID09PSAnRW50ZXInKSB7XHJcbiAgICAgICAgICAgICRldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICAgICAgaWYgKHRoaXMuX3NlYXJjaEtleVdvcmRzICYmICF0aGlzLm11bHRpU2VsZWN0KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5kaXNwbGF5VHlwZSA9PT0gJ0xPT0tVUExJU1QnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vblNlbGVjdFJvd3Moe2RhdGE6IHRoaXMuX3RhYmxlQ21wUmVmLnNlbGVjdGlvbnN9KTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5kaXNwbGF5VHlwZSA9PT0gJ0xPT0tVUFRSRUVMSVNUJykge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIHRoaXMudHJlZUNtcFJlZi5zZWxlY3ROb2RlKClcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBvblBhZ2VDaGFuZ2VkKGV2ZW50KSB7XHJcbiAgICAgICAgaWYgKHRoaXMudXJpKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZ2V0RGF0YShldmVudCkuc3Vic2NyaWJlKGRhdGEgPT4gdGhpcy5jb21ib1NlcnZpY2UubG9hZExvb2tVcERhdGFUYWJsZShkYXRhLCAhIWV2ZW50LnNvcnROYW1lKSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5wYWdlQ2hhbmdlZC5lbWl0KGV2ZW50KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgb25QYWdlU2l6ZUNoYW5nZWQoZXZlbnQpIHtcclxuICAgICAgICBpZiAodGhpcy51cmkpIHtcclxuICAgICAgICAgICAgdGhpcy5nZXREYXRhKGV2ZW50KS5zdWJzY3JpYmUoZGF0YSA9PiB0aGlzLmNvbWJvU2VydmljZS5sb2FkTG9va1VwRGF0YVRhYmxlKGRhdGEsICEhZXZlbnQuc29ydE5hbWUpKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLnBhZ2VTaXplQ2hhbmdlZC5lbWl0KGV2ZW50KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgb25Db2x1bW5Tb3J0ZWQoZXZlbnQ6IHsgc29ydE5hbWU6IHN0cmluZzsgc29ydE9yZGVyOiBhbnkgfSkge1xyXG4gICAgICAgIGNvbnN0IHsgc29ydE5hbWUsIHNvcnRPcmRlciB9ID0geyAuLi5ldmVudCB9O1xyXG4gICAgICAgIHRoaXMuZ2V0RGF0YSh7IHNvcnROYW1lLCBzb3J0T3JkZXIgfSwgJ3NlYXJjaCcpLnN1YnNjcmliZShkYXRhID0+IHtcclxuICAgICAgICAgICAgdGhpcy5jb21ib1NlcnZpY2UubG9hZExvb2tVcERhdGFUYWJsZShkYXRhLCB0cnVlKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBvbkNsZWFyKCkge1xyXG4gICAgICAgIHRoaXMub3duU2VsZWN0aW9ucyA9IFtdO1xyXG4gICAgICAgIGlmICh0aGlzLmlzVHJlZSgpICYmIHRoaXMudHJlZUNtcFJlZikge1xyXG4gICAgICAgICAgICB0aGlzLnRyZWVDbXBSZWYuY2xlYXJBbGwoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgc3VwZXIub25DbGVhcigpO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgZ2V0Q2hpbGRyZW4oIHBhcmVudFBhdGgscGFyZW50TGF5ZXIsc2VhcmNoRGF0YTogeyBzZWFyY2hGaWVsZDogc3RyaW5nOyBzZWFyY2hWYWx1ZTogc3RyaW5nIH0pIHtcclxuICAgICAgICBjb25zdCBzZWFyY2ggPSB7IHBhcmVudExheWVyLCBjYXRlZ29yeTogJ2NoaWxkcmVuJywgLi4uc2VhcmNoRGF0YSB9O1xyXG4gICAgICAgIGlmICh0aGlzLnRyZWVJbmZvLmxheWVyVHlwZSA9PT0gJ3BhcmVudElkJykge1xyXG4gICAgICAgICAgICBzZWFyY2hbJ3BhcmVudElkJ10gPSBwYXJlbnRQYXRoO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHNlYXJjaFsncGFyZW50UGF0aCddID0gcGFyZW50UGF0aDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IHBhcmFtID0ge1xyXG4gICAgICAgICAgICBzZWFyY2hWYWx1ZTogSlNPTi5zdHJpbmdpZnkoc2VhcmNoKSxcclxuICAgICAgICAgICAgY3VzdG9tRGF0YTogdGhpcy5jdXN0b21EYXRhLFxyXG4gICAgICAgICAgICBlbmFibGVGdWxsVHJlZTogdGhpcy5lbmFibGVGdWxsVHJlZSxcclxuICAgICAgICAgICAgbG9hZFRyZWVEYXRhVHlwZTogdGhpcy5sb2FkVHJlZURhdGFUeXBlXHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgaWYgKHRoaXMuX3NlYXJjaEtleVdvcmRzKSB7XHJcbiAgICAgICAgICAgIHBhcmFtLmVuYWJsZUZ1bGxUcmVlID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHBhcmFtLmxvYWRUcmVlRGF0YVR5cGUgPSAnbGF5ZXJsb2FkJztcclxuXHJcbiAgICAgICAgICAgIGlmICh0aGlzLnRyZWVJbmZvLmxheWVyVHlwZSA9PT0gJ3BhcmVudElkJykge1xyXG4gICAgICAgICAgICAgICAgLy8g5qCR5b2i5biu5Yqp5p+l6K+i5ZCO77yM5bGV5byA6IqC54K55pe25bCG55u45YWz5p+l6K+i5Y+C5pWw5Lyg6YCS5Yiw5ZCO56uvIDIwMjItMDktMTNcclxuICAgICAgICAgICAgICAgIHNlYXJjaC5zZWFyY2hWYWx1ZSA9ICcnO1xyXG4gICAgICAgICAgICAgICAgc2VhcmNoLnNlYXJjaEZpZWxkID0gJyonO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHBhcmFtLnNlYXJjaFZhbHVlID0gSlNPTi5zdHJpbmdpZnkoc2VhcmNoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IHR0ID0gdGhpcy50cmVlQ21wUmVmIGFzIFRyZWVUYWJsZUNvbXBvbmVudDtcclxuICAgICAgICBpZiAodHQgJiYgdHQuc29ydE5hbWUpIHtcclxuICAgICAgICAgICAgT2JqZWN0LmFzc2lnbihwYXJhbSwge1xyXG4gICAgICAgICAgICAgICAgc29ydE5hbWU6IHR0LnNvcnROYW1lLFxyXG4gICAgICAgICAgICAgICAgc29ydE9yZGVyOiB0dC5zb3J0T3JkZXJcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0aGlzLmNvbWJvU2VydmljZS5nZXREYXRhKHBhcmFtLCAnZ2V0JywgdHJ1ZSk7XHJcbiAgICB9XHJcblxyXG5cclxuICAgIGdldERhdGEoZXZlbnQ/OiBhbnksIHR5cGUgPSAnYWxsJykge1xyXG4gICAgICAgIGV2ZW50ID0gZXZlbnQgfHwge307XHJcbiAgICAgICAgaWYgKHRoaXMuX3NlYXJjaEtleVdvcmRzKSB7XHJcbiAgICAgICAgICAgIGV2ZW50LnNlYXJjaCA9IHtcclxuICAgICAgICAgICAgICAgIGZpZWxkOiAnKicsXHJcbiAgICAgICAgICAgICAgICB2YWx1ZTogdGhpcy5fc2VhcmNoS2V5V29yZHNcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IHBhcmFtcyA9IHRoaXMuYnVpbGRRdWVyeVBhcmFtcyhldmVudCwgdHlwZSk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuY29tYm9TZXJ2aWNlLmdldERhdGEocGFyYW1zKTtcclxuICAgIH1cclxuXHJcbiAgICAvKiog5p6E6YCJ5p+l6K+i5Y+C5pWwICovXHJcbiAgICBwcml2YXRlIGJ1aWxkUXVlcnlQYXJhbXMoZXZlbnQ/OiBhbnksIHR5cGUgPSAnYWxsJykge1xyXG4gICAgICAgIGNvbnN0IHBhcmFtczogYW55ID0ge307XHJcblxyXG4gICAgICAgIGNvbnN0IHNlYXJjaFBhcmFtID0geyBjYXRlZ29yeTogdHlwZSB9O1xyXG4gICAgICAgIGlmIChldmVudCkge1xyXG4gICAgICAgICAgICBpZiAoZXZlbnQucGFnZUluZm8pIHtcclxuICAgICAgICAgICAgICAgIHBhcmFtc1sncGFnZUluZGV4J10gPSBldmVudC5wYWdlSW5mby5wYWdlSW5kZXg7XHJcbiAgICAgICAgICAgICAgICBwYXJhbXNbJ3BhZ2VTaXplJ10gPSBldmVudC5wYWdlSW5mby5wYWdlU2l6ZTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKGV2ZW50LnNlYXJjaCkge1xyXG4gICAgICAgICAgICAgICAgc2VhcmNoUGFyYW1bJ3NlYXJjaEZpZWxkJ10gPSBldmVudC5zZWFyY2guZmllbGQ7XHJcbiAgICAgICAgICAgICAgICBzZWFyY2hQYXJhbVsnc2VhcmNoVmFsdWUnXSA9IGV2ZW50LnNlYXJjaC52YWx1ZTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKGV2ZW50LnNvcnROYW1lKSB7XHJcbiAgICAgICAgICAgICAgICBzZWFyY2hQYXJhbVsnc29ydE5hbWUnXSA9IGV2ZW50LnNvcnROYW1lO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChldmVudC5zb3J0T3JkZXIpIHtcclxuICAgICAgICAgICAgICAgIHNlYXJjaFBhcmFtWydzb3J0T3JkZXInXSA9IGV2ZW50LnNvcnRPcmRlcjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcGFyYW1zWydzZWFyY2hWYWx1ZSddID0gSlNPTi5zdHJpbmdpZnkoc2VhcmNoUGFyYW0pO1xyXG4gICAgICAgIGlmICh0aGlzLmN1c3RvbURhdGEpIHtcclxuICAgICAgICAgICAgcGFyYW1zWydjdXN0b21EYXRhJ10gPSB0aGlzLmN1c3RvbURhdGE7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gcGFyYW1zO1xyXG4gICAgfVxyXG5cclxuICAgIGZpbHRlckRhdGFPblNlcnZlcih2YWx1ZSwgZmllbGQpIHtcclxuICAgICAgICBsZXQgc2VhcmNoID0geyBzZWFyY2g6IHsgZmllbGQsIHZhbHVlIH19O1xyXG4gICAgICAgIGlmICh2YWx1ZSkge1xyXG4gICAgICAgICAgICB0aGlzLl9zZWFyY2hLZXlXb3JkcyA9IHZhbHVlO1xyXG5cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLl9zZWFyY2hLZXlXb3JkcyA9ICcnO1xyXG4gICAgICAgICAgICBzZWFyY2ggPSBudWxsO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3QgcGFyYW1zID0gdGhpcy5idWlsZFF1ZXJ5UGFyYW1zKHNlYXJjaCwgJ3NlYXJjaCcgKTtcclxuICAgICAgICBpZiAoIXRoaXMuaXNPcGVuKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLm5vc2VhcmNoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5pc09wZW4gPSB0cnVlO1xyXG4gICAgICAgICAgICB0aGlzLmNvbWJvU2VydmljZS5pc09wZW4kLm5leHQoeyBpc09wZW46IHRoaXMuaXNPcGVuLCBzZWFyY2g6IHBhcmFtc30pO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIHRoaXMuY29tYm9TZXJ2aWNlLnNlcmFjaFZhbHVlJC5uZXh0KHBhcmFtcyk7XHJcbiAgICB9XHJcblxyXG4gICAgb25FeHBhbmROb2RlKHRuOiBUcmVlTm9kZSkge1xyXG4gICAgICAgIGlmICh0bi5sZWFmIHx8ICB0blsnc2hvd0xvYWRpbmcnXSkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoIXRuLmNoaWxkcmVuIHx8ICF0bi5jaGlsZHJlbi5sZW5ndGgpIHtcclxuICAgICAgICAgICAgbGV0IHBhcmVudFBhdGggPSAnJztcclxuICAgICAgICAgICAgbGV0IHBhcmVudExheWVyID0gLTE7XHJcbiAgICAgICAgICAgIGNvbnN0IHsgZmllbGQgPSAnKicsIHZhbHVlID0gJycgfSA9IHtcclxuICAgICAgICAgICAgICAgIHZhbHVlOiB0aGlzLl9zZWFyY2hLZXlXb3Jkc1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICBjb25zdCB0cmVlSW5mb0ZpZWxkID0gdGhpcy50cmVlSW5mby5kYXRhRmllbGQ7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLnRyZWVJbmZvLmxheWVyVHlwZSA9PT0gJ3BhcmVudElkJykge1xyXG4gICAgICAgICAgICAgICAgLy8g54i2SUTliqDovb3mlrnlvI9cclxuICAgICAgICAgICAgICAgIHBhcmVudFBhdGggPSB0blsnaWQnXTtcclxuICAgICAgICAgICAgICAgIHBhcmVudExheWVyID0gdG4uZGF0YVt0cmVlSW5mb0ZpZWxkXVt0aGlzLnRyZWVJbmZvLmxheWVyRmllbGRdO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRyZWVJbmZvRmllbGQpIHtcclxuICAgICAgICAgICAgICAgICAgICBwYXJlbnRQYXRoID0gdG4uZGF0YVt0cmVlSW5mb0ZpZWxkXVt0aGlzLnRyZWVJbmZvLnBhdGhGaWVsZF07XHJcbiAgICAgICAgICAgICAgICAgICAgcGFyZW50TGF5ZXIgPSB0bi5kYXRhW3RyZWVJbmZvRmllbGRdW3RoaXMudHJlZUluZm8ubGF5ZXJGaWVsZF07XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMudHJlZUNtcFJlZi53cml0ZUNvbnNvbGUoJ+acquaJvuWIsOWIhue6p+S/oeaBr+OAgicpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB0aGlzLmdldENoaWxkcmVuKHBhcmVudFBhdGgsIHBhcmVudExheWVyLCB7XHJcbiAgICAgICAgICAgICAgICBzZWFyY2hGaWVsZDogZmllbGQgPT09ICcqJyA/ICcqJyA6IGZpZWxkLFxyXG4gICAgICAgICAgICAgICAgc2VhcmNoVmFsdWU6IHZhbHVlXHJcbiAgICAgICAgICAgIH0pLnN1YnNjcmliZShkYXRhID0+IHtcclxuICAgICAgICAgICAgICAgIGlmICh0biAmJiBkYXRhLml0ZW1zICYmIGRhdGEuaXRlbXMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgbm9kZXMgPSB0aGlzLmNvbWJvU2VydmljZS5jaGVja05vZGVDYW5CZVNlbGVjdChkYXRhLml0ZW1zLCBmYWxzZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy50cmVlQ21wUmVmLmFwcGVuZENoaWxkcmVuKG5vZGVzLCB0bik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0aGlzLnRyZWVDbXBSZWYuZGV0ZWN0Q2hhbmdlcygpO1xyXG5cclxuICAgICAgICAgICAgICAgIC8vIGlmICh0aGlzLnNlbGVjdGVkVmFsdWVzICYmIHRoaXMuc2VsZWN0ZWRWYWx1ZXMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgdGhpcy50cmVlQ21wUmVmLmNoZWNrZWROb2Rlcyh0aGlzLnNlbGVjdGVkVmFsdWVzLnNwbGl0KCcsJykpO1xyXG4gICAgICAgICAgICAgICAgLy8gfVxyXG4gICAgICAgICAgICAgICAgY29uc3QgaWRzID0gdGhpcy5jb21ib1NlcnZpY2VbJ19fU0VMRUNURURJRFNfXyddO1xyXG4gICAgICAgICAgICAgICAgaWYgKGlkcyAmJiBpZHMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgaWRBcnIgPSBpZHMuc3BsaXQodGhpcy5zZXBhcmF0b3IpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLm11bHRpU2VsZWN0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudHJlZUNtcFJlZi5jaGVja2VkTm9kZXMoaWRBcnIpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnRyZWVDbXBSZWYuc2VsZWN0Tm9kZXMoaWRBcnIpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIHRoaXMudHJlZUNtcFJlZi5wc1JlZi5kaXJlY3RpdmVSZWYudXBkYXRlKCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwcm90ZWN0ZWQgaW5pdERhdGFzQ2hhbmdlQWN0aW9uKCkge1xyXG4gICAgICAgIHRoaXMuY29tYm9TZXJ2aWNlLmRhdGEkLnBpcGUoXHJcbiAgICAgICAgICAgIGRlbGF5KDEyMClcclxuICAgICAgICApLnN1YnNjcmliZShkYXRhID0+IHtcclxuXHJcbiAgICAgICAgICAgIC8vIOW4ruWKqeaVsOaNruW8guatpeiHquWumuS5ieWPluaVsO+8m1xyXG4gICAgICAgICAgICAvLyDluK7liqnphY3nva7nlYzpnaJcclxuICAgICAgICAgICAgaWYgKCF0aGlzLnVyaSAmJiBkYXRhICYmIGRhdGEubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZVNlbGVjdGlvbnModGhpcy5zZWxlY3RlZFZhbHVlcywgZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAvLyBURlMgNTc0MzY1XHJcbiAgICAgICAgICAgICAgICBsZXQgdHh0ID0gdGhpcy5jb21ib1NlcnZpY2UuZ2V0VmFsdWUodGhpcy50ZXh0RmllbGQpO1xyXG4gICAgICAgICAgICAgICAgdHh0ID0gdHh0ID8gdHh0IDogdGhpcy5ub3NlYXJjaCA/IHRoaXMuZGlzcGxheVRleHQ6ICcnO1xyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICB0aGlzLmRpc3BsYXlUZXh0ID0gdHh0O1xyXG4gICAgICAgICAgICAgICAgdGhpc1snb3JpZ2luYWxUZXh0J10gPSB0aGlzLmRpc3BsYXlUZXh0O1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAodGhpcy5fc2VhcmNoS2V5V29yZHMgJiYgZGF0YSAmJiBkYXRhLmxlbmd0aCAmJiAhdGhpcy5tdWx0aVNlbGVjdCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuZGlzcGxheVR5cGUgPT09ICdMT09LVVBMSVNUJykge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3RhYmxlQ21wUmVmLnNlbGVjdGlvbnMgPSBkYXRhWzBdO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3RhYmxlQ21wUmVmLmNkLmRldGVjdENoYW5nZXMoKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5kaXNwbGF5VHlwZSA9PT0gJ0xPT0tVUFRSRUVMSVNUJykge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIHRoaXMudHJlZUNtcFJlZi5zZWxlY3ROb2RlKClcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBub2RlcyA9IHRoaXMuY29tYm9TZXJ2aWNlLmNoZWNrTm9kZUNhbkJlU2VsZWN0KGRhdGEuaXRlbXMsIGZhbHNlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG59XHJcbiJdfQ==