/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, Input, HostBinding, Output, EventEmitter } from '@angular/core';
import { SolutionService } from '../../service/solution.service';
var DateRangeComponent = /** @class */ (function () {
    function DateRangeComponent(solutionService) {
        this.solutionService = solutionService;
        this.searchHandle = new EventEmitter();
        //TODO: need 2 placeholder text for date range
        // rangeDate = {
        //     begin:null,
        //     end:null
        // };
        /**
         * 判断是否是在扩展区域展示
         */
        this.extend = false;
        /**
         * 判断是否显示label
         */
        this.showlabel = true;
    }
    Object.defineProperty(DateRangeComponent.prototype, "isExtend", {
        get: /**
         * @return {?}
         */
        function () {
            return !this.extend && this.autoLabel;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(DateRangeComponent.prototype, "hidenLabel", {
        get: /**
         * @return {?}
         */
        function () {
            return !this.showlabel;
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    DateRangeComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        this.initDate();
        if (this.item) {
            this.beginPlaceHolder = this.item.beginPlaceHolder || '';
            this.endPlaceHolder = this.item.endPlaceHolder || '';
            // const type = Object.prototype.toString.call(this.item.placeHolder);
            // if(type == '[object Undefined]'){
            //     if(this.item.control && this.item.control.hasOwnProperty('placeholder')){
            //         this.placeholder = this.item.control.placeholder;
            //     }
            // }
            // else{
            //     this.placeholder = this.item.placeHolder;
            // }
            // const beginplac = Object.prototype.toString.call(this.item.beginPlaceHolder);
            // if(beginplac == '[object Undefined]'){
            //     if(this.item.control && this.item.control.hasOwnProperty('placeholder')){
            //         this.beginPlaceHolder = this.item.control.beginPlaceHolder;
            //     }
            // }
            // else{
            //     this.beginPlaceHolder = this.item.beginPlaceHolder;
            // }
            // const endplac = Object.prototype.toString.call(this.item.endPlaceHolder);
            // if(endplac == '[object Undefined]'){
            //     if(this.item.control && this.item.control.hasOwnProperty('placeholder')){
            //         this.endPlaceHolder = this.item.control.endPlaceHolder;
            //     }
            // }
            // else{
            //     this.endPlaceHolder = this.item.endPlaceHolder;
            // }
        }
    };
    /**
     * @return {?}
     */
    DateRangeComponent.prototype.ngOnChanges = /**
     * @return {?}
     */
    function () {
        this.initDate();
    };
    /**
     * @return {?}
     */
    DateRangeComponent.prototype.initDate = /**
     * @return {?}
     */
    function () {
        // if(this.item && this.item.control && this.item.control.hasOwnProperty('format') && this.item.control.format){
        //     this.dateFormat = this.item.control.format;
        //     if(this.showTime){
        //         if(this.dateFormat.length > 0 && this.dateFormat.indexOf('HH:mm') == -1){
        //             this.dateFormat = this.dateFormat + ' HH:mm:ss';
        //         }
        //     }
        // }
        // else{
        //     this.dateFormat = this.showTime? 'yyyy-MM-dd HH:mm:ss':'yyyy-MM-dd';
        // }
        if (this.item && this.item.control && this.item.control.hasOwnProperty('format')) {
            /** @type {?} */
            var itemDateFormat = this.item.control.format;
            if (this.showTime) {
                if (itemDateFormat.length > 0 && itemDateFormat.indexOf('HH:mm') == -1) {
                    itemDateFormat = itemDateFormat + ' HH:mm:ss';
                }
            }
            /** @type {?} */
            var format = this.showTime ? 'yyyy-MM-dd HH:mm:ss' : (this.showType == '2' ? 'yyyy-MM' : (this.showType == '3' ? 'yyyy' : 'yyyy-MM-dd'));
            this.dateFormat = itemDateFormat ? itemDateFormat : format;
        }
        /** @type {?} */
        var rangeDateValue = this.item && this.item.value;
        if (rangeDateValue.startTime && rangeDateValue.endTime) {
            this.rangeDate = rangeDateValue.startTime + "~" + rangeDateValue.endTime;
        }
    };
    /**
     * @param {?} dateString
     * @return {?}
     */
    DateRangeComponent.prototype.getDate = /**
     * @param {?} dateString
     * @return {?}
     */
    function (dateString) {
        // let arr1:Array<any> = dateString.split(" "); 
        // let sdate = arr1[0].split('-'); 
        // let date = new Date(sdate[0], sdate[1]-1, sdate[2]);
        /** @type {?} */
        var date = new Date(dateString);
        return date;
    };
    /**
     * @param {?} event
     * @return {?}
     */
    DateRangeComponent.prototype.onDateChange = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        if (event.returnFormatted) {
            ((/** @type {?} */ (this.item.value))).startTime = event.returnFormatted.split('~')[0];
            ((/** @type {?} */ (this.item.value))).endTime = event.returnFormatted.split('~')[1];
        }
        else {
            // this.item.value = new DateRangeValue();
            this.item.value.startTime = '';
            this.item.value.endTime = '';
        }
        this.item.valueText = event.formatted;
        if (this.disabled) {
            return;
        }
        this.searchHandle.emit(event);
    };
    /**
     * @param {?} field
     * @return {?}
     */
    DateRangeComponent.prototype.getConditionItemTitle = /**
     * @param {?} field
     * @return {?}
     */
    function (field) {
        return this.solutionService.getConditionItemTitle(field);
    };
    DateRangeComponent.decorators = [
        { type: Component, args: [{
                    selector: 'app-filter-daterange',
                    template: "<label class=\"col-form-label\" *ngIf=\"item && showlabel\" title=\"{{getConditionItemTitle(item)}}\">\r\n    <span class=\"farris-label-info text-danger\" *ngIf=\"item.control.required\">*</span>\r\n    <span class=\"farris-label-text\">{{item.fieldName}}</span>\r\n</label>\r\n<div class=\"farris-input-wrap\" *ngIf=\"item\">\r\n    <!-- <farris-datepicker [(ngModel)]=\"rangeDate\" [dateRange]=\"true\" [readonly]=\"disabled\" [editable]=\"false\" [returnFormat]=\"showTime ? 'yyyy-MM-dd HH:mm:ss' : 'yyyy-MM-dd'\" [dateFormat]=\"dateFormat\" (valueChange)=\"onDateChange($event)\" [beginPlaceholder]=\"beginPlaceHolder\" [endPlaceholder]=\"endPlaceHolder\" [placeholder]=\"placeholder\" [showTime]=\"showTime\"></farris-datepicker> -->\r\n\r\n    <ng-container *ngIf=\"showTime;else defaultdate\">\r\n        <farris-datepicker [(ngModel)]=\"rangeDate\" [dateRange]=\"true\" [readonly]=\"disabled\" [editable]=\"false\" [returnFormat]=\"showTime ? 'yyyy-MM-dd HH:mm:ss' : 'yyyy-MM-dd'\" [dateFormat]=\"dateFormat\" (valueChange)=\"onDateChange($event)\" [beginPlaceholder]=\"beginPlaceHolder\" [endPlaceholder]=\"endPlaceHolder\" [placeholder]=\"placeholder\" [showTime]=\"showTime\"></farris-datepicker>\r\n    </ng-container>\r\n    <ng-template #defaultdate>\r\n        <farris-datepicker [(ngModel)]=\"rangeDate\" [dateRange]=\"true\" [readonly]=\"disabled\" [editable]=\"false\" [returnFormat]=\"showTime ? 'yyyy-MM-dd HH:mm:ss': (showType == '2'? 'yyyy-MM': (showType == '3'? 'yyyy':'yyyy-MM-dd'))\" [dateFormat]=\"dateFormat\" (valueChange)=\"onDateChange($event)\" [beginPlaceholder]=\"beginPlaceHolder\" [endPlaceholder]=\"endPlaceHolder\" [placeholder]=\"placeholder\" [showType]=\"showType\"></farris-datepicker>\r\n    </ng-template>\r\n\r\n    <!-- <farris-datepicker [ngModel]=\"rangeDate\" [dateRange]=\"true\" [returnFormat]=\"'yyyy-MM-dd'\" [dateFormat]=\"item.control.format\" (ngModelChange)=\"onDateChange($event)\"></farris-datepicker> -->\r\n</div>\r\n<!-- [(ngModel)]=\"rangeDate\" -->"
                }] }
    ];
    /** @nocollapse */
    DateRangeComponent.ctorParameters = function () { return [
        { type: SolutionService }
    ]; };
    DateRangeComponent.propDecorators = {
        item: [{ type: Input }],
        autoLabel: [{ type: Input }],
        disabled: [{ type: Input }],
        showTime: [{ type: Input }],
        showType: [{ type: Input }],
        searchHandle: [{ type: Output, args: ['searchHandle',] }],
        isExtend: [{ type: HostBinding, args: ['class.filter-item-wrap',] }],
        hidenLabel: [{ type: HostBinding, args: ['class.filter-item-hiddenlabel',] }]
    };
    return DateRangeComponent;
}());
export { DateRangeComponent };
if (false) {
    /**
     * QueryCondition类型
     * @type {?}
     */
    DateRangeComponent.prototype.item;
    /** @type {?} */
    DateRangeComponent.prototype.autoLabel;
    /** @type {?} */
    DateRangeComponent.prototype.disabled;
    /** @type {?} */
    DateRangeComponent.prototype.showTime;
    /** @type {?} */
    DateRangeComponent.prototype.showType;
    /** @type {?} */
    DateRangeComponent.prototype.searchHandle;
    /** @type {?} */
    DateRangeComponent.prototype.startTime;
    /** @type {?} */
    DateRangeComponent.prototype.endTime;
    /**
     * 判断是否是在扩展区域展示
     * @type {?}
     */
    DateRangeComponent.prototype.extend;
    /**
     * 判断是否显示label
     * @type {?}
     */
    DateRangeComponent.prototype.showlabel;
    /** @type {?} */
    DateRangeComponent.prototype.rangeDate;
    /** @type {?} */
    DateRangeComponent.prototype.placeholder;
    /** @type {?} */
    DateRangeComponent.prototype.beginPlaceHolder;
    /** @type {?} */
    DateRangeComponent.prototype.endPlaceHolder;
    /** @type {?} */
    DateRangeComponent.prototype.dateFormat;
    /**
     * @type {?}
     * @private
     */
    DateRangeComponent.prototype.solutionService;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGF0ZXJhbmdlLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BmYXJyaXMvdWktZmlsdGVyLyIsInNvdXJjZXMiOlsibGliL2NvbXBvbmVudHMvZGF0ZXJhbmdlY29tcG9uZW50L2RhdGVyYW5nZS5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUFBLE9BQU8sRUFBRSxTQUFTLEVBQUUsS0FBSyxFQUFxQixXQUFXLEVBQUUsTUFBTSxFQUFFLFlBQVksRUFBQyxNQUFNLGVBQWUsQ0FBQztBQUd0RyxPQUFPLEVBQUUsZUFBZSxFQUFFLE1BQU0sZ0NBQWdDLENBQUM7QUFFakU7SUE0Q0ksNEJBQW9CLGVBQStCO1FBQS9CLG9CQUFlLEdBQWYsZUFBZSxDQUFnQjtRQTdCM0IsaUJBQVksR0FBRyxJQUFJLFlBQVksRUFBRSxDQUFDOzs7Ozs7Ozs7UUFVMUQsV0FBTSxHQUFXLEtBQUssQ0FBQzs7OztRQUV2QixjQUFTLEdBQVcsSUFBSSxDQUFDO0lBaUI0QixDQUFDO0lBVHRELHNCQUNJLHdDQUFROzs7O1FBRFo7WUFFSSxPQUFPLENBQUMsSUFBSSxDQUFDLE1BQU0sSUFBSSxJQUFJLENBQUMsU0FBUyxDQUFDO1FBQzFDLENBQUM7OztPQUFBO0lBQ0Qsc0JBQ0ksMENBQVU7Ozs7UUFEZDtZQUVJLE9BQU8sQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDO1FBQzNCLENBQUM7OztPQUFBOzs7O0lBSUQscUNBQVE7OztJQUFSO1FBQ0ksSUFBSSxDQUFDLFFBQVEsRUFBRSxDQUFDO1FBQ2hCLElBQUcsSUFBSSxDQUFDLElBQUksRUFBQztZQUNULElBQUksQ0FBQyxnQkFBZ0IsR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDLGdCQUFnQixJQUFJLEVBQUUsQ0FBQztZQUN6RCxJQUFJLENBQUMsY0FBYyxHQUFHLElBQUksQ0FBQyxJQUFJLENBQUMsY0FBYyxJQUFJLEVBQUUsQ0FBQztZQUNyRCxzRUFBc0U7WUFDdEUsb0NBQW9DO1lBQ3BDLGdG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cHV0LCBPbkluaXQsIE9uQ2hhbmdlcywgSG9zdEJpbmRpbmcsIE91dHB1dCwgRXZlbnRFbWl0dGVyfSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgUXVlcnlDb25kaXRpb24gfSBmcm9tICcuLi8uLi9lbnRpdHkvcXVlcnljb25kaXRpb24nO1xyXG5pbXBvcnQgeyBEYXRlUmFuZ2VWYWx1ZSB9IGZyb20gJy4uLy4uL2VudGl0eS9jb25kaXRpb252YWx1ZS9kYXRlcmFuZ2V2YWx1ZSc7XHJcbmltcG9ydCB7IFNvbHV0aW9uU2VydmljZSB9IGZyb20gJy4uLy4uL3NlcnZpY2Uvc29sdXRpb24uc2VydmljZSc7XHJcblxyXG5AQ29tcG9uZW50KHtcclxuICAgIHNlbGVjdG9yOiAnYXBwLWZpbHRlci1kYXRlcmFuZ2UnLFxyXG4gICAgdGVtcGxhdGVVcmw6ICcuL2RhdGVyYW5nZS5jb21wb25lbnQuaHRtbCdcclxufSlcclxuXHJcbmV4cG9ydCBjbGFzcyBEYXRlUmFuZ2VDb21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQsT25DaGFuZ2Vze1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogUXVlcnlDb25kaXRpb27nsbvlnotcclxuICAgICAqL1xyXG4gICAgQElucHV0KCkgaXRlbTphbnk7XHJcbiAgICBASW5wdXQoKSBhdXRvTGFiZWw6Ym9vbGVhbjtcclxuICAgIEBJbnB1dCgpIGRpc2FibGVkOmJvb2xlYW47XHJcbiAgICBASW5wdXQoKSBzaG93VGltZTpib29sZWFuO1xyXG4gICAgQElucHV0KCkgc2hvd1R5cGU6c3RyaW5nO1xyXG4gICAgQE91dHB1dCgnc2VhcmNoSGFuZGxlJykgc2VhcmNoSGFuZGxlID0gbmV3IEV2ZW50RW1pdHRlcigpO1xyXG5cclxuICAgIHN0YXJ0VGltZTpEYXRlO1xyXG4gICAgZW5kVGltZTpEYXRlO1xyXG4gICAgLy9UT0RPOiBuZWVkIDIgcGxhY2Vob2xkZXIgdGV4dCBmb3IgZGF0ZSByYW5nZVxyXG4gICAgLy8gcmFuZ2VEYXRlID0ge1xyXG4gICAgLy8gICAgIGJlZ2luOm51bGwsXHJcbiAgICAvLyAgICAgZW5kOm51bGxcclxuICAgIC8vIH07XHJcbiAgICAvKirliKTmlq3mmK/lkKbmmK/lnKjmianlsZXljLrln5/lsZXnpLogKi9cclxuICAgIGV4dGVuZDpib29sZWFuID0gZmFsc2U7XHJcbiAgICAvKirliKTmlq3mmK/lkKbmmL7npLpsYWJlbCAqL1xyXG4gICAgc2hvd2xhYmVsOmJvb2xlYW4gPSB0cnVlO1xyXG5cclxuICAgIHJhbmdlRGF0ZTogc3RyaW5nO1xyXG4gICAgcGxhY2Vob2xkZXI6IHN0cmluZztcclxuICAgIGJlZ2luUGxhY2VIb2xkZXI6c3RyaW5nO1xyXG4gICAgZW5kUGxhY2VIb2xkZXI6c3RyaW5nO1xyXG4gICAgZGF0ZUZvcm1hdDpzdHJpbmc7XHJcblxyXG4gICAgQEhvc3RCaW5kaW5nKCdjbGFzcy5maWx0ZXItaXRlbS13cmFwJylcclxuICAgIGdldCBpc0V4dGVuZCgpOiBib29sZWFuIHtcclxuICAgICAgICByZXR1cm4gIXRoaXMuZXh0ZW5kICYmIHRoaXMuYXV0b0xhYmVsO1xyXG4gICAgfVxyXG4gICAgQEhvc3RCaW5kaW5nKCdjbGFzcy5maWx0ZXItaXRlbS1oaWRkZW5sYWJlbCcpXHJcbiAgICBnZXQgaGlkZW5MYWJlbCgpOiBib29sZWFuIHtcclxuICAgICAgICByZXR1cm4gIXRoaXMuc2hvd2xhYmVsO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0cnVjdG9yKHByaXZhdGUgc29sdXRpb25TZXJ2aWNlOlNvbHV0aW9uU2VydmljZSl7fVxyXG5cclxuICAgIG5nT25Jbml0KCk6IHZvaWQge1xyXG4gICAgICAgIHRoaXMuaW5pdERhdGUoKTtcclxuICAgICAgICBpZih0aGlzLml0ZW0pe1xyXG4gICAgICAgICAgICB0aGlzLmJlZ2luUGxhY2VIb2xkZXIgPSB0aGlzLml0ZW0uYmVnaW5QbGFjZUhvbGRlciB8fCAnJztcclxuICAgICAgICAgICAgdGhpcy5lbmRQbGFjZUhvbGRlciA9IHRoaXMuaXRlbS5lbmRQbGFjZUhvbGRlciB8fCAnJztcclxuICAgICAgICAgICAgLy8gY29uc3QgdHlwZSA9IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbCh0aGlzLml0ZW0ucGxhY2VIb2xkZXIpO1xyXG4gICAgICAgICAgICAvLyBpZih0eXBlID09ICdbb2JqZWN0IFVuZGVmaW5lZF0nKXtcclxuICAgICAgICAgICAgLy8gICAgIGlmKHRoaXMuaXRlbS5jb250cm9sICYmIHRoaXMuaXRlbS5jb250cm9sLmhhc093blByb3BlcnR5KCdwbGFjZWhvbGRlcicpKXtcclxuICAgICAgICAgICAgLy8gICAgICAgICB0aGlzLnBsYWNlaG9sZGVyID0gdGhpcy5pdGVtLmNvbnRyb2wucGxhY2Vob2xkZXI7XHJcbiAgICAgICAgICAgIC8vICAgICB9XHJcbiAgICAgICAgICAgIC8vIH1cclxuICAgICAgICAgICAgLy8gZWxzZXtcclxuICAgICAgICAgICAgLy8gICAgIHRoaXMucGxhY2Vob2xkZXIgPSB0aGlzLml0ZW0ucGxhY2VIb2xkZXI7XHJcbiAgICAgICAgICAgIC8vIH1cclxuICAgICAgICAgICAgLy8gY29uc3QgYmVnaW5wbGFjID0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKHRoaXMuaXRlbS5iZWdpblBsYWNlSG9sZGVyKTtcclxuICAgICAgICAgICAgLy8gaWYoYmVnaW5wbGFjID09ICdbb2JqZWN0IFVuZGVmaW5lZF0nKXtcclxuICAgICAgICAgICAgLy8gICAgIGlmKHRoaXMuaXRlbS5jb250cm9sICYmIHRoaXMuaXRlbS5jb250cm9sLmhhc093blByb3BlcnR5KCdwbGFjZWhvbGRlcicpKXtcclxuICAgICAgICAgICAgLy8gICAgICAgICB0aGlzLmJlZ2luUGxhY2VIb2xkZXIgPSB0aGlzLml0ZW0uY29udHJvbC5iZWdpblBsYWNlSG9sZGVyO1xyXG4gICAgICAgICAgICAvLyAgICAgfVxyXG4gICAgICAgICAgICAvLyB9XHJcbiAgICAgICAgICAgIC8vIGVsc2V7XHJcbiAgICAgICAgICAgIC8vICAgICB0aGlzLmJlZ2luUGxhY2VIb2xkZXIgPSB0aGlzLml0ZW0uYmVnaW5QbGFjZUhvbGRlcjtcclxuICAgICAgICAgICAgLy8gfVxyXG4gICAgICAgICAgICAvLyBjb25zdCBlbmRwbGFjID0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKHRoaXMuaXRlbS5lbmRQbGFjZUhvbGRlcik7XHJcbiAgICAgICAgICAgIC8vIGlmKGVuZHBsYWMgPT0gJ1tvYmplY3QgVW5kZWZpbmVkXScpe1xyXG4gICAgICAgICAgICAvLyAgICAgaWYodGhpcy5pdGVtLmNvbnRyb2wgJiYgdGhpcy5pdGVtLmNvbnRyb2wuaGFzT3duUHJvcGVydHkoJ3BsYWNlaG9sZGVyJykpe1xyXG4gICAgICAgICAgICAvLyAgICAgICAgIHRoaXMuZW5kUGxhY2VIb2xkZXIgPSB0aGlzLml0ZW0uY29udHJvbC5lbmRQbGFjZUhvbGRlcjtcclxuICAgICAgICAgICAgLy8gICAgIH1cclxuICAgICAgICAgICAgLy8gfVxyXG4gICAgICAgICAgICAvLyBlbHNle1xyXG4gICAgICAgICAgICAvLyAgICAgdGhpcy5lbmRQbGFjZUhvbGRlciA9IHRoaXMuaXRlbS5lbmRQbGFjZUhvbGRlcjtcclxuICAgICAgICAgICAgLy8gfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBuZ09uQ2hhbmdlcygpOiB2b2lkIHtcclxuICAgICAgICB0aGlzLmluaXREYXRlKCk7XHJcbiAgICB9XHJcblxyXG4gICAgaW5pdERhdGUoKXtcclxuICAgICAgICAvLyBpZih0aGlzLml0ZW0gJiYgdGhpcy5pdGVtLmNvbnRyb2wgJiYgdGhpcy5pdGVtLmNvbnRyb2wuaGFzT3duUHJvcGVydHkoJ2Zvcm1hdCcpICYmIHRoaXMuaXRlbS5jb250cm9sLmZvcm1hdCl7XHJcbiAgICAgICAgLy8gICAgIHRoaXMuZGF0ZUZvcm1hdCA9IHRoaXMuaXRlbS5jb250cm9sLmZvcm1hdDtcclxuICAgICAgICAvLyAgICAgaWYodGhpcy5zaG93VGltZSl7XHJcbiAgICAgICAgLy8gICAgICAgICBpZih0aGlzLmRhdGVGb3JtYXQubGVuZ3RoID4gMCAmJiB0aGlzLmRhdGVGb3JtYXQuaW5kZXhPZignSEg6bW0nKSA9PSAtMSl7XHJcbiAgICAgICAgLy8gICAgICAgICAgICAgdGhpcy5kYXRlRm9ybWF0ID0gdGhpcy5kYXRlRm9ybWF0ICsgJyBISDptbTpzcyc7XHJcbiAgICAgICAgLy8gICAgICAgICB9XHJcbiAgICAgICAgLy8gICAgIH1cclxuICAgICAgICAvLyB9XHJcbiAgICAgICAgLy8gZWxzZXtcclxuICAgICAgICAvLyAgICAgdGhpcy5kYXRlRm9ybWF0ID0gdGhpcy5zaG93VGltZT8gJ3l5eXktTU0tZGQgSEg6bW06c3MnOid5eXl5LU1NLWRkJztcclxuICAgICAgICAvLyB9XHJcbiAgICAgICAgaWYodGhpcy5pdGVtICYmIHRoaXMuaXRlbS5jb250cm9sICYmIHRoaXMuaXRlbS5jb250cm9sLmhhc093blByb3BlcnR5KCdmb3JtYXQnKSl7XHJcbiAgICAgICAgICAgIGxldCBpdGVtRGF0ZUZvcm1hdCA9IHRoaXMuaXRlbS5jb250cm9sLmZvcm1hdDtcclxuICAgICAgICAgICAgaWYodGhpcy5zaG93VGltZSl7XHJcbiAgICAgICAgICAgICAgICBpZihpdGVtRGF0ZUZvcm1hdC5sZW5ndGggPiAwICYmIGl0ZW1EYXRlRm9ybWF0LmluZGV4T2YoJ0hIOm1tJykgPT0gLTEpe1xyXG4gICAgICAgICAgICAgICAgICAgIGl0ZW1EYXRlRm9ybWF0ID0gaXRlbURhdGVGb3JtYXQgKyAnIEhIOm1tOnNzJztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjb25zdCBmb3JtYXQgPSB0aGlzLnNob3dUaW1lID8gJ3l5eXktTU0tZGQgSEg6bW06c3MnOiAodGhpcy5zaG93VHlwZSA9PSAnMic/ICd5eXl5LU1NJzogKHRoaXMuc2hvd1R5cGUgPT0gJzMnPyAneXl5eSc6J3l5eXktTU0tZGQnKSk7XHJcbiAgICAgICAgICAgIHRoaXMuZGF0ZUZvcm1hdCA9IGl0ZW1EYXRlRm9ybWF0P2l0ZW1EYXRlRm9ybWF0OmZvcm1hdDtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgcmFuZ2VEYXRlVmFsdWUgOiBEYXRlUmFuZ2VWYWx1ZSA9IHRoaXMuaXRlbSAmJiB0aGlzLml0ZW0udmFsdWU7XHJcbiAgICAgICAgaWYocmFuZ2VEYXRlVmFsdWUuc3RhcnRUaW1lICYmIHJhbmdlRGF0ZVZhbHVlLmVuZFRpbWUpe1xyXG4gICAgICAgICAgICB0aGlzLnJhbmdlRGF0ZSA9IGAke3JhbmdlRGF0ZVZhbHVlLnN0YXJ0VGltZX1+JHtyYW5nZURhdGVWYWx1ZS5lbmRUaW1lfWA7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGdldERhdGUoZGF0ZVN0cmluZzpEYXRlKTpEYXRle1xyXG4gICAgICAgIC8vIGxldCBhcnIxOkFycmF5PGFueT4gPSBkYXRlU3RyaW5nLnNwbGl0KFwiIFwiKTsgXHJcbiAgICAgICAgLy8gbGV0IHNkYXRlID0gYXJyMVswXS5zcGxpdCgnLScpOyBcclxuICAgICAgICAvLyBsZXQgZGF0ZSA9IG5ldyBEYXRlKHNkYXRlWzBdLCBzZGF0ZVsxXS0xLCBzZGF0ZVsyXSk7XHJcbiAgICAgICAgbGV0IGRhdGUgPSBuZXcgRGF0ZShkYXRlU3RyaW5nKTsgXHJcbiAgICAgICAgcmV0dXJuIGRhdGU7XHJcbiAgICB9XHJcbiAgIFxyXG4gICAgb25EYXRlQ2hhbmdlKGV2ZW50OmFueSl7XHJcbiAgICAgICAgaWYoZXZlbnQucmV0dXJuRm9ybWF0dGVkKXtcclxuICAgICAgICAgICAgKHRoaXMuaXRlbS52YWx1ZSBhcyBEYXRlUmFuZ2VWYWx1ZSkuc3RhcnRUaW1lID0gZXZlbnQucmV0dXJuRm9ybWF0dGVkLnNwbGl0KCd+JylbMF07XHJcbiAgICAgICAgICAgICh0aGlzLml0ZW0udmFsdWUgYXMgRGF0ZVJhbmdlVmFsdWUpLmVuZFRpbWUgPSBldmVudC5yZXR1cm5Gb3JtYXR0ZWQuc3BsaXQoJ34nKVsxXTtcclxuICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgLy8gdGhpcy5pdGVtLnZhbHVlID0gbmV3IERhdGVSYW5nZVZhbHVlKCk7XHJcbiAgICAgICAgICAgIHRoaXMuaXRlbS52YWx1ZS5zdGFydFRpbWUgPSAnJztcclxuICAgICAgICAgICAgdGhpcy5pdGVtLnZhbHVlLmVuZFRpbWUgPSAnJztcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5pdGVtLnZhbHVlVGV4dCA9IGV2ZW50LmZvcm1hdHRlZDtcclxuICAgICAgICBpZih0aGlzLmRpc2FibGVkKXtyZXR1cm47fVxyXG4gICAgICAgIHRoaXMuc2VhcmNoSGFuZGxlLmVtaXQoZXZlbnQpO1xyXG4gICAgfVxyXG4gICAgZ2V0Q29uZGl0aW9uSXRlbVRpdGxlKGZpZWxkOlF1ZXJ5Q29uZGl0aW9uKXtcclxuICAgICAgICByZXR1cm4gdGhpcy5zb2x1dGlvblNlcnZpY2UuZ2V0Q29uZGl0aW9uSXRlbVRpdGxlKGZpZWxkKTtcclxuICAgIH1cclxufSJdfQ==