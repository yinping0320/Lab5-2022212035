/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, Input, Output, EventEmitter, TemplateRef, Optional } from '@angular/core';
import { LocaleService } from '@farris/ui-locale';
import { DomSanitizer } from '@angular/platform-browser';
var VerifyDetailComponent = /** @class */ (function () {
    function VerifyDetailComponent(localeService, sanitizer) {
        this.localeService = localeService;
        this.sanitizer = sanitizer;
        // 追加结果提示模板
        this.resultTipsTmpl = null;
        //@Input() maxHeight:number;
        //@Input() validatorList;
        //表单验证分组信息
        //@Input() tabList:tabListItem[];
        //表单验证默认显示的分组信息
        this.showType = '';
        //是否默认显示验证信息列表
        this.showList = false;
        //验证信息点击
        this.validatorClick = new EventEmitter();
        //验证详情显示隐藏事件
        this.listshowChange = new EventEmitter();
        //showList = false;
        //处理后带分组的表单验证信息
        this.errorLists = [];
        //默认传入的表单验证信息数组
        this._validatorList = [];
        //列表部分最大高度
        this._maxHeight = 60;
    }
    Object.defineProperty(VerifyDetailComponent.prototype, "maxHeight", {
        get: /**
         * @return {?}
         */
        function () {
            return this._maxHeight;
        },
        //最大高度
        set: 
        //最大高度
        /**
         * @param {?} num
         * @return {?}
         */
        function (num) {
            if (num < 50)
                return;
            this._maxHeight = num - 50;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(VerifyDetailComponent.prototype, "tabList", {
        get: /**
         * @return {?}
         */
        function () {
            return this._tablist;
        },
        set: /**
         * @param {?} item
         * @return {?}
         */
        function (item) {
            if (item) {
                this._tablist = item;
            }
            else {
                /** @type {?} */
                var allTitle = this.localeService.getValue('verifyDetail.vertifyTypeAll');
                /** @type {?} */
                var errorTitle = this.localeService.getValue('verifyDetail.vertifyTypeError');
                /** @type {?} */
                var emptyTitle = this.localeService.getValue('verifyDetail.vertifyTypeEmpty');
                this._tablist = [
                    {
                        id: 'vertifyType1',
                        type: 'all',
                        title: allTitle
                    },
                    {
                        id: 'vertifyType2',
                        type: 'error',
                        title: errorTitle
                    },
                    {
                        id: 'vertifyType3',
                        type: 'empty',
                        title: emptyTitle
                    }
                ];
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(VerifyDetailComponent.prototype, "validatorList", {
        get: /**
         * @return {?}
         */
        function () {
            return this._validatorList;
        },
        set: /**
         * @param {?} obj
         * @return {?}
         */
        function (obj) {
            var _this = this;
            this._validatorList = obj;
            this.errorLists = [];
            if (this.tabList && this.tabList.length) {
                this.tabList.forEach((/**
                 * @param {?} item
                 * @return {?}
                 */
                function (item) {
                    item.active = false;
                }));
                //判断默认展示的类型
                /** @type {?} */
                var hasTab = this.tabList.find((/**
                 * @param {?} tab
                 * @return {?}
                 */
                function (tab) {
                    return tab.type === _this.showType;
                }));
                if (this.showType === '' || !hasTab) {
                    this.showType = this.tabList[0].type;
                }
                this.tabList.forEach((/**
                 * @param {?} tab
                 * @return {?}
                 */
                function (tab) {
                    /** @type {?} */
                    var tabType = tab.type;
                    if (tabType === 'all') {
                        // 所有类型
                        /** @type {?} */
                        var listObj = {
                            'list': obj,
                            'show': false,
                            'type': tabType
                        };
                        tab.length = listObj.list.length;
                        _this.errorLists.push(listObj);
                    }
                    else {
                        /** @type {?} */
                        var hasType = _this.errorLists.find((/**
                         * @param {?} item
                         * @return {?}
                         */
                        function (item) {
                            return item.type === tabType;
                        }));
                        if (hasType) {
                            // 能找到类型
                            /** @type {?} */
                            var valList = obj.filter((/**
                             * @param {?} error
                             * @return {?}
                             */
                            function (error) {
                                return error.type === tabType;
                            }));
                            if (valList && valList.length) {
                                hasType.list = valList;
                            }
                        }
                        else {
                            // 找不到类型
                            /** @type {?} */
                            var listObj = {
                                'list': [],
                                'show': false,
                                'type': tabType
                            };
                            /** @type {?} */
                            var valList = obj.filter((/**
                             * @param {?} error
                             * @return {?}
                             */
                            function (error) {
                                return error.type === tabType;
                            }));
                            if (valList && valList.length) {
                                listObj.list = valList;
                            }
                            tab.length = listObj.list.length;
                            _this.errorLists.push(listObj);
                        }
                    }
                }));
                /** @type {?} */
                var tabObj = this.tabList.find((/**
                 * @param {?} item
                 * @return {?}
                 */
                function (item) {
                    return item.type === _this.showType;
                }));
                if (tabObj) {
                    tabObj.active = true;
                }
            }
            /** @type {?} */
            var showObj = this.errorLists.find((/**
             * @param {?} item
             * @return {?}
             */
            function (item) {
                return item.type === _this.showType;
            }));
            if (showObj) {
                showObj.show = true;
            }
        },
        enumerable: true,
        configurable: true
    });
    ;
    /**
     * @return {?}
     */
    VerifyDetailComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () { };
    //显示详情
    //显示详情
    /**
     * @return {?}
     */
    VerifyDetailComponent.prototype.show = 
    //显示详情
    /**
     * @return {?}
     */
    function () {
        this.showList = !this.showList;
        this.listshowChange.emit(this.showList);
    };
    /**点击分组切换
     * @param tab分组信息
     */
    /**
     * 点击分组切换
     * @param {?} tab
     * @return {?}
     */
    VerifyDetailComponent.prototype.showListContent = /**
     * 点击分组切换
     * @param {?} tab
     * @return {?}
     */
    function (tab) {
        if (tab.length <= 0) {
            return;
        }
        this.tabList.forEach((/**
         * @param {?} item
         * @return {?}
         */
        function (item) {
            item.active = false;
        }));
        tab.active = true;
        this.errorLists.forEach((/**
         * @param {?} item
         * @return {?}
         */
        function (item) {
            if (item.type === tab.type) {
                item.show = true;
            }
            else {
                item.show = false;
            }
        }));
    };
    /**点击关闭按钮 */
    /**
     * 点击关闭按钮
     * @return {?}
     */
    VerifyDetailComponent.prototype.close = /**
     * 点击关闭按钮
     * @return {?}
     */
    function () {
        this.showList = false;
        this.listshowChange.emit(false);
    };
    /**点击表单验证列表事件 */
    /**
     * 点击表单验证列表事件
     * @param {?} item
     * @return {?}
     */
    VerifyDetailComponent.prototype.errorClick = /**
     * 点击表单验证列表事件
     * @param {?} item
     * @return {?}
     */
    function (item) {
        this.validatorClick.emit(item);
    };
    /**
     * 样式安全化
     * @param typeInfo
     */
    /**
     * 样式安全化
     * @param {?} typeInfo
     * @return {?}
     */
    VerifyDetailComponent.prototype.getStyle = /**
     * 样式安全化
     * @param {?} typeInfo
     * @return {?}
     */
    function (typeInfo) {
        if (this.sanitizer) {
            if (typeInfo.hasOwnProperty('iconStyle') && typeInfo['iconStyle']) {
                return this.sanitizer.bypassSecurityTrustStyle(typeInfo['iconStyle']);
            }
        }
        return null;
    };
    /**
     * 判断是否有新属性
     */
    /**
     * 判断是否有新属性
     * @param {?} typeInfo
     * @return {?}
     */
    VerifyDetailComponent.prototype.hasSelfDefind = /**
     * 判断是否有新属性
     * @param {?} typeInfo
     * @return {?}
     */
    function (typeInfo) {
        if (typeInfo) {
            if (typeInfo.hasOwnProperty('iconCls') && typeInfo['iconCls']) {
                return true;
            }
            if (typeInfo.hasOwnProperty('iconStyle') && typeInfo['iconStyle']) {
                return true;
            }
        }
        return false;
    };
    VerifyDetailComponent.decorators = [
        { type: Component, args: [{
                    selector: 'farris-verify-detail',
                    template: "<div class=\"f-verify-detail\" *ngIf=\"validatorList.length > 0\">\r\n    <div class=\"f-verify-detail-content\">\r\n        <div class=\"f-verify-nums\" (click)=\"show()\">\r\n            <ng-container *ngIf=\"resultTipsTmpl\">\r\n                <ng-container [ngTemplateOutlet]=\"resultTipsTmpl\" [ngTemplateOutletContext]=\"{ $implicit: errorLists}\">\r\n                </ng-container>\r\n            </ng-container>\r\n            <ng-container *ngIf=\"!resultTipsTmpl\">\r\n                <span class=\"nums-icon f-icon f-icon-warning\"></span>\r\n                <span class=\"nums-count\">{{validatorList.length}}</span>\r\n            </ng-container>\r\n        </div>\r\n        <div class=\"f-verify-form-main\" [hidden]=\"!showList\">\r\n            <div class=\"f-verify-form-content\">\r\n                <div class=\"f-verify-form-content-arrow\"></div>\r\n                <div class=\"f-verify-form-content-list\">\r\n                    <div class=\"f-verify-forms-title\">\r\n                        <div class=\"title-tabs\">\r\n                            <div class=\"btn-group\">\r\n                                <button class=\"btn btn-secondary\" *ngFor=\"let tab of tabList\"\r\n                                    [ngClass]=\"{'active': tab.active,'disabled': (tab.length<=0)}\"\r\n                                    (click)=\"showListContent(tab)\">{{tab.title}} <span>{{tab.length}}</span></button>\r\n                            </div>\r\n                        </div>\r\n                        <div class=\"f-verify-close\" (click)=\"close()\">\r\n                            <span class=\"f-icon f-icon-close\"></span>\r\n                        </div>\r\n                    </div>\r\n                    <div class=\"f-verify-forms-list\" [ngStyle]=\"{'max-height': maxHeight+'px'}\">\r\n                        <ng-container *ngFor=\"let list of errorLists;let typeIndex = index;\">\r\n                            <ul class=\"f-verify-list-content\" *ngIf=\"list.list.length > 0\"\r\n                                [ngClass]=\"{'active': list.show}\">\r\n                                <li class=\"f-verify-list\" *ngFor=\"let item of list.list\" (click)=\"errorClick(item)\">\r\n                                    <ng-container *ngIf=\"hasSelfDefind(tabList[typeIndex])\">\r\n                                        <span class=\"f-icon f-icon-close-outline list-icon list-error\" [ngClass]=\"tabList[typeIndex]['iconCls']\" [attr.style]=\"getStyle(tabList[typeIndex])\"></span>\r\n                                    </ng-container>\r\n                                    <span *ngIf=\"!hasSelfDefind(tabList[typeIndex])\" class=\"f-icon f-icon-close-outline list-icon list-error\"\r\n                                    [ngClass]=\"{'list-warning': item.type === 'warn'}\"></span>\r\n                                    <div class=\"list-con\" >\r\n                                        <p class=\"list-title\" [attr.title]=\"item.title\">{{item.title}}</p>\r\n                                        <p class=\"list-msg\" [attr.title]=\"item.msg\">{{item.msg}}</p>\r\n                                    </div>\r\n                                </li>\r\n                            </ul>\r\n                        </ng-container>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>",
                    styles: [".f-verify-detail{position:absolute;left:14px;bottom:16px;z-index:900}.f-verify-detail .f-verify-detail-content{position:relative}.f-verify-detail .f-verify-detail-content .f-verify-form-main{position:absolute;padding-bottom:.5rem;left:0;bottom:1.75rem;width:28.125rem}.f-verify-detail .f-verify-detail-content .f-verify-form-main .f-verify-form-content{background-color:#fff;box-shadow:0 2px 8px 0 rgba(0,0,0,.15);border-radius:.125rem;width:100%}.f-verify-detail .f-verify-detail-content .f-verify-form-main .f-verify-form-content .f-verify-form-content-arrow{display:block;position:absolute;left:1.125rem;bottom:.25rem;width:.625rem;height:.625rem;background:0 0;border-style:solid;border-width:.3125rem;box-shadow:2px 2px 5px rgba(0,0,0,.08);-webkit-transform:translateX(-50%) rotate(45deg);transform:translateX(-50%) rotate(45deg);border-color:transparent #fff #fff transparent}.f-verify-detail .f-verify-detail-content .f-verify-form-main .f-verify-form-content .f-verify-form-content-list{position:relative}.f-verify-detail .f-verify-detail-content .f-verify-form-main .f-verify-form-content .f-verify-form-content-list .f-verify-forms-title{padding:.75rem .875rem}.f-verify-detail .f-verify-detail-content .f-verify-form-main .f-verify-form-content .f-verify-form-content-list .f-verify-close{position:absolute;right:.75rem;top:.625rem;color:rgba(0,0,0,.25);font-size:.75rem;cursor:pointer;width:1.25rem;height:1.25rem;line-height:1.25rem;text-align:center}.f-verify-detail .f-verify-detail-content .f-verify-form-main .f-verify-form-content .f-verify-form-content-list .f-verify-forms-list{overflow-y:auto}.f-verify-detail .f-verify-detail-content .f-verify-form-main .f-verify-form-content .f-verify-form-content-list .f-verify-forms-list .f-verify-list-content{display:none}.f-verify-detail .f-verify-detail-content .f-verify-form-main .f-verify-form-content .f-verify-form-content-list .f-verify-forms-list .f-verify-list-content.active{display:block}.f-verify-detail .f-verify-detail-content .f-verify-form-main .f-verify-form-content .f-verify-form-content-list .f-verify-forms-list .f-verify-list{cursor:pointer;position:relative;border-top:1px solid #e9e9e9;padding:.5rem .875rem .5rem 2.5rem}.f-verify-detail .f-verify-detail-content .f-verify-form-main .f-verify-form-content .f-verify-form-content-list .f-verify-forms-list .f-verify-list .list-icon{position:absolute;left:.875rem;top:.75rem;font-size:.875rem;color:#f5222d}.f-verify-detail .f-verify-detail-content .f-verify-form-main .f-verify-form-content .f-verify-form-content-list .f-verify-forms-list .f-verify-list .list-icon.list-warning{color:#faad14}.f-verify-detail .f-verify-detail-content .f-verify-form-main .f-verify-form-content .f-verify-form-content-list .f-verify-forms-list .f-verify-list .list-con p{margin-bottom:0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.f-verify-detail .f-verify-detail-content .f-verify-form-main .f-verify-form-content .f-verify-form-content-list .f-verify-forms-list .f-verify-list .list-con .list-title{font-size:.875rem;color:rgba(0,0,0,.75);line-height:1.375rem}.f-verify-detail .f-verify-detail-content .f-verify-form-main .f-verify-form-content .f-verify-form-content-list .f-verify-forms-list .f-verify-list .list-con .list-msg{font-size:.75rem;color:rgba(0,0,0,.45);line-height:1.25rem}.f-verify-detail .f-verify-nums{padding:.125rem .5rem;background:#fde5e5;box-shadow:0 1px 6px 0 rgba(0,0,0,.15);border-radius:2px;cursor:pointer}.f-verify-detail .f-verify-nums .nums-icon{margin-right:.25rem;vertical-align:middle}.f-verify-detail .f-verify-nums .nums-count{font-size:.875rem;line-height:1.25rem}"]
                }] }
    ];
    /** @nocollapse */
    VerifyDetailComponent.ctorParameters = function () { return [
        { type: LocaleService },
        { type: DomSanitizer, decorators: [{ type: Optional }] }
    ]; };
    VerifyDetailComponent.propDecorators = {
        resultTipsTmpl: [{ type: Input }],
        showType: [{ type: Input }],
        showList: [{ type: Input }],
        validatorClick: [{ type: Output, args: ['validatorClick',] }],
        listshowChange: [{ type: Output, args: ['listshowChange',] }],
        maxHeight: [{ type: Input }],
        tabList: [{ type: Input }],
        validatorList: [{ type: Input }]
    };
    return VerifyDetailComponent;
}());
export { VerifyDetailComponent };
if (false) {
    /** @type {?} */
    VerifyDetailComponent.prototype.resultTipsTmpl;
    /** @type {?} */
    VerifyDetailComponent.prototype.showType;
    /** @type {?} */
    VerifyDetailComponent.prototype.showList;
    /** @type {?} */
    VerifyDetailComponent.prototype.validatorClick;
    /** @type {?} */
    VerifyDetailComponent.prototype.listshowChange;
    /** @type {?} */
    VerifyDetailComponent.prototype.errorLists;
    /** @type {?} */
    VerifyDetailComponent.prototype._validatorList;
    /** @type {?} */
    VerifyDetailComponent.prototype._maxHeight;
    /** @type {?} */
    VerifyDetailComponent.prototype._tablist;
    /** @type {?} */
    VerifyDetailComponent.prototype.localeService;
    /**
     * @type {?}
     * @private
     */
    VerifyDetailComponent.prototype.sanitizer;
    /* Skipping unhandled member: ;*/
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidmVyaWZ5LWRldGFpbC5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZmFycmlzL3VpLXZlcmlmeS1kZXRhaWwvIiwic291cmNlcyI6WyJsaWIvdmVyaWZ5LWRldGFpbC5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUFBLE9BQU8sRUFBRSxTQUFTLEVBQVUsS0FBSyxFQUFFLE1BQU0sRUFBRSxZQUFZLEVBQUUsV0FBVyxFQUFFLFFBQVEsRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUV0RyxPQUFPLEVBQUUsYUFBYSxFQUFFLE1BQU0sbUJBQW1CLENBQUM7QUFDbEQsT0FBTyxFQUFFLFlBQVksRUFBRSxNQUFNLDJCQUEyQixDQUFDO0FBR3pEO0lBb0pFLCtCQUFtQixhQUE0QixFQUFxQixTQUF1QjtRQUF4RSxrQkFBYSxHQUFiLGFBQWEsQ0FBZTtRQUFxQixjQUFTLEdBQVQsU0FBUyxDQUFjOztRQTdJbEYsbUJBQWMsR0FBbUIsSUFBSSxDQUFDOzs7Ozs7UUFNdEMsYUFBUSxHQUFXLEVBQUUsQ0FBQzs7UUFFdEIsYUFBUSxHQUFZLEtBQUssQ0FBQTs7UUFFUixtQkFBYyxHQUFHLElBQUksWUFBWSxFQUFFLENBQUM7O1FBRXBDLG1CQUFjLEdBQUcsSUFBSSxZQUFZLEVBQUUsQ0FBQzs7O1FBRzlELGVBQVUsR0FBcUIsRUFBRSxDQUFDOztRQUVsQyxtQkFBYyxHQUF3QixFQUFFLENBQUM7O1FBRXpDLGVBQVUsR0FBVyxFQUFFLENBQUM7SUEwSHVFLENBQUM7SUF2SGhHLHNCQUNJLDRDQUFTOzs7O1FBSWI7WUFDRSxPQUFPLElBQUksQ0FBQyxVQUFVLENBQUM7UUFDekIsQ0FBQztRQVJELE1BQU07Ozs7Ozs7UUFDTixVQUNjLEdBQUc7WUFDZixJQUFJLEdBQUcsR0FBRyxFQUFFO2dCQUFFLE9BQU87WUFDckIsSUFBSSxDQUFDLFVBQVUsR0FBRyxHQUFHLEdBQUcsRUFBRSxDQUFDO1FBQzdCLENBQUM7OztPQUFBO0lBS0Qsc0JBQ0ksMENBQU87Ozs7UUE0Qlg7WUFDRSxPQUFPLElBQUksQ0FBQyxRQUFRLENBQUM7UUFDdkIsQ0FBQzs7Ozs7UUEvQkQsVUFDWSxJQUFJO1lBQ2QsSUFBSSxJQUFJLEVBQUU7Z0JBQ1IsSUFBSSxDQUFDLFFBQVEsR0FBRyxJQUFJLENBQUM7YUFDdEI7aUJBQ0k7O29CQUNHLFFBQVEsR0FBRyxJQUFJLENBQUMsYUFBYSxDQUFDLFFBQVEsQ0FBQyw2QkFBNkIsQ0FBQzs7b0JBQ3pFLFVBQVUsR0FBRyxJQUFJLENBQUMsYUFBYSxDQUFDLFFBQVEsQ0FBQywrQkFBK0IsQ0FBQzs7b0JBQ3pFLFVBQVUsR0FBRyxJQUFJLENBQUMsYUFBYSxDQUFDLFFBQVEsQ0FBQywrQkFBK0IsQ0FBQztnQkFDM0UsSUFBSSxDQUFDLFFBQVEsR0FBRztvQkFDZDt3QkFDRSxFQUFFLEVBQUUsY0FBYzt3QkFDbEIsSUFBSSxFQUFFLEtBQUs7d0JBQ1gsS0FBSyxFQUFFLFFBQVE7cUJBQ2hCO29CQUNEO3dCQUNFLEVBQUUsRUFBRSxjQUFjO3dCQUNsQixJQUFJLEVBQUUsT0FBTzt3QkFDYixLQUFLLEVBQUUsVUFBVTtxQkFDbEI7b0JBQ0Q7d0JBQ0UsRUFBRSxFQUFFLGNBQWM7d0JBQ2xCLElBQUksRUFBRSxPQUFPO3dCQUNiLEtBQUssRUFBRSxVQUFVO3FCQUNsQjtpQkFDRixDQUFBO2FBQ0Y7UUFFSCxDQUFDOzs7T0FBQTtJQUtELHNCQUNJLGdEQUFhOzs7O1FBd0VqQjtZQUNFLE9BQU8sSUFBSSxDQUFDLGNBQWMsQ0FBQztRQUM3QixDQUFDOzs7OztRQTNFRCxVQUNrQixHQUFHO1lBRHJCLGlCQXdFQztZQXRFQyxJQUFJLENBQUMsY0FBYyxHQUFHLEdBQUcsQ0FBQztZQUMxQixJQUFJLENBQUMsVUFBVSxHQUFHLEVBQUUsQ0FBQztZQUNyQixJQUFJLElBQUksQ0FBQyxPQUFPLElBQUksSUFBSSxDQUFDLE9BQU8sQ0FBQyxNQUFNLEVBQUU7Z0JBRXZDLElBQUksQ0FBQyxPQUFPLENBQUMsT0FBTzs7OztnQkFBQyxVQUFBLElBQUk7b0JBQ3ZCLElBQUksQ0FBQyxNQUFNLEdBQUcsS0FBSyxDQUFDO2dCQUN0QixDQUFDLEVBQUMsQ0FBQTs7O29CQUVFLE1BQU0sR0FBRyxJQUFJLENBQUMsT0FBTyxDQUFDLElBQUk7Ozs7Z0JBQUMsVUFBQyxHQUFHO29CQUNqQyxPQUFPLEdBQUcsQ0FBQyxJQUFJLEtBQUssS0FBSSxDQUFDLFFBQVEsQ0FBQztnQkFDcEMsQ0FBQyxFQUFDO2dCQUNGLElBQUksSUFBSSxDQUFDLFFBQVEsS0FBSyxFQUFFLElBQUksQ0FBQyxNQUFNLEVBQUU7b0JBQ25DLElBQUksQ0FBQyxRQUFRLEdBQUcsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUM7aUJBQ3RDO2dCQUNELElBQUksQ0FBQyxPQUFPLENBQUMsT0FBTzs7OztnQkFBQyxVQUFBLEdBQUc7O3dCQUNoQixPQUFPLEdBQUcsR0FBRyxDQUFDLElBQUk7b0JBQ3hCLElBQUksT0FBTyxLQUFLLEtBQUssRUFBRTs7OzRCQUVqQixPQUFPLEdBQUc7NEJBQ1osTUFBTSxFQUFFLEdBQUc7NEJBQ1gsTUFBTSxFQUFFLEtBQUs7NEJBQ2IsTUFBTSxFQUFFLE9BQU87eUJBQ2hCO3dCQUNELEdBQUcsQ0FBQyxNQUFNLEdBQUcsT0FBTyxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUM7d0JBQ2pDLEtBQUksQ0FBQyxVQUFVLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDO3FCQUMvQjt5QkFDSTs7NEJBQ0MsT0FBTyxHQUFHLEtBQUksQ0FBQyxVQUFVLENBQUMsSUFBSTs7Ozt3QkFBQyxVQUFDLElBQUk7NEJBQ3RDLE9BQU8sSUFBSSxDQUFDLElBQUksS0FBSyxPQUFPLENBQUM7d0JBQy9CLENBQUMsRUFBQzt3QkFDRixJQUFJLE9BQU8sRUFBRTs7O2dDQUVQLE9BQU8sR0FBRyxHQUFHLENBQUMsTUFBTTs7Ozs0QkFBQyxVQUFBLEtBQUs7Z0NBQzVCLE9BQU8sS0FBSyxDQUFDLElBQUksS0FBSyxPQUFPLENBQUM7NEJBQ2hDLENBQUMsRUFBQzs0QkFDRixJQUFJLE9BQU8sSUFBSSxPQUFPLENBQUMsTUFBTSxFQUFFO2dDQUM3QixPQUFPLENBQUMsSUFBSSxHQUFHLE9BQU8sQ0FBQzs2QkFDeEI7eUJBQ0Y7NkJBQ0k7OztnQ0FFQyxPQUFPLEdBQUc7Z0NBQ1osTUFBTSxFQUFFLEVBQUU7Z0NBQ1YsTUFBTSxFQUFFLEtBQUs7Z0NBQ2IsTUFBTSxFQUFFLE9BQU87NkJBQ2hCOztnQ0FDRyxPQUFPLEdBQUcsR0FBRyxDQUFDLE1BQU07Ozs7NEJBQUMsVUFBQSxLQUFLO2dDQUM1QixPQUFPLEtBQUssQ0FBQyxJQUFJLEtBQUssT0FBTyxDQUFDOzRCQUNoQyxDQUFDLEVBQUM7NEJBQ0YsSUFBSSxPQUFPLElBQUksT0FBTyxDQUFDLE1BQU0sRUFBRTtnQ0FDN0IsT0FBTyxDQUFDLElBQUksR0FBRyxPQUFPLENBQUM7NkJBQ3hCOzRCQUNELEdBQUcsQ0FBQyxNQUFNLEdBQUcsT0FBTyxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUM7NEJBQ2pDLEtBQUksQ0FBQyxVQUFVLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDO3lCQUMvQjtxQkFDRjtnQkFDSCxDQUFDLEVBQUMsQ0FBQzs7b0JBQ0MsTUFBTSxHQUFHLElBQUksQ0FBQyxPQUFPLENBQUMsSUFBSTs7OztnQkFBQyxVQUFBLElBQUk7b0JBQ2pDLE9BQU8sSUFBSSxDQUFDLElBQUksS0FBSyxLQUFJLENBQUMsUUFBUSxDQUFDO2dCQUNyQyxDQUFDLEVBQUM7Z0JBQ0YsSUFBSSxNQUFNLEVBQUU7b0JBQ1YsTUFBTSxDQUFDLE1BQU0sR0FBRyxJQUFJLENBQUM7aUJBQ3RCO2FBQ0Y7O2dCQUNHLE9BQU8sR0FBRyxJQUFJLENBQUMsVUFBVSxDQUFDLElBQUk7Ozs7WUFBQyxVQUFBLElBQUk7Z0JBQ3JDLE9BQU8sSUFBSSxDQUFDLElBQUksS0FBSyxLQUFJLENBQUMsUUFBUSxDQUFDO1lBQ3JDLENBQUMsRUFBQztZQUNGLElBQUksT0FBTyxFQUFFO2dCQUNYLE9BQU8sQ0FBQyxJQUFJLEdBQUcsSUFBSSxDQUFDO2FBQ3JCO1FBQ0gsQ0FBQzs7O09BQUE7SUFBQSxDQUFDOzs7O0lBT0Ysd0NBQVE7OztJQUFSLGNBQWEsQ0FBQztJQUNkLE1BQU07Ozs7O0lBQ04sb0NBQUk7Ozs7O0lBQUo7UUFDRSxJQUFJLENBQUMsUUFBUSxHQUFHLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQztRQUMvQixJQUFJLENBQUMsY0FBYyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLENBQUM7SUFDMUMsQ0FBQztJQUNEOztPQUVHOzs7Ozs7SUFDSCwrQ0FBZTs7Ozs7SUFBZixVQUFnQixHQUFHO1FBQ2pCLElBQUksR0FBRyxDQUFDLE1BQU0sSUFBSSxDQUFDLEVBQUU7WUFDbkIsT0FBTztTQUNSO1FBQ0QsSUFBSSxDQUFDLE9BQU8sQ0FBQyxPQUFPOzs7O1FBQUMsVUFBQSxJQUFJO1lBQ3ZCLElBQUksQ0FBQyxNQUFNLEdBQUcsS0FBSyxDQUFDO1FBQ3RCLENBQUMsRUFBQyxDQUFBO1FBQ0YsR0FBRyxDQUFDLE1BQU0sR0FBRyxJQUFJLENBQUM7UUFDbEIsSUFBSSxDQUFDLFVBQVUsQ0FBQyxPQUFPOzs7O1FBQUMsVUFBQyxJQUFJO1lBQzNCLElBQUksSUFBSSxDQUFDLElBQUksS0FBSyxHQUFHLENBQUMsSUFBSSxFQUFFO2dCQUMxQixJQUFJLENBQUMsSUFBSSxHQUFHLElBQUksQ0FBQzthQUNsQjtpQkFDSTtnQkFDSCxJQUFJLENBQUMsSUFBSSxHQUFHLEtBQUssQ0FBQzthQUNuQjtRQUNILENBQUMsRUFBQyxDQUFBO0lBQ0osQ0FBQztJQUNELFlBQVk7Ozs7O0lBQ1oscUNBQUs7Ozs7SUFBTDtRQUNFLElBQUksQ0FBQyxRQUFRLEdBQUcsS0FBSyxDQUFDO1FBQ3RCLElBQUksQ0FBQyxjQUFjLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO0lBQ2xDLENBQUM7SUFDRCxnQkFBZ0I7Ozs7OztJQUNoQiwwQ0FBVTs7Ozs7SUFBVixVQUFXLElBQUk7UUFDYixJQUFJLENBQUMsY0FBYyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztJQUNqQyxDQUFDO0lBQ0Q7OztPQUdHOzs7Ozs7SUFDSCx3Q0FBUTs7Ozs7SUFBUixVQUFTLFFBQVE7UUFDZixJQUFHLElBQUksQ0FBQyxTQUFTLEVBQUM7WUFDaEIsSUFBRyxRQUFRLENBQUMsY0FBYyxDQUFDLFdBQVcsQ0FBQyxJQUFFLFFBQVEsQ0FBQyxXQUFXLENBQUMsRUFBQztnQkFDN0QsT0FBTyxJQUFJLENBQUMsU0FBUyxDQUFDLHdCQUF3QixDQUFDLFFBQVEsQ0FBQyxXQUFXLENBQUMsQ0FBQyxDQUFDO2FBQ3ZFO1NBQ0Y7UUFDRCxPQUFPLElBQUksQ0FBQztJQUNkLENBQUM7SUFDRDs7T0FFRzs7Ozs7O0lBQ0gsNkNBQWE7Ozs7O0lBQWIsVUFBYyxRQUFRO1FBQ3BCLElBQUcsUUFBUSxFQUFDO1lBQ1YsSUFBRyxRQUFRLENBQUMsY0FBYyxDQUFDLFNBQVMsQ0FBQyxJQUFFLFFBQVEsQ0FBQyxTQUFTLENBQUMsRUFBQztnQkFDekQsT0FBTyxJQUFJLENBQUM7YUFDYjtZQUNELElBQUcsUUFBUSxDQUFDLGNBQWMsQ0FBQyxXQUFXLENBQUMsSUFBRSxRQUFRLENBQUMsV0FBVyxDQUFDLEVBQUM7Z0JBQzdELE9BQU8sSUFBSSxDQUFDO2FBQ2I7U0FDRjtRQUNELE9BQU8sS0FBSyxDQUFDO0lBQ2YsQ0FBQzs7Z0JBbE5GLFNBQVMsU0FBQztvQkFDVCxRQUFRLEVBQUUsc0JBQXNCO29CQUNoQyxxMUdBQTZDOztpQkFFOUM7Ozs7Z0JBUlEsYUFBYTtnQkFDYixZQUFZLHVCQXVKOEIsUUFBUTs7O2lDQTdJeEQsS0FBSzsyQkFNTCxLQUFLOzJCQUVMLEtBQUs7aUNBRUwsTUFBTSxTQUFDLGdCQUFnQjtpQ0FFdkIsTUFBTSxTQUFDLGdCQUFnQjs0QkFVdkIsS0FBSzswQkFTTCxLQUFLO2dDQWlDTCxLQUFLOztJQTRJUiw0QkFBQztDQUFBLEFBbk5ELElBbU5DO1NBOU1ZLHFCQUFxQjs7O0lBRWhDLCtDQUErQzs7SUFNL0MseUNBQStCOztJQUUvQix5Q0FBa0M7O0lBRWxDLCtDQUE4RDs7SUFFOUQsK0NBQThEOztJQUc5RCwyQ0FBa0M7O0lBRWxDLCtDQUF5Qzs7SUFFekMsMkNBQXdCOztJQUN4Qix5Q0FBd0I7O0lBeUhaLDhDQUFtQzs7Ozs7SUFBQywwQ0FBMkMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb21wb25lbnQsIE9uSW5pdCwgSW5wdXQsIE91dHB1dCwgRXZlbnRFbWl0dGVyLCBUZW1wbGF0ZVJlZiwgT3B0aW9uYWwgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgdGFiTGlzdEl0ZW0sIEVycm9yTGlzdHNJdGVtLCB2YWxpZGF0b3JMaXN0SXRlbSB9IGZyb20gJy4vdmVyaWZ5LWRldGFpbC5pbnRlcmZhY2UnO1xyXG5pbXBvcnQgeyBMb2NhbGVTZXJ2aWNlIH0gZnJvbSAnQGZhcnJpcy91aS1sb2NhbGUnO1xyXG5pbXBvcnQgeyBEb21TYW5pdGl6ZXIgfSBmcm9tICdAYW5ndWxhci9wbGF0Zm9ybS1icm93c2VyJztcclxuXHJcblxyXG5AQ29tcG9uZW50KHtcclxuICBzZWxlY3RvcjogJ2ZhcnJpcy12ZXJpZnktZGV0YWlsJyxcclxuICB0ZW1wbGF0ZVVybDogJy4vdmVyaWZ5LWRldGFpbC5jb21wb25lbnQuaHRtbCcsXHJcbiAgc3R5bGVVcmxzOiBbJy4vdmVyaWZ5LWRldGFpbC5jb21wb25lbnQuc2NzcyddXHJcbn0pXHJcbmV4cG9ydCBjbGFzcyBWZXJpZnlEZXRhaWxDb21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQge1xyXG4gIC8vIOi/veWKoOe7k+aenOaPkOekuuaooeadv1xyXG4gIEBJbnB1dCgpIHJlc3VsdFRpcHNUbXBsOiBUZW1wbGF0ZVJlZjxhbnk+PW51bGw7XHJcbiAgLy9ASW5wdXQoKSBtYXhIZWlnaHQ6bnVtYmVyO1xyXG4gIC8vQElucHV0KCkgdmFsaWRhdG9yTGlzdDtcclxuICAvL+ihqOWNlemqjOivgeWIhue7hOS/oeaBr1xyXG4gIC8vQElucHV0KCkgdGFiTGlzdDp0YWJMaXN0SXRlbVtdO1xyXG4gIC8v6KGo5Y2V6aqM6K+B6buY6K6k5pi+56S655qE5YiG57uE5L+h5oGvXHJcbiAgQElucHV0KCkgc2hvd1R5cGU6IHN0cmluZyA9ICcnO1xyXG4gIC8v5piv5ZCm6buY6K6k5pi+56S66aqM6K+B5L+h5oGv5YiX6KGoXHJcbiAgQElucHV0KCkgc2hvd0xpc3Q6IGJvb2xlYW4gPSBmYWxzZVxyXG4gIC8v6aqM6K+B5L+h5oGv54K55Ye7XHJcbiAgQE91dHB1dCgndmFsaWRhdG9yQ2xpY2snKSB2YWxpZGF0b3JDbGljayA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcclxuICAvL+mqjOivgeivpuaDheaYvuekuumakOiXj+S6i+S7tlxyXG4gIEBPdXRwdXQoJ2xpc3RzaG93Q2hhbmdlJykgbGlzdHNob3dDaGFuZ2UgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XHJcbiAgLy9zaG93TGlzdCA9IGZhbHNlO1xyXG4gIC8v5aSE55CG5ZCO5bim5YiG57uE55qE6KGo5Y2V6aqM6K+B5L+h5oGvXHJcbiAgZXJyb3JMaXN0czogRXJyb3JMaXN0c0l0ZW1bXSA9IFtdO1xyXG4gIC8v6buY6K6k5Lyg5YWl55qE6KGo5Y2V6aqM6K+B5L+h5oGv5pWw57uEXHJcbiAgX3ZhbGlkYXRvckxpc3Q6IHZhbGlkYXRvckxpc3RJdGVtW10gPSBbXTtcclxuICAvL+WIl+ihqOmDqOWIhuacgOWkp+mrmOW6plxyXG4gIF9tYXhIZWlnaHQ6IG51bWJlciA9IDYwO1xyXG4gIF90YWJsaXN0OiB0YWJMaXN0SXRlbVtdO1xyXG4gIC8v5pyA5aSn6auY5bqmXHJcbiAgQElucHV0KClcclxuICBzZXQgbWF4SGVpZ2h0KG51bSkge1xyXG4gICAgaWYgKG51bSA8IDUwKSByZXR1cm47XHJcbiAgICB0aGlzLl9tYXhIZWlnaHQgPSBudW0gLSA1MDtcclxuICB9XHJcbiAgZ2V0IG1heEhlaWdodCgpIHtcclxuICAgIHJldHVybiB0aGlzLl9tYXhIZWlnaHQ7XHJcbiAgfVxyXG5cclxuICBASW5wdXQoKVxyXG4gIHNldCB0YWJMaXN0KGl0ZW0pIHtcclxuICAgIGlmIChpdGVtKSB7XHJcbiAgICAgIHRoaXMuX3RhYmxpc3QgPSBpdGVtO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgIGNvbnN0IGFsbFRpdGxlID0gdGhpcy5sb2NhbGVTZXJ2aWNlLmdldFZhbHVlKCd2ZXJpZnlEZXRhaWwudmVydGlmeVR5cGVBbGwnKSxcclxuICAgICAgICBlcnJvclRpdGxlID0gdGhpcy5sb2NhbGVTZXJ2aWNlLmdldFZhbHVlKCd2ZXJpZnlEZXRhaWwudmVydGlmeVR5cGVFcnJvcicpLFxyXG4gICAgICAgIGVtcHR5VGl0bGUgPSB0aGlzLmxvY2FsZVNlcnZpY2UuZ2V0VmFsdWUoJ3ZlcmlmeURldGFpbC52ZXJ0aWZ5VHlwZUVtcHR5Jyk7XHJcbiAgICAgIHRoaXMuX3RhYmxpc3QgPSBbXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgaWQ6ICd2ZXJ0aWZ5VHlwZTEnLFxyXG4gICAgICAgICAgdHlwZTogJ2FsbCcsXHJcbiAgICAgICAgICB0aXRsZTogYWxsVGl0bGVcclxuICAgICAgICB9LFxyXG4gICAgICAgIHtcclxuICAgICAgICAgIGlkOiAndmVydGlmeVR5cGUyJyxcclxuICAgICAgICAgIHR5cGU6ICdlcnJvcicsXHJcbiAgICAgICAgICB0aXRsZTogZXJyb3JUaXRsZVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgaWQ6ICd2ZXJ0aWZ5VHlwZTMnLFxyXG4gICAgICAgICAgdHlwZTogJ2VtcHR5JyxcclxuICAgICAgICAgIHRpdGxlOiBlbXB0eVRpdGxlXHJcbiAgICAgICAgfVxyXG4gICAgICBdXHJcbiAgICB9XHJcblxyXG4gIH1cclxuICBnZXQgdGFiTGlzdCgpIHtcclxuICAgIHJldHVybiB0aGlzLl90YWJsaXN0O1xyXG4gIH1cclxuXHJcbiAgQElucHV0KClcclxuICBzZXQgdmFsaWRhdG9yTGlzdChvYmopIHtcclxuICAgIHRoaXMuX3ZhbGlkYXRvckxpc3QgPSBvYmo7XHJcbiAgICB0aGlzLmVycm9yTGlzdHMgPSBbXTtcclxuICAgIGlmICh0aGlzLnRhYkxpc3QgJiYgdGhpcy50YWJMaXN0Lmxlbmd0aCkge1xyXG5cclxuICAgICAgdGhpcy50YWJMaXN0LmZvckVhY2goaXRlbSA9PiB7XHJcbiAgICAgICAgaXRlbS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgfSlcclxuICAgICAgLy/liKTmlq3pu5jorqTlsZXnpLrnmoTnsbvlnotcclxuICAgICAgbGV0IGhhc1RhYiA9IHRoaXMudGFiTGlzdC5maW5kKCh0YWIpID0+IHtcclxuICAgICAgICByZXR1cm4gdGFiLnR5cGUgPT09IHRoaXMuc2hvd1R5cGU7XHJcbiAgICAgIH0pXHJcbiAgICAgIGlmICh0aGlzLnNob3dUeXBlID09PSAnJyB8fCAhaGFzVGFiKSB7XHJcbiAgICAgICAgdGhpcy5zaG93VHlwZSA9IHRoaXMudGFiTGlzdFswXS50eXBlO1xyXG4gICAgICB9XHJcbiAgICAgIHRoaXMudGFiTGlzdC5mb3JFYWNoKHRhYiA9PiB7XHJcbiAgICAgICAgY29uc3QgdGFiVHlwZSA9IHRhYi50eXBlO1xyXG4gICAgICAgIGlmICh0YWJUeXBlID09PSAnYWxsJykge1xyXG4gICAgICAgICAgLy8g5omA5pyJ57G75Z6LXHJcbiAgICAgICAgICBsZXQgbGlzdE9iaiA9IHtcclxuICAgICAgICAgICAgJ2xpc3QnOiBvYmosXHJcbiAgICAgICAgICAgICdzaG93JzogZmFsc2UsXHJcbiAgICAgICAgICAgICd0eXBlJzogdGFiVHlwZVxyXG4gICAgICAgICAgfTtcclxuICAgICAgICAgIHRhYi5sZW5ndGggPSBsaXN0T2JqLmxpc3QubGVuZ3RoO1xyXG4gICAgICAgICAgdGhpcy5lcnJvckxpc3RzLnB1c2gobGlzdE9iaik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgbGV0IGhhc1R5cGUgPSB0aGlzLmVycm9yTGlzdHMuZmluZCgoaXRlbSkgPT4ge1xyXG4gICAgICAgICAgICByZXR1cm4gaXRlbS50eXBlID09PSB0YWJUeXBlO1xyXG4gICAgICAgICAgfSlcclxuICAgICAgICAgIGlmIChoYXNUeXBlKSB7XHJcbiAgICAgICAgICAgIC8vIOiDveaJvuWIsOexu+Wei1xyXG4gICAgICAgICAgICBsZXQgdmFsTGlzdCA9IG9iai5maWx0ZXIoZXJyb3IgPT4ge1xyXG4gICAgICAgICAgICAgIHJldHVybiBlcnJvci50eXBlID09PSB0YWJUeXBlO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICBpZiAodmFsTGlzdCAmJiB2YWxMaXN0Lmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgIGhhc1R5cGUubGlzdCA9IHZhbExpc3Q7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH1cclxuICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAvLyDmib7kuI3liLDnsbvlnotcclxuICAgICAgICAgICAgbGV0IGxpc3RPYmogPSB7XHJcbiAgICAgICAgICAgICAgJ2xpc3QnOiBbXSxcclxuICAgICAgICAgICAgICAnc2hvdyc6IGZhbHNlLFxyXG4gICAgICAgICAgICAgICd0eXBlJzogdGFiVHlwZVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGxldCB2YWxMaXN0ID0gb2JqLmZpbHRlcihlcnJvciA9PiB7XHJcbiAgICAgICAgICAgICAgcmV0dXJuIGVycm9yLnR5cGUgPT09IHRhYlR5cGU7XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIGlmICh2YWxMaXN0ICYmIHZhbExpc3QubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgbGlzdE9iai5saXN0ID0gdmFsTGlzdDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0YWIubGVuZ3RoID0gbGlzdE9iai5saXN0Lmxlbmd0aDtcclxuICAgICAgICAgICAgdGhpcy5lcnJvckxpc3RzLnB1c2gobGlzdE9iaik7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICAgICAgbGV0IHRhYk9iaiA9IHRoaXMudGFiTGlzdC5maW5kKGl0ZW0gPT4ge1xyXG4gICAgICAgIHJldHVybiBpdGVtLnR5cGUgPT09IHRoaXMuc2hvd1R5cGU7XHJcbiAgICAgIH0pXHJcbiAgICAgIGlmICh0YWJPYmopIHtcclxuICAgICAgICB0YWJPYmouYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgbGV0IHNob3dPYmogPSB0aGlzLmVycm9yTGlzdHMuZmluZChpdGVtID0+IHtcclxuICAgICAgcmV0dXJuIGl0ZW0udHlwZSA9PT0gdGhpcy5zaG93VHlwZTtcclxuICAgIH0pXHJcbiAgICBpZiAoc2hvd09iaikge1xyXG4gICAgICBzaG93T2JqLnNob3cgPSB0cnVlO1xyXG4gICAgfVxyXG4gIH07XHJcbiAgZ2V0IHZhbGlkYXRvckxpc3QoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5fdmFsaWRhdG9yTGlzdDtcclxuICB9XHJcblxyXG4gIGNvbnN0cnVjdG9yKHB1YmxpYyBsb2NhbGVTZXJ2aWNlOiBMb2NhbGVTZXJ2aWNlLEBPcHRpb25hbCgpIHByaXZhdGUgc2FuaXRpemVyOiBEb21TYW5pdGl6ZXIpIHsgfVxyXG5cclxuICBuZ09uSW5pdCgpIHsgfVxyXG4gIC8v5pi+56S66K+m5oOFXHJcbiAgc2hvdygpIHtcclxuICAgIHRoaXMuc2hvd0xpc3QgPSAhdGhpcy5zaG93TGlzdDtcclxuICAgIHRoaXMubGlzdHNob3dDaGFuZ2UuZW1pdCh0aGlzLnNob3dMaXN0KTtcclxuICB9XHJcbiAgLyoq54K55Ye75YiG57uE5YiH5o2iXHJcbiAgICogQHBhcmFtIHRhYuWIhue7hOS/oeaBr1xyXG4gICAqL1xyXG4gIHNob3dMaXN0Q29udGVudCh0YWIpIHtcclxuICAgIGlmICh0YWIubGVuZ3RoIDw9IDApIHtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgdGhpcy50YWJMaXN0LmZvckVhY2goaXRlbSA9PiB7XHJcbiAgICAgIGl0ZW0uYWN0aXZlID0gZmFsc2U7XHJcbiAgICB9KVxyXG4gICAgdGFiLmFjdGl2ZSA9IHRydWU7XHJcbiAgICB0aGlzLmVycm9yTGlzdHMuZm9yRWFjaCgoaXRlbSkgPT4ge1xyXG4gICAgICBpZiAoaXRlbS50eXBlID09PSB0YWIudHlwZSkge1xyXG4gICAgICAgIGl0ZW0uc2hvdyA9IHRydWU7XHJcbiAgICAgIH1cclxuICAgICAgZWxzZSB7XHJcbiAgICAgICAgaXRlbS5zaG93ID0gZmFsc2U7XHJcbiAgICAgIH1cclxuICAgIH0pXHJcbiAgfVxyXG4gIC8qKueCueWHu+WFs+mXreaMiemSriAqL1xyXG4gIGNsb3NlKCkge1xyXG4gICAgdGhpcy5zaG93TGlzdCA9IGZhbHNlO1xyXG4gICAgdGhpcy5saXN0c2hvd0NoYW5nZS5lbWl0KGZhbHNlKTtcclxuICB9XHJcbiAgLyoq54K55Ye76KGo5Y2V6aqM6K+B5YiX6KGo5LqL5Lu2ICovXHJcbiAgZXJyb3JDbGljayhpdGVtKSB7XHJcbiAgICB0aGlzLnZhbGlkYXRvckNsaWNrLmVtaXQoaXRlbSk7XHJcbiAgfVxyXG4gIC8qKlxyXG4gICAqIOagt+W8j+WuieWFqOWMllxyXG4gICAqIEBwYXJhbSB0eXBlSW5mbyBcclxuICAgKi9cclxuICBnZXRTdHlsZSh0eXBlSW5mbyl7XHJcbiAgICBpZih0aGlzLnNhbml0aXplcil7XHJcbiAgICAgIGlmKHR5cGVJbmZvLmhhc093blByb3BlcnR5KCdpY29uU3R5bGUnKSYmdHlwZUluZm9bJ2ljb25TdHlsZSddKXtcclxuICAgICAgICByZXR1cm4gdGhpcy5zYW5pdGl6ZXIuYnlwYXNzU2VjdXJpdHlUcnVzdFN0eWxlKHR5cGVJbmZvWydpY29uU3R5bGUnXSk7XHJcbiAgICAgIH1cclxuICAgIH0gICAgXHJcbiAgICByZXR1cm4gbnVsbDtcclxuICB9XHJcbiAgLyoqXHJcbiAgICog5Yik5pat5piv5ZCm5pyJ5paw5bGe5oCnXHJcbiAgICovXHJcbiAgaGFzU2VsZkRlZmluZCh0eXBlSW5mbyl7XHJcbiAgICBpZih0eXBlSW5mbyl7XHJcbiAgICAgIGlmKHR5cGVJbmZvLmhhc093blByb3BlcnR5KCdpY29uQ2xzJykmJnR5cGVJbmZvWydpY29uQ2xzJ10pe1xyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICB9XHJcbiAgICAgIGlmKHR5cGVJbmZvLmhhc093blByb3BlcnR5KCdpY29uU3R5bGUnKSYmdHlwZUluZm9bJ2ljb25TdHlsZSddKXtcclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIGZhbHNlO1xyXG4gIH1cclxufVxyXG4iXX0=