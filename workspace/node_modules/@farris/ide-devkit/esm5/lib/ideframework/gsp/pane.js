/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
import { PaneAxis } from './pane-axis';
import { Emitter } from './event-kit';
// const Grim = require('grim')
// const {CompositeDisposable, Emitter} = require('event-kit')
// const PaneAxis = require('./pane-axis')
// const TextEditor = require('./text-editor')
// const PaneElement = require('./pane-element')
/** @type {?} */
var nextInstanceId = 1;
var SaveCancelledError = /** @class */ (function (_super) {
    tslib_1.__extends(SaveCancelledError, _super);
    function SaveCancelledError() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    return SaveCancelledError;
}(Error));
// Extended: A container for presenting content in the center of the workspace.
// Panes can contain multiple items, one of which is *active* at a given time.
// The view corresponding to the active item is displayed in the interface. In
// the default configuration, tabs are also displayed for each item.
//
// Each pane may also contain one *pending* item. When a pending item is added
// to a pane, it will replace the currently pending item, if any, instead of
// simply being added. In the default configuration, the text in the tab for
// pending items is shown in italics.
var 
// Extended: A container for presenting content in the center of the workspace.
// Panes can contain multiple items, one of which is *active* at a given time.
// The view corresponding to the active item is displayed in the interface. In
// the default configuration, tabs are also displayed for each item.
//
// Each pane may also contain one *pending* item. When a pending item is added
// to a pane, it will replace the currently pending item, if any, instead of
// simply being added. In the default configuration, the text in the tab for
// pending items is shown in italics.
Pane = /** @class */ (function () {
    function Pane(params) {
        this.alive = true;
        this.subscriptionsPerItem = new WeakMap();
        this.items = [];
        this.itemStack = [];
        this.container = null;
        this.setPendingItem = this.setPendingItem.bind(this);
        this.getPendingItem = this.getPendingItem.bind(this);
        this.clearPendingItem = this.clearPendingItem.bind(this);
        this.onItemDidTerminatePendingState = this.onItemDidTerminatePendingState.bind(this);
        this.saveItem = this.saveItem.bind(this);
        this.saveItemAs = this.saveItemAs.bind(this);
        this.id = params.id;
        if (this.id != null) {
            nextInstanceId = Math.max(nextInstanceId, this.id + 1);
        }
        else {
            this.id = nextInstanceId++;
        }
        this.activeItem = params.activeItem;
        this.focused = params.focused != null ? params.focused : false;
        this.applicationDelegate = params.applicationDelegate;
        this.notificationManager = params.notificationManager;
        this.config = params.config;
        this.deserializerManager = params.deserializerManager;
        this.viewRegistry = params.viewRegistry;
        this.emitter = new Emitter();
        this.alive = true;
        this.subscriptionsPerItem = new WeakMap();
        this.items = [];
        this.itemStack = [];
        this.container = null;
        this.addItems((params.items || []).filter(function (item) { return item; }));
        if (!this.getActiveItem()) {
            this.setActiveItem(this.items[0]);
        }
        this.addItemsToStack(params.itemStackIndices || []);
        this.setFlexScale(params.flexScale || 1);
    }
    /**
     * @param {?} state
     * @param {?} __1
     * @return {?}
     */
    Pane.deserialize = /**
     * @param {?} state
     * @param {?} __1
     * @return {?}
     */
    function (state, _a) {
        var deserializers = _a.deserializers, applicationDelegate = _a.applicationDelegate, config = _a.config, notifications = _a.notifications, views = _a.views;
        var e_1, _b;
        var activeItemIndex = state.activeItemIndex;
        /** @type {?} */
        var activeItemURI = state.activeItemURI || state.activeItemUri;
        /** @type {?} */
        var items = [];
        try {
            for (var _c = tslib_1.__values(state.items), _d = _c.next(); !_d.done; _d = _c.next()) {
                var itemState = _d.value;
                /** @type {?} */
                var item = deserializers.deserialize(itemState);
                if (item) {
                    items.push(item);
                }
            }
        }
        catch (e_1_1) { e_1 = { error: e_1_1 }; }
        finally {
            try {
                if (_d && !_d.done && (_b = _c.return)) _b.call(_c);
            }
            finally { if (e_1) throw e_1.error; }
        }
        state.items = items;
        state.activeItem = items[activeItemIndex];
        if (!state.activeItem && activeItemURI) {
            state.activeItem = state.items.find(function (item) {
                return typeof item.getURI === 'function' && item.getURI() === activeItemURI;
            });
        }
        return new Pane(Object.assign(state, {
            deserializerManager: deserializers,
            notificationManager: notifications,
            viewRegistry: views,
            config: config,
            applicationDelegate: applicationDelegate
        }));
    };
    /**
     * @return {?}
     */
    Pane.prototype.inspect = /**
     * @return {?}
     */
    function () {
        return "Pane " + this.id;
    };
    /**
     * @return {?}
     */
    Pane.prototype.getElement = /**
     * @return {?}
     */
    function () {
    };
    /**
     * @return {?}
     */
    Pane.prototype.serialize = /**
     * @return {?}
     */
    function () {
        var e_2, _a;
        /** @type {?} */
        var itemsToBeSerialized = this.items.filter(function (item) { return item && typeof item.serialize === 'function'; });
        /** @type {?} */
        var itemStackIndices = [];
        try {
            for (var _b = tslib_1.__values(this.itemStack), _c = _b.next(); !_c.done; _c = _b.next()) {
                var item = _c.value;
                if (typeof item.serialize === 'function') {
                    itemStackIndices.push(itemsToBeSerialized.indexOf(item));
                }
            }
        }
        catch (e_2_1) { e_2 = { error: e_2_1 }; }
        finally {
            try {
                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
            }
            finally { if (e_2) throw e_2.error; }
        }
        /** @type {?} */
        var activeItemIndex = itemsToBeSerialized.indexOf(this.activeItem);
        return {
            deserializer: 'Pane',
            id: this.id,
            items: itemsToBeSerialized.map(function (item) { return item.serialize(); }),
            itemStackIndices: itemStackIndices,
            activeItemIndex: activeItemIndex,
            focused: this.focused,
            flexScale: this.flexScale
        };
    };
    /**
     * @return {?}
     */
    Pane.prototype.getParent = /**
     * @return {?}
     */
    function () { return this.parent; };
    /**
     * @param {?} parent
     * @return {?}
     */
    Pane.prototype.setParent = /**
     * @param {?} parent
     * @return {?}
     */
    function (parent) {
        this.parent = parent;
    };
    /**
     * @return {?}
     */
    Pane.prototype.getContainer = /**
     * @return {?}
     */
    function () { return this.container; };
    /**
     * @param {?} container
     * @return {?}
     */
    Pane.prototype.setContainer = /**
     * @param {?} container
     * @return {?}
     */
    function (container) {
        if (container && container !== this.container) {
            this.container = container;
            container.didAddPane({ pane: this });
        }
    };
    // Private: Determine whether the given item is allowed to exist in this pane.
    //
    // * `item` the Item
    //
    // Returns a {Boolean}.
    // Private: Determine whether the given item is allowed to exist in this pane.
    //
    // * `item` the Item
    //
    // Returns a {Boolean}.
    /**
     * @param {?} item
     * @return {?}
     */
    Pane.prototype.isItemAllowed = 
    // Private: Determine whether the given item is allowed to exist in this pane.
    //
    // * `item` the Item
    //
    // Returns a {Boolean}.
    /**
     * @param {?} item
     * @return {?}
     */
    function (item) {
        if (typeof item.getAllowedLocations !== 'function') {
            return true;
        }
        else {
            return item.getAllowedLocations().includes(this.getContainer().getLocation());
        }
    };
    /**
     * @param {?} flexScale
     * @return {?}
     */
    Pane.prototype.setFlexScale = /**
     * @param {?} flexScale
     * @return {?}
     */
    function (flexScale) {
        this.flexScale = flexScale;
        return this.flexScale;
    };
    /**
     * @return {?}
     */
    Pane.prototype.getFlexScale = /**
     * @return {?}
     */
    function () { return this.flexScale; };
    /**
     * @return {?}
     */
    Pane.prototype.increaseSize = /**
     * @return {?}
     */
    function () { this.setFlexScale(this.getFlexScale() * 1.1); };
    /**
     * @return {?}
     */
    Pane.prototype.decreaseSize = /**
     * @return {?}
     */
    function () { this.setFlexScale(this.getFlexScale() / 1.1); };
    /*
    Section: Event Subscription
    */
    // Public: Invoke the given callback when the pane resizes
    //
    // The callback will be invoked when pane's flexScale property changes.
    // Use {::getFlexScale} to get the current value.
    //
    // * `callback` {Function} to be called when the pane is resized
    //   * `flexScale` {Number} representing the panes `flex-grow`; ability for a
    //     flex item to grow if necessary.
    //
    // Returns a {Disposable} on which '.dispose()' can be called to unsubscribe.
    /*
      Section: Event Subscription
      */
    // Public: Invoke the given callback when the pane resizes
    //
    // The callback will be invoked when pane's flexScale property changes.
    // Use {::getFlexScale} to get the current value.
    //
    // * `callback` {Function} to be called when the pane is resized
    //   * `flexScale` {Number} representing the panes `flex-grow`; ability for a
    //     flex item to grow if necessary.
    //
    // Returns a {Disposable} on which '.dispose()' can be called to unsubscribe.
    /**
     * @param {?} callback
     * @return {?}
     */
    Pane.prototype.onDidChangeFlexScale = /*
      Section: Event Subscription
      */
    // Public: Invoke the given callback when the pane resizes
    //
    // The callback will be invoked when pane's flexScale property changes.
    // Use {::getFlexScale} to get the current value.
    //
    // * `callback` {Function} to be called when the pane is resized
    //   * `flexScale` {Number} representing the panes `flex-grow`; ability for a
    //     flex item to grow if necessary.
    //
    // Returns a {Disposable} on which '.dispose()' can be called to unsubscribe.
    /**
     * @param {?} callback
     * @return {?}
     */
    function (callback) {
    };
    // Public: Invoke the given callback with the current and future values of
    // {::getFlexScale}.
    //
    // * `callback` {Function} to be called with the current and future values of
    //   the {::getFlexScale} property.
    //   * `flexScale` {Number} representing the panes `flex-grow`; ability for a
    //     flex item to grow if necessary.
    //
    // Returns a {Disposable} on which `.dispose()` can be called to unsubscribe.
    // Public: Invoke the given callback with the current and future values of
    // {::getFlexScale}.
    //
    // * `callback` {Function} to be called with the current and future values of
    //   the {::getFlexScale} property.
    //   * `flexScale` {Number} representing the panes `flex-grow`; ability for a
    //     flex item to grow if necessary.
    //
    // Returns a {Disposable} on which `.dispose()` can be called to unsubscribe.
    /**
     * @param {?} callback
     * @return {?}
     */
    Pane.prototype.observeFlexScale = 
    // Public: Invoke the given callback with the current and future values of
    // {::getFlexScale}.
    //
    // * `callback` {Function} to be called with the current and future values of
    //   the {::getFlexScale} property.
    //   * `flexScale` {Number} representing the panes `flex-grow`; ability for a
    //     flex item to grow if necessary.
    //
    // Returns a {Disposable} on which `.dispose()` can be called to unsubscribe.
    /**
     * @param {?} callback
     * @return {?}
     */
    function (callback) {
        callback(this.flexScale);
        return this.onDidChangeFlexScale(callback);
    };
    // Public: Invoke the given callback when the pane is activated.
    //
    // The given callback will be invoked whenever {::activate} is called on the
    // pane, even if it is already active at the time.
    //
    // * `callback` {Function} to be called when the pane is activated.
    //
    // Returns a {Disposable} on which `.dispose()` can be called to unsubscribe.
    // Public: Invoke the given callback when the pane is activated.
    //
    // The given callback will be invoked whenever {::activate} is called on the
    // pane, even if it is already active at the time.
    //
    // * `callback` {Function} to be called when the pane is activated.
    //
    // Returns a {Disposable} on which `.dispose()` can be called to unsubscribe.
    /**
     * @param {?} callback
     * @return {?}
     */
    Pane.prototype.onDidActivate = 
    // Public: Invoke the given callback when the pane is activated.
    //
    // The given callback will be invoked whenever {::activate} is called on the
    // pane, even if it is already active at the time.
    //
    // * `callback` {Function} to be called when the pane is activated.
    //
    // Returns a {Disposable} on which `.dispose()` can be called to unsubscribe.
    /**
     * @param {?} callback
     * @return {?}
     */
    function (callback) {
    };
    // Public: Invoke the given callback before the pane is destroyed.
    //
    // * `callback` {Function} to be called before the pane is destroyed.
    //
    // Returns a {Disposable} on which `.dispose()` can be called to unsubscribe.
    // Public: Invoke the given callback before the pane is destroyed.
    //
    // * `callback` {Function} to be called before the pane is destroyed.
    //
    // Returns a {Disposable} on which `.dispose()` can be called to unsubscribe.
    /**
     * @param {?} callback
     * @return {?}
     */
    Pane.prototype.onWillDestroy = 
    // Public: Invoke the given callback before the pane is destroyed.
    //
    // * `callback` {Function} to be called before the pane is destroyed.
    //
    // Returns a {Disposable} on which `.dispose()` can be called to unsubscribe.
    /**
     * @param {?} callback
     * @return {?}
     */
    function (callback) {
    };
    // Public: Invoke the given callback when the pane is destroyed.
    //
    // * `callback` {Function} to be called when the pane is destroyed.
    //
    // Returns a {Disposable} on which `.dispose()` can be called to unsubscribe.
    // Public: Invoke the given callback when the pane is destroyed.
    //
    // * `callback` {Function} to be called when the pane is destroyed.
    //
    // Returns a {Disposable} on which `.dispose()` can be called to unsubscribe.
    /**
     * @param {?} callback
     * @return {?}
     */
    Pane.prototype.onDidDestroy = 
    // Public: Invoke the given callback when the pane is destroyed.
    //
    // * `callback` {Function} to be called when the pane is destroyed.
    //
    // Returns a {Disposable} on which `.dispose()` can be called to unsubscribe.
    /**
     * @param {?} callback
     * @return {?}
     */
    function (callback) {
    };
    // Public: Invoke the given callback when the value of the {::isActive}
    // property changes.
    //
    // * `callback` {Function} to be called when the value of the {::isActive}
    //   property changes.
    //   * `active` {Boolean} indicating whether the pane is active.
    //
    // Returns a {Disposable} on which `.dispose()` can be called to unsubscribe.
    // Public: Invoke the given callback when the value of the {::isActive}
    // property changes.
    //
    // * `callback` {Function} to be called when the value of the {::isActive}
    //   property changes.
    //   * `active` {Boolean} indicating whether the pane is active.
    //
    // Returns a {Disposable} on which `.dispose()` can be called to unsubscribe.
    /**
     * @param {?} callback
     * @return {?}
     */
    Pane.prototype.onDidChangeActive = 
    // Public: Invoke the given callback when the value of the {::isActive}
    // property changes.
    //
    // * `callback` {Function} to be called when the value of the {::isActive}
    //   property changes.
    //   * `active` {Boolean} indicating whether the pane is active.
    //
    // Returns a {Disposable} on which `.dispose()` can be called to unsubscribe.
    /**
     * @param {?} callback
     * @return {?}
     */
    function (callback) {
        var _this = this;
        return this.container.onDidChangeActivePane(function (activePane) {
            /** @type {?} */
            var isActive = _this === activePane;
            callback(isActive);
        });
    };
    // Public: Invoke the given callback with the current and future values of the
    // {::isActive} property.
    //
    // * `callback` {Function} to be called with the current and future values of
    //   the {::isActive} property.
    //   * `active` {Boolean} indicating whether the pane is active.
    //
    // Returns a {Disposable} on which `.dispose()` can be called to unsubscribe.
    // Public: Invoke the given callback with the current and future values of the
    // {::isActive} property.
    //
    // * `callback` {Function} to be called with the current and future values of
    //   the {::isActive} property.
    //   * `active` {Boolean} indicating whether the pane is active.
    //
    // Returns a {Disposable} on which `.dispose()` can be called to unsubscribe.
    /**
     * @param {?} callback
     * @return {?}
     */
    Pane.prototype.observeActive = 
    // Public: Invoke the given callback with the current and future values of the
    // {::isActive} property.
    //
    // * `callback` {Function} to be called with the current and future values of
    //   the {::isActive} property.
    //   * `active` {Boolean} indicating whether the pane is active.
    //
    // Returns a {Disposable} on which `.dispose()` can be called to unsubscribe.
    /**
     * @param {?} callback
     * @return {?}
     */
    function (callback) {
        callback(this.isActive());
        return this.onDidChangeActive(callback);
    };
    // Public: Invoke the given callback when an item is added to the pane.
    //
    // * `callback` {Function} to be called with when items are added.
    //   * `event` {Object} with the following keys:
    //     * `item` The added pane item.
    //     * `index` {Number} indicating where the item is located.
    //
    // Returns a {Disposable} on which `.dispose()` can be called to unsubscribe.
    // Public: Invoke the given callback when an item is added to the pane.
    //
    // * `callback` {Function} to be called with when items are added.
    //   * `event` {Object} with the following keys:
    //     * `item` The added pane item.
    //     * `index` {Number} indicating where the item is located.
    //
    // Returns a {Disposable} on which `.dispose()` can be called to unsubscribe.
    /**
     * @param {?} callback
     * @return {?}
     */
    Pane.prototype.onDidAddItem = 
    // Public: Invoke the given callback when an item is added to the pane.
    //
    // * `callback` {Function} to be called with when items are added.
    //   * `event` {Object} with the following keys:
    //     * `item` The added pane item.
    //     * `index` {Number} indicating where the item is located.
    //
    // Returns a {Disposable} on which `.dispose()` can be called to unsubscribe.
    /**
     * @param {?} callback
     * @return {?}
     */
    function (callback) {
        return this.emitter.on('did-add-item', callback);
    };
    // Public: Invoke the given callback when an item is removed from the pane.
    //
    // * `callback` {Function} to be called with when items are removed.
    //   * `event` {Object} with the following keys:
    //     * `item` The removed pane item.
    //     * `index` {Number} indicating where the item was located.
    //
    // Returns a {Disposable} on which `.dispose()` can be called to unsubscribe.
    // Public: Invoke the given callback when an item is removed from the pane.
    //
    // * `callback` {Function} to be called with when items are removed.
    //   * `event` {Object} with the following keys:
    //     * `item` The removed pane item.
    //     * `index` {Number} indicating where the item was located.
    //
    // Returns a {Disposable} on which `.dispose()` can be called to unsubscribe.
    /**
     * @param {?} callback
     * @return {?}
     */
    Pane.prototype.onDidRemoveItem = 
    // Public: Invoke the given callback when an item is removed from the pane.
    //
    // * `callback` {Function} to be called with when items are removed.
    //   * `event` {Object} with the following keys:
    //     * `item` The removed pane item.
    //     * `index` {Number} indicating where the item was located.
    //
    // Returns a {Disposable} on which `.dispose()` can be called to unsubscribe.
    /**
     * @param {?} callback
     * @return {?}
     */
    function (callback) {
        return this.emitter.on('did-remove-item', callback);
    };
    // Public: Invoke the given callback before an item is removed from the pane.
    //
    // * `callback` {Function} to be called with when items are removed.
    //   * `event` {Object} with the following keys:
    //     * `item` The pane item to be removed.
    //     * `index` {Number} indicating where the item is located.
    // Public: Invoke the given callback before an item is removed from the pane.
    //
    // * `callback` {Function} to be called with when items are removed.
    //   * `event` {Object} with the following keys:
    //     * `item` The pane item to be removed.
    //     * `index` {Number} indicating where the item is located.
    /**
     * @param {?} callback
     * @return {?}
     */
    Pane.prototype.onWillRemoveItem = 
    // Public: Invoke the given callback before an item is removed from the pane.
    //
    // * `callback` {Function} to be called with when items are removed.
    //   * `event` {Object} with the following keys:
    //     * `item` The pane item to be removed.
    //     * `index` {Number} indicating where the item is located.
    /**
     * @param {?} callback
     * @return {?}
     */
    function (callback) {
    };
    // Public: Invoke the given callback when an item is moved within the pane.
    //
    // * `callback` {Function} to be called with when items are moved.
    //   * `event` {Object} with the following keys:
    //     * `item` The removed pane item.
    //     * `oldIndex` {Number} indicating where the item was located.
    //     * `newIndex` {Number} indicating where the item is now located.
    //
    // Returns a {Disposable} on which `.dispose()` can be called to unsubscribe.
    // Public: Invoke the given callback when an item is moved within the pane.
    //
    // * `callback` {Function} to be called with when items are moved.
    //   * `event` {Object} with the following keys:
    //     * `item` The removed pane item.
    //     * `oldIndex` {Number} indicating where the item was located.
    //     * `newIndex` {Number} indicating where the item is now located.
    //
    // Returns a {Disposable} on which `.dispose()` can be called to unsubscribe.
    /**
     * @param {?} callback
     * @return {?}
     */
    Pane.prototype.onDidMoveItem = 
    // Public: Invoke the given callback when an item is moved within the pane.
    //
    // * `callback` {Function} to be called with when items are moved.
    //   * `event` {Object} with the following keys:
    //     * `item` The removed pane item.
    //     * `oldIndex` {Number} indicating where the item was located.
    //     * `newIndex` {Number} indicating where the item is now located.
    //
    // Returns a {Disposable} on which `.dispose()` can be called to unsubscribe.
    /**
     * @param {?} callback
     * @return {?}
     */
    function (callback) {
    };
    // Public: Invoke the given callback with all current and future items.
    //
    // * `callback` {Function} to be called with current and future items.
    //   * `item` An item that is present in {::getItems} at the time of
    //     subscription or that is added at some later time.
    //
    // Returns a {Disposable} on which `.dispose()` can be called to unsubscribe.
    // Public: Invoke the given callback with all current and future items.
    //
    // * `callback` {Function} to be called with current and future items.
    //   * `item` An item that is present in {::getItems} at the time of
    //     subscription or that is added at some later time.
    //
    // Returns a {Disposable} on which `.dispose()` can be called to unsubscribe.
    /**
     * @param {?} callback
     * @return {?}
     */
    Pane.prototype.observeItems = 
    // Public: Invoke the given callback with all current and future items.
    //
    // * `callback` {Function} to be called with current and future items.
    //   * `item` An item that is present in {::getItems} at the time of
    //     subscription or that is added at some later time.
    //
    // Returns a {Disposable} on which `.dispose()` can be called to unsubscribe.
    /**
     * @param {?} callback
     * @return {?}
     */
    function (callback) {
        var e_3, _a;
        try {
            for (var _b = tslib_1.__values(this.getItems()), _c = _b.next(); !_c.done; _c = _b.next()) {
                var item = _c.value;
                callback(item);
            }
        }
        catch (e_3_1) { e_3 = { error: e_3_1 }; }
        finally {
            try {
                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
            }
            finally { if (e_3) throw e_3.error; }
        }
        return this.onDidAddItem(function (_a) {
            var item = _a.item;
            return callback(item);
        });
    };
    // 公有方法： 当{::getActiveItem}值变换前调用。
    // 公有方法： 当{::getActiveItem}值变换前调用。
    /**
     * @param {?} callback
     * @return {?}
     */
    Pane.prototype.onDoingChangeActiveItem = 
    // 公有方法： 当{::getActiveItem}值变换前调用。
    /**
     * @param {?} callback
     * @return {?}
     */
    function (callback) {
        return this.emitter.on('doing-change-active-item', callback);
    };
    // Public: Invoke the given callback when the value of {::getActiveItem}
    // changes.
    //
    // * `callback` {Function} to be called with when the active item changes.
    //   * `activeItem` The current active item.
    //
    // Returns a {Disposable} on which `.dispose()` can be called to unsubscribe.
    // Public: Invoke the given callback when the value of {::getActiveItem}
    // changes.
    //
    // * `callback` {Function} to be called with when the active item changes.
    //   * `activeItem` The current active item.
    //
    // Returns a {Disposable} on which `.dispose()` can be called to unsubscribe.
    /**
     * @param {?} callback
     * @return {?}
     */
    Pane.prototype.onDidChangeActiveItem = 
    // Public: Invoke the given callback when the value of {::getActiveItem}
    // changes.
    //
    // * `callback` {Function} to be called with when the active item changes.
    //   * `activeItem` The current active item.
    //
    // Returns a {Disposable} on which `.dispose()` can be called to unsubscribe.
    /**
     * @param {?} callback
     * @return {?}
     */
    function (callback) {
        return this.emitter.on('did-change-active-item', callback);
    };
    // Public: Invoke the given callback when {::activateNextRecentlyUsedItem}
    // has been called, either initiating or continuing a forward MRU traversal of
    // pane items.
    //
    // * `callback` {Function} to be called with when the active item changes.
    //   * `nextRecentlyUsedItem` The next MRU item, now being set active
    //
    // Returns a {Disposable} on which `.dispose()` can be called to unsubscribe.
    // Public: Invoke the given callback when {::activateNextRecentlyUsedItem}
    // has been called, either initiating or continuing a forward MRU traversal of
    // pane items.
    //
    // * `callback` {Function} to be called with when the active item changes.
    //   * `nextRecentlyUsedItem` The next MRU item, now being set active
    //
    // Returns a {Disposable} on which `.dispose()` can be called to unsubscribe.
    /**
     * @param {?} callback
     * @return {?}
     */
    Pane.prototype.onChooseNextMRUItem = 
    // Public: Invoke the given callback when {::activateNextRecentlyUsedItem}
    // has been called, either initiating or continuing a forward MRU traversal of
    // pane items.
    //
    // * `callback` {Function} to be called with when the active item changes.
    //   * `nextRecentlyUsedItem` The next MRU item, now being set active
    //
    // Returns a {Disposable} on which `.dispose()` can be called to unsubscribe.
    /**
     * @param {?} callback
     * @return {?}
     */
    function (callback) {
    };
    // Public: Invoke the given callback when {::activatePreviousRecentlyUsedItem}
    // has been called, either initiating or continuing a reverse MRU traversal of
    // pane items.
    //
    // * `callback` {Function} to be called with when the active item changes.
    //   * `previousRecentlyUsedItem` The previous MRU item, now being set active
    //
    // Returns a {Disposable} on which `.dispose()` can be called to unsubscribe.
    // Public: Invoke the given callback when {::activatePreviousRecentlyUsedItem}
    // has been called, either initiating or continuing a reverse MRU traversal of
    // pane items.
    //
    // * `callback` {Function} to be called with when the active item changes.
    //   * `previousRecentlyUsedItem` The previous MRU item, now being set active
    //
    // Returns a {Disposable} on which `.dispose()` can be called to unsubscribe.
    /**
     * @param {?} callback
     * @return {?}
     */
    Pane.prototype.onChooseLastMRUItem = 
    // Public: Invoke the given callback when {::activatePreviousRecentlyUsedItem}
    // has been called, either initiating or continuing a reverse MRU traversal of
    // pane items.
    //
    // * `callback` {Function} to be called with when the active item changes.
    //   * `previousRecentlyUsedItem` The previous MRU item, now being set active
    //
    // Returns a {Disposable} on which `.dispose()` can be called to unsubscribe.
    /**
     * @param {?} callback
     * @return {?}
     */
    function (callback) {
    };
    // Public: Invoke the given callback when {::moveActiveItemToTopOfStack}
    // has been called, terminating an MRU traversal of pane items and moving the
    // current active item to the top of the stack. Typically bound to a modifier
    // (e.g. CTRL) key up event.
    //
    // * `callback` {Function} to be called with when the MRU traversal is done.
    //
    // Returns a {Disposable} on which `.dispose()` can be called to unsubscribe.
    // Public: Invoke the given callback when {::moveActiveItemToTopOfStack}
    // has been called, terminating an MRU traversal of pane items and moving the
    // current active item to the top of the stack. Typically bound to a modifier
    // (e.g. CTRL) key up event.
    //
    // * `callback` {Function} to be called with when the MRU traversal is done.
    //
    // Returns a {Disposable} on which `.dispose()` can be called to unsubscribe.
    /**
     * @param {?} callback
     * @return {?}
     */
    Pane.prototype.onDoneChoosingMRUItem = 
    // Public: Invoke the given callback when {::moveActiveItemToTopOfStack}
    // has been called, terminating an MRU traversal of pane items and moving the
    // current active item to the top of the stack. Typically bound to a modifier
    // (e.g. CTRL) key up event.
    //
    // * `callback` {Function} to be called with when the MRU traversal is done.
    //
    // Returns a {Disposable} on which `.dispose()` can be called to unsubscribe.
    /**
     * @param {?} callback
     * @return {?}
     */
    function (callback) {
    };
    // Public: Invoke the given callback with the current and future values of
    // {::getActiveItem}.
    //
    // * `callback` {Function} to be called with the current and future active
    //   items.
    //   * `activeItem` The current active item.
    //
    // Returns a {Disposable} on which `.dispose()` can be called to unsubscribe.
    // Public: Invoke the given callback with the current and future values of
    // {::getActiveItem}.
    //
    // * `callback` {Function} to be called with the current and future active
    //   items.
    //   * `activeItem` The current active item.
    //
    // Returns a {Disposable} on which `.dispose()` can be called to unsubscribe.
    /**
     * @param {?} callback
     * @return {?}
     */
    Pane.prototype.observeActiveItem = 
    // Public: Invoke the given callback with the current and future values of
    // {::getActiveItem}.
    //
    // * `callback` {Function} to be called with the current and future active
    //   items.
    //   * `activeItem` The current active item.
    //
    // Returns a {Disposable} on which `.dispose()` can be called to unsubscribe.
    /**
     * @param {?} callback
     * @return {?}
     */
    function (callback) {
        callback(this.getActiveItem());
        return this.onDidChangeActiveItem(callback);
    };
    // Public: Invoke the given callback before items are destroyed.
    //
    // * `callback` {Function} to be called before items are destroyed.
    //   * `event` {Object} with the following keys:
    //     * `item` The item that will be destroyed.
    //     * `index` The location of the item.
    //
    // Returns a {Disposable} on which `.dispose()` can be called to
    // unsubscribe.
    // Public: Invoke the given callback before items are destroyed.
    //
    // * `callback` {Function} to be called before items are destroyed.
    //   * `event` {Object} with the following keys:
    //     * `item` The item that will be destroyed.
    //     * `index` The location of the item.
    //
    // Returns a {Disposable} on which `.dispose()` can be called to
    // unsubscribe.
    /**
     * @param {?} callback
     * @return {?}
     */
    Pane.prototype.onWillDestroyItem = 
    // Public: Invoke the given callback before items are destroyed.
    //
    // * `callback` {Function} to be called before items are destroyed.
    //   * `event` {Object} with the following keys:
    //     * `item` The item that will be destroyed.
    //     * `index` The location of the item.
    //
    // Returns a {Disposable} on which `.dispose()` can be called to
    // unsubscribe.
    /**
     * @param {?} callback
     * @return {?}
     */
    function (callback) {
    };
    // Called by the view layer to indicate that the pane has gained focus.
    // Called by the view layer to indicate that the pane has gained focus.
    /**
     * @return {?}
     */
    Pane.prototype.focus = 
    // Called by the view layer to indicate that the pane has gained focus.
    /**
     * @return {?}
     */
    function () {
        this.focused = true;
        return this.activate();
    };
    // Called by the view layer to indicate that the pane has lost focus.
    // Called by the view layer to indicate that the pane has lost focus.
    /**
     * @return {?}
     */
    Pane.prototype.blur = 
    // Called by the view layer to indicate that the pane has lost focus.
    /**
     * @return {?}
     */
    function () {
        this.focused = false;
        return true; // if this is called from an event handler, don't cancel it
    };
    /**
     * @return {?}
     */
    Pane.prototype.isFocused = /**
     * @return {?}
     */
    function () { return this.focused; };
    /**
     * @return {?}
     */
    Pane.prototype.getPanes = /**
     * @return {?}
     */
    function () { return [this]; };
    /**
     * @param {?} item
     * @return {?}
     */
    Pane.prototype.unsubscribeFromItem = /**
     * @param {?} item
     * @return {?}
     */
    function (item) {
        /** @type {?} */
        var subscription = this.subscriptionsPerItem.get(item);
        if (subscription) {
            subscription.dispose();
            this.subscriptionsPerItem.delete(item);
        }
    };
    /*
    Section: Items
    */
    // Public: Get the items in this pane.
    //
    // Returns an {Array} of items.
    /*
      Section: Items
      */
    // Public: Get the items in this pane.
    //
    // Returns an {Array} of items.
    /**
     * @return {?}
     */
    Pane.prototype.getItems = /*
      Section: Items
      */
    // Public: Get the items in this pane.
    //
    // Returns an {Array} of items.
    /**
     * @return {?}
     */
    function () {
        return this.items.slice();
    };
    // Public: Get the active pane item in this pane.
    //
    // Returns a pane item.
    // Public: Get the active pane item in this pane.
    //
    // Returns a pane item.
    /**
     * @return {?}
     */
    Pane.prototype.getActiveItem = 
    // Public: Get the active pane item in this pane.
    //
    // Returns a pane item.
    /**
     * @return {?}
     */
    function () { return this.activeItem; };
    /**
     * @param {?=} activeItem
     * @param {?=} options
     * @return {?}
     */
    Pane.prototype.setActiveItem = /**
     * @param {?=} activeItem
     * @param {?=} options
     * @return {?}
     */
    function (activeItem, options) {
        /** @type {?} */
        var modifyStack = options && options.modifyStack;
        if (activeItem !== this.activeItem) {
            if (modifyStack !== false) {
                this.addItemToStack(activeItem);
            }
            this.emitter.emit('doing-change-active-item', this.activeItem);
            this.activeItem = activeItem;
            this.emitter.emit('did-change-active-item', this.activeItem);
            if (this.container) {
                this.container.didChangeActiveItemOnPane(this, this.activeItem);
            }
        }
        return this.activeItem;
    };
    // Build the itemStack after deserializing
    // Build the itemStack after deserializing
    /**
     * @param {?} itemStackIndices
     * @return {?}
     */
    Pane.prototype.addItemsToStack = 
    // Build the itemStack after deserializing
    /**
     * @param {?} itemStackIndices
     * @return {?}
     */
    function (itemStackIndices) {
        var e_4, _a;
        if (this.items.length > 0) {
            if (itemStackIndices.length !== this.items.length || itemStackIndices.includes(-1)) {
                itemStackIndices = this.items.map(function (item, i) { return i; });
            }
            try {
                for (var itemStackIndices_1 = tslib_1.__values(itemStackIndices), itemStackIndices_1_1 = itemStackIndices_1.next(); !itemStackIndices_1_1.done; itemStackIndices_1_1 = itemStackIndices_1.next()) {
                    var itemIndex = itemStackIndices_1_1.value;
                    this.addItemToStack(this.items[itemIndex]);
                }
            }
            catch (e_4_1) { e_4 = { error: e_4_1 }; }
            finally {
                try {
                    if (itemStackIndices_1_1 && !itemStackIndices_1_1.done && (_a = itemStackIndices_1.return)) _a.call(itemStackIndices_1);
                }
                finally { if (e_4) throw e_4.error; }
            }
        }
    };
    // Add item (or move item) to the end of the itemStack
    // Add item (or move item) to the end of the itemStack
    /**
     * @param {?} newItem
     * @return {?}
     */
    Pane.prototype.addItemToStack = 
    // Add item (or move item) to the end of the itemStack
    /**
     * @param {?} newItem
     * @return {?}
     */
    function (newItem) {
        if (newItem == null) {
            return;
        }
        /** @type {?} */
        var index = this.itemStack.indexOf(newItem);
        if (index !== -1) {
            this.itemStack.splice(index, 1);
        }
        return this.itemStack.push(newItem);
    };
    // Public: Return the item at the given index.
    //
    // * `index` {Number}
    //
    // Returns an item or `null` if no item exists at the given index.
    // Public: Return the item at the given index.
    //
    // * `index` {Number}
    //
    // Returns an item or `null` if no item exists at the given index.
    /**
     * @param {?} index
     * @return {?}
     */
    Pane.prototype.itemAtIndex = 
    // Public: Return the item at the given index.
    //
    // * `index` {Number}
    //
    // Returns an item or `null` if no item exists at the given index.
    /**
     * @param {?} index
     * @return {?}
     */
    function (index) {
        return this.items[index];
    };
    // Makes the next item in the itemStack active.
    // Makes the next item in the itemStack active.
    /**
     * @return {?}
     */
    Pane.prototype.activateNextRecentlyUsedItem = 
    // Makes the next item in the itemStack active.
    /**
     * @return {?}
     */
    function () {
        if (this.items.length > 1) {
            if (this.itemStackIndex == null) {
                this.itemStackIndex = this.itemStack.length - 1;
            }
            if (this.itemStackIndex === 0) {
                this.itemStackIndex = this.itemStack.length;
            }
            this.itemStackIndex--;
            /** @type {?} */
            var nextRecentlyUsedItem = this.itemStack[this.itemStackIndex];
            this.setActiveItem(nextRecentlyUsedItem, { modifyStack: false });
        }
    };
    // Makes the previous item in the itemStack active.
    // Makes the previous item in the itemStack active.
    /**
     * @return {?}
     */
    Pane.prototype.activatePreviousRecentlyUsedItem = 
    // Makes the previous item in the itemStack active.
    /**
     * @return {?}
     */
    function () {
        if (this.items.length > 1) {
            if (this.itemStackIndex + 1 === this.itemStack.length || this.itemStackIndex == null) {
                this.itemStackIndex = -1;
            }
            this.itemStackIndex++;
            /** @type {?} */
            var previousRecentlyUsedItem = this.itemStack[this.itemStackIndex];
            this.setActiveItem(previousRecentlyUsedItem, { modifyStack: false });
        }
    };
    // Moves the active item to the end of the itemStack once the ctrl key is lifted
    // Moves the active item to the end of the itemStack once the ctrl key is lifted
    /**
     * @return {?}
     */
    Pane.prototype.moveActiveItemToTopOfStack = 
    // Moves the active item to the end of the itemStack once the ctrl key is lifted
    /**
     * @return {?}
     */
    function () {
        delete this.itemStackIndex;
        this.addItemToStack(this.activeItem);
    };
    // Public: Makes the next item active.
    // Public: Makes the next item active.
    /**
     * @return {?}
     */
    Pane.prototype.activateNextItem = 
    // Public: Makes the next item active.
    /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var index = this.getActiveItemIndex();
        if (index < (this.items.length - 1)) {
            this.activateItemAtIndex(index + 1);
        }
        else {
            this.activateItemAtIndex(0);
        }
    };
    // Public: Makes the previous item active.
    // Public: Makes the previous item active.
    /**
     * @return {?}
     */
    Pane.prototype.activatePreviousItem = 
    // Public: Makes the previous item active.
    /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var index = this.getActiveItemIndex();
        if (index > 0) {
            this.activateItemAtIndex(index - 1);
        }
        else {
            this.activateItemAtIndex(this.items.length - 1);
        }
    };
    /**
     * @return {?}
     */
    Pane.prototype.activateLastItem = /**
     * @return {?}
     */
    function () {
        this.activateItemAtIndex(this.items.length - 1);
    };
    // Public: Move the active tab to the right.
    // Public: Move the active tab to the right.
    /**
     * @return {?}
     */
    Pane.prototype.moveItemRight = 
    // Public: Move the active tab to the right.
    /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var index = this.getActiveItemIndex();
        /** @type {?} */
        var rightItemIndex = index + 1;
        if (rightItemIndex <= this.items.length - 1) {
            this.moveItem(this.getActiveItem(), rightItemIndex);
        }
    };
    // Public: Move the active tab to the left
    // Public: Move the active tab to the left
    /**
     * @return {?}
     */
    Pane.prototype.moveItemLeft = 
    // Public: Move the active tab to the left
    /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var index = this.getActiveItemIndex();
        /** @type {?} */
        var leftItemIndex = index - 1;
        if (leftItemIndex >= 0) {
            return this.moveItem(this.getActiveItem(), leftItemIndex);
        }
    };
    // Public: Get the index of the active item.
    //
    // Returns a {Number}.
    // Public: Get the index of the active item.
    //
    // Returns a {Number}.
    /**
     * @return {?}
     */
    Pane.prototype.getActiveItemIndex = 
    // Public: Get the index of the active item.
    //
    // Returns a {Number}.
    /**
     * @return {?}
     */
    function () {
        return this.items.indexOf(this.activeItem);
    };
    // Public: Activate the item at the given index.
    //
    // * `index` {Number}
    // Public: Activate the item at the given index.
    //
    // * `index` {Number}
    /**
     * @param {?} index
     * @return {?}
     */
    Pane.prototype.activateItemAtIndex = 
    // Public: Activate the item at the given index.
    //
    // * `index` {Number}
    /**
     * @param {?} index
     * @return {?}
     */
    function (index) {
        /** @type {?} */
        var item = this.itemAtIndex(index) || this.getActiveItem();
        return this.setActiveItem(item);
    };
    // Public: Make the given item *active*, causing it to be displayed by
    // the pane's view.
    //
    // * `item` The item to activate
    // * `options` (optional) {Object}
    //   * `pending` (optional) {Boolean} indicating that the item should be added
    //     in a pending state if it does not yet exist in the pane. Existing pending
    //     items in a pane are replaced with new pending items when they are opened.
    // Public: Make the given item *active*, causing it to be displayed by
    // the pane's view.
    //
    // * `item` The item to activate
    // * `options` (optional) {Object}
    //   * `pending` (optional) {Boolean} indicating that the item should be added
    //     in a pending state if it does not yet exist in the pane. Existing pending
    //     items in a pane are replaced with new pending items when they are opened.
    /**
     * @param {?} item
     * @param {?=} options
     * @return {?}
     */
    Pane.prototype.activateItem = 
    // Public: Make the given item *active*, causing it to be displayed by
    // the pane's view.
    //
    // * `item` The item to activate
    // * `options` (optional) {Object}
    //   * `pending` (optional) {Boolean} indicating that the item should be added
    //     in a pending state if it does not yet exist in the pane. Existing pending
    //     items in a pane are replaced with new pending items when they are opened.
    /**
     * @param {?} item
     * @param {?=} options
     * @return {?}
     */
    function (item, options) {
        if (options === void 0) { options = {}; }
        if (item) {
            /** @type {?} */
            var index = (this.getPendingItem() === this.activeItem)
                ? this.getActiveItemIndex()
                : this.getActiveItemIndex() + 1;
            this.addItem(item, Object.assign({}, options, { index: index }));
            this.setActiveItem(item);
        }
    };
    // Public: Add the given item to the pane.
    //
    // * `item` The item to add. It can be a model with an associated view or a
    //   view.
    // * `options` (optional) {Object}
    //   * `index` (optional) {Number} indicating the index at which to add the item.
    //     If omitted, the item is added after the current active item.
    //   * `pending` (optional) {Boolean} indicating that the item should be
    //     added in a pending state. Existing pending items in a pane are replaced with
    //     new pending items when they are opened.
    //
    // Returns the added item.
    // Public: Add the given item to the pane.
    //
    // * `item` The item to add. It can be a model with an associated view or a
    //   view.
    // * `options` (optional) {Object}
    //   * `index` (optional) {Number} indicating the index at which to add the item.
    //     If omitted, the item is added after the current active item.
    //   * `pending` (optional) {Boolean} indicating that the item should be
    //     added in a pending state. Existing pending items in a pane are replaced with
    //     new pending items when they are opened.
    //
    // Returns the added item.
    /**
     * @param {?} item
     * @param {?=} options
     * @return {?}
     */
    Pane.prototype.addItem = 
    // Public: Add the given item to the pane.
    //
    // * `item` The item to add. It can be a model with an associated view or a
    //   view.
    // * `options` (optional) {Object}
    //   * `index` (optional) {Number} indicating the index at which to add the item.
    //     If omitted, the item is added after the current active item.
    //   * `pending` (optional) {Boolean} indicating that the item should be
    //     added in a pending state. Existing pending items in a pane are replaced with
    //     new pending items when they are opened.
    //
    // Returns the added item.
    /**
     * @param {?} item
     * @param {?=} options
     * @return {?}
     */
    function (item, options) {
        if (options === void 0) { options = {}; }
        // Backward compat with old API:
        //   addItem(item, index=@getActiveItemIndex() + 1)
        if (typeof options === 'number') {
            options = { index: options };
        }
        /** @type {?} */
        var index = options.index != null ? options.index : this.getActiveItemIndex() + 1;
        /** @type {?} */
        var moved = options.moved != null ? options.moved : false;
        /** @type {?} */
        var pending = options.pending != null ? options.pending : false;
        if (!item || typeof item !== 'object') {
            throw new Error("Pane items must be objects. Attempted to add item " + item + ".");
        }
        if (typeof item.isDestroyed === 'function' && item.isDestroyed()) {
            throw new Error("Adding a pane item with URI\n      '" + (typeof item.getURI === 'function' && item.getURI()) + "' that has already been destroyed");
        }
        if (this.items.find(function (it) { return it === item; })) {
            return;
        }
        if (typeof item.onDidDestroy === 'function') {
        }
        this.items.splice(index, 0, item);
        /** @type {?} */
        var lastPendingItem = this.getPendingItem();
        /** @type {?} */
        var replacingPendingItem = lastPendingItem != null && !moved;
        if (replacingPendingItem) {
            this.pendingItem = null;
        }
        if (pending) {
            this.setPendingItem(item);
        }
        this.emitter.emit('did-add-item', { item: item, index: index, moved: moved });
        if (!moved) {
            if (this.container) {
                this.container.didAddPaneItem(item, this, index);
            }
        }
        if (replacingPendingItem) {
            this.destroyItem(lastPendingItem);
        }
        if (!this.getActiveItem()) {
            this.setActiveItem(item);
        }
        return item;
    };
    /**
     * @param {?} item
     * @return {?}
     */
    Pane.prototype.setPendingItem = /**
     * @param {?} item
     * @return {?}
     */
    function (item) {
        if (this.pendingItem !== item) {
            /** @type {?} */
            var mostRecentPendingItem = this.pendingItem;
            this.pendingItem = item;
        }
    };
    /**
     * @return {?}
     */
    Pane.prototype.getPendingItem = /**
     * @return {?}
     */
    function () {
        return this.pendingItem || null;
    };
    /**
     * @return {?}
     */
    Pane.prototype.clearPendingItem = /**
     * @return {?}
     */
    function () {
        this.setPendingItem(null);
    };
    /**
     * @param {?} callback
     * @return {?}
     */
    Pane.prototype.onItemDidTerminatePendingState = /**
     * @param {?} callback
     * @return {?}
     */
    function (callback) {
    };
    // Public: Add the given items to the pane.
    //
    // * `items` An {Array} of items to add. Items can be views or models with
    //   associated views. Any objects that are already present in the pane's
    //   current items will not be added again.
    // * `index` (optional) {Number} index at which to add the items. If omitted,
    //   the item is #   added after the current active item.
    //
    // Returns an {Array} of added items.
    // Public: Add the given items to the pane.
    //
    // * `items` An {Array} of items to add. Items can be views or models with
    //   associated views. Any objects that are already present in the pane's
    //   current items will not be added again.
    // * `index` (optional) {Number} index at which to add the items. If omitted,
    //   the item is #   added after the current active item.
    //
    // Returns an {Array} of added items.
    /**
     * @param {?} items
     * @param {?=} index
     * @return {?}
     */
    Pane.prototype.addItems = 
    // Public: Add the given items to the pane.
    //
    // * `items` An {Array} of items to add. Items can be views or models with
    //   associated views. Any objects that are already present in the pane's
    //   current items will not be added again.
    // * `index` (optional) {Number} index at which to add the items. If omitted,
    //   the item is #   added after the current active item.
    //
    // Returns an {Array} of added items.
    /**
     * @param {?} items
     * @param {?=} index
     * @return {?}
     */
    function (items, index) {
        var _this = this;
        if (index === void 0) { index = this.getActiveItemIndex() + 1; }
        items = items.filter(function (item) { return !_this.items.find(function (it) { return it === item; }); });
        for (var i = 0; i < items.length; i++) {
            /** @type {?} */
            var item = items[i];
            this.addItem(item, { index: index + i });
        }
        return items;
    };
    /**
     * @param {?} item
     * @param {?=} moved
     * @return {?}
     */
    Pane.prototype.removeItem = /**
     * @param {?} item
     * @param {?=} moved
     * @return {?}
     */
    function (item, moved) {
        if (moved === void 0) { moved = false; }
        /** @type {?} */
        var index = this.items.indexOf(item);
        if (index === -1) {
            return;
        }
        if (this.getPendingItem() === item) {
            this.pendingItem = null;
        }
        this.removeItemFromStack(item);
        // this.emitter.emit('will-remove-item', {item, index, destroyed: !moved, moved});
        this.unsubscribeFromItem(item);
        if (item === this.activeItem) {
            if (this.items.length === 1) {
                this.setActiveItem(undefined);
            }
            else if (index === 0) {
                this.activateNextItem();
            }
            else {
                this.activatePreviousItem();
            }
        }
        this.items.splice(index, 1);
        this.emitter.emit('did-remove-item', { item: item, index: index, destroyed: !moved, moved: moved });
        if (!moved && this.container) {
            this.container.didDestroyPaneItem({ item: item, index: index, pane: this });
        }
        if (this.items.length === 0 && this.config && this.config.get && this.config.get('core.destroyEmptyPanes')) {
            this.destroy();
        }
    };
    // Remove the given item from the itemStack.
    //
    // * `item` The item to remove.
    // * `index` {Number} indicating the index to which to remove the item from the itemStack.
    // Remove the given item from the itemStack.
    //
    // * `item` The item to remove.
    // * `index` {Number} indicating the index to which to remove the item from the itemStack.
    /**
     * @param {?} item
     * @return {?}
     */
    Pane.prototype.removeItemFromStack = 
    // Remove the given item from the itemStack.
    //
    // * `item` The item to remove.
    // * `index` {Number} indicating the index to which to remove the item from the itemStack.
    /**
     * @param {?} item
     * @return {?}
     */
    function (item) {
        /** @type {?} */
        var index = this.itemStack.indexOf(item);
        if (index !== -1) {
            this.itemStack.splice(index, 1);
        }
    };
    // Public: Move the given item to the given index.
    //
    // * `item` The item to move.
    // * `index` {Number} indicating the index to which to move the item.
    // Public: Move the given item to the given index.
    //
    // * `item` The item to move.
    // * `index` {Number} indicating the index to which to move the item.
    /**
     * @param {?} item
     * @param {?} newIndex
     * @return {?}
     */
    Pane.prototype.moveItem = 
    // Public: Move the given item to the given index.
    //
    // * `item` The item to move.
    // * `index` {Number} indicating the index to which to move the item.
    /**
     * @param {?} item
     * @param {?} newIndex
     * @return {?}
     */
    function (item, newIndex) {
        /** @type {?} */
        var oldIndex = this.items.indexOf(item);
        this.items.splice(oldIndex, 1);
        this.items.splice(newIndex, 0, item);
    };
    // Public: Move the given item to the given index on another pane.
    //
    // * `item` The item to move.
    // * `pane` {Pane} to which to move the item.
    // * `index` {Number} indicating the index to which to move the item in the
    //   given pane.
    // Public: Move the given item to the given index on another pane.
    //
    // * `item` The item to move.
    // * `pane` {Pane} to which to move the item.
    // * `index` {Number} indicating the index to which to move the item in the
    //   given pane.
    /**
     * @param {?=} item
     * @param {?=} pane
     * @param {?=} index
     * @return {?}
     */
    Pane.prototype.moveItemToPane = 
    // Public: Move the given item to the given index on another pane.
    //
    // * `item` The item to move.
    // * `pane` {Pane} to which to move the item.
    // * `index` {Number} indicating the index to which to move the item in the
    //   given pane.
    /**
     * @param {?=} item
     * @param {?=} pane
     * @param {?=} index
     * @return {?}
     */
    function (item, pane, index) {
        this.removeItem(item, true);
        return pane.addItem(item, { index: index, moved: true });
    };
    // Public: Destroy the active item and activate the next item.
    //
    // Returns a {Promise} that resolves when the item is destroyed.
    // Public: Destroy the active item and activate the next item.
    //
    // Returns a {Promise} that resolves when the item is destroyed.
    /**
     * @return {?}
     */
    Pane.prototype.destroyActiveItem = 
    // Public: Destroy the active item and activate the next item.
    //
    // Returns a {Promise} that resolves when the item is destroyed.
    /**
     * @return {?}
     */
    function () {
        return this.destroyItem(this.activeItem);
    };
    // Public: Destroy the given item.
    //
    // If the item is active, the next item will be activated. If the item is the
    // last item, the pane will be destroyed if the `core.destroyEmptyPanes` config
    // setting is `true`.
    //
    // * `item` Item to destroy
    // * `force` (optional) {Boolean} Destroy the item without prompting to save
    //    it, even if the item's `isPermanentDockItem` method returns true.
    //
    // Returns a {Promise} that resolves with a {Boolean} indicating whether or not
    // the item was destroyed.
    // Public: Destroy the given item.
    //
    // If the item is active, the next item will be activated. If the item is the
    // last item, the pane will be destroyed if the `core.destroyEmptyPanes` config
    // setting is `true`.
    //
    // * `item` Item to destroy
    // * `force` (optional) {Boolean} Destroy the item without prompting to save
    //    it, even if the item's `isPermanentDockItem` method returns true.
    //
    // Returns a {Promise} that resolves with a {Boolean} indicating whether or not
    // the item was destroyed.
    /**
     * @param {?=} item
     * @param {?=} force
     * @return {?}
     */
    Pane.prototype.destroyItem = 
    // Public: Destroy the given item.
    //
    // If the item is active, the next item will be activated. If the item is the
    // last item, the pane will be destroyed if the `core.destroyEmptyPanes` config
    // setting is `true`.
    //
    // * `item` Item to destroy
    // * `force` (optional) {Boolean} Destroy the item without prompting to save
    //    it, even if the item's `isPermanentDockItem` method returns true.
    //
    // Returns a {Promise} that resolves with a {Boolean} indicating whether or not
    // the item was destroyed.
    /**
     * @param {?=} item
     * @param {?=} force
     * @return {?}
     */
    function (item, force) {
        return tslib_1.__awaiter(this, void 0, void 0, function () {
            var index;
            return tslib_1.__generator(this, function (_a) {
                index = this.items.indexOf(item);
                if (index === -1) {
                    return [2 /*return*/, false];
                }
                if (!force &&
                    typeof item.isPermanentDockItem === 'function' && item.isPermanentDockItem() &&
                    (!this.container || this.container.getLocation() !== 'center')) {
                    return [2 /*return*/, false];
                }
                // In the case where there are no `onWillDestroyPaneItem` listeners, preserve the old behavior
                // where `Pane.destroyItem` and callers such as `Pane.close` take effect synchronously.
                this.removeItem(item, false);
                if (typeof item.destroy === 'function') {
                    item.destroy();
                }
                return [2 /*return*/, true];
            });
        });
    };
    // Public: Destroy all items.
    // Public: Destroy all items.
    /**
     * @return {?}
     */
    Pane.prototype.destroyItems = 
    // Public: Destroy all items.
    /**
     * @return {?}
     */
    function () {
        var _this = this;
        return Promise.all(this.getItems().map(function (item) { return _this.destroyItem(item); }));
    };
    // Public: Destroy all items except for the active item.
    // Public: Destroy all items except for the active item.
    /**
     * @return {?}
     */
    Pane.prototype.destroyInactiveItems = 
    // Public: Destroy all items except for the active item.
    /**
     * @return {?}
     */
    function () {
        var _this = this;
        return Promise.all(this.getItems()
            .filter(function (item) { return item !== _this.activeItem; })
            .map(function (item) { return _this.destroyItem(item); }));
    };
    /**
     * @param {?} item
     * @param {?=} options
     * @return {?}
     */
    Pane.prototype.promptToSaveItem = /**
     * @param {?} item
     * @param {?=} options
     * @return {?}
     */
    function (item, options) {
        var _this = this;
        if (options === void 0) { options = {}; }
        if (typeof item.shouldPromptToSave !== 'function' || !item.shouldPromptToSave(options)) {
            return Promise.resolve(true);
        }
        /** @type {?} */
        var uri;
        if (typeof item.getURI === 'function') {
            uri = item.getURI();
        }
        else if (typeof item.getUri === 'function') {
            uri = item.getUri();
        }
        else {
            return Promise.resolve(true);
        }
        /** @type {?} */
        var title = (typeof item.getTitle === 'function' && item.getTitle()) || uri;
        /** @type {?} */
        var saveDialog = function (saveButtonText, saveFn, message) {
            /** @type {?} */
            var chosen = _this.applicationDelegate.confirm({
                message: message,
                detailedMessage: 'Your changes will be lost if you close this item without saving.',
                buttons: [saveButtonText, 'Cancel', '&Don\'t Save']
            });
            switch (chosen) {
                case 0:
                    return new Promise(function (resolve) {
                        return saveFn(item, function (error) {
                            if (error instanceof SaveCancelledError) {
                                resolve(false);
                            }
                            else if (error) {
                                saveDialog('Save as', _this.saveItemAs, "'" + title + "' could not be saved.\nError: " + _this.getMessageForErrorCode(error.code)).then(resolve);
                            }
                            else {
                                resolve(true);
                            }
                        });
                    });
                case 1:
                    return Promise.resolve(false);
                case 2:
                    return Promise.resolve(true);
            }
        };
        return saveDialog('Save', this.saveItem, "'" + title + "' has changes, do you want to save them?");
    };
    // Public: Save the active item.
    // Public: Save the active item.
    /**
     * @param {?=} nextAction
     * @return {?}
     */
    Pane.prototype.saveActiveItem = 
    // Public: Save the active item.
    /**
     * @param {?=} nextAction
     * @return {?}
     */
    function (nextAction) {
        return this.saveItem(this.getActiveItem(), nextAction);
    };
    // Public: Prompt the user for a location and save the active item with the
    // path they select.
    //
    // * `nextAction` (optional) {Function} which will be called after the item is
    //   successfully saved.
    //
    // Returns a {Promise} that resolves when the save is complete
    // Public: Prompt the user for a location and save the active item with the
    // path they select.
    //
    // * `nextAction` (optional) {Function} which will be called after the item is
    //   successfully saved.
    //
    // Returns a {Promise} that resolves when the save is complete
    /**
     * @param {?=} nextAction
     * @return {?}
     */
    Pane.prototype.saveActiveItemAs = 
    // Public: Prompt the user for a location and save the active item with the
    // path they select.
    //
    // * `nextAction` (optional) {Function} which will be called after the item is
    //   successfully saved.
    //
    // Returns a {Promise} that resolves when the save is complete
    /**
     * @param {?=} nextAction
     * @return {?}
     */
    function (nextAction) {
        return this.saveItemAs(this.getActiveItem(), nextAction);
    };
    // Public: Save the given item.
    //
    // * `item` The item to save.
    // * `nextAction` (optional) {Function} which will be called with no argument
    //   after the item is successfully saved, or with the error if it failed.
    //   The return value will be that of `nextAction` or `undefined` if it was not
    //   provided
    //
    // Returns a {Promise} that resolves when the save is complete
    // Public: Save the given item.
    //
    // * `item` The item to save.
    // * `nextAction` (optional) {Function} which will be called with no argument
    //   after the item is successfully saved, or with the error if it failed.
    //   The return value will be that of `nextAction` or `undefined` if it was not
    //   provided
    //
    // Returns a {Promise} that resolves when the save is complete
    /**
     * @param {?} item
     * @param {?} nextAction
     * @return {?}
     */
    Pane.prototype.saveItem = 
    // Public: Save the given item.
    //
    // * `item` The item to save.
    // * `nextAction` (optional) {Function} which will be called with no argument
    //   after the item is successfully saved, or with the error if it failed.
    //   The return value will be that of `nextAction` or `undefined` if it was not
    //   provided
    //
    // Returns a {Promise} that resolves when the save is complete
    /**
     * @param {?} item
     * @param {?} nextAction
     * @return {?}
     */
    function (item, nextAction) {
        var _this = this;
        if (!item) {
            return Promise.resolve();
        }
        /** @type {?} */
        var itemURI;
        if (typeof item.getURI === 'function') {
            itemURI = item.getURI();
        }
        else if (typeof item.getUri === 'function') {
            itemURI = item.getUri();
        }
        if (itemURI != null) {
            if (typeof item.save === 'function') {
                return promisify(function () { return item.save(); })
                    .then(function () {
                    if (nextAction) {
                        nextAction();
                    }
                })
                    .catch(function (error) {
                    if (nextAction) {
                        nextAction(error);
                    }
                    else {
                        _this.handleSaveError(error, item);
                    }
                });
            }
            else if (nextAction) {
                nextAction();
                return Promise.resolve();
            }
        }
        else {
            return this.saveItemAs(item, nextAction);
        }
    };
    // Public: Prompt the user for a location and save the active item with the
    // path they select.
    //
    // * `item` The item to save.
    // * `nextAction` (optional) {Function} which will be called with no argument
    //   after the item is successfully saved, or with the error if it failed.
    //   The return value will be that of `nextAction` or `undefined` if it was not
    //   provided
    // Public: Prompt the user for a location and save the active item with the
    // path they select.
    //
    // * `item` The item to save.
    // * `nextAction` (optional) {Function} which will be called with no argument
    //   after the item is successfully saved, or with the error if it failed.
    //   The return value will be that of `nextAction` or `undefined` if it was not
    //   provided
    /**
     * @param {?} item
     * @param {?} nextAction
     * @return {?}
     */
    Pane.prototype.saveItemAs = 
    // Public: Prompt the user for a location and save the active item with the
    // path they select.
    //
    // * `item` The item to save.
    // * `nextAction` (optional) {Function} which will be called with no argument
    //   after the item is successfully saved, or with the error if it failed.
    //   The return value will be that of `nextAction` or `undefined` if it was not
    //   provided
    /**
     * @param {?} item
     * @param {?} nextAction
     * @return {?}
     */
    function (item, nextAction) {
    };
    // Public: Save all items.
    // Public: Save all items.
    /**
     * @return {?}
     */
    Pane.prototype.saveItems = 
    // Public: Save all items.
    /**
     * @return {?}
     */
    function () {
    };
    // Public: Return the first item that matches the given URI or undefined if
    // none exists.
    //
    // * `uri` {String} containing a URI.
    // Public: Return the first item that matches the given URI or undefined if
    // none exists.
    //
    // * `uri` {String} containing a URI.
    /**
     * @param {?} uri
     * @return {?}
     */
    Pane.prototype.itemForURI = 
    // Public: Return the first item that matches the given URI or undefined if
    // none exists.
    //
    // * `uri` {String} containing a URI.
    /**
     * @param {?} uri
     * @return {?}
     */
    function (uri) {
        return this.items.find(function (item) {
            if (typeof item.getURI === 'function') {
                return item.getURI() === uri;
            }
            else if (typeof item.getUri === 'function') {
                return item.getUri() === uri;
            }
        });
    };
    // Public: Activate the first item that matches the given URI.
    //
    // * `uri` {String} containing a URI.
    //
    // Returns a {Boolean} indicating whether an item matching the URI was found.
    // Public: Activate the first item that matches the given URI.
    //
    // * `uri` {String} containing a URI.
    //
    // Returns a {Boolean} indicating whether an item matching the URI was found.
    /**
     * @param {?} uri
     * @return {?}
     */
    Pane.prototype.activateItemForURI = 
    // Public: Activate the first item that matches the given URI.
    //
    // * `uri` {String} containing a URI.
    //
    // Returns a {Boolean} indicating whether an item matching the URI was found.
    /**
     * @param {?} uri
     * @return {?}
     */
    function (uri) {
        /** @type {?} */
        var item = this.itemForURI(uri);
        if (item) {
            this.activateItem(item);
            return true;
        }
        else {
            return false;
        }
    };
    /**
     * @return {?}
     */
    Pane.prototype.copyActiveItem = /**
     * @return {?}
     */
    function () {
        if (this.activeItem && typeof this.activeItem.copy === 'function') {
            return this.activeItem.copy();
        }
    };
    /*
    Section: Lifecycle
    */
    // Public: Determine whether the pane is active.
    //
    // Returns a {Boolean}.
    /*
      Section: Lifecycle
      */
    // Public: Determine whether the pane is active.
    //
    // Returns a {Boolean}.
    /**
     * @return {?}
     */
    Pane.prototype.isActive = /*
      Section: Lifecycle
      */
    // Public: Determine whether the pane is active.
    //
    // Returns a {Boolean}.
    /**
     * @return {?}
     */
    function () {
        return this.container && this.container.getActivePane() === this;
    };
    // Public: Makes this pane the *active* pane, causing it to gain focus.
    // Public: Makes this pane the *active* pane, causing it to gain focus.
    /**
     * @return {?}
     */
    Pane.prototype.activate = 
    // Public: Makes this pane the *active* pane, causing it to gain focus.
    /**
     * @return {?}
     */
    function () {
    };
    // Public: Close the pane and destroy all its items.
    //
    // If this is the last pane, all the items will be destroyed but the pane
    // itself will not be destroyed.
    // Public: Close the pane and destroy all its items.
    //
    // If this is the last pane, all the items will be destroyed but the pane
    // itself will not be destroyed.
    /**
     * @return {?}
     */
    Pane.prototype.destroy = 
    // Public: Close the pane and destroy all its items.
    //
    // If this is the last pane, all the items will be destroyed but the pane
    // itself will not be destroyed.
    /**
     * @return {?}
     */
    function () {
    };
    /**
     * @return {?}
     */
    Pane.prototype.isAlive = /**
     * @return {?}
     */
    function () { return this.alive; };
    // Public: Determine whether this pane has been destroyed.
    //
    // Returns a {Boolean}.
    // Public: Determine whether this pane has been destroyed.
    //
    // Returns a {Boolean}.
    /**
     * @return {?}
     */
    Pane.prototype.isDestroyed = 
    // Public: Determine whether this pane has been destroyed.
    //
    // Returns a {Boolean}.
    /**
     * @return {?}
     */
    function () { return !this.isAlive(); };
    /*
    Section: Splitting
    */
    // Public: Create a new pane to the left of this pane.
    //
    // * `params` (optional) {Object} with the following keys:
    //   * `items` (optional) {Array} of items to add to the new pane.
    //   * `copyActiveItem` (optional) {Boolean} true will copy the active item into the new split pane
    //
    // Returns the new {Pane}.
    /*
      Section: Splitting
      */
    // Public: Create a new pane to the left of this pane.
    //
    // * `params` (optional) {Object} with the following keys:
    //   * `items` (optional) {Array} of items to add to the new pane.
    //   * `copyActiveItem` (optional) {Boolean} true will copy the active item into the new split pane
    //
    // Returns the new {Pane}.
    /**
     * @param {?} params
     * @return {?}
     */
    Pane.prototype.splitLeft = /*
      Section: Splitting
      */
    // Public: Create a new pane to the left of this pane.
    //
    // * `params` (optional) {Object} with the following keys:
    //   * `items` (optional) {Array} of items to add to the new pane.
    //   * `copyActiveItem` (optional) {Boolean} true will copy the active item into the new split pane
    //
    // Returns the new {Pane}.
    /**
     * @param {?} params
     * @return {?}
     */
    function (params) {
        return this.split('horizontal', 'before', params);
    };
    // Public: Create a new pane to the right of this pane.
    //
    // * `params` (optional) {Object} with the following keys:
    //   * `items` (optional) {Array} of items to add to the new pane.
    //   * `copyActiveItem` (optional) {Boolean} true will copy the active item into the new split pane
    //
    // Returns the new {Pane}.
    // Public: Create a new pane to the right of this pane.
    //
    // * `params` (optional) {Object} with the following keys:
    //   * `items` (optional) {Array} of items to add to the new pane.
    //   * `copyActiveItem` (optional) {Boolean} true will copy the active item into the new split pane
    //
    // Returns the new {Pane}.
    /**
     * @param {?} params
     * @return {?}
     */
    Pane.prototype.splitRight = 
    // Public: Create a new pane to the right of this pane.
    //
    // * `params` (optional) {Object} with the following keys:
    //   * `items` (optional) {Array} of items to add to the new pane.
    //   * `copyActiveItem` (optional) {Boolean} true will copy the active item into the new split pane
    //
    // Returns the new {Pane}.
    /**
     * @param {?} params
     * @return {?}
     */
    function (params) {
        return this.split('horizontal', 'after', params);
    };
    // Public: Creates a new pane above the receiver.
    //
    // * `params` (optional) {Object} with the following keys:
    //   * `items` (optional) {Array} of items to add to the new pane.
    //   * `copyActiveItem` (optional) {Boolean} true will copy the active item into the new split pane
    //
    // Returns the new {Pane}.
    // Public: Creates a new pane above the receiver.
    //
    // * `params` (optional) {Object} with the following keys:
    //   * `items` (optional) {Array} of items to add to the new pane.
    //   * `copyActiveItem` (optional) {Boolean} true will copy the active item into the new split pane
    //
    // Returns the new {Pane}.
    /**
     * @param {?} params
     * @return {?}
     */
    Pane.prototype.splitUp = 
    // Public: Creates a new pane above the receiver.
    //
    // * `params` (optional) {Object} with the following keys:
    //   * `items` (optional) {Array} of items to add to the new pane.
    //   * `copyActiveItem` (optional) {Boolean} true will copy the active item into the new split pane
    //
    // Returns the new {Pane}.
    /**
     * @param {?} params
     * @return {?}
     */
    function (params) {
        return this.split('vertical', 'before', params);
    };
    // Public: Creates a new pane below the receiver.
    //
    // * `params` (optional) {Object} with the following keys:
    //   * `items` (optional) {Array} of items to add to the new pane.
    //   * `copyActiveItem` (optional) {Boolean} true will copy the active item into the new split pane
    //
    // Returns the new {Pane}.
    // Public: Creates a new pane below the receiver.
    //
    // * `params` (optional) {Object} with the following keys:
    //   * `items` (optional) {Array} of items to add to the new pane.
    //   * `copyActiveItem` (optional) {Boolean} true will copy the active item into the new split pane
    //
    // Returns the new {Pane}.
    /**
     * @param {?} params
     * @return {?}
     */
    Pane.prototype.splitDown = 
    // Public: Creates a new pane below the receiver.
    //
    // * `params` (optional) {Object} with the following keys:
    //   * `items` (optional) {Array} of items to add to the new pane.
    //   * `copyActiveItem` (optional) {Boolean} true will copy the active item into the new split pane
    //
    // Returns the new {Pane}.
    /**
     * @param {?} params
     * @return {?}
     */
    function (params) {
        return this.split('vertical', 'after', params);
    };
    /**
     * @param {?} orientation
     * @param {?} side
     * @param {?} params
     * @return {?}
     */
    Pane.prototype.split = /**
     * @param {?} orientation
     * @param {?} side
     * @param {?} params
     * @return {?}
     */
    function (orientation, side, params) {
        if (params && params.copyActiveItem) {
            if (!params.items) {
                params.items = [];
            }
            params.items.push(this.copyActiveItem());
        }
        if (this.parent.orientation !== orientation) {
            this.parent.replaceChild(this, new PaneAxis({
                container: this.container,
                orientation: orientation,
                children: [this],
                flexScale: this.flexScale
            }, this.viewRegistry));
            this.setFlexScale(1);
        }
        /** @type {?} */
        var newPane = new Pane(Object.assign({
            applicationDelegate: this.applicationDelegate,
            notificationManager: this.notificationManager,
            deserializerManager: this.deserializerManager,
            config: this.config,
            viewRegistry: this.viewRegistry
        }, params));
        switch (side) {
            case 'before':
                this.parent.insertChildBefore(this, newPane);
                break;
            case 'after':
                this.parent.insertChildAfter(this, newPane);
                break;
        }
        if (params && params.moveActiveItem && this.activeItem) {
            this.moveItemToPane(this.activeItem, newPane);
        }
        newPane.activate();
        return newPane;
    };
    // If the parent is a horizontal axis, returns its first child if it is a pane;
    // otherwise returns this pane.
    // If the parent is a horizontal axis, returns its first child if it is a pane;
    // otherwise returns this pane.
    /**
     * @return {?}
     */
    Pane.prototype.findLeftmostSibling = 
    // If the parent is a horizontal axis, returns its first child if it is a pane;
    // otherwise returns this pane.
    /**
     * @return {?}
     */
    function () {
        if (this.parent.orientation === 'horizontal') {
            var _a = tslib_1.__read(this.parent.children, 1), leftmostSibling = _a[0];
            if (leftmostSibling instanceof PaneAxis) {
                return this;
            }
            else {
                return leftmostSibling;
            }
        }
        else {
            return this;
        }
    };
    /**
     * @return {?}
     */
    Pane.prototype.findRightmostSibling = /**
     * @return {?}
     */
    function () {
        if (this.parent.orientation === 'horizontal') {
            /** @type {?} */
            var rightmostSibling = this.parent.children[this.parent.children.length - 1];
            if (rightmostSibling instanceof PaneAxis) {
                return this;
            }
            else {
                return rightmostSibling;
            }
        }
        else {
            return this;
        }
    };
    // If the parent is a horizontal axis, returns its last child if it is a pane;
    // otherwise returns a new pane created by splitting this pane rightward.
    // If the parent is a horizontal axis, returns its last child if it is a pane;
    // otherwise returns a new pane created by splitting this pane rightward.
    /**
     * @return {?}
     */
    Pane.prototype.findOrCreateRightmostSibling = 
    // If the parent is a horizontal axis, returns its last child if it is a pane;
    // otherwise returns a new pane created by splitting this pane rightward.
    /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var rightmostSibling = this.findRightmostSibling();
        if (rightmostSibling === this) {
            return this.splitRight({});
        }
        else {
            return rightmostSibling;
        }
    };
    // If the parent is a vertical axis, returns its first child if it is a pane;
    // otherwise returns this pane.
    // If the parent is a vertical axis, returns its first child if it is a pane;
    // otherwise returns this pane.
    /**
     * @return {?}
     */
    Pane.prototype.findTopmostSibling = 
    // If the parent is a vertical axis, returns its first child if it is a pane;
    // otherwise returns this pane.
    /**
     * @return {?}
     */
    function () {
        if (this.parent.orientation === 'vertical') {
            var _a = tslib_1.__read(this.parent.children, 1), topmostSibling = _a[0];
            if (topmostSibling instanceof PaneAxis) {
                return this;
            }
            else {
                return topmostSibling;
            }
        }
        else {
            return this;
        }
    };
    /**
     * @return {?}
     */
    Pane.prototype.findBottommostSibling = /**
     * @return {?}
     */
    function () {
        if (this.parent.orientation === 'vertical') {
            /** @type {?} */
            var bottommostSibling = this.parent.children[this.parent.children.length - 1];
            if (bottommostSibling instanceof PaneAxis) {
                return this;
            }
            else {
                return bottommostSibling;
            }
        }
        else {
            return this;
        }
    };
    // If the parent is a vertical axis, returns its last child if it is a pane;
    // otherwise returns a new pane created by splitting this pane bottomward.
    // If the parent is a vertical axis, returns its last child if it is a pane;
    // otherwise returns a new pane created by splitting this pane bottomward.
    /**
     * @return {?}
     */
    Pane.prototype.findOrCreateBottommostSibling = 
    // If the parent is a vertical axis, returns its last child if it is a pane;
    // otherwise returns a new pane created by splitting this pane bottomward.
    /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var bottommostSibling = this.findBottommostSibling();
        if (bottommostSibling === this) {
            return this.splitDown({});
        }
        else {
            return bottommostSibling;
        }
    };
    // Private: Close the pane unless the user cancels the action via a dialog.
    //
    // Returns a {Promise} that resolves once the pane is either closed, or the
    // closing has been cancelled.
    // Private: Close the pane unless the user cancels the action via a dialog.
    //
    // Returns a {Promise} that resolves once the pane is either closed, or the
    // closing has been cancelled.
    /**
     * @return {?}
     */
    Pane.prototype.close = 
    // Private: Close the pane unless the user cancels the action via a dialog.
    //
    // Returns a {Promise} that resolves once the pane is either closed, or the
    // closing has been cancelled.
    /**
     * @return {?}
     */
    function () {
        var _this = this;
        return Promise.all(this.getItems().map(function (item) { return _this.promptToSaveItem(item); }))
            .then(function (results) {
            if (!results.find(function (item) { return item === false; })) {
                return _this.destroy();
            }
        });
    };
    /**
     * @param {?} error
     * @param {?} item
     * @return {?}
     */
    Pane.prototype.handleSaveError = /**
     * @param {?} error
     * @param {?} item
     * @return {?}
     */
    function (error, item) {
    };
    /**
     * @param {?} errorCode
     * @return {?}
     */
    Pane.prototype.getMessageForErrorCode = /**
     * @param {?} errorCode
     * @return {?}
     */
    function (errorCode) {
        switch (errorCode) {
            case 'EACCES': return 'Permission denied';
            case 'ECONNRESET': return 'Connection reset';
            case 'EINTR': return 'Interrupted system call';
            case 'EIO': return 'I/O error writing file';
            case 'ENOSPC': return 'No space left on device';
            case 'ENOTSUP': return 'Operation not supported on socket';
            case 'ENXIO': return 'No such device or address';
            case 'EROFS': return 'Read-only file system';
            case 'ESPIPE': return 'Invalid seek';
            case 'ETIMEDOUT': return 'Connection timed out';
        }
    };
    return Pane;
}());
// Extended: A container for presenting content in the center of the workspace.
// Panes can contain multiple items, one of which is *active* at a given time.
// The view corresponding to the active item is displayed in the interface. In
// the default configuration, tabs are also displayed for each item.
//
// Each pane may also contain one *pending* item. When a pending item is added
// to a pane, it will replace the currently pending item, if any, instead of
// simply being added. In the default configuration, the text in the tab for
// pending items is shown in italics.
export { Pane };
if (false) {
    /** @type {?} */
    Pane.prototype.id;
    /** @type {?} */
    Pane.prototype.activeItem;
    /** @type {?} */
    Pane.prototype.focused;
    /** @type {?} */
    Pane.prototype.applicationDelegate;
    /** @type {?} */
    Pane.prototype.notificationManager;
    /** @type {?} */
    Pane.prototype.config;
    /** @type {?} */
    Pane.prototype.deserializerManager;
    /** @type {?} */
    Pane.prototype.viewRegistry;
    /**
     * @type {?}
     * @private
     */
    Pane.prototype.emitter;
    /** @type {?} */
    Pane.prototype.alive;
    /** @type {?} */
    Pane.prototype.subscriptionsPerItem;
    /** @type {?} */
    Pane.prototype.items;
    /** @type {?} */
    Pane.prototype.itemStack;
    /** @type {?} */
    Pane.prototype.container;
    /** @type {?} */
    Pane.prototype.flexScale;
    /** @type {?} */
    Pane.prototype.parent;
    /** @type {?} */
    Pane.prototype.itemStackIndex;
    /** @type {?} */
    Pane.prototype.pendingItem;
}
/**
 * @param {?} callback
 * @return {?}
 */
function promisify(callback) {
    try {
        return Promise.resolve(callback());
    }
    catch (error) {
        return Promise.reject(error);
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicGFuZS5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BmYXJyaXMvaWRlLWRldmtpdC8iLCJzb3VyY2VzIjpbImxpYi9pZGVmcmFtZXdvcmsvZ3NwL3BhbmUudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQSxPQUFPLEVBQUUsUUFBUSxFQUFFLE1BQU0sYUFBYSxDQUFDO0FBQ3ZDLE9BQU8sRUFBRSxPQUFPLEVBQWMsTUFBTSxhQUFhLENBQUM7Ozs7Ozs7SUFROUMsY0FBYyxHQUFHLENBQUM7QUFFdEI7SUFBaUMsOENBQUs7SUFBdEM7O0lBQXlDLENBQUM7SUFBRCx5QkFBQztBQUFELENBQUMsQUFBMUMsQ0FBaUMsS0FBSyxHQUFJOzs7Ozs7Ozs7O0FBVzFDOzs7Ozs7Ozs7OztJQXFERSxjQUFZLE1BQVc7UUExQ3ZCLFVBQUssR0FBRyxJQUFJLENBQUM7UUFDYix5QkFBb0IsR0FBRyxJQUFJLE9BQU8sRUFBRSxDQUFDO1FBQ3JDLFVBQUssR0FBRyxFQUFFLENBQUM7UUFDWCxjQUFTLEdBQUcsRUFBRSxDQUFDO1FBQ2YsY0FBUyxHQUFHLElBQUksQ0FBQztRQXVDZixJQUFJLENBQUMsY0FBYyxHQUFHLElBQUksQ0FBQyxjQUFjLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQ3JELElBQUksQ0FBQyxjQUFjLEdBQUcsSUFBSSxDQUFDLGNBQWMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDckQsSUFBSSxDQUFDLGdCQUFnQixHQUFHLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDekQsSUFBSSxDQUFDLDhCQUE4QixHQUFHLElBQUksQ0FBQyw4QkFBOEIsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDckYsSUFBSSxDQUFDLFFBQVEsR0FBRyxJQUFJLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUN6QyxJQUFJLENBQUMsVUFBVSxHQUFHLElB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QUFDO0tBQzlCO0FBQ0gsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFBhbmVBeGlzIH0gZnJvbSAnLi9wYW5lLWF4aXMnO1xyXG5pbXBvcnQgeyBFbWl0dGVyLCBEaXNwb3NhYmxlIH0gZnJvbSAnLi9ldmVudC1raXQnO1xyXG5cclxuLy8gY29uc3QgR3JpbSA9IHJlcXVpcmUoJ2dyaW0nKVxyXG4vLyBjb25zdCB7Q29tcG9zaXRlRGlzcG9zYWJsZSwgRW1pdHRlcn0gPSByZXF1aXJlKCdldmVudC1raXQnKVxyXG4vLyBjb25zdCBQYW5lQXhpcyA9IHJlcXVpcmUoJy4vcGFuZS1heGlzJylcclxuLy8gY29uc3QgVGV4dEVkaXRvciA9IHJlcXVpcmUoJy4vdGV4dC1lZGl0b3InKVxyXG4vLyBjb25zdCBQYW5lRWxlbWVudCA9IHJlcXVpcmUoJy4vcGFuZS1lbGVtZW50JylcclxuXHJcbmxldCBuZXh0SW5zdGFuY2VJZCA9IDE7XHJcblxyXG5jbGFzcyBTYXZlQ2FuY2VsbGVkRXJyb3IgZXh0ZW5kcyBFcnJvciB7IH1cclxuXHJcbi8vIEV4dGVuZGVkOiBBIGNvbnRhaW5lciBmb3IgcHJlc2VudGluZyBjb250ZW50IGluIHRoZSBjZW50ZXIgb2YgdGhlIHdvcmtzcGFjZS5cclxuLy8gUGFuZXMgY2FuIGNvbnRhaW4gbXVsdGlwbGUgaXRlbXMsIG9uZSBvZiB3aGljaCBpcyAqYWN0aXZlKiBhdCBhIGdpdmVuIHRpbWUuXHJcbi8vIFRoZSB2aWV3IGNvcnJlc3BvbmRpbmcgdG8gdGhlIGFjdGl2ZSBpdGVtIGlzIGRpc3BsYXllZCBpbiB0aGUgaW50ZXJmYWNlLiBJblxyXG4vLyB0aGUgZGVmYXVsdCBjb25maWd1cmF0aW9uLCB0YWJzIGFyZSBhbHNvIGRpc3BsYXllZCBmb3IgZWFjaCBpdGVtLlxyXG4vL1xyXG4vLyBFYWNoIHBhbmUgbWF5IGFsc28gY29udGFpbiBvbmUgKnBlbmRpbmcqIGl0ZW0uIFdoZW4gYSBwZW5kaW5nIGl0ZW0gaXMgYWRkZWRcclxuLy8gdG8gYSBwYW5lLCBpdCB3aWxsIHJlcGxhY2UgdGhlIGN1cnJlbnRseSBwZW5kaW5nIGl0ZW0sIGlmIGFueSwgaW5zdGVhZCBvZlxyXG4vLyBzaW1wbHkgYmVpbmcgYWRkZWQuIEluIHRoZSBkZWZhdWx0IGNvbmZpZ3VyYXRpb24sIHRoZSB0ZXh0IGluIHRoZSB0YWIgZm9yXHJcbi8vIHBlbmRpbmcgaXRlbXMgaXMgc2hvd24gaW4gaXRhbGljcy5cclxuZXhwb3J0IGNsYXNzIFBhbmUge1xyXG5cclxuICBpZDogYW55O1xyXG4gIGFjdGl2ZUl0ZW06IGFueTtcclxuICBmb2N1c2VkOiBhbnk7XHJcbiAgYXBwbGljYXRpb25EZWxlZ2F0ZTogYW55O1xyXG4gIG5vdGlmaWNhdGlvbk1hbmFnZXI6IGFueTtcclxuICBjb25maWc6IGFueTtcclxuICBkZXNlcmlhbGl6ZXJNYW5hZ2VyOiBhbnk7XHJcbiAgdmlld1JlZ2lzdHJ5OiBhbnk7XHJcbiAgcHJpdmF0ZSBlbWl0dGVyOiBFbWl0dGVyO1xyXG4gIGFsaXZlID0gdHJ1ZTtcclxuICBzdWJzY3JpcHRpb25zUGVySXRlbSA9IG5ldyBXZWFrTWFwKCk7XHJcbiAgaXRlbXMgPSBbXTtcclxuICBpdGVtU3RhY2sgPSBbXTtcclxuICBjb250YWluZXIgPSBudWxsO1xyXG4gIGZsZXhTY2FsZTogYW55O1xyXG4gIHBhcmVudDogYW55O1xyXG4gIGl0ZW1TdGFja0luZGV4OiBudW1iZXI7XHJcbiAgcGVuZGluZ0l0ZW06IGFueTtcclxuXHJcbiAgc3RhdGljIGRlc2VyaWFsaXplKHN0YXRlLCB7IGRlc2VyaWFsaXplcnMsIGFwcGxpY2F0aW9uRGVsZWdhdGUsIGNvbmZpZywgbm90aWZpY2F0aW9ucywgdmlld3MgfSkge1xyXG4gICAgY29uc3QgeyBhY3RpdmVJdGVtSW5kZXggfSA9IHN0YXRlO1xyXG4gICAgY29uc3QgYWN0aXZlSXRlbVVSSSA9IHN0YXRlLmFjdGl2ZUl0ZW1VUkkgfHwgc3RhdGUuYWN0aXZlSXRlbVVyaTtcclxuXHJcbiAgICBjb25zdCBpdGVtcyA9IFtdO1xyXG4gICAgZm9yIChjb25zdCBpdGVtU3RhdGUgb2Ygc3RhdGUuaXRlbXMpIHtcclxuICAgICAgY29uc3QgaXRlbSA9IGRlc2VyaWFsaXplcnMuZGVzZXJpYWxpemUoaXRlbVN0YXRlKTtcclxuICAgICAgaWYgKGl0ZW0pIHsgaXRlbXMucHVzaChpdGVtKTsgfVxyXG4gICAgfVxyXG4gICAgc3RhdGUuaXRlbXMgPSBpdGVtcztcclxuXHJcbiAgICBzdGF0ZS5hY3RpdmVJdGVtID0gaXRlbXNbYWN0aXZlSXRlbUluZGV4XTtcclxuICAgIGlmICghc3RhdGUuYWN0aXZlSXRlbSAmJiBhY3RpdmVJdGVtVVJJKSB7XHJcbiAgICAgIHN0YXRlLmFjdGl2ZUl0ZW0gPSBzdGF0ZS5pdGVtcy5maW5kKChpdGVtKSA9PlxyXG4gICAgICAgIHR5cGVvZiBpdGVtLmdldFVSSSA9PT0gJ2Z1bmN0aW9uJyAmJiBpdGVtLmdldFVSSSgpID09PSBhY3RpdmVJdGVtVVJJXHJcbiAgICAgICk7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIG5ldyBQYW5lKE9iamVjdC5hc3NpZ24oc3RhdGUsIHtcclxuICAgICAgZGVzZXJpYWxpemVyTWFuYWdlcjogZGVzZXJpYWxpemVycyxcclxuICAgICAgbm90aWZpY2F0aW9uTWFuYWdlcjogbm90aWZpY2F0aW9ucyxcclxuICAgICAgdmlld1JlZ2lzdHJ5OiB2aWV3cyxcclxuICAgICAgY29uZmlnLFxyXG4gICAgICBhcHBsaWNhdGlvbkRlbGVnYXRlXHJcbiAgICB9KSk7XHJcbiAgfVxyXG5cclxuXHJcblxyXG4gIGluc3BlY3QoKSB7XHJcbiAgICByZXR1cm4gYFBhbmUgJHt0aGlzLmlkfWA7XHJcbiAgfVxyXG4gIGNvbnN0cnVjdG9yKHBhcmFtczogYW55KSB7XHJcbiAgICB0aGlzLnNldFBlbmRpbmdJdGVtID0gdGhpcy5zZXRQZW5kaW5nSXRlbS5iaW5kKHRoaXMpO1xyXG4gICAgdGhpcy5nZXRQZW5kaW5nSXRlbSA9IHRoaXMuZ2V0UGVuZGluZ0l0ZW0uYmluZCh0aGlzKTtcclxuICAgIHRoaXMuY2xlYXJQZW5kaW5nSXRlbSA9IHRoaXMuY2xlYXJQZW5kaW5nSXRlbS5iaW5kKHRoaXMpO1xyXG4gICAgdGhpcy5vbkl0ZW1EaWRUZXJtaW5hdGVQZW5kaW5nU3RhdGUgPSB0aGlzLm9uSXRlbURpZFRlcm1pbmF0ZVBlbmRpbmdTdGF0ZS5iaW5kKHRoaXMpO1xyXG4gICAgdGhpcy5zYXZlSXRlbSA9IHRoaXMuc2F2ZUl0ZW0uYmluZCh0aGlzKTtcclxuICAgIHRoaXMuc2F2ZUl0ZW1BcyA9IHRoaXMuc2F2ZUl0ZW1Bcy5iaW5kKHRoaXMpO1xyXG5cclxuICAgIHRoaXMuaWQgPSBwYXJhbXMuaWQ7XHJcbiAgICBpZiAodGhpcy5pZCAhPSBudWxsKSB7XHJcbiAgICAgIG5leHRJbnN0YW5jZUlkID0gTWF0aC5tYXgobmV4dEluc3RhbmNlSWQsIHRoaXMuaWQgKyAxKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuaWQgPSBuZXh0SW5zdGFuY2VJZCsrO1xyXG4gICAgfVxyXG5cclxuICAgIHRoaXMuYWN0aXZlSXRlbSA9IHBhcmFtcy5hY3RpdmVJdGVtO1xyXG4gICAgdGhpcy5mb2N1c2VkID0gcGFyYW1zLmZvY3VzZWQgIT0gbnVsbCA/IHBhcmFtcy5mb2N1c2VkIDogZmFsc2U7XHJcbiAgICB0aGlzLmFwcGxpY2F0aW9uRGVsZWdhdGUgPSBwYXJhbXMuYXBwbGljYXRpb25EZWxlZ2F0ZTtcclxuICAgIHRoaXMubm90aWZpY2F0aW9uTWFuYWdlciA9IHBhcmFtcy5ub3RpZmljYXRpb25NYW5hZ2VyO1xyXG4gICAgdGhpcy5jb25maWcgPSBwYXJhbXMuY29uZmlnO1xyXG4gICAgdGhpcy5kZXNlcmlhbGl6ZXJNYW5hZ2VyID0gcGFyYW1zLmRlc2VyaWFsaXplck1hbmFnZXI7XHJcbiAgICB0aGlzLnZpZXdSZWdpc3RyeSA9IHBhcmFtcy52aWV3UmVnaXN0cnk7XHJcblxyXG4gICAgdGhpcy5lbWl0dGVyID0gbmV3IEVtaXR0ZXIoKTtcclxuICAgIHRoaXMuYWxpdmUgPSB0cnVlO1xyXG4gICAgdGhpcy5zdWJzY3JpcHRpb25zUGVySXRlbSA9IG5ldyBXZWFrTWFwKCk7XHJcbiAgICB0aGlzLml0ZW1zID0gW107XHJcbiAgICB0aGlzLml0ZW1TdGFjayA9IFtdO1xyXG4gICAgdGhpcy5jb250YWluZXIgPSBudWxsO1xyXG5cclxuICAgIHRoaXMuYWRkSXRlbXMoKHBhcmFtcy5pdGVtcyB8fCBbXSkuZmlsdGVyKGl0ZW0gPT4gaXRlbSkpO1xyXG4gICAgaWYgKCF0aGlzLmdldEFjdGl2ZUl0ZW0oKSkge1xyXG4gICAgICB0aGlzLnNldEFjdGl2ZUl0ZW0odGhpcy5pdGVtc1swXSk7XHJcbiAgICB9XHJcbiAgICB0aGlzLmFkZEl0ZW1zVG9TdGFjayhwYXJhbXMuaXRlbVN0YWNrSW5kaWNlcyB8fCBbXSk7XHJcbiAgICB0aGlzLnNldEZsZXhTY2FsZShwYXJhbXMuZmxleFNjYWxlIHx8IDEpO1xyXG4gIH1cclxuXHJcbiAgZ2V0RWxlbWVudCgpIHtcclxuICB9XHJcblxyXG4gIHNlcmlhbGl6ZSgpIHtcclxuICAgIGNvbnN0IGl0ZW1zVG9CZVNlcmlhbGl6ZWQgPSB0aGlzLml0ZW1zLmZpbHRlcihpdGVtID0+IGl0ZW0gJiYgdHlwZW9mIGl0ZW0uc2VyaWFsaXplID09PSAnZnVuY3Rpb24nKTtcclxuXHJcbiAgICBjb25zdCBpdGVtU3RhY2tJbmRpY2VzID0gW107XHJcbiAgICBmb3IgKGNvbnN0IGl0ZW0gb2YgdGhpcy5pdGVtU3RhY2spIHtcclxuICAgICAgaWYgKHR5cGVvZiBpdGVtLnNlcmlhbGl6ZSA9PT0gJ2Z1bmN0aW9uJykge1xyXG4gICAgICAgIGl0ZW1TdGFja0luZGljZXMucHVzaChpdGVtc1RvQmVTZXJpYWxpemVkLmluZGV4T2YoaXRlbSkpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgYWN0aXZlSXRlbUluZGV4ID0gaXRlbXNUb0JlU2VyaWFsaXplZC5pbmRleE9mKHRoaXMuYWN0aXZlSXRlbSk7XHJcblxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgZGVzZXJpYWxpemVyOiAnUGFuZScsXHJcbiAgICAgIGlkOiB0aGlzLmlkLFxyXG4gICAgICBpdGVtczogaXRlbXNUb0JlU2VyaWFsaXplZC5tYXAoaXRlbSA9PiBpdGVtLnNlcmlhbGl6ZSgpKSxcclxuICAgICAgaXRlbVN0YWNrSW5kaWNlcyxcclxuICAgICAgYWN0aXZlSXRlbUluZGV4LFxyXG4gICAgICBmb2N1c2VkOiB0aGlzLmZvY3VzZWQsXHJcbiAgICAgIGZsZXhTY2FsZTogdGhpcy5mbGV4U2NhbGVcclxuICAgIH07XHJcbiAgfVxyXG5cclxuICBnZXRQYXJlbnQoKSB7IHJldHVybiB0aGlzLnBhcmVudDsgfVxyXG5cclxuICBzZXRQYXJlbnQocGFyZW50KSB7XHJcbiAgICB0aGlzLnBhcmVudCA9IHBhcmVudDtcclxuICB9XHJcblxyXG4gIGdldENvbnRhaW5lcigpIHsgcmV0dXJuIHRoaXMuY29udGFpbmVyOyB9XHJcblxyXG4gIHNldENvbnRhaW5lcihjb250YWluZXIpIHtcclxuICAgIGlmIChjb250YWluZXIgJiYgY29udGFpbmVyICE9PSB0aGlzLmNvbnRhaW5lcikge1xyXG4gICAgICB0aGlzLmNvbnRhaW5lciA9IGNvbnRhaW5lcjtcclxuICAgICAgY29udGFpbmVyLmRpZEFkZFBhbmUoeyBwYW5lOiB0aGlzIH0pO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLy8gUHJpdmF0ZTogRGV0ZXJtaW5lIHdoZXRoZXIgdGhlIGdpdmVuIGl0ZW0gaXMgYWxsb3dlZCB0byBleGlzdCBpbiB0aGlzIHBhbmUuXHJcbiAgLy9cclxuICAvLyAqIGBpdGVtYCB0aGUgSXRlbVxyXG4gIC8vXHJcbiAgLy8gUmV0dXJucyBhIHtCb29sZWFufS5cclxuICBpc0l0ZW1BbGxvd2VkKGl0ZW0pIHtcclxuICAgIGlmICh0eXBlb2YgaXRlbS5nZXRBbGxvd2VkTG9jYXRpb25zICE9PSAnZnVuY3Rpb24nKSB7XHJcbiAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgcmV0dXJuIGl0ZW0uZ2V0QWxsb3dlZExvY2F0aW9ucygpLmluY2x1ZGVzKHRoaXMuZ2V0Q29udGFpbmVyKCkuZ2V0TG9jYXRpb24oKSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBzZXRGbGV4U2NhbGUoZmxleFNjYWxlKSB7XHJcbiAgICB0aGlzLmZsZXhTY2FsZSA9IGZsZXhTY2FsZTtcclxuICAgIHJldHVybiB0aGlzLmZsZXhTY2FsZTtcclxuICB9XHJcblxyXG4gIGdldEZsZXhTY2FsZSgpIHsgcmV0dXJuIHRoaXMuZmxleFNjYWxlOyB9XHJcblxyXG4gIGluY3JlYXNlU2l6ZSgpIHsgdGhpcy5zZXRGbGV4U2NhbGUodGhpcy5nZXRGbGV4U2NhbGUoKSAqIDEuMSk7IH1cclxuXHJcbiAgZGVjcmVhc2VTaXplKCkgeyB0aGlzLnNldEZsZXhTY2FsZSh0aGlzLmdldEZsZXhTY2FsZSgpIC8gMS4xKTsgfVxyXG5cclxuICAvKlxyXG4gIFNlY3Rpb246IEV2ZW50IFN1YnNjcmlwdGlvblxyXG4gICovXHJcblxyXG4gIC8vIFB1YmxpYzogSW52b2tlIHRoZSBnaXZlbiBjYWxsYmFjayB3aGVuIHRoZSBwYW5lIHJlc2l6ZXNcclxuICAvL1xyXG4gIC8vIFRoZSBjYWxsYmFjayB3aWxsIGJlIGludm9rZWQgd2hlbiBwYW5lJ3MgZmxleFNjYWxlIHByb3BlcnR5IGNoYW5nZXMuXHJcbiAgLy8gVXNlIHs6OmdldEZsZXhTY2FsZX0gdG8gZ2V0IHRoZSBjdXJyZW50IHZhbHVlLlxyXG4gIC8vXHJcbiAgLy8gKiBgY2FsbGJhY2tgIHtGdW5jdGlvbn0gdG8gYmUgY2FsbGVkIHdoZW4gdGhlIHBhbmUgaXMgcmVzaXplZFxyXG4gIC8vICAgKiBgZmxleFNjYWxlYCB7TnVtYmVyfSByZXByZXNlbnRpbmcgdGhlIHBhbmVzIGBmbGV4LWdyb3dgOyBhYmlsaXR5IGZvciBhXHJcbiAgLy8gICAgIGZsZXggaXRlbSB0byBncm93IGlmIG5lY2Vzc2FyeS5cclxuICAvL1xyXG4gIC8vIFJldHVybnMgYSB7RGlzcG9zYWJsZX0gb24gd2hpY2ggJy5kaXNwb3NlKCknIGNhbiBiZSBjYWxsZWQgdG8gdW5zdWJzY3JpYmUuXHJcbiAgb25EaWRDaGFuZ2VGbGV4U2NhbGUoY2FsbGJhY2spIHtcclxuICB9XHJcblxyXG4gIC8vIFB1YmxpYzogSW52b2tlIHRoZSBnaXZlbiBjYWxsYmFjayB3aXRoIHRoZSBjdXJyZW50IGFuZCBmdXR1cmUgdmFsdWVzIG9mXHJcbiAgLy8gezo6Z2V0RmxleFNjYWxlfS5cclxuICAvL1xyXG4gIC8vICogYGNhbGxiYWNrYCB7RnVuY3Rpb259IHRvIGJlIGNhbGxlZCB3aXRoIHRoZSBjdXJyZW50IGFuZCBmdXR1cmUgdmFsdWVzIG9mXHJcbiAgLy8gICB0aGUgezo6Z2V0RmxleFNjYWxlfSBwcm9wZXJ0eS5cclxuICAvLyAgICogYGZsZXhTY2FsZWAge051bWJlcn0gcmVwcmVzZW50aW5nIHRoZSBwYW5lcyBgZmxleC1ncm93YDsgYWJpbGl0eSBmb3IgYVxyXG4gIC8vICAgICBmbGV4IGl0ZW0gdG8gZ3JvdyBpZiBuZWNlc3NhcnkuXHJcbiAgLy9cclxuICAvLyBSZXR1cm5zIGEge0Rpc3Bvc2FibGV9IG9uIHdoaWNoIGAuZGlzcG9zZSgpYCBjYW4gYmUgY2FsbGVkIHRvIHVuc3Vic2NyaWJlLlxyXG4gIG9ic2VydmVGbGV4U2NhbGUoY2FsbGJhY2spIHtcclxuICAgIGNhbGxiYWNrKHRoaXMuZmxleFNjYWxlKTtcclxuICAgIHJldHVybiB0aGlzLm9uRGlkQ2hhbmdlRmxleFNjYWxlKGNhbGxiYWNrKTtcclxuICB9XHJcblxyXG4gIC8vIFB1YmxpYzogSW52b2tlIHRoZSBnaXZlbiBjYWxsYmFjayB3aGVuIHRoZSBwYW5lIGlzIGFjdGl2YXRlZC5cclxuICAvL1xyXG4gIC8vIFRoZSBnaXZlbiBjYWxsYmFjayB3aWxsIGJlIGludm9rZWQgd2hlbmV2ZXIgezo6YWN0aXZhdGV9IGlzIGNhbGxlZCBvbiB0aGVcclxuICAvLyBwYW5lLCBldmVuIGlmIGl0IGlzIGFscmVhZHkgYWN0aXZlIGF0IHRoZSB0aW1lLlxyXG4gIC8vXHJcbiAgLy8gKiBgY2FsbGJhY2tgIHtGdW5jdGlvbn0gdG8gYmUgY2FsbGVkIHdoZW4gdGhlIHBhbmUgaXMgYWN0aXZhdGVkLlxyXG4gIC8vXHJcbiAgLy8gUmV0dXJucyBhIHtEaXNwb3NhYmxlfSBvbiB3aGljaCBgLmRpc3Bvc2UoKWAgY2FuIGJlIGNhbGxlZCB0byB1bnN1YnNjcmliZS5cclxuICBvbkRpZEFjdGl2YXRlKGNhbGxiYWNrKSB7XHJcbiAgfVxyXG5cclxuICAvLyBQdWJsaWM6IEludm9rZSB0aGUgZ2l2ZW4gY2FsbGJhY2sgYmVmb3JlIHRoZSBwYW5lIGlzIGRlc3Ryb3llZC5cclxuICAvL1xyXG4gIC8vICogYGNhbGxiYWNrYCB7RnVuY3Rpb259IHRvIGJlIGNhbGxlZCBiZWZvcmUgdGhlIHBhbmUgaXMgZGVzdHJveWVkLlxyXG4gIC8vXHJcbiAgLy8gUmV0dXJucyBhIHtEaXNwb3NhYmxlfSBvbiB3aGljaCBgLmRpc3Bvc2UoKWAgY2FuIGJlIGNhbGxlZCB0byB1bnN1YnNjcmliZS5cclxuICBvbldpbGxEZXN0cm95KGNhbGxiYWNrKSB7XHJcbiAgfVxyXG5cclxuICAvLyBQdWJsaWM6IEludm9rZSB0aGUgZ2l2ZW4gY2FsbGJhY2sgd2hlbiB0aGUgcGFuZSBpcyBkZXN0cm95ZWQuXHJcbiAgLy9cclxuICAvLyAqIGBjYWxsYmFja2Age0Z1bmN0aW9ufSB0byBiZSBjYWxsZWQgd2hlbiB0aGUgcGFuZSBpcyBkZXN0cm95ZWQuXHJcbiAgLy9cclxuICAvLyBSZXR1cm5zIGEge0Rpc3Bvc2FibGV9IG9uIHdoaWNoIGAuZGlzcG9zZSgpYCBjYW4gYmUgY2FsbGVkIHRvIHVuc3Vic2NyaWJlLlxyXG4gIG9uRGlkRGVzdHJveShjYWxsYmFjaykge1xyXG4gIH1cclxuXHJcbiAgLy8gUHVibGljOiBJbnZva2UgdGhlIGdpdmVuIGNhbGxiYWNrIHdoZW4gdGhlIHZhbHVlIG9mIHRoZSB7Ojppc0FjdGl2ZX1cclxuICAvLyBwcm9wZXJ0eSBjaGFuZ2VzLlxyXG4gIC8vXHJcbiAgLy8gKiBgY2FsbGJhY2tgIHtGdW5jdGlvbn0gdG8gYmUgY2FsbGVkIHdoZW4gdGhlIHZhbHVlIG9mIHRoZSB7Ojppc0FjdGl2ZX1cclxuICAvLyAgIHByb3BlcnR5IGNoYW5nZXMuXHJcbiAgLy8gICAqIGBhY3RpdmVgIHtCb29sZWFufSBpbmRpY2F0aW5nIHdoZXRoZXIgdGhlIHBhbmUgaXMgYWN0aXZlLlxyXG4gIC8vXHJcbiAgLy8gUmV0dXJucyBhIHtEaXNwb3NhYmxlfSBvbiB3aGljaCBgLmRpc3Bvc2UoKWAgY2FuIGJlIGNhbGxlZCB0byB1bnN1YnNjcmliZS5cclxuICBvbkRpZENoYW5nZUFjdGl2ZShjYWxsYmFjaykge1xyXG4gICAgcmV0dXJuIHRoaXMuY29udGFpbmVyLm9uRGlkQ2hhbmdlQWN0aXZlUGFuZShhY3RpdmVQYW5lID0+IHtcclxuICAgICAgY29uc3QgaXNBY3RpdmUgPSB0aGlzID09PSBhY3RpdmVQYW5lO1xyXG4gICAgICBjYWxsYmFjayhpc0FjdGl2ZSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8vIFB1YmxpYzogSW52b2tlIHRoZSBnaXZlbiBjYWxsYmFjayB3aXRoIHRoZSBjdXJyZW50IGFuZCBmdXR1cmUgdmFsdWVzIG9mIHRoZVxyXG4gIC8vIHs6OmlzQWN0aXZlfSBwcm9wZXJ0eS5cclxuICAvL1xyXG4gIC8vICogYGNhbGxiYWNrYCB7RnVuY3Rpb259IHRvIGJlIGNhbGxlZCB3aXRoIHRoZSBjdXJyZW50IGFuZCBmdXR1cmUgdmFsdWVzIG9mXHJcbiAgLy8gICB0aGUgezo6aXNBY3RpdmV9IHByb3BlcnR5LlxyXG4gIC8vICAgKiBgYWN0aXZlYCB7Qm9vbGVhbn0gaW5kaWNhdGluZyB3aGV0aGVyIHRoZSBwYW5lIGlzIGFjdGl2ZS5cclxuICAvL1xyXG4gIC8vIFJldHVybnMgYSB7RGlzcG9zYWJsZX0gb24gd2hpY2ggYC5kaXNwb3NlKClgIGNhbiBiZSBjYWxsZWQgdG8gdW5zdWJzY3JpYmUuXHJcbiAgb2JzZXJ2ZUFjdGl2ZShjYWxsYmFjaykge1xyXG4gICAgY2FsbGJhY2sodGhpcy5pc0FjdGl2ZSgpKTtcclxuICAgIHJldHVybiB0aGlzLm9uRGlkQ2hhbmdlQWN0aXZlKGNhbGxiYWNrKTtcclxuICB9XHJcblxyXG4gIC8vIFB1YmxpYzogSW52b2tlIHRoZSBnaXZlbiBjYWxsYmFjayB3aGVuIGFuIGl0ZW0gaXMgYWRkZWQgdG8gdGhlIHBhbmUuXHJcbiAgLy9cclxuICAvLyAqIGBjYWxsYmFja2Age0Z1bmN0aW9ufSB0byBiZSBjYWxsZWQgd2l0aCB3aGVuIGl0ZW1zIGFyZSBhZGRlZC5cclxuICAvLyAgICogYGV2ZW50YCB7T2JqZWN0fSB3aXRoIHRoZSBmb2xsb3dpbmcga2V5czpcclxuICAvLyAgICAgKiBgaXRlbWAgVGhlIGFkZGVkIHBhbmUgaXRlbS5cclxuICAvLyAgICAgKiBgaW5kZXhgIHtOdW1iZXJ9IGluZGljYXRpbmcgd2hlcmUgdGhlIGl0ZW0gaXMgbG9jYXRlZC5cclxuICAvL1xyXG4gIC8vIFJldHVybnMgYSB7RGlzcG9zYWJsZX0gb24gd2hpY2ggYC5kaXNwb3NlKClgIGNhbiBiZSBjYWxsZWQgdG8gdW5zdWJzY3JpYmUuXHJcbiAgb25EaWRBZGRJdGVtKGNhbGxiYWNrKSB7XHJcbiAgICByZXR1cm4gdGhpcy5lbWl0dGVyLm9uKCdkaWQtYWRkLWl0ZW0nLCBjYWxsYmFjayk7XHJcbiAgfVxyXG5cclxuICAvLyBQdWJsaWM6IEludm9rZSB0aGUgZ2l2ZW4gY2FsbGJhY2sgd2hlbiBhbiBpdGVtIGlzIHJlbW92ZWQgZnJvbSB0aGUgcGFuZS5cclxuICAvL1xyXG4gIC8vICogYGNhbGxiYWNrYCB7RnVuY3Rpb259IHRvIGJlIGNhbGxlZCB3aXRoIHdoZW4gaXRlbXMgYXJlIHJlbW92ZWQuXHJcbiAgLy8gICAqIGBldmVudGAge09iamVjdH0gd2l0aCB0aGUgZm9sbG93aW5nIGtleXM6XHJcbiAgLy8gICAgICogYGl0ZW1gIFRoZSByZW1vdmVkIHBhbmUgaXRlbS5cclxuICAvLyAgICAgKiBgaW5kZXhgIHtOdW1iZXJ9IGluZGljYXRpbmcgd2hlcmUgdGhlIGl0ZW0gd2FzIGxvY2F0ZWQuXHJcbiAgLy9cclxuICAvLyBSZXR1cm5zIGEge0Rpc3Bvc2FibGV9IG9uIHdoaWNoIGAuZGlzcG9zZSgpYCBjYW4gYmUgY2FsbGVkIHRvIHVuc3Vic2NyaWJlLlxyXG4gIG9uRGlkUmVtb3ZlSXRlbShjYWxsYmFjayk6IERpc3Bvc2FibGUge1xyXG4gICAgcmV0dXJuIHRoaXMuZW1pdHRlci5vbignZGlkLXJlbW92ZS1pdGVtJywgY2FsbGJhY2spO1xyXG4gIH1cclxuXHJcbiAgLy8gUHVibGljOiBJbnZva2UgdGhlIGdpdmVuIGNhbGxiYWNrIGJlZm9yZSBhbiBpdGVtIGlzIHJlbW92ZWQgZnJvbSB0aGUgcGFuZS5cclxuICAvL1xyXG4gIC8vICogYGNhbGxiYWNrYCB7RnVuY3Rpb259IHRvIGJlIGNhbGxlZCB3aXRoIHdoZW4gaXRlbXMgYXJlIHJlbW92ZWQuXHJcbiAgLy8gICAqIGBldmVudGAge09iamVjdH0gd2l0aCB0aGUgZm9sbG93aW5nIGtleXM6XHJcbiAgLy8gICAgICogYGl0ZW1gIFRoZSBwYW5lIGl0ZW0gdG8gYmUgcmVtb3ZlZC5cclxuICAvLyAgICAgKiBgaW5kZXhgIHtOdW1iZXJ9IGluZGljYXRpbmcgd2hlcmUgdGhlIGl0ZW0gaXMgbG9jYXRlZC5cclxuICBvbldpbGxSZW1vdmVJdGVtKGNhbGxiYWNrKSB7XHJcbiAgfVxyXG5cclxuICAvLyBQdWJsaWM6IEludm9rZSB0aGUgZ2l2ZW4gY2FsbGJhY2sgd2hlbiBhbiBpdGVtIGlzIG1vdmVkIHdpdGhpbiB0aGUgcGFuZS5cclxuICAvL1xyXG4gIC8vICogYGNhbGxiYWNrYCB7RnVuY3Rpb259IHRvIGJlIGNhbGxlZCB3aXRoIHdoZW4gaXRlbXMgYXJlIG1vdmVkLlxyXG4gIC8vICAgKiBgZXZlbnRgIHtPYmplY3R9IHdpdGggdGhlIGZvbGxvd2luZyBrZXlzOlxyXG4gIC8vICAgICAqIGBpdGVtYCBUaGUgcmVtb3ZlZCBwYW5lIGl0ZW0uXHJcbiAgLy8gICAgICogYG9sZEluZGV4YCB7TnVtYmVyfSBpbmRpY2F0aW5nIHdoZXJlIHRoZSBpdGVtIHdhcyBsb2NhdGVkLlxyXG4gIC8vICAgICAqIGBuZXdJbmRleGAge051bWJlcn0gaW5kaWNhdGluZyB3aGVyZSB0aGUgaXRlbSBpcyBub3cgbG9jYXRlZC5cclxuICAvL1xyXG4gIC8vIFJldHVybnMgYSB7RGlzcG9zYWJsZX0gb24gd2hpY2ggYC5kaXNwb3NlKClgIGNhbiBiZSBjYWxsZWQgdG8gdW5zdWJzY3JpYmUuXHJcbiAgb25EaWRNb3ZlSXRlbShjYWxsYmFjaykge1xyXG4gIH1cclxuXHJcbiAgLy8gUHVibGljOiBJbnZva2UgdGhlIGdpdmVuIGNhbGxiYWNrIHdpdGggYWxsIGN1cnJlbnQgYW5kIGZ1dHVyZSBpdGVtcy5cclxuICAvL1xyXG4gIC8vICogYGNhbGxiYWNrYCB7RnVuY3Rpb259IHRvIGJlIGNhbGxlZCB3aXRoIGN1cnJlbnQgYW5kIGZ1dHVyZSBpdGVtcy5cclxuICAvLyAgICogYGl0ZW1gIEFuIGl0ZW0gdGhhdCBpcyBwcmVzZW50IGluIHs6OmdldEl0ZW1zfSBhdCB0aGUgdGltZSBvZlxyXG4gIC8vICAgICBzdWJzY3JpcHRpb24gb3IgdGhhdCBpcyBhZGRlZCBhdCBzb21lIGxhdGVyIHRpbWUuXHJcbiAgLy9cclxuICAvLyBSZXR1cm5zIGEge0Rpc3Bvc2FibGV9IG9uIHdoaWNoIGAuZGlzcG9zZSgpYCBjYW4gYmUgY2FsbGVkIHRvIHVuc3Vic2NyaWJlLlxyXG4gIG9ic2VydmVJdGVtcyhjYWxsYmFjaykge1xyXG4gICAgZm9yIChjb25zdCBpdGVtIG9mIHRoaXMuZ2V0SXRlbXMoKSkge1xyXG4gICAgICBjYWxsYmFjayhpdGVtKTtcclxuICAgIH1cclxuICAgIHJldHVybiB0aGlzLm9uRGlkQWRkSXRlbSgoeyBpdGVtIH0pID0+IGNhbGxiYWNrKGl0ZW0pKTtcclxuICB9XHJcblxyXG4gIC8vIOWFrOacieaWueazle+8miDlvZN7OjpnZXRBY3RpdmVJdGVtfeWAvOWPmOaNouWJjeiwg+eUqOOAglxyXG4gIG9uRG9pbmdDaGFuZ2VBY3RpdmVJdGVtKGNhbGxiYWNrKTogRGlzcG9zYWJsZSB7XHJcbiAgICByZXR1cm4gdGhpcy5lbWl0dGVyLm9uKCdkb2luZy1jaGFuZ2UtYWN0aXZlLWl0ZW0nLCBjYWxsYmFjayk7XHJcbiAgfVxyXG5cclxuICAvLyBQdWJsaWM6IEludm9rZSB0aGUgZ2l2ZW4gY2FsbGJhY2sgd2hlbiB0aGUgdmFsdWUgb2Ygezo6Z2V0QWN0aXZlSXRlbX1cclxuICAvLyBjaGFuZ2VzLlxyXG4gIC8vXHJcbiAgLy8gKiBgY2FsbGJhY2tgIHtGdW5jdGlvbn0gdG8gYmUgY2FsbGVkIHdpdGggd2hlbiB0aGUgYWN0aXZlIGl0ZW0gY2hhbmdlcy5cclxuICAvLyAgICogYGFjdGl2ZUl0ZW1gIFRoZSBjdXJyZW50IGFjdGl2ZSBpdGVtLlxyXG4gIC8vXHJcbiAgLy8gUmV0dXJucyBhIHtEaXNwb3NhYmxlfSBvbiB3aGljaCBgLmRpc3Bvc2UoKWAgY2FuIGJlIGNhbGxlZCB0byB1bnN1YnNjcmliZS5cclxuICBvbkRpZENoYW5nZUFjdGl2ZUl0ZW0oY2FsbGJhY2spOiBEaXNwb3NhYmxlIHtcclxuICAgIHJldHVybiB0aGlzLmVtaXR0ZXIub24oJ2RpZC1jaGFuZ2UtYWN0aXZlLWl0ZW0nLCBjYWxsYmFjayk7XHJcbiAgfVxyXG5cclxuICAvLyBQdWJsaWM6IEludm9rZSB0aGUgZ2l2ZW4gY2FsbGJhY2sgd2hlbiB7OjphY3RpdmF0ZU5leHRSZWNlbnRseVVzZWRJdGVtfVxyXG4gIC8vIGhhcyBiZWVuIGNhbGxlZCwgZWl0aGVyIGluaXRpYXRpbmcgb3IgY29udGludWluZyBhIGZvcndhcmQgTVJVIHRyYXZlcnNhbCBvZlxyXG4gIC8vIHBhbmUgaXRlbXMuXHJcbiAgLy9cclxuICAvLyAqIGBjYWxsYmFja2Age0Z1bmN0aW9ufSB0byBiZSBjYWxsZWQgd2l0aCB3aGVuIHRoZSBhY3RpdmUgaXRlbSBjaGFuZ2VzLlxyXG4gIC8vICAgKiBgbmV4dFJlY2VudGx5VXNlZEl0ZW1gIFRoZSBuZXh0IE1SVSBpdGVtLCBub3cgYmVpbmcgc2V0IGFjdGl2ZVxyXG4gIC8vXHJcbiAgLy8gUmV0dXJucyBhIHtEaXNwb3NhYmxlfSBvbiB3aGljaCBgLmRpc3Bvc2UoKWAgY2FuIGJlIGNhbGxlZCB0byB1bnN1YnNjcmliZS5cclxuICBvbkNob29zZU5leHRNUlVJdGVtKGNhbGxiYWNrKSB7XHJcbiAgfVxyXG5cclxuICAvLyBQdWJsaWM6IEludm9rZSB0aGUgZ2l2ZW4gY2FsbGJhY2sgd2hlbiB7OjphY3RpdmF0ZVByZXZpb3VzUmVjZW50bHlVc2VkSXRlbX1cclxuICAvLyBoYXMgYmVlbiBjYWxsZWQsIGVpdGhlciBpbml0aWF0aW5nIG9yIGNvbnRpbnVpbmcgYSByZXZlcnNlIE1SVSB0cmF2ZXJzYWwgb2ZcclxuICAvLyBwYW5lIGl0ZW1zLlxyXG4gIC8vXHJcbiAgLy8gKiBgY2FsbGJhY2tgIHtGdW5jdGlvbn0gdG8gYmUgY2FsbGVkIHdpdGggd2hlbiB0aGUgYWN0aXZlIGl0ZW0gY2hhbmdlcy5cclxuICAvLyAgICogYHByZXZpb3VzUmVjZW50bHlVc2VkSXRlbWAgVGhlIHByZXZpb3VzIE1SVSBpdGVtLCBub3cgYmVpbmcgc2V0IGFjdGl2ZVxyXG4gIC8vXHJcbiAgLy8gUmV0dXJucyBhIHtEaXNwb3NhYmxlfSBvbiB3aGljaCBgLmRpc3Bvc2UoKWAgY2FuIGJlIGNhbGxlZCB0byB1bnN1YnNjcmliZS5cclxuICBvbkNob29zZUxhc3RNUlVJdGVtKGNhbGxiYWNrKSB7XHJcbiAgfVxyXG5cclxuICAvLyBQdWJsaWM6IEludm9rZSB0aGUgZ2l2ZW4gY2FsbGJhY2sgd2hlbiB7Ojptb3ZlQWN0aXZlSXRlbVRvVG9wT2ZTdGFja31cclxuICAvLyBoYXMgYmVlbiBjYWxsZWQsIHRlcm1pbmF0aW5nIGFuIE1SVSB0cmF2ZXJzYWwgb2YgcGFuZSBpdGVtcyBhbmQgbW92aW5nIHRoZVxyXG4gIC8vIGN1cnJlbnQgYWN0aXZlIGl0ZW0gdG8gdGhlIHRvcCBvZiB0aGUgc3RhY2suIFR5cGljYWxseSBib3VuZCB0byBhIG1vZGlmaWVyXHJcbiAgLy8gKGUuZy4gQ1RSTCkga2V5IHVwIGV2ZW50LlxyXG4gIC8vXHJcbiAgLy8gKiBgY2FsbGJhY2tgIHtGdW5jdGlvbn0gdG8gYmUgY2FsbGVkIHdpdGggd2hlbiB0aGUgTVJVIHRyYXZlcnNhbCBpcyBkb25lLlxyXG4gIC8vXHJcbiAgLy8gUmV0dXJucyBhIHtEaXNwb3NhYmxlfSBvbiB3aGljaCBgLmRpc3Bvc2UoKWAgY2FuIGJlIGNhbGxlZCB0byB1bnN1YnNjcmliZS5cclxuICBvbkRvbmVDaG9vc2luZ01SVUl0ZW0oY2FsbGJhY2spIHtcclxuICB9XHJcblxyXG4gIC8vIFB1YmxpYzogSW52b2tlIHRoZSBnaXZlbiBjYWxsYmFjayB3aXRoIHRoZSBjdXJyZW50IGFuZCBmdXR1cmUgdmFsdWVzIG9mXHJcbiAgLy8gezo6Z2V0QWN0aXZlSXRlbX0uXHJcbiAgLy9cclxuICAvLyAqIGBjYWxsYmFja2Age0Z1bmN0aW9ufSB0byBiZSBjYWxsZWQgd2l0aCB0aGUgY3VycmVudCBhbmQgZnV0dXJlIGFjdGl2ZVxyXG4gIC8vICAgaXRlbXMuXHJcbiAgLy8gICAqIGBhY3RpdmVJdGVtYCBUaGUgY3VycmVudCBhY3RpdmUgaXRlbS5cclxuICAvL1xyXG4gIC8vIFJldHVybnMgYSB7RGlzcG9zYWJsZX0gb24gd2hpY2ggYC5kaXNwb3NlKClgIGNhbiBiZSBjYWxsZWQgdG8gdW5zdWJzY3JpYmUuXHJcbiAgb2JzZXJ2ZUFjdGl2ZUl0ZW0oY2FsbGJhY2spOiBEaXNwb3NhYmxlIHtcclxuICAgIGNhbGxiYWNrKHRoaXMuZ2V0QWN0aXZlSXRlbSgpKTtcclxuICAgIHJldHVybiB0aGlzLm9uRGlkQ2hhbmdlQWN0aXZlSXRlbShjYWxsYmFjayk7XHJcbiAgfVxyXG5cclxuICAvLyBQdWJsaWM6IEludm9rZSB0aGUgZ2l2ZW4gY2FsbGJhY2sgYmVmb3JlIGl0ZW1zIGFyZSBkZXN0cm95ZWQuXHJcbiAgLy9cclxuICAvLyAqIGBjYWxsYmFja2Age0Z1bmN0aW9ufSB0byBiZSBjYWxsZWQgYmVmb3JlIGl0ZW1zIGFyZSBkZXN0cm95ZWQuXHJcbiAgLy8gICAqIGBldmVudGAge09iamVjdH0gd2l0aCB0aGUgZm9sbG93aW5nIGtleXM6XHJcbiAgLy8gICAgICogYGl0ZW1gIFRoZSBpdGVtIHRoYXQgd2lsbCBiZSBkZXN0cm95ZWQuXHJcbiAgLy8gICAgICogYGluZGV4YCBUaGUgbG9jYXRpb24gb2YgdGhlIGl0ZW0uXHJcbiAgLy9cclxuICAvLyBSZXR1cm5zIGEge0Rpc3Bvc2FibGV9IG9uIHdoaWNoIGAuZGlzcG9zZSgpYCBjYW4gYmUgY2FsbGVkIHRvXHJcbiAgLy8gdW5zdWJzY3JpYmUuXHJcbiAgb25XaWxsRGVzdHJveUl0ZW0oY2FsbGJhY2spIHtcclxuICB9XHJcblxyXG4gIC8vIENhbGxlZCBieSB0aGUgdmlldyBsYXllciB0byBpbmRpY2F0ZSB0aGF0IHRoZSBwYW5lIGhhcyBnYWluZWQgZm9jdXMuXHJcbiAgZm9jdXMoKSB7XHJcbiAgICB0aGlzLmZvY3VzZWQgPSB0cnVlO1xyXG4gICAgcmV0dXJuIHRoaXMuYWN0aXZhdGUoKTtcclxuICB9XHJcblxyXG4gIC8vIENhbGxlZCBieSB0aGUgdmlldyBsYXllciB0byBpbmRpY2F0ZSB0aGF0IHRoZSBwYW5lIGhhcyBsb3N0IGZvY3VzLlxyXG4gIGJsdXIoKSB7XHJcbiAgICB0aGlzLmZvY3VzZWQgPSBmYWxzZTtcclxuICAgIHJldHVybiB0cnVlOyAvLyBpZiB0aGlzIGlzIGNhbGxlZCBmcm9tIGFuIGV2ZW50IGhhbmRsZXIsIGRvbid0IGNhbmNlbCBpdFxyXG4gIH1cclxuXHJcbiAgaXNGb2N1c2VkKCkgeyByZXR1cm4gdGhpcy5mb2N1c2VkOyB9XHJcblxyXG4gIGdldFBhbmVzKCkgeyByZXR1cm4gW3RoaXNdOyB9XHJcblxyXG4gIHVuc3Vic2NyaWJlRnJvbUl0ZW0oaXRlbSkge1xyXG4gICAgY29uc3Qgc3Vic2NyaXB0aW9uID0gdGhpcy5zdWJzY3JpcHRpb25zUGVySXRlbS5nZXQoaXRlbSk7XHJcbiAgICBpZiAoc3Vic2NyaXB0aW9uKSB7XHJcbiAgICAgIHN1YnNjcmlwdGlvbi5kaXNwb3NlKCk7XHJcbiAgICAgIHRoaXMuc3Vic2NyaXB0aW9uc1Blckl0ZW0uZGVsZXRlKGl0ZW0pO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLypcclxuICBTZWN0aW9uOiBJdGVtc1xyXG4gICovXHJcblxyXG4gIC8vIFB1YmxpYzogR2V0IHRoZSBpdGVtcyBpbiB0aGlzIHBhbmUuXHJcbiAgLy9cclxuICAvLyBSZXR1cm5zIGFuIHtBcnJheX0gb2YgaXRlbXMuXHJcbiAgZ2V0SXRlbXMoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5pdGVtcy5zbGljZSgpO1xyXG4gIH1cclxuXHJcbiAgLy8gUHVibGljOiBHZXQgdGhlIGFjdGl2ZSBwYW5lIGl0ZW0gaW4gdGhpcyBwYW5lLlxyXG4gIC8vXHJcbiAgLy8gUmV0dXJucyBhIHBhbmUgaXRlbS5cclxuICBnZXRBY3RpdmVJdGVtKCkgeyByZXR1cm4gdGhpcy5hY3RpdmVJdGVtOyB9XHJcblxyXG4gIHNldEFjdGl2ZUl0ZW0oYWN0aXZlSXRlbT86IGFueSwgb3B0aW9ucz86IGFueSkge1xyXG4gICAgY29uc3QgbW9kaWZ5U3RhY2sgPSBvcHRpb25zICYmIG9wdGlvbnMubW9kaWZ5U3RhY2s7XHJcbiAgICBpZiAoYWN0aXZlSXRlbSAhPT0gdGhpcy5hY3RpdmVJdGVtKSB7XHJcbiAgICAgIGlmIChtb2RpZnlTdGFjayAhPT0gZmFsc2UpIHsgdGhpcy5hZGRJdGVtVG9TdGFjayhhY3RpdmVJdGVtKTsgfVxyXG4gICAgICB0aGlzLmVtaXR0ZXIuZW1pdCgnZG9pbmctY2hhbmdlLWFjdGl2ZS1pdGVtJywgdGhpcy5hY3RpdmVJdGVtKTtcclxuICAgICAgdGhpcy5hY3RpdmVJdGVtID0gYWN0aXZlSXRlbTtcclxuICAgICAgdGhpcy5lbWl0dGVyLmVtaXQoJ2RpZC1jaGFuZ2UtYWN0aXZlLWl0ZW0nLCB0aGlzLmFjdGl2ZUl0ZW0pO1xyXG4gICAgICBpZiAodGhpcy5jb250YWluZXIpIHsgdGhpcy5jb250YWluZXIuZGlkQ2hhbmdlQWN0aXZlSXRlbU9uUGFuZSh0aGlzLCB0aGlzLmFjdGl2ZUl0ZW0pOyB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gdGhpcy5hY3RpdmVJdGVtO1xyXG4gIH1cclxuXHJcbiAgLy8gQnVpbGQgdGhlIGl0ZW1TdGFjayBhZnRlciBkZXNlcmlhbGl6aW5nXHJcbiAgYWRkSXRlbXNUb1N0YWNrKGl0ZW1TdGFja0luZGljZXMpIHtcclxuICAgIGlmICh0aGlzLml0ZW1zLmxlbmd0aCA+IDApIHtcclxuICAgICAgaWYgKGl0ZW1TdGFja0luZGljZXMubGVuZ3RoICE9PSB0aGlzLml0ZW1zLmxlbmd0aCB8fCBpdGVtU3RhY2tJbmRpY2VzLmluY2x1ZGVzKC0xKSkge1xyXG4gICAgICAgIGl0ZW1TdGFja0luZGljZXMgPSB0aGlzLml0ZW1zLm1hcCgoaXRlbSwgaSkgPT4gaSk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGZvciAoY29uc3QgaXRlbUluZGV4IG9mIGl0ZW1TdGFja0luZGljZXMpIHtcclxuICAgICAgICB0aGlzLmFkZEl0ZW1Ub1N0YWNrKHRoaXMuaXRlbXNbaXRlbUluZGV4XSk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8vIEFkZCBpdGVtIChvciBtb3ZlIGl0ZW0pIHRvIHRoZSBlbmQgb2YgdGhlIGl0ZW1TdGFja1xyXG4gIGFkZEl0ZW1Ub1N0YWNrKG5ld0l0ZW0pIHtcclxuICAgIGlmIChuZXdJdGVtID09IG51bGwpIHsgcmV0dXJuOyB9XHJcbiAgICBjb25zdCBpbmRleCA9IHRoaXMuaXRlbVN0YWNrLmluZGV4T2YobmV3SXRlbSk7XHJcbiAgICBpZiAoaW5kZXggIT09IC0xKSB7IHRoaXMuaXRlbVN0YWNrLnNwbGljZShpbmRleCwgMSk7IH1cclxuICAgIHJldHVybiB0aGlzLml0ZW1TdGFjay5wdXNoKG5ld0l0ZW0pO1xyXG4gIH1cclxuXHJcbiAgLy8gUHVibGljOiBSZXR1cm4gdGhlIGl0ZW0gYXQgdGhlIGdpdmVuIGluZGV4LlxyXG4gIC8vXHJcbiAgLy8gKiBgaW5kZXhgIHtOdW1iZXJ9XHJcbiAgLy9cclxuICAvLyBSZXR1cm5zIGFuIGl0ZW0gb3IgYG51bGxgIGlmIG5vIGl0ZW0gZXhpc3RzIGF0IHRoZSBnaXZlbiBpbmRleC5cclxuICBpdGVtQXRJbmRleChpbmRleCkge1xyXG4gICAgcmV0dXJuIHRoaXMuaXRlbXNbaW5kZXhdO1xyXG4gIH1cclxuXHJcbiAgLy8gTWFrZXMgdGhlIG5leHQgaXRlbSBpbiB0aGUgaXRlbVN0YWNrIGFjdGl2ZS5cclxuICBhY3RpdmF0ZU5leHRSZWNlbnRseVVzZWRJdGVtKCkge1xyXG4gICAgaWYgKHRoaXMuaXRlbXMubGVuZ3RoID4gMSkge1xyXG4gICAgICBpZiAodGhpcy5pdGVtU3RhY2tJbmRleCA9PSBudWxsKSB7IHRoaXMuaXRlbVN0YWNrSW5kZXggPSB0aGlzLml0ZW1TdGFjay5sZW5ndGggLSAxOyB9XHJcbiAgICAgIGlmICh0aGlzLml0ZW1TdGFja0luZGV4ID09PSAwKSB7IHRoaXMuaXRlbVN0YWNrSW5kZXggPSB0aGlzLml0ZW1TdGFjay5sZW5ndGg7IH1cclxuICAgICAgdGhpcy5pdGVtU3RhY2tJbmRleC0tO1xyXG4gICAgICBjb25zdCBuZXh0UmVjZW50bHlVc2VkSXRlbSA9IHRoaXMuaXRlbVN0YWNrW3RoaXMuaXRlbVN0YWNrSW5kZXhdO1xyXG4gICAgICB0aGlzLnNldEFjdGl2ZUl0ZW0obmV4dFJlY2VudGx5VXNlZEl0ZW0sIHsgbW9kaWZ5U3RhY2s6IGZhbHNlIH0pO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLy8gTWFrZXMgdGhlIHByZXZpb3VzIGl0ZW0gaW4gdGhlIGl0ZW1TdGFjayBhY3RpdmUuXHJcbiAgYWN0aXZhdGVQcmV2aW91c1JlY2VudGx5VXNlZEl0ZW0oKSB7XHJcbiAgICBpZiAodGhpcy5pdGVtcy5sZW5ndGggPiAxKSB7XHJcbiAgICAgIGlmICh0aGlzLml0ZW1TdGFja0luZGV4ICsgMSA9PT0gdGhpcy5pdGVtU3RhY2subGVuZ3RoIHx8IHRoaXMuaXRlbVN0YWNrSW5kZXggPT0gbnVsbCkge1xyXG4gICAgICAgIHRoaXMuaXRlbVN0YWNrSW5kZXggPSAtMTtcclxuICAgICAgfVxyXG4gICAgICB0aGlzLml0ZW1TdGFja0luZGV4Kys7XHJcbiAgICAgIGNvbnN0IHByZXZpb3VzUmVjZW50bHlVc2VkSXRlbSA9IHRoaXMuaXRlbVN0YWNrW3RoaXMuaXRlbVN0YWNrSW5kZXhdO1xyXG4gICAgICB0aGlzLnNldEFjdGl2ZUl0ZW0ocHJldmlvdXNSZWNlbnRseVVzZWRJdGVtLCB7IG1vZGlmeVN0YWNrOiBmYWxzZSB9KTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8vIE1vdmVzIHRoZSBhY3RpdmUgaXRlbSB0byB0aGUgZW5kIG9mIHRoZSBpdGVtU3RhY2sgb25jZSB0aGUgY3RybCBrZXkgaXMgbGlmdGVkXHJcbiAgbW92ZUFjdGl2ZUl0ZW1Ub1RvcE9mU3RhY2soKSB7XHJcbiAgICBkZWxldGUgdGhpcy5pdGVtU3RhY2tJbmRleDtcclxuICAgIHRoaXMuYWRkSXRlbVRvU3RhY2sodGhpcy5hY3RpdmVJdGVtKTtcclxuICB9XHJcblxyXG4gIC8vIFB1YmxpYzogTWFrZXMgdGhlIG5leHQgaXRlbSBhY3RpdmUuXHJcbiAgYWN0aXZhdGVOZXh0SXRlbSgpIHtcclxuICAgIGNvbnN0IGluZGV4ID0gdGhpcy5nZXRBY3RpdmVJdGVtSW5kZXgoKTtcclxuICAgIGlmIChpbmRleCA8ICh0aGlzLml0ZW1zLmxlbmd0aCAtIDEpKSB7XHJcbiAgICAgIHRoaXMuYWN0aXZhdGVJdGVtQXRJbmRleChpbmRleCArIDEpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5hY3RpdmF0ZUl0ZW1BdEluZGV4KDApO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLy8gUHVibGljOiBNYWtlcyB0aGUgcHJldmlvdXMgaXRlbSBhY3RpdmUuXHJcbiAgYWN0aXZhdGVQcmV2aW91c0l0ZW0oKSB7XHJcbiAgICBjb25zdCBpbmRleCA9IHRoaXMuZ2V0QWN0aXZlSXRlbUluZGV4KCk7XHJcbiAgICBpZiAoaW5kZXggPiAwKSB7XHJcbiAgICAgIHRoaXMuYWN0aXZhdGVJdGVtQXRJbmRleChpbmRleCAtIDEpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5hY3RpdmF0ZUl0ZW1BdEluZGV4KHRoaXMuaXRlbXMubGVuZ3RoIC0gMSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBhY3RpdmF0ZUxhc3RJdGVtKCkge1xyXG4gICAgdGhpcy5hY3RpdmF0ZUl0ZW1BdEluZGV4KHRoaXMuaXRlbXMubGVuZ3RoIC0gMSk7XHJcbiAgfVxyXG5cclxuICAvLyBQdWJsaWM6IE1vdmUgdGhlIGFjdGl2ZSB0YWIgdG8gdGhlIHJpZ2h0LlxyXG4gIG1vdmVJdGVtUmlnaHQoKSB7XHJcbiAgICBjb25zdCBpbmRleCA9IHRoaXMuZ2V0QWN0aXZlSXRlbUluZGV4KCk7XHJcbiAgICBjb25zdCByaWdodEl0ZW1JbmRleCA9IGluZGV4ICsgMTtcclxuICAgIGlmIChyaWdodEl0ZW1JbmRleCA8PSB0aGlzLml0ZW1zLmxlbmd0aCAtIDEpIHsgdGhpcy5tb3ZlSXRlbSh0aGlzLmdldEFjdGl2ZUl0ZW0oKSwgcmlnaHRJdGVtSW5kZXgpOyB9XHJcbiAgfVxyXG5cclxuICAvLyBQdWJsaWM6IE1vdmUgdGhlIGFjdGl2ZSB0YWIgdG8gdGhlIGxlZnRcclxuICBtb3ZlSXRlbUxlZnQoKSB7XHJcbiAgICBjb25zdCBpbmRleCA9IHRoaXMuZ2V0QWN0aXZlSXRlbUluZGV4KCk7XHJcbiAgICBjb25zdCBsZWZ0SXRlbUluZGV4ID0gaW5kZXggLSAxO1xyXG4gICAgaWYgKGxlZnRJdGVtSW5kZXggPj0gMCkgeyByZXR1cm4gdGhpcy5tb3ZlSXRlbSh0aGlzLmdldEFjdGl2ZUl0ZW0oKSwgbGVmdEl0ZW1JbmRleCk7IH1cclxuICB9XHJcblxyXG4gIC8vIFB1YmxpYzogR2V0IHRoZSBpbmRleCBvZiB0aGUgYWN0aXZlIGl0ZW0uXHJcbiAgLy9cclxuICAvLyBSZXR1cm5zIGEge051bWJlcn0uXHJcbiAgZ2V0QWN0aXZlSXRlbUluZGV4KCkge1xyXG4gICAgcmV0dXJuIHRoaXMuaXRlbXMuaW5kZXhPZih0aGlzLmFjdGl2ZUl0ZW0pO1xyXG4gIH1cclxuXHJcbiAgLy8gUHVibGljOiBBY3RpdmF0ZSB0aGUgaXRlbSBhdCB0aGUgZ2l2ZW4gaW5kZXguXHJcbiAgLy9cclxuICAvLyAqIGBpbmRleGAge051bWJlcn1cclxuICBhY3RpdmF0ZUl0ZW1BdEluZGV4KGluZGV4KSB7XHJcbiAgICBjb25zdCBpdGVtID0gdGhpcy5pdGVtQXRJbmRleChpbmRleCkgfHwgdGhpcy5nZXRBY3RpdmVJdGVtKCk7XHJcbiAgICByZXR1cm4gdGhpcy5zZXRBY3RpdmVJdGVtKGl0ZW0pO1xyXG4gIH1cclxuXHJcbiAgLy8gUHVibGljOiBNYWtlIHRoZSBnaXZlbiBpdGVtICphY3RpdmUqLCBjYXVzaW5nIGl0IHRvIGJlIGRpc3BsYXllZCBieVxyXG4gIC8vIHRoZSBwYW5lJ3Mgdmlldy5cclxuICAvL1xyXG4gIC8vICogYGl0ZW1gIFRoZSBpdGVtIHRvIGFjdGl2YXRlXHJcbiAgLy8gKiBgb3B0aW9uc2AgKG9wdGlvbmFsKSB7T2JqZWN0fVxyXG4gIC8vICAgKiBgcGVuZGluZ2AgKG9wdGlvbmFsKSB7Qm9vbGVhbn0gaW5kaWNhdGluZyB0aGF0IHRoZSBpdGVtIHNob3VsZCBiZSBhZGRlZFxyXG4gIC8vICAgICBpbiBhIHBlbmRpbmcgc3RhdGUgaWYgaXQgZG9lcyBub3QgeWV0IGV4aXN0IGluIHRoZSBwYW5lLiBFeGlzdGluZyBwZW5kaW5nXHJcbiAgLy8gICAgIGl0ZW1zIGluIGEgcGFuZSBhcmUgcmVwbGFjZWQgd2l0aCBuZXcgcGVuZGluZyBpdGVtcyB3aGVuIHRoZXkgYXJlIG9wZW5lZC5cclxuICBhY3RpdmF0ZUl0ZW0oaXRlbSwgb3B0aW9uczogYW55ID0ge30pIHtcclxuICAgIGlmIChpdGVtKSB7XHJcbiAgICAgIGNvbnN0IGluZGV4ID0gKHRoaXMuZ2V0UGVuZGluZ0l0ZW0oKSA9PT0gdGhpcy5hY3RpdmVJdGVtKVxyXG4gICAgICAgID8gdGhpcy5nZXRBY3RpdmVJdGVtSW5kZXgoKVxyXG4gICAgICAgIDogdGhpcy5nZXRBY3RpdmVJdGVtSW5kZXgoKSArIDE7XHJcbiAgICAgIHRoaXMuYWRkSXRlbShpdGVtLCBPYmplY3QuYXNzaWduKHt9LCBvcHRpb25zLCB7IGluZGV4IH0pKTtcclxuICAgICAgdGhpcy5zZXRBY3RpdmVJdGVtKGl0ZW0pO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLy8gUHVibGljOiBBZGQgdGhlIGdpdmVuIGl0ZW0gdG8gdGhlIHBhbmUuXHJcbiAgLy9cclxuICAvLyAqIGBpdGVtYCBUaGUgaXRlbSB0byBhZGQuIEl0IGNhbiBiZSBhIG1vZGVsIHdpdGggYW4gYXNzb2NpYXRlZCB2aWV3IG9yIGFcclxuICAvLyAgIHZpZXcuXHJcbiAgLy8gKiBgb3B0aW9uc2AgKG9wdGlvbmFsKSB7T2JqZWN0fVxyXG4gIC8vICAgKiBgaW5kZXhgIChvcHRpb25hbCkge051bWJlcn0gaW5kaWNhdGluZyB0aGUgaW5kZXggYXQgd2hpY2ggdG8gYWRkIHRoZSBpdGVtLlxyXG4gIC8vICAgICBJZiBvbWl0dGVkLCB0aGUgaXRlbSBpcyBhZGRlZCBhZnRlciB0aGUgY3VycmVudCBhY3RpdmUgaXRlbS5cclxuICAvLyAgICogYHBlbmRpbmdgIChvcHRpb25hbCkge0Jvb2xlYW59IGluZGljYXRpbmcgdGhhdCB0aGUgaXRlbSBzaG91bGQgYmVcclxuICAvLyAgICAgYWRkZWQgaW4gYSBwZW5kaW5nIHN0YXRlLiBFeGlzdGluZyBwZW5kaW5nIGl0ZW1zIGluIGEgcGFuZSBhcmUgcmVwbGFjZWQgd2l0aFxyXG4gIC8vICAgICBuZXcgcGVuZGluZyBpdGVtcyB3aGVuIHRoZXkgYXJlIG9wZW5lZC5cclxuICAvL1xyXG4gIC8vIFJldHVybnMgdGhlIGFkZGVkIGl0ZW0uXHJcbiAgYWRkSXRlbShpdGVtLCBvcHRpb25zOiBhbnkgPSB7fSkge1xyXG4gICAgLy8gQmFja3dhcmQgY29tcGF0IHdpdGggb2xkIEFQSTpcclxuICAgIC8vICAgYWRkSXRlbShpdGVtLCBpbmRleD1AZ2V0QWN0aXZlSXRlbUluZGV4KCkgKyAxKVxyXG4gICAgaWYgKHR5cGVvZiBvcHRpb25zID09PSAnbnVtYmVyJykge1xyXG4gICAgICBvcHRpb25zID0geyBpbmRleDogb3B0aW9ucyB9O1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IGluZGV4ID0gb3B0aW9ucy5pbmRleCAhPSBudWxsID8gb3B0aW9ucy5pbmRleCA6IHRoaXMuZ2V0QWN0aXZlSXRlbUluZGV4KCkgKyAxO1xyXG4gICAgY29uc3QgbW92ZWQgPSBvcHRpb25zLm1vdmVkICE9IG51bGwgPyBvcHRpb25zLm1vdmVkIDogZmFsc2U7XHJcbiAgICBjb25zdCBwZW5kaW5nID0gb3B0aW9ucy5wZW5kaW5nICE9IG51bGwgPyBvcHRpb25zLnBlbmRpbmcgOiBmYWxzZTtcclxuXHJcbiAgICBpZiAoIWl0ZW0gfHwgdHlwZW9mIGl0ZW0gIT09ICdvYmplY3QnKSB7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcihgUGFuZSBpdGVtcyBtdXN0IGJlIG9iamVjdHMuIEF0dGVtcHRlZCB0byBhZGQgaXRlbSAke2l0ZW19LmApO1xyXG4gICAgfVxyXG5cclxuICAgIGlmICh0eXBlb2YgaXRlbS5pc0Rlc3Ryb3llZCA9PT0gJ2Z1bmN0aW9uJyAmJiBpdGVtLmlzRGVzdHJveWVkKCkpIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKGBBZGRpbmcgYSBwYW5lIGl0ZW0gd2l0aCBVUklcclxuICAgICAgJyR7dHlwZW9mIGl0ZW0uZ2V0VVJJID09PSAnZnVuY3Rpb24nICYmIGl0ZW0uZ2V0VVJJKCl9JyB0aGF0IGhhcyBhbHJlYWR5IGJlZW4gZGVzdHJveWVkYCk7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKHRoaXMuaXRlbXMuZmluZChpdCA9PiBpdCA9PT0gaXRlbSkpIHsgcmV0dXJuOyB9XHJcblxyXG4gICAgaWYgKHR5cGVvZiBpdGVtLm9uRGlkRGVzdHJveSA9PT0gJ2Z1bmN0aW9uJykge1xyXG4gICAgfVxyXG5cclxuICAgIHRoaXMuaXRlbXMuc3BsaWNlKGluZGV4LCAwLCBpdGVtKTtcclxuICAgIGNvbnN0IGxhc3RQZW5kaW5nSXRlbSA9IHRoaXMuZ2V0UGVuZGluZ0l0ZW0oKTtcclxuICAgIGNvbnN0IHJlcGxhY2luZ1BlbmRpbmdJdGVtID0gbGFzdFBlbmRpbmdJdGVtICE9IG51bGwgJiYgIW1vdmVkO1xyXG4gICAgaWYgKHJlcGxhY2luZ1BlbmRpbmdJdGVtKSB7IHRoaXMucGVuZGluZ0l0ZW0gPSBudWxsOyB9XHJcbiAgICBpZiAocGVuZGluZykgeyB0aGlzLnNldFBlbmRpbmdJdGVtKGl0ZW0pOyB9XHJcblxyXG4gICAgdGhpcy5lbWl0dGVyLmVtaXQoJ2RpZC1hZGQtaXRlbScsIHsgaXRlbSwgaW5kZXgsIG1vdmVkIH0pO1xyXG4gICAgaWYgKCFtb3ZlZCkge1xyXG4gICAgICBpZiAodGhpcy5jb250YWluZXIpIHsgdGhpcy5jb250YWluZXIuZGlkQWRkUGFuZUl0ZW0oaXRlbSwgdGhpcywgaW5kZXgpOyB9XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKHJlcGxhY2luZ1BlbmRpbmdJdGVtKSB7IHRoaXMuZGVzdHJveUl0ZW0obGFzdFBlbmRpbmdJdGVtKTsgfVxyXG4gICAgaWYgKCF0aGlzLmdldEFjdGl2ZUl0ZW0oKSkgeyB0aGlzLnNldEFjdGl2ZUl0ZW0oaXRlbSk7IH1cclxuICAgIHJldHVybiBpdGVtO1xyXG4gIH1cclxuXHJcbiAgc2V0UGVuZGluZ0l0ZW0oaXRlbSkge1xyXG4gICAgaWYgKHRoaXMucGVuZGluZ0l0ZW0gIT09IGl0ZW0pIHtcclxuICAgICAgY29uc3QgbW9zdFJlY2VudFBlbmRpbmdJdGVtID0gdGhpcy5wZW5kaW5nSXRlbTtcclxuICAgICAgdGhpcy5wZW5kaW5nSXRlbSA9IGl0ZW07XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBnZXRQZW5kaW5nSXRlbSgpIHtcclxuICAgIHJldHVybiB0aGlzLnBlbmRpbmdJdGVtIHx8IG51bGw7XHJcbiAgfVxyXG5cclxuICBjbGVhclBlbmRpbmdJdGVtKCkge1xyXG4gICAgdGhpcy5zZXRQZW5kaW5nSXRlbShudWxsKTtcclxuICB9XHJcblxyXG4gIG9uSXRlbURpZFRlcm1pbmF0ZVBlbmRpbmdTdGF0ZShjYWxsYmFjaykge1xyXG4gIH1cclxuXHJcbiAgLy8gUHVibGljOiBBZGQgdGhlIGdpdmVuIGl0ZW1zIHRvIHRoZSBwYW5lLlxyXG4gIC8vXHJcbiAgLy8gKiBgaXRlbXNgIEFuIHtBcnJheX0gb2YgaXRlbXMgdG8gYWRkLiBJdGVtcyBjYW4gYmUgdmlld3Mgb3IgbW9kZWxzIHdpdGhcclxuICAvLyAgIGFzc29jaWF0ZWQgdmlld3MuIEFueSBvYmplY3RzIHRoYXQgYXJlIGFscmVhZHkgcHJlc2VudCBpbiB0aGUgcGFuZSdzXHJcbiAgLy8gICBjdXJyZW50IGl0ZW1zIHdpbGwgbm90IGJlIGFkZGVkIGFnYWluLlxyXG4gIC8vICogYGluZGV4YCAob3B0aW9uYWwpIHtOdW1iZXJ9IGluZGV4IGF0IHdoaWNoIHRvIGFkZCB0aGUgaXRlbXMuIElmIG9taXR0ZWQsXHJcbiAgLy8gICB0aGUgaXRlbSBpcyAjICAgYWRkZWQgYWZ0ZXIgdGhlIGN1cnJlbnQgYWN0aXZlIGl0ZW0uXHJcbiAgLy9cclxuICAvLyBSZXR1cm5zIGFuIHtBcnJheX0gb2YgYWRkZWQgaXRlbXMuXHJcbiAgYWRkSXRlbXMoaXRlbXM6IGFueVtdLCBpbmRleCA9IHRoaXMuZ2V0QWN0aXZlSXRlbUluZGV4KCkgKyAxKSB7XHJcbiAgICBpdGVtcyA9IGl0ZW1zLmZpbHRlcihpdGVtID0+ICF0aGlzLml0ZW1zLmZpbmQoaXQgPT4gaXQgPT09IGl0ZW0pKTtcclxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgaXRlbXMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgY29uc3QgaXRlbSA9IGl0ZW1zW2ldO1xyXG4gICAgICB0aGlzLmFkZEl0ZW0oaXRlbSwgeyBpbmRleDogaW5kZXggKyBpIH0pO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGl0ZW1zO1xyXG4gIH1cclxuXHJcbiAgcmVtb3ZlSXRlbShpdGVtLCBtb3ZlZCA9IGZhbHNlKSB7XHJcbiAgICBjb25zdCBpbmRleCA9IHRoaXMuaXRlbXMuaW5kZXhPZihpdGVtKTtcclxuICAgIGlmIChpbmRleCA9PT0gLTEpIHsgcmV0dXJuOyB9XHJcbiAgICBpZiAodGhpcy5nZXRQZW5kaW5nSXRlbSgpID09PSBpdGVtKSB7IHRoaXMucGVuZGluZ0l0ZW0gPSBudWxsOyB9XHJcbiAgICB0aGlzLnJlbW92ZUl0ZW1Gcm9tU3RhY2soaXRlbSk7XHJcbiAgICAvLyB0aGlzLmVtaXR0ZXIuZW1pdCgnd2lsbC1yZW1vdmUtaXRlbScsIHtpdGVtLCBpbmRleCwgZGVzdHJveWVkOiAhbW92ZWQsIG1vdmVkfSk7XHJcbiAgICB0aGlzLnVuc3Vic2NyaWJlRnJvbUl0ZW0oaXRlbSk7XHJcblxyXG4gICAgaWYgKGl0ZW0gPT09IHRoaXMuYWN0aXZlSXRlbSkge1xyXG4gICAgICBpZiAodGhpcy5pdGVtcy5sZW5ndGggPT09IDEpIHtcclxuICAgICAgICB0aGlzLnNldEFjdGl2ZUl0ZW0odW5kZWZpbmVkKTtcclxuICAgICAgfSBlbHNlIGlmIChpbmRleCA9PT0gMCkge1xyXG4gICAgICAgIHRoaXMuYWN0aXZhdGVOZXh0SXRlbSgpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHRoaXMuYWN0aXZhdGVQcmV2aW91c0l0ZW0oKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgdGhpcy5pdGVtcy5zcGxpY2UoaW5kZXgsIDEpO1xyXG4gICAgdGhpcy5lbWl0dGVyLmVtaXQoJ2RpZC1yZW1vdmUtaXRlbScsIHsgaXRlbSwgaW5kZXgsIGRlc3Ryb3llZDogIW1vdmVkLCBtb3ZlZCB9KTtcclxuICAgIGlmICghbW92ZWQgJiYgdGhpcy5jb250YWluZXIpIHsgdGhpcy5jb250YWluZXIuZGlkRGVzdHJveVBhbmVJdGVtKHsgaXRlbSwgaW5kZXgsIHBhbmU6IHRoaXMgfSk7IH1cclxuICAgIGlmICh0aGlzLml0ZW1zLmxlbmd0aCA9PT0gMCAmJiB0aGlzLmNvbmZpZyAmJiB0aGlzLmNvbmZpZy5nZXQgJiYgdGhpcy5jb25maWcuZ2V0KCdjb3JlLmRlc3Ryb3lFbXB0eVBhbmVzJykpIHtcclxuICAgICAgdGhpcy5kZXN0cm95KCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvLyBSZW1vdmUgdGhlIGdpdmVuIGl0ZW0gZnJvbSB0aGUgaXRlbVN0YWNrLlxyXG4gIC8vXHJcbiAgLy8gKiBgaXRlbWAgVGhlIGl0ZW0gdG8gcmVtb3ZlLlxyXG4gIC8vICogYGluZGV4YCB7TnVtYmVyfSBpbmRpY2F0aW5nIHRoZSBpbmRleCB0byB3aGljaCB0byByZW1vdmUgdGhlIGl0ZW0gZnJvbSB0aGUgaXRlbVN0YWNrLlxyXG4gIHJlbW92ZUl0ZW1Gcm9tU3RhY2soaXRlbSkge1xyXG4gICAgY29uc3QgaW5kZXggPSB0aGlzLml0ZW1TdGFjay5pbmRleE9mKGl0ZW0pO1xyXG4gICAgaWYgKGluZGV4ICE9PSAtMSkgeyB0aGlzLml0ZW1TdGFjay5zcGxpY2UoaW5kZXgsIDEpOyB9XHJcbiAgfVxyXG5cclxuICAvLyBQdWJsaWM6IE1vdmUgdGhlIGdpdmVuIGl0ZW0gdG8gdGhlIGdpdmVuIGluZGV4LlxyXG4gIC8vXHJcbiAgLy8gKiBgaXRlbWAgVGhlIGl0ZW0gdG8gbW92ZS5cclxuICAvLyAqIGBpbmRleGAge051bWJlcn0gaW5kaWNhdGluZyB0aGUgaW5kZXggdG8gd2hpY2ggdG8gbW92ZSB0aGUgaXRlbS5cclxuICBtb3ZlSXRlbShpdGVtLCBuZXdJbmRleCkge1xyXG4gICAgY29uc3Qgb2xkSW5kZXggPSB0aGlzLml0ZW1zLmluZGV4T2YoaXRlbSk7XHJcbiAgICB0aGlzLml0ZW1zLnNwbGljZShvbGRJbmRleCwgMSk7XHJcbiAgICB0aGlzLml0ZW1zLnNwbGljZShuZXdJbmRleCwgMCwgaXRlbSk7XHJcbiAgfVxyXG5cclxuICAvLyBQdWJsaWM6IE1vdmUgdGhlIGdpdmVuIGl0ZW0gdG8gdGhlIGdpdmVuIGluZGV4IG9uIGFub3RoZXIgcGFuZS5cclxuICAvL1xyXG4gIC8vICogYGl0ZW1gIFRoZSBpdGVtIHRvIG1vdmUuXHJcbiAgLy8gKiBgcGFuZWAge1BhbmV9IHRvIHdoaWNoIHRvIG1vdmUgdGhlIGl0ZW0uXHJcbiAgLy8gKiBgaW5kZXhgIHtOdW1iZXJ9IGluZGljYXRpbmcgdGhlIGluZGV4IHRvIHdoaWNoIHRvIG1vdmUgdGhlIGl0ZW0gaW4gdGhlXHJcbiAgLy8gICBnaXZlbiBwYW5lLlxyXG4gIG1vdmVJdGVtVG9QYW5lKGl0ZW0/LCBwYW5lPywgaW5kZXg/KSB7XHJcbiAgICB0aGlzLnJlbW92ZUl0ZW0oaXRlbSwgdHJ1ZSk7XHJcbiAgICByZXR1cm4gcGFuZS5hZGRJdGVtKGl0ZW0sIHsgaW5kZXgsIG1vdmVkOiB0cnVlIH0pO1xyXG4gIH1cclxuXHJcbiAgLy8gUHVibGljOiBEZXN0cm95IHRoZSBhY3RpdmUgaXRlbSBhbmQgYWN0aXZhdGUgdGhlIG5leHQgaXRlbS5cclxuICAvL1xyXG4gIC8vIFJldHVybnMgYSB7UHJvbWlzZX0gdGhhdCByZXNvbHZlcyB3aGVuIHRoZSBpdGVtIGlzIGRlc3Ryb3llZC5cclxuICBkZXN0cm95QWN0aXZlSXRlbSgpIHtcclxuICAgIHJldHVybiB0aGlzLmRlc3Ryb3lJdGVtKHRoaXMuYWN0aXZlSXRlbSk7XHJcbiAgfVxyXG5cclxuICAvLyBQdWJsaWM6IERlc3Ryb3kgdGhlIGdpdmVuIGl0ZW0uXHJcbiAgLy9cclxuICAvLyBJZiB0aGUgaXRlbSBpcyBhY3RpdmUsIHRoZSBuZXh0IGl0ZW0gd2lsbCBiZSBhY3RpdmF0ZWQuIElmIHRoZSBpdGVtIGlzIHRoZVxyXG4gIC8vIGxhc3QgaXRlbSwgdGhlIHBhbmUgd2lsbCBiZSBkZXN0cm95ZWQgaWYgdGhlIGBjb3JlLmRlc3Ryb3lFbXB0eVBhbmVzYCBjb25maWdcclxuICAvLyBzZXR0aW5nIGlzIGB0cnVlYC5cclxuICAvL1xyXG4gIC8vICogYGl0ZW1gIEl0ZW0gdG8gZGVzdHJveVxyXG4gIC8vICogYGZvcmNlYCAob3B0aW9uYWwpIHtCb29sZWFufSBEZXN0cm95IHRoZSBpdGVtIHdpdGhvdXQgcHJvbXB0aW5nIHRvIHNhdmVcclxuICAvLyAgICBpdCwgZXZlbiBpZiB0aGUgaXRlbSdzIGBpc1Blcm1hbmVudERvY2tJdGVtYCBtZXRob2QgcmV0dXJucyB0cnVlLlxyXG4gIC8vXHJcbiAgLy8gUmV0dXJucyBhIHtQcm9taXNlfSB0aGF0IHJlc29sdmVzIHdpdGggYSB7Qm9vbGVhbn0gaW5kaWNhdGluZyB3aGV0aGVyIG9yIG5vdFxyXG4gIC8vIHRoZSBpdGVtIHdhcyBkZXN0cm95ZWQuXHJcbiAgYXN5bmMgZGVzdHJveUl0ZW0oaXRlbT86IGFueSwgZm9yY2U/KSB7XHJcbiAgICBjb25zdCBpbmRleCA9IHRoaXMuaXRlbXMuaW5kZXhPZihpdGVtKTtcclxuICAgIGlmIChpbmRleCA9PT0gLTEpIHsgcmV0dXJuIGZhbHNlOyB9XHJcblxyXG4gICAgaWYgKCFmb3JjZSAmJlxyXG4gICAgICB0eXBlb2YgaXRlbS5pc1Blcm1hbmVudERvY2tJdGVtID09PSAnZnVuY3Rpb24nICYmIGl0ZW0uaXNQZXJtYW5lbnREb2NrSXRlbSgpICYmXHJcbiAgICAgICghdGhpcy5jb250YWluZXIgfHwgdGhpcy5jb250YWluZXIuZ2V0TG9jYXRpb24oKSAhPT0gJ2NlbnRlcicpKSB7XHJcbiAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBJbiB0aGUgY2FzZSB3aGVyZSB0aGVyZSBhcmUgbm8gYG9uV2lsbERlc3Ryb3lQYW5lSXRlbWAgbGlzdGVuZXJzLCBwcmVzZXJ2ZSB0aGUgb2xkIGJlaGF2aW9yXHJcbiAgICAvLyB3aGVyZSBgUGFuZS5kZXN0cm95SXRlbWAgYW5kIGNhbGxlcnMgc3VjaCBhcyBgUGFuZS5jbG9zZWAgdGFrZSBlZmZlY3Qgc3luY2hyb25vdXNseS5cclxuXHJcblxyXG4gICAgdGhpcy5yZW1vdmVJdGVtKGl0ZW0sIGZhbHNlKTtcclxuICAgIGlmICh0eXBlb2YgaXRlbS5kZXN0cm95ID09PSAnZnVuY3Rpb24nKSB7IGl0ZW0uZGVzdHJveSgpOyB9XHJcbiAgICByZXR1cm4gdHJ1ZTtcclxuICB9XHJcblxyXG4gIC8vIFB1YmxpYzogRGVzdHJveSBhbGwgaXRlbXMuXHJcbiAgZGVzdHJveUl0ZW1zKCkge1xyXG4gICAgcmV0dXJuIFByb21pc2UuYWxsKFxyXG4gICAgICB0aGlzLmdldEl0ZW1zKCkubWFwKGl0ZW0gPT4gdGhpcy5kZXN0cm95SXRlbShpdGVtKSlcclxuICAgICk7XHJcbiAgfVxyXG5cclxuICAvLyBQdWJsaWM6IERlc3Ryb3kgYWxsIGl0ZW1zIGV4Y2VwdCBmb3IgdGhlIGFjdGl2ZSBpdGVtLlxyXG4gIGRlc3Ryb3lJbmFjdGl2ZUl0ZW1zKCkge1xyXG4gICAgcmV0dXJuIFByb21pc2UuYWxsKFxyXG4gICAgICB0aGlzLmdldEl0ZW1zKClcclxuICAgICAgICAuZmlsdGVyKGl0ZW0gPT4gaXRlbSAhPT0gdGhpcy5hY3RpdmVJdGVtKVxyXG4gICAgICAgIC5tYXAoaXRlbSA9PiB0aGlzLmRlc3Ryb3lJdGVtKGl0ZW0pKVxyXG4gICAgKTtcclxuICB9XHJcblxyXG4gIHByb21wdFRvU2F2ZUl0ZW0oaXRlbSwgb3B0aW9ucyA9IHt9KTogUHJvbWlzZTxib29sZWFuPiB7XHJcbiAgICBpZiAodHlwZW9mIGl0ZW0uc2hvdWxkUHJvbXB0VG9TYXZlICE9PSAnZnVuY3Rpb24nIHx8ICFpdGVtLnNob3VsZFByb21wdFRvU2F2ZShvcHRpb25zKSkge1xyXG4gICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHRydWUpO1xyXG4gICAgfVxyXG5cclxuICAgIGxldCB1cmk7XHJcbiAgICBpZiAodHlwZW9mIGl0ZW0uZ2V0VVJJID09PSAnZnVuY3Rpb24nKSB7XHJcbiAgICAgIHVyaSA9IGl0ZW0uZ2V0VVJJKCk7XHJcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiBpdGVtLmdldFVyaSA9PT0gJ2Z1bmN0aW9uJykge1xyXG4gICAgICB1cmkgPSBpdGVtLmdldFVyaSgpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh0cnVlKTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCB0aXRsZSA9ICh0eXBlb2YgaXRlbS5nZXRUaXRsZSA9PT0gJ2Z1bmN0aW9uJyAmJiBpdGVtLmdldFRpdGxlKCkpIHx8IHVyaTtcclxuXHJcbiAgICBjb25zdCBzYXZlRGlhbG9nID0gKHNhdmVCdXR0b25UZXh0LCBzYXZlRm4sIG1lc3NhZ2UpOiBQcm9taXNlPGJvb2xlYW4+ID0+IHtcclxuICAgICAgY29uc3QgY2hvc2VuID0gdGhpcy5hcHBsaWNhdGlvbkRlbGVnYXRlLmNvbmZpcm0oe1xyXG4gICAgICAgIG1lc3NhZ2UsXHJcbiAgICAgICAgZGV0YWlsZWRNZXNzYWdlOiAnWW91ciBjaGFuZ2VzIHdpbGwgYmUgbG9zdCBpZiB5b3UgY2xvc2UgdGhpcyBpdGVtIHdpdGhvdXQgc2F2aW5nLicsXHJcbiAgICAgICAgYnV0dG9uczogW3NhdmVCdXR0b25UZXh0LCAnQ2FuY2VsJywgJyZEb25cXCd0IFNhdmUnXVxyXG4gICAgICB9XHJcbiAgICAgICk7XHJcblxyXG4gICAgICBzd2l0Y2ggKGNob3Nlbikge1xyXG4gICAgICAgIGNhc2UgMDpcclxuICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHtcclxuICAgICAgICAgICAgcmV0dXJuIHNhdmVGbihpdGVtLCBlcnJvciA9PiB7XHJcbiAgICAgICAgICAgICAgaWYgKGVycm9yIGluc3RhbmNlb2YgU2F2ZUNhbmNlbGxlZEVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICByZXNvbHZlKGZhbHNlKTtcclxuICAgICAgICAgICAgICB9IGVsc2UgaWYgKGVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICBzYXZlRGlhbG9nKFxyXG4gICAgICAgICAgICAgICAgICAnU2F2ZSBhcycsXHJcbiAgICAgICAgICAgICAgICAgIHRoaXMuc2F2ZUl0ZW1BcyxcclxuICAgICAgICAgICAgICAgICAgYCcke3RpdGxlfScgY291bGQgbm90IGJlIHNhdmVkLlxcbkVycm9yOiAke3RoaXMuZ2V0TWVzc2FnZUZvckVycm9yQ29kZShlcnJvci5jb2RlKX1gXHJcbiAgICAgICAgICAgICAgICApLnRoZW4ocmVzb2x2ZSk7XHJcbiAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHJlc29sdmUodHJ1ZSk7XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIGNhc2UgMTpcclxuICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoZmFsc2UpO1xyXG4gICAgICAgIGNhc2UgMjpcclxuICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUodHJ1ZSk7XHJcbiAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgcmV0dXJuIHNhdmVEaWFsb2coXHJcbiAgICAgICdTYXZlJyxcclxuICAgICAgdGhpcy5zYXZlSXRlbSxcclxuICAgICAgYCcke3RpdGxlfScgaGFzIGNoYW5nZXMsIGRvIHlvdSB3YW50IHRvIHNhdmUgdGhlbT9gXHJcbiAgICApO1xyXG4gIH1cclxuXHJcbiAgLy8gUHVibGljOiBTYXZlIHRoZSBhY3RpdmUgaXRlbS5cclxuICBzYXZlQWN0aXZlSXRlbShuZXh0QWN0aW9uPzogKCkgPT4gYW55KSB7XHJcbiAgICByZXR1cm4gdGhpcy5zYXZlSXRlbSh0aGlzLmdldEFjdGl2ZUl0ZW0oKSwgbmV4dEFjdGlvbik7XHJcbiAgfVxyXG5cclxuICAvLyBQdWJsaWM6IFByb21wdCB0aGUgdXNlciBmb3IgYSBsb2NhdGlvbiBhbmQgc2F2ZSB0aGUgYWN0aXZlIGl0ZW0gd2l0aCB0aGVcclxuICAvLyBwYXRoIHRoZXkgc2VsZWN0LlxyXG4gIC8vXHJcbiAgLy8gKiBgbmV4dEFjdGlvbmAgKG9wdGlvbmFsKSB7RnVuY3Rpb259IHdoaWNoIHdpbGwgYmUgY2FsbGVkIGFmdGVyIHRoZSBpdGVtIGlzXHJcbiAgLy8gICBzdWNjZXNzZnVsbHkgc2F2ZWQuXHJcbiAgLy9cclxuICAvLyBSZXR1cm5zIGEge1Byb21pc2V9IHRoYXQgcmVzb2x2ZXMgd2hlbiB0aGUgc2F2ZSBpcyBjb21wbGV0ZVxyXG4gIHNhdmVBY3RpdmVJdGVtQXMobmV4dEFjdGlvbj86ICgpID0+IGFueSkge1xyXG4gICAgcmV0dXJuIHRoaXMuc2F2ZUl0ZW1Bcyh0aGlzLmdldEFjdGl2ZUl0ZW0oKSwgbmV4dEFjdGlvbik7XHJcbiAgfVxyXG5cclxuICAvLyBQdWJsaWM6IFNhdmUgdGhlIGdpdmVuIGl0ZW0uXHJcbiAgLy9cclxuICAvLyAqIGBpdGVtYCBUaGUgaXRlbSB0byBzYXZlLlxyXG4gIC8vICogYG5leHRBY3Rpb25gIChvcHRpb25hbCkge0Z1bmN0aW9ufSB3aGljaCB3aWxsIGJlIGNhbGxlZCB3aXRoIG5vIGFyZ3VtZW50XHJcbiAgLy8gICBhZnRlciB0aGUgaXRlbSBpcyBzdWNjZXNzZnVsbHkgc2F2ZWQsIG9yIHdpdGggdGhlIGVycm9yIGlmIGl0IGZhaWxlZC5cclxuICAvLyAgIFRoZSByZXR1cm4gdmFsdWUgd2lsbCBiZSB0aGF0IG9mIGBuZXh0QWN0aW9uYCBvciBgdW5kZWZpbmVkYCBpZiBpdCB3YXMgbm90XHJcbiAgLy8gICBwcm92aWRlZFxyXG4gIC8vXHJcbiAgLy8gUmV0dXJucyBhIHtQcm9taXNlfSB0aGF0IHJlc29sdmVzIHdoZW4gdGhlIHNhdmUgaXMgY29tcGxldGVcclxuICBzYXZlSXRlbShpdGVtLCBuZXh0QWN0aW9uKSB7XHJcbiAgICBpZiAoIWl0ZW0pIHsgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpOyB9XHJcblxyXG4gICAgbGV0IGl0ZW1VUkk7XHJcbiAgICBpZiAodHlwZW9mIGl0ZW0uZ2V0VVJJID09PSAnZnVuY3Rpb24nKSB7XHJcbiAgICAgIGl0ZW1VUkkgPSBpdGVtLmdldFVSSSgpO1xyXG4gICAgfSBlbHNlIGlmICh0eXBlb2YgaXRlbS5nZXRVcmkgPT09ICdmdW5jdGlvbicpIHtcclxuICAgICAgaXRlbVVSSSA9IGl0ZW0uZ2V0VXJpKCk7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKGl0ZW1VUkkgIT0gbnVsbCkge1xyXG4gICAgICBpZiAodHlwZW9mIGl0ZW0uc2F2ZSA9PT0gJ2Z1bmN0aW9uJykge1xyXG4gICAgICAgIHJldHVybiBwcm9taXNpZnkoKCkgPT4gaXRlbS5zYXZlKCkpXHJcbiAgICAgICAgICAudGhlbigoKSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChuZXh0QWN0aW9uKSB7IG5leHRBY3Rpb24oKTsgfVxyXG4gICAgICAgICAgfSlcclxuICAgICAgICAgIC5jYXRjaChlcnJvciA9PiB7XHJcbiAgICAgICAgICAgIGlmIChuZXh0QWN0aW9uKSB7XHJcbiAgICAgICAgICAgICAgbmV4dEFjdGlvbihlcnJvcik7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgdGhpcy5oYW5kbGVTYXZlRXJyb3IoZXJyb3IsIGl0ZW0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgfSBlbHNlIGlmIChuZXh0QWN0aW9uKSB7XHJcbiAgICAgICAgbmV4dEFjdGlvbigpO1xyXG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKTtcclxuICAgICAgfVxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgcmV0dXJuIHRoaXMuc2F2ZUl0ZW1BcyhpdGVtLCBuZXh0QWN0aW9uKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8vIFB1YmxpYzogUHJvbXB0IHRoZSB1c2VyIGZvciBhIGxvY2F0aW9uIGFuZCBzYXZlIHRoZSBhY3RpdmUgaXRlbSB3aXRoIHRoZVxyXG4gIC8vIHBhdGggdGhleSBzZWxlY3QuXHJcbiAgLy9cclxuICAvLyAqIGBpdGVtYCBUaGUgaXRlbSB0byBzYXZlLlxyXG4gIC8vICogYG5leHRBY3Rpb25gIChvcHRpb25hbCkge0Z1bmN0aW9ufSB3aGljaCB3aWxsIGJlIGNhbGxlZCB3aXRoIG5vIGFyZ3VtZW50XHJcbiAgLy8gICBhZnRlciB0aGUgaXRlbSBpcyBzdWNjZXNzZnVsbHkgc2F2ZWQsIG9yIHdpdGggdGhlIGVycm9yIGlmIGl0IGZhaWxlZC5cclxuICAvLyAgIFRoZSByZXR1cm4gdmFsdWUgd2lsbCBiZSB0aGF0IG9mIGBuZXh0QWN0aW9uYCBvciBgdW5kZWZpbmVkYCBpZiBpdCB3YXMgbm90XHJcbiAgLy8gICBwcm92aWRlZFxyXG4gIHNhdmVJdGVtQXMoaXRlbSwgbmV4dEFjdGlvbikge1xyXG4gIH1cclxuXHJcbiAgLy8gUHVibGljOiBTYXZlIGFsbCBpdGVtcy5cclxuICBzYXZlSXRlbXMoKSB7XHJcbiAgfVxyXG5cclxuICAvLyBQdWJsaWM6IFJldHVybiB0aGUgZmlyc3QgaXRlbSB0aGF0IG1hdGNoZXMgdGhlIGdpdmVuIFVSSSBvciB1bmRlZmluZWQgaWZcclxuICAvLyBub25lIGV4aXN0cy5cclxuICAvL1xyXG4gIC8vICogYHVyaWAge1N0cmluZ30gY29udGFpbmluZyBhIFVSSS5cclxuICBpdGVtRm9yVVJJKHVyaSkge1xyXG4gICAgcmV0dXJuIHRoaXMuaXRlbXMuZmluZChpdGVtID0+IHtcclxuICAgICAgaWYgKHR5cGVvZiBpdGVtLmdldFVSSSA9PT0gJ2Z1bmN0aW9uJykge1xyXG4gICAgICAgIHJldHVybiBpdGVtLmdldFVSSSgpID09PSB1cmk7XHJcbiAgICAgIH0gZWxzZSBpZiAodHlwZW9mIGl0ZW0uZ2V0VXJpID09PSAnZnVuY3Rpb24nKSB7XHJcbiAgICAgICAgcmV0dXJuIGl0ZW0uZ2V0VXJpKCkgPT09IHVyaTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvLyBQdWJsaWM6IEFjdGl2YXRlIHRoZSBmaXJzdCBpdGVtIHRoYXQgbWF0Y2hlcyB0aGUgZ2l2ZW4gVVJJLlxyXG4gIC8vXHJcbiAgLy8gKiBgdXJpYCB7U3RyaW5nfSBjb250YWluaW5nIGEgVVJJLlxyXG4gIC8vXHJcbiAgLy8gUmV0dXJucyBhIHtCb29sZWFufSBpbmRpY2F0aW5nIHdoZXRoZXIgYW4gaXRlbSBtYXRjaGluZyB0aGUgVVJJIHdhcyBmb3VuZC5cclxuICBhY3RpdmF0ZUl0ZW1Gb3JVUkkodXJpKSB7XHJcbiAgICBjb25zdCBpdGVtID0gdGhpcy5pdGVtRm9yVVJJKHVyaSk7XHJcbiAgICBpZiAoaXRlbSkge1xyXG4gICAgICB0aGlzLmFjdGl2YXRlSXRlbShpdGVtKTtcclxuICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBjb3B5QWN0aXZlSXRlbSgpIHtcclxuICAgIGlmICh0aGlzLmFjdGl2ZUl0ZW0gJiYgdHlwZW9mIHRoaXMuYWN0aXZlSXRlbS5jb3B5ID09PSAnZnVuY3Rpb24nKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLmFjdGl2ZUl0ZW0uY29weSgpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLypcclxuICBTZWN0aW9uOiBMaWZlY3ljbGVcclxuICAqL1xyXG5cclxuICAvLyBQdWJsaWM6IERldGVybWluZSB3aGV0aGVyIHRoZSBwYW5lIGlzIGFjdGl2ZS5cclxuICAvL1xyXG4gIC8vIFJldHVybnMgYSB7Qm9vbGVhbn0uXHJcbiAgaXNBY3RpdmUoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5jb250YWluZXIgJiYgdGhpcy5jb250YWluZXIuZ2V0QWN0aXZlUGFuZSgpID09PSB0aGlzO1xyXG4gIH1cclxuXHJcbiAgLy8gUHVibGljOiBNYWtlcyB0aGlzIHBhbmUgdGhlICphY3RpdmUqIHBhbmUsIGNhdXNpbmcgaXQgdG8gZ2FpbiBmb2N1cy5cclxuICBhY3RpdmF0ZSgpIHtcclxuICB9XHJcblxyXG4gIC8vIFB1YmxpYzogQ2xvc2UgdGhlIHBhbmUgYW5kIGRlc3Ryb3kgYWxsIGl0cyBpdGVtcy5cclxuICAvL1xyXG4gIC8vIElmIHRoaXMgaXMgdGhlIGxhc3QgcGFuZSwgYWxsIHRoZSBpdGVtcyB3aWxsIGJlIGRlc3Ryb3llZCBidXQgdGhlIHBhbmVcclxuICAvLyBpdHNlbGYgd2lsbCBub3QgYmUgZGVzdHJveWVkLlxyXG4gIGRlc3Ryb3koKSB7XHJcbiAgfVxyXG5cclxuICBpc0FsaXZlKCkgeyByZXR1cm4gdGhpcy5hbGl2ZTsgfVxyXG5cclxuICAvLyBQdWJsaWM6IERldGVybWluZSB3aGV0aGVyIHRoaXMgcGFuZSBoYXMgYmVlbiBkZXN0cm95ZWQuXHJcbiAgLy9cclxuICAvLyBSZXR1cm5zIGEge0Jvb2xlYW59LlxyXG4gIGlzRGVzdHJveWVkKCkgeyByZXR1cm4gIXRoaXMuaXNBbGl2ZSgpOyB9XHJcblxyXG4gIC8qXHJcbiAgU2VjdGlvbjogU3BsaXR0aW5nXHJcbiAgKi9cclxuXHJcbiAgLy8gUHVibGljOiBDcmVhdGUgYSBuZXcgcGFuZSB0byB0aGUgbGVmdCBvZiB0aGlzIHBhbmUuXHJcbiAgLy9cclxuICAvLyAqIGBwYXJhbXNgIChvcHRpb25hbCkge09iamVjdH0gd2l0aCB0aGUgZm9sbG93aW5nIGtleXM6XHJcbiAgLy8gICAqIGBpdGVtc2AgKG9wdGlvbmFsKSB7QXJyYXl9IG9mIGl0ZW1zIHRvIGFkZCB0byB0aGUgbmV3IHBhbmUuXHJcbiAgLy8gICAqIGBjb3B5QWN0aXZlSXRlbWAgKG9wdGlvbmFsKSB7Qm9vbGVhbn0gdHJ1ZSB3aWxsIGNvcHkgdGhlIGFjdGl2ZSBpdGVtIGludG8gdGhlIG5ldyBzcGxpdCBwYW5lXHJcbiAgLy9cclxuICAvLyBSZXR1cm5zIHRoZSBuZXcge1BhbmV9LlxyXG4gIHNwbGl0TGVmdChwYXJhbXMpIHtcclxuICAgIHJldHVybiB0aGlzLnNwbGl0KCdob3Jpem9udGFsJywgJ2JlZm9yZScsIHBhcmFtcyk7XHJcbiAgfVxyXG5cclxuICAvLyBQdWJsaWM6IENyZWF0ZSBhIG5ldyBwYW5lIHRvIHRoZSByaWdodCBvZiB0aGlzIHBhbmUuXHJcbiAgLy9cclxuICAvLyAqIGBwYXJhbXNgIChvcHRpb25hbCkge09iamVjdH0gd2l0aCB0aGUgZm9sbG93aW5nIGtleXM6XHJcbiAgLy8gICAqIGBpdGVtc2AgKG9wdGlvbmFsKSB7QXJyYXl9IG9mIGl0ZW1zIHRvIGFkZCB0byB0aGUgbmV3IHBhbmUuXHJcbiAgLy8gICAqIGBjb3B5QWN0aXZlSXRlbWAgKG9wdGlvbmFsKSB7Qm9vbGVhbn0gdHJ1ZSB3aWxsIGNvcHkgdGhlIGFjdGl2ZSBpdGVtIGludG8gdGhlIG5ldyBzcGxpdCBwYW5lXHJcbiAgLy9cclxuICAvLyBSZXR1cm5zIHRoZSBuZXcge1BhbmV9LlxyXG4gIHNwbGl0UmlnaHQocGFyYW1zKSB7XHJcbiAgICByZXR1cm4gdGhpcy5zcGxpdCgnaG9yaXpvbnRhbCcsICdhZnRlcicsIHBhcmFtcyk7XHJcbiAgfVxyXG5cclxuICAvLyBQdWJsaWM6IENyZWF0ZXMgYSBuZXcgcGFuZSBhYm92ZSB0aGUgcmVjZWl2ZXIuXHJcbiAgLy9cclxuICAvLyAqIGBwYXJhbXNgIChvcHRpb25hbCkge09iamVjdH0gd2l0aCB0aGUgZm9sbG93aW5nIGtleXM6XHJcbiAgLy8gICAqIGBpdGVtc2AgKG9wdGlvbmFsKSB7QXJyYXl9IG9mIGl0ZW1zIHRvIGFkZCB0byB0aGUgbmV3IHBhbmUuXHJcbiAgLy8gICAqIGBjb3B5QWN0aXZlSXRlbWAgKG9wdGlvbmFsKSB7Qm9vbGVhbn0gdHJ1ZSB3aWxsIGNvcHkgdGhlIGFjdGl2ZSBpdGVtIGludG8gdGhlIG5ldyBzcGxpdCBwYW5lXHJcbiAgLy9cclxuICAvLyBSZXR1cm5zIHRoZSBuZXcge1BhbmV9LlxyXG4gIHNwbGl0VXAocGFyYW1zKSB7XHJcbiAgICByZXR1cm4gdGhpcy5zcGxpdCgndmVydGljYWwnLCAnYmVmb3JlJywgcGFyYW1zKTtcclxuICB9XHJcblxyXG4gIC8vIFB1YmxpYzogQ3JlYXRlcyBhIG5ldyBwYW5lIGJlbG93IHRoZSByZWNlaXZlci5cclxuICAvL1xyXG4gIC8vICogYHBhcmFtc2AgKG9wdGlvbmFsKSB7T2JqZWN0fSB3aXRoIHRoZSBmb2xsb3dpbmcga2V5czpcclxuICAvLyAgICogYGl0ZW1zYCAob3B0aW9uYWwpIHtBcnJheX0gb2YgaXRlbXMgdG8gYWRkIHRvIHRoZSBuZXcgcGFuZS5cclxuICAvLyAgICogYGNvcHlBY3RpdmVJdGVtYCAob3B0aW9uYWwpIHtCb29sZWFufSB0cnVlIHdpbGwgY29weSB0aGUgYWN0aXZlIGl0ZW0gaW50byB0aGUgbmV3IHNwbGl0IHBhbmVcclxuICAvL1xyXG4gIC8vIFJldHVybnMgdGhlIG5ldyB7UGFuZX0uXHJcbiAgc3BsaXREb3duKHBhcmFtcykge1xyXG4gICAgcmV0dXJuIHRoaXMuc3BsaXQoJ3ZlcnRpY2FsJywgJ2FmdGVyJywgcGFyYW1zKTtcclxuICB9XHJcblxyXG4gIHNwbGl0KG9yaWVudGF0aW9uLCBzaWRlLCBwYXJhbXMpIHtcclxuICAgIGlmIChwYXJhbXMgJiYgcGFyYW1zLmNvcHlBY3RpdmVJdGVtKSB7XHJcbiAgICAgIGlmICghcGFyYW1zLml0ZW1zKSB7IHBhcmFtcy5pdGVtcyA9IFtdOyB9XHJcbiAgICAgIHBhcmFtcy5pdGVtcy5wdXNoKHRoaXMuY29weUFjdGl2ZUl0ZW0oKSk7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKHRoaXMucGFyZW50Lm9yaWVudGF0aW9uICE9PSBvcmllbnRhdGlvbikge1xyXG4gICAgICB0aGlzLnBhcmVudC5yZXBsYWNlQ2hpbGQodGhpcywgbmV3IFBhbmVBeGlzKHtcclxuICAgICAgICBjb250YWluZXI6IHRoaXMuY29udGFpbmVyLFxyXG4gICAgICAgIG9yaWVudGF0aW9uLFxyXG4gICAgICAgIGNoaWxkcmVuOiBbdGhpc10sXHJcbiAgICAgICAgZmxleFNjYWxlOiB0aGlzLmZsZXhTY2FsZVxyXG4gICAgICB9LFxyXG4gICAgICAgIHRoaXMudmlld1JlZ2lzdHJ5XHJcbiAgICAgICkpO1xyXG4gICAgICB0aGlzLnNldEZsZXhTY2FsZSgxKTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBuZXdQYW5lID0gbmV3IFBhbmUoT2JqZWN0LmFzc2lnbih7XHJcbiAgICAgIGFwcGxpY2F0aW9uRGVsZWdhdGU6IHRoaXMuYXBwbGljYXRpb25EZWxlZ2F0ZSxcclxuICAgICAgbm90aWZpY2F0aW9uTWFuYWdlcjogdGhpcy5ub3RpZmljYXRpb25NYW5hZ2VyLFxyXG4gICAgICBkZXNlcmlhbGl6ZXJNYW5hZ2VyOiB0aGlzLmRlc2VyaWFsaXplck1hbmFnZXIsXHJcbiAgICAgIGNvbmZpZzogdGhpcy5jb25maWcsXHJcbiAgICAgIHZpZXdSZWdpc3RyeTogdGhpcy52aWV3UmVnaXN0cnlcclxuICAgIH0sIHBhcmFtcykpO1xyXG5cclxuICAgIHN3aXRjaCAoc2lkZSkge1xyXG4gICAgICBjYXNlICdiZWZvcmUnOiB0aGlzLnBhcmVudC5pbnNlcnRDaGlsZEJlZm9yZSh0aGlzLCBuZXdQYW5lKTsgYnJlYWs7XHJcbiAgICAgIGNhc2UgJ2FmdGVyJzogdGhpcy5wYXJlbnQuaW5zZXJ0Q2hpbGRBZnRlcih0aGlzLCBuZXdQYW5lKTsgYnJlYWs7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKHBhcmFtcyAmJiBwYXJhbXMubW92ZUFjdGl2ZUl0ZW0gJiYgdGhpcy5hY3RpdmVJdGVtKSB7XHJcbiAgICAgIHRoaXMubW92ZUl0ZW1Ub1BhbmUodGhpcy5hY3RpdmVJdGVtLCBuZXdQYW5lKTtcclxuICAgIH1cclxuXHJcbiAgICBuZXdQYW5lLmFjdGl2YXRlKCk7XHJcbiAgICByZXR1cm4gbmV3UGFuZTtcclxuICB9XHJcblxyXG4gIC8vIElmIHRoZSBwYXJlbnQgaXMgYSBob3Jpem9udGFsIGF4aXMsIHJldHVybnMgaXRzIGZpcnN0IGNoaWxkIGlmIGl0IGlzIGEgcGFuZTtcclxuICAvLyBvdGhlcndpc2UgcmV0dXJucyB0aGlzIHBhbmUuXHJcbiAgZmluZExlZnRtb3N0U2libGluZygpIHtcclxuICAgIGlmICh0aGlzLnBhcmVudC5vcmllbnRhdGlvbiA9PT0gJ2hvcml6b250YWwnKSB7XHJcbiAgICAgIGNvbnN0IFtsZWZ0bW9zdFNpYmxpbmddID0gdGhpcy5wYXJlbnQuY2hpbGRyZW47XHJcbiAgICAgIGlmIChsZWZ0bW9zdFNpYmxpbmcgaW5zdGFuY2VvZiBQYW5lQXhpcykge1xyXG4gICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHJldHVybiBsZWZ0bW9zdFNpYmxpbmc7XHJcbiAgICAgIH1cclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgZmluZFJpZ2h0bW9zdFNpYmxpbmcoKSB7XHJcbiAgICBpZiAodGhpcy5wYXJlbnQub3JpZW50YXRpb24gPT09ICdob3Jpem9udGFsJykge1xyXG4gICAgICBjb25zdCByaWdodG1vc3RTaWJsaW5nID0gdGhpcy5wYXJlbnQuY2hpbGRyZW5bdGhpcy5wYXJlbnQuY2hpbGRyZW4ubGVuZ3RoIC0gMV07XHJcbiAgICAgIGlmIChyaWdodG1vc3RTaWJsaW5nIGluc3RhbmNlb2YgUGFuZUF4aXMpIHtcclxuICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICByZXR1cm4gcmlnaHRtb3N0U2libGluZztcclxuICAgICAgfVxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvLyBJZiB0aGUgcGFyZW50IGlzIGEgaG9yaXpvbnRhbCBheGlzLCByZXR1cm5zIGl0cyBsYXN0IGNoaWxkIGlmIGl0IGlzIGEgcGFuZTtcclxuICAvLyBvdGhlcndpc2UgcmV0dXJucyBhIG5ldyBwYW5lIGNyZWF0ZWQgYnkgc3BsaXR0aW5nIHRoaXMgcGFuZSByaWdodHdhcmQuXHJcbiAgZmluZE9yQ3JlYXRlUmlnaHRtb3N0U2libGluZygpIHtcclxuICAgIGNvbnN0IHJpZ2h0bW9zdFNpYmxpbmcgPSB0aGlzLmZpbmRSaWdodG1vc3RTaWJsaW5nKCk7XHJcbiAgICBpZiAocmlnaHRtb3N0U2libGluZyA9PT0gdGhpcykge1xyXG4gICAgICByZXR1cm4gdGhpcy5zcGxpdFJpZ2h0KHt9KTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHJldHVybiByaWdodG1vc3RTaWJsaW5nO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLy8gSWYgdGhlIHBhcmVudCBpcyBhIHZlcnRpY2FsIGF4aXMsIHJldHVybnMgaXRzIGZpcnN0IGNoaWxkIGlmIGl0IGlzIGEgcGFuZTtcclxuICAvLyBvdGhlcndpc2UgcmV0dXJucyB0aGlzIHBhbmUuXHJcbiAgZmluZFRvcG1vc3RTaWJsaW5nKCkge1xyXG4gICAgaWYgKHRoaXMucGFyZW50Lm9yaWVudGF0aW9uID09PSAndmVydGljYWwnKSB7XHJcbiAgICAgIGNvbnN0IFt0b3Btb3N0U2libGluZ10gPSB0aGlzLnBhcmVudC5jaGlsZHJlbjtcclxuICAgICAgaWYgKHRvcG1vc3RTaWJsaW5nIGluc3RhbmNlb2YgUGFuZUF4aXMpIHtcclxuICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICByZXR1cm4gdG9wbW9zdFNpYmxpbmc7XHJcbiAgICAgIH1cclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgZmluZEJvdHRvbW1vc3RTaWJsaW5nKCkge1xyXG4gICAgaWYgKHRoaXMucGFyZW50Lm9yaWVudGF0aW9uID09PSAndmVydGljYWwnKSB7XHJcbiAgICAgIGNvbnN0IGJvdHRvbW1vc3RTaWJsaW5nID0gdGhpcy5wYXJlbnQuY2hpbGRyZW5bdGhpcy5wYXJlbnQuY2hpbGRyZW4ubGVuZ3RoIC0gMV07XHJcbiAgICAgIGlmIChib3R0b21tb3N0U2libGluZyBpbnN0YW5jZW9mIFBhbmVBeGlzKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgcmV0dXJuIGJvdHRvbW1vc3RTaWJsaW5nO1xyXG4gICAgICB9XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICByZXR1cm4gdGhpcztcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8vIElmIHRoZSBwYXJlbnQgaXMgYSB2ZXJ0aWNhbCBheGlzLCByZXR1cm5zIGl0cyBsYXN0IGNoaWxkIGlmIGl0IGlzIGEgcGFuZTtcclxuICAvLyBvdGhlcndpc2UgcmV0dXJucyBhIG5ldyBwYW5lIGNyZWF0ZWQgYnkgc3BsaXR0aW5nIHRoaXMgcGFuZSBib3R0b213YXJkLlxyXG4gIGZpbmRPckNyZWF0ZUJvdHRvbW1vc3RTaWJsaW5nKCkge1xyXG4gICAgY29uc3QgYm90dG9tbW9zdFNpYmxpbmcgPSB0aGlzLmZpbmRCb3R0b21tb3N0U2libGluZygpO1xyXG4gICAgaWYgKGJvdHRvbW1vc3RTaWJsaW5nID09PSB0aGlzKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLnNwbGl0RG93bih7fSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICByZXR1cm4gYm90dG9tbW9zdFNpYmxpbmc7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvLyBQcml2YXRlOiBDbG9zZSB0aGUgcGFuZSB1bmxlc3MgdGhlIHVzZXIgY2FuY2VscyB0aGUgYWN0aW9uIHZpYSBhIGRpYWxvZy5cclxuICAvL1xyXG4gIC8vIFJldHVybnMgYSB7UHJvbWlzZX0gdGhhdCByZXNvbHZlcyBvbmNlIHRoZSBwYW5lIGlzIGVpdGhlciBjbG9zZWQsIG9yIHRoZVxyXG4gIC8vIGNsb3NpbmcgaGFzIGJlZW4gY2FuY2VsbGVkLlxyXG4gIGNsb3NlKCkge1xyXG4gICAgcmV0dXJuIFByb21pc2UuYWxsKHRoaXMuZ2V0SXRlbXMoKS5tYXAoaXRlbSA9PiB0aGlzLnByb21wdFRvU2F2ZUl0ZW0oaXRlbSkpKVxyXG4gICAgICAudGhlbihyZXN1bHRzID0+IHtcclxuICAgICAgICBpZiAoIXJlc3VsdHMuZmluZChpdGVtID0+IGl0ZW0gPT09IGZhbHNlKSkgeyByZXR1cm4gdGhpcy5kZXN0cm95KCk7IH1cclxuICAgICAgfSk7XHJcbiAgfVxyXG5cclxuICBoYW5kbGVTYXZlRXJyb3IoZXJyb3IsIGl0ZW0pIHtcclxuICB9XHJcblxyXG4gIGdldE1lc3NhZ2VGb3JFcnJvckNvZGUoZXJyb3JDb2RlKSB7XHJcbiAgICBzd2l0Y2ggKGVycm9yQ29kZSkge1xyXG4gICAgICBjYXNlICdFQUNDRVMnOiByZXR1cm4gJ1Blcm1pc3Npb24gZGVuaWVkJztcclxuICAgICAgY2FzZSAnRUNPTk5SRVNFVCc6IHJldHVybiAnQ29ubmVjdGlvbiByZXNldCc7XHJcbiAgICAgIGNhc2UgJ0VJTlRSJzogcmV0dXJuICdJbnRlcnJ1cHRlZCBzeXN0ZW0gY2FsbCc7XHJcbiAgICAgIGNhc2UgJ0VJTyc6IHJldHVybiAnSS9PIGVycm9yIHdyaXRpbmcgZmlsZSc7XHJcbiAgICAgIGNhc2UgJ0VOT1NQQyc6IHJldHVybiAnTm8gc3BhY2UgbGVmdCBvbiBkZXZpY2UnO1xyXG4gICAgICBjYXNlICdFTk9UU1VQJzogcmV0dXJuICdPcGVyYXRpb24gbm90IHN1cHBvcnRlZCBvbiBzb2NrZXQnO1xyXG4gICAgICBjYXNlICdFTlhJTyc6IHJldHVybiAnTm8gc3VjaCBkZXZpY2Ugb3IgYWRkcmVzcyc7XHJcbiAgICAgIGNhc2UgJ0VST0ZTJzogcmV0dXJuICdSZWFkLW9ubHkgZmlsZSBzeXN0ZW0nO1xyXG4gICAgICBjYXNlICdFU1BJUEUnOiByZXR1cm4gJ0ludmFsaWQgc2Vlayc7XHJcbiAgICAgIGNhc2UgJ0VUSU1FRE9VVCc6IHJldHVybiAnQ29ubmVjdGlvbiB0aW1lZCBvdXQnO1xyXG4gICAgfVxyXG4gIH1cclxufVxyXG5cclxuZnVuY3Rpb24gcHJvbWlzaWZ5KGNhbGxiYWNrKSB7XHJcbiAgdHJ5IHtcclxuICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoY2FsbGJhY2soKSk7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIHJldHVybiBQcm9taXNlLnJlamVjdChlcnJvcik7XHJcbiAgfVxyXG59XHJcbiJdfQ==