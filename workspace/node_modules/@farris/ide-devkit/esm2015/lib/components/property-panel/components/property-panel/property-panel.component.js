/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, Input, ViewChild, ElementRef, Output, EventEmitter, ViewChildren } from '@angular/core';
import { PropertyItemListComponent } from '../property-item-list/property-item-list.component';
export class PropertyPanelComponent {
    constructor() {
        /**
         * 是否持有面板的隐藏显示状态
         */
        this.isPersitOpenState = false;
        /**
         * isPersitOpenState=true时，控制面板是否隐藏显示
         */
        this.isShowPanel = false;
        /**
         * isPersitOpenState=true时，抛出面板的关闭事件
         */
        this.closePropertyPanel = new EventEmitter();
        /**
         * 属性值
         */
        this.propertyData = {};
        /**
         * 属性变更事件
         */
        this.propertyChanged = new EventEmitter();
        /**
         * 模态框属性变更事件
         */
        this.submitModal = new EventEmitter();
        /**
         * 是否展示关闭按钮
         */
        this.showCloseBtn = true;
        /**
         * 当前展示状态
         */
        this.isOpen = true;
        /**
         * 外层分类，以标签页形式展示
         */
        this.categoryTabs = [];
    }
    /**
     * @return {?}
     */
    ngOnInit() {
        if (this.width) {
            this.eastDiv.nativeElement.style.width = this.width + 'px';
        }
        else {
            this.eastDiv.nativeElement.style.width = 'inherit';
        }
        if (this.height) {
            this.eastDiv.nativeElement.style.height = this.height + 'px';
        }
        else {
            this.eastDiv.nativeElement.style.height = '100%';
        }
        if (this.isPersitOpenState) {
            this.isOpen = this.isShowPanel;
        }
        this.checkShowTabCategory();
    }
    /**
     *  更改面板的隐藏显示状态，只有在isPersitOpenState=true时生效
     * @param {?} simpleChanges
     * @return {?}
     */
    ngOnChanges(simpleChanges) {
        if (simpleChanges.isShowPanel && this.isPersitOpenState) {
            this.isOpen = this.isShowPanel;
        }
        this.checkShowTabCategory();
    }
    /**
     * @return {?}
     */
    refreshPanel() {
        this.checkShowTabCategory();
        this.itemLists.forEach(item => item.refresh());
    }
    /**
     * @param {?} item
     * @return {?}
     */
    changeStatus(item) {
        if (this.propertyConfig.length < 2) {
            return;
        }
        if (!item.status || item.status === 'open') {
            item.status = 'closed';
        }
        else {
            item.status = 'open';
        }
    }
    /**
     *  隐藏面板
     * @return {?}
     */
    collapse() {
        // isPersitOpenState=true时,由外部确定状态
        if (!this.isPersitOpenState) {
            this.isOpen = false;
        }
        this.closePropertyPanel.emit();
    }
    /**
     * 抛出属性变更事件
     * @param {?} changeObject
     * @return {?}
     */
    _valueChanged(changeObject) {
        this.propertyChanged.emit(changeObject);
    }
    /**
     * @param {?} $event
     * @return {?}
     */
    _submitModal($event) {
        this.submitModal.emit($event);
    }
    /**
     * 将属性分类按照标签页进行归类
     * @private
     * @return {?}
     */
    checkShowTabCategory() {
        this.categoryTabs = [];
        if (!this.propertyConfig || this.propertyConfig.length === 0) {
            this.categoryTabs = [{
                    tabId: 'default',
                    tabName: '属性',
                    categoryList: []
                }];
            this.selectedTab = null;
            return;
        }
        this.propertyConfig.forEach(config => {
            if (config.tabId) {
                /** @type {?} */
                const propTab = this.categoryTabs.find(t => t.tabId === config.tabId);
                if (!propTab) {
                    this.categoryTabs.push({
                        tabId: config.tabId,
                        tabName: config.tabName,
                        categoryList: [config],
                        hide: config.hide || config.properties.length === 0
                    });
                }
                else {
                    propTab.categoryList.push(config);
                    if (propTab.hide) {
                        propTab.hide = config.hide || config.properties.length === 0;
                    }
                }
            }
            else {
                /** @type {?} */
                const defaultTab = this.categoryTabs.find(t => t.tabId === 'default');
                if (!defaultTab) {
                    this.categoryTabs.push({
                        tabId: 'default',
                        tabName: '属性',
                        categoryList: [config]
                    });
                }
                else {
                    defaultTab.categoryList.push(config);
                }
            }
        });
        this.selectedTab = this.categoryTabs[0];
    }
}
PropertyPanelComponent.decorators = [
    { type: Component, args: [{
                selector: 'app-property-panel',
                template: "<div #east [style.display]=\"isOpen?'block':'none'\">\r\n    <div class=\"propertyPanel panel d-flex flex-column\">\r\n\r\n\r\n        <div class=\"title d-flex\">\r\n            <div class=\"title-label\" *ngFor=\"let tab of categoryTabs\" (click)=\"selectedTab=tab\" [hidden]=\"tab.hide\"\r\n                [class.active]=\"selectedTab && selectedTab.tabId===tab.tabId && categoryTabs.length>1\">\r\n                <span>{{tab.tabName}}</span>\r\n            </div>\r\n            <div class=\"title-actions\">\r\n                <div class=\"monaco-toolbar\">\r\n                    <div class=\"monaco-action-bar animated\">\r\n                        <ul class=\"actions-container\" role=\"toolbar\">\r\n                            <li class=\"action-item\" (click)=\"collapse()\" *ngIf=\"showCloseBtn\">\r\n                                <a class=\"hide-panel\" title=\"\u5173\u95ED\"></a>\r\n                            </li>\r\n                        </ul>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n\r\n\r\n        <div #propertyPanel class=\"panel-body\" [style.height]=\"(height - 35) + 'px'\" *ngIf=\"selectedTab\">\r\n            <ul class=\"property-grid\">\r\n                <li *ngFor=\"let category of selectedTab.categoryList\">\r\n                    <ng-container *ngIf=\"!category.hide\">\r\n                        <span *ngIf=\"!category.hideTitle\"\r\n                            [class]=\"category.status === 'closed' ? 'group-label collapse': 'group-label expand' \"\r\n                            (click)=\"changeStatus(category)\">{{ category.categoryName }}</span>\r\n                        <div [style.display]=\"!category.status || category.status === 'open'?'block':'none'\"\r\n                            class=\"py-1 \">\r\n                            <webide-property-item-list [category]=\"category\" [propertyData]=\"propertyData\"\r\n                                (valueChanged)=\"_valueChanged($event)\" (submitModal)=\"_submitModal($event)\"\r\n                                (triggerRefreshPanel)=\"refreshPanel()\"></webide-property-item-list>\r\n                        </div>\r\n                    </ng-container>\r\n                </li>\r\n            </ul>\r\n        </div>\r\n    </div>\r\n\r\n</div>",
                styles: [":host{width:inherit;height:inherit}.propertyPanel{width:100%;height:100%;color:rgba(0,0,0,.75);background:#f3f8ff!important;border-color:#d8dbe2!important}.propertyPanel .title{position:relative;background:#d0d8e9!important;padding-right:40px;flex-wrap:wrap}.propertyPanel .title>.title-label{line-height:34px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;padding-left:12px;padding-right:12px;color:#333;font-size:14px;font-weight:600;cursor:pointer}.propertyPanel .title>.title-label.active{background:#8fb1df!important}.propertyPanel .title .title-actions{padding-left:35px;height:35px;flex:1;box-sizing:border-box;position:absolute;right:10px;top:0}.propertyPanel .property-grid .group-label{line-height:30px;display:block;padding-left:12px;cursor:pointer;background:#e2e9f6!important;color:#34495e!important;font-weight:600!important}.propertyPanel .panel-body{overflow:auto;height:100%}.propertyPanel .property-grid{list-style:none;margin:0;padding:0}.propertyPanel .action-item{cursor:pointer;display:inline-block;transition:transform 50ms;transition:transform 50ms,-webkit-transform 50ms;position:relative;padding:0}.propertyPanel .action-item .hide-panel{height:35px;display:block;line-height:35px;min-width:28px;color:rgba(66,66,66,.75);background-color:transparent!important;outline:0!important;background:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='16' height='16' viewBox='0 0 16 16' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M9.784 8L13 11.217 11.215 13 8.001 9.786 4.785 13 3 11.216l3.214-3.215L3 4.785 4.784 3 8 6.216 11.216 3 13 4.785 9.784 8.001z' fill='%23424242'/%3E%3C/svg%3E\") 50% 50% no-repeat}"]
            }] }
];
/** @nocollapse */
PropertyPanelComponent.ctorParameters = () => [];
PropertyPanelComponent.propDecorators = {
    width: [{ type: Input }],
    height: [{ type: Input }],
    isPersitOpenState: [{ type: Input }],
    isShowPanel: [{ type: Input }],
    closePropertyPanel: [{ type: Output }],
    propertyConfig: [{ type: Input }],
    propertyData: [{ type: Input }],
    propertyChanged: [{ type: Output }],
    submitModal: [{ type: Output }],
    showCloseBtn: [{ type: Input }],
    eastDiv: [{ type: ViewChild, args: ['east',] }],
    itemLists: [{ type: ViewChildren, args: [PropertyItemListComponent,] }]
};
if (false) {
    /** @type {?} */
    PropertyPanelComponent.prototype.width;
    /** @type {?} */
    PropertyPanelComponent.prototype.height;
    /**
     * 是否持有面板的隐藏显示状态
     * @type {?}
     */
    PropertyPanelComponent.prototype.isPersitOpenState;
    /**
     * isPersitOpenState=true时，控制面板是否隐藏显示
     * @type {?}
     */
    PropertyPanelComponent.prototype.isShowPanel;
    /**
     * isPersitOpenState=true时，抛出面板的关闭事件
     * @type {?}
     */
    PropertyPanelComponent.prototype.closePropertyPanel;
    /**
     * 属性类型
     * @type {?}
     */
    PropertyPanelComponent.prototype.propertyConfig;
    /**
     * 属性值
     * @type {?}
     */
    PropertyPanelComponent.prototype.propertyData;
    /**
     * 属性变更事件
     * @type {?}
     */
    PropertyPanelComponent.prototype.propertyChanged;
    /**
     * 模态框属性变更事件
     * @type {?}
     */
    PropertyPanelComponent.prototype.submitModal;
    /**
     * 是否展示关闭按钮
     * @type {?}
     */
    PropertyPanelComponent.prototype.showCloseBtn;
    /**
     * @type {?}
     * @private
     */
    PropertyPanelComponent.prototype.eastDiv;
    /** @type {?} */
    PropertyPanelComponent.prototype.itemLists;
    /**
     * 当前展示状态
     * @type {?}
     */
    PropertyPanelComponent.prototype.isOpen;
    /**
     * 外层分类，以标签页形式展示
     * @type {?}
     */
    PropertyPanelComponent.prototype.categoryTabs;
    /**
     * 当前选中的标签页
     * @type {?}
     */
    PropertyPanelComponent.prototype.selectedTab;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicHJvcGVydHktcGFuZWwuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGZhcnJpcy9pZGUtZGV2a2l0LyIsInNvdXJjZXMiOlsibGliL2NvbXBvbmVudHMvcHJvcGVydHktcGFuZWwvY29tcG9uZW50cy9wcm9wZXJ0eS1wYW5lbC9wcm9wZXJ0eS1wYW5lbC5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUFBLE9BQU8sRUFDTCxTQUFTLEVBQVUsS0FBSyxFQUFFLFNBQVMsRUFBRSxVQUFVLEVBQUUsTUFBTSxFQUN2RCxZQUFZLEVBQTRCLFlBQVksRUFDckQsTUFBTSxlQUFlLENBQUM7QUFFdkIsT0FBTyxFQUFFLHlCQUF5QixFQUFFLE1BQU0sb0RBQW9ELENBQUM7QUFPL0YsTUFBTSxPQUFPLHNCQUFzQjtJQXlDakM7Ozs7UUFwQ1Msc0JBQWlCLEdBQUcsS0FBSyxDQUFDOzs7O1FBRzFCLGdCQUFXLEdBQUcsS0FBSyxDQUFDOzs7O1FBR25CLHVCQUFrQixHQUFHLElBQUksWUFBWSxFQUFPLENBQUM7Ozs7UUFNOUMsaUJBQVksR0FBRyxFQUFFLENBQUM7Ozs7UUFHakIsb0JBQWUsR0FBRyxJQUFJLFlBQVksRUFBTyxDQUFDOzs7O1FBRzFDLGdCQUFXLEdBQUcsSUFBSSxZQUFZLEVBQU8sQ0FBQzs7OztRQUd2QyxpQkFBWSxHQUFHLElBQUksQ0FBQzs7OztRQU83QixXQUFNLEdBQUcsSUFBSSxDQUFDOzs7O1FBR2QsaUJBQVksR0FBRyxFQUFFLENBQUM7SUFLRixDQUFDOzs7O0lBRWpCLFFBQVE7UUFFTixJQUFJLElBQUksQ0FBQyxLQUFLLEVBQUU7WUFDZCxJQUFJLENBQUMsT0FBTyxDQUFDLGFBQWEsQ0FBQyxLQUFLLENBQUMsS0FBSyxHQUFHLElBQUksQ0FBQyxLQUFLLEdBQUcsSUFBSSxDQUFDO1NBQzVEO2FBQU07WUFDTCxJQUFJLENBQUMsT0FBTyxDQUFDLGFBQWEsQ0FBQyxLQUFLLENBQUMsS0FBSyxHQUFHLFNB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LEtBQUs7aUNBR0wsTUFBTTs2QkFHTixLQUFLOzJCQUdMLEtBQUs7OEJBR0wsTUFBTTswQkFHTixNQUFNOzJCQUdOLEtBQUs7c0JBR0wsU0FBUyxTQUFDLE1BQU07d0JBQ2hCLFlBQVksU0FBQyx5QkFBeUI7Ozs7SUE3QnZDLHVDQUF1Qjs7SUFDdkIsd0NBQXdCOzs7OztJQUd4QixtREFBbUM7Ozs7O0lBR25DLDZDQUE2Qjs7Ozs7SUFHN0Isb0RBQXVEOzs7OztJQUd2RCxnREFBaUQ7Ozs7O0lBR2pELDhDQUEyQjs7Ozs7SUFHM0IsaURBQW9EOzs7OztJQUdwRCw2Q0FBZ0Q7Ozs7O0lBR2hELDhDQUE2Qjs7Ozs7SUFHN0IseUNBQStDOztJQUMvQywyQ0FBcUY7Ozs7O0lBR3JGLHdDQUFjOzs7OztJQUdkLDhDQUFrQjs7Ozs7SUFHbEIsNkNBQWlCIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcclxuICBDb21wb25lbnQsIE9uSW5pdCwgSW5wdXQsIFZpZXdDaGlsZCwgRWxlbWVudFJlZiwgT3V0cHV0LFxyXG4gIEV2ZW50RW1pdHRlciwgT25DaGFuZ2VzLCBTaW1wbGVDaGFuZ2VzLCBWaWV3Q2hpbGRyZW5cclxufSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgRWxlbWVudFByb3BlcnR5Q29uZmlnLCBQcm9wZXJ0eUNoYW5nZU9iamVjdCB9IGZyb20gJy4uLy4uL2VudGl0eS9wcm9wZXJ0eS1lbnRpdHknO1xyXG5pbXBvcnQgeyBQcm9wZXJ0eUl0ZW1MaXN0Q29tcG9uZW50IH0gZnJvbSAnLi4vcHJvcGVydHktaXRlbS1saXN0L3Byb3BlcnR5LWl0ZW0tbGlzdC5jb21wb25lbnQnO1xyXG5cclxuQENvbXBvbmVudCh7XHJcbiAgc2VsZWN0b3I6ICdhcHAtcHJvcGVydHktcGFuZWwnLFxyXG4gIHRlbXBsYXRlVXJsOiAnLi9wcm9wZXJ0eS1wYW5lbC5jb21wb25lbnQuaHRtbCcsXHJcbiAgc3R5bGVVcmxzOiBbJy4vcHJvcGVydHktcGFuZWwuY29tcG9uZW50LmNzcyddXHJcbn0pXHJcbmV4cG9ydCBjbGFzcyBQcm9wZXJ0eVBhbmVsQ29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0LCBPbkNoYW5nZXMge1xyXG4gIEBJbnB1dCgpIHdpZHRoOiBudW1iZXI7XHJcbiAgQElucHV0KCkgaGVpZ2h0OiBudW1iZXI7XHJcblxyXG4gIC8qKiDmmK/lkKbmjIHmnInpnaLmnb/nmoTpmpDol4/mmL7npLrnirbmgIEgKi9cclxuICBASW5wdXQoKSBpc1BlcnNpdE9wZW5TdGF0ZSA9IGZhbHNlO1xyXG5cclxuICAvKiogaXNQZXJzaXRPcGVuU3RhdGU9dHJ1ZeaXtu+8jOaOp+WItumdouadv+aYr+WQpumakOiXj+aYvuekuiAqL1xyXG4gIEBJbnB1dCgpIGlzU2hvd1BhbmVsID0gZmFsc2U7XHJcblxyXG4gIC8qKiBpc1BlcnNpdE9wZW5TdGF0ZT10cnVl5pe277yM5oqb5Ye66Z2i5p2/55qE5YWz6Zet5LqL5Lu2ICovXHJcbiAgQE91dHB1dCgpIGNsb3NlUHJvcGVydHlQYW5lbCA9IG5ldyBFdmVudEVtaXR0ZXI8YW55PigpO1xyXG5cclxuICAvKiog5bGe5oCn57G75Z6LICovXHJcbiAgQElucHV0KCkgcHJvcGVydHlDb25maWc6IEVsZW1lbnRQcm9wZXJ0eUNvbmZpZ1tdO1xyXG5cclxuICAvKiogIOWxnuaAp+WAvCAqL1xyXG4gIEBJbnB1dCgpIHByb3BlcnR5RGF0YSA9IHt9O1xyXG5cclxuICAvKiog5bGe5oCn5Y+Y5pu05LqL5Lu2ICovXHJcbiAgQE91dHB1dCgpIHByb3BlcnR5Q2hhbmdlZCA9IG5ldyBFdmVudEVtaXR0ZXI8YW55PigpO1xyXG5cclxuICAvKiog5qih5oCB5qGG5bGe5oCn5Y+Y5pu05LqL5Lu2ICAgKi9cclxuICBAT3V0cHV0KCkgc3VibWl0TW9kYWwgPSBuZXcgRXZlbnRFbWl0dGVyPGFueT4oKTtcclxuXHJcbiAgLyoqIOaYr+WQpuWxleekuuWFs+mXreaMiemSriAqL1xyXG4gIEBJbnB1dCgpIHNob3dDbG9zZUJ0biA9IHRydWU7XHJcblxyXG5cclxuICBAVmlld0NoaWxkKCdlYXN0JykgcHJpdmF0ZSBlYXN0RGl2OiBFbGVtZW50UmVmO1xyXG4gIEBWaWV3Q2hpbGRyZW4oUHJvcGVydHlJdGVtTGlzdENvbXBvbmVudCkgaXRlbUxpc3RzOiBBcnJheTxQcm9wZXJ0eUl0ZW1MaXN0Q29tcG9uZW50PjtcclxuXHJcbiAgLyoqIOW9k+WJjeWxleekuueKtuaAgSAqL1xyXG4gIGlzT3BlbiA9IHRydWU7XHJcblxyXG4gIC8qKiDlpJblsYLliIbnsbvvvIzku6XmoIfnrb7pobXlvaLlvI/lsZXnpLogKi9cclxuICBjYXRlZ29yeVRhYnMgPSBbXTtcclxuXHJcbiAgLyoqIOW9k+WJjemAieS4reeahOagh+etvumhtSAqL1xyXG4gIHNlbGVjdGVkVGFiOiBhbnk7XHJcblxyXG4gIGNvbnN0cnVjdG9yKCkgeyB9XHJcblxyXG4gIG5nT25Jbml0KCkge1xyXG5cclxuICAgIGlmICh0aGlzLndpZHRoKSB7XHJcbiAgICAgIHRoaXMuZWFzdERpdi5uYXRpdmVFbGVtZW50LnN0eWxlLndpZHRoID0gdGhpcy53aWR0aCArICdweCc7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLmVhc3REaXYubmF0aXZlRWxlbWVudC5zdHlsZS53aWR0aCA9ICdpbmhlcml0JztcclxuICAgIH1cclxuICAgIGlmICh0aGlzLmhlaWdodCkge1xyXG4gICAgICB0aGlzLmVhc3REaXYubmF0aXZlRWxlbWVudC5zdHlsZS5oZWlnaHQgPSB0aGlzLmhlaWdodCArICdweCc7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLmVhc3REaXYubmF0aXZlRWxlbWVudC5zdHlsZS5oZWlnaHQgPSAnMTAwJSc7XHJcbiAgICB9XHJcblxyXG5cclxuICAgIGlmICh0aGlzLmlzUGVyc2l0T3BlblN0YXRlKSB7XHJcbiAgICAgIHRoaXMuaXNPcGVuID0gdGhpcy5pc1Nob3dQYW5lbDtcclxuICAgIH1cclxuXHJcbiAgICB0aGlzLmNoZWNrU2hvd1RhYkNhdGVnb3J5KCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiAg5pu05pS56Z2i5p2/55qE6ZqQ6JeP5pi+56S654q25oCB77yM5Y+q5pyJ5ZyoaXNQZXJzaXRPcGVuU3RhdGU9dHJ1ZeaXtueUn+aViFxyXG4gICAqL1xyXG4gIG5nT25DaGFuZ2VzKHNpbXBsZUNoYW5nZXM6IFNpbXBsZUNoYW5nZXMpIHtcclxuICAgIGlmIChzaW1wbGVDaGFuZ2VzLmlzU2hvd1BhbmVsICYmIHRoaXMuaXNQZXJzaXRPcGVuU3RhdGUpIHtcclxuICAgICAgdGhpcy5pc09wZW4gPSB0aGlzLmlzU2hvd1BhbmVsO1xyXG4gICAgfVxyXG4gICAgdGhpcy5jaGVja1Nob3dUYWJDYXRlZ29yeSgpO1xyXG4gIH1cclxuICByZWZyZXNoUGFuZWwoKSB7XHJcbiAgICB0aGlzLmNoZWNrU2hvd1RhYkNhdGVnb3J5KCk7XHJcbiAgICB0aGlzLml0ZW1MaXN0cy5mb3JFYWNoKGl0ZW0gPT4gaXRlbS5yZWZyZXNoKCkpO1xyXG4gIH1cclxuICBjaGFuZ2VTdGF0dXMoaXRlbTogYW55KSB7XHJcbiAgICBpZiAodGhpcy5wcm9wZXJ0eUNvbmZpZy5sZW5ndGggPCAyKSB7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIGlmICghaXRlbS5zdGF0dXMgfHwgaXRlbS5zdGF0dXMgPT09ICdvcGVuJykge1xyXG4gICAgICBpdGVtLnN0YXR1cyA9ICdjbG9zZWQnO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgaXRlbS5zdGF0dXMgPSAnb3Blbic7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiAg6ZqQ6JeP6Z2i5p2/XHJcbiAgICovXHJcbiAgY29sbGFwc2UoKSB7XHJcbiAgICAvLyBpc1BlcnNpdE9wZW5TdGF0ZT10cnVl5pe2LOeUseWklumDqOehruWumueKtuaAgVxyXG4gICAgaWYgKCF0aGlzLmlzUGVyc2l0T3BlblN0YXRlKSB7XHJcbiAgICAgIHRoaXMuaXNPcGVuID0gZmFsc2U7XHJcbiAgICB9XHJcbiAgICB0aGlzLmNsb3NlUHJvcGVydHlQYW5lbC5lbWl0KCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDmipvlh7rlsZ7mgKflj5jmm7Tkuovku7ZcclxuICAgKi9cclxuICBfdmFsdWVDaGFuZ2VkKGNoYW5nZU9iamVjdDogUHJvcGVydHlDaGFuZ2VPYmplY3QpIHtcclxuICAgIHRoaXMucHJvcGVydHlDaGFuZ2VkLmVtaXQoY2hhbmdlT2JqZWN0KTtcclxuICB9XHJcbiAgX3N1Ym1pdE1vZGFsKCRldmVudDogUHJvcGVydHlDaGFuZ2VPYmplY3QpIHtcclxuICAgIHRoaXMuc3VibWl0TW9kYWwuZW1pdCgkZXZlbnQpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog5bCG5bGe5oCn5YiG57G75oyJ54Wn5qCH562+6aG16L+b6KGM5b2S57G7XHJcbiAgICovXHJcbiAgcHJpdmF0ZSBjaGVja1Nob3dUYWJDYXRlZ29yeSgpIHtcclxuICAgIHRoaXMuY2F0ZWdvcnlUYWJzID0gW107XHJcbiAgICBpZiAoIXRoaXMucHJvcGVydHlDb25maWcgfHwgdGhpcy5wcm9wZXJ0eUNvbmZpZy5sZW5ndGggPT09IDApIHtcclxuICAgICAgdGhpcy5jYXRlZ29yeVRhYnMgPSBbe1xyXG4gICAgICAgIHRhYklkOiAnZGVmYXVsdCcsXHJcbiAgICAgICAgdGFiTmFtZTogJ+WxnuaApycsXHJcbiAgICAgICAgY2F0ZWdvcnlMaXN0OiBbXVxyXG4gICAgICB9XTtcclxuICAgICAgdGhpcy5zZWxlY3RlZFRhYiA9IG51bGw7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIHRoaXMucHJvcGVydHlDb25maWcuZm9yRWFjaChjb25maWcgPT4ge1xyXG4gICAgICBpZiAoY29uZmlnLnRhYklkKSB7XHJcbiAgICAgICAgY29uc3QgcHJvcFRhYiA9IHRoaXMuY2F0ZWdvcnlUYWJzLmZpbmQodCA9PiB0LnRhYklkID09PSBjb25maWcudGFiSWQpO1xyXG4gICAgICAgIGlmICghcHJvcFRhYikge1xyXG4gICAgICAgICAgdGhpcy5jYXRlZ29yeVRhYnMucHVzaCh7XHJcbiAgICAgICAgICAgIHRhYklkOiBjb25maWcudGFiSWQsXHJcbiAgICAgICAgICAgIHRhYk5hbWU6IGNvbmZpZy50YWJOYW1lLFxyXG4gICAgICAgICAgICBjYXRlZ29yeUxpc3Q6IFtjb25maWddLFxyXG4gICAgICAgICAgICBoaWRlOiBjb25maWcuaGlkZSB8fCBjb25maWcucHJvcGVydGllcy5sZW5ndGggPT09IDBcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcblxyXG4gICAgICAgICAgcHJvcFRhYi5jYXRlZ29yeUxpc3QucHVzaChjb25maWcpO1xyXG4gICAgICAgICAgaWYgKHByb3BUYWIuaGlkZSkge1xyXG4gICAgICAgICAgICBwcm9wVGFiLmhpZGUgPSBjb25maWcuaGlkZSB8fCBjb25maWcucHJvcGVydGllcy5sZW5ndGggPT09IDA7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGNvbnN0IGRlZmF1bHRUYWIgPSB0aGlzLmNhdGVnb3J5VGFicy5maW5kKHQgPT4gdC50YWJJZCA9PT0gJ2RlZmF1bHQnKTtcclxuICAgICAgICBpZiAoIWRlZmF1bHRUYWIpIHtcclxuICAgICAgICAgIHRoaXMuY2F0ZWdvcnlUYWJzLnB1c2goe1xyXG4gICAgICAgICAgICB0YWJJZDogJ2RlZmF1bHQnLFxyXG4gICAgICAgICAgICB0YWJOYW1lOiAn5bGe5oCnJyxcclxuICAgICAgICAgICAgY2F0ZWdvcnlMaXN0OiBbY29uZmlnXVxyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIGRlZmF1bHRUYWIuY2F0ZWdvcnlMaXN0LnB1c2goY29uZmlnKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICB0aGlzLnNlbGVjdGVkVGFiID0gdGhpcy5jYXRlZ29yeVRhYnNbMF07XHJcblxyXG5cclxuICB9XHJcbn1cclxuIl19