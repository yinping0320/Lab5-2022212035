/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { PaneContainer } from './pane-container';
import { Emitter } from './event-kit';
/** @enum {number} */
const DockStyle = {
    none: 0,
    left: 1,
    right: 2,
    top: 3,
    bottom: 4,
};
export { DockStyle };
DockStyle[DockStyle.none] = 'none';
DockStyle[DockStyle.left] = 'left';
DockStyle[DockStyle.right] = 'right';
DockStyle[DockStyle.top] = 'top';
DockStyle[DockStyle.bottom] = 'bottom';
export class Dock {
    /**
     * @param {?} params
     */
    constructor(params) {
        this.handleResizeHandleDragStart = this.handleResizeHandleDragStart.bind(this);
        this.handleResizeToFit = this.handleResizeToFit.bind(this);
        this.handleMouseMove = this.handleMouseMove.bind(this);
        this.handleMouseUp = this.handleMouseUp.bind(this);
        this.location = params.location;
        this.widthOrHeight = getWidthOrHeight(this.location);
        this.viewRegistry = params.viewRegistry;
        this.didActivate = params.didActivate;
        this.emitter = new Emitter();
        this.paneContainer = new PaneContainer({
            location: this.location,
            viewRegistry: this.viewRegistry
        });
        this.state = {
            size: null,
            visible: false,
            shouldAnimate: false
        };
    }
    // This method is called explicitly by the object which adds the Dock to the document.
    /**
     * @return {?}
     */
    elementAttached() {
        // Re-render when the dock is attached to make sure we remeasure sizes defined in CSS.
        this.render(this.state);
    }
    /**
     * @return {?}
     */
    getElement() {
    }
    /**
     * @return {?}
     */
    getLocation() {
        return this.location;
    }
    /**
     * @return {?}
     */
    destroy() {
        this.paneContainer.destroy();
        // window.removeEventListener('mousemove', this.handleMouseMove);
        // window.removeEventListener('mouseup', this.handleMouseUp);
        // window.removeEventListener('drag', this.handleDrag);
        // window.removeEventListener('dragend', this.handleDragEnd);
    }
    /**
     * @param {?} hovered
     * @return {?}
     */
    setHovered(hovered) {
        if (hovered === this.state.hovered) {
            return;
        }
        this.setState({ hovered });
    }
    /**
     * @param {?} draggingItem
     * @return {?}
     */
    setDraggingItem(draggingItem) {
        if (draggingItem === this.state.draggingItem) {
            return;
        }
        this.setState({ draggingItem });
    }
    // Extended: Show the dock and focus its active {Pane}.
    /**
     * @return {?}
     */
    activate() {
        this.getActivePane().activate();
    }
    // Extended: Show the dock without focusing it.
    /**
     * @return {?}
     */
    show() {
        this.setState({ visible: true });
    }
    // Extended: Hide the dock and activate the {WorkspaceCenter} if the dock was
    // was previously focused.
    /**
     * @return {?}
     */
    hide() {
        this.setState({ visible: false });
    }
    // Extended: Toggle the dock's visibility without changing the {Workspace}'s
    // active pane container.
    /**
     * @return {?}
     */
    toggle() {
        // const state = { visible: !this.state.visible };
        // if (!state.visible) { state.hovered = false; }
        // this.setState(state);
    }
    // Extended: Check if the dock is visible.
    //
    // Returns a {Boolean}.
    /**
     * @return {?}
     */
    isVisible() {
        return this.state.visible;
    }
    /**
     * @param {?} newState
     * @return {?}
     */
    setState(newState) {
        /** @type {?} */
        const prevState = this.state;
        /** @type {?} */
        const nextState = Object.assign({}, prevState, newState);
        // Update the `shouldAnimate` state. This needs to be written to the DOM before updating the
        // class that changes the animated property. Normally we'd have to defer the class change a
        // frame to ensure the property is animated (or not) appropriately, however we luck out in this
        // case because the drag start always happens before the item is dragged into the toggle button.
        if (nextState.visible !== prevState.visible) {
            // Never animate toggling visibility...
            nextState.shouldAnimate = false;
        }
        else if (!nextState.visible && nextState.draggingItem && !prevState.draggingItem) {
            // ...but do animate if you start dragging while the panel is hidden.
            nextState.shouldAnimate = true;
        }
        this.state = nextState;
        this.render(this.state);
        const { visible } = this.state;
        // if (visible !== prevState.visible) {
        //   this.emitter.emit('did-change-visible', visible);
        // }
    }
    /**
     * @param {?} state
     * @return {?}
     */
    render(state) {
    }
    /**
     * @return {?}
     */
    handleDidAddPaneItem() {
        if (this.state.size == null) {
            this.setState({ size: this.getInitialSize() });
        }
    }
    /**
     * @return {?}
     */
    handleDidRemovePaneItem() {
        // Hide the dock if you remove the last item.
        if (this.paneContainer.getPaneItems().length === 0) {
            this.setState({ visible: false, hovered: false, size: null });
        }
    }
    /**
     * @return {?}
     */
    handleResizeHandleDragStart() {
        window.addEventListener('mousemove', this.handleMouseMove);
        window.addEventListener('mouseup', this.handleMouseUp);
        this.setState({ resizing: true });
    }
    /**
     * @return {?}
     */
    handleResizeToFit() {
        /** @type {?} */
        const item = this.getActivePaneItem();
        if (item) {
            /** @type {?} */
            const size = getPreferredSize(item, this.getLocation());
            if (size != null) {
                this.setState({ size });
            }
        }
    }
    /**
     * @param {?} event
     * @return {?}
     */
    handleMouseMove(event) {
        if (event.buttons === 0) { // We missed the mouseup event. For some reason it happens on Windows
            this.handleMouseUp(event);
            return;
        }
        /** @type {?} */
        const size = 0;
        // switch (this.location) {
        //   case 'left':
        //     size = event.pageX - this.element.getBoundingClientRect().left;
        //     break;
        //   case 'bottom':
        //     size = this.element.getBoundingClientRect().bottom - event.pageY;
        //     break;
        //   case 'right':
        //     size = this.element.getBoundingClientRect().right - event.pageX;
        //     break;
        // }
        this.setState({ size });
    }
    /**
     * @param {?} event
     * @return {?}
     */
    handleMouseUp(event) {
        window.removeEventListener('mousemove', this.handleMouseMove);
        window.removeEventListener('mouseup', this.handleMouseUp);
        this.setState({ resizing: false });
    }
    // Determine whether the cursor is within the dock hover area. This isn't as simple as just using
    // mouseenter/leave because we want to be a little more forgiving. For example, if the cursor is
    // over the footer, we want to show the bottom dock's toggle button. Also note that our criteria
    // for detecting entry are different than detecting exit but, in order for us to avoid jitter, the
    // area considered when detecting exit MUST fully encompass the area considered when detecting
    // entry.
    /**
     * @param {?} point
     * @param {?} detectingExit
     * @return {?}
     */
    pointWithinHoverArea(point, detectingExit) {
    }
    /**
     * @return {?}
     */
    getInitialSize() {
        // The item may not have been activated yet. If that's the case, just use the first item.
        /** @type {?} */
        const activePaneItem = this.paneContainer.getActivePaneItem() || this.paneContainer.getPaneItems()[0];
        // If there are items, we should have an explicit width; if not, we shouldn't.
        return activePaneItem
            ? getPreferredSize(activePaneItem, this.location)
            : null;
    }
    /**
     * @return {?}
     */
    serialize() {
        return {
            deserializer: 'Dock',
            size: this.state.size,
            paneContainer: this.paneContainer.serialize({}),
            visible: this.state.visible
        };
    }
    /**
     * @param {?} serialized
     * @param {?} deserializerManager
     * @return {?}
     */
    deserialize(serialized, deserializerManager) {
        this.paneContainer.deserialize(serialized.paneContainer, deserializerManager);
        this.setState({
            size: serialized.size || this.getInitialSize(),
            // If no items could be deserialized, we don't want to show the dock (even if it was visible last time)
            visible: serialized.visible && (this.paneContainer.getPaneItems().length > 0)
        });
    }
    /*
      Section: Event Subscription
      */
    // Essential: Invoke the given callback when the visibility of the dock changes.
    //
    // * `callback` {Function} to be called when the visibility changes.
    //   * `visible` {Boolean} Is the dock now visible?
    //
    // Returns a {Disposable} on which `.dispose()` can be called to unsubscribe.
    /**
     * @param {?} callback
     * @return {?}
     */
    onDidChangeVisible(callback) {
    }
    // Essential: Invoke the given callback with the current and all future visibilities of the dock.
    //
    // * `callback` {Function} to be called when the visibility changes.
    //   * `visible` {Boolean} Is the dock now visible?
    //
    // Returns a {Disposable} on which `.dispose()` can be called to unsubscribe.
    /**
     * @param {?} callback
     * @return {?}
     */
    observeVisible(callback) {
        callback(this.isVisible());
        return this.onDidChangeVisible(callback);
    }
    // Essential: Invoke the given callback with all current and future panes items
    // in the dock.
    //
    // * `callback` {Function} to be called with current and future pane items.
    //   * `item` An item that is present in {::getPaneItems} at the time of
    //      subscription or that is added at some later time.
    //
    // Returns a {Disposable} on which `.dispose()` can be called to unsubscribe.
    /**
     * @param {?} callback
     * @return {?}
     */
    observePaneItems(callback) {
        return this.paneContainer.observePaneItems(callback);
    }
    // Essential: Invoke the given callback when the active pane item changes.
    //
    // Because observers are invoked synchronously, it's important not to perform
    // any expensive operations via this method. Consider
    // {::onDidStopChangingActivePaneItem} to delay operations until after changes
    // stop occurring.
    //
    // * `callback` {Function} to be called when the active pane item changes.
    //   * `item` The active pane item.
    //
    // Returns a {Disposable} on which `.dispose()` can be called to unsubscribe.
    /**
     * @param {?} callback
     * @return {?}
     */
    onDidChangeActivePaneItem(callback) {
        return this.paneContainer.onDidChangeActivePaneItem(callback);
    }
    // Essential: Invoke the given callback when the active pane item stops
    // changing.
    //
    // Observers are called asynchronously 100ms after the last active pane item
    // change. Handling changes here rather than in the synchronous
    // {::onDidChangeActivePaneItem} prevents unneeded work if the user is quickly
    // changing or closing tabs and ensures critical UI feedback, like changing the
    // highlighted tab, gets priority over work that can be done asynchronously.
    //
    // * `callback` {Function} to be called when the active pane item stopts
    //   changing.
    //   * `item` The active pane item.
    //
    // Returns a {Disposable} on which `.dispose()` can be called to unsubscribe.
    /**
     * @param {?} callback
     * @return {?}
     */
    onDidStopChangingActivePaneItem(callback) {
        return this.paneContainer.onDidStopChangingActivePaneItem(callback);
    }
    // Essential: Invoke the given callback with the current active pane item and
    // with all future active pane items in the dock.
    //
    // * `callback` {Function} to be called when the active pane item changes.
    //   * `item` The current active pane item.
    //
    // Returns a {Disposable} on which `.dispose()` can be called to unsubscribe.
    /**
     * @param {?} callback
     * @return {?}
     */
    observeActivePaneItem(callback) {
        return this.paneContainer.observeActivePaneItem(callback);
    }
    // Extended: Invoke the given callback when a pane is added to the dock.
    //
    // * `callback` {Function} to be called panes are added.
    //   * `event` {Object} with the following keys:
    //     * `pane` The added pane.
    //
    // Returns a {Disposable} on which `.dispose()` can be called to unsubscribe.
    /**
     * @param {?} callback
     * @return {?}
     */
    onDidAddPane(callback) {
        return this.paneContainer.onDidAddPane(callback);
    }
    // Extended: Invoke the given callback before a pane is destroyed in the
    // dock.
    //
    // * `callback` {Function} to be called before panes are destroyed.
    //   * `event` {Object} with the following keys:
    //     * `pane` The pane to be destroyed.
    //
    // Returns a {Disposable} on which `.dispose()` can be called to unsubscribe.
    /**
     * @param {?} callback
     * @return {?}
     */
    onWillDestroyPane(callback) {
        return this.paneContainer.onWillDestroyPane(callback);
    }
    // Extended: Invoke the given callback when a pane is destroyed in the dock.
    //
    // * `callback` {Function} to be called panes are destroyed.
    //   * `event` {Object} with the following keys:
    //     * `pane` The destroyed pane.
    //
    // Returns a {Disposable} on which `.dispose()` can be called to unsubscribe.
    /**
     * @param {?} callback
     * @return {?}
     */
    onDidDestroyPane(callback) {
        return this.paneContainer.onDidDestroyPane(callback);
    }
    // Extended: Invoke the given callback with all current and future panes in the
    // dock.
    //
    // * `callback` {Function} to be called with current and future panes.
    //   * `pane` A {Pane} that is present in {::getPanes} at the time of
    //      subscription or that is added at some later time.
    //
    // Returns a {Disposable} on which `.dispose()` can be called to unsubscribe.
    /**
     * @param {?} callback
     * @return {?}
     */
    observePanes(callback) {
        return this.paneContainer.observePanes(callback);
    }
    // Extended: Invoke the given callback when the active pane changes.
    //
    // * `callback` {Function} to be called when the active pane changes.
    //   * `pane` A {Pane} that is the current return value of {::getActivePane}.
    //
    // Returns a {Disposable} on which `.dispose()` can be called to unsubscribe.
    /**
     * @param {?} callback
     * @return {?}
     */
    onDidChangeActivePane(callback) {
        return this.paneContainer.onDidChangeActivePane(callback);
    }
    // Extended: Invoke the given callback with the current active pane and when
    // the active pane changes.
    //
    // * `callback` {Function} to be called with the current and future active#
    //   panes.
    //   * `pane` A {Pane} that is the current return value of {::getActivePane}.
    //
    // Returns a {Disposable} on which `.dispose()` can be called to unsubscribe.
    /**
     * @param {?} callback
     * @return {?}
     */
    observeActivePane(callback) {
        return this.paneContainer.observeActivePane(callback);
    }
    // Extended: Invoke the given callback when a pane item is added to the dock.
    //
    // * `callback` {Function} to be called when pane items are added.
    //   * `event` {Object} with the following keys:
    //     * `item` The added pane item.
    //     * `pane` {Pane} containing the added item.
    //     * `index` {Number} indicating the index of the added item in its pane.
    //
    // Returns a {Disposable} on which `.dispose()` can be called to unsubscribe.
    /**
     * @param {?} callback
     * @return {?}
     */
    onDidAddPaneItem(callback) {
        return this.paneContainer.onDidAddPaneItem(callback);
    }
    // Extended: Invoke the given callback when a pane item is about to be
    // destroyed, before the user is prompted to save it.
    //
    // * `callback` {Function} to be called before pane items are destroyed.
    //   * `event` {Object} with the following keys:
    //     * `item` The item to be destroyed.
    //     * `pane` {Pane} containing the item to be destroyed.
    //     * `index` {Number} indicating the index of the item to be destroyed in
    //       its pane.
    //
    // Returns a {Disposable} on which `.dispose` can be called to unsubscribe.
    /**
     * @param {?} callback
     * @return {?}
     */
    onWillDestroyPaneItem(callback) {
        return this.paneContainer.onWillDestroyPaneItem(callback);
    }
    // Extended: Invoke the given callback when a pane item is destroyed.
    //
    // * `callback` {Function} to be called when pane items are destroyed.
    //   * `event` {Object} with the following keys:
    //     * `item` The destroyed item.
    //     * `pane` {Pane} containing the destroyed item.
    //     * `index` {Number} indicating the index of the destroyed item in its
    //       pane.
    //
    // Returns a {Disposable} on which `.dispose` can be called to unsubscribe.
    /**
     * @param {?} callback
     * @return {?}
     */
    onDidDestroyPaneItem(callback) {
        return this.paneContainer.onDidDestroyPaneItem(callback);
    }
    // Extended: Invoke the given callback when the hovered state of the dock changes.
    //
    // * `callback` {Function} to be called when the hovered state changes.
    //   * `hovered` {Boolean} Is the dock now hovered?
    //
    // Returns a {Disposable} on which `.dispose()` can be called to unsubscribe.
    /**
     * @param {?} callback
     * @return {?}
     */
    onDidChangeHovered(callback) {
        return this.emitter.on('did-change-hovered', callback);
    }
    /*
      Section: Pane Items
      */
    // Essential: Get all pane items in the dock.
    //
    // Returns an {Array} of items.
    /**
     * @return {?}
     */
    getPaneItems() {
        return this.paneContainer.getPaneItems();
    }
    // Essential: Get the active {Pane}'s active item.
    //
    // Returns an pane item {Object}.
    /**
     * @return {?}
     */
    getActivePaneItem() {
        return this.paneContainer.getActivePaneItem();
    }
    // Save all pane items.
    /**
     * @return {?}
     */
    saveAll() {
        this.paneContainer.saveAll();
    }
    /**
     * @param {?} options
     * @return {?}
     */
    confirmClose(options) {
        return this.paneContainer.confirmClose(options);
    }
    /*
      Section: Panes
      */
    // Extended: Get all panes in the dock.
    //
    // Returns an {Array} of {Pane}s.
    /**
     * @return {?}
     */
    getPanes() {
        return this.paneContainer.getPanes();
    }
    // Extended: Get the active {Pane}.
    //
    // Returns a {Pane}.
    /**
     * @return {?}
     */
    getActivePane() {
        return this.paneContainer.getActivePane();
    }
    // Extended: Make the next pane active.
    /**
     * @return {?}
     */
    activateNextPane() {
        return this.paneContainer.activateNextPane();
    }
    // Extended: Make the previous pane active.
    /**
     * @return {?}
     */
    activatePreviousPane() {
        return this.paneContainer.activatePreviousPane();
    }
    /**
     * @param {?} uri
     * @return {?}
     */
    paneForURI(uri) {
        return this.paneContainer.paneForURI(uri);
    }
    /**
     * @param {?} item
     * @return {?}
     */
    paneForItem(item) {
        return this.paneContainer.paneForItem(item);
    }
    // Destroy (close) the active pane.
    /**
     * @return {?}
     */
    destroyActivePane() {
        /** @type {?} */
        const activePane = this.getActivePane();
        if (activePane != null) {
            activePane.destroy();
        }
    }
}
if (false) {
    /**
     * @type {?}
     * @private
     */
    Dock.prototype.location;
    /**
     * @type {?}
     * @private
     */
    Dock.prototype.widthOrHeight;
    /**
     * @type {?}
     * @private
     */
    Dock.prototype.viewRegistry;
    /**
     * @type {?}
     * @private
     */
    Dock.prototype.didActivate;
    /**
     * @type {?}
     * @private
     */
    Dock.prototype.paneContainer;
    /**
     * @type {?}
     * @private
     */
    Dock.prototype.state;
    /**
     * @type {?}
     * @private
     */
    Dock.prototype.emitter;
}
/**
 * @param {?} location
 * @return {?}
 */
function getWidthOrHeight(location) {
    return location === 'left' || location === 'right' ? 'width' : 'height';
}
/**
 * @param {?} item
 * @param {?} location
 * @return {?}
 */
function getPreferredSize(item, location) {
    switch (location) {
        case 'left':
        case 'right':
            return typeof item.getPreferredWidth === 'function'
                ? item.getPreferredWidth()
                : null;
        default:
            return typeof item.getPreferredHeight === 'function'
                ? item.getPreferredHeight()
                : null;
    }
}
/**
 * @param {?} location
 * @param {?} visible
 * @return {?}
 */
function getIconName(location, visible) {
    switch (location) {
        case 'right': return visible ? 'icon-chevron-right' : 'icon-chevron-left';
        case 'bottom': return visible ? 'icon-chevron-down' : 'icon-chevron-up';
        case 'left': return visible ? 'icon-chevron-left' : 'icon-chevron-right';
        default: throw new Error(`Invalid location: ${location}`);
    }
}
/**
 * @param {?} rect
 * @param {?} point
 * @return {?}
 */
function rectContainsPoint(rect, point) {
    return (point.x >= rect.left &&
        point.y >= rect.top &&
        point.x <= rect.right &&
        point.y <= rect.bottom);
}
// Is the item allowed in the given location?
/**
 * @param {?} item
 * @param {?} location
 * @return {?}
 */
function isItemAllowed(item, location) {
    if (typeof item.getAllowedLocations !== 'function') {
        return true;
    }
    return item.getAllowedLocations().includes(location);
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZG9jay5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BmYXJyaXMvaWRlLWRldmtpdC8iLCJzb3VyY2VzIjpbImxpYi9pZGVmcmFtZXdvcmsvZ3NwL2RvY2sudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUFBLE9BQU8sRUFBRSxhQUFhLEVBQUUsTUFBTSxrQkFBa0IsQ0FBQztBQUdqRCxPQUFPLEVBQUUsT0FBTyxFQUFjLE1BQU0sYUFBYSxDQUFDOzs7SUFHaEQsT0FBSTtJQUNKLE9BQUk7SUFDSixRQUFLO0lBQ0wsTUFBRztJQUNILFNBQU07Ozs7Ozs7O0FBR1IsTUFBTSxPQUFPLElBQUk7Ozs7SUFVZixZQUFZLE1BQU07UUFDaEIsSUFBSSxDQUFDLDJCQUEyQixHQUFHLElBQUksQ0FBQywyQkFBMkIsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDL0UsSUFBSSxDQUFDLGlCQUFpQixHQUFHLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDM0QsSUFBSSxDQUFDLGVBQWUsR0FBRyxJQUFJLENBQUMsZUFBZSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUN2RCxJQUFJLENBQUMsYUFBYSxHQUFHLElBQUksQ0FBQyxhQUFhLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO1FBRW5ELElBQUksQ0FBQyxRQUFRLEdBQUcsTUFBTSxDQUFDLFFBQVEsQ0FBQztRQUNoQyxJQUFJLENBQUMsYUFBYSxHQUFHLGdCQUFnQixDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsQ0FBQztRQUNyRCxJQUFJLENBQUMsWUFBWSxHQUFHLE1BQU0sQ0FBQyxZQUFZLENBQUM7UUFDeEMsSUFBSSxDQUFDLFdBQVcsR0FBRyxNQUFNLENBQUMsV0FBVyxDQUFDO1FBRXRDLElBQUksQ0FBQyxPQUFPLEdBQUcsSUFBSSxPQUFPLEVBQUUsQ0FBQztRQUU3QixJQUFJLENBQUMsYUFBYSxHQUFHLElBQUksYUFBYSxDQUFD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TyxDQUFDLENBQUMsQ0FBQyxvQkFBb0IsQ0FBQyxDQUFDLENBQUMsbUJBQW1CLENBQUM7UUFDMUUsS0FBSyxRQUFRLENBQUMsQ0FBQyxPQUFPLE9BQU8sQ0FBQyxDQUFDLENBQUMsbUJBQW1CLENBQUMsQ0FBQyxDQUFDLGlCQUFpQixDQUFDO1FBQ3hFLEtBQUssTUFBTSxDQUFDLENBQUMsT0FBTyxPQUFPLENBQUMsQ0FBQyxDQUFDLG1CQUFtQixDQUFDLENBQUMsQ0FBQyxvQkFBb0IsQ0FBQztRQUN6RSxPQUFPLENBQUMsQ0FBQyxNQUFNLElBQUksS0FBSyxDQUFDLHFCQUFxQixRQUFRLEVBQUUsQ0FBQyxDQUFDO0tBQzNEO0FBQ0gsQ0FBQzs7Ozs7O0FBRUQsU0FBUyxpQkFBaUIsQ0FBQyxJQUFJLEVBQUUsS0FBSztJQUNwQyxPQUFPLENBQ0wsS0FBSyxDQUFDLENBQUMsSUFBSSxJQUFJLENBQUMsSUFBSTtRQUNwQixLQUFLLENBQUMsQ0FBQyxJQUFJLElBQUksQ0FBQyxHQUFHO1FBQ25CLEtBQUssQ0FBQyxDQUFDLElBQUksSUFBSSxDQUFDLEtBQUs7UUFDckIsS0FBSyxDQUFDLENBQUMsSUFBSSxJQUFJLENBQUMsTUFBTSxDQUN2QixDQUFDO0FBQ0osQ0FBQzs7Ozs7OztBQUdELFNBQVMsYUFBYSxDQUFDLElBQUksRUFBRSxRQUFRO0lBQ25DLElBQUksT0FBTyxJQUFJLENBQUMsbUJBQW1CLEtBQUssVUFBVSxFQUFFO1FBQ2xELE9BQU8sSUFBSSxDQUFDO0tBQ2I7SUFDRCxPQUFPLElBQUksQ0FBQyxtQkFBbUIsRUFBRSxDQUFDLFFBQVEsQ0FBQyxRQUFRLENBQUMsQ0FBQztBQUN2RCxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUGFuZUNvbnRhaW5lciB9IGZyb20gJy4vcGFuZS1jb250YWluZXInO1xyXG5pbXBvcnQgeyBQYW5lIH0gZnJvbSAnLi9wYW5lJztcclxuaW1wb3J0IHsgVmlld1JlZ2lzdHJ5IH0gZnJvbSAnLi92aWV3LXJlZ2lzdHJ5JztcclxuaW1wb3J0IHsgRW1pdHRlciwgRGlzcG9zYWJsZSB9IGZyb20gJy4vZXZlbnQta2l0JztcclxuXHJcbmV4cG9ydCBlbnVtIERvY2tTdHlsZSB7XHJcbiAgbm9uZSxcclxuICBsZWZ0LFxyXG4gIHJpZ2h0LFxyXG4gIHRvcCxcclxuICBib3R0b21cclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIERvY2sge1xyXG4gIHByaXZhdGUgbG9jYXRpb246IGFueTtcclxuICBwcml2YXRlIHdpZHRoT3JIZWlnaHQ6IGFueTtcclxuICBwcml2YXRlIHZpZXdSZWdpc3RyeTogVmlld1JlZ2lzdHJ5O1xyXG4gIHByaXZhdGUgZGlkQWN0aXZhdGU6IGJvb2xlYW47XHJcbiAgcHJpdmF0ZSBwYW5lQ29udGFpbmVyOiBQYW5lQ29udGFpbmVyO1xyXG4gIHByaXZhdGUgc3RhdGU6IGFueTtcclxuICBwcml2YXRlIGVtaXR0ZXI6IEVtaXR0ZXI7XHJcblxyXG5cclxuICBjb25zdHJ1Y3RvcihwYXJhbXMpIHtcclxuICAgIHRoaXMuaGFuZGxlUmVzaXplSGFuZGxlRHJhZ1N0YXJ0ID0gdGhpcy5oYW5kbGVSZXNpemVIYW5kbGVEcmFnU3RhcnQuYmluZCh0aGlzKTtcclxuICAgIHRoaXMuaGFuZGxlUmVzaXplVG9GaXQgPSB0aGlzLmhhbmRsZVJlc2l6ZVRvRml0LmJpbmQodGhpcyk7XHJcbiAgICB0aGlzLmhhbmRsZU1vdXNlTW92ZSA9IHRoaXMuaGFuZGxlTW91c2VNb3ZlLmJpbmQodGhpcyk7XHJcbiAgICB0aGlzLmhhbmRsZU1vdXNlVXAgPSB0aGlzLmhhbmRsZU1vdXNlVXAuYmluZCh0aGlzKTtcclxuXHJcbiAgICB0aGlzLmxvY2F0aW9uID0gcGFyYW1zLmxvY2F0aW9uO1xyXG4gICAgdGhpcy53aWR0aE9ySGVpZ2h0ID0gZ2V0V2lkdGhPckhlaWdodCh0aGlzLmxvY2F0aW9uKTtcclxuICAgIHRoaXMudmlld1JlZ2lzdHJ5ID0gcGFyYW1zLnZpZXdSZWdpc3RyeTtcclxuICAgIHRoaXMuZGlkQWN0aXZhdGUgPSBwYXJhbXMuZGlkQWN0aXZhdGU7XHJcblxyXG4gICAgdGhpcy5lbWl0dGVyID0gbmV3IEVtaXR0ZXIoKTtcclxuXHJcbiAgICB0aGlzLnBhbmVDb250YWluZXIgPSBuZXcgUGFuZUNvbnRhaW5lcih7XHJcbiAgICAgIGxvY2F0aW9uOiB0aGlzLmxvY2F0aW9uLFxyXG4gICAgICB2aWV3UmVnaXN0cnk6IHRoaXMudmlld1JlZ2lzdHJ5XHJcbiAgICB9KTtcclxuXHJcbiAgICB0aGlzLnN0YXRlID0ge1xyXG4gICAgICBzaXplOiBudWxsLFxyXG4gICAgICB2aXNpYmxlOiBmYWxzZSxcclxuICAgICAgc2hvdWxkQW5pbWF0ZTogZmFsc2VcclxuICAgIH07XHJcblxyXG4gIH1cclxuXHJcbiAgLy8gVGhpcyBtZXRob2QgaXMgY2FsbGVkIGV4cGxpY2l0bHkgYnkgdGhlIG9iamVjdCB3aGljaCBhZGRzIHRoZSBEb2NrIHRvIHRoZSBkb2N1bWVudC5cclxuICBlbGVtZW50QXR0YWNoZWQoKSB7XHJcbiAgICAvLyBSZS1yZW5kZXIgd2hlbiB0aGUgZG9jayBpcyBhdHRhY2hlZCB0byBtYWtlIHN1cmUgd2UgcmVtZWFzdXJlIHNpemVzIGRlZmluZWQgaW4gQ1NTLlxyXG4gICAgdGhpcy5yZW5kZXIodGhpcy5zdGF0ZSk7XHJcbiAgfVxyXG5cclxuICBnZXRFbGVtZW50KCkge1xyXG5cclxuICB9XHJcblxyXG4gIGdldExvY2F0aW9uKCkge1xyXG4gICAgcmV0dXJuIHRoaXMubG9jYXRpb247XHJcbiAgfVxyXG5cclxuICBkZXN0cm95KCkge1xyXG4gICAgdGhpcy5wYW5lQ29udGFpbmVyLmRlc3Ryb3koKTtcclxuICAgIC8vIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdtb3VzZW1vdmUnLCB0aGlzLmhhbmRsZU1vdXNlTW92ZSk7XHJcbiAgICAvLyB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcignbW91c2V1cCcsIHRoaXMuaGFuZGxlTW91c2VVcCk7XHJcbiAgICAvLyB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcignZHJhZycsIHRoaXMuaGFuZGxlRHJhZyk7XHJcbiAgICAvLyB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcignZHJhZ2VuZCcsIHRoaXMuaGFuZGxlRHJhZ0VuZCk7XHJcbiAgfVxyXG5cclxuICBzZXRIb3ZlcmVkKGhvdmVyZWQpIHtcclxuICAgIGlmIChob3ZlcmVkID09PSB0aGlzLnN0YXRlLmhvdmVyZWQpIHtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgdGhpcy5zZXRTdGF0ZSh7IGhvdmVyZWQgfSk7XHJcbiAgfVxyXG5cclxuICBzZXREcmFnZ2luZ0l0ZW0oZHJhZ2dpbmdJdGVtKSB7XHJcbiAgICBpZiAoZHJhZ2dpbmdJdGVtID09PSB0aGlzLnN0YXRlLmRyYWdnaW5nSXRlbSkgeyByZXR1cm47IH1cclxuICAgIHRoaXMuc2V0U3RhdGUoeyBkcmFnZ2luZ0l0ZW0gfSk7XHJcbiAgfVxyXG5cclxuICAvLyBFeHRlbmRlZDogU2hvdyB0aGUgZG9jayBhbmQgZm9jdXMgaXRzIGFjdGl2ZSB7UGFuZX0uXHJcbiAgYWN0aXZhdGUoKSB7XHJcbiAgICB0aGlzLmdldEFjdGl2ZVBhbmUoKS5hY3RpdmF0ZSgpO1xyXG4gIH1cclxuXHJcbiAgLy8gRXh0ZW5kZWQ6IFNob3cgdGhlIGRvY2sgd2l0aG91dCBmb2N1c2luZyBpdC5cclxuICBzaG93KCkge1xyXG4gICAgdGhpcy5zZXRTdGF0ZSh7IHZpc2libGU6IHRydWUgfSk7XHJcbiAgfVxyXG5cclxuICAvLyBFeHRlbmRlZDogSGlkZSB0aGUgZG9jayBhbmQgYWN0aXZhdGUgdGhlIHtXb3Jrc3BhY2VDZW50ZXJ9IGlmIHRoZSBkb2NrIHdhc1xyXG4gIC8vIHdhcyBwcmV2aW91c2x5IGZvY3VzZWQuXHJcbiAgaGlkZSgpIHtcclxuICAgIHRoaXMuc2V0U3RhdGUoeyB2aXNpYmxlOiBmYWxzZSB9KTtcclxuICB9XHJcblxyXG4gIC8vIEV4dGVuZGVkOiBUb2dnbGUgdGhlIGRvY2sncyB2aXNpYmlsaXR5IHdpdGhvdXQgY2hhbmdpbmcgdGhlIHtXb3Jrc3BhY2V9J3NcclxuICAvLyBhY3RpdmUgcGFuZSBjb250YWluZXIuXHJcbiAgdG9nZ2xlKCkge1xyXG4gICAgLy8gY29uc3Qgc3RhdGUgPSB7IHZpc2libGU6ICF0aGlzLnN0YXRlLnZpc2libGUgfTtcclxuICAgIC8vIGlmICghc3RhdGUudmlzaWJsZSkgeyBzdGF0ZS5ob3ZlcmVkID0gZmFsc2U7IH1cclxuICAgIC8vIHRoaXMuc2V0U3RhdGUoc3RhdGUpO1xyXG4gIH1cclxuXHJcbiAgLy8gRXh0ZW5kZWQ6IENoZWNrIGlmIHRoZSBkb2NrIGlzIHZpc2libGUuXHJcbiAgLy9cclxuICAvLyBSZXR1cm5zIGEge0Jvb2xlYW59LlxyXG4gIGlzVmlzaWJsZSgpIHtcclxuICAgIHJldHVybiB0aGlzLnN0YXRlLnZpc2libGU7XHJcbiAgfVxyXG5cclxuICBzZXRTdGF0ZShuZXdTdGF0ZSkge1xyXG4gICAgY29uc3QgcHJldlN0YXRlID0gdGhpcy5zdGF0ZTtcclxuICAgIGNvbnN0IG5leHRTdGF0ZSA9IE9iamVjdC5hc3NpZ24oe30sIHByZXZTdGF0ZSwgbmV3U3RhdGUpO1xyXG5cclxuICAgIC8vIFVwZGF0ZSB0aGUgYHNob3VsZEFuaW1hdGVgIHN0YXRlLiBUaGlzIG5lZWRzIHRvIGJlIHdyaXR0ZW4gdG8gdGhlIERPTSBiZWZvcmUgdXBkYXRpbmcgdGhlXHJcbiAgICAvLyBjbGFzcyB0aGF0IGNoYW5nZXMgdGhlIGFuaW1hdGVkIHByb3BlcnR5LiBOb3JtYWxseSB3ZSdkIGhhdmUgdG8gZGVmZXIgdGhlIGNsYXNzIGNoYW5nZSBhXHJcbiAgICAvLyBmcmFtZSB0byBlbnN1cmUgdGhlIHByb3BlcnR5IGlzIGFuaW1hdGVkIChvciBub3QpIGFwcHJvcHJpYXRlbHksIGhvd2V2ZXIgd2UgbHVjayBvdXQgaW4gdGhpc1xyXG4gICAgLy8gY2FzZSBiZWNhdXNlIHRoZSBkcmFnIHN0YXJ0IGFsd2F5cyBoYXBwZW5zIGJlZm9yZSB0aGUgaXRlbSBpcyBkcmFnZ2VkIGludG8gdGhlIHRvZ2dsZSBidXR0b24uXHJcbiAgICBpZiAobmV4dFN0YXRlLnZpc2libGUgIT09IHByZXZTdGF0ZS52aXNpYmxlKSB7XHJcbiAgICAgIC8vIE5ldmVyIGFuaW1hdGUgdG9nZ2xpbmcgdmlzaWJpbGl0eS4uLlxyXG4gICAgICBuZXh0U3RhdGUuc2hvdWxkQW5pbWF0ZSA9IGZhbHNlO1xyXG4gICAgfSBlbHNlIGlmICghbmV4dFN0YXRlLnZpc2libGUgJiYgbmV4dFN0YXRlLmRyYWdnaW5nSXRlbSAmJiAhcHJldlN0YXRlLmRyYWdnaW5nSXRlbSkge1xyXG4gICAgICAvLyAuLi5idXQgZG8gYW5pbWF0ZSBpZiB5b3Ugc3RhcnQgZHJhZ2dpbmcgd2hpbGUgdGhlIHBhbmVsIGlzIGhpZGRlbi5cclxuICAgICAgbmV4dFN0YXRlLnNob3VsZEFuaW1hdGUgPSB0cnVlO1xyXG4gICAgfVxyXG5cclxuICAgIHRoaXMuc3RhdGUgPSBuZXh0U3RhdGU7XHJcbiAgICB0aGlzLnJlbmRlcih0aGlzLnN0YXRlKTtcclxuXHJcbiAgICBjb25zdCB7IHZpc2libGUgfSA9IHRoaXMuc3RhdGU7XHJcbiAgICAvLyBpZiAodmlzaWJsZSAhPT0gcHJldlN0YXRlLnZpc2libGUpIHtcclxuICAgIC8vICAgdGhpcy5lbWl0dGVyLmVtaXQoJ2RpZC1jaGFuZ2UtdmlzaWJsZScsIHZpc2libGUpO1xyXG4gICAgLy8gfVxyXG4gIH1cclxuXHJcbiAgcmVuZGVyKHN0YXRlKSB7XHJcblxyXG4gIH1cclxuXHJcbiAgaGFuZGxlRGlkQWRkUGFuZUl0ZW0oKSB7XHJcbiAgICBpZiAodGhpcy5zdGF0ZS5zaXplID09IG51bGwpIHtcclxuICAgICAgdGhpcy5zZXRTdGF0ZSh7IHNpemU6IHRoaXMuZ2V0SW5pdGlhbFNpemUoKSB9KTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGhhbmRsZURpZFJlbW92ZVBhbmVJdGVtKCkge1xyXG4gICAgLy8gSGlkZSB0aGUgZG9jayBpZiB5b3UgcmVtb3ZlIHRoZSBsYXN0IGl0ZW0uXHJcbiAgICBpZiAodGhpcy5wYW5lQ29udGFpbmVyLmdldFBhbmVJdGVtcygpLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICB0aGlzLnNldFN0YXRlKHsgdmlzaWJsZTogZmFsc2UsIGhvdmVyZWQ6IGZhbHNlLCBzaXplOiBudWxsIH0pO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgaGFuZGxlUmVzaXplSGFuZGxlRHJhZ1N0YXJ0KCkge1xyXG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbW92ZScsIHRoaXMuaGFuZGxlTW91c2VNb3ZlKTtcclxuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdtb3VzZXVwJywgdGhpcy5oYW5kbGVNb3VzZVVwKTtcclxuICAgIHRoaXMuc2V0U3RhdGUoeyByZXNpemluZzogdHJ1ZSB9KTtcclxuICB9XHJcblxyXG4gIGhhbmRsZVJlc2l6ZVRvRml0KCkge1xyXG4gICAgY29uc3QgaXRlbSA9IHRoaXMuZ2V0QWN0aXZlUGFuZUl0ZW0oKTtcclxuICAgIGlmIChpdGVtKSB7XHJcbiAgICAgIGNvbnN0IHNpemUgPSBnZXRQcmVmZXJyZWRTaXplKGl0ZW0sIHRoaXMuZ2V0TG9jYXRpb24oKSk7XHJcbiAgICAgIGlmIChzaXplICE9IG51bGwpIHsgdGhpcy5zZXRTdGF0ZSh7IHNpemUgfSk7IH1cclxuICAgIH1cclxuICB9XHJcblxyXG4gIGhhbmRsZU1vdXNlTW92ZShldmVudCkge1xyXG4gICAgaWYgKGV2ZW50LmJ1dHRvbnMgPT09IDApIHsgLy8gV2UgbWlzc2VkIHRoZSBtb3VzZXVwIGV2ZW50LiBGb3Igc29tZSByZWFzb24gaXQgaGFwcGVucyBvbiBXaW5kb3dzXHJcbiAgICAgIHRoaXMuaGFuZGxlTW91c2VVcChldmVudCk7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBzaXplID0gMDtcclxuICAgIC8vIHN3aXRjaCAodGhpcy5sb2NhdGlvbikge1xyXG4gICAgLy8gICBjYXNlICdsZWZ0JzpcclxuICAgIC8vICAgICBzaXplID0gZXZlbnQucGFnZVggLSB0aGlzLmVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkubGVmdDtcclxuICAgIC8vICAgICBicmVhaztcclxuICAgIC8vICAgY2FzZSAnYm90dG9tJzpcclxuICAgIC8vICAgICBzaXplID0gdGhpcy5lbGVtZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLmJvdHRvbSAtIGV2ZW50LnBhZ2VZO1xyXG4gICAgLy8gICAgIGJyZWFrO1xyXG4gICAgLy8gICBjYXNlICdyaWdodCc6XHJcbiAgICAvLyAgICAgc2l6ZSA9IHRoaXMuZWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5yaWdodCAtIGV2ZW50LnBhZ2VYO1xyXG4gICAgLy8gICAgIGJyZWFrO1xyXG4gICAgLy8gfVxyXG4gICAgdGhpcy5zZXRTdGF0ZSh7IHNpemUgfSk7XHJcbiAgfVxyXG5cclxuICBoYW5kbGVNb3VzZVVwKGV2ZW50KSB7XHJcbiAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcignbW91c2Vtb3ZlJywgdGhpcy5oYW5kbGVNb3VzZU1vdmUpO1xyXG4gICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21vdXNldXAnLCB0aGlzLmhhbmRsZU1vdXNlVXApO1xyXG4gICAgdGhpcy5zZXRTdGF0ZSh7IHJlc2l6aW5nOiBmYWxzZSB9KTtcclxuICB9XHJcblxyXG4gIC8vIERldGVybWluZSB3aGV0aGVyIHRoZSBjdXJzb3IgaXMgd2l0aGluIHRoZSBkb2NrIGhvdmVyIGFyZWEuIFRoaXMgaXNuJ3QgYXMgc2ltcGxlIGFzIGp1c3QgdXNpbmdcclxuICAvLyBtb3VzZWVudGVyL2xlYXZlIGJlY2F1c2Ugd2Ugd2FudCB0byBiZSBhIGxpdHRsZSBtb3JlIGZvcmdpdmluZy4gRm9yIGV4YW1wbGUsIGlmIHRoZSBjdXJzb3IgaXNcclxuICAvLyBvdmVyIHRoZSBmb290ZXIsIHdlIHdhbnQgdG8gc2hvdyB0aGUgYm90dG9tIGRvY2sncyB0b2dnbGUgYnV0dG9uLiBBbHNvIG5vdGUgdGhhdCBvdXIgY3JpdGVyaWFcclxuICAvLyBmb3IgZGV0ZWN0aW5nIGVudHJ5IGFyZSBkaWZmZXJlbnQgdGhhbiBkZXRlY3RpbmcgZXhpdCBidXQsIGluIG9yZGVyIGZvciB1cyB0byBhdm9pZCBqaXR0ZXIsIHRoZVxyXG4gIC8vIGFyZWEgY29uc2lkZXJlZCB3aGVuIGRldGVjdGluZyBleGl0IE1VU1QgZnVsbHkgZW5jb21wYXNzIHRoZSBhcmVhIGNvbnNpZGVyZWQgd2hlbiBkZXRlY3RpbmdcclxuICAvLyBlbnRyeS5cclxuICBwb2ludFdpdGhpbkhvdmVyQXJlYSAocG9pbnQsIGRldGVjdGluZ0V4aXQpIHtcclxuICB9XHJcblxyXG4gIGdldEluaXRpYWxTaXplKCkge1xyXG4gICAgLy8gVGhlIGl0ZW0gbWF5IG5vdCBoYXZlIGJlZW4gYWN0aXZhdGVkIHlldC4gSWYgdGhhdCdzIHRoZSBjYXNlLCBqdXN0IHVzZSB0aGUgZmlyc3QgaXRlbS5cclxuICAgIGNvbnN0IGFjdGl2ZVBhbmVJdGVtID0gdGhpcy5wYW5lQ29udGFpbmVyLmdldEFjdGl2ZVBhbmVJdGVtKCkgfHwgdGhpcy5wYW5lQ29udGFpbmVyLmdldFBhbmVJdGVtcygpWzBdO1xyXG4gICAgLy8gSWYgdGhlcmUgYXJlIGl0ZW1zLCB3ZSBzaG91bGQgaGF2ZSBhbiBleHBsaWNpdCB3aWR0aDsgaWYgbm90LCB3ZSBzaG91bGRuJ3QuXHJcbiAgICByZXR1cm4gYWN0aXZlUGFuZUl0ZW1cclxuICAgICAgPyBnZXRQcmVmZXJyZWRTaXplKGFjdGl2ZVBhbmVJdGVtLCB0aGlzLmxvY2F0aW9uKVxyXG4gICAgICA6IG51bGw7XHJcbiAgfVxyXG5cclxuICBzZXJpYWxpemUoKSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBkZXNlcmlhbGl6ZXI6ICdEb2NrJyxcclxuICAgICAgc2l6ZTogdGhpcy5zdGF0ZS5zaXplLFxyXG4gICAgICBwYW5lQ29udGFpbmVyOiB0aGlzLnBhbmVDb250YWluZXIuc2VyaWFsaXplKHt9KSxcclxuICAgICAgdmlzaWJsZTogdGhpcy5zdGF0ZS52aXNpYmxlXHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgZGVzZXJpYWxpemUoc2VyaWFsaXplZCwgZGVzZXJpYWxpemVyTWFuYWdlcikge1xyXG4gICAgdGhpcy5wYW5lQ29udGFpbmVyLmRlc2VyaWFsaXplKHNlcmlhbGl6ZWQucGFuZUNvbnRhaW5lciwgZGVzZXJpYWxpemVyTWFuYWdlcik7XHJcbiAgICB0aGlzLnNldFN0YXRlKHtcclxuICAgICAgc2l6ZTogc2VyaWFsaXplZC5zaXplIHx8IHRoaXMuZ2V0SW5pdGlhbFNpemUoKSxcclxuICAgICAgLy8gSWYgbm8gaXRlbXMgY291bGQgYmUgZGVzZXJpYWxpemVkLCB3ZSBkb24ndCB3YW50IHRvIHNob3cgdGhlIGRvY2sgKGV2ZW4gaWYgaXQgd2FzIHZpc2libGUgbGFzdCB0aW1lKVxyXG4gICAgICB2aXNpYmxlOiBzZXJpYWxpemVkLnZpc2libGUgJiYgKHRoaXMucGFuZUNvbnRhaW5lci5nZXRQYW5lSXRlbXMoKS5sZW5ndGggPiAwKVxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvKlxyXG4gIFNlY3Rpb246IEV2ZW50IFN1YnNjcmlwdGlvblxyXG4gICovXHJcblxyXG4gIC8vIEVzc2VudGlhbDogSW52b2tlIHRoZSBnaXZlbiBjYWxsYmFjayB3aGVuIHRoZSB2aXNpYmlsaXR5IG9mIHRoZSBkb2NrIGNoYW5nZXMuXHJcbiAgLy9cclxuICAvLyAqIGBjYWxsYmFja2Age0Z1bmN0aW9ufSB0byBiZSBjYWxsZWQgd2hlbiB0aGUgdmlzaWJpbGl0eSBjaGFuZ2VzLlxyXG4gIC8vICAgKiBgdmlzaWJsZWAge0Jvb2xlYW59IElzIHRoZSBkb2NrIG5vdyB2aXNpYmxlP1xyXG4gIC8vXHJcbiAgLy8gUmV0dXJucyBhIHtEaXNwb3NhYmxlfSBvbiB3aGljaCBgLmRpc3Bvc2UoKWAgY2FuIGJlIGNhbGxlZCB0byB1bnN1YnNjcmliZS5cclxuICBvbkRpZENoYW5nZVZpc2libGUoY2FsbGJhY2spIHtcclxuICB9XHJcblxyXG4gIC8vIEVzc2VudGlhbDogSW52b2tlIHRoZSBnaXZlbiBjYWxsYmFjayB3aXRoIHRoZSBjdXJyZW50IGFuZCBhbGwgZnV0dXJlIHZpc2liaWxpdGllcyBvZiB0aGUgZG9jay5cclxuICAvL1xyXG4gIC8vICogYGNhbGxiYWNrYCB7RnVuY3Rpb259IHRvIGJlIGNhbGxlZCB3aGVuIHRoZSB2aXNpYmlsaXR5IGNoYW5nZXMuXHJcbiAgLy8gICAqIGB2aXNpYmxlYCB7Qm9vbGVhbn0gSXMgdGhlIGRvY2sgbm93IHZpc2libGU/XHJcbiAgLy9cclxuICAvLyBSZXR1cm5zIGEge0Rpc3Bvc2FibGV9IG9uIHdoaWNoIGAuZGlzcG9zZSgpYCBjYW4gYmUgY2FsbGVkIHRvIHVuc3Vic2NyaWJlLlxyXG4gIG9ic2VydmVWaXNpYmxlKGNhbGxiYWNrKSB7XHJcbiAgICBjYWxsYmFjayh0aGlzLmlzVmlzaWJsZSgpKTtcclxuICAgIHJldHVybiB0aGlzLm9uRGlkQ2hhbmdlVmlzaWJsZShjYWxsYmFjayk7XHJcbiAgfVxyXG5cclxuICAvLyBFc3NlbnRpYWw6IEludm9rZSB0aGUgZ2l2ZW4gY2FsbGJhY2sgd2l0aCBhbGwgY3VycmVudCBhbmQgZnV0dXJlIHBhbmVzIGl0ZW1zXHJcbiAgLy8gaW4gdGhlIGRvY2suXHJcbiAgLy9cclxuICAvLyAqIGBjYWxsYmFja2Age0Z1bmN0aW9ufSB0byBiZSBjYWxsZWQgd2l0aCBjdXJyZW50IGFuZCBmdXR1cmUgcGFuZSBpdGVtcy5cclxuICAvLyAgICogYGl0ZW1gIEFuIGl0ZW0gdGhhdCBpcyBwcmVzZW50IGluIHs6OmdldFBhbmVJdGVtc30gYXQgdGhlIHRpbWUgb2ZcclxuICAvLyAgICAgIHN1YnNjcmlwdGlvbiBvciB0aGF0IGlzIGFkZGVkIGF0IHNvbWUgbGF0ZXIgdGltZS5cclxuICAvL1xyXG4gIC8vIFJldHVybnMgYSB7RGlzcG9zYWJsZX0gb24gd2hpY2ggYC5kaXNwb3NlKClgIGNhbiBiZSBjYWxsZWQgdG8gdW5zdWJzY3JpYmUuXHJcbiAgb2JzZXJ2ZVBhbmVJdGVtcyhjYWxsYmFjaykge1xyXG4gICAgcmV0dXJuIHRoaXMucGFuZUNvbnRhaW5lci5vYnNlcnZlUGFuZUl0ZW1zKGNhbGxiYWNrKTtcclxuICB9XHJcblxyXG4gIC8vIEVzc2VudGlhbDogSW52b2tlIHRoZSBnaXZlbiBjYWxsYmFjayB3aGVuIHRoZSBhY3RpdmUgcGFuZSBpdGVtIGNoYW5nZXMuXHJcbiAgLy9cclxuICAvLyBCZWNhdXNlIG9ic2VydmVycyBhcmUgaW52b2tlZCBzeW5jaHJvbm91c2x5LCBpdCdzIGltcG9ydGFudCBub3QgdG8gcGVyZm9ybVxyXG4gIC8vIGFueSBleHBlbnNpdmUgb3BlcmF0aW9ucyB2aWEgdGhpcyBtZXRob2QuIENvbnNpZGVyXHJcbiAgLy8gezo6b25EaWRTdG9wQ2hhbmdpbmdBY3RpdmVQYW5lSXRlbX0gdG8gZGVsYXkgb3BlcmF0aW9ucyB1bnRpbCBhZnRlciBjaGFuZ2VzXHJcbiAgLy8gc3RvcCBvY2N1cnJpbmcuXHJcbiAgLy9cclxuICAvLyAqIGBjYWxsYmFja2Age0Z1bmN0aW9ufSB0byBiZSBjYWxsZWQgd2hlbiB0aGUgYWN0aXZlIHBhbmUgaXRlbSBjaGFuZ2VzLlxyXG4gIC8vICAgKiBgaXRlbWAgVGhlIGFjdGl2ZSBwYW5lIGl0ZW0uXHJcbiAgLy9cclxuICAvLyBSZXR1cm5zIGEge0Rpc3Bvc2FibGV9IG9uIHdoaWNoIGAuZGlzcG9zZSgpYCBjYW4gYmUgY2FsbGVkIHRvIHVuc3Vic2NyaWJlLlxyXG4gIG9uRGlkQ2hhbmdlQWN0aXZlUGFuZUl0ZW0oY2FsbGJhY2spIHtcclxuICAgIHJldHVybiB0aGlzLnBhbmVDb250YWluZXIub25EaWRDaGFuZ2VBY3RpdmVQYW5lSXRlbShjYWxsYmFjayk7XHJcbiAgfVxyXG5cclxuICAvLyBFc3NlbnRpYWw6IEludm9rZSB0aGUgZ2l2ZW4gY2FsbGJhY2sgd2hlbiB0aGUgYWN0aXZlIHBhbmUgaXRlbSBzdG9wc1xyXG4gIC8vIGNoYW5naW5nLlxyXG4gIC8vXHJcbiAgLy8gT2JzZXJ2ZXJzIGFyZSBjYWxsZWQgYXN5bmNocm9ub3VzbHkgMTAwbXMgYWZ0ZXIgdGhlIGxhc3QgYWN0aXZlIHBhbmUgaXRlbVxyXG4gIC8vIGNoYW5nZS4gSGFuZGxpbmcgY2hhbmdlcyBoZXJlIHJhdGhlciB0aGFuIGluIHRoZSBzeW5jaHJvbm91c1xyXG4gIC8vIHs6Om9uRGlkQ2hhbmdlQWN0aXZlUGFuZUl0ZW19IHByZXZlbnRzIHVubmVlZGVkIHdvcmsgaWYgdGhlIHVzZXIgaXMgcXVpY2tseVxyXG4gIC8vIGNoYW5naW5nIG9yIGNsb3NpbmcgdGFicyBhbmQgZW5zdXJlcyBjcml0aWNhbCBVSSBmZWVkYmFjaywgbGlrZSBjaGFuZ2luZyB0aGVcclxuICAvLyBoaWdobGlnaHRlZCB0YWIsIGdldHMgcHJpb3JpdHkgb3ZlciB3b3JrIHRoYXQgY2FuIGJlIGRvbmUgYXN5bmNocm9ub3VzbHkuXHJcbiAgLy9cclxuICAvLyAqIGBjYWxsYmFja2Age0Z1bmN0aW9ufSB0byBiZSBjYWxsZWQgd2hlbiB0aGUgYWN0aXZlIHBhbmUgaXRlbSBzdG9wdHNcclxuICAvLyAgIGNoYW5naW5nLlxyXG4gIC8vICAgKiBgaXRlbWAgVGhlIGFjdGl2ZSBwYW5lIGl0ZW0uXHJcbiAgLy9cclxuICAvLyBSZXR1cm5zIGEge0Rpc3Bvc2FibGV9IG9uIHdoaWNoIGAuZGlzcG9zZSgpYCBjYW4gYmUgY2FsbGVkIHRvIHVuc3Vic2NyaWJlLlxyXG4gIG9uRGlkU3RvcENoYW5naW5nQWN0aXZlUGFuZUl0ZW0oY2FsbGJhY2spIHtcclxuICAgIHJldHVybiB0aGlzLnBhbmVDb250YWluZXIub25EaWRTdG9wQ2hhbmdpbmdBY3RpdmVQYW5lSXRlbShjYWxsYmFjayk7XHJcbiAgfVxyXG5cclxuICAvLyBFc3NlbnRpYWw6IEludm9rZSB0aGUgZ2l2ZW4gY2FsbGJhY2sgd2l0aCB0aGUgY3VycmVudCBhY3RpdmUgcGFuZSBpdGVtIGFuZFxyXG4gIC8vIHdpdGggYWxsIGZ1dHVyZSBhY3RpdmUgcGFuZSBpdGVtcyBpbiB0aGUgZG9jay5cclxuICAvL1xyXG4gIC8vICogYGNhbGxiYWNrYCB7RnVuY3Rpb259IHRvIGJlIGNhbGxlZCB3aGVuIHRoZSBhY3RpdmUgcGFuZSBpdGVtIGNoYW5nZXMuXHJcbiAgLy8gICAqIGBpdGVtYCBUaGUgY3VycmVudCBhY3RpdmUgcGFuZSBpdGVtLlxyXG4gIC8vXHJcbiAgLy8gUmV0dXJucyBhIHtEaXNwb3NhYmxlfSBvbiB3aGljaCBgLmRpc3Bvc2UoKWAgY2FuIGJlIGNhbGxlZCB0byB1bnN1YnNjcmliZS5cclxuICBvYnNlcnZlQWN0aXZlUGFuZUl0ZW0oY2FsbGJhY2spIHtcclxuICAgIHJldHVybiB0aGlzLnBhbmVDb250YWluZXIub2JzZXJ2ZUFjdGl2ZVBhbmVJdGVtKGNhbGxiYWNrKTtcclxuICB9XHJcblxyXG4gIC8vIEV4dGVuZGVkOiBJbnZva2UgdGhlIGdpdmVuIGNhbGxiYWNrIHdoZW4gYSBwYW5lIGlzIGFkZGVkIHRvIHRoZSBkb2NrLlxyXG4gIC8vXHJcbiAgLy8gKiBgY2FsbGJhY2tgIHtGdW5jdGlvbn0gdG8gYmUgY2FsbGVkIHBhbmVzIGFyZSBhZGRlZC5cclxuICAvLyAgICogYGV2ZW50YCB7T2JqZWN0fSB3aXRoIHRoZSBmb2xsb3dpbmcga2V5czpcclxuICAvLyAgICAgKiBgcGFuZWAgVGhlIGFkZGVkIHBhbmUuXHJcbiAgLy9cclxuICAvLyBSZXR1cm5zIGEge0Rpc3Bvc2FibGV9IG9uIHdoaWNoIGAuZGlzcG9zZSgpYCBjYW4gYmUgY2FsbGVkIHRvIHVuc3Vic2NyaWJlLlxyXG4gIG9uRGlkQWRkUGFuZShjYWxsYmFjaykge1xyXG4gICAgcmV0dXJuIHRoaXMucGFuZUNvbnRhaW5lci5vbkRpZEFkZFBhbmUoY2FsbGJhY2spO1xyXG4gIH1cclxuXHJcbiAgLy8gRXh0ZW5kZWQ6IEludm9rZSB0aGUgZ2l2ZW4gY2FsbGJhY2sgYmVmb3JlIGEgcGFuZSBpcyBkZXN0cm95ZWQgaW4gdGhlXHJcbiAgLy8gZG9jay5cclxuICAvL1xyXG4gIC8vICogYGNhbGxiYWNrYCB7RnVuY3Rpb259IHRvIGJlIGNhbGxlZCBiZWZvcmUgcGFuZXMgYXJlIGRlc3Ryb3llZC5cclxuICAvLyAgICogYGV2ZW50YCB7T2JqZWN0fSB3aXRoIHRoZSBmb2xsb3dpbmcga2V5czpcclxuICAvLyAgICAgKiBgcGFuZWAgVGhlIHBhbmUgdG8gYmUgZGVzdHJveWVkLlxyXG4gIC8vXHJcbiAgLy8gUmV0dXJucyBhIHtEaXNwb3NhYmxlfSBvbiB3aGljaCBgLmRpc3Bvc2UoKWAgY2FuIGJlIGNhbGxlZCB0byB1bnN1YnNjcmliZS5cclxuICBvbldpbGxEZXN0cm95UGFuZShjYWxsYmFjaykge1xyXG4gICAgcmV0dXJuIHRoaXMucGFuZUNvbnRhaW5lci5vbldpbGxEZXN0cm95UGFuZShjYWxsYmFjayk7XHJcbiAgfVxyXG5cclxuICAvLyBFeHRlbmRlZDogSW52b2tlIHRoZSBnaXZlbiBjYWxsYmFjayB3aGVuIGEgcGFuZSBpcyBkZXN0cm95ZWQgaW4gdGhlIGRvY2suXHJcbiAgLy9cclxuICAvLyAqIGBjYWxsYmFja2Age0Z1bmN0aW9ufSB0byBiZSBjYWxsZWQgcGFuZXMgYXJlIGRlc3Ryb3llZC5cclxuICAvLyAgICogYGV2ZW50YCB7T2JqZWN0fSB3aXRoIHRoZSBmb2xsb3dpbmcga2V5czpcclxuICAvLyAgICAgKiBgcGFuZWAgVGhlIGRlc3Ryb3llZCBwYW5lLlxyXG4gIC8vXHJcbiAgLy8gUmV0dXJucyBhIHtEaXNwb3NhYmxlfSBvbiB3aGljaCBgLmRpc3Bvc2UoKWAgY2FuIGJlIGNhbGxlZCB0byB1bnN1YnNjcmliZS5cclxuICBvbkRpZERlc3Ryb3lQYW5lKGNhbGxiYWNrKSB7XHJcbiAgICByZXR1cm4gdGhpcy5wYW5lQ29udGFpbmVyLm9uRGlkRGVzdHJveVBhbmUoY2FsbGJhY2spO1xyXG4gIH1cclxuXHJcbiAgLy8gRXh0ZW5kZWQ6IEludm9rZSB0aGUgZ2l2ZW4gY2FsbGJhY2sgd2l0aCBhbGwgY3VycmVudCBhbmQgZnV0dXJlIHBhbmVzIGluIHRoZVxyXG4gIC8vIGRvY2suXHJcbiAgLy9cclxuICAvLyAqIGBjYWxsYmFja2Age0Z1bmN0aW9ufSB0byBiZSBjYWxsZWQgd2l0aCBjdXJyZW50IGFuZCBmdXR1cmUgcGFuZXMuXHJcbiAgLy8gICAqIGBwYW5lYCBBIHtQYW5lfSB0aGF0IGlzIHByZXNlbnQgaW4gezo6Z2V0UGFuZXN9IGF0IHRoZSB0aW1lIG9mXHJcbiAgLy8gICAgICBzdWJzY3JpcHRpb24gb3IgdGhhdCBpcyBhZGRlZCBhdCBzb21lIGxhdGVyIHRpbWUuXHJcbiAgLy9cclxuICAvLyBSZXR1cm5zIGEge0Rpc3Bvc2FibGV9IG9uIHdoaWNoIGAuZGlzcG9zZSgpYCBjYW4gYmUgY2FsbGVkIHRvIHVuc3Vic2NyaWJlLlxyXG4gIG9ic2VydmVQYW5lcyhjYWxsYmFjaykge1xyXG4gICAgcmV0dXJuIHRoaXMucGFuZUNvbnRhaW5lci5vYnNlcnZlUGFuZXMoY2FsbGJhY2spO1xyXG4gIH1cclxuXHJcbiAgLy8gRXh0ZW5kZWQ6IEludm9rZSB0aGUgZ2l2ZW4gY2FsbGJhY2sgd2hlbiB0aGUgYWN0aXZlIHBhbmUgY2hhbmdlcy5cclxuICAvL1xyXG4gIC8vICogYGNhbGxiYWNrYCB7RnVuY3Rpb259IHRvIGJlIGNhbGxlZCB3aGVuIHRoZSBhY3RpdmUgcGFuZSBjaGFuZ2VzLlxyXG4gIC8vICAgKiBgcGFuZWAgQSB7UGFuZX0gdGhhdCBpcyB0aGUgY3VycmVudCByZXR1cm4gdmFsdWUgb2Ygezo6Z2V0QWN0aXZlUGFuZX0uXHJcbiAgLy9cclxuICAvLyBSZXR1cm5zIGEge0Rpc3Bvc2FibGV9IG9uIHdoaWNoIGAuZGlzcG9zZSgpYCBjYW4gYmUgY2FsbGVkIHRvIHVuc3Vic2NyaWJlLlxyXG4gIG9uRGlkQ2hhbmdlQWN0aXZlUGFuZShjYWxsYmFjaykge1xyXG4gICAgcmV0dXJuIHRoaXMucGFuZUNvbnRhaW5lci5vbkRpZENoYW5nZUFjdGl2ZVBhbmUoY2FsbGJhY2spO1xyXG4gIH1cclxuXHJcbiAgLy8gRXh0ZW5kZWQ6IEludm9rZSB0aGUgZ2l2ZW4gY2FsbGJhY2sgd2l0aCB0aGUgY3VycmVudCBhY3RpdmUgcGFuZSBhbmQgd2hlblxyXG4gIC8vIHRoZSBhY3RpdmUgcGFuZSBjaGFuZ2VzLlxyXG4gIC8vXHJcbiAgLy8gKiBgY2FsbGJhY2tgIHtGdW5jdGlvbn0gdG8gYmUgY2FsbGVkIHdpdGggdGhlIGN1cnJlbnQgYW5kIGZ1dHVyZSBhY3RpdmUjXHJcbiAgLy8gICBwYW5lcy5cclxuICAvLyAgICogYHBhbmVgIEEge1BhbmV9IHRoYXQgaXMgdGhlIGN1cnJlbnQgcmV0dXJuIHZhbHVlIG9mIHs6OmdldEFjdGl2ZVBhbmV9LlxyXG4gIC8vXHJcbiAgLy8gUmV0dXJucyBhIHtEaXNwb3NhYmxlfSBvbiB3aGljaCBgLmRpc3Bvc2UoKWAgY2FuIGJlIGNhbGxlZCB0byB1bnN1YnNjcmliZS5cclxuICBvYnNlcnZlQWN0aXZlUGFuZShjYWxsYmFjaykge1xyXG4gICAgcmV0dXJuIHRoaXMucGFuZUNvbnRhaW5lci5vYnNlcnZlQWN0aXZlUGFuZShjYWxsYmFjayk7XHJcbiAgfVxyXG5cclxuICAvLyBFeHRlbmRlZDogSW52b2tlIHRoZSBnaXZlbiBjYWxsYmFjayB3aGVuIGEgcGFuZSBpdGVtIGlzIGFkZGVkIHRvIHRoZSBkb2NrLlxyXG4gIC8vXHJcbiAgLy8gKiBgY2FsbGJhY2tgIHtGdW5jdGlvbn0gdG8gYmUgY2FsbGVkIHdoZW4gcGFuZSBpdGVtcyBhcmUgYWRkZWQuXHJcbiAgLy8gICAqIGBldmVudGAge09iamVjdH0gd2l0aCB0aGUgZm9sbG93aW5nIGtleXM6XHJcbiAgLy8gICAgICogYGl0ZW1gIFRoZSBhZGRlZCBwYW5lIGl0ZW0uXHJcbiAgLy8gICAgICogYHBhbmVgIHtQYW5lfSBjb250YWluaW5nIHRoZSBhZGRlZCBpdGVtLlxyXG4gIC8vICAgICAqIGBpbmRleGAge051bWJlcn0gaW5kaWNhdGluZyB0aGUgaW5kZXggb2YgdGhlIGFkZGVkIGl0ZW0gaW4gaXRzIHBhbmUuXHJcbiAgLy9cclxuICAvLyBSZXR1cm5zIGEge0Rpc3Bvc2FibGV9IG9uIHdoaWNoIGAuZGlzcG9zZSgpYCBjYW4gYmUgY2FsbGVkIHRvIHVuc3Vic2NyaWJlLlxyXG4gIG9uRGlkQWRkUGFuZUl0ZW0oY2FsbGJhY2spIHtcclxuICAgIHJldHVybiB0aGlzLnBhbmVDb250YWluZXIub25EaWRBZGRQYW5lSXRlbShjYWxsYmFjayk7XHJcbiAgfVxyXG5cclxuICAvLyBFeHRlbmRlZDogSW52b2tlIHRoZSBnaXZlbiBjYWxsYmFjayB3aGVuIGEgcGFuZSBpdGVtIGlzIGFib3V0IHRvIGJlXHJcbiAgLy8gZGVzdHJveWVkLCBiZWZvcmUgdGhlIHVzZXIgaXMgcHJvbXB0ZWQgdG8gc2F2ZSBpdC5cclxuICAvL1xyXG4gIC8vICogYGNhbGxiYWNrYCB7RnVuY3Rpb259IHRvIGJlIGNhbGxlZCBiZWZvcmUgcGFuZSBpdGVtcyBhcmUgZGVzdHJveWVkLlxyXG4gIC8vICAgKiBgZXZlbnRgIHtPYmplY3R9IHdpdGggdGhlIGZvbGxvd2luZyBrZXlzOlxyXG4gIC8vICAgICAqIGBpdGVtYCBUaGUgaXRlbSB0byBiZSBkZXN0cm95ZWQuXHJcbiAgLy8gICAgICogYHBhbmVgIHtQYW5lfSBjb250YWluaW5nIHRoZSBpdGVtIHRvIGJlIGRlc3Ryb3llZC5cclxuICAvLyAgICAgKiBgaW5kZXhgIHtOdW1iZXJ9IGluZGljYXRpbmcgdGhlIGluZGV4IG9mIHRoZSBpdGVtIHRvIGJlIGRlc3Ryb3llZCBpblxyXG4gIC8vICAgICAgIGl0cyBwYW5lLlxyXG4gIC8vXHJcbiAgLy8gUmV0dXJucyBhIHtEaXNwb3NhYmxlfSBvbiB3aGljaCBgLmRpc3Bvc2VgIGNhbiBiZSBjYWxsZWQgdG8gdW5zdWJzY3JpYmUuXHJcbiAgb25XaWxsRGVzdHJveVBhbmVJdGVtKGNhbGxiYWNrKSB7XHJcbiAgICByZXR1cm4gdGhpcy5wYW5lQ29udGFpbmVyLm9uV2lsbERlc3Ryb3lQYW5lSXRlbShjYWxsYmFjayk7XHJcbiAgfVxyXG5cclxuICAvLyBFeHRlbmRlZDogSW52b2tlIHRoZSBnaXZlbiBjYWxsYmFjayB3aGVuIGEgcGFuZSBpdGVtIGlzIGRlc3Ryb3llZC5cclxuICAvL1xyXG4gIC8vICogYGNhbGxiYWNrYCB7RnVuY3Rpb259IHRvIGJlIGNhbGxlZCB3aGVuIHBhbmUgaXRlbXMgYXJlIGRlc3Ryb3llZC5cclxuICAvLyAgICogYGV2ZW50YCB7T2JqZWN0fSB3aXRoIHRoZSBmb2xsb3dpbmcga2V5czpcclxuICAvLyAgICAgKiBgaXRlbWAgVGhlIGRlc3Ryb3llZCBpdGVtLlxyXG4gIC8vICAgICAqIGBwYW5lYCB7UGFuZX0gY29udGFpbmluZyB0aGUgZGVzdHJveWVkIGl0ZW0uXHJcbiAgLy8gICAgICogYGluZGV4YCB7TnVtYmVyfSBpbmRpY2F0aW5nIHRoZSBpbmRleCBvZiB0aGUgZGVzdHJveWVkIGl0ZW0gaW4gaXRzXHJcbiAgLy8gICAgICAgcGFuZS5cclxuICAvL1xyXG4gIC8vIFJldHVybnMgYSB7RGlzcG9zYWJsZX0gb24gd2hpY2ggYC5kaXNwb3NlYCBjYW4gYmUgY2FsbGVkIHRvIHVuc3Vic2NyaWJlLlxyXG4gIG9uRGlkRGVzdHJveVBhbmVJdGVtKGNhbGxiYWNrKSB7XHJcbiAgICByZXR1cm4gdGhpcy5wYW5lQ29udGFpbmVyLm9uRGlkRGVzdHJveVBhbmVJdGVtKGNhbGxiYWNrKTtcclxuICB9XHJcblxyXG4gIC8vIEV4dGVuZGVkOiBJbnZva2UgdGhlIGdpdmVuIGNhbGxiYWNrIHdoZW4gdGhlIGhvdmVyZWQgc3RhdGUgb2YgdGhlIGRvY2sgY2hhbmdlcy5cclxuICAvL1xyXG4gIC8vICogYGNhbGxiYWNrYCB7RnVuY3Rpb259IHRvIGJlIGNhbGxlZCB3aGVuIHRoZSBob3ZlcmVkIHN0YXRlIGNoYW5nZXMuXHJcbiAgLy8gICAqIGBob3ZlcmVkYCB7Qm9vbGVhbn0gSXMgdGhlIGRvY2sgbm93IGhvdmVyZWQ/XHJcbiAgLy9cclxuICAvLyBSZXR1cm5zIGEge0Rpc3Bvc2FibGV9IG9uIHdoaWNoIGAuZGlzcG9zZSgpYCBjYW4gYmUgY2FsbGVkIHRvIHVuc3Vic2NyaWJlLlxyXG4gIG9uRGlkQ2hhbmdlSG92ZXJlZCAoY2FsbGJhY2spOiBEaXNwb3NhYmxlIHtcclxuICAgIHJldHVybiB0aGlzLmVtaXR0ZXIub24oJ2RpZC1jaGFuZ2UtaG92ZXJlZCcsIGNhbGxiYWNrKTtcclxuICB9XHJcblxyXG4gIC8qXHJcbiAgU2VjdGlvbjogUGFuZSBJdGVtc1xyXG4gICovXHJcblxyXG4gIC8vIEVzc2VudGlhbDogR2V0IGFsbCBwYW5lIGl0ZW1zIGluIHRoZSBkb2NrLlxyXG4gIC8vXHJcbiAgLy8gUmV0dXJucyBhbiB7QXJyYXl9IG9mIGl0ZW1zLlxyXG4gIGdldFBhbmVJdGVtcygpIHtcclxuICAgIHJldHVybiB0aGlzLnBhbmVDb250YWluZXIuZ2V0UGFuZUl0ZW1zKCk7XHJcbiAgfVxyXG5cclxuICAvLyBFc3NlbnRpYWw6IEdldCB0aGUgYWN0aXZlIHtQYW5lfSdzIGFjdGl2ZSBpdGVtLlxyXG4gIC8vXHJcbiAgLy8gUmV0dXJucyBhbiBwYW5lIGl0ZW0ge09iamVjdH0uXHJcbiAgZ2V0QWN0aXZlUGFuZUl0ZW0oKSB7XHJcbiAgICByZXR1cm4gdGhpcy5wYW5lQ29udGFpbmVyLmdldEFjdGl2ZVBhbmVJdGVtKCk7XHJcbiAgfVxyXG5cclxuICAvLyBTYXZlIGFsbCBwYW5lIGl0ZW1zLlxyXG4gIHNhdmVBbGwoKSB7XHJcbiAgICB0aGlzLnBhbmVDb250YWluZXIuc2F2ZUFsbCgpO1xyXG4gIH1cclxuXHJcbiAgY29uZmlybUNsb3NlKG9wdGlvbnMpIHtcclxuICAgIHJldHVybiB0aGlzLnBhbmVDb250YWluZXIuY29uZmlybUNsb3NlKG9wdGlvbnMpO1xyXG4gIH1cclxuXHJcbiAgLypcclxuICBTZWN0aW9uOiBQYW5lc1xyXG4gICovXHJcblxyXG4gIC8vIEV4dGVuZGVkOiBHZXQgYWxsIHBhbmVzIGluIHRoZSBkb2NrLlxyXG4gIC8vXHJcbiAgLy8gUmV0dXJucyBhbiB7QXJyYXl9IG9mIHtQYW5lfXMuXHJcbiAgZ2V0UGFuZXMoKTogUGFuZVtdIHtcclxuICAgIHJldHVybiB0aGlzLnBhbmVDb250YWluZXIuZ2V0UGFuZXMoKTtcclxuICB9XHJcblxyXG4gIC8vIEV4dGVuZGVkOiBHZXQgdGhlIGFjdGl2ZSB7UGFuZX0uXHJcbiAgLy9cclxuICAvLyBSZXR1cm5zIGEge1BhbmV9LlxyXG4gIGdldEFjdGl2ZVBhbmUoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5wYW5lQ29udGFpbmVyLmdldEFjdGl2ZVBhbmUoKTtcclxuICB9XHJcblxyXG4gIC8vIEV4dGVuZGVkOiBNYWtlIHRoZSBuZXh0IHBhbmUgYWN0aXZlLlxyXG4gIGFjdGl2YXRlTmV4dFBhbmUoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5wYW5lQ29udGFpbmVyLmFjdGl2YXRlTmV4dFBhbmUoKTtcclxuICB9XHJcblxyXG4gIC8vIEV4dGVuZGVkOiBNYWtlIHRoZSBwcmV2aW91cyBwYW5lIGFjdGl2ZS5cclxuICBhY3RpdmF0ZVByZXZpb3VzUGFuZSgpIHtcclxuICAgIHJldHVybiB0aGlzLnBhbmVDb250YWluZXIuYWN0aXZhdGVQcmV2aW91c1BhbmUoKTtcclxuICB9XHJcblxyXG4gIHBhbmVGb3JVUkkodXJpKSB7XHJcbiAgICByZXR1cm4gdGhpcy5wYW5lQ29udGFpbmVyLnBhbmVGb3JVUkkodXJpKTtcclxuICB9XHJcblxyXG4gIHBhbmVGb3JJdGVtKGl0ZW0pIHtcclxuICAgIHJldHVybiB0aGlzLnBhbmVDb250YWluZXIucGFuZUZvckl0ZW0oaXRlbSk7XHJcbiAgfVxyXG5cclxuICAvLyBEZXN0cm95IChjbG9zZSkgdGhlIGFjdGl2ZSBwYW5lLlxyXG4gIGRlc3Ryb3lBY3RpdmVQYW5lKCkge1xyXG4gICAgY29uc3QgYWN0aXZlUGFuZSA9IHRoaXMuZ2V0QWN0aXZlUGFuZSgpO1xyXG4gICAgaWYgKGFjdGl2ZVBhbmUgIT0gbnVsbCkge1xyXG4gICAgICBhY3RpdmVQYW5lLmRlc3Ryb3koKTtcclxuICAgIH1cclxuICB9XHJcbn1cclxuXHJcblxyXG5mdW5jdGlvbiBnZXRXaWR0aE9ySGVpZ2h0KGxvY2F0aW9uKSB7XHJcbiAgcmV0dXJuIGxvY2F0aW9uID09PSAnbGVmdCcgfHwgbG9jYXRpb24gPT09ICdyaWdodCcgPyAnd2lkdGgnIDogJ2hlaWdodCc7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGdldFByZWZlcnJlZFNpemUoaXRlbSwgbG9jYXRpb24pIHtcclxuICBzd2l0Y2ggKGxvY2F0aW9uKSB7XHJcbiAgICBjYXNlICdsZWZ0JzpcclxuICAgIGNhc2UgJ3JpZ2h0JzpcclxuICAgICAgcmV0dXJuIHR5cGVvZiBpdGVtLmdldFByZWZlcnJlZFdpZHRoID09PSAnZnVuY3Rpb24nXHJcbiAgICAgICAgPyBpdGVtLmdldFByZWZlcnJlZFdpZHRoKClcclxuICAgICAgICA6IG51bGw7XHJcbiAgICBkZWZhdWx0OlxyXG4gICAgICByZXR1cm4gdHlwZW9mIGl0ZW0uZ2V0UHJlZmVycmVkSGVpZ2h0ID09PSAnZnVuY3Rpb24nXHJcbiAgICAgICAgPyBpdGVtLmdldFByZWZlcnJlZEhlaWdodCgpXHJcbiAgICAgICAgOiBudWxsO1xyXG4gIH1cclxufVxyXG5cclxuZnVuY3Rpb24gZ2V0SWNvbk5hbWUobG9jYXRpb24sIHZpc2libGUpIHtcclxuICBzd2l0Y2ggKGxvY2F0aW9uKSB7XHJcbiAgICBjYXNlICdyaWdodCc6IHJldHVybiB2aXNpYmxlID8gJ2ljb24tY2hldnJvbi1yaWdodCcgOiAnaWNvbi1jaGV2cm9uLWxlZnQnO1xyXG4gICAgY2FzZSAnYm90dG9tJzogcmV0dXJuIHZpc2libGUgPyAnaWNvbi1jaGV2cm9uLWRvd24nIDogJ2ljb24tY2hldnJvbi11cCc7XHJcbiAgICBjYXNlICdsZWZ0JzogcmV0dXJuIHZpc2libGUgPyAnaWNvbi1jaGV2cm9uLWxlZnQnIDogJ2ljb24tY2hldnJvbi1yaWdodCc7XHJcbiAgICBkZWZhdWx0OiB0aHJvdyBuZXcgRXJyb3IoYEludmFsaWQgbG9jYXRpb246ICR7bG9jYXRpb259YCk7XHJcbiAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiByZWN0Q29udGFpbnNQb2ludChyZWN0LCBwb2ludCkge1xyXG4gIHJldHVybiAoXHJcbiAgICBwb2ludC54ID49IHJlY3QubGVmdCAmJlxyXG4gICAgcG9pbnQueSA+PSByZWN0LnRvcCAmJlxyXG4gICAgcG9pbnQueCA8PSByZWN0LnJpZ2h0ICYmXHJcbiAgICBwb2ludC55IDw9IHJlY3QuYm90dG9tXHJcbiAgKTtcclxufVxyXG5cclxuLy8gSXMgdGhlIGl0ZW0gYWxsb3dlZCBpbiB0aGUgZ2l2ZW4gbG9jYXRpb24/XHJcbmZ1bmN0aW9uIGlzSXRlbUFsbG93ZWQoaXRlbSwgbG9jYXRpb24pIHtcclxuICBpZiAodHlwZW9mIGl0ZW0uZ2V0QWxsb3dlZExvY2F0aW9ucyAhPT0gJ2Z1bmN0aW9uJykge1xyXG4gICAgcmV0dXJuIHRydWU7XHJcbiAgfVxyXG4gIHJldHVybiBpdGVtLmdldEFsbG93ZWRMb2NhdGlvbnMoKS5pbmNsdWRlcyhsb2NhdGlvbik7XHJcbn1cclxuIl19