/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { CacheService } from './../../services/cache/services/cache.service';
import { CommandRegistry } from './command-registry';
import { Util } from '../util/util';
import { ViewRegistry } from './view-registry';
import { Workspace } from './workspace';
import { GspEventBus } from './gsp-event-bus';
import { Ide } from './ide/ide';
export class GSP {
    /**
     * @return {?}
     */
    get eventBus() { return this.pEventBus; }
    /**
     * @return {?}
     */
    get util() { return this.pUtil; }
    /**
     * @return {?}
     */
    get workspace() { return this.pWorkspace; }
    /**
     * @return {?}
     */
    get views() { return this.pViews; }
    /**
     * @return {?}
     */
    get commands() { return this.pCommands; }
    /**
     * @return {?}
     */
    get ide() { return this.pIde; }
    /**
     * @return {?}
     */
    get cache() { return this.pCache; }
    /**
     * @return {?}
     */
    get context() { return this.pContext; }
    /**
     * @param {?=} parent
     */
    constructor(parent) {
        this.pConfig = {
            /**
             * @param {?} key
             * @return {?}
             */
            get(key) {
                return this[key];
            }
        };
        /** @type {?} */
        let ide;
        if (parent) {
            this.pViews = parent.views;
            this.pCommands = parent.commands;
            this.pEventBus = parent.eventBus;
            this.pUtil = parent.util;
            this.pWorkspace = parent.workspace;
            this.pCache = parent.cache;
            ide = parent.ide;
            /** @type {?} */
            const ctor = parent.context.constructor;
            this.pContext = new ctor();
        }
        else {
            this.pViews = new ViewRegistry(this);
            this.pCommands = new CommandRegistry();
            this.pEventBus = new GspEventBus();
            this.pUtil = new Util();
            this.pWorkspace = new Workspace({
                config: this.pConfig,
                viewRegistry: this.pViews
            });
            this.pCache = new CacheService(null);
        }
        this.pIde = new Ide(ide);
    }
    /**
     * @deprecated 由子模块独自创建gsp实例，传入父实例作为参数。
     * 每个iframe持有一个独有的gsp实例，其中eventbus共享，ide不共享
     * @return {?}
     */
    createChild() {
        /** @type {?} */
        const child = new GSP(this);
        // child.pEventBus = this.pEventBus;
        // child.pViews = this.pViews;
        // child.pWorkspace = this.pWorkspace;
        return child;
    }
}
if (false) {
    /**
     * @type {?}
     * @private
     */
    GSP.prototype.pEventBus;
    /**
     * @type {?}
     * @private
     */
    GSP.prototype.pUtil;
    /**
     * @type {?}
     * @private
     */
    GSP.prototype.pWorkspace;
    /**
     * @type {?}
     * @private
     */
    GSP.prototype.pConfig;
    /**
     * @type {?}
     * @private
     */
    GSP.prototype.pViews;
    /**
     * @type {?}
     * @private
     */
    GSP.prototype.pCommands;
    /**
     * @type {?}
     * @private
     */
    GSP.prototype.pIde;
    /**
     * @type {?}
     * @private
     */
    GSP.prototype.pCache;
    /**
     * @type {?}
     * @private
     */
    GSP.prototype.pContext;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZ3NwLmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGZhcnJpcy9pZGUtZGV2a2l0LyIsInNvdXJjZXMiOlsibGliL2lkZWZyYW1ld29yay9nc3AvZ3NwLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7QUFBQSxPQUFPLEVBQUUsWUFBWSxFQUFFLE1BQU0sK0NBQStDLENBQUM7QUFDN0UsT0FBTyxFQUFFLGVBQWUsRUFBRSxNQUFNLG9CQUFvQixDQUFDO0FBRXJELE9BQU8sRUFBRSxJQUFJLEVBQUUsTUFBTSxjQUFjLENBQUM7QUFDcEMsT0FBTyxFQUFFLFlBQVksRUFBRSxNQUFNLGlCQUFpQixDQUFDO0FBQy9DLE9BQU8sRUFBRSxTQUFTLEVBQUUsTUFBTSxhQUFhLENBQUM7QUFDeEMsT0FBTyxFQUFFLFdBQVcsRUFBRSxNQUFNLGlCQUFpQixDQUFDO0FBQzlDLE9BQU8sRUFBRSxHQUFHLEVBQUUsTUFBTSxXQUFXLENBQUM7QUFHaEMsTUFBTSxPQUFPLEdBQUc7Ozs7SUFXZCxJQUFJLFFBQVEsS0FBZSxPQUFPLElBQUksQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDOzs7O0lBQ25ELElBQUksSUFBSSxLQUFXLE9BQU8sSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUM7Ozs7SUFDdkMsSUFBSSxTQUFTLEtBQWdCLE9BQU8sSUFBSSxDQUFDLFVBQVUsQ0FBQyxDQUFDLENBQUM7Ozs7SUFDdEQsSUFBSSxLQUFLLEtBQW1CLE9BQU8sSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUM7Ozs7SUFDakQsSUFBSSxRQUFRLEtBQXNCLE9BQU8sSUFBSSxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUM7Ozs7SUFDMUQsSUFBSSxHQUFHLEtBQVUsT0FBTyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQzs7OztJQUNwQyxJQUFJLEtBQUssS0FBbUIsT0FBTyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQzs7OztJQUNqRCxJQUFJLE9BQU8sS0FBcUIsT0FBTyxJQUFJLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQzs7OztJQUV2RCxZQUFZLE1BQVk7UUFDdEIsSUFBSSxDQUFDLE9BQU8sR0FBRzs7Ozs7WUFDYixHQUFHLENBQUMsR0FBRztnQkFDTCxPQUFPLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQztZQUNuQixDQUFDO1NBQ0YsQ0FBQzs7WUFDRSxHQUFRO1FBQ1osSUFBSSxNQUFNLEVBQUU7WUFDVixJQUFJLENBQUMsTUFBTSxHQUFHLE1BQU0sQ0FBQyxLQUFLLENBQUM7WUFDM0IsSUFBSSxDQUFDLFNBQVMsR0FBRyxNQUFNLENBQUMsUUFBUSxDQUFDO1lBQ2pDLElBQUksQ0FBQyxTQUFTLEdBQUcsTUFBTSxDQUFDLFFBQVEsQ0FBQztZQUNqQyxJQUFJLENBQUMsS0FBSyxHQUFHLE1BQU0sQ0FBQyxJQUFJLENBQUM7WUFDekIsSUFBSSxDQUFDLFVBQVUsR0FBRyxNQUFNLENBQUMsU0FBUyxDQUFDO1lBQ25DLElBQUksQ0FBQyxNQUFNLEdBQUcsTUFBTSxDQUFDLEtBQUssQ0FBQztZQUMzQixHQUFHLEdBQUcsTUFBTSxDQUFDLEdBQUcsQ0FBQzs7a0JBQ1gsSUFBSSxHQUFRLE1BQU0sQ0FBQyxPQUFPLENBQUMsV0FBVztZQUM1QyxJQUFJLENBQUMsUUFBUSxHQUFHLElBQUksSUFBSSxFQUFFLENBQUM7U0FDNUI7YUFBTTtZQUNMLElBQUksQ0FBQyxNQUFNLEdBQUcsSUFBSSxZQUFZLENBQUMsSUFBSSxDQUFDLENBQUM7WUFDckMsSUFBSSxDQUFDLFNBQVMsR0FBRyxJQUFJLGVBQWUsRUFBRSxDQUFDO1lBQ3ZDLElBQUksQ0FBQyxTQUFTLEdBQUcsSUFBSSxXQUFXLEVBQUUsQ0FBQztZQUNuQyxJQUFJLENBQUMsS0FBSyxHQUFHLElBQUksSUFBSSxFQUFFLENBQUM7WUFDeEIsSUFBSSxDQUFDLFVBQVUsR0FBRyxJQUFJLFNBQVMsQ0FBQztnQkFDOUIsTUFBTSxFQUFFLElBQUksQ0FBQyxPQUFPO2dCQUNwQixZQUFZLEVBQUUsSUFBSSxDQUFDLE1BQU07YUFDMUIsQ0FBQyxDQUFDO1lBQ0gsSUFBSSxDQUFDLE1BQU0sR0FBRyxJQUFJLFlBQVksQ0FBQyxJQUFJLENBQUMsQ0FBQztTQUN0QztRQUNELElBQUksQ0FBQyxJQUFJLEdBQUcsSUFBSSxHQUFHLENBQUMsR0FBRyxDQUFDLENBQUM7SUFDM0IsQ0FBQzs7Ozs7O0lBTUQsV0FBVzs7Y0FDSCxLQUFLLEdBQUcsSUFBSSxHQUFHLENBQUMsSUFBSSxDQUFDO1FBQzNCLG9DQUFvQztRQUNwQyw4QkFBOEI7UUFDOUIsc0NBQXNDO1FBQ3RDLE9BQU8sS0FBSyxDQUFDO0lBQ2YsQ0FBQztDQUNGOzs7Ozs7SUE3REMsd0JBQTRCOzs7OztJQUM1QixvQkFBb0I7Ozs7O0lBQ3BCLHlCQUE4Qjs7Ozs7SUFDOUIsc0JBQXFCOzs7OztJQUNyQixxQkFBNkI7Ozs7O0lBQzdCLHdCQUFtQzs7Ozs7SUFDbkMsbUJBQWtCOzs7OztJQUNsQixxQkFBNkI7Ozs7O0lBQzdCLHVCQUFpQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENhY2hlU2VydmljZSB9IGZyb20gJy4vLi4vLi4vc2VydmljZXMvY2FjaGUvc2VydmljZXMvY2FjaGUuc2VydmljZSc7XHJcbmltcG9ydCB7IENvbW1hbmRSZWdpc3RyeSB9IGZyb20gJy4vY29tbWFuZC1yZWdpc3RyeSc7XHJcbmltcG9ydCB7IEV2ZW50QnVzIH0gZnJvbSAnLi4vZXZlbnRidXMvZXZlbnQtYnVzJztcclxuaW1wb3J0IHsgVXRpbCB9IGZyb20gJy4uL3V0aWwvdXRpbCc7XHJcbmltcG9ydCB7IFZpZXdSZWdpc3RyeSB9IGZyb20gJy4vdmlldy1yZWdpc3RyeSc7XHJcbmltcG9ydCB7IFdvcmtzcGFjZSB9IGZyb20gJy4vd29ya3NwYWNlJztcclxuaW1wb3J0IHsgR3NwRXZlbnRCdXMgfSBmcm9tICcuL2dzcC1ldmVudC1idXMnO1xyXG5pbXBvcnQgeyBJZGUgfSBmcm9tICcuL2lkZS9pZGUnO1xyXG5pbXBvcnQgeyBDb250ZXh0TWFuYWdlciB9IGZyb20gJy4vY29udGV4dC9jb250ZXh0JztcclxuXHJcbmV4cG9ydCBjbGFzcyBHU1Age1xyXG4gIHByaXZhdGUgcEV2ZW50QnVzOiBFdmVudEJ1cztcclxuICBwcml2YXRlIHBVdGlsOiBVdGlsO1xyXG4gIHByaXZhdGUgcFdvcmtzcGFjZTogV29ya3NwYWNlO1xyXG4gIHByaXZhdGUgcENvbmZpZzogYW55O1xyXG4gIHByaXZhdGUgcFZpZXdzOiBWaWV3UmVnaXN0cnk7XHJcbiAgcHJpdmF0ZSBwQ29tbWFuZHM6IENvbW1hbmRSZWdpc3RyeTtcclxuICBwcml2YXRlIHBJZGU6IElkZTtcclxuICBwcml2YXRlIHBDYWNoZTogQ2FjaGVTZXJ2aWNlO1xyXG4gIHByaXZhdGUgcENvbnRleHQ6IENvbnRleHRNYW5hZ2VyO1xyXG5cclxuICBnZXQgZXZlbnRCdXMoKTogRXZlbnRCdXMgeyByZXR1cm4gdGhpcy5wRXZlbnRCdXM7IH1cclxuICBnZXQgdXRpbCgpOiBVdGlsIHsgcmV0dXJuIHRoaXMucFV0aWw7IH1cclxuICBnZXQgd29ya3NwYWNlKCk6IFdvcmtzcGFjZSB7IHJldHVybiB0aGlzLnBXb3Jrc3BhY2U7IH1cclxuICBnZXQgdmlld3MoKTogVmlld1JlZ2lzdHJ5IHsgcmV0dXJuIHRoaXMucFZpZXdzOyB9XHJcbiAgZ2V0IGNvbW1hbmRzKCk6IENvbW1hbmRSZWdpc3RyeSB7IHJldHVybiB0aGlzLnBDb21tYW5kczsgfVxyXG4gIGdldCBpZGUoKTogSWRlIHsgcmV0dXJuIHRoaXMucElkZTsgfVxyXG4gIGdldCBjYWNoZSgpOiBDYWNoZVNlcnZpY2UgeyByZXR1cm4gdGhpcy5wQ2FjaGU7IH1cclxuICBnZXQgY29udGV4dCgpOiBDb250ZXh0TWFuYWdlciB7IHJldHVybiB0aGlzLnBDb250ZXh0OyB9XHJcblxyXG4gIGNvbnN0cnVjdG9yKHBhcmVudD86IEdTUCkge1xyXG4gICAgdGhpcy5wQ29uZmlnID0ge1xyXG4gICAgICBnZXQoa2V5KSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXNba2V5XTtcclxuICAgICAgfVxyXG4gICAgfTtcclxuICAgIGxldCBpZGU6IElkZTtcclxuICAgIGlmIChwYXJlbnQpIHtcclxuICAgICAgdGhpcy5wVmlld3MgPSBwYXJlbnQudmlld3M7XHJcbiAgICAgIHRoaXMucENvbW1hbmRzID0gcGFyZW50LmNvbW1hbmRzO1xyXG4gICAgICB0aGlzLnBFdmVudEJ1cyA9IHBhcmVudC5ldmVudEJ1cztcclxuICAgICAgdGhpcy5wVXRpbCA9IHBhcmVudC51dGlsO1xyXG4gICAgICB0aGlzLnBXb3Jrc3BhY2UgPSBwYXJlbnQud29ya3NwYWNlO1xyXG4gICAgICB0aGlzLnBDYWNoZSA9IHBhcmVudC5jYWNoZTtcclxuICAgICAgaWRlID0gcGFyZW50LmlkZTtcclxuICAgICAgY29uc3QgY3RvcjogYW55ID0gcGFyZW50LmNvbnRleHQuY29uc3RydWN0b3I7XHJcbiAgICAgIHRoaXMucENvbnRleHQgPSBuZXcgY3RvcigpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5wVmlld3MgPSBuZXcgVmlld1JlZ2lzdHJ5KHRoaXMpO1xyXG4gICAgICB0aGlzLnBDb21tYW5kcyA9IG5ldyBDb21tYW5kUmVnaXN0cnkoKTtcclxuICAgICAgdGhpcy5wRXZlbnRCdXMgPSBuZXcgR3NwRXZlbnRCdXMoKTtcclxuICAgICAgdGhpcy5wVXRpbCA9IG5ldyBVdGlsKCk7XHJcbiAgICAgIHRoaXMucFdvcmtzcGFjZSA9IG5ldyBXb3Jrc3BhY2Uoe1xyXG4gICAgICAgIGNvbmZpZzogdGhpcy5wQ29uZmlnLFxyXG4gICAgICAgIHZpZXdSZWdpc3RyeTogdGhpcy5wVmlld3NcclxuICAgICAgfSk7XHJcbiAgICAgIHRoaXMucENhY2hlID0gbmV3IENhY2hlU2VydmljZShudWxsKTtcclxuICAgIH1cclxuICAgIHRoaXMucElkZSA9IG5ldyBJZGUoaWRlKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEBkZXByZWNhdGVkIOeUseWtkOaooeWdl+eLrOiHquWIm+W7umdzcOWunuS+i++8jOS8oOWFpeeItuWunuS+i+S9nOS4uuWPguaVsOOAglxyXG4gICAqIOavj+S4qmlmcmFtZeaMgeacieS4gOS4queLrOacieeahGdzcOWunuS+i++8jOWFtuS4rWV2ZW50YnVz5YWx5Lqr77yMaWRl5LiN5YWx5LqrXHJcbiAgICovXHJcbiAgY3JlYXRlQ2hpbGQoKSB7XHJcbiAgICBjb25zdCBjaGlsZCA9IG5ldyBHU1AodGhpcyk7XHJcbiAgICAvLyBjaGlsZC5wRXZlbnRCdXMgPSB0aGlzLnBFdmVudEJ1cztcclxuICAgIC8vIGNoaWxkLnBWaWV3cyA9IHRoaXMucFZpZXdzO1xyXG4gICAgLy8gY2hpbGQucFdvcmtzcGFjZSA9IHRoaXMucFdvcmtzcGFjZTtcclxuICAgIHJldHVybiBjaGlsZDtcclxuICB9XHJcbn1cclxuIl19