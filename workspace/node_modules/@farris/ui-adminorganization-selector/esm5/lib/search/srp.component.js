/**
 * @fileoverview added by tsickle
 * Generated from: lib/search/srp.component.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, Input, EventEmitter, Output, ChangeDetectorRef, Injector } from '@angular/core';
import * as _ from 'lodash-es';
import { noDataImg } from '../../assets/resource';
import { ApiService } from '../../utils/api.service';
import { CommonUtil } from '../../utils/common.tool';
import { FavoritesTool } from '../../utils/favorites.tool';
import { ChangeType, ValueType, CompareType, RelationType } from '../../utils/index.type';
import { StateMgrTool } from '../../utils/state.mgr.tool';
var SearchComponent = /** @class */ (function () {
    function SearchComponent(apiService, favoritesTool, stateMgr, cdr, injector) {
        this.apiService = apiService;
        this.favoritesTool = favoritesTool;
        this.stateMgr = stateMgr;
        this.cdr = cdr;
        this.injector = injector;
        this.closePanelChange = new EventEmitter();
        this.allChecked = false;
        this.selections = [];
        this.cloneSelections = [];
        this.allIndexId = 'allIndexId';
        this.noDataImg = noDataImg;
        this.totalItems = [];
        this.perPageItems = [];
        this.favoritesList = [];
        this.pageIndex = 1;
        this.pageTotal = 0;
        this.itemTotalCount = 0;
        this.orgTypeId = '9edf25d1-b991-4dde-90b9-30145422d24d';
    }
    Object.defineProperty(SearchComponent.prototype, "onSearch", {
        set: /**
         * @param {?} value
         * @return {?}
         */
        function (value) {
            if (!!value) {
                this.perPageItems = [];
                this.cdr.detectChanges();
                this.loadSearchResult();
            }
            else {
                this.itemTotalCount = 0;
                this.totalItems = [];
            }
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    SearchComponent.prototype.ngOnDestroy = /**
     * @return {?}
     */
    function () {
        this.selectionsSub.unsubscribe();
        if (this.enableFavorites) {
            this.favoritesSub.unsubscribe();
        }
    };
    /**
     * @return {?}
     */
    SearchComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        if (this.enableFavorites) {
            this.favoritesSub = this.favoritesTool.favoritesSubject.subscribe((/**
             * @param {?} data
             * @return {?}
             */
            function (data) {
                _this.favoritesList = data;
                _this.setFavorites();
            }));
        }
        this.selectionsSub = this.stateMgr.selectionsSubject.subscribe((/**
         * @param {?} data
         * @return {?}
         */
        function (data) {
            if (data.changeType === ChangeType.ValueChanged) {
                _this.selections = _.cloneDeep(data.value);
            }
            else if (data.changeType === ChangeType.Remove) {
                _this.unSelectLine(data.value);
            }
            else if (data.changeType === ChangeType.Append) {
                _this.selectLine(data.value);
            }
            _this.toggleChecked();
            _this.cdr.detectChanges();
        }));
    };
    /**
     * @return {?}
     */
    SearchComponent.prototype.ngAfterViewInit = /**
     * @return {?}
     */
    function () {
    };
    /**
     * @private
     * @return {?}
     */
    SearchComponent.prototype.setFavorites = /**
     * @private
     * @return {?}
     */
    function () {
        var _this = this;
        this.perPageItems.forEach((/**
         * @param {?} item
         * @return {?}
         */
        function (item) {
            if (CommonUtil.findIndex(item['id'], 'id', _this.favoritesList) !== -1) {
                item.inFavorites = true;
            }
            else {
                item.inFavorites = false;
            }
        }));
    };
    /**
     * @param {?} dir
     * @param {?} num
     * @return {?}
     */
    SearchComponent.prototype.turnOverPage = /**
     * @param {?} dir
     * @param {?} num
     * @return {?}
     */
    function (dir, num) {
        if ((dir === 'pre' && this.pageIndex === 1) || (dir === 'next' && this.pageIndex === this.pageTotal)) {
            return;
        }
        this.pageIndex = this.pageIndex + num;
        this.switchPage({ pageIndex: this.pageIndex });
    };
    /**
     * @param {?} inputEl
     * @param {?} maxNumber
     * @return {?}
     */
    SearchComponent.prototype.beforePageIndexChange = /**
     * @param {?} inputEl
     * @param {?} maxNumber
     * @return {?}
     */
    function (inputEl, maxNumber) {
        /** @type {?} */
        var target = (/** @type {?} */ (inputEl.target));
        /** @type {?} */
        var currentPageNumber = Number(target.value);
        if (currentPageNumber > maxNumber) {
            target.value = maxNumber;
        }
        else {
            if (currentPageNumber < 1) {
                target.value = 1;
            }
        }
        this.pageIndex = Number(target.value);
    };
    /**
     * @return {?}
     */
    SearchComponent.prototype.closePanel = /**
     * @return {?}
     */
    function () {
        this.totalItems = [];
        this.perPageItems = [];
        this.itemTotalCount = 0;
        this.pageTotal = 0;
        this.closePanelChange.emit(true);
    };
    /**
     * @return {?}
     */
    SearchComponent.prototype.toggleAll = /**
     * @return {?}
     */
    function () {
        if (!this.allChecked) {
            this.checkAll();
        }
        else {
            this.unCheckAll();
        }
        this.emitSelections(this.selections, ChangeType.ValueChanged);
    };
    /**
     * @param {?} data
     * @param {?} e
     * @return {?}
     */
    SearchComponent.prototype.toggleOne = /**
     * @param {?} data
     * @param {?} e
     * @return {?}
     */
    function (data, e) {
        if (data.checked) {
            if (this.multiSelect) {
                this.emitSelections(data, ChangeType.Remove);
            }
            else {
                this.emitSelections([]);
            }
        }
        else {
            if (this.multiSelect) {
                this.emitSelections(data, ChangeType.Append);
            }
            else {
                this.emitSelections(new Array(data));
            }
        }
        e.preventDefault();
    };
    /**
     * 用于数据展示
     */
    /**
     * 用于数据展示
     * @return {?}
     */
    SearchComponent.prototype.loadSearchResult = /**
     * 用于数据展示
     * @return {?}
     */
    function () {
        var _this = this;
        /** @type {?} */
        var queryFilter = {
            filters: [
                {
                    'FilterField': 'abbreviation',
                    'Compare': CompareType.Like,
                    'Value': this.searchText,
                    'Relation': this.onlyDisplayCompany ? RelationType.And : RelationType.Empty,
                    'Expresstype': ValueType.Value,
                }
            ],
            sortorders: [
                {
                    'SortField': 'sortorder',
                    'SortType': 0,
                }
            ],
        };
        if (this.onlyDisplayCompany) {
            queryFilter.filters.push({
                'FilterField': 'orgType',
                'Compare': CompareType.Equal,
                'Value': this.orgTypeId,
                'Relation': RelationType.Empty,
                'Expresstype': ValueType.Value,
            });
        }
        this.apiService.getOrganizationsWithFilter(queryFilter).subscribe((/**
         * @param {?} res
         * @return {?}
         */
        function (res) {
            if (!res || !res.length) {
                return;
            }
            if (_this.notGetStopOrg) {
                res = res.filter((/**
                 * @param {?} org
                 * @return {?}
                 */
                function (org) { return !org['disabled']; }));
            }
            _this.totalItems = res;
            _this.itemTotalCount = res.length;
            _this.pageTotal = Math.ceil(_this.itemTotalCount / _this.pageSize);
            _this.switchPage({ pageIndex: 1 });
            _this.toggleChecked();
            _this.cdr.detectChanges();
        }));
    };
    /**
     * @param {?} pageInfo
     * @return {?}
     */
    SearchComponent.prototype.switchPage = /**
     * @param {?} pageInfo
     * @return {?}
     */
    function (pageInfo) {
        var _this = this;
        if (!pageInfo || pageInfo.pageIndex < 1) {
            return;
        }
        /** @type {?} */
        var startIndex = (pageInfo.pageIndex - 1) * this.pageSize;
        /** @type {?} */
        var endIndex = startIndex + this.pageSize;
        this.perPageItems = this.totalItems.slice(startIndex, endIndex);
        this.perPageItems.forEach((/**
         * @param {?} res
         * @return {?}
         */
        function (res) {
            /** @type {?} */
            var indexId = CommonUtil.newGuid();
            res.checked = false;
            res.inFavorites = false;
            res.indexId = indexId;
            if (CommonUtil.findIndex(res['id'], 'id', _this.selections) !== -1) {
                res.checked = true;
            }
            if (CommonUtil.findIndex(res['id'], 'id', _this.favoritesList) !== -1) {
                res.inFavorites = true;
            }
        }));
        this.perPageItems = this.perPageItems.slice();
    };
    /**
     * 全选后处理
     * @param dataArr 全选的值
     */
    /**
     * 全选后处理
     * @return {?}
     */
    SearchComponent.prototype.checkAll = /**
     * 全选后处理
     * @return {?}
     */
    function () {
        var _this = this;
        this.perPageItems.forEach((/**
         * @param {?} item
         * @return {?}
         */
        function (item) {
            _this._insertOneIntoSelections(item);
            item.checked = true;
        }));
    };
    /**
     * 全部取消
     * @param dataArr 取消的数据
     * @returns void
     */
    /**
     * 全部取消
     * @return {?} void
     */
    SearchComponent.prototype.unCheckAll = /**
     * 全部取消
     * @return {?} void
     */
    function () {
        var _this = this;
        this.perPageItems.forEach((/**
         * @param {?} item
         * @return {?}
         */
        function (item) {
            _this.selections.forEach((/**
             * @param {?} selection
             * @param {?} index
             * @return {?}
             */
            function (selection, index) {
                if (item['id'] === selection['id']) {
                    _this.selections.splice(index, 1);
                }
            }));
            item.checked = false;
        }));
    };
    /**
     * 当前行选中
     * @param data 当前行的数据（）
     */
    /**
     * 当前行选中
     * @private
     * @param {?} data 当前行的数据（）
     * @return {?}
     */
    SearchComponent.prototype.selectLine = /**
     * 当前行选中
     * @private
     * @param {?} data 当前行的数据（）
     * @return {?}
     */
    function (data) {
        if (this.multiSelect) {
            this._insertOneIntoSelections(data);
        }
        else {
            this.selections = [];
            this.perPageItems.forEach((/**
             * @param {?} item
             * @return {?}
             */
            function (item) {
                if (item.checked) {
                    item.checked = false;
                }
            }));
            this._insertOneIntoSelections(data);
        }
        if (this.isAllChecked()) {
            this.allChecked = true;
        }
    };
    /**
     * 单选取消选中
     * @param data 取消选中行
     */
    /**
     * 单选取消选中
     * @private
     * @param {?} data 取消选中行
     * @return {?}
     */
    SearchComponent.prototype.unSelectLine = /**
     * 单选取消选中
     * @private
     * @param {?} data 取消选中行
     * @return {?}
     */
    function (data) {
        /** @type {?} */
        var index = CommonUtil.findIndex(data['id'], 'id', this.selections);
        if (index > -1) {
            this.selections.splice(index, 1);
        }
        this.setChecked(data, false);
        if (this.allChecked) {
            this.allChecked = false;
        }
    };
    /**
     * @private
     * @param {?} data
     * @param {?} checked
     * @return {?}
     */
    SearchComponent.prototype.setChecked = /**
     * @private
     * @param {?} data
     * @param {?} checked
     * @return {?}
     */
    function (data, checked) {
        /** @type {?} */
        var itemIndex = CommonUtil.findIndex(data['id'], 'id', this.perPageItems);
        if (itemIndex > -1) {
            this.perPageItems[itemIndex].checked = checked;
        }
    };
    /**
     * @private
     * @param {?} selections
     * @param {?=} changeType
     * @param {?=} from
     * @return {?}
     */
    SearchComponent.prototype.emitSelections = /**
     * @private
     * @param {?} selections
     * @param {?=} changeType
     * @param {?=} from
     * @return {?}
     */
    function (selections, changeType, from) {
        if (changeType === void 0) { changeType = ChangeType.ValueChanged; }
        if (from === void 0) { from = 'search'; }
        this.stateMgr.emitSelections(selections, changeType, from);
    };
    /**
     * @param {?} e
     * @param {?} item
     * @return {?}
     */
    SearchComponent.prototype.toggleFavorites = /**
     * @param {?} e
     * @param {?} item
     * @return {?}
     */
    function (e, item) {
        this.favoritesTool.toggleFavorites(e, item);
    };
    /**
     * 选中并插入当前行数据到右侧
     * @param data 当前行的数据
     * @param collection 暂存当前数据的集合
     */
    /**
     * 选中并插入当前行数据到右侧
     * @param {?} data 当前行的数据
     * @return {?}
     */
    SearchComponent.prototype._insertOneIntoSelections = /**
     * 选中并插入当前行数据到右侧
     * @param {?} data 当前行的数据
     * @return {?}
     */
    function (data) {
        // 如果当前数据已经移入右侧数据，则返回。
        if (CommonUtil.findIndex(data['id'], 'id', this.selections) > -1) {
            return;
        }
        this.setChecked(data, true);
        this.selections.push(data);
        this.selections = this.selections.slice();
    };
    /**
     * 翻页检查：人员展示区的勾选状态与已选人员区是否对应
     */
    /**
     * 翻页检查：人员展示区的勾选状态与已选人员区是否对应
     * @return {?}
     */
    SearchComponent.prototype.toggleChecked = /**
     * 翻页检查：人员展示区的勾选状态与已选人员区是否对应
     * @return {?}
     */
    function () {
        var _this = this;
        this.perPageItems.forEach((/**
         * @param {?} item
         * @return {?}
         */
        function (item) {
            if (CommonUtil.findIndex(item['id'], 'id', _this.selections) > -1) {
                item.checked = true;
            }
            else {
                item.checked = false;
            }
        }));
        if (this.isAllChecked()) {
            this.allChecked = true;
        }
        else {
            this.allChecked = false;
        }
    };
    /**
     * @private
     * @return {?}
     */
    SearchComponent.prototype.isAllChecked = /**
     * @private
     * @return {?}
     */
    function () {
        var _this = this;
        /** @type {?} */
        var count = 0;
        /** @type {?} */
        var allChecked = false;
        this.perPageItems.forEach((/**
         * @param {?} item
         * @return {?}
         */
        function (item) {
            _this.selections.forEach((/**
             * @param {?} selection
             * @return {?}
             */
            function (selection) {
                if (item['id'] === selection['id']) {
                    count += 1;
                }
            }));
        }));
        if (this.perPageItems.length === count && count > 0) {
            allChecked = true;
        }
        return allChecked;
    };
    /**
     * @param {?} index
     * @param {?} item
     * @return {?}
     */
    SearchComponent.prototype.trackByFn = /**
     * @param {?} index
     * @param {?} item
     * @return {?}
     */
    function (index, item) {
        return index;
    };
    SearchComponent.decorators = [
        { type: Component, args: [{
                    selector: 'lib-search',
                    template: "<div class=\"os-card\">\r\n    <div class=\"os-card-title\">\r\n        <span>{{'organizationSelector.searchPage.firstResultText' | locale}}{{itemTotalCount}}{{'organizationSelector.searchPage.lastResultText' | locale}}</span>\r\n        <span class=\"f-icon modal_close\" (click)=\"closePanel()\" title=\"{{'organizationSelector.searchPage.close' | locale}}\"></span>\r\n    </div>\r\n    <perfect-scrollbar>\r\n        <div class=\"os-card-content\">\r\n            <div *ngFor=\"let data of perPageItems; let i = index;trackBy: trackByFn\" class=\"s-selectedPerson\">\r\n                <div class=\"custom-control custom-checkbox mb-2\">\r\n                    <input class=\"custom-control-input\" [id]=\"data.indexId\" type=\"checkbox\" [checked]=\"data.checked\">\r\n                    <label class=\"custom-control-label\" [for]=\"data.indexId\" (click)=\"toggleOne(data, $event)\">\r\n                        <div class=\"src-item-container\">\r\n                            <div class=\"src-item-content\">\r\n                                <p class=\"os-card-content-title\" title=\"{{data.name}}\">\r\n                                    {{data.name}}</p>\r\n                                <p class=\"os-card-content-orgpath\" title=\"{{data.orgAllPath}}\">\r\n                                    {{data.orgAllPath}}</p>\r\n                            </div>\r\n                        </div>\r\n                    </label>\r\n                </div>\r\n                <span class=\"f-icon f-icon-star\" *ngIf=\"enableFavorites\" [class.default-light-color]=\"data.inFavorites\"\r\n                    [class.default-dark-color]=\"!data.inFavorites\" (click)=\"toggleFavorites($event, data)\"></span>\r\n            </div>\r\n            <div *ngIf=\"perPageItems.length===0\" [ngStyle]=\"{'background-image': noDataImg}\" class=\"fp-os-card-nodata\">\r\n                {{'organizationSelector.tabCommon.noOrgData' | locale}}</div>\r\n        </div>\r\n    </perfect-scrollbar>\r\n    <div class=\"pagination-container\" *ngIf=\"perPageItems.length!==0\">\r\n        <ul class=\"ngx-pagination pagination pager-viewmode-simple\">\r\n            <li class=\"page-item d-flex flex-fill\"></li>\r\n            <li class=\"page-item\" [class.disabled]=\"pageIndex === 1\" (click)=\"turnOverPage('pre', -1)\">\r\n                <span class=\"page-link border-0\">\r\n                    <span class=\"f-icon f-page-pre\"></span>\r\n                </span>\r\n            </li>\r\n            <li class=\"page-item\">\r\n                <input id=\"farris-datagrid-gotopagenumber\" min=\"1\" type=\"number\" max=\"{{pageTotal}}\"\r\n                    [(ngModel)]=\"pageIndex\" style=\"width: 38px;\" (keyup.enter)=\"switchPage({pageIndex: pageIndex})\"\r\n                    (input)=\"beforePageIndexChange($event, pageTotal)\">\r\n            </li>\r\n            <li class=\"page-item page-separator\" style=\"margin-left: 10px\"> / </li>\r\n            <li class=\"page-item page-total\" style=\"margin-left: 5px\">\r\n                <span style=\"font-size: 16px; font-weight: 600;\"> {{pageTotal}}</span>\r\n            </li>\r\n            <li class=\"page-item\" [class.disabled]=\"pageIndex === pageTotal\" (click)=\"turnOverPage('next', 1)\">\r\n                <a class=\"page-link border-0\">\r\n                    <span class=\"f-icon f-page-next\"></span>\r\n                </a>\r\n            </li>\r\n        </ul>\r\n    </div>\r\n</div>",
                    styles: [":host{position:absolute;z-index:100;background:#fff;top:44px;right:0;left:0;bottom:0;display:-webkit-box;display:flex}.os-card{display:-webkit-box;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-direction:column;-webkit-box-flex:1;flex:1;overflow:hidden}.os-card .s-selectedPerson:hover{background:#eef5ff;border-radius:5px}.os-card .os-card-content{padding-top:3px;clear:both}.os-card .os-card-content .src-item-container{display:-webkit-box;display:flex;height:32px;margin:-21px 0 0 15px}.os-card .os-card-content .src-item-content{margin-left:11px;margin-top:-2px;padding-right:10px;overflow:hidden}.os-card .s-selectedPerson{min-width:240px;float:left;width:calc(50% - 6px);position:relative;height:40px;padding:5px 12px;margin:0 3px 10px}.os-card .s-selectedPerson .f-icon-star{position:absolute;top:13px;right:15px;font-size:14px}.os-card .s-selectedPerson .default-light-color{color:#f7b500}.os-card .s-selectedPerson .default-dark-color{color:#d8dce6}.os-card .k-checkbox-label::after,.os-card .k-checkbox-label::before{top:10px;font-size:16px;width:14px;height:14px}.os-card .fp-os-card-nodata{width:100px;height:100px;text-align:center;background-repeat:no-repeat;background-size:contain;color:#b4bccc;padding-top:110px;position:absolute;left:50%;top:50%;margin:-70px 0 0 -50px}.os-card .os-card-content-title{margin:0;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;font-size:13px}.os-card .os-card-content-orgpath{margin:0;font-size:12px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;color:#c7ccd7}.os-card .os-card-title{display:-webkit-box;display:flex;-webkit-box-pack:justify;justify-content:space-between;padding:15px;font-size:14px}.os-card .os-card-title .custom-control{margin:10px 0 0 15px;line-height:35px}.os-card .os-card-title .title-clearall{margin:10px 15px 0 0;color:#2a87ff;cursor:pointer;line-height:35px}.os-card .s-selectedPerson .custom-control-label::before{top:1px}.os-card .os-card-title .f-icon{color:#878d99;cursor:pointer}"]
                }] }
    ];
    /** @nocollapse */
    SearchComponent.ctorParameters = function () { return [
        { type: ApiService },
        { type: FavoritesTool },
        { type: StateMgrTool },
        { type: ChangeDetectorRef },
        { type: Injector }
    ]; };
    SearchComponent.propDecorators = {
        primaryField: [{ type: Input }],
        multiSelect: [{ type: Input }],
        enableFavorites: [{ type: Input }],
        searchText: [{ type: Input }],
        absOrgType: [{ type: Input }],
        notGetStopOrg: [{ type: Input }],
        pageSize: [{ type: Input }],
        onlyDisplayCompany: [{ type: Input }],
        onlyCurrentAdminOrg: [{ type: Input }],
        onSearch: [{ type: Input }],
        closePanelChange: [{ type: Output }]
    };
    return SearchComponent;
}());
export { SearchComponent };
if (false) {
    /** @type {?} */
    SearchComponent.prototype.primaryField;
    /** @type {?} */
    SearchComponent.prototype.multiSelect;
    /** @type {?} */
    SearchComponent.prototype.enableFavorites;
    /** @type {?} */
    SearchComponent.prototype.searchText;
    /** @type {?} */
    SearchComponent.prototype.absOrgType;
    /** @type {?} */
    SearchComponent.prototype.notGetStopOrg;
    /** @type {?} */
    SearchComponent.prototype.pageSize;
    /** @type {?} */
    SearchComponent.prototype.onlyDisplayCompany;
    /** @type {?} */
    SearchComponent.prototype.onlyCurrentAdminOrg;
    /** @type {?} */
    SearchComponent.prototype.closePanelChange;
    /** @type {?} */
    SearchComponent.prototype.allChecked;
    /** @type {?} */
    SearchComponent.prototype.columns;
    /** @type {?} */
    SearchComponent.prototype.selections;
    /** @type {?} */
    SearchComponent.prototype.cloneSelections;
    /** @type {?} */
    SearchComponent.prototype.allIndexId;
    /** @type {?} */
    SearchComponent.prototype.noDataImg;
    /** @type {?} */
    SearchComponent.prototype.totalItems;
    /** @type {?} */
    SearchComponent.prototype.perPageItems;
    /** @type {?} */
    SearchComponent.prototype.favoritesList;
    /** @type {?} */
    SearchComponent.prototype.pageIndex;
    /** @type {?} */
    SearchComponent.prototype.pageTotal;
    /** @type {?} */
    SearchComponent.prototype.itemTotalCount;
    /**
     * @type {?}
     * @private
     */
    SearchComponent.prototype.orgTypeId;
    /**
     * @type {?}
     * @private
     */
    SearchComponent.prototype.selectionsSub;
    /**
     * @type {?}
     * @private
     */
    SearchComponent.prototype.favoritesSub;
    /**
     * @type {?}
     * @private
     */
    SearchComponent.prototype.apiService;
    /**
     * @type {?}
     * @private
     */
    SearchComponent.prototype.favoritesTool;
    /**
     * @type {?}
     * @private
     */
    SearchComponent.prototype.stateMgr;
    /**
     * @type {?}
     * @private
     */
    SearchComponent.prototype.cdr;
    /**
     * @type {?}
     * @private
     */
    SearchComponent.prototype.injector;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3JwLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BmYXJyaXMvdWktYWRtaW5vcmdhbml6YXRpb24tc2VsZWN0b3IvIiwic291cmNlcyI6WyJsaWIvc2VhcmNoL3NycC5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQSxPQUFPLEVBQ0gsU0FBUyxFQUFFLEtBQUssRUFBRSxZQUFZLEVBQUUsTUFBTSxFQUF5QixpQkFBaUIsRUFBdUIsUUFBUSxFQUNsSCxNQUFNLGVBQWUsQ0FBQztBQUN2QixPQUFPLEtBQUssQ0FBQyxNQUFNLFdBQVcsQ0FBQztBQUUvQixPQUFPLEVBQUUsU0FBUyxFQUFFLE1BQU0sdUJBQXVCLENBQUM7QUFDbEQsT0FBTyxFQUFFLFVBQVUsRUFBRSxNQUFNLHlCQUF5QixDQUFDO0FBQ3JELE9BQU8sRUFBRSxVQUFVLEVBQUUsTUFBTSx5QkFBeUIsQ0FBQztBQUNyRCxPQUFPLEVBQUUsYUFBYSxFQUFFLE1BQU0sNEJBQTRCLENBQUM7QUFDM0QsT0FBTyxFQUFFLFVBQVUsRUFBbUIsU0FBUyxFQUFFLFdBQVcsRUFBRSxZQUFZLEVBQUUsTUFBTSx3QkFBd0IsQ0FBQztBQUMzRyxPQUFPLEVBQUUsWUFBWSxFQUFFLE1BQU0sNEJBQTRCLENBQUM7QUFFMUQ7SUE4Q0kseUJBQ1ksVUFBc0IsRUFDdEIsYUFBNEIsRUFDNUIsUUFBc0IsRUFDdEIsR0FBc0IsRUFDdEIsUUFBa0I7UUFKbEIsZUFBVSxHQUFWLFVBQVUsQ0FBWTtRQUN0QixrQkFBYSxHQUFiLGFBQWEsQ0FBZTtRQUM1QixhQUFRLEdBQVIsUUFBUSxDQUFjO1FBQ3RCLFFBQUcsR0FBSCxHQUFHLENBQW1CO1FBQ3RCLGFBQVEsR0FBUixRQUFRLENBQVU7UUF6QnBCLHFCQUFnQixHQUFHLElBQUksWUFBWSxFQUFXLENBQUM7UUFFekQsZUFBVSxHQUFHLEtBQUssQ0FBQztRQUVuQixlQUFVLEdBQVUsRUFBRSxDQUFDO1FBRXZCLG9CQUFlLEdBQUcs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QUFLOzhCQUNMLEtBQUs7a0NBQ0wsS0FBSzs2QkFDTCxLQUFLOzZCQUNMLEtBQUs7Z0NBQ0wsS0FBSzsyQkFDTCxLQUFLO3FDQUNMLEtBQUs7c0NBQ0wsS0FBSzsyQkFDTCxLQUFLO21DQVVMLE1BQU07O0lBdVVYLHNCQUFDO0NBQUEsQUFqV0QsSUFpV0M7U0E1VlksZUFBZTs7O0lBRXhCLHVDQUE4Qjs7SUFDOUIsc0NBQThCOztJQUM5QiwwQ0FBa0M7O0lBQ2xDLHFDQUE0Qjs7SUFDNUIscUNBQTRCOztJQUM1Qix3Q0FBZ0M7O0lBQ2hDLG1DQUEwQjs7SUFDMUIsNkNBQXFDOztJQUNyQyw4Q0FBc0M7O0lBV3RDLDJDQUF5RDs7SUFFekQscUNBQW1COztJQUNuQixrQ0FBYTs7SUFDYixxQ0FBdUI7O0lBRXZCLDBDQUFxQjs7SUFDckIscUNBQTBCOztJQUMxQixvQ0FBc0I7O0lBQ3RCLHFDQUFnQjs7SUFDaEIsdUNBQWtCOztJQUNsQix3Q0FBbUI7O0lBQ25CLG9DQUFjOztJQUNkLG9DQUFzQjs7SUFDdEIseUNBQW1COzs7OztJQUNuQixvQ0FBMkQ7Ozs7O0lBRTNELHdDQUFvQzs7Ozs7SUFDcEMsdUNBQW1DOzs7OztJQUcvQixxQ0FBOEI7Ozs7O0lBQzlCLHdDQUFvQzs7Ozs7SUFDcEMsbUNBQThCOzs7OztJQUM5Qiw4QkFBOEI7Ozs7O0lBQzlCLG1DQUEwQiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XHJcbiAgICBDb21wb25lbnQsIElucHV0LCBFdmVudEVtaXR0ZXIsIE91dHB1dCwgT25Jbml0LCBBZnRlclZpZXdJbml0LCBDaGFuZ2VEZXRlY3RvclJlZiwgT3B0aW9uYWwsIE9uRGVzdHJveSwgSW5qZWN0b3JcclxufSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0ICogYXMgXyBmcm9tICdsb2Rhc2gtZXMnO1xyXG5pbXBvcnQgeyBTdWJzY3JpcHRpb24gfSBmcm9tICdyeGpzJztcclxuaW1wb3J0IHsgbm9EYXRhSW1nIH0gZnJvbSAnLi4vLi4vYXNzZXRzL3Jlc291cmNlJztcclxuaW1wb3J0IHsgQXBpU2VydmljZSB9IGZyb20gJy4uLy4uL3V0aWxzL2FwaS5zZXJ2aWNlJztcclxuaW1wb3J0IHsgQ29tbW9uVXRpbCB9IGZyb20gJy4uLy4uL3V0aWxzL2NvbW1vbi50b29sJztcclxuaW1wb3J0IHsgRmF2b3JpdGVzVG9vbCB9IGZyb20gJy4uLy4uL3V0aWxzL2Zhdm9yaXRlcy50b29sJztcclxuaW1wb3J0IHsgQ2hhbmdlVHlwZSwgT3JnUmVxdWVzdFBhcmFtLCBWYWx1ZVR5cGUsIENvbXBhcmVUeXBlLCBSZWxhdGlvblR5cGUgfSBmcm9tICcuLi8uLi91dGlscy9pbmRleC50eXBlJztcclxuaW1wb3J0IHsgU3RhdGVNZ3JUb29sIH0gZnJvbSAnLi4vLi4vdXRpbHMvc3RhdGUubWdyLnRvb2wnO1xyXG5cclxuQENvbXBvbmVudCh7XHJcbiAgICBzZWxlY3RvcjogJ2xpYi1zZWFyY2gnLFxyXG4gICAgdGVtcGxhdGVVcmw6ICcuL3NycC5jb21wb25lbnQuaHRtbCcsXHJcbiAgICBzdHlsZVVybHM6IFsnLi9zcnAuY29tcG9uZW50LmNzcyddLFxyXG59KVxyXG5leHBvcnQgY2xhc3MgU2VhcmNoQ29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0LCBBZnRlclZpZXdJbml0LCBPbkRlc3Ryb3kge1xyXG5cclxuICAgIEBJbnB1dCgpIHByaW1hcnlGaWVsZDogc3RyaW5nO1xyXG4gICAgQElucHV0KCkgbXVsdGlTZWxlY3Q6IGJvb2xlYW47XHJcbiAgICBASW5wdXQoKSBlbmFibGVGYXZvcml0ZXM6IGJvb2xlYW47XHJcbiAgICBASW5wdXQoKSBzZWFyY2hUZXh0OiBzdHJpbmc7XHJcbiAgICBASW5wdXQoKSBhYnNPcmdUeXBlOiBzdHJpbmc7XHJcbiAgICBASW5wdXQoKSBub3RHZXRTdG9wT3JnOiBib29sZWFuO1xyXG4gICAgQElucHV0KCkgcGFnZVNpemU6IG51bWJlcjtcclxuICAgIEBJbnB1dCgpIG9ubHlEaXNwbGF5Q29tcGFueTogYm9vbGVhbjtcclxuICAgIEBJbnB1dCgpIG9ubHlDdXJyZW50QWRtaW5Pcmc6IGJvb2xlYW47XHJcbiAgICBASW5wdXQoKSBzZXQgb25TZWFyY2godmFsdWU6IGFueSkge1xyXG4gICAgICAgIGlmICghIXZhbHVlKSB7XHJcbiAgICAgICAgICAgIHRoaXMucGVyUGFnZUl0ZW1zID0gW107XHJcbiAgICAgICAgICAgIHRoaXMuY2RyLmRldGVjdENoYW5nZXMoKTtcclxuICAgICAgICAgICAgdGhpcy5sb2FkU2VhcmNoUmVzdWx0KCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5pdGVtVG90YWxDb3VudCA9IDA7XHJcbiAgICAgICAgICAgIHRoaXMudG90YWxJdGVtcyA9IFtdO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIEBPdXRwdXQoKSBjbG9zZVBhbmVsQ2hhbmdlID0gbmV3IEV2ZW50RW1pdHRlcjxib29sZWFuPigpO1xyXG5cclxuICAgIGFsbENoZWNrZWQgPSBmYWxzZTtcclxuICAgIGNvbHVtbnM6IGFueTtcclxuICAgIHNlbGVjdGlvbnM6IGFueVtdID0gW107XHJcblxyXG4gICAgY2xvbmVTZWxlY3Rpb25zID0gW107XHJcbiAgICBhbGxJbmRleElkID0gJ2FsbEluZGV4SWQnO1xyXG4gICAgbm9EYXRhSW1nID0gbm9EYXRhSW1nO1xyXG4gICAgdG90YWxJdGVtcyA9IFtdO1xyXG4gICAgcGVyUGFnZUl0ZW1zID0gW107XHJcbiAgICBmYXZvcml0ZXNMaXN0ID0gW107XHJcbiAgICBwYWdlSW5kZXggPSAxO1xyXG4gICAgcGFnZVRvdGFsOiBudW1iZXIgPSAwO1xyXG4gICAgaXRlbVRvdGFsQ291bnQgPSAwO1xyXG4gICAgcHJpdmF0ZSBvcmdUeXBlSWQgPSAnOWVkZjI1ZDEtYjk5MS00ZGRlLTkwYjktMzAxNDU0MjJkMjRkJztcclxuXHJcbiAgICBwcml2YXRlIHNlbGVjdGlvbnNTdWI6IFN1YnNjcmlwdGlvbjtcclxuICAgIHByaXZhdGUgZmF2b3JpdGVzU3ViOiBTdWJzY3JpcHRpb247XHJcblxyXG4gICAgY29uc3RydWN0b3IoXHJcbiAgICAgICAgcHJpdmF0ZSBhcGlTZXJ2aWNlOiBBcGlTZXJ2aWNlLFxyXG4gICAgICAgIHByaXZhdGUgZmF2b3JpdGVzVG9vbDogRmF2b3JpdGVzVG9vbCxcclxuICAgICAgICBwcml2YXRlIHN0YXRlTWdyOiBTdGF0ZU1nclRvb2wsXHJcbiAgICAgICAgcHJpdmF0ZSBjZHI6IENoYW5nZURldGVjdG9yUmVmLFxyXG4gICAgICAgIHByaXZhdGUgaW5qZWN0b3I6IEluamVjdG9yXHJcbiAgICApIHtcclxuICAgIH1cclxuXHJcbiAgICBuZ09uRGVzdHJveSgpOiB2b2lkIHtcclxuICAgICAgICB0aGlzLnNlbGVjdGlvbnNTdWIudW5zdWJzY3JpYmUoKTtcclxuICAgICAgICBpZiAodGhpcy5lbmFibGVGYXZvcml0ZXMpIHtcclxuICAgICAgICAgICAgdGhpcy5mYXZvcml0ZXNTdWIudW5zdWJzY3JpYmUoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgbmdPbkluaXQoKTogdm9pZCB7XHJcbiAgICAgICAgaWYgKHRoaXMuZW5hYmxlRmF2b3JpdGVzKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZmF2b3JpdGVzU3ViID0gdGhpcy5mYXZvcml0ZXNUb29sLmZhdm9yaXRlc1N1YmplY3Quc3Vic2NyaWJlKGRhdGEgPT4ge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5mYXZvcml0ZXNMaXN0ID0gZGF0YTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0RmF2b3JpdGVzKCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnNlbGVjdGlvbnNTdWIgPSB0aGlzLnN0YXRlTWdyLnNlbGVjdGlvbnNTdWJqZWN0LnN1YnNjcmliZShkYXRhID0+IHtcclxuICAgICAgICAgICAgaWYgKGRhdGEuY2hhbmdlVHlwZSA9PT0gQ2hhbmdlVHlwZS5WYWx1ZUNoYW5nZWQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0aW9ucyA9IF8uY2xvbmVEZWVwKGRhdGEudmFsdWUpO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKGRhdGEuY2hhbmdlVHlwZSA9PT0gQ2hhbmdlVHlwZS5SZW1vdmUpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMudW5TZWxlY3RMaW5lKGRhdGEudmFsdWUpO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKGRhdGEuY2hhbmdlVHlwZSA9PT0gQ2hhbmdlVHlwZS5BcHBlbmQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0TGluZShkYXRhLnZhbHVlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLnRvZ2dsZUNoZWNrZWQoKTtcclxuICAgICAgICAgICAgdGhpcy5jZHIuZGV0ZWN0Q2hhbmdlcygpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIG5nQWZ0ZXJWaWV3SW5pdCgpOiB2b2lkIHtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBzZXRGYXZvcml0ZXMoKSB7XHJcbiAgICAgICAgdGhpcy5wZXJQYWdlSXRlbXMuZm9yRWFjaChpdGVtID0+IHtcclxuICAgICAgICAgICAgaWYgKENvbW1vblV0aWwuZmluZEluZGV4KGl0ZW1bJ2lkJ10sICdpZCcsIHRoaXMuZmF2b3JpdGVzTGlzdCkgIT09IC0xKSB7XHJcbiAgICAgICAgICAgICAgICBpdGVtLmluRmF2b3JpdGVzID0gdHJ1ZTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGl0ZW0uaW5GYXZvcml0ZXMgPSBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pXHJcbiAgICB9XHJcblxyXG4gICAgdHVybk92ZXJQYWdlKGRpcjogc3RyaW5nLCBudW06IG51bWJlcikge1xyXG4gICAgICAgIGlmICgoZGlyID09PSAncHJlJyAmJiB0aGlzLnBhZ2VJbmRleCA9PT0gMSkgfHwgKGRpciA9PT0gJ25leHQnICYmIHRoaXMucGFnZUluZGV4ID09PSB0aGlzLnBhZ2VUb3RhbCkpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnBhZ2VJbmRleCA9IHRoaXMucGFnZUluZGV4ICsgbnVtO1xyXG4gICAgICAgIHRoaXMuc3dpdGNoUGFnZSh7IHBhZ2VJbmRleDogdGhpcy5wYWdlSW5kZXggfSk7XHJcbiAgICB9XHJcblxyXG4gICAgYmVmb3JlUGFnZUluZGV4Q2hhbmdlKGlucHV0RWw6IEtleWJvYXJkRXZlbnQsIG1heE51bWJlcikge1xyXG4gICAgICAgIGNvbnN0IHRhcmdldCA9IGlucHV0RWwudGFyZ2V0IGFzIGFueTtcclxuICAgICAgICBjb25zdCBjdXJyZW50UGFnZU51bWJlciA9IE51bWJlcih0YXJnZXQudmFsdWUpO1xyXG4gICAgICAgIGlmIChjdXJyZW50UGFnZU51bWJlciA+IG1heE51bWJlcikge1xyXG4gICAgICAgICAgICB0YXJnZXQudmFsdWUgPSBtYXhOdW1iZXI7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgaWYgKGN1cnJlbnRQYWdlTnVtYmVyIDwgMSkge1xyXG4gICAgICAgICAgICAgICAgdGFyZ2V0LnZhbHVlID0gMTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnBhZ2VJbmRleCA9IE51bWJlcih0YXJnZXQudmFsdWUpO1xyXG4gICAgfVxyXG5cclxuICAgIGNsb3NlUGFuZWwoKSB7XHJcbiAgICAgICAgdGhpcy50b3RhbEl0ZW1zID0gW107XHJcbiAgICAgICAgdGhpcy5wZXJQYWdlSXRlbXMgPSBbXTtcclxuICAgICAgICB0aGlzLml0ZW1Ub3RhbENvdW50ID0gMDtcclxuICAgICAgICB0aGlzLnBhZ2VUb3RhbCA9IDA7XHJcbiAgICAgICAgdGhpcy5jbG9zZVBhbmVsQ2hhbmdlLmVtaXQodHJ1ZSk7XHJcbiAgICB9XHJcblxyXG4gICAgdG9nZ2xlQWxsKCkge1xyXG4gICAgICAgIGlmICghdGhpcy5hbGxDaGVja2VkKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2hlY2tBbGwoKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLnVuQ2hlY2tBbGwoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5lbWl0U2VsZWN0aW9ucyh0aGlzLnNlbGVjdGlvbnMsIENoYW5nZVR5cGUuVmFsdWVDaGFuZ2VkKTtcclxuICAgIH1cclxuXHJcbiAgICB0b2dnbGVPbmUoZGF0YSwgZSkge1xyXG4gICAgICAgIGlmIChkYXRhLmNoZWNrZWQpIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMubXVsdGlTZWxlY3QpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZW1pdFNlbGVjdGlvbnMoZGF0YSwgQ2hhbmdlVHlwZS5SZW1vdmUpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5lbWl0U2VsZWN0aW9ucyhbXSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5tdWx0aVNlbGVjdCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5lbWl0U2VsZWN0aW9ucyhkYXRhLCBDaGFuZ2VUeXBlLkFwcGVuZCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmVtaXRTZWxlY3Rpb25zKG5ldyBBcnJheShkYXRhKSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog55So5LqO5pWw5o2u5bGV56S6XHJcbiAgICAgKi9cclxuICAgIGxvYWRTZWFyY2hSZXN1bHQoKSB7XHJcbiAgICAgICAgY29uc3QgcXVlcnlGaWx0ZXIgPSB7XHJcbiAgICAgICAgICAgIGZpbHRlcnM6IFtcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAnRmlsdGVyRmllbGQnOiAnYWJicmV2aWF0aW9uJyxcclxuICAgICAgICAgICAgICAgICAgICAnQ29tcGFyZSc6IENvbXBhcmVUeXBlLkxpa2UsXHJcbiAgICAgICAgICAgICAgICAgICAgJ1ZhbHVlJzogdGhpcy5zZWFyY2hUZXh0LFxyXG4gICAgICAgICAgICAgICAgICAgICdSZWxhdGlvbic6IHRoaXMub25seURpc3BsYXlDb21wYW55ID8gUmVsYXRpb25UeXBlLkFuZCA6IFJlbGF0aW9uVHlwZS5FbXB0eSxcclxuICAgICAgICAgICAgICAgICAgICAnRXhwcmVzc3R5cGUnOiBWYWx1ZVR5cGUuVmFsdWUsXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIF0sXHJcbiAgICAgICAgICAgIHNvcnRvcmRlcnM6IFtcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAnU29ydEZpZWxkJzogJ3NvcnRvcmRlcicsXHJcbiAgICAgICAgICAgICAgICAgICAgJ1NvcnRUeXBlJzogMCxcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgXSxcclxuICAgICAgICB9O1xyXG4gICAgICAgIGlmKHRoaXMub25seURpc3BsYXlDb21wYW55KSB7XHJcbiAgICAgICAgICAgIHF1ZXJ5RmlsdGVyLmZpbHRlcnMucHVzaChcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAnRmlsdGVyRmllbGQnOiAnb3JnVHlwZScsXHJcbiAgICAgICAgICAgICAgICAgICAgJ0NvbXBhcmUnOiBDb21wYXJlVHlwZS5FcXVhbCxcclxuICAgICAgICAgICAgICAgICAgICAnVmFsdWUnOiB0aGlzLm9yZ1R5cGVJZCxcclxuICAgICAgICAgICAgICAgICAgICAnUmVsYXRpb24nOiBSZWxhdGlvblR5cGUuRW1wdHksXHJcbiAgICAgICAgICAgICAgICAgICAgJ0V4cHJlc3N0eXBlJzogVmFsdWVUeXBlLlZhbHVlLFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmFwaVNlcnZpY2UuZ2V0T3JnYW5pemF0aW9uc1dpdGhGaWx0ZXIocXVlcnlGaWx0ZXIpLnN1YnNjcmliZSgocmVzOiBhbnkpID0+IHtcclxuICAgICAgICAgICAgaWYgKCFyZXMgfHwgIXJlcy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZih0aGlzLm5vdEdldFN0b3BPcmcpIHtcclxuICAgICAgICAgICAgICAgIHJlcyA9IHJlcy5maWx0ZXIob3JnID0+ICFvcmdbJ2Rpc2FibGVkJ10pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMudG90YWxJdGVtcyA9IHJlcztcclxuICAgICAgICAgICAgdGhpcy5pdGVtVG90YWxDb3VudCA9IHJlcy5sZW5ndGg7XHJcbiAgICAgICAgICAgIHRoaXMucGFnZVRvdGFsID0gTWF0aC5jZWlsKHRoaXMuaXRlbVRvdGFsQ291bnQgLyB0aGlzLnBhZ2VTaXplKTtcclxuICAgICAgICAgICAgdGhpcy5zd2l0Y2hQYWdlKHsgcGFnZUluZGV4OiAxIH0pO1xyXG4gICAgICAgICAgICB0aGlzLnRvZ2dsZUNoZWNrZWQoKTtcclxuICAgICAgICAgICAgdGhpcy5jZHIuZGV0ZWN0Q2hhbmdlcygpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIHN3aXRjaFBhZ2UocGFnZUluZm86IHsgcGFnZUluZGV4OiBudW1iZXIgfSkge1xyXG4gICAgICAgIGlmICghcGFnZUluZm8gfHwgcGFnZUluZm8ucGFnZUluZGV4IDwgMSkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGxldCBzdGFydEluZGV4ID0gKHBhZ2VJbmZvLnBhZ2VJbmRleCAtIDEpICogdGhpcy5wYWdlU2l6ZTtcclxuICAgICAgICBsZXQgZW5kSW5kZXggPSBzdGFydEluZGV4ICsgdGhpcy5wYWdlU2l6ZTtcclxuICAgICAgICB0aGlzLnBlclBhZ2VJdGVtcyA9IHRoaXMudG90YWxJdGVtcy5zbGljZShzdGFydEluZGV4LCBlbmRJbmRleCk7XHJcbiAgICAgICAgdGhpcy5wZXJQYWdlSXRlbXMuZm9yRWFjaChyZXMgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBpbmRleElkID0gQ29tbW9uVXRpbC5uZXdHdWlkKCk7XHJcbiAgICAgICAgICAgIHJlcy5jaGVja2VkID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHJlcy5pbkZhdm9yaXRlcyA9IGZhbHNlO1xyXG4gICAgICAgICAgICByZXMuaW5kZXhJZCA9IGluZGV4SWQ7XHJcbiAgICAgICAgICAgIGlmIChDb21tb25VdGlsLmZpbmRJbmRleChyZXNbJ2lkJ10sICdpZCcsIHRoaXMuc2VsZWN0aW9ucykgIT09IC0xKSB7XHJcbiAgICAgICAgICAgICAgICByZXMuY2hlY2tlZCA9IHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKENvbW1vblV0aWwuZmluZEluZGV4KHJlc1snaWQnXSwgJ2lkJywgdGhpcy5mYXZvcml0ZXNMaXN0KSAhPT0gLTEpIHtcclxuICAgICAgICAgICAgICAgIHJlcy5pbkZhdm9yaXRlcyA9IHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLnBlclBhZ2VJdGVtcyA9IHRoaXMucGVyUGFnZUl0ZW1zLnNsaWNlKCk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDlhajpgInlkI7lpITnkIZcclxuICAgICAqIEBwYXJhbSBkYXRhQXJyIOWFqOmAieeahOWAvFxyXG4gICAgICovXHJcbiAgICBjaGVja0FsbCgpIHtcclxuICAgICAgICB0aGlzLnBlclBhZ2VJdGVtcy5mb3JFYWNoKGl0ZW0gPT4ge1xyXG4gICAgICAgICAgICB0aGlzLl9pbnNlcnRPbmVJbnRvU2VsZWN0aW9ucyhpdGVtKTtcclxuICAgICAgICAgICAgaXRlbS5jaGVja2VkID0gdHJ1ZTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOWFqOmDqOWPlua2iFxyXG4gICAgICogQHBhcmFtIGRhdGFBcnIg5Y+W5raI55qE5pWw5o2uXHJcbiAgICAgKiBAcmV0dXJucyB2b2lkXHJcbiAgICAgKi9cclxuICAgIHVuQ2hlY2tBbGwoKSB7XHJcbiAgICAgICAgdGhpcy5wZXJQYWdlSXRlbXMuZm9yRWFjaChpdGVtID0+IHtcclxuICAgICAgICAgICAgdGhpcy5zZWxlY3Rpb25zLmZvckVhY2goKHNlbGVjdGlvbiwgaW5kZXgpID0+IHtcclxuICAgICAgICAgICAgICAgIGlmIChpdGVtWydpZCddID09PSBzZWxlY3Rpb25bJ2lkJ10pIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGlvbnMuc3BsaWNlKGluZGV4LCAxKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGl0ZW0uY2hlY2tlZCA9IGZhbHNlO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog5b2T5YmN6KGM6YCJ5LitXHJcbiAgICAgKiBAcGFyYW0gZGF0YSDlvZPliY3ooYznmoTmlbDmja7vvIjvvIlcclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBzZWxlY3RMaW5lKGRhdGE6IGFueSkge1xyXG4gICAgICAgIGlmICh0aGlzLm11bHRpU2VsZWN0KSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2luc2VydE9uZUludG9TZWxlY3Rpb25zKGRhdGEpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0aW9ucyA9IFtdO1xyXG4gICAgICAgICAgICB0aGlzLnBlclBhZ2VJdGVtcy5mb3JFYWNoKGl0ZW0gPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKGl0ZW0uY2hlY2tlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGl0ZW0uY2hlY2tlZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgdGhpcy5faW5zZXJ0T25lSW50b1NlbGVjdGlvbnMoZGF0YSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLmlzQWxsQ2hlY2tlZCgpKSB7XHJcbiAgICAgICAgICAgIHRoaXMuYWxsQ2hlY2tlZCA9IHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog5Y2V6YCJ5Y+W5raI6YCJ5LitXHJcbiAgICAgKiBAcGFyYW0gZGF0YSDlj5bmtojpgInkuK3ooYxcclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSB1blNlbGVjdExpbmUoZGF0YTogYW55KSB7XHJcbiAgICAgICAgY29uc3QgaW5kZXggPSBDb21tb25VdGlsLmZpbmRJbmRleChkYXRhWydpZCddLCAnaWQnLCB0aGlzLnNlbGVjdGlvbnMpO1xyXG4gICAgICAgIGlmIChpbmRleCA+IC0xKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0aW9ucy5zcGxpY2UoaW5kZXgsIDEpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnNldENoZWNrZWQoZGF0YSwgZmFsc2UpO1xyXG4gICAgICAgIGlmICh0aGlzLmFsbENoZWNrZWQpIHtcclxuICAgICAgICAgICAgdGhpcy5hbGxDaGVja2VkID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgc2V0Q2hlY2tlZChkYXRhOiBhbnksIGNoZWNrZWQ6IGJvb2xlYW4pIHtcclxuICAgICAgICBjb25zdCBpdGVtSW5kZXggPSBDb21tb25VdGlsLmZpbmRJbmRleChkYXRhWydpZCddLCAnaWQnLCB0aGlzLnBlclBhZ2VJdGVtcyk7XHJcbiAgICAgICAgaWYgKGl0ZW1JbmRleCA+IC0xKSB7XHJcbiAgICAgICAgICAgIHRoaXMucGVyUGFnZUl0ZW1zW2l0ZW1JbmRleF0uY2hlY2tlZCA9IGNoZWNrZWQ7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgZW1pdFNlbGVjdGlvbnMoc2VsZWN0aW9uczogYW55LCBjaGFuZ2VUeXBlID0gQ2hhbmdlVHlwZS5WYWx1ZUNoYW5nZWQsIGZyb20gPSAnc2VhcmNoJykge1xyXG4gICAgICAgIHRoaXMuc3RhdGVNZ3IuZW1pdFNlbGVjdGlvbnMoc2VsZWN0aW9ucywgY2hhbmdlVHlwZSwgZnJvbSk7XHJcbiAgICB9XHJcblxyXG4gICAgdG9nZ2xlRmF2b3JpdGVzKGU6IGFueSwgaXRlbTogYW55KSB7XHJcbiAgICAgICAgdGhpcy5mYXZvcml0ZXNUb29sLnRvZ2dsZUZhdm9yaXRlcyhlLCBpdGVtKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOmAieS4reW5tuaPkuWFpeW9k+WJjeihjOaVsOaNruWIsOWPs+S+p1xyXG4gICAgICogQHBhcmFtIGRhdGEg5b2T5YmN6KGM55qE5pWw5o2uXHJcbiAgICAgKiBAcGFyYW0gY29sbGVjdGlvbiDmmoLlrZjlvZPliY3mlbDmja7nmoTpm4blkIhcclxuICAgICAqL1xyXG4gICAgX2luc2VydE9uZUludG9TZWxlY3Rpb25zKGRhdGE6IGFueSkge1xyXG4gICAgICAgIC8vIOWmguaenOW9k+WJjeaVsOaNruW3sue7j+enu+WFpeWPs+S+p+aVsOaNru+8jOWImei/lOWbnuOAglxyXG4gICAgICAgIGlmIChDb21tb25VdGlsLmZpbmRJbmRleChkYXRhWydpZCddLCAnaWQnLCB0aGlzLnNlbGVjdGlvbnMpID4gLTEpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnNldENoZWNrZWQoZGF0YSwgdHJ1ZSk7XHJcbiAgICAgICAgdGhpcy5zZWxlY3Rpb25zLnB1c2goZGF0YSk7XHJcbiAgICAgICAgdGhpcy5zZWxlY3Rpb25zID0gdGhpcy5zZWxlY3Rpb25zLnNsaWNlKCk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDnv7vpobXmo4Dmn6XvvJrkurrlkZjlsZXnpLrljLrnmoTli77pgInnirbmgIHkuI7lt7LpgInkurrlkZjljLrmmK/lkKblr7nlupRcclxuICAgICAqL1xyXG4gICAgdG9nZ2xlQ2hlY2tlZCgpIHtcclxuICAgICAgICB0aGlzLnBlclBhZ2VJdGVtcy5mb3JFYWNoKGl0ZW0gPT4ge1xyXG4gICAgICAgICAgICBpZiAoQ29tbW9uVXRpbC5maW5kSW5kZXgoaXRlbVsnaWQnXSwgJ2lkJywgdGhpcy5zZWxlY3Rpb25zKSA+IC0xKSB7XHJcbiAgICAgICAgICAgICAgICBpdGVtLmNoZWNrZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgaXRlbS5jaGVja2VkID0gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICBpZiAodGhpcy5pc0FsbENoZWNrZWQoKSkge1xyXG4gICAgICAgICAgICB0aGlzLmFsbENoZWNrZWQgPSB0cnVlO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuYWxsQ2hlY2tlZCA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGlzQWxsQ2hlY2tlZCgpOiBib29sZWFuIHtcclxuICAgICAgICBsZXQgY291bnQgPSAwO1xyXG4gICAgICAgIGxldCBhbGxDaGVja2VkID0gZmFsc2U7XHJcblxyXG4gICAgICAgIHRoaXMucGVyUGFnZUl0ZW1zLmZvckVhY2goaXRlbSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0aW9ucy5mb3JFYWNoKHNlbGVjdGlvbiA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAoaXRlbVsnaWQnXSA9PT0gc2VsZWN0aW9uWydpZCddKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY291bnQgKz0gMTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgaWYgKHRoaXMucGVyUGFnZUl0ZW1zLmxlbmd0aCA9PT0gY291bnQgJiYgY291bnQgPiAwKSB7XHJcbiAgICAgICAgICAgIGFsbENoZWNrZWQgPSB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gYWxsQ2hlY2tlZDtcclxuICAgIH1cclxuXHJcbiAgICB0cmFja0J5Rm4oaW5kZXgsIGl0ZW0pIHtcclxuICAgICAgICByZXR1cm4gaW5kZXg7XHJcbiAgICB9XHJcblxyXG59XHJcbiJdfQ==