/**
 * @fileoverview added by tsickle
 * Generated from: lib/tab-organization/to.component.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
import { Component, Input, EventEmitter, Output, ChangeDetectorRef, Injector, ViewChild, TemplateRef, HostBinding, NgZone } from '@angular/core';
import { ApiService } from '../../utils/api.service';
import * as _ from 'lodash-es';
import { of } from 'rxjs';
import { FavoritesTool } from '../../utils/favorites.tool';
import { ChangeType } from '../../utils/index.type';
import { CommonUtil } from '../../utils/common.tool';
import { TreeTableComponent } from '@farris/ui-treetable';
import { StateMgrTool } from '../../utils/state.mgr.tool';
import { switchMap } from 'rxjs/operators';
import { MessagerService } from '@farris/ui-messager';
import { LoadingService } from '@farris/ui-loading';
import { LocaleService } from '@farris/ui-locale';
import { ORGANIZATION_SELECTOR_LOCALE } from '../../utils/locale';
var OrganizationComponent = /** @class */ (function () {
    function OrganizationComponent(apiService, cdr, favoritesTool, injector, ngZone, stateMgr, msgService) {
        var _this = this;
        this.apiService = apiService;
        this.cdr = cdr;
        this.favoritesTool = favoritesTool;
        this.injector = injector;
        this.ngZone = ngZone;
        this.stateMgr = stateMgr;
        this.msgService = msgService;
        this.baseCls = true;
        this.primaryField = 'orgId';
        this.pathLength = 4;
        this.dataPermission = false;
        this.dataPermissionIds = [];
        this.selectionsChange = new EventEmitter();
        this.originalTreeData = [];
        this.locationOrgText = '';
        this.treeListData = [];
        this.treeTableCols = [];
        this.selections = [];
        this.favoritesList = [];
        this.initLoad = true;
        this.checkedOrgs = [];
        this.loadingService = null;
        this.localeService = null;
        this.dataToChecked = [];
        this.allAdminOrgData = [];
        this.orgTypeId = '9edf25d1-b991-4dde-90b9-30145422d24d';
        this.deptTypeId = '33c21504-3384-42a7-8fc3-c1b5e9e982d0';
        this.beforeClickNode = (/**
         * @param {?} e
         * @return {?}
         */
        function (e) {
            if (!_this.enableHierarchicalLoading) {
                return of(true);
            }
            if (!_this.multiSelect) {
                if (e.rowNode.isSelected) {
                    _this.setSelections([]);
                }
                else {
                    _this.setSelections(new Array(e.rowNode.node.data));
                }
                return of(false);
            }
            // const param: OrgRequestParam = {
            //     absOrgType: this.absOrgType,
            //     notGetStopOrg: this.notGetStopOrg,
            //     getCurUser: false,
            //     parentID: e.rowNode.id,
            //     withAllSub: true,
            //     getOrgAllPath: true
            // };
            // return this.apiService.getOrganization(param).pipe(
            //     switchMap(
            //         (data: any) => {
            //             // if (data['data'].length > this.selectedLimit && !e.rowNode.isChecked) {
            //             //     this.msgService.show('warning', `亲，一次性选择了超过${this.selectedLimit}条数据~`, true);
            //             //     return of(false)
            //             // }
            //             // if (!e.rowNode.isChecked) {
            //             //     // todo 待验证，加入selection，
            //             //     data.data.forEach(item => {
            //             //         if (CommonUtil.findIndex(item[this.primaryField], this.primaryField, this.selections) === -1) {
            //             //             this.setSelections(item, ChangeType.Append, 'other');
            //             //         }
            //             //     })
            //             // } else {
            //             //     this.selections.forEach((selection, index) => {
            //             //         data.data.forEach(item => {
            //             //             if (selection[this.primaryField] === item[this.primaryField]) {
            //             //                 this.setSelections(item, ChangeType.Remove, 'other');
            //             //             }
            //             //         });
            //             //     });
            //             // }
            //             // this.cdr.detectChanges();
            //             return of(true);
            //         }
            //     )
            // );
        });
        this.beforeCheckAll = (/**
         * @param {?} e
         * @return {?}
         */
        function (e) {
            if (!_this.enableHierarchicalLoading) {
                return of(true);
            }
            /** @type {?} */
            var param = {
                absOrgType: _this.absOrgType,
                notGetStopOrg: _this.notGetStopOrg,
                getCurUser: false,
                parentID: e.instance.data[0].id,
                withAllSub: true,
                getOrgAllPath: true
            };
            return _this.apiService.getOrganization(param).pipe(switchMap((/**
             * @param {?} data
             * @return {?}
             */
            function (data) {
                // if (data['data'].length > this.selectedLimit) {
                //     this.msgService.show('warning', `亲，一次性选择了超过${this.selectedLimit}条数据~`, true);
                //     return of(false)
                // }
                _this.setSelections(data['data'], ChangeType.ValueChanged, 'other');
                return of(true);
            })));
        });
        this.cdr = this.injector.get(ChangeDetectorRef);
        this.loadingService = this.injector.get(LoadingService, null);
        this.localeService = this.injector.get(LocaleService);
        if (!this.localeService.langData['organizationSelector']) {
            this.localeService.setLocaleData(ORGANIZATION_SELECTOR_LOCALE);
        }
    }
    /**
     * @return {?}
     */
    OrganizationComponent.prototype.ngOnDestroy = /**
     * @return {?}
     */
    function () {
        this.favoritesSub.unsubscribe();
        this.selectionsSub.unsubscribe();
    };
    /**
     * @return {?}
     */
    OrganizationComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this.treeTableCols = [
            { field: 'name', title: this.localeService.getValue("organizationSelector.organization.orgName"), template: this.orgNameCell },
            { field: 'abbreviation', title: this.localeService.getValue("organizationSelector.organization.orgAbbreviation") }
        ];
        if (this.enableFavorites) {
            this.treeTableCols.push({
                field: '',
                title: this.localeService.getValue("organizationSelector.organization.favorite"),
                template: this.favoritesCell
            });
            this.treeTableCols[0].width = 300;
            this.treeTableCols[1].width = 300;
        }
        /** @type {?} */
        var param = {
            withDisabledOrg: !this.notGetStopOrg,
            gettingCurrentOrg: false,
            onlyDisplayOrg: false
        };
        this.apiService.getOrganizations(param).subscribe((/**
         * @param {?} res
         * @return {?}
         */
        function (res) {
            if (res && res.orgs) {
                _this.allAdminOrgData = res.orgs;
                if (_this.initLoad && _this.isActiveTab) {
                    if (_this.enableHierarchicalLoading) {
                        _this.hlAssembleData();
                    }
                    else {
                        _this.assembleData();
                    }
                    _this.initLoad = false;
                }
            }
        }));
        this.favoritesSub = this.favoritesTool.favoritesSubject.subscribe((/**
         * @param {?} data
         * @return {?}
         */
        function (data) {
            _this.favoritesList = data;
            _this.setFavorites(_this.treeListData);
            _this.farrisTree.detectChanges();
        }));
        this.currentTabId = this.activeTabId;
        this.selectionsSub = this.stateMgr.selectionsSubject.subscribe((/**
         * @param {?} data
         * @return {?}
         */
        function (data) {
            if (data.changeType === ChangeType.ValueChanged) {
                _this.selections = _.cloneDeep(data.value);
                if (_this.selections.length === 0) {
                    _this.dataToSelected = null;
                    _this.dataToChecked = [];
                    _this.farrisTree.clearCheckeds();
                    _this.farrisTree.clearSelections();
                    _this.farrisTree.detectChanges();
                }
            }
            else if (data.changeType === ChangeType.Remove) {
                _this.selections = _this.selections.filter((/**
                 * @param {?} item
                 * @return {?}
                 */
                function (item) { return item['id'] !== data.value['id']; }));
                if (data.from == 'selection' && _this.currentTabId == 'organization') {
                    _this.inTreeList(_this.treeListData, data.value);
                    if (data.value.inTreeList) {
                        if (_this.multiSelect) {
                            _this.farrisTree.unCheckedNode(data.value['id']);
                        }
                        else {
                            _this.farrisTree.clearAll();
                        }
                    }
                }
            }
            else if (data.changeType === ChangeType.Append) {
                CommonUtil.findIndex(data.value['id'], 'id', _this.selections) === -1 ? _this.selections.push(data.value) : null;
            }
        }));
    };
    /**
     * @return {?}
     */
    OrganizationComponent.prototype.ngAfterViewInit = /**
     * @return {?}
     */
    function () {
    };
    /**
     * @param {?} changes
     * @return {?}
     */
    OrganizationComponent.prototype.ngOnChanges = /**
     * @param {?} changes
     * @return {?}
     */
    function (changes) {
        /*
        const orgIdsChange = changes.orgIds;
        if (orgIdsChange && orgIdsChange.currentValue) {
            this.checkedOrgs = orgIdsChange.currentValue;
        }
        */
    };
    // 初始tab页不为组织架构，切换至组织架构时获取组织数据
    // 初始tab页不为组织架构，切换至组织架构时获取组织数据
    /**
     * @return {?}
     */
    OrganizationComponent.prototype.loadTreeData = 
    // 初始tab页不为组织架构，切换至组织架构时获取组织数据
    /**
     * @return {?}
     */
    function () {
        if (this.initLoad) {
            if (this.enableHierarchicalLoading) {
                this.hlAssembleData();
            }
            else {
                this.assembleData();
            }
            this.initLoad = false;
        }
    };
    // 设置当前组织树各个节点的收藏状态
    // 设置当前组织树各个节点的收藏状态
    /**
     * @private
     * @param {?} treeListData
     * @return {?}
     */
    OrganizationComponent.prototype.setFavorites = 
    // 设置当前组织树各个节点的收藏状态
    /**
     * @private
     * @param {?} treeListData
     * @return {?}
     */
    function (treeListData) {
        for (var i = 0; i < treeListData.length; i++) {
            if (CommonUtil.findIndex(treeListData[i].id, 'id', this.favoritesList) === -1) {
                treeListData[i].data.inFavorites = false;
            }
            else {
                treeListData[i].data.inFavorites = true;
            }
            if (treeListData[i].children.length) {
                this.setFavorites(treeListData[i].children);
            }
        }
    };
    /**
     * @private
     * @param {?} selections
     * @param {?=} changeType
     * @param {?=} from
     * @return {?}
     */
    OrganizationComponent.prototype.setSelections = /**
     * @private
     * @param {?} selections
     * @param {?=} changeType
     * @param {?=} from
     * @return {?}
     */
    function (selections, changeType, from) {
        if (changeType === void 0) { changeType = ChangeType.ValueChanged; }
        if (from === void 0) { from = 'tree'; }
        this.stateMgr.emitSelections(selections, changeType, from);
    };
    // 组织树全选事件
    // 组织树全选事件
    /**
     * @return {?}
     */
    OrganizationComponent.prototype.checkAll = 
    // 组织树全选事件
    /**
     * @return {?}
     */
    function () {
        if (!this.enableHierarchicalLoading) {
            /** @type {?} */
            var checkeds_1 = [];
            this.farrisTree.checkeds.forEach((/**
             * @param {?} item
             * @return {?}
             */
            function (item) {
                checkeds_1.push(item.data);
            }));
            this.setSelections(checkeds_1);
        }
    };
    // 组织树取消全选事件
    // 组织树取消全选事件
    /**
     * @return {?}
     */
    OrganizationComponent.prototype.unCheckAll = 
    // 组织树取消全选事件
    /**
     * @return {?}
     */
    function () {
        this.setSelections([]);
    };
    // 选中（取消选中、勾选、取消勾选）树节点时触发
    // todo 分层加载的时候咋处理数据，beforeUnCheckAll还未支持。
    // 选中（取消选中、勾选、取消勾选）树节点时触发
    // todo 分层加载的时候咋处理数据，beforeUnCheckAll还未支持。
    /**
     * @param {?} e
     * @return {?}
     */
    OrganizationComponent.prototype.changeSelections = 
    // 选中（取消选中、勾选、取消勾选）树节点时触发
    // todo 分层加载的时候咋处理数据，beforeUnCheckAll还未支持。
    /**
     * @param {?} e
     * @return {?}
     */
    function (e) {
        /*
        if (!this.enableHierarchicalLoading && !!e.originalEvent) {
            this.multiSelect ? this.toggleChecked(e) : this.toggleSelected(e);
        }
        */
        this.multiSelect ? this.toggleChecked(e) : this.toggleSelected(e);
    };
    /**
     * @param {?} e
     * @return {?}
     */
    OrganizationComponent.prototype.toggleChecked = /**
     * @param {?} e
     * @return {?}
     */
    function (e) {
        /** @type {?} */
        var checkeds = [];
        e && e.instance && e.instance.checkeds.forEach((/**
         * @param {?} item
         * @return {?}
         */
        function (item) {
            checkeds.push(item.data);
        }));
        this.setSelections(checkeds.concat(this.dataToChecked));
    };
    /**
     * @param {?} e
     * @return {?}
     */
    OrganizationComponent.prototype.toggleSelected = /**
     * @param {?} e
     * @return {?}
     */
    function (e) {
        /** @type {?} */
        var selected = [];
        e && e.instance && e.instance.selections.forEach((/**
         * @param {?} item
         * @return {?}
         */
        function (item) {
            selected.push(item.data);
        }));
        this.setSelections(selected);
    };
    // 根据传入的组织id确定已选择组织
    // 根据传入的组织id确定已选择组织
    /**
     * @private
     * @param {?} ids
     * @return {?}
     */
    OrganizationComponent.prototype.assembleDataByOrgIds = 
    // 根据传入的组织id确定已选择组织
    /**
     * @private
     * @param {?} ids
     * @return {?}
     */
    function (ids) {
        var _this = this;
        if (!ids || ids.length === 0) {
            return;
        }
        if (ids && ids.length > 0 && !this.multiSelect) {
            this.msgService.show('warning', this.localeService.getValue("organizationSelector.errorMessage.multiSelect"), true);
            return;
        }
        /** @type {?} */
        var param = {
            absOrgType: this.absOrgType,
            idList: ids,
            getCurUser: false,
            getOrgAllPath: true,
        };
        this.apiService.getOrganization(param).subscribe((/**
         * @param {?} res
         * @return {?}
         */
        function (res) {
            if (res && res.data && res.data.length > 0) {
                _this.checkedOrgs = res.data;
                res.data.forEach((/**
                 * @param {?} item
                 * @return {?}
                 */
                function (item) {
                    if (CommonUtil.findIndex(item['id'], 'id', _this.selections) === -1) {
                        _this.setSelections(item, ChangeType.Append, 'other');
                    }
                }));
                _this.tickSelections();
                _this.cdr.detectChanges();
            }
        }));
    };
    // 分层加载组织树
    // 分层加载组织树
    /**
     * @return {?}
     */
    OrganizationComponent.prototype.hlAssembleData = 
    // 分层加载组织树
    /**
     * @return {?}
     */
    function () {
        var _this = this;
        if (this.loadingService) {
            this.loadingService.show();
        }
        /** @type {?} */
        var param = {
            withDisabledOrg: !this.notGetStopOrg,
            gettingCurrentOrg: true,
            onlyDisplayOrg: this.onlyDisplayCompany
        };
        this.apiService.getOrganizationsWithLayer(param).subscribe((/**
         * @param {?} res
         * @return {?}
         */
        function (res) {
            var e_1, _a;
            if (!res || !res.orgs) {
                return;
            }
            /** @type {?} */
            var currentUserOrg = _this.allAdminOrgData.find((/**
             * @param {?} data
             * @return {?}
             */
            function (data) { return data.id == res.currentOrg.orgId; }));
            if (_this.onlyDisplayCompany) {
                /** @type {?} */
                var allPathInfoOrgList = _this.allAdminOrgData.filter((/**
                 * @param {?} data
                 * @return {?}
                 */
                function (data) { return currentUserOrg.path.startsWith(data.path) && data.valueType == _this.orgTypeId; }));
                /** @type {?} */
                var layer_1 = 0;
                allPathInfoOrgList.forEach((/**
                 * @param {?} org
                 * @return {?}
                 */
                function (org) {
                    if (Number(org.layer) > layer_1) {
                        _this.currentUserOrgId = org.id;
                        _this.currentUserOrgPath = org.path;
                        layer_1 = Number(org.layer);
                    }
                }));
            }
            else {
                _this.currentUserOrgId = currentUserOrg.id;
                _this.currentUserOrgPath = currentUserOrg.path;
            }
            if (_this.onlyCurrentAdminOrg) {
                /** @type {?} */
                var deptPathList = [];
                var _loop_1 = function (i) {
                    /** @type {?} */
                    var indexData = res.orgs.find((/**
                     * @param {?} org
                     * @return {?}
                     */
                    function (org) {
                        if (i == 0) {
                            return org.path == _this.currentUserOrgPath;
                        }
                        else {
                            return org.path == _this.currentUserOrgPath.slice(0, -4 * i);
                        }
                    }));
                    if (indexData.valueType == _this.orgTypeId) {
                        _this.currentAdminOrgPath = indexData.path;
                        return "break";
                    }
                    else {
                        if (indexData.path != _this.currentUserOrgPath) {
                            deptPathList.push(indexData.path);
                        }
                    }
                };
                for (var i = 0; i < _this.currentUserOrgPath.length / 4; i++) {
                    var state_1 = _loop_1(i);
                    if (state_1 === "break")
                        break;
                }
                if (_this.currentAdminOrgPath == _this.currentUserOrgPath) {
                    _this.originalTreeData = [res.orgs.find((/**
                         * @param {?} org
                         * @return {?}
                         */
                        function (org) { return org.path == _this.currentUserOrgPath; }))];
                }
                else {
                    deptPathList.push(_this.currentAdminOrgPath);
                    var _loop_2 = function (item) {
                        /** @type {?} */
                        var targetOrgData = _this.allAdminOrgData.filter((/**
                         * @param {?} org
                         * @return {?}
                         */
                        function (org) { return org.path.slice(0, -4) == item && org.valueType == _this.deptTypeId && !org.disabled; }));
                        _this.originalTreeData = _this.originalTreeData.concat(targetOrgData || []);
                    };
                    try {
                        for (var deptPathList_1 = tslib_1.__values(deptPathList), deptPathList_1_1 = deptPathList_1.next(); !deptPathList_1_1.done; deptPathList_1_1 = deptPathList_1.next()) {
                            var item = deptPathList_1_1.value;
                            _loop_2(item);
                        }
                    }
                    catch (e_1_1) { e_1 = { error: e_1_1 }; }
                    finally {
                        try {
                            if (deptPathList_1_1 && !deptPathList_1_1.done && (_a = deptPathList_1.return)) _a.call(deptPathList_1);
                        }
                        finally { if (e_1) throw e_1.error; }
                    }
                    _this.originalTreeData.push(res.orgs.find((/**
                     * @param {?} org
                     * @return {?}
                     */
                    function (org) { return org.path == _this.currentAdminOrgPath; })));
                }
            }
            else {
                var _loop_3 = function (i, index) {
                    /** @type {?} */
                    var targetOrgData = _this.allAdminOrgData.filter((/**
                     * @param {?} org
                     * @return {?}
                     */
                    function (org) { return Number(org['layer']) == i && org.path.slice(0, -4) == _this.currentUserOrgPath.slice(0, -4 * index) && !org.disabled; }));
                    _this.originalTreeData = _this.originalTreeData.concat(targetOrgData || []);
                    index += 1;
                    out_index_1 = index;
                };
                var out_index_1;
                for (var i = _this.currentUserOrgPath.length / 4, index = 1; i > 1; i--) {
                    _loop_3(i, index);
                    index = out_index_1;
                }
                _this.originalTreeData.push(res.orgs.find((/**
                 * @param {?} org
                 * @return {?}
                 */
                function (org) { return org['layer'] == '1'; })));
                if (_this.onlyDisplayCompany) {
                    _this.originalTreeData = _this.originalTreeData.filter((/**
                     * @param {?} data
                     * @return {?}
                     */
                    function (data) { return data.valueType == _this.orgTypeId; }));
                }
            }
            _this.originalTreeData.forEach((/**
             * @param {?} item
             * @return {?}
             */
            function (item) {
                item.selectable = true;
                if (_this.enableFavorites) {
                    if (CommonUtil.findIndex(item['id'], 'id', _this.favoritesList) === -1) {
                        item.inFavorites = false;
                    }
                    else {
                        item.inFavorites = true;
                    }
                }
            }));
            if (res.currentOrg.orgId == 'nullorg') {
                // 需要区分是否为admin账户登录
                _this.treeListData = _this.dataToTree(_this.originalTreeData, 1, '*');
            }
            else {
                _this.treeListData = _this.dataToTree(_this.originalTreeData, 1, _this.currentUserOrgPath);
            }
            _this.farrisTree.loadData(_this.treeListData);
            if (_this.multiSelect) {
                _this.checkOrgTreeNodes();
            }
            else {
                _this.selectOrgTreeNode();
            }
            _this.cdr.detectChanges();
            if (_this.loadingService) {
                _this.loadingService.close();
            }
        }));
    };
    // 全加载组织树
    // 全加载组织树
    /**
     * @return {?}
     */
    OrganizationComponent.prototype.assembleData = 
    // 全加载组织树
    /**
     * @return {?}
     */
    function () {
        var _this = this;
        if (this.loadingService) {
            this.loadingService.show();
        }
        /** @type {?} */
        var param = {
            withDisabledOrg: (!this.notGetStopOrg).toString(),
            getingCurrentOrg: '' + true,
        };
        this.apiService.getOrganizations(param).subscribe((/**
         * @param {?} res
         * @return {?}
         */
        function (res) {
            if (!res || !res.orgs) {
                return;
            }
            if (_this.enableFavorites) {
                res.orgs.forEach((/**
                 * @param {?} item
                 * @return {?}
                 */
                function (item) {
                    if (CommonUtil.findIndex(item['id'], 'id', _this.favoritesList) === -1) {
                        item.inFavorites = false;
                    }
                    else {
                        item.inFavorites = true;
                    }
                }));
            }
            _this.originalTreeData = res.orgs;
            _this.treeListData = _this.dataToTree(res.orgs, 1, res.currentOrg.orgPath);
            _this.farrisTree.loadData(_this.treeListData);
            if (_this.multiSelect) {
                _this.checkOrgTreeNodes();
            }
            else {
                _this.selectOrgTreeNode();
            }
            _this.cdr.detectChanges();
            if (_this.loadingService) {
                _this.loadingService.close();
            }
        }));
    };
    // 确定已选组织是否在当前组织树内
    // 确定已选组织是否在当前组织树内
    /**
     * @private
     * @param {?} treeListData
     * @param {?} item
     * @return {?}
     */
    OrganizationComponent.prototype.inTreeList = 
    // 确定已选组织是否在当前组织树内
    /**
     * @private
     * @param {?} treeListData
     * @param {?} item
     * @return {?}
     */
    function (treeListData, item) {
        for (var i = 0; i < treeListData.length; i++) {
            if (treeListData[i].id === item['id']) {
                item.inTreeList = true;
                break;
            }
            if (treeListData[i].children.length) {
                this.inTreeList(treeListData[i].children, item);
            }
        }
    };
    // 在当前组织树内勾选所有已选择的组织
    // 在当前组织树内勾选所有已选择的组织
    /**
     * @private
     * @return {?}
     */
    OrganizationComponent.prototype.tickSelections = 
    // 在当前组织树内勾选所有已选择的组织
    /**
     * @private
     * @return {?}
     */
    function () {
        // const ids = [];
        // this.selectedDataNotInTreeList = [];
        // this.selections.forEach(item => {
        //     this.inTreeList(this.treeListData, item);
        //     if (!!item.inTreeList) {
        //         ids.push(item[this.primaryField]);
        //     } else {
        //         if(!this.multiSelect) {
        //             this.singleSelectedData = null;
        //         }
        //         this.selectedDataNotInTreeList.push(item);
        //     }
        // });
        // this.ngZone.runOutsideAngular(() => {
        //     setTimeout(() => {
        //         if (!ids.length) {
        //             return;
        //         }
        //         if (this.multiSelect) {
        //             this.farrisTree.checkedNodes(ids, true, true);
        //         } else {
        //             this.farrisTree.clearSelections();
        //             //
        //             this.farrisTree.detectChanges();
        //             this.selectOrgTreeNode();
        //         }
        //     })
        // })
    };
    /**
    * 组织数据转换
    * @param plainSource 接口原始数据
    * @param layer 层级
    * @returns 返回树形接口的数据
    */
    /**
     * 组织数据转换
     * @private
     * @param {?} plainSource 接口原始数据
     * @param {?} layer 层级
     * @param {?=} expandedPath
     * @return {?} 返回树形接口的数据
     */
    OrganizationComponent.prototype.dataToTree = /**
     * 组织数据转换
     * @private
     * @param {?} plainSource 接口原始数据
     * @param {?} layer 层级
     * @param {?=} expandedPath
     * @return {?} 返回树形接口的数据
     */
    function (plainSource, layer, expandedPath) {
        if (expandedPath === void 0) { expandedPath = ''; }
        /** @type {?} */
        var treeSource = this.dealData(plainSource, expandedPath ? expandedPath : '');
        // const parents = treeSource.filter(item => {
        //     return item.data.layer === layer;
        // });
        // this.treeData(parents, treeSource, 1);
        return treeSource;
    };
    /**
     * @private
     * @param {?} data
     * @return {?}
     */
    OrganizationComponent.prototype.dealDataWhenExpandTreeNode = /**
     * @private
     * @param {?} data
     * @return {?}
     */
    function (data) {
        if (!data || !data.length) {
            return [];
        }
        /** @type {?} */
        var newDatas = [];
        data.forEach((/**
         * @param {?} item
         * @return {?}
         */
        function (item) {
            /** @type {?} */
            var newsDataObj = {
                data: {
                    id: item.id,
                    name: item.name,
                    path: item.path,
                    code: item.code,
                    abbreviation: item.abbreviation,
                    layer: Number(item.layer),
                    inFavorites: item.inFavorites
                },
                expanded: false,
                children: []
            };
            if (!item.isDetail) {
                newsDataObj.leaf = false;
            }
            newDatas.push(newsDataObj);
        }));
        return newDatas;
    };
    /**
     * 预处理组织数据
     */
    /**
     * 预处理组织数据
     * @private
     * @param {?} data
     * @param {?=} expandedPath
     * @return {?}
     */
    OrganizationComponent.prototype.dealData = /**
     * 预处理组织数据
     * @private
     * @param {?} data
     * @param {?=} expandedPath
     * @return {?}
     */
    function (data, expandedPath) {
        var _this = this;
        if (expandedPath === void 0) { expandedPath = ''; }
        /** @type {?} */
        var pathList = [];
        if (expandedPath != '') {
            /** @type {?} */
            var maxLength = expandedPath.length / this.pathLength;
            if (this.enableHierarchicalLoading) {
                maxLength -= 1;
            }
            for (var a = 0; a < maxLength; a++) {
                pathList.push({ path: expandedPath.substring(0, 4 * (a + 1)) });
            }
        }
        else {
            return [];
        }
        /** @type {?} */
        var nodes = new Map();
        /** @type {?} */
        var newDatas = [];
        if (data.length) {
            data.forEach((/**
             * @param {?} item
             * @return {?}
             */
            function (item) {
                /** @type {?} */
                var path = item['path'];
                /** @type {?} */
                var parentPath;
                if (_this.onlyCurrentAdminOrg) {
                    parentPath = path == _this.currentAdminOrgPath ? 'top' : item.path.slice(0, -4);
                }
                else {
                    parentPath = item['layer'] == '1' ? 'top' : item.path.slice(0, -4);
                }
                if (!nodes[path]) {
                    nodes[path] = { children: [] };
                }
                nodes[path] = {
                    data: {
                        id: item.id,
                        name: item.name,
                        path: item.path,
                        code: item.code,
                        abbreviation: item.abbreviation,
                        layer: Number(item.layer),
                        inFavorites: item.inFavorites
                    },
                    expanded: false,
                    children: nodes[path]['children']
                };
                if (CommonUtil.findIndex(item.path, 'path', pathList) !== -1 || Number(item.layer) < _this.layer) {
                    nodes[path]['expanded'] = true;
                }
                else {
                    nodes[path]['expanded'] = false;
                    if (_this.enableHierarchicalLoading && !item.isDetail) {
                        nodes[path]['leaf'] = false;
                    }
                }
                if (_this.dataPermission && _this.dataPermissionIds.length) {
                    /** @type {?} */
                    var target = _this.dataPermissionIds.find((/**
                     * @param {?} t
                     * @return {?}
                     */
                    function (t) { return t == item['orgId']; }));
                    nodes[path]['selectable'] = target ? true : false;
                }
                if (parentPath == 'top') {
                    newDatas.push(nodes[path]);
                }
                else {
                    if (!nodes[parentPath]) {
                        nodes[parentPath] = { children: [] };
                    }
                    ((/** @type {?} */ (nodes[parentPath]['children']))).push(nodes[path]);
                }
            }));
        }
        return newDatas;
    };
    /**
     * 数据转换
     * @param parents 父级节点信息
     * @param treeSource 原始数据信息
     * @param layer 层级
     */
    /**
     * 数据转换
     * @param {?} parents 父级节点信息
     * @param {?} treeSource 原始数据信息
     * @param {?} layer 层级
     * @return {?}
     */
    OrganizationComponent.prototype.treeData = /**
     * 数据转换
     * @param {?} parents 父级节点信息
     * @param {?} treeSource 原始数据信息
     * @param {?} layer 层级
     * @return {?}
     */
    function (parents, treeSource, layer) {
        var _this = this;
        parents.forEach((/**
         * @param {?} parent
         * @return {?}
         */
        function (parent) {
            /** @type {?} */
            var parentPath = parent['data']['path'];
            /** @type {?} */
            var parentLayer = parent['data']['layer'];
            treeSource.forEach((/**
             * @param {?} item
             * @return {?}
             */
            function (item) {
                if (item && item['data'] && item['data']['path']) {
                    /** @type {?} */
                    var itemPath = item['data']['path'];
                    /** @type {?} */
                    var itemLayer = item['data']['layer'];
                    /** @type {?} */
                    var targetPath = void 0;
                    if (itemPath && itemPath.length > parentPath.length) {
                        targetPath = itemPath.substr(0, Number(layer) * 4);
                    }
                    if (parentPath === targetPath && parentLayer === itemLayer - 1) {
                        parent['children'].push(item);
                    }
                    if (parentPath === targetPath) {
                        _this.treeData([item], treeSource, Number(layer) + 1);
                    }
                }
            }));
        }));
    };
    // 收藏或取消收藏当前节点对应的组织
    // 收藏或取消收藏当前节点对应的组织
    /**
     * @param {?} e
     * @param {?} item
     * @return {?}
     */
    OrganizationComponent.prototype.toggleFavorites = 
    // 收藏或取消收藏当前节点对应的组织
    /**
     * @param {?} e
     * @param {?} item
     * @return {?}
     */
    function (e, item) {
        this.favoritesTool.toggleFavorites(e, item);
    };
    // 监听组织树展开事件
    // 监听组织树展开事件
    /**
     * @param {?} obj
     * @return {?}
     */
    OrganizationComponent.prototype.listenTreeExpand = 
    // 监听组织树展开事件
    /**
     * @param {?} obj
     * @return {?}
     */
    function (obj) {
        // todo 分层加载
        if (this.enableHierarchicalLoading && obj.children.length === 0) {
            this.getOrganizationByParentNode(obj);
        }
    };
    // 分层加载时，获取下级组织数据并为当前组织树添加子节点
    // 分层加载时，获取下级组织数据并为当前组织树添加子节点
    /**
     * @param {?} parentNode
     * @return {?}
     */
    OrganizationComponent.prototype.getOrganizationByParentNode = 
    // 分层加载时，获取下级组织数据并为当前组织树添加子节点
    /**
     * @param {?} parentNode
     * @return {?}
     */
    function (parentNode) {
        var _this = this;
        if (this.loadingService) {
            this.loadingService.show();
        }
        /** @type {?} */
        var param = {
            withDisabledOrg: !this.notGetStopOrg,
            parentOrgId: parentNode.id,
            gettingCurrentOrg: false,
            onlyDisplayOrg: this.onlyDisplayCompany
        };
        this.apiService.getOrganizationsWithLayer(param).subscribe((/**
         * @param {?} res
         * @return {?}
         */
        function (res) {
            if (res && res.orgs) {
                /** @type {?} */
                var newDatas_1 = [];
                res.orgs.forEach((/**
                 * @param {?} item
                 * @return {?}
                 */
                function (item) {
                    if ((!_this.onlyCurrentAdminOrg || item['valueType'] == _this.deptTypeId) && !item.disabled) {
                        item.selectable = true;
                        if (_this.dataPermission && _this.dataPermissionIds.length) {
                            /** @type {?} */
                            var target = _this.dataPermissionIds.find((/**
                             * @param {?} t
                             * @return {?}
                             */
                            function (t) { return t == item['id']; }));
                            if (!target) {
                                item.selectable = false;
                            }
                        }
                        _this.originalTreeData.push(item);
                    }
                    if (_this.enableFavorites) {
                        item.inFavorites = true;
                        if (CommonUtil.findIndex(item['id'], 'id', _this.favoritesList) === -1) {
                            item.inFavorites = false;
                        }
                    }
                    newDatas_1.push(item);
                }));
                /** @type {?} */
                var nodes = _this.dealDataWhenExpandTreeNode(newDatas_1);
                _this.farrisTree.appendChildren(nodes, parentNode);
                _this.farrisTree.detectChanges();
                if (_this.multiSelect) {
                    _this.checkOrgTreeNodes();
                }
                else {
                    _this.selectOrgTreeNode();
                }
                if (_this.loadingService) {
                    _this.loadingService.close();
                }
            }
        }));
    };
    // 返回已经该节点是否展开过
    // 返回已经该节点是否展开过
    /**
     * @private
     * @param {?} item
     * @param {?} arr
     * @param {?} expanded
     * @return {?}
     */
    OrganizationComponent.prototype.nodeExpanded = 
    // 返回已经该节点是否展开过
    /**
     * @private
     * @param {?} item
     * @param {?} arr
     * @param {?} expanded
     * @return {?}
     */
    function (item, arr, expanded) {
        for (var i = 0; i < arr.length; i++) {
            if (item.data.id === arr[i].data.id) {
                expanded[0] = arr[i].expanded;
            }
            else if (arr[i].children.length) {
                this.nodeExpanded(item, arr[i].children, expanded);
            }
        }
    };
    // 展开节点
    // 展开节点
    /**
     * @private
     * @param {?} treeData
     * @param {?} path
     * @param {?} layer
     * @return {?}
     */
    OrganizationComponent.prototype.expandTreeNode = 
    // 展开节点
    /**
     * @private
     * @param {?} treeData
     * @param {?} path
     * @param {?} layer
     * @return {?}
     */
    function (treeData, path, layer) {
        var _this = this;
        treeData.forEach((/**
         * @param {?} node
         * @return {?}
         */
        function (node) {
            if (path.includes(node.data.path)) {
                _this.farrisTree.expandNode(node.data.id);
            }
            if (node.data.layer < layer && node.children.length) {
                _this.expandTreeNode(node.children, path, layer);
            }
        }));
    };
    /**
     * @return {?}
     */
    OrganizationComponent.prototype.selectOrgTreeNode = /**
     * @return {?}
     */
    function () {
        var _this = this;
        if (this.treeListData && this.selections.length) {
            this.dataToSelected = this.selections[0];
            // if (!this.farrisTree.selectedRow) {
            //     if (this.orgTreeTimer) {
            //         clearTimeout(this.orgTreeTimer);
            //     }
            //     this.orgTreeTimer = 
            // } else {
            //     this.farrisTree.scrollToCurrentNode();
            // }
            setTimeout((/**
             * @return {?}
             */
            function () {
                _this.inTreeList(_this.treeListData, _this.dataToSelected);
                if (_this.dataToSelected.inTreeList) {
                    _this.farrisTree.selectNode(_this.dataToSelected['id']);
                    _this.dataToSelected = null;
                }
            }), 300);
        }
    };
    /**
     * @return {?}
     */
    OrganizationComponent.prototype.checkOrgTreeNodes = /**
     * @return {?}
     */
    function () {
        var _this = this;
        if (this.treeListData && this.selections.length) {
            this.dataToChecked = this.selections;
            /** @type {?} */
            var checkedNodes_1 = [];
            setTimeout((/**
             * @return {?}
             */
            function () {
                _this.dataToChecked.forEach((/**
                 * @param {?} item
                 * @return {?}
                 */
                function (item) {
                    _this.inTreeList(_this.treeListData, item);
                    if (item.inTreeList) {
                        checkedNodes_1.push(item['id']);
                    }
                }));
                _this.dataToChecked = _this.dataToChecked.filter((/**
                 * @param {?} item
                 * @return {?}
                 */
                function (item) { return !checkedNodes_1.includes(item['id']); }));
                if (checkedNodes_1.length) {
                    _this.farrisTree.checkedNodes(checkedNodes_1, true, true);
                }
            }), 300);
        }
    };
    OrganizationComponent.decorators = [
        { type: Component, args: [{
                    selector: 'lib-org',
                    template: "<farris-treetable #farristree style=\"cursor:pointer\" [width]=\"'100%'\" [data]=\"treeListData\" [idField]=\"'id'\"\r\n    [columns]=\"treeTableCols\" [singleSelect]=\"!multiSelect\" [showBorder]=\"false\" [showCheckbox]=\"multiSelect\"\r\n    [showIcon]=\"false\" [showHeader]=\"true\" [fixedHeader]=\"true\" [disabled]=\"false\" [fit]=\"true\" [checkOnSelect]=\"true\" [selectOnCheck]=\"true\"\r\n    [striped]=\"true\" [cascadeCheck]=\"cascadeCheck\" [cascadeDown]=\"cascadeDown\" [cascadeUp]=\"cascadeUp\"\r\n    [keepSelect]=\"keepSelect\" [showCheckAll]=\"showCheckAll\" [onlySelectSelf]=\"true\"\r\n    [virtualized]=\"true\"\r\n    (nodeChecked)=\"changeSelections($event)\" (nodeUnChecked)=\"changeSelections($event)\"\r\n    (nodeSelected)=\"changeSelections($event)\" (nodeUnSelect)=\"changeSelections($event)\"\r\n    (checkAll)=\"checkAll()\" (unCheckAll)=\"unCheckAll()\"\r\n    (expand)=\"listenTreeExpand($event)\" class=\"fos-treetable\">\r\n</farris-treetable>\r\n\r\n<!-- \u7EC4\u7EC7\u6811\u6A21\u677F -->\r\n<ng-template #orgNameCell let-ctx>\r\n    <span style=\"font-size: 13px;\" title=\"{{ctx.node.data.name}}\">{{ctx.node.data.name}}</span>\r\n</ng-template>\r\n\r\n<!-- \u7EC4\u7EC7\u6811\u6A21\u677F-\u6536\u85CF\u5217 -->\r\n<ng-template #favoritesCell let-ctx>\r\n    <span class=\"f-icon f-icon-star\" [class.default-light-color]=\"ctx.node.data.inFavorites\"\r\n        [class.default-dark-color]=\"!ctx.node.data.inFavorites\" (click)=\"toggleFavorites($event, ctx.node.data)\"></span>\r\n</ng-template>",
                    styles: [""]
                }] }
    ];
    /** @nocollapse */
    OrganizationComponent.ctorParameters = function () { return [
        { type: ApiService },
        { type: ChangeDetectorRef },
        { type: FavoritesTool },
        { type: Injector },
        { type: NgZone },
        { type: StateMgrTool },
        { type: MessagerService }
    ]; };
    OrganizationComponent.propDecorators = {
        enableFavorites: [{ type: Input }],
        baseCls: [{ type: HostBinding, args: ['class.f-utils-fill-flex-column',] }],
        farrisTree: [{ type: ViewChild, args: ['farristree',] }],
        orgNameCell: [{ type: ViewChild, args: ['orgNameCell',] }],
        favoritesCell: [{ type: ViewChild, args: ['favoritesCell',] }],
        primaryField: [{ type: Input }],
        enableHierarchicalLoading: [{ type: Input }],
        notGetStopOrg: [{ type: Input }],
        layer: [{ type: Input }],
        multiSelect: [{ type: Input }],
        absOrgType: [{ type: Input }],
        cascadeCheck: [{ type: Input }],
        cascadeUp: [{ type: Input }],
        cascadeDown: [{ type: Input }],
        showCheckAll: [{ type: Input }],
        keepSelect: [{ type: Input }],
        pathLength: [{ type: Input }],
        orgIds: [{ type: Input }],
        selectedLimit: [{ type: Input }],
        virtualizedLoad: [{ type: Input }],
        isActiveTab: [{ type: Input }],
        activeTabId: [{ type: Input }],
        dataPermission: [{ type: Input }],
        dataPermissionIds: [{ type: Input }],
        orgNameType: [{ type: Input }],
        onlyDisplayCompany: [{ type: Input }],
        onlyCurrentAdminOrg: [{ type: Input }],
        selectionsChange: [{ type: Output }]
    };
    return OrganizationComponent;
}());
export { OrganizationComponent };
if (false) {
    /** @type {?} */
    OrganizationComponent.prototype.enableFavorites;
    /** @type {?} */
    OrganizationComponent.prototype.baseCls;
    /** @type {?} */
    OrganizationComponent.prototype.farrisTree;
    /** @type {?} */
    OrganizationComponent.prototype.orgNameCell;
    /** @type {?} */
    OrganizationComponent.prototype.favoritesCell;
    /** @type {?} */
    OrganizationComponent.prototype.primaryField;
    /** @type {?} */
    OrganizationComponent.prototype.enableHierarchicalLoading;
    /** @type {?} */
    OrganizationComponent.prototype.notGetStopOrg;
    /** @type {?} */
    OrganizationComponent.prototype.layer;
    /** @type {?} */
    OrganizationComponent.prototype.multiSelect;
    /** @type {?} */
    OrganizationComponent.prototype.absOrgType;
    /** @type {?} */
    OrganizationComponent.prototype.cascadeCheck;
    /** @type {?} */
    OrganizationComponent.prototype.cascadeUp;
    /** @type {?} */
    OrganizationComponent.prototype.cascadeDown;
    /** @type {?} */
    OrganizationComponent.prototype.showCheckAll;
    /** @type {?} */
    OrganizationComponent.prototype.keepSelect;
    /** @type {?} */
    OrganizationComponent.prototype.pathLength;
    /** @type {?} */
    OrganizationComponent.prototype.orgIds;
    /** @type {?} */
    OrganizationComponent.prototype.selectedLimit;
    /** @type {?} */
    OrganizationComponent.prototype.virtualizedLoad;
    /** @type {?} */
    OrganizationComponent.prototype.isActiveTab;
    /** @type {?} */
    OrganizationComponent.prototype.activeTabId;
    /** @type {?} */
    OrganizationComponent.prototype.dataPermission;
    /** @type {?} */
    OrganizationComponent.prototype.dataPermissionIds;
    /** @type {?} */
    OrganizationComponent.prototype.orgNameType;
    /** @type {?} */
    OrganizationComponent.prototype.onlyDisplayCompany;
    /** @type {?} */
    OrganizationComponent.prototype.onlyCurrentAdminOrg;
    /** @type {?} */
    OrganizationComponent.prototype.selectionsChange;
    /**
     * @type {?}
     * @private
     */
    OrganizationComponent.prototype.selectionsSub;
    /**
     * @type {?}
     * @private
     */
    OrganizationComponent.prototype.favoritesSub;
    /** @type {?} */
    OrganizationComponent.prototype.originalTreeData;
    /** @type {?} */
    OrganizationComponent.prototype.locationOrgText;
    /** @type {?} */
    OrganizationComponent.prototype.treeListData;
    /** @type {?} */
    OrganizationComponent.prototype.treeTableCols;
    /** @type {?} */
    OrganizationComponent.prototype.selections;
    /** @type {?} */
    OrganizationComponent.prototype.favoritesList;
    /** @type {?} */
    OrganizationComponent.prototype.initLoad;
    /** @type {?} */
    OrganizationComponent.prototype.checkedOrgs;
    /**
     * @type {?}
     * @private
     */
    OrganizationComponent.prototype.loadingService;
    /**
     * @type {?}
     * @private
     */
    OrganizationComponent.prototype.localeService;
    /** @type {?} */
    OrganizationComponent.prototype.dataToChecked;
    /** @type {?} */
    OrganizationComponent.prototype.dataToSelected;
    /**
     * @type {?}
     * @private
     */
    OrganizationComponent.prototype.orgTreeTimer;
    /** @type {?} */
    OrganizationComponent.prototype.currentTabId;
    /** @type {?} */
    OrganizationComponent.prototype.currentUserOrgId;
    /** @type {?} */
    OrganizationComponent.prototype.currentUserOrgPath;
    /** @type {?} */
    OrganizationComponent.prototype.allAdminOrgData;
    /** @type {?} */
    OrganizationComponent.prototype.currentAdminOrgPath;
    /** @type {?} */
    OrganizationComponent.prototype.orgTypeId;
    /** @type {?} */
    OrganizationComponent.prototype.deptTypeId;
    /** @type {?} */
    OrganizationComponent.prototype.beforeClickNode;
    /** @type {?} */
    OrganizationComponent.prototype.beforeCheckAll;
    /**
     * @type {?}
     * @private
     */
    OrganizationComponent.prototype.apiService;
    /**
     * @type {?}
     * @private
     */
    OrganizationComponent.prototype.cdr;
    /**
     * @type {?}
     * @private
     */
    OrganizationComponent.prototype.favoritesTool;
    /**
     * @type {?}
     * @private
     */
    OrganizationComponent.prototype.injector;
    /**
     * @type {?}
     * @private
     */
    OrganizationComponent.prototype.ngZone;
    /**
     * @type {?}
     * @private
     */
    OrganizationComponent.prototype.stateMgr;
    /**
     * @type {?}
     * @private
     */
    OrganizationComponent.prototype.msgService;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidG8uY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGZhcnJpcy91aS1hZG1pbm9yZ2FuaXphdGlvbi1zZWxlY3Rvci8iLCJzb3VyY2VzIjpbImxpYi90YWItb3JnYW5pemF0aW9uL3RvLmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxPQUFPLEVBQ0gsU0FBUyxFQUFFLEtBQUssRUFBRSxZQUFZLEVBQUUsTUFBTSxFQUFtRCxpQkFBaUIsRUFBWSxRQUFRLEVBQUUsU0FBUyxFQUFFLFdBQVcsRUFBRSxXQUFXLEVBQUUsTUFBTSxFQUM5SyxNQUFNLGVBQWUsQ0FBQztBQUN2QixPQUFPLEVBQUUsVUFBVSxFQUFFLE1BQU0seUJBQXlCLENBQUM7QUFDckQsT0FBTyxLQUFLLENBQUMsTUFBTSxXQUFXLENBQUM7QUFFL0IsT0FBTyxFQUFZLEVBQUUsRUFBRSxNQUFNLE1BQU0sQ0FBQztBQUNwQyxPQUFPLEVBQUUsYUFBYSxFQUFFLE1BQU0sNEJBQTRCLENBQUM7QUFDM0QsT0FBTyxFQUFFLFVBQVUsRUFBbUIsTUFBTSx3QkFBd0IsQ0FBQztBQUNyRSxPQUFPLEVBQUUsVUFBVSxFQUFFLE1BQU0seUJBQXlCLENBQUM7QUFDckQsT0FBTyxFQUFZLGtCQUFrQixFQUFFLE1BQU0sc0JBQXNCLENBQUM7QUFDcEUsT0FBTyxFQUFFLFlBQVksRUFBRSxNQUFNLDRCQUE0QixDQUFDO0FBRTFELE9BQU8sRUFBRSxTQUFTLEVBQU8sTUFBTSxnQkFBZ0IsQ0FBQztBQUNoRCxPQUFPLEVBQUUsZUFBZSxFQUFFLE1BQU0scUJBQXFCLENBQUM7QUFDdEQsT0FBTyxFQUFFLGNBQWMsRUFBRSxNQUFNLG9CQUFvQixDQUFDO0FBQ3BELE9BQU8sRUFBRSxhQUFhLEVBQUUsTUFBTSxtQkFBbUIsQ0FBQztBQUNsRCxPQUFPLEVBQUUsNEJBQTRCLEVBQUUsTUFBTSxvQkFBb0IsQ0FBQztBQUVsRTtJQTBJSSwrQkFDWSxVQUFzQixFQUN0QixHQUFz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OEI7Ozs7O0lBQzlCLG9DQUE4Qjs7Ozs7SUFDOUIsOENBQW9DOzs7OztJQUNwQyx5Q0FBMEI7Ozs7O0lBQzFCLHVDQUFzQjs7Ozs7SUFDdEIseUNBQThCOzs7OztJQUM5QiwyQ0FBbUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xyXG4gICAgQ29tcG9uZW50LCBJbnB1dCwgRXZlbnRFbWl0dGVyLCBPdXRwdXQsIE9uSW5pdCwgQWZ0ZXJWaWV3SW5pdCwgU2ltcGxlQ2hhbmdlcywgT25DaGFuZ2VzLCBDaGFuZ2VEZXRlY3RvclJlZiwgT3B0aW9uYWwsIEluamVjdG9yLCBWaWV3Q2hpbGQsIFRlbXBsYXRlUmVmLCBIb3N0QmluZGluZywgTmdab25lLCBPbkRlc3Ryb3lcclxufSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgQXBpU2VydmljZSB9IGZyb20gJy4uLy4uL3V0aWxzL2FwaS5zZXJ2aWNlJztcclxuaW1wb3J0ICogYXMgXyBmcm9tICdsb2Rhc2gtZXMnO1xyXG5pbXBvcnQgeyBub0RhdGFJbWcgfSBmcm9tICcuLi8uLi9hc3NldHMvcmVzb3VyY2UnO1xyXG5pbXBvcnQgeyBmb3JrSm9pbiwgb2YgfSBmcm9tICdyeGpzJztcclxuaW1wb3J0IHsgRmF2b3JpdGVzVG9vbCB9IGZyb20gJy4uLy4uL3V0aWxzL2Zhdm9yaXRlcy50b29sJztcclxuaW1wb3J0IHsgQ2hhbmdlVHlwZSwgT3JnUmVxdWVzdFBhcmFtIH0gZnJvbSAnLi4vLi4vdXRpbHMvaW5kZXgudHlwZSc7XHJcbmltcG9ydCB7IENvbW1vblV0aWwgfSBmcm9tICcuLi8uLi91dGlscy9jb21tb24udG9vbCc7XHJcbmltcG9ydCB7IFRyZWVOb2RlLCBUcmVlVGFibGVDb21wb25lbnQgfSBmcm9tICdAZmFycmlzL3VpLXRyZWV0YWJsZSc7XHJcbmltcG9ydCB7IFN0YXRlTWdyVG9vbCB9IGZyb20gJy4uLy4uL3V0aWxzL3N0YXRlLm1nci50b29sJztcclxuaW1wb3J0IHsgU3Vic2NyaXB0aW9uIH0gZnJvbSAncnhqcyc7XHJcbmltcG9ydCB7IHN3aXRjaE1hcCwgdGFwIH0gZnJvbSAncnhqcy9vcGVyYXRvcnMnO1xyXG5pbXBvcnQgeyBNZXNzYWdlclNlcnZpY2UgfSBmcm9tICdAZmFycmlzL3VpLW1lc3NhZ2VyJztcclxuaW1wb3J0IHsgTG9hZGluZ1NlcnZpY2UgfSBmcm9tICdAZmFycmlzL3VpLWxvYWRpbmcnO1xyXG5pbXBvcnQgeyBMb2NhbGVTZXJ2aWNlIH0gZnJvbSAnQGZhcnJpcy91aS1sb2NhbGUnO1xyXG5pbXBvcnQgeyBPUkdBTklaQVRJT05fU0VMRUNUT1JfTE9DQUxFIH0gZnJvbSAnLi4vLi4vdXRpbHMvbG9jYWxlJztcclxuXHJcbkBDb21wb25lbnQoe1xyXG4gICAgc2VsZWN0b3I6ICdsaWItb3JnJyxcclxuICAgIHRlbXBsYXRlVXJsOiAnLi90by5jb21wb25lbnQuaHRtbCcsXHJcbiAgICBzdHlsZVVybHM6IFsnLi90by5jb21wb25lbnQuY3NzJ10sXHJcbn0pXHJcbmV4cG9ydCBjbGFzcyBPcmdhbml6YXRpb25Db21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQsIEFmdGVyVmlld0luaXQsIE9uQ2hhbmdlcywgT25EZXN0cm95IHtcclxuXHJcbiAgICBASW5wdXQoKSBlbmFibGVGYXZvcml0ZXM6IGJvb2xlYW47XHJcbiAgICBASG9zdEJpbmRpbmcoJ2NsYXNzLmYtdXRpbHMtZmlsbC1mbGV4LWNvbHVtbicpIGJhc2VDbHMgPSB0cnVlO1xyXG4gICAgQFZpZXdDaGlsZCgnZmFycmlzdHJlZScpIGZhcnJpc1RyZWU6IFRyZWVUYWJsZUNvbXBvbmVudDtcclxuICAgIEBWaWV3Q2hpbGQoJ29yZ05hbWVDZWxsJykgb3JnTmFtZUNlbGw6IFRlbXBsYXRlUmVmPGFueT47XHJcbiAgICBAVmlld0NoaWxkKCdmYXZvcml0ZXNDZWxsJykgZmF2b3JpdGVzQ2VsbDogVGVtcGxhdGVSZWY8YW55PjtcclxuICAgIEBJbnB1dCgpIHByaW1hcnlGaWVsZCA9ICdvcmdJZCc7XHJcbiAgICBASW5wdXQoKSBlbmFibGVIaWVyYXJjaGljYWxMb2FkaW5nOiBib29sZWFuO1xyXG4gICAgQElucHV0KCkgbm90R2V0U3RvcE9yZzogYm9vbGVhbjtcclxuICAgIEBJbnB1dCgpIGxheWVyOiBudW1iZXI7XHJcbiAgICBASW5wdXQoKSBtdWx0aVNlbGVjdDogYm9vbGVhbjtcclxuICAgIEBJbnB1dCgpIGFic09yZ1R5cGU6IGFueTtcclxuICAgIEBJbnB1dCgpIGNhc2NhZGVDaGVjazogYm9vbGVhbjtcclxuICAgIEBJbnB1dCgpIGNhc2NhZGVVcDogYm9vbGVhbjtcclxuICAgIEBJbnB1dCgpIGNhc2NhZGVEb3duOiBib29sZWFuO1xyXG4gICAgQElucHV0KCkgc2hvd0NoZWNrQWxsOiBib29sZWFuO1xyXG4gICAgQElucHV0KCkga2VlcFNlbGVjdDogYm9vbGVhbjtcclxuICAgIEBJbnB1dCgpIHBhdGhMZW5ndGggPSA0O1xyXG4gICAgLy8g5bey6YCJ5Lit57uE57uH55qEaWQsIOagueaNrue7hOe7h2lk6I635Y+W57uE57uH5a6M5pW05L+h5oGv77yM54S25ZCO6L+95Yqg5Yiwc2VsZWN0aW9ucy0tLXRvZG9cclxuICAgIEBJbnB1dCgpIG9yZ0lkczogc3RyaW5nW107XHJcbiAgICBASW5wdXQoKSBzZWxlY3RlZExpbWl0OiBudW1iZXI7XHJcbiAgICBASW5wdXQoKSB2aXJ0dWFsaXplZExvYWQ6IGJvb2xlYW47XHJcbiAgICBASW5wdXQoKSBpc0FjdGl2ZVRhYjogYm9vbGVhbjtcclxuICAgIEBJbnB1dCgpIGFjdGl2ZVRhYklkOiBzdHJpbmc7XHJcbiAgICBASW5wdXQoKSBkYXRhUGVybWlzc2lvbiA9IGZhbHNlO1xyXG4gICAgQElucHV0KCkgZGF0YVBlcm1pc3Npb25JZHM6IHN0cmluZ1tdID0gW107XHJcbiAgICBASW5wdXQoKSBvcmdOYW1lVHlwZTogc3RyaW5nO1xyXG4gICAgQElucHV0KCkgb25seURpc3BsYXlDb21wYW55OiBib29sZWFuO1xyXG4gICAgQElucHV0KCkgb25seUN1cnJlbnRBZG1pbk9yZzogYm9vbGVhbjtcclxuICAgIEBPdXRwdXQoKSBzZWxlY3Rpb25zQ2hhbmdlID0gbmV3IEV2ZW50RW1pdHRlcjxhbnk+KCk7XHJcblxyXG4gICAgcHJpdmF0ZSBzZWxlY3Rpb25zU3ViOiBTdWJzY3JpcHRpb247XHJcbiAgICBwcml2YXRlIGZhdm9yaXRlc1N1YjogU3Vic2NyaXB0aW9uO1xyXG4gICAgb3JpZ2luYWxUcmVlRGF0YSA9IFtdO1xyXG4gICAgbG9jYXRpb25PcmdUZXh0ID0gJyc7XHJcbiAgICB0cmVlTGlzdERhdGE6IFRyZWVOb2RlW10gPSBbXTtcclxuICAgIHRyZWVUYWJsZUNvbHMgPSBbXTtcclxuICAgIHNlbGVjdGlvbnMgPSBbXTtcclxuICAgIGZhdm9yaXRlc0xpc3QgPSBbXTtcclxuICAgIGluaXRMb2FkID0gdHJ1ZTtcclxuICAgIGNoZWNrZWRPcmdzID0gW107XHJcbiAgICBwcml2YXRlIGxvYWRpbmdTZXJ2aWNlOiBMb2FkaW5nU2VydmljZSA9IG51bGw7XHJcbiAgICBwcml2YXRlIGxvY2FsZVNlcnZpY2U6IExvY2FsZVNlcnZpY2UgPSBudWxsO1xyXG4gICAgZGF0YVRvQ2hlY2tlZCA9IFtdO1xyXG4gICAgZGF0YVRvU2VsZWN0ZWQ6IGFueTtcclxuICAgIHByaXZhdGUgb3JnVHJlZVRpbWVyOiBhbnk7XHJcbiAgICBjdXJyZW50VGFiSWQ6IHN0cmluZztcclxuICAgIFxyXG4gICAgY3VycmVudFVzZXJPcmdJZDogc3RyaW5nO1xyXG4gICAgY3VycmVudFVzZXJPcmdQYXRoOiBzdHJpbmc7XHJcbiAgICBhbGxBZG1pbk9yZ0RhdGE6IGFueVtdID0gW107XHJcbiAgICBjdXJyZW50QWRtaW5PcmdQYXRoOiBzdHJpbmc7XHJcbiAgICBvcmdUeXBlSWQgPSAnOWVkZjI1ZDEtYjk5MS00ZGRlLTkwYjktMzAxNDU0MjJkMjRkJztcclxuICAgIGRlcHRUeXBlSWQgPSAnMzNjMjE1MDQtMzM4NC00MmE3LThmYzMtYzFiNWU5ZTk4MmQwJztcclxuXHJcbiAgICBiZWZvcmVDbGlja05vZGUgPSAoZSkgPT4ge1xyXG4gICAgICAgIGlmICghdGhpcy5lbmFibGVIaWVyYXJjaGljYWxMb2FkaW5nKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBvZih0cnVlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKCF0aGlzLm11bHRpU2VsZWN0KSB7XHJcbiAgICAgICAgICAgIGlmIChlLnJvd05vZGUuaXNTZWxlY3RlZCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXRTZWxlY3Rpb25zKFtdKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0U2VsZWN0aW9ucyhuZXcgQXJyYXkoZS5yb3dOb2RlLm5vZGUuZGF0YSkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBvZihmYWxzZSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBjb25zdCBwYXJhbTogT3JnUmVxdWVzdFBhcmFtID0ge1xyXG4gICAgICAgIC8vICAgICBhYnNPcmdUeXBlOiB0aGlzLmFic09yZ1R5cGUsXHJcbiAgICAgICAgLy8gICAgIG5vdEdldFN0b3BPcmc6IHRoaXMubm90R2V0U3RvcE9yZyxcclxuICAgICAgICAvLyAgICAgZ2V0Q3VyVXNlcjogZmFsc2UsXHJcbiAgICAgICAgLy8gICAgIHBhcmVudElEOiBlLnJvd05vZGUuaWQsXHJcbiAgICAgICAgLy8gICAgIHdpdGhBbGxTdWI6IHRydWUsXHJcbiAgICAgICAgLy8gICAgIGdldE9yZ0FsbFBhdGg6IHRydWVcclxuICAgICAgICAvLyB9O1xyXG4gICAgICAgIC8vIHJldHVybiB0aGlzLmFwaVNlcnZpY2UuZ2V0T3JnYW5pemF0aW9uKHBhcmFtKS5waXBlKFxyXG4gICAgICAgIC8vICAgICBzd2l0Y2hNYXAoXHJcbiAgICAgICAgLy8gICAgICAgICAoZGF0YTogYW55KSA9PiB7XHJcbiAgICAgICAgLy8gICAgICAgICAgICAgLy8gaWYgKGRhdGFbJ2RhdGEnXS5sZW5ndGggPiB0aGlzLnNlbGVjdGVkTGltaXQgJiYgIWUucm93Tm9kZS5pc0NoZWNrZWQpIHtcclxuICAgICAgICAvLyAgICAgICAgICAgICAvLyAgICAgdGhpcy5tc2dTZXJ2aWNlLnNob3coJ3dhcm5pbmcnLCBg5Lqy77yM5LiA5qyh5oCn6YCJ5oup5LqG6LaF6L+HJHt0aGlzLnNlbGVjdGVkTGltaXR95p2h5pWw5o2ufmAsIHRydWUpO1xyXG4gICAgICAgIC8vICAgICAgICAgICAgIC8vICAgICByZXR1cm4gb2YoZmFsc2UpXHJcbiAgICAgICAgLy8gICAgICAgICAgICAgLy8gfVxyXG4gICAgICAgIC8vICAgICAgICAgICAgIC8vIGlmICghZS5yb3dOb2RlLmlzQ2hlY2tlZCkge1xyXG4gICAgICAgIC8vICAgICAgICAgICAgIC8vICAgICAvLyB0b2RvIOW+hemqjOivge+8jOWKoOWFpXNlbGVjdGlvbu+8jFxyXG4gICAgICAgIC8vICAgICAgICAgICAgIC8vICAgICBkYXRhLmRhdGEuZm9yRWFjaChpdGVtID0+IHtcclxuICAgICAgICAvLyAgICAgICAgICAgICAvLyAgICAgICAgIGlmIChDb21tb25VdGlsLmZpbmRJbmRleChpdGVtW3RoaXMucHJpbWFyeUZpZWxkXSwgdGhpcy5wcmltYXJ5RmllbGQsIHRoaXMuc2VsZWN0aW9ucykgPT09IC0xKSB7XHJcbiAgICAgICAgLy8gICAgICAgICAgICAgLy8gICAgICAgICAgICAgdGhpcy5zZXRTZWxlY3Rpb25zKGl0ZW0sIENoYW5nZVR5cGUuQXBwZW5kLCAnb3RoZXInKTtcclxuICAgICAgICAvLyAgICAgICAgICAgICAvLyAgICAgICAgIH1cclxuICAgICAgICAvLyAgICAgICAgICAgICAvLyAgICAgfSlcclxuICAgICAgICAvLyAgICAgICAgICAgICAvLyB9IGVsc2Uge1xyXG4gICAgICAgIC8vICAgICAgICAgICAgIC8vICAgICB0aGlzLnNlbGVjdGlvbnMuZm9yRWFjaCgoc2VsZWN0aW9uLCBpbmRleCkgPT4ge1xyXG4gICAgICAgIC8vICAgICAgICAgICAgIC8vICAgICAgICAgZGF0YS5kYXRhLmZvckVhY2goaXRlbSA9PiB7XHJcbiAgICAgICAgLy8gICAgICAgICAgICAgLy8gICAgICAgICAgICAgaWYgKHNlbGVjdGlvblt0aGlzLnByaW1hcnlGaWVsZF0gPT09IGl0ZW1bdGhpcy5wcmltYXJ5RmllbGRdKSB7XHJcbiAgICAgICAgLy8gICAgICAgICAgICAgLy8gICAgICAgICAgICAgICAgIHRoaXMuc2V0U2VsZWN0aW9ucyhpdGVtLCBDaGFuZ2VUeXBlLlJlbW92ZSwgJ290aGVyJyk7XHJcbiAgICAgICAgLy8gICAgICAgICAgICAgLy8gICAgICAgICAgICAgfVxyXG4gICAgICAgIC8vICAgICAgICAgICAgIC8vICAgICAgICAgfSk7XHJcbiAgICAgICAgLy8gICAgICAgICAgICAgLy8gICAgIH0pO1xyXG4gICAgICAgIC8vICAgICAgICAgICAgIC8vIH1cclxuICAgICAgICAvLyAgICAgICAgICAgICAvLyB0aGlzLmNkci5kZXRlY3RDaGFuZ2VzKCk7XHJcbiAgICAgICAgLy8gICAgICAgICAgICAgcmV0dXJuIG9mKHRydWUpO1xyXG4gICAgICAgIC8vICAgICAgICAgfVxyXG4gICAgICAgIC8vICAgICApXHJcbiAgICAgICAgLy8gKTtcclxuICAgIH07XHJcblxyXG4gICAgYmVmb3JlQ2hlY2tBbGwgPSAoZSkgPT4ge1xyXG4gICAgICAgIGlmICghdGhpcy5lbmFibGVIaWVyYXJjaGljYWxMb2FkaW5nKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBvZih0cnVlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgcGFyYW06IE9yZ1JlcXVlc3RQYXJhbSA9IHtcclxuICAgICAgICAgICAgYWJzT3JnVHlwZTogdGhpcy5hYnNPcmdUeXBlLFxyXG4gICAgICAgICAgICBub3RHZXRTdG9wT3JnOiB0aGlzLm5vdEdldFN0b3BPcmcsXHJcbiAgICAgICAgICAgIGdldEN1clVzZXI6IGZhbHNlLFxyXG4gICAgICAgICAgICBwYXJlbnRJRDogZS5pbnN0YW5jZS5kYXRhWzBdLmlkLFxyXG4gICAgICAgICAgICB3aXRoQWxsU3ViOiB0cnVlLFxyXG4gICAgICAgICAgICBnZXRPcmdBbGxQYXRoOiB0cnVlXHJcbiAgICAgICAgfTtcclxuICAgICAgICByZXR1cm4gdGhpcy5hcGlTZXJ2aWNlLmdldE9yZ2FuaXphdGlvbihwYXJhbSkucGlwZShcclxuICAgICAgICAgICAgc3dpdGNoTWFwKFxyXG4gICAgICAgICAgICAgICAgKGRhdGE6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIGlmIChkYXRhWydkYXRhJ10ubGVuZ3RoID4gdGhpcy5zZWxlY3RlZExpbWl0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgIHRoaXMubXNnU2VydmljZS5zaG93KCd3YXJuaW5nJywgYOS6su+8jOS4gOasoeaAp+mAieaLqeS6hui2hei/hyR7dGhpcy5zZWxlY3RlZExpbWl0feadoeaVsOaNrn5gLCB0cnVlKTtcclxuICAgICAgICAgICAgICAgICAgICAvLyAgICAgcmV0dXJuIG9mKGZhbHNlKVxyXG4gICAgICAgICAgICAgICAgICAgIC8vIH1cclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNldFNlbGVjdGlvbnMoZGF0YVsnZGF0YSddLCBDaGFuZ2VUeXBlLlZhbHVlQ2hhbmdlZCwgJ290aGVyJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG9mKHRydWUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICApXHJcbiAgICAgICAgKTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdHJ1Y3RvcihcclxuICAgICAgICBwcml2YXRlIGFwaVNlcnZpY2U6IEFwaVNlcnZpY2UsXHJcbiAgICAgICAgcHJpdmF0ZSBjZHI6IENoYW5nZURldGVjdG9yUmVmLFxyXG4gICAgICAgIHByaXZhdGUgZmF2b3JpdGVzVG9vbDogRmF2b3JpdGVzVG9vbCxcclxuICAgICAgICBwcml2YXRlIGluamVjdG9yOiBJbmplY3RvcixcclxuICAgICAgICBwcml2YXRlIG5nWm9uZTogTmdab25lLFxyXG4gICAgICAgIHByaXZhdGUgc3RhdGVNZ3I6IFN0YXRlTWdyVG9vbCxcclxuICAgICAgICBwcml2YXRlIG1zZ1NlcnZpY2U6IE1lc3NhZ2VyU2VydmljZVxyXG4gICAgKSB7XHJcbiAgICAgICAgdGhpcy5jZHIgPSB0aGlzLmluamVjdG9yLmdldChDaGFuZ2VEZXRlY3RvclJlZik7XHJcbiAgICAgICAgdGhpcy5sb2FkaW5nU2VydmljZSA9IHRoaXMuaW5qZWN0b3IuZ2V0KExvYWRpbmdTZXJ2aWNlLCBudWxsKTtcclxuICAgICAgICB0aGlzLmxvY2FsZVNlcnZpY2UgPSB0aGlzLmluamVjdG9yLmdldChMb2NhbGVTZXJ2aWNlKTtcclxuICAgICAgICBpZighdGhpcy5sb2NhbGVTZXJ2aWNlLmxhbmdEYXRhWydvcmdhbml6YXRpb25TZWxlY3RvciddKSB7XHJcbiAgICAgICAgICAgIHRoaXMubG9jYWxlU2VydmljZS5zZXRMb2NhbGVEYXRhKE9SR0FOSVpBVElPTl9TRUxFQ1RPUl9MT0NBTEUpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBuZ09uRGVzdHJveSgpOiB2b2lkIHtcclxuICAgICAgICB0aGlzLmZhdm9yaXRlc1N1Yi51bnN1YnNjcmliZSgpO1xyXG4gICAgICAgIHRoaXMuc2VsZWN0aW9uc1N1Yi51bnN1YnNjcmliZSgpO1xyXG4gICAgfVxyXG5cclxuICAgIG5nT25Jbml0KCk6IHZvaWQge1xyXG4gICAgICAgIHRoaXMudHJlZVRhYmxlQ29scyA9IFtcclxuICAgICAgICAgICAgeyBmaWVsZDogJ25hbWUnLCB0aXRsZTogdGhpcy5sb2NhbGVTZXJ2aWNlLmdldFZhbHVlKFwib3JnYW5pemF0aW9uU2VsZWN0b3Iub3JnYW5pemF0aW9uLm9yZ05hbWVcIiksIHRlbXBsYXRlOiB0aGlzLm9yZ05hbWVDZWxsIH0sXHJcbiAgICAgICAgICAgIHsgZmllbGQ6ICdhYmJyZXZpYXRpb24nLCB0aXRsZTogdGhpcy5sb2NhbGVTZXJ2aWNlLmdldFZhbHVlKFwib3JnYW5pemF0aW9uU2VsZWN0b3Iub3JnYW5pemF0aW9uLm9yZ0FiYnJldmlhdGlvblwiKSB9XHJcbiAgICAgICAgXTtcclxuICAgICAgICBpZiAodGhpcy5lbmFibGVGYXZvcml0ZXMpIHtcclxuICAgICAgICAgICAgdGhpcy50cmVlVGFibGVDb2xzLnB1c2goe1xyXG4gICAgICAgICAgICAgICAgZmllbGQ6ICcnLFxyXG4gICAgICAgICAgICAgICAgdGl0bGU6IHRoaXMubG9jYWxlU2VydmljZS5nZXRWYWx1ZShcIm9yZ2FuaXphdGlvblNlbGVjdG9yLm9yZ2FuaXphdGlvbi5mYXZvcml0ZVwiKSxcclxuICAgICAgICAgICAgICAgIHRlbXBsYXRlOiB0aGlzLmZhdm9yaXRlc0NlbGxcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHRoaXMudHJlZVRhYmxlQ29sc1swXS53aWR0aCA9IDMwMDtcclxuICAgICAgICAgICAgdGhpcy50cmVlVGFibGVDb2xzWzFdLndpZHRoID0gMzAwO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCBwYXJhbTogYW55ID0ge1xyXG4gICAgICAgICAgICB3aXRoRGlzYWJsZWRPcmc6ICF0aGlzLm5vdEdldFN0b3BPcmcsXHJcbiAgICAgICAgICAgIGdldHRpbmdDdXJyZW50T3JnOiBmYWxzZSxcclxuICAgICAgICAgICAgb25seURpc3BsYXlPcmc6IGZhbHNlXHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLmFwaVNlcnZpY2UuZ2V0T3JnYW5pemF0aW9ucyhwYXJhbSkuc3Vic2NyaWJlKChyZXM6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICBpZihyZXMgJiYgcmVzLm9yZ3MpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuYWxsQWRtaW5PcmdEYXRhID0gcmVzLm9yZ3M7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5pbml0TG9hZCAmJiB0aGlzLmlzQWN0aXZlVGFiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYodGhpcy5lbmFibGVIaWVyYXJjaGljYWxMb2FkaW5nKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaGxBc3NlbWJsZURhdGEoKTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFzc2VtYmxlRGF0YSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmluaXRMb2FkID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLmZhdm9yaXRlc1N1YiA9IHRoaXMuZmF2b3JpdGVzVG9vbC5mYXZvcml0ZXNTdWJqZWN0LnN1YnNjcmliZShkYXRhID0+IHtcclxuICAgICAgICAgICAgdGhpcy5mYXZvcml0ZXNMaXN0ID0gZGF0YTtcclxuICAgICAgICAgICAgdGhpcy5zZXRGYXZvcml0ZXModGhpcy50cmVlTGlzdERhdGEpO1xyXG4gICAgICAgICAgICB0aGlzLmZhcnJpc1RyZWUuZGV0ZWN0Q2hhbmdlcygpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMuY3VycmVudFRhYklkID0gdGhpcy5hY3RpdmVUYWJJZDtcclxuICAgICAgICB0aGlzLnNlbGVjdGlvbnNTdWIgPSB0aGlzLnN0YXRlTWdyLnNlbGVjdGlvbnNTdWJqZWN0LnN1YnNjcmliZShkYXRhID0+IHtcclxuICAgICAgICAgICAgaWYgKGRhdGEuY2hhbmdlVHlwZSA9PT0gQ2hhbmdlVHlwZS5WYWx1ZUNoYW5nZWQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0aW9ucyA9IF8uY2xvbmVEZWVwKGRhdGEudmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuc2VsZWN0aW9ucy5sZW5ndGggPT09IDApIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmRhdGFUb1NlbGVjdGVkID0gbnVsbDtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmRhdGFUb0NoZWNrZWQgPSBbXTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmZhcnJpc1RyZWUuY2xlYXJDaGVja2VkcygpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZmFycmlzVHJlZS5jbGVhclNlbGVjdGlvbnMoKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmZhcnJpc1RyZWUuZGV0ZWN0Q2hhbmdlcygpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKGRhdGEuY2hhbmdlVHlwZSA9PT0gQ2hhbmdlVHlwZS5SZW1vdmUpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0aW9ucyA9IHRoaXMuc2VsZWN0aW9ucy5maWx0ZXIoaXRlbSA9PiBpdGVtWydpZCddICE9PSBkYXRhLnZhbHVlWydpZCddKTtcclxuICAgICAgICAgICAgICAgIGlmKGRhdGEuZnJvbSA9PSAnc2VsZWN0aW9uJyAmJiB0aGlzLmN1cnJlbnRUYWJJZCA9PSAnb3JnYW5pemF0aW9uJykge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaW5UcmVlTGlzdCh0aGlzLnRyZWVMaXN0RGF0YSwgZGF0YS52YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYoZGF0YS52YWx1ZS5pblRyZWVMaXN0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKHRoaXMubXVsdGlTZWxlY3QpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZmFycmlzVHJlZS51bkNoZWNrZWROb2RlKGRhdGEudmFsdWVbJ2lkJ10pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5mYXJyaXNUcmVlLmNsZWFyQWxsKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoZGF0YS5jaGFuZ2VUeXBlID09PSBDaGFuZ2VUeXBlLkFwcGVuZCkge1xyXG4gICAgICAgICAgICAgICAgQ29tbW9uVXRpbC5maW5kSW5kZXgoZGF0YS52YWx1ZVsnaWQnXSwgJ2lkJywgdGhpcy5zZWxlY3Rpb25zKSA9PT0gLTEgPyB0aGlzLnNlbGVjdGlvbnMucHVzaChkYXRhLnZhbHVlKSA6IG51bGw7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBuZ0FmdGVyVmlld0luaXQoKTogdm9pZCB7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIG5nT25DaGFuZ2VzKGNoYW5nZXM6IFNpbXBsZUNoYW5nZXMpOiB2b2lkIHtcclxuICAgICAgICAvKlxyXG4gICAgICAgIGNvbnN0IG9yZ0lkc0NoYW5nZSA9IGNoYW5nZXMub3JnSWRzO1xyXG4gICAgICAgIGlmIChvcmdJZHNDaGFuZ2UgJiYgb3JnSWRzQ2hhbmdlLmN1cnJlbnRWYWx1ZSkge1xyXG4gICAgICAgICAgICB0aGlzLmNoZWNrZWRPcmdzID0gb3JnSWRzQ2hhbmdlLmN1cnJlbnRWYWx1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgKi9cclxuICAgIH1cclxuXHJcbiAgICAvLyDliJ3lp4t0YWLpobXkuI3kuLrnu4Tnu4fmnrbmnoTvvIzliIfmjaLoh7Pnu4Tnu4fmnrbmnoTml7bojrflj5bnu4Tnu4fmlbDmja5cclxuICAgIGxvYWRUcmVlRGF0YSgpIHtcclxuICAgICAgICBpZih0aGlzLmluaXRMb2FkKSB7XHJcbiAgICAgICAgICAgIGlmKHRoaXMuZW5hYmxlSGllcmFyY2hpY2FsTG9hZGluZykge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5obEFzc2VtYmxlRGF0YSgpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5hc3NlbWJsZURhdGEoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLmluaXRMb2FkID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8vIOiuvue9ruW9k+WJjee7hOe7h+agkeWQhOS4quiKgueCueeahOaUtuiXj+eKtuaAgVxyXG4gICAgcHJpdmF0ZSBzZXRGYXZvcml0ZXModHJlZUxpc3REYXRhOiBUcmVlTm9kZVtdKSB7XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0cmVlTGlzdERhdGEubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgaWYgKENvbW1vblV0aWwuZmluZEluZGV4KHRyZWVMaXN0RGF0YVtpXS5pZCwgJ2lkJywgdGhpcy5mYXZvcml0ZXNMaXN0KSA9PT0gLTEpIHtcclxuICAgICAgICAgICAgICAgIHRyZWVMaXN0RGF0YVtpXS5kYXRhLmluRmF2b3JpdGVzID0gZmFsc2U7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0cmVlTGlzdERhdGFbaV0uZGF0YS5pbkZhdm9yaXRlcyA9IHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHRyZWVMaXN0RGF0YVtpXS5jaGlsZHJlbi5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0RmF2b3JpdGVzKHRyZWVMaXN0RGF0YVtpXS5jaGlsZHJlbik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBzZXRTZWxlY3Rpb25zKHNlbGVjdGlvbnM6IGFueSwgY2hhbmdlVHlwZSA9IENoYW5nZVR5cGUuVmFsdWVDaGFuZ2VkLCBmcm9tOiBzdHJpbmcgPSAndHJlZScpIHtcclxuICAgICAgICB0aGlzLnN0YXRlTWdyLmVtaXRTZWxlY3Rpb25zKHNlbGVjdGlvbnMsIGNoYW5nZVR5cGUsIGZyb20pO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIOe7hOe7h+agkeWFqOmAieS6i+S7tlxyXG4gICAgY2hlY2tBbGwoKSB7XHJcbiAgICAgICAgaWYgKCF0aGlzLmVuYWJsZUhpZXJhcmNoaWNhbExvYWRpbmcpIHtcclxuICAgICAgICAgICAgY29uc3QgY2hlY2tlZHMgPSBbXTtcclxuICAgICAgICAgICAgdGhpcy5mYXJyaXNUcmVlLmNoZWNrZWRzLmZvckVhY2goaXRlbSA9PiB7XHJcbiAgICAgICAgICAgICAgICBjaGVja2Vkcy5wdXNoKGl0ZW0uZGF0YSk7XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIHRoaXMuc2V0U2VsZWN0aW9ucyhjaGVja2Vkcyk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8vIOe7hOe7h+agkeWPlua2iOWFqOmAieS6i+S7tlxyXG4gICAgdW5DaGVja0FsbCgpIHtcclxuICAgICAgICB0aGlzLnNldFNlbGVjdGlvbnMoW10pO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIOmAieS4re+8iOWPlua2iOmAieS4reOAgeWLvumAieOAgeWPlua2iOWLvumAie+8ieagkeiKgueCueaXtuinpuWPkVxyXG4gICAgLy8gdG9kbyDliIblsYLliqDovb3nmoTml7blgJnlkovlpITnkIbmlbDmja7vvIxiZWZvcmVVbkNoZWNrQWxs6L+Y5pyq5pSv5oyB44CCXHJcbiAgICBjaGFuZ2VTZWxlY3Rpb25zKGU6IGFueSkge1xyXG4gICAgICAgIC8qXHJcbiAgICAgICAgaWYgKCF0aGlzLmVuYWJsZUhpZXJhcmNoaWNhbExvYWRpbmcgJiYgISFlLm9yaWdpbmFsRXZlbnQpIHtcclxuICAgICAgICAgICAgdGhpcy5tdWx0aVNlbGVjdCA/IHRoaXMudG9nZ2xlQ2hlY2tlZChlKSA6IHRoaXMudG9nZ2xlU2VsZWN0ZWQoZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgICovXHJcbiAgICAgICAgdGhpcy5tdWx0aVNlbGVjdCA/IHRoaXMudG9nZ2xlQ2hlY2tlZChlKSA6IHRoaXMudG9nZ2xlU2VsZWN0ZWQoZSk7XHJcbiAgICB9XHJcblxyXG4gICAgdG9nZ2xlQ2hlY2tlZChlOiBhbnkpIHtcclxuICAgICAgICBsZXQgY2hlY2tlZHMgPSBbXTtcclxuICAgICAgICBlICYmIGUuaW5zdGFuY2UgJiYgZS5pbnN0YW5jZS5jaGVja2Vkcy5mb3JFYWNoKGl0ZW0gPT4ge1xyXG4gICAgICAgICAgICBjaGVja2Vkcy5wdXNoKGl0ZW0uZGF0YSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5zZXRTZWxlY3Rpb25zKGNoZWNrZWRzLmNvbmNhdCh0aGlzLmRhdGFUb0NoZWNrZWQpKTtcclxuICAgIH1cclxuXHJcbiAgICB0b2dnbGVTZWxlY3RlZChlOiBhbnkpIHtcclxuICAgICAgICBsZXQgc2VsZWN0ZWQgPSBbXTtcclxuICAgICAgICBlICYmIGUuaW5zdGFuY2UgJiYgZS5pbnN0YW5jZS5zZWxlY3Rpb25zLmZvckVhY2goaXRlbSA9PiB7XHJcbiAgICAgICAgICAgIHNlbGVjdGVkLnB1c2goaXRlbS5kYXRhKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLnNldFNlbGVjdGlvbnMoc2VsZWN0ZWQpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIOagueaNruS8oOWFpeeahOe7hOe7h2lk56Gu5a6a5bey6YCJ5oup57uE57uHXHJcbiAgICBwcml2YXRlIGFzc2VtYmxlRGF0YUJ5T3JnSWRzKGlkczogc3RyaW5nW10pe1xyXG4gICAgICAgIGlmKCFpZHMgfHwgaWRzLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmKGlkcyAmJiBpZHMubGVuZ3RoID4gMCAmJiAhdGhpcy5tdWx0aVNlbGVjdCl7XHJcbiAgICAgICAgICAgIHRoaXMubXNnU2VydmljZS5zaG93KCd3YXJuaW5nJywgdGhpcy5sb2NhbGVTZXJ2aWNlLmdldFZhbHVlKFwib3JnYW5pemF0aW9uU2VsZWN0b3IuZXJyb3JNZXNzYWdlLm11bHRpU2VsZWN0XCIpLCB0cnVlKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCBwYXJhbTogT3JnUmVxdWVzdFBhcmFtID0ge1xyXG4gICAgICAgICAgICBhYnNPcmdUeXBlOiB0aGlzLmFic09yZ1R5cGUsXHJcbiAgICAgICAgICAgIGlkTGlzdDogaWRzLFxyXG4gICAgICAgICAgICBnZXRDdXJVc2VyOiBmYWxzZSxcclxuICAgICAgICAgICAgZ2V0T3JnQWxsUGF0aDogdHJ1ZSxcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMuYXBpU2VydmljZS5nZXRPcmdhbml6YXRpb24ocGFyYW0pLnN1YnNjcmliZSgocmVzOiBhbnkpID0+IHtcclxuICAgICAgICAgICAgaWYgKHJlcyAmJiByZXMuZGF0YSAmJiByZXMuZGF0YS5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNoZWNrZWRPcmdzID0gcmVzLmRhdGE7XHJcbiAgICAgICAgICAgICAgICByZXMuZGF0YS5mb3JFYWNoKGl0ZW0gPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChDb21tb25VdGlsLmZpbmRJbmRleChpdGVtWydpZCddLCAnaWQnLCB0aGlzLnNlbGVjdGlvbnMpID09PSAtMSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNldFNlbGVjdGlvbnMoaXRlbSwgQ2hhbmdlVHlwZS5BcHBlbmQsICdvdGhlcicpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgdGhpcy50aWNrU2VsZWN0aW9ucygpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jZHIuZGV0ZWN0Q2hhbmdlcygpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8g5YiG5bGC5Yqg6L2957uE57uH5qCRXHJcbiAgICBobEFzc2VtYmxlRGF0YSgpIHtcclxuICAgICAgICBpZih0aGlzLmxvYWRpbmdTZXJ2aWNlKSB7XHJcbiAgICAgICAgICAgIHRoaXMubG9hZGluZ1NlcnZpY2Uuc2hvdygpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCBwYXJhbTogYW55ID0ge1xyXG4gICAgICAgICAgICB3aXRoRGlzYWJsZWRPcmc6ICF0aGlzLm5vdEdldFN0b3BPcmcsXHJcbiAgICAgICAgICAgIGdldHRpbmdDdXJyZW50T3JnOiB0cnVlLFxyXG4gICAgICAgICAgICBvbmx5RGlzcGxheU9yZzogdGhpcy5vbmx5RGlzcGxheUNvbXBhbnlcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMuYXBpU2VydmljZS5nZXRPcmdhbml6YXRpb25zV2l0aExheWVyKHBhcmFtKS5zdWJzY3JpYmUoKHJlczogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGlmICghcmVzIHx8ICFyZXMub3Jncykge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBjb25zdCBjdXJyZW50VXNlck9yZyA9IHRoaXMuYWxsQWRtaW5PcmdEYXRhLmZpbmQoZGF0YSA9PiBkYXRhLmlkID09IHJlcy5jdXJyZW50T3JnLm9yZ0lkKTtcclxuICAgICAgICAgICAgaWYodGhpcy5vbmx5RGlzcGxheUNvbXBhbnkpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGFsbFBhdGhJbmZvT3JnTGlzdCA9IHRoaXMuYWxsQWRtaW5PcmdEYXRhLmZpbHRlcihkYXRhID0+IGN1cnJlbnRVc2VyT3JnLnBhdGguc3RhcnRzV2l0aChkYXRhLnBhdGgpICYmIGRhdGEudmFsdWVUeXBlID09IHRoaXMub3JnVHlwZUlkKTtcclxuICAgICAgICAgICAgICAgIGxldCBsYXllciA9IDA7XHJcbiAgICAgICAgICAgICAgICBhbGxQYXRoSW5mb09yZ0xpc3QuZm9yRWFjaChvcmcgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmKE51bWJlcihvcmcubGF5ZXIpID4gbGF5ZXIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50VXNlck9yZ0lkID0gb3JnLmlkO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRVc2VyT3JnUGF0aCA9IG9yZy5wYXRoO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBsYXllciA9IE51bWJlcihvcmcubGF5ZXIpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50VXNlck9yZ0lkID0gY3VycmVudFVzZXJPcmcuaWQ7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRVc2VyT3JnUGF0aCA9IGN1cnJlbnRVc2VyT3JnLnBhdGg7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYodGhpcy5vbmx5Q3VycmVudEFkbWluT3JnKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBkZXB0UGF0aExpc3QgPSBbXTtcclxuICAgICAgICAgICAgICAgIGZvcihsZXQgaSA9IDA7IGkgPCB0aGlzLmN1cnJlbnRVc2VyT3JnUGF0aC5sZW5ndGggLyA0OyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgaW5kZXhEYXRhID0gcmVzLm9yZ3MuZmluZChvcmcgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZihpID09IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBvcmcucGF0aCA9PSB0aGlzLmN1cnJlbnRVc2VyT3JnUGF0aDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBvcmcucGF0aCA9PSB0aGlzLmN1cnJlbnRVc2VyT3JnUGF0aC5zbGljZSgwLCAtNCAqIGkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYoaW5kZXhEYXRhLnZhbHVlVHlwZSA9PSB0aGlzLm9yZ1R5cGVJZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRBZG1pbk9yZ1BhdGggPSBpbmRleERhdGEucGF0aDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYoaW5kZXhEYXRhLnBhdGggIT0gdGhpcy5jdXJyZW50VXNlck9yZ1BhdGgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlcHRQYXRoTGlzdC5wdXNoKGluZGV4RGF0YS5wYXRoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmKHRoaXMuY3VycmVudEFkbWluT3JnUGF0aCA9PSB0aGlzLmN1cnJlbnRVc2VyT3JnUGF0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMub3JpZ2luYWxUcmVlRGF0YSA9IFtyZXMub3Jncy5maW5kKG9yZyA9PiBvcmcucGF0aCA9PSB0aGlzLmN1cnJlbnRVc2VyT3JnUGF0aCldO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBkZXB0UGF0aExpc3QucHVzaCh0aGlzLmN1cnJlbnRBZG1pbk9yZ1BhdGgpO1xyXG4gICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgaXRlbSBvZiBkZXB0UGF0aExpc3QpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHRhcmdldE9yZ0RhdGEgPSB0aGlzLmFsbEFkbWluT3JnRGF0YS5maWx0ZXIob3JnID0+IG9yZy5wYXRoLnNsaWNlKDAsIC00KSA9PSBpdGVtICYmIG9yZy52YWx1ZVR5cGUgPT0gdGhpcy5kZXB0VHlwZUlkICYmICFvcmcuZGlzYWJsZWQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9yaWdpbmFsVHJlZURhdGEgPSB0aGlzLm9yaWdpbmFsVHJlZURhdGEuY29uY2F0KHRhcmdldE9yZ0RhdGEgfHwgW10pO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB0aGlzLm9yaWdpbmFsVHJlZURhdGEucHVzaChyZXMub3Jncy5maW5kKG9yZyA9PiBvcmcucGF0aCA9PSB0aGlzLmN1cnJlbnRBZG1pbk9yZ1BhdGgpKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGZvcihsZXQgaSA9IHRoaXMuY3VycmVudFVzZXJPcmdQYXRoLmxlbmd0aCAvIDQsIGluZGV4ID0gMTsgaSA+IDE7IGktLSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCB0YXJnZXRPcmdEYXRhID0gdGhpcy5hbGxBZG1pbk9yZ0RhdGEuZmlsdGVyKG9yZyA9PiBOdW1iZXIob3JnWydsYXllciddKSA9PSBpICYmIG9yZy5wYXRoLnNsaWNlKDAsIC00KSA9PSB0aGlzLmN1cnJlbnRVc2VyT3JnUGF0aC5zbGljZSgwLCAtNCAqIGluZGV4KSAmJiAhb3JnLmRpc2FibGVkKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLm9yaWdpbmFsVHJlZURhdGEgPSB0aGlzLm9yaWdpbmFsVHJlZURhdGEuY29uY2F0KHRhcmdldE9yZ0RhdGEgfHwgW10pO1xyXG4gICAgICAgICAgICAgICAgICAgIGluZGV4ICs9IDE7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0aGlzLm9yaWdpbmFsVHJlZURhdGEucHVzaChyZXMub3Jncy5maW5kKG9yZyA9PiBvcmdbJ2xheWVyJ10gPT0gJzEnKSk7XHJcbiAgICAgICAgICAgICAgICBpZih0aGlzLm9ubHlEaXNwbGF5Q29tcGFueSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMub3JpZ2luYWxUcmVlRGF0YSA9IHRoaXMub3JpZ2luYWxUcmVlRGF0YS5maWx0ZXIoZGF0YSA9PiBkYXRhLnZhbHVlVHlwZSA9PSB0aGlzLm9yZ1R5cGVJZCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5vcmlnaW5hbFRyZWVEYXRhLmZvckVhY2goaXRlbSA9PiB7XHJcbiAgICAgICAgICAgICAgICBpdGVtLnNlbGVjdGFibGUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgaWYodGhpcy5lbmFibGVGYXZvcml0ZXMpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoQ29tbW9uVXRpbC5maW5kSW5kZXgoaXRlbVsnaWQnXSwgJ2lkJywgdGhpcy5mYXZvcml0ZXNMaXN0KSA9PT0gLTEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaXRlbS5pbkZhdm9yaXRlcyA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW0uaW5GYXZvcml0ZXMgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0gXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBpZihyZXMuY3VycmVudE9yZy5vcmdJZCA9PSAnbnVsbG9yZycpIHtcclxuICAgICAgICAgICAgICAgIC8vIOmcgOimgeWMuuWIhuaYr+WQpuS4umFkbWlu6LSm5oi355m75b2VXHJcbiAgICAgICAgICAgICAgICB0aGlzLnRyZWVMaXN0RGF0YSA9IHRoaXMuZGF0YVRvVHJlZSh0aGlzLm9yaWdpbmFsVHJlZURhdGEsIDEsICcqJyk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnRyZWVMaXN0RGF0YSA9IHRoaXMuZGF0YVRvVHJlZSh0aGlzLm9yaWdpbmFsVHJlZURhdGEsIDEsIHRoaXMuY3VycmVudFVzZXJPcmdQYXRoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLmZhcnJpc1RyZWUubG9hZERhdGEodGhpcy50cmVlTGlzdERhdGEpO1xyXG4gICAgICAgICAgICBpZih0aGlzLm11bHRpU2VsZWN0KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNoZWNrT3JnVHJlZU5vZGVzKCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdE9yZ1RyZWVOb2RlKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5jZHIuZGV0ZWN0Q2hhbmdlcygpO1xyXG4gICAgICAgICAgICBpZih0aGlzLmxvYWRpbmdTZXJ2aWNlKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmxvYWRpbmdTZXJ2aWNlLmNsb3NlKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvLyDlhajliqDovb3nu4Tnu4fmoJFcclxuICAgIGFzc2VtYmxlRGF0YSgpIHtcclxuICAgICAgICBpZih0aGlzLmxvYWRpbmdTZXJ2aWNlKSB7XHJcbiAgICAgICAgICAgIHRoaXMubG9hZGluZ1NlcnZpY2Uuc2hvdygpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCBwYXJhbTogYW55ID0ge1xyXG4gICAgICAgICAgICB3aXRoRGlzYWJsZWRPcmc6ICghdGhpcy5ub3RHZXRTdG9wT3JnKS50b1N0cmluZygpLFxyXG4gICAgICAgICAgICBnZXRpbmdDdXJyZW50T3JnOiAnJyArIHRydWUsXHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLmFwaVNlcnZpY2UuZ2V0T3JnYW5pemF0aW9ucyhwYXJhbSkuc3Vic2NyaWJlKChyZXM6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICBpZiAoIXJlcyB8fCAhcmVzLm9yZ3MpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAodGhpcy5lbmFibGVGYXZvcml0ZXMpIHtcclxuICAgICAgICAgICAgICAgIHJlcy5vcmdzLmZvckVhY2goaXRlbSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKENvbW1vblV0aWwuZmluZEluZGV4KGl0ZW1bJ2lkJ10sICdpZCcsIHRoaXMuZmF2b3JpdGVzTGlzdCkgPT09IC0xKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW0uaW5GYXZvcml0ZXMgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpdGVtLmluRmF2b3JpdGVzID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLm9yaWdpbmFsVHJlZURhdGEgPSByZXMub3JncztcclxuICAgICAgICAgICAgdGhpcy50cmVlTGlzdERhdGEgPSB0aGlzLmRhdGFUb1RyZWUocmVzLm9yZ3MsIDEsIHJlcy5jdXJyZW50T3JnLm9yZ1BhdGgpO1xyXG4gICAgICAgICAgICB0aGlzLmZhcnJpc1RyZWUubG9hZERhdGEodGhpcy50cmVlTGlzdERhdGEpO1xyXG4gICAgICAgICAgICBpZih0aGlzLm11bHRpU2VsZWN0KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNoZWNrT3JnVHJlZU5vZGVzKCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdE9yZ1RyZWVOb2RlKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5jZHIuZGV0ZWN0Q2hhbmdlcygpO1xyXG4gICAgICAgICAgICBpZih0aGlzLmxvYWRpbmdTZXJ2aWNlKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmxvYWRpbmdTZXJ2aWNlLmNsb3NlKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvLyDnoa7lrprlt7LpgInnu4Tnu4fmmK/lkKblnKjlvZPliY3nu4Tnu4fmoJHlhoVcclxuICAgIHByaXZhdGUgaW5UcmVlTGlzdCh0cmVlTGlzdERhdGE6IFRyZWVOb2RlW10sIGl0ZW06IGFueSkge1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdHJlZUxpc3REYXRhLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIGlmICh0cmVlTGlzdERhdGFbaV0uaWQgPT09IGl0ZW1bJ2lkJ10pIHtcclxuICAgICAgICAgICAgICAgIGl0ZW0uaW5UcmVlTGlzdCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAodHJlZUxpc3REYXRhW2ldLmNoaWxkcmVuLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5pblRyZWVMaXN0KHRyZWVMaXN0RGF0YVtpXS5jaGlsZHJlbiwgaXRlbSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy8g5Zyo5b2T5YmN57uE57uH5qCR5YaF5Yu+6YCJ5omA5pyJ5bey6YCJ5oup55qE57uE57uHXHJcbiAgICBwcml2YXRlIHRpY2tTZWxlY3Rpb25zKCkge1xyXG4gICAgICAgIC8vIGNvbnN0IGlkcyA9IFtdO1xyXG4gICAgICAgIC8vIHRoaXMuc2VsZWN0ZWREYXRhTm90SW5UcmVlTGlzdCA9IFtdO1xyXG4gICAgICAgIC8vIHRoaXMuc2VsZWN0aW9ucy5mb3JFYWNoKGl0ZW0gPT4ge1xyXG4gICAgICAgIC8vICAgICB0aGlzLmluVHJlZUxpc3QodGhpcy50cmVlTGlzdERhdGEsIGl0ZW0pO1xyXG4gICAgICAgIC8vICAgICBpZiAoISFpdGVtLmluVHJlZUxpc3QpIHtcclxuICAgICAgICAvLyAgICAgICAgIGlkcy5wdXNoKGl0ZW1bdGhpcy5wcmltYXJ5RmllbGRdKTtcclxuICAgICAgICAvLyAgICAgfSBlbHNlIHtcclxuICAgICAgICAvLyAgICAgICAgIGlmKCF0aGlzLm11bHRpU2VsZWN0KSB7XHJcbiAgICAgICAgLy8gICAgICAgICAgICAgdGhpcy5zaW5nbGVTZWxlY3RlZERhdGEgPSBudWxsO1xyXG4gICAgICAgIC8vICAgICAgICAgfVxyXG4gICAgICAgIC8vICAgICAgICAgdGhpcy5zZWxlY3RlZERhdGFOb3RJblRyZWVMaXN0LnB1c2goaXRlbSk7XHJcbiAgICAgICAgLy8gICAgIH1cclxuICAgICAgICAvLyB9KTtcclxuICAgICAgICAvLyB0aGlzLm5nWm9uZS5ydW5PdXRzaWRlQW5ndWxhcigoKSA9PiB7XHJcbiAgICAgICAgLy8gICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgIC8vICAgICAgICAgaWYgKCFpZHMubGVuZ3RoKSB7XHJcbiAgICAgICAgLy8gICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIC8vICAgICAgICAgfVxyXG4gICAgICAgIC8vICAgICAgICAgaWYgKHRoaXMubXVsdGlTZWxlY3QpIHtcclxuICAgICAgICAvLyAgICAgICAgICAgICB0aGlzLmZhcnJpc1RyZWUuY2hlY2tlZE5vZGVzKGlkcywgdHJ1ZSwgdHJ1ZSk7XHJcbiAgICAgICAgLy8gICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgIC8vICAgICAgICAgICAgIHRoaXMuZmFycmlzVHJlZS5jbGVhclNlbGVjdGlvbnMoKTtcclxuICAgICAgICAvLyAgICAgICAgICAgICAvL1xyXG4gICAgICAgIC8vICAgICAgICAgICAgIHRoaXMuZmFycmlzVHJlZS5kZXRlY3RDaGFuZ2VzKCk7XHJcbiAgICAgICAgLy8gICAgICAgICAgICAgdGhpcy5zZWxlY3RPcmdUcmVlTm9kZSgpO1xyXG4gICAgICAgIC8vICAgICAgICAgfVxyXG4gICAgICAgIC8vICAgICB9KVxyXG4gICAgICAgIC8vIH0pXHJcbiAgICB9ICAgIFxyXG5cclxuICAgIC8qKlxyXG4gICAgKiDnu4Tnu4fmlbDmja7ovazmjaJcclxuICAgICogQHBhcmFtIHBsYWluU291cmNlIOaOpeWPo+WOn+Wni+aVsOaNrlxyXG4gICAgKiBAcGFyYW0gbGF5ZXIg5bGC57qnXHJcbiAgICAqIEByZXR1cm5zIOi/lOWbnuagkeW9ouaOpeWPo+eahOaVsOaNrlxyXG4gICAgKi9cclxuICAgIHByaXZhdGUgZGF0YVRvVHJlZShwbGFpblNvdXJjZTogYW55LCBsYXllcjogbnVtYmVyLCBleHBhbmRlZFBhdGg6IHN0cmluZyA9ICcnKSB7XHJcbiAgICAgICAgY29uc3QgdHJlZVNvdXJjZSA9IHRoaXMuZGVhbERhdGEocGxhaW5Tb3VyY2UsIGV4cGFuZGVkUGF0aCA/IGV4cGFuZGVkUGF0aCA6ICcnKTtcclxuICAgICAgICAvLyBjb25zdCBwYXJlbnRzID0gdHJlZVNvdXJjZS5maWx0ZXIoaXRlbSA9PiB7XHJcbiAgICAgICAgLy8gICAgIHJldHVybiBpdGVtLmRhdGEubGF5ZXIgPT09IGxheWVyO1xyXG4gICAgICAgIC8vIH0pO1xyXG4gICAgICAgIC8vIHRoaXMudHJlZURhdGEocGFyZW50cywgdHJlZVNvdXJjZSwgMSk7XHJcbiAgICAgICAgcmV0dXJuIHRyZWVTb3VyY2U7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBkZWFsRGF0YVdoZW5FeHBhbmRUcmVlTm9kZShkYXRhOiBhbnlbXSkge1xyXG4gICAgICAgIGlmKCFkYXRhIHx8ICFkYXRhLmxlbmd0aCkge1xyXG4gICAgICAgICAgICByZXR1cm4gW11cclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgbmV3RGF0YXMgPSBbXTtcclxuICAgICAgICBkYXRhLmZvckVhY2goaXRlbSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IG5ld3NEYXRhT2JqOiBhbnkgPSB7XHJcbiAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWQ6IGl0ZW0uaWQsXHJcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogaXRlbS5uYW1lLFxyXG4gICAgICAgICAgICAgICAgICAgIHBhdGg6IGl0ZW0ucGF0aCxcclxuICAgICAgICAgICAgICAgICAgICBjb2RlOiBpdGVtLmNvZGUsXHJcbiAgICAgICAgICAgICAgICAgICAgYWJicmV2aWF0aW9uOiBpdGVtLmFiYnJldmlhdGlvbixcclxuICAgICAgICAgICAgICAgICAgICBsYXllcjogTnVtYmVyKGl0ZW0ubGF5ZXIpLFxyXG4gICAgICAgICAgICAgICAgICAgIGluRmF2b3JpdGVzOiBpdGVtLmluRmF2b3JpdGVzXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgZXhwYW5kZWQ6IGZhbHNlLFxyXG4gICAgICAgICAgICAgICAgY2hpbGRyZW46IFtdXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIGlmKCFpdGVtLmlzRGV0YWlsKSB7XHJcbiAgICAgICAgICAgICAgICBuZXdzRGF0YU9iai5sZWFmID0gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgbmV3RGF0YXMucHVzaChuZXdzRGF0YU9iaik7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIG5ld0RhdGFzO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog6aKE5aSE55CG57uE57uH5pWw5o2uXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgZGVhbERhdGEoZGF0YTogYW55W10sIGV4cGFuZGVkUGF0aDogc3RyaW5nID0gJycpIHtcclxuICAgICAgICBjb25zdCBwYXRoTGlzdCA9IFtdO1xyXG4gICAgICAgIGlmKGV4cGFuZGVkUGF0aCAhPSAnJykge1xyXG4gICAgICAgICAgICBsZXQgbWF4TGVuZ3RoID0gZXhwYW5kZWRQYXRoLmxlbmd0aCAvIHRoaXMucGF0aExlbmd0aDtcclxuICAgICAgICAgICAgaWYgKHRoaXMuZW5hYmxlSGllcmFyY2hpY2FsTG9hZGluZykge1xyXG4gICAgICAgICAgICAgICAgbWF4TGVuZ3RoIC09IDE7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZm9yIChsZXQgYSA9IDA7IGEgPCBtYXhMZW5ndGg7IGErKykge1xyXG4gICAgICAgICAgICAgICAgcGF0aExpc3QucHVzaCh7IHBhdGg6IGV4cGFuZGVkUGF0aC5zdWJzdHJpbmcoMCwgNCAqIChhICsgMSkpIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIFtdO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCBub2RlcyA9IG5ldyBNYXA8c3RyaW5nLCBhbnk+KCk7XHJcbiAgICAgICAgY29uc3QgbmV3RGF0YXMgPSBbXTtcclxuICAgICAgICBpZiAoZGF0YS5sZW5ndGgpIHtcclxuICAgICAgICAgICAgZGF0YS5mb3JFYWNoKGl0ZW0gPT4ge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgcGF0aDogc3RyaW5nID0gaXRlbVsncGF0aCddO1xyXG4gICAgICAgICAgICAgICAgbGV0IHBhcmVudFBhdGg7XHJcbiAgICAgICAgICAgICAgICBpZih0aGlzLm9ubHlDdXJyZW50QWRtaW5PcmcpIHtcclxuICAgICAgICAgICAgICAgICAgICBwYXJlbnRQYXRoID0gcGF0aCA9PSB0aGlzLmN1cnJlbnRBZG1pbk9yZ1BhdGggPyAndG9wJyA6IGl0ZW0ucGF0aC5zbGljZSgwLCAtNCk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHBhcmVudFBhdGggPSBpdGVtWydsYXllciddID09ICcxJyA/ICd0b3AnIDogaXRlbS5wYXRoLnNsaWNlKDAsIC00KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmKCFub2Rlc1twYXRoXSkge1xyXG4gICAgICAgICAgICAgICAgICAgIG5vZGVzW3BhdGhdID0geyBjaGlsZHJlbjogW10gfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgbm9kZXNbcGF0aF0gPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YSA6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IGl0ZW0uaWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IGl0ZW0ubmFtZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGF0aDogaXRlbS5wYXRoLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb2RlOiBpdGVtLmNvZGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFiYnJldmlhdGlvbjogaXRlbS5hYmJyZXZpYXRpb24sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxheWVyOiBOdW1iZXIoaXRlbS5sYXllciksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGluRmF2b3JpdGVzOiBpdGVtLmluRmF2b3JpdGVzXHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICBleHBhbmRlZDogZmFsc2UsXHJcbiAgICAgICAgICAgICAgICAgICAgY2hpbGRyZW46IG5vZGVzW3BhdGhdWydjaGlsZHJlbiddXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoQ29tbW9uVXRpbC5maW5kSW5kZXgoaXRlbS5wYXRoLCAncGF0aCcsIHBhdGhMaXN0KSAhPT0gLTEgfHwgTnVtYmVyKGl0ZW0ubGF5ZXIpIDwgdGhpcy5sYXllcikge1xyXG4gICAgICAgICAgICAgICAgICAgIG5vZGVzW3BhdGhdWydleHBhbmRlZCddID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbm9kZXNbcGF0aF1bJ2V4cGFuZGVkJ10gPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5lbmFibGVIaWVyYXJjaGljYWxMb2FkaW5nICYmICFpdGVtLmlzRGV0YWlsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVzW3BhdGhdWydsZWFmJ10gPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZih0aGlzLmRhdGFQZXJtaXNzaW9uICYmIHRoaXMuZGF0YVBlcm1pc3Npb25JZHMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdGFyZ2V0ID0gdGhpcy5kYXRhUGVybWlzc2lvbklkcy5maW5kKHQgPT4gdCA9PSBpdGVtWydvcmdJZCddKTtcclxuICAgICAgICAgICAgICAgICAgICBub2Rlc1twYXRoXVsnc2VsZWN0YWJsZSddID0gdGFyZ2V0ID8gdHJ1ZSA6IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYocGFyZW50UGF0aCA9PSAndG9wJykge1xyXG4gICAgICAgICAgICAgICAgICAgIG5ld0RhdGFzLnB1c2gobm9kZXNbcGF0aF0pO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBpZighbm9kZXNbcGFyZW50UGF0aF0pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbm9kZXNbcGFyZW50UGF0aF0gPSB7IGNoaWxkcmVuOiBbXSB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIChub2Rlc1twYXJlbnRQYXRoXVsnY2hpbGRyZW4nXSBhcyBBcnJheTxhbnk+KS5wdXNoKG5vZGVzW3BhdGhdKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBuZXdEYXRhcztcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOaVsOaNrui9rOaNolxyXG4gICAgICogQHBhcmFtIHBhcmVudHMg54i257qn6IqC54K55L+h5oGvXHJcbiAgICAgKiBAcGFyYW0gdHJlZVNvdXJjZSDljp/lp4vmlbDmja7kv6Hmga9cclxuICAgICAqIEBwYXJhbSBsYXllciDlsYLnuqdcclxuICAgICAqL1xyXG4gICAgdHJlZURhdGEocGFyZW50czogYW55LCB0cmVlU291cmNlOiBhbnksIGxheWVyOiBudW1iZXIpIHtcclxuICAgICAgICBwYXJlbnRzLmZvckVhY2gocGFyZW50ID0+IHtcclxuICAgICAgICAgICAgY29uc3QgcGFyZW50UGF0aCA9IHBhcmVudFsnZGF0YSddWydwYXRoJ107XHJcbiAgICAgICAgICAgIGNvbnN0IHBhcmVudExheWVyID0gcGFyZW50WydkYXRhJ11bJ2xheWVyJ107XHJcbiAgICAgICAgICAgIHRyZWVTb3VyY2UuZm9yRWFjaChpdGVtID0+IHtcclxuICAgICAgICAgICAgICAgIGlmIChpdGVtICYmIGl0ZW1bJ2RhdGEnXSAmJiBpdGVtWydkYXRhJ11bJ3BhdGgnXSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGl0ZW1QYXRoID0gaXRlbVsnZGF0YSddWydwYXRoJ107XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgaXRlbUxheWVyID0gaXRlbVsnZGF0YSddWydsYXllciddO1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCB0YXJnZXRQYXRoOiBzdHJpbmc7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGl0ZW1QYXRoICYmIGl0ZW1QYXRoLmxlbmd0aCA+IHBhcmVudFBhdGgubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldFBhdGggPSBpdGVtUGF0aC5zdWJzdHIoMCwgTnVtYmVyKGxheWVyKSAqIDQpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAocGFyZW50UGF0aCA9PT0gdGFyZ2V0UGF0aCAmJiBwYXJlbnRMYXllciA9PT0gaXRlbUxheWVyIC0gMSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBwYXJlbnRbJ2NoaWxkcmVuJ10ucHVzaChpdGVtKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHBhcmVudFBhdGggPT09IHRhcmdldFBhdGgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy50cmVlRGF0YShbaXRlbV0sIHRyZWVTb3VyY2UsIE51bWJlcihsYXllcikgKyAxKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pXHJcbiAgICB9XHJcblxyXG4gICAgLy8g5pS26JeP5oiW5Y+W5raI5pS26JeP5b2T5YmN6IqC54K55a+55bqU55qE57uE57uHXHJcbiAgICB0b2dnbGVGYXZvcml0ZXMoZTogYW55LCBpdGVtOiBhbnkpIHtcclxuICAgICAgICB0aGlzLmZhdm9yaXRlc1Rvb2wudG9nZ2xlRmF2b3JpdGVzKGUsIGl0ZW0pO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIOebkeWQrOe7hOe7h+agkeWxleW8gOS6i+S7tlxyXG4gICAgbGlzdGVuVHJlZUV4cGFuZChvYmo6IGFueSkge1xyXG4gICAgICAgIC8vIHRvZG8g5YiG5bGC5Yqg6L29XHJcbiAgICAgICAgaWYgKHRoaXMuZW5hYmxlSGllcmFyY2hpY2FsTG9hZGluZyAmJiBvYmouY2hpbGRyZW4ubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZ2V0T3JnYW5pemF0aW9uQnlQYXJlbnROb2RlKG9iaik7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8vIOWIhuWxguWKoOi9veaXtu+8jOiOt+WPluS4i+e6p+e7hOe7h+aVsOaNruW5tuS4uuW9k+WJjee7hOe7h+agkea3u+WKoOWtkOiKgueCuVxyXG4gICAgZ2V0T3JnYW5pemF0aW9uQnlQYXJlbnROb2RlKHBhcmVudE5vZGU6IGFueSkge1xyXG4gICAgICAgIGlmKHRoaXMubG9hZGluZ1NlcnZpY2UpIHtcclxuICAgICAgICAgICAgdGhpcy5sb2FkaW5nU2VydmljZS5zaG93KCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IHBhcmFtOiBhbnkgPSB7XHJcbiAgICAgICAgICAgIHdpdGhEaXNhYmxlZE9yZzogIXRoaXMubm90R2V0U3RvcE9yZyxcclxuICAgICAgICAgICAgcGFyZW50T3JnSWQ6IHBhcmVudE5vZGUuaWQsXHJcbiAgICAgICAgICAgIGdldHRpbmdDdXJyZW50T3JnOiBmYWxzZSxcclxuICAgICAgICAgICAgb25seURpc3BsYXlPcmc6IHRoaXMub25seURpc3BsYXlDb21wYW55XHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLmFwaVNlcnZpY2UuZ2V0T3JnYW5pemF0aW9uc1dpdGhMYXllcihwYXJhbSkuc3Vic2NyaWJlKChyZXM6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICBpZiAocmVzICYmIHJlcy5vcmdzKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBuZXdEYXRhcyA9IFtdO1xyXG4gICAgICAgICAgICAgICAgcmVzLm9yZ3MuZm9yRWFjaChpdGVtID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBpZigoIXRoaXMub25seUN1cnJlbnRBZG1pbk9yZyB8fCBpdGVtWyd2YWx1ZVR5cGUnXSA9PSB0aGlzLmRlcHRUeXBlSWQpICYmICFpdGVtLmRpc2FibGVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW0uc2VsZWN0YWJsZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKHRoaXMuZGF0YVBlcm1pc3Npb24gJiYgdGhpcy5kYXRhUGVybWlzc2lvbklkcy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHRhcmdldCA9IHRoaXMuZGF0YVBlcm1pc3Npb25JZHMuZmluZCh0ID0+IHQgPT0gaXRlbVsnaWQnXSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZighdGFyZ2V0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlbS5zZWxlY3RhYmxlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vcmlnaW5hbFRyZWVEYXRhLnB1c2goaXRlbSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmVuYWJsZUZhdm9yaXRlcykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpdGVtLmluRmF2b3JpdGVzID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKENvbW1vblV0aWwuZmluZEluZGV4KGl0ZW1bJ2lkJ10sICdpZCcsIHRoaXMuZmF2b3JpdGVzTGlzdCkgPT09IC0xKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGVtLmluRmF2b3JpdGVzID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgbmV3RGF0YXMucHVzaChpdGVtKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgY29uc3Qgbm9kZXMgPSB0aGlzLmRlYWxEYXRhV2hlbkV4cGFuZFRyZWVOb2RlKG5ld0RhdGFzKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuZmFycmlzVHJlZS5hcHBlbmRDaGlsZHJlbihub2RlcywgcGFyZW50Tm9kZSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmZhcnJpc1RyZWUuZGV0ZWN0Q2hhbmdlcygpO1xyXG4gICAgICAgICAgICAgICAgaWYodGhpcy5tdWx0aVNlbGVjdCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY2hlY2tPcmdUcmVlTm9kZXMoKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RPcmdUcmVlTm9kZSgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYodGhpcy5sb2FkaW5nU2VydmljZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMubG9hZGluZ1NlcnZpY2UuY2xvc2UoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIOi/lOWbnuW3sue7j+ivpeiKgueCueaYr+WQpuWxleW8gOi/h1xyXG4gICAgcHJpdmF0ZSBub2RlRXhwYW5kZWQoaXRlbTogYW55LCBhcnI6IFRyZWVOb2RlW10sIGV4cGFuZGVkOiBib29sZWFuW10pOiB2b2lkIHtcclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGFyci5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICBpZiAoaXRlbS5kYXRhLmlkID09PSBhcnJbaV0uZGF0YS5pZCkge1xyXG4gICAgICAgICAgICAgICAgZXhwYW5kZWRbMF0gPSBhcnJbaV0uZXhwYW5kZWQ7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoYXJyW2ldLmNoaWxkcmVuLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5ub2RlRXhwYW5kZWQoaXRlbSwgYXJyW2ldLmNoaWxkcmVuLCBleHBhbmRlZCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy8g5bGV5byA6IqC54K5XHJcbiAgICBwcml2YXRlIGV4cGFuZFRyZWVOb2RlKHRyZWVEYXRhOiBhbnksIHBhdGg6IGFueVtdLCBsYXllcjogbnVtYmVyKSB7XHJcbiAgICAgICAgdHJlZURhdGEuZm9yRWFjaChub2RlID0+IHtcclxuICAgICAgICAgICAgaWYgKHBhdGguaW5jbHVkZXMobm9kZS5kYXRhLnBhdGgpKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmZhcnJpc1RyZWUuZXhwYW5kTm9kZShub2RlLmRhdGEuaWQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChub2RlLmRhdGEubGF5ZXIgPCBsYXllciAmJiBub2RlLmNoaWxkcmVuLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5leHBhbmRUcmVlTm9kZShub2RlLmNoaWxkcmVuLCBwYXRoLCBsYXllcik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcblxyXG4gICAgc2VsZWN0T3JnVHJlZU5vZGUoKSB7XHJcbiAgICAgICAgaWYodGhpcy50cmVlTGlzdERhdGEgJiYgdGhpcy5zZWxlY3Rpb25zLmxlbmd0aCkge1xyXG4gICAgICAgICAgICB0aGlzLmRhdGFUb1NlbGVjdGVkID0gdGhpcy5zZWxlY3Rpb25zWzBdO1xyXG4gICAgICAgICAgICAvLyBpZiAoIXRoaXMuZmFycmlzVHJlZS5zZWxlY3RlZFJvdykge1xyXG4gICAgICAgICAgICAvLyAgICAgaWYgKHRoaXMub3JnVHJlZVRpbWVyKSB7XHJcbiAgICAgICAgICAgIC8vICAgICAgICAgY2xlYXJUaW1lb3V0KHRoaXMub3JnVHJlZVRpbWVyKTtcclxuICAgICAgICAgICAgLy8gICAgIH1cclxuICAgICAgICAgICAgLy8gICAgIHRoaXMub3JnVHJlZVRpbWVyID0gXHJcbiAgICAgICAgICAgIC8vIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIC8vICAgICB0aGlzLmZhcnJpc1RyZWUuc2Nyb2xsVG9DdXJyZW50Tm9kZSgpO1xyXG4gICAgICAgICAgICAvLyB9XHJcbiAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5pblRyZWVMaXN0KHRoaXMudHJlZUxpc3REYXRhLCB0aGlzLmRhdGFUb1NlbGVjdGVkKTtcclxuICAgICAgICAgICAgICAgIGlmKHRoaXMuZGF0YVRvU2VsZWN0ZWQuaW5UcmVlTGlzdCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZmFycmlzVHJlZS5zZWxlY3ROb2RlKHRoaXMuZGF0YVRvU2VsZWN0ZWRbJ2lkJ10pO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZGF0YVRvU2VsZWN0ZWQgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LCAzMDApO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICBcclxuICAgIGNoZWNrT3JnVHJlZU5vZGVzKCkge1xyXG4gICAgICAgIGlmKHRoaXMudHJlZUxpc3REYXRhICYmIHRoaXMuc2VsZWN0aW9ucy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgdGhpcy5kYXRhVG9DaGVja2VkID0gdGhpcy5zZWxlY3Rpb25zO1xyXG4gICAgICAgICAgICBjb25zdCBjaGVja2VkTm9kZXMgPSBbXTtcclxuICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmRhdGFUb0NoZWNrZWQuZm9yRWFjaChpdGVtID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmluVHJlZUxpc3QodGhpcy50cmVlTGlzdERhdGEsIGl0ZW0pO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmKGl0ZW0uaW5UcmVlTGlzdCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjaGVja2VkTm9kZXMucHVzaChpdGVtWydpZCddKTtcclxuICAgICAgICAgICAgICAgICAgICB9IFxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmRhdGFUb0NoZWNrZWQgPSB0aGlzLmRhdGFUb0NoZWNrZWQuZmlsdGVyKGl0ZW0gPT4gIWNoZWNrZWROb2Rlcy5pbmNsdWRlcyhpdGVtWydpZCddKSk7XHJcbiAgICAgICAgICAgICAgICBpZihjaGVja2VkTm9kZXMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5mYXJyaXNUcmVlLmNoZWNrZWROb2RlcyhjaGVja2VkTm9kZXMsIHRydWUsIHRydWUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LCAzMDApO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG4iXX0=