/**
 * @fileoverview added by tsickle
 * Generated from: lib/tab-organization/to.component.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, Input, EventEmitter, Output, ChangeDetectorRef, Injector, ViewChild, TemplateRef, HostBinding, NgZone } from '@angular/core';
import { ApiService } from '../../utils/api.service';
import * as _ from 'lodash-es';
import { of } from 'rxjs';
import { FavoritesTool } from '../../utils/favorites.tool';
import { ChangeType } from '../../utils/index.type';
import { CommonUtil } from '../../utils/common.tool';
import { TreeTableComponent } from '@farris/ui-treetable';
import { StateMgrTool } from '../../utils/state.mgr.tool';
import { switchMap } from 'rxjs/operators';
import { MessagerService } from '@farris/ui-messager';
import { LoadingService } from '@farris/ui-loading';
import { LocaleService } from '@farris/ui-locale';
import { ORGANIZATION_SELECTOR_LOCALE } from '../../utils/locale';
export class OrganizationComponent {
    /**
     * @param {?} apiService
     * @param {?} cdr
     * @param {?} favoritesTool
     * @param {?} injector
     * @param {?} ngZone
     * @param {?} stateMgr
     * @param {?} msgService
     */
    constructor(apiService, cdr, favoritesTool, injector, ngZone, stateMgr, msgService) {
        this.apiService = apiService;
        this.cdr = cdr;
        this.favoritesTool = favoritesTool;
        this.injector = injector;
        this.ngZone = ngZone;
        this.stateMgr = stateMgr;
        this.msgService = msgService;
        this.baseCls = true;
        this.primaryField = 'orgId';
        this.pathLength = 4;
        this.dataPermission = false;
        this.dataPermissionIds = [];
        this.selectionsChange = new EventEmitter();
        this.originalTreeData = [];
        this.locationOrgText = '';
        this.treeListData = [];
        this.treeTableCols = [];
        this.selections = [];
        this.favoritesList = [];
        this.initLoad = true;
        this.checkedOrgs = [];
        this.loadingService = null;
        this.localeService = null;
        this.dataToChecked = [];
        this.allAdminOrgData = [];
        this.orgTypeId = '9edf25d1-b991-4dde-90b9-30145422d24d';
        this.deptTypeId = '33c21504-3384-42a7-8fc3-c1b5e9e982d0';
        this.beforeClickNode = (/**
         * @param {?} e
         * @return {?}
         */
        (e) => {
            if (!this.enableHierarchicalLoading) {
                return of(true);
            }
            if (!this.multiSelect) {
                if (e.rowNode.isSelected) {
                    this.setSelections([]);
                }
                else {
                    this.setSelections(new Array(e.rowNode.node.data));
                }
                return of(false);
            }
            // const param: OrgRequestParam = {
            //     absOrgType: this.absOrgType,
            //     notGetStopOrg: this.notGetStopOrg,
            //     getCurUser: false,
            //     parentID: e.rowNode.id,
            //     withAllSub: true,
            //     getOrgAllPath: true
            // };
            // return this.apiService.getOrganization(param).pipe(
            //     switchMap(
            //         (data: any) => {
            //             // if (data['data'].length > this.selectedLimit && !e.rowNode.isChecked) {
            //             //     this.msgService.show('warning', `亲，一次性选择了超过${this.selectedLimit}条数据~`, true);
            //             //     return of(false)
            //             // }
            //             // if (!e.rowNode.isChecked) {
            //             //     // todo 待验证，加入selection，
            //             //     data.data.forEach(item => {
            //             //         if (CommonUtil.findIndex(item[this.primaryField], this.primaryField, this.selections) === -1) {
            //             //             this.setSelections(item, ChangeType.Append, 'other');
            //             //         }
            //             //     })
            //             // } else {
            //             //     this.selections.forEach((selection, index) => {
            //             //         data.data.forEach(item => {
            //             //             if (selection[this.primaryField] === item[this.primaryField]) {
            //             //                 this.setSelections(item, ChangeType.Remove, 'other');
            //             //             }
            //             //         });
            //             //     });
            //             // }
            //             // this.cdr.detectChanges();
            //             return of(true);
            //         }
            //     )
            // );
        });
        this.beforeCheckAll = (/**
         * @param {?} e
         * @return {?}
         */
        (e) => {
            if (!this.enableHierarchicalLoading) {
                return of(true);
            }
            /** @type {?} */
            const param = {
                absOrgType: this.absOrgType,
                notGetStopOrg: this.notGetStopOrg,
                getCurUser: false,
                parentID: e.instance.data[0].id,
                withAllSub: true,
                getOrgAllPath: true
            };
            return this.apiService.getOrganization(param).pipe(switchMap((/**
             * @param {?} data
             * @return {?}
             */
            (data) => {
                // if (data['data'].length > this.selectedLimit) {
                //     this.msgService.show('warning', `亲，一次性选择了超过${this.selectedLimit}条数据~`, true);
                //     return of(false)
                // }
                this.setSelections(data['data'], ChangeType.ValueChanged, 'other');
                return of(true);
            })));
        });
        this.cdr = this.injector.get(ChangeDetectorRef);
        this.loadingService = this.injector.get(LoadingService, null);
        this.localeService = this.injector.get(LocaleService);
        if (!this.localeService.langData['organizationSelector']) {
            this.localeService.setLocaleData(ORGANIZATION_SELECTOR_LOCALE);
        }
    }
    /**
     * @return {?}
     */
    ngOnDestroy() {
        this.favoritesSub.unsubscribe();
        this.selectionsSub.unsubscribe();
    }
    /**
     * @return {?}
     */
    ngOnInit() {
        this.treeTableCols = [
            { field: 'name', title: this.localeService.getValue("organizationSelector.organization.orgName"), template: this.orgNameCell },
            { field: 'abbreviation', title: this.localeService.getValue("organizationSelector.organization.orgAbbreviation") }
        ];
        if (this.enableFavorites) {
            this.treeTableCols.push({
                field: '',
                title: this.localeService.getValue("organizationSelector.organization.favorite"),
                template: this.favoritesCell
            });
            this.treeTableCols[0].width = 300;
            this.treeTableCols[1].width = 300;
        }
        /** @type {?} */
        const param = {
            withDisabledOrg: !this.notGetStopOrg,
            gettingCurrentOrg: false,
            onlyDisplayOrg: false
        };
        this.apiService.getOrganizations(param).subscribe((/**
         * @param {?} res
         * @return {?}
         */
        (res) => {
            if (res && res.orgs) {
                this.allAdminOrgData = res.orgs;
                if (this.initLoad && this.isActiveTab) {
                    if (this.enableHierarchicalLoading) {
                        this.hlAssembleData();
                    }
                    else {
                        this.assembleData();
                    }
                    this.initLoad = false;
                }
            }
        }));
        this.favoritesSub = this.favoritesTool.favoritesSubject.subscribe((/**
         * @param {?} data
         * @return {?}
         */
        data => {
            this.favoritesList = data;
            this.setFavorites(this.treeListData);
            this.farrisTree.detectChanges();
        }));
        this.currentTabId = this.activeTabId;
        this.selectionsSub = this.stateMgr.selectionsSubject.subscribe((/**
         * @param {?} data
         * @return {?}
         */
        data => {
            if (data.changeType === ChangeType.ValueChanged) {
                this.selections = _.cloneDeep(data.value);
                if (this.selections.length === 0) {
                    this.dataToSelected = null;
                    this.dataToChecked = [];
                    this.farrisTree.clearCheckeds();
                    this.farrisTree.clearSelections();
                    this.farrisTree.detectChanges();
                }
            }
            else if (data.changeType === ChangeType.Remove) {
                this.selections = this.selections.filter((/**
                 * @param {?} item
                 * @return {?}
                 */
                item => item['id'] !== data.value['id']));
                if (data.from == 'selection' && this.currentTabId == 'organization') {
                    this.inTreeList(this.treeListData, data.value);
                    if (data.value.inTreeList) {
                        if (this.multiSelect) {
                            this.farrisTree.unCheckedNode(data.value['id']);
                        }
                        else {
                            this.farrisTree.clearAll();
                        }
                    }
                }
            }
            else if (data.changeType === ChangeType.Append) {
                CommonUtil.findIndex(data.value['id'], 'id', this.selections) === -1 ? this.selections.push(data.value) : null;
            }
        }));
    }
    /**
     * @return {?}
     */
    ngAfterViewInit() {
    }
    /**
     * @param {?} changes
     * @return {?}
     */
    ngOnChanges(changes) {
        /*
        const orgIdsChange = changes.orgIds;
        if (orgIdsChange && orgIdsChange.currentValue) {
            this.checkedOrgs = orgIdsChange.currentValue;
        }
        */
    }
    // 初始tab页不为组织架构，切换至组织架构时获取组织数据
    /**
     * @return {?}
     */
    loadTreeData() {
        if (this.initLoad) {
            if (this.enableHierarchicalLoading) {
                this.hlAssembleData();
            }
            else {
                this.assembleData();
            }
            this.initLoad = false;
        }
    }
    // 设置当前组织树各个节点的收藏状态
    /**
     * @private
     * @param {?} treeListData
     * @return {?}
     */
    setFavorites(treeListData) {
        for (let i = 0; i < treeListData.length; i++) {
            if (CommonUtil.findIndex(treeListData[i].id, 'id', this.favoritesList) === -1) {
                treeListData[i].data.inFavorites = false;
            }
            else {
                treeListData[i].data.inFavorites = true;
            }
            if (treeListData[i].children.length) {
                this.setFavorites(treeListData[i].children);
            }
        }
    }
    /**
     * @private
     * @param {?} selections
     * @param {?=} changeType
     * @param {?=} from
     * @return {?}
     */
    setSelections(selections, changeType = ChangeType.ValueChanged, from = 'tree') {
        this.stateMgr.emitSelections(selections, changeType, from);
    }
    // 组织树全选事件
    /**
     * @return {?}
     */
    checkAll() {
        if (!this.enableHierarchicalLoading) {
            /** @type {?} */
            const checkeds = [];
            this.farrisTree.checkeds.forEach((/**
             * @param {?} item
             * @return {?}
             */
            item => {
                checkeds.push(item.data);
            }));
            this.setSelections(checkeds);
        }
    }
    // 组织树取消全选事件
    /**
     * @return {?}
     */
    unCheckAll() {
        this.setSelections([]);
    }
    // 选中（取消选中、勾选、取消勾选）树节点时触发
    // todo 分层加载的时候咋处理数据，beforeUnCheckAll还未支持。
    /**
     * @param {?} e
     * @return {?}
     */
    changeSelections(e) {
        /*
        if (!this.enableHierarchicalLoading && !!e.originalEvent) {
            this.multiSelect ? this.toggleChecked(e) : this.toggleSelected(e);
        }
        */
        this.multiSelect ? this.toggleChecked(e) : this.toggleSelected(e);
    }
    /**
     * @param {?} e
     * @return {?}
     */
    toggleChecked(e) {
        /** @type {?} */
        let checkeds = [];
        e && e.instance && e.instance.checkeds.forEach((/**
         * @param {?} item
         * @return {?}
         */
        item => {
            checkeds.push(item.data);
        }));
        this.setSelections(checkeds.concat(this.dataToChecked));
    }
    /**
     * @param {?} e
     * @return {?}
     */
    toggleSelected(e) {
        /** @type {?} */
        let selected = [];
        e && e.instance && e.instance.selections.forEach((/**
         * @param {?} item
         * @return {?}
         */
        item => {
            selected.push(item.data);
        }));
        this.setSelections(selected);
    }
    // 根据传入的组织id确定已选择组织
    /**
     * @private
     * @param {?} ids
     * @return {?}
     */
    assembleDataByOrgIds(ids) {
        if (!ids || ids.length === 0) {
            return;
        }
        if (ids && ids.length > 0 && !this.multiSelect) {
            this.msgService.show('warning', this.localeService.getValue("organizationSelector.errorMessage.multiSelect"), true);
            return;
        }
        /** @type {?} */
        const param = {
            absOrgType: this.absOrgType,
            idList: ids,
            getCurUser: false,
            getOrgAllPath: true,
        };
        this.apiService.getOrganization(param).subscribe((/**
         * @param {?} res
         * @return {?}
         */
        (res) => {
            if (res && res.data && res.data.length > 0) {
                this.checkedOrgs = res.data;
                res.data.forEach((/**
                 * @param {?} item
                 * @return {?}
                 */
                item => {
                    if (CommonUtil.findIndex(item['id'], 'id', this.selections) === -1) {
                        this.setSelections(item, ChangeType.Append, 'other');
                    }
                }));
                this.tickSelections();
                this.cdr.detectChanges();
            }
        }));
    }
    // 分层加载组织树
    /**
     * @return {?}
     */
    hlAssembleData() {
        if (this.loadingService) {
            this.loadingService.show();
        }
        /** @type {?} */
        const param = {
            withDisabledOrg: !this.notGetStopOrg,
            gettingCurrentOrg: true,
            onlyDisplayOrg: this.onlyDisplayCompany
        };
        this.apiService.getOrganizationsWithLayer(param).subscribe((/**
         * @param {?} res
         * @return {?}
         */
        (res) => {
            if (!res || !res.orgs) {
                return;
            }
            /** @type {?} */
            const currentUserOrg = this.allAdminOrgData.find((/**
             * @param {?} data
             * @return {?}
             */
            data => data.id == res.currentOrg.orgId));
            if (this.onlyDisplayCompany) {
                /** @type {?} */
                const allPathInfoOrgList = this.allAdminOrgData.filter((/**
                 * @param {?} data
                 * @return {?}
                 */
                data => currentUserOrg.path.startsWith(data.path) && data.valueType == this.orgTypeId));
                /** @type {?} */
                let layer = 0;
                allPathInfoOrgList.forEach((/**
                 * @param {?} org
                 * @return {?}
                 */
                org => {
                    if (Number(org.layer) > layer) {
                        this.currentUserOrgId = org.id;
                        this.currentUserOrgPath = org.path;
                        layer = Number(org.layer);
                    }
                }));
            }
            else {
                this.currentUserOrgId = currentUserOrg.id;
                this.currentUserOrgPath = currentUserOrg.path;
            }
            if (this.onlyCurrentAdminOrg) {
                /** @type {?} */
                const deptPathList = [];
                for (let i = 0; i < this.currentUserOrgPath.length / 4; i++) {
                    /** @type {?} */
                    let indexData = res.orgs.find((/**
                     * @param {?} org
                     * @return {?}
                     */
                    org => {
                        if (i == 0) {
                            return org.path == this.currentUserOrgPath;
                        }
                        else {
                            return org.path == this.currentUserOrgPath.slice(0, -4 * i);
                        }
                    }));
                    if (indexData.valueType == this.orgTypeId) {
                        this.currentAdminOrgPath = indexData.path;
                        break;
                    }
                    else {
                        if (indexData.path != this.currentUserOrgPath) {
                            deptPathList.push(indexData.path);
                        }
                    }
                }
                if (this.currentAdminOrgPath == this.currentUserOrgPath) {
                    this.originalTreeData = [res.orgs.find((/**
                         * @param {?} org
                         * @return {?}
                         */
                        org => org.path == this.currentUserOrgPath))];
                }
                else {
                    deptPathList.push(this.currentAdminOrgPath);
                    for (const item of deptPathList) {
                        /** @type {?} */
                        let targetOrgData = this.allAdminOrgData.filter((/**
                         * @param {?} org
                         * @return {?}
                         */
                        org => org.path.slice(0, -4) == item && org.valueType == this.deptTypeId && !org.disabled));
                        this.originalTreeData = this.originalTreeData.concat(targetOrgData || []);
                    }
                    this.originalTreeData.push(res.orgs.find((/**
                     * @param {?} org
                     * @return {?}
                     */
                    org => org.path == this.currentAdminOrgPath)));
                }
            }
            else {
                for (let i = this.currentUserOrgPath.length / 4, index = 1; i > 1; i--) {
                    /** @type {?} */
                    let targetOrgData = this.allAdminOrgData.filter((/**
                     * @param {?} org
                     * @return {?}
                     */
                    org => Number(org['layer']) == i && org.path.slice(0, -4) == this.currentUserOrgPath.slice(0, -4 * index) && !org.disabled));
                    this.originalTreeData = this.originalTreeData.concat(targetOrgData || []);
                    index += 1;
                }
                this.originalTreeData.push(res.orgs.find((/**
                 * @param {?} org
                 * @return {?}
                 */
                org => org['layer'] == '1')));
                if (this.onlyDisplayCompany) {
                    this.originalTreeData = this.originalTreeData.filter((/**
                     * @param {?} data
                     * @return {?}
                     */
                    data => data.valueType == this.orgTypeId));
                }
            }
            this.originalTreeData.forEach((/**
             * @param {?} item
             * @return {?}
             */
            item => {
                item.selectable = true;
                if (this.enableFavorites) {
                    if (CommonUtil.findIndex(item['id'], 'id', this.favoritesList) === -1) {
                        item.inFavorites = false;
                    }
                    else {
                        item.inFavorites = true;
                    }
                }
            }));
            if (res.currentOrg.orgId == 'nullorg') {
                // 需要区分是否为admin账户登录
                this.treeListData = this.dataToTree(this.originalTreeData, 1, '*');
            }
            else {
                this.treeListData = this.dataToTree(this.originalTreeData, 1, this.currentUserOrgPath);
            }
            this.farrisTree.loadData(this.treeListData);
            if (this.multiSelect) {
                this.checkOrgTreeNodes();
            }
            else {
                this.selectOrgTreeNode();
            }
            this.cdr.detectChanges();
            if (this.loadingService) {
                this.loadingService.close();
            }
        }));
    }
    // 全加载组织树
    /**
     * @return {?}
     */
    assembleData() {
        if (this.loadingService) {
            this.loadingService.show();
        }
        /** @type {?} */
        const param = {
            withDisabledOrg: (!this.notGetStopOrg).toString(),
            getingCurrentOrg: '' + true,
        };
        this.apiService.getOrganizations(param).subscribe((/**
         * @param {?} res
         * @return {?}
         */
        (res) => {
            if (!res || !res.orgs) {
                return;
            }
            if (this.enableFavorites) {
                res.orgs.forEach((/**
                 * @param {?} item
                 * @return {?}
                 */
                item => {
                    if (CommonUtil.findIndex(item['id'], 'id', this.favoritesList) === -1) {
                        item.inFavorites = false;
                    }
                    else {
                        item.inFavorites = true;
                    }
                }));
            }
            this.originalTreeData = res.orgs;
            this.treeListData = this.dataToTree(res.orgs, 1, res.currentOrg.orgPath);
            this.farrisTree.loadData(this.treeListData);
            if (this.multiSelect) {
                this.checkOrgTreeNodes();
            }
            else {
                this.selectOrgTreeNode();
            }
            this.cdr.detectChanges();
            if (this.loadingService) {
                this.loadingService.close();
            }
        }));
    }
    // 确定已选组织是否在当前组织树内
    /**
     * @private
     * @param {?} treeListData
     * @param {?} item
     * @return {?}
     */
    inTreeList(treeListData, item) {
        for (let i = 0; i < treeListData.length; i++) {
            if (treeListData[i].id === item['id']) {
                item.inTreeList = true;
                break;
            }
            if (treeListData[i].children.length) {
                this.inTreeList(treeListData[i].children, item);
            }
        }
    }
    // 在当前组织树内勾选所有已选择的组织
    /**
     * @private
     * @return {?}
     */
    tickSelections() {
        // const ids = [];
        // this.selectedDataNotInTreeList = [];
        // this.selections.forEach(item => {
        //     this.inTreeList(this.treeListData, item);
        //     if (!!item.inTreeList) {
        //         ids.push(item[this.primaryField]);
        //     } else {
        //         if(!this.multiSelect) {
        //             this.singleSelectedData = null;
        //         }
        //         this.selectedDataNotInTreeList.push(item);
        //     }
        // });
        // this.ngZone.runOutsideAngular(() => {
        //     setTimeout(() => {
        //         if (!ids.length) {
        //             return;
        //         }
        //         if (this.multiSelect) {
        //             this.farrisTree.checkedNodes(ids, true, true);
        //         } else {
        //             this.farrisTree.clearSelections();
        //             //
        //             this.farrisTree.detectChanges();
        //             this.selectOrgTreeNode();
        //         }
        //     })
        // })
    }
    /**
     * 组织数据转换
     * @private
     * @param {?} plainSource 接口原始数据
     * @param {?} layer 层级
     * @param {?=} expandedPath
     * @return {?} 返回树形接口的数据
     */
    dataToTree(plainSource, layer, expandedPath = '') {
        /** @type {?} */
        const treeSource = this.dealData(plainSource, expandedPath ? expandedPath : '');
        // const parents = treeSource.filter(item => {
        //     return item.data.layer === layer;
        // });
        // this.treeData(parents, treeSource, 1);
        return treeSource;
    }
    /**
     * @private
     * @param {?} data
     * @return {?}
     */
    dealDataWhenExpandTreeNode(data) {
        if (!data || !data.length) {
            return [];
        }
        /** @type {?} */
        const newDatas = [];
        data.forEach((/**
         * @param {?} item
         * @return {?}
         */
        item => {
            /** @type {?} */
            const newsDataObj = {
                data: {
                    id: item.id,
                    name: item.name,
                    path: item.path,
                    code: item.code,
                    abbreviation: item.abbreviation,
                    layer: Number(item.layer),
                    inFavorites: item.inFavorites
                },
                expanded: false,
                children: []
            };
            if (!item.isDetail) {
                newsDataObj.leaf = false;
            }
            newDatas.push(newsDataObj);
        }));
        return newDatas;
    }
    /**
     * 预处理组织数据
     * @private
     * @param {?} data
     * @param {?=} expandedPath
     * @return {?}
     */
    dealData(data, expandedPath = '') {
        /** @type {?} */
        const pathList = [];
        if (expandedPath != '') {
            /** @type {?} */
            let maxLength = expandedPath.length / this.pathLength;
            if (this.enableHierarchicalLoading) {
                maxLength -= 1;
            }
            for (let a = 0; a < maxLength; a++) {
                pathList.push({ path: expandedPath.substring(0, 4 * (a + 1)) });
            }
        }
        else {
            return [];
        }
        /** @type {?} */
        const nodes = new Map();
        /** @type {?} */
        const newDatas = [];
        if (data.length) {
            data.forEach((/**
             * @param {?} item
             * @return {?}
             */
            item => {
                /** @type {?} */
                const path = item['path'];
                /** @type {?} */
                let parentPath;
                if (this.onlyCurrentAdminOrg) {
                    parentPath = path == this.currentAdminOrgPath ? 'top' : item.path.slice(0, -4);
                }
                else {
                    parentPath = item['layer'] == '1' ? 'top' : item.path.slice(0, -4);
                }
                if (!nodes[path]) {
                    nodes[path] = { children: [] };
                }
                nodes[path] = {
                    data: {
                        id: item.id,
                        name: item.name,
                        path: item.path,
                        code: item.code,
                        abbreviation: item.abbreviation,
                        layer: Number(item.layer),
                        inFavorites: item.inFavorites
                    },
                    expanded: false,
                    children: nodes[path]['children']
                };
                if (CommonUtil.findIndex(item.path, 'path', pathList) !== -1 || Number(item.layer) < this.layer) {
                    nodes[path]['expanded'] = true;
                }
                else {
                    nodes[path]['expanded'] = false;
                    if (this.enableHierarchicalLoading && !item.isDetail) {
                        nodes[path]['leaf'] = false;
                    }
                }
                if (this.dataPermission && this.dataPermissionIds.length) {
                    /** @type {?} */
                    const target = this.dataPermissionIds.find((/**
                     * @param {?} t
                     * @return {?}
                     */
                    t => t == item['orgId']));
                    nodes[path]['selectable'] = target ? true : false;
                }
                if (parentPath == 'top') {
                    newDatas.push(nodes[path]);
                }
                else {
                    if (!nodes[parentPath]) {
                        nodes[parentPath] = { children: [] };
                    }
                    ((/** @type {?} */ (nodes[parentPath]['children']))).push(nodes[path]);
                }
            }));
        }
        return newDatas;
    }
    /**
     * 数据转换
     * @param {?} parents 父级节点信息
     * @param {?} treeSource 原始数据信息
     * @param {?} layer 层级
     * @return {?}
     */
    treeData(parents, treeSource, layer) {
        parents.forEach((/**
         * @param {?} parent
         * @return {?}
         */
        parent => {
            /** @type {?} */
            const parentPath = parent['data']['path'];
            /** @type {?} */
            const parentLayer = parent['data']['layer'];
            treeSource.forEach((/**
             * @param {?} item
             * @return {?}
             */
            item => {
                if (item && item['data'] && item['data']['path']) {
                    /** @type {?} */
                    const itemPath = item['data']['path'];
                    /** @type {?} */
                    const itemLayer = item['data']['layer'];
                    /** @type {?} */
                    let targetPath;
                    if (itemPath && itemPath.length > parentPath.length) {
                        targetPath = itemPath.substr(0, Number(layer) * 4);
                    }
                    if (parentPath === targetPath && parentLayer === itemLayer - 1) {
                        parent['children'].push(item);
                    }
                    if (parentPath === targetPath) {
                        this.treeData([item], treeSource, Number(layer) + 1);
                    }
                }
            }));
        }));
    }
    // 收藏或取消收藏当前节点对应的组织
    /**
     * @param {?} e
     * @param {?} item
     * @return {?}
     */
    toggleFavorites(e, item) {
        this.favoritesTool.toggleFavorites(e, item);
    }
    // 监听组织树展开事件
    /**
     * @param {?} obj
     * @return {?}
     */
    listenTreeExpand(obj) {
        // todo 分层加载
        if (this.enableHierarchicalLoading && obj.children.length === 0) {
            this.getOrganizationByParentNode(obj);
        }
    }
    // 分层加载时，获取下级组织数据并为当前组织树添加子节点
    /**
     * @param {?} parentNode
     * @return {?}
     */
    getOrganizationByParentNode(parentNode) {
        if (this.loadingService) {
            this.loadingService.show();
        }
        /** @type {?} */
        const param = {
            withDisabledOrg: !this.notGetStopOrg,
            parentOrgId: parentNode.id,
            gettingCurrentOrg: false,
            onlyDisplayOrg: this.onlyDisplayCompany
        };
        this.apiService.getOrganizationsWithLayer(param).subscribe((/**
         * @param {?} res
         * @return {?}
         */
        (res) => {
            if (res && res.orgs) {
                /** @type {?} */
                const newDatas = [];
                res.orgs.forEach((/**
                 * @param {?} item
                 * @return {?}
                 */
                item => {
                    if ((!this.onlyCurrentAdminOrg || item['valueType'] == this.deptTypeId) && !item.disabled) {
                        item.selectable = true;
                        if (this.dataPermission && this.dataPermissionIds.length) {
                            /** @type {?} */
                            const target = this.dataPermissionIds.find((/**
                             * @param {?} t
                             * @return {?}
                             */
                            t => t == item['id']));
                            if (!target) {
                                item.selectable = false;
                            }
                        }
                        this.originalTreeData.push(item);
                    }
                    if (this.enableFavorites) {
                        item.inFavorites = true;
                        if (CommonUtil.findIndex(item['id'], 'id', this.favoritesList) === -1) {
                            item.inFavorites = false;
                        }
                    }
                    newDatas.push(item);
                }));
                /** @type {?} */
                const nodes = this.dealDataWhenExpandTreeNode(newDatas);
                this.farrisTree.appendChildren(nodes, parentNode);
                this.farrisTree.detectChanges();
                if (this.multiSelect) {
                    this.checkOrgTreeNodes();
                }
                else {
                    this.selectOrgTreeNode();
                }
                if (this.loadingService) {
                    this.loadingService.close();
                }
            }
        }));
    }
    // 返回已经该节点是否展开过
    /**
     * @private
     * @param {?} item
     * @param {?} arr
     * @param {?} expanded
     * @return {?}
     */
    nodeExpanded(item, arr, expanded) {
        for (let i = 0; i < arr.length; i++) {
            if (item.data.id === arr[i].data.id) {
                expanded[0] = arr[i].expanded;
            }
            else if (arr[i].children.length) {
                this.nodeExpanded(item, arr[i].children, expanded);
            }
        }
    }
    // 展开节点
    /**
     * @private
     * @param {?} treeData
     * @param {?} path
     * @param {?} layer
     * @return {?}
     */
    expandTreeNode(treeData, path, layer) {
        treeData.forEach((/**
         * @param {?} node
         * @return {?}
         */
        node => {
            if (path.includes(node.data.path)) {
                this.farrisTree.expandNode(node.data.id);
            }
            if (node.data.layer < layer && node.children.length) {
                this.expandTreeNode(node.children, path, layer);
            }
        }));
    }
    /**
     * @return {?}
     */
    selectOrgTreeNode() {
        if (this.treeListData && this.selections.length) {
            this.dataToSelected = this.selections[0];
            // if (!this.farrisTree.selectedRow) {
            //     if (this.orgTreeTimer) {
            //         clearTimeout(this.orgTreeTimer);
            //     }
            //     this.orgTreeTimer = 
            // } else {
            //     this.farrisTree.scrollToCurrentNode();
            // }
            setTimeout((/**
             * @return {?}
             */
            () => {
                this.inTreeList(this.treeListData, this.dataToSelected);
                if (this.dataToSelected.inTreeList) {
                    this.farrisTree.selectNode(this.dataToSelected['id']);
                    this.dataToSelected = null;
                }
            }), 300);
        }
    }
    /**
     * @return {?}
     */
    checkOrgTreeNodes() {
        if (this.treeListData && this.selections.length) {
            this.dataToChecked = this.selections;
            /** @type {?} */
            const checkedNodes = [];
            setTimeout((/**
             * @return {?}
             */
            () => {
                this.dataToChecked.forEach((/**
                 * @param {?} item
                 * @return {?}
                 */
                item => {
                    this.inTreeList(this.treeListData, item);
                    if (item.inTreeList) {
                        checkedNodes.push(item['id']);
                    }
                }));
                this.dataToChecked = this.dataToChecked.filter((/**
                 * @param {?} item
                 * @return {?}
                 */
                item => !checkedNodes.includes(item['id'])));
                if (checkedNodes.length) {
                    this.farrisTree.checkedNodes(checkedNodes, true, true);
                }
            }), 300);
        }
    }
}
OrganizationComponent.decorators = [
    { type: Component, args: [{
                selector: 'lib-org',
                template: "<farris-treetable #farristree style=\"cursor:pointer\" [width]=\"'100%'\" [data]=\"treeListData\" [idField]=\"'id'\"\r\n    [columns]=\"treeTableCols\" [singleSelect]=\"!multiSelect\" [showBorder]=\"false\" [showCheckbox]=\"multiSelect\"\r\n    [showIcon]=\"false\" [showHeader]=\"true\" [fixedHeader]=\"true\" [disabled]=\"false\" [fit]=\"true\" [checkOnSelect]=\"true\" [selectOnCheck]=\"true\"\r\n    [striped]=\"true\" [cascadeCheck]=\"cascadeCheck\" [cascadeDown]=\"cascadeDown\" [cascadeUp]=\"cascadeUp\"\r\n    [keepSelect]=\"keepSelect\" [showCheckAll]=\"showCheckAll\" [onlySelectSelf]=\"true\"\r\n    [virtualized]=\"true\"\r\n    (nodeChecked)=\"changeSelections($event)\" (nodeUnChecked)=\"changeSelections($event)\"\r\n    (nodeSelected)=\"changeSelections($event)\" (nodeUnSelect)=\"changeSelections($event)\"\r\n    (checkAll)=\"checkAll()\" (unCheckAll)=\"unCheckAll()\"\r\n    (expand)=\"listenTreeExpand($event)\" class=\"fos-treetable\">\r\n</farris-treetable>\r\n\r\n<!-- \u7EC4\u7EC7\u6811\u6A21\u677F -->\r\n<ng-template #orgNameCell let-ctx>\r\n    <span style=\"font-size: 13px;\" title=\"{{ctx.node.data.name}}\">{{ctx.node.data.name}}</span>\r\n</ng-template>\r\n\r\n<!-- \u7EC4\u7EC7\u6811\u6A21\u677F-\u6536\u85CF\u5217 -->\r\n<ng-template #favoritesCell let-ctx>\r\n    <span class=\"f-icon f-icon-star\" [class.default-light-color]=\"ctx.node.data.inFavorites\"\r\n        [class.default-dark-color]=\"!ctx.node.data.inFavorites\" (click)=\"toggleFavorites($event, ctx.node.data)\"></span>\r\n</ng-template>",
                styles: [""]
            }] }
];
/** @nocollapse */
OrganizationComponent.ctorParameters = () => [
    { type: ApiService },
    { type: ChangeDetectorRef },
    { type: FavoritesTool },
    { type: Injector },
    { type: NgZone },
    { type: StateMgrTool },
    { type: MessagerService }
];
OrganizationComponent.propDecorators = {
    enableFavorites: [{ type: Input }],
    baseCls: [{ type: HostBinding, args: ['class.f-utils-fill-flex-column',] }],
    farrisTree: [{ type: ViewChild, args: ['farristree',] }],
    orgNameCell: [{ type: ViewChild, args: ['orgNameCell',] }],
    favoritesCell: [{ type: ViewChild, args: ['favoritesCell',] }],
    primaryField: [{ type: Input }],
    enableHierarchicalLoading: [{ type: Input }],
    notGetStopOrg: [{ type: Input }],
    layer: [{ type: Input }],
    multiSelect: [{ type: Input }],
    absOrgType: [{ type: Input }],
    cascadeCheck: [{ type: Input }],
    cascadeUp: [{ type: Input }],
    cascadeDown: [{ type: Input }],
    showCheckAll: [{ type: Input }],
    keepSelect: [{ type: Input }],
    pathLength: [{ type: Input }],
    orgIds: [{ type: Input }],
    selectedLimit: [{ type: Input }],
    virtualizedLoad: [{ type: Input }],
    isActiveTab: [{ type: Input }],
    activeTabId: [{ type: Input }],
    dataPermission: [{ type: Input }],
    dataPermissionIds: [{ type: Input }],
    orgNameType: [{ type: Input }],
    onlyDisplayCompany: [{ type: Input }],
    onlyCurrentAdminOrg: [{ type: Input }],
    selectionsChange: [{ type: Output }]
};
if (false) {
    /** @type {?} */
    OrganizationComponent.prototype.enableFavorites;
    /** @type {?} */
    OrganizationComponent.prototype.baseCls;
    /** @type {?} */
    OrganizationComponent.prototype.farrisTree;
    /** @type {?} */
    OrganizationComponent.prototype.orgNameCell;
    /** @type {?} */
    OrganizationComponent.prototype.favoritesCell;
    /** @type {?} */
    OrganizationComponent.prototype.primaryField;
    /** @type {?} */
    OrganizationComponent.prototype.enableHierarchicalLoading;
    /** @type {?} */
    OrganizationComponent.prototype.notGetStopOrg;
    /** @type {?} */
    OrganizationComponent.prototype.layer;
    /** @type {?} */
    OrganizationComponent.prototype.multiSelect;
    /** @type {?} */
    OrganizationComponent.prototype.absOrgType;
    /** @type {?} */
    OrganizationComponent.prototype.cascadeCheck;
    /** @type {?} */
    OrganizationComponent.prototype.cascadeUp;
    /** @type {?} */
    OrganizationComponent.prototype.cascadeDown;
    /** @type {?} */
    OrganizationComponent.prototype.showCheckAll;
    /** @type {?} */
    OrganizationComponent.prototype.keepSelect;
    /** @type {?} */
    OrganizationComponent.prototype.pathLength;
    /** @type {?} */
    OrganizationComponent.prototype.orgIds;
    /** @type {?} */
    OrganizationComponent.prototype.selectedLimit;
    /** @type {?} */
    OrganizationComponent.prototype.virtualizedLoad;
    /** @type {?} */
    OrganizationComponent.prototype.isActiveTab;
    /** @type {?} */
    OrganizationComponent.prototype.activeTabId;
    /** @type {?} */
    OrganizationComponent.prototype.dataPermission;
    /** @type {?} */
    OrganizationComponent.prototype.dataPermissionIds;
    /** @type {?} */
    OrganizationComponent.prototype.orgNameType;
    /** @type {?} */
    OrganizationComponent.prototype.onlyDisplayCompany;
    /** @type {?} */
    OrganizationComponent.prototype.onlyCurrentAdminOrg;
    /** @type {?} */
    OrganizationComponent.prototype.selectionsChange;
    /**
     * @type {?}
     * @private
     */
    OrganizationComponent.prototype.selectionsSub;
    /**
     * @type {?}
     * @private
     */
    OrganizationComponent.prototype.favoritesSub;
    /** @type {?} */
    OrganizationComponent.prototype.originalTreeData;
    /** @type {?} */
    OrganizationComponent.prototype.locationOrgText;
    /** @type {?} */
    OrganizationComponent.prototype.treeListData;
    /** @type {?} */
    OrganizationComponent.prototype.treeTableCols;
    /** @type {?} */
    OrganizationComponent.prototype.selections;
    /** @type {?} */
    OrganizationComponent.prototype.favoritesList;
    /** @type {?} */
    OrganizationComponent.prototype.initLoad;
    /** @type {?} */
    OrganizationComponent.prototype.checkedOrgs;
    /**
     * @type {?}
     * @private
     */
    OrganizationComponent.prototype.loadingService;
    /**
     * @type {?}
     * @private
     */
    OrganizationComponent.prototype.localeService;
    /** @type {?} */
    OrganizationComponent.prototype.dataToChecked;
    /** @type {?} */
    OrganizationComponent.prototype.dataToSelected;
    /**
     * @type {?}
     * @private
     */
    OrganizationComponent.prototype.orgTreeTimer;
    /** @type {?} */
    OrganizationComponent.prototype.currentTabId;
    /** @type {?} */
    OrganizationComponent.prototype.currentUserOrgId;
    /** @type {?} */
    OrganizationComponent.prototype.currentUserOrgPath;
    /** @type {?} */
    OrganizationComponent.prototype.allAdminOrgData;
    /** @type {?} */
    OrganizationComponent.prototype.currentAdminOrgPath;
    /** @type {?} */
    OrganizationComponent.prototype.orgTypeId;
    /** @type {?} */
    OrganizationComponent.prototype.deptTypeId;
    /** @type {?} */
    OrganizationComponent.prototype.beforeClickNode;
    /** @type {?} */
    OrganizationComponent.prototype.beforeCheckAll;
    /**
     * @type {?}
     * @private
     */
    OrganizationComponent.prototype.apiService;
    /**
     * @type {?}
     * @private
     */
    OrganizationComponent.prototype.cdr;
    /**
     * @type {?}
     * @private
     */
    OrganizationComponent.prototype.favoritesTool;
    /**
     * @type {?}
     * @private
     */
    OrganizationComponent.prototype.injector;
    /**
     * @type {?}
     * @private
     */
    OrganizationComponent.prototype.ngZone;
    /**
     * @type {?}
     * @private
     */
    OrganizationComponent.prototype.stateMgr;
    /**
     * @type {?}
     * @private
     */
    OrganizationComponent.prototype.msgService;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidG8uY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGZhcnJpcy91aS1hZG1pbm9yZ2FuaXphdGlvbi1zZWxlY3Rvci8iLCJzb3VyY2VzIjpbImxpYi90YWItb3JnYW5pemF0aW9uL3RvLmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7OztBQUFBLE9BQU8sRUFDSCxTQUFTLEVBQUUsS0FBSyxFQUFFLFlBQVksRUFBRSxNQUFNLEVBQW1ELGlCQUFpQixFQUFZLFFBQVEsRUFBRSxTQUFTLEVBQUUsV0FBVyxFQUFFLFdBQVcsRUFBRSxNQUFNLEVBQzlLLE1BQU0sZUFBZSxDQUFDO0FBQ3ZCLE9BQU8sRUFBRSxVQUFVLEVBQUUsTUFBTSx5QkFBeUIsQ0FBQztBQUNyRCxPQUFPLEtBQUssQ0FBQyxNQUFNLFdBQVcsQ0FBQztBQUUvQixPQUFPLEVBQVksRUFBRSxFQUFFLE1BQU0sTUFBTSxDQUFDO0FBQ3BDLE9BQU8sRUFBRSxhQUFhLEVBQUUsTUFBTSw0QkFBNEIsQ0FBQztBQUMzRCxPQUFPLEVBQUUsVUFBVSxFQUFtQixNQUFNLHdCQUF3QixDQUFDO0FBQ3JFLE9BQU8sRUFBRSxVQUFVLEVBQUUsTUFBTSx5QkFBeUIsQ0FBQztBQUNyRCxPQUFPLEVBQVksa0JBQWtCLEVBQUUsTUFBTSxzQkFBc0IsQ0FBQztBQUNwRSxPQUFPLEVBQUUsWUFBWSxFQUFFLE1BQU0sNEJBQTRCLENBQUM7QUFFMUQsT0FBTyxFQUFFLFNBQVMsRUFBTyxNQUFNLGdCQUFnQixDQUFDO0FBQ2hELE9BQU8sRUFBRSxlQUFlLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQztBQUN0RCxPQUFPLEVBQUUsY0FBYyxFQUFFLE1BQU0sb0JBQW9CLENBQUM7QUFDcEQsT0FBTyxFQUFFLGFBQWEsRUFBRSxNQUFNLG1CQUFtQixDQUFDO0FBQ2xELE9BQU8sRUFBRSw0QkFBNEIsRUFBRSxNQUFNLG9CQUFvQixDQUFDO0FBT2xFLE1BQU0sT0FBTyxxQkFBcUI7Ozs7Ozs7Ozs7SUFx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QkM7Ozs7O0lBR0csMkNBQThCOzs7OztJQUM5QixvQ0FBOEI7Ozs7O0lBQzlCLDhDQUFvQzs7Ozs7SUFDcEMseUNBQTBCOzs7OztJQUMxQix1Q0FBc0I7Ozs7O0lBQ3RCLHlDQUE4Qjs7Ozs7SUFDOUIsMkNBQW1DIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcclxuICAgIENvbXBvbmVudCwgSW5wdXQsIEV2ZW50RW1pdHRlciwgT3V0cHV0LCBPbkluaXQsIEFmdGVyVmlld0luaXQsIFNpbXBsZUNoYW5nZXMsIE9uQ2hhbmdlcywgQ2hhbmdlRGV0ZWN0b3JSZWYsIE9wdGlvbmFsLCBJbmplY3RvciwgVmlld0NoaWxkLCBUZW1wbGF0ZVJlZiwgSG9zdEJpbmRpbmcsIE5nWm9uZSwgT25EZXN0cm95XHJcbn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IEFwaVNlcnZpY2UgfSBmcm9tICcuLi8uLi91dGlscy9hcGkuc2VydmljZSc7XHJcbmltcG9ydCAqIGFzIF8gZnJvbSAnbG9kYXNoLWVzJztcclxuaW1wb3J0IHsgbm9EYXRhSW1nIH0gZnJvbSAnLi4vLi4vYXNzZXRzL3Jlc291cmNlJztcclxuaW1wb3J0IHsgZm9ya0pvaW4sIG9mIH0gZnJvbSAncnhqcyc7XHJcbmltcG9ydCB7IEZhdm9yaXRlc1Rvb2wgfSBmcm9tICcuLi8uLi91dGlscy9mYXZvcml0ZXMudG9vbCc7XHJcbmltcG9ydCB7IENoYW5nZVR5cGUsIE9yZ1JlcXVlc3RQYXJhbSB9IGZyb20gJy4uLy4uL3V0aWxzL2luZGV4LnR5cGUnO1xyXG5pbXBvcnQgeyBDb21tb25VdGlsIH0gZnJvbSAnLi4vLi4vdXRpbHMvY29tbW9uLnRvb2wnO1xyXG5pbXBvcnQgeyBUcmVlTm9kZSwgVHJlZVRhYmxlQ29tcG9uZW50IH0gZnJvbSAnQGZhcnJpcy91aS10cmVldGFibGUnO1xyXG5pbXBvcnQgeyBTdGF0ZU1nclRvb2wgfSBmcm9tICcuLi8uLi91dGlscy9zdGF0ZS5tZ3IudG9vbCc7XHJcbmltcG9ydCB7IFN1YnNjcmlwdGlvbiB9IGZyb20gJ3J4anMnO1xyXG5pbXBvcnQgeyBzd2l0Y2hNYXAsIHRhcCB9IGZyb20gJ3J4anMvb3BlcmF0b3JzJztcclxuaW1wb3J0IHsgTWVzc2FnZXJTZXJ2aWNlIH0gZnJvbSAnQGZhcnJpcy91aS1tZXNzYWdlcic7XHJcbmltcG9ydCB7IExvYWRpbmdTZXJ2aWNlIH0gZnJvbSAnQGZhcnJpcy91aS1sb2FkaW5nJztcclxuaW1wb3J0IHsgTG9jYWxlU2VydmljZSB9IGZyb20gJ0BmYXJyaXMvdWktbG9jYWxlJztcclxuaW1wb3J0IHsgT1JHQU5JWkFUSU9OX1NFTEVDVE9SX0xPQ0FMRSB9IGZyb20gJy4uLy4uL3V0aWxzL2xvY2FsZSc7XHJcblxyXG5AQ29tcG9uZW50KHtcclxuICAgIHNlbGVjdG9yOiAnbGliLW9yZycsXHJcbiAgICB0ZW1wbGF0ZVVybDogJy4vdG8uY29tcG9uZW50Lmh0bWwnLFxyXG4gICAgc3R5bGVVcmxzOiBbJy4vdG8uY29tcG9uZW50LmNzcyddLFxyXG59KVxyXG5leHBvcnQgY2xhc3MgT3JnYW5pemF0aW9uQ29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0LCBBZnRlclZpZXdJbml0LCBPbkNoYW5nZXMsIE9uRGVzdHJveSB7XHJcblxyXG4gICAgQElucHV0KCkgZW5hYmxlRmF2b3JpdGVzOiBib29sZWFuO1xyXG4gICAgQEhvc3RCaW5kaW5nKCdjbGFzcy5mLXV0aWxzLWZpbGwtZmxleC1jb2x1bW4nKSBiYXNlQ2xzID0gdHJ1ZTtcclxuICAgIEBWaWV3Q2hpbGQoJ2ZhcnJpc3RyZWUnKSBmYXJyaXNUcmVlOiBUcmVlVGFibGVDb21wb25lbnQ7XHJcbiAgICBAVmlld0NoaWxkKCdvcmdOYW1lQ2VsbCcpIG9yZ05hbWVDZWxsOiBUZW1wbGF0ZVJlZjxhbnk+O1xyXG4gICAgQFZpZXdDaGlsZCgnZmF2b3JpdGVzQ2VsbCcpIGZhdm9yaXRlc0NlbGw6IFRlbXBsYXRlUmVmPGFueT47XHJcbiAgICBASW5wdXQoKSBwcmltYXJ5RmllbGQgPSAnb3JnSWQnO1xyXG4gICAgQElucHV0KCkgZW5hYmxlSGllcmFyY2hpY2FsTG9hZGluZzogYm9vbGVhbjtcclxuICAgIEBJbnB1dCgpIG5vdEdldFN0b3BPcmc6IGJvb2xlYW47XHJcbiAgICBASW5wdXQoKSBsYXllcjogbnVtYmVyO1xyXG4gICAgQElucHV0KCkgbXVsdGlTZWxlY3Q6IGJvb2xlYW47XHJcbiAgICBASW5wdXQoKSBhYnNPcmdUeXBlOiBhbnk7XHJcbiAgICBASW5wdXQoKSBjYXNjYWRlQ2hlY2s6IGJvb2xlYW47XHJcbiAgICBASW5wdXQoKSBjYXNjYWRlVXA6IGJvb2xlYW47XHJcbiAgICBASW5wdXQoKSBjYXNjYWRlRG93bjogYm9vbGVhbjtcclxuICAgIEBJbnB1dCgpIHNob3dDaGVja0FsbDogYm9vbGVhbjtcclxuICAgIEBJbnB1dCgpIGtlZXBTZWxlY3Q6IGJvb2xlYW47XHJcbiAgICBASW5wdXQoKSBwYXRoTGVuZ3RoID0gNDtcclxuICAgIC8vIOW3sumAieS4ree7hOe7h+eahGlkLCDmoLnmja7nu4Tnu4dpZOiOt+WPlue7hOe7h+WujOaVtOS/oeaBr++8jOeEtuWQjui/veWKoOWIsHNlbGVjdGlvbnMtLS10b2RvXHJcbiAgICBASW5wdXQoKSBvcmdJZHM6IHN0cmluZ1tdO1xyXG4gICAgQElucHV0KCkgc2VsZWN0ZWRMaW1pdDogbnVtYmVyO1xyXG4gICAgQElucHV0KCkgdmlydHVhbGl6ZWRMb2FkOiBib29sZWFuO1xyXG4gICAgQElucHV0KCkgaXNBY3RpdmVUYWI6IGJvb2xlYW47XHJcbiAgICBASW5wdXQoKSBhY3RpdmVUYWJJZDogc3RyaW5nO1xyXG4gICAgQElucHV0KCkgZGF0YVBlcm1pc3Npb24gPSBmYWxzZTtcclxuICAgIEBJbnB1dCgpIGRhdGFQZXJtaXNzaW9uSWRzOiBzdHJpbmdbXSA9IFtdO1xyXG4gICAgQElucHV0KCkgb3JnTmFtZVR5cGU6IHN0cmluZztcclxuICAgIEBJbnB1dCgpIG9ubHlEaXNwbGF5Q29tcGFueTogYm9vbGVhbjtcclxuICAgIEBJbnB1dCgpIG9ubHlDdXJyZW50QWRtaW5Pcmc6IGJvb2xlYW47XHJcbiAgICBAT3V0cHV0KCkgc2VsZWN0aW9uc0NoYW5nZSA9IG5ldyBFdmVudEVtaXR0ZXI8YW55PigpO1xyXG5cclxuICAgIHByaXZhdGUgc2VsZWN0aW9uc1N1YjogU3Vic2NyaXB0aW9uO1xyXG4gICAgcHJpdmF0ZSBmYXZvcml0ZXNTdWI6IFN1YnNjcmlwdGlvbjtcclxuICAgIG9yaWdpbmFsVHJlZURhdGEgPSBbXTtcclxuICAgIGxvY2F0aW9uT3JnVGV4dCA9ICcnO1xyXG4gICAgdHJlZUxpc3REYXRhOiBUcmVlTm9kZVtdID0gW107XHJcbiAgICB0cmVlVGFibGVDb2xzID0gW107XHJcbiAgICBzZWxlY3Rpb25zID0gW107XHJcbiAgICBmYXZvcml0ZXNMaXN0ID0gW107XHJcbiAgICBpbml0TG9hZCA9IHRydWU7XHJcbiAgICBjaGVja2VkT3JncyA9IFtdO1xyXG4gICAgcHJpdmF0ZSBsb2FkaW5nU2VydmljZTogTG9hZGluZ1NlcnZpY2UgPSBudWxsO1xyXG4gICAgcHJpdmF0ZSBsb2NhbGVTZXJ2aWNlOiBMb2NhbGVTZXJ2aWNlID0gbnVsbDtcclxuICAgIGRhdGFUb0NoZWNrZWQgPSBbXTtcclxuICAgIGRhdGFUb1NlbGVjdGVkOiBhbnk7XHJcbiAgICBwcml2YXRlIG9yZ1RyZWVUaW1lcjogYW55O1xyXG4gICAgY3VycmVudFRhYklkOiBzdHJpbmc7XHJcbiAgICBcclxuICAgIGN1cnJlbnRVc2VyT3JnSWQ6IHN0cmluZztcclxuICAgIGN1cnJlbnRVc2VyT3JnUGF0aDogc3RyaW5nO1xyXG4gICAgYWxsQWRtaW5PcmdEYXRhOiBhbnlbXSA9IFtdO1xyXG4gICAgY3VycmVudEFkbWluT3JnUGF0aDogc3RyaW5nO1xyXG4gICAgb3JnVHlwZUlkID0gJzllZGYyNWQxLWI5OTEtNGRkZS05MGI5LTMwMTQ1NDIyZDI0ZCc7XHJcbiAgICBkZXB0VHlwZUlkID0gJzMzYzIxNTA0LTMzODQtNDJhNy04ZmMzLWMxYjVlOWU5ODJkMCc7XHJcblxyXG4gICAgYmVmb3JlQ2xpY2tOb2RlID0gKGUpID0+IHtcclxuICAgICAgICBpZiAoIXRoaXMuZW5hYmxlSGllcmFyY2hpY2FsTG9hZGluZykge1xyXG4gICAgICAgICAgICByZXR1cm4gb2YodHJ1ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICghdGhpcy5tdWx0aVNlbGVjdCkge1xyXG4gICAgICAgICAgICBpZiAoZS5yb3dOb2RlLmlzU2VsZWN0ZWQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0U2VsZWN0aW9ucyhbXSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNldFNlbGVjdGlvbnMobmV3IEFycmF5KGUucm93Tm9kZS5ub2RlLmRhdGEpKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gb2YoZmFsc2UpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gY29uc3QgcGFyYW06IE9yZ1JlcXVlc3RQYXJhbSA9IHtcclxuICAgICAgICAvLyAgICAgYWJzT3JnVHlwZTogdGhpcy5hYnNPcmdUeXBlLFxyXG4gICAgICAgIC8vICAgICBub3RHZXRTdG9wT3JnOiB0aGlzLm5vdEdldFN0b3BPcmcsXHJcbiAgICAgICAgLy8gICAgIGdldEN1clVzZXI6IGZhbHNlLFxyXG4gICAgICAgIC8vICAgICBwYXJlbnRJRDogZS5yb3dOb2RlLmlkLFxyXG4gICAgICAgIC8vICAgICB3aXRoQWxsU3ViOiB0cnVlLFxyXG4gICAgICAgIC8vICAgICBnZXRPcmdBbGxQYXRoOiB0cnVlXHJcbiAgICAgICAgLy8gfTtcclxuICAgICAgICAvLyByZXR1cm4gdGhpcy5hcGlTZXJ2aWNlLmdldE9yZ2FuaXphdGlvbihwYXJhbSkucGlwZShcclxuICAgICAgICAvLyAgICAgc3dpdGNoTWFwKFxyXG4gICAgICAgIC8vICAgICAgICAgKGRhdGE6IGFueSkgPT4ge1xyXG4gICAgICAgIC8vICAgICAgICAgICAgIC8vIGlmIChkYXRhWydkYXRhJ10ubGVuZ3RoID4gdGhpcy5zZWxlY3RlZExpbWl0ICYmICFlLnJvd05vZGUuaXNDaGVja2VkKSB7XHJcbiAgICAgICAgLy8gICAgICAgICAgICAgLy8gICAgIHRoaXMubXNnU2VydmljZS5zaG93KCd3YXJuaW5nJywgYOS6su+8jOS4gOasoeaAp+mAieaLqeS6hui2hei/hyR7dGhpcy5zZWxlY3RlZExpbWl0feadoeaVsOaNrn5gLCB0cnVlKTtcclxuICAgICAgICAvLyAgICAgICAgICAgICAvLyAgICAgcmV0dXJuIG9mKGZhbHNlKVxyXG4gICAgICAgIC8vICAgICAgICAgICAgIC8vIH1cclxuICAgICAgICAvLyAgICAgICAgICAgICAvLyBpZiAoIWUucm93Tm9kZS5pc0NoZWNrZWQpIHtcclxuICAgICAgICAvLyAgICAgICAgICAgICAvLyAgICAgLy8gdG9kbyDlvoXpqozor4HvvIzliqDlhaVzZWxlY3Rpb27vvIxcclxuICAgICAgICAvLyAgICAgICAgICAgICAvLyAgICAgZGF0YS5kYXRhLmZvckVhY2goaXRlbSA9PiB7XHJcbiAgICAgICAgLy8gICAgICAgICAgICAgLy8gICAgICAgICBpZiAoQ29tbW9uVXRpbC5maW5kSW5kZXgoaXRlbVt0aGlzLnByaW1hcnlGaWVsZF0sIHRoaXMucHJpbWFyeUZpZWxkLCB0aGlzLnNlbGVjdGlvbnMpID09PSAtMSkge1xyXG4gICAgICAgIC8vICAgICAgICAgICAgIC8vICAgICAgICAgICAgIHRoaXMuc2V0U2VsZWN0aW9ucyhpdGVtLCBDaGFuZ2VUeXBlLkFwcGVuZCwgJ290aGVyJyk7XHJcbiAgICAgICAgLy8gICAgICAgICAgICAgLy8gICAgICAgICB9XHJcbiAgICAgICAgLy8gICAgICAgICAgICAgLy8gICAgIH0pXHJcbiAgICAgICAgLy8gICAgICAgICAgICAgLy8gfSBlbHNlIHtcclxuICAgICAgICAvLyAgICAgICAgICAgICAvLyAgICAgdGhpcy5zZWxlY3Rpb25zLmZvckVhY2goKHNlbGVjdGlvbiwgaW5kZXgpID0+IHtcclxuICAgICAgICAvLyAgICAgICAgICAgICAvLyAgICAgICAgIGRhdGEuZGF0YS5mb3JFYWNoKGl0ZW0gPT4ge1xyXG4gICAgICAgIC8vICAgICAgICAgICAgIC8vICAgICAgICAgICAgIGlmIChzZWxlY3Rpb25bdGhpcy5wcmltYXJ5RmllbGRdID09PSBpdGVtW3RoaXMucHJpbWFyeUZpZWxkXSkge1xyXG4gICAgICAgIC8vICAgICAgICAgICAgIC8vICAgICAgICAgICAgICAgICB0aGlzLnNldFNlbGVjdGlvbnMoaXRlbSwgQ2hhbmdlVHlwZS5SZW1vdmUsICdvdGhlcicpO1xyXG4gICAgICAgIC8vICAgICAgICAgICAgIC8vICAgICAgICAgICAgIH1cclxuICAgICAgICAvLyAgICAgICAgICAgICAvLyAgICAgICAgIH0pO1xyXG4gICAgICAgIC8vICAgICAgICAgICAgIC8vICAgICB9KTtcclxuICAgICAgICAvLyAgICAgICAgICAgICAvLyB9XHJcbiAgICAgICAgLy8gICAgICAgICAgICAgLy8gdGhpcy5jZHIuZGV0ZWN0Q2hhbmdlcygpO1xyXG4gICAgICAgIC8vICAgICAgICAgICAgIHJldHVybiBvZih0cnVlKTtcclxuICAgICAgICAvLyAgICAgICAgIH1cclxuICAgICAgICAvLyAgICAgKVxyXG4gICAgICAgIC8vICk7XHJcbiAgICB9O1xyXG5cclxuICAgIGJlZm9yZUNoZWNrQWxsID0gKGUpID0+IHtcclxuICAgICAgICBpZiAoIXRoaXMuZW5hYmxlSGllcmFyY2hpY2FsTG9hZGluZykge1xyXG4gICAgICAgICAgICByZXR1cm4gb2YodHJ1ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IHBhcmFtOiBPcmdSZXF1ZXN0UGFyYW0gPSB7XHJcbiAgICAgICAgICAgIGFic09yZ1R5cGU6IHRoaXMuYWJzT3JnVHlwZSxcclxuICAgICAgICAgICAgbm90R2V0U3RvcE9yZzogdGhpcy5ub3RHZXRTdG9wT3JnLFxyXG4gICAgICAgICAgICBnZXRDdXJVc2VyOiBmYWxzZSxcclxuICAgICAgICAgICAgcGFyZW50SUQ6IGUuaW5zdGFuY2UuZGF0YVswXS5pZCxcclxuICAgICAgICAgICAgd2l0aEFsbFN1YjogdHJ1ZSxcclxuICAgICAgICAgICAgZ2V0T3JnQWxsUGF0aDogdHJ1ZVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuYXBpU2VydmljZS5nZXRPcmdhbml6YXRpb24ocGFyYW0pLnBpcGUoXHJcbiAgICAgICAgICAgIHN3aXRjaE1hcChcclxuICAgICAgICAgICAgICAgIChkYXRhOiBhbnkpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBpZiAoZGF0YVsnZGF0YSddLmxlbmd0aCA+IHRoaXMuc2VsZWN0ZWRMaW1pdCkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vICAgICB0aGlzLm1zZ1NlcnZpY2Uuc2hvdygnd2FybmluZycsIGDkurLvvIzkuIDmrKHmgKfpgInmi6nkuobotoXov4cke3RoaXMuc2VsZWN0ZWRMaW1pdH3mnaHmlbDmja5+YCwgdHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgIHJldHVybiBvZihmYWxzZSlcclxuICAgICAgICAgICAgICAgICAgICAvLyB9XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRTZWxlY3Rpb25zKGRhdGFbJ2RhdGEnXSwgQ2hhbmdlVHlwZS5WYWx1ZUNoYW5nZWQsICdvdGhlcicpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBvZih0cnVlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgKVxyXG4gICAgICAgICk7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3RydWN0b3IoXHJcbiAgICAgICAgcHJpdmF0ZSBhcGlTZXJ2aWNlOiBBcGlTZXJ2aWNlLFxyXG4gICAgICAgIHByaXZhdGUgY2RyOiBDaGFuZ2VEZXRlY3RvclJlZixcclxuICAgICAgICBwcml2YXRlIGZhdm9yaXRlc1Rvb2w6IEZhdm9yaXRlc1Rvb2wsXHJcbiAgICAgICAgcHJpdmF0ZSBpbmplY3RvcjogSW5qZWN0b3IsXHJcbiAgICAgICAgcHJpdmF0ZSBuZ1pvbmU6IE5nWm9uZSxcclxuICAgICAgICBwcml2YXRlIHN0YXRlTWdyOiBTdGF0ZU1nclRvb2wsXHJcbiAgICAgICAgcHJpdmF0ZSBtc2dTZXJ2aWNlOiBNZXNzYWdlclNlcnZpY2VcclxuICAgICkge1xyXG4gICAgICAgIHRoaXMuY2RyID0gdGhpcy5pbmplY3Rvci5nZXQoQ2hhbmdlRGV0ZWN0b3JSZWYpO1xyXG4gICAgICAgIHRoaXMubG9hZGluZ1NlcnZpY2UgPSB0aGlzLmluamVjdG9yLmdldChMb2FkaW5nU2VydmljZSwgbnVsbCk7XHJcbiAgICAgICAgdGhpcy5sb2NhbGVTZXJ2aWNlID0gdGhpcy5pbmplY3Rvci5nZXQoTG9jYWxlU2VydmljZSk7XHJcbiAgICAgICAgaWYoIXRoaXMubG9jYWxlU2VydmljZS5sYW5nRGF0YVsnb3JnYW5pemF0aW9uU2VsZWN0b3InXSkge1xyXG4gICAgICAgICAgICB0aGlzLmxvY2FsZVNlcnZpY2Uuc2V0TG9jYWxlRGF0YShPUkdBTklaQVRJT05fU0VMRUNUT1JfTE9DQUxFKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgbmdPbkRlc3Ryb3koKTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy5mYXZvcml0ZXNTdWIudW5zdWJzY3JpYmUoKTtcclxuICAgICAgICB0aGlzLnNlbGVjdGlvbnNTdWIudW5zdWJzY3JpYmUoKTtcclxuICAgIH1cclxuXHJcbiAgICBuZ09uSW5pdCgpOiB2b2lkIHtcclxuICAgICAgICB0aGlzLnRyZWVUYWJsZUNvbHMgPSBbXHJcbiAgICAgICAgICAgIHsgZmllbGQ6ICduYW1lJywgdGl0bGU6IHRoaXMubG9jYWxlU2VydmljZS5nZXRWYWx1ZShcIm9yZ2FuaXphdGlvblNlbGVjdG9yLm9yZ2FuaXphdGlvbi5vcmdOYW1lXCIpLCB0ZW1wbGF0ZTogdGhpcy5vcmdOYW1lQ2VsbCB9LFxyXG4gICAgICAgICAgICB7IGZpZWxkOiAnYWJicmV2aWF0aW9uJywgdGl0bGU6IHRoaXMubG9jYWxlU2VydmljZS5nZXRWYWx1ZShcIm9yZ2FuaXphdGlvblNlbGVjdG9yLm9yZ2FuaXphdGlvbi5vcmdBYmJyZXZpYXRpb25cIikgfVxyXG4gICAgICAgIF07XHJcbiAgICAgICAgaWYgKHRoaXMuZW5hYmxlRmF2b3JpdGVzKSB7XHJcbiAgICAgICAgICAgIHRoaXMudHJlZVRhYmxlQ29scy5wdXNoKHtcclxuICAgICAgICAgICAgICAgIGZpZWxkOiAnJyxcclxuICAgICAgICAgICAgICAgIHRpdGxlOiB0aGlzLmxvY2FsZVNlcnZpY2UuZ2V0VmFsdWUoXCJvcmdhbml6YXRpb25TZWxlY3Rvci5vcmdhbml6YXRpb24uZmF2b3JpdGVcIiksXHJcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZTogdGhpcy5mYXZvcml0ZXNDZWxsXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB0aGlzLnRyZWVUYWJsZUNvbHNbMF0ud2lkdGggPSAzMDA7XHJcbiAgICAgICAgICAgIHRoaXMudHJlZVRhYmxlQ29sc1sxXS53aWR0aCA9IDMwMDtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgcGFyYW06IGFueSA9IHtcclxuICAgICAgICAgICAgd2l0aERpc2FibGVkT3JnOiAhdGhpcy5ub3RHZXRTdG9wT3JnLFxyXG4gICAgICAgICAgICBnZXR0aW5nQ3VycmVudE9yZzogZmFsc2UsXHJcbiAgICAgICAgICAgIG9ubHlEaXNwbGF5T3JnOiBmYWxzZVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5hcGlTZXJ2aWNlLmdldE9yZ2FuaXphdGlvbnMocGFyYW0pLnN1YnNjcmliZSgocmVzOiBhbnkpID0+IHtcclxuICAgICAgICAgICAgaWYocmVzICYmIHJlcy5vcmdzKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmFsbEFkbWluT3JnRGF0YSA9IHJlcy5vcmdzO1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaW5pdExvYWQgJiYgdGhpcy5pc0FjdGl2ZVRhYikge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmKHRoaXMuZW5hYmxlSGllcmFyY2hpY2FsTG9hZGluZykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmhsQXNzZW1ibGVEYXRhKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hc3NlbWJsZURhdGEoKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5pbml0TG9hZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5mYXZvcml0ZXNTdWIgPSB0aGlzLmZhdm9yaXRlc1Rvb2wuZmF2b3JpdGVzU3ViamVjdC5zdWJzY3JpYmUoZGF0YSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuZmF2b3JpdGVzTGlzdCA9IGRhdGE7XHJcbiAgICAgICAgICAgIHRoaXMuc2V0RmF2b3JpdGVzKHRoaXMudHJlZUxpc3REYXRhKTtcclxuICAgICAgICAgICAgdGhpcy5mYXJyaXNUcmVlLmRldGVjdENoYW5nZXMoKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLmN1cnJlbnRUYWJJZCA9IHRoaXMuYWN0aXZlVGFiSWQ7XHJcbiAgICAgICAgdGhpcy5zZWxlY3Rpb25zU3ViID0gdGhpcy5zdGF0ZU1nci5zZWxlY3Rpb25zU3ViamVjdC5zdWJzY3JpYmUoZGF0YSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChkYXRhLmNoYW5nZVR5cGUgPT09IENoYW5nZVR5cGUuVmFsdWVDaGFuZ2VkKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGlvbnMgPSBfLmNsb25lRGVlcChkYXRhLnZhbHVlKTtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLnNlbGVjdGlvbnMubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5kYXRhVG9TZWxlY3RlZCA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5kYXRhVG9DaGVja2VkID0gW107XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5mYXJyaXNUcmVlLmNsZWFyQ2hlY2tlZHMoKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmZhcnJpc1RyZWUuY2xlYXJTZWxlY3Rpb25zKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5mYXJyaXNUcmVlLmRldGVjdENoYW5nZXMoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSBlbHNlIGlmIChkYXRhLmNoYW5nZVR5cGUgPT09IENoYW5nZVR5cGUuUmVtb3ZlKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGlvbnMgPSB0aGlzLnNlbGVjdGlvbnMuZmlsdGVyKGl0ZW0gPT4gaXRlbVsnaWQnXSAhPT0gZGF0YS52YWx1ZVsnaWQnXSk7XHJcbiAgICAgICAgICAgICAgICBpZihkYXRhLmZyb20gPT0gJ3NlbGVjdGlvbicgJiYgdGhpcy5jdXJyZW50VGFiSWQgPT0gJ29yZ2FuaXphdGlvbicpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmluVHJlZUxpc3QodGhpcy50cmVlTGlzdERhdGEsIGRhdGEudmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmKGRhdGEudmFsdWUuaW5UcmVlTGlzdCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZih0aGlzLm11bHRpU2VsZWN0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmZhcnJpc1RyZWUudW5DaGVja2VkTm9kZShkYXRhLnZhbHVlWydpZCddKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZmFycmlzVHJlZS5jbGVhckFsbCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKGRhdGEuY2hhbmdlVHlwZSA9PT0gQ2hhbmdlVHlwZS5BcHBlbmQpIHtcclxuICAgICAgICAgICAgICAgIENvbW1vblV0aWwuZmluZEluZGV4KGRhdGEudmFsdWVbJ2lkJ10sICdpZCcsIHRoaXMuc2VsZWN0aW9ucykgPT09IC0xID8gdGhpcy5zZWxlY3Rpb25zLnB1c2goZGF0YS52YWx1ZSkgOiBudWxsO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgbmdBZnRlclZpZXdJbml0KCk6IHZvaWQge1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBuZ09uQ2hhbmdlcyhjaGFuZ2VzOiBTaW1wbGVDaGFuZ2VzKTogdm9pZCB7XHJcbiAgICAgICAgLypcclxuICAgICAgICBjb25zdCBvcmdJZHNDaGFuZ2UgPSBjaGFuZ2VzLm9yZ0lkcztcclxuICAgICAgICBpZiAob3JnSWRzQ2hhbmdlICYmIG9yZ0lkc0NoYW5nZS5jdXJyZW50VmFsdWUpIHtcclxuICAgICAgICAgICAgdGhpcy5jaGVja2VkT3JncyA9IG9yZ0lkc0NoYW5nZS5jdXJyZW50VmFsdWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgICovXHJcbiAgICB9XHJcblxyXG4gICAgLy8g5Yid5aeLdGFi6aG15LiN5Li657uE57uH5p625p6E77yM5YiH5o2i6Iez57uE57uH5p625p6E5pe26I635Y+W57uE57uH5pWw5o2uXHJcbiAgICBsb2FkVHJlZURhdGEoKSB7XHJcbiAgICAgICAgaWYodGhpcy5pbml0TG9hZCkge1xyXG4gICAgICAgICAgICBpZih0aGlzLmVuYWJsZUhpZXJhcmNoaWNhbExvYWRpbmcpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuaGxBc3NlbWJsZURhdGEoKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuYXNzZW1ibGVEYXRhKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5pbml0TG9hZCA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyDorr7nva7lvZPliY3nu4Tnu4fmoJHlkITkuKroioLngrnnmoTmlLbol4/nirbmgIFcclxuICAgIHByaXZhdGUgc2V0RmF2b3JpdGVzKHRyZWVMaXN0RGF0YTogVHJlZU5vZGVbXSkge1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdHJlZUxpc3REYXRhLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIGlmIChDb21tb25VdGlsLmZpbmRJbmRleCh0cmVlTGlzdERhdGFbaV0uaWQsICdpZCcsIHRoaXMuZmF2b3JpdGVzTGlzdCkgPT09IC0xKSB7XHJcbiAgICAgICAgICAgICAgICB0cmVlTGlzdERhdGFbaV0uZGF0YS5pbkZhdm9yaXRlcyA9IGZhbHNlO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdHJlZUxpc3REYXRhW2ldLmRhdGEuaW5GYXZvcml0ZXMgPSB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICh0cmVlTGlzdERhdGFbaV0uY2hpbGRyZW4ubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNldEZhdm9yaXRlcyh0cmVlTGlzdERhdGFbaV0uY2hpbGRyZW4pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgc2V0U2VsZWN0aW9ucyhzZWxlY3Rpb25zOiBhbnksIGNoYW5nZVR5cGUgPSBDaGFuZ2VUeXBlLlZhbHVlQ2hhbmdlZCwgZnJvbTogc3RyaW5nID0gJ3RyZWUnKSB7XHJcbiAgICAgICAgdGhpcy5zdGF0ZU1nci5lbWl0U2VsZWN0aW9ucyhzZWxlY3Rpb25zLCBjaGFuZ2VUeXBlLCBmcm9tKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyDnu4Tnu4fmoJHlhajpgInkuovku7ZcclxuICAgIGNoZWNrQWxsKCkge1xyXG4gICAgICAgIGlmICghdGhpcy5lbmFibGVIaWVyYXJjaGljYWxMb2FkaW5nKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGNoZWNrZWRzID0gW107XHJcbiAgICAgICAgICAgIHRoaXMuZmFycmlzVHJlZS5jaGVja2Vkcy5mb3JFYWNoKGl0ZW0gPT4ge1xyXG4gICAgICAgICAgICAgICAgY2hlY2tlZHMucHVzaChpdGVtLmRhdGEpO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB0aGlzLnNldFNlbGVjdGlvbnMoY2hlY2tlZHMpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyDnu4Tnu4fmoJHlj5bmtojlhajpgInkuovku7ZcclxuICAgIHVuQ2hlY2tBbGwoKSB7XHJcbiAgICAgICAgdGhpcy5zZXRTZWxlY3Rpb25zKFtdKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyDpgInkuK3vvIjlj5bmtojpgInkuK3jgIHli77pgInjgIHlj5bmtojli77pgInvvInmoJHoioLngrnml7bop6blj5FcclxuICAgIC8vIHRvZG8g5YiG5bGC5Yqg6L2955qE5pe25YCZ5ZKL5aSE55CG5pWw5o2u77yMYmVmb3JlVW5DaGVja0FsbOi/mOacquaUr+aMgeOAglxyXG4gICAgY2hhbmdlU2VsZWN0aW9ucyhlOiBhbnkpIHtcclxuICAgICAgICAvKlxyXG4gICAgICAgIGlmICghdGhpcy5lbmFibGVIaWVyYXJjaGljYWxMb2FkaW5nICYmICEhZS5vcmlnaW5hbEV2ZW50KSB7XHJcbiAgICAgICAgICAgIHRoaXMubXVsdGlTZWxlY3QgPyB0aGlzLnRvZ2dsZUNoZWNrZWQoZSkgOiB0aGlzLnRvZ2dsZVNlbGVjdGVkKGUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAqL1xyXG4gICAgICAgIHRoaXMubXVsdGlTZWxlY3QgPyB0aGlzLnRvZ2dsZUNoZWNrZWQoZSkgOiB0aGlzLnRvZ2dsZVNlbGVjdGVkKGUpO1xyXG4gICAgfVxyXG5cclxuICAgIHRvZ2dsZUNoZWNrZWQoZTogYW55KSB7XHJcbiAgICAgICAgbGV0IGNoZWNrZWRzID0gW107XHJcbiAgICAgICAgZSAmJiBlLmluc3RhbmNlICYmIGUuaW5zdGFuY2UuY2hlY2tlZHMuZm9yRWFjaChpdGVtID0+IHtcclxuICAgICAgICAgICAgY2hlY2tlZHMucHVzaChpdGVtLmRhdGEpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMuc2V0U2VsZWN0aW9ucyhjaGVja2Vkcy5jb25jYXQodGhpcy5kYXRhVG9DaGVja2VkKSk7XHJcbiAgICB9XHJcblxyXG4gICAgdG9nZ2xlU2VsZWN0ZWQoZTogYW55KSB7XHJcbiAgICAgICAgbGV0IHNlbGVjdGVkID0gW107XHJcbiAgICAgICAgZSAmJiBlLmluc3RhbmNlICYmIGUuaW5zdGFuY2Uuc2VsZWN0aW9ucy5mb3JFYWNoKGl0ZW0gPT4ge1xyXG4gICAgICAgICAgICBzZWxlY3RlZC5wdXNoKGl0ZW0uZGF0YSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5zZXRTZWxlY3Rpb25zKHNlbGVjdGVkKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyDmoLnmja7kvKDlhaXnmoTnu4Tnu4dpZOehruWumuW3sumAieaLqee7hOe7h1xyXG4gICAgcHJpdmF0ZSBhc3NlbWJsZURhdGFCeU9yZ0lkcyhpZHM6IHN0cmluZ1tdKXtcclxuICAgICAgICBpZighaWRzIHx8IGlkcy5sZW5ndGggPT09IDApIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZihpZHMgJiYgaWRzLmxlbmd0aCA+IDAgJiYgIXRoaXMubXVsdGlTZWxlY3Qpe1xyXG4gICAgICAgICAgICB0aGlzLm1zZ1NlcnZpY2Uuc2hvdygnd2FybmluZycsIHRoaXMubG9jYWxlU2VydmljZS5nZXRWYWx1ZShcIm9yZ2FuaXphdGlvblNlbGVjdG9yLmVycm9yTWVzc2FnZS5tdWx0aVNlbGVjdFwiKSwgdHJ1ZSk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgcGFyYW06IE9yZ1JlcXVlc3RQYXJhbSA9IHtcclxuICAgICAgICAgICAgYWJzT3JnVHlwZTogdGhpcy5hYnNPcmdUeXBlLFxyXG4gICAgICAgICAgICBpZExpc3Q6IGlkcyxcclxuICAgICAgICAgICAgZ2V0Q3VyVXNlcjogZmFsc2UsXHJcbiAgICAgICAgICAgIGdldE9yZ0FsbFBhdGg6IHRydWUsXHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLmFwaVNlcnZpY2UuZ2V0T3JnYW5pemF0aW9uKHBhcmFtKS5zdWJzY3JpYmUoKHJlczogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChyZXMgJiYgcmVzLmRhdGEgJiYgcmVzLmRhdGEubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jaGVja2VkT3JncyA9IHJlcy5kYXRhO1xyXG4gICAgICAgICAgICAgICAgcmVzLmRhdGEuZm9yRWFjaChpdGVtID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoQ29tbW9uVXRpbC5maW5kSW5kZXgoaXRlbVsnaWQnXSwgJ2lkJywgdGhpcy5zZWxlY3Rpb25zKSA9PT0gLTEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRTZWxlY3Rpb25zKGl0ZW0sIENoYW5nZVR5cGUuQXBwZW5kLCAnb3RoZXInKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIHRoaXMudGlja1NlbGVjdGlvbnMoKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuY2RyLmRldGVjdENoYW5nZXMoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIOWIhuWxguWKoOi9vee7hOe7h+agkVxyXG4gICAgaGxBc3NlbWJsZURhdGEoKSB7XHJcbiAgICAgICAgaWYodGhpcy5sb2FkaW5nU2VydmljZSkge1xyXG4gICAgICAgICAgICB0aGlzLmxvYWRpbmdTZXJ2aWNlLnNob3coKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgcGFyYW06IGFueSA9IHtcclxuICAgICAgICAgICAgd2l0aERpc2FibGVkT3JnOiAhdGhpcy5ub3RHZXRTdG9wT3JnLFxyXG4gICAgICAgICAgICBnZXR0aW5nQ3VycmVudE9yZzogdHJ1ZSxcclxuICAgICAgICAgICAgb25seURpc3BsYXlPcmc6IHRoaXMub25seURpc3BsYXlDb21wYW55XHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLmFwaVNlcnZpY2UuZ2V0T3JnYW5pemF0aW9uc1dpdGhMYXllcihwYXJhbSkuc3Vic2NyaWJlKChyZXM6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICBpZiAoIXJlcyB8fCAhcmVzLm9yZ3MpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgY29uc3QgY3VycmVudFVzZXJPcmcgPSB0aGlzLmFsbEFkbWluT3JnRGF0YS5maW5kKGRhdGEgPT4gZGF0YS5pZCA9PSByZXMuY3VycmVudE9yZy5vcmdJZCk7XHJcbiAgICAgICAgICAgIGlmKHRoaXMub25seURpc3BsYXlDb21wYW55KSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBhbGxQYXRoSW5mb09yZ0xpc3QgPSB0aGlzLmFsbEFkbWluT3JnRGF0YS5maWx0ZXIoZGF0YSA9PiBjdXJyZW50VXNlck9yZy5wYXRoLnN0YXJ0c1dpdGgoZGF0YS5wYXRoKSAmJiBkYXRhLnZhbHVlVHlwZSA9PSB0aGlzLm9yZ1R5cGVJZCk7XHJcbiAgICAgICAgICAgICAgICBsZXQgbGF5ZXIgPSAwO1xyXG4gICAgICAgICAgICAgICAgYWxsUGF0aEluZm9PcmdMaXN0LmZvckVhY2gob3JnID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBpZihOdW1iZXIob3JnLmxheWVyKSA+IGxheWVyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudFVzZXJPcmdJZCA9IG9yZy5pZDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50VXNlck9yZ1BhdGggPSBvcmcucGF0aDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGF5ZXIgPSBOdW1iZXIob3JnLmxheWVyKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudFVzZXJPcmdJZCA9IGN1cnJlbnRVc2VyT3JnLmlkO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50VXNlck9yZ1BhdGggPSBjdXJyZW50VXNlck9yZy5wYXRoO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmKHRoaXMub25seUN1cnJlbnRBZG1pbk9yZykge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZGVwdFBhdGhMaXN0ID0gW107XHJcbiAgICAgICAgICAgICAgICBmb3IobGV0IGkgPSAwOyBpIDwgdGhpcy5jdXJyZW50VXNlck9yZ1BhdGgubGVuZ3RoIC8gNDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IGluZGV4RGF0YSA9IHJlcy5vcmdzLmZpbmQob3JnID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYoaSA9PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gb3JnLnBhdGggPT0gdGhpcy5jdXJyZW50VXNlck9yZ1BhdGg7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gb3JnLnBhdGggPT0gdGhpcy5jdXJyZW50VXNlck9yZ1BhdGguc2xpY2UoMCwgLTQgKiBpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmKGluZGV4RGF0YS52YWx1ZVR5cGUgPT0gdGhpcy5vcmdUeXBlSWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50QWRtaW5PcmdQYXRoID0gaW5kZXhEYXRhLnBhdGg7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKGluZGV4RGF0YS5wYXRoICE9IHRoaXMuY3VycmVudFVzZXJPcmdQYXRoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZXB0UGF0aExpc3QucHVzaChpbmRleERhdGEucGF0aCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZih0aGlzLmN1cnJlbnRBZG1pbk9yZ1BhdGggPT0gdGhpcy5jdXJyZW50VXNlck9yZ1BhdGgpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLm9yaWdpbmFsVHJlZURhdGEgPSBbcmVzLm9yZ3MuZmluZChvcmcgPT4gb3JnLnBhdGggPT0gdGhpcy5jdXJyZW50VXNlck9yZ1BhdGgpXTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZGVwdFBhdGhMaXN0LnB1c2godGhpcy5jdXJyZW50QWRtaW5PcmdQYXRoKTtcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGl0ZW0gb2YgZGVwdFBhdGhMaXN0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCB0YXJnZXRPcmdEYXRhID0gdGhpcy5hbGxBZG1pbk9yZ0RhdGEuZmlsdGVyKG9yZyA9PiBvcmcucGF0aC5zbGljZSgwLCAtNCkgPT0gaXRlbSAmJiBvcmcudmFsdWVUeXBlID09IHRoaXMuZGVwdFR5cGVJZCAmJiAhb3JnLmRpc2FibGVkKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vcmlnaW5hbFRyZWVEYXRhID0gdGhpcy5vcmlnaW5hbFRyZWVEYXRhLmNvbmNhdCh0YXJnZXRPcmdEYXRhIHx8IFtdKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vcmlnaW5hbFRyZWVEYXRhLnB1c2gocmVzLm9yZ3MuZmluZChvcmcgPT4gb3JnLnBhdGggPT0gdGhpcy5jdXJyZW50QWRtaW5PcmdQYXRoKSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBmb3IobGV0IGkgPSB0aGlzLmN1cnJlbnRVc2VyT3JnUGF0aC5sZW5ndGggLyA0LCBpbmRleCA9IDE7IGkgPiAxOyBpLS0pIHtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgdGFyZ2V0T3JnRGF0YSA9IHRoaXMuYWxsQWRtaW5PcmdEYXRhLmZpbHRlcihvcmcgPT4gTnVtYmVyKG9yZ1snbGF5ZXInXSkgPT0gaSAmJiBvcmcucGF0aC5zbGljZSgwLCAtNCkgPT0gdGhpcy5jdXJyZW50VXNlck9yZ1BhdGguc2xpY2UoMCwgLTQgKiBpbmRleCkgJiYgIW9yZy5kaXNhYmxlZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vcmlnaW5hbFRyZWVEYXRhID0gdGhpcy5vcmlnaW5hbFRyZWVEYXRhLmNvbmNhdCh0YXJnZXRPcmdEYXRhIHx8IFtdKTtcclxuICAgICAgICAgICAgICAgICAgICBpbmRleCArPSAxO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdGhpcy5vcmlnaW5hbFRyZWVEYXRhLnB1c2gocmVzLm9yZ3MuZmluZChvcmcgPT4gb3JnWydsYXllciddID09ICcxJykpO1xyXG4gICAgICAgICAgICAgICAgaWYodGhpcy5vbmx5RGlzcGxheUNvbXBhbnkpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLm9yaWdpbmFsVHJlZURhdGEgPSB0aGlzLm9yaWdpbmFsVHJlZURhdGEuZmlsdGVyKGRhdGEgPT4gZGF0YS52YWx1ZVR5cGUgPT0gdGhpcy5vcmdUeXBlSWQpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMub3JpZ2luYWxUcmVlRGF0YS5mb3JFYWNoKGl0ZW0gPT4ge1xyXG4gICAgICAgICAgICAgICAgaXRlbS5zZWxlY3RhYmxlID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIGlmKHRoaXMuZW5hYmxlRmF2b3JpdGVzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKENvbW1vblV0aWwuZmluZEluZGV4KGl0ZW1bJ2lkJ10sICdpZCcsIHRoaXMuZmF2b3JpdGVzTGlzdCkgPT09IC0xKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW0uaW5GYXZvcml0ZXMgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpdGVtLmluRmF2b3JpdGVzID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9IFxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgaWYocmVzLmN1cnJlbnRPcmcub3JnSWQgPT0gJ251bGxvcmcnKSB7XHJcbiAgICAgICAgICAgICAgICAvLyDpnIDopoHljLrliIbmmK/lkKbkuLphZG1pbui0puaIt+eZu+W9lVxyXG4gICAgICAgICAgICAgICAgdGhpcy50cmVlTGlzdERhdGEgPSB0aGlzLmRhdGFUb1RyZWUodGhpcy5vcmlnaW5hbFRyZWVEYXRhLCAxLCAnKicpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGhpcy50cmVlTGlzdERhdGEgPSB0aGlzLmRhdGFUb1RyZWUodGhpcy5vcmlnaW5hbFRyZWVEYXRhLCAxLCB0aGlzLmN1cnJlbnRVc2VyT3JnUGF0aCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5mYXJyaXNUcmVlLmxvYWREYXRhKHRoaXMudHJlZUxpc3REYXRhKTtcclxuICAgICAgICAgICAgaWYodGhpcy5tdWx0aVNlbGVjdCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jaGVja09yZ1RyZWVOb2RlcygpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RPcmdUcmVlTm9kZSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMuY2RyLmRldGVjdENoYW5nZXMoKTtcclxuICAgICAgICAgICAgaWYodGhpcy5sb2FkaW5nU2VydmljZSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5sb2FkaW5nU2VydmljZS5jbG9zZSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8g5YWo5Yqg6L2957uE57uH5qCRXHJcbiAgICBhc3NlbWJsZURhdGEoKSB7XHJcbiAgICAgICAgaWYodGhpcy5sb2FkaW5nU2VydmljZSkge1xyXG4gICAgICAgICAgICB0aGlzLmxvYWRpbmdTZXJ2aWNlLnNob3coKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgcGFyYW06IGFueSA9IHtcclxuICAgICAgICAgICAgd2l0aERpc2FibGVkT3JnOiAoIXRoaXMubm90R2V0U3RvcE9yZykudG9TdHJpbmcoKSxcclxuICAgICAgICAgICAgZ2V0aW5nQ3VycmVudE9yZzogJycgKyB0cnVlLFxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5hcGlTZXJ2aWNlLmdldE9yZ2FuaXphdGlvbnMocGFyYW0pLnN1YnNjcmliZSgocmVzOiBhbnkpID0+IHtcclxuICAgICAgICAgICAgaWYgKCFyZXMgfHwgIXJlcy5vcmdzKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHRoaXMuZW5hYmxlRmF2b3JpdGVzKSB7XHJcbiAgICAgICAgICAgICAgICByZXMub3Jncy5mb3JFYWNoKGl0ZW0gPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChDb21tb25VdGlsLmZpbmRJbmRleChpdGVtWydpZCddLCAnaWQnLCB0aGlzLmZhdm9yaXRlc0xpc3QpID09PSAtMSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpdGVtLmluRmF2b3JpdGVzID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaXRlbS5pbkZhdm9yaXRlcyA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5vcmlnaW5hbFRyZWVEYXRhID0gcmVzLm9yZ3M7XHJcbiAgICAgICAgICAgIHRoaXMudHJlZUxpc3REYXRhID0gdGhpcy5kYXRhVG9UcmVlKHJlcy5vcmdzLCAxLCByZXMuY3VycmVudE9yZy5vcmdQYXRoKTtcclxuICAgICAgICAgICAgdGhpcy5mYXJyaXNUcmVlLmxvYWREYXRhKHRoaXMudHJlZUxpc3REYXRhKTtcclxuICAgICAgICAgICAgaWYodGhpcy5tdWx0aVNlbGVjdCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jaGVja09yZ1RyZWVOb2RlcygpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RPcmdUcmVlTm9kZSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMuY2RyLmRldGVjdENoYW5nZXMoKTtcclxuICAgICAgICAgICAgaWYodGhpcy5sb2FkaW5nU2VydmljZSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5sb2FkaW5nU2VydmljZS5jbG9zZSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8g56Gu5a6a5bey6YCJ57uE57uH5piv5ZCm5Zyo5b2T5YmN57uE57uH5qCR5YaFXHJcbiAgICBwcml2YXRlIGluVHJlZUxpc3QodHJlZUxpc3REYXRhOiBUcmVlTm9kZVtdLCBpdGVtOiBhbnkpIHtcclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRyZWVMaXN0RGF0YS5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICBpZiAodHJlZUxpc3REYXRhW2ldLmlkID09PSBpdGVtWydpZCddKSB7XHJcbiAgICAgICAgICAgICAgICBpdGVtLmluVHJlZUxpc3QgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHRyZWVMaXN0RGF0YVtpXS5jaGlsZHJlbi5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuaW5UcmVlTGlzdCh0cmVlTGlzdERhdGFbaV0uY2hpbGRyZW4sIGl0ZW0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8vIOWcqOW9k+WJjee7hOe7h+agkeWGheWLvumAieaJgOacieW3sumAieaLqeeahOe7hOe7h1xyXG4gICAgcHJpdmF0ZSB0aWNrU2VsZWN0aW9ucygpIHtcclxuICAgICAgICAvLyBjb25zdCBpZHMgPSBbXTtcclxuICAgICAgICAvLyB0aGlzLnNlbGVjdGVkRGF0YU5vdEluVHJlZUxpc3QgPSBbXTtcclxuICAgICAgICAvLyB0aGlzLnNlbGVjdGlvbnMuZm9yRWFjaChpdGVtID0+IHtcclxuICAgICAgICAvLyAgICAgdGhpcy5pblRyZWVMaXN0KHRoaXMudHJlZUxpc3REYXRhLCBpdGVtKTtcclxuICAgICAgICAvLyAgICAgaWYgKCEhaXRlbS5pblRyZWVMaXN0KSB7XHJcbiAgICAgICAgLy8gICAgICAgICBpZHMucHVzaChpdGVtW3RoaXMucHJpbWFyeUZpZWxkXSk7XHJcbiAgICAgICAgLy8gICAgIH0gZWxzZSB7XHJcbiAgICAgICAgLy8gICAgICAgICBpZighdGhpcy5tdWx0aVNlbGVjdCkge1xyXG4gICAgICAgIC8vICAgICAgICAgICAgIHRoaXMuc2luZ2xlU2VsZWN0ZWREYXRhID0gbnVsbDtcclxuICAgICAgICAvLyAgICAgICAgIH1cclxuICAgICAgICAvLyAgICAgICAgIHRoaXMuc2VsZWN0ZWREYXRhTm90SW5UcmVlTGlzdC5wdXNoKGl0ZW0pO1xyXG4gICAgICAgIC8vICAgICB9XHJcbiAgICAgICAgLy8gfSk7XHJcbiAgICAgICAgLy8gdGhpcy5uZ1pvbmUucnVuT3V0c2lkZUFuZ3VsYXIoKCkgPT4ge1xyXG4gICAgICAgIC8vICAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICAvLyAgICAgICAgIGlmICghaWRzLmxlbmd0aCkge1xyXG4gICAgICAgIC8vICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAvLyAgICAgICAgIH1cclxuICAgICAgICAvLyAgICAgICAgIGlmICh0aGlzLm11bHRpU2VsZWN0KSB7XHJcbiAgICAgICAgLy8gICAgICAgICAgICAgdGhpcy5mYXJyaXNUcmVlLmNoZWNrZWROb2RlcyhpZHMsIHRydWUsIHRydWUpO1xyXG4gICAgICAgIC8vICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAvLyAgICAgICAgICAgICB0aGlzLmZhcnJpc1RyZWUuY2xlYXJTZWxlY3Rpb25zKCk7XHJcbiAgICAgICAgLy8gICAgICAgICAgICAgLy9cclxuICAgICAgICAvLyAgICAgICAgICAgICB0aGlzLmZhcnJpc1RyZWUuZGV0ZWN0Q2hhbmdlcygpO1xyXG4gICAgICAgIC8vICAgICAgICAgICAgIHRoaXMuc2VsZWN0T3JnVHJlZU5vZGUoKTtcclxuICAgICAgICAvLyAgICAgICAgIH1cclxuICAgICAgICAvLyAgICAgfSlcclxuICAgICAgICAvLyB9KVxyXG4gICAgfSAgICBcclxuXHJcbiAgICAvKipcclxuICAgICog57uE57uH5pWw5o2u6L2s5o2iXHJcbiAgICAqIEBwYXJhbSBwbGFpblNvdXJjZSDmjqXlj6Pljp/lp4vmlbDmja5cclxuICAgICogQHBhcmFtIGxheWVyIOWxgue6p1xyXG4gICAgKiBAcmV0dXJucyDov5Tlm57moJHlvaLmjqXlj6PnmoTmlbDmja5cclxuICAgICovXHJcbiAgICBwcml2YXRlIGRhdGFUb1RyZWUocGxhaW5Tb3VyY2U6IGFueSwgbGF5ZXI6IG51bWJlciwgZXhwYW5kZWRQYXRoOiBzdHJpbmcgPSAnJykge1xyXG4gICAgICAgIGNvbnN0IHRyZWVTb3VyY2UgPSB0aGlzLmRlYWxEYXRhKHBsYWluU291cmNlLCBleHBhbmRlZFBhdGggPyBleHBhbmRlZFBhdGggOiAnJyk7XHJcbiAgICAgICAgLy8gY29uc3QgcGFyZW50cyA9IHRyZWVTb3VyY2UuZmlsdGVyKGl0ZW0gPT4ge1xyXG4gICAgICAgIC8vICAgICByZXR1cm4gaXRlbS5kYXRhLmxheWVyID09PSBsYXllcjtcclxuICAgICAgICAvLyB9KTtcclxuICAgICAgICAvLyB0aGlzLnRyZWVEYXRhKHBhcmVudHMsIHRyZWVTb3VyY2UsIDEpO1xyXG4gICAgICAgIHJldHVybiB0cmVlU291cmNlO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgZGVhbERhdGFXaGVuRXhwYW5kVHJlZU5vZGUoZGF0YTogYW55W10pIHtcclxuICAgICAgICBpZighZGF0YSB8fCAhZGF0YS5sZW5ndGgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIFtdXHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IG5ld0RhdGFzID0gW107XHJcbiAgICAgICAgZGF0YS5mb3JFYWNoKGl0ZW0gPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBuZXdzRGF0YU9iajogYW55ID0ge1xyXG4gICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgIGlkOiBpdGVtLmlkLFxyXG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IGl0ZW0ubmFtZSxcclxuICAgICAgICAgICAgICAgICAgICBwYXRoOiBpdGVtLnBhdGgsXHJcbiAgICAgICAgICAgICAgICAgICAgY29kZTogaXRlbS5jb2RlLFxyXG4gICAgICAgICAgICAgICAgICAgIGFiYnJldmlhdGlvbjogaXRlbS5hYmJyZXZpYXRpb24sXHJcbiAgICAgICAgICAgICAgICAgICAgbGF5ZXI6IE51bWJlcihpdGVtLmxheWVyKSxcclxuICAgICAgICAgICAgICAgICAgICBpbkZhdm9yaXRlczogaXRlbS5pbkZhdm9yaXRlc1xyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIGV4cGFuZGVkOiBmYWxzZSxcclxuICAgICAgICAgICAgICAgIGNoaWxkcmVuOiBbXVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICBpZighaXRlbS5pc0RldGFpbCkge1xyXG4gICAgICAgICAgICAgICAgbmV3c0RhdGFPYmoubGVhZiA9IGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIG5ld0RhdGFzLnB1c2gobmV3c0RhdGFPYmopO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiBuZXdEYXRhcztcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOmihOWkhOeQhue7hOe7h+aVsOaNrlxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIGRlYWxEYXRhKGRhdGE6IGFueVtdLCBleHBhbmRlZFBhdGg6IHN0cmluZyA9ICcnKSB7XHJcbiAgICAgICAgY29uc3QgcGF0aExpc3QgPSBbXTtcclxuICAgICAgICBpZihleHBhbmRlZFBhdGggIT0gJycpIHtcclxuICAgICAgICAgICAgbGV0IG1heExlbmd0aCA9IGV4cGFuZGVkUGF0aC5sZW5ndGggLyB0aGlzLnBhdGhMZW5ndGg7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmVuYWJsZUhpZXJhcmNoaWNhbExvYWRpbmcpIHtcclxuICAgICAgICAgICAgICAgIG1heExlbmd0aCAtPSAxO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGZvciAobGV0IGEgPSAwOyBhIDwgbWF4TGVuZ3RoOyBhKyspIHtcclxuICAgICAgICAgICAgICAgIHBhdGhMaXN0LnB1c2goeyBwYXRoOiBleHBhbmRlZFBhdGguc3Vic3RyaW5nKDAsIDQgKiAoYSArIDEpKSB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiBbXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3Qgbm9kZXMgPSBuZXcgTWFwPHN0cmluZywgYW55PigpO1xyXG4gICAgICAgIGNvbnN0IG5ld0RhdGFzID0gW107XHJcbiAgICAgICAgaWYgKGRhdGEubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIGRhdGEuZm9yRWFjaChpdGVtID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHBhdGg6IHN0cmluZyA9IGl0ZW1bJ3BhdGgnXTtcclxuICAgICAgICAgICAgICAgIGxldCBwYXJlbnRQYXRoO1xyXG4gICAgICAgICAgICAgICAgaWYodGhpcy5vbmx5Q3VycmVudEFkbWluT3JnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcGFyZW50UGF0aCA9IHBhdGggPT0gdGhpcy5jdXJyZW50QWRtaW5PcmdQYXRoID8gJ3RvcCcgOiBpdGVtLnBhdGguc2xpY2UoMCwgLTQpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBwYXJlbnRQYXRoID0gaXRlbVsnbGF5ZXInXSA9PSAnMScgPyAndG9wJyA6IGl0ZW0ucGF0aC5zbGljZSgwLCAtNCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZighbm9kZXNbcGF0aF0pIHtcclxuICAgICAgICAgICAgICAgICAgICBub2Rlc1twYXRoXSA9IHsgY2hpbGRyZW46IFtdIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIG5vZGVzW3BhdGhdID0ge1xyXG4gICAgICAgICAgICAgICAgICAgIGRhdGEgOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlkOiBpdGVtLmlkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBpdGVtLm5hbWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhdGg6IGl0ZW0ucGF0aCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29kZTogaXRlbS5jb2RlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhYmJyZXZpYXRpb246IGl0ZW0uYWJicmV2aWF0aW9uLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBsYXllcjogTnVtYmVyKGl0ZW0ubGF5ZXIpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpbkZhdm9yaXRlczogaXRlbS5pbkZhdm9yaXRlc1xyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgZXhwYW5kZWQ6IGZhbHNlLFxyXG4gICAgICAgICAgICAgICAgICAgIGNoaWxkcmVuOiBub2Rlc1twYXRoXVsnY2hpbGRyZW4nXVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKENvbW1vblV0aWwuZmluZEluZGV4KGl0ZW0ucGF0aCwgJ3BhdGgnLCBwYXRoTGlzdCkgIT09IC0xIHx8IE51bWJlcihpdGVtLmxheWVyKSA8IHRoaXMubGF5ZXIpIHtcclxuICAgICAgICAgICAgICAgICAgICBub2Rlc1twYXRoXVsnZXhwYW5kZWQnXSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIG5vZGVzW3BhdGhdWydleHBhbmRlZCddID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuZW5hYmxlSGllcmFyY2hpY2FsTG9hZGluZyAmJiAhaXRlbS5pc0RldGFpbCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBub2Rlc1twYXRoXVsnbGVhZiddID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYodGhpcy5kYXRhUGVybWlzc2lvbiAmJiB0aGlzLmRhdGFQZXJtaXNzaW9uSWRzLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHRhcmdldCA9IHRoaXMuZGF0YVBlcm1pc3Npb25JZHMuZmluZCh0ID0+IHQgPT0gaXRlbVsnb3JnSWQnXSk7XHJcbiAgICAgICAgICAgICAgICAgICAgbm9kZXNbcGF0aF1bJ3NlbGVjdGFibGUnXSA9IHRhcmdldCA/IHRydWUgOiBmYWxzZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmKHBhcmVudFBhdGggPT0gJ3RvcCcpIHtcclxuICAgICAgICAgICAgICAgICAgICBuZXdEYXRhcy5wdXNoKG5vZGVzW3BhdGhdKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYoIW5vZGVzW3BhcmVudFBhdGhdKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVzW3BhcmVudFBhdGhdID0geyBjaGlsZHJlbjogW10gfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAobm9kZXNbcGFyZW50UGF0aF1bJ2NoaWxkcmVuJ10gYXMgQXJyYXk8YW55PikucHVzaChub2Rlc1twYXRoXSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gbmV3RGF0YXM7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDmlbDmja7ovazmjaJcclxuICAgICAqIEBwYXJhbSBwYXJlbnRzIOeItue6p+iKgueCueS/oeaBr1xyXG4gICAgICogQHBhcmFtIHRyZWVTb3VyY2Ug5Y6f5aeL5pWw5o2u5L+h5oGvXHJcbiAgICAgKiBAcGFyYW0gbGF5ZXIg5bGC57qnXHJcbiAgICAgKi9cclxuICAgIHRyZWVEYXRhKHBhcmVudHM6IGFueSwgdHJlZVNvdXJjZTogYW55LCBsYXllcjogbnVtYmVyKSB7XHJcbiAgICAgICAgcGFyZW50cy5mb3JFYWNoKHBhcmVudCA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHBhcmVudFBhdGggPSBwYXJlbnRbJ2RhdGEnXVsncGF0aCddO1xyXG4gICAgICAgICAgICBjb25zdCBwYXJlbnRMYXllciA9IHBhcmVudFsnZGF0YSddWydsYXllciddO1xyXG4gICAgICAgICAgICB0cmVlU291cmNlLmZvckVhY2goaXRlbSA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAoaXRlbSAmJiBpdGVtWydkYXRhJ10gJiYgaXRlbVsnZGF0YSddWydwYXRoJ10pIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBpdGVtUGF0aCA9IGl0ZW1bJ2RhdGEnXVsncGF0aCddO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGl0ZW1MYXllciA9IGl0ZW1bJ2RhdGEnXVsnbGF5ZXInXTtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgdGFyZ2V0UGF0aDogc3RyaW5nO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChpdGVtUGF0aCAmJiBpdGVtUGF0aC5sZW5ndGggPiBwYXJlbnRQYXRoLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXRQYXRoID0gaXRlbVBhdGguc3Vic3RyKDAsIE51bWJlcihsYXllcikgKiA0KTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHBhcmVudFBhdGggPT09IHRhcmdldFBhdGggJiYgcGFyZW50TGF5ZXIgPT09IGl0ZW1MYXllciAtIDEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGFyZW50WydjaGlsZHJlbiddLnB1c2goaXRlbSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChwYXJlbnRQYXRoID09PSB0YXJnZXRQYXRoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudHJlZURhdGEoW2l0ZW1dLCB0cmVlU291cmNlLCBOdW1iZXIobGF5ZXIpICsgMSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KVxyXG4gICAgfVxyXG5cclxuICAgIC8vIOaUtuiXj+aIluWPlua2iOaUtuiXj+W9k+WJjeiKgueCueWvueW6lOeahOe7hOe7h1xyXG4gICAgdG9nZ2xlRmF2b3JpdGVzKGU6IGFueSwgaXRlbTogYW55KSB7XHJcbiAgICAgICAgdGhpcy5mYXZvcml0ZXNUb29sLnRvZ2dsZUZhdm9yaXRlcyhlLCBpdGVtKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyDnm5HlkKznu4Tnu4fmoJHlsZXlvIDkuovku7ZcclxuICAgIGxpc3RlblRyZWVFeHBhbmQob2JqOiBhbnkpIHtcclxuICAgICAgICAvLyB0b2RvIOWIhuWxguWKoOi9vVxyXG4gICAgICAgIGlmICh0aGlzLmVuYWJsZUhpZXJhcmNoaWNhbExvYWRpbmcgJiYgb2JqLmNoaWxkcmVuLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgICAgICB0aGlzLmdldE9yZ2FuaXphdGlvbkJ5UGFyZW50Tm9kZShvYmopO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyDliIblsYLliqDovb3ml7bvvIzojrflj5bkuIvnuqfnu4Tnu4fmlbDmja7lubbkuLrlvZPliY3nu4Tnu4fmoJHmt7vliqDlrZDoioLngrlcclxuICAgIGdldE9yZ2FuaXphdGlvbkJ5UGFyZW50Tm9kZShwYXJlbnROb2RlOiBhbnkpIHtcclxuICAgICAgICBpZih0aGlzLmxvYWRpbmdTZXJ2aWNlKSB7XHJcbiAgICAgICAgICAgIHRoaXMubG9hZGluZ1NlcnZpY2Uuc2hvdygpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCBwYXJhbTogYW55ID0ge1xyXG4gICAgICAgICAgICB3aXRoRGlzYWJsZWRPcmc6ICF0aGlzLm5vdEdldFN0b3BPcmcsXHJcbiAgICAgICAgICAgIHBhcmVudE9yZ0lkOiBwYXJlbnROb2RlLmlkLFxyXG4gICAgICAgICAgICBnZXR0aW5nQ3VycmVudE9yZzogZmFsc2UsXHJcbiAgICAgICAgICAgIG9ubHlEaXNwbGF5T3JnOiB0aGlzLm9ubHlEaXNwbGF5Q29tcGFueVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5hcGlTZXJ2aWNlLmdldE9yZ2FuaXphdGlvbnNXaXRoTGF5ZXIocGFyYW0pLnN1YnNjcmliZSgocmVzOiBhbnkpID0+IHtcclxuICAgICAgICAgICAgaWYgKHJlcyAmJiByZXMub3Jncykge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbmV3RGF0YXMgPSBbXTtcclxuICAgICAgICAgICAgICAgIHJlcy5vcmdzLmZvckVhY2goaXRlbSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYoKCF0aGlzLm9ubHlDdXJyZW50QWRtaW5PcmcgfHwgaXRlbVsndmFsdWVUeXBlJ10gPT0gdGhpcy5kZXB0VHlwZUlkKSAmJiAhaXRlbS5kaXNhYmxlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpdGVtLnNlbGVjdGFibGUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZih0aGlzLmRhdGFQZXJtaXNzaW9uICYmIHRoaXMuZGF0YVBlcm1pc3Npb25JZHMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB0YXJnZXQgPSB0aGlzLmRhdGFQZXJtaXNzaW9uSWRzLmZpbmQodCA9PiB0ID09IGl0ZW1bJ2lkJ10pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoIXRhcmdldCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW0uc2VsZWN0YWJsZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub3JpZ2luYWxUcmVlRGF0YS5wdXNoKGl0ZW0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5lbmFibGVGYXZvcml0ZXMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaXRlbS5pbkZhdm9yaXRlcyA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChDb21tb25VdGlsLmZpbmRJbmRleChpdGVtWydpZCddLCAnaWQnLCB0aGlzLmZhdm9yaXRlc0xpc3QpID09PSAtMSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlbS5pbkZhdm9yaXRlcyA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIG5ld0RhdGFzLnB1c2goaXRlbSk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG5vZGVzID0gdGhpcy5kZWFsRGF0YVdoZW5FeHBhbmRUcmVlTm9kZShuZXdEYXRhcyk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmZhcnJpc1RyZWUuYXBwZW5kQ2hpbGRyZW4obm9kZXMsIHBhcmVudE5vZGUpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5mYXJyaXNUcmVlLmRldGVjdENoYW5nZXMoKTtcclxuICAgICAgICAgICAgICAgIGlmKHRoaXMubXVsdGlTZWxlY3QpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmNoZWNrT3JnVHJlZU5vZGVzKCk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0T3JnVHJlZU5vZGUoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmKHRoaXMubG9hZGluZ1NlcnZpY2UpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmxvYWRpbmdTZXJ2aWNlLmNsb3NlKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvLyDov5Tlm57lt7Lnu4/or6XoioLngrnmmK/lkKblsZXlvIDov4dcclxuICAgIHByaXZhdGUgbm9kZUV4cGFuZGVkKGl0ZW06IGFueSwgYXJyOiBUcmVlTm9kZVtdLCBleHBhbmRlZDogYm9vbGVhbltdKTogdm9pZCB7XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBhcnIubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgaWYgKGl0ZW0uZGF0YS5pZCA9PT0gYXJyW2ldLmRhdGEuaWQpIHtcclxuICAgICAgICAgICAgICAgIGV4cGFuZGVkWzBdID0gYXJyW2ldLmV4cGFuZGVkO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKGFycltpXS5jaGlsZHJlbi5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMubm9kZUV4cGFuZGVkKGl0ZW0sIGFycltpXS5jaGlsZHJlbiwgZXhwYW5kZWQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8vIOWxleW8gOiKgueCuVxyXG4gICAgcHJpdmF0ZSBleHBhbmRUcmVlTm9kZSh0cmVlRGF0YTogYW55LCBwYXRoOiBhbnlbXSwgbGF5ZXI6IG51bWJlcikge1xyXG4gICAgICAgIHRyZWVEYXRhLmZvckVhY2gobm9kZSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChwYXRoLmluY2x1ZGVzKG5vZGUuZGF0YS5wYXRoKSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5mYXJyaXNUcmVlLmV4cGFuZE5vZGUobm9kZS5kYXRhLmlkKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAobm9kZS5kYXRhLmxheWVyIDwgbGF5ZXIgJiYgbm9kZS5jaGlsZHJlbi5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZXhwYW5kVHJlZU5vZGUobm9kZS5jaGlsZHJlbiwgcGF0aCwgbGF5ZXIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG5cclxuICAgIHNlbGVjdE9yZ1RyZWVOb2RlKCkge1xyXG4gICAgICAgIGlmKHRoaXMudHJlZUxpc3REYXRhICYmIHRoaXMuc2VsZWN0aW9ucy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgdGhpcy5kYXRhVG9TZWxlY3RlZCA9IHRoaXMuc2VsZWN0aW9uc1swXTtcclxuICAgICAgICAgICAgLy8gaWYgKCF0aGlzLmZhcnJpc1RyZWUuc2VsZWN0ZWRSb3cpIHtcclxuICAgICAgICAgICAgLy8gICAgIGlmICh0aGlzLm9yZ1RyZWVUaW1lcikge1xyXG4gICAgICAgICAgICAvLyAgICAgICAgIGNsZWFyVGltZW91dCh0aGlzLm9yZ1RyZWVUaW1lcik7XHJcbiAgICAgICAgICAgIC8vICAgICB9XHJcbiAgICAgICAgICAgIC8vICAgICB0aGlzLm9yZ1RyZWVUaW1lciA9IFxyXG4gICAgICAgICAgICAvLyB9IGVsc2Uge1xyXG4gICAgICAgICAgICAvLyAgICAgdGhpcy5mYXJyaXNUcmVlLnNjcm9sbFRvQ3VycmVudE5vZGUoKTtcclxuICAgICAgICAgICAgLy8gfVxyXG4gICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICAgICAgICAgIHRoaXMuaW5UcmVlTGlzdCh0aGlzLnRyZWVMaXN0RGF0YSwgdGhpcy5kYXRhVG9TZWxlY3RlZCk7XHJcbiAgICAgICAgICAgICAgICBpZih0aGlzLmRhdGFUb1NlbGVjdGVkLmluVHJlZUxpc3QpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmZhcnJpc1RyZWUuc2VsZWN0Tm9kZSh0aGlzLmRhdGFUb1NlbGVjdGVkWydpZCddKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmRhdGFUb1NlbGVjdGVkID0gbnVsbDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSwgMzAwKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgXHJcbiAgICBjaGVja09yZ1RyZWVOb2RlcygpIHtcclxuICAgICAgICBpZih0aGlzLnRyZWVMaXN0RGF0YSAmJiB0aGlzLnNlbGVjdGlvbnMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZGF0YVRvQ2hlY2tlZCA9IHRoaXMuc2VsZWN0aW9ucztcclxuICAgICAgICAgICAgY29uc3QgY2hlY2tlZE5vZGVzID0gW107XHJcbiAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5kYXRhVG9DaGVja2VkLmZvckVhY2goaXRlbSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5pblRyZWVMaXN0KHRoaXMudHJlZUxpc3REYXRhLCBpdGVtKTtcclxuICAgICAgICAgICAgICAgICAgICBpZihpdGVtLmluVHJlZUxpc3QpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2hlY2tlZE5vZGVzLnB1c2goaXRlbVsnaWQnXSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5kYXRhVG9DaGVja2VkID0gdGhpcy5kYXRhVG9DaGVja2VkLmZpbHRlcihpdGVtID0+ICFjaGVja2VkTm9kZXMuaW5jbHVkZXMoaXRlbVsnaWQnXSkpO1xyXG4gICAgICAgICAgICAgICAgaWYoY2hlY2tlZE5vZGVzLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZmFycmlzVHJlZS5jaGVja2VkTm9kZXMoY2hlY2tlZE5vZGVzLCB0cnVlLCB0cnVlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSwgMzAwKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuIl19