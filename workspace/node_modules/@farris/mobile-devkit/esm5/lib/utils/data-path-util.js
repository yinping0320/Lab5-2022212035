import { BindingPropertyType, PropertyUtil } from '../binding-data/index';
/**
 * 路径处理工具类（处理/PathNode1/PathNode2/...格式的路径）
 */
var DataPathUtil = /** @class */ (function () {
    function DataPathUtil() {
    }
    /**
     * 转换成BindingData可识别的路径
     */
    DataPathUtil.convertToBindingPathArray = function (path) {
        var bindingPathArray = path.split('/').filter(function (part) {
            return part !== '';
        });
        return bindingPathArray;
    };
    /**
     * 转换为Entity可识别的路径
     * 根：[]
     * 主表：['id:xxx', 'name'],
     * 关联：['id:xxx', 'deptInfo', 'id:xxx', 'name']
     * UDT: ['id:xxx', 'updateInfo', ':', 'createdOn']
     * 从表：['id:xxx', 'edus', 'id:xxx', 'name'],
     * 从从表：['id:xxx', 'edus', 'id:xxx', 'grades', 'id:xxx', 'name']
     */
    DataPathUtil.convertToEntityPathArray = function (path, bindingData) {
        var _this = this;
        var bindingPathArray = this.convertToBindingPathArray(path);
        var entityPathArray = [];
        if (bindingPathArray.length === 0) {
            return entityPathArray;
        }
        // 根节点
        var currentBindingObject = bindingData.list.currentItem;
        entityPathArray.push(this.createPrimaryKeyPath(currentBindingObject.primaryKey, currentBindingObject.primaryKeyValue));
        bindingPathArray.forEach(function (propName) {
            var propInfo = PropertyUtil.getPropertyByName(currentBindingObject.properties, propName);
            switch (propInfo.type) {
                case BindingPropertyType.Plain:
                    entityPathArray.push(propName);
                    break;
                case BindingPropertyType.Object:
                    currentBindingObject = currentBindingObject[propName];
                    entityPathArray.push(propName);
                    entityPathArray.push(_this.createPrimaryKeyPath(currentBindingObject.primaryKey, currentBindingObject.primaryKeyValue));
                    break;
                case BindingPropertyType.List:
                    var currentBindingList = currentBindingObject[propName];
                    currentBindingObject = currentBindingList.currentItem;
                    entityPathArray.push(propName);
                    entityPathArray.push(_this.createPrimaryKeyPath(currentBindingObject.primaryKey, currentBindingObject.primaryKeyValue));
                    break;
                default:
                    break;
            }
        });
        return entityPathArray;
    };
    /**
     * 转换为RestUrl里的路径
     *
     * 返回结果：
     * 主表（/）：/
     * 从表（/jiwtEdus）：/xxx/jiwtEdus
     * 从从表（/jiwtEdus/jiwtGrades）： /xxx/jiwtEdus/xxx/jiwtGrades
     */
    DataPathUtil.convertToRestUrl = function (path, bindingData) {
        var bindingPathArray = this.convertToBindingPathArray(path);
        var restPathArray = [];
        var currentBindingObject = bindingData.list.currentItem;
        restPathArray.push(currentBindingObject.primaryKeyValue);
        bindingPathArray.forEach(function (propName) {
            var propInfo = PropertyUtil.getPropertyByName(currentBindingObject.properties, propName);
            if (propInfo.type !== BindingPropertyType.List) {
                throw new Error(propInfo.name + "\u4E0D\u662F\u5B50\u8868\u5BF9\u5E94\u7684\u5C5E\u6027");
            }
            var currentBindingList = currentBindingObject[propName];
            currentBindingObject = currentBindingList.currentItem;
            restPathArray.push(propName);
            restPathArray.push(currentBindingObject.primaryKeyValue);
        });
        // 移除最后一个主键
        restPathArray.pop();
        return '/' + restPathArray.join('/');
    };
    /**
     * 获取叶子节点的Path
     */
    DataPathUtil.getLeafPath = function (path) {
        var pathArray = DataPathUtil.convertToBindingPathArray(path);
        return pathArray.pop();
    };
    /**
     * 获取父路径
     */
    DataPathUtil.getParentPath = function (path) {
        var pathArray = DataPathUtil.convertToBindingPathArray(path);
        pathArray.pop();
        return '/' + pathArray.join('/');
    };
    /**
     * 创建路径中的主键部分
     */
    DataPathUtil.createPrimaryKeyPath = function (primaryKey, primaryKeyValue) {
        return primaryKey + ":" + primaryKeyValue;
    };
    return DataPathUtil;
}());
export { DataPathUtil };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGF0YS1wYXRoLXV0aWwuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZmFycmlzL21vYmlsZS1kZXZraXQvIiwic291cmNlcyI6WyJsaWIvdXRpbHMvZGF0YS1wYXRoLXV0aWwudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFlLG1CQUFtQixFQUFFLFlBQVksRUFBRSxNQUFNLHVCQUF1QixDQUFDO0FBQ3ZGOztHQUVHO0FBQ0g7SUFBQTtJQXNIQSxDQUFDO0lBcEhDOztPQUVHO0lBQ1csc0NBQXlCLEdBQXZDLFVBQXdDLElBQVk7UUFDbEQsSUFBTSxnQkFBZ0IsR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxVQUFDLElBQVk7WUFDM0QsT0FBTyxJQUFJLEtBQUssRUFBRSxDQUFDO1FBQ3JCLENBQUMsQ0FBQyxDQUFDO1FBQ0gsT0FBTyxnQkFBZ0IsQ0FBQztJQUMxQixDQUFDO0lBRUQ7Ozs7Ozs7O09BUUc7SUFDVyxxQ0FBd0IsR0FBdEMsVUFBdUMsSUFBWSxFQUFFLFdBQXdCO1FBQTdFLGlCQXlDQztRQXhDQyxJQUFNLGdCQUFnQixHQUFhLElBQUksQ0FBQyx5QkFBeUIsQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUN4RSxJQUFNLGVBQWUsR0FBYSxFQUFFLENBQUM7UUFFckMsSUFBSSxnQkFBZ0IsQ0FBQyxNQUFNLEtBQUssQ0FBQyxFQUFFO1lBQ2pDLE9BQU8sZUFBZSxDQUFDO1NBQ3hCO1FBRUQsTUFBTTtRQUNOLElBQUksb0JBQW9CLEdBQUcsV0FBVyxDQUFDLElBQUksQ0FBQyxXQUFXLENBQUM7UUFDeEQsZUFBZSxDQUFDLElBQUksQ0FDbEIsSUFBSSxDQUFDLG9CQUFvQixDQUFDLG9CQUFvQixDQUFDLFVBQVUsRUFBRSxvQkFBb0IsQ0FBQyxlQUFlLENBQUMsQ0FDakcsQ0FBQztRQUVGLGdCQUFnQixDQUFDLE9BQU8sQ0FBQyxVQUFDLFFBQWdCO1lBQ3hDLElBQU0sUUFBUSxHQUFHLFlBQVks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QVMsQ0FBQyxHQUFHLEVBQUUsQ0FBQztRQUNoQixPQUFPLEdBQUcsR0FBRyxTQUFTLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDO0lBQ25DLENBQUM7SUFFRDs7T0FFRztJQUNZLGlDQUFvQixHQUFuQyxVQUFvQyxVQUFrQixFQUFFLGVBQXVCO1FBQzdFLE9BQVUsVUFBVSxTQUFJLGVBQWlCLENBQUM7SUFDNUMsQ0FBQztJQUNILG1CQUFDO0FBQUQsQ0FBQyxBQXRIRCxJQXNIQztBQUVELE9BQU8sRUFBRSxZQUFZLEVBQUUsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEJpbmRpbmdEYXRhLCBCaW5kaW5nUHJvcGVydHlUeXBlLCBQcm9wZXJ0eVV0aWwgfSBmcm9tICcuLi9iaW5kaW5nLWRhdGEvaW5kZXgnO1xuLyoqXG4gKiDot6/lvoTlpITnkIblt6XlhbfnsbvvvIjlpITnkIYvUGF0aE5vZGUxL1BhdGhOb2RlMi8uLi7moLzlvI/nmoTot6/lvoTvvIlcbiAqL1xuY2xhc3MgRGF0YVBhdGhVdGlsIHtcblxuICAvKipcbiAgICog6L2s5o2i5oiQQmluZGluZ0RhdGHlj6/or4bliKvnmoTot6/lvoRcbiAgICovXG4gIHB1YmxpYyBzdGF0aWMgY29udmVydFRvQmluZGluZ1BhdGhBcnJheShwYXRoOiBzdHJpbmcpOiBzdHJpbmdbXSB7XG4gICAgY29uc3QgYmluZGluZ1BhdGhBcnJheSA9IHBhdGguc3BsaXQoJy8nKS5maWx0ZXIoKHBhcnQ6IHN0cmluZykgPT4ge1xuICAgICAgcmV0dXJuIHBhcnQgIT09ICcnO1xuICAgIH0pO1xuICAgIHJldHVybiBiaW5kaW5nUGF0aEFycmF5O1xuICB9XG5cbiAgLyoqXG4gICAqIOi9rOaNouS4ukVudGl0eeWPr+ivhuWIq+eahOi3r+W+hFxuICAgKiDmoLnvvJpbXVxuICAgKiDkuLvooajvvJpbJ2lkOnh4eCcsICduYW1lJ10sXG4gICAqIOWFs+iBlO+8mlsnaWQ6eHh4JywgJ2RlcHRJbmZvJywgJ2lkOnh4eCcsICduYW1lJ11cbiAgICogVURUOiBbJ2lkOnh4eCcsICd1cGRhdGVJbmZvJywgJzonLCAnY3JlYXRlZE9uJ11cbiAgICog5LuO6KGo77yaWydpZDp4eHgnLCAnZWR1cycsICdpZDp4eHgnLCAnbmFtZSddLFxuICAgKiDku47ku47ooajvvJpbJ2lkOnh4eCcsICdlZHVzJywgJ2lkOnh4eCcsICdncmFkZXMnLCAnaWQ6eHh4JywgJ25hbWUnXVxuICAgKi9cbiAgcHVibGljIHN0YXRpYyBjb252ZXJ0VG9FbnRpdHlQYXRoQXJyYXkocGF0aDogc3RyaW5nLCBiaW5kaW5nRGF0YTogQmluZGluZ0RhdGEpOiBzdHJpbmdbXSB7XG4gICAgY29uc3QgYmluZGluZ1BhdGhBcnJheTogc3RyaW5nW10gPSB0aGlzLmNvbnZlcnRUb0JpbmRpbmdQYXRoQXJyYXkocGF0aCk7XG4gICAgY29uc3QgZW50aXR5UGF0aEFycmF5OiBzdHJpbmdbXSA9IFtdO1xuXG4gICAgaWYgKGJpbmRpbmdQYXRoQXJyYXkubGVuZ3RoID09PSAwKSB7XG4gICAgICByZXR1cm4gZW50aXR5UGF0aEFycmF5O1xuICAgIH1cblxuICAgIC8vIOagueiKgueCuVxuICAgIGxldCBjdXJyZW50QmluZGluZ09iamVjdCA9IGJpbmRpbmdEYXRhLmxpc3QuY3VycmVudEl0ZW07XG4gICAgZW50aXR5UGF0aEFycmF5LnB1c2goXG4gICAgICB0aGlzLmNyZWF0ZVByaW1hcnlLZXlQYXRoKGN1cnJlbnRCaW5kaW5nT2JqZWN0LnByaW1hcnlLZXksIGN1cnJlbnRCaW5kaW5nT2JqZWN0LnByaW1hcnlLZXlWYWx1ZSlcbiAgICApO1xuXG4gICAgYmluZGluZ1BhdGhBcnJheS5mb3JFYWNoKChwcm9wTmFtZTogc3RyaW5nKSA9PiB7XG4gICAgICBjb25zdCBwcm9wSW5mbyA9IFByb3BlcnR5VXRpbC5nZXRQcm9wZXJ0eUJ5TmFtZShjdXJyZW50QmluZGluZ09iamVjdC5wcm9wZXJ0aWVzLCBwcm9wTmFtZSk7XG4gICAgICBzd2l0Y2ggKHByb3BJbmZvLnR5cGUpIHtcbiAgICAgICAgY2FzZSBCaW5kaW5nUHJvcGVydHlUeXBlLlBsYWluOlxuICAgICAgICAgIGVudGl0eVBhdGhBcnJheS5wdXNoKHByb3BOYW1lKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSBCaW5kaW5nUHJvcGVydHlUeXBlLk9iamVjdDpcbiAgICAgICAgICBjdXJyZW50QmluZGluZ09iamVjdCA9IGN1cnJlbnRCaW5kaW5nT2JqZWN0W3Byb3BOYW1lXTtcbiAgICAgICAgICBlbnRpdHlQYXRoQXJyYXkucHVzaChwcm9wTmFtZSk7XG4gICAgICAgICAgZW50aXR5UGF0aEFycmF5LnB1c2goXG4gICAgICAgICAgICB0aGlzLmNyZWF0ZVByaW1hcnlLZXlQYXRoKGN1cnJlbnRCaW5kaW5nT2JqZWN0LnByaW1hcnlLZXksIGN1cnJlbnRCaW5kaW5nT2JqZWN0LnByaW1hcnlLZXlWYWx1ZSlcbiAgICAgICAgICApO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIEJpbmRpbmdQcm9wZXJ0eVR5cGUuTGlzdDpcbiAgICAgICAgICBjb25zdCBjdXJyZW50QmluZGluZ0xpc3QgPSBjdXJyZW50QmluZGluZ09iamVjdFtwcm9wTmFtZV07XG4gICAgICAgICAgY3VycmVudEJpbmRpbmdPYmplY3QgPSBjdXJyZW50QmluZGluZ0xpc3QuY3VycmVudEl0ZW07XG4gICAgICAgICAgZW50aXR5UGF0aEFycmF5LnB1c2gocHJvcE5hbWUpO1xuICAgICAgICAgIGVudGl0eVBhdGhBcnJheS5wdXNoKFxuICAgICAgICAgICAgdGhpcy5jcmVhdGVQcmltYXJ5S2V5UGF0aChjdXJyZW50QmluZGluZ09iamVjdC5wcmltYXJ5S2V5LCBjdXJyZW50QmluZGluZ09iamVjdC5wcmltYXJ5S2V5VmFsdWUpXG4gICAgICAgICAgKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgcmV0dXJuIGVudGl0eVBhdGhBcnJheTtcbiAgfVxuXG4gIC8qKlxuICAgKiDovazmjaLkuLpSZXN0VXJs6YeM55qE6Lev5b6EXG4gICAqXG4gICAqIOi/lOWbnue7k+aenO+8mlxuICAgKiDkuLvooajvvIgv77yJ77yaL1xuICAgKiDku47ooajvvIgvaml3dEVkdXPvvInvvJoveHh4L2ppd3RFZHVzXG4gICAqIOS7juS7juihqO+8iC9qaXd0RWR1cy9qaXd0R3JhZGVz77yJ77yaIC94eHgvaml3dEVkdXMveHh4L2ppd3RHcmFkZXNcbiAgICovXG4gIHB1YmxpYyBzdGF0aWMgY29udmVydFRvUmVzdFVybChwYXRoOiBzdHJpbmcsIGJpbmRpbmdEYXRhOiBCaW5kaW5nRGF0YSk6IHN0cmluZyB7XG4gICAgY29uc3QgYmluZGluZ1BhdGhBcnJheTogc3RyaW5nW10gPSB0aGlzLmNvbnZlcnRUb0JpbmRpbmdQYXRoQXJyYXkocGF0aCk7XG4gICAgY29uc3QgcmVzdFBhdGhBcnJheTogc3RyaW5nW10gPSBbXTtcblxuICAgIGxldCBjdXJyZW50QmluZGluZ09iamVjdCA9IGJpbmRpbmdEYXRhLmxpc3QuY3VycmVudEl0ZW07XG4gICAgcmVzdFBhdGhBcnJheS5wdXNoKGN1cnJlbnRCaW5kaW5nT2JqZWN0LnByaW1hcnlLZXlWYWx1ZSk7XG5cbiAgICBiaW5kaW5nUGF0aEFycmF5LmZvckVhY2goKHByb3BOYW1lOiBzdHJpbmcpID0+IHtcbiAgICAgIGNvbnN0IHByb3BJbmZvID0gUHJvcGVydHlVdGlsLmdldFByb3BlcnR5QnlOYW1lKGN1cnJlbnRCaW5kaW5nT2JqZWN0LnByb3BlcnRpZXMsIHByb3BOYW1lKTtcbiAgICAgIGlmIChwcm9wSW5mby50eXBlICE9PSBCaW5kaW5nUHJvcGVydHlUeXBlLkxpc3QpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGAke3Byb3BJbmZvLm5hbWV95LiN5piv5a2Q6KGo5a+55bqU55qE5bGe5oCnYCk7XG4gICAgICB9XG4gICAgICBjb25zdCBjdXJyZW50QmluZGluZ0xpc3QgPSBjdXJyZW50QmluZGluZ09iamVjdFtwcm9wTmFtZV07XG4gICAgICBjdXJyZW50QmluZGluZ09iamVjdCA9IGN1cnJlbnRCaW5kaW5nTGlzdC5jdXJyZW50SXRlbTtcbiAgICAgIHJlc3RQYXRoQXJyYXkucHVzaChwcm9wTmFtZSk7XG4gICAgICByZXN0UGF0aEFycmF5LnB1c2goY3VycmVudEJpbmRpbmdPYmplY3QucHJpbWFyeUtleVZhbHVlKTtcbiAgICB9KTtcblxuICAgIC8vIOenu+mZpOacgOWQjuS4gOS4quS4u+mUrlxuICAgIHJlc3RQYXRoQXJyYXkucG9wKCk7XG4gICAgcmV0dXJuICcvJyArIHJlc3RQYXRoQXJyYXkuam9pbignLycpO1xuICB9XG5cbiAgLyoqXG4gICAqIOiOt+WPluWPtuWtkOiKgueCueeahFBhdGhcbiAgICovXG4gIHB1YmxpYyBzdGF0aWMgZ2V0TGVhZlBhdGgocGF0aDogc3RyaW5nKTogc3RyaW5nIHtcbiAgICBjb25zdCBwYXRoQXJyYXkgPSBEYXRhUGF0aFV0aWwuY29udmVydFRvQmluZGluZ1BhdGhBcnJheShwYXRoKTtcbiAgICByZXR1cm4gcGF0aEFycmF5LnBvcCgpO1xuICB9XG5cbiAgLyoqXG4gICAqIOiOt+WPlueItui3r+W+hFxuICAgKi9cbiAgcHVibGljIHN0YXRpYyBnZXRQYXJlbnRQYXRoKHBhdGg6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgY29uc3QgcGF0aEFycmF5ID0gRGF0YVBhdGhVdGlsLmNvbnZlcnRUb0JpbmRpbmdQYXRoQXJyYXkocGF0aCk7XG4gICAgcGF0aEFycmF5LnBvcCgpO1xuICAgIHJldHVybiAnLycgKyBwYXRoQXJyYXkuam9pbignLycpO1xuICB9XG5cbiAgLyoqXG4gICAqIOWIm+W7uui3r+W+hOS4reeahOS4u+mUrumDqOWIhlxuICAgKi9cbiAgcHJpdmF0ZSBzdGF0aWMgY3JlYXRlUHJpbWFyeUtleVBhdGgocHJpbWFyeUtleTogc3RyaW5nLCBwcmltYXJ5S2V5VmFsdWU6IHN0cmluZykge1xuICAgIHJldHVybiBgJHtwcmltYXJ5S2V5fToke3ByaW1hcnlLZXlWYWx1ZX1gO1xuICB9XG59XG5cbmV4cG9ydCB7IERhdGFQYXRoVXRpbCB9O1xuIl19