import * as tslib_1 from "tslib";
import { format, isDate, parseISO, isEqual, compareAsc } from 'date-fns';
import dayjs from 'dayjs';
import IsBetween from 'dayjs/plugin/IsBetween';
import relativeTime from 'dayjs/plugin/relativeTime';
import Calendar from 'dayjs/plugin/calendar';
import 'dayjs/locale/zh-cn';
dayjs.locale('zh-cn');
/**
 * 日期处理类
 */
var DateUtil = /** @class */ (function () {
    function DateUtil() {
    }
    /**
     * 将日期（或日期字符串）转换为完整的的ISO格式的字符串
     */
    DateUtil.formatISO = function (dateOrDateString) {
        if (this.isEmptyDateOrDateString(dateOrDateString) === true) {
            return this.emptyISODateTimeString;
        }
        var dateObj = this.parse(dateOrDateString);
        return format(dateObj, this.defaultISOFormat);
    };
    /**
     * 将日期（或日期字符串）转换为指定格式的字符串
     * @param dateOrDateString 日期对象或符合ISO8601规范的日期字符串
     * @param dateFormat 日期格式字符串
     */
    DateUtil.format = function (dateOrDateString, dateFormat) {
        if (this.isEmptyDateOrDateString(dateOrDateString) === true) {
            return this.emptyISODateTimeString;
        }
        var dateObj = this.parse(dateOrDateString);
        dateFormat = dateFormat ? dateFormat : this.defaultDisplayFormat;
        return format(dateObj, dateFormat);
    };
    DateUtil.dateShow = function (dateOrDateString, type) {
        if (this.isEmptyDateOrDateString(dateOrDateString) === true) {
            return this.emptyISODateTimeString;
        }
        if (!type || "" === type) {
            return;
        }
        return this[type] && this[type](dateOrDateString);
    };
    DateUtil.dateOperation = function (dateOrDateString, options) {
        if (this.isEmptyDateOrDateString(dateOrDateString) === true) {
            return this.emptyISODateTimeString;
        }
        var _a = options.type, type = _a === void 0 ? "" : _a, option = options.option;
        if (!type || "" === type) {
            return;
        }
        if ('isSame' === type) {
            return this[type] && this[type](dateOrDateString, options['targetDate'], options['granularity']);
        }
        if ('isBefore' === type) {
            return this[type] && this[type](dateOrDateString, options['targetDate'], options['granularity']);
        }
        if ('isAfter' === type) {
            return this[type] && this[type](dateOrDateString, options['targetDate'], options['granularity']);
        }
        if ('isBetween' === type) {
            return this[type] && this[type](dateOrDateString, options['targetDate'], options['targetDate2'], options['granularity'], options['contains']);
        }
        if (!option) {
            return this[type] && this[type](dateOrDateString);
        }
        return this[type] && this[type](dateOrDateString, option);
    };
    DateUtil.relativeTime = function (dateOrDateString, option) {
        dayjs.extend(relativeTime);
        var dateObj = dayjs(dateOrDateString);
        if (!option) {
            return dayjs(dateObj).fromNow();
        }
        return dayjs(dateObj).fromNow(option);
    };
    DateUtil.isToday = function (dateOrDateString) {
        var todayDate = new Date();
        var dateObj = dayjs(dateOrDateString);
        return this.isSame(dateObj, todayDate, 'date');
    };
    DateUtil.calendar = function (dateOrDateString, option) {
        var dateObj = dayjs(dateOrDateString);
        dayjs.extend(Calendar);
        if (option) {
            return dayjs().calendar(dateObj, tslib_1.__assign({}, option));
        }
        return dayjs().calendar(dateObj, {
            sameDay: '[今天] HH:mm',
            nextDay: '[明天] HH:mm',
            lastDay: '[昨天] HH:mm',
            sameElse: 'YYYY-MM-DD'
        });
    };
    /**
     * 创建日期
     * @param dateOrDateString 日期对象或符合ISO8601规范的日期字符串
     */
    DateUtil.parse = function (dateOrDateString) {
        if (this.isEmptyDateOrDateString(dateOrDateString) === true) {
            return null;
        }
        if (this.isDate(dateOrDateString) === true) {
            return dateOrDateString;
        }
        return parseISO(dateOrDateString);
    };
    /**
     * 是否是日期对象
     */
    DateUtil.isDate = function (date) {
        return isDate(date);
    };
    /**
     * 是否是空日期或者空日期字符串
     * @param dateOrDateString 日期或日期字符串
     */
    DateUtil.isEmptyDateOrDateString = function (dateOrDateString) {
        if (this.isDate(dateOrDateString) === true) {
            return this.isEmptyDate(dateOrDateString);
        }
        return this.isEmptyDateString(dateOrDateString);
    };
    /**
     * 是否为空日期字符串
     * @param date 日期对象
     */
    DateUtil.isEmptyDate = function (date) {
        if (!date) {
            return true;
        }
        return false;
    };
    /**
     * 是否是空日期字符串
     * @param dateString 日期字符串
     */
    DateUtil.isEmptyDateString = function (dateString) {
        if (!dateString || dateString.startsWith('0001-01-01') === true) {
            return true;
        }
        return false;
    };
    /**
     * 两个日期是否相等
     * @param dateOrDateString1 日期对象或字符串
     * @param dateOrDateString1 日期对象或字符串
     * @return 相等返回true，否则返回false
     */
    DateUtil.isEqual = function (dateOrDateString1, dateOrDateString2) {
        var dateObj1 = this.parse(dateOrDateString1);
        var dateObj2 = this.parse(dateOrDateString2);
        if (dateObj1 === dateObj2) {
            return true;
        }
        return isEqual(dateObj1, dateObj2);
    };
    /**
     * 两个日期是否相等
     * @param dateOrDateString1 日期对象或字符串
     * @param dateOrDateString1 日期对象或字符串
     * @return 返回-1、0、1
     */
    DateUtil.compare = function (dateOrDateString1, dateOrDateString2) {
        var dateObj1 = this.parse(dateOrDateString1);
        var dateObj2 = this.parse(dateOrDateString2);
        if (this.isEqual(dateObj1, dateObj2) === true) {
            return 0;
        }
        // 处理解析后为null的场景，null比所有有效日期小
        if (!dateObj1 && this.isDate(dateObj2) === true) {
            return -1;
        }
        if (!dateObj2 && this.isDate(dateObj1) === true) {
            return 1;
        }
        return compareAsc(dateObj1, dateObj2);
    };
    /**
     *
     * @param currentDate 当前日期
     * @param targetDate 目标日期
     * @param type 比较类型 date	D	天00:00 day	d	星期00:00 month	M	月第一天00:00 year	y	1月1日00点 week	w	周第一天00:00hour	h	00:00:00minute	m	00:00second	s	00millisecond	ms	0
     * @returns
     */
    DateUtil.isSame = function (currentDate, targetDate, type) {
        if (type) {
            return dayjs(currentDate).isSame(dayjs(targetDate), type);
        }
        return dayjs(currentDate).isSame(dayjs(targetDate));
    };
    /**
     *
     * @param currentDate 当前日期
     * @param targetDate 目标日期
     * @returns boolean
     */
    DateUtil.isBefore = function (currentDate, targetDate, type) {
        if (type) {
            return dayjs(currentDate).isBefore(dayjs(targetDate), type);
        }
        return dayjs(currentDate).isBefore(dayjs(targetDate));
    };
    /**
   *
   * @param currentDate 当前日期
   * @param targetDate 目标日期
   * @returns boolean
   */
    DateUtil.isAfter = function (currentDate, targetDate, type) {
        if (type) {
            return dayjs(currentDate).isAfter(dayjs(targetDate), type);
        }
        return dayjs(currentDate).isAfter(dayjs(targetDate));
    };
    /**
     *
     * @param currentDate
     * @param targetDate1
     * @param targetDate2
     * @returns
     */
    DateUtil.isBetween = function (currentDate, targetDate1, targetDate2, type, contains) {
        dayjs.extend(IsBetween);
        if (type) {
            return dayjs(currentDate).isBetween(dayjs(targetDate1), dayjs(targetDate2), type, contains);
        }
        return dayjs(currentDate).isBetween(dayjs(targetDate1), dayjs(targetDate2), null, contains);
    };
    /**
     * 空日期字符串（N版）
     * @todo：兼容服务器端，不应该在devkit体现这种兼容，待移除
     */
    // static emptyDateTimeString = '0001-01-01T00:00:00';
    DateUtil.emptyDateTimeString = null;
    /**
     * 默认空日期字符串（ISO标准格式）
     */
    // static emptyISODateTimeString = '0001-01-01T00:00:00+00:00';
    DateUtil.emptyISODateTimeString = null;
    /**
     * 默认日期听格式
     */
    DateUtil.defaultISOFormat = "yyyy-MM-dd'T'HH:mm:ssxxx";
    DateUtil.defaultDisplayFormat = 'yyyy-MM-dd HH:mm:ss';
    DateUtil.defaultDateFormat = 'yyyy-MM-dd';
    DateUtil.defaultTimeFormat = 'HH:mm:ss';
    return DateUtil;
}());
export { DateUtil };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGF0ZV91dGlsLmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGZhcnJpcy9tb2JpbGUtZGV2a2l0LyIsInNvdXJjZXMiOlsibGliL3V0aWxzL2RhdGVfdXRpbC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUEsT0FBTyxFQUFFLE1BQU0sRUFBRSxNQUFNLEVBQUUsUUFBUSxFQUFFLE9BQU8sRUFBRSxVQUFVLEVBQUUsTUFBTSxVQUFVLENBQUM7QUFDekUsT0FBTyxLQUFLLE1BQU0sT0FBTyxDQUFDO0FBQzFCLE9BQU8sU0FBUyxNQUFNLHdCQUF3QixDQUFDO0FBQy9DLE9BQU8sWUFBWSxNQUFNLDJCQUEyQixDQUFDO0FBQ3JELE9BQU8sUUFBUSxNQUFNLHVCQUF1QixDQUFDO0FBQzdDLE9BQU8sb0JBQW9CLENBQUM7QUFDNUIsS0FBSyxDQUFDLE1BQU0sQ0FBQyxPQUFPLENBQUMsQ0FBQztBQUN0Qjs7R0FFRztBQUNIO0lBQUE7SUE4UUEsQ0FBQztJQXBQQzs7T0FFRztJQUNJLGtCQUFTLEdBQWhCLFVBQWlCLGdCQUErQjtRQUM5QyxJQUFJLElBQUksQ0FBQyx1QkFBdUIsQ0FBQyxnQkFBZ0IsQ0FBQyxLQUFLLElBQUksRUFBRTtZQUMzRCxPQUFPLElBQUksQ0FBQyxzQkFBc0IsQ0FBQztTQUNwQztRQUNELElBQU0sT0FBTyxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsZ0JBQWdCLENBQUMsQ0FBQztRQUM3QyxPQUFPLE1BQU0sQ0FBQyxPQUFPLEVBQUUsSUFBSSxDQUFDLGdCQUFnQixDQUFDLENBQUM7SUFDaEQsQ0FBQztJQUVEOzs7O09BSUc7SUFDSSxlQUFNLEdBQWIsVUFBYyxnQkFBK0IsRUFBRSxVQUFtQjtRQUNoRSxJQUFJLElBQUksQ0FBQyx1QkFBdUIsQ0FBQyxnQkFBZ0IsQ0FBQyxLQUFLLElBQUksRUFBRTtZQUMzRCxPQUFPLElBQUksQ0FBQyxzQkFBc0IsQ0FBQztTQUNwQztRQUNELElBQU0sT0FBTyxHQUFHLElBQUksQ0FBQyxLQUFLLENB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SSx5QkFBZ0IsR0FBRywwQkFBMEIsQ0FBQztJQUU5Qyw2QkFBb0IsR0FBRyxxQkFBcUIsQ0FBQztJQUU3QywwQkFBaUIsR0FBRyxZQUFZLENBQUM7SUFFakMsMEJBQWlCLEdBQUcsVUFBVSxDQUFDO0lBc1B4QyxlQUFDO0NBQUEsQUE5UUQsSUE4UUM7QUFFRCxPQUFPLEVBQUUsUUFBUSxFQUFFLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBmb3JtYXQsIGlzRGF0ZSwgcGFyc2VJU08sIGlzRXF1YWwsIGNvbXBhcmVBc2MgfSBmcm9tICdkYXRlLWZucyc7XG5pbXBvcnQgZGF5anMgZnJvbSAnZGF5anMnO1xuaW1wb3J0IElzQmV0d2VlbiBmcm9tICdkYXlqcy9wbHVnaW4vSXNCZXR3ZWVuJztcbmltcG9ydCByZWxhdGl2ZVRpbWUgZnJvbSAnZGF5anMvcGx1Z2luL3JlbGF0aXZlVGltZSc7XG5pbXBvcnQgQ2FsZW5kYXIgZnJvbSAnZGF5anMvcGx1Z2luL2NhbGVuZGFyJztcbmltcG9ydCAnZGF5anMvbG9jYWxlL3poLWNuJztcbmRheWpzLmxvY2FsZSgnemgtY24nKTtcbi8qKlxuICog5pel5pyf5aSE55CG57G7XG4gKi9cbmNsYXNzIERhdGVVdGlsIHtcblxuICAvKipcbiAgICog56m65pel5pyf5a2X56ym5Liy77yITueJiO+8iVxuICAgKiBAdG9kb++8muWFvOWuueacjeWKoeWZqOerr++8jOS4jeW6lOivpeWcqGRldmtpdOS9k+eOsOi/meenjeWFvOWuue+8jOW+heenu+mZpFxuICAgKi9cbiAgLy8gc3RhdGljIGVtcHR5RGF0ZVRpbWVTdHJpbmcgPSAnMDAwMS0wMS0wMVQwMDowMDowMCc7XG4gIHN0YXRpYyBlbXB0eURhdGVUaW1lU3RyaW5nID0gbnVsbDtcblxuICAvKipcbiAgICog6buY6K6k56m65pel5pyf5a2X56ym5Liy77yISVNP5qCH5YeG5qC85byP77yJXG4gICAqL1xuICAvLyBzdGF0aWMgZW1wdHlJU09EYXRlVGltZVN0cmluZyA9ICcwMDAxLTAxLTAxVDAwOjAwOjAwKzAwOjAwJztcbiAgc3RhdGljIGVtcHR5SVNPRGF0ZVRpbWVTdHJpbmcgPSBudWxsO1xuXG4gIC8qKlxuICAgKiDpu5jorqTml6XmnJ/lkKzmoLzlvI9cbiAgICovXG4gIHN0YXRpYyBkZWZhdWx0SVNPRm9ybWF0ID0gYHl5eXktTU0tZGQnVCdISDptbTpzc3h4eGA7XG5cbiAgc3RhdGljIGRlZmF1bHREaXNwbGF5Rm9ybWF0ID0gJ3l5eXktTU0tZGQgSEg6bW06c3MnO1xuXG4gIHN0YXRpYyBkZWZhdWx0RGF0ZUZvcm1hdCA9ICd5eXl5LU1NLWRkJztcblxuICBzdGF0aWMgZGVmYXVsdFRpbWVGb3JtYXQgPSAnSEg6bW06c3MnO1xuXG4gIC8qKlxuICAgKiDlsIbml6XmnJ/vvIjmiJbml6XmnJ/lrZfnrKbkuLLvvInovazmjaLkuLrlrozmlbTnmoTnmoRJU0/moLzlvI/nmoTlrZfnrKbkuLJcbiAgICovXG4gIHN0YXRpYyBmb3JtYXRJU08oZGF0ZU9yRGF0ZVN0cmluZzogc3RyaW5nIHwgRGF0ZSk6IHN0cmluZyB7XG4gICAgaWYgKHRoaXMuaXNFbXB0eURhdGVPckRhdGVTdHJpbmcoZGF0ZU9yRGF0ZVN0cmluZykgPT09IHRydWUpIHtcbiAgICAgIHJldHVybiB0aGlzLmVtcHR5SVNPRGF0ZVRpbWVTdHJpbmc7XG4gICAgfVxuICAgIGNvbnN0IGRhdGVPYmogPSB0aGlzLnBhcnNlKGRhdGVPckRhdGVTdHJpbmcpO1xuICAgIHJldHVybiBmb3JtYXQoZGF0ZU9iaiwgdGhpcy5kZWZhdWx0SVNPRm9ybWF0KTtcbiAgfVxuXG4gIC8qKlxuICAgKiDlsIbml6XmnJ/vvIjmiJbml6XmnJ/lrZfnrKbkuLLvvInovazmjaLkuLrmjIflrprmoLzlvI/nmoTlrZfnrKbkuLJcbiAgICogQHBhcmFtIGRhdGVPckRhdGVTdHJpbmcg5pel5pyf5a+56LGh5oiW56ym5ZCISVNPODYwMeinhOiMg+eahOaXpeacn+Wtl+espuS4slxuICAgKiBAcGFyYW0gZGF0ZUZvcm1hdCDml6XmnJ/moLzlvI/lrZfnrKbkuLJcbiAgICovXG4gIHN0YXRpYyBmb3JtYXQoZGF0ZU9yRGF0ZVN0cmluZzogc3RyaW5nIHwgRGF0ZSwgZGF0ZUZvcm1hdD86IHN0cmluZyk6IHN0cmluZyB7XG4gICAgaWYgKHRoaXMuaXNFbXB0eURhdGVPckRhdGVTdHJpbmcoZGF0ZU9yRGF0ZVN0cmluZykgPT09IHRydWUpIHtcbiAgICAgIHJldHVybiB0aGlzLmVtcHR5SVNPRGF0ZVRpbWVTdHJpbmc7XG4gICAgfVxuICAgIGNvbnN0IGRhdGVPYmogPSB0aGlzLnBhcnNlKGRhdGVPckRhdGVTdHJpbmcpO1xuICAgIGRhdGVGb3JtYXQgPSBkYXRlRm9ybWF0ID8gZGF0ZUZvcm1hdCA6IHRoaXMuZGVmYXVsdERpc3BsYXlGb3JtYXQ7XG4gICAgcmV0dXJuIGZvcm1hdChkYXRlT2JqLCBkYXRlRm9ybWF0KTtcbiAgfVxuXG4gIHN0YXRpYyBkYXRlU2hvdyhkYXRlT3JEYXRlU3RyaW5nOiBzdHJpbmcgfCBEYXRlLCB0eXBlOiBzdHJpbmcpIHtcbiAgICBpZiAodGhpcy5pc0VtcHR5RGF0ZU9yRGF0ZVN0cmluZyhkYXRlT3JEYXRlU3RyaW5nKSA9PT0gdHJ1ZSkge1xuICAgICAgcmV0dXJuIHRoaXMuZW1wdHlJU09EYXRlVGltZVN0cmluZztcbiAgICB9XG4gICAgaWYgKCF0eXBlIHx8IFwiXCIgPT09IHR5cGUpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgcmV0dXJuIHRoaXNbdHlwZV0gJiYgdGhpc1t0eXBlXShkYXRlT3JEYXRlU3RyaW5nKVxuICB9XG5cbiAgc3RhdGljIGRhdGVPcGVyYXRpb24oZGF0ZU9yRGF0ZVN0cmluZzogc3RyaW5nIHwgRGF0ZSwgb3B0aW9ucykge1xuICAgIGlmICh0aGlzLmlzRW1wdHlEYXRlT3JEYXRlU3RyaW5nKGRhdGVPckRhdGVTdHJpbmcpID09PSB0cnVlKSB7XG4gICAgICByZXR1cm4gdGhpcy5lbXB0eUlTT0RhdGVUaW1lU3RyaW5nO1xuICAgIH1cbiAgICBjb25zdCB7IHR5cGUgPSBcIlwiLCBvcHRpb24gfSA9IG9wdGlvbnM7XG4gICAgaWYgKCF0eXBlIHx8IFwiXCIgPT09IHR5cGUpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKCdpc1NhbWUnID09PSB0eXBlKSB7XG4gICAgICByZXR1cm4gdGhpc1t0eXBlXSAmJiB0aGlzW3R5cGVdKGRhdGVPckRhdGVTdHJpbmcsIG9wdGlvbnNbJ3RhcmdldERhdGUnXSwgb3B0aW9uc1snZ3JhbnVsYXJpdHknXSlcbiAgICB9XG4gICAgaWYgKCdpc0JlZm9yZScgPT09IHR5cGUpIHtcbiAgICAgIHJldHVybiB0aGlzW3R5cGVdICYmIHRoaXNbdHlwZV0oZGF0ZU9yRGF0ZVN0cmluZywgb3B0aW9uc1sndGFyZ2V0RGF0ZSddLCBvcHRpb25zWydncmFudWxhcml0eSddKVxuICAgIH1cbiAgICBpZiAoJ2lzQWZ0ZXInID09PSB0eXBlKSB7XG4gICAgICByZXR1cm4gdGhpc1t0eXBlXSAmJiB0aGlzW3R5cGVdKGRhdGVPckRhdGVTdHJpbmcsIG9wdGlvbnNbJ3RhcmdldERhdGUnXSwgb3B0aW9uc1snZ3JhbnVsYXJpdHknXSlcbiAgICB9XG4gICAgaWYgKCdpc0JldHdlZW4nID09PSB0eXBlICkge1xuICAgICAgcmV0dXJuIHRoaXNbdHlwZV0gJiYgdGhpc1t0eXBlXShkYXRlT3JEYXRlU3RyaW5nLCBvcHRpb25zWyd0YXJnZXREYXRlJ10sIG9wdGlvbnNbJ3RhcmdldERhdGUyJ10sIG9wdGlvbnNbJ2dyYW51bGFyaXR5J10sIG9wdGlvbnNbJ2NvbnRhaW5zJ10pXG4gICAgfVxuICAgIGlmICghb3B0aW9uKSB7XG4gICAgICByZXR1cm4gdGhpc1t0eXBlXSAmJiB0aGlzW3R5cGVdKGRhdGVPckRhdGVTdHJpbmcpXG4gICAgfVxuICAgIHJldHVybiB0aGlzW3R5cGVdICYmIHRoaXNbdHlwZV0oZGF0ZU9yRGF0ZVN0cmluZywgb3B0aW9uKVxuICB9XG5cblxuXG4gIHN0YXRpYyByZWxhdGl2ZVRpbWUoZGF0ZU9yRGF0ZVN0cmluZzogc3RyaW5nIHwgRGF0ZSwgb3B0aW9uKSB7XG4gICAgZGF5anMuZXh0ZW5kKHJlbGF0aXZlVGltZSlcbiAgICBjb25zdCBkYXRlT2JqID0gZGF5anMoZGF0ZU9yRGF0ZVN0cmluZyk7XG4gICAgaWYgKCFvcHRpb24pIHtcbiAgICAgIHJldHVybiBkYXlqcyhkYXRlT2JqKS5mcm9tTm93KClcbiAgICB9XG4gICAgcmV0dXJuIGRheWpzKGRhdGVPYmopLmZyb21Ob3cob3B0aW9uKVxuICB9XG5cbiAgc3RhdGljIGlzVG9kYXkoZGF0ZU9yRGF0ZVN0cmluZzogc3RyaW5nIHwgRGF0ZSkge1xuICAgIGNvbnN0IHRvZGF5RGF0ZSA9IG5ldyBEYXRlKCk7XG4gICAgY29uc3QgZGF0ZU9iaiA9IGRheWpzKGRhdGVPckRhdGVTdHJpbmcpO1xuICAgIHJldHVybiB0aGlzLmlzU2FtZShkYXRlT2JqLCB0b2RheURhdGUsICdkYXRlJyk7XG4gIH1cblxuICBzdGF0aWMgY2FsZW5kYXIoZGF0ZU9yRGF0ZVN0cmluZzogc3RyaW5nIHwgRGF0ZSwgb3B0aW9uKSB7XG4gICAgY29uc3QgZGF0ZU9iaiA9IGRheWpzKGRhdGVPckRhdGVTdHJpbmcpO1xuICAgIGRheWpzLmV4dGVuZChDYWxlbmRhcilcbiAgICBpZiAob3B0aW9uKSB7XG4gICAgICByZXR1cm4gZGF5anMoKS5jYWxlbmRhcihkYXRlT2JqLCB7IC4uLm9wdGlvbiB9KVxuICAgIH1cbiAgICByZXR1cm4gZGF5anMoKS5jYWxlbmRhcihkYXRlT2JqLCB7XG4gICAgICBzYW1lRGF5OiAnW+S7iuWkqV0gSEg6bW0nLFxuICAgICAgbmV4dERheTogJ1vmmI7lpKldIEhIOm1tJyxcbiAgICAgIGxhc3REYXk6ICdb5pio5aSpXSBISDptbScsXG4gICAgICBzYW1lRWxzZTogJ1lZWVktTU0tREQnXG4gICAgfSlcbiAgfVxuXG5cbiAgLyoqXG4gICAqIOWIm+W7uuaXpeacn1xuICAgKiBAcGFyYW0gZGF0ZU9yRGF0ZVN0cmluZyDml6XmnJ/lr7nosaHmiJbnrKblkIhJU084NjAx6KeE6IyD55qE5pel5pyf5a2X56ym5LiyXG4gICAqL1xuICBzdGF0aWMgcGFyc2UoZGF0ZU9yRGF0ZVN0cmluZzogc3RyaW5nIHwgRGF0ZSk6IERhdGUge1xuICAgIGlmICh0aGlzLmlzRW1wdHlEYXRlT3JEYXRlU3RyaW5nKGRhdGVPckRhdGVTdHJpbmcpID09PSB0cnVlKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5pc0RhdGUoZGF0ZU9yRGF0ZVN0cmluZykgPT09IHRydWUpIHtcbiAgICAgIHJldHVybiBkYXRlT3JEYXRlU3RyaW5nIGFzIERhdGU7XG4gICAgfVxuXG4gICAgcmV0dXJuIHBhcnNlSVNPKGRhdGVPckRhdGVTdHJpbmcgYXMgc3RyaW5nKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDmmK/lkKbmmK/ml6XmnJ/lr7nosaFcbiAgICovXG4gIHN0YXRpYyBpc0RhdGUoZGF0ZTogYW55KTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIGlzRGF0ZShkYXRlKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDmmK/lkKbmmK/nqbrml6XmnJ/miJbogIXnqbrml6XmnJ/lrZfnrKbkuLJcbiAgICogQHBhcmFtIGRhdGVPckRhdGVTdHJpbmcg5pel5pyf5oiW5pel5pyf5a2X56ym5LiyXG4gICAqL1xuICBzdGF0aWMgaXNFbXB0eURhdGVPckRhdGVTdHJpbmcoZGF0ZU9yRGF0ZVN0cmluZzogc3RyaW5nIHwgRGF0ZSkge1xuICAgIGlmICh0aGlzLmlzRGF0ZShkYXRlT3JEYXRlU3RyaW5nKSA9PT0gdHJ1ZSkge1xuICAgICAgcmV0dXJuIHRoaXMuaXNFbXB0eURhdGUoZGF0ZU9yRGF0ZVN0cmluZyBhcyBEYXRlKTtcbiAgICB9XG4gICAgcmV0dXJuIHRoaXMuaXNFbXB0eURhdGVTdHJpbmcoZGF0ZU9yRGF0ZVN0cmluZyBhcyBzdHJpbmcpO1xuICB9XG5cbiAgLyoqXG4gICAqIOaYr+WQpuS4uuepuuaXpeacn+Wtl+espuS4slxuICAgKiBAcGFyYW0gZGF0ZSDml6XmnJ/lr7nosaFcbiAgICovXG4gIHN0YXRpYyBpc0VtcHR5RGF0ZShkYXRlOiBEYXRlKSB7XG4gICAgaWYgKCFkYXRlKSB7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgLyoqXG4gICAqIOaYr+WQpuaYr+epuuaXpeacn+Wtl+espuS4slxuICAgKiBAcGFyYW0gZGF0ZVN0cmluZyDml6XmnJ/lrZfnrKbkuLJcbiAgICovXG4gIHN0YXRpYyBpc0VtcHR5RGF0ZVN0cmluZyhkYXRlU3RyaW5nOiBzdHJpbmcpIHtcbiAgICBpZiAoIWRhdGVTdHJpbmcgfHwgZGF0ZVN0cmluZy5zdGFydHNXaXRoKCcwMDAxLTAxLTAxJykgPT09IHRydWUpIHtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxuICAvKipcbiAgICog5Lik5Liq5pel5pyf5piv5ZCm55u4562JXG4gICAqIEBwYXJhbSBkYXRlT3JEYXRlU3RyaW5nMSDml6XmnJ/lr7nosaHmiJblrZfnrKbkuLJcbiAgICogQHBhcmFtIGRhdGVPckRhdGVTdHJpbmcxIOaXpeacn+WvueixoeaIluWtl+espuS4slxuICAgKiBAcmV0dXJuIOebuOetiei/lOWbnnRydWXvvIzlkKbliJnov5Tlm55mYWxzZVxuICAgKi9cbiAgc3RhdGljIGlzRXF1YWwoZGF0ZU9yRGF0ZVN0cmluZzE6IHN0cmluZyB8IERhdGUsIGRhdGVPckRhdGVTdHJpbmcyOiBzdHJpbmcgfCBEYXRlKTogYm9vbGVhbiB7XG4gICAgY29uc3QgZGF0ZU9iajEgPSB0aGlzLnBhcnNlKGRhdGVPckRhdGVTdHJpbmcxKTtcbiAgICBjb25zdCBkYXRlT2JqMiA9IHRoaXMucGFyc2UoZGF0ZU9yRGF0ZVN0cmluZzIpO1xuICAgIGlmIChkYXRlT2JqMSA9PT0gZGF0ZU9iajIpIHtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICByZXR1cm4gaXNFcXVhbChkYXRlT2JqMSwgZGF0ZU9iajIpO1xuICB9XG5cbiAgLyoqXG4gICAqIOS4pOS4quaXpeacn+aYr+WQpuebuOetiVxuICAgKiBAcGFyYW0gZGF0ZU9yRGF0ZVN0cmluZzEg5pel5pyf5a+56LGh5oiW5a2X56ym5LiyXG4gICAqIEBwYXJhbSBkYXRlT3JEYXRlU3RyaW5nMSDml6XmnJ/lr7nosaHmiJblrZfnrKbkuLJcbiAgICogQHJldHVybiDov5Tlm54tMeOAgTDjgIExXG4gICAqL1xuICBzdGF0aWMgY29tcGFyZShkYXRlT3JEYXRlU3RyaW5nMTogc3RyaW5nIHwgRGF0ZSwgZGF0ZU9yRGF0ZVN0cmluZzI6IHN0cmluZyB8IERhdGUpIHtcbiAgICBjb25zdCBkYXRlT2JqMSA9IHRoaXMucGFyc2UoZGF0ZU9yRGF0ZVN0cmluZzEpO1xuICAgIGNvbnN0IGRhdGVPYmoyID0gdGhpcy5wYXJzZShkYXRlT3JEYXRlU3RyaW5nMik7XG4gICAgaWYgKHRoaXMuaXNFcXVhbChkYXRlT2JqMSwgZGF0ZU9iajIpID09PSB0cnVlKSB7XG4gICAgICByZXR1cm4gMDtcbiAgICB9XG5cbiAgICAvLyDlpITnkIbop6PmnpDlkI7kuLpudWxs55qE5Zy65pmv77yMbnVsbOavlOaJgOacieacieaViOaXpeacn+Wwj1xuICAgIGlmICghZGF0ZU9iajEgJiYgdGhpcy5pc0RhdGUoZGF0ZU9iajIpID09PSB0cnVlKSB7XG4gICAgICByZXR1cm4gLTE7XG4gICAgfVxuICAgIGlmICghZGF0ZU9iajIgJiYgdGhpcy5pc0RhdGUoZGF0ZU9iajEpID09PSB0cnVlKSB7XG4gICAgICByZXR1cm4gMTtcbiAgICB9XG5cbiAgICByZXR1cm4gY29tcGFyZUFzYyhkYXRlT2JqMSwgZGF0ZU9iajIpO1xuICB9XG5cblxuICAvKipcbiAgICogXG4gICAqIEBwYXJhbSBjdXJyZW50RGF0ZSDlvZPliY3ml6XmnJ9cbiAgICogQHBhcmFtIHRhcmdldERhdGUg55uu5qCH5pel5pyfXG4gICAqIEBwYXJhbSB0eXBlIOavlOi+g+exu+WeiyBkYXRlXHREXHTlpKkwMDowMCBkYXlcdGRcdOaYn+acnzAwOjAwIG1vbnRoXHRNXHTmnIjnrKzkuIDlpKkwMDowMCB5ZWFyXHR5XHQx5pyIMeaXpTAw54K5IHdlZWtcdHdcdOWRqOesrOS4gOWkqTAwOjAwaG91clx0aFx0MDA6MDA6MDBtaW51dGVcdG1cdDAwOjAwc2Vjb25kXHRzXHQwMG1pbGxpc2Vjb25kXHRtc1x0MFxuICAgKiBAcmV0dXJucyBcbiAgICovXG4gIHN0YXRpYyBpc1NhbWUoY3VycmVudERhdGUsIHRhcmdldERhdGUsIHR5cGU/KSB7XG4gICAgaWYgKHR5cGUpIHtcbiAgICAgIHJldHVybiBkYXlqcyhjdXJyZW50RGF0ZSkuaXNTYW1lKGRheWpzKHRhcmdldERhdGUpLCB0eXBlKVxuICAgIH1cbiAgICByZXR1cm4gZGF5anMoY3VycmVudERhdGUpLmlzU2FtZShkYXlqcyh0YXJnZXREYXRlKSk7XG4gIH1cblxuICAvKipcbiAgICogXG4gICAqIEBwYXJhbSBjdXJyZW50RGF0ZSDlvZPliY3ml6XmnJ9cbiAgICogQHBhcmFtIHRhcmdldERhdGUg55uu5qCH5pel5pyfXG4gICAqIEByZXR1cm5zIGJvb2xlYW5cbiAgICovXG4gIHN0YXRpYyBpc0JlZm9yZShjdXJyZW50RGF0ZSwgdGFyZ2V0RGF0ZSwgdHlwZT8pIHtcbiAgICBpZiAodHlwZSkge1xuICAgICAgcmV0dXJuIGRheWpzKGN1cnJlbnREYXRlKS5pc0JlZm9yZShkYXlqcyh0YXJnZXREYXRlKSwgdHlwZSlcbiAgICB9XG4gICAgcmV0dXJuIGRheWpzKGN1cnJlbnREYXRlKS5pc0JlZm9yZShkYXlqcyh0YXJnZXREYXRlKSk7XG4gIH1cblxuICAvKipcbiAqIFxuICogQHBhcmFtIGN1cnJlbnREYXRlIOW9k+WJjeaXpeacn1xuICogQHBhcmFtIHRhcmdldERhdGUg55uu5qCH5pel5pyfXG4gKiBAcmV0dXJucyBib29sZWFuXG4gKi9cbiAgc3RhdGljIGlzQWZ0ZXIoY3VycmVudERhdGUsIHRhcmdldERhdGUsIHR5cGU/KSB7XG4gICAgaWYgKHR5cGUpIHtcbiAgICAgIHJldHVybiBkYXlqcyhjdXJyZW50RGF0ZSkuaXNBZnRlcihkYXlqcyh0YXJnZXREYXRlKSwgdHlwZSlcbiAgICB9XG4gICAgcmV0dXJuIGRheWpzKGN1cnJlbnREYXRlKS5pc0FmdGVyKGRheWpzKHRhcmdldERhdGUpKTtcbiAgfVxuXG5cbiAgLyoqXG4gICAqIFxuICAgKiBAcGFyYW0gY3VycmVudERhdGUgXG4gICAqIEBwYXJhbSB0YXJnZXREYXRlMSBcbiAgICogQHBhcmFtIHRhcmdldERhdGUyIFxuICAgKiBAcmV0dXJucyBcbiAgICovXG4gIHN0YXRpYyBpc0JldHdlZW4oY3VycmVudERhdGUsIHRhcmdldERhdGUxLCB0YXJnZXREYXRlMiwgdHlwZSwgY29udGFpbnMpIHtcbiAgICBkYXlqcy5leHRlbmQoSXNCZXR3ZWVuKVxuICAgIGlmICh0eXBlKSB7XG4gICAgICByZXR1cm4gZGF5anMoY3VycmVudERhdGUpLmlzQmV0d2VlbihkYXlqcyh0YXJnZXREYXRlMSksIGRheWpzKHRhcmdldERhdGUyKSwgdHlwZSwgY29udGFpbnMpO1xuICAgIH1cbiAgICByZXR1cm4gZGF5anMoY3VycmVudERhdGUpLmlzQmV0d2VlbihkYXlqcyh0YXJnZXREYXRlMSksIGRheWpzKHRhcmdldERhdGUyKSwgbnVsbCwgY29udGFpbnMpO1xuICB9XG59XG5cbmV4cG9ydCB7IERhdGVVdGlsIH07XG5cbiJdfQ==