var CONTEXT_FUNCTIONS = ['GetContextParameter', 'GetSessionValue'];
var StateDependencyResolver = /** @class */ (function () {
    function StateDependencyResolver(viewModelContext) {
        this.viewModelContext = viewModelContext;
    }
    StateDependencyResolver.prototype.resolve = function (expr) {
        var deps = [];
        var regex = new RegExp("DefaultFunction\\.(" + CONTEXT_FUNCTIONS.join('|') + ")\\s*\\([^\\r\\n\\)]*\\)", 'g');
        var contextFunctions = expr.match(regex);
        if (contextFunctions && contextFunctions.length > 0) {
            // todo: 使用正则匹配时可能会因为参数中有逗号导致问题，后续使用ast解析
            var argumentsRegex_1 = /\(([^\r\n\)]*)\)/;
            contextFunctions.forEach(function (groupFunction) {
                var argumentMatchResult = groupFunction.match(argumentsRegex_1);
                if (argumentMatchResult.length === 2) {
                    var argument = argumentMatchResult[1].trim().replace(/\"/g, '');
                    var dep = ['STATE~'];
                    dep.push(argument);
                    deps.push(dep.join('/'));
                }
            });
        }
        return deps;
    };
    return StateDependencyResolver;
}());
export { StateDependencyResolver };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3RhdGVfZGVwZW5kZW5jeV9yZXNvbHZlci5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BmYXJyaXMvbW9iaWxlLWRldmtpdC8iLCJzb3VyY2VzIjpbImxpYi9leHByZXNzaW9uL3Jlc29sdmVyL3N0YXRlX2RlcGVuZGVuY3lfcmVzb2x2ZXIudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBR0EsSUFBTSxpQkFBaUIsR0FBRyxDQUFDLHFCQUFxQixFQUFFLGlCQUFpQixDQUFDLENBQUM7QUFFckU7SUFFRSxpQ0FBb0IsZ0JBQWtDO1FBQWxDLHFCQUFnQixHQUFoQixnQkFBZ0IsQ0FBa0I7SUFDdEQsQ0FBQztJQUVNLHlDQUFPLEdBQWQsVUFBZSxJQUFZO1FBQ3pCLElBQU0sSUFBSSxHQUFHLEVBQUUsQ0FBQztRQUNoQixJQUFNLEtBQUssR0FBRyxJQUFJLE1BQU0sQ0FBQyx3QkFBc0IsaUJBQWlCLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyw2QkFBMEIsRUFBRSxHQUFHLENBQUMsQ0FBQztRQUMzRyxJQUFNLGdCQUFnQixHQUFxQixJQUFJLENBQUMsS0FBSyxDQUFDLEtBQUssQ0FBQyxDQUFDO1FBQzdELElBQUksZ0JBQWdCLElBQUksZ0JBQWdCLENBQUMsTUFBTSxHQUFHLENBQUMsRUFBRTtZQUNuRCx5Q0FBeUM7WUFDekMsSUFBTSxnQkFBYyxHQUFHLGtCQUFrQixDQUFDO1lBQzFDLGdCQUFnQixDQUFDLE9BQU8sQ0FBQyxVQUFDLGFBQXFCO2dCQUM3QyxJQUFNLG1CQUFtQixHQUFHLGFBQWEsQ0FBQyxLQUFLLENBQUMsZ0JBQWMsQ0FBQyxDQUFDO2dCQUNoRSxJQUFJLG1CQUFtQixDQUFDLE1BQU0sS0FBSyxDQUFDLEVBQUU7b0JBQ3BDLElBQU0sUUFBUSxHQUFHLG1CQUFtQixDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksRUFBRSxDQUFDLE9BQU8sQ0FBQyxLQUFLLEVBQUMsRUFBRSxDQUFDLENBQUM7b0JBQ2pFLElBQU0sR0FBRyxHQUFHLENBQUMsUUFBUSxDQUFDLENBQUM7b0JBQ3ZCLEdBQUcsQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLENBQUM7b0JBQ25CLElBQUksQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDO2lCQUMxQjtZQUNILENBQUMsQ0FBQyxDQUFDO1NBQ0o7UUFDRCxPQUFPLElBQUksQ0FBQztJQUNkLENBQUM7SUFFSCw4QkFBQztBQUFELENBQUMsQUF6QkQsSUF5QkMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBWaWV3TW9kZWxDb250ZXh0IH0gZnJvbSAnLi4vLi4vdmlldy1tb2RlbC9pbmRleCc7XG5pbXBvcnQgeyBJUmVzb2x2ZXIgfSBmcm9tIFwiLi90eXBlc1wiO1xuXG5jb25zdCBDT05URVhUX0ZVTkNUSU9OUyA9IFsnR2V0Q29udGV4dFBhcmFtZXRlcicsICdHZXRTZXNzaW9uVmFsdWUnXTtcblxuZXhwb3J0IGNsYXNzIFN0YXRlRGVwZW5kZW5jeVJlc29sdmVyIGltcGxlbWVudHMgSVJlc29sdmVyIHtcblxuICBjb25zdHJ1Y3Rvcihwcml2YXRlIHZpZXdNb2RlbENvbnRleHQ6IFZpZXdNb2RlbENvbnRleHQpIHtcbiAgfVxuXG4gIHB1YmxpYyByZXNvbHZlKGV4cHI6IHN0cmluZyk6IHN0cmluZ1tdIHtcbiAgICBjb25zdCBkZXBzID0gW107XG4gICAgY29uc3QgcmVnZXggPSBuZXcgUmVnRXhwKGBEZWZhdWx0RnVuY3Rpb25cXFxcLigke0NPTlRFWFRfRlVOQ1RJT05TLmpvaW4oJ3wnKX0pXFxcXHMqXFxcXChbXlxcXFxyXFxcXG5cXFxcKV0qXFxcXClgLCAnZycpO1xuICAgIGNvbnN0IGNvbnRleHRGdW5jdGlvbnM6IFJlZ0V4cE1hdGNoQXJyYXkgPSBleHByLm1hdGNoKHJlZ2V4KTtcbiAgICBpZiAoY29udGV4dEZ1bmN0aW9ucyAmJiBjb250ZXh0RnVuY3Rpb25zLmxlbmd0aCA+IDApIHtcbiAgICAgIC8vIHRvZG86IOS9v+eUqOato+WImeWMuemFjeaXtuWPr+iDveS8muWboOS4uuWPguaVsOS4reaciemAl+WPt+WvvOiHtOmXrumimO+8jOWQjue7reS9v+eUqGFzdOino+aekFxuICAgICAgY29uc3QgYXJndW1lbnRzUmVnZXggPSAvXFwoKFteXFxyXFxuXFwpXSopXFwpLztcbiAgICAgIGNvbnRleHRGdW5jdGlvbnMuZm9yRWFjaCgoZ3JvdXBGdW5jdGlvbjogc3RyaW5nKSA9PiB7XG4gICAgICAgIGNvbnN0IGFyZ3VtZW50TWF0Y2hSZXN1bHQgPSBncm91cEZ1bmN0aW9uLm1hdGNoKGFyZ3VtZW50c1JlZ2V4KTtcbiAgICAgICAgaWYgKGFyZ3VtZW50TWF0Y2hSZXN1bHQubGVuZ3RoID09PSAyKSB7XG4gICAgICAgICAgY29uc3QgYXJndW1lbnQgPSBhcmd1bWVudE1hdGNoUmVzdWx0WzFdLnRyaW0oKS5yZXBsYWNlKC9cXFwiL2csJycpO1xuICAgICAgICAgIGNvbnN0IGRlcCA9IFsnU1RBVEV+J107XG4gICAgICAgICAgZGVwLnB1c2goYXJndW1lbnQpO1xuICAgICAgICAgIGRlcHMucHVzaChkZXAuam9pbignLycpKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuICAgIHJldHVybiBkZXBzO1xuICB9XG5cbn0iXX0=