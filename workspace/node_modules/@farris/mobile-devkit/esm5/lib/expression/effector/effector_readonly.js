import { NAMESPACE } from '../core/index';
import { EffectUtil } from './util';
var ReadonlyEffector = /** @class */ (function () {
    function ReadonlyEffector(viewModelContext) {
        this.viewModelContext = viewModelContext;
        this.ns = this.viewModelContext.injector.get(NAMESPACE, '');
    }
    ReadonlyEffector.prototype.effect = function (path, value, options) {
        var viewModelContext;
        if (options.viewModelId) {
            viewModelContext = this.viewModelContext.appContext.viewModelContextManager.getContextById(options.viewModelId);
        }
        else {
            return;
        }
        if (!viewModelContext)
            return;
        if (!viewModelContext.form)
            return;
        var form_anme = EffectUtil.getFormValueByPath(path, viewModelContext).form_name;
        if (!form_anme) {
            return;
        }
        if (value === true) {
            form_anme['readonly'] = true;
        }
        else {
            form_anme['readonly'] = false;
        }
        viewModelContext.form.changes.next({ type: 'validateFieldsFinished' });
    };
    return ReadonlyEffector;
}());
export { ReadonlyEffector };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZWZmZWN0b3JfcmVhZG9ubHkuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZmFycmlzL21vYmlsZS1kZXZraXQvIiwic291cmNlcyI6WyJsaWIvZXhwcmVzc2lvbi9lZmZlY3Rvci9lZmZlY3Rvcl9yZWFkb25seS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFFQSxPQUFPLEVBQUUsU0FBUyxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBQzFDLE9BQU8sRUFBRSxVQUFVLEVBQUUsTUFBTSxRQUFRLENBQUM7QUFFcEM7SUFHSSwwQkFBb0IsZ0JBQWtDO1FBQWxDLHFCQUFnQixHQUFoQixnQkFBZ0IsQ0FBa0I7UUFDbEQsSUFBSSxDQUFDLEVBQUUsR0FBRyxJQUFJLENBQUMsZ0JBQWdCLENBQUMsUUFBUSxDQUFDLEdBQUcsQ0FBQyxTQUFTLEVBQUUsRUFBRSxDQUFDLENBQUM7SUFDaEUsQ0FBQztJQUNNLGlDQUFNLEdBQWIsVUFBYyxJQUFZLEVBQUUsS0FBVSxFQUFFLE9BQWlDO1FBQ3JFLElBQUksZ0JBQWtDLENBQUM7UUFDdkMsSUFBSSxPQUFPLENBQUMsV0FBVyxFQUFFO1lBQ3JCLGdCQUFnQixHQUFHLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxVQUFVLENBQUMsdUJBQXVCLENBQUMsY0FBYyxDQUFDLE9BQU8sQ0FBQyxXQUFXLENBQUMsQ0FBQTtTQUNsSDthQUFNO1lBQ0gsT0FBTTtTQUNUO1FBQ0QsSUFBSSxDQUFDLGdCQUFnQjtZQUFFLE9BQU87UUFDOUIsSUFBSSxDQUFDLGdCQUFnQixDQUFDLElBQUk7WUFBRSxPQUFPO1FBQ25DLElBQU0sU0FBUyxHQUFHLFVBQVUsQ0FBQyxrQkFBa0IsQ0FBQyxJQUFJLEVBQUUsZ0JBQWdCLENBQUMsQ0FBQyxTQUFTLENBQUM7UUFDbEYsSUFBSSxDQUFDLFNBQVMsRUFBRTtZQUFFLE9BQU87U0FBRTtRQUMzQixJQUFJLEtBQUssS0FBSyxJQUFJLEVBQUU7WUFDaEIsU0FBUyxDQUFDLFVBQVUsQ0FBQyxHQUFHLElBQUksQ0FBQztTQUNoQzthQUFNO1lBQ0gsU0FBUyxDQUFDLFVBQVUsQ0FBQyxHQUFHLEtBQUssQ0FBQztTQUNqQztRQUNELGdCQUFnQixDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLEVBQUUsSUFBSSxFQUFFLHdCQUF3QixFQUFFLENBQUMsQ0FBQTtJQUMxRSxDQUFDO0lBQ0wsdUJBQUM7QUFBRCxDQUFDLEFBeEJELElBd0JDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgRXhwcmVzc2lvbiB9IGZyb20gJy4uL2V4cHJlc3Npb24vaW5kZXgnO1xuaW1wb3J0IHsgVmlld01vZGVsQ29udGV4dCB9IGZyb20gJy4uLy4uL3ZpZXctbW9kZWwvaW5kZXgnXG5pbXBvcnQgeyBOQU1FU1BBQ0UgfSBmcm9tICcuLi9jb3JlL2luZGV4JztcbmltcG9ydCB7IEVmZmVjdFV0aWwgfSBmcm9tICcuL3V0aWwnO1xuXG5leHBvcnQgY2xhc3MgUmVhZG9ubHlFZmZlY3RvciBpbXBsZW1lbnRzIEV4cHJlc3Npb24uRWZmZWN0b3Ige1xuICAgIHB1YmxpYyBuczogc3RyaW5nO1xuXG4gICAgY29uc3RydWN0b3IocHJpdmF0ZSB2aWV3TW9kZWxDb250ZXh0OiBWaWV3TW9kZWxDb250ZXh0KSB7XG4gICAgICAgIHRoaXMubnMgPSB0aGlzLnZpZXdNb2RlbENvbnRleHQuaW5qZWN0b3IuZ2V0KE5BTUVTUEFDRSwgJycpO1xuICAgIH1cbiAgICBwdWJsaWMgZWZmZWN0KHBhdGg6IHN0cmluZywgdmFsdWU6IGFueSwgb3B0aW9uczogRXhwcmVzc2lvbi5FZmZlY3RPcHRpb25zKSB7XG4gICAgICAgIGxldCB2aWV3TW9kZWxDb250ZXh0OiBWaWV3TW9kZWxDb250ZXh0O1xuICAgICAgICBpZiAob3B0aW9ucy52aWV3TW9kZWxJZCkge1xuICAgICAgICAgICAgdmlld01vZGVsQ29udGV4dCA9IHRoaXMudmlld01vZGVsQ29udGV4dC5hcHBDb250ZXh0LnZpZXdNb2RlbENvbnRleHRNYW5hZ2VyLmdldENvbnRleHRCeUlkKG9wdGlvbnMudmlld01vZGVsSWQpXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm5cbiAgICAgICAgfVxuICAgICAgICBpZiAoIXZpZXdNb2RlbENvbnRleHQpIHJldHVybjtcbiAgICAgICAgaWYgKCF2aWV3TW9kZWxDb250ZXh0LmZvcm0pIHJldHVybjtcbiAgICAgICAgY29uc3QgZm9ybV9hbm1lID0gRWZmZWN0VXRpbC5nZXRGb3JtVmFsdWVCeVBhdGgocGF0aCwgdmlld01vZGVsQ29udGV4dCkuZm9ybV9uYW1lO1xuICAgICAgICBpZiAoIWZvcm1fYW5tZSkgeyByZXR1cm47IH1cbiAgICAgICAgaWYgKHZhbHVlID09PSB0cnVlKSB7XG4gICAgICAgICAgICBmb3JtX2FubWVbJ3JlYWRvbmx5J10gPSB0cnVlO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZm9ybV9hbm1lWydyZWFkb25seSddID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgdmlld01vZGVsQ29udGV4dC5mb3JtLmNoYW5nZXMubmV4dCh7IHR5cGU6ICd2YWxpZGF0ZUZpZWxkc0ZpbmlzaGVkJyB9KVxuICAgIH1cbn1cbiJdfQ==