const CONTEXT_FUNCTIONS = ['GetContextParameter', 'GetSessionValue'];
export class StateDependencyResolver {
    constructor(viewModelContext) {
        this.viewModelContext = viewModelContext;
    }
    resolve(expr) {
        const deps = [];
        const regex = new RegExp(`DefaultFunction\\.(${CONTEXT_FUNCTIONS.join('|')})\\s*\\([^\\r\\n\\)]*\\)`, 'g');
        const contextFunctions = expr.match(regex);
        if (contextFunctions && contextFunctions.length > 0) {
            // todo: 使用正则匹配时可能会因为参数中有逗号导致问题，后续使用ast解析
            const argumentsRegex = /\(([^\r\n\)]*)\)/;
            contextFunctions.forEach((groupFunction) => {
                const argumentMatchResult = groupFunction.match(argumentsRegex);
                if (argumentMatchResult.length === 2) {
                    const argument = argumentMatchResult[1].trim().replace(/\"/g, '');
                    const dep = ['STATE~'];
                    dep.push(argument);
                    deps.push(dep.join('/'));
                }
            });
        }
        return deps;
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3RhdGVfZGVwZW5kZW5jeV9yZXNvbHZlci5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BmYXJyaXMvbW9iaWxlLWRldmtpdC8iLCJzb3VyY2VzIjpbImxpYi9leHByZXNzaW9uL3Jlc29sdmVyL3N0YXRlX2RlcGVuZGVuY3lfcmVzb2x2ZXIudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBR0EsTUFBTSxpQkFBaUIsR0FBRyxDQUFDLHFCQUFxQixFQUFFLGlCQUFpQixDQUFDLENBQUM7QUFFckUsTUFBTSxPQUFPLHVCQUF1QjtJQUVsQyxZQUFvQixnQkFBa0M7UUFBbEMscUJBQWdCLEdBQWhCLGdCQUFnQixDQUFrQjtJQUN0RCxDQUFDO0lBRU0sT0FBTyxDQUFDLElBQVk7UUFDekIsTUFBTSxJQUFJLEdBQUcsRUFBRSxDQUFDO1FBQ2hCLE1BQU0sS0FBSyxHQUFHLElBQUksTUFBTSxDQUFDLHNCQUFzQixpQkFBaUIsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLDBCQUEwQixFQUFFLEdBQUcsQ0FBQyxDQUFDO1FBQzNHLE1BQU0sZ0JBQWdCLEdBQXFCLElBQUksQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLENBQUM7UUFDN0QsSUFBSSxnQkFBZ0IsSUFBSSxnQkFBZ0IsQ0FBQyxNQUFNLEdBQUcsQ0FBQyxFQUFFO1lBQ25ELHlDQUF5QztZQUN6QyxNQUFNLGNBQWMsR0FBRyxrQkFBa0IsQ0FBQztZQUMxQyxnQkFBZ0IsQ0FBQyxPQUFPLENBQUMsQ0FBQyxhQUFxQixFQUFFLEVBQUU7Z0JBQ2pELE1BQU0sbUJBQW1CLEdBQUcsYUFBYSxDQUFDLEtBQUssQ0FBQyxjQUFjLENBQUMsQ0FBQztnQkFDaEUsSUFBSSxtQkFBbUIsQ0FBQyxNQUFNLEtBQUssQ0FBQyxFQUFFO29CQUNwQyxNQUFNLFFBQVEsR0FBRyxtQkFBbUIsQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLEVBQUUsQ0FBQyxPQUFPLENBQUMsS0FBSyxFQUFDLEVBQUUsQ0FBQyxDQUFDO29CQUNqRSxNQUFNLEdBQUcsR0FBRyxDQUFDLFFBQVEsQ0FBQyxDQUFDO29CQUN2QixHQUFHLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxDQUFDO29CQUNuQixJQUFJLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQztpQkFDMUI7WUFDSCxDQUFDLENBQUMsQ0FBQztTQUNKO1FBQ0QsT0FBTyxJQUFJLENBQUM7SUFDZCxDQUFDO0NBRUYiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBWaWV3TW9kZWxDb250ZXh0IH0gZnJvbSAnLi4vLi4vdmlldy1tb2RlbC9pbmRleCc7XG5pbXBvcnQgeyBJUmVzb2x2ZXIgfSBmcm9tIFwiLi90eXBlc1wiO1xuXG5jb25zdCBDT05URVhUX0ZVTkNUSU9OUyA9IFsnR2V0Q29udGV4dFBhcmFtZXRlcicsICdHZXRTZXNzaW9uVmFsdWUnXTtcblxuZXhwb3J0IGNsYXNzIFN0YXRlRGVwZW5kZW5jeVJlc29sdmVyIGltcGxlbWVudHMgSVJlc29sdmVyIHtcblxuICBjb25zdHJ1Y3Rvcihwcml2YXRlIHZpZXdNb2RlbENvbnRleHQ6IFZpZXdNb2RlbENvbnRleHQpIHtcbiAgfVxuXG4gIHB1YmxpYyByZXNvbHZlKGV4cHI6IHN0cmluZyk6IHN0cmluZ1tdIHtcbiAgICBjb25zdCBkZXBzID0gW107XG4gICAgY29uc3QgcmVnZXggPSBuZXcgUmVnRXhwKGBEZWZhdWx0RnVuY3Rpb25cXFxcLigke0NPTlRFWFRfRlVOQ1RJT05TLmpvaW4oJ3wnKX0pXFxcXHMqXFxcXChbXlxcXFxyXFxcXG5cXFxcKV0qXFxcXClgLCAnZycpO1xuICAgIGNvbnN0IGNvbnRleHRGdW5jdGlvbnM6IFJlZ0V4cE1hdGNoQXJyYXkgPSBleHByLm1hdGNoKHJlZ2V4KTtcbiAgICBpZiAoY29udGV4dEZ1bmN0aW9ucyAmJiBjb250ZXh0RnVuY3Rpb25zLmxlbmd0aCA+IDApIHtcbiAgICAgIC8vIHRvZG86IOS9v+eUqOato+WImeWMuemFjeaXtuWPr+iDveS8muWboOS4uuWPguaVsOS4reaciemAl+WPt+WvvOiHtOmXrumimO+8jOWQjue7reS9v+eUqGFzdOino+aekFxuICAgICAgY29uc3QgYXJndW1lbnRzUmVnZXggPSAvXFwoKFteXFxyXFxuXFwpXSopXFwpLztcbiAgICAgIGNvbnRleHRGdW5jdGlvbnMuZm9yRWFjaCgoZ3JvdXBGdW5jdGlvbjogc3RyaW5nKSA9PiB7XG4gICAgICAgIGNvbnN0IGFyZ3VtZW50TWF0Y2hSZXN1bHQgPSBncm91cEZ1bmN0aW9uLm1hdGNoKGFyZ3VtZW50c1JlZ2V4KTtcbiAgICAgICAgaWYgKGFyZ3VtZW50TWF0Y2hSZXN1bHQubGVuZ3RoID09PSAyKSB7XG4gICAgICAgICAgY29uc3QgYXJndW1lbnQgPSBhcmd1bWVudE1hdGNoUmVzdWx0WzFdLnRyaW0oKS5yZXBsYWNlKC9cXFwiL2csJycpO1xuICAgICAgICAgIGNvbnN0IGRlcCA9IFsnU1RBVEV+J107XG4gICAgICAgICAgZGVwLnB1c2goYXJndW1lbnQpO1xuICAgICAgICAgIGRlcHMucHVzaChkZXAuam9pbignLycpKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuICAgIHJldHVybiBkZXBzO1xuICB9XG5cbn0iXX0=