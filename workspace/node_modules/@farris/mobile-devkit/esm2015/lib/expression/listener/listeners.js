import { Subject } from 'rxjs';
import { ListenerRegistry } from './listener_registry';
/**
 * 监听器
 * @description 监听bindingList、UIState变更
 */
class Listeners {
    /**
     * 构造函数
     */
    constructor(viewModelContext) {
        this.viewModelContext = viewModelContext;
        this.subject = new Subject();
        this.registry = this.viewModelContext.injector.get(ListenerRegistry, null);
        this.regist();
    }
    get onEvent() {
        return this.subject;
    }
    /**
     * 注册Listender
     */
    regist() {
        const listeners = this.registry && this.registry.listeners || [];
        if (listeners && listeners.length > 0) {
            listeners.forEach((listener) => {
                listener.onEvent.subscribe((modification) => {
                    this.subject.next(modification);
                });
            });
        }
    }
}
export { Listeners };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibGlzdGVuZXJzLmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGZhcnJpcy9tb2JpbGUtZGV2a2l0LyIsInNvdXJjZXMiOlsibGliL2V4cHJlc3Npb24vbGlzdGVuZXIvbGlzdGVuZXJzLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBYyxPQUFPLEVBQUUsTUFBTSxNQUFNLENBQUM7QUFDM0MsT0FBTyxFQUFFLGdCQUFnQixFQUFFLE1BQU0scUJBQXFCLENBQUM7QUFPdkQ7OztHQUdHO0FBQ0gsTUFBTSxTQUFTO0lBVWI7O09BRUc7SUFDSCxZQUFvQixnQkFBa0M7UUFBbEMscUJBQWdCLEdBQWhCLGdCQUFnQixDQUFrQjtRQVQ5QyxZQUFPLEdBQXVCLElBQUksT0FBTyxFQUFhLENBQUM7UUFVN0QsSUFBSSxDQUFDLFFBQVEsR0FBRyxJQUFJLENBQUMsZ0JBQWdCLENBQUMsUUFBUSxDQUFDLEdBQUcsQ0FBQyxnQkFBZ0IsRUFBRSxJQUFJLENBQUMsQ0FBQztRQUMzRSxJQUFJLENBQUMsTUFBTSxFQUFFLENBQUM7SUFDaEIsQ0FBQztJQVZELElBQVcsT0FBTztRQUNoQixPQUFPLElBQUksQ0FBQyxPQUFPLENBQUM7SUFDdEIsQ0FBQztJQVVEOztPQUVHO0lBQ0ssTUFBTTtRQUNaLE1BQU0sU0FBUyxHQUFHLElBQUksQ0FBQyxRQUFRLElBQUksSUFBSSxDQUFDLFFBQVEsQ0FBQyxTQUFTLElBQUksRUFBRSxDQUFDO1FBQ2pFLElBQUksU0FBUyxJQUFJLFNBQVMsQ0FBQyxNQUFNLEdBQUcsQ0FBQyxFQUFFO1lBQ3JDLFNBQVMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxRQUFrQixFQUFFLEVBQUU7Z0JBQ3ZDLFFBQVEsQ0FBQyxPQUFPLENBQUMsU0FBUyxDQUFDLENBQUMsWUFBdUIsRUFBRSxFQUFFO29CQUNyRCxJQUFJLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxZQUFZLENBQUMsQ0FBQztnQkFDbEMsQ0FBQyxDQUFDLENBQUM7WUFDTCxDQUFDLENBQUMsQ0FBQztTQUNKO0lBQ0gsQ0FBQztDQUNGO0FBQ0QsT0FBTyxFQUFFLFNBQVMsRUFBRSxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgT2JzZXJ2YWJsZSwgU3ViamVjdCB9IGZyb20gJ3J4anMnO1xuaW1wb3J0IHsgTGlzdGVuZXJSZWdpc3RyeSB9IGZyb20gJy4vbGlzdGVuZXJfcmVnaXN0cnknO1xuaW1wb3J0IHsgRXhwcmVzc2lvbiB9IGZyb20gJy4uL2V4cHJlc3Npb24vaW5kZXgnO1xuaW1wb3J0IHsgVmlld01vZGVsQ29udGV4dCB9IGZyb20gJy4uLy4uL3ZpZXctbW9kZWwvaW5kZXgnO1xuXG50eXBlIEV2ZW50QXJncyA9IEV4cHJlc3Npb24uRXZlbnRBcmdzO1xudHlwZSBMaXN0ZW5lciA9IEV4cHJlc3Npb24uTGlzdGVuZXI7XG5cbi8qKlxuICog55uR5ZCs5ZmoXG4gKiBAZGVzY3JpcHRpb24g55uR5ZCsYmluZGluZ0xpc3TjgIFVSVN0YXRl5Y+Y5pu0XG4gKi9cbmNsYXNzIExpc3RlbmVycyB7XG5cbiAgcHJpdmF0ZSByZWdpc3RyeTogTGlzdGVuZXJSZWdpc3RyeVxuXG4gIHByaXZhdGUgc3ViamVjdDogU3ViamVjdDxFdmVudEFyZ3M+ID0gbmV3IFN1YmplY3Q8RXZlbnRBcmdzPigpO1xuXG4gIHB1YmxpYyBnZXQgb25FdmVudCgpOiBPYnNlcnZhYmxlPEV2ZW50QXJncz4ge1xuICAgIHJldHVybiB0aGlzLnN1YmplY3Q7XG4gIH1cblxuICAvKipcbiAgICog5p6E6YCg5Ye95pWwXG4gICAqL1xuICBjb25zdHJ1Y3Rvcihwcml2YXRlIHZpZXdNb2RlbENvbnRleHQ6IFZpZXdNb2RlbENvbnRleHQpIHtcbiAgICB0aGlzLnJlZ2lzdHJ5ID0gdGhpcy52aWV3TW9kZWxDb250ZXh0LmluamVjdG9yLmdldChMaXN0ZW5lclJlZ2lzdHJ5LCBudWxsKTtcbiAgICB0aGlzLnJlZ2lzdCgpO1xuICB9XG5cbiAgLyoqXG4gICAqIOazqOWGjExpc3RlbmRlclxuICAgKi9cbiAgcHJpdmF0ZSByZWdpc3QoKSB7XG4gICAgY29uc3QgbGlzdGVuZXJzID0gdGhpcy5yZWdpc3RyeSAmJiB0aGlzLnJlZ2lzdHJ5Lmxpc3RlbmVycyB8fCBbXTtcbiAgICBpZiAobGlzdGVuZXJzICYmIGxpc3RlbmVycy5sZW5ndGggPiAwKSB7XG4gICAgICBsaXN0ZW5lcnMuZm9yRWFjaCgobGlzdGVuZXI6IExpc3RlbmVyKSA9PiB7XG4gICAgICAgIGxpc3RlbmVyLm9uRXZlbnQuc3Vic2NyaWJlKChtb2RpZmljYXRpb246IEV2ZW50QXJncykgPT4ge1xuICAgICAgICAgIHRoaXMuc3ViamVjdC5uZXh0KG1vZGlmaWNhdGlvbik7XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfVxuICB9XG59XG5leHBvcnQgeyBMaXN0ZW5lcnMgfTtcbiJdfQ==