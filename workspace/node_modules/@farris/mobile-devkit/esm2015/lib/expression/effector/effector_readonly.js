import { NAMESPACE } from '../core/index';
import { EffectUtil } from './util';
export class ReadonlyEffector {
    constructor(viewModelContext) {
        this.viewModelContext = viewModelContext;
        this.ns = this.viewModelContext.injector.get(NAMESPACE, '');
    }
    effect(path, value, options) {
        let viewModelContext;
        if (options.viewModelId) {
            viewModelContext = this.viewModelContext.appContext.viewModelContextManager.getContextById(options.viewModelId);
        }
        else {
            return;
        }
        if (!viewModelContext)
            return;
        if (!viewModelContext.form)
            return;
        const form_anme = EffectUtil.getFormValueByPath(path, viewModelContext).form_name;
        if (!form_anme) {
            return;
        }
        if (value === true) {
            form_anme['readonly'] = true;
        }
        else {
            form_anme['readonly'] = false;
        }
        viewModelContext.form.changes.next({ type: 'validateFieldsFinished' });
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZWZmZWN0b3JfcmVhZG9ubHkuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZmFycmlzL21vYmlsZS1kZXZraXQvIiwic291cmNlcyI6WyJsaWIvZXhwcmVzc2lvbi9lZmZlY3Rvci9lZmZlY3Rvcl9yZWFkb25seS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFFQSxPQUFPLEVBQUUsU0FBUyxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBQzFDLE9BQU8sRUFBRSxVQUFVLEVBQUUsTUFBTSxRQUFRLENBQUM7QUFFcEMsTUFBTSxPQUFPLGdCQUFnQjtJQUd6QixZQUFvQixnQkFBa0M7UUFBbEMscUJBQWdCLEdBQWhCLGdCQUFnQixDQUFrQjtRQUNsRCxJQUFJLENBQUMsRUFBRSxHQUFHLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxRQUFRLENBQUMsR0FBRyxDQUFDLFNBQVMsRUFBRSxFQUFFLENBQUMsQ0FBQztJQUNoRSxDQUFDO0lBQ00sTUFBTSxDQUFDLElBQVksRUFBRSxLQUFVLEVBQUUsT0FBaUM7UUFDckUsSUFBSSxnQkFBa0MsQ0FBQztRQUN2QyxJQUFJLE9BQU8sQ0FBQyxXQUFXLEVBQUU7WUFDckIsZ0JBQWdCLEdBQUcsSUFBSSxDQUFDLGdCQUFnQixDQUFDLFVBQVUsQ0FBQyx1QkFBdUIsQ0FBQyxjQUFjLENBQUMsT0FBTyxDQUFDLFdBQVcsQ0FBQyxDQUFBO1NBQ2xIO2FBQU07WUFDSCxPQUFNO1NBQ1Q7UUFDRCxJQUFJLENBQUMsZ0JBQWdCO1lBQUUsT0FBTztRQUM5QixJQUFJLENBQUMsZ0JBQWdCLENBQUMsSUFBSTtZQUFFLE9BQU87UUFDbkMsTUFBTSxTQUFTLEdBQUcsVUFBVSxDQUFDLGtCQUFrQixDQUFDLElBQUksRUFBRSxnQkFBZ0IsQ0FBQyxDQUFDLFNBQVMsQ0FBQztRQUNsRixJQUFJLENBQUMsU0FBUyxFQUFFO1lBQUUsT0FBTztTQUFFO1FBQzNCLElBQUksS0FBSyxLQUFLLElBQUksRUFBRTtZQUNoQixTQUFTLENBQUMsVUFBVSxDQUFDLEdBQUcsSUFBSSxDQUFDO1NBQ2hDO2FBQU07WUFDSCxTQUFTLENBQUMsVUFBVSxDQUFDLEdBQUcsS0FBSyxDQUFDO1NBQ2pDO1FBQ0QsZ0JBQWdCLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsRUFBRSxJQUFJLEVBQUUsd0JBQXdCLEVBQUUsQ0FBQyxDQUFBO0lBQzFFLENBQUM7Q0FDSiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEV4cHJlc3Npb24gfSBmcm9tICcuLi9leHByZXNzaW9uL2luZGV4JztcbmltcG9ydCB7IFZpZXdNb2RlbENvbnRleHQgfSBmcm9tICcuLi8uLi92aWV3LW1vZGVsL2luZGV4J1xuaW1wb3J0IHsgTkFNRVNQQUNFIH0gZnJvbSAnLi4vY29yZS9pbmRleCc7XG5pbXBvcnQgeyBFZmZlY3RVdGlsIH0gZnJvbSAnLi91dGlsJztcblxuZXhwb3J0IGNsYXNzIFJlYWRvbmx5RWZmZWN0b3IgaW1wbGVtZW50cyBFeHByZXNzaW9uLkVmZmVjdG9yIHtcbiAgICBwdWJsaWMgbnM6IHN0cmluZztcblxuICAgIGNvbnN0cnVjdG9yKHByaXZhdGUgdmlld01vZGVsQ29udGV4dDogVmlld01vZGVsQ29udGV4dCkge1xuICAgICAgICB0aGlzLm5zID0gdGhpcy52aWV3TW9kZWxDb250ZXh0LmluamVjdG9yLmdldChOQU1FU1BBQ0UsICcnKTtcbiAgICB9XG4gICAgcHVibGljIGVmZmVjdChwYXRoOiBzdHJpbmcsIHZhbHVlOiBhbnksIG9wdGlvbnM6IEV4cHJlc3Npb24uRWZmZWN0T3B0aW9ucykge1xuICAgICAgICBsZXQgdmlld01vZGVsQ29udGV4dDogVmlld01vZGVsQ29udGV4dDtcbiAgICAgICAgaWYgKG9wdGlvbnMudmlld01vZGVsSWQpIHtcbiAgICAgICAgICAgIHZpZXdNb2RlbENvbnRleHQgPSB0aGlzLnZpZXdNb2RlbENvbnRleHQuYXBwQ29udGV4dC52aWV3TW9kZWxDb250ZXh0TWFuYWdlci5nZXRDb250ZXh0QnlJZChvcHRpb25zLnZpZXdNb2RlbElkKVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuXG4gICAgICAgIH1cbiAgICAgICAgaWYgKCF2aWV3TW9kZWxDb250ZXh0KSByZXR1cm47XG4gICAgICAgIGlmICghdmlld01vZGVsQ29udGV4dC5mb3JtKSByZXR1cm47XG4gICAgICAgIGNvbnN0IGZvcm1fYW5tZSA9IEVmZmVjdFV0aWwuZ2V0Rm9ybVZhbHVlQnlQYXRoKHBhdGgsIHZpZXdNb2RlbENvbnRleHQpLmZvcm1fbmFtZTtcbiAgICAgICAgaWYgKCFmb3JtX2FubWUpIHsgcmV0dXJuOyB9XG4gICAgICAgIGlmICh2YWx1ZSA9PT0gdHJ1ZSkge1xuICAgICAgICAgICAgZm9ybV9hbm1lWydyZWFkb25seSddID0gdHJ1ZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGZvcm1fYW5tZVsncmVhZG9ubHknXSA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHZpZXdNb2RlbENvbnRleHQuZm9ybS5jaGFuZ2VzLm5leHQoeyB0eXBlOiAndmFsaWRhdGVGaWVsZHNGaW5pc2hlZCcgfSlcbiAgICB9XG59XG4iXX0=