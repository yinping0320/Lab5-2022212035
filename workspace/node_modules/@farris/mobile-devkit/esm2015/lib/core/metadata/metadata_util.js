import { ANNOTATIONS, PROP_METADATA } from './decorator';
/**
 * 元数据解析
 * 约束：
 * 1、类型装饰器：在某个类型上，某种类型的装饰器，只使用一次，不重复添加；
 * 2、属性装饰器：在某个属性上，某种类型的装饰器，只使用一次，不重复添加
 */
class MetadataUtil {
    // ----------------------------------------
    // 类型元数据
    // ----------------------------------------
    /**
     * 获取类元数据
     * 返回结果形如：
     * [
     *   Injectable
     *   NgViewModel
     *   NgViewModel
     * ]
     */
    static getClassMetadatas(constructor) {
        const metadatas = constructor[ANNOTATIONS];
        return metadatas;
    }
    /**
     * 获取某个class上的某种装饰器
     * 返回结果：NgViewModel
     */
    static getClassMetadataByName(constructor, metadataName) {
        const metadata = this.getClassMetadataByNameWithTranslate(constructor, metadataName, null, null);
        return metadata;
    }
    static getClassMetadataByNameWithTranslate(constructor, metadataName, translateService, keysToTranslate) {
        const allClassMetadatas = this.getClassMetadatas(constructor);
        if (!allClassMetadatas) {
            return null;
        }
        const metadata = allClassMetadatas.find((classMetadata) => {
            return classMetadata.ngMetadataName === metadataName;
        });
        if (metadata && translateService && keysToTranslate) {
            keysToTranslate.forEach((metadataPropKey) => {
                const propertyVariable = metadata[metadataPropKey];
                if (propertyVariable && propertyVariable.startsWith('{{') && propertyVariable.endsWith('}}')) {
                    const translateKey = propertyVariable.replace('{{', '').replace('}}', '').trim();
                    metadata[metadataPropKey] = translateService.transform(translateKey, null);
                }
            });
        }
        return metadata;
    }
    // ----------------------------------------
    // 属性元数据
    // ----------------------------------------
    /**
     * 获取所有属性的所有元数据
     * 返回格式：
     * {
     *   propName1: [ NgDefaultValue, NgMaxLength, NgMinLength],
     *   propName2: [ NgDefaultValue, NgMaxLength, NgMinLength]
     * }
     */
    static getPropsMetadatas(constructor) {
        const allPropMetadatas = constructor[PROP_METADATA];
        return allPropMetadatas;
    }
    /**
     * 获取所有属性的某一类型的元数据
     * 如果同一属性
     * 返回结果：
     * {
     *    propName1: NgDefaultValue,
     *    propName2: NgDefaultValue
     * }
     */
    static getPropsMetadatasByName(constructor, metadataName) {
        const metadatas = this.getPropsMetadatasByNameWithTranslate(constructor, metadataName);
        return metadatas;
    }
    static getPropsMetadatasByNameWithTranslate(constructor, metadataName, translateService, keysToTranslate) {
        const metadatas = {};
        // 读取构造函数中存储的类属性注解。
        const allPropMetadatas = this.getPropsMetadatas(constructor);
        if (!allPropMetadatas) {
            return metadatas;
        }
        // 遍历所有属性提取注解信息。
        Object.keys(allPropMetadatas).forEach((propName) => {
            // 提取当前属性注解对象
            const propMetadatas = allPropMetadatas[propName];
            // 提取指定类型的注解项
            const metadata = propMetadatas.find((propMetadata) => {
                return propMetadata.ngMetadataName === metadataName;
            });
            if (translateService && keysToTranslate) {
                keysToTranslate.forEach((metadataPropKey) => {
                    const propertyVariable = metadata[metadataPropKey];
                    if (propertyVariable && propertyVariable.startsWith('{{') && propertyVariable.endsWith('}}')) {
                        const translateKey = propertyVariable.replace('{{', '').replace('}}', '').trim();
                        metadata[metadataPropKey] = translateService.transform(translateKey, null);
                    }
                });
            }
            if (metadata) {
                metadatas[propName] = metadata;
            }
        });
        return metadatas;
    }
    /**
     * 获取某个属性的所有元数据
     * 返回格式：[ NgDefaultValue, NgMaxLength, NgMinLength]
     */
    static getPropMetadatasByName(constructor, propName) {
        // 暂不实现
        return null;
    }
    /**
     * 获取某个属性的某种元数据
     * 返回格式：NgDefaultValue
     */
    static getPropMetadataByName(constructor, propName, metadataName) {
        // 暂不实现
        return null;
    }
}
export { MetadataUtil };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWV0YWRhdGFfdXRpbC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BmYXJyaXMvbW9iaWxlLWRldmtpdC8iLCJzb3VyY2VzIjpbImxpYi9jb3JlL21ldGFkYXRhL21ldGFkYXRhX3V0aWwudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLFdBQVcsRUFBRSxhQUFhLEVBQUUsTUFBTSxhQUFhLENBQUM7QUFHekQ7Ozs7O0dBS0c7QUFDSCxNQUFNLFlBQVk7SUFFaEIsMkNBQTJDO0lBQzNDLFFBQVE7SUFDUiwyQ0FBMkM7SUFFM0M7Ozs7Ozs7O09BUUc7SUFDSCxNQUFNLENBQUMsaUJBQWlCLENBQUMsV0FBZ0I7UUFDdkMsTUFBTSxTQUFTLEdBQUcsV0FBVyxDQUFDLFdBQVcsQ0FBQyxDQUFDO1FBQzNDLE9BQU8sU0FBUyxDQUFDO0lBQ25CLENBQUM7SUFFRDs7O09BR0c7SUFDSCxNQUFNLENBQUMsc0JBQXNCLENBQUMsV0FBZ0IsRUFBRSxZQUFvQjtRQUNsRSxNQUFNLFFBQVEsR0FBRyxJQUFJLENBQUMsbUNBQW1DLENBQUMsV0FBVyxFQUFFLFlBQVksRUFBRSxJQUFJLEVBQUUsSUFBSSxDQUFDLENBQUM7UUFDakcsT0FBTyxRQUFRLENBQUM7SUFDbEIsQ0FBQztJQUVELE1BQU0sQ0FBQyxtQ0FBbUMsQ0FDeEMsV0FBZ0IsRUFBRSxZQUFvQixFQUN0QyxnQkFBNEIsRUFBRSxlQUEwQjtRQUN4RCxNQUFNLGlCQUFpQixHQUFHLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxXQUFXLENBQUMsQ0FBQztRQUM5RCxJQUFJLENBQUMsaUJBQWlCLEVBQUU7WUFDdEIsT0FBTyxJQUFJLENBQUM7U0FDYjtRQUNELE1BQU0sUUFBUSxHQUFHLGlCQUFpQixDQUFDLElBQUksQ0FBQyxDQUFDLGFBQWtCLEVBQUUsRUFBRTtZQUM3RCxPQUFPLGFBQWEsQ0FBQyxjQUFjLEtBQUssWUFBWSxDQUFDO1FBQ3ZELENBQUMsQ0FBQyxDQUFDO1FBQ0gsSUFBSSxRQUFRLElBQUksZ0JBQWdCLElBQUksZUFBZSxFQUFFO1lBQ25ELGVBQWUsQ0FBQyxPQUFPLENBQUMsQ0FBQyxlQUFlLEVBQUUsRUFBRTtnQkFDMUMsTUFBTSxnQkFBZ0IsR0FBVyxRQUFRLENBQUMsZUFBZSxDQUFDLENBQUM7Z0JBQzNELElBQUksZ0JBQWdCLElBQUksZ0JBQWdCLENBQUMsVUFBVSxDQUFDLElBQUksQ0FBQyxJQUFJLGdCQUFnQixDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsRUFBRTtvQkFDNUYsTUFBTSxZQUFZLEdBQUcsZ0JBQWdCLENBQUMsT0FBTyxDQUFDLElBQUksRUFBRSxFQUFFLENBQUMsQ0FBQyxPQUFPLENBQUMsSUFBSSxFQUFFLEVBQUUsQ0FBQyxDQUFDLElBQUksRUFBRSxDQUFDO29CQUNqRixRQUFRLENBQUMsZUFBZSxDQUFDLEdBQUcsZ0JBQWdCLENBQUMsU0FBUyxDQUFDLFlBQVksRUFBRSxJQUFJLENBQUMsQ0FBQztpQkFDNUU7WUFDSCxDQUFDLENBQUMsQ0FBQztTQUNKO1FBQ0QsT0FBTyxRQUFRLENBQUM7SUFDbEIsQ0FBQztJQUVELDJDQUEyQztJQUMzQyxRQUFRO0lBQ1IsMkNBQTJDO0lBRTNDOzs7Ozs7O09BT0c7SUFDSCxNQUFNLENBQUMsaUJBQWlCLENBQUMsV0FBZ0I7UUFDdkMsTUFBTSxnQkFBZ0IsR0FBRyxXQUFXLENBQUMsYUFBYSxDQUFDLENBQUM7UUFDcEQsT0FBTyxnQkFBZ0IsQ0FBQztJQUMxQixDQUFDO0lBRUQ7Ozs7Ozs7O09BUUc7SUFDSCxNQUFNLENBQUMsdUJBQXVCLENBQUMsV0FBZ0IsRUFBRSxZQUFvQjtRQUNuRSxNQUFNLFNBQVMsR0FBRyxJQUFJLENBQUMsb0NBQW9DLENBQUMsV0FBVyxFQUFFLFlBQVksQ0FBQyxDQUFDO1FBQ3ZGLE9BQU8sU0FBUyxDQUFDO0lBQ25CLENBQUM7SUFFRCxNQUFNLENBQUMsb0NBQW9DLENBQ3pDLFdBQWdCLEVBQUUsWUFBb0IsRUFDdEMsZ0JBQTRCLEVBQUUsZUFBMEI7UUFDeEQsTUFBTSxTQUFTLEdBQUcsRUFBRSxDQUFDO1FBQ3JCLG1CQUFtQjtRQUNuQixNQUFNLGdCQUFnQixHQUFHLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxXQUFXLENBQUMsQ0FBQztRQUM3RCxJQUFJLENBQUMsZ0JBQWdCLEVBQUU7WUFDckIsT0FBTyxTQUFTLENBQUM7U0FDbEI7UUFDRCxnQkFBZ0I7UUFDaEIsTUFBTSxDQUFDLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxDQUFDLFFBQWdCLEVBQUUsRUFBRTtZQUN6RCxhQUFhO1lBQ2IsTUFBTSxhQUFhLEdBQVUsZ0JBQWdCLENBQUMsUUFBUSxDQUFDLENBQUM7WUFDeEQsYUFBYTtZQUNiLE1BQU0sUUFBUSxHQUFHLGFBQWEsQ0FBQyxJQUFJLENBQUMsQ0FBQyxZQUFpQixFQUFFLEVBQUU7Z0JBQ3hELE9BQU8sWUFBWSxDQUFDLGNBQWMsS0FBSyxZQUFZLENBQUM7WUFDdEQsQ0FBQyxDQUFDLENBQUM7WUFDSCxJQUFJLGdCQUFnQixJQUFJLGVBQWUsRUFBRTtnQkFDdkMsZUFBZSxDQUFDLE9BQU8sQ0FBQyxDQUFDLGVBQWUsRUFBRSxFQUFFO29CQUMxQyxNQUFNLGdCQUFnQixHQUFXLFFBQVEsQ0FBQyxlQUFlLENBQUMsQ0FBQztvQkFDM0QsSUFBSSxnQkFBZ0IsSUFBSSxnQkFBZ0IsQ0FBQyxVQUFVLENBQUMsSUFBSSxDQUFDLElBQUksZ0JBQWdCLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxFQUFFO3dCQUM1RixNQUFNLFlBQVksR0FBRyxnQkFBZ0IsQ0FBQyxPQUFPLENBQUMsSUFBSSxFQUFFLEVBQUUsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxJQUFJLEVBQUUsRUFBRSxDQUFDLENBQUMsSUFBSSxFQUFFLENBQUM7d0JBQ2pGLFFBQVEsQ0FBQyxlQUFlLENBQUMsR0FBRyxnQkFBZ0IsQ0FBQyxTQUFTLENBQUMsWUFBWSxFQUFFLElBQUksQ0FBQyxDQUFDO3FCQUM1RTtnQkFDSCxDQUFDLENBQUMsQ0FBQzthQUNKO1lBQ0QsSUFBSSxRQUFRLEVBQUU7Z0JBQ1osU0FBUyxDQUFDLFFBQVEsQ0FBQyxHQUFHLFFBQVEsQ0FBQzthQUNoQztRQUNILENBQUMsQ0FBQyxDQUFDO1FBRUgsT0FBTyxTQUFTLENBQUM7SUFDbkIsQ0FBQztJQUVEOzs7T0FHRztJQUNILE1BQU0sQ0FBQyxzQkFBc0IsQ0FBQyxXQUFnQixFQUFFLFFBQWdCO1FBQzlELE9BQU87UUFDUCxPQUFPLElBQUksQ0FBQztJQUNkLENBQUM7SUFFRDs7O09BR0c7SUFDSCxNQUFNLENBQUMscUJBQXFCLENBQUMsV0FBZ0IsRUFBRSxRQUFnQixFQUFFLFlBQW9CO1FBQ25GLE9BQU87UUFDUCxPQUFPLElBQUksQ0FBQztJQUNkLENBQUM7Q0FPRjtBQUVELE9BQU8sRUFBRSxZQUFZLEVBQUUsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFOTk9UQVRJT05TLCBQUk9QX01FVEFEQVRBIH0gZnJvbSAnLi9kZWNvcmF0b3InO1xuaW1wb3J0IHsgVHJhbnNsYXRlIH0gZnJvbSAnLi4vLi4vaTE4bi9pbmRleCc7XG5cbi8qKlxuICog5YWD5pWw5o2u6Kej5p6QXG4gKiDnuqbmnZ/vvJpcbiAqIDHjgIHnsbvlnovoo4XppbDlmajvvJrlnKjmn5DkuKrnsbvlnovkuIrvvIzmn5Dnp43nsbvlnovnmoToo4XppbDlmajvvIzlj6rkvb/nlKjkuIDmrKHvvIzkuI3ph43lpI3mt7vliqDvvJtcbiAqIDLjgIHlsZ7mgKfoo4XppbDlmajvvJrlnKjmn5DkuKrlsZ7mgKfkuIrvvIzmn5Dnp43nsbvlnovnmoToo4XppbDlmajvvIzlj6rkvb/nlKjkuIDmrKHvvIzkuI3ph43lpI3mt7vliqBcbiAqL1xuY2xhc3MgTWV0YWRhdGFVdGlsIHtcblxuICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gIC8vIOexu+Wei+WFg+aVsOaNrlxuICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgLyoqXG4gICAqIOiOt+WPluexu+WFg+aVsOaNrlxuICAgKiDov5Tlm57nu5PmnpzlvaLlpoLvvJpcbiAgICogW1xuICAgKiAgIEluamVjdGFibGVcbiAgICogICBOZ1ZpZXdNb2RlbFxuICAgKiAgIE5nVmlld01vZGVsXG4gICAqIF1cbiAgICovXG4gIHN0YXRpYyBnZXRDbGFzc01ldGFkYXRhcyhjb25zdHJ1Y3RvcjogYW55KTogYW55W10ge1xuICAgIGNvbnN0IG1ldGFkYXRhcyA9IGNvbnN0cnVjdG9yW0FOTk9UQVRJT05TXTtcbiAgICByZXR1cm4gbWV0YWRhdGFzO1xuICB9XG5cbiAgLyoqXG4gICAqIOiOt+WPluafkOS4qmNsYXNz5LiK55qE5p+Q56eN6KOF6aWw5ZmoXG4gICAqIOi/lOWbnue7k+aenO+8mk5nVmlld01vZGVsXG4gICAqL1xuICBzdGF0aWMgZ2V0Q2xhc3NNZXRhZGF0YUJ5TmFtZShjb25zdHJ1Y3RvcjogYW55LCBtZXRhZGF0YU5hbWU6IHN0cmluZyk6IGFueSB7XG4gICAgY29uc3QgbWV0YWRhdGEgPSB0aGlzLmdldENsYXNzTWV0YWRhdGFCeU5hbWVXaXRoVHJhbnNsYXRlKGNvbnN0cnVjdG9yLCBtZXRhZGF0YU5hbWUsIG51bGwsIG51bGwpO1xuICAgIHJldHVybiBtZXRhZGF0YTtcbiAgfVxuXG4gIHN0YXRpYyBnZXRDbGFzc01ldGFkYXRhQnlOYW1lV2l0aFRyYW5zbGF0ZShcbiAgICBjb25zdHJ1Y3RvcjogYW55LCBtZXRhZGF0YU5hbWU6IHN0cmluZyxcbiAgICB0cmFuc2xhdGVTZXJ2aWNlPzogVHJhbnNsYXRlLCBrZXlzVG9UcmFuc2xhdGU/OiBzdHJpbmdbXSk6IGFueSB7XG4gICAgY29uc3QgYWxsQ2xhc3NNZXRhZGF0YXMgPSB0aGlzLmdldENsYXNzTWV0YWRhdGFzKGNvbnN0cnVjdG9yKTtcbiAgICBpZiAoIWFsbENsYXNzTWV0YWRhdGFzKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgY29uc3QgbWV0YWRhdGEgPSBhbGxDbGFzc01ldGFkYXRhcy5maW5kKChjbGFzc01ldGFkYXRhOiBhbnkpID0+IHtcbiAgICAgIHJldHVybiBjbGFzc01ldGFkYXRhLm5nTWV0YWRhdGFOYW1lID09PSBtZXRhZGF0YU5hbWU7XG4gICAgfSk7XG4gICAgaWYgKG1ldGFkYXRhICYmIHRyYW5zbGF0ZVNlcnZpY2UgJiYga2V5c1RvVHJhbnNsYXRlKSB7XG4gICAgICBrZXlzVG9UcmFuc2xhdGUuZm9yRWFjaCgobWV0YWRhdGFQcm9wS2V5KSA9PiB7XG4gICAgICAgIGNvbnN0IHByb3BlcnR5VmFyaWFibGU6IHN0cmluZyA9IG1ldGFkYXRhW21ldGFkYXRhUHJvcEtleV07XG4gICAgICAgIGlmIChwcm9wZXJ0eVZhcmlhYmxlICYmIHByb3BlcnR5VmFyaWFibGUuc3RhcnRzV2l0aCgne3snKSAmJiBwcm9wZXJ0eVZhcmlhYmxlLmVuZHNXaXRoKCd9fScpKSB7XG4gICAgICAgICAgY29uc3QgdHJhbnNsYXRlS2V5ID0gcHJvcGVydHlWYXJpYWJsZS5yZXBsYWNlKCd7eycsICcnKS5yZXBsYWNlKCd9fScsICcnKS50cmltKCk7XG4gICAgICAgICAgbWV0YWRhdGFbbWV0YWRhdGFQcm9wS2V5XSA9IHRyYW5zbGF0ZVNlcnZpY2UudHJhbnNmb3JtKHRyYW5zbGF0ZUtleSwgbnVsbCk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgICByZXR1cm4gbWV0YWRhdGE7XG4gIH1cblxuICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gIC8vIOWxnuaAp+WFg+aVsOaNrlxuICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgLyoqXG4gICAqIOiOt+WPluaJgOacieWxnuaAp+eahOaJgOacieWFg+aVsOaNrlxuICAgKiDov5Tlm57moLzlvI/vvJpcbiAgICoge1xuICAgKiAgIHByb3BOYW1lMTogWyBOZ0RlZmF1bHRWYWx1ZSwgTmdNYXhMZW5ndGgsIE5nTWluTGVuZ3RoXSxcbiAgICogICBwcm9wTmFtZTI6IFsgTmdEZWZhdWx0VmFsdWUsIE5nTWF4TGVuZ3RoLCBOZ01pbkxlbmd0aF1cbiAgICogfVxuICAgKi9cbiAgc3RhdGljIGdldFByb3BzTWV0YWRhdGFzKGNvbnN0cnVjdG9yOiBhbnkpOiBhbnkge1xuICAgIGNvbnN0IGFsbFByb3BNZXRhZGF0YXMgPSBjb25zdHJ1Y3RvcltQUk9QX01FVEFEQVRBXTtcbiAgICByZXR1cm4gYWxsUHJvcE1ldGFkYXRhcztcbiAgfVxuXG4gIC8qKlxuICAgKiDojrflj5bmiYDmnInlsZ7mgKfnmoTmn5DkuIDnsbvlnovnmoTlhYPmlbDmja5cbiAgICog5aaC5p6c5ZCM5LiA5bGe5oCnXG4gICAqIOi/lOWbnue7k+aenO+8mlxuICAgKiB7XG4gICAqICAgIHByb3BOYW1lMTogTmdEZWZhdWx0VmFsdWUsXG4gICAqICAgIHByb3BOYW1lMjogTmdEZWZhdWx0VmFsdWVcbiAgICogfVxuICAgKi9cbiAgc3RhdGljIGdldFByb3BzTWV0YWRhdGFzQnlOYW1lKGNvbnN0cnVjdG9yOiBhbnksIG1ldGFkYXRhTmFtZTogc3RyaW5nKTogeyBbcHJvcE5hbWU6IHN0cmluZ106IGFueSB9IHtcbiAgICBjb25zdCBtZXRhZGF0YXMgPSB0aGlzLmdldFByb3BzTWV0YWRhdGFzQnlOYW1lV2l0aFRyYW5zbGF0ZShjb25zdHJ1Y3RvciwgbWV0YWRhdGFOYW1lKTtcbiAgICByZXR1cm4gbWV0YWRhdGFzO1xuICB9XG5cbiAgc3RhdGljIGdldFByb3BzTWV0YWRhdGFzQnlOYW1lV2l0aFRyYW5zbGF0ZShcbiAgICBjb25zdHJ1Y3RvcjogYW55LCBtZXRhZGF0YU5hbWU6IHN0cmluZyxcbiAgICB0cmFuc2xhdGVTZXJ2aWNlPzogVHJhbnNsYXRlLCBrZXlzVG9UcmFuc2xhdGU/OiBzdHJpbmdbXSk6IHsgW3Byb3BOYW1lOiBzdHJpbmddOiBhbnkgfSB7XG4gICAgY29uc3QgbWV0YWRhdGFzID0ge307XG4gICAgLy8g6K+75Y+W5p6E6YCg5Ye95pWw5Lit5a2Y5YKo55qE57G75bGe5oCn5rOo6Kej44CCXG4gICAgY29uc3QgYWxsUHJvcE1ldGFkYXRhcyA9IHRoaXMuZ2V0UHJvcHNNZXRhZGF0YXMoY29uc3RydWN0b3IpO1xuICAgIGlmICghYWxsUHJvcE1ldGFkYXRhcykge1xuICAgICAgcmV0dXJuIG1ldGFkYXRhcztcbiAgICB9XG4gICAgLy8g6YGN5Y6G5omA5pyJ5bGe5oCn5o+Q5Y+W5rOo6Kej5L+h5oGv44CCXG4gICAgT2JqZWN0LmtleXMoYWxsUHJvcE1ldGFkYXRhcykuZm9yRWFjaCgocHJvcE5hbWU6IHN0cmluZykgPT4ge1xuICAgICAgLy8g5o+Q5Y+W5b2T5YmN5bGe5oCn5rOo6Kej5a+56LGhXG4gICAgICBjb25zdCBwcm9wTWV0YWRhdGFzOiBhbnlbXSA9IGFsbFByb3BNZXRhZGF0YXNbcHJvcE5hbWVdO1xuICAgICAgLy8g5o+Q5Y+W5oyH5a6a57G75Z6L55qE5rOo6Kej6aG5XG4gICAgICBjb25zdCBtZXRhZGF0YSA9IHByb3BNZXRhZGF0YXMuZmluZCgocHJvcE1ldGFkYXRhOiBhbnkpID0+IHtcbiAgICAgICAgcmV0dXJuIHByb3BNZXRhZGF0YS5uZ01ldGFkYXRhTmFtZSA9PT0gbWV0YWRhdGFOYW1lO1xuICAgICAgfSk7XG4gICAgICBpZiAodHJhbnNsYXRlU2VydmljZSAmJiBrZXlzVG9UcmFuc2xhdGUpIHtcbiAgICAgICAga2V5c1RvVHJhbnNsYXRlLmZvckVhY2goKG1ldGFkYXRhUHJvcEtleSkgPT4ge1xuICAgICAgICAgIGNvbnN0IHByb3BlcnR5VmFyaWFibGU6IHN0cmluZyA9IG1ldGFkYXRhW21ldGFkYXRhUHJvcEtleV07XG4gICAgICAgICAgaWYgKHByb3BlcnR5VmFyaWFibGUgJiYgcHJvcGVydHlWYXJpYWJsZS5zdGFydHNXaXRoKCd7eycpICYmIHByb3BlcnR5VmFyaWFibGUuZW5kc1dpdGgoJ319JykpIHtcbiAgICAgICAgICAgIGNvbnN0IHRyYW5zbGF0ZUtleSA9IHByb3BlcnR5VmFyaWFibGUucmVwbGFjZSgne3snLCAnJykucmVwbGFjZSgnfX0nLCAnJykudHJpbSgpO1xuICAgICAgICAgICAgbWV0YWRhdGFbbWV0YWRhdGFQcm9wS2V5XSA9IHRyYW5zbGF0ZVNlcnZpY2UudHJhbnNmb3JtKHRyYW5zbGF0ZUtleSwgbnVsbCk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIGlmIChtZXRhZGF0YSkge1xuICAgICAgICBtZXRhZGF0YXNbcHJvcE5hbWVdID0gbWV0YWRhdGE7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICByZXR1cm4gbWV0YWRhdGFzO1xuICB9XG5cbiAgLyoqXG4gICAqIOiOt+WPluafkOS4quWxnuaAp+eahOaJgOacieWFg+aVsOaNrlxuICAgKiDov5Tlm57moLzlvI/vvJpbIE5nRGVmYXVsdFZhbHVlLCBOZ01heExlbmd0aCwgTmdNaW5MZW5ndGhdXG4gICAqL1xuICBzdGF0aWMgZ2V0UHJvcE1ldGFkYXRhc0J5TmFtZShjb25zdHJ1Y3RvcjogYW55LCBwcm9wTmFtZTogc3RyaW5nKTogYW55W10ge1xuICAgIC8vIOaaguS4jeWunueOsFxuICAgIHJldHVybiBudWxsO1xuICB9XG5cbiAgLyoqXG4gICAqIOiOt+WPluafkOS4quWxnuaAp+eahOafkOenjeWFg+aVsOaNrlxuICAgKiDov5Tlm57moLzlvI/vvJpOZ0RlZmF1bHRWYWx1ZVxuICAgKi9cbiAgc3RhdGljIGdldFByb3BNZXRhZGF0YUJ5TmFtZShjb25zdHJ1Y3RvcjogYW55LCBwcm9wTmFtZTogc3RyaW5nLCBtZXRhZGF0YU5hbWU6IHN0cmluZyk6IGFueSB7XG4gICAgLy8g5pqC5LiN5a6e546wXG4gICAgcmV0dXJuIG51bGw7XG4gIH1cblxuXG4gIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgLy8g5Y+C5pWw5YWD5pWw5o2uXG4gIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxufVxuXG5leHBvcnQgeyBNZXRhZGF0YVV0aWwgfTtcbiJdfQ==