import { Subject } from 'rxjs';
class AppEventBus {
    /**
     * 构造函数
     */
    constructor() {
        this.eventBus = new Subject();
        this.subscriptionsMap = new Map();
    }
    triggerEvent(event) {
        this.eventBus.next(event);
    }
    subscribe(componentId, func, funcError) {
        if (this.subscriptionsMap.has(componentId) === false) {
            const subscription = this.eventBus.subscribe((value) => func(value), (value) => funcError(value));
            this.subscriptionsMap.set(componentId, subscription);
        }
    }
    unsubscribe(componentId) {
        if (this.subscriptionsMap.has(componentId) === true) {
            this.subscriptionsMap.get(componentId).unsubscribe();
            this.subscriptionsMap.delete(componentId);
        }
    }
    /**
     * 清除注册得指定key名监听器
     * @param keyStr 监听器key 默认值为listview上注册得
     * @returns
     */
    unsubscribeAllListview(keyStr = '-listview-extend') {
        if (this.subscriptionsMap.size == 0) {
            return;
        }
        // @ts-ignore: Unreachable code error
        for (let key of this.subscriptionsMap.keys()) {
            if (key.indexOf(keyStr) > 0) {
                this.subscriptionsMap.get(key).unsubscribe();
                this.subscriptionsMap.delete(key);
            }
        }
    }
}
export { AppEventBus };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXBwX2V2ZW50QnVzLmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGZhcnJpcy9tb2JpbGUtZGV2a2l0LyIsInNvdXJjZXMiOlsibGliL2FwcC9hcHBfZXZlbnRCdXMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLE9BQU8sRUFBZ0IsTUFBTSxNQUFNLENBQUM7QUFFN0MsTUFBTSxXQUFXO0lBUWY7O09BRUc7SUFDSDtRQUNFLElBQUksQ0FBQyxRQUFRLEdBQUcsSUFBSSxPQUFPLEVBQUUsQ0FBQztRQUM5QixJQUFJLENBQUMsZ0JBQWdCLEdBQUcsSUFBSSxHQUFHLEVBQXdCLENBQUM7SUFDMUQsQ0FBQztJQUVELFlBQVksQ0FBQyxLQUFVO1FBQ3JCLElBQUksQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO0lBQzVCLENBQUM7SUFFRCxTQUFTLENBQUMsV0FBbUIsRUFBRSxJQUFjLEVBQUUsU0FBb0I7UUFDakUsSUFBSSxJQUFJLENBQUMsZ0JBQWdCLENBQUMsR0FBRyxDQUFDLFdBQVcsQ0FBQyxLQUFLLEtBQUssRUFBRTtZQUNwRCxNQUFNLFlBQVksR0FBRyxJQUFJLENBQUMsUUFBUSxDQUFDLFNBQVMsQ0FDMUMsQ0FBQyxLQUFLLEVBQUUsRUFBRSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsRUFDdEIsQ0FBQyxLQUFLLEVBQUUsRUFBRSxDQUFDLFNBQVMsQ0FBQyxLQUFLLENBQUMsQ0FDNUIsQ0FBQTtZQUNELElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxHQUFHLENBQUMsV0FBVyxFQUFFLFlBQVksQ0FBQyxDQUFDO1NBQ3REO0lBQ0gsQ0FBQztJQUVELFdBQVcsQ0FBQyxXQUFtQjtRQUM3QixJQUFJLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxHQUFHLENBQUMsV0FBVyxDQUFDLEtBQUssSUFBSSxFQUFFO1lBQ25ELElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxHQUFHLENBQUMsV0FBVyxDQUFDLENBQUMsV0FBVyxFQUFFLENBQUM7WUFDckQsSUFBSSxDQUFDLGdCQUFnQixDQUFDLE1BQU0sQ0FBQyxXQUFXLENBQUMsQ0FBQztTQUMzQztJQUNILENBQUM7SUFFRDs7OztPQUlHO0lBQ0gsc0JBQXNCLENBQUMsU0FBZ0Isa0JBQWtCO1FBQ3ZELElBQUcsSUFBSSxDQUFDLGdCQUFnQixDQUFDLElBQUksSUFBSSxDQUFDLEVBQUM7WUFBRSxPQUFNO1NBQUU7UUFDN0MscUNBQXFDO1FBQ3JDLEtBQUssSUFBSSxHQUFHLElBQUksSUFBSSxDQUFDLGdCQUFnQixDQUFDLElBQUksRUFBRSxFQUFFO1lBQzVDLElBQUcsR0FBRyxDQUFDLE9BQU8sQ0FBQyxNQUFNLENBQUMsR0FBQyxDQUFDLEVBQUM7Z0JBQ3ZCLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLENBQUMsV0FBVyxFQUFFLENBQUM7Z0JBQzdDLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUM7YUFDbkM7U0FDRjtJQUNILENBQUM7Q0FDRjtBQUVELE9BQU8sRUFBRSxXQUFXLEVBQUUsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFN1YmplY3QsIFN1YnNjcmlwdGlvbiB9IGZyb20gJ3J4anMnO1xuXG5jbGFzcyBBcHBFdmVudEJ1cyB7XG4gIC8qKlxuKiBldmVudEJ1c1xuKi9cbiAgcHJpdmF0ZSBldmVudEJ1czogU3ViamVjdDxhbnk+O1xuXG4gIHByaXZhdGUgc3Vic2NyaXB0aW9uc01hcDogTWFwPHN0cmluZywgU3Vic2NyaXB0aW9uPjtcblxuICAvKipcbiAgICog5p6E6YCg5Ye95pWwXG4gICAqL1xuICBjb25zdHJ1Y3RvcigpIHtcbiAgICB0aGlzLmV2ZW50QnVzID0gbmV3IFN1YmplY3QoKTtcbiAgICB0aGlzLnN1YnNjcmlwdGlvbnNNYXAgPSBuZXcgTWFwPHN0cmluZywgU3Vic2NyaXB0aW9uPigpO1xuICB9XG5cbiAgdHJpZ2dlckV2ZW50KGV2ZW50OiBhbnkpIHtcbiAgICB0aGlzLmV2ZW50QnVzLm5leHQoZXZlbnQpO1xuICB9XG5cbiAgc3Vic2NyaWJlKGNvbXBvbmVudElkOiBzdHJpbmcsIGZ1bmM6IEZ1bmN0aW9uLCBmdW5jRXJyb3I/OiBGdW5jdGlvbikge1xuICAgIGlmICh0aGlzLnN1YnNjcmlwdGlvbnNNYXAuaGFzKGNvbXBvbmVudElkKSA9PT0gZmFsc2UpIHtcbiAgICAgIGNvbnN0IHN1YnNjcmlwdGlvbiA9IHRoaXMuZXZlbnRCdXMuc3Vic2NyaWJlKFxuICAgICAgICAodmFsdWUpID0+IGZ1bmModmFsdWUpLFxuICAgICAgICAodmFsdWUpID0+IGZ1bmNFcnJvcih2YWx1ZSlcbiAgICAgIClcbiAgICAgIHRoaXMuc3Vic2NyaXB0aW9uc01hcC5zZXQoY29tcG9uZW50SWQsIHN1YnNjcmlwdGlvbik7XG4gICAgfVxuICB9XG4gIFxuICB1bnN1YnNjcmliZShjb21wb25lbnRJZDogc3RyaW5nKSB7XG4gICAgaWYgKHRoaXMuc3Vic2NyaXB0aW9uc01hcC5oYXMoY29tcG9uZW50SWQpID09PSB0cnVlKSB7XG4gICAgICB0aGlzLnN1YnNjcmlwdGlvbnNNYXAuZ2V0KGNvbXBvbmVudElkKS51bnN1YnNjcmliZSgpO1xuICAgICAgdGhpcy5zdWJzY3JpcHRpb25zTWFwLmRlbGV0ZShjb21wb25lbnRJZCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOa4hemZpOazqOWGjOW+l+aMh+WummtleeWQjeebkeWQrOWZqFxuICAgKiBAcGFyYW0ga2V5U3RyIOebkeWQrOWZqGtleSDpu5jorqTlgLzkuLpsaXN0dmlld+S4iuazqOWGjOW+l1xuICAgKiBAcmV0dXJucyBcbiAgICovXG4gIHVuc3Vic2NyaWJlQWxsTGlzdHZpZXcoa2V5U3RyOnN0cmluZyA9ICctbGlzdHZpZXctZXh0ZW5kJyl7XG4gICAgaWYodGhpcy5zdWJzY3JpcHRpb25zTWFwLnNpemUgPT0gMCl7IHJldHVybiB9XG4gICAgLy8gQHRzLWlnbm9yZTogVW5yZWFjaGFibGUgY29kZSBlcnJvclxuICAgIGZvciAobGV0IGtleSBvZiB0aGlzLnN1YnNjcmlwdGlvbnNNYXAua2V5cygpKSB7XG4gICAgICBpZihrZXkuaW5kZXhPZihrZXlTdHIpPjApe1xuICAgICAgICB0aGlzLnN1YnNjcmlwdGlvbnNNYXAuZ2V0KGtleSkudW5zdWJzY3JpYmUoKTtcbiAgICAgICAgdGhpcy5zdWJzY3JpcHRpb25zTWFwLmRlbGV0ZShrZXkpO1xuICAgICAgfVxuICAgIH1cbiAgfVxufVxuXG5leHBvcnQgeyBBcHBFdmVudEJ1cyB9OyJdfQ==