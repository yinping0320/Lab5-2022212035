/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, Input, HostBinding, Output, EventEmitter } from '@angular/core';
import { ControlType } from '../../entity/controltype';
import { SolutionService } from '../../service/solution.service';
// import { ServerSideToken } from '@farris/ui-lookup';
// import { LookupHttpBeQueryService } from './service/Lookup-http.service';
import { of } from 'rxjs';
var HelpComponent = /** @class */ (function () {
    function HelpComponent(solutionService) {
        var _this = this;
        this.solutionService = solutionService;
        this.searchHandle = new EventEmitter();
        /**
         * 判断是否是在扩展区域展示
         */
        this.extend = false;
        /**
         * 判断是否显示label
         */
        this.showlabel = true;
        this.editable = false;
        /**
         * 多字段查询
         */
        this.enableMultiFieldSearch = false;
        /**
         * 某个字段发生值变化事件时，需要同步清空的字段，可能不是当前字段
         */
        this.changeFields = [];
        this.onSearch = (/**
         * @return {?}
         */
        function () {
            if (_this.disabled) {
                return;
            }
            _this.searchHandle.emit();
            return of(true);
        });
    }
    Object.defineProperty(HelpComponent.prototype, "isExtend", {
        get: /**
         * @return {?}
         */
        function () {
            return !this.extend && this.autoLabel;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(HelpComponent.prototype, "hidenLabel", {
        get: /**
         * @return {?}
         */
        function () {
            return !this.showlabel;
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    HelpComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        if (this.item) {
            /** @type {?} */
            var type = Object.prototype.toString.call(this.item.placeHolder);
            if (type == '[object Undefined]') {
                if (this.item.control && this.item.control.hasOwnProperty('placeholder')) {
                    this.placeholder = this.item.control.placeholder;
                }
            }
            else {
                this.placeholder = this.item.placeHolder;
            }
        }
        this.getHelpBindingInfo();
        if (this.item && this.item.control && this.item.control.hasOwnProperty('isExtend')) {
            this.extend = this.item.control.isExtend;
            if (!this.extend) {
                this.showlabel = this.item.control.showLabel;
            }
        }
        this.solutionService.addFilterEditorInstance(this.item.fieldCode, this);
        ((/** @type {?} */ (this.item.value))).clear$.subscribe((/**
         * @return {?}
         */
        function () {
            _this.textValue = '';
        }));
    };
    /**
     * @param {?} changes
     * @return {?}
     */
    HelpComponent.prototype.ngOnChanges = /**
     * @param {?} changes
     * @return {?}
     */
    function (changes) {
        var _this = this;
        this.getHelpBindingInfo();
        if (changes['changeFields'] && changes['changeFields'].currentValue && !changes['changeFields'].firstChange) {
            /** @type {?} */
            var isChange = changes['changeFields'].currentValue.some((/**
             * @param {?} field
             * @return {?}
             */
            function (field) { return field == _this.item.fieldCode; }));
            if (isChange) {
                this.textValue = ((/** @type {?} */ (this.item.value))).textValue;
            }
        }
    };
    /**
     * @param {?} selectedItem
     * @return {?}
     */
    HelpComponent.prototype.selectedDataHandler = /**
     * @param {?} selectedItem
     * @return {?}
     */
    function (selectedItem) {
        // console.log(selectedItem);
        //    let mapFields=new Function('return'+(this.item.control as HelpContol).mapFields);
        //    let mapFieldsKeys=Object.keys(mapFields());
        //    (this.item.value as HelpValue).value=new Object();
        //    mapFieldsKeys.forEach(mapFeildKey => {
        //     (this.item.value as HelpValue).value[mapFeildKey]=selectedItem[mapFeildKey];
        //    });
        //    (this.item.value as HelpValue).valueField=(this.item.control as HelpContol).valueField;
        //    let textField=(this.item.control as HelpContol).textField;
        //    this.textValue=(this.item.value as HelpValue).value[textField];
        // console.log(selectedItem);
        //    let mapFields=new Function('return'+(this.item.control as HelpContol).mapFields);
        //    let mapFieldsKeys=Object.keys(mapFields());
        //    (this.item.value as HelpValue).value=new Object();
        //    mapFieldsKeys.forEach(mapFeildKey => {
        //     (this.item.value as HelpValue).value[mapFeildKey]=selectedItem[mapFeildKey];
        //    });
        //    (this.item.value as HelpValue).valueField=(this.item.control as HelpContol).valueField;
        //    let textField=(this.item.control as HelpContol).textField;
        //    this.textValue=(this.item.value as HelpValue).value[textField];
        /** @type {?} */
        var helpValue = ((/** @type {?} */ (this.item.value)));
        helpValue.value = this.singleSelect ? [selectedItem] : selectedItem; // 单选返回对象，多选返回数组
        helpValue.valueField = this.valueField;
        helpValue.textValue = helpValue.getTextValue(this.textField);
        this.textValue = helpValue.textValue;
        // this.conditionChange.emit();
        if (this.disabled) {
            return;
        }
        this.searchHandle.emit();
    };
    /**
     * @return {?}
     */
    HelpComponent.prototype.getHelpBindingInfo = /**
     * @return {?}
     */
    function () {
        var _this = this;
        if (this.item && this.item.control && this.item.control.getControlType() == ControlType.Help) {
            /** @type {?} */
            var helpList_1 = ((/** @type {?} */ (this.item.control)));
            this.uri = helpList_1.uri;
            this.textField = helpList_1.textField;
            this.valueField = helpList_1.valueField;
            this.idField = helpList_1.idField;
            this.mapFields = helpList_1.mapFields;
            this.context = helpList_1.context;
            if (helpList_1.preEventCmd) {
                this.preEventCmd = (/**
                 * @param {?} e
                 * @return {?}
                 */
                function (e) {
                    e['hostRef'] = _this.hostRef;
                    return helpList_1.preEventCmd(e);
                });
            }
            if (helpList_1.postEventCmd) {
                this.postEventCmd = (/**
                 * @param {?} e
                 * @return {?}
                 */
                function (e) {
                    e['hostRef'] = _this.hostRef;
                    return helpList_1.postEventCmd(e);
                });
            }
            this.singleSelect = helpList_1.singleSelect;
            this.enableFullTree = helpList_1.enableFullTree;
            this.loadTreeDataType = helpList_1.loadTreeDataType;
            this.expandLevel = helpList_1.expandLevel;
            this.enableCascade = helpList_1.enableCascade;
            this.helpId = helpList_1.helpId;
            this.title = helpList_1.title;
            /** @type {?} */
            var helpValue = ((/** @type {?} */ (this.item.value)));
            this.clearFields = helpList_1.clearFields;
            // if (helpValue && helpValue.value) {
            //     // this.textValue = (this.item.value as HelpValue).value[this.textField];
            //     this.textValue = HelpValue.getPropValue(helpValue.value, this.textField.split('.'));
            // }
            this.displayType = helpList_1.displayType;
            if (helpValue.textValue == 'help-text-value-null') { // 旧数据兼容
                this.textValue = helpValue.getTextValue(this.textField);
            }
            else {
                this.textValue = helpValue.textValue;
            }
            this.editable = !!helpList_1.editable;
            this.enableMultiFieldSearch = !!helpList_1.enableMultiFieldSearch;
        }
    };
    // getConditionItemStyle(field: QueryCondition, controlType: any) {
    //     return this.solutionService.getConditionItemStyle(field,controlType);
    // }
    // getConditionItemStyle(field: QueryCondition, controlType: any) {
    //     return this.solutionService.getConditionItemStyle(field,controlType);
    // }
    /**
     * @param {?} field
     * @return {?}
     */
    HelpComponent.prototype.getConditionItemTitle = 
    // getConditionItemStyle(field: QueryCondition, controlType: any) {
    //     return this.solutionService.getConditionItemStyle(field,controlType);
    // }
    /**
     * @param {?} field
     * @return {?}
     */
    function (field) {
        return this.solutionService.getConditionItemTitle(field);
    };
    /**
     * @param {?} data
     * @return {?}
     */
    HelpComponent.prototype.clearData = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        ((/** @type {?} */ (this.item.value))).clearValue();
        this.searchHandle.emit();
    };
    HelpComponent.decorators = [
        { type: Component, args: [{
                    selector: 'app-filter-help',
                    template: "<label class=\"col-form-label\" *ngIf=\"item && showlabel\" title=\"{{getConditionItemTitle(item)}}\">\r\n    <span class=\"farris-label-info text-danger\" *ngIf=\"item.control.required\">*</span>\r\n    <span class=\"farris-label-text\">{{item.fieldName}}</span>\r\n</label>\r\n<div class=\"farris-input-wrap\" *ngIf=\"item\">\r\n    <farris-lookup-grid\r\n        id=\"{{instanceId}}\"\r\n        [uri]=\"uri\"\r\n        [title]=\"title\"\r\n        [idField]=\"idField\" \r\n        [textField]=\"textField\" \r\n        [valueField]=\"valueField\" \r\n        [(ngModel)]=\"textValue\"\r\n        [displayType]=\"displayType\"\r\n        [editable]=\"editable\"\r\n        [readonly]=\"disabled\"\r\n        (clear)=\"clearData($event)\"\r\n        (selectedData)=\"selectedDataHandler($event)\"\r\n        [placeholder]=\"placeholder\"\r\n        [mapFields]=\"mapFields\"\r\n        [dictPicking]=\"preEventCmd\"\r\n        [dictPicked]=\"postEventCmd\"\r\n        [context]=\"context\"\r\n        [enableFullTree]=\"enableFullTree\"\r\n        [loadTreeDataType]=\"loadTreeDataType\"\r\n        [singleSelect]=\"singleSelect\"\r\n        [expandLevel]=\"expandLevel\"\r\n        [enableCascade]=\"enableCascade\"\r\n        [clear-fields]=\"clearFields\"\r\n        [useFavorite]=\"true\"\r\n        [enableMultiFieldSearch]=\"enableMultiFieldSearch\"\r\n    >\r\n    </farris-lookup-grid>\r\n\r\n    <!-- [dictPicked]=\"onSearch\" -->\r\n    <!-- (selectedData)=\"selectedDataHandler($event)\" -->\r\n</div>"
                    // providers: [{ provide: ServerSideToken, useClass: LookupHttpBeQueryService }]
                }] }
    ];
    /** @nocollapse */
    HelpComponent.ctorParameters = function () { return [
        { type: SolutionService }
    ]; };
    HelpComponent.propDecorators = {
        item: [{ type: Input }],
        autoLabel: [{ type: Input }],
        disabled: [{ type: Input }],
        hostRef: [{ type: Input }],
        instanceId: [{ type: Input }],
        searchHandle: [{ type: Output }],
        isExtend: [{ type: HostBinding, args: ['class.filter-item-wrap',] }],
        hidenLabel: [{ type: HostBinding, args: ['class.filter-item-hiddenlabel',] }],
        changeFields: [{ type: Input }]
    };
    return HelpComponent;
}());
export { HelpComponent };
if (false) {
    /**
     * QueryCondition类型
     * @type {?}
     */
    HelpComponent.prototype.item;
    /** @type {?} */
    HelpComponent.prototype.autoLabel;
    /** @type {?} */
    HelpComponent.prototype.disabled;
    /** @type {?} */
    HelpComponent.prototype.hostRef;
    /** @type {?} */
    HelpComponent.prototype.instanceId;
    /** @type {?} */
    HelpComponent.prototype.searchHandle;
    /** @type {?} */
    HelpComponent.prototype.uri;
    /** @type {?} */
    HelpComponent.prototype.textField;
    /** @type {?} */
    HelpComponent.prototype.idField;
    /** @type {?} */
    HelpComponent.prototype.valueField;
    /** @type {?} */
    HelpComponent.prototype.textValue;
    /** @type {?} */
    HelpComponent.prototype.displayType;
    /** @type {?} */
    HelpComponent.prototype.mapFields;
    /** @type {?} */
    HelpComponent.prototype.context;
    /** @type {?} */
    HelpComponent.prototype.preEventCmd;
    /** @type {?} */
    HelpComponent.prototype.postEventCmd;
    /** @type {?} */
    HelpComponent.prototype.enableFullTree;
    /** @type {?} */
    HelpComponent.prototype.loadTreeDataType;
    /** @type {?} */
    HelpComponent.prototype.singleSelect;
    /** @type {?} */
    HelpComponent.prototype.expandLevel;
    /** @type {?} */
    HelpComponent.prototype.enableCascade;
    /** @type {?} */
    HelpComponent.prototype.helpId;
    /** @type {?} */
    HelpComponent.prototype.title;
    /**
     * 判断是否是在扩展区域展示
     * @type {?}
     */
    HelpComponent.prototype.extend;
    /**
     * 判断是否显示label
     * @type {?}
     */
    HelpComponent.prototype.showlabel;
    /** @type {?} */
    HelpComponent.prototype.placeholder;
    /** @type {?} */
    HelpComponent.prototype.editable;
    /**
     * 多字段查询
     * @type {?}
     */
    HelpComponent.prototype.enableMultiFieldSearch;
    /**
     * 某个字段发生值变化事件时，需要同步清空的字段，可能不是当前字段
     * @type {?}
     */
    HelpComponent.prototype.changeFields;
    /**
     * 要清空的关联字段
     * @type {?}
     */
    HelpComponent.prototype.clearFields;
    /** @type {?} */
    HelpComponent.prototype.onSearch;
    /**
     * @type {?}
     * @private
     */
    HelpComponent.prototype.solutionService;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaGVscC5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZmFycmlzL3VpLWxpc3QtZmlsdGVyLyIsInNvdXJjZXMiOlsibGliL2NvbnRyb2xjb21wb25lbnQvaGVscGNvbXBvbmVudC50cy9oZWxwLmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7O0FBQUEsT0FBTyxFQUFFLFNBQVMsRUFBRSxLQUFLLEVBQXFCLFdBQVcsRUFBRSxNQUFNLEVBQUUsWUFBWSxFQUFpQixNQUFNLGVBQWUsQ0FBQztBQUV0SCxPQUFPLEVBQUUsV0FBVyxFQUFFLE1BQU0sMEJBQTBCLENBQUM7QUFHdkQsT0FBTyxFQUFFLGVBQWUsRUFBRSxNQUFNLGdDQUFnQyxDQUFDOzs7QUFNakUsT0FBTyxFQUFFLEVBQUUsRUFBRSxNQUFNLE1BQU0sQ0FBQztBQUUxQjtJQWlFSSx1QkFBb0IsZUFBZ0M7UUFBcEQsaUJBQXlEO1FBQXJDLG9CQUFlLEdBQWYsZUFBZSxDQUFpQjtRQTlDMUMsaUJBQVksR0FBRyxJQUFJLFlBQVksRUFBRSxDQUFDOzs7O1FBcUI1QyxXQUFNLEdBQUcsS0FBSyxDQUFDOzs7O1FBRWYsY0FBUyxHQUFHLElBQUksQ0FBQztRQUdqQixhQUFRLEdBQUcsS0FBSyxDQUFDOzs7O1FBRWpCLDJCQUFzQixHQUFHLEtBQUssQ0FBQzs7OztRQWF0QixpQkFBWSxHQUFrQixFQUFFLENBQUM7UUEwSDFDLGFBQVE7OztRQUFHO1lBQ1AsSUFBSSxLQUFJLENBQUMsUUFBUSxFQUFFO2dCQUFFLE9BQU87YUFBRTtZQUM5QixLQUFJLENBQUMsWUFBWSxDQUFDLElBQUksRUFBRSxDQUFDO1lBQ3pCLE9BQU8sRUFBRSxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQ3BCLENBQUMsRUFBQTtJQXpIdUQsQ0FBQztJQWhCekQsc0JBQ0ksbUNBQVE7Ozs7UUFEWjtZQUVJLE9BQU8sQ0FBQyxJQUFJLENBQUMsTUFBTSxJQUFJLElBQUksQ0FBQyxTQUFTLENBQUM7UUFDMUMs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QUM1QixpQ0FBMkI7O0lBRTNCLGdDQUFzQjs7SUFFdEIsbUNBQTRCOztJQUU1QixxQ0FBNEM7O0lBRTVDLDRCQUFZOztJQUNaLGtDQUFrQjs7SUFDbEIsZ0NBQWdCOztJQUNoQixtQ0FBZ0I7O0lBQ2hCLGtDQUFlOztJQUNmLG9DQUF5Qjs7SUFDekIsa0NBQWU7O0lBQ2YsZ0NBQWE7O0lBQ2Isb0NBQWlCOztJQUNqQixxQ0FBa0I7O0lBQ2xCLHVDQUF3Qjs7SUFDeEIseUNBQXNEOztJQUN0RCxxQ0FBc0I7O0lBQ3RCLG9DQUFvQjs7SUFDcEIsc0NBQXVCOztJQUN2QiwrQkFBZTs7SUFDZiw4QkFBYzs7Ozs7SUFHZCwrQkFBZTs7Ozs7SUFFZixrQ0FBaUI7O0lBQ2pCLG9DQUFvQjs7SUFFcEIsaUNBQWlCOzs7OztJQUVqQiwrQ0FBK0I7Ozs7O0lBYS9CLHFDQUEwQzs7Ozs7SUFJMUMsb0NBQW9COztJQXNIcEIsaUNBSUM7Ozs7O0lBekhXLHdDQUF3QyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbXBvbmVudCwgSW5wdXQsIE9uSW5pdCwgT25DaGFuZ2VzLCBIb3N0QmluZGluZywgT3V0cHV0LCBFdmVudEVtaXR0ZXIsIFNpbXBsZUNoYW5nZXMgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgUXVlcnlDb25kaXRpb24gfSBmcm9tICcuLi8uLi9lbnRpdHkvcXVlcnljb25kaXRpb24nO1xyXG5pbXBvcnQgeyBDb250cm9sVHlwZSB9IGZyb20gJy4uLy4uL2VudGl0eS9jb250cm9sdHlwZSc7XHJcbmltcG9ydCB7IEhlbHBDb250b2wgfSBmcm9tICcuLi8uLi9lbnRpdHkvY29udHJvbHR5cGUvaGVscC9oZWxwY29udHJvbCc7XHJcbmltcG9ydCB7IElDb250cm9sIH0gZnJvbSAnLi4vLi4vZW50aXR5L2NvbnRyb2x0eXBlL2ljb250cm9sJztcclxuaW1wb3J0IHsgU29sdXRpb25TZXJ2aWNlIH0gZnJvbSAnLi4vLi4vc2VydmljZS9zb2x1dGlvbi5zZXJ2aWNlJztcclxuaW1wb3J0IHsgSGVscFZhbHVlIH0gZnJvbSAnLi4vLi4vZW50aXR5L2NvbmRpdGlvbnZhbHVlL2hlbHB2YWx1ZSc7XHJcbmltcG9ydCB7IERpc3BsYXlUeXBlIH0gZnJvbSAnLi4vLi4vZW50aXR5L2NvbnRyb2x0eXBlL2hlbHAvZGlzcGxheVR5cGUnO1xyXG5cclxuLy8gaW1wb3J0IHsgU2VydmVyU2lkZVRva2VuIH0gZnJvbSAnQGZhcnJpcy91aS1sb29rdXAnO1xyXG4vLyBpbXBvcnQgeyBMb29rdXBIdHRwQmVRdWVyeVNlcnZpY2UgfSBmcm9tICcuL3NlcnZpY2UvTG9va3VwLWh0dHAuc2VydmljZSc7XHJcbmltcG9ydCB7IG9mIH0gZnJvbSAncnhqcyc7XHJcblxyXG5AQ29tcG9uZW50KHtcclxuICAgIHNlbGVjdG9yOiAnYXBwLWZpbHRlci1oZWxwJyxcclxuICAgIHRlbXBsYXRlVXJsOiAnLi9oZWxwLmNvbXBvbmVudC5odG1sJ1xyXG4gICAgLy8gcHJvdmlkZXJzOiBbeyBwcm92aWRlOiBTZXJ2ZXJTaWRlVG9rZW4sIHVzZUNsYXNzOiBMb29rdXBIdHRwQmVRdWVyeVNlcnZpY2UgfV1cclxufSlcclxuXHJcbmV4cG9ydCBjbGFzcyBIZWxwQ29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0LCBPbkNoYW5nZXMge1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogUXVlcnlDb25kaXRpb27nsbvlnotcclxuICAgICAqL1xyXG4gICAgQElucHV0KCkgaXRlbTogYW55O1xyXG4gICAgQElucHV0KCkgYXV0b0xhYmVsOiBib29sZWFuO1xyXG4gICAgQElucHV0KCkgZGlzYWJsZWQ6IGJvb2xlYW47XHJcblxyXG4gICAgQElucHV0KCkgaG9zdFJlZjogYW55O1xyXG5cclxuICAgIEBJbnB1dCgpIGluc3RhbmNlSWQ6IHN0cmluZztcclxuXHJcbiAgICBAT3V0cHV0KCkgc2VhcmNoSGFuZGxlID0gbmV3IEV2ZW50RW1pdHRlcigpO1xyXG5cclxuICAgIHVyaTogc3RyaW5nO1xyXG4gICAgdGV4dEZpZWxkOiBzdHJpbmc7XHJcbiAgICBpZEZpZWxkOiBzdHJpbmc7XHJcbiAgICB2YWx1ZUZpZWxkOiBhbnk7XHJcbiAgICB0ZXh0VmFsdWU6IGFueTtcclxuICAgIGRpc3BsYXlUeXBlOiBEaXNwbGF5VHlwZTtcclxuICAgIG1hcEZpZWxkczogYW55O1xyXG4gICAgY29udGV4dDogYW55O1xyXG4gICAgcHJlRXZlbnRDbWQ6IGFueTtcclxuICAgIHBvc3RFdmVudENtZDogYW55O1xyXG4gICAgZW5hYmxlRnVsbFRyZWU6IGJvb2xlYW47XHJcbiAgICBsb2FkVHJlZURhdGFUeXBlOiAnZGVmYXVsdCcgfCAnbG9hZGFsbCcgfCAnbGF5ZXJsb2FkJztcclxuICAgIHNpbmdsZVNlbGVjdDogYm9vbGVhbjtcclxuICAgIGV4cGFuZExldmVsOiBudW1iZXI7XHJcbiAgICBlbmFibGVDYXNjYWRlOiBib29sZWFuO1xyXG4gICAgaGVscElkOiBzdHJpbmc7XHJcbiAgICB0aXRsZTogc3RyaW5nO1xyXG5cclxuICAgIC8qKiDliKTmlq3mmK/lkKbmmK/lnKjmianlsZXljLrln5/lsZXnpLogKi9cclxuICAgIGV4dGVuZCA9IGZhbHNlO1xyXG4gICAgLyoqIOWIpOaWreaYr+WQpuaYvuekumxhYmVsICovXHJcbiAgICBzaG93bGFiZWwgPSB0cnVlO1xyXG4gICAgcGxhY2Vob2xkZXI6IHN0cmluZztcclxuXHJcbiAgICBlZGl0YWJsZSA9IGZhbHNlO1xyXG4gICAgLyoqIOWkmuWtl+auteafpeivoiAqL1xyXG4gICAgZW5hYmxlTXVsdGlGaWVsZFNlYXJjaCA9IGZhbHNlO1xyXG5cclxuICAgIEBIb3N0QmluZGluZygnY2xhc3MuZmlsdGVyLWl0ZW0td3JhcCcpXHJcbiAgICBnZXQgaXNFeHRlbmQoKTogYm9vbGVhbiB7XHJcbiAgICAgICAgcmV0dXJuICF0aGlzLmV4dGVuZCAmJiB0aGlzLmF1dG9MYWJlbDtcclxuICAgIH1cclxuICAgIEBIb3N0QmluZGluZygnY2xhc3MuZmlsdGVyLWl0ZW0taGlkZGVubGFiZWwnKVxyXG4gICAgZ2V0IGhpZGVuTGFiZWwoKTogYm9vbGVhbiB7XHJcbiAgICAgICAgcmV0dXJuICF0aGlzLnNob3dsYWJlbDtcclxuICAgIH1cclxuICAgICAgLyoqXHJcbiAgICAgKiDmn5DkuKrlrZfmrrXlj5HnlJ/lgLzlj5jljJbkuovku7bml7bvvIzpnIDopoHlkIzmraXmuIXnqbrnmoTlrZfmrrXvvIzlj6/og73kuI3mmK/lvZPliY3lrZfmrrVcclxuICAgICAqL1xyXG4gICAgQElucHV0KCkgY2hhbmdlRmllbGRzOiBBcnJheTxzdHJpbmc+ID0gW107XHJcbiAgICAvKipcclxuICAgICAqIOimgea4heepuueahOWFs+iBlOWtl+autVxyXG4gICAgICovXHJcbiAgICBjbGVhckZpZWxkczogc3RyaW5nO1xyXG4gICAgY29uc3RydWN0b3IocHJpdmF0ZSBzb2x1dGlvblNlcnZpY2U6IFNvbHV0aW9uU2VydmljZSkgeyB9XHJcblxyXG4gICAgbmdPbkluaXQoKTogdm9pZCB7XHJcbiAgICAgICAgaWYgKHRoaXMuaXRlbSkge1xyXG4gICAgICAgICAgICBjb25zdCB0eXBlID0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKHRoaXMuaXRlbS5wbGFjZUhvbGRlcik7XHJcbiAgICAgICAgICAgIGlmICh0eXBlID09ICdbb2JqZWN0IFVuZGVmaW5lZF0nKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5pdGVtLmNvbnRyb2wgJiYgdGhpcy5pdGVtLmNvbnRyb2wuaGFzT3duUHJvcGVydHkoJ3BsYWNlaG9sZGVyJykpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsYWNlaG9sZGVyID0gdGhpcy5pdGVtLmNvbnRyb2wucGxhY2Vob2xkZXI7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnBsYWNlaG9sZGVyID0gdGhpcy5pdGVtLnBsYWNlSG9sZGVyO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuZ2V0SGVscEJpbmRpbmdJbmZvKCk7XHJcbiAgICAgICAgaWYgKHRoaXMuaXRlbSAmJiB0aGlzLml0ZW0uY29udHJvbCAmJiB0aGlzLml0ZW0uY29udHJvbC5oYXNPd25Qcm9wZXJ0eSgnaXNFeHRlbmQnKSkge1xyXG4gICAgICAgICAgICB0aGlzLmV4dGVuZCA9IHRoaXMuaXRlbS5jb250cm9sLmlzRXh0ZW5kO1xyXG4gICAgICAgICAgICBpZiAoIXRoaXMuZXh0ZW5kKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNob3dsYWJlbCA9IHRoaXMuaXRlbS5jb250cm9sLnNob3dMYWJlbDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5zb2x1dGlvblNlcnZpY2UuYWRkRmlsdGVyRWRpdG9ySW5zdGFuY2UodGhpcy5pdGVtLmZpZWxkQ29kZSwgdGhpcyk7XHJcblxyXG4gICAgICAgICh0aGlzLml0ZW0udmFsdWUgYXMgSGVscFZhbHVlKS5jbGVhciQuc3Vic2NyaWJlKCgpID0+IHtcclxuICAgICAgICAgICAgdGhpcy50ZXh0VmFsdWUgPSAnJztcclxuICAgICAgICB9KTtcclxuICAgICAgICBcclxuICAgIH1cclxuXHJcbiAgICBuZ09uQ2hhbmdlcyhjaGFuZ2VzOiBTaW1wbGVDaGFuZ2VzKTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy5nZXRIZWxwQmluZGluZ0luZm8oKTtcclxuICAgICAgICBpZihjaGFuZ2VzWydjaGFuZ2VGaWVsZHMnXSAmJiBjaGFuZ2VzWydjaGFuZ2VGaWVsZHMnXS5jdXJyZW50VmFsdWUgJiYgIWNoYW5nZXNbJ2NoYW5nZUZpZWxkcyddLmZpcnN0Q2hhbmdlKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGlzQ2hhbmdlID0gY2hhbmdlc1snY2hhbmdlRmllbGRzJ10uY3VycmVudFZhbHVlLnNvbWUoZmllbGQgPT4gZmllbGQgPT0gdGhpcy5pdGVtLmZpZWxkQ29kZSk7XHJcbiAgICAgICAgICAgIGlmKGlzQ2hhbmdlKXtcclxuICAgICAgICAgICAgICAgIHRoaXMudGV4dFZhbHVlID0gKHRoaXMuaXRlbS52YWx1ZSBhcyBIZWxwVmFsdWUpLnRleHRWYWx1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBzZWxlY3RlZERhdGFIYW5kbGVyKHNlbGVjdGVkSXRlbTogYW55KSB7XHJcbiAgICAgICAgLy8gY29uc29sZS5sb2coc2VsZWN0ZWRJdGVtKTtcclxuICAgICAgICAvLyAgICBsZXQgbWFwRmllbGRzPW5ldyBGdW5jdGlvbigncmV0dXJuJysodGhpcy5pdGVtLmNvbnRyb2wgYXMgSGVscENvbnRvbCkubWFwRmllbGRzKTtcclxuICAgICAgICAvLyAgICBsZXQgbWFwRmllbGRzS2V5cz1PYmplY3Qua2V5cyhtYXBGaWVsZHMoKSk7XHJcbiAgICAgICAgLy8gICAgKHRoaXMuaXRlbS52YWx1ZSBhcyBIZWxwVmFsdWUpLnZhbHVlPW5ldyBPYmplY3QoKTtcclxuICAgICAgICAvLyAgICBtYXBGaWVsZHNLZXlzLmZvckVhY2gobWFwRmVpbGRLZXkgPT4ge1xyXG4gICAgICAgIC8vICAgICAodGhpcy5pdGVtLnZhbHVlIGFzIEhlbHBWYWx1ZSkudmFsdWVbbWFwRmVpbGRLZXldPXNlbGVjdGVkSXRlbVttYXBGZWlsZEtleV07XHJcbiAgICAgICAgLy8gICAgfSk7XHJcbiAgICAgICAgLy8gICAgKHRoaXMuaXRlbS52YWx1ZSBhcyBIZWxwVmFsdWUpLnZhbHVlRmllbGQ9KHRoaXMuaXRlbS5jb250cm9sIGFzIEhlbHBDb250b2wpLnZhbHVlRmllbGQ7XHJcbiAgICAgICAgLy8gICAgbGV0IHRleHRGaWVsZD0odGhpcy5pdGVtLmNvbnRyb2wgYXMgSGVscENvbnRvbCkudGV4dEZpZWxkO1xyXG4gICAgICAgIC8vICAgIHRoaXMudGV4dFZhbHVlPSh0aGlzLml0ZW0udmFsdWUgYXMgSGVscFZhbHVlKS52YWx1ZVt0ZXh0RmllbGRdO1xyXG5cclxuICAgICAgICBjb25zdCBoZWxwVmFsdWUgPSAodGhpcy5pdGVtLnZhbHVlIGFzIEhlbHBWYWx1ZSk7XHJcbiAgICAgICAgaGVscFZhbHVlLnZhbHVlID0gdGhpcy5zaW5nbGVTZWxlY3QgPyBbc2VsZWN0ZWRJdGVtXSA6IHNlbGVjdGVkSXRlbTsgLy8g5Y2V6YCJ6L+U5Zue5a+56LGh77yM5aSa6YCJ6L+U5Zue5pWw57uEXHJcbiAgICAgICAgaGVscFZhbHVlLnZhbHVlRmllbGQgPSB0aGlzLnZhbHVlRmllbGQ7XHJcbiAgICAgICAgaGVscFZhbHVlLnRleHRWYWx1ZSA9IGhlbHBWYWx1ZS5nZXRUZXh0VmFsdWUodGhpcy50ZXh0RmllbGQpO1xyXG4gICAgICAgIHRoaXMudGV4dFZhbHVlID0gaGVscFZhbHVlLnRleHRWYWx1ZTtcclxuICAgICAgICAvLyB0aGlzLmNvbmRpdGlvbkNoYW5nZS5lbWl0KCk7XHJcbiAgICAgICAgaWYgKHRoaXMuZGlzYWJsZWQpIHsgcmV0dXJuOyB9XHJcbiAgICAgICAgdGhpcy5zZWFyY2hIYW5kbGUuZW1pdCgpO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBnZXRIZWxwQmluZGluZ0luZm8oKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuaXRlbSAmJiB0aGlzLml0ZW0uY29udHJvbCAmJiB0aGlzLml0ZW0uY29udHJvbC5nZXRDb250cm9sVHlwZSgpID09IENvbnRyb2xUeXBlLkhlbHApIHtcclxuICAgICAgICAgICAgY29uc3QgaGVscExpc3QgPSAodGhpcy5pdGVtLmNvbnRyb2wgYXMgSGVscENvbnRvbCk7XHJcbiAgICAgICAgICAgIHRoaXMudXJpID0gaGVscExpc3QudXJpO1xyXG4gICAgICAgICAgICB0aGlzLnRleHRGaWVsZCA9IGhlbHBMaXN0LnRleHRGaWVsZDtcclxuICAgICAgICAgICAgdGhpcy52YWx1ZUZpZWxkID0gaGVscExpc3QudmFsdWVGaWVsZDtcclxuICAgICAgICAgICAgdGhpcy5pZEZpZWxkID0gaGVscExpc3QuaWRGaWVsZDtcclxuICAgICAgICAgICAgdGhpcy5tYXBGaWVsZHMgPSBoZWxwTGlzdC5tYXBGaWVsZHM7XHJcbiAgICAgICAgICAgIHRoaXMuY29udGV4dCA9IGhlbHBMaXN0LmNvbnRleHQ7XHJcbiAgICAgICAgICAgIGlmIChoZWxwTGlzdC5wcmVFdmVudENtZCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5wcmVFdmVudENtZCA9IChlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgZVsnaG9zdFJlZiddID0gdGhpcy5ob3N0UmVmO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBoZWxwTGlzdC5wcmVFdmVudENtZChlKTtcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmIChoZWxwTGlzdC5wb3N0RXZlbnRDbWQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMucG9zdEV2ZW50Q21kID0gKGUpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBlWydob3N0UmVmJ10gPSB0aGlzLmhvc3RSZWY7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGhlbHBMaXN0LnBvc3RFdmVudENtZChlKTtcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5zaW5nbGVTZWxlY3QgPSBoZWxwTGlzdC5zaW5nbGVTZWxlY3Q7XHJcbiAgICAgICAgICAgIHRoaXMuZW5hYmxlRnVsbFRyZWUgPSBoZWxwTGlzdC5lbmFibGVGdWxsVHJlZTtcclxuICAgICAgICAgICAgdGhpcy5sb2FkVHJlZURhdGFUeXBlID0gaGVscExpc3QubG9hZFRyZWVEYXRhVHlwZTtcclxuICAgICAgICAgICAgdGhpcy5leHBhbmRMZXZlbCA9IGhlbHBMaXN0LmV4cGFuZExldmVsO1xyXG4gICAgICAgICAgICB0aGlzLmVuYWJsZUNhc2NhZGUgPSBoZWxwTGlzdC5lbmFibGVDYXNjYWRlO1xyXG4gICAgICAgICAgICB0aGlzLmhlbHBJZCA9IGhlbHBMaXN0LmhlbHBJZDtcclxuICAgICAgICAgICAgdGhpcy50aXRsZSA9IGhlbHBMaXN0LnRpdGxlO1xyXG4gICAgICAgICAgICBjb25zdCBoZWxwVmFsdWUgPSAodGhpcy5pdGVtLnZhbHVlIGFzIEhlbHBWYWx1ZSk7XHJcbiAgICAgICAgICAgIHRoaXMuY2xlYXJGaWVsZHMgPSBoZWxwTGlzdC5jbGVhckZpZWxkcztcclxuICAgICAgICAgICAgLy8gaWYgKGhlbHBWYWx1ZSAmJiBoZWxwVmFsdWUudmFsdWUpIHtcclxuICAgICAgICAgICAgLy8gICAgIC8vIHRoaXMudGV4dFZhbHVlID0gKHRoaXMuaXRlbS52YWx1ZSBhcyBIZWxwVmFsdWUpLnZhbHVlW3RoaXMudGV4dEZpZWxkXTtcclxuICAgICAgICAgICAgLy8gICAgIHRoaXMudGV4dFZhbHVlID0gSGVscFZhbHVlLmdldFByb3BWYWx1ZShoZWxwVmFsdWUudmFsdWUsIHRoaXMudGV4dEZpZWxkLnNwbGl0KCcuJykpO1xyXG4gICAgICAgICAgICAvLyB9XHJcbiAgICAgICAgICAgIHRoaXMuZGlzcGxheVR5cGUgPSBoZWxwTGlzdC5kaXNwbGF5VHlwZTtcclxuICAgICAgICAgICAgaWYgKGhlbHBWYWx1ZS50ZXh0VmFsdWUgPT0gJ2hlbHAtdGV4dC12YWx1ZS1udWxsJykgey8vIOaXp+aVsOaNruWFvOWuuVxyXG4gICAgICAgICAgICAgICAgdGhpcy50ZXh0VmFsdWUgPSBoZWxwVmFsdWUuZ2V0VGV4dFZhbHVlKHRoaXMudGV4dEZpZWxkKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHRoaXMudGV4dFZhbHVlID0gaGVscFZhbHVlLnRleHRWYWx1ZTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdGhpcy5lZGl0YWJsZSA9ICEhaGVscExpc3QuZWRpdGFibGU7XHJcbiAgICAgICAgICAgIHRoaXMuZW5hYmxlTXVsdGlGaWVsZFNlYXJjaCA9ICEhaGVscExpc3QuZW5hYmxlTXVsdGlGaWVsZFNlYXJjaDtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy8gZ2V0Q29uZGl0aW9uSXRlbVN0eWxlKGZpZWxkOiBRdWVyeUNvbmRpdGlvbiwgY29udHJvbFR5cGU6IGFueSkge1xyXG4gICAgLy8gICAgIHJldHVybiB0aGlzLnNvbHV0aW9uU2VydmljZS5nZXRDb25kaXRpb25JdGVtU3R5bGUoZmllbGQsY29udHJvbFR5cGUpO1xyXG4gICAgLy8gfVxyXG5cclxuICAgIGdldENvbmRpdGlvbkl0ZW1UaXRsZShmaWVsZDogUXVlcnlDb25kaXRpb24pIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5zb2x1dGlvblNlcnZpY2UuZ2V0Q29uZGl0aW9uSXRlbVRpdGxlKGZpZWxkKTtcclxuICAgIH1cclxuXHJcbiAgICBvblNlYXJjaCA9ICgpID0+IHtcclxuICAgICAgICBpZiAodGhpcy5kaXNhYmxlZCkgeyByZXR1cm47IH1cclxuICAgICAgICB0aGlzLnNlYXJjaEhhbmRsZS5lbWl0KCk7XHJcbiAgICAgICAgcmV0dXJuIG9mKHRydWUpO1xyXG4gICAgfVxyXG5cclxuICAgIGNsZWFyRGF0YShkYXRhOiBhbnkpIHtcclxuICAgICAgICAodGhpcy5pdGVtLnZhbHVlIGFzIEhlbHBWYWx1ZSkuY2xlYXJWYWx1ZSgpO1xyXG4gICAgICAgIHRoaXMuc2VhcmNoSGFuZGxlLmVtaXQoKTtcclxuICAgIH1cclxuXHJcbn1cclxuIl19