/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, Input, Output, EventEmitter, ElementRef, ViewChild, Renderer2, ViewEncapsulation, Optional, NgZone, Injector } from '@angular/core';
import ResizeObserver from "resize-observer-polyfill";
import { ViewChangeService } from './view-change.service';
var ViewChangeComponent = /** @class */ (function () {
    function ViewChangeComponent(_renderer, viewChangeService, inject) {
        this._renderer = _renderer;
        this.viewChangeService = viewChangeService;
        this.inject = inject;
        // 视图类型的呈现方式，tile小磁贴类型，dropdown下拉类型
        this.viewType = 'tile';
        // 视图组
        this.viewGroupId = 'default';
        // 视图类型切换时，抛出的事件
        this.toolTypeChange = new EventEmitter();
        // 记录Module的标记，用来获取当前module下的服务
        this.guid = "";
        // 处理ngzone
        this.ngZone = null;
        // 记录元素尺寸变更
        this.ro = null;
        if (!this.viewChangeService) {
            this.viewChangeService = new ViewChangeService();
        }
    }
    /**
     * @return {?}
     */
    ViewChangeComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this.guid = this.viewChangeService.createViewChangeCmp({ groupId: this.viewGroupId, count: this.toolbarData.length }, this.viewchangewrapper.nativeElement.parentElement);
        this.viewChangeManageSer = this.viewChangeService.getModuleInfo(this.guid);
        if (this.toolbarData && this.toolbarData.length) {
            if (this.defaultType) {
                /** @type {?} */
                var item = this.toolbarData.find((/**
                 * @param {?} bar
                 * @return {?}
                 */
                function (bar) {
                    return bar['type'] === _this.defaultType;
                }));
                this.activeTypeItem = item;
                this.toolTypeChange.emit(this.activeTypeItem);
            }
            else {
                this.activeTypeItem = this.toolbarData[0];
                this.toolTypeChange.emit(this.activeTypeItem);
            }
        }
    };
    /**
     * @return {?}
     */
    ViewChangeComponent.prototype.ngAfterViewInit = /**
     * @return {?}
     */
    function () {
        this.observerElement();
    };
    /**
     * @return {?}
     */
    ViewChangeComponent.prototype.ngOnDestroy = /**
     * @return {?}
     */
    function () {
        if (this.ro) {
            this.ro.unobserve(this.viewchangewrapper.nativeElement);
            this.ro = null;
        }
    };
    /**
     * @param {?} item
     * @return {?}
     */
    ViewChangeComponent.prototype.listItemClick = /**
     * @param {?} item
     * @return {?}
     */
    function (item) {
        if (item.disable || this.activeTypeItem['type'] === item['type']) {
            return;
        }
        this.activeTypeItem = item;
        this.viewChangeManageSer.updateCurrentViewId(this.activeTypeItem['type'], this.viewGroupId);
        this.toolTypeChange.emit(item);
        if (this.typelist) {
            this._renderer.setStyle(this.typelist.nativeElement, 'display', 'none');
        }
    };
    /**
     * @return {?}
     */
    ViewChangeComponent.prototype.dropdownMouseEnter = /**
     * @return {?}
     */
    function () {
        this._renderer.setStyle(this.typelist.nativeElement, 'display', 'block');
    };
    /**
     * @return {?}
     */
    ViewChangeComponent.prototype.dropdownMouseLeave = /**
     * @return {?}
     */
    function () {
        this._renderer.setStyle(this.typelist.nativeElement, 'display', 'none');
    };
    /**
     * 解决卡片和列表两个菜单同时打开，同步数据时候，当前的标签显示不对的问题
     */
    /**
     * 解决卡片和列表两个菜单同时打开，同步数据时候，当前的标签显示不对的问题
     * @private
     * @return {?}
     */
    ViewChangeComponent.prototype.observerElement = /**
     * 解决卡片和列表两个菜单同时打开，同步数据时候，当前的标签显示不对的问题
     * @private
     * @return {?}
     */
    function () {
        var _this = this;
        if (!this.inject) {
            // 初始更新一次当前类型
            this.viewChangeManageSer['changeCurrentViewIdFromCMP'](this.activeTypeItem['type'], this.viewGroupId);
            return;
        }
        if (!this.ngZone) {
            this.ngZone = this.inject.get(NgZone, null);
        }
        if (!this.ro) {
            this.ngZone.runOutsideAngular((/**
             * @return {?}
             */
            function () {
                _this.ro = new ResizeObserver((/**
                 * @param {?} entries
                 * @param {?} observer
                 * @return {?}
                 */
                function (entries, observer) {
                    if (entries[0].contentRect.width > 0) {
                        _this.viewChangeManageSer['changeCurrentViewIdFromCMP'](_this.activeTypeItem['type'], _this.viewGroupId);
                    }
                }));
                _this.ro.observe(_this.viewchangewrapper.nativeElement);
            }));
        }
    };
    ViewChangeComponent.decorators = [
        { type: Component, args: [{
                    selector: 'farris-view-change',
                    template: "<div class=\"f-view-change\" #viewchangewrapper>\r\n    <div class=\"f-view-change-tile\" *ngIf=\"viewType === 'tile'; else dropdown\">\r\n        <div class=\"f-view-change-tile-btn\" *ngFor=\"let item of toolbarData\" [ngClass]=\"{'tile-btn-active': item.type === activeTypeItem.type,'tile-btn-disable': item.disable}\" (click)=\"listItemClick(item)\" [title]=\"item.title\">\r\n            <span class=\"tile-btn-icon {{item.iconName}}\"></span>\r\n        </div>\r\n    </div>\r\n    <ng-template #dropdown>\r\n        <div class=\"f-view-change-dropdown\" \r\n        (mouseenter)=\"dropdownMouseEnter()\"\r\n        (mouseleave)=\"dropdownMouseLeave()\"> \r\n            <div class=\"f-view-change-toggle\" *ngIf=\"this.toolbarData.length\">\r\n                <span class=\"toggle-btn-icon {{activeTypeItem.iconName}}\"></span>\r\n            </div>\r\n            <div class=\"f-view-change-typelist\" #typelist>\r\n                <div class=\"f-view-change-typelist-content\">\r\n                    <div class=\"f-view-change-typelist-arrow\"></div>\r\n                    <ul class=\"f-view-change-typelist-list\">\r\n                        <li class=\"typelist-item\" *ngFor=\"let item of toolbarData\" [ngClass]=\"{'typelist-item-active': item.type === activeTypeItem.type,'typelist-item-disable': item.disable}\" (click)=\"listItemClick(item)\">\r\n                                <span class=\"typelist-item-icon {{item.iconName}}\"></span>\r\n                                <span class=\"typelist-item-title\">{{item.title}}</span>\r\n                            </li>\r\n                    </ul>\r\n                </div>\r\n            </div>\r\n            <!-- <ul class=\"f-view-change-typelist\" #typelist>\r\n                <li class=\"f-view-change-typelist-arrow\"></li>\r\n                <li class=\"typelist-item\" *ngFor=\"let item of toolbarData\" [ngClass]=\"{'typelist-item-active': item.type === activeTypeItem.type,'typelist-item-disable': item.disable}\" (click)=\"listItemClick(item)\">\r\n                    <span class=\"typelist-item-icon {{item.iconName}}\"></span>\r\n                    <span class=\"typelist-item-title\">{{item.title}}</span>\r\n                </li>\r\n            </ul> -->\r\n        </div>\r\n    </ng-template>\r\n</div>",
                    encapsulation: ViewEncapsulation.None
                    // providers:[ ViewChangeService ]
                    ,
                    styles: [".f-viewchange-view-none{display:none!important}"]
                }] }
    ];
    /** @nocollapse */
    ViewChangeComponent.ctorParameters = function () { return [
        { type: Renderer2 },
        { type: ViewChangeService, decorators: [{ type: Optional }] },
        { type: Injector, decorators: [{ type: Optional }] }
    ]; };
    ViewChangeComponent.propDecorators = {
        toolbarData: [{ type: Input }],
        viewType: [{ type: Input }],
        defaultType: [{ type: Input }],
        viewGroupId: [{ type: Input }],
        toolTypeChange: [{ type: Output }],
        typelist: [{ type: ViewChild, args: ['typelist',] }],
        viewchangewrapper: [{ type: ViewChild, args: ['viewchangewrapper',] }]
    };
    return ViewChangeComponent;
}());
export { ViewChangeComponent };
if (false) {
    /** @type {?} */
    ViewChangeComponent.prototype.toolbarData;
    /** @type {?} */
    ViewChangeComponent.prototype.viewType;
    /** @type {?} */
    ViewChangeComponent.prototype.defaultType;
    /** @type {?} */
    ViewChangeComponent.prototype.viewGroupId;
    /** @type {?} */
    ViewChangeComponent.prototype.activeTypeItem;
    /** @type {?} */
    ViewChangeComponent.prototype.toolTypeChange;
    /** @type {?} */
    ViewChangeComponent.prototype.typelist;
    /** @type {?} */
    ViewChangeComponent.prototype.viewchangewrapper;
    /**
     * @type {?}
     * @private
     */
    ViewChangeComponent.prototype.guid;
    /**
     * @type {?}
     * @private
     */
    ViewChangeComponent.prototype.ngZone;
    /**
     * @type {?}
     * @private
     */
    ViewChangeComponent.prototype.ro;
    /**
     * @type {?}
     * @private
     */
    ViewChangeComponent.prototype.viewChangeManageSer;
    /**
     * @type {?}
     * @private
     */
    ViewChangeComponent.prototype._renderer;
    /**
     * @type {?}
     * @private
     */
    ViewChangeComponent.prototype.viewChangeService;
    /**
     * @type {?}
     * @private
     */
    ViewChangeComponent.prototype.inject;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidmlldy1jaGFuZ2UuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGZhcnJpcy91aS12aWV3LWNoYW5nZS8iLCJzb3VyY2VzIjpbImxpYi92aWV3LWNoYW5nZS5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUFBLE9BQU8sRUFBRSxTQUFTLEVBQVUsS0FBSyxFQUFFLE1BQU0sRUFBRSxZQUFZLEVBQUUsVUFBVSxFQUFFLFNBQVMsRUFBRSxTQUFTLEVBQWlCLGlCQUFpQixFQUFFLFFBQVEsRUFBRSxNQUFNLEVBQUUsUUFBUSxFQUFhLE1BQU0sZUFBZSxDQUFDO0FBQzFMLE9BQU8sY0FBYyxNQUFNLDBCQUEwQixDQUFDO0FBQ3RELE9BQU8sRUFBRSxpQkFBaUIsRUFBRSxNQUFNLHVCQUF1QixDQUFDO0FBRTFEO0lBK0JFLDZCQUFvQixTQUFvQixFQUNsQixpQkFBb0MsRUFBc0IsTUFBZ0I7UUFENUUsY0FBUyxHQUFULFNBQVMsQ0FBVztRQUNsQixzQkFBaUIsR0FBakIsaUJBQWlCLENBQW1CO1FBQXNCLFdBQU0sR0FBTixNQUFNLENBQVU7O1FBckJ2RixhQUFRLEdBQVcsTUFBTSxDQUFDOztRQUkxQixnQkFBVyxHQUFVLFNBQVMsQ0FBQzs7UUFHOUIsbUJBQWMsR0FBRyxJQUFJLFlBQVksRUFBRSxDQUFDOztRQUt0QyxTQUFJLEdBQUMsRUFBRSxDQUFDOztRQUVULFdBQU0sR0FBRyxJQUFJLENBQUM7O1FBRWQsT0FBRSxHQUEwQixJQUFJLENBQUM7UUFNcEMsSUFBRyxDQUFDLElBQUksQ0FBQyxpQkFBaUIsRUFBQztZQUN6QixJQUFJLENBQUMsaUJBQWlCLEdBQUUsSUFBSSxpQkFBaUIsRUFBRSxDQUFDO1NBQ2pEO0lBQ0gsQ0FBQzs7OztJQUVILHNDQUFROzs7SUFBUjtRQUFBLGlCQWdCQztRQWZDLElBQUksQ0FBQyxJQUFJLEdBQUMsSUFBSSxDQUFDLGlCQUFpQixDQUFDLG1CQUFtQixDQUFDLEVBQUMsT0FBTyxFQUFD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QW1COztJQWlHaEMsMEJBQUM7Q0FBQSxBQXRIRCxJQXNIQztTQS9HWSxtQkFBbUI7OztJQUU5QiwwQ0FBcUI7O0lBRXJCLHVDQUFtQzs7SUFFbkMsMENBQTZCOztJQUU3QiwwQ0FBd0M7O0lBQ3hDLDZDQUFlOztJQUVmLDZDQUE4Qzs7SUFFOUMsdUNBQTRDOztJQUM1QyxnREFBOEQ7Ozs7O0lBRTlELG1DQUFnQjs7Ozs7SUFFakIscUNBQXNCOzs7OztJQUV0QixpQ0FBeUM7Ozs7O0lBQ3pDLGtEQUE0Qjs7Ozs7SUFHZix3Q0FBNEI7Ozs7O0lBQ3RDLGdEQUF3RDs7Ozs7SUFBRSxxQ0FBb0MiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb21wb25lbnQsIE9uSW5pdCwgSW5wdXQsIE91dHB1dCwgRXZlbnRFbWl0dGVyLCBFbGVtZW50UmVmLCBWaWV3Q2hpbGQsIFJlbmRlcmVyMiwgQWZ0ZXJWaWV3SW5pdCwgVmlld0VuY2Fwc3VsYXRpb24sIE9wdGlvbmFsLCBOZ1pvbmUsIEluamVjdG9yLCBPbkRlc3Ryb3kgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IFJlc2l6ZU9ic2VydmVyIGZyb20gXCJyZXNpemUtb2JzZXJ2ZXItcG9seWZpbGxcIjtcclxuaW1wb3J0IHsgVmlld0NoYW5nZVNlcnZpY2UgfSBmcm9tICcuL3ZpZXctY2hhbmdlLnNlcnZpY2UnO1xyXG5cclxuQENvbXBvbmVudCh7XHJcbiAgc2VsZWN0b3I6ICdmYXJyaXMtdmlldy1jaGFuZ2UnLFxyXG4gIHRlbXBsYXRlVXJsOiAnLi92aWV3LWNoYW5nZS5jb21wb25lbnQuaHRtbCcsXHJcbiAgc3R5bGVVcmxzOiBbJy4vdmlldy1jaGFuZ2UuY29tcG9uZW50LnNjc3MnXSxcclxuICBlbmNhcHN1bGF0aW9uOiBWaWV3RW5jYXBzdWxhdGlvbi5Ob25lXHJcbiAgLy8gcHJvdmlkZXJzOlsgVmlld0NoYW5nZVNlcnZpY2UgXVxyXG59KVxyXG5leHBvcnQgY2xhc3MgVmlld0NoYW5nZUNvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCAsQWZ0ZXJWaWV3SW5pdCxPbkRlc3Ryb3l7XHJcblxyXG4gIEBJbnB1dCgpIHRvb2xiYXJEYXRhO1xyXG4gIC8vIOinhuWbvuexu+Wei+eahOWRiOeOsOaWueW8j++8jHRpbGXlsI/no4HotLTnsbvlnovvvIxkcm9wZG93buS4i+aLieexu+Wei1xyXG4gIEBJbnB1dCgpIHZpZXdUeXBlOiBzdHJpbmcgPSAndGlsZSc7XHJcbiAgLy8g6buY6K6k55qE6KeG5Zu+57G75Z6LXHJcbiAgQElucHV0KCkgZGVmYXVsdFR5cGU6IHN0cmluZztcclxuICAvLyDop4blm77nu4RcclxuICBASW5wdXQoKSB2aWV3R3JvdXBJZDpzdHJpbmcgPSAnZGVmYXVsdCc7XHJcbiAgYWN0aXZlVHlwZUl0ZW07XHJcbiAgLy8g6KeG5Zu+57G75Z6L5YiH5o2i5pe277yM5oqb5Ye655qE5LqL5Lu2XHJcbiAgQE91dHB1dCgpIHRvb2xUeXBlQ2hhbmdlID0gbmV3IEV2ZW50RW1pdHRlcigpO1xyXG5cclxuICBAVmlld0NoaWxkKCd0eXBlbGlzdCcpIHR5cGVsaXN0OiBFbGVtZW50UmVmO1xyXG4gIEBWaWV3Q2hpbGQoJ3ZpZXdjaGFuZ2V3cmFwcGVyJykgdmlld2NoYW5nZXdyYXBwZXI6IEVsZW1lbnRSZWY7XHJcbiAgLy8g6K6w5b2VTW9kdWxl55qE5qCH6K6w77yM55So5p2l6I635Y+W5b2T5YmNbW9kdWxl5LiL55qE5pyN5YqhXHJcbiAgcHJpdmF0ZSBndWlkPVwiXCI7XHJcbiAvLyDlpITnkIZuZ3pvbmVcclxuIHByaXZhdGUgbmdab25lID0gbnVsbDtcclxuIC8vIOiusOW9leWFg+e0oOWwuuWvuOWPmOabtFxyXG4gcHJpdmF0ZSBybzogUmVzaXplT2JzZXJ2ZXIgfCBudWxsID0gbnVsbDtcclxuIHByaXZhdGUgdmlld0NoYW5nZU1hbmFnZVNlcjtcclxuIFxyXG5cclxuICBjb25zdHJ1Y3Rvcihwcml2YXRlIF9yZW5kZXJlcjogUmVuZGVyZXIyLFxyXG4gICAgQE9wdGlvbmFsKCkgcHJpdmF0ZSB2aWV3Q2hhbmdlU2VydmljZTogVmlld0NoYW5nZVNlcnZpY2UsIEBPcHRpb25hbCgpIHByaXZhdGUgaW5qZWN0OiBJbmplY3RvcikgeyBcclxuICAgICAgaWYoIXRoaXMudmlld0NoYW5nZVNlcnZpY2Upe1xyXG4gICAgICAgIHRoaXMudmlld0NoYW5nZVNlcnZpY2U9IG5ldyBWaWV3Q2hhbmdlU2VydmljZSgpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gIG5nT25Jbml0KCkge1xyXG4gICAgdGhpcy5ndWlkPXRoaXMudmlld0NoYW5nZVNlcnZpY2UuY3JlYXRlVmlld0NoYW5nZUNtcCh7Z3JvdXBJZDp0aGlzLnZpZXdHcm91cElkLGNvdW50OnRoaXMudG9vbGJhckRhdGEubGVuZ3RofSx0aGlzLnZpZXdjaGFuZ2V3cmFwcGVyLm5hdGl2ZUVsZW1lbnQucGFyZW50RWxlbWVudCk7XHJcbiAgICB0aGlzLnZpZXdDaGFuZ2VNYW5hZ2VTZXI9dGhpcy52aWV3Q2hhbmdlU2VydmljZS5nZXRNb2R1bGVJbmZvKHRoaXMuZ3VpZCk7XHJcbiAgICBpZiAodGhpcy50b29sYmFyRGF0YSAmJiB0aGlzLnRvb2xiYXJEYXRhLmxlbmd0aCkge1xyXG4gICAgICBpZiAodGhpcy5kZWZhdWx0VHlwZSkge1xyXG4gICAgICAgIGxldCBpdGVtID0gdGhpcy50b29sYmFyRGF0YS5maW5kKChiYXIpID0+IHtcclxuICAgICAgICAgIHJldHVybiBiYXJbJ3R5cGUnXSA9PT0gdGhpcy5kZWZhdWx0VHlwZTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIHRoaXMuYWN0aXZlVHlwZUl0ZW0gPSBpdGVtO1xyXG4gICAgICAgIHRoaXMudG9vbFR5cGVDaGFuZ2UuZW1pdCh0aGlzLmFjdGl2ZVR5cGVJdGVtKTtcclxuICAgICAgfVxyXG4gICAgICBlbHNlIHtcclxuICAgICAgICB0aGlzLmFjdGl2ZVR5cGVJdGVtID0gdGhpcy50b29sYmFyRGF0YVswXTtcclxuICAgICAgICB0aGlzLnRvb2xUeXBlQ2hhbmdlLmVtaXQodGhpcy5hY3RpdmVUeXBlSXRlbSk7XHJcbiAgICAgIH0gICAgICAgICBcclxuICAgIH0gICAgXHJcbiAgfVxyXG4gIG5nQWZ0ZXJWaWV3SW5pdCgpOiB2b2lkIHtcclxuICAgIHRoaXMub2JzZXJ2ZXJFbGVtZW50KCk7ICAgIFxyXG4gIH1cclxuICBuZ09uRGVzdHJveSgpOiB2b2lkIHtcclxuICAgIGlmKHRoaXMucm8pe1xyXG4gICAgICB0aGlzLnJvLnVub2JzZXJ2ZSh0aGlzLnZpZXdjaGFuZ2V3cmFwcGVyLm5hdGl2ZUVsZW1lbnQpO1xyXG4gICAgICB0aGlzLnJvID0gbnVsbDtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGxpc3RJdGVtQ2xpY2soaXRlbSkge1xyXG4gICAgaWYgKGl0ZW0uZGlzYWJsZSB8fCB0aGlzLmFjdGl2ZVR5cGVJdGVtWyd0eXBlJ10gPT09IGl0ZW1bJ3R5cGUnXSkge1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICB0aGlzLmFjdGl2ZVR5cGVJdGVtID0gaXRlbTtcclxuICAgIHRoaXMudmlld0NoYW5nZU1hbmFnZVNlci51cGRhdGVDdXJyZW50Vmlld0lkKHRoaXMuYWN0aXZlVHlwZUl0ZW1bJ3R5cGUnXSx0aGlzLnZpZXdHcm91cElkKTtcclxuICAgIHRoaXMudG9vbFR5cGVDaGFuZ2UuZW1pdChpdGVtKTtcclxuICAgIGlmICh0aGlzLnR5cGVsaXN0KSB7XHJcbiAgICAgIHRoaXMuX3JlbmRlcmVyLnNldFN0eWxlKFxyXG4gICAgICAgIHRoaXMudHlwZWxpc3QubmF0aXZlRWxlbWVudCxcclxuICAgICAgICAnZGlzcGxheScsXHJcbiAgICAgICAgJ25vbmUnXHJcbiAgICAgICk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBkcm9wZG93bk1vdXNlRW50ZXIoKSB7XHJcbiAgICB0aGlzLl9yZW5kZXJlci5zZXRTdHlsZShcclxuICAgICAgdGhpcy50eXBlbGlzdC5uYXRpdmVFbGVtZW50LFxyXG4gICAgICAnZGlzcGxheScsXHJcbiAgICAgICdibG9jaydcclxuICAgICk7XHJcbiAgfVxyXG4gIGRyb3Bkb3duTW91c2VMZWF2ZSgpIHtcclxuICAgIHRoaXMuX3JlbmRlcmVyLnNldFN0eWxlKFxyXG4gICAgICB0aGlzLnR5cGVsaXN0Lm5hdGl2ZUVsZW1lbnQsXHJcbiAgICAgICdkaXNwbGF5JyxcclxuICAgICAgJ25vbmUnXHJcbiAgICApO1xyXG4gIH1cclxuICAvKipcclxuICAgKiDop6PlhrPljaHniYflkozliJfooajkuKTkuKroj5zljZXlkIzml7bmiZPlvIDvvIzlkIzmraXmlbDmja7ml7blgJnvvIzlvZPliY3nmoTmoIfnrb7mmL7npLrkuI3lr7nnmoTpl67pophcclxuICAgKi9cclxuICBwcml2YXRlIG9ic2VydmVyRWxlbWVudCgpIHtcclxuICAgICAgICBpZighdGhpcy5pbmplY3Qpe1xyXG4gICAgICAgICAgLy8g5Yid5aeL5pu05paw5LiA5qyh5b2T5YmN57G75Z6LXHJcbiAgICAgICAgICB0aGlzLnZpZXdDaGFuZ2VNYW5hZ2VTZXJbJ2NoYW5nZUN1cnJlbnRWaWV3SWRGcm9tQ01QJ10odGhpcy5hY3RpdmVUeXBlSXRlbVsndHlwZSddLHRoaXMudmlld0dyb3VwSWQpO1xyXG4gICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoIXRoaXMubmdab25lKSB7XHJcbiAgICAgICAgICAgIHRoaXMubmdab25lID0gdGhpcy5pbmplY3QuZ2V0PE5nWm9uZT4oTmdab25lLCBudWxsKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKCF0aGlzLnJvKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm5nWm9uZS5ydW5PdXRzaWRlQW5ndWxhcigoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5ybyA9IG5ldyBSZXNpemVPYnNlcnZlcigoZW50cmllcywgb2JzZXJ2ZXIpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgIGlmKGVudHJpZXNbMF0uY29udGVudFJlY3Qud2lkdGg+MCl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudmlld0NoYW5nZU1hbmFnZVNlclsnY2hhbmdlQ3VycmVudFZpZXdJZEZyb21DTVAnXSh0aGlzLmFjdGl2ZVR5cGVJdGVtWyd0eXBlJ10sdGhpcy52aWV3R3JvdXBJZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yby5vYnNlcnZlKHRoaXMudmlld2NoYW5nZXdyYXBwZXIubmF0aXZlRWxlbWVudCk7XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgIH1cclxuICB9XHJcbn1cclxuIl19