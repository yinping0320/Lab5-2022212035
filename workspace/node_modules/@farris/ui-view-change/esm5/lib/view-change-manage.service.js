/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Injectable } from '@angular/core';
import { BehaviorSubject } from 'rxjs';
/**
 * @record
 */
function ViewItems() { }
if (false) {
    /** @type {?} */
    ViewItems.prototype.items;
}
/**
 * @record
 */
function viewContainer() { }
/**
 * @record
 */
function CurrentViewChange() { }
var ViewChangeManageService = /** @class */ (function () {
    function ViewChangeManageService() {
        /**
         * 默认视图切换分组名称
         */
        this.defaultId = 'default';
        //当前显示视图
        this.currentViewType = {};
        /**
         * contents
         */
        this.viewContainers = {};
        /**
         * 保存所有分组的监听对象，形如{分组Id:变更监听对象}
         */
        this.changeCurrentViewId = {};
    }
    /**
     * 添加视图项目
     * @param itemId
     * @param viewContainerId:对应的就是groupId
     */
    /**
     * 添加视图项目
     * @param {?} itemId
     * @param {?=} viewContainerId
     * @return {?}
     */
    ViewChangeManageService.prototype.addViewItem = /**
     * 添加视图项目
     * @param {?} itemId
     * @param {?=} viewContainerId
     * @return {?}
     */
    function (itemId, viewContainerId) {
        if (viewContainerId === void 0) { viewContainerId = this.defaultId; }
        if (this.viewContainers[viewContainerId]) {
            if (this.hasElement(itemId, viewContainerId)) {
                return;
            }
            else {
                this.viewContainers[viewContainerId].items.push(itemId);
            }
        }
        else {
            this.viewContainers[viewContainerId] = (/** @type {?} */ ({
                items: []
            }));
            this.createViewContainerChange(viewContainerId);
            this.viewContainers[viewContainerId].items.push(itemId);
        }
    };
    /**
     *
     * @param itemId 内容的指令标记
     * @param viewContainerId fGroupId
     * @returns
     */
    /**
     *
     * @param {?} itemId 内容的指令标记
     * @param {?=} viewContainerId fGroupId
     * @return {?}
     */
    ViewChangeManageService.prototype.removeViewItem = /**
     *
     * @param {?} itemId 内容的指令标记
     * @param {?=} viewContainerId fGroupId
     * @return {?}
     */
    function (itemId, viewContainerId) {
        if (viewContainerId === void 0) { viewContainerId = this.defaultId; }
        if (this.viewContainers && this.viewContainers[viewContainerId]) {
            /** @type {?} */
            var leftItems = this.viewContainers[viewContainerId].items.filter((/**
             * @param {?} el
             * @return {?}
             */
            function (el) {
                return el !== itemId;
            }));
            if (!leftItems.length) {
                // 如果当前分组下的项都不在
                delete this.viewContainers[viewContainerId];
                if (this.changeCurrentViewId[viewContainerId]) {
                    this.changeCurrentViewId[viewContainerId].unsubscribe();
                    this.changeCurrentViewId[viewContainerId] = null;
                    delete this.changeCurrentViewId[viewContainerId];
                }
                return;
            }
            this.viewContainers[viewContainerId].items = leftItems;
        }
    };
    /**存储currentpageid */
    /**
     * 存储currentpageid
     * @param {?} type
     * @param {?=} viewContainerId
     * @return {?}
     */
    ViewChangeManageService.prototype.updateCurrentViewId = /**
     * 存储currentpageid
     * @param {?} type
     * @param {?=} viewContainerId
     * @return {?}
     */
    function (type, viewContainerId) {
        if (viewContainerId === void 0) { viewContainerId = this.defaultId; }
        this.currentViewType[viewContainerId] = type;
        /** @type {?} */
        var changeView = {};
        changeView[viewContainerId] = this.currentViewType[viewContainerId];
        this.createViewContainerChange(viewContainerId);
        this.changeCurrentViewId[viewContainerId].next(changeView);
    };
    /**
     * 获取所属分组的变更监听对象
     * @param viewContainerId
     * @returns
     */
    /**
     * 获取所属分组的变更监听对象
     * @param {?=} viewContainerId
     * @return {?}
     */
    ViewChangeManageService.prototype.getChangeCurrentViewId = /**
     * 获取所属分组的变更监听对象
     * @param {?=} viewContainerId
     * @return {?}
     */
    function (viewContainerId) {
        if (viewContainerId === void 0) { viewContainerId = this.defaultId; }
        return this.changeCurrentViewId[viewContainerId];
    };
    /**
     * 提供给view-change组件使用
     * @param type
     * @param viewContainerId
     */
    /**
     * 提供给view-change组件使用
     * @param {?} type
     * @param {?=} viewContainerId
     * @return {?}
     */
    ViewChangeManageService.prototype.changeCurrentViewIdFromCMP = /**
     * 提供给view-change组件使用
     * @param {?} type
     * @param {?=} viewContainerId
     * @return {?}
     */
    function (type, viewContainerId) {
        if (viewContainerId === void 0) { viewContainerId = this.defaultId; }
        if (!this.currentViewType[viewContainerId]) {
            this.currentViewType[viewContainerId] = type;
        }
        this.updateCurrentViewId(this.currentViewType[viewContainerId], viewContainerId);
    };
    /**
     * @private
     * @param {?} itemId
     * @param {?} groupId
     * @return {?}
     */
    ViewChangeManageService.prototype.hasElement = /**
     * @private
     * @param {?} itemId
     * @param {?} groupId
     * @return {?}
     */
    function (itemId, groupId) {
        return this.viewContainers[groupId].items.some((/**
         * @param {?} item
         * @return {?}
         */
        function (item) { return item === itemId; }));
    };
    /**
     * @private
     * @param {?=} viewContainerId
     * @return {?}
     */
    ViewChangeManageService.prototype.createViewContainerChange = /**
     * @private
     * @param {?=} viewContainerId
     * @return {?}
     */
    function (viewContainerId) {
        if (viewContainerId === void 0) { viewContainerId = this.defaultId; }
        if (!this.changeCurrentViewId[viewContainerId]) {
            this.changeCurrentViewId[viewContainerId] = new BehaviorSubject(null);
        }
    };
    /**
     * @return {?}
     */
    ViewChangeManageService.prototype.hasViewContainer = /**
     * @return {?}
     */
    function () {
        return Object.keys(this.viewContainers).length == 0 && Object.keys(this.changeCurrentViewId).length == 0;
    };
    ViewChangeManageService.decorators = [
        { type: Injectable }
    ];
    /** @nocollapse */
    ViewChangeManageService.ctorParameters = function () { return []; };
    return ViewChangeManageService;
}());
export { ViewChangeManageService };
if (false) {
    /**
     * 默认视图切换分组名称
     * @type {?}
     * @private
     */
    ViewChangeManageService.prototype.defaultId;
    /** @type {?} */
    ViewChangeManageService.prototype.currentViewType;
    /**
     * contents
     * @type {?}
     */
    ViewChangeManageService.prototype.viewContainers;
    /**
     * 保存所有分组的监听对象，形如{分组Id:变更监听对象}
     * @type {?}
     */
    ViewChangeManageService.prototype.changeCurrentViewId;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidmlldy1jaGFuZ2UtbWFuYWdlLnNlcnZpY2UuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZmFycmlzL3VpLXZpZXctY2hhbmdlLyIsInNvdXJjZXMiOlsibGliL3ZpZXctY2hhbmdlLW1hbmFnZS5zZXJ2aWNlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7QUFBQSxPQUFPLEVBQUUsVUFBVSxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBQzNDLE9BQU8sRUFBVyxlQUFlLEVBQUUsTUFBTSxNQUFNLENBQUM7Ozs7QUFFaEQsd0JBRUM7OztJQURDLDBCQUFxQjs7Ozs7QUFFdkIsNEJBRUM7Ozs7QUFFRCxnQ0FFQztBQUVEO0lBY0U7Ozs7UUFYaUIsY0FBUyxHQUFVLFNBQVMsQ0FBQzs7UUFFOUMsb0JBQWUsR0FBTyxFQUFFLENBQUM7Ozs7UUFHekIsbUJBQWMsR0FBaUIsRUFBRSxDQUFDOzs7O1FBSWxDLHdCQUFtQixHQUFtQixFQUFFLENBQUM7SUFHeEMsQ0FBQztJQUNGOzs7O09BSUc7Ozs7Ozs7SUFDSCw2Q0FBVzs7Ozs7O0lBQVgsVUFBWSxNQUFhLEVBQUUsZUFBZ0M7UUFBaEMsZ0NBQUEsRUFBQSxrQkFBa0IsSUFBSSxDQUFDLFNBQVM7UUFDekQsSUFBRyxJQUFJLENBQUMsY0FBYyxDQUFDLGVBQWUsQ0FBQyxFQUFDO1lBQ3RDLElBQUksSUFBSSxDQUFDLFVBQVUsQ0FBQyxNQUFNLEVBQUUsZUFBZSxDQUFDLEVBQUU7Z0JBQzVDLE9BQU87YUFDUjtpQkFDRztnQkFDRixJQUFJLENBQUMsY0FBYyxDQUFDLGVBQWUsQ0FBQyxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUM7YUFDekQ7U0FDRjthQUNHO1lBQ0YsSUFBSSxDQUFDLGNBQWMsQ0FBQyxlQUFlLENBQUMsR0FBRyxtQkFBQTtnQkFDckMsS0FBSyxFQUFFLEVBQUU7YUFDVixFQUFhLENBQUM7WUFDZixJQUFJLENBQUMseUJBQXlCLENBQUMsZUFBZSxDQUFDLENBQUM7WUFDaEQs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QXlCOzs7OztJQUFqQyxVQUFrQyxlQUFnQztRQUFoQyxnQ0FBQSxFQUFBLGtCQUFrQixJQUFJLENBQUMsU0FBUztRQUNoRSxJQUFHLENBQUMsSUFBSSxDQUFDLG1CQUFtQixDQUFDLGVBQWUsQ0FBQyxFQUFDO1lBQzVDLElBQUksQ0FBQyxtQkFBbUIsQ0FBQyxlQUFlLENBQUMsR0FBRSxJQUFJLGVBQWUsQ0FBTSxJQUFJLENBQUMsQ0FBQztTQUMzRTtJQUNILENBQUM7Ozs7SUFDRCxrREFBZ0I7OztJQUFoQjtRQUNFLE9BQU8sTUFBTSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsY0FBYyxDQUFDLENBQUMsTUFBTSxJQUFFLENBQUMsSUFBRSxNQUFNLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxtQkFBbUIsQ0FBQyxDQUFDLE1BQU0sSUFBRSxDQUFDLENBQUM7SUFDckcsQ0FBQzs7Z0JBckdGLFVBQVU7Ozs7SUFzR1gsOEJBQUM7Q0FBQSxBQXRHRCxJQXNHQztTQXJHWSx1QkFBdUI7Ozs7Ozs7SUFFbEMsNENBQThDOztJQUU5QyxrREFBeUI7Ozs7O0lBR3pCLGlEQUFrQzs7Ozs7SUFJbEMsc0RBQXlDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgSW5qZWN0YWJsZSB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBTdWJqZWN0LCBCZWhhdmlvclN1YmplY3QgfSBmcm9tICdyeGpzJztcclxuXHJcbmludGVyZmFjZSBWaWV3SXRlbXMge1xyXG4gIGl0ZW1zOiBBcnJheTxzdHJpbmc+O1xyXG59XHJcbmludGVyZmFjZSB2aWV3Q29udGFpbmVyIHtcclxuICBbdmlld0dyb3VwSWRJZDogc3RyaW5nXTogVmlld0l0ZW1zO1xyXG59XHJcblxyXG5pbnRlcmZhY2UgQ3VycmVudFZpZXdDaGFuZ2V7XHJcbiAgW3ZpZXdHcm91cElkSWQ6IHN0cmluZ106IEJlaGF2aW9yU3ViamVjdDxhbnk+O1xyXG59XHJcblxyXG5ASW5qZWN0YWJsZSgpXHJcbmV4cG9ydCBjbGFzcyBWaWV3Q2hhbmdlTWFuYWdlU2VydmljZSB7XHJcbiAgLyoq6buY6K6k6KeG5Zu+5YiH5o2i5YiG57uE5ZCN56ewICovXHJcbiAgcHJpdmF0ZSByZWFkb25seSBkZWZhdWx0SWQ6c3RyaW5nID0gJ2RlZmF1bHQnO1xyXG4gIC8v5b2T5YmN5pi+56S66KeG5Zu+XHJcbiAgY3VycmVudFZpZXdUeXBlOmFueSA9IHt9O1xyXG5cclxuICAvKipjb250ZW50cyAqL1xyXG4gIHZpZXdDb250YWluZXJzOnZpZXdDb250YWluZXIgPSB7fTtcclxuICAvKipcclxuICAgKiDkv53lrZjmiYDmnInliIbnu4TnmoTnm5HlkKzlr7nosaHvvIzlvaLlpoJ75YiG57uESWQ65Y+Y5pu055uR5ZCs5a+56LGhfVxyXG4gICAqL1xyXG4gIGNoYW5nZUN1cnJlbnRWaWV3SWQ6Q3VycmVudFZpZXdDaGFuZ2U9e307XHJcblxyXG4gIGNvbnN0cnVjdG9yKCkge1xyXG4gICB9XHJcbiAgLyoqXHJcbiAgICog5re75Yqg6KeG5Zu+6aG555uuXHJcbiAgICogQHBhcmFtIGl0ZW1JZCBcclxuICAgKiBAcGFyYW0gdmlld0NvbnRhaW5lcklkOuWvueW6lOeahOWwseaYr2dyb3VwSWQgXHJcbiAgICovXHJcbiAgYWRkVmlld0l0ZW0oaXRlbUlkOnN0cmluZywgdmlld0NvbnRhaW5lcklkID0gdGhpcy5kZWZhdWx0SWQpe1xyXG4gICAgaWYodGhpcy52aWV3Q29udGFpbmVyc1t2aWV3Q29udGFpbmVySWRdKXtcclxuICAgICAgaWYgKHRoaXMuaGFzRWxlbWVudChpdGVtSWQsIHZpZXdDb250YWluZXJJZCkpIHtcclxuICAgICAgICByZXR1cm47XHJcbiAgICAgIH1cclxuICAgICAgZWxzZXtcclxuICAgICAgICB0aGlzLnZpZXdDb250YWluZXJzW3ZpZXdDb250YWluZXJJZF0uaXRlbXMucHVzaChpdGVtSWQpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBlbHNle1xyXG4gICAgICB0aGlzLnZpZXdDb250YWluZXJzW3ZpZXdDb250YWluZXJJZF0gPSB7XHJcbiAgICAgICAgaXRlbXM6IFtdXHJcbiAgICAgIH0gYXMgVmlld0l0ZW1zO1xyXG4gICAgICB0aGlzLmNyZWF0ZVZpZXdDb250YWluZXJDaGFuZ2Uodmlld0NvbnRhaW5lcklkKTtcclxuICAgICAgdGhpcy52aWV3Q29udGFpbmVyc1t2aWV3Q29udGFpbmVySWRdLml0ZW1zLnB1c2goaXRlbUlkKTtcclxuICAgIH1cclxuICB9XHJcbiAgLyoqXHJcbiAgICogXHJcbiAgICogQHBhcmFtIGl0ZW1JZCDlhoXlrrnnmoTmjIfku6TmoIforrBcclxuICAgKiBAcGFyYW0gdmlld0NvbnRhaW5lcklkIGZHcm91cElkXHJcbiAgICogQHJldHVybnMgXHJcbiAgICovXHJcbiAgcmVtb3ZlVmlld0l0ZW0oaXRlbUlkLCB2aWV3Q29udGFpbmVySWQgPSB0aGlzLmRlZmF1bHRJZCl7XHJcbiAgICBpZih0aGlzLnZpZXdDb250YWluZXJzICYmIHRoaXMudmlld0NvbnRhaW5lcnNbdmlld0NvbnRhaW5lcklkXSl7XHJcbiAgICAgIGNvbnN0IGxlZnRJdGVtcyA9IHRoaXMudmlld0NvbnRhaW5lcnNbdmlld0NvbnRhaW5lcklkXS5pdGVtcy5maWx0ZXIoZWw9PntcclxuICAgICAgICByZXR1cm4gZWwgIT09IGl0ZW1JZDtcclxuICAgICAgfSk7XHJcbiAgICAgIGlmICghbGVmdEl0ZW1zLmxlbmd0aCkge1xyXG4gICAgICAgIC8vIOWmguaenOW9k+WJjeWIhue7hOS4i+eahOmhuemDveS4jeWcqFxyXG4gICAgICAgIGRlbGV0ZSB0aGlzLnZpZXdDb250YWluZXJzW3ZpZXdDb250YWluZXJJZF07XHJcbiAgICAgICAgaWYodGhpcy5jaGFuZ2VDdXJyZW50Vmlld0lkW3ZpZXdDb250YWluZXJJZF0pe1xyXG4gICAgICAgICAgdGhpcy5jaGFuZ2VDdXJyZW50Vmlld0lkW3ZpZXdDb250YWluZXJJZF0udW5zdWJzY3JpYmUoKTtcclxuICAgICAgICAgIHRoaXMuY2hhbmdlQ3VycmVudFZpZXdJZFt2aWV3Q29udGFpbmVySWRdPW51bGw7XHJcbiAgICAgICAgICBkZWxldGUgdGhpcy5jaGFuZ2VDdXJyZW50Vmlld0lkW3ZpZXdDb250YWluZXJJZF07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG4gICAgICB0aGlzLnZpZXdDb250YWluZXJzW3ZpZXdDb250YWluZXJJZF0uaXRlbXMgPSBsZWZ0SXRlbXM7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKirlrZjlgqhjdXJyZW50cGFnZWlkICovXHJcbiAgdXBkYXRlQ3VycmVudFZpZXdJZCh0eXBlOnN0cmluZywgdmlld0NvbnRhaW5lcklkID0gdGhpcy5kZWZhdWx0SWQpe1xyXG4gICAgdGhpcy5jdXJyZW50Vmlld1R5cGVbdmlld0NvbnRhaW5lcklkXSA9IHR5cGU7XHJcbiAgICBsZXQgY2hhbmdlVmlldz17fTtcclxuICAgIGNoYW5nZVZpZXdbdmlld0NvbnRhaW5lcklkXT10aGlzLmN1cnJlbnRWaWV3VHlwZVt2aWV3Q29udGFpbmVySWRdO1xyXG4gICAgdGhpcy5jcmVhdGVWaWV3Q29udGFpbmVyQ2hhbmdlKHZpZXdDb250YWluZXJJZCk7XHJcbiAgICB0aGlzLmNoYW5nZUN1cnJlbnRWaWV3SWRbdmlld0NvbnRhaW5lcklkXS5uZXh0KGNoYW5nZVZpZXcpO1xyXG4gIH1cclxuICAvKipcclxuICAgKiDojrflj5bmiYDlsZ7liIbnu4TnmoTlj5jmm7Tnm5HlkKzlr7nosaFcclxuICAgKiBAcGFyYW0gdmlld0NvbnRhaW5lcklkIFxyXG4gICAqIEByZXR1cm5zIFxyXG4gICAqL1xyXG4gIGdldENoYW5nZUN1cnJlbnRWaWV3SWQodmlld0NvbnRhaW5lcklkID0gdGhpcy5kZWZhdWx0SWQpe1xyXG4gICAgcmV0dXJuIHRoaXMuY2hhbmdlQ3VycmVudFZpZXdJZFt2aWV3Q29udGFpbmVySWRdO1xyXG4gIH1cclxuICAvKipcclxuICAgKiDmj5Dkvpvnu5l2aWV3LWNoYW5nZee7hOS7tuS9v+eUqFxyXG4gICAqIEBwYXJhbSB0eXBlIFxyXG4gICAqIEBwYXJhbSB2aWV3Q29udGFpbmVySWQgXHJcbiAgICovXHJcbiAgY2hhbmdlQ3VycmVudFZpZXdJZEZyb21DTVAodHlwZTpzdHJpbmcsdmlld0NvbnRhaW5lcklkID0gdGhpcy5kZWZhdWx0SWQpe1xyXG4gICAgICBpZighdGhpcy5jdXJyZW50Vmlld1R5cGVbdmlld0NvbnRhaW5lcklkXSl7XHJcbiAgICAgICAgdGhpcy5jdXJyZW50Vmlld1R5cGVbdmlld0NvbnRhaW5lcklkXT10eXBlO1xyXG4gICAgICB9XHJcbiAgICAgIHRoaXMudXBkYXRlQ3VycmVudFZpZXdJZCh0aGlzLmN1cnJlbnRWaWV3VHlwZVt2aWV3Q29udGFpbmVySWRdLHZpZXdDb250YWluZXJJZCk7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGhhc0VsZW1lbnQoaXRlbUlkOiBzdHJpbmcsIGdyb3VwSWQ6IHN0cmluZyk6IGJvb2xlYW4ge1xyXG4gICAgcmV0dXJuIHRoaXMudmlld0NvbnRhaW5lcnNbZ3JvdXBJZF0uaXRlbXMuc29tZSgoaXRlbSk6IGJvb2xlYW4gPT4gaXRlbSA9PT0gaXRlbUlkKTtcclxuICB9XHJcbiAgcHJpdmF0ZSBjcmVhdGVWaWV3Q29udGFpbmVyQ2hhbmdlKHZpZXdDb250YWluZXJJZCA9IHRoaXMuZGVmYXVsdElkKXtcclxuICAgIGlmKCF0aGlzLmNoYW5nZUN1cnJlbnRWaWV3SWRbdmlld0NvbnRhaW5lcklkXSl7XHJcbiAgICAgIHRoaXMuY2hhbmdlQ3VycmVudFZpZXdJZFt2aWV3Q29udGFpbmVySWRdPSBuZXcgQmVoYXZpb3JTdWJqZWN0PGFueT4obnVsbCk7XHJcbiAgICB9XHJcbiAgfVxyXG4gIGhhc1ZpZXdDb250YWluZXIoKXtcclxuICAgIHJldHVybiBPYmplY3Qua2V5cyh0aGlzLnZpZXdDb250YWluZXJzKS5sZW5ndGg9PTAmJk9iamVjdC5rZXlzKHRoaXMuY2hhbmdlQ3VycmVudFZpZXdJZCkubGVuZ3RoPT0wO1xyXG4gIH1cclxufVxyXG4iXX0=