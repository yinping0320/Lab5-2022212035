/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Directive, Input, ElementRef, Renderer2 } from '@angular/core';
import { ViewChangeService } from './view-change.service';
import { Subject } from 'rxjs';
import { takeUntil } from 'rxjs/operators';
//视图区域
var FarrisViewItemDirective = /** @class */ (function () {
    function FarrisViewItemDirective(elementRef, viewChangeService, render) {
        this.elementRef = elementRef;
        this.viewChangeService = viewChangeService;
        this.render = render;
        // 当前项所属的组
        this.fViewGroupId = 'default';
        // 记录Module的标记，用来获取当前module下的服务
        this.guid = "";
        // 解决viewChangeOnInit与监听执行多条数据的先后顺序不一致
        this.hasInit = false;
        /**
         * 只要执行过初始方法，就调用。
         * 保证只执行一次
         */
        this.cancelSignal = new Subject();
    }
    /**
     * @return {?}
     */
    FarrisViewItemDirective.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        // 先存储到服务里,在这个方法里可能会执行viewChangeOnInit,修改hasInit的值。
        this.viewChangeService['storeViewChangeDirectiveInstance'](this);
        // 解决组件与指令创建先后的问题
        this.viewChangeService.getModuleChange().pipe(takeUntil(this.cancelSignal)).subscribe((/**
         * @param {?} curModuleGroupdInfos
         * @return {?}
         */
        function (curModuleGroupdInfos) {
            if (_this.hasInit)
                return;
            /** @type {?} */
            var findModuleInfo = curModuleGroupdInfos.find((/**
             * @param {?} item
             * @return {?}
             */
            function (item) { return item['groupId'] == _this.fViewGroupId; }));
            if (findModuleInfo) {
                _this.viewChangeOnInit(findModuleInfo['guid']);
            }
        }));
    };
    /**
     * 标记这个方法
     * @param guid
     * @returns
     */
    /**
     * 标记这个方法
     * @param {?} newGuid
     * @return {?}
     */
    FarrisViewItemDirective.prototype.viewChangeOnInit = /**
     * 标记这个方法
     * @param {?} newGuid
     * @return {?}
     */
    function (newGuid) {
        var _this = this;
        if (this.hasInit)
            return;
        this.guid = newGuid;
        this.hasInit = true;
        this.cancelSignal.next();
        this.cancelSignal.complete();
        this.viewChangeManageSer = this.viewChangeService.getModuleInfo(newGuid);
        // 保存
        this.viewChangeService.updatedStoreViewChangeCmp(this.guid, this.fViewGroupId, this.elementRef.nativeElement);
        // 删除
        this.viewChangeService['removeViewChangeDirectiveInstance'](this.viewItemType, this.guid);
        // 追加到服务中统一管理
        this.viewChangeManageSer['addViewItem'](this.viewItemType, this.fViewGroupId);
        this.viewChangeManageSer['getChangeCurrentViewId'](this.fViewGroupId).subscribe((/**
         * @param {?} currentViewType
         * @return {?}
         */
        function (currentViewType) {
            if (!currentViewType || !currentViewType[_this.fViewGroupId])
                return;
            if (currentViewType[_this.fViewGroupId] == _this.viewItemType) {
                _this.render.removeClass(_this.elementRef.nativeElement, 'f-viewchange-view-none');
            }
            else {
                _this.render.addClass(_this.elementRef.nativeElement, 'f-viewchange-view-none');
            }
        }));
    };
    /**
     * @return {?}
     */
    FarrisViewItemDirective.prototype.ngOnDestroy = /**
     * @return {?}
     */
    function () {
        // 销毁时删除数据
        if (this.viewChangeManageSer) {
            this.viewChangeManageSer['removeViewItem'](this.viewItemType, this.fViewGroupId);
            if (this.viewChangeManageSer['hasViewContainer']()) {
                this.viewChangeService['removeModuleInfo'](this.guid);
            }
        }
        else {
            //未执行方法viewChangeOnInit
            this.cancelSignal = null;
        }
    };
    FarrisViewItemDirective.decorators = [
        { type: Directive, args: [{
                    selector: '[fViewItem]'
                },] }
    ];
    /** @nocollapse */
    FarrisViewItemDirective.ctorParameters = function () { return [
        { type: ElementRef },
        { type: ViewChangeService },
        { type: Renderer2 }
    ]; };
    FarrisViewItemDirective.propDecorators = {
        viewItemType: [{ type: Input, args: ['fViewItem',] }],
        fViewGroupId: [{ type: Input, args: ['fViewGroupId',] }]
    };
    return FarrisViewItemDirective;
}());
export { FarrisViewItemDirective };
if (false) {
    /**
     * 使用方式
     * <div [fViewItem]="'type11'" [fViewGroupId]="'group2'">
     * 视图的内容区域
     * </div>
     * @type {?}
     */
    FarrisViewItemDirective.prototype.viewItemType;
    /** @type {?} */
    FarrisViewItemDirective.prototype.fViewGroupId;
    /**
     * @type {?}
     * @private
     */
    FarrisViewItemDirective.prototype.viewChangeManageSer;
    /**
     * @type {?}
     * @private
     */
    FarrisViewItemDirective.prototype.guid;
    /**
     * @type {?}
     * @private
     */
    FarrisViewItemDirective.prototype.hasInit;
    /**
     * 只要执行过初始方法，就调用。
     * 保证只执行一次
     * @type {?}
     * @private
     */
    FarrisViewItemDirective.prototype.cancelSignal;
    /**
     * @type {?}
     * @private
     */
    FarrisViewItemDirective.prototype.elementRef;
    /**
     * @type {?}
     * @private
     */
    FarrisViewItemDirective.prototype.viewChangeService;
    /**
     * @type {?}
     * @private
     */
    FarrisViewItemDirective.prototype.render;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidmlldy1jaGFuZ2UuZGlyZWN0aXZlLmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGZhcnJpcy91aS12aWV3LWNoYW5nZS8iLCJzb3VyY2VzIjpbImxpYi92aWV3LWNoYW5nZS5kaXJlY3RpdmUudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUFBLE9BQU8sRUFBRSxTQUFTLEVBQUUsS0FBSyxFQUFFLFVBQVUsRUFBcUIsU0FBUyxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBQzNGLE9BQU8sRUFBRSxpQkFBaUIsRUFBRSxNQUFNLHVCQUF1QixDQUFDO0FBQzFELE9BQU8sRUFBRSxPQUFPLEVBQUUsTUFBTSxNQUFNLENBQUM7QUFDL0IsT0FBTyxFQUFVLFNBQVMsRUFBRSxNQUFNLGdCQUFnQixDQUFDOztBQUVuRDtJQXVCSSxpQ0FDWSxVQUFzQixFQUN0QixpQkFBb0MsRUFDcEMsTUFBaUI7UUFGakIsZUFBVSxHQUFWLFVBQVUsQ0FBWTtRQUN0QixzQkFBaUIsR0FBakIsaUJBQWlCLENBQW1CO1FBQ3BDLFdBQU0sR0FBTixNQUFNLENBQVc7O1FBZE4saUJBQVksR0FBVyxTQUFTLENBQUM7O1FBR2hELFNBQUksR0FBRyxFQUFFLENBQUM7O1FBRVYsWUFBTyxHQUFDLEtBQUssQ0FBQzs7Ozs7UUFLZCxpQkFBWSxHQUFHLElBQUksT0FBTyxFQUFFLENBQUM7SUFNckMsQ0FBQzs7OztJQUVNLDBDQUFROzs7SUFBZjtRQUFBLGlCQVdDO1FBVkcsbURBQW1EO1FBQ25ELElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxrQ0FBa0MsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQ2pFLGlCQUFpQjtRQUNqQixJQUFJLENBQUMsaUJBQWlCLENBQUMsZUFBZSxFQUFFLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsWUFBWSxDQUFDLENBQUMsQ0FBQyxTQUFTOzs7O1FBQUMsVUFBQyxvQkFBb0I7WUFDdkcsSUFBRyxLQUFJLENBQUMsT0FBTztnQkFBRSxPQUFPOztn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QUFXOytCQUVqQixLQUFLLFNBQUMsY0FBYzs7SUF5RXpCLDhCQUFDO0NBQUEsQUFyRkQsSUFxRkM7U0FsRlksdUJBQXVCOzs7Ozs7Ozs7SUFPaEMsK0NBQXlDOztJQUV6QywrQ0FBd0Q7Ozs7O0lBQ3hELHNEQUE0Qjs7Ozs7SUFFNUIsdUNBQWtCOzs7OztJQUVsQiwwQ0FBc0I7Ozs7Ozs7SUFLdEIsK0NBQXFDOzs7OztJQUVqQyw2Q0FBOEI7Ozs7O0lBQzlCLG9EQUE0Qzs7Ozs7SUFDNUMseUNBQXlCIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgRGlyZWN0aXZlLCBJbnB1dCwgRWxlbWVudFJlZiwgT25Jbml0LCBPbkRlc3Ryb3ksIFJlbmRlcmVyMiB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBWaWV3Q2hhbmdlU2VydmljZSB9IGZyb20gJy4vdmlldy1jaGFuZ2Uuc2VydmljZSc7XHJcbmltcG9ydCB7IFN1YmplY3QgfSBmcm9tICdyeGpzJztcclxuaW1wb3J0IHsgZmlsdGVyLCB0YWtlVW50aWwgfSBmcm9tICdyeGpzL29wZXJhdG9ycyc7XHJcbi8v6KeG5Zu+5Yy65Z+fXHJcbkBEaXJlY3RpdmUoe1xyXG4gICAgc2VsZWN0b3I6ICdbZlZpZXdJdGVtXSdcclxufSlcclxuZXhwb3J0IGNsYXNzIEZhcnJpc1ZpZXdJdGVtRGlyZWN0aXZlIGltcGxlbWVudHMgT25Jbml0LCBPbkRlc3Ryb3kge1xyXG4gICAgLyoq5L2/55So5pa55byPXHJcbiAgICAgKiA8ZGl2IFtmVmlld0l0ZW1dPVwiJ3R5cGUxMSdcIiBbZlZpZXdHcm91cElkXT1cIidncm91cDInXCI+XHJcbiAgICAgICAgIOinhuWbvueahOWGheWuueWMuuWfn1xyXG4gICAgICAgPC9kaXY+XHJcbiAgICAgKi9cclxuICAgIC8vIOW9k+WJjemhueeahOagh+iusFxyXG4gICAgQElucHV0KCdmVmlld0l0ZW0nKSB2aWV3SXRlbVR5cGU6IHN0cmluZztcclxuICAgIC8vIOW9k+WJjemhueaJgOWxnueahOe7hFxyXG4gICAgQElucHV0KCdmVmlld0dyb3VwSWQnKSBmVmlld0dyb3VwSWQ6IHN0cmluZyA9ICdkZWZhdWx0JztcclxuICAgIHByaXZhdGUgdmlld0NoYW5nZU1hbmFnZVNlcjtcclxuICAgIC8vIOiusOW9lU1vZHVsZeeahOagh+iusO+8jOeUqOadpeiOt+WPluW9k+WJjW1vZHVsZeS4i+eahOacjeWKoVxyXG4gICAgcHJpdmF0ZSBndWlkID0gXCJcIjtcclxuICAgIC8vIOino+WGs3ZpZXdDaGFuZ2VPbkluaXTkuI7nm5HlkKzmiafooYzlpJrmnaHmlbDmja7nmoTlhYjlkI7pobrluo/kuI3kuIDoh7RcclxuICAgIHByaXZhdGUgaGFzSW5pdD1mYWxzZTtcclxuICAgIC8qKlxyXG4gICAgICog5Y+q6KaB5omn6KGM6L+H5Yid5aeL5pa55rOV77yM5bCx6LCD55So44CCXHJcbiAgICAgKiDkv53or4Hlj6rmiafooYzkuIDmrKFcclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBjYW5jZWxTaWduYWwgPSBuZXcgU3ViamVjdCgpO1xyXG4gICAgY29uc3RydWN0b3IoXHJcbiAgICAgICAgcHJpdmF0ZSBlbGVtZW50UmVmOiBFbGVtZW50UmVmLFxyXG4gICAgICAgIHByaXZhdGUgdmlld0NoYW5nZVNlcnZpY2U6IFZpZXdDaGFuZ2VTZXJ2aWNlLFxyXG4gICAgICAgIHByaXZhdGUgcmVuZGVyOiBSZW5kZXJlcjJcclxuICAgICkge1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBuZ09uSW5pdCgpOiB2b2lkIHtcclxuICAgICAgICAvLyDlhYjlrZjlgqjliLDmnI3liqHph4ws5Zyo6L+Z5Liq5pa55rOV6YeM5Y+v6IO95Lya5omn6KGMdmlld0NoYW5nZU9uSW5pdCzkv67mlLloYXNJbml055qE5YC844CCXHJcbiAgICAgICAgdGhpcy52aWV3Q2hhbmdlU2VydmljZVsnc3RvcmVWaWV3Q2hhbmdlRGlyZWN0aXZlSW5zdGFuY2UnXSh0aGlzKTtcclxuICAgICAgICAvLyDop6PlhrPnu4Tku7bkuI7mjIfku6TliJvlu7rlhYjlkI7nmoTpl67pophcclxuICAgICAgICB0aGlzLnZpZXdDaGFuZ2VTZXJ2aWNlLmdldE1vZHVsZUNoYW5nZSgpLnBpcGUodGFrZVVudGlsKHRoaXMuY2FuY2VsU2lnbmFsKSkuc3Vic2NyaWJlKChjdXJNb2R1bGVHcm91cGRJbmZvcykgPT4ge1xyXG4gICAgICAgICAgICBpZih0aGlzLmhhc0luaXQpIHJldHVybjtcclxuICAgICAgICAgICAgbGV0IGZpbmRNb2R1bGVJbmZvPWN1ck1vZHVsZUdyb3VwZEluZm9zLmZpbmQoaXRlbT0+aXRlbVsnZ3JvdXBJZCddID09IHRoaXMuZlZpZXdHcm91cElkKVxyXG4gICAgICAgICAgICBpZiAoZmluZE1vZHVsZUluZm8pIHtcclxuICAgICAgICAgICAgICAgIHRoaXMudmlld0NoYW5nZU9uSW5pdChmaW5kTW9kdWxlSW5mb1snZ3VpZCddKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiDmoIforrDov5nkuKrmlrnms5VcclxuICAgICAqIEBwYXJhbSBndWlkIFxyXG4gICAgICogQHJldHVybnMgXHJcbiAgICAgKi9cclxuICAgIHZpZXdDaGFuZ2VPbkluaXQobmV3R3VpZDogc3RyaW5nKSB7XHJcbiAgICAgICAgaWYodGhpcy5oYXNJbml0KSByZXR1cm47XHJcbiAgICAgICAgdGhpcy5ndWlkID0gbmV3R3VpZDtcclxuICAgICAgICB0aGlzLmhhc0luaXQ9dHJ1ZTtcclxuICAgICAgICB0aGlzLmNhbmNlbFNpZ25hbC5uZXh0KCk7XHJcbiAgICAgICAgdGhpcy5jYW5jZWxTaWduYWwuY29tcGxldGUoKTtcclxuICAgICAgICB0aGlzLnZpZXdDaGFuZ2VNYW5hZ2VTZXIgPSB0aGlzLnZpZXdDaGFuZ2VTZXJ2aWNlLmdldE1vZHVsZUluZm8obmV3R3VpZCk7XHJcbiAgICAgICAgLy8g5L+d5a2YXHJcbiAgICAgICAgdGhpcy52aWV3Q2hhbmdlU2VydmljZS51cGRhdGVkU3RvcmVWaWV3Q2hhbmdlQ21wKHRoaXMuZ3VpZCx0aGlzLmZWaWV3R3JvdXBJZCx0aGlzLmVsZW1lbnRSZWYubmF0aXZlRWxlbWVudClcclxuICAgICAgICAvLyDliKDpmaRcclxuICAgICAgICB0aGlzLnZpZXdDaGFuZ2VTZXJ2aWNlWydyZW1vdmVWaWV3Q2hhbmdlRGlyZWN0aXZlSW5zdGFuY2UnXSh0aGlzLnZpZXdJdGVtVHlwZSwgdGhpcy5ndWlkKTtcclxuICAgICAgICAvLyDov73liqDliLDmnI3liqHkuK3nu5/kuIDnrqHnkIZcclxuICAgICAgICB0aGlzLnZpZXdDaGFuZ2VNYW5hZ2VTZXJbJ2FkZFZpZXdJdGVtJ10odGhpcy52aWV3SXRlbVR5cGUsIHRoaXMuZlZpZXdHcm91cElkKTtcclxuICAgICAgICB0aGlzLnZpZXdDaGFuZ2VNYW5hZ2VTZXJbJ2dldENoYW5nZUN1cnJlbnRWaWV3SWQnXSh0aGlzLmZWaWV3R3JvdXBJZCkuc3Vic2NyaWJlKChjdXJyZW50Vmlld1R5cGU6IGFueSk6IHZvaWQgPT4ge1xyXG4gICAgICAgICAgICBpZiAoIWN1cnJlbnRWaWV3VHlwZXx8IWN1cnJlbnRWaWV3VHlwZVt0aGlzLmZWaWV3R3JvdXBJZF0pIHJldHVybjtcclxuICAgICAgICAgICAgaWYgKGN1cnJlbnRWaWV3VHlwZVt0aGlzLmZWaWV3R3JvdXBJZF0gPT0gdGhpcy52aWV3SXRlbVR5cGUpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyLnJlbW92ZUNsYXNzKHRoaXMuZWxlbWVudFJlZi5uYXRpdmVFbGVtZW50LCAnZi12aWV3Y2hhbmdlLXZpZXctbm9uZScpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyLmFkZENsYXNzKHRoaXMuZWxlbWVudFJlZi5uYXRpdmVFbGVtZW50LCAnZi12aWV3Y2hhbmdlLXZpZXctbm9uZScpO1xyXG4gICAgICAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIG5nT25EZXN0cm95KCk6IHZvaWQge1xyXG4gICAgICAgIC8vIOmUgOavgeaXtuWIoOmZpOaVsOaNrlxyXG4gICAgICAgIGlmKHRoaXMudmlld0NoYW5nZU1hbmFnZVNlcil7XHJcbiAgICAgICAgICAgIHRoaXMudmlld0NoYW5nZU1hbmFnZVNlclsncmVtb3ZlVmlld0l0ZW0nXSh0aGlzLnZpZXdJdGVtVHlwZSwgdGhpcy5mVmlld0dyb3VwSWQpO1xyXG4gICAgICAgICAgICBpZiAodGhpcy52aWV3Q2hhbmdlTWFuYWdlU2VyWydoYXNWaWV3Q29udGFpbmVyJ10oKSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy52aWV3Q2hhbmdlU2VydmljZVsncmVtb3ZlTW9kdWxlSW5mbyddKHRoaXMuZ3VpZCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgLy/mnKrmiafooYzmlrnms5V2aWV3Q2hhbmdlT25Jbml0XHJcbiAgICAgICAgICAgIHRoaXMuY2FuY2VsU2lnbmFsPW51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxufSJdfQ==