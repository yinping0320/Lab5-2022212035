!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core"),require("@farris/ui-notify")):"function"==typeof define&&define.amd?define("@farris/ui-calculator",["exports","@angular/core","@farris/ui-notify"],e):e((t.farris=t.farris||{},t.farris["ui-calculator"]={}),t.ng.core,t.uiNotify)}(this,function(t,e,i){"use strict";var r=function(){function t(){}return t.decorators=[{type:e.Injectable,args:[{providedIn:"root"}]}],t.ctorParameters=function(){return[]},t.ngInjectableDef=e.defineInjectable({factory:function(){return new t},token:t,providedIn:"root"}),t}(),n=function(){function t(){}return t.prototype.ngOnInit=function(){},t.decorators=[{type:e.Component,args:[{selector:"farris-calculator",template:'<div class="standard-main" id="std-main" #calculator farrisCalculator>\n  <div class="title">\n    &nbsp;&nbsp;计算器\n  </div>\n  \x3c!--结果显示区域--\x3e\n  <div class="result">\n    \x3c!--显示类型信息--\x3e\n    <div class="type" id="std-show-bar">\n    ☰&nbsp;&nbsp;&nbsp;Stanard\n    </div>\n    \x3c!--上一步的结果--\x3e\n    <div class="pre">\n      <div class="pre_left" style="display:none;">&lt;</div>\n      <div class="pre_content" id="std-pre-step">\n        &nbsp;\n      </div>\n      <div class="pre_right" style="display:none;">&gt;</div>\n    </div>\n    \x3c!--第二个/运算结果--\x3e\n    <div class="res_out">\n      <div class="second" id="std-show-input">0</div>\n    </div>\n  </div>\n  \x3c!--数字和符号--\x3e\n  <ul id="std-num-symbol">\n    <li value="37" class="letter">CE</li>\n    <li value="38" class="letter">C</li>\n    <li value="39" class="letter">Back</li>\n    <li value="16" class="operator">÷</li>\n    <li class="number" value="7">7</li>\n    <li class="number" value="8">8</li>\n    <li class="number" value="9">9</li>\n    <li value="15" class="operator">×</li>\n    <li class="number" value="4">4</li>\n    <li class="number" value="5">5</li>\n    <li class="number" value="6">6</li>\n    <li value="14" class="operator">-</li>\n    <li class="number" value="1">1</li>\n    <li class="number" value="2">2</li>\n    <li class="number" value="3">3</li>\n    <li value="13" class="operator">+</li>\n    <li value="11">±</li>\n    <li class="number" value="0">0</li>\n    <li value="10">.</li>\n    <li value="12" class="operator">=</li>\n  </ul>\n</div>\n  ',styles:[".programmer-main,.science-main,.standard-main{background-color:#f1f1f1;margin:0 auto;box-shadow:0 0 15px #4d4d4d}ul{list-style:none;margin:0;padding:0}li{float:left;text-align:center;cursor:pointer}li img{height:14px}.title{padding:5px 0;height:30px;line-height:30px}.result{height:140px;text-align:right;width:100%}.res_out{width:335px;margin:0 5px;height:48px;overflow:hidden}.second{font-size:42px;font-weight:700;overflow-y:auto;white-space:nowrap;text-align:right}.pre{color:#a7a7a7;padding:0 20px;font-size:16px;height:24px;width:100%;overflow:hidden;position:relative;z-index:99}.pre .pre_left{width:16px;text-align:center;line-height:20px;height:24px;position:absolute;z-index:101;left:0;top:0;font-weight:600;cursor:pointer;background:#f1f1f1}.pre .pre_right{width:16px;text-align:center;line-height:20px;height:24px;position:absolute;z-index:101;right:0;top:0;font-weight:600;cursor:pointer;background:#f1f1f1}.pre .pre_content{text-align:right;height:24px;line-height:24px;white-space:nowrap;overflow-y:auto;overflow-x:hidden}.pre_left:hover,.pre_right:hover{color:#1853d1;background:#9b9b9b}.type{height:auto;text-align:left;font-weight:700;margin:10px 0 20px 10px;font-size:22px}.type-bar{display:none;height:90px;width:100px;position:absolute;top:110px;background-color:#e6e6e6}.type-bar li{float:left;width:100px;text-align:center;line-height:30px}.active{background-color:#cfcfcf}.number{font-weight:700;border:1px solid #fff!important;background:#fff!important}.number:hover{border:1px solid #f1f1f1!important;background:#c6c6c6!important}.operator:hover{border:1px solid #f1f1f1!important;background:#82bceb!important;color:#fff}.letter{font-size:16px}.standard-main{width:345px;height:460px}#std-num-symbol{height:270px;font-size:20px}#std-num-symbol li{line-height:48px;width:80px;margin:5px 0 0 5px;background:#dedede;border:1px solid #dedede}#std-num-symbol li:hover{background:#c6c6c6;border:1px solid #f1f1f1}"]}]}],t.ctorParameters=function(){return[]},t}();function s(t,e){var i="function"==typeof Symbol&&t[Symbol.iterator];if(!i)return t;var r,n,s=i.call(t),l=[];try{for(;(void 0===e||0<e--)&&!(r=s.next()).done;)l.push(r.value)}catch(a){n={error:a}}finally{try{r&&!r.done&&(i=s["return"])&&i.call(s)}finally{if(n)throw n.error}}return l}function o(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(s(arguments[e]));return t}function p(t){var e=t.toString().split(/[eE]/),i=(e[0].split(".")[1]||"").length-+(e[1]||0);return 0<i?i:0}function u(t){if(-1===t.toString().indexOf("e"))return Number(t.toString().replace(".",""));var e=p(t);return 0<e?function i(t,e){return void 0===e&&(e=12),+parseFloat(t.toPrecision(e))}(t*Math.pow(10,e)):t}function c(t){l&&(t>Number.MAX_SAFE_INTEGER||t<Number.MIN_SAFE_INTEGER)&&console.warn(t+" is beyond boundary when transfer to integer, the results may not be accurate")}function h(t,e){for(var i=[],r=2;r<arguments.length;r++)i[r-2]=arguments[r];if(0<i.length)return h.apply(void 0,o([h(t,e),i[0]],i.slice(1)));var n=u(t),s=u(e),l=p(t)+p(e),a=n*s;return c(a),a/Math.pow(10,l)}var l=!1,a=function(){function t(t,e,i,r){this.el=t,this.rd=e,this.notifyService=i,this.cdr=r,this.number=["0","1","2","3","4","5","6","7","8","9"],this.stepInputCache="",this.resultInputCache="0",this.preNumber=[],this.preOperator=[]}return t.prototype.ngOnInit=function(){var t=this;this.selfEl=this.el.nativeElement,this.stepEl=this.selfEl.querySelector("#std-pre-step"),this.resultEl=this.selfEl.querySelector("#std-show-input"),this.symbolEl=this.selfEl.querySelector("#std-num-symbol"),this.preEl=this.selfEl.querySelector(".pre"),this.leftEl=this.selfEl.querySelector(".pre_left"),this.rightEl=this.selfEl.querySelector(".pre_right"),this.rd.listen(this.rightEl,"click",function(){t.stepEl.scrollLeft+=50}),this.rd.listen(this.leftEl,"click",function(){t.stepEl.scrollLeft-=50})},t.prototype.ngAfterViewChecked=function(){this.calculateWidth()},t.prototype.calculateWidth=function(){this.stepEl.scrollWidth>this.preEl.offsetWidth?(this.leftEl.style.display="block",this.rightEl.style.display="block"):(this.leftEl.style.display="none",this.rightEl.style.display="none")},t.prototype.setStepInput=function(t){this.stepEl.innerHTML=t},t.prototype.setResultInput=function(t){this.resultEl.innerHTML=t},t.prototype.stepInputEndIsOperator=function(){return-1!==this.stepInputCache.lastIndexOf("+")||-1!==this.stepInputCache.lastIndexOf("-")||-1!==this.stepInputCache.lastIndexOf("×")||-1!==this.stepInputCache.lastIndexOf("÷")},t.prototype.calculate=function(t,e,i){var r;switch(t=Number(t),e=Number(e),i){case"+":r=function s(t,e){for(var i=[],r=2;r<arguments.length;r++)i[r-2]=arguments[r];if(0<i.length)return s.apply(void 0,o([s(t,e),i[0]],i.slice(1)));var n=Math.pow(10,Math.max(p(t),p(e)));return(h(t,n)+h(e,n))/n}(t,e);break;case"-":r=function l(t,e){for(var i=[],r=2;r<arguments.length;r++)i[r-2]=arguments[r];if(0<i.length)return l.apply(void 0,o([l(t,e),i[0]],i.slice(1)));var n=Math.pow(10,Math.max(p(t),p(e)));return(h(t,n)-h(e,n))/n}(t,e);break;case"×":r=h(t,e);break;case"÷":r=function a(t,e){for(var i=[],r=2;r<arguments.length;r++)i[r-2]=arguments[r];if(0<i.length)return a.apply(void 0,o([a(t,e),i[0]],i.slice(1)));var n=u(t),s=u(e);return c(n),c(s),h(n/s,Math.pow(10,p(e)-p(t)))}(t,e)}return r},t.prototype.numberClick=function(t){0===this.resultInputCache.indexOf("0")&&-1===this.resultInputCache.indexOf(".")||!0===this.firstInputToken?this.resultInputCache=t:this.resultInputCache+=t,this.firstInputToken=!1,this.equalToken=!1},t.prototype.dotClick=function(t){!0===this.firstInputToken?this.resultInputCache="0"+t:-1===this.resultInputCache.indexOf(".")&&(this.resultInputCache+=t),this.firstInputToken=!1,this.equalToken=!1},t.prototype.pnClick=function(){-1===this.resultInputCache.indexOf("-")&&"0"!==this.resultInputCache?this.resultInputCache="-"+this.resultInputCache:-1<this.resultInputCache.indexOf("-")&&"0"!==this.resultInputCache&&(this.resultInputCache=this.resultInputCache.substring(1))},t.prototype.operatorClick=function(t){if(this.preNumber.length<2&&(!0!==this.firstInputToken||!0===this.equalToken)?(this.resultInputCache=parseFloat(this.resultInputCache)+"",this.stepInputCache=this.stepInputCache+" "+this.resultInputCache+" "+t,this.preNumber.push(this.resultInputCache),this.preOperator.push(t),this.firstInputToken=!0):this.preNumber.length<2&&this.stepInputEndIsOperator()&&(this.stepInputCache=this.stepInputCache.substring(0,this.stepInputCache.length-1)+""+t,this.preOperator.push(t)),2===this.preNumber.length){var e=this.preOperator[this.preOperator.length-2];if("0"===this.preNumber[1]&&"÷"===e)return this.preNumber=[],this.resultInputCache="除数不能为零",this.stepInputCache="",void(this.firstInputToken=!0);var i=this.calculate(this.preNumber[0],this.preNumber[1],e);this.preNumber=[],this.preNumber.push(i),this.resultInputCache=i+"",this.firstInputToken=!0}this.cdr.detectChanges()},t.prototype.equalClick=function(){if(0<this.preNumber.length){var t=this.preOperator.pop();if("0"===this.resultInputCache&&"÷"===t)return this.preNumber=[],this.resultInputCache="除数不能为零",this.stepInputCache="",this.firstInputToken=!0,void(this.equalToken=!0);var e=this.calculate(this.preNumber[0],this.resultInputCache,t);this.preNumber=[],this.resultInputCache=e+"",this.stepInputCache="",this.firstInputToken=!0,this.equalToken=!0}this.cdr.detectChanges()},t.prototype.ceClick=function(){this.resultInputCache="0"},t.prototype.cClick=function(){this.resultInputCache="0",this.stepInputCache="",this.firstInputToken=!0,this.preNumber=[],this.preOperator=[],this.cdr.detectChanges()},t.prototype.backClick=function(){this.resultInputCache=1<this.resultInputCache.length?this.resultInputCache.substring(0,this.resultInputCache.length-1):"0"},t.prototype.click=function(t){if(this.symbolEl.contains(t.target)){var e=t.target.innerHTML;switch(e){case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":this.numberClick(e);break;case".":this.dotClick(e);break;case"±":this.pnClick();break;case"+":case"-":case"×":case"÷":this.operatorClick(e);break;case"=":this.equalClick();break;case"CE":this.ceClick();break;case"C":this.cClick();break;case"Back":this.backClick()}this.setStepInput(this.stepInputCache),this.setResultInput(this.resultInputCache)}},t.decorators=[{type:e.Directive,args:[{selector:"[farrisCalculator]"}]}],t.ctorParameters=function(){return[{type:e.ElementRef},{type:e.Renderer2},{type:i.NotifyService},{type:e.ChangeDetectorRef}]},t.propDecorators={click:[{type:e.HostListener,args:["click",["$event"]]}]},t}(),f=function(){function t(){}return t.decorators=[{type:e.NgModule,args:[{declarations:[n,a],imports:[i.NotifyModule],exports:[n,a]}]}],t}();t.CalculatorService=r,t.CalculatorComponent=n,t.CalculatorDirective=a,t.CalculatorModule=f,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=farris-ui-calculator.umd.min.js.map