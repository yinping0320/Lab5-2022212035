/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
/**
 * @desc 解决浮动运算问题，避免小数点后产生多位数和计算精度损失。
 * 问题示例：2.3 + 2.4 = 4.699999999999999，1.0 - 0.9 = 0.09999999999999998
 */
/**
 * 把错误的数据转正
 * strip(0.09999999999999998)=0.1
 * @param {?} num
 * @param {?=} precision
 * @return {?}
 */
function strip(num, precision) {
    if (precision === void 0) { precision = 12; }
    return +parseFloat(num.toPrecision(precision));
}
/**
 * Return digits length of a number
 * @param {?} num Input number
 * @return {?}
 */
function digitLength(num) {
    // Get digit length of e
    /** @type {?} */
    var eSplit = num.toString().split(/[eE]/);
    /** @type {?} */
    var len = (eSplit[0].split('.')[1] || '').length - +(eSplit[1] || 0);
    return len > 0 ? len : 0;
}
/**
 * 把小数转成整数，支持科学计数法。如果是小数则放大成整数
 * @param {?} num 输入数
 * @return {?}
 */
function float2Fixed(num) {
    if (num.toString().indexOf('e') === -1) {
        return Number(num.toString().replace('.', ''));
    }
    /** @type {?} */
    var dLen = digitLength(num);
    return dLen > 0 ? strip(num * Math.pow(10, dLen)) : num;
}
/**
 * 检测数字是否越界，如果越界给出提示
 * @param {?} num 输入数
 * @return {?}
 */
function checkBoundary(num) {
    if (_boundaryCheckingState) {
        if (num > Number.MAX_SAFE_INTEGER || num < Number.MIN_SAFE_INTEGER) {
            console.warn(num + " is beyond boundary when transfer to integer, the results may not be accurate");
        }
    }
}
/**
 * 精确乘法
 * @param {?} num1
 * @param {?} num2
 * @param {...?} others
 * @return {?}
 */
function times(num1, num2) {
    var others = [];
    for (var _i = 2; _i < arguments.length; _i++) {
        others[_i - 2] = arguments[_i];
    }
    if (others.length > 0) {
        return times.apply(void 0, tslib_1.__spread([times(num1, num2), others[0]], others.slice(1)));
    }
    /** @type {?} */
    var num1Changed = float2Fixed(num1);
    /** @type {?} */
    var num2Changed = float2Fixed(num2);
    /** @type {?} */
    var baseNum = digitLength(num1) + digitLength(num2);
    /** @type {?} */
    var leftValue = num1Changed * num2Changed;
    checkBoundary(leftValue);
    return leftValue / Math.pow(10, baseNum);
}
/**
 * 精确加法
 * @param {?} num1
 * @param {?} num2
 * @param {...?} others
 * @return {?}
 */
function plus(num1, num2) {
    var others = [];
    for (var _i = 2; _i < arguments.length; _i++) {
        others[_i - 2] = arguments[_i];
    }
    if (others.length > 0) {
        return plus.apply(void 0, tslib_1.__spread([plus(num1, num2), others[0]], others.slice(1)));
    }
    /** @type {?} */
    var baseNum = Math.pow(10, Math.max(digitLength(num1), digitLength(num2)));
    return (times(num1, baseNum) + times(num2, baseNum)) / baseNum;
}
/**
 * 精确减法
 * @param {?} num1
 * @param {?} num2
 * @param {...?} others
 * @return {?}
 */
function minus(num1, num2) {
    var others = [];
    for (var _i = 2; _i < arguments.length; _i++) {
        others[_i - 2] = arguments[_i];
    }
    if (others.length > 0) {
        return minus.apply(void 0, tslib_1.__spread([minus(num1, num2), others[0]], others.slice(1)));
    }
    /** @type {?} */
    var baseNum = Math.pow(10, Math.max(digitLength(num1), digitLength(num2)));
    return (times(num1, baseNum) - times(num2, baseNum)) / baseNum;
}
/**
 * 精确除法
 * @param {?} num1
 * @param {?} num2
 * @param {...?} others
 * @return {?}
 */
function divide(num1, num2) {
    var others = [];
    for (var _i = 2; _i < arguments.length; _i++) {
        others[_i - 2] = arguments[_i];
    }
    if (others.length > 0) {
        return divide.apply(void 0, tslib_1.__spread([divide(num1, num2), others[0]], others.slice(1)));
    }
    /** @type {?} */
    var num1Changed = float2Fixed(num1);
    /** @type {?} */
    var num2Changed = float2Fixed(num2);
    checkBoundary(num1Changed);
    checkBoundary(num2Changed);
    return times(num1Changed / num2Changed, Math.pow(10, digitLength(num2) - digitLength(num1)));
}
/**
 * 四舍五入
 * @param {?} num
 * @param {?} ratio
 * @return {?}
 */
function round(num, ratio) {
    /** @type {?} */
    var base = Math.pow(10, ratio);
    return divide(Math.round(times(num, base)), base);
}
/** @type {?} */
var _boundaryCheckingState = false;
/**
 * 是否进行边界检查，默认开启
 * @param {?=} flag 标记开关，true 为开启，false 为关闭，默认为 true
 * @return {?}
 */
function enableBoundaryChecking(flag) {
    if (flag === void 0) { flag = true; }
    _boundaryCheckingState = flag;
}
export { strip, plus, minus, times, divide, round, digitLength, float2Fixed, enableBoundaryChecking };
export default {
    strip: strip,
    plus: plus,
    minus: minus,
    times: times,
    divide: divide,
    round: round,
    digitLength: digitLength,
    float2Fixed: float2Fixed,
    enableBoundaryChecking: enableBoundaryChecking
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicHJlY2lzaW9uLmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGZhcnJpcy91aS1jYWxjdWxhdG9yLyIsInNvdXJjZXMiOlsibGliL3ByZWNpc2lvbi50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7O0FBU0EsU0FBUyxLQUFLLENBQUMsR0FBVyxFQUFFLFNBQWM7SUFBZCwwQkFBQSxFQUFBLGNBQWM7SUFDdEMsT0FBTyxDQUFDLFVBQVUsQ0FBQyxHQUFHLENBQUMsV0FBVyxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUM7QUFDbkQsQ0FBQzs7Ozs7O0FBTUQsU0FBUyxXQUFXLENBQUMsR0FBVzs7O1FBRXRCLE1BQU0sR0FBRyxHQUFHLENBQUMsUUFBUSxFQUFFLENBQUMsS0FBSyxDQUFDLE1BQU0sQ0FBQzs7UUFDckMsR0FBRyxHQUFHLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxFQUFFLENBQUMsQ0FBQyxNQUFNLEdBQUcsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUM7SUFDdEUsT0FBTyxHQUFHLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztBQUM3QixDQUFDOzs7Ozs7QUFNRCxTQUFTLFdBQVcsQ0FBQyxHQUFXO0lBQzVCLElBQUksR0FBRyxDQUFDLFFBQVEsRUFBRSxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDLENBQUMsRUFBRTtRQUNwQyxPQUFPLE1BQU0sQ0FBQyxHQUFHLENBQUMsUUFBUSxFQUFFLENBQUMsT0FBTyxDQUFDLEdBQUcsRUFBRSxFQUFFLENBQUMsQ0FBQyxDQUFDO0tBQ2xEOztRQUNLLElBQUksR0FBRyxXQUFXLENBQUMsR0FBRyxDQUFDO0lBQzdCLE9BQU8sSUFBSSxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLEdB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QztBQUNELE9BQU8sRUFDSCxLQUFLLEVBQ0wsSUFBSSxFQUNKLEtBQUssRUFDTCxLQUFLLEVBQ0wsTUFBTSxFQUNOLEtBQUssRUFDTCxXQUFXLEVBQ1gsV0FBVyxFQUNYLHNCQUFzQixFQUN6QixDQUFDO0FBQ0YsZUFBZTtJQUNYLEtBQUssT0FBQTtJQUNMLElBQUksTUFBQTtJQUNKLEtBQUssT0FBQTtJQUNMLEtBQUssT0FBQTtJQUNMLE1BQU0sUUFBQTtJQUNOLEtBQUssT0FBQTtJQUNMLFdBQVcsYUFBQTtJQUNYLFdBQVcsYUFBQTtJQUNYLHNCQUFzQix3QkFBQTtDQUN6QixDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIEBkZXNjIOino+WGs+a1ruWKqOi/kOeul+mXrumimO+8jOmBv+WFjeWwj+aVsOeCueWQjuS6p+eUn+WkmuS9jeaVsOWSjOiuoeeul+eyvuW6puaNn+WkseOAglxyXG4gKiDpl67popjnpLrkvovvvJoyLjMgKyAyLjQgPSA0LjY5OTk5OTk5OTk5OTk5Oe+8jDEuMCAtIDAuOSA9IDAuMDk5OTk5OTk5OTk5OTk5OThcclxuICovXHJcblxyXG4vKipcclxuICog5oqK6ZSZ6K+v55qE5pWw5o2u6L2s5q2jXHJcbiAqIHN0cmlwKDAuMDk5OTk5OTk5OTk5OTk5OTgpPTAuMVxyXG4gKi9cclxuZnVuY3Rpb24gc3RyaXAobnVtOiBudW1iZXIsIHByZWNpc2lvbiA9IDEyKTogbnVtYmVyIHtcclxuICAgIHJldHVybiArcGFyc2VGbG9hdChudW0udG9QcmVjaXNpb24ocHJlY2lzaW9uKSk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBSZXR1cm4gZGlnaXRzIGxlbmd0aCBvZiBhIG51bWJlclxyXG4gKiBAcGFyYW0gbnVtIElucHV0IG51bWJlclxyXG4gKi9cclxuZnVuY3Rpb24gZGlnaXRMZW5ndGgobnVtOiBudW1iZXIpOiBudW1iZXIge1xyXG4gICAgLy8gR2V0IGRpZ2l0IGxlbmd0aCBvZiBlXHJcbiAgICBjb25zdCBlU3BsaXQgPSBudW0udG9TdHJpbmcoKS5zcGxpdCgvW2VFXS8pO1xyXG4gICAgY29uc3QgbGVuID0gKGVTcGxpdFswXS5zcGxpdCgnLicpWzFdIHx8ICcnKS5sZW5ndGggLSArKGVTcGxpdFsxXSB8fCAwKTtcclxuICAgIHJldHVybiBsZW4gPiAwID8gbGVuIDogMDtcclxufVxyXG5cclxuLyoqXHJcbiAqIOaKiuWwj+aVsOi9rOaIkOaVtOaVsO+8jOaUr+aMgeenkeWtpuiuoeaVsOazleOAguWmguaenOaYr+Wwj+aVsOWImeaUvuWkp+aIkOaVtOaVsFxyXG4gKiBAcGFyYW0gbnVtIOi+k+WFpeaVsFxyXG4gKi9cclxuZnVuY3Rpb24gZmxvYXQyRml4ZWQobnVtOiBudW1iZXIpOiBudW1iZXIge1xyXG4gICAgaWYgKG51bS50b1N0cmluZygpLmluZGV4T2YoJ2UnKSA9PT0gLTEpIHtcclxuICAgICAgICByZXR1cm4gTnVtYmVyKG51bS50b1N0cmluZygpLnJlcGxhY2UoJy4nLCAnJykpO1xyXG4gICAgfVxyXG4gICAgY29uc3QgZExlbiA9IGRpZ2l0TGVuZ3RoKG51bSk7XHJcbiAgICByZXR1cm4gZExlbiA+IDAgPyBzdHJpcChudW0gKiBNYXRoLnBvdygxMCwgZExlbikpIDogbnVtO1xyXG59XHJcblxyXG4vKipcclxuICog5qOA5rWL5pWw5a2X5piv5ZCm6LaK55WM77yM5aaC5p6c6LaK55WM57uZ5Ye65o+Q56S6XHJcbiAqIEBwYXJhbSBudW0g6L6T5YWl5pWwXHJcbiAqL1xyXG5mdW5jdGlvbiBjaGVja0JvdW5kYXJ5KG51bTogbnVtYmVyKSB7XHJcbiAgICBpZiAoX2JvdW5kYXJ5Q2hlY2tpbmdTdGF0ZSkge1xyXG4gICAgICAgIGlmIChudW0gPiBOdW1iZXIuTUFYX1NBRkVfSU5URUdFUiB8fCBudW0gPCBOdW1iZXIuTUlOX1NBRkVfSU5URUdFUikge1xyXG4gICAgICAgICAgICBjb25zb2xlLndhcm4oXHJcbiAgICAgICAgICAgICAgICBgJHtudW19IGlzIGJleW9uZCBib3VuZGFyeSB3aGVuIHRyYW5zZmVyIHRvIGludGVnZXIsIHRoZSByZXN1bHRzIG1heSBub3QgYmUgYWNjdXJhdGVgXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcblxyXG4vKipcclxuICog57K+56Gu5LmY5rOVXHJcbiAqL1xyXG5mdW5jdGlvbiB0aW1lcyhudW0xOiBudW1iZXIsIG51bTI6IG51bWJlciwgLi4ub3RoZXJzOiBudW1iZXJbXSk6IG51bWJlciB7XHJcbiAgICBpZiAob3RoZXJzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICByZXR1cm4gdGltZXModGltZXMobnVtMSwgbnVtMiksIG90aGVyc1swXSwgLi4ub3RoZXJzLnNsaWNlKDEpKTtcclxuICAgIH1cclxuICAgIGNvbnN0IG51bTFDaGFuZ2VkID0gZmxvYXQyRml4ZWQobnVtMSk7XHJcbiAgICBjb25zdCBudW0yQ2hhbmdlZCA9IGZsb2F0MkZpeGVkKG51bTIpO1xyXG4gICAgY29uc3QgYmFzZU51bSA9IGRpZ2l0TGVuZ3RoKG51bTEpICsgZGlnaXRMZW5ndGgobnVtMik7XHJcbiAgICBjb25zdCBsZWZ0VmFsdWUgPSBudW0xQ2hhbmdlZCAqIG51bTJDaGFuZ2VkO1xyXG5cclxuICAgIGNoZWNrQm91bmRhcnkobGVmdFZhbHVlKTtcclxuXHJcbiAgICByZXR1cm4gbGVmdFZhbHVlIC8gTWF0aC5wb3coMTAsIGJhc2VOdW0pO1xyXG59XHJcblxyXG4vKipcclxuICog57K+56Gu5Yqg5rOVXHJcbiAqL1xyXG5mdW5jdGlvbiBwbHVzKG51bTE6IG51bWJlciwgbnVtMjogbnVtYmVyLCAuLi5vdGhlcnM6IG51bWJlcltdKTogbnVtYmVyIHtcclxuICAgIGlmIChvdGhlcnMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgIHJldHVybiBwbHVzKHBsdXMobnVtMSwgbnVtMiksIG90aGVyc1swXSwgLi4ub3RoZXJzLnNsaWNlKDEpKTtcclxuICAgIH1cclxuICAgIGNvbnN0IGJhc2VOdW0gPSBNYXRoLnBvdygxMCwgTWF0aC5tYXgoZGlnaXRMZW5ndGgobnVtMSksIGRpZ2l0TGVuZ3RoKG51bTIpKSk7XHJcbiAgICByZXR1cm4gKHRpbWVzKG51bTEsIGJhc2VOdW0pICsgdGltZXMobnVtMiwgYmFzZU51bSkpIC8gYmFzZU51bTtcclxufVxyXG5cclxuLyoqXHJcbiAqIOeyvuehruWHj+azlVxyXG4gKi9cclxuZnVuY3Rpb24gbWludXMobnVtMTogbnVtYmVyLCBudW0yOiBudW1iZXIsIC4uLm90aGVyczogbnVtYmVyW10pOiBudW1iZXIge1xyXG4gICAgaWYgKG90aGVycy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgcmV0dXJuIG1pbnVzKG1pbnVzKG51bTEsIG51bTIpLCBvdGhlcnNbMF0sIC4uLm90aGVycy5zbGljZSgxKSk7XHJcbiAgICB9XHJcbiAgICBjb25zdCBiYXNlTnVtID0gTWF0aC5wb3coMTAsIE1hdGgubWF4KGRpZ2l0TGVuZ3RoKG51bTEpLCBkaWdpdExlbmd0aChudW0yKSkpO1xyXG4gICAgcmV0dXJuICh0aW1lcyhudW0xLCBiYXNlTnVtKSAtIHRpbWVzKG51bTIsIGJhc2VOdW0pKSAvIGJhc2VOdW07XHJcbn1cclxuXHJcbi8qKlxyXG4gKiDnsr7noa7pmaTms5VcclxuICovXHJcbmZ1bmN0aW9uIGRpdmlkZShudW0xOiBudW1iZXIsIG51bTI6IG51bWJlciwgLi4ub3RoZXJzOiBudW1iZXJbXSk6IG51bWJlciB7XHJcbiAgICBpZiAob3RoZXJzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICByZXR1cm4gZGl2aWRlKGRpdmlkZShudW0xLCBudW0yKSwgb3RoZXJzWzBdLCAuLi5vdGhlcnMuc2xpY2UoMSkpO1xyXG4gICAgfVxyXG4gICAgY29uc3QgbnVtMUNoYW5nZWQgPSBmbG9hdDJGaXhlZChudW0xKTtcclxuICAgIGNvbnN0IG51bTJDaGFuZ2VkID0gZmxvYXQyRml4ZWQobnVtMik7XHJcbiAgICBjaGVja0JvdW5kYXJ5KG51bTFDaGFuZ2VkKTtcclxuICAgIGNoZWNrQm91bmRhcnkobnVtMkNoYW5nZWQpO1xyXG4gICAgcmV0dXJuIHRpbWVzKFxyXG4gICAgICAgIG51bTFDaGFuZ2VkIC8gbnVtMkNoYW5nZWQsXHJcbiAgICAgICAgTWF0aC5wb3coMTAsIGRpZ2l0TGVuZ3RoKG51bTIpIC0gZGlnaXRMZW5ndGgobnVtMSkpXHJcbiAgICApO1xyXG59XHJcblxyXG4vKipcclxuICog5Zub6IiN5LqU5YWlXHJcbiAqL1xyXG5mdW5jdGlvbiByb3VuZChudW06IG51bWJlciwgcmF0aW86IG51bWJlcik6IG51bWJlciB7XHJcbiAgICBjb25zdCBiYXNlID0gTWF0aC5wb3coMTAsIHJhdGlvKTtcclxuICAgIHJldHVybiBkaXZpZGUoTWF0aC5yb3VuZCh0aW1lcyhudW0sIGJhc2UpKSwgYmFzZSk7XHJcbn1cclxuXHJcbmxldCBfYm91bmRhcnlDaGVja2luZ1N0YXRlID0gZmFsc2U7XHJcbi8qKlxyXG4gKiDmmK/lkKbov5vooYzovrnnlYzmo4Dmn6XvvIzpu5jorqTlvIDlkK9cclxuICogQHBhcmFtIGZsYWcg5qCH6K6w5byA5YWz77yMdHJ1ZSDkuLrlvIDlkK/vvIxmYWxzZSDkuLrlhbPpl63vvIzpu5jorqTkuLogdHJ1ZVxyXG4gKi9cclxuZnVuY3Rpb24gZW5hYmxlQm91bmRhcnlDaGVja2luZyhmbGFnID0gdHJ1ZSkge1xyXG4gICAgX2JvdW5kYXJ5Q2hlY2tpbmdTdGF0ZSA9IGZsYWc7XHJcbn1cclxuZXhwb3J0IHtcclxuICAgIHN0cmlwLFxyXG4gICAgcGx1cyxcclxuICAgIG1pbnVzLFxyXG4gICAgdGltZXMsXHJcbiAgICBkaXZpZGUsXHJcbiAgICByb3VuZCxcclxuICAgIGRpZ2l0TGVuZ3RoLFxyXG4gICAgZmxvYXQyRml4ZWQsXHJcbiAgICBlbmFibGVCb3VuZGFyeUNoZWNraW5nXHJcbn07XHJcbmV4cG9ydCBkZWZhdWx0IHtcclxuICAgIHN0cmlwLFxyXG4gICAgcGx1cyxcclxuICAgIG1pbnVzLFxyXG4gICAgdGltZXMsXHJcbiAgICBkaXZpZGUsXHJcbiAgICByb3VuZCxcclxuICAgIGRpZ2l0TGVuZ3RoLFxyXG4gICAgZmxvYXQyRml4ZWQsXHJcbiAgICBlbmFibGVCb3VuZGFyeUNoZWNraW5nXHJcbn07XHJcbiJdfQ==