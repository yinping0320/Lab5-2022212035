/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, Input, Output, Directive, TemplateRef, ContentChild, EventEmitter, } from "@angular/core";
export class ProgressStepItemTemplateDirective {
    /**
     * @param {?} template
     */
    constructor(template) {
        this.template = template;
    }
}
ProgressStepItemTemplateDirective.decorators = [
    { type: Directive, args: [{
                selector: "[progressStepItem]",
            },] }
];
/** @nocollapse */
ProgressStepItemTemplateDirective.ctorParameters = () => [
    { type: TemplateRef }
];
if (false) {
    /** @type {?} */
    ProgressStepItemTemplateDirective.prototype.template;
}
export class ProgressStepExtendTemplateDirective {
    /**
     * @param {?} template
     */
    constructor(template) {
        this.template = template;
    }
}
ProgressStepExtendTemplateDirective.decorators = [
    { type: Directive, args: [{
                selector: "[progressStepExtend]",
            },] }
];
/** @nocollapse */
ProgressStepExtendTemplateDirective.ctorParameters = () => [
    { type: TemplateRef }
];
if (false) {
    /** @type {?} */
    ProgressStepExtendTemplateDirective.prototype.template;
}
/**
 * @record
 */
export function stepMessage() { }
if (false) {
    /** @type {?} */
    stepMessage.prototype.id;
    /** @type {?} */
    stepMessage.prototype.title;
    /** @type {?|undefined} */
    stepMessage.prototype.icon;
    /** @type {?|undefined} */
    stepMessage.prototype.status;
    /** @type {?|undefined} */
    stepMessage.prototype.clickDisable;
    /** @type {?|undefined} */
    stepMessage.prototype.hidden;
    /** @type {?|undefined} */
    stepMessage.prototype.class;
}
/**
 * @record
 */
export function progressData() { }
if (false) {
    /** @type {?} */
    progressData.prototype.activeIndex;
    /** @type {?} */
    progressData.prototype.stepMessages;
}
export class ProgressStepComponent {
    constructor() {
        //进度条数据
        // @Input() stepData:progressData;
        /**
         * 横向horizontal、竖向排列vertical
         */
        this.direction = "horizontal";
        /**
         * 是否铺满
         */
        this.fill = false;
        /**
         * 是否支持点击
         */
        this.clickable = false;
        // 步骤条整体样式
        this.stepsCls = "";
        this.stepClick = new EventEmitter();
        this.storedIndexState = false;
        /**
         * 记录当前步骤所在的位置，从0开始
         */
        this.activeIndex = 0;
    }
    /**
     * @param {?} value
     * @return {?}
     */
    set subStepData(value) {
        this._subStepData = value;
    }
    /**
     * @return {?}
     */
    get subStepData() {
        return this._subStepData;
    }
    /**
     * @return {?}
     */
    ngOnInit() { }
    /**
     * @param {?} value
     * @return {?}
     */
    set stepData(value) {
        if (value) {
            // 二选一属性，重置
            this.steps = null;
            this.stepInit(value);
        }
    }
    /**
     * @return {?}
     */
    get stepData() {
        return this._stepData;
    }
    /**
     * @param {?} changes
     * @return {?}
     */
    ngOnChanges(changes) {
        if (changes["steps"] || changes["currentId"]) {
            // steps没有值或者stepData有值，都不处理，这两个属性对用户是二选一
            if (!this.steps || this.stepData) {
                return;
            }
            this.steps.forEach((/**
             * @param {?} item
             * @return {?}
             */
            (item) => (item.status = "")));
            this.stepMessages = this.steps.filter((/**
             * @param {?} item
             * @return {?}
             */
            (item) => !item.hidden));
            /** @type {?} */
            let index = this.stepMessages.findIndex((/**
             * @param {?} item
             * @return {?}
             */
            (item) => item.id === this.currentId));
            this.activeIndex = index === -1 ? 0 : index;
        }
    }
    /**
     * 点击某一步
     * @param {?} step
     * @param {?} index
     * @return {?}
     */
    listClick(step, index) {
        if (this.clickable) {
            this.stepClick.emit({ "step": step, "index": index });
        }
    }
    /**
     * @param {?} index
     * @return {?}
     */
    goStep(index) {
        if (this.storedIndexState) {
            if (this.activeIndex == index) {
                this.currentIndex = null;
            }
            else {
                this.currentIndex = index;
            }
        }
        else {
            this.stepMessages.forEach((/**
             * @param {?} step
             * @param {?} i
             * @return {?}
             */
            (step, i) => {
                if (i < index) {
                    step.status = "finish";
                }
                else if (i > index) {
                    step.status = "";
                }
                else {
                    step.status = "active";
                }
            }));
            this.activeIndex = index;
        }
    }
    /**
     * 下一步
     * @return {?}
     */
    nextStep() {
        if (this.storedIndexState &&
            this.currentIndex < this.stepMessages.length - 1) {
            this.currentIndex++;
        }
        if (this.activeIndex < this.stepMessages.length - 1) {
            this.stepMessages[this.activeIndex].status = "finish";
            this.stepMessages[this.activeIndex + 1].status = "active";
            this.activeIndex++;
            if (this.storedIndexState) {
                this.currentIndex = this.activeIndex;
            }
        }
        //return this.activeIndex;
    }
    /**
     * 上一步
     * @return {?}
     */
    prevStep() {
        // if(this.storedIndexState && this.currentIndex > 0){
        //   this.currentIndex--;
        // }
        if (this.activeIndex > 0) {
            // else if(this.activeIndex > 0 && !this.storedIndexState){
            this.stepMessages[this.activeIndex].status = "";
            this.stepMessages[this.activeIndex - 1].status = "active";
            this.activeIndex--;
            if (this.storedIndexState) {
                this.currentIndex = this.activeIndex;
            }
        }
        //return this.activeIndex;
    }
    /**
     * @return {?}
     */
    getCurrentStepIndex() {
        return this.activeIndex;
    }
    /**
     * @param {?} data
     * @return {?}
     */
    stepInit(data) {
        if (data["stepMessages"] && data["stepMessages"].length) {
            data["stepMessages"].forEach((/**
             * @param {?} step
             * @return {?}
             */
            (step) => {
                //if(typeof step.status === 'undefined'){
                step.status = "";
                //}
            }));
            this.stepMessages = data["stepMessages"].filter((/**
             * @param {?} step
             * @return {?}
             */
            (step) => {
                return !step.hidden;
            }));
        }
        this.activeIndex = data["activeIndex"];
        if (this.storedIndexState) {
            this.currentIndex = this.activeIndex;
        }
    }
    /**
     * @param {?} progressData
     * @return {?}
     */
    setProgressData(progressData) {
        if (progressData) {
            //this.stepData = progressData;
            this.stepInit(progressData);
        }
    }
    /**
     * @param {?} num
     * @return {?}
     */
    setActiveIndex(num) {
        /** @type {?} */
        let activeNum = num >= 0 && num < this.stepMessages.length ? num : 0;
        this.activeIndex = activeNum;
    }
}
ProgressStepComponent.decorators = [
    { type: Component, args: [{
                selector: "farris-progress-step",
                template: "<div class=\"f-progress-step\">\r\n    <ul class=\"{{stepsCls}}\"\r\n    [ngClass]=\"{'f-progress-step-list':direction ==='horizontal', 'f-progress-step-list-block': direction ==='vertical','f-progress-step-horizontal-fill':direction==='horizontal' && fill,'f-progress-step-vertical-fill':direction==='vertical' && fill,'f-progress-step-has-extend':progressStepExtendTmpl}\"\r\n    [ngStyle]=\"{'height': direction ==='vertical'? fHeight +'px' :''}\"\r\n    >\r\n        <ng-container *ngFor=\"let step of stepMessages;let i = index;\">\r\n            <li [ngStyle]=\"stepStyle\" class=\"step {{step.status? step.status:(i < activeIndex ? 'finish': '')}}  {{step.hasOwnProperty('class')?step.class:''}}\" *ngIf=\"!step.hidden\" [ngClass]=\"{'active': i == activeIndex,'clickable':clickable,'click-disable':step.clickDisable,'current':i == currentIndex,'step-has-extend':progressStepExtendTmpl}\" (click)=\"listClick(step,i)\">\r\n                <ng-container *ngIf=\"!progressStepTemplate;else stepElement\">\r\n                    <div class=\"f-progressstep-row {{step.status? 'step-'+ step.status:(i < activeIndex ? 'step-finish': '')}}\" [ngClass]=\"{'step-active': i == activeIndex,'step-current':i == currentIndex}\" *ngIf=\"!step['subSteps'] || !step['subSteps'].length\">\r\n                        <div class=\"f-progress-step-content\">\r\n                            <span class=\"step-icon\" [ngClass]=\"step.icon\" *ngIf=\"step.icon;else defaultIcon\" ></span>\r\n                            <ng-template #defaultIcon>\r\n                                    <span class=\"step-icon\" *ngIf=\"i >= activeIndex || i == currentIndex; else stepSuccess\">{{i+1}}</span>\r\n                                    <ng-template #stepSuccess>\r\n                                        <span class=\"step-icon step-success k-icon k-i-check\" [ngClass]=\"step.icon\"></span>\r\n                                    </ng-template>\r\n                            </ng-template>\r\n            \r\n                            <div class=\"f-progress-step-title\">  \r\n                                <p class=\"step-name\" [ngClass]=\"{'step-name-success': i <= activeIndex}\">{{step.title}}</p>\r\n                            </div>\r\n                        </div>\r\n                            \r\n                        <div class=\"f-progress-step-line\" [ngClass]=\"{'f-progress-step-line-success': i == activeIndex}\"  *ngIf=\"i !== (stepMessages.length-1)\">\r\n                            <span class=\"triangle\" [ngClass]=\"{'f-progress-step-vertical-triangle': direction ==='vertical'}\"></span>\r\n                        </div>\r\n                    </div>\r\n                    <div class=\"f-progressstep-row f-progressstep-row-multi\" *ngIf=\"step['subSteps'] && step['subSteps'].length\">\r\n                        <div class=\"f-step-multi-item\" \r\n                        *ngFor=\"let subStep of step.subSteps;let subIndex = index\"  \r\n                        [ngClass]=\"{'f-step-multi-item-hidden': subStep.visible === false,\r\n                        'f-step-multi-item-active':(activeIndex == i && subStepData && subStepData[step.id] == subIndex),\r\n                        'f-step-multi-item-finish':(activeIndex > i && subStepData && subStepData[step.id] == subIndex)}\"\r\n                        >\r\n                            <div class=\"f-progress-step-content f-progressstep-multi-item-content\">\r\n                                <span class=\"step-icon\" \r\n                                *ngIf=\"(activeIndex <= i || i == currentIndex); else stepSuccess\"\r\n                                >{{i+1}}</span>\r\n                                <ng-template #stepSuccess>\r\n                                    <span class=\"step-icon step-icon-done k-icon k-i-check\" *ngIf=\"subStepData && subStepData[step.id] == subIndex;else doneTemplate\"></span>\r\n                                    <ng-template #doneTemplate>\r\n                                        <span class=\"step-icon k-icon k-i-check\"></span>\r\n                                    </ng-template>\r\n                                </ng-template>\r\n\r\n                                <div class=\"f-progress-step-title\">\r\n                                    <p class=\"step-name\">{{subStep.title}} </p>\r\n                                </div>\r\n                            </div>\r\n                            <div class=\"f-progress-step-line\"  [ngClass]=\"{'f-progress-step-line-success': (activeIndex == i && subStep.active)}\" *ngIf=\"i !== (step.length-1)\"><span class=\"triangle\"></span></div>\r\n                        </div>\r\n                    </div>\r\n                    <ng-container [ngTemplateOutlet]=\"progressStepExtendTmpl\" [ngTemplateOutletContext]=\"{ step: step, index: i,length: stepMessages.length, activeIndex: activeIndex, direction: direction}\"></ng-container>            \r\n                </ng-container>\r\n                \r\n                <ng-template #stepElement>\r\n                    <ng-container [ngTemplateOutlet]=\"progressStepTemplate\" [ngTemplateOutletContext]=\"{ step: step, index: i,length: stepMessages.length, activeIndex: activeIndex, direction: direction}\"></ng-container>\r\n                </ng-template>             \r\n                \r\n            </li>\r\n        </ng-container>\r\n    </ul>\r\n    <div *ngIf=\"!stepMessages || !stepMessages.length\" class=\"f-progress-step-empty\">{{ 'progressStep.empty' | locale }}</div>\r\n    <!-- <button (click)=\"nextStep()\" [disabled]=\"activeIndex >= (stepMessages.length-1)\">\u4E0B\u4E00\u6B65</button>\r\n    <button (click)=\"prevStep()\" [disabled]=\"activeIndex <= 0\">\u4E0A\u4E00\u6B65</button> -->\r\n</div>",
                styles: [".f-progress-step .f-progress-step-list{display:-webkit-box;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;flex-direction:row;-webkit-box-align:center;align-items:center}.f-progress-step .step{display:inline-block}.f-progress-step .step .f-progressstep-row{display:-webkit-box;display:flex;position:relative;padding-right:.4375rem;padding-bottom:.9375rem}.f-progress-step .step .f-progressstep-row .f-progress-step-content{display:inline-block}.f-progress-step .step .f-progressstep-row .f-progress-step-content .step-icon{display:inline-block;width:1.875rem;height:1.875rem;margin-right:.5rem;margin-left:.5rem;line-height:1.875rem;border-radius:100%;font-size:.75rem;text-align:center;color:#fff;vertical-align:middle}.f-progress-step .step .f-progressstep-row .f-progress-step-content .f-progress-step-title{display:inline-block;vertical-align:middle}.f-progress-step .step .f-progressstep-row .f-progress-step-content .f-progress-step-title .step-message,.f-progress-step .step .f-progressstep-row .f-progress-step-content .f-progress-step-title .step-name{margin-bottom:0}.f-progress-step .step .f-progressstep-row .f-progress-step-content .f-progress-step-title .step-name{font-size:.875rem;color:#8c8c8c;line-height:1.25rem;padding-right:.625rem}.f-progress-step .step .f-progressstep-row .f-progress-step-content .f-progress-step-title .step-name.step-name-success{color:#000;opacity:.85}.f-progress-step .step .f-progressstep-row .f-progress-step-line{-webkit-box-flex:1;flex:1 1 auto;position:relative;display:-webkit-inline-box;display:inline-flex;min-width:3.75rem;vertical-align:middle}.f-progress-step .step .f-progressstep-row .f-progress-step-line::after{content:'';left:0;height:.125rem;overflow:hidden;position:absolute;right:.625rem;top:50%;margin-top:-.0625rem}.f-progress-step .step .f-progressstep-row .f-progress-step-line .triangle{position:absolute;right:0;top:50%;display:inline-block;width:.4375rem;height:.4375rem;margin-top:-.21875rem;-webkit-transform:rotate(45deg);transform:rotate(45deg)}.f-progress-step .f-progress-step-list-block .step{display:block}.f-progress-step .f-progress-step-list-block .step .f-progressstep-row{padding:0;-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-direction:column}.f-progress-step .f-progress-step-list-block .step .f-progressstep-row .f-progress-step-line{-webkit-box-flex:1;flex:1 1 auto;width:.625rem;min-width:.625rem;min-height:2.5rem;margin:.5rem 0 1.25rem 1.375rem}.f-progress-step .f-progress-step-list-block .step .f-progressstep-row .f-progress-step-line::after{content:'';border-top:0}.f-progress-step .f-progress-step-list-block .step .f-progressstep-row .f-progress-step-line .triangle{top:auto;left:-.3125rem;bottom:-.5rem;border-top:0}.f-progress-step .f-progress-step-list-block .step .f-progressstep-row .f-progress-step-line .f-progress-step-title .step-name{padding-right:.875rem}.f-progress-step .f-progress-step-horizontal-fill{display:-webkit-box;display:flex;-webkit-box-pack:justify;justify-content:space-between;flex-wrap:wrap}.f-progress-step .f-progress-step-horizontal-fill .step{-webkit-box-flex:1;flex:1 1 auto}.f-progress-step .f-progress-step-vertical-fill{display:-webkit-box;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-direction:column;align-content:space-between}.f-progress-step .f-progress-step-vertical-fill .step{display:-webkit-box;display:flex;-webkit-box-flex:1;flex:1 1 auto}.f-progress-step .f-progress-step-vertical-fill .step .f-progressstep-row{-webkit-box-flex:1;flex:1 1 auto;display:-webkit-box;display:flex}.f-progress-step li.clickable{cursor:pointer}.f-progress-step li.click-disable{cursor:not-allowed}.f-progress-step .f-progress-step-empty{color:#000;opacity:.65;font-size:.875rem}.f-progress-step .f-progressstep-row-multi{display:-webkit-box;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-direction:column;-webkit-box-align:left;align-items:left}.f-progress-step .f-progressstep-row-multi .f-progressstep-multi-item-content{display:-webkit-box;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;flex-direction:row;-webkit-box-align:center;align-items:center;cursor:pointer}.f-progress-step .f-progressstep-row-multi .f-step-multi-item{position:relative;padding-right:.4375rem;padding-bottom:.9375rem}.f-progress-step .f-progressstep-row-multi .f-step-multi-item:last-child{padding-bottom:0}.f-progress-step .f-progressstep-row-multi .f-step-multi-item.f-step-multi-item-active .f-progress-step-title .step-name,.f-progress-step .f-progressstep-row-multi .f-step-multi-item.f-step-multi-item-finish .f-progress-step-title .step-name{color:rgba(0,0,0,.85)!important}.f-progress-step .f-progress-step-list-block .step .f-progressstep-row.f-progressstep-row-multi{-webkit-box-orient:horizontal;-webkit-box-direction:normal;flex-direction:row}.f-progress-step .f-progress-step-list-block .step .f-progressstep-row.f-progressstep-row-multi .f-step-multi-item{padding:0;-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-direction:column}.f-progress-step .f-progress-step-list-block .step .f-progressstep-row.f-progressstep-row-multi .f-step-multi-item .f-progress-step-line{display:block}"]
            }] }
];
/** @nocollapse */
ProgressStepComponent.ctorParameters = () => [];
ProgressStepComponent.propDecorators = {
    progressStepTemplate: [{ type: ContentChild, args: [ProgressStepItemTemplateDirective, { read: TemplateRef },] }],
    progressStepExtendTmpl: [{ type: ContentChild, args: [ProgressStepExtendTemplateDirective, { read: TemplateRef },] }],
    direction: [{ type: Input }],
    fill: [{ type: Input }],
    clickable: [{ type: Input }],
    stepsCls: [{ type: Input }],
    fHeight: [{ type: Input }],
    stepStyle: [{ type: Input }],
    stepClick: [{ type: Output, args: ["stepClick",] }],
    steps: [{ type: Input }],
    currentId: [{ type: Input }],
    storedIndexState: [{ type: Input }],
    subStepData: [{ type: Input }],
    stepData: [{ type: Input }]
};
if (false) {
    /** @type {?} */
    ProgressStepComponent.prototype.progressStepTemplate;
    /** @type {?} */
    ProgressStepComponent.prototype.progressStepExtendTmpl;
    /**
     * 横向horizontal、竖向排列vertical
     * @type {?}
     */
    ProgressStepComponent.prototype.direction;
    /**
     * 是否铺满
     * @type {?}
     */
    ProgressStepComponent.prototype.fill;
    /**
     * 是否支持点击
     * @type {?}
     */
    ProgressStepComponent.prototype.clickable;
    /** @type {?} */
    ProgressStepComponent.prototype.stepsCls;
    /** @type {?} */
    ProgressStepComponent.prototype.fHeight;
    /** @type {?} */
    ProgressStepComponent.prototype.stepStyle;
    /** @type {?} */
    ProgressStepComponent.prototype.stepClick;
    /**
     * steps与stepData，选择一个使用
     * 指定步骤条数据，是数组。常用在写自定义模版的地方。
     * [{id:string,title:string,icon?string,hidden?boolean}]
     * @type {?}
     */
    ProgressStepComponent.prototype.steps;
    /**
     * 指定当前步骤的数据Id
     * @type {?}
     */
    ProgressStepComponent.prototype.currentId;
    /** @type {?} */
    ProgressStepComponent.prototype.storedIndexState;
    /**
     * 指定子项数据中，哪个是活动的
     * {子项步骤id:指定子项处于活动步骤的顺序}比如{"data3":2}
     * @type {?}
     */
    ProgressStepComponent.prototype._subStepData;
    /**
     * 过滤隐藏的步骤信息，记录当前显示的步骤条，
     * @type {?}
     */
    ProgressStepComponent.prototype.stepMessages;
    /**
     * 记录当前步骤所在的位置，从0开始
     * @type {?}
     */
    ProgressStepComponent.prototype.activeIndex;
    /** @type {?} */
    ProgressStepComponent.prototype.currentIndex;
    /**
     * @type {?}
     * @private
     */
    ProgressStepComponent.prototype.innerStepData;
    /**
     * steps与stepData，选择一个使用。
     * stepData常被表单绑定使用，数据类型
     * {activeIndex:number,stepMessages:[{id:string,title:string,icon?string,hidden?boolean}]}
     * activeIndex: 指定活动的步骤在数组中的位置,
     * stepMessages: 所有步骤数据的数组
     * @type {?}
     */
    ProgressStepComponent.prototype._stepData;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicHJvZ3Jlc3Mtc3RlcC5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZmFycmlzL3VpLXByb2dyZXNzLXN0ZXAvIiwic291cmNlcyI6WyJsaWIvcHJvZ3Jlc3Mtc3RlcC5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUFBLE9BQU8sRUFDTCxTQUFTLEVBRVQsS0FBSyxFQUNMLE1BQU0sRUFDTixTQUFTLEVBQ1QsV0FBVyxFQUNYLFlBQVksRUFDWixZQUFZLEdBR2IsTUFBTSxlQUFlLENBQUM7QUFLdkIsTUFBTSxPQUFPLGlDQUFpQzs7OztJQUM1QyxZQUFtQixRQUEwQjtRQUExQixhQUFRLEdBQVIsUUFBUSxDQUFrQjtJQUFJLENBQUM7OztZQUpuRCxTQUFTLFNBQUM7Z0JBQ1QsUUFBUSxFQUFFLG9CQUFvQjthQUMvQjs7OztZQVRDLFdBQVc7Ozs7SUFXQyxxREFBaUM7O0FBTS9DLE1BQU0sT0FBTyxtQ0FBbUM7Ozs7SUFDOUMsWUFBbUIsUUFBMEI7UUFBMUIsYUFBUSxHQUFSLFFBQVEsQ0FBa0I7SUFBSSxDQUFDOzs7WUFKbkQsU0FBUyxTQUFDO2dCQUNULFFBQVEsRUFBRSxzQkFBc0I7YUFDakM7Ozs7WUFoQkMsV0FBVzs7OztJQWtCQyx1REFBaUM7Ozs7O0FBRy9DLGlDQVFDOzs7SUFQQyx5QkFBVzs7SUFDWCw0QkFBYzs7SUFDZCwyQkFBYzs7SUFDZCw2QkFBZ0I7O0lBQ2hCLG1DQUF1Qjs7SUFDdkIsNkJBQWlCOztJQUNqQiw0QkFBZTs7Ozs7QUFFakIsa0NBR0M7OztJQUZDLG1DQUFvQjs7SUFDcEIsb0NBQTRCOztBQVE5QixNQUFNLE9BQU8scUJBQXFCO0lBMERoQzs7Ozs7O1FBaERTLGNBQVMsR0FBRyxZQUFZLENBQUM7Ozs7UUFFekIsU0FBSSxHQUFZLEtBQUssQ0FBQzs7OztRQUV0QixjQUFTLEdBQVksS0FBSyxDQUFDOztRQUUzQixhQUFRLEdBQUcsRUFBRSxDQUFDO1FBSUYsY0FBUyxHQUFHLElBQUks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O2dCQUNULFFBQVEsRUFBRSxzQkFBc0I7Z0JBQ2hDLDhvTEFBNkM7O2FBRTlDOzs7OzttQ0FFRSxZQUFZLFNBQUMsaUNBQWlDLEVBQUUsRUFBRSxJQUFJLEVBQUUsV0FBVyxFQUFFO3FDQUVyRSxZQUFZLFNBQUMsbUNBQW1DLEVBQUUsRUFBRSxJQUFJLEVBQUUsV0FBVyxFQUFFO3dCQU92RSxLQUFLO21CQUVMLEtBQUs7d0JBRUwsS0FBSzt1QkFFTCxLQUFLO3NCQUNMLEtBQUs7d0JBRUwsS0FBSzt3QkFDTCxNQUFNLFNBQUMsV0FBVztvQkFPbEIsS0FBSzt3QkFJTCxLQUFLOytCQUNMLEtBQUs7MEJBT0wsS0FBSzt1QkE4QkwsS0FBSzs7OztJQXBFTixxREFDdUM7O0lBQ3ZDLHVEQUN5Qzs7Ozs7SUFNekMsMENBQWtDOzs7OztJQUVsQyxxQ0FBK0I7Ozs7O0lBRS9CLDBDQUFvQzs7SUFFcEMseUNBQXVCOztJQUN2Qix3Q0FBeUI7O0lBRXpCLDBDQUF3Qjs7SUFDeEIsMENBQW9EOzs7Ozs7O0lBT3BELHNDQUE4Qjs7Ozs7SUFJOUIsMENBQTJCOztJQUMzQixpREFBMkM7Ozs7OztJQU0zQyw2Q0FBYTs7Ozs7SUFXYiw2Q0FBNEI7Ozs7O0lBSTVCLDRDQUF3Qjs7SUFDeEIsNkNBQXFCOzs7OztJQUVyQiw4Q0FBb0M7Ozs7Ozs7OztJQVlwQywwQ0FBd0IiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xyXG4gIENvbXBvbmVudCxcclxuICBPbkluaXQsXHJcbiAgSW5wdXQsXHJcbiAgT3V0cHV0LFxyXG4gIERpcmVjdGl2ZSxcclxuICBUZW1wbGF0ZVJlZixcclxuICBDb250ZW50Q2hpbGQsXHJcbiAgRXZlbnRFbWl0dGVyLFxyXG4gIE9uQ2hhbmdlcyxcclxuICBTaW1wbGVDaGFuZ2VzLFxyXG59IGZyb20gXCJAYW5ndWxhci9jb3JlXCI7XHJcblxyXG5ARGlyZWN0aXZlKHtcclxuICBzZWxlY3RvcjogXCJbcHJvZ3Jlc3NTdGVwSXRlbV1cIixcclxufSlcclxuZXhwb3J0IGNsYXNzIFByb2dyZXNzU3RlcEl0ZW1UZW1wbGF0ZURpcmVjdGl2ZSB7XHJcbiAgY29uc3RydWN0b3IocHVibGljIHRlbXBsYXRlOiBUZW1wbGF0ZVJlZjxhbnk+KSB7IH1cclxufVxyXG5cclxuQERpcmVjdGl2ZSh7XHJcbiAgc2VsZWN0b3I6IFwiW3Byb2dyZXNzU3RlcEV4dGVuZF1cIixcclxufSlcclxuZXhwb3J0IGNsYXNzIFByb2dyZXNzU3RlcEV4dGVuZFRlbXBsYXRlRGlyZWN0aXZlIHtcclxuICBjb25zdHJ1Y3RvcihwdWJsaWMgdGVtcGxhdGU6IFRlbXBsYXRlUmVmPGFueT4pIHsgfVxyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIHN0ZXBNZXNzYWdlIHtcclxuICBpZDogc3RyaW5nO1xyXG4gIHRpdGxlOiBzdHJpbmc7XHJcbiAgaWNvbj86IHN0cmluZztcclxuICBzdGF0dXM/OiBzdHJpbmc7XHJcbiAgY2xpY2tEaXNhYmxlPzogYm9vbGVhbjtcclxuICBoaWRkZW4/OiBib29sZWFuO1xyXG4gIGNsYXNzPzogc3RyaW5nO1xyXG59XHJcbmV4cG9ydCBpbnRlcmZhY2UgcHJvZ3Jlc3NEYXRhIHtcclxuICBhY3RpdmVJbmRleDogbnVtYmVyO1xyXG4gIHN0ZXBNZXNzYWdlczogc3RlcE1lc3NhZ2VbXTtcclxufVxyXG5cclxuQENvbXBvbmVudCh7XHJcbiAgc2VsZWN0b3I6IFwiZmFycmlzLXByb2dyZXNzLXN0ZXBcIixcclxuICB0ZW1wbGF0ZVVybDogXCIuL3Byb2dyZXNzLXN0ZXAuY29tcG9uZW50Lmh0bWxcIixcclxuICBzdHlsZVVybHM6IFtcIi4vcHJvZ3Jlc3Mtc3RlcC5jb21wb25lbnQuc2Nzc1wiXSxcclxufSlcclxuZXhwb3J0IGNsYXNzIFByb2dyZXNzU3RlcENvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCwgT25DaGFuZ2VzIHtcclxuICBAQ29udGVudENoaWxkKFByb2dyZXNzU3RlcEl0ZW1UZW1wbGF0ZURpcmVjdGl2ZSwgeyByZWFkOiBUZW1wbGF0ZVJlZiB9KVxyXG4gIHByb2dyZXNzU3RlcFRlbXBsYXRlOiBUZW1wbGF0ZVJlZjxhbnk+O1xyXG4gIEBDb250ZW50Q2hpbGQoUHJvZ3Jlc3NTdGVwRXh0ZW5kVGVtcGxhdGVEaXJlY3RpdmUsIHsgcmVhZDogVGVtcGxhdGVSZWYgfSlcclxuICBwcm9ncmVzc1N0ZXBFeHRlbmRUbXBsOiBUZW1wbGF0ZVJlZjxhbnk+O1xyXG5cclxuICAvL+i/m+W6puadoeaVsOaNrlxyXG4gIC8vIEBJbnB1dCgpIHN0ZXBEYXRhOnByb2dyZXNzRGF0YTtcclxuXHJcbiAgLyoq5qiq5ZCRaG9yaXpvbnRhbOOAgeerluWQkeaOkuWIl3ZlcnRpY2FsKi9cclxuICBASW5wdXQoKSBkaXJlY3Rpb24gPSBcImhvcml6b250YWxcIjtcclxuICAvKirmmK/lkKbpk7rmu6EgKi9cclxuICBASW5wdXQoKSBmaWxsOiBib29sZWFuID0gZmFsc2U7XHJcbiAgLyoq5piv5ZCm5pSv5oyB54K55Ye7ICovXHJcbiAgQElucHV0KCkgY2xpY2thYmxlOiBib29sZWFuID0gZmFsc2U7XHJcbiAgLy8g5q2l6aqk5p2h5pW05L2T5qC35byPXHJcbiAgQElucHV0KCkgc3RlcHNDbHMgPSBcIlwiO1xyXG4gIEBJbnB1dCgpIGZIZWlnaHQ6IG51bWJlcjtcclxuICAvLyDmraXpqqTmnaFTdHlsZSzlhpnms5UgW3N0ZXBTdHlsZV09XCJ7J21heC13aWR0aCc6JzEwMHB4J31cIlxyXG4gIEBJbnB1dCgpIHN0ZXBTdHlsZTogYW55O1xyXG4gIEBPdXRwdXQoXCJzdGVwQ2xpY2tcIikgc3RlcENsaWNrID0gbmV3IEV2ZW50RW1pdHRlcigpO1xyXG5cclxuICAvKipcclxuICAgKiBzdGVwc+S4jnN0ZXBEYXRh77yM6YCJ5oup5LiA5Liq5L2/55SoXHJcbiAgICog5oyH5a6a5q2l6aqk5p2h5pWw5o2u77yM5piv5pWw57uE44CC5bi455So5Zyo5YaZ6Ieq5a6a5LmJ5qih54mI55qE5Zyw5pa544CCXHJcbiAgICogW3tpZDpzdHJpbmcsdGl0bGU6c3RyaW5nLGljb24/c3RyaW5nLGhpZGRlbj9ib29sZWFufV1cclxuICAgKi9cclxuICBASW5wdXQoKSBzdGVwczogc3RlcE1lc3NhZ2VbXTtcclxuICAvKipcclxuICAgKiDmjIflrprlvZPliY3mraXpqqTnmoTmlbDmja5JZFxyXG4gICAqL1xyXG4gIEBJbnB1dCgpIGN1cnJlbnRJZDogc3RyaW5nO1xyXG4gIEBJbnB1dCgpIHN0b3JlZEluZGV4U3RhdGU6IGJvb2xlYW4gPSBmYWxzZTtcclxuXHJcbiAgLyoqXHJcbiAgICog5oyH5a6a5a2Q6aG55pWw5o2u5Lit77yM5ZOq5Liq5piv5rS75Yqo55qEXHJcbiAgICoge+WtkOmhueatpemqpGlkOuaMh+WumuWtkOmhueWkhOS6jua0u+WKqOatpemqpOeahOmhuuW6j33mr5TlpoJ7XCJkYXRhM1wiOjJ9XHJcbiAgICovXHJcbiAgX3N1YlN0ZXBEYXRhO1xyXG4gIEBJbnB1dCgpXHJcbiAgc2V0IHN1YlN0ZXBEYXRhKHZhbHVlKSB7XHJcbiAgICB0aGlzLl9zdWJTdGVwRGF0YSA9IHZhbHVlO1xyXG4gIH1cclxuICBnZXQgc3ViU3RlcERhdGEoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5fc3ViU3RlcERhdGE7XHJcbiAgfVxyXG4gIC8qKlxyXG4gICAqIOi/h+a7pOmakOiXj+eahOatpemqpOS/oeaBr++8jOiusOW9leW9k+WJjeaYvuekuueahOatpemqpOadoe+8jFxyXG4gICAqL1xyXG4gIHN0ZXBNZXNzYWdlczogc3RlcE1lc3NhZ2VbXTtcclxuICAvKipcclxuICAgKiDorrDlvZXlvZPliY3mraXpqqTmiYDlnKjnmoTkvY3nva7vvIzku44w5byA5aeLXHJcbiAgICovXHJcbiAgYWN0aXZlSW5kZXg6IG51bWJlciA9IDA7XHJcbiAgY3VycmVudEluZGV4OiBudW1iZXI7XHJcblxyXG4gIHByaXZhdGUgaW5uZXJTdGVwRGF0YTogcHJvZ3Jlc3NEYXRhO1xyXG5cclxuICBjb25zdHJ1Y3RvcigpIHsgfVxyXG5cclxuICBuZ09uSW5pdCgpIHsgfVxyXG4gIC8qKlxyXG4gICAqIHN0ZXBz5LiOc3RlcERhdGHvvIzpgInmi6nkuIDkuKrkvb/nlKjjgIJcclxuICAgKiBzdGVwRGF0YeW4uOiiq+ihqOWNlee7keWumuS9v+eUqO+8jOaVsOaNruexu+Wei1xyXG4gICAqIHthY3RpdmVJbmRleDpudW1iZXIsc3RlcE1lc3NhZ2VzOlt7aWQ6c3RyaW5nLHRpdGxlOnN0cmluZyxpY29uP3N0cmluZyxoaWRkZW4/Ym9vbGVhbn1dfVxyXG4gICAqIGFjdGl2ZUluZGV4OiDmjIflrprmtLvliqjnmoTmraXpqqTlnKjmlbDnu4TkuK3nmoTkvY3nva4sXHJcbiAgICogc3RlcE1lc3NhZ2VzOiDmiYDmnInmraXpqqTmlbDmja7nmoTmlbDnu4RcclxuICAgKi9cclxuICBfc3RlcERhdGE6IHByb2dyZXNzRGF0YTtcclxuICBASW5wdXQoKVxyXG4gIHNldCBzdGVwRGF0YSh2YWx1ZSkge1xyXG4gICAgaWYgKHZhbHVlKSB7XHJcbiAgICAgIC8vIOS6jOmAieS4gOWxnuaAp++8jOmHjee9rlxyXG4gICAgICB0aGlzLnN0ZXBzID0gbnVsbDtcclxuICAgICAgdGhpcy5zdGVwSW5pdCh2YWx1ZSk7XHJcbiAgICB9XHJcbiAgfVxyXG4gIGdldCBzdGVwRGF0YSgpIHtcclxuICAgIHJldHVybiB0aGlzLl9zdGVwRGF0YTtcclxuICB9XHJcblxyXG4gIG5nT25DaGFuZ2VzKGNoYW5nZXM6IFNpbXBsZUNoYW5nZXMpIHtcclxuICAgIGlmIChjaGFuZ2VzW1wic3RlcHNcIl0gfHwgY2hhbmdlc1tcImN1cnJlbnRJZFwiXSkge1xyXG4gICAgICAvLyBzdGVwc+ayoeacieWAvOaIluiAhXN0ZXBEYXRh5pyJ5YC877yM6YO95LiN5aSE55CG77yM6L+Z5Lik5Liq5bGe5oCn5a+555So5oi35piv5LqM6YCJ5LiAXHJcbiAgICAgIGlmICghdGhpcy5zdGVwcyB8fCB0aGlzLnN0ZXBEYXRhKSB7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgICB9XHJcbiAgICAgIHRoaXMuc3RlcHMuZm9yRWFjaCgoaXRlbSkgPT4gKGl0ZW0uc3RhdHVzID0gXCJcIikpO1xyXG4gICAgICB0aGlzLnN0ZXBNZXNzYWdlcyA9IHRoaXMuc3RlcHMuZmlsdGVyKChpdGVtKSA9PiAhaXRlbS5oaWRkZW4pO1xyXG4gICAgICBsZXQgaW5kZXggPSB0aGlzLnN0ZXBNZXNzYWdlcy5maW5kSW5kZXgoXHJcbiAgICAgICAgKGl0ZW0pID0+IGl0ZW0uaWQgPT09IHRoaXMuY3VycmVudElkXHJcbiAgICAgICk7XHJcbiAgICAgIHRoaXMuYWN0aXZlSW5kZXggPSBpbmRleCA9PT0gLTEgPyAwIDogaW5kZXg7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKirngrnlh7vmn5DkuIDmraUgKi9cclxuICBsaXN0Q2xpY2soc3RlcCwgaW5kZXgpIHtcclxuICAgIGlmICh0aGlzLmNsaWNrYWJsZSkge1xyXG4gICAgICB0aGlzLnN0ZXBDbGljay5lbWl0KHsgXCJzdGVwXCI6IHN0ZXAsIFwiaW5kZXhcIjogaW5kZXggfSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBnb1N0ZXAoaW5kZXgpIHtcclxuICAgIGlmICh0aGlzLnN0b3JlZEluZGV4U3RhdGUpIHtcclxuICAgICAgaWYgKHRoaXMuYWN0aXZlSW5kZXggPT0gaW5kZXgpIHtcclxuICAgICAgICB0aGlzLmN1cnJlbnRJbmRleCA9IG51bGw7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgdGhpcy5jdXJyZW50SW5kZXggPSBpbmRleDtcclxuICAgICAgfVxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5zdGVwTWVzc2FnZXMuZm9yRWFjaCgoc3RlcCwgaSkgPT4ge1xyXG4gICAgICAgIGlmIChpIDwgaW5kZXgpIHtcclxuICAgICAgICAgIHN0ZXAuc3RhdHVzID0gXCJmaW5pc2hcIjtcclxuICAgICAgICB9IGVsc2UgaWYgKGkgPiBpbmRleCkge1xyXG4gICAgICAgICAgc3RlcC5zdGF0dXMgPSBcIlwiO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBzdGVwLnN0YXR1cyA9IFwiYWN0aXZlXCI7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICAgICAgdGhpcy5hY3RpdmVJbmRleCA9IGluZGV4O1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoq5LiL5LiA5q2lICovXHJcbiAgbmV4dFN0ZXAoKSB7XHJcbiAgICBpZiAoXHJcbiAgICAgIHRoaXMuc3RvcmVkSW5kZXhTdGF0ZSAmJlxyXG4gICAgICB0aGlzLmN1cnJlbnRJbmRleCA8IHRoaXMuc3RlcE1lc3NhZ2VzLmxlbmd0aCAtIDFcclxuICAgICkge1xyXG4gICAgICB0aGlzLmN1cnJlbnRJbmRleCsrO1xyXG4gICAgfVxyXG4gICAgaWYgKHRoaXMuYWN0aXZlSW5kZXggPCB0aGlzLnN0ZXBNZXNzYWdlcy5sZW5ndGggLSAxKSB7XHJcbiAgICAgIHRoaXMuc3RlcE1lc3NhZ2VzW3RoaXMuYWN0aXZlSW5kZXhdLnN0YXR1cyA9IFwiZmluaXNoXCI7XHJcbiAgICAgIHRoaXMuc3RlcE1lc3NhZ2VzW3RoaXMuYWN0aXZlSW5kZXggKyAxXS5zdGF0dXMgPSBcImFjdGl2ZVwiO1xyXG4gICAgICB0aGlzLmFjdGl2ZUluZGV4Kys7XHJcbiAgICAgIGlmICh0aGlzLnN0b3JlZEluZGV4U3RhdGUpIHtcclxuICAgICAgICB0aGlzLmN1cnJlbnRJbmRleCA9IHRoaXMuYWN0aXZlSW5kZXg7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIC8vcmV0dXJuIHRoaXMuYWN0aXZlSW5kZXg7XHJcbiAgfVxyXG4gIC8qKuS4iuS4gOatpSAqL1xyXG4gIHByZXZTdGVwKCkge1xyXG4gICAgLy8gaWYodGhpcy5zdG9yZWRJbmRleFN0YXRlICYmIHRoaXMuY3VycmVudEluZGV4ID4gMCl7XHJcbiAgICAvLyAgIHRoaXMuY3VycmVudEluZGV4LS07XHJcbiAgICAvLyB9XHJcbiAgICBpZiAodGhpcy5hY3RpdmVJbmRleCA+IDApIHtcclxuICAgICAgLy8gZWxzZSBpZih0aGlzLmFjdGl2ZUluZGV4ID4gMCAmJiAhdGhpcy5zdG9yZWRJbmRleFN0YXRlKXtcclxuICAgICAgdGhpcy5zdGVwTWVzc2FnZXNbdGhpcy5hY3RpdmVJbmRleF0uc3RhdHVzID0gXCJcIjtcclxuICAgICAgdGhpcy5zdGVwTWVzc2FnZXNbdGhpcy5hY3RpdmVJbmRleCAtIDFdLnN0YXR1cyA9IFwiYWN0aXZlXCI7XHJcbiAgICAgIHRoaXMuYWN0aXZlSW5kZXgtLTtcclxuICAgICAgaWYgKHRoaXMuc3RvcmVkSW5kZXhTdGF0ZSkge1xyXG4gICAgICAgIHRoaXMuY3VycmVudEluZGV4ID0gdGhpcy5hY3RpdmVJbmRleDtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgLy9yZXR1cm4gdGhpcy5hY3RpdmVJbmRleDtcclxuICB9XHJcblxyXG4gIGdldEN1cnJlbnRTdGVwSW5kZXgoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5hY3RpdmVJbmRleDtcclxuICB9XHJcblxyXG4gIHN0ZXBJbml0KGRhdGEpIHtcclxuICAgIGlmIChkYXRhW1wic3RlcE1lc3NhZ2VzXCJdICYmIGRhdGFbXCJzdGVwTWVzc2FnZXNcIl0ubGVuZ3RoKSB7XHJcbiAgICAgIGRhdGFbXCJzdGVwTWVzc2FnZXNcIl0uZm9yRWFjaCgoc3RlcCkgPT4ge1xyXG4gICAgICAgIC8vaWYodHlwZW9mIHN0ZXAuc3RhdHVzID09PSAndW5kZWZpbmVkJyl7XHJcbiAgICAgICAgc3RlcC5zdGF0dXMgPSBcIlwiO1xyXG4gICAgICAgIC8vfVxyXG4gICAgICB9KTtcclxuICAgICAgdGhpcy5zdGVwTWVzc2FnZXMgPSBkYXRhW1wic3RlcE1lc3NhZ2VzXCJdLmZpbHRlcigoc3RlcCkgPT4ge1xyXG4gICAgICAgIHJldHVybiAhc3RlcC5oaWRkZW47XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgdGhpcy5hY3RpdmVJbmRleCA9IGRhdGFbXCJhY3RpdmVJbmRleFwiXTtcclxuICAgIGlmICh0aGlzLnN0b3JlZEluZGV4U3RhdGUpIHtcclxuICAgICAgdGhpcy5jdXJyZW50SW5kZXggPSB0aGlzLmFjdGl2ZUluZGV4O1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgc2V0UHJvZ3Jlc3NEYXRhKHByb2dyZXNzRGF0YTogcHJvZ3Jlc3NEYXRhKSB7XHJcbiAgICBpZiAocHJvZ3Jlc3NEYXRhKSB7XHJcbiAgICAgIC8vdGhpcy5zdGVwRGF0YSA9IHByb2dyZXNzRGF0YTtcclxuICAgICAgdGhpcy5zdGVwSW5pdChwcm9ncmVzc0RhdGEpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgc2V0QWN0aXZlSW5kZXgobnVtOiBudW1iZXIpIHtcclxuICAgIGxldCBhY3RpdmVOdW06IG51bWJlciA9XHJcbiAgICAgIG51bSA+PSAwICYmIG51bSA8IHRoaXMuc3RlcE1lc3NhZ2VzLmxlbmd0aCA/IG51bSA6IDA7XHJcbiAgICB0aGlzLmFjdGl2ZUluZGV4ID0gYWN0aXZlTnVtO1xyXG4gIH1cclxufVxyXG4iXX0=