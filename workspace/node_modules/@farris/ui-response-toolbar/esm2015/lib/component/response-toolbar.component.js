/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, Input, ViewChild, ElementRef, Renderer2, ChangeDetectorRef, HostBinding, Output, EventEmitter, NgZone } from "@angular/core";
import { ResponseToolbarDropDown, ResponseToolbarItem, ResponseToolbarGroup } from "../model/response-toolbar.model";
import { FResizedDirective } from "../resized/f-resized.directive";
import { Subject, Observable } from "rxjs";
import { debounceTime } from "rxjs/operators";
import { LocaleService } from "@farris/ui-locale";
import ResizeObserver from "resize-observer-polyfill";
export class ResponseToolbarComponent {
    /**
     * @param {?} el
     * @param {?} render
     * @param {?} cd
     * @param {?} localeService
     */
    constructor(el, render, cd, localeService) {
        this.render = render;
        this.cd = cd;
        this.localeService = localeService;
        this.frtCls = true;
        this.prCls = true;
        // 传递点击事件
        this.rtClickEvent = new EventEmitter();
        // 辅助计算宽度数据
        this.auxiliaryDatas = [];
        // 控制父元素滚动的样式
        //  private _dpState = false;
        //
        this.ro = null;
        // 记录容器宽度
        this.containerWidthRecord = 0;
        // 记录变化
        this.needResponseChanges = 0;
        this.referEl = null;
        this.dpState = [false];
        // 用来内部记录
        this._auxiliary = -1;
        this.resizeGroups = [];
        // 记录格式化后的数据
        this.toolbarDatas = [];
        this.distanceThreshold = 20;
        this.isUpdateTBView = false;
        this._stateDatas = new Subject();
        this._btnVisibleDatas = new Subject();
        this.clickThrottleTime = 350;
        this.clickItems = new Subject();
        this.rtSize = "";
        /*强制方向，默认为空值，可以有top、bottom，朝上、朝下。
             * 使用场景：工具栏内部的下拉，需要朝上或者需要朝下展开，统一控制
             */
        this.popDirection = "";
        // right按钮靠右 left按钮靠左
        this.btnAlign = "right";
        this.ngZone = null;
        this._selfEl = el.nativeElement;
        if (el.nativeElement.parentElement) {
            this.referEl = el.nativeElement.parentElement;
        }
    }
    // 内部记录格式化后的初始数据-------------------------暂时不用
    // _toolbarDatas: Array<ResponseToolbarItem | ResponseToolbarDropDown> = [];
    /**
     * @param {?} values
     * @return {?}
     */
    set groups(values) {
        if (values) {
            this.resizeGroups = [];
            values.forEach((/**
             * @param {?} group
             * @return {?}
             */
            group => {
                this.resizeGroups.push(new ResponseToolbarGroup(group.id, group.name));
                // 还没有计算预置排序
            }));
        }
    }
    /**
     * @param {?} values
     * @return {?}
     */
    set datas(values) {
        if (values) {
            this.toolbarDatas = this._formatData(values);
            this.needResponseChanges++;
            // 处理分组数据
            this._reOrganizeResizeGroups();
        }
    }
    // 按钮的禁用状态
    /**
     * @param {?} values
     * @return {?}
     */
    set btnState(values) {
        this._stateDatas = values;
    }
    // 按钮的查看状态
    /**
     * @param {?} values
     * @return {?}
     */
    set btnVisible(values) {
        this._btnVisibleDatas = values;
    }
    /*尺寸：有sm,lg,空值，默认是空值 */
    /**
     * @param {?} btnSize
     * @return {?}
     */
    set buttonSize(btnSize) {
        if (btnSize != this.rtSize) {
            this.rtSize &&
                this.render.removeClass(this._selfEl, "f-response-toolbar-" + this.rtSize);
            this.rtSize = btnSize;
            this.rtSize &&
                this.render.addClass(this._selfEl, "f-response-toolbar-" + this.rtSize);
        }
    }
    /**
     * @return {?}
     */
    get buttonSize() {
        return this.rtSize;
    }
    // 因为旧模板带有这个方法
    /**
     * @return {?}
     */
    ngAfterViewInit() { }
    // 因为旧模板带有这个方法
    /**
     * @return {?}
     */
    ngDoCheck() { }
    /**
     * @return {?}
     */
    ngOnInit() {
        // 去掉overflow之后
        this.render.addClass(this.auxiliaryContainerEl.nativeElement, "response-toolbar-hidden-element");
        // 按钮的禁用状态
        this._stateDatas.subscribe((/**
         * @param {?} data
         * @return {?}
         */
        data => {
            this.changeState(data);
        }));
        // 按钮的可见状态
        this._btnVisibleDatas.subscribe((/**
         * @param {?} data
         * @return {?}
         */
        data => {
            this.changeVisible(data);
        }));
        this.observerElement();
        //处理表单加载后的按钮变化
        this.ngZone.runOutsideAngular((/**
         * @return {?}
         */
        () => {
            /** @type {?} */
            let selfObj = this;
            setTimeout((/**
             * @return {?}
             */
            () => {
                selfObj.responseResize();
            }), 0);
        }));
        // 拦截点击事件只传递第一次点击事件的处理操作交给parent来处理
        this.clickSubscription = this.clickItems
            .pipe(debounceTime(this.clickThrottleTime))
            .subscribe((/**
         * @param {?} eventDatas
         * @return {?}
         */
        (eventDatas) => {
            this.rtClickEvent.emit(eventDatas);
        }));
        if (this.popDirection === 'default') {
            this.popDirection = '';
        }
    }
    /**
     * @return {?}
     */
    ngOnDestroy() {
        if (this.ro) {
            this.ro.unobserve(this.resizedContainerEl.nativeElement);
            this.ro = null;
        }
        if (this.clickSubscription) {
            this.clickSubscription.unsubscribe();
        }
    }
    // 这个方法有性能问题，待后期处理 TODO
    /**
     * @return {?}
     */
    ngAfterViewChecked() {
        if (this.needResponseChanges > 0) {
            this.needResponseChanges--;
            this.responseResize();
        }
        else if (this.auxiliaryDatas.length > 0) {
            this._calculate(true, this.auxiliaryContainerEl.nativeElement.offsetWidth);
        }
    }
    // 因为旧模板带有这个方法
    /**
     * @param {?} event
     * @return {?}
     */
    onResize(event) { }
    /**
     * 兼容旧模板旧方法
     * 在不存在ngZone的情况下，创建ngZone,然后绑定事件
     * @private
     * @return {?}
     */
    observerElement() {
        if (!this.ngZone) {
            /** @type {?} */
            const moduleInjector = this.cd["_view"].root.ngModule.injector;
            this.ngZone = moduleInjector.get(NgZone, null);
        }
        this.ngZone.runOutsideAngular((/**
         * @return {?}
         */
        () => {
            this.ro = new ResizeObserver((/**
             * @param {?} entries
             * @param {?} observer
             * @return {?}
             */
            (entries, observer) => {
                /** @type {?} */
                const tempWidth = entries[0].contentRect.width;
                if (Math.abs(tempWidth - this.containerWidthRecord) >
                    this.distanceThreshold) {
                    this.responseResize();
                    this.containerWidthRecord = tempWidth;
                }
            }));
            this.ro.observe(this.resizedContainerEl.nativeElement);
        }));
    }
    /**
     * 强制转换方向
     * @param {?} selfDefinePL
     * @param {?} defaultPL
     * @return {?}
     */
    getPlacement(selfDefinePL, defaultPL) {
        /** @type {?} */
        let oldDirection = selfDefinePL ? selfDefinePL : defaultPL;
        if (!this.popDirection) {
            return oldDirection;
        }
        /** @type {?} */
        var plRelation = { bottom: "top", top: "bottom" };
        oldDirection = oldDirection == "left" ? "left-bottom" : oldDirection;
        oldDirection = oldDirection == "right" ? "right-bottom" : oldDirection;
        /** @type {?} */
        let newDirection = oldDirection.replace(plRelation[this.popDirection], this.popDirection);
        return newDirection;
    }
    /**
     * 调用此方法的场景
     * 1、界面拖拽自动触发
     * 2、显示调用
     * @return {?}
     */
    responseResize() {
        /** @type {?} */
        const _distance = this._getDistance();
        if (_distance > 0) {
            // 如果分组都已经处理完,再出现滚动条不管
            /** @type {?} */
            const _tempIndex = this._getFirstUnResponsedIndex();
            if (_tempIndex < 0) {
                return;
            }
            // 所有第一层下拉都収折
            this.dpState = [false];
            for (let k = _tempIndex; k < this.resizeGroups.length; k++) {
                /** @type {?} */
                const _tempGroup = this.resizeGroups[k];
                this._auxiliary = k;
                if (_tempGroup.isResponsing()) {
                    this._calculate();
                }
                else {
                    // 如果还未开始处理响应式
                    /** @type {?} */
                    const _tempDP = new ResponseToolbarDropDown({
                        text: _tempGroup.name,
                        id: _tempGroup.id,
                        placement: this.popDirection
                            ? this.popDirection + "-left"
                            : "bottom-left",
                        width: _tempGroup.getWidth()
                    });
                    // 已经处理过宽度
                    if (_tempDP.getWidth()) {
                        this.auxiliaryDatas = [_tempDP];
                        this._calculate(true, _tempDP.getWidth());
                    }
                    else {
                        // 更新辅助数据
                        /** @type {?} */
                        let auxiliaryIndex = this.auxiliaryDatas.findIndex((/**
                         * @param {?} item
                         * @return {?}
                         */
                        (item) => {
                            return item.id == _tempDP.id;
                        }));
                        if (auxiliaryIndex == -1) {
                            this.auxiliaryDatas.push(_tempDP);
                        }
                        if (this.cd && !((/** @type {?} */ (this.cd))).destroyed) {
                            this.cd.detectChanges();
                        }
                    }
                }
            }
        }
        else {
            // 寻找最后一个处理响应式的元素
            /** @type {?} */
            const _tempIndex = this._getLastResponseIndex();
            if (_tempIndex < 0) {
                return;
            }
            // 临时存储数据
            /** @type {?} */
            let _tempToolbarDatas = [].concat(this.toolbarDatas);
            // 如果已经开始处理响应式
            for (let k = _tempIndex; k >= 0; k--) {
                /** @type {?} */
                const result = this._restitute(_tempToolbarDatas, k);
                _tempToolbarDatas = [].concat(result["data"]);
                if (!result["continueTo"]) {
                    break;
                }
            }
            // 更新数据
            this.toolbarDatas = [].concat(_tempToolbarDatas);
            // 所有第一层下拉都収折
            this.dpState = [false];
            if (this.cd && !((/** @type {?} */ (this.cd))).destroyed) {
                this.cd.detectChanges();
            }
        }
    }
    // 下拉的展开收起状态
    /**
     * @param {?} state
     * @param {?} id
     * @return {?}
     */
    dpSectionState(state, id) {
        if (state) {
            // 展开状态下
            /** @type {?} */
            let dropdowns = this.resizedContentEl.nativeElement.querySelectorAll("[fDropdown]");
            if (dropdowns && dropdowns.length > 1) {
                for (var k = 0; k < dropdowns.length; k++) {
                    if (dropdowns[k].className.indexOf("show") &&
                        dropdowns[k].id != id) {
                        // dropdowns[k].dispatchEvent(new Event('selfClose'));
                        this.compatibleDispatchEvent(dropdowns[k], "selfClose");
                    }
                }
            }
        }
    }
    /**
     * @private
     * @param {?} eventEl
     * @param {?} eventName
     * @return {?}
     */
    compatibleDispatchEvent(eventEl, eventName) {
        /** @type {?} */
        var event;
        if (typeof Event === "function") {
            event = new Event(eventName);
        }
        else {
            event = document.createEvent("Event");
            event.initEvent(eventName, false, false);
        }
        eventEl.dispatchEvent(event);
    }
    // 修改启用禁用状态
    /**
     * @param {?} values
     * @return {?}
     */
    changeState(values) {
        /** @type {?} */
        const idArray = Object.keys(values);
        idArray.forEach((/**
         * @param {?} id
         * @return {?}
         */
        id => {
            /** @type {?} */
            const state = values[id];
            /** @type {?} */
            const item = this._findItemByID(id, this.toolbarDatas);
            if (item) {
                item["disabled"] = state;
            }
        }));
        if (this.cd && !((/** @type {?} */ (this.cd))).destroyed) {
            this.cd.detectChanges();
        }
    }
    /**
     * 修改显示状态
     * 如果是下拉按钮
     *   判断下面的子是否都隐藏
     * @param {?} values
     * @return {?}
     */
    changeVisible(values) {
        /** @type {?} */
        const idArray = Object.keys(values);
        idArray.forEach((/**
         * @param {?} id
         * @return {?}
         */
        id => {
            /** @type {?} */
            const visible = values[id];
            /** @type {?} */
            const item = this._findItemByID(id, this.toolbarDatas);
            if (item) {
                item["visible"] = visible;
            }
        }));
        // 遍历循环,更新数据
        this.toolbarDatas.forEach((/**
         * @param {?} item
         * @return {?}
         */
        item => {
            // 如果是下拉
            if (item["isDP"]) {
                this._checkDropdownVisible(values, item);
            }
        }));
        this.needResponseChanges++;
        // 更新
        //this.cd.markForCheck();
        if (this.cd && !((/** @type {?} */ (this.cd))).destroyed) {
            this.cd.detectChanges();
        }
    }
    /**
     * 如果是下拉按钮
     *   判断下面的子是否都隐藏
     *       A. 如果子都隐藏，那么整个下拉都被隐藏；
     *       B. 如果存在子没有隐藏，而且下拉没有被预置隐藏，下拉按钮显示
     * @private
     * @param {?} outsideVisibleArrays 从组件外传入的可见状态对象
     * @param {?} dropdownItem 下拉元素
     * @return {?}
     */
    _checkDropdownVisible(outsideVisibleArrays, dropdownItem) {
        //如果没有被强制设置状态
        if (!outsideVisibleArrays.hasOwnProperty(dropdownItem["id"])) {
            // 下拉元素不可见，判断是否有可见子元素
            if (!dropdownItem["visible"] &&
                this._hasVisibleItem(dropdownItem["children"], true)) {
                dropdownItem["visible"] = true;
            }
            // 下拉元素是可见，判断是否有子元素都不可见
            if (dropdownItem["visible"] &&
                !this._hasVisibleItem(dropdownItem["children"], true)) {
                dropdownItem["visible"] = false;
            }
        }
        dropdownItem.children.forEach((/**
         * @param {?} item
         * @return {?}
         */
        item => {
            if (item["isDP"]) {
                this._checkDropdownVisible(outsideVisibleArrays, item);
            }
        }));
    }
    /**
     * 在待检查数据中心，检查是否存在该可见状态的数据。
     * 如果有返回true,否则返回false
     * @private
     * @param {?} datas 待检查数据
     * @param {?} visible 可见状态
     * @return {?}
     */
    _hasVisibleItem(datas, visible) {
        /** @type {?} */
        const findIndex = datas.findIndex((/**
         * @param {?} childItem
         * @return {?}
         */
        childItem => {
            if (childItem["visible"] == visible) {
                return true;
            }
            return false;
        }));
        if (findIndex > -1) {
            return true;
        }
        return false;
    }
    /**
     * 捕获点击
     * @param {?} ev
     * @param {?=} ddRef
     * @return {?}
     */
    clickItem(ev, ddRef) {
        ev.stopPropagation();
        // 如果是分离的下拉按钮
        if (this.elhasSpecialCls(ev.target, "dropdown-toggle-split")) {
            ev.stopImmediatePropagation();
        }
        // 判断是否点击到需要处理事件的元素上,按钮、下拉按钮
        /** @type {?} */
        var clickEvEl = this.findBtnOrTogglerItemFromClick(ev.target);
        if (clickEvEl) {
            /** @type {?} */
            let tempID = clickEvEl["id"];
            // 修改模板，id调整到下拉整体上
            if (!tempID &&
                this.elhasSpecialCls(clickEvEl["parentNode"], "f-rt-dropdown")) {
                tempID = clickEvEl["parentNode"].id;
            }
            if (tempID) {
                /** @type {?} */
                const tempItem = this._findItemByID(tempID, this.toolbarDatas);
                // 如果元素禁用
                if (tempItem["disabled"]) {
                    // 禁止向上传递
                    ev.stopImmediatePropagation();
                }
                else {
                    this.clickItems.next({
                        id: tempID,
                        text: tempItem["text"],
                        hidden: tempItem["hidden"]
                    });
                    if (ddRef) {
                        ddRef.close();
                    }
                }
            }
        }
        else {
            ev.stopImmediatePropagation();
        }
    }
    /**
     * @private
     * @param {?} clickTarget
     * @return {?}
     */
    findBtnOrTogglerItemFromClick(clickTarget) {
        // 父级标签是否是body,是着停止返回集合,反之继续
        if (this.elhasSpecialCls(clickTarget)) {
            return clickTarget;
        }
        else if (clickTarget.parentNode["className"] && clickTarget.parentNode["className"].indexOf("f-response-content") < 0) {
            /** @type {?} */
            var parentN = clickTarget.parentNode;
            if (this.elhasSpecialCls(parentN)) {
                return parentN;
            }
            else {
                return this.findBtnOrTogglerItemFromClick(parentN);
            }
        }
        // 返回集合,结束
        return null;
    }
    /**
     * @private
     * @param {?} el
     * @param {?=} clsName
     * @return {?}
     */
    elhasSpecialCls(el, clsName = "") {
        if (el) {
            /** @type {?} */
            var classNameList = el.classList;
            /** @type {?} */
            var findCls = false;
            for (var k = 0; k < classNameList.length; k++) {
                if (clsName) {
                    if (classNameList[k] == clsName) {
                        findCls = true;
                        break;
                    }
                }
                else {
                    if (classNameList[k] == "f-rt-btn" ||
                        classNameList[k] == "f-rt-toggle") {
                        findCls = true;
                        break;
                    }
                }
            }
            return findCls;
        }
        return false;
    }
    /**
     * 根据传递的数据重新组建分组
     * ToDo 暂时没有更复杂的分组，否则需要记录分组
     * @private
     * @return {?}
     */
    _reOrganizeResizeGroups() {
        // 处理分组数据
        //  if (this.resizeGroups.length === 0) {
        /** @type {?} */
        let moreText = "更多";
        if (this.localeService) {
            moreText = this.localeService.getValue("responseToolbar.more");
        }
        /** @type {?} */
        const defaultResizeGroup = new ResponseToolbarGroup("toolbar-group-1", moreText);
        for (let i = this.toolbarDatas.length - 1; i >= 0; i--) {
            defaultResizeGroup.setPreset(this.toolbarDatas[i]["id"]);
        }
        this.resizeGroups = [].concat(defaultResizeGroup);
        // this.cd.markForCheck();
        if (this.cd && !((/** @type {?} */ (this.cd))).destroyed) {
            this.cd.detectChanges();
        }
    }
    /**
     * 内容与容器的差值
     * @private
     * @return {?}
     */
    _getDistance() {
        return (this.resizedContentEl.nativeElement.offsetWidth -
            this.resizedContainerEl.nativeElement.offsetWidth);
    }
    /**
     * 根据返回结果判断是否继续
     * @private
     * @param {?} originalData
     * @param {?} groupIndex
     * @return {?}
     */
    _restitute(originalData, groupIndex) {
        /** @type {?} */
        const tempGroup = this.resizeGroups[groupIndex];
        // 滚动条和内容的距离
        /** @type {?} */
        let tempDistance = this._getDistance();
        // 计算最后一个下拉的宽度
        /** @type {?} */
        const tempGroupData = originalData[this._findIndexByID(originalData, tempGroup.id)];
        // 找到还原的位置
        /** @type {?} */
        const tempPresetIndex = [].concat(tempGroup.responsedIndex);
        // 排除原下拉子元素被计算
        for (let j = tempPresetIndex.length - 1; j >= 0; j--) {
            if (tempDistance >= 0) {
                break;
            }
            // 从下拉中移除
            /** @type {?} */
            const tempChildData = tempGroupData.children[0];
            /** @type {?} */
            const specialDistance = j === 0 ? tempGroupData.getWidth() : 0;
            tempDistance =
                tempDistance +
                    (tempChildData.getWidth() ? tempChildData.getWidth() : 0) -
                    specialDistance;
            if (tempDistance >= 0) {
                break;
            }
            else {
                // 更新下拉
                tempGroupData.removeChild();
                // 插入到原位置
                originalData.splice(tempPresetIndex[j], 0, tempChildData);
                // 更新位置
                tempGroup.removeResponsed(j);
                if (j === 0) {
                    originalData.splice(this._findIndexByID(originalData, tempGroup.id), 1);
                }
            }
        }
        return {
            continueTo: tempDistance > 0 ? true : false,
            data: originalData
        };
    }
    /**
     * 开始计算
     * @private
     * @param {?=} auxiliary
     * @param {?=} tGroupWidth
     * @return {?}
     */
    _calculate(auxiliary = false, tGroupWidth = 0) {
        if (this._auxiliary < 0) {
            return;
        }
        // 记录需要修改的下拉
        /** @type {?} */
        let tempDP;
        // 滚动条和内容的距离
        /** @type {?} */
        let tempDistance = this._getDistance() + tGroupWidth;
        // 临时存储数据
        /** @type {?} */
        const tempToolbarDatas = [].concat(this.toolbarDatas);
        /** @type {?} */
        const tempGroup = this.resizeGroups[this._auxiliary];
        if (auxiliary) {
            tempDP = this.auxiliaryDatas.pop();
            tempDP.setWidth(tGroupWidth);
            tempGroup.setWidth(tGroupWidth);
        }
        else {
            tempDP =
                tempToolbarDatas[this._findIndexByID(tempToolbarDatas, tempGroup.id)];
        }
        // 当前剩余隐藏
        for (let j = tempGroup.responsedIndex.length; j < tempGroup.presetId.length; j++) {
            if (tempDistance <= 0) {
                break;
            }
            // 计算在当前数据中的位置，根据这个位置可以找宽度
            /** @type {?} */
            const tempOldIndex = (/** @type {?} */ (this._findIndexByID(this.toolbarDatas, tempGroup.presetId[j])));
            /** @type {?} */
            const tempNewIndex = (/** @type {?} */ (this._findIndexByID(tempToolbarDatas, tempGroup.presetId[j])));
            // 计算按钮宽度
            /** @type {?} */
            let tempWidth = (/** @type {?} */ (this.toolbarDatas[tempOldIndex].getWidth()));
            if (tempWidth === 0) {
                // 按钮宽度未曾被计算过
                tempWidth = this._getWidthFromElementsById(tempGroup.presetId[j]);
                tempToolbarDatas[tempNewIndex].setWidth(tempWidth);
            }
            else if (tempWidth === false) {
                // 按钮被隐藏
                tempWidth = 0;
            }
            tempDP.addChild(tempToolbarDatas[tempNewIndex]);
            // 移除
            tempToolbarDatas.splice(tempNewIndex, 1);
            // 保存位置用于还原
            tempGroup.setResponsed(tempNewIndex);
            tempDistance = tempDistance - tempWidth;
        }
        if (auxiliary && tempDP.hasChild()) {
            // 插入
            tempToolbarDatas.push(tempDP);
        }
        this._auxiliary = -1;
        this.toolbarDatas = [].concat(tempToolbarDatas);
        if (this.cd && !((/** @type {?} */ (this.cd))).destroyed) {
            this.cd.detectChanges();
        }
    }
    /**
     * 根据id找到实际显示元素的宽度
     * @private
     * @param {?} findId
     * @return {?}
     */
    _getWidthFromElementsById(findId) {
        /** @type {?} */
        const parentEl = this.resizedContentEl.nativeElement;
        /** @type {?} */
        const childLen = parentEl.children.length;
        /** @type {?} */
        let result = 0;
        for (var k = 0; k < childLen; k++) {
            if (parentEl.children[k].id === findId) {
                /** @type {?} */
                let findEl = parentEl.children[k];
                /** @type {?} */
                let getComputedStyleEl = window.getComputedStyle(findEl, null);
                result = findEl.offsetWidth + parseFloat(getComputedStyleEl.marginLeft) + parseFloat(getComputedStyleEl.marginRight);
                break;
            }
        }
        return result;
    }
    /**
     * 格式化数据
     * @private
     * @param {?} datas
     * @param {?=} idPrefix
     * @return {?}
     */
    _formatData(datas, idPrefix = "response") {
        /** @type {?} */
        const result = [];
        datas.forEach((/**
         * @param {?} item
         * @param {?} index
         * @return {?}
         */
        (item, index) => {
            if (item.isDP) {
                // 如果是下拉
                if (item.hasOwnProperty("children") &&
                    item["children"].length) {
                    /** @type {?} */
                    const children = [].concat(item["children"]);
                    // item.children = []; // 应gzq要求20230529
                    /** @type {?} */
                    const dpItem = new ResponseToolbarDropDown(Object.assign({ id: idPrefix + "_" + index }, item));
                    result.push(dpItem);
                    dpItem.children = this._formatData(children, idPrefix + "_" + index);
                }
                else {
                    result.push(new ResponseToolbarDropDown(Object.assign({ id: idPrefix + "_" + index }, item)));
                }
            }
            else {
                // 非下拉
                result.push(new ResponseToolbarItem(Object.assign({ id: idPrefix + "_" + index }, item)));
            }
        }));
        return result;
    }
    /**
     * 找到第一个未处理完响应式的元素
     * @private
     * @return {?}
     */
    _getFirstUnResponsedIndex() {
        /** @type {?} */
        const tempUnResponsedIndex = this.resizeGroups.findIndex((/**
         * @param {?} group
         * @return {?}
         */
        group => {
            if (group.isResponsed()) {
                return false;
            }
            return true;
        }));
        return tempUnResponsedIndex;
    }
    /**
     * 寻找最后一个处理响应式的元素
     * @private
     * @return {?}
     */
    _getLastResponseIndex() {
        /** @type {?} */
        const tempResponsingIndex = this.resizeGroups.findIndex((/**
         * @param {?} group
         * @return {?}
         */
        group => {
            if (!group.isResponsing()) {
                return true;
            }
            return false;
        }));
        // 所有组元素都已处理完响应式
        if (tempResponsingIndex === -1) {
            return this.resizeGroups.length - 1;
        }
        // 所有组元素都未开始处理响应式
        return tempResponsingIndex > 1 ? tempResponsingIndex - 1 : -1;
    }
    /**
     * 找到group形成的下拉，在数据中的位置
     * @private
     * @param {?} datas
     * @param {?} id
     * @return {?}
     */
    _findIndexByID(datas, id) {
        /** @type {?} */
        const result = datas.findIndex((/**
         * @param {?} item
         * @param {?} index
         * @return {?}
         */
        (item, index) => {
            if (item["id"] === id) {
                return true;
            }
            return false;
        }));
        return result;
    }
    /**
     * 根据ID寻找Item
     * @private
     * @param {?} id
     * @param {?} data
     * @return {?}
     */
    _findItemByID(id, data) {
        /** @type {?} */
        let tempResult = null;
        /** @type {?} */
        const tempIndex = data.findIndex((/**
         * @param {?} item
         * @param {?} index
         * @return {?}
         */
        (item, index) => {
            if (item["id"] === id) {
                tempResult = item;
                return true;
            }
            // 如果是下拉，层级下拉
            if (item["isDP"]) {
                /** @type {?} */
                const tempItem = this._findItemByID(id, item["children"]);
                if (tempItem) {
                    tempResult = tempItem;
                    return true;
                }
            }
            return false;
        }));
        return tempResult;
    }
}
ResponseToolbarComponent.decorators = [
    { type: Component, args: [{
                selector: "f-response-toolbar",
                template: "<!-- <div class=\"border bg-primary\" style=\"height:40px;position: relative;\"> -->\r\n<div #auxiliaryContainer class=\"response-toolbar-hidden-element\">\r\n    <ng-container *ngFor=\"let dataItem of auxiliaryDatas\">\r\n        <div class=\"btn-group\" *ngIf=\"dataItem.visible&&dataItem.isDP\" id=\"{{ dataItem.id }}\">\r\n            <button type=\"button\" class=\"btn dropdown-toggle dropdown-toggle-split  f-rt-toggle\"\r\n                [class.f-btn-ml]=\"btnAlign=='right'\" [class.f-btn-mr]=\"btnAlign=='left'\" [ngClass]=\"dataItem.class\" [class.btn-icontext]=\"dataItem.icon&&dataItem.icon.trim()\">\r\n             <i class=\"f-icon\" [ngClass]=\"dataItem.icon&&dataItem.icon.trim()\" *ngIf=\"dataItem.icon&&dataItem.icon.trim()\"></i>{{ dataItem.text }}\r\n            </button>\r\n        </div>\r\n        <button type=\"button\" class=\"btn f-rt-btn\" [class.f-btn-ml]=\"btnAlign=='right'\"\r\n            [class.f-btn-mr]=\"btnAlign=='left'\" [ngClass]=\"dataItem.class\" id=\"{{ dataItem.id }}\"\r\n            *ngIf=\"dataItem.visible&&!dataItem.isDP\" [class.btn-icontext]=\"dataItem.icon&&dataItem.icon.trim()\">\r\n            <i class=\"f-icon\" [ngClass]=\"dataItem.icon&&dataItem.icon.trim()\" *ngIf=\"dataItem.icon&&dataItem.icon.trim()\"></i>{{ dataItem.text }}\r\n        </button>\r\n    </ng-container>\r\n</div>\r\n<div fResized #resizedContainer (resizedEvent)=\"onResize($event)\" class=\"d-flex flex-nowrap\"\r\n    [ngClass]=\"{'justify-content-end':btnAlign=='right','justify-content-start':btnAlign=='left'}\">\r\n    <div class=\"d-inline-block f-response-content\" style=\"white-space: nowrap;\" #resizedContent\r\n        (click)=\"clickItem($event, null)\">\r\n        <ng-container *ngFor=\"let dataItem of toolbarDatas\">\r\n            <ng-container *ngIf=\"dataItem.visible && dataItem.isDP\">\r\n                <ng-container *ngTemplateOutlet=\"\r\n                        dropdownTmpl;\r\n                        context: { $implicit: dataItem }\r\n                    \"></ng-container>\r\n            </ng-container>\r\n            <ng-container *ngIf=\"dataItem.visible && !dataItem.isDP&&dataItem.tipsEnable\">\r\n                <button type=\"button\" class=\"btn f-rt-btn\"\r\n                    [class.f-btn-ml]=\"btnAlign=='right'\" [class.f-btn-mr]=\"btnAlign=='left'\" id=\"{{ dataItem.id }}\"\r\n                    [ngClass]=\"dataItem.class\" [class.disabled]=\"dataItem.disabled\" [class.btn-icontext]=\"dataItem.icon&&dataItem.icon.trim()\"\r\n                    [farrisTooltip]=\"dataItem.tipsEnable\" [content]=\"dataItem.tipsText\">\r\n                    <i class=\"f-icon\" [ngClass]=\"dataItem.icon&&dataItem.icon.trim()\" *ngIf=\"dataItem.icon&&dataItem.icon.trim()\"></i>{{ dataItem.text }}\r\n                </button>\r\n            </ng-container>\r\n            <ng-container *ngIf=\"dataItem.visible && !dataItem.isDP&&!dataItem.tipsEnable\">\r\n                <button type=\"button\" class=\"btn f-rt-btn\"\r\n                    [class.f-btn-ml]=\"btnAlign=='right'\" [class.f-btn-mr]=\"btnAlign=='left'\" id=\"{{ dataItem.id }}\"\r\n                    [ngClass]=\"dataItem.class\" [class.disabled]=\"dataItem.disabled\"  [class.btn-icontext]=\"dataItem.icon&&dataItem.icon.trim()\">\r\n                    <i class=\"f-icon\" [ngClass]=\"dataItem.icon&&dataItem.icon.trim()\" *ngIf=\"dataItem.icon&&dataItem.icon.trim()\"></i>{{ dataItem.text }}\r\n                </button>\r\n            </ng-container>\r\n        </ng-container>\r\n    </div>\r\n</div>\r\n<!-- </div> -->\r\n\r\n<!--\u7B2C\u4E00\u5C42\u4E0B\u62C9-->\r\n<ng-template #dropdownTmpl let-data>\r\n    <div class=\"btn-group f-rt-dropdown\" id=\"{{ data.id }}\" fDropdown  #dd=\"fDropdown\"\r\n        [placement]=\"getPlacement(data['placement'],'bottom')\" (dpChangeEvent)=\"dpSectionState($event,data.id)\"\r\n        [rectifyReference]=\"referEl\" [forceState]=\"dpState\" [autoRectify]=\"true\" [class.f-btn-ml]=\"btnAlign=='right'\"\r\n        [class.f-btn-mr]=\"btnAlign=='left'\" [ngClass]=\"data['dropdownCls']\">\r\n        <!--\u542F\u7528\u4E0B\u62C9\u5206\u5F00\u6309\u94AE-->\r\n        <ng-container *ngIf=\"data.split\">\r\n            <ng-container *ngIf=\"data.tipsEnable\">\r\n                <button type=\"button\" class=\"btn f-rt-btn\" [ngClass]=\"data.class\" [class.disabled]=\"data.disabled\"\r\n                    [farrisTooltip]=\"data.tipsEnable\" [content]=\"data.tipsText\" [class.btn-icontext]=\"data.icon&&data.icon.trim()\">\r\n                    <i class=\"f-icon\" [ngClass]=\"data.icon&&data.icon.trim()\" *ngIf=\"data.icon&&data.icon.trim()\"></i>{{ data.text }}\r\n                </button>\r\n            </ng-container>\r\n            <ng-container *ngIf=\"!data.tipsEnable\">\r\n                <button type=\"button\" class=\"btn f-rt-btn\" [ngClass]=\"data.class\" [class.disabled]=\"data.disabled\" [class.btn-icontext]=\"data.icon&&data.icon.trim()\">\r\n                    <i class=\"f-icon\" [ngClass]=\"data.icon&&data.icon.trim()\" *ngIf=\"data.icon&&data.icon.trim()\"></i>{{ data.text }}\r\n                </button>\r\n            </ng-container>\r\n            <button class=\"btn dropdown-toggle dropdown-toggle-split\" [ngClass]=\"data.class\" fDropdownToggle></button>\r\n        </ng-container>\r\n        <!--\u4E0D\u542F\u7528\u4E0B\u62C9\u5206\u5F00\u6309\u94AE-->\r\n        <ng-container *ngIf=\"!data.split&&data.tipsEnable\">\r\n            <button type=\"button\" fDropdownToggle class=\"btn f-rt-toggle\" [farrisTooltip]=\"data.tipsEnable\"\r\n                [content]=\"data.tipsText\" [ngClass]=\"data.class + ' dropdown-toggle'\" [dpDisabled]=\"data.disabled\" [class.btn-icontext]=\"data.icon&&data.icon.trim()\">\r\n                <i class=\"f-icon\" [ngClass]=\"data.icon&&data.icon.trim()\" *ngIf=\"data.icon&&data.icon.trim()\"></i>{{ data.text }}\r\n            </button>\r\n        </ng-container>\r\n        <ng-container *ngIf=\"!data.split&&!data.tipsEnable\">\r\n            <button type=\"button\" fDropdownToggle class=\"btn f-rt-toggle\" [ngClass]=\"data.class + ' dropdown-toggle'\"\r\n                [dpDisabled]=\"data.disabled\"  [class.btn-icontext]=\"data.icon&&data.icon.trim()\">\r\n                <i class=\"f-icon\" [ngClass]=\"data.icon&&data.icon.trim()\" *ngIf=\"data.icon&&data.icon.trim()\"></i>{{ data.text }}\r\n            </button>\r\n        </ng-container>\r\n        <ul class=\"dropdown-menu\" fDropdownMenu [ngClass]=\"data.menuCls\" id=\"{{ data.id }}_menu\">\r\n            <ng-container *ngFor=\"let item of data.children\">\r\n                <ng-container *ngIf=\"item.visible && item.isDP\">\r\n                    <ng-container *ngTemplateOutlet=\"\r\n                            dropdownSubTmpl;\r\n                            context: { $implicit: item, ddRef: dd }\r\n                        \"></ng-container>\r\n                </ng-container>\r\n                <ng-container *ngIf=\"item.visible&&!item.isDP&&item.tipsEnable\">\r\n                    <li class=\"dropdown-item  f-rt-btn\" id=\"{{ item.id }}\" [class.disabled]=\"item.disabled\"\r\n                        [farrisTooltip]=\"item.tipsEnable\" [content]=\"item.tipsText\"  (click)=\"clickItem($event, dd)\">\r\n                        {{ item.text }}\r\n                    </li>\r\n                </ng-container>\r\n                <ng-container *ngIf=\"item.visible&&!item.isDP&&!item.tipsEnable\">\r\n                    <li class=\"dropdown-item  f-rt-btn\" id=\"{{ item.id }}\" [class.disabled]=\"item.disabled\"  (click)=\"clickItem($event, dd)\">\r\n                        {{ item.text }}\r\n                    </li>\r\n                </ng-container>\r\n            </ng-container>\r\n        </ul>\r\n    </div>\r\n</ng-template>\r\n<!--\u7B2C\u4E8C\u5C42\u4E0B\u62C9-->\r\n<ng-template #dropdownSubTmpl let-subData let-dd=\"ddRef\">\r\n    <li class=\"dropdown-submenu f-rt-dropdown\" fDropdown [isSubDP]=\"true\" (click)=\"clickItem($event, dd)\"\r\n        [placement]=\"getPlacement(subData['placement'],'right')\" [autoRectify]=\"true\" [rectifyReference]=\"referEl\"\r\n        [ngClass]=\"subData['dropdownCls']\" id=\"{{ subData.id }}\">\r\n        <ng-container *ngIf=\"subData.split\">\r\n            <ng-container *ngIf=\"subData.tipsEnable\">\r\n                <span class=\"dropdown-item f-rt-btn\" [class.disabled]=\"subData['disabled']\" [ngClass]=\"subData['class']\"\r\n                    [farrisTooltip]=\"subData.tipsEnable\" [content]=\"subData.tipsText\">{{ subData.text }}</span>\r\n                <span class=\"dropdown-toggle dropdown-toggle-split f-rt-toggle\" fDropdownToggle></span>\r\n            </ng-container>\r\n            <ng-container *ngIf=\"!subData.tipsEnable\">\r\n                <span class=\"dropdown-item f-rt-btn\" [class.disabled]=\"subData['disabled']\"\r\n                    [ngClass]=\"subData['class']\">{{ subData.text }}</span>\r\n                <span class=\"dropdown-toggle dropdown-toggle-split f-rt-toggle\" fDropdownToggle></span>\r\n            </ng-container>\r\n        </ng-container>\r\n        <ng-container *ngIf=\"!subData.split\">\r\n            <ng-container *ngIf=\"subData.tipsEnable\">\r\n                <span class=\"dropdown-item  dropdown-toggle f-rt-toggle\" [dpDisabled]=\"subData['disabled']\"\r\n                    [farrisTooltip]=\"subData.tipsEnable\" [content]=\"subData.tipsText\" [ngClass]=\"subData['class']\"\r\n                    fDropdownToggle>{{ subData.text }}</span>\r\n            </ng-container>\r\n            <ng-container *ngIf=\"!subData.tipsEnable\">\r\n                <span class=\"dropdown-item  dropdown-toggle f-rt-toggle\" [dpDisabled]=\"subData['disabled']\"\r\n                    [ngClass]=\"subData['class']\" fDropdownToggle>{{ subData.text }}</span>\r\n            </ng-container>\r\n\r\n        </ng-container>\r\n\r\n        <ul class=\"dropdown-menu\" fDropdownMenu [ngClass]=\"subData.menuCls\" id=\"{{ subData.id }}_submenu\">\r\n            <ng-container *ngFor=\"let subItem of subData.children\">\r\n                <ng-container *ngIf=\"subItem.visible && subItem.isDP\">\r\n                    <ng-container *ngTemplateOutlet=\"\r\n                            dropdownSubTmpl;\r\n                            context: { $implicit: subItem, ddRef: dd }\r\n                        \"></ng-container>\r\n                </ng-container>\r\n                <ng-container *ngIf=\"subItem.visible && !subItem.isDP\">\r\n                    <ng-container *ngIf=\"subItem.tipsEnable\">\r\n                        <li [farrisTooltip]=\"subItem.tipsEnable\" [content]=\"subItem.tipsText\"  (click)=\"clickItem($event, dd)\"\r\n                            class=\"dropdown-item f-rt-btn\" id=\"{{ subItem.id }}\" [class.disabled]=\"subItem.disabled\">\r\n                            {{ subItem.text }}\r\n                        </li>\r\n                    </ng-container>\r\n                    <ng-container *ngIf=\"!subItem.tipsEnable\">\r\n                        <li class=\"dropdown-item f-rt-btn\" id=\"{{ subItem.id }}\" [class.disabled]=\"subItem.disabled\"  (click)=\"clickItem($event, dd)\">\r\n                            {{ subItem.text }}\r\n                        </li>\r\n                    </ng-container>\r\n                </ng-container>\r\n            </ng-container>\r\n        </ul>\r\n    </li>\r\n</ng-template>",
                styles: [":host .response-toolbar-hidden-element{position:fixed;z-index:200;visibility:hidden;top:-87px}"]
            }] }
];
/** @nocollapse */
ResponseToolbarComponent.ctorParameters = () => [
    { type: ElementRef },
    { type: Renderer2 },
    { type: ChangeDetectorRef },
    { type: LocaleService }
];
ResponseToolbarComponent.propDecorators = {
    frtCls: [{ type: HostBinding, args: ["class.f-response-toolbar",] }],
    prCls: [{ type: HostBinding, args: ["class.position-relative",] }],
    resizedContainerEl: [{ type: ViewChild, args: ["resizedContainer",] }],
    auxiliaryContainerEl: [{ type: ViewChild, args: ["auxiliaryContainer",] }],
    resizedContentEl: [{ type: ViewChild, args: ["resizedContent",] }],
    resizedContainerDirective: [{ type: ViewChild, args: ["resizedContainer", { read: FResizedDirective },] }],
    rtClickEvent: [{ type: Output }],
    groups: [{ type: Input }],
    datas: [{ type: Input }],
    btnState: [{ type: Input }],
    btnVisible: [{ type: Input }],
    clickThrottleTime: [{ type: Input }],
    buttonSize: [{ type: Input }],
    popDirection: [{ type: Input }],
    btnAlign: [{ type: Input }]
};
if (false) {
    /** @type {?} */
    ResponseToolbarComponent.prototype.frtCls;
    /** @type {?} */
    ResponseToolbarComponent.prototype.prCls;
    /** @type {?} */
    ResponseToolbarComponent.prototype.resizedContainerEl;
    /** @type {?} */
    ResponseToolbarComponent.prototype.auxiliaryContainerEl;
    /** @type {?} */
    ResponseToolbarComponent.prototype.resizedContentEl;
    /** @type {?} */
    ResponseToolbarComponent.prototype.resizedContainerDirective;
    /** @type {?} */
    ResponseToolbarComponent.prototype.rtClickEvent;
    /** @type {?} */
    ResponseToolbarComponent.prototype.auxiliaryDatas;
    /**
     * @type {?}
     * @private
     */
    ResponseToolbarComponent.prototype.ro;
    /**
     * @type {?}
     * @private
     */
    ResponseToolbarComponent.prototype.containerWidthRecord;
    /**
     * @type {?}
     * @private
     */
    ResponseToolbarComponent.prototype.needResponseChanges;
    /** @type {?} */
    ResponseToolbarComponent.prototype.referEl;
    /** @type {?} */
    ResponseToolbarComponent.prototype.dpState;
    /**
     * @type {?}
     * @private
     */
    ResponseToolbarComponent.prototype._auxiliary;
    /**
     * @type {?}
     * @private
     */
    ResponseToolbarComponent.prototype._selfEl;
    /** @type {?} */
    ResponseToolbarComponent.prototype.resizeGroups;
    /** @type {?} */
    ResponseToolbarComponent.prototype.toolbarDatas;
    /**
     * @type {?}
     * @private
     */
    ResponseToolbarComponent.prototype.distanceThreshold;
    /**
     * @type {?}
     * @private
     */
    ResponseToolbarComponent.prototype.isUpdateTBView;
    /** @type {?} */
    ResponseToolbarComponent.prototype._stateDatas;
    /** @type {?} */
    ResponseToolbarComponent.prototype._btnVisibleDatas;
    /** @type {?} */
    ResponseToolbarComponent.prototype.clickThrottleTime;
    /**
     * @type {?}
     * @private
     */
    ResponseToolbarComponent.prototype.clickItems;
    /**
     * @type {?}
     * @private
     */
    ResponseToolbarComponent.prototype.clickSubscription;
    /**
     * @type {?}
     * @private
     */
    ResponseToolbarComponent.prototype.rtSize;
    /** @type {?} */
    ResponseToolbarComponent.prototype.popDirection;
    /** @type {?} */
    ResponseToolbarComponent.prototype.btnAlign;
    /**
     * @type {?}
     * @private
     */
    ResponseToolbarComponent.prototype.ngZone;
    /**
     * @type {?}
     * @private
     */
    ResponseToolbarComponent.prototype.render;
    /**
     * @type {?}
     * @private
     */
    ResponseToolbarComponent.prototype.cd;
    /** @type {?} */
    ResponseToolbarComponent.prototype.localeService;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicmVzcG9uc2UtdG9vbGJhci5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZmFycmlzL3VpLXJlc3BvbnNlLXRvb2xiYXIvIiwic291cmNlcyI6WyJsaWIvY29tcG9uZW50L3Jlc3BvbnNlLXRvb2xiYXIuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7QUFBQSxPQUFPLEVBQ0gsU0FBUyxFQUVULEtBQUssRUFDTCxTQUFTLEVBQ1QsVUFBVSxFQUNWLFNBQVMsRUFLVCxpQkFBaUIsRUFDakIsV0FBVyxFQUNYLE1BQU0sRUFDTixZQUFZLEVBQ1osTUFBTSxFQUdULE1BQU0sZUFBZSxDQUFDO0FBQ3ZCLE9BQU8sRUFDSCx1QkFBdUIsRUFDdkIsbUJBQW1CLEVBQ25CLG9CQUFvQixFQUV2QixNQUFNLGlDQUFpQyxDQUFDO0FBQ3pDLE9BQU8sRUFBRSxpQkFBaUIsRUFBRSxNQUFNLGdDQUFnQyxDQUFDO0FBQ25FLE9BQU8sRUFBRSxPQUFPLEVBQUUsVUFBVSxFQUFpQyxNQUFNLE1BQU0sQ0FBQztBQUMxRSxPQUFPLEVBQWdCLFlBQVksRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBQzVELE9BQU8sRUFBRSxhQUFhLEVBQUUsTUFBTSxtQkFBbUIsQ0FBQztBQUNsRCxPQUFPLGNBQWMsTUFBTSwwQkFBMEIsQ0FBQztBQVF0RCxNQUFNLE9BQU8sd0JBQXdCOzs7Ozs7O0lBeUdqQyxZQUNJLEVBQWMsRUFDTixNQUFpQixFQUNqQixFQUFxQixFQUN0QixhQUE0QjtRQUYzQixXQUFNLEdBQU4sTUFBTSxDQUFXO1FBQ2pCLE9BQUUsR0FBRixFQUFFLENBQW1CO1FBQ3RCLGtCQUFhLEdBQWIsYUFBYSxDQUFlO1FBM0dFLFdBQU0sR0FBRyxJQUFJLENBQUM7UUFDZixVQUFLLEdBQUcsSUFBSSxDQUFDOztRQVlyRCxpQkFBWSxHQUE0QyxJQUFJLFlBQVksRUFFckUsQ0FBQzs7UUFFSixtQkFBYyxHQUFtQyxFQUFFLENBQUM7Ozs7UUFJNUMsT0FB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a0JBQWtCO21DQUU1QixTQUFTLFNBQUMsb0JBQW9COytCQUU5QixTQUFTLFNBQUMsZ0JBQWdCO3dDQUUxQixTQUFTLFNBQUMsa0JBQWtCLEVBQUUsRUFBRSxJQUFJLEVBQUUsaUJBQWlCLEVBQUU7MkJBR3pELE1BQU07cUJBd0JOLEtBQUs7b0JBZUwsS0FBSzt1QkFXTCxLQUFLO3lCQU1MLEtBQUs7Z0NBSUwsS0FBSzt5QkFLTCxLQUFLOzJCQXNCTCxLQUFLO3VCQUVMLEtBQUs7Ozs7SUFyR04sMENBQXVEOztJQUN2RCx5Q0FBcUQ7O0lBRXJELHNEQUFrRDs7SUFFbEQsd0RBQXNEOztJQUV0RCxvREFBOEM7O0lBRTlDLDZEQUM2Qzs7SUFFN0MsZ0RBR0k7O0lBRUosa0RBQW9EOzs7OztJQUlwRCxzQ0FBeUM7Ozs7O0lBRXpDLHdEQUFpQzs7Ozs7SUFFakMsdURBQWdDOztJQUNoQywyQ0FBZTs7SUFDZiwyQ0FBa0I7Ozs7O0lBRWxCLDhDQUF3Qjs7Ozs7SUFDeEIsMkNBQTZCOztJQUM3QixnREFBK0M7O0lBRS9DLGdEQUF3RTs7Ozs7SUFleEUscURBQStCOzs7OztJQUMvQixrREFBK0I7O0lBVy9CLCtDQUFvRDs7SUFNcEQsb0RBQXlEOztJQU16RCxxREFBaUM7Ozs7O0lBQ2pDLDhDQUF3Qzs7Ozs7SUFDeEMscURBQXdDOzs7OztJQUN4QywwQ0FBb0I7O0lBd0JwQixnREFBMkI7O0lBRTNCLDRDQUE0Qjs7Ozs7SUFDNUIsMENBQXNCOzs7OztJQUdsQiwwQ0FBeUI7Ozs7O0lBQ3pCLHNDQUE2Qjs7SUFDN0IsaURBQW1DIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcclxuICAgIENvbXBvbmVudCxcclxuICAgIE9uSW5pdCxcclxuICAgIElucHV0LFxyXG4gICAgVmlld0NoaWxkLFxyXG4gICAgRWxlbWVudFJlZixcclxuICAgIFJlbmRlcmVyMixcclxuICAgIEFmdGVyVmlld0luaXQsXHJcbiAgICBEb0NoZWNrLFxyXG4gICAgQWZ0ZXJWaWV3Q2hlY2tlZCxcclxuICAgIENoYW5nZURldGVjdGlvblN0cmF0ZWd5LFxyXG4gICAgQ2hhbmdlRGV0ZWN0b3JSZWYsXHJcbiAgICBIb3N0QmluZGluZyxcclxuICAgIE91dHB1dCxcclxuICAgIEV2ZW50RW1pdHRlcixcclxuICAgIE5nWm9uZSxcclxuICAgIE9uRGVzdHJveSxcclxuICAgIFZpZXdSZWZcclxufSBmcm9tIFwiQGFuZ3VsYXIvY29yZVwiO1xyXG5pbXBvcnQge1xyXG4gICAgUmVzcG9uc2VUb29sYmFyRHJvcERvd24sXHJcbiAgICBSZXNwb25zZVRvb2xiYXJJdGVtLFxyXG4gICAgUmVzcG9uc2VUb29sYmFyR3JvdXAsXHJcbiAgICBSZXNwb25zZVRvb2xiYXJDbGlja0V2ZW50XHJcbn0gZnJvbSBcIi4uL21vZGVsL3Jlc3BvbnNlLXRvb2xiYXIubW9kZWxcIjtcclxuaW1wb3J0IHsgRlJlc2l6ZWREaXJlY3RpdmUgfSBmcm9tIFwiLi4vcmVzaXplZC9mLXJlc2l6ZWQuZGlyZWN0aXZlXCI7XHJcbmltcG9ydCB7IFN1YmplY3QsIE9ic2VydmFibGUsIFN1YnNjcmlwdGlvbiwgQmVoYXZpb3JTdWJqZWN0IH0gZnJvbSBcInJ4anNcIjtcclxuaW1wb3J0IHsgdGhyb3R0bGVUaW1lLCBkZWJvdW5jZVRpbWUgfSBmcm9tIFwicnhqcy9vcGVyYXRvcnNcIjtcclxuaW1wb3J0IHsgTG9jYWxlU2VydmljZSB9IGZyb20gXCJAZmFycmlzL3VpLWxvY2FsZVwiO1xyXG5pbXBvcnQgUmVzaXplT2JzZXJ2ZXIgZnJvbSBcInJlc2l6ZS1vYnNlcnZlci1wb2x5ZmlsbFwiO1xyXG5pbXBvcnQgeyBGRHJvcGRvd25EaXJlY3RpdmUgfSBmcm9tIFwiQGZhcnJpcy91aS1kcm9wZG93blwiO1xyXG5AQ29tcG9uZW50KHtcclxuICAgIHNlbGVjdG9yOiBcImYtcmVzcG9uc2UtdG9vbGJhclwiLFxyXG4gICAgdGVtcGxhdGVVcmw6IFwiLi9yZXNwb25zZS10b29sYmFyLmNvbXBvbmVudC5odG1sXCIsXHJcbiAgICBzdHlsZVVybHM6IFtcIi4vcmVzcG9uc2UtdG9vbGJhci5jb21wb25lbnQuY3NzXCJdLFxyXG4gICAvLyBjaGFuZ2VEZXRlY3Rpb246IENoYW5nZURldGVjdGlvblN0cmF0ZWd5Lk9uUHVzaFxyXG59KVxyXG5leHBvcnQgY2xhc3MgUmVzcG9uc2VUb29sYmFyQ29tcG9uZW50XHJcbiAgICBpbXBsZW1lbnRzIE9uSW5pdCwgQWZ0ZXJWaWV3SW5pdCwgRG9DaGVjaywgQWZ0ZXJWaWV3Q2hlY2tlZCwgT25EZXN0cm95IHtcclxuICAgIEBIb3N0QmluZGluZyhcImNsYXNzLmYtcmVzcG9uc2UtdG9vbGJhclwiKSBmcnRDbHMgPSB0cnVlO1xyXG4gICAgQEhvc3RCaW5kaW5nKFwiY2xhc3MucG9zaXRpb24tcmVsYXRpdmVcIikgcHJDbHMgPSB0cnVlO1xyXG4gICAgLy8g5ZON5bqU5byP5a655ZmoXHJcbiAgICBAVmlld0NoaWxkKFwicmVzaXplZENvbnRhaW5lclwiKSByZXNpemVkQ29udGFpbmVyRWw7XHJcbiAgICAvLyDovoXliqnorqHnrpflrrnlmahcclxuICAgIEBWaWV3Q2hpbGQoXCJhdXhpbGlhcnlDb250YWluZXJcIikgYXV4aWxpYXJ5Q29udGFpbmVyRWw7XHJcbiAgICAvLyDlk43lupTlvI/lhoXlrrnlrrnlmahcclxuICAgIEBWaWV3Q2hpbGQoXCJyZXNpemVkQ29udGVudFwiKSByZXNpemVkQ29udGVudEVsO1xyXG4gICAgLy9cclxuICAgIEBWaWV3Q2hpbGQoXCJyZXNpemVkQ29udGFpbmVyXCIsIHsgcmVhZDogRlJlc2l6ZWREaXJlY3RpdmUgfSlcclxuICAgIHJlc2l6ZWRDb250YWluZXJEaXJlY3RpdmU6IEZSZXNpemVkRGlyZWN0aXZlO1xyXG4gICAgLy8g5Lyg6YCS54K55Ye75LqL5Lu2XHJcbiAgICBAT3V0cHV0KClcclxuICAgIHJ0Q2xpY2tFdmVudDogRXZlbnRFbWl0dGVyPFJlc3BvbnNlVG9vbGJhckNsaWNrRXZlbnQ+ID0gbmV3IEV2ZW50RW1pdHRlcjxcclxuICAgICAgICBSZXNwb25zZVRvb2xiYXJDbGlja0V2ZW50XHJcbiAgICA+KCk7XHJcbiAgICAvLyDovoXliqnorqHnrpflrr3luqbmlbDmja5cclxuICAgIGF1eGlsaWFyeURhdGFzOiBBcnJheTxSZXNwb25zZVRvb2xiYXJEcm9wRG93bj4gPSBbXTtcclxuICAgIC8vIOaOp+WItueItuWFg+e0oOa7muWKqOeahOagt+W8j1xyXG4gICAgLy8gIHByaXZhdGUgX2RwU3RhdGUgPSBmYWxzZTtcclxuICAgIC8vXHJcbiAgICBwcml2YXRlIHJvOiBSZXNpemVPYnNlcnZlciB8IG51bGwgPSBudWxsO1xyXG4gICAgLy8g6K6w5b2V5a655Zmo5a695bqmXHJcbiAgICBwcml2YXRlIGNvbnRhaW5lcldpZHRoUmVjb3JkID0gMDtcclxuICAgIC8vIOiusOW9leWPmOWMllxyXG4gICAgcHJpdmF0ZSBuZWVkUmVzcG9uc2VDaGFuZ2VzID0gMDtcclxuICAgIHJlZmVyRWwgPSBudWxsO1xyXG4gICAgZHBTdGF0ZSA9IFtmYWxzZV07XHJcbiAgICAvLyDnlKjmnaXlhoXpg6jorrDlvZVcclxuICAgIHByaXZhdGUgX2F1eGlsaWFyeSA9IC0xO1xyXG4gICAgcHJpdmF0ZSBfc2VsZkVsOiBIVE1MRWxlbWVudDtcclxuICAgIHJlc2l6ZUdyb3VwczogQXJyYXk8UmVzcG9uc2VUb29sYmFyR3JvdXA+ID0gW107XHJcbiAgICAvLyDorrDlvZXmoLzlvI/ljJblkI7nmoTmlbDmja5cclxuICAgIHRvb2xiYXJEYXRhczogQXJyYXk8UmVzcG9uc2VUb29sYmFySXRlbSB8IFJlc3BvbnNlVG9vbGJhckRyb3BEb3duPiA9IFtdO1xyXG4gICAgLy8g5YaF6YOo6K6w5b2V5qC85byP5YyW5ZCO55qE5Yid5aeL5pWw5o2uLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLeaaguaXtuS4jeeUqFxyXG4gICAgLy8gX3Rvb2xiYXJEYXRhczogQXJyYXk8UmVzcG9uc2VUb29sYmFySXRlbSB8IFJlc3BvbnNlVG9vbGJhckRyb3BEb3duPiA9IFtdO1xyXG4gICAgQElucHV0KClcclxuICAgIHNldCBncm91cHModmFsdWVzOiBBcnJheTxSZXNwb25zZVRvb2xiYXJHcm91cD4pIHtcclxuICAgICAgICBpZiAodmFsdWVzKSB7XHJcbiAgICAgICAgICAgIHRoaXMucmVzaXplR3JvdXBzID0gW107XHJcbiAgICAgICAgICAgIHZhbHVlcy5mb3JFYWNoKGdyb3VwID0+IHtcclxuICAgICAgICAgICAgICAgIHRoaXMucmVzaXplR3JvdXBzLnB1c2goXHJcbiAgICAgICAgICAgICAgICAgICAgbmV3IFJlc3BvbnNlVG9vbGJhckdyb3VwKGdyb3VwLmlkLCBncm91cC5uYW1lKVxyXG4gICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgIC8vIOi/mOayoeacieiuoeeul+mihOe9ruaOkuW6j1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBwcml2YXRlIGRpc3RhbmNlVGhyZXNob2xkID0gMjA7XHJcbiAgICBwcml2YXRlIGlzVXBkYXRlVEJWaWV3ID0gZmFsc2U7XHJcblxyXG4gICAgQElucHV0KClcclxuICAgIHNldCBkYXRhcyh2YWx1ZXM6IEFycmF5PFJlc3BvbnNlVG9vbGJhckl0ZW0gfCBSZXNwb25zZVRvb2xiYXJEcm9wRG93bj4pIHtcclxuICAgICAgICBpZiAodmFsdWVzKSB7XHJcbiAgICAgICAgICAgIHRoaXMudG9vbGJhckRhdGFzID0gdGhpcy5fZm9ybWF0RGF0YSh2YWx1ZXMpO1xyXG4gICAgICAgICAgICB0aGlzLm5lZWRSZXNwb25zZUNoYW5nZXMrKztcclxuICAgICAgICAgICAgLy8g5aSE55CG5YiG57uE5pWw5o2uXHJcbiAgICAgICAgICAgIHRoaXMuX3JlT3JnYW5pemVSZXNpemVHcm91cHMoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBfc3RhdGVEYXRhczogT2JzZXJ2YWJsZTxBcnJheTxhbnk+PiA9IG5ldyBTdWJqZWN0KCk7XHJcbiAgICAvLyDmjInpkq7nmoTnpoHnlKjnirbmgIFcclxuICAgIEBJbnB1dCgpXHJcbiAgICBzZXQgYnRuU3RhdGUodmFsdWVzOiBPYnNlcnZhYmxlPEFycmF5PGFueT4+KSB7XHJcbiAgICAgICAgdGhpcy5fc3RhdGVEYXRhcyA9IHZhbHVlcztcclxuICAgIH1cclxuICAgIF9idG5WaXNpYmxlRGF0YXM6IE9ic2VydmFibGU8QXJyYXk8YW55Pj4gPSBuZXcgU3ViamVjdCgpO1xyXG4gICAgLy8g5oyJ6ZKu55qE5p+l55yL54q25oCBXHJcbiAgICBASW5wdXQoKVxyXG4gICAgc2V0IGJ0blZpc2libGUodmFsdWVzOiBPYnNlcnZhYmxlPEFycmF5PGFueT4+KSB7XHJcbiAgICAgICAgdGhpcy5fYnRuVmlzaWJsZURhdGFzID0gdmFsdWVzO1xyXG4gICAgfVxyXG4gICAgQElucHV0KCkgY2xpY2tUaHJvdHRsZVRpbWUgPSAzNTA7XHJcbiAgICBwcml2YXRlIGNsaWNrSXRlbXMgPSBuZXcgU3ViamVjdDxhbnk+KCk7XHJcbiAgICBwcml2YXRlIGNsaWNrU3Vic2NyaXB0aW9uOiBTdWJzY3JpcHRpb247XHJcbiAgICBwcml2YXRlIHJ0U2l6ZSA9IFwiXCI7XHJcbiAgICAvKuWwuuWvuO+8muaciXNtLGxnLOepuuWAvO+8jOm7mOiupOaYr+epuuWAvCAqL1xyXG4gICAgQElucHV0KClcclxuICAgIHNldCBidXR0b25TaXplKGJ0blNpemU6IHN0cmluZykge1xyXG4gICAgICAgIGlmIChidG5TaXplICE9IHRoaXMucnRTaXplKSB7XHJcbiAgICAgICAgICAgIHRoaXMucnRTaXplICYmXHJcbiAgICAgICAgICAgICAgICB0aGlzLnJlbmRlci5yZW1vdmVDbGFzcyhcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9zZWxmRWwsXHJcbiAgICAgICAgICAgICAgICAgICAgXCJmLXJlc3BvbnNlLXRvb2xiYXItXCIgKyB0aGlzLnJ0U2l6ZVxyXG4gICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgdGhpcy5ydFNpemUgPSBidG5TaXplO1xyXG4gICAgICAgICAgICB0aGlzLnJ0U2l6ZSAmJlxyXG4gICAgICAgICAgICAgICAgdGhpcy5yZW5kZXIuYWRkQ2xhc3MoXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fc2VsZkVsLFxyXG4gICAgICAgICAgICAgICAgICAgIFwiZi1yZXNwb25zZS10b29sYmFyLVwiICsgdGhpcy5ydFNpemVcclxuICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgZ2V0IGJ1dHRvblNpemUoKTogc3RyaW5nIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5ydFNpemU7XHJcbiAgICB9XHJcbiAgICAvKuW8uuWItuaWueWQke+8jOm7mOiupOS4uuepuuWAvO+8jOWPr+S7peaciXRvcOOAgWJvdHRvbe+8jOacneS4iuOAgeacneS4i+OAglxyXG4gICAgICog5L2/55So5Zy65pmv77ya5bel5YW35qCP5YaF6YOo55qE5LiL5ouJ77yM6ZyA6KaB5pyd5LiK5oiW6ICF6ZyA6KaB5pyd5LiL5bGV5byA77yM57uf5LiA5o6n5Yi2XHJcbiAgICAgKi9cclxuICAgIEBJbnB1dCgpIHBvcERpcmVjdGlvbiA9IFwiXCI7XHJcbiAgICAvLyByaWdodOaMiemSrumdoOWPsyBsZWZ05oyJ6ZKu6Z2g5bemXHJcbiAgICBASW5wdXQoKSBidG5BbGlnbiA9IFwicmlnaHRcIjtcclxuICAgIHByaXZhdGUgbmdab25lID0gbnVsbDtcclxuICAgIGNvbnN0cnVjdG9yKFxyXG4gICAgICAgIGVsOiBFbGVtZW50UmVmLFxyXG4gICAgICAgIHByaXZhdGUgcmVuZGVyOiBSZW5kZXJlcjIsXHJcbiAgICAgICAgcHJpdmF0ZSBjZDogQ2hhbmdlRGV0ZWN0b3JSZWYsXHJcbiAgICAgICAgcHVibGljIGxvY2FsZVNlcnZpY2U6IExvY2FsZVNlcnZpY2VcclxuICAgICkgLy8gcHJpdmF0ZSBuZ1pvbmU6IE5nWm9uZVxyXG4gICAge1xyXG4gICAgICAgIHRoaXMuX3NlbGZFbCA9IGVsLm5hdGl2ZUVsZW1lbnQ7XHJcbiAgICAgICAgaWYgKGVsLm5hdGl2ZUVsZW1lbnQucGFyZW50RWxlbWVudCkge1xyXG4gICAgICAgICAgICB0aGlzLnJlZmVyRWwgPSBlbC5uYXRpdmVFbGVtZW50LnBhcmVudEVsZW1lbnQ7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgLy8g5Zug5Li65pen5qih5p2/5bim5pyJ6L+Z5Liq5pa55rOVXHJcbiAgICBuZ0FmdGVyVmlld0luaXQoKSB7fVxyXG4gICAgLy8g5Zug5Li65pen5qih5p2/5bim5pyJ6L+Z5Liq5pa55rOVXHJcbiAgICBuZ0RvQ2hlY2soKSB7fVxyXG4gICAgbmdPbkluaXQoKSB7XHJcbiAgICAgICAgLy8g5Y675o6Jb3ZlcmZsb3fkuYvlkI5cclxuICAgICAgICB0aGlzLnJlbmRlci5hZGRDbGFzcyhcclxuICAgICAgICAgICAgdGhpcy5hdXhpbGlhcnlDb250YWluZXJFbC5uYXRpdmVFbGVtZW50LFxyXG4gICAgICAgICAgICBcInJlc3BvbnNlLXRvb2xiYXItaGlkZGVuLWVsZW1lbnRcIlxyXG4gICAgICAgICk7XHJcbiAgICAgICAgLy8g5oyJ6ZKu55qE56aB55So54q25oCBXHJcbiAgICAgICAgdGhpcy5fc3RhdGVEYXRhcy5zdWJzY3JpYmUoZGF0YSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuY2hhbmdlU3RhdGUoZGF0YSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgLy8g5oyJ6ZKu55qE5Y+v6KeB54q25oCBXHJcbiAgICAgICAgdGhpcy5fYnRuVmlzaWJsZURhdGFzLnN1YnNjcmliZShkYXRhID0+IHtcclxuICAgICAgICAgICAgdGhpcy5jaGFuZ2VWaXNpYmxlKGRhdGEpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMub2JzZXJ2ZXJFbGVtZW50KCk7XHJcbiAgICAgICAgLy/lpITnkIbooajljZXliqDovb3lkI7nmoTmjInpkq7lj5jljJZcclxuICAgICAgICB0aGlzLm5nWm9uZS5ydW5PdXRzaWRlQW5ndWxhcigoKSA9PiB7XHJcbiAgICAgICAgICAgIGxldCBzZWxmT2JqPXRoaXM7XHJcbiAgICAgICAgICAgIHNldFRpbWVvdXQoKCk9PntcclxuICAgICAgICAgICAgICAgIHNlbGZPYmoucmVzcG9uc2VSZXNpemUoKTtcclxuICAgICAgICAgICAgfSwwKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICAvLyDmi6bmiKrngrnlh7vkuovku7blj6rkvKDpgJLnrKzkuIDmrKHngrnlh7vkuovku7bnmoTlpITnkIbmk43kvZzkuqTnu5lwYXJlbnTmnaXlpITnkIZcclxuICAgICAgICB0aGlzLmNsaWNrU3Vic2NyaXB0aW9uID0gdGhpcy5jbGlja0l0ZW1zXHJcbiAgICAgICAgICAgIC5waXBlKGRlYm91bmNlVGltZSh0aGlzLmNsaWNrVGhyb3R0bGVUaW1lKSlcclxuICAgICAgICAgICAgLnN1YnNjcmliZSgoZXZlbnREYXRhczogUmVzcG9uc2VUb29sYmFyQ2xpY2tFdmVudCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5ydENsaWNrRXZlbnQuZW1pdChldmVudERhdGFzKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgaWYgKHRoaXMucG9wRGlyZWN0aW9uID09PSAnZGVmYXVsdCcpIHtcclxuICAgICAgICAgICAgdGhpcy5wb3BEaXJlY3Rpb24gPSAnJztcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBuZ09uRGVzdHJveSgpIHtcclxuICAgICAgICBpZiAodGhpcy5ybykge1xyXG4gICAgICAgICAgICB0aGlzLnJvLnVub2JzZXJ2ZSh0aGlzLnJlc2l6ZWRDb250YWluZXJFbC5uYXRpdmVFbGVtZW50KTtcclxuICAgICAgICAgICAgdGhpcy5ybyA9IG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLmNsaWNrU3Vic2NyaXB0aW9uKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2xpY2tTdWJzY3JpcHRpb24udW5zdWJzY3JpYmUoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICAvLyDov5nkuKrmlrnms5XmnInmgKfog73pl67popjvvIzlvoXlkI7mnJ/lpITnkIYgVE9ET1xyXG4gICAgbmdBZnRlclZpZXdDaGVja2VkKCkge1xyXG4gICAgICAgIGlmICh0aGlzLm5lZWRSZXNwb25zZUNoYW5nZXMgPiAwKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm5lZWRSZXNwb25zZUNoYW5nZXMtLTtcclxuICAgICAgICAgICAgICAgIHRoaXMucmVzcG9uc2VSZXNpemUoKTtcclxuICAgICAgICB9ZWxzZSBpZiAodGhpcy5hdXhpbGlhcnlEYXRhcy5sZW5ndGg+MCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fY2FsY3VsYXRlKFxyXG4gICAgICAgICAgICAgICAgICAgIHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5hdXhpbGlhcnlDb250YWluZXJFbC5uYXRpdmVFbGVtZW50Lm9mZnNldFdpZHRoXHJcbiAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICB9XHJcbiAgICAvLyDlm6DkuLrml6fmqKHmnb/luKbmnInov5nkuKrmlrnms5VcclxuICAgIG9uUmVzaXplKGV2ZW50KSB7fVxyXG4gICAgLyoqXHJcbiAgICAgKiDlhbzlrrnml6fmqKHmnb/ml6fmlrnms5VcclxuICAgICAqIOWcqOS4jeWtmOWcqG5nWm9uZeeahOaDheWGteS4i++8jOWIm+W7um5nWm9uZSznhLblkI7nu5Hlrprkuovku7ZcclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBvYnNlcnZlckVsZW1lbnQoKSB7XHJcbiAgICAgICAgaWYgKCF0aGlzLm5nWm9uZSkge1xyXG4gICAgICAgICAgICBjb25zdCBtb2R1bGVJbmplY3RvciA9IHRoaXMuY2RbXCJfdmlld1wiXS5yb290Lm5nTW9kdWxlLmluamVjdG9yO1xyXG4gICAgICAgICAgICB0aGlzLm5nWm9uZSA9IG1vZHVsZUluamVjdG9yLmdldDxOZ1pvbmU+KE5nWm9uZSwgbnVsbCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLm5nWm9uZS5ydW5PdXRzaWRlQW5ndWxhcigoKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMucm8gPSBuZXcgUmVzaXplT2JzZXJ2ZXIoKGVudHJpZXMsIG9ic2VydmVyKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ZW1wV2lkdGggPSBlbnRyaWVzWzBdLmNvbnRlbnRSZWN0LndpZHRoO1xyXG4gICAgICAgICAgICAgICAgaWYgKFxyXG4gICAgICAgICAgICAgICAgICAgIE1hdGguYWJzKHRlbXBXaWR0aCAtIHRoaXMuY29udGFpbmVyV2lkdGhSZWNvcmQpID5cclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kaXN0YW5jZVRocmVzaG9sZFxyXG4gICAgICAgICAgICAgICAgKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZXNwb25zZVJlc2l6ZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY29udGFpbmVyV2lkdGhSZWNvcmQgPSB0ZW1wV2lkdGg7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB0aGlzLnJvLm9ic2VydmUodGhpcy5yZXNpemVkQ29udGFpbmVyRWwubmF0aXZlRWxlbWVudCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIOW8uuWItui9rOaNouaWueWQkVxyXG4gICAgICogQHBhcmFtIHNlbGZEZWZpbmVQTFxyXG4gICAgICogQHBhcmFtIGRlZmF1bHRQTFxyXG4gICAgICovXHJcbiAgICBnZXRQbGFjZW1lbnQoc2VsZkRlZmluZVBMOiBzdHJpbmcsIGRlZmF1bHRQTDogc3RyaW5nKTogc3RyaW5nIHtcclxuICAgICAgICBsZXQgb2xkRGlyZWN0aW9uID0gc2VsZkRlZmluZVBMID8gc2VsZkRlZmluZVBMIDogZGVmYXVsdFBMO1xyXG4gICAgICAgIGlmICghdGhpcy5wb3BEaXJlY3Rpb24pIHtcclxuICAgICAgICAgICAgcmV0dXJuIG9sZERpcmVjdGlvbjtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIHBsUmVsYXRpb24gPSB7IGJvdHRvbTogXCJ0b3BcIiwgdG9wOiBcImJvdHRvbVwiIH07XHJcbiAgICAgICAgb2xkRGlyZWN0aW9uID0gb2xkRGlyZWN0aW9uID09IFwibGVmdFwiID8gXCJsZWZ0LWJvdHRvbVwiIDogb2xkRGlyZWN0aW9uO1xyXG4gICAgICAgIG9sZERpcmVjdGlvbiA9IG9sZERpcmVjdGlvbiA9PSBcInJpZ2h0XCIgPyBcInJpZ2h0LWJvdHRvbVwiIDogb2xkRGlyZWN0aW9uO1xyXG4gICAgICAgIGxldCBuZXdEaXJlY3Rpb24gPSBvbGREaXJlY3Rpb24ucmVwbGFjZShcclxuICAgICAgICAgICAgcGxSZWxhdGlvblt0aGlzLnBvcERpcmVjdGlvbl0sXHJcbiAgICAgICAgICAgIHRoaXMucG9wRGlyZWN0aW9uXHJcbiAgICAgICAgKTtcclxuICAgICAgICByZXR1cm4gbmV3RGlyZWN0aW9uO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog6LCD55So5q2k5pa55rOV55qE5Zy65pmvXHJcbiAgICAgKiAx44CB55WM6Z2i5ouW5ou96Ieq5Yqo6Kem5Y+RXHJcbiAgICAgKiAy44CB5pi+56S66LCD55SoXHJcbiAgICAgKi9cclxuICAgIHJlc3BvbnNlUmVzaXplKCkge1xyXG4gICAgICAgIGNvbnN0IF9kaXN0YW5jZSA9IHRoaXMuX2dldERpc3RhbmNlKCk7XHJcbiAgICAgICAgaWYgKF9kaXN0YW5jZSA+IDApIHtcclxuICAgICAgICAgICAgLy8g5aaC5p6c5YiG57uE6YO95bey57uP5aSE55CG5a6MLOWGjeWHuueOsOa7muWKqOadoeS4jeeuoVxyXG4gICAgICAgICAgICBjb25zdCBfdGVtcEluZGV4ID0gdGhpcy5fZ2V0Rmlyc3RVblJlc3BvbnNlZEluZGV4KCk7XHJcbiAgICAgICAgICAgIGlmIChfdGVtcEluZGV4IDwgMCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vIOaJgOacieesrOS4gOWxguS4i+aLiemDveWPjuaKmFxyXG4gICAgICAgICAgICB0aGlzLmRwU3RhdGUgPSBbZmFsc2VdO1xyXG4gICAgICAgICAgICBmb3IgKGxldCBrID0gX3RlbXBJbmRleDsgayA8IHRoaXMucmVzaXplR3JvdXBzLmxlbmd0aDsgaysrKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBfdGVtcEdyb3VwID0gdGhpcy5yZXNpemVHcm91cHNba107XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9hdXhpbGlhcnkgPSBrO1xyXG4gICAgICAgICAgICAgICAgaWYgKF90ZW1wR3JvdXAuaXNSZXNwb25zaW5nKCkpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9jYWxjdWxhdGUoKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8g5aaC5p6c6L+Y5pyq5byA5aeL5aSE55CG5ZON5bqU5byPXHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgX3RlbXBEUCA9IG5ldyBSZXNwb25zZVRvb2xiYXJEcm9wRG93bih7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ6IF90ZW1wR3JvdXAubmFtZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IF90ZW1wR3JvdXAuaWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBsYWNlbWVudDogdGhpcy5wb3BEaXJlY3Rpb25cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gdGhpcy5wb3BEaXJlY3Rpb24gKyBcIi1sZWZ0XCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogXCJib3R0b20tbGVmdFwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB3aWR0aDogX3RlbXBHcm91cC5nZXRXaWR0aCgpXHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8g5bey57uP5aSE55CG6L+H5a695bqmXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKF90ZW1wRFAuZ2V0V2lkdGgoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmF1eGlsaWFyeURhdGFzID0gW190ZW1wRFBdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9jYWxjdWxhdGUodHJ1ZSwgX3RlbXBEUC5nZXRXaWR0aCgpKTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyDmm7TmlrDovoXliqnmlbDmja5cclxuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGF1eGlsaWFyeUluZGV4PXRoaXMuYXV4aWxpYXJ5RGF0YXMuZmluZEluZGV4KChpdGVtKT0+e1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGl0ZW0uaWQ9PV90ZW1wRFAuaWRcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKGF1eGlsaWFyeUluZGV4PT0tMSl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmF1eGlsaWFyeURhdGFzLnB1c2goX3RlbXBEUCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYodGhpcy5jZCYmISh0aGlzLmNkIGFzIFZpZXdSZWYpLmRlc3Ryb3llZCl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNkLmRldGVjdENoYW5nZXMoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIC8vIOWvu+aJvuacgOWQjuS4gOS4quWkhOeQhuWTjeW6lOW8j+eahOWFg+e0oFxyXG4gICAgICAgICAgICBjb25zdCBfdGVtcEluZGV4ID0gdGhpcy5fZ2V0TGFzdFJlc3BvbnNlSW5kZXgoKTtcclxuICAgICAgICAgICAgaWYgKF90ZW1wSW5kZXggPCAwKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy8g5Li05pe25a2Y5YKo5pWw5o2uXHJcbiAgICAgICAgICAgIGxldCBfdGVtcFRvb2xiYXJEYXRhcyA9IFtdLmNvbmNhdCh0aGlzLnRvb2xiYXJEYXRhcyk7XHJcbiAgICAgICAgICAgIC8vIOWmguaenOW3sue7j+W8gOWni+WkhOeQhuWTjeW6lOW8j1xyXG4gICAgICAgICAgICBmb3IgKGxldCBrID0gX3RlbXBJbmRleDsgayA+PSAwOyBrLS0pIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IHRoaXMuX3Jlc3RpdHV0ZShfdGVtcFRvb2xiYXJEYXRhcywgayk7XHJcbiAgICAgICAgICAgICAgICBfdGVtcFRvb2xiYXJEYXRhcyA9IFtdLmNvbmNhdChyZXN1bHRbXCJkYXRhXCJdKTtcclxuICAgICAgICAgICAgICAgIGlmICghcmVzdWx0W1wiY29udGludWVUb1wiXSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vIOabtOaWsOaVsOaNrlxyXG4gICAgICAgICAgICB0aGlzLnRvb2xiYXJEYXRhcyA9IFtdLmNvbmNhdChfdGVtcFRvb2xiYXJEYXRhcyk7XHJcbiAgICAgICAgICAgIC8vIOaJgOacieesrOS4gOWxguS4i+aLiemDveWPjuaKmFxyXG4gICAgICAgICAgICB0aGlzLmRwU3RhdGUgPSBbZmFsc2VdO1xyXG4gICAgICAgICAgICBpZih0aGlzLmNkJiYhKHRoaXMuY2QgYXMgVmlld1JlZikuZGVzdHJveWVkKXtcclxuICAgICAgICAgICAgICAgIHRoaXMuY2QuZGV0ZWN0Q2hhbmdlcygpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgLy8g5LiL5ouJ55qE5bGV5byA5pS26LW354q25oCBXHJcbiAgICBkcFNlY3Rpb25TdGF0ZShzdGF0ZTogYm9vbGVhbiwgaWQpIHtcclxuICAgICAgICBpZiAoc3RhdGUpIHtcclxuICAgICAgICAgICAgLy8g5bGV5byA54q25oCB5LiLXHJcbiAgICAgICAgICAgIGxldCBkcm9wZG93bnMgPSB0aGlzLnJlc2l6ZWRDb250ZW50RWwubmF0aXZlRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKFxyXG4gICAgICAgICAgICAgICAgXCJbZkRyb3Bkb3duXVwiXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIGlmIChkcm9wZG93bnMgJiYgZHJvcGRvd25zLmxlbmd0aCA+IDEpIHtcclxuICAgICAgICAgICAgICAgIGZvciAodmFyIGsgPSAwOyBrIDwgZHJvcGRvd25zLmxlbmd0aDsgaysrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkcm9wZG93bnNba10uY2xhc3NOYW1lLmluZGV4T2YoXCJzaG93XCIpICYmXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRyb3Bkb3duc1trXS5pZCAhPSBpZFxyXG4gICAgICAgICAgICAgICAgICAgICkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBkcm9wZG93bnNba10uZGlzcGF0Y2hFdmVudChuZXcgRXZlbnQoJ3NlbGZDbG9zZScpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jb21wYXRpYmxlRGlzcGF0Y2hFdmVudChkcm9wZG93bnNba10sIFwic2VsZkNsb3NlXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHByaXZhdGUgY29tcGF0aWJsZURpc3BhdGNoRXZlbnQoZXZlbnRFbCwgZXZlbnROYW1lKSB7XHJcbiAgICAgICAgdmFyIGV2ZW50O1xyXG4gICAgICAgIGlmICh0eXBlb2YgRXZlbnQgPT09IFwiZnVuY3Rpb25cIikge1xyXG4gICAgICAgICAgICBldmVudCA9IG5ldyBFdmVudChldmVudE5hbWUpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGV2ZW50ID0gZG9jdW1lbnQuY3JlYXRlRXZlbnQoXCJFdmVudFwiKTtcclxuICAgICAgICAgICAgZXZlbnQuaW5pdEV2ZW50KGV2ZW50TmFtZSwgZmFsc2UsIGZhbHNlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZXZlbnRFbC5kaXNwYXRjaEV2ZW50KGV2ZW50KTtcclxuICAgIH1cclxuICAgIC8vIOS/ruaUueWQr+eUqOemgeeUqOeKtuaAgVxyXG4gICAgY2hhbmdlU3RhdGUodmFsdWVzKSB7XHJcbiAgICAgICAgY29uc3QgaWRBcnJheSA9IE9iamVjdC5rZXlzKHZhbHVlcyk7XHJcbiAgICAgICAgaWRBcnJheS5mb3JFYWNoKGlkID0+IHtcclxuICAgICAgICAgICAgY29uc3Qgc3RhdGUgPSB2YWx1ZXNbaWRdO1xyXG4gICAgICAgICAgICBjb25zdCBpdGVtID0gdGhpcy5fZmluZEl0ZW1CeUlEKGlkLCB0aGlzLnRvb2xiYXJEYXRhcyk7XHJcbiAgICAgICAgICAgIGlmKGl0ZW0pe1xyXG4gICAgICAgICAgICAgICAgIGl0ZW1bXCJkaXNhYmxlZFwiXSA9IHN0YXRlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgaWYodGhpcy5jZCYmISh0aGlzLmNkIGFzIFZpZXdSZWYpLmRlc3Ryb3llZCl7XHJcbiAgICAgICAgICAgIHRoaXMuY2QuZGV0ZWN0Q2hhbmdlcygpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICog5L+u5pS55pi+56S654q25oCBXHJcbiAgICAgKiDlpoLmnpzmmK/kuIvmi4nmjInpkq5cclxuICAgICAqICAg5Yik5pat5LiL6Z2i55qE5a2Q5piv5ZCm6YO96ZqQ6JePXHJcbiAgICAgKiBAcGFyYW0gdmFsdWVzXHJcbiAgICAgKi9cclxuICAgIGNoYW5nZVZpc2libGUodmFsdWVzKSB7XHJcbiAgICAgICAgY29uc3QgaWRBcnJheSA9IE9iamVjdC5rZXlzKHZhbHVlcyk7XHJcbiAgICAgICAgaWRBcnJheS5mb3JFYWNoKGlkID0+IHtcclxuICAgICAgICAgICAgY29uc3QgdmlzaWJsZSA9IHZhbHVlc1tpZF07XHJcbiAgICAgICAgICAgIGNvbnN0IGl0ZW0gPSB0aGlzLl9maW5kSXRlbUJ5SUQoaWQsIHRoaXMudG9vbGJhckRhdGFzKTtcclxuICAgICAgICAgICAgaWYoaXRlbSl7XHJcbiAgICAgICAgICAgICAgICBpdGVtW1widmlzaWJsZVwiXSA9IHZpc2libGU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICAvLyDpgY3ljoblvqrnjq8s5pu05paw5pWw5o2uXHJcbiAgICAgICAgdGhpcy50b29sYmFyRGF0YXMuZm9yRWFjaChpdGVtID0+IHtcclxuICAgICAgICAgICAgLy8g5aaC5p6c5piv5LiL5ouJXHJcbiAgICAgICAgICAgIGlmIChpdGVtW1wiaXNEUFwiXSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fY2hlY2tEcm9wZG93blZpc2libGUodmFsdWVzLCBpdGVtKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMubmVlZFJlc3BvbnNlQ2hhbmdlcysrO1xyXG4gICAgICAgIC8vIOabtOaWsFxyXG4gICAgICAgLy90aGlzLmNkLm1hcmtGb3JDaGVjaygpO1xyXG4gICAgICAgaWYodGhpcy5jZCYmISh0aGlzLmNkIGFzIFZpZXdSZWYpLmRlc3Ryb3llZCl7XHJcbiAgICAgICAgdGhpcy5jZC5kZXRlY3RDaGFuZ2VzKCk7XHJcbiAgICAgfVxyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiDlpoLmnpzmmK/kuIvmi4nmjInpkq5cclxuICAgICAqICAg5Yik5pat5LiL6Z2i55qE5a2Q5piv5ZCm6YO96ZqQ6JePXHJcbiAgICAgKiAgICAgICBBLiDlpoLmnpzlrZDpg73pmpDol4/vvIzpgqPkuYjmlbTkuKrkuIvmi4npg73ooqvpmpDol4/vvJtcclxuICAgICAqICAgICAgIEIuIOWmguaenOWtmOWcqOWtkOayoeaciemakOiXj++8jOiAjOS4lOS4i+aLieayoeacieiiq+mihOe9rumakOiXj++8jOS4i+aLieaMiemSruaYvuekulxyXG4gICAgICogQHBhcmFtIG91dHNpZGVWaXNpYmxlQXJyYXlzIOS7jue7hOS7tuWkluS8oOWFpeeahOWPr+ingeeKtuaAgeWvueixoVxyXG4gICAgICogQHBhcmFtIGRyb3Bkb3duSXRlbSDkuIvmi4nlhYPntKBcclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBfY2hlY2tEcm9wZG93blZpc2libGUob3V0c2lkZVZpc2libGVBcnJheXMsIGRyb3Bkb3duSXRlbSk6IHZvaWQge1xyXG4gICAgICAgIC8v5aaC5p6c5rKh5pyJ6KKr5by65Yi26K6+572u54q25oCBXHJcbiAgICAgICAgaWYgKCFvdXRzaWRlVmlzaWJsZUFycmF5cy5oYXNPd25Qcm9wZXJ0eShkcm9wZG93bkl0ZW1bXCJpZFwiXSkpIHtcclxuICAgICAgICAgICAgLy8g5LiL5ouJ5YWD57Sg5LiN5Y+v6KeB77yM5Yik5pat5piv5ZCm5pyJ5Y+v6KeB5a2Q5YWD57SgXHJcbiAgICAgICAgICAgIGlmIChcclxuICAgICAgICAgICAgICAgICFkcm9wZG93bkl0ZW1bXCJ2aXNpYmxlXCJdICYmXHJcbiAgICAgICAgICAgICAgICB0aGlzLl9oYXNWaXNpYmxlSXRlbShkcm9wZG93bkl0ZW1bXCJjaGlsZHJlblwiXSwgdHJ1ZSlcclxuICAgICAgICAgICAgKSB7XHJcbiAgICAgICAgICAgICAgICBkcm9wZG93bkl0ZW1bXCJ2aXNpYmxlXCJdID0gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvLyDkuIvmi4nlhYPntKDmmK/lj6/op4HvvIzliKTmlq3mmK/lkKbmnInlrZDlhYPntKDpg73kuI3lj6/op4FcclxuICAgICAgICAgICAgaWYgKFxyXG4gICAgICAgICAgICAgICAgZHJvcGRvd25JdGVtW1widmlzaWJsZVwiXSAmJlxyXG4gICAgICAgICAgICAgICAgIXRoaXMuX2hhc1Zpc2libGVJdGVtKGRyb3Bkb3duSXRlbVtcImNoaWxkcmVuXCJdLCB0cnVlKVxyXG4gICAgICAgICAgICApIHtcclxuICAgICAgICAgICAgICAgIGRyb3Bkb3duSXRlbVtcInZpc2libGVcIl0gPSBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBkcm9wZG93bkl0ZW0uY2hpbGRyZW4uZm9yRWFjaChpdGVtID0+IHtcclxuICAgICAgICAgICAgaWYgKGl0ZW1bXCJpc0RQXCJdKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9jaGVja0Ryb3Bkb3duVmlzaWJsZShvdXRzaWRlVmlzaWJsZUFycmF5cywgaXRlbSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICog5Zyo5b6F5qOA5p+l5pWw5o2u5Lit5b+D77yM5qOA5p+l5piv5ZCm5a2Y5Zyo6K+l5Y+v6KeB54q25oCB55qE5pWw5o2u44CCXHJcbiAgICAgKiDlpoLmnpzmnInov5Tlm550cnVlLOWQpuWImei/lOWbnmZhbHNlXHJcbiAgICAgKiBAcGFyYW0gZGF0YXMg5b6F5qOA5p+l5pWw5o2uXHJcbiAgICAgKiBAcGFyYW0gdmlzaWJsZSDlj6/op4HnirbmgIFcclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBfaGFzVmlzaWJsZUl0ZW0oZGF0YXMsIHZpc2libGUpOiBib29sZWFuIHtcclxuICAgICAgICBjb25zdCBmaW5kSW5kZXggPSBkYXRhcy5maW5kSW5kZXgoY2hpbGRJdGVtID0+IHtcclxuICAgICAgICAgICAgaWYgKGNoaWxkSXRlbVtcInZpc2libGVcIl0gPT0gdmlzaWJsZSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGlmIChmaW5kSW5kZXggPiAtMSkge1xyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog5o2V6I6354K55Ye7XHJcbiAgICAgKiBAcGFyYW0gZXZcclxuICAgICAqL1xyXG4gICAgY2xpY2tJdGVtKGV2OiBNb3VzZUV2ZW50LCBkZFJlZj86IEZEcm9wZG93bkRpcmVjdGl2ZSkge1xyXG4gICAgICAgIGV2LnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgIC8vIOWmguaenOaYr+WIhuemu+eahOS4i+aLieaMiemSrlxyXG4gICAgICAgIGlmICh0aGlzLmVsaGFzU3BlY2lhbENscyhldi50YXJnZXQsIFwiZHJvcGRvd24tdG9nZ2xlLXNwbGl0XCIpKSB7XHJcbiAgICAgICAgICAgIGV2LnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyDliKTmlq3mmK/lkKbngrnlh7vliLDpnIDopoHlpITnkIbkuovku7bnmoTlhYPntKDkuIos5oyJ6ZKu44CB5LiL5ouJ5oyJ6ZKuXHJcbiAgICAgICAgdmFyIGNsaWNrRXZFbCA9IHRoaXMuZmluZEJ0bk9yVG9nZ2xlckl0ZW1Gcm9tQ2xpY2soZXYudGFyZ2V0KTtcclxuICAgICAgICBpZiAoY2xpY2tFdkVsKSB7XHJcbiAgICAgICAgICAgIGxldCB0ZW1wSUQgPSBjbGlja0V2RWxbXCJpZFwiXTtcclxuICAgICAgICAgICAgLy8g5L+u5pS55qih5p2/77yMaWTosIPmlbTliLDkuIvmi4nmlbTkvZPkuIpcclxuICAgICAgICAgICAgaWYgKFxyXG4gICAgICAgICAgICAgICAgIXRlbXBJRCAmJlxyXG4gICAgICAgICAgICAgICAgdGhpcy5lbGhhc1NwZWNpYWxDbHMoY2xpY2tFdkVsW1wicGFyZW50Tm9kZVwiXSwgXCJmLXJ0LWRyb3Bkb3duXCIpXHJcbiAgICAgICAgICAgICkge1xyXG4gICAgICAgICAgICAgICAgdGVtcElEID0gY2xpY2tFdkVsW1wicGFyZW50Tm9kZVwiXS5pZDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAodGVtcElEKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ZW1wSXRlbSA9IHRoaXMuX2ZpbmRJdGVtQnlJRCh0ZW1wSUQsIHRoaXMudG9vbGJhckRhdGFzKTtcclxuICAgICAgICAgICAgICAgIC8vIOWmguaenOWFg+e0oOemgeeUqFxyXG4gICAgICAgICAgICAgICAgaWYgKHRlbXBJdGVtW1wiZGlzYWJsZWRcIl0pIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyDnpoHmraLlkJHkuIrkvKDpgJJcclxuICAgICAgICAgICAgICAgICAgICBldi5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY2xpY2tJdGVtcy5uZXh0KHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IHRlbXBJRCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGV4dDogdGVtcEl0ZW1bXCJ0ZXh0XCJdLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBoaWRkZW46IHRlbXBJdGVtW1wiaGlkZGVuXCJdXHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChkZFJlZikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZFJlZi5jbG9zZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGV2LnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHByaXZhdGUgZmluZEJ0bk9yVG9nZ2xlckl0ZW1Gcm9tQ2xpY2soY2xpY2tUYXJnZXQpIHtcclxuICAgICAgICAvLyDniLbnuqfmoIfnrb7mmK/lkKbmmK9ib2R5LOaYr+edgOWBnOatoui/lOWbnumbhuWQiCzlj43kuYvnu6fnu61cclxuICAgICAgICBpZiAodGhpcy5lbGhhc1NwZWNpYWxDbHMoY2xpY2tUYXJnZXQpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBjbGlja1RhcmdldDtcclxuICAgICAgICB9IGVsc2UgaWYgKFxyXG4gICAgICAgICAgICBjbGlja1RhcmdldC5wYXJlbnROb2RlW1wiY2xhc3NOYW1lXCJdJiZjbGlja1RhcmdldC5wYXJlbnROb2RlW1wiY2xhc3NOYW1lXCJdLmluZGV4T2YoXCJmLXJlc3BvbnNlLWNvbnRlbnRcIikgPCAwXHJcbiAgICAgICAgKSB7XHJcbiAgICAgICAgICAgIHZhciBwYXJlbnROID0gY2xpY2tUYXJnZXQucGFyZW50Tm9kZTtcclxuICAgICAgICAgICAgaWYgKHRoaXMuZWxoYXNTcGVjaWFsQ2xzKHBhcmVudE4pKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcGFyZW50TjtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmZpbmRCdG5PclRvZ2dsZXJJdGVtRnJvbUNsaWNrKHBhcmVudE4pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIOi/lOWbnumbhuWQiCznu5PmnZ9cclxuICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgIH1cclxuICAgIHByaXZhdGUgZWxoYXNTcGVjaWFsQ2xzKGVsLCBjbHNOYW1lID0gXCJcIikge1xyXG4gICAgICAgIGlmIChlbCkge1xyXG4gICAgICAgICAgICB2YXIgY2xhc3NOYW1lTGlzdCA9IGVsLmNsYXNzTGlzdDtcclxuICAgICAgICAgICAgdmFyIGZpbmRDbHMgPSBmYWxzZTtcclxuICAgICAgICAgICAgZm9yICh2YXIgayA9IDA7IGsgPCBjbGFzc05hbWVMaXN0Lmxlbmd0aDsgaysrKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoY2xzTmFtZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChjbGFzc05hbWVMaXN0W2tdID09IGNsc05hbWUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZmluZENscyA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWVMaXN0W2tdID09IFwiZi1ydC1idG5cIiB8fFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWVMaXN0W2tdID09IFwiZi1ydC10b2dnbGVcIlxyXG4gICAgICAgICAgICAgICAgICAgICkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmaW5kQ2xzID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBmaW5kQ2xzO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIOagueaNruS8oOmAkueahOaVsOaNrumHjeaWsOe7hOW7uuWIhue7hFxyXG4gICAgICogVG9EbyDmmoLml7bmsqHmnInmm7TlpI3mnYLnmoTliIbnu4TvvIzlkKbliJnpnIDopoHorrDlvZXliIbnu4RcclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBfcmVPcmdhbml6ZVJlc2l6ZUdyb3VwcygpIHtcclxuICAgICAgICAvLyDlpITnkIbliIbnu4TmlbDmja5cclxuICAgICAgICAvLyAgaWYgKHRoaXMucmVzaXplR3JvdXBzLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgIGxldCBtb3JlVGV4dCA9IFwi5pu05aSaXCI7XHJcbiAgICAgICAgaWYgKHRoaXMubG9jYWxlU2VydmljZSkge1xyXG4gICAgICAgICAgICBtb3JlVGV4dCA9IHRoaXMubG9jYWxlU2VydmljZS5nZXRWYWx1ZShcInJlc3BvbnNlVG9vbGJhci5tb3JlXCIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCBkZWZhdWx0UmVzaXplR3JvdXAgPSBuZXcgUmVzcG9uc2VUb29sYmFyR3JvdXAoXHJcbiAgICAgICAgICAgIFwidG9vbGJhci1ncm91cC0xXCIsXHJcbiAgICAgICAgICAgIG1vcmVUZXh0XHJcbiAgICAgICAgKTtcclxuICAgICAgICBmb3IgKGxldCBpID0gdGhpcy50b29sYmFyRGF0YXMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcclxuICAgICAgICAgICAgZGVmYXVsdFJlc2l6ZUdyb3VwLnNldFByZXNldCh0aGlzLnRvb2xiYXJEYXRhc1tpXVtcImlkXCJdKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5yZXNpemVHcm91cHMgPSBbXS5jb25jYXQoZGVmYXVsdFJlc2l6ZUdyb3VwKTtcclxuICAgICAgIC8vIHRoaXMuY2QubWFya0ZvckNoZWNrKCk7XHJcbiAgICAgICBpZih0aGlzLmNkJiYhKHRoaXMuY2QgYXMgVmlld1JlZikuZGVzdHJveWVkKXtcclxuICAgICAgICB0aGlzLmNkLmRldGVjdENoYW5nZXMoKTtcclxuICAgIH1cclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICog5YaF5a655LiO5a655Zmo55qE5beu5YC8XHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgX2dldERpc3RhbmNlKCkge1xyXG4gICAgICAgIHJldHVybiAoXHJcbiAgICAgICAgICAgIHRoaXMucmVzaXplZENvbnRlbnRFbC5uYXRpdmVFbGVtZW50Lm9mZnNldFdpZHRoIC1cclxuICAgICAgICAgICAgdGhpcy5yZXNpemVkQ29udGFpbmVyRWwubmF0aXZlRWxlbWVudC5vZmZzZXRXaWR0aFxyXG4gICAgICAgICk7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIOagueaNrui/lOWbnue7k+aenOWIpOaWreaYr+WQpue7p+e7rVxyXG4gICAgICogQHBhcmFtIGdyb3VwSW5kZXhcclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBfcmVzdGl0dXRlKG9yaWdpbmFsRGF0YSwgZ3JvdXBJbmRleCkge1xyXG4gICAgICAgIGNvbnN0IHRlbXBHcm91cCA9IHRoaXMucmVzaXplR3JvdXBzW2dyb3VwSW5kZXhdO1xyXG4gICAgICAgIC8vIOa7muWKqOadoeWSjOWGheWuueeahOi3neemu1xyXG4gICAgICAgIGxldCB0ZW1wRGlzdGFuY2UgPSB0aGlzLl9nZXREaXN0YW5jZSgpO1xyXG4gICAgICAgIC8vIOiuoeeul+acgOWQjuS4gOS4quS4i+aLieeahOWuveW6plxyXG4gICAgICAgIGNvbnN0IHRlbXBHcm91cERhdGEgPVxyXG4gICAgICAgICAgICBvcmlnaW5hbERhdGFbdGhpcy5fZmluZEluZGV4QnlJRChvcmlnaW5hbERhdGEsIHRlbXBHcm91cC5pZCldO1xyXG4gICAgICAgIC8vIOaJvuWIsOi/mOWOn+eahOS9jee9rlxyXG4gICAgICAgIGNvbnN0IHRlbXBQcmVzZXRJbmRleCA9IFtdLmNvbmNhdCh0ZW1wR3JvdXAucmVzcG9uc2VkSW5kZXgpO1xyXG4gICAgICAgIC8vIOaOkumZpOWOn+S4i+aLieWtkOWFg+e0oOiiq+iuoeeul1xyXG4gICAgICAgIGZvciAobGV0IGogPSB0ZW1wUHJlc2V0SW5kZXgubGVuZ3RoIC0gMTsgaiA+PSAwOyBqLS0pIHtcclxuICAgICAgICAgICAgaWYgKHRlbXBEaXN0YW5jZSA+PSAwKSB7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvLyDku47kuIvmi4nkuK3np7vpmaRcclxuICAgICAgICAgICAgY29uc3QgdGVtcENoaWxkRGF0YSA9IHRlbXBHcm91cERhdGEuY2hpbGRyZW5bMF07XHJcbiAgICAgICAgICAgIGNvbnN0IHNwZWNpYWxEaXN0YW5jZSA9IGogPT09IDAgPyB0ZW1wR3JvdXBEYXRhLmdldFdpZHRoKCkgOiAwO1xyXG5cclxuICAgICAgICAgICAgdGVtcERpc3RhbmNlID1cclxuICAgICAgICAgICAgICAgIHRlbXBEaXN0YW5jZSArXHJcbiAgICAgICAgICAgICAgICAodGVtcENoaWxkRGF0YS5nZXRXaWR0aCgpID8gdGVtcENoaWxkRGF0YS5nZXRXaWR0aCgpIDogMCkgLVxyXG4gICAgICAgICAgICAgICAgc3BlY2lhbERpc3RhbmNlO1xyXG5cclxuICAgICAgICAgICAgaWYgKHRlbXBEaXN0YW5jZSA+PSAwKSB7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIC8vIOabtOaWsOS4i+aLiVxyXG4gICAgICAgICAgICAgICAgdGVtcEdyb3VwRGF0YS5yZW1vdmVDaGlsZCgpO1xyXG4gICAgICAgICAgICAgICAgLy8g5o+S5YWl5Yiw5Y6f5L2N572uXHJcbiAgICAgICAgICAgICAgICBvcmlnaW5hbERhdGEuc3BsaWNlKHRlbXBQcmVzZXRJbmRleFtqXSwgMCwgdGVtcENoaWxkRGF0YSk7XHJcbiAgICAgICAgICAgICAgICAvLyDmm7TmlrDkvY3nva5cclxuICAgICAgICAgICAgICAgIHRlbXBHcm91cC5yZW1vdmVSZXNwb25zZWQoaik7XHJcbiAgICAgICAgICAgICAgICBpZiAoaiA9PT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIG9yaWdpbmFsRGF0YS5zcGxpY2UoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2ZpbmRJbmRleEJ5SUQob3JpZ2luYWxEYXRhLCB0ZW1wR3JvdXAuaWQpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAxXHJcbiAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBjb250aW51ZVRvOiB0ZW1wRGlzdGFuY2UgPiAwID8gdHJ1ZSA6IGZhbHNlLFxyXG4gICAgICAgICAgICBkYXRhOiBvcmlnaW5hbERhdGFcclxuICAgICAgICB9O1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog5byA5aeL6K6h566XXHJcbiAgICAgKiBAcGFyYW0gZGF0YXNcclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBfY2FsY3VsYXRlKGF1eGlsaWFyeTogYm9vbGVhbiA9IGZhbHNlLCB0R3JvdXBXaWR0aDogbnVtYmVyID0gMCkge1xyXG4gICAgICAgIGlmICh0aGlzLl9hdXhpbGlhcnkgPCAwKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8g6K6w5b2V6ZyA6KaB5L+u5pS555qE5LiL5ouJXHJcbiAgICAgICAgbGV0IHRlbXBEUDtcclxuICAgICAgICAvLyDmu5rliqjmnaHlkozlhoXlrrnnmoTot53nprtcclxuICAgICAgICBsZXQgdGVtcERpc3RhbmNlID0gdGhpcy5fZ2V0RGlzdGFuY2UoKSArIHRHcm91cFdpZHRoO1xyXG4gICAgICAgIC8vIOS4tOaXtuWtmOWCqOaVsOaNrlxyXG4gICAgICAgIGNvbnN0IHRlbXBUb29sYmFyRGF0YXMgPSBbXS5jb25jYXQodGhpcy50b29sYmFyRGF0YXMpO1xyXG4gICAgICAgIGNvbnN0IHRlbXBHcm91cCA9IHRoaXMucmVzaXplR3JvdXBzW3RoaXMuX2F1eGlsaWFyeV07XHJcbiAgICAgICAgaWYgKGF1eGlsaWFyeSkge1xyXG4gICAgICAgICAgICB0ZW1wRFAgPSB0aGlzLmF1eGlsaWFyeURhdGFzLnBvcCgpO1xyXG4gICAgICAgICAgICB0ZW1wRFAuc2V0V2lkdGgodEdyb3VwV2lkdGgpO1xyXG4gICAgICAgICAgICB0ZW1wR3JvdXAuc2V0V2lkdGgodEdyb3VwV2lkdGgpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRlbXBEUCA9XHJcbiAgICAgICAgICAgICAgICB0ZW1wVG9vbGJhckRhdGFzW1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2ZpbmRJbmRleEJ5SUQodGVtcFRvb2xiYXJEYXRhcywgdGVtcEdyb3VwLmlkKVxyXG4gICAgICAgICAgICAgICAgXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8g5b2T5YmN5Ymp5L2Z6ZqQ6JePXHJcbiAgICAgICAgZm9yIChcclxuICAgICAgICAgICAgbGV0IGogPSB0ZW1wR3JvdXAucmVzcG9uc2VkSW5kZXgubGVuZ3RoO1xyXG4gICAgICAgICAgICBqIDwgdGVtcEdyb3VwLnByZXNldElkLmxlbmd0aDtcclxuICAgICAgICAgICAgaisrXHJcbiAgICAgICAgKSB7XHJcbiAgICAgICAgICAgIGlmICh0ZW1wRGlzdGFuY2UgPD0gMCkge1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC8vIOiuoeeul+WcqOW9k+WJjeaVsOaNruS4reeahOS9jee9ru+8jOagueaNrui/meS4quS9jee9ruWPr+S7peaJvuWuveW6plxyXG4gICAgICAgICAgICBjb25zdCB0ZW1wT2xkSW5kZXggPSB0aGlzLl9maW5kSW5kZXhCeUlEKFxyXG4gICAgICAgICAgICAgICAgdGhpcy50b29sYmFyRGF0YXMsXHJcbiAgICAgICAgICAgICAgICB0ZW1wR3JvdXAucHJlc2V0SWRbal1cclxuICAgICAgICAgICAgKSBhcyBhbnk7XHJcbiAgICAgICAgICAgIGNvbnN0IHRlbXBOZXdJbmRleCA9IHRoaXMuX2ZpbmRJbmRleEJ5SUQoXHJcbiAgICAgICAgICAgICAgICB0ZW1wVG9vbGJhckRhdGFzLFxyXG4gICAgICAgICAgICAgICAgdGVtcEdyb3VwLnByZXNldElkW2pdXHJcbiAgICAgICAgICAgICkgYXMgYW55O1xyXG5cclxuICAgICAgICAgICAgLy8g6K6h566X5oyJ6ZKu5a695bqmXHJcbiAgICAgICAgICAgIGxldCB0ZW1wV2lkdGggPSB0aGlzLnRvb2xiYXJEYXRhc1t0ZW1wT2xkSW5kZXhdLmdldFdpZHRoKCkgYXMgYW55O1xyXG4gICAgICAgICAgICBpZiAodGVtcFdpZHRoID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAvLyDmjInpkq7lrr3luqbmnKrmm77ooqvorqHnrpfov4dcclxuICAgICAgICAgICAgICAgIHRlbXBXaWR0aCA9IHRoaXMuX2dldFdpZHRoRnJvbUVsZW1lbnRzQnlJZChcclxuICAgICAgICAgICAgICAgICAgICB0ZW1wR3JvdXAucHJlc2V0SWRbal1cclxuICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICB0ZW1wVG9vbGJhckRhdGFzW3RlbXBOZXdJbmRleF0uc2V0V2lkdGgodGVtcFdpZHRoKTtcclxuICAgICAgICAgICAgfSBlbHNlIGlmICh0ZW1wV2lkdGggPT09IGZhbHNlKSB7XHJcbiAgICAgICAgICAgICAgICAvLyDmjInpkq7ooqvpmpDol49cclxuICAgICAgICAgICAgICAgIHRlbXBXaWR0aCA9IDA7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHRlbXBEUC5hZGRDaGlsZCh0ZW1wVG9vbGJhckRhdGFzW3RlbXBOZXdJbmRleF0pO1xyXG4gICAgICAgICAgICAvLyDnp7vpmaRcclxuICAgICAgICAgICAgdGVtcFRvb2xiYXJEYXRhcy5zcGxpY2UodGVtcE5ld0luZGV4LCAxKTtcclxuICAgICAgICAgICAgLy8g5L+d5a2Y5L2N572u55So5LqO6L+Y5Y6fXHJcbiAgICAgICAgICAgIHRlbXBHcm91cC5zZXRSZXNwb25zZWQodGVtcE5ld0luZGV4KTtcclxuICAgICAgICAgICAgdGVtcERpc3RhbmNlID0gdGVtcERpc3RhbmNlIC0gdGVtcFdpZHRoO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoYXV4aWxpYXJ5ICYmIHRlbXBEUC5oYXNDaGlsZCgpKSB7XHJcbiAgICAgICAgICAgIC8vIOaPkuWFpVxyXG4gICAgICAgICAgICB0ZW1wVG9vbGJhckRhdGFzLnB1c2godGVtcERQKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5fYXV4aWxpYXJ5ID0gLTE7XHJcbiAgICAgICAgdGhpcy50b29sYmFyRGF0YXMgPSBbXS5jb25jYXQodGVtcFRvb2xiYXJEYXRhcyk7XHJcbiAgICAgICAgaWYodGhpcy5jZCYmISh0aGlzLmNkIGFzIFZpZXdSZWYpLmRlc3Ryb3llZCl7XHJcbiAgICAgICAgICAgIHRoaXMuY2QuZGV0ZWN0Q2hhbmdlcygpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOagueaNrmlk5om+5Yiw5a6e6ZmF5pi+56S65YWD57Sg55qE5a695bqmXHJcbiAgICAgKiBAcGFyYW0gZmluZElkXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgX2dldFdpZHRoRnJvbUVsZW1lbnRzQnlJZChmaW5kSWQpOiBudW1iZXIge1xyXG4gICAgICAgIGNvbnN0IHBhcmVudEVsID0gdGhpcy5yZXNpemVkQ29udGVudEVsLm5hdGl2ZUVsZW1lbnQ7XHJcbiAgICAgICAgY29uc3QgY2hpbGRMZW4gPSBwYXJlbnRFbC5jaGlsZHJlbi5sZW5ndGg7XHJcbiAgICAgICAgbGV0IHJlc3VsdCA9IDA7XHJcbiAgICAgICAgZm9yICh2YXIgayA9IDA7IGsgPCBjaGlsZExlbjsgaysrKSB7XHJcbiAgICAgICAgICAgIGlmIChwYXJlbnRFbC5jaGlsZHJlbltrXS5pZCA9PT0gZmluZElkKSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgZmluZEVsPXBhcmVudEVsLmNoaWxkcmVuW2tdO1xyXG4gICAgICAgICAgICAgICAgbGV0IGdldENvbXB1dGVkU3R5bGVFbD13aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZShmaW5kRWwsbnVsbCk7XHJcbiAgICAgICAgICAgICAgICByZXN1bHQgPSBmaW5kRWwub2Zmc2V0V2lkdGgrcGFyc2VGbG9hdChnZXRDb21wdXRlZFN0eWxlRWwubWFyZ2luTGVmdCkrcGFyc2VGbG9hdChnZXRDb21wdXRlZFN0eWxlRWwubWFyZ2luUmlnaHQpO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICog5qC85byP5YyW5pWw5o2uXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgX2Zvcm1hdERhdGEoZGF0YXMsIGlkUHJlZml4OiBzdHJpbmcgPSBcInJlc3BvbnNlXCIpIHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBbXTtcclxuICAgICAgICBkYXRhcy5mb3JFYWNoKChpdGVtLCBpbmRleCkgPT4ge1xyXG4gICAgICAgICAgICBpZiAoaXRlbS5pc0RQKSB7XHJcbiAgICAgICAgICAgICAgICAvLyDlpoLmnpzmmK/kuIvmi4lcclxuICAgICAgICAgICAgICAgIGlmIChcclxuICAgICAgICAgICAgICAgICAgICBpdGVtLmhhc093blByb3BlcnR5KFwiY2hpbGRyZW5cIikgJiZcclxuICAgICAgICAgICAgICAgICAgICBpdGVtW1wiY2hpbGRyZW5cIl0ubGVuZ3RoXHJcbiAgICAgICAgICAgICAgICApIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBjaGlsZHJlbiA9IFtdLmNvbmNhdChpdGVtW1wiY2hpbGRyZW5cIl0pO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIGl0ZW0uY2hpbGRyZW4gPSBbXTsgLy8g5bqUZ3px6KaB5rGCMjAyMzA1MjlcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBkcEl0ZW0gPSBuZXcgUmVzcG9uc2VUb29sYmFyRHJvcERvd24oXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIE9iamVjdC5hc3NpZ24oeyBpZDogaWRQcmVmaXggKyBcIl9cIiArIGluZGV4IH0sIGl0ZW0pXHJcbiAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgICAgICByZXN1bHQucHVzaChkcEl0ZW0pO1xyXG4gICAgICAgICAgICAgICAgICAgIGRwSXRlbS5jaGlsZHJlbiA9IHRoaXMuX2Zvcm1hdERhdGEoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNoaWxkcmVuLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZFByZWZpeCArIFwiX1wiICsgaW5kZXhcclxuICAgICAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICByZXN1bHQucHVzaChcclxuICAgICAgICAgICAgICAgICAgICAgICAgbmV3IFJlc3BvbnNlVG9vbGJhckRyb3BEb3duKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgT2JqZWN0LmFzc2lnbih7IGlkOiBpZFByZWZpeCArIFwiX1wiICsgaW5kZXggfSwgaXRlbSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgKVxyXG4gICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAvLyDpnZ7kuIvmi4lcclxuICAgICAgICAgICAgICAgIHJlc3VsdC5wdXNoKFxyXG4gICAgICAgICAgICAgICAgICAgIG5ldyBSZXNwb25zZVRvb2xiYXJJdGVtKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBPYmplY3QuYXNzaWduKHsgaWQ6IGlkUHJlZml4ICsgXCJfXCIgKyBpbmRleCB9LCBpdGVtKVxyXG4gICAgICAgICAgICAgICAgICAgIClcclxuICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICog5om+5Yiw56ys5LiA5Liq5pyq5aSE55CG5a6M5ZON5bqU5byP55qE5YWD57SgXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgX2dldEZpcnN0VW5SZXNwb25zZWRJbmRleCgpIHtcclxuICAgICAgICBjb25zdCB0ZW1wVW5SZXNwb25zZWRJbmRleCA9IHRoaXMucmVzaXplR3JvdXBzLmZpbmRJbmRleChncm91cCA9PiB7XHJcbiAgICAgICAgICAgIGlmIChncm91cC5pc1Jlc3BvbnNlZCgpKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIHRlbXBVblJlc3BvbnNlZEluZGV4O1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiDlr7vmib7mnIDlkI7kuIDkuKrlpITnkIblk43lupTlvI/nmoTlhYPntKBcclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBfZ2V0TGFzdFJlc3BvbnNlSW5kZXgoKSB7XHJcbiAgICAgICAgY29uc3QgdGVtcFJlc3BvbnNpbmdJbmRleCA9IHRoaXMucmVzaXplR3JvdXBzLmZpbmRJbmRleChncm91cCA9PiB7XHJcbiAgICAgICAgICAgIGlmICghZ3JvdXAuaXNSZXNwb25zaW5nKCkpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9KTtcclxuICAgICAgICAvLyDmiYDmnInnu4TlhYPntKDpg73lt7LlpITnkIblrozlk43lupTlvI9cclxuICAgICAgICBpZiAodGVtcFJlc3BvbnNpbmdJbmRleCA9PT0gLTEpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMucmVzaXplR3JvdXBzLmxlbmd0aCAtIDE7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIOaJgOaciee7hOWFg+e0oOmDveacquW8gOWni+WkhOeQhuWTjeW6lOW8j1xyXG4gICAgICAgIHJldHVybiB0ZW1wUmVzcG9uc2luZ0luZGV4ID4gMSA/IHRlbXBSZXNwb25zaW5nSW5kZXggLSAxIDogLTE7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIOaJvuWIsGdyb3Vw5b2i5oiQ55qE5LiL5ouJ77yM5Zyo5pWw5o2u5Lit55qE5L2N572uXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgX2ZpbmRJbmRleEJ5SUQoXHJcbiAgICAgICAgZGF0YXM6IEFycmF5PFJlc3BvbnNlVG9vbGJhckl0ZW0gfCBSZXNwb25zZVRvb2xiYXJEcm9wRG93bj4sXHJcbiAgICAgICAgaWQ6IHN0cmluZ1xyXG4gICAgKTogYW55IHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBkYXRhcy5maW5kSW5kZXgoKGl0ZW0sIGluZGV4KSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChpdGVtW1wiaWRcIl0gPT09IGlkKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICog5qC55o2uSUTlr7vmib5JdGVtXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgX2ZpbmRJdGVtQnlJRChcclxuICAgICAgICBpZDogc3RyaW5nLFxyXG4gICAgICAgIGRhdGE6IEFycmF5PFJlc3BvbnNlVG9vbGJhckRyb3BEb3duIHwgUmVzcG9uc2VUb29sYmFySXRlbT5cclxuICAgICk6IFJlc3BvbnNlVG9vbGJhckRyb3BEb3duIHwgUmVzcG9uc2VUb29sYmFySXRlbSB7XHJcbiAgICAgICAgbGV0IHRlbXBSZXN1bHQgPSBudWxsO1xyXG4gICAgICAgIGNvbnN0IHRlbXBJbmRleCA9IGRhdGEuZmluZEluZGV4KChpdGVtLCBpbmRleCkgPT4ge1xyXG4gICAgICAgICAgICBpZiAoaXRlbVtcImlkXCJdID09PSBpZCkge1xyXG4gICAgICAgICAgICAgICAgdGVtcFJlc3VsdCA9IGl0ZW07XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvLyDlpoLmnpzmmK/kuIvmi4nvvIzlsYLnuqfkuIvmi4lcclxuICAgICAgICAgICAgaWYgKGl0ZW1bXCJpc0RQXCJdKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ZW1wSXRlbSA9IHRoaXMuX2ZpbmRJdGVtQnlJRChpZCwgaXRlbVtcImNoaWxkcmVuXCJdKTtcclxuICAgICAgICAgICAgICAgIGlmICh0ZW1wSXRlbSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRlbXBSZXN1bHQgPSB0ZW1wSXRlbTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIHRlbXBSZXN1bHQ7XHJcbiAgICB9XHJcbn1cclxuIl19