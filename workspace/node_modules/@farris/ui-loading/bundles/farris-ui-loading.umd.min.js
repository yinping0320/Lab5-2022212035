!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("rxjs/operators"),require("rxjs"),require("lodash-es"),require("@angular/core"),require("@angular/common"),require("@farris/ui-common"),require("@farris/ui-locale")):"function"==typeof define&&define.amd?define("@farris/ui-loading",["exports","rxjs/operators","rxjs","lodash-es","@angular/core","@angular/common","@farris/ui-common","@farris/ui-locale"],t):t((e.farris=e.farris||{},e.farris["ui-loading"]={}),e.rxjs.operators,e.rxjs,e.lodashEs,e.ng.core,e.ng.common,e.uiCommon,e.uiLocale)}(this,function(e,n,i,t,r,o,a,s){"use strict";var l={width:30,container:"body",message:"正在加载中，请稍候...",posion:"center",type:0,delay:300},c=new r.InjectionToken("loading default options."),d=['<div class="f-loading-round"></div>','<div class="f-loading-dot-wrapper">\n    <div class="f-loading-dot">\n        <div class="dot dot1"></div>\n        <div class="dot dot2"></div>\n        <div class="dot dot3"></div>\n        <div class="dot dot4"></div>\n    </div>\n</div>','<svg width="100%" height="100%" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" preserveAspectRatio="xMidYMid" class="lds-coffee"><defs><linearGradient id="gradient" x1="0%" x2="0%" y1="0%" y2="100%"><stop offset="10%" stop-color="black" stop-opacity="0"></stop><stop offset="100%" stop-color="white" stop-opacity="1"></stop></linearGradient><mask id="mask" maskUnits="userSpaceOnUse" x="0" y="0" width="100" height="100"><rect x="22" y="8" width="56" height="54" fill="url(#gradient)"></rect></mask><path id="steam" d="M0-4c-2.1,2.6-2.1,6.4,0,9l0,0c2.1,2.6,2.1,6.4,0,9l0,0c-2.1,2.6-2.1,6.4,0,9l0,0c2.1,2.6,2.1,6.4,0,9l0,0 c-2.1,2.6-2.1,6.4,0,9l0,0c2.1,2.6,2.1,6.4,0,9c-2.1,2.6-2.1,6.4,0,9l0,0c2.1,2.6,2.1,6.4,0,9l0,0c-2.1,2.6-2.1,6.4,0,9l0,0 c2.1,2.6,2.1,6.4,0,9l0,0c-2.1,2.6-2.1,6.4,0,9l0,0c2.1,2.6,2.1,6.4,0,9c-2.1,2.6-2.1,6.4,0,9l0,0c2.1,2.6,2.1,6.4,0,9l0,0 c-2.1,2.6-2.1,6.4,0,9h0c2.1,2.6,2.1,6.4,0,9h0c-2.1,2.6-2.1,6.4,0,9h0c2.1,2.6,2.1,6.4,0,9" stroke-width="6" stroke-linecap="round" fill="#f00" stroke="#58a8f6"></path></defs><g mask="url(#mask)"><use x="29" y="1.00876" href="#steam"><animate attributeName="y" calcMode="linear" values="4;-14" keyTimes="0;1" dur="0.5" begin="0s" repeatCount="indefinite"></animate></use><use x="47" y="-5.98248" href="#steam"><animate attributeName="y" calcMode="linear" values="0;-18" keyTimes="0;1" dur="0.25" begin="0s" repeatCount="indefinite"></animate></use><use x="64" y="-8.48686" href="#steam"><animate attributeName="y" calcMode="linear" values="-4;-22" keyTimes="0;1" dur="0.3333333333333333" begin="0s" repeatCount="indefinite"></animate></use></g><path d="M81.2,52.5l-5.2,0V49c0-1.6-1.3-3-3-3H20c-1.6,0-3,1.3-3,3v11.6C17,71.3,25.7,80,36.5,80h20.1 c7.1,0,13.3-3.8,16.7-9.5h8.3c5.2,0,9.3-4.4,9-9.6C90.2,56.1,86,52.5,81.2,52.5z M81.5,67.5h-6.8c0.8-2.2,1.3-4.5,1.3-7v-5h5.5 c3.3,0,6,2.7,6,6S84.8,67.5,81.5,67.5z" fill="#58a8f6"></path><path d="M78.8,88H19.2c-1.1,0-2-0.9-2-2s0.9-2,2-2h59.5c1.1,0,2,0.9,2,2S79.9,88,78.8,88z" fill="rgba(80.78431372549018%,94.50980392156862%,72.15686274509802%,0)"></path></svg>'],h=(Object.defineProperty(u.prototype,"isActive",{get:function(){return this._isActive},set:function(e){this._isActive=e,this.activeSubject&&this.activeSubject.next(e)},enumerable:!0,configurable:!0}),u.prototype.ngOnInit=function(){var t=this;this.activedSubscrition=this.activeSubject.pipe(n.takeUntil(this.destroy$)).pipe(n.filter(function(e){return e}),n.delay(this.delay)).subscribe(function(e){e&&t.isActive&&(t.render.setStyle(t.loadingBackdrop.nativeElement,"display","block"),t.render.setStyle(t.loadingContainerEl.nativeElement,"left",0),t.setPosition(),t.render.removeStyle(t.loadingContainerEl.nativeElement,"visibility"),t.render.removeStyle(t.loadingContainerEl.nativeElement,"left"))})},u.prototype.ngAfterViewInit=function(){},u.prototype.ngOnDestroy=function(){this.destroy$.next(),this.destroy$.complete(),this.commonUtils=null},u.prototype.close=function(){this.loadingBackdrop&&this.loadingBackdrop.nativeElement.remove(),this.isActive=!1,this.render.removeAttribute(this.el.nativeElement,"class"),this.closed.emit(this.isActive)},u.prototype.setPosition=function(){this.commonUtils||(this.commonUtils=new a.CommonUtils);var e=this.loadingContainerEl.nativeElement.clientWidth,t=this.loadingContainerEl.nativeElement.clientHeight;this.render.setStyle(this.loadingContainerEl.nativeElement,"marginTop",-t/2+"px");var n=-e/2+"px";this.parentContainer&&this.parentContainer.clientWidth<=200&&(n="-100px"),this.render.setStyle(this.loadingContainerEl.nativeElement,"marginLeft",n);var i=this.commonUtils.getFloatingLayerIndex();this.render.setStyle(this.loadingBackdrop.nativeElement,"zIndex",i),this.render.setStyle(this.loadingContainerEl.nativeElement,"zIndex",i+1)},u.prototype.animate=function(e){this.addAnimationEndEvent("webkitAnimationEnd","mozAnimationEnd","MSAnimationEnd","oanimationend","animationend"),this.render.setAttribute(this.el.nativeElement,"class",e)},u.prototype.addAnimationEndEvent=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=this;e.forEach(function(e){n.el.nativeElement.addEventListener(e,function t(){n.el.nativeElement.removeEventListener(e,t),["fadeIn","fadeOut","animated","animated-0.5"].forEach(function(e){n.render.removeClass(n.el.nativeElement,e)}),n.closed.emit(n.isActive)})})},u.prototype.closeWhenClick5=function(e){var t=this;e.stopPropagation(),this.debugSer.isDebug&&this.commonUtils.clickContinuity(function(){t.close()})},u.decorators=[{type:r.Component,args:[{selector:"farris-loading",template:'\n        <div #loadingBackdrop class="farris-loading-backdrop loading-wait" (click)="closeWhenClick5($event)"></div>\n        <div #loadingContainerEl class="farris-loading" style="visibility: hidden">\n            <div class="ng-busy-default-wrapper">\n                <div class="ng-busy-default-sign" >\n                    <div [style.width]="width+ \'px\'" [style.height]="width+\'px\'" style="display: inline-block;margin:4px;"\n                                [innerHTML]="loadingStyleDom[type] | safe: \'html\'"></div>\n                    <div class="ng-busy-default-text" style="margin-left:0;"\n                                 *ngIf="showMessage" [innerHTML]="\'loading.message\' | locale: \'\' :message | safe: \'html\'"></div>\n                </div>\n            </div>\n        </div>\n    ',styles:[".loading-wait {\n            cursor: wait\n        }\n        .animated-0.5 {\n            -webkit-animation-duration: 0s;\n            animation-duration: 0s;\n        }\n        "]}]}],u.ctorParameters=function(){return[{type:r.Renderer2},{type:r.ElementRef}]},u.propDecorators={showMessage:[{type:r.Input}],loadingContainerEl:[{type:r.ViewChild,args:["loadingContainerEl"]}],loadingBackdrop:[{type:r.ViewChild,args:["loadingBackdrop"]}],closed:[{type:r.Output}]},u);function u(e,t){this.render=e,this.el=t,this.showMessage=!0,this.loadingStyleDom=d,this._isActive=!1,this.activeSubject=new i.BehaviorSubject(!1),this.message="",this.width=30,this.type=0,this.delay=300,this.closed=new r.EventEmitter,this.activedSubscrition=null,this.parentContainer=null,this.destroy$=new i.Subject,this.debugSer=null,this.commonUtils=null,this.debugSer||(this.debugSer=new a.DebugService),this.debugSer.useDebugMode&&this.debugSer.useDebugMode()}var g=(p.prototype.show=function(e){var t,n=this;this.config=this.injecotr.get(c)||{},this.config=Object.assign(l,this.config);var i=this.cfr.resolveComponentFactory(h);t=i.create(this.injecotr),e&&(this.config=Object.assign({},this.config,e)),this.localeSer&&(this.config.message&&"正在加载中，请稍候..."!==this.config.message||(this.config.message=this.localeSer.getValue("loading.message")));var o=this.config.container,a=null;"body"===o?document.querySelector(o).appendChild(t.location.nativeElement):o instanceof r.ElementRef?(o.nativeElement.appendChild(t.location.nativeElement),a=o.nativeElement):o instanceof Element&&(o.appendChild(t.location.nativeElement),a=o),t.instance.delay=this.config.delay,t.instance.isActive=!0,t.instance.parentContainer=a,Object.assign(t.instance,this.config),t.instance.closed.subscribe(function(e){e||(delete n.loadingInstances[t.instance.id],n.currentLoadingInstanceID=n.getMaxLoadingID(),n.clearDom(t))}),t.changeDetectorRef.markForCheck(),t.changeDetectorRef.detectChanges();var s=this.createInsId();return t.instance.id=s,this.loadingInstances[s]=t,this.currentLoadingInstanceID=s,t.instance},p.prototype.close=function(e){var t=e||this.currentLoadingInstanceID,n=this.loadingInstances[t];n&&n.instance.close()},p.prototype.clearAll=function(){var t=this,e=Object.keys(this.loadingInstances);if(e.length)e.forEach(function(e){t.clearDom(t.loadingInstances[e])});else{var n=document.querySelectorAll("farris-loading");n.length&&n.forEach(function(e){return e.remove()}),this.loadingInstances={}}},p.prototype.clearDom=function(e){if(e&&e.location){var t=e.location.nativeElement;t.parentNode&&t.parentNode.removeChild(t),e.destroy()}e=null},p.prototype.createInsId=function(){return this.getMaxLoadingID()+1},p.prototype.getMaxLoadingID=function(){var e=Object.keys(this.loadingInstances).map(function(e){return parseInt(e,10)});return e.length?t.max(e):0},p.decorators=[{type:r.Injectable}],p.ctorParameters=function(){return[{type:r.ApplicationRef},{type:r.ComponentFactoryResolver},{type:r.Injector}]},p);function p(e,t,n){this.appRef=e,this.cfr=t,this.injecotr=n,this.currentLoadingInstanceID=null,this.loadingInstances={},this.localeSer=this.injecotr.get(s.LocaleService)}var m=(f.forRoot=function(e){return{ngModule:f,providers:[{provide:c,useValue:e||l},g]}},f.decorators=[{type:r.NgModule,args:[{imports:[o.CommonModule,a.FarrisCommonModule,s.LocaleModule],declarations:[h],entryComponents:[h]}]}],f);function f(){}e.loaddingDefaultConfig=l,e.LOADING_DEFAULT_CONFIG=c,e.LoadingComponent=h,e.LoadingService=g,e.LoadingModule=m,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=farris-ui-loading.umd.min.js.map