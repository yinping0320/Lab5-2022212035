/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { FarrisContextMenuService } from './context-menu.service';
import { Component, Injector, Input, NgZone, Renderer2, ViewEncapsulation, ElementRef, ViewChild, ChangeDetectorRef, Optional, QueryList, ViewChildren } from '@angular/core';
export class FarrisContextMenuComponent {
    /**
     * @param {?} injector
     * @param {?} ngzone
     * @param {?} render
     * @param {?} ctxMenuSer
     * @param {?} elRef
     * @param {?} cd
     */
    constructor(injector, ngzone, render, ctxMenuSer, elRef, cd) {
        this.injector = injector;
        this.ngzone = ngzone;
        this.render = render;
        this.ctxMenuSer = ctxMenuSer;
        this.elRef = elRef;
        this.cd = cd;
    }
    /**
     * @return {?}
     */
    ngOnInit() {
    }
    /**
     * @param {?} changes
     * @return {?}
     */
    ngOnChanges(changes) {
    }
    /**
     * @param {?} $event
     * @param {?} item
     * @return {?}
     */
    onMenuItemClick($event, item) {
        $event.stopPropagation();
        if (item.disable) {
            return;
        }
        if (item.children && item.children.length) {
            return;
        }
        this.ctxMenuSer.hide();
        if (item.handle) {
            item.handle(Object.assign({}, (this.context || {}), { instance: this, menu: item }));
        }
    }
    /**
     * @param {?} $event
     * @param {?} item
     * @return {?}
     */
    onMouseEnter($event, item) {
        if (item.children && item.children.length) {
            /** @type {?} */
            const childCtxMenu = this.subMenus.find((/**
             * @param {?} m
             * @return {?}
             */
            m => m.elRef.nativeElement.id === item.id + '_submenu'));
            if (childCtxMenu) {
                // childCtxMenu.context = this.context;
                childCtxMenu.parent = this;
                /** @type {?} */
                const childMenuPanel = childCtxMenu.menuPanel.nativeElement;
                /** @type {?} */
                const panel = this.menuPanel.nativeElement;
                /** @type {?} */
                const childContainerWidth = window.innerWidth - panel.offsetLeft - panel.offsetWidth;
                if (childMenuPanel.offsetWidth > childContainerWidth) {
                    /** @type {?} */
                    const l = -panel.offsetWidth;
                    childMenuPanel.style.left = l + 'px';
                }
                /** @type {?} */
                const childContainerHeight = window.innerHeight - childMenuPanel.getBoundingClientRect().top;
                if (childContainerHeight < childMenuPanel.offsetHeight) {
                    /** @type {?} */
                    const t = window.innerHeight - panel.offsetTop - childMenuPanel.offsetHeight - 10;
                    childMenuPanel.style.top = t + 'px';
                }
            }
        }
    }
}
FarrisContextMenuComponent.decorators = [
    { type: Component, args: [{
                selector: 'farris-menus',
                template: "\r\n<div class=\"f-context-menu-panel\" tabindex=\"0\" [style.left.px]=\"left\" [style.top.px]=\"top\" #menuPanel style=\"pointer-events: auto\">\r\n\r\n    <ul class=\"menu-list\">\r\n        <li class=\"menu-item d-flex\" *ngFor=\"let item of menuItems; index as i;last as islast;first as isfirst\" (click)=\"onMenuItemClick($event, item)\" \r\n        [class.menu-sep]=\"item === '-'\" (mouseenter)=\"onMouseEnter($event, item)\"\r\n        [class.disabled]=\"item.disable\" #menuitemli>\r\n            <ng-container *ngIf=\"item !== '-' \">\r\n                <div class=\"menu-item-icon\">\r\n                    <span class=\"f-icon {{ item.icon }}\" *ngIf=\"item.icon\"></span>\r\n                </div>\r\n                <div class=\"menu-item-text f-utils-fill d-flex\">\r\n                    <span style=\"display: block\" class=\"f-utils-fill\">{{ item.title }}</span>\r\n                    <span class=\"arrow-right\" *ngIf=\"item.children && item.children.length\">\r\n                        <span class=\"f-icon f-icon-arrow-e\"></span>\r\n                    </span>\r\n                </div>\r\n                <farris-menus #childMenu [context]=\"context\" [attr.id]=\"item.id+ '_submenu'\" *ngIf=\"item.children && item.children.length\" [menuItems]=\"item.children\"\r\n                    [top]=\"menuitemli.offsetTop - 3\" [left]=\"menuPanel.offsetWidth - 5\"\r\n                ></farris-menus>\r\n            </ng-container>\r\n        </li>\r\n    </ul>\r\n\r\n</div>\r\n",
                encapsulation: ViewEncapsulation.None,
                exportAs: 'contextMenuRef',
                styles: [`
    .f-context-menu-overlay {
        position: fixed;
        z-index: 9999;
        top: 0;
        left: 0;
        height: 100%;
        width: 100%;
    }
    .f-context-menu-panel {
        position: absolute;
        top: 200px;
        left: 300px;
        background: #fff;
        border: 1px solid #c6c6c6;
        border-radius: 5px;
        box-shadow: 3px 3px 5px #b8b4b4;
        padding: 3px 0px;
        min-width: 180px;
        max-width: 290px;
    }

    .f-context-menu-panel .menu-list {
        list-style: none;
    }

    .f-context-menu-panel .menu-item {
        height: 28px;
        line-height: 28px;
        cursor: pointer;
    }

    .f-context-menu-panel .menu-item.disabled {
        opacity: 0.4;
        cursor: default;
    }

    .f-context-menu-panel .menu-item.menu-sep{
        height: 6px;
        border-top: 1px solid #ccc;
        border-bottom: 1px solid #fff;
        margin-top: 5px;
    }

    .f-context-menu-panel .menu-item.active,
    .f-context-menu-panel .menu-item:hover:not(.menu-sep) {
        background: #e4e7ef;
    }
    .f-context-menu-panel .menu-item .f-context-menu-panel  {
        display: none;
    }

    .f-context-menu-panel .menu-item:hover  .f-context-menu-panel {
        display: block;
    }

    .f-context-menu-panel .menu-item-icon {
        width: 40px;
        text-align: center;
        font-size: 18px;
    }

    .f-context-target-focus {
        position: relative;
        top: 100px;
        left: 0;
        border: 1px dashed;
        height: 29px;
        display: none;
        background: #a1c8fb;
        opacity: 0.2;
    }

    .f-context-menu-panel .menu-item-text .arrow-right {
        width: 32px; height: 100%;display:block; text-align: center;
    }
        `]
            }] }
];
/** @nocollapse */
FarrisContextMenuComponent.ctorParameters = () => [
    { type: Injector },
    { type: NgZone },
    { type: Renderer2 },
    { type: FarrisContextMenuService, decorators: [{ type: Optional }] },
    { type: ElementRef },
    { type: ChangeDetectorRef }
];
FarrisContextMenuComponent.propDecorators = {
    menuItems: [{ type: Input }],
    left: [{ type: Input }],
    top: [{ type: Input }],
    context: [{ type: Input }],
    menuPanel: [{ type: ViewChild, args: ['menuPanel',] }],
    subMenus: [{ type: ViewChildren, args: [FarrisContextMenuComponent,] }]
};
if (false) {
    /** @type {?} */
    FarrisContextMenuComponent.prototype.menuItems;
    /** @type {?} */
    FarrisContextMenuComponent.prototype.left;
    /** @type {?} */
    FarrisContextMenuComponent.prototype.top;
    /** @type {?} */
    FarrisContextMenuComponent.prototype.context;
    /** @type {?} */
    FarrisContextMenuComponent.prototype.menuPanel;
    /** @type {?} */
    FarrisContextMenuComponent.prototype.subMenus;
    /** @type {?} */
    FarrisContextMenuComponent.prototype.parent;
    /** @type {?} */
    FarrisContextMenuComponent.prototype.id;
    /**
     * @type {?}
     * @private
     */
    FarrisContextMenuComponent.prototype.injector;
    /**
     * @type {?}
     * @private
     */
    FarrisContextMenuComponent.prototype.ngzone;
    /**
     * @type {?}
     * @private
     */
    FarrisContextMenuComponent.prototype.render;
    /**
     * @type {?}
     * @private
     */
    FarrisContextMenuComponent.prototype.ctxMenuSer;
    /**
     * @type {?}
     * @private
     */
    FarrisContextMenuComponent.prototype.elRef;
    /** @type {?} */
    FarrisContextMenuComponent.prototype.cd;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29udGV4dC1tZW51LmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BmYXJyaXMvdWktY29udGV4dC1tZW51LyIsInNvdXJjZXMiOlsibGliL2NvbnRleHQtbWVudS5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUFBLE9BQU8sRUFBRSx3QkFBd0IsRUFBRSxNQUFNLHdCQUF3QixDQUFDO0FBQ2xFLE9BQU8sRUFBRSxTQUFTLEVBQUUsUUFBUSxFQUFFLEtBQUssRUFBRSxNQUFNLEVBQVUsU0FBUyxFQUN0RCxpQkFBaUIsRUFBRSxVQUFVLEVBQUUsU0FBUyxFQUFFLGlCQUFpQixFQUFpQixRQUFRLEVBQUUsU0FBUyxFQUFFLFlBQVksRUFBRSxNQUFNLGVBQWUsQ0FBQztBQXdGN0ksTUFBTSxPQUFPLDBCQUEwQjs7Ozs7Ozs7O0lBaUJuQyxZQUFvQixRQUFrQixFQUNsQixNQUFjLEVBQ2QsTUFBaUIsRUFDTCxVQUFvQyxFQUNoRCxLQUFpQixFQUNsQixFQUFxQjtRQUxwQixhQUFRLEdBQVIsUUFBUSxDQUFVO1FBQ2xCLFdBQU0sR0FBTixNQUFNLENBQVE7UUFDZCxXQUFNLEdBQU4sTUFBTSxDQUFXO1FBQ0wsZUFBVSxHQUFWLFVBQVUsQ0FBMEI7UUFDaEQsVUFBSyxHQUFMLEtBQUssQ0FBWTtRQUNsQixPQUFFLEdBQUYsRUFBRSxDQUFtQjtJQUFJLENBQUM7Ozs7SUFFN0MsUUFBUTtJQUVSLENBQUM7Ozs7O0lBRUQsV0FBVyxDQUFDLE9BQXNCO0lBQ2xDLENBQUM7Ozs7OztJQUVELGVBQWUsQ0FBQyxNQUFrQixFQUFFLElBQXFCO1FBQ3JELE1BQU0sQ0FBQyxlQUFlLEVBQUUsQ0FBQztRQUV6QixJQUFJLElBQUksQ0FBQyxPQUFPLEVBQUU7WUFDZCxPQUFPO1NBQ1Y7UUFFRCxJQUFJLElBQUksQ0FBQyxRQUFRLElBQUksSUFBSSxDQUFDLFFBQVEsQ0FBQyxNQUFNLEVBQUU7WUFDdkMsT0FBTztTQUNWO1FBRUQsSUFBSSxDQUFDLFVBQVUsQ0FBQyxJQUFJLEVBQUUsQ0FBQztRQUV2QixJQUFJLElBQUksQ0FBQyxNQUFNLEVBQUU7WUFDYixJQUFJLENBQUMsTUFBTSxtQkFBTSxDQUFDLElBQUksQ0FBQyxPQUFPLElBQUksRUFBRSxDQUFDLElBQUUsUUFBUSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxJQUFHLENBQUM7U0FDeEU7SUFFTCxDQUFDOzs7Ozs7SUFFRCxZQUFZLENBQUMsTUFBTSxFQUFFLElBQUk7UUFDckIsSUFBSSxJQUFJLENBQUMsUUFBUSxJQUFJLElBQUksQ0FBQyxRQUFRLENBQUMsTUFBTSxFQUFHOztrQkFDbEMsWUFBWSxHQUFHLElBQUksQ0FBQyxRQUFRLENBQUMsSUFBSTs7OztZQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxhQUFhLENBQUMsRUFBRSxLQUFLLElBQUksQ0FBQyxFQUFFLEdBQUcsVUFBVSxFQUFDO1lBQy9GLElBQUksWUFBWSxFQUFFO2dCQUNkLHVDQUF1QztnQkFDdkMsWUFBWSxDQUFDLE1BQU0sR0FBRyxJQUFJLENBQUM7O3NCQUVyQixjQUFjLEdBQUcsWUFBWSxDQUFDLFNBQVMsQ0FBQyxhQUFhOztzQkFDckQsS0FBSyxHQUFHLElBQUksQ0FBQyxTQUFTLENBQUMsYUFBYTs7c0JBQ3BDLG1CQUFtQixHQUFHLE1BQU0sQ0FBQyxVQUFVLEdBQUcsS0FBSyxDQUFDLFVBQVUsR0FBRyxLQUFLLENBQUMsV0FBVztnQkFDcEYsSUFBSSxjQUFjLENBQUMsV0FBVyxHQUFHLG1CQUFtQixFQUFFOzswQkFDNUMsQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDLFdBQVc7b0JBQzVCLGNBQWMsQ0FBQyxLQUFLLENBQUMsSUFBSSxHQUFHLENBQUMsR0FBRyxJQUFJLENBQUM7aUJBQ3hDOztzQkFFSyxvQkFBb0IsR0FBRyxNQUFNLENBQUMsV0FBVyxHQUFHLGNBQWMsQ0FBQyxxQkFBcUIsRUFBRSxDQUFDLEdBQUc7Z0JBQzVGLElBQUksb0JBQW9CLEdBQUcsY0FBYyxDQUFDLFlBQVksRUFBRTs7MEJBQzlDLENBQUMsR0FBRyxNQUFNLENBQUMsV0FBVyxHQUFHLEtBQUssQ0FBQyxTQUFTLEdBQUcsY0FBYyxDQUFDLFlBQVksR0FBRyxFQUFFO29CQUNqRixjQUFjLENBQUMsS0FBSyxDQUFDLEdBQUcsR0FBRyxDQUFDLEdBQUcsSUFBSSxDQUFDO2lCQUN2QzthQUNKO1NBRUo7SUFDTCxDQUFDOzs7WUE5SkosU0FBUyxTQUFDO2dCQUNQLFFBQVEsRUFBRSxjQUFjO2dCQUN4Qix1K0NBQTRDO2dCQUM1QyxhQUFhLEVBQUUsaUJBQWlCLENBQUMsSUFBSTtnQkFDckMsUUFBUSxFQUFFLGdCQUFnQjt5QkFFbEI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7U0E0RUg7YUFFUjs7OztZQXhGbUIsUUFBUTtZQUFTLE1BQU07WUFBVSxTQUFTO1lBRHJELHdCQUF3Qix1QkE4R2hCLFFBQVE7WUE1R0UsVUFBVTtZQUFhLGlCQUFpQjs7O3dCQTBGOUQsS0FBSzttQkFDTCxLQUFLO2tCQUNMLEtBQUs7c0JBRUwsS0FBSzt3QkFFTCxTQUFTLFNBQUMsV0FBVzt1QkFFckIsWUFBWSxTQUFDLDBCQUEwQjs7OztJQVJ4QywrQ0FBc0M7O0lBQ3RDLDBDQUFzQjs7SUFDdEIseUNBQXFCOztJQUVyQiw2Q0FBc0I7O0lBRXRCLCtDQUE4Qzs7SUFFOUMsOENBQTBGOztJQUUxRiw0Q0FBbUM7O0lBQ25DLHdDQUFXOzs7OztJQUlDLDhDQUEwQjs7Ozs7SUFDMUIsNENBQXNCOzs7OztJQUN0Qiw0Q0FBeUI7Ozs7O0lBQ3pCLGdEQUF3RDs7Ozs7SUFDeEQsMkNBQXlCOztJQUN6Qix3Q0FBNEIiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBGYXJyaXNDb250ZXh0TWVudVNlcnZpY2UgfSBmcm9tICcuL2NvbnRleHQtbWVudS5zZXJ2aWNlJztcclxuaW1wb3J0IHsgQ29tcG9uZW50LCBJbmplY3RvciwgSW5wdXQsIE5nWm9uZSwgT25Jbml0LCBSZW5kZXJlcjIsIE9uQ2hhbmdlcyxcclxuICAgICAgICBWaWV3RW5jYXBzdWxhdGlvbiwgRWxlbWVudFJlZiwgVmlld0NoaWxkLCBDaGFuZ2VEZXRlY3RvclJlZiwgU2ltcGxlQ2hhbmdlcywgT3B0aW9uYWwsIFF1ZXJ5TGlzdCwgVmlld0NoaWxkcmVuIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IENvbnRleHRNZW51SXRlbSB9IGZyb20gJy4vbWVudS1pdGVtLmludGVyZmFjZSc7XHJcblxyXG5AQ29tcG9uZW50KHtcclxuICAgIHNlbGVjdG9yOiAnZmFycmlzLW1lbnVzJyxcclxuICAgIHRlbXBsYXRlVXJsOiAnLi9jb250ZXh0LW1lbnUuY29tcG9uZW50Lmh0bWwnLFxyXG4gICAgZW5jYXBzdWxhdGlvbjogVmlld0VuY2Fwc3VsYXRpb24uTm9uZSxcclxuICAgIGV4cG9ydEFzOiAnY29udGV4dE1lbnVSZWYnLFxyXG4gICAgc3R5bGVzOiBbXHJcbiAgICAgICAgICAgIGBcclxuICAgIC5mLWNvbnRleHQtbWVudS1vdmVybGF5IHtcclxuICAgICAgICBwb3NpdGlvbjogZml4ZWQ7XHJcbiAgICAgICAgei1pbmRleDogOTk5OTtcclxuICAgICAgICB0b3A6IDA7XHJcbiAgICAgICAgbGVmdDogMDtcclxuICAgICAgICBoZWlnaHQ6IDEwMCU7XHJcbiAgICAgICAgd2lkdGg6IDEwMCU7XHJcbiAgICB9XHJcbiAgICAuZi1jb250ZXh0LW1lbnUtcGFuZWwge1xyXG4gICAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTtcclxuICAgICAgICB0b3A6IDIwMHB4O1xyXG4gICAgICAgIGxlZnQ6IDMwMHB4O1xyXG4gICAgICAgIGJhY2tncm91bmQ6ICNmZmY7XHJcbiAgICAgICAgYm9yZGVyOiAxcHggc29saWQgI2M2YzZjNjtcclxuICAgICAgICBib3JkZXItcmFkaXVzOiA1cHg7XHJcbiAgICAgICAgYm94LXNoYWRvdzogM3B4IDNweCA1cHggI2I4YjRiNDtcclxuICAgICAgICBwYWRkaW5nOiAzcHggMHB4O1xyXG4gICAgICAgIG1pbi13aWR0aDogMTgwcHg7XHJcbiAgICAgICAgbWF4LXdpZHRoOiAyOTBweDtcclxuICAgIH1cclxuXHJcbiAgICAuZi1jb250ZXh0LW1lbnUtcGFuZWwgLm1lbnUtbGlzdCB7XHJcbiAgICAgICAgbGlzdC1zdHlsZTogbm9uZTtcclxuICAgIH1cclxuXHJcbiAgICAuZi1jb250ZXh0LW1lbnUtcGFuZWwgLm1lbnUtaXRlbSB7XHJcbiAgICAgICAgaGVpZ2h0OiAyOHB4O1xyXG4gICAgICAgIGxpbmUtaGVpZ2h0OiAyOHB4O1xyXG4gICAgICAgIGN1cnNvcjogcG9pbnRlcjtcclxuICAgIH1cclxuXHJcbiAgICAuZi1jb250ZXh0LW1lbnUtcGFuZWwgLm1lbnUtaXRlbS5kaXNhYmxlZCB7XHJcbiAgICAgICAgb3BhY2l0eTogMC40O1xyXG4gICAgICAgIGN1cnNvcjogZGVmYXVsdDtcclxuICAgIH1cclxuXHJcbiAgICAuZi1jb250ZXh0LW1lbnUtcGFuZWwgLm1lbnUtaXRlbS5tZW51LXNlcHtcclxuICAgICAgICBoZWlnaHQ6IDZweDtcclxuICAgICAgICBib3JkZXItdG9wOiAxcHggc29saWQgI2NjYztcclxuICAgICAgICBib3JkZXItYm90dG9tOiAxcHggc29saWQgI2ZmZjtcclxuICAgICAgICBtYXJnaW4tdG9wOiA1cHg7XHJcbiAgICB9XHJcblxyXG4gICAgLmYtY29udGV4dC1tZW51LXBhbmVsIC5tZW51LWl0ZW0uYWN0aXZlLFxyXG4gICAgLmYtY29udGV4dC1tZW51LXBhbmVsIC5tZW51LWl0ZW06aG92ZXI6bm90KC5tZW51LXNlcCkge1xyXG4gICAgICAgIGJhY2tncm91bmQ6ICNlNGU3ZWY7XHJcbiAgICB9XHJcbiAgICAuZi1jb250ZXh0LW1lbnUtcGFuZWwgLm1lbnUtaXRlbSAuZi1jb250ZXh0LW1lbnUtcGFuZWwgIHtcclxuICAgICAgICBkaXNwbGF5OiBub25lO1xyXG4gICAgfVxyXG5cclxuICAgIC5mLWNvbnRleHQtbWVudS1wYW5lbCAubWVudS1pdGVtOmhvdmVyICAuZi1jb250ZXh0LW1lbnUtcGFuZWwge1xyXG4gICAgICAgIGRpc3BsYXk6IGJsb2NrO1xyXG4gICAgfVxyXG5cclxuICAgIC5mLWNvbnRleHQtbWVudS1wYW5lbCAubWVudS1pdGVtLWljb24ge1xyXG4gICAgICAgIHdpZHRoOiA0MHB4O1xyXG4gICAgICAgIHRleHQtYWxpZ246IGNlbnRlcjtcclxuICAgICAgICBmb250LXNpemU6IDE4cHg7XHJcbiAgICB9XHJcblxyXG4gICAgLmYtY29udGV4dC10YXJnZXQtZm9jdXMge1xyXG4gICAgICAgIHBvc2l0aW9uOiByZWxhdGl2ZTtcclxuICAgICAgICB0b3A6IDEwMHB4O1xyXG4gICAgICAgIGxlZnQ6IDA7XHJcbiAgICAgICAgYm9yZGVyOiAxcHggZGFzaGVkO1xyXG4gICAgICAgIGhlaWdodDogMjlweDtcclxuICAgICAgICBkaXNwbGF5OiBub25lO1xyXG4gICAgICAgIGJhY2tncm91bmQ6ICNhMWM4ZmI7XHJcbiAgICAgICAgb3BhY2l0eTogMC4yO1xyXG4gICAgfVxyXG5cclxuICAgIC5mLWNvbnRleHQtbWVudS1wYW5lbCAubWVudS1pdGVtLXRleHQgLmFycm93LXJpZ2h0IHtcclxuICAgICAgICB3aWR0aDogMzJweDsgaGVpZ2h0OiAxMDAlO2Rpc3BsYXk6YmxvY2s7IHRleHQtYWxpZ246IGNlbnRlcjtcclxuICAgIH1cclxuICAgICAgICBgXHJcbiAgICBdXHJcbn0pXHJcbmV4cG9ydCBjbGFzcyBGYXJyaXNDb250ZXh0TWVudUNvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCwgT25DaGFuZ2VzIHtcclxuXHJcbiAgICBASW5wdXQoKSBtZW51SXRlbXM6IENvbnRleHRNZW51SXRlbVtdO1xyXG4gICAgQElucHV0KCkgbGVmdDogbnVtYmVyO1xyXG4gICAgQElucHV0KCkgdG9wOiBudW1iZXI7XHJcblxyXG4gICAgQElucHV0KCkgY29udGV4dDogYW55O1xyXG5cclxuICAgIEBWaWV3Q2hpbGQoJ21lbnVQYW5lbCcpIG1lbnVQYW5lbDogRWxlbWVudFJlZjtcclxuXHJcbiAgICBAVmlld0NoaWxkcmVuKEZhcnJpc0NvbnRleHRNZW51Q29tcG9uZW50KSBzdWJNZW51czogUXVlcnlMaXN0PEZhcnJpc0NvbnRleHRNZW51Q29tcG9uZW50PjtcclxuXHJcbiAgICBwYXJlbnQ6IEZhcnJpc0NvbnRleHRNZW51Q29tcG9uZW50O1xyXG4gICAgaWQ6IHN0cmluZztcclxuXHJcblxyXG5cclxuICAgIGNvbnN0cnVjdG9yKHByaXZhdGUgaW5qZWN0b3I6IEluamVjdG9yLFxyXG4gICAgICAgICAgICAgICAgcHJpdmF0ZSBuZ3pvbmU6IE5nWm9uZSxcclxuICAgICAgICAgICAgICAgIHByaXZhdGUgcmVuZGVyOiBSZW5kZXJlcjIsXHJcbiAgICAgICAgICAgICAgICBAT3B0aW9uYWwoKSBwcml2YXRlIGN0eE1lbnVTZXI6IEZhcnJpc0NvbnRleHRNZW51U2VydmljZSxcclxuICAgICAgICAgICAgICAgIHByaXZhdGUgZWxSZWY6IEVsZW1lbnRSZWYsXHJcbiAgICAgICAgICAgICAgICBwdWJsaWMgY2Q6IENoYW5nZURldGVjdG9yUmVmKSB7IH1cclxuXHJcbiAgICBuZ09uSW5pdCgpOiB2b2lkIHtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgbmdPbkNoYW5nZXMoY2hhbmdlczogU2ltcGxlQ2hhbmdlcykge1xyXG4gICAgfVxyXG5cclxuICAgIG9uTWVudUl0ZW1DbGljaygkZXZlbnQ6IE1vdXNlRXZlbnQsIGl0ZW06IENvbnRleHRNZW51SXRlbSkge1xyXG4gICAgICAgICRldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcclxuXHJcbiAgICAgICAgaWYgKGl0ZW0uZGlzYWJsZSkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoaXRlbS5jaGlsZHJlbiAmJiBpdGVtLmNoaWxkcmVuLmxlbmd0aCkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLmN0eE1lbnVTZXIuaGlkZSgpO1xyXG5cclxuICAgICAgICBpZiAoaXRlbS5oYW5kbGUpIHtcclxuICAgICAgICAgICAgaXRlbS5oYW5kbGUoeyAuLi4odGhpcy5jb250ZXh0IHx8IHt9KSwgaW5zdGFuY2U6IHRoaXMsIG1lbnU6IGl0ZW0gfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgIH1cclxuXHJcbiAgICBvbk1vdXNlRW50ZXIoJGV2ZW50LCBpdGVtKSB7XHJcbiAgICAgICAgaWYgKGl0ZW0uY2hpbGRyZW4gJiYgaXRlbS5jaGlsZHJlbi5sZW5ndGggKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGNoaWxkQ3R4TWVudSA9IHRoaXMuc3ViTWVudXMuZmluZChtID0+IG0uZWxSZWYubmF0aXZlRWxlbWVudC5pZCA9PT0gaXRlbS5pZCArICdfc3VibWVudScpO1xyXG4gICAgICAgICAgICBpZiAoY2hpbGRDdHhNZW51KSB7XHJcbiAgICAgICAgICAgICAgICAvLyBjaGlsZEN0eE1lbnUuY29udGV4dCA9IHRoaXMuY29udGV4dDtcclxuICAgICAgICAgICAgICAgIGNoaWxkQ3R4TWVudS5wYXJlbnQgPSB0aGlzO1xyXG5cclxuICAgICAgICAgICAgICAgIGNvbnN0IGNoaWxkTWVudVBhbmVsID0gY2hpbGRDdHhNZW51Lm1lbnVQYW5lbC5uYXRpdmVFbGVtZW50O1xyXG4gICAgICAgICAgICAgICAgY29uc3QgcGFuZWwgPSB0aGlzLm1lbnVQYW5lbC5uYXRpdmVFbGVtZW50O1xyXG4gICAgICAgICAgICAgICAgY29uc3QgY2hpbGRDb250YWluZXJXaWR0aCA9IHdpbmRvdy5pbm5lcldpZHRoIC0gcGFuZWwub2Zmc2V0TGVmdCAtIHBhbmVsLm9mZnNldFdpZHRoO1xyXG4gICAgICAgICAgICAgICAgaWYgKGNoaWxkTWVudVBhbmVsLm9mZnNldFdpZHRoID4gY2hpbGRDb250YWluZXJXaWR0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGwgPSAtcGFuZWwub2Zmc2V0V2lkdGg7XHJcbiAgICAgICAgICAgICAgICAgICAgY2hpbGRNZW51UGFuZWwuc3R5bGUubGVmdCA9IGwgKyAncHgnO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGNvbnN0IGNoaWxkQ29udGFpbmVySGVpZ2h0ID0gd2luZG93LmlubmVySGVpZ2h0IC0gY2hpbGRNZW51UGFuZWwuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkudG9wO1xyXG4gICAgICAgICAgICAgICAgaWYgKGNoaWxkQ29udGFpbmVySGVpZ2h0IDwgY2hpbGRNZW51UGFuZWwub2Zmc2V0SGVpZ2h0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdCA9IHdpbmRvdy5pbm5lckhlaWdodCAtIHBhbmVsLm9mZnNldFRvcCAtIGNoaWxkTWVudVBhbmVsLm9mZnNldEhlaWdodCAtIDEwO1xyXG4gICAgICAgICAgICAgICAgICAgIGNoaWxkTWVudVBhbmVsLnN0eWxlLnRvcCA9IHQgKyAncHgnO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG4iXX0=