{"version":3,"file":"farris-ui-context-menu.js","sources":["ng://@farris/ui-context-menu/lib/context-menu.service.ts","ng://@farris/ui-context-menu/lib/context-menu.component.ts","ng://@farris/ui-context-menu/lib/context-menu.directive.ts","ng://@farris/ui-context-menu/lib/context-menu.module.ts"],"sourcesContent":["import { Subject } from 'rxjs';\r\nimport { FarrisContextMenuComponent } from './context-menu.component';\r\nimport { Injectable, ComponentFactoryResolver, Injector, ComponentRef } from '@angular/core';\r\nimport { ContextMenuOptions } from './menu-item.interface';\r\nimport { OverLayHiddenService } from '@farris/ui-common';\r\n\r\n@Injectable()\r\nexport class FarrisContextMenuService {\r\n\r\n    private overlayEle = null;\r\n    public contextMenuDom = null;\r\n    private contextMenuRefs: { [key: string]: ComponentRef<FarrisContextMenuComponent> } = {};\r\n\r\n    private activeDom = null;\r\n\r\n    showContextMenu = new Subject();\r\n    private overlayHideSer: OverLayHiddenService;\r\n    constructor(private cfr: ComponentFactoryResolver, private injector: Injector) {\r\n        this.overlayHideSer = this.injector.get(OverLayHiddenService, null);\r\n        if (!this.overlayHideSer) {\r\n            this.overlayHideSer = new OverLayHiddenService();\r\n        }\r\n    }\r\n\r\n\r\n\r\n    private createOverlay(cls?: string, opts?: ContextMenuOptions) {\r\n        let overlayEle: any = document.querySelector('.f-context-menu-overlay');\r\n        if (!overlayEle) {\r\n            overlayEle = document.createElement('div');\r\n            overlayEle.classList.add('f-context-menu-overlay', cls);\r\n\r\n            overlayEle.style.pointerEvents = 'none';\r\n\r\n            document.body.appendChild(overlayEle);\r\n\r\n            if (opts.highlight) {\r\n                this.activeDom = document.createElement('div');\r\n                this.activeDom.classList.add('f-context-target-focus');\r\n                overlayEle.appendChild(this.activeDom);\r\n            }\r\n\r\n            overlayEle.addEventListener('click', (e) => {\r\n                if ((e.target as any).className.indexOf('f-context-menu-overlay') > -1) {\r\n                    this.hide();\r\n                }\r\n            });\r\n\r\n            overlayEle.addEventListener('contextmenu', (e) => {\r\n                e.preventDefault();\r\n                e.stopPropagation();\r\n                this.hide();\r\n            });\r\n        }\r\n        return overlayEle;\r\n    }\r\n\r\n    show(options: ContextMenuOptions) {\r\n\r\n        const { menuItems, event, id, activeDom, context, menuClass, target, activeWidth } = options;\r\n        let cmpRef = null;\r\n\r\n        if (!this.contextMenuRefs) {\r\n            this.contextMenuRefs = {};\r\n        }\r\n\r\n        if (!this.contextMenuRefs[id]) {\r\n            const cmpFactory = this.cfr.resolveComponentFactory(FarrisContextMenuComponent);\r\n            cmpRef = cmpFactory.create(this.injector);\r\n            cmpRef.instance.menuItems = menuItems;\r\n            cmpRef.instance.id = id;\r\n\r\n            cmpRef.instance.left = event.pageX;\r\n            cmpRef.instance.top = event.pageY;\r\n\r\n            this.contextMenuDom = activeDom;\r\n            this.contextMenuRefs[cmpRef.instance.id] = cmpRef;\r\n        } else {\r\n            cmpRef = this.contextMenuRefs[id];\r\n        }\r\n\r\n        cmpRef.instance.context = context;\r\n\r\n        this.overlayEle = this.createOverlay(menuClass, options);\r\n        this.overlayEle.appendChild(cmpRef.location.nativeElement);\r\n\r\n\r\n        this.overlayHideSer.registerMouseEvent(this.overlayEle, (e: any) => {\r\n            if (cmpRef.location.nativeElement.contains(e.target)) {\r\n                return;\r\n            }\r\n            this.hide();\r\n        })\r\n\r\n\r\n\r\n        if (this.activeDom) {\r\n            // const w = target.offsetWidth > this.contextMenuDom.offsetWidth ? this.contextMenuDom.offsetWidth : target.offsetWidth;\r\n            const w = activeWidth || this.contextMenuDom.offsetWidth;\r\n            this.activeDom.style.width =  w + 'px';\r\n            this.activeDom.style.height = this.contextMenuDom.offsetHeight + 'px';\r\n            this.activeDom.style.left = target.getBoundingClientRect().left + 'px';\r\n            this.activeDom.style.top = this.contextMenuDom.getBoundingClientRect().top + 'px';\r\n            this.activeDom.style.display = 'block';\r\n        }\r\n        cmpRef.changeDetectorRef.detectChanges();\r\n\r\n        const menuPanelDom = cmpRef.instance.menuPanel.nativeElement;\r\n        const menuPanelHeight =  menuPanelDom.offsetHeight;\r\n        if (window.innerHeight -  event.pageY < menuPanelHeight) {\r\n            cmpRef.instance.top = event.pageY - menuPanelHeight;\r\n        }\r\n\r\n        if (window.innerWidth - event.pageX < menuPanelDom.offsetWidth) {\r\n            cmpRef.instance.left = event.pageX - menuPanelDom.offsetWidth;\r\n        }\r\n\r\n        cmpRef.changeDetectorRef.detectChanges();\r\n    }\r\n\r\n    hide() {\r\n        if (this.overlayEle) {\r\n            this.overlayEle.style.display = 'none';\r\n            if (this.contextMenuRefs) {\r\n                for (const key of Object.keys(this.contextMenuRefs)) {\r\n                    this.contextMenuRefs[key].hostView.destroy();\r\n                }\r\n                this.contextMenuRefs = null;\r\n            }\r\n\r\n            // ç§»é¤DOM æ ·å¼\r\n            if (this.contextMenuDom) {\r\n                this.contextMenuDom.className = this.contextMenuDom.className.replace('f-context-menu-active', '');\r\n            }\r\n\r\n\r\n            this.overlayHideSer.destory(this.overlayEle);\r\n            this.overlayEle.remove();\r\n        }\r\n\r\n        this.activeDom = null;\r\n        this.overlayEle = null;\r\n\r\n        \r\n    }\r\n}\r\n","import { FarrisContextMenuService } from './context-menu.service';\r\nimport { Component, Injector, Input, NgZone, OnInit, Renderer2, OnChanges,\r\n        ViewEncapsulation, ElementRef, ViewChild, ChangeDetectorRef, SimpleChanges, Optional, QueryList, ViewChildren } from '@angular/core';\r\nimport { ContextMenuItem } from './menu-item.interface';\r\n\r\n@Component({\r\n    selector: 'farris-menus',\r\n    templateUrl: './context-menu.component.html',\r\n    encapsulation: ViewEncapsulation.None,\r\n    exportAs: 'contextMenuRef',\r\n    styles: [\r\n            `\r\n    .f-context-menu-overlay {\r\n        position: fixed;\r\n        z-index: 9999;\r\n        top: 0;\r\n        left: 0;\r\n        height: 100%;\r\n        width: 100%;\r\n    }\r\n    .f-context-menu-panel {\r\n        position: absolute;\r\n        top: 200px;\r\n        left: 300px;\r\n        background: #fff;\r\n        border: 1px solid #c6c6c6;\r\n        border-radius: 5px;\r\n        box-shadow: 3px 3px 5px #b8b4b4;\r\n        padding: 3px 0px;\r\n        min-width: 180px;\r\n        max-width: 290px;\r\n    }\r\n\r\n    .f-context-menu-panel .menu-list {\r\n        list-style: none;\r\n    }\r\n\r\n    .f-context-menu-panel .menu-item {\r\n        height: 28px;\r\n        line-height: 28px;\r\n        cursor: pointer;\r\n    }\r\n\r\n    .f-context-menu-panel .menu-item.disabled {\r\n        opacity: 0.4;\r\n        cursor: default;\r\n    }\r\n\r\n    .f-context-menu-panel .menu-item.menu-sep{\r\n        height: 6px;\r\n        border-top: 1px solid #ccc;\r\n        border-bottom: 1px solid #fff;\r\n        margin-top: 5px;\r\n    }\r\n\r\n    .f-context-menu-panel .menu-item.active,\r\n    .f-context-menu-panel .menu-item:hover:not(.menu-sep) {\r\n        background: #e4e7ef;\r\n    }\r\n    .f-context-menu-panel .menu-item .f-context-menu-panel  {\r\n        display: none;\r\n    }\r\n\r\n    .f-context-menu-panel .menu-item:hover  .f-context-menu-panel {\r\n        display: block;\r\n    }\r\n\r\n    .f-context-menu-panel .menu-item-icon {\r\n        width: 40px;\r\n        text-align: center;\r\n        font-size: 18px;\r\n    }\r\n\r\n    .f-context-target-focus {\r\n        position: relative;\r\n        top: 100px;\r\n        left: 0;\r\n        border: 1px dashed;\r\n        height: 29px;\r\n        display: none;\r\n        background: #a1c8fb;\r\n        opacity: 0.2;\r\n    }\r\n\r\n    .f-context-menu-panel .menu-item-text .arrow-right {\r\n        width: 32px; height: 100%;display:block; text-align: center;\r\n    }\r\n        `\r\n    ]\r\n})\r\nexport class FarrisContextMenuComponent implements OnInit, OnChanges {\r\n\r\n    @Input() menuItems: ContextMenuItem[];\r\n    @Input() left: number;\r\n    @Input() top: number;\r\n\r\n    @Input() context: any;\r\n\r\n    @ViewChild('menuPanel') menuPanel: ElementRef;\r\n\r\n    @ViewChildren(FarrisContextMenuComponent) subMenus: QueryList<FarrisContextMenuComponent>;\r\n\r\n    parent: FarrisContextMenuComponent;\r\n    id: string;\r\n\r\n\r\n\r\n    constructor(private injector: Injector,\r\n                private ngzone: NgZone,\r\n                private render: Renderer2,\r\n                @Optional() private ctxMenuSer: FarrisContextMenuService,\r\n                private elRef: ElementRef,\r\n                public cd: ChangeDetectorRef) { }\r\n\r\n    ngOnInit(): void {\r\n\r\n    }\r\n\r\n    ngOnChanges(changes: SimpleChanges) {\r\n    }\r\n\r\n    onMenuItemClick($event: MouseEvent, item: ContextMenuItem) {\r\n        $event.stopPropagation();\r\n\r\n        if (item.disable) {\r\n            return;\r\n        }\r\n\r\n        if (item.children && item.children.length) {\r\n            return;\r\n        }\r\n\r\n        this.ctxMenuSer.hide();\r\n\r\n        if (item.handle) {\r\n            item.handle({ ...(this.context || {}), instance: this, menu: item });\r\n        }\r\n\r\n    }\r\n\r\n    onMouseEnter($event, item) {\r\n        if (item.children && item.children.length ) {\r\n            const childCtxMenu = this.subMenus.find(m => m.elRef.nativeElement.id === item.id + '_submenu');\r\n            if (childCtxMenu) {\r\n                // childCtxMenu.context = this.context;\r\n                childCtxMenu.parent = this;\r\n\r\n                const childMenuPanel = childCtxMenu.menuPanel.nativeElement;\r\n                const panel = this.menuPanel.nativeElement;\r\n                const childContainerWidth = window.innerWidth - panel.offsetLeft - panel.offsetWidth;\r\n                if (childMenuPanel.offsetWidth > childContainerWidth) {\r\n                    const l = -panel.offsetWidth;\r\n                    childMenuPanel.style.left = l + 'px';\r\n                }\r\n\r\n                const childContainerHeight = window.innerHeight - childMenuPanel.getBoundingClientRect().top;\r\n                if (childContainerHeight < childMenuPanel.offsetHeight) {\r\n                    const t = window.innerHeight - panel.offsetTop - childMenuPanel.offsetHeight - 10;\r\n                    childMenuPanel.style.top = t + 'px';\r\n                }\r\n            }\r\n\r\n        }\r\n    }\r\n}\r\n","import { Directive, HostListener, Input, Injector, ElementRef, OnInit, Renderer2, Optional } from '@angular/core';\r\nimport { of, Observable } from 'rxjs';\r\nimport { FarrisContextMenuService } from './context-menu.service';\r\nimport { BeforeShowMenu, ContextMenuItem } from './menu-item.interface';\r\n\r\n@Directive({\r\n    selector: '[farris-context-menus]',\r\n})\r\nexport class FarrisContextMenuDirective implements OnInit {\r\n    @Input('farris-context-menus') menuItems: ContextMenuItem[];\r\n    @Input() menuClass: string;\r\n    @Input() disabled = false;\r\n    @Input() context: any;\r\n    @Input() beforeShowContextMenu: (e?: any) => Observable<BeforeShowMenu>;\r\n    /** è§¦åå³é®èåå®éDOMæ ç­¾åç§° */\r\n    @Input() activeDomName: string;\r\n    @Input() highlight = true;\r\n    id: string;\r\n\r\n    constructor(@Optional() private ctxMenuSer: FarrisContextMenuService,\r\n                private injector: Injector, private elRef: ElementRef, private render: Renderer2) {\r\n                }\r\n\r\n    ngOnInit() {\r\n        this.id = this.contextMenuId();\r\n\r\n        if (!this.beforeShowContextMenu) {\r\n            this.beforeShowContextMenu = () => of(true);\r\n        }\r\n    }\r\n\r\n    @HostListener('contextmenu', ['$event'])\r\n    public onContextMenu(event: MouseEvent): void {\r\n        if (!this.disabled) {\r\n            let contextMenuDom = null;\r\n            if (this.activeDomName) {\r\n                contextMenuDom = (event.target as any).closest(this.activeDomName);\r\n                if (contextMenuDom) {\r\n                    this.render.addClass(contextMenuDom, 'f-context-menu-active');\r\n                } else {\r\n                    return;\r\n                }\r\n            }\r\n\r\n            const beforeShow$ = this.beforeShowContextMenu({ event, contextMenuDom });\r\n            if (beforeShow$ && beforeShow$.subscribe) {\r\n                beforeShow$.subscribe( (e: BeforeShowMenu) => {\r\n                    const ctxData = this.getContextData(e);\r\n                    this.removeSurplusMenus();\r\n                    if (ctxData.show) {\r\n                        document.body.click();\r\n\r\n                        // if (!this.ctxMenuSer) {\r\n                        //     const cfr = this.injector.get(ComponentFactoryResolver);\r\n                        //     this.ctxMenuSer = new FarrisContextMenuService(cfr, this.injector);\r\n                        // }\r\n\r\n                        this.ctxMenuSer.show({\r\n                            menuItems: this.getViewMenuItems(ctxData.data),\r\n                            event,\r\n                            id: this.id,\r\n                            activeDom: contextMenuDom,\r\n                            context: ctxData.data,\r\n                            menuClass: this.menuClass,\r\n                            target: this.elRef.nativeElement,\r\n                            activeWidth: e['focusTargetWidth'],\r\n                            highlight: this.highlight\r\n                        });\r\n\r\n                        event.preventDefault();\r\n                        event.stopPropagation();\r\n                    }\r\n                });\r\n            }\r\n        }\r\n    }\r\n\r\n    // å é¤ç¬¬3å±åä»¥åçèåï¼ä»æ¯æä¸¤å±èåå±ç¤º\r\n    private removeSurplusMenus() {\r\n        if (this.menuItems && this.menuItems.length) {\r\n            this.menuItems.forEach((m: any) => {\r\n                if (m !== '-' && m.children && m.children.length) {\r\n                    m.children.forEach(cm => {\r\n                        if (cm !== '-') {\r\n                            cm.children = [];\r\n                        }\r\n                    });\r\n                }\r\n            });\r\n        }\r\n    }\r\n\r\n    private contextMenuId() {\r\n        const id = this.elRef.nativeElement.id;\r\n        if (id) {\r\n            return `${id}-context-menu`;\r\n        } else {\r\n            return 'context-menu_' + new Date().getTime();\r\n        }\r\n    }\r\n\r\n    private getContextData(e: BeforeShowMenu) {\r\n        if (typeof e === 'boolean') {\r\n            return { show: e, data: null };\r\n        }\r\n        return e;\r\n    }\r\n\r\n\r\n    private getViewMenuItems(context) {\r\n        if (this.menuItems && this.menuItems.length) {\r\n            return this.checkMenuItems(this.menuItems, context);\r\n        }\r\n        return  [];\r\n    }\r\n\r\n    private checkMenuItems(menuItems, context) {\r\n        const menus = menuItems.map((m: any) => {\r\n            if (typeof m === 'string') {\r\n                return m;\r\n            } else {\r\n               const n = this.checkVisibleAndDisable(m, context);\r\n               if (n.children) {\r\n                   n.children = this.checkMenuItems(n.children, context);\r\n               }\r\n               return n;\r\n            }\r\n        }).filter(n => {\r\n            return n === '-' || n.visible;\r\n        });\r\n\r\n        if (menus && menus.length) {\r\n            if (menus[0] === '-') {\r\n                menus.shift(0);\r\n            }\r\n\r\n            if (menus[menus.length - 1] === '-') {\r\n                menus.pop(0);\r\n            }\r\n        }\r\n\r\n        return menus;\r\n    }\r\n\r\n    private checkVisibleAndDisable(m: any, context) {\r\n        const n = {...m};\r\n        if (!n.hasOwnProperty('visible')) {\r\n            n.visible = true;\r\n        } else {\r\n            if (typeof n.visible === 'function') {\r\n                n.visible = n.visible( context);\r\n            }\r\n        }\r\n\r\n        if (!n.hasOwnProperty('disable')) {\r\n            n.disable = false;\r\n        } else {\r\n            if (typeof n.disable === 'function') {\r\n                n.disable = n.disable( context );\r\n            }\r\n        }\r\n\r\n        return n;\r\n    }\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FarrisContextMenuComponent } from './context-menu.component';\r\nimport { FarrisContextMenuDirective } from './context-menu.directive';\r\nimport { FarrisContextMenuService } from './context-menu.service';\r\nimport { FarrisCommonModule } from '@farris/ui-common';\r\n\r\n@NgModule({\r\n    declarations: [\r\n        FarrisContextMenuComponent,\r\n        FarrisContextMenuDirective\r\n    ],\r\n    imports: [\r\n        CommonModule,\r\n        FarrisCommonModule\r\n    ],\r\n    exports: [\r\n        FarrisContextMenuComponent,\r\n        FarrisContextMenuDirective\r\n    ],\r\n    entryComponents: [\r\n        FarrisContextMenuComponent\r\n    ],\r\n    providers: [\r\n        FarrisContextMenuService\r\n    ],\r\n})\r\nexport class FarrisContextMenuModule {}\r\n"],"names":["tslib_1.__values"],"mappings":"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"}