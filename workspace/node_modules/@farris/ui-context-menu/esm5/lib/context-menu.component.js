/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
import { FarrisContextMenuService } from './context-menu.service';
import { Component, Injector, Input, NgZone, Renderer2, ViewEncapsulation, ElementRef, ViewChild, ChangeDetectorRef, Optional, QueryList, ViewChildren } from '@angular/core';
var FarrisContextMenuComponent = /** @class */ (function () {
    function FarrisContextMenuComponent(injector, ngzone, render, ctxMenuSer, elRef, cd) {
        this.injector = injector;
        this.ngzone = ngzone;
        this.render = render;
        this.ctxMenuSer = ctxMenuSer;
        this.elRef = elRef;
        this.cd = cd;
    }
    /**
     * @return {?}
     */
    FarrisContextMenuComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
    };
    /**
     * @param {?} changes
     * @return {?}
     */
    FarrisContextMenuComponent.prototype.ngOnChanges = /**
     * @param {?} changes
     * @return {?}
     */
    function (changes) {
    };
    /**
     * @param {?} $event
     * @param {?} item
     * @return {?}
     */
    FarrisContextMenuComponent.prototype.onMenuItemClick = /**
     * @param {?} $event
     * @param {?} item
     * @return {?}
     */
    function ($event, item) {
        $event.stopPropagation();
        if (item.disable) {
            return;
        }
        if (item.children && item.children.length) {
            return;
        }
        this.ctxMenuSer.hide();
        if (item.handle) {
            item.handle(tslib_1.__assign({}, (this.context || {}), { instance: this, menu: item }));
        }
    };
    /**
     * @param {?} $event
     * @param {?} item
     * @return {?}
     */
    FarrisContextMenuComponent.prototype.onMouseEnter = /**
     * @param {?} $event
     * @param {?} item
     * @return {?}
     */
    function ($event, item) {
        if (item.children && item.children.length) {
            /** @type {?} */
            var childCtxMenu = this.subMenus.find((/**
             * @param {?} m
             * @return {?}
             */
            function (m) { return m.elRef.nativeElement.id === item.id + '_submenu'; }));
            if (childCtxMenu) {
                // childCtxMenu.context = this.context;
                childCtxMenu.parent = this;
                /** @type {?} */
                var childMenuPanel = childCtxMenu.menuPanel.nativeElement;
                /** @type {?} */
                var panel = this.menuPanel.nativeElement;
                /** @type {?} */
                var childContainerWidth = window.innerWidth - panel.offsetLeft - panel.offsetWidth;
                if (childMenuPanel.offsetWidth > childContainerWidth) {
                    /** @type {?} */
                    var l = -panel.offsetWidth;
                    childMenuPanel.style.left = l + 'px';
                }
                /** @type {?} */
                var childContainerHeight = window.innerHeight - childMenuPanel.getBoundingClientRect().top;
                if (childContainerHeight < childMenuPanel.offsetHeight) {
                    /** @type {?} */
                    var t = window.innerHeight - panel.offsetTop - childMenuPanel.offsetHeight - 10;
                    childMenuPanel.style.top = t + 'px';
                }
            }
        }
    };
    FarrisContextMenuComponent.decorators = [
        { type: Component, args: [{
                    selector: 'farris-menus',
                    template: "\r\n<div class=\"f-context-menu-panel\" tabindex=\"0\" [style.left.px]=\"left\" [style.top.px]=\"top\" #menuPanel style=\"pointer-events: auto\">\r\n\r\n    <ul class=\"menu-list\">\r\n        <li class=\"menu-item d-flex\" *ngFor=\"let item of menuItems; index as i;last as islast;first as isfirst\" (click)=\"onMenuItemClick($event, item)\" \r\n        [class.menu-sep]=\"item === '-'\" (mouseenter)=\"onMouseEnter($event, item)\"\r\n        [class.disabled]=\"item.disable\" #menuitemli>\r\n            <ng-container *ngIf=\"item !== '-' \">\r\n                <div class=\"menu-item-icon\">\r\n                    <span class=\"f-icon {{ item.icon }}\" *ngIf=\"item.icon\"></span>\r\n                </div>\r\n                <div class=\"menu-item-text f-utils-fill d-flex\">\r\n                    <span style=\"display: block\" class=\"f-utils-fill\">{{ item.title }}</span>\r\n                    <span class=\"arrow-right\" *ngIf=\"item.children && item.children.length\">\r\n                        <span class=\"f-icon f-icon-arrow-e\"></span>\r\n                    </span>\r\n                </div>\r\n                <farris-menus #childMenu [context]=\"context\" [attr.id]=\"item.id+ '_submenu'\" *ngIf=\"item.children && item.children.length\" [menuItems]=\"item.children\"\r\n                    [top]=\"menuitemli.offsetTop - 3\" [left]=\"menuPanel.offsetWidth - 5\"\r\n                ></farris-menus>\r\n            </ng-container>\r\n        </li>\r\n    </ul>\r\n\r\n</div>\r\n",
                    encapsulation: ViewEncapsulation.None,
                    exportAs: 'contextMenuRef',
                    styles: ["\n    .f-context-menu-overlay {\n        position: fixed;\n        z-index: 9999;\n        top: 0;\n        left: 0;\n        height: 100%;\n        width: 100%;\n    }\n    .f-context-menu-panel {\n        position: absolute;\n        top: 200px;\n        left: 300px;\n        background: #fff;\n        border: 1px solid #c6c6c6;\n        border-radius: 5px;\n        box-shadow: 3px 3px 5px #b8b4b4;\n        padding: 3px 0px;\n        min-width: 180px;\n        max-width: 290px;\n    }\n\n    .f-context-menu-panel .menu-list {\n        list-style: none;\n    }\n\n    .f-context-menu-panel .menu-item {\n        height: 28px;\n        line-height: 28px;\n        cursor: pointer;\n    }\n\n    .f-context-menu-panel .menu-item.disabled {\n        opacity: 0.4;\n        cursor: default;\n    }\n\n    .f-context-menu-panel .menu-item.menu-sep{\n        height: 6px;\n        border-top: 1px solid #ccc;\n        border-bottom: 1px solid #fff;\n        margin-top: 5px;\n    }\n\n    .f-context-menu-panel .menu-item.active,\n    .f-context-menu-panel .menu-item:hover:not(.menu-sep) {\n        background: #e4e7ef;\n    }\n    .f-context-menu-panel .menu-item .f-context-menu-panel  {\n        display: none;\n    }\n\n    .f-context-menu-panel .menu-item:hover  .f-context-menu-panel {\n        display: block;\n    }\n\n    .f-context-menu-panel .menu-item-icon {\n        width: 40px;\n        text-align: center;\n        font-size: 18px;\n    }\n\n    .f-context-target-focus {\n        position: relative;\n        top: 100px;\n        left: 0;\n        border: 1px dashed;\n        height: 29px;\n        display: none;\n        background: #a1c8fb;\n        opacity: 0.2;\n    }\n\n    .f-context-menu-panel .menu-item-text .arrow-right {\n        width: 32px; height: 100%;display:block; text-align: center;\n    }\n        "]
                }] }
    ];
    /** @nocollapse */
    FarrisContextMenuComponent.ctorParameters = function () { return [
        { type: Injector },
        { type: NgZone },
        { type: Renderer2 },
        { type: FarrisContextMenuService, decorators: [{ type: Optional }] },
        { type: ElementRef },
        { type: ChangeDetectorRef }
    ]; };
    FarrisContextMenuComponent.propDecorators = {
        menuItems: [{ type: Input }],
        left: [{ type: Input }],
        top: [{ type: Input }],
        context: [{ type: Input }],
        menuPanel: [{ type: ViewChild, args: ['menuPanel',] }],
        subMenus: [{ type: ViewChildren, args: [FarrisContextMenuComponent,] }]
    };
    return FarrisContextMenuComponent;
}());
export { FarrisContextMenuComponent };
if (false) {
    /** @type {?} */
    FarrisContextMenuComponent.prototype.menuItems;
    /** @type {?} */
    FarrisContextMenuComponent.prototype.left;
    /** @type {?} */
    FarrisContextMenuComponent.prototype.top;
    /** @type {?} */
    FarrisContextMenuComponent.prototype.context;
    /** @type {?} */
    FarrisContextMenuComponent.prototype.menuPanel;
    /** @type {?} */
    FarrisContextMenuComponent.prototype.subMenus;
    /** @type {?} */
    FarrisContextMenuComponent.prototype.parent;
    /** @type {?} */
    FarrisContextMenuComponent.prototype.id;
    /**
     * @type {?}
     * @private
     */
    FarrisContextMenuComponent.prototype.injector;
    /**
     * @type {?}
     * @private
     */
    FarrisContextMenuComponent.prototype.ngzone;
    /**
     * @type {?}
     * @private
     */
    FarrisContextMenuComponent.prototype.render;
    /**
     * @type {?}
     * @private
     */
    FarrisContextMenuComponent.prototype.ctxMenuSer;
    /**
     * @type {?}
     * @private
     */
    FarrisContextMenuComponent.prototype.elRef;
    /** @type {?} */
    FarrisContextMenuComponent.prototype.cd;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29udGV4dC1tZW51LmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BmYXJyaXMvdWktY29udGV4dC1tZW51LyIsInNvdXJjZXMiOlsibGliL2NvbnRleHQtbWVudS5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQSxPQUFPLEVBQUUsd0JBQXdCLEVBQUUsTUFBTSx3QkFBd0IsQ0FBQztBQUNsRSxPQUFPLEVBQUUsU0FBUyxFQUFFLFFBQVEsRUFBRSxLQUFLLEVBQUUsTUFBTSxFQUFVLFNBQVMsRUFDdEQsaUJBQWlCLEVBQUUsVUFBVSxFQUFFLFNBQVMsRUFBRSxpQkFBaUIsRUFBaUIsUUFBUSxFQUFFLFNBQVMsRUFBRSxZQUFZLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFHN0k7SUFzR0ksb0NBQW9CLFFBQWtCLEVBQ2xCLE1BQWMsRUFDZCxNQUFpQixFQUNMLFVBQW9DLEVBQ2hELEtBQWlCLEVBQ2xCLEVBQXFCO1FBTHBCLGFBQVEsR0FBUixRQUFRLENBQVU7UUFDbEIsV0FBTSxHQUFOLE1BQU0sQ0FBUTtRQUNkLFdBQU0sR0FBTixNQUFNLENBQVc7UUFDTCxlQUFVLEdBQVYsVUFBVSxDQUEwQjtRQUNoRCxVQUFLLEdBQUwsS0FBSyxDQUFZO1FBQ2xCLE9BQUUsR0FBRixFQUFFLENBQW1CO0lBQUksQ0FBQzs7OztJQUU3Qyw2Q0FBUTs7O0lBQVI7SUFFQSxDQUFDOzs7OztJQUVELGdEQUFXOzs7O0lBQVgsVUFBWSxPQUFzQjtJQUNsQyxDQUFDOzs7Ozs7SUFFRCxvREFBZTs7Ozs7SUFBZixVQUFnQixNQUFrQixFQUFFLElBQXFCO1FBQ3JELE1BQU0sQ0FBQyxlQUFlLEVBQUUsQ0FBQztRQUV6QixJQUFJLElBQUksQ0FBQyxPQUFPLEVBQUU7WUFDZCxPQUFPO1NBQ1Y7UUFFRCxJQUFJLElBQUksQ0FBQyxRQUFRLElBQUksSUFBSSxDQUFDLFFBQVEsQ0FBQyxNQUFNLEVBQUU7WUFDdkMsT0FBTztTQUNWO1FBRUQsSUFBSSxDQUFDLFVBQVUsQ0FBQyxJQUFJLEVBQUUsQ0FBQztRQUV2QixJQUFJLElBQUksQ0FBQyxNQUFNLEVBQUU7WUFDYixJQUFJLENBQUMsTUFBTSxzQkFBTSxDQUFDLElBQUksQ0FBQyxPQUFPLElBQUksRUFBRSxDQUFDLElBQUUsUUFBUSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxJQUFHLENBQUM7U0FDeEU7SUFFTCxDQUFDOzs7Ozs7SUFFRCxpREFBWTs7Ozs7SUFBWixVQUFhLE1BQU0sRUFBRSxJQUFJO1FBQ3JCLElBQUksSUFBSSxDQUFDLFFBQVEsSUFBSSxJQUFJLENBQUMsUUFBUSxDQUFDLE1BQU0sRUFBRzs7Z0JBQ2xDLFlBQVksR0FBRyxJQUFJLENBQUMsUUFBUSxDQUFDLElBQUk7Ozs7WUFBQyxVQUFBLENBQUMsSUFBSSxPQUFBLENBQUMsQ0FBQyxLQUFLLENBQUMsYUFBYSxDQUFDLEVBQUUsS0FBSyxJQUFJLENBQUMsRUFBRSxHQUFHLFVBQVUsRUFBakQsQ0FBaUQsRUFBQztZQUMvRixJQUFJLFlBQVksRUFBRTtnQkFDZCx1Q0FBdUM7Z0JBQ3ZDLFlBQVksQ0FBQyxNQUFNLEdBQUcsSUFBSSxDQUFDOztvQkFFckIsY0FBYyxHQUFHLFlBQVksQ0FBQyxTQUFTLENBQUMsYUFBYTs7b0JBQ3JELEtBQUssR0FBRyxJQUFJLENBQUMsU0FBUyxDQUFDLGFBQWE7O29CQUNwQyxtQkFBbUIsR0FBRyxNQUFNLENBQUMsVUFBVSxHQUFHLEtBQUssQ0FBQyxVQUFVLEdBQUcsS0FBSyxDQUFDLFdBQVc7Z0JBQ3BGLElBQUksY0FBYyxDQUFDLFdBQVcsR0FBRyxtQkFBbUIsRUFBRTs7d0JBQzVDLENBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQyxXQUFXO29CQUM1QixjQUFjLENBQUMsS0FBSyxDQUFDLElBQUksR0FBRyxDQUFDLEdBQUcsSUFBSSxDQUFDO2lCQUN4Qzs7b0JBRUssb0JBQW9CLEdBQUcsTUFBTSxDQUFDLFdBQVcsR0FBRyxjQUFjLENBQUMscUJBQXFCLEVBQUUsQ0FBQyxHQUFHO2dCQUM1RixJQUFJLG9CQUFvQixHQUFHLGNBQWMsQ0FBQyxZQUFZLEVBQUU7O3dCQUM5QyxDQUFDLEdBQUcsTUFBTSxDQUFDLFdBQVcsR0FBRyxLQUFLLENBQUMsU0FBUyxHQUFHLGNBQWMsQ0FBQyxZQUFZLEdBQUcsRUFBRTtvQkFDakYsY0FBYyxDQUFDLEtBQUssQ0FBQyxHQUFHLEdBQUcsQ0FBQyxHQUFHLElBQUksQ0FBQztpQkFDdkM7YUFDSjtTQUVKO0lBQ0wsQ0FBQzs7Z0JBOUpKLFNBQVMsU0FBQztvQkFDUCxRQUFRLEVBQUUsY0FBYztvQkFDeEIsdStDQUE0QztvQkFDNUMsYUFBYSxFQUFFLGlCQUFpQixDQUFDLElBQUk7b0JBQ3JDLFFBQVEsRUFBRSxnQkFBZ0I7NkJBRWxCLGt6REE0RUg7aUJBRVI7Ozs7Z0JBeEZtQixRQUFRO2dCQUFTLE1BQU07Z0JBQVUsU0FBUztnQkFEckQsd0JBQXdCLHVCQThHaEIsUUFBUTtnQkE1R0UsVUFBVTtnQkFBYSxpQkFBaUI7Ozs0QkEwRjlELEtBQUs7dUJBQ0wsS0FBSztzQkFDTCxLQUFLOzBCQUVMLEtBQUs7NEJBRUwsU0FBUyxTQUFDLFdBQVc7MkJBRXJCLFlBQVksU0FBQywwQkFBMEI7O0lBZ0U1QyxpQ0FBQztDQUFBLEFBL0pELElBK0pDO1NBMUVZLDBCQUEwQjs7O0lBRW5DLCtDQUFzQzs7SUFDdEMsMENBQXNCOztJQUN0Qix5Q0FBcUI7O0lBRXJCLDZDQUFzQjs7SUFFdEIsK0NBQThDOztJQUU5Qyw4Q0FBMEY7O0lBRTFGLDRDQUFtQzs7SUFDbkMsd0NBQVc7Ozs7O0lBSUMsOENBQTBCOzs7OztJQUMxQiw0Q0FBc0I7Ozs7O0lBQ3RCLDRDQUF5Qjs7Ozs7SUFDekIsZ0RBQXdEOzs7OztJQUN4RCwyQ0FBeUI7O0lBQ3pCLHdDQUE0QiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEZhcnJpc0NvbnRleHRNZW51U2VydmljZSB9IGZyb20gJy4vY29udGV4dC1tZW51LnNlcnZpY2UnO1xyXG5pbXBvcnQgeyBDb21wb25lbnQsIEluamVjdG9yLCBJbnB1dCwgTmdab25lLCBPbkluaXQsIFJlbmRlcmVyMiwgT25DaGFuZ2VzLFxyXG4gICAgICAgIFZpZXdFbmNhcHN1bGF0aW9uLCBFbGVtZW50UmVmLCBWaWV3Q2hpbGQsIENoYW5nZURldGVjdG9yUmVmLCBTaW1wbGVDaGFuZ2VzLCBPcHRpb25hbCwgUXVlcnlMaXN0LCBWaWV3Q2hpbGRyZW4gfSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgQ29udGV4dE1lbnVJdGVtIH0gZnJvbSAnLi9tZW51LWl0ZW0uaW50ZXJmYWNlJztcclxuXHJcbkBDb21wb25lbnQoe1xyXG4gICAgc2VsZWN0b3I6ICdmYXJyaXMtbWVudXMnLFxyXG4gICAgdGVtcGxhdGVVcmw6ICcuL2NvbnRleHQtbWVudS5jb21wb25lbnQuaHRtbCcsXHJcbiAgICBlbmNhcHN1bGF0aW9uOiBWaWV3RW5jYXBzdWxhdGlvbi5Ob25lLFxyXG4gICAgZXhwb3J0QXM6ICdjb250ZXh0TWVudVJlZicsXHJcbiAgICBzdHlsZXM6IFtcclxuICAgICAgICAgICAgYFxyXG4gICAgLmYtY29udGV4dC1tZW51LW92ZXJsYXkge1xyXG4gICAgICAgIHBvc2l0aW9uOiBmaXhlZDtcclxuICAgICAgICB6LWluZGV4OiA5OTk5O1xyXG4gICAgICAgIHRvcDogMDtcclxuICAgICAgICBsZWZ0OiAwO1xyXG4gICAgICAgIGhlaWdodDogMTAwJTtcclxuICAgICAgICB3aWR0aDogMTAwJTtcclxuICAgIH1cclxuICAgIC5mLWNvbnRleHQtbWVudS1wYW5lbCB7XHJcbiAgICAgICAgcG9zaXRpb246IGFic29sdXRlO1xyXG4gICAgICAgIHRvcDogMjAwcHg7XHJcbiAgICAgICAgbGVmdDogMzAwcHg7XHJcbiAgICAgICAgYmFja2dyb3VuZDogI2ZmZjtcclxuICAgICAgICBib3JkZXI6IDFweCBzb2xpZCAjYzZjNmM2O1xyXG4gICAgICAgIGJvcmRlci1yYWRpdXM6IDVweDtcclxuICAgICAgICBib3gtc2hhZG93OiAzcHggM3B4IDVweCAjYjhiNGI0O1xyXG4gICAgICAgIHBhZGRpbmc6IDNweCAwcHg7XHJcbiAgICAgICAgbWluLXdpZHRoOiAxODBweDtcclxuICAgICAgICBtYXgtd2lkdGg6IDI5MHB4O1xyXG4gICAgfVxyXG5cclxuICAgIC5mLWNvbnRleHQtbWVudS1wYW5lbCAubWVudS1saXN0IHtcclxuICAgICAgICBsaXN0LXN0eWxlOiBub25lO1xyXG4gICAgfVxyXG5cclxuICAgIC5mLWNvbnRleHQtbWVudS1wYW5lbCAubWVudS1pdGVtIHtcclxuICAgICAgICBoZWlnaHQ6IDI4cHg7XHJcbiAgICAgICAgbGluZS1oZWlnaHQ6IDI4cHg7XHJcbiAgICAgICAgY3Vyc29yOiBwb2ludGVyO1xyXG4gICAgfVxyXG5cclxuICAgIC5mLWNvbnRleHQtbWVudS1wYW5lbCAubWVudS1pdGVtLmRpc2FibGVkIHtcclxuICAgICAgICBvcGFjaXR5OiAwLjQ7XHJcbiAgICAgICAgY3Vyc29yOiBkZWZhdWx0O1xyXG4gICAgfVxyXG5cclxuICAgIC5mLWNvbnRleHQtbWVudS1wYW5lbCAubWVudS1pdGVtLm1lbnUtc2Vwe1xyXG4gICAgICAgIGhlaWdodDogNnB4O1xyXG4gICAgICAgIGJvcmRlci10b3A6IDFweCBzb2xpZCAjY2NjO1xyXG4gICAgICAgIGJvcmRlci1ib3R0b206IDFweCBzb2xpZCAjZmZmO1xyXG4gICAgICAgIG1hcmdpbi10b3A6IDVweDtcclxuICAgIH1cclxuXHJcbiAgICAuZi1jb250ZXh0LW1lbnUtcGFuZWwgLm1lbnUtaXRlbS5hY3RpdmUsXHJcbiAgICAuZi1jb250ZXh0LW1lbnUtcGFuZWwgLm1lbnUtaXRlbTpob3Zlcjpub3QoLm1lbnUtc2VwKSB7XHJcbiAgICAgICAgYmFja2dyb3VuZDogI2U0ZTdlZjtcclxuICAgIH1cclxuICAgIC5mLWNvbnRleHQtbWVudS1wYW5lbCAubWVudS1pdGVtIC5mLWNvbnRleHQtbWVudS1wYW5lbCAge1xyXG4gICAgICAgIGRpc3BsYXk6IG5vbmU7XHJcbiAgICB9XHJcblxyXG4gICAgLmYtY29udGV4dC1tZW51LXBhbmVsIC5tZW51LWl0ZW06aG92ZXIgIC5mLWNvbnRleHQtbWVudS1wYW5lbCB7XHJcbiAgICAgICAgZGlzcGxheTogYmxvY2s7XHJcbiAgICB9XHJcblxyXG4gICAgLmYtY29udGV4dC1tZW51LXBhbmVsIC5tZW51LWl0ZW0taWNvbiB7XHJcbiAgICAgICAgd2lkdGg6IDQwcHg7XHJcbiAgICAgICAgdGV4dC1hbGlnbjogY2VudGVyO1xyXG4gICAgICAgIGZvbnQtc2l6ZTogMThweDtcclxuICAgIH1cclxuXHJcbiAgICAuZi1jb250ZXh0LXRhcmdldC1mb2N1cyB7XHJcbiAgICAgICAgcG9zaXRpb246IHJlbGF0aXZlO1xyXG4gICAgICAgIHRvcDogMTAwcHg7XHJcbiAgICAgICAgbGVmdDogMDtcclxuICAgICAgICBib3JkZXI6IDFweCBkYXNoZWQ7XHJcbiAgICAgICAgaGVpZ2h0OiAyOXB4O1xyXG4gICAgICAgIGRpc3BsYXk6IG5vbmU7XHJcbiAgICAgICAgYmFja2dyb3VuZDogI2ExYzhmYjtcclxuICAgICAgICBvcGFjaXR5OiAwLjI7XHJcbiAgICB9XHJcblxyXG4gICAgLmYtY29udGV4dC1tZW51LXBhbmVsIC5tZW51LWl0ZW0tdGV4dCAuYXJyb3ctcmlnaHQge1xyXG4gICAgICAgIHdpZHRoOiAzMnB4OyBoZWlnaHQ6IDEwMCU7ZGlzcGxheTpibG9jazsgdGV4dC1hbGlnbjogY2VudGVyO1xyXG4gICAgfVxyXG4gICAgICAgIGBcclxuICAgIF1cclxufSlcclxuZXhwb3J0IGNsYXNzIEZhcnJpc0NvbnRleHRNZW51Q29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0LCBPbkNoYW5nZXMge1xyXG5cclxuICAgIEBJbnB1dCgpIG1lbnVJdGVtczogQ29udGV4dE1lbnVJdGVtW107XHJcbiAgICBASW5wdXQoKSBsZWZ0OiBudW1iZXI7XHJcbiAgICBASW5wdXQoKSB0b3A6IG51bWJlcjtcclxuXHJcbiAgICBASW5wdXQoKSBjb250ZXh0OiBhbnk7XHJcblxyXG4gICAgQFZpZXdDaGlsZCgnbWVudVBhbmVsJykgbWVudVBhbmVsOiBFbGVtZW50UmVmO1xyXG5cclxuICAgIEBWaWV3Q2hpbGRyZW4oRmFycmlzQ29udGV4dE1lbnVDb21wb25lbnQpIHN1Yk1lbnVzOiBRdWVyeUxpc3Q8RmFycmlzQ29udGV4dE1lbnVDb21wb25lbnQ+O1xyXG5cclxuICAgIHBhcmVudDogRmFycmlzQ29udGV4dE1lbnVDb21wb25lbnQ7XHJcbiAgICBpZDogc3RyaW5nO1xyXG5cclxuXHJcblxyXG4gICAgY29uc3RydWN0b3IocHJpdmF0ZSBpbmplY3RvcjogSW5qZWN0b3IsXHJcbiAgICAgICAgICAgICAgICBwcml2YXRlIG5nem9uZTogTmdab25lLFxyXG4gICAgICAgICAgICAgICAgcHJpdmF0ZSByZW5kZXI6IFJlbmRlcmVyMixcclxuICAgICAgICAgICAgICAgIEBPcHRpb25hbCgpIHByaXZhdGUgY3R4TWVudVNlcjogRmFycmlzQ29udGV4dE1lbnVTZXJ2aWNlLFxyXG4gICAgICAgICAgICAgICAgcHJpdmF0ZSBlbFJlZjogRWxlbWVudFJlZixcclxuICAgICAgICAgICAgICAgIHB1YmxpYyBjZDogQ2hhbmdlRGV0ZWN0b3JSZWYpIHsgfVxyXG5cclxuICAgIG5nT25Jbml0KCk6IHZvaWQge1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBuZ09uQ2hhbmdlcyhjaGFuZ2VzOiBTaW1wbGVDaGFuZ2VzKSB7XHJcbiAgICB9XHJcblxyXG4gICAgb25NZW51SXRlbUNsaWNrKCRldmVudDogTW91c2VFdmVudCwgaXRlbTogQ29udGV4dE1lbnVJdGVtKSB7XHJcbiAgICAgICAgJGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xyXG5cclxuICAgICAgICBpZiAoaXRlbS5kaXNhYmxlKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChpdGVtLmNoaWxkcmVuICYmIGl0ZW0uY2hpbGRyZW4ubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuY3R4TWVudVNlci5oaWRlKCk7XHJcblxyXG4gICAgICAgIGlmIChpdGVtLmhhbmRsZSkge1xyXG4gICAgICAgICAgICBpdGVtLmhhbmRsZSh7IC4uLih0aGlzLmNvbnRleHQgfHwge30pLCBpbnN0YW5jZTogdGhpcywgbWVudTogaXRlbSB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgfVxyXG5cclxuICAgIG9uTW91c2VFbnRlcigkZXZlbnQsIGl0ZW0pIHtcclxuICAgICAgICBpZiAoaXRlbS5jaGlsZHJlbiAmJiBpdGVtLmNoaWxkcmVuLmxlbmd0aCApIHtcclxuICAgICAgICAgICAgY29uc3QgY2hpbGRDdHhNZW51ID0gdGhpcy5zdWJNZW51cy5maW5kKG0gPT4gbS5lbFJlZi5uYXRpdmVFbGVtZW50LmlkID09PSBpdGVtLmlkICsgJ19zdWJtZW51Jyk7XHJcbiAgICAgICAgICAgIGlmIChjaGlsZEN0eE1lbnUpIHtcclxuICAgICAgICAgICAgICAgIC8vIGNoaWxkQ3R4TWVudS5jb250ZXh0ID0gdGhpcy5jb250ZXh0O1xyXG4gICAgICAgICAgICAgICAgY2hpbGRDdHhNZW51LnBhcmVudCA9IHRoaXM7XHJcblxyXG4gICAgICAgICAgICAgICAgY29uc3QgY2hpbGRNZW51UGFuZWwgPSBjaGlsZEN0eE1lbnUubWVudVBhbmVsLm5hdGl2ZUVsZW1lbnQ7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBwYW5lbCA9IHRoaXMubWVudVBhbmVsLm5hdGl2ZUVsZW1lbnQ7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBjaGlsZENvbnRhaW5lcldpZHRoID0gd2luZG93LmlubmVyV2lkdGggLSBwYW5lbC5vZmZzZXRMZWZ0IC0gcGFuZWwub2Zmc2V0V2lkdGg7XHJcbiAgICAgICAgICAgICAgICBpZiAoY2hpbGRNZW51UGFuZWwub2Zmc2V0V2lkdGggPiBjaGlsZENvbnRhaW5lcldpZHRoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbCA9IC1wYW5lbC5vZmZzZXRXaWR0aDtcclxuICAgICAgICAgICAgICAgICAgICBjaGlsZE1lbnVQYW5lbC5zdHlsZS5sZWZ0ID0gbCArICdweCc7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgY29uc3QgY2hpbGRDb250YWluZXJIZWlnaHQgPSB3aW5kb3cuaW5uZXJIZWlnaHQgLSBjaGlsZE1lbnVQYW5lbC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS50b3A7XHJcbiAgICAgICAgICAgICAgICBpZiAoY2hpbGRDb250YWluZXJIZWlnaHQgPCBjaGlsZE1lbnVQYW5lbC5vZmZzZXRIZWlnaHQpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCB0ID0gd2luZG93LmlubmVySGVpZ2h0IC0gcGFuZWwub2Zmc2V0VG9wIC0gY2hpbGRNZW51UGFuZWwub2Zmc2V0SGVpZ2h0IC0gMTA7XHJcbiAgICAgICAgICAgICAgICAgICAgY2hpbGRNZW51UGFuZWwuc3R5bGUudG9wID0gdCArICdweCc7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcbiJdfQ==