/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, ViewEncapsulation, forwardRef, Input, Output, EventEmitter, ViewChild, ElementRef, ChangeDetectorRef } from '@angular/core';
import { NG_VALUE_ACCESSOR } from '@angular/forms';
import { LocaleService } from '@farris/ui-locale';
/**
 * @record
 */
function Tag() { }
if (false) {
    /** @type {?|undefined} */
    Tag.prototype.value;
    /** @type {?} */
    Tag.prototype.name;
    /** @type {?|undefined} */
    Tag.prototype.tagType;
    /** @type {?|undefined} */
    Tag.prototype.color;
    /** @type {?|undefined} */
    Tag.prototype.closable;
    /** @type {?|undefined} */
    Tag.prototype.checked;
    /** @type {?|undefined} */
    Tag.prototype.size;
    /** @type {?|undefined} */
    Tag.prototype.checkable;
}
var TagsComponent = /** @class */ (function () {
    function TagsComponent(localeService, cd) {
        this.localeService = localeService;
        this.cd = cd;
        //是否支持添加
        this._addable = true;
        //是否支持关闭
        this._closable = true;
        this._readonly = false;
        this.checkChanged = new EventEmitter();
        this.tagClick = new EventEmitter();
        this.dataChanged = new EventEmitter();
        this.closed = new EventEmitter();
        this.addInput = false;
        this.addTagValue = '';
        this.checkedTags = [];
        this.innerTags = [];
        //添加按钮是否禁用
        this.addTagAble = true;
        this.onChangeCallback = (/**
         * @return {?}
         */
        function () { });
        this.onTouchedCallback = (/**
         * @return {?}
         */
        function () { });
    }
    Object.defineProperty(TagsComponent.prototype, "data", {
        get: /**
         * @return {?}
         */
        function () {
            return this._data;
        },
        set: /**
         * @param {?} val
         * @return {?}
         */
        function (val) {
            var _this = this;
            this._data = val;
            setTimeout((/**
             * @return {?}
             */
            function () {
                _this.tagInit(_this._data);
            }));
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TagsComponent.prototype, "checkable", {
        get: /**
         * @return {?}
         */
        function () {
            return this._checkable;
        },
        set: /**
         * @param {?} val
         * @return {?}
         */
        function (val) {
            this._checkable = val;
            this.cd.detectChanges();
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TagsComponent.prototype, "addable", {
        get: /**
         * @return {?}
         */
        function () {
            return this._addable;
        },
        set: /**
         * @param {?} val
         * @return {?}
         */
        function (val) {
            this._addable = val;
            this.addTagAble = val;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TagsComponent.prototype, "tagType", {
        get: /**
         * @return {?}
         */
        function () {
            return this._tagType;
        },
        set: /**
         * @param {?} val
         * @return {?}
         */
        function (val) {
            this._tagType = val;
            this.cd.detectChanges();
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TagsComponent.prototype, "color", {
        get: /**
         * @return {?}
         */
        function () {
            return this._color;
        },
        set: /**
         * @param {?} val
         * @return {?}
         */
        function (val) {
            this._color = val;
            this.styleInit();
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TagsComponent.prototype, "closable", {
        get: /**
         * @return {?}
         */
        function () {
            return this._closable;
        },
        set: /**
         * @param {?} val
         * @return {?}
         */
        function (val) {
            this._closable = val;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TagsComponent.prototype, "readonly", {
        get: /**
         * @return {?}
         */
        function () {
            return this._readonly;
        },
        set: /**
         * @param {?} val
         * @return {?}
         */
        function (val) {
            this._readonly = val;
            if (!this._readonly) {
                this._closable = true;
                // this._addable = true;
                this.addTagAble = true;
            }
            else {
                this.activeTag = '';
                this._closable = false;
                // this._addable = false;
                this.addTagAble = false;
            }
            this.cd.detectChanges();
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    TagsComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        if (this._checkable) {
            this._closable = false;
        }
        this.placeholder = this.localeService.getValue('tag.placeholder');
    };
    /**
     * @param {?} data
     * @return {?}
     */
    TagsComponent.prototype.tagInit = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        this.innerTags = [];
        if (!data)
            return;
        /** @type {?} */
        var tagsArray = data.split(',');
        /** @type {?} */
        var tagsData = tagsArray.filter((/**
         * @param {?} item
         * @return {?}
         */
        function (item) {
            if (item !== '') {
                return item;
            }
        }));
        if (tagsData && tagsData.length) {
            for (var i = 0; i < tagsData.length; i++) {
                /** @type {?} */
                var tagdata = {
                    name: ''
                };
                tagdata.name = tagsData[i];
                this.innerTags.push(tagdata);
            }
        }
        else {
            this.innerTags = [];
        }
    };
    /**
     * 点击关闭
     * @param e event
     * @param tag tag
     * @param index tag索引
     */
    /**
     * 点击关闭
     * @param {?} e event
     * @param {?} tag tag
     * @param {?} index tag索引
     * @return {?}
     */
    TagsComponent.prototype.closeHandler = /**
     * 点击关闭
     * @param {?} e event
     * @param {?} tag tag
     * @param {?} index tag索引
     * @return {?}
     */
    function (e, tag, index) {
        e.preventDefault();
        this.innerTags.splice(index, 1);
        /** @type {?} */
        var tagdata = this.tagProcess(this.innerTags);
        this.onChangeCallback(tagdata);
        this.onTouchedCallback();
        this.closed.emit(tag.name);
        this.dataChanged.emit(tagdata);
    };
    /**
     * 点击tag
     * @param e event
     * @param tag
     */
    /**
     * 点击tag
     * @param {?} e event
     * @param {?} tag
     * @return {?}
     */
    TagsComponent.prototype.clickHandler = /**
     * 点击tag
     * @param {?} e event
     * @param {?} tag
     * @return {?}
     */
    function (e, tag) {
        e.preventDefault();
        if (this._readonly)
            return;
        if (this.activeTag != tag['name']) {
            this.activeTag = tag.name;
        }
        this.tagClick.emit(tag.name);
        if (!this._checkable)
            return;
        if (tag.hasOwnProperty('checked')) {
            tag.checked = !tag.checked;
        }
        else {
            tag.checked = true;
        }
        this.checkedTags = this.innerTags.filter((/**
         * @param {?} data
         * @return {?}
         */
        function (data) {
            return data.checked;
        }));
        /** @type {?} */
        var tagdata = this.tagProcess(this.innerTags);
        this.onChangeCallback(tagdata);
        this.onTouchedCallback();
        /** @type {?} */
        var CheckChangedData = {
            data: tagdata,
            tag: tag.name,
            checked: this.tagProcess(this.checkedTags)
        };
        this.checkChanged.emit(CheckChangedData);
    };
    /**
     * 点击添加tag按钮
     */
    /**
     * 点击添加tag按钮
     * @return {?}
     */
    TagsComponent.prototype.addHander = /**
     * 点击添加tag按钮
     * @return {?}
     */
    function () {
        var _this = this;
        if (!this._addable || !this.addTagAble)
            return;
        this.addInput = true;
        this.addTagValue = '';
        setTimeout((/**
         * @return {?}
         */
        function () {
            _this.addInputText.nativeElement.focus();
        }));
    };
    /**
     * 添加tag失去焦点
     */
    /**
     * 添加tag失去焦点
     * @param {?} event
     * @return {?}
     */
    TagsComponent.prototype.addInputBlur = /**
     * 添加tag失去焦点
     * @param {?} event
     * @return {?}
     */
    function (event) {
        var _this = this;
        if (!this._addable || !this.addInput)
            return;
        if (this.addTagValue) {
            /** @type {?} */
            var hastag = this.innerTags.find((/**
             * @param {?} tag
             * @return {?}
             */
            function (tag) {
                return tag.name == _this.addTagValue;
            }));
            if (hastag) {
                this.addInput = false;
                return;
            }
            else {
                /** @type {?} */
                var tag = { name: this.addTagValue };
                this.innerTags.push(tag);
                /** @type {?} */
                var tagdata = this.tagProcess(this.innerTags);
                this.dataChanged.emit(this.tagProcess(this.innerTags));
                this.onChangeCallback(tagdata);
                this.onTouchedCallback();
            }
        }
        this.addInput = false;
    };
    /**
     * @param {?} val
     * @return {?}
     */
    TagsComponent.prototype.writeValue = /**
     * @param {?} val
     * @return {?}
     */
    function (val) {
        this._data = val;
        this.tagInit(this._data);
    };
    /**
     * @param {?} fn
     * @return {?}
     */
    TagsComponent.prototype.registerOnChange = /**
     * @param {?} fn
     * @return {?}
     */
    function (fn) {
        this.onChangeCallback = fn;
    };
    /**
     * @param {?} fn
     * @return {?}
     */
    TagsComponent.prototype.registerOnTouched = /**
     * @param {?} fn
     * @return {?}
     */
    function (fn) {
        this.onTouchedCallback = fn;
    };
    /**
     * @param {?} data
     * @return {?}
     */
    TagsComponent.prototype.tagProcess = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        if (data && data.length) {
            /** @type {?} */
            var tagProcessData_1 = [];
            data.forEach((/**
             * @param {?} tag
             * @return {?}
             */
            function (tag) {
                tagProcessData_1.push(tag.name);
            }));
            return tagProcessData_1.join(',');
        }
        else {
            return '';
        }
    };
    //改变透明度
    //改变透明度
    /**
     * @param {?} hex
     * @param {?=} opacity
     * @return {?}
     */
    TagsComponent.prototype.hexToRgba = 
    //改变透明度
    /**
     * @param {?} hex
     * @param {?=} opacity
     * @return {?}
     */
    function (hex, opacity) {
        if (opacity === void 0) { opacity = 1; }
        /** @type {?} */
        var reg = /^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/;
        /** @type {?} */
        var sColor = hex.toLowerCase();
        if (sColor && reg.test(sColor)) {
            if (sColor.length === 4) {
                /** @type {?} */
                var sColorNew = "#";
                for (var i = 1; i < 4; i += 1) {
                    sColorNew += sColor.slice(i, i + 1).concat(sColor.slice(i, i + 1));
                }
                sColor = sColorNew;
            }
            //处理六位的颜色值
            /** @type {?} */
            var sColorChange = [];
            for (var i = 1; i < 7; i += 2) {
                sColorChange.push(parseInt("0x" + sColor.slice(i, i + 2)));
            }
            return "RGB(" + sColorChange.join(",") + ',' + opacity + ")";
        }
        else {
            return sColor;
        }
    };
    /**
     * @return {?}
     */
    TagsComponent.prototype.styleInit = /**
     * @return {?}
     */
    function () {
        if (this.color) {
            this.tagStyle = {
                color: this._color,
                background: this._color ? this.hexToRgba(this._color, 0.1) : '',
                borderColor: this._color
            };
        }
        else {
            this.tagStyle = '';
        }
        this.cd.detectChanges();
    };
    TagsComponent.decorators = [
        { type: Component, args: [{
                    selector: 'farris-tags',
                    template: "<div [class]=\"'farris-tags '+ (className?className:'')\" [ngClass]=\"{'farris-tags-checkable': checkable}\">\r\n    <ul class=\"farris-tags-item-container\">\r\n        <li\r\n        *ngFor=\"let tag of innerTags;let index = index;\"\r\n        [class]=\"'farris-tag-item' + (tagType?' farris-tag-item-' + tagType:'')\"\r\n        [ngClass]=\"{'farris-tag-item-checked': checkable && tag.checked,\r\n        'farris-tag-item-checkable': checkable, \r\n        'farris-tag-item-has-color': color,\r\n        'farris-tag-item-actived':activeTag == tag.name}\"\r\n        (click)=\"clickHandler($event,tag)\"\r\n        [ngStyle]=\"tagStyle\"\r\n        >\r\n            <span class=\"tag-box\">{{tag.name}}</span>\r\n            <span class=\"tag-delete\" *ngIf=\"closable\">\r\n                <i class=\"f-icon f-icon-close\" (click)=\"closeHandler($event,tag,index)\"></i>\r\n            </span>\r\n        </li>\r\n        <li class=\"farris-tag-item farris-tag-add-button\" [ngClass]=\"{'farris-tag-add-button-disabled': !addTagAble}\" *ngIf=\"addable && !addInput\" (click)=\"addHander()\">\r\n            <span class=\"f-icon f-icon-amplification\"></span>\r\n            <span class=\"farris-tag-add-text\">{{ 'tag.addText' | locale }}</span>\r\n        </li>\r\n        <li class=\"farris-tag-input-box\" *ngIf=\"addable && addInput\">\r\n            <input type=\"text\" class=\"form-control\" (blur)=\"addInputBlur($event)\" (keyup.enter)=\"addInputBlur($event)\" #addInputText [(ngModel)]=\"addTagValue\" [placeholder]=\"placeholder\">\r\n        </li>\r\n    </ul>\r\n</div>",
                    // styleUrls: ['./tags.component.scss'],
                    encapsulation: ViewEncapsulation.None,
                    providers: [
                        {
                            provide: NG_VALUE_ACCESSOR,
                            useExisting: forwardRef((/**
                             * @return {?}
                             */
                            function () { return TagsComponent; })),
                            multi: true
                        }
                    ]
                }] }
    ];
    /** @nocollapse */
    TagsComponent.ctorParameters = function () { return [
        { type: LocaleService },
        { type: ChangeDetectorRef }
    ]; };
    TagsComponent.propDecorators = {
        data: [{ type: Input }],
        value: [{ type: Input }],
        checkable: [{ type: Input }],
        addable: [{ type: Input }],
        tagType: [{ type: Input }],
        color: [{ type: Input }],
        closable: [{ type: Input }],
        readonly: [{ type: Input }],
        className: [{ type: Input }],
        checkChanged: [{ type: Output }],
        tagClick: [{ type: Output }],
        dataChanged: [{ type: Output }],
        closed: [{ type: Output }],
        addInputText: [{ type: ViewChild, args: ['addInputText',] }]
    };
    return TagsComponent;
}());
export { TagsComponent };
if (false) {
    /** @type {?} */
    TagsComponent.prototype._data;
    /** @type {?} */
    TagsComponent.prototype.value;
    /** @type {?} */
    TagsComponent.prototype._checkable;
    /** @type {?} */
    TagsComponent.prototype._addable;
    /** @type {?} */
    TagsComponent.prototype._tagType;
    /** @type {?} */
    TagsComponent.prototype._color;
    /** @type {?} */
    TagsComponent.prototype._closable;
    /** @type {?} */
    TagsComponent.prototype._readonly;
    /** @type {?} */
    TagsComponent.prototype.className;
    /** @type {?} */
    TagsComponent.prototype.checkChanged;
    /** @type {?} */
    TagsComponent.prototype.tagClick;
    /** @type {?} */
    TagsComponent.prototype.dataChanged;
    /** @type {?} */
    TagsComponent.prototype.closed;
    /** @type {?} */
    TagsComponent.prototype.addInputText;
    /** @type {?} */
    TagsComponent.prototype.addInput;
    /** @type {?} */
    TagsComponent.prototype.addTagValue;
    /** @type {?} */
    TagsComponent.prototype.placeholder;
    /** @type {?} */
    TagsComponent.prototype.checkedTags;
    /** @type {?} */
    TagsComponent.prototype.innerTags;
    /** @type {?} */
    TagsComponent.prototype.tagStyle;
    /** @type {?} */
    TagsComponent.prototype.activeTag;
    /** @type {?} */
    TagsComponent.prototype.addTagAble;
    /**
     * @type {?}
     * @private
     */
    TagsComponent.prototype.onChangeCallback;
    /**
     * @type {?}
     * @private
     */
    TagsComponent.prototype.onTouchedCallback;
    /** @type {?} */
    TagsComponent.prototype.localeService;
    /**
     * @type {?}
     * @private
     */
    TagsComponent.prototype.cd;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidGFncy5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZmFycmlzL3RhZ3MvIiwic291cmNlcyI6WyJsaWIvdGFncy5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUFBLE9BQU8sRUFBRSxTQUFTLEVBQVUsaUJBQWlCLEVBQUUsVUFBVSxFQUFFLEtBQUssRUFBRSxNQUFNLEVBQUUsWUFBWSxFQUFFLFNBQVMsRUFBRSxVQUFVLEVBQUUsaUJBQWlCLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFDeEosT0FBTyxFQUFFLGlCQUFpQixFQUFFLE1BQU0sZ0JBQWdCLENBQUM7QUFDbkQsT0FBTyxFQUFFLGFBQWEsRUFBRSxNQUFNLG1CQUFtQixDQUFDOzs7O0FBRWxELGtCQVNDOzs7SUFSQyxvQkFBYzs7SUFDZCxtQkFBWTs7SUFDWixzQkFBZ0I7O0lBQ2hCLG9CQUFjOztJQUNkLHVCQUFrQjs7SUFDbEIsc0JBQWlCOztJQUNqQixtQkFBYTs7SUFDYix3QkFBbUI7O0FBR3JCO0lBNEhFLHVCQUFtQixhQUE0QixFQUFTLEVBQXFCO1FBQTFELGtCQUFhLEdBQWIsYUFBYSxDQUFlO1FBQVMsT0FBRSxHQUFGLEVBQUUsQ0FBbUI7O1FBdEY3RSxhQUFRLEdBQVcsSUFBSSxDQUFDOztRQStCeEIsY0FBUyxHQUFXLElBQUksQ0FBQztRQVN6QixjQUFTLEdBQVcsS0FBSyxDQUFDO1FBd0IxQixpQkFBWSxHQUFHLElBQUksWUFBWSxFQUFPLENBQUM7UUFFdkMsYUFBUSxHQUFHLElBQUksWUFBWSxFQUFPLENBQUM7UUFFbkMsZ0JBQVcsR0FBRyxJQUFJLFlBQVksRUFBTyxDQUFDO1FBRXRDLFdBQU0sR0FBRyxJQUFJLFlBQVksRUFBTyxDQUFDO1FBSWpDLGFBQVEsR0FBVyxLQUFLLENBQUM7UUFDekIsZ0JBQVcsR0FBVSxFQUFFLENBQUM7UUFFeEIsZ0JBQVcsR0FBYyxFQUFFLENBQUM7UUFDNUIsY0FBUyxHQUFVLEVBQUUsQ0FBQzs7UUFJdEIs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QUEwQjs7SUFxQjFCLGtDQUNpQjs7SUFDakIscUNBQ3VDOztJQUN2QyxpQ0FDbUM7O0lBQ25DLG9DQUNzQzs7SUFDdEMsK0JBQ2lDOztJQUVqQyxxQ0FBb0Q7O0lBRXBELGlDQUF5Qjs7SUFDekIsb0NBQXdCOztJQUN4QixvQ0FBbUI7O0lBQ25CLG9DQUE0Qjs7SUFDNUIsa0NBQXNCOztJQUN0QixpQ0FBUzs7SUFDVCxrQ0FBaUI7O0lBRWpCLG1DQUEwQjs7Ozs7SUFDMUIseUNBQStDOzs7OztJQUMvQywwQ0FBZ0Q7O0lBRXBDLHNDQUFtQzs7Ozs7SUFBQywyQkFBNkIiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb21wb25lbnQsIE9uSW5pdCwgVmlld0VuY2Fwc3VsYXRpb24sIGZvcndhcmRSZWYsIElucHV0LCBPdXRwdXQsIEV2ZW50RW1pdHRlciwgVmlld0NoaWxkLCBFbGVtZW50UmVmLCBDaGFuZ2VEZXRlY3RvclJlZiB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBOR19WQUxVRV9BQ0NFU1NPUiB9IGZyb20gJ0Bhbmd1bGFyL2Zvcm1zJztcclxuaW1wb3J0IHsgTG9jYWxlU2VydmljZSB9IGZyb20gJ0BmYXJyaXMvdWktbG9jYWxlJztcclxuXHJcbmludGVyZmFjZSBUYWcge1xyXG4gIHZhbHVlPzpzdHJpbmc7XHJcbiAgbmFtZTpzdHJpbmc7XHJcbiAgdGFnVHlwZT86c3RyaW5nO1xyXG4gIGNvbG9yPzpzdHJpbmc7XHJcbiAgY2xvc2FibGU/OmJvb2xlYW47XHJcbiAgY2hlY2tlZD86Ym9vbGVhbjtcclxuICBzaXplPzpzdHJpbmc7XHJcbiAgY2hlY2thYmxlPzpib29sZWFuO1xyXG59XHJcblxyXG5AQ29tcG9uZW50KHtcclxuICBzZWxlY3RvcjogJ2ZhcnJpcy10YWdzJyxcclxuICB0ZW1wbGF0ZVVybDogJy4vdGFncy5jb21wb25lbnQuaHRtbCcsXHJcbiAgLy8gc3R5bGVVcmxzOiBbJy4vdGFncy5jb21wb25lbnQuc2NzcyddLFxyXG4gIGVuY2Fwc3VsYXRpb246IFZpZXdFbmNhcHN1bGF0aW9uLk5vbmUsXHJcbiAgcHJvdmlkZXJzOiBbXHJcbiAgICB7XHJcbiAgICAgIHByb3ZpZGU6IE5HX1ZBTFVFX0FDQ0VTU09SLFxyXG4gICAgICB1c2VFeGlzdGluZzogZm9yd2FyZFJlZigoKSA9PiBUYWdzQ29tcG9uZW50KSxcclxuICAgICAgbXVsdGk6IHRydWVcclxuICAgIH1cclxuICBdXHJcbn0pXHJcbmV4cG9ydCBjbGFzcyBUYWdzQ29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0IHtcclxuXHJcbiAgX2RhdGE6c3RyaW5nO1xyXG4gIEBJbnB1dCgpXHJcbiAgc2V0IGRhdGEodmFsKSB7XHJcbiAgICB0aGlzLl9kYXRhID0gdmFsO1xyXG4gICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgIHRoaXMudGFnSW5pdCh0aGlzLl9kYXRhKTtcclxuICAgIH0pO1xyXG4gIH1cclxuICBnZXQgZGF0YSgpIHtcclxuICAgIHJldHVybiB0aGlzLl9kYXRhO1xyXG4gIH1cclxuICBASW5wdXQoKSB2YWx1ZTpzdHJpbmc7XHJcbiAgLy/mmK/lkKbmlK/mjIFcclxuICBfY2hlY2thYmxlOmJvb2xlYW47XHJcbiAgQElucHV0KClcclxuICBzZXQgY2hlY2thYmxlKHZhbCkge1xyXG4gICAgdGhpcy5fY2hlY2thYmxlID0gdmFsO1xyXG4gICAgdGhpcy5jZC5kZXRlY3RDaGFuZ2VzKCk7XHJcbiAgfVxyXG4gIGdldCBjaGVja2FibGUoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5fY2hlY2thYmxlO1xyXG4gIH1cclxuICAvL+aYr+WQpuaUr+aMgea3u+WKoFxyXG4gIF9hZGRhYmxlOmJvb2xlYW4gPSB0cnVlO1xyXG4gIEBJbnB1dCgpXHJcbiAgc2V0IGFkZGFibGUodmFsKSB7XHJcbiAgICB0aGlzLl9hZGRhYmxlID0gdmFsO1xyXG4gICAgdGhpcy5hZGRUYWdBYmxlID0gdmFsO1xyXG4gIH1cclxuICBnZXQgYWRkYWJsZSgpIHtcclxuICAgIHJldHVybiB0aGlzLl9hZGRhYmxlO1xyXG4gIH1cclxuICAvL+exu+Wei1xyXG4gIF90YWdUeXBlOnN0cmluZztcclxuICBASW5wdXQoKVxyXG4gIHNldCB0YWdUeXBlKHZhbCkge1xyXG4gICAgdGhpcy5fdGFnVHlwZSA9IHZhbDtcclxuICAgIHRoaXMuY2QuZGV0ZWN0Q2hhbmdlcygpO1xyXG4gIH1cclxuICBnZXQgdGFnVHlwZSgpIHtcclxuICAgIHJldHVybiB0aGlzLl90YWdUeXBlO1xyXG4gIH1cclxuLy/oh6rlrprkuYnpopzoibJcclxuICBfY29sb3I6c3RyaW5nO1xyXG4gIEBJbnB1dCgpXHJcbiAgc2V0IGNvbG9yKHZhbCkge1xyXG4gICAgdGhpcy5fY29sb3IgPSB2YWw7XHJcbiAgICB0aGlzLnN0eWxlSW5pdCgpO1xyXG4gIH1cclxuICBnZXQgY29sb3IoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5fY29sb3I7XHJcbiAgfVxyXG5cclxuICAvL+aYr+WQpuaUr+aMgeWFs+mXrVxyXG4gIF9jbG9zYWJsZTpib29sZWFuID0gdHJ1ZTtcclxuICBASW5wdXQoKVxyXG4gIHNldCBjbG9zYWJsZSh2YWwpIHtcclxuICAgIHRoaXMuX2Nsb3NhYmxlID0gdmFsO1xyXG4gIH1cclxuICBnZXQgY2xvc2FibGUoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5fY2xvc2FibGU7XHJcbiAgfVxyXG5cclxuICBfcmVhZG9ubHk6Ym9vbGVhbiA9IGZhbHNlO1xyXG4gIEBJbnB1dCgpXHJcbiAgc2V0IHJlYWRvbmx5KHZhbCkge1xyXG4gICAgdGhpcy5fcmVhZG9ubHkgPSB2YWw7XHJcbiAgICBpZighdGhpcy5fcmVhZG9ubHkpe1xyXG4gICAgICB0aGlzLl9jbG9zYWJsZSA9IHRydWU7XHJcbiAgICAgIC8vIHRoaXMuX2FkZGFibGUgPSB0cnVlO1xyXG4gICAgICB0aGlzLmFkZFRhZ0FibGUgPSB0cnVlO1xyXG4gICAgfVxyXG4gICAgZWxzZXtcclxuICAgICAgdGhpcy5hY3RpdmVUYWcgPSAnJztcclxuICAgICAgdGhpcy5fY2xvc2FibGUgPSBmYWxzZTtcclxuICAgICAgLy8gdGhpcy5fYWRkYWJsZSA9IGZhbHNlO1xyXG4gICAgICB0aGlzLmFkZFRhZ0FibGUgPSBmYWxzZTtcclxuICAgIH1cclxuICAgIHRoaXMuY2QuZGV0ZWN0Q2hhbmdlcygpO1xyXG4gIH1cclxuICBnZXQgcmVhZG9ubHkoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5fcmVhZG9ubHk7XHJcbiAgfVxyXG5cclxuICBASW5wdXQoKVxyXG4gIGNsYXNzTmFtZTpzdHJpbmc7XHJcbiAgQE91dHB1dCgpXHJcbiAgY2hlY2tDaGFuZ2VkID0gbmV3IEV2ZW50RW1pdHRlcjxhbnk+KCk7XHJcbiAgQE91dHB1dCgpXHJcbiAgdGFnQ2xpY2sgPSBuZXcgRXZlbnRFbWl0dGVyPGFueT4oKTtcclxuICBAT3V0cHV0KClcclxuICBkYXRhQ2hhbmdlZCA9IG5ldyBFdmVudEVtaXR0ZXI8YW55PigpO1xyXG4gIEBPdXRwdXQoKVxyXG4gIGNsb3NlZCA9IG5ldyBFdmVudEVtaXR0ZXI8YW55PigpO1xyXG5cclxuICBAVmlld0NoaWxkKCdhZGRJbnB1dFRleHQnKSBhZGRJbnB1dFRleHQ6IEVsZW1lbnRSZWY7XHJcblxyXG4gIGFkZElucHV0OmJvb2xlYW4gPSBmYWxzZTtcclxuICBhZGRUYWdWYWx1ZTpzdHJpbmcgPSAnJztcclxuICBwbGFjZWhvbGRlcjpzdHJpbmc7XHJcbiAgY2hlY2tlZFRhZ3M6QXJyYXk8YW55PiA9IFtdO1xyXG4gIGlubmVyVGFnczogVGFnW10gPSBbXTtcclxuICB0YWdTdHlsZTtcclxuICBhY3RpdmVUYWc6c3RyaW5nO1xyXG4gIC8v5re75Yqg5oyJ6ZKu5piv5ZCm56aB55SoXHJcbiAgYWRkVGFnQWJsZTpib29sZWFuID0gdHJ1ZTtcclxuICBwcml2YXRlIG9uQ2hhbmdlQ2FsbGJhY2s6IEZ1bmN0aW9uID0gKCkgPT4geyB9O1xyXG4gIHByaXZhdGUgb25Ub3VjaGVkQ2FsbGJhY2s6IEZ1bmN0aW9uID0gKCkgPT4geyB9O1xyXG5cclxuICBjb25zdHJ1Y3RvcihwdWJsaWMgbG9jYWxlU2VydmljZTogTG9jYWxlU2VydmljZSxwcml2YXRlIGNkOiBDaGFuZ2VEZXRlY3RvclJlZikgeyB9XHJcblxyXG4gIG5nT25Jbml0KCkge1xyXG4gICAgaWYodGhpcy5fY2hlY2thYmxlKXtcclxuICAgICAgdGhpcy5fY2xvc2FibGUgPSBmYWxzZTtcclxuICAgIH1cclxuICAgIHRoaXMucGxhY2Vob2xkZXIgPSB0aGlzLmxvY2FsZVNlcnZpY2UuZ2V0VmFsdWUoJ3RhZy5wbGFjZWhvbGRlcicpO1xyXG4gIH1cclxuICB0YWdJbml0KGRhdGEpe1xyXG4gICAgdGhpcy5pbm5lclRhZ3MgPSBbXTtcclxuICAgIGlmKCFkYXRhKSByZXR1cm47XHJcbiAgICBsZXQgdGFnc0FycmF5ID0gZGF0YS5zcGxpdCgnLCcpO1xyXG4gICAgY29uc3QgdGFnc0RhdGEgPSB0YWdzQXJyYXkuZmlsdGVyKGl0ZW09PntcclxuICAgICAgaWYoaXRlbSAhPT0gJycpe1xyXG4gICAgICAgIHJldHVybiBpdGVtO1xyXG4gICAgICB9XHJcbiAgICB9KVxyXG4gICAgaWYodGFnc0RhdGEgJiYgdGFnc0RhdGEubGVuZ3RoKXtcclxuICAgICAgZm9yKGxldCBpID0gMDsgaTwgdGFnc0RhdGEubGVuZ3RoOyBpKyspe1xyXG4gICAgICAgIGxldCB0YWdkYXRhID0ge1xyXG4gICAgICAgICAgbmFtZTonJ1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGFnZGF0YS5uYW1lID0gdGFnc0RhdGFbaV07XHJcbiAgICAgICAgdGhpcy5pbm5lclRhZ3MucHVzaCh0YWdkYXRhKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgZWxzZXtcclxuICAgICAgdGhpcy5pbm5lclRhZ3MgPSBbXTtcclxuICAgIH1cclxuICB9XHJcbiAgLyoqXHJcbiAgICog54K55Ye75YWz6ZetXHJcbiAgICogQHBhcmFtIGUgZXZlbnRcclxuICAgKiBAcGFyYW0gdGFnIHRhZ1xyXG4gICAqIEBwYXJhbSBpbmRleCB0YWfntKLlvJVcclxuICAgKi9cclxuICBjbG9zZUhhbmRsZXIoZTogYW55LCB0YWcsIGluZGV4Om51bWJlcikge1xyXG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgdGhpcy5pbm5lclRhZ3Muc3BsaWNlKGluZGV4LDEpO1xyXG4gICAgY29uc3QgdGFnZGF0YSA9IHRoaXMudGFnUHJvY2Vzcyh0aGlzLmlubmVyVGFncyk7XHJcbiAgICB0aGlzLm9uQ2hhbmdlQ2FsbGJhY2sodGFnZGF0YSk7XHJcbiAgICB0aGlzLm9uVG91Y2hlZENhbGxiYWNrKCk7XHJcbiAgICB0aGlzLmNsb3NlZC5lbWl0KHRhZy5uYW1lKTtcclxuICAgIHRoaXMuZGF0YUNoYW5nZWQuZW1pdCh0YWdkYXRhKTtcclxuICB9XHJcbiAgLyoqXHJcbiAgICog54K55Ye7dGFnXHJcbiAgICogQHBhcmFtIGUgZXZlbnRcclxuICAgKiBAcGFyYW0gdGFnXHJcbiAgICovXHJcbiAgY2xpY2tIYW5kbGVyKGUsIHRhZyl7XHJcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICBpZih0aGlzLl9yZWFkb25seSkgcmV0dXJuO1xyXG4gICAgaWYodGhpcy5hY3RpdmVUYWcgIT0gdGFnWyduYW1lJ10pe1xyXG4gICAgICB0aGlzLmFjdGl2ZVRhZyA9IHRhZy5uYW1lO1xyXG4gICAgfVxyXG4gICAgdGhpcy50YWdDbGljay5lbWl0KHRhZy5uYW1lKTtcclxuICAgIGlmKCF0aGlzLl9jaGVja2FibGUpIHJldHVybjtcclxuICAgIGlmKHRhZy5oYXNPd25Qcm9wZXJ0eSgnY2hlY2tlZCcpKXtcclxuICAgICAgdGFnLmNoZWNrZWQgPSAhdGFnLmNoZWNrZWQ7XHJcbiAgICB9XHJcbiAgICBlbHNle1xyXG4gICAgICB0YWcuY2hlY2tlZCA9IHRydWU7XHJcbiAgICB9XHJcbiAgICB0aGlzLmNoZWNrZWRUYWdzID0gdGhpcy5pbm5lclRhZ3MuZmlsdGVyKChkYXRhKT0+e1xyXG4gICAgICByZXR1cm4gZGF0YS5jaGVja2VkO1xyXG4gICAgfSk7XHJcbiAgICBjb25zdCB0YWdkYXRhID0gdGhpcy50YWdQcm9jZXNzKHRoaXMuaW5uZXJUYWdzKTtcclxuICAgIHRoaXMub25DaGFuZ2VDYWxsYmFjayh0YWdkYXRhKTtcclxuICAgIHRoaXMub25Ub3VjaGVkQ2FsbGJhY2soKTtcclxuXHJcbiAgICBjb25zdCBDaGVja0NoYW5nZWREYXRhID0ge1xyXG4gICAgICBkYXRhOiB0YWdkYXRhLFxyXG4gICAgICB0YWc6IHRhZy5uYW1lLFxyXG4gICAgICBjaGVja2VkOiB0aGlzLnRhZ1Byb2Nlc3ModGhpcy5jaGVja2VkVGFncylcclxuICAgIH07XHJcbiAgICB0aGlzLmNoZWNrQ2hhbmdlZC5lbWl0KENoZWNrQ2hhbmdlZERhdGEpO1xyXG4gIH1cclxuICAvKipcclxuICAgKiDngrnlh7vmt7vliqB0YWfmjInpkq5cclxuICAgKi9cclxuICBhZGRIYW5kZXIoKXtcclxuICAgIGlmKCF0aGlzLl9hZGRhYmxlIHx8ICF0aGlzLmFkZFRhZ0FibGUpIHJldHVybjtcclxuICAgIHRoaXMuYWRkSW5wdXQgPSB0cnVlO1xyXG4gICAgdGhpcy5hZGRUYWdWYWx1ZSA9ICcnO1xyXG4gICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgIHRoaXMuYWRkSW5wdXRUZXh0Lm5hdGl2ZUVsZW1lbnQuZm9jdXMoKTtcclxuICAgIH0pO1xyXG4gIH1cclxuICAvKipcclxuICAgKiDmt7vliqB0YWflpLHljrvnhKbngrlcclxuICAgKi9cclxuICBhZGRJbnB1dEJsdXIoZXZlbnQpe1xyXG4gICAgaWYoIXRoaXMuX2FkZGFibGUgfHwgIXRoaXMuYWRkSW5wdXQpIHJldHVybjtcclxuICAgIGlmKHRoaXMuYWRkVGFnVmFsdWUpe1xyXG4gICAgICBjb25zdCBoYXN0YWcgPSB0aGlzLmlubmVyVGFncy5maW5kKHRhZyA9PiB7XHJcbiAgICAgICAgcmV0dXJuIHRhZy5uYW1lID09IHRoaXMuYWRkVGFnVmFsdWU7XHJcbiAgICAgIH0pO1xyXG4gICAgICBpZihoYXN0YWcpe1xyXG4gICAgICAgIHRoaXMuYWRkSW5wdXQgPSBmYWxzZTtcclxuICAgICAgICByZXR1cm47XHJcbiAgICAgIH1cclxuICAgICAgZWxzZXtcclxuICAgICAgICBjb25zdCB0YWcgPSB7bmFtZTogdGhpcy5hZGRUYWdWYWx1ZX07XHJcbiAgICAgICAgdGhpcy5pbm5lclRhZ3MucHVzaCh0YWcpO1xyXG4gICAgICAgIGNvbnN0IHRhZ2RhdGEgPSB0aGlzLnRhZ1Byb2Nlc3ModGhpcy5pbm5lclRhZ3MpO1xyXG4gICAgICAgIHRoaXMuZGF0YUNoYW5nZWQuZW1pdCh0aGlzLnRhZ1Byb2Nlc3ModGhpcy5pbm5lclRhZ3MpKTtcclxuICAgICAgICB0aGlzLm9uQ2hhbmdlQ2FsbGJhY2sodGFnZGF0YSk7XHJcbiAgICAgICAgdGhpcy5vblRvdWNoZWRDYWxsYmFjaygpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICB0aGlzLmFkZElucHV0ID0gZmFsc2U7XHJcbiAgfVxyXG5cclxuICB3cml0ZVZhbHVlKHZhbDpzdHJpbmcpOiB2b2lkIHtcclxuICAgIHRoaXMuX2RhdGEgPSB2YWw7XHJcbiAgICB0aGlzLnRhZ0luaXQodGhpcy5fZGF0YSk7XHJcbiAgfVxyXG5cclxuICByZWdpc3Rlck9uQ2hhbmdlKGZuOiBhbnkpOiB2b2lkIHtcclxuICAgIHRoaXMub25DaGFuZ2VDYWxsYmFjayA9IGZuO1xyXG4gIH1cclxuICByZWdpc3Rlck9uVG91Y2hlZChmbjogYW55KTogdm9pZCB7XHJcbiAgICB0aGlzLm9uVG91Y2hlZENhbGxiYWNrID0gZm47XHJcbiAgfVxyXG5cclxuICB0YWdQcm9jZXNzKGRhdGEpIHtcclxuICAgIGlmKGRhdGEgJiYgZGF0YS5sZW5ndGgpe1xyXG4gICAgICBsZXQgdGFnUHJvY2Vzc0RhdGEgPSBbXTtcclxuICAgICAgZGF0YS5mb3JFYWNoKHRhZyA9PiB7XHJcbiAgICAgICAgdGFnUHJvY2Vzc0RhdGEucHVzaCh0YWcubmFtZSk7XHJcbiAgICAgIH0pO1xyXG4gICAgICByZXR1cm4gdGFnUHJvY2Vzc0RhdGEuam9pbignLCcpO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgIHJldHVybiAnJztcclxuICAgIH1cclxuICB9XHJcbiAvL+aUueWPmOmAj+aYjuW6plxyXG4gIGhleFRvUmdiYShoZXgsIG9wYWNpdHkgPSAxKSB7XHJcbiAgICBjb25zdCByZWcgPSAvXiMoWzAtOWEtZkEtZl17M318WzAtOWEtZkEtZl17Nn0pJC87XHJcbiAgICB2YXIgc0NvbG9yID0gaGV4LnRvTG93ZXJDYXNlKCk7XHJcbiAgICBpZihzQ29sb3IgJiYgcmVnLnRlc3Qoc0NvbG9yKSl7XHJcbiAgICAgICAgaWYoc0NvbG9yLmxlbmd0aCA9PT0gNCl7XHJcbiAgICAgICAgICAgIHZhciBzQ29sb3JOZXcgPSBcIiNcIjtcclxuICAgICAgICAgICAgICAgIGZvcih2YXIgaT0xOyBpPDQ7IGkrPTEpe1xyXG4gICAgICAgICAgICAgICAgICAgIHNDb2xvck5ldyArPSBzQ29sb3Iuc2xpY2UoaSxpKzEpLmNvbmNhdChzQ29sb3Iuc2xpY2UoaSxpKzEpKTsgICAgICAgXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBzQ29sb3IgPSBzQ29sb3JOZXc7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8v5aSE55CG5YWt5L2N55qE6aKc6Imy5YC8XHJcbiAgICAgICAgdmFyIHNDb2xvckNoYW5nZSA9IFtdO1xyXG4gICAgICAgIGZvcih2YXIgaT0xOyBpPDc7IGkrPTIpe1xyXG4gICAgICAgICAgICBzQ29sb3JDaGFuZ2UucHVzaChwYXJzZUludChcIjB4XCIrc0NvbG9yLnNsaWNlKGksaSsyKSkpOyAgICAgICBcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIFwiUkdCKFwiICsgc0NvbG9yQ2hhbmdlLmpvaW4oXCIsXCIpICsgJywnICsgb3BhY2l0eSArIFwiKVwiO1xyXG4gICAgfWVsc2V7XHJcbiAgICAgICAgcmV0dXJuIHNDb2xvcjsgICAgICAgXHJcbiAgICB9fVxyXG4gIHN0eWxlSW5pdCgpIHtcclxuICAgIGlmKHRoaXMuY29sb3Ipe1xyXG4gICAgICB0aGlzLnRhZ1N0eWxlID0ge1xyXG4gICAgICAgIGNvbG9yOiB0aGlzLl9jb2xvcixcclxuICAgICAgICBiYWNrZ3JvdW5kOiB0aGlzLl9jb2xvcj8gdGhpcy5oZXhUb1JnYmEodGhpcy5fY29sb3IsMC4xKTonJyxcclxuICAgICAgICBib3JkZXJDb2xvcjogdGhpcy5fY29sb3JcclxuICAgICAgfTtcclxuICAgIH1cclxuICAgIGVsc2V7XHJcbiAgICAgIHRoaXMudGFnU3R5bGUgPSAnJztcclxuICAgIH1cclxuICAgIHRoaXMuY2QuZGV0ZWN0Q2hhbmdlcygpO1xyXG4gIH1cclxufVxyXG4iXX0=