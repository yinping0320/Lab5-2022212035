!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("@angular/common"),require("@angular/forms"),require("@farris/ui-locale")):"function"==typeof define&&define.amd?define("@farris/tags",["exports","@angular/core","@angular/common","@angular/forms","@farris/ui-locale"],t):t((e.farris=e.farris||{},e.farris.tags={}),e.ng.core,e.ng.common,e.ng.forms,e.uiLocale)}(this,function(e,a,t,n,i){"use strict";var r=(s.decorators=[{type:a.Injectable,args:[{providedIn:"root"}]}],s.ctorParameters=function(){return[]},s.ngInjectableDef=a.defineInjectable({factory:function(){return new s},token:s,providedIn:"root"}),s);function s(){}var o=(Object.defineProperty(c.prototype,"data",{get:function(){return this._data},set:function(e){var t=this;this._data=e,setTimeout(function(){t.tagInit(t._data)})},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"checkable",{get:function(){return this._checkable},set:function(e){this._checkable=e,this.cd.detectChanges()},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"addable",{get:function(){return this._addable},set:function(e){this._addable=e,this.addTagAble=e},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"tagType",{get:function(){return this._tagType},set:function(e){this._tagType=e,this.cd.detectChanges()},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"color",{get:function(){return this._color},set:function(e){this._color=e,this.styleInit()},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"closable",{get:function(){return this._closable},set:function(e){this._closable=e},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"readonly",{get:function(){return this._readonly},set:function(e){this._readonly=e,this._readonly?(this.activeTag="",this._closable=!1,this.addTagAble=!1):(this._closable=!0,this.addTagAble=!0),this.cd.detectChanges()},enumerable:!0,configurable:!0}),c.prototype.ngOnInit=function(){this._checkable&&(this._closable=!1),this.placeholder=this.localeService.getValue("tag.placeholder")},c.prototype.tagInit=function(e){if(this.innerTags=[],e){var t=e.split(",").filter(function(e){if(""!==e)return e});if(t&&t.length)for(var a=0;a<t.length;a++){var n={name:""};n.name=t[a],this.innerTags.push(n)}else this.innerTags=[]}},c.prototype.closeHandler=function(e,t,a){e.preventDefault(),this.innerTags.splice(a,1);var n=this.tagProcess(this.innerTags);this.onChangeCallback(n),this.onTouchedCallback(),this.closed.emit(t.name),this.dataChanged.emit(n)},c.prototype.clickHandler=function(e,t){if(e.preventDefault(),!this._readonly&&(this.activeTag!=t.name&&(this.activeTag=t.name),this.tagClick.emit(t.name),this._checkable)){t.hasOwnProperty("checked")?t.checked=!t.checked:t.checked=!0,this.checkedTags=this.innerTags.filter(function(e){return e.checked});var a=this.tagProcess(this.innerTags);this.onChangeCallback(a),this.onTouchedCallback();var n={data:a,tag:t.name,checked:this.tagProcess(this.checkedTags)};this.checkChanged.emit(n)}},c.prototype.addHander=function(){var e=this;this._addable&&this.addTagAble&&(this.addInput=!0,this.addTagValue="",setTimeout(function(){e.addInputText.nativeElement.focus()}))},c.prototype.addInputBlur=function(e){var t=this;if(this._addable&&this.addInput){if(this.addTagValue){if(this.innerTags.find(function(e){return e.name==t.addTagValue}))return void(this.addInput=!1);var a={name:this.addTagValue};this.innerTags.push(a);var n=this.tagProcess(this.innerTags);this.dataChanged.emit(this.tagProcess(this.innerTags)),this.onChangeCallback(n),this.onTouchedCallback()}this.addInput=!1}},c.prototype.writeValue=function(e){this._data=e,this.tagInit(this._data)},c.prototype.registerOnChange=function(e){this.onChangeCallback=e},c.prototype.registerOnTouched=function(e){this.onTouchedCallback=e},c.prototype.tagProcess=function(e){if(e&&e.length){var t=[];return e.forEach(function(e){t.push(e.name)}),t.join(",")}return""},c.prototype.hexToRgba=function(e,t){void 0===t&&(t=1);var a=e.toLowerCase();if(a&&/^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/.test(a)){if(4===a.length){for(var n="#",i=1;i<4;i+=1)n+=a.slice(i,i+1).concat(a.slice(i,i+1));a=n}var r=[];for(i=1;i<7;i+=2)r.push(parseInt("0x"+a.slice(i,i+2)));return"RGB("+r.join(",")+","+t+")"}return a},c.prototype.styleInit=function(){this.color?this.tagStyle={color:this._color,background:this._color?this.hexToRgba(this._color,.1):"",borderColor:this._color}:this.tagStyle="",this.cd.detectChanges()},c.decorators=[{type:a.Component,args:[{selector:"farris-tags",template:'<div [class]="\'farris-tags \'+ (className?className:\'\')" [ngClass]="{\'farris-tags-checkable\': checkable}">\r\n    <ul class="farris-tags-item-container">\r\n        <li\r\n        *ngFor="let tag of innerTags;let index = index;"\r\n        [class]="\'farris-tag-item\' + (tagType?\' farris-tag-item-\' + tagType:\'\')"\r\n        [ngClass]="{\'farris-tag-item-checked\': checkable && tag.checked,\r\n        \'farris-tag-item-checkable\': checkable, \r\n        \'farris-tag-item-has-color\': color,\r\n        \'farris-tag-item-actived\':activeTag == tag.name}"\r\n        (click)="clickHandler($event,tag)"\r\n        [ngStyle]="tagStyle"\r\n        >\r\n            <span class="tag-box">{{tag.name}}</span>\r\n            <span class="tag-delete" *ngIf="closable">\r\n                <i class="f-icon f-icon-close" (click)="closeHandler($event,tag,index)"></i>\r\n            </span>\r\n        </li>\r\n        <li class="farris-tag-item farris-tag-add-button" [ngClass]="{\'farris-tag-add-button-disabled\': !addTagAble}" *ngIf="addable && !addInput" (click)="addHander()">\r\n            <span class="f-icon f-icon-amplification"></span>\r\n            <span class="farris-tag-add-text">{{ \'tag.addText\' | locale }}</span>\r\n        </li>\r\n        <li class="farris-tag-input-box" *ngIf="addable && addInput">\r\n            <input type="text" class="form-control" (blur)="addInputBlur($event)" (keyup.enter)="addInputBlur($event)" #addInputText [(ngModel)]="addTagValue" [placeholder]="placeholder">\r\n        </li>\r\n    </ul>\r\n</div>',encapsulation:a.ViewEncapsulation.None,providers:[{provide:n.NG_VALUE_ACCESSOR,useExisting:a.forwardRef(function(){return c}),multi:!0}]}]}],c.ctorParameters=function(){return[{type:i.LocaleService},{type:a.ChangeDetectorRef}]},c.propDecorators={data:[{type:a.Input}],value:[{type:a.Input}],checkable:[{type:a.Input}],addable:[{type:a.Input}],tagType:[{type:a.Input}],color:[{type:a.Input}],closable:[{type:a.Input}],readonly:[{type:a.Input}],className:[{type:a.Input}],checkChanged:[{type:a.Output}],tagClick:[{type:a.Output}],dataChanged:[{type:a.Output}],closed:[{type:a.Output}],addInputText:[{type:a.ViewChild,args:["addInputText"]}]},c);function c(e,t){this.localeService=e,this.cd=t,this._addable=!0,this._closable=!0,this._readonly=!1,this.checkChanged=new a.EventEmitter,this.tagClick=new a.EventEmitter,this.dataChanged=new a.EventEmitter,this.closed=new a.EventEmitter,this.addInput=!1,this.addTagValue="",this.checkedTags=[],this.innerTags=[],this.addTagAble=!0,this.onChangeCallback=function(){},this.onTouchedCallback=function(){}}var l=(d.decorators=[{type:a.NgModule,args:[{declarations:[o],imports:[t.CommonModule,n.FormsModule,i.LocaleModule.forRoot()],exports:[o]}]}],d);function d(){}e.TagsService=r,e.TagsComponent=o,e.TagsModule=l,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=farris-tags.umd.min.js.map