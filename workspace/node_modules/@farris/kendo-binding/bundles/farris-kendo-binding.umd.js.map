{"version":3,"file":"farris-kendo-binding.umd.js.map","sources":["ng://@farris/kendo-binding/lib/converters/array_converter.ts","ng://@farris/kendo-binding/lib/converters/date_converter.ts","ng://@farris/kendo-binding/lib/converters/multi_lang_converter.ts","ng://@farris/kendo-binding/lib/converters/filter_conditions_converter.ts","node_modules/tslib/tslib.es6.js","ng://@farris/kendo-binding/lib/format/datatable-kendogrid-format.ts","ng://@farris/kendo-binding/lib/format/treetable-format.ts","ng://@farris/kendo-binding/lib/format/string-to-date.pipe.ts","ng://@farris/kendo-binding/lib/format/kendogrid-filter.ts","ng://@farris/kendo-binding/lib/format/dateformat-placeholder.pipe.ts","ng://@farris/kendo-binding/lib/format/kendogrid-group.pipe.ts","ng://@farris/kendo-binding/lib/directives/grid-summary.directive.ts","ng://@farris/kendo-binding/lib/util/multi_select_grid_utility.ts","ng://@farris/kendo-binding/lib/entity/selected_row_context.ts","ng://@farris/kendo-binding/lib/directives/kendo_grid_binding.directive.ts","ng://@farris/kendo-binding/lib/directives/tree_table_node_builder/path_tree_node_builder.ts","ng://@farris/kendo-binding/lib/directives/tree_table_node_builder/parent_tree_node_builder.ts","ng://@farris/kendo-binding/lib/directives/tree_table_node_builder/tree_node_builder_factory.ts","ng://@farris/kendo-binding/lib/directives/farris_tree_table_binding.directive.ts","ng://@farris/kendo-binding/lib/directives/data-mapping.ts","ng://@farris/kendo-binding/lib/directives/lookup-data-mapping.directive.ts","ng://@farris/kendo-binding/lib/directives/lookup-enable-extend-load-method.directive.ts","ng://@farris/kendo-binding/lib/directives/uistate-binding.directive.ts","ng://@farris/kendo-binding/lib/directives/farris-kendogrid-disabled.directive.ts","ng://@farris/kendo-binding/lib/directives/farris-sort.directive.ts","ng://@farris/kendo-binding/lib/directives/farris-datagrid/farris-datagrid-use-binding-data.directive.ts","ng://@farris/kendo-binding/lib/directives/multi-select-data-mapping.directive.ts","ng://@farris/kendo-binding/lib/directives/list-view/farris_listview_binding.directive.ts","ng://@farris/kendo-binding/lib/directives/farris-datagrid/editable.directive.ts","ng://@farris/kendo-binding/lib/directives/end-edit/abstract_end_edit.ts","ng://@farris/kendo-binding/lib/directives/end-edit/input_end_edit.directive.ts","ng://@farris/kendo-binding/lib/directives/end-edit/farris_data_grid_end_edit.directive.ts","ng://@farris/kendo-binding/lib/directives/end-edit/html_editor_end_edit.directive.ts","ng://@farris/kendo-binding/lib/directives/end-edit/kendo_grid_end_edit.directive.ts","ng://@farris/kendo-binding/lib/directives/farris-datagrid/remote-summary.directive.ts","ng://@farris/kendo-binding/lib/directives/farris-set-focus.directive.ts","ng://@farris/kendo-binding/lib/directives/file-preview/farris-file-preview-binding.directive.ts","ng://@farris/kendo-binding/lib/directives/discussion-group/farris_discussion_editor_binding.directive.ts","ng://@farris/kendo-binding/lib/directives/discussion-group/farris_discussion_list_binding.directive.ts","ng://@farris/kendo-binding/lib/directives/primeng-tree-grid/FarrisPrimengTreeTableBindingDirective.ts","ng://@farris/kendo-binding/lib/directives/dynamic_validate/farris_dynamic_validate.directive.ts","ng://@farris/kendo-binding/lib/directives/farris_editor.directive.ts","ng://@farris/kendo-binding/lib/directives/farris_querysolution_event_bind.directive.ts","ng://@farris/kendo-binding/lib/directives/localization/farris_date_localization.directive.ts","ng://@farris/kendo-binding/lib/directives/localization/farris_number_localization.directive.ts","ng://@farris/kendo-binding/lib/directives/localization/farris_time_localization.directive.ts","ng://@farris/kendo-binding/lib/directives/localization/farris_text_localization.directive.ts","ng://@farris/kendo-binding/lib/directives/farris_checkbox_modification.directive.ts","ng://@farris/kendo-binding/lib/directives/farris_label_modification.directive.ts","ng://@farris/kendo-binding/lib/directives/farris_lookup_binding.directive.ts","ng://@farris/kendo-binding/lib/directives/component-ref/component-ref.ts","ng://@farris/kendo-binding/lib/directives/component-ref/list-nav-component-ref.directive.ts","ng://@farris/kendo-binding/lib/directives/component-ref/list-view-component-ref.directive.ts","ng://@farris/kendo-binding/lib/directives/component-ref/list-filter-component-ref.directive.ts","ng://@farris/kendo-binding/lib/directives/component-ref/filter-component-ref.directive.ts","ng://@farris/kendo-binding/lib/directives/component-ref/view-change-component-ref.directive.ts","ng://@farris/kendo-binding/lib/directives/component-ref/html-editor-component-ref.directive.ts","ng://@farris/kendo-binding/lib/directives/component-ref/section-component-ref.directive.ts","ng://@farris/kendo-binding/lib/directives/component-ref/input-group-component-ref.directive.ts","ng://@farris/kendo-binding/lib/directives/component-ref/datepicker-component-ref.directive.ts","ng://@farris/kendo-binding/lib/directives/component-ref/time-picker-component-ref.directive.ts","ng://@farris/kendo-binding/lib/directives/component-ref/number-spinner-component-ref.directive.ts","ng://@farris/kendo-binding/lib/directives/component-ref/combo-list-component-ref.directive.ts","ng://@farris/kendo-binding/lib/directives/component-ref/combo-lookup-component-ref.directive.ts","ng://@farris/kendo-binding/lib/directives/component-ref/lookup-grid-component-ref.directive.ts","ng://@farris/kendo-binding/lib/directives/component-ref/datagrid-component-ref.directive.ts","ng://@farris/kendo-binding/lib/directives/component-ref/treetable-component-ref.directive.ts","ng://@farris/kendo-binding/lib/directives/component-ref/wizard-component-ref.directive.ts","ng://@farris/kendo-binding/lib/directives/component-ref/discussion-editor-component-ref.directive.ts","ng://@farris/kendo-binding/lib/directives/component-ref/discussion-list-component-ref.directive.ts","ng://@farris/kendo-binding/lib/directives/component-ref/nav-component-ref.directive.ts","ng://@farris/kendo-binding/lib/directives/component-ref/multi-select-component-ref.directive.ts","ng://@farris/kendo-binding/lib/directives/component-ref/scrollspy-component-ref.directive.ts","ng://@farris/kendo-binding/lib/directives/combo-lookup-data-mapping.directive.ts","ng://@farris/kendo-binding/lib/directives/appointment-calendar/types.ts","ng://@farris/kendo-binding/lib/directives/appointment-calendar/appointment-calendar-binding.directive.ts","ng://@farris/kendo-binding/lib/directives/farris-datagrid/custom-size.directive.ts","ng://@farris/kendo-binding/lib/directives/farris-filter/farris_filter_binding.directive.ts","ng://@farris/kendo-binding/lib/directives/farris-list-filter/farris_list_filter_binding.directive.ts","ng://@farris/kendo-binding/lib/pipes/image-id-to-url.pipe.ts","ng://@farris/kendo-binding/lib/pipes/formatPrimeNgTreeTableCellData.ts","ng://@farris/kendo-binding/lib/pipes/localization.pipe.ts","ng://@farris/kendo-binding/lib/kendo_binding_module.ts","ng://@farris/kendo-binding/farris-kendo-binding.ts"],"sourcesContent":["import { ControlValueConverter } from '@farris/devkit';\r\n\r\nclass ArrayConverter implements ControlValueConverter {\r\n\r\n  constructor(private separator: string = ',') {\r\n  }\r\n\r\n  convertFrom(value: string): string[] {\r\n    return value.split(this.separator);\r\n  }\r\n\r\n  convertTo(value: string[]): string {\r\n    return value.join(this.separator);\r\n  }\r\n}\r\n\r\nexport { ArrayConverter };\r\n","/*\r\n * @Author: Witt\r\n * @Date: 2018-10-29 10:26:58\r\n * @Last Modified by: Witt\r\n * @Last Modified time: 2018-10-29 15:49:12\r\n */\r\nimport { ControlValueConverter, DateUtil } from '@farris/devkit';\r\n\r\n/**\r\n * æ¥æè½¬æ¢å¨\r\n */\r\nclass DateConverter implements ControlValueConverter {\r\n\r\n  /**\r\n   * æé å½æ°\r\n   * @param format æ¥ææ ¼å¼\r\n   */\r\n  constructor(private format: string) {\r\n  }\r\n\r\n  /**\r\n   * å­ç¬¦ä¸²=> æ¥æ\r\n   * @param value å¾è½¬æ¢çå¼\r\n   */\r\n  convertFrom(value: string): Date {\r\n    if (DateUtil.isEmptyDateString(value) === true) {\r\n      return null;\r\n    }\r\n\r\n    return DateUtil.parse(value);\r\n  }\r\n\r\n  /**\r\n   * æ¥æ=>å­ç¬¦ä¸²\r\n   * @param value\r\n   */\r\n  convertTo(value: Date): string | any {\r\n    if (!value) {\r\n      return null;\r\n    }\r\n    // å¦ævalueä¸æ¯æ¥æç±»åï¼åä¸åå¤çï¼è¿ååå§value\r\n    if (Object.prototype.toString.call(value) !== '[object Date]') {\r\n      return value;\r\n    }\r\n    // å¹´\r\n    let year = value.getFullYear().toString();\r\n    year = year.length < 4 ? '0'.repeat(4 - year.length) + year : year;\r\n    // æ\r\n    let month = (value.getMonth() + 1).toString();\r\n    month = month.length === 1 ? ('0' + month) : month;\r\n\r\n    // æ¥\r\n    let day = value.getDate().toString();\r\n    day = day.length === 1 ? ('0' + day) : day;\r\n\r\n    // æ¶åç§\r\n    let hours = value.getHours().toString();\r\n    hours = hours.length === 1 ? ('0' + hours) : hours;\r\n\r\n    let minutes = value.getMinutes().toString();\r\n    minutes = minutes.length === 1 ? ('0' + minutes) : minutes;\r\n\r\n    let seconds = value.getSeconds().toString();\r\n    seconds = seconds.length === 1 ? ('0' + seconds) : seconds;\r\n    return `${year}-${month}-${day} ${hours}:${minutes}:${seconds}`;\r\n  }\r\n}\r\nexport { DateConverter };\r\n","/*\r\n * @Author: Witt\r\n * @Date: 2018-10-29 10:26:58\r\n * @Last Modified by: Witt\r\n * @Last Modified time: 2018-10-29 15:49:12\r\n */\r\nimport { ControlValueConverter } from '@farris/devkit';\r\n\r\n/**\r\n * å¤è¯­è¨è½¬æ¢å¨\r\n */\r\nclass MultiLangConverter implements ControlValueConverter {\r\n\r\n  /**\r\n   * æé å½æ°\r\n   */\r\n  constructor() {\r\n  }\r\n\r\n  /**\r\n   * å°æ°æ®æºä¸­çåå§å¼=>å¤è¯­æ§ä»¶è¯å«çå¯¹è±¡å¼\r\n   */\r\n  public convertFrom(value: string): any {\r\n    const multiLangControlValue = Object.assign({}, value);\r\n    return multiLangControlValue;\r\n  }\r\n\r\n  /**\r\n   * å¤è¯­æ§ä»¶è¯å«çå¯¹è±¡å¼=>å°æ°æ®æºä¸­çåå§å¼\r\n   */\r\n  public convertTo(multiLangControlValue: any): any {\r\n    const value = multiLangControlValue;\r\n    return value;\r\n  }\r\n\r\n}\r\nexport { MultiLangConverter };\r\n","import { ControlValueConverter } from '@farris/devkit';\r\n\r\nclass FilterConditionsConverter implements ControlValueConverter {\r\n\r\n  constructor() {\r\n  }\r\n\r\n  convertFrom(conditionsString: string): any[] {\r\n    if (!conditionsString) {\r\n      return [];\r\n    }\r\n    return JSON.parse(conditionsString);\r\n  }\r\n\r\n  convertTo(conditions: any[]): string {\r\n    return JSON.stringify(conditions);\r\n  }\r\n}\r\n\r\nexport { FilterConditionsConverter };\r\n","/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport function __exportStar(m, exports) {\r\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\n\r\nexport function __values(o) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator], i = 0;\r\n    if (m) return m.call(o);\r\n    return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n    result.default = mod;\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { DateTimeHelperService } from '@farris/ui-common/date';\r\nimport { NumberHelperService } from '@farris/ui-common/number';\r\nimport { DateUtil } from '@farris/devkit';\r\n\r\n@Injectable()\r\nclass FarrisKendoGridFormatService {\r\n    constructor(private dateService: DateTimeHelperService, private numberService: NumberHelperService) {\r\n    }\r\n\r\n    /**\r\n     * åæ ¼å¼å æ¹æ³\r\n     * @param dataItem  è¡æ°æ®\r\n     * @param column åå¯¹è±¡\r\n     */\r\n    getColumnFormat(dataItem: any, column: any) {\r\n        const value = this.getValue(dataItem, column['dataField']);\r\n        // æ²¡æè®¾ç½®è¡ç¼è¾å¨\r\n        const type = column['dataType'];\r\n        if (type === 'enum') {\r\n            return this.getEnumText(value, column);\r\n        } else if (type === 'boolean') {\r\n            return value ? 'æ¯' : 'å¦';\r\n        } else if (type === 'date') {\r\n            return this.getFormatDate(value, column);\r\n        } else if (type === 'number') {\r\n            return this.getFormatNumber(value, column);\r\n        } else {\r\n            // æ ¼å¼åå¤è¡ææ¬  åstring\r\n            return this.getMultiText(value, column);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * æ ¹æ®idè·åvalue\r\n     * @param dataItem  è¡æ°æ®\r\n     * @param field id,ä¹å¯è½æ¯name.Nameè¿ç§å½¢å¼(å³èå¯¹è±¡idæèudt)\r\n     */\r\n    private getValue(dataItem: any, field: string) {\r\n        const index = field.indexOf('.');\r\n        if (index < 0) {\r\n            return dataItem[field];\r\n        }\r\n        const fields = field.split('.');\r\n        // fieldå­ç¬¦ä¸²ç»å\r\n        const a = fields.reduce((result: any, next: any) => {\r\n            return result[next];\r\n        }, dataItem);\r\n        return a;\r\n    }\r\n\r\n    /**\r\n     * æä¸¾å¼æ ¼å¼å\r\n     */\r\n    private getEnumText(value: any, column: any) {\r\n        const enumData = (column as any).enumData;\r\n        if (!enumData) {\r\n            return;\r\n        }\r\n        let tempColumnText: any;\r\n        enumData.forEach((ele: any) => {\r\n            if (ele.value === value) {\r\n                tempColumnText = ele.name;\r\n            }\r\n        });\r\n        return tempColumnText;\r\n    }\r\n\r\n    /**\r\n     * æ¥ææ ¼å¼å\r\n     * @param value  ååæ ¼å¼\r\n     * @param column åå¯¹è±¡\r\n     */\r\n    public getFormatDate(value: string, column: any): string {\r\n\r\n        if (DateUtil.isEmptyDateString(value) === true) {\r\n          return '';\r\n        }\r\n\r\n        const dateFormat = (column as any).format;\r\n        if (!dateFormat) {\r\n            return value;\r\n        }\r\n        return this.dateService.formatTo(value, dateFormat);\r\n    }\r\n\r\n    /**\r\n     * æ°å­æ ¼å¼å\r\n     * @param value  ååæ ¼å¼\r\n     * @param column åå¯¹è±¡\r\n     * @todo æ°å­æ ¼å¼åè¿ä¸å®å  è¿ä¸ªåªæ¯éé¢å½¢å¼çæ ¼å¼å;   åå§åvalue===nullæ¶,åºè¯¥æ¾ç¤ºä¸º'' è¿ä¸ªè¿æ²¡æ\r\n     */\r\n    private getFormatNumber(value: any, column: any) {\r\n        let precision;\r\n        if (column && column.format) {\r\n            precision = parseInt(column.format.substr(1), 10);\r\n        } else if (column && column.editor) {\r\n            precision = column.editor.precision;\r\n        }\r\n        if (isNaN(precision)) {\r\n            precision = 2;\r\n        }\r\n        if (!value && value !== 0) {\r\n            return '';\r\n        }\r\n\r\n        const opts = {\r\n            prefix: column.prefix ? column.prefix : '',\r\n            suffix: column.suffix ? column.suffix : '',\r\n            precision: precision,\r\n            thousand: ',',\r\n            stripZeros: false,\r\n        };\r\n        return this.numberService.formatMoney(value, opts);\r\n    }\r\n\r\n    /**\r\n     * å¤è¡ææ¬æ ¼å¼å shift+enteræ¢è¡  å¤±å»ç¦ç¹ä¿çåæ ¼å¼\r\n     * @param value  ååæ ¼å¼\r\n     * @param column åå¯¹è±¡\r\n     */\r\n    private getMultiText(value: any, column: any) {\r\n        let strValue = value;\r\n        if (strValue !== '' && !strValue) {\r\n            strValue = '';\r\n        }\r\n        if (typeof strValue !== 'string') {\r\n            const valueType = typeof strValue;\r\n            throw new Error(`${valueType}ç±»åå¼ä¸åæ³ï¼æ æ³è¿è¡æ ¼å¼å`);\r\n        }\r\n        // é²æ­¢xss\r\n        strValue = strValue.replace(/&/g, '&amp;')\r\n            .replace(/</g, '&lt;')\r\n            .replace(/>/g, '&gt;')\r\n            .replace(/\\\"/g, '&quot;')\r\n            .replace(/\\'/g, '&#39;')\r\n            .replace(/\\//g, '&#x2F;');\r\n        // å¦ææ¯å¤è¡ææ¬æ¡  ä¿çæ ¼å¼\r\n        if (column.editor && column.editor.type === 'MultiTextBox') {\r\n            const INDEX = strValue.indexOf('\\n');\r\n            if (INDEX > -1) {\r\n                return strValue.replace(/\\n/g, '<br>');\r\n            }\r\n            return strValue;\r\n        }\r\n        // è¥ä¸ºstring\r\n        return strValue;\r\n    }\r\n}\r\nexport { FarrisKendoGridFormatService };\r\n","import { Injectable } from '@angular/core';\r\nimport { TreeTableComponent } from '@farris/ui-treetable';\r\n@Injectable()\r\nexport class FarrisTreetableFormatService {\r\n    constructor() {\r\n    }\r\n    setFormat(treeTable: TreeTableComponent) {\r\n        const columns = treeTable.columns;\r\n        columns.forEach((column: any) => {\r\n            const dataType = column.dataType;\r\n            if (!column.formatter) {\r\n                if (dataType === 'date') {\r\n                    column.formatter = {\r\n                        type: 'datetime',\r\n                        options: {\r\n                            format: column.format\r\n                        }\r\n                    };\r\n                } else if (dataType === 'number') {\r\n                    column.formatter = {\r\n                        type: 'number',\r\n                        options: {\r\n                            prefix: column.prefix ? column.prefix : '',\r\n                            suffix: column.suffix ? column.suffix : '',\r\n                            precision: column.precision,\r\n                            thousand: ',',\r\n                            stripZeros: false,\r\n                        }\r\n                    };\r\n                } else if (dataType === 'enum') {\r\n                    column.formatter = {\r\n                        type: 'enum',\r\n                        options: {\r\n                            data: column.enumData,\r\n                            valueField: 'value',\r\n                            textField: 'name'\r\n                        }\r\n                    };\r\n                } else if (dataType === 'boolean') {\r\n                    column.formatter = {\r\n                        type: 'enum',\r\n                        options: {\r\n                            data: [{ name: 'æ¯', value: true }, { name: 'å¦', value: false }],\r\n                            valueField: 'value',\r\n                            textField: 'name'\r\n                        }\r\n                    };\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n}\r\n","import { Pipe, PipeTransform } from '@angular/core';\r\nimport { DateUtil } from '@farris/devkit';\r\n\r\n@Pipe({ name: 'parseStrToDate' })\r\nexport class StringToDatePipe implements PipeTransform {\r\n    transform(value: string, exponent: string): any {\r\n        if (DateUtil.isEmptyDateString(value) === true) {\r\n          return null;\r\n        }\r\n\r\n        if (value.includes('å¹´')) {\r\n            const strDate = value.replace('å¹´', '-').replace('æ', '-').replace('æ¥', '');\r\n            return new Date(strDate);\r\n        }\r\n        return new Date(value);\r\n    }\r\n}\r\n","import { Directive, Input, OnInit, HostListener } from '@angular/core';\r\nimport { CompositeFilterDescriptor } from '@progress/kendo-data-query';\r\nimport { DropDownListComponent } from '@progress/kendo-angular-dropdowns';\r\nimport { FilterService, BaseFilterCellComponent } from '@progress/kendo-angular-grid';\r\n@Directive({\r\n    selector: '[kendogridFilter]'\r\n})\r\nexport class KendoGridFilterDirective extends BaseFilterCellComponent implements OnInit {\r\n\r\n    @Input() filter: CompositeFilterDescriptor;\r\n    @Input() column: any;\r\n\r\n    public get selectedValue(): any {\r\n        const filter = this.filterByField(this.column.dataField);\r\n        return filter ? filter.value : null;\r\n    }\r\n    public get defaultItem(): any {\r\n        return {\r\n            value: null,\r\n            name: 'å¨é¨'\r\n        };\r\n    }\r\n\r\n    constructor(\r\n        private dropdownList: DropDownListComponent,\r\n        public filterService: FilterService,\r\n    ) {\r\n        super(filterService);\r\n    }\r\n\r\n    ngOnInit() {\r\n        this.dropdownList.valueField = 'value';\r\n        this.dropdownList.textField = 'name';\r\n        this.dropdownList.valuePrimitive = true;\r\n        this.dropdownList.defaultItem = this.defaultItem;\r\n        this.dropdownList.value = this.selectedValue;\r\n        if (this.column.dataType === 'enum') {\r\n            this.dropdownList.data = this.column.enumData;\r\n        } else if (this.column.dataType === 'boolean') {\r\n            this.dropdownList.data = [{ value: true, name: 'æ¯' }, { value: false, name: 'å¦' }];\r\n        }\r\n    }\r\n\r\n\r\n    @HostListener('valueChange', ['$event'])\r\n    onChange(value: any) {\r\n        this.applyFilter(\r\n            value === null ?\r\n                this.removeFilter(this.column.dataField) :\r\n                this.updateFilter({\r\n                    field: this.column.dataField,\r\n                    operator: 'eq',\r\n                    value: value\r\n                })\r\n        );\r\n    }\r\n\r\n\r\n    /*\r\n   * è·å ååæ ¼å¼  ä¸»ä»è¡¨æ¯æ\r\n   * @param dataItem è¡æ°æ®\r\n   * @param field å­æ®µ\r\n   */\r\n    getValue(dataItem: any, field: string) {\r\n        const index = field.indexOf('.');\r\n        if (index < 0) {\r\n            return dataItem[field];\r\n        }\r\n        const fields = field.split('.');\r\n        // fieldå­ç¬¦ä¸²ç»å\r\n        return fields.reduce((result: any, next: any) => {\r\n            return result[next];\r\n        }, dataItem);\r\n    }\r\n\r\n}\r\n","import { Pipe, PipeTransform } from '@angular/core';\r\nimport { ViewModel, DateUtil } from '@farris/devkit';\r\n@Pipe({ name: 'dateFormatPlaceholder' })\r\nexport class DateFormatPlaceholderPipe implements PipeTransform {\r\n    constructor(private viewModel: ViewModel) {\r\n\r\n    }\r\n    transform(format: string, controlName: string): any {\r\n        if (!this.viewModel.form || !this.viewModel.form.get(controlName)) {\r\n            return {\r\n                year: 'å¹´',\r\n                month: 'æ',\r\n                day: 'æ¥'\r\n            };\r\n        }\r\n        const value = this.viewModel.form.get(controlName).value;\r\n        let dateStr = value;\r\n        if (dateStr) {\r\n            dateStr = value.toISOString();\r\n        }\r\n        if ((DateUtil.isEmptyDateString(dateStr) === true) && format === 'yyyyå¹´MMæddæ¥') {\r\n            return {\r\n                year: ' ',\r\n                month: ' ',\r\n                day: ' '\r\n            };\r\n        }\r\n        return {\r\n            year: 'å¹´',\r\n            month: 'æ',\r\n            day: 'æ¥'\r\n        };\r\n    }\r\n}\r\n","import { Pipe, PipeTransform } from '@angular/core';\r\n@Pipe({ name: 'formatTotal' })\r\nexport class FormatTotalPipe implements PipeTransform {\r\n    transform(value: any, exponent: any): any {\r\n        // å¤æ­å¼æ¯å¦åæ³\r\n        if (!value && value !== 0) {\r\n            return '';\r\n        }\r\n        if (exponent.dataType === 'number') {\r\n            // ä¿çå°æ°ç¹åå ä½\r\n            const dataFormat = exponent.format;\r\n            return value.toFixed(Number(dataFormat.substring(1)));\r\n        }\r\n        return value;\r\n    }\r\n}\r\n","import { Directive, ContentChildren, QueryList, Input, NgZone } from '@angular/core';\r\nimport { BindingData, BindingList } from '@farris/devkit';\r\nimport { ColumnComponent } from '@progress/kendo-angular-grid';\r\n\r\n@Directive({\r\n  selector: '[aggregate]',\r\n})\r\nexport class GridColumnAggregateDirective {\r\n\r\n  @Input() aggregate: string | boolean;\r\n\r\n  public get field(): string {\r\n    return this.column.field;\r\n  }\r\n\r\n  private get aggrType(): string {\r\n    let type = 'none';\r\n    if (typeof (this.aggregate) === 'boolean') {\r\n      // é»è®¤ä¸ºsumï¼å¦æä½¿ç¨æä»¤æ¶ä¼ å¥çinputä¸ºå¸å°ç±»åï¼ä½¿ç¨sumã\r\n      if (this.aggregate) {\r\n        type = 'sum';\r\n      }\r\n    } else if (typeof (this.aggregate) === 'string') {\r\n      type = this.aggregate;\r\n    }\r\n    return type;\r\n  }\r\n\r\n  constructor(private column: ColumnComponent, private ngZone: NgZone) {\r\n  }\r\n\r\n  public recalculateSummary(bindingList: BindingList) {\r\n    let summary = null;\r\n    if (this.aggrType === 'sum') {\r\n      const plainData = bindingList.toJSON().map(item => {\r\n        // èèå¸®å©åudtçæåµï¼fieldæ¯a.bçæ ¼å¼ã\r\n        return this.field.split('.').reduce((prevPath, currPath) => {\r\n          return prevPath[currPath];\r\n        }, item);\r\n      });\r\n      if (plainData && plainData.length) {\r\n        summary = plainData.reduce((prev, curr) => {\r\n          return prev + curr;\r\n        });\r\n      }\r\n    } else if (this.aggrType === 'count') {\r\n      // è®¡æ°ï¼å¦æå¯ç¨åé¡µï¼åªè®¡ç®å½åé¡µï¼å æ­¤ä½¿ç¨lengthèétotalã\r\n      summary = bindingList.length;\r\n    }\r\n    this.updateFooter(summary);\r\n  }\r\n\r\n  public updateFooter(content: any) {\r\n    if (this.aggregate) {\r\n        // å­å¨æ§è½é®é¢ï¼å»æsetTimeoutã\r\n        // åè¡¨çåè¶å¤ï¼æ­¤å¤é®é¢è¶ä¸¥éï¼éè¦æ­£åè§£å³ä»¥ä¸éè¯¯ã\r\n        // todo: settimeoutæ¯ä¸ºäºè§£å³æ°æ®ååæ¶angularæ¥éï¼å¦ææ´æ°é¡µèçé»è¾ä¸å¨gridbindingåèµ·ï¼æ¯å¦è¿å­å¨é®é¢ï¼\r\n        // setTimeout(() => {\r\n          this.column['summary'] = content;\r\n        // });\r\n    }\r\n  }\r\n}\r\n\r\n\r\n@Directive({\r\n  selector: '[farrisSummary]'\r\n})\r\nexport class GridSummaryDirective/* implements OnInit, AfterViewInit*/ {\r\n  @Input('farrisSummary') summary: string;\r\n  constructor(private bindingData: BindingData) { }\r\n\r\n}\r\n","import { ElementRef } from '@angular/core';\r\nimport { SelectedRowContext } from '../entity/index';\r\nimport { GridComponent } from '@progress/kendo-angular-grid';\r\n\r\n/**\r\n * å¤éåè¡¨å·¥å·ç±»\r\n */\r\nexport class MultiSelectGridUtility {\r\n  static CURRENT_ROW_STYLE_NAME = 'f-state-selected';\r\n  static CHECKBOXED_ROW_STYLE_NAME = 'f-state-checked';\r\n\r\n  /**\r\n   * æ¸²æåæ¢è¡\r\n   */\r\n  public static renderClickChangedRow(gridComponent: GridComponent, selectedRowContext: SelectedRowContext) {\r\n    if (!gridComponent) {\r\n      return;\r\n    }\r\n\r\n    const currentRowIndex = selectedRowContext.currentRowIndex;\r\n    // æ¸²æå½åè¡\r\n    this.addRowSelectedStyle(gridComponent, currentRowIndex);\r\n\r\n    // æ¸²æä¸ä¸è¡\r\n    const lastRowIndex = selectedRowContext.lastRowIndex;\r\n    if (!this.checIfIsSameRelativeIndex(gridComponent, currentRowIndex, lastRowIndex)) {\r\n      this.removeRowSelectedStyle(gridComponent, lastRowIndex);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * æ£æ¥å½åè¡ç´¢å¼å¼åä¸ä¸ä¸ªéä¸­è¡ç´¢å¼å¼çç¸å¯¹å½åé¡µé¢çç´¢å¼å¼æ¯å¦ç¸å\r\n   */\r\n  private static checIfIsSameRelativeIndex(gridComponent: GridComponent, currentRowIndex: number, lastRowIndex: number): boolean {\r\n    let isSameRelativeIndex = false;\r\n    if (currentRowIndex === lastRowIndex) {\r\n      isSameRelativeIndex = true;\r\n      return isSameRelativeIndex;\r\n    }\r\n\r\n    if ((Math.abs(currentRowIndex - lastRowIndex)) % (gridComponent.pageSize) === 0) {\r\n      isSameRelativeIndex = true;\r\n      return isSameRelativeIndex;\r\n    }\r\n\r\n    return isSameRelativeIndex;\r\n  }\r\n\r\n  /**\r\n   * æ£æµæ¯å¦å¯ç¨åé¡µåè½\r\n   */\r\n  public static checkIfEnablePaging(gridComponent: GridComponent): boolean {\r\n    let isPageable = false; // é»è®¤æªå¯ç¨åé¡µ\r\n    if (!gridComponent) {\r\n      return isPageable;\r\n    }\r\n\r\n    if (typeof gridComponent.pageable === 'boolean') {\r\n      isPageable = gridComponent.pageable;\r\n    } else if (typeof gridComponent.pageable === 'object') {\r\n      isPageable = true;\r\n    }\r\n\r\n    return isPageable;\r\n  }\r\n\r\n  /**\r\n   * æ¸²æcheckboxéæ©\r\n   */\r\n  public static renderSelectedChangeCheckbox(elementRef: ElementRef, $event: any) {\r\n\r\n    const currentRowIndex = $event.index;\r\n\r\n    const trCollection = this.getTrCollection(elementRef);\r\n    if (trCollection == null || trCollection.length <= 0 || trCollection.length < currentRowIndex) {\r\n      return;\r\n    }\r\n\r\n    // æ¸²æcheckedè¡\r\n    const currentTableRowElement = trCollection[currentRowIndex];\r\n    if (!currentTableRowElement) {\r\n      return;\r\n    }\r\n\r\n    if ($event.selected) { // checked\r\n      this.appendAtrributeValue(currentTableRowElement, 'class', this.CHECKBOXED_ROW_STYLE_NAME);\r\n    } else { // unchecked\r\n      this.removeAttributeSpecificValue(currentTableRowElement, 'class', this.CHECKBOXED_ROW_STYLE_NAME);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * æ·»å è¡çâå·²éä¸­æ ·å¼â\r\n   * ææ éæ±ï¼ä¸å¯¹å¤æ´é²\r\n   */\r\n  private static addRowSelectedStyle(gridComponent: GridComponent, rowIndex: number) {\r\n    if (!gridComponent || rowIndex < 0) {\r\n      return;\r\n    }\r\n\r\n    const currentRowElement = this.getRelativeRowInCurrentPage(gridComponent, rowIndex);\r\n    if (!currentRowElement) {\r\n      return;\r\n    }\r\n\r\n    this.appendAtrributeValue(currentRowElement, 'class', this.CURRENT_ROW_STYLE_NAME);\r\n  }\r\n\r\n  /**\r\n   * ç§»é¤è¡çâå·²éä¸­æ ·å¼â\r\n   * éæ±ï¼kendo-gridå¨åé¡µæ¶ï¼ä¸ä¼ç§»é¤å·²éä¸­æ ·å¼\r\n   */\r\n  public static removeRowSelectedStyle(gridComponent: GridComponent, rowIndex: number) {\r\n    if (!gridComponent || rowIndex < 0) {\r\n      return;\r\n    }\r\n\r\n    const currentRowElement = this.getRelativeRowInCurrentPage(gridComponent, rowIndex);\r\n    if (!currentRowElement) {\r\n      return;\r\n    }\r\n    this.removeAttributeSpecificValue(currentRowElement, 'class', this.CURRENT_ROW_STYLE_NAME);\r\n  }\r\n\r\n  /**\r\n   * è·åæå®è¡å¨å½åé¡µé¢å¯¹åºçè¡åç´ \r\n   */\r\n  private static getRelativeRowInCurrentPage(gridComponent: GridComponent, rowIndex: number): any {\r\n    let rowElementInCurrentPage: any = null;\r\n    if (!gridComponent || rowIndex < 0) {\r\n      return rowElementInCurrentPage;\r\n    }\r\n\r\n    const gridElement = gridComponent.wrapper;\r\n    // å¯ç¨åé¡µåï¼éè¦æ´æ°å½åè¡\r\n    const isPaging = this.checkIfEnablePaging(gridComponent);\r\n    if (isPaging) {\r\n      rowIndex = rowIndex % (gridComponent.pageSize); // å¯¹pageSizeåæ¨¡\r\n    }\r\n\r\n    const trCollection = this.getTrCollection(gridElement);\r\n    if (trCollection == null || trCollection.length <= 0) {\r\n      return rowElementInCurrentPage;\r\n    }\r\n\r\n    rowElementInCurrentPage = trCollection[rowIndex];\r\n\r\n    return rowElementInCurrentPage;\r\n  }\r\n\r\n  /**\r\n   * è·åå½ågridçtréå\r\n   */\r\n  private static getTrCollection(elementRef: ElementRef): any[] {\r\n    if (!elementRef || !elementRef.nativeElement) {\r\n      return null;\r\n    }\r\n\r\n    const kendoGridTbodyElements: any[] = elementRef.nativeElement.getElementsByTagName('tbody');\r\n    if (!kendoGridTbodyElements || kendoGridTbodyElements.length <= 0) {\r\n      return null;\r\n    }\r\n\r\n    const trCollection = kendoGridTbodyElements[0].getElementsByTagName('tr');\r\n    return trCollection;\r\n  }\r\n\r\n  /**\r\n   * ååç´ çæå®å±æ§è¿½å å¼\r\n   */\r\n  private static appendAtrributeValue(currentElement: Element, attributeName: string, attributeValue: string) {\r\n    let newAttributeValue: string = currentElement.getAttribute(attributeName);\r\n    if (newAttributeValue === null || newAttributeValue === '' || newAttributeValue.length <= 0) {\r\n      newAttributeValue = attributeValue;\r\n    } else {\r\n      if (newAttributeValue.indexOf(attributeValue) < 0) { // å­å¨æ£æµï¼é¿åéå¤æ·»å \r\n        newAttributeValue += ' ' + attributeValue;\r\n      }\r\n    }\r\n\r\n    currentElement.setAttribute(attributeName, newAttributeValue);\r\n  }\r\n\r\n  /**\r\n   * ç§»é¤åæ°æ®æå®å±æ§çç¹æ§å±æ§å¼\r\n   */\r\n  private static removeAttributeSpecificValue(currentElement: Element, attributeName: string, needRemoveAttributeValue: string) {\r\n    let lastClassAttributeValue = currentElement.getAttribute(attributeName);\r\n    if (!lastClassAttributeValue) {\r\n      return;\r\n    }\r\n\r\n    const index = lastClassAttributeValue.lastIndexOf(needRemoveAttributeValue);\r\n    if (index < 0) {\r\n      return;\r\n    }\r\n\r\n    const tempLastClassAttributeValue = lastClassAttributeValue.substring(0, index - 1);\r\n    lastClassAttributeValue = tempLastClassAttributeValue + ' '\r\n      + lastClassAttributeValue.substring(index + needRemoveAttributeValue.length);\r\n\r\n    currentElement.setAttribute(attributeName, lastClassAttributeValue);\r\n  }\r\n}\r\n","/**\r\n * éä¸­è¡ä¸ä¸æ\r\n */\r\nexport class SelectedRowContext {\r\n    /**\r\n     * å½åéä¸­è¡Index\r\n     */\r\n    currentRowIndex: number;\r\n\r\n    /**\r\n     * ä¸ä¸ä¸ªéä¸­è¡Index\r\n     */\r\n    lastRowIndex: number;\r\n}\r\n","import {\r\n  Directive, OnInit, OnChanges, OnDestroy, SimpleChanges, Input, HostListener, Optional,\r\n  EventEmitter, Output, ElementRef, ContentChildren, QueryList, NgZone, AfterViewInit\r\n} from '@angular/core';\r\nimport { of, Subscription } from 'rxjs';\r\nimport {\r\n  GridComponent, DataBindingDirective,\r\n  SelectionDirective,\r\n  CellClickEvent,\r\n  DataStateChangeEvent, GridDataResult, PageChangeEvent, SortSettings,\r\n} from '@progress/kendo-angular-grid';\r\nimport { process, GroupDescriptor, AggregateDescriptor, State, FilterDescriptor, SortDescriptor } from '@progress/kendo-data-query';\r\nimport {\r\n  BindingData, BindingList, Change, ChangeType,\r\n  FrameEventBus, UIState, Form, ViewModel, ComponentType\r\n} from '@farris/devkit';\r\nimport { DialogService } from '@farris/ui-dialog';\r\nimport { RuntimeStateService } from '@farris/ui-common';\r\nimport { DateTimeHelperService } from '@farris/ui-common/date';\r\nimport { FarrisKendoGridFormatService } from '../format/index';\r\nimport { GridColumnAggregateDirective } from './grid-summary.directive';\r\nimport { MultiSelectGridUtility } from '../util/multi_select_grid_utility';\r\nimport { SelectedRowContext } from '../entity/index';\r\n\r\n/*\r\n * Kendo Grid æ°æ®ç»å®æä»¤\r\n *\r\n * TODO:\r\n * 1ãæ´ä½å·å­å¨æ§è½é®é¢ï¼\r\n * 2ãéä¸­åå½åè¡æ²¡æåºåå¼ï¼\r\n */\r\n\r\n@Directive({\r\n  selector: '[farrisBindingPath]'\r\n})\r\nexport class KendoGridBindingDirective extends DataBindingDirective implements OnInit, AfterViewInit, OnChanges, OnDestroy {\r\n\r\n  /**\r\n   * æ¯å¦åè®¸ç¼è¾\r\n   * é»è®¤å¯ç¼è¾  å ä¸ºææ¹éç¼è¾åè¡¨\r\n   */\r\n  @Input('farrisEditable')\r\n  public editable: boolean;\r\n\r\n  /**\r\n   * ç¼è¾æ¶ç»å®çè¡¨å\r\n   */\r\n  @Input('farrisForm')\r\n  public form: Form;\r\n\r\n  /**\r\n   * åç»å\r\n   */\r\n  @Input('groupField')\r\n  public groupField: string;\r\n\r\n  @Input('groupAggrFields')\r\n  public groupAggrFields: string[];\r\n\r\n  /* ç»å®grid option */\r\n  @Input()\r\n  public farrisBindingGridOption: any;\r\n\r\n  /* å¼å®¹rowClass è¿æ²¡å é¤ */\r\n  @Input()\r\n  rowClassName: any;\r\n  /* è¡æ ·å¼äºä»¶ */\r\n  // @Input()\r\n  // rowClassName: (context: any) => any;\r\n\r\n  // tslint:disable-next-line:no-output-rename\r\n  @Output('append-row') appendRow = new EventEmitter<any>();\r\n\r\n  /* ç»å®æåºäºä»¶ */\r\n  @Output() sortChangeEvent: EventEmitter<any> = new EventEmitter<any>();\r\n\r\n  /* è¡æ ·å¼äºä»¶ */\r\n  @Output()\r\n  rowClass: EventEmitter<any> = new EventEmitter<any>();\r\n\r\n\r\n  get gridOption() {\r\n    return this.grid['gridOption'];\r\n  }\r\n  get len() {\r\n    return this.grid.columns.length;\r\n  }\r\n\r\n  dataItem: any;\r\n\r\n  /* keydownç»å®äºä»¶å¯¹è±¡ */\r\n  gridElement: any;\r\n  gridKeydownEvent: any;\r\n\r\n  /* cellclickäºä»¶å¯¹è±¡ */\r\n  gridCellClickEvent: any;\r\n\r\n  /* cellCloseäºä»¶å¯¹è±¡ */\r\n  gridCellCloseEvent: any;\r\n\r\n\r\n  cellClickEvent: CellClickEvent;\r\n\r\n  hiddenColLen = 0;\r\n  /**\r\n   * TODO: ä»å®ä½è·åå¶é»è®¤å¼\r\n   * å½åè¡ç´¢å¼å¼ï¼é»è®¤ç¬¬ä¸ä¸ª\r\n   */\r\n  rowIndex = 0;\r\n  columnIndex = 0;\r\n  sender: any;\r\n  interVal: any;\r\n  dataId: any;\r\n  currentSkip = 0;\r\n  private currentRowId: string;\r\n\r\n  cellClickParam: CellClickEvent;\r\n  /**\r\n   * æ¯å¦å¯ç¨å¤éï¼é»è®¤æªå¯ç¨\r\n   */\r\n  private isMultipleSelectionMode = false;\r\n  public get IsMultipleSelectionMode() {\r\n    if (!this.grid) {\r\n      return this.isMultipleSelectionMode;\r\n    }\r\n\r\n    if (this.grid.selectable) { // ä¼åå°è¯ä»this.grid.selectableè·å\r\n      // tslint:disable-next-line: no-string-literal\r\n      if (this.grid.selectable['mode'] === 'multiple') {\r\n        this.isMultipleSelectionMode = true;\r\n      } else {\r\n        this.isMultipleSelectionMode = false;\r\n      }\r\n    } else {\r\n      if (this.grid.selectableSettings && this.grid.selectableSettings.mode === 'multiple') {\r\n        this.isMultipleSelectionMode = true;\r\n      }\r\n    }\r\n\r\n    return this.isMultipleSelectionMode;\r\n  }\r\n\r\n  /**\r\n   * ä¸ä¸ä¸ªéä¸­è¡ï¼é»è®¤ä¸å­å¨\r\n   */\r\n  public lastRowIndex = -1;\r\n\r\n  /**\r\n   * éä¸­è¡åæ¢äºä»¶\r\n   */\r\n  @Output() selectedRowChange: EventEmitter<any> = new EventEmitter<any>();\r\n\r\n  /**\r\n   * checkboxéæ©äºä»¶\r\n   */\r\n  @Output() selectedCheckboxChange: EventEmitter<any> = new EventEmitter<any>();\r\n\r\n  /**\r\n   * ç»å®åè¡¨(Gridå¯¹åºæ°æ®æº)\r\n   */\r\n  private get bindingList(): BindingList {\r\n    // æ ¹å®ä½\r\n    if (this.viewModel.bindingPath === '/' || !this.viewModel.bindingPath) {\r\n      return this.bindingData.list;\r\n    }\r\n    // å­å®ä½\r\n    let bindingPath = this.viewModel.bindingPath.substr(1);\r\n    bindingPath = bindingPath[0].toLowerCase() + bindingPath.substring(1, bindingPath.length);\r\n    const paths = bindingPath.split('/');\r\n\r\n    const filteredPaths = paths.filter((part: string) => {\r\n      return part !== '';\r\n    });\r\n    return this.bindingData.getValue(filteredPaths);\r\n  }\r\n  /**\r\n   * è·ååé¡µä¿¡æ¯\r\n   */\r\n  private getPagingInfo() {\r\n    const bindingPath = this.viewModel.bindingPath;\r\n    const bindingData = this.viewModel.bindingData;\r\n    let pagingInfo = bindingData.pagingInfo;\r\n    if (bindingPath === '/') {\r\n      return pagingInfo;\r\n    } else {\r\n      const bindingPaths = bindingPath.substr(1).split('/').filter(item => !!item && item.length > 0).map(item => {\r\n        return item.substring(0, item.length - 1);\r\n      });\r\n      bindingPaths.forEach(path => {\r\n        pagingInfo = pagingInfo && pagingInfo[path] || {};\r\n      });\r\n      return pagingInfo;\r\n    }\r\n  }\r\n\r\n  @ContentChildren(GridColumnAggregateDirective) private aggrColumns: QueryList<GridColumnAggregateDirective>;\r\n  private bindingChangeSubscription: Subscription;\r\n\r\n  /**\r\n   * æé å½æ°\r\n   * @param  grid å®¿ä¸»Grid\r\n   */\r\n  constructor(\r\n    public bindingData: BindingData,\r\n    @Optional() public uiState: UIState,\r\n    @Optional() public eventBus: FrameEventBus,\r\n    @Optional() public viewModel: ViewModel,\r\n    public grid: GridComponent,\r\n    public selectionDir: SelectionDirective,\r\n    public dialogSer: DialogService,\r\n    private dateService: DateTimeHelperService,\r\n    private kendogridFormatSer: FarrisKendoGridFormatService,\r\n    private rts: RuntimeStateService,\r\n    public ngZone: NgZone\r\n  ) {\r\n    super(grid);\r\n\r\n    this.selectionDir.selectedKeys = [];\r\n    this.viewModel.uiState.setPropertyValue('ids', this.selectionDir.selectedKeys);\r\n    const appContext = this.viewModel.frameContext.getFormAppContext();\r\n    if (appContext && appContext.hasOwnProperty('messagePipe')) {\r\n      appContext.messagePipe.subscribe((message: any) => {\r\n        this.grid.closeCell();\r\n      });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * æä»¤åå§åå\r\n   */\r\n  ngOnInit() {\r\n    super.ngOnInit();\r\n\r\n    // åå§åstateï¼åç»ä½¿ç¨ã\r\n    this.initDataState();\r\n\r\n    this.refreshView();\r\n    if (this.viewModel && this.viewModel.frameContext && this.viewModel.frameContext.frameComponent) {\r\n      this.viewModel.frameContext.frameComponent.componentType = ComponentType.kendoGridComponent;\r\n    }\r\n    // æ°æ®åå\r\n    this.bindingChangeSubscription = this.bindingData.changes.subscribe((change: Change) => {\r\n      this.refreshView(change);\r\n\r\n      if (change.type === ChangeType.Load) {\r\n        // loadæ¶ï¼å¨å¤éæ¨¡å¼ä¸ï¼éæ¸ç©ºéä¸­éå\r\n        if (this.isMultipleSelectionMode) {\r\n          const isMatch = this.checkIfChangeMatchBindingPath(change);\r\n          if (isMatch) {\r\n            // æ¸ç©ºå¤ééå\r\n            this.selectionDir.selectedKeys = [];\r\n            this.viewModel.uiState.setPropertyValue('ids', this.selectionDir.selectedKeys);\r\n            this.ngZone.runOutsideAngular(() => {\r\n              // æ¸²æåå§éä¸­è¡\r\n              setTimeout(() => {\r\n                const rowSelectedContext: SelectedRowContext = new SelectedRowContext();\r\n                const isPageable = MultiSelectGridUtility.checkIfEnablePaging(this.grid);\r\n                if (isPageable) {\r\n                  this.rowIndex = this.grid.skip;\r\n                } else {\r\n                  this.rowIndex = 0;\r\n                }\r\n                rowSelectedContext.currentRowIndex = this.rowIndex;\r\n                rowSelectedContext.lastRowIndex = this.lastRowIndex;\r\n                this.handleSelectedRowChange(rowSelectedContext);\r\n              }, 300);\r\n            });\r\n          }\r\n        }\r\n      }\r\n\r\n      // TODO: ä½¿ç¨ç­ç¥æ¨¡å¼éæ\r\n      // bindingData åæ­¥ SelectedKeys\r\n      if (change.type === ChangeType.Remove) {\r\n        this.syncDeletedKeys(change.value);\r\n      }\r\n      const isMatch = this.checkIfChangeMatchBindingPath(change);\r\n      if (isMatch) {\r\n        this.handleSelectedKeyChange(this.bindingList.currentId);\r\n      }\r\n      // æ¸²æå½åè¡\r\n      if (isMatch && this.checkCurrentRowIdExists() && change.type === ChangeType.SelectionChanged && !this.dataId) {\r\n        this.renderCurrentRow(this.bindingList.currentId);\r\n      }\r\n      // tslint:disable-next-line: max-line-length\r\n      // FIXME:éè¦æéç½®é¡µç çæ¶æº\r\n      /*if ((change.type === ChangeType.SelectionChanged || change.type === ChangeType.GlobalSelectionChanged) && this.currentRowId !== this.bindingList.currentId) {\r\n          this.resetPageInfo();\r\n      }*/\r\n      // è§¦ååæ´æ£æµ\r\n      if (change.type === ChangeType.Load || change.type === ChangeType.SelectionChanged\r\n        || change.type === ChangeType.Append || change.type === ChangeType.Remove) {\r\n\r\n        // è§¦ååæ´æ£æµ\r\n        if (this.grid && this.grid['changeDetectorRef'] && this.grid['changeDetectorRef']['detectChanges']) {\r\n          this.grid['changeDetectorRef']['detectChanges']();\r\n        }\r\n      }\r\n\r\n    });\r\n\r\n    if (this.editable === true && this.form === null) {\r\n      throw Error('å¯ç¨ç¼è¾æ¶ï¼å¿é¡»æå®form');\r\n    }\r\n    if (!this.grid || !this.farrisBindingGridOption || !this.farrisBindingGridOption['fields']) {\r\n      return;\r\n    }\r\n\r\n    const gridColumns = this.farrisBindingGridOption['fields'];\r\n    const gridOption = this.farrisBindingGridOption;\r\n\r\n    // å¤æ­åä¸­æ¯å¦å­å¨åºå®å\r\n    gridOption.lockable = (columns: any[]) => {\r\n      return columns.some(ele => {\r\n        return ele.frozen;\r\n      });\r\n    };\r\n\r\n    this.rowClass.emit(this.grid);\r\n    // æ·»å åå±æ§æèæ¹æ³\r\n    gridColumns.forEach((element: any) => {\r\n      // èªå®ä¹è¶é¾\r\n      if (element.linkedLabelEnabled && !element.linkEvent) {\r\n        element.linkEvent = () => {\r\n          return;\r\n        };\r\n      }\r\n\r\n      // è¥æ²¡æèªå®ä¹æ ¼å¼åæ¹æ³  æ¯ä¸ªåå¯¹è±¡ç»å®æ ¼å¼åæ¹æ³\r\n      if (!element.getColumnFormat) {\r\n        element.getColumnFormat = (dataItem: any, column: any) => {\r\n          return this.kendogridFormatSer.getColumnFormat(dataItem, column);\r\n        };\r\n      }\r\n\r\n      // å¦ææ²¡æèªå®ä¹ç±»æ ·å¼ æ¯ä¸ªåç»å® æ ¼å¼åæ¹æ³\r\n      if (!element.getClassName) {\r\n        element.getClassName = (dataItem: any, column: any) => '';\r\n      }\r\n\r\n      // èªå®ä¹å¸®å©ååäºä»¶\r\n      if (element.editor && element.editor.type === 'LookupEdit') {\r\n\r\n        // å¸®å©åäºä»¶\r\n        if (!element.dictPicking) {\r\n          element.dictPicking = (param: any) => {\r\n            return of(true);\r\n          };\r\n        }\r\n        // å¸®å©åäºä»¶\r\n        if (!element.dictPicked) {\r\n          element.dictPicked = (param: any) => {\r\n            // éæ°è¿å¥ç¼è¾\r\n            this.cellClickHandler(this.cellClickParam);\r\n            return of(true);\r\n          };\r\n        }\r\n      }\r\n    });\r\n    // ç»å®gridOption\r\n    this.bindingGridOption();\r\n\r\n    // å¤éæ¨¡å¼ä¸ï¼è®¾ç½®åå§éä¸­è¡\r\n    if (this.IsMultipleSelectionMode) {\r\n      // TODO: ç§»é¤ setTimeout\r\n      const self = this;\r\n      this.ngZone.runOutsideAngular(() => {\r\n        setTimeout(() => {\r\n          const rowSelectedContext: SelectedRowContext = new SelectedRowContext();\r\n          rowSelectedContext.currentRowIndex = self.rowIndex;\r\n          rowSelectedContext.lastRowIndex = self.lastRowIndex;\r\n          self.handleSelectedRowChange(rowSelectedContext);\r\n        }, 300);\r\n      });\r\n    }\r\n  }\r\n\r\n\r\n  ngAfterViewInit() {\r\n    // this.gridElement = document.querySelector('.k-grid');\r\n    // // ç»å®grid keydownå¯¹è±¡çæ¹æ³\r\n    // this.ngZone.runOutsideAngular(() => {\r\n    //   this.gridKeydownEvent = this.enterCell.bind(this);\r\n    //   this.gridCellClickEvent = this.cellClickHandler.bind(this);\r\n    //   this.gridCellCloseEvent = this.cellCloseHandler.bind(this);\r\n    //   this.gridElement.addEventListener('keydown', this.gridKeydownEvent);\r\n    //   this.gridElement.addEventListener('cellClick', this.gridCellClickEvent);\r\n    //   this.gridElement.addEventListener('cellClose', this.gridCellCloseEvent);\r\n    // });\r\n  }\r\n  /**\r\n   * æ£æµchangeçè·¯å¾åBindingPathæ¯å¦å¹é\r\n   */\r\n  private checkIfChangeMatchBindingPath(change: Change): boolean {\r\n    let isMatch = false;\r\n    if (!change || !change.path) {\r\n      return isMatch;\r\n    }\r\n\r\n    const changePathArray = change.path;\r\n    if (!changePathArray) {\r\n      return isMatch;\r\n    }\r\n\r\n    if (!(this.bindingData) && !(this.bindingData.bindingPath)) {\r\n      return isMatch;\r\n    }\r\n    const bingdingPathArray = this.bindingData.bindingPath.split('/');\r\n    if (bingdingPathArray.length <= 0) {\r\n      return isMatch;\r\n    }\r\n\r\n    if (changePathArray.length === 0) { // ä¸»è¡¨\r\n      if (this.bindingData.bindingPath === '/') {\r\n        isMatch = true;\r\n      }\r\n    } else if (change.path.length === 1) {// ä¸»ä»è¡¨\r\n      if (bingdingPathArray.length === 2 && bingdingPathArray[1] === change.path[0]) {\r\n        isMatch = true;\r\n      }\r\n    } else if (change.path.length === 2) { // ä¸»ä»ä»è¡¨\r\n      if (bingdingPathArray.length === 3 && bingdingPathArray[1] === change.path[0] && bingdingPathArray[2] === change.path[1]) {\r\n        isMatch = true;\r\n      }\r\n    }\r\n\r\n    return isMatch;\r\n  }\r\n\r\n  /**\r\n   * å¤çéä¸­ä¸»é®åæ´\r\n   */\r\n  private handleSelectedKeyChange(currentId: any) {\r\n    const selectedKeys = this.selectionDir.selectedKeys;\r\n    if (!currentId) {\r\n\r\n      // å¦æå½åè¡æ¶nullï¼ä½selectedKeyséæå¼ï¼æ¸ç©ºå¹¶åéä¸æ¬¡è¡åæ¢\r\n      if (selectedKeys.length > 0) {\r\n        const removedSelectedKeys = selectedKeys.splice(0, selectedKeys.length);\r\n        if (removedSelectedKeys.indexOf(null) === -1) {\r\n          this.emitSelectedRowChange({ currentRowId: null });\r\n        }\r\n      }\r\n      return;\r\n    }\r\n    let oldCurrentRowId = null;\r\n    if (this.IsMultipleSelectionMode) {\r\n      oldCurrentRowId = this.currentRowId;\r\n    } else {\r\n      oldCurrentRowId = this.selectionDir.selectedKeys.length === 0\r\n        ? null : this.selectionDir.selectedKeys[0];\r\n    }\r\n\r\n    // TODO:if (this.currentRowId !== currentId) {\r\n    if (oldCurrentRowId !== currentId) {\r\n      const selectedRowContext: any = {};\r\n      selectedRowContext.currentRowId = currentId;\r\n      this.currentRowId = currentId;\r\n      this.emitSelectedRowChange(selectedRowContext);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * åå°éä¸­è¡åæ¢äºä»¶\r\n   * @description ç»ä¸åéæ¨¡å¼åå¤éæ¨¡å¼ä¸çè¡åæ¢äºä»¶\r\n   */\r\n  private emitSelectedRowChange(selectedRowContext: any) {\r\n    if (!this.IsMultipleSelectionMode) { // ååå¼å®¹\r\n      const currentId = selectedRowContext.currentRowId;\r\n      this.selectionDir.selectedKeys = [currentId];\r\n      this.selectionDir.selectedKeysChange.emit(this.selectionDir.selectedKeys);\r\n    }\r\n\r\n    this.selectedRowChange.emit(selectedRowContext);\r\n  }\r\n\r\n  private checkCurrentRowIdExists(): boolean {\r\n    let isExist = false;\r\n\r\n    if (this.bindingList && this.bindingList.currentId && this.bindingList.currentId.length > 0) {\r\n      isExist = true;\r\n    }\r\n\r\n    return isExist;\r\n  }\r\n\r\n  /**\r\n   * åæ­¥å·²å é¤é®å°éä¸­éå\r\n   */\r\n  private syncDeletedKeys(deletedValueCollection: any[]) {\r\n    if (!deletedValueCollection) {\r\n      return;\r\n    }\r\n\r\n    deletedValueCollection.forEach((id: string) => {\r\n      const index = this.selectionDir.selectedKeys.indexOf(id);\r\n      if (index > -1) {\r\n        this.selectionDir.selectedKeys.splice(index, 1);\r\n\r\n        // selectedKeysè¢«æ¸ç©ºçæ¶åï¼è§¦åä¸æ¬¡è¡åæ´\r\n        if (this.selectionDir.selectedKeys.length === 0) {\r\n          this.emitSelectedRowChange({ currentRowId: null });\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  private renderCurrentRow(currentId: string) {\r\n    if (!currentId || currentId === '') {// ä¸å­å¨å½åè¡\r\n      return;\r\n    }\r\n\r\n    // TODO:ä½¿ç¨ç­ç¥æ¨¡å¼éæ\r\n    if (this.IsMultipleSelectionMode) {\r\n      return;\r\n    }\r\n\r\n    this.renderSelectionRow(this.bindingList.currentId, this.selectionDir.selectedKeys);\r\n  }\r\n\r\n  /**\r\n   * æä»¤è¾å¥åæ´å¤ç\r\n   */\r\n  ngOnChanges(changes: SimpleChanges) {\r\n    super.ngOnChanges(changes);\r\n    this.refreshView();\r\n  }\r\n\r\n  /**\r\n   * æä»¤éæ¯ï¼æ³¨éè®¢é\r\n   */\r\n  ngOnDestroy() {\r\n    if (this.bindingChangeSubscription) {\r\n      this.bindingChangeSubscription.unsubscribe();\r\n    }\r\n  }\r\n\r\n  private refreshView(change?: Change) {\r\n    // this.bindData();\r\n    this.refreshData(change);\r\n\r\n    // å·æ°é¡µèåè®¡ä¿¡æ¯ãå®¢æ·ç«¯åè®¡ï¼ææ¶æ¾è¿éï¼æå¡ç«¯åè®¡æ¶æå¥½ä»è¿éç§»èµ°ãby justin\r\n    this.refreshSummary();\r\n  }\r\n\r\n  /**\r\n   * ç»å®dataå°å®¿ä¸»gridä¸\r\n   * @deprecated\r\n   */\r\n  private bindData() {\r\n    /*const data = this.bindingList.toJSON();\r\n    let skip = 0;\r\n    if (this.bindingList.pageIndex > 0) {\r\n      skip = (this.bindingList.pageIndex - 1) * this.bindingList.pageSize;\r\n    }\r\n    this.updatePager(this.bindingList.pageSize, skip);\r\n    const processed = process(data, Object.assign({}, this.state, { skip: 0 }));\r\n    processed.total = this.bindingList.total;\r\n    this.grid.data = processed;*/\r\n  }\r\n\r\n  private refreshData(change?: Change) {\r\n    let skip = 0;\r\n    const { pageIndex = 1, pageSize = 0 } = this.getPagingInfo() || {};\r\n    if (pageIndex > 0) {\r\n      skip = (pageIndex - 1) * pageSize;\r\n    }\r\n    this.updatePager(pageSize, skip);\r\n    this.endCellEdit(change);\r\n    this.data = this.bindingList.toJSON({ ignoreMultiLangInput: true });\r\n  }\r\n  /**\r\n   * éåºç¼è¾ç¶æ\r\n   * @param change åæ´\r\n   */\r\n  private endCellEdit(change?: Change) {\r\n    const isEditing = this.grid.isEditing;\r\n    if (change && change.type === ChangeType.Load && isEditing) {\r\n      this.grid.cancelCell();\r\n    }\r\n  }\r\n  private refreshSummary() {\r\n    if (this.aggrColumns) {\r\n      this.aggrColumns.forEach(aggrCol => {\r\n        if (aggrCol.aggregate) {\r\n          aggrCol.recalculateSummary(this.bindingList);\r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n  @HostListener('pageChange', ['$event'])\r\n  public onPageChange(event: PageChangeEvent) {\r\n    const { skip = 0, take = 0 } = event || {};\r\n    // this.bindingList.setPaginationInfo(skip, take);\r\n    this.bindingData.setPagingInfo(skip, take, this.viewModel.bindingPath);\r\n    // ç§»é¤éä¸­è¡æ ·å¼\r\n    MultiSelectGridUtility.removeRowSelectedStyle(this.grid, this.rowIndex);\r\n  }\r\n  /**\r\n   * éç½®gridåé¡µä¿¡æ¯\r\n   */\r\n  private resetPageInfo() {\r\n    const { pageSize = 0 } = this.getPagingInfo() || {};\r\n    this.bindingData.setPagingInfo(0, pageSize, this.viewModel.bindingPath);\r\n  }\r\n  private initDataState() {\r\n    // const groups: GroupDescriptor[] = [];\r\n    // if (this.groupField) {\r\n    //   groups.push({field: this.groupField, aggregates: this.aggregates||[]});\r\n    //   this.grid.group = groups;\r\n    // }\r\n    // this.state = Object.assign(this.state, {group: groups});\r\n\r\n    const aggregatesDes: AggregateDescriptor[] = [];\r\n    if (this.groupAggrFields) {\r\n      for (const groupAggrField of this.groupAggrFields) {\r\n        aggregatesDes.push({ field: groupAggrField, aggregate: 'sum' });\r\n      }\r\n    }\r\n\r\n    const group: GroupDescriptor[] = [];\r\n    if (this.groupField) {\r\n      group.push({ field: this.groupField, aggregates: aggregatesDes });\r\n    }\r\n    this.group = group;\r\n\r\n  }\r\n\r\n  /*\r\n   * @override\r\n   * @param state State\r\n   */\r\n  onStateChange(state: DataStateChangeEvent) {\r\n    // è¯´æï¼pageræ ¹æ®skipè®¡ç®å½åé¡µç ãkendo gridåé¨ä¼å¨filter stateååæ¶æskipåä¸º0ï¼éç½®å°ç¬¬ä¸é¡µï¼ã\r\n    // å æ­¤éè¦éåonStateChangeæ¹æ³ï¼ä¿®æ­£skip\r\n    if (state.skip !== this.currentSkip) {\r\n      state.skip = this.currentSkip;\r\n    }\r\n    // ä½¿ç¨kendoé»è®¤çå¤çstateçé»è¾\r\n    this.applyState(state);\r\n\r\n    this.rebind();\r\n  }\r\n\r\n  // protected applyState({skip, take, sort, group, filter}: State): void {\r\n  //   this.skip = skip;\r\n  //   this.pageSize = take;\r\n  //   this.sort = sort;\r\n  //   this.group = group;\r\n  //   this.filter = filter;\r\n  // }\r\n\r\n  /*\r\n   * @override æå¡å¨ç«¯åé¡µåæ°ãprocessä½¿ç¨çstateä¸­skipåºä¸º0ï¼å¦åä¸æ¾ç¤ºæ°æ®\r\n   * @param state State\r\n   */\r\n  protected process(state: State): GridDataResult {\r\n    // if (this.editing) {\r\n    //   state.sort = null;\r\n    // } else {\r\n    //   state.sort = this.originalSort;\r\n    // }\r\n    state.skip = 0;\r\n    const { pageSize = 0, total: totalCount = 0 } = this.getPagingInfo() || {};\r\n    // fixï¼ä¸å¯ç¨åé¡µæ¶ï¼take=0å¯¼è´processä¸è¿åæ°æ®\r\n    if (state.take === 0) {\r\n      state.take = this.bindingList.length;\r\n    } else {\r\n      state.take = pageSize;\r\n    }\r\n    // ç¼è¾æ¨¡å¼çå¤æ­ä¾æ®ä¸ºpageSizeå°äºç»å®æ°æ®çæ°éä¸å¯ç¨åé¡µ\r\n    const isEditMode = state.take < this.bindingList.length;\r\n    if (isEditMode) {\r\n      state.take = this.bindingList.length;\r\n    }\r\n    const processed = super.process(state);\r\n    // fix:æ°æ®ä»æ å°ææ¶åé¡µä¸å¯ç¨\r\n    processed.total = Math.max(totalCount, this.bindingList.length);\r\n    // åé¡µç¼è¾æ¨¡å¼ä¸æ°æ®æ»è®°å½æ°ä¸è½ç­äºçå®çæ°æ®æ°æ®ï¼å¦ååé¡µå·¥å·æ¡å°±ä¼èªå¨å¢å åé¡µé¡µç­¾\r\n    if (isEditMode) {\r\n      processed.total = totalCount || 1;\r\n    }\r\n\r\n    return processed;\r\n  }\r\n\r\n  /*\r\n   * éä¸­è¡ä¸»é®ååå¤ç\r\n   * @param event { SelectionEvent} éä¸­è¡ååå¤ç\r\n   */\r\n  @HostListener('selectedKeysChange', ['$event'])\r\n  public selectedKeysChangeHandler(selectedKeys: string[]) {\r\n    if (!(this.IsMultipleSelectionMode)) {// åéæ¨¡å¼ä¸\r\n      // è®¾ç½®BindingDataä¸­çå½åè¡\r\n      this.setSelectionIdToBindingData(selectedKeys[selectedKeys.length - 1]);\r\n    }\r\n\r\n    this.viewModel.uiState.setPropertyValue('ids', this.selectionDir.selectedKeys); // æ´æ°éå\r\n  }\r\n\r\n  /*\r\n   * å¤çGridè¡åæ¢äºä»¶\r\n   * @param event { SelectionEvent} è¡åæ¢äºä»¶å¯¹è±¡\r\n   */\r\n  @HostListener('selectionChange', ['$event'])\r\n  public selectionChangeHandler(event: any) {\r\n    if (this.IsMultipleSelectionMode) {\r\n      this.handleSelectedCheckboxChange(this.grid.wrapper, event);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * å¤çcheckboxéä¸­äºä»¶\r\n   */\r\n  private handleSelectedCheckboxChange(elementRef: ElementRef, event: any) {\r\n    MultiSelectGridUtility.renderSelectedChangeCheckbox(elementRef, event);\r\n    this.selectedCheckboxChange.emit(event);\r\n  }\r\n\r\n  /*\r\n   * ååæ ¼ç¹å»å¤ç\r\n   * @param event { CellClickEvent } ååæ ¼åå»äºä»¶å¯¹è±¡\r\n   */\r\n  @HostListener('cellClick', ['$event'])\r\n  public cellClickHandler(event: CellClickEvent) {\r\n    this.cellClickParam = event;\r\n    this.cellClickEvent = event;\r\n    this.rowIndex = event.rowIndex;\r\n    this.columnIndex = event.columnIndex;\r\n    this.sender = event.sender;\r\n\r\n    // å¤éæ¨¡å¼ä¸ï¼ä¸ä¸åç»çæåµä¸ï¼æ£æµè¡åæ¢\r\n    if (this.IsMultipleSelectionMode && !this.gridOption.groupable) {\r\n      const currentRowIndex = event.rowIndex;\r\n      if (currentRowIndex !== this.lastRowIndex) {\r\n        const rowSelectedContext: SelectedRowContext = new SelectedRowContext();\r\n        rowSelectedContext.currentRowIndex = currentRowIndex;\r\n        rowSelectedContext.lastRowIndex = this.lastRowIndex;\r\n\r\n        this.handleSelectedRowChange(rowSelectedContext);\r\n      }\r\n    }\r\n\r\n    // è®¾ç½®å®ä½çå½åè¡\r\n    this.dataId = this.getSelectedIdFromGrid(event.dataItem);\r\n    this.setSelectionIdToBindingData(this.dataId);\r\n\r\n    // è¥ç¶ææºä¸æ¯å¯ç¼è¾ç¶æ ä¸å¯ç¼è¾\r\n    if (!this.isEditable()) {\r\n      return;\r\n    }\r\n\r\n\r\n\r\n    // åæ¨¡æ¿ä¸å­å¨  ä¸å¯ç¼è¾\r\n    if (!event.column.editTemplate) {\r\n      return;\r\n    }\r\n    if (event.type === 'click' && !event.isEdited) {\r\n\r\n\r\n      // å¦æå­å¨æ¾éç¶åµ  ç¡®å®æ­£ç¡®çcolumnIndex\r\n      const originColums = this.getColumns(this.gridOption.fields);\r\n      const columns: any[] = this.getColumns(originColums);\r\n      const currentColumnIndex = columns.findIndex((col: any) => col.dataField === event.column.field);\r\n      const hiddenColLen = columns.slice(0, currentColumnIndex + 1).filter(col => !col.visible).length;\r\n\r\n      // èµå¼å¨å±è¡ç´¢å¼  åç´¢å¼\r\n      this.rowIndex = event.rowIndex;\r\n      this.columnIndex = event.columnIndex + hiddenColLen;\r\n      this.hiddenColLen = hiddenColLen;\r\n      this.sender = event.sender;\r\n\r\n      this.setEditable(this.rowIndex, this.columnIndex);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * å¤çéä¸­è¡åæ¢äºä»¶\r\n   */\r\n  private handleSelectedRowChange(rowSelectedContext: SelectedRowContext) {\r\n    MultiSelectGridUtility.renderClickChangedRow(this.grid, rowSelectedContext);\r\n\r\n    this.rowIndex = rowSelectedContext.currentRowIndex;\r\n    this.lastRowIndex = rowSelectedContext.currentRowIndex;\r\n    // æ´æ°å½åè¡\r\n    const id = this.getPrimary(this.rowIndex);\r\n    this.setSelectionIdToBindingData(id);\r\n  }\r\n  /**\r\n   * è·åæå®è¡çä¸»é®\r\n   * @param row è¡å·\r\n   */\r\n  private getPrimary(row: number) {\r\n    let data: any = this.grid.data;\r\n    if (data && !Array.isArray(data) && data.hasOwnProperty('data')) {\r\n      data = data.data;\r\n    }\r\n    const { pageIndex = 1, pageSize = 0 } = this.getPagingInfo() || {};\r\n    const skip = this.bindingList.skip;\r\n    // ä¸åé¡µæèç¬¬ä¸é¡µæ¶åä¸éè¦ä¿®æ¹è¡å·\r\n    const rowNumber = pageSize === 0 || pageIndex === 1 ? row : row - skip;\r\n    if (data.length > rowNumber) {\r\n      return data[rowNumber][this.bindingList.primaryKey];\r\n    }\r\n    return null;\r\n  }\r\n\r\n  /*\r\n   * ååæ ¼ç»æç¼è¾å¤ç\r\n   * @param event ååæ ¼ç»æç¼è¾äºä»¶å¯¹è±¡\r\n   */\r\n  @HostListener('cellClose', ['$event'])\r\n  public cellCloseHandler(event: any): any {\r\n\r\n    if (this.dialogSer.hasDialogOpened()) {\r\n      event.preventDefault();\r\n      return;\r\n    }\r\n\r\n    if (this.rts) {\r\n      // å¸®å©ç»ä»¶ææ¬åååå»æ¥è¯¢\r\n      if (this.rts.getFormState('lookup.pending')) {\r\n        event.preventDefault();\r\n        return;\r\n      }\r\n\r\n      // ç¹å»å¸®å©ç¡®å®å¯åæ¶æé®åä¸ç»æå½åååæ ¼ç¼è¾\r\n      if (event.originalEvent) {\r\n        if (this.rts.eventPath(event.originalEvent).find(n => n.tagName === 'FARRIS-DIALOG')) {\r\n          event.preventDefault();\r\n          return;\r\n        }\r\n      }\r\n    }\r\n\r\n\r\n    const { formGroup, column, dataItem, rowIndex } = event;\r\n    const columns = this.getColumns(this.gridOption.fields);\r\n    let currentCol = columns.find((element: any) => {\r\n      return element.dataField === column.field;\r\n    });\r\n    const formControlValue = formGroup[currentCol.editor.binding.path].value;\r\n    if (currentCol.getDynamicData) {\r\n      // è¥æ­¤åæ¯å¨æååæ ¼å\r\n      currentCol = currentCol.getDynamicData(dataItem, currentCol);\r\n    }\r\n    this.setValue(formControlValue, currentCol);\r\n  }\r\n\r\n  /*\r\n     * åè½¦  åæ¢ååæ ¼\r\n     * @param event é®çæä¸äºä»¶\r\n     */\r\n  @HostListener('keydown', ['$event'])\r\n  enterCell(e: any) {\r\n    // åè½¦é®\r\n    if (!e.shiftKey && e.keyCode === 13) {\r\n      // textarea enter å±è½æ¢è¡æä½\r\n      e.preventDefault();\r\n      if (!this.sender) {\r\n        return;\r\n      }\r\n      // ç±äºkeydown äºä»¶ä¼åæ§è¡ï¼æä»¥è¿éåè¦æ§è¡blur äºä»¶ï¼\r\n      e.target.blur();\r\n      this.ngZone.runOutsideAngular(() => {\r\n        setTimeout(() => {\r\n          if (this.rts && this.rts.getFormState('lookup.pending')) {\r\n            e.preventDefault();\r\n            return;\r\n          }\r\n          this.enterNextCell();\r\n        }, 201);\r\n      });\r\n    }\r\n  }\r\n\r\n  /*\r\n     * ç»å®grid option\r\n     * @param dataItem è¡æ°æ®\r\n     */\r\n  private bindingGridOption() {\r\n    if (!this.farrisBindingGridOption) {\r\n      return;\r\n    }\r\n    Object.defineProperty(this.grid, 'gridOption', { value: this.farrisBindingGridOption });\r\n  }\r\n\r\n  /*\r\n   * æ´æ°Gridåé¡µç¶æ\r\n   * @param take\r\n   * @param skip\r\n   */\r\n  private updatePager(take: number, skip: number) {\r\n    if (take === 0) {\r\n      this.currentSkip = 0;\r\n      this.pageSize = 0;\r\n      this.skip = 0;\r\n      this.grid.pageable = false;\r\n    } else {\r\n      this.currentSkip = skip;\r\n      this.skip = skip;\r\n      this.pageSize = take;\r\n      this.grid.pageable = {\r\n        buttonCount: 10,\r\n        info: true,\r\n        type: 'numeric',\r\n        pageSizes: false,\r\n        previousNext: true\r\n      };\r\n    }\r\n  }\r\n\r\n  /*\r\n   * è®¾ç½®ååæ ¼å¯ç¼è¾æ§\r\n   * @param dataItem è¡æ°æ®\r\n   * @param column åå¯¹è±¡\r\n   * @param rowIndex è¡ç´¢å¼\r\n   * @param columnIndex åç´¢å¼\r\n   * @param sender gridå®ä¾\r\n   */\r\n  setEditable(rowNumber: number, columnNumber: number) {\r\n    const data = this.grid.data['data'];\r\n    const { pageIndex = 1, pageSize = 0 } = this.getPagingInfo() || {};\r\n    const skip = this.bindingList.skip;\r\n    // ä¸åé¡µæèç¬¬ä¸é¡µæ¶åä¸éè¦ä¿®æ¹è¡å·\r\n    const dataRowNumber = pageSize === 0 || pageIndex === 1 ? rowNumber : rowNumber - skip;\r\n    let item = data[dataRowNumber];\r\n    if (this.gridOption.groupable) {\r\n      item = this.getGroupItem(data, dataRowNumber);\r\n    }\r\n    const originColums = this.getColumns(this.gridOption.fields);\r\n    const columns = this.getColumns(originColums);\r\n    /* åå¦åçé¡ºåºæ¹å æ¯å¦å­å¨åºå®å  é£ä¹åºè¯¥è·åçæ­£çåå¯¹è±¡ */\r\n    // let col = columns[columnNumber];\r\n\r\n    let tempIndex = columnNumber;\r\n    // å½ååç´¢å¼ä¸ä¸º0\r\n    if (this.grid['gridOption'].showLineNumber) {\r\n      tempIndex = tempIndex - 1;\r\n    }\r\n    if (this.grid.selectable && this.grid.selectable['mode'] === 'multiple') {\r\n      tempIndex = tempIndex - 1;\r\n    }\r\n    const col = columns[tempIndex];\r\n\r\n    const params = {\r\n      dataItem: item,\r\n      column: col,\r\n      rowIndex: rowNumber,\r\n      columnIndex: tempIndex,\r\n    };\r\n\r\n    // æ§å¶ååæ ¼çå¯ç¼è¾æ§\r\n    if (col && !col.editable) {\r\n      col.editable = (param: object) => true;\r\n    }\r\n    if (col && this.notReadOnly(col, params)) {\r\n      // è®¾ç½®å½åè¡\r\n      this.dataId = this.getSelectedIdFromGrid(item);\r\n      this.setSelectionIdToBindingData(this.dataId);\r\n      // const value = this.getValue(item, col.dataField);\r\n      // this.setValue(value, col);\r\n      this.sender.editCell(rowNumber, columnNumber - this.hiddenColLen, this.viewModel.form);\r\n    }\r\n\r\n  }\r\n  /*\r\n  è·åæ´æ° rowIndex columnIndex\r\n   */\r\n  updateIndex(rowNumber: number, columnIndex: number) {\r\n    const newColumnIndex = (columnIndex + 1) % this.len;\r\n    if (!newColumnIndex) {\r\n      const dataLen = this.bindingList.toJSON().length;\r\n      const newRowIndex = (rowNumber + 1) % dataLen;\r\n      return { rowIndex: newRowIndex, columnIndex: newColumnIndex };\r\n    }\r\n    return {\r\n      rowIndex: rowNumber,\r\n      columnIndex: newColumnIndex\r\n    };\r\n  }\r\n\r\n  /* æ¯å¦åªè¯» */\r\n  notReadOnly(column: any, param: any) {\r\n    if (!column) {\r\n      return false;\r\n    }\r\n    return column.editable(param) && !column.editor.readonly;\r\n  }\r\n\r\n  /*\r\n     * ç»åè¡¨èµå¼ æç»formcontrolèµå¼\r\n      */\r\n  setValue(value: any, column: any) {\r\n    const currentColumnType = column.dataType;\r\n    // åæ¶å¤æ­gridOptionçåå¯¹è±¡\r\n    const bindingData = this.viewModel.bindingData;\r\n    const fieldPaths = this.getFieldPaths(bindingData.bindingPath, column.dataField);\r\n    // å­å¨è¡ç¼è¾å¨\r\n    if (currentColumnType === 'date') {\r\n      let dateStr = this.dateService.formatTo(value, 'yyyy-MM-dd HH:mm:ss');\r\n      if (!dateStr) {\r\n        dateStr = '';\r\n      }\r\n      this.viewModel.bindingData.setValue(fieldPaths, dateStr, true, true);\r\n    } else {\r\n      this.viewModel.bindingData.setValue(fieldPaths, value, true, true);\r\n    }\r\n  }\r\n\r\n  /* åç»æ¶ è·åç¹å»è¡æ°æ® */\r\n  getGroupItem(data: any[], rowNumber: number) {\r\n    let index = rowNumber;\r\n    for (const i in data) {\r\n      if (index < data[i].items.length) {\r\n        return data[i].items[index];\r\n      } else {\r\n        index = index - data[i].items.length;\r\n      }\r\n    }\r\n  }\r\n\r\n  /*\r\n   * è·å ååæ ¼å¼  ä¸»ä»è¡¨æ¯æ\r\n   * @param dataItem è¡æ°æ®\r\n   * @param field å­æ®µ\r\n   */\r\n  getValue(dataItem: any, field: string) {\r\n    const index = field.indexOf('.');\r\n    if (index < 0) {\r\n      return dataItem[field];\r\n    }\r\n    const fields = field.split('.');\r\n    // fieldå­ç¬¦ä¸²ç»å\r\n    return fields.reduce((result: any, next: any) => {\r\n      return result[next];\r\n    }, dataItem);\r\n  }\r\n\r\n  /*\r\n  * è·å bindingData è·¯å¾\r\n  * @param bindingPath å½åç»å®çå­æ®µè·¯å¾\r\n  * @param fieldName å­æ®µ\r\n  */\r\n  private getFieldPaths(bindingPath: string, field: string): string[] {\r\n    let fieldPath = '';\r\n    if (bindingPath.length > 1) {\r\n      fieldPath = bindingPath.substr(1).replace(/\\//g, '.') + '.' + field;\r\n    } else {\r\n      fieldPath = field;\r\n    }\r\n    return fieldPath.split('.');\r\n  }\r\n\r\n  /**\r\n   * åè½¦è¿å¥ä¸ä¸ä¸ªååæ ¼\r\n   */\r\n  enterNextCell() {\r\n    const index = this.updateIndex(this.rowIndex, this.columnIndex);\r\n    if (!index.columnIndex && !index.rowIndex) {\r\n      const len = this.bindingList.toJSON().length;\r\n      // å¦æå­å¨æ·»å æ°æ®çAPI\r\n      this.appendRow.emit();\r\n      if (this.appendRow.observers && this.appendRow.observers.length) {\r\n        this.interVal = setInterval(() => {\r\n          if (this.bindingList.toJSON().length - 1 === len) {\r\n            this.setEditable(this.bindingList.toJSON().length - 1, 0);\r\n            this.rowIndex = this.bindingList.toJSON().length - 1;\r\n            this.columnIndex = 0;\r\n            clearInterval(this.interVal);\r\n          }\r\n        }, 0);\r\n        return;\r\n      }\r\n    }\r\n\r\n    this.setEditable(index.rowIndex, index.columnIndex);\r\n    this.rowIndex = index.rowIndex;\r\n    this.columnIndex = index.columnIndex;\r\n  }\r\n\r\n  /* è·åçæ­£çåå¯¹è±¡ */\r\n  getColumns(columns: any) {\r\n    // å¤æ­æ¯å¦å­å¨åºå®å\r\n    const hasLocked = columns.some((ele: any) => {\r\n      return ele.frozen;\r\n    });\r\n    if (hasLocked) {\r\n      const lockedColumns = columns.filter((ele: any) => {\r\n        return ele.frozen;\r\n      });\r\n      const notLockedColumns = columns.filter((ele: any) => {\r\n        return !ele.frozen;\r\n      });\r\n      return [...lockedColumns, ...notLockedColumns];\r\n    }\r\n    return columns;\r\n  }\r\n\r\n  /*\r\n   * æ¸²ææå®è¡ä¸ºéä¸­è¡ï¼å°æå®è¡çkeyæ·»å å°éä¸­è¡éåä¸­\r\n   */\r\n  private renderSelectionRow(key: string, selectedKeys: any[]) {\r\n    if (!key || key === '') {\r\n      return;\r\n    }\r\n\r\n    // TODO:ä½¿ç¨ç­ç¥æ¨¡å¼éæ\r\n    if (this.IsMultipleSelectionMode) {\r\n      const index = selectedKeys.indexOf(key);\r\n      if (index >= 0) {\r\n        return;\r\n      }\r\n\r\n      selectedKeys.push(key);\r\n    } else {\r\n      if (selectedKeys.length === 1 && selectedKeys[0] === key) {\r\n        return;\r\n      }\r\n\r\n      selectedKeys.splice(0, selectedKeys.length);\r\n      selectedKeys.push(key);\r\n    }\r\n\r\n    this.selectionDir.selectedKeysChange.emit(selectedKeys); // æå¨è§¦åselectedKeysChangeäºä»¶\r\n  }\r\n\r\n  /*\r\n   * è·åGridä¸çå½åè¡åç \r\n   * @param dataItem è¡æ°æ®\r\n   */\r\n  private getSelectedIdFromGrid(dataItem: any) {\r\n    const primaryKey = this.bindingList.primaryKey;\r\n    return dataItem[primaryKey];\r\n  }\r\n\r\n  /*\r\n   * è®¾ç½®BindingListçå½åè¡\r\n   * @param id å½åè¡åç \r\n   */\r\n  private setSelectionIdToBindingData(id: string): void {\r\n    this.bindingList.setCurrentId(id, true);\r\n  }\r\n\r\n  /*\r\n  *åè¡¨æ´ä½æ¯å¦å¯ç¼è¾\r\n   */\r\n  isEditable() {\r\n    if (this.editable === undefined) {\r\n      if (!this.viewModel.stateMachine) {\r\n        // ç¶ææºä¸å­å¨çæ¶å\r\n        return false;\r\n      }\r\n      // ç¶ææºå­å¨çæ¶å\r\n      return this.viewModel.stateMachine['editable'];\r\n    }\r\n    // èªå®ä¹èµå¼\r\n    return this.editable;\r\n  }\r\n  /*  */\r\n  isDataChanged() {\r\n    let hasUnsavedData = false;\r\n    const entityArray = this.viewModel.frameContext.repository.entityCollection.toArray();\r\n    for (const entity of entityArray) {\r\n      if (entity.changes.length > 0) {\r\n        hasUnsavedData = true;\r\n        break;\r\n      }\r\n    }\r\n    return hasUnsavedData;\r\n  }\r\n}\r\n","\r\n/*\r\n * @Author: Witt\r\n * @Date: 2019-04-01 17:26:50\r\n * @Last Modified by: aalizzwell\r\n * @Last Modified time: 2019-12-12 16:17:06\r\n */\r\nimport { FrameContext } from '@farris/devkit';\r\nimport { TreeNode, TreeTableComponent } from '@farris/ui-treetable';\r\nimport { PathHierarchyInfo } from './types';\r\n// tslint:disable: no-string-literal\r\n/**\r\n * æ èç¹æé å¨\r\n * @summary\r\n * å°BindingDataä¸­çæ°æ®éåè½¬æ¢æTreeTableèç¹éå\r\n */\r\nclass PathTreeNodeBuilder {\r\n  private levelGroup: { [level: string]: any[] } = {};\r\n  private frameContext: FrameContext;\r\n  /**\r\n   * æé å½æ°\r\n   */\r\n  constructor(allNodesData: any[], oldTreeNodes: TreeNode[], primaryKey: string, hierarchyInfoKey: string, context?: any) {\r\n    this.primaryKey = primaryKey;\r\n    this.hierarchyInfoKey = hierarchyInfoKey;\r\n    this.allNodes = [];\r\n    this.allNodesData = allNodesData;\r\n    this.context = context || {};\r\n    this.nodesWaitExpand = [];\r\n    this.nodesShouldExpand = context && context.nodesShouldExpand || [];\r\n    this.frameContext = context && context.frameContext || null;\r\n    this.addTreeLoadCompleteListener(this.onTreeLoadComplete.bind(this));\r\n\r\n    this.initLevelGroup();\r\n    this.allNodesMap = new Map<string, TreeNode>();\r\n    this.allOldNodesMap = new Map<string, TreeNode>();\r\n    this.buildNodesDataMap(oldTreeNodes);\r\n  }\r\n  /**\r\n   * å±å¼è³å±çº§\r\n   * @description -1ä¸ºä¸å±å¼\r\n   */\r\n  private get expandLevel() {\r\n    return this.context && this.context.hasOwnProperty('expandLevel') ? this.context['expandLevel'] : -1;\r\n  }\r\n  private get component(): TreeTableComponent {\r\n    return this.context && this.context['component'];\r\n  }\r\n  private get addTreeLoadCompleteListener() {\r\n    return this.context && this.context['addTreeLoadCompleteListener'] || function (args: any) { };\r\n  }\r\n  /**\r\n   * éè¦å±å¼çèç¹\r\n   */\r\n  private nodesShouldExpand: string[];\r\n  /**\r\n   * ç­å¾å±å¼çèç¹\r\n   * @description èç¹ç»æ\r\n   * ```\r\n   * {id:'xxx',expanded:false}\r\n   * ```\r\n   */\r\n  private nodesWaitExpand: any[] = [];\r\n\r\n  /**\r\n   * ä¸»é®å­æ®µå\r\n   */\r\n  private primaryKey: string;\r\n\r\n  /**\r\n   * åçº§ç å­æ®µå\r\n   */\r\n  private hierarchyInfoKey: string;\r\n\r\n  /**\r\n   * èç¹çæ°æ®éå\r\n   */\r\n  private allNodesData: any[];\r\n\r\n  /**\r\n   * èç¹éå\r\n   */\r\n  private allNodes: TreeNode[];\r\n\r\n  /**\r\n   * ä¸ä¸æ¬¡ç»å®çæ èç¹éåMap\r\n   */\r\n  private allNodesMap: Map<string, TreeNode>;\r\n\r\n  /**\r\n   * ä¸ä¸æ¬¡ç»å®çæ èç¹éåMap\r\n   */\r\n  private allOldNodesMap: Map<string, TreeNode>;\r\n  /**\r\n   * ä¸ä¸æ\r\n   */\r\n  private context: any;\r\n  public updateTreeNode(allNodesData: any, data: any) {\r\n    this.allNodesData = allNodesData;\r\n    this.initLevelGroup();\r\n    this.buildNodesDataMap(data);\r\n  }\r\n  public build(): TreeNode[] {\r\n    const tree: TreeNode[] = [];\r\n    const childrenOf = {};\r\n    const nodes = {};\r\n    this.allNodesData.forEach(item => {\r\n      const id = item.id;\r\n      const parentId = this.getParentId(item);\r\n\r\n      // item.parentId = parentId;\r\n      // å±å¼æ°å¢èç¹çç¶èç¹\r\n      const isNewNode = this.isNewNode(item);\r\n      if (isNewNode === true) {\r\n        this.expandParentNode(item);\r\n      }\r\n      // æé æ èç¹\r\n      const node = this.buildNode(item);\r\n      nodes[id] = node;\r\n      childrenOf[id] = childrenOf[id] || [];\r\n      node.children = childrenOf[id];\r\n\r\n      this.allNodesMap.set(item[this.primaryKey], node);\r\n      if (parentId) {\r\n        if (nodes[parentId] && nodes[parentId].unstableState === true) {\r\n          nodes[parentId].expanded = true;\r\n          nodes[parentId].unstableState = false;\r\n        }\r\n        childrenOf[parentId] = childrenOf[parentId] || [];\r\n        childrenOf[parentId].push(node);\r\n      } else {\r\n        if ((!node.children || node.children.length < 1) && node.expanded === true) {\r\n          node.unstableState = true;\r\n          node.expanded = false;\r\n        }\r\n        tree.push(node);\r\n      }\r\n    });\r\n    return tree;\r\n  }\r\n  /**\r\n   * æé æ èç¹\r\n   */\r\n  public build1(): TreeNode[] {\r\n    let minLayer;\r\n    // è·åæé¡¶çº§èç¹çlayer\r\n    this.allNodesData.forEach(node => {\r\n      const hierarchyInfo = this.getHierarchyInfo(node);\r\n      if (hierarchyInfo) {\r\n        const layer = hierarchyInfo['layer'];\r\n        if (!isNaN(layer)) {\r\n          if (minLayer === undefined) {\r\n            minLayer = layer;\r\n          } else if (layer < minLayer) {\r\n            minLayer = layer;\r\n          }\r\n        }\r\n      }\r\n    });\r\n    const topLayer = minLayer - 1;\r\n    this.buildNodes('', topLayer, this.allNodesData, this.allNodes);\r\n    return this.allNodes;\r\n  }\r\n\r\n  /**\r\n   * æé æ èç¹éå\r\n   */\r\n  private buildNodes(fPath: string, fLayer: number, allNodesData: any[], treeNodes: TreeNode[]): void {\r\n    const childNodesData = this.getChildNodesData(fPath, fLayer);\r\n    childNodesData.forEach((nodeData: any) => {\r\n      // å±å¼æ°å¢èç¹çç¶èç¹\r\n      const isNewNode = this.isNewNode(nodeData);\r\n      if (isNewNode === true) {\r\n        this.expandParentNode(nodeData);\r\n      }\r\n\r\n      // æé æ èç¹\r\n      const node = this.buildNode(nodeData);\r\n      treeNodes.push(node);\r\n      this.allNodesMap.set(nodeData[this.primaryKey], node);\r\n\r\n      // éå½éåä¸çº§èç¹\r\n      const hierarchyInfo = this.getHierarchyInfo(nodeData);//nodeData[this.hierarchyInfoKey];\r\n      const currentLayer = hierarchyInfo['layer'];\r\n      const currentPath = hierarchyInfo['path'];\r\n      this.buildNodes(currentPath, currentLayer, allNodesData, node.children as TreeNode[]);\r\n    });\r\n  }\r\n\r\n  /**\r\n   * åå»ºæ èç¹\r\n   */\r\n  private buildNode(nodeData: any): TreeNode & { unstableState?: boolean } {\r\n    const isLeaf = this.isLeaf(nodeData);\r\n    // è·åèç¹çå±å¼ç¶æ\r\n    const shouldExpand = this.shouldExpand(nodeData);\r\n    // èç¹è½ç¶åºè¯¥å±å¼ï¼ä½å¯è½æ¯å ä¸ºä¹åå°±æ¯å±å¼ç¶æï¼æä»¥åºè¯¥æ£æ¥èç¹ä¹åçç¶æ\r\n    const originExpandStatus = this.isExpanded(nodeData);\r\n    // å¦æåºè¯¥å±å¼è¯¥èç¹ï¼ä½æ¯è¯¥èç¹ä¹åæç¶æï¼é£ä¹è¯¥èç¹ä¸åºè¯¥åç±ç¨åºå±å¼ã\r\n    if (!originExpandStatus && shouldExpand) {\r\n      this.expandNode(nodeData);\r\n    }\r\n    const paginationInfo = this.buildPaginationInfo(nodeData);\r\n    const treeNode: TreeNode = {\r\n      data: Object.assign({}, nodeData),\r\n      children: [],\r\n      expanded: shouldExpand,\r\n      leaf: isLeaf\r\n    };\r\n    if (paginationInfo) {\r\n      treeNode.pagination = paginationInfo;\r\n    }\r\n    return treeNode;\r\n  }\r\n  /**\r\n   * æé åé¡µä¿¡æ¯\r\n   * @param nodeData nodeData\r\n   * @returns \r\n   */\r\n  private buildPaginationInfo(nodeData: any): { pageIndex: number, pageSize: number, total: number } | null {\r\n    let result = null;\r\n    if (this.frameContext) {\r\n      const id = this.getPrimary(nodeData);\r\n      // è·ååé¡µä¿¡æ¯\r\n      const key = `_NODE_${id}_PAGINATION_INFO_`;\r\n      const pagination = this.frameContext.params.get(key) || null;\r\n      if (pagination && pagination.pageCount > 1) {\r\n        result = {\r\n          pageIndex: pagination.pageIndex,\r\n          pageSize: pagination.pageSize,\r\n          total: pagination.totalCount\r\n        };\r\n      }\r\n    }\r\n    return result;\r\n  }\r\n  /**\r\n   * è®¡ç®èç¹æ¯å¦éè¦å±å¼\r\n   * @param nodeData nodeData\r\n   */\r\n  private shouldExpand(nodeData: any): boolean {\r\n    const [layer, isLeaf] = [this.getNodeLayer(nodeData), this.isLeaf(nodeData)];\r\n    // æ°¸è¿ä¸å±å¼å¶å­èç¹\r\n    if (isLeaf) {\r\n      return false;\r\n    }\r\n    let expanded = this.isExpanded(nodeData);\r\n    if (!expanded) {\r\n      const id = this.getPrimary(nodeData);\r\n      if (this.nodesWaitExpand.findIndex(node => node && node.id === id) > -1) {\r\n        return false;\r\n      }\r\n      if (this.nodesShouldExpand.findIndex(nodeId => nodeId === id) > -1) {\r\n        return true;\r\n      }\r\n      if (this.expandLevel === -1) {\r\n        // -1 ä¸ºä¸å±å¼\r\n        expanded = false;\r\n      } else if (this.expandLevel === 0) {\r\n        // 0 ä¸ºå¨é¨å±å¼\r\n        expanded = true;\r\n      } else {\r\n        // æ²¡æå¯ç¨åå±å è½½ï¼éè¿å±å¼å±çº§ç¡®å®æ¯å¦å±å¼è¯¥èç¹\r\n        expanded = layer <= this.expandLevel;\r\n        // å¦æèç¹åæ¬å­å¨ä¸èç¹æ²¡æå±å¼åä¸å±å¼\r\n        const oldTreeNode = this.getOldNode(nodeData);\r\n        if (oldTreeNode && !oldTreeNode.expanded) {\r\n          expanded = false;\r\n        }\r\n      }\r\n    }\r\n    return expanded;\r\n  }\r\n  /**\r\n   * å±å¼æ èç¹\r\n   * @description å®å¨å è½½æ ä½¿ç¨å±å¼å±æ§å¨buildNodeæ¶å·²ç»å±å¼ï¼æ­¤å½æ°çä¸»è¦ç¨äºå±å¼åçº§å è½½æ \r\n   * @param nodeData nodeData\r\n   */\r\n  private expandNode(nodeData: any) {\r\n    const [path, layer] = [this.getNodePath(nodeData), this.getNodeLayer(nodeData)];\r\n    const childs = this.getChildNodesData(path, layer);\r\n\r\n    // å½åèç¹ä¸æ¯å¶å­èç¹ï¼ä½å¨èç¹æ°æ®ä¸­åæ¾ä¸å°è¯¥èç¹çå­èç¹ï¼åè®¤ä¸ºæ å¯ç¨äºåå±å è½½\r\n    if (!childs || childs.length < 1) {\r\n      // åå±å è½½æ éè¦éè¿è§¦åèç¹å±å¼äºä»¶æå è½½ä¸å±ï¼ç®åæ ä¸è¿ä¸å­å¨è¯¥èç¹ï¼æ æ³ç´æ¥å±å¼ï¼éè¦ç­æ å è½½å®ä¹ååå±å¼\r\n      const id = this.getPrimary(nodeData);\r\n      if (this.nodesWaitExpand.findIndex(node => node && node.id === id) < 0) {\r\n        this.nodesWaitExpand.push({ id, expanded: false });\r\n      }\r\n    }\r\n  }\r\n  /**\r\n   * æ å è½½å®æäºä»¶\r\n   */\r\n  private onTreeLoadComplete() {\r\n    const index = this.nodesWaitExpand.findIndex(node => !node.expanded);\r\n    const nodeData = this.nodesWaitExpand[index] || {};\r\n    const { id } = nodeData;\r\n    if (id) {\r\n      const rowNode = this.component.findRowNode(id);\r\n      if (rowNode) {\r\n        nodeData.expanded = true;\r\n        // if (nodeData && nodeData.node && !nodeData.node.expanded) {\r\n        //   return;\r\n        // }\r\n        this.component.expandNode(id);\r\n      }\r\n    }\r\n  }\r\n  /**\r\n   * è·åä¸»é®\r\n   * @param nodeData nodeData\r\n   */\r\n  private getPrimary(nodeData: any) {\r\n    return nodeData[this.primaryKey];\r\n  }\r\n  // #region å·¥å·æ¹æ³ï¼å¾åç¬å°è£\r\n\r\n  /**\r\n   * è·åå­çº§èç¹çæ°æ®éå\r\n   */\r\n  private getChildNodesData(fPath: string, fLayer: number): any[] {\r\n    const childNodesData = [];\r\n    this.allNodesData.forEach((nodeData: any) => {\r\n\r\n      // @todoï¼å¾å é¤ï¼å¼å®¹æ²¡æhierarchyInfoçæ°æ®\r\n      const hierarchyInfo = this.getHierarchyInfo(nodeData);//this.getValue(nodeData, this.hierarchyInfoKey); /// nodeData[this.hierarchyInfoKey];\r\n      if (!hierarchyInfo) {\r\n        return;\r\n      }\r\n\r\n      // å¹éèç¹\r\n      const currentLayer = hierarchyInfo['layer'];\r\n      const currentPath = hierarchyInfo['path'];\r\n      if ((currentLayer === fLayer + 1) && currentPath && currentPath.startsWith(fPath)) {\r\n        childNodesData.push(nodeData);\r\n      }\r\n    });\r\n    return childNodesData;\r\n  }\r\n\r\n  private getHierarchyInfo(nodeData: any): PathHierarchyInfo {\r\n    return this.getValue(nodeData, this.hierarchyInfoKey);//nodeData[this.hierarchyInfoKey];\r\n  }\r\n\r\n  private initLevelGroup() {\r\n    this.levelGroup = {};\r\n    this.allNodesData.forEach((nodeData) => {\r\n      const hierarchyInfo = this.getHierarchyInfo(nodeData);\r\n      const key = `level${hierarchyInfo.layer}`;\r\n      if (this.levelGroup[key]) {\r\n        this.levelGroup[key].push(nodeData);\r\n      } else {\r\n        this.levelGroup[key] = [nodeData];\r\n      }\r\n    });\r\n  }\r\n  private getParentId(node: any) {\r\n    const hierarchyInfo = this.getHierarchyInfo(node);\r\n    const parentLevelGroup = this.levelGroup[this.getLevelGroupKey(hierarchyInfo.layer - 1)] || [];\r\n    const parent = parentLevelGroup.find(nodeData => {\r\n      const currentHierarchyInfo = this.getHierarchyInfo(nodeData);\r\n      if (currentHierarchyInfo.isDetail === true) {\r\n        return false;\r\n      }\r\n      return hierarchyInfo.path.startsWith(currentHierarchyInfo.path);\r\n    });\r\n    if (parent) {\r\n      return parent.id;\r\n    } else {\r\n      return null;\r\n    }\r\n  }\r\n  private getLevelGroupKey(level: any) {\r\n    return `level${level}`;\r\n  }\r\n  /**\r\n   * æ ¹æ®è·¯å¾è·åæ°æ®\r\n   * @param target target\r\n   * @param path è·¯å¾\r\n   */\r\n  private getValue(target: any, path: string) {\r\n    if (path.indexOf('/') === -1) {\r\n      return target[path];\r\n    }\r\n    const paths: any = path.split('/').filter(p => p);\r\n    if (paths.length < 1) {\r\n      return target;\r\n    }\r\n    return paths.reduce((result, path) => {\r\n      return result && result[path];\r\n    }, target);\r\n  }\r\n  /**\r\n   * è·ååçº§ä¿¡æ¯ä¸­çå±çº§\r\n   * @param nodeData nodeData\r\n   */\r\n  private getNodeLayer(nodeData: any) {\r\n    const hierarchyInfo = this.getHierarchyInfo(nodeData);\r\n    return hierarchyInfo['layer'];\r\n  }\r\n  /**\r\n   * è·ååçº§ä¿¡æ¯ä¸­çè·¯å¾\r\n   * @param nodeData nodeData\r\n   */\r\n  private getNodePath(nodeData: any) {\r\n    const hierarchyInfo = this.getHierarchyInfo(nodeData);\r\n    return hierarchyInfo['path'];\r\n  }\r\n  /**\r\n   * è·åå±å¼ç¶æ\r\n   */\r\n  private isExpanded(newData: any): boolean {\r\n    const oldTreeNode = this.getOldNode(newData);\r\n    return oldTreeNode ? oldTreeNode.expanded : undefined;\r\n  }\r\n\r\n  /**\r\n   * æ¯å¦æ¯å¶å­èç¹\r\n   * @todoï¼æå¡å¨ç«¯å¯¹isDetailçç®åæ²¡æä¸åç«¯åæ­¥ï¼isDetailä¸åç¡®ã\r\n   */\r\n  private isLeaf(nodeData: any): boolean {\r\n    const hierarchyInfo = this.getHierarchyInfo(nodeData);// nodeData[this.hierarchyInfoKey];\r\n    const isDetail = hierarchyInfo['isDetail'];\r\n    return isDetail;\r\n  }\r\n\r\n  /**\r\n   * å¤æ­èç¹æ¯å¦æ¯æ°å¢\r\n   * @todoï¼ä¸åºè¯¥è¿æ ·å¤æ­ï¼å¾ä¼åã\r\n   * @summary\r\n   * 1ãéç©ºæ ï¼ç©ºæ è§ä¸ºåæ¬¡å è½½æ°æ®ï¼ï¼\r\n   * 2ãæ¾ä¸å°oldNodeã\r\n   */\r\n  private isNewNode(nodeData: any): boolean {\r\n    if (this.allOldNodesMap.size === 0) {\r\n      return false;\r\n    }\r\n    const oldTreeNode = this.getOldNode(nodeData);\r\n    return oldTreeNode ? false : true;\r\n  }\r\n\r\n  /**\r\n   * å±å¼ç¶èç¹\r\n   */\r\n  private expandParentNode(nodeData: any): void {\r\n    const parentTreeNode = this.getParentNode(nodeData);\r\n    if (!parentTreeNode) {\r\n      return;\r\n    }\r\n    parentTreeNode.leaf = false;\r\n    parentTreeNode.expanded = true;\r\n  }\r\n\r\n  /**\r\n   * æ¥æ¾ç¶èç¹\r\n   */\r\n  private getParentNode(nodeData: any): TreeNode {\r\n    const hierarchyInfo = this.getHierarchyInfo(nodeData);//nodeData[this.hierarchyInfoKey];\r\n    const layer = hierarchyInfo['layer'];\r\n    const path = hierarchyInfo['path'];\r\n\r\n    const allNodes = Array.from(this.allNodesMap.values());\r\n    const parentNode = allNodes.find((currentNode: TreeNode) => {\r\n      const currentLayer = this.getValue(currentNode.data, this.hierarchyInfoKey)['layer'];//currentNode.data[this.hierarchyInfoKey]['layer'];\r\n      const currentPath = this.getValue(currentNode.data, this.hierarchyInfoKey)['path'];//  currentNode.data[this.hierarchyInfoKey]['path'];\r\n      if ((layer === currentLayer + 1) && path.startsWith(currentPath) === true) {\r\n        return true;\r\n      }\r\n      return false;\r\n    });\r\n    return parentNode;\r\n  }\r\n\r\n  /**\r\n   * è·åèçæ èç¹\r\n   */\r\n  private getOldNode(nodeData: any): TreeNode {\r\n    const id = nodeData[this.primaryKey];\r\n    return this.allOldNodesMap.get(id);\r\n  }\r\n\r\n  /**\r\n   * æå¹³TreeNodesï¼å¹¶æ¾å¥ä¸ä¸ªMapä¸­\r\n   */\r\n  private buildNodesDataMap(treeNodes: TreeNode[]): void {\r\n    treeNodes.forEach((treeNode: TreeNode) => {\r\n      this.allOldNodesMap.set(treeNode.data[this.primaryKey], treeNode);\r\n      if (treeNode.children) {\r\n        this.buildNodesDataMap(treeNode.children);\r\n      }\r\n    });\r\n  }\r\n\r\n  // #endregion\r\n}\r\n\r\nexport { PathTreeNodeBuilder };\r\n","/*\r\n * @Author: aalizzwell \r\n * @Date: 2019-05-31 09:48:10 \r\n * @Last Modified by: aalizzwell\r\n * @Last Modified time: 2019-06-24 17:00:58\r\n */\r\n\r\nimport { FrameContext } from '@farris/devkit';\r\nimport { TreeNode, TreeTableComponent } from '@farris/ui-treetable';\r\nimport { ParentHierarchyInfo } from './types';\r\n// tslint:disable: no-string-literal max-line-length\r\n/**\r\n * æ èç¹æé å¨\r\n * @summary\r\n * å°BindingDataä¸­çæ°æ®éåè½¬æ¢æTreeTableèç¹éå\r\n */\r\nclass ParentTreeNodeBuilder {\r\n  private frameContext: FrameContext;\r\n  /**\r\n   * æé å½æ°\r\n   */\r\n  constructor(allNodesData: any[], oldTreeNodes: TreeNode[], primaryKey: string, hierarchyInfoKey: string, context?: any) {\r\n    this.primaryKey = primaryKey;\r\n    this.hierarchyInfoKey = hierarchyInfoKey;\r\n    this.allNodes = [];\r\n    this.allNodesData = allNodesData;\r\n    this.context = context || {};\r\n    this.nodesWaitExpand = [];\r\n    this.nodesShouldExpand = context && context.nodesShouldExpand || [];\r\n    this.frameContext = context && context.frameContext || null;\r\n    this.addTreeLoadCompleteListener(this.onTreeLoadComplete.bind(this));\r\n\r\n    this.allNodesMap = new Map<string, TreeNode>();\r\n    this.allOldNodesMap = new Map<string, TreeNode>();\r\n    this.buildNodesDataMap(oldTreeNodes);\r\n  }\r\n  /**\r\n   * å±å¼è³å±çº§\r\n   * @description -1ä¸ºä¸å±å¼\r\n   */\r\n  private get expandLevel() {\r\n    return this.context && this.context.hasOwnProperty('expandLevel') ? this.context['expandLevel'] : -1;\r\n  }\r\n  private get component(): TreeTableComponent {\r\n    return this.context && this.context['component'];\r\n  }\r\n  private get addTreeLoadCompleteListener() {\r\n    return this.context && this.context['addTreeLoadCompleteListener'] || function (args: any) { };\r\n  }\r\n  /**\r\n   * éè¦å±å¼çèç¹\r\n   */\r\n  private nodesShouldExpand: string[];\r\n\r\n  /**\r\n   * ç­å¾å±å¼çèç¹\r\n   * @description èç¹ç»æ\r\n   * ```\r\n   * {id:'xxx',expanded:false}\r\n   * ```\r\n   */\r\n  private nodesWaitExpand: any[] = [];\r\n\r\n  /**\r\n   * ä¸»é®å­æ®µå\r\n   */\r\n  private primaryKey: string;\r\n\r\n  /**\r\n   * åçº§ç å­æ®µå\r\n   */\r\n  private hierarchyInfoKey: string;\r\n\r\n  /**\r\n   * èç¹çæ°æ®éå\r\n   */\r\n  private allNodesData: any[];\r\n\r\n  /**\r\n   * èç¹éå\r\n   */\r\n  private allNodes: TreeNode[];\r\n\r\n  /**\r\n   * ä¸ä¸æ¬¡ç»å®çæ èç¹éåMap\r\n   */\r\n  private allNodesMap: Map<string, TreeNode>;\r\n\r\n  /**\r\n   * ä¸ä¸æ¬¡ç»å®çæ èç¹éåMap\r\n   */\r\n  private allOldNodesMap: Map<string, TreeNode>;\r\n\r\n  /**\r\n   * ä¸ä¸æ\r\n   */\r\n  private context: any;\r\n\r\n  public updateTreeNode(allNodesData: any, data: any) {\r\n    this.allNodesData = allNodesData;\r\n    this.buildNodesDataMap(data);\r\n  }\r\n  public build(): TreeNode[] {\r\n    let tree: TreeNode[] = [];\r\n    const childrenOf = {};\r\n    const parents = {};\r\n    const nodes = {};\r\n    this.allNodesData.forEach(item => {\r\n      const id = item.id;\r\n      const parentId = this.getHierarchyInfo(item).parentElement;\r\n\r\n      // item.parentId = parentId;\r\n      // å±å¼æ°å¢èç¹çç¶èç¹\r\n      const isNewNode = this.isNewNode(item);\r\n      if (isNewNode === true) {\r\n        this.expandParentNode(item);\r\n      }\r\n      // æé æ èç¹\r\n      const node = this.buildNode(item);\r\n      nodes[id] = node;\r\n      childrenOf[id] = childrenOf[id] || [];\r\n      node.children = childrenOf[id];\r\n\r\n      parents[parentId] = parents[parentId] || [];\r\n      parents[parentId].push(node);\r\n      this.allNodesMap.set(item[this.primaryKey], node);\r\n      if (parentId) {\r\n        if (nodes[parentId] && nodes[parentId].unstableState === true) {\r\n          nodes[parentId].expanded = true;\r\n          nodes[parentId].unstableState = false;\r\n        }\r\n        childrenOf[parentId] = childrenOf[parentId] || [];\r\n        childrenOf[parentId].push(node);\r\n      } else {\r\n        if ((!node.children || node.children.length < 1) && node.expanded === true) {\r\n          node.unstableState = true;\r\n          node.expanded = false;\r\n        }\r\n        tree.push(node);\r\n      }\r\n    });\r\n    // ææèç¹é½æ¯parentIdï¼æ²¡æè¿åæ ¹èç¹\r\n    if ((!tree || tree.length < 1) && this.allNodesData && this.allNodesData.length > 0) {\r\n      const parentIds = Object.keys(parents);\r\n      parentIds.forEach(parentId => {\r\n        if (!this.allNodesData.find(item => item.id === parentId)) {\r\n          tree = tree.concat(parents[parentId]);\r\n        }\r\n      });\r\n    }\r\n    return tree;\r\n  }\r\n  /**\r\n   * æé æ èç¹\r\n   */\r\n  public build1(): TreeNode[] {\r\n    let minLayer;\r\n    // è·åæé¡¶çº§èç¹çlayer\r\n    this.allNodesData.forEach(node => {\r\n      const hierarchyInfo = this.getHierarchyInfo(node);\r\n      if (hierarchyInfo) {\r\n        const layer = hierarchyInfo['layer'];\r\n        if (!isNaN(layer)) {\r\n          if (minLayer === undefined) {\r\n            minLayer = layer;\r\n          } else if (layer < minLayer) {\r\n            minLayer = layer;\r\n          }\r\n        }\r\n      }\r\n    });\r\n    const topLayer = minLayer - 1;\r\n    this.buildNodes('', topLayer, this.allNodesData, this.allNodes);\r\n    return this.allNodes;\r\n  }\r\n\r\n  /**\r\n   * æé æ èç¹éå\r\n   */\r\n  private buildNodes(fParentElement: string, fLayer: number, allNodesData: any[], treeNodes: TreeNode[]): void {\r\n    const childNodesData = this.getChildNodesData(fParentElement, fLayer);\r\n    childNodesData.forEach((nodeData: any) => {\r\n\r\n      // å±å¼æ°å¢èç¹çç¶èç¹\r\n      const isNewNode = this.isNewNode(nodeData);\r\n      if (isNewNode === true) {\r\n        this.expandParentNode(nodeData);\r\n      }\r\n\r\n      // æé æ èç¹\r\n      const node = this.buildNode(nodeData);\r\n      treeNodes.push(node);\r\n      this.allNodesMap.set(nodeData[this.primaryKey], node);\r\n\r\n      // éå½éåä¸çº§èç¹\r\n      const hierarchyInfo = this.getHierarchyInfo(nodeData); //nodeData[this.hierarchyInfoKey];\r\n      const currentLayer = hierarchyInfo['layer'];\r\n      const currentId = nodeData[this.primaryKey];\r\n      this.buildNodes(currentId, currentLayer, allNodesData, node.children as TreeNode[]);\r\n    });\r\n  }\r\n\r\n  /**\r\n   * åå»ºæ èç¹\r\n   */\r\n  private buildNode(nodeData: any): TreeNode & { unstableState?: boolean } {\r\n    const isLeaf = this.isLeaf(nodeData);\r\n    // è·åèç¹çå±å¼ç¶æ\r\n    const shouldExpand = this.shouldExpand(nodeData);\r\n    // èç¹è½ç¶åºè¯¥å±å¼ï¼ä½å¯è½æ¯å ä¸ºä¹åå°±æ¯å±å¼ç¶æï¼æä»¥åºè¯¥æ£æ¥èç¹ä¹åçç¶æ\r\n    const originExpandStatus = this.isExpanded(nodeData);\r\n    // å¦æåºè¯¥å±å¼è¯¥èç¹ï¼ä½æ¯è¯¥èç¹ä¹åæç¶æï¼é£ä¹è¯¥èç¹ä¸åºè¯¥åç±ç¨åºå±å¼ã\r\n    if (!originExpandStatus && shouldExpand) {\r\n      this.expandNode(nodeData);\r\n    }\r\n    const paginationInfo = this.buildPaginationInfo(nodeData);\r\n    const treeNode: TreeNode = {\r\n      data: Object.assign({}, nodeData),\r\n      children: [],\r\n      expanded: shouldExpand,\r\n      leaf: isLeaf\r\n    };\r\n    if (paginationInfo) {\r\n      treeNode.pagination = paginationInfo;\r\n    }\r\n    return treeNode;\r\n  }\r\n  /**\r\n   * æé åé¡µä¿¡æ¯\r\n   * @param nodeData nodeData\r\n   * @returns \r\n   */\r\n  private buildPaginationInfo(nodeData: any): { pageIndex: number, pageSize: number, total: number } | null {\r\n    let result = null;\r\n    if (this.frameContext) {\r\n      const id = this.getPrimary(nodeData);\r\n      // è·ååé¡µä¿¡æ¯\r\n      const key = `_NODE_${id}_PAGINATION_INFO_`;\r\n      const pagination = this.frameContext.params.get(key) || null;\r\n      if (pagination && pagination.pageCount > 1) {\r\n        result = {\r\n          pageIndex: pagination.pageIndex,\r\n          pageSize: pagination.pageSize,\r\n          total: pagination.totalCount\r\n        };\r\n      }\r\n    }\r\n    return result;\r\n  }\r\n  /**\r\n   * è®¡ç®èç¹æ¯å¦è¦å±å¼\r\n   * @param nodeData nodeData\r\n   */\r\n  private shouldExpand(nodeData: any) {\r\n    const [isLeaf, layer] = [this.isLeaf(nodeData), this.getNodeLayer(nodeData)];\r\n    // æ°¸è¿ä¸å±å¼å¶å­èç¹\r\n    if (isLeaf) {\r\n      return false;\r\n    }\r\n    let expanded = this.isExpanded(nodeData);\r\n    if (!expanded) {\r\n      const id = this.getPrimary(nodeData);\r\n      if (this.nodesWaitExpand.findIndex(node => node && node.id === id) > -1) {\r\n        return false;\r\n      }\r\n      if (this.nodesShouldExpand.findIndex(nodeId => nodeId === id) > -1) {\r\n        return true;\r\n      }\r\n      if (this.expandLevel === -1) {\r\n        // -1 ä¸ºä¸å±å¼\r\n        expanded = false;\r\n      } else if (this.expandLevel === 0) {\r\n        // 0 ä¸ºå¨é¨å±å¼\r\n        expanded = true;\r\n      } else {\r\n        // æ²¡æå¯ç¨åå±å è½½ï¼éè¿å±å¼å±çº§ç¡®å®æ¯å¦å±å¼è¯¥èç¹\r\n        expanded = layer <= this.expandLevel;\r\n        // å¦æèç¹åæ¬å­å¨ä¸èç¹æ²¡æå±å¼åä¸å±å¼\r\n        const oldTreeNode = this.getOldNode(nodeData);\r\n        if (oldTreeNode && !oldTreeNode.expanded) {\r\n          expanded = false;\r\n        }\r\n      }\r\n    }\r\n    return expanded;\r\n  }\r\n  /**\r\n   * å±å¼æ èç¹\r\n   * @description å®å¨å è½½æ ä½¿ç¨å±å¼å±æ§å¨buildNodeæ¶å·²ç»å±å¼ï¼æ­¤å½æ°çä¸»è¦ç¨äºå±å¼åçº§å è½½æ \r\n   * @param nodeData nodeData\r\n   */\r\n  private expandNode(nodeData: any) {\r\n    const [element, layer] = [nodeData[this.primaryKey], this.getNodeLayer(nodeData)];\r\n    const childs = this.getChildNodesData(element, layer);\r\n\r\n    // å½åèç¹ä¸æ¯å¶å­èç¹ï¼ä½å¨èç¹æ°æ®ä¸­åæ¾ä¸å°è¯¥èç¹çå­èç¹ï¼åè®¤ä¸ºæ å¯ç¨äºåå±å è½½\r\n    if (!childs || childs.length < 1) {\r\n      // åå±å è½½æ éè¦éè¿è§¦åèç¹å±å¼äºä»¶æå è½½ä¸å±,ç®åæ ä¸è¿ä¸å­å¨è¯¥èç¹ï¼æ æ³ç´æ¥å±å¼ï¼éè¦ç­æ å è½½å®ä¹ååå±å¼\r\n      const id = this.getPrimary(nodeData);\r\n      if (this.nodesWaitExpand.findIndex(node => node && node.id === id) < 0) {\r\n        this.nodesWaitExpand.push({ id, expanded: false });\r\n      }\r\n    }\r\n  }\r\n  /**\r\n   * æ å è½½å®æäºä»¶\r\n   */\r\n  private onTreeLoadComplete() {\r\n    const index = this.nodesWaitExpand.findIndex(node => !node.expanded);\r\n    const nodeData = this.nodesWaitExpand[index] || {};\r\n    const { id } = nodeData;\r\n    if (id) {\r\n      const rowNode = this.component.findRowNode(id);\r\n      if (rowNode) {\r\n        nodeData.expanded = true;\r\n        // if (nodeData && nodeData.node && !nodeData.node.expanded) {\r\n        //   return;\r\n        // }\r\n        this.component.expandNode(id);\r\n      }\r\n    }\r\n  }\r\n  /**\r\n   * è·åä¸»é®\r\n   * @param nodeData nodeData\r\n   */\r\n  private getPrimary(nodeData: any) {\r\n    return nodeData[this.primaryKey];\r\n  }\r\n  // #region å·¥å·æ¹æ³ï¼å¾åç¬å°è£\r\n\r\n  /**\r\n   * è·åå­çº§èç¹çæ°æ®éå\r\n   */\r\n  private getChildNodesData(fParentElement: string, fLayer: number): any[] {\r\n    const childNodesData = [];\r\n    this.allNodesData.forEach((nodeData: any) => {\r\n\r\n      // @todoï¼å¾å é¤ï¼å¼å®¹æ²¡æhierarchyInfoçæ°æ® \r\n      const hierarchyInfo = this.getHierarchyInfo(nodeData); //nodeData[this.hierarchyInfoKey];\r\n      if (!hierarchyInfo) {\r\n        return;\r\n      }\r\n\r\n      // å¹éèç¹\r\n      const currentLayer = hierarchyInfo['layer'];\r\n      const currentParentElement = hierarchyInfo['parentElement'];\r\n      if ((currentLayer === fLayer + 1) && (currentParentElement === fParentElement || (!currentParentElement && fParentElement === ''))) {\r\n        childNodesData.push(nodeData);\r\n      }\r\n    });\r\n    return childNodesData;\r\n  }\r\n  private getHierarchyInfo(nodeData: any): ParentHierarchyInfo {\r\n    return this.getValue(nodeData, this.hierarchyInfoKey);//nodeData[this.hierarchyInfoKey];\r\n  }\r\n  private getValue(target: any, path: string) {\r\n    if (path.indexOf('/') === -1) {\r\n      return target[path];\r\n    }\r\n    const paths: any = path.split('/').filter(p => p);\r\n    return paths.reduce((result, path) => {\r\n      return result && result[path];\r\n    }, target);\r\n  }\r\n  /**\r\n   * è·ååçº§ä¿¡æ¯ä¸­çå±çº§\r\n   * @param nodeData nodeData\r\n   */\r\n  private getNodeLayer(nodeData: any) {\r\n    const hierarchyInfo = this.getHierarchyInfo(nodeData);\r\n    return hierarchyInfo['layer'];\r\n  }\r\n  /**\r\n   * è·ååçº§ä¿¡æ¯ä¸­çç¶èç¹\r\n   * @param nodeData nodeData\r\n   */\r\n  private getNodeParentElement(nodeData: any) {\r\n    const hierarchyInfo = this.getHierarchyInfo(nodeData);\r\n    return hierarchyInfo['parentElement'];\r\n  }\r\n  /**\r\n   * è·åå±å¼ç¶æ\r\n   */\r\n  private isExpanded(newData: any): boolean {\r\n    const oldTreeNode = this.getOldNode(newData);\r\n    return oldTreeNode ? oldTreeNode.expanded : undefined;\r\n  }\r\n\r\n  /**\r\n   * æ¯å¦æ¯å¶å­èç¹\r\n   * @todoï¼åºè¯¥ç¨æ°æ®æ¬èº«çisDetailæ¥ä¿è¯ï¼ä½ç®åä¸åç¡®ï¼å¼ºå¶åç«¯è®¡ç®\r\n   */\r\n  private isLeaf(nodeData: any): boolean {\r\n    const hierarchyInfo = this.getHierarchyInfo(nodeData);//nodeData[this.hierarchyInfoKey];\r\n    const isDetail = hierarchyInfo['isDetail'];\r\n    return isDetail;\r\n  }\r\n\r\n  /**\r\n   * å¤æ­èç¹æ¯å¦æ¯æ°å¢\r\n   * @todoï¼ä¸åºè¯¥è¿æ ·å¤æ­ï¼å¾ä¼åã\r\n   * @summary\r\n   * 1ãéç©ºæ ï¼ç©ºæ è§ä¸ºåæ¬¡å è½½æ°æ®ï¼ï¼\r\n   * 2ãæ¾ä¸å°oldNodeã\r\n   */\r\n  private isNewNode(nodeData: any): boolean {\r\n    if (this.allOldNodesMap.size === 0) {\r\n      return false;\r\n    }\r\n    const oldTreeNode = this.getOldNode(nodeData);\r\n    return oldTreeNode ? false : true;\r\n  }\r\n\r\n  /**\r\n   * å±å¼ç¶èç¹\r\n   */\r\n  private expandParentNode(nodeData: any): void {\r\n    const parentTreeNode = this.getParentNode(nodeData);\r\n    if (!parentTreeNode) {\r\n      return;\r\n    }\r\n    parentTreeNode.leaf = false;\r\n    parentTreeNode.expanded = true;\r\n  }\r\n\r\n  /**\r\n   * æ¥æ¾ç¶èç¹\r\n   */\r\n  private getParentNode(nodeData: any): TreeNode {\r\n    const hierarchyInfo = this.getHierarchyInfo(nodeData);//nodeData[this.hierarchyInfoKey];\r\n    const layer = hierarchyInfo['layer'];\r\n    const parentElement = hierarchyInfo['parentElement'];\r\n\r\n    const allNodes = Array.from(this.allNodesMap.values());\r\n    const parentNode = allNodes.find((node: TreeNode) => {\r\n      const currentLayer = this.getValue(node.data, this.hierarchyInfoKey)['layer']; //node.data[this.hierarchyInfoKey]['layer'];\r\n      const currentId = node.data[this.primaryKey];\r\n      return currentId === parentElement && layer === (currentLayer + 1);\r\n    });\r\n\r\n    return parentNode;\r\n  }\r\n\r\n  /**\r\n   * è·åèçæ èç¹\r\n   */\r\n  private getOldNode(nodeData: any): TreeNode {\r\n    const id = nodeData[this.primaryKey];\r\n    return this.allOldNodesMap.get(id);\r\n  }\r\n\r\n  /**\r\n   * æå¹³TreeNodesï¼å¹¶æ¾å¥ä¸ä¸ªMapä¸­\r\n   */\r\n  private buildNodesDataMap(treeNodes: TreeNode[]): void {\r\n    treeNodes.forEach((treeNode: TreeNode) => {\r\n      this.allOldNodesMap.set(treeNode.data[this.primaryKey], treeNode);\r\n      if (treeNode.children) {\r\n        this.buildNodesDataMap(treeNode.children);\r\n      }\r\n    });\r\n  }\r\n\r\n  // #endregion\r\n}\r\n\r\nexport { ParentTreeNodeBuilder };\r\n\r\n","/*\r\n * @Author: aalizzwell \r\n * @Date: 2019-05-30 18:57:34 \r\n * @Last Modified by:   aalizzwell \r\n * @Last Modified time: 2019-05-30 18:57:34 \r\n */\r\nimport { PathTreeNodeBuilder } from './path_tree_node_builder';\r\nimport { ParentTreeNodeBuilder } from './parent_tree_node_builder';\r\nimport { Type } from '@angular/core';\r\n\r\nexport class TreeNodeBuilderFactory {\r\n    static getBuilder(hierarchyInfo: { [propName: string]: any }): Type<PathTreeNodeBuilder | ParentTreeNodeBuilder> {\r\n        let builder: Type<PathTreeNodeBuilder | ParentTreeNodeBuilder> = PathTreeNodeBuilder;\r\n        if (hierarchyInfo.hasOwnProperty(\"path\")) {\r\n            builder = PathTreeNodeBuilder;\r\n        } else if (hierarchyInfo.hasOwnProperty(\"parentElement\")) {\r\n            builder = ParentTreeNodeBuilder;\r\n        }\r\n\r\n        return builder;\r\n    }\r\n}","/*\r\n * @Author: aalizzwell \r\n * @Date: 2020-02-27 11:33:41 \r\n * @Last Modified by: aalizzwell\r\n * @Last Modified time: 2020-02-27 11:34:16\r\n */\r\n// tslint:disable: no-string-literal\r\n\r\nimport { Directive, OnInit, OnChanges, SimpleChanges, Input, HostListener, Type, Output, EventEmitter } from '@angular/core';\r\nimport { BindingData, BindingList, FrameContext, Change, ChangeType, ComponentType } from '@farris/devkit';\r\nimport { TreeTableComponent, TreeNode } from '@farris/ui-treetable';\r\nimport { Subject } from 'rxjs';\r\nimport { debounceTime } from 'rxjs/operators';\r\nimport { FarrisTreetableFormatService } from '../format/index';\r\nimport { TreeNodeBuilderFactory } from './tree_table_node_builder/tree_node_builder_factory';\r\n\r\n/**\r\n * æ è¡¨æ ¼ç»å®æä»¤\r\n */\r\n@Directive({\r\n  selector: '[farrisTreeTableBinding]'\r\n})\r\nclass FarrisTreeTableBindingDirective implements OnInit, OnChanges {\r\n  /**\r\n   * æ å­å¨ç©ºé´\r\n   */\r\n  private storage: any;\r\n  private renderSubject: Subject<any> = new Subject<any>();\r\n  private builder: Type<any>;\r\n  private treeNodesBuilder: any;\r\n  /**\r\n   * åçº§ç ä¿¡æ¯çkey\r\n   */\r\n  // tslint:disable-next-line: no-input-rename\r\n  @Input('farrisHierarchyInfoKey')\r\n  public hierarchyInfoKey: string;\r\n\r\n  /* è¡æ ·å¼ */\r\n  @Input()\r\n  rowClassName: (context: any) => any;\r\n\r\n  /* ååååæ ¼æ ·å¼ */\r\n  @Input()\r\n  cellClassName: (data: any, field: any) => any;\r\n  /**\r\n   * å¯ç¨èç¹åé¡µ\r\n   */\r\n  // @Input('enableNodePagination')\r\n  // public enableNodePagination: boolean;\r\n  /**\r\n   * èç¹åé¡µå¤§å°\r\n   */\r\n  @Input('nodePageSize')\r\n  public nodePageSize: number = 100;\r\n  /**\r\n   * ç»å®æ°æ®\r\n   */\r\n  private get bindingData(): BindingData {\r\n    return this.frameContext.bindingData;\r\n  }\r\n\r\n  /**\r\n   * ç»å®æ°æ®åè¡¨\r\n   */\r\n  private get bindingList(): BindingList {\r\n\r\n    // @todoï¼åªæ¯æä¸»è¡¨ï¼æ²¡æå¤çbindingPath\r\n    return this.bindingData.list;\r\n  }\r\n\r\n\r\n  /* è®¾ç½®è¡æ ·å¼ */\r\n  @Output()\r\n  rowClass: EventEmitter<any> = new EventEmitter<any>();\r\n\r\n  /* è®¾ç½®åæ ·å¼ */\r\n  @Output()\r\n  cellClass: EventEmitter<any> = new EventEmitter<any>();\r\n\r\n  private _PROP: any = null;\r\n  private listeners: any[];\r\n  private get prop() {\r\n    return this._PROP;\r\n  }\r\n  private set prop(value) {\r\n    this._PROP = value;\r\n  }\r\n  /**\r\n   * è·åå½åvm\r\n   */\r\n  private get viewModel() {\r\n    return this.frameContext.viewModel;\r\n  }\r\n  /**\r\n   * æé å½æ°\r\n   */\r\n  constructor(\r\n    private treeTable: TreeTableComponent,\r\n    private treetableFormatSer: FarrisTreetableFormatService,\r\n    private frameContext: FrameContext\r\n  ) {\r\n    this.listeners = [];\r\n    this.storage = [];\r\n    this.viewModel.uiState.setPropertyValue('ids', this.treeTable.checkValues);\r\n    this.renderSubject.pipe(\r\n      debounceTime(500)\r\n    ).subscribe(() => {\r\n      this.bindData();\r\n    });\r\n\r\n  }\r\n\r\n  /**\r\n   * æä»¤åå§å\r\n   */\r\n  ngOnInit() {\r\n    // å°åçº§ç ä¿¡æ¯ä¿å­å°root-componentï¼èéæ´ä¸ªè¡¨åçapp-context\r\n    const virtualRootFrameContext = this.frameContext.getVirtualRootFrameContext();\r\n    virtualRootFrameContext.setParam('hierarchyInfoKey', this.hierarchyInfoKey);\r\n    this.bindData();\r\n    this.bindingData.changes.subscribe((change: Change) => {\r\n      if (change && (change.type === ChangeType.ValueChanged || change.type === ChangeType.PaginationInfoChange)) {\r\n        this.renderSubject.next(change);\r\n      } else {\r\n        this.bindData();\r\n      }\r\n      // è®¾ç½®å½åè¡\r\n      const currentId = this.bindingList.currentId;\r\n      if (!this.frameContext.bindingData.rowSelectedEventSuspend && currentId) {\r\n        this.setSelectedIdToTree(this.bindingList.currentId);\r\n      }\r\n      this.updateCheckedRows(change);\r\n    });\r\n\r\n    // è®¾ç½® æ è¡¨ æ ¼å¼å\r\n    this.treetableFormatSer.setFormat(this.treeTable);\r\n\r\n    /* è¡æ ·å¼ */\r\n    this.rowClass.emit(this.treeTable);\r\n\r\n    /* åæ ·å¼  ååæ ¼æ ·å¼ */\r\n    this.cellClass.emit(this.treeTable);\r\n    this.setComponentRef();\r\n    this.setNodePaginationInfo();\r\n    this.registerEvent();\r\n    if (this.frameContext && this.frameContext.frameComponent) {\r\n      this.frameContext.frameComponent.componentType = ComponentType.farrisTreeTalbeComponent;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * æä»¤è¾å¥åæ´\r\n   */\r\n  ngOnChanges(changes: SimpleChanges) {\r\n  }\r\n  private registerEvent() {\r\n    this.treeTable.columnSorted.subscribe((event: { sortName: string, sortOrder: string }) => {\r\n      const { sortName = null, sortOrder = null } = event;\r\n      const remoteSort = this.treeTable.remoteSort;\r\n      if (remoteSort === false) {\r\n        if (sortName && sortOrder) {\r\n          this.bindingList.sortBy(sortName, sortOrder);\r\n        }\r\n      }\r\n      this.bindData();\r\n    });\r\n  }\r\n  /**\r\n   * æ¶éæ ç»ä»¶å®ä¾\r\n   */\r\n  private setComponentRef() {\r\n    const appContext = this.viewModel && this.viewModel.frameContext && this.viewModel.frameContext.getFormAppContext();\r\n    const frameId = this.viewModel && this.viewModel.frameContext && this.viewModel.frameContext.frameId;\r\n    const id = this.treeTable && this.treeTable.el.nativeElement.id || null;\r\n    // å¦æframeIdä¸å­å¨ætreetableæ²¡æidå±æ§ï¼è¯´æä¸ç¬¦åä½¿ç¨åºæ¯\r\n    if (!frameId || !id) {\r\n      return;\r\n    }\r\n    const map = appContext && appContext.componentRefs && appContext.componentRefs.get(frameId) || new Map<string, any>();\r\n    appContext && appContext.componentRefs && appContext.componentRefs.set(frameId, map.set(id, this.treeTable));\r\n  }\r\n\r\n  private setNodePaginationInfo() {\r\n    if (this.frameContext) {\r\n      const enableNodePagination = this.treeTable.paginationForChildren || false;//this.enableNodePagination || false;\r\n      this.frameContext.params.set('enableNodePagination', enableNodePagination);\r\n      const nodePageSize = this.nodePageSize || 0;\r\n      this.frameContext.params.set('nodePageSize', nodePageSize);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * ç»å®æ°æ®\r\n   */\r\n  private bindData() {\r\n    const oldTreeNodes = this.treeTable.data;\r\n    const treeNodesData = this.bindingList.toJSON({ ignoreMultiLangInput: true });\r\n    // if (!this.shouldComponentUpdate(treeNodesData)) {\r\n    //   return;\r\n    // }\r\n    this.prop = treeNodesData;\r\n\r\n    let treeNodes: TreeNode[] = [];\r\n    if (!!treeNodesData && treeNodesData.length > 0) {\r\n      const hierarchyInfo = treeNodesData[0][this.hierarchyInfoKey];\r\n      let builder: Type<any> = this.builder;\r\n      if (!builder) {\r\n        this.builder = TreeNodeBuilderFactory.getBuilder(hierarchyInfo);\r\n        builder = this.builder;\r\n      }\r\n      // æå¡å¨è¿åçåçº§èç¹ä¿¡æ¯å¹éä¸å°ç°æå·¥åéé¢çä»»ä½ä¸ç§æåµãç¡®è®¤æ°å çbuilderå·²ç»å¨å·¥åä¸­æ³¨å\r\n      if (builder == null) {\r\n        throw new Error('TreeTable builder is null!');\r\n      }\r\n      let expandLevel = -1;\r\n      const treeExpandLevel = this.treeTable['expandLevel'];\r\n      if (typeof treeExpandLevel !== 'undefined') {\r\n        expandLevel = treeExpandLevel;\r\n      }\r\n      const virtualRootFrameContext = this.frameContext.getVirtualRootFrameContext();\r\n      const nodesShouldExpand = (virtualRootFrameContext.params.get('_DEVKIT_expandRowIds') || '').split(',') || [];\r\n      const context = {\r\n        expandLevel,\r\n        addTreeLoadCompleteListener: this.addTreeLoadCompleteListener.bind(this),\r\n        component: this.treeTable,\r\n        storage: this.storage,\r\n        nodesShouldExpand: nodesShouldExpand,\r\n        frameContext: this.frameContext,\r\n      };\r\n      //if (!this.treeNodesBuilder) {\r\n      this.treeNodesBuilder = new builder(\r\n        treeNodesData, oldTreeNodes,\r\n        this.bindingList.primaryKey, this.hierarchyInfoKey, context\r\n      );\r\n      //}\r\n      // this.treeNodesBuilder.updateTreeNode(treeNodesData, oldTreeNodes);\r\n      treeNodes = this.treeNodesBuilder.build();\r\n    }\r\n    this.treeTable.data = treeNodes;\r\n    // è®¾ç½®åé¡µä¿¡æ¯\r\n    this.updatePageInfo(this.treeTable);\r\n    this.onTreeLoadComplete();\r\n  }\r\n  private onTreeLoadComplete() {\r\n    if (this.listeners && this.listeners.length > 0) {\r\n      this.listeners.forEach(listener => {\r\n        listener();\r\n      });\r\n    }\r\n  }\r\n  private addTreeLoadCompleteListener(listener: any) {\r\n    this.listeners.push(listener);\r\n  }\r\n  private shouldComponentUpdate(newProp: any) {\r\n    if (JSON.stringify(this.prop) === JSON.stringify(newProp)) {\r\n      return false;\r\n    }\r\n    return true;\r\n  }\r\n  /**\r\n   * ä»æ ç»ä»¶ä¸è·åéä¸­è¡çid\r\n   */\r\n  private getSelectedIdFromTree(): string {\r\n    const selectedRow = this.treeTable.selectedRow;\r\n    return selectedRow ? selectedRow.data['id'] : null;\r\n  }\r\n\r\n  /**\r\n   * è®¾ç½®TreeTableçå½åè¡\r\n   */\r\n  private setSelectedIdToTree(selectedId: string): void {\r\n    if (!selectedId) {\r\n      return;\r\n    }\r\n    // å¦ææ°çcurrentIdåæ ä¸çselectedIdä¸ä¸è´ï¼éç½®æ çå½åè¡\r\n    const oldSelectedId = this.getSelectedIdFromTree();\r\n    const nodePageChanged = this.frameContext.params.get('_NODE_PAGE_CHANGED_') || false;\r\n    if (!oldSelectedId && nodePageChanged) {\r\n      this.frameContext.params.delete('_NODE_PAGE_CHANGED_');\r\n      return;\r\n    }\r\n    if (oldSelectedId !== selectedId) {\r\n      this.treeTable.clearSelections();\r\n      this.treeTable.selectNode(selectedId);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * è®¾ç½®BindingListçCurrentId\r\n   */\r\n  private setCurrentIdToBindingList(selectedId: string): void {\r\n    const oldCurrentId = this.bindingData.list.currentId;\r\n    // åéæ¨¡å¼ä¸å°å½åè¡è®¾ç½®å°ids\r\n    if (!this.treeTable.multiSelect) {\r\n      this.setChecks(selectedId);\r\n      this.setCheckedRows([selectedId]);\r\n    }\r\n    if (oldCurrentId === selectedId) {\r\n      return;\r\n    }\r\n    this.bindingData.list.setCurrentId(selectedId, true);\r\n  }\r\n  private updateCheckedRows(changes: Change) {\r\n    if (changes.type === ChangeType.Load) {\r\n      this.setCheckedRows();\r\n    } else if (changes.type === ChangeType.ValueChanged || changes.type === ChangeType.Remove) {\r\n      const ids = this.getChecks();\r\n      if (changes.id && ids.includes(changes.id)) {\r\n        this.setCheckedRows();\r\n      }\r\n    }\r\n  }\r\n  /**\r\n   * æ´æ°å¾éè¡æ°æ®\r\n   */\r\n  protected setCheckedRows(ids?: string[]) {\r\n    if (typeof ids === 'undefined') {\r\n      ids = this.viewModel.uiState['ids'] || [];\r\n    }\r\n    if (!Array.isArray(ids)) {\r\n      return;\r\n    }\r\n    const list = this.bindingList.toJSON();\r\n    const rows: Map<string, any> = this.viewModel.uiState['rows'] || new Map<string, any>();\r\n\r\n    const result = new Map<string, any>();\r\n    ids.forEach((id: any) => {\r\n      const item = list.find(item => item[this.bindingList.primaryKey] === id);\r\n      const otherPageItem = rows.get(id);\r\n      if (item) {\r\n        result.set(id, item);\r\n      } else if (otherPageItem) {\r\n        result.set(id, otherPageItem);\r\n      }\r\n    });\r\n    this.viewModel.uiState.setPropertyValue('rows', result);\r\n  }\r\n  /**\r\n   * è®¾ç½®idsåé\r\n   * @param idOrIds id or ids\r\n   */\r\n  protected setChecks(idOrIds: string | string[]) {\r\n    if (typeof idOrIds === 'string') {\r\n      idOrIds = idOrIds.split(',').filter(p => p);\r\n    }\r\n    this.viewModel.uiState.setPropertyValue('ids', idOrIds);\r\n  }\r\n  /**\r\n   * è·åå¾éè¡idæ°ç»\r\n   * @returns \r\n   */\r\n  protected getChecks(): string[] {\r\n    return this.viewModel.uiState['ids'] || [];\r\n  }\r\n  /**\r\n   * è·ååé¡µä¿¡æ¯\r\n   */\r\n  private getPagingInfo() {\r\n    const bindingPath = this.viewModel.bindingPath;\r\n    const bindingData = this.viewModel.bindingData;\r\n    let pagingInfo = bindingData.pagingInfo;\r\n    if (bindingPath === '/') {\r\n      return pagingInfo;\r\n    } else {\r\n      const bindingPaths = bindingPath.substr(1).split('/').filter(item => !!item && item.length > 0).map(item => {\r\n        return item.substring(0, item.length - 1);\r\n      });\r\n      bindingPaths.forEach(path => {\r\n        pagingInfo = pagingInfo && pagingInfo[path];\r\n      });\r\n      return pagingInfo;\r\n    }\r\n  }\r\n  private updatePageInfo(treeTable: TreeTableComponent) {\r\n    const { pageIndex, pageSize, total } = this.getPagingInfo();\r\n    if (pageSize === 0) {\r\n      treeTable.pagination = false;\r\n      return;\r\n    }\r\n    treeTable.pagination = true;\r\n    treeTable.updatePageInfo({ pageIndex, pageSize, total });\r\n  }\r\n  //#region ç»ä»¶äºä»¶\r\n  /**\r\n   * è¡åæ¢\r\n   */\r\n  @HostListener('nodeSelected', ['$event'])\r\n  public selectionChangeHandler(event: any) {\r\n    if (event && event.node && event.node.hasOwnProperty('data')) {\r\n      const idField = this.treeTable.idField;\r\n      const id = event.node.data[idField];\r\n      this.setCurrentIdToBindingList(id);\r\n    }\r\n  }\r\n  /**\r\n   * å¾éèç¹åçåå\r\n   * @param event event\r\n   */\r\n  @HostListener('checkValuesChange', ['$event'])\r\n  public checkValuesChange(event: any) {\r\n    // this.viewModel.uiState.setPropertyValue('ids', this.treeTable.checkValues);\r\n    this.setChecks(this.treeTable.checkValues);\r\n    this.setCheckedRows();\r\n  }\r\n  /**\r\n   * å°è¢«å±å¼çèç¹è®¾ç½®ä¸ºå½åè¡\r\n   */\r\n  @HostListener('expand', ['$event'])\r\n  public expandHandler(event: any) {\r\n    const selectedId = event.data['id'];\r\n    const virtualRootFrameContext = this.frameContext.getVirtualRootFrameContext();\r\n    // å±å¼æ¶ä¸åéä¸­\r\n    // this.setSelectedIdToTree(selectedId);\r\n    const expandNodes = virtualRootFrameContext.getParam('TREE_LATEST_EXPANDED_ID') || [];\r\n    expandNodes.push(selectedId);\r\n    virtualRootFrameContext.setParam('TREE_LATEST_EXPANDED_ID', expandNodes);\r\n  }\r\n  @HostListener('pageChanged', ['$event'])\r\n  public onPageChanged(event: any) {\r\n    let { pageSize = 20, pageIndex = 1 } = event || {};\r\n    if (pageIndex < 1) {\r\n      pageIndex = 1;\r\n    }\r\n    const skip = (pageIndex - 1) * pageSize;\r\n    this.bindingData.setPagingInfo(skip, pageSize, this.bindingData.bindingPath);\r\n  }\r\n  @HostListener('pageSizeChanged', ['$event'])\r\n  public onPageSizeChanged(event: any) {\r\n    const pageSize = event ? event : 20;\r\n    const skip = 0;\r\n    this.bindingData.setPagingInfo(skip, pageSize, this.bindingData.bindingPath);\r\n  }\r\n  /**\r\n   * èç¹é¡µç åæ¢äºä»¶\r\n   * @param event event\r\n   */\r\n  @HostListener('childsPageChanged', ['$event'])\r\n  public onNodePageChanged(event: any) {\r\n    const { pageIndex = 1, pageSize = this.nodePageSize, node = {} } = event;\r\n    const id = node && node.id || null;\r\n    if (id) {\r\n      const virtualRootFrameContext = this.frameContext.getVirtualRootFrameContext();\r\n      const expandNodes = virtualRootFrameContext.getParam('TREE_LATEST_EXPANDED_ID') || [];\r\n      expandNodes.push(id);\r\n      virtualRootFrameContext.setParam('TREE_LATEST_EXPANDED_ID', expandNodes);\r\n      this.frameContext.params.set(`_NODE_${id}_PAGE_INDEX_`, pageIndex);\r\n      this.frameContext.params.set(`_RELOAD_CHILDREN_`, true);\r\n      this.frameContext.params.set('_NODE_PAGE_CHANGED_', true);\r\n    }\r\n  }\r\n  //#endregion\r\n}\r\n\r\nexport { FarrisTreeTableBindingDirective };\r\n","import { BindingObject, DataPropInfo, DataTypeInfo, ViewModel } from '@farris/devkit';\r\nimport { isNumber } from 'lodash-es';\r\n/**\r\n * å¸®å©æ å°åºç±»\r\n */\r\nexport class DataMapping {\r\n  public vm: ViewModel;\r\n  public target: BindingObject;\r\n  /**\r\n   * å¤éå¸®å©é»è®¤åéç¬¦\r\n   */\r\n  protected readonly defaultSpliter = ',';\r\n  /**\r\n   * æ å°æ°æ®\r\n   * @param helpData æ¸ç©ºæ¶ï¼å¼ä¸ºnull\r\n   * @param mapFields æ ¼å¼å½¢å¦ï¼{id: \"assoField.assoField\", code: \"assoField.assoField_Code\", name: \"assoField.assoField_Name\"}\r\n   * @param asClear ç±»ä¼¼æ¸ç©º\r\n   * @param [spliter=','] å¤éåéç¬¦\r\n   */\r\n  mappingData(helpData: any, mapFields: any, asClear: boolean = false, spliter: string = ',') {\r\n    if (!mapFields) {\r\n      return;\r\n    }\r\n    // å³é­åæ´æ£æµ\r\n    const appContext = this.vm.frameContext.appContext;\r\n    appContext.changeDetectionController.detach();\r\n    let helpFields = Object.keys(mapFields);\r\n    const basePaths = this.getBindingPathArray();\r\n    const primaryInfo = this.getMapFieldsPrimaryKey(mapFields, basePaths);\r\n    // æ å°å°ç®æ ä¸»é®çæºå­æ®µæ°ç»\r\n    const primaryKeys: string[] = primaryInfo && primaryInfo.map((item) => item.primaryKey) || [];\r\n    // ç®æ ä¸»é®å­æ®µæ°ç»\r\n    const primaryFields: string[] = primaryInfo && primaryInfo.map((item) => item.primaryField) || [];\r\n    // å¯¹æ å°ä¸­çkeyè¿è¡æåºï¼ä½¿æ å°å°ç®æ ä¸»é®çkeyæå°åé¢\r\n    helpFields = this.sortMapFieldKeys(helpFields, primaryKeys);\r\n    if (!helpData || asClear) {\r\n      helpFields.reverse();\r\n    }\r\n    this.mapping(helpFields, mapFields, helpData, primaryFields, basePaths, asClear, spliter);\r\n    // éæ°æå¼åæ´æ£æµ\r\n    appContext.changeDetectionController.reattach();\r\n  }\r\n  private mapping(sortedKeyFields: string[], mapFields: any, helpData: any, targetPrimaryFields: string[], basePaths: string[], asClear: boolean = false, spliter = ',') {\r\n    sortedKeyFields.forEach((field: any) => {\r\n      const val = this.getHelpValue(field, helpData, spliter);\r\n      let mappings: any[] = mapFields[field].split(',');\r\n      const headMappings = mappings.filter((p) => targetPrimaryFields.includes(p));\r\n      const leftMappings = mappings.filter((p) => !targetPrimaryFields.includes(p));\r\n      if (!helpData || asClear) {\r\n        mappings = [].concat(leftMappings).concat(headMappings);\r\n      } else {\r\n        mappings = [].concat(headMappings).concat(leftMappings);\r\n      }\r\n      this.updateTarget(mappings, basePaths, helpData, val);\r\n    });\r\n  }\r\n  private updateTarget(mappings: string[], basePaths: string[], helpData: any, value: any) {\r\n    mappings.forEach((targetFieldPath: any) => {\r\n      this.updateTargetValue(basePaths, targetFieldPath, value, helpData);\r\n    });\r\n  }\r\n  private updateTargetValue(basePaths: string[], targetFieldPath, value: any, helpData: any) {\r\n    if (this.target) {\r\n      const paths = targetFieldPath.split('.');\r\n      this.setValue(this.target, paths, value);\r\n    } else {\r\n      const paths = basePaths.concat(targetFieldPath.split('.'));\r\n      if (!helpData) {\r\n        this.vm.bindingData.clearValue(paths, true, true, { frameContext: this.vm.frameContext });\r\n      } else {\r\n        this.vm.bindingData.setValue(paths, value, true, true, null, { frameContext: this.vm.frameContext });\r\n      }\r\n    }\r\n  }\r\n  /**\r\n   * è·åå¸®å©å­æ®µå¯¹åºçå¼\r\n   * @param field å¸®å©å­æ®µ\r\n   * @param helpData å¸®å©æ°æ®\r\n   * @param [spliter=','] å¤éå¸®å©åéç¬¦\r\n   * @returns\r\n   */\r\n  private getHelpValue(field: string, helpData: any, spliter = ',') {\r\n    let value: any = '';\r\n    if (helpData) {\r\n      if (helpData instanceof Array) {\r\n        value = helpData.map((item: any) => {\r\n          return this.getValue(field, item);\r\n        }).join(spliter);\r\n      } else {\r\n        value = this.getValue(field, helpData);\r\n      }\r\n    }\r\n    return value;\r\n  }\r\n  protected getValue(f: string, data: any) {\r\n    let val = '';\r\n    if (f.indexOf('.') === -1) {\r\n      val = data[f];\r\n    } else {\r\n      val = f.split('.').reduce((a, b) => {\r\n        return a[b];\r\n      }, data);\r\n    }\r\n\r\n    return val;\r\n  }\r\n  protected setValue(target: object, paths: string[], value: any) {\r\n    if (target) {\r\n      if (paths.length <= 1) {\r\n        target[paths[0]] = value;\r\n      } else {\r\n        paths.slice(0, -1).reduce((prev, path) => {\r\n          if (!(prev.hasOwnProperty(path) || prev['__proto__'].hasOwnProperty(path))) {\r\n            prev[path] = {};\r\n          }\r\n          return prev[path];\r\n        }, target)[paths[paths.length - 1]] = value;\r\n      }\r\n    }\r\n  }\r\n  private getBindingPathArray(): any[] {\r\n    const path = this.vm.bindingPath;\r\n    if (path) {\r\n      return path.split('/').filter((n) => n !== '');\r\n    }\r\n    return [];\r\n  }\r\n\r\n  private isNumberValue(field, data) {\r\n    const currentVal = this.getValue(field, data);\r\n    return isNumber(currentVal);\r\n  }\r\n  /**\r\n   *\r\n   * @param mapFields  æ ¼å¼å½¢å¦ï¼{id: \"assoField.assoField\", code: \"assoField.assoField_Code\", name: \"assoField.assoField_Name\"} æè {id:'vid',code:'code',name:'name'}\r\n   */\r\n  private getMapFieldsPrimaryKey(mapFields: any, bindingPaths: string[]): Array<{ primaryKey: string, primaryField: string }> {\r\n    if (!mapFields || Object.keys(mapFields).length < 1) {\r\n      return null;\r\n    }\r\n    const results = [];\r\n    // let primaryField = null;\r\n    try {\r\n      const entityTypeInfo: DataTypeInfo = this.vm.frameContext.repository.entityTypeInfo;\r\n      Object.keys(mapFields).forEach((key: string) => {\r\n        const mapField = mapFields[key];\r\n        if (mapField && typeof mapField === 'string') {\r\n          const mappings = mapField.split(',').filter((p) => p);\r\n          mappings.forEach((item: string) => {\r\n            let paths = item.split('.');\r\n            if (bindingPaths && bindingPaths.length > 0) {\r\n              paths = bindingPaths.concat(paths);\r\n            }\r\n            const propInfo: DataPropInfo = entityTypeInfo.getPropInfoByPath(paths);\r\n            if (propInfo && propInfo.metadataInfo && propInfo.metadataInfo.primary === true) {\r\n              results.push({\r\n                primaryKey: key,\r\n                primaryField: item\r\n              });\r\n            }\r\n          });\r\n        }\r\n      });\r\n    } catch (e) {\r\n      console.error(e);\r\n    }\r\n    return results;\r\n  }\r\n  private sortMapFieldKeys(keys: string[], primaryKeys: string[]): string[] {\r\n    if (!primaryKeys || primaryKeys.length < 1 || !keys || keys.length < 1) {\r\n      return keys;\r\n    }\r\n    primaryKeys = [...new Set(primaryKeys)];\r\n    // è¿æ»¤åºéä¸»é®æ å°å­æ®µ\r\n    keys = keys.filter((p) => !primaryKeys.includes(p));\r\n    return [].concat(primaryKeys).concat(keys);\r\n  }\r\n}\r\n","/*\r\n * @Author: ç¯çç§æ(lucas huang)\r\n * @Date: 2018-11-07 16:31:57\r\n * @LastEditors: ç¯çç§æ(Lucas Huang)\r\n * @LastEditTime: 2019-09-27 14:57:22\r\n * @Company: Inspur\r\n * @Version: v0.0.1\r\n */\r\n\r\n/**\r\n * ä½¿ç¨æ¹æ³ï¼\r\n * [data-mapping]=\"{ id: 'user.userId', name: 'user.userName' }\"\r\n * key ä¸ºå¸®å©ä¸çå­æ®µï¼ value ä¸º è¡¨åä¸­çå­æ®µå\r\n * å¸®å©ä¸çåä¸ä¸ªå­æ®µå¯ä»¥æ å°å°è¡¨åä¸­çå¤ä¸ªå­æ®µä¸­ï¼{ ... id: 'user.userid, user.addusid'}\r\n * å¤å­æ®µä»¥éå·éå¼\r\n *\r\n */\r\n\r\nimport { Directive, OnInit, Optional, Self, Input } from '@angular/core';\r\nimport { BindingObject, NgFormControl, ViewModel } from '@farris/devkit';\r\nimport { LookupGridComponent } from '@farris/ui-lookup';\r\nimport { DataMapping } from './data-mapping';\r\n\r\n\r\n@Directive({ selector: '[data-mapping]' })\r\nexport class LookupDataMappingDirective extends DataMapping implements OnInit {\r\n  @Input('data-mapping') mapfields: any;\r\n  @Input('target') target: BindingObject = null;\r\n\r\n  constructor(@Optional() public vm: ViewModel, @Optional() @Self() private lookup: LookupGridComponent) {\r\n    super();\r\n  }\r\n\r\n  ngOnInit() {\r\n    this.lookup.selectedData.subscribe((data: any) => {\r\n      const _mapfields = this.mapfields || this.lookup.mapFields;\r\n      const spliter = this.lookup.multipleChoiceSeparator || this.defaultSpliter;\r\n      this.mappingData(data, _mapfields, false, spliter);\r\n    });\r\n    this.lookup.clearMappings.subscribe((result: any) => {\r\n      // const value = result && result.value || null;\r\n      const mapfields = Object.assign({}, (this.mapfields || this.lookup.mapFields || {}));\r\n      const lookupTextField = this.lookup.textField;\r\n      const data = {};\r\n      const controlName = this.lookup.ngControl && this.lookup.ngControl.name;\r\n      if (controlName && this.vm) {\r\n        const textFieldMapping = mapfields[lookupTextField];\r\n        const ngFormControl = this.vm && this.vm.form && this.vm.form.ngFormControls && this.vm.form.ngFormControls[controlName] as NgFormControl;\r\n        const binding = ngFormControl && ngFormControl.binding;\r\n        if (textFieldMapping && binding) {\r\n          mapfields[lookupTextField] = textFieldMapping.split(',').filter((item) => item !== binding).join(',');\r\n        }\r\n      }\r\n      // this.setValue(data, lookupTextField.split('.'), value);\r\n      Object.keys(mapfields).forEach((field) => {\r\n        this.setValue(data, field.split('.'), '');\r\n      });\r\n      this.mappingData(data, mapfields, true);\r\n    });\r\n    this.lookup.clear.subscribe(() => {\r\n      const _mapfields = this.mapfields || this.lookup.mapFields;\r\n      this.mappingData(null, _mapfields);\r\n    });\r\n  }\r\n}\r\n","\r\nimport { Directive, OnInit, Optional, Self, Input } from '@angular/core';\r\nimport { FrameContext } from '@farris/devkit';\r\nimport { LookupGridComponent } from '@farris/ui-lookup';\r\n\r\n// tslint:disable-next-line: directive-selector\r\n@Directive({\r\n  selector: '[enableExtendLoadMethod]'\r\n})\r\nexport class LookupEnableExtendLoadMethodDirective implements OnInit {\r\n  @Input()\r\n  public enableExtendLoadMethod: any;\r\n\r\n  constructor(\r\n    @Optional() private frameContext: FrameContext,\r\n    @Optional() @Self() private lookup: LookupGridComponent\r\n  ) { }\r\n\r\n  ngOnInit() {\r\n    if (!this.frameContext || !this.lookup || this.enableExtendLoadMethod !== true) {\r\n      return;\r\n    }\r\n    const befApiUrl = this.frameContext.repository.apiUri;\r\n    const helpMetadataId = this.lookup.uri;\r\n    const enableKey = `${helpMetadataId}@${befApiUrl}`;\r\n    this.frameContext.setParam(enableKey, true);\r\n  }\r\n}\r\n","import { Directive, Input, OnInit, HostListener, Self, Host, Optional, Output, EventEmitter, OnChanges, SimpleChanges, DoCheck, KeyValueDiffer, KeyValueDiffers } from '@angular/core';\r\nimport { ComboBoxComponent } from '@progress/kendo-angular-dropdowns';\r\nimport { LookupGridComponent } from '@farris/ui-lookup';\r\nimport { ComboListComponent } from '@farris/ui-combo-list';\r\nimport { ComboLookupComponent } from '@farris/ui-combo-lookup';\r\n\r\n@Directive({\r\n  selector: '[UIStateBinding]'\r\n})\r\nexport class UIStateBindingDirective implements OnInit, OnChanges, DoCheck {\r\n  private _bindingObject: any;\r\n  private readonly defaultSpliter = ',';\r\n  private differ: KeyValueDiffer<any, any> = null;\r\n\r\n  @Input('UIStateBinding')\r\n  set bindingObject(value: any) {\r\n    this._bindingObject = value;\r\n    if (!this.differ && value && this.differs && typeof (value) === 'object') {\r\n      this.differ = this.differs.find(value).create();\r\n    }\r\n  }\r\n  get bindingObject() {\r\n    return this._bindingObject;\r\n  }\r\n  @Output() UIStateBindingChange: EventEmitter<any> = new EventEmitter<any>();\r\n\r\n  @HostListener('valueChange', ['$event'])\r\n  onValueChange(val: any) {\r\n    // host is combobox\r\n    if (this.hostComboComponent && this.bindingObject) {\r\n      if (val) {\r\n        this.bindingObject.key = val.value;\r\n        this.bindingObject.value = val.name;\r\n      } else {\r\n        this.bindingObject.key = null;\r\n        this.bindingObject.value = null;\r\n      }\r\n    }\r\n  }\r\n\r\n  constructor(\r\n    @Host() @Self() @Optional() private hostComboComponent: ComboBoxComponent,\r\n    @Host() @Self() @Optional() private hostHelpComponent: LookupGridComponent,\r\n    @Optional() private differs: KeyValueDiffers,\r\n    @Host() @Self() @Optional() private hostComboListComponent: ComboListComponent,\r\n    @Host() @Self() @Optional() private hostComboLookupComponent: ComboLookupComponent\r\n  ) { }\r\n\r\n  ngOnInit() {\r\n    if (this.hostComboComponent) {\r\n      this.hostComboComponent.valuePrimitive = false;\r\n    } else if (this.hostHelpComponent) {\r\n      this.bindObjectToHostLookup();\r\n    } else if (this.hostComboListComponent) {\r\n      this.bindObjectToHostComboList();\r\n    } else if (this.hostComboLookupComponent) {\r\n      this.bindObjectToHostComboLookup();\r\n    }\r\n  }\r\n  ngDoCheck() {\r\n    if (this.differ && typeof (this.bindingObject) === 'object') {\r\n      const changes = this.differ && this.differ.diff(this.bindingObject);\r\n      if (changes) {\r\n        this.bindingChanges();\r\n      }\r\n    } else { // å¼å®¹æªéæ°ç¼è¯å·¥ç¨ï¼differä¸å­å¨ä»æåµ\r\n      this.bindingChanges();\r\n    }\r\n  }\r\n\r\n  private bindingChanges() {\r\n    const text = this.bindingObject ? this.bindingObject.value : null;\r\n    const key = this.bindingObject ? this.bindingObject.key : null;\r\n    if (this.hostComboComponent) {\r\n      this.hostComboComponent.text = text;\r\n      const vField = this.hostComboComponent.valueField;\r\n      const item = this.hostComboComponent.data.find((n) => n[vField] === key);\r\n      this.hostComboComponent.writeValue(item);\r\n    } else if (this.hostHelpComponent) {\r\n      this.hostHelpComponent.writeValue(text);\r\n      this.hostHelpComponent.displayValue = key;\r\n    } else if (this.hostComboListComponent) {\r\n      this.hostComboListComponent.writeValue(key);\r\n    } else if (this.hostComboLookupComponent) {\r\n      this.hostComboLookupComponent.selectedValues = key;\r\n      this.hostComboLookupComponent.writeValue(text);\r\n    }\r\n  }\r\n  ngOnChanges(changes: SimpleChanges) {\r\n    if (changes.bindingObject && !this.differ) {\r\n      this.bindingChanges();\r\n    }\r\n  }\r\n\r\n  // å¼¹åºå¸®å©\r\n  private bindObjectToHostLookup() {\r\n    if (!this.hostHelpComponent) {\r\n      return;\r\n    }\r\n\r\n    this.hostHelpComponent.selectedData.subscribe((data: any) => this.updateHelpBindingObject(data));\r\n\r\n    this.hostHelpComponent.clear.subscribe(() => {\r\n      // this.bindingObject = {key: null, value: null};\r\n      this.updateHelpBindingObject(null);\r\n    });\r\n    if (this.hostHelpComponent.tagRemoved) {\r\n      this.hostHelpComponent.tagRemoved.subscribe((event: { removedIndex: number, instance: LookupGridComponent }) => {\r\n        const { removedIndex: index = -1, instance: componentRef = null } = event;\r\n        if (index === -1) {\r\n          return;\r\n        }\r\n        const isSigleSelect = componentRef.singleSelect;\r\n        if (isSigleSelect || !componentRef.displayValue) {\r\n          this.updateHelpBindingObject(null);\r\n        } else {\r\n          this.UIStateBindingChange.emit({ key: componentRef.displayValue, value: componentRef.displayText });\r\n        }\r\n      });\r\n    }\r\n    if (this.hostHelpComponent.nosearch) {\r\n      this.hostHelpComponent.valueChanged.subscribe((txt: any) => {\r\n        const idField = this.hostHelpComponent.idField;\r\n        const textField = this.hostHelpComponent.textField;\r\n        this.updateHelpBindingObject({\r\n          [idField]: txt,\r\n          [textField]: txt\r\n        });\r\n      });\r\n    }\r\n  }\r\n\r\n  // ä¸æåè¡¨\r\n  private bindObjectToHostComboList() {\r\n    if (!this.hostComboListComponent) {\r\n      return;\r\n    }\r\n\r\n    this.hostComboListComponent.valueChange.subscribe((data: any) => this.updateHelpBindingObject(data.selections));\r\n\r\n    this.hostComboListComponent.clear.subscribe(() => {\r\n      this.updateHelpBindingObject(null);\r\n    });\r\n  }\r\n\r\n  // ä¸æå¸®å©\r\n  private bindObjectToHostComboLookup() {\r\n    if (!this.hostComboLookupComponent) {\r\n      return;\r\n    }\r\n\r\n    if (this.hostComboLookupComponent.multiSelect) {\r\n      this.hostComboLookupComponent.valueChange.subscribe((data: any) => this.updateHelpBindingObject(data.selections));\r\n    } else {\r\n      // this.hostComboLookupComponent.selectChange.subscribe((data: any) => this.updateHelpBindingObject(data));\r\n      this.hostComboLookupComponent.selectChange.subscribe((e: any) => {\r\n        let data = e;\r\n        if (e.data) {\r\n          data = e.data;\r\n        }\r\n        this.updateHelpBindingObject(data);\r\n      });\r\n    }\r\n\r\n    this.hostComboLookupComponent.clear.subscribe(() => {\r\n      this.updateHelpBindingObject(null);\r\n    });\r\n  }\r\n\r\n  // æ´æ°UISTATE\r\n  private updateHelpBindingObject(data: any) {\r\n    let idField;\r\n    let textField;\r\n    let spliter: string = this.defaultSpliter;\r\n    if (this.hostHelpComponent) {\r\n      idField = this.hostHelpComponent.idField;\r\n      textField = this.hostHelpComponent.textField;\r\n      spliter = this.hostHelpComponent.multipleChoiceSeparator || this.defaultSpliter;\r\n    }\r\n\r\n    if (this.hostComboListComponent) {\r\n      idField = this.hostComboListComponent.idField;\r\n      textField = this.hostComboListComponent.textField;\r\n    }\r\n\r\n    if (this.hostComboLookupComponent) {\r\n      idField = this.hostComboLookupComponent.idField;\r\n      textField = this.hostComboLookupComponent.textField;\r\n      spliter = this.hostComboLookupComponent.separator || this.defaultSpliter;\r\n    }\r\n\r\n    this.emitUiStateBinding(data, idField, textField, spliter);\r\n  }\r\n\r\n  private emitUiStateBinding(data, idField, textField, spliter: string = ',') {\r\n    const newObject = { key: null, value: null };\r\n    if (data) {\r\n      // const idField = this.hostHelpComponent.idField;\r\n      // const textField = this.hostHelpComponent.textField;\r\n      if (Array.isArray(data)) {\r\n        newObject.key = data.map((d) => d[idField]).join(spliter);\r\n        newObject.value = data.map((d) => {\r\n          if (textField.indexOf('.') > -1) {\r\n            return textField.split('.').reduce((r, c) => {\r\n              return r[c];\r\n            }, d);\r\n          } else {\r\n            return d[textField];\r\n          }\r\n        }).join(spliter);\r\n      } else {\r\n        if (idField) {\r\n          newObject.key = data[idField];\r\n        }\r\n\r\n        if (textField) {\r\n          if (textField.indexOf('.') > -1) {\r\n            newObject.value = textField.split('.').reduce((r, c) => {\r\n              return r[c];\r\n            }, data);\r\n          } else {\r\n            newObject.value = data[textField];\r\n          }\r\n        }\r\n      }\r\n    }\r\n    this.UIStateBindingChange.emit(newObject);\r\n  }\r\n}\r\n","import { Directive, ElementRef, Input, Renderer2, OnInit, OnChanges, SimpleChanges } from '@angular/core';\r\nimport { GridComponent } from '@progress/kendo-angular-grid';\r\n@Directive({\r\n    selector: '[farrisDisabled]'\r\n})\r\nexport class FarrisDisabledDirective implements OnInit, OnChanges {\r\n    @Input('farrisDisabled') kendoGridDisabled: boolean;\r\n    maskElement: any;\r\n    constructor(private grid: GridComponent, private el: ElementRef, private renderer: Renderer2) {\r\n\r\n    }\r\n    ngOnInit() {\r\n\r\n    }\r\n    ngOnChanges(changes: SimpleChanges) {\r\n        if (!this.maskElement) {\r\n            this.createMaskElement();\r\n        }\r\n        if (changes['kendoGridDisabled'] && this.maskElement) {\r\n            if (this.kendoGridDisabled) {\r\n                this.renderer.removeStyle(this.maskElement, 'display');\r\n            } else {\r\n                this.renderer.setStyle(this.maskElement, 'display', 'none');\r\n            }\r\n        }\r\n    }\r\n    private createMaskElement() {\r\n        this.maskElement = this.renderer.createElement(\"div\");\r\n        this.renderer.setStyle(this.maskElement, 'width', '100%');\r\n        this.renderer.setStyle(this.maskElement, 'height', '100%');\r\n        this.renderer.setStyle(this.maskElement, 'position', 'absolute');\r\n        this.renderer.setStyle(this.maskElement, 'background-color', 'rgba(255,255,255,0.5)');\r\n        this.renderer.setStyle(this.maskElement, 'z-index', '3');\r\n        this.renderer.setStyle(this.maskElement, 'display', 'none');\r\n        this.renderer.appendChild(this.el.nativeElement, this.maskElement);\r\n    }\r\n}\r\n\r\n","import { Directive, Input, Injector } from '@angular/core';\r\nimport { FrameContext, BindingData, ViewModel } from '@farris/devkit';\r\n@Directive({\r\n    selector: '[farrisSort]'\r\n})\r\nexport class FarrisSortDirective {\r\n\r\n}\r\n\r\n@Directive({\r\n    selector: '[farris-textarea-edit]'\r\n})\r\nexport class FarrisTextareaEditDirective {\r\n\r\n}\r\n\r\n@Directive({\r\n    selector: '[farrisDynamicColumnFormat]'\r\n})\r\nexport class FarrisDynamicColumnFormatDirective {\r\n\r\n}\r\n\r\n@Directive({\r\n    selector: '[farris-enter-edit]'\r\n})\r\nexport class FarrisEditEnterDirective {\r\n    @Input('form-group') farrisForm: any;\r\n}\r\n\r\n@Directive({\r\n    selector: '[farrisTreeTableFormat]'\r\n})\r\nexport class FarrisTreeTableFormatDirective {\r\n\r\n}\r\n\r\n","import {\r\n  Directive, OnInit, OnChanges, OnDestroy, SimpleChanges, HostListener,\r\n  EventEmitter, Output\r\n} from '@angular/core';\r\nimport { Subject, Subscription } from 'rxjs';\r\nimport { BindingData, BindingList, Change, ChangeType, ViewModel, FrameContext, DataTypeInfo, EntityPathConverter, RunMode, ComponentType, ExpressionUtil, ENABLE_EDIT_STATE_FILTER_SORTING } from '@farris/devkit';\r\nimport { DatagridComponent } from '@farris/ui-datagrid';\r\nimport { debounceTime, finalize } from 'rxjs/operators';\r\n// tslint:disable: max-line-length\r\n\r\n/*\r\n * ä½¿ç¨ç»å®æ°æ®æä»¤\r\n */\r\n@Directive({\r\n  selector: '[farris-use-binding-data]'\r\n})\r\nexport class FarrisDatagridUseBindingDataDirective implements OnInit, OnChanges, OnDestroy {\r\n  private _PROPS: { [propName: string]: any };\r\n  // æåºå­æ®µ\r\n  private sortFields: string = null;\r\n  // æåºæ¹å\r\n  private sortDirections: string = null;\r\n  /**\r\n   * æ¯å¦å·²æåº\r\n   */\r\n  private hasSorted = false;\r\n  /**\r\n   * è¿æ»¤æ¡ä»¶\r\n   */\r\n  private filters: any = null;\r\n  protected get props() {\r\n    return this._PROPS;\r\n  }\r\n  protected set props(value) {\r\n    this._PROPS = value;\r\n  }\r\n  protected bindingDataChangeEvent: Subscription;\r\n  /**\r\n   * æ¸²ægrid\r\n   */\r\n  private renderGridSubject: Subject<any> = new Subject<any>();\r\n  private enableFilterSorting = false;\r\n  /**\r\n   * éä¸­è¡åæ¢äºä»¶\r\n   */\r\n  @Output() selectedRowChange: EventEmitter<any> = new EventEmitter<any>();\r\n  // private renderGridDebounce;\r\n  constructor(public bindingData: BindingData, public viewModel: ViewModel, public grid: DatagridComponent) {\r\n    this.setChecks([]);\r\n    this.enableFilterSorting = this.viewModel && this.viewModel.frameContext && this.viewModel.frameContext.injector.get<boolean>(ENABLE_EDIT_STATE_FILTER_SORTING, false) || false;\r\n    this.registerEvent();\r\n  }\r\n\r\n  // #region Ng Event\r\n\r\n  ngOnInit() {\r\n    const { pageSize = 0 } = this.getPagingInfo() || {};\r\n    if (pageSize !== 0) {\r\n      // å¯ç¨åé¡µ\r\n      if ((!this.grid.pageList || this.grid.pageList.length < 1) && typeof this.grid['setPageList'] === 'function') {\r\n        this.grid['setPageList']([pageSize, pageSize * 2, pageSize * 3, pageSize * 4]);\r\n      }\r\n    }\r\n    this.setComponentRef();\r\n    this.bindData();\r\n    window.setTimeout(() => {\r\n      this.updateSelectedRow();\r\n    }, 0);\r\n    this.registerBindingDataChangeEvent();\r\n    this.renderGridSubject.pipe(debounceTime(500)).subscribe((change: Change) => {\r\n      if (!this.viewModel || !this.viewModel.frameContext || this.viewModel.frameContext.isDisposed) {\r\n        return;\r\n      }\r\n      this.bindData(change);\r\n      /*if (!this.renderGridDebounce) {\r\n        this.renderGridDebounce = this.debounce((change) => {\r\n          this.bindData(change);\r\n        }, 500);\r\n      }\r\n      this.renderGridDebounce(change);*/\r\n    });\r\n    if (this.viewModel && this.viewModel.frameContext && this.viewModel.frameContext.frameComponent) {\r\n      this.viewModel.frameContext.frameComponent.componentType = ComponentType.farrisDataGridComponent;\r\n    }\r\n  }\r\n\r\n  ngOnChanges(changes: SimpleChanges) {\r\n    this.bindData();\r\n  }\r\n\r\n  // #endregion\r\n\r\n\r\n  /**\r\n   * ä¸»é®\r\n   */\r\n  protected get primaryKey() {\r\n    return this.bindingList.primaryKey;\r\n  }\r\n  /**\r\n   * è·åç»å®æ°æ®\r\n   */\r\n  protected get bindingList(): BindingList {\r\n    // æ ¹å®ä½\r\n    if (this.viewModel.bindingPath === '/' || !this.viewModel.bindingPath) {\r\n      return this.bindingData.list;\r\n    }\r\n    // å­å®ä½\r\n    let bindingPath = this.viewModel.bindingPath.substr(1);\r\n    bindingPath = bindingPath[0].toLowerCase() + bindingPath.substring(1, bindingPath.length);\r\n    const paths = bindingPath.split('/');\r\n\r\n    const filteredPaths = paths.filter((part: string) => {\r\n      return part !== '';\r\n    });\r\n    return this.bindingData.getValue(filteredPaths);\r\n  }\r\n  /**\r\n   * è®¾ç½®ç»ä»¶å¼ç¨\r\n   */\r\n  private setComponentRef() {\r\n    const appContext = this.viewModel && this.viewModel.frameContext && this.viewModel.frameContext.getFormAppContext();\r\n    const frameId = this.viewModel && this.viewModel.frameContext && this.viewModel.frameContext.frameId;\r\n    const id = this.grid && this.grid.id;\r\n    // å¦æframeIdä¸å­å¨æfarris gridæ²¡æidå±æ§ï¼è¯´æä¸ç¬¦åä½¿ç¨åºæ¯\r\n    if (!frameId || !id) {\r\n      return;\r\n    }\r\n    const map = appContext && appContext.componentRefs && appContext.componentRefs.get(frameId) || new Map<string, any>();\r\n    appContext && appContext.componentRefs && appContext.componentRefs.set(frameId, map.set(id, this.grid));\r\n  }\r\n  /**\r\n   * è·ååé¡µä¿¡æ¯\r\n   */\r\n  protected getPagingInfo() {\r\n    const bindingPath = this.viewModel.bindingPath;\r\n    const bindingData = this.viewModel.bindingData;\r\n    const pagingInfo = bindingData && bindingData.pagingInfo || {};\r\n    if (bindingPath === '/') {\r\n      return pagingInfo;\r\n    } else {\r\n      const bindingPaths = bindingPath.substr(1).split('/').filter((item) => !!item && item.length > 0);\r\n      // ä»è¡¨åä»ä»è¡¨åé¡µåæ°æ®æ¯å³èçï¼å ä¸ºä¸åçä»è¡¨è¡æä¸åçä»ä»è¡¨æ°æ®ï¼åé¡µä¿¡æ¯çç»æä¸ºnodeCode_parentId:{åé¡µä¿¡æ¯}ä¸åé¡µä¿¡æ¯æ¯å¹³çº§ç\r\n      // {pagination:{a_pid:{pageSize:2,pageIndex:1},b_pid:{pageSize:2,pageIndex:1}}}\r\n      // ååºå½åè·¯å¾ä¸å®ä½çnodeCode\r\n      let nodeCode = bindingPaths[bindingPaths.length - 1];\r\n      nodeCode = nodeCode.substr(0, nodeCode.length - 1);\r\n      // è·åå½åå®ä½ä¸çº§çä¸»é®\r\n      // const result = pagingInfo[nodeCode] || {};\r\n      // if (result.hasOwnProperty('totalCount')) {\r\n      //   result.total = result.totalCount;\r\n      // }\r\n      // return result;\r\n\r\n      const paths = bindingPaths.slice(0, bindingPaths.length - 1);\r\n      const bindingList = bindingData.getValue(paths) as BindingList;\r\n      const { pageSize = 0 } = pagingInfo[`${nodeCode}`] || {};\r\n      // ä¸çº§è¡¨ææ°æ®\r\n      if (bindingList && bindingList.currentId) {\r\n        const key = `${nodeCode}_${bindingList.currentId}`;\r\n        // const key = nodeCode;\r\n        const result = pagingInfo[key] || {};\r\n        if (result.hasOwnProperty('totalCount')) {\r\n          result.total = result.totalCount;\r\n        }\r\n        // ä¸çº§è¡¨è½ç¶ææ°æ®ï¼ä½ä¸çº§è¡¨å½åè¡çä¸çº§è¡¨å¯è½æ²¡ææ°æ®ï¼è¿å°±å¯¼è´è·åä¸å°åé¡µä¿¡æ¯ï¼æä»¥éè¦å¨è¿ååå¯¹ç»æè¿è¡å¤çï¼å¦ææ²¡æåé¡µä¿¡æ¯çè¯èµ·ç åºè¯¥è¿ååé¡µå¤§å°åå½åé¡µç \r\n        if (Object.keys(result).length < 1) {\r\n          result.pageIndex = 1;\r\n          result.pageSize = pageSize;\r\n        }\r\n        return result;\r\n      } else {\r\n        // ä¸çº§è¡¨æ²¡ææ°æ®ï¼æ­¤æ¶éè¦è·åå½åè¡¨çåé¡µä¿¡æ¯ï¼å¦åé¡µå¤§å°ãå½åé¡µé»è®¤ä¸º1å³å¯ã\r\n        return { pageIndex: 1, pageSize };\r\n      }\r\n    }\r\n  }\r\n\r\n  // #region Input\r\n  /**\r\n   * ç»ä»¶æ¯å¦éè¦æ´æ°\r\n   * @param props å½åå±æ§\r\n   * @param nextProps æ°å±æ§\r\n   * @param change åæ´\r\n   */\r\n  protected shouldComponentUpdate(change: Change, data: any,): { result: boolean, props?: any } {\r\n    const props = this.buildProps(data);\r\n    if (this.viewModel && this.viewModel.frameContext && this.viewModel.frameContext.appContext && this.viewModel.frameContext.appContext.runMode === RunMode.highSpeed && change) {\r\n      if (change.type === ChangeType.Load || change.type === ChangeType.Remove || change.type === ChangeType.PaginationInfoChange) {\r\n        return { result: true, props };\r\n      }\r\n    }\r\n    const gridProps = this.buildGridProps();\r\n    if (JSON.stringify(props) === JSON.stringify(gridProps)) {\r\n      return { result: false };\r\n    }\r\n    return { result: true, props };\r\n  }\r\n  protected registerEvent() {\r\n    // æåºäºä»¶\r\n    this.grid && this.grid.columnSorted && this.grid.columnSorted.subscribe((event: any) => {\r\n      const isRemoteSort = this.grid.remoteSort;\r\n      // æ¬å°æåº\r\n      if (!isRemoteSort) {\r\n        this.sortFields = this.grid.sortName;\r\n        this.sortDirections = this.grid.sortOrder;\r\n        this.sortBindingList();\r\n        // this.props = this.buildProps();\r\n      } else {\r\n        // æå¡å¨ç«¯æåº\r\n        const groupField = this.grid && this.grid.groupField || null;\r\n        let sortFields = this.grid.sortName && this.grid.sortName.split(',') || [];\r\n        const sortDirection = this.grid.sortOrder && this.grid.sortOrder.split(',') || [];\r\n        if (groupField) {\r\n          if (!sortFields.includes(groupField)) {\r\n            sortFields.splice(0, 0, groupField);\r\n            sortDirection.splice(0, 0, 'asc');\r\n          }\r\n        }\r\n        // è·åå½åentityä¸ææobjectå±æ§\r\n        const entityType = this.viewModel && this.viewModel.frameContext.repository.entityType || null;\r\n\r\n        if (sortFields.length > 0) {\r\n          if (entityType) {\r\n            const dataTypeInfo = new DataTypeInfo(entityType);\r\n            sortFields = sortFields.map(field => {\r\n              //if (field && field.indexOf('.') !== -1) {\r\n              const paths = field.split('.');\r\n              const propInfo = dataTypeInfo.getPropInfoByPath(paths);\r\n              const originalField = propInfo && propInfo.metadataInfo['path'] || null;\r\n              return originalField;\r\n              //}\r\n              //return field;\r\n            });\r\n          }\r\n        }\r\n        // éåå±æ§ï¼æ ¹æ®datafieldè½¬æ¢ä¸ºoriginalDataField\r\n        const fields = sortFields.join(',');\r\n        const directions = sortDirection.join(',') || 'asc';\r\n        const frameContext: FrameContext = this.viewModel && this.viewModel.frameContext || null;\r\n        if (frameContext) {\r\n          frameContext.repository.sortConditionManager.setConditions(this.viewModel.bindingPath, fields, directions);\r\n        }\r\n      }\r\n    });\r\n    // è¿æ»¤äºä»¶\r\n    this.grid && this.grid.filterChanged && this.grid.filterChanged.subscribe((event: any) => {\r\n      this.filters = event;\r\n      if (!this.grid.remoteFilter) {\r\n        if (this.bindingList.length > 0 && !this.bindingList.currentId) {\r\n          const id = this.bindingList.getIdByIndex(0);\r\n          this.bindingList.setCurrentId(id);\r\n        }\r\n        this.bindingList.filter(this.filters);\r\n        this.bindData();\r\n      }\r\n    });\r\n    this.viewModel.frameContext.appContext.messagePipe.subscribe((message) => {\r\n      if (message && message === 'CLEAR_GRID_CONDITION' && this.filters && Object.keys(this.filters).length > 0) {\r\n        this.filters = {};\r\n        this.bindData();\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * å¯¹bindingListæåº\r\n   * @param change change\r\n   */\r\n  private sortBindingList(change?: Change) {\r\n    // groupFieldå¯è½æå¤ä¸ªï¼ä»¥éå·åéçå­ç¬¦ä¸²\r\n    const groupField = this.grid && this.grid.groupField || null;\r\n    if (groupField) {\r\n      const arrSortFields = this.sortFields && this.sortFields.split(',') || [];\r\n      const groupFields = groupField.split(',').reverse();\r\n      groupFields.forEach((field: string) => {\r\n        if (!arrSortFields.includes(field)) {\r\n          arrSortFields.splice(0, 0, field);\r\n          const arrSortDirection = this.sortDirections && this.sortDirections.split(',') || [];\r\n          arrSortDirection.splice(0, 0, 'asc');\r\n          this.sortFields = arrSortFields.join(',');\r\n          this.sortDirections = arrSortDirection.join(',') || 'asc';\r\n        }\r\n      });\r\n    }\r\n    this.bindingList.sortBy(this.sortFields, this.sortDirections);\r\n    this.bindData(change);\r\n  }\r\n  // #endregion\r\n\r\n  // #region æ°æ®ç»å®é¨å\r\n  /**\r\n   * æ´æ°æ°æ®\r\n   * @param change? åæ´\r\n   */\r\n  bindData(change?: Change) {\r\n    const isRemoteFilter = this.grid && this.grid.remoteFilter || false;\r\n    // åæ§è¡æåº\r\n    const shouldSort = this.shouldSort(change);\r\n    if (shouldSort) {\r\n      this.hasSorted = true;\r\n      this.sortBindingList(change);\r\n      return;\r\n    }\r\n    this.hasSorted = false;\r\n    // æ°å¢æ°æ®æ¶æ¸ç©ºè¡¨æ ¼ç­éæ¡ä»¶\r\n    if ((this.grid.editable === true || change && change.type === ChangeType.Append) && this.filters && Object.keys(this.filters).length > 0 && !isRemoteFilter) {\r\n      if (!this.viewModel.frameContext.appContext.enableGridHeaderWhenEditing && !this.enableFilterSorting) {\r\n        this.filters = {};\r\n        this.grid.clearCondition();\r\n      }\r\n    }\r\n    const shouldFiltering = this.shouldFiltering(change);\r\n    if (shouldFiltering) {\r\n      this.bindingList.filter(this.filters);\r\n    }\r\n    // åtoJSON\r\n    const data: any = this.bindingList.toJSON();\r\n    // if (this.filters && Object.keys(this.filters).length > 0 && !isRemoteFilter) {\r\n    //   // data = this.grid.clientFilterService.executeFilter(data, this.filters);\r\n    // }\r\n\r\n    if (this.filters && Object.keys(this.filters).length > 0 && !isRemoteFilter && (!change || change && change.type !== ChangeType.SelectionChanged && change.type !== ChangeType.GlobalSelectionChanged)) {\r\n      if (data && data.length > 0) {\r\n        // å¤æ­å½åè¡æ¯å¦å¨è¿æ»¤åçæ°æ®ä¸­\r\n        const row = (data as []).find((item) => item[this.bindingList.primaryKey] === this.bindingList.currentId);\r\n        if (!row) {\r\n          const firstRowId = data[0][this.bindingList.primaryKey];\r\n          this.bindingList.setCurrentId(firstRowId, true, true);\r\n        }\r\n      } else {\r\n        // æ¬å°è¿æ»¤å®ä¹åæ²¡ææ°æ®äº\r\n        // this.bindingList.currentId = null;\r\n        if (this.bindingList.currentId) {\r\n          this.bindingList.setCurrentId(null, true, true, true);\r\n        }\r\n        // åéæ¶æ¸ç©ºids\r\n        if (!this.grid.multiSelect) {\r\n          this.setChecks([]);\r\n        }\r\n      }\r\n    }\r\n    const result = this.shouldComponentUpdate(change, data);\r\n    if (!result.result) {\r\n      return;\r\n    }\r\n    // const nextProps = this.buildProps(result);\r\n    this.renderGrid(result.props);\r\n    this.props = JSON.parse(JSON.stringify(result.props));\r\n  }\r\n  /**\r\n   * æ¯å¦åºè¯¥è¿æ»¤\r\n   * @param change - change\r\n   * @returns {boolean}\r\n   */\r\n  private shouldFiltering(change?: Change) {\r\n    const isRemoteFilter = this.grid && this.grid.remoteFilter || false;\r\n    // å¯ç¨è¿ç«¯è¿æ»¤æ¶ä¸éè¦æ¬å°è¿æ»¤\r\n    if (isRemoteFilter === true) {\r\n      return false;\r\n    }\r\n    // æ²¡æè¿æ»¤æ¡ä»¶æ¶ä¸éè¦æ§è¡è¿æ»¤\r\n    if (!this.filters || Object.keys(this.filters).length < 1) {\r\n      return false;\r\n    }\r\n    if (change) {\r\n      return change.type === ChangeType.Load;\r\n    }\r\n    return !this.grid.editable;\r\n  }\r\n  private shouldSort(change?: Change) {\r\n    // this.sortFields && !this.grid.editable && change && (change.type === 'Load' || change.type === 'SelectionChanged')\r\n    if (!this.sortFields || Object.keys(this.sortFields).length < 1) {\r\n      return false;\r\n    }\r\n    if (this.hasSorted) {\r\n      return false;\r\n    }\r\n    if (change) {\r\n      return change.type === 'Load' || change.type === 'SelectionChanged';\r\n    }\r\n    return this.grid.editable;\r\n  }\r\n  /**\r\n   * æ¸²ægrid\r\n   * @param props å±æ§\r\n   */\r\n  private renderGrid(props: any) {\r\n    const { pageIndex, pageSize, total, pagination, data } = props;\r\n    const virtualizedLoad = this.grid.virtualizedAsyncLoad || false;\r\n    this.grid.total = total;\r\n    this.grid.pageSize = pageSize;\r\n    this.grid.pageIndex = pageIndex;\r\n    this.grid.pagination = pagination;\r\n    this.grid.controlPaginationState = false;\r\n    // this.endCellEdit();\r\n    if (pageSize === 0) {\r\n      this.grid.pagination = false;\r\n      this.grid.pageIndex = 1;\r\n      // ä¿®å¤ä¸åé¡µæ¶gridå¯ç¨åç»ä»ä¼éæ°é¦æ°çé®é¢\r\n      // this.grid.pageSize = total;\r\n    }\r\n    if (virtualizedLoad) {\r\n      this.grid.loadVirtualData({\r\n        items: data,\r\n        pageIndex,\r\n        pageSize,\r\n        total\r\n      });\r\n    } else {\r\n      this.grid.loadData(data);\r\n    }\r\n  }\r\n  /**\r\n   * æé è¡¨æ ¼æ°æ®å±æ§\r\n   */\r\n  protected buildProps(datas?: Array<any>) {\r\n    let data;\r\n    if (typeof (datas) !== 'undefined') {\r\n      data = datas;\r\n    } else {\r\n      data = this.bindingList.toJSON();\r\n    }\r\n    // let skip = 0;\r\n    let { pageIndex = 1, pageSize = 0 } = this.getPagingInfo() || {};\r\n    let { total = 0 } = this.getPagingInfo() || {};\r\n    // if (pageIndex > 0) {\r\n    //   skip = (pageIndex - 1) * pageSize;\r\n    // }\r\n    if (pageSize === 0 && total === 0) {\r\n      total = data.length;\r\n    }\r\n    return { data, pageIndex, pageSize, total, pagination: pageSize !== 0 };\r\n  }\r\n  /**\r\n   * è®¡ç®gridç¶æ\r\n   */\r\n  private buildGridProps() {\r\n    const data = this.grid.data || [];\r\n    let skip = 0;\r\n    const { pageIndex = 1, pageSize = 0 } = { pageIndex: this.grid.pageIndex, pageSize: this.grid.pageSize };\r\n    let total = this.grid.total || 0;\r\n    if (pageIndex > 0) {\r\n      skip = (pageIndex - 1) * pageSize;\r\n    }\r\n    if (pageSize === 0 && total === 0) {\r\n      total = data.length;\r\n    }\r\n    return { data, pageIndex, pageSize, total, pagination: this.grid.pagination };\r\n  }\r\n  /**\r\n   * æ°æ®æºåçåæ´\r\n   * @param change åæ´\r\n   */\r\n  protected onBindingDataChange(change: Change) {\r\n    this.updateDataSource(change);\r\n    this.updateSelectedRow(change);\r\n    // this.updateGrid(change);\r\n    // ä¸æ¸é¤å¾éè¡ï¼éè¦ä¿çå¾éç¶æ\r\n    // this.clearCheckedRows(change);\r\n    this.endCellEdit(change);\r\n    // æ´æ°å¾éè¡æ°æ®\r\n    this.updateCheckedRows(change);\r\n    this.updateData(change);\r\n  }\r\n  /**\r\n   * æ´æ°æ°æ®\r\n   */\r\n  private updateDataSource(change: Change) {\r\n    if (change && change.type === ChangeType.ValueChanged) {\r\n      // è®¡ç®åæ´è·¯å¾ä¸­è¡¨ååå­æ®µå\r\n      const paths = change.path;\r\n      try {\r\n        const entityPath = ExpressionUtil.getAvailableChildrenPathsFromEntityPaths(paths, this.viewModel.frameContext.repository.entityTypeInfo);\r\n        if (this.viewModel.bindingPath === '/' + entityPath.join('/')) {\r\n          const propertyNames = paths.slice(entityPath.length);\r\n          if (change.id && this.grid && change.path && this.viewModel.frameContext.appContext.runMode !== RunMode.highSpeed && propertyNames && propertyNames.length > 0) {\r\n            this.grid.updateRow(change.id, { [propertyNames.join('.')]: change.value });\r\n          }\r\n        }\r\n      } catch (error) {\r\n        console.warn(error);\r\n      }\r\n      this.renderGridSubject.next(change);\r\n    } else if (change && (change.type === ChangeType.SelectionChanged || change.type === ChangeType.GlobalSelectionChanged)) {\r\n      if (this.bindingList.currentId === (this.grid.selectedRow && this.grid.selectedRow.id) && this.grid.total > 0) {\r\n      } else {\r\n        this.bindData(change);\r\n      }\r\n    } else {\r\n      this.bindData(change);\r\n    }\r\n  }\r\n  // private endCellEdit() {\r\n  //   const isEditing = this.grid.isEditing();\r\n  //   if (isEditing) {\r\n  //     this.grid.endCellEdit();\r\n  //   }\r\n  // }\r\n  private endCellEdit(change: Change) {\r\n    const isEditing = this.grid.isEditing();\r\n    if (change.type === ChangeType.Load && isEditing) {\r\n      this.grid.endCellEdit();\r\n    }\r\n  }\r\n  /**\r\n   * è®¾ç½®gridå½åéæ©è¡\r\n   * @param change åæ´\r\n   */\r\n  private updateSelectedRow(change?: Change) {\r\n    if (!this.bindingList || !this.bindingList.currentId) {\r\n      return;\r\n    }\r\n    // é¡µç åæ¢æ¶ä¸æ§è¡å½åè¡åæ¢\r\n    if (change && change.type === ChangeType.PaginationInfoChange) {\r\n      return;\r\n    }\r\n    if (this.viewModel && this.viewModel.frameContext.bindingData.rowSelectedEventSuspend === true) {\r\n      return;\r\n    }\r\n    const { id: gridSelectedRowId = null } = this.grid.selectedRow || {};\r\n    const currentId = this.bindingList.currentId;\r\n    // gridå½åè¡ä¸bingingListå½åè¡ä¸è´ï¼æ é¡»åæ¢\r\n    if (gridSelectedRowId === currentId) {\r\n      const isMatch = change && (change.path.toString() === this.viewModel.bindingPath.split('/').filter(p => p).toString());\r\n      if (change && change.type === ChangeType.Load && isMatch) {\r\n        this.grid.clearSelections();\r\n        this.grid.selectRow(currentId, true, true);\r\n      }\r\n      return;\r\n    }\r\n    this.selectGridRow(this.bindingList.currentId);\r\n  }\r\n  /**\r\n   * æ³¨åbindingdataååäºä»¶\r\n   */\r\n  private registerBindingDataChangeEvent() {\r\n    this.bindingDataChangeEvent = this.bindingData.changes.subscribe((change: Change) => {\r\n      this.onBindingDataChange(change);\r\n    });\r\n    this.viewModel.frameContext.appContext.messagePipe.subscribe(message => {\r\n      if (message === 'bindData') {\r\n        this.bindData();\r\n      }\r\n    });\r\n  }\r\n  /**\r\n   * åæ¶bindingdataååè®¢é\r\n   */\r\n  private unRegisterBindingDataChangeEvent() {\r\n    if (this.bindingDataChangeEvent && typeof (this.bindingDataChangeEvent.unsubscribe) === 'function') {\r\n      this.bindingDataChangeEvent.unsubscribe();\r\n    }\r\n  }\r\n  /**\r\n   * è§¦åé¡µç åæ¢äºä»¶\r\n   * @description æ¬æ¹æ³éç¨åºæ¯ä»ä¸ºç¶çº§gridæ°æ®éæ°loadï¼éè¦è§¦åè¯¥gridéæ°åæ°ä½¿ç¨ãå¶ä»åºæ¯è¯·å¿ä½¿ç¨\r\n   * @TODO: å¾éæï¼æ§å¶ä¸çº§æ°æ®å è½½åºè¯¥ä¾èµè¡¨æ ¼çè¡åæ¢äºä»¶ï¼ä¸´æ¶è¿æ ·å¤çï¼åç»­æä¾LoadChildrenäºä»¶\r\n   */\r\n  private updateData(change?: Change) {\r\n    if (!(change && (change.type === ChangeType.SelectionChanged || change.type === ChangeType.Load))) {\r\n      return;\r\n    }\r\n    const bindingPath = this.viewModel.bindingPath;\r\n    const eventBindingPath = '/' + change.path.join('/');\r\n    const isRetrieve = this.viewModel.frameContext.appContext.params.get('retrieveing') || false;\r\n    if (change.path.length < 1 || bindingPath === '/' || bindingPath === eventBindingPath || !bindingPath.startsWith(eventBindingPath)) {\r\n      return;\r\n    }\r\n    // retrieveæ¶ä¼èªå¨å¸¦åä»è¡¨ç¬¬ä¸é¡µåä»è¡¨ç¬¬ä¸è¡çä»ä»è¡¨æ°æ®ï¼æä»¥ä¸éè¦åå»åç¬è¯·æ±\r\n    if (isRetrieve) {\r\n      return;\r\n    }\r\n    const fullPaths = EntityPathConverter.toEntityPathArray(this.viewModel.bindingPath, this.bindingData);\r\n    const paths = fullPaths.slice(0, fullPaths.length - 1);\r\n    const parent = this.bindingList.parent;\r\n    const parentId = parent && parent[parent.primaryKey];\r\n    // ä¸çº§è¡¨æ²¡ææ°æ®\r\n    if (!parentId) {\r\n      return;\r\n    }\r\n    // è·ånodecode\r\n    const bindingPaths = this.viewModel.bindingPath.split('/').filter(item => item);\r\n    let nodeCode = bindingPaths[bindingPaths.length - 1];\r\n    nodeCode = nodeCode.substr(0, nodeCode.length - 1);\r\n    // const configPath = `/${nodeCode}_${parentId}`;\r\n    const configPath = `/${nodeCode}`;\r\n    let { pageIndex = 1 } = this.viewModel.frameContext.repository.entityCollection.getPaginationConfigByPath(configPath) || {};\r\n    const { pageSize = 0 } = this.viewModel.frameContext.repository.entityCollection.getPaginationConfigByPath(configPath) || {};\r\n\r\n    const parentNodeCode = change.path[change.path.length - 1];\r\n    const parentConfigPath = '/' + parentNodeCode.substring(0, parentNodeCode.length - 1);\r\n    const { pageSize: parentPageSize = 0 } = this.viewModel.frameContext.repository.entityCollection.getPaginationConfigByPath(parentConfigPath) || {};\r\n    const isQueryChild = this.viewModel.frameContext.appContext.params.get('queryChild') || false;\r\n    if (isQueryChild) {\r\n      // this.viewModel.frameContext.appContext.params.delete('queryChild');\r\n      pageIndex = 1;\r\n    }\r\n    // å½ä¸çº§è¡¨åæ¢è¡æ¶\r\n    if (parentPageSize + pageSize !== 0) {\r\n      this.viewModel.frameContext.appContext.params.set('forceQueryChild', true);\r\n      this.viewModel.frameContext.repository.queryChild(paths, pageIndex, pageSize).pipe(\r\n        finalize(() => this.viewModel.frameContext.appContext.params.delete('forceQueryChild'))\r\n      ).subscribe();\r\n    }\r\n  }\r\n  ngOnDestroy() {\r\n    this.unRegisterBindingDataChangeEvent();\r\n  }\r\n  // #endregion\r\n\r\n  // #region äºä»¶åå°å¨\r\n\r\n  /**\r\n   * åå°éä¸­è¡åæ¢äºä»¶\r\n   * @description ç»ä¸åéæ¨¡å¼åå¤éæ¨¡å¼ä¸çè¡åæ¢äºä»¶\r\n   */\r\n  protected fireSelectedRowChange(selectedRowContext: any) {\r\n    this.selectedRowChange.emit(selectedRowContext);\r\n  }\r\n  /**\r\n   * æ¸ç©ºéå®è¡\r\n   * @param change åæ´\r\n   */\r\n  private clearCheckedRows(change: Change) {\r\n    if (change.type === ChangeType.Load && this.grid.multiSelect) {\r\n      const isMatch = this.checkIfChangeMatchBindingPath(change);\r\n      if (isMatch) {\r\n        this.setChecks([]);\r\n        if (typeof (this.grid.clearCheckeds) === 'function') {\r\n          this.grid.clearCheckeds();\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  // #endregion\r\n\r\n\r\n\r\n  // #region éä¿¡\r\n\r\n  /**\r\n   * è®¾ç½®BindingListçå½åè¡\r\n   * @param id å½åè¡åç \r\n   */\r\n  protected setSelectionIdToBindingData(id: string): void {\r\n    // å¦æå½åè¡ä¸å­å¨ï¼åå¼ºå¶è®¾ç½®\r\n    if (!id) {\r\n      this.bindingList.currentId = id;\r\n      if (!this.grid.multiSelect) {\r\n        this.setChecks([]);\r\n      }\r\n      return;\r\n    }\r\n    if (this.bindingList.currentId !== id) {\r\n      this.bindingList.setCurrentId(id, true);\r\n    }\r\n    // åéæ¨¡å¼ä¸å°å½åè¡è®¾ç½®å°ids\r\n    if (!this.grid.multiSelect) {\r\n      this.setChecks([id]);\r\n    }\r\n  }\r\n  private updateCheckedRows(changes: Change) {\r\n    if (changes.type === ChangeType.Load) {\r\n      this.setCheckedRows();\r\n    } else if (changes.type === ChangeType.ValueChanged) {\r\n      const ids = this.getChecks();\r\n      if (changes.id && ids.includes(changes.id)) {\r\n        this.setCheckedRows();\r\n      }\r\n    }\r\n  }\r\n  /**\r\n   * è®¾ç½®éæ©è¡\r\n   */\r\n  protected setChecks(ids: string[]) {\r\n    this.viewModel.uiState.setPropertyValue('ids', ids);\r\n    this.setCheckedRows(ids);\r\n  }\r\n  /**\r\n   * è·åå¾éè¡idæ°ç»\r\n   * @returns\r\n   */\r\n  protected getChecks(): string[] {\r\n    return this.viewModel.uiState['ids'] || [];\r\n  }\r\n  /**\r\n   * æ´æ°å¾éè¡æ°æ®\r\n   */\r\n  protected setCheckedRows(ids?: string[]) {\r\n    // é«éæ¨¡å¼æ¶ä¸åè®¾ç½®rows\r\n    // if (this.viewModel.frameContext.appContext.runMode === RunMode.highSpeed) {\r\n    //   return;\r\n    // }\r\n    if (typeof ids === 'undefined') {\r\n      ids = this.viewModel.uiState['ids'] || [];\r\n    }\r\n    if (!Array.isArray(ids) || ids.length < 1) {\r\n      // æ­¤æ¶idsæ²¡æå¼ï¼rowsä¸­ä¹ä¸åºè¯¥æ\r\n      this.viewModel.uiState.setPropertyValue('rows', null);\r\n      return;\r\n    }\r\n    let list = [];\r\n    // TODOï¼rowsä¸­æ°æ®å¨é«éæ¨¡å¼åæ®éæ¨¡å¼ä¸å¤è¯­å­æ®µçå¼è¡¨ç°ä¸ä¸è´ï¼é«éæ¨¡å¼ä¸å¤è¯­å­æ®µå¼ä¸ºå¯¹è±¡ï¼æ®éæ¨¡å¼ä¸ºå½åè¯­è¨ãæä¸å¤çé«éæ¨¡å¼åºæ¯\r\n    if (this.viewModel.frameContext.appContext.runMode === RunMode.highSpeed) {\r\n      list = this.grid.data || [];\r\n    } else {\r\n      list = this.bindingList.toJSON({ ignoreMultiLangInput: true });\r\n    }\r\n    const rows: Map<string, any> = this.viewModel.uiState['rows'] || new Map<string, any>();\r\n\r\n    const result = new Map<string, any>();\r\n    ids.forEach((id: any) => {\r\n      const item = list.find(item => item[this.primaryKey] === id);\r\n      const otherPageItem = rows.get(id);\r\n      if (item) {\r\n        result.set(id, item);\r\n      } else if (otherPageItem) {\r\n        result.set(id, otherPageItem);\r\n      }\r\n    });\r\n    this.viewModel.uiState.setPropertyValue('rows', result);\r\n  }\r\n  /**\r\n   * éä¸­gridè¡\r\n   * @param id id\r\n   */\r\n  protected selectGridRow(id: any) {\r\n    this.grid.selectRow(id);\r\n    this.grid.scrollToCurrentRow();\r\n  }\r\n  // #endregion\r\n  // #region äºä»¶å¤çå¨\r\n\r\n  /**\r\n   * é¡µç åæ¢äºä»¶\r\n   * @param event event\r\n   */\r\n  @HostListener('pageChanged', ['$event'])\r\n  public pageChangedHandler(event: any) {\r\n    let { pageIndex, pageSize } = event;\r\n    if (pageIndex < 1) {\r\n      pageIndex = 1;\r\n    }\r\n    const skip = (pageIndex - 1) * pageSize;\r\n    this.bindingData.setPagingInfo(skip, pageSize, this.bindingData.bindingPath);\r\n  }\r\n\r\n  /**\r\n   * è¡åæ¢äºä»¶\r\n   * @param event event\r\n   */\r\n  @HostListener('selectChanged', ['$event'])\r\n  public selectedRowChanged(event: any) {\r\n    const { index, data } = event;\r\n    const id = data[this.primaryKey];\r\n    this.setSelectionIdToBindingData(id);\r\n    this.fireSelectedRowChange(event);\r\n  }\r\n\r\n  /**\r\n   * åæ¶è¡éæ©äºä»¶\r\n   * @param event event\r\n   */\r\n  @HostListener('unSelect', ['$event'])\r\n  public unSelected(event: any) {\r\n    if (!event) {\r\n      return;\r\n    }\r\n    const { data = {} } = event;\r\n    const id = data[this.primaryKey];\r\n    const currentId = this.bindingList.currentId;\r\n    if (id === currentId) {\r\n      this.setSelectionIdToBindingData(null);\r\n    }\r\n    // this.fireSelectedRowChange(event);\r\n  }\r\n  /**\r\n   * å¾éè¡åçåå\r\n   * @param event event\r\n   */\r\n  @HostListener('checkedChange', ['$event'])\r\n  public checkedChanged(event: any) {\r\n    event = event || [];\r\n    const ids = event.map(item => item.id);\r\n    this.setChecks(ids);\r\n  }\r\n  /**\r\n   * åé¡µå¤§å°åæ´äºä»¶\r\n   * @param event event\r\n   */\r\n  @HostListener('pageSizeChanged', ['$event'])\r\n  public pageSizeChanged(event: any) {\r\n    const { pageIndex, pageSize } = event;\r\n    const skip = 0;//(pageIndex - 1) * pageSize;\r\n    // this.bindingList.setPaginationInfo(skip, pageSize);\r\n    this.bindingData.setPagingInfo(skip, pageSize, this.bindingData.bindingPath);\r\n  }\r\n\r\n  /**\r\n   * gridæ»å¨å è½½æ°æ®\r\n   * @param event event\r\n   */\r\n  @HostListener('scrollYLoad', ['$event'])\r\n  public scrollY(event: any) {\r\n    const { pager: pageIndex, pageSize } = event;\r\n    const skip = (pageIndex - 1) * pageSize;\r\n    this.bindingData.setPagingInfo(skip, pageSize, this.bindingData.bindingPath);\r\n  }\r\n  @HostListener('filterChanged', ['$event'])\r\n  public filterChanged(event: any) {\r\n    this.filters = event;\r\n  }\r\n  // #endregion\r\n  private checkIfChangeMatchBindingPath(change: Change): boolean {\r\n    let isMatch = false;\r\n    if (!change || !change.path) {\r\n      return isMatch;\r\n    }\r\n\r\n    const changePathArray = change.path;\r\n    if (!changePathArray) {\r\n      return isMatch;\r\n    }\r\n\r\n    if (!(this.bindingData) && !(this.bindingData.bindingPath)) {\r\n      return isMatch;\r\n    }\r\n    const bingdingPathArray = this.bindingData.bindingPath.split('/');\r\n    if (bingdingPathArray.length <= 0) {\r\n      return isMatch;\r\n    }\r\n\r\n    if (changePathArray.length === 0) { // ä¸»è¡¨\r\n      if (this.bindingData.bindingPath === '/') {\r\n        isMatch = true;\r\n      }\r\n    } else if (change.path.length === 1) {// ä¸»ä»è¡¨\r\n      if (bingdingPathArray.length === 2 && bingdingPathArray[1] === change.path[0]) {\r\n        isMatch = true;\r\n      }\r\n    } else if (change.path.length === 2) { // ä¸»ä»ä»è¡¨\r\n      if (bingdingPathArray.length === 3 && bingdingPathArray[1] === change.path[0] && bingdingPathArray[2] === change.path[1]) {\r\n        isMatch = true;\r\n      }\r\n    }\r\n\r\n    return isMatch;\r\n  }\r\n  private debounce(callback: (...args) => any, wait) {\r\n    let timeoutId = null;\r\n    return (...args) => {\r\n      window.clearTimeout(timeoutId);\r\n      timeoutId = window.setTimeout(() => {\r\n        callback.apply(null, args);\r\n      }, wait);\r\n    };\r\n  }\r\n}\r\n","import { Directive, Input, Self, Host, Optional, OnInit, Output, EventEmitter } from '@angular/core';\r\nimport { MultiSelectComponent } from '@farris/ui-multi-select'\r\nimport { ViewModel, BindingObject } from '@farris/devkit';\r\n\r\n@Directive({\r\n  selector: '[multiSelectDataMapping]'\r\n})\r\nexport class MultiSelectDataMappingDirective implements OnInit {\r\n\r\n  @Input() dataSource: any;\r\n  @Input() idField: string;\r\n  @Input() textField: string;\r\n  @Input() valueField: string;\r\n  @Input() fjmField: string;\r\n  @Input() fjdField: string;\r\n  @Input() uiStateField: any;\r\n  @Input() selectedId: string;\r\n  @Output() selectedIdChanged = new EventEmitter<string>();\r\n  private originalDataSource: any;\r\n\r\n  constructor(\r\n    @Optional() private vm: ViewModel,\r\n    @Host() @Self() @Optional() private multiSelectComponent: MultiSelectComponent\r\n  ) {\r\n    this.vm.uiState.changes.subscribe(data => {\r\n      this.selectedId = data.value;\r\n    })\r\n  }\r\n  ngOnInit() {\r\n    this.multiSelectComponent.dataSource = [];\r\n    if (Array.isArray(this.dataSource)) {\r\n      this.multiSelectComponent.dataSource = this.dataSource;\r\n      this.originalDataSource = this.dataSource;\r\n    } else if (this.dataSource && this.dataSource.changes) {\r\n      this.dataSource.changes.subscribe((data: any) => {\r\n        if (data.type === 'Load') {\r\n          this.originalDataSource = data.value;\r\n          if (this.multiSelectComponent.isTree()) {\r\n            if (this.fjmField) {\r\n              // åçº§ç å è½½æ ç»æ\r\n              this.multiSelectComponent.dataSource = this.plainToTree(data.value, this.fjmField, 1);\r\n            } else if (this.fjdField) {\r\n              // ç¶èç¹å è½½æ ç»æ\r\n              this.multiSelectComponent.dataSource = this.buildTreeNodesByFjd(data.value, this.fjdField);\r\n            }\r\n            this.multiSelectComponent.selections = this.getTreeSelectionsById(this.selectedId, this.originalDataSource);\r\n          } else {\r\n            this.multiSelectComponent.dataSource = data.value;\r\n            this.multiSelectComponent.selections = this.getListSelectionsById(this.selectedId, this.multiSelectComponent.dataSource);\r\n          }\r\n        }\r\n      })\r\n    }\r\n    this.selectIdBindingToUIStateField();\r\n  }\r\n\r\n  private selectIdBindingToUIStateField() {\r\n    if (this.multiSelectComponent && this.multiSelectComponent.selectedIdChange) {\r\n      this.multiSelectComponent.selectedIdChange.subscribe(data => {\r\n        this.selectedIdChanged.emit(data);\r\n      })\r\n    }\r\n  }\r\n  /**\r\n   * \r\n   * @param data éè¦æ ¼å¼åçæ°æ®\r\n   */\r\n  private formatDataSource(data: any[], field: string) {\r\n    if (!data || !data.length) {\r\n      return [];\r\n    }\r\n    return data.map(item => {\r\n      const n = item['toJSON'] ? item.toJSON() : item;\r\n      return {\r\n        data: Object.assign({ ...n }, {\r\n          [`${this.idField}`]: item[this.idField],\r\n          [`${this.textField}`]: item[this.textField],\r\n          [`${this.valueField}`]: item[this.valueField],\r\n          [`${field}`]: item[field]\r\n        }),\r\n        children: []\r\n      }\r\n    });\r\n  }\r\n  /**\r\n   * æå¹³è¡ç»æçæ°æ®è½¬æ¢ææ å½¢ç»æ\r\n   * @param plainSource \r\n   * @param field \r\n   * @param layer \r\n   */\r\n  private plainToTree(plainSource: any[], field: string, layer: number) {\r\n    const treeSource = this.formatDataSource(plainSource, field);\r\n    if (!treeSource.length) {\r\n      return [];\r\n    }\r\n    if (!treeSource[0]['data'][field]) {\r\n      return [];\r\n    }\r\n    const parents = treeSource.filter(item => {\r\n      return item['data'][field]['layer'] === layer;\r\n    })\r\n    this.recursive(parents, treeSource, field, 1);\r\n    return parents;\r\n  }\r\n\r\n  /**\r\n   * éå½éåæ å½¢ç»æ\r\n   * @param parents \r\n   * @param treeSource \r\n   * @param field \r\n   * @param layer \r\n   */\r\n  private recursive(parents: any[], treeSource: any[], field: string, layer: number) {\r\n    parents.forEach(parent => {\r\n      const parentPath = parent['data'][field]['path'];\r\n      const parentLayer = parent['data'][field]['layer'];\r\n      if (parent['data'][field]['isDetail'] === false) {\r\n        treeSource.forEach(item => {\r\n          if (item && item['data'] && item['data'][field] && item['data'][field]['path']) {\r\n            const itemPath = item['data'][field]['path'];\r\n            const itemLayer = item['data'][field]['layer'];\r\n            let targetPath: string;\r\n            if (itemPath && itemPath.length > parentPath.length) {\r\n              targetPath = itemPath.substr(0, Number(layer) * 4);\r\n            }\r\n            if (parentPath === targetPath && parentLayer === itemLayer - 1) {\r\n              parent['children'].push(item);\r\n            }\r\n            if (item['data'][field]['isDetail'] === false && parentPath === targetPath) {\r\n              this.recursive([item], treeSource, field, Number(layer) + 1);\r\n            }\r\n          }\r\n        });\r\n      }\r\n    })\r\n  }\r\n  /**\r\n     * \r\n     * @param ids éä¸­æ°æ®çid\r\n     * @param dataSource åå§æ°æ®\r\n     */\r\n  private getListSelectionsById(ids: any, dataSource: any) {\r\n    let result = [];\r\n    const _this = this;\r\n    if ((typeof ids === 'string' && !!ids) || typeof ids === 'number') {\r\n      const reusltObj = dataSource.find(item => {\r\n        return item && item[_this.idField] === ids;\r\n      });\r\n      if (reusltObj) {\r\n        result.push(reusltObj);\r\n      }\r\n    } else if (Array.isArray(ids)) {\r\n      if (dataSource) {\r\n        ids.forEach(id => {\r\n          const item = dataSource.find(item => item && item[_this.idField] === id);\r\n          if (item) {\r\n            result.push(item);\r\n          }\r\n        });\r\n        // dataSource.forEach(item => {\r\n        //   ids.forEach(id => {\r\n        //     if (item[_this.idField] === id) {\r\n        //       result.push(item);\r\n        //     }\r\n        //   })\r\n        // })\r\n      } else {\r\n        result = [];\r\n      }\r\n    } else {\r\n      result = [];\r\n    }\r\n    return result;\r\n  }\r\n\r\n  /**\r\n   * \r\n   * @param ids éä¸­æ°æ®çid\r\n   * @param dataSource åå§æ°æ®\r\n   */\r\n  private getTreeSelectionsById(ids: any, dataSource: any) {\r\n    let result = [];\r\n    const _this = this;\r\n    if ((typeof ids === 'string' && !!ids) || typeof ids === 'number') {\r\n      const reusltObj = dataSource.find(item => {\r\n        return item && item[_this.idField] === ids;\r\n      });\r\n      if (reusltObj) {\r\n        result.push(reusltObj);\r\n      }\r\n    } else if (Array.isArray(ids)) {\r\n      if (dataSource) {\r\n        ids.forEach(id => {\r\n          const item = dataSource.find(item => item && item[_this.idField] === id);\r\n          if (item) {\r\n            result.push(item);\r\n          }\r\n        });\r\n        // dataSource.forEach(item => {\r\n        //   ids.forEach(id => {\r\n        //     if (item.data[_this.idField] === id) {\r\n        //       result.push(item.data);\r\n        //     }\r\n        //   })\r\n        // })\r\n      } else {\r\n        result = [];\r\n      }\r\n    } else {\r\n      result = [];\r\n    }\r\n    return result;\r\n  }\r\n\r\n\r\n\r\n  /**\r\n   * æ ¹æ®ç¶èç¹åå§åæ ç»æ\r\n   * @param bindingObjects \r\n   */\r\n  private buildTreeNodesByFjd(bindingObjects: BindingObject[], field: string) {\r\n    const treeData = this.formatDataSource(bindingObjects, field);\r\n    treeData.forEach((item: any) => {\r\n      const parent = treeData.find((ele: any) => item.data[field].parentElement === ele.data[this.idField]);\r\n      if (parent) {\r\n        parent.children.push(item);\r\n      }\r\n    });\r\n    return treeData.filter((ele: any) => !ele.data[field].parentElement);\r\n  }\r\n}\r\n","import { Subscription } from 'rxjs';\r\nimport { Directive, OnInit, HostListener, Output, EventEmitter, OnDestroy, OnChanges, Input, ChangeDetectorRef } from '@angular/core';\r\nimport { BindingData, BindingList, ViewModel, Change } from '@farris/devkit';\r\nimport { ListViewComponent } from '@farris/ui-list-view';\r\n@Directive({\r\n  selector: '[farrisListviewBinding]'\r\n})\r\n\r\nexport class FarrisListViewBindingDirective implements OnInit, OnDestroy, OnChanges {\r\n  bindingDataChangeEvent: Subscription;\r\n\r\n  /**\r\n   * ä¸»é®\r\n   */\r\n  protected get primaryKey() {\r\n    return this.bindingList.primaryKey;\r\n  }\r\n\r\n  @Input() supportPaged: boolean = true;\r\n  /**\r\n   * éä¸­è¡åæ¢äºä»¶\r\n   */\r\n  @Output() selectedRowChange: EventEmitter<any> = new EventEmitter<any>();\r\n\r\n  constructor(\r\n    private bindingData: BindingData,\r\n    private viewModel: ViewModel,\r\n    private listview: ListViewComponent) {\r\n\r\n  }\r\n\r\n  ngOnInit() {\r\n    // ç»å®æ°æ®\r\n    this.bindData();\r\n    this.registerBindingDataChangeEvent();\r\n\r\n  }\r\n\r\n  ngOnChanges() {\r\n    this.bindData();\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.unRegisterBindingDataChangeEvent();\r\n  }\r\n\r\n  /**\r\n   * è·ååé¡µä¿¡æ¯\r\n   */\r\n  protected getPagingInfo() {\r\n    const bindingPath = this.viewModel.bindingPath;\r\n    const bindingData = this.viewModel.bindingData;\r\n    let pagingInfo = bindingData.pagingInfo;\r\n    if (bindingPath === '/') {\r\n      return pagingInfo;\r\n    } else {\r\n      const bindingPaths = bindingPath.substr(1).split('/').filter(item => !!item && item.length > 0).map(item => {\r\n        return item.substring(0, item.length - 1);\r\n      });\r\n      bindingPaths.forEach(path => {\r\n        pagingInfo = pagingInfo && pagingInfo[path];\r\n      });\r\n      return pagingInfo;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * è®¾ç½®listviewå±æ§\r\n   */\r\n  private setListViewPageProps() {\r\n    const data = this.bindingList.toJSON();\r\n    let skip = 0;\r\n    const { pageIndex = 1, pageSize = 0 } = this.getPagingInfo() || {};\r\n    let { total = 0 } = this.getPagingInfo() || {};\r\n    if (pageIndex > 0) {\r\n      skip = (pageIndex - 1) * pageSize;\r\n    }\r\n    if (pageSize === 0 && total === 0) {\r\n      total = data.length;\r\n    }\r\n    this.listview.supportPaging = this.supportPaged;\r\n    this.listview.pageIndex = pageIndex;\r\n    this.listview.pageSize = pageSize;\r\n    this.listview.total = total;\r\n    let currentPage = pageIndex;\r\n    const itemsPerPage = pageSize;\r\n    let totalItems = total;\r\n    if (pageSize === 0) {\r\n      // this.listview.supportPaging = false;\r\n      this.listview.pageIndex = pageIndex;\r\n      this.listview.total = total;\r\n      currentPage = 1;\r\n      totalItems = total;\r\n    }\r\n    if (this.listview.paginationOptions) {\r\n      this.listview.paginationOptions.itemsPerPage = itemsPerPage;\r\n      this.listview.paginationOptions.currentPage = currentPage;\r\n      this.listview.paginationOptions.pageList = this.listview.pageList;\r\n      this.listview.paginationOptions.totalItems = totalItems;\r\n    }\r\n    const listViewChangeDetectRef: ChangeDetectorRef = this.listview['cdr'] as ChangeDetectorRef;\r\n    if (listViewChangeDetectRef) {\r\n      listViewChangeDetectRef.detectChanges();\r\n    }\r\n    const paginationDirective = this.listview.pager && this.listview.pager['paginationDirective'];\r\n    if (paginationDirective && paginationDirective['service']) {\r\n      try {\r\n        paginationDirective['service'].instances[this.listview.pager.id] = { ...this.listview.paginationOptions };\r\n        paginationDirective['service'].setTotalItems(this.listview.pager.id, totalItems);\r\n        paginationDirective.changeDetectorRef.detectChanges();\r\n      } catch { }\r\n    }\r\n  }\r\n\r\n  /*\r\n   * è·åç»å®æ°æ®\r\n   */\r\n  protected get bindingList(): BindingList {\r\n    // æ ¹å®ä½\r\n    if (this.viewModel.bindingPath === '/' || !this.viewModel.bindingPath) {\r\n      return this.bindingData.list;\r\n    }\r\n    // å­å®ä½\r\n    let bindingPath = this.viewModel.bindingPath.substr(1);\r\n    bindingPath = bindingPath[0].toLowerCase() + bindingPath.substring(1, bindingPath.length);\r\n    const paths = bindingPath.split('/');\r\n\r\n    const filteredPaths = paths.filter((part: string) => {\r\n      return part !== '';\r\n    });\r\n    return this.bindingData.getValue(filteredPaths);\r\n  }\r\n\r\n  /* ç»å®æ°æ® */\r\n  private bindData() {\r\n    this.setListViewPageProps();\r\n    const data = this.bindingList.toArray();\r\n    this.listview.setData(data);\r\n  }\r\n\r\n  /*\r\n       * åå°éä¸­è¡åæ¢äºä»¶\r\n       * @description ç»ä¸åéæ¨¡å¼åå¤éæ¨¡å¼ä¸çè¡åæ¢äºä»¶\r\n       */\r\n  protected fireSelectedRowChange(selectedRowContext: any) {\r\n    this.selectedRowChange.emit(selectedRowContext);\r\n  }\r\n\r\n  /**\r\n   * è®¾ç½®BindingListçå½åè¡\r\n   * @param id å½åè¡åç \r\n   */\r\n  protected setSelectionIdToBindingData(id: string): void {\r\n    this.bindingList.setCurrentId(id, true);\r\n  }\r\n\r\n  /**\r\n   * æ°æ®æºåçåæ´\r\n   * @param change åæ´\r\n   */\r\n  protected onBindingDataChange(change: Change) {\r\n    this.bindData();\r\n    this.updateSelectedRow(change);\r\n  }\r\n  /**\r\n   * è®¾ç½®å½åè¡\r\n   * @param change åæ´\r\n   */\r\n  private updateSelectedRow(change?: Change) {\r\n    if (!this.bindingList || !this.bindingList.currentId) {\r\n      return;\r\n    }\r\n    if (this.viewModel && this.viewModel.frameContext.bindingData.rowSelectedEventSuspend === true) {\r\n      return;\r\n    }\r\n    const { id = null } = this.listview.clickItem || {};\r\n    const currentId = this.bindingList.currentId;\r\n    // gridå½åè¡ä¸bingingListå½åè¡ä¸è´ï¼æ é¡»åæ¢\r\n    if (id === currentId) {\r\n      return;\r\n    }\r\n    this.selectRow(this.bindingList.currentId);\r\n  }\r\n  protected selectRow(id: any) {\r\n    if (this.listview && typeof this.listview.selectRow === 'function') {\r\n      this.listview.selectRow(id);\r\n    }\r\n  }\r\n  /**\r\n   * æ³¨åbindingdataååäºä»¶\r\n   */\r\n  private registerBindingDataChangeEvent() {\r\n    this.bindingDataChangeEvent = this.bindingData.changes.subscribe((change: Change) => {\r\n      this.onBindingDataChange(change);\r\n    });\r\n  }\r\n  /**\r\n   * åæ¶bindingdataååè®¢é\r\n   */\r\n  private unRegisterBindingDataChangeEvent() {\r\n    this.bindingDataChangeEvent.unsubscribe();\r\n  }\r\n  private setChecks(ids: string[]) {\r\n    this.viewModel.uiState.setPropertyValue('ids', ids);\r\n  }\r\n  /* åæ¢è¡äºä»¶ */\r\n  @HostListener('listClick', ['$event'])\r\n  changeRow(event: any) {\r\n    const { index, data, checkChangeEvent } = event;\r\n    if (checkChangeEvent === false || !event.hasOwnProperty('checkChangeEvent')) {\r\n      if (data && Array.isArray(data) && data.length > 0) {\r\n        const id = data[0] && data[0][this.primaryKey] || null;\r\n        if (id) {\r\n          this.setSelectionIdToBindingData(id);\r\n        }\r\n      }\r\n      this.listview.activeIndex = index;\r\n      this.fireSelectedRowChange(event);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * åæ¢é¡µç è§¦åäºä»¶\r\n   * @param event åæ¢é¡µç åæ°\r\n   */\r\n  @HostListener('pageChanged', ['$event'])\r\n  public pageChangedHandler(event: any) {\r\n    let pageIndex = event.pageInfo.pageIndex;\r\n    const pageSize = event.pageInfo.pageSize;\r\n    if (pageIndex < 1) {\r\n      pageIndex = 1;\r\n    }\r\n    const skip = (pageIndex - 1) * pageSize;\r\n    this.bindingData.setPagingInfo(skip, pageSize, this.bindingData.bindingPath);\r\n  }\r\n\r\n  /**\r\n   * è®¾ç½®æ¯é¡µæ°æ®æ¡æ°è§¦åäºä»¶\r\n   * @param event åæ¢é¡µç åæ°\r\n   */\r\n  @HostListener('pageSizeChanged', ['$event'])\r\n  public pageSizeChangedHandler(event: any) {\r\n    const { pageIndex, pageSize } = event.pageInfo;\r\n    const skip = (pageIndex - 1) * (+pageSize);\r\n    this.bindingData.setPagingInfo(skip, pageSize, this.bindingData.bindingPath);\r\n  }\r\n  @HostListener('checkValuesChange', ['$event'])\r\n  public checkValuesChange(event: any) {\r\n    const ids = event;\r\n    this.setChecks(ids);\r\n  }\r\n}\r\n","import {\r\n  Directive, OnInit, OnChanges, OnDestroy, SimpleChanges, Input, Injector, NgZone,\r\n} from '@angular/core';\r\nimport { of, Subscription } from 'rxjs';\r\nimport {\r\n  BindingData, BindingList, ViewModel, DataTypeInfo, DataPropInfo, ENABLE_EDIT_STATE_FILTER_SORTING\r\n} from '@farris/devkit';\r\nimport { DatagridComponent } from '@farris/ui-datagrid';\r\nimport { isNumber } from 'lodash-es';\r\nimport { DateTimeHelperService } from '@farris/ui-common/date';\r\nimport { RuntimeStateService } from '@farris/ui-common';\r\nimport { DialogService } from '@farris/ui-dialog';\r\nimport { LookupGridComponent } from '@farris/ui-lookup';\r\nimport { ComboLookupComponent } from '@farris/ui-combo-lookup';\r\n\r\n@Directive({\r\n  selector: '[farris-datagrid-editable]'\r\n})\r\nexport class EditableDirective implements OnInit, OnChanges, OnDestroy {\r\n  /**\r\n   * gridæ¯å¦å¯ä»¥ç¼è¾\r\n   */\r\n  @Input('farris-datagrid-editable') gridEditable: boolean;\r\n  /**\r\n   * ç¼è¾æ¶åæ¶åç»\r\n   */\r\n  @Input('disableGroupOnEditing') disableGroupOnEditing: boolean = true;\r\n  /**\r\n   * å¤éå¸®å©é»è®¤åéç¬¦\r\n   */\r\n  private defaultSpliter: string = ',';\r\n  private beginEditSubscription: Subscription;\r\n  private endEditSubscription: Subscription;\r\n  /**\r\n   * ä¸´æ¶è®°å½gridåç»å­æ®µ\r\n   */\r\n  private groupFields: any[] = [];\r\n  protected get bindingList(): BindingList {\r\n    // æ ¹å®ä½\r\n    if (this.viewModel.bindingPath === '/' || !this.viewModel.bindingPath) {\r\n      return this.bindingData.list;\r\n    }\r\n    // å­å®ä½\r\n    let bindingPath = this.viewModel.bindingPath.substr(1);\r\n    bindingPath = bindingPath[0].toLowerCase() + bindingPath.substring(1, bindingPath.length);\r\n    const paths = bindingPath.split('/');\r\n\r\n    const filteredPaths = paths.filter((part: string) => {\r\n      return part !== '';\r\n    });\r\n    return this.bindingData.getValue(filteredPaths);\r\n  }\r\n  constructor(\r\n    public bindingData: BindingData,\r\n    public viewModel: ViewModel,\r\n    public grid: DatagridComponent,\r\n    private dateService: DateTimeHelperService,\r\n    public injector: Injector,\r\n    private rts: RuntimeStateService,\r\n    public dialogSer: DialogService,\r\n    public ngZone: NgZone\r\n  ) { }\r\n\r\n  ngOnInit() {\r\n    this.apply();\r\n  }\r\n  ngOnChanges(changes: SimpleChanges) {\r\n    this.apply();\r\n  }\r\n  ngOnDestroy() {\r\n    this.detach();\r\n  }\r\n  /**\r\n   * åºç¨å±æ§\r\n   */\r\n  private apply() {\r\n    if (!this.grid) {\r\n      return;\r\n    }\r\n    this.handleGroupStatus();\r\n    // æ¯å¦å¯ç¨äºç¼è¾æè¿æ»¤æåº\r\n    if (this.gridEditable) {\r\n      const enableFilterSorting = this.injector && this.injector.get<boolean>(ENABLE_EDIT_STATE_FILTER_SORTING, false) || false;\r\n      if (!this.grid.remoteFilter && !enableFilterSorting) {\r\n        this.grid.clearCondition();\r\n        // åéæ¸ç©ºè¿æ»¤æ¡ä»¶äºä»¶\r\n        this.viewModel.frameContext.appContext.messagePipe.next('CLEAR_GRID_CONDITION');\r\n      }\r\n\r\n      this.grid.editable = true;\r\n      if (!this.viewModel.frameContext.appContext.enableGridHeaderWhenEditing && !enableFilterSorting) {\r\n        this.grid.disableHeader(true);\r\n      }\r\n      this.handleBeginEditEvent();\r\n      this.handleAfterEditEvent();\r\n      this.handleEndEditEvent();\r\n    } else {\r\n      this.grid.editable = false;\r\n      this.grid.disableHeader(false);\r\n      // TODO:åºç±è¡¨æ ¼å¼å®¹ï¼ä½ç®åè¡¥ä¸ä¸è½ç»§ç»­ä¾èµè¡¨æ ¼ç»ä»¶ï¼ä¸´æ¶ä½¿ç¨è¯¥æ¹æ¡å¤ç\r\n      // 2023-12-25 è¡¨æ ¼åé¨å·²è§£å³åè®¾ç½®åè¡¨å¤´æ æ³æå¨é®é¢ï¼ä¸å¼å®¹ä»£ç å­å¨è¦çå¼åèè®¾ç½®çèªå®ä¹ååç§°çé®é¢\r\n      // this.grid.columns = this.grid.columns.map((cols) => {\r\n      //   return cols.map((col) => Object.assign({}, col));\r\n      // });\r\n      // this.grid.columnsChanged(false);\r\n      if (this.grid && typeof this.grid.sort === 'function' && this.grid.sortName) {\r\n        this.grid.sort();\r\n      }\r\n      this.detach();\r\n    }\r\n  }\r\n  /**\r\n   * ç¼è¾æ¶åæ¶åç»\r\n   */\r\n  private handleGroupStatus() {\r\n    if (this.disableGroupOnEditing === false) {\r\n      return;\r\n    }\r\n    const groupField = this.grid && this.grid.groupField || null;\r\n    if (groupField) {\r\n      if (this.gridEditable) {\r\n        this.groupFields = [groupField];\r\n        this.grid.setGroupFields('');\r\n      }\r\n    } else {\r\n      if (this.groupFields && this.groupFields.length > 0) {\r\n        const groupField = this.groupFields.pop();\r\n        if (this.groupFields.length > 0) {\r\n          this.groupFields = [];\r\n        }\r\n        this.grid.setGroupFields(groupField);\r\n      }\r\n    }\r\n  }\r\n  /**\r\n   * å¤çå¼å§ç¼è¾äºä»¶\r\n   */\r\n  private handleBeginEditEvent() {\r\n    this.beginEditSubscription = this.grid.beginEdit.subscribe((e: any) => {\r\n      if (!e) {\r\n        return;\r\n      }\r\n      const column = e.column;\r\n      if (column && column.editor) {\r\n        const editorInstance = e.editor.componentRef.instance;\r\n        if (!editorInstance || !editorInstance.instance) {\r\n          return;\r\n        }\r\n        let mapFields = editorInstance.instance.mapFields;\r\n        if (column.editor.type === 'lookup' || column.editor.type === 'PersonnelSelector' || column.editor.type === 'OrganizationSelector' || column.editor.type === 'external-integration' || 'EmployeeSelector' === column.editor.type || 'EmployeeOrgSelector' === column.editor.type) {\r\n          const lookupGrid: LookupGridComponent = editorInstance.instance;\r\n          const subject = editorInstance.instance.selectedData;\r\n          if (subject) {\r\n            subject.subscribe((data: any) => {\r\n              mapFields = editorInstance.instance.mapFields;\r\n              const spliter = lookupGrid.multipleChoiceSeparator || this.defaultSpliter;\r\n              this.lookupMapping(data, mapFields, false, spliter);\r\n            });\r\n          }\r\n          const clearMappings = editorInstance.instance.clearMappings;\r\n          if (clearMappings) {\r\n            clearMappings.subscribe((result: any) => {\r\n              const mapFields = Object.assign({}, editorInstance.instance.mapFields);\r\n              const value = result && result.value || null;\r\n              const binding = editorInstance.column && editorInstance.column.field;\r\n              const lookupTextField = editorInstance.instance.textField;\r\n              const data = {};\r\n              if (binding) {\r\n                const textFieldMapping = mapFields[lookupTextField];\r\n                if (textFieldMapping) {\r\n                  const otherField: string = textFieldMapping.split(',').filter((item) => item !== binding).join(',');\r\n                  if (otherField) {\r\n                    mapFields[lookupTextField] = otherField;\r\n                  } else {\r\n                    delete mapFields[lookupTextField];\r\n                  }\r\n                }\r\n                const parentPaths = this.getBindingPathArray();\r\n                this.bindingData.setValue(parentPaths.concat(binding.split('.')), value, true, true);\r\n              }\r\n              // this.setValue(data, lookupTextField.split('.'), value);\r\n              if (mapFields && Object.keys(mapFields).length > 0) {\r\n                Object.keys(mapFields).forEach((field) => {\r\n                  this.setValue(data, field.split('.'), '');\r\n                });\r\n                this.lookupMapping(data, mapFields, true);\r\n              }\r\n            });\r\n          }\r\n        }\r\n\r\n        if (column.editor.type === 'combo-lookup') {\r\n          editorInstance.instance.valueChange.subscribe((e: any) => {\r\n            const asClear = e && e.selections && e.selections.length === 0;\r\n            const comboLookup: ComboLookupComponent = editorInstance.instance;\r\n            mapFields = editorInstance.instance.mapFields;\r\n            const spliter = comboLookup.separator || this.defaultSpliter;\r\n            this.lookupMapping(e.selections || [], mapFields, asClear, spliter);\r\n          });\r\n        }\r\n        if (['combo-lookup', 'combolist', 'lookup', 'PersonnelSelector', 'OrganizationSelector', 'external-integration', 'EmployeeSelector', 'EmployeeOrgSelector'].includes(column.editor.type)) {\r\n          if (editorInstance.instance.clear && editorInstance.instance.clear.subscribe) {\r\n            editorInstance.instance.clear.subscribe(() => {\r\n              this.lookupMapping(null, mapFields);\r\n            });\r\n          }\r\n        }\r\n\r\n        if (column.editor.type === 'combolist') {\r\n          if (mapFields) {\r\n            editorInstance.instance.valueChange.subscribe((e) => {\r\n              const pathArr = this.getBindingPathArray();\r\n              this.viewModel.bindingData.setValue(pathArr.concat(mapFields.split('.')), editorInstance.instance.selectedValues, true, true);\r\n            });\r\n          }\r\n        }\r\n      }\r\n    });\r\n  }\r\n  /**\r\n   * å¤çç¼è¾äºä»¶\r\n   */\r\n  private handleAfterEditEvent() {\r\n    this.grid.afterEdit = (rowIndex, rowData, column, editor) => {\r\n      if (this.dialogSer.hasDialogOpened()) {\r\n        return of(false);\r\n      }\r\n      if (this.rts) {\r\n        // å¸®å©ç»ä»¶ææ¬åååå»æ¥è¯¢\r\n        if (this.rts.getFormState('lookup.pending')) {\r\n          return of(false);\r\n        }\r\n      }\r\n      // æ´æ°æ°æ®æº\r\n      if (!editor || !editor.formControl) {\r\n        return of(false);\r\n      }\r\n      return of(true);\r\n    };\r\n  }\r\n  /**\r\n   * å¤çç»æç¼è¾äºä»¶\r\n   */\r\n  private handleEndEditEvent() {\r\n    this.endEditSubscription = this.grid && this.grid.endEdit && this.grid.endEdit.subscribe((event: any) => {\r\n      const { value = undefined, column = undefined, rowData = {} } = event || {};\r\n      const primaryValue = rowData && rowData[this.grid.idField] || null;\r\n      this.updateBindingData(value, column, primaryValue);\r\n    });\r\n  }\r\n  /*\r\n   * ç»åè¡¨èµå¼ æç»formcontrolèµå¼\r\n   */\r\n  private updateBindingData(value: any, column: any, primaryValue?: any) {\r\n    if (!column) {\r\n      return;\r\n    }\r\n    const currentColumnType = column.dataType;\r\n    // åæ¶å¤æ­gridOptionçåå¯¹è±¡\r\n\r\n    const fieldPaths = column.field.split('.');\r\n    // æ¯å¦ä¸ºå¤§æ°\r\n    const isBigNumber = column && column.editor && column.editor.options && column.editor.options.bigNumber;\r\n    // å­å¨è¡ç¼è¾å¨\r\n    if (currentColumnType === 'date') {\r\n      let result;\r\n      if (value) {\r\n        result = this.dateService.formatTo(value, 'yyyy-MM-dd');\r\n      } else {\r\n        result = value;\r\n      }\r\n      this.updateBindingList(primaryValue, fieldPaths.join('.'), result);\r\n    } else if (currentColumnType === 'datetime') {\r\n      // if (!value) {\r\n      //   value = '0001-01-01T00:00:00';\r\n      // }\r\n      this.updateBindingList(primaryValue, fieldPaths.join('.'), value);\r\n    } else if (currentColumnType === 'number' && !isBigNumber) {\r\n      if (value === null || value === undefined) {\r\n        this.updateBindingList(primaryValue, fieldPaths.join('.'), null);\r\n      } else {\r\n        this.updateBindingList(primaryValue, fieldPaths.join('.'), Number(value));\r\n      }\r\n    } else {\r\n      this.updateBindingList(primaryValue, fieldPaths.join('.'), value);\r\n    }\r\n  }\r\n  private updateBindingList(primaryValue: any, propertyName: string, value: any) {\r\n    const viewModel = this.viewModel || null;\r\n    if (!viewModel || !propertyName) {\r\n      return;\r\n    }\r\n    // æ´æ°ä¸»è¡¨é¨åè¡çå­æ®µ\r\n    const propertyNames = propertyName.split('.').filter((item) => item);\r\n    const bindingPath = this.getBindingPathArray();\r\n    // ååºæ¥çä¸å®æ¯bindingList\r\n    const list = this.bindingData.getValue(bindingPath) as BindingList;\r\n    // ä¿®æ¹çæ¯å½åè¡\r\n    if (list && primaryValue === list.currentItem.primaryKeyValue) {\r\n      const paths = bindingPath.concat(propertyNames);\r\n      this.bindingData.setValue(paths, value, true, true);\r\n      return;\r\n    }\r\n    const bindingObject = this.bindingList.findById(primaryValue);\r\n    if (!bindingObject) {\r\n      return;\r\n    }\r\n    if (propertyNames.length < 2) {\r\n      bindingObject.setValue(propertyName, value, true, true);\r\n    } else {\r\n      let targetBindingObject = null;\r\n      const fpaths = propertyNames.slice(0, propertyNames.length - 1);\r\n      const targetPropertyName = propertyNames[propertyNames.length - 1];\r\n      fpaths.forEach((prop) => {\r\n        targetBindingObject = targetBindingObject && targetBindingObject[prop] || bindingObject[prop];\r\n      });\r\n      // todo:éè¦æ·»å å¼ååäºä»¶\r\n      targetBindingObject.setValue(targetPropertyName, value, true, true);\r\n    }\r\n  }\r\n  private detach() {\r\n    if (this.beginEditSubscription && typeof this.beginEditSubscription.unsubscribe === 'function') {\r\n      this.beginEditSubscription.unsubscribe();\r\n    }\r\n    if (this.endEditSubscription && typeof this.endEditSubscription.unsubscribe === 'function') {\r\n      this.endEditSubscription.unsubscribe();\r\n    }\r\n  }\r\n\r\n  //#region å¸®å©å­æ®µæ å°\r\n\r\n  private lookupMapping(helpData: any, mapFields: any, asClear: boolean = false, spliter: string = ',') {\r\n    if (!mapFields) {\r\n      return;\r\n    }\r\n    // å³é­åæ´æ£æµ\r\n    const appContext = this.viewModel.frameContext.appContext;\r\n    appContext.changeDetectionController.detach();\r\n\r\n    const pathArr = this.getBindingPathArray();\r\n    let helpFields = Object.keys(mapFields);\r\n    const primaryInfo = this.getMapFieldsPrimaryKey(mapFields, pathArr);\r\n\r\n    let primaryKeys = primaryInfo && primaryInfo.map((item) => item.primaryKey) || [];\r\n    const primaryFields = primaryInfo && primaryInfo.map((item) => item.primaryField) || [];\r\n    // å»é\r\n    if (primaryKeys && primaryKeys.length > 0) {\r\n      primaryKeys = [...new Set(primaryKeys)];\r\n      helpFields = this.sortMapFieldKeys(helpFields, primaryKeys);\r\n    }\r\n\r\n    if (!helpData || asClear) {\r\n      helpFields.reverse();\r\n    }\r\n    helpFields.forEach((f: any) => {\r\n      let val: any = '';\r\n      if (helpData) {\r\n        if (helpData instanceof Array) {\r\n          val = helpData.map((h: any) => {\r\n            return this.getValue(f, h);\r\n          }).join(spliter);\r\n        } else {\r\n          val = this.getValue(f, helpData);\r\n        }\r\n      }\r\n\r\n      let mappings: any[] = mapFields[f].split(',');\r\n      const headMappings = mappings.filter((p) => primaryFields.includes(p));\r\n      const leftMappings = mappings.filter((p) => !primaryFields.includes(p));\r\n      if (!helpData) {\r\n        mappings = [].concat(leftMappings).concat(headMappings);\r\n      } else {\r\n        mappings = [].concat(headMappings).concat(leftMappings);\r\n      }\r\n      mappings.forEach((ff: any) => {\r\n        if (!helpData) {\r\n          this.viewModel.bindingData.clearValue(pathArr.concat(ff.split('.')), true, true);\r\n        } else {\r\n          this.viewModel.bindingData.setValue(pathArr.concat(ff.split('.')), val, true, true);\r\n        }\r\n      });\r\n    });\r\n\r\n    // éæ°æå¼åæ´æ£æµ\r\n    appContext.changeDetectionController.reattach();\r\n  }\r\n\r\n  private getValue(f: string, data: any) {\r\n    let val = '';\r\n    if (f.indexOf('.') === -1) {\r\n      val = data[f];\r\n    } else {\r\n      val = f.split('.').reduce((a, b) => {\r\n        return a[b];\r\n      }, data);\r\n    }\r\n\r\n    return val;\r\n  }\r\n\r\n  private getBindingPathArray(): any[] {\r\n    const path = this.viewModel.bindingPath;\r\n    if (path) {\r\n      return path.split('/').filter((n) => n !== '');\r\n    }\r\n    return [];\r\n  }\r\n\r\n  private isNumberValue(field, data) {\r\n    const currentVal = this.getValue(field, data);\r\n    return isNumber(currentVal);\r\n  }\r\n\r\n  //#endregion\r\n  /**\r\n   *\r\n   * @param mapFields  æ ¼å¼å½¢å¦ï¼{id: \"assoField.assoField\", code: \"assoField.assoField_Code\", name: \"assoField.assoField_Name\"} æè {id:'vid',code:'code',name:'name'}\r\n   */\r\n  private getMapFieldsPrimaryKey(mapFields: any, bindingPaths: string[]): Array<{ primaryKey: string, primaryField: string }> {\r\n    if (!mapFields || Object.keys(mapFields).length < 1) {\r\n      return null;\r\n    }\r\n    const results = [];\r\n    // let primaryField = null;\r\n    try {\r\n      const entityTypeInfo: DataTypeInfo = this.viewModel.frameContext.repository.entityTypeInfo;\r\n      Object.keys(mapFields).forEach((key: string) => {\r\n        const mapField = mapFields[key];\r\n        if (mapField && typeof mapField === 'string') {\r\n          const mappings = mapField.split(',').filter((p) => p);\r\n          mappings.forEach((item: string) => {\r\n            let paths = item.split('.');\r\n            if (bindingPaths && bindingPaths.length > 0) {\r\n              paths = bindingPaths.concat(paths);\r\n            }\r\n            const propInfo: DataPropInfo = entityTypeInfo.getPropInfoByPath(paths);\r\n            if (propInfo && propInfo.metadataInfo && propInfo.metadataInfo.primary === true) {\r\n              results.push({\r\n                primaryKey: key,\r\n                primaryField: item\r\n              });\r\n            }\r\n          });\r\n        }\r\n      });\r\n    } catch (e) {\r\n      console.error(e);\r\n    }\r\n    return results;\r\n  }\r\n  private setValue(target: object, paths: string[], value: any) {\r\n    if (target) {\r\n      if (paths.length <= 1) {\r\n        target[paths[0]] = value;\r\n      } else {\r\n        paths.slice(0, -1).reduce((prev, path) => {\r\n          if (!(prev.hasOwnProperty(path) || prev['__proto__'].hasOwnProperty(path))) {\r\n            prev[path] = {};\r\n          }\r\n          return prev[path];\r\n        }, target)[paths[paths.length - 1]] = value;\r\n      }\r\n    }\r\n  }\r\n  private sortMapFieldKeys(keys: string[], primaryKeys: string[]): string[] {\r\n    if (!primaryKeys || primaryKeys.length < 1 || !keys || keys.length < 1) {\r\n      return keys;\r\n    }\r\n    // è¿æ»¤åºéä¸»é®æ å°å­æ®µ\r\n    keys = keys.filter((p) => !primaryKeys.includes(p));\r\n    return [].concat(primaryKeys).concat(keys);\r\n  }\r\n}\r\n","import { AppContext } from '@farris/devkit';\r\nimport { Subject } from 'rxjs';\r\nimport { OnDestroy } from '@angular/core';\r\n\r\nabstract class AbstractEndEdit implements OnDestroy {\r\n  private messagePipe: Subject<any>;\r\n  constructor(protected appContext: AppContext) {\r\n    this.messagePipe = this.appContext && this.appContext.messagePipe;\r\n    if (this.messagePipe) {\r\n      this.messagePipe.subscribe((message: any) => {\r\n        if (message && message.type === 'endEdit') {\r\n          this.endEdit(message);\r\n        }\r\n      });\r\n    }\r\n  }\r\n  ngOnDestroy(): void {\r\n    // if (this.messagePipe) {\r\n    //   this.messagePipe.unsubscribe();\r\n    // }\r\n  }\r\n  public abstract endEdit(message: any);\r\n}\r\nexport { AbstractEndEdit };\r\n","import { Directive, ElementRef, OnInit, OnChanges, SimpleChanges } from '@angular/core';\r\nimport { AppContext } from '@farris/devkit';\r\nimport { AbstractEndEdit } from './abstract_end_edit';\r\n\r\n@Directive({\r\n  selector: '[input-end-edit]'\r\n})\r\nclass InputEndEditDirective extends AbstractEndEdit implements OnInit {\r\n  private nativeElement: any;\r\n  constructor(protected appContext: AppContext, private elementRef: ElementRef) {\r\n    super(appContext);\r\n  }\r\n  ngOnInit(): void {\r\n    if (this.elementRef) {\r\n      this.nativeElement = this.elementRef.nativeElement;\r\n    }\r\n  }\r\n  /**\r\n   * ç»æç¼è¾\r\n   * @param message æ¶æ¯\r\n   */\r\n  public endEdit(message: any) {\r\n    if (this.nativeElement) {\r\n      const parent: any = this.nativeElement.parentNode || this.nativeElement.parentElement;\r\n      const inputs: Array<any> = parent && Array.from(parent.getElementsByTagName('input')) || [];\r\n      if (inputs && inputs.length > 0) {\r\n        inputs.forEach(input => {\r\n          if (input && typeof (input.blur) === 'function') {\r\n            input.blur();\r\n          }\r\n        });\r\n      }\r\n    }\r\n  }\r\n}\r\nexport { InputEndEditDirective };\r\n","import { Directive } from '@angular/core';\r\nimport { AppContext } from '@farris/devkit';\r\nimport { DatagridComponent } from '@farris/ui-datagrid';\r\nimport { AbstractEndEdit } from './abstract_end_edit';\r\n\r\n@Directive({\r\n  selector: '[farris-grid-end-edit]'\r\n})\r\nclass FarrisDataGridEndEditDirective extends AbstractEndEdit {\r\n  constructor(protected appContext: AppContext, private datagrid: DatagridComponent) {\r\n    super(appContext);\r\n  }\r\n  /**\r\n   * ç»æç¼è¾\r\n   * @param message message\r\n   */\r\n  public endEdit(message: any) {\r\n    if (this.datagrid && typeof this.datagrid.endCellEdit === 'function') {\r\n      this.datagrid.endCellEdit();\r\n    }\r\n  }\r\n}\r\nexport { FarrisDataGridEndEditDirective };\r\n","import { AppContext } from '@farris/devkit';\r\nimport { HtmlEditorComponent } from '@farris/ui-html-editor';\r\nimport { AbstractEndEdit } from './abstract_end_edit';\r\nimport { Directive } from '@angular/core';\r\n@Directive({\r\n  selector: '[html-editor-end-edit]'\r\n})\r\nclass HtmlEditorEndEditDirective extends AbstractEndEdit {\r\n  constructor(protected appContext: AppContext, private editor: HtmlEditorComponent) {\r\n    super(appContext);\r\n  }\r\n  public endEdit(message: any) {\r\n    if (this.editor && typeof this.editor.endEdit === 'function') {\r\n      this.editor.endEdit();\r\n    }\r\n  }\r\n\r\n}\r\nexport { HtmlEditorEndEditDirective };\r\n","import { Directive } from '@angular/core';\r\nimport { AppContext } from '@farris/devkit';\r\nimport { GridComponent } from '@progress/kendo-angular-grid';\r\nimport { AbstractEndEdit } from './abstract_end_edit';\r\n\r\n@Directive({\r\n  selector: '[kendo-grid-end-edit]'\r\n})\r\nclass KendoGridEndEditDirective extends AbstractEndEdit {\r\n  constructor(protected appContext: AppContext, private grid: GridComponent) {\r\n    super(appContext);\r\n  }\r\n  public endEdit(message: any) {\r\n    if (this.grid && typeof this.grid.closeCell === 'function') {\r\n      this.grid.closeCell();\r\n    }\r\n  }\r\n}\r\nexport { KendoGridEndEditDirective };\r\n","import { Directive, Input } from '@angular/core';\r\nimport { Observable } from 'rxjs';\r\nimport { ViewModel } from '@farris/devkit';\r\nimport { DatagridComponent } from '@farris/ui-datagrid';\r\n\r\n\r\n@Directive({\r\n  selector: \"[farris-remote-summary-command]\"\r\n})\r\nexport class FarrisDataGridRemoteSummaryDirective {\r\n  /**\r\n   * æå¡å¨ç«¯åè®¡å½ä»¤åç§°\r\n   */\r\n  @Input('farris-remote-summary-command') remoteSummaryCommand: string;\r\n\r\n  constructor(public viewModel: ViewModel, public grid: DatagridComponent) {\r\n    const appContext = this.viewModel.frameContext.getFormAppContext();\r\n    if (appContext && appContext.hasOwnProperty('messagePipe')) {\r\n      appContext.messagePipe.subscribe((message: any) => {\r\n        const messageType = message && message.type || null;\r\n        // æ¥è¯¢äºä»¶\r\n        if (messageType === 'query') {\r\n          if (this.remoteSummaryCommand && this.grid.footerDataFrom === 'server') {\r\n            const paths = this.remoteSummaryCommand.split('.');\r\n            let func = null;\r\n            paths.forEach(path => {\r\n              func = func && func[path] || this[path];\r\n            });\r\n            if (typeof func === 'function') {\r\n              func().subscribe(result => {\r\n                this.grid.footerData = result;\r\n              });\r\n            }\r\n          }\r\n        }\r\n      });\r\n    }\r\n  }\r\n  /**\r\n   * æ§è¡å½ä»¤\r\n   * @param commandName å½ä»¤åç§°\r\n   * @param frameId frameId\r\n   */\r\n  private execute(commandName: string, frameId?: string): Observable<any> {\r\n    if (!commandName || commandName === '' || commandName === 'undefined') {\r\n      return;\r\n    }\r\n    let viewModel = this.viewModel;\r\n    if (frameId) {\r\n      const targetContext = viewModel.frameContext.appContext.frameContextManager.getFrameContextById(frameId);\r\n      viewModel = targetContext.viewModel;\r\n    }\r\n    return viewModel[commandName]();\r\n  }\r\n\r\n}\r\n","import { Directive, Input, Renderer2, Injector, OnInit, ElementRef } from '@angular/core';\r\nimport { BehaviorSubject } from 'rxjs';\r\n\r\n@Directive({\r\n    selector: '[farris-set-focus]'\r\n})\r\nexport class FarrisSetFocusDirective implements OnInit {\r\n\r\n    @Input() set focusState(value: boolean) {\r\n        this._state.next(value);\r\n    }\r\n    private selfEl: HTMLElement\r\n    private _state: BehaviorSubject<any> = new BehaviorSubject({});\r\n\r\n    constructor(\r\n        private rd: Renderer2,\r\n        private injector: Injector,\r\n        private el: ElementRef\r\n    ) {\r\n\r\n    }\r\n\r\n    ngOnInit(): void {\r\n        this.selfEl = this.el.nativeElement;\r\n        this._state.subscribe(data => {\r\n            if (data === false && this.selfEl) {\r\n                if (this.selfEl.nodeName.toLowerCase() === 'farris-html-editor') {\r\n                    this.setHtmlEditorFocus();\r\n                } else {\r\n                    this.setFocus();\r\n                }\r\n            }\r\n        })\r\n    }\r\n\r\n    /**\r\n     * è®¾ç½®ä¸è¬è¾å¥æ¡çé»è®¤ç¦ç¹\r\n     */\r\n    setFocus() {\r\n        const input = this.selfEl.querySelectorAll('input');\r\n        if (input.length) {\r\n            input[0].focus()\r\n        } else {\r\n            this.selfEl.focus();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * è®¾ç½®htmlç¼è¾å¨çé»è®¤ç¦ç¹  æ»æ¯å¨ææ¬æå\r\n     */\r\n    setHtmlEditorFocus() {\r\n        // å¯ææ¬ç¼è¾å¨ä¸æ¯input\r\n        const ediotrArea = this.selfEl.querySelector('div[contenteditable=\"true\"]');\r\n        //åå»ºrange  å­å¨æµè§å¨å¼å®¹æ§é®é¢\r\n        const range = window.getSelection();\r\n        //range éæ©objä¸ææå­åå®¹\r\n        range.selectAllChildren(ediotrArea);\r\n        //åæ ç§»è³æå\r\n        range.collapseToEnd();\r\n    }\r\n}","import { Directive, OnInit, OnChanges, SimpleChanges, Input, Injector, Optional, HostListener } from '@angular/core';\r\nimport { BindingData, BindingList, FrameContext, Change, ChangeType } from '@farris/devkit';\r\nimport { UploadFile, FFilePreviewComponent, UploadAndPreviewComponent } from '@farris/extend-file-upload';\r\n\r\n/**\r\n * æ è¡¨æ ¼ç»å®æä»¤\r\n */\r\n@Directive({\r\n  selector: '[farrisFilePreviewBinding]'\r\n})\r\nclass FarrisFilePreviewBindingDirective implements OnInit, OnChanges {\r\n  private __DATA__: any;\r\n  /**\r\n   * æªå¯ç¨æåºæ¶é»è®¤æä¸ä¼ æ¶é´å­æ®µæåº\r\n   */\r\n  private readonly DEFAULT_SORT_FIELD = 'createTime';\r\n  /**\r\n   * å¯ç¨æåºæ¶ä½¿ç¨fileSortOrderåæåºå­æ®µï¼ä¸é¶ä»£ç çææ½æåºç»ä¸\r\n   */\r\n  private readonly SORT_FIELD_ON_SORTING = 'fileSortOrder';\r\n  @Input('extendFileInfo')\r\n  public extendFileInfo: { key: string, path: any }[];\r\n  /**\r\n   * æåºæ¹å¼\r\n   */\r\n  @Input('farrisOrderType')\r\n  public farrisOrderType: string;\r\n  /**\r\n   * æä»¶idå­æ®µè·¯å¾\r\n   */\r\n  @Input('farrisFileIdKey')\r\n  public fileIdKey: string;\r\n  /**\r\n   * æåºå­æ®µï¼ææ½æåºç¸å³\r\n   */\r\n  @Input('farrisFileSortOrderKey')\r\n  public fileSortOrderKey: string;\r\n  /**\r\n   * æä»¶nameå­æ®µè·¯å¾\r\n   */\r\n  @Input('farrisFileNameKey')\r\n  public fileNameKey: string;\r\n\r\n  /**\r\n   * ç»å®æ°æ®\r\n   */\r\n  private get bindingData(): BindingData {\r\n    return this.frameContext.bindingData;\r\n  }\r\n\r\n  /**\r\n   * ç»å®æ°æ®åè¡¨\r\n   */\r\n  private get bindingList(): BindingList {\r\n    return this.bindingData.getList();\r\n  }\r\n  /**\r\n   * æåºå­æ®µ\r\n   * @description\r\n   * ç»ä»¶æåºå­æ®µåªæä¸ä¸ªï¼ä¸æ¯æå¤ä¸ªã\r\n   * å¦æå¯ç¨äºææ½æåºï¼åä¸ºfileSortOrderï¼å¦åä½¿ç¨é»è®¤çcreateTime\r\n   */\r\n  private get orderField() {\r\n    return this.uploadAndPreviewComponent && this.uploadAndPreviewComponent.enableOrder && this.uploadAndPreviewComponent.orderField || this.fileSortOrderKey && this.SORT_FIELD_ON_SORTING || this.DEFAULT_SORT_FIELD;\r\n  }\r\n  /**\r\n   * é»è®¤éåº\r\n   */\r\n  private get orderType() {\r\n    return this.farrisOrderType ? this.farrisOrderType : this.orderField === this.DEFAULT_SORT_FIELD ? 'desc' : 'asc';\r\n  }\r\n  /**\r\n   * æé å½æ°\r\n   * @param previewComponent - éä»¶ç»ä»¶\r\n   * @param frameContext - æ§å¶å¨ä¸ä¸æ\r\n   * @param uploadAndPreviewComponent - éä»¶ä¸ä¼ é¢è§ç»ä»¶\r\n   * @param injector - injector\r\n   * @TODO: è¯¥æä»¤è¢«ç¨äºä¸åçç»ä»¶ä¸­ï¼å æ­¤uploadAndPreviewComponentå¯è½ä¸ºnull\r\n   */\r\n  constructor(\r\n    @Optional() private previewComponent: FFilePreviewComponent,\r\n    private frameContext: FrameContext,\r\n    @Optional() private uploadAndPreviewComponent: UploadAndPreviewComponent,\r\n    @Optional() private injector: Injector\r\n  ) {\r\n  }\r\n\r\n  /**\r\n   * æä»¤åå§å\r\n   */\r\n  ngOnInit() {\r\n    this.bindData();\r\n    if (this.uploadAndPreviewComponent) {\r\n      if (this.uploadAndPreviewComponent.enableOrder) {\r\n        this.uploadAndPreviewComponent.orderField = this.SORT_FIELD_ON_SORTING;\r\n      }\r\n      // ç¦ç¨ç»ä»¶åç½®æåºï¼æ§å¶å¨è´è´£æåºå¹¶å°æåºåçæ°æ®ç»å®å°éä»¶ä¸ä¼ é¢è§ç»ä»¶\r\n      this.uploadAndPreviewComponent.enableSorting = false;\r\n      this.uploadAndPreviewComponent.fSelectedEvent.subscribe((event: any) => {\r\n        const primaryKey = this.bindingList.primaryKey;\r\n        const id = event && event.originalData && event.originalData[primaryKey];\r\n        if (id && id !== this.bindingList.currentId) {\r\n          this.bindingList.setCurrentId(id, true);\r\n        }\r\n      });\r\n    }\r\n    this.bindingData.changes.subscribe((change: Change) => {\r\n      // å æåºéè¦ï¼å¼ååæ¶ä¹åºè¿è¡æ°æ®ç»å®\r\n      if (change.type === ChangeType.Load || change.type === ChangeType.Append || change.type === ChangeType.Remove || change.type === ChangeType.ValueChanged || change.type === ChangeType.SelectionChanged) {\r\n        this.bindData(change);\r\n        this.updateCurrentRow(change);\r\n        this.updateChecks(change);\r\n      }\r\n    });\r\n    this.setChecks([]);\r\n  }\r\n\r\n  /**\r\n   * æä»¤è¾å¥åæ´\r\n   * @param changes -åæ´\r\n   */\r\n  ngOnChanges(changes: SimpleChanges) {\r\n  }\r\n  private shouldComponentUpdate(data: any) {\r\n    return !(JSON.stringify(this.__DATA__) === JSON.stringify(data));\r\n    // return !(this.__DATA__ && isEqual(this.__DATA__, data));\r\n  }\r\n  /**\r\n   * ç»å®æ°æ®\r\n   * @param change -åæ´\r\n   */\r\n  private bindData(change?: Change) {\r\n    const bindingPath = this.frameContext.viewModel.bindingPath.split('/').filter(p => p).join('/');\r\n    const eventPath = change && change.path && change.path.filter(p => p).join('/');\r\n    // è¡åæ¢ãå é¤ãå è½½ãæ°å¢æ°æ®ãé¡µç åæ¢ åºæ¯\r\n    if (change && [ChangeType.SelectionChanged, ChangeType.Remove, ChangeType.Load, ChangeType.Append].includes(change.type)) {\r\n      // éä¸çº§å®ä½ä¸éæ°ç»å®æ°æ®\r\n      if (!bindingPath.startsWith(eventPath)) {\r\n        return;\r\n      }\r\n      // å½åéä»¶ç»ä»¶åæ¢å½åè¡ä¸éè¦éæ°æ¸²æ\r\n      if (change.type === ChangeType.SelectionChanged && bindingPath === eventPath) {\r\n        return;\r\n      }\r\n    }\r\n    // éå½åå®ä½åçäºå¼åå\r\n    if (change && change.type === ChangeType.ValueChanged && !eventPath.startsWith(bindingPath)) {\r\n      return;\r\n    }\r\n    const fileInfos = this.getFileInfos();\r\n    if (!this.shouldComponentUpdate(fileInfos)) {\r\n      return;\r\n    }\r\n    if (this.componentRef) {\r\n      this.__DATA__ = fileInfos;\r\n      this.componentRef.fileInfos = fileInfos;\r\n      if (this.uploadAndPreviewComponent && fileInfos && fileInfos.length > 0) {\r\n        const extendInfos = fileInfos.map((item: any) => item.originalData);\r\n        this.uploadAndPreviewComponent.extendInfos = extendInfos;\r\n      }\r\n      this.changeCurrentRow(fileInfos, change);\r\n    }\r\n  }\r\n  private updateChecks(change?: Change) {\r\n    if (!this.uploadAndPreviewComponent) {\r\n      return;\r\n    }\r\n    const bindingPath = this.frameContext.viewModel.bindingPath.split('/').filter(p => p).join('/');\r\n    const eventPath = change && change.path && change.path.filter(p => p).join('/');\r\n    // å é¤èªèº«è¡¨æ¶æ´æ°å¾éè®°å½\r\n    if (change && change.type === ChangeType.Remove && eventPath === bindingPath) {\r\n      const values = change.value || [];\r\n      const ids: any[] = this.frameContext.uiState['ids'] || [];\r\n      if (values.length > 0 && ids.length > 0) {\r\n        values.forEach((id: string) => {\r\n          const index = ids.indexOf(id);\r\n          if (index !== -1) {\r\n            ids.splice(index, 1);\r\n          }\r\n        });\r\n      }\r\n    } else if ((change.type === ChangeType.Remove || change.type === ChangeType.SelectionChanged) && bindingPath.startsWith(eventPath) && bindingPath !== eventPath) {\r\n      //ä¸çº§ï¼ä¸ä¸çº§ï¼è¡¨å é¤ãä¸çº§ï¼ä¸ä¸çº§ï¼è¡¨åæ¢å½åè¡æ¶æ´æ°å¾éè®°å½\r\n      this.setChecks([]);\r\n      // æ¸ç©ºç»ä»¶å¾é\r\n      this.clearComponentChecks();\r\n    } else if (change && change.type === ChangeType.Load && (bindingPath === eventPath || bindingPath.startsWith(eventPath) && bindingPath !== eventPath)) {\r\n      // å½åéä»¶ç»ä»¶æ°æ®éæ°å è½½ or ä¸çº§æä¸ä¸çº§éæ°å è½½\r\n      this.setChecks([]);\r\n      // æ¸ç©ºç»ä»¶å¾é\r\n      this.clearComponentChecks();\r\n    }\r\n  }\r\n  /**\r\n   * ä¸»å¨æ´æ°å½åè¡\r\n   * @param data - æ°æ®\r\n   * @param change - åæ´\r\n   */\r\n  private changeCurrentRow(data: any, change?: Change) {\r\n    if (!this.uploadAndPreviewComponent) {\r\n      return;\r\n    }\r\n    const changePath = change && change.path.join('/');\r\n    const paths = this.frameContext.viewModel.bindingPath.split('/').filter(p => p);\r\n    const path = paths.join('/');\r\n    const isParentSelectChange = path.startsWith(changePath) && change.type === ChangeType.SelectionChanged && path !== changePath;\r\n    const isSelfRowDelete = change && change.type === ChangeType.Remove && path === changePath;\r\n    if (data && data.length > 0 && change && (change.type === ChangeType.Load || isParentSelectChange || isSelfRowDelete)) {\r\n      const primaryKey = this.bindingList.primaryKey;\r\n      const id = data[0]['originalData'] && data[0]['originalData'][primaryKey];\r\n      if (this.bindingList.currentId !== id) {\r\n        setTimeout(() => {\r\n          this.bindingList.setCurrentId(id, true, true);\r\n        }, 100);\r\n      }\r\n    }\r\n  }\r\n  /**\r\n   * ä¸ºæ§ä»¶è®¾ç½®å½åè¡\r\n   * @param change - æ§å¶å¨åæ´\r\n   * @returns\r\n   */\r\n  private updateCurrentRow(change?: Change) {\r\n    if (!this.bindingList || !this.bindingList.currentId || !this.uploadAndPreviewComponent) {\r\n      return;\r\n    }\r\n    if (change && change.type !== ChangeType.SelectionChanged && change.type !== ChangeType.Load && change.type !== ChangeType.Remove) {\r\n      return;\r\n    }\r\n    const currentId = this.uploadAndPreviewComponent.previewCurrent;\r\n    // ç»ä»¶idåæ°æ®idè¿è¡è½¬æ¢\r\n    const id = this.getValueByPath(this.bindingList.currentItem, this.fileIdKey);\r\n    if (id === currentId) {\r\n      return;\r\n    }\r\n    this.selectComponentRow(id);\r\n  }\r\n  /**\r\n   * è·åéä»¶ä¿¡æ¯åè¡¨\r\n   */\r\n  private getFileInfos(): UploadFile[] {\r\n    const listData = this.bindingList.toJSON();\r\n    const fileInfos: UploadFile[] = [];\r\n    listData.forEach((itemData: any) => {\r\n      const fileInfo = this.convertToFileInfo(itemData);\r\n      fileInfos.push(fileInfo);\r\n    });\r\n    // æåº\r\n    if (this.orderField) {\r\n      this.sort(fileInfos, this.orderField, this.orderType);\r\n    }\r\n    return fileInfos;\r\n  }\r\n  /**\r\n   * è¡æ°æ®è½¬æ¢ä¸ºæä»¶ä¿¡æ¯\r\n   * @param itemData - è¡æ°æ®\r\n   * @returns\r\n   */\r\n  private convertToFileInfo(itemData: any) {\r\n    // const idKey = this.bindingList.primaryKey;\r\n    // const id = this.getValueByPath(itemData, idKey);\r\n    const fileId = this.getValueByPath(itemData, this.fileIdKey);\r\n    const fileName = this.getValueByPath(itemData, this.fileNameKey);\r\n    const fileSize = this.getValueByPath(itemData, this.fileSizeKey);\r\n    const fileCreateTime = this.getValueByPath(itemData, this.fileCreateTimeKey);\r\n\r\n    const fileInfo: any = {\r\n      id: fileId,\r\n      name: fileName,\r\n      size: fileSize,\r\n      createTime: fileCreateTime,\r\n      originalData: itemData,\r\n      extend: {\r\n        metadataId: fileId\r\n      }\r\n    };\r\n    if (this.extendFileInfo && Array.isArray(this.extendFileInfo) && this.extendFileInfo.length > 0) {\r\n      this.extendFileInfo.forEach((item) => {\r\n        fileInfo[item.key] = this.getValueByPath(itemData, item.path);\r\n      });\r\n    }\r\n    if (this.fileSortOrderKey) {\r\n      const fileSortOrder = this.getValueByPath(itemData, this.fileSortOrderKey);\r\n      fileInfo[this.SORT_FIELD_ON_SORTING] = fileSortOrder;\r\n    }\r\n    return fileInfo;\r\n  }\r\n  /**\r\n   * è®¾ç½®æ§ä»¶çå½åè¡\r\n   * @param id ä¸»é®\r\n   */\r\n  private selectComponentRow(id) {\r\n    if (this.uploadAndPreviewComponent) {\r\n      this.uploadAndPreviewComponent.previewCurrent = id;\r\n    }\r\n  }\r\n  /**\r\n   * æ ¹æ®å­æ®µè·¯å¾è·åå¼\r\n   * @param data - æ°æ®æº\r\n   * @param path - å­æ®µè·¯å¾\r\n   */\r\n  private getValueByPath(data: any, path: string): any {\r\n    const keys = path.split('.');\r\n    let currentValue = data;\r\n    keys.forEach((key: string) => {\r\n      currentValue = currentValue && currentValue[key];\r\n    });\r\n    return currentValue;\r\n  }\r\n  private getUdtPaths(): string[] {\r\n    const paths = this.fileIdKey.split('.');\r\n    paths.pop();\r\n    return paths;\r\n  }\r\n  private get fileSizeKey() {\r\n    const basePaths = this.getUdtPaths();\r\n    return basePaths.concat(['fileSize']).join('.');\r\n  }\r\n  private get fileCreateTimeKey() {\r\n    const basePaths = this.getUdtPaths();\r\n    return basePaths.concat(['fileCreateTime']).join('.');\r\n  }\r\n  private get componentRef() {\r\n    return this.previewComponent || this.uploadAndPreviewComponent || null;\r\n  }\r\n  private setChecks(ids: any) {\r\n    this.frameContext.uiState.setPropertyValue('ids', ids);\r\n  }\r\n  /**\r\n   * æ¸ç©ºç»ä»¶å¾é\r\n   */\r\n  private clearComponentChecks() {\r\n    if (this.uploadAndPreviewComponent) {\r\n      this.uploadAndPreviewComponent.previewUpdateRefresh();\r\n    }\r\n  }\r\n  public sort(data: any[], fields: string | Array<string>, directions: string | Array<string>) {\r\n    if (!fields || fields.length < 1 || !directions || directions.length < 1) {\r\n      throw new Error('sortBy:argument error');\r\n    }\r\n    // é»è®¤ååº\r\n    const arrFields: Array<string> = typeof fields === 'string' ? fields.split(',') : fields || [];\r\n    const arrDirections: Array<string> = typeof directions === 'string' ? directions.split(',') : directions || [];\r\n    // æåºå­æ®µåæåºæ¹å¼åºä¸è´\r\n    if (arrFields.length !== arrDirections.length || arrFields.length < 1) {\r\n      throw new Error('sortBy:fields and directions not match');\r\n    }\r\n    // nage,age,total\r\n    const comparator = (props: Array<string>, orders: Array<string>) => (item1: any, item2: any) => {\r\n      return props.reduce((result, prop) => {\r\n        if (result === 0) {\r\n          const order = ['asc'].includes(orders[props.indexOf(prop)]) ? 1 : -1;\r\n          const item1Value = this.getValue(item1, prop);\r\n          const item2Value = this.getValue(item2, prop);\r\n          if (item1Value === null || item1Value === undefined) {\r\n            return 1;\r\n          }\r\n          if (item2Value === null || item2Value === undefined) {\r\n            return -1;\r\n          }\r\n\r\n          if (typeof item1Value !== typeof item2Value) {\r\n            const localeCompareResult = String(item1Value).localeCompare(String(item2Value));\r\n            result = localeCompareResult * order;\r\n          } else if (typeof item1Value === 'string' && typeof item2Value === 'string') {\r\n            const localeCompareResult = item1Value.localeCompare(item2Value);\r\n            result = localeCompareResult * order;\r\n          } else {\r\n            if (item1Value > item2Value) {\r\n              result = order * 1;\r\n            }\r\n            if (item1Value < item2Value) {\r\n              result = order * -1;\r\n            }\r\n          }\r\n        }\r\n        return result;\r\n      }, 0);\r\n    };\r\n    data.sort(comparator(arrFields, arrDirections));\r\n  }\r\n  private getValue(target: any, propName: string) {\r\n    if (target instanceof BindingList) {\r\n      target = target.currentItem;\r\n    } else if (target instanceof BindingData) {\r\n      target = target.list.currentItem;\r\n    }\r\n    let result = null;\r\n    if (propName.indexOf('.') === -1) {\r\n      result = target[propName];\r\n    } else {\r\n      const props = propName.split('.');\r\n      for (const prop of props) {\r\n        target = result = this.getValue(target, prop);\r\n      }\r\n    }\r\n    return result;\r\n  }\r\n  /**\r\n   * å¾éååäºä»¶\r\n   * @param event\r\n   */\r\n  @HostListener('fPreviewMultiSelectedEvent', ['$event'])\r\n  private checkedChanged(event: any[]) {\r\n    const primaryKey = this.bindingList.primaryKey;\r\n    const ids = event && event.map((item) => item && item.originalData && item.originalData[primaryKey] || '').filter(p => p) || [];\r\n    this.setChecks(ids);\r\n  }\r\n  /**\r\n   * è¡åæ¢äºä»¶\r\n   * @param event\r\n   */\r\n  @HostListener('fSelectedEvent', ['$event'])\r\n  private selectChanged(event: any) {\r\n\r\n  }\r\n}\r\n\r\nexport { FarrisFilePreviewBindingDirective };\r\n","import { Directive, Injector, Input, OnInit, HostListener } from '@angular/core';\r\nimport { DiscussionEditorComponent } from '@farris/discussion-group';\r\nimport { ViewModel, UIStateObservableParam } from '@farris/devkit';\r\nimport { of, Observable, EMPTY } from 'rxjs';\r\nimport { tap, catchError } from 'rxjs/operators';\r\nconst KEY_UISTATE_REPLY_MESSAGE = 'DISCUSSION_REPLY_MESSAGE_INFO';\r\nconst KEY_MESSAGE_ON_COMMENT_ADD = 'onCommentAdd';\r\n\r\n@Directive({\r\n  selector: '[farris-discussion-editor-binding]'\r\n})\r\nexport class FarrisDiscussionEditorBindingDirective implements OnInit {\r\n\r\n  /**\r\n   * è·åç¨æ·å½ä»¤\r\n   */\r\n  @Input(\"userQueryCommand\") userQueryCommand: string;\r\n  /**\r\n   * æ·»å è¯è®ºå½ä»¤\r\n   */\r\n  @Input(\"addCommentCommand\") addCommentCommand: string;\r\n  /**\r\n   * æ¥è¯¢ææé¨é¨å½ä»¤\r\n   */\r\n  @Input(\"queryAllOrgsCommand\") queryAllOrgsCommand: string;\r\n  /**\r\n   * æ¥è¯¢å¸¸ç¨@ç¨æ·\r\n   */\r\n  @Input(\"queryFrequentAtUsersCommand\") queryFrequentAtUsersCommand: string;\r\n\r\n  constructor(public injector: Injector, public discussionEditorComponent: DiscussionEditorComponent, public viewModel: ViewModel) {\r\n  }\r\n\r\n  ngOnInit(): void {\r\n    this.discussionEditorComponent.replyUser = this.viewModel.frameContext.root.viewModel.uiState[KEY_UISTATE_REPLY_MESSAGE] || {};\r\n    this.viewModel.frameContext.root.viewModel.uiState.changes.subscribe((change: UIStateObservableParam) => {\r\n      if (change.field === KEY_UISTATE_REPLY_MESSAGE) {\r\n        this.discussionEditorComponent.replyUser = this.viewModel.frameContext.root.viewModel.uiState[KEY_UISTATE_REPLY_MESSAGE] || {};\r\n      }\r\n    });\r\n    if (this.queryFrequentAtUsersCommand) {\r\n      this.queryFrequentAtUsers();\r\n    } else {\r\n      this.queryAtUsers();\r\n    }\r\n\r\n    this.queryAllOrgs();\r\n  }\r\n  /**\r\n   * æ¥è¯¢ææé¨é¨æ°æ®\r\n   */\r\n  private queryAllOrgs() {\r\n    this.execute(this.queryAllOrgsCommand).subscribe(result => {\r\n      if (!result) {\r\n        return;\r\n      }\r\n      this.discussionEditorComponent.sectionData = result;\r\n    });\r\n  }\r\n  /**\r\n   * è·å@ç¨æ·\r\n   */\r\n  private queryAtUsers() {\r\n    this.execute(this.userQueryCommand).subscribe(result => {\r\n      if (!result) {\r\n        return;\r\n      }\r\n      const { users = [] } = result;\r\n      this.discussionEditorComponent.personnels = users;\r\n    });\r\n  }\r\n  /**\r\n   * è·åå¸¸ç¨@ç¨æ·\r\n   */\r\n  private queryFrequentAtUsers() {\r\n    this.execute(this.queryFrequentAtUsersCommand).subscribe(result => {\r\n      if (!result) {\r\n        return;\r\n      }\r\n      this.discussionEditorComponent.personnels = result && result.users || [];\r\n    });\r\n  }\r\n  /**\r\n   * æäº¤æåæ¶è¯è®º\r\n   * @param event event\r\n   */\r\n  @HostListener('valueChange', ['$event'])\r\n  public pageChangedHandler(event: any) {\r\n    const { msgInfo = 0, text = '', visibility = 'ALL', parentId = null } = event || {};\r\n    if (msgInfo === 1) {\r\n      this.execute(this.addCommentCommand, { text, parentId, visibility }).pipe(\r\n        tap(() => {\r\n          this.viewModel.frameContext.appContext.messagePipe.next(KEY_MESSAGE_ON_COMMENT_ADD);\r\n        }),\r\n        catchError(e => EMPTY)\r\n      ).subscribe();\r\n    } else {\r\n      // åæ¶çæ¶ååæ¶ä¼å°åå¤ç¨æ·æ¸ç©º\r\n      this.viewModel.frameContext.root.viewModel.uiState[KEY_UISTATE_REPLY_MESSAGE] = {};\r\n      this.discussionEditorComponent.replyUser = {};\r\n    }\r\n  }\r\n  /**\r\n   * æ§è¡å½ä»¤\r\n   * @param commandName å½ä»¤åç§°\r\n   */\r\n  private execute(commandName: string, params?: any): Observable<any> {\r\n    if (!commandName || commandName === '' || commandName === 'undefined') {\r\n      return of(null);\r\n    }\r\n    if (typeof params === 'undefined') {\r\n      params = {};\r\n    }\r\n    const paths = commandName.split('.');\r\n    let func = null;\r\n    paths.forEach(path => {\r\n      func = func && func[path] || this[path];\r\n    });\r\n    if (typeof func === 'function') {\r\n      return func(params);\r\n    }\r\n    return of(null);\r\n  }\r\n}\r\n","import { Observable, of, EMPTY } from 'rxjs';\r\nimport { Directive, Input, Injector, OnInit, HostListener } from '@angular/core';\r\nimport { DiscussionListComponent, DiscussionListDirective } from '@farris/discussion-group';\r\nimport { ViewModel, Change, ChangeType } from '@farris/devkit';\r\nimport { tap, catchError } from 'rxjs/operators';\r\nconst KEY_UISTATE_REPLY_MESSAGE = 'DISCUSSION_REPLY_MESSAGE_INFO';\r\nconst KEY_MESSAGE_ON_COMMENT_ADD = 'onCommentAdd';\r\n@Directive({\r\n  selector: '[farris-discussion-list-binding]'\r\n})\r\nexport class FarrisDiscussionListBindingDirective implements OnInit {\r\n  /**\r\n   * è·åç¨æ·å½ä»¤\r\n  */\r\n  @Input(\"commentsQueryCommand\") commentsQueryCommand: string;\r\n  constructor(public injector: Injector, public discussionListComponent: DiscussionListComponent, public viewModel: ViewModel, public discussionListDirective: DiscussionListDirective) {\r\n\r\n  }\r\n  ngOnInit(): void {\r\n    this.viewModel.frameContext.appContext.messagePipe.subscribe((message: any) => {\r\n      if (message === KEY_MESSAGE_ON_COMMENT_ADD) {\r\n        this.queryComments();\r\n      }\r\n    });\r\n    this.viewModel.bindingData.changes.subscribe((change: Change) => {\r\n      if (change.type === ChangeType.Load || change.type === ChangeType.SelectionChanged) {\r\n        this.queryComments();\r\n      }\r\n    });\r\n  }\r\n  /**\r\n   * æ¥è¯¢è¯è®º\r\n   */\r\n  private queryComments(pageIndex?: number, pageSize?: number) {\r\n    if (typeof pageIndex === 'undefined') {\r\n      pageIndex = (this.discussionListComponent.pageIndex - 1) || 0;\r\n    }\r\n    if (typeof pageSize === 'undefined') {\r\n      if (this.discussionListComponent.supportPaging) {\r\n        pageSize = this.discussionListComponent.pageSize;\r\n      } else {\r\n        // ä¸åé¡µï¼pageSizeååç«¯çº¦å®ä¼ æå¤§æ°\r\n        pageSize = 10000;\r\n      }\r\n    }\r\n    this.execute(this.commentsQueryCommand, { pageIndex, pageSize }).pipe(\r\n      catchError(e => EMPTY)\r\n    ).subscribe(result => {\r\n      if (!result) {\r\n        return;\r\n      }\r\n      const { comments = [], pageIndex = 0, pageSize = 10, totalCount = 0 } = result;\r\n      this.discussionListComponent.pageIndex = parseInt(pageIndex) + 1;\r\n      if (this.discussionListComponent.supportPaging) {\r\n        this.discussionListComponent.pageSize = pageSize;\r\n      }\r\n      this.discussionListComponent.total = totalCount;\r\n      this.discussionListDirective.discussionListData = result;\r\n    });\r\n  }\r\n  /**\r\n   * åå¤æ¶æ¯\r\n   * @param event event\r\n   */\r\n  @HostListener('replyMessage', ['$event'])\r\n  public replyMessagedHandler(event: any) {\r\n    this.viewModel.frameContext.root.viewModel.uiState.setPropertyValue(KEY_UISTATE_REPLY_MESSAGE, event);\r\n  }\r\n  /**\r\n   * åæ¢é¡µç \r\n   * @param event event\r\n   */\r\n  @HostListener('pageChanged', ['$event'])\r\n  public pageChangedHandler(event: any) {\r\n    const { pageIndex = 1, pageSize = 10 } = event.pageInfo || {};\r\n    this.queryComments(pageIndex - 1, pageSize);\r\n  }\r\n  /**\r\n   * æ§è¡å½ä»¤\r\n   * @param commandName å½ä»¤åç§°\r\n   */\r\n  private execute(commandName: string, params?: any): Observable<any> {\r\n    if (!commandName || commandName === '' || commandName === 'undefined') {\r\n      return of(null);\r\n    }\r\n    const paths = commandName.split('.');\r\n    let func = null;\r\n    paths.forEach(path => {\r\n      func = func && func[path] || this[path];\r\n    });\r\n    if (typeof func === 'function') {\r\n      return func(params);\r\n    }\r\n    return of(null);\r\n  }\r\n}\r\n","/*******************************************************************************************************************\r\n *                                     FarrisPrimengTreeTableBindingDirectiveæä»¤è¯´æ                               *\r\n * *****************************************************************************************************************\r\n * \r\n * 1. ä¾èµprimengçæ¬: primeng:^9.0.0,primeicons:^4.0.0\r\n * \r\n * 2. ç±äºå¯ç¼è¾æ è¡¨æ æ³è§¦åç¼è¾ååæ ¼çå³é­äºä»¶onEditCompleteï¼å æ­¤å¯¹priemengçnode_modules\\primeng\\fesm5\\primeng-treetable.jsèæ¬ä½åºä¿®æ¹ï¼ \r\n *    æºç ä¿®æ¹å¦ä¸ï¼+è¡¨ç¤ºæ°å¢å çèæ¬è¯­å¥:\r\n * \r\n *  TreeTable.prototype.updateEditingCell = function (cell, data, field) { //+ åæ°å¢å dataåfield\r\n *      this.editingCell = cell;\r\n *      this.editingCellData = data; //+\r\n *      this.editingCellField = field; //+\r\n *      this.bindDocumentEditListener();\r\n *  };\r\n * \r\n *  TreeTable.prototype.bindDocumentEditListener = function () {\r\n *       var _this = this;\r\n *       if (!this.documentEditListener) {\r\n *           this.documentEditListener = function (event) {\r\n *               if (_this.editingCell && !_this.editingCellClick && _this.isEditingCellValid()) {\r\n *                   domhandler_1.DomHandler.removeClass(_this.editingCell, 'ui-editing-cell');\r\n *                   _this.editingCell = null;\r\n *                   _this.onEditComplete.emit({ field: _this.editingCellField, data: _this.editingCellData });//+\r\n *                   _this.unbindDocumentEditListener();\r\n *               }\r\n *               _this.editingCellClick = false;\r\n *           };\r\n *           document.addEventListener('click', this.documentEditListener);\r\n *       }\r\n *   };\r\n * \r\n *  TreeTable.prototype.bindDocumentEditListener = function () {\r\n *       var _this = this;\r\n *       if (!this.documentEditListener) {\r\n *           this.documentEditListener = function (event) {\r\n *               if (_this.editingCell && !_this.editingCellClick && _this.isEditingCellValid()) {\r\n *                   domhandler_1.DomHandler.removeClass(_this.editingCell, 'ui-editing-cell');\r\n *                   _this.editingCell = null;\r\n *                   _this.onEditComplete.emit({ field: _this.editingCellField, data: _this.editingCellData });//+\r\n *                   _this.unbindDocumentEditListener();\r\n *               }\r\n *               _this.editingCellClick = false;\r\n *           };\r\n *           document.addEventListener('click', this.documentEditListener);\r\n *       }\r\n *   };\r\n * \r\n *  TTEditableColumn.prototype.openCell = function () {\r\n *       var _this = this;\r\n *        this.tt.updateEditingCell(this.el.nativeElement,this.data, this.field);//+\r\n *        domhandler_1.DomHandler.addClass(this.el.nativeElement, 'ui-editing-cell');\r\n *        this.tt.onEditInit.emit({ field: this.field, data: this.data });\r\n *        this.zone.runOutsideAngular(function () {\r\n *            setTimeout(function () {\r\n *                var focusable = domhandler_1.DomHandler.findSingle(_this.el.nativeElement, 'input, textarea');\r\n *                if (focusable) {\r\n *                     focusable.focus();\r\n *                 }\r\n *             }, 50);\r\n *        });\r\n *   };\r\n * \r\n *  TTEditableColumn.prototype.onClick = function (event) {\r\n *        if (this.isEnabled()) {\r\n *            this.tt.editingCellClick = true;\r\n *            if (this.tt.editingCell) {\r\n *                if (this.tt.editingCell !== this.el.nativeElement) {\r\n *                    if (!this.tt.isEditingCellValid()) {\r\n *                        return;\r\n *                    }\r\n *                    this.tt.onEditComplete.emit({ field: this.tt.oldField, data: this.tt.oldDdata });//+\r\n *                    DomHandler.removeClass(this.tt.editingCell, 'ui-editing-cell');\r\n *                    this.openCell();\r\n *                }\r\n *            }\r\n *            else {\r\n *                this.openCell();\r\n *            }\r\n *        }\r\n *  };\r\n * \r\n *  TTEditableColumn.prototype.openCell = function () {\r\n *         var _this = this;\r\n *         this.tt.updateEditingCell(this.el.nativeElement,this.data, this.field);\r\n *         DomHandler.addClass(this.el.nativeElement, 'ui-editing-cell');\r\n *         this.tt.onEditInit.emit({ field: this.field, data: this.data });\r\n *         this.tt.oldField= this.field; //+\r\n *         this.tt.oldDdata=this.data;  //+\r\n *         this.zone.runOutsideAngular(function () {\r\n *             setTimeout(function () {\r\n *                 var focusable = DomHandler.findSingle(_this.el.nativeElement, 'input, textarea');\r\n *                if (focusable) {\r\n *                     focusable.focus();\r\n *                 }\r\n *           }, 50);\r\n *       });\r\n *   };\r\n * \r\n * 3. HTMLæ¨¡æ¿\r\n * (1) ä¸å¯ç¨å¤è¡¨å¤´\r\n *      <p-treeTable [columns]=\"treeGridColumns\" farrisPrimengTreeTableBinding farrisHierarchyInfoKey=\"layerField\" [resizableColumns]=\"true\" farrisPrimengTreeTableIdField=\"id\">\r\n *             <ng-template pTemplate=\"header\" let-columns>\r\n *                 <tr>\r\n *                     <th *ngFor=\"let col of columns\" ttResizableColumn>\r\n *                         {{col.header}}\r\n *                     </th>\r\n *                 </tr>\r\n *             </ng-template>\r\n *             <ng-template pTemplate=\"body\" let-rowNode let-rowData=\"rowData\" let-columns=\"columns\">\r\n *                 <tr>\r\n *                     <td *ngFor=\"let col of columns; let i = index\" ttEditableColumn [ttEditableColumn]=\"rowData\"\r\n *                         [ttEditableColumnField]=\"col.field\">\r\n *                         <p-treeTableToggler [rowNode]=\"rowNode\" *ngIf=\"i === 0\"></p-treeTableToggler>\r\n *                         <p-treeTableCellEditor>\r\n *                             <ng-template pTemplate=\"input\">\r\n *                                  <!-- æ§ä»¶å¨æçæåºåï¼æ­¤å¤å¯æ¾ç½®æ§ä»¶å¨æçæç»ä»¶ï¼çæè§åå¦ä¸ï¼\r\n *                                            1. å­ç¬¦ä¸²ç±»åï¼ææ¬æ§ä»¶\r\n *                                            2. æ°å­ç±»åï¼æ°å­æ§ä»¶\r\n *                                            3. å¸å°ç±»åï¼å¤éæ¡æ§ä»¶\r\n *                                            4. æ¥ææ¶é´ç±»åï¼æ¥ææ¶é´æ§ä»¶\r\n *                                            5. æä¸¾ç±»åï¼ä¸ææ¡æ§ä»¶\r\n *                                            6. å¸®å©ç±»åï¼å¸®å©æ§ä»¶-->\r\n *                             </ng-template>\r\n *                             <ng-template pTemplate=\"output\">{{ col | formatCellData : rowData }}</ng-template>\r\n *                         </p-treeTableCellEditor>\r\n *                     </td>\r\n *                 </tr>\r\n *             </ng-template>\r\n *     </p-treeTable>\r\n * \r\n * (2) å¯ç¨å¤è¡¨å¤´\r\n * \r\n *  <p-treeTable [columns]=\"treeGridColumns\" farrisPrimengTreeTableBinding farrisHierarchyInfoKey=\"layerField\" [resizableColumns]=\"true\" farrisPrimengTreeTableIdField=\"id\">\r\n *             <ng-template pTemplate=\"header\" let-columns>\r\n *                  <tr *ngFor=\"let columnHeader of treeGridColumnHeaders\">\r\n *                      <th *ngFor=\"let col of columnHeader\" ttResizableColumn [attr.rowspan]=\"col.rowspan\" [attr.colspan]=\"col.colspan\">\r\n *                          {{col.header}}\r\n *                      </th>\r\n *                  </tr>\r\n *             </ng-template>\r\n *             <ng-template pTemplate=\"body\" let-rowNode let-rowData=\"rowData\" let-columns=\"columns\">\r\n *                 <tr>\r\n *                     <td *ngFor=\"let col of columns; let i = index\" ttEditableColumn [ttEditableColumn]=\"rowData\"\r\n *                         [ttEditableColumnField]=\"col.field\">\r\n *                         <p-treeTableToggler [rowNode]=\"rowNode\" *ngIf=\"i === 0\"></p-treeTableToggler>\r\n *                         <p-treeTableCellEditor>\r\n *                             <ng-template pTemplate=\"input\">\r\n *                                  <!-- æ§ä»¶å¨æçæåºåï¼æ­¤å¤å¯æ¾ç½®æ§ä»¶å¨æçæç»ä»¶ï¼çæè§åå¦ä¸ï¼\r\n *                                            1. å­ç¬¦ä¸²ç±»åï¼ææ¬æ§ä»¶\r\n *                                            2. æ°å­ç±»åï¼æ°å­æ§ä»¶\r\n *                                            3. å¸å°ç±»åï¼å¤éæ¡æ§ä»¶\r\n *                                            4. æ¥ææ¶é´ç±»åï¼æ¥ææ¶é´æ§ä»¶\r\n *                                            5. æä¸¾ç±»åï¼ä¸ææ¡æ§ä»¶\r\n *                                            6. å¸®å©ç±»åï¼å¸®å©æ§ä»¶-->\r\n *                             </ng-template>\r\n *                             <ng-template pTemplate=\"output\">{{ col | formatCellData : rowData }}</ng-template>\r\n *                         </p-treeTableCellEditor>\r\n *                     </td>\r\n *                 </tr>\r\n *             </ng-template>\r\n *  </p-treeTable>\r\n * \r\n * å¤è¡¨å¤´æ°æ®æ ¼å¼ï¼\r\n *  this.treeGridColumnHeaders=[\r\n *     [{ header: 'Brand',rowspan:3, colspan:1},{ header: 'Sale Rate',rowspan:1, colspan:4}],\r\n *     [{ header: 'Sales',rowspan:1, colspan:2},{ header: 'Profits',rowspan:1, colspan:2}],\r\n *     [{ header: 'Last Year',rowspan:1, colspan:1},{ header: 'This Year',rowspan:1, colspan:1},{ header: 'Last Year',rowspan:1, colspan:1},{ header: 'This Year',rowspan:1, colspan:1}],\r\n *  ]\r\n\r\n **********************************************************************************************************************/\r\n\r\nimport { Directive, OnInit, OnChanges, SimpleChanges, Input, HostListener, Output, EventEmitter, Type } from '@angular/core';\r\nimport { BindingData, BindingList, FrameContext, Change, ChangeType, EntityCollection, EntityList, Entity, ComponentType } from '@farris/devkit';\r\nimport { TreeTable } from 'primeng/treetable';\r\nimport { TreeNode } from 'primeng/api';\r\nimport { TreeNodeBuilderFactory } from '../tree_table_node_builder/tree_node_builder_factory';\r\nimport { DateTimeHelperService } from '@farris/ui-common/date';\r\nconst PARENT_ELEMENT: string = \"parentElement\";\r\nconst PATH: string = \"path\";\r\nconst IS_DETAIL: string = 'isDetail';\r\n\r\nexport interface FarrisPrimengTreeNode extends TreeNode {\r\n  id?: string;\r\n}\r\n\r\n@Directive({\r\n  selector: '[farrisPrimengTreeTableBinding]'\r\n})\r\nexport class FarrisPrimengTreeTableBindingDirective implements OnInit, OnChanges {\r\n  private selectedRowId = null;\r\n  private treeTableSelectedEvent = null;\r\n  /**\r\n   * åçº§ç ä¿¡æ¯å­æ®µï¼å±æ§å¯è½æä¸¤ç§æ ¼å¼çå¼ï¼åçº§ç å­æ®µï¼ä¸»è¡¨ï¼æä»è¡¨åç«¯codes/åçº§ç å­æ®µï¼å­è¡¨ï¼\r\n   */\r\n  @Input('farrisHierarchyInfoKey')\r\n  public hierarchyInfoKey: string;\r\n  @Input('columns')\r\n  public columns: any;\r\n  /**\r\n   * åç ï¼æ°æ®çå¯ä¸æ è¯\r\n   */\r\n  @Input('farrisPrimengTreeTableIdField')\r\n  public idField: string;\r\n\r\n  /**\r\n   * èç¹éæ©åæ´äºä»¶\r\n   */\r\n  @Output() nodeSelectChange: EventEmitter<any> = new EventEmitter<any>();\r\n\r\n  private oldTreeNodeMap: { [key: string]: FarrisPrimengTreeNode } = {};\r\n\r\n\r\n  /**\r\n   * åçº§ç çå­æ®µç¼å·ï¼ä»hierarchyInfoKeyå±æ§ä¸­è§£æè·å\r\n   */\r\n  private hierarchyInfoField: string;\r\n\r\n  /**\r\n   * ç»å®æ°æ®\r\n   */\r\n  private get bindingData(): BindingData {\r\n    return this.frameContext.bindingData;\r\n  }\r\n\r\n  /**\r\n   * ç»å®æ°æ®åè¡¨\r\n   */\r\n  private get bindingList(): BindingList {\r\n    return this.bindingData.getList();\r\n  }\r\n\r\n  private getHierarchyInfoField(): string {\r\n    let infos = this.hierarchyInfoKey.split('/');\r\n    return infos[infos.length - 1];\r\n  }\r\n\r\n  constructor(\r\n    private treeTable: TreeTable,\r\n    private frameContext: FrameContext,\r\n    private dateService: DateTimeHelperService\r\n  ) { }\r\n\r\n  ngOnChanges(changes: SimpleChanges): void {\r\n  }\r\n\r\n  ngOnInit(): void {\r\n    //è§£æè·ååçº§ç å­æ®µç¼å·\r\n    this.hierarchyInfoField = this.getHierarchyInfoField();\r\n    // å°åçº§ç ä¿¡æ¯ä¿å­å°root-component\r\n    const virtualRootFrameContext = this.frameContext.getVirtualRootFrameContext();\r\n    virtualRootFrameContext.setParam('hierarchyInfoKey', this.hierarchyInfoKey);\r\n    this.bindingData.changes.subscribe((change: Change) => {\r\n      this.bindData(change);\r\n      this.updateSelectedRow(change);\r\n    });\r\n    this.frameContext.viewModel.uiState.setPropertyValue('ids', []);\r\n    if (this.frameContext && this.frameContext.frameComponent) {\r\n      this.frameContext.frameComponent.componentType = ComponentType.primengTreeComponent;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * è·åæ åè¡¨ç»å®æ°æ®å¯¹åºçå®ä½æ°ç»\r\n   * @returns å®ä½æ°ç»\r\n   */\r\n  private getEntityArr(): Entity[] {\r\n    const entityCollection = this.frameContext.repository.entityCollection;\r\n    const bindingPath: string = this.frameContext.bindingData.bindingPath;\r\n    if (!bindingPath || bindingPath === '/') {\r\n      return entityCollection.toArray();\r\n    }\r\n    let bindingList: BindingList = this.frameContext.bindingData.list;\r\n    let bindingPathArr: string[] = bindingPath.split('/').filter(str => str);\r\n    let pathArray = [];\r\n    bindingPathArr.forEach((path: string) => {\r\n      pathArray.push(`${bindingList.primaryKey}:${bindingList.currentId}`);\r\n      pathArray.push(path);\r\n      bindingList = bindingList.currentItem[path];\r\n    });\r\n    return (entityCollection.getEntitiesByPath(pathArray) as EntityList<any>).toArray();\r\n  }\r\n  /**\r\n   * å°çå®é¡ºåºæ è®°å°å¯¹åºçå®ä½ä¸\r\n   * @param entityArr å®ä½æ°ç»\r\n   * @param treeNodes æ èç¹\r\n   */\r\n  private setActualIndex(entityArr: Entity[], treeNodes: TreeNode[]) {\r\n    if (entityArr.length < 1)\r\n      return;\r\n    // åå§ååºå·å¨å¹¶ä¾æ¬¡éåæ¯ä¸æ£µæ \r\n    let counter = { index: 0 };\r\n    const primaryKey: string = entityArr[0].primaryKey;\r\n    treeNodes.forEach((rootNode) => {\r\n      this.traverseTree(rootNode, counter, entityArr, primaryKey);\r\n    });\r\n  }\r\n  /**\r\n   * ååºéå½éåæ èç¹å¹¶å¨å¯¹åºå®ä½ä¸æ è®°åºå·\r\n   * @param treeNode æ èç¹\r\n   * @param counter åºå·å¨\r\n   * @param entityArr å®ä½æ°ç»\r\n   * @description\r\n   * å¨è¿è¡åç«¯æ ¡éªæ¶ï¼æç§Entityå¨æ°ç»ä¸­çä¸æ çæï¼éè¯¯æç¤ºçï¼è¡å·çæ¹å¼ä¸éç¨äºæ åè¡¨ï¼\r\n   * å ä¸ºæ åè¡¨å¯ä»¥å¨å·²ç»æ·»å çèç¹ä¸å å¥å­èç¹ï¼èEntityæ»æ¯å¨æåè¿½å æ°å¯¹è±¡ï¼å¯¼è´äºèçé¡ºåºä¸ä¸å®ç¸åï¼\r\n   * æä»¥å¨ç»å®æ°æ®çæ¶åå°æ èç¹å¨åè¡¨ä¸­ççå®é¡ºåºéè¿ä¸ä¸ªéå çå±æ§ï¼__ACTUAL_INDEX__ï¼èµç»Entityç¤ºä¾ï¼\r\n   * å½Entityè°ç¨validateæ¹æ³æ¶ï¼æ£æ¥æ¯å¦å­å¨è¯¥å±æ§ï¼å¦æå­å¨ååºç¨è¯¥å±æ§çå¼ä½ä¸ºè¡å·ã\r\n   */\r\n  private traverseTree(treeNode: TreeNode, counter: { index: number }, entityArr: Entity[], primaryKey: string) {\r\n    const INDEX_LABEL = \"__ACTUAL_INDEX__\";\r\n    // å¤çå½åèç¹\r\n    const entity = entityArr.find(e => e[primaryKey] === treeNode.data[primaryKey]);\r\n    if (entity) {\r\n      Object.defineProperty(entity, INDEX_LABEL, {\r\n        value: counter.index\r\n      });\r\n      counter.index++;\r\n    }\r\n    // éå½éååæ¯\r\n    treeNode.children.forEach((rootNode) => {\r\n      this.traverseTree(rootNode, counter, entityArr, primaryKey);\r\n    });\r\n  }\r\n\r\n  /**\r\n   * å¤çæ°æ®åæ´\r\n   * @param change åæ´\r\n   * @returns æ¯å¦è·³è¿ç»å®æ°æ®çæ´ä½å·æ°\r\n   * @description\r\n   * ç®çæ¯å°½éå°çéæ°æé æ´ä¸ªæ åè¡¨ï¼æ¯å¦å¨åçå¼ååäºä»¶æ¶å°½éåªæ´æ¹ååçå¼å°±ç»æï¼\r\n   * å¦æä»»ä½ååé½éæ°æé æ ï¼ä¼å¯¼è´Tabé®åæ¢åè½é¾ä»¥å®ç°ç­é®é¢ã\r\n   */\r\n  private handleChange(change?: Change): boolean {\r\n    // æ²¡æåæ´æ¶ï¼ç»§ç»­ç»å®æ°æ®å·æ°\r\n    if (!change)\r\n      return false;\r\n    // åç±»å¤çå·ä½çåæ´\r\n    switch (change.type) {\r\n      case ChangeType.SelectionChanged:\r\n        return this.handleSelectionChanged(change);\r\n      case ChangeType.GlobalSelectionChanged:\r\n        return this.handleSelectionChanged(change);\r\n      case ChangeType.ValueChanged:\r\n        return this.handleValueChanged(change);\r\n      default:\r\n        return false;\r\n    }\r\n  }\r\n  /**\r\n   * å¤çè¡åæ¢åæ´\r\n   * @param change åæ´\r\n   * @returns æ¯å¦è·³è¿ç»å®æ°æ®çæ´ä½å·æ°\r\n   */\r\n  private handleSelectionChanged(change: Change): boolean {\r\n    // å½åç»å®è·¯å¾ä¸åçè¡åæ¢äºä»¶ï¼ä¸è¿è¡æ°æ®å·æ°ï¼ä¸ºäºæ¯æTabé®åæ¢ååæ ¼ï¼\r\n    if (change.type === ChangeType.SelectionChanged || change.type === ChangeType.GlobalSelectionChanged) {\r\n      let path = change.path;\r\n      let frmPath = this.bindingData.bindingPath.split(\"/\").filter(str => str);\r\n      if (path.length === frmPath.length) {\r\n        let same = true;\r\n        for (let i = 0; i < path.length; i++) {\r\n          if (path[i] !== frmPath[i])\r\n            same = false;\r\n        }\r\n        if (same)\r\n          return true;\r\n      }\r\n    }\r\n    return false;\r\n  }\r\n  /**\r\n   * å¤çè¡åæ¢åæ´\r\n   * @param change åæ´\r\n   * @returns æ¯å¦è·³è¿ç»å®æ°æ®çæ´ä½å·æ°\r\n   */\r\n  private handleValueChanged(change: Change): boolean {\r\n    if (change.type !== ChangeType.ValueChanged) {\r\n      return false;\r\n    }\r\n    // æ¥æ¶å°å¼ååäºä»¶ï¼å°è¯ä»è¿è¡å±é¨æ°æ®çæ´æ°ï¼ä¸ºäºæ¯æTabé®åæ¢ååæ ¼ï¼\r\n    let path = change.path;\r\n    let bindingPathArr = this.bindingData.bindingPath.split(\"/\").filter(str => str);\r\n    // å¤æ­ç»å®è·¯å¾æ¯å¦ç¸åï¼å¦æä¸ç¸ååæ´ä½å·æ°\r\n    for (let item of bindingPathArr) {\r\n      if (path.length > 0) {\r\n        if (item === path[0]) {\r\n          path.shift();\r\n        } else {\r\n          return false;\r\n        }\r\n      }\r\n    }\r\n    // éè¿idæ¾å°å¾æ´æ°çæ èç¹\r\n    let id = change.id;\r\n    if (id) {\r\n      const primaryKey = this.bindingList.primaryKey;\r\n      let nodes = this.treeTable.value;\r\n      let targetNode = null;\r\n      for (let node of nodes) {\r\n        let result = this.findTreeNodeById(node, primaryKey, id);\r\n        if (result) {\r\n          targetNode = result;\r\n          break;\r\n        }\r\n      }\r\n      if (targetNode && path.length === 1) {\r\n        const propertyName = path.shift();\r\n        if (targetNode.data.hasOwnProperty(propertyName) && change.hasOwnProperty(\"value\")) {\r\n          targetNode.data[propertyName] = change.value;\r\n          return true;\r\n        }\r\n      }\r\n    }\r\n    return false;\r\n  }\r\n  /**\r\n   * éè¿ä¸»é®å¼æ¥æ¾æ èç¹\r\n   * @param treeNode æ æ ¹èç¹\r\n   * @param primaryKey ä¸»é®å\r\n   * @param keyValue ä¸»é®å¼\r\n   * @returns æ èç¹\r\n   * @todo éå½éåå®ç°æ¯è¾ä½æï¼èèéè¿oldTreeNodeMapæ¥æ¾æ èç¹\r\n   */\r\n  private findTreeNodeById(treeNode: TreeNode, primaryKey: string, keyValue: any): TreeNode | null {\r\n    if (!treeNode)\r\n      return null;\r\n    if (treeNode.data.hasOwnProperty(primaryKey) && treeNode.data[primaryKey] === keyValue)\r\n      return treeNode;\r\n    if (treeNode.children) {\r\n      for (let node of treeNode.children) {\r\n        let result = this.findTreeNodeById(node, primaryKey, keyValue);\r\n        if (result)\r\n          return result;\r\n      }\r\n    }\r\n    return null;\r\n  }\r\n\r\n  /**\r\n  * ç»å®æ°æ®\r\n  */\r\n  private bindData(change?: Change) {\r\n    let skipRefresh: boolean = this.handleChange(change);\r\n    if (skipRefresh) {\r\n      return;\r\n    }\r\n    // this.sourceData = this.bindingList.toJSON({ ignoreMultiLangInput: true });\r\n    const oldTreeNodes = this.treeTable.value;\r\n    const treeNodesData = this.bindingList.toJSON({ ignoreMultiLangInput: true });\r\n    let treeNodes: TreeNode[] = [];\r\n\r\n    if (treeNodesData && treeNodesData.length > 0) {\r\n      let hierarchyInfo = treeNodesData[0][this.hierarchyInfoField];\r\n      const builder: Type<any> = TreeNodeBuilderFactory.getBuilder(hierarchyInfo);\r\n      // æå¡å¨è¿åçåçº§èç¹ä¿¡æ¯å¹éä¸å°ç°æå·¥åéé¢çä»»ä½ä¸ç§æåµãç¡®è®¤æ°å çbuilderå·²ç»å¨å·¥åä¸­æ³¨å\r\n      if (builder == null) {\r\n        throw new Error('TreeTable builder is null!');\r\n      }\r\n      let expandLevel = -1;\r\n      const treeExpandLevel = this.treeTable['expandLevel'];\r\n      if (typeof treeExpandLevel !== 'undefined') {\r\n        expandLevel = treeExpandLevel;\r\n      }\r\n      const context = {\r\n        expandLevel,\r\n        component: this.treeTable,\r\n      };\r\n      const treeNodesBuilder = new builder(\r\n        treeNodesData, oldTreeNodes,\r\n        this.bindingList.primaryKey, this.hierarchyInfoField, context\r\n      );\r\n      treeNodes = treeNodesBuilder.build();\r\n      // è·åç»å®æ°æ®å¯¹åºçå®ä½åè¡¨\r\n      let entityArr: Entity[] = this.getEntityArr();\r\n      // æ ¹æ®treeNodesçé¡ºåºå¨å¯¹åºçå®ä½ä¸æ·»å åºå·å­æ®µ__ACTUAL_INDEX__\r\n      this.setActualIndex(entityArr, treeNodes);\r\n    }\r\n\r\n    if (!this.treeTable.lazy) {\r\n      this.treeTable.totalRecords = (this.treeTable._value ? this.treeTable._value.length : 0);\r\n      if (this.treeTable.sortMode == 'single' && this.treeTable.sortField)\r\n        this.treeTable.sortSingle();\r\n      else if (this.treeTable.sortMode == 'multiple' && this.treeTable.multiSortMeta)\r\n        this.treeTable.sortMultiple();\r\n      else if (this.treeTable.hasFilter()) //sort already filters\r\n        this.treeTable._filter();\r\n    }\r\n    this.treeTable.tableService.onUIUpdate(treeNodes);\r\n    this.treeTable.value = treeNodes;\r\n    this.treeTable.updateSerializedValue();\r\n\r\n    // this.treeNodeMap = {};\r\n    // this.sourceDataClone = this.sourceData;\r\n    // this.treeTable.value = [...this.treeNodesBuilder()];\r\n    // this.treeTableValueHandler();\r\n  }\r\n  private updateSelectedRow(change: Change) {\r\n    const currentId = this.bindingList.currentId;\r\n    if (this.treeTableSelectedEvent) {\r\n      this.treeTableSelectedEvent = false;\r\n      this.selectedRowId = currentId;\r\n      return;\r\n    }\r\n    const serializedValue = this.treeTable.serializedValue;\r\n\r\n    const treeNode = serializedValue && serializedValue.find(item => item && item.node && item.node.data && item.node.data.id === currentId) || null;\r\n    if (treeNode) {\r\n      if (this.treeTable.isSelected(treeNode.node) || currentId === this.selectedRowId) {\r\n        return;\r\n      }\r\n      this.selectedRowId = currentId;\r\n      this.treeTable.handleRowClick({ rowNode: treeNode, originalEvent: { target: { nodeName: '' } } });\r\n    }\r\n  }\r\n  @HostListener('onEditInit', ['$event'])\r\n  public onEditInitHandler(event: any) {\r\n    this.nodeSelectChange.emit(event['data']);\r\n    const id = event.data[this.idField];\r\n    this.setCurrentIdToBindingList(id);\r\n  }\r\n\r\n\r\n  @HostListener('onEditComplete', ['$event'])\r\n  public onEditCompleteHandler(event: any) {\r\n    let fieldName = event.field;\r\n    const column = this.columns.find(item => item.field === fieldName);\r\n    if (fieldName && column && column.editor && column.editor.options && column.editor.options.type === 'EditorTypes.LOOKUP') {\r\n      return;\r\n    }\r\n    if (event && event.hasOwnProperty('data')) {\r\n      const primaryKeyValue = event.data[this.frameContext.repository.primaryKey];\r\n\r\n      let value: any = this.getValue(fieldName, event.data);\r\n      const bindingPath = this.frameContext.viewModel.bindingPath || '/';\r\n      const bindingPaths = bindingPath.split('/').filter(p => p);\r\n      const bindingList: BindingList = this.bindingData.getValue(bindingPaths);\r\n      const bindingObject = bindingList.findById(primaryKeyValue);\r\n      const oldValue = this.getValue(fieldName, bindingObject);\r\n      const column = this.treeTable.columns.find(item => item.field === fieldName);\r\n      const dataType = column && column.dataType || null;\r\n      if (dataType === 'date' || dataType === 'datetime') {\r\n        if (this.dateService) {\r\n          const format = column && column.formatter && column.formatter.options && column.formatter.options.format || 'yyyy-MM-dd';\r\n          value = this.dateService.formatTo(value, format);\r\n          if (!value) {\r\n            value = null;\r\n          }\r\n        }\r\n      } else if (dataType === 'number') {\r\n        value = Number(value);\r\n      }\r\n      if (value !== oldValue) {\r\n        this.updateBindingList(primaryKeyValue, fieldName, value);\r\n      }\r\n    }\r\n  }\r\n\r\n  @HostListener('onNodeExpand', ['$event'])\r\n  public onNodeExpandHandler(event: any) {\r\n    // this.setNodeExpandedValue(event);\r\n    const selectedId = event && event.node && event.node.id || null;\r\n    if (!selectedId) {\r\n      return;\r\n    }\r\n    const virtualRootFrameContext = this.frameContext.getVirtualRootFrameContext();\r\n    const expandNodes = virtualRootFrameContext.getParam('TREE_LATEST_EXPANDED_ID') || [];\r\n    expandNodes.push(selectedId);\r\n    virtualRootFrameContext.setParam('TREE_LATEST_EXPANDED_ID', expandNodes);\r\n  }\r\n\r\n  @HostListener('onNodeCollapse', ['$event'])\r\n  public onNodeCollapseHandler(event: any) {\r\n    // this.setNodeExpandedValue(event);\r\n  }\r\n  @HostListener('onNodeSelect', ['$event'])\r\n  public onNodeSelectHandler(event: any) {\r\n    const id = event && event.node && event.node.data && event.node.data[this.frameContext.repository.primaryKey] || null;\r\n    if (id === this.bindingList.currentId) {\r\n      return;\r\n    }\r\n    this.treeTableSelectedEvent = true;\r\n    this.setCurrentIdToBindingList(id);\r\n  }\r\n  @HostListener('onNodeUnselect', ['$event'])\r\n  public onNodeUnselectHandler(event: any) {\r\n    this.setCurrentIdToBindingList(null);\r\n  }\r\n  private setNodeExpandedValue(event: any) {\r\n    if (!event || !this.oldTreeNodeMap || Object.keys(this.oldTreeNodeMap).length <= 0) {\r\n      return;\r\n    }\r\n    try {\r\n      let currentId = event.node.data.id;\r\n      this.oldTreeNodeMap[currentId].expanded = event.expanded;\r\n    } catch (e) {\r\n      console.warn(`setNodeExpandedValue error:${e.message}`);\r\n    }\r\n  }\r\n  private setCurrentIdToBindingList(selectedId: string): void {\r\n    const oldCurrentId = this.bindingList.currentId;\r\n    if (oldCurrentId === selectedId) {\r\n      return;\r\n    }\r\n    this.bindingList.setCurrentId(selectedId, true);\r\n  }\r\n\r\n  private getPaths(): string[] {\r\n    let paths = [];\r\n    if (!this.frameContext.viewModel || !this.frameContext.viewModel.bindingPath || this.frameContext.viewModel.bindingPath === '/') {\r\n      return paths;\r\n    }\r\n    else {\r\n      let bindingPath = this.frameContext.viewModel.bindingPath;\r\n      paths = bindingPath.substring(1, bindingPath.length).split('/');\r\n      return paths;\r\n    }\r\n  }\r\n  private updateBindingList(primaryValue: any, propertyName: string, value: any) {\r\n    if (!propertyName) {\r\n      return;\r\n    }\r\n    // æ´æ°ä¸»è¡¨é¨åè¡çå­æ®µ\r\n    const propertyNames = propertyName.split('.').filter(item => item);\r\n    const bindingPath = this.getBindingPathArray();\r\n    // ååºæ¥çä¸å®æ¯bindingList\r\n    const list = this.bindingData.getValue(bindingPath) as BindingList;\r\n    // ä¿®æ¹çæ¯å½åè¡\r\n    const paths = bindingPath.concat(propertyNames);\r\n    if (list && primaryValue === list.currentItem.primaryKeyValue) {\r\n      this.bindingData.setValue(paths, value, true, true);\r\n      return;\r\n    }\r\n    const bindingObject = this.bindingList.findById(primaryValue);\r\n    if (!bindingObject) {\r\n      return;\r\n    }\r\n    if (propertyNames.length < 2) {\r\n      bindingObject.setValue(propertyName, value, true, true, undefined, this.bindingData.getValudChangeInvokerFactory()(paths));\r\n    } else {\r\n      let targetBindingObject = null;\r\n      const fpaths = propertyNames.slice(0, propertyNames.length - 1);\r\n      const targetPropertyName = propertyNames[propertyNames.length - 1];\r\n      fpaths.forEach(prop => {\r\n        targetBindingObject = targetBindingObject && targetBindingObject[prop] || bindingObject[prop];\r\n      });\r\n      // todo:éè¦æ·»å å¼ååäºä»¶\r\n      targetBindingObject.setValue(targetPropertyName, value, true, true, undefined, this.bindingData.getValudChangeInvokerFactory()(paths));\r\n    }\r\n  }\r\n  private getBindingPathArray(): any[] {\r\n    const path = this.frameContext.viewModel.bindingPath;\r\n    if (path) {\r\n      return path.split('/').filter(n => n !== '');\r\n    }\r\n    return [];\r\n  }\r\n  private getValue(path: string, data: any) {\r\n    let value = '';\r\n    if (path.indexOf('.') === -1) {\r\n      value = data[path];\r\n    } else {\r\n      value = path.split('.').reduce((result, prop) => {\r\n        return result[prop];\r\n      }, data);\r\n    }\r\n    return value;\r\n  }\r\n  protected setChecks(ids: string[]) {\r\n    this.frameContext.viewModel.uiState.setPropertyValue('ids', ids);\r\n  }\r\n}","import { Directive, Injector, Input, OnChanges, OnDestroy, SimpleChanges } from \"@angular/core\";\r\nimport { FrameContext } from \"@farris/devkit\";\r\nconst EXCLUDE_VALIDATE_FIELDS = 'excludeValidateRules';\r\nconst RULETYPE = 'required';\r\n@Directive({\r\n  selector: '[farris-dynamic-required]'\r\n})\r\nexport class FarrisDynamicRequiredDirective implements OnChanges, OnDestroy {\r\n  /**\r\n   * like {field:'',type:'require'}\r\n   */\r\n  @Input('farris-dynamic-required') field: string;\r\n  /**\r\n   * å¯ç¨æ ¡éªçæ¶æº\r\n   */\r\n  @Input('requiredOn') requiredOn: boolean = false;\r\n  constructor(protected frameContext: FrameContext, private injector: Injector) {\r\n\r\n  }\r\n  ngOnDestroy(): void {\r\n    this.updateValidateRule(false);\r\n  }\r\n  ngOnChanges(changes: SimpleChanges): void {\r\n    // å¯ç¨å¿å¡«æ ¡éª\r\n    this.updateValidateRule(this.requiredOn);\r\n  }\r\n  /**\r\n   * \r\n   * @param isRequired \r\n   */\r\n  private updateValidateRule(isRequired: boolean) {\r\n    if (!this.field) {\r\n      return;\r\n    }\r\n    this.frameContext.form.updateFieldValidateRule(this.field, isRequired);\r\n    // if (isRequired) {\r\n    //   const rules = this.frameContext.params.get(EXCLUDE_VALIDATE_FIELDS) || {};\r\n    //   const fieldExcludeRules: string[] = rules[this.field] || [];\r\n    //   if (fieldExcludeRules.includes(RULETYPE)) {\r\n    //     const index = fieldExcludeRules.indexOf(RULETYPE);\r\n    //     fieldExcludeRules.splice(index, 1);\r\n    //   }\r\n    //   this.frameContext.params.set(EXCLUDE_VALIDATE_FIELDS, rules);\r\n    //   this.frameContext.form.updateFieldValidateRule(this.field, fieldExcludeRules);\r\n    // } else {\r\n    //   // ç¦ç¨æ ¡éª\r\n    //   // {int1:[required,maxValue]}\r\n    //   const rules = this.frameContext.params.get(EXCLUDE_VALIDATE_FIELDS) || {};\r\n    //   const fieldExcludeRules = rules[this.field] || [];\r\n    //   if (fieldExcludeRules && !fieldExcludeRules.includes(RULETYPE)) {\r\n    //     fieldExcludeRules.push(RULETYPE);\r\n    //   }\r\n    //   rules[this.field] = fieldExcludeRules;\r\n    //   this.frameContext.params.set(EXCLUDE_VALIDATE_FIELDS, rules);\r\n    //   this.frameContext.form.updateFieldValidateRule(this.field, fieldExcludeRules);\r\n    // }\r\n  }\r\n\r\n}\r\n","import { Directive, ElementRef, OnInit } from '@angular/core';\r\nimport { ViewModel } from '@farris/devkit';\r\nimport { EditorComponent } from '@farris/ui-editor';\r\n\r\n@Directive({\r\n  selector: '[farris-editor],[farris-editor-bind]'\r\n})\r\nexport class FarrisEditorDirective implements OnInit {\r\n  constructor(private viewModel: ViewModel, private editor: EditorComponent) { }\r\n\r\n  ngOnInit(): void {\r\n    this.setComponentRef();\r\n  }\r\n\r\n  private setComponentRef() {\r\n    const appContext = this.viewModel && this.viewModel.frameContext && this.viewModel.frameContext.getFormAppContext();\r\n    const frameId = this.viewModel && this.viewModel.frameContext && this.viewModel.frameContext.frameId;\r\n    const editor: any = this.editor;\r\n    const elementRef: ElementRef = editor && editor.injector && editor.injector.get(ElementRef, null);\r\n    const id = elementRef && elementRef.nativeElement && elementRef.nativeElement.id || null;\r\n    // å¦æframeIdä¸å­å¨ætreetableæ²¡æidå±æ§ï¼è¯´æä¸ç¬¦åä½¿ç¨åºæ¯\r\n    if (!frameId || !id) {\r\n      return;\r\n    }\r\n    const map = appContext && appContext.componentRefs && appContext.componentRefs.get(frameId) || new Map<string, any>();\r\n    appContext && appContext.componentRefs && appContext.componentRefs.set(frameId, map.set(id, this.editor));\r\n  }\r\n}","import { Directive, HostListener, Injector } from \"@angular/core\";\r\nimport { FrameContext } from \"@farris/devkit\";\r\nimport { QuerySolutionComponent } from \"@gsp-cmp/querysolution\";\r\n@Directive({\r\n  selector: \"[farris-querysolution-event-bind]\"\r\n})\r\nexport class FarrisQuerySolutionEventBindDirective {\r\n  constructor(private injector: Injector, private component: QuerySolutionComponent, private frameContext: FrameContext) { }\r\n  /**\r\n   * æ§è¡ç­é\r\n   * @param event event\r\n   */\r\n  @HostListener(\"queryEmitter\")\r\n  private onQuery(event: any) {\r\n    if (this.frameContext) {\r\n      this.frameContext.repository.entityCollection.pageIndex = 1;\r\n    }\r\n  }\r\n}","import { Directive, Inject, Injector, OnInit } from \"@angular/core\";\r\nimport { UserSettings, UserSettingsToken } from \"@farris/devkit\";\r\nimport { FarrisDatepickerComponent } from '@farris/ui-datepicker';\r\n@Directive({\r\n  selector: '[farris-date-localization]'\r\n})\r\nexport class FarrisDateLocalizationDirective implements OnInit {\r\n  constructor(private injector: Injector, @Inject(UserSettingsToken) private userSettings: UserSettings, private componentRef: FarrisDatepickerComponent) {\r\n\r\n  }\r\n  ngOnInit(): void {\r\n    this.localize();\r\n  }\r\n  private localize() {\r\n    if (this.userSettings && this.componentRef) {\r\n      const { dateFormat = null, timeFormat = null } = this.userSettings;\r\n      if (dateFormat === null && timeFormat === null) {\r\n        return;\r\n      }\r\n      if (timeFormat && timeFormat && this.componentRef.showTime === true) {\r\n        this.componentRef.dateFormat = `${dateFormat} ${timeFormat}`;\r\n        this.componentRef.dateOpts.dateFormat = `${dateFormat} ${timeFormat}`;\r\n        this.componentRef.updateValue(this.componentRef.value);\r\n      } else if (dateFormat) {\r\n        this.componentRef.dateFormat = `${dateFormat}`;\r\n        this.componentRef.dateOpts.dateFormat = `${dateFormat}`;\r\n        this.componentRef.updateValue(this.componentRef.value);\r\n      }\r\n    }\r\n  }\r\n}","import { Directive, Inject, Injector, OnInit } from \"@angular/core\";\r\nimport { UserSettings, UserSettingsToken } from \"@farris/devkit\";\r\nimport { NumberSpinnerComponent } from '@farris/ui-number-spinner';\r\n@Directive({\r\n  selector: '[farris-number-localization]'\r\n})\r\nexport class FarrisNumberLocalizationDirective implements OnInit {\r\n  constructor(private injector: Injector, @Inject(UserSettingsToken) private userSettings: UserSettings, private componentRef: NumberSpinnerComponent) {\r\n\r\n  }\r\n  ngOnInit(): void {\r\n    this.localize();\r\n  }\r\n  private localize() {\r\n    return;\r\n    // æ¶åéé¢ç­é®é¢ï¼æ°å­æ ¼å¼åä¸äºå¤ç\r\n    if (this.userSettings && this.userSettings.numberFormat && this.componentRef) {\r\n      const { negativeSign = null, numberDecimalDigits = null, numberDecimalSeparator = null, numberGroupSeparator = null } = this.userSettings.numberFormat || {};\r\n      // è´å·\r\n      if (negativeSign) {\r\n        // this.componentRef.prefix = negativeSign;\r\n      }\r\n      // å°æ°ä½æ°\r\n      if (numberDecimalDigits !== null) {\r\n        this.componentRef.precision = numberDecimalDigits;\r\n        this.componentRef.formatOptions['precision'] = numberDecimalDigits;\r\n      }\r\n      // å°æ°ç¹ç¬¦å·\r\n      if (numberDecimalSeparator !== null) {\r\n        this.componentRef.decimalSeparator = numberDecimalSeparator;\r\n        this.componentRef.formatOptions['decimalSeparator'] = numberDecimalSeparator;\r\n      }\r\n      // ååä½ç¬¦å·\r\n      if (numberGroupSeparator !== null) {\r\n        this.componentRef.groupSeparator = numberGroupSeparator;\r\n        this.componentRef.formatOptions['groupSeparator'] = numberGroupSeparator;\r\n      }\r\n      this.componentRef.updateValue(this.componentRef.value);\r\n    }\r\n  }\r\n}","import { Directive, Inject, Injector, OnInit } from \"@angular/core\";\r\nimport { UserSettings, UserSettingsToken } from \"@farris/devkit\";\r\nimport { TimePickerComponent } from '@farris/ui-time-picker';\r\n\r\n@Directive({\r\n  selector: '[farris-time-localization]'\r\n})\r\nexport class FarrisTimeLocalizationDirective implements OnInit {\r\n  constructor(private injector: Injector, @Inject(UserSettingsToken) private userSettings: UserSettings, private componentRef: TimePickerComponent) {\r\n\r\n  }\r\n  ngOnInit(): void {\r\n    this.localize();\r\n  }\r\n  private localize() {\r\n    if (this.userSettings && this.componentRef) {\r\n      const { timeFormat = null } = this.userSettings;\r\n      if (timeFormat) {\r\n        this.componentRef.format = timeFormat;\r\n      }\r\n    }\r\n  }\r\n}","import { Directive, Inject, Injector, Input, OnInit } from \"@angular/core\";\r\nimport { NumberFormat, UserSettings, UserSettingsToken } from \"@farris/devkit\";\r\nimport { BigNumber } from 'bignumber.js';\r\nimport moment from 'moment';\r\nimport { TextComponent } from '@farris/ui-text';\r\n\r\n@Directive({\r\n  selector: '[farris-text-localization]'\r\n})\r\nexport class FarrisTextLocalizationDirective implements OnInit {\r\n  @Input('localization') localization: boolean;\r\n  constructor(private injector: Injector, @Inject(UserSettingsToken) private userSettings: UserSettings, private componentRef: TextComponent) {\r\n    this.transform();\r\n  }\r\n  public ngOnInit() {\r\n  }\r\n  private transform() {\r\n    if (this.componentRef) {\r\n      this.componentRef.beforeWriteValue = (value: any, options: any) => {\r\n        let { localizationType = null, showTime = false } = options;\r\n        if (!value) {\r\n          return '';\r\n        }\r\n        if (localizationType && value) {\r\n          localizationType = localizationType.toLowerCase();\r\n          value = this.transformValue(value, localizationType);\r\n          return value;\r\n        } else {\r\n          return undefined;\r\n        }\r\n      };\r\n    }\r\n  }\r\n  private transformValue(value: any, dataType: string) {\r\n    if (dataType === 'date') {\r\n      return this.transformDate(value);\r\n    } else if (dataType === 'datetime') {\r\n      return this.transformDateTime(value);\r\n    }\r\n    // æ¶åéé¢è®¡ç®åæ¾ç¤ºé®é¢ï¼ä¸äºå¤ç\r\n    //  else if (dataType === 'number') {\r\n    //   return this.transformNumber(value);\r\n    // } \r\n    else {\r\n      return value;\r\n    }\r\n  }\r\n  /**\r\n   * è½¬æ¢æ¥æ\r\n   * @param value value\r\n   */\r\n  private transformDate(value: any) {\r\n    let dateFormat = this.userSettings && this.userSettings.dateFormat || 'YYYY-MM-DD';\r\n    if (!dateFormat || !value) {\r\n      return value;\r\n    }\r\n    const date = moment(value);\r\n    const isValid = date.isValid();\r\n    if (!isValid) {\r\n      return value;\r\n    }\r\n    dateFormat = this.parseDateFormat(dateFormat);\r\n    return date.format(dateFormat);\r\n  }\r\n  /**\r\n   * è½¬æ¢æ¥ææ¶é´\r\n   * @param value value\r\n   * todo: ç®åæ æ³å®ä¹æ¥ææ¶é´æ ¼å¼\r\n   */\r\n  private transformDateTime(value: any) {\r\n    let dateFormat = this.userSettings && this.userSettings.dateFormat || 'YYYY-MM-DD';\r\n    let timeFormat = this.userSettings && this.userSettings.timeFormat || 'HH:mm:ss';\r\n    if (!dateFormat || !timeFormat) {\r\n      return value;\r\n    }\r\n    const dateTime = moment(value);\r\n    const isValid = dateTime.isValid();\r\n    if (!isValid) {\r\n      return value;\r\n    }\r\n    if (dateFormat) {\r\n      dateFormat = this.parseDateFormat(dateFormat);\r\n    }\r\n    if (timeFormat) {\r\n      timeFormat = this.parseTimeFormat(timeFormat);\r\n    }\r\n    const dateTimeFormat = dateFormat + ' ' + timeFormat;\r\n    return dateTime.format(dateTimeFormat);\r\n  }\r\n  /**\r\n   * è½¬æ¢æ°å­\r\n   * @param value value\r\n   */\r\n  private transformNumber(value): string {\r\n    if (value === null || value === undefined || value === '') {\r\n      return '';\r\n    }\r\n    const bigNumber = new BigNumber(value);\r\n    // å¦æä¸æ¯æ°å­ï¼ä¸åä»»ä½å¤ç\r\n    if (!BigNumber.isBigNumber(bigNumber)) {\r\n      return value;\r\n    }\r\n    const isNegative = bigNumber.isNegative();\r\n    const format = this.buildNumberFormat();\r\n    const { negativeSign = null, numberDecimalDigits = null } = this.numberFormat || {};\r\n    if (isNegative) {\r\n      if (negativeSign !== null) {\r\n        format.prefix = negativeSign;\r\n        return bigNumber.absoluteValue().toFormat(numberDecimalDigits, null, format);\r\n      }\r\n    }\r\n    return bigNumber.toFormat(numberDecimalDigits, null, format);\r\n  }\r\n  /**\r\n   * è½¬æ¢æ¥ææ ¼å¼è§åä¸ºmomentçformatè§å\r\n   * @param format format\r\n   */\r\n  private parseDateFormat(format: string) {\r\n    return format.replace(/y/g, 'Y').replace(/d/g, 'D');\r\n  }\r\n  /**\r\n   * è½¬æ¢æ¶é´æ ¼å¼è§åä¸ºmomentçformatè§å\r\n   * @param format format\r\n   */\r\n  private parseTimeFormat(format: string) {\r\n    return format.replace(/M/g, 'm');\r\n  }\r\n  /**\r\n   * æé bignumberæ°å­æ ¼å¼åéé¡¹\r\n   */\r\n  private buildNumberFormat() {\r\n    if (this.numberFormat) {\r\n      const { numberDecimalSeparator = null, numberGroupSeparator = null } = this.numberFormat;\r\n      const format: any = {\r\n        groupSize: 3,\r\n      };\r\n      if (numberDecimalSeparator !== null) {\r\n        format.decimalSeparator = numberDecimalSeparator;\r\n      }\r\n      if (numberGroupSeparator !== null) {\r\n        format.groupSeparator = numberGroupSeparator;\r\n      }\r\n      return format;\r\n    }\r\n  }\r\n  private get numberFormat(): NumberFormat {\r\n    return this.userSettings && this.userSettings.numberFormat || null;\r\n  }\r\n}","import { Directive, ElementRef, Injector, Input, OnInit } from '@angular/core';\r\n@Directive({\r\n  selector: '[farris-checkbox-modification]'\r\n})\r\nexport class FarrisCheckboxModificationDirective implements OnInit {\r\n  @Input() index: number;\r\n  constructor(private injector: Injector, private elementRef: ElementRef) { }\r\n  ngOnInit(): void {\r\n    if (typeof this.index !== 'number' || !this.elementRef) {\r\n      return;\r\n    }\r\n    const nativeElement = this.elementRef.nativeElement;\r\n    if (nativeElement) {\r\n      const id = nativeElement.getAttribute('id');\r\n      if (id) {\r\n        const token = `${id}_${this.index}`;\r\n        this.elementRef.nativeElement.setAttribute('id', token);\r\n        this.elementRef.nativeElement.setAttribute('name', token);\r\n        this.elementRef.nativeElement.setAttribute('original_id', id);\r\n      }\r\n    }\r\n  }\r\n\r\n}\r\n","import { Directive, ElementRef, Injector, Input, OnInit } from '@angular/core';\r\n@Directive({\r\n  selector: '[farris-label-modification]'\r\n})\r\nexport class FarrisLabelModificationDirective implements OnInit {\r\n  @Input() index: number;\r\n  constructor(private injector: Injector, private elementRef: ElementRef) { }\r\n  ngOnInit(): void {\r\n    if (typeof this.index !== 'number' || !this.elementRef) {\r\n      return;\r\n    }\r\n    const nativeElement = this.elementRef.nativeElement;\r\n    if (nativeElement) {\r\n      const labelFor = nativeElement.getAttribute('for');\r\n      if (labelFor) {\r\n        this.elementRef.nativeElement.setAttribute('for', `${labelFor}_${this.index}`);\r\n      }\r\n    }\r\n  }\r\n\r\n}\r\n","import { Directive, Input, Optional } from '@angular/core';\r\nimport { ComboLookupComponent } from '@farris/ui-combo-lookup';\r\nimport { LookupGridComponent } from '@farris/ui-lookup';\r\n\r\n@Directive({\r\n  selector: '[farris-lookup-binding]'\r\n})\r\nexport class FarrisLookupBindingDirective {\r\n  @Input() lookupType: string;\r\n  @Input('farris-lookup-binding')\r\n  public set lookupValue(value: any) {\r\n    if (this.lookupType === 'lookup' && this.lookup) {\r\n      this.lookup.writeValue(value);\r\n    } else if (this.lookupType === 'comboLookup' && this.comboLookup) {\r\n      this.comboLookup.writeValue(value);\r\n    }\r\n  }\r\n  constructor(@Optional() private lookup: LookupGridComponent, @Optional() private comboLookup: ComboLookupComponent) { }\r\n}","import { ElementRef } from \"@angular/core\";\r\nimport { FrameContext } from \"@farris/devkit\";\r\n\r\nexport class ComponentRef {\r\n  constructor(protected frameContext: FrameContext, protected elementRef: ElementRef) { }\r\n  public addComponent(componentRef: any) {\r\n    const id = this.elementRef && this.elementRef.nativeElement && this.elementRef.nativeElement.id;\r\n    if (this.frameContext && id && componentRef) {\r\n      this.frameContext.componentRefManager.add(id, componentRef);\r\n    }\r\n  }\r\n  public tryAddComponent(componentRef: any, componentId: string = null) {\r\n    const id = componentId || this.elementRef && this.elementRef.nativeElement && this.elementRef.nativeElement.id;\r\n    if (this.frameContext && id && componentRef && !this.frameContext.componentRefManager.has(id)) {\r\n      this.frameContext.componentRefManager.add(id, componentRef);\r\n    }\r\n  }\r\n}","import { AfterViewInit, Directive, ElementRef, Injector, OnDestroy, OnInit } from \"@angular/core\";\r\nimport { FrameContext } from \"@farris/devkit\";\r\nimport { ListNavComponent } from '@farris/ui-list-nav';\r\nimport { ComponentRef } from \"./component-ref\";\r\n\r\n@Directive({\r\n  selector: '[listNavRef]'\r\n})\r\nexport class ListNavComponentRefDirective extends ComponentRef implements OnInit, OnDestroy, AfterViewInit {\r\n  constructor(private injector: Injector, private component: ListNavComponent, public elementRef: ElementRef, public frameContext: FrameContext) {\r\n    super(frameContext, elementRef);\r\n  }\r\n  //#region angular lifecycle\r\n  ngAfterViewInit(): void {\r\n    this.tryAddComponent(this.component);\r\n  }\r\n  ngOnInit(): void {\r\n    this.addComponent(this.component);\r\n  }\r\n  ngOnDestroy(): void {\r\n  }\r\n  //#endregion\r\n}","import { AfterViewInit, Directive, ElementRef, Injector, OnDestroy, OnInit } from \"@angular/core\";\r\nimport { FrameContext } from \"@farris/devkit\";\r\nimport { ListViewComponent } from \"@farris/ui-list-view\";\r\nimport { ComponentRef } from \"./component-ref\";\r\n\r\n@Directive({\r\n  selector: '[listViewRef]'\r\n})\r\nexport class ListViewComponentRefDirective extends ComponentRef implements OnInit, OnDestroy, AfterViewInit {\r\n  constructor(private injector: Injector, private component: ListViewComponent, public elementRef: ElementRef, public frameContext: FrameContext) {\r\n    super(frameContext, elementRef);\r\n  }\r\n  ngAfterViewInit(): void {\r\n    this.tryAddComponent(this.component);\r\n  }\r\n  ngOnInit(): void {\r\n    this.addComponent(this.component);\r\n  }\r\n  ngOnDestroy(): void {\r\n  }\r\n}","import { AfterViewInit, Directive, ElementRef, Injector, OnDestroy, OnInit } from \"@angular/core\";\r\nimport { FrameContext } from \"@farris/devkit\";\r\nimport { ListFilterComponent } from '@farris/ui-list-filter';\r\nimport { ComponentRef } from \"./component-ref\";\r\n@Directive({\r\n  selector: '[listFilterRef]'\r\n})\r\nexport class ListFilterComponentRefDirective extends ComponentRef implements OnInit, OnDestroy, AfterViewInit {\r\n  constructor(private injector: Injector, private component: ListFilterComponent, public elementRef: ElementRef, public frameContext: FrameContext) { \r\n    super(frameContext, elementRef);\r\n  }\r\n  ngAfterViewInit(): void {\r\n    this.tryAddComponent(this.component);\r\n  }\r\n  ngOnInit(): void {\r\n    this.addComponent(this.component);\r\n  }\r\n  ngOnDestroy(): void {\r\n  }\r\n}","import { AfterViewInit, Directive, ElementRef, Injector, OnDestroy, OnInit } from \"@angular/core\";\r\nimport { FrameContext } from \"@farris/devkit\";\r\nimport { FilterComponent } from '@farris/ui-filter';\r\nimport { ComponentRef } from \"./component-ref\";\r\n\r\n@Directive({\r\n  selector: '[filterRef]'\r\n})\r\nexport class FilterComponentRefDirective extends ComponentRef implements OnInit, OnDestroy, AfterViewInit {\r\n  constructor(private injector: Injector, private component: FilterComponent, public elementRef: ElementRef, public frameContext: FrameContext) {\r\n    super(frameContext, elementRef);\r\n  }\r\n  ngAfterViewInit(): void {\r\n    this.tryAddComponent(this.component);\r\n  }\r\n  ngOnInit(): void {\r\n    this.addComponent(this.component);\r\n  }\r\n  ngOnDestroy(): void {\r\n  }\r\n\r\n}","import { AfterViewInit, Directive, ElementRef, Injector, OnDestroy, OnInit } from \"@angular/core\";\r\nimport { FrameContext } from \"@farris/devkit\";\r\nimport { ViewChangeComponent } from '@farris/ui-view-change';\r\nimport { ComponentRef } from \"./component-ref\";\r\n\r\n@Directive({\r\n  selector: '[viewChangeRef]'\r\n})\r\nexport class ViewChangeComponentRefDirective extends ComponentRef implements OnInit, OnDestroy, AfterViewInit {\r\n  constructor(private injector: Injector, private component: ViewChangeComponent, public elementRef: ElementRef, public frameContext: FrameContext) {\r\n    super(frameContext, elementRef);\r\n  }\r\n  ngAfterViewInit(): void {\r\n    this.tryAddComponent(this.component);\r\n  }\r\n  ngOnInit(): void {\r\n    this.addComponent(this.component);\r\n  }\r\n  ngOnDestroy(): void {\r\n  }\r\n\r\n}","import { AfterViewInit, Directive, ElementRef, Injector, OnDestroy, OnInit } from \"@angular/core\";\r\nimport { FrameContext } from \"@farris/devkit\";\r\nimport { HtmlEditorComponent } from '@farris/ui-html-editor';\r\nimport { ComponentRef } from \"./component-ref\";\r\n\r\n@Directive({\r\n  selector: '[htmlEditorRef]'\r\n})\r\nexport class HtmlEditorComponentRefDirective extends ComponentRef implements OnInit, OnDestroy, AfterViewInit {\r\n  constructor(private injector: Injector, private component: HtmlEditorComponent, public elementRef: ElementRef, public frameContext: FrameContext) {\r\n    super(frameContext, elementRef);\r\n  }\r\n  ngAfterViewInit(): void {\r\n    this.tryAddComponent(this.component);\r\n  }\r\n  ngOnInit(): void {\r\n    this.addComponent(this.component);\r\n  }\r\n  ngOnDestroy(): void {\r\n  }\r\n\r\n}","import { AfterViewInit, Directive, ElementRef, Injector, OnDestroy, OnInit } from \"@angular/core\";\r\nimport { FrameContext } from \"@farris/devkit\";\r\nimport { FarrisSectionComponent } from '@farris/ui-section';\r\nimport { ComponentRef } from \"./component-ref\";\r\n\r\n@Directive({\r\n  selector: '[sectionRef]'\r\n})\r\nexport class SectionComponentRefDirective extends ComponentRef implements OnInit, OnDestroy, AfterViewInit {\r\n  constructor(private injector: Injector, private component: FarrisSectionComponent, public elementRef: ElementRef, public frameContext: FrameContext) {\r\n    super(frameContext, elementRef);\r\n  }\r\n  ngAfterViewInit(): void {\r\n    this.tryAddComponent(this.component);\r\n  }\r\n  ngOnInit(): void {\r\n    this.addComponent(this.component);\r\n  }\r\n  ngOnDestroy(): void {\r\n  }\r\n\r\n}","import { AfterViewInit, Directive, ElementRef, Injector, OnDestroy, OnInit } from \"@angular/core\";\r\nimport { FrameContext } from \"@farris/devkit\";\r\nimport { InputGroupComponent } from '@farris/ui-input-group';\r\nimport { ComponentRef } from \"./component-ref\";\r\n\r\n@Directive({\r\n  selector: '[inputGroupRef]'\r\n})\r\nexport class InputGroupComponentRefDirective extends ComponentRef implements OnInit, OnDestroy, AfterViewInit {\r\n  constructor(private injector: Injector, private component: InputGroupComponent, public elementRef: ElementRef, public frameContext: FrameContext) {\r\n    super(frameContext, elementRef);\r\n  }\r\n  ngAfterViewInit(): void {\r\n    this.tryAddComponent(this.component);\r\n  }\r\n  ngOnInit(): void {\r\n    this.addComponent(this.component);\r\n  }\r\n  ngOnDestroy(): void {\r\n  }\r\n\r\n}","import { AfterViewInit, Directive, ElementRef, Injector, OnDestroy, OnInit } from \"@angular/core\";\r\nimport { FrameContext } from \"@farris/devkit\";\r\nimport { FarrisDatepickerComponent } from '@farris/ui-datepicker';\r\nimport { ComponentRef } from \"./component-ref\";\r\n\r\n@Directive({\r\n  selector: '[datepickerRef]'\r\n})\r\nexport class DatepickerComponentRefDirective extends ComponentRef implements OnInit, OnDestroy, AfterViewInit {\r\n  constructor(private injector: Injector, private component: FarrisDatepickerComponent, public elementRef: ElementRef, public frameContext: FrameContext) {\r\n    super(frameContext, elementRef);\r\n  }\r\n  ngAfterViewInit(): void {\r\n    this.tryAddComponent(this.component);\r\n  }\r\n  ngOnInit(): void {\r\n    this.addComponent(this.component);\r\n  }\r\n  ngOnDestroy(): void {\r\n  }\r\n\r\n}","import { AfterViewInit, Directive, ElementRef, Injector, OnDestroy, OnInit } from \"@angular/core\";\r\nimport { FrameContext } from \"@farris/devkit\";\r\nimport { TimePickerComponent } from '@farris/ui-time-picker';\r\nimport { ComponentRef } from \"./component-ref\";\r\n\r\n@Directive({\r\n  selector: '[timePickerRef]'\r\n})\r\nexport class TimePickerComponentRefDirective extends ComponentRef implements OnInit, OnDestroy, AfterViewInit {\r\n  constructor(private injector: Injector, private component: TimePickerComponent, public elementRef: ElementRef, public frameContext: FrameContext) {\r\n    super(frameContext, elementRef);\r\n  }\r\n  ngAfterViewInit(): void {\r\n    this.tryAddComponent(this.component);\r\n  }\r\n  ngOnInit(): void {\r\n    this.addComponent(this.component);\r\n  }\r\n  ngOnDestroy(): void {\r\n  }\r\n\r\n}","import { AfterViewInit, Directive, ElementRef, Injector, OnDestroy, OnInit } from \"@angular/core\";\r\nimport { FrameContext } from \"@farris/devkit\";\r\nimport { NumberSpinnerComponent } from \"@farris/ui-number-spinner\";\r\nimport { ComponentRef } from \"./component-ref\";\r\n\r\n@Directive({\r\n  selector: '[numberSpinnerRef]'\r\n})\r\nexport class NumberSpinnerComponentRefDirective extends ComponentRef implements OnInit, OnDestroy, AfterViewInit {\r\n  constructor(private injector: Injector, private component: NumberSpinnerComponent, public elementRef: ElementRef, public frameContext: FrameContext) {\r\n    super(frameContext, elementRef);\r\n  }\r\n  ngAfterViewInit(): void {\r\n    this.tryAddComponent(this.component);\r\n  }\r\n  ngOnInit(): void {\r\n    this.addComponent(this.component);\r\n  }\r\n  ngOnDestroy(): void {\r\n  }\r\n}","import { AfterViewInit, Directive, ElementRef, Injector, OnDestroy, OnInit } from \"@angular/core\";\r\nimport { FrameContext } from \"@farris/devkit\";\r\nimport { ComboListComponent } from '@farris/ui-combo-list';\r\nimport { ComponentRef } from \"./component-ref\";\r\n\r\n@Directive({\r\n  selector: '[comboListRef]'\r\n})\r\nexport class ComboListComponentRefDirective extends ComponentRef implements OnInit, OnDestroy, AfterViewInit {\r\n  constructor(private injector: Injector, private component: ComboListComponent, public elementRef: ElementRef, public frameContext: FrameContext) {\r\n    super(frameContext, elementRef);\r\n  }\r\n  ngAfterViewInit(): void {\r\n    this.tryAddComponent(this.component);\r\n  }\r\n  ngOnInit(): void {\r\n    this.addComponent(this.component);\r\n  }\r\n  ngOnDestroy(): void {\r\n  }\r\n}","import { AfterViewInit, Directive, ElementRef, Injector, OnDestroy, OnInit } from \"@angular/core\";\r\nimport { FrameContext } from \"@farris/devkit\";\r\nimport { ComboLookupComponent } from '@farris/ui-combo-lookup';\r\nimport { ComponentRef } from \"./component-ref\";\r\n\r\n@Directive({\r\n  selector: '[comboLookupRef]'\r\n})\r\nexport class ComboLookupComponentRefDirective extends ComponentRef implements OnInit, OnDestroy, AfterViewInit {\r\n  constructor(private injector: Injector, private component: ComboLookupComponent, public elementRef: ElementRef, public frameContext: FrameContext) { \r\n    super(frameContext, elementRef);\r\n  }\r\n  ngAfterViewInit(): void {\r\n    this.tryAddComponent(this.component);\r\n  }\r\n  ngOnInit(): void {\r\n    this.addComponent(this.component);\r\n  }\r\n  ngOnDestroy(): void {\r\n  }\r\n\r\n}","import { AfterViewInit, Directive, ElementRef, Injector, OnDestroy, OnInit } from \"@angular/core\";\r\nimport { FrameContext } from \"@farris/devkit\";\r\nimport { LookupGridComponent } from '@farris/ui-lookup';\r\nimport { ComponentRef } from \"./component-ref\";\r\n\r\n@Directive({\r\n  selector: '[lookupGridRef]'\r\n})\r\nexport class LookupGridComponentRefDirective extends ComponentRef implements OnInit, OnDestroy, AfterViewInit {\r\n  constructor(private injector: Injector, private component: LookupGridComponent, public elementRef: ElementRef, public frameContext: FrameContext) {\r\n    super(frameContext, elementRef);\r\n  }\r\n  ngAfterViewInit(): void {\r\n    this.tryAddComponent(this.component);\r\n  }\r\n  ngOnInit(): void {\r\n    this.addComponent(this.component);\r\n  }\r\n  ngOnDestroy(): void {\r\n  }\r\n\r\n}","import { AfterViewInit, Directive, ElementRef, Injector, OnDestroy, OnInit } from \"@angular/core\";\r\nimport { FrameContext } from \"@farris/devkit\";\r\nimport { DatagridComponent } from '@farris/ui-datagrid';\r\nimport { ComponentRef } from \"./component-ref\";\r\n\r\n@Directive({\r\n  selector: '[datagridRef]'\r\n})\r\nexport class DatagridComponentRefDirective extends ComponentRef implements OnInit, OnDestroy, AfterViewInit {\r\n  constructor(private injector: Injector, private component: DatagridComponent, public elementRef: ElementRef, public frameContext: FrameContext) {\r\n    super(frameContext, elementRef);\r\n  }\r\n  ngAfterViewInit(): void {\r\n    this.tryAddComponent(this.component, this.component.id);\r\n  }\r\n  ngOnInit(): void {\r\n    this.addComponent(this.component);\r\n  }\r\n  ngOnDestroy(): void {\r\n  }\r\n\r\n}","import { AfterViewInit, Directive, ElementRef, Injector, OnDestroy, OnInit } from \"@angular/core\";\r\nimport { FrameContext } from \"@farris/devkit\";\r\nimport { TreeTableComponent } from '@farris/ui-treetable';\r\nimport { ComponentRef } from \"./component-ref\";\r\n\r\n@Directive({\r\n  selector: '[treetableRef]'\r\n})\r\nexport class TreetableComponentRefDirective extends ComponentRef implements OnInit, OnDestroy, AfterViewInit {\r\n  constructor(private injector: Injector, private component: TreeTableComponent, public elementRef: ElementRef, public frameContext: FrameContext) {\r\n    super(frameContext, elementRef);\r\n  }\r\n  ngAfterViewInit(): void {\r\n    this.tryAddComponent(this.component);\r\n  }\r\n  ngOnInit(): void {\r\n    this.addComponent(this.component);\r\n  }\r\n  ngOnDestroy(): void {\r\n  }\r\n\r\n}","import { AfterViewInit, Directive, ElementRef, Injector, OnDestroy, OnInit } from \"@angular/core\";\r\nimport { FrameContext } from \"@farris/devkit\";\r\nimport { WizardComponent } from '@farris/ui-wizard';\r\nimport { ComponentRef } from \"./component-ref\";\r\n\r\n@Directive({\r\n  selector: '[wizardRef]'\r\n})\r\nexport class WizardComponentRefDirective extends ComponentRef implements OnInit, OnDestroy, AfterViewInit {\r\n  constructor(private injector: Injector, private component: WizardComponent, public elementRef: ElementRef, public frameContext: FrameContext) {\r\n    super(frameContext, elementRef);\r\n  }\r\n  ngAfterViewInit(): void {\r\n    this.tryAddComponent(this.component);\r\n  }\r\n  ngOnInit(): void {\r\n    this.addComponent(this.component);\r\n  }\r\n  ngOnDestroy(): void {\r\n  }\r\n\r\n}","import { AfterViewInit, Directive, ElementRef, Injector, OnDestroy, OnInit } from \"@angular/core\";\r\nimport { FrameContext } from \"@farris/devkit\";\r\nimport { DiscussionEditorComponent } from '@farris/discussion-group';\r\nimport { ComponentRef } from \"./component-ref\";\r\n\r\n@Directive({\r\n  selector: '[discussionEditorRef]'\r\n})\r\nexport class DiscussionEditorComponentRefDirective extends ComponentRef implements OnInit, OnDestroy, AfterViewInit {\r\n  constructor(private injector: Injector, private component: DiscussionEditorComponent, public elementRef: ElementRef, public frameContext: FrameContext) { \r\n    super(frameContext, elementRef);\r\n  }\r\n  ngAfterViewInit(): void {\r\n    this.tryAddComponent(this.component);\r\n  }\r\n  ngOnInit(): void {\r\n    this.addComponent(this.component);\r\n  }\r\n  ngOnDestroy(): void {\r\n  }\r\n\r\n}","import { AfterViewInit, Directive, ElementRef, Injector, OnDestroy, OnInit } from \"@angular/core\";\r\nimport { FrameContext } from \"@farris/devkit\";\r\nimport { DiscussionListComponent } from '@farris/discussion-group';\r\nimport { ComponentRef } from \"./component-ref\";\r\n\r\n@Directive({\r\n  selector: '[discussionListRef]'\r\n})\r\nexport class DiscussionListComponentRefDirective extends ComponentRef implements OnInit, OnDestroy, AfterViewInit {\r\n  constructor(private injector: Injector, private component: DiscussionListComponent, public elementRef: ElementRef, public frameContext: FrameContext) {\r\n    super(frameContext, elementRef);\r\n  }\r\n  ngAfterViewInit(): void {\r\n    this.tryAddComponent(this.component);\r\n  }\r\n  ngOnInit(): void {\r\n    this.addComponent(this.component);\r\n  }\r\n  ngOnDestroy(): void {\r\n  }\r\n\r\n}","import { AfterViewInit, Directive, ElementRef, Injector, OnDestroy, OnInit } from \"@angular/core\";\r\nimport { FrameContext } from \"@farris/devkit\";\r\nimport { NavComponent } from '@farris/ui-nav';\r\nimport { ComponentRef } from \"./component-ref\";\r\n\r\n@Directive({\r\n  selector: '[navRef]'\r\n})\r\nexport class NavComponentRefDirective extends ComponentRef implements OnInit, OnDestroy, AfterViewInit {\r\n  constructor(private injector: Injector, private component: NavComponent, public elementRef: ElementRef, public frameContext: FrameContext) {\r\n    super(frameContext, elementRef);\r\n  }\r\n  ngAfterViewInit(): void {\r\n    this.tryAddComponent(this.component);\r\n  }\r\n  ngOnInit(): void {\r\n    this.addComponent(this.component);\r\n  }\r\n  ngOnDestroy(): void {\r\n  }\r\n\r\n}","import { AfterViewInit, Directive, ElementRef, Injector, OnDestroy, OnInit } from \"@angular/core\";\r\nimport { FrameContext } from \"@farris/devkit\";\r\nimport { MultiSelectComponent } from '@farris/ui-multi-select';\r\nimport { ComponentRef } from \"./component-ref\";\r\n\r\n@Directive({\r\n  selector: '[multiSelectRef]'\r\n})\r\nexport class MultiSelectComponentRefDirective extends ComponentRef implements OnInit, OnDestroy, AfterViewInit {\r\n  constructor(private injector: Injector, private component: MultiSelectComponent, public elementRef: ElementRef, public frameContext: FrameContext) { \r\n    super(frameContext, elementRef);\r\n  }\r\n  ngAfterViewInit(): void {\r\n    this.tryAddComponent(this.component);\r\n  }\r\n  ngOnInit(): void {\r\n    this.addComponent(this.component);\r\n  }\r\n  ngOnDestroy(): void {\r\n  }\r\n\r\n}","import { AfterViewInit, Directive, ElementRef, Injector, OnDestroy, OnInit } from \"@angular/core\";\r\nimport { FrameContext } from \"@farris/devkit\";\r\nimport { ScrollspyComponent } from '@farris/ui-scrollspy';\r\nimport { ComponentRef } from \"./component-ref\";\r\n\r\n@Directive({\r\n  selector: '[scrollspyRef]'\r\n})\r\nexport class ScrollspyComponentRefDirective extends ComponentRef implements OnInit, OnDestroy, AfterViewInit {\r\n  constructor(private injector: Injector, private component: ScrollspyComponent, public elementRef: ElementRef, public frameContext: FrameContext) {\r\n    super(frameContext, elementRef);\r\n  }\r\n  ngAfterViewInit(): void {\r\n    this.tryAddComponent(this.component);\r\n  }\r\n  ngOnInit(): void {\r\n    this.addComponent(this.component);\r\n  }\r\n  ngOnDestroy(): void {\r\n  }\r\n\r\n}","\r\n/**\r\n * ä½¿ç¨æ¹æ³ï¼\r\n * [comob-lookup-data-mapping]=\"{ id: 'user.userId', name: 'user.userName' }\"\r\n * key ä¸ºå¸®å©ä¸çå­æ®µï¼ value ä¸º è¡¨åä¸­çå­æ®µå\r\n * å¸®å©ä¸çåä¸ä¸ªå­æ®µå¯ä»¥æ å°å°è¡¨åä¸­çå¤ä¸ªå­æ®µä¸­ï¼{ ... id: 'user.userid, user.addusid'}\r\n * å¤å­æ®µä»¥éå·éå¼\r\n *\r\n */\r\n\r\nimport { Directive, OnInit, Optional, Self, Input } from '@angular/core';\r\nimport { BindingObject, NgFormControl, ViewModel } from '@farris/devkit';\r\nimport { ComboChanges } from '@farris/ui-combo-list';\r\nimport { ComboLookupComponent } from '@farris/ui-combo-lookup';\r\nimport { DataMapping } from './data-mapping';\r\n\r\n\r\n@Directive({ selector: '[combo-lookup-data-mapping]' })\r\nexport class ComboLookupDataMappingDirective extends DataMapping implements OnInit {\r\n  @Input('combo-lookup-data-mapping') mapfields: any;\r\n  @Input('target') target: BindingObject = null;\r\n\r\n  constructor(@Optional() public vm: ViewModel, @Optional() @Self() private lookup: ComboLookupComponent) {\r\n    super();\r\n    if (this.lookup) {\r\n      this.lookup.useFormDataMapping = true;\r\n    }\r\n  }\r\n\r\n  ngOnInit() {\r\n    // å¼ååï¼äº¦éè¿è¯¥äºä»¶è§¦åä»»æè¾å¥æ¸ç©ºäºä»¶\r\n    this.lookup.valueChange.subscribe((result: ComboChanges) => {\r\n      if (!result['nosearch']) {\r\n        // å¼åå\r\n        const data = result.selections && result.selections.length > 0 ? result.selections : null;\r\n        this.onValueChange(data);\r\n      } else {\r\n        // ä»»æè¾å¥æ¸ç©ºæ å°å­æ®µ\r\n        this.onClearMapping();\r\n      }\r\n    });\r\n    // æ¸ç©ºäºä»¶\r\n    this.lookup.clear.subscribe(() => {\r\n      const _mapfields = this.mapfields || this.lookup.mapFields;\r\n      this.mappingData(null, _mapfields);\r\n    });\r\n  }\r\n  private onClearMapping() {\r\n    const mapfields = Object.assign({}, (this.mapfields || this.lookup.mapFields || {}));\r\n    const lookupTextField = this.lookup.textField;\r\n    const data = {};\r\n    const controlName = this.lookup.ngControl && this.lookup.ngControl.name;\r\n    if (controlName && this.vm) {\r\n      const textFieldMapping = mapfields[lookupTextField];\r\n      const ngFormControl = this.vm && this.vm.form && this.vm.form.ngFormControls && this.vm.form.ngFormControls[controlName] as NgFormControl;\r\n      const binding = ngFormControl && ngFormControl.binding;\r\n      if (textFieldMapping && binding) {\r\n        const targetField = textFieldMapping.split(',').filter((item) => item !== binding).join(',');\r\n        if (targetField) {\r\n          mapfields[lookupTextField] = targetField;\r\n        } else {\r\n          delete mapfields[lookupTextField];\r\n        }\r\n      }\r\n    }\r\n    if (mapfields && Object.keys(mapfields).length > 0) {\r\n      Object.keys(mapfields).forEach((field) => {\r\n        this.setValue(data, field.split('.'), '');\r\n      });\r\n      this.mappingData(data, mapfields, true);\r\n    }\r\n  }\r\n  private onValueChange(data) {\r\n    const _mapfields = this.mapfields || this.lookup.mapFields;\r\n    const spliter = this.lookup.separator || this.defaultSpliter;\r\n    this.mappingData(data, _mapfields, false, spliter);\r\n  }\r\n}\r\n","import { Repository } from \"@farris/devkit\";\r\n\r\nexport abstract class BefRepository extends Repository<any>{\r\n  restService: BefRestService;\r\n}\r\nexport interface BefRestService {\r\n  request(url: string, method: string, params?: any, options?: any, selfHandError?: boolean, ignoreError?: boolean, ignoreChanges?: boolean);\r\n  buildRequestInfo();\r\n}\r\nexport enum ViewType {\r\n  day = 'day',\r\n  week = 'week'\r\n}","import {\r\n  Directive, OnInit, OnChanges, OnDestroy, SimpleChanges, HostListener, Injector, Input\r\n} from '@angular/core';\r\nimport { Subscription } from 'rxjs';\r\nimport { BindingData, BindingList, Change, ChangeType, ViewModel, FrameContext } from '@farris/devkit';\r\nimport { AppointmentCalendarComponent } from '@farris/appointment-calendar';\r\nimport { BefRestService, BefRepository, ViewType } from './types';\r\nimport { isEqual } from 'lodash-es';\r\nimport { BasePathService } from '@farris/rtf';\r\n\r\n@Directive({\r\n  selector: '[farris-appointment-calendar-binding]'\r\n})\r\nexport class AppointmentCalendarBindingDirective implements OnInit, OnChanges, OnDestroy {\r\n  private __DATA__: any;\r\n  private bindingDataChangeEvent: Subscription;\r\n  private get bindingData(): BindingData {\r\n    return this.frameContext.bindingData;\r\n  }\r\n  private get viewModel(): ViewModel {\r\n    return this.frameContext.viewModel;\r\n  }\r\n  private restService(): BefRestService {\r\n    return (this.frameContext.repository as BefRepository).restService;\r\n  }\r\n  /**\r\n   * è·åç»å®æ°æ®\r\n   */\r\n  protected get bindingList(): BindingList {\r\n    // æ ¹å®ä½\r\n    if (this.viewModel.bindingPath === '/' || !this.viewModel.bindingPath) {\r\n      return this.bindingData.list;\r\n    }\r\n    // å­å®ä½\r\n    let bindingPath = this.viewModel.bindingPath.substr(1);\r\n    bindingPath = bindingPath[0].toLowerCase() + bindingPath.substring(1, bindingPath.length);\r\n    const paths = bindingPath.split('/');\r\n\r\n    const filteredPaths = paths.filter((part: string) => {\r\n      return part !== '';\r\n    });\r\n    return this.bindingData.getValue(filteredPaths);\r\n  }\r\n  /**\r\n   * æ¿é´åè¡¨api url\r\n   */\r\n  @Input() url: string = null;\r\n  /**\r\n   * http method, default PUT\r\n   */\r\n  @Input() method: string = 'PUT';\r\n  @Input() startDateVariable: string = 'startDate';\r\n  @Input() endDateVariable: string = 'endDate';\r\n  @Input() viewTypeVariable: string = 'viewType';\r\n\r\n  constructor(private injector: Injector, private frameContext: FrameContext, private calendarComponent: AppointmentCalendarComponent) { }\r\n\r\n  ngOnInit(): void {\r\n    this.loadPlacements();\r\n    this.registerBindingDataChangeEvent();\r\n  }\r\n  ngOnChanges(changes: SimpleChanges): void {\r\n\r\n  }\r\n  ngOnDestroy(): void {\r\n    this.unRegisterBindingDataChangeEvent();\r\n  }\r\n  private bindData(change: Change) {\r\n    // åtoJSON\r\n    let data: any = this.bindingList.toJSON();\r\n    if (this.__DATA__ && isEqual(this.__DATA__, data)) {\r\n      return;\r\n    }\r\n    this.__DATA__ = data;\r\n    this.calendarComponent.loadReserveData(data);\r\n  }\r\n  private onBindingDataChange(change: Change) {\r\n    this.bindData(change);\r\n    this.updateSelectedRow(change);\r\n  }\r\n  private registerBindingDataChangeEvent() {\r\n    this.bindingDataChangeEvent = this.bindingData.changes.subscribe((change: Change) => {\r\n      this.onBindingDataChange(change);\r\n    });\r\n  }\r\n  /**\r\n   * åæ¶bindingdataååè®¢é\r\n   */\r\n  private unRegisterBindingDataChangeEvent() {\r\n    if (this.bindingDataChangeEvent && typeof (this.bindingDataChangeEvent.unsubscribe) === 'function') {\r\n      this.bindingDataChangeEvent.unsubscribe();\r\n    }\r\n  }\r\n  private loadPlacements() {\r\n    if (!this.url) {\r\n      console.log('æ æ³å è½½æ¿é´ä¿¡æ¯ï¼è¯·éç½®æ¿é´åè¡¨apiå°å');\r\n      return;\r\n    }\r\n    const requestInfo = this.restService().buildRequestInfo();\r\n    const options = {\r\n      body: {\r\n        requestInfo\r\n      }\r\n    };\r\n    const url = BasePathService.convertPath(this.url);\r\n    this.restService().request(url, this.method, null, options).subscribe((returnValue: any) => {\r\n      this.bindPlacements(returnValue);\r\n    });\r\n  }\r\n  private bindPlacements(placments: any) {\r\n    this.calendarComponent.loadPlaceData(placments);\r\n  }\r\n  private updateState(startDate: string, endDate: string, viewType: string) {\r\n    this.viewModel.uiState.setPropertyValue(this.startDateVariable, startDate);\r\n    this.viewModel.uiState.setPropertyValue(this.endDateVariable, endDate);\r\n    this.viewModel.uiState.setPropertyValue(this.viewTypeVariable, viewType);\r\n  }\r\n  private updateSelectedRow(change?: Change) {\r\n    if (!this.bindingList || !this.bindingList.currentId) {\r\n      return;\r\n    }\r\n    // é¡µç åæ¢æ¶ä¸æ§è¡å½åè¡åæ¢\r\n    if (change && change.type === ChangeType.PaginationInfoChange) {\r\n      return;\r\n    }\r\n    if (this.viewModel && this.viewModel.frameContext.bindingData.rowSelectedEventSuspend === true) {\r\n      return;\r\n    }\r\n    const id = this.calendarComponent.selectedId;\r\n    const currentId = this.bindingList.currentId;\r\n    // gridå½åè¡ä¸bingingListå½åè¡ä¸è´ï¼æ é¡»åæ¢\r\n    if (id === currentId) {\r\n      return;\r\n    }\r\n    this.selectCalendarRow(this.bindingList.currentId);\r\n  }\r\n  private selectCalendarRow(id: string) {\r\n    this.calendarComponent.selectItem(id);\r\n  }\r\n  @HostListener('filterChange', ['$event'])\r\n  public filterChanged(event: any) {\r\n    const { dateValue = null, place = null, viewType = null } = event || {};\r\n    let startDate = null;\r\n    let endDate = null;\r\n    if (!dateValue) {\r\n      return;\r\n    }\r\n    if (viewType === ViewType.day) {\r\n      startDate = `${dateValue} 00:00:00`;\r\n      endDate = `${dateValue} 23:59:59`;\r\n    } else if (viewType === ViewType.week && dateValue.indexOf('~') !== -1) {\r\n      const sections = dateValue.split('~');\r\n      startDate = `${sections[0]} 00:00:00`;\r\n      endDate = `${sections[1]} 23:59:59`;\r\n    }\r\n    this.updateState(startDate, endDate, viewType);\r\n  }\r\n  protected setSelectionIdToBindingData(id: string): void {\r\n    // å¦æå½åè¡ä¸å­å¨ï¼åå¼ºå¶è®¾ç½®\r\n    if (this.bindingList.currentId !== id) {\r\n      this.bindingList.setCurrentId(id, true);\r\n    }\r\n  }\r\n  @HostListener('selectChange', ['$event'])\r\n  public selectChange(event) {\r\n    const { item: { id = null } } = event;\r\n    this.setSelectionIdToBindingData(id);\r\n  }\r\n}\r\n","import { AfterViewInit, ChangeDetectorRef, Directive, ElementRef, Injector, Input, OnInit, OnChanges, SimpleChanges } from '@angular/core';\r\nimport { DatagridComponent } from '@farris/ui-datagrid';\r\nimport { FrameContext } from '@farris/devkit';\r\nimport { BefRepository, BefRestService } from '../appointment-calendar/types';\r\n\r\ntype SizeConfig = {\r\n  'headerHeight'?: number,\r\n  'footerHeight'?: number,\r\n  'rowHeight'?: number,\r\n  'checkboxColumnWidth'?: number,\r\n  'lineNumberWidth'?: number,\r\n  'filterRowHeight'?: number\r\n};\r\n\r\n\r\n@Directive({ selector: '[custom-size]' })\r\nexport class CustomDatagridSizeDirective implements OnInit, AfterViewInit, OnChanges {\r\n  @Input('custom-size') useCustomSize = false;\r\n  @Input() sizeApiUri = '';\r\n\r\n  private restService(): BefRestService {\r\n    return (this.frameContext.repository as BefRepository).restService;\r\n  }\r\n\r\n  constructor(private dg: DatagridComponent, private injector: Injector, private cd: ChangeDetectorRef, private el: ElementRef,\r\n    private frameContext: FrameContext) { }\r\n\r\n  ngOnInit(): void {\r\n\r\n  }\r\n\r\n  ngOnChanges(changes: SimpleChanges) {\r\n    if (changes.sizeApiUri && !changes.sizeApiUri.isFirstChange()) {\r\n      this.applyNewSize();\r\n    }\r\n  }\r\n\r\n  ngAfterViewInit(): void {\r\n    this.applyNewSize();\r\n  }\r\n\r\n  private applyNewSize() {\r\n    if (this.useCustomSize && this.sizeApiUri) {\r\n      this.getSizeConfig().subscribe((cfg: SizeConfig) => {\r\n        if (this.dg && typeof this.dg.applyNewSize === 'function') {\r\n          this.dg.applyNewSize(cfg);\r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n\r\n  private getSizeConfig() {\r\n    return this.restService().request(this.sizeApiUri, 'get');\r\n  }\r\n}\r\n","import { Directive, Injector, Input, OnDestroy, OnInit, Optional } from '@angular/core';\r\nimport { FrameContext } from '@farris/devkit';\r\nimport { FilterComponent } from '@farris/ui-filter';\r\nimport { Subject } from 'rxjs';\r\nimport { takeUntil } from 'rxjs/operators';\r\n\r\n@Directive({\r\n  selector: '[farris-filter-binding]'\r\n})\r\nexport class FarrisFilterBindingDirective implements OnInit, OnDestroy {\r\n  private $destroy: Subject<any>;\r\n  /**\r\n   * åéç¼å·ï¼é»è®¤ä¸ºfilterConditionList\r\n   */\r\n  @Input('variableCode') variableCode = 'filterConditionList';\r\n  constructor(\r\n    private injector: Injector,\r\n    private frameContext: FrameContext,\r\n    @Optional() private filterComponent: FilterComponent\r\n  ) {\r\n    this.$destroy = new Subject<any>();\r\n  }\r\n  ngOnDestroy(): void {\r\n    if (this.$destroy) {\r\n      this.$destroy.next();\r\n      this.$destroy.complete();\r\n    }\r\n  }\r\n  ngOnInit(): void {\r\n    if (this.filterComponent) {\r\n      this.filterComponent.conditionsChange.pipe(takeUntil(this.$destroy)).subscribe((event: any) => {\r\n        const { data = '[]' } = event || {};\r\n        this.setConditions(data);\r\n      });\r\n    }\r\n  }\r\n  private setConditions(conditions: string) {\r\n    this.frameContext.uiState.setPropertyValue(this.variableCode, conditions);\r\n  }\r\n}\r\n","import { Directive, Injector, Input, OnDestroy, OnInit, Optional } from '@angular/core';\r\nimport { FrameContext } from '@farris/devkit';\r\nimport { ListFilterComponent } from '@farris/ui-list-filter';\r\nimport { Subject } from 'rxjs';\r\nimport { takeUntil } from 'rxjs/operators';\r\n\r\n@Directive({\r\n  selector: '[farris-list-filter-binding]'\r\n})\r\nexport class FarrisListFilterBindingDirective implements OnInit, OnDestroy {\r\n  private $destroy: Subject<any>;\r\n  /**\r\n   * åéç¼å·ï¼é»è®¤ä¸ºfilterConditionList\r\n   */\r\n  @Input('variableCode') variableCode = 'filterConditionList';\r\n  constructor(\r\n    private injector: Injector,\r\n    private frameContext: FrameContext,\r\n    @Optional() private listFilterComponent: ListFilterComponent\r\n  ) {\r\n    this.$destroy = new Subject<any>();\r\n  }\r\n  ngOnDestroy(): void {\r\n    if (this.$destroy) {\r\n      this.$destroy.next();\r\n      this.$destroy.complete();\r\n    }\r\n  }\r\n  ngOnInit(): void {\r\n    if (this.listFilterComponent) {\r\n      this.listFilterComponent.conditionsChange.pipe(takeUntil(this.$destroy)).subscribe((event: any) => {\r\n        const { data = '[]' } = event || {};\r\n        this.setConditions(data);\r\n      });\r\n    }\r\n  }\r\n  private setConditions(conditions: string) {\r\n    this.frameContext.uiState.setPropertyValue(this.variableCode, conditions);\r\n  }\r\n}\r\n","import { Injector, Optional, Pipe, PipeTransform } from '@angular/core';\r\nimport { DownloadService } from '@gsp-svc/formdoc-upload';\r\nimport { BasePathService } from '@farris/rtf';\r\n@Pipe({ name: 'imageIdToUrl' })\r\nclass ImageIdToUrlPipe implements PipeTransform {\r\n  private defaultPic = BasePathService.convertPath('/platform/common/web/assets/imgs/no-pic.png');\r\n  private downloadService: DownloadService;\r\n  constructor(@Optional() private injector: Injector) {\r\n    this.downloadService = this.injector && this.injector.get<DownloadService>(DownloadService, null) || null;\r\n  }\r\n\r\n  transform(value: string, rootId: string = 'default-root'): string {\r\n    if (!value) {\r\n      return this.defaultPic;\r\n    }\r\n    //const rootId = 'default-root';\r\n    if (this.downloadService) {\r\n      return this.downloadService.getDownloadUrl(value, rootId);\r\n    } else {\r\n      console.warn('å å®å¨é®é¢ï¼éä»¶ä¸è½½æä¾å®å¨æ ¡éªæºå¶ï¼éä»¶ä¸è½½åè½ééæ°ç¼è¯ã');\r\n      return BasePathService.convertPath(`/api/runtime/dfs/v1.0/formdoc/download/${value}`);\r\n    }\r\n  }\r\n}\r\n\r\nexport { ImageIdToUrlPipe };\r\n","import { LocaleService } from '@farris/ui-locale';\r\nimport { Pipe, PipeTransform, Injector, Optional } from '@angular/core';\r\nimport { ColumnFormatService } from '@farris/ui-common/column';\r\n\r\n@Pipe({ name: 'formatPrimeNgTreeTableCellData', pure: false })\r\nexport class FormatPrimeNgTreeTableCellData implements PipeTransform {\r\n\r\n  private localeService: LocaleService;\r\n  constructor(private cfs: ColumnFormatService, @Optional() private injector?: Injector) {\r\n    if (this.injector) {\r\n      this.localeService = this.injector.get(LocaleService);\r\n    }\r\n  }\r\n\r\n  transform(col: any, rowData: any): any {\r\n    let value = '';\r\n    if (rowData && col && col.field) {\r\n      value = this.getValue(col.field, rowData);\r\n      let formatterFn = col.formatter;\r\n      if (!formatterFn) {\r\n        if (col.isMultilingualField) {\r\n          return this.getMultiLanguageValue(value);\r\n        } else {\r\n          return value;\r\n        }\r\n      } else {\r\n        return this.cfs.format(value, rowData, formatterFn);\r\n      }\r\n    }\r\n    return '';\r\n  }\r\n\r\n  // è·åå¤è¯­æ°æ®\r\n  private getMultiLanguageValue(valObj) {\r\n    if (valObj && typeof valObj === 'object' && Object.keys(valObj).length > 0) {\r\n      const localeId = this.localeService && this.localeService.localeId || 'zh-CHS';\r\n      const value = valObj[localeId];\r\n      return value === undefined ? '' : value;\r\n    } else {\r\n      return '';\r\n    }\r\n  }\r\n  private getValue(path: string, target: any) {\r\n    if (!target) {\r\n      return '';\r\n    }\r\n    var resultVal = '';\r\n    if (path.indexOf('.') === -1) {\r\n      resultVal = target[path];\r\n    }\r\n    else {\r\n      resultVal = path.split('.').reduce(((obj, key) => {\r\n        return obj && obj[key] || null;\r\n      }), target);\r\n    }\r\n    return resultVal;\r\n  };\r\n  /**\r\n   * æ¯å¦ä¸ºå¸®å©å\r\n   * @param col col\r\n   */\r\n  private isHelpColumn(col: any) {\r\n    return col && col.editor && col.editor.options && col.editor.options.type === 'EditorTypes.LOOKUP' || false;\r\n  }\r\n  private getHelpColumnValue(col: any, data: any) {\r\n    const textField = this.getHelpControlTextField(col);\r\n    const mapFields = this.getHelpControlMapFields(col);\r\n    if (textField && mapFields && Object.keys(mapFields).length > 0) {\r\n      const path = mapFields[textField];\r\n      return this.getValue(path, data);\r\n    }\r\n    return '';\r\n  }\r\n  private getHelpControlTextField(col: any) {\r\n    return col && col.editor && col.editor.options && col.editor.options.textField || '';\r\n  }\r\n  private getHelpControlMapFields(col: any) {\r\n    return col && col.editor && col.editor.options && col.editor.options.mapFields || {};\r\n  }\r\n}\r\n","import { Inject, Injector, Optional, Pipe, PipeTransform } from \"@angular/core\";\r\nimport { NumberFormat, UserSettings, UserSettingsToken } from \"@farris/devkit\";\r\nimport { BigNumber } from 'bignumber.js';\r\nimport moment from 'moment';\r\n\r\n@Pipe({ name: 'localization' })\r\nexport class Localization implements PipeTransform {\r\n  constructor(@Optional() private injector: Injector, @Inject(UserSettingsToken) private userSettings: UserSettings) {\r\n  }\r\n  public transform(value: any, dataType: string) {\r\n    if (dataType) {\r\n      dataType = dataType.toLowerCase();\r\n      if (dataType === 'date') {\r\n        return this.transformDate(value);\r\n      } else if (dataType === 'datetime') {\r\n        return this.transformDateTime(value);\r\n      } else if (dataType === 'number') {\r\n        return this.transformNumber(value);\r\n      } else {\r\n        return value;\r\n      }\r\n    }\r\n  }\r\n  /**\r\n   * è½¬æ¢æ¥æ\r\n   * @param value value\r\n   */\r\n  private transformDate(value: any) {\r\n    let dateFormat = this.userSettings && this.userSettings.dateFormat || null;\r\n    if (!dateFormat || !value) {\r\n      return value;\r\n    }\r\n    const date = moment(value);\r\n    const isValid = date.isValid();\r\n    if (!isValid) {\r\n      return value;\r\n    }\r\n    dateFormat = this.parseDateFormat(dateFormat);\r\n    return date.format(dateFormat);\r\n  }\r\n  /**\r\n   * è½¬æ¢æ¥ææ¶é´\r\n   * @param value value\r\n   * todo: ç®åæ æ³å®ä¹æ¥ææ¶é´æ ¼å¼\r\n   */\r\n  private transformDateTime(value: any) {\r\n    let dateFormat = this.userSettings && this.userSettings.dateFormat || '';\r\n    let timeFormat = this.userSettings && this.userSettings.timeFormat || '';\r\n    const dateTime = moment(value);\r\n    const isValid = dateTime.isValid();\r\n    if (!isValid) {\r\n      return value;\r\n    }\r\n    if (dateFormat) {\r\n      dateFormat = this.parseDateFormat(dateFormat);\r\n    }\r\n    if (timeFormat) {\r\n      timeFormat = this.parseTimeFormat(timeFormat);\r\n    }\r\n    const dateTimeFormat = dateFormat + ' ' + timeFormat;\r\n    return dateTime.format(dateTimeFormat);\r\n  }\r\n  /**\r\n   * è½¬æ¢æ°å­\r\n   * @param value value\r\n   */\r\n  private transformNumber(value): string {\r\n    if (value === null || value === undefined || value === '') {\r\n      return '';\r\n    }\r\n    const bigNumber = new BigNumber(value);\r\n    // å¦æä¸æ¯æ°å­ï¼ä¸åä»»ä½å¤ç\r\n    if (!BigNumber.isBigNumber(bigNumber)) {\r\n      return value;\r\n    }\r\n    const isNegative = bigNumber.isNegative();\r\n    const format = this.buildNumberFormat();\r\n    const { negativeSign = null, numberDecimalDigits = null } = this.numberFormat;\r\n    if (isNegative) {\r\n      if (negativeSign !== null) {\r\n        format.prefix = negativeSign;\r\n        return bigNumber.absoluteValue().toFormat(numberDecimalDigits, null, format);\r\n      }\r\n    }\r\n    return bigNumber.toFormat(numberDecimalDigits, null, format);\r\n  }\r\n  /**\r\n   * è½¬æ¢æ¥ææ ¼å¼è§åä¸ºmomentçformatè§å\r\n   * @param format format\r\n   */\r\n  private parseDateFormat(format: string) {\r\n    return format.replace(/y/g, 'Y').replace(/d/g, 'D');\r\n  }\r\n  /**\r\n   * è½¬æ¢æ¶é´æ ¼å¼è§åä¸ºmomentçformatè§å\r\n   * @param format format\r\n   */\r\n  private parseTimeFormat(format: string) {\r\n    return format.replace(/M/g, 'm');\r\n  }\r\n  /**\r\n   * æé bignumberæ°å­æ ¼å¼åéé¡¹\r\n   */\r\n  private buildNumberFormat() {\r\n    if (this.numberFormat) {\r\n      const { numberDecimalSeparator = null, numberGroupSeparator = null } = this.numberFormat;\r\n      const format: any = {\r\n        groupSize: 3,\r\n      };\r\n      if (numberDecimalSeparator !== null) {\r\n        format.decimalSeparator = numberDecimalSeparator;\r\n      }\r\n      if (numberGroupSeparator !== null) {\r\n        format.groupSeparator = numberGroupSeparator;\r\n      }\r\n      return format;\r\n    }\r\n  }\r\n  private get numberFormat(): NumberFormat {\r\n    return this.userSettings && this.userSettings.numberFormat || null;\r\n  }\r\n}","import { DialogService } from '@farris/ui-dialog';\r\nimport { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { GridComponent } from '@progress/kendo-angular-grid';\r\nimport { FarrisCommonModule } from '@farris/ui-common';\r\nimport {\r\n  KendoGridBindingDirective,\r\n  FarrisTreeTableBindingDirective,\r\n  LookupDataMappingDirective,\r\n  LookupEnableExtendLoadMethodDirective,\r\n  UIStateBindingDirective,\r\n  FarrisDisabledDirective,\r\n  FarrisDynamicColumnFormatDirective,\r\n  FarrisEditEnterDirective,\r\n  FarrisTextareaEditDirective,\r\n  FarrisSortDirective,\r\n  FarrisTreeTableFormatDirective,\r\n  GridColumnAggregateDirective,\r\n  GridSummaryDirective,\r\n  FarrisDatagridUseBindingDataDirective,\r\n  MultiSelectDataMappingDirective,\r\n  FarrisListViewBindingDirective,\r\n  EditableDirective,\r\n  InputEndEditDirective,\r\n  FarrisDataGridEndEditDirective,\r\n  HtmlEditorEndEditDirective,\r\n  KendoGridEndEditDirective,\r\n  FarrisDataGridRemoteSummaryDirective,\r\n  FarrisFilePreviewBindingDirective,\r\n  FarrisSetFocusDirective,\r\n  FarrisDiscussionEditorBindingDirective,\r\n  FarrisDiscussionListBindingDirective,\r\n  FarrisPrimengTreeTableBindingDirective,\r\n  FarrisDynamicRequiredDirective,\r\n  FarrisEditorDirective,\r\n  FarrisQuerySolutionEventBindDirective,\r\n  FarrisDateLocalizationDirective,\r\n  FarrisNumberLocalizationDirective,\r\n  FarrisTimeLocalizationDirective,\r\n  FarrisTextLocalizationDirective,\r\n  FarrisCheckboxModificationDirective,\r\n  FarrisLabelModificationDirective,\r\n  FarrisLookupBindingDirective,\r\n  ListNavComponentRefDirective,\r\n  ListViewComponentRefDirective,\r\n  ListFilterComponentRefDirective,\r\n  ViewChangeComponentRefDirective,\r\n  FilterComponentRefDirective,\r\n  SectionComponentRefDirective,\r\n  HtmlEditorComponentRefDirective,\r\n  InputGroupComponentRefDirective,\r\n  DatepickerComponentRefDirective,\r\n  TimePickerComponentRefDirective,\r\n  NumberSpinnerComponentRefDirective,\r\n  ComboListComponentRefDirective,\r\n  ComboLookupComponentRefDirective,\r\n  LookupGridComponentRefDirective,\r\n  DatagridComponentRefDirective,\r\n  TreetableComponentRefDirective,\r\n  WizardComponentRefDirective,\r\n  DiscussionEditorComponentRefDirective,\r\n  DiscussionListComponentRefDirective,\r\n  NavComponentRefDirective,\r\n  MultiSelectComponentRefDirective,\r\n  ScrollspyComponentRefDirective,\r\n  ComboLookupDataMappingDirective,\r\n  AppointmentCalendarBindingDirective,\r\n  CustomDatagridSizeDirective,\r\n  FarrisFilterBindingDirective,\r\n  FarrisListFilterBindingDirective\r\n} from './directives/index';\r\nimport {\r\n  FarrisKendoGridFormatService, FarrisTreetableFormatService, StringToDatePipe,\r\n  DateFormatPlaceholderPipe, KendoGridFilterDirective, FormatTotalPipe\r\n} from './format/index';\r\nimport { ImageIdToUrlPipe, FormatPrimeNgTreeTableCellData, Localization } from './pipes/index';\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    FarrisCommonModule.forRoot()\r\n  ],\r\n  declarations: [\r\n    KendoGridBindingDirective,\r\n    FarrisTreeTableBindingDirective,\r\n    LookupDataMappingDirective,\r\n    LookupEnableExtendLoadMethodDirective,\r\n    UIStateBindingDirective,\r\n    FarrisDisabledDirective,\r\n    FarrisSortDirective,\r\n    FarrisDynamicColumnFormatDirective,\r\n    FarrisEditEnterDirective,\r\n    FarrisTextareaEditDirective,\r\n    FarrisTreeTableFormatDirective,\r\n    StringToDatePipe,\r\n    GridColumnAggregateDirective,\r\n    GridSummaryDirective,\r\n    DateFormatPlaceholderPipe,\r\n    ImageIdToUrlPipe,\r\n    FormatPrimeNgTreeTableCellData,\r\n    FarrisDatagridUseBindingDataDirective,\r\n    MultiSelectDataMappingDirective,\r\n    FarrisListViewBindingDirective,\r\n    EditableDirective,\r\n    KendoGridFilterDirective,\r\n    FormatTotalPipe,\r\n    InputEndEditDirective,\r\n    FarrisDataGridEndEditDirective,\r\n    HtmlEditorEndEditDirective,\r\n    KendoGridEndEditDirective,\r\n    FarrisDataGridRemoteSummaryDirective,\r\n    FarrisFilePreviewBindingDirective,\r\n    FarrisSetFocusDirective,\r\n    FarrisDiscussionEditorBindingDirective,\r\n    FarrisDiscussionListBindingDirective,\r\n    FarrisPrimengTreeTableBindingDirective,\r\n    FarrisDynamicRequiredDirective,\r\n    FarrisEditorDirective,\r\n    FarrisQuerySolutionEventBindDirective,\r\n    FarrisDateLocalizationDirective,\r\n    FarrisNumberLocalizationDirective,\r\n    FarrisTimeLocalizationDirective,\r\n    FarrisTextLocalizationDirective,\r\n    Localization,\r\n    FarrisCheckboxModificationDirective,\r\n    FarrisLabelModificationDirective,\r\n    FarrisLookupBindingDirective,\r\n    ListNavComponentRefDirective,\r\n    ListViewComponentRefDirective,\r\n    ListFilterComponentRefDirective,\r\n    ViewChangeComponentRefDirective,\r\n    FilterComponentRefDirective,\r\n    SectionComponentRefDirective,\r\n    HtmlEditorComponentRefDirective,\r\n    InputGroupComponentRefDirective,\r\n    DatepickerComponentRefDirective,\r\n    TimePickerComponentRefDirective,\r\n    NumberSpinnerComponentRefDirective,\r\n    ComboListComponentRefDirective,\r\n    ComboLookupComponentRefDirective,\r\n    LookupGridComponentRefDirective,\r\n    DatagridComponentRefDirective,\r\n    TreetableComponentRefDirective,\r\n    WizardComponentRefDirective,\r\n    DiscussionEditorComponentRefDirective,\r\n    DiscussionListComponentRefDirective,\r\n    NavComponentRefDirective,\r\n    MultiSelectComponentRefDirective,\r\n    ScrollspyComponentRefDirective,\r\n    ComboLookupDataMappingDirective,\r\n    AppointmentCalendarBindingDirective,\r\n    CustomDatagridSizeDirective,\r\n    FarrisFilterBindingDirective,\r\n    FarrisListFilterBindingDirective\r\n  ],\r\n  providers: [\r\n    DialogService, GridComponent, FarrisKendoGridFormatService, FarrisTreetableFormatService],\r\n  exports: [\r\n    KendoGridBindingDirective,\r\n    FarrisTreeTableBindingDirective,\r\n    LookupDataMappingDirective,\r\n    LookupEnableExtendLoadMethodDirective,\r\n    UIStateBindingDirective,\r\n    FarrisDisabledDirective,\r\n    FarrisSortDirective,\r\n    FarrisDynamicColumnFormatDirective,\r\n    FarrisEditEnterDirective,\r\n    FarrisTextareaEditDirective,\r\n    FarrisTreeTableFormatDirective,\r\n    StringToDatePipe,\r\n    GridColumnAggregateDirective,\r\n    DateFormatPlaceholderPipe,\r\n    ImageIdToUrlPipe,\r\n    FormatPrimeNgTreeTableCellData,\r\n    FarrisDatagridUseBindingDataDirective,\r\n    MultiSelectDataMappingDirective,\r\n    FarrisListViewBindingDirective,\r\n    EditableDirective,\r\n    KendoGridFilterDirective,\r\n    FormatTotalPipe,\r\n    InputEndEditDirective,\r\n    FarrisDataGridEndEditDirective,\r\n    HtmlEditorEndEditDirective,\r\n    KendoGridEndEditDirective,\r\n    FarrisDataGridRemoteSummaryDirective,\r\n    FarrisFilePreviewBindingDirective,\r\n    FarrisSetFocusDirective,\r\n    FarrisDiscussionEditorBindingDirective,\r\n    FarrisDiscussionListBindingDirective,\r\n    FarrisPrimengTreeTableBindingDirective,\r\n    FarrisDynamicRequiredDirective,\r\n    FarrisEditorDirective,\r\n    FarrisQuerySolutionEventBindDirective,\r\n    FarrisDateLocalizationDirective,\r\n    FarrisNumberLocalizationDirective,\r\n    FarrisTimeLocalizationDirective,\r\n    FarrisTextLocalizationDirective,\r\n    Localization,\r\n    FarrisCheckboxModificationDirective,\r\n    FarrisLabelModificationDirective,\r\n    FarrisLookupBindingDirective,\r\n    ListNavComponentRefDirective,\r\n    ListViewComponentRefDirective,\r\n    ListFilterComponentRefDirective,\r\n    ViewChangeComponentRefDirective,\r\n    FilterComponentRefDirective,\r\n    SectionComponentRefDirective,\r\n    HtmlEditorComponentRefDirective,\r\n    InputGroupComponentRefDirective,\r\n    DatepickerComponentRefDirective,\r\n    TimePickerComponentRefDirective,\r\n    NumberSpinnerComponentRefDirective,\r\n    ComboListComponentRefDirective,\r\n    ComboLookupComponentRefDirective,\r\n    LookupGridComponentRefDirective,\r\n    DatagridComponentRefDirective,\r\n    TreetableComponentRefDirective,\r\n    WizardComponentRefDirective,\r\n    DiscussionEditorComponentRefDirective,\r\n    DiscussionListComponentRefDirective,\r\n    NavComponentRefDirective,\r\n    MultiSelectComponentRefDirective,\r\n    ScrollspyComponentRefDirective,\r\n    ComboLookupDataMappingDirective,\r\n    AppointmentCalendarBindingDirective,\r\n    CustomDatagridSizeDirective,\r\n    FarrisFilterBindingDirective,\r\n    FarrisListFilterBindingDirective\r\n  ]\r\n})\r\nclass KendoBindingModule {\r\n}\r\n\r\nexport { KendoBindingModule };\r\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public-api';\n\nexport {ComponentRef as Éµc} from './lib/directives/component-ref/component-ref';\nexport {DataMapping as Éµa} from './lib/directives/data-mapping';\nexport {AbstractEndEdit as Éµb} from './lib/directives/end-edit/abstract_end_edit';"],"names":["DateUtil","column","Injectable","DateTimeHelperService","NumberHelperService","Pipe","tslib_1.__extends","Directive","DropDownListComponent","FilterService","Input","HostListener","BaseFilterCellComponent","ViewModel","ColumnComponent","NgZone","BindingData","EventEmitter","ComponentType","ChangeType","of","tslib_1.__values","UIState","Optional","FrameEventBus","GridComponent","SelectionDirective","DialogService","RuntimeStateService","Output","ContentChildren","DataBindingDirective","Subject","debounceTime","TreeTableComponent","FrameContext","isNumber","LookupGridComponent","Self","ComboBoxComponent","Host","KeyValueDiffers","ComboListComponent","ComboLookupComponent","ElementRef","Renderer2","ENABLE_EDIT_STATE_FILTER_SORTING","RunMode","DataTypeInfo","ExpressionUtil","EntityPathConverter","finalize","DatagridComponent","MultiSelectComponent","ListViewComponent","Injector","AppContext","HtmlEditorComponent","BehaviorSubject","BindingList","FFilePreviewComponent","UploadAndPreviewComponent","tap","catchError","EMPTY","DiscussionEditorComponent","KEY_UISTATE_REPLY_MESSAGE","KEY_MESSAGE_ON_COMMENT_ADD","DiscussionListComponent","DiscussionListDirective","TreeTable","EditorComponent","QuerySolutionComponent","Inject","UserSettingsToken","FarrisDatepickerComponent","NumberSpinnerComponent","TimePickerComponent","date","BigNumber","TextComponent","ListNavComponent","ListFilterComponent","FilterComponent","ViewChangeComponent","FarrisSectionComponent","InputGroupComponent","WizardComponent","NavComponent","ScrollspyComponent","Repository","isEqual","BasePathService","AppointmentCalendarComponent","ChangeDetectorRef","takeUntil","DownloadService","LocaleService","ColumnFormatService","NgModule","CommonModule","FarrisCommonModule"],"mappings":";;;;;;;;;QAIE,wBAAoB,SAAuB;YAAvB,0BAAA;gBAAA,eAAuB;;YAAvB,cAAS,GAAT,SAAS,CAAc;SAC1C;QAED,oCAAW,GAAX,UAAY,KAAa;YACvB,OAAO,KAAK,CAAC,KAAK,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;SACpC;QAED,kCAAS,GAAT,UAAU,KAAe;YACvB,OAAO,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;SACnC;QACH,qBAAC;IAAD,CAAC;;ICdD;;;;;;AAMA,IAEA;;;AAGA;;;;;QAME,uBAAoB,MAAc;YAAd,WAAM,GAAN,MAAM,CAAQ;SACjC;;;;;QAMD,mCAAW,GAAX,UAAY,KAAa;YACvB,IAAIA,eAAQ,CAAC,iBAAiB,CAAC,KAAK,CAAC,KAAK,IAAI,EAAE;gBAC9C,OAAO,IAAI,CAAC;aACb;YAED,OAAOA,eAAQ,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC;SAC9B;;;;;QAMD,iCAAS,GAAT,UAAU,KAAW;YACnB,IAAI,CAAC,KAAK,EAAE;gBACV,OAAO,IAAI,CAAC;aACb;;YAED,IAAI,MAAM,CAAC,SAAS,CAAC,QAAQ,CAAC,IAAI,CAAC,KAAK,CAAC,KAAK,eAAe,EAAE;gBAC7D,OAAO,KAAK,CAAC;aACd;;YAED,IAAI,IAAI,GAAG,KAAK,CAAC,WAAW,EAAE,CAAC,QAAQ,EAAE,CAAC;YAC1C,IAAI,GAAG,IAAI,CAAC,MAAM,GAAG,CAAC,GAAG,GAAG,CAAC,MAAM,CAAC,CAAC,GAAG,IAAI,CAAC,MAAM,CAAC,GAAG,IAAI,GAAG,IAAI,CAAC;;YAEnE,IAAI,KAAK,GAAG,CAAC,KAAK,CAAC,QAAQ,EAAE,GAAG,CAAC,EAAE,QAAQ,EAAE,CAAC;YAC9C,KAAK,GAAG,KAAK,CAAC,MAAM,KAAK,CAAC,IAAI,GAAG,GAAG,KAAK,IAAI,KAAK,CAAC;;YAGnD,IAAI,GAAG,GAAG,KAAK,CAAC,OAAO,EAAE,CAAC,QAAQ,EAAE,CAAC;YACrC,GAAG,GAAG,GAAG,CAAC,MAAM,KAAK,CAAC,IAAI,GAAG,GAAG,GAAG,IAAI,GAAG,CAAC;;YAG3C,IAAI,KAAK,GAAG,KAAK,CAAC,QAAQ,EAAE,CAAC,QAAQ,EAAE,CAAC;YACxC,KAAK,GAAG,KAAK,CAAC,MAAM,KAAK,CAAC,IAAI,GAAG,GAAG,KAAK,IAAI,KAAK,CAAC;YAEnD,IAAI,OAAO,GAAG,KAAK,CAAC,UAAU,EAAE,CAAC,QAAQ,EAAE,CAAC;YAC5C,OAAO,GAAG,OAAO,CAAC,MAAM,KAAK,CAAC,IAAI,GAAG,GAAG,OAAO,IAAI,OAAO,CAAC;YAE3D,IAAI,OAAO,GAAG,KAAK,CAAC,UAAU,EAAE,CAAC,QAAQ,EAAE,CAAC;YAC5C,OAAO,GAAG,OAAO,CAAC,MAAM,KAAK,CAAC,IAAI,GAAG,GAAG,OAAO,IAAI,OAAO,CAAC;YAC3D,OAAU,IAAI,SAAI,KAAK,SAAI,GAAG,SAAI,KAAK,SAAI,OAAO,SAAI,OAAS,CAAC;SACjE;QACH,oBAAC;IAAD,CAAC;;IC1DD;;;AAGA;;;;QAKE;SACC;;;;QAKM,wCAAW,GAAlB,UAAmB,KAAa;YAC9B,IAAM,qBAAqB,GAAG,MAAM,CAAC,MAAM,CAAC,EAAE,EAAE,KAAK,CAAC,CAAC;YACvD,OAAO,qBAAqB,CAAC;SAC9B;;;;QAKM,sCAAS,GAAhB,UAAiB,qBAA0B;YACzC,IAAM,KAAK,GAAG,qBAAqB,CAAC;YACpC,OAAO,KAAK,CAAC;SACd;QAEH,yBAAC;IAAD,CAAC;;;QC/BC;SACC;QAED,+CAAW,GAAX,UAAY,gBAAwB;YAClC,IAAI,CAAC,gBAAgB,EAAE;gBACrB,OAAO,EAAE,CAAC;aACX;YACD,OAAO,IAAI,CAAC,KAAK,CAAC,gBAAgB,CAAC,CAAC;SACrC;QAED,6CAAS,GAAT,UAAU,UAAiB;YACzB,OAAO,IAAI,CAAC,SAAS,CAAC,UAAU,CAAC,CAAC;SACnC;QACH,gCAAC;IAAD,CAAC;;ICjBD;;;;;;;;;;;;;;IAcA;IAEA,IAAI,aAAa,GAAG,UAAS,CAAC,EAAE,CAAC;QAC7B,aAAa,GAAG,MAAM,CAAC,cAAc;aAChC,EAAE,SAAS,EAAE,EAAE,EAAE,YAAY,KAAK,IAAI,UAAU,CAAC,EAAE,CAAC,IAAI,CAAC,CAAC,SAAS,GAAG,CAAC,CAAC,EAAE,CAAC;YAC5E,UAAU,CAAC,EAAE,CAAC,IAAI,KAAK,IAAI,CAAC,IAAI,CAAC;gBAAE,IAAI,CAAC,CAAC,cAAc,CAAC,CAAC,CAAC;oBAAE,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC;QAC/E,OAAO,aAAa,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;IAC/B,CAAC,CAAC;AAEF,aAAgB,SAAS,CAAC,CAAC,EAAE,CAAC;QAC1B,aAAa,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;QACpB,SAAS,EAAE,KAAK,IAAI,CAAC,WAAW,GAAG,CAAC,CAAC,EAAE;QACvC,CAAC,CAAC,SAAS,GAAG,CAAC,KAAK,IAAI,GAAG,MAAM,CAAC,MAAM,CAAC,CAAC,CAAC,IAAI,EAAE,CAAC,SAAS,GAAG,CAAC,CAAC,SAAS,EAAE,IAAI,EAAE,EAAE,CAAC,CAAC;IACzF,CAAC;AAED,IAAO,IAAI,QAAQ,GAAG;QAClB,QAAQ,GAAG,MAAM,CAAC,MAAM,IAAI,SAAS,QAAQ,CAAC,CAAC;YAC3C,KAAK,IAAI,CAAC,EAAE,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,SAAS,CAAC,MAAM,EAAE,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE,EAAE;gBACjD,CAAC,GAAG,SAAS,CAAC,CAAC,CAAC,CAAC;gBACjB,KAAK,IAAI,CAAC,IAAI,CAAC;oBAAE,IAAI,MAAM,CAAC,SAAS,CAAC,cAAc,CAAC,IAAI,CAAC,CAAC,EAAE,CAAC,CAAC;wBAAE,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;aAChF;YACD,OAAO,CAAC,CAAC;SACZ,CAAA;QACD,OAAO,QAAQ,CAAC,KAAK,CAAC,IAAI,EAAE,SAAS,CAAC,CAAC;IAC3C,CAAC,CAAA;AAED,aAoEgB,QAAQ,CAAC,CAAC;QACtB,IAAI,CAAC,GAAG,OAAO,MAAM,KAAK,UAAU,IAAI,CAAC,CAAC,MAAM,CAAC,QAAQ,CAAC,EAAE,CAAC,GAAG,CAAC,CAAC;QAClE,IAAI,CAAC;YAAE,OAAO,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;QACxB,OAAO;YACH,IAAI,EAAE;gBACF,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,MAAM;oBAAE,CAAC,GAAG,KAAK,CAAC,CAAC;gBACnC,OAAO,EAAE,KAAK,EAAE,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,IAAI,EAAE,CAAC,CAAC,EAAE,CAAC;aAC3C;SACJ,CAAC;IACN,CAAC;AAED,aAAgB,MAAM,CAAC,CAAC,EAAE,CAAC;QACvB,IAAI,CAAC,GAAG,OAAO,MAAM,KAAK,UAAU,IAAI,CAAC,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC;QAC3D,IAAI,CAAC,CAAC;YAAE,OAAO,CAAC,CAAC;QACjB,IAAI,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,EAAE,GAAG,EAAE,EAAE,CAAC,CAAC;QACjC,IAAI;YACA,OAAO,CAAC,CAAC,KAAK,KAAK,CAAC,IAAI,CAAC,EAAE,GAAG,CAAC,KAAK,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,IAAI,EAAE,EAAE,IAAI;gBAAE,EAAE,CAAC,IAAI,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC;SAC9E;QACD,OAAO,KAAK,EAAE;YAAE,CAAC,GAAG,EAAE,KAAK,EAAE,KAAK,EAAE,CAAC;SAAE;gBAC/B;YACJ,IAAI;gBACA,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,IAAI,KAAK,CAAC,GAAG,CAAC,CAAC,QAAQ,CAAC,CAAC;oBAAE,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;aACpD;oBACO;gBAAE,IAAI,CAAC;oBAAE,MAAM,CAAC,CAAC,KAAK,CAAC;aAAE;SACpC;QACD,OAAO,EAAE,CAAC;IACd,CAAC;AAED,aAAgB,QAAQ;QACpB,KAAK,IAAI,EAAE,GAAG,EAAE,EAAE,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,SAAS,CAAC,MAAM,EAAE,CAAC,EAAE;YAC9C,EAAE,GAAG,EAAE,CAAC,MAAM,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;QACzC,OAAO,EAAE,CAAC;IACd,CAAC;;;QCrIG,sCAAoB,WAAkC,EAAU,aAAkC;YAA9E,gBAAW,GAAX,WAAW,CAAuB;YAAU,kBAAa,GAAb,aAAa,CAAqB;SACjG;;;;;;QAOD,sDAAe,GAAf,UAAgB,QAAa,EAAEC,SAAW;YACtC,IAAM,KAAK,GAAG,IAAI,CAAC,QAAQ,CAAC,QAAQ,EAAEA,SAAM,CAAC,WAAW,CAAC,CAAC,CAAC;;YAE3D,IAAM,IAAI,GAAGA,SAAM,CAAC,UAAU,CAAC,CAAC;YAChC,IAAI,IAAI,KAAK,MAAM,EAAE;gBACjB,OAAO,IAAI,CAAC,WAAW,CAAC,KAAK,EAAEA,SAAM,CAAC,CAAC;aAC1C;iBAAM,IAAI,IAAI,KAAK,SAAS,EAAE;gBAC3B,OAAO,KAAK,GAAG,GAAG,GAAG,GAAG,CAAC;aAC5B;iBAAM,IAAI,IAAI,KAAK,MAAM,EAAE;gBACxB,OAAO,IAAI,CAAC,aAAa,CAAC,KAAK,EAAEA,SAAM,CAAC,CAAC;aAC5C;iBAAM,IAAI,IAAI,KAAK,QAAQ,EAAE;gBAC1B,OAAO,IAAI,CAAC,eAAe,CAAC,KAAK,EAAEA,SAAM,CAAC,CAAC;aAC9C;iBAAM;;gBAEH,OAAO,IAAI,CAAC,YAAY,CAAC,KAAK,EAAEA,SAAM,CAAC,CAAC;aAC3C;SACJ;;;;;;QAOO,+CAAQ,GAAhB,UAAiB,QAAa,EAAE,KAAa;YACzC,IAAM,KAAK,GAAG,KAAK,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC;YACjC,IAAI,KAAK,GAAG,CAAC,EAAE;gBACX,OAAO,QAAQ,CAAC,KAAK,CAAC,CAAC;aAC1B;YACD,IAAM,MAAM,GAAG,KAAK,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;;YAEhC,IAAM,CAAC,GAAG,MAAM,CAAC,MAAM,CAAC,UAAC,MAAW,EAAE,IAAS;gBAC3C,OAAO,MAAM,CAAC,IAAI,CAAC,CAAC;aACvB,EAAE,QAAQ,CAAC,CAAC;YACb,OAAO,CAAC,CAAC;SACZ;;;;QAKO,kDAAW,GAAnB,UAAoB,KAAU,EAAEA,SAAW;YACvC,IAAM,QAAQ,GAAIA,SAAc,CAAC,QAAQ,CAAC;YAC1C,IAAI,CAAC,QAAQ,EAAE;gBACX,OAAO;aACV;YACD,IAAI,cAAmB,CAAC;YACxB,QAAQ,CAAC,OAAO,CAAC,UAAC,GAAQ;gBACtB,IAAI,GAAG,CAAC,KAAK,KAAK,KAAK,EAAE;oBACrB,cAAc,GAAG,GAAG,CAAC,IAAI,CAAC;iBAC7B;aACJ,CAAC,CAAC;YACH,OAAO,cAAc,CAAC;SACzB;;;;;;QAOM,oDAAa,GAApB,UAAqB,KAAa,EAAEA,SAAW;YAE3C,IAAID,eAAQ,CAAC,iBAAiB,CAAC,KAAK,CAAC,KAAK,IAAI,EAAE;gBAC9C,OAAO,EAAE,CAAC;aACX;YAED,IAAM,UAAU,GAAIC,SAAc,CAAC,MAAM,CAAC;YAC1C,IAAI,CAAC,UAAU,EAAE;gBACb,OAAO,KAAK,CAAC;aAChB;YACD,OAAO,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC,KAAK,EAAE,UAAU,CAAC,CAAC;SACvD;;;;;;;QAQO,sDAAe,GAAvB,UAAwB,KAAU,EAAEA,SAAW;YAC3C,IAAI,SAAS,CAAC;YACd,IAAIA,SAAM,IAAIA,SAAM,CAAC,MAAM,EAAE;gBACzB,SAAS,GAAG,QAAQ,CAACA,SAAM,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC;aACrD;iBAAM,IAAIA,SAAM,IAAIA,SAAM,CAAC,MAAM,EAAE;gBAChC,SAAS,GAAGA,SAAM,CAAC,MAAM,CAAC,SAAS,CAAC;aACvC;YACD,IAAI,KAAK,CAAC,SAAS,CAAC,EAAE;gBAClB,SAAS,GAAG,CAAC,CAAC;aACjB;YACD,IAAI,CAAC,KAAK,IAAI,KAAK,KAAK,CAAC,EAAE;gBACvB,OAAO,EAAE,CAAC;aACb;YAED,IAAM,IAAI,GAAG;gBACT,MAAM,EAAEA,SAAM,CAAC,MAAM,GAAGA,SAAM,CAAC,MAAM,GAAG,EAAE;gBAC1C,MAAM,EAAEA,SAAM,CAAC,MAAM,GAAGA,SAAM,CAAC,MAAM,GAAG,EAAE;gBAC1C,SAAS,EAAE,SAAS;gBACpB,QAAQ,EAAE,GAAG;gBACb,UAAU,EAAE,KAAK;aACpB,CAAC;YACF,OAAO,IAAI,CAAC,aAAa,CAAC,WAAW,CAAC,KAAK,EAAE,IAAI,CAAC,CAAC;SACtD;;;;;;QAOO,mDAAY,GAApB,UAAqB,KAAU,EAAEA,SAAW;YACxC,IAAI,QAAQ,GAAG,KAAK,CAAC;YACrB,IAAI,QAAQ,KAAK,EAAE,IAAI,CAAC,QAAQ,EAAE;gBAC9B,QAAQ,GAAG,EAAE,CAAC;aACjB;YACD,IAAI,OAAO,QAAQ,KAAK,QAAQ,EAAE;gBAC9B,IAAM,SAAS,GAAG,OAAO,QAAQ,CAAC;gBAClC,MAAM,IAAI,KAAK,CAAI,SAAS,yFAAgB,CAAC,CAAC;aACjD;;YAED,QAAQ,GAAG,QAAQ,CAAC,OAAO,CAAC,IAAI,EAAE,OAAO,CAAC;iBACrC,OAAO,CAAC,IAAI,EAAE,MAAM,CAAC;iBACrB,OAAO,CAAC,IAAI,EAAE,MAAM,CAAC;iBACrB,OAAO,CAAC,KAAK,EAAE,QAAQ,CAAC;iBACxB,OAAO,CAAC,KAAK,EAAE,OAAO,CAAC;iBACvB,OAAO,CAAC,KAAK,EAAE,QAAQ,CAAC,CAAC;;YAE9B,IAAIA,SAAM,CAAC,MAAM,IAAIA,SAAM,CAAC,MAAM,CAAC,IAAI,KAAK,cAAc,EAAE;gBACxD,IAAM,KAAK,GAAG,QAAQ,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;gBACrC,IAAI,KAAK,GAAG,CAAC,CAAC,EAAE;oBACZ,OAAO,QAAQ,CAAC,OAAO,CAAC,KAAK,EAAE,MAAM,CAAC,CAAC;iBAC1C;gBACD,OAAO,QAAQ,CAAC;aACnB;;YAED,OAAO,QAAQ,CAAC;SACnB;;oBA9IJC,eAAU;;;;;wBAJFC,0BAAqB;wBACrBC,0BAAmB;;;QAkJ5B,mCAAC;KA/ID;;;QCDI;SACC;QACD,gDAAS,GAAT,UAAU,SAA6B;YACnC,IAAM,OAAO,GAAG,SAAS,CAAC,OAAO,CAAC;YAClC,OAAO,CAAC,OAAO,CAAC,UAACH,SAAW;gBACxB,IAAM,QAAQ,GAAGA,SAAM,CAAC,QAAQ,CAAC;gBACjC,IAAI,CAACA,SAAM,CAAC,SAAS,EAAE;oBACnB,IAAI,QAAQ,KAAK,MAAM,EAAE;wBACrBA,SAAM,CAAC,SAAS,GAAG;4BACf,IAAI,EAAE,UAAU;4BAChB,OAAO,EAAE;gCACL,MAAM,EAAEA,SAAM,CAAC,MAAM;6BACxB;yBACJ,CAAC;qBACL;yBAAM,IAAI,QAAQ,KAAK,QAAQ,EAAE;wBAC9BA,SAAM,CAAC,SAAS,GAAG;4BACf,IAAI,EAAE,QAAQ;4BACd,OAAO,EAAE;gCACL,MAAM,EAAEA,SAAM,CAAC,MAAM,GAAGA,SAAM,CAAC,MAAM,GAAG,EAAE;gCAC1C,MAAM,EAAEA,SAAM,CAAC,MAAM,GAAGA,SAAM,CAAC,MAAM,GAAG,EAAE;gCAC1C,SAAS,EAAEA,SAAM,CAAC,SAAS;gCAC3B,QAAQ,EAAE,GAAG;gCACb,UAAU,EAAE,KAAK;6BACpB;yBACJ,CAAC;qBACL;yBAAM,IAAI,QAAQ,KAAK,MAAM,EAAE;wBAC5BA,SAAM,CAAC,SAAS,GAAG;4BACf,IAAI,EAAE,MAAM;4BACZ,OAAO,EAAE;gCACL,IAAI,EAAEA,SAAM,CAAC,QAAQ;gCACrB,UAAU,EAAE,OAAO;gCACnB,SAAS,EAAE,MAAM;6BACpB;yBACJ,CAAC;qBACL;yBAAM,IAAI,QAAQ,KAAK,SAAS,EAAE;wBAC/BA,SAAM,CAAC,SAAS,GAAG;4BACf,IAAI,EAAE,MAAM;4BACZ,OAAO,EAAE;gCACL,IAAI,EAAE,CAAC,EAAE,IAAI,EAAE,GAAG,EAAE,KAAK,EAAE,IAAI,EAAE,EAAE,EAAE,IAAI,EAAE,GAAG,EAAE,KAAK,EAAE,KAAK,EAAE,CAAC;gCAC/D,UAAU,EAAE,OAAO;gCACnB,SAAS,EAAE,MAAM;6BACpB;yBACJ,CAAC;qBACL;iBACJ;aACJ,CAAC,CAAC;SACN;;oBAhDJC,eAAU;;;;QAkDX,mCAAC;KAlDD;;;QCCA;SAaC;QAXG,oCAAS,GAAT,UAAU,KAAa,EAAE,QAAgB;YACrC,IAAIF,eAAQ,CAAC,iBAAiB,CAAC,KAAK,CAAC,KAAK,IAAI,EAAE;gBAC9C,OAAO,IAAI,CAAC;aACb;YAED,IAAI,KAAK,CAAC,QAAQ,CAAC,GAAG,CAAC,EAAE;gBACrB,IAAM,OAAO,GAAG,KAAK,CAAC,OAAO,CAAC,GAAG,EAAE,GAAG,CAAC,CAAC,OAAO,CAAC,GAAG,EAAE,GAAG,CAAC,CAAC,OAAO,CAAC,GAAG,EAAE,EAAE,CAAC,CAAC;gBAC3E,OAAO,IAAI,IAAI,CAAC,OAAO,CAAC,CAAC;aAC5B;YACD,OAAO,IAAI,IAAI,CAAC,KAAK,CAAC,CAAC;SAC1B;;oBAZJK,SAAI,SAAC,EAAE,IAAI,EAAE,gBAAgB,EAAE;;QAahC,uBAAC;KAbD;;;QCI8CC,4CAAuB;QAgBjE,kCACY,YAAmC,EACpC,aAA4B;YAFvC,YAII,kBAAM,aAAa,CAAC,SACvB;YAJW,kBAAY,GAAZ,YAAY,CAAuB;YACpC,mBAAa,GAAb,aAAa,CAAe;;SAGtC;QAhBD,sBAAW,mDAAa;iBAAxB;gBACI,IAAM,MAAM,GAAG,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC;gBACzD,OAAO,MAAM,GAAG,MAAM,CAAC,KAAK,GAAG,IAAI,CAAC;aACvC;;;WAAA;QACD,sBAAW,iDAAW;iBAAtB;gBACI,OAAO;oBACH,KAAK,EAAE,IAAI;oBACX,IAAI,EAAE,IAAI;iBACb,CAAC;aACL;;;WAAA;QASD,2CAAQ,GAAR;YACI,IAAI,CAAC,YAAY,CAAC,UAAU,GAAG,OAAO,CAAC;YACvC,IAAI,CAAC,YAAY,CAAC,SAAS,GAAG,MAAM,CAAC;YACrC,IAAI,CAAC,YAAY,CAAC,cAAc,GAAG,IAAI,CAAC;YACxC,IAAI,CAAC,YAAY,CAAC,WAAW,GAAG,IAAI,CAAC,WAAW,CAAC;YACjD,IAAI,CAAC,YAAY,CAAC,KAAK,GAAG,IAAI,CAAC,aAAa,CAAC;YAC7C,IAAI,IAAI,CAAC,MAAM,CAAC,QAAQ,KAAK,MAAM,EAAE;gBACjC,IAAI,CAAC,YAAY,CAAC,IAAI,GAAG,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC;aACjD;iBAAM,IAAI,IAAI,CAAC,MAAM,CAAC,QAAQ,KAAK,SAAS,EAAE;gBAC3C,IAAI,CAAC,YAAY,CAAC,IAAI,GAAG,CAAC,EAAE,KAAK,EAAE,IAAI,EAAE,IAAI,EAAE,GAAG,EAAE,EAAE,EAAE,KAAK,EAAE,KAAK,EAAE,IAAI,EAAE,GAAG,EAAE,CAAC,CAAC;aACtF;SACJ;QAID,2CAAQ,GADR,UACS,KAAU;YACf,IAAI,CAAC,WAAW,CACZ,KAAK,KAAK,IAAI;gBACV,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,MAAM,CAAC,SAAS,CAAC;gBACxC,IAAI,CAAC,YAAY,CAAC;oBACd,KAAK,EAAE,IAAI,CAAC,MAAM,CAAC,SAAS;oBAC5B,QAAQ,EAAE,IAAI;oBACd,KAAK,EAAE,KAAK;iBACf,CAAC,CACT,CAAC;SACL;;;;;;QAQD,2CAAQ,GAAR,UAAS,QAAa,EAAE,KAAa;YACjC,IAAM,KAAK,GAAG,KAAK,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC;YACjC,IAAI,KAAK,GAAG,CAAC,EAAE;gBACX,OAAO,QAAQ,CAAC,KAAK,CAAC,CAAC;aAC1B;YACD,IAAM,MAAM,GAAG,KAAK,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;;YAEhC,OAAO,MAAM,CAAC,MAAM,CAAC,UAAC,MAAW,EAAE,IAAS;gBACxC,OAAO,MAAM,CAAC,IAAI,CAAC,CAAC;aACvB,EAAE,QAAQ,CAAC,CAAC;SAChB;;oBArEJC,cAAS,SAAC;wBACP,QAAQ,EAAE,mBAAmB;qBAChC;;;;;wBAJQC,2CAAqB;wBACrBC,8BAAa;;;;6BAMjBC,UAAK;6BACLA,UAAK;+BAkCLC,iBAAY,SAAC,aAAa,EAAE,CAAC,QAAQ,CAAC;;QA+B3C,+BAAC;KAAA,CApE6CC,wCAAuB;;;QCHjE,mCAAoB,SAAoB;YAApB,cAAS,GAAT,SAAS,CAAW;SAEvC;QACD,6CAAS,GAAT,UAAU,MAAc,EAAE,WAAmB;YACzC,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,IAAI,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,GAAG,CAAC,WAAW,CAAC,EAAE;gBAC/D,OAAO;oBACH,IAAI,EAAE,GAAG;oBACT,KAAK,EAAE,GAAG;oBACV,GAAG,EAAE,GAAG;iBACX,CAAC;aACL;YACD,IAAM,KAAK,GAAG,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,GAAG,CAAC,WAAW,CAAC,CAAC,KAAK,CAAC;YACzD,IAAI,OAAO,GAAG,KAAK,CAAC;YACpB,IAAI,OAAO,EAAE;gBACT,OAAO,GAAG,KAAK,CAAC,WAAW,EAAE,CAAC;aACjC;YACD,IAAI,CAACZ,eAAQ,CAAC,iBAAiB,CAAC,OAAO,CAAC,KAAK,IAAI,KAAK,MAAM,KAAK,aAAa,EAAE;gBAC5E,OAAO;oBACH,IAAI,EAAE,GAAG;oBACT,KAAK,EAAE,GAAG;oBACV,GAAG,EAAE,GAAG;iBACX,CAAC;aACL;YACD,OAAO;gBACH,IAAI,EAAE,GAAG;gBACT,KAAK,EAAE,GAAG;gBACV,GAAG,EAAE,GAAG;aACX,CAAC;SACL;;oBA9BJK,SAAI,SAAC,EAAE,IAAI,EAAE,uBAAuB,EAAE;;;;;wBAD9BQ,gBAAS;;;QAgClB,gCAAC;KA/BD;;;QCDA;SAcC;QAZG,mCAAS,GAAT,UAAU,KAAU,EAAE,QAAa;;YAE/B,IAAI,CAAC,KAAK,IAAI,KAAK,KAAK,CAAC,EAAE;gBACvB,OAAO,EAAE,CAAC;aACb;YACD,IAAI,QAAQ,CAAC,QAAQ,KAAK,QAAQ,EAAE;;gBAEhC,IAAM,UAAU,GAAG,QAAQ,CAAC,MAAM,CAAC;gBACnC,OAAO,KAAK,CAAC,OAAO,CAAC,MAAM,CAAC,UAAU,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;aACzD;YACD,OAAO,KAAK,CAAC;SAChB;;oBAbJR,SAAI,SAAC,EAAE,IAAI,EAAE,aAAa,EAAE;;QAc7B,sBAAC;KAdD;;;QC2BE,sCAAoBJ,SAAuB,EAAU,MAAc;YAA/C,WAAM,GAANA,SAAM,CAAiB;YAAU,WAAM,GAAN,MAAM,CAAQ;SAClE;QAlBD,sBAAW,+CAAK;iBAAhB;gBACE,OAAO,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC;aAC1B;;;WAAA;QAED,sBAAY,kDAAQ;iBAApB;gBACE,IAAI,IAAI,GAAG,MAAM,CAAC;gBAClB,IAAI,QAAQ,IAAI,CAAC,SAAS,CAAC,KAAK,SAAS,EAAE;;oBAEzC,IAAI,IAAI,CAAC,SAAS,EAAE;wBAClB,IAAI,GAAG,KAAK,CAAC;qBACd;iBACF;qBAAM,IAAI,QAAQ,IAAI,CAAC,SAAS,CAAC,KAAK,QAAQ,EAAE;oBAC/C,IAAI,GAAG,IAAI,CAAC,SAAS,CAAC;iBACvB;gBACD,OAAO,IAAI,CAAC;aACb;;;WAAA;QAKM,yDAAkB,GAAzB,UAA0B,WAAwB;YAAlD,iBAmBC;YAlBC,IAAI,OAAO,GAAG,IAAI,CAAC;YACnB,IAAI,IAAI,CAAC,QAAQ,KAAK,KAAK,EAAE;gBAC3B,IAAM,SAAS,GAAG,WAAW,CAAC,MAAM,EAAE,CAAC,GAAG,CAAC,UAAA,IAAI;;oBAE7C,OAAO,KAAI,CAAC,KAAK,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAC,QAAQ,EAAE,QAAQ;wBACrD,OAAO,QAAQ,CAAC,QAAQ,CAAC,CAAC;qBAC3B,EAAE,IAAI,CAAC,CAAC;iBACV,CAAC,CAAC;gBACH,IAAI,SAAS,IAAI,SAAS,CAAC,MAAM,EAAE;oBACjC,OAAO,GAAG,SAAS,CAAC,MAAM,CAAC,UAAC,IAAI,EAAE,IAAI;wBACpC,OAAO,IAAI,GAAG,IAAI,CAAC;qBACpB,CAAC,CAAC;iBACJ;aACF;iBAAM,IAAI,IAAI,CAAC,QAAQ,KAAK,OAAO,EAAE;;gBAEpC,OAAO,GAAG,WAAW,CAAC,MAAM,CAAC;aAC9B;YACD,IAAI,CAAC,YAAY,CAAC,OAAO,CAAC,CAAC;SAC5B;QAEM,mDAAY,GAAnB,UAAoB,OAAY;YAC9B,IAAI,IAAI,CAAC,SAAS,EAAE;;;;;gBAKd,IAAI,CAAC,MAAM,CAAC,SAAS,CAAC,GAAG,OAAO,CAAC;;aAEtC;SACF;;oBAzDFM,cAAS,SAAC;wBACT,QAAQ,EAAE,aAAa;qBACxB;;;;;wBAJQO,gCAAe;wBAF+BC,WAAM;;;;gCAS1DL,UAAK;;QAqDR,mCAAC;KA1DD,IA0DC;;QAQC,8BAAoB,WAAwB;YAAxB,gBAAW,GAAX,WAAW,CAAa;SAAK;;oBALlDH,cAAS,SAAC;wBACT,QAAQ,EAAE,iBAAiB;qBAC5B;;;;;wBAlEQS,kBAAW;;;;8BAoEjBN,UAAK,SAAC,eAAe;;QAGxB,2BAAC;KAPD;;IC7DA;;;IAGA;QAAA;SAoMC;;;;QA7Le,4CAAqB,GAAnC,UAAoC,aAA4B,EAAE,kBAAsC;YACtG,IAAI,CAAC,aAAa,EAAE;gBAClB,OAAO;aACR;YAED,IAAM,eAAe,GAAG,kBAAkB,CAAC,eAAe,CAAC;;YAE3D,IAAI,CAAC,mBAAmB,CAAC,aAAa,EAAE,eAAe,CAAC,CAAC;;YAGzD,IAAM,YAAY,GAAG,kBAAkB,CAAC,YAAY,CAAC;YACrD,IAAI,CAAC,IAAI,CAAC,yBAAyB,CAAC,aAAa,EAAE,eAAe,EAAE,YAAY,CAAC,EAAE;gBACjF,IAAI,CAAC,sBAAsB,CAAC,aAAa,EAAE,YAAY,CAAC,CAAC;aAC1D;SACF;;;;QAKc,gDAAyB,GAAxC,UAAyC,aAA4B,EAAE,eAAuB,EAAE,YAAoB;YAClH,IAAI,mBAAmB,GAAG,KAAK,CAAC;YAChC,IAAI,eAAe,KAAK,YAAY,EAAE;gBACpC,mBAAmB,GAAG,IAAI,CAAC;gBAC3B,OAAO,mBAAmB,CAAC;aAC5B;YAED,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,eAAe,GAAG,YAAY,CAAC,KAAK,aAAa,CAAC,QAAQ,CAAC,KAAK,CAAC,EAAE;gBAC/E,mBAAmB,GAAG,IAAI,CAAC;gBAC3B,OAAO,mBAAmB,CAAC;aAC5B;YAED,OAAO,mBAAmB,CAAC;SAC5B;;;;QAKa,0CAAmB,GAAjC,UAAkC,aAA4B;YAC5D,IAAI,UAAU,GAAG,KAAK,CAAC;YACvB,IAAI,CAAC,aAAa,EAAE;gBAClB,OAAO,UAAU,CAAC;aACnB;YAED,IAAI,OAAO,aAAa,CAAC,QAAQ,KAAK,SAAS,EAAE;gBAC/C,UAAU,GAAG,aAAa,CAAC,QAAQ,CAAC;aACrC;iBAAM,IAAI,OAAO,aAAa,CAAC,QAAQ,KAAK,QAAQ,EAAE;gBACrD,UAAU,GAAG,IAAI,CAAC;aACnB;YAED,OAAO,UAAU,CAAC;SACnB;;;;QAKa,mDAA4B,GAA1C,UAA2C,UAAsB,EAAE,MAAW;YAE5E,IAAM,eAAe,GAAG,MAAM,CAAC,KAAK,CAAC;YAErC,IAAM,YAAY,GAAG,IAAI,CAAC,eAAe,CAAC,UAAU,CAAC,CAAC;YACtD,IAAI,YAAY,IAAI,IAAI,IAAI,YAAY,CAAC,MAAM,IAAI,CAAC,IAAI,YAAY,CAAC,MAAM,GAAG,eAAe,EAAE;gBAC7F,OAAO;aACR;;YAGD,IAAM,sBAAsB,GAAG,YAAY,CAAC,eAAe,CAAC,CAAC;YAC7D,IAAI,CAAC,sBAAsB,EAAE;gBAC3B,OAAO;aACR;YAED,IAAI,MAAM,CAAC,QAAQ,EAAE;gBACnB,IAAI,CAAC,oBAAoB,CAAC,sBAAsB,EAAE,OAAO,EAAE,IAAI,CAAC,yBAAyB,CAAC,CAAC;aAC5F;iBAAM;gBACL,IAAI,CAAC,4BAA4B,CAAC,sBAAsB,EAAE,OAAO,EAAE,IAAI,CAAC,yBAAyB,CAAC,CAAC;aACpG;SACF;;;;;QAMc,0CAAmB,GAAlC,UAAmC,aAA4B,EAAE,QAAgB;YAC/E,IAAI,CAAC,aAAa,IAAI,QAAQ,GAAG,CAAC,EAAE;gBAClC,OAAO;aACR;YAED,IAAM,iBAAiB,GAAG,IAAI,CAAC,2BAA2B,CAAC,aAAa,EAAE,QAAQ,CAAC,CAAC;YACpF,IAAI,CAAC,iBAAiB,EAAE;gBACtB,OAAO;aACR;YAED,IAAI,CAAC,oBAAoB,CAAC,iBAAiB,EAAE,OAAO,EAAE,IAAI,CAAC,sBAAsB,CAAC,CAAC;SACpF;;;;;QAMa,6CAAsB,GAApC,UAAqC,aAA4B,EAAE,QAAgB;YACjF,IAAI,CAAC,aAAa,IAAI,QAAQ,GAAG,CAAC,EAAE;gBAClC,OAAO;aACR;YAED,IAAM,iBAAiB,GAAG,IAAI,CAAC,2BAA2B,CAAC,aAAa,EAAE,QAAQ,CAAC,CAAC;YACpF,IAAI,CAAC,iBAAiB,EAAE;gBACtB,OAAO;aACR;YACD,IAAI,CAAC,4BAA4B,CAAC,iBAAiB,EAAE,OAAO,EAAE,IAAI,CAAC,sBAAsB,CAAC,CAAC;SAC5F;;;;QAKc,kDAA2B,GAA1C,UAA2C,aAA4B,EAAE,QAAgB;YACvF,IAAI,uBAAuB,GAAQ,IAAI,CAAC;YACxC,IAAI,CAAC,aAAa,IAAI,QAAQ,GAAG,CAAC,EAAE;gBAClC,OAAO,uBAAuB,CAAC;aAChC;YAED,IAAM,WAAW,GAAG,aAAa,CAAC,OAAO,CAAC;;YAE1C,IAAM,QAAQ,GAAG,IAAI,CAAC,mBAAmB,CAAC,aAAa,CAAC,CAAC;YACzD,IAAI,QAAQ,EAAE;gBACZ,QAAQ,GAAG,QAAQ,IAAI,aAAa,CAAC,QAAQ,CAAC,CAAC;aAChD;YAED,IAAM,YAAY,GAAG,IAAI,CAAC,eAAe,CAAC,WAAW,CAAC,CAAC;YACvD,IAAI,YAAY,IAAI,IAAI,IAAI,YAAY,CAAC,MAAM,IAAI,CAAC,EAAE;gBACpD,OAAO,uBAAuB,CAAC;aAChC;YAED,uBAAuB,GAAG,YAAY,CAAC,QAAQ,CAAC,CAAC;YAEjD,OAAO,uBAAuB,CAAC;SAChC;;;;QAKc,sCAAe,GAA9B,UAA+B,UAAsB;YACnD,IAAI,CAAC,UAAU,IAAI,CAAC,UAAU,CAAC,aAAa,EAAE;gBAC5C,OAAO,IAAI,CAAC;aACb;YAED,IAAM,sBAAsB,GAAU,UAAU,CAAC,aAAa,CAAC,oBAAoB,CAAC,OAAO,CAAC,CAAC;YAC7F,IAAI,CAAC,sBAAsB,IAAI,sBAAsB,CAAC,MAAM,IAAI,CAAC,EAAE;gBACjE,OAAO,IAAI,CAAC;aACb;YAED,IAAM,YAAY,GAAG,sBAAsB,CAAC,CAAC,CAAC,CAAC,oBAAoB,CAAC,IAAI,CAAC,CAAC;YAC1E,OAAO,YAAY,CAAC;SACrB;;;;QAKc,2CAAoB,GAAnC,UAAoC,cAAuB,EAAE,aAAqB,EAAE,cAAsB;YACxG,IAAI,iBAAiB,GAAW,cAAc,CAAC,YAAY,CAAC,aAAa,CAAC,CAAC;YAC3E,IAAI,iBAAiB,KAAK,IAAI,IAAI,iBAAiB,KAAK,EAAE,IAAI,iBAAiB,CAAC,MAAM,IAAI,CAAC,EAAE;gBAC3F,iBAAiB,GAAG,cAAc,CAAC;aACpC;iBAAM;gBACL,IAAI,iBAAiB,CAAC,OAAO,CAAC,cAAc,CAAC,GAAG,CAAC,EAAE;oBACjD,iBAAiB,IAAI,GAAG,GAAG,cAAc,CAAC;iBAC3C;aACF;YAED,cAAc,CAAC,YAAY,CAAC,aAAa,EAAE,iBAAiB,CAAC,CAAC;SAC/D;;;;QAKc,mDAA4B,GAA3C,UAA4C,cAAuB,EAAE,aAAqB,EAAE,wBAAgC;YAC1H,IAAI,uBAAuB,GAAG,cAAc,CAAC,YAAY,CAAC,aAAa,CAAC,CAAC;YACzE,IAAI,CAAC,uBAAuB,EAAE;gBAC5B,OAAO;aACR;YAED,IAAM,KAAK,GAAG,uBAAuB,CAAC,WAAW,CAAC,wBAAwB,CAAC,CAAC;YAC5E,IAAI,KAAK,GAAG,CAAC,EAAE;gBACb,OAAO;aACR;YAED,IAAM,2BAA2B,GAAG,uBAAuB,CAAC,SAAS,CAAC,CAAC,EAAE,KAAK,GAAG,CAAC,CAAC,CAAC;YACpF,uBAAuB,GAAG,2BAA2B,GAAG,GAAG;kBACvD,uBAAuB,CAAC,SAAS,CAAC,KAAK,GAAG,wBAAwB,CAAC,MAAM,CAAC,CAAC;YAE/E,cAAc,CAAC,YAAY,CAAC,aAAa,EAAE,uBAAuB,CAAC,CAAC;SACrE;QAlMM,6CAAsB,GAAG,kBAAkB,CAAC;QAC5C,gDAAyB,GAAG,iBAAiB,CAAC;QAkMvD,6BAAC;KApMD,IAoMC;;IC3MD;;;IAGA;QAAA;SAUC;QAAD,yBAAC;IAAD,CAAC,IAAA;;ICWD;;;;;;;AAQA;QAG+CJ,6CAAoB;;;;;QAuKjE,mCACS,WAAwB,EACZ,OAAgB,EAChB,QAAuB,EACvB,SAAoB,EAChC,IAAmB,EACnB,YAAgC,EAChC,SAAwB,EACvB,WAAkC,EAClC,kBAAgD,EAChD,GAAwB,EACzB,MAAc;YAXvB,YAaE,kBAAM,IAAI,CAAC,SAUZ;YAtBQ,iBAAW,GAAX,WAAW,CAAa;YACZ,aAAO,GAAP,OAAO,CAAS;YAChB,cAAQ,GAAR,QAAQ,CAAe;YACvB,eAAS,GAAT,SAAS,CAAW;YAChC,UAAI,GAAJ,IAAI,CAAe;YACnB,kBAAY,GAAZ,YAAY,CAAoB;YAChC,eAAS,GAAT,SAAS,CAAe;YACvB,iBAAW,GAAX,WAAW,CAAuB;YAClC,wBAAkB,GAAlB,kBAAkB,CAA8B;YAChD,SAAG,GAAH,GAAG,CAAqB;YACzB,YAAM,GAAN,MAAM,CAAQ;;;;;YA9ID,eAAS,GAAG,IAAIW,iBAAY,EAAO,CAAC;;YAGhD,qBAAe,GAAsB,IAAIA,iBAAY,EAAO,CAAC;;YAIvE,cAAQ,GAAsB,IAAIA,iBAAY,EAAO,CAAC;YAyBtD,kBAAY,GAAG,CAAC,CAAC;;;;;YAKjB,cAAQ,GAAG,CAAC,CAAC;YACb,iBAAW,GAAG,CAAC,CAAC;YAIhB,iBAAW,GAAG,CAAC,CAAC;;;;YAOR,6BAAuB,GAAG,KAAK,CAAC;;;;YAyBjC,kBAAY,GAAG,CAAC,CAAC,CAAC;;;;YAKf,uBAAiB,GAAsB,IAAIA,iBAAY,EAAO,CAAC;;;;YAK/D,4BAAsB,GAAsB,IAAIA,iBAAY,EAAO,CAAC;YA8D5E,KAAI,CAAC,YAAY,CAAC,YAAY,GAAG,EAAE,CAAC;YACpC,KAAI,CAAC,SAAS,CAAC,OAAO,CAAC,gBAAgB,CAAC,KAAK,EAAE,KAAI,CAAC,YAAY,CAAC,YAAY,CAAC,CAAC;YAC/E,IAAM,UAAU,GAAG,KAAI,CAAC,SAAS,CAAC,YAAY,CAAC,iBAAiB,EAAE,CAAC;YACnE,IAAI,UAAU,IAAI,UAAU,CAAC,cAAc,CAAC,aAAa,CAAC,EAAE;gBAC1D,UAAU,CAAC,WAAW,CAAC,SAAS,CAAC,UAAC,OAAY;oBAC5C,KAAI,CAAC,IAAI,CAAC,SAAS,EAAE,CAAC;iBACvB,CAAC,CAAC;aACJ;;SACF;QAhJD,sBAAI,iDAAU;iBAAd;gBACE,OAAO,IAAI,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;aAChC;;;WAAA;QACD,sBAAI,0CAAG;iBAAP;gBACE,OAAO,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC;aACjC;;;WAAA;QAmCD,sBAAW,8DAAuB;iBAAlC;gBACE,IAAI,CAAC,IAAI,CAAC,IAAI,EAAE;oBACd,OAAO,IAAI,CAAC,uBAAuB,CAAC;iBACrC;gBAED,IAAI,IAAI,CAAC,IAAI,CAAC,UAAU,EAAE;;oBAExB,IAAI,IAAI,CAAC,IAAI,CAAC,UAAU,CAAC,MAAM,CAAC,KAAK,UAAU,EAAE;wBAC/C,IAAI,CAAC,uBAAuB,GAAG,IAAI,CAAC;qBACrC;yBAAM;wBACL,IAAI,CAAC,uBAAuB,GAAG,KAAK,CAAC;qBACtC;iBACF;qBAAM;oBACL,IAAI,IAAI,CAAC,IAAI,CAAC,kBAAkB,IAAI,IAAI,CAAC,IAAI,CAAC,kBAAkB,CAAC,IAAI,KAAK,UAAU,EAAE;wBACpF,IAAI,CAAC,uBAAuB,GAAG,IAAI,CAAC;qBACrC;iBACF;gBAED,OAAO,IAAI,CAAC,uBAAuB,CAAC;aACrC;;;WAAA;QAoBD,sBAAY,kDAAW;;;;iBAAvB;;gBAEE,IAAI,IAAI,CAAC,SAAS,CAAC,WAAW,KAAK,GAAG,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,WAAW,EAAE;oBACrE,OAAO,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC;iBAC9B;;gBAED,IAAI,WAAW,GAAG,IAAI,CAAC,SAAS,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC;gBACvD,WAAW,GAAG,WAAW,CAAC,CAAC,CAAC,CAAC,WAAW,EAAE,GAAG,WAAW,CAAC,SAAS,CAAC,CAAC,EAAE,WAAW,CAAC,MAAM,CAAC,CAAC;gBAC1F,IAAM,KAAK,GAAG,WAAW,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;gBAErC,IAAM,aAAa,GAAG,KAAK,CAAC,MAAM,CAAC,UAAC,IAAY;oBAC9C,OAAO,IAAI,KAAK,EAAE,CAAC;iBACpB,CAAC,CAAC;gBACH,OAAO,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC,aAAa,CAAC,CAAC;aACjD;;;WAAA;;;;QAIO,iDAAa,GAArB;YACE,IAAM,WAAW,GAAG,IAAI,CAAC,SAAS,CAAC,WAAW,CAAC;YAC/C,IAAM,WAAW,GAAG,IAAI,CAAC,SAAS,CAAC,WAAW,CAAC;YAC/C,IAAI,UAAU,GAAG,WAAW,CAAC,UAAU,CAAC;YACxC,IAAI,WAAW,KAAK,GAAG,EAAE;gBACvB,OAAO,UAAU,CAAC;aACnB;iBAAM;gBACL,IAAM,YAAY,GAAG,WAAW,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAA,IAAI,IAAI,OAAA,CAAC,CAAC,IAAI,IAAI,IAAI,CAAC,MAAM,GAAG,CAAC,GAAA,CAAC,CAAC,GAAG,CAAC,UAAA,IAAI;oBACtG,OAAO,IAAI,CAAC,SAAS,CAAC,CAAC,EAAE,IAAI,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;iBAC3C,CAAC,CAAC;gBACH,YAAY,CAAC,OAAO,CAAC,UAAA,IAAI;oBACvB,UAAU,GAAG,UAAU,IAAI,UAAU,CAAC,IAAI,CAAC,IAAI,EAAE,CAAC;iBACnD,CAAC,CAAC;gBACH,OAAO,UAAU,CAAC;aACnB;SACF;;;;QAqCD,4CAAQ,GAAR;YAAA,iBAiJC;YAhJC,iBAAM,QAAQ,WAAE,CAAC;;YAGjB,IAAI,CAAC,aAAa,EAAE,CAAC;YAErB,IAAI,CAAC,WAAW,EAAE,CAAC;YACnB,IAAI,IAAI,CAAC,SAAS,IAAI,IAAI,CAAC,SAAS,CAAC,YAAY,IAAI,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC,cAAc,EAAE;gBAC/F,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC,cAAc,CAAC,aAAa,GAAGC,oBAAa,CAAC,kBAAkB,CAAC;aAC7F;;YAED,IAAI,CAAC,yBAAyB,GAAG,IAAI,CAAC,WAAW,CAAC,OAAO,CAAC,SAAS,CAAC,UAAC,MAAc;gBACjF,KAAI,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC;gBAEzB,IAAI,MAAM,CAAC,IAAI,KAAKC,iBAAU,CAAC,IAAI,EAAE;;oBAEnC,IAAI,KAAI,CAAC,uBAAuB,EAAE;wBAChC,IAAM,SAAO,GAAG,KAAI,CAAC,6BAA6B,CAAC,MAAM,CAAC,CAAC;wBAC3D,IAAI,SAAO,EAAE;;4BAEX,KAAI,CAAC,YAAY,CAAC,YAAY,GAAG,EAAE,CAAC;4BACpC,KAAI,CAAC,SAAS,CAAC,OAAO,CAAC,gBAAgB,CAAC,KAAK,EAAE,KAAI,CAAC,YAAY,CAAC,YAAY,CAAC,CAAC;4BAC/E,KAAI,CAAC,MAAM,CAAC,iBAAiB,CAAC;;gCAE5B,UAAU,CAAC;oCACT,IAAM,kBAAkB,GAAuB,IAAI,kBAAkB,EAAE,CAAC;oCACxE,IAAM,UAAU,GAAG,sBAAsB,CAAC,mBAAmB,CAAC,KAAI,CAAC,IAAI,CAAC,CAAC;oCACzE,IAAI,UAAU,EAAE;wCACd,KAAI,CAAC,QAAQ,GAAG,KAAI,CAAC,IAAI,CAAC,IAAI,CAAC;qCAChC;yCAAM;wCACL,KAAI,CAAC,QAAQ,GAAG,CAAC,CAAC;qCACnB;oCACD,kBAAkB,CAAC,eAAe,GAAG,KAAI,CAAC,QAAQ,CAAC;oCACnD,kBAAkB,CAAC,YAAY,GAAG,KAAI,CAAC,YAAY,CAAC;oCACpD,KAAI,CAAC,uBAAuB,CAAC,kBAAkB,CAAC,CAAC;iCAClD,EAAE,GAAG,CAAC,CAAC;6BACT,CAAC,CAAC;yBACJ;qBACF;iBACF;;;gBAID,IAAI,MAAM,CAAC,IAAI,KAAKA,iBAAU,CAAC,MAAM,EAAE;oBACrC,KAAI,CAAC,eAAe,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;iBACpC;gBACD,IAAM,OAAO,GAAG,KAAI,CAAC,6BAA6B,CAAC,MAAM,CAAC,CAAC;gBAC3D,IAAI,OAAO,EAAE;oBACX,KAAI,CAAC,uBAAuB,CAAC,KAAI,CAAC,WAAW,CAAC,SAAS,CAAC,CAAC;iBAC1D;;gBAED,IAAI,OAAO,IAAI,KAAI,CAAC,uBAAuB,EAAE,IAAI,MAAM,CAAC,IAAI,KAAKA,iBAAU,CAAC,gBAAgB,IAAI,CAAC,KAAI,CAAC,MAAM,EAAE;oBAC5G,KAAI,CAAC,gBAAgB,CAAC,KAAI,CAAC,WAAW,CAAC,SAAS,CAAC,CAAC;iBACnD;;;;;;;gBAOD,IAAI,MAAM,CAAC,IAAI,KAAKA,iBAAU,CAAC,IAAI,IAAI,MAAM,CAAC,IAAI,KAAKA,iBAAU,CAAC,gBAAgB;uBAC7E,MAAM,CAAC,IAAI,KAAKA,iBAAU,CAAC,MAAM,IAAI,MAAM,CAAC,IAAI,KAAKA,iBAAU,CAAC,MAAM,EAAE;;oBAG3E,IAAI,KAAI,CAAC,IAAI,IAAI,KAAI,CAAC,IAAI,CAAC,mBAAmB,CAAC,IAAI,KAAI,CAAC,IAAI,CAAC,mBAAmB,CAAC,CAAC,eAAe,CAAC,EAAE;wBAClG,KAAI,CAAC,IAAI,CAAC,mBAAmB,CAAC,CAAC,eAAe,CAAC,EAAE,CAAC;qBACnD;iBACF;aAEF,CAAC,CAAC;YAEH,IAAI,IAAI,CAAC,QAAQ,KAAK,IAAI,IAAI,IAAI,CAAC,IAAI,KAAK,IAAI,EAAE;gBAChD,MAAM,KAAK,CAAC,gBAAgB,CAAC,CAAC;aAC/B;YACD,IAAI,CAAC,IAAI,CAAC,IAAI,IAAI,CAAC,IAAI,CAAC,uBAAuB,IAAI,CAAC,IAAI,CAAC,uBAAuB,CAAC,QAAQ,CAAC,EAAE;gBAC1F,OAAO;aACR;YAED,IAAM,WAAW,GAAG,IAAI,CAAC,uBAAuB,CAAC,QAAQ,CAAC,CAAC;YAC3D,IAAM,UAAU,GAAG,IAAI,CAAC,uBAAuB,CAAC;;YAGhD,UAAU,CAAC,QAAQ,GAAG,UAAC,OAAc;gBACnC,OAAO,OAAO,CAAC,IAAI,CAAC,UAAA,GAAG;oBACrB,OAAO,GAAG,CAAC,MAAM,CAAC;iBACnB,CAAC,CAAC;aACJ,CAAC;YAEF,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;;YAE9B,WAAW,CAAC,OAAO,CAAC,UAAC,OAAY;;gBAE/B,IAAI,OAAO,CAAC,kBAAkB,IAAI,CAAC,OAAO,CAAC,SAAS,EAAE;oBACpD,OAAO,CAAC,SAAS,GAAG;wBAClB,OAAO;qBACR,CAAC;iBACH;;gBAGD,IAAI,CAAC,OAAO,CAAC,eAAe,EAAE;oBAC5B,OAAO,CAAC,eAAe,GAAG,UAAC,QAAa,EAAElB,SAAW;wBACnD,OAAO,KAAI,CAAC,kBAAkB,CAAC,eAAe,CAAC,QAAQ,EAAEA,SAAM,CAAC,CAAC;qBAClE,CAAC;iBACH;;gBAGD,IAAI,CAAC,OAAO,CAAC,YAAY,EAAE;oBACzB,OAAO,CAAC,YAAY,GAAG,UAAC,QAAa,EAAEA,SAAW,IAAK,OAAA,EAAE,GAAA,CAAC;iBAC3D;;gBAGD,IAAI,OAAO,CAAC,MAAM,IAAI,OAAO,CAAC,MAAM,CAAC,IAAI,KAAK,YAAY,EAAE;;oBAG1D,IAAI,CAAC,OAAO,CAAC,WAAW,EAAE;wBACxB,OAAO,CAAC,WAAW,GAAG,UAAC,KAAU;4BAC/B,OAAOmB,OAAE,CAAC,IAAI,CAAC,CAAC;yBACjB,CAAC;qBACH;;oBAED,IAAI,CAAC,OAAO,CAAC,UAAU,EAAE;wBACvB,OAAO,CAAC,UAAU,GAAG,UAAC,KAAU;;4BAE9B,KAAI,CAAC,gBAAgB,CAAC,KAAI,CAAC,cAAc,CAAC,CAAC;4BAC3C,OAAOA,OAAE,CAAC,IAAI,CAAC,CAAC;yBACjB,CAAC;qBACH;iBACF;aACF,CAAC,CAAC;;YAEH,IAAI,CAAC,iBAAiB,EAAE,CAAC;;YAGzB,IAAI,IAAI,CAAC,uBAAuB,EAAE;;gBAEhC,IAAM,MAAI,GAAG,IAAI,CAAC;gBAClB,IAAI,CAAC,MAAM,CAAC,iBAAiB,CAAC;oBAC5B,UAAU,CAAC;wBACT,IAAM,kBAAkB,GAAuB,IAAI,kBAAkB,EAAE,CAAC;wBACxE,kBAAkB,CAAC,eAAe,GAAG,MAAI,CAAC,QAAQ,CAAC;wBACnD,kBAAkB,CAAC,YAAY,GAAG,MAAI,CAAC,YAAY,CAAC;wBACpD,MAAI,CAAC,uBAAuB,CAAC,kBAAkB,CAAC,CAAC;qBAClD,EAAE,GAAG,CAAC,CAAC;iBACT,CAAC,CAAC;aACJ;SACF;QAGD,mDAAe,GAAf;;;;;;;;;;;SAWC;;;;QAIO,iEAA6B,GAArC,UAAsC,MAAc;YAClD,IAAI,OAAO,GAAG,KAAK,CAAC;YACpB,IAAI,CAAC,MAAM,IAAI,CAAC,MAAM,CAAC,IAAI,EAAE;gBAC3B,OAAO,OAAO,CAAC;aAChB;YAED,IAAM,eAAe,GAAG,MAAM,CAAC,IAAI,CAAC;YACpC,IAAI,CAAC,eAAe,EAAE;gBACpB,OAAO,OAAO,CAAC;aAChB;YAED,IAAI,EAAE,IAAI,CAAC,WAAW,CAAC,IAAI,EAAE,IAAI,CAAC,WAAW,CAAC,WAAW,CAAC,EAAE;gBAC1D,OAAO,OAAO,CAAC;aAChB;YACD,IAAM,iBAAiB,GAAG,IAAI,CAAC,WAAW,CAAC,WAAW,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;YAClE,IAAI,iBAAiB,CAAC,MAAM,IAAI,CAAC,EAAE;gBACjC,OAAO,OAAO,CAAC;aAChB;YAED,IAAI,eAAe,CAAC,MAAM,KAAK,CAAC,EAAE;gBAChC,IAAI,IAAI,CAAC,WAAW,CAAC,WAAW,KAAK,GAAG,EAAE;oBACxC,OAAO,GAAG,IAAI,CAAC;iBAChB;aACF;iBAAM,IAAI,MAAM,CAAC,IAAI,CAAC,MAAM,KAAK,CAAC,EAAE;gBACnC,IAAI,iBAAiB,CAAC,MAAM,KAAK,CAAC,IAAI,iBAAiB,CAAC,CAAC,CAAC,KAAK,MAAM,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE;oBAC7E,OAAO,GAAG,IAAI,CAAC;iBAChB;aACF;iBAAM,IAAI,MAAM,CAAC,IAAI,CAAC,MAAM,KAAK,CAAC,EAAE;gBACnC,IAAI,iBAAiB,CAAC,MAAM,KAAK,CAAC,IAAI,iBAAiB,CAAC,CAAC,CAAC,KAAK,MAAM,CAAC,IAAI,CAAC,CAAC,CAAC,IAAI,iBAAiB,CAAC,CAAC,CAAC,KAAK,MAAM,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE;oBACxH,OAAO,GAAG,IAAI,CAAC;iBAChB;aACF;YAED,OAAO,OAAO,CAAC;SAChB;;;;QAKO,2DAAuB,GAA/B,UAAgC,SAAc;YAC5C,IAAM,YAAY,GAAG,IAAI,CAAC,YAAY,CAAC,YAAY,CAAC;YACpD,IAAI,CAAC,SAAS,EAAE;;gBAGd,IAAI,YAAY,CAAC,MAAM,GAAG,CAAC,EAAE;oBAC3B,IAAM,mBAAmB,GAAG,YAAY,CAAC,MAAM,CAAC,CAAC,EAAE,YAAY,CAAC,MAAM,CAAC,CAAC;oBACxE,IAAI,mBAAmB,CAAC,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,EAAE;wBAC5C,IAAI,CAAC,qBAAqB,CAAC,EAAE,YAAY,EAAE,IAAI,EAAE,CAAC,CAAC;qBACpD;iBACF;gBACD,OAAO;aACR;YACD,IAAI,eAAe,GAAG,IAAI,CAAC;YAC3B,IAAI,IAAI,CAAC,uBAAuB,EAAE;gBAChC,eAAe,GAAG,IAAI,CAAC,YAAY,CAAC;aACrC;iBAAM;gBACL,eAAe,GAAG,IAAI,CAAC,YAAY,CAAC,YAAY,CAAC,MAAM,KAAK,CAAC;sBACzD,IAAI,GAAG,IAAI,CAAC,YAAY,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC;aAC9C;;YAGD,IAAI,eAAe,KAAK,SAAS,EAAE;gBACjC,IAAM,kBAAkB,GAAQ,EAAE,CAAC;gBACnC,kBAAkB,CAAC,YAAY,GAAG,SAAS,CAAC;gBAC5C,IAAI,CAAC,YAAY,GAAG,SAAS,CAAC;gBAC9B,IAAI,CAAC,qBAAqB,CAAC,kBAAkB,CAAC,CAAC;aAChD;SACF;;;;;QAMO,yDAAqB,GAA7B,UAA8B,kBAAuB;YACnD,IAAI,CAAC,IAAI,CAAC,uBAAuB,EAAE;gBACjC,IAAM,SAAS,GAAG,kBAAkB,CAAC,YAAY,CAAC;gBAClD,IAAI,CAAC,YAAY,CAAC,YAAY,GAAG,CAAC,SAAS,CAAC,CAAC;gBAC7C,IAAI,CAAC,YAAY,CAAC,kBAAkB,CAAC,IAAI,CAAC,IAAI,CAAC,YAAY,CAAC,YAAY,CAAC,CAAC;aAC3E;YAED,IAAI,CAAC,iBAAiB,CAAC,IAAI,CAAC,kBAAkB,CAAC,CAAC;SACjD;QAEO,2DAAuB,GAA/B;YACE,IAAI,OAAO,GAAG,KAAK,CAAC;YAEpB,IAAI,IAAI,CAAC,WAAW,IAAI,IAAI,CAAC,WAAW,CAAC,SAAS,IAAI,IAAI,CAAC,WAAW,CAAC,SAAS,CAAC,MAAM,GAAG,CAAC,EAAE;gBAC3F,OAAO,GAAG,IAAI,CAAC;aAChB;YAED,OAAO,OAAO,CAAC;SAChB;;;;QAKO,mDAAe,GAAvB,UAAwB,sBAA6B;YAArD,iBAgBC;YAfC,IAAI,CAAC,sBAAsB,EAAE;gBAC3B,OAAO;aACR;YAED,sBAAsB,CAAC,OAAO,CAAC,UAAC,EAAU;gBACxC,IAAM,KAAK,GAAG,KAAI,CAAC,YAAY,CAAC,YAAY,CAAC,OAAO,CAAC,EAAE,CAAC,CAAC;gBACzD,IAAI,KAAK,GAAG,CAAC,CAAC,EAAE;oBACd,KAAI,CAAC,YAAY,CAAC,YAAY,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC;;oBAGhD,IAAI,KAAI,CAAC,YAAY,CAAC,YAAY,CAAC,MAAM,KAAK,CAAC,EAAE;wBAC/C,KAAI,CAAC,qBAAqB,CAAC,EAAE,YAAY,EAAE,IAAI,EAAE,CAAC,CAAC;qBACpD;iBACF;aACF,CAAC,CAAC;SACJ;QAEO,oDAAgB,GAAxB,UAAyB,SAAiB;YACxC,IAAI,CAAC,SAAS,IAAI,SAAS,KAAK,EAAE,EAAE;gBAClC,OAAO;aACR;;YAGD,IAAI,IAAI,CAAC,uBAAuB,EAAE;gBAChC,OAAO;aACR;YAED,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,WAAW,CAAC,SAAS,EAAE,IAAI,CAAC,YAAY,CAAC,YAAY,CAAC,CAAC;SACrF;;;;QAKD,+CAAW,GAAX,UAAY,OAAsB;YAChC,iBAAM,WAAW,YAAC,OAAO,CAAC,CAAC;YAC3B,IAAI,CAAC,WAAW,EAAE,CAAC;SACpB;;;;QAKD,+CAAW,GAAX;YACE,IAAI,IAAI,CAAC,yBAAyB,EAAE;gBAClC,IAAI,CAAC,yBAAyB,CAAC,WAAW,EAAE,CAAC;aAC9C;SACF;QAEO,+CAAW,GAAnB,UAAoB,MAAe;;YAEjC,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC;;YAGzB,IAAI,CAAC,cAAc,EAAE,CAAC;SACvB;;;;;QAMO,4CAAQ,GAAhB;;;;;;;;;;SAUC;QAEO,+CAAW,GAAnB,UAAoB,MAAe;YACjC,IAAI,IAAI,GAAG,CAAC,CAAC;YACP,IAAA,+BAA4D,EAA1D,iBAAa,EAAb,kCAAa,EAAE,gBAAY,EAAZ,iCAA2C,CAAC;YACnE,IAAI,SAAS,GAAG,CAAC,EAAE;gBACjB,IAAI,GAAG,CAAC,SAAS,GAAG,CAAC,IAAI,QAAQ,CAAC;aACnC;YACD,IAAI,CAAC,WAAW,CAAC,QAAQ,EAAE,IAAI,CAAC,CAAC;YACjC,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC;YACzB,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC,EAAE,oBAAoB,EAAE,IAAI,EAAE,CAAC,CAAC;SACrE;;;;;QAKO,+CAAW,GAAnB,UAAoB,MAAe;YACjC,IAAM,SAAS,GAAG,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC;YACtC,IAAI,MAAM,IAAI,MAAM,CAAC,IAAI,KAAKD,iBAAU,CAAC,IAAI,IAAI,SAAS,EAAE;gBAC1D,IAAI,CAAC,IAAI,CAAC,UAAU,EAAE,CAAC;aACxB;SACF;QACO,kDAAc,GAAtB;YAAA,iBAQC;YAPC,IAAI,IAAI,CAAC,WAAW,EAAE;gBACpB,IAAI,CAAC,WAAW,CAAC,OAAO,CAAC,UAAA,OAAO;oBAC9B,IAAI,OAAO,CAAC,SAAS,EAAE;wBACrB,OAAO,CAAC,kBAAkB,CAAC,KAAI,CAAC,WAAW,CAAC,CAAC;qBAC9C;iBACF,CAAC,CAAC;aACJ;SACF;QAGM,gDAAY,GADnB,UACoB,KAAsB;YAClC,IAAA,gBAAoC,EAAlC,YAAQ,EAAR,6BAAQ,EAAE,YAAQ,EAAR,6BAAwB,CAAC;;YAE3C,IAAI,CAAC,WAAW,CAAC,aAAa,CAAC,IAAI,EAAE,IAAI,EAAE,IAAI,CAAC,SAAS,CAAC,WAAW,CAAC,CAAC;;YAEvE,sBAAsB,CAAC,sBAAsB,CAAC,IAAI,CAAC,IAAI,EAAE,IAAI,CAAC,QAAQ,CAAC,CAAC;SACzE;;;;QAIO,iDAAa,GAArB;YACU,IAAA,0CAAY,EAAZ,iCAAY,CAAgC;YACpD,IAAI,CAAC,WAAW,CAAC,aAAa,CAAC,CAAC,EAAE,QAAQ,EAAE,IAAI,CAAC,SAAS,CAAC,WAAW,CAAC,CAAC;SACzE;QACO,iDAAa,GAArB;;;;;;;;YAQE,IAAM,aAAa,GAA0B,EAAE,CAAC;YAChD,IAAI,IAAI,CAAC,eAAe,EAAE;;oBACxB,KAA6B,IAAA,KAAAE,SAAA,IAAI,CAAC,eAAe,CAAA,gBAAA,4BAAE;wBAA9C,IAAM,cAAc,WAAA;wBACvB,aAAa,CAAC,IAAI,CAAC,EAAE,KAAK,EAAE,cAAc,EAAE,SAAS,EAAE,KAAK,EAAE,CAAC,CAAC;qBACjE;;;;;;;;;;;;;;;aACF;YAED,IAAM,KAAK,GAAsB,EAAE,CAAC;YACpC,IAAI,IAAI,CAAC,UAAU,EAAE;gBACnB,KAAK,CAAC,IAAI,CAAC,EAAE,KAAK,EAAE,IAAI,CAAC,UAAU,EAAE,UAAU,EAAE,aAAa,EAAE,CAAC,CAAC;aACnE;YACD,IAAI,CAAC,KAAK,GAAG,KAAK,CAAC;SAEpB;;;;;QAMD,iDAAa,GAAb,UAAc,KAA2B;;;YAGvC,IAAI,KAAK,CAAC,IAAI,KAAK,IAAI,CAAC,WAAW,EAAE;gBACnC,KAAK,CAAC,IAAI,GAAG,IAAI,CAAC,WAAW,CAAC;aAC/B;;YAED,IAAI,CAAC,UAAU,CAAC,KAAK,CAAC,CAAC;YAEvB,IAAI,CAAC,MAAM,EAAE,CAAC;SACf;;;;;;;;;;;;QAcS,2CAAO,GAAjB,UAAkB,KAAY;;;;;;YAM5B,KAAK,CAAC,IAAI,GAAG,CAAC,CAAC;YACT,IAAA,+BAAoE,EAAlE,gBAAY,EAAZ,iCAAY,EAAE,aAAqB,EAArB,mCAAoD,CAAC;;YAE3E,IAAI,KAAK,CAAC,IAAI,KAAK,CAAC,EAAE;gBACpB,KAAK,CAAC,IAAI,GAAG,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC;aACtC;iBAAM;gBACL,KAAK,CAAC,IAAI,GAAG,QAAQ,CAAC;aACvB;;YAED,IAAM,UAAU,GAAG,KAAK,CAAC,IAAI,GAAG,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC;YACxD,IAAI,UAAU,EAAE;gBACd,KAAK,CAAC,IAAI,GAAG,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC;aACtC;YACD,IAAM,SAAS,GAAG,iBAAM,OAAO,YAAC,KAAK,CAAC,CAAC;;YAEvC,SAAS,CAAC,KAAK,GAAG,IAAI,CAAC,GAAG,CAAC,UAAU,EAAE,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC;;YAEhE,IAAI,UAAU,EAAE;gBACd,SAAS,CAAC,KAAK,GAAG,UAAU,IAAI,CAAC,CAAC;aACnC;YAED,OAAO,SAAS,CAAC;SAClB;;;;;QAOM,6DAAyB,GADhC,UACiC,YAAsB;YACrD,IAAI,EAAE,IAAI,CAAC,uBAAuB,CAAC,EAAE;;gBAEnC,IAAI,CAAC,2BAA2B,CAAC,YAAY,CAAC,YAAY,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,CAAC;aACzE;YAED,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,gBAAgB,CAAC,KAAK,EAAE,IAAI,CAAC,YAAY,CAAC,YAAY,CAAC,CAAC;SAChF;;;;;QAOM,0DAAsB,GAD7B,UAC8B,KAAU;YACtC,IAAI,IAAI,CAAC,uBAAuB,EAAE;gBAChC,IAAI,CAAC,4BAA4B,CAAC,IAAI,CAAC,IAAI,CAAC,OAAO,EAAE,KAAK,CAAC,CAAC;aAC7D;SACF;;;;QAKO,gEAA4B,GAApC,UAAqC,UAAsB,EAAE,KAAU;YACrE,sBAAsB,CAAC,4BAA4B,CAAC,UAAU,EAAE,KAAK,CAAC,CAAC;YACvE,IAAI,CAAC,sBAAsB,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;SACzC;;;;;QAOM,oDAAgB,GADvB,UACwB,KAAqB;YAC3C,IAAI,CAAC,cAAc,GAAG,KAAK,CAAC;YAC5B,IAAI,CAAC,cAAc,GAAG,KAAK,CAAC;YAC5B,IAAI,CAAC,QAAQ,GAAG,KAAK,CAAC,QAAQ,CAAC;YAC/B,IAAI,CAAC,WAAW,GAAG,KAAK,CAAC,WAAW,CAAC;YACrC,IAAI,CAAC,MAAM,GAAG,KAAK,CAAC,MAAM,CAAC;;YAG3B,IAAI,IAAI,CAAC,uBAAuB,IAAI,CAAC,IAAI,CAAC,UAAU,CAAC,SAAS,EAAE;gBAC9D,IAAM,eAAe,GAAG,KAAK,CAAC,QAAQ,CAAC;gBACvC,IAAI,eAAe,KAAK,IAAI,CAAC,YAAY,EAAE;oBACzC,IAAM,kBAAkB,GAAuB,IAAI,kBAAkB,EAAE,CAAC;oBACxE,kBAAkB,CAAC,eAAe,GAAG,eAAe,CAAC;oBACrD,kBAAkB,CAAC,YAAY,GAAG,IAAI,CAAC,YAAY,CAAC;oBAEpD,IAAI,CAAC,uBAAuB,CAAC,kBAAkB,CAAC,CAAC;iBAClD;aACF;;YAGD,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,qBAAqB,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC;YACzD,IAAI,CAAC,2BAA2B,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;;YAG9C,IAAI,CAAC,IAAI,CAAC,UAAU,EAAE,EAAE;gBACtB,OAAO;aACR;;YAKD,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,YAAY,EAAE;gBAC9B,OAAO;aACR;YACD,IAAI,KAAK,CAAC,IAAI,KAAK,OAAO,IAAI,CAAC,KAAK,CAAC,QAAQ,EAAE;;gBAI7C,IAAM,YAAY,GAAG,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,UAAU,CAAC,MAAM,CAAC,CAAC;gBAC7D,IAAM,OAAO,GAAU,IAAI,CAAC,UAAU,CAAC,YAAY,CAAC,CAAC;gBACrD,IAAM,kBAAkB,GAAG,OAAO,CAAC,SAAS,CAAC,UAAC,GAAQ,IAAK,OAAA,GAAG,CAAC,SAAS,KAAK,KAAK,CAAC,MAAM,CAAC,KAAK,GAAA,CAAC,CAAC;gBACjG,IAAM,YAAY,GAAG,OAAO,CAAC,KAAK,CAAC,CAAC,EAAE,kBAAkB,GAAG,CAAC,CAAC,CAAC,MAAM,CAAC,UAAA,GAAG,IAAI,OAAA,CAAC,GAAG,CAAC,OAAO,GAAA,CAAC,CAAC,MAAM,CAAC;;gBAGjG,IAAI,CAAC,QAAQ,GAAG,KAAK,CAAC,QAAQ,CAAC;gBAC/B,IAAI,CAAC,WAAW,GAAG,KAAK,CAAC,WAAW,GAAG,YAAY,CAAC;gBACpD,IAAI,CAAC,YAAY,GAAG,YAAY,CAAC;gBACjC,IAAI,CAAC,MAAM,GAAG,KAAK,CAAC,MAAM,CAAC;gBAE3B,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,QAAQ,EAAE,IAAI,CAAC,WAAW,CAAC,CAAC;aACnD;SACF;;;;QAKO,2DAAuB,GAA/B,UAAgC,kBAAsC;YACpE,sBAAsB,CAAC,qBAAqB,CAAC,IAAI,CAAC,IAAI,EAAE,kBAAkB,CAAC,CAAC;YAE5E,IAAI,CAAC,QAAQ,GAAG,kBAAkB,CAAC,eAAe,CAAC;YACnD,IAAI,CAAC,YAAY,GAAG,kBAAkB,CAAC,eAAe,CAAC;;YAEvD,IAAM,EAAE,GAAG,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;YAC1C,IAAI,CAAC,2BAA2B,CAAC,EAAE,CAAC,CAAC;SACtC;;;;;QAKO,8CAAU,GAAlB,UAAmB,GAAW;YAC5B,IAAI,IAAI,GAAQ,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC;YAC/B,IAAI,IAAI,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,IAAI,CAAC,cAAc,CAAC,MAAM,CAAC,EAAE;gBAC/D,IAAI,GAAG,IAAI,CAAC,IAAI,CAAC;aAClB;YACK,IAAA,+BAA4D,EAA1D,iBAAa,EAAb,kCAAa,EAAE,gBAAY,EAAZ,iCAA2C,CAAC;YACnE,IAAM,IAAI,GAAG,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC;;YAEnC,IAAM,SAAS,GAAG,QAAQ,KAAK,CAAC,IAAI,SAAS,KAAK,CAAC,GAAG,GAAG,GAAG,GAAG,GAAG,IAAI,CAAC;YACvE,IAAI,IAAI,CAAC,MAAM,GAAG,SAAS,EAAE;gBAC3B,OAAO,IAAI,CAAC,SAAS,CAAC,CAAC,IAAI,CAAC,WAAW,CAAC,UAAU,CAAC,CAAC;aACrD;YACD,OAAO,IAAI,CAAC;SACb;;;;;QAOM,oDAAgB,GADvB,UACwB,KAAU;YAEhC,IAAI,IAAI,CAAC,SAAS,CAAC,eAAe,EAAE,EAAE;gBACpC,KAAK,CAAC,cAAc,EAAE,CAAC;gBACvB,OAAO;aACR;YAED,IAAI,IAAI,CAAC,GAAG,EAAE;;gBAEZ,IAAI,IAAI,CAAC,GAAG,CAAC,YAAY,CAAC,gBAAgB,CAAC,EAAE;oBAC3C,KAAK,CAAC,cAAc,EAAE,CAAC;oBACvB,OAAO;iBACR;;gBAGD,IAAI,KAAK,CAAC,aAAa,EAAE;oBACvB,IAAI,IAAI,CAAC,GAAG,CAAC,SAAS,CAAC,KAAK,CAAC,aAAa,CAAC,CAAC,IAAI,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,CAAC,OAAO,KAAK,eAAe,GAAA,CAAC,EAAE;wBACpF,KAAK,CAAC,cAAc,EAAE,CAAC;wBACvB,OAAO;qBACR;iBACF;aACF;YAGO,IAAA,2BAAS,EAAEpB,wBAAM,EAAE,yBAAQ,EAAE,yBAAQ,CAAW;YACxD,IAAM,OAAO,GAAG,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,UAAU,CAAC,MAAM,CAAC,CAAC;YACxD,IAAI,UAAU,GAAG,OAAO,CAAC,IAAI,CAAC,UAAC,OAAY;gBACzC,OAAO,OAAO,CAAC,SAAS,KAAKA,SAAM,CAAC,KAAK,CAAC;aAC3C,CAAC,CAAC;YACH,IAAM,gBAAgB,GAAG,SAAS,CAAC,UAAU,CAAC,MAAM,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,KAAK,CAAC;YACzE,IAAI,UAAU,CAAC,cAAc,EAAE;;gBAE7B,UAAU,GAAG,UAAU,CAAC,cAAc,CAAC,QAAQ,EAAE,UAAU,CAAC,CAAC;aAC9D;YACD,IAAI,CAAC,QAAQ,CAAC,gBAAgB,EAAE,UAAU,CAAC,CAAC;SAC7C;;;;;QAOD,6CAAS,GADT,UACU,CAAM;YADhB,iBAqBC;;YAlBC,IAAI,CAAC,CAAC,CAAC,QAAQ,IAAI,CAAC,CAAC,OAAO,KAAK,EAAE,EAAE;;gBAEnC,CAAC,CAAC,cAAc,EAAE,CAAC;gBACnB,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE;oBAChB,OAAO;iBACR;;gBAED,CAAC,CAAC,MAAM,CAAC,IAAI,EAAE,CAAC;gBAChB,IAAI,CAAC,MAAM,CAAC,iBAAiB,CAAC;oBAC5B,UAAU,CAAC;wBACT,IAAI,KAAI,CAAC,GAAG,IAAI,KAAI,CAAC,GAAG,CAAC,YAAY,CAAC,gBAAgB,CAAC,EAAE;4BACvD,CAAC,CAAC,cAAc,EAAE,CAAC;4BACnB,OAAO;yBACR;wBACD,KAAI,CAAC,aAAa,EAAE,CAAC;qBACtB,EAAE,GAAG,CAAC,CAAC;iBACT,CAAC,CAAC;aACJ;SACF;;;;;QAMO,qDAAiB,GAAzB;YACE,IAAI,CAAC,IAAI,CAAC,uBAAuB,EAAE;gBACjC,OAAO;aACR;YACD,MAAM,CAAC,cAAc,CAAC,IAAI,CAAC,IAAI,EAAE,YAAY,EAAE,EAAE,KAAK,EAAE,IAAI,CAAC,uBAAuB,EAAE,CAAC,CAAC;SACzF;;;;;;QAOO,+CAAW,GAAnB,UAAoB,IAAY,EAAE,IAAY;YAC5C,IAAI,IAAI,KAAK,CAAC,EAAE;gBACd,IAAI,CAAC,WAAW,GAAG,CAAC,CAAC;gBACrB,IAAI,CAAC,QAAQ,GAAG,CAAC,CAAC;gBAClB,IAAI,CAAC,IAAI,GAAG,CAAC,CAAC;gBACd,IAAI,CAAC,IAAI,CAAC,QAAQ,GAAG,KAAK,CAAC;aAC5B;iBAAM;gBACL,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC;gBACxB,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC;gBACjB,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC;gBACrB,IAAI,CAAC,IAAI,CAAC,QAAQ,GAAG;oBACnB,WAAW,EAAE,EAAE;oBACf,IAAI,EAAE,IAAI;oBACV,IAAI,EAAE,SAAS;oBACf,SAAS,EAAE,KAAK;oBAChB,YAAY,EAAE,IAAI;iBACnB,CAAC;aACH;SACF;;;;;;;;;QAUD,+CAAW,GAAX,UAAY,SAAiB,EAAE,YAAoB;YACjD,IAAM,IAAI,GAAG,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;YAC9B,IAAA,+BAA4D,EAA1D,iBAAa,EAAb,kCAAa,EAAE,gBAAY,EAAZ,iCAA2C,CAAC;YACnE,IAAM,IAAI,GAAG,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC;;YAEnC,IAAM,aAAa,GAAG,QAAQ,KAAK,CAAC,IAAI,SAAS,KAAK,CAAC,GAAG,SAAS,GAAG,SAAS,GAAG,IAAI,CAAC;YACvF,IAAI,IAAI,GAAG,IAAI,CAAC,aAAa,CAAC,CAAC;YAC/B,IAAI,IAAI,CAAC,UAAU,CAAC,SAAS,EAAE;gBAC7B,IAAI,GAAG,IAAI,CAAC,YAAY,CAAC,IAAI,EAAE,aAAa,CAAC,CAAC;aAC/C;YACD,IAAM,YAAY,GAAG,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,UAAU,CAAC,MAAM,CAAC,CAAC;YAC7D,IAAM,OAAO,GAAG,IAAI,CAAC,UAAU,CAAC,YAAY,CAAC,CAAC;;;YAI9C,IAAI,SAAS,GAAG,YAAY,CAAC;;YAE7B,IAAI,IAAI,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC,cAAc,EAAE;gBAC1C,SAAS,GAAG,SAAS,GAAG,CAAC,CAAC;aAC3B;YACD,IAAI,IAAI,CAAC,IAAI,CAAC,UAAU,IAAI,IAAI,CAAC,IAAI,CAAC,UAAU,CAAC,MAAM,CAAC,KAAK,UAAU,EAAE;gBACvE,SAAS,GAAG,SAAS,GAAG,CAAC,CAAC;aAC3B;YACD,IAAM,GAAG,GAAG,OAAO,CAAC,SAAS,CAAC,CAAC;YAE/B,IAAM,MAAM,GAAG;gBACb,QAAQ,EAAE,IAAI;gBACd,MAAM,EAAE,GAAG;gBACX,QAAQ,EAAE,SAAS;gBACnB,WAAW,EAAE,SAAS;aACvB,CAAC;;YAGF,IAAI,GAAG,IAAI,CAAC,GAAG,CAAC,QAAQ,EAAE;gBACxB,GAAG,CAAC,QAAQ,GAAG,UAAC,KAAa,IAAK,OAAA,IAAI,GAAA,CAAC;aACxC;YACD,IAAI,GAAG,IAAI,IAAI,CAAC,WAAW,CAAC,GAAG,EAAE,MAAM,CAAC,EAAE;;gBAExC,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,qBAAqB,CAAC,IAAI,CAAC,CAAC;gBAC/C,IAAI,CAAC,2BAA2B,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;;;gBAG9C,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,SAAS,EAAE,YAAY,GAAG,IAAI,CAAC,YAAY,EAAE,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC;aACxF;SAEF;;;;QAID,+CAAW,GAAX,UAAY,SAAiB,EAAE,WAAmB;YAChD,IAAM,cAAc,GAAG,CAAC,WAAW,GAAG,CAAC,IAAI,IAAI,CAAC,GAAG,CAAC;YACpD,IAAI,CAAC,cAAc,EAAE;gBACnB,IAAM,OAAO,GAAG,IAAI,CAAC,WAAW,CAAC,MAAM,EAAE,CAAC,MAAM,CAAC;gBACjD,IAAM,WAAW,GAAG,CAAC,SAAS,GAAG,CAAC,IAAI,OAAO,CAAC;gBAC9C,OAAO,EAAE,QAAQ,EAAE,WAAW,EAAE,WAAW,EAAE,cAAc,EAAE,CAAC;aAC/D;YACD,OAAO;gBACL,QAAQ,EAAE,SAAS;gBACnB,WAAW,EAAE,cAAc;aAC5B,CAAC;SACH;;QAGD,+CAAW,GAAX,UAAYA,SAAW,EAAE,KAAU;YACjC,IAAI,CAACA,SAAM,EAAE;gBACX,OAAO,KAAK,CAAC;aACd;YACD,OAAOA,SAAM,CAAC,QAAQ,CAAC,KAAK,CAAC,IAAI,CAACA,SAAM,CAAC,MAAM,CAAC,QAAQ,CAAC;SAC1D;;;;QAKD,4CAAQ,GAAR,UAAS,KAAU,EAAEA,SAAW;YAC9B,IAAM,iBAAiB,GAAGA,SAAM,CAAC,QAAQ,CAAC;;YAE1C,IAAM,WAAW,GAAG,IAAI,CAAC,SAAS,CAAC,WAAW,CAAC;YAC/C,IAAM,UAAU,GAAG,IAAI,CAAC,aAAa,CAAC,WAAW,CAAC,WAAW,EAAEA,SAAM,CAAC,SAAS,CAAC,CAAC;;YAEjF,IAAI,iBAAiB,KAAK,MAAM,EAAE;gBAChC,IAAI,OAAO,GAAG,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC,KAAK,EAAE,qBAAqB,CAAC,CAAC;gBACtE,IAAI,CAAC,OAAO,EAAE;oBACZ,OAAO,GAAG,EAAE,CAAC;iBACd;gBACD,IAAI,CAAC,SAAS,CAAC,WAAW,CAAC,QAAQ,CAAC,UAAU,EAAE,OAAO,EAAE,IAAI,EAAE,IAAI,CAAC,CAAC;aACtE;iBAAM;gBACL,IAAI,CAAC,SAAS,CAAC,WAAW,CAAC,QAAQ,CAAC,UAAU,EAAE,KAAK,EAAE,IAAI,EAAE,IAAI,CAAC,CAAC;aACpE;SACF;;QAGD,gDAAY,GAAZ,UAAa,IAAW,EAAE,SAAiB;YACzC,IAAI,KAAK,GAAG,SAAS,CAAC;YACtB,KAAK,IAAM,CAAC,IAAI,IAAI,EAAE;gBACpB,IAAI,KAAK,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,MAAM,EAAE;oBAChC,OAAO,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC;iBAC7B;qBAAM;oBACL,KAAK,GAAG,KAAK,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,MAAM,CAAC;iBACtC;aACF;SACF;;;;;;QAOD,4CAAQ,GAAR,UAAS,QAAa,EAAE,KAAa;YACnC,IAAM,KAAK,GAAG,KAAK,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC;YACjC,IAAI,KAAK,GAAG,CAAC,EAAE;gBACb,OAAO,QAAQ,CAAC,KAAK,CAAC,CAAC;aACxB;YACD,IAAM,MAAM,GAAG,KAAK,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;;YAEhC,OAAO,MAAM,CAAC,MAAM,CAAC,UAAC,MAAW,EAAE,IAAS;gBAC1C,OAAO,MAAM,CAAC,IAAI,CAAC,CAAC;aACrB,EAAE,QAAQ,CAAC,CAAC;SACd;;;;;;QAOO,iDAAa,GAArB,UAAsB,WAAmB,EAAE,KAAa;YACtD,IAAI,SAAS,GAAG,EAAE,CAAC;YACnB,IAAI,WAAW,CAAC,MAAM,GAAG,CAAC,EAAE;gBAC1B,SAAS,GAAG,WAAW,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC,KAAK,EAAE,GAAG,CAAC,GAAG,GAAG,GAAG,KAAK,CAAC;aACrE;iBAAM;gBACL,SAAS,GAAG,KAAK,CAAC;aACnB;YACD,OAAO,SAAS,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;SAC7B;;;;QAKD,iDAAa,GAAb;YAAA,iBAsBC;YArBC,IAAM,KAAK,GAAG,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,QAAQ,EAAE,IAAI,CAAC,WAAW,CAAC,CAAC;YAChE,IAAI,CAAC,KAAK,CAAC,WAAW,IAAI,CAAC,KAAK,CAAC,QAAQ,EAAE;gBACzC,IAAM,KAAG,GAAG,IAAI,CAAC,WAAW,CAAC,MAAM,EAAE,CAAC,MAAM,CAAC;;gBAE7C,IAAI,CAAC,SAAS,CAAC,IAAI,EAAE,CAAC;gBACtB,IAAI,IAAI,CAAC,SAAS,CAAC,SAAS,IAAI,IAAI,CAAC,SAAS,CAAC,SAAS,CAAC,MAAM,EAAE;oBAC/D,IAAI,CAAC,QAAQ,GAAG,WAAW,CAAC;wBAC1B,IAAI,KAAI,CAAC,WAAW,CAAC,MAAM,EAAE,CAAC,MAAM,GAAG,CAAC,KAAK,KAAG,EAAE;4BAChD,KAAI,CAAC,WAAW,CAAC,KAAI,CAAC,WAAW,CAAC,MAAM,EAAE,CAAC,MAAM,GAAG,CAAC,EAAE,CAAC,CAAC,CAAC;4BAC1D,KAAI,CAAC,QAAQ,GAAG,KAAI,CAAC,WAAW,CAAC,MAAM,EAAE,CAAC,MAAM,GAAG,CAAC,CAAC;4BACrD,KAAI,CAAC,WAAW,GAAG,CAAC,CAAC;4BACrB,aAAa,CAAC,KAAI,CAAC,QAAQ,CAAC,CAAC;yBAC9B;qBACF,EAAE,CAAC,CAAC,CAAC;oBACN,OAAO;iBACR;aACF;YAED,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC,QAAQ,EAAE,KAAK,CAAC,WAAW,CAAC,CAAC;YACpD,IAAI,CAAC,QAAQ,GAAG,KAAK,CAAC,QAAQ,CAAC;YAC/B,IAAI,CAAC,WAAW,GAAG,KAAK,CAAC,WAAW,CAAC;SACtC;;QAGD,8CAAU,GAAV,UAAW,OAAY;;YAErB,IAAM,SAAS,GAAG,OAAO,CAAC,IAAI,CAAC,UAAC,GAAQ;gBACtC,OAAO,GAAG,CAAC,MAAM,CAAC;aACnB,CAAC,CAAC;YACH,IAAI,SAAS,EAAE;gBACb,IAAM,aAAa,GAAG,OAAO,CAAC,MAAM,CAAC,UAAC,GAAQ;oBAC5C,OAAO,GAAG,CAAC,MAAM,CAAC;iBACnB,CAAC,CAAC;gBACH,IAAM,gBAAgB,GAAG,OAAO,CAAC,MAAM,CAAC,UAAC,GAAQ;oBAC/C,OAAO,CAAC,GAAG,CAAC,MAAM,CAAC;iBACpB,CAAC,CAAC;gBACH,gBAAW,aAAa,EAAK,gBAAgB,EAAE;aAChD;YACD,OAAO,OAAO,CAAC;SAChB;;;;QAKO,sDAAkB,GAA1B,UAA2B,GAAW,EAAE,YAAmB;YACzD,IAAI,CAAC,GAAG,IAAI,GAAG,KAAK,EAAE,EAAE;gBACtB,OAAO;aACR;;YAGD,IAAI,IAAI,CAAC,uBAAuB,EAAE;gBAChC,IAAM,KAAK,GAAG,YAAY,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC;gBACxC,IAAI,KAAK,IAAI,CAAC,EAAE;oBACd,OAAO;iBACR;gBAED,YAAY,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;aACxB;iBAAM;gBACL,IAAI,YAAY,CAAC,MAAM,KAAK,CAAC,IAAI,YAAY,CAAC,CAAC,CAAC,KAAK,GAAG,EAAE;oBACxD,OAAO;iBACR;gBAED,YAAY,CAAC,MAAM,CAAC,CAAC,EAAE,YAAY,CAAC,MAAM,CAAC,CAAC;gBAC5C,YAAY,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;aACxB;YAED,IAAI,CAAC,YAAY,CAAC,kBAAkB,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;SACzD;;;;;QAMO,yDAAqB,GAA7B,UAA8B,QAAa;YACzC,IAAM,UAAU,GAAG,IAAI,CAAC,WAAW,CAAC,UAAU,CAAC;YAC/C,OAAO,QAAQ,CAAC,UAAU,CAAC,CAAC;SAC7B;;;;;QAMO,+DAA2B,GAAnC,UAAoC,EAAU;YAC5C,IAAI,CAAC,WAAW,CAAC,YAAY,CAAC,EAAE,EAAE,IAAI,CAAC,CAAC;SACzC;;;;QAKD,8CAAU,GAAV;YACE,IAAI,IAAI,CAAC,QAAQ,KAAK,SAAS,EAAE;gBAC/B,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,YAAY,EAAE;;oBAEhC,OAAO,KAAK,CAAC;iBACd;;gBAED,OAAO,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC,UAAU,CAAC,CAAC;aAChD;;YAED,OAAO,IAAI,CAAC,QAAQ,CAAC;SACtB;;QAED,iDAAa,GAAb;;YACE,IAAI,cAAc,GAAG,KAAK,CAAC;YAC3B,IAAM,WAAW,GAAG,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC,UAAU,CAAC,gBAAgB,CAAC,OAAO,EAAE,CAAC;;gBACtF,KAAqB,IAAA,gBAAAoB,SAAA,WAAW,CAAA,wCAAA,iEAAE;oBAA7B,IAAM,MAAM,wBAAA;oBACf,IAAI,MAAM,CAAC,OAAO,CAAC,MAAM,GAAG,CAAC,EAAE;wBAC7B,cAAc,GAAG,IAAI,CAAC;wBACtB,MAAM;qBACP;iBACF;;;;;;;;;;;;;;;YACD,OAAO,cAAc,CAAC;SACvB;;oBApnCFd,cAAS,SAAC;wBACT,QAAQ,EAAE,qBAAqB;qBAChC;;;;;wBArBCS,kBAAW;wBACIM,cAAO,uBA8LnBC,aAAQ;wBA9LXC,oBAAa,uBA+LVD,aAAQ;wBA/LmBV,gBAAS,uBAgMpCU,aAAQ;wBAxMXE,8BAAa;wBACbC,mCAAkB;wBASXC,sBAAa;wBAEbxB,0BAAqB;wBACrB,4BAA4B;wBAF5ByB,4BAAmB;wBAfoCb,WAAM;;;;+BAuCnEL,UAAK,SAAC,gBAAgB;2BAMtBA,UAAK,SAAC,YAAY;iCAMlBA,UAAK,SAAC,YAAY;sCAGlBA,UAAK,SAAC,iBAAiB;8CAIvBA,UAAK;mCAILA,UAAK;gCAOLmB,WAAM,SAAC,YAAY;sCAGnBA,WAAM;+BAGNA,WAAM;wCAyENA,WAAM;6CAKNA,WAAM;kCAwCNC,oBAAe,SAAC,4BAA4B;mCA4Y5CnB,iBAAY,SAAC,YAAY,EAAE,CAAC,QAAQ,CAAC;gDAoGrCA,iBAAY,SAAC,oBAAoB,EAAE,CAAC,QAAQ,CAAC;6CAc7CA,iBAAY,SAAC,iBAAiB,EAAE,CAAC,QAAQ,CAAC;uCAmB1CA,iBAAY,SAAC,WAAW,EAAE,CAAC,QAAQ,CAAC;uCAyFpCA,iBAAY,SAAC,WAAW,EAAE,CAAC,QAAQ,CAAC;gCA0CpCA,iBAAY,SAAC,SAAS,EAAE,CAAC,QAAQ,CAAC;;QA8TrC,gCAAC;KAAA,CAlnC8CoB,qCAAoB;;ICzBnE;IACA;;;;;IAKA;;;;QAME,6BAAY,YAAmB,EAAE,YAAwB,EAAE,UAAkB,EAAE,gBAAwB,EAAE,OAAa;YAL9G,eAAU,GAA+B,EAAE,CAAC;;;;;;;;YA6C5C,oBAAe,GAAU,EAAE,CAAC;YAvClC,IAAI,CAAC,UAAU,GAAG,UAAU,CAAC;YAC7B,IAAI,CAAC,gBAAgB,GAAG,gBAAgB,CAAC;YACzC,IAAI,CAAC,QAAQ,GAAG,EAAE,CAAC;YACnB,IAAI,CAAC,YAAY,GAAG,YAAY,CAAC;YACjC,IAAI,CAAC,OAAO,GAAG,OAAO,IAAI,EAAE,CAAC;YAC7B,IAAI,CAAC,eAAe,GAAG,EAAE,CAAC;YAC1B,IAAI,CAAC,iBAAiB,GAAG,OAAO,IAAI,OAAO,CAAC,iBAAiB,IAAI,EAAE,CAAC;YACpE,IAAI,CAAC,YAAY,GAAG,OAAO,IAAI,OAAO,CAAC,YAAY,IAAI,IAAI,CAAC;YAC5D,IAAI,CAAC,2BAA2B,CAAC,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;YAErE,IAAI,CAAC,cAAc,EAAE,CAAC;YACtB,IAAI,CAAC,WAAW,GAAG,IAAI,GAAG,EAAoB,CAAC;YAC/C,IAAI,CAAC,cAAc,GAAG,IAAI,GAAG,EAAoB,CAAC;YAClD,IAAI,CAAC,iBAAiB,CAAC,YAAY,CAAC,CAAC;SACtC;QAKD,sBAAY,4CAAW;;;;;iBAAvB;gBACE,OAAO,IAAI,CAAC,OAAO,IAAI,IAAI,CAAC,OAAO,CAAC,cAAc,CAAC,aAAa,CAAC,GAAG,IAAI,CAAC,OAAO,CAAC,aAAa,CAAC,GAAG,CAAC,CAAC,CAAC;aACtG;;;WAAA;QACD,sBAAY,0CAAS;iBAArB;gBACE,OAAO,IAAI,CAAC,OAAO,IAAI,IAAI,CAAC,OAAO,CAAC,WAAW,CAAC,CAAC;aAClD;;;WAAA;QACD,sBAAY,4DAA2B;iBAAvC;gBACE,OAAO,IAAI,CAAC,OAAO,IAAI,IAAI,CAAC,OAAO,CAAC,6BAA6B,CAAC,IAAI,UAAU,IAAS,KAAK,CAAC;aAChG;;;WAAA;QA+CM,4CAAc,GAArB,UAAsB,YAAiB,EAAE,IAAS;YAChD,IAAI,CAAC,YAAY,GAAG,YAAY,CAAC;YACjC,IAAI,CAAC,cAAc,EAAE,CAAC;YACtB,IAAI,CAAC,iBAAiB,CAAC,IAAI,CAAC,CAAC;SAC9B;QACM,mCAAK,GAAZ;YAAA,iBAqCC;YApCC,IAAM,IAAI,GAAe,EAAE,CAAC;YAC5B,IAAM,UAAU,GAAG,EAAE,CAAC;YACtB,IAAM,KAAK,GAAG,EAAE,CAAC;YACjB,IAAI,CAAC,YAAY,CAAC,OAAO,CAAC,UAAA,IAAI;gBAC5B,IAAM,EAAE,GAAG,IAAI,CAAC,EAAE,CAAC;gBACnB,IAAM,QAAQ,GAAG,KAAI,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC;;;gBAIxC,IAAM,SAAS,GAAG,KAAI,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC;gBACvC,IAAI,SAAS,KAAK,IAAI,EAAE;oBACtB,KAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,CAAC;iBAC7B;;gBAED,IAAM,IAAI,GAAG,KAAI,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC;gBAClC,KAAK,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC;gBACjB,UAAU,CAAC,EAAE,CAAC,GAAG,UAAU,CAAC,EAAE,CAAC,IAAI,EAAE,CAAC;gBACtC,IAAI,CAAC,QAAQ,GAAG,UAAU,CAAC,EAAE,CAAC,CAAC;gBAE/B,KAAI,CAAC,WAAW,CAAC,GAAG,CAAC,IAAI,CAAC,KAAI,CAAC,UAAU,CAAC,EAAE,IAAI,CAAC,CAAC;gBAClD,IAAI,QAAQ,EAAE;oBACZ,IAAI,KAAK,CAAC,QAAQ,CAAC,IAAI,KAAK,CAAC,QAAQ,CAAC,CAAC,aAAa,KAAK,IAAI,EAAE;wBAC7D,KAAK,CAAC,QAAQ,CAAC,CAAC,QAAQ,GAAG,IAAI,CAAC;wBAChC,KAAK,CAAC,QAAQ,CAAC,CAAC,aAAa,GAAG,KAAK,CAAC;qBACvC;oBACD,UAAU,CAAC,QAAQ,CAAC,GAAG,UAAU,CAAC,QAAQ,CAAC,IAAI,EAAE,CAAC;oBAClD,UAAU,CAAC,QAAQ,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;iBACjC;qBAAM;oBACL,IAAI,CAAC,CAAC,IAAI,CAAC,QAAQ,IAAI,IAAI,CAAC,QAAQ,CAAC,MAAM,GAAG,CAAC,KAAK,IAAI,CAAC,QAAQ,KAAK,IAAI,EAAE;wBAC1E,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC;wBAC1B,IAAI,CAAC,QAAQ,GAAG,KAAK,CAAC;qBACvB;oBACD,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;iBACjB;aACF,CAAC,CAAC;YACH,OAAO,IAAI,CAAC;SACb;;;;QAIM,oCAAM,GAAb;YAAA,iBAmBC;YAlBC,IAAI,QAAQ,CAAC;;YAEb,IAAI,CAAC,YAAY,CAAC,OAAO,CAAC,UAAA,IAAI;gBAC5B,IAAM,aAAa,GAAG,KAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,CAAC;gBAClD,IAAI,aAAa,EAAE;oBACjB,IAAM,KAAK,GAAG,aAAa,CAAC,OAAO,CAAC,CAAC;oBACrC,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,EAAE;wBACjB,IAAI,QAAQ,KAAK,SAAS,EAAE;4BAC1B,QAAQ,GAAG,KAAK,CAAC;yBAClB;6BAAM,IAAI,KAAK,GAAG,QAAQ,EAAE;4BAC3B,QAAQ,GAAG,KAAK,CAAC;yBAClB;qBACF;iBACF;aACF,CAAC,CAAC;YACH,IAAM,QAAQ,GAAG,QAAQ,GAAG,CAAC,CAAC;YAC9B,IAAI,CAAC,UAAU,CAAC,EAAE,EAAE,QAAQ,EAAE,IAAI,CAAC,YAAY,EAAE,IAAI,CAAC,QAAQ,CAAC,CAAC;YAChE,OAAO,IAAI,CAAC,QAAQ,CAAC;SACtB;;;;QAKO,wCAAU,GAAlB,UAAmB,KAAa,EAAE,MAAc,EAAE,YAAmB,EAAE,SAAqB;YAA5F,iBAoBC;YAnBC,IAAM,cAAc,GAAG,IAAI,CAAC,iBAAiB,CAAC,KAAK,EAAE,MAAM,CAAC,CAAC;YAC7D,cAAc,CAAC,OAAO,CAAC,UAAC,QAAa;;gBAEnC,IAAM,SAAS,GAAG,KAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,CAAC;gBAC3C,IAAI,SAAS,KAAK,IAAI,EAAE;oBACtB,KAAI,CAAC,gBAAgB,CAAC,QAAQ,CAAC,CAAC;iBACjC;;gBAGD,IAAM,IAAI,GAAG,KAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,CAAC;gBACtC,SAAS,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;gBACrB,KAAI,CAAC,WAAW,CAAC,GAAG,CAAC,QAAQ,CAAC,KAAI,CAAC,UAAU,CAAC,EAAE,IAAI,CAAC,CAAC;;gBAGtD,IAAM,aAAa,GAAG,KAAI,CAAC,gBAAgB,CAAC,QAAQ,CAAC,CAAC;gBACtD,IAAM,YAAY,GAAG,aAAa,CAAC,OAAO,CAAC,CAAC;gBAC5C,IAAM,WAAW,GAAG,aAAa,CAAC,MAAM,CAAC,CAAC;gBAC1C,KAAI,CAAC,UAAU,CAAC,WAAW,EAAE,YAAY,EAAE,YAAY,EAAE,IAAI,CAAC,QAAsB,CAAC,CAAC;aACvF,CAAC,CAAC;SACJ;;;;QAKO,uCAAS,GAAjB,UAAkB,QAAa;YAC7B,IAAM,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC;;YAErC,IAAM,YAAY,GAAG,IAAI,CAAC,YAAY,CAAC,QAAQ,CAAC,CAAC;;YAEjD,IAAM,kBAAkB,GAAG,IAAI,CAAC,UAAU,CAAC,QAAQ,CAAC,CAAC;;YAErD,IAAI,CAAC,kBAAkB,IAAI,YAAY,EAAE;gBACvC,IAAI,CAAC,UAAU,CAAC,QAAQ,CAAC,CAAC;aAC3B;YACD,IAAM,cAAc,GAAG,IAAI,CAAC,mBAAmB,CAAC,QAAQ,CAAC,CAAC;YAC1D,IAAM,QAAQ,GAAa;gBACzB,IAAI,EAAE,MAAM,CAAC,MAAM,CAAC,EAAE,EAAE,QAAQ,CAAC;gBACjC,QAAQ,EAAE,EAAE;gBACZ,QAAQ,EAAE,YAAY;gBACtB,IAAI,EAAE,MAAM;aACb,CAAC;YACF,IAAI,cAAc,EAAE;gBAClB,QAAQ,CAAC,UAAU,GAAG,cAAc,CAAC;aACtC;YACD,OAAO,QAAQ,CAAC;SACjB;;;;;;QAMO,iDAAmB,GAA3B,UAA4B,QAAa;YACvC,IAAI,MAAM,GAAG,IAAI,CAAC;YAClB,IAAI,IAAI,CAAC,YAAY,EAAE;gBACrB,IAAM,EAAE,GAAG,IAAI,CAAC,UAAU,CAAC,QAAQ,CAAC,CAAC;;gBAErC,IAAM,GAAG,GAAG,WAAS,EAAE,sBAAmB,CAAC;gBAC3C,IAAM,UAAU,GAAG,IAAI,CAAC,YAAY,CAAC,MAAM,CAAC,GAAG,CAAC,GAAG,CAAC,IAAI,IAAI,CAAC;gBAC7D,IAAI,UAAU,IAAI,UAAU,CAAC,SAAS,GAAG,CAAC,EAAE;oBAC1C,MAAM,GAAG;wBACP,SAAS,EAAE,UAAU,CAAC,SAAS;wBAC/B,QAAQ,EAAE,UAAU,CAAC,QAAQ;wBAC7B,KAAK,EAAE,UAAU,CAAC,UAAU;qBAC7B,CAAC;iBACH;aACF;YACD,OAAO,MAAM,CAAC;SACf;;;;;QAKO,0CAAY,GAApB,UAAqB,QAAa;YAC1B,IAAA,oEAAsE,EAArE,aAAK,EAAE,cAA8D,CAAC;;YAE7E,IAAI,MAAM,EAAE;gBACV,OAAO,KAAK,CAAC;aACd;YACD,IAAI,QAAQ,GAAG,IAAI,CAAC,UAAU,CAAC,QAAQ,CAAC,CAAC;YACzC,IAAI,CAAC,QAAQ,EAAE;gBACb,IAAM,IAAE,GAAG,IAAI,CAAC,UAAU,CAAC,QAAQ,CAAC,CAAC;gBACrC,IAAI,IAAI,CAAC,eAAe,CAAC,SAAS,CAAC,UAAA,IAAI,IAAI,OAAA,IAAI,IAAI,IAAI,CAAC,EAAE,KAAK,IAAE,GAAA,CAAC,GAAG,CAAC,CAAC,EAAE;oBACvE,OAAO,KAAK,CAAC;iBACd;gBACD,IAAI,IAAI,CAAC,iBAAiB,CAAC,SAAS,CAAC,UAAA,MAAM,IAAI,OAAA,MAAM,KAAK,IAAE,GAAA,CAAC,GAAG,CAAC,CAAC,EAAE;oBAClE,OAAO,IAAI,CAAC;iBACb;gBACD,IAAI,IAAI,CAAC,WAAW,KAAK,CAAC,CAAC,EAAE;;oBAE3B,QAAQ,GAAG,KAAK,CAAC;iBAClB;qBAAM,IAAI,IAAI,CAAC,WAAW,KAAK,CAAC,EAAE;;oBAEjC,QAAQ,GAAG,IAAI,CAAC;iBACjB;qBAAM;;oBAEL,QAAQ,GAAG,KAAK,IAAI,IAAI,CAAC,WAAW,CAAC;;oBAErC,IAAM,WAAW,GAAG,IAAI,CAAC,UAAU,CAAC,QAAQ,CAAC,CAAC;oBAC9C,IAAI,WAAW,IAAI,CAAC,WAAW,CAAC,QAAQ,EAAE;wBACxC,QAAQ,GAAG,KAAK,CAAC;qBAClB;iBACF;aACF;YACD,OAAO,QAAQ,CAAC;SACjB;;;;;;QAMO,wCAAU,GAAlB,UAAmB,QAAa;YACxB,IAAA,yEAAyE,EAAxE,YAAI,EAAE,aAAkE,CAAC;YAChF,IAAM,MAAM,GAAG,IAAI,CAAC,iBAAiB,CAAC,IAAI,EAAE,KAAK,CAAC,CAAC;;YAGnD,IAAI,CAAC,MAAM,IAAI,MAAM,CAAC,MAAM,GAAG,CAAC,EAAE;;gBAEhC,IAAM,IAAE,GAAG,IAAI,CAAC,UAAU,CAAC,QAAQ,CAAC,CAAC;gBACrC,IAAI,IAAI,CAAC,eAAe,CAAC,SAAS,CAAC,UAAA,IAAI,IAAI,OAAA,IAAI,IAAI,IAAI,CAAC,EAAE,KAAK,IAAE,GAAA,CAAC,GAAG,CAAC,EAAE;oBACtE,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,EAAE,EAAE,MAAA,EAAE,QAAQ,EAAE,KAAK,EAAE,CAAC,CAAC;iBACpD;aACF;SACF;;;;QAIO,gDAAkB,GAA1B;YACE,IAAM,KAAK,GAAG,IAAI,CAAC,eAAe,CAAC,SAAS,CAAC,UAAA,IAAI,IAAI,OAAA,CAAC,IAAI,CAAC,QAAQ,GAAA,CAAC,CAAC;YACrE,IAAM,QAAQ,GAAG,IAAI,CAAC,eAAe,CAAC,KAAK,CAAC,IAAI,EAAE,CAAC;YAC3C,IAAA,gBAAE,CAAc;YACxB,IAAI,EAAE,EAAE;gBACN,IAAM,OAAO,GAAG,IAAI,CAAC,SAAS,CAAC,WAAW,CAAC,EAAE,CAAC,CAAC;gBAC/C,IAAI,OAAO,EAAE;oBACX,QAAQ,CAAC,QAAQ,GAAG,IAAI,CAAC;;;;oBAIzB,IAAI,CAAC,SAAS,CAAC,UAAU,CAAC,EAAE,CAAC,CAAC;iBAC/B;aACF;SACF;;;;;QAKO,wCAAU,GAAlB,UAAmB,QAAa;YAC9B,OAAO,QAAQ,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;SAClC;;;;;QAMO,+CAAiB,GAAzB,UAA0B,KAAa,EAAE,MAAc;YAAvD,iBAkBC;YAjBC,IAAM,cAAc,GAAG,EAAE,CAAC;YAC1B,IAAI,CAAC,YAAY,CAAC,OAAO,CAAC,UAAC,QAAa;;gBAGtC,IAAM,aAAa,GAAG,KAAI,CAAC,gBAAgB,CAAC,QAAQ,CAAC,CAAC;gBACtD,IAAI,CAAC,aAAa,EAAE;oBAClB,OAAO;iBACR;;gBAGD,IAAM,YAAY,GAAG,aAAa,CAAC,OAAO,CAAC,CAAC;gBAC5C,IAAM,WAAW,GAAG,aAAa,CAAC,MAAM,CAAC,CAAC;gBAC1C,IAAI,CAAC,YAAY,KAAK,MAAM,GAAG,CAAC,KAAK,WAAW,IAAI,WAAW,CAAC,UAAU,CAAC,KAAK,CAAC,EAAE;oBACjF,cAAc,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;iBAC/B;aACF,CAAC,CAAC;YACH,OAAO,cAAc,CAAC;SACvB;QAEO,8CAAgB,GAAxB,UAAyB,QAAa;YACpC,OAAO,IAAI,CAAC,QAAQ,CAAC,QAAQ,EAAE,IAAI,CAAC,gBAAgB,CAAC,CAAC;SACvD;QAEO,4CAAc,GAAtB;YAAA,iBAWC;YAVC,IAAI,CAAC,UAAU,GAAG,EAAE,CAAC;YACrB,IAAI,CAAC,YAAY,CAAC,OAAO,CAAC,UAAC,QAAQ;gBACjC,IAAM,aAAa,GAAG,KAAI,CAAC,gBAAgB,CAAC,QAAQ,CAAC,CAAC;gBACtD,IAAM,GAAG,GAAG,UAAQ,aAAa,CAAC,KAAO,CAAC;gBAC1C,IAAI,KAAI,CAAC,UAAU,CAAC,GAAG,CAAC,EAAE;oBACxB,KAAI,CAAC,UAAU,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;iBACrC;qBAAM;oBACL,KAAI,CAAC,UAAU,CAAC,GAAG,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC;iBACnC;aACF,CAAC,CAAC;SACJ;QACO,yCAAW,GAAnB,UAAoB,IAAS;YAA7B,iBAeC;YAdC,IAAM,aAAa,GAAG,IAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,CAAC;YAClD,IAAM,gBAAgB,GAAG,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,gBAAgB,CAAC,aAAa,CAAC,KAAK,GAAG,CAAC,CAAC,CAAC,IAAI,EAAE,CAAC;YAC/F,IAAM,MAAM,GAAG,gBAAgB,CAAC,IAAI,CAAC,UAAA,QAAQ;gBAC3C,IAAM,oBAAoB,GAAG,KAAI,CAAC,gBAAgB,CAAC,QAAQ,CAAC,CAAC;gBAC7D,IAAI,oBAAoB,CAAC,QAAQ,KAAK,IAAI,EAAE;oBAC1C,OAAO,KAAK,CAAC;iBACd;gBACD,OAAO,aAAa,CAAC,IAAI,CAAC,UAAU,CAAC,oBAAoB,CAAC,IAAI,CAAC,CAAC;aACjE,CAAC,CAAC;YACH,IAAI,MAAM,EAAE;gBACV,OAAO,MAAM,CAAC,EAAE,CAAC;aAClB;iBAAM;gBACL,OAAO,IAAI,CAAC;aACb;SACF;QACO,8CAAgB,GAAxB,UAAyB,KAAU;YACjC,OAAO,UAAQ,KAAO,CAAC;SACxB;;;;;;QAMO,sCAAQ,GAAhB,UAAiB,MAAW,EAAE,IAAY;YACxC,IAAI,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC,EAAE;gBAC5B,OAAO,MAAM,CAAC,IAAI,CAAC,CAAC;aACrB;YACD,IAAM,KAAK,GAAQ,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,GAAA,CAAC,CAAC;YAClD,IAAI,KAAK,CAAC,MAAM,GAAG,CAAC,EAAE;gBACpB,OAAO,MAAM,CAAC;aACf;YACD,OAAO,KAAK,CAAC,MAAM,CAAC,UAAC,MAAM,EAAE,IAAI;gBAC/B,OAAO,MAAM,IAAI,MAAM,CAAC,IAAI,CAAC,CAAC;aAC/B,EAAE,MAAM,CAAC,CAAC;SACZ;;;;;QAKO,0CAAY,GAApB,UAAqB,QAAa;YAChC,IAAM,aAAa,GAAG,IAAI,CAAC,gBAAgB,CAAC,QAAQ,CAAC,CAAC;YACtD,OAAO,aAAa,CAAC,OAAO,CAAC,CAAC;SAC/B;;;;;QAKO,yCAAW,GAAnB,UAAoB,QAAa;YAC/B,IAAM,aAAa,GAAG,IAAI,CAAC,gBAAgB,CAAC,QAAQ,CAAC,CAAC;YACtD,OAAO,aAAa,CAAC,MAAM,CAAC,CAAC;SAC9B;;;;QAIO,wCAAU,GAAlB,UAAmB,OAAY;YAC7B,IAAM,WAAW,GAAG,IAAI,CAAC,UAAU,CAAC,OAAO,CAAC,CAAC;YAC7C,OAAO,WAAW,GAAG,WAAW,CAAC,QAAQ,GAAG,SAAS,CAAC;SACvD;;;;;QAMO,oCAAM,GAAd,UAAe,QAAa;YAC1B,IAAM,aAAa,GAAG,IAAI,CAAC,gBAAgB,CAAC,QAAQ,CAAC,CAAC;YACtD,IAAM,QAAQ,GAAG,aAAa,CAAC,UAAU,CAAC,CAAC;YAC3C,OAAO,QAAQ,CAAC;SACjB;;;;;;;;QASO,uCAAS,GAAjB,UAAkB,QAAa;YAC7B,IAAI,IAAI,CAAC,cAAc,CAAC,IAAI,KAAK,CAAC,EAAE;gBAClC,OAAO,KAAK,CAAC;aACd;YACD,IAAM,WAAW,GAAG,IAAI,CAAC,UAAU,CAAC,QAAQ,CAAC,CAAC;YAC9C,OAAO,WAAW,GAAG,KAAK,GAAG,IAAI,CAAC;SACnC;;;;QAKO,8CAAgB,GAAxB,UAAyB,QAAa;YACpC,IAAM,cAAc,GAAG,IAAI,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAC;YACpD,IAAI,CAAC,cAAc,EAAE;gBACnB,OAAO;aACR;YACD,cAAc,CAAC,IAAI,GAAG,KAAK,CAAC;YAC5B,cAAc,CAAC,QAAQ,GAAG,IAAI,CAAC;SAChC;;;;QAKO,2CAAa,GAArB,UAAsB,QAAa;YAAnC,iBAeC;YAdC,IAAM,aAAa,GAAG,IAAI,CAAC,gBAAgB,CAAC,QAAQ,CAAC,CAAC;YACtD,IAAM,KAAK,GAAG,aAAa,CAAC,OAAO,CAAC,CAAC;YACrC,IAAM,IAAI,GAAG,aAAa,CAAC,MAAM,CAAC,CAAC;YAEnC,IAAM,QAAQ,GAAG,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,WAAW,CAAC,MAAM,EAAE,CAAC,CAAC;YACvD,IAAM,UAAU,GAAG,QAAQ,CAAC,IAAI,CAAC,UAAC,WAAqB;gBACrD,IAAM,YAAY,GAAG,KAAI,CAAC,QAAQ,CAAC,WAAW,CAAC,IAAI,EAAE,KAAI,CAAC,gBAAgB,CAAC,CAAC,OAAO,CAAC,CAAC;gBACrF,IAAM,WAAW,GAAG,KAAI,CAAC,QAAQ,CAAC,WAAW,CAAC,IAAI,EAAE,KAAI,CAAC,gBAAgB,CAAC,CAAC,MAAM,CAAC,CAAC;gBACnF,IAAI,CAAC,KAAK,KAAK,YAAY,GAAG,CAAC,KAAK,IAAI,CAAC,UAAU,CAAC,WAAW,CAAC,KAAK,IAAI,EAAE;oBACzE,OAAO,IAAI,CAAC;iBACb;gBACD,OAAO,KAAK,CAAC;aACd,CAAC,CAAC;YACH,OAAO,UAAU,CAAC;SACnB;;;;QAKO,wCAAU,GAAlB,UAAmB,QAAa;YAC9B,IAAM,EAAE,GAAG,QAAQ,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;YACrC,OAAO,IAAI,CAAC,cAAc,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC;SACpC;;;;QAKO,+CAAiB,GAAzB,UAA0B,SAAqB;YAA/C,iBAOC;YANC,SAAS,CAAC,OAAO,CAAC,UAAC,QAAkB;gBACnC,KAAI,CAAC,cAAc,CAAC,GAAG,CAAC,QAAQ,CAAC,IAAI,CAAC,KAAI,CAAC,UAAU,CAAC,EAAE,QAAQ,CAAC,CAAC;gBAClE,IAAI,QAAQ,CAAC,QAAQ,EAAE;oBACrB,KAAI,CAAC,iBAAiB,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC;iBAC3C;aACF,CAAC,CAAC;SACJ;QAGH,0BAAC;IAAD,CAAC,IAAA;;IC/eD;;;;;;IAUA;IACA;;;;;IAKA;;;;QAKE,+BAAY,YAAmB,EAAE,YAAwB,EAAE,UAAkB,EAAE,gBAAwB,EAAE,OAAa;;;;;;;;YAwC9G,oBAAe,GAAU,EAAE,CAAC;YAvClC,IAAI,CAAC,UAAU,GAAG,UAAU,CAAC;YAC7B,IAAI,CAAC,gBAAgB,GAAG,gBAAgB,CAAC;YACzC,IAAI,CAAC,QAAQ,GAAG,EAAE,CAAC;YACnB,IAAI,CAAC,YAAY,GAAG,YAAY,CAAC;YACjC,IAAI,CAAC,OAAO,GAAG,OAAO,IAAI,EAAE,CAAC;YAC7B,IAAI,CAAC,eAAe,GAAG,EAAE,CAAC;YAC1B,IAAI,CAAC,iBAAiB,GAAG,OAAO,IAAI,OAAO,CAAC,iBAAiB,IAAI,EAAE,CAAC;YACpE,IAAI,CAAC,YAAY,GAAG,OAAO,IAAI,OAAO,CAAC,YAAY,IAAI,IAAI,CAAC;YAC5D,IAAI,CAAC,2BAA2B,CAAC,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;YAErE,IAAI,CAAC,WAAW,GAAG,IAAI,GAAG,EAAoB,CAAC;YAC/C,IAAI,CAAC,cAAc,GAAG,IAAI,GAAG,EAAoB,CAAC;YAClD,IAAI,CAAC,iBAAiB,CAAC,YAAY,CAAC,CAAC;SACtC;QAKD,sBAAY,8CAAW;;;;;iBAAvB;gBACE,OAAO,IAAI,CAAC,OAAO,IAAI,IAAI,CAAC,OAAO,CAAC,cAAc,CAAC,aAAa,CAAC,GAAG,IAAI,CAAC,OAAO,CAAC,aAAa,CAAC,GAAG,CAAC,CAAC,CAAC;aACtG;;;WAAA;QACD,sBAAY,4CAAS;iBAArB;gBACE,OAAO,IAAI,CAAC,OAAO,IAAI,IAAI,CAAC,OAAO,CAAC,WAAW,CAAC,CAAC;aAClD;;;WAAA;QACD,sBAAY,8DAA2B;iBAAvC;gBACE,OAAO,IAAI,CAAC,OAAO,IAAI,IAAI,CAAC,OAAO,CAAC,6BAA6B,CAAC,IAAI,UAAU,IAAS,KAAK,CAAC;aAChG;;;WAAA;QAkDM,8CAAc,GAArB,UAAsB,YAAiB,EAAE,IAAS;YAChD,IAAI,CAAC,YAAY,GAAG,YAAY,CAAC;YACjC,IAAI,CAAC,iBAAiB,CAAC,IAAI,CAAC,CAAC;SAC9B;QACM,qCAAK,GAAZ;YAAA,iBAiDC;YAhDC,IAAI,IAAI,GAAe,EAAE,CAAC;YAC1B,IAAM,UAAU,GAAG,EAAE,CAAC;YACtB,IAAM,OAAO,GAAG,EAAE,CAAC;YACnB,IAAM,KAAK,GAAG,EAAE,CAAC;YACjB,IAAI,CAAC,YAAY,CAAC,OAAO,CAAC,UAAA,IAAI;gBAC5B,IAAM,EAAE,GAAG,IAAI,CAAC,EAAE,CAAC;gBACnB,IAAM,QAAQ,GAAG,KAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,CAAC,aAAa,CAAC;;;gBAI3D,IAAM,SAAS,GAAG,KAAI,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC;gBACvC,IAAI,SAAS,KAAK,IAAI,EAAE;oBACtB,KAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,CAAC;iBAC7B;;gBAED,IAAM,IAAI,GAAG,KAAI,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC;gBAClC,KAAK,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC;gBACjB,UAAU,CAAC,EAAE,CAAC,GAAG,UAAU,CAAC,EAAE,CAAC,IAAI,EAAE,CAAC;gBACtC,IAAI,CAAC,QAAQ,GAAG,UAAU,CAAC,EAAE,CAAC,CAAC;gBAE/B,OAAO,CAAC,QAAQ,CAAC,GAAG,OAAO,CAAC,QAAQ,CAAC,IAAI,EAAE,CAAC;gBAC5C,OAAO,CAAC,QAAQ,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;gBAC7B,KAAI,CAAC,WAAW,CAAC,GAAG,CAAC,IAAI,CAAC,KAAI,CAAC,UAAU,CAAC,EAAE,IAAI,CAAC,CAAC;gBAClD,IAAI,QAAQ,EAAE;oBACZ,IAAI,KAAK,CAAC,QAAQ,CAAC,IAAI,KAAK,CAAC,QAAQ,CAAC,CAAC,aAAa,KAAK,IAAI,EAAE;wBAC7D,KAAK,CAAC,QAAQ,CAAC,CAAC,QAAQ,GAAG,IAAI,CAAC;wBAChC,KAAK,CAAC,QAAQ,CAAC,CAAC,aAAa,GAAG,KAAK,CAAC;qBACvC;oBACD,UAAU,CAAC,QAAQ,CAAC,GAAG,UAAU,CAAC,QAAQ,CAAC,IAAI,EAAE,CAAC;oBAClD,UAAU,CAAC,QAAQ,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;iBACjC;qBAAM;oBACL,IAAI,CAAC,CAAC,IAAI,CAAC,QAAQ,IAAI,IAAI,CAAC,QAAQ,CAAC,MAAM,GAAG,CAAC,KAAK,IAAI,CAAC,QAAQ,KAAK,IAAI,EAAE;wBAC1E,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC;wBAC1B,IAAI,CAAC,QAAQ,GAAG,KAAK,CAAC;qBACvB;oBACD,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;iBACjB;aACF,CAAC,CAAC;;YAEH,IAAI,CAAC,CAAC,IAAI,IAAI,IAAI,CAAC,MAAM,GAAG,CAAC,KAAK,IAAI,CAAC,YAAY,IAAI,IAAI,CAAC,YAAY,CAAC,MAAM,GAAG,CAAC,EAAE;gBACnF,IAAM,SAAS,GAAG,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;gBACvC,SAAS,CAAC,OAAO,CAAC,UAAA,QAAQ;oBACxB,IAAI,CAAC,KAAI,CAAC,YAAY,CAAC,IAAI,CAAC,UAAA,IAAI,IAAI,OAAA,IAAI,CAAC,EAAE,KAAK,QAAQ,GAAA,CAAC,EAAE;wBACzD,IAAI,GAAG,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC,CAAC;qBACvC;iBACF,CAAC,CAAC;aACJ;YACD,OAAO,IAAI,CAAC;SACb;;;;QAIM,sCAAM,GAAb;YAAA,iBAmBC;YAlBC,IAAI,QAAQ,CAAC;;YAEb,IAAI,CAAC,YAAY,CAAC,OAAO,CAAC,UAAA,IAAI;gBAC5B,IAAM,aAAa,GAAG,KAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,CAAC;gBAClD,IAAI,aAAa,EAAE;oBACjB,IAAM,KAAK,GAAG,aAAa,CAAC,OAAO,CAAC,CAAC;oBACrC,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,EAAE;wBACjB,IAAI,QAAQ,KAAK,SAAS,EAAE;4BAC1B,QAAQ,GAAG,KAAK,CAAC;yBAClB;6BAAM,IAAI,KAAK,GAAG,QAAQ,EAAE;4BAC3B,QAAQ,GAAG,KAAK,CAAC;yBAClB;qBACF;iBACF;aACF,CAAC,CAAC;YACH,IAAM,QAAQ,GAAG,QAAQ,GAAG,CAAC,CAAC;YAC9B,IAAI,CAAC,UAAU,CAAC,EAAE,EAAE,QAAQ,EAAE,IAAI,CAAC,YAAY,EAAE,IAAI,CAAC,QAAQ,CAAC,CAAC;YAChE,OAAO,IAAI,CAAC,QAAQ,CAAC;SACtB;;;;QAKO,0CAAU,GAAlB,UAAmB,cAAsB,EAAE,MAAc,EAAE,YAAmB,EAAE,SAAqB;YAArG,iBAqBC;YApBC,IAAM,cAAc,GAAG,IAAI,CAAC,iBAAiB,CAAC,cAAc,EAAE,MAAM,CAAC,CAAC;YACtE,cAAc,CAAC,OAAO,CAAC,UAAC,QAAa;;gBAGnC,IAAM,SAAS,GAAG,KAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,CAAC;gBAC3C,IAAI,SAAS,KAAK,IAAI,EAAE;oBACtB,KAAI,CAAC,gBAAgB,CAAC,QAAQ,CAAC,CAAC;iBACjC;;gBAGD,IAAM,IAAI,GAAG,KAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,CAAC;gBACtC,SAAS,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;gBACrB,KAAI,CAAC,WAAW,CAAC,GAAG,CAAC,QAAQ,CAAC,KAAI,CAAC,UAAU,CAAC,EAAE,IAAI,CAAC,CAAC;;gBAGtD,IAAM,aAAa,GAAG,KAAI,CAAC,gBAAgB,CAAC,QAAQ,CAAC,CAAC;gBACtD,IAAM,YAAY,GAAG,aAAa,CAAC,OAAO,CAAC,CAAC;gBAC5C,IAAM,SAAS,GAAG,QAAQ,CAAC,KAAI,CAAC,UAAU,CAAC,CAAC;gBAC5C,KAAI,CAAC,UAAU,CAAC,SAAS,EAAE,YAAY,EAAE,YAAY,EAAE,IAAI,CAAC,QAAsB,CAAC,CAAC;aACrF,CAAC,CAAC;SACJ;;;;QAKO,yCAAS,GAAjB,UAAkB,QAAa;YAC7B,IAAM,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC;;YAErC,IAAM,YAAY,GAAG,IAAI,CAAC,YAAY,CAAC,QAAQ,CAAC,CAAC;;YAEjD,IAAM,kBAAkB,GAAG,IAAI,CAAC,UAAU,CAAC,QAAQ,CAAC,CAAC;;YAErD,IAAI,CAAC,kBAAkB,IAAI,YAAY,EAAE;gBACvC,IAAI,CAAC,UAAU,CAAC,QAAQ,CAAC,CAAC;aAC3B;YACD,IAAM,cAAc,GAAG,IAAI,CAAC,mBAAmB,CAAC,QAAQ,CAAC,CAAC;YAC1D,IAAM,QAAQ,GAAa;gBACzB,IAAI,EAAE,MAAM,CAAC,MAAM,CAAC,EAAE,EAAE,QAAQ,CAAC;gBACjC,QAAQ,EAAE,EAAE;gBACZ,QAAQ,EAAE,YAAY;gBACtB,IAAI,EAAE,MAAM;aACb,CAAC;YACF,IAAI,cAAc,EAAE;gBAClB,QAAQ,CAAC,UAAU,GAAG,cAAc,CAAC;aACtC;YACD,OAAO,QAAQ,CAAC;SACjB;;;;;;QAMO,mDAAmB,GAA3B,UAA4B,QAAa;YACvC,IAAI,MAAM,GAAG,IAAI,CAAC;YAClB,IAAI,IAAI,CAAC,YAAY,EAAE;gBACrB,IAAM,EAAE,GAAG,IAAI,CAAC,UAAU,CAAC,QAAQ,CAAC,CAAC;;gBAErC,IAAM,GAAG,GAAG,WAAS,EAAE,sBAAmB,CAAC;gBAC3C,IAAM,UAAU,GAAG,IAAI,CAAC,YAAY,CAAC,MAAM,CAAC,GAAG,CAAC,GAAG,CAAC,IAAI,IAAI,CAAC;gBAC7D,IAAI,UAAU,IAAI,UAAU,CAAC,SAAS,GAAG,CAAC,EAAE;oBAC1C,MAAM,GAAG;wBACP,SAAS,EAAE,UAAU,CAAC,SAAS;wBAC/B,QAAQ,EAAE,UAAU,CAAC,QAAQ;wBAC7B,KAAK,EAAE,UAAU,CAAC,UAAU;qBAC7B,CAAC;iBACH;aACF;YACD,OAAO,MAAM,CAAC;SACf;;;;;QAKO,4CAAY,GAApB,UAAqB,QAAa;YAC1B,IAAA,oEAAsE,EAArE,cAAM,EAAE,aAA6D,CAAC;;YAE7E,IAAI,MAAM,EAAE;gBACV,OAAO,KAAK,CAAC;aACd;YACD,IAAI,QAAQ,GAAG,IAAI,CAAC,UAAU,CAAC,QAAQ,CAAC,CAAC;YACzC,IAAI,CAAC,QAAQ,EAAE;gBACb,IAAM,IAAE,GAAG,IAAI,CAAC,UAAU,CAAC,QAAQ,CAAC,CAAC;gBACrC,IAAI,IAAI,CAAC,eAAe,CAAC,SAAS,CAAC,UAAA,IAAI,IAAI,OAAA,IAAI,IAAI,IAAI,CAAC,EAAE,KAAK,IAAE,GAAA,CAAC,GAAG,CAAC,CAAC,EAAE;oBACvE,OAAO,KAAK,CAAC;iBACd;gBACD,IAAI,IAAI,CAAC,iBAAiB,CAAC,SAAS,CAAC,UAAA,MAAM,IAAI,OAAA,MAAM,KAAK,IAAE,GAAA,CAAC,GAAG,CAAC,CAAC,EAAE;oBAClE,OAAO,IAAI,CAAC;iBACb;gBACD,IAAI,IAAI,CAAC,WAAW,KAAK,CAAC,CAAC,EAAE;;oBAE3B,QAAQ,GAAG,KAAK,CAAC;iBAClB;qBAAM,IAAI,IAAI,CAAC,WAAW,KAAK,CAAC,EAAE;;oBAEjC,QAAQ,GAAG,IAAI,CAAC;iBACjB;qBAAM;;oBAEL,QAAQ,GAAG,KAAK,IAAI,IAAI,CAAC,WAAW,CAAC;;oBAErC,IAAM,WAAW,GAAG,IAAI,CAAC,UAAU,CAAC,QAAQ,CAAC,CAAC;oBAC9C,IAAI,WAAW,IAAI,CAAC,WAAW,CAAC,QAAQ,EAAE;wBACxC,QAAQ,GAAG,KAAK,CAAC;qBAClB;iBACF;aACF;YACD,OAAO,QAAQ,CAAC;SACjB;;;;;;QAMO,0CAAU,GAAlB,UAAmB,QAAa;YACxB,IAAA,wEAA2E,EAA1E,eAAO,EAAE,aAAiE,CAAC;YAClF,IAAM,MAAM,GAAG,IAAI,CAAC,iBAAiB,CAAC,OAAO,EAAE,KAAK,CAAC,CAAC;;YAGtD,IAAI,CAAC,MAAM,IAAI,MAAM,CAAC,MAAM,GAAG,CAAC,EAAE;;gBAEhC,IAAM,IAAE,GAAG,IAAI,CAAC,UAAU,CAAC,QAAQ,CAAC,CAAC;gBACrC,IAAI,IAAI,CAAC,eAAe,CAAC,SAAS,CAAC,UAAA,IAAI,IAAI,OAAA,IAAI,IAAI,IAAI,CAAC,EAAE,KAAK,IAAE,GAAA,CAAC,GAAG,CAAC,EAAE;oBACtE,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,EAAE,EAAE,MAAA,EAAE,QAAQ,EAAE,KAAK,EAAE,CAAC,CAAC;iBACpD;aACF;SACF;;;;QAIO,kDAAkB,GAA1B;YACE,IAAM,KAAK,GAAG,IAAI,CAAC,eAAe,CAAC,SAAS,CAAC,UAAA,IAAI,IAAI,OAAA,CAAC,IAAI,CAAC,QAAQ,GAAA,CAAC,CAAC;YACrE,IAAM,QAAQ,GAAG,IAAI,CAAC,eAAe,CAAC,KAAK,CAAC,IAAI,EAAE,CAAC;YAC3C,IAAA,gBAAE,CAAc;YACxB,IAAI,EAAE,EAAE;gBACN,IAAM,OAAO,GAAG,IAAI,CAAC,SAAS,CAAC,WAAW,CAAC,EAAE,CAAC,CAAC;gBAC/C,IAAI,OAAO,EAAE;oBACX,QAAQ,CAAC,QAAQ,GAAG,IAAI,CAAC;;;;oBAIzB,IAAI,CAAC,SAAS,CAAC,UAAU,CAAC,EAAE,CAAC,CAAC;iBAC/B;aACF;SACF;;;;;QAKO,0CAAU,GAAlB,UAAmB,QAAa;YAC9B,OAAO,QAAQ,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;SAClC;;;;;QAMO,iDAAiB,GAAzB,UAA0B,cAAsB,EAAE,MAAc;YAAhE,iBAkBC;YAjBC,IAAM,cAAc,GAAG,EAAE,CAAC;YAC1B,IAAI,CAAC,YAAY,CAAC,OAAO,CAAC,UAAC,QAAa;;gBAGtC,IAAM,aAAa,GAAG,KAAI,CAAC,gBAAgB,CAAC,QAAQ,CAAC,CAAC;gBACtD,IAAI,CAAC,aAAa,EAAE;oBAClB,OAAO;iBACR;;gBAGD,IAAM,YAAY,GAAG,aAAa,CAAC,OAAO,CAAC,CAAC;gBAC5C,IAAM,oBAAoB,GAAG,aAAa,CAAC,eAAe,CAAC,CAAC;gBAC5D,IAAI,CAAC,YAAY,KAAK,MAAM,GAAG,CAAC,MAAM,oBAAoB,KAAK,cAAc,KAAK,CAAC,oBAAoB,IAAI,cAAc,KAAK,EAAE,CAAC,CAAC,EAAE;oBAClI,cAAc,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;iBAC/B;aACF,CAAC,CAAC;YACH,OAAO,cAAc,CAAC;SACvB;QACO,gDAAgB,GAAxB,UAAyB,QAAa;YACpC,OAAO,IAAI,CAAC,QAAQ,CAAC,QAAQ,EAAE,IAAI,CAAC,gBAAgB,CAAC,CAAC;SACvD;QACO,wCAAQ,GAAhB,UAAiB,MAAW,EAAE,IAAY;YACxC,IAAI,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC,EAAE;gBAC5B,OAAO,MAAM,CAAC,IAAI,CAAC,CAAC;aACrB;YACD,IAAM,KAAK,GAAQ,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,GAAA,CAAC,CAAC;YAClD,OAAO,KAAK,CAAC,MAAM,CAAC,UAAC,MAAM,EAAE,IAAI;gBAC/B,OAAO,MAAM,IAAI,MAAM,CAAC,IAAI,CAAC,CAAC;aAC/B,EAAE,MAAM,CAAC,CAAC;SACZ;;;;;QAKO,4CAAY,GAApB,UAAqB,QAAa;YAChC,IAAM,aAAa,GAAG,IAAI,CAAC,gBAAgB,CAAC,QAAQ,CAAC,CAAC;YACtD,OAAO,aAAa,CAAC,OAAO,CAAC,CAAC;SAC/B;;;;;QAKO,oDAAoB,GAA5B,UAA6B,QAAa;YACxC,IAAM,aAAa,GAAG,IAAI,CAAC,gBAAgB,CAAC,QAAQ,CAAC,CAAC;YACtD,OAAO,aAAa,CAAC,eAAe,CAAC,CAAC;SACvC;;;;QAIO,0CAAU,GAAlB,UAAmB,OAAY;YAC7B,IAAM,WAAW,GAAG,IAAI,CAAC,UAAU,CAAC,OAAO,CAAC,CAAC;YAC7C,OAAO,WAAW,GAAG,WAAW,CAAC,QAAQ,GAAG,SAAS,CAAC;SACvD;;;;;QAMO,sCAAM,GAAd,UAAe,QAAa;YAC1B,IAAM,aAAa,GAAG,IAAI,CAAC,gBAAgB,CAAC,QAAQ,CAAC,CAAC;YACtD,IAAM,QAAQ,GAAG,aAAa,CAAC,UAAU,CAAC,CAAC;YAC3C,OAAO,QAAQ,CAAC;SACjB;;;;;;;;QASO,yCAAS,GAAjB,UAAkB,QAAa;YAC7B,IAAI,IAAI,CAAC,cAAc,CAAC,IAAI,KAAK,CAAC,EAAE;gBAClC,OAAO,KAAK,CAAC;aACd;YACD,IAAM,WAAW,GAAG,IAAI,CAAC,UAAU,CAAC,QAAQ,CAAC,CAAC;YAC9C,OAAO,WAAW,GAAG,KAAK,GAAG,IAAI,CAAC;SACnC;;;;QAKO,gDAAgB,GAAxB,UAAyB,QAAa;YACpC,IAAM,cAAc,GAAG,IAAI,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAC;YACpD,IAAI,CAAC,cAAc,EAAE;gBACnB,OAAO;aACR;YACD,cAAc,CAAC,IAAI,GAAG,KAAK,CAAC;YAC5B,cAAc,CAAC,QAAQ,GAAG,IAAI,CAAC;SAChC;;;;QAKO,6CAAa,GAArB,UAAsB,QAAa;YAAnC,iBAaC;YAZC,IAAM,aAAa,GAAG,IAAI,CAAC,gBAAgB,CAAC,QAAQ,CAAC,CAAC;YACtD,IAAM,KAAK,GAAG,aAAa,CAAC,OAAO,CAAC,CAAC;YACrC,IAAM,aAAa,GAAG,aAAa,CAAC,eAAe,CAAC,CAAC;YAErD,IAAM,QAAQ,GAAG,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,WAAW,CAAC,MAAM,EAAE,CAAC,CAAC;YACvD,IAAM,UAAU,GAAG,QAAQ,CAAC,IAAI,CAAC,UAAC,IAAc;gBAC9C,IAAM,YAAY,GAAG,KAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,EAAE,KAAI,CAAC,gBAAgB,CAAC,CAAC,OAAO,CAAC,CAAC;gBAC9E,IAAM,SAAS,GAAG,IAAI,CAAC,IAAI,CAAC,KAAI,CAAC,UAAU,CAAC,CAAC;gBAC7C,OAAO,SAAS,KAAK,aAAa,IAAI,KAAK,MAAM,YAAY,GAAG,CAAC,CAAC,CAAC;aACpE,CAAC,CAAC;YAEH,OAAO,UAAU,CAAC;SACnB;;;;QAKO,0CAAU,GAAlB,UAAmB,QAAa;YAC9B,IAAM,EAAE,GAAG,QAAQ,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;YACrC,OAAO,IAAI,CAAC,cAAc,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC;SACpC;;;;QAKO,iDAAiB,GAAzB,UAA0B,SAAqB;YAA/C,iBAOC;YANC,SAAS,CAAC,OAAO,CAAC,UAAC,QAAkB;gBACnC,KAAI,CAAC,cAAc,CAAC,GAAG,CAAC,QAAQ,CAAC,IAAI,CAAC,KAAI,CAAC,UAAU,CAAC,EAAE,QAAQ,CAAC,CAAC;gBAClE,IAAI,QAAQ,CAAC,QAAQ,EAAE;oBACrB,KAAI,CAAC,iBAAiB,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC;iBAC3C;aACF,CAAC,CAAC;SACJ;QAGH,4BAAC;IAAD,CAAC,IAAA;;ICjdD;;;;;;AAMA,IAIA;QAAA;SAWC;QAVU,iCAAU,GAAjB,UAAkB,aAA0C;YACxD,IAAI,OAAO,GAAsD,mBAAmB,CAAC;YACrF,IAAI,aAAa,CAAC,cAAc,CAAC,MAAM,CAAC,EAAE;gBACtC,OAAO,GAAG,mBAAmB,CAAC;aACjC;iBAAM,IAAI,aAAa,CAAC,cAAc,CAAC,eAAe,CAAC,EAAE;gBACtD,OAAO,GAAG,qBAAqB,CAAC;aACnC;YAED,OAAO,OAAO,CAAC;SAClB;QACL,6BAAC;IAAD,CAAC,IAAA;;ICrBD;;;;;;AAMA,IAUA;;;AAGA;;;;QA6EE,yCACU,SAA6B,EAC7B,kBAAgD,EAChD,YAA0B;YAHpC,iBAcC;YAbS,cAAS,GAAT,SAAS,CAAoB;YAC7B,uBAAkB,GAAlB,kBAAkB,CAA8B;YAChD,iBAAY,GAAZ,YAAY,CAAc;YAxE5B,kBAAa,GAAiB,IAAIC,YAAO,EAAO,CAAC;;;;;;;;;YA0BlD,iBAAY,GAAW,GAAG,CAAC;;YAoBlC,aAAQ,GAAsB,IAAIf,iBAAY,EAAO,CAAC;;YAItD,cAAS,GAAsB,IAAIA,iBAAY,EAAO,CAAC;YAE/C,UAAK,GAAQ,IAAI,CAAC;YAsBxB,IAAI,CAAC,SAAS,GAAG,EAAE,CAAC;YACpB,IAAI,CAAC,OAAO,GAAG,EAAE,CAAC;YAClB,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,gBAAgB,CAAC,KAAK,EAAE,IAAI,CAAC,SAAS,CAAC,WAAW,CAAC,CAAC;YAC3E,IAAI,CAAC,aAAa,CAAC,IAAI,CACrBgB,sBAAY,CAAC,GAAG,CAAC,CAClB,CAAC,SAAS,CAAC;gBACV,KAAI,CAAC,QAAQ,EAAE,CAAC;aACjB,CAAC,CAAC;SAEJ;QArDD,sBAAY,wDAAW;;;;iBAAvB;gBACE,OAAO,IAAI,CAAC,YAAY,CAAC,WAAW,CAAC;aACtC;;;WAAA;QAKD,sBAAY,wDAAW;;;;iBAAvB;;gBAGE,OAAO,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC;aAC9B;;;WAAA;QAaD,sBAAY,iDAAI;iBAAhB;gBACE,OAAO,IAAI,CAAC,KAAK,CAAC;aACnB;iBACD,UAAiB,KAAK;gBACpB,IAAI,CAAC,KAAK,GAAG,KAAK,CAAC;aACpB;;;WAHA;QAOD,sBAAY,sDAAS;;;;iBAArB;gBACE,OAAO,IAAI,CAAC,YAAY,CAAC,SAAS,CAAC;aACpC;;;WAAA;;;;QAuBD,kDAAQ,GAAR;YAAA,iBAiCC;;YA/BC,IAAM,uBAAuB,GAAG,IAAI,CAAC,YAAY,CAAC,0BAA0B,EAAE,CAAC;YAC/E,uBAAuB,CAAC,QAAQ,CAAC,kBAAkB,EAAE,IAAI,CAAC,gBAAgB,CAAC,CAAC;YAC5E,IAAI,CAAC,QAAQ,EAAE,CAAC;YAChB,IAAI,CAAC,WAAW,CAAC,OAAO,CAAC,SAAS,CAAC,UAAC,MAAc;gBAChD,IAAI,MAAM,KAAK,MAAM,CAAC,IAAI,KAAKd,iBAAU,CAAC,YAAY,IAAI,MAAM,CAAC,IAAI,KAAKA,iBAAU,CAAC,oBAAoB,CAAC,EAAE;oBAC1G,KAAI,CAAC,aAAa,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;iBACjC;qBAAM;oBACL,KAAI,CAAC,QAAQ,EAAE,CAAC;iBACjB;;gBAED,IAAM,SAAS,GAAG,KAAI,CAAC,WAAW,CAAC,SAAS,CAAC;gBAC7C,IAAI,CAAC,KAAI,CAAC,YAAY,CAAC,WAAW,CAAC,uBAAuB,IAAI,SAAS,EAAE;oBACvE,KAAI,CAAC,mBAAmB,CAAC,KAAI,CAAC,WAAW,CAAC,SAAS,CAAC,CAAC;iBACtD;gBACD,KAAI,CAAC,iBAAiB,CAAC,MAAM,CAAC,CAAC;aAChC,CAAC,CAAC;;YAGH,IAAI,CAAC,kBAAkB,CAAC,SAAS,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;;YAGlD,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;;YAGnC,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;YACpC,IAAI,CAAC,eAAe,EAAE,CAAC;YACvB,IAAI,CAAC,qBAAqB,EAAE,CAAC;YAC7B,IAAI,CAAC,aAAa,EAAE,CAAC;YACrB,IAAI,IAAI,CAAC,YAAY,IAAI,IAAI,CAAC,YAAY,CAAC,cAAc,EAAE;gBACzD,IAAI,CAAC,YAAY,CAAC,cAAc,CAAC,aAAa,GAAGD,oBAAa,CAAC,wBAAwB,CAAC;aACzF;SACF;;;;QAKD,qDAAW,GAAX,UAAY,OAAsB;SACjC;QACO,uDAAa,GAArB;YAAA,iBAWC;YAVC,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC,SAAS,CAAC,UAAC,KAA8C;gBAC3E,IAAA,mBAAe,EAAf,oCAAe,EAAE,oBAAgB,EAAhB,qCAAgB,CAAW;gBACpD,IAAM,UAAU,GAAG,KAAI,CAAC,SAAS,CAAC,UAAU,CAAC;gBAC7C,IAAI,UAAU,KAAK,KAAK,EAAE;oBACxB,IAAI,QAAQ,IAAI,SAAS,EAAE;wBACzB,KAAI,CAAC,WAAW,CAAC,MAAM,CAAC,QAAQ,EAAE,SAAS,CAAC,CAAC;qBAC9C;iBACF;gBACD,KAAI,CAAC,QAAQ,EAAE,CAAC;aACjB,CAAC,CAAC;SACJ;;;;QAIO,yDAAe,GAAvB;YACE,IAAM,UAAU,GAAG,IAAI,CAAC,SAAS,IAAI,IAAI,CAAC,SAAS,CAAC,YAAY,IAAI,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC,iBAAiB,EAAE,CAAC;YACpH,IAAM,OAAO,GAAG,IAAI,CAAC,SAAS,IAAI,IAAI,CAAC,SAAS,CAAC,YAAY,IAAI,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC,OAAO,CAAC;YACrG,IAAM,EAAE,GAAG,IAAI,CAAC,SAAS,IAAI,IAAI,CAAC,SAAS,CAAC,EAAE,CAAC,aAAa,CAAC,EAAE,IAAI,IAAI,CAAC;;YAExE,IAAI,CAAC,OAAO,IAAI,CAAC,EAAE,EAAE;gBACnB,OAAO;aACR;YACD,IAAM,GAAG,GAAG,UAAU,IAAI,UAAU,CAAC,aAAa,IAAI,UAAU,CAAC,aAAa,CAAC,GAAG,CAAC,OAAO,CAAC,IAAI,IAAI,GAAG,EAAe,CAAC;YACtH,UAAU,IAAI,UAAU,CAAC,aAAa,IAAI,UAAU,CAAC,aAAa,CAAC,GAAG,CAAC,OAAO,EAAE,GAAG,CAAC,GAAG,CAAC,EAAE,EAAE,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC;SAC9G;QAEO,+DAAqB,GAA7B;YACE,IAAI,IAAI,CAAC,YAAY,EAAE;gBACrB,IAAM,oBAAoB,GAAG,IAAI,CAAC,SAAS,CAAC,qBAAqB,IAAI,KAAK,CAAC;gBAC3E,IAAI,CAAC,YAAY,CAAC,MAAM,CAAC,GAAG,CAAC,sBAAsB,EAAE,oBAAoB,CAAC,CAAC;gBAC3E,IAAM,YAAY,GAAG,IAAI,CAAC,YAAY,IAAI,CAAC,CAAC;gBAC5C,IAAI,CAAC,YAAY,CAAC,MAAM,CAAC,GAAG,CAAC,cAAc,EAAE,YAAY,CAAC,CAAC;aAC5D;SACF;;;;QAKO,kDAAQ,GAAhB;YACE,IAAM,YAAY,GAAG,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC;YACzC,IAAM,aAAa,GAAG,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC,EAAE,oBAAoB,EAAE,IAAI,EAAE,CAAC,CAAC;;;;YAI9E,IAAI,CAAC,IAAI,GAAG,aAAa,CAAC;YAE1B,IAAI,SAAS,GAAe,EAAE,CAAC;YAC/B,IAAI,CAAC,CAAC,aAAa,IAAI,aAAa,CAAC,MAAM,GAAG,CAAC,EAAE;gBAC/C,IAAM,aAAa,GAAG,aAAa,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,gBAAgB,CAAC,CAAC;gBAC9D,IAAI,OAAO,GAAc,IAAI,CAAC,OAAO,CAAC;gBACtC,IAAI,CAAC,OAAO,EAAE;oBACZ,IAAI,CAAC,OAAO,GAAG,sBAAsB,CAAC,UAAU,CAAC,aAAa,CAAC,CAAC;oBAChE,OAAO,GAAG,IAAI,CAAC,OAAO,CAAC;iBACxB;;gBAED,IAAI,OAAO,IAAI,IAAI,EAAE;oBACnB,MAAM,IAAI,KAAK,CAAC,4BAA4B,CAAC,CAAC;iBAC/C;gBACD,IAAI,WAAW,GAAG,CAAC,CAAC,CAAC;gBACrB,IAAM,eAAe,GAAG,IAAI,CAAC,SAAS,CAAC,aAAa,CAAC,CAAC;gBACtD,IAAI,OAAO,eAAe,KAAK,WAAW,EAAE;oBAC1C,WAAW,GAAG,eAAe,CAAC;iBAC/B;gBACD,IAAM,uBAAuB,GAAG,IAAI,CAAC,YAAY,CAAC,0BAA0B,EAAE,CAAC;gBAC/E,IAAM,iBAAiB,GAAG,CAAC,uBAAuB,CAAC,MAAM,CAAC,GAAG,CAAC,sBAAsB,CAAC,IAAI,EAAE,EAAE,KAAK,CAAC,GAAG,CAAC,IAAI,EAAE,CAAC;gBAC9G,IAAM,OAAO,GAAG;oBACd,WAAW,aAAA;oBACX,2BAA2B,EAAE,IAAI,CAAC,2BAA2B,CAAC,IAAI,CAAC,IAAI,CAAC;oBACxE,SAAS,EAAE,IAAI,CAAC,SAAS;oBACzB,OAAO,EAAE,IAAI,CAAC,OAAO;oBACrB,iBAAiB,EAAE,iBAAiB;oBACpC,YAAY,EAAE,IAAI,CAAC,YAAY;iBAChC,CAAC;;gBAEF,IAAI,CAAC,gBAAgB,GAAG,IAAI,OAAO,CACjC,aAAa,EAAE,YAAY,EAC3B,IAAI,CAAC,WAAW,CAAC,UAAU,EAAE,IAAI,CAAC,gBAAgB,EAAE,OAAO,CAC5D,CAAC;;;gBAGF,SAAS,GAAG,IAAI,CAAC,gBAAgB,CAAC,KAAK,EAAE,CAAC;aAC3C;YACD,IAAI,CAAC,SAAS,CAAC,IAAI,GAAG,SAAS,CAAC;;YAEhC,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;YACpC,IAAI,CAAC,kBAAkB,EAAE,CAAC;SAC3B;QACO,4DAAkB,GAA1B;YACE,IAAI,IAAI,CAAC,SAAS,IAAI,IAAI,CAAC,SAAS,CAAC,MAAM,GAAG,CAAC,EAAE;gBAC/C,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,UAAA,QAAQ;oBAC7B,QAAQ,EAAE,CAAC;iBACZ,CAAC,CAAC;aACJ;SACF;QACO,qEAA2B,GAAnC,UAAoC,QAAa;YAC/C,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;SAC/B;QACO,+DAAqB,GAA7B,UAA8B,OAAY;YACxC,IAAI,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,EAAE;gBACzD,OAAO,KAAK,CAAC;aACd;YACD,OAAO,IAAI,CAAC;SACb;;;;QAIO,+DAAqB,GAA7B;YACE,IAAM,WAAW,GAAG,IAAI,CAAC,SAAS,CAAC,WAAW,CAAC;YAC/C,OAAO,WAAW,GAAG,WAAW,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,IAAI,CAAC;SACpD;;;;QAKO,6DAAmB,GAA3B,UAA4B,UAAkB;YAC5C,IAAI,CAAC,UAAU,EAAE;gBACf,OAAO;aACR;;YAED,IAAM,aAAa,GAAG,IAAI,CAAC,qBAAqB,EAAE,CAAC;YACnD,IAAM,eAAe,GAAG,IAAI,CAAC,YAAY,CAAC,MAAM,CAAC,GAAG,CAAC,qBAAqB,CAAC,IAAI,KAAK,CAAC;YACrF,IAAI,CAAC,aAAa,IAAI,eAAe,EAAE;gBACrC,IAAI,CAAC,YAAY,CAAC,MAAM,CAAC,MAAM,CAAC,qBAAqB,CAAC,CAAC;gBACvD,OAAO;aACR;YACD,IAAI,aAAa,KAAK,UAAU,EAAE;gBAChC,IAAI,CAAC,SAAS,CAAC,eAAe,EAAE,CAAC;gBACjC,IAAI,CAAC,SAAS,CAAC,UAAU,CAAC,UAAU,CAAC,CAAC;aACvC;SACF;;;;QAKO,mEAAyB,GAAjC,UAAkC,UAAkB;YAClD,IAAM,YAAY,GAAG,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,SAAS,CAAC;;YAErD,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,WAAW,EAAE;gBAC/B,IAAI,CAAC,SAAS,CAAC,UAAU,CAAC,CAAC;gBAC3B,IAAI,CAAC,cAAc,CAAC,CAAC,UAAU,CAAC,CAAC,CAAC;aACnC;YACD,IAAI,YAAY,KAAK,UAAU,EAAE;gBAC/B,OAAO;aACR;YACD,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,YAAY,CAAC,UAAU,EAAE,IAAI,CAAC,CAAC;SACtD;QACO,2DAAiB,GAAzB,UAA0B,OAAe;YACvC,IAAI,OAAO,CAAC,IAAI,KAAKC,iBAAU,CAAC,IAAI,EAAE;gBACpC,IAAI,CAAC,cAAc,EAAE,CAAC;aACvB;iBAAM,IAAI,OAAO,CAAC,IAAI,KAAKA,iBAAU,CAAC,YAAY,IAAI,OAAO,CAAC,IAAI,KAAKA,iBAAU,CAAC,MAAM,EAAE;gBACzF,IAAM,GAAG,GAAG,IAAI,CAAC,SAAS,EAAE,CAAC;gBAC7B,IAAI,OAAO,CAAC,EAAE,IAAI,GAAG,CAAC,QAAQ,CAAC,OAAO,CAAC,EAAE,CAAC,EAAE;oBAC1C,IAAI,CAAC,cAAc,EAAE,CAAC;iBACvB;aACF;SACF;;;;QAIS,wDAAc,GAAxB,UAAyB,GAAc;YAAvC,iBAqBC;YApBC,IAAI,OAAO,GAAG,KAAK,WAAW,EAAE;gBAC9B,GAAG,GAAG,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,KAAK,CAAC,IAAI,EAAE,CAAC;aAC3C;YACD,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,GAAG,CAAC,EAAE;gBACvB,OAAO;aACR;YACD,IAAM,IAAI,GAAG,IAAI,CAAC,WAAW,CAAC,MAAM,EAAE,CAAC;YACvC,IAAM,IAAI,GAAqB,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,MAAM,CAAC,IAAI,IAAI,GAAG,EAAe,CAAC;YAExF,IAAM,MAAM,GAAG,IAAI,GAAG,EAAe,CAAC;YACtC,GAAG,CAAC,OAAO,CAAC,UAAC,EAAO;gBAClB,IAAM,IAAI,GAAG,IAAI,CAAC,IAAI,CAAC,UAAA,IAAI,IAAI,OAAA,IAAI,CAAC,KAAI,CAAC,WAAW,CAAC,UAAU,CAAC,KAAK,EAAE,GAAA,CAAC,CAAC;gBACzE,IAAM,aAAa,GAAG,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC;gBACnC,IAAI,IAAI,EAAE;oBACR,MAAM,CAAC,GAAG,CAAC,EAAE,EAAE,IAAI,CAAC,CAAC;iBACtB;qBAAM,IAAI,aAAa,EAAE;oBACxB,MAAM,CAAC,GAAG,CAAC,EAAE,EAAE,aAAa,CAAC,CAAC;iBAC/B;aACF,CAAC,CAAC;YACH,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,gBAAgB,CAAC,MAAM,EAAE,MAAM,CAAC,CAAC;SACzD;;;;;QAKS,mDAAS,GAAnB,UAAoB,OAA0B;YAC5C,IAAI,OAAO,OAAO,KAAK,QAAQ,EAAE;gBAC/B,OAAO,GAAG,OAAO,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,GAAA,CAAC,CAAC;aAC7C;YACD,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,gBAAgB,CAAC,KAAK,EAAE,OAAO,CAAC,CAAC;SACzD;;;;;QAKS,mDAAS,GAAnB;YACE,OAAO,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,KAAK,CAAC,IAAI,EAAE,CAAC;SAC5C;;;;QAIO,uDAAa,GAArB;YACE,IAAM,WAAW,GAAG,IAAI,CAAC,SAAS,CAAC,WAAW,CAAC;YAC/C,IAAM,WAAW,GAAG,IAAI,CAAC,SAAS,CAAC,WAAW,CAAC;YAC/C,IAAI,UAAU,GAAG,WAAW,CAAC,UAAU,CAAC;YACxC,IAAI,WAAW,KAAK,GAAG,EAAE;gBACvB,OAAO,UAAU,CAAC;aACnB;iBAAM;gBACL,IAAM,YAAY,GAAG,WAAW,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAA,IAAI,IAAI,OAAA,CAAC,CAAC,IAAI,IAAI,IAAI,CAAC,MAAM,GAAG,CAAC,GAAA,CAAC,CAAC,GAAG,CAAC,UAAA,IAAI;oBACtG,OAAO,IAAI,CAAC,SAAS,CAAC,CAAC,EAAE,IAAI,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;iBAC3C,CAAC,CAAC;gBACH,YAAY,CAAC,OAAO,CAAC,UAAA,IAAI;oBACvB,UAAU,GAAG,UAAU,IAAI,UAAU,CAAC,IAAI,CAAC,CAAC;iBAC7C,CAAC,CAAC;gBACH,OAAO,UAAU,CAAC;aACnB;SACF;QACO,wDAAc,GAAtB,UAAuB,SAA6B;YAC5C,IAAA,yBAAqD,EAAnD,wBAAS,EAAE,sBAAQ,EAAE,gBAA8B,CAAC;YAC5D,IAAI,QAAQ,KAAK,CAAC,EAAE;gBAClB,SAAS,CAAC,UAAU,GAAG,KAAK,CAAC;gBAC7B,OAAO;aACR;YACD,SAAS,CAAC,UAAU,GAAG,IAAI,CAAC;YAC5B,SAAS,CAAC,cAAc,CAAC,EAAE,SAAS,WAAA,EAAE,QAAQ,UAAA,EAAE,KAAK,OAAA,EAAE,CAAC,CAAC;SAC1D;;;;;QAMM,gEAAsB,GAD7B,UAC8B,KAAU;YACtC,IAAI,KAAK,IAAI,KAAK,CAAC,IAAI,IAAI,KAAK,CAAC,IAAI,CAAC,cAAc,CAAC,MAAM,CAAC,EAAE;gBAC5D,IAAM,OAAO,GAAG,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC;gBACvC,IAAM,EAAE,GAAG,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;gBACpC,IAAI,CAAC,yBAAyB,CAAC,EAAE,CAAC,CAAC;aACpC;SACF;;;;;QAMM,2DAAiB,GADxB,UACyB,KAAU;;YAEjC,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,SAAS,CAAC,WAAW,CAAC,CAAC;YAC3C,IAAI,CAAC,cAAc,EAAE,CAAC;SACvB;;;;QAKM,uDAAa,GADpB,UACqB,KAAU;YAC7B,IAAM,UAAU,GAAG,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YACpC,IAAM,uBAAuB,GAAG,IAAI,CAAC,YAAY,CAAC,0BAA0B,EAAE,CAAC;;;YAG/E,IAAM,WAAW,GAAG,uBAAuB,CAAC,QAAQ,CAAC,yBAAyB,CAAC,IAAI,EAAE,CAAC;YACtF,WAAW,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;YAC7B,uBAAuB,CAAC,QAAQ,CAAC,yBAAyB,EAAE,WAAW,CAAC,CAAC;SAC1E;QAEM,uDAAa,GADpB,UACqB,KAAU;YACzB,IAAA,gBAA8C,EAA5C,gBAAa,EAAb,kCAAa,EAAE,iBAAa,EAAb,kCAA6B,CAAC;YACnD,IAAI,SAAS,GAAG,CAAC,EAAE;gBACjB,SAAS,GAAG,CAAC,CAAC;aACf;YACD,IAAM,IAAI,GAAG,CAAC,SAAS,GAAG,CAAC,IAAI,QAAQ,CAAC;YACxC,IAAI,CAAC,WAAW,CAAC,aAAa,CAAC,IAAI,EAAE,QAAQ,EAAE,IAAI,CAAC,WAAW,CAAC,WAAW,CAAC,CAAC;SAC9E;QAEM,2DAAiB,GADxB,UACyB,KAAU;YACjC,IAAM,QAAQ,GAAG,KAAK,GAAG,KAAK,GAAG,EAAE,CAAC;YACpC,IAAM,IAAI,GAAG,CAAC,CAAC;YACf,IAAI,CAAC,WAAW,CAAC,aAAa,CAAC,IAAI,EAAE,QAAQ,EAAE,IAAI,CAAC,WAAW,CAAC,WAAW,CAAC,CAAC;SAC9E;;;;;QAMM,2DAAiB,GADxB,UACyB,KAAU;YACzB,IAAA,oBAAa,EAAb,kCAAa,EAAE,mBAA4B,EAA5B,iDAA4B,EAAE,eAAS,EAAT,8BAAS,CAAW;YACzE,IAAM,EAAE,GAAG,IAAI,IAAI,IAAI,CAAC,EAAE,IAAI,IAAI,CAAC;YACnC,IAAI,EAAE,EAAE;gBACN,IAAM,uBAAuB,GAAG,IAAI,CAAC,YAAY,CAAC,0BAA0B,EAAE,CAAC;gBAC/E,IAAM,WAAW,GAAG,uBAAuB,CAAC,QAAQ,CAAC,yBAAyB,CAAC,IAAI,EAAE,CAAC;gBACtF,WAAW,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;gBACrB,uBAAuB,CAAC,QAAQ,CAAC,yBAAyB,EAAE,WAAW,CAAC,CAAC;gBACzE,IAAI,CAAC,YAAY,CAAC,MAAM,CAAC,GAAG,CAAC,WAAS,EAAE,iBAAc,EAAE,SAAS,CAAC,CAAC;gBACnE,IAAI,CAAC,YAAY,CAAC,MAAM,CAAC,GAAG,CAAC,mBAAmB,EAAE,IAAI,CAAC,CAAC;gBACxD,IAAI,CAAC,YAAY,CAAC,MAAM,CAAC,GAAG,CAAC,qBAAqB,EAAE,IAAI,CAAC,CAAC;aAC3D;SACF;;oBA9aFZ,cAAS,SAAC;wBACT,QAAQ,EAAE,0BAA0B;qBACrC;;;;;wBAXQ2B,8BAAkB;wBAGlB,4BAA4B;wBAJFC,mBAAY;;;;uCAyB5CzB,UAAK,SAAC,wBAAwB;mCAI9BA,UAAK;oCAILA,UAAK;mCAULA,UAAK,SAAC,cAAc;+BAoBpBmB,WAAM;gCAINA,WAAM;6CAsTNlB,iBAAY,SAAC,cAAc,EAAE,CAAC,QAAQ,CAAC;wCAYvCA,iBAAY,SAAC,mBAAmB,EAAE,CAAC,QAAQ,CAAC;oCAS5CA,iBAAY,SAAC,QAAQ,EAAE,CAAC,QAAQ,CAAC;oCAUjCA,iBAAY,SAAC,aAAa,EAAE,CAAC,QAAQ,CAAC;wCAStCA,iBAAY,SAAC,iBAAiB,EAAE,CAAC,QAAQ,CAAC;wCAU1CA,iBAAY,SAAC,mBAAmB,EAAE,CAAC,QAAQ,CAAC;;QAe/C,sCAAC;KAhbD;;ICjBA;;;AAGA;QAAA;;;;YAMqB,mBAAc,GAAG,GAAG,CAAC;SAsKzC;;;;;;;;QA9JC,iCAAW,GAAX,UAAY,QAAa,EAAE,SAAc,EAAE,OAAwB,EAAE,OAAqB;YAA/C,wBAAA;gBAAA,eAAwB;;YAAE,wBAAA;gBAAA,aAAqB;;YACxF,IAAI,CAAC,SAAS,EAAE;gBACd,OAAO;aACR;;YAED,IAAM,UAAU,GAAG,IAAI,CAAC,EAAE,CAAC,YAAY,CAAC,UAAU,CAAC;YACnD,UAAU,CAAC,yBAAyB,CAAC,MAAM,EAAE,CAAC;YAC9C,IAAI,UAAU,GAAG,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;YACxC,IAAM,SAAS,GAAG,IAAI,CAAC,mBAAmB,EAAE,CAAC;YAC7C,IAAM,WAAW,GAAG,IAAI,CAAC,sBAAsB,CAAC,SAAS,EAAE,SAAS,CAAC,CAAC;;YAEtE,IAAM,WAAW,GAAa,WAAW,IAAI,WAAW,CAAC,GAAG,CAAC,UAAC,IAAI,IAAK,OAAA,IAAI,CAAC,UAAU,GAAA,CAAC,IAAI,EAAE,CAAC;;YAE9F,IAAM,aAAa,GAAa,WAAW,IAAI,WAAW,CAAC,GAAG,CAAC,UAAC,IAAI,IAAK,OAAA,IAAI,CAAC,YAAY,GAAA,CAAC,IAAI,EAAE,CAAC;;YAElG,UAAU,GAAG,IAAI,CAAC,gBAAgB,CAAC,UAAU,EAAE,WAAW,CAAC,CAAC;YAC5D,IAAI,CAAC,QAAQ,IAAI,OAAO,EAAE;gBACxB,UAAU,CAAC,OAAO,EAAE,CAAC;aACtB;YACD,IAAI,CAAC,OAAO,CAAC,UAAU,EAAE,SAAS,EAAE,QAAQ,EAAE,aAAa,EAAE,SAAS,EAAE,OAAO,EAAE,OAAO,CAAC,CAAC;;YAE1F,UAAU,CAAC,yBAAyB,CAAC,QAAQ,EAAE,CAAC;SACjD;QACO,6BAAO,GAAf,UAAgB,eAAyB,EAAE,SAAc,EAAE,QAAa,EAAE,mBAA6B,EAAE,SAAmB,EAAE,OAAwB,EAAE,OAAa;YAArK,iBAaC;YAb6H,wBAAA;gBAAA,eAAwB;;YAAE,wBAAA;gBAAA,aAAa;;YACnK,eAAe,CAAC,OAAO,CAAC,UAAC,KAAU;gBACjC,IAAM,GAAG,GAAG,KAAI,CAAC,YAAY,CAAC,KAAK,EAAE,QAAQ,EAAE,OAAO,CAAC,CAAC;gBACxD,IAAI,QAAQ,GAAU,SAAS,CAAC,KAAK,CAAC,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;gBAClD,IAAM,YAAY,GAAG,QAAQ,CAAC,MAAM,CAAC,UAAC,CAAC,IAAK,OAAA,mBAAmB,CAAC,QAAQ,CAAC,CAAC,CAAC,GAAA,CAAC,CAAC;gBAC7E,IAAM,YAAY,GAAG,QAAQ,CAAC,MAAM,CAAC,UAAC,CAAC,IAAK,OAAA,CAAC,mBAAmB,CAAC,QAAQ,CAAC,CAAC,CAAC,GAAA,CAAC,CAAC;gBAC9E,IAAI,CAAC,QAAQ,IAAI,OAAO,EAAE;oBACxB,QAAQ,GAAG,EAAE,CAAC,MAAM,CAAC,YAAY,CAAC,CAAC,MAAM,CAAC,YAAY,CAAC,CAAC;iBACzD;qBAAM;oBACL,QAAQ,GAAG,EAAE,CAAC,MAAM,CAAC,YAAY,CAAC,CAAC,MAAM,CAAC,YAAY,CAAC,CAAC;iBACzD;gBACD,KAAI,CAAC,YAAY,CAAC,QAAQ,EAAE,SAAS,EAAE,QAAQ,EAAE,GAAG,CAAC,CAAC;aACvD,CAAC,CAAC;SACJ;QACO,kCAAY,GAApB,UAAqB,QAAkB,EAAE,SAAmB,EAAE,QAAa,EAAE,KAAU;YAAvF,iBAIC;YAHC,QAAQ,CAAC,OAAO,CAAC,UAAC,eAAoB;gBACpC,KAAI,CAAC,iBAAiB,CAAC,SAAS,EAAE,eAAe,EAAE,KAAK,EAAE,QAAQ,CAAC,CAAC;aACrE,CAAC,CAAC;SACJ;QACO,uCAAiB,GAAzB,UAA0B,SAAmB,EAAE,eAAe,EAAE,KAAU,EAAE,QAAa;YACvF,IAAI,IAAI,CAAC,MAAM,EAAE;gBACf,IAAM,KAAK,GAAG,eAAe,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;gBACzC,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,MAAM,EAAE,KAAK,EAAE,KAAK,CAAC,CAAC;aAC1C;iBAAM;gBACL,IAAM,KAAK,GAAG,SAAS,CAAC,MAAM,CAAC,eAAe,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC;gBAC3D,IAAI,CAAC,QAAQ,EAAE;oBACb,IAAI,CAAC,EAAE,CAAC,WAAW,CAAC,UAAU,CAAC,KAAK,EAAE,IAAI,EAAE,IAAI,EAAE,EAAE,YAAY,EAAE,IAAI,CAAC,EAAE,CAAC,YAAY,EAAE,CAAC,CAAC;iBAC3F;qBAAM;oBACL,IAAI,CAAC,EAAE,CAAC,WAAW,CAAC,QAAQ,CAAC,KAAK,EAAE,KAAK,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,EAAE,YAAY,EAAE,IAAI,CAAC,EAAE,CAAC,YAAY,EAAE,CAAC,CAAC;iBACtG;aACF;SACF;;;;;;;;QAQO,kCAAY,GAApB,UAAqB,KAAa,EAAE,QAAa,EAAE,OAAa;YAAhE,iBAYC;YAZkD,wBAAA;gBAAA,aAAa;;YAC9D,IAAI,KAAK,GAAQ,EAAE,CAAC;YACpB,IAAI,QAAQ,EAAE;gBACZ,IAAI,QAAQ,YAAY,KAAK,EAAE;oBAC7B,KAAK,GAAG,QAAQ,CAAC,GAAG,CAAC,UAAC,IAAS;wBAC7B,OAAO,KAAI,CAAC,QAAQ,CAAC,KAAK,EAAE,IAAI,CAAC,CAAC;qBACnC,CAAC,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;iBAClB;qBAAM;oBACL,KAAK,GAAG,IAAI,CAAC,QAAQ,CAAC,KAAK,EAAE,QAAQ,CAAC,CAAC;iBACxC;aACF;YACD,OAAO,KAAK,CAAC;SACd;QACS,8BAAQ,GAAlB,UAAmB,CAAS,EAAE,IAAS;YACrC,IAAI,GAAG,GAAG,EAAE,CAAC;YACb,IAAI,CAAC,CAAC,OAAO,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC,EAAE;gBACzB,GAAG,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC;aACf;iBAAM;gBACL,GAAG,GAAG,CAAC,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAC,CAAC,EAAE,CAAC;oBAC7B,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC;iBACb,EAAE,IAAI,CAAC,CAAC;aACV;YAED,OAAO,GAAG,CAAC;SACZ;QACS,8BAAQ,GAAlB,UAAmB,MAAc,EAAE,KAAe,EAAE,KAAU;YAC5D,IAAI,MAAM,EAAE;gBACV,IAAI,KAAK,CAAC,MAAM,IAAI,CAAC,EAAE;oBACrB,MAAM,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,GAAG,KAAK,CAAC;iBAC1B;qBAAM;oBACL,KAAK,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC,UAAC,IAAI,EAAE,IAAI;wBACnC,IAAI,EAAE,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,IAAI,IAAI,CAAC,WAAW,CAAC,CAAC,cAAc,CAAC,IAAI,CAAC,CAAC,EAAE;4BAC1E,IAAI,CAAC,IAAI,CAAC,GAAG,EAAE,CAAC;yBACjB;wBACD,OAAO,IAAI,CAAC,IAAI,CAAC,CAAC;qBACnB,EAAE,MAAM,CAAC,CAAC,KAAK,CAAC,KAAK,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,GAAG,KAAK,CAAC;iBAC7C;aACF;SACF;QACO,yCAAmB,GAA3B;YACE,IAAM,IAAI,GAAG,IAAI,CAAC,EAAE,CAAC,WAAW,CAAC;YACjC,IAAI,IAAI,EAAE;gBACR,OAAO,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAC,CAAC,IAAK,OAAA,CAAC,KAAK,EAAE,GAAA,CAAC,CAAC;aAChD;YACD,OAAO,EAAE,CAAC;SACX;QAEO,mCAAa,GAArB,UAAsB,KAAK,EAAE,IAAI;YAC/B,IAAM,UAAU,GAAG,IAAI,CAAC,QAAQ,CAAC,KAAK,EAAE,IAAI,CAAC,CAAC;YAC9C,OAAOyB,iBAAQ,CAAC,UAAU,CAAC,CAAC;SAC7B;;;;;QAKO,4CAAsB,GAA9B,UAA+B,SAAc,EAAE,YAAsB;YACnE,IAAI,CAAC,SAAS,IAAI,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC,MAAM,GAAG,CAAC,EAAE;gBACnD,OAAO,IAAI,CAAC;aACb;YACD,IAAM,OAAO,GAAG,EAAE,CAAC;;YAEnB,IAAI;gBACF,IAAM,gBAAc,GAAiB,IAAI,CAAC,EAAE,CAAC,YAAY,CAAC,UAAU,CAAC,cAAc,CAAC;gBACpF,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC,OAAO,CAAC,UAAC,GAAW;oBACzC,IAAM,QAAQ,GAAG,SAAS,CAAC,GAAG,CAAC,CAAC;oBAChC,IAAI,QAAQ,IAAI,OAAO,QAAQ,KAAK,QAAQ,EAAE;wBAC5C,IAAM,QAAQ,GAAG,QAAQ,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAC,CAAC,IAAK,OAAA,CAAC,GAAA,CAAC,CAAC;wBACtD,QAAQ,CAAC,OAAO,CAAC,UAAC,IAAY;4BAC5B,IAAI,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;4BAC5B,IAAI,YAAY,IAAI,YAAY,CAAC,MAAM,GAAG,CAAC,EAAE;gCAC3C,KAAK,GAAG,YAAY,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;6BACpC;4BACD,IAAM,QAAQ,GAAiB,gBAAc,CAAC,iBAAiB,CAAC,KAAK,CAAC,CAAC;4BACvE,IAAI,QAAQ,IAAI,QAAQ,CAAC,YAAY,IAAI,QAAQ,CAAC,YAAY,CAAC,OAAO,KAAK,IAAI,EAAE;gCAC/E,OAAO,CAAC,IAAI,CAAC;oCACX,UAAU,EAAE,GAAG;oCACf,YAAY,EAAE,IAAI;iCACnB,CAAC,CAAC;6BACJ;yBACF,CAAC,CAAC;qBACJ;iBACF,CAAC,CAAC;aACJ;YAAC,OAAO,CAAC,EAAE;gBACV,OAAO,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;aAClB;YACD,OAAO,OAAO,CAAC;SAChB;QACO,sCAAgB,GAAxB,UAAyB,IAAc,EAAE,WAAqB;YAC5D,IAAI,CAAC,WAAW,IAAI,WAAW,CAAC,MAAM,GAAG,CAAC,IAAI,CAAC,IAAI,IAAI,IAAI,CAAC,MAAM,GAAG,CAAC,EAAE;gBACtE,OAAO,IAAI,CAAC;aACb;YACD,WAAW,YAAO,IAAI,GAAG,CAAC,WAAW,CAAC,CAAC,CAAC;;YAExC,IAAI,GAAG,IAAI,CAAC,MAAM,CAAC,UAAC,CAAC,IAAK,OAAA,CAAC,WAAW,CAAC,QAAQ,CAAC,CAAC,CAAC,GAAA,CAAC,CAAC;YACpD,OAAO,EAAE,CAAC,MAAM,CAAC,WAAW,CAAC,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;SAC5C;QACH,kBAAC;IAAD,CAAC;;ICjLD;;;;;;;;;QAyBgD9B,8CAAW;QAIzD,oCAA+B,EAAa,EAA8B,MAA2B;YAArG,YACE,iBAAO,SACR;YAF8B,QAAE,GAAF,EAAE,CAAW;YAA8B,YAAM,GAAN,MAAM,CAAqB;YAFpF,YAAM,GAAkB,IAAI,CAAC;;SAI7C;QAED,6CAAQ,GAAR;YAAA,iBA8BC;YA7BC,IAAI,CAAC,MAAM,CAAC,YAAY,CAAC,SAAS,CAAC,UAAC,IAAS;gBAC3C,IAAM,UAAU,GAAG,KAAI,CAAC,SAAS,IAAI,KAAI,CAAC,MAAM,CAAC,SAAS,CAAC;gBAC3D,IAAM,OAAO,GAAG,KAAI,CAAC,MAAM,CAAC,uBAAuB,IAAI,KAAI,CAAC,cAAc,CAAC;gBAC3E,KAAI,CAAC,WAAW,CAAC,IAAI,EAAE,UAAU,EAAE,KAAK,EAAE,OAAO,CAAC,CAAC;aACpD,CAAC,CAAC;YACH,IAAI,CAAC,MAAM,CAAC,aAAa,CAAC,SAAS,CAAC,UAAC,MAAW;;gBAE9C,IAAM,SAAS,GAAG,MAAM,CAAC,MAAM,CAAC,EAAE,GAAG,KAAI,CAAC,SAAS,IAAI,KAAI,CAAC,MAAM,CAAC,SAAS,IAAI,EAAE,EAAE,CAAC;gBACrF,IAAM,eAAe,GAAG,KAAI,CAAC,MAAM,CAAC,SAAS,CAAC;gBAC9C,IAAM,IAAI,GAAG,EAAE,CAAC;gBAChB,IAAM,WAAW,GAAG,KAAI,CAAC,MAAM,CAAC,SAAS,IAAI,KAAI,CAAC,MAAM,CAAC,SAAS,CAAC,IAAI,CAAC;gBACxE,IAAI,WAAW,IAAI,KAAI,CAAC,EAAE,EAAE;oBAC1B,IAAM,gBAAgB,GAAG,SAAS,CAAC,eAAe,CAAC,CAAC;oBACpD,IAAM,aAAa,GAAG,KAAI,CAAC,EAAE,IAAI,KAAI,CAAC,EAAE,CAAC,IAAI,IAAI,KAAI,CAAC,EAAE,CAAC,IAAI,CAAC,cAAc,IAAI,KAAI,CAAC,EAAE,CAAC,IAAI,CAAC,cAAc,CAAC,WAAW,CAAkB,CAAC;oBAC1I,IAAM,SAAO,GAAG,aAAa,IAAI,aAAa,CAAC,OAAO,CAAC;oBACvD,IAAI,gBAAgB,IAAI,SAAO,EAAE;wBAC/B,SAAS,CAAC,eAAe,CAAC,GAAG,gBAAgB,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAC,IAAI,IAAK,OAAA,IAAI,KAAK,SAAO,GAAA,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;qBACvG;iBACF;;gBAED,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC,OAAO,CAAC,UAAC,KAAK;oBACnC,KAAI,CAAC,QAAQ,CAAC,IAAI,EAAE,KAAK,CAAC,KAAK,CAAC,GAAG,CAAC,EAAE,EAAE,CAAC,CAAC;iBAC3C,CAAC,CAAC;gBACH,KAAI,CAAC,WAAW,CAAC,IAAI,EAAE,SAAS,EAAE,IAAI,CAAC,CAAC;aACzC,CAAC,CAAC;YACH,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,SAAS,CAAC;gBAC1B,IAAM,UAAU,GAAG,KAAI,CAAC,SAAS,IAAI,KAAI,CAAC,MAAM,CAAC,SAAS,CAAC;gBAC3D,KAAI,CAAC,WAAW,CAAC,IAAI,EAAE,UAAU,CAAC,CAAC;aACpC,CAAC,CAAC;SACJ;;oBAvCFC,cAAS,SAAC,EAAE,QAAQ,EAAE,gBAAgB,EAAE;;;;;wBALFM,gBAAS,uBAUjCU,aAAQ;wBATdc,4BAAmB,uBASqBd,aAAQ,YAAIe,SAAI;;;;gCAH9D5B,UAAK,SAAC,cAAc;6BACpBA,UAAK,SAAC,QAAQ;;QAqCjB,iCAAC;KAAA,CAvC+C,WAAW;;ICpB3D;AACA;QAOE,+CACsB,YAA0B,EAClB,MAA2B;YADnC,iBAAY,GAAZ,YAAY,CAAc;YAClB,WAAM,GAAN,MAAM,CAAqB;SACpD;QAEL,wDAAQ,GAAR;YACE,IAAI,CAAC,IAAI,CAAC,YAAY,IAAI,CAAC,IAAI,CAAC,MAAM,IAAI,IAAI,CAAC,sBAAsB,KAAK,IAAI,EAAE;gBAC9E,OAAO;aACR;YACD,IAAM,SAAS,GAAG,IAAI,CAAC,YAAY,CAAC,UAAU,CAAC,MAAM,CAAC;YACtD,IAAM,cAAc,GAAG,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC;YACvC,IAAM,SAAS,GAAM,cAAc,SAAI,SAAW,CAAC;YACnD,IAAI,CAAC,YAAY,CAAC,QAAQ,CAAC,SAAS,EAAE,IAAI,CAAC,CAAC;SAC7C;;oBApBFH,cAAS,SAAC;wBACT,QAAQ,EAAE,0BAA0B;qBACrC;;;;;wBANQ4B,mBAAY,uBAYhBZ,aAAQ;wBAXJc,4BAAmB,uBAYvBd,aAAQ,YAAIe,SAAI;;;;6CALlB5B,UAAK;;QAiBR,4CAAC;KArBD;;;QCkCE,iCACsC,kBAAqC,EACrC,iBAAsC,EACtD,OAAwB,EACR,sBAA0C,EAC1C,wBAA8C;YAJ9C,uBAAkB,GAAlB,kBAAkB,CAAmB;YACrC,sBAAiB,GAAjB,iBAAiB,CAAqB;YACtD,YAAO,GAAP,OAAO,CAAiB;YACR,2BAAsB,GAAtB,sBAAsB,CAAoB;YAC1C,6BAAwB,GAAxB,wBAAwB,CAAsB;YAlCnE,mBAAc,GAAG,GAAG,CAAC;YAC9B,WAAM,GAA6B,IAAI,CAAC;YAYtC,yBAAoB,GAAsB,IAAIO,iBAAY,EAAO,CAAC;SAsBvE;QAhCL,sBACI,kDAAa;iBAMjB;gBACE,OAAO,IAAI,CAAC,cAAc,CAAC;aAC5B;iBATD,UACkB,KAAU;gBAC1B,IAAI,CAAC,cAAc,GAAG,KAAK,CAAC;gBAC5B,IAAI,CAAC,IAAI,CAAC,MAAM,IAAI,KAAK,IAAI,IAAI,CAAC,OAAO,IAAI,QAAQ,KAAK,CAAC,KAAK,QAAQ,EAAE;oBACxE,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,MAAM,EAAE,CAAC;iBACjD;aACF;;;WAAA;QAOD,+CAAa,GADb,UACc,GAAQ;;YAEpB,IAAI,IAAI,CAAC,kBAAkB,IAAI,IAAI,CAAC,aAAa,EAAE;gBACjD,IAAI,GAAG,EAAE;oBACP,IAAI,CAAC,aAAa,CAAC,GAAG,GAAG,GAAG,CAAC,KAAK,CAAC;oBACnC,IAAI,CAAC,aAAa,CAAC,KAAK,GAAG,GAAG,CAAC,IAAI,CAAC;iBACrC;qBAAM;oBACL,IAAI,CAAC,aAAa,CAAC,GAAG,GAAG,IAAI,CAAC;oBAC9B,IAAI,CAAC,aAAa,CAAC,KAAK,GAAG,IAAI,CAAC;iBACjC;aACF;SACF;QAUD,0CAAQ,GAAR;YACE,IAAI,IAAI,CAAC,kBAAkB,EAAE;gBAC3B,IAAI,CAAC,kBAAkB,CAAC,cAAc,GAAG,KAAK,CAAC;aAChD;iBAAM,IAAI,IAAI,CAAC,iBAAiB,EAAE;gBACjC,IAAI,CAAC,sBAAsB,EAAE,CAAC;aAC/B;iBAAM,IAAI,IAAI,CAAC,sBAAsB,EAAE;gBACtC,IAAI,CAAC,yBAAyB,EAAE,CAAC;aAClC;iBAAM,IAAI,IAAI,CAAC,wBAAwB,EAAE;gBACxC,IAAI,CAAC,2BAA2B,EAAE,CAAC;aACpC;SACF;QACD,2CAAS,GAAT;YACE,IAAI,IAAI,CAAC,MAAM,IAAI,QAAQ,IAAI,CAAC,aAAa,CAAC,KAAK,QAAQ,EAAE;gBAC3D,IAAM,OAAO,GAAG,IAAI,CAAC,MAAM,IAAI,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC;gBACpE,IAAI,OAAO,EAAE;oBACX,IAAI,CAAC,cAAc,EAAE,CAAC;iBACvB;aACF;iBAAM;gBACL,IAAI,CAAC,cAAc,EAAE,CAAC;aACvB;SACF;QAEO,gDAAc,GAAtB;YACE,IAAM,IAAI,GAAG,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC,aAAa,CAAC,KAAK,GAAG,IAAI,CAAC;YAClE,IAAM,GAAG,GAAG,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC,aAAa,CAAC,GAAG,GAAG,IAAI,CAAC;YAC/D,IAAI,IAAI,CAAC,kBAAkB,EAAE;gBAC3B,IAAI,CAAC,kBAAkB,CAAC,IAAI,GAAG,IAAI,CAAC;gBACpC,IAAM,QAAM,GAAG,IAAI,CAAC,kBAAkB,CAAC,UAAU,CAAC;gBAClD,IAAM,IAAI,GAAG,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,IAAI,CAAC,UAAC,CAAC,IAAK,OAAA,CAAC,CAAC,QAAM,CAAC,KAAK,GAAG,GAAA,CAAC,CAAC;gBACzE,IAAI,CAAC,kBAAkB,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC;aAC1C;iBAAM,IAAI,IAAI,CAAC,iBAAiB,EAAE;gBACjC,IAAI,CAAC,iBAAiB,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC;gBACxC,IAAI,CAAC,iBAAiB,CAAC,YAAY,GAAG,GAAG,CAAC;aAC3C;iBAAM,IAAI,IAAI,CAAC,sBAAsB,EAAE;gBACtC,IAAI,CAAC,sBAAsB,CAAC,UAAU,CAAC,GAAG,CAAC,CAAC;aAC7C;iBAAM,IAAI,IAAI,CAAC,wBAAwB,EAAE;gBACxC,IAAI,CAAC,wBAAwB,CAAC,cAAc,GAAG,GAAG,CAAC;gBACnD,IAAI,CAAC,wBAAwB,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC;aAChD;SACF;QACD,6CAAW,GAAX,UAAY,OAAsB;YAChC,IAAI,OAAO,CAAC,aAAa,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE;gBACzC,IAAI,CAAC,cAAc,EAAE,CAAC;aACvB;SACF;;QAGO,wDAAsB,GAA9B;YAAA,iBAmCC;YAlCC,IAAI,CAAC,IAAI,CAAC,iBAAiB,EAAE;gBAC3B,OAAO;aACR;YAED,IAAI,CAAC,iBAAiB,CAAC,YAAY,CAAC,SAAS,CAAC,UAAC,IAAS,IAAK,OAAA,KAAI,CAAC,uBAAuB,CAAC,IAAI,CAAC,GAAA,CAAC,CAAC;YAEjG,IAAI,CAAC,iBAAiB,CAAC,KAAK,CAAC,SAAS,CAAC;;gBAErC,KAAI,CAAC,uBAAuB,CAAC,IAAI,CAAC,CAAC;aACpC,CAAC,CAAC;YACH,IAAI,IAAI,CAAC,iBAAiB,CAAC,UAAU,EAAE;gBACrC,IAAI,CAAC,iBAAiB,CAAC,UAAU,CAAC,SAAS,CAAC,UAAC,KAA8D;oBACjG,IAAA,uBAAwB,EAAxB,+BAAwB,EAAE,mBAA6B,EAA7B,wCAA6B,CAAW;oBAC1E,IAAI,KAAK,KAAK,CAAC,CAAC,EAAE;wBAChB,OAAO;qBACR;oBACD,IAAM,aAAa,GAAG,YAAY,CAAC,YAAY,CAAC;oBAChD,IAAI,aAAa,IAAI,CAAC,YAAY,CAAC,YAAY,EAAE;wBAC/C,KAAI,CAAC,uBAAuB,CAAC,IAAI,CAAC,CAAC;qBACpC;yBAAM;wBACL,KAAI,CAAC,oBAAoB,CAAC,IAAI,CAAC,EAAE,GAAG,EAAE,YAAY,CAAC,YAAY,EAAE,KAAK,EAAE,YAAY,CAAC,WAAW,EAAE,CAAC,CAAC;qBACrG;iBACF,CAAC,CAAC;aACJ;YACD,IAAI,IAAI,CAAC,iBAAiB,CAAC,QAAQ,EAAE;gBACnC,IAAI,CAAC,iBAAiB,CAAC,YAAY,CAAC,SAAS,CAAC,UAAC,GAAQ;;oBACrD,IAAM,OAAO,GAAG,KAAI,CAAC,iBAAiB,CAAC,OAAO,CAAC;oBAC/C,IAAM,SAAS,GAAG,KAAI,CAAC,iBAAiB,CAAC,SAAS,CAAC;oBACnD,KAAI,CAAC,uBAAuB;wBAC1B,GAAC,OAAO,IAAG,GAAG;wBACd,GAAC,SAAS,IAAG,GAAG;4BAChB,CAAC;iBACJ,CAAC,CAAC;aACJ;SACF;;QAGO,2DAAyB,GAAjC;YAAA,iBAUC;YATC,IAAI,CAAC,IAAI,CAAC,sBAAsB,EAAE;gBAChC,OAAO;aACR;YAED,IAAI,CAAC,sBAAsB,CAAC,WAAW,CAAC,SAAS,CAAC,UAAC,IAAS,IAAK,OAAA,KAAI,CAAC,uBAAuB,CAAC,IAAI,CAAC,UAAU,CAAC,GAAA,CAAC,CAAC;YAEhH,IAAI,CAAC,sBAAsB,CAAC,KAAK,CAAC,SAAS,CAAC;gBAC1C,KAAI,CAAC,uBAAuB,CAAC,IAAI,CAAC,CAAC;aACpC,CAAC,CAAC;SACJ;;QAGO,6DAA2B,GAAnC;YAAA,iBAqBC;YApBC,IAAI,CAAC,IAAI,CAAC,wBAAwB,EAAE;gBAClC,OAAO;aACR;YAED,IAAI,IAAI,CAAC,wBAAwB,CAAC,WAAW,EAAE;gBAC7C,IAAI,CAAC,wBAAwB,CAAC,WAAW,CAAC,SAAS,CAAC,UAAC,IAAS,IAAK,OAAA,KAAI,CAAC,uBAAuB,CAAC,IAAI,CAAC,UAAU,CAAC,GAAA,CAAC,CAAC;aACnH;iBAAM;;gBAEL,IAAI,CAAC,wBAAwB,CAAC,YAAY,CAAC,SAAS,CAAC,UAAC,CAAM;oBAC1D,IAAI,IAAI,GAAG,CAAC,CAAC;oBACb,IAAI,CAAC,CAAC,IAAI,EAAE;wBACV,IAAI,GAAG,CAAC,CAAC,IAAI,CAAC;qBACf;oBACD,KAAI,CAAC,uBAAuB,CAAC,IAAI,CAAC,CAAC;iBACpC,CAAC,CAAC;aACJ;YAED,IAAI,CAAC,wBAAwB,CAAC,KAAK,CAAC,SAAS,CAAC;gBAC5C,KAAI,CAAC,uBAAuB,CAAC,IAAI,CAAC,CAAC;aACpC,CAAC,CAAC;SACJ;;QAGO,yDAAuB,GAA/B,UAAgC,IAAS;YACvC,IAAI,OAAO,CAAC;YACZ,IAAI,SAAS,CAAC;YACd,IAAI,OAAO,GAAW,IAAI,CAAC,cAAc,CAAC;YAC1C,IAAI,IAAI,CAAC,iBAAiB,EAAE;gBAC1B,OAAO,GAAG,IAAI,CAAC,iBAAiB,CAAC,OAAO,CAAC;gBACzC,SAAS,GAAG,IAAI,CAAC,iBAAiB,CAAC,SAAS,CAAC;gBAC7C,OAAO,GAAG,IAAI,CAAC,iBAAiB,CAAC,uBAAuB,IAAI,IAAI,CAAC,cAAc,CAAC;aACjF;YAED,IAAI,IAAI,CAAC,sBAAsB,EAAE;gBAC/B,OAAO,GAAG,IAAI,CAAC,sBAAsB,CAAC,OAAO,CAAC;gBAC9C,SAAS,GAAG,IAAI,CAAC,sBAAsB,CAAC,SAAS,CAAC;aACnD;YAED,IAAI,IAAI,CAAC,wBAAwB,EAAE;gBACjC,OAAO,GAAG,IAAI,CAAC,wBAAwB,CAAC,OAAO,CAAC;gBAChD,SAAS,GAAG,IAAI,CAAC,wBAAwB,CAAC,SAAS,CAAC;gBACpD,OAAO,GAAG,IAAI,CAAC,wBAAwB,CAAC,SAAS,IAAI,IAAI,CAAC,cAAc,CAAC;aAC1E;YAED,IAAI,CAAC,kBAAkB,CAAC,IAAI,EAAE,OAAO,EAAE,SAAS,EAAE,OAAO,CAAC,CAAC;SAC5D;QAEO,oDAAkB,GAA1B,UAA2B,IAAI,EAAE,OAAO,EAAE,SAAS,EAAE,OAAqB;YAArB,wBAAA;gBAAA,aAAqB;;YACxE,IAAM,SAAS,GAAG,EAAE,GAAG,EAAE,IAAI,EAAE,KAAK,EAAE,IAAI,EAAE,CAAC;YAC7C,IAAI,IAAI,EAAE;;;gBAGR,IAAI,KAAK,CAAC,OAAO,CAAC,IAAI,CAAC,EAAE;oBACvB,SAAS,CAAC,GAAG,GAAG,IAAI,CAAC,GAAG,CAAC,UAAC,CAAC,IAAK,OAAA,CAAC,CAAC,OAAO,CAAC,GAAA,CAAC,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;oBAC1D,SAAS,CAAC,KAAK,GAAG,IAAI,CAAC,GAAG,CAAC,UAAC,CAAC;wBAC3B,IAAI,SAAS,CAAC,OAAO,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,EAAE;4BAC/B,OAAO,SAAS,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAC,CAAC,EAAE,CAAC;gCACtC,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC;6BACb,EAAE,CAAC,CAAC,CAAC;yBACP;6BAAM;4BACL,OAAO,CAAC,CAAC,SAAS,CAAC,CAAC;yBACrB;qBACF,CAAC,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;iBAClB;qBAAM;oBACL,IAAI,OAAO,EAAE;wBACX,SAAS,CAAC,GAAG,GAAG,IAAI,CAAC,OAAO,CAAC,CAAC;qBAC/B;oBAED,IAAI,SAAS,EAAE;wBACb,IAAI,SAAS,CAAC,OAAO,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,EAAE;4BAC/B,SAAS,CAAC,KAAK,GAAG,SAAS,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAC,CAAC,EAAE,CAAC;gCACjD,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC;6BACb,EAAE,IAAI,CAAC,CAAC;yBACV;6BAAM;4BACL,SAAS,CAAC,KAAK,GAAG,IAAI,CAAC,SAAS,CAAC,CAAC;yBACnC;qBACF;iBACF;aACF;YACD,IAAI,CAAC,oBAAoB,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;SAC3C;;oBA7NFV,cAAS,SAAC;wBACT,QAAQ,EAAE,kBAAkB;qBAC7B;;;;;wBAPQgC,uCAAiB,uBAwCrBC,SAAI,YAAIF,SAAI,YAAIf,aAAQ;wBAvCpBc,4BAAmB,uBAwCvBG,SAAI,YAAIF,SAAI,YAAIf,aAAQ;wBA1CmHkB,oBAAe,uBA2C1JlB,aAAQ;wBAxCJmB,8BAAkB,uBAyCtBF,SAAI,YAAIF,SAAI,YAAIf,aAAQ;wBAxCpBoB,kCAAoB,uBAyCxBH,SAAI,YAAIF,SAAI,YAAIf,aAAQ;;;;oCA/B1Bb,UAAK,SAAC,gBAAgB;2CAUtBmB,WAAM;oCAENlB,iBAAY,SAAC,aAAa,EAAE,CAAC,QAAQ,CAAC;;QA0MzC,8BAAC;KA9ND;;;QCEI,iCAAoB,IAAmB,EAAU,EAAc,EAAU,QAAmB;YAAxE,SAAI,GAAJ,IAAI,CAAe;YAAU,OAAE,GAAF,EAAE,CAAY;YAAU,aAAQ,GAAR,QAAQ,CAAW;SAE3F;QACD,0CAAQ,GAAR;SAEC;QACD,6CAAW,GAAX,UAAY,OAAsB;YAC9B,IAAI,CAAC,IAAI,CAAC,WAAW,EAAE;gBACnB,IAAI,CAAC,iBAAiB,EAAE,CAAC;aAC5B;YACD,IAAI,OAAO,CAAC,mBAAmB,CAAC,IAAI,IAAI,CAAC,WAAW,EAAE;gBAClD,IAAI,IAAI,CAAC,iBAAiB,EAAE;oBACxB,IAAI,CAAC,QAAQ,CAAC,WAAW,CAAC,IAAI,CAAC,WAAW,EAAE,SAAS,CAAC,CAAC;iBAC1D;qBAAM;oBACH,IAAI,CAAC,QAAQ,CAAC,QAAQ,CAAC,IAAI,CAAC,WAAW,EAAE,SAAS,EAAE,MAAM,CAAC,CAAC;iBAC/D;aACJ;SACJ;QACO,mDAAiB,GAAzB;YACI,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;YACtD,IAAI,CAAC,QAAQ,CAAC,QAAQ,CAAC,IAAI,CAAC,WAAW,EAAE,OAAO,EAAE,MAAM,CAAC,CAAC;YAC1D,IAAI,CAAC,QAAQ,CAAC,QAAQ,CAAC,IAAI,CAAC,WAAW,EAAE,QAAQ,EAAE,MAAM,CAAC,CAAC;YAC3D,IAAI,CAAC,QAAQ,CAAC,QAAQ,CAAC,IAAI,CAAC,WAAW,EAAE,UAAU,EAAE,UAAU,CAAC,CAAC;YACjE,IAAI,CAAC,QAAQ,CAAC,QAAQ,CAAC,IAAI,CAAC,WAAW,EAAE,kBAAkB,EAAE,uBAAuB,CAAC,CAAC;YACtF,IAAI,CAAC,QAAQ,CAAC,QAAQ,CAAC,IAAI,CAAC,WAAW,EAAE,SAAS,EAAE,GAAG,CAAC,CAAC;YACzD,IAAI,CAAC,QAAQ,CAAC,QAAQ,CAAC,IAAI,CAAC,WAAW,EAAE,SAAS,EAAE,MAAM,CAAC,CAAC;YAC5D,IAAI,CAAC,QAAQ,CAAC,WAAW,CAAC,IAAI,CAAC,EAAE,CAAC,aAAa,EAAE,IAAI,CAAC,WAAW,CAAC,CAAC;SACtE;;oBAjCJJ,cAAS,SAAC;wBACP,QAAQ,EAAE,kBAAkB;qBAC/B;;;;;wBAHQkB,8BAAa;wBADFmB,eAAU;wBAASC,cAAS;;;;wCAM3CnC,UAAK,SAAC,gBAAgB;;QA8B3B,8BAAC;KAlCD;;;QCAA;SAKC;;oBALAH,cAAS,SAAC;wBACP,QAAQ,EAAE,cAAc;qBAC3B;;QAGD,0BAAC;KALD,IAKC;;QAED;SAKC;;oBALAA,cAAS,SAAC;wBACP,QAAQ,EAAE,wBAAwB;qBACrC;;QAGD,kCAAC;KALD,IAKC;;QAED;SAKC;;oBALAA,cAAS,SAAC;wBACP,QAAQ,EAAE,6BAA6B;qBAC1C;;QAGD,yCAAC;KALD,IAKC;;QAED;SAKC;;oBALAA,cAAS,SAAC;wBACP,QAAQ,EAAE,qBAAqB;qBAClC;;;iCAEIG,UAAK,SAAC,YAAY;;QACvB,+BAAC;KALD,IAKC;;QAED;SAKC;;oBALAH,cAAS,SAAC;wBACP,QAAQ,EAAE,yBAAyB;qBACtC;;QAGD,qCAAC;KALD;;ICtBA;IAEA;;;AAGA;;QAkCE,+CAAmB,WAAwB,EAAS,SAAoB,EAAS,IAAuB;YAArF,gBAAW,GAAX,WAAW,CAAa;YAAS,cAAS,GAAT,SAAS,CAAW;YAAS,SAAI,GAAJ,IAAI,CAAmB;;YA5BhG,eAAU,GAAW,IAAI,CAAC;;YAE1B,mBAAc,GAAW,IAAI,CAAC;;;;YAI9B,cAAS,GAAG,KAAK,CAAC;;;;YAIlB,YAAO,GAAQ,IAAI,CAAC;;;;YAWpB,sBAAiB,GAAiB,IAAIyB,YAAO,EAAO,CAAC;YACrD,wBAAmB,GAAG,KAAK,CAAC;;;;YAI1B,sBAAiB,GAAsB,IAAIf,iBAAY,EAAO,CAAC;YAGvE,IAAI,CAAC,SAAS,CAAC,EAAE,CAAC,CAAC;YACnB,IAAI,CAAC,mBAAmB,GAAG,IAAI,CAAC,SAAS,IAAI,IAAI,CAAC,SAAS,CAAC,YAAY,IAAI,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC,QAAQ,CAAC,GAAG,CAAU6B,uCAAgC,EAAE,KAAK,CAAC,IAAI,KAAK,CAAC;YAChL,IAAI,CAAC,aAAa,EAAE,CAAC;SACtB;QArBD,sBAAc,wDAAK;iBAAnB;gBACE,OAAO,IAAI,CAAC,MAAM,CAAC;aACpB;iBACD,UAAoB,KAAK;gBACvB,IAAI,CAAC,MAAM,GAAG,KAAK,CAAC;aACrB;;;WAHA;;QAuBD,wDAAQ,GAAR;YAAA,iBA6BC;YA5BS,IAAA,0CAAY,EAAZ,iCAAY,CAAgC;YACpD,IAAI,QAAQ,KAAK,CAAC,EAAE;;gBAElB,IAAI,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,QAAQ,IAAI,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,MAAM,GAAG,CAAC,KAAK,OAAO,IAAI,CAAC,IAAI,CAAC,aAAa,CAAC,KAAK,UAAU,EAAE;oBAC5G,IAAI,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC,CAAC,QAAQ,EAAE,QAAQ,GAAG,CAAC,EAAE,QAAQ,GAAG,CAAC,EAAE,QAAQ,GAAG,CAAC,CAAC,CAAC,CAAC;iBAChF;aACF;YACD,IAAI,CAAC,eAAe,EAAE,CAAC;YACvB,IAAI,CAAC,QAAQ,EAAE,CAAC;YAChB,MAAM,CAAC,UAAU,CAAC;gBAChB,KAAI,CAAC,iBAAiB,EAAE,CAAC;aAC1B,EAAE,CAAC,CAAC,CAAC;YACN,IAAI,CAAC,8BAA8B,EAAE,CAAC;YACtC,IAAI,CAAC,iBAAiB,CAAC,IAAI,CAACb,sBAAY,CAAC,GAAG,CAAC,CAAC,CAAC,SAAS,CAAC,UAAC,MAAc;gBACtE,IAAI,CAAC,KAAI,CAAC,SAAS,IAAI,CAAC,KAAI,CAAC,SAAS,CAAC,YAAY,IAAI,KAAI,CAAC,SAAS,CAAC,YAAY,CAAC,UAAU,EAAE;oBAC7F,OAAO;iBACR;gBACD,KAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC;;;;;;;aAOvB,CAAC,CAAC;YACH,IAAI,IAAI,CAAC,SAAS,IAAI,IAAI,CAAC,SAAS,CAAC,YAAY,IAAI,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC,cAAc,EAAE;gBAC/F,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC,cAAc,CAAC,aAAa,GAAGf,oBAAa,CAAC,uBAAuB,CAAC;aAClG;SACF;QAED,2DAAW,GAAX,UAAY,OAAsB;YAChC,IAAI,CAAC,QAAQ,EAAE,CAAC;SACjB;QAQD,sBAAc,6DAAU;;;;;iBAAxB;gBACE,OAAO,IAAI,CAAC,WAAW,CAAC,UAAU,CAAC;aACpC;;;WAAA;QAID,sBAAc,8DAAW;;;;iBAAzB;;gBAEE,IAAI,IAAI,CAAC,SAAS,CAAC,WAAW,KAAK,GAAG,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,WAAW,EAAE;oBACrE,OAAO,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC;iBAC9B;;gBAED,IAAI,WAAW,GAAG,IAAI,CAAC,SAAS,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC;gBACvD,WAAW,GAAG,WAAW,CAAC,CAAC,CAAC,CAAC,WAAW,EAAE,GAAG,WAAW,CAAC,SAAS,CAAC,CAAC,EAAE,WAAW,CAAC,MAAM,CAAC,CAAC;gBAC1F,IAAM,KAAK,GAAG,WAAW,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;gBAErC,IAAM,aAAa,GAAG,KAAK,CAAC,MAAM,CAAC,UAAC,IAAY;oBAC9C,OAAO,IAAI,KAAK,EAAE,CAAC;iBACpB,CAAC,CAAC;gBACH,OAAO,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC,aAAa,CAAC,CAAC;aACjD;;;WAAA;;;;QAIO,+DAAe,GAAvB;YACE,IAAM,UAAU,GAAG,IAAI,CAAC,SAAS,IAAI,IAAI,CAAC,SAAS,CAAC,YAAY,IAAI,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC,iBAAiB,EAAE,CAAC;YACpH,IAAM,OAAO,GAAG,IAAI,CAAC,SAAS,IAAI,IAAI,CAAC,SAAS,CAAC,YAAY,IAAI,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC,OAAO,CAAC;YACrG,IAAM,EAAE,GAAG,IAAI,CAAC,IAAI,IAAI,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC;;YAErC,IAAI,CAAC,OAAO,IAAI,CAAC,EAAE,EAAE;gBACnB,OAAO;aACR;YACD,IAAM,GAAG,GAAG,UAAU,IAAI,UAAU,CAAC,aAAa,IAAI,UAAU,CAAC,aAAa,CAAC,GAAG,CAAC,OAAO,CAAC,IAAI,IAAI,GAAG,EAAe,CAAC;YACtH,UAAU,IAAI,UAAU,CAAC,aAAa,IAAI,UAAU,CAAC,aAAa,CAAC,GAAG,CAAC,OAAO,EAAE,GAAG,CAAC,GAAG,CAAC,EAAE,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;SACzG;;;;QAIS,6DAAa,GAAvB;YACE,IAAM,WAAW,GAAG,IAAI,CAAC,SAAS,CAAC,WAAW,CAAC;YAC/C,IAAM,WAAW,GAAG,IAAI,CAAC,SAAS,CAAC,WAAW,CAAC;YAC/C,IAAM,UAAU,GAAG,WAAW,IAAI,WAAW,CAAC,UAAU,IAAI,EAAE,CAAC;YAC/D,IAAI,WAAW,KAAK,GAAG,EAAE;gBACvB,OAAO,UAAU,CAAC;aACnB;iBAAM;gBACL,IAAM,YAAY,GAAG,WAAW,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAC,IAAI,IAAK,OAAA,CAAC,CAAC,IAAI,IAAI,IAAI,CAAC,MAAM,GAAG,CAAC,GAAA,CAAC,CAAC;;;;gBAIlG,IAAI,QAAQ,GAAG,YAAY,CAAC,YAAY,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;gBACrD,QAAQ,GAAG,QAAQ,CAAC,MAAM,CAAC,CAAC,EAAE,QAAQ,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;;;;;;;gBAQnD,IAAM,KAAK,GAAG,YAAY,CAAC,KAAK,CAAC,CAAC,EAAE,YAAY,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;gBAC7D,IAAM,WAAW,GAAG,WAAW,CAAC,QAAQ,CAAC,KAAK,CAAgB,CAAC;gBACvD,IAAA,+CAAY,EAAZ,iCAAY,CAAqC;;gBAEzD,IAAI,WAAW,IAAI,WAAW,CAAC,SAAS,EAAE;oBACxC,IAAM,GAAG,GAAM,QAAQ,SAAI,WAAW,CAAC,SAAW,CAAC;;oBAEnD,IAAM,MAAM,GAAG,UAAU,CAAC,GAAG,CAAC,IAAI,EAAE,CAAC;oBACrC,IAAI,MAAM,CAAC,cAAc,CAAC,YAAY,CAAC,EAAE;wBACvC,MAAM,CAAC,KAAK,GAAG,MAAM,CAAC,UAAU,CAAC;qBAClC;;oBAED,IAAI,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,MAAM,GAAG,CAAC,EAAE;wBAClC,MAAM,CAAC,SAAS,GAAG,CAAC,CAAC;wBACrB,MAAM,CAAC,QAAQ,GAAG,QAAQ,CAAC;qBAC5B;oBACD,OAAO,MAAM,CAAC;iBACf;qBAAM;;oBAEL,OAAO,EAAE,SAAS,EAAE,CAAC,EAAE,QAAQ,UAAA,EAAE,CAAC;iBACnC;aACF;SACF;;;;;;;;QASS,qEAAqB,GAA/B,UAAgC,MAAc,EAAE,IAAS;YACvD,IAAM,KAAK,GAAG,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC;YACpC,IAAI,IAAI,CAAC,SAAS,IAAI,IAAI,CAAC,SAAS,CAAC,YAAY,IAAI,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC,UAAU,IAAI,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC,UAAU,CAAC,OAAO,KAAK6B,cAAO,CAAC,SAAS,IAAI,MAAM,EAAE;gBAC7K,IAAI,MAAM,CAAC,IAAI,KAAK5B,iBAAU,CAAC,IAAI,IAAI,MAAM,CAAC,IAAI,KAAKA,iBAAU,CAAC,MAAM,IAAI,MAAM,CAAC,IAAI,KAAKA,iBAAU,CAAC,oBAAoB,EAAE;oBAC3H,OAAO,EAAE,MAAM,EAAE,IAAI,EAAE,KAAK,OAAA,EAAE,CAAC;iBAChC;aACF;YACD,IAAM,SAAS,GAAG,IAAI,CAAC,cAAc,EAAE,CAAC;YACxC,IAAI,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,KAAK,IAAI,CAAC,SAAS,CAAC,SAAS,CAAC,EAAE;gBACvD,OAAO,EAAE,MAAM,EAAE,KAAK,EAAE,CAAC;aAC1B;YACD,OAAO,EAAE,MAAM,EAAE,IAAI,EAAE,KAAK,OAAA,EAAE,CAAC;SAChC;QACS,6DAAa,GAAvB;YAAA,iBAiEC;;YA/DC,IAAI,CAAC,IAAI,IAAI,IAAI,CAAC,IAAI,CAAC,YAAY,IAAI,IAAI,CAAC,IAAI,CAAC,YAAY,CAAC,SAAS,CAAC,UAAC,KAAU;gBACjF,IAAM,YAAY,GAAG,KAAI,CAAC,IAAI,CAAC,UAAU,CAAC;;gBAE1C,IAAI,CAAC,YAAY,EAAE;oBACjB,KAAI,CAAC,UAAU,GAAG,KAAI,CAAC,IAAI,CAAC,QAAQ,CAAC;oBACrC,KAAI,CAAC,cAAc,GAAG,KAAI,CAAC,IAAI,CAAC,SAAS,CAAC;oBAC1C,KAAI,CAAC,eAAe,EAAE,CAAC;;iBAExB;qBAAM;;oBAEL,IAAM,UAAU,GAAG,KAAI,CAAC,IAAI,IAAI,KAAI,CAAC,IAAI,CAAC,UAAU,IAAI,IAAI,CAAC;oBAC7D,IAAI,UAAU,GAAG,KAAI,CAAC,IAAI,CAAC,QAAQ,IAAI,KAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,GAAG,CAAC,IAAI,EAAE,CAAC;oBAC3E,IAAM,aAAa,GAAG,KAAI,CAAC,IAAI,CAAC,SAAS,IAAI,KAAI,CAAC,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,GAAG,CAAC,IAAI,EAAE,CAAC;oBAClF,IAAI,UAAU,EAAE;wBACd,IAAI,CAAC,UAAU,CAAC,QAAQ,CAAC,UAAU,CAAC,EAAE;4BACpC,UAAU,CAAC,MAAM,CAAC,CAAC,EAAE,CAAC,EAAE,UAAU,CAAC,CAAC;4BACpC,aAAa,CAAC,MAAM,CAAC,CAAC,EAAE,CAAC,EAAE,KAAK,CAAC,CAAC;yBACnC;qBACF;;oBAED,IAAM,UAAU,GAAG,KAAI,CAAC,SAAS,IAAI,KAAI,CAAC,SAAS,CAAC,YAAY,CAAC,UAAU,CAAC,UAAU,IAAI,IAAI,CAAC;oBAE/F,IAAI,UAAU,CAAC,MAAM,GAAG,CAAC,EAAE;wBACzB,IAAI,UAAU,EAAE;4BACd,IAAM,cAAY,GAAG,IAAI6B,mBAAY,CAAC,UAAU,CAAC,CAAC;4BAClD,UAAU,GAAG,UAAU,CAAC,GAAG,CAAC,UAAA,KAAK;;gCAE/B,IAAM,KAAK,GAAG,KAAK,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;gCAC/B,IAAM,QAAQ,GAAG,cAAY,CAAC,iBAAiB,CAAC,KAAK,CAAC,CAAC;gCACvD,IAAM,aAAa,GAAG,QAAQ,IAAI,QAAQ,CAAC,YAAY,CAAC,MAAM,CAAC,IAAI,IAAI,CAAC;gCACxE,OAAO,aAAa,CAAC;;;6BAGtB,CAAC,CAAC;yBACJ;qBACF;;oBAED,IAAM,MAAM,GAAG,UAAU,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;oBACpC,IAAM,UAAU,GAAG,aAAa,CAAC,IAAI,CAAC,GAAG,CAAC,IAAI,KAAK,CAAC;oBACpD,IAAM,YAAY,GAAiB,KAAI,CAAC,SAAS,IAAI,KAAI,CAAC,SAAS,CAAC,YAAY,IAAI,IAAI,CAAC;oBACzF,IAAI,YAAY,EAAE;wBAChB,YAAY,CAAC,UAAU,CAAC,oBAAoB,CAAC,aAAa,CAAC,KAAI,CAAC,SAAS,CAAC,WAAW,EAAE,MAAM,EAAE,UAAU,CAAC,CAAC;qBAC5G;iBACF;aACF,CAAC,CAAC;;YAEH,IAAI,CAAC,IAAI,IAAI,IAAI,CAAC,IAAI,CAAC,aAAa,IAAI,IAAI,CAAC,IAAI,CAAC,aAAa,CAAC,SAAS,CAAC,UAAC,KAAU;gBACnF,KAAI,CAAC,OAAO,GAAG,KAAK,CAAC;gBACrB,IAAI,CAAC,KAAI,CAAC,IAAI,CAAC,YAAY,EAAE;oBAC3B,IAAI,KAAI,CAAC,WAAW,CAAC,MAAM,GAAG,CAAC,IAAI,CAAC,KAAI,CAAC,WAAW,CAAC,SAAS,EAAE;wBAC9D,IAAM,EAAE,GAAG,KAAI,CAAC,WAAW,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC;wBAC5C,KAAI,CAAC,WAAW,CAAC,YAAY,CAAC,EAAE,CAAC,CAAC;qBACnC;oBACD,KAAI,CAAC,WAAW,CAAC,MAAM,CAAC,KAAI,CAAC,OAAO,CAAC,CAAC;oBACtC,KAAI,CAAC,QAAQ,EAAE,CAAC;iBACjB;aACF,CAAC,CAAC;YACH,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC,UAAU,CAAC,WAAW,CAAC,SAAS,CAAC,UAAC,OAAO;gBACnE,IAAI,OAAO,IAAI,OAAO,KAAK,sBAAsB,IAAI,KAAI,CAAC,OAAO,IAAI,MAAM,CAAC,IAAI,CAAC,KAAI,CAAC,OAAO,CAAC,CAAC,MAAM,GAAG,CAAC,EAAE;oBACzG,KAAI,CAAC,OAAO,GAAG,EAAE,CAAC;oBAClB,KAAI,CAAC,QAAQ,EAAE,CAAC;iBACjB;aACF,CAAC,CAAC;SACJ;;;;;QAMO,+DAAe,GAAvB,UAAwB,MAAe;YAAvC,iBAkBC;;YAhBC,IAAM,UAAU,GAAG,IAAI,CAAC,IAAI,IAAI,IAAI,CAAC,IAAI,CAAC,UAAU,IAAI,IAAI,CAAC;YAC7D,IAAI,UAAU,EAAE;gBACd,IAAM,eAAa,GAAG,IAAI,CAAC,UAAU,IAAI,IAAI,CAAC,UAAU,CAAC,KAAK,CAAC,GAAG,CAAC,IAAI,EAAE,CAAC;gBAC1E,IAAM,WAAW,GAAG,UAAU,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,OAAO,EAAE,CAAC;gBACpD,WAAW,CAAC,OAAO,CAAC,UAAC,KAAa;oBAChC,IAAI,CAAC,eAAa,CAAC,QAAQ,CAAC,KAAK,CAAC,EAAE;wBAClC,eAAa,CAAC,MAAM,CAAC,CAAC,EAAE,CAAC,EAAE,KAAK,CAAC,CAAC;wBAClC,IAAM,gBAAgB,GAAG,KAAI,CAAC,cAAc,IAAI,KAAI,CAAC,cAAc,CAAC,KAAK,CAAC,GAAG,CAAC,IAAI,EAAE,CAAC;wBACrF,gBAAgB,CAAC,MAAM,CAAC,CAAC,EAAE,CAAC,EAAE,KAAK,CAAC,CAAC;wBACrC,KAAI,CAAC,UAAU,GAAG,eAAa,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;wBAC1C,KAAI,CAAC,cAAc,GAAG,gBAAgB,CAAC,IAAI,CAAC,GAAG,CAAC,IAAI,KAAK,CAAC;qBAC3D;iBACF,CAAC,CAAC;aACJ;YACD,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC,IAAI,CAAC,UAAU,EAAE,IAAI,CAAC,cAAc,CAAC,CAAC;YAC9D,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC;SACvB;;;;;;;QAQD,wDAAQ,GAAR,UAAS,MAAe;YAAxB,iBAsDC;YArDC,IAAM,cAAc,GAAG,IAAI,CAAC,IAAI,IAAI,IAAI,CAAC,IAAI,CAAC,YAAY,IAAI,KAAK,CAAC;;YAEpE,IAAM,UAAU,GAAG,IAAI,CAAC,UAAU,CAAC,MAAM,CAAC,CAAC;YAC3C,IAAI,UAAU,EAAE;gBACd,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC;gBACtB,IAAI,CAAC,eAAe,CAAC,MAAM,CAAC,CAAC;gBAC7B,OAAO;aACR;YACD,IAAI,CAAC,SAAS,GAAG,KAAK,CAAC;;YAEvB,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,QAAQ,KAAK,IAAI,IAAI,MAAM,IAAI,MAAM,CAAC,IAAI,KAAK7B,iBAAU,CAAC,MAAM,KAAK,IAAI,CAAC,OAAO,IAAI,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,MAAM,GAAG,CAAC,IAAI,CAAC,cAAc,EAAE;gBAC3J,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC,UAAU,CAAC,2BAA2B,IAAI,CAAC,IAAI,CAAC,mBAAmB,EAAE;oBACpG,IAAI,CAAC,OAAO,GAAG,EAAE,CAAC;oBAClB,IAAI,CAAC,IAAI,CAAC,cAAc,EAAE,CAAC;iBAC5B;aACF;YACD,IAAM,eAAe,GAAG,IAAI,CAAC,eAAe,CAAC,MAAM,CAAC,CAAC;YACrD,IAAI,eAAe,EAAE;gBACnB,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;aACvC;;YAED,IAAM,IAAI,GAAQ,IAAI,CAAC,WAAW,CAAC,MAAM,EAAE,CAAC;;;;YAK5C,IAAI,IAAI,CAAC,OAAO,IAAI,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,MAAM,GAAG,CAAC,IAAI,CAAC,cAAc,KAAK,CAAC,MAAM,IAAI,MAAM,IAAI,MAAM,CAAC,IAAI,KAAKA,iBAAU,CAAC,gBAAgB,IAAI,MAAM,CAAC,IAAI,KAAKA,iBAAU,CAAC,sBAAsB,CAAC,EAAE;gBACtM,IAAI,IAAI,IAAI,IAAI,CAAC,MAAM,GAAG,CAAC,EAAE;;oBAE3B,IAAM,GAAG,GAAI,IAAW,CAAC,IAAI,CAAC,UAAC,IAAI,IAAK,OAAA,IAAI,CAAC,KAAI,CAAC,WAAW,CAAC,UAAU,CAAC,KAAK,KAAI,CAAC,WAAW,CAAC,SAAS,GAAA,CAAC,CAAC;oBAC1G,IAAI,CAAC,GAAG,EAAE;wBACR,IAAM,UAAU,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,WAAW,CAAC,UAAU,CAAC,CAAC;wBACxD,IAAI,CAAC,WAAW,CAAC,YAAY,CAAC,UAAU,EAAE,IAAI,EAAE,IAAI,CAAC,CAAC;qBACvD;iBACF;qBAAM;;;oBAGL,IAAI,IAAI,CAAC,WAAW,CAAC,SAAS,EAAE;wBAC9B,IAAI,CAAC,WAAW,CAAC,YAAY,CAAC,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,CAAC,CAAC;qBACvD;;oBAED,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,WAAW,EAAE;wBAC1B,IAAI,CAAC,SAAS,CAAC,EAAE,CAAC,CAAC;qBACpB;iBACF;aACF;YACD,IAAM,MAAM,GAAG,IAAI,CAAC,qBAAqB,CAAC,MAAM,EAAE,IAAI,CAAC,CAAC;YACxD,IAAI,CAAC,MAAM,CAAC,MAAM,EAAE;gBAClB,OAAO;aACR;;YAED,IAAI,CAAC,UAAU,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;YAC9B,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC,CAAC;SACvD;;;;;;QAMO,+DAAe,GAAvB,UAAwB,MAAe;YACrC,IAAM,cAAc,GAAG,IAAI,CAAC,IAAI,IAAI,IAAI,CAAC,IAAI,CAAC,YAAY,IAAI,KAAK,CAAC;;YAEpE,IAAI,cAAc,KAAK,IAAI,EAAE;gBAC3B,OAAO,KAAK,CAAC;aACd;;YAED,IAAI,CAAC,IAAI,CAAC,OAAO,IAAI,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,MAAM,GAAG,CAAC,EAAE;gBACzD,OAAO,KAAK,CAAC;aACd;YACD,IAAI,MAAM,EAAE;gBACV,OAAO,MAAM,CAAC,IAAI,KAAKA,iBAAU,CAAC,IAAI,CAAC;aACxC;YACD,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC;SAC5B;QACO,0DAAU,GAAlB,UAAmB,MAAe;;YAEhC,IAAI,CAAC,IAAI,CAAC,UAAU,IAAI,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC,MAAM,GAAG,CAAC,EAAE;gBAC/D,OAAO,KAAK,CAAC;aACd;YACD,IAAI,IAAI,CAAC,SAAS,EAAE;gBAClB,OAAO,KAAK,CAAC;aACd;YACD,IAAI,MAAM,EAAE;gBACV,OAAO,MAAM,CAAC,IAAI,KAAK,MAAM,IAAI,MAAM,CAAC,IAAI,KAAK,kBAAkB,CAAC;aACrE;YACD,OAAO,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC;SAC3B;;;;;QAKO,0DAAU,GAAlB,UAAmB,KAAU;YACnB,IAAA,2BAAS,EAAE,yBAAQ,EAAE,mBAAK,EAAE,6BAAU,EAAE,iBAAI,CAAW;YAC/D,IAAM,eAAe,GAAG,IAAI,CAAC,IAAI,CAAC,oBAAoB,IAAI,KAAK,CAAC;YAChE,IAAI,CAAC,IAAI,CAAC,KAAK,GAAG,KAAK,CAAC;YACxB,IAAI,CAAC,IAAI,CAAC,QAAQ,GAAG,QAAQ,CAAC;YAC9B,IAAI,CAAC,IAAI,CAAC,SAAS,GAAG,SAAS,CAAC;YAChC,IAAI,CAAC,IAAI,CAAC,UAAU,GAAG,UAAU,CAAC;YAClC,IAAI,CAAC,IAAI,CAAC,sBAAsB,GAAG,KAAK,CAAC;;YAEzC,IAAI,QAAQ,KAAK,CAAC,EAAE;gBAClB,IAAI,CAAC,IAAI,CAAC,UAAU,GAAG,KAAK,CAAC;gBAC7B,IAAI,CAAC,IAAI,CAAC,SAAS,GAAG,CAAC,CAAC;;;aAGzB;YACD,IAAI,eAAe,EAAE;gBACnB,IAAI,CAAC,IAAI,CAAC,eAAe,CAAC;oBACxB,KAAK,EAAE,IAAI;oBACX,SAAS,WAAA;oBACT,QAAQ,UAAA;oBACR,KAAK,OAAA;iBACN,CAAC,CAAC;aACJ;iBAAM;gBACL,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC;aAC1B;SACF;;;;QAIS,0DAAU,GAApB,UAAqB,KAAkB;YACrC,IAAI,IAAI,CAAC;YACT,IAAI,QAAQ,KAAK,CAAC,KAAK,WAAW,EAAE;gBAClC,IAAI,GAAG,KAAK,CAAC;aACd;iBAAM;gBACL,IAAI,GAAG,IAAI,CAAC,WAAW,CAAC,MAAM,EAAE,CAAC;aAClC;;YAEG,IAAA,+BAA4D,EAA1D,iBAAa,EAAb,kCAAa,EAAE,gBAAY,EAAZ,iCAA2C,CAAC;YAC3D,IAAA,uCAAS,EAAT,8BAAS,CAAgC;;;;YAI/C,IAAI,QAAQ,KAAK,CAAC,IAAI,KAAK,KAAK,CAAC,EAAE;gBACjC,KAAK,GAAG,IAAI,CAAC,MAAM,CAAC;aACrB;YACD,OAAO,EAAE,IAAI,MAAA,EAAE,SAAS,WAAA,EAAE,QAAQ,UAAA,EAAE,KAAK,OAAA,EAAE,UAAU,EAAE,QAAQ,KAAK,CAAC,EAAE,CAAC;SACzE;;;;QAIO,8DAAc,GAAtB;YACE,IAAM,IAAI,GAAG,IAAI,CAAC,IAAI,CAAC,IAAI,IAAI,EAAE,CAAC;YAE5B,IAAA,qEAAkG,EAAhG,iBAAa,EAAb,kCAAa,EAAE,gBAAY,EAAZ,iCAAiF,CAAC;YACzG,IAAI,KAAK,GAAG,IAAI,CAAC,IAAI,CAAC,KAAK,IAAI,CAAC,CAAC;YAIjC,IAAI,QAAQ,KAAK,CAAC,IAAI,KAAK,KAAK,CAAC,EAAE;gBACjC,KAAK,GAAG,IAAI,CAAC,MAAM,CAAC;aACrB;YACD,OAAO,EAAE,IAAI,MAAA,EAAE,SAAS,WAAA,EAAE,QAAQ,UAAA,EAAE,KAAK,OAAA,EAAE,UAAU,EAAE,IAAI,CAAC,IAAI,CAAC,UAAU,EAAE,CAAC;SAC/E;;;;;QAKS,mEAAmB,GAA7B,UAA8B,MAAc;YAC1C,IAAI,CAAC,gBAAgB,CAAC,MAAM,CAAC,CAAC;YAC9B,IAAI,CAAC,iBAAiB,CAAC,MAAM,CAAC,CAAC;;;;YAI/B,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC;;YAEzB,IAAI,CAAC,iBAAiB,CAAC,MAAM,CAAC,CAAC;YAC/B,IAAI,CAAC,UAAU,CAAC,MAAM,CAAC,CAAC;SACzB;;;;QAIO,gEAAgB,GAAxB,UAAyB,MAAc;;YACrC,IAAI,MAAM,IAAI,MAAM,CAAC,IAAI,KAAKA,iBAAU,CAAC,YAAY,EAAE;;gBAErD,IAAM,KAAK,GAAG,MAAM,CAAC,IAAI,CAAC;gBAC1B,IAAI;oBACF,IAAM,UAAU,GAAG8B,qBAAc,CAAC,wCAAwC,CAAC,KAAK,EAAE,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC,UAAU,CAAC,cAAc,CAAC,CAAC;oBACzI,IAAI,IAAI,CAAC,SAAS,CAAC,WAAW,KAAK,GAAG,GAAG,UAAU,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE;wBAC7D,IAAM,aAAa,GAAG,KAAK,CAAC,KAAK,CAAC,UAAU,CAAC,MAAM,CAAC,CAAC;wBACrD,IAAI,MAAM,CAAC,EAAE,IAAI,IAAI,CAAC,IAAI,IAAI,MAAM,CAAC,IAAI,IAAI,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC,UAAU,CAAC,OAAO,KAAKF,cAAO,CAAC,SAAS,IAAI,aAAa,IAAI,aAAa,CAAC,MAAM,GAAG,CAAC,EAAE;4BAC9J,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,EAAE,YAAI,GAAC,aAAa,CAAC,IAAI,CAAC,GAAG,CAAC,IAAG,MAAM,CAAC,KAAK,MAAG,CAAC;yBAC7E;qBACF;iBACF;gBAAC,OAAO,KAAK,EAAE;oBACd,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;iBACrB;gBACD,IAAI,CAAC,iBAAiB,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;aACrC;iBAAM,IAAI,MAAM,KAAK,MAAM,CAAC,IAAI,KAAK5B,iBAAU,CAAC,gBAAgB,IAAI,MAAM,CAAC,IAAI,KAAKA,iBAAU,CAAC,sBAAsB,CAAC,EAAE;gBACvH,IAAI,IAAI,CAAC,WAAW,CAAC,SAAS,MAAM,IAAI,CAAC,IAAI,CAAC,WAAW,IAAI,IAAI,CAAC,IAAI,CAAC,WAAW,CAAC,EAAE,CAAC,IAAI,IAAI,CAAC,IAAI,CAAC,KAAK,GAAG,CAAC,EAAE,CAC9G;qBAAM;oBACL,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC;iBACvB;aACF;iBAAM;gBACL,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC;aACvB;SACF;;;;;;;QAOO,2DAAW,GAAnB,UAAoB,MAAc;YAChC,IAAM,SAAS,GAAG,IAAI,CAAC,IAAI,CAAC,SAAS,EAAE,CAAC;YACxC,IAAI,MAAM,CAAC,IAAI,KAAKA,iBAAU,CAAC,IAAI,IAAI,SAAS,EAAE;gBAChD,IAAI,CAAC,IAAI,CAAC,WAAW,EAAE,CAAC;aACzB;SACF;;;;;QAKO,iEAAiB,GAAzB,UAA0B,MAAe;YACvC,IAAI,CAAC,IAAI,CAAC,WAAW,IAAI,CAAC,IAAI,CAAC,WAAW,CAAC,SAAS,EAAE;gBACpD,OAAO;aACR;;YAED,IAAI,MAAM,IAAI,MAAM,CAAC,IAAI,KAAKA,iBAAU,CAAC,oBAAoB,EAAE;gBAC7D,OAAO;aACR;YACD,IAAI,IAAI,CAAC,SAAS,IAAI,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC,WAAW,CAAC,uBAAuB,KAAK,IAAI,EAAE;gBAC9F,OAAO;aACR;YACO,IAAA,qCAA4B,EAA5B,6CAA4B,CAAiC;YACrE,IAAM,SAAS,GAAG,IAAI,CAAC,WAAW,CAAC,SAAS,CAAC;;YAE7C,IAAI,iBAAiB,KAAK,SAAS,EAAE;gBACnC,IAAM,OAAO,GAAG,MAAM,KAAK,MAAM,CAAC,IAAI,CAAC,QAAQ,EAAE,KAAK,IAAI,CAAC,SAAS,CAAC,WAAW,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,GAAA,CAAC,CAAC,QAAQ,EAAE,CAAC,CAAC;gBACvH,IAAI,MAAM,IAAI,MAAM,CAAC,IAAI,KAAKA,iBAAU,CAAC,IAAI,IAAI,OAAO,EAAE;oBACxD,IAAI,CAAC,IAAI,CAAC,eAAe,EAAE,CAAC;oBAC5B,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,SAAS,EAAE,IAAI,EAAE,IAAI,CAAC,CAAC;iBAC5C;gBACD,OAAO;aACR;YACD,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,WAAW,CAAC,SAAS,CAAC,CAAC;SAChD;;;;QAIO,8EAA8B,GAAtC;YAAA,iBASC;YARC,IAAI,CAAC,sBAAsB,GAAG,IAAI,CAAC,WAAW,CAAC,OAAO,CAAC,SAAS,CAAC,UAAC,MAAc;gBAC9E,KAAI,CAAC,mBAAmB,CAAC,MAAM,CAAC,CAAC;aAClC,CAAC,CAAC;YACH,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC,UAAU,CAAC,WAAW,CAAC,SAAS,CAAC,UAAA,OAAO;gBAClE,IAAI,OAAO,KAAK,UAAU,EAAE;oBAC1B,KAAI,CAAC,QAAQ,EAAE,CAAC;iBACjB;aACF,CAAC,CAAC;SACJ;;;;QAIO,gFAAgC,GAAxC;YACE,IAAI,IAAI,CAAC,sBAAsB,IAAI,QAAQ,IAAI,CAAC,sBAAsB,CAAC,WAAW,CAAC,KAAK,UAAU,EAAE;gBAClG,IAAI,CAAC,sBAAsB,CAAC,WAAW,EAAE,CAAC;aAC3C;SACF;;;;;;QAMO,0DAAU,GAAlB,UAAmB,MAAe;YAAlC,iBA8CC;YA7CC,IAAI,EAAE,MAAM,KAAK,MAAM,CAAC,IAAI,KAAKA,iBAAU,CAAC,gBAAgB,IAAI,MAAM,CAAC,IAAI,KAAKA,iBAAU,CAAC,IAAI,CAAC,CAAC,EAAE;gBACjG,OAAO;aACR;YACD,IAAM,WAAW,GAAG,IAAI,CAAC,SAAS,CAAC,WAAW,CAAC;YAC/C,IAAM,gBAAgB,GAAG,GAAG,GAAG,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;YACrD,IAAM,UAAU,GAAG,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC,UAAU,CAAC,MAAM,CAAC,GAAG,CAAC,aAAa,CAAC,IAAI,KAAK,CAAC;YAC7F,IAAI,MAAM,CAAC,IAAI,CAAC,MAAM,GAAG,CAAC,IAAI,WAAW,KAAK,GAAG,IAAI,WAAW,KAAK,gBAAgB,IAAI,CAAC,WAAW,CAAC,UAAU,CAAC,gBAAgB,CAAC,EAAE;gBAClI,OAAO;aACR;;YAED,IAAI,UAAU,EAAE;gBACd,OAAO;aACR;YACD,IAAM,SAAS,GAAG+B,0BAAmB,CAAC,iBAAiB,CAAC,IAAI,CAAC,SAAS,CAAC,WAAW,EAAE,IAAI,CAAC,WAAW,CAAC,CAAC;YACtG,IAAM,KAAK,GAAG,SAAS,CAAC,KAAK,CAAC,CAAC,EAAE,SAAS,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;YACvD,IAAM,MAAM,GAAG,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC;YACvC,IAAM,QAAQ,GAAG,MAAM,IAAI,MAAM,CAAC,MAAM,CAAC,UAAU,CAAC,CAAC;;YAErD,IAAI,CAAC,QAAQ,EAAE;gBACb,OAAO;aACR;;YAED,IAAM,YAAY,GAAG,IAAI,CAAC,SAAS,CAAC,WAAW,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAA,IAAI,IAAI,OAAA,IAAI,GAAA,CAAC,CAAC;YAChF,IAAI,QAAQ,GAAG,YAAY,CAAC,YAAY,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;YACrD,QAAQ,GAAG,QAAQ,CAAC,MAAM,CAAC,CAAC,EAAE,QAAQ,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;;YAEnD,IAAM,UAAU,GAAG,MAAI,QAAU,CAAC;YAC5B,IAAA,oHAAa,EAAb,kCAAa,CAAyG;YACpH,IAAA,mHAAY,EAAZ,iCAAY,CAAyG;YAE7H,IAAM,cAAc,GAAG,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;YAC3D,IAAM,gBAAgB,GAAG,GAAG,GAAG,cAAc,CAAC,SAAS,CAAC,CAAC,EAAE,cAAc,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;YAC9E,IAAA,yHAA4B,EAA5B,uCAA4B,CAA+G;YACnJ,IAAM,YAAY,GAAG,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC,UAAU,CAAC,MAAM,CAAC,GAAG,CAAC,YAAY,CAAC,IAAI,KAAK,CAAC;YAC9F,IAAI,YAAY,EAAE;;gBAEhB,SAAS,GAAG,CAAC,CAAC;aACf;;YAED,IAAI,cAAc,GAAG,QAAQ,KAAK,CAAC,EAAE;gBACnC,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC,UAAU,CAAC,MAAM,CAAC,GAAG,CAAC,iBAAiB,EAAE,IAAI,CAAC,CAAC;gBAC3E,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC,UAAU,CAAC,UAAU,CAAC,KAAK,EAAE,SAAS,EAAE,QAAQ,CAAC,CAAC,IAAI,CAChFC,kBAAQ,CAAC,cAAM,OAAA,KAAI,CAAC,SAAS,CAAC,YAAY,CAAC,UAAU,CAAC,MAAM,CAAC,MAAM,CAAC,iBAAiB,CAAC,GAAA,CAAC,CACxF,CAAC,SAAS,EAAE,CAAC;aACf;SACF;QACD,2DAAW,GAAX;YACE,IAAI,CAAC,gCAAgC,EAAE,CAAC;SACzC;;;;;;;QASS,qEAAqB,GAA/B,UAAgC,kBAAuB;YACrD,IAAI,CAAC,iBAAiB,CAAC,IAAI,CAAC,kBAAkB,CAAC,CAAC;SACjD;;;;;QAKO,gEAAgB,GAAxB,UAAyB,MAAc;YACrC,IAAI,MAAM,CAAC,IAAI,KAAKhC,iBAAU,CAAC,IAAI,IAAI,IAAI,CAAC,IAAI,CAAC,WAAW,EAAE;gBAC5D,IAAM,OAAO,GAAG,IAAI,CAAC,6BAA6B,CAAC,MAAM,CAAC,CAAC;gBAC3D,IAAI,OAAO,EAAE;oBACX,IAAI,CAAC,SAAS,CAAC,EAAE,CAAC,CAAC;oBACnB,IAAI,QAAQ,IAAI,CAAC,IAAI,CAAC,aAAa,CAAC,KAAK,UAAU,EAAE;wBACnD,IAAI,CAAC,IAAI,CAAC,aAAa,EAAE,CAAC;qBAC3B;iBACF;aACF;SACF;;;;;;;QAYS,2EAA2B,GAArC,UAAsC,EAAU;;YAE9C,IAAI,CAAC,EAAE,EAAE;gBACP,IAAI,CAAC,WAAW,CAAC,SAAS,GAAG,EAAE,CAAC;gBAChC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,WAAW,EAAE;oBAC1B,IAAI,CAAC,SAAS,CAAC,EAAE,CAAC,CAAC;iBACpB;gBACD,OAAO;aACR;YACD,IAAI,IAAI,CAAC,WAAW,CAAC,SAAS,KAAK,EAAE,EAAE;gBACrC,IAAI,CAAC,WAAW,CAAC,YAAY,CAAC,EAAE,EAAE,IAAI,CAAC,CAAC;aACzC;;YAED,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,WAAW,EAAE;gBAC1B,IAAI,CAAC,SAAS,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;aACtB;SACF;QACO,iEAAiB,GAAzB,UAA0B,OAAe;YACvC,IAAI,OAAO,CAAC,IAAI,KAAKA,iBAAU,CAAC,IAAI,EAAE;gBACpC,IAAI,CAAC,cAAc,EAAE,CAAC;aACvB;iBAAM,IAAI,OAAO,CAAC,IAAI,KAAKA,iBAAU,CAAC,YAAY,EAAE;gBACnD,IAAM,GAAG,GAAG,IAAI,CAAC,SAAS,EAAE,CAAC;gBAC7B,IAAI,OAAO,CAAC,EAAE,IAAI,GAAG,CAAC,QAAQ,CAAC,OAAO,CAAC,EAAE,CAAC,EAAE;oBAC1C,IAAI,CAAC,cAAc,EAAE,CAAC;iBACvB;aACF;SACF;;;;QAIS,yDAAS,GAAnB,UAAoB,GAAa;YAC/B,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,gBAAgB,CAAC,KAAK,EAAE,GAAG,CAAC,CAAC;YACpD,IAAI,CAAC,cAAc,CAAC,GAAG,CAAC,CAAC;SAC1B;;;;;QAKS,yDAAS,GAAnB;YACE,OAAO,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,KAAK,CAAC,IAAI,EAAE,CAAC;SAC5C;;;;QAIS,8DAAc,GAAxB,UAAyB,GAAc;YAAvC,iBAiCC;;;;;YA5BC,IAAI,OAAO,GAAG,KAAK,WAAW,EAAE;gBAC9B,GAAG,GAAG,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,KAAK,CAAC,IAAI,EAAE,CAAC;aAC3C;YACD,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,GAAG,CAAC,IAAI,GAAG,CAAC,MAAM,GAAG,CAAC,EAAE;;gBAEzC,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,gBAAgB,CAAC,MAAM,EAAE,IAAI,CAAC,CAAC;gBACtD,OAAO;aACR;YACD,IAAI,IAAI,GAAG,EAAE,CAAC;;YAEd,IAAI,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC,UAAU,CAAC,OAAO,KAAK4B,cAAO,CAAC,SAAS,EAAE;gBACxE,IAAI,GAAG,IAAI,CAAC,IAAI,CAAC,IAAI,IAAI,EAAE,CAAC;aAC7B;iBAAM;gBACL,IAAI,GAAG,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC,EAAE,oBAAoB,EAAE,IAAI,EAAE,CAAC,CAAC;aAChE;YACD,IAAM,IAAI,GAAqB,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,MAAM,CAAC,IAAI,IAAI,GAAG,EAAe,CAAC;YAExF,IAAM,MAAM,GAAG,IAAI,GAAG,EAAe,CAAC;YACtC,GAAG,CAAC,OAAO,CAAC,UAAC,EAAO;gBAClB,IAAM,IAAI,GAAG,IAAI,CAAC,IAAI,CAAC,UAAA,IAAI,IAAI,OAAA,IAAI,CAAC,KAAI,CAAC,UAAU,CAAC,KAAK,EAAE,GAAA,CAAC,CAAC;gBAC7D,IAAM,aAAa,GAAG,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC;gBACnC,IAAI,IAAI,EAAE;oBACR,MAAM,CAAC,GAAG,CAAC,EAAE,EAAE,IAAI,CAAC,CAAC;iBACtB;qBAAM,IAAI,aAAa,EAAE;oBACxB,MAAM,CAAC,GAAG,CAAC,EAAE,EAAE,aAAa,CAAC,CAAC;iBAC/B;aACF,CAAC,CAAC;YACH,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,gBAAgB,CAAC,MAAM,EAAE,MAAM,CAAC,CAAC;SACzD;;;;;QAKS,6DAAa,GAAvB,UAAwB,EAAO;YAC7B,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,EAAE,CAAC,CAAC;YACxB,IAAI,CAAC,IAAI,CAAC,kBAAkB,EAAE,CAAC;SAChC;;;;;;;QASM,kEAAkB,GADzB,UAC0B,KAAU;YAC5B,IAAA,2BAAS,EAAE,yBAAQ,CAAW;YACpC,IAAI,SAAS,GAAG,CAAC,EAAE;gBACjB,SAAS,GAAG,CAAC,CAAC;aACf;YACD,IAAM,IAAI,GAAG,CAAC,SAAS,GAAG,CAAC,IAAI,QAAQ,CAAC;YACxC,IAAI,CAAC,WAAW,CAAC,aAAa,CAAC,IAAI,EAAE,QAAQ,EAAE,IAAI,CAAC,WAAW,CAAC,WAAW,CAAC,CAAC;SAC9E;;;;;QAOM,kEAAkB,GADzB,UAC0B,KAAU;YAC1B,IAAA,mBAAK,EAAE,iBAAI,CAAW;YAC9B,IAAM,EAAE,GAAG,IAAI,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;YACjC,IAAI,CAAC,2BAA2B,CAAC,EAAE,CAAC,CAAC;YACrC,IAAI,CAAC,qBAAqB,CAAC,KAAK,CAAC,CAAC;SACnC;;;;;QAOM,0DAAU,GADjB,UACkB,KAAU;YAC1B,IAAI,CAAC,KAAK,EAAE;gBACV,OAAO;aACR;YACO,IAAA,eAAS,EAAT,8BAAS,CAAW;YAC5B,IAAM,EAAE,GAAG,IAAI,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;YACjC,IAAM,SAAS,GAAG,IAAI,CAAC,WAAW,CAAC,SAAS,CAAC;YAC7C,IAAI,EAAE,KAAK,SAAS,EAAE;gBACpB,IAAI,CAAC,2BAA2B,CAAC,IAAI,CAAC,CAAC;aACxC;;SAEF;;;;;QAMM,8DAAc,GADrB,UACsB,KAAU;YAC9B,KAAK,GAAG,KAAK,IAAI,EAAE,CAAC;YACpB,IAAM,GAAG,GAAG,KAAK,CAAC,GAAG,CAAC,UAAA,IAAI,IAAI,OAAA,IAAI,CAAC,EAAE,GAAA,CAAC,CAAC;YACvC,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,CAAC;SACrB;;;;;QAMM,+DAAe,GADtB,UACuB,KAAU;YACvB,IAAA,2BAAS,EAAE,yBAAQ,CAAW;YACtC,IAAM,IAAI,GAAG,CAAC,CAAC;;YAEf,IAAI,CAAC,WAAW,CAAC,aAAa,CAAC,IAAI,EAAE,QAAQ,EAAE,IAAI,CAAC,WAAW,CAAC,WAAW,CAAC,CAAC;SAC9E;;;;;QAOM,uDAAO,GADd,UACe,KAAU;YACf,IAAA,uBAAgB,EAAE,yBAAQ,CAAW;YAC7C,IAAM,IAAI,GAAG,CAAC,SAAS,GAAG,CAAC,IAAI,QAAQ,CAAC;YACxC,IAAI,CAAC,WAAW,CAAC,aAAa,CAAC,IAAI,EAAE,QAAQ,EAAE,IAAI,CAAC,WAAW,CAAC,WAAW,CAAC,CAAC;SAC9E;QAEM,6DAAa,GADpB,UACqB,KAAU;YAC7B,IAAI,CAAC,OAAO,GAAG,KAAK,CAAC;SACtB;;QAEO,6EAA6B,GAArC,UAAsC,MAAc;YAClD,IAAI,OAAO,GAAG,KAAK,CAAC;YACpB,IAAI,CAAC,MAAM,IAAI,CAAC,MAAM,CAAC,IAAI,EAAE;gBAC3B,OAAO,OAAO,CAAC;aAChB;YAED,IAAM,eAAe,GAAG,MAAM,CAAC,IAAI,CAAC;YACpC,IAAI,CAAC,eAAe,EAAE;gBACpB,OAAO,OAAO,CAAC;aAChB;YAED,IAAI,EAAE,IAAI,CAAC,WAAW,CAAC,IAAI,EAAE,IAAI,CAAC,WAAW,CAAC,WAAW,CAAC,EAAE;gBAC1D,OAAO,OAAO,CAAC;aAChB;YACD,IAAM,iBAAiB,GAAG,IAAI,CAAC,WAAW,CAAC,WAAW,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;YAClE,IAAI,iBAAiB,CAAC,MAAM,IAAI,CAAC,EAAE;gBACjC,OAAO,OAAO,CAAC;aAChB;YAED,IAAI,eAAe,CAAC,MAAM,KAAK,CAAC,EAAE;gBAChC,IAAI,IAAI,CAAC,WAAW,CAAC,WAAW,KAAK,GAAG,EAAE;oBACxC,OAAO,GAAG,IAAI,CAAC;iBAChB;aACF;iBAAM,IAAI,MAAM,CAAC,IAAI,CAAC,MAAM,KAAK,CAAC,EAAE;gBACnC,IAAI,iBAAiB,CAAC,MAAM,KAAK,CAAC,IAAI,iBAAiB,CAAC,CAAC,CAAC,KAAK,MAAM,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE;oBAC7E,OAAO,GAAG,IAAI,CAAC;iBAChB;aACF;iBAAM,IAAI,MAAM,CAAC,IAAI,CAAC,MAAM,KAAK,CAAC,EAAE;gBACnC,IAAI,iBAAiB,CAAC,MAAM,KAAK,CAAC,IAAI,iBAAiB,CAAC,CAAC,CAAC,KAAK,MAAM,CAAC,IAAI,CAAC,CAAC,CAAC,IAAI,iBAAiB,CAAC,CAAC,CAAC,KAAK,MAAM,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE;oBACxH,OAAO,GAAG,IAAI,CAAC;iBAChB;aACF;YAED,OAAO,OAAO,CAAC;SAChB;QACO,wDAAQ,GAAhB,UAAiB,QAA0B,EAAE,IAAI;YAC/C,IAAI,SAAS,GAAG,IAAI,CAAC;YACrB,OAAO;gBAAC,cAAO;qBAAP,UAAO,EAAP,qBAAO,EAAP,IAAO;oBAAP,yBAAO;;gBACb,MAAM,CAAC,YAAY,CAAC,SAAS,CAAC,CAAC;gBAC/B,SAAS,GAAG,MAAM,CAAC,UAAU,CAAC;oBAC5B,QAAQ,CAAC,KAAK,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;iBAC5B,EAAE,IAAI,CAAC,CAAC;aACV,CAAC;SACH;;oBA70BFxC,cAAS,SAAC;wBACT,QAAQ,EAAE,2BAA2B;qBACtC;;;;;wBAVQS,kBAAW;wBAAmCH,gBAAS;wBACvDuC,4BAAiB;;;;wCAuCvBvB,WAAM;yCAsrBNlB,iBAAY,SAAC,aAAa,EAAE,CAAC,QAAQ,CAAC;yCActCA,iBAAY,SAAC,eAAe,EAAE,CAAC,QAAQ,CAAC;iCAYxCA,iBAAY,SAAC,UAAU,EAAE,CAAC,QAAQ,CAAC;qCAiBnCA,iBAAY,SAAC,eAAe,EAAE,CAAC,QAAQ,CAAC;sCAUxCA,iBAAY,SAAC,iBAAiB,EAAE,CAAC,QAAQ,CAAC;8BAY1CA,iBAAY,SAAC,aAAa,EAAE,CAAC,QAAQ,CAAC;oCAMtCA,iBAAY,SAAC,eAAe,EAAE,CAAC,QAAQ,CAAC;;QAiD3C,4CAAC;KA90BD;;;QCOE,yCACsB,EAAa,EACG,oBAA0C;YAFhF,mBAOC;YANqB,OAAE,GAAF,EAAE,CAAW;YACG,yBAAoB,GAApB,oBAAoB,CAAsB;YALtE,sBAAiB,GAAG,IAAIM,iBAAY,EAAU,CAAC;YAOvD,IAAI,CAAC,EAAE,CAAC,OAAO,CAAC,OAAO,CAAC,SAAS,CAAC,UAAA,IAAI;gBACpC,OAAI,CAAC,UAAU,GAAG,IAAI,CAAC,KAAK,CAAC;aAC9B,CAAC,CAAA;SACH;QACD,kDAAQ,GAAR;YAAA,mBA0BC;YAzBC,IAAI,CAAC,oBAAoB,CAAC,UAAU,GAAG,EAAE,CAAC;YAC1C,IAAI,KAAK,CAAC,OAAO,CAAC,IAAI,CAAC,UAAU,CAAC,EAAE;gBAClC,IAAI,CAAC,oBAAoB,CAAC,UAAU,GAAG,IAAI,CAAC,UAAU,CAAC;gBACvD,IAAI,CAAC,kBAAkB,GAAG,IAAI,CAAC,UAAU,CAAC;aAC3C;iBAAM,IAAI,IAAI,CAAC,UAAU,IAAI,IAAI,CAAC,UAAU,CAAC,OAAO,EAAE;gBACrD,IAAI,CAAC,UAAU,CAAC,OAAO,CAAC,SAAS,CAAC,UAAC,IAAS;oBAC1C,IAAI,IAAI,CAAC,IAAI,KAAK,MAAM,EAAE;wBACxB,OAAI,CAAC,kBAAkB,GAAG,IAAI,CAAC,KAAK,CAAC;wBACrC,IAAI,OAAI,CAAC,oBAAoB,CAAC,MAAM,EAAE,EAAE;4BACtC,IAAI,OAAI,CAAC,QAAQ,EAAE;;gCAEjB,OAAI,CAAC,oBAAoB,CAAC,UAAU,GAAG,OAAI,CAAC,WAAW,CAAC,IAAI,CAAC,KAAK,EAAE,OAAI,CAAC,QAAQ,EAAE,CAAC,CAAC,CAAC;6BACvF;iCAAM,IAAI,OAAI,CAAC,QAAQ,EAAE;;gCAExB,OAAI,CAAC,oBAAoB,CAAC,UAAU,GAAG,OAAI,CAAC,mBAAmB,CAAC,IAAI,CAAC,KAAK,EAAE,OAAI,CAAC,QAAQ,CAAC,CAAC;6BAC5F;4BACD,OAAI,CAAC,oBAAoB,CAAC,UAAU,GAAG,OAAI,CAAC,qBAAqB,CAAC,OAAI,CAAC,UAAU,EAAE,OAAI,CAAC,kBAAkB,CAAC,CAAC;yBAC7G;6BAAM;4BACL,OAAI,CAAC,oBAAoB,CAAC,UAAU,GAAG,IAAI,CAAC,KAAK,CAAC;4BAClD,OAAI,CAAC,oBAAoB,CAAC,UAAU,GAAG,OAAI,CAAC,qBAAqB,CAAC,OAAI,CAAC,UAAU,EAAE,OAAI,CAAC,oBAAoB,CAAC,UAAU,CAAC,CAAC;yBAC1H;qBACF;iBACF,CAAC,CAAA;aACH;YACD,IAAI,CAAC,6BAA6B,EAAE,CAAC;SACtC;QAEO,uEAA6B,GAArC;YAAA,mBAMC;YALC,IAAI,IAAI,CAAC,oBAAoB,IAAI,IAAI,CAAC,oBAAoB,CAAC,gBAAgB,EAAE;gBAC3E,IAAI,CAAC,oBAAoB,CAAC,gBAAgB,CAAC,SAAS,CAAC,UAAA,IAAI;oBACvD,OAAI,CAAC,iBAAiB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;iBACnC,CAAC,CAAA;aACH;SACF;;;;;QAKO,0DAAgB,GAAxB,UAAyB,IAAW,EAAE,KAAa;YAAnD,mBAgBC;YAfC,IAAI,CAAC,IAAI,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE;gBACzB,OAAO,EAAE,CAAC;aACX;YACD,OAAO,IAAI,CAAC,GAAG,CAAC,UAAA,IAAI;;gBAClB,IAAM,CAAC,GAAG,IAAI,CAAC,QAAQ,CAAC,GAAG,IAAI,CAAC,MAAM,EAAE,GAAG,IAAI,CAAC;gBAChD,OAAO;oBACL,IAAI,EAAE,MAAM,CAAC,MAAM,cAAM,CAAC;wBACxB,GAAC,KAAG,OAAI,CAAC,OAAS,IAAG,IAAI,CAAC,OAAI,CAAC,OAAO,CAAC;wBACvC,GAAC,KAAG,OAAI,CAAC,SAAW,IAAG,IAAI,CAAC,OAAI,CAAC,SAAS,CAAC;wBAC3C,GAAC,KAAG,OAAI,CAAC,UAAY,IAAG,IAAI,CAAC,OAAI,CAAC,UAAU,CAAC;wBAC7C,GAAC,KAAG,KAAO,IAAG,IAAI,CAAC,KAAK,CAAC;4BACzB;oBACF,QAAQ,EAAE,EAAE;iBACb,CAAA;aACF,CAAC,CAAC;SACJ;;;;;;;QAOO,qDAAW,GAAnB,UAAoB,WAAkB,EAAE,KAAa,EAAE,KAAa;YAClE,IAAM,UAAU,GAAG,IAAI,CAAC,gBAAgB,CAAC,WAAW,EAAE,KAAK,CAAC,CAAC;YAC7D,IAAI,CAAC,UAAU,CAAC,MAAM,EAAE;gBACtB,OAAO,EAAE,CAAC;aACX;YACD,IAAI,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC,CAAC,KAAK,CAAC,EAAE;gBACjC,OAAO,EAAE,CAAC;aACX;YACD,IAAM,OAAO,GAAG,UAAU,CAAC,MAAM,CAAC,UAAA,IAAI;gBACpC,OAAO,IAAI,CAAC,MAAM,CAAC,CAAC,KAAK,CAAC,CAAC,OAAO,CAAC,KAAK,KAAK,CAAC;aAC/C,CAAC,CAAA;YACF,IAAI,CAAC,SAAS,CAAC,OAAO,EAAE,UAAU,EAAE,KAAK,EAAE,CAAC,CAAC,CAAC;YAC9C,OAAO,OAAO,CAAC;SAChB;;;;;;;;QASO,mDAAS,GAAjB,UAAkB,OAAc,EAAE,UAAiB,EAAE,KAAa,EAAE,KAAa;YAAjF,mBAuBC;YAtBC,OAAO,CAAC,OAAO,CAAC,UAAA,MAAM;gBACpB,IAAM,UAAU,GAAG,MAAM,CAAC,MAAM,CAAC,CAAC,KAAK,CAAC,CAAC,MAAM,CAAC,CAAC;gBACjD,IAAM,WAAW,GAAG,MAAM,CAAC,MAAM,CAAC,CAAC,KAAK,CAAC,CAAC,OAAO,CAAC,CAAC;gBACnD,IAAI,MAAM,CAAC,MAAM,CAAC,CAAC,KAAK,CAAC,CAAC,UAAU,CAAC,KAAK,KAAK,EAAE;oBAC/C,UAAU,CAAC,OAAO,CAAC,UAAA,IAAI;wBACrB,IAAI,IAAI,IAAI,IAAI,CAAC,MAAM,CAAC,IAAI,IAAI,CAAC,MAAM,CAAC,CAAC,KAAK,CAAC,IAAI,IAAI,CAAC,MAAM,CAAC,CAAC,KAAK,CAAC,CAAC,MAAM,CAAC,EAAE;4BAC9E,IAAM,QAAQ,GAAG,IAAI,CAAC,MAAM,CAAC,CAAC,KAAK,CAAC,CAAC,MAAM,CAAC,CAAC;4BAC7C,IAAM,SAAS,GAAG,IAAI,CAAC,MAAM,CAAC,CAAC,KAAK,CAAC,CAAC,OAAO,CAAC,CAAC;4BAC/C,IAAI,UAAU,SAAQ,CAAC;4BACvB,IAAI,QAAQ,IAAI,QAAQ,CAAC,MAAM,GAAG,UAAU,CAAC,MAAM,EAAE;gCACnD,UAAU,GAAG,QAAQ,CAAC,MAAM,CAAC,CAAC,EAAE,MAAM,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC;6BACpD;4BACD,IAAI,UAAU,KAAK,UAAU,IAAI,WAAW,KAAK,SAAS,GAAG,CAAC,EAAE;gCAC9D,MAAM,CAAC,UAAU,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;6BAC/B;4BACD,IAAI,IAAI,CAAC,MAAM,CAAC,CAAC,KAAK,CAAC,CAAC,UAAU,CAAC,KAAK,KAAK,IAAI,UAAU,KAAK,UAAU,EAAE;gCAC1E,OAAI,CAAC,SAAS,CAAC,CAAC,IAAI,CAAC,EAAE,UAAU,EAAE,KAAK,EAAE,MAAM,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC;6BAC9D;yBACF;qBACF,CAAC,CAAC;iBACJ;aACF,CAAC,CAAA;SACH;;;;;;QAMO,+DAAqB,GAA7B,UAA8B,GAAQ,EAAE,UAAe;YACrD,IAAI,MAAM,GAAG,EAAE,CAAC;YAChB,IAAM,KAAK,GAAG,IAAI,CAAC;YACnB,IAAI,CAAC,OAAO,GAAG,KAAK,QAAQ,IAAI,CAAC,CAAC,GAAG,KAAK,OAAO,GAAG,KAAK,QAAQ,EAAE;gBACjE,IAAM,SAAS,GAAG,UAAU,CAAC,IAAI,CAAC,UAAA,IAAI;oBACpC,OAAO,IAAI,IAAI,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,KAAK,GAAG,CAAC;iBAC5C,CAAC,CAAC;gBACH,IAAI,SAAS,EAAE;oBACb,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;iBACxB;aACF;iBAAM,IAAI,KAAK,CAAC,OAAO,CAAC,GAAG,CAAC,EAAE;gBAC7B,IAAI,UAAU,EAAE;oBACd,GAAG,CAAC,OAAO,CAAC,UAAA,EAAE;wBACZ,IAAM,IAAI,GAAG,UAAU,CAAC,IAAI,CAAC,UAAA,IAAI,IAAI,OAAA,IAAI,IAAI,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,KAAK,EAAE,GAAA,CAAC,CAAC;wBACzE,IAAI,IAAI,EAAE;4BACR,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;yBACnB;qBACF,CAAC,CAAC;;;;;;;;iBAQJ;qBAAM;oBACL,MAAM,GAAG,EAAE,CAAC;iBACb;aACF;iBAAM;gBACL,MAAM,GAAG,EAAE,CAAC;aACb;YACD,OAAO,MAAM,CAAC;SACf;;;;;;QAOO,+DAAqB,GAA7B,UAA8B,GAAQ,EAAE,UAAe;YACrD,IAAI,MAAM,GAAG,EAAE,CAAC;YAChB,IAAM,KAAK,GAAG,IAAI,CAAC;YACnB,IAAI,CAAC,OAAO,GAAG,KAAK,QAAQ,IAAI,CAAC,CAAC,GAAG,KAAK,OAAO,GAAG,KAAK,QAAQ,EAAE;gBACjE,IAAM,SAAS,GAAG,UAAU,CAAC,IAAI,CAAC,UAAA,IAAI;oBACpC,OAAO,IAAI,IAAI,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,KAAK,GAAG,CAAC;iBAC5C,CAAC,CAAC;gBACH,IAAI,SAAS,EAAE;oBACb,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;iBACxB;aACF;iBAAM,IAAI,KAAK,CAAC,OAAO,CAAC,GAAG,CAAC,EAAE;gBAC7B,IAAI,UAAU,EAAE;oBACd,GAAG,CAAC,OAAO,CAAC,UAAA,EAAE;wBACZ,IAAM,IAAI,GAAG,UAAU,CAAC,IAAI,CAAC,UAAA,IAAI,IAAI,OAAA,IAAI,IAAI,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,KAAK,EAAE,GAAA,CAAC,CAAC;wBACzE,IAAI,IAAI,EAAE;4BACR,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;yBACnB;qBACF,CAAC,CAAC;;;;;;;;iBAQJ;qBAAM;oBACL,MAAM,GAAG,EAAE,CAAC;iBACb;aACF;iBAAM;gBACL,MAAM,GAAG,EAAE,CAAC;aACb;YACD,OAAO,MAAM,CAAC;SACf;;;;;QAQO,6DAAmB,GAA3B,UAA4B,cAA+B,EAAE,KAAa;YAA1E,mBASC;YARC,IAAM,QAAQ,GAAG,IAAI,CAAC,gBAAgB,CAAC,cAAc,EAAE,KAAK,CAAC,CAAC;YAC9D,QAAQ,CAAC,OAAO,CAAC,UAAC,IAAS;gBACzB,IAAM,MAAM,GAAG,QAAQ,CAAC,IAAI,CAAC,UAAC,GAAQ,IAAK,OAAA,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,aAAa,KAAK,GAAG,CAAC,IAAI,CAAC,OAAI,CAAC,OAAO,CAAC,GAAA,CAAC,CAAC;gBACtG,IAAI,MAAM,EAAE;oBACV,MAAM,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;iBAC5B;aACF,CAAC,CAAC;YACH,OAAO,QAAQ,CAAC,MAAM,CAAC,UAAC,GAAQ,IAAK,OAAA,CAAC,GAAG,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,aAAa,GAAA,CAAC,CAAC;SACtE;;oBAjOFV,cAAS,SAAC;wBACT,QAAQ,EAAE,0BAA0B;qBACrC;;;;;wBAJQM,gBAAS,uBAmBbU,aAAQ;wBApBJ8B,kCAAoB,uBAqBxBb,SAAI,YAAIF,SAAI,YAAIf,aAAQ;;;;iCAb1Bb,UAAK;8BACLA,UAAK;gCACLA,UAAK;iCACLA,UAAK;+BACLA,UAAK;+BACLA,UAAK;mCACLA,UAAK;iCACLA,UAAK;wCACLmB,WAAM;;QAqNT,sCAAC;KAlOD;;;QCoBE,wCACU,WAAwB,EACxB,SAAoB,EACpB,QAA2B;YAF3B,gBAAW,GAAX,WAAW,CAAa;YACxB,cAAS,GAAT,SAAS,CAAW;YACpB,aAAQ,GAAR,QAAQ,CAAmB;YAT5B,iBAAY,GAAY,IAAI,CAAC;;;;YAI5B,sBAAiB,GAAsB,IAAIZ,iBAAY,EAAO,CAAC;SAOxE;QAfD,sBAAc,sDAAU;;;;iBAAxB;gBACE,OAAO,IAAI,CAAC,WAAW,CAAC,UAAU,CAAC;aACpC;;;WAAA;QAeD,iDAAQ,GAAR;;YAEE,IAAI,CAAC,QAAQ,EAAE,CAAC;YAChB,IAAI,CAAC,8BAA8B,EAAE,CAAC;SAEvC;QAED,oDAAW,GAAX;YACE,IAAI,CAAC,QAAQ,EAAE,CAAC;SACjB;QAED,oDAAW,GAAX;YACE,IAAI,CAAC,gCAAgC,EAAE,CAAC;SACzC;;;;QAKS,sDAAa,GAAvB;YACE,IAAM,WAAW,GAAG,IAAI,CAAC,SAAS,CAAC,WAAW,CAAC;YAC/C,IAAM,WAAW,GAAG,IAAI,CAAC,SAAS,CAAC,WAAW,CAAC;YAC/C,IAAI,UAAU,GAAG,WAAW,CAAC,UAAU,CAAC;YACxC,IAAI,WAAW,KAAK,GAAG,EAAE;gBACvB,OAAO,UAAU,CAAC;aACnB;iBAAM;gBACL,IAAM,YAAY,GAAG,WAAW,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAA,IAAI,IAAI,OAAA,CAAC,CAAC,IAAI,IAAI,IAAI,CAAC,MAAM,GAAG,CAAC,GAAA,CAAC,CAAC,GAAG,CAAC,UAAA,IAAI;oBACtG,OAAO,IAAI,CAAC,SAAS,CAAC,CAAC,EAAE,IAAI,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;iBAC3C,CAAC,CAAC;gBACH,YAAY,CAAC,OAAO,CAAC,UAAA,IAAI;oBACvB,UAAU,GAAG,UAAU,IAAI,UAAU,CAAC,IAAI,CAAC,CAAC;iBAC7C,CAAC,CAAC;gBACH,OAAO,UAAU,CAAC;aACnB;SACF;;;;QAKO,6DAAoB,GAA5B;YACE,IAAM,IAAI,GAAG,IAAI,CAAC,WAAW,CAAC,MAAM,EAAE,CAAC;YAEjC,IAAA,+BAA4D,EAA1D,iBAAa,EAAb,kCAAa,EAAE,gBAAY,EAAZ,iCAA2C,CAAC;YAC7D,IAAA,uCAAS,EAAT,8BAAS,CAAgC;YAI/C,IAAI,QAAQ,KAAK,CAAC,IAAI,KAAK,KAAK,CAAC,EAAE;gBACjC,KAAK,GAAG,IAAI,CAAC,MAAM,CAAC;aACrB;YACD,IAAI,CAAC,QAAQ,CAAC,aAAa,GAAG,IAAI,CAAC,YAAY,CAAC;YAChD,IAAI,CAAC,QAAQ,CAAC,SAAS,GAAG,SAAS,CAAC;YACpC,IAAI,CAAC,QAAQ,CAAC,QAAQ,GAAG,QAAQ,CAAC;YAClC,IAAI,CAAC,QAAQ,CAAC,KAAK,GAAG,KAAK,CAAC;YAC5B,IAAI,WAAW,GAAG,SAAS,CAAC;YAC5B,IAAM,YAAY,GAAG,QAAQ,CAAC;YAC9B,IAAI,UAAU,GAAG,KAAK,CAAC;YACvB,IAAI,QAAQ,KAAK,CAAC,EAAE;;gBAElB,IAAI,CAAC,QAAQ,CAAC,SAAS,GAAG,SAAS,CAAC;gBACpC,IAAI,CAAC,QAAQ,CAAC,KAAK,GAAG,KAAK,CAAC;gBAC5B,WAAW,GAAG,CAAC,CAAC;gBAChB,UAAU,GAAG,KAAK,CAAC;aACpB;YACD,IAAI,IAAI,CAAC,QAAQ,CAAC,iBAAiB,EAAE;gBACnC,IAAI,CAAC,QAAQ,CAAC,iBAAiB,CAAC,YAAY,GAAG,YAAY,CAAC;gBAC5D,IAAI,CAAC,QAAQ,CAAC,iBAAiB,CAAC,WAAW,GAAG,WAAW,CAAC;gBAC1D,IAAI,CAAC,QAAQ,CAAC,iBAAiB,CAAC,QAAQ,GAAG,IAAI,CAAC,QAAQ,CAAC,QAAQ,CAAC;gBAClE,IAAI,CAAC,QAAQ,CAAC,iBAAiB,CAAC,UAAU,GAAG,UAAU,CAAC;aACzD;YACD,IAAM,uBAAuB,GAAsB,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAsB,CAAC;YAC7F,IAAI,uBAAuB,EAAE;gBAC3B,uBAAuB,CAAC,aAAa,EAAE,CAAC;aACzC;YACD,IAAM,mBAAmB,GAAG,IAAI,CAAC,QAAQ,CAAC,KAAK,IAAI,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,qBAAqB,CAAC,CAAC;YAC9F,IAAI,mBAAmB,IAAI,mBAAmB,CAAC,SAAS,CAAC,EAAE;gBACzD,IAAI;oBACF,mBAAmB,CAAC,SAAS,CAAC,CAAC,SAAS,CAAC,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,EAAE,CAAC,gBAAQ,IAAI,CAAC,QAAQ,CAAC,iBAAiB,CAAE,CAAC;oBAC1G,mBAAmB,CAAC,SAAS,CAAC,CAAC,aAAa,CAAC,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,EAAE,EAAE,UAAU,CAAC,CAAC;oBACjF,mBAAmB,CAAC,iBAAiB,CAAC,aAAa,EAAE,CAAC;iBACvD;gBAAC,WAAM,GAAG;aACZ;SACF;QAKD,sBAAc,uDAAW;;;;iBAAzB;;gBAEE,IAAI,IAAI,CAAC,SAAS,CAAC,WAAW,KAAK,GAAG,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,WAAW,EAAE;oBACrE,OAAO,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC;iBAC9B;;gBAED,IAAI,WAAW,GAAG,IAAI,CAAC,SAAS,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC;gBACvD,WAAW,GAAG,WAAW,CAAC,CAAC,CAAC,CAAC,WAAW,EAAE,GAAG,WAAW,CAAC,SAAS,CAAC,CAAC,EAAE,WAAW,CAAC,MAAM,CAAC,CAAC;gBAC1F,IAAM,KAAK,GAAG,WAAW,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;gBAErC,IAAM,aAAa,GAAG,KAAK,CAAC,MAAM,CAAC,UAAC,IAAY;oBAC9C,OAAO,IAAI,KAAK,EAAE,CAAC;iBACpB,CAAC,CAAC;gBACH,OAAO,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC,aAAa,CAAC,CAAC;aACjD;;;WAAA;;QAGO,iDAAQ,GAAhB;YACE,IAAI,CAAC,oBAAoB,EAAE,CAAC;YAC5B,IAAM,IAAI,GAAG,IAAI,CAAC,WAAW,CAAC,OAAO,EAAE,CAAC;YACxC,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;SAC7B;;;;;QAMS,8DAAqB,GAA/B,UAAgC,kBAAuB;YACrD,IAAI,CAAC,iBAAiB,CAAC,IAAI,CAAC,kBAAkB,CAAC,CAAC;SACjD;;;;;QAMS,oEAA2B,GAArC,UAAsC,EAAU;YAC9C,IAAI,CAAC,WAAW,CAAC,YAAY,CAAC,EAAE,EAAE,IAAI,CAAC,CAAC;SACzC;;;;;QAMS,4DAAmB,GAA7B,UAA8B,MAAc;YAC1C,IAAI,CAAC,QAAQ,EAAE,CAAC;YAChB,IAAI,CAAC,iBAAiB,CAAC,MAAM,CAAC,CAAC;SAChC;;;;;QAKO,0DAAiB,GAAzB,UAA0B,MAAe;YACvC,IAAI,CAAC,IAAI,CAAC,WAAW,IAAI,CAAC,IAAI,CAAC,WAAW,CAAC,SAAS,EAAE;gBACpD,OAAO;aACR;YACD,IAAI,IAAI,CAAC,SAAS,IAAI,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC,WAAW,CAAC,uBAAuB,KAAK,IAAI,EAAE;gBAC9F,OAAO;aACR;YACO,IAAA,uCAAS,EAAT,8BAAS,CAAmC;YACpD,IAAM,SAAS,GAAG,IAAI,CAAC,WAAW,CAAC,SAAS,CAAC;;YAE7C,IAAI,EAAE,KAAK,SAAS,EAAE;gBACpB,OAAO;aACR;YACD,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,WAAW,CAAC,SAAS,CAAC,CAAC;SAC5C;QACS,kDAAS,GAAnB,UAAoB,EAAO;YACzB,IAAI,IAAI,CAAC,QAAQ,IAAI,OAAO,IAAI,CAAC,QAAQ,CAAC,SAAS,KAAK,UAAU,EAAE;gBAClE,IAAI,CAAC,QAAQ,CAAC,SAAS,CAAC,EAAE,CAAC,CAAC;aAC7B;SACF;;;;QAIO,uEAA8B,GAAtC;YAAA,iBAIC;YAHC,IAAI,CAAC,sBAAsB,GAAG,IAAI,CAAC,WAAW,CAAC,OAAO,CAAC,SAAS,CAAC,UAAC,MAAc;gBAC9E,KAAI,CAAC,mBAAmB,CAAC,MAAM,CAAC,CAAC;aAClC,CAAC,CAAC;SACJ;;;;QAIO,yEAAgC,GAAxC;YACE,IAAI,CAAC,sBAAsB,CAAC,WAAW,EAAE,CAAC;SAC3C;QACO,kDAAS,GAAjB,UAAkB,GAAa;YAC7B,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,gBAAgB,CAAC,KAAK,EAAE,GAAG,CAAC,CAAC;SACrD;;QAGD,kDAAS,GADT,UACU,KAAU;YACV,IAAA,mBAAK,EAAE,iBAAI,EAAE,yCAAgB,CAAW;YAChD,IAAI,gBAAgB,KAAK,KAAK,IAAI,CAAC,KAAK,CAAC,cAAc,CAAC,kBAAkB,CAAC,EAAE;gBAC3E,IAAI,IAAI,IAAI,KAAK,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,IAAI,CAAC,MAAM,GAAG,CAAC,EAAE;oBAClD,IAAM,EAAE,GAAG,IAAI,CAAC,CAAC,CAAC,IAAI,IAAI,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,UAAU,CAAC,IAAI,IAAI,CAAC;oBACvD,IAAI,EAAE,EAAE;wBACN,IAAI,CAAC,2BAA2B,CAAC,EAAE,CAAC,CAAC;qBACtC;iBACF;gBACD,IAAI,CAAC,QAAQ,CAAC,WAAW,GAAG,KAAK,CAAC;gBAClC,IAAI,CAAC,qBAAqB,CAAC,KAAK,CAAC,CAAC;aACnC;SACF;;;;;QAOM,2DAAkB,GADzB,UAC0B,KAAU;YAClC,IAAI,SAAS,GAAG,KAAK,CAAC,QAAQ,CAAC,SAAS,CAAC;YACzC,IAAM,QAAQ,GAAG,KAAK,CAAC,QAAQ,CAAC,QAAQ,CAAC;YACzC,IAAI,SAAS,GAAG,CAAC,EAAE;gBACjB,SAAS,GAAG,CAAC,CAAC;aACf;YACD,IAAM,IAAI,GAAG,CAAC,SAAS,GAAG,CAAC,IAAI,QAAQ,CAAC;YACxC,IAAI,CAAC,WAAW,CAAC,aAAa,CAAC,IAAI,EAAE,QAAQ,EAAE,IAAI,CAAC,WAAW,CAAC,WAAW,CAAC,CAAC;SAC9E;;;;;QAOM,+DAAsB,GAD7B,UAC8B,KAAU;YAChC,IAAA,mBAAwC,EAAtC,wBAAS,EAAE,sBAA2B,CAAC;YAC/C,IAAM,IAAI,GAAG,CAAC,SAAS,GAAG,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC;YAC3C,IAAI,CAAC,WAAW,CAAC,aAAa,CAAC,IAAI,EAAE,QAAQ,EAAE,IAAI,CAAC,WAAW,CAAC,WAAW,CAAC,CAAC;SAC9E;QAEM,0DAAiB,GADxB,UACyB,KAAU;YACjC,IAAM,GAAG,GAAG,KAAK,CAAC;YAClB,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,CAAC;SACrB;;oBAtPFV,cAAS,SAAC;wBACT,QAAQ,EAAE,yBAAyB;qBACpC;;;;;wBAJQS,kBAAW;wBAAeH,gBAAS;wBACnCyC,4BAAiB;;;;mCAevB5C,UAAK;wCAILmB,WAAM;gCAwLNlB,iBAAY,SAAC,WAAW,EAAE,CAAC,QAAQ,CAAC;yCAmBpCA,iBAAY,SAAC,aAAa,EAAE,CAAC,QAAQ,CAAC;6CAetCA,iBAAY,SAAC,iBAAiB,EAAE,CAAC,QAAQ,CAAC;wCAM1CA,iBAAY,SAAC,mBAAmB,EAAE,CAAC,QAAQ,CAAC;;QAK/C,qCAAC;KAvPD;;;QCgDE,2BACS,WAAwB,EACxB,SAAoB,EACpB,IAAuB,EACtB,WAAkC,EACnC,QAAkB,EACjB,GAAwB,EACzB,SAAwB,EACxB,MAAc;YAPd,gBAAW,GAAX,WAAW,CAAa;YACxB,cAAS,GAAT,SAAS,CAAW;YACpB,SAAI,GAAJ,IAAI,CAAmB;YACtB,gBAAW,GAAX,WAAW,CAAuB;YACnC,aAAQ,GAAR,QAAQ,CAAU;YACjB,QAAG,GAAH,GAAG,CAAqB;YACzB,cAAS,GAAT,SAAS,CAAe;YACxB,WAAM,GAAN,MAAM,CAAQ;;;;YAlCS,0BAAqB,GAAY,IAAI,CAAC;;;;YAI9D,mBAAc,GAAW,GAAG,CAAC;;;;YAM7B,gBAAW,GAAU,EAAE,CAAC;SAyB3B;QAxBL,sBAAc,0CAAW;iBAAzB;;gBAEE,IAAI,IAAI,CAAC,SAAS,CAAC,WAAW,KAAK,GAAG,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,WAAW,EAAE;oBACrE,OAAO,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC;iBAC9B;;gBAED,IAAI,WAAW,GAAG,IAAI,CAAC,SAAS,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC;gBACvD,WAAW,GAAG,WAAW,CAAC,CAAC,CAAC,CAAC,WAAW,EAAE,GAAG,WAAW,CAAC,SAAS,CAAC,CAAC,EAAE,WAAW,CAAC,MAAM,CAAC,CAAC;gBAC1F,IAAM,KAAK,GAAG,WAAW,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;gBAErC,IAAM,aAAa,GAAG,KAAK,CAAC,MAAM,CAAC,UAAC,IAAY;oBAC9C,OAAO,IAAI,KAAK,EAAE,CAAC;iBACpB,CAAC,CAAC;gBACH,OAAO,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC,aAAa,CAAC,CAAC;aACjD;;;WAAA;QAYD,oCAAQ,GAAR;YACE,IAAI,CAAC,KAAK,EAAE,CAAC;SACd;QACD,uCAAW,GAAX,UAAY,OAAsB;YAChC,IAAI,CAAC,KAAK,EAAE,CAAC;SACd;QACD,uCAAW,GAAX;YACE,IAAI,CAAC,MAAM,EAAE,CAAC;SACf;;;;QAIO,iCAAK,GAAb;YACE,IAAI,CAAC,IAAI,CAAC,IAAI,EAAE;gBACd,OAAO;aACR;YACD,IAAI,CAAC,iBAAiB,EAAE,CAAC;;YAEzB,IAAI,IAAI,CAAC,YAAY,EAAE;gBACrB,IAAM,mBAAmB,GAAG,IAAI,CAAC,QAAQ,IAAI,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAUmC,uCAAgC,EAAE,KAAK,CAAC,IAAI,KAAK,CAAC;gBAC1H,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,YAAY,IAAI,CAAC,mBAAmB,EAAE;oBACnD,IAAI,CAAC,IAAI,CAAC,cAAc,EAAE,CAAC;;oBAE3B,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC,UAAU,CAAC,WAAW,CAAC,IAAI,CAAC,sBAAsB,CAAC,CAAC;iBACjF;gBAED,IAAI,CAAC,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC;gBAC1B,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC,UAAU,CAAC,2BAA2B,IAAI,CAAC,mBAAmB,EAAE;oBAC/F,IAAI,CAAC,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,CAAC;iBAC/B;gBACD,IAAI,CAAC,oBAAoB,EAAE,CAAC;gBAC5B,IAAI,CAAC,oBAAoB,EAAE,CAAC;gBAC5B,IAAI,CAAC,kBAAkB,EAAE,CAAC;aAC3B;iBAAM;gBACL,IAAI,CAAC,IAAI,CAAC,QAAQ,GAAG,KAAK,CAAC;gBAC3B,IAAI,CAAC,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;;;;;;;gBAO/B,IAAI,IAAI,CAAC,IAAI,IAAI,OAAO,IAAI,CAAC,IAAI,CAAC,IAAI,KAAK,UAAU,IAAI,IAAI,CAAC,IAAI,CAAC,QAAQ,EAAE;oBAC3E,IAAI,CAAC,IAAI,CAAC,IAAI,EAAE,CAAC;iBAClB;gBACD,IAAI,CAAC,MAAM,EAAE,CAAC;aACf;SACF;;;;QAIO,6CAAiB,GAAzB;YACE,IAAI,IAAI,CAAC,qBAAqB,KAAK,KAAK,EAAE;gBACxC,OAAO;aACR;YACD,IAAM,UAAU,GAAG,IAAI,CAAC,IAAI,IAAI,IAAI,CAAC,IAAI,CAAC,UAAU,IAAI,IAAI,CAAC;YAC7D,IAAI,UAAU,EAAE;gBACd,IAAI,IAAI,CAAC,YAAY,EAAE;oBACrB,IAAI,CAAC,WAAW,GAAG,CAAC,UAAU,CAAC,CAAC;oBAChC,IAAI,CAAC,IAAI,CAAC,cAAc,CAAC,EAAE,CAAC,CAAC;iBAC9B;aACF;iBAAM;gBACL,IAAI,IAAI,CAAC,WAAW,IAAI,IAAI,CAAC,WAAW,CAAC,MAAM,GAAG,CAAC,EAAE;oBACnD,IAAM,YAAU,GAAG,IAAI,CAAC,WAAW,CAAC,GAAG,EAAE,CAAC;oBAC1C,IAAI,IAAI,CAAC,WAAW,CAAC,MAAM,GAAG,CAAC,EAAE;wBAC/B,IAAI,CAAC,WAAW,GAAG,EAAE,CAAC;qBACvB;oBACD,IAAI,CAAC,IAAI,CAAC,cAAc,CAAC,YAAU,CAAC,CAAC;iBACtC;aACF;SACF;;;;QAIO,gDAAoB,GAA5B;YAAA,iBAiFC;YAhFC,IAAI,CAAC,qBAAqB,GAAG,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,SAAS,CAAC,UAAC,CAAM;gBAChE,IAAI,CAAC,CAAC,EAAE;oBACN,OAAO;iBACR;gBACD,IAAM7C,SAAM,GAAG,CAAC,CAAC,MAAM,CAAC;gBACxB,IAAIA,SAAM,IAAIA,SAAM,CAAC,MAAM,EAAE;oBAC3B,IAAM,gBAAc,GAAG,CAAC,CAAC,MAAM,CAAC,YAAY,CAAC,QAAQ,CAAC;oBACtD,IAAI,CAAC,gBAAc,IAAI,CAAC,gBAAc,CAAC,QAAQ,EAAE;wBAC/C,OAAO;qBACR;oBACD,IAAI,WAAS,GAAG,gBAAc,CAAC,QAAQ,CAAC,SAAS,CAAC;oBAClD,IAAIA,SAAM,CAAC,MAAM,CAAC,IAAI,KAAK,QAAQ,IAAIA,SAAM,CAAC,MAAM,CAAC,IAAI,KAAK,mBAAmB,IAAIA,SAAM,CAAC,MAAM,CAAC,IAAI,KAAK,sBAAsB,IAAIA,SAAM,CAAC,MAAM,CAAC,IAAI,KAAK,sBAAsB,IAAI,kBAAkB,KAAKA,SAAM,CAAC,MAAM,CAAC,IAAI,IAAI,qBAAqB,KAAKA,SAAM,CAAC,MAAM,CAAC,IAAI,EAAE;wBAChR,IAAM,YAAU,GAAwB,gBAAc,CAAC,QAAQ,CAAC;wBAChE,IAAM,OAAO,GAAG,gBAAc,CAAC,QAAQ,CAAC,YAAY,CAAC;wBACrD,IAAI,OAAO,EAAE;4BACX,OAAO,CAAC,SAAS,CAAC,UAAC,IAAS;gCAC1B,WAAS,GAAG,gBAAc,CAAC,QAAQ,CAAC,SAAS,CAAC;gCAC9C,IAAM,OAAO,GAAG,YAAU,CAAC,uBAAuB,IAAI,KAAI,CAAC,cAAc,CAAC;gCAC1E,KAAI,CAAC,aAAa,CAAC,IAAI,EAAE,WAAS,EAAE,KAAK,EAAE,OAAO,CAAC,CAAC;6BACrD,CAAC,CAAC;yBACJ;wBACD,IAAM,aAAa,GAAG,gBAAc,CAAC,QAAQ,CAAC,aAAa,CAAC;wBAC5D,IAAI,aAAa,EAAE;4BACjB,aAAa,CAAC,SAAS,CAAC,UAAC,MAAW;gCAClC,IAAM,SAAS,GAAG,MAAM,CAAC,MAAM,CAAC,EAAE,EAAE,gBAAc,CAAC,QAAQ,CAAC,SAAS,CAAC,CAAC;gCACvE,IAAM,KAAK,GAAG,MAAM,IAAI,MAAM,CAAC,KAAK,IAAI,IAAI,CAAC;gCAC7C,IAAM,OAAO,GAAG,gBAAc,CAAC,MAAM,IAAI,gBAAc,CAAC,MAAM,CAAC,KAAK,CAAC;gCACrE,IAAM,eAAe,GAAG,gBAAc,CAAC,QAAQ,CAAC,SAAS,CAAC;gCAC1D,IAAM,IAAI,GAAG,EAAE,CAAC;gCAChB,IAAI,OAAO,EAAE;oCACX,IAAM,gBAAgB,GAAG,SAAS,CAAC,eAAe,CAAC,CAAC;oCACpD,IAAI,gBAAgB,EAAE;wCACpB,IAAM,UAAU,GAAW,gBAAgB,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAC,IAAI,IAAK,OAAA,IAAI,KAAK,OAAO,GAAA,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;wCACpG,IAAI,UAAU,EAAE;4CACd,SAAS,CAAC,eAAe,CAAC,GAAG,UAAU,CAAC;yCACzC;6CAAM;4CACL,OAAO,SAAS,CAAC,eAAe,CAAC,CAAC;yCACnC;qCACF;oCACD,IAAM,WAAW,GAAG,KAAI,CAAC,mBAAmB,EAAE,CAAC;oCAC/C,KAAI,CAAC,WAAW,CAAC,QAAQ,CAAC,WAAW,CAAC,MAAM,CAAC,OAAO,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,EAAE,KAAK,EAAE,IAAI,EAAE,IAAI,CAAC,CAAC;iCACtF;;gCAED,IAAI,SAAS,IAAI,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC,MAAM,GAAG,CAAC,EAAE;oCAClD,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC,OAAO,CAAC,UAAC,KAAK;wCACnC,KAAI,CAAC,QAAQ,CAAC,IAAI,EAAE,KAAK,CAAC,KAAK,CAAC,GAAG,CAAC,EAAE,EAAE,CAAC,CAAC;qCAC3C,CAAC,CAAC;oCACH,KAAI,CAAC,aAAa,CAAC,IAAI,EAAE,SAAS,EAAE,IAAI,CAAC,CAAC;iCAC3C;6BACF,CAAC,CAAC;yBACJ;qBACF;oBAED,IAAIA,SAAM,CAAC,MAAM,CAAC,IAAI,KAAK,cAAc,EAAE;wBACzC,gBAAc,CAAC,QAAQ,CAAC,WAAW,CAAC,SAAS,CAAC,UAAC,CAAM;4BACnD,IAAM,OAAO,GAAG,CAAC,IAAI,CAAC,CAAC,UAAU,IAAI,CAAC,CAAC,UAAU,CAAC,MAAM,KAAK,CAAC,CAAC;4BAC/D,IAAM,WAAW,GAAyB,gBAAc,CAAC,QAAQ,CAAC;4BAClE,WAAS,GAAG,gBAAc,CAAC,QAAQ,CAAC,SAAS,CAAC;4BAC9C,IAAM,OAAO,GAAG,WAAW,CAAC,SAAS,IAAI,KAAI,CAAC,cAAc,CAAC;4BAC7D,KAAI,CAAC,aAAa,CAAC,CAAC,CAAC,UAAU,IAAI,EAAE,EAAE,WAAS,EAAE,OAAO,EAAE,OAAO,CAAC,CAAC;yBACrE,CAAC,CAAC;qBACJ;oBACD,IAAI,CAAC,cAAc,EAAE,WAAW,EAAE,QAAQ,EAAE,mBAAmB,EAAE,sBAAsB,EAAE,sBAAsB,EAAE,kBAAkB,EAAE,qBAAqB,CAAC,CAAC,QAAQ,CAACA,SAAM,CAAC,MAAM,CAAC,IAAI,CAAC,EAAE;wBACxL,IAAI,gBAAc,CAAC,QAAQ,CAAC,KAAK,IAAI,gBAAc,CAAC,QAAQ,CAAC,KAAK,CAAC,SAAS,EAAE;4BAC5E,gBAAc,CAAC,QAAQ,CAAC,KAAK,CAAC,SAAS,CAAC;gCACtC,KAAI,CAAC,aAAa,CAAC,IAAI,EAAE,WAAS,CAAC,CAAC;6BACrC,CAAC,CAAC;yBACJ;qBACF;oBAED,IAAIA,SAAM,CAAC,MAAM,CAAC,IAAI,KAAK,WAAW,EAAE;wBACtC,IAAI,WAAS,EAAE;4BACb,gBAAc,CAAC,QAAQ,CAAC,WAAW,CAAC,SAAS,CAAC,UAAC,CAAC;gCAC9C,IAAM,OAAO,GAAG,KAAI,CAAC,mBAAmB,EAAE,CAAC;gCAC3C,KAAI,CAAC,SAAS,CAAC,WAAW,CAAC,QAAQ,CAAC,OAAO,CAAC,MAAM,CAAC,WAAS,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,EAAE,gBAAc,CAAC,QAAQ,CAAC,cAAc,EAAE,IAAI,EAAE,IAAI,CAAC,CAAC;6BAC/H,CAAC,CAAC;yBACJ;qBACF;iBACF;aACF,CAAC,CAAC;SACJ;;;;QAIO,gDAAoB,GAA5B;YAAA,iBAiBC;YAhBC,IAAI,CAAC,IAAI,CAAC,SAAS,GAAG,UAAC,QAAQ,EAAE,OAAO,EAAEA,SAAM,EAAE,MAAM;gBACtD,IAAI,KAAI,CAAC,SAAS,CAAC,eAAe,EAAE,EAAE;oBACpC,OAAOmB,OAAE,CAAC,KAAK,CAAC,CAAC;iBAClB;gBACD,IAAI,KAAI,CAAC,GAAG,EAAE;;oBAEZ,IAAI,KAAI,CAAC,GAAG,CAAC,YAAY,CAAC,gBAAgB,CAAC,EAAE;wBAC3C,OAAOA,OAAE,CAAC,KAAK,CAAC,CAAC;qBAClB;iBACF;;gBAED,IAAI,CAAC,MAAM,IAAI,CAAC,MAAM,CAAC,WAAW,EAAE;oBAClC,OAAOA,OAAE,CAAC,KAAK,CAAC,CAAC;iBAClB;gBACD,OAAOA,OAAE,CAAC,IAAI,CAAC,CAAC;aACjB,CAAC;SACH;;;;QAIO,8CAAkB,GAA1B;YAAA,iBAMC;YALC,IAAI,CAAC,mBAAmB,GAAG,IAAI,CAAC,IAAI,IAAI,IAAI,CAAC,IAAI,CAAC,OAAO,IAAI,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,SAAS,CAAC,UAAC,KAAU;gBAC5F,IAAA,gBAAqE,EAAnE,aAAiB,EAAjB,sCAAiB,EAAE,cAAkB,EAAlBnB,0CAAkB,EAAE,eAAY,EAAZ,iCAA4B,CAAC;gBAC5E,IAAM,YAAY,GAAG,OAAO,IAAI,OAAO,CAAC,KAAI,CAAC,IAAI,CAAC,OAAO,CAAC,IAAI,IAAI,CAAC;gBACnE,KAAI,CAAC,iBAAiB,CAAC,KAAK,EAAEA,SAAM,EAAE,YAAY,CAAC,CAAC;aACrD,CAAC,CAAC;SACJ;;;;QAIO,6CAAiB,GAAzB,UAA0B,KAAU,EAAEA,SAAW,EAAE,YAAkB;YACnE,IAAI,CAACA,SAAM,EAAE;gBACX,OAAO;aACR;YACD,IAAM,iBAAiB,GAAGA,SAAM,CAAC,QAAQ,CAAC;;YAG1C,IAAM,UAAU,GAAGA,SAAM,CAAC,KAAK,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;;YAE3C,IAAM,WAAW,GAAGA,SAAM,IAAIA,SAAM,CAAC,MAAM,IAAIA,SAAM,CAAC,MAAM,CAAC,OAAO,IAAIA,SAAM,CAAC,MAAM,CAAC,OAAO,CAAC,SAAS,CAAC;;YAExG,IAAI,iBAAiB,KAAK,MAAM,EAAE;gBAChC,IAAI,MAAM,SAAA,CAAC;gBACX,IAAI,KAAK,EAAE;oBACT,MAAM,GAAG,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC,KAAK,EAAE,YAAY,CAAC,CAAC;iBACzD;qBAAM;oBACL,MAAM,GAAG,KAAK,CAAC;iBAChB;gBACD,IAAI,CAAC,iBAAiB,CAAC,YAAY,EAAE,UAAU,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,MAAM,CAAC,CAAC;aACpE;iBAAM,IAAI,iBAAiB,KAAK,UAAU,EAAE;;;;gBAI3C,IAAI,CAAC,iBAAiB,CAAC,YAAY,EAAE,UAAU,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,KAAK,CAAC,CAAC;aACnE;iBAAM,IAAI,iBAAiB,KAAK,QAAQ,IAAI,CAAC,WAAW,EAAE;gBACzD,IAAI,KAAK,KAAK,IAAI,IAAI,KAAK,KAAK,SAAS,EAAE;oBACzC,IAAI,CAAC,iBAAiB,CAAC,YAAY,EAAE,UAAU,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,IAAI,CAAC,CAAC;iBAClE;qBAAM;oBACL,IAAI,CAAC,iBAAiB,CAAC,YAAY,EAAE,UAAU,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,MAAM,CAAC,KAAK,CAAC,CAAC,CAAC;iBAC3E;aACF;iBAAM;gBACL,IAAI,CAAC,iBAAiB,CAAC,YAAY,EAAE,UAAU,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,KAAK,CAAC,CAAC;aACnE;SACF;QACO,6CAAiB,GAAzB,UAA0B,YAAiB,EAAE,YAAoB,EAAE,KAAU;YAC3E,IAAM,SAAS,GAAG,IAAI,CAAC,SAAS,IAAI,IAAI,CAAC;YACzC,IAAI,CAAC,SAAS,IAAI,CAAC,YAAY,EAAE;gBAC/B,OAAO;aACR;;YAED,IAAM,aAAa,GAAG,YAAY,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAC,IAAI,IAAK,OAAA,IAAI,GAAA,CAAC,CAAC;YACrE,IAAM,WAAW,GAAG,IAAI,CAAC,mBAAmB,EAAE,CAAC;;YAE/C,IAAM,IAAI,GAAG,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC,WAAW,CAAgB,CAAC;;YAEnE,IAAI,IAAI,IAAI,YAAY,KAAK,IAAI,CAAC,WAAW,CAAC,eAAe,EAAE;gBAC7D,IAAM,KAAK,GAAG,WAAW,CAAC,MAAM,CAAC,aAAa,CAAC,CAAC;gBAChD,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC,KAAK,EAAE,KAAK,EAAE,IAAI,EAAE,IAAI,CAAC,CAAC;gBACpD,OAAO;aACR;YACD,IAAM,aAAa,GAAG,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC,YAAY,CAAC,CAAC;YAC9D,IAAI,CAAC,aAAa,EAAE;gBAClB,OAAO;aACR;YACD,IAAI,aAAa,CAAC,MAAM,GAAG,CAAC,EAAE;gBAC5B,aAAa,CAAC,QAAQ,CAAC,YAAY,EAAE,KAAK,EAAE,IAAI,EAAE,IAAI,CAAC,CAAC;aACzD;iBAAM;gBACL,IAAI,qBAAmB,GAAG,IAAI,CAAC;gBAC/B,IAAM,MAAM,GAAG,aAAa,CAAC,KAAK,CAAC,CAAC,EAAE,aAAa,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;gBAChE,IAAM,kBAAkB,GAAG,aAAa,CAAC,aAAa,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;gBACnE,MAAM,CAAC,OAAO,CAAC,UAAC,IAAI;oBAClB,qBAAmB,GAAG,qBAAmB,IAAI,qBAAmB,CAAC,IAAI,CAAC,IAAI,aAAa,CAAC,IAAI,CAAC,CAAC;iBAC/F,CAAC,CAAC;;gBAEH,qBAAmB,CAAC,QAAQ,CAAC,kBAAkB,EAAE,KAAK,EAAE,IAAI,EAAE,IAAI,CAAC,CAAC;aACrE;SACF;QACO,kCAAM,GAAd;YACE,IAAI,IAAI,CAAC,qBAAqB,IAAI,OAAO,IAAI,CAAC,qBAAqB,CAAC,WAAW,KAAK,UAAU,EAAE;gBAC9F,IAAI,CAAC,qBAAqB,CAAC,WAAW,EAAE,CAAC;aAC1C;YACD,IAAI,IAAI,CAAC,mBAAmB,IAAI,OAAO,IAAI,CAAC,mBAAmB,CAAC,WAAW,KAAK,UAAU,EAAE;gBAC1F,IAAI,CAAC,mBAAmB,CAAC,WAAW,EAAE,CAAC;aACxC;SACF;;QAIO,yCAAa,GAArB,UAAsB,QAAa,EAAE,SAAc,EAAE,OAAwB,EAAE,OAAqB;YAApG,iBAsDC;YAtDoD,wBAAA;gBAAA,eAAwB;;YAAE,wBAAA;gBAAA,aAAqB;;YAClG,IAAI,CAAC,SAAS,EAAE;gBACd,OAAO;aACR;;YAED,IAAM,UAAU,GAAG,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC,UAAU,CAAC;YAC1D,UAAU,CAAC,yBAAyB,CAAC,MAAM,EAAE,CAAC;YAE9C,IAAM,OAAO,GAAG,IAAI,CAAC,mBAAmB,EAAE,CAAC;YAC3C,IAAI,UAAU,GAAG,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;YACxC,IAAM,WAAW,GAAG,IAAI,CAAC,sBAAsB,CAAC,SAAS,EAAE,OAAO,CAAC,CAAC;YAEpE,IAAI,WAAW,GAAG,WAAW,IAAI,WAAW,CAAC,GAAG,CAAC,UAAC,IAAI,IAAK,OAAA,IAAI,CAAC,UAAU,GAAA,CAAC,IAAI,EAAE,CAAC;YAClF,IAAM,aAAa,GAAG,WAAW,IAAI,WAAW,CAAC,GAAG,CAAC,UAAC,IAAI,IAAK,OAAA,IAAI,CAAC,YAAY,GAAA,CAAC,IAAI,EAAE,CAAC;;YAExF,IAAI,WAAW,IAAI,WAAW,CAAC,MAAM,GAAG,CAAC,EAAE;gBACzC,WAAW,YAAO,IAAI,GAAG,CAAC,WAAW,CAAC,CAAC,CAAC;gBACxC,UAAU,GAAG,IAAI,CAAC,gBAAgB,CAAC,UAAU,EAAE,WAAW,CAAC,CAAC;aAC7D;YAED,IAAI,CAAC,QAAQ,IAAI,OAAO,EAAE;gBACxB,UAAU,CAAC,OAAO,EAAE,CAAC;aACtB;YACD,UAAU,CAAC,OAAO,CAAC,UAAC,CAAM;gBACxB,IAAI,GAAG,GAAQ,EAAE,CAAC;gBAClB,IAAI,QAAQ,EAAE;oBACZ,IAAI,QAAQ,YAAY,KAAK,EAAE;wBAC7B,GAAG,GAAG,QAAQ,CAAC,GAAG,CAAC,UAAC,CAAM;4BACxB,OAAO,KAAI,CAAC,QAAQ,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;yBAC5B,CAAC,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;qBAClB;yBAAM;wBACL,GAAG,GAAG,KAAI,CAAC,QAAQ,CAAC,CAAC,EAAE,QAAQ,CAAC,CAAC;qBAClC;iBACF;gBAED,IAAI,QAAQ,GAAU,SAAS,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;gBAC9C,IAAM,YAAY,GAAG,QAAQ,CAAC,MAAM,CAAC,UAAC,CAAC,IAAK,OAAA,aAAa,CAAC,QAAQ,CAAC,CAAC,CAAC,GAAA,CAAC,CAAC;gBACvE,IAAM,YAAY,GAAG,QAAQ,CAAC,MAAM,CAAC,UAAC,CAAC,IAAK,OAAA,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAC,CAAC,GAAA,CAAC,CAAC;gBACxE,IAAI,CAAC,QAAQ,EAAE;oBACb,QAAQ,GAAG,EAAE,CAAC,MAAM,CAAC,YAAY,CAAC,CAAC,MAAM,CAAC,YAAY,CAAC,CAAC;iBACzD;qBAAM;oBACL,QAAQ,GAAG,EAAE,CAAC,MAAM,CAAC,YAAY,CAAC,CAAC,MAAM,CAAC,YAAY,CAAC,CAAC;iBACzD;gBACD,QAAQ,CAAC,OAAO,CAAC,UAAC,EAAO;oBACvB,IAAI,CAAC,QAAQ,EAAE;wBACb,KAAI,CAAC,SAAS,CAAC,WAAW,CAAC,UAAU,CAAC,OAAO,CAAC,MAAM,CAAC,EAAE,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,EAAE,IAAI,EAAE,IAAI,CAAC,CAAC;qBAClF;yBAAM;wBACL,KAAI,CAAC,SAAS,CAAC,WAAW,CAAC,QAAQ,CAAC,OAAO,CAAC,MAAM,CAAC,EAAE,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,EAAE,GAAG,EAAE,IAAI,EAAE,IAAI,CAAC,CAAC;qBACrF;iBACF,CAAC,CAAC;aACJ,CAAC,CAAC;;YAGH,UAAU,CAAC,yBAAyB,CAAC,QAAQ,EAAE,CAAC;SACjD;QAEO,oCAAQ,GAAhB,UAAiB,CAAS,EAAE,IAAS;YACnC,IAAI,GAAG,GAAG,EAAE,CAAC;YACb,IAAI,CAAC,CAAC,OAAO,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC,EAAE;gBACzB,GAAG,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC;aACf;iBAAM;gBACL,GAAG,GAAG,CAAC,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAC,CAAC,EAAE,CAAC;oBAC7B,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC;iBACb,EAAE,IAAI,CAAC,CAAC;aACV;YAED,OAAO,GAAG,CAAC;SACZ;QAEO,+CAAmB,GAA3B;YACE,IAAM,IAAI,GAAG,IAAI,CAAC,SAAS,CAAC,WAAW,CAAC;YACxC,IAAI,IAAI,EAAE;gBACR,OAAO,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAC,CAAC,IAAK,OAAA,CAAC,KAAK,EAAE,GAAA,CAAC,CAAC;aAChD;YACD,OAAO,EAAE,CAAC;SACX;QAEO,yCAAa,GAArB,UAAsB,KAAK,EAAE,IAAI;YAC/B,IAAM,UAAU,GAAG,IAAI,CAAC,QAAQ,CAAC,KAAK,EAAE,IAAI,CAAC,CAAC;YAC9C,OAAOmC,iBAAQ,CAAC,UAAU,CAAC,CAAC;SAC7B;;;;;;QAOO,kDAAsB,GAA9B,UAA+B,SAAc,EAAE,YAAsB;YACnE,IAAI,CAAC,SAAS,IAAI,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC,MAAM,GAAG,CAAC,EAAE;gBACnD,OAAO,IAAI,CAAC;aACb;YACD,IAAM,OAAO,GAAG,EAAE,CAAC;;YAEnB,IAAI;gBACF,IAAM,gBAAc,GAAiB,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC,UAAU,CAAC,cAAc,CAAC;gBAC3F,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC,OAAO,CAAC,UAAC,GAAW;oBACzC,IAAM,QAAQ,GAAG,SAAS,CAAC,GAAG,CAAC,CAAC;oBAChC,IAAI,QAAQ,IAAI,OAAO,QAAQ,KAAK,QAAQ,EAAE;wBAC5C,IAAM,QAAQ,GAAG,QAAQ,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAC,CAAC,IAAK,OAAA,CAAC,GAAA,CAAC,CAAC;wBACtD,QAAQ,CAAC,OAAO,CAAC,UAAC,IAAY;4BAC5B,IAAI,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;4BAC5B,IAAI,YAAY,IAAI,YAAY,CAAC,MAAM,GAAG,CAAC,EAAE;gCAC3C,KAAK,GAAG,YAAY,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;6BACpC;4BACD,IAAM,QAAQ,GAAiB,gBAAc,CAAC,iBAAiB,CAAC,KAAK,CAAC,CAAC;4BACvE,IAAI,QAAQ,IAAI,QAAQ,CAAC,YAAY,IAAI,QAAQ,CAAC,YAAY,CAAC,OAAO,KAAK,IAAI,EAAE;gCAC/E,OAAO,CAAC,IAAI,CAAC;oCACX,UAAU,EAAE,GAAG;oCACf,YAAY,EAAE,IAAI;iCACnB,CAAC,CAAC;6BACJ;yBACF,CAAC,CAAC;qBACJ;iBACF,CAAC,CAAC;aACJ;YAAC,OAAO,CAAC,EAAE;gBACV,OAAO,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;aAClB;YACD,OAAO,OAAO,CAAC;SAChB;QACO,oCAAQ,GAAhB,UAAiB,MAAc,EAAE,KAAe,EAAE,KAAU;YAC1D,IAAI,MAAM,EAAE;gBACV,IAAI,KAAK,CAAC,MAAM,IAAI,CAAC,EAAE;oBACrB,MAAM,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,GAAG,KAAK,CAAC;iBAC1B;qBAAM;oBACL,KAAK,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC,UAAC,IAAI,EAAE,IAAI;wBACnC,IAAI,EAAE,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,IAAI,IAAI,CAAC,WAAW,CAAC,CAAC,cAAc,CAAC,IAAI,CAAC,CAAC,EAAE;4BAC1E,IAAI,CAAC,IAAI,CAAC,GAAG,EAAE,CAAC;yBACjB;wBACD,OAAO,IAAI,CAAC,IAAI,CAAC,CAAC;qBACnB,EAAE,MAAM,CAAC,CAAC,KAAK,CAAC,KAAK,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,GAAG,KAAK,CAAC;iBAC7C;aACF;SACF;QACO,4CAAgB,GAAxB,UAAyB,IAAc,EAAE,WAAqB;YAC5D,IAAI,CAAC,WAAW,IAAI,WAAW,CAAC,MAAM,GAAG,CAAC,IAAI,CAAC,IAAI,IAAI,IAAI,CAAC,MAAM,GAAG,CAAC,EAAE;gBACtE,OAAO,IAAI,CAAC;aACb;;YAED,IAAI,GAAG,IAAI,CAAC,MAAM,CAAC,UAAC,CAAC,IAAK,OAAA,CAAC,WAAW,CAAC,QAAQ,CAAC,CAAC,CAAC,GAAA,CAAC,CAAC;YACpD,OAAO,EAAE,CAAC,MAAM,CAAC,WAAW,CAAC,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;SAC5C;;oBAxcF7B,cAAS,SAAC;wBACT,QAAQ,EAAE,4BAA4B;qBACvC;;;;;wBAZCS,kBAAW;wBAAeH,gBAAS;wBAE5BuC,4BAAiB;wBAEjBjD,0BAAqB;wBARmCoD,aAAQ;wBAShE3B,4BAAmB;wBACnBD,sBAAa;wBAVqDZ,WAAM;;;;mCAqB9EL,UAAK,SAAC,0BAA0B;4CAIhCA,UAAK,SAAC,uBAAuB;;QA8bhC,wBAAC;KAzcD;;;QCTE,yBAAsB,UAAsB;YAA5C,iBASC;YATqB,eAAU,GAAV,UAAU,CAAY;YAC1C,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,UAAU,IAAI,IAAI,CAAC,UAAU,CAAC,WAAW,CAAC;YAClE,IAAI,IAAI,CAAC,WAAW,EAAE;gBACpB,IAAI,CAAC,WAAW,CAAC,SAAS,CAAC,UAAC,OAAY;oBACtC,IAAI,OAAO,IAAI,OAAO,CAAC,IAAI,KAAK,SAAS,EAAE;wBACzC,KAAI,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC;qBACvB;iBACF,CAAC,CAAC;aACJ;SACF;QACD,qCAAW,GAAX;;;;SAIC;QAEH,sBAAC;IAAD,CAAC;;;QCfmCJ,yCAAe;QAEjD,+BAAsB,UAAsB,EAAU,UAAsB;YAA5E,YACE,kBAAM,UAAU,CAAC,SAClB;YAFqB,gBAAU,GAAV,UAAU,CAAY;YAAU,gBAAU,GAAV,UAAU,CAAY;;SAE3E;QACD,wCAAQ,GAAR;YACE,IAAI,IAAI,CAAC,UAAU,EAAE;gBACnB,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC,UAAU,CAAC,aAAa,CAAC;aACpD;SACF;;;;;QAKM,uCAAO,GAAd,UAAe,OAAY;YACzB,IAAI,IAAI,CAAC,aAAa,EAAE;gBACtB,IAAM,QAAM,GAAQ,IAAI,CAAC,aAAa,CAAC,UAAU,IAAI,IAAI,CAAC,aAAa,CAAC,aAAa,CAAC;gBACtF,IAAM,MAAM,GAAe,QAAM,IAAI,KAAK,CAAC,IAAI,CAAC,QAAM,CAAC,oBAAoB,CAAC,OAAO,CAAC,CAAC,IAAI,EAAE,CAAC;gBAC5F,IAAI,MAAM,IAAI,MAAM,CAAC,MAAM,GAAG,CAAC,EAAE;oBAC/B,MAAM,CAAC,OAAO,CAAC,UAAA,KAAK;wBAClB,IAAI,KAAK,IAAI,QAAQ,KAAK,CAAC,IAAI,CAAC,KAAK,UAAU,EAAE;4BAC/C,KAAK,CAAC,IAAI,EAAE,CAAC;yBACd;qBACF,CAAC,CAAC;iBACJ;aACF;SACF;;oBA7BFC,cAAS,SAAC;wBACT,QAAQ,EAAE,kBAAkB;qBAC7B;;;;;wBALQiD,iBAAU;wBADCZ,eAAU;;;QAkC9B,4BAAC;KAAA,CA3BmC,eAAe;;;QCCNtC,kDAAe;QAC1D,wCAAsB,UAAsB,EAAU,QAA2B;YAAjF,YACE,kBAAM,UAAU,CAAC,SAClB;YAFqB,gBAAU,GAAV,UAAU,CAAY;YAAU,cAAQ,GAAR,QAAQ,CAAmB;;SAEhF;;;;;QAKM,gDAAO,GAAd,UAAe,OAAY;YACzB,IAAI,IAAI,CAAC,QAAQ,IAAI,OAAO,IAAI,CAAC,QAAQ,CAAC,WAAW,KAAK,UAAU,EAAE;gBACpE,IAAI,CAAC,QAAQ,CAAC,WAAW,EAAE,CAAC;aAC7B;SACF;;oBAfFC,cAAS,SAAC;wBACT,QAAQ,EAAE,wBAAwB;qBACnC;;;;;wBANQiD,iBAAU;wBACVJ,4BAAiB;;;QAmB1B,qCAAC;KAAA,CAb4C,eAAe;;;QCDnB9C,8CAAe;QACtD,oCAAsB,UAAsB,EAAU,MAA2B;YAAjF,YACE,kBAAM,UAAU,CAAC,SAClB;YAFqB,gBAAU,GAAV,UAAU,CAAY;YAAU,YAAM,GAAN,MAAM,CAAqB;;SAEhF;QACM,4CAAO,GAAd,UAAe,OAAY;YACzB,IAAI,IAAI,CAAC,MAAM,IAAI,OAAO,IAAI,CAAC,MAAM,CAAC,OAAO,KAAK,UAAU,EAAE;gBAC5D,IAAI,CAAC,MAAM,CAAC,OAAO,EAAE,CAAC;aACvB;SACF;;oBAXFC,cAAS,SAAC;wBACT,QAAQ,EAAE,wBAAwB;qBACnC;;;;;wBANQiD,iBAAU;wBACVC,gCAAmB;;;QAgB5B,iCAAC;KAAA,CAVwC,eAAe;;;QCChBnD,6CAAe;QACrD,mCAAsB,UAAsB,EAAU,IAAmB;YAAzE,YACE,kBAAM,UAAU,CAAC,SAClB;YAFqB,gBAAU,GAAV,UAAU,CAAY;YAAU,UAAI,GAAJ,IAAI,CAAe;;SAExE;QACM,2CAAO,GAAd,UAAe,OAAY;YACzB,IAAI,IAAI,CAAC,IAAI,IAAI,OAAO,IAAI,CAAC,IAAI,CAAC,SAAS,KAAK,UAAU,EAAE;gBAC1D,IAAI,CAAC,IAAI,CAAC,SAAS,EAAE,CAAC;aACvB;SACF;;oBAXFC,cAAS,SAAC;wBACT,QAAQ,EAAE,uBAAuB;qBAClC;;;;;wBANQiD,iBAAU;wBACV/B,8BAAa;;;QAetB,gCAAC;KAAA,CATuC,eAAe;;;QCOrD,8CAAmB,SAAoB,EAAS,IAAuB;YAAvE,iBAsBC;YAtBkB,cAAS,GAAT,SAAS,CAAW;YAAS,SAAI,GAAJ,IAAI,CAAmB;YACrE,IAAM,UAAU,GAAG,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC,iBAAiB,EAAE,CAAC;YACnE,IAAI,UAAU,IAAI,UAAU,CAAC,cAAc,CAAC,aAAa,CAAC,EAAE;gBAC1D,UAAU,CAAC,WAAW,CAAC,SAAS,CAAC,UAAC,OAAY;oBAC5C,IAAM,WAAW,GAAG,OAAO,IAAI,OAAO,CAAC,IAAI,IAAI,IAAI,CAAC;;oBAEpD,IAAI,WAAW,KAAK,OAAO,EAAE;wBAC3B,IAAI,KAAI,CAAC,oBAAoB,IAAI,KAAI,CAAC,IAAI,CAAC,cAAc,KAAK,QAAQ,EAAE;4BACtE,IAAM,KAAK,GAAG,KAAI,CAAC,oBAAoB,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;4BACnD,IAAI,MAAI,GAAG,IAAI,CAAC;4BAChB,KAAK,CAAC,OAAO,CAAC,UAAA,IAAI;gCAChB,MAAI,GAAG,MAAI,IAAI,MAAI,CAAC,IAAI,CAAC,IAAI,KAAI,CAAC,IAAI,CAAC,CAAC;6BACzC,CAAC,CAAC;4BACH,IAAI,OAAO,MAAI,KAAK,UAAU,EAAE;gCAC9B,MAAI,EAAE,CAAC,SAAS,CAAC,UAAA,MAAM;oCACrB,KAAI,CAAC,IAAI,CAAC,UAAU,GAAG,MAAM,CAAC;iCAC/B,CAAC,CAAC;6BACJ;yBACF;qBACF;iBACF,CAAC,CAAC;aACJ;SACF;;;;;;QAMO,sDAAO,GAAf,UAAgB,WAAmB,EAAE,OAAgB;YACnD,IAAI,CAAC,WAAW,IAAI,WAAW,KAAK,EAAE,IAAI,WAAW,KAAK,WAAW,EAAE;gBACrE,OAAO;aACR;YACD,IAAI,SAAS,GAAG,IAAI,CAAC,SAAS,CAAC;YAC/B,IAAI,OAAO,EAAE;gBACX,IAAM,aAAa,GAAG,SAAS,CAAC,YAAY,CAAC,UAAU,CAAC,mBAAmB,CAAC,mBAAmB,CAAC,OAAO,CAAC,CAAC;gBACzG,SAAS,GAAG,aAAa,CAAC,SAAS,CAAC;aACrC;YACD,OAAO,SAAS,CAAC,WAAW,CAAC,EAAE,CAAC;SACjC;;oBA/CFlB,cAAS,SAAC;wBACT,QAAQ,EAAE,iCAAiC;qBAC5C;;;;;wBANQM,gBAAS;wBACTuC,4BAAiB;;;;2CAUvB1C,UAAK,SAAC,+BAA+B;;QA0CxC,2CAAC;KAjDD;;;QCQI,iCACY,EAAa,EACb,QAAkB,EAClB,EAAc;YAFd,OAAE,GAAF,EAAE,CAAW;YACb,aAAQ,GAAR,QAAQ,CAAU;YAClB,OAAE,GAAF,EAAE,CAAY;YALlB,WAAM,GAAyB,IAAIgD,oBAAe,CAAC,EAAE,CAAC,CAAC;SAQ9D;QAZD,sBAAa,+CAAU;iBAAvB,UAAwB,KAAc;gBAClC,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;aAC3B;;;WAAA;QAYD,0CAAQ,GAAR;YAAA,iBAWC;YAVG,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,EAAE,CAAC,aAAa,CAAC;YACpC,IAAI,CAAC,MAAM,CAAC,SAAS,CAAC,UAAA,IAAI;gBACtB,IAAI,IAAI,KAAK,KAAK,IAAI,KAAI,CAAC,MAAM,EAAE;oBAC/B,IAAI,KAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,WAAW,EAAE,KAAK,oBAAoB,EAAE;wBAC7D,KAAI,CAAC,kBAAkB,EAAE,CAAC;qBAC7B;yBAAM;wBACH,KAAI,CAAC,QAAQ,EAAE,CAAC;qBACnB;iBACJ;aACJ,CAAC,CAAA;SACL;;;;QAKD,0CAAQ,GAAR;YACI,IAAM,KAAK,GAAG,IAAI,CAAC,MAAM,CAAC,gBAAgB,CAAC,OAAO,CAAC,CAAC;YACpD,IAAI,KAAK,CAAC,MAAM,EAAE;gBACd,KAAK,CAAC,CAAC,CAAC,CAAC,KAAK,EAAE,CAAA;aACnB;iBAAM;gBACH,IAAI,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC;aACvB;SACJ;;;;QAKD,oDAAkB,GAAlB;;YAEI,IAAM,UAAU,GAAG,IAAI,CAAC,MAAM,CAAC,aAAa,CAAC,6BAA6B,CAAC,CAAC;;YAE5E,IAAM,KAAK,GAAG,MAAM,CAAC,YAAY,EAAE,CAAC;;YAEpC,KAAK,CAAC,iBAAiB,CAAC,UAAU,CAAC,CAAC;;YAEpC,KAAK,CAAC,aAAa,EAAE,CAAC;SACzB;;oBAxDJnD,cAAS,SAAC;wBACP,QAAQ,EAAE,oBAAoB;qBACjC;;;;;wBAL0BsC,cAAS;wBAAEU,aAAQ;wBAAUX,eAAU;;;;iCAQ7DlC,UAAK;;QAoDV,8BAAC;KAzDD;;ICCA;;;AAGA;;;;;;;;;QAwEE,2CACsB,gBAAuC,EACnD,YAA0B,EACd,yBAAoD,EACpD,QAAkB;YAHlB,qBAAgB,GAAhB,gBAAgB,CAAuB;YACnD,iBAAY,GAAZ,YAAY,CAAc;YACd,8BAAyB,GAAzB,yBAAyB,CAA2B;YACpD,aAAQ,GAAR,QAAQ,CAAU;;;;YApEvB,uBAAkB,GAAG,YAAY,CAAC;;;;YAIlC,0BAAqB,GAAG,eAAe,CAAC;SAkExD;QAvCD,sBAAY,0DAAW;;;;iBAAvB;gBACE,OAAO,IAAI,CAAC,YAAY,CAAC,WAAW,CAAC;aACtC;;;WAAA;QAKD,sBAAY,0DAAW;;;;iBAAvB;gBACE,OAAO,IAAI,CAAC,WAAW,CAAC,OAAO,EAAE,CAAC;aACnC;;;WAAA;QAOD,sBAAY,yDAAU;;;;;;;iBAAtB;gBACE,OAAO,IAAI,CAAC,yBAAyB,IAAI,IAAI,CAAC,yBAAyB,CAAC,WAAW,IAAI,IAAI,CAAC,yBAAyB,CAAC,UAAU,IAAI,IAAI,CAAC,gBAAgB,IAAI,IAAI,CAAC,qBAAqB,IAAI,IAAI,CAAC,kBAAkB,CAAC;aACpN;;;WAAA;QAID,sBAAY,wDAAS;;;;iBAArB;gBACE,OAAO,IAAI,CAAC,eAAe,GAAG,IAAI,CAAC,eAAe,GAAG,IAAI,CAAC,UAAU,KAAK,IAAI,CAAC,kBAAkB,GAAG,MAAM,GAAG,KAAK,CAAC;aACnH;;;WAAA;;;;QAoBD,oDAAQ,GAAR;YAAA,iBAyBC;YAxBC,IAAI,CAAC,QAAQ,EAAE,CAAC;YAChB,IAAI,IAAI,CAAC,yBAAyB,EAAE;gBAClC,IAAI,IAAI,CAAC,yBAAyB,CAAC,WAAW,EAAE;oBAC9C,IAAI,CAAC,yBAAyB,CAAC,UAAU,GAAG,IAAI,CAAC,qBAAqB,CAAC;iBACxE;;gBAED,IAAI,CAAC,yBAAyB,CAAC,aAAa,GAAG,KAAK,CAAC;gBACrD,IAAI,CAAC,yBAAyB,CAAC,cAAc,CAAC,SAAS,CAAC,UAAC,KAAU;oBACjE,IAAM,UAAU,GAAG,KAAI,CAAC,WAAW,CAAC,UAAU,CAAC;oBAC/C,IAAM,EAAE,GAAG,KAAK,IAAI,KAAK,CAAC,YAAY,IAAI,KAAK,CAAC,YAAY,CAAC,UAAU,CAAC,CAAC;oBACzE,IAAI,EAAE,IAAI,EAAE,KAAK,KAAI,CAAC,WAAW,CAAC,SAAS,EAAE;wBAC3C,KAAI,CAAC,WAAW,CAAC,YAAY,CAAC,EAAE,EAAE,IAAI,CAAC,CAAC;qBACzC;iBACF,CAAC,CAAC;aACJ;YACD,IAAI,CAAC,WAAW,CAAC,OAAO,CAAC,SAAS,CAAC,UAAC,MAAc;;gBAEhD,IAAI,MAAM,CAAC,IAAI,KAAKS,iBAAU,CAAC,IAAI,IAAI,MAAM,CAAC,IAAI,KAAKA,iBAAU,CAAC,MAAM,IAAI,MAAM,CAAC,IAAI,KAAKA,iBAAU,CAAC,MAAM,IAAI,MAAM,CAAC,IAAI,KAAKA,iBAAU,CAAC,YAAY,IAAI,MAAM,CAAC,IAAI,KAAKA,iBAAU,CAAC,gBAAgB,EAAE;oBACvM,KAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC;oBACtB,KAAI,CAAC,gBAAgB,CAAC,MAAM,CAAC,CAAC;oBAC9B,KAAI,CAAC,YAAY,CAAC,MAAM,CAAC,CAAC;iBAC3B;aACF,CAAC,CAAC;YACH,IAAI,CAAC,SAAS,CAAC,EAAE,CAAC,CAAC;SACpB;;;;;QAMD,uDAAW,GAAX,UAAY,OAAsB;SACjC;QACO,iEAAqB,GAA7B,UAA8B,IAAS;YACrC,OAAO,EAAE,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,QAAQ,CAAC,KAAK,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC,CAAC;;SAElE;;;;;QAKO,oDAAQ,GAAhB,UAAiB,MAAe;YAC9B,IAAM,WAAW,GAAG,IAAI,CAAC,YAAY,CAAC,SAAS,CAAC,WAAW,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,GAAA,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;YAChG,IAAM,SAAS,GAAG,MAAM,IAAI,MAAM,CAAC,IAAI,IAAI,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,GAAA,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;;YAEhF,IAAI,MAAM,IAAI,CAACA,iBAAU,CAAC,gBAAgB,EAAEA,iBAAU,CAAC,MAAM,EAAEA,iBAAU,CAAC,IAAI,EAAEA,iBAAU,CAAC,MAAM,CAAC,CAAC,QAAQ,CAAC,MAAM,CAAC,IAAI,CAAC,EAAE;;gBAExH,IAAI,CAAC,WAAW,CAAC,UAAU,CAAC,SAAS,CAAC,EAAE;oBACtC,OAAO;iBACR;;gBAED,IAAI,MAAM,CAAC,IAAI,KAAKA,iBAAU,CAAC,gBAAgB,IAAI,WAAW,KAAK,SAAS,EAAE;oBAC5E,OAAO;iBACR;aACF;;YAED,IAAI,MAAM,IAAI,MAAM,CAAC,IAAI,KAAKA,iBAAU,CAAC,YAAY,IAAI,CAAC,SAAS,CAAC,UAAU,CAAC,WAAW,CAAC,EAAE;gBAC3F,OAAO;aACR;YACD,IAAM,SAAS,GAAG,IAAI,CAAC,YAAY,EAAE,CAAC;YACtC,IAAI,CAAC,IAAI,CAAC,qBAAqB,CAAC,SAAS,CAAC,EAAE;gBAC1C,OAAO;aACR;YACD,IAAI,IAAI,CAAC,YAAY,EAAE;gBACrB,IAAI,CAAC,QAAQ,GAAG,SAAS,CAAC;gBAC1B,IAAI,CAAC,YAAY,CAAC,SAAS,GAAG,SAAS,CAAC;gBACxC,IAAI,IAAI,CAAC,yBAAyB,IAAI,SAAS,IAAI,SAAS,CAAC,MAAM,GAAG,CAAC,EAAE;oBACvE,IAAM,WAAW,GAAG,SAAS,CAAC,GAAG,CAAC,UAAC,IAAS,IAAK,OAAA,IAAI,CAAC,YAAY,GAAA,CAAC,CAAC;oBACpE,IAAI,CAAC,yBAAyB,CAAC,WAAW,GAAG,WAAW,CAAC;iBAC1D;gBACD,IAAI,CAAC,gBAAgB,CAAC,SAAS,EAAE,MAAM,CAAC,CAAC;aAC1C;SACF;QACO,wDAAY,GAApB,UAAqB,MAAe;YAClC,IAAI,CAAC,IAAI,CAAC,yBAAyB,EAAE;gBACnC,OAAO;aACR;YACD,IAAM,WAAW,GAAG,IAAI,CAAC,YAAY,CAAC,SAAS,CAAC,WAAW,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,GAAA,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;YAChG,IAAM,SAAS,GAAG,MAAM,IAAI,MAAM,CAAC,IAAI,IAAI,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,GAAA,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;;YAEhF,IAAI,MAAM,IAAI,MAAM,CAAC,IAAI,KAAKA,iBAAU,CAAC,MAAM,IAAI,SAAS,KAAK,WAAW,EAAE;gBAC5E,IAAM,MAAM,GAAG,MAAM,CAAC,KAAK,IAAI,EAAE,CAAC;gBAClC,IAAM,KAAG,GAAU,IAAI,CAAC,YAAY,CAAC,OAAO,CAAC,KAAK,CAAC,IAAI,EAAE,CAAC;gBAC1D,IAAI,MAAM,CAAC,MAAM,GAAG,CAAC,IAAI,KAAG,CAAC,MAAM,GAAG,CAAC,EAAE;oBACvC,MAAM,CAAC,OAAO,CAAC,UAAC,EAAU;wBACxB,IAAM,KAAK,GAAG,KAAG,CAAC,OAAO,CAAC,EAAE,CAAC,CAAC;wBAC9B,IAAI,KAAK,KAAK,CAAC,CAAC,EAAE;4BAChB,KAAG,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC;yBACtB;qBACF,CAAC,CAAC;iBACJ;aACF;iBAAM,IAAI,CAAC,MAAM,CAAC,IAAI,KAAKA,iBAAU,CAAC,MAAM,IAAI,MAAM,CAAC,IAAI,KAAKA,iBAAU,CAAC,gBAAgB,KAAK,WAAW,CAAC,UAAU,CAAC,SAAS,CAAC,IAAI,WAAW,KAAK,SAAS,EAAE;;gBAE/J,IAAI,CAAC,SAAS,CAAC,EAAE,CAAC,CAAC;;gBAEnB,IAAI,CAAC,oBAAoB,EAAE,CAAC;aAC7B;iBAAM,IAAI,MAAM,IAAI,MAAM,CAAC,IAAI,KAAKA,iBAAU,CAAC,IAAI,KAAK,WAAW,KAAK,SAAS,IAAI,WAAW,CAAC,UAAU,CAAC,SAAS,CAAC,IAAI,WAAW,KAAK,SAAS,CAAC,EAAE;;gBAErJ,IAAI,CAAC,SAAS,CAAC,EAAE,CAAC,CAAC;;gBAEnB,IAAI,CAAC,oBAAoB,EAAE,CAAC;aAC7B;SACF;;;;;;QAMO,4DAAgB,GAAxB,UAAyB,IAAS,EAAE,MAAe;YAAnD,iBAkBC;YAjBC,IAAI,CAAC,IAAI,CAAC,yBAAyB,EAAE;gBACnC,OAAO;aACR;YACD,IAAM,UAAU,GAAG,MAAM,IAAI,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;YACnD,IAAM,KAAK,GAAG,IAAI,CAAC,YAAY,CAAC,SAAS,CAAC,WAAW,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,GAAA,CAAC,CAAC;YAChF,IAAM,IAAI,GAAG,KAAK,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;YAC7B,IAAM,oBAAoB,GAAG,IAAI,CAAC,UAAU,CAAC,UAAU,CAAC,IAAI,MAAM,CAAC,IAAI,KAAKA,iBAAU,CAAC,gBAAgB,IAAI,IAAI,KAAK,UAAU,CAAC;YAC/H,IAAM,eAAe,GAAG,MAAM,IAAI,MAAM,CAAC,IAAI,KAAKA,iBAAU,CAAC,MAAM,IAAI,IAAI,KAAK,UAAU,CAAC;YAC3F,IAAI,IAAI,IAAI,IAAI,CAAC,MAAM,GAAG,CAAC,IAAI,MAAM,KAAK,MAAM,CAAC,IAAI,KAAKA,iBAAU,CAAC,IAAI,IAAI,oBAAoB,IAAI,eAAe,CAAC,EAAE;gBACrH,IAAM,UAAU,GAAG,IAAI,CAAC,WAAW,CAAC,UAAU,CAAC;gBAC/C,IAAM,IAAE,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC,cAAc,CAAC,IAAI,IAAI,CAAC,CAAC,CAAC,CAAC,cAAc,CAAC,CAAC,UAAU,CAAC,CAAC;gBAC1E,IAAI,IAAI,CAAC,WAAW,CAAC,SAAS,KAAK,IAAE,EAAE;oBACrC,UAAU,CAAC;wBACT,KAAI,CAAC,WAAW,CAAC,YAAY,CAAC,IAAE,EAAE,IAAI,EAAE,IAAI,CAAC,CAAC;qBAC/C,EAAE,GAAG,CAAC,CAAC;iBACT;aACF;SACF;;;;;;QAMO,4DAAgB,GAAxB,UAAyB,MAAe;YACtC,IAAI,CAAC,IAAI,CAAC,WAAW,IAAI,CAAC,IAAI,CAAC,WAAW,CAAC,SAAS,IAAI,CAAC,IAAI,CAAC,yBAAyB,EAAE;gBACvF,OAAO;aACR;YACD,IAAI,MAAM,IAAI,MAAM,CAAC,IAAI,KAAKA,iBAAU,CAAC,gBAAgB,IAAI,MAAM,CAAC,IAAI,KAAKA,iBAAU,CAAC,IAAI,IAAI,MAAM,CAAC,IAAI,KAAKA,iBAAU,CAAC,MAAM,EAAE;gBACjI,OAAO;aACR;YACD,IAAM,SAAS,GAAG,IAAI,CAAC,yBAAyB,CAAC,cAAc,CAAC;;YAEhE,IAAM,EAAE,GAAG,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,WAAW,CAAC,WAAW,EAAE,IAAI,CAAC,SAAS,CAAC,CAAC;YAC7E,IAAI,EAAE,KAAK,SAAS,EAAE;gBACpB,OAAO;aACR;YACD,IAAI,CAAC,kBAAkB,CAAC,EAAE,CAAC,CAAC;SAC7B;;;;QAIO,wDAAY,GAApB;YAAA,iBAYC;YAXC,IAAM,QAAQ,GAAG,IAAI,CAAC,WAAW,CAAC,MAAM,EAAE,CAAC;YAC3C,IAAM,SAAS,GAAiB,EAAE,CAAC;YACnC,QAAQ,CAAC,OAAO,CAAC,UAAC,QAAa;gBAC7B,IAAM,QAAQ,GAAG,KAAI,CAAC,iBAAiB,CAAC,QAAQ,CAAC,CAAC;gBAClD,SAAS,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;aAC1B,CAAC,CAAC;;YAEH,IAAI,IAAI,CAAC,UAAU,EAAE;gBACnB,IAAI,CAAC,IAAI,CAAC,SAAS,EAAE,IAAI,CAAC,UAAU,EAAE,IAAI,CAAC,SAAS,CAAC,CAAC;aACvD;YACD,OAAO,SAAS,CAAC;SAClB;;;;;;QAMO,6DAAiB,GAAzB,UAA0B,QAAa;YAAvC,iBA4BC;;;YAzBC,IAAM,MAAM,GAAG,IAAI,CAAC,cAAc,CAAC,QAAQ,EAAE,IAAI,CAAC,SAAS,CAAC,CAAC;YAC7D,IAAM,QAAQ,GAAG,IAAI,CAAC,cAAc,CAAC,QAAQ,EAAE,IAAI,CAAC,WAAW,CAAC,CAAC;YACjE,IAAM,QAAQ,GAAG,IAAI,CAAC,cAAc,CAAC,QAAQ,EAAE,IAAI,CAAC,WAAW,CAAC,CAAC;YACjE,IAAM,cAAc,GAAG,IAAI,CAAC,cAAc,CAAC,QAAQ,EAAE,IAAI,CAAC,iBAAiB,CAAC,CAAC;YAE7E,IAAM,QAAQ,GAAQ;gBACpB,EAAE,EAAE,MAAM;gBACV,IAAI,EAAE,QAAQ;gBACd,IAAI,EAAE,QAAQ;gBACd,UAAU,EAAE,cAAc;gBAC1B,YAAY,EAAE,QAAQ;gBACtB,MAAM,EAAE;oBACN,UAAU,EAAE,MAAM;iBACnB;aACF,CAAC;YACF,IAAI,IAAI,CAAC,cAAc,IAAI,KAAK,CAAC,OAAO,CAAC,IAAI,CAAC,cAAc,CAAC,IAAI,IAAI,CAAC,cAAc,CAAC,MAAM,GAAG,CAAC,EAAE;gBAC/F,IAAI,CAAC,cAAc,CAAC,OAAO,CAAC,UAAC,IAAI;oBAC/B,QAAQ,CAAC,IAAI,CAAC,GAAG,CAAC,GAAG,KAAI,CAAC,cAAc,CAAC,QAAQ,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC;iBAC/D,CAAC,CAAC;aACJ;YACD,IAAI,IAAI,CAAC,gBAAgB,EAAE;gBACzB,IAAM,aAAa,GAAG,IAAI,CAAC,cAAc,CAAC,QAAQ,EAAE,IAAI,CAAC,gBAAgB,CAAC,CAAC;gBAC3E,QAAQ,CAAC,IAAI,CAAC,qBAAqB,CAAC,GAAG,aAAa,CAAC;aACtD;YACD,OAAO,QAAQ,CAAC;SACjB;;;;;QAKO,8DAAkB,GAA1B,UAA2B,EAAE;YAC3B,IAAI,IAAI,CAAC,yBAAyB,EAAE;gBAClC,IAAI,CAAC,yBAAyB,CAAC,cAAc,GAAG,EAAE,CAAC;aACpD;SACF;;;;;;QAMO,0DAAc,GAAtB,UAAuB,IAAS,EAAE,IAAY;YAC5C,IAAM,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;YAC7B,IAAI,YAAY,GAAG,IAAI,CAAC;YACxB,IAAI,CAAC,OAAO,CAAC,UAAC,GAAW;gBACvB,YAAY,GAAG,YAAY,IAAI,YAAY,CAAC,GAAG,CAAC,CAAC;aAClD,CAAC,CAAC;YACH,OAAO,YAAY,CAAC;SACrB;QACO,uDAAW,GAAnB;YACE,IAAM,KAAK,GAAG,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;YACxC,KAAK,CAAC,GAAG,EAAE,CAAC;YACZ,OAAO,KAAK,CAAC;SACd;QACD,sBAAY,0DAAW;iBAAvB;gBACE,IAAM,SAAS,GAAG,IAAI,CAAC,WAAW,EAAE,CAAC;gBACrC,OAAO,SAAS,CAAC,MAAM,CAAC,CAAC,UAAU,CAAC,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;aACjD;;;WAAA;QACD,sBAAY,gEAAiB;iBAA7B;gBACE,IAAM,SAAS,GAAG,IAAI,CAAC,WAAW,EAAE,CAAC;gBACrC,OAAO,SAAS,CAAC,MAAM,CAAC,CAAC,gBAAgB,CAAC,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;aACvD;;;WAAA;QACD,sBAAY,2DAAY;iBAAxB;gBACE,OAAO,IAAI,CAAC,gBAAgB,IAAI,IAAI,CAAC,yBAAyB,IAAI,IAAI,CAAC;aACxE;;;WAAA;QACO,qDAAS,GAAjB,UAAkB,GAAQ;YACxB,IAAI,CAAC,YAAY,CAAC,OAAO,CAAC,gBAAgB,CAAC,KAAK,EAAE,GAAG,CAAC,CAAC;SACxD;;;;QAIO,gEAAoB,GAA5B;YACE,IAAI,IAAI,CAAC,yBAAyB,EAAE;gBAClC,IAAI,CAAC,yBAAyB,CAAC,oBAAoB,EAAE,CAAC;aACvD;SACF;QACM,gDAAI,GAAX,UAAY,IAAW,EAAE,MAA8B,EAAE,UAAkC;YAA3F,iBA4CC;YA3CC,IAAI,CAAC,MAAM,IAAI,MAAM,CAAC,MAAM,GAAG,CAAC,IAAI,CAAC,UAAU,IAAI,UAAU,CAAC,MAAM,GAAG,CAAC,EAAE;gBACxE,MAAM,IAAI,KAAK,CAAC,uBAAuB,CAAC,CAAC;aAC1C;;YAED,IAAM,SAAS,GAAkB,OAAO,MAAM,KAAK,QAAQ,GAAG,MAAM,CAAC,KAAK,CAAC,GAAG,CAAC,GAAG,MAAM,IAAI,EAAE,CAAC;YAC/F,IAAM,aAAa,GAAkB,OAAO,UAAU,KAAK,QAAQ,GAAG,UAAU,CAAC,KAAK,CAAC,GAAG,CAAC,GAAG,UAAU,IAAI,EAAE,CAAC;;YAE/G,IAAI,SAAS,CAAC,MAAM,KAAK,aAAa,CAAC,MAAM,IAAI,SAAS,CAAC,MAAM,GAAG,CAAC,EAAE;gBACrE,MAAM,IAAI,KAAK,CAAC,wCAAwC,CAAC,CAAC;aAC3D;;YAED,IAAM,UAAU,GAAG,UAAC,KAAoB,EAAE,MAAqB;gBAAK,OAAA,UAAC,KAAU,EAAE,KAAU;oBACzF,OAAO,KAAK,CAAC,MAAM,CAAC,UAAC,MAAM,EAAE,IAAI;wBAC/B,IAAI,MAAM,KAAK,CAAC,EAAE;4BAChB,IAAM,KAAK,GAAG,CAAC,KAAK,CAAC,CAAC,QAAQ,CAAC,MAAM,CAAC,KAAK,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,CAAC;4BACrE,IAAM,UAAU,GAAG,KAAI,CAAC,QAAQ,CAAC,KAAK,EAAE,IAAI,CAAC,CAAC;4BAC9C,IAAM,UAAU,GAAG,KAAI,CAAC,QAAQ,CAAC,KAAK,EAAE,IAAI,CAAC,CAAC;4BAC9C,IAAI,UAAU,KAAK,IAAI,IAAI,UAAU,KAAK,SAAS,EAAE;gCACnD,OAAO,CAAC,CAAC;6BACV;4BACD,IAAI,UAAU,KAAK,IAAI,IAAI,UAAU,KAAK,SAAS,EAAE;gCACnD,OAAO,CAAC,CAAC,CAAC;6BACX;4BAED,IAAI,OAAO,UAAU,KAAK,OAAO,UAAU,EAAE;gCAC3C,IAAM,mBAAmB,GAAG,MAAM,CAAC,UAAU,CAAC,CAAC,aAAa,CAAC,MAAM,CAAC,UAAU,CAAC,CAAC,CAAC;gCACjF,MAAM,GAAG,mBAAmB,GAAG,KAAK,CAAC;6BACtC;iCAAM,IAAI,OAAO,UAAU,KAAK,QAAQ,IAAI,OAAO,UAAU,KAAK,QAAQ,EAAE;gCAC3E,IAAM,mBAAmB,GAAG,UAAU,CAAC,aAAa,CAAC,UAAU,CAAC,CAAC;gCACjE,MAAM,GAAG,mBAAmB,GAAG,KAAK,CAAC;6BACtC;iCAAM;gCACL,IAAI,UAAU,GAAG,UAAU,EAAE;oCAC3B,MAAM,GAAG,KAAK,GAAG,CAAC,CAAC;iCACpB;gCACD,IAAI,UAAU,GAAG,UAAU,EAAE;oCAC3B,MAAM,GAAG,KAAK,GAAG,CAAC,CAAC,CAAC;iCACrB;6BACF;yBACF;wBACD,OAAO,MAAM,CAAC;qBACf,EAAE,CAAC,CAAC,CAAC;iBACP;aAAA,CAAC;YACF,IAAI,CAAC,IAAI,CAAC,UAAU,CAAC,SAAS,EAAE,aAAa,CAAC,CAAC,CAAC;SACjD;QACO,oDAAQ,GAAhB,UAAiB,MAAW,EAAE,QAAgB;;YAC5C,IAAI,MAAM,YAAYwC,kBAAW,EAAE;gBACjC,MAAM,GAAG,MAAM,CAAC,WAAW,CAAC;aAC7B;iBAAM,IAAI,MAAM,YAAY3C,kBAAW,EAAE;gBACxC,MAAM,GAAG,MAAM,CAAC,IAAI,CAAC,WAAW,CAAC;aAClC;YACD,IAAI,MAAM,GAAG,IAAI,CAAC;YAClB,IAAI,QAAQ,CAAC,OAAO,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC,EAAE;gBAChC,MAAM,GAAG,MAAM,CAAC,QAAQ,CAAC,CAAC;aAC3B;iBAAM;gBACL,IAAM,KAAK,GAAG,QAAQ,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;;oBAClC,KAAmB,IAAA,UAAAK,SAAA,KAAK,CAAA,4BAAA,+CAAE;wBAArB,IAAM,IAAI,kBAAA;wBACb,MAAM,GAAG,MAAM,GAAG,IAAI,CAAC,QAAQ,CAAC,MAAM,EAAE,IAAI,CAAC,CAAC;qBAC/C;;;;;;;;;;;;;;;aACF;YACD,OAAO,MAAM,CAAC;SACf;;;;;QAMO,0DAAc,GADtB,UACuB,KAAY;YACjC,IAAM,UAAU,GAAG,IAAI,CAAC,WAAW,CAAC,UAAU,CAAC;YAC/C,IAAM,GAAG,GAAG,KAAK,IAAI,KAAK,CAAC,GAAG,CAAC,UAAC,IAAI,IAAK,OAAA,IAAI,IAAI,IAAI,CAAC,YAAY,IAAI,IAAI,CAAC,YAAY,CAAC,UAAU,CAAC,IAAI,EAAE,GAAA,CAAC,CAAC,MAAM,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,GAAA,CAAC,IAAI,EAAE,CAAC;YAChI,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,CAAC;SACrB;;;;;QAMO,yDAAa,GADrB,UACsB,KAAU;SAE/B;;oBAxZFd,cAAS,SAAC;wBACT,QAAQ,EAAE,4BAA4B;qBACvC;;;;;wBAPoBqD,sCAAqB,uBA8ErCrC,aAAQ;wBA/EsBY,mBAAY;wBACH0B,0CAAyB,uBAgFhEtC,aAAQ;wBAlFgDgC,aAAQ,uBAmFhEhC,aAAQ;;;;qCA/DVb,UAAK,SAAC,gBAAgB;sCAKtBA,UAAK,SAAC,iBAAiB;gCAKvBA,UAAK,SAAC,iBAAiB;uCAKvBA,UAAK,SAAC,wBAAwB;kCAK9BA,UAAK,SAAC,mBAAmB;qCA0WzBC,iBAAY,SAAC,4BAA4B,EAAE,CAAC,QAAQ,CAAC;oCAUrDA,iBAAY,SAAC,gBAAgB,EAAE,CAAC,QAAQ,CAAC;;QAI5C,wCAAC;KAzZD;;ICFA,IAAM,yBAAyB,GAAG,+BAA+B,CAAC;IAClE,IAAM,0BAA0B,GAAG,cAAc,CAAC;AAElD;QAsBE,gDAAmB,QAAkB,EAAS,yBAAoD,EAAS,SAAoB;YAA5G,aAAQ,GAAR,QAAQ,CAAU;YAAS,8BAAyB,GAAzB,yBAAyB,CAA2B;YAAS,cAAS,GAAT,SAAS,CAAW;SAC9H;QAED,yDAAQ,GAAR;YAAA,iBAcC;YAbC,IAAI,CAAC,yBAAyB,CAAC,SAAS,GAAG,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,yBAAyB,CAAC,IAAI,EAAE,CAAC;YAC/H,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,OAAO,CAAC,SAAS,CAAC,UAAC,MAA8B;gBAClG,IAAI,MAAM,CAAC,KAAK,KAAK,yBAAyB,EAAE;oBAC9C,KAAI,CAAC,yBAAyB,CAAC,SAAS,GAAG,KAAI,CAAC,SAAS,CAAC,YAAY,CAAC,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,yBAAyB,CAAC,IAAI,EAAE,CAAC;iBAChI;aACF,CAAC,CAAC;YACH,IAAI,IAAI,CAAC,2BAA2B,EAAE;gBACpC,IAAI,CAAC,oBAAoB,EAAE,CAAC;aAC7B;iBAAM;gBACL,IAAI,CAAC,YAAY,EAAE,CAAC;aACrB;YAED,IAAI,CAAC,YAAY,EAAE,CAAC;SACrB;;;;QAIO,6DAAY,GAApB;YAAA,iBAOC;YANC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,mBAAmB,CAAC,CAAC,SAAS,CAAC,UAAA,MAAM;gBACrD,IAAI,CAAC,MAAM,EAAE;oBACX,OAAO;iBACR;gBACD,KAAI,CAAC,yBAAyB,CAAC,WAAW,GAAG,MAAM,CAAC;aACrD,CAAC,CAAC;SACJ;;;;QAIO,6DAAY,GAApB;YAAA,iBAQC;YAPC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,gBAAgB,CAAC,CAAC,SAAS,CAAC,UAAA,MAAM;gBAClD,IAAI,CAAC,MAAM,EAAE;oBACX,OAAO;iBACR;gBACO,IAAA,iBAAU,EAAV,+BAAU,CAAY;gBAC9B,KAAI,CAAC,yBAAyB,CAAC,UAAU,GAAG,KAAK,CAAC;aACnD,CAAC,CAAC;SACJ;;;;QAIO,qEAAoB,GAA5B;YAAA,iBAOC;YANC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,2BAA2B,CAAC,CAAC,SAAS,CAAC,UAAA,MAAM;gBAC7D,IAAI,CAAC,MAAM,EAAE;oBACX,OAAO;iBACR;gBACD,KAAI,CAAC,yBAAyB,CAAC,UAAU,GAAG,MAAM,IAAI,MAAM,CAAC,KAAK,IAAI,EAAE,CAAC;aAC1E,CAAC,CAAC;SACJ;;;;;QAMM,mEAAkB,GADzB,UAC0B,KAAU;YADpC,iBAeC;YAbO,IAAA,gBAA6E,EAA3E,eAAW,EAAX,gCAAW,EAAE,YAAS,EAAT,8BAAS,EAAE,kBAAkB,EAAlB,uCAAkB,EAAE,gBAAe,EAAf,oCAA+B,CAAC;YACpF,IAAI,OAAO,KAAK,CAAC,EAAE;gBACjB,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,iBAAiB,EAAE,EAAE,IAAI,MAAA,EAAE,QAAQ,UAAA,EAAE,UAAU,YAAA,EAAE,CAAC,CAAC,IAAI,CACvEmD,aAAG,CAAC;oBACF,KAAI,CAAC,SAAS,CAAC,YAAY,CAAC,UAAU,CAAC,WAAW,CAAC,IAAI,CAAC,0BAA0B,CAAC,CAAC;iBACrF,CAAC,EACFC,oBAAU,CAAC,UAAA,CAAC,IAAI,OAAAC,UAAK,GAAA,CAAC,CACvB,CAAC,SAAS,EAAE,CAAC;aACf;iBAAM;;gBAEL,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,yBAAyB,CAAC,GAAG,EAAE,CAAC;gBACnF,IAAI,CAAC,yBAAyB,CAAC,SAAS,GAAG,EAAE,CAAC;aAC/C;SACF;;;;;QAKO,wDAAO,GAAf,UAAgB,WAAmB,EAAE,MAAY;YAAjD,iBAgBC;YAfC,IAAI,CAAC,WAAW,IAAI,WAAW,KAAK,EAAE,IAAI,WAAW,KAAK,WAAW,EAAE;gBACrE,OAAO5C,OAAE,CAAC,IAAI,CAAC,CAAC;aACjB;YACD,IAAI,OAAO,MAAM,KAAK,WAAW,EAAE;gBACjC,MAAM,GAAG,EAAE,CAAC;aACb;YACD,IAAM,KAAK,GAAG,WAAW,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;YACrC,IAAI,IAAI,GAAG,IAAI,CAAC;YAChB,KAAK,CAAC,OAAO,CAAC,UAAA,IAAI;gBAChB,IAAI,GAAG,IAAI,IAAI,IAAI,CAAC,IAAI,CAAC,IAAI,KAAI,CAAC,IAAI,CAAC,CAAC;aACzC,CAAC,CAAC;YACH,IAAI,OAAO,IAAI,KAAK,UAAU,EAAE;gBAC9B,OAAO,IAAI,CAAC,MAAM,CAAC,CAAC;aACrB;YACD,OAAOA,OAAE,CAAC,IAAI,CAAC,CAAC;SACjB;;oBAlHFb,cAAS,SAAC;wBACT,QAAQ,EAAE,oCAAoC;qBAC/C;;;;;wBAVmBgD,aAAQ;wBACnBU,yCAAyB;wBACzBpD,gBAAS;;;;uCAcfH,UAAK,SAAC,kBAAkB;wCAIxBA,UAAK,SAAC,mBAAmB;0CAIzBA,UAAK,SAAC,qBAAqB;kDAI3BA,UAAK,SAAC,6BAA6B;yCA0DnCC,iBAAY,SAAC,aAAa,EAAE,CAAC,QAAQ,CAAC;;QAqCzC,6CAAC;KAnHD;;ICHA,IAAMuD,2BAAyB,GAAG,+BAA+B,CAAC;IAClE,IAAMC,4BAA0B,GAAG,cAAc,CAAC;AAClD;QAQE,8CAAmB,QAAkB,EAAS,uBAAgD,EAAS,SAAoB,EAAS,uBAAgD;YAAjK,aAAQ,GAAR,QAAQ,CAAU;YAAS,4BAAuB,GAAvB,uBAAuB,CAAyB;YAAS,cAAS,GAAT,SAAS,CAAW;YAAS,4BAAuB,GAAvB,uBAAuB,CAAyB;SAEnL;QACD,uDAAQ,GAAR;YAAA,iBAWC;YAVC,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC,UAAU,CAAC,WAAW,CAAC,SAAS,CAAC,UAAC,OAAY;gBACxE,IAAI,OAAO,KAAKA,4BAA0B,EAAE;oBAC1C,KAAI,CAAC,aAAa,EAAE,CAAC;iBACtB;aACF,CAAC,CAAC;YACH,IAAI,CAAC,SAAS,CAAC,WAAW,CAAC,OAAO,CAAC,SAAS,CAAC,UAAC,MAAc;gBAC1D,IAAI,MAAM,CAAC,IAAI,KAAKhD,iBAAU,CAAC,IAAI,IAAI,MAAM,CAAC,IAAI,KAAKA,iBAAU,CAAC,gBAAgB,EAAE;oBAClF,KAAI,CAAC,aAAa,EAAE,CAAC;iBACtB;aACF,CAAC,CAAC;SACJ;;;;QAIO,4DAAa,GAArB,UAAsB,SAAkB,EAAE,QAAiB;YAA3D,iBA0BC;YAzBC,IAAI,OAAO,SAAS,KAAK,WAAW,EAAE;gBACpC,SAAS,GAAG,CAAC,IAAI,CAAC,uBAAuB,CAAC,SAAS,GAAG,CAAC,KAAK,CAAC,CAAC;aAC/D;YACD,IAAI,OAAO,QAAQ,KAAK,WAAW,EAAE;gBACnC,IAAI,IAAI,CAAC,uBAAuB,CAAC,aAAa,EAAE;oBAC9C,QAAQ,GAAG,IAAI,CAAC,uBAAuB,CAAC,QAAQ,CAAC;iBAClD;qBAAM;;oBAEL,QAAQ,GAAG,KAAK,CAAC;iBAClB;aACF;YACD,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,oBAAoB,EAAE,EAAE,SAAS,WAAA,EAAE,QAAQ,UAAA,EAAE,CAAC,CAAC,IAAI,CACnE4C,oBAAU,CAAC,UAAA,CAAC,IAAI,OAAAC,UAAK,GAAA,CAAC,CACvB,CAAC,SAAS,CAAC,UAAA,MAAM;gBAChB,IAAI,CAAC,MAAM,EAAE;oBACX,OAAO;iBACR;gBACO,IAAA,oBAAa,EAAb,AAAe,qBAAa,EAAb,kCAAa,EAAE,oBAAa,EAAb,kCAAa,EAAE,sBAAc,EAAd,mCAAc,CAAY;gBAC/E,KAAI,CAAC,uBAAuB,CAAC,SAAS,GAAG,QAAQ,CAAC,SAAS,CAAC,GAAG,CAAC,CAAC;gBACjE,IAAI,KAAI,CAAC,uBAAuB,CAAC,aAAa,EAAE;oBAC9C,KAAI,CAAC,uBAAuB,CAAC,QAAQ,GAAG,QAAQ,CAAC;iBAClD;gBACD,KAAI,CAAC,uBAAuB,CAAC,KAAK,GAAG,UAAU,CAAC;gBAChD,KAAI,CAAC,uBAAuB,CAAC,kBAAkB,GAAG,MAAM,CAAC;aAC1D,CAAC,CAAC;SACJ;;;;;QAMM,mEAAoB,GAD3B,UAC4B,KAAU;YACpC,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,gBAAgB,CAACE,2BAAyB,EAAE,KAAK,CAAC,CAAC;SACvG;;;;;QAMM,iEAAkB,GADzB,UAC0B,KAAU;YAC5B,IAAA,yBAAuD,EAArD,iBAAa,EAAb,kCAAa,EAAE,gBAAa,EAAb,kCAAsC,CAAC;YAC9D,IAAI,CAAC,aAAa,CAAC,SAAS,GAAG,CAAC,EAAE,QAAQ,CAAC,CAAC;SAC7C;;;;;QAKO,sDAAO,GAAf,UAAgB,WAAmB,EAAE,MAAY;YAAjD,iBAaC;YAZC,IAAI,CAAC,WAAW,IAAI,WAAW,KAAK,EAAE,IAAI,WAAW,KAAK,WAAW,EAAE;gBACrE,OAAO9C,OAAE,CAAC,IAAI,CAAC,CAAC;aACjB;YACD,IAAM,KAAK,GAAG,WAAW,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;YACrC,IAAI,IAAI,GAAG,IAAI,CAAC;YAChB,KAAK,CAAC,OAAO,CAAC,UAAA,IAAI;gBAChB,IAAI,GAAG,IAAI,IAAI,IAAI,CAAC,IAAI,CAAC,IAAI,KAAI,CAAC,IAAI,CAAC,CAAC;aACzC,CAAC,CAAC;YACH,IAAI,OAAO,IAAI,KAAK,UAAU,EAAE;gBAC9B,OAAO,IAAI,CAAC,MAAM,CAAC,CAAC;aACrB;YACD,OAAOA,OAAE,CAAC,IAAI,CAAC,CAAC;SACjB;;oBAvFFb,cAAS,SAAC;wBACT,QAAQ,EAAE,kCAAkC;qBAC7C;;;;;wBAR0BgD,aAAQ;wBAC1Ba,uCAAuB;wBACvBvD,gBAAS;wBADgBwD,uCAAuB;;;;2CAYtD3D,UAAK,SAAC,sBAAsB;2CAkD5BC,iBAAY,SAAC,cAAc,EAAE,CAAC,QAAQ,CAAC;yCAQvCA,iBAAY,SAAC,aAAa,EAAE,CAAC,QAAQ,CAAC;;QAuBzC,2CAAC;KAxFD;;ICPA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;QA6OE,gDACU,SAAoB,EACpB,YAA0B,EAC1B,WAAkC;YAFlC,cAAS,GAAT,SAAS,CAAW;YACpB,iBAAY,GAAZ,YAAY,CAAc;YAC1B,gBAAW,GAAX,WAAW,CAAuB;YAlDpC,kBAAa,GAAG,IAAI,CAAC;YACrB,2BAAsB,GAAG,IAAI,CAAC;;;;YAiB5B,qBAAgB,GAAsB,IAAIM,iBAAY,EAAO,CAAC;YAEhE,mBAAc,GAA6C,EAAE,CAAC;SA+BjE;QApBL,sBAAY,+DAAW;;;;iBAAvB;gBACE,OAAO,IAAI,CAAC,YAAY,CAAC,WAAW,CAAC;aACtC;;;WAAA;QAKD,sBAAY,+DAAW;;;;iBAAvB;gBACE,OAAO,IAAI,CAAC,WAAW,CAAC,OAAO,EAAE,CAAC;aACnC;;;WAAA;QAEO,sEAAqB,GAA7B;YACE,IAAI,KAAK,GAAG,IAAI,CAAC,gBAAgB,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;YAC7C,OAAO,KAAK,CAAC,KAAK,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;SAChC;QAQD,4DAAW,GAAX,UAAY,OAAsB;SACjC;QAED,yDAAQ,GAAR;YAAA,iBAcC;;YAZC,IAAI,CAAC,kBAAkB,GAAG,IAAI,CAAC,qBAAqB,EAAE,CAAC;;YAEvD,IAAM,uBAAuB,GAAG,IAAI,CAAC,YAAY,CAAC,0BAA0B,EAAE,CAAC;YAC/E,uBAAuB,CAAC,QAAQ,CAAC,kBAAkB,EAAE,IAAI,CAAC,gBAAgB,CAAC,CAAC;YAC5E,IAAI,CAAC,WAAW,CAAC,OAAO,CAAC,SAAS,CAAC,UAAC,MAAc;gBAChD,KAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC;gBACtB,KAAI,CAAC,iBAAiB,CAAC,MAAM,CAAC,CAAC;aAChC,CAAC,CAAC;YACH,IAAI,CAAC,YAAY,CAAC,SAAS,CAAC,OAAO,CAAC,gBAAgB,CAAC,KAAK,EAAE,EAAE,CAAC,CAAC;YAChE,IAAI,IAAI,CAAC,YAAY,IAAI,IAAI,CAAC,YAAY,CAAC,cAAc,EAAE;gBACzD,IAAI,CAAC,YAAY,CAAC,cAAc,CAAC,aAAa,GAAGC,oBAAa,CAAC,oBAAoB,CAAC;aACrF;SACF;;;;;QAMO,6DAAY,GAApB;YACE,IAAM,gBAAgB,GAAG,IAAI,CAAC,YAAY,CAAC,UAAU,CAAC,gBAAgB,CAAC;YACvE,IAAM,WAAW,GAAW,IAAI,CAAC,YAAY,CAAC,WAAW,CAAC,WAAW,CAAC;YACtE,IAAI,CAAC,WAAW,IAAI,WAAW,KAAK,GAAG,EAAE;gBACvC,OAAO,gBAAgB,CAAC,OAAO,EAAE,CAAC;aACnC;YACD,IAAI,WAAW,GAAgB,IAAI,CAAC,YAAY,CAAC,WAAW,CAAC,IAAI,CAAC;YAClE,IAAI,cAAc,GAAa,WAAW,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAA,GAAG,IAAI,OAAA,GAAG,GAAA,CAAC,CAAC;YACzE,IAAI,SAAS,GAAG,EAAE,CAAC;YACnB,cAAc,CAAC,OAAO,CAAC,UAAC,IAAY;gBAClC,SAAS,CAAC,IAAI,CAAI,WAAW,CAAC,UAAU,SAAI,WAAW,CAAC,SAAW,CAAC,CAAC;gBACrE,SAAS,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;gBACrB,WAAW,GAAG,WAAW,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC;aAC7C,CAAC,CAAC;YACH,OAAQ,gBAAgB,CAAC,iBAAiB,CAAC,SAAS,CAAqB,CAAC,OAAO,EAAE,CAAC;SACrF;;;;;;QAMO,+DAAc,GAAtB,UAAuB,SAAmB,EAAE,SAAqB;YAAjE,iBASC;YARC,IAAI,SAAS,CAAC,MAAM,GAAG,CAAC;gBACtB,OAAO;;YAET,IAAI,OAAO,GAAG,EAAE,KAAK,EAAE,CAAC,EAAE,CAAC;YAC3B,IAAM,UAAU,GAAW,SAAS,CAAC,CAAC,CAAC,CAAC,UAAU,CAAC;YACnD,SAAS,CAAC,OAAO,CAAC,UAAC,QAAQ;gBACzB,KAAI,CAAC,YAAY,CAAC,QAAQ,EAAE,OAAO,EAAE,SAAS,EAAE,UAAU,CAAC,CAAC;aAC7D,CAAC,CAAC;SACJ;;;;;;;;;;;;QAYO,6DAAY,GAApB,UAAqB,QAAkB,EAAE,OAA0B,EAAE,SAAmB,EAAE,UAAkB;YAA5G,iBAcC;YAbC,IAAM,WAAW,GAAG,kBAAkB,CAAC;;YAEvC,IAAM,MAAM,GAAG,SAAS,CAAC,IAAI,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,CAAC,UAAU,CAAC,KAAK,QAAQ,CAAC,IAAI,CAAC,UAAU,CAAC,GAAA,CAAC,CAAC;YAChF,IAAI,MAAM,EAAE;gBACV,MAAM,CAAC,cAAc,CAAC,MAAM,EAAE,WAAW,EAAE;oBACzC,KAAK,EAAE,OAAO,CAAC,KAAK;iBACrB,CAAC,CAAC;gBACH,OAAO,CAAC,KAAK,EAAE,CAAC;aACjB;;YAED,QAAQ,CAAC,QAAQ,CAAC,OAAO,CAAC,UAAC,QAAQ;gBACjC,KAAI,CAAC,YAAY,CAAC,QAAQ,EAAE,OAAO,EAAE,SAAS,EAAE,UAAU,CAAC,CAAC;aAC7D,CAAC,CAAC;SACJ;;;;;;;;;QAUO,6DAAY,GAApB,UAAqB,MAAe;;YAElC,IAAI,CAAC,MAAM;gBACT,OAAO,KAAK,CAAC;;YAEf,QAAQ,MAAM,CAAC,IAAI;gBACjB,KAAKC,iBAAU,CAAC,gBAAgB;oBAC9B,OAAO,IAAI,CAAC,sBAAsB,CAAC,MAAM,CAAC,CAAC;gBAC7C,KAAKA,iBAAU,CAAC,sBAAsB;oBACpC,OAAO,IAAI,CAAC,sBAAsB,CAAC,MAAM,CAAC,CAAC;gBAC7C,KAAKA,iBAAU,CAAC,YAAY;oBAC1B,OAAO,IAAI,CAAC,kBAAkB,CAAC,MAAM,CAAC,CAAC;gBACzC;oBACE,OAAO,KAAK,CAAC;aAChB;SACF;;;;;;QAMO,uEAAsB,GAA9B,UAA+B,MAAc;;YAE3C,IAAI,MAAM,CAAC,IAAI,KAAKA,iBAAU,CAAC,gBAAgB,IAAI,MAAM,CAAC,IAAI,KAAKA,iBAAU,CAAC,sBAAsB,EAAE;gBACpG,IAAI,IAAI,GAAG,MAAM,CAAC,IAAI,CAAC;gBACvB,IAAI,OAAO,GAAG,IAAI,CAAC,WAAW,CAAC,WAAW,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAA,GAAG,IAAI,OAAA,GAAG,GAAA,CAAC,CAAC;gBACzE,IAAI,IAAI,CAAC,MAAM,KAAK,OAAO,CAAC,MAAM,EAAE;oBAClC,IAAI,IAAI,GAAG,IAAI,CAAC;oBAChB,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;wBACpC,IAAI,IAAI,CAAC,CAAC,CAAC,KAAK,OAAO,CAAC,CAAC,CAAC;4BACxB,IAAI,GAAG,KAAK,CAAC;qBAChB;oBACD,IAAI,IAAI;wBACN,OAAO,IAAI,CAAC;iBACf;aACF;YACD,OAAO,KAAK,CAAC;SACd;;;;;;QAMO,mEAAkB,GAA1B,UAA2B,MAAc;;YACvC,IAAI,MAAM,CAAC,IAAI,KAAKA,iBAAU,CAAC,YAAY,EAAE;gBAC3C,OAAO,KAAK,CAAC;aACd;;YAED,IAAI,IAAI,GAAG,MAAM,CAAC,IAAI,CAAC;YACvB,IAAI,cAAc,GAAG,IAAI,CAAC,WAAW,CAAC,WAAW,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAA,GAAG,IAAI,OAAA,GAAG,GAAA,CAAC,CAAC;;;gBAEhF,KAAiB,IAAA,mBAAAE,SAAA,cAAc,CAAA,8CAAA,0EAAE;oBAA5B,IAAI,IAAI,2BAAA;oBACX,IAAI,IAAI,CAAC,MAAM,GAAG,CAAC,EAAE;wBACnB,IAAI,IAAI,KAAK,IAAI,CAAC,CAAC,CAAC,EAAE;4BACpB,IAAI,CAAC,KAAK,EAAE,CAAC;yBACd;6BAAM;4BACL,OAAO,KAAK,CAAC;yBACd;qBACF;iBACF;;;;;;;;;;;;;;;;YAED,IAAI,EAAE,GAAG,MAAM,CAAC,EAAE,CAAC;YACnB,IAAI,EAAE,EAAE;gBACN,IAAM,UAAU,GAAG,IAAI,CAAC,WAAW,CAAC,UAAU,CAAC;gBAC/C,IAAI,KAAK,GAAG,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC;gBACjC,IAAI,UAAU,GAAG,IAAI,CAAC;;oBACtB,KAAiB,IAAA,UAAAA,SAAA,KAAK,CAAA,4BAAA,+CAAE;wBAAnB,IAAI,IAAI,kBAAA;wBACX,IAAI,MAAM,GAAG,IAAI,CAAC,gBAAgB,CAAC,IAAI,EAAE,UAAU,EAAE,EAAE,CAAC,CAAC;wBACzD,IAAI,MAAM,EAAE;4BACV,UAAU,GAAG,MAAM,CAAC;4BACpB,MAAM;yBACP;qBACF;;;;;;;;;;;;;;;gBACD,IAAI,UAAU,IAAI,IAAI,CAAC,MAAM,KAAK,CAAC,EAAE;oBACnC,IAAM,YAAY,GAAG,IAAI,CAAC,KAAK,EAAE,CAAC;oBAClC,IAAI,UAAU,CAAC,IAAI,CAAC,cAAc,CAAC,YAAY,CAAC,IAAI,MAAM,CAAC,cAAc,CAAC,OAAO,CAAC,EAAE;wBAClF,UAAU,CAAC,IAAI,CAAC,YAAY,CAAC,GAAG,MAAM,CAAC,KAAK,CAAC;wBAC7C,OAAO,IAAI,CAAC;qBACb;iBACF;aACF;YACD,OAAO,KAAK,CAAC;SACd;;;;;;;;;QASO,iEAAgB,GAAxB,UAAyB,QAAkB,EAAE,UAAkB,EAAE,QAAa;;YAC5E,IAAI,CAAC,QAAQ;gBACX,OAAO,IAAI,CAAC;YACd,IAAI,QAAQ,CAAC,IAAI,CAAC,cAAc,CAAC,UAAU,CAAC,IAAI,QAAQ,CAAC,IAAI,CAAC,UAAU,CAAC,KAAK,QAAQ;gBACpF,OAAO,QAAQ,CAAC;YAClB,IAAI,QAAQ,CAAC,QAAQ,EAAE;;oBACrB,KAAiB,IAAA,KAAAA,SAAA,QAAQ,CAAC,QAAQ,CAAA,gBAAA,4BAAE;wBAA/B,IAAI,IAAI,WAAA;wBACX,IAAI,MAAM,GAAG,IAAI,CAAC,gBAAgB,CAAC,IAAI,EAAE,UAAU,EAAE,QAAQ,CAAC,CAAC;wBAC/D,IAAI,MAAM;4BACR,OAAO,MAAM,CAAC;qBACjB;;;;;;;;;;;;;;;aACF;YACD,OAAO,IAAI,CAAC;SACb;;;;QAKO,yDAAQ,GAAhB,UAAiB,MAAe;YAC9B,IAAI,WAAW,GAAY,IAAI,CAAC,YAAY,CAAC,MAAM,CAAC,CAAC;YACrD,IAAI,WAAW,EAAE;gBACf,OAAO;aACR;;YAED,IAAM,YAAY,GAAG,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC;YAC1C,IAAM,aAAa,GAAG,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC,EAAE,oBAAoB,EAAE,IAAI,EAAE,CAAC,CAAC;YAC9E,IAAI,SAAS,GAAe,EAAE,CAAC;YAE/B,IAAI,aAAa,IAAI,aAAa,CAAC,MAAM,GAAG,CAAC,EAAE;gBAC7C,IAAI,aAAa,GAAG,aAAa,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,kBAAkB,CAAC,CAAC;gBAC9D,IAAM,OAAO,GAAc,sBAAsB,CAAC,UAAU,CAAC,aAAa,CAAC,CAAC;;gBAE5E,IAAI,OAAO,IAAI,IAAI,EAAE;oBACnB,MAAM,IAAI,KAAK,CAAC,4BAA4B,CAAC,CAAC;iBAC/C;gBACD,IAAI,WAAW,GAAG,CAAC,CAAC,CAAC;gBACrB,IAAM,eAAe,GAAG,IAAI,CAAC,SAAS,CAAC,aAAa,CAAC,CAAC;gBACtD,IAAI,OAAO,eAAe,KAAK,WAAW,EAAE;oBAC1C,WAAW,GAAG,eAAe,CAAC;iBAC/B;gBACD,IAAM,OAAO,GAAG;oBACd,WAAW,aAAA;oBACX,SAAS,EAAE,IAAI,CAAC,SAAS;iBAC1B,CAAC;gBACF,IAAM,gBAAgB,GAAG,IAAI,OAAO,CAClC,aAAa,EAAE,YAAY,EAC3B,IAAI,CAAC,WAAW,CAAC,UAAU,EAAE,IAAI,CAAC,kBAAkB,EAAE,OAAO,CAC9D,CAAC;gBACF,SAAS,GAAG,gBAAgB,CAAC,KAAK,EAAE,CAAC;;gBAErC,IAAI,SAAS,GAAa,IAAI,CAAC,YAAY,EAAE,CAAC;;gBAE9C,IAAI,CAAC,cAAc,CAAC,SAAS,EAAE,SAAS,CAAC,CAAC;aAC3C;YAED,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,IAAI,EAAE;gBACxB,IAAI,CAAC,SAAS,CAAC,YAAY,IAAI,IAAI,CAAC,SAAS,CAAC,MAAM,GAAG,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;gBACzF,IAAI,IAAI,CAAC,SAAS,CAAC,QAAQ,IAAI,QAAQ,IAAI,IAAI,CAAC,SAAS,CAAC,SAAS;oBACjE,IAAI,CAAC,SAAS,CAAC,UAAU,EAAE,CAAC;qBACzB,IAAI,IAAI,CAAC,SAAS,CAAC,QAAQ,IAAI,UAAU,IAAI,IAAI,CAAC,SAAS,CAAC,aAAa;oBAC5E,IAAI,CAAC,SAAS,CAAC,YAAY,EAAE,CAAC;qBAC3B,IAAI,IAAI,CAAC,SAAS,CAAC,SAAS,EAAE;oBACjC,IAAI,CAAC,SAAS,CAAC,OAAO,EAAE,CAAC;aAC5B;YACD,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC,UAAU,CAAC,SAAS,CAAC,CAAC;YAClD,IAAI,CAAC,SAAS,CAAC,KAAK,GAAG,SAAS,CAAC;YACjC,IAAI,CAAC,SAAS,CAAC,qBAAqB,EAAE,CAAC;;;;;SAMxC;QACO,kEAAiB,GAAzB,UAA0B,MAAc;YACtC,IAAM,SAAS,GAAG,IAAI,CAAC,WAAW,CAAC,SAAS,CAAC;YAC7C,IAAI,IAAI,CAAC,sBAAsB,EAAE;gBAC/B,IAAI,CAAC,sBAAsB,GAAG,KAAK,CAAC;gBACpC,IAAI,CAAC,aAAa,GAAG,SAAS,CAAC;gBAC/B,OAAO;aACR;YACD,IAAM,eAAe,GAAG,IAAI,CAAC,SAAS,CAAC,eAAe,CAAC;YAEvD,IAAM,QAAQ,GAAG,eAAe,IAAI,eAAe,CAAC,IAAI,CAAC,UAAA,IAAI,IAAI,OAAA,IAAI,IAAI,IAAI,CAAC,IAAI,IAAI,IAAI,CAAC,IAAI,CAAC,IAAI,IAAI,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,KAAK,SAAS,GAAA,CAAC,IAAI,IAAI,CAAC;YACjJ,IAAI,QAAQ,EAAE;gBACZ,IAAI,IAAI,CAAC,SAAS,CAAC,UAAU,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,SAAS,KAAK,IAAI,CAAC,aAAa,EAAE;oBAChF,OAAO;iBACR;gBACD,IAAI,CAAC,aAAa,GAAG,SAAS,CAAC;gBAC/B,IAAI,CAAC,SAAS,CAAC,cAAc,CAAC,EAAE,OAAO,EAAE,QAAQ,EAAE,aAAa,EAAE,EAAE,MAAM,EAAE,EAAE,QAAQ,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,CAAC;aACnG;SACF;QAEM,kEAAiB,GADxB,UACyB,KAAU;YACjC,IAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC,CAAC;YAC1C,IAAM,EAAE,GAAG,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;YACpC,IAAI,CAAC,yBAAyB,CAAC,EAAE,CAAC,CAAC;SACpC;QAIM,sEAAqB,GAD5B,UAC6B,KAAU;YACrC,IAAI,SAAS,GAAG,KAAK,CAAC,KAAK,CAAC;YAC5B,IAAMpB,SAAM,GAAG,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,UAAA,IAAI,IAAI,OAAA,IAAI,CAAC,KAAK,KAAK,SAAS,GAAA,CAAC,CAAC;YACnE,IAAI,SAAS,IAAIA,SAAM,IAAIA,SAAM,CAAC,MAAM,IAAIA,SAAM,CAAC,MAAM,CAAC,OAAO,IAAIA,SAAM,CAAC,MAAM,CAAC,OAAO,CAAC,IAAI,KAAK,oBAAoB,EAAE;gBACxH,OAAO;aACR;YACD,IAAI,KAAK,IAAI,KAAK,CAAC,cAAc,CAAC,MAAM,CAAC,EAAE;gBACzC,IAAM,eAAe,GAAG,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,YAAY,CAAC,UAAU,CAAC,UAAU,CAAC,CAAC;gBAE5E,IAAI,KAAK,GAAQ,IAAI,CAAC,QAAQ,CAAC,SAAS,EAAE,KAAK,CAAC,IAAI,CAAC,CAAC;gBACtD,IAAM,WAAW,GAAG,IAAI,CAAC,YAAY,CAAC,SAAS,CAAC,WAAW,IAAI,GAAG,CAAC;gBACnE,IAAM,YAAY,GAAG,WAAW,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,GAAA,CAAC,CAAC;gBAC3D,IAAM,WAAW,GAAgB,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC,YAAY,CAAC,CAAC;gBACzE,IAAM,aAAa,GAAG,WAAW,CAAC,QAAQ,CAAC,eAAe,CAAC,CAAC;gBAC5D,IAAM,QAAQ,GAAG,IAAI,CAAC,QAAQ,CAAC,SAAS,EAAE,aAAa,CAAC,CAAC;gBACzD,IAAM,QAAM,GAAG,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,IAAI,CAAC,UAAA,IAAI,IAAI,OAAA,IAAI,CAAC,KAAK,KAAK,SAAS,GAAA,CAAC,CAAC;gBAC7E,IAAM,QAAQ,GAAG,QAAM,IAAI,QAAM,CAAC,QAAQ,IAAI,IAAI,CAAC;gBACnD,IAAI,QAAQ,KAAK,MAAM,IAAI,QAAQ,KAAK,UAAU,EAAE;oBAClD,IAAI,IAAI,CAAC,WAAW,EAAE;wBACpB,IAAM,MAAM,GAAG,QAAM,IAAI,QAAM,CAAC,SAAS,IAAI,QAAM,CAAC,SAAS,CAAC,OAAO,IAAI,QAAM,CAAC,SAAS,CAAC,OAAO,CAAC,MAAM,IAAI,YAAY,CAAC;wBACzH,KAAK,GAAG,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC,KAAK,EAAE,MAAM,CAAC,CAAC;wBACjD,IAAI,CAAC,KAAK,EAAE;4BACV,KAAK,GAAG,IAAI,CAAC;yBACd;qBACF;iBACF;qBAAM,IAAI,QAAQ,KAAK,QAAQ,EAAE;oBAChC,KAAK,GAAG,MAAM,CAAC,KAAK,CAAC,CAAC;iBACvB;gBACD,IAAI,KAAK,KAAK,QAAQ,EAAE;oBACtB,IAAI,CAAC,iBAAiB,CAAC,eAAe,EAAE,SAAS,EAAE,KAAK,CAAC,CAAC;iBAC3D;aACF;SACF;QAGM,oEAAmB,GAD1B,UAC2B,KAAU;;YAEnC,IAAM,UAAU,GAAG,KAAK,IAAI,KAAK,CAAC,IAAI,IAAI,KAAK,CAAC,IAAI,CAAC,EAAE,IAAI,IAAI,CAAC;YAChE,IAAI,CAAC,UAAU,EAAE;gBACf,OAAO;aACR;YACD,IAAM,uBAAuB,GAAG,IAAI,CAAC,YAAY,CAAC,0BAA0B,EAAE,CAAC;YAC/E,IAAM,WAAW,GAAG,uBAAuB,CAAC,QAAQ,CAAC,yBAAyB,CAAC,IAAI,EAAE,CAAC;YACtF,WAAW,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;YAC7B,uBAAuB,CAAC,QAAQ,CAAC,yBAAyB,EAAE,WAAW,CAAC,CAAC;SAC1E;QAGM,sEAAqB,GAD5B,UAC6B,KAAU;;SAEtC;QAEM,oEAAmB,GAD1B,UAC2B,KAAU;YACnC,IAAM,EAAE,GAAG,KAAK,IAAI,KAAK,CAAC,IAAI,IAAI,KAAK,CAAC,IAAI,CAAC,IAAI,IAAI,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,YAAY,CAAC,UAAU,CAAC,UAAU,CAAC,IAAI,IAAI,CAAC;YACtH,IAAI,EAAE,KAAK,IAAI,CAAC,WAAW,CAAC,SAAS,EAAE;gBACrC,OAAO;aACR;YACD,IAAI,CAAC,sBAAsB,GAAG,IAAI,CAAC;YACnC,IAAI,CAAC,yBAAyB,CAAC,EAAE,CAAC,CAAC;SACpC;QAEM,sEAAqB,GAD5B,UAC6B,KAAU;YACrC,IAAI,CAAC,yBAAyB,CAAC,IAAI,CAAC,CAAC;SACtC;QACO,qEAAoB,GAA5B,UAA6B,KAAU;YACrC,IAAI,CAAC,KAAK,IAAI,CAAC,IAAI,CAAC,cAAc,IAAI,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,cAAc,CAAC,CAAC,MAAM,IAAI,CAAC,EAAE;gBAClF,OAAO;aACR;YACD,IAAI;gBACF,IAAI,SAAS,GAAG,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC;gBACnC,IAAI,CAAC,cAAc,CAAC,SAAS,CAAC,CAAC,QAAQ,GAAG,KAAK,CAAC,QAAQ,CAAC;aAC1D;YAAC,OAAO,CAAC,EAAE;gBACV,OAAO,CAAC,IAAI,CAAC,gCAA8B,CAAC,CAAC,OAAS,CAAC,CAAC;aACzD;SACF;QACO,0EAAyB,GAAjC,UAAkC,UAAkB;YAClD,IAAM,YAAY,GAAG,IAAI,CAAC,WAAW,CAAC,SAAS,CAAC;YAChD,IAAI,YAAY,KAAK,UAAU,EAAE;gBAC/B,OAAO;aACR;YACD,IAAI,CAAC,WAAW,CAAC,YAAY,CAAC,UAAU,EAAE,IAAI,CAAC,CAAC;SACjD;QAEO,yDAAQ,GAAhB;YACE,IAAI,KAAK,GAAG,EAAE,CAAC;YACf,IAAI,CAAC,IAAI,CAAC,YAAY,CAAC,SAAS,IAAI,CAAC,IAAI,CAAC,YAAY,CAAC,SAAS,CAAC,WAAW,IAAI,IAAI,CAAC,YAAY,CAAC,SAAS,CAAC,WAAW,KAAK,GAAG,EAAE;gBAC/H,OAAO,KAAK,CAAC;aACd;iBACI;gBACH,IAAI,WAAW,GAAG,IAAI,CAAC,YAAY,CAAC,SAAS,CAAC,WAAW,CAAC;gBAC1D,KAAK,GAAG,WAAW,CAAC,SAAS,CAAC,CAAC,EAAE,WAAW,CAAC,MAAM,CAAC,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;gBAChE,OAAO,KAAK,CAAC;aACd;SACF;QACO,kEAAiB,GAAzB,UAA0B,YAAiB,EAAE,YAAoB,EAAE,KAAU;YAC3E,IAAI,CAAC,YAAY,EAAE;gBACjB,OAAO;aACR;;YAED,IAAM,aAAa,GAAG,YAAY,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAA,IAAI,IAAI,OAAA,IAAI,GAAA,CAAC,CAAC;YACnE,IAAM,WAAW,GAAG,IAAI,CAAC,mBAAmB,EAAE,CAAC;;YAE/C,IAAM,IAAI,GAAG,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC,WAAW,CAAgB,CAAC;;YAEnE,IAAM,KAAK,GAAG,WAAW,CAAC,MAAM,CAAC,aAAa,CAAC,CAAC;YAChD,IAAI,IAAI,IAAI,YAAY,KAAK,IAAI,CAAC,WAAW,CAAC,eAAe,EAAE;gBAC7D,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC,KAAK,EAAE,KAAK,EAAE,IAAI,EAAE,IAAI,CAAC,CAAC;gBACpD,OAAO;aACR;YACD,IAAM,aAAa,GAAG,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC,YAAY,CAAC,CAAC;YAC9D,IAAI,CAAC,aAAa,EAAE;gBAClB,OAAO;aACR;YACD,IAAI,aAAa,CAAC,MAAM,GAAG,CAAC,EAAE;gBAC5B,aAAa,CAAC,QAAQ,CAAC,YAAY,EAAE,KAAK,EAAE,IAAI,EAAE,IAAI,EAAE,SAAS,EAAE,IAAI,CAAC,WAAW,CAAC,4BAA4B,EAAE,CAAC,KAAK,CAAC,CAAC,CAAC;aAC5H;iBAAM;gBACL,IAAI,qBAAmB,GAAG,IAAI,CAAC;gBAC/B,IAAM,MAAM,GAAG,aAAa,CAAC,KAAK,CAAC,CAAC,EAAE,aAAa,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;gBAChE,IAAM,kBAAkB,GAAG,aAAa,CAAC,aAAa,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;gBACnE,MAAM,CAAC,OAAO,CAAC,UAAA,IAAI;oBACjB,qBAAmB,GAAG,qBAAmB,IAAI,qBAAmB,CAAC,IAAI,CAAC,IAAI,aAAa,CAAC,IAAI,CAAC,CAAC;iBAC/F,CAAC,CAAC;;gBAEH,qBAAmB,CAAC,QAAQ,CAAC,kBAAkB,EAAE,KAAK,EAAE,IAAI,EAAE,IAAI,EAAE,SAAS,EAAE,IAAI,CAAC,WAAW,CAAC,4BAA4B,EAAE,CAAC,KAAK,CAAC,CAAC,CAAC;aACxI;SACF;QACO,oEAAmB,GAA3B;YACE,IAAM,IAAI,GAAG,IAAI,CAAC,YAAY,CAAC,SAAS,CAAC,WAAW,CAAC;YACrD,IAAI,IAAI,EAAE;gBACR,OAAO,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,KAAK,EAAE,GAAA,CAAC,CAAC;aAC9C;YACD,OAAO,EAAE,CAAC;SACX;QACO,yDAAQ,GAAhB,UAAiB,IAAY,EAAE,IAAS;YACtC,IAAI,KAAK,GAAG,EAAE,CAAC;YACf,IAAI,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC,EAAE;gBAC5B,KAAK,GAAG,IAAI,CAAC,IAAI,CAAC,CAAC;aACpB;iBAAM;gBACL,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAC,MAAM,EAAE,IAAI;oBAC1C,OAAO,MAAM,CAAC,IAAI,CAAC,CAAC;iBACrB,EAAE,IAAI,CAAC,CAAC;aACV;YACD,OAAO,KAAK,CAAC;SACd;QACS,0DAAS,GAAnB,UAAoB,GAAa;YAC/B,IAAI,CAAC,YAAY,CAAC,SAAS,CAAC,OAAO,CAAC,gBAAgB,CAAC,KAAK,EAAE,GAAG,CAAC,CAAC;SAClE;;oBAneFM,cAAS,SAAC;wBACT,QAAQ,EAAE,iCAAiC;qBAC5C;;;;;wBAdQ+D,mBAAS;wBADiBnC,mBAAY;wBAItChC,0BAAqB;;;;uCAkB3BO,UAAK,SAAC,wBAAwB;8BAE9BA,UAAK,SAAC,SAAS;8BAKfA,UAAK,SAAC,+BAA+B;uCAMrCmB,WAAM;wCAkTNlB,iBAAY,SAAC,YAAY,EAAE,CAAC,QAAQ,CAAC;4CAQrCA,iBAAY,SAAC,gBAAgB,EAAE,CAAC,QAAQ,CAAC;0CAmCzCA,iBAAY,SAAC,cAAc,EAAE,CAAC,QAAQ,CAAC;4CAavCA,iBAAY,SAAC,gBAAgB,EAAE,CAAC,QAAQ,CAAC;0CAIzCA,iBAAY,SAAC,cAAc,EAAE,CAAC,QAAQ,CAAC;4CASvCA,iBAAY,SAAC,gBAAgB,EAAE,CAAC,QAAQ,CAAC;;QAuF5C,6CAAC;KApeD;;;QC1KE,wCAAsB,YAA0B,EAAU,QAAkB;YAAtD,iBAAY,GAAZ,YAAY,CAAc;YAAU,aAAQ,GAAR,QAAQ,CAAU;;;;YADvD,eAAU,GAAY,KAAK,CAAC;SAGhD;QACD,oDAAW,GAAX;YACE,IAAI,CAAC,kBAAkB,CAAC,KAAK,CAAC,CAAC;SAChC;QACD,oDAAW,GAAX,UAAY,OAAsB;;YAEhC,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;SAC1C;;;;;QAKO,2DAAkB,GAA1B,UAA2B,UAAmB;YAC5C,IAAI,CAAC,IAAI,CAAC,KAAK,EAAE;gBACf,OAAO;aACR;YACD,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,uBAAuB,CAAC,IAAI,CAAC,KAAK,EAAE,UAAU,CAAC,CAAC;;;;;;;;;;;;;;;;;;;;;;SAsBxE;;oBApDFJ,cAAS,SAAC;wBACT,QAAQ,EAAE,2BAA2B;qBACtC;;;;;wBALQ4B,mBAAY;wBADDoB,aAAQ;;;;4BAWzB7C,UAAK,SAAC,yBAAyB;iCAI/BA,UAAK,SAAC,YAAY;;QA2CrB,qCAAC;KAtDD;;;QCIE,+BAAoB,SAAoB,EAAU,MAAuB;YAArD,cAAS,GAAT,SAAS,CAAW;YAAU,WAAM,GAAN,MAAM,CAAiB;SAAK;QAE9E,wCAAQ,GAAR;YACE,IAAI,CAAC,eAAe,EAAE,CAAC;SACxB;QAEO,+CAAe,GAAvB;YACE,IAAM,UAAU,GAAG,IAAI,CAAC,SAAS,IAAI,IAAI,CAAC,SAAS,CAAC,YAAY,IAAI,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC,iBAAiB,EAAE,CAAC;YACpH,IAAM,OAAO,GAAG,IAAI,CAAC,SAAS,IAAI,IAAI,CAAC,SAAS,CAAC,YAAY,IAAI,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC,OAAO,CAAC;YACrG,IAAM,MAAM,GAAQ,IAAI,CAAC,MAAM,CAAC;YAChC,IAAM,UAAU,GAAe,MAAM,IAAI,MAAM,CAAC,QAAQ,IAAI,MAAM,CAAC,QAAQ,CAAC,GAAG,CAACkC,eAAU,EAAE,IAAI,CAAC,CAAC;YAClG,IAAM,EAAE,GAAG,UAAU,IAAI,UAAU,CAAC,aAAa,IAAI,UAAU,CAAC,aAAa,CAAC,EAAE,IAAI,IAAI,CAAC;;YAEzF,IAAI,CAAC,OAAO,IAAI,CAAC,EAAE,EAAE;gBACnB,OAAO;aACR;YACD,IAAM,GAAG,GAAG,UAAU,IAAI,UAAU,CAAC,aAAa,IAAI,UAAU,CAAC,aAAa,CAAC,GAAG,CAAC,OAAO,CAAC,IAAI,IAAI,GAAG,EAAe,CAAC;YACtH,UAAU,IAAI,UAAU,CAAC,aAAa,IAAI,UAAU,CAAC,aAAa,CAAC,GAAG,CAAC,OAAO,EAAE,GAAG,CAAC,GAAG,CAAC,EAAE,EAAE,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC;SAC3G;;oBAtBFrC,cAAS,SAAC;wBACT,QAAQ,EAAE,sCAAsC;qBACjD;;;;;wBALQM,gBAAS;wBACT0D,wBAAe;;;QAyBxB,4BAAC;KAvBD;;;QCGE,+CAAoB,QAAkB,EAAU,SAAiC,EAAU,YAA0B;YAAjG,aAAQ,GAAR,QAAQ,CAAU;YAAU,cAAS,GAAT,SAAS,CAAwB;YAAU,iBAAY,GAAZ,YAAY,CAAc;SAAK;;;;;QAMlH,uDAAO,GADf,UACgB,KAAU;YACxB,IAAI,IAAI,CAAC,YAAY,EAAE;gBACrB,IAAI,CAAC,YAAY,CAAC,UAAU,CAAC,gBAAgB,CAAC,SAAS,GAAG,CAAC,CAAC;aAC7D;SACF;;oBAdFhE,cAAS,SAAC;wBACT,QAAQ,EAAE,mCAAmC;qBAC9C;;;;;wBALiCgD,aAAQ;wBAEjCiB,oCAAsB;wBADtBrC,mBAAY;;;;8BAWlBxB,iBAAY,SAAC,cAAc;;QAM9B,4CAAC;KAfD;;;QCIE,yCAAoB,QAAkB,EAAqC,YAA0B,EAAU,YAAuC;YAAlI,aAAQ,GAAR,QAAQ,CAAU;YAAqC,iBAAY,GAAZ,YAAY,CAAc;YAAU,iBAAY,GAAZ,YAAY,CAA2B;SAErJ;QACD,kDAAQ,GAAR;YACE,IAAI,CAAC,QAAQ,EAAE,CAAC;SACjB;QACO,kDAAQ,GAAhB;YACE,IAAI,IAAI,CAAC,YAAY,IAAI,IAAI,CAAC,YAAY,EAAE;gBACpC,IAAA,sBAA4D,EAA1D,kBAAiB,EAAjB,sCAAiB,EAAE,kBAAiB,EAAjB,sCAAuC,CAAC;gBACnE,IAAI,UAAU,KAAK,IAAI,IAAI,UAAU,KAAK,IAAI,EAAE;oBAC9C,OAAO;iBACR;gBACD,IAAI,UAAU,IAAI,UAAU,IAAI,IAAI,CAAC,YAAY,CAAC,QAAQ,KAAK,IAAI,EAAE;oBACnE,IAAI,CAAC,YAAY,CAAC,UAAU,GAAM,UAAU,SAAI,UAAY,CAAC;oBAC7D,IAAI,CAAC,YAAY,CAAC,QAAQ,CAAC,UAAU,GAAM,UAAU,SAAI,UAAY,CAAC;oBACtE,IAAI,CAAC,YAAY,CAAC,WAAW,CAAC,IAAI,CAAC,YAAY,CAAC,KAAK,CAAC,CAAC;iBACxD;qBAAM,IAAI,UAAU,EAAE;oBACrB,IAAI,CAAC,YAAY,CAAC,UAAU,GAAG,KAAG,UAAY,CAAC;oBAC/C,IAAI,CAAC,YAAY,CAAC,QAAQ,CAAC,UAAU,GAAG,KAAG,UAAY,CAAC;oBACxD,IAAI,CAAC,YAAY,CAAC,WAAW,CAAC,IAAI,CAAC,YAAY,CAAC,KAAK,CAAC,CAAC;iBACxD;aACF;SACF;;oBA1BFJ,cAAS,SAAC;wBACT,QAAQ,EAAE,4BAA4B;qBACvC;;;;;wBAL2BgD,aAAQ;wDAOOkB,WAAM,SAACC,wBAAiB;wBAL1DC,sCAAyB;;;QA4BlC,sCAAC;KA3BD;;;QCIE,2CAAoB,QAAkB,EAAqC,YAA0B,EAAU,YAAoC;YAA/H,aAAQ,GAAR,QAAQ,CAAU;YAAqC,iBAAY,GAAZ,YAAY,CAAc;YAAU,iBAAY,GAAZ,YAAY,CAAwB;SAElJ;QACD,oDAAQ,GAAR;YACE,IAAI,CAAC,QAAQ,EAAE,CAAC;SACjB;QACO,oDAAQ,GAAhB;YACE,OAAO;;YAEP,IAAI,IAAI,CAAC,YAAY,IAAI,IAAI,CAAC,YAAY,CAAC,YAAY,IAAI,IAAI,CAAC,YAAY,EAAE;gBACtE,IAAA,yCAAsJ,EAApJ,oBAAmB,EAAnB,AAAqB,2BAA0B,EAA1B,+CAA0B,EAAE,8BAA6B,EAA7B,kDAA6B,EAAE,4BAA2B,EAA3B,gDAAoE,CAAC;;gBAM7J,IAAI,mBAAmB,KAAK,IAAI,EAAE;oBAChC,IAAI,CAAC,YAAY,CAAC,SAAS,GAAG,mBAAmB,CAAC;oBAClD,IAAI,CAAC,YAAY,CAAC,aAAa,CAAC,WAAW,CAAC,GAAG,mBAAmB,CAAC;iBACpE;;gBAED,IAAI,sBAAsB,KAAK,IAAI,EAAE;oBACnC,IAAI,CAAC,YAAY,CAAC,gBAAgB,GAAG,sBAAsB,CAAC;oBAC5D,IAAI,CAAC,YAAY,CAAC,aAAa,CAAC,kBAAkB,CAAC,GAAG,sBAAsB,CAAC;iBAC9E;;gBAED,IAAI,oBAAoB,KAAK,IAAI,EAAE;oBACjC,IAAI,CAAC,YAAY,CAAC,cAAc,GAAG,oBAAoB,CAAC;oBACxD,IAAI,CAAC,YAAY,CAAC,aAAa,CAAC,gBAAgB,CAAC,GAAG,oBAAoB,CAAC;iBAC1E;gBACD,IAAI,CAAC,YAAY,CAAC,WAAW,CAAC,IAAI,CAAC,YAAY,CAAC,KAAK,CAAC,CAAC;aACxD;SACF;;oBApCFpE,cAAS,SAAC;wBACT,QAAQ,EAAE,8BAA8B;qBACzC;;;;;wBAL2BgD,aAAQ;wDAOOkB,WAAM,SAACC,wBAAiB;wBAL1DE,sCAAsB;;;QAsC/B,wCAAC;KArCD;;;QCKE,yCAAoB,QAAkB,EAAqC,YAA0B,EAAU,YAAiC;YAA5H,aAAQ,GAAR,QAAQ,CAAU;YAAqC,iBAAY,GAAZ,YAAY,CAAc;YAAU,iBAAY,GAAZ,YAAY,CAAqB;SAE/I;QACD,kDAAQ,GAAR;YACE,IAAI,CAAC,QAAQ,EAAE,CAAC;SACjB;QACO,kDAAQ,GAAhB;YACE,IAAI,IAAI,CAAC,YAAY,IAAI,IAAI,CAAC,YAAY,EAAE;gBAClC,IAAA,iCAAiB,EAAjB,sCAAiB,CAAuB;gBAChD,IAAI,UAAU,EAAE;oBACd,IAAI,CAAC,YAAY,CAAC,MAAM,GAAG,UAAU,CAAC;iBACvC;aACF;SACF;;oBAjBFrE,cAAS,SAAC;wBACT,QAAQ,EAAE,4BAA4B;qBACvC;;;;;wBAN2BgD,aAAQ;wDAQOkB,WAAM,SAACC,wBAAiB;wBAN1DG,gCAAmB;;;QAoB5B,sCAAC;KAlBD;;;QCOE,yCAAoB,QAAkB,EAAqC,YAA0B,EAAU,YAA2B;YAAtH,aAAQ,GAAR,QAAQ,CAAU;YAAqC,iBAAY,GAAZ,YAAY,CAAc;YAAU,iBAAY,GAAZ,YAAY,CAAe;YACxI,IAAI,CAAC,SAAS,EAAE,CAAC;SAClB;QACM,kDAAQ,GAAf;SACC;QACO,mDAAS,GAAjB;YAAA,iBAgBC;YAfC,IAAI,IAAI,CAAC,YAAY,EAAE;gBACrB,IAAI,CAAC,YAAY,CAAC,gBAAgB,GAAG,UAAC,KAAU,EAAE,OAAY;oBACtD,IAAA,6BAAuB,EAAvB,4CAAuB,EAAE,qBAAgB,CAAa;oBAC5D,IAAI,CAAC,KAAK,EAAE;wBACV,OAAO,EAAE,CAAC;qBACX;oBACD,IAAI,gBAAgB,IAAI,KAAK,EAAE;wBAC7B,gBAAgB,GAAG,gBAAgB,CAAC,WAAW,EAAE,CAAC;wBAClD,KAAK,GAAG,KAAI,CAAC,cAAc,CAAC,KAAK,EAAE,gBAAgB,CAAC,CAAC;wBACrD,OAAO,KAAK,CAAC;qBACd;yBAAM;wBACL,OAAO,SAAS,CAAC;qBAClB;iBACF,CAAC;aACH;SACF;QACO,wDAAc,GAAtB,UAAuB,KAAU,EAAE,QAAgB;YACjD,IAAI,QAAQ,KAAK,MAAM,EAAE;gBACvB,OAAO,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;aAClC;iBAAM,IAAI,QAAQ,KAAK,UAAU,EAAE;gBAClC,OAAO,IAAI,CAAC,iBAAiB,CAAC,KAAK,CAAC,CAAC;aACtC;;;;;iBAKI;gBACH,OAAO,KAAK,CAAC;aACd;SACF;;;;;QAKO,uDAAa,GAArB,UAAsB,KAAU;YAC9B,IAAI,UAAU,GAAG,IAAI,CAAC,YAAY,IAAI,IAAI,CAAC,YAAY,CAAC,UAAU,IAAI,YAAY,CAAC;YACnF,IAAI,CAAC,UAAU,IAAI,CAAC,KAAK,EAAE;gBACzB,OAAO,KAAK,CAAC;aACd;YACD,IAAMC,OAAI,GAAG,MAAM,CAAC,KAAK,CAAC,CAAC;YAC3B,IAAM,OAAO,GAAGA,OAAI,CAAC,OAAO,EAAE,CAAC;YAC/B,IAAI,CAAC,OAAO,EAAE;gBACZ,OAAO,KAAK,CAAC;aACd;YACD,UAAU,GAAG,IAAI,CAAC,eAAe,CAAC,UAAU,CAAC,CAAC;YAC9C,OAAOA,OAAI,CAAC,MAAM,CAAC,UAAU,CAAC,CAAC;SAChC;;;;;;QAMO,2DAAiB,GAAzB,UAA0B,KAAU;YAClC,IAAI,UAAU,GAAG,IAAI,CAAC,YAAY,IAAI,IAAI,CAAC,YAAY,CAAC,UAAU,IAAI,YAAY,CAAC;YACnF,IAAI,UAAU,GAAG,IAAI,CAAC,YAAY,IAAI,IAAI,CAAC,YAAY,CAAC,UAAU,IAAI,UAAU,CAAC;YACjF,IAAI,CAAC,UAAU,IAAI,CAAC,UAAU,EAAE;gBAC9B,OAAO,KAAK,CAAC;aACd;YACD,IAAM,QAAQ,GAAG,MAAM,CAAC,KAAK,CAAC,CAAC;YAC/B,IAAM,OAAO,GAAG,QAAQ,CAAC,OAAO,EAAE,CAAC;YACnC,IAAI,CAAC,OAAO,EAAE;gBACZ,OAAO,KAAK,CAAC;aACd;YACD,IAAI,UAAU,EAAE;gBACd,UAAU,GAAG,IAAI,CAAC,eAAe,CAAC,UAAU,CAAC,CAAC;aAC/C;YACD,IAAI,UAAU,EAAE;gBACd,UAAU,GAAG,IAAI,CAAC,eAAe,CAAC,UAAU,CAAC,CAAC;aAC/C;YACD,IAAM,cAAc,GAAG,UAAU,GAAG,GAAG,GAAG,UAAU,CAAC;YACrD,OAAO,QAAQ,CAAC,MAAM,CAAC,cAAc,CAAC,CAAC;SACxC;;;;;QAKO,yDAAe,GAAvB,UAAwB,KAAK;YAC3B,IAAI,KAAK,KAAK,IAAI,IAAI,KAAK,KAAK,SAAS,IAAI,KAAK,KAAK,EAAE,EAAE;gBACzD,OAAO,EAAE,CAAC;aACX;YACD,IAAM,SAAS,GAAG,IAAIC,sBAAS,CAAC,KAAK,CAAC,CAAC;;YAEvC,IAAI,CAACA,sBAAS,CAAC,WAAW,CAAC,SAAS,CAAC,EAAE;gBACrC,OAAO,KAAK,CAAC;aACd;YACD,IAAM,UAAU,GAAG,SAAS,CAAC,UAAU,EAAE,CAAC;YAC1C,IAAM,MAAM,GAAG,IAAI,CAAC,iBAAiB,EAAE,CAAC;YAClC,IAAA,4BAA6E,EAA3E,oBAAmB,EAAnB,wCAAmB,EAAE,2BAA0B,EAA1B,+CAAsD,CAAC;YACpF,IAAI,UAAU,EAAE;gBACd,IAAI,YAAY,KAAK,IAAI,EAAE;oBACzB,MAAM,CAAC,MAAM,GAAG,YAAY,CAAC;oBAC7B,OAAO,SAAS,CAAC,aAAa,EAAE,CAAC,QAAQ,CAAC,mBAAmB,EAAE,IAAI,EAAE,MAAM,CAAC,CAAC;iBAC9E;aACF;YACD,OAAO,SAAS,CAAC,QAAQ,CAAC,mBAAmB,EAAE,IAAI,EAAE,MAAM,CAAC,CAAC;SAC9D;;;;;QAKO,yDAAe,GAAvB,UAAwB,MAAc;YACpC,OAAO,MAAM,CAAC,OAAO,CAAC,IAAI,EAAE,GAAG,CAAC,CAAC,OAAO,CAAC,IAAI,EAAE,GAAG,CAAC,CAAC;SACrD;;;;;QAKO,yDAAe,GAAvB,UAAwB,MAAc;YACpC,OAAO,MAAM,CAAC,OAAO,CAAC,IAAI,EAAE,GAAG,CAAC,CAAC;SAClC;;;;QAIO,2DAAiB,GAAzB;YACE,IAAI,IAAI,CAAC,YAAY,EAAE;gBACf,IAAA,sBAAkF,EAAhF,8BAA6B,EAA7B,kDAA6B,EAAE,4BAA2B,EAA3B,gDAAiD,CAAC;gBACzF,IAAM,MAAM,GAAQ;oBAClB,SAAS,EAAE,CAAC;iBACb,CAAC;gBACF,IAAI,sBAAsB,KAAK,IAAI,EAAE;oBACnC,MAAM,CAAC,gBAAgB,GAAG,sBAAsB,CAAC;iBAClD;gBACD,IAAI,oBAAoB,KAAK,IAAI,EAAE;oBACjC,MAAM,CAAC,cAAc,GAAG,oBAAoB,CAAC;iBAC9C;gBACD,OAAO,MAAM,CAAC;aACf;SACF;QACD,sBAAY,yDAAY;iBAAxB;gBACE,OAAO,IAAI,CAAC,YAAY,IAAI,IAAI,CAAC,YAAY,CAAC,YAAY,IAAI,IAAI,CAAC;aACpE;;;WAAA;;oBA7IFxE,cAAS,SAAC;wBACT,QAAQ,EAAE,4BAA4B;qBACvC;;;;;wBAR2BgD,aAAQ;wDAWOkB,WAAM,SAACC,wBAAiB;wBAP1DM,oBAAa;;;;mCAMnBtE,UAAK,SAAC,cAAc;;QA0IvB,sCAAC;KA9ID;;;QCAE,6CAAoB,QAAkB,EAAU,UAAsB;YAAlD,aAAQ,GAAR,QAAQ,CAAU;YAAU,eAAU,GAAV,UAAU,CAAY;SAAK;QAC3E,sDAAQ,GAAR;YACE,IAAI,OAAO,IAAI,CAAC,KAAK,KAAK,QAAQ,IAAI,CAAC,IAAI,CAAC,UAAU,EAAE;gBACtD,OAAO;aACR;YACD,IAAM,aAAa,GAAG,IAAI,CAAC,UAAU,CAAC,aAAa,CAAC;YACpD,IAAI,aAAa,EAAE;gBACjB,IAAM,EAAE,GAAG,aAAa,CAAC,YAAY,CAAC,IAAI,CAAC,CAAC;gBAC5C,IAAI,EAAE,EAAE;oBACN,IAAM,KAAK,GAAM,EAAE,SAAI,IAAI,CAAC,KAAO,CAAC;oBACpC,IAAI,CAAC,UAAU,CAAC,aAAa,CAAC,YAAY,CAAC,IAAI,EAAE,KAAK,CAAC,CAAC;oBACxD,IAAI,CAAC,UAAU,CAAC,aAAa,CAAC,YAAY,CAAC,MAAM,EAAE,KAAK,CAAC,CAAC;oBAC1D,IAAI,CAAC,UAAU,CAAC,aAAa,CAAC,YAAY,CAAC,aAAa,EAAE,EAAE,CAAC,CAAC;iBAC/D;aACF;SACF;;oBApBFH,cAAS,SAAC;wBACT,QAAQ,EAAE,gCAAgC;qBAC3C;;;;;wBAH+BgD,aAAQ;wBAApBX,eAAU;;;;4BAK3BlC,UAAK;;QAkBR,0CAAC;KAtBD;;;QCKE,0CAAoB,QAAkB,EAAU,UAAsB;YAAlD,aAAQ,GAAR,QAAQ,CAAU;YAAU,eAAU,GAAV,UAAU,CAAY;SAAK;QAC3E,mDAAQ,GAAR;YACE,IAAI,OAAO,IAAI,CAAC,KAAK,KAAK,QAAQ,IAAI,CAAC,IAAI,CAAC,UAAU,EAAE;gBACtD,OAAO;aACR;YACD,IAAM,aAAa,GAAG,IAAI,CAAC,UAAU,CAAC,aAAa,CAAC;YACpD,IAAI,aAAa,EAAE;gBACjB,IAAM,QAAQ,GAAG,aAAa,CAAC,YAAY,CAAC,KAAK,CAAC,CAAC;gBACnD,IAAI,QAAQ,EAAE;oBACZ,IAAI,CAAC,UAAU,CAAC,aAAa,CAAC,YAAY,CAAC,KAAK,EAAK,QAAQ,SAAI,IAAI,CAAC,KAAO,CAAC,CAAC;iBAChF;aACF;SACF;;oBAjBFH,cAAS,SAAC;wBACT,QAAQ,EAAE,6BAA6B;qBACxC;;;;;wBAH+BgD,aAAQ;wBAApBX,eAAU;;;;4BAK3BlC,UAAK;;QAeR,uCAAC;KAnBD;;;QCgBE,sCAAgC,MAA2B,EAAsB,WAAiC;YAAlF,WAAM,GAAN,MAAM,CAAqB;YAAsB,gBAAW,GAAX,WAAW,CAAsB;SAAK;QARvH,sBACW,qDAAW;iBADtB,UACuB,KAAU;gBAC/B,IAAI,IAAI,CAAC,UAAU,KAAK,QAAQ,IAAI,IAAI,CAAC,MAAM,EAAE;oBAC/C,IAAI,CAAC,MAAM,CAAC,UAAU,CAAC,KAAK,CAAC,CAAC;iBAC/B;qBAAM,IAAI,IAAI,CAAC,UAAU,KAAK,aAAa,IAAI,IAAI,CAAC,WAAW,EAAE;oBAChE,IAAI,CAAC,WAAW,CAAC,UAAU,CAAC,KAAK,CAAC,CAAC;iBACpC;aACF;;;WAAA;;oBAZFH,cAAS,SAAC;wBACT,QAAQ,EAAE,yBAAyB;qBACpC;;;;;wBAJQ8B,4BAAmB,uBAebd,aAAQ;wBAhBdoB,kCAAoB,uBAgBmCpB,aAAQ;;;;iCATrEb,UAAK;kCACLA,UAAK,SAAC,uBAAuB;;QAShC,mCAAC;KAdD;;;QCAE,sBAAsB,YAA0B,EAAY,UAAsB;YAA5D,iBAAY,GAAZ,YAAY,CAAc;YAAY,eAAU,GAAV,UAAU,CAAY;SAAK;QAChF,mCAAY,GAAnB,UAAoB,YAAiB;YACnC,IAAM,EAAE,GAAG,IAAI,CAAC,UAAU,IAAI,IAAI,CAAC,UAAU,CAAC,aAAa,IAAI,IAAI,CAAC,UAAU,CAAC,aAAa,CAAC,EAAE,CAAC;YAChG,IAAI,IAAI,CAAC,YAAY,IAAI,EAAE,IAAI,YAAY,EAAE;gBAC3C,IAAI,CAAC,YAAY,CAAC,mBAAmB,CAAC,GAAG,CAAC,EAAE,EAAE,YAAY,CAAC,CAAC;aAC7D;SACF;QACM,sCAAe,GAAtB,UAAuB,YAAiB,EAAE,WAA0B;YAA1B,4BAAA;gBAAA,kBAA0B;;YAClE,IAAM,EAAE,GAAG,WAAW,IAAI,IAAI,CAAC,UAAU,IAAI,IAAI,CAAC,UAAU,CAAC,aAAa,IAAI,IAAI,CAAC,UAAU,CAAC,aAAa,CAAC,EAAE,CAAC;YAC/G,IAAI,IAAI,CAAC,YAAY,IAAI,EAAE,IAAI,YAAY,IAAI,CAAC,IAAI,CAAC,YAAY,CAAC,mBAAmB,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE;gBAC7F,IAAI,CAAC,YAAY,CAAC,mBAAmB,CAAC,GAAG,CAAC,EAAE,EAAE,YAAY,CAAC,CAAC;aAC7D;SACF;QACH,mBAAC;IAAD,CAAC;;;QCTiDJ,gDAAY;QAC5D,sCAAoB,QAAkB,EAAU,SAA2B,EAAS,UAAsB,EAAS,YAA0B;YAA7I,YACE,kBAAM,YAAY,EAAE,UAAU,CAAC,SAChC;YAFmB,cAAQ,GAAR,QAAQ,CAAU;YAAU,eAAS,GAAT,SAAS,CAAkB;YAAS,gBAAU,GAAV,UAAU,CAAY;YAAS,kBAAY,GAAZ,YAAY,CAAc;;SAE5I;;QAED,sDAAe,GAAf;YACE,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;SACtC;QACD,+CAAQ,GAAR;YACE,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;SACnC;QACD,kDAAW,GAAX;SACC;;oBAfFC,cAAS,SAAC;wBACT,QAAQ,EAAE,cAAc;qBACzB;;;;;wBAP8CgD,aAAQ;wBAE9C0B,0BAAgB;wBAFUrC,eAAU;wBACpCT,mBAAY;;;QAqBrB,mCAAC;KAAA,CAdiD,YAAY;;;QCAX7B,iDAAY;QAC7D,uCAAoB,QAAkB,EAAU,SAA4B,EAAS,UAAsB,EAAS,YAA0B;YAA9I,YACE,kBAAM,YAAY,EAAE,UAAU,CAAC,SAChC;YAFmB,cAAQ,GAAR,QAAQ,CAAU;YAAU,eAAS,GAAT,SAAS,CAAmB;YAAS,gBAAU,GAAV,UAAU,CAAY;YAAS,kBAAY,GAAZ,YAAY,CAAc;;SAE7I;QACD,uDAAe,GAAf;YACE,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;SACtC;QACD,gDAAQ,GAAR;YACE,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;SACnC;QACD,mDAAW,GAAX;SACC;;oBAdFC,cAAS,SAAC;wBACT,QAAQ,EAAE,eAAe;qBAC1B;;;;;wBAP8CgD,aAAQ;wBAE9CD,4BAAiB;wBAFSV,eAAU;wBACpCT,mBAAY;;;QAmBrB,oCAAC;KAAA,CAZkD,YAAY;;;QCDV7B,mDAAY;QAC/D,yCAAoB,QAAkB,EAAU,SAA8B,EAAS,UAAsB,EAAS,YAA0B;YAAhJ,YACE,kBAAM,YAAY,EAAE,UAAU,CAAC,SAChC;YAFmB,cAAQ,GAAR,QAAQ,CAAU;YAAU,eAAS,GAAT,SAAS,CAAqB;YAAS,gBAAU,GAAV,UAAU,CAAY;YAAS,kBAAY,GAAZ,YAAY,CAAc;;SAE/I;QACD,yDAAe,GAAf;YACE,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;SACtC;QACD,kDAAQ,GAAR;YACE,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;SACnC;QACD,qDAAW,GAAX;SACC;;oBAdFC,cAAS,SAAC;wBACT,QAAQ,EAAE,iBAAiB;qBAC5B;;;;;wBAN8CgD,aAAQ;wBAE9C2B,gCAAmB;wBAFOtC,eAAU;wBACpCT,mBAAY;;;QAkBrB,sCAAC;KAAA,CAZoD,YAAY;;;QCChB7B,+CAAY;QAC3D,qCAAoB,QAAkB,EAAU,SAA0B,EAAS,UAAsB,EAAS,YAA0B;YAA5I,YACE,kBAAM,YAAY,EAAE,UAAU,CAAC,SAChC;YAFmB,cAAQ,GAAR,QAAQ,CAAU;YAAU,eAAS,GAAT,SAAS,CAAiB;YAAS,gBAAU,GAAV,UAAU,CAAY;YAAS,kBAAY,GAAZ,YAAY,CAAc;;SAE3I;QACD,qDAAe,GAAf;YACE,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;SACtC;QACD,8CAAQ,GAAR;YACE,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;SACnC;QACD,iDAAW,GAAX;SACC;;oBAdFC,cAAS,SAAC;wBACT,QAAQ,EAAE,aAAa;qBACxB;;;;;wBAP8CgD,aAAQ;wBAE9C4B,wBAAe;wBAFWvC,eAAU;wBACpCT,mBAAY;;;QAoBrB,kCAAC;KAAA,CAbgD,YAAY;;;QCAR7B,mDAAY;QAC/D,yCAAoB,QAAkB,EAAU,SAA8B,EAAS,UAAsB,EAAS,YAA0B;YAAhJ,YACE,kBAAM,YAAY,EAAE,UAAU,CAAC,SAChC;YAFmB,cAAQ,GAAR,QAAQ,CAAU;YAAU,eAAS,GAAT,SAAS,CAAqB;YAAS,gBAAU,GAAV,UAAU,CAAY;YAAS,kBAAY,GAAZ,YAAY,CAAc;;SAE/I;QACD,yDAAe,GAAf;YACE,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;SACtC;QACD,kDAAQ,GAAR;YACE,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;SACnC;QACD,qDAAW,GAAX;SACC;;oBAdFC,cAAS,SAAC;wBACT,QAAQ,EAAE,iBAAiB;qBAC5B;;;;;wBAP8CgD,aAAQ;wBAE9C6B,gCAAmB;wBAFOxC,eAAU;wBACpCT,mBAAY;;;QAoBrB,sCAAC;KAAA,CAboD,YAAY;;;QCAZ7B,mDAAY;QAC/D,yCAAoB,QAAkB,EAAU,SAA8B,EAAS,UAAsB,EAAS,YAA0B;YAAhJ,YACE,kBAAM,YAAY,EAAE,UAAU,CAAC,SAChC;YAFmB,cAAQ,GAAR,QAAQ,CAAU;YAAU,eAAS,GAAT,SAAS,CAAqB;YAAS,gBAAU,GAAV,UAAU,CAAY;YAAS,kBAAY,GAAZ,YAAY,CAAc;;SAE/I;QACD,yDAAe,GAAf;YACE,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;SACtC;QACD,kDAAQ,GAAR;YACE,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;SACnC;QACD,qDAAW,GAAX;SACC;;oBAdFC,cAAS,SAAC;wBACT,QAAQ,EAAE,iBAAiB;qBAC5B;;;;;wBAP8CgD,aAAQ;wBAE9CE,gCAAmB;wBAFOb,eAAU;wBACpCT,mBAAY;;;QAoBrB,sCAAC;KAAA,CAboD,YAAY;;;QCAf7B,gDAAY;QAC5D,sCAAoB,QAAkB,EAAU,SAAiC,EAAS,UAAsB,EAAS,YAA0B;YAAnJ,YACE,kBAAM,YAAY,EAAE,UAAU,CAAC,SAChC;YAFmB,cAAQ,GAAR,QAAQ,CAAU;YAAU,eAAS,GAAT,SAAS,CAAwB;YAAS,gBAAU,GAAV,UAAU,CAAY;YAAS,kBAAY,GAAZ,YAAY,CAAc;;SAElJ;QACD,sDAAe,GAAf;YACE,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;SACtC;QACD,+CAAQ,GAAR;YACE,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;SACnC;QACD,kDAAW,GAAX;SACC;;oBAdFC,cAAS,SAAC;wBACT,QAAQ,EAAE,cAAc;qBACzB;;;;;wBAP8CgD,aAAQ;wBAE9C8B,gCAAsB;wBAFIzC,eAAU;wBACpCT,mBAAY;;;QAoBrB,mCAAC;KAAA,CAbiD,YAAY;;;QCAT7B,mDAAY;QAC/D,yCAAoB,QAAkB,EAAU,SAA8B,EAAS,UAAsB,EAAS,YAA0B;YAAhJ,YACE,kBAAM,YAAY,EAAE,UAAU,CAAC,SAChC;YAFmB,cAAQ,GAAR,QAAQ,CAAU;YAAU,eAAS,GAAT,SAAS,CAAqB;YAAS,gBAAU,GAAV,UAAU,CAAY;YAAS,kBAAY,GAAZ,YAAY,CAAc;;SAE/I;QACD,yDAAe,GAAf;YACE,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;SACtC;QACD,kDAAQ,GAAR;YACE,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;SACnC;QACD,qDAAW,GAAX;SACC;;oBAdFC,cAAS,SAAC;wBACT,QAAQ,EAAE,iBAAiB;qBAC5B;;;;;wBAP8CgD,aAAQ;wBAE9C+B,gCAAmB;wBAFO1C,eAAU;wBACpCT,mBAAY;;;QAoBrB,sCAAC;KAAA,CAboD,YAAY;;;QCAZ7B,mDAAY;QAC/D,yCAAoB,QAAkB,EAAU,SAAoC,EAAS,UAAsB,EAAS,YAA0B;YAAtJ,YACE,kBAAM,YAAY,EAAE,UAAU,CAAC,SAChC;YAFmB,cAAQ,GAAR,QAAQ,CAAU;YAAU,eAAS,GAAT,SAAS,CAA2B;YAAS,gBAAU,GAAV,UAAU,CAAY;YAAS,kBAAY,GAAZ,YAAY,CAAc;;SAErJ;QACD,yDAAe,GAAf;YACE,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;SACtC;QACD,kDAAQ,GAAR;YACE,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;SACnC;QACD,qDAAW,GAAX;SACC;;oBAdFC,cAAS,SAAC;wBACT,QAAQ,EAAE,iBAAiB;qBAC5B;;;;;wBAP8CgD,aAAQ;wBAE9CoB,sCAAyB;wBAFC/B,eAAU;wBACpCT,mBAAY;;;QAoBrB,sCAAC;KAAA,CAboD,YAAY;;;QCAZ7B,mDAAY;QAC/D,yCAAoB,QAAkB,EAAU,SAA8B,EAAS,UAAsB,EAAS,YAA0B;YAAhJ,YACE,kBAAM,YAAY,EAAE,UAAU,CAAC,SAChC;YAFmB,cAAQ,GAAR,QAAQ,CAAU;YAAU,eAAS,GAAT,SAAS,CAAqB;YAAS,gBAAU,GAAV,UAAU,CAAY;YAAS,kBAAY,GAAZ,YAAY,CAAc;;SAE/I;QACD,yDAAe,GAAf;YACE,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;SACtC;QACD,kDAAQ,GAAR;YACE,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;SACnC;QACD,qDAAW,GAAX;SACC;;oBAdFC,cAAS,SAAC;wBACT,QAAQ,EAAE,iBAAiB;qBAC5B;;;;;wBAP8CgD,aAAQ;wBAE9CsB,gCAAmB;wBAFOjC,eAAU;wBACpCT,mBAAY;;;QAoBrB,sCAAC;KAAA,CAboD,YAAY;;;QCAT7B,sDAAY;QAClE,4CAAoB,QAAkB,EAAU,SAAiC,EAAS,UAAsB,EAAS,YAA0B;YAAnJ,YACE,kBAAM,YAAY,EAAE,UAAU,CAAC,SAChC;YAFmB,cAAQ,GAAR,QAAQ,CAAU;YAAU,eAAS,GAAT,SAAS,CAAwB;YAAS,gBAAU,GAAV,UAAU,CAAY;YAAS,kBAAY,GAAZ,YAAY,CAAc;;SAElJ;QACD,4DAAe,GAAf;YACE,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;SACtC;QACD,qDAAQ,GAAR;YACE,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;SACnC;QACD,wDAAW,GAAX;SACC;;oBAdFC,cAAS,SAAC;wBACT,QAAQ,EAAE,oBAAoB;qBAC/B;;;;;wBAP8CgD,aAAQ;wBAE9CqB,sCAAsB;wBAFIhC,eAAU;wBACpCT,mBAAY;;;QAmBrB,yCAAC;KAAA,CAZuD,YAAY;;;QCAhB7B,kDAAY;QAC9D,wCAAoB,QAAkB,EAAU,SAA6B,EAAS,UAAsB,EAAS,YAA0B;YAA/I,YACE,kBAAM,YAAY,EAAE,UAAU,CAAC,SAChC;YAFmB,cAAQ,GAAR,QAAQ,CAAU;YAAU,eAAS,GAAT,SAAS,CAAoB;YAAS,gBAAU,GAAV,UAAU,CAAY;YAAS,kBAAY,GAAZ,YAAY,CAAc;;SAE9I;QACD,wDAAe,GAAf;YACE,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;SACtC;QACD,iDAAQ,GAAR;YACE,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;SACnC;QACD,oDAAW,GAAX;SACC;;oBAdFC,cAAS,SAAC;wBACT,QAAQ,EAAE,gBAAgB;qBAC3B;;;;;wBAP8CgD,aAAQ;wBAE9Cb,8BAAkB;wBAFQE,eAAU;wBACpCT,mBAAY;;;QAmBrB,qCAAC;KAAA,CAZmD,YAAY;;;QCAV7B,oDAAY;QAChE,0CAAoB,QAAkB,EAAU,SAA+B,EAAS,UAAsB,EAAS,YAA0B;YAAjJ,YACE,kBAAM,YAAY,EAAE,UAAU,CAAC,SAChC;YAFmB,cAAQ,GAAR,QAAQ,CAAU;YAAU,eAAS,GAAT,SAAS,CAAsB;YAAS,gBAAU,GAAV,UAAU,CAAY;YAAS,kBAAY,GAAZ,YAAY,CAAc;;SAEhJ;QACD,0DAAe,GAAf;YACE,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;SACtC;QACD,mDAAQ,GAAR;YACE,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;SACnC;QACD,sDAAW,GAAX;SACC;;oBAdFC,cAAS,SAAC;wBACT,QAAQ,EAAE,kBAAkB;qBAC7B;;;;;wBAP8CgD,aAAQ;wBAE9CZ,kCAAoB;wBAFMC,eAAU;wBACpCT,mBAAY;;;QAoBrB,uCAAC;KAAA,CAbqD,YAAY;;;QCAb7B,mDAAY;QAC/D,yCAAoB,QAAkB,EAAU,SAA8B,EAAS,UAAsB,EAAS,YAA0B;YAAhJ,YACE,kBAAM,YAAY,EAAE,UAAU,CAAC,SAChC;YAFmB,cAAQ,GAAR,QAAQ,CAAU;YAAU,eAAS,GAAT,SAAS,CAAqB;YAAS,gBAAU,GAAV,UAAU,CAAY;YAAS,kBAAY,GAAZ,YAAY,CAAc;;SAE/I;QACD,yDAAe,GAAf;YACE,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;SACtC;QACD,kDAAQ,GAAR;YACE,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;SACnC;QACD,qDAAW,GAAX;SACC;;oBAdFC,cAAS,SAAC;wBACT,QAAQ,EAAE,iBAAiB;qBAC5B;;;;;wBAP8CgD,aAAQ;wBAE9ClB,4BAAmB;wBAFOO,eAAU;wBACpCT,mBAAY;;;QAoBrB,sCAAC;KAAA,CAboD,YAAY;;;QCAd7B,iDAAY;QAC7D,uCAAoB,QAAkB,EAAU,SAA4B,EAAS,UAAsB,EAAS,YAA0B;YAA9I,YACE,kBAAM,YAAY,EAAE,UAAU,CAAC,SAChC;YAFmB,cAAQ,GAAR,QAAQ,CAAU;YAAU,eAAS,GAAT,SAAS,CAAmB;YAAS,gBAAU,GAAV,UAAU,CAAY;YAAS,kBAAY,GAAZ,YAAY,CAAc;;SAE7I;QACD,uDAAe,GAAf;YACE,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,SAAS,EAAE,IAAI,CAAC,SAAS,CAAC,EAAE,CAAC,CAAC;SACzD;QACD,gDAAQ,GAAR;YACE,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;SACnC;QACD,mDAAW,GAAX;SACC;;oBAdFC,cAAS,SAAC;wBACT,QAAQ,EAAE,eAAe;qBAC1B;;;;;wBAP8CgD,aAAQ;wBAE9CH,4BAAiB;wBAFSR,eAAU;wBACpCT,mBAAY;;;QAoBrB,oCAAC;KAAA,CAbkD,YAAY;;;QCAX7B,kDAAY;QAC9D,wCAAoB,QAAkB,EAAU,SAA6B,EAAS,UAAsB,EAAS,YAA0B;YAA/I,YACE,kBAAM,YAAY,EAAE,UAAU,CAAC,SAChC;YAFmB,cAAQ,GAAR,QAAQ,CAAU;YAAU,eAAS,GAAT,SAAS,CAAoB;YAAS,gBAAU,GAAV,UAAU,CAAY;YAAS,kBAAY,GAAZ,YAAY,CAAc;;SAE9I;QACD,wDAAe,GAAf;YACE,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;SACtC;QACD,iDAAQ,GAAR;YACE,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;SACnC;QACD,oDAAW,GAAX;SACC;;oBAdFC,cAAS,SAAC;wBACT,QAAQ,EAAE,gBAAgB;qBAC3B;;;;;wBAP8CgD,aAAQ;wBAE9CrB,8BAAkB;wBAFQU,eAAU;wBACpCT,mBAAY;;;QAoBrB,qCAAC;KAAA,CAbmD,YAAY;;;QCAf7B,+CAAY;QAC3D,qCAAoB,QAAkB,EAAU,SAA0B,EAAS,UAAsB,EAAS,YAA0B;YAA5I,YACE,kBAAM,YAAY,EAAE,UAAU,CAAC,SAChC;YAFmB,cAAQ,GAAR,QAAQ,CAAU;YAAU,eAAS,GAAT,SAAS,CAAiB;YAAS,gBAAU,GAAV,UAAU,CAAY;YAAS,kBAAY,GAAZ,YAAY,CAAc;;SAE3I;QACD,qDAAe,GAAf;YACE,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;SACtC;QACD,8CAAQ,GAAR;YACE,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;SACnC;QACD,iDAAW,GAAX;SACC;;oBAdFC,cAAS,SAAC;wBACT,QAAQ,EAAE,aAAa;qBACxB;;;;;wBAP8CgD,aAAQ;wBAE9CgC,wBAAe;wBAFW3C,eAAU;wBACpCT,mBAAY;;;QAoBrB,kCAAC;KAAA,CAbgD,YAAY;;;QCAF7B,yDAAY;QACrE,+CAAoB,QAAkB,EAAU,SAAoC,EAAS,UAAsB,EAAS,YAA0B;YAAtJ,YACE,kBAAM,YAAY,EAAE,UAAU,CAAC,SAChC;YAFmB,cAAQ,GAAR,QAAQ,CAAU;YAAU,eAAS,GAAT,SAAS,CAA2B;YAAS,gBAAU,GAAV,UAAU,CAAY;YAAS,kBAAY,GAAZ,YAAY,CAAc;;SAErJ;QACD,+DAAe,GAAf;YACE,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;SACtC;QACD,wDAAQ,GAAR;YACE,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;SACnC;QACD,2DAAW,GAAX;SACC;;oBAdFC,cAAS,SAAC;wBACT,QAAQ,EAAE,uBAAuB;qBAClC;;;;;wBAP8CgD,aAAQ;wBAE9CU,yCAAyB;wBAFCrB,eAAU;wBACpCT,mBAAY;;;QAoBrB,4CAAC;KAAA,CAb0D,YAAY;;;QCAd7B,uDAAY;QACnE,6CAAoB,QAAkB,EAAU,SAAkC,EAAS,UAAsB,EAAS,YAA0B;YAApJ,YACE,kBAAM,YAAY,EAAE,UAAU,CAAC,SAChC;YAFmB,cAAQ,GAAR,QAAQ,CAAU;YAAU,eAAS,GAAT,SAAS,CAAyB;YAAS,gBAAU,GAAV,UAAU,CAAY;YAAS,kBAAY,GAAZ,YAAY,CAAc;;SAEnJ;QACD,6DAAe,GAAf;YACE,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;SACtC;QACD,sDAAQ,GAAR;YACE,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;SACnC;QACD,yDAAW,GAAX;SACC;;oBAdFC,cAAS,SAAC;wBACT,QAAQ,EAAE,qBAAqB;qBAChC;;;;;wBAP8CgD,aAAQ;wBAE9Ca,uCAAuB;wBAFGxB,eAAU;wBACpCT,mBAAY;;;QAoBrB,0CAAC;KAAA,CAbwD,YAAY;;;QCAvB7B,4CAAY;QACxD,kCAAoB,QAAkB,EAAU,SAAuB,EAAS,UAAsB,EAAS,YAA0B;YAAzI,YACE,kBAAM,YAAY,EAAE,UAAU,CAAC,SAChC;YAFmB,cAAQ,GAAR,QAAQ,CAAU;YAAU,eAAS,GAAT,SAAS,CAAc;YAAS,gBAAU,GAAV,UAAU,CAAY;YAAS,kBAAY,GAAZ,YAAY,CAAc;;SAExI;QACD,kDAAe,GAAf;YACE,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;SACtC;QACD,2CAAQ,GAAR;YACE,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;SACnC;QACD,8CAAW,GAAX;SACC;;oBAdFC,cAAS,SAAC;wBACT,QAAQ,EAAE,UAAU;qBACrB;;;;;wBAP8CgD,aAAQ;wBAE9CiC,kBAAY;wBAFc5C,eAAU;wBACpCT,mBAAY;;;QAoBrB,+BAAC;KAAA,CAb6C,YAAY;;;QCAJ7B,oDAAY;QAChE,0CAAoB,QAAkB,EAAU,SAA+B,EAAS,UAAsB,EAAS,YAA0B;YAAjJ,YACE,kBAAM,YAAY,EAAE,UAAU,CAAC,SAChC;YAFmB,cAAQ,GAAR,QAAQ,CAAU;YAAU,eAAS,GAAT,SAAS,CAAsB;YAAS,gBAAU,GAAV,UAAU,CAAY;YAAS,kBAAY,GAAZ,YAAY,CAAc;;SAEhJ;QACD,0DAAe,GAAf;YACE,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;SACtC;QACD,mDAAQ,GAAR;YACE,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;SACnC;QACD,sDAAW,GAAX;SACC;;oBAdFC,cAAS,SAAC;wBACT,QAAQ,EAAE,kBAAkB;qBAC7B;;;;;wBAP8CgD,aAAQ;wBAE9CF,kCAAoB;wBAFMT,eAAU;wBACpCT,mBAAY;;;QAoBrB,uCAAC;KAAA,CAbqD,YAAY;;;QCAd7B,kDAAY;QAC9D,wCAAoB,QAAkB,EAAU,SAA6B,EAAS,UAAsB,EAAS,YAA0B;YAA/I,YACE,kBAAM,YAAY,EAAE,UAAU,CAAC,SAChC;YAFmB,cAAQ,GAAR,QAAQ,CAAU;YAAU,eAAS,GAAT,SAAS,CAAoB;YAAS,gBAAU,GAAV,UAAU,CAAY;YAAS,kBAAY,GAAZ,YAAY,CAAc;;SAE9I;QACD,wDAAe,GAAf;YACE,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;SACtC;QACD,iDAAQ,GAAR;YACE,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;SACnC;QACD,oDAAW,GAAX;SACC;;oBAdFC,cAAS,SAAC;wBACT,QAAQ,EAAE,gBAAgB;qBAC3B;;;;;wBAP8CgD,aAAQ;wBAE9CkC,8BAAkB;wBAFQ7C,eAAU;wBACpCT,mBAAY;;;QAoBrB,qCAAC;KAAA,CAbmD,YAAY;;ICPhE;;;;;;;;;QAiBqD7B,mDAAW;QAI9D,yCAA+B,EAAa,EAA8B,MAA4B;YAAtG,YACE,iBAAO,SAIR;YAL8B,QAAE,GAAF,EAAE,CAAW;YAA8B,YAAM,GAAN,MAAM,CAAsB;YAFrF,YAAM,GAAkB,IAAI,CAAC;YAI5C,IAAI,KAAI,CAAC,MAAM,EAAE;gBACf,KAAI,CAAC,MAAM,CAAC,kBAAkB,GAAG,IAAI,CAAC;aACvC;;SACF;QAED,kDAAQ,GAAR;YAAA,iBAiBC;;YAfC,IAAI,CAAC,MAAM,CAAC,WAAW,CAAC,SAAS,CAAC,UAAC,MAAoB;gBACrD,IAAI,CAAC,MAAM,CAAC,UAAU,CAAC,EAAE;;oBAEvB,IAAM,IAAI,GAAG,MAAM,CAAC,UAAU,IAAI,MAAM,CAAC,UAAU,CAAC,MAAM,GAAG,CAAC,GAAG,MAAM,CAAC,UAAU,GAAG,IAAI,CAAC;oBAC1F,KAAI,CAAC,aAAa,CAAC,IAAI,CAAC,CAAC;iBAC1B;qBAAM;;oBAEL,KAAI,CAAC,cAAc,EAAE,CAAC;iBACvB;aACF,CAAC,CAAC;;YAEH,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,SAAS,CAAC;gBAC1B,IAAM,UAAU,GAAG,KAAI,CAAC,SAAS,IAAI,KAAI,CAAC,MAAM,CAAC,SAAS,CAAC;gBAC3D,KAAI,CAAC,WAAW,CAAC,IAAI,EAAE,UAAU,CAAC,CAAC;aACpC,CAAC,CAAC;SACJ;QACO,wDAAc,GAAtB;YAAA,iBAwBC;YAvBC,IAAM,SAAS,GAAG,MAAM,CAAC,MAAM,CAAC,EAAE,GAAG,IAAI,CAAC,SAAS,IAAI,IAAI,CAAC,MAAM,CAAC,SAAS,IAAI,EAAE,EAAE,CAAC;YACrF,IAAM,eAAe,GAAG,IAAI,CAAC,MAAM,CAAC,SAAS,CAAC;YAC9C,IAAM,IAAI,GAAG,EAAE,CAAC;YAChB,IAAM,WAAW,GAAG,IAAI,CAAC,MAAM,CAAC,SAAS,IAAI,IAAI,CAAC,MAAM,CAAC,SAAS,CAAC,IAAI,CAAC;YACxE,IAAI,WAAW,IAAI,IAAI,CAAC,EAAE,EAAE;gBAC1B,IAAM,gBAAgB,GAAG,SAAS,CAAC,eAAe,CAAC,CAAC;gBACpD,IAAM,aAAa,GAAG,IAAI,CAAC,EAAE,IAAI,IAAI,CAAC,EAAE,CAAC,IAAI,IAAI,IAAI,CAAC,EAAE,CAAC,IAAI,CAAC,cAAc,IAAI,IAAI,CAAC,EAAE,CAAC,IAAI,CAAC,cAAc,CAAC,WAAW,CAAkB,CAAC;gBAC1I,IAAM,SAAO,GAAG,aAAa,IAAI,aAAa,CAAC,OAAO,CAAC;gBACvD,IAAI,gBAAgB,IAAI,SAAO,EAAE;oBAC/B,IAAM,WAAW,GAAG,gBAAgB,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,UAAC,IAAI,IAAK,OAAA,IAAI,KAAK,SAAO,GAAA,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;oBAC7F,IAAI,WAAW,EAAE;wBACf,SAAS,CAAC,eAAe,CAAC,GAAG,WAAW,CAAC;qBAC1C;yBAAM;wBACL,OAAO,SAAS,CAAC,eAAe,CAAC,CAAC;qBACnC;iBACF;aACF;YACD,IAAI,SAAS,IAAI,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC,MAAM,GAAG,CAAC,EAAE;gBAClD,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC,OAAO,CAAC,UAAC,KAAK;oBACnC,KAAI,CAAC,QAAQ,CAAC,IAAI,EAAE,KAAK,CAAC,KAAK,CAAC,GAAG,CAAC,EAAE,EAAE,CAAC,CAAC;iBAC3C,CAAC,CAAC;gBACH,IAAI,CAAC,WAAW,CAAC,IAAI,EAAE,SAAS,EAAE,IAAI,CAAC,CAAC;aACzC;SACF;QACO,uDAAa,GAArB,UAAsB,IAAI;YACxB,IAAM,UAAU,GAAG,IAAI,CAAC,SAAS,IAAI,IAAI,CAAC,MAAM,CAAC,SAAS,CAAC;YAC3D,IAAM,OAAO,GAAG,IAAI,CAAC,MAAM,CAAC,SAAS,IAAI,IAAI,CAAC,cAAc,CAAC;YAC7D,IAAI,CAAC,WAAW,CAAC,IAAI,EAAE,UAAU,EAAE,KAAK,EAAE,OAAO,CAAC,CAAC;SACpD;;oBA3DFC,cAAS,SAAC,EAAE,QAAQ,EAAE,6BAA6B,EAAE;;;;;wBANfM,gBAAS,uBAWjCU,aAAQ;wBATdoB,kCAAoB,uBASoBpB,aAAQ,YAAIe,SAAI;;;;gCAH9D5B,UAAK,SAAC,2BAA2B;6BACjCA,UAAK,SAAC,QAAQ;;QAyDjB,sCAAC;KAAA,CA3DoD,WAAW;;IChBhE;QAA4CJ,iCAAe;QAA3D;;SAEC;QAAD,oBAAC;IAAD,CAFA,CAA4CoF,iBAAU,GAErD;IAKD,IAAY,QAGX;IAHD,WAAY,QAAQ;QAClB,uBAAW,CAAA;QACX,yBAAa,CAAA;IACf,CAAC,EAHW,QAAQ,KAAR,QAAQ,QAGnB;;;QC2CC,6CAAoB,QAAkB,EAAU,YAA0B,EAAU,iBAA+C;YAA/G,aAAQ,GAAR,QAAQ,CAAU;YAAU,iBAAY,GAAZ,YAAY,CAAc;YAAU,sBAAiB,GAAjB,iBAAiB,CAA8B;;;;YAT1H,QAAG,GAAW,IAAI,CAAC;;;;YAInB,WAAM,GAAW,KAAK,CAAC;YACvB,sBAAiB,GAAW,WAAW,CAAC;YACxC,oBAAe,GAAW,SAAS,CAAC;YACpC,qBAAgB,GAAW,UAAU,CAAC;SAEyF;QAvCxI,sBAAY,4DAAW;iBAAvB;gBACE,OAAO,IAAI,CAAC,YAAY,CAAC,WAAW,CAAC;aACtC;;;WAAA;QACD,sBAAY,0DAAS;iBAArB;gBACE,OAAO,IAAI,CAAC,YAAY,CAAC,SAAS,CAAC;aACpC;;;WAAA;QACO,yDAAW,GAAnB;YACE,OAAQ,IAAI,CAAC,YAAY,CAAC,UAA4B,CAAC,WAAW,CAAC;SACpE;QAID,sBAAc,4DAAW;;;;iBAAzB;;gBAEE,IAAI,IAAI,CAAC,SAAS,CAAC,WAAW,KAAK,GAAG,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,WAAW,EAAE;oBACrE,OAAO,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC;iBAC9B;;gBAED,IAAI,WAAW,GAAG,IAAI,CAAC,SAAS,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC;gBACvD,WAAW,GAAG,WAAW,CAAC,CAAC,CAAC,CAAC,WAAW,EAAE,GAAG,WAAW,CAAC,SAAS,CAAC,CAAC,EAAE,WAAW,CAAC,MAAM,CAAC,CAAC;gBAC1F,IAAM,KAAK,GAAG,WAAW,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;gBAErC,IAAM,aAAa,GAAG,KAAK,CAAC,MAAM,CAAC,UAAC,IAAY;oBAC9C,OAAO,IAAI,KAAK,EAAE,CAAC;iBACpB,CAAC,CAAC;gBACH,OAAO,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC,aAAa,CAAC,CAAC;aACjD;;;WAAA;QAeD,sDAAQ,GAAR;YACE,IAAI,CAAC,cAAc,EAAE,CAAC;YACtB,IAAI,CAAC,8BAA8B,EAAE,CAAC;SACvC;QACD,yDAAW,GAAX,UAAY,OAAsB;SAEjC;QACD,yDAAW,GAAX;YACE,IAAI,CAAC,gCAAgC,EAAE,CAAC;SACzC;QACO,sDAAQ,GAAhB,UAAiB,MAAc;;YAE7B,IAAI,IAAI,GAAQ,IAAI,CAAC,WAAW,CAAC,MAAM,EAAE,CAAC;YAC1C,IAAI,IAAI,CAAC,QAAQ,IAAIC,gBAAO,CAAC,IAAI,CAAC,QAAQ,EAAE,IAAI,CAAC,EAAE;gBACjD,OAAO;aACR;YACD,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC;YACrB,IAAI,CAAC,iBAAiB,CAAC,eAAe,CAAC,IAAI,CAAC,CAAC;SAC9C;QACO,iEAAmB,GAA3B,UAA4B,MAAc;YACxC,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC;YACtB,IAAI,CAAC,iBAAiB,CAAC,MAAM,CAAC,CAAC;SAChC;QACO,4EAA8B,GAAtC;YAAA,iBAIC;YAHC,IAAI,CAAC,sBAAsB,GAAG,IAAI,CAAC,WAAW,CAAC,OAAO,CAAC,SAAS,CAAC,UAAC,MAAc;gBAC9E,KAAI,CAAC,mBAAmB,CAAC,MAAM,CAAC,CAAC;aAClC,CAAC,CAAC;SACJ;;;;QAIO,8EAAgC,GAAxC;YACE,IAAI,IAAI,CAAC,sBAAsB,IAAI,QAAQ,IAAI,CAAC,sBAAsB,CAAC,WAAW,CAAC,KAAK,UAAU,EAAE;gBAClG,IAAI,CAAC,sBAAsB,CAAC,WAAW,EAAE,CAAC;aAC3C;SACF;QACO,4DAAc,GAAtB;YAAA,iBAeC;YAdC,IAAI,CAAC,IAAI,CAAC,GAAG,EAAE;gBACb,OAAO,CAAC,GAAG,CAAC,uBAAuB,CAAC,CAAC;gBACrC,OAAO;aACR;YACD,IAAM,WAAW,GAAG,IAAI,CAAC,WAAW,EAAE,CAAC,gBAAgB,EAAE,CAAC;YAC1D,IAAM,OAAO,GAAG;gBACd,IAAI,EAAE;oBACJ,WAAW,aAAA;iBACZ;aACF,CAAC;YACF,IAAM,GAAG,GAAGC,mBAAe,CAAC,WAAW,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;YAClD,IAAI,CAAC,WAAW,EAAE,CAAC,OAAO,CAAC,GAAG,EAAE,IAAI,CAAC,MAAM,EAAE,IAAI,EAAE,OAAO,CAAC,CAAC,SAAS,CAAC,UAAC,WAAgB;gBACrF,KAAI,CAAC,cAAc,CAAC,WAAW,CAAC,CAAC;aAClC,CAAC,CAAC;SACJ;QACO,4DAAc,GAAtB,UAAuB,SAAc;YACnC,IAAI,CAAC,iBAAiB,CAAC,aAAa,CAAC,SAAS,CAAC,CAAC;SACjD;QACO,yDAAW,GAAnB,UAAoB,SAAiB,EAAE,OAAe,EAAE,QAAgB;YACtE,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,gBAAgB,CAAC,IAAI,CAAC,iBAAiB,EAAE,SAAS,CAAC,CAAC;YAC3E,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,gBAAgB,CAAC,IAAI,CAAC,eAAe,EAAE,OAAO,CAAC,CAAC;YACvE,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,gBAAgB,CAAC,IAAI,CAAC,gBAAgB,EAAE,QAAQ,CAAC,CAAC;SAC1E;QACO,+DAAiB,GAAzB,UAA0B,MAAe;YACvC,IAAI,CAAC,IAAI,CAAC,WAAW,IAAI,CAAC,IAAI,CAAC,WAAW,CAAC,SAAS,EAAE;gBACpD,OAAO;aACR;;YAED,IAAI,MAAM,IAAI,MAAM,CAAC,IAAI,KAAKzE,iBAAU,CAAC,oBAAoB,EAAE;gBAC7D,OAAO;aACR;YACD,IAAI,IAAI,CAAC,SAAS,IAAI,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC,WAAW,CAAC,uBAAuB,KAAK,IAAI,EAAE;gBAC9F,OAAO;aACR;YACD,IAAM,EAAE,GAAG,IAAI,CAAC,iBAAiB,CAAC,UAAU,CAAC;YAC7C,IAAM,SAAS,GAAG,IAAI,CAAC,WAAW,CAAC,SAAS,CAAC;;YAE7C,IAAI,EAAE,KAAK,SAAS,EAAE;gBACpB,OAAO;aACR;YACD,IAAI,CAAC,iBAAiB,CAAC,IAAI,CAAC,WAAW,CAAC,SAAS,CAAC,CAAC;SACpD;QACO,+DAAiB,GAAzB,UAA0B,EAAU;YAClC,IAAI,CAAC,iBAAiB,CAAC,UAAU,CAAC,EAAE,CAAC,CAAC;SACvC;QAEM,2DAAa,GADpB,UACqB,KAAU;YACvB,IAAA,gBAAiE,EAA/D,iBAAgB,EAAhB,qCAAgB,EAAE,aAAY,EAAZ,AAAc,gBAAe,EAAf,oCAA+B,CAAC;YACxE,IAAI,SAAS,GAAG,IAAI,CAAC;YACrB,IAAI,OAAO,GAAG,IAAI,CAAC;YACnB,IAAI,CAAC,SAAS,EAAE;gBACd,OAAO;aACR;YACD,IAAI,QAAQ,KAAK,QAAQ,CAAC,GAAG,EAAE;gBAC7B,SAAS,GAAM,SAAS,cAAW,CAAC;gBACpC,OAAO,GAAM,SAAS,cAAW,CAAC;aACnC;iBAAM,IAAI,QAAQ,KAAK,QAAQ,CAAC,IAAI,IAAI,SAAS,CAAC,OAAO,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC,EAAE;gBACtE,IAAM,QAAQ,GAAG,SAAS,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;gBACtC,SAAS,GAAM,QAAQ,CAAC,CAAC,CAAC,cAAW,CAAC;gBACtC,OAAO,GAAM,QAAQ,CAAC,CAAC,CAAC,cAAW,CAAC;aACrC;YACD,IAAI,CAAC,WAAW,CAAC,SAAS,EAAE,OAAO,EAAE,QAAQ,CAAC,CAAC;SAChD;QACS,yEAA2B,GAArC,UAAsC,EAAU;;YAE9C,IAAI,IAAI,CAAC,WAAW,CAAC,SAAS,KAAK,EAAE,EAAE;gBACrC,IAAI,CAAC,WAAW,CAAC,YAAY,CAAC,EAAE,EAAE,IAAI,CAAC,CAAC;aACzC;SACF;QAEM,0DAAY,GADnB,UACoB,KAAK;YACP,IAAA,kBAAS,EAAT,8BAAS,CAAa;YACtC,IAAI,CAAC,2BAA2B,CAAC,EAAE,CAAC,CAAC;SACtC;;oBA7JFZ,cAAS,SAAC;wBACT,QAAQ,EAAE,uCAAuC;qBAClD;;;;;wBAXuEgD,aAAQ;wBAGdpB,mBAAY;wBACrE0D,gDAA4B;;;;0BAyClCnF,UAAK;6BAILA,UAAK;wCACLA,UAAK;sCACLA,UAAK;uCACLA,UAAK;oCAsFLC,iBAAY,SAAC,cAAc,EAAE,CAAC,QAAQ,CAAC;mCAwBvCA,iBAAY,SAAC,cAAc,EAAE,CAAC,QAAQ,CAAC;;QAK1C,0CAAC;KA9JD;;;QCcE,qCAAoB,EAAqB,EAAU,QAAkB,EAAU,EAAqB,EAAU,EAAc,EAClH,YAA0B;YADhB,OAAE,GAAF,EAAE,CAAmB;YAAU,aAAQ,GAAR,QAAQ,CAAU;YAAU,OAAE,GAAF,EAAE,CAAmB;YAAU,OAAE,GAAF,EAAE,CAAY;YAClH,iBAAY,GAAZ,YAAY,CAAc;YARd,kBAAa,GAAG,KAAK,CAAC;YACnC,eAAU,GAAG,EAAE,CAAC;SAOgB;QALjC,iDAAW,GAAnB;YACE,OAAQ,IAAI,CAAC,YAAY,CAAC,UAA4B,CAAC,WAAW,CAAC;SACpE;QAKD,8CAAQ,GAAR;SAEC;QAED,iDAAW,GAAX,UAAY,OAAsB;YAChC,IAAI,OAAO,CAAC,UAAU,IAAI,CAAC,OAAO,CAAC,UAAU,CAAC,aAAa,EAAE,EAAE;gBAC7D,IAAI,CAAC,YAAY,EAAE,CAAC;aACrB;SACF;QAED,qDAAe,GAAf;YACE,IAAI,CAAC,YAAY,EAAE,CAAC;SACrB;QAEO,kDAAY,GAApB;YAAA,iBAQC;YAPC,IAAI,IAAI,CAAC,aAAa,IAAI,IAAI,CAAC,UAAU,EAAE;gBACzC,IAAI,CAAC,aAAa,EAAE,CAAC,SAAS,CAAC,UAAC,GAAe;oBAC7C,IAAI,KAAI,CAAC,EAAE,IAAI,OAAO,KAAI,CAAC,EAAE,CAAC,YAAY,KAAK,UAAU,EAAE;wBACzD,KAAI,CAAC,EAAE,CAAC,YAAY,CAAC,GAAG,CAAC,CAAC;qBAC3B;iBACF,CAAC,CAAC;aACJ;SACF;QAGO,mDAAa,GAArB;YACE,OAAO,IAAI,CAAC,WAAW,EAAE,CAAC,OAAO,CAAC,IAAI,CAAC,UAAU,EAAE,KAAK,CAAC,CAAC;SAC3D;;oBAvCFJ,cAAS,SAAC,EAAE,QAAQ,EAAE,eAAe,EAAE;;;;;wBAd/B6C,4BAAiB;wBADwCG,aAAQ;wBAAlDuC,sBAAiB;wBAAalD,eAAU;wBAEvDT,mBAAY;;;;oCAelBzB,UAAK,SAAC,aAAa;iCACnBA,UAAK;;QAqCR,kCAAC;KAxCD;;;QCAE,sCACU,QAAkB,EAClB,YAA0B,EACd,eAAgC;YAF5C,aAAQ,GAAR,QAAQ,CAAU;YAClB,iBAAY,GAAZ,YAAY,CAAc;YACd,oBAAe,GAAf,eAAe,CAAiB;;;;YAJ/B,iBAAY,GAAG,qBAAqB,CAAC;YAM1D,IAAI,CAAC,QAAQ,GAAG,IAAIsB,YAAO,EAAO,CAAC;SACpC;QACD,kDAAW,GAAX;YACE,IAAI,IAAI,CAAC,QAAQ,EAAE;gBACjB,IAAI,CAAC,QAAQ,CAAC,IAAI,EAAE,CAAC;gBACrB,IAAI,CAAC,QAAQ,CAAC,QAAQ,EAAE,CAAC;aAC1B;SACF;QACD,+CAAQ,GAAR;YAAA,iBAOC;YANC,IAAI,IAAI,CAAC,eAAe,EAAE;gBACxB,IAAI,CAAC,eAAe,CAAC,gBAAgB,CAAC,IAAI,CAAC+D,mBAAS,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC,SAAS,CAAC,UAAC,KAAU;oBAChF,IAAA,uBAAW,EAAX,gCAAW,CAAiB;oBACpC,KAAI,CAAC,aAAa,CAAC,IAAI,CAAC,CAAC;iBAC1B,CAAC,CAAC;aACJ;SACF;QACO,oDAAa,GAArB,UAAsB,UAAkB;YACtC,IAAI,CAAC,YAAY,CAAC,OAAO,CAAC,gBAAgB,CAAC,IAAI,CAAC,YAAY,EAAE,UAAU,CAAC,CAAC;SAC3E;;oBAhCFxF,cAAS,SAAC;wBACT,QAAQ,EAAE,yBAAyB;qBACpC;;;;;wBARmBgD,aAAQ;wBACnBpB,mBAAY;wBACZgD,wBAAe,uBAgBnB5D,aAAQ;;;;mCAJVb,UAAK,SAAC,cAAc;;QAyBvB,mCAAC;KAjCD;;;QCSE,0CACU,QAAkB,EAClB,YAA0B,EACd,mBAAwC;YAFpD,aAAQ,GAAR,QAAQ,CAAU;YAClB,iBAAY,GAAZ,YAAY,CAAc;YACd,wBAAmB,GAAnB,mBAAmB,CAAqB;;;;YAJvC,iBAAY,GAAG,qBAAqB,CAAC;YAM1D,IAAI,CAAC,QAAQ,GAAG,IAAIsB,YAAO,EAAO,CAAC;SACpC;QACD,sDAAW,GAAX;YACE,IAAI,IAAI,CAAC,QAAQ,EAAE;gBACjB,IAAI,CAAC,QAAQ,CAAC,IAAI,EAAE,CAAC;gBACrB,IAAI,CAAC,QAAQ,CAAC,QAAQ,EAAE,CAAC;aAC1B;SACF;QACD,mDAAQ,GAAR;YAAA,iBAOC;YANC,IAAI,IAAI,CAAC,mBAAmB,EAAE;gBAC5B,IAAI,CAAC,mBAAmB,CAAC,gBAAgB,CAAC,IAAI,CAAC+D,mBAAS,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC,SAAS,CAAC,UAAC,KAAU;oBACpF,IAAA,uBAAW,EAAX,gCAAW,CAAiB;oBACpC,KAAI,CAAC,aAAa,CAAC,IAAI,CAAC,CAAC;iBAC1B,CAAC,CAAC;aACJ;SACF;QACO,wDAAa,GAArB,UAAsB,UAAkB;YACtC,IAAI,CAAC,YAAY,CAAC,OAAO,CAAC,gBAAgB,CAAC,IAAI,CAAC,YAAY,EAAE,UAAU,CAAC,CAAC;SAC3E;;oBAhCFxF,cAAS,SAAC;wBACT,QAAQ,EAAE,8BAA8B;qBACzC;;;;;wBARmBgD,aAAQ;wBACnBpB,mBAAY;wBACZ+C,gCAAmB,uBAgBvB3D,aAAQ;;;;mCAJVb,UAAK,SAAC,cAAc;;QAyBvB,uCAAC;KAjCD;;;QCCE,0BAAgC,QAAkB;YAAlB,aAAQ,GAAR,QAAQ,CAAU;YAF1C,eAAU,GAAGkF,mBAAe,CAAC,WAAW,CAAC,6CAA6C,CAAC,CAAC;YAG9F,IAAI,CAAC,eAAe,GAAG,IAAI,CAAC,QAAQ,IAAI,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAkBI,6BAAe,EAAE,IAAI,CAAC,IAAI,IAAI,CAAC;SAC3G;QAED,oCAAS,GAAT,UAAU,KAAa,EAAE,MAA+B;YAA/B,uBAAA;gBAAA,uBAA+B;;YACtD,IAAI,CAAC,KAAK,EAAE;gBACV,OAAO,IAAI,CAAC,UAAU,CAAC;aACxB;;YAED,IAAI,IAAI,CAAC,eAAe,EAAE;gBACxB,OAAO,IAAI,CAAC,eAAe,CAAC,cAAc,CAAC,KAAK,EAAE,MAAM,CAAC,CAAC;aAC3D;iBAAM;gBACL,OAAO,CAAC,IAAI,CAAC,iCAAiC,CAAC,CAAC;gBAChD,OAAOJ,mBAAe,CAAC,WAAW,CAAC,4CAA0C,KAAO,CAAC,CAAC;aACvF;SACF;;oBAnBFvF,SAAI,SAAC,EAAE,IAAI,EAAE,cAAc,EAAE;;;;;wBAHrBkD,aAAQ,uBAOFhC,aAAQ;;;QAgBvB,uBAAC;KApBD;;;QCKE,wCAAoB,GAAwB,EAAsB,QAAmB;YAAjE,QAAG,GAAH,GAAG,CAAqB;YAAsB,aAAQ,GAAR,QAAQ,CAAW;YACnF,IAAI,IAAI,CAAC,QAAQ,EAAE;gBACjB,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC0E,sBAAa,CAAC,CAAC;aACvD;SACF;QAED,kDAAS,GAAT,UAAU,GAAQ,EAAE,OAAY;YAC9B,IAAI,KAAK,GAAG,EAAE,CAAC;YACf,IAAI,OAAO,IAAI,GAAG,IAAI,GAAG,CAAC,KAAK,EAAE;gBAC/B,KAAK,GAAG,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,KAAK,EAAE,OAAO,CAAC,CAAC;gBAC1C,IAAI,WAAW,GAAG,GAAG,CAAC,SAAS,CAAC;gBAChC,IAAI,CAAC,WAAW,EAAE;oBAChB,IAAI,GAAG,CAAC,mBAAmB,EAAE;wBAC3B,OAAO,IAAI,CAAC,qBAAqB,CAAC,KAAK,CAAC,CAAC;qBAC1C;yBAAM;wBACL,OAAO,KAAK,CAAC;qBACd;iBACF;qBAAM;oBACL,OAAO,IAAI,CAAC,GAAG,CAAC,MAAM,CAAC,KAAK,EAAE,OAAO,EAAE,WAAW,CAAC,CAAC;iBACrD;aACF;YACD,OAAO,EAAE,CAAC;SACX;;QAGO,8DAAqB,GAA7B,UAA8B,MAAM;YAClC,IAAI,MAAM,IAAI,OAAO,MAAM,KAAK,QAAQ,IAAI,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,MAAM,GAAG,CAAC,EAAE;gBAC1E,IAAM,QAAQ,GAAG,IAAI,CAAC,aAAa,IAAI,IAAI,CAAC,aAAa,CAAC,QAAQ,IAAI,QAAQ,CAAC;gBAC/E,IAAM,KAAK,GAAG,MAAM,CAAC,QAAQ,CAAC,CAAC;gBAC/B,OAAO,KAAK,KAAK,SAAS,GAAG,EAAE,GAAG,KAAK,CAAC;aACzC;iBAAM;gBACL,OAAO,EAAE,CAAC;aACX;SACF;QACO,iDAAQ,GAAhB,UAAiB,IAAY,EAAE,MAAW;YACxC,IAAI,CAAC,MAAM,EAAE;gBACX,OAAO,EAAE,CAAC;aACX;YACD,IAAI,SAAS,GAAG,EAAE,CAAC;YACnB,IAAI,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC,EAAE;gBAC5B,SAAS,GAAG,MAAM,CAAC,IAAI,CAAC,CAAC;aAC1B;iBACI;gBACH,SAAS,GAAG,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,EAAE,UAAC,GAAG,EAAE,GAAG;oBAC3C,OAAO,GAAG,IAAI,GAAG,CAAC,GAAG,CAAC,IAAI,IAAI,CAAC;iBAChC,GAAG,MAAM,CAAC,CAAC;aACb;YACD,OAAO,SAAS,CAAC;SAClB;;;;;QAKO,qDAAY,GAApB,UAAqB,GAAQ;YAC3B,OAAO,GAAG,IAAI,GAAG,CAAC,MAAM,IAAI,GAAG,CAAC,MAAM,CAAC,OAAO,IAAI,GAAG,CAAC,MAAM,CAAC,OAAO,CAAC,IAAI,KAAK,oBAAoB,IAAI,KAAK,CAAC;SAC7G;QACO,2DAAkB,GAA1B,UAA2B,GAAQ,EAAE,IAAS;YAC5C,IAAM,SAAS,GAAG,IAAI,CAAC,uBAAuB,CAAC,GAAG,CAAC,CAAC;YACpD,IAAM,SAAS,GAAG,IAAI,CAAC,uBAAuB,CAAC,GAAG,CAAC,CAAC;YACpD,IAAI,SAAS,IAAI,SAAS,IAAI,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC,MAAM,GAAG,CAAC,EAAE;gBAC/D,IAAM,IAAI,GAAG,SAAS,CAAC,SAAS,CAAC,CAAC;gBAClC,OAAO,IAAI,CAAC,QAAQ,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;aAClC;YACD,OAAO,EAAE,CAAC;SACX;QACO,gEAAuB,GAA/B,UAAgC,GAAQ;YACtC,OAAO,GAAG,IAAI,GAAG,CAAC,MAAM,IAAI,GAAG,CAAC,MAAM,CAAC,OAAO,IAAI,GAAG,CAAC,MAAM,CAAC,OAAO,CAAC,SAAS,IAAI,EAAE,CAAC;SACtF;QACO,gEAAuB,GAA/B,UAAgC,GAAQ;YACtC,OAAO,GAAG,IAAI,GAAG,CAAC,MAAM,IAAI,GAAG,CAAC,MAAM,CAAC,OAAO,IAAI,GAAG,CAAC,MAAM,CAAC,OAAO,CAAC,SAAS,IAAI,EAAE,CAAC;SACtF;;oBA1EF5F,SAAI,SAAC,EAAE,IAAI,EAAE,gCAAgC,EAAE,IAAI,EAAE,KAAK,EAAE;;;;;wBAFpD6F,0BAAmB;wBADE3C,aAAQ,uBAOWhC,aAAQ;;;QAuEzD,qCAAC;KA3ED;;;QCGE,sBAAgC,QAAkB,EAAqC,YAA0B;YAAjF,aAAQ,GAAR,QAAQ,CAAU;YAAqC,iBAAY,GAAZ,YAAY,CAAc;SAChH;QACM,gCAAS,GAAhB,UAAiB,KAAU,EAAE,QAAgB;YAC3C,IAAI,QAAQ,EAAE;gBACZ,QAAQ,GAAG,QAAQ,CAAC,WAAW,EAAE,CAAC;gBAClC,IAAI,QAAQ,KAAK,MAAM,EAAE;oBACvB,OAAO,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;iBAClC;qBAAM,IAAI,QAAQ,KAAK,UAAU,EAAE;oBAClC,OAAO,IAAI,CAAC,iBAAiB,CAAC,KAAK,CAAC,CAAC;iBACtC;qBAAM,IAAI,QAAQ,KAAK,QAAQ,EAAE;oBAChC,OAAO,IAAI,CAAC,eAAe,CAAC,KAAK,CAAC,CAAC;iBACpC;qBAAM;oBACL,OAAO,KAAK,CAAC;iBACd;aACF;SACF;;;;;QAKO,oCAAa,GAArB,UAAsB,KAAU;YAC9B,IAAI,UAAU,GAAG,IAAI,CAAC,YAAY,IAAI,IAAI,CAAC,YAAY,CAAC,UAAU,IAAI,IAAI,CAAC;YAC3E,IAAI,CAAC,UAAU,IAAI,CAAC,KAAK,EAAE;gBACzB,OAAO,KAAK,CAAC;aACd;YACD,IAAMuD,OAAI,GAAG,MAAM,CAAC,KAAK,CAAC,CAAC;YAC3B,IAAM,OAAO,GAAGA,OAAI,CAAC,OAAO,EAAE,CAAC;YAC/B,IAAI,CAAC,OAAO,EAAE;gBACZ,OAAO,KAAK,CAAC;aACd;YACD,UAAU,GAAG,IAAI,CAAC,eAAe,CAAC,UAAU,CAAC,CAAC;YAC9C,OAAOA,OAAI,CAAC,MAAM,CAAC,UAAU,CAAC,CAAC;SAChC;;;;;;QAMO,wCAAiB,GAAzB,UAA0B,KAAU;YAClC,IAAI,UAAU,GAAG,IAAI,CAAC,YAAY,IAAI,IAAI,CAAC,YAAY,CAAC,UAAU,IAAI,EAAE,CAAC;YACzE,IAAI,UAAU,GAAG,IAAI,CAAC,YAAY,IAAI,IAAI,CAAC,YAAY,CAAC,UAAU,IAAI,EAAE,CAAC;YACzE,IAAM,QAAQ,GAAG,MAAM,CAAC,KAAK,CAAC,CAAC;YAC/B,IAAM,OAAO,GAAG,QAAQ,CAAC,OAAO,EAAE,CAAC;YACnC,IAAI,CAAC,OAAO,EAAE;gBACZ,OAAO,KAAK,CAAC;aACd;YACD,IAAI,UAAU,EAAE;gBACd,UAAU,GAAG,IAAI,CAAC,eAAe,CAAC,UAAU,CAAC,CAAC;aAC/C;YACD,IAAI,UAAU,EAAE;gBACd,UAAU,GAAG,IAAI,CAAC,eAAe,CAAC,UAAU,CAAC,CAAC;aAC/C;YACD,IAAM,cAAc,GAAG,UAAU,GAAG,GAAG,GAAG,UAAU,CAAC;YACrD,OAAO,QAAQ,CAAC,MAAM,CAAC,cAAc,CAAC,CAAC;SACxC;;;;;QAKO,sCAAe,GAAvB,UAAwB,KAAK;YAC3B,IAAI,KAAK,KAAK,IAAI,IAAI,KAAK,KAAK,SAAS,IAAI,KAAK,KAAK,EAAE,EAAE;gBACzD,OAAO,EAAE,CAAC;aACX;YACD,IAAM,SAAS,GAAG,IAAIC,sBAAS,CAAC,KAAK,CAAC,CAAC;;YAEvC,IAAI,CAACA,sBAAS,CAAC,WAAW,CAAC,SAAS,CAAC,EAAE;gBACrC,OAAO,KAAK,CAAC;aACd;YACD,IAAM,UAAU,GAAG,SAAS,CAAC,UAAU,EAAE,CAAC;YAC1C,IAAM,MAAM,GAAG,IAAI,CAAC,iBAAiB,EAAE,CAAC;YAClC,IAAA,sBAAuE,EAArE,oBAAmB,EAAnB,wCAAmB,EAAE,2BAA0B,EAA1B,+CAAgD,CAAC;YAC9E,IAAI,UAAU,EAAE;gBACd,IAAI,YAAY,KAAK,IAAI,EAAE;oBACzB,MAAM,CAAC,MAAM,GAAG,YAAY,CAAC;oBAC7B,OAAO,SAAS,CAAC,aAAa,EAAE,CAAC,QAAQ,CAAC,mBAAmB,EAAE,IAAI,EAAE,MAAM,CAAC,CAAC;iBAC9E;aACF;YACD,OAAO,SAAS,CAAC,QAAQ,CAAC,mBAAmB,EAAE,IAAI,EAAE,MAAM,CAAC,CAAC;SAC9D;;;;;QAKO,sCAAe,GAAvB,UAAwB,MAAc;YACpC,OAAO,MAAM,CAAC,OAAO,CAAC,IAAI,EAAE,GAAG,CAAC,CAAC,OAAO,CAAC,IAAI,EAAE,GAAG,CAAC,CAAC;SACrD;;;;;QAKO,sCAAe,GAAvB,UAAwB,MAAc;YACpC,OAAO,MAAM,CAAC,OAAO,CAAC,IAAI,EAAE,GAAG,CAAC,CAAC;SAClC;;;;QAIO,wCAAiB,GAAzB;YACE,IAAI,IAAI,CAAC,YAAY,EAAE;gBACf,IAAA,sBAAkF,EAAhF,8BAA6B,EAA7B,kDAA6B,EAAE,4BAA2B,EAA3B,gDAAiD,CAAC;gBACzF,IAAM,MAAM,GAAQ;oBAClB,SAAS,EAAE,CAAC;iBACb,CAAC;gBACF,IAAI,sBAAsB,KAAK,IAAI,EAAE;oBACnC,MAAM,CAAC,gBAAgB,GAAG,sBAAsB,CAAC;iBAClD;gBACD,IAAI,oBAAoB,KAAK,IAAI,EAAE;oBACjC,MAAM,CAAC,cAAc,GAAG,oBAAoB,CAAC;iBAC9C;gBACD,OAAO,MAAM,CAAC;aACf;SACF;QACD,sBAAY,sCAAY;iBAAxB;gBACE,OAAO,IAAI,CAAC,YAAY,IAAI,IAAI,CAAC,YAAY,CAAC,YAAY,IAAI,IAAI,CAAC;aACpE;;;WAAA;;oBAnHF1E,SAAI,SAAC,EAAE,IAAI,EAAE,cAAc,EAAE;;;;;wBALbkD,aAAQ,uBAOVhC,aAAQ;wDAAgCkD,WAAM,SAACC,wBAAiB;;;QAkH/E,mBAAC;KApHD;;;QCwEA;SA0JC;;oBA1JAyB,aAAQ,SAAC;wBACR,OAAO,EAAE;4BACPC,mBAAY;4BACZC,2BAAkB,CAAC,OAAO,EAAE;yBAC7B;wBACD,YAAY,EAAE;4BACZ,yBAAyB;4BACzB,+BAA+B;4BAC/B,0BAA0B;4BAC1B,qCAAqC;4BACrC,uBAAuB;4BACvB,uBAAuB;4BACvB,mBAAmB;4BACnB,kCAAkC;4BAClC,wBAAwB;4BACxB,2BAA2B;4BAC3B,8BAA8B;4BAC9B,gBAAgB;4BAChB,4BAA4B;4BAC5B,oBAAoB;4BACpB,yBAAyB;4BACzB,gBAAgB;4BAChB,8BAA8B;4BAC9B,qCAAqC;4BACrC,+BAA+B;4BAC/B,8BAA8B;4BAC9B,iBAAiB;4BACjB,wBAAwB;4BACxB,eAAe;4BACf,qBAAqB;4BACrB,8BAA8B;4BAC9B,0BAA0B;4BAC1B,yBAAyB;4BACzB,oCAAoC;4BACpC,iCAAiC;4BACjC,uBAAuB;4BACvB,sCAAsC;4BACtC,oCAAoC;4BACpC,sCAAsC;4BACtC,8BAA8B;4BAC9B,qBAAqB;4BACrB,qCAAqC;4BACrC,+BAA+B;4BAC/B,iCAAiC;4BACjC,+BAA+B;4BAC/B,+BAA+B;4BAC/B,YAAY;4BACZ,mCAAmC;4BACnC,gCAAgC;4BAChC,4BAA4B;4BAC5B,4BAA4B;4BAC5B,6BAA6B;4BAC7B,+BAA+B;4BAC/B,+BAA+B;4BAC/B,2BAA2B;4BAC3B,4BAA4B;4BAC5B,+BAA+B;4BAC/B,+BAA+B;4BAC/B,+BAA+B;4BAC/B,+BAA+B;4BAC/B,kCAAkC;4BAClC,8BAA8B;4BAC9B,gCAAgC;4BAChC,+BAA+B;4BAC/B,6BAA6B;4BAC7B,8BAA8B;4BAC9B,2BAA2B;4BAC3B,qCAAqC;4BACrC,mCAAmC;4BACnC,wBAAwB;4BACxB,gCAAgC;4BAChC,8BAA8B;4BAC9B,+BAA+B;4BAC/B,mCAAmC;4BACnC,2BAA2B;4BAC3B,4BAA4B;4BAC5B,gCAAgC;yBACjC;wBACD,SAAS,EAAE;4BACT1E,sBAAa,EAAEF,8BAAa,EAAE,4BAA4B,EAAE,4BAA4B;yBAAC;wBAC3F,OAAO,EAAE;4BACP,yBAAyB;4BACzB,+BAA+B;4BAC/B,0BAA0B;4BAC1B,qCAAqC;4BACrC,uBAAuB;4BACvB,uBAAuB;4BACvB,mBAAmB;4BACnB,kCAAkC;4BAClC,wBAAwB;4BACxB,2BAA2B;4BAC3B,8BAA8B;4BAC9B,gBAAgB;4BAChB,4BAA4B;4BAC5B,yBAAyB;4BACzB,gBAAgB;4BAChB,8BAA8B;4BAC9B,qCAAqC;4BACrC,+BAA+B;4BAC/B,8BAA8B;4BAC9B,iBAAiB;4BACjB,wBAAwB;4BACxB,eAAe;4BACf,qBAAqB;4BACrB,8BAA8B;4BAC9B,0BAA0B;4BAC1B,yBAAyB;4BACzB,oCAAoC;4BACpC,iCAAiC;4BACjC,uBAAuB;4BACvB,sCAAsC;4BACtC,oCAAoC;4BACpC,sCAAsC;4BACtC,8BAA8B;4BAC9B,qBAAqB;4BACrB,qCAAqC;4BACrC,+BAA+B;4BAC/B,iCAAiC;4BACjC,+BAA+B;4BAC/B,+BAA+B;4BAC/B,YAAY;4BACZ,mCAAmC;4BACnC,gCAAgC;4BAChC,4BAA4B;4BAC5B,4BAA4B;4BAC5B,6BAA6B;4BAC7B,+BAA+B;4BAC/B,+BAA+B;4BAC/B,2BAA2B;4BAC3B,4BAA4B;4BAC5B,+BAA+B;4BAC/B,+BAA+B;4BAC/B,+BAA+B;4BAC/B,+BAA+B;4BAC/B,kCAAkC;4BAClC,8BAA8B;4BAC9B,gCAAgC;4BAChC,+BAA+B;4BAC/B,6BAA6B;4BAC7B,8BAA8B;4BAC9B,2BAA2B;4BAC3B,qCAAqC;4BACrC,mCAAmC;4BACnC,wBAAwB;4BACxB,gCAAgC;4BAChC,8BAA8B;4BAC9B,+BAA+B;4BAC/B,mCAAmC;4BACnC,2BAA2B;4BAC3B,4BAA4B;4BAC5B,gCAAgC;yBACjC;qBACF;;QAED,yBAAC;KA1JD;;IC7EA;;OAEG;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}
