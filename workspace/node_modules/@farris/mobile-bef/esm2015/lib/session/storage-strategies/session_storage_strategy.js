/**
 * @fileoverview added by tsickle
 * Generated from: lib/session/storage-strategies/session_storage_strategy.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
/**
 * 基于浏览器SessionStorage的BeSession缓存
 * \@summary
 * 1、SeparatedSession模式下：
 *  {
 *    BE_SESSION_ID: {
 *      frmSessionId1_beSessionUri1: beSessionId-1,
 *      frmSessionId2_beSessionUri2: beSessionId-2,
 *    }
 *  }
 * 2、UnifiedSession模式下（在Debug状态，同模式1）：
 * {
 *    BE_SESSION_ID: {
 *      frmSessionId1: beSessionId-1,
 *      frmSessionId2: beSessionId-2,
 *    }
 *  }
 */
class SessionStorageBeSessionStorageStrategy {
    constructor() {
        /**
         * 缓存Token
         */
        this.sessionStorageKey = 'BE_SESSION_ID';
    }
    /**
     * 获取值
     * @param {?} beSessionKey
     * @return {?}
     */
    getItem(beSessionKey) {
        /** @type {?} */
        const beSessions = this.getAllBeSessions();
        return beSessions[beSessionKey];
    }
    /**
     * 设置值
     * @param {?} beSessionKey
     * @param {?} beSessionId
     * @return {?}
     */
    setItem(beSessionKey, beSessionId) {
        /** @type {?} */
        const beSessions = this.getAllBeSessions();
        beSessions[beSessionKey] = beSessionId;
        this.setAllBeSessions(beSessions);
    }
    /**
     * 删除值
     * @param {?} beSessionKey
     * @return {?}
     */
    removeItem(beSessionKey) {
        /** @type {?} */
        const beSessions = this.getAllBeSessions();
        if (beSessions[beSessionKey]) {
            delete beSessions[beSessionKey];
        }
        this.setAllBeSessions(beSessions);
    }
    /**
     * 根据scope删除值
     * @param {?} beSessionScope
     * @return {?}
     */
    removeItemsByScope(beSessionScope) {
        /** @type {?} */
        const beSessions = this.getAllBeSessions();
        Object.keys(beSessions).forEach((/**
         * @param {?} beSessionKey
         * @return {?}
         */
        (beSessionKey) => {
            if (beSessionKey.startsWith(beSessionScope) === true) {
                delete beSessions[beSessionKey];
            }
        }));
        this.setAllBeSessions(beSessions);
    }
    /**
     * 清空所有会话
     * @return {?}
     */
    clear() {
        window.sessionStorage.removeItem(this.sessionStorageKey);
    }
    /**
     * 从SessionStorage中获取全部BeSessions
     * @private
     * @return {?}
     */
    getAllBeSessions() {
        /** @type {?} */
        const beSessionsJson = window.sessionStorage.getItem(this.sessionStorageKey);
        if (!beSessionsJson) {
            return {};
        }
        return JSON.parse(beSessionsJson);
    }
    /**
     * 设置全部BeSessions到SessionStorage
     * @param {?} beSessions
     * @return {?}
     */
    setAllBeSessions(beSessions) {
        /** @type {?} */
        const beSessionsString = JSON.stringify(beSessions);
        window.sessionStorage.setItem(this.sessionStorageKey, beSessionsString);
    }
}
if (false) {
    /**
     * 缓存Token
     * @type {?}
     * @private
     */
    SessionStorageBeSessionStorageStrategy.prototype.sessionStorageKey;
}
export { SessionStorageBeSessionStorageStrategy };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2Vzc2lvbl9zdG9yYWdlX3N0cmF0ZWd5LmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGZhcnJpcy9tb2JpbGUtYmVmLyIsInNvdXJjZXMiOlsibGliL3Nlc3Npb24vc3RvcmFnZS1zdHJhdGVnaWVzL3Nlc3Npb25fc3RvcmFnZV9zdHJhdGVneS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQW9CQSxNQUFNLHNDQUFzQztJQUE1Qzs7OztRQUtVLHNCQUFpQixHQUFHLGVBQWUsQ0FBQztJQW9FOUMsQ0FBQzs7Ozs7O0lBL0RRLE9BQU8sQ0FBQyxZQUFvQjs7Y0FDM0IsVUFBVSxHQUFHLElBQUksQ0FBQyxnQkFBZ0IsRUFBRTtRQUMxQyxPQUFPLFVBQVUsQ0FBQyxZQUFZLENBQUMsQ0FBQztJQUNsQyxDQUFDOzs7Ozs7O0lBS00sT0FBTyxDQUFDLFlBQW9CLEVBQUUsV0FBbUI7O2NBQ2hELFVBQVUsR0FBRyxJQUFJLENBQUMsZ0JBQWdCLEVBQUU7UUFDMUMsVUFBVSxDQUFDLFlBQVksQ0FBQyxHQUFHLFdBQVcsQ0FBQztRQUN2QyxJQUFJLENBQUMsZ0JBQWdCLENBQUMsVUFBVSxDQUFDLENBQUM7SUFDcEMsQ0FBQzs7Ozs7O0lBS00sVUFBVSxDQUFDLFlBQW9COztjQUM5QixVQUFVLEdBQUcsSUFBSSxDQUFDLGdCQUFnQixFQUFFO1FBQzFDLElBQUksVUFBVSxDQUFDLFlBQVksQ0FBQyxFQUFFO1lBQzVCLE9BQU8sVUFBVSxDQUFDLFlBQVksQ0FBQyxDQUFDO1NBQ2pDO1FBQ0QsSUFBSSxDQUFDLGdCQUFnQixDQUFDLFVBQVUsQ0FBQyxDQUFDO0lBQ3BDLENBQUM7Ozs7OztJQUtNLGtCQUFrQixDQUFDLGNBQXNCOztjQUN4QyxVQUFVLEdBQUcsSUFBSSxDQUFDLGdCQUFnQixFQUFFO1FBQzFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLENBQUMsT0FBTzs7OztRQUFDLENBQUMsWUFBb0IsRUFBRSxFQUFFO1lBQ3ZELElBQUksWUFBWSxDQUFDLFVBQVUsQ0FBQyxjQUFjLENBQUMsS0FBSyxJQUFJLEVBQUU7Z0JBQ3BELE9BQU8sVUFBVSxDQUFDLFlBQVksQ0FBQyxDQUFDO2FBQ2pDO1FBQ0gsQ0FBQyxFQUFDLENBQUM7UUFDSCxJQUFJLENBQUMsZ0JBQWdCLENBQUMsVUFBVSxDQUFDLENBQUM7SUFDcEMsQ0FBQzs7Ozs7SUFLTSxLQUFLO1FBQ1YsTUFBTSxDQUFDLGNBQWMsQ0FBQyxVQUFVLENBQUMsSUFBSSxDQUFDLGlCQUFpQixDQUFDLENBQUM7SUFDM0QsQ0FBQzs7Ozs7O0lBS08sZ0JBQWdCOztjQUNoQixjQUFjLEdBQUcsTUFBTSxDQUFDLGNBQWMsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLGlCQUFpQixDQUFDO1FBQzVFLElBQUksQ0FBQyxjQUFjLEVBQUU7WUFDbkIsT0FBTyxFQUFFLENBQUM7U0FDWDtRQUNELE9BQU8sSUFBSSxDQUFDLEtBQUssQ0FBQyxjQUFjLENBQUMsQ0FBQztJQUNwQyxDQUFDOzs7Ozs7SUFLRCxnQkFBZ0IsQ0FBQyxVQUFlOztjQUN4QixnQkFBZ0IsR0FBRyxJQUFJLENBQUMsU0FBUyxDQUFDLFVBQVUsQ0FBQztRQUNuRCxNQUFNLENBQUMsY0FBYyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsaUJBQWlCLEVBQUUsZ0JBQWdCLENBQUMsQ0FBQztJQUMxRSxDQUFDO0NBQ0Y7Ozs7Ozs7SUFwRUMsbUVBQTRDOztBQXNFOUMsT0FBTyxFQUFFLHNDQUFzQyxFQUFFLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBCZVNlc3Npb25TdG9yYWdlU3RyYXRlZ3kgfSBmcm9tICcuL3N0b3JhZ2Vfc3RyYXRlZ3knO1xyXG5cclxuLyoqXHJcbiAqIOWfuuS6jua1j+iniOWZqFNlc3Npb25TdG9yYWdl55qEQmVTZXNzaW9u57yT5a2YXHJcbiAqIEBzdW1tYXJ5XHJcbiAqIDHjgIFTZXBhcmF0ZWRTZXNzaW9u5qih5byP5LiL77yaXHJcbiAqICB7XHJcbiAqICAgIEJFX1NFU1NJT05fSUQ6IHtcclxuICogICAgICBmcm1TZXNzaW9uSWQxX2JlU2Vzc2lvblVyaTE6IGJlU2Vzc2lvbklkLTEsXHJcbiAqICAgICAgZnJtU2Vzc2lvbklkMl9iZVNlc3Npb25VcmkyOiBiZVNlc3Npb25JZC0yLFxyXG4gKiAgICB9XHJcbiAqICB9XHJcbiAqIDLjgIFVbmlmaWVkU2Vzc2lvbuaooeW8j+S4i++8iOWcqERlYnVn54q25oCB77yM5ZCM5qih5byPMe+8ie+8mlxyXG4gKiB7XHJcbiAqICAgIEJFX1NFU1NJT05fSUQ6IHtcclxuICogICAgICBmcm1TZXNzaW9uSWQxOiBiZVNlc3Npb25JZC0xLFxyXG4gKiAgICAgIGZybVNlc3Npb25JZDI6IGJlU2Vzc2lvbklkLTIsXHJcbiAqICAgIH1cclxuICogIH1cclxuICovXHJcbmNsYXNzIFNlc3Npb25TdG9yYWdlQmVTZXNzaW9uU3RvcmFnZVN0cmF0ZWd5IGltcGxlbWVudHMgQmVTZXNzaW9uU3RvcmFnZVN0cmF0ZWd5IHtcclxuXHJcbiAgLyoqXHJcbiAgICog57yT5a2YVG9rZW5cclxuICAgKi9cclxuICBwcml2YXRlIHNlc3Npb25TdG9yYWdlS2V5ID0gJ0JFX1NFU1NJT05fSUQnO1xyXG5cclxuICAvKipcclxuICAgKiDojrflj5blgLxcclxuICAgKi9cclxuICBwdWJsaWMgZ2V0SXRlbShiZVNlc3Npb25LZXk6IHN0cmluZyk6IHN0cmluZyB7XHJcbiAgICBjb25zdCBiZVNlc3Npb25zID0gdGhpcy5nZXRBbGxCZVNlc3Npb25zKCk7XHJcbiAgICByZXR1cm4gYmVTZXNzaW9uc1tiZVNlc3Npb25LZXldO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog6K6+572u5YC8XHJcbiAgICovXHJcbiAgcHVibGljIHNldEl0ZW0oYmVTZXNzaW9uS2V5OiBzdHJpbmcsIGJlU2Vzc2lvbklkOiBzdHJpbmcpIHtcclxuICAgIGNvbnN0IGJlU2Vzc2lvbnMgPSB0aGlzLmdldEFsbEJlU2Vzc2lvbnMoKTtcclxuICAgIGJlU2Vzc2lvbnNbYmVTZXNzaW9uS2V5XSA9IGJlU2Vzc2lvbklkO1xyXG4gICAgdGhpcy5zZXRBbGxCZVNlc3Npb25zKGJlU2Vzc2lvbnMpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog5Yig6Zmk5YC8XHJcbiAgICovXHJcbiAgcHVibGljIHJlbW92ZUl0ZW0oYmVTZXNzaW9uS2V5OiBzdHJpbmcpIHtcclxuICAgIGNvbnN0IGJlU2Vzc2lvbnMgPSB0aGlzLmdldEFsbEJlU2Vzc2lvbnMoKTtcclxuICAgIGlmIChiZVNlc3Npb25zW2JlU2Vzc2lvbktleV0pIHtcclxuICAgICAgZGVsZXRlIGJlU2Vzc2lvbnNbYmVTZXNzaW9uS2V5XTtcclxuICAgIH1cclxuICAgIHRoaXMuc2V0QWxsQmVTZXNzaW9ucyhiZVNlc3Npb25zKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOagueaNrnNjb3Bl5Yig6Zmk5YC8XHJcbiAgICovXHJcbiAgcHVibGljIHJlbW92ZUl0ZW1zQnlTY29wZShiZVNlc3Npb25TY29wZTogc3RyaW5nKSB7XHJcbiAgICBjb25zdCBiZVNlc3Npb25zID0gdGhpcy5nZXRBbGxCZVNlc3Npb25zKCk7XHJcbiAgICBPYmplY3Qua2V5cyhiZVNlc3Npb25zKS5mb3JFYWNoKChiZVNlc3Npb25LZXk6IHN0cmluZykgPT4ge1xyXG4gICAgICBpZiAoYmVTZXNzaW9uS2V5LnN0YXJ0c1dpdGgoYmVTZXNzaW9uU2NvcGUpID09PSB0cnVlKSB7XHJcbiAgICAgICAgZGVsZXRlIGJlU2Vzc2lvbnNbYmVTZXNzaW9uS2V5XTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgICB0aGlzLnNldEFsbEJlU2Vzc2lvbnMoYmVTZXNzaW9ucyk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDmuIXnqbrmiYDmnInkvJror51cclxuICAgKi9cclxuICBwdWJsaWMgY2xlYXIoKTogdm9pZCB7XHJcbiAgICB3aW5kb3cuc2Vzc2lvblN0b3JhZ2UucmVtb3ZlSXRlbSh0aGlzLnNlc3Npb25TdG9yYWdlS2V5KTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOS7jlNlc3Npb25TdG9yYWdl5Lit6I635Y+W5YWo6YOoQmVTZXNzaW9uc1xyXG4gICAqL1xyXG4gIHByaXZhdGUgZ2V0QWxsQmVTZXNzaW9ucygpOiBhbnkge1xyXG4gICAgY29uc3QgYmVTZXNzaW9uc0pzb24gPSB3aW5kb3cuc2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbSh0aGlzLnNlc3Npb25TdG9yYWdlS2V5KTtcclxuICAgIGlmICghYmVTZXNzaW9uc0pzb24pIHtcclxuICAgICAgcmV0dXJuIHt9O1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIEpTT04ucGFyc2UoYmVTZXNzaW9uc0pzb24pO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog6K6+572u5YWo6YOoQmVTZXNzaW9uc+WIsFNlc3Npb25TdG9yYWdlXHJcbiAgICovXHJcbiAgc2V0QWxsQmVTZXNzaW9ucyhiZVNlc3Npb25zOiBhbnkpOiB2b2lkIHtcclxuICAgIGNvbnN0IGJlU2Vzc2lvbnNTdHJpbmcgPSBKU09OLnN0cmluZ2lmeShiZVNlc3Npb25zKTtcclxuICAgIHdpbmRvdy5zZXNzaW9uU3RvcmFnZS5zZXRJdGVtKHRoaXMuc2Vzc2lvblN0b3JhZ2VLZXksIGJlU2Vzc2lvbnNTdHJpbmcpO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IHsgU2Vzc2lvblN0b3JhZ2VCZVNlc3Npb25TdG9yYWdlU3RyYXRlZ3kgfTsiXX0=