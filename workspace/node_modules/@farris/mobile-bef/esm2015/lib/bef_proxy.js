/**
 * @fileoverview added by tsickle
 * Generated from: lib/bef_proxy.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { switchMap, map, catchError } from 'rxjs/operators';
import { HttpMethods } from '@farris/mobile-devkit';
import { BefDataPathUtil } from './utils/index';
/**
 * Bef API代理类
 * @abstract
 */
export class BefProxy {
    /**
     * 构造函数
     * @param {?} httpClient
     */
    constructor(httpClient) {
        this.httpClient = httpClient;
        this.associatedUrlMap = new Map();
    }
    // 记录附件取跨Be url
    /**
     * @param {?} url
     * @return {?}
     */
    setAssociatedUrl(url) {
        this.associatedUrlMap.set(url, url);
    }
    /**
     * 设置扩展策略
     * @param {?} proxyExtend
     * @return {?}
     */
    setProxyExtend(proxyExtend) {
        this.proxyExtend = proxyExtend;
    }
    /**
     * 查询
     * @param {?=} entityFilter
     * @return {?}
     */
    query(entityFilter) {
        /** @type {?} */
        const url = this.baseUrl;
        /** @type {?} */
        const params = {};
        if (entityFilter) {
            /** @type {?} */
            const entityFilterString = JSON.stringify(entityFilter);
            params.entityFilter = entityFilterString;
        }
        /** @type {?} */
        const requestConfig = {
            params: params
        };
        return this.request(HttpMethods.GET, url, requestConfig);
    }
    /**
     * 列表数据查询（扩展）
     * @param {?} entityFilter
     * @return {?}
     */
    extendQuery(entityFilter) {
        /** @type {?} */
        const url = `${this.baseUrl}/extension/query`;
        /** @type {?} */
        const params = {};
        if (entityFilter) {
            /** @type {?} */
            const entityFilterString = JSON.stringify(entityFilter);
            params.entityFilter = entityFilterString;
        }
        /** @type {?} */
        const requestConfig = {
            params: params
        };
        return this.request(HttpMethods.PUT, url, requestConfig);
    }
    /**
     * 单条数据检索
     * @param {?} id
     * @return {?}
     */
    retrieve(id) {
        /** @type {?} */
        const url = `${this.baseUrl}/${id}`;
        return this.request(HttpMethods.GET, url);
    }
    /**
     * 单条数据检索（扩展）
     * @param {?} id
     * @return {?}
     */
    extendRetrieve(id) {
        /** @type {?} */
        const url = `${this.baseUrl}/extension/retrieve/${id}`;
        return this.request(HttpMethods.PUT, url);
    }
    /**
     * 单条数据检索（加锁）
     * @param {?} id
     * @return {?}
     */
    edit(id) {
        /** @type {?} */
        const url = `${this.baseUrl}/service/edit/${id}`;
        return this.request(HttpMethods.PUT, url);
    }
    /**
     * 新增数据
     * @param {?=} defaultValue
     * @param {?=} requestInfo
     * @return {?}
     */
    create(defaultValue, requestInfo) {
        /** @type {?} */
        const body = {
            defaultValue,
            requestInfo: requestInfo,
        };
        /** @type {?} */
        const requestConfig = {
            body: body
        };
        return this.request(HttpMethods.POST, this.baseUrl, requestConfig);
    }
    /**
     * 新增从表数据
     * \@path 新增路径（从表形如：/1/edus，从从表形如：/1/edus/11/grades）
     * @param {?} fpath
     * @return {?}
     */
    createByPath(fpath) {
        /** @type {?} */
        const pathUrl = BefDataPathUtil.convertPathToUrl(fpath);
        /** @type {?} */
        const url = `${this.baseUrl}${pathUrl}`;
        return this.request(HttpMethods.POST, url);
    }
    /**
     * 提交变更
     * @param {?} changeDetail
     * @return {?}
     */
    update(changeDetail) {
        /** @type {?} */
        const body = {
            changeDetail
        };
        /** @type {?} */
        const requestConfig = {
            body: body
        };
        return this.request(HttpMethods.PATCH, this.baseUrl, requestConfig);
    }
    /**
     * 执行保存
     * @return {?}
     */
    save() {
        return this.request(HttpMethods.PUT, this.baseUrl);
    }
    /**
     * 删除
     * @param {?} id
     * @return {?}
     */
    delete(id) {
        /** @type {?} */
        const url = `${this.baseUrl}/${id}`;
        return this.request(HttpMethods.DELETE, url);
    }
    /**
     * 删除（扩展）
     * @param {?} id
     * @return {?}
     */
    extendDelete(id) {
        /** @type {?} */
        const url = `${this.baseUrl}/extension/delete/${id}`;
        return this.request(HttpMethods.PUT, url);
    }
    /**
     * 删除并保存
     * @param {?} id
     * @return {?}
     */
    deleteAndSave(id) {
        /** @type {?} */
        const url = `${this.baseUrl}/service/delete/${id}`;
        /** @type {?} */
        const requestConfig = {};
        return this.request(HttpMethods.PUT, url, requestConfig);
    }
    /**
     * 删除后代
     * @param {?} fpath
     * @param {?} id
     * @return {?}
     */
    deletByPath(fpath, id) {
        /** @type {?} */
        const pathUrl = BefDataPathUtil.convertPathToUrl(fpath);
        /** @type {?} */
        const url = `${this.baseUrl}${pathUrl}/${id}`;
        return this.request(HttpMethods.DELETE, url);
    }
    /**
     * 删除后代（扩展）
     * @param {?} fpath
     * @param {?} id
     * @return {?}
     */
    extendDeletByPath(fpath, id) {
        /** @type {?} */
        const pathUrl = BefDataPathUtil.convertPathToUrl(fpath);
        /** @type {?} */
        const url = `${this.baseUrl}/extension${pathUrl}/${id}`;
        return this.request(HttpMethods.PUT, url);
    }
    /**
     * 批量删除
     * @param {?} ids 待删除的id数组
     * @return {?}
     */
    batchDelete(ids) {
        /** @type {?} */
        const params = {
            ids: ids.join(',')
        };
        /** @type {?} */
        const requestConfig = {
            params: params
        };
        return this.request(HttpMethods.DELETE, this.baseUrl, requestConfig);
    }
    /**
     * 批量删除（扩展）
     * @param {?} ids
     * @return {?}
     */
    extendBatchDelete(ids) {
        /** @type {?} */
        const url = `${this.baseUrl}/extension/batchdelete`;
        /** @type {?} */
        const params = {
            ids: ids.join(',')
        };
        /** @type {?} */
        const requestConfig = {
            params: params
        };
        return this.request(HttpMethods.PUT, url, requestConfig);
    }
    /**
     * 取消
     * @return {?}
     */
    cancel() {
        /** @type {?} */
        const url = `${this.baseUrl}/service/cancel`;
        return this.request(HttpMethods.POST, url);
    }
    /**
     * 调用httpclient取数
     * @param {?} method methods
     * @param {?} url url
     * @param {?=} requestConfigs options
     * @param {?=} ignoreHandlingChanges
     * @return {?}
     */
    request(method, url, requestConfigs, ignoreHandlingChanges = false) {
        requestConfigs = requestConfigs || {};
        // 扩展body
        if (ignoreHandlingChanges !== true) {
            if (method === HttpMethods.POST || method === HttpMethods.PUT || method === HttpMethods.PATCH) {
                /** @type {?} */
                const body = requestConfigs.body || {};
                requestConfigs.body = this.proxyExtend.extendBody(body);
            }
        }
        // 扩展headers
        /** @type {?} */
        const headers$ = this.proxyExtend.extendHeaders(requestConfigs.headers);
        // 发送请求
        return headers$.pipe(switchMap((/**
         * @param {?} headers
         * @return {?}
         */
        (headers) => {
            requestConfigs.headers = headers;
            requestConfigs.observe = 'response';
            return this.httpClient.request(method, url, requestConfigs).pipe(map((/**
             * @param {?} result
             * @return {?}
             */
            (result) => {
                if (ignoreHandlingChanges === true) {
                    return result && result.body && result.body.returnValue ? result.body.returnValue : result;
                }
                else {
                    return this.proxyExtend.onResponse(result);
                }
            })), catchError((/**
             * @param {?} error
             * @return {?}
             */
            (error) => {
                return this.proxyExtend.onError(error, false, false);
            })));
        })), catchError((/**
         * @param {?} error
         * @return {?}
         */
        (error) => {
            return this.proxyExtend.onError(error, false, false);
        })));
    }
}
if (false) {
    /**
     * API基路径
     * \@summary
     * 延迟到实现类确定，考虑使用注解指定。
     * @type {?}
     */
    BefProxy.prototype.baseUrl;
    /** @type {?} */
    BefProxy.prototype.associatedUrlMap;
    /**
     * 代理扩展
     * @type {?}
     * @protected
     */
    BefProxy.prototype.proxyExtend;
    /** @type {?} */
    BefProxy.prototype.httpClient;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYmVmX3Byb3h5LmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGZhcnJpcy9tb2JpbGUtYmVmLyIsInNvdXJjZXMiOlsibGliL2JlZl9wcm94eS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7OztBQUNBLE9BQU8sRUFBRSxTQUFTLEVBQUUsR0FBRyxFQUFFLFVBQVUsRUFBTyxNQUFNLGdCQUFnQixDQUFDO0FBQ2pFLE9BQU8sRUFBdUMsV0FBVyxFQUErQyxNQUFNLHVCQUF1QixDQUFDO0FBSXRJLE9BQU8sRUFBRSxlQUFlLEVBQUUsTUFBTSxlQUFlLENBQUM7Ozs7O0FBTWhELE1BQU0sT0FBZ0IsUUFBUTs7Ozs7SUFvQjVCLFlBQW1CLFVBQXNCO1FBQXRCLGVBQVUsR0FBVixVQUFVLENBQVk7UUFDdkMsSUFBSSxDQUFDLGdCQUFnQixHQUFHLElBQUksR0FBRyxFQUFFLENBQUM7SUFDcEMsQ0FBQzs7Ozs7O0lBR0QsZ0JBQWdCLENBQUMsR0FBRztRQUNsQixJQUFJLENBQUMsZ0JBQWdCLENBQUMsR0FBRyxDQUFDLEdBQUcsRUFBQyxHQUFHLENBQUMsQ0FBQTtJQUNwQyxDQUFDOzs7Ozs7SUFJTSxjQUFjLENBQUMsV0FBeUI7UUFDN0MsSUFBSSxDQUFDLFdBQVcsR0FBRyxXQUFXLENBQUM7SUFDakMsQ0FBQzs7Ozs7O0lBS00sS0FBSyxDQUFDLFlBQWtCOztjQUN2QixHQUFHLEdBQUcsSUFBSSxDQUFDLE9BQU87O2NBQ2xCLE1BQU0sR0FBZSxFQUFFO1FBQzdCLElBQUksWUFBWSxFQUFFOztrQkFDVixrQkFBa0IsR0FBRyxJQUFJLENBQUMsU0FBUyxDQUFDLFlBQVksQ0FBQztZQUN2RCxNQUFNLENBQUMsWUFBWSxHQUFHLGtCQUFrQixDQUFDO1NBQzFDOztjQUNLLGFBQWEsR0FBc0I7WUFDdkMsTUFBTSxFQUFFLE1BQU07U0FDZjtRQUNELE9BQU8sSUFBSSxDQUFDLE9BQU8sQ0FBQyxXQUFXLENBQUMsR0FBRyxFQUFFLEdBQUcsRUFBRSxhQUFhLENBQUMsQ0FB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IHsgT2JzZXJ2YWJsZSB9IGZyb20gJ3J4anMnO1xyXG5pbXBvcnQgeyBzd2l0Y2hNYXAsIG1hcCwgY2F0Y2hFcnJvciwgdGFwIH0gZnJvbSAncnhqcy9vcGVyYXRvcnMnO1xyXG5pbXBvcnQgeyBIdHRwSGVhZGVycywgSHR0cFBhcmFtcywgSHR0cE1ldGhvZCwgSHR0cE1ldGhvZHMsIEh0dHBSZXF1ZXN0Q29uZmlnLCBIdHRwUmVzcG9uc2UsIEh0dHBDbGllbnQgfSBmcm9tICdAZmFycmlzL21vYmlsZS1kZXZraXQnO1xyXG5cclxuaW1wb3J0IHsgUmVxdWVzdEluZm8sIFJlc3BvbnNlSW5mbywgQ2hhbmdlRGV0YWlsIH0gZnJvbSAnLi90eXBlcyc7XHJcbmltcG9ydCB7IElQcm94eUV4dGVuZCB9IGZyb20gJy4vYmVmX3Byb3h5X2V4dGVuZCc7XHJcbmltcG9ydCB7IEJlZkRhdGFQYXRoVXRpbCB9IGZyb20gJy4vdXRpbHMvaW5kZXgnO1xyXG5cclxuXHJcbi8qKlxyXG4gKiBCZWYgQVBJ5Luj55CG57G7XHJcbiAqL1xyXG5leHBvcnQgYWJzdHJhY3QgY2xhc3MgQmVmUHJveHkge1xyXG5cclxuICAvKipcclxuICAgKiBBUEnln7rot6/lvoRcclxuICAgKiBAc3VtbWFyeVxyXG4gICAqIOW7tui/n+WIsOWunueOsOexu+ehruWumu+8jOiAg+iZkeS9v+eUqOazqOino+aMh+WumuOAglxyXG4gICAqL1xyXG4gIHB1YmxpYyBhYnN0cmFjdCBiYXNlVXJsOiBzdHJpbmc7XHJcblxyXG5cclxuICBwdWJsaWMgYXNzb2NpYXRlZFVybE1hcDogTWFwPHN0cmluZywgc3RyaW5nPjtcclxuXHJcbiAgLyoqXHJcbiAgICog5Luj55CG5omp5bGVXHJcbiAgICovXHJcbiAgcHJvdGVjdGVkIHByb3h5RXh0ZW5kOiBJUHJveHlFeHRlbmQ7XHJcblxyXG4gIC8qKlxyXG4gICAqIOaehOmAoOWHveaVsFxyXG4gICAqL1xyXG4gIGNvbnN0cnVjdG9yKHB1YmxpYyBodHRwQ2xpZW50OiBIdHRwQ2xpZW50KSB7XHJcbiAgICB0aGlzLmFzc29jaWF0ZWRVcmxNYXAgPSBuZXcgTWFwKCk7XHJcbiAgfVxyXG5cclxuICAvLyDorrDlvZXpmYTku7blj5bot6hCZSB1cmxcclxuICBzZXRBc3NvY2lhdGVkVXJsKHVybCl7XHJcbiAgICB0aGlzLmFzc29jaWF0ZWRVcmxNYXAuc2V0KHVybCx1cmwpXHJcbiAgfVxyXG4gIC8qKlxyXG4gICAqIOiuvue9ruaJqeWxleetlueVpVxyXG4gICAqL1xyXG4gIHB1YmxpYyBzZXRQcm94eUV4dGVuZChwcm94eUV4dGVuZDogSVByb3h5RXh0ZW5kKSB7XHJcbiAgICB0aGlzLnByb3h5RXh0ZW5kID0gcHJveHlFeHRlbmQ7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDmn6Xor6JcclxuICAgKi9cclxuICBwdWJsaWMgcXVlcnkoZW50aXR5RmlsdGVyPzogYW55KTogT2JzZXJ2YWJsZTxhbnk+IHtcclxuICAgIGNvbnN0IHVybCA9IHRoaXMuYmFzZVVybDtcclxuICAgIGNvbnN0IHBhcmFtczogSHR0cFBhcmFtcyA9IHt9O1xyXG4gICAgaWYgKGVudGl0eUZpbHRlcikge1xyXG4gICAgICBjb25zdCBlbnRpdHlGaWx0ZXJTdHJpbmcgPSBKU09OLnN0cmluZ2lmeShlbnRpdHlGaWx0ZXIpO1xyXG4gICAgICBwYXJhbXMuZW50aXR5RmlsdGVyID0gZW50aXR5RmlsdGVyU3RyaW5nO1xyXG4gICAgfVxyXG4gICAgY29uc3QgcmVxdWVzdENvbmZpZzogSHR0cFJlcXVlc3RDb25maWcgPSB7XHJcbiAgICAgIHBhcmFtczogcGFyYW1zXHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIHRoaXMucmVxdWVzdChIdHRwTWV0aG9kcy5HRVQsIHVybCwgcmVxdWVzdENvbmZpZyk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDliJfooajmlbDmja7mn6Xor6LvvIjmianlsZXvvIlcclxuICAgKi9cclxuICBwdWJsaWMgZXh0ZW5kUXVlcnkoZW50aXR5RmlsdGVyOiBhbnkpOiBPYnNlcnZhYmxlPFJlc3BvbnNlSW5mbz4ge1xyXG4gICAgY29uc3QgdXJsID0gYCR7dGhpcy5iYXNlVXJsfS9leHRlbnNpb24vcXVlcnlgO1xyXG4gICAgY29uc3QgcGFyYW1zOiBIdHRwUGFyYW1zID0ge307XHJcbiAgICBpZiAoZW50aXR5RmlsdGVyKSB7XHJcbiAgICAgIGNvbnN0IGVudGl0eUZpbHRlclN0cmluZyA9IEpTT04uc3RyaW5naWZ5KGVudGl0eUZpbHRlcik7XHJcbiAgICAgIHBhcmFtcy5lbnRpdHlGaWx0ZXIgPSBlbnRpdHlGaWx0ZXJTdHJpbmc7XHJcbiAgICB9XHJcbiAgICBjb25zdCByZXF1ZXN0Q29uZmlnOiBIdHRwUmVxdWVzdENvbmZpZyA9IHtcclxuICAgICAgcGFyYW1zOiBwYXJhbXNcclxuICAgIH07XHJcbiAgICByZXR1cm4gdGhpcy5yZXF1ZXN0KEh0dHBNZXRob2RzLlBVVCwgdXJsLCByZXF1ZXN0Q29uZmlnKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOWNleadoeaVsOaNruajgOe0olxyXG4gICAqL1xyXG4gIHB1YmxpYyByZXRyaWV2ZShpZDogc3RyaW5nKTogT2JzZXJ2YWJsZTxhbnk+IHtcclxuICAgIGNvbnN0IHVybCA9IGAke3RoaXMuYmFzZVVybH0vJHtpZH1gO1xyXG4gICAgcmV0dXJuIHRoaXMucmVxdWVzdChIdHRwTWV0aG9kcy5HRVQsIHVybCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDljZXmnaHmlbDmja7mo4DntKLvvIjmianlsZXvvIlcclxuICAgKi9cclxuICBwdWJsaWMgZXh0ZW5kUmV0cmlldmUoaWQ6IHN0cmluZyk6IE9ic2VydmFibGU8UmVzcG9uc2VJbmZvPiB7XHJcbiAgICBjb25zdCB1cmwgPSBgJHt0aGlzLmJhc2VVcmx9L2V4dGVuc2lvbi9yZXRyaWV2ZS8ke2lkfWA7XHJcbiAgICByZXR1cm4gdGhpcy5yZXF1ZXN0KEh0dHBNZXRob2RzLlBVVCwgdXJsKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOWNleadoeaVsOaNruajgOe0ou+8iOWKoOmUge+8iVxyXG4gICAqL1xyXG4gIHB1YmxpYyBlZGl0KGlkOiBzdHJpbmcpOiBPYnNlcnZhYmxlPFJlc3BvbnNlSW5mbz4ge1xyXG4gICAgY29uc3QgdXJsID0gYCR7dGhpcy5iYXNlVXJsfS9zZXJ2aWNlL2VkaXQvJHtpZH1gO1xyXG4gICAgcmV0dXJuIHRoaXMucmVxdWVzdChIdHRwTWV0aG9kcy5QVVQsIHVybCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDmlrDlop7mlbDmja5cclxuICAgKi9cclxuICBwdWJsaWMgY3JlYXRlKGRlZmF1bHRWYWx1ZT86IGFueSwgcmVxdWVzdEluZm8/OiBSZXF1ZXN0SW5mbyk6IE9ic2VydmFibGU8YW55PiB7XHJcbiAgICBjb25zdCBib2R5ID0ge1xyXG4gICAgICBkZWZhdWx0VmFsdWUsXHJcbiAgICAgIHJlcXVlc3RJbmZvOiByZXF1ZXN0SW5mbyxcclxuICAgIH07XHJcbiAgICBjb25zdCByZXF1ZXN0Q29uZmlnOiBIdHRwUmVxdWVzdENvbmZpZyA9IHtcclxuICAgICAgYm9keTogYm9keVxyXG4gICAgfTtcclxuICAgIHJldHVybiB0aGlzLnJlcXVlc3QoSHR0cE1ldGhvZHMuUE9TVCwgdGhpcy5iYXNlVXJsLCByZXF1ZXN0Q29uZmlnKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOaWsOWinuS7juihqOaVsOaNrlxyXG4gICAqIEBwYXRoIOaWsOWinui3r+W+hO+8iOS7juihqOW9ouWmgu+8mi8xL2VkdXPvvIzku47ku47ooajlvaLlpoLvvJovMS9lZHVzLzExL2dyYWRlc++8iVxyXG4gICAqL1xyXG4gIHB1YmxpYyBjcmVhdGVCeVBhdGgoZnBhdGg6IHN0cmluZyk6IE9ic2VydmFibGU8YW55PiB7XHJcbiAgICBjb25zdCBwYXRoVXJsID0gQmVmRGF0YVBhdGhVdGlsLmNvbnZlcnRQYXRoVG9VcmwoZnBhdGgpO1xyXG4gICAgY29uc3QgdXJsID0gYCR7dGhpcy5iYXNlVXJsfSR7cGF0aFVybH1gO1xyXG4gICAgcmV0dXJuIHRoaXMucmVxdWVzdChIdHRwTWV0aG9kcy5QT1NULCB1cmwpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog5o+Q5Lqk5Y+Y5pu0XHJcbiAgICovXHJcbiAgdXBkYXRlKGNoYW5nZURldGFpbDogQ2hhbmdlRGV0YWlsKTogT2JzZXJ2YWJsZTxhbnk+IHtcclxuICAgIGNvbnN0IGJvZHkgPSB7XHJcbiAgICAgIGNoYW5nZURldGFpbFxyXG4gICAgfTtcclxuICAgIGNvbnN0IHJlcXVlc3RDb25maWc6IEh0dHBSZXF1ZXN0Q29uZmlnID0ge1xyXG4gICAgICBib2R5OiBib2R5XHJcbiAgICB9O1xyXG5cclxuICAgIHJldHVybiB0aGlzLnJlcXVlc3QoSHR0cE1ldGhvZHMuUEFUQ0gsIHRoaXMuYmFzZVVybCwgcmVxdWVzdENvbmZpZyk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDmiafooYzkv53lrZhcclxuICAgKi9cclxuICBwdWJsaWMgc2F2ZSgpOiBPYnNlcnZhYmxlPGFueT4ge1xyXG4gICAgcmV0dXJuIHRoaXMucmVxdWVzdCggSHR0cE1ldGhvZHMuUFVULCB0aGlzLmJhc2VVcmwpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog5Yig6ZmkXHJcbiAgICovXHJcbiAgcHVibGljIGRlbGV0ZShpZDogc3RyaW5nKTogT2JzZXJ2YWJsZTxhbnk+IHtcclxuICAgIGNvbnN0IHVybCA9IGAke3RoaXMuYmFzZVVybH0vJHtpZH1gO1xyXG4gICAgcmV0dXJuIHRoaXMucmVxdWVzdChIdHRwTWV0aG9kcy5ERUxFVEUsIHVybCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDliKDpmaTvvIjmianlsZXvvIlcclxuICAgKi9cclxuICBwdWJsaWMgZXh0ZW5kRGVsZXRlKGlkOiBzdHJpbmcpOiBPYnNlcnZhYmxlPGFueT4ge1xyXG4gICAgY29uc3QgdXJsID0gYCR7dGhpcy5iYXNlVXJsfS9leHRlbnNpb24vZGVsZXRlLyR7aWR9YDtcclxuICAgIHJldHVybiB0aGlzLnJlcXVlc3QoSHR0cE1ldGhvZHMuUFVULCB1cmwpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog5Yig6Zmk5bm25L+d5a2YXHJcbiAgICovXHJcbiAgcHVibGljIGRlbGV0ZUFuZFNhdmUoaWQ6IGFueSk6IE9ic2VydmFibGU8YW55PiB7XHJcbiAgICBjb25zdCB1cmwgPSBgJHt0aGlzLmJhc2VVcmx9L3NlcnZpY2UvZGVsZXRlLyR7aWR9YDtcclxuICAgIGNvbnN0IHJlcXVlc3RDb25maWc6IEh0dHBSZXF1ZXN0Q29uZmlnID0ge307XHJcbiAgICByZXR1cm4gdGhpcy5yZXF1ZXN0KEh0dHBNZXRob2RzLlBVVCwgdXJsLCByZXF1ZXN0Q29uZmlnKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOWIoOmZpOWQjuS7o1xyXG4gICAqL1xyXG4gIHB1YmxpYyBkZWxldEJ5UGF0aChmcGF0aDogc3RyaW5nLCBpZDogc3RyaW5nKTogT2JzZXJ2YWJsZTxhbnk+IHtcclxuICAgIGNvbnN0IHBhdGhVcmwgPSBCZWZEYXRhUGF0aFV0aWwuY29udmVydFBhdGhUb1VybChmcGF0aCk7XHJcbiAgICBjb25zdCB1cmwgPSBgJHt0aGlzLmJhc2VVcmx9JHtwYXRoVXJsfS8ke2lkfWA7XHJcbiAgICByZXR1cm4gdGhpcy5yZXF1ZXN0KEh0dHBNZXRob2RzLkRFTEVURSwgdXJsKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOWIoOmZpOWQjuS7o++8iOaJqeWxle+8iVxyXG4gICAqL1xyXG4gIHB1YmxpYyBleHRlbmREZWxldEJ5UGF0aChmcGF0aDogc3RyaW5nLCBpZDogc3RyaW5nKTogT2JzZXJ2YWJsZTxhbnk+IHtcclxuICAgIGNvbnN0IHBhdGhVcmwgPSBCZWZEYXRhUGF0aFV0aWwuY29udmVydFBhdGhUb1VybChmcGF0aCk7XHJcbiAgICBjb25zdCB1cmwgPSBgJHt0aGlzLmJhc2VVcmx9L2V4dGVuc2lvbiR7cGF0aFVybH0vJHtpZH1gO1xyXG4gICAgcmV0dXJuIHRoaXMucmVxdWVzdChIdHRwTWV0aG9kcy5QVVQsIHVybCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDmibnph4/liKDpmaRcclxuICAgKiBAcGFyYW0gaWRzIOW+heWIoOmZpOeahGlk5pWw57uEXHJcbiAgICovXHJcbiAgcHVibGljIGJhdGNoRGVsZXRlKGlkczogc3RyaW5nW10pOiBPYnNlcnZhYmxlPGFueT4ge1xyXG4gICAgY29uc3QgcGFyYW1zID0ge1xyXG4gICAgICBpZHM6IGlkcy5qb2luKCcsJylcclxuICAgIH07XHJcbiAgICBjb25zdCByZXF1ZXN0Q29uZmlnOiBIdHRwUmVxdWVzdENvbmZpZyA9IHtcclxuICAgICAgcGFyYW1zOiBwYXJhbXNcclxuICAgIH07XHJcbiAgICByZXR1cm4gdGhpcy5yZXF1ZXN0KEh0dHBNZXRob2RzLkRFTEVURSwgdGhpcy5iYXNlVXJsLCByZXF1ZXN0Q29uZmlnKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOaJuemHj+WIoOmZpO+8iOaJqeWxle+8iVxyXG4gICAqL1xyXG4gIHB1YmxpYyBleHRlbmRCYXRjaERlbGV0ZShpZHM6IHN0cmluZ1tdKTogT2JzZXJ2YWJsZTxhbnk+IHtcclxuICAgIGNvbnN0IHVybCA9IGAke3RoaXMuYmFzZVVybH0vZXh0ZW5zaW9uL2JhdGNoZGVsZXRlYDtcclxuICAgIGNvbnN0IHBhcmFtcyA9IHtcclxuICAgICAgaWRzOiBpZHMuam9pbignLCcpXHJcbiAgICB9O1xyXG4gICAgY29uc3QgcmVxdWVzdENvbmZpZzogSHR0cFJlcXVlc3RDb25maWcgPSB7XHJcbiAgICAgIHBhcmFtczogcGFyYW1zXHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIHRoaXMucmVxdWVzdChIdHRwTWV0aG9kcy5QVVQsIHVybCwgcmVxdWVzdENvbmZpZyk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDlj5bmtohcclxuICAgKi9cclxuICBwdWJsaWMgY2FuY2VsKCk6IE9ic2VydmFibGU8YW55PiB7XHJcbiAgICBjb25zdCB1cmwgPSBgJHt0aGlzLmJhc2VVcmx9L3NlcnZpY2UvY2FuY2VsYDtcclxuICAgIHJldHVybiB0aGlzLnJlcXVlc3QoSHR0cE1ldGhvZHMuUE9TVCwgdXJsKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOiwg+eUqGh0dHBjbGllbnTlj5bmlbBcclxuICAgKiBAcGFyYW0gdXJsIHVybFxyXG4gICAqIEBwYXJhbSBtZXRob2QgbWV0aG9kc1xyXG4gICAqIEBwYXJhbSByZXF1ZXN0Q29uZmlncyBvcHRpb25zXHJcbiAgICovXHJcbiAgcHVibGljIHJlcXVlc3QobWV0aG9kOiBIdHRwTWV0aG9kLCB1cmw6IHN0cmluZywgIHJlcXVlc3RDb25maWdzPzogSHR0cFJlcXVlc3RDb25maWcsIGlnbm9yZUhhbmRsaW5nQ2hhbmdlcyA9IGZhbHNlKSB7XHJcblxyXG4gICAgcmVxdWVzdENvbmZpZ3MgPSByZXF1ZXN0Q29uZmlncyB8fCB7fTtcclxuXHJcbiAgICAvLyDmianlsZVib2R5XHJcbiAgICBpZiAoaWdub3JlSGFuZGxpbmdDaGFuZ2VzICE9PSB0cnVlKSB7XHJcbiAgICAgIGlmIChtZXRob2QgPT09IEh0dHBNZXRob2RzLlBPU1QgfHwgbWV0aG9kID09PSBIdHRwTWV0aG9kcy5QVVQgfHwgbWV0aG9kID09PSBIdHRwTWV0aG9kcy5QQVRDSCkge1xyXG4gICAgICAgIGNvbnN0IGJvZHkgPSByZXF1ZXN0Q29uZmlncy5ib2R5IHx8IHt9O1xyXG4gICAgICAgIHJlcXVlc3RDb25maWdzLmJvZHkgPSB0aGlzLnByb3h5RXh0ZW5kLmV4dGVuZEJvZHkoYm9keSk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyDmianlsZVoZWFkZXJzXHJcbiAgICBjb25zdCBoZWFkZXJzJCA9IHRoaXMucHJveHlFeHRlbmQuZXh0ZW5kSGVhZGVycyhyZXF1ZXN0Q29uZmlncy5oZWFkZXJzKTtcclxuXHJcbiAgICAvLyDlj5HpgIHor7fmsYJcclxuICAgIHJldHVybiBoZWFkZXJzJC5waXBlKFxyXG4gICAgICBzd2l0Y2hNYXAoKGhlYWRlcnM6IEh0dHBIZWFkZXJzKSA9PiB7XHJcbiAgICAgICAgcmVxdWVzdENvbmZpZ3MuaGVhZGVycyA9IGhlYWRlcnM7XHJcbiAgICAgICAgcmVxdWVzdENvbmZpZ3Mub2JzZXJ2ZSA9ICdyZXNwb25zZSc7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuaHR0cENsaWVudC5yZXF1ZXN0KG1ldGhvZCwgdXJsLCByZXF1ZXN0Q29uZmlncykucGlwZShcclxuICAgICAgICAgICAgbWFwKChyZXN1bHQ6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICAgIGlmIChpZ25vcmVIYW5kbGluZ0NoYW5nZXMgPT09IHRydWUpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQgJiYgcmVzdWx0LmJvZHkgICYmIHJlc3VsdC5ib2R5LnJldHVyblZhbHVlID8gcmVzdWx0LmJvZHkucmV0dXJuVmFsdWUgOiByZXN1bHQ7XHJcbiAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiAgdGhpcy5wcm94eUV4dGVuZC5vblJlc3BvbnNlKHJlc3VsdCk7XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KSxcclxuICAgICAgICAgICAgY2F0Y2hFcnJvcigoZXJyb3I6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICAgIHJldHVybiB0aGlzLnByb3h5RXh0ZW5kLm9uRXJyb3IoZXJyb3IsIGZhbHNlLCBmYWxzZSk7XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICApO1xyXG4gICAgICB9KSxcclxuICAgICAgY2F0Y2hFcnJvcigoZXJyb3I6IGFueSkgPT4ge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnByb3h5RXh0ZW5kLm9uRXJyb3IoZXJyb3IsIGZhbHNlLCBmYWxzZSk7XHJcbiAgICAgIH0pXHJcbiAgICApO1xyXG4gIH1cclxuXHJcbn1cclxuIl19