/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, Input, Directive, TemplateRef, ContentChild, ElementRef, HostBinding, ViewEncapsulation, Output, EventEmitter, ChangeDetectionStrategy, ViewChild } from '@angular/core';
import { DataListFacadeService } from './core/datalist-facade.service';
export class DataListItemTemplateDirective {
    /**
     * @param {?} template
     */
    constructor(template) {
        this.template = template;
    }
}
DataListItemTemplateDirective.decorators = [
    { type: Directive, args: [{
                selector: '[list-item-tmp]'
            },] }
];
/** @nocollapse */
DataListItemTemplateDirective.ctorParameters = () => [
    { type: TemplateRef }
];
if (false) {
    /** @type {?} */
    DataListItemTemplateDirective.prototype.template;
}
export class DatalistComponent {
    /**
     * @param {?} el
     * @param {?} store
     */
    constructor(el, store) {
        this.el = el;
        this.store = store;
        this.cls = true;
        this.fit = true;
        this.width = 300;
        this.height = 400;
        this.multiSelect = false;
        this.disabled = false;
        this.showHeader = false;
        this.showCheckBox = false;
        this.headerHeight = 40;
        this.enableCancelSelected = true;
        this.disabledField = 'disabled';
        this.showDisabledItem = true;
        /**
         * 分隔符，默认为 ,
         */
        this.separator = ',';
        this.selected = new EventEmitter();
        this.unSelected = new EventEmitter();
        this.selectedValuesChange = new EventEmitter();
        this.emptyMessage = '暂无数据';
        this.scrollbarHeight$ = this.store.containerHeight$;
        // tslint:disable-next-line:variable-name
        this._options$ = this.store.options$;
        this.data$ = this.store.data$;
    }
    /**
     * @return {?}
     */
    get fluid() {
        return this._height === 'auto' ? false : this.fit;
    }
    /**
     * @param {?} changes
     * @return {?}
     */
    ngOnChanges(changes) {
        if (changes && changes.data && !changes.data.isFirstChange()) {
            this.initCtrlState();
        }
        if (changes.selectedValues && !changes.selectedValues.isFirstChange()) {
            if (this.selectedValues !== '' && this.selectedValues !== undefined && this.selectedValues !== null) {
                this.store.setSelections(this.selectedValues, this.separator);
            }
            else {
                this.clearSelections();
            }
        }
    }
    /**
     * @return {?}
     */
    ngOnInit() {
        this._height = this.height;
        this.initCtrlState();
    }
    /**
     * @return {?}
     */
    ngAfterViewInit() {
        setTimeout((/**
         * @return {?}
         */
        () => {
            if (this.selectedValues && this.height !== 'auto') {
                /** @type {?} */
                let val = this.selectedValues;
                if (this.selectedValues.indexOf(this.separator) > -1) {
                    val = this.selectedValues.indexOf(this.separator)[0];
                }
                /** @type {?} */
                const index = this.data.findIndex((/**
                 * @param {?} n
                 * @return {?}
                 */
                n => n[this.idField] == val));
                /** @type {?} */
                const ulEl = this.el.nativeElement.querySelector('ul.list-group');
                if (ulEl.children[index]) {
                    ulEl.children[index].scrollIntoView({ block: 'nearest' });
                }
            }
        }), 10);
    }
    /**
     * @private
     * @return {?}
     */
    loadData() {
        if (this.data) {
            this.store.loadData(this.data, this.selectedValues, this.separator);
        }
        setTimeout((/**
         * @return {?}
         */
        () => {
            if (this.emptyMsgEl && (!this.data || !this.data.length)) {
                this.emptyMsgEl.nativeElement.innerHTML = this.emptyMessage;
            }
        }), 10);
    }
    /**
     * @private
     * @return {?}
     */
    initCtrlState() {
        const { title, textField, fit, idField, valueField, width, height, multiSelect, disabled, headerHeight, separator, disabledField } = Object.assign({}, this);
        this.store.initState({
            title,
            textField,
            valueField,
            fit,
            idField,
            width,
            height,
            multiSelect,
            disabled,
            headerHeight,
            separator,
            disabledField
        });
        this.loadData();
    }
    /**
     * @return {?}
     */
    clearSelections() {
        this.store.clearSelections();
    }
    /**
     * @return {?}
     */
    resize() {
        if (this.fit) {
            /** @type {?} */
            const container = this.el.nativeElement.parentElement;
            /** @type {?} */
            const width = container.offsetWidth;
            /** @type {?} */
            const height = container.offsetHeight;
            this.store.updateContainerSize(width, height);
        }
    }
    /**
     * @private
     * @return {?}
     */
    updateSelectValues() {
        /** @type {?} */
        const values = this.store.getSelections().map((/**
         * @param {?} item
         * @return {?}
         */
        item => {
            return item[this.valueField];
        }));
        this.selectedValues = values.join(this.separator);
        this.selectedValuesChange.emit(this.selectedValues);
    }
    /**
     * @param {?} event
     * @param {?} index
     * @param {?} item
     * @return {?}
     */
    onSelectHandler(event, index, item) {
        event.stopPropagation();
        if (this.disabled) {
            return false;
        }
        if (item.disabled) {
            return;
        }
        const { data } = Object.assign({}, item);
        if (!this.store.isSelect(item.id)) {
            this.store.selectItem(data, index);
            this.updateSelectValues();
            this.selected.emit({ index, data });
        }
        else {
            if (this.enableCancelSelected) {
                this.store.unSelectItem(data);
                this.updateSelectValues();
                this.unSelected.emit({ index, data });
            }
        }
    }
    /**
     * @param {?} $event
     * @return {?}
     */
    onCheckedChange($event) {
        const { index, row, originalEvent } = $event;
        this.onSelectHandler(originalEvent, index, row);
    }
    /**
     * @param {?} item
     * @return {?}
     */
    isChecked(item) {
        /** @type {?} */
        let val = this.selectedValues;
        if (this.selectedValues === null && this.selectedValues === undefined) {
            val = '';
        }
        if (typeof val === 'boolean') {
            val = '' + val;
        }
        if (val) {
            /** @type {?} */
            let _vals = [];
            if (this.multiSelect) {
                _vals = val.split(this.separator);
            }
            else {
                _vals = [val];
            }
            return _vals.some((/**
             * @param {?} v
             * @return {?}
             */
            v => v == '' + item.data[this.valueField]));
        }
        return false;
    }
    /**
     * @param {?} item
     * @return {?}
     */
    isSelected(item) {
        return this.isChecked(item);
    }
    /**
     * @return {?}
     */
    selectAll() {
        this.selectedValues = this.data.map((/**
         * @param {?} item
         * @return {?}
         */
        item => item[this.valueField])).join(this.separator);
        this.store.selectAll();
    }
    /**
     * @return {?}
     */
    unSelectAll() {
        this.selectedValues = '';
        this.store.clearSelections();
    }
}
DatalistComponent.decorators = [
    { type: Component, args: [{
                selector: 'farris-datalist',
                template: "<div *ngIf=\"_options$ | async as opts\" class=\"card\" [style.width.%]=\"100\" [style.height]=\"opts.height === 'auto' ? 'auto' : opts.height + 'px'\" style=\"min-height: 10px;\">\r\n    <div class=\"card-header\" *ngIf=\"opts.showHeader\">\r\n        {{ opts.title }}\r\n    </div>\r\n    <div *ngIf=\"opts.height && opts.height !== 'auto' && (data$ | async).length > 0\" style=\"overflow: auto;\" [style.width.%]=\"100\" [style.height.px]=\"scrollbarHeight$ | async\">\r\n        <!-- <ul class=\"list-group list-group-flush\">\r\n            <li style=\"cursor: default;\" [farrist-datalist-item]=\"item\" [style.height.px]=\"itemHeight\"\r\n                [class.active]=\"store.isSelect(item.id)\" class=\"list-group-item list-group-item-action\" \r\n                [class.list-group-item-disabled]=\"item.disabled\" [style.display]=\"item.disabled && !showDisabledItem ? 'none': ''\"\r\n                *ngFor=\"let item of data$ | async; let i = index\" title=\"{{item.data[textField]}}\" (click)=\"onSelectHandler( $event, i, item)\">\r\n                <dl-checkbox *ngIf=\"multiSelect\" [checked]=\"isChecked(item)\" [index]=\"i\" [row]=\"item\" (checkedChange)=\"onCheckedChange($event)\"></dl-checkbox>\r\n                <ng-container *ngIf=\"!itemTemplate\">\r\n                    <span class=\"f-datalist-item-text\">{{ item.data[textField] }}</span>\r\n                </ng-container>\r\n                <ng-container *ngIf=\"itemTemplate\" [ngTemplateOutlet]=\"itemTemplate\" [ngTemplateOutletContext]=\"{ data: item, index: i }\"></ng-container>\r\n            </li>\r\n        </ul> -->\r\n        <ng-container [ngTemplateOutlet]=\"itemsTemplate\"></ng-container>\r\n    </div>\r\n    <div *ngIf=\"opts.height === 'auto' && (data$ | async).length > 0\" >\r\n        <ng-container [ngTemplateOutlet]=\"itemsTemplate\"></ng-container>\r\n    </div>\r\n    <div *ngIf=\"(data$ | async).length === 0\" style=\"height: 200px;\">\r\n        <div class=\"f-table-norecords-content\" #emptyMsgEl></div>\r\n    </div>\r\n</div>\r\n\r\n<ng-template #itemsTemplate>\r\n    <ul class=\"list-group list-group-flush\">\r\n        <li style=\"cursor: default;\" [farrist-datalist-item]=\"item\" [style.height.px]=\"itemHeight\"\r\n            [class.active]=\"isSelected(item)\" class=\"list-group-item list-group-item-action\"\r\n            [class.list-group-item-disabled]=\"item.disabled\" [style.display]=\"item.disabled && !showDisabledItem ? 'none': ''\"\r\n            *ngFor=\"let item of data$ | async; let i = index\" title=\"{{item.data[textField]}}\" (click)=\"onSelectHandler( $event, i, item)\">\r\n            <dl-checkbox *ngIf=\"multiSelect\" [checked]=\"isChecked(item)\" [index]=\"i\" [row]=\"item\" (checkedChange)=\"onCheckedChange($event)\"></dl-checkbox>\r\n            <ng-container *ngIf=\"!itemTemplate\">\r\n                <span class=\"f-datalist-item-text\">{{ item.data[textField] }}</span>\r\n            </ng-container>\r\n            <ng-container *ngIf=\"itemTemplate\" [ngTemplateOutlet]=\"itemTemplate\" [ngTemplateOutletContext]=\"{ data: item, index: i }\"></ng-container>\r\n        </li>\r\n    </ul>\r\n</ng-template>",
                providers: [DataListFacadeService],
                encapsulation: ViewEncapsulation.None,
                changeDetection: ChangeDetectionStrategy.OnPush,
                styles: [`
            .ps__rail-x,
            .ps__rail-y {
                z-index: 9;
            }
            .norecords-content {
                height: 8.125rem;
                padding: 7.8125rem 0 0;
                width: 100%;
                text-align: center;
                font-size: 1rem;
                color: rgba(0,0,0,.25);
                background: url(imgs/table-norecords.png) top center no-repeat;
                margin: -4.0625rem 0 0 -.625rem;
                line-height: 2.5rem;
            }

            .list-group-item-disabled {
                color: #ccc!important;
            }

            .f-datalist .list-group .list-group-item.list-group-item-disabled:hover {
                background: transparent!important;
            }
        `]
            }] }
];
/** @nocollapse */
DatalistComponent.ctorParameters = () => [
    { type: ElementRef },
    { type: DataListFacadeService }
];
DatalistComponent.propDecorators = {
    cls: [{ type: HostBinding, args: ['class.f-datalist',] }],
    fluid: [{ type: HostBinding, args: ['class.farris-main-area',] }],
    itemHeight: [{ type: Input }],
    title: [{ type: Input }],
    data: [{ type: Input }],
    textField: [{ type: Input }],
    valueField: [{ type: Input }],
    idField: [{ type: Input }],
    fit: [{ type: Input }],
    width: [{ type: Input }],
    height: [{ type: Input }],
    multiSelect: [{ type: Input }],
    disabled: [{ type: Input }],
    showHeader: [{ type: Input }],
    showCheckBox: [{ type: Input }],
    headerHeight: [{ type: Input }],
    selectedValues: [{ type: Input }],
    enableCancelSelected: [{ type: Input }],
    disabledField: [{ type: Input }],
    showDisabledItem: [{ type: Input }],
    separator: [{ type: Input }],
    itemTemplate: [{ type: ContentChild, args: [DataListItemTemplateDirective, { read: TemplateRef },] }],
    selected: [{ type: Output }],
    unSelected: [{ type: Output }],
    selectedValuesChange: [{ type: Output }],
    emptyMessage: [{ type: Input }],
    emptyMsgEl: [{ type: ViewChild, args: ['emptyMsgEl',] }]
};
if (false) {
    /** @type {?} */
    DatalistComponent.prototype.cls;
    /** @type {?} */
    DatalistComponent.prototype.itemHeight;
    /** @type {?} */
    DatalistComponent.prototype.title;
    /** @type {?} */
    DatalistComponent.prototype.data;
    /** @type {?} */
    DatalistComponent.prototype.textField;
    /** @type {?} */
    DatalistComponent.prototype.valueField;
    /** @type {?} */
    DatalistComponent.prototype.idField;
    /** @type {?} */
    DatalistComponent.prototype.fit;
    /** @type {?} */
    DatalistComponent.prototype.width;
    /** @type {?} */
    DatalistComponent.prototype.height;
    /** @type {?} */
    DatalistComponent.prototype.multiSelect;
    /** @type {?} */
    DatalistComponent.prototype.disabled;
    /** @type {?} */
    DatalistComponent.prototype.showHeader;
    /** @type {?} */
    DatalistComponent.prototype.showCheckBox;
    /** @type {?} */
    DatalistComponent.prototype.headerHeight;
    /** @type {?} */
    DatalistComponent.prototype.selectedValues;
    /** @type {?} */
    DatalistComponent.prototype.enableCancelSelected;
    /** @type {?} */
    DatalistComponent.prototype.disabledField;
    /** @type {?} */
    DatalistComponent.prototype.showDisabledItem;
    /**
     * 分隔符，默认为 ,
     * @type {?}
     */
    DatalistComponent.prototype.separator;
    /** @type {?} */
    DatalistComponent.prototype.itemTemplate;
    /** @type {?} */
    DatalistComponent.prototype.selected;
    /** @type {?} */
    DatalistComponent.prototype.unSelected;
    /** @type {?} */
    DatalistComponent.prototype.selectedValuesChange;
    /** @type {?} */
    DatalistComponent.prototype.emptyMessage;
    /** @type {?} */
    DatalistComponent.prototype.scrollbarHeight$;
    /** @type {?} */
    DatalistComponent.prototype._options$;
    /** @type {?} */
    DatalistComponent.prototype.data$;
    /**
     * @type {?}
     * @private
     */
    DatalistComponent.prototype._height;
    /** @type {?} */
    DatalistComponent.prototype.emptyMsgEl;
    /** @type {?} */
    DatalistComponent.prototype.el;
    /** @type {?} */
    DatalistComponent.prototype.store;
}
export class DataListItemComponentDirective {
    /**
     * @param {?} el
     */
    constructor(el) {
        this.el = el;
    }
    /**
     * @return {?}
     */
    ngOnInit() { }
}
DataListItemComponentDirective.decorators = [
    { type: Directive, args: [{
                // tslint:disable-next-line:directive-selector
                selector: '[farrist-datalist-item]'
            },] }
];
/** @nocollapse */
DataListItemComponentDirective.ctorParameters = () => [
    { type: ElementRef }
];
DataListItemComponentDirective.propDecorators = {
    data: [{ type: Input, args: ['farrist-datalist-item',] }]
};
if (false) {
    /** @type {?} */
    DataListItemComponentDirective.prototype.data;
    /**
     * @type {?}
     * @private
     */
    DataListItemComponentDirective.prototype.el;
}
/**
 * 表体checkbox 组件
 */
export class DataListCheckboxComponent {
    constructor() {
        this.checkedChange = new EventEmitter();
    }
    /**
     * @return {?}
     */
    ngOnInit() { }
    /**
     * @param {?} event
     * @return {?}
     */
    handleClick(event) {
        this.checked = !this.checked;
        this.checkedChange.emit({ originalEvent: event, index: this.index, row: this.row, state: this.checked });
        event.stopPropagation();
    }
}
DataListCheckboxComponent.decorators = [
    { type: Component, args: [{
                // tslint:disable-next-line:component-selector
                selector: 'dl-checkbox',
                template: `
        <div class="custom-control custom-checkbox  custom-control-inline dl-checkbox">
            <input type="checkbox" #chk class="custom-control-input" [disabled]="disabled" [checked]="checked" />
            <label class="custom-control-label" (click)="handleClick($event)"></label>
        </div>
    `,
                styles: [`
            :host .custom-checkbox {
                opacity: 1;
                float: none;
                margin: 0;
                vertical-align: top;
                padding-right: 0px;
            }
        `]
            }] }
];
/** @nocollapse */
DataListCheckboxComponent.ctorParameters = () => [];
DataListCheckboxComponent.propDecorators = {
    checked: [{ type: Input }],
    disabled: [{ type: Input }],
    index: [{ type: Input }],
    row: [{ type: Input }],
    checkedChange: [{ type: Output }],
    chk: [{ type: ViewChild, args: ['chk',] }]
};
if (false) {
    /** @type {?} */
    DataListCheckboxComponent.prototype.checked;
    /** @type {?} */
    DataListCheckboxComponent.prototype.disabled;
    /** @type {?} */
    DataListCheckboxComponent.prototype.index;
    /** @type {?} */
    DataListCheckboxComponent.prototype.row;
    /** @type {?} */
    DataListCheckboxComponent.prototype.checkedChange;
    /** @type {?} */
    DataListCheckboxComponent.prototype.chk;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGF0YWxpc3QuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGZhcnJpcy91aS1kYXRhbGlzdC8iLCJzb3VyY2VzIjpbImxpYi9kYXRhbGlzdC5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUFBLE9BQU8sRUFDSCxTQUFTLEVBRVQsS0FBSyxFQUNMLFNBQVMsRUFDVCxXQUFXLEVBQ1gsWUFBWSxFQUNaLFVBQVUsRUFDVixXQUFXLEVBRVgsaUJBQWlCLEVBQ2pCLE1BQU0sRUFDTixZQUFZLEVBQ1osdUJBQXVCLEVBR3ZCLFNBQVMsRUFDWixNQUFNLGVBQWUsQ0FBQztBQUV2QixPQUFPLEVBQUUscUJBQXFCLEVBQUUsTUFBTSxnQ0FBZ0MsQ0FBQztBQU12RSxNQUFNLE9BQU8sNkJBQTZCOzs7O0lBQ3RDLFlBQW1CLFFBQTBCO1FBQTFCLGFBQVEsR0FBUixRQUFRLENBQWtCO0lBQUcsQ0FBQzs7O1lBSnBELFNBQVMsU0FBQztnQkFDUCxRQUFRLEVBQUUsaUJBQWlCO2FBQzlCOzs7O1lBbkJHLFdBQVc7Ozs7SUFxQkMsaURBQWlDOztBQXFDakQsTUFBTSxPQUFPLGlCQUFpQjs7Ozs7SUE4QzFCLFlBQW1CLEVBQWMsRUFBUyxLQUE0QjtRQUFuRCxPQUFFLEdBQUYsRUFBRSxDQUFZO1FBQVMsVUFBSyxHQUFMLEtBQUssQ0FBdUI7UUE3Q3JDLFFBQUcsR0FBRyxJQUFJLENBQUM7UUFjbkMsUUFBRyxHQUFHLElBQUksQ0FBQztRQUNYLFVBQUssR0FBRyxHQUFHLENBQUM7UUFDWixXQUFNLEdBQW9CLEdBQUcsQ0FBQztRQUM5QixnQkFBVyxHQUFHLEtBQUssQ0FBQztRQUNwQixhQUFRLEdBQUcsS0FBSyxDQUFDO1FBQ2pCLGVBQVUsR0FBRyxLQUFLLENBQUM7UUFDbkIsaUJBQVksR0FBRyxLQUFLLENBQUM7UUFDckIsaUJBQVksR0FBRyxFQUFFLENBQUM7UUFFbEIseUJBQW9CLEdBQUcsSUFBSSxDQUFDO1FBRTVCLGtCQUFhLEdBQUcsVUFBVSxDQUFDO1FBQzNCLHFCQUFnQixHQUFHLElBQUksQ0FBQzs7OztRQUV4QixjQUFTLEdBQUcsR0FBRyxDQUFDO1FBR2YsYUFBUSxHQUFHLElBQUksWUFBWSxFQUFjLENBQUM7UUFDMUMsZUFBVSxHQUFHLElBQUksWUFBWSxFQUFjLENBQUM7UUFDNUMseUJBQW9CLEdBQUcsSUFBSSxZQUFZLEVBQUUsQ0FBQztRQUczQyxpQkFBWSxHQUFHLE1BQU0sQ0FBQTtRQUM5QixxQkFBZ0IsR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLGdCQUFnQixDQUFDOztRQUUvQyxjQUFTLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxRQUFRLENBQUM7UUFDaEMsVUFBSyxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDO0lBS2dELENBQUM7Ozs7SUEzQzFFLElBQ0ksS0FBSztRQUNMLE9BQU8sSUFBSSxDQUFDLE9BQU8sS0FBSyxNQUFNLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQztJQUN0RCxDQUFDOzs7OztJQXlDRCxXQUFXLENBQUMsT0FBc0I7UUFDOUIsSUFBSSxPQUFPLElBQUksT0FBTyxDQUFDLElBQUksSUFBSSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsYUFBYSxFQUFFLEVBQUU7WUFDMUQsSUFBSSxDQUFDLGFBQWEsRUFBRSxDQUFDO1NBQ3hCO1FBRUQsSUFBSSxPQUFPLENBQUMsY0FBYyxJQUFJLENBQUMsT0FBTyxDQUFDLGNBQWMsQ0FBQyxhQUFhLEVBQUUsRUFBRTtZQUNuRSxJQUFJLElBQUksQ0FBQyxjQUFjLEtBQUssRUFBRSxJQUFJLElBQUksQ0FBQyxjQUFjLEtBQUssU0FBUyxJQUFJLElBQUksQ0FBQyxjQUFjLEtBQUssSUFBSSxFQUFFO2dCQUNqRyxJQUFJLENBQUMsS0FBSyxDQUFDLGFBQWEsQ0FBQyxJQUFJLENBQUMsY0FBYyxFQUFFLElBQUksQ0FBQyxTQUFTLENBQUMsQ0FBQzthQUNqRTtpQkFBTTtnQkFDSCxJQUFJLENBQUMsZUFBZSxFQUFFLENBQUM7YUFDMUI7U0FDSjtJQUVMLENBQUM7Ozs7SUFDRCxRQUFRO1FBQ0osSUFBSSxDQUFDLE9BQU8sR0FBRyxJQUFJLENBQUMsTUFBTSxDQUFDO1FBQzNCLElBQUksQ0FBQyxhQUFhLEVBQUUsQ0FBQztJQUN6QixDQUFDOzs7O0lBRUQsZUFBZTtRQUNYLFVBQVU7OztRQUFDLEdBQUcsRUFBRTtZQUNaLElBQUksSUFBSSxDQUFDLGNBQWMsSUFBSSxJQUFJLENBQUMsTUFBTSxLQUFLLE1BQU0sRUFBRTs7b0JBRTNDLEdBQUcsR0FBRyxJQUFJLENBQUMsY0FBYztnQkFDN0IsSUFBSSxJQUFJLENBQUMsY0FBYyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLEdBQUcsQ0FBQyxDQUFDLEVBQUU7b0JBQ2xELEdBQUcsR0FBRyxJQUFJLENBQUMsY0FBYyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7aUJBQ3hEOztzQkFFSyxLQUFLLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQyxTQUFTOzs7O2dCQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsSUFBSSxHQUFHLEVBQUM7O3NCQUN4RCxJQUFJLEdBQUcsSUFBSSxDQUFDLEVBQUUsQ0FBQyxhQUFhLENBQUMsYUFBYSxDQUFDLGVBQWUsQ0FBQztnQkFDakUsSUFBSSxJQUFJLENBQUMsUUFBUSxDQUFDLEtBQUssQ0FBQyxFQUFFO29CQUN0QixJQUFJLENBQUMsUUFBUSxDQUFDLEtBQUssQ0FBQyxDQUFDLGNBQWMsQ0FBQyxFQUFDLEtBQUssRUFBRSxTQUFTLEVBQUMsQ0FBQyxDQUFDO2lCQUMzRDthQUNKO1FBQ0wsQ0FBQyxHQUFFLEVBQUUsQ0FBQyxDQUFDO0lBQ1gsQ0FBQzs7Ozs7SUFDTyxRQUFRO1FBQ1osSUFBSSxJQUFJLENBQUMsSUFBSSxFQUFFO1lBQ1gsSUFBSSxDQUFDLEtBQUssQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLElBQUksRUFBRSxJQUFJLENBQUMsY0FBYyxFQUFFLElBQUksQ0FBQyxTQUFTLENBQUMsQ0FBQztTQUN2RTtRQUVELFVBQVU7OztRQUFDLEdBQUcsRUFBRTtZQUNaLElBQUksSUFBSSxDQUFDLFVBQVUsSUFBSSxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksSUFBSSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLEVBQUU7Z0JBQ3RELElBQUksQ0FBQyxVQUFVLENBQUMsYUFBYSxDQUFDLFNBQVMsR0FBRyxJQUFJLENBQUMsWUFBWSxDQUFDO2FBQy9EO1FBQ0wsQ0FBQyxHQUFFLEVBQUUsQ0FBQyxDQUFDO0lBQ1gsQ0FBQzs7Ozs7SUFFTyxhQUFhO2NBQ1gsRUFBRSxLQUFLLEVBQUUsU0FBUyxFQUFFLEdBQUcsRUFBRSxPQUFPLEVBQUUsVUFBVSxFQUFFLEtBQUssRUFBRSxNQUFNLEVBQUUsV0FBVyxFQUFFLFFBQVEsRUFBRSxZQUFZLEVBQUUsU0FBUyxFQUFFLGFBQWEsRUFBQyxxQkFDMUgsSUFBSSxDQUNWO1FBQ0QsSUFBSSxDQUFDLEtBQUssQ0FBQyxTQUFTLENBQUM7WUFDakIsS0FBSztZQUNMLFNBQVM7WUFDVCxVQUFVO1lBQ1YsR0FBRztZQUNILE9BQU87WUFDUCxLQUFLO1lBQ0wsTUFBTTtZQUNOLFdBQVc7WUFDWCxRQUFRO1lBQ1IsWUFBWTtZQUNaLFNBQVM7WUFDVCxhQUFhO1NBQ2hCLENBQUMsQ0FBQztRQUVILElBQUksQ0FBQyxRQUFRLEVBQUUsQ0FBQztJQUNwQixDQUFDOzs7O0lBRUQsZUFBZTtRQUNYLElBQUksQ0FBQyxLQUFLLENBQUMsZUFBZSxFQUFFLENBQUM7SUFDakMsQ0FBQzs7OztJQUVELE1BQU07UUFDRixJQUFJLElBQUksQ0FBQyxHQUFHLEVBQUU7O2tCQUNKLFNBQVMsR0FBRyxJQUFJLENBQUMsRUFBRSxDQUFDLGFBQWEsQ0FBQyxhQUFhOztrQkFDL0MsS0FBSyxHQUFHLFNBQVMsQ0FBQyxXQUFXOztrQkFDN0IsTUFBTSxHQUFHLFNBQVMsQ0FBQyxZQUFZO1lBQ3JDLElBQUksQ0FBQyxLQUFLLENBQUMsbUJBQW1CLENBQUMsS0FBSyxFQUFFLE1BQU0sQ0FBQyxDQUFDO1NBQ2pEO0lBQ0wsQ0FBQzs7Ozs7SUFFTyxrQkFBa0I7O2NBQ2hCLE1BQU0sR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLGFBQWEsRUFBRSxDQUFDLEdBQUc7Ozs7UUFBQyxJQUFJLENBQUMsRUFBRTtZQUNqRCxPQUFPLElBQUksQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLENBQUM7UUFDakMsQ0FBQyxFQUFDO1FBRUYsSUFBSSxDQUFDLGNBQWMsR0FBRyxNQUFNLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUMsQ0FBQztRQUNsRCxJQUFJLENBQUMsb0JBQW9CLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxjQUFjLENBQUMsQ0FBQztJQUN4RCxDQUFDOzs7Ozs7O0lBRUQsZUFBZSxDQUFDLEtBQVksRUFBRSxLQUFhLEVBQUUsSUFBb0I7UUFDN0QsS0FBSyxDQUFDLGVBQWUsRUFBRSxDQUFDO1FBQ3hCLElBQUksSUFBSSxDQUFDLFFBQVEsRUFBRTtZQUNmLE9BQU8sS0FBSyxDQUFDO1NBQ2hCO1FBRUQsSUFBSSxJQUFJLENBQUMsUUFBUSxFQUFFO1lBQ2YsT0FBTztTQUNWO2NBRUssRUFBRSxJQUFJLEVBQUUscUJBQVEsSUFBSSxDQUFFO1FBRTVCLElBQUksQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLEVBQUU7WUFDL0IsSUFBSSxDQUFDLEtBQUssQ0FBQyxVQUFVLENBQUMsSUFBSSxFQUFFLEtBQUssQ0FBQyxDQUFDO1lBQ25DLElBQUksQ0FBQyxrQkFBa0IsRUFBRSxDQUFDO1lBQzFCLElBQUksQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLEVBQUUsS0FBSyxFQUFFLElBQUksRUFBRSxDQUFDLENBQUM7U0FDdkM7YUFBTTtZQUNILElBQUksSUFBSSxDQUFDLG9CQUFvQixFQUFFO2dCQUMzQixJQUFJLENBQUMsS0FBSyxDQUFDLFlBQVksQ0FBQyxJQUFJLENBQUMsQ0FBQztnQkFDOUIsSUFBSSxDQUFDLGtCQUFrQixFQUFFLENBQUM7Z0JBQzFCLElBQUksQ0FBQyxVQUFVLENBQUMsSUFBSSxDQUFDLEVBQUUsS0FBSyxFQUFFLElBQUksRUFBRSxDQUFDLENBQUM7YUFDekM7U0FDSjtJQUNMLENBQUM7Ozs7O0lBQ0QsZUFBZSxDQUFDLE1BQU07Y0FDWixFQUFFLEtBQUssRUFBRSxHQUFHLEVBQUUsYUFBYSxFQUFFLEdBQUcsTUFBTTtRQUM1QyxJQUFJLENBQUMsZUFBZSxDQUFDLGFBQWEsRUFBRSxLQUFLLEVBQUUsR0FBRyxDQUFDLENBQUM7SUFDcEQsQ0FBQzs7Ozs7SUFDRCxTQUFTLENBQUMsSUFBb0I7O1lBQ3RCLEdBQUcsR0FBRyxJQUFJLENBQUMsY0FBYztRQUM3QixJQUFJLElBQUksQ0FBQyxjQUFjLEtBQUssSUFBSSxJQUFJLElBQUksQ0FBQyxjQUFjLEtBQUssU0FBUyxFQUFFO1lBQ25FLEdBQUcsR0FBRyxFQUFFLENBQUM7U0FDWjtRQUVELElBQUksT0FBTyxHQUFHLEtBQUssU0FBUyxFQUFFO1lBQzFCLEdBQUcsR0FBRyxFQUFFLEdBQUcsR0FBRyxDQUFDO1NBQ2xCO1FBRUQsSUFBSSxHQUFHLEVBQUU7O2dCQUNELEtBQUssR0FBRyxFQUFFO1lBQ2QsSUFBSSxJQUFJLENBQUMsV0FBVyxFQUFFO2dCQUNsQixLQUFLLEdBQUcsR0FBRyxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLENBQUM7YUFDckM7aUJBQU07Z0JBQ0gsS0FBSyxHQUFHLENBQUMsR0FBRyxDQUFDLENBQUM7YUFDakI7WUFDRCxPQUFPLEtBQUssQ0FBQyxJQUFJOzs7O1lBQUUsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLElBQUssRUFBRSxHQUFHLElBQUksQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxFQUFDLENBQUM7U0FDbEU7UUFDRCxPQUFPLEtBQUssQ0FBQztJQUNqQixDQUFDOzs7OztJQUVELFVBQVUsQ0FBQyxJQUFvQjtRQUMzQixPQUFPLElBQUksQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLENBQUM7SUFDaEMsQ0FBQzs7OztJQUVELFNBQVM7UUFDTCxJQUFJLENBQUMsY0FBYyxHQUFHLElBQUksQ0FBQyxJQUFJLENBQUMsR0FBRzs7OztRQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxVQUFVLENBQUMsRUFBQyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLENBQUM7UUFDeEYsSUFBSSxDQUFDLEtBQUssQ0FBQyxTQUFTLEVBQUUsQ0FBQztJQUMzQixDQUFDOzs7O0lBRUQsV0FBVztRQUNQLElBQUksQ0FBQyxjQUFjLEdBQUcsRUFBRSxDQUFDO1FBQ3pCLElBQUksQ0FBQyxLQUFLLENBQUMsZUFBZSxFQUFFLENBQUM7SUFDakMsQ0FBQzs7O1lBM09KLFNBQVMsU0FBQztnQkFDUCxRQUFRLEVBQUUsaUJBQWlCO2dCQUMzQiw2bUdBQXdDO2dCQTRCeEMsU0FBUyxFQUFFLENBQUMscUJBQXFCLENBQUM7Z0JBQ2xDLGFBQWEsRUFBRSxpQkFBaUIsQ0FBQyxJQUFJO2dCQUNyQyxlQUFlLEVBQUUsdUJBQXVCLENBQUMsTUFBTTt5QkE1QjNDOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7U0F3QkM7YUFLUjs7OztZQXZERyxVQUFVO1lBWUwscUJBQXFCOzs7a0JBNkN6QixXQUFXLFNBQUMsa0JBQWtCO29CQUU5QixXQUFXLFNBQUMsd0JBQXdCO3lCQUtwQyxLQUFLO29CQUVMLEtBQUs7bUJBQ0wsS0FBSzt3QkFDTCxLQUFLO3lCQUNMLEtBQUs7c0JBQ0wsS0FBSztrQkFDTCxLQUFLO29CQUNMLEtBQUs7cUJBQ0wsS0FBSzswQkFDTCxLQUFLO3VCQUNMLEtBQUs7eUJBQ0wsS0FBSzsyQkFDTCxLQUFLOzJCQUNMLEtBQUs7NkJBQ0wsS0FBSzttQ0FDTCxLQUFLOzRCQUVMLEtBQUs7K0JBQ0wsS0FBSzt3QkFFTCxLQUFLOzJCQUNMLFlBQVksU0FBQyw2QkFBNkIsRUFBRSxFQUFFLElBQUksRUFBRSxXQUFXLEVBQUU7dUJBRWpFLE1BQU07eUJBQ04sTUFBTTttQ0FDTixNQUFNOzJCQUdOLEtBQUs7eUJBT0wsU0FBUyxTQUFDLFlBQVk7Ozs7SUEzQ3ZCLGdDQUE0Qzs7SUFPNUMsdUNBQTRCOztJQUU1QixrQ0FBdUI7O0lBQ3ZCLGlDQUFtQjs7SUFDbkIsc0NBQTJCOztJQUMzQix1Q0FBNEI7O0lBQzVCLG9DQUF5Qjs7SUFDekIsZ0NBQW9COztJQUNwQixrQ0FBcUI7O0lBQ3JCLG1DQUF1Qzs7SUFDdkMsd0NBQTZCOztJQUM3QixxQ0FBMEI7O0lBQzFCLHVDQUE0Qjs7SUFDNUIseUNBQThCOztJQUM5Qix5Q0FBMkI7O0lBQzNCLDJDQUFnQzs7SUFDaEMsaURBQXFDOztJQUVyQywwQ0FBb0M7O0lBQ3BDLDZDQUFpQzs7Ozs7SUFFakMsc0NBQXlCOztJQUN6Qix5Q0FBbUc7O0lBRW5HLHFDQUFvRDs7SUFDcEQsdUNBQXNEOztJQUN0RCxpREFBb0Q7O0lBR3BELHlDQUE4Qjs7SUFDOUIsNkNBQStDOztJQUUvQyxzQ0FBZ0M7O0lBQ2hDLGtDQUF5Qjs7Ozs7SUFDekIsb0NBQXFCOztJQUVyQix1Q0FBcUQ7O0lBRXpDLCtCQUFxQjs7SUFBRSxrQ0FBbUM7O0FBa0sxRSxNQUFNLE9BQU8sOEJBQThCOzs7O0lBR3ZDLFlBQW9CLEVBQWM7UUFBZCxPQUFFLEdBQUYsRUFBRSxDQUFZO0lBQUcsQ0FBQzs7OztJQUN0QyxRQUFRLEtBQUksQ0FBQzs7O1lBUmhCLFNBQVMsU0FBQzs7Z0JBRVAsUUFBUSxFQUFFLHlCQUF5QjthQUN0Qzs7OztZQXZRRyxVQUFVOzs7bUJBeVFULEtBQUssU0FBQyx1QkFBdUI7Ozs7SUFBOUIsOENBQXFEOzs7OztJQUV6Qyw0Q0FBc0I7Ozs7O0FBNEJ0QyxNQUFNLE9BQU8seUJBQXlCO0lBU2xDO1FBSlUsa0JBQWEsR0FBRyxJQUFJLFlBQVksRUFBRSxDQUFDO0lBSTlCLENBQUM7Ozs7SUFFaEIsUUFBUSxLQUFJLENBQUM7Ozs7O0lBRWIsV0FBVyxDQUFDLEtBQUs7UUFDYixJQUFJLENBQUMsT0FBTyxHQUFHLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQztRQUM3QixJQUFJLENBQUMsYUFBYSxDQUFDLElBQUksQ0FBQyxFQUFFLGFBQWEsRUFBRSxLQUFLLEVBQUUsS0FBSyxFQUFFLElBQUksQ0FBQyxLQUFLLEVBQUUsR0FBRyxFQUFFLElBQUksQ0FBQyxHQUFHLEVBQUUsS0FBSyxFQUFFLElBQUksQ0FBQyxPQUFPLEVBQUUsQ0FBQyxDQUFDO1FBQ3pHLEtBQUssQ0FBQyxlQUFlLEVBQUUsQ0FBQztJQUM1QixDQUFDOzs7WUF0Q0osU0FBUyxTQUFDOztnQkFFUCxRQUFRLEVBQUUsYUFBYTtnQkFDdkIsUUFBUSxFQUFFOzs7OztLQUtUO3lCQUVHOzs7Ozs7OztTQVFDO2FBRVI7Ozs7O3NCQUVJLEtBQUs7dUJBQ0wsS0FBSztvQkFDTCxLQUFLO2tCQUNMLEtBQUs7NEJBQ0wsTUFBTTtrQkFFTixTQUFTLFNBQUMsS0FBSzs7OztJQU5oQiw0Q0FBMEI7O0lBQzFCLDZDQUEyQjs7SUFDM0IsMENBQXVCOztJQUN2Qix3Q0FBa0I7O0lBQ2xCLGtEQUE2Qzs7SUFFN0Msd0NBQWtDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcclxuICAgIENvbXBvbmVudCxcclxuICAgIE9uSW5pdCxcclxuICAgIElucHV0LFxyXG4gICAgRGlyZWN0aXZlLFxyXG4gICAgVGVtcGxhdGVSZWYsXHJcbiAgICBDb250ZW50Q2hpbGQsXHJcbiAgICBFbGVtZW50UmVmLFxyXG4gICAgSG9zdEJpbmRpbmcsXHJcbiAgICBBZnRlclZpZXdJbml0LFxyXG4gICAgVmlld0VuY2Fwc3VsYXRpb24sXHJcbiAgICBPdXRwdXQsXHJcbiAgICBFdmVudEVtaXR0ZXIsXHJcbiAgICBDaGFuZ2VEZXRlY3Rpb25TdHJhdGVneSxcclxuICAgIFNpbXBsZUNoYW5nZXMsXHJcbiAgICBPbkNoYW5nZXMsXHJcbiAgICBWaWV3Q2hpbGRcclxufSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgRmFycmlzRGF0YUl0ZW0gfSBmcm9tICdAZmFycmlzL3VpLWNvbW1vbic7XHJcbmltcG9ydCB7IERhdGFMaXN0RmFjYWRlU2VydmljZSB9IGZyb20gJy4vY29yZS9kYXRhbGlzdC1mYWNhZGUuc2VydmljZSc7XHJcbmltcG9ydCB7IFNlbGVjdEl0ZW0gfSBmcm9tICcuL2NvcmUvdHlwZXMnO1xyXG5cclxuQERpcmVjdGl2ZSh7XHJcbiAgICBzZWxlY3RvcjogJ1tsaXN0LWl0ZW0tdG1wXSdcclxufSlcclxuZXhwb3J0IGNsYXNzIERhdGFMaXN0SXRlbVRlbXBsYXRlRGlyZWN0aXZlIHtcclxuICAgIGNvbnN0cnVjdG9yKHB1YmxpYyB0ZW1wbGF0ZTogVGVtcGxhdGVSZWY8YW55Pikge31cclxufVxyXG5cclxuQENvbXBvbmVudCh7XHJcbiAgICBzZWxlY3RvcjogJ2ZhcnJpcy1kYXRhbGlzdCcsXHJcbiAgICB0ZW1wbGF0ZVVybDogJy4vZGF0YWxpc3QuY29tcG9uZW50Lmh0bWwnLFxyXG4gICAgc3R5bGVzOiBbXHJcbiAgICAgICAgYFxyXG4gICAgICAgICAgICAucHNfX3JhaWwteCxcclxuICAgICAgICAgICAgLnBzX19yYWlsLXkge1xyXG4gICAgICAgICAgICAgICAgei1pbmRleDogOTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAubm9yZWNvcmRzLWNvbnRlbnQge1xyXG4gICAgICAgICAgICAgICAgaGVpZ2h0OiA4LjEyNXJlbTtcclxuICAgICAgICAgICAgICAgIHBhZGRpbmc6IDcuODEyNXJlbSAwIDA7XHJcbiAgICAgICAgICAgICAgICB3aWR0aDogMTAwJTtcclxuICAgICAgICAgICAgICAgIHRleHQtYWxpZ246IGNlbnRlcjtcclxuICAgICAgICAgICAgICAgIGZvbnQtc2l6ZTogMXJlbTtcclxuICAgICAgICAgICAgICAgIGNvbG9yOiByZ2JhKDAsMCwwLC4yNSk7XHJcbiAgICAgICAgICAgICAgICBiYWNrZ3JvdW5kOiB1cmwoaW1ncy90YWJsZS1ub3JlY29yZHMucG5nKSB0b3AgY2VudGVyIG5vLXJlcGVhdDtcclxuICAgICAgICAgICAgICAgIG1hcmdpbjogLTQuMDYyNXJlbSAwIDAgLS42MjVyZW07XHJcbiAgICAgICAgICAgICAgICBsaW5lLWhlaWdodDogMi41cmVtO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAubGlzdC1ncm91cC1pdGVtLWRpc2FibGVkIHtcclxuICAgICAgICAgICAgICAgIGNvbG9yOiAjY2NjIWltcG9ydGFudDtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgLmYtZGF0YWxpc3QgLmxpc3QtZ3JvdXAgLmxpc3QtZ3JvdXAtaXRlbS5saXN0LWdyb3VwLWl0ZW0tZGlzYWJsZWQ6aG92ZXIge1xyXG4gICAgICAgICAgICAgICAgYmFja2dyb3VuZDogdHJhbnNwYXJlbnQhaW1wb3J0YW50O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgYFxyXG4gICAgXSxcclxuICAgIHByb3ZpZGVyczogW0RhdGFMaXN0RmFjYWRlU2VydmljZV0sXHJcbiAgICBlbmNhcHN1bGF0aW9uOiBWaWV3RW5jYXBzdWxhdGlvbi5Ob25lLFxyXG4gICAgY2hhbmdlRGV0ZWN0aW9uOiBDaGFuZ2VEZXRlY3Rpb25TdHJhdGVneS5PblB1c2hcclxufSlcclxuZXhwb3J0IGNsYXNzIERhdGFsaXN0Q29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0LCBPbkNoYW5nZXMsIEFmdGVyVmlld0luaXQge1xyXG4gICAgQEhvc3RCaW5kaW5nKCdjbGFzcy5mLWRhdGFsaXN0JykgY2xzID0gdHJ1ZTtcclxuXHJcbiAgICBASG9zdEJpbmRpbmcoJ2NsYXNzLmZhcnJpcy1tYWluLWFyZWEnKVxyXG4gICAgZ2V0IGZsdWlkKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9oZWlnaHQgPT09ICdhdXRvJyA/IGZhbHNlIDogdGhpcy5maXQ7XHJcbiAgICB9XHJcblxyXG4gICAgQElucHV0KCkgaXRlbUhlaWdodDogbnVtYmVyO1xyXG5cclxuICAgIEBJbnB1dCgpIHRpdGxlOiBzdHJpbmc7XHJcbiAgICBASW5wdXQoKSBkYXRhOiBhbnk7XHJcbiAgICBASW5wdXQoKSB0ZXh0RmllbGQ6IHN0cmluZztcclxuICAgIEBJbnB1dCgpIHZhbHVlRmllbGQ6IHN0cmluZztcclxuICAgIEBJbnB1dCgpIGlkRmllbGQ6IHN0cmluZztcclxuICAgIEBJbnB1dCgpIGZpdCA9IHRydWU7XHJcbiAgICBASW5wdXQoKSB3aWR0aCA9IDMwMDtcclxuICAgIEBJbnB1dCgpIGhlaWdodDogbnVtYmVyIHwgc3RyaW5nID0gNDAwO1xyXG4gICAgQElucHV0KCkgbXVsdGlTZWxlY3QgPSBmYWxzZTtcclxuICAgIEBJbnB1dCgpIGRpc2FibGVkID0gZmFsc2U7XHJcbiAgICBASW5wdXQoKSBzaG93SGVhZGVyID0gZmFsc2U7XHJcbiAgICBASW5wdXQoKSBzaG93Q2hlY2tCb3ggPSBmYWxzZTtcclxuICAgIEBJbnB1dCgpIGhlYWRlckhlaWdodCA9IDQwO1xyXG4gICAgQElucHV0KCkgc2VsZWN0ZWRWYWx1ZXM6IHN0cmluZztcclxuICAgIEBJbnB1dCgpIGVuYWJsZUNhbmNlbFNlbGVjdGVkID0gdHJ1ZTtcclxuXHJcbiAgICBASW5wdXQoKSBkaXNhYmxlZEZpZWxkID0gJ2Rpc2FibGVkJztcclxuICAgIEBJbnB1dCgpIHNob3dEaXNhYmxlZEl0ZW0gPSB0cnVlO1xyXG4gICAgLyoqIOWIhumalOespu+8jOm7mOiupOS4uiAsICovXHJcbiAgICBASW5wdXQoKSBzZXBhcmF0b3IgPSAnLCc7XHJcbiAgICBAQ29udGVudENoaWxkKERhdGFMaXN0SXRlbVRlbXBsYXRlRGlyZWN0aXZlLCB7IHJlYWQ6IFRlbXBsYXRlUmVmIH0pIGl0ZW1UZW1wbGF0ZTogVGVtcGxhdGVSZWY8YW55PjtcclxuXHJcbiAgICBAT3V0cHV0KCkgc2VsZWN0ZWQgPSBuZXcgRXZlbnRFbWl0dGVyPFNlbGVjdEl0ZW0+KCk7XHJcbiAgICBAT3V0cHV0KCkgdW5TZWxlY3RlZCA9IG5ldyBFdmVudEVtaXR0ZXI8U2VsZWN0SXRlbT4oKTtcclxuICAgIEBPdXRwdXQoKSBzZWxlY3RlZFZhbHVlc0NoYW5nZSA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcclxuXHJcblxyXG4gICAgQElucHV0KCkgZW1wdHlNZXNzYWdlID0gJ+aaguaXoOaVsOaNridcclxuICAgIHNjcm9sbGJhckhlaWdodCQgPSB0aGlzLnN0b3JlLmNvbnRhaW5lckhlaWdodCQ7XHJcbiAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6dmFyaWFibGUtbmFtZVxyXG4gICAgX29wdGlvbnMkID0gdGhpcy5zdG9yZS5vcHRpb25zJDtcclxuICAgIGRhdGEkID0gdGhpcy5zdG9yZS5kYXRhJDtcclxuICAgIHByaXZhdGUgX2hlaWdodDogYW55O1xyXG5cclxuICAgIEBWaWV3Q2hpbGQoJ2VtcHR5TXNnRWwnKSBlbXB0eU1zZ0VsOiBFbGVtZW50UmVmPGFueT47XHJcblxyXG4gICAgY29uc3RydWN0b3IocHVibGljIGVsOiBFbGVtZW50UmVmLCBwdWJsaWMgc3RvcmU6IERhdGFMaXN0RmFjYWRlU2VydmljZSkge31cclxuICAgIG5nT25DaGFuZ2VzKGNoYW5nZXM6IFNpbXBsZUNoYW5nZXMpOiB2b2lkIHtcclxuICAgICAgICBpZiAoY2hhbmdlcyAmJiBjaGFuZ2VzLmRhdGEgJiYgIWNoYW5nZXMuZGF0YS5pc0ZpcnN0Q2hhbmdlKCkpIHtcclxuICAgICAgICAgICAgdGhpcy5pbml0Q3RybFN0YXRlKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoY2hhbmdlcy5zZWxlY3RlZFZhbHVlcyAmJiAhY2hhbmdlcy5zZWxlY3RlZFZhbHVlcy5pc0ZpcnN0Q2hhbmdlKCkpIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuc2VsZWN0ZWRWYWx1ZXMgIT09ICcnICYmIHRoaXMuc2VsZWN0ZWRWYWx1ZXMgIT09IHVuZGVmaW5lZCAmJiB0aGlzLnNlbGVjdGVkVmFsdWVzICE9PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnN0b3JlLnNldFNlbGVjdGlvbnModGhpcy5zZWxlY3RlZFZhbHVlcywgdGhpcy5zZXBhcmF0b3IpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jbGVhclNlbGVjdGlvbnMoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICB9XHJcbiAgICBuZ09uSW5pdCgpIHtcclxuICAgICAgICB0aGlzLl9oZWlnaHQgPSB0aGlzLmhlaWdodDtcclxuICAgICAgICB0aGlzLmluaXRDdHJsU3RhdGUoKTtcclxuICAgIH1cclxuXHJcbiAgICBuZ0FmdGVyVmlld0luaXQoKSB7XHJcbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLnNlbGVjdGVkVmFsdWVzICYmIHRoaXMuaGVpZ2h0ICE9PSAnYXV0bycpIHtcclxuXHJcbiAgICAgICAgICAgICAgICBsZXQgdmFsID0gdGhpcy5zZWxlY3RlZFZhbHVlcztcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLnNlbGVjdGVkVmFsdWVzLmluZGV4T2YodGhpcy5zZXBhcmF0b3IpID4gLTEpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YWwgPSB0aGlzLnNlbGVjdGVkVmFsdWVzLmluZGV4T2YodGhpcy5zZXBhcmF0b3IpWzBdO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGNvbnN0IGluZGV4ID0gdGhpcy5kYXRhLmZpbmRJbmRleChuID0+IG5bdGhpcy5pZEZpZWxkXSA9PSB2YWwpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdWxFbCA9IHRoaXMuZWwubmF0aXZlRWxlbWVudC5xdWVyeVNlbGVjdG9yKCd1bC5saXN0LWdyb3VwJyk7XHJcbiAgICAgICAgICAgICAgICBpZiAodWxFbC5jaGlsZHJlbltpbmRleF0pIHtcclxuICAgICAgICAgICAgICAgICAgICB1bEVsLmNoaWxkcmVuW2luZGV4XS5zY3JvbGxJbnRvVmlldyh7YmxvY2s6ICduZWFyZXN0J30pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSwgMTApO1xyXG4gICAgfVxyXG4gICAgcHJpdmF0ZSBsb2FkRGF0YSgpIHtcclxuICAgICAgICBpZiAodGhpcy5kYXRhKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc3RvcmUubG9hZERhdGEodGhpcy5kYXRhLCB0aGlzLnNlbGVjdGVkVmFsdWVzLCB0aGlzLnNlcGFyYXRvcik7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuZW1wdHlNc2dFbCAmJiAoIXRoaXMuZGF0YSB8fCAhdGhpcy5kYXRhLmxlbmd0aCkpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZW1wdHlNc2dFbC5uYXRpdmVFbGVtZW50LmlubmVySFRNTCA9IHRoaXMuZW1wdHlNZXNzYWdlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSwgMTApO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgaW5pdEN0cmxTdGF0ZSgpIHtcclxuICAgICAgICBjb25zdCB7IHRpdGxlLCB0ZXh0RmllbGQsIGZpdCwgaWRGaWVsZCwgdmFsdWVGaWVsZCwgd2lkdGgsIGhlaWdodCwgbXVsdGlTZWxlY3QsIGRpc2FibGVkLCBoZWFkZXJIZWlnaHQsIHNlcGFyYXRvciwgZGlzYWJsZWRGaWVsZH0gPSB7XHJcbiAgICAgICAgICAgIC4uLnRoaXNcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMuc3RvcmUuaW5pdFN0YXRlKHtcclxuICAgICAgICAgICAgdGl0bGUsXHJcbiAgICAgICAgICAgIHRleHRGaWVsZCxcclxuICAgICAgICAgICAgdmFsdWVGaWVsZCxcclxuICAgICAgICAgICAgZml0LFxyXG4gICAgICAgICAgICBpZEZpZWxkLFxyXG4gICAgICAgICAgICB3aWR0aCxcclxuICAgICAgICAgICAgaGVpZ2h0LFxyXG4gICAgICAgICAgICBtdWx0aVNlbGVjdCxcclxuICAgICAgICAgICAgZGlzYWJsZWQsXHJcbiAgICAgICAgICAgIGhlYWRlckhlaWdodCxcclxuICAgICAgICAgICAgc2VwYXJhdG9yLFxyXG4gICAgICAgICAgICBkaXNhYmxlZEZpZWxkXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHRoaXMubG9hZERhdGEoKTtcclxuICAgIH1cclxuXHJcbiAgICBjbGVhclNlbGVjdGlvbnMoKSB7XHJcbiAgICAgICAgdGhpcy5zdG9yZS5jbGVhclNlbGVjdGlvbnMoKTtcclxuICAgIH1cclxuXHJcbiAgICByZXNpemUoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuZml0KSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGNvbnRhaW5lciA9IHRoaXMuZWwubmF0aXZlRWxlbWVudC5wYXJlbnRFbGVtZW50O1xyXG4gICAgICAgICAgICBjb25zdCB3aWR0aCA9IGNvbnRhaW5lci5vZmZzZXRXaWR0aDtcclxuICAgICAgICAgICAgY29uc3QgaGVpZ2h0ID0gY29udGFpbmVyLm9mZnNldEhlaWdodDtcclxuICAgICAgICAgICAgdGhpcy5zdG9yZS51cGRhdGVDb250YWluZXJTaXplKHdpZHRoLCBoZWlnaHQpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIHVwZGF0ZVNlbGVjdFZhbHVlcygpIHtcclxuICAgICAgICBjb25zdCB2YWx1ZXMgPSB0aGlzLnN0b3JlLmdldFNlbGVjdGlvbnMoKS5tYXAoaXRlbSA9PiB7XHJcbiAgICAgICAgICAgIHJldHVybiBpdGVtW3RoaXMudmFsdWVGaWVsZF07XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHRoaXMuc2VsZWN0ZWRWYWx1ZXMgPSB2YWx1ZXMuam9pbih0aGlzLnNlcGFyYXRvcik7XHJcbiAgICAgICAgdGhpcy5zZWxlY3RlZFZhbHVlc0NoYW5nZS5lbWl0KHRoaXMuc2VsZWN0ZWRWYWx1ZXMpO1xyXG4gICAgfVxyXG5cclxuICAgIG9uU2VsZWN0SGFuZGxlcihldmVudDogRXZlbnQsIGluZGV4OiBudW1iZXIsIGl0ZW06IEZhcnJpc0RhdGFJdGVtKSB7XHJcbiAgICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgaWYgKHRoaXMuZGlzYWJsZWQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKGl0ZW0uZGlzYWJsZWQpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3QgeyBkYXRhIH0gPSB7IC4uLml0ZW0gfTtcclxuXHJcbiAgICAgICAgaWYgKCF0aGlzLnN0b3JlLmlzU2VsZWN0KGl0ZW0uaWQpKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc3RvcmUuc2VsZWN0SXRlbShkYXRhLCBpbmRleCk7XHJcbiAgICAgICAgICAgIHRoaXMudXBkYXRlU2VsZWN0VmFsdWVzKCk7XHJcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWQuZW1pdCh7IGluZGV4LCBkYXRhIH0pO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmVuYWJsZUNhbmNlbFNlbGVjdGVkKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnN0b3JlLnVuU2VsZWN0SXRlbShkYXRhKTtcclxuICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlU2VsZWN0VmFsdWVzKCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnVuU2VsZWN0ZWQuZW1pdCh7IGluZGV4LCBkYXRhIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgb25DaGVja2VkQ2hhbmdlKCRldmVudCkge1xyXG4gICAgICAgIGNvbnN0IHsgaW5kZXgsIHJvdywgb3JpZ2luYWxFdmVudCB9ID0gJGV2ZW50O1xyXG4gICAgICAgIHRoaXMub25TZWxlY3RIYW5kbGVyKG9yaWdpbmFsRXZlbnQsIGluZGV4LCByb3cpO1xyXG4gICAgfVxyXG4gICAgaXNDaGVja2VkKGl0ZW06IEZhcnJpc0RhdGFJdGVtKSB7XHJcbiAgICAgICAgbGV0IHZhbCA9IHRoaXMuc2VsZWN0ZWRWYWx1ZXM7XHJcbiAgICAgICAgaWYgKHRoaXMuc2VsZWN0ZWRWYWx1ZXMgPT09IG51bGwgJiYgdGhpcy5zZWxlY3RlZFZhbHVlcyA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIHZhbCA9ICcnO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHR5cGVvZiB2YWwgPT09ICdib29sZWFuJykge1xyXG4gICAgICAgICAgICB2YWwgPSAnJyArIHZhbDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICh2YWwpIHtcclxuICAgICAgICAgICAgbGV0IF92YWxzID0gW107XHJcbiAgICAgICAgICAgIGlmICh0aGlzLm11bHRpU2VsZWN0KSB7XHJcbiAgICAgICAgICAgICAgICBfdmFscyA9IHZhbC5zcGxpdCh0aGlzLnNlcGFyYXRvcik7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBfdmFscyA9IFt2YWxdO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBfdmFscy5zb21lKCB2ID0+IHYgPT0gICcnICsgaXRlbS5kYXRhW3RoaXMudmFsdWVGaWVsZF0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcblxyXG4gICAgaXNTZWxlY3RlZChpdGVtOiBGYXJyaXNEYXRhSXRlbSkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmlzQ2hlY2tlZChpdGVtKTtcclxuICAgIH1cclxuXHJcbiAgICBzZWxlY3RBbGwoKSB7XHJcbiAgICAgICAgdGhpcy5zZWxlY3RlZFZhbHVlcyA9IHRoaXMuZGF0YS5tYXAoaXRlbSA9PiBpdGVtW3RoaXMudmFsdWVGaWVsZF0pLmpvaW4odGhpcy5zZXBhcmF0b3IpO1xyXG4gICAgICAgIHRoaXMuc3RvcmUuc2VsZWN0QWxsKCk7XHJcbiAgICB9XHJcblxyXG4gICAgdW5TZWxlY3RBbGwoKSB7XHJcbiAgICAgICAgdGhpcy5zZWxlY3RlZFZhbHVlcyA9ICcnO1xyXG4gICAgICAgIHRoaXMuc3RvcmUuY2xlYXJTZWxlY3Rpb25zKCk7XHJcbiAgICB9XHJcbn1cclxuXHJcbkBEaXJlY3RpdmUoe1xyXG4gICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOmRpcmVjdGl2ZS1zZWxlY3RvclxyXG4gICAgc2VsZWN0b3I6ICdbZmFycmlzdC1kYXRhbGlzdC1pdGVtXSdcclxufSlcclxuZXhwb3J0IGNsYXNzIERhdGFMaXN0SXRlbUNvbXBvbmVudERpcmVjdGl2ZSBpbXBsZW1lbnRzIE9uSW5pdCB7XHJcbiAgICBASW5wdXQoJ2ZhcnJpc3QtZGF0YWxpc3QtaXRlbScpIGRhdGE6IEZhcnJpc0RhdGFJdGVtO1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKHByaXZhdGUgZWw6IEVsZW1lbnRSZWYpIHt9XHJcbiAgICBuZ09uSW5pdCgpIHt9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiDooajkvZNjaGVja2JveCDnu4Tku7ZcclxuICovXHJcbkBDb21wb25lbnQoe1xyXG4gICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOmNvbXBvbmVudC1zZWxlY3RvclxyXG4gICAgc2VsZWN0b3I6ICdkbC1jaGVja2JveCcsXHJcbiAgICB0ZW1wbGF0ZTogYFxyXG4gICAgICAgIDxkaXYgY2xhc3M9XCJjdXN0b20tY29udHJvbCBjdXN0b20tY2hlY2tib3ggIGN1c3RvbS1jb250cm9sLWlubGluZSBkbC1jaGVja2JveFwiPlxyXG4gICAgICAgICAgICA8aW5wdXQgdHlwZT1cImNoZWNrYm94XCIgI2NoayBjbGFzcz1cImN1c3RvbS1jb250cm9sLWlucHV0XCIgW2Rpc2FibGVkXT1cImRpc2FibGVkXCIgW2NoZWNrZWRdPVwiY2hlY2tlZFwiIC8+XHJcbiAgICAgICAgICAgIDxsYWJlbCBjbGFzcz1cImN1c3RvbS1jb250cm9sLWxhYmVsXCIgKGNsaWNrKT1cImhhbmRsZUNsaWNrKCRldmVudClcIj48L2xhYmVsPlxyXG4gICAgICAgIDwvZGl2PlxyXG4gICAgYCxcclxuICAgIHN0eWxlczogW1xyXG4gICAgICAgIGBcclxuICAgICAgICAgICAgOmhvc3QgLmN1c3RvbS1jaGVja2JveCB7XHJcbiAgICAgICAgICAgICAgICBvcGFjaXR5OiAxO1xyXG4gICAgICAgICAgICAgICAgZmxvYXQ6IG5vbmU7XHJcbiAgICAgICAgICAgICAgICBtYXJnaW46IDA7XHJcbiAgICAgICAgICAgICAgICB2ZXJ0aWNhbC1hbGlnbjogdG9wO1xyXG4gICAgICAgICAgICAgICAgcGFkZGluZy1yaWdodDogMHB4O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgYFxyXG4gICAgXVxyXG59KVxyXG5leHBvcnQgY2xhc3MgRGF0YUxpc3RDaGVja2JveENvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCB7XHJcbiAgICBASW5wdXQoKSBjaGVja2VkOiBib29sZWFuO1xyXG4gICAgQElucHV0KCkgZGlzYWJsZWQ6IGJvb2xlYW47XHJcbiAgICBASW5wdXQoKSBpbmRleDogbnVtYmVyO1xyXG4gICAgQElucHV0KCkgcm93OiBhbnk7XHJcbiAgICBAT3V0cHV0KCkgY2hlY2tlZENoYW5nZSA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcclxuXHJcbiAgICBAVmlld0NoaWxkKCdjaGsnKSBjaGs6IEVsZW1lbnRSZWY7XHJcblxyXG4gICAgY29uc3RydWN0b3IoKSB7fVxyXG5cclxuICAgIG5nT25Jbml0KCkge31cclxuXHJcbiAgICBoYW5kbGVDbGljayhldmVudCkge1xyXG4gICAgICAgIHRoaXMuY2hlY2tlZCA9ICF0aGlzLmNoZWNrZWQ7XHJcbiAgICAgICAgdGhpcy5jaGVja2VkQ2hhbmdlLmVtaXQoeyBvcmlnaW5hbEV2ZW50OiBldmVudCwgaW5kZXg6IHRoaXMuaW5kZXgsIHJvdzogdGhpcy5yb3csIHN0YXRlOiB0aGlzLmNoZWNrZWQgfSk7XHJcbiAgICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICB9XHJcbn1cclxuIl19