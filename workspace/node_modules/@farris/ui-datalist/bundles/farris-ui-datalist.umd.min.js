!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("rxjs/operators"),require("@farris/ui-common"),require("@farris/ui-perfect-scrollbar"),require("@angular/core")):"function"==typeof define&&define.amd?define("@farris/ui-datalist",["exports","rxjs/operators","@farris/ui-common","@farris/ui-perfect-scrollbar","@angular/core"],t):t((e.farris=e.farris||{},e.farris["ui-datalist"]={}),e.rxjs.operators,e.uiCommon,e.uiPerfectScrollbar,e.ng.core)}(this,function(e,t,i,n,a){"use strict";var s=(r.decorators=[{type:a.Injectable,args:[{providedIn:"root"}]}],r.ctorParameters=function(){return[]},r.ngInjectableDef=a.defineInjectable({factory:function(){return new r},token:r,providedIn:"root"}),r);function r(){}var l=function(e,t){return(l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)};var o,u=function(){return(u=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var a in t=arguments[i])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},c={title:"",data:[],textField:"",idField:"id",fit:!0,width:300,height:400,multiSelect:!1,showHeader:!1,headerHeight:40,disabled:!1,containerHeight:360,selections:[]},d=(function C(e,t){function i(){this.constructor=e}l(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}(p,o=i.BaseDataFacadeService),p.prototype.updateContainerSize=function(e,t){var i=t;this._state.showHeader&&(i=t-this._state.headerHeight),this.updateState({containerHeight:i,width:e,height:t})},p.decorators=[{type:a.Injectable}],p.ctorParameters=function(){return[]},p);function p(){var e=o.call(this,c)||this;return e.containerHeight$=e.state$.pipe(t.map(function(e){return e.containerHeight})),e.options$=e.state$,e}var h=(g.decorators=[{type:a.Directive,args:[{selector:"[list-item-tmp]"}]}],g.ctorParameters=function(){return[{type:a.TemplateRef}]},g);function g(e){this.template=e}var m=(Object.defineProperty(f.prototype,"fluid",{get:function(){return"auto"!==this._height&&this.fit},enumerable:!0,configurable:!0}),f.prototype.ngOnChanges=function(e){e&&e.data&&!e.data.isFirstChange()&&this.initCtrlState(),e.selectedValues&&!e.selectedValues.isFirstChange()&&(""!==this.selectedValues&&this.selectedValues!==undefined&&null!==this.selectedValues?this.store.setSelections(this.selectedValues,this.separator):this.clearSelections())},f.prototype.ngOnInit=function(){this._height=this.height,this.initCtrlState()},f.prototype.ngAfterViewInit=function(){var n=this;setTimeout(function(){if(n.selectedValues&&"auto"!==n.height){var t=n.selectedValues;-1<n.selectedValues.indexOf(n.separator)&&(t=n.selectedValues.indexOf(n.separator)[0]);var e=n.data.findIndex(function(e){return e[n.idField]==t}),i=n.el.nativeElement.querySelector("ul.list-group");i.children[e]&&i.children[e].scrollIntoView({block:"nearest"})}},10)},f.prototype.loadData=function(){var e=this;this.data&&this.store.loadData(this.data,this.selectedValues,this.separator),setTimeout(function(){!e.emptyMsgEl||e.data&&e.data.length||(e.emptyMsgEl.nativeElement.innerHTML=e.emptyMessage)},10)},f.prototype.initCtrlState=function(){var e=u({},this),t=e.title,i=e.textField,n=e.fit,a=e.idField,s=e.valueField,r=e.width,l=e.height,o=e.multiSelect,c=e.disabled,d=e.headerHeight,p=e.separator,h=e.disabledField;this.store.initState({title:t,textField:i,valueField:s,fit:n,idField:a,width:r,height:l,multiSelect:o,disabled:c,headerHeight:d,separator:p,disabledField:h}),this.loadData()},f.prototype.clearSelections=function(){this.store.clearSelections()},f.prototype.resize=function(){if(this.fit){var e=this.el.nativeElement.parentElement,t=e.offsetWidth,i=e.offsetHeight;this.store.updateContainerSize(t,i)}},f.prototype.updateSelectValues=function(){var t=this,e=this.store.getSelections().map(function(e){return e[t.valueField]});this.selectedValues=e.join(this.separator),this.selectedValuesChange.emit(this.selectedValues)},f.prototype.onSelectHandler=function(e,t,i){if(e.stopPropagation(),this.disabled)return!1;if(!i.disabled){var n=u({},i).data;this.store.isSelect(i.id)?this.enableCancelSelected&&(this.store.unSelectItem(n),this.updateSelectValues(),this.unSelected.emit({index:t,data:n})):(this.store.selectItem(n,t),this.updateSelectValues(),this.selected.emit({index:t,data:n}))}},f.prototype.onCheckedChange=function(e){var t=e.index,i=e.row,n=e.originalEvent;this.onSelectHandler(n,t,i)},f.prototype.isChecked=function(t){var i=this,e=this.selectedValues;return null===this.selectedValues&&this.selectedValues===undefined&&(e=""),"boolean"==typeof e&&(e=""+e),!!e&&(this.multiSelect?e.split(this.separator):[e]).some(function(e){return e==""+t.data[i.valueField]})},f.prototype.isSelected=function(e){return this.isChecked(e)},f.prototype.selectAll=function(){var t=this;this.selectedValues=this.data.map(function(e){return e[t.valueField]}).join(this.separator),this.store.selectAll()},f.prototype.unSelectAll=function(){this.selectedValues="",this.store.clearSelections()},f.decorators=[{type:a.Component,args:[{selector:"farris-datalist",template:'<div *ngIf="_options$ | async as opts" class="card" [style.width.%]="100" [style.height]="opts.height === \'auto\' ? \'auto\' : opts.height + \'px\'" style="min-height: 10px;">\r\n    <div class="card-header" *ngIf="opts.showHeader">\r\n        {{ opts.title }}\r\n    </div>\r\n    <div *ngIf="opts.height && opts.height !== \'auto\' && (data$ | async).length > 0" style="overflow: auto;" [style.width.%]="100" [style.height.px]="scrollbarHeight$ | async">\r\n        \x3c!-- <ul class="list-group list-group-flush">\r\n            <li style="cursor: default;" [farrist-datalist-item]="item" [style.height.px]="itemHeight"\r\n                [class.active]="store.isSelect(item.id)" class="list-group-item list-group-item-action" \r\n                [class.list-group-item-disabled]="item.disabled" [style.display]="item.disabled && !showDisabledItem ? \'none\': \'\'"\r\n                *ngFor="let item of data$ | async; let i = index" title="{{item.data[textField]}}" (click)="onSelectHandler( $event, i, item)">\r\n                <dl-checkbox *ngIf="multiSelect" [checked]="isChecked(item)" [index]="i" [row]="item" (checkedChange)="onCheckedChange($event)"></dl-checkbox>\r\n                <ng-container *ngIf="!itemTemplate">\r\n                    <span class="f-datalist-item-text">{{ item.data[textField] }}</span>\r\n                </ng-container>\r\n                <ng-container *ngIf="itemTemplate" [ngTemplateOutlet]="itemTemplate" [ngTemplateOutletContext]="{ data: item, index: i }"></ng-container>\r\n            </li>\r\n        </ul> --\x3e\r\n        <ng-container [ngTemplateOutlet]="itemsTemplate"></ng-container>\r\n    </div>\r\n    <div *ngIf="opts.height === \'auto\' && (data$ | async).length > 0" >\r\n        <ng-container [ngTemplateOutlet]="itemsTemplate"></ng-container>\r\n    </div>\r\n    <div *ngIf="(data$ | async).length === 0" style="height: 200px;">\r\n        <div class="f-table-norecords-content" #emptyMsgEl></div>\r\n    </div>\r\n</div>\r\n\r\n<ng-template #itemsTemplate>\r\n    <ul class="list-group list-group-flush">\r\n        <li style="cursor: default;" [farrist-datalist-item]="item" [style.height.px]="itemHeight"\r\n            [class.active]="isSelected(item)" class="list-group-item list-group-item-action"\r\n            [class.list-group-item-disabled]="item.disabled" [style.display]="item.disabled && !showDisabledItem ? \'none\': \'\'"\r\n            *ngFor="let item of data$ | async; let i = index" title="{{item.data[textField]}}" (click)="onSelectHandler( $event, i, item)">\r\n            <dl-checkbox *ngIf="multiSelect" [checked]="isChecked(item)" [index]="i" [row]="item" (checkedChange)="onCheckedChange($event)"></dl-checkbox>\r\n            <ng-container *ngIf="!itemTemplate">\r\n                <span class="f-datalist-item-text">{{ item.data[textField] }}</span>\r\n            </ng-container>\r\n            <ng-container *ngIf="itemTemplate" [ngTemplateOutlet]="itemTemplate" [ngTemplateOutletContext]="{ data: item, index: i }"></ng-container>\r\n        </li>\r\n    </ul>\r\n</ng-template>',providers:[d],encapsulation:a.ViewEncapsulation.None,changeDetection:a.ChangeDetectionStrategy.OnPush,styles:["\n            .ps__rail-x,\n            .ps__rail-y {\n                z-index: 9;\n            }\n            .norecords-content {\n                height: 8.125rem;\n                padding: 7.8125rem 0 0;\n                width: 100%;\n                text-align: center;\n                font-size: 1rem;\n                color: rgba(0,0,0,.25);\n                background: url(imgs/table-norecords.png) top center no-repeat;\n                margin: -4.0625rem 0 0 -.625rem;\n                line-height: 2.5rem;\n            }\n\n            .list-group-item-disabled {\n                color: #ccc!important;\n            }\n\n            .f-datalist .list-group .list-group-item.list-group-item-disabled:hover {\n                background: transparent!important;\n            }\n        "]}]}],f.ctorParameters=function(){return[{type:a.ElementRef},{type:d}]},f.propDecorators={cls:[{type:a.HostBinding,args:["class.f-datalist"]}],fluid:[{type:a.HostBinding,args:["class.farris-main-area"]}],itemHeight:[{type:a.Input}],title:[{type:a.Input}],data:[{type:a.Input}],textField:[{type:a.Input}],valueField:[{type:a.Input}],idField:[{type:a.Input}],fit:[{type:a.Input}],width:[{type:a.Input}],height:[{type:a.Input}],multiSelect:[{type:a.Input}],disabled:[{type:a.Input}],showHeader:[{type:a.Input}],showCheckBox:[{type:a.Input}],headerHeight:[{type:a.Input}],selectedValues:[{type:a.Input}],enableCancelSelected:[{type:a.Input}],disabledField:[{type:a.Input}],showDisabledItem:[{type:a.Input}],separator:[{type:a.Input}],itemTemplate:[{type:a.ContentChild,args:[h,{read:a.TemplateRef}]}],selected:[{type:a.Output}],unSelected:[{type:a.Output}],selectedValuesChange:[{type:a.Output}],emptyMessage:[{type:a.Input}],emptyMsgEl:[{type:a.ViewChild,args:["emptyMsgEl"]}]},f);function f(e,t){this.el=e,this.store=t,this.cls=!0,this.fit=!0,this.width=300,this.height=400,this.multiSelect=!1,this.disabled=!1,this.showHeader=!1,this.showCheckBox=!1,this.headerHeight=40,this.enableCancelSelected=!0,this.disabledField="disabled",this.showDisabledItem=!0,this.separator=",",this.selected=new a.EventEmitter,this.unSelected=new a.EventEmitter,this.selectedValuesChange=new a.EventEmitter,this.emptyMessage="暂无数据",this.scrollbarHeight$=this.store.containerHeight$,this._options$=this.store.options$,this.data$=this.store.data$}var y=(v.prototype.ngOnInit=function(){},v.decorators=[{type:a.Directive,args:[{selector:"[farrist-datalist-item]"}]}],v.ctorParameters=function(){return[{type:a.ElementRef}]},v.propDecorators={data:[{type:a.Input,args:["farrist-datalist-item"]}]},v);function v(e){this.el=e}var b=(x.prototype.ngOnInit=function(){},x.prototype.handleClick=function(e){this.checked=!this.checked,this.checkedChange.emit({originalEvent:e,index:this.index,row:this.row,state:this.checked}),e.stopPropagation()},x.decorators=[{type:a.Component,args:[{selector:"dl-checkbox",template:'\n        <div class="custom-control custom-checkbox  custom-control-inline dl-checkbox">\n            <input type="checkbox" #chk class="custom-control-input" [disabled]="disabled" [checked]="checked" />\n            <label class="custom-control-label" (click)="handleClick($event)"></label>\n        </div>\n    ',styles:["\n            :host .custom-checkbox {\n                opacity: 1;\n                float: none;\n                margin: 0;\n                vertical-align: top;\n                padding-right: 0px;\n            }\n        "]}]}],x.ctorParameters=function(){return[]},x.propDecorators={checked:[{type:a.Input}],disabled:[{type:a.Input}],index:[{type:a.Input}],row:[{type:a.Input}],checkedChange:[{type:a.Output}],chk:[{type:a.ViewChild,args:["chk"]}]},x);function x(){this.checkedChange=new a.EventEmitter}var I=(S.decorators=[{type:a.NgModule,args:[{declarations:[m,h,y,b],imports:[n.PerfectScrollbarModule],exports:[m,h,y,b]}]}],S);function S(){}e.DatalistService=s,e.DataListItemTemplateDirective=h,e.DatalistComponent=m,e.DataListItemComponentDirective=y,e.DataListCheckboxComponent=b,e.DatalistModule=I,e.DataListFacadeService=d,e.defaultDataState=c,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=farris-ui-datalist.umd.min.js.map