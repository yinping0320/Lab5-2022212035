/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, Input, HostBinding, Renderer2, ElementRef, Output, EventEmitter, HostListener } from "@angular/core";
export class SplitterPaneComponent {
    /**
     * @param {?} elementRef
     * @param {?} renderer
     */
    constructor(elementRef, renderer) {
        this.elementRef = elementRef;
        this.renderer = renderer;
        this.klass = true;
        this.collapsible = false;
        this.sizeChange = new EventEmitter();
        //orderState = new BehaviorSubject<any>({});
        // 记录収折前宽度，方便后续恢复
        this._beforeCollapseDistance = -1;
        this._enableCollapse = false;
        // 记录真实的iframe父容器
        this._relatedContainer = null;
        // 标记iframe父容器的样式属性position的值
        this._relatedContainerPosition = "";
        // 记录iframe在拖拽时的遮罩层
        this._relatedIframeOverlay = null;
        // 标记iframe遮罩层是否已显示
        this._iframeOverlayShownFlag = false;
        // 拖拽到某个值时，自动收起的阈值。如果阈值设置小于0，则不处理自动收起
        this.resizeCollapseThreshold = 20;
        // pane在splitter的位置，left 左侧 right 右侧 top 顶部 bottom 底部
        this.pos = "right";
        // 真实的展开时的距离，
        this.defaultExpandDistance = "20%";
        this.realExpandDisatance = "";
        // 展开时的距离，不设置时为空，设置了按照设置的值来
        this._expandDistance = "";
        // 初始收起状态
        this.initCollapse = false;
        /**
         * 收起折叠状态变化
         */
        this.collapseStateChange = new EventEmitter();
        // collapse的动画样式名
        this.animateCls = "splitter-pane-collapse-animate";
        // 标记是否需要更新变量
        this.updateParamsFlag = false;
        // 标记拖拽时上次的大小
        this.resizeDistance = -1;
        // 兼容旧表单写法
        if (this.elementRef) {
            this.el = this.elementRef.nativeElement;
        }
    }
    /**
     * 2022年6月8日 ximena
     * size、max、min、collapsible、sizeChange、order、orderState这些属性没有被实际使用
     * 该组件常用的属性来自于 ngResizable 拖拽组件
     * @param {?} value
     * @return {?}
     */
    set size(value) {
        this._size = value;
        this.sizeChange.emit(value);
        // this._sizeState.next(value);
    }
    /**
     * @param {?} value
     * @return {?}
     */
    set order(value) {
        this._order = value;
        //this.orderState.next(value);
    }
    // 启用収折
    /**
     * @param {?} value
     * @return {?}
     */
    set enableCollapse(value) {
        if (value !== undefined && value !== null) {
            this._enableCollapse = value;
            // 变化属性时
            if (this._enableCollapse && this.initCollapse) {
                this.toggleInitCollapseState();
            }
        }
    }
    /**
     * @return {?}
     */
    get enableCollapse() {
        return this._enableCollapse;
    }
    /**
     * @param {?} value
     * @return {?}
     */
    set relatedIframeParent(value) {
        this._relatedIframeParent = value;
        this.getRelatedIframeParent(value);
    }
    /**
     * @return {?}
     */
    get relatedIframeParent() {
        return this._relatedContainer;
    }
    /**
     * @param {?} value
     * @return {?}
     */
    set collapsePosition(value) {
        if (this.enableCollapse && value) {
            // 规范position
            /** @type {?} */
            let positionCorrect = ["left", "right", "top", "bottom"].findIndex((/**
             * @param {?} item
             * @return {?}
             */
            item => item == value));
            if (positionCorrect < -1) {
                value = "right";
            }
            if (this.pos != value) {
                this.el &&
                    this.renderer.removeClass(this.el, "splitter-pane-collapse-on-" + this.pos);
                this.pos = value;
                this.el &&
                    this.renderer.addClass(this.el, "splitter-pane-collapse-on-" + value);
            }
        }
    }
    /**
     * @return {?}
     */
    get collapsePosition() {
        return this.pos;
    }
    /**
     * @param {?} value
     * @return {?}
     */
    set expandDistance(value) {
        if (value) {
            this._expandDistance = this.resolveSize(value + "");
        }
        else {
            this._expandDistance = "";
        }
    }
    /**
     * @return {?}
     */
    get expandDistance() {
        return this._expandDistance;
    }
    /**
     * @param {?} value
     * @return {?}
     */
    set collapsed(value) {
        if (this.enableCollapse && value !== undefined && value !== null) {
            if (this.initCollapse !== value) {
                this.initCollapse = value;
                this.toggleInitCollapseState();
            }
        }
    }
    /**
     * @return {?}
     */
    get collapsed() {
        return this.initCollapse;
    }
    /**
     *  拖拽的变化中事件
     *  如果超过阈值，不处理
     *  暂未处理拖拽最大、最小值的问题
     * @param {?} pos
     * @return {?}
     */
    onRZResizing(pos) {
        if (this.enableCollapse && pos && pos["size"]) {
            /** @type {?} */
            let changeProp = this.getStyleProp();
            /** @type {?} */
            let resizeDirection = "";
            if (this.resizeDistance >= 0) {
                // 开始记录后
                // 此次值比上次记录大，说明在expand
                resizeDirection =
                    pos["size"][changeProp] > this.resizeDistance
                        ? "expand"
                        : "collapse";
            }
            this.resizeDistance = pos["size"][changeProp];
            if (resizeDirection == "expand" && this.initCollapse) {
                this.initCollapse = false;
            }
            if (pos["size"][changeProp] > this.resizeCollapseThreshold ||
                !resizeDirection) {
                // 拖拽速度快的时候，会漏掉计算的时机
                return;
            }
            if (this.resizeCollapseThreshold > 0) {
                // 设置了自动収折阈值
                if (!this.initCollapse && resizeDirection == "collapse") {
                    // 处理拖拽収折过程中，自动收起；不处理展开过程中的，自动展开
                    if (pos["actions"] &&
                        pos["actions"].hasOwnProperty("stopResize")) {
                        pos["actions"]["stopResize"]();
                    }
                    this.toggleCollapseState(null);
                }
            }
            else {
                // 未设置自动収折阈值，需要单独处理 即将收起时状态、即将展开时状态
                if (resizeDirection == "collapse") {
                    if (pos["size"][changeProp] < 3 && !this.initCollapse) {
                        this.initCollapse = true;
                    }
                }
            }
        }
    }
    // 拖拽的开始的事件
    /**
     * @param {?} pos
     * @return {?}
     */
    onRZStart(pos) {
        if (this.enableCollapse) {
            if (this.el.className.indexOf(this.animateCls) > -1) {
                this.renderer.removeClass(this.el, this.animateCls);
            }
        }
        // 如果有iframe遮罩并且没有显示
        if (this._relatedIframeOverlay && !this._iframeOverlayShownFlag) {
            if (["relative", "absolute"].indexOf(this._relatedContainerPosition) < 0) {
                this.renderer.setStyle(this._relatedContainer, "position", "relative");
            }
            this.renderer.setStyle(this._relatedIframeOverlay, "display", "block");
            this._iframeOverlayShownFlag = true;
        }
        if (!this.updateParamsFlag &&
            pos["actions"] &&
            pos["actions"].hasOwnProperty("updateParams")) {
            pos["actions"]["updateParams"]({ fixedEdge: true });
            this.updateParamsFlag = true;
        }
    }
    // 拖拽的停止事件
    /**
     * @param {?} pos
     * @return {?}
     */
    onRZStop(pos) {
        this.resizeDistance = -1;
        // 如果有iframe遮罩并且显示了
        if (this._relatedIframeOverlay && this._iframeOverlayShownFlag) {
            if (["relative", "absolute"].indexOf(this._relatedContainerPosition) < 0) {
                this.renderer.setStyle(this._relatedContainer, "position", this._relatedContainerPosition);
            }
            this.renderer.setStyle(this._relatedIframeOverlay, "display", "none");
            this._iframeOverlayShownFlag = false;
        }
    }
    /**
     * @return {?}
     */
    ngOnInit() {
        if (this.elementRef) {
            this.compatibleEl();
        }
    }
    /**
     * @return {?}
     */
    ngAfterViewInit() {
        if (!this.el) {
            this.compatibleEl();
        }
    }
    /**
     * 兼容旧表单写法
     * @private
     * @return {?}
     */
    compatibleEl() {
        this.el = this.elementRef.nativeElement;
        // 设置了iframe容器，但是没有创建遮罩
        if (this._relatedIframeParent && !this._relatedIframeOverlay) {
            this.getRelatedIframeParent(this._relatedIframeParent);
        }
        this.enableCollapse &&
            this.renderer.addClass(this.el, "splitter-pane-collapse-on-" + this.collapsePosition);
    }
    /**
     * @return {?}
     */
    ngOnDestroy() { }
    /*宽高类型是 string或者number 解析宽高  尺寸 */
    /**
     * @param {?} size
     * @return {?}
     */
    resolveSize(size) {
        /** @type {?} */
        const regex = /px|%|rem|em/;
        // 说明是字符串
        return regex.test(size)
            ? `${parseInt(size, 10)}${size.match(regex)[0]}`
            : `${size}px`;
    }
    /**
     * 规范获取iframe所在的父容器
     * @private
     * @param {?} content
     * @return {?}
     */
    getRelatedIframeParent(content) {
        if (!content || !this.el) {
            this._relatedContainer = null;
        }
        if (content instanceof ElementRef) {
            this._relatedContainer = content.nativeElement;
        }
        else if (typeof content == "string") {
            this._relatedContainer = this.el.parentElement.querySelector(content);
        }
        else {
            this._relatedContainer = content;
        }
        if (this._relatedContainer) {
            this._relatedContainerPosition = this._relatedContainer["style"]["position"];
            // 构造遮罩层
            this._relatedIframeOverlay = this.renderer.createElement("div");
            this._relatedIframeOverlay.className = "f-utils-absolute-all";
            this.renderer.setStyle(this._relatedIframeOverlay, "display", "none");
            this.renderer.appendChild(this._relatedContainer, this._relatedIframeOverlay);
        }
    }
    /**
     * 点击収折
     * @param {?} ev
     * @return {?}
     */
    toggleCollapseState(ev) {
        //禁止冒泡
        ev && ev.stopPropagation();
        if (!this.el)
            return;
        if (this.initCollapse) {
            // 待展开
            this.renderer.addClass(this.el, this.animateCls);
            this.changeCollapse("expand");
        }
        else {
            // 待收起
            this.renderer.addClass(this.el, this.animateCls);
            this.changeCollapse("collapse");
        }
        this.initCollapse = !this.initCollapse;
        this.collapseStateChange.emit(this.initCollapse);
    }
    /**
     * 切换初始收起状态
     * @return {?}
     */
    toggleInitCollapseState() {
        if (!this.el)
            return;
        if (this.initCollapse) {
            // 收起
            this.changeCollapse("collapse");
        }
        else {
            // 展开
            this.changeCollapse("expand");
        }
        this.collapseStateChange.emit(this.initCollapse);
    }
    /**
     * expand 为展开，collapse 为收起
     * @private
     * @param {?} collapseOrExpand
     * @return {?}
     */
    changeCollapse(collapseOrExpand) {
        /** @type {?} */
        let changeProp = this.getStyleProp();
        switch (collapseOrExpand) {
            case "expand":
                // 展开
                // 如果存在手写width赋值给pane会有问题
                if (this._expandDistance) {
                    //设置了展开距离
                    this.realExpandDisatance = this._expandDistance;
                }
                else {
                    //没有设置，按照之前的记录，如果存在就按照记录的值，如果没有就按照默认的值
                    this.realExpandDisatance = this._beforeCollapseDistance
                        ? this._beforeCollapseDistance + "px"
                        : this.defaultExpandDistance;
                }
                this.renderer.setStyle(this.el, changeProp, this.realExpandDisatance);
                break;
            default:
                // 收起
                this._beforeCollapseDistance =
                    changeProp == "height"
                        ? this.el.offsetHeight
                        : this.el.offsetWidth;
                this.renderer.setStyle(this.el, changeProp, "0px");
        }
    }
    /**
     * 布局排列不一样，影响到是设置宽度还是高度
     * @private
     * @return {?}
     */
    getStyleProp() {
        /** @type {?} */
        let hori = ["left", "right"].findIndex((/**
         * @param {?} item
         * @return {?}
         */
        item => item == this.collapsePosition));
        return hori > -1 ? "width" : "height";
    }
}
SplitterPaneComponent.decorators = [
    { type: Component, args: [{
                selector: "farris-splitter-pane",
                template: `
        <ng-content></ng-content>
        <div
            class="f-list-nav-toggle-sidebar"
            *ngIf="enableCollapse"
            [ngClass]="{ active: collapsed }"
            (click)="toggleCollapseState($event)"
        >
            <span class="triangle"></span>
        </div>
    `
            }] }
];
/** @nocollapse */
SplitterPaneComponent.ctorParameters = () => [
    { type: ElementRef },
    { type: Renderer2 }
];
SplitterPaneComponent.propDecorators = {
    klass: [{ type: HostBinding, args: ["class.f-component-splitter-pane",] }],
    size: [{ type: Input }],
    max: [{ type: Input }],
    min: [{ type: Input }],
    collapsible: [{ type: Input }],
    sizeChange: [{ type: Output }],
    enableCollapse: [{ type: Input }],
    relatedIframeParent: [{ type: Input }],
    resizeCollapseThreshold: [{ type: Input }],
    collapsePosition: [{ type: Input }],
    expandDistance: [{ type: Input }],
    collapsed: [{ type: Input }],
    collapseStateChange: [{ type: Output, args: ["collapseStateChange",] }],
    onRZResizing: [{ type: HostListener, args: ["rzResizing", ["$event"],] }],
    onRZStart: [{ type: HostListener, args: ["rzStart", ["$event"],] }],
    onRZStop: [{ type: HostListener, args: ["rzStop", ["$event"],] }]
};
if (false) {
    /** @type {?} */
    SplitterPaneComponent.prototype.klass;
    /** @type {?} */
    SplitterPaneComponent.prototype.max;
    /** @type {?} */
    SplitterPaneComponent.prototype.min;
    /** @type {?} */
    SplitterPaneComponent.prototype.collapsible;
    /** @type {?} */
    SplitterPaneComponent.prototype.sizeChange;
    /** @type {?} */
    SplitterPaneComponent.prototype._size;
    /** @type {?} */
    SplitterPaneComponent.prototype.el;
    /** @type {?} */
    SplitterPaneComponent.prototype._order;
    /**
     * @type {?}
     * @private
     */
    SplitterPaneComponent.prototype._beforeCollapseDistance;
    /**
     * @type {?}
     * @private
     */
    SplitterPaneComponent.prototype._enableCollapse;
    /**
     * @type {?}
     * @private
     */
    SplitterPaneComponent.prototype._relatedIframeParent;
    /**
     * @type {?}
     * @private
     */
    SplitterPaneComponent.prototype._relatedContainer;
    /**
     * @type {?}
     * @private
     */
    SplitterPaneComponent.prototype._relatedContainerPosition;
    /**
     * @type {?}
     * @private
     */
    SplitterPaneComponent.prototype._relatedIframeOverlay;
    /**
     * @type {?}
     * @private
     */
    SplitterPaneComponent.prototype._iframeOverlayShownFlag;
    /** @type {?} */
    SplitterPaneComponent.prototype.resizeCollapseThreshold;
    /**
     * @type {?}
     * @private
     */
    SplitterPaneComponent.prototype.pos;
    /**
     * @type {?}
     * @private
     */
    SplitterPaneComponent.prototype.defaultExpandDistance;
    /**
     * @type {?}
     * @private
     */
    SplitterPaneComponent.prototype.realExpandDisatance;
    /**
     * @type {?}
     * @private
     */
    SplitterPaneComponent.prototype._expandDistance;
    /**
     * @type {?}
     * @private
     */
    SplitterPaneComponent.prototype.initCollapse;
    /**
     * 收起折叠状态变化
     * @type {?}
     */
    SplitterPaneComponent.prototype.collapseStateChange;
    /**
     * @type {?}
     * @private
     */
    SplitterPaneComponent.prototype.animateCls;
    /**
     * @type {?}
     * @private
     */
    SplitterPaneComponent.prototype.updateParamsFlag;
    /**
     * @type {?}
     * @private
     */
    SplitterPaneComponent.prototype.resizeDistance;
    /**
     * @type {?}
     * @private
     */
    SplitterPaneComponent.prototype.elementRef;
    /**
     * @type {?}
     * @private
     */
    SplitterPaneComponent.prototype.renderer;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3BsaXR0ZXItcGFuZS5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZmFycmlzL3VpLXNwbGl0dGVyLyIsInNvdXJjZXMiOlsibGliL3NwbGl0dGVyLXBhbmUuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7QUFBQSxPQUFPLEVBQ0gsU0FBUyxFQUVULEtBQUssRUFDTCxXQUFXLEVBQ1gsU0FBUyxFQUVULFVBQVUsRUFDVixNQUFNLEVBQ04sWUFBWSxFQUNaLFlBQVksRUFFZixNQUFNLGVBQWUsQ0FBQztBQWlCdkIsTUFBTSxPQUFPLHFCQUFxQjs7Ozs7SUF3UDlCLFlBQW9CLFVBQXNCLEVBQVUsUUFBbUI7UUFBbkQsZUFBVSxHQUFWLFVBQVUsQ0FBWTtRQUFVLGFBQVEsR0FBUixRQUFRLENBQVc7UUF2UHZCLFVBQUssR0FBRyxJQUFJLENBQUM7UUFhcEQsZ0JBQVcsR0FBWSxLQUFLLENBQUM7UUFDNUIsZUFBVSxHQUFHLElBQUksWUFBWSxFQUFPLENBQUM7OztRQVd2Qyw0QkFBdUIsR0FBRyxDQUFDLENBQUMsQ0FBQztRQUM3QixvQkFBZSxHQUFHLEtBQUssQ0FBQzs7UUFrQnhCLHNCQUFpQixHQUFHLElBQUksQ0FBQzs7UUFFekIsOEJBQXlCLEdBQUcsRUFBRSxDQUFDOztRQUUvQiwwQkFBcUIsR0FBRyxJQUFJLENBQUM7O1FBRTdCLDRCQUF1QixHQUFHLEtBQUssQ0FBQzs7UUFXL0IsNEJBQXVCLEdBQUcsRUFBRSxDQUFDOztRQUU5QixRQUFHLEdBQUcsT0FBTyxDQUFDOztRQThCZCwwQkFBcUIsR0FBRyxLQUFLLENBQUM7UUFDOUIsd0JBQW1CLEdBQUcsRUFBRSxDQUFDOztRQUV6QixvQkFBZSxHQUFHLEVBQUUsQ0FBQzs7UUFjckIsaUJBQVksR0FBRyxLQUFLLENBQUM7Ozs7UUFlRSx3QkFBbUIsR0FBRyxJQUFJLFlBQVksRUFBRSxDQUFDOztRQUVoRSxlQUFVLEdBQUcsZ0NBQWdDLENBQUM7O1FBRzlDLHFCQUFn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QkFDTCxNQUFNOzZCQWNOLEtBQUs7a0NBdUJMLEtBQUs7c0NBVUwsS0FBSzsrQkFHTCxLQUFLOzZCQWlDTCxLQUFLO3dCQWNMLEtBQUs7a0NBY0wsTUFBTSxTQUFDLHFCQUFxQjsyQkFhNUIsWUFBWSxTQUFDLFlBQVksRUFBRSxDQUFDLFFBQVEsQ0FBQzt3QkFnRHJDLFlBQVksU0FBQyxTQUFTLEVBQUUsQ0FBQyxRQUFRLENBQUM7dUJBcUNsQyxZQUFZLFNBQUMsUUFBUSxFQUFFLENBQUMsUUFBUSxDQUFDOzs7O0lBL05sQyxzQ0FBNkQ7O0lBVzdELG9DQUFxQjs7SUFDckIsb0NBQXFCOztJQUNyQiw0Q0FBc0M7O0lBQ3RDLDJDQUErQzs7SUFDL0Msc0NBQWM7O0lBRWQsbUNBQWdCOztJQUtoQix1Q0FBZTs7Ozs7SUFHZix3REFBcUM7Ozs7O0lBQ3JDLGdEQUFnQzs7Ozs7SUFnQmhDLHFEQUF3RDs7Ozs7SUFFeEQsa0RBQWlDOzs7OztJQUVqQywwREFBdUM7Ozs7O0lBRXZDLHNEQUFxQzs7Ozs7SUFFckMsd0RBQXdDOztJQVd4Qyx3REFBc0M7Ozs7O0lBRXRDLG9DQUFzQjs7Ozs7SUE4QnRCLHNEQUFzQzs7Ozs7SUFDdEMsb0RBQWlDOzs7OztJQUVqQyxnREFBNkI7Ozs7O0lBYzdCLDZDQUE2Qjs7Ozs7SUFlN0Isb0RBQXdFOzs7OztJQUV4RSwyQ0FBc0Q7Ozs7O0lBR3RELGlEQUFpQzs7Ozs7SUFFakMsK0NBQTRCOzs7OztJQW1IaEIsMkNBQThCOzs7OztJQUFFLHlDQUEyQiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XHJcbiAgICBDb21wb25lbnQsXHJcbiAgICBPbkluaXQsXHJcbiAgICBJbnB1dCxcclxuICAgIEhvc3RCaW5kaW5nLFxyXG4gICAgUmVuZGVyZXIyLFxyXG4gICAgQWZ0ZXJWaWV3SW5pdCxcclxuICAgIEVsZW1lbnRSZWYsXHJcbiAgICBPdXRwdXQsXHJcbiAgICBFdmVudEVtaXR0ZXIsXHJcbiAgICBIb3N0TGlzdGVuZXIsXHJcbiAgICBPbkRlc3Ryb3lcclxufSBmcm9tIFwiQGFuZ3VsYXIvY29yZVwiO1xyXG5cclxuQENvbXBvbmVudCh7XHJcbiAgICBzZWxlY3RvcjogXCJmYXJyaXMtc3BsaXR0ZXItcGFuZVwiLFxyXG4gICAgdGVtcGxhdGU6IGBcclxuICAgICAgICA8bmctY29udGVudD48L25nLWNvbnRlbnQ+XHJcbiAgICAgICAgPGRpdlxyXG4gICAgICAgICAgICBjbGFzcz1cImYtbGlzdC1uYXYtdG9nZ2xlLXNpZGViYXJcIlxyXG4gICAgICAgICAgICAqbmdJZj1cImVuYWJsZUNvbGxhcHNlXCJcclxuICAgICAgICAgICAgW25nQ2xhc3NdPVwieyBhY3RpdmU6IGNvbGxhcHNlZCB9XCJcclxuICAgICAgICAgICAgKGNsaWNrKT1cInRvZ2dsZUNvbGxhcHNlU3RhdGUoJGV2ZW50KVwiXHJcbiAgICAgICAgPlxyXG4gICAgICAgICAgICA8c3BhbiBjbGFzcz1cInRyaWFuZ2xlXCI+PC9zcGFuPlxyXG4gICAgICAgIDwvZGl2PlxyXG4gICAgYCxcclxuICAgIHN0eWxlczogW11cclxufSlcclxuZXhwb3J0IGNsYXNzIFNwbGl0dGVyUGFuZUNvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCwgQWZ0ZXJWaWV3SW5pdCwgT25EZXN0cm95IHtcclxuICAgIEBIb3N0QmluZGluZyhcImNsYXNzLmYtY29tcG9uZW50LXNwbGl0dGVyLXBhbmVcIikga2xhc3MgPSB0cnVlO1xyXG4gICAgLyoqXHJcbiAgICAgKiAyMDIy5bm0NuaciDjml6UgeGltZW5hXHJcbiAgICAgKiBzaXpl44CBbWF444CBbWlu44CBY29sbGFwc2libGXjgIFzaXplQ2hhbmdl44CBb3JkZXLjgIFvcmRlclN0YXRl6L+Z5Lqb5bGe5oCn5rKh5pyJ6KKr5a6e6ZmF5L2/55SoXHJcbiAgICAgKiDor6Xnu4Tku7bluLjnlKjnmoTlsZ7mgKfmnaXoh6rkuo4gbmdSZXNpemFibGUg5ouW5ou957uE5Lu2XHJcbiAgICAgKi9cclxuICAgIEBJbnB1dCgpIHNldCBzaXplKHZhbHVlOiBhbnkpIHtcclxuICAgICAgICB0aGlzLl9zaXplID0gdmFsdWU7XHJcbiAgICAgICAgdGhpcy5zaXplQ2hhbmdlLmVtaXQodmFsdWUpO1xyXG4gICAgICAgIC8vIHRoaXMuX3NpemVTdGF0ZS5uZXh0KHZhbHVlKTtcclxuICAgIH1cclxuICAgIEBJbnB1dCgpIG1heDogc3RyaW5nO1xyXG4gICAgQElucHV0KCkgbWluOiBzdHJpbmc7XHJcbiAgICBASW5wdXQoKSBjb2xsYXBzaWJsZTogYm9vbGVhbiA9IGZhbHNlO1xyXG4gICAgQE91dHB1dCgpIHNpemVDaGFuZ2UgPSBuZXcgRXZlbnRFbWl0dGVyPGFueT4oKTtcclxuICAgIF9zaXplOiBzdHJpbmc7XHJcbiAgICAvL19zaXplU3RhdGUgPSBuZXcgQmVoYXZpb3JTdWJqZWN0PGFueT4oe30pO1xyXG4gICAgZWw6IEhUTUxFbGVtZW50O1xyXG4gICAgc2V0IG9yZGVyKHZhbHVlOiBudW1iZXIpIHtcclxuICAgICAgICB0aGlzLl9vcmRlciA9IHZhbHVlO1xyXG4gICAgICAgIC8vdGhpcy5vcmRlclN0YXRlLm5leHQodmFsdWUpO1xyXG4gICAgfVxyXG4gICAgX29yZGVyOiBudW1iZXI7XHJcbiAgICAvL29yZGVyU3RhdGUgPSBuZXcgQmVoYXZpb3JTdWJqZWN0PGFueT4oe30pO1xyXG4gICAgLy8g6K6w5b2V5Y+O5oqY5YmN5a695bqm77yM5pa55L6/5ZCO57ut5oGi5aSNXHJcbiAgICBwcml2YXRlIF9iZWZvcmVDb2xsYXBzZURpc3RhbmNlID0gLTE7XHJcbiAgICBwcml2YXRlIF9lbmFibGVDb2xsYXBzZSA9IGZhbHNlO1xyXG4gICAgLy8g5ZCv55So5Y+O5oqYXHJcbiAgICBASW5wdXQoKVxyXG4gICAgc2V0IGVuYWJsZUNvbGxhcHNlKHZhbHVlKSB7XHJcbiAgICAgICAgaWYgKHZhbHVlICE9PSB1bmRlZmluZWQgJiYgdmFsdWUgIT09IG51bGwpIHtcclxuICAgICAgICAgICAgdGhpcy5fZW5hYmxlQ29sbGFwc2UgPSB2YWx1ZTtcclxuICAgICAgICAgICAgLy8g5Y+Y5YyW5bGe5oCn5pe2XHJcbiAgICAgICAgICAgIGlmICh0aGlzLl9lbmFibGVDb2xsYXBzZSAmJiB0aGlzLmluaXRDb2xsYXBzZSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy50b2dnbGVJbml0Q29sbGFwc2VTdGF0ZSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgZ2V0IGVuYWJsZUNvbGxhcHNlKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9lbmFibGVDb2xsYXBzZTtcclxuICAgIH1cclxuICAgIC8vIOWkhOeQhuWFs+iBlOWPmOWKqOS4re+8jOWPpuWkluS4gOWkhOaciWlmcmFtZe+8jGlmcmFtZeW9seWTjeaLluaLveeahOaAp+iDvVxyXG4gICAgcHJpdmF0ZSBfcmVsYXRlZElmcmFtZVBhcmVudDogc3RyaW5nIHwgRWxlbWVudFJlZiB8IGFueTtcclxuICAgIC8vIOiusOW9leecn+WunueahGlmcmFtZeeItuWuueWZqFxyXG4gICAgcHJpdmF0ZSBfcmVsYXRlZENvbnRhaW5lciA9IG51bGw7XHJcbiAgICAvLyDmoIforrBpZnJhbWXniLblrrnlmajnmoTmoLflvI/lsZ7mgKdwb3NpdGlvbueahOWAvFxyXG4gICAgcHJpdmF0ZSBfcmVsYXRlZENvbnRhaW5lclBvc2l0aW9uID0gXCJcIjtcclxuICAgIC8vIOiusOW9lWlmcmFtZeWcqOaLluaLveaXtueahOmBrue9qeWxglxyXG4gICAgcHJpdmF0ZSBfcmVsYXRlZElmcmFtZU92ZXJsYXkgPSBudWxsO1xyXG4gICAgLy8g5qCH6K6waWZyYW1l6YGu572p5bGC5piv5ZCm5bey5pi+56S6XHJcbiAgICBwcml2YXRlIF9pZnJhbWVPdmVybGF5U2hvd25GbGFnID0gZmFsc2U7XHJcbiAgICBASW5wdXQoKVxyXG4gICAgc2V0IHJlbGF0ZWRJZnJhbWVQYXJlbnQodmFsdWU6IHN0cmluZyB8IEVsZW1lbnRSZWYgfCBhbnkpIHtcclxuICAgICAgICB0aGlzLl9yZWxhdGVkSWZyYW1lUGFyZW50PXZhbHVlO1xyXG4gICAgICAgIHRoaXMuZ2V0UmVsYXRlZElmcmFtZVBhcmVudCh2YWx1ZSk7XHJcbiAgICB9XHJcbiAgICBnZXQgcmVsYXRlZElmcmFtZVBhcmVudCgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fcmVsYXRlZENvbnRhaW5lcjtcclxuICAgIH1cclxuXHJcbiAgICAvLyDmi5bmi73liLDmn5DkuKrlgLzml7bvvIzoh6rliqjmlLbotbfnmoTpmIjlgLzjgILlpoLmnpzpmIjlgLzorr7nva7lsI/kuo4w77yM5YiZ5LiN5aSE55CG6Ieq5Yqo5pS26LW3XHJcbiAgICBASW5wdXQoKSByZXNpemVDb2xsYXBzZVRocmVzaG9sZCA9IDIwO1xyXG4gICAgLy8gcGFuZeWcqHNwbGl0dGVy55qE5L2N572u77yMbGVmdCDlt6bkvqcgcmlnaHQg5Y+z5L6nIHRvcCDpobbpg6ggYm90dG9tIOW6lemDqFxyXG4gICAgcHJpdmF0ZSBwb3MgPSBcInJpZ2h0XCI7XHJcbiAgICBASW5wdXQoKVxyXG4gICAgc2V0IGNvbGxhcHNlUG9zaXRpb24odmFsdWU6IHN0cmluZykge1xyXG4gICAgICAgIGlmICh0aGlzLmVuYWJsZUNvbGxhcHNlICYmIHZhbHVlKSB7XHJcbiAgICAgICAgICAgIC8vIOinhOiMg3Bvc2l0aW9uXHJcbiAgICAgICAgICAgIGxldCBwb3NpdGlvbkNvcnJlY3QgPSBbXCJsZWZ0XCIsIFwicmlnaHRcIiwgXCJ0b3BcIiwgXCJib3R0b21cIl0uZmluZEluZGV4KFxyXG4gICAgICAgICAgICAgICAgaXRlbSA9PiBpdGVtID09IHZhbHVlXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIGlmIChwb3NpdGlvbkNvcnJlY3QgPCAtMSkge1xyXG4gICAgICAgICAgICAgICAgdmFsdWUgPSBcInJpZ2h0XCI7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHRoaXMucG9zICE9IHZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmVsICYmXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW5kZXJlci5yZW1vdmVDbGFzcyhcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5lbCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgXCJzcGxpdHRlci1wYW5lLWNvbGxhcHNlLW9uLVwiICsgdGhpcy5wb3NcclxuICAgICAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5wb3MgPSB2YWx1ZTtcclxuICAgICAgICAgICAgICAgIHRoaXMuZWwgJiZcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbmRlcmVyLmFkZENsYXNzKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmVsLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBcInNwbGl0dGVyLXBhbmUtY29sbGFwc2Utb24tXCIgKyB2YWx1ZVxyXG4gICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBnZXQgY29sbGFwc2VQb3NpdGlvbigpOiBzdHJpbmcge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnBvcztcclxuICAgIH1cclxuICAgIC8vIOecn+WunueahOWxleW8gOaXtueahOi3neemu++8jFxyXG4gICAgcHJpdmF0ZSBkZWZhdWx0RXhwYW5kRGlzdGFuY2UgPSBcIjIwJVwiO1xyXG4gICAgcHJpdmF0ZSByZWFsRXhwYW5kRGlzYXRhbmNlID0gXCJcIjtcclxuICAgIC8vIOWxleW8gOaXtueahOi3neemu++8jOS4jeiuvue9ruaXtuS4uuepuu+8jOiuvue9ruS6huaMieeFp+iuvue9rueahOWAvOadpVxyXG4gICAgcHJpdmF0ZSBfZXhwYW5kRGlzdGFuY2UgPSBcIlwiO1xyXG4gICAgQElucHV0KClcclxuICAgIHNldCBleHBhbmREaXN0YW5jZSh2YWx1ZTogc3RyaW5nIHwgbnVtYmVyKSB7XHJcbiAgICAgICAgaWYgKHZhbHVlKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2V4cGFuZERpc3RhbmNlID0gdGhpcy5yZXNvbHZlU2l6ZSh2YWx1ZSArIFwiXCIpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2V4cGFuZERpc3RhbmNlID0gXCJcIjtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBnZXQgZXhwYW5kRGlzdGFuY2UoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2V4cGFuZERpc3RhbmNlO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIOWIneWni+aUtui1t+eKtuaAgVxyXG4gICAgcHJpdmF0ZSBpbml0Q29sbGFwc2UgPSBmYWxzZTtcclxuICAgIEBJbnB1dCgpXHJcbiAgICBzZXQgY29sbGFwc2VkKHZhbHVlKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuZW5hYmxlQ29sbGFwc2UgJiYgdmFsdWUgIT09IHVuZGVmaW5lZCAmJiB2YWx1ZSAhPT0gbnVsbCkge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5pbml0Q29sbGFwc2UgIT09IHZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmluaXRDb2xsYXBzZSA9IHZhbHVlO1xyXG4gICAgICAgICAgICAgICAgdGhpcy50b2dnbGVJbml0Q29sbGFwc2VTdGF0ZSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgZ2V0IGNvbGxhcHNlZCgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5pbml0Q29sbGFwc2U7XHJcbiAgICB9XHJcblxyXG4gICAgLyoq5pS26LW35oqY5Y+g54q25oCB5Y+Y5YyWICovXHJcbiAgICBAT3V0cHV0KFwiY29sbGFwc2VTdGF0ZUNoYW5nZVwiKSBjb2xsYXBzZVN0YXRlQ2hhbmdlID0gbmV3IEV2ZW50RW1pdHRlcigpO1xyXG4gICAgLy8gY29sbGFwc2XnmoTliqjnlLvmoLflvI/lkI1cclxuICAgIHByaXZhdGUgYW5pbWF0ZUNscyA9IFwic3BsaXR0ZXItcGFuZS1jb2xsYXBzZS1hbmltYXRlXCI7XHJcblxyXG4gICAgLy8g5qCH6K6w5piv5ZCm6ZyA6KaB5pu05paw5Y+Y6YePXHJcbiAgICBwcml2YXRlIHVwZGF0ZVBhcmFtc0ZsYWcgPSBmYWxzZTtcclxuICAgIC8vIOagh+iusOaLluaLveaXtuS4iuasoeeahOWkp+Wwj1xyXG4gICAgcHJpdmF0ZSByZXNpemVEaXN0YW5jZSA9IC0xO1xyXG4gICAgLyoqXHJcbiAgICAgKiAg5ouW5ou955qE5Y+Y5YyW5Lit5LqL5Lu2XHJcbiAgICAgKiAg5aaC5p6c6LaF6L+H6ZiI5YC877yM5LiN5aSE55CGXHJcbiAgICAgKiAg5pqC5pyq5aSE55CG5ouW5ou95pyA5aSn44CB5pyA5bCP5YC855qE6Zeu6aKYXHJcbiAgICAgKi9cclxuICAgIEBIb3N0TGlzdGVuZXIoXCJyelJlc2l6aW5nXCIsIFtcIiRldmVudFwiXSlcclxuICAgIG9uUlpSZXNpemluZyhwb3MpIHtcclxuICAgICAgICBpZiAodGhpcy5lbmFibGVDb2xsYXBzZSAmJiBwb3MgJiYgcG9zW1wic2l6ZVwiXSkge1xyXG4gICAgICAgICAgICBsZXQgY2hhbmdlUHJvcCA9IHRoaXMuZ2V0U3R5bGVQcm9wKCk7XHJcbiAgICAgICAgICAgIGxldCByZXNpemVEaXJlY3Rpb24gPSBcIlwiO1xyXG4gICAgICAgICAgICBpZiAodGhpcy5yZXNpemVEaXN0YW5jZSA+PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAvLyDlvIDlp4vorrDlvZXlkI5cclxuICAgICAgICAgICAgICAgIC8vIOatpOasoeWAvOavlOS4iuasoeiusOW9leWkp++8jOivtOaYjuWcqGV4cGFuZFxyXG4gICAgICAgICAgICAgICAgcmVzaXplRGlyZWN0aW9uID1cclxuICAgICAgICAgICAgICAgICAgICBwb3NbXCJzaXplXCJdW2NoYW5nZVByb3BdID4gdGhpcy5yZXNpemVEaXN0YW5jZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICA/IFwiZXhwYW5kXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgOiBcImNvbGxhcHNlXCI7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5yZXNpemVEaXN0YW5jZSA9IHBvc1tcInNpemVcIl1bY2hhbmdlUHJvcF07XHJcbiAgICAgICAgICAgIGlmIChyZXNpemVEaXJlY3Rpb24gPT0gXCJleHBhbmRcIiAmJiB0aGlzLmluaXRDb2xsYXBzZSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5pbml0Q29sbGFwc2UgPSBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoXHJcbiAgICAgICAgICAgICAgICBwb3NbXCJzaXplXCJdW2NoYW5nZVByb3BdID4gdGhpcy5yZXNpemVDb2xsYXBzZVRocmVzaG9sZCB8fFxyXG4gICAgICAgICAgICAgICAgIXJlc2l6ZURpcmVjdGlvblxyXG4gICAgICAgICAgICApIHtcclxuICAgICAgICAgICAgICAgIC8vIOaLluaLvemAn+W6puW/q+eahOaXtuWAme+8jOS8mua8j+aOieiuoeeul+eahOaXtuaculxyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAodGhpcy5yZXNpemVDb2xsYXBzZVRocmVzaG9sZCA+IDApIHtcclxuICAgICAgICAgICAgICAgIC8vIOiuvue9ruS6huiHquWKqOWPjuaKmOmYiOWAvFxyXG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLmluaXRDb2xsYXBzZSAmJiByZXNpemVEaXJlY3Rpb24gPT0gXCJjb2xsYXBzZVwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8g5aSE55CG5ouW5ou95Y+O5oqY6L+H56iL5Lit77yM6Ieq5Yqo5pS26LW377yb5LiN5aSE55CG5bGV5byA6L+H56iL5Lit55qE77yM6Ieq5Yqo5bGV5byAXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwb3NbXCJhY3Rpb25zXCJdICYmXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvc1tcImFjdGlvbnNcIl0uaGFzT3duUHJvcGVydHkoXCJzdG9wUmVzaXplXCIpXHJcbiAgICAgICAgICAgICAgICAgICAgKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvc1tcImFjdGlvbnNcIl1bXCJzdG9wUmVzaXplXCJdKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMudG9nZ2xlQ29sbGFwc2VTdGF0ZShudWxsKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIC8vIOacquiuvue9ruiHquWKqOWPjuaKmOmYiOWAvO+8jOmcgOimgeWNleeLrOWkhOeQhiDljbPlsIbmlLbotbfml7bnirbmgIHjgIHljbPlsIblsZXlvIDml7bnirbmgIFcclxuICAgICAgICAgICAgICAgIGlmIChyZXNpemVEaXJlY3Rpb24gPT0gXCJjb2xsYXBzZVwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHBvc1tcInNpemVcIl1bY2hhbmdlUHJvcF0gPCAzICYmICF0aGlzLmluaXRDb2xsYXBzZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmluaXRDb2xsYXBzZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgLy8g5ouW5ou955qE5byA5aeL55qE5LqL5Lu2XHJcbiAgICBASG9zdExpc3RlbmVyKFwicnpTdGFydFwiLCBbXCIkZXZlbnRcIl0pXHJcbiAgICBvblJaU3RhcnQocG9zKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuZW5hYmxlQ29sbGFwc2UpIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuZWwuY2xhc3NOYW1lLmluZGV4T2YodGhpcy5hbmltYXRlQ2xzKSA+LTEpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyZXIucmVtb3ZlQ2xhc3ModGhpcy5lbCwgdGhpcy5hbmltYXRlQ2xzKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICAvLyDlpoLmnpzmnIlpZnJhbWXpga7nvanlubbkuJTmsqHmnInmmL7npLpcclxuICAgICAgICBpZiAodGhpcy5fcmVsYXRlZElmcmFtZU92ZXJsYXkgJiYgIXRoaXMuX2lmcmFtZU92ZXJsYXlTaG93bkZsYWcpIHtcclxuICAgICAgICAgICAgaWYgKFxyXG4gICAgICAgICAgICAgICAgW1wicmVsYXRpdmVcIiwgXCJhYnNvbHV0ZVwiXS5pbmRleE9mKFxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3JlbGF0ZWRDb250YWluZXJQb3NpdGlvblxyXG4gICAgICAgICAgICAgICAgKSA8IDBcclxuICAgICAgICAgICAgKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnJlbmRlcmVyLnNldFN0eWxlKFxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3JlbGF0ZWRDb250YWluZXIsXHJcbiAgICAgICAgICAgICAgICAgICAgXCJwb3NpdGlvblwiLFxyXG4gICAgICAgICAgICAgICAgICAgIFwicmVsYXRpdmVcIlxyXG4gICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLnJlbmRlcmVyLnNldFN0eWxlKFxyXG4gICAgICAgICAgICAgICAgdGhpcy5fcmVsYXRlZElmcmFtZU92ZXJsYXksXHJcbiAgICAgICAgICAgICAgICBcImRpc3BsYXlcIixcclxuICAgICAgICAgICAgICAgIFwiYmxvY2tcIlxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgICAgICB0aGlzLl9pZnJhbWVPdmVybGF5U2hvd25GbGFnID0gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKFxyXG4gICAgICAgICAgICAhdGhpcy51cGRhdGVQYXJhbXNGbGFnICYmXHJcbiAgICAgICAgICAgIHBvc1tcImFjdGlvbnNcIl0gJiZcclxuICAgICAgICAgICAgcG9zW1wiYWN0aW9uc1wiXS5oYXNPd25Qcm9wZXJ0eShcInVwZGF0ZVBhcmFtc1wiKVxyXG4gICAgICAgICkge1xyXG4gICAgICAgICAgICBwb3NbXCJhY3Rpb25zXCJdW1widXBkYXRlUGFyYW1zXCJdKHsgZml4ZWRFZGdlOiB0cnVlIH0pO1xyXG4gICAgICAgICAgICB0aGlzLnVwZGF0ZVBhcmFtc0ZsYWcgPSB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIC8vIOaLluaLveeahOWBnOatouS6i+S7tlxyXG4gICAgQEhvc3RMaXN0ZW5lcihcInJ6U3RvcFwiLCBbXCIkZXZlbnRcIl0pXHJcbiAgICBvblJaU3RvcChwb3MpIHtcclxuICAgICAgICB0aGlzLnJlc2l6ZURpc3RhbmNlID0gLTE7XHJcbiAgICAgICAgLy8g5aaC5p6c5pyJaWZyYW1l6YGu572p5bm25LiU5pi+56S65LqGXHJcbiAgICAgICAgaWYgKHRoaXMuX3JlbGF0ZWRJZnJhbWVPdmVybGF5ICYmIHRoaXMuX2lmcmFtZU92ZXJsYXlTaG93bkZsYWcpIHtcclxuICAgICAgICAgICAgaWYgKFxyXG4gICAgICAgICAgICAgICAgW1wicmVsYXRpdmVcIiwgXCJhYnNvbHV0ZVwiXS5pbmRleE9mKFxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3JlbGF0ZWRDb250YWluZXJQb3NpdGlvblxyXG4gICAgICAgICAgICAgICAgKSA8IDBcclxuICAgICAgICAgICAgKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnJlbmRlcmVyLnNldFN0eWxlKFxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3JlbGF0ZWRDb250YWluZXIsXHJcbiAgICAgICAgICAgICAgICAgICAgXCJwb3NpdGlvblwiLFxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3JlbGF0ZWRDb250YWluZXJQb3NpdGlvblxyXG4gICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLnJlbmRlcmVyLnNldFN0eWxlKFxyXG4gICAgICAgICAgICAgICAgdGhpcy5fcmVsYXRlZElmcmFtZU92ZXJsYXksXHJcbiAgICAgICAgICAgICAgICBcImRpc3BsYXlcIixcclxuICAgICAgICAgICAgICAgIFwibm9uZVwiXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIHRoaXMuX2lmcmFtZU92ZXJsYXlTaG93bkZsYWcgPSBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBjb25zdHJ1Y3Rvcihwcml2YXRlIGVsZW1lbnRSZWY6IEVsZW1lbnRSZWYsIHByaXZhdGUgcmVuZGVyZXI6IFJlbmRlcmVyMikge1xyXG4gICAgICAgIC8vIOWFvOWuueaXp+ihqOWNleWGmeazlVxyXG4gICAgICAgIGlmKHRoaXMuZWxlbWVudFJlZil7XHJcbiAgICAgICAgICAgIHRoaXMuZWwgPSB0aGlzLmVsZW1lbnRSZWYubmF0aXZlRWxlbWVudDsgXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIG5nT25Jbml0KCkge1xyXG4gICAgICBpZih0aGlzLmVsZW1lbnRSZWYpe1xyXG4gICAgICAgIHRoaXMuY29tcGF0aWJsZUVsKCk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIG5nQWZ0ZXJWaWV3SW5pdCgpIHtcclxuICAgICAgICBpZighdGhpcy5lbCl7XHJcbiAgICAgICAgICAgIHRoaXMuY29tcGF0aWJsZUVsKCk7XHJcbiAgICAgICAgfSAgICAgXHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIOWFvOWuueaXp+ihqOWNleWGmeazlVxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIGNvbXBhdGlibGVFbCgpe1xyXG4gICAgICAgIHRoaXMuZWwgPSB0aGlzLmVsZW1lbnRSZWYubmF0aXZlRWxlbWVudDtcclxuICAgICAgICAvLyDorr7nva7kuoZpZnJhbWXlrrnlmajvvIzkvYbmmK/msqHmnInliJvlu7rpga7nvalcclxuICAgICAgICBpZiAodGhpcy5fcmVsYXRlZElmcmFtZVBhcmVudCAmJiAhdGhpcy5fcmVsYXRlZElmcmFtZU92ZXJsYXkpIHtcclxuICAgICAgICAgICAgdGhpcy5nZXRSZWxhdGVkSWZyYW1lUGFyZW50KHRoaXMuX3JlbGF0ZWRJZnJhbWVQYXJlbnQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmVuYWJsZUNvbGxhcHNlICYmXHJcbiAgICAgICAgICAgIHRoaXMucmVuZGVyZXIuYWRkQ2xhc3MoXHJcbiAgICAgICAgICAgICAgICB0aGlzLmVsLFxyXG4gICAgICAgICAgICAgICAgXCJzcGxpdHRlci1wYW5lLWNvbGxhcHNlLW9uLVwiICsgdGhpcy5jb2xsYXBzZVBvc2l0aW9uXHJcbiAgICAgICAgICAgICk7XHJcbiAgICB9XHJcblxyXG4gICAgbmdPbkRlc3Ryb3koKSB7fVxyXG5cclxuICAgIC8q5a696auY57G75Z6L5pivIHN0cmluZ+aIluiAhW51bWJlciDop6PmnpDlrr3pq5ggIOWwuuWvuCAqL1xyXG4gICAgcmVzb2x2ZVNpemUoc2l6ZSkge1xyXG4gICAgICAgIGNvbnN0IHJlZ2V4ID0gL3B4fCV8cmVtfGVtLztcclxuICAgICAgICAvLyDor7TmmI7mmK/lrZfnrKbkuLJcclxuICAgICAgICByZXR1cm4gcmVnZXgudGVzdChzaXplKVxyXG4gICAgICAgICAgICA/IGAke3BhcnNlSW50KHNpemUsIDEwKX0ke3NpemUubWF0Y2gocmVnZXgpWzBdfWBcclxuICAgICAgICAgICAgOiBgJHtzaXplfXB4YDtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICog6KeE6IyD6I635Y+WaWZyYW1l5omA5Zyo55qE54i25a655ZmoXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgZ2V0UmVsYXRlZElmcmFtZVBhcmVudChjb250ZW50KSB7XHJcbiAgICAgICAgaWYgKCFjb250ZW50fHwhdGhpcy5lbCkge1xyXG4gICAgICAgICAgICB0aGlzLl9yZWxhdGVkQ29udGFpbmVyID0gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGNvbnRlbnQgaW5zdGFuY2VvZiBFbGVtZW50UmVmKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3JlbGF0ZWRDb250YWluZXIgPSBjb250ZW50Lm5hdGl2ZUVsZW1lbnQ7XHJcbiAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgY29udGVudCA9PSBcInN0cmluZ1wiKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3JlbGF0ZWRDb250YWluZXIgPSB0aGlzLmVsLnBhcmVudEVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgICAgICAgICAgIGNvbnRlbnRcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLl9yZWxhdGVkQ29udGFpbmVyID0gY29udGVudDtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMuX3JlbGF0ZWRDb250YWluZXIpIHtcclxuICAgICAgICAgICAgdGhpcy5fcmVsYXRlZENvbnRhaW5lclBvc2l0aW9uID0gdGhpcy5fcmVsYXRlZENvbnRhaW5lcltcInN0eWxlXCJdW1xyXG4gICAgICAgICAgICAgICAgXCJwb3NpdGlvblwiXHJcbiAgICAgICAgICAgIF07XHJcbiAgICAgICAgICAgIC8vIOaehOmAoOmBrue9qeWxglxyXG4gICAgICAgICAgICB0aGlzLl9yZWxhdGVkSWZyYW1lT3ZlcmxheSA9IHRoaXMucmVuZGVyZXIuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcclxuICAgICAgICAgICAgdGhpcy5fcmVsYXRlZElmcmFtZU92ZXJsYXkuY2xhc3NOYW1lID0gXCJmLXV0aWxzLWFic29sdXRlLWFsbFwiO1xyXG4gICAgICAgICAgICB0aGlzLnJlbmRlcmVyLnNldFN0eWxlKFxyXG4gICAgICAgICAgICAgICAgdGhpcy5fcmVsYXRlZElmcmFtZU92ZXJsYXksXHJcbiAgICAgICAgICAgICAgICBcImRpc3BsYXlcIixcclxuICAgICAgICAgICAgICAgIFwibm9uZVwiXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIHRoaXMucmVuZGVyZXIuYXBwZW5kQ2hpbGQoXHJcbiAgICAgICAgICAgICAgICB0aGlzLl9yZWxhdGVkQ29udGFpbmVyLFxyXG4gICAgICAgICAgICAgICAgdGhpcy5fcmVsYXRlZElmcmFtZU92ZXJsYXlcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIOeCueWHu+WPjuaKmFxyXG4gICAgICovXHJcbiAgICB0b2dnbGVDb2xsYXBzZVN0YXRlKGV2OiBNb3VzZUV2ZW50KSB7XHJcbiAgICAgICAgLy/npoHmraLlhpLms6FcclxuICAgICAgICBldiAmJiBldi5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICBpZiAoIXRoaXMuZWwpIHJldHVybjtcclxuICAgICAgICBpZiAodGhpcy5pbml0Q29sbGFwc2UpIHtcclxuICAgICAgICAgICAgLy8g5b6F5bGV5byAXHJcbiAgICAgICAgICAgIHRoaXMucmVuZGVyZXIuYWRkQ2xhc3ModGhpcy5lbCwgdGhpcy5hbmltYXRlQ2xzKTtcclxuICAgICAgICAgICAgdGhpcy5jaGFuZ2VDb2xsYXBzZShcImV4cGFuZFwiKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAvLyDlvoXmlLbotbdcclxuICAgICAgICAgICAgdGhpcy5yZW5kZXJlci5hZGRDbGFzcyh0aGlzLmVsLCB0aGlzLmFuaW1hdGVDbHMpO1xyXG4gICAgICAgICAgICB0aGlzLmNoYW5nZUNvbGxhcHNlKFwiY29sbGFwc2VcIik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuaW5pdENvbGxhcHNlID0gIXRoaXMuaW5pdENvbGxhcHNlO1xyXG4gICAgICAgIHRoaXMuY29sbGFwc2VTdGF0ZUNoYW5nZS5lbWl0KHRoaXMuaW5pdENvbGxhcHNlKTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICog5YiH5o2i5Yid5aeL5pS26LW354q25oCBXHJcbiAgICAgKi9cclxuICAgIHRvZ2dsZUluaXRDb2xsYXBzZVN0YXRlKCkge1xyXG4gICAgICAgIGlmICghdGhpcy5lbCkgcmV0dXJuO1xyXG4gICAgICAgIGlmICh0aGlzLmluaXRDb2xsYXBzZSkge1xyXG4gICAgICAgICAgICAvLyDmlLbotbdcclxuICAgICAgICAgICAgdGhpcy5jaGFuZ2VDb2xsYXBzZShcImNvbGxhcHNlXCIpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIC8vIOWxleW8gFxyXG4gICAgICAgICAgICB0aGlzLmNoYW5nZUNvbGxhcHNlKFwiZXhwYW5kXCIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmNvbGxhcHNlU3RhdGVDaGFuZ2UuZW1pdCh0aGlzLmluaXRDb2xsYXBzZSk7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIGV4cGFuZCDkuLrlsZXlvIDvvIxjb2xsYXBzZSDkuLrmlLbotbdcclxuICAgICAqIEBwYXJhbSBjb2xsYXBzZU9yRXhwYW5kXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgY2hhbmdlQ29sbGFwc2UoY29sbGFwc2VPckV4cGFuZDogc3RyaW5nKSB7XHJcbiAgICAgICAgbGV0IGNoYW5nZVByb3AgPSB0aGlzLmdldFN0eWxlUHJvcCgpO1xyXG4gICAgICAgIHN3aXRjaCAoY29sbGFwc2VPckV4cGFuZCkge1xyXG4gICAgICAgICAgICBjYXNlIFwiZXhwYW5kXCI6XHJcbiAgICAgICAgICAgICAgICAvLyDlsZXlvIBcclxuICAgICAgICAgICAgICAgIC8vIOWmguaenOWtmOWcqOaJi+WGmXdpZHRo6LWL5YC857uZcGFuZeS8muaciemXrumimFxyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX2V4cGFuZERpc3RhbmNlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy/orr7nva7kuoblsZXlvIDot53nprtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnJlYWxFeHBhbmREaXNhdGFuY2UgPSB0aGlzLl9leHBhbmREaXN0YW5jZTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy/msqHmnInorr7nva7vvIzmjInnhafkuYvliY3nmoTorrDlvZXvvIzlpoLmnpzlrZjlnKjlsLHmjInnhaforrDlvZXnmoTlgLzvvIzlpoLmnpzmsqHmnInlsLHmjInnhafpu5jorqTnmoTlgLxcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnJlYWxFeHBhbmREaXNhdGFuY2UgPSB0aGlzLl9iZWZvcmVDb2xsYXBzZURpc3RhbmNlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgID8gdGhpcy5fYmVmb3JlQ29sbGFwc2VEaXN0YW5jZSArIFwicHhcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA6IHRoaXMuZGVmYXVsdEV4cGFuZERpc3RhbmNlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdGhpcy5yZW5kZXJlci5zZXRTdHlsZShcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmVsLFxyXG4gICAgICAgICAgICAgICAgICAgIGNoYW5nZVByb3AsXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZWFsRXhwYW5kRGlzYXRhbmNlXHJcbiAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICAvLyDmlLbotbdcclxuICAgICAgICAgICAgICAgIHRoaXMuX2JlZm9yZUNvbGxhcHNlRGlzdGFuY2UgPVxyXG4gICAgICAgICAgICAgICAgICAgIGNoYW5nZVByb3AgPT0gXCJoZWlnaHRcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA/IHRoaXMuZWwub2Zmc2V0SGVpZ2h0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDogdGhpcy5lbC5vZmZzZXRXaWR0aDtcclxuICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyZXIuc2V0U3R5bGUodGhpcy5lbCwgY2hhbmdlUHJvcCwgXCIwcHhcIik7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiDluIPlsYDmjpLliJfkuI3kuIDmoLfvvIzlvbHlk43liLDmmK/orr7nva7lrr3luqbov5jmmK/pq5jluqZcclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBnZXRTdHlsZVByb3AoKSB7XHJcbiAgICAgICAgbGV0IGhvcmkgPSBbXCJsZWZ0XCIsIFwicmlnaHRcIl0uZmluZEluZGV4KFxyXG4gICAgICAgICAgICBpdGVtID0+IGl0ZW0gPT0gdGhpcy5jb2xsYXBzZVBvc2l0aW9uXHJcbiAgICAgICAgKTtcclxuICAgICAgICByZXR1cm4gaG9yaSA+IC0xID8gXCJ3aWR0aFwiIDogXCJoZWlnaHRcIjtcclxuICAgIH1cclxufVxyXG4iXX0=