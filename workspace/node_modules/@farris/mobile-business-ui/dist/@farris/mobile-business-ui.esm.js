import{defineComponent as t,pushScopeId as e,popScopeId as n,resolveComponent as a,openBlock as i,createBlock as o,withDirectives as l,createVNode as r,vShow as s,createCommentVNode as c,Fragment as d,renderList as m,withModifiers as u,withScopeId as p,withCtx as h,createTextVNode as f,toDisplayString as v,reactive as g,computed as w,nextTick as b,onMounted as y,isVNode as x,createApp as A,getCurrentInstance as F,ref as k,onBeforeMount as C,watch as I,onUnmounted as M,renderSlot as S,toRefs as P}from"vue";import B,{ImagePreview as L,Uploader as U,Empty as N,Image as D,Popup as O,Grid as T,GridItem as R,Row as E,Col as V,NavBar as z,Icon as W,Field as j}from"vant";import{filterData as H,filterMapData as _}from"@farris/mobile-vue-adapter";import q,{Popup as G,Navbar as K,LookupInput as X,Picker as Z,Button as J}from"@farris/mobile-ui";var Y,Q=function(){var t=(new Date).getTime(),e="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var n=(t+16*Math.random())%16|0;return t=Math.floor(t/16),("x"===e?n:3&n|8).toString(16)}));return e},$=t({name:"fm-attachment",components:(Y={"van-uploader":U,"van-empty":N,"van-image":D,"van-popup":O,"van-grid":T,"van-grid-item":R,"van-row":E,"van-col":V},Y[L.Component.name]=L.Component,Y),inject:{attachmentService:{default:null},uploadAttachmentService:{default:null}},props:{fileList:{type:Array,default:function(){return[]}},multiple:{type:Boolean,default:!0},accept:{type:String,default:"application/msexcel,application/msword,application/vnd.ms-powerpoint,application/pdf,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,application/vnd.openxmlformats-officedocument.wordprocessingml.document,text/plain"},disabled:{type:Boolean,default:!1},beforeReadFile:{type:Function},uploadFile:{type:Function},previewFile:{type:Function},allowDefaultEntrance:{type:Boolean,default:!0},beforeTakePhoto:{type:Function},uploadInfo:{type:Object,default:null},parentDirName:{type:String,default:""},rootId:{type:String,default:""},pattern:{type:String,default:"ccWork"},ccWork:{type:Object,default:function(){return{photo:{quality:"high",mode:"camera",mark:"",isPhoto:!0},selectFile:{mType:"0",maxNum:6},video:{id:"af700826-7552-4858-a5e0-e64f5e20288b",quality:.8,time:15,isVideo:!0},album:{isAlbum:!0,mType:"0",maxNum:9}}}},cloudPlus:{type:Object,default:function(){return{photo:{quality:60,encodingType:1,targetWidth:602,targetHeight:600,isPhoto:!0},selectFile:{maximum:3,fileType:".jpg|.png|.doc|.docx|.xls|.xlsx|.ppt|.pptx|.pdf|.txt",isFile:!0},album:{isAlbum:!0,quality:60,encodingType:1,targetWidth:600,targetHeight:600}}}},externalVideoUrl:{type:String,default:""}},data:function(){return{fromProp:!1,rawFiles:[],showAction:!1,saveAction:!1,selectedFile:null,selectedFilePath:"",description:"",notUploadedFileList:[],previewPages:[],pdfUrl:"",show:!1,showPdf:!1,showDoc:!1,videoUrl:"",selectedAttachmentId:"",subscription:"",imgHeight:0,imhWidth:0,hasFiles:!1,docStyle:{}}},computed:{uploadFiles:function(){var t,e=this,n=this;return this.rawFiles=(t=[]).concat.apply(t,this.fileList.map((function(t){return t}))),this.rawFiles&&this.rawFiles.length?(this.selectedFile&&this.rawFiles.find((function(t){return t.id===e.selectedFile.id}))||(this.selectedFile=this.rawFiles[0],this.$nextTick((function(){n.goTouchStart(e.selectedFile)}))),this.selectedAttachmentId&&(this.selectedFile=this.rawFiles.find((function(t){return t.attachmentId===e.selectedAttachmentId})),this.selectedFile&&this.$nextTick((function(){n.goTouchStart(e.selectedFile),e.$loading.hide()}))),this.selectedFile||(this.selectedFile=this.rawFiles[this.rawFiles.length-1]),this.hasFiles||this.$nextTick((function(){e.calculateImgSize(80),e.hasFiles=!0})),this.rawFiles):(this.hasFiles&&this.$nextTick((function(){e.calculateImgSize(),e.hasFiles=!1})),this.selectedFile=null,[])},previewEnable:function(){return this.showAction&&this.rawFiles&&!!this.rawFiles.length},gridNumber:function(){return"ccWork"===this.pattern?Number(this.ccWork.photo.isPhoto)+Number(this.ccWork.video.isVideo)+Number(this.ccWork.album.isAlbum):"cloudPlus"===this.pattern?Number(this.cloudPlus.photo.isPhoto)+Number(this.cloudPlus.selectFile.isFile)+Number(this.cloudPlus.album.isAlbum):3}},created:function(){},mounted:function(){var t=this;this.attachmentService&&(this.subscription=this.attachmentService.collectFile.subscribe((function(e){"[object Array]"===Object.prototype.toString.call(e)&&0===e.length||(console.log(e),t.rawFiles=[].concat(t.rawFiles,e),t.afterRead(e))})))},unmounted:function(){this.subscription&&this.subscription.unsubscribe(),this.$loading.hide()},methods:{appendFile:function(){var t=this;"ccWork"===this.pattern?this.attachmentService.selectAttachment(this.ccWork.album):"html"===this.pattern?this.$refs.fileUploadRef.chooseFile():"cloudPlus"===this.pattern&&this.attachmentService.getSysInfo().subscribe((function(e){e&&"Android"===e.platform?t.attachmentService.selectFile(t.cloudPlus.selectFile):e&&"iOS"===e.platform&&t.$refs.fileUploadRef.chooseFile()}))},beforeRead:function(t){return!this.beforeReadFile||this.beforeReadFile(t)},afterRead:function(t){var e=this;if(console.log(t),this.$loading.show("附件上传中"),t&&t.length?this.notUploadedFileList=t.map((function(t){return t.id=Q(),t})):(t.id=Q(),this.notUploadedFileList=[t]),this.notUploadedFileList.length>this.maxNum)this.$notify.warning("最多上传"+this.maxNum+"个附件");else if(this.selectedAttachmentId=this.notUploadedFileList[0].id,this.uploadAttachmentService)"video/mp4"===t.type?(this.videoUrl=t.url.substring(0,t.url.lastIndexOf("/")),this.uploadAttachmentService.upload([t],{parentDirName:this.parentDirName,rootId:this.rootId}).subscribe((function(n){var a={fileName:t.file.name,metadataId:t.id};e.$emit("afterAppendFile",[a])}))):this.uploadAttachmentService.upload(this.notUploadedFileList,{parentDirName:this.parentDirName,rootId:this.rootId}).subscribe((function(t){var n=e.notUploadedFileList.map((function(t){return{fileName:t.file.name,metadataId:t.id}}));e.$emit("afterAppendFile",n)}));else{var n=this.notUploadedFileList.map((function(t){return{fileName:t.file.name,metadataId:t.id}}));this.$emit("afterAppendFile",n)}},deleteFile:function(){this.rawFiles&&this.rawFiles.length&&this.deleteAttachment(this.selectedFile)},goTouchStart:function(t){this.selectedFile=t,(this.selectedFile.name&&this.selectedFile.name.toLowerCase().includes("mp4")||this.selectedFile.name.toLowerCase().includes("webm")||this.selectedFile.name.toLowerCase().includes("ogg"))&&this.externalVideoUrl&&(this.selectedFile.url=this.externalVideoUrl+"?metadataId="+this.selectedFile.attachmentId+"&rootid="+this.rootId+"&token="+this.getToken(this.mergeString(this.selectedFile.attachmentId,this.rootId))),this.selectedAttachmentId=t.attachmentId,this.$emit("beforeSelect",t)},selectFile:function(t){this.selectedFile=t,this.$emit("selectChange",t)},mergeString:function(t,e){var n=t.length<e.length?t.length:e.length,a="",i=0;for(i=0;i<n;i++)a+=t.substring(i,i+1),a+=e.substring(i,i+1);return a+=t.length<e.length?e.substring(i):t.substring(i)},getToken:function(t){var e=[1,2,3];t.length>24&&(t=t.substring(0,24));var n=Math.floor(t.length/3),a=t.substring(0,n),i=t.substring(n,2*n),o=t.substring(2*n,3*n),l=[],r=Math.ceil(3*Math.random());l.push(e[r-1]),e.splice(r-1,1),r=Math.ceil(2*Math.random()),l.push(e[r-1]),e.splice(r-1,1),l.push(e[0]);var s=Math.round((new Date).getTime()/1e3)+"";return s.substring(0,5)+"times"+l[0]+l[1]+l[2]+this.switchStr(a,i,o,l[0])+this.switchStr(a,i,o,l[1])+this.switchStr(a,i,o,l[2])+"times"+s.substring(5)},switchStr:function(t,e,n,a){switch(a){case 1:return t;case 2:return e;case 3:return n}},genPreview:function(){if(this.selectedFile&&this.selectedFile.name){var t=document.getElementsByName("viewport")[0],e=document.createElement("meta");e.name="viewport",e.content="width=device-width, initial-scale=1.0";var n=document.getElementsByTagName("head")[0];t&&n.removeChild(t),n.appendChild(e),this.uploadAttachmentService&&(this.selectedFile.name.search(/\.(png|jpe?g|gif|svg)(\?.*)?$/)>=0||this.selectedFile.name.includes("pdf")?(this.show=!0,this.showPdf=!0,this.showDoc=!1,this.pdfUrl="/platform/runtime/dfs/viewpage/index.html?metadataId="+this.selectedFile.attachmentId+"&rootId="+this.rootId+"&fileType=2"):this.selectedFile.name.includes("mp4")||(this.show=!0,this.showPdf=!0,this.showDoc=!1,this.pdfUrl="/platform/runtime/dfs/viewpage/index.html?metadataId="+this.selectedFile.attachmentId+"&rootId="+this.rootId+"&fileType=2")),this.$emit("preview",this.selectedFile)}},getAttachmentPath:function(t){return this.uploadAttachmentService.getAttachmentPath(t,this.rootId)},getAttachmentPathByType:function(t){return t.name.search(/\.(png|jpe?g|gif|svg)(\?.*)?$/)>=0?this.getAttachmentPath(t.attachmentId):t.content||t.url},getFitToWidth:function(t,e){var n=this.ptToPx(t),a=this.ptToPx(e),i=n||window.innerWidth;return a>n&&Math.round(i/window.innerWidth)<=1?200-Math.round(100*i/window.innerWidth):Math.round(100*window.innerWidth/i)},ptToPx:function(t){return 96*t/72},isMobile:function(t){return t<=425},isTablet:function(t){return t<=1024},isDesktop:function(t){return!this.isMobile(t)&&!this.isTablet(t)},deleteAttachment:function(t){this.selectedFile=null,this.$emit("remove",[t.attachmentId])},takePhoto:function(){"ccWork"===this.pattern?this.attachmentService.takePhoto(this.ccWork.photo):"cloudPlus"!==this.pattern&&"html"!==this.pattern||this.attachmentService.takePhoto(this.cloudPlus.photo)},selectFromAlbum:function(){"ccWork"===this.pattern?this.attachmentService.selectAttachment(this.ccWork.album):"cloudPlus"!==this.pattern&&"html"!==this.pattern||this.attachmentService.selectAttachment(this.cloudPlus.album)},takeShortVideo:function(){"ccWork"===this.pattern&&this.attachmentService.takeShortVideo(this.ccWork.video)},getVideoFile:function(t){return{fileName:t.name,metadataId:t.url}},calculateImgSize:function(t){void 0===t&&(t=0);var e=this.$refs.attach.getBoundingClientRect(),n=this.$refs.navigation.getBoundingClientRect(),a=e.height-n.height-t;if(this.$refs.imgContainer){var i=this.$refs.imgContainer.getBoundingClientRect().height;i>a&&(this.imgHeight=i)}else this.imgHeight=a},closed:function(){var t=document.getElementsByName("viewport")[0],e=document.createElement("meta");e.name="viewport",e.content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no";var n=document.getElementsByTagName("head")[0];t&&n.removeChild(t),n.appendChild(e),this.show=!1}}}),tt=p("data-v-443ecfba");e("data-v-443ecfba");var et={class:"farris-attachment attachment",ref:"attach"},nt={class:"farris-attachment-img"},at={key:1,class:"img-container",ref:"imgContainer"},it={key:2},ot={class:"attachment-navigation",ref:"navigation"},lt=r("span",{class:"fm-icon fm-icon-close"},null,-1);n();var rt=tt((function(t,e,n,p,h,f){var v=a("van-uploader"),g=a("van-empty"),w=a("van-image"),b=a("van-icon"),y=a("fm-navbar"),x=a("van-popup"),A=a("van-grid-item"),F=a("van-grid"),k=a("van-col"),C=a("van-row");return i(),o("div",et,[l(r(v,{multiple:t.multiple,ref:"fileUploadRef","max-count":t.maxNum,modelValue:t.rawFiles,"onUpdate:modelValue":e[1]||(e[1]=function(e){return t.rawFiles=e}),disabled:t.disabled,"preview-full-image":t.previewEnable,accept:t.accept,"before-read":t.beforeRead,"after-read":t.afterRead},null,8,["multiple","max-count","modelValue","disabled","preview-full-image","accept","before-read","after-read"]),[[s,!1]]),r("div",nt,[t.selectedFile&&(t.selectedFile.url||t.selectedFile.file)?c("v-if",!0):(i(),o(g,{key:0,description:"附件为空"})),t.selectedFile&&t.selectedFile.url?(i(),o("div",at,[t.selectedFile.name.toLowerCase().search(/\.(png|jpe?g|gif|svg|ppt|pptx|xls|xlsx|doc|docx|txt|pdf)(\?.*)?$/)>=0?(i(),o(w,{key:0,height:t.imgHeight,fit:"scale-down",src:t.getAttachmentPathByType(t.selectedFile),onClick:t.genPreview},null,8,["height","src","onClick"])):c("v-if",!0),t.selectedFile&&t.selectedFile.name&&t.selectedFile.name.toLowerCase().includes("mov")?(i(),o("video",{key:1,controls:"controls",height:t.imgHeight,controlslist:"nodownload"},[r("source",{src:t.selectedFile.url,type:"video/mp4"},null,8,["src"])],8,["height"])):c("v-if",!0),t.selectedFile&&t.selectedFile.name&&t.selectedFile.name.toLowerCase().includes("mp4")||t.selectedFile.name.toLowerCase().includes("webm")||t.selectedFile.name.toLowerCase().includes("ogg")?(i(),o("video",{key:2,src:t.selectedFile.url,controls:"controls",height:t.imgHeight,controlslist:"nodownload"}," 您的浏览器不支持 video 标签。 ",8,["src","height"])):c("v-if",!0),r(x,{show:t.show,"onUpdate:show":e[2]||(e[2]=function(e){return t.show=e}),closeable:"",onClosed:t.closed,style:{height:"100%",width:"100%"}},{default:tt((function(){return[r(y,{title:t.selectedFile&&t.selectedFile.name,onClickLeft:t.closed},{left:tt((function(){return[r(b,{name:"arrow-left",size:"18",color:"#333"})]})),_:1},8,["title","onClickLeft"]),t.showPdf?(i(),o("iframe",{key:0,class:"pdf-iframe",scrolling:"yes",src:t.pdfUrl,width:"100%",height:"100%"},"\r\n          ",8,["src"])):c("v-if",!0),t.showDoc?(i(),o("div",{key:1,class:"panzoom",style:t.docStyle},[(i(!0),o(d,null,m(t.previewPages,(function(t,e){return i(),o("div",{class:"page",style:{width:"unset",height:"unset"},key:e},[t.data?(i(),o("div",{key:0,innerHTML:t.data},null,8,["innerHTML"])):c("v-if",!0)])})),128))],4)):c("v-if",!0)]})),_:1},8,["show","onClosed"])],512)):c("v-if",!0),t.selectedFile&&t.selectedFile.file?(i(),o("div",it)):c("v-if",!0),c(" </van-col> ")]),r("div",ot,[r(F,{clickable:"","column-num":t.gridNumber},{default:tt((function(){return[c(" 拍照  只有云+ 云上协同支持"),"ccWork"===t.pattern&&t.ccWork.photo&&t.ccWork.photo.isPhoto||"cloudPlus"===t.pattern&&t.cloudPlus.photo&&t.cloudPlus.photo.isPhoto||"html"===t.pattern?(i(),o(A,{key:0,text:"拍摄",icon:"photograph",onClick:t.takePhoto},null,8,["onClick"])):c("v-if",!0),c(" 相册 均支持 "),"ccWork"===t.pattern&&t.ccWork.album&&t.ccWork.album.isAlbum||"cloudPlus"===t.pattern&&t.cloudPlus.album&&t.cloudPlus.album.isAlbum||"html"===t.pattern?(i(),o(A,{key:1,text:"相册",icon:"photo",onClick:t.selectFromAlbum},null,8,["onClick"])):c("v-if",!0),c(" 目前只有云上协同支持 "),"ccWork"===t.pattern&&t.ccWork.video&&t.ccWork.video.isVideo?(i(),o(A,{key:2,text:"短视频",icon:"video",onClick:t.takeShortVideo},null,8,["onClick"])):c("v-if",!0),c(" 选择文件 目前只有原生模式和云+支持 "),"cloudPlus"===t.pattern&&t.cloudPlus.selectFile.isFile||"html"===t.pattern?(i(),o(A,{key:3,text:"文件",icon:"card",onClick:t.appendFile},null,8,["onClick"])):c("v-if",!0)]})),_:1},8,["column-num"]),r(C,{type:"flex",justify:"center"},{default:tt((function(){return[r(k,{class:"attachment-navigation-1 last-navigation",span:"24"},{default:tt((function(){return[(i(!0),o(d,null,m(t.uploadFiles,(function(e,n){return i(),o("div",{class:{"attachment-navigation-item":!0,"selected-file":!!t.selectedFile&&(e.id===t.selectedFile.id&&t.selectedAttachmentId===t.selectedFile.attachmentId)},key:n,onTouchstart:function(n){return t.goTouchStart(e)},onClick:u((function(n){return t.selectFile(e)}),["stop"])},[e&&e.name&&!e.name.includes("mp4")||!e.name?(i(),o(w,{key:0,src:t.getAttachmentPathByType(e),class:"item-img",width:"80",height:"80"},null,8,["src"])):c("v-if",!0),e&&e.name&&e.name.toLowerCase().includes("mp4")||e.name.toLowerCase().includes("mov")?(i(),o(w,{key:1,src:"/platform/runtime/dfs/images/file.png",class:"item-img",width:"80",height:"80"})):c("v-if",!0),t.selectedFile&&(e.id===t.selectedFile.id&&t.selectedAttachmentId===t.selectedFile.attachmentId)?(i(),o("div",{key:2,class:"item-icon-delete",onClick:function(n){return t.deleteAttachment(e)}},[lt],8,["onClick"])):c("v-if",!0)],42,["onTouchstart","onClick"])})),128))]})),_:1})]})),_:1})],512)],512)}));function st(t,e){void 0===e&&(e={});var n=e.insertAt;if(t&&"undefined"!=typeof document){var a=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.type="text/css","top"===n&&a.firstChild?a.insertBefore(i,a.firstChild):a.appendChild(i),i.styleSheet?i.styleSheet.cssText=t:i.appendChild(document.createTextNode(t))}}st('.attachment[data-v-443ecfba] {\n  display: flex;\n  flex-direction: column;\n  height: 100%; }\n  .attachment[data-v-443ecfba] .farris-attachment-img {\n    display: flex;\n    flex: 1;\n    justify-content: center;\n    align-items: center; }\n  .attachment[data-v-443ecfba] .img-container {\n    text-align: center;\n    width: 100%;\n    height: 100%; }\n  .attachment[data-v-443ecfba] video {\n    width: 100%; }\n\n.panzoom[data-v-443ecfba] {\n  transform: none;\n  backface-visibility: hidden;\n  transform-origin: 50% 50% 0px;\n  display: flex;\n  justify-content: center;\n  flex-wrap: wrap; }\n\n.page[data-v-443ecfba] {\n  display: inline-block;\n  background-color: #ffffff;\n  margin: 20px;\n  -webkit-box-shadow: 0px 4px 12px -4px rgba(0, 0, 0, 0.38);\n  -moz-box-shadow: 0px 4px 12px -4px rgba(0, 0, 0, 0.38);\n  box-shadow: 0px 4px 12px -4px rgba(0, 0, 0, 0.38);\n  transition: all 0.3s; }\n\n.preview-mask[data-v-443ecfba] {\n  width: 100%;\n  height: 100%; }\n\n.farris-attachment[data-v-443ecfba] {\n  clear: both; }\n  .farris-attachment[data-v-443ecfba] .attachment-detail {\n    background: #fff;\n    height: 100%;\n    width: 100%; }\n  .farris-attachment[data-v-443ecfba] .selected-file {\n    box-shadow: inset 0px 0px 3px 3px #59a1ff;\n    border-radius: 5px; }\n  .farris-attachment[data-v-443ecfba] .attachment-navigation {\n    overflow: inherit;\n    white-space: nowrap; }\n  .farris-attachment[data-v-443ecfba] .attachment-navigation-1 {\n    overflow: auto; }\n  .farris-attachment[data-v-443ecfba] .attachment-navigation .attachment-navigation-item {\n    position: relative;\n    display: inline-block; }\n    .farris-attachment[data-v-443ecfba] .attachment-navigation .attachment-navigation-item .item-img {\n      width: 100%;\n      height: 100%;\n      position: absolute;\n      top: 0;\n      left: 0; }\n    .farris-attachment[data-v-443ecfba] .attachment-navigation .attachment-navigation-item img {\n      border-radius: 5px; }\n    .farris-attachment[data-v-443ecfba] .attachment-navigation .attachment-navigation-item .item-pdf {\n      width: 100%;\n      height: 100%;\n      background-image: url("data:image/png;base64,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");\n      background-size: contain; }\n    .farris-attachment[data-v-443ecfba] .attachment-navigation .attachment-navigation-item .item-icon-delete {\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      position: absolute;\n      right: -6px;\n      top: -6px;\n      width: 16px;\n      height: 16px;\n      background: #888;\n      border-radius: 50%; }\n      .farris-attachment[data-v-443ecfba] .attachment-navigation .attachment-navigation-item .item-icon-delete .fm-icon {\n        color: #fff;\n        font-size: 12px; }\n    .farris-attachment[data-v-443ecfba] .attachment-navigation .attachment-navigation-item .item-icon {\n      position: absolute; }\n  .farris-attachment[data-v-443ecfba] .first-navigation {\n    max-width: 80%; }\n  .farris-attachment[data-v-443ecfba] .first-navigation .attachment-navigation-item {\n    width: 55px;\n    height: 55px; }\n  .farris-attachment[data-v-443ecfba] .last-navigation .attachment-navigation-item {\n    margin: 6px;\n    width: 80px;\n    height: 80px; }\n  .farris-attachment[data-v-443ecfba] .attachment-navigation-icon {\n    text-align: center; }\n    .farris-attachment[data-v-443ecfba] .attachment-navigation-icon .add-icon {\n      margin: 8px 0;\n      width: 55px;\n      height: 55px; }\n  .farris-attachment[data-v-443ecfba] .van-grid-item .van-image img {\n    width: auto;\n    height: 300px; }\n  .farris-attachment[data-v-443ecfba] .fixed-bottom {\n    position: absolute;\n    bottom: 0;\n    width: 100%; }\n  .farris-attachment[data-v-443ecfba] .small-imgs-child {\n    width: 80px;\n    height: 80px;\n    background-size: contain; }\n  .farris-attachment[data-v-443ecfba] .small-imgs-item {\n    position: relative;\n    border-radius: 5px; }\n  .farris-attachment[data-v-443ecfba] .small-imgs-item img {\n    border-radius: 5px; }\n  .farris-attachment[data-v-443ecfba] .action-grid {\n    position: absolute;\n    width: 100%;\n    bottom: 100px; }\n  .farris-attachment[data-v-443ecfba] .preview-img img {\n    width: auto;\n    height: 300px; }\n  .farris-attachment[data-v-443ecfba] .upload-icon {\n    position: absolute;\n    top: 0.5rem;\n    left: 0.5rem; }\n  .farris-attachment[data-v-443ecfba] .upload-progress {\n    position: absolute;\n    bottom: 0;\n    left: 0; }\n  .farris-attachment[data-v-443ecfba] .upload-progress {\n    position: absolute;\n    bottom: 0;\n    left: 0;\n    width: 100%;\n    height: 5%; }\n  .farris-attachment[data-v-443ecfba] .van-image-preview .van-swipe-item .van-image {\n    position: absolute; }\n  .farris-attachment[data-v-443ecfba] .van-image-preview .van-swipe-item .van-image {\n    position: absolute; }\n'),$.render=rt,$.__scopeId="data-v-443ecfba",$.__file="src/components/attachment/src/attachment.vue",$.install=function(t){t.component($.name,$)};var ct,dt=function(){var t=(new Date).getTime(),e="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var n=(t+16*Math.random())%16|0;return t=Math.floor(t/16),("x"===e?n:3&n|8).toString(16)}));return e},mt=t({name:"fm-attachment-file",components:(ct={"van-image":D},ct[L.Component.name]=L.Component,ct),inject:{attachmentService:{default:null},uploadAttachmentService:{default:{}}},props:{rootId:{type:String,default:""},parentDirName:{type:String,default:""},accept:{type:String,default:"application/msexcel,application/msword,application/vnd.ms-powerpoint,application/pdf,text/plain,application/vnd.openxmlformats-officedocument.presentationml.presentation,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,application/vnd.openxmlformats-officedocument.wordprocessingml.document,image/jpg,image/gif,image/jpeg,image/png,image/bmp"},multiple:{type:Boolean,default:!0},fileList:{type:Array,default:function(){return[]}},maxNum:{type:Number,default:9},disabled:{type:Boolean,default:!1},beforeReadFile:{type:Function},uploadFile:{type:Function},previewFile:{type:Function},beforeTakePhoto:{type:Function},removable:{type:Boolean,default:!1},direction:{type:String,default:"vertical"},title:{type:String,default:"附件"},cloudPlus:{type:Object,default:function(){return{photo:{quality:60,encodingType:1,targetWidth:602,targetHeight:600},album:{quality:60,encodingType:1,targetWidth:600,targetHeight:600},selectFile:{maximum:5,fileType:".pdf|.jpg|.png|.doc|.docx|.xls|.xlsx|.ppt|.pptx|.txt|.DOC|.DOCX|.XLS|.XLSX|.PPT|.PPTX"}}}},uploadOptions:{type:function(){},default:function(){return{showPhoto:!0,showAlbum:!0,showVideo:!1,showFile:!0,photoQuality:100,albumQuality:100,fileMaxCount:6,videoId:dt(),videoQuality:.8,videoTime:30}}},disablePhoto:{type:Boolean,default:!1},disableAlbum:{type:Boolean,default:!1},disableFile:{type:Boolean,default:!1},disableVideo:{type:Boolean,default:!1},hidePhoto:{type:Boolean,default:!1},hideAlbum:{type:Boolean,default:!1},hideFile:{type:Boolean,default:!1},maxCount:{type:Number,default:30},maxSize:{type:Number,default:20},displayMaxCount:{type:Boolean,default:!1},allowMaxSize:{type:Boolean,default:!1},allowMaxCount:{type:Boolean,default:!1}},data:function(){return{fromProp:!1,subscription:"",rawFiles:[],showAction:!1,saveAction:!1,selectedFile:null,selectedFilePath:"",description:"",notUploadedFileList:[],previewPages:[],pdfUrl:"",show:!1,showPdf:!1,showDoc:!1,showVideo:!1,isSelectAction:!1,isPreviewAction:!1,docStyle:{},actions:[{name:"从相册选择",disabled:this.albumDisabled},{name:"相机",disabled:this.photoDisabled},{name:"手机文件",disabled:this.fileDisabled}],previewAction:[{name:"在线预览"},{name:"下载"}],navibarDisplay:"",footerDisplay:""}},computed:{uploadFiles:function(){var t,e=this;return this.rawFiles=(t=[]).concat.apply(t,this.fileList.map((function(t){return t}))),this.rawFiles&&this.rawFiles.length?(this.selectedFile&&this.rawFiles.find((function(t){return t.id===e.selectedFile.id}))||(this.selectedFile=this.rawFiles[0]),this.selectedFile&&this.$loading.hide(),this.selectedFile||(this.selectedFile=this.rawFiles[this.rawFiles.length-1]),this.rawFiles):(this.selectedFile=null,[])},isEmpty:function(){return this.rawFiles&&!this.rawFiles.length},previewEnable:function(){return this.showAction&&this.rawFiles&&!!this.rawFiles.length}},mounted:function(){var t=this;setTimeout((function(){window.top.detailBackBtnClickHandler=function(e){var n=window.top.document.querySelector(".fm-page-record-deatial"),a=n.querySelector("#fm-attach-preview-container");if(!n||!a)return!0;try{return t.closeScale(window.top.document),n.removeChild(a),!1}catch(t){return!0}}}),0),this.attachmentService&&(this.subscription=this.attachmentService.collectFile.subscribe((function(e){"[object Array]"===Object.prototype.toString.call(e)&&0===e.length||(t.rawFiles=[].concat(t.rawFiles,e),t.afterRead(e))})))},unmounted:function(){this.subscription&&this.subscription.unsubscribe()},methods:{openScale:function(t){var e=t.getElementsByName("viewport")[0],n=t.createElement("meta");n.name="viewport",n.content="width=device-width, initial-scale=1.0";var a=t.getElementsByTagName("head")[0];e&&a.removeChild(e),a.appendChild(n)},closeScale:function(t){var e=t.getElementsByName("viewport")[0],n=t.createElement("meta");n.name="viewport",n.content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=n";var a=t.getElementsByTagName("head")[0];e&&a.removeChild(e),a.appendChild(n)},transformSize:function(t){return t<Math.pow(1024,2)?(t/1024).toFixed(2)+"KB":t>=Math.pow(1024,2)&&t<Math.pow(1024,3)?(t/Math.pow(1024,2)).toFixed(2)+"MB":t>=Math.pow(1024,3)&&t<Math.pow(1024,4)?(t/Math.pow(1024,3)).toFixed(2)+"GB":void 0},selectAction:function(t){var e=t.name;"在线预览"===e?this.genPreview(this.selectedFile):"下载"===e&&this.downloadAttachment(this.selectedFile)},selectFileFromMobile:function(){var t=this;this.disableFile||(this.attachmentService.getSysInfo().subscribe((function(e){e&&"Android"===e.platform?t.attachmentService.selectFile({maximum:t.uploadOptions&&t.uploadOptions.fileMaxCount||6,fileType:".pdf|.jpg|.png|.doc|.docx|.xls|.xlsx|.ppt|.pptx|.txt|.DOC|.DOCX|.XLS|.XLSX|.PPT|.PPTX"}):e&&"iOS"===e.platform&&t.$refs.fileUploadRef.chooseFile()})),this.isSelectAction=!1)},selectFileFromAlbum:function(){this.disableAlbum||(this.attachmentService.selectAttachment({quality:this.uploadOptions&&this.uploadOptions.albumQuality||100,encodingType:1,mType:0,maxNum:8,targetWidth:this.uploadOptions.targetWidth||1e3,targetHeight:this.uploadOptions.targetHeight||1e3}),this.isSelectAction=!1)},takePhoto:function(){this.disablePhoto||(this.attachmentService.takePhoto({quality:this.uploadOptions&&this.uploadOptions.photoQuality||100,encodingType:1,targetWidth:this.uploadOptions.targetWidth||1e3,targetHeight:this.uploadOptions.targetHeight||1e3}),this.isSelectAction=!1)},takeShortVideo:function(){this.attachmentService.takeShortVideo({id:this.uploadOptions&&this.uploadOptions.videoId||dt(),quality:.8,time:this.uploadOptions&&this.uploadOptions.videoTime||20}),this.isSelectAction=!1},appendFile:function(){this.$refs.fileUploadRef.chooseFile()},toUpload:function(){this.isSelectAction=!0},onCancel:function(){this.isSelectAction=!1},beforeRead:function(t){return!this.beforeReadFile||this.beforeReadFile(t)},afterRead:function(t){var e=this;if((t&&t.length?this.notUploadedFileList=t.map((function(t){return t.id=dt(),t})):(t.id=dt(),this.notUploadedFileList=[t]),this.allowMaxSize)&&this.notUploadedFileList.some((function(t){var n=t.content.substring(t.content.indexOf(",")+1).length;return parseInt(n-n/8*2)>e.maxSize*Math.pow(1024,2)})))return void this.$dialog.alert({title:"上传失败",message:"上传文件太大，请重新选择！"});if(this.allowMaxCount&&this.notUploadedFileList.length+this.uploadFiles.length>this.maxCount){var n=this.notUploadedFileList.length+this.uploadFiles.length-this.maxCount,a=this.notUploadedFileList.length-n;this.notUploadedFileList=this.notUploadedFileList.slice(0,a)}if(this.$loading.show("附件上传中"),this.uploadAttachmentService)"video/mp4"===t.type?(this.videoUrl=t.url.substring(0,t.url.lastIndexOf("/")),this.uploadAttachmentService.upload([t],{parentDirName:this.parentDirName,rootId:this.rootId}).subscribe((function(n){var a={fileName:t.file.name,metadataId:t.id};e.$emit("afterAppendFile",[a])}))):this.uploadAttachmentService.upload(this.notUploadedFileList,{parentDirName:this.parentDirName,rootId:this.rootId}).subscribe((function(t){var n=e.notUploadedFileList.map((function(t){return{fileName:t.file.name,metadataId:t.id}}));e.$emit("afterAppendFile",n)}));else{var i=this.notUploadedFileList.map((function(t){return{fileName:t.file.name,metadataId:t.id}}));this.$emit("afterAppendFile",i)}},selectFile:function(t){this.genPreview(t),this.selectedFile=t,this.$emit("selectCurrentItem")},deleteAttachment:function(t){this.$emit("remove",[t.attachmentId])},genPreview:function(t){if(t&&t.name){if(this.selectedFile=t,this.findWorkFlow())this.previewFileInWorkFlow(t.attachmentId,this.rootId,t.name);else if(window.top&&window.top!==window.self&&this.openScale(window.top.document),this.openScale(window.document),t.name.toLowerCase().includes("mp4")||t.name.toLowerCase().includes("mov")){this.show=!0,this.showPdf=!1,this.showDoc=!1,this.showVideo=!0;var e=t.content||t.url;this.attachmentService.playShortVideo(e+"/"+t.name)}else this.show=!0,this.showPdf=!0,this.pdfUrl="/platform/runtime/dfs/viewpage/index.html?metadataId="+t.attachmentId+"&rootId="+this.rootId+"&fileType=2";window.MOBILE_ORIGIN_BACK&&window.MOBILE_ORIGIN_BACK.pushOriginGoback&&window.MOBILE_ORIGIN_BACK.pushOriginGoback(this.closed),this.$emit("preview",t)}},getAttachmentUrl:function(t){var e="https:"==document.location.protocol,n=window.location.host;return n=e?"https://"+n:"http://"+n,n+=this.uploadAttachmentService.getAttachmentPath(t,this.rootId)},downloadAttachment:function(t){var e=t.name,n={url:this.getAttachmentUrl(t.attachmentId),saveName:e};this.attachmentService.downloadAttachment(n).subscribe((function(t){}))},closed:function(){window.top&&window.top!==window.self&&this.closeScale(window.top.document),this.closeScale(window.document),this.show=!1,this.showPdf=!1,window.MOBILE_ORIGIN_BACK&&window.MOBILE_ORIGIN_BACK.popOriginGoback&&window.MOBILE_ORIGIN_BACK.popOriginGoback()},hideWorkFlowNavibar:function(){if(this.findWorkFlow()){var t=window.top.document.querySelector("fmapprove-navbar");t&&(this.navibarDisplay=window.top.getComputedStyle(t).display,t.style.display="none");var e=window.top.document.querySelector("div.fm-page-footer");e&&(this.footerDisplay=window.top.getComputedStyle(e).display,e.style.display="none")}},displayWorkFlowNavibar:function(){if(this.findWorkFlow()){var t=window.top.document.querySelector("fmapprove-navbar");t&&(t.style.display=this.navibarDisplay);var e=window.top.document.querySelector("div.fm-page-footer");e&&(e.style.display=this.footerDisplay)}},findWorkFlow:function(){return window.top!==window.self&&window.top.location.href.includes("/platform/runtime/wf/webapp/")},previewFileInWorkFlow:function(t,e,n){var a=this;this.openScale(window.top.document);var i='\n              <div class="fm-file-preview">\n\n              <div class="fm-file-preview-header">\n                <nav class="fm-navbar">\n                    <div id="fm-attach-preview-back-btn" class="fm-navbar-left fm-navbar-left-padding">\n                        <span class="fm-navbar-left-arrow fm-icon fm-icon-arrow-chevron-left"></span>\n                    </div>\n                    <div class="fm-navbar-title">'+(n=n||"附件预览")+'</div>\n                </nav>\n              </div>\n                <div class="fm-file-preview-content">\n                  <div class="preview-content">\n                    <iframe src="'+("/platform/runtime/dfs/viewpage/index.html?metadataId="+t+"&rootId="+e+"&fileType=2")+'"></iframe>\n                  </div>\n                </div>\n              </div>\n            ',o=window.top.document.querySelector(".fm-page-record-deatial"),l=document.createElement("div");l.id="fm-attach-preview-container",l.classList.add("fm-attach-preview-container"),l.innerHTML=i,l.querySelector("div.fm-navbar-left").addEventListener("click",(function(){a.closeScale(window.top.document),o.removeChild(l)})),o.appendChild(l)},openDownloadList:function(t){this.isPreviewAction=!0,this.selectedFile=t}}}),ut={class:"p-md attachment-bg"},pt={key:0,class:"fm-attachment-container attachment-navigation"},ht={class:"fm-attachment-files-list"},ft=r("span",{class:"fm-icon fm-icon-close"},null,-1),vt=r("div",{class:"fm-attachment-upload-btn"},[r("span",{class:"fm-icon fm-icon-addbutton"})],-1),gt={class:"attachment-actionsheet-content"},wt=r("span",{class:"demo-actionsheet-item-text"},"从相册选择",-1),bt=r("span",{class:"attachment-actionsheet-item-text"},"相机",-1),yt=r("span",{class:"attachment-actionsheet-item-text"},"短视频",-1),xt=r("span",{class:"attachment-actionsheet-item-text"},"手机文件",-1),At={style:{padding:".5rem 0"}},Ft={key:0},kt=f(") "),Ct={class:"fm-tmpl-attachment-img"},It={class:"attachment-text"},Mt={class:"fm-tmpl-attachment-name"},St={class:"attachment-button"},Pt=f("预览"),Bt={class:"fm-tmpl-attachment-footer"},Lt={class:"fm-tmpl-attachment-footer-text"},Ut=r("span",null,null,-1),Nt=r("div",{class:"fm-attachment-upload-btn"},[r("span",{class:"fm-icon fm-icon-addbutton"})],-1);var Dt;st(".attachment-actionsheet-item-disabled {\n  color: #ccc; }\n\n.attachment-actionsheet-content {\n  flex: 1 auto;\n  overflow-y: auto; }\n  .attachment-actionsheet-content .attachment-actionsheet-item {\n    display: block;\n    width: 100%;\n    padding: 14px 16px;\n    font-size: 16px;\n    text-align: center;\n    background-color: #fff;\n    border: none;\n    cursor: pointer;\n    text-align: center; }\n\n.attachment-bg {\n  background: #fff; }\n\n.listview-content .fm-listview-item {\n  margin: 12px 0; }\n\n.listview-content .fm-tmpl-attachment-img {\n  width: 48px;\n  height: 48px;\n  margin: auto 0; }\n  .listview-content .fm-tmpl-attachment-img .item-img {\n    width: 100%;\n    height: 100%; }\n  .listview-content .fm-tmpl-attachment-img img {\n    border-radius: 3px;\n    width: 48px;\n    height: 48px; }\n\n.listview-content .attachment-text {\n  flex: 1;\n  margin: auto 12px; }\n  .listview-content .attachment-text > div {\n    display: flex;\n    justify-content: space-between;\n    margin-bottom: 5px; }\n\n.listview-content .fm-tmpl-attachment-name {\n  line-height: 22px;\n  font-family: PingFangSC-Regular;\n  font-size: 16px;\n  color: #333333;\n  letter-spacing: 0.21px;\n  margin-bottom: 2px;\n  word-break: break-all; }\n\n.listview-content .fm-tmpl-attachment-footer {\n  line-height: 18px;\n  font-family: PingFangSC-Regular;\n  font-size: 12px;\n  color: #888888;\n  letter-spacing: 0; }\n\n.listview-content .fm-tmpl-listview-attachment {\n  padding: 0;\n  display: flex;\n  justify-content: space-between; }\n\n.listview-content .attachment-button .attachment-button-custom {\n  padding: 0;\n  width: 50px;\n  height: 20px;\n  font-family: PingFangSC-Regular;\n  font-size: 12px;\n  letter-spacing: 0;\n  border-radius: 10px; }\n\n.listview-content .attachment-icon {\n  margin: auto 0;\n  width: 16px;\n  height: 16px; }\n\n.panzoom {\n  transform: none;\n  backface-visibility: hidden;\n  transform-origin: 50% 50% 0px;\n  display: flex;\n  justify-content: center;\n  flex-wrap: wrap; }\n\n.page {\n  display: inline-block;\n  background-color: #ffffff;\n  margin: 20px;\n  -webkit-box-shadow: 0px 4px 12px -4px rgba(0, 0, 0, 0.38);\n  -moz-box-shadow: 0px 4px 12px -4px rgba(0, 0, 0, 0.38);\n  box-shadow: 0px 4px 12px -4px rgba(0, 0, 0, 0.38);\n  transition: all 0.3s; }\n\n.farris-attachment-entry-vertical {\n  flex-direction: column; }\n\n.farris-attachment-entry {\n  display: flex;\n  clear: both; }\n  .farris-attachment-entry .fm-attachment-disabled {\n    cursor: not-allowed;\n    pointer-events: none; }\n  .farris-attachment-entry .attachment-navigation {\n    overflow: inherit;\n    white-space: nowrap; }\n  .farris-attachment-entry .attachment-navigation .attachment-navigation-item {\n    position: relative;\n    display: inline-block; }\n    .farris-attachment-entry .attachment-navigation .attachment-navigation-item .item-img {\n      width: 100%;\n      height: 100%;\n      position: absolute;\n      top: 0;\n      left: 0; }\n    .farris-attachment-entry .attachment-navigation .attachment-navigation-item .item-icon-delete {\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      position: absolute;\n      right: 0;\n      top: 0;\n      width: 16px;\n      height: 16px;\n      background: #888; }\n      .farris-attachment-entry .attachment-navigation .attachment-navigation-item .item-icon-delete .fm-icon {\n        color: #fff;\n        font-size: 12px; }\n    .farris-attachment-entry .attachment-navigation .attachment-navigation-item .item-icon {\n      position: absolute; }\n  .farris-attachment-entry .fm-attachment-container {\n    box-sizing: border-box;\n    float: left;\n    position: relative;\n    margin: 0 100px 0 0;\n    padding: 0 52px 0 0;\n    max-width: 100%;\n    height: 54px; }\n    .farris-attachment-entry .fm-attachment-container .fm-attachment-files-list {\n      padding-top: 6px;\n      overflow: auto;\n      max-width: 100%; }\n    .farris-attachment-entry .fm-attachment-container .fm-attachment-files-item {\n      position: relative;\n      width: 48px;\n      height: 48px;\n      margin-right: 20px; }\n      .farris-attachment-entry .fm-attachment-container .fm-attachment-files-item .item-icon-delete {\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        position: absolute;\n        right: -6px;\n        top: -6px;\n        width: 16px;\n        height: 16px;\n        background: #888;\n        border-radius: 50%; }\n        .farris-attachment-entry .fm-attachment-container .fm-attachment-files-item .item-icon-delete .fm-icon {\n          color: #fff;\n          font-size: 12px; }\n      .farris-attachment-entry .fm-attachment-container .fm-attachment-files-item .van-image__img {\n        border-radius: 5px; }\n    .farris-attachment-entry .fm-attachment-container .fm-attachment-upload-btn-container {\n      position: absolute;\n      right: 0;\n      top: 50%;\n      margin-top: -20px;\n      z-index: 8;\n      width: 48px;\n      height: 48px;\n      background: #f6f6f6;\n      border-radius: 3px; }\n      .farris-attachment-entry .fm-attachment-container .fm-attachment-upload-btn-container .fm-attachment-upload-btn .fm-icon {\n        display: block;\n        font-size: 20px;\n        color: #ddd;\n        line-height: 48px;\n        margin: 0 auto; }\n  .farris-attachment-entry .fm-attachment-upload-listview-btn-container {\n    z-index: 8;\n    width: 48px;\n    height: 48px;\n    background: #f6f6f6;\n    border-radius: 3px; }\n    .farris-attachment-entry .fm-attachment-upload-listview-btn-container .fm-attachment-upload-btn .fm-icon {\n      display: block;\n      font-size: 20px;\n      color: #ddd;\n      line-height: 48px;\n      margin: 0 auto; }\n"),mt.render=function(t,e,n,p,g,w){var b=a("van-uploader"),y=a("van-image"),x=a("fm-action-sheet"),A=a("fm-button"),F=a("fm-icon"),k=a("fm-listview"),C=a("van-icon"),I=a("fm-navbar"),M=a("van-popup");return i(),o("div",null,[r("div",ut,[r("div",{class:["farris-attachment-entry",{"farris-attachment-entry-vertical":"vertical"===t.direction}]},[l(r(b,{multiple:t.multiple,ref:"fileUploadRef","max-count":t.maxNum,modelValue:t.rawFiles,"onUpdate:modelValue":e[1]||(e[1]=function(e){return t.rawFiles=e}),disabled:t.disabled,"preview-full-image":!0,accept:t.accept,"before-read":t.beforeRead,"after-read":t.afterRead},null,8,["multiple","max-count","modelValue","disabled","accept","before-read","after-read"]),[[s,!1]]),"horizontal"===t.direction?(i(),o("div",pt,[r("div",ht,[(i(!0),o(d,null,m(t.uploadFiles,(function(e,n){return i(),o("div",{class:"fm-attachment-files-item attachment-navigation-item",key:n,onClick:u((function(n){return t.downloadAttachment(e)}),["stop"])},[e&&e.name&&!e.name.includes("mp4")||!e.name?(i(),o(y,{key:0,src:e.content||e.url,class:"item-img",width:"100%",height:"100%"},null,8,["src"])):c("v-if",!0),e&&e.name&&e.name.toLowerCase().includes("mp4")||e.name.toLowerCase().includes("mov")?(i(),o(y,{key:1,src:"/platform/runtime/dfs/images/file.png",class:"item-img",width:"48",height:"48"},null,8,["src"])):c("v-if",!0),t.uploadFiles&&t.uploadFiles.length&&!t.removable?(i(),o("div",{key:2,class:["item-icon-delete",{"fm-attachment-disabled":t.disabled}],onClick:u((function(n){return t.deleteAttachment(e)}),["stop"])},[ft],10,["onClick"])):c("v-if",!0)],8,["onClick"])})),128))]),t.removable?c("v-if",!0):(i(),o("div",{key:0,class:["fm-attachment-upload-btn-container",{"fm-attachment-disabled":t.disabled}],onClick:e[2]||(e[2]=function(){return t.toUpload&&t.toUpload.apply(t,arguments)})},[vt],2))])):c("v-if",!0),r(x,{show:t.isSelectAction,"onUpdate:show":e[7]||(e[7]=function(e){return t.isSelectAction=e}),actions:t.actions,"cancel-text":"取消","close-on-click-action":""},{default:h((function(){return[r("div",gt,[t.uploadOptions&&t.uploadOptions.showAlbum?(i(),o("div",{key:0,class:["attachment-actionsheet-item",{"attachment-actionsheet-item-disabled":t.disableAlbum}],onClick:e[3]||(e[3]=function(){return t.selectFileFromAlbum&&t.selectFileFromAlbum.apply(t,arguments)})},[wt],2)):c("v-if",!0),t.uploadOptions&&t.uploadOptions.showPhoto?(i(),o("div",{key:1,class:["attachment-actionsheet-item",{"attachment-actionsheet-item-disabled":t.disablePhoto}],onClick:e[4]||(e[4]=function(){return t.takePhoto&&t.takePhoto.apply(t,arguments)})},[bt],2)):c("v-if",!0),t.uploadOptions&&t.uploadOptions.showVideo?(i(),o("div",{key:2,class:["attachment-actionsheet-item",{"attachment-actionsheet-item-disabled":t.disablePhoto}],onClick:e[5]||(e[5]=function(){return t.takeShortVideo&&t.takeShortVideo.apply(t,arguments)})},[yt],2)):c("v-if",!0),t.uploadOptions&&t.uploadOptions.showFile?(i(),o("div",{key:3,class:["attachment-actionsheet-item",{"attachment-actionsheet-item-disabled":t.disableFile}],onClick:e[6]||(e[6]=function(){return t.selectFileFromMobile&&t.selectFileFromMobile.apply(t,arguments)})},[xt],2)):c("v-if",!0)])]})),_:1},8,["show","actions"]),r(x,{show:t.isPreviewAction,"onUpdate:show":e[8]||(e[8]=function(e){return t.isPreviewAction=e}),actions:t.previewAction,"cancel-text":"取消","close-on-click-action":"",onSelect:t.selectAction},null,8,["show","actions","onSelect"]),"vertical"===t.direction?(i(),o(k,{key:1,listData:t.uploadFiles,finished:!0,showFinishedText:!1,className:"listview-content"},{listViewHeader:h((function(){return[r("div",At,[f(" 附件("+v(t.uploadFiles.length),1),t.allowMaxCount?(i(),o("span",Ft,"/"+v(Math.max(t.uploadFiles.length,t.maxCount)),1)):c("v-if",!0),kt])]})),default:h((function(e){return[r("div",{class:"fm-tmpl-listview-attachment",onClick:u((function(n){return t.openDownloadList(e.item)}),["stop"])},[r("div",Ct,[e.item&&e.item.name&&!e.item.name.includes("mp4")||!e.item.name?(i(),o(y,{key:0,src:e.item.content||e.item.url,class:"item-img"},null,8,["src"])):c("v-if",!0),e.item&&e.item.name&&e.item.name.toLowerCase().includes("mp4")||e.item.name.toLowerCase().includes("mov")?(i(),o(y,{key:1,src:"/platform/runtime/dfs/images/file.png",class:"item-img"},null,8,["src"])):c("v-if",!0)]),r("div",It,[r("div",null,[r("div",Mt,[r("span",null,v(e.item.name),1)]),r("div",St,[r(A,{className:"attachment-button-custom",color:"#3A90FF",plain:"",onClick:u((function(n){return t.genPreview(e.item)}),["stop"])},{default:h((function(){return[Pt]})),_:2},1032,["onClick"])])]),r("div",Bt,[r("span",Lt,v(t.transformSize(e.item.size)),1),r("span",null,v(e.item.createTime),1)])]),t.removable?c("v-if",!0):(i(),o("div",{key:0,class:"attachment-icon",onClick:u((function(n){return t.deleteAttachment(e.item)}),["stop"])},[r(F,{name:"s-clear",color:"#888",size:"16"})],8,["onClick"]))],8,["onClick"])]})),listviewEmpty:h((function(){return[Ut]})),_:1},8,["listData"])):c("v-if",!0),t.removable||"vertical"!==t.direction||!(t.allowMaxCount&&t.uploadFiles.length<t.maxCount)&&t.allowMaxCount?c("v-if",!0):(i(),o("div",{key:2,class:["fm-attachment-upload-listview-btn-container",{"fm-attachment-disabled":t.disabled}],onClick:e[9]||(e[9]=function(){return t.toUpload&&t.toUpload.apply(t,arguments)})},[Nt],2)),r(M,{show:t.show,"onUpdate:show":e[10]||(e[10]=function(e){return t.show=e}),style:{height:"100%",width:"100%"}},{default:h((function(){return[r(I,{title:t.selectedFile&&t.selectedFile.name,onClickLeft:t.closed},{left:h((function(){return[r(C,{name:"arrow-left",size:"18",color:"#333"})]})),_:1},8,["title","onClickLeft"]),t.showPdf?(i(),o("iframe",{key:0,class:"pdf-iframe",scrolling:"yes",src:t.pdfUrl,width:"100%",height:"100%"},"\r\n          ",8,["src"])):c("v-if",!0)]})),_:1},8,["show"])],2)])])},mt.__file="src/components/attachment-file/src/attachment-file.vue",mt.install=function(t){t.component(mt.name,mt)};var Ot=t({name:"fm-attachment-entry",components:(Dt={"van-image":D},Dt[L.Component.name]=L.Component,Dt),inject:{attachmentService:{default:null},uploadAttachmentService:{default:{}}},props:{rootId:{type:String,default:""},fileList:{type:Array,default:function(){return[]}},multiple:{type:Boolean,default:!0},accept:{type:String,default:"image/gif,image/jpg,image/jpeg,image/bmp,image/png"},disabled:{type:Boolean,default:!1},beforeReadFile:{type:Function},uploadFile:{type:Function},previewFile:{type:Function},beforeTakePhoto:{type:Function},removable:{type:Boolean,default:!1},direction:{type:String,default:"horizontal"},title:{type:String,default:"附件"},externalVideoUrl:{type:String,default:""}},data:function(){return{fromProp:!1,rawFiles:[],showAction:!1,saveAction:!1,selectedFile:null,selectedFilePath:"",description:"",notUploadedFileList:[],previewPages:[],pdfUrl:"",show:!1,showPdf:!1,showVideo:!1,docStyle:{}}},computed:{uploadFiles:function(){var t;return this.rawFiles=(t=[]).concat.apply(t,this.fileList.map((function(t){return t}))),this.rawFiles&&this.rawFiles.length?(this.selectedFile=this.rawFiles[0],this.rawFiles):(this.selectedFile=null,[])},isEmpty:function(){return this.rawFiles&&!this.rawFiles.length},previewEnable:function(){return this.showAction&&this.rawFiles&&!!this.rawFiles.length}},mounted:function(){this.allowDefaultEntrance||(this.showAction=!0)},methods:{getAttachmentPath:function(t){return this.uploadAttachmentService.getAttachmentPath(t,this.rootId)},getAttachmentPathByType:function(t){return t.name.search(/\.(png|jpe?g|gif|svg)(\?.*)?$/)>=0?this.getAttachmentPath(t.attachmentId):t.content||t.url},appendFile:function(){this.$refs.fileUploadRef.chooseFile()},toUpload:function(){this.$emit("upload")},beforeRead:function(t){return!this.beforeReadFile||this.beforeReadFile(t)},afterRead:function(t){this.showAction=!0,t&&t.length?(this.selectedFile=t[t.length-1],this.notUploadedFileList=t):(this.selectedFile=t,this.notUploadedFileList=[t]),this.$emit("afterAppendFile",t),this.requestUpload()},deleteFile:function(){this.rawFiles&&this.rawFiles.length&&this.deleteAttachment(this.selectedFile)},mergeString:function(t,e){var n=t.length<e.length?t.length:e.length,a="",i=0;for(i=0;i<n;i++)a+=t.substring(i,i+1),a+=e.substring(i,i+1);return a+=t.length<e.length?e.substring(i):t.substring(i)},getToken:function(t){var e=[1,2,3];t.length>24&&(t=t.substring(0,24));var n=Math.floor(t.length/3),a=t.substring(0,n),i=t.substring(n,2*n),o=t.substring(2*n,3*n),l=[],r=Math.ceil(3*Math.random());l.push(e[r-1]),e.splice(r-1,1),r=Math.ceil(2*Math.random()),l.push(e[r-1]),e.splice(r-1,1),l.push(e[0]);var s=Math.round((new Date).getTime()/1e3)+"";return s.substring(0,5)+"times"+l[0]+l[1]+l[2]+this.switchStr(a,i,o,l[0])+this.switchStr(a,i,o,l[1])+this.switchStr(a,i,o,l[2])+"times"+s.substring(5)},switchStr:function(t,e,n,a){switch(a){case 1:return t;case 2:return e;case 3:return n}},selectFile:function(t){this.genPreview(t),this.selectedFile=t,this.$emit("selectCurrentItem")},deleteAttachment:function(t){this.$emit("remove",[t.attachmentId])},genPreview:function(t){if(t&&t.name){var e=document.getElementsByName("viewport")[0],n=document.createElement("meta");n.name="viewport",n.content="width=device-width, initial-scale=1.0";var a=document.getElementsByTagName("head")[0];e&&a.removeChild(e),a.appendChild(n),t.name.toLowerCase().includes("mp4")||t.name.toLowerCase().includes("mov")?(this.externalVideoUrl&&(t.url=this.externalVideoUrl+"?metadataId="+t.attachmentId+"&rootid="+this.rootId+"&token="+this.getToken(this.mergeString(t.attachmentId,this.rootId))),this.show=!0,this.showPdf=!1,this.showVideo=!0):(this.show=!0,this.showPdf=!0,this.pdfUrl="/platform/runtime/dfs/viewpage/index.html?metadataId="+t.attachmentId+"&rootId="+this.rootId+"&fileType=2"),this.$emit("preview",t)}},getFitToWidth:function(t,e){var n=this.ptToPx(t),a=this.ptToPx(e),i=n||window.innerWidth;return a>n&&Math.round(i/window.innerWidth)<=1?200-Math.round(100*i/window.innerWidth):Math.round(100*window.innerWidth/i)},ptToPx:function(t){return 96*t/72},isMobile:function(t){return t<=425},isTablet:function(t){return t<=1024},isDesktop:function(t){return!this.isMobile(t)&&!this.isTablet(t)},closed:function(){var t=document.getElementsByName("viewport")[0],e=document.createElement("meta");e.name="viewport",e.content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no";var n=document.getElementsByTagName("head")[0];t&&n.removeChild(t),n.appendChild(e),this.show=!1}}}),Tt=p("data-v-0d94d79a");e("data-v-0d94d79a");var Rt={key:0,class:"fm-attachment-container attachment-navigation"},Et={class:"fm-attachment-files-list"},Vt=r("span",{class:"fm-icon fm-icon-close"},null,-1),zt=r("div",{class:"fm-attachment-upload-btn"},[r("span",{class:"fm-icon fm-icon-addbutton"})],-1),Wt={class:"fm-tmpl-listview-goods"},jt={class:"fm-tmpl-goods-name"},Ht=r("div",{class:"fm-attachment-upload-btn"},[r("span",{class:"fm-icon fm-icon-addbutton"})],-1),_t={key:1,autoplay:"",controls:"controls",style:{width:"100%",height:"100%"}};n();var qt=Tt((function(t,e,n,l,s,p){var h=a("van-image"),f=a("fm-listview"),g=a("van-icon"),w=a("fm-navbar"),b=a("van-popup");return i(),o("div",{class:["farris-attachment-entry",{"farris-attachment-entry-vertical":"vertical"===t.direction}]},["horizontal"===t.direction?(i(),o("div",Rt,[r("div",Et,[(i(!0),o(d,null,m(t.uploadFiles,(function(e,n){return i(),o("div",{class:"fm-attachment-files-item attachment-navigation-item",key:n,onClick:function(n){return t.selectFile(e)}},[e&&e.name&&!e.name.includes("mp4")||!e.name?(i(),o(h,{key:0,src:t.getAttachmentPathByType(e),class:"item-img",width:"100%",height:"100%"},null,8,["src"])):c("v-if",!0),e&&e.name&&e.name.toLowerCase().includes("mp4")||e.name.toLowerCase().includes("mov")?(i(),o(h,{key:1,src:"/platform/runtime/dfs/images/file.png",class:"item-img",width:"48",height:"48"},null,8,["src"])):c("v-if",!0),t.uploadFiles&&t.uploadFiles.length&&!t.removable?(i(),o("div",{key:2,class:["item-icon-delete",{"fm-attachment-disabled":t.disabled}],onClick:u((function(n){return t.deleteAttachment(e)}),["stop"])},[Vt],10,["onClick"])):c("v-if",!0)],8,["onClick"])})),128))]),t.removable?c("v-if",!0):(i(),o("div",{key:0,class:["fm-attachment-upload-btn-container",{"fm-attachment-disabled":t.disabled}],onClick:e[1]||(e[1]=function(){return t.toUpload&&t.toUpload.apply(t,arguments)})},[zt],2))])):c("v-if",!0),"vertical"===t.direction?(i(),o(f,{key:1,listData:t.uploadFiles,finished:!0,showFinishedText:!1},{listViewHeader:Tt((function(){return[]})),default:Tt((function(e){return[r("div",Wt,[r("div",{class:"fm-tmpl-goods-img",onClick:function(n){return t.selectFile(e.item)}},[e.item&&e.item.name&&!e.item.name.includes("mp4")||!e.item.name?(i(),o(h,{key:0,src:e.item.content||e.item.url,class:"item-img"},null,8,["src"])):c("v-if",!0),e.item&&e.item.name&&e.item.name.toLowerCase().includes("mp4")||e.item.name.toLowerCase().includes("mov")?(i(),o(h,{key:1,src:"/platform/runtime/dfs/images/file.png",class:"item-img"},null,8,["src"])):c("v-if",!0)],8,["onClick"]),r("div",null,[r("div",jt,[r("span",null,v(e.item.name),1),c(' <div class="fm-tmpl-goods-add">\r\n\t\t\t\t\t\t\t\t可以添加下载\r\n\t\t\t\t\t\t\t\t<span class="fm-icon fm-icon-print"></span>\r\n\t\t\t\t\t\t\t</div> ')]),c(' <div class="fm-tmpl-goods-price">\r\n\t\t\t\t\t\t\t<span class="fm-tmpl-goods-price-text">已上传</span>\r\n\t\t\t\t\t\t</div> ')])])]})),_:1},8,["listData"])):c("v-if",!0),t.removable||"vertical"!==t.direction?c("v-if",!0):(i(),o("div",{key:2,class:["fm-attachment-upload-listview-btn-container",{"fm-attachment-disabled":t.disabled}],onClick:e[2]||(e[2]=function(){return t.toUpload&&t.toUpload.apply(t,arguments)})},[Ht],2)),r(b,{show:t.show,"onUpdate:show":e[3]||(e[3]=function(e){return t.show=e}),closeable:"",onClosed:t.closed,style:{height:"100%",width:"100%"}},{default:Tt((function(){return[r(w,{title:t.selectedFile&&t.selectedFile.name,onClickLeft:t.closed},{left:Tt((function(){return[r(g,{name:"arrow-left",size:"18",color:"#333"})]})),_:1},8,["title","onClickLeft"]),t.showPdf?(i(),o("iframe",{key:0,class:"pdf-iframe",scrolling:"yes",src:t.pdfUrl,width:"100%",height:"100%"},"\r\n      ",8,["src"])):c("v-if",!0),t.showVideo&&t.selectedFile&&t.selectedFile.name&&t.selectedFile.name.toLowerCase().includes("mov")?(i(),o("video",_t,[r("source",{src:t.selectedFile.url,type:"video/mp4"},null,8,["src"])])):c("v-if",!0),t.showVideo&&t.selectedFile&&t.selectedFile.name&&t.selectedFile.name.toLowerCase().includes("mp4")||t.selectedFile.name.toLowerCase().includes("webm")||t.selectedFile.name.toLowerCase().includes("ogg")?(i(),o("video",{key:2,autoplay:"",src:t.selectedFile.url,controls:"controls",style:{width:"100%",height:"100%"}}," 您的浏览器不支持 video 标签。 ",8,["src"])):c("v-if",!0)]})),_:1},8,["show","onClosed"])],2)}));st('.fm-tmpl-listview-goods[data-v-0d94d79a] {\n  margin-bottom: 0.5rem;\n  padding: 0; }\n  .fm-tmpl-listview-goods[data-v-0d94d79a] img {\n    height: 48px;\n    width: 48px;\n    border-radius: 5px; }\n  .fm-tmpl-listview-goods[data-v-0d94d79a] .fm-tmpl-goods-price .fm-tmpl-goods-price-text {\n    font-size: 12px;\n    color: #666; }\n  .fm-tmpl-listview-goods[data-v-0d94d79a] .fm-tmpl-goods-name {\n    line-height: 1;\n    margin: 0;\n    min-height: 0;\n    font-size: 14px;\n    color: #000;\n    padding: 0;\n    overflow-wrap: break-word; }\n  .fm-tmpl-listview-goods[data-v-0d94d79a] .fm-tmpl-goods-img {\n    width: 48px;\n    height: 48px; }\n  .fm-tmpl-listview-goods[data-v-0d94d79a] .fm-tmpl-goods-content {\n    padding: 0; }\n  .fm-tmpl-listview-goods[data-v-0d94d79a] .fm-tmpl-goods-content::after {\n    content: ""; }\n\n.panzoom[data-v-0d94d79a] {\n  transform: none;\n  backface-visibility: hidden;\n  transform-origin: 50% 50% 0px;\n  display: flex;\n  justify-content: center;\n  flex-wrap: wrap; }\n\n.page[data-v-0d94d79a] {\n  display: inline-block;\n  background-color: #ffffff;\n  margin: 20px;\n  -webkit-box-shadow: 0px 4px 12px -4px rgba(0, 0, 0, 0.38);\n  -moz-box-shadow: 0px 4px 12px -4px rgba(0, 0, 0, 0.38);\n  box-shadow: 0px 4px 12px -4px rgba(0, 0, 0, 0.38);\n  transition: all 0.3s; }\n\n.farris-attachment-entry-vertical[data-v-0d94d79a] {\n  flex-direction: column; }\n\n.farris-attachment-entry[data-v-0d94d79a] {\n  display: flex;\n  clear: both; }\n  .farris-attachment-entry[data-v-0d94d79a] .fm-attachment-disabled {\n    cursor: not-allowed;\n    pointer-events: none; }\n  .farris-attachment-entry[data-v-0d94d79a] .attachment-navigation {\n    overflow: inherit;\n    white-space: nowrap; }\n  .farris-attachment-entry[data-v-0d94d79a] .attachment-navigation .attachment-navigation-item {\n    position: relative;\n    display: inline-block; }\n    .farris-attachment-entry[data-v-0d94d79a] .attachment-navigation .attachment-navigation-item .item-img {\n      width: 100%;\n      height: 100%;\n      position: absolute;\n      top: 0;\n      left: 0; }\n    .farris-attachment-entry[data-v-0d94d79a] .attachment-navigation .attachment-navigation-item .item-icon-delete {\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      position: absolute;\n      right: 0;\n      top: 0;\n      width: 16px;\n      height: 16px;\n      background: #888; }\n      .farris-attachment-entry[data-v-0d94d79a] .attachment-navigation .attachment-navigation-item .item-icon-delete .fm-icon {\n        color: #fff;\n        font-size: 12px; }\n    .farris-attachment-entry[data-v-0d94d79a] .attachment-navigation .attachment-navigation-item .item-icon {\n      position: absolute; }\n  .farris-attachment-entry[data-v-0d94d79a] .fm-attachment-container {\n    box-sizing: border-box;\n    float: left;\n    position: relative;\n    margin: 0 100px 0 0;\n    padding: 0 52px 0 0;\n    max-width: 100%;\n    height: 54px; }\n    .farris-attachment-entry[data-v-0d94d79a] .fm-attachment-container .fm-attachment-files-list {\n      padding-top: 6px;\n      overflow: auto;\n      max-width: 100%; }\n    .farris-attachment-entry[data-v-0d94d79a] .fm-attachment-container .fm-attachment-files-item {\n      position: relative;\n      width: 48px;\n      height: 48px;\n      margin-right: 20px; }\n      .farris-attachment-entry[data-v-0d94d79a] .fm-attachment-container .fm-attachment-files-item .item-icon-delete {\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        position: absolute;\n        right: -6px;\n        top: -6px;\n        width: 16px;\n        height: 16px;\n        background: #888;\n        border-radius: 50%; }\n        .farris-attachment-entry[data-v-0d94d79a] .fm-attachment-container .fm-attachment-files-item .item-icon-delete .fm-icon {\n          color: #fff;\n          font-size: 12px; }\n      .farris-attachment-entry[data-v-0d94d79a] .fm-attachment-container .fm-attachment-files-item .van-image__img {\n        border-radius: 5px; }\n    .farris-attachment-entry[data-v-0d94d79a] .fm-attachment-container .fm-attachment-upload-btn-container {\n      position: absolute;\n      right: 0;\n      top: 50%;\n      margin-top: -20px;\n      z-index: 8;\n      width: 48px;\n      height: 48px;\n      background: #f6f6f6;\n      border-radius: 3px; }\n      .farris-attachment-entry[data-v-0d94d79a] .fm-attachment-container .fm-attachment-upload-btn-container .fm-attachment-upload-btn .fm-icon {\n        display: block;\n        font-size: 20px;\n        color: #ddd;\n        line-height: 48px;\n        margin: 0 auto; }\n  .farris-attachment-entry[data-v-0d94d79a] .fm-attachment-upload-listview-btn-container {\n    z-index: 8;\n    width: 48px;\n    height: 48px;\n    background: #f6f6f6;\n    border-radius: 3px; }\n    .farris-attachment-entry[data-v-0d94d79a] .fm-attachment-upload-listview-btn-container .fm-attachment-upload-btn .fm-icon {\n      display: block;\n      font-size: 20px;\n      color: #ddd;\n      line-height: 48px;\n      margin: 0 auto; }\n'),Ot.render=qt,Ot.__scopeId="data-v-0d94d79a",Ot.__file="src/components/attachment-entry/src/attachment-entry.vue",Ot.install=function(t){t.component(Ot.name,Ot)};var Gt=t({name:"fm-verify-code",props:{second:{type:Number,default:60}},data:function(){return{time:0,disabled:!1}},methods:{run:function(){this.disabled||this.time>0||(this.$emit("run"),this.start())},start:function(){this.time=this.second,this.timer()},stop:function(){this.time=0,this.disabled=!1},setDisabled:function(t){this.disabled=t},timer:function(){this.time>0?(this.time--,setTimeout(this.timer,1e3)):this.disabled=!1}},computed:{text:function(){return this.time>0?this.time+"s":"获取验证码"}}}),Kt=p("data-v-607c2323");e("data-v-607c2323");var Xt={class:"text"};n();var Zt=Kt((function(t,e,n,a,l,s){return i(),o("div",{class:["fm-verify-code",{"fm-verify-code-disabled":t.disabled||t.time>0}],onClick:e[1]||(e[1]=function(e){return t.run()})},[r("span",Xt,v(t.text),1)],2)}));st(".fm-verify-code[data-v-607c2323] .text {\n  font-size: 15px;\n  color: #31A4FB; }\n\n.fm-verify-code[data-v-607c2323]-disabled .text {\n  color: #999; }\n"),Gt.render=Zt,Gt.__scopeId="data-v-607c2323",Gt.__file="src/business/verify-code/src/index.vue",Gt.install=function(t){t.component(Gt.name,Gt)};var Jt=function(){function t(){}return t.getCurrentData=function(t,e,n){return e.find((function(e){return e[n].attachmentId===t}))},t.modifyData=function(t,e,n){e.forEach((function(e){var a=e.split("_");if(a.length>1){var i=a[1].substring(0,1).toLowerCase()+a[1].substring(1);t[a[0]][i]=n[e]}else t[e]=n[e]}))},t.getContextData=function(t){return t.data},t.setContextData=function(t,e){t.data=e},t.appendToContextData=function(t,e){t.data=[].concat(t.data,e)},t.updateContextData=function(t,e){t.oldData=e},t.appendToContextOldData=function(t,e){t.oldData=[].concat(t.oldData,e)},t.removeContextDataById=function(t,e){var n=t.data.findIndex((function(t){return t.id===e}));t.data.splice(n,1)},t}();function Yt(){return(Yt=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t}).apply(this,arguments)}var Qt=function(){function t(){this._remoteSvrUrl="https://webapi.amap.com/html/geolocate.html",this._callbackList=[],this._seqBase=1,this._frameReady=0,this._watchIdMap={}}var e=t.prototype;return e._getSeq=function(){return this._seqBase++},e._onRrameReady=function(t){if(0===this._frameReady)return this._frameReadyList||(this._frameReadyList=[]),this._frameReadyList.push(t),void this._prepareIframe();t.call(this)},e._prepareIframe=function(){var t=this;if(!this._iframeWin){var e=document.createElement("iframe");e.src=this._remoteSvrUrl+(this._remoteSvrUrl.indexOf("?")>0?"&":"?"),e.width="0px",e.height="0px",e.style.position="absolute",e.style.display="none",e.allow="geolocation";var n=setTimeout((function(){t._frameReady=!1,t._callbackFrameReadyList()}),5e3);e.onload=function(){clearTimeout(n),t._frameReady=!0,t._callbackFrameReadyList(),e.onload=null},document.body.appendChild(e),this._iframeWin=e.contentWindow,window.addEventListener("message",(function(e){0===t._remoteSvrUrl.indexOf(e.origin)&&t._handleRemoteMsg(e.data)}),!1)}},e._callbackFrameReadyList=function(){if(this._frameReadyList){var t=this._frameReadyList;this._frameReadyList=null;for(var e=0,n=t.length;e<n;e++)t[e].call(this,this._frameReady)}},e._pickCallback=function(t,e){for(var n=this._callbackList,a=0,i=n.length;a<i;a++){var o=n[a];if(t===o.seq)return e||n.splice(a,1),o}},e._handleRemoteMsg=function(t){var e=t.seq,n=this._pickCallback(e,!!t.notify);n?n.cbk.call(null,t.error,t.result):console.warn("Receive remote msg: ",t)},e._postMessage=function(t,e,n,a){var i=this;this._prepareIframe();var o={cmd:t,args:e,seq:a||this._getSeq()};this._callbackList.push({cbk:n,seq:o.seq}),this._onRrameReady((function(){if(!0===i._frameReady)try{i._iframeWin.postMessage(o,"*")}catch(t){i._pickCallback(o.seq),n(t)}else i._pickCallback(o.seq),n({message:"iFrame load failed!"})}))},e.getCurrentPosition=function(t,e,n){this._postMessage("getCurrentPosition",[n],(function(n,a){n?e&&e(n):t&&t(a)}))},e.watchPosition=function(t,e,n){var a=this,i="wk"+this._getSeq(),o=this._getSeq();this._watchIdMap[i]={stat:0,seq:o};var l=this;return this._postMessage("watchPosition",[n],(function(n,o){var r=null;o&&(r=o.id);var s=a._watchIdMap[i];if(s.id=r,s.stat=1,s.callbackList){var c=s.callbackList;s.callbackList=null;for(var d=0,m=c.length;d<m;d++)c[d].call(l,r)}n?e&&e(n):t&&t(o.pos)}),o),i},e.clearWatch=function(t,e){if(this._watchIdMap[t]){var n=this._watchIdMap[t],a=this,i=function(i){a._postMessage("clearWatch",[i],(function(i,o){i||(a._pickCallback(n.seq),delete a._watchIdMap[t]),e&&e(i,o)}))};n.stat<1?(n.callbackList||(n.callbackList=[]),n.callbackList.push((function(t){i(t)}))):i(n.id)}else e("Id not exists: "+t)},t}(),$t={key:null,v:"1.4.4",protocol:"https",hostAndPath:"webapi.amap.com/maps",plugin:[],callback:"amapInitComponent"};function te(){if((window.AMap.UA.ios||window.AMap.UA.android)&&"https:"!==document.location.protocol){var t=new Qt;navigator.geolocation.getCurrentPosition=function(){return t.getCurrentPosition.apply(t,arguments)},navigator.geolocation.watchPosition=function(){return t.watchPosition.apply(t,arguments)}}}var ee=function(){function t(t){this._config=Yt({},$t,t),this._document=document,this._window=window,this._scriptLoaded=!1,this._queueEvents=[te]}var e=t.prototype;return e.load=function(){var t=this;if(this._window.AMap&&this._window.AMap.Map)return this.loadUIAMap();if(this._scriptLoadingPromise)return this._scriptLoadingPromise;var e=this._document.createElement("script");e.type="text/javascript",e.async=!0,e.defer=!0,e.src=this._getScriptSrc();var n=this._config.uiVersion?this.loadUIAMap():null;return this._scriptLoadingPromise=new Promise((function(a,i){t._window.amapInitComponent=function(){for(;t._queueEvents.length;)t._queueEvents.pop().apply();if(!n)return a();n.then((function(){window.initAMapUI(),setTimeout(a)}))},e.onerror=function(t){return i(t)}})),this._document.head.appendChild(e),this._scriptLoadingPromise},e.loadUIAMap=function(){var t=this;return!this._config.uiVersion||window.AMapUI?Promise.resolve():new Promise((function(e,n){var a=document.createElement("script"),i=t._config.uiVersion.split("."),o=i[0],l=i[1],r=i[2];if(void 0!==o&&void 0!==l){var s=t._config.protocol+"://webapi.amap.com/ui/"+o+"."+l+"/main-async.js";r&&(s+="?v="+o+"."+l+"."+r),a.src=s,a.type="text/javascript",a.async=!0,t._document.head.appendChild(a),a.onload=function(){setTimeout(e,0)},a.onerror=function(){return n()}}else console.error("amap ui version is not correct, please check! version: ",t._config.uiVersion)}))},e._getScriptSrc=function(){var t=/^AMap./,e=this._config,n=["v","key","plugin","callback"];if(e.plugin&&e.plugin.length>0){e.plugin.push("Autocomplete","PlaceSearch","PolyEditor","CircleEditor");var a=[];e.plugin.forEach((function(e){var n=t.test(e)?e:"AMap."+e,i=n.replace(t,"");a.push(n,i)})),e.plugin=a}var i=Object.keys(e).filter((function(t){return~n.indexOf(t)})).filter((function(t){return null!=e[t]})).filter((function(t){return!Array.isArray(e[t])||Array.isArray(e[t])&&e[t].length>0})).map((function(t){var n=e[t];return Array.isArray(n)?{key:t,value:n.join(",")}:{key:t,value:n}})).map((function(t){return t.key+"="+t.value})).join("&");return this._config.protocol+"://"+this._config.hostAndPath+"?"+i},t}(),ne=null,ae=function(){function t(){}var e=t.prototype;return e.addPlugins=function(t,e){var n=window.AMap,a=e.filter((function(t){return!n[t.sName]}));return a&&a.length?t.plugin(a,this.addMapControls):this.addMapControls(t,e)},e.addMapControls=function(t,e){var n=this;if(e&&e.length){var a={},i=window.AMap;e.forEach((function(e){var o=n.convertAMapPluginProps(e),l=a[o.pName]=new i[o.sName](o);if(t.addControl(l),e.events)for(var r in e.events){var s=e.events[r];"init"===r?s(l):i.event.addListener(l,r,s)}}))}},e.convertAMapPluginProps=function(t){if("object"==typeof t&&t.pName){switch(t.pName){case"AMap.ToolBar":case"AMap.Scale":t.offset&&t.offset instanceof Array&&(t.offset=this.toPixel(t.offset))}return t}return""},e.toPixel=function(t){return new window.AMap.Pixel(t[0],t[1])},t}();function ie(){for(var t=[],e="0123456789abcdef",n=0;n<36;n++)t[n]=e.substr(Math.floor(16*Math.random()),1);return t[14]="4",t[19]=e.substr(3&t[19]|8,1),t[8]=t[13]=t[18]=t[23]="-",t.join("")}var oe=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var a=[].map.call(e,(function(t){return t.trim()})).filter((function(t){return t.length})).join("-");return a.length?1!==a.length&&/[_.\- ]+/.test(a)?a.replace(/^[_.\- ]+/,"").toLowerCase().replace(/[_.\- ]+(\w|$)/g,(function(t,e){return e.toUpperCase()})):a[0]===a[0].toLowerCase()&&a.slice(1)!==a.slice(1).toLowerCase()?a:a.toLowerCase():""},le=function(){function t(){this._componentMap=new Map,this._map=null}var e=t.prototype;return e.setMap=function(t){this._map=t},e.getMap=function(){return this._map},e.setComponent=function(t,e){this._componentMap.set(t,e)},e.getComponent=function(t){return this._componentMap.get(t)},e.getChildInstance=function(t){return this.getComponent(t)},e.removeComponent=function(t){this._componentMap.delete(t)},t}(),re=t({name:"fm-business-attachment",props:{extendFields:{type:Array,default:function(){return[{}]}},showNavBar:{type:Boolean,default:!0},parentDirName:{type:String,default:""},rootId:{type:String,default:"default-root"},path:{type:String,default:""},title:{type:String,default:"导航栏"},displayAttachmentInfo:{type:Boolean,default:!1},removable:{type:Boolean,default:!1},displayAttachmentId:{type:Boolean,default:!0},displayAttachmentName:{type:Boolean,default:!0},externalVideoUrl:{type:String,default:""}},setup:function(t,e){var n=e.emit,a=g({show:!1,fieldsValue:{},attachmentExtendFields:[],selectedAttachmentId:"",context:{data:[],oldData:[],getData:null,updateData:null,removeDataById:null,setData:null,appendData:null,removed:!1},currentData:null,fields:w((function(){return t.extendFields||[{}]})),rawData:w((function(){if(!a.currentData&&a.context.data.length&&(a.currentData=a.context.data[0],b((function(){Object.keys(a.fieldsValue).forEach((function(t){a.fieldsValue[t]=o(a.currentData,t)}))}))),a.selectedAttachmentId){var e=a.context.data.find((function(e){return e[t.path.substring(1)].attachmentId===a.selectedAttachmentId}));e?(a.currentData=e,b((function(){Object.keys(a.fieldsValue).forEach((function(t){a.fieldsValue[t]=o(a.currentData,t)}))}))):(a.context.data.length,b((function(){Object.keys(a.fieldsValue).forEach((function(t){a.fieldsValue[t]=o(a.context.data[a.context.data.length-1],t)}))})))}return a.context.data})),filterData:w((function(){return H(a.rawData,t.path,t.rootId)}))});y((function(){i(),n("getRawData",a.context),!a.currentData&&a.context.data&&a.context.data.length&&(a.currentData=a.context.data[0])}));var i=function(){a.context.getData=Jt.getContextData.bind(null,a.context),a.context.updateData=Jt.updateContextData.bind(null,a.context),a.context.removeDataById=Jt.removeContextDataById.bind(null,a.context),a.context.setData=Jt.setContextData.bind(null,a.context),a.context.appendData=Jt.appendToContextData.bind(null,a.context)},o=function(t,e){if(t){var n=e.split("_");if(n.length>1){var a=n[1].substring(0,1).toLowerCase()+n[1].substring(1);return t[n[0]][a]}return t[e]}return""};return{state:a,uploadAttachment:function(t){a.selectedAttachmentId=t[0].metadataId,n("upload",{context:a.context,rootId:a.rootId,parentDirName:a.parentDirName,data:t})},removeAttachment:function(t){a.removed=!0,n("remove",{context:a.context,rootId:a.rootId,parentDirName:a.parentDirName,data:t})},selectChange:function(e){var i=e.attachmentId;a.selectedAttachmentId=i;var l=t.path.split("/")[1];a.currentData=Jt.getCurrentData(i,a.context.data,l),Object.keys(a.fieldsValue).forEach((function(t){a.fieldsValue[t]=o(a.currentData,t)})),n("selectChange",{context:a.context,rootId:a.rootId,parentDirName:a.parentDirName,data:e,currentData:a.currentData})},goBack:function(){if(a.show=!1,a.selectedAttachmentId="",a.currentData){var e=t.extendFields.map((function(t){return t.bindingField})).filter((function(t){return t}));Jt.modifyData(a.currentData,e,a.fieldsValue)}n("goBack",{listData:a.context.data,oldListData:a.context.oldData,context:a.context})},blur:function(t){var e=t.bindingField;a.currentData&&Jt.modifyData(a.currentData,[e],a.fieldsValue),n("blur",{field:t,context:a.context})},toAttachmentDetailPage:function(){a.show=!0,a.currentData=a.context.data[0];var e=[{id:ie(),bindingField:t.path.substring(1)+"_AttachmentId",editorType:"TextBox",position:"right",readonly:!0,label:"附件id",visible:t.displayAttachmentId},{id:ie(),bindingField:t.path.substring(1)+"_FileName",editorType:"TextBox",position:"right",readonly:!0,label:"附件名称",visible:t.displayAttachmentName}];t.displayAttachmentInfo&&(a.attachmentExtendFields=[].concat(e)),[].concat(a.attachmentExtendFields,t.extendFields).forEach((function(t){a.fieldsValue[t.bindingField]=a.currentData&&o(a.currentData,t.bindingField)}))},initContext:i,getDataValue:o}},components:{"fm-attachment-entry":Ot,"fm-attachment":$,"van-nav-bar":z,"van-popup":O,"van-icon":W,"van-field":j}}),se=p("data-v-75253ace");e("data-v-75253ace");var ce={class:"fm-input-item fm-input-item-inline",id:"attachment-container"},de={class:"fm-input-item pr-md pl-md",id:"attachment-container"},me={class:"fm-edit-input-list",id:"detail-form-layout"},ue={class:"fm-input-wrapper"},pe={class:"fm-input-wrapper"};n();var he=se((function(t,e,n,l,s,u){var p=a("fm-attachment-entry"),h=a("van-icon"),f=a("fm-navbar"),v=a("van-field"),g=a("fm-attachment"),w=a("van-popup");return i(),o("div",null,[r("div",ce,[r("div",de,[r(p,{fileList:t.state.filterData,externalVideoUrl:t.externalVideoUrl,removable:t.removable,parentDirName:t.parentDirName,rootId:t.rootId,onRemove:t.removeAttachment,onUpload:t.toAttachmentDetailPage},null,8,["fileList","externalVideoUrl","removable","parentDirName","rootId","onRemove","onUpload"])])]),t.state.show?(i(),o(w,{key:0,show:t.state.show,"onUpdate:show":e[1]||(e[1]=function(e){return t.state.show=e}),position:"right",style:{width:"100%",height:"100%",display:"flex","flex-direction":"column",background:"#fff"}},{default:se((function(){return[t.showNavBar?(i(),o(f,{key:0,title:t.title,onClickLeft:t.goBack},{left:se((function(){return[r(h,{name:"arrow-left",size:"18",color:"#333"})]})),_:1},8,["title","onClickLeft"])):c("v-if",!0),r("div",me,[(i(!0),o(d,null,m(t.state.attachmentExtendFields,(function(e){return i(),o("div",ue,["TextBox"===e.editorType&&e.visible?(i(),o(v,{key:0,label:e.label,modelValue:t.state.fieldsValue[e.bindingField],"onUpdate:modelValue":function(n){return t.state.fieldsValue[e.bindingField]=n},readonly:e.readonly,onBlur:function(n){return t.blur(e)}},null,8,["label","modelValue","onUpdate:modelValue","readonly","onBlur"])):c("v-if",!0),"NumberBox"===e.editorType&&e.visible?(i(),o(v,{key:1,label:e.label,modelValue:t.state.fieldsValue[e.bindingField],"onUpdate:modelValue":function(n){return t.state.fieldsValue[e.bindingField]=n},readonly:e.readonly,type:"number",onBlur:function(n){return t.blur(e)}},null,8,["label","modelValue","onUpdate:modelValue","readonly","onBlur"])):c("v-if",!0)])})),256)),(i(!0),o(d,null,m(t.extendFields,(function(e){return i(),o("div",pe,["TextBox"===e.editorType?(i(),o(v,{key:0,label:e.label,modelValue:t.state.fieldsValue[e.bindingField],"onUpdate:modelValue":function(n){return t.state.fieldsValue[e.bindingField]=n},readonly:e.readonly,onBlur:function(n){return t.blur(e)}},null,8,["label","modelValue","onUpdate:modelValue","readonly","onBlur"])):c("v-if",!0),"NumberBox"===e.editorType?(i(),o(v,{key:1,label:e.label,modelValue:t.state.fieldsValue[e.bindingField],"onUpdate:modelValue":function(n){return t.state.fieldsValue[e.bindingField]=n},readonly:e.readonly,type:"number",onBlur:function(n){return t.blur(e)}},null,8,["label","modelValue","onUpdate:modelValue","readonly","onBlur"])):c("v-if",!0)])})),256))]),t.state.show?(i(),o(g,{key:1,fileList:t.state.filterData,parentDirName:t.parentDirName,externalVideoUrl:t.externalVideoUrl,rootId:t.rootId,onSelectChange:t.selectChange,onRemove:t.removeAttachment,onAfterAppendFile:t.uploadAttachment},null,8,["fileList","parentDirName","externalVideoUrl","rootId","onSelectChange","onRemove","onAfterAppendFile"])):c("v-if",!0)]})),_:1},8,["show"])):c("v-if",!0)])}));st(".van-nav-bar .van-nav-bar__content[data-v-75253ace] {\n  flex: 1; }\n"),re.render=he,re.__scopeId="data-v-75253ace",re.__file="src/business/attachment/attachment.vue",re.install=function(t){t.component(re.name,re)};var fe,ve,ge=t({name:"fm-approve",components:{"fm-popup":G,"fm-navbar":K,"fm-lookup-input":X,"fm-picker":Z,"fm-button":J},props:{show:{type:Boolean,default:!1},processReadFlag:Boolean,nextNodeReadFlag:Boolean,assigneeReadFlag:Boolean,cancelDisabled:Boolean,confirmDisabled:Boolean,process:[String,Number],processOc:Function,processData:Array,nextNode:[String,Number],nextNodeOc:Function,nextNodeData:Array,assignee:[String,Number],assigneeOc:Function,assigneeData:Object,submit:Function,cancel:Function,assignInfos:[Object],selectedValues:[String],multiSelect:{type:Boolean,default:!0},assigneeHolder:{type:String,default:""},nextNodeHolder:{type:String,default:""},processHolder:{type:String,default:""}},emits:["update:show","open","close"],setup:function(t,e){e.attrs,e.slots;var n=e.emit,i=function(e){"function"==typeof t.processOc&&t.processOc(e)},o=function(e){"function"==typeof t.nextNodeOc&&t.nextNodeOc(e)},l=function(){"function"==typeof t.submit&&t.submit()},s=function(){n("update:show",!1),"function"==typeof t.cancel&&t.cancel()};return function(){var e,n=t.process,c=void 0===n?"":n;t.processOc;var d=t.processData,m=void 0===d?[]:d,u=t.nextNode,p=void 0===u?"":u;t.nextNodeOc;var h=t.nextNodeData,v=void 0===h?[]:h;t.assignee,t.assigneeOc,t.assigneeData,t.submit,t.cancel;var g=t.selectedValues,w=void 0===g?[]:g,b=t.processReadFlag,y=t.nextNodeReadFlag;t.assigneeReadFlag,t.cancelDisabled;var A=t.confirmDisabled;t.multiSelect,t.assigneeHolder;var F,k=t.nextNodeHolder,C=t.processHolder,I=t.assignInfos,M=void 0===I?[]:I;return r("div",null,[r(a("fm-popup"),{show:t.show,position:"right",style:"width:100%"},(F=e=r("div",{class:"fm-submit-approve"},[r("div",{class:"fm-submit-approve-header"},[r(a("fm-navbar"),{title:"流程选择",leftArrow:!0,onClickLeft:s},null)]),r("div",{class:"fm-submit-approve-main"},[r("div",{class:"fm-submit-approve-form"},[r(a("fm-picker"),{name:"picker",modelValue:c,"onUpdate:modelValue":function(t){return c=t},label:"选择流程",placeholder:C,onChange:i,"show-toolbar":!0,data:m,readonly:b,textField:"name",valueField:"id",mapFields:{id:"id"}},null),r(a("fm-picker"),{name:"picker",modelValue:p,"onUpdate:modelValue":function(t){return p=t},label:"下一环节",placeholder:k,onChange:o,"show-toolbar":!0,data:v,readonly:y,textField:"name",valueField:"id",mapFields:{id:"id"}},null),M.map((function(e,n){return r(a("fm-lookup-input"),{name:"lookup-input",modelValue:e.assignee,"onUpdate:modelValue":function(t){return e.assignee=t},placeholder:e.assigneeHolder,label:e.label,idField:"id",textField:"name",data:e.assigneeInfo.assigneeUsers,readonly:e.assigneeReadFlag,multiSelect:e.assigneeInfo&&e.assigneeInfo.multiSelect,selectedValues:"clear"===w[n]?"":w[n],onValueChange:function(e){!function(e,n){"function"==typeof t.assigneeOc&&t.assigneeOc(e,n)}(e,n)}},null)}))]),r("div",{class:"fm-submit-approve-btn"},[r(a("fm-button"),{type:"info",round:!0,block:!0,key:"confirm",disabled:A,onClick:l},{default:function(){return[f("确定")]}})])])]),"function"==typeof F||"[object Object]"===Object.prototype.toString.call(F)&&!x(F)?e:{default:function(){return[e]}}))])}}}),we=!1;function be(){var t=g({show:!1}),e=function(e){t.show=e},n=function(n){Object.assign(t,n),we||(window.MOBILE_ORIGIN_BACK&&window.MOBILE_ORIGIN_BACK.pushOriginGoback(xe),we=!0),b((function(){e(!0)}))},a=function(){e(!1),window.MOBILE_ORIGIN_BACK&&window.MOBILE_ORIGIN_BACK.popOriginGoback(),ve&&ve(),fe=void 0};return function(t){var e=F();e&&Object.assign(e.proxy,t)}({open:n,close:a,toggle:e}),{open:n,close:a,state:t,toggle:e}}var ye=function(){var t=function(t){var e=A(t);e.use(B).use(q);var n=document.createElement("div");return document.body.appendChild(n),{instance:e.mount(n),unmount:function(){e.unmount(n),document.body.removeChild(n)}}}({setup:function(){var t=be(),e=t.state,n=t.toggle;return function(){return r(ge,Yt({},e,{"onUpdate:show":n}),null)}}});fe=t.instance,ve=t.unmount};function xe(){we=!1,fe.close()}function Ae(t){if("undefined"!=typeof window)return fe||ye(),console.log("instance",fe),fe.open(t),fe}Ae.clear=function(){fe&&fe.toggle(!1)},Ae.confirm=function(t){return Ae(t)},Ae.install=function(t){t.component(ge.name,ge)},Ae.Component=ge;var Fe,ke,Ce=t({name:"fm-attachment-preview",components:{"fm-popup":G,"fm-navbar":K},props:{title:{type:String,default:""},attachmentId:{type:String,default:""},rootId:{type:String,default:""},show:{type:Boolean,default:!1},path:{type:String,default:""}},emits:["update:show","open","close"],setup:function(t,e){var n=e.emit,i=function(){n("update:show",!1)},o=g({attachmentUrl:w((function(){return"/platform/runtime/dfs/viewpage/index.html?metadataId="+t.attachmentId+"&rootId="+t.rootId+"&fileType=2"})),show:!1});return function(){return r("div",null,[r(a("fm-popup"),{show:t.show,style:"width:100%;height:100%"},{default:function(){return[r(a("fm-navbar"),{title:t.title,onClickLeft:i},null),r("iframe",{class:"pdf-iframe",scrolling:"yes",src:t.path||o.attachmentUrl,width:"100%",height:"100%"},null)]}})])}}}),Ie=!1;function Me(){var t=g({show:!1}),e=function(e){t.show=e},n=function(n){Object.assign(t,n),Ie||(window.MOBILE_ORIGIN_BACK&&window.MOBILE_ORIGIN_BACK.pushOriginGoback(Pe),Ie=!0),window.top&&window.top!==window.self&&Le(window.top.document),Le(window.document),b((function(){e(!0)}))},a=function(){e(!1),window.MOBILE_ORIGIN_BACK&&window.MOBILE_ORIGIN_BACK.popOriginGoback(),window.top&&window.top!==window.self&&Ue(window.top.document),Ue(window.document),ke&&ke(),Fe=void 0};return function(t){var e=F();e&&Object.assign(e.proxy,t)}({open:n,close:a,toggle:e}),{open:n,close:a,state:t,toggle:e}}var Se=function(){var t=function(t){var e=A(t);e.use(B).use(q);var n=document.createElement("div");return document.body.appendChild(n),{instance:e.mount(n),unmount:function(){e.unmount(n),document.body.removeChild(n)}}}({setup:function(){var t=Me(),e=t.state,n=t.toggle;return function(){return r(Ce,Yt({},e,{"onUpdate:show":n}),null)}}});Fe=t.instance,ke=t.unmount};function Pe(){Ie=!1,Fe.close()}function Be(t){if("undefined"!=typeof window)return Fe||Se(),Fe.open(t),Fe}function Le(t){var e=t.getElementsByName("viewport")[0],n=t.createElement("meta");n.name="viewport",n.content="width=device-width, initial-scale=1.0";var a=t.getElementsByTagName("head")[0];e&&a.removeChild(e),a.appendChild(n)}function Ue(t){var e=t.getElementsByName("viewport")[0],n=t.createElement("meta");n.name="viewport",n.content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=n";var a=t.getElementsByTagName("head")[0];e&&a.removeChild(e),a.appendChild(n)}Be.close=function(){Fe&&Fe.toggle(!1)},Be.show=function(t){return Be(t)},Be.install=function(t){t.component(Ce.name,Ce)},Be.Component=Ce;var Ne={name:"el-amap",props:["viewMode","skyColor","rotateEnable","pitch","buildingAnimation","pitchEnable","vid","events","center","zoom","draggEnable","level","zooms","lang","defaultCursor","crs","animateEnable","isHotspot","defaultLayer","resizeEnable","showIndoorMap","indoorMap","expandZoomRange","dragEnable","zoomEnable","doubleClickZoom","keyboardEnable","jogEnable","scrollWheel","touchZoom","mapStyle","plugin","features","amapManager","markers"],setup:function(t,e){var n=this,a=e.emit;e.attrs,e.slots;var i=k(null),o=g({converters:{center:function(t){if("[object Array]"===Object.prototype.toString.call(t)&&t[0]&&t[1])return new AMap.LngLat(t[0],t[1])}},$amap:"",$amapComponent:"",loadPromise:null,circleMarker:"",plugins:w((function(){var e=[],n=/^AMap./,a=function(t){return n.test(t)?t:"AMap."+t},i=function(t){return t.replace(n,"")};return"string"==typeof t.plugin?e.push({pName:a(t.plugin),sName:i(t.plugin)}):t.plugin instanceof Array&&(e=t.plugin.map((function(t){var e={};return"string"==typeof t?e={pName:a(t),sName:i(t)}:(t.pName=a(t.pName),t.sName=i(t.pName),e=t),e}))),e}))});C((function(){o.loadPromise=ne.load()})),I((function(){return t.center}),(function(t,e){if(o.$amapComponent){var n=o.$amapComponent;n.setCenter(t),a("setCircleMarker",t,n)}})),y((function(){l()})),M((function(){o.$amap.destroy()}));var l=function(){o.loadPromise.then((function(){var e=i.value.querySelector(".el-vue-amap"),n=t.vid||ie();(e.id=n,o.$amap=o.$amapComponent=new AMap.Map(n,r()),t.amapManager&&t.amapManager.setMap(o.$amap),o.plugins&&o.plugins.length)&&(new ae).addPlugins(o.$amapComponent,o.plugins);t.events&&Object.keys(t.events).forEach((function(e){AMap.event.addListener(o.$amapComponent,e,t.events[e])})),a("afterInit",t.center,o.$amapComponent)}))},r=function(){var e={};return o.$amap&&(e.map=o.$amap),Object.keys(t).reduce((function(n,a){var i=a,o=s(i,t[i]);return void 0===o||(e[i]=o),n}),e)},s=function(t,e){return o.converters&&o.converters[t]?o.converters[t].call(n,e):e};return{el:i,state:o,createMap:l,convertProps:r,convertSignalProp:s}}},De=p("data-v-958f0908");e("data-v-958f0908");var Oe={ref:"el",class:"el-vue-amap-container"},Te=r("div",{class:"el-vue-amap"},null,-1);n();var Re=De((function(t,e,n,a,l,r){return i(),o("div",Oe,[Te,S(t.$slots,"default")],512)}));st(".el-vue-amap-container[data-v-958f0908] {\n  height: 100%; }\n  .el-vue-amap-container[data-v-958f0908] .el-vue-amap {\n    height: 100%; }\n"),Ne.render=Re,Ne.__scopeId="data-v-958f0908",Ne.__file="src/business/map/src/busi-map.vue";var Ee=[Ne],Ve={initAMapApiLoader:function(t){ne||(ne||(ne=new ee(t)),ne.load())},AMapManager:le};Ve.install=function(t){Ve.installed||(t.config.optionMergeStrategies.deferredReady=t.config.optionMergeStrategies.created,Ee.map((function(e){t.component(e.name,e),Ve[function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var a=oe.apply(oe,e);return a.charAt(0).toUpperCase()+a.slice(1)}(e.name).replace(/^El/,"")]=e})))};var ze=t({name:"fm-map",components:{},inject:{mapService:{default:null}},props:{width:{type:String,default:"100%"},height:{type:String,default:"400px"},zoomEnable:{type:Boolean,default:!0},dragEnable:{type:Boolean,default:!0},resizeEnable:{type:Boolean,default:!0},zoom:{type:Number,default:12},center:{type:Array,default:function(){return[0,0]}},markers:{type:Array,default:function(){return[]}},limitCity:{type:String,default:"山东"},limitSearch:{type:Boolean,default:!1},showSearch:{type:Boolean,default:!1},mapKey:{type:String,default:"ee46e4ad4d6e45789dc9f2754271e2a6"},displayDireaction:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},created:function(){Ve.initAMapApiLoader({key:this.mapKey,plugin:["AMap.Autocomplete","AMap.PlaceSearch","AMap.Scale","AMap.OverView","AMap.Geolocation","AMap.ToolBar","AMap.MapType","AMap.PolyEditor","AMap.CircleEditor","AMap.Geocoder"],v:"1.4.4"})},mounted:function(){},unmounted:function(){this.mapMarkers&&this.mapMarkers.length&&this.emptyMarkers()},data:function(){var t=this,e=this;return{amapManager:new le,subject:null,mapMarkers:[],defaultCenter:[0,0],events:{init:function(e){t.addMarkers(t.markers,e)},zoomchange:function(){t.$emit("zoomChange")},click:function(e){var n=new AMap.Geocoder({radius:1e3,extensions:"all"}),a=t,i="";n.getAddress([e.lnglat.lng,e.lnglat.lat],(function(t,n){"complete"===t&&"OK"===n.info&&n&&n.regeocode&&(i=n.regeocode.formattedAddress,e.address=i,a.$emit("markMap",e))}))}},plugin:[{pName:"Scale",events:{init:function(t){}}},{pName:"Geolocation",events:{init:function(t){}},noGeoLocation:1,enableHighAccuracy:!1,timeout:1e4,maximumAge:0,convert:!0,showButton:!e.center||0==e.center[0]||0==e.center[1],buttonPosition:"LB",showMarker:!0,showCircle:!0,panToLocation:!0,zoomToAccuracy:!0}],markerEvents:{click:function(e){t.$emit("clickMaker",e)},dragend:function(e){t.$emit("dragMarkerEnd",e)}},defaultMarkers:[],mapCenter:""}},watch:{markers:function(t){window.AMap&&t&&this.resetMarkers(t)}},computed:{computedMarkers:function(){return this.markers?this.markers.length?this.markers:this.defaultMarkers:[]},computedCenter:function(){return this.center||this.defaultCenter}},methods:{getPosition:function(){this.mapService.getCurrentLocation()},afterInit:function(t,e){(this.addMarkers(this.markers,e),"[object Array]"===Object.prototype.toString.call(this.center)&&this.center[0]&&this.center[1])&&new AMap.CircleMarker({center:t,radius:10,strokeColor:"white",strokeWeight:2,strokeOpacity:.5,fillColor:"rgba(30,144,255)",fillOpacity:.5,zIndex:10,bubble:!0,cursor:"pointer",clickable:!0}).setMap(e);this.resetMarkers(this.markers)},getCurrentLocation:function(){},onSearchResult:function(t){},getCenter:function(){return this.$refs.map.$$getCenter()},getCurrentPosition:function(){},addMarkers:function(t,e){var n=t.map((function(t){return new AMap.Marker({position:t.position})}));this.mapMarkers=[].concat(n),this.mapMarkers.forEach((function(t){e.add(t)}))},removeMarkers:function(){},emptyMarkers:function(){this.amapManager.getMap().remove(this.mapMarkers),this.mapMarkers.splice(0,this.mapMarkers.length)},resetMarkers:function(t){this.emptyMarkers(),this.addMarkers(t,this.amapManager.getMap())}}});st(".farris-mobile-map {\n  width: 100%;\n  height: 450px; }\n\n.amap-logo {\n  visibility: hidden; }\n\n.amap-scalecontrol {\n  visibility: hidden !important; }\n\n.amap-copyright {\n  visibility: hidden !important; }\n"),ze.render=function(t,e,n,l,s,c){var d=a("el-amap");return i(),o("div",null,[r("div",{style:{width:t.width,height:t.height}},[r(d,{ref:"map",vid:"amapDemo",resizeEnable:t.resizeEnable,dragEnable:t.dragEnable,zoomEnable:t.zoomEnable,center:t.center,zoom:t.zoom,plugin:t.plugin,events:t.events,amapManager:t.amapManager,onAfterInit:t.afterInit,onSetCircleMarker:t.afterInit},null,8,["resizeEnable","dragEnable","zoomEnable","center","zoom","plugin","events","amapManager","onAfterInit","onSetCircleMarker"])],4)])},ze.__file="src/business/map/src/map.vue",ze.install=function(t){t.component(ze.name,ze).use(Ve)};var We={install:function(t){t.config.globalProperties.$filterAttachment=function(t,e,n,a){return void 0===a&&(a=!0),H(t,e,n,a)},t.config.globalProperties.$filterMap=function(t,e,n){return _(t,e,n)}}},je=t({name:"approval-logs",props:{dataId:{type:String,required:!0},title:{type:String,default:"审批记录"},visiavle:{type:Boolean,default:!0}},setup:function(t){var e=P(t).dataId,n=function(){if(e.value){var t=document.getElementById("approval-logs-container"),n="/platform/runtime/wf/webapp/mobiletaskcenter/taskComment.js";n=n+"?version="+(""+(new Date).getTime()),System.import(n).then((function(){var n={bizInstId:e.value,procInstId:"",isIncludeHistory:!1};window.gspTaskCenterBizLog.ApprovalLogUtil.getBizlogHtml(n,t)}))}};return y(n),I(e,n),{}}}),He={key:0,class:"fm-tmpl-struct-wrapper",id:"section-83f5062"},_e={class:"fm-tmpl-section fm-tmpl-section-form"},qe={class:"fm-tmpl-section-header"},Ge={class:"fm-title"},Ke={class:"fm-title-text"},Xe=r("div",{id:"approval-logs-container"},null,-1);je.render=function(t,e,n,a,l,s){return t.visiavle?(i(),o("div",He,[r("div",_e,[r("div",qe,[r("div",Ge,[r("span",Ke,v(t.title),1)])]),Xe])])):c("v-if",!0)},je.__file="src/business/approval-logs/approval-logs.vue",je.install=function(t){t.component(je.name,je)};var Ze=[Gt,re,$,mt,Ot,Ae,je,ze,We,Be],Je=function(t){Ze.forEach((function(e){t.use(e)}))},Ye={install:Je};export default Ye;export{je as ApprovalLogs,$ as Attachment,Ot as AttachmentEntry,mt as AttachmentFile,Be as AttachmentPreview,re as BusinessAttachment,ze as BusinessMap,Gt as BusinessVerifyCode,We as FarrisBusinessPlugin,Ae as SubmitApprove,Je as install};
