!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@farris/ui-modal"),require("rxjs"),require("lodash-es"),require("@farris/ui-input-group"),require("@angular/forms"),require("@angular/common"),require("@farris/ui-messager"),require("@farris/ui-locale"),require("@angular/core"),require("@farris/ui-common"),require("@farris/ui-perfect-scrollbar"),require("@farris/ui-lookup")):"function"==typeof define&&define.amd?define("@farris/ui-enum-editor",["exports","@farris/ui-modal","rxjs","lodash-es","@farris/ui-input-group","@angular/forms","@angular/common","@farris/ui-messager","@farris/ui-locale","@angular/core","@farris/ui-common","@farris/ui-perfect-scrollbar","@farris/ui-lookup"],e):e((t.farris=t.farris||{},t.farris["ui-enum-editor"]={}),t.i1,t.rxjs,t.lodashEs,t.uiInputGroup,t.ng.forms,t.ng.common,t.uiMessager,t.i2,t.ng.core,t.uiCommon,t.uiPerfectScrollbar,t.uiLookup)}(this,function(t,e,r,i,n,o,a,s,l,u,c,d,p){"use strict";var h=function(t,e){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function f(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),a=[];try{for(;(void 0===e||0<e--)&&!(o=i.next()).done;)a.push(o.value)}catch(s){r={error:s}}finally{try{o&&!o.done&&(n=i["return"])&&n.call(i)}finally{if(r)throw r.error}}return a}function m(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(f(arguments[e]));return t}var y=(v.prototype.ngOnChanges=function(t){},v.prototype.ngOnInit=function(){},v.prototype.insertCondition=function(t){var e=Object.assign({},this.newEnumData);0===t?this.data.unshift(e):this.data.splice(t,0,e),this.changeConditionList()},v.prototype.remove=function(t){this.data.splice(t,1),this.changeConditionList(),this.currentEnumData&&t===this.currentEnumData.index&&(this.currentEnumData=null)},v.prototype.onAddFilter=function(){this.data=m(this.data,[Object.assign({},this.newEnumData)]),this.changeConditionList(),this.itemIntoView()},v.prototype.onClear=function(){var t=this;this.messagerService.question(this.localeSer.getValue("enumEditor.message"),function(){t.data=[],t.currentEnumData=null,t.changeConditionList()})},v.prototype.onMoveTop=function(){this.currentEnumData&&(this.data.unshift(this.currentEnumData.data),this.data.splice(this.currentEnumData.index+1,1),this.currentEnumData.index=0,this.changeConditionList())},v.prototype.onMovePrev=function(){var t;if(this.currentEnumData){var e=this.currentEnumData.index,n=this.data.splice(e,1);(t=this.data).splice.apply(t,m([e-1,0],n)),this.currentEnumData.index=e-1,this.changeConditionList()}},v.prototype.onMoveNext=function(){var t;if(this.currentEnumData){var e=this.currentEnumData.index,n=this.data.splice(e,1);(t=this.data).splice.apply(t,m([e+1,0],n)),this.currentEnumData.index=e+1,this.changeConditionList()}},v.prototype.onMoveBottom=function(){this.currentEnumData&&(this.data.push(this.currentEnumData.data),this.data.splice(this.currentEnumData.index,1),this.currentEnumData.index=this.data.length-1,this.changeConditionList())},v.prototype.itemIntoView=function(){var e=this;this.tablebodybox&&setTimeout(function(){var t=e.tablebodybox.nativeElement.querySelector("tbody tr:last-child");t&&(t.scrollIntoViewIfNeeded?t.scrollIntoViewIfNeeded(!1):t.scrollIntoView({block:"nearest"}))},50)},v.prototype.changeConditionList=function(){this.dataChange.next(this.data)},v.prototype.selected=function(t){this.currentEnumData=t},v.prototype.isSelected=function(t){return!!this.currentEnumData&&this.currentEnumData.index===t},v.decorators=[{type:u.Component,args:[{selector:"farris-enum-editor",template:'\x3c!-- <div class="table-header ">\r\n    <table class="table table-bordered" style="margin-bottom: 0">\r\n        <thead>\r\n            <tr>\r\n                <th style="width: 42px"></th>\r\n                <th><b>{{\'enumEditor.value\'| locale}}</b></th>\r\n                <th><b>{{\'enumEditor.name\'| locale}}</b></th>\r\n            </tr>\r\n        </thead>\r\n    </table>\r\n</div> --\x3e\r\n<div style="\r\n    border-top: 1px solid  white;\r\n    position: absolute;\r\n    top: 0;\r\n    width: 100%;\r\n    z-index: 2;\r\n"></div>\r\n<div class="table-body flex-fill win11Scroll show nobtn " style="margin-left:14px; margin-right: 0; overflow-y: scroll;" #tablebodybox>\r\n    \x3c!-- <perfect-scrollbar [config]="{}"> --\x3e\r\n        <table class="table table-bordered" #tbl>\r\n            <thead style="position: sticky; top: 0; z-index: 1;">\r\n                <tr>\r\n                    <th style="width: 42px"></th>\r\n                    <th><b>{{\'enumEditor.value\'| locale}}</b></th>\r\n                    <th><b>{{\'enumEditor.name\'| locale}}</b></th>\r\n                </tr>\r\n            </thead>\r\n            <tbody>\r\n                <tr *ngFor="let item of data; let index=index;" (click)="selected({\'index\':index, \'data\': item})" [class.selected]="isSelected(index)" >\r\n                    <td style="width: 42px">\r\n                        <button type="button" class="btn btn-link" (click)="remove(index)">\r\n                            <span class="f-icon f-icon-close" style="color: red"></span>\r\n                        </button>\r\n                    </td>\r\n                    <td>\r\n                        <input type="text" style="width:100%" autocomplete="off" placeholder="" class="k-textbox" [(ngModel)]="item[valueField]">\r\n                    </td>\r\n                    <td>\r\n                        <input type="text" style="width:100%" placeholder="" autocomplete="off" class="k-textbox" [(ngModel)]="item[textField]">\r\n                    </td>\r\n                </tr>\r\n            </tbody>\r\n        </table>\r\n    \x3c!-- </perfect-scrollbar> --\x3e\r\n</div>\r\n<div style="flex-shrink: 0; margin: 0 14px;">\r\n<enum-editor-footer\r\n[showSortBtns]="showSortBtns"\r\n(addFilter)="onAddFilter()"\r\n(clearFilter)="onClear()"\r\n(moveTop)="onMoveTop()"\r\n(movePrev)="onMovePrev()"\r\n(moveNext)="onMoveNext()"\r\n(moveBottom)="onMoveBottom()"></enum-editor-footer>\r\n</div>'}]}],v.ctorParameters=function(){return[{type:u.ElementRef},{type:u.Renderer2},{type:s.MessagerService},{type:l.LocaleService}]},v.propDecorators={data:[{type:u.Input}],columns:[{type:u.Input}],textField:[{type:u.Input}],valueField:[{type:u.Input}],dataChange:[{type:u.Output}],tablebodybox:[{type:u.ViewChild,args:["tablebodybox"]}],cls:[{type:u.HostBinding,args:["class"]}],overflow:[{type:u.HostBinding,args:["style.overflow"]}],height:[{type:u.HostBinding,args:["style.height"]}],showSortBtns:[{type:u.Input}]},v);function v(t,e,n,o){var r;this.el=t,this.render=e,this.messagerService=n,this.localeSer=o,this.data=[],this.columns=[],this.textField="name",this.valueField="value",this.dataChange=new u.EventEmitter,this.cls="d-flex flex-column flex-fill",this.overflow="hidden",this.height="100%",this.showSortBtns=!0,this.currentEnumData=null,this.newEnumData=((r={})[this.textField]="",r[this.valueField]="",r)}var g={array:0,object:1};g[g.array]="array",g[g.object]="object";var b=(x.prototype.showDialog=function(t,e){var n=this;void 0===t&&(t=[]),void 0===e&&(e={}),t=this.toJSON(t);var o=this.cfr.resolveComponentFactory(y);this.enumEditorRef=o.create(this.injector),this.enumEditorRef.instance.data=t,this.originalData=i.cloneDeep(t),this.textField=e.textField||"name",this.valueField=e.valueField||"value",this.outType=e.outType||g.array,e.showSortBtns=this.outType===g.array,this.dlgRef=this.modalService.show(this.enumEditorRef,{width:800,height:500,title:this.localeService.getValue("enumEditor.title"),enableScroll:!1,minHeight:398,minWidth:798,iconCls:"f-icon f-icon-top_developmenttool",buttons:[{text:this.localeService.getValue("enumEditor.cancelButton"),cls:"btn btn-outline-secondary",handle:function(){n.cancel()}},{text:this.localeService.getValue("enumEditor.okButton"),cls:"btn btn-primary",handle:function(){n.save()}}],initialState:e,dialogFooterStyles:{background:"#F4F6F9"},buttonAlign:"right",closed:function(t){t&&n.cancel()}}),this.enumEditorRef.instance.height=this.dlgRef.dialog.instance.getContainerSize().height,this.dlgRef.dialog.instance.resized.subscribe(function(t){n.enumEditorRef.instance.height=t.containerHeight}),this.enumEditorRef.changeDetectorRef.detectChanges(),this.dlgRef.dialog.changeDetectorRef.reattach()},x.prototype.cancel=function(){this._dataChanged(this.originalData),this.dlgRef.close()},x.prototype.save=function(){var t=this.enumEditorRef.instance.data;this._dataChanged(t),this.dlgRef.close()},x.prototype._dataChanged=function(t){var e=this.toString(t);this.dataChanged.next(e)},x.prototype.toString=function(t){var n=this;if(t&&t.length){if(this.outType===g.array)return JSON.stringify(t);var e=t.reduce(function(t,e){return t[e[n.valueField]]=e[n.textField],t},{});return JSON.stringify(e)}return""},x.prototype.toJSON=function(t){var e=[];if(t)if("string"==typeof t)try{e=JSON.parse(t),this.outType===g.object&&(e=this.convertObject2Array(e))}catch(n){e=[]}else e=Array.isArray(t)?t:this.convertObject2Array(t);return e},x.prototype.convertObject2Array=function(n){var o=this,r=[];return Object.keys(n).forEach(function(t){var e;r.push(((e={})[o.valueField]=t,e[o.textField]=n[t],e))}),r},x.decorators=[{type:u.Injectable,args:[{providedIn:"root"}]}],x.ctorParameters=function(){return[{type:u.Injector},{type:u.ComponentFactoryResolver},{type:e.BsModalService},{type:l.LocaleService}]},x.ngInjectableDef=u.defineInjectable({factory:function(){return new x(u.inject(u.INJECTOR),u.inject(u.ComponentFactoryResolver),u.inject(e.BsModalService),u.inject(l.LocaleService))},token:x,providedIn:"root"}),x);function x(t,e,n,o){this.injector=t,this.cfr=e,this.modalService=n,this.localeService=o,this.enumEditorRef=null,this.dlgRef=null,this.originalData=[],this.textField="name",this.valueField="value",this.outType=g.array,this.dataChanged=new r.Subject}var E=(w.prototype.ngOnInit=function(){},w.prototype.onAddFilter=function(){this.addFilter.emit()},w.prototype.onClear=function(){this.clearFilter.emit()},w.prototype.onMoveTop=function(){this.moveTop.emit()},w.prototype.onMovePrev=function(){this.movePrev.emit()},w.prototype.onMoveNext=function(){this.moveNext.emit()},w.prototype.onMoveBottom=function(){this.moveBottom.emit()},w.prototype.canUse=function(){return!!this.grid.currentEnumData&&1<this.grid.data.length},w.prototype.canMoveUp=function(){return!!this.canUse()&&0<this.grid.currentEnumData.index},w.prototype.canMoveDown=function(){return!!this.canUse()&&this.grid.currentEnumData.index<this.grid.data.length-1},w.decorators=[{type:u.Component,args:[{selector:"enum-editor-footer",template:'\n    <div class="footer-container px-2" style="height: 36px;">\n        <button type="button" (click)="onAddFilter()"\n            class="k-button k-button-icontext k-flat "><span class="k-icon k-i-add"></span> {{ \'enumEditor.addWhere\' | locale }}</button>\n        <button type="button" (click)="onClear()" [disabled]="!grid.data.length"\n            class="k-button k-button-icontext k-flat "><span class="k-icon k-i-delete"></span> {{ \'enumEditor.clear\' | locale }}</button>\n        <ng-container *ngIf="showSortBtns">\n            <button type="button" [disabled]="!canMoveUp()" (click)="onMoveTop()"\n            class="k-button k-button-icontext k-flat "><span class="k-icon k-i-arrow-end-up"></span>\n            {{\'enumEditor.moveTop\' | locale }}</button>\n        <button type="button" [disabled]="!canMoveUp()" (click)="onMovePrev()"\n            class="k-button k-button-icontext k-flat "><span class="k-icon k-i-arrow-60-up"></span>\n            {{\'enumEditor.moveUp\' | locale }}</button>\n        <button type="button" [disabled]="!canMoveDown()" (click)="onMoveNext()"\n            class="k-button k-button-icontext k-flat "><span class="k-icon k-i-arrow-60-down"></span>\n            {{\'enumEditor.moveDown\' | locale }}</button>\n        <button type="button" [disabled]="!canMoveDown()" (click)="onMoveBottom()"\n            class="k-button k-button-icontext k-flat"><span class="k-icon k-i-arrow-end-down"></span>\n            {{\'enumEditor.moveBottom\' | locale }}</button>\n            </ng-container>\n    </div>\n    '}]}],w.ctorParameters=function(){return[{type:y}]},w.propDecorators={cls:[{type:u.HostBinding,args:["class"]}],showSortBtns:[{type:u.Input}],addFilter:[{type:u.Output}],clearFilter:[{type:u.Output}],moveTop:[{type:u.Output}],movePrev:[{type:u.Output}],moveNext:[{type:u.Output}],moveBottom:[{type:u.Output}]},w);function w(t){this.grid=t,this.cls="f-filter-footer",this.showSortBtns=!0,this.addFilter=new u.EventEmitter,this.clearFilter=new u.EventEmitter,this.moveTop=new u.EventEmitter,this.movePrev=new u.EventEmitter,this.moveNext=new u.EventEmitter,this.moveBottom=new u.EventEmitter}var C,k={provide:o.NG_VALUE_ACCESSOR,useExisting:u.forwardRef(function(){return S}),multi:!0},S=(function O(t,e){function n(){this.constructor=t}h(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(D,C=p.LookupComponent),D.prototype.updateData=function(t){this.value=t,this.cd&&this.cd.detectChanges(),this.valueChange.emit(t),this.onModelChange(t),this.onModelTouched(t)},D.prototype.ngOnInit=function(){},D.prototype.showDialog=function(){var t=this.convertValue2JSON();this.ees.showDialog(t,{textField:this.textField,valueField:this.valueField,outType:this.outType})},D.prototype.onClear=function(t){this.updateData("")},D.prototype.writeValue=function(t){this.value=t&&"object"==typeof t?JSON.stringify(t):t||""},D.prototype.convertValue2JSON=function(){return this.ees.toJSON(this.value)},D.decorators=[{type:u.Component,args:[{selector:"enum-editor-input",template:'\n    <input-group #ig style="width: 100%"\n        [groupText]="groupIcon"\n        (clear)="onClear($event)"\n        (clickHandle)="showDialog()"\n        [readonly] = "readonly"\n        [editable] = "editable"\n        [enableClear] = "enableClear"\n        [(value)]="value">\n    </input-group>\n    ',providers:[k,b]}]}],D.ctorParameters=function(){return[{type:u.Injector},{type:b},{type:u.ElementRef}]},D.propDecorators={value:[{type:u.Input}],textField:[{type:u.Input}],valueField:[{type:u.Input}],outType:[{type:u.Input}],enableClear:[{type:u.Input}],valueChange:[{type:u.Output}],inputGroupRef:[{type:u.ViewChild,args:["ig"]}]},D);function D(t,e,n){var o=C.call(this,t,n)||this;return o.injector=t,o.ees=e,o.el=n,o.textField="name",o.valueField="value",o.outType=g.array,o.enableClear=!0,o.valueChange=new u.EventEmitter,o.groupIcon='<i class="f-icon f-icon-lookup"></i>',o.cd=null,o.ees.dataChanged.subscribe(function(t){o.updateData(t)}),o.cd=o.injector.get(u.ChangeDetectorRef,null),o}var F=(M.forRoot=function(){return{ngModule:M,providers:[b]}},M.decorators=[{type:u.NgModule,args:[{declarations:[y,S,E],imports:[a.CommonModule,o.FormsModule,n.InputGroupModule,c.FarrisCommonModule,s.MessagerModule.forRoot(),d.PerfectScrollbarModule,p.LookupModule,l.LocaleModule],entryComponents:[y],exports:[y,S]}]}],M);function M(){}t.EnumOutType=g,t.EnumEditorService=b,t.EnumEditorComponent=y,t.EnumEditorFooterComponent=E,t.ENUM_EDITOR_VALUE_ACCESSOR=k,t.EnumEditorInputComponent=S,t.EnumEditorModule=F,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=farris-ui-enum-editor.umd.min.js.map