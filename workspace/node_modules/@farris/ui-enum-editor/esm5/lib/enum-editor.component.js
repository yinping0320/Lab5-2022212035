/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
import { LocaleService } from '@farris/ui-locale';
import { Component, ElementRef, Input, Output, Renderer2, ViewChild, EventEmitter, HostBinding } from '@angular/core';
import { MessagerService } from '@farris/ui-messager';
var EnumEditorComponent = /** @class */ (function () {
    function EnumEditorComponent(el, render, messagerService, localeSer) {
        var _a;
        this.el = el;
        this.render = render;
        this.messagerService = messagerService;
        this.localeSer = localeSer;
        /**
         * enum data
         */
        this.data = [];
        this.columns = [];
        this.textField = 'name';
        this.valueField = 'value';
        this.dataChange = new EventEmitter();
        this.cls = 'd-flex flex-column flex-fill';
        this.overflow = 'hidden';
        this.height = '100%';
        this.showSortBtns = true;
        this.currentEnumData = null;
        this.newEnumData = (_a = {},
            _a[this.textField] = '',
            _a[this.valueField] = '',
            _a);
    }
    /**
     * @param {?} changes
     * @return {?}
     */
    EnumEditorComponent.prototype.ngOnChanges = /**
     * @param {?} changes
     * @return {?}
     */
    function (changes) {
    };
    /**
     * @return {?}
     */
    EnumEditorComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
    };
    /**
     * @param {?} index
     * @return {?}
     */
    EnumEditorComponent.prototype.insertCondition = /**
     * @param {?} index
     * @return {?}
     */
    function (index) {
        /** @type {?} */
        var newEnumData = Object.assign({}, this.newEnumData);
        if (index === 0) {
            this.data.unshift(newEnumData);
        }
        else {
            this.data.splice(index, 0, newEnumData);
        }
        this.changeConditionList();
    };
    /**
     * @param {?} index
     * @return {?}
     */
    EnumEditorComponent.prototype.remove = /**
     * @param {?} index
     * @return {?}
     */
    function (index) {
        this.data.splice(index, 1);
        this.changeConditionList();
        if (this.currentEnumData) {
            if (index === this.currentEnumData.index) {
                this.currentEnumData = null;
            }
        }
    };
    /**
     * @return {?}
     */
    EnumEditorComponent.prototype.onAddFilter = /**
     * @return {?}
     */
    function () {
        this.data = tslib_1.__spread(this.data, [Object.assign({}, this.newEnumData)]);
        this.changeConditionList();
        this.itemIntoView();
    };
    /**
     * @return {?}
     */
    EnumEditorComponent.prototype.onClear = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this.messagerService.question(this.localeSer.getValue('enumEditor.message'), (/**
         * @return {?}
         */
        function () {
            _this.data = [];
            _this.currentEnumData = null;
            _this.changeConditionList();
        }));
    };
    /**
     * @return {?}
     */
    EnumEditorComponent.prototype.onMoveTop = /**
     * @return {?}
     */
    function () {
        if (this.currentEnumData) {
            this.data.unshift(this.currentEnumData.data);
            this.data.splice(this.currentEnumData.index + 1, 1);
            this.currentEnumData.index = 0;
            this.changeConditionList();
        }
    };
    /**
     * @return {?}
     */
    EnumEditorComponent.prototype.onMovePrev = /**
     * @return {?}
     */
    function () {
        var _a;
        if (this.currentEnumData) {
            /** @type {?} */
            var index = this.currentEnumData.index;
            /** @type {?} */
            var tempArr = this.data.splice(index, 1);
            (_a = this.data).splice.apply(_a, tslib_1.__spread([index - 1, 0], tempArr));
            this.currentEnumData.index = index - 1;
            this.changeConditionList();
        }
    };
    /**
     * @return {?}
     */
    EnumEditorComponent.prototype.onMoveNext = /**
     * @return {?}
     */
    function () {
        var _a;
        if (this.currentEnumData) {
            /** @type {?} */
            var index = this.currentEnumData.index;
            /** @type {?} */
            var tempArr = this.data.splice(index, 1);
            (_a = this.data).splice.apply(_a, tslib_1.__spread([index + 1, 0], tempArr));
            this.currentEnumData.index = index + 1;
            this.changeConditionList();
        }
    };
    /**
     * @return {?}
     */
    EnumEditorComponent.prototype.onMoveBottom = /**
     * @return {?}
     */
    function () {
        if (this.currentEnumData) {
            this.data.push(this.currentEnumData.data);
            this.data.splice(this.currentEnumData.index, 1);
            this.currentEnumData.index = this.data.length - 1;
            this.changeConditionList();
        }
    };
    /**
     * @private
     * @return {?}
     */
    EnumEditorComponent.prototype.itemIntoView = /**
     * @private
     * @return {?}
     */
    function () {
        var _this = this;
        if (this.tablebodybox) {
            setTimeout((/**
             * @return {?}
             */
            function () {
                /** @type {?} */
                var tr = _this.tablebodybox.nativeElement.querySelector('tbody tr:last-child');
                if (tr) {
                    if (tr.scrollIntoViewIfNeeded) {
                        tr.scrollIntoViewIfNeeded(false);
                    }
                    else {
                        tr.scrollIntoView({ block: 'nearest' });
                    }
                }
            }), 50);
        }
    };
    /**
     * @private
     * @return {?}
     */
    EnumEditorComponent.prototype.changeConditionList = /**
     * @private
     * @return {?}
     */
    function () {
        this.dataChange.next(this.data);
    };
    /**
     * @param {?} $event
     * @return {?}
     */
    EnumEditorComponent.prototype.selected = /**
     * @param {?} $event
     * @return {?}
     */
    function ($event) {
        // console.log($event);
        this.currentEnumData = $event;
    };
    /**
     * @param {?} $event
     * @return {?}
     */
    EnumEditorComponent.prototype.isSelected = /**
     * @param {?} $event
     * @return {?}
     */
    function ($event) {
        if (this.currentEnumData) {
            return this.currentEnumData.index === $event;
        }
        return false;
    };
    EnumEditorComponent.decorators = [
        { type: Component, args: [{
                    selector: 'farris-enum-editor',
                    template: "<!-- <div class=\"table-header \">\r\n    <table class=\"table table-bordered\" style=\"margin-bottom: 0\">\r\n        <thead>\r\n            <tr>\r\n                <th style=\"width: 42px\"></th>\r\n                <th><b>{{'enumEditor.value'| locale}}</b></th>\r\n                <th><b>{{'enumEditor.name'| locale}}</b></th>\r\n            </tr>\r\n        </thead>\r\n    </table>\r\n</div> -->\r\n<div style=\"\r\n    border-top: 1px solid  white;\r\n    position: absolute;\r\n    top: 0;\r\n    width: 100%;\r\n    z-index: 2;\r\n\"></div>\r\n<div class=\"table-body flex-fill win11Scroll show nobtn \" style=\"margin-left:14px; margin-right: 0; overflow-y: scroll;\" #tablebodybox>\r\n    <!-- <perfect-scrollbar [config]=\"{}\"> -->\r\n        <table class=\"table table-bordered\" #tbl>\r\n            <thead style=\"position: sticky; top: 0; z-index: 1;\">\r\n                <tr>\r\n                    <th style=\"width: 42px\"></th>\r\n                    <th><b>{{'enumEditor.value'| locale}}</b></th>\r\n                    <th><b>{{'enumEditor.name'| locale}}</b></th>\r\n                </tr>\r\n            </thead>\r\n            <tbody>\r\n                <tr *ngFor=\"let item of data; let index=index;\" (click)=\"selected({'index':index, 'data': item})\" [class.selected]=\"isSelected(index)\" >\r\n                    <td style=\"width: 42px\">\r\n                        <button type=\"button\" class=\"btn btn-link\" (click)=\"remove(index)\">\r\n                            <span class=\"f-icon f-icon-close\" style=\"color: red\"></span>\r\n                        </button>\r\n                    </td>\r\n                    <td>\r\n                        <input type=\"text\" style=\"width:100%\" autocomplete=\"off\" placeholder=\"\" class=\"k-textbox\" [(ngModel)]=\"item[valueField]\">\r\n                    </td>\r\n                    <td>\r\n                        <input type=\"text\" style=\"width:100%\" placeholder=\"\" autocomplete=\"off\" class=\"k-textbox\" [(ngModel)]=\"item[textField]\">\r\n                    </td>\r\n                </tr>\r\n            </tbody>\r\n        </table>\r\n    <!-- </perfect-scrollbar> -->\r\n</div>\r\n<div style=\"flex-shrink: 0; margin: 0 14px;\">\r\n<enum-editor-footer\r\n[showSortBtns]=\"showSortBtns\"\r\n(addFilter)=\"onAddFilter()\"\r\n(clearFilter)=\"onClear()\"\r\n(moveTop)=\"onMoveTop()\"\r\n(movePrev)=\"onMovePrev()\"\r\n(moveNext)=\"onMoveNext()\"\r\n(moveBottom)=\"onMoveBottom()\"></enum-editor-footer>\r\n</div>"
                }] }
    ];
    /** @nocollapse */
    EnumEditorComponent.ctorParameters = function () { return [
        { type: ElementRef },
        { type: Renderer2 },
        { type: MessagerService },
        { type: LocaleService }
    ]; };
    EnumEditorComponent.propDecorators = {
        data: [{ type: Input }],
        columns: [{ type: Input }],
        textField: [{ type: Input }],
        valueField: [{ type: Input }],
        dataChange: [{ type: Output }],
        tablebodybox: [{ type: ViewChild, args: ['tablebodybox',] }],
        cls: [{ type: HostBinding, args: ['class',] }],
        overflow: [{ type: HostBinding, args: ['style.overflow',] }],
        height: [{ type: HostBinding, args: ['style.height',] }],
        showSortBtns: [{ type: Input }]
    };
    return EnumEditorComponent;
}());
export { EnumEditorComponent };
if (false) {
    /**
     * enum data
     * @type {?}
     */
    EnumEditorComponent.prototype.data;
    /** @type {?} */
    EnumEditorComponent.prototype.columns;
    /** @type {?} */
    EnumEditorComponent.prototype.textField;
    /** @type {?} */
    EnumEditorComponent.prototype.valueField;
    /** @type {?} */
    EnumEditorComponent.prototype.dataChange;
    /** @type {?} */
    EnumEditorComponent.prototype.tablebodybox;
    /** @type {?} */
    EnumEditorComponent.prototype.cls;
    /** @type {?} */
    EnumEditorComponent.prototype.overflow;
    /** @type {?} */
    EnumEditorComponent.prototype.height;
    /** @type {?} */
    EnumEditorComponent.prototype.showSortBtns;
    /** @type {?} */
    EnumEditorComponent.prototype.currentEnumData;
    /**
     * @type {?}
     * @private
     */
    EnumEditorComponent.prototype.newEnumData;
    /**
     * @type {?}
     * @private
     */
    EnumEditorComponent.prototype.el;
    /**
     * @type {?}
     * @private
     */
    EnumEditorComponent.prototype.render;
    /**
     * @type {?}
     * @private
     */
    EnumEditorComponent.prototype.messagerService;
    /**
     * @type {?}
     * @private
     */
    EnumEditorComponent.prototype.localeSer;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZW51bS1lZGl0b3IuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGZhcnJpcy91aS1lbnVtLWVkaXRvci8iLCJzb3VyY2VzIjpbImxpYi9lbnVtLWVkaXRvci5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQSxPQUFPLEVBQUUsYUFBYSxFQUFFLE1BQU0sbUJBQW1CLENBQUM7QUFDbEQsT0FBTyxFQUFFLFNBQVMsRUFBRSxVQUFVLEVBQUUsS0FBSyxFQUFFLE1BQU0sRUFDekMsU0FBUyxFQUFFLFNBQVMsRUFBNEIsWUFBWSxFQUFFLFdBQVcsRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUNyRyxPQUFPLEVBQUUsZUFBZSxFQUFFLE1BQU0scUJBQXFCLENBQUM7QUFJdEQ7SUErQkksNkJBQW9CLEVBQWMsRUFBVSxNQUFpQixFQUFVLGVBQWdDLEVBQ25GLFNBQXdCOztRQUR4QixPQUFFLEdBQUYsRUFBRSxDQUFZO1FBQVUsV0FBTSxHQUFOLE1BQU0sQ0FBVztRQUFVLG9CQUFlLEdBQWYsZUFBZSxDQUFpQjtRQUNuRixjQUFTLEdBQVQsU0FBUyxDQUFlOzs7O1FBeEJuQyxTQUFJLEdBQVEsRUFBRSxDQUFDO1FBQ2YsWUFBTyxHQUF1QyxFQUFFLENBQUM7UUFFakQsY0FBUyxHQUFHLE1BQU0sQ0FBQztRQUNuQixlQUFVLEdBQUcsT0FBTyxDQUFDO1FBRXBCLGVBQVUsR0FBRyxJQUFJLFlBQVksRUFBRSxDQUFDO1FBSXBCLFFBQUcsR0FBRyw4QkFBOEIsQ0FBQztRQUM1QixhQUFRLEdBQUcsUUFBUSxDQUFDO1FBQ3RCLFdBQU0sR0FBRyxNQUFNLENBQUM7UUFFcEMsaUJBQVksR0FBRyxJQUFJLENBQUM7UUFFN0Isb0JBQWUsR0FBaUMsSUFBSSxDQUFDO1FBRTdDLGdCQUFXO1lBQ2YsR0FBQyxJQUFJLENBQUMsU0FBUyxJQUFHLEVBQUU7WUFDcEIsR0FBQyxJQUFJLENBQUMsVUFBVSxJQUFHLEVBQUU7Z0JBQ3ZCO0lBRzhDLENB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a0NBQTJEOztJQUMzRCx1Q0FBbUQ7O0lBQ25ELHFDQUE2Qzs7SUFFN0MsMkNBQTZCOztJQUU3Qiw4Q0FBcUQ7Ozs7O0lBRXJELDBDQUdFOzs7OztJQUVVLGlDQUFzQjs7Ozs7SUFBRSxxQ0FBeUI7Ozs7O0lBQUUsOENBQXdDOzs7OztJQUMzRix3Q0FBZ0MiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBMb2NhbGVTZXJ2aWNlIH0gZnJvbSAnQGZhcnJpcy91aS1sb2NhbGUnO1xyXG5pbXBvcnQgeyBDb21wb25lbnQsIEVsZW1lbnRSZWYsIElucHV0LCBPdXRwdXQsIE9uSW5pdCxcclxuICAgIFJlbmRlcmVyMiwgVmlld0NoaWxkLCBPbkNoYW5nZXMsIFNpbXBsZUNoYW5nZXMsIEV2ZW50RW1pdHRlciwgSG9zdEJpbmRpbmcgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgTWVzc2FnZXJTZXJ2aWNlIH0gZnJvbSAnQGZhcnJpcy91aS1tZXNzYWdlcic7XHJcblxyXG5cclxuXHJcbkBDb21wb25lbnQoe1xyXG4gICAgc2VsZWN0b3I6ICdmYXJyaXMtZW51bS1lZGl0b3InLFxyXG4gICAgdGVtcGxhdGVVcmw6ICcuL2VudW0tZWRpdG9yLmNvbXBvbmVudC5odG1sJyxcclxuICAgIHN0eWxlczogW11cclxufSlcclxuZXhwb3J0IGNsYXNzIEVudW1FZGl0b3JDb21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQsIE9uQ2hhbmdlcyB7XHJcblxyXG4gICAgLyoqIGVudW0gZGF0YSAqL1xyXG4gICAgQElucHV0KCkgZGF0YTogYW55ID0gW107XHJcbiAgICBASW5wdXQoKSBjb2x1bW5zOiB7IGxhYmVsOiBzdHJpbmcsIHZhbHVlOiBzdHJpbmcgfVtdID0gW107XHJcblxyXG4gICAgQElucHV0KCkgdGV4dEZpZWxkID0gJ25hbWUnO1xyXG4gICAgQElucHV0KCkgdmFsdWVGaWVsZCA9ICd2YWx1ZSc7XHJcblxyXG4gICAgQE91dHB1dCgpIGRhdGFDaGFuZ2UgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XHJcblxyXG4gICAgQFZpZXdDaGlsZCgndGFibGVib2R5Ym94JykgdGFibGVib2R5Ym94OiBFbGVtZW50UmVmO1xyXG5cclxuICAgIEBIb3N0QmluZGluZygnY2xhc3MnKSBjbHMgPSAnZC1mbGV4IGZsZXgtY29sdW1uIGZsZXgtZmlsbCc7XHJcbiAgICBASG9zdEJpbmRpbmcoJ3N0eWxlLm92ZXJmbG93Jykgb3ZlcmZsb3cgPSAnaGlkZGVuJztcclxuICAgIEBIb3N0QmluZGluZygnc3R5bGUuaGVpZ2h0JykgaGVpZ2h0ID0gJzEwMCUnO1xyXG5cclxuICAgIEBJbnB1dCgpIHNob3dTb3J0QnRucyA9IHRydWU7XHJcblxyXG4gICAgY3VycmVudEVudW1EYXRhOiB7IGluZGV4OiBudW1iZXIsIGRhdGE6IGFueSB9ID0gbnVsbDtcclxuXHJcbiAgICBwcml2YXRlIG5ld0VudW1EYXRhOiBhbnkgPSB7XHJcbiAgICAgICAgW3RoaXMudGV4dEZpZWxkXTogJycsXHJcbiAgICAgICAgW3RoaXMudmFsdWVGaWVsZF06ICcnXHJcbiAgICB9O1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKHByaXZhdGUgZWw6IEVsZW1lbnRSZWYsIHByaXZhdGUgcmVuZGVyOiBSZW5kZXJlcjIsIHByaXZhdGUgbWVzc2FnZXJTZXJ2aWNlOiBNZXNzYWdlclNlcnZpY2UsXHJcbiAgICAgICAgICAgICAgICBwcml2YXRlIGxvY2FsZVNlcjogTG9jYWxlU2VydmljZSkgeyB9XHJcblxyXG4gICAgbmdPbkNoYW5nZXMoY2hhbmdlczogU2ltcGxlQ2hhbmdlcykge1xyXG4gICAgfVxyXG5cclxuICAgIG5nT25Jbml0KCkge1xyXG4gICAgfVxyXG5cclxuICAgIGluc2VydENvbmRpdGlvbihpbmRleDogbnVtYmVyKSB7XHJcbiAgICAgICAgY29uc3QgbmV3RW51bURhdGEgPSBPYmplY3QuYXNzaWduKHt9LCB0aGlzLm5ld0VudW1EYXRhKTtcclxuICAgICAgICBpZiAoaW5kZXggPT09IDApIHtcclxuICAgICAgICAgICAgdGhpcy5kYXRhLnVuc2hpZnQobmV3RW51bURhdGEpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuZGF0YS5zcGxpY2UoaW5kZXgsIDAsIG5ld0VudW1EYXRhKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuY2hhbmdlQ29uZGl0aW9uTGlzdCgpO1xyXG4gICAgfVxyXG5cclxuICAgIHJlbW92ZShpbmRleDogbnVtYmVyKSB7XHJcbiAgICAgICAgdGhpcy5kYXRhLnNwbGljZShpbmRleCwgMSk7XHJcbiAgICAgICAgdGhpcy5jaGFuZ2VDb25kaXRpb25MaXN0KCk7XHJcblxyXG4gICAgICAgIGlmICh0aGlzLmN1cnJlbnRFbnVtRGF0YSkge1xyXG4gICAgICAgICAgICBpZiAoaW5kZXggPT09IHRoaXMuY3VycmVudEVudW1EYXRhLmluZGV4KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRFbnVtRGF0YSA9IG51bGw7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgb25BZGRGaWx0ZXIoKSB7XHJcbiAgICAgICAgdGhpcy5kYXRhID0gWy4uLnRoaXMuZGF0YSwgT2JqZWN0LmFzc2lnbih7fSwgdGhpcy5uZXdFbnVtRGF0YSldO1xyXG4gICAgICAgIHRoaXMuY2hhbmdlQ29uZGl0aW9uTGlzdCgpO1xyXG4gICAgICAgIHRoaXMuaXRlbUludG9WaWV3KCk7XHJcbiAgICB9XHJcblxyXG4gICAgb25DbGVhcigpIHtcclxuICAgICAgICB0aGlzLm1lc3NhZ2VyU2VydmljZS5xdWVzdGlvbih0aGlzLmxvY2FsZVNlci5nZXRWYWx1ZSgnZW51bUVkaXRvci5tZXNzYWdlJyksICgpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5kYXRhID0gW107XHJcbiAgICAgICAgICAgIHRoaXMuY3VycmVudEVudW1EYXRhID0gbnVsbDtcclxuICAgICAgICAgICAgdGhpcy5jaGFuZ2VDb25kaXRpb25MaXN0KCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgb25Nb3ZlVG9wKCkge1xyXG4gICAgICAgIGlmICh0aGlzLmN1cnJlbnRFbnVtRGF0YSkge1xyXG4gICAgICAgICAgICB0aGlzLmRhdGEudW5zaGlmdCh0aGlzLmN1cnJlbnRFbnVtRGF0YS5kYXRhKTtcclxuICAgICAgICAgICAgdGhpcy5kYXRhLnNwbGljZSh0aGlzLmN1cnJlbnRFbnVtRGF0YS5pbmRleCArIDEsIDEpO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5jdXJyZW50RW51bURhdGEuaW5kZXggPSAwO1xyXG4gICAgICAgICAgICB0aGlzLmNoYW5nZUNvbmRpdGlvbkxpc3QoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgb25Nb3ZlUHJldigpIHtcclxuICAgICAgICBpZiAodGhpcy5jdXJyZW50RW51bURhdGEpIHtcclxuICAgICAgICAgICAgY29uc3QgaW5kZXggPSB0aGlzLmN1cnJlbnRFbnVtRGF0YS5pbmRleDtcclxuICAgICAgICAgICAgY29uc3QgdGVtcEFyciA9IHRoaXMuZGF0YS5zcGxpY2UoaW5kZXgsIDEpO1xyXG4gICAgICAgICAgICB0aGlzLmRhdGEuc3BsaWNlKGluZGV4IC0gMSwgMCwgLi4udGVtcEFycik7XHJcblxyXG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRFbnVtRGF0YS5pbmRleCA9IGluZGV4IC0gMTtcclxuICAgICAgICAgICAgdGhpcy5jaGFuZ2VDb25kaXRpb25MaXN0KCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgb25Nb3ZlTmV4dCgpIHtcclxuICAgICAgICBpZiAodGhpcy5jdXJyZW50RW51bURhdGEpIHtcclxuICAgICAgICAgICAgY29uc3QgaW5kZXggPSB0aGlzLmN1cnJlbnRFbnVtRGF0YS5pbmRleDtcclxuICAgICAgICAgICAgY29uc3QgdGVtcEFyciA9IHRoaXMuZGF0YS5zcGxpY2UoaW5kZXgsIDEpO1xyXG4gICAgICAgICAgICB0aGlzLmRhdGEuc3BsaWNlKGluZGV4ICsgMSwgMCwgLi4udGVtcEFycik7XHJcblxyXG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRFbnVtRGF0YS5pbmRleCA9IGluZGV4ICsgMTtcclxuICAgICAgICAgICAgdGhpcy5jaGFuZ2VDb25kaXRpb25MaXN0KCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgb25Nb3ZlQm90dG9tKCkge1xyXG4gICAgICAgIGlmICh0aGlzLmN1cnJlbnRFbnVtRGF0YSkge1xyXG4gICAgICAgICAgICB0aGlzLmRhdGEucHVzaCh0aGlzLmN1cnJlbnRFbnVtRGF0YS5kYXRhKTtcclxuICAgICAgICAgICAgdGhpcy5kYXRhLnNwbGljZSh0aGlzLmN1cnJlbnRFbnVtRGF0YS5pbmRleCwgMSk7XHJcbiAgICAgICAgICAgIHRoaXMuY3VycmVudEVudW1EYXRhLmluZGV4ID0gdGhpcy5kYXRhLmxlbmd0aCAtIDE7XHJcbiAgICAgICAgICAgIHRoaXMuY2hhbmdlQ29uZGl0aW9uTGlzdCgpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcblxyXG4gICAgcHJpdmF0ZSBpdGVtSW50b1ZpZXcoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMudGFibGVib2R5Ym94KSB7XHJcbiAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdHIgPSB0aGlzLnRhYmxlYm9keWJveC5uYXRpdmVFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ3Rib2R5IHRyOmxhc3QtY2hpbGQnKTtcclxuICAgICAgICAgICAgICAgIGlmICh0cikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodHIuc2Nyb2xsSW50b1ZpZXdJZk5lZWRlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHIuc2Nyb2xsSW50b1ZpZXdJZk5lZWRlZChmYWxzZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ci5zY3JvbGxJbnRvVmlldyh7YmxvY2s6ICduZWFyZXN0J30pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LCA1MCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuXHJcbiAgICBwcml2YXRlIGNoYW5nZUNvbmRpdGlvbkxpc3QoKSB7XHJcbiAgICAgICAgdGhpcy5kYXRhQ2hhbmdlLm5leHQodGhpcy5kYXRhKTtcclxuICAgIH1cclxuXHJcbiAgICBzZWxlY3RlZCgkZXZlbnQpIHtcclxuICAgICAgICAvLyBjb25zb2xlLmxvZygkZXZlbnQpO1xyXG4gICAgICAgIHRoaXMuY3VycmVudEVudW1EYXRhID0gJGV2ZW50O1xyXG4gICAgfVxyXG5cclxuICAgIGlzU2VsZWN0ZWQoJGV2ZW50OiBudW1iZXIpIHtcclxuICAgICAgICBpZiAodGhpcy5jdXJyZW50RW51bURhdGEpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuY3VycmVudEVudW1EYXRhLmluZGV4ID09PSAkZXZlbnQ7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuXHJcbn1cclxuIl19