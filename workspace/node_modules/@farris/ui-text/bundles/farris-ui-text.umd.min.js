!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/forms"),require("@farris/ui-common"),require("@angular/core"),require("@angular/common"),require("@farris/ui-locale"),require("@farris/ui-common/number"),require("@farris/ui-common/date")):"function"==typeof define&&define.amd?define("@farris/ui-text",["exports","@angular/forms","@farris/ui-common","@angular/core","@angular/common","@farris/ui-locale","@farris/ui-common/number","@farris/ui-common/date"],e):e((t.farris=t.farris||{},t.farris["ui-text"]={}),t.ng.forms,t.uiCommon,t.ng.core,t.ng.common,t.uiLocale,t.number,t.date)}(this,function(t,e,n,o,i,s,r,a){"use strict";var u=(p.decorators=[{type:o.Injectable,args:[{providedIn:"root"}]}],p.ctorParameters=function(){return[]},p.ngInjectableDef=o.defineInjectable({factory:function(){return new p},token:p,providedIn:"root"}),p);function p(){}var h=(Object.defineProperty(l.prototype,"showType",{get:function(){return this._tshowType},set:function(t){4==(this._tshowType=t)&&(this.dateRange=!0)},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"value",{get:function(){return this.text},set:function(t){this.text=this.formatValue(t),this.textChange.emit(this.text)},enumerable:!0,configurable:!0}),l.prototype.changeTitle=function(t){this.isTextArea||this.isPassword||this.mouseEnterChangeTitle()},Object.defineProperty(l.prototype,"option",{get:function(){return this._option},set:function(t){this._option=t},enumerable:!0,configurable:!0}),l.prototype.ngOnInit=function(){},l.prototype.ngOnDestroy=function(){},l.prototype.ngAfterViewInit=function(){if(this.isTextArea){var t=this.textInnerEl.nativeElement.parentElement.className;this.textInnerEl.nativeElement.parentElement.className=t+" f-cmp-text-is-textarea"}},l.prototype.mouseEnterChangeTitle=function(){var t=this.textInnerEl.nativeElement;2<Math.abs(t.scrollWidth-t.clientWidth)||2<Math.abs(t.scrollHeight-t.clientHeight)?this.staticTitle=this.text&&0<this.text.length?this.text:this.control:this.staticTitle=""},l.prototype.formatLang=function(t){return t&&t[this.currentLanguage]?t[this.currentLanguage]:""},l.prototype.getFormatNumberValue=function(t){if(!this.format&&!this._option)return t.toString();if(this._option&&this._option.type&&"number"==this._option.type){if(this._option.formatter)return this._option.formatter(t);this._option.useThousands?this._option.precision!=undefined?this.format="n"+this._option.precision:this.format="n2":this._option.precision!=undefined?this.format="f"+this._option.precision:this.format="f2"}var e,i=this.currencyToUpperCase(this.format.substring(0,1)),r=Number(this.format.substring(1)),n={};if(/C|D|F|N|P/g.test(i)){switch(this.thousand&&Object.assign(n,{thousand:this.thousand}),this.decimal&&Object.assign(n,{decimal:this.decimal}),this.expression&&Object.assign(n,{format:this.expression}),i){case"C":Object.assign(n,{prefix:this.currencySymbol,precision:r}),e=this.numberHelper.formatMoney(t,n);break;case"D":e=this.toDecimal(t,r);break;case"F":Object.assign(n,{prefix:"",thousand:"",precision:r}),e=this.numberHelper.formatMoney(t,n);break;case"N":Object.assign(n,{prefix:"",precision:r}),e=this.numberHelper.formatMoney(t,n);break;case"P":e=this.toPercent(t,r)}return e}this.debugSer&&this.debugSer.warn("不支持format为 "+this.format+" 类型的数字格式化")},l.prototype.toDecimal=function(t,e){if(!(-1<t.toString().indexOf(".")))return(Array(e).join(this.filledSymbol)+t).slice(-e);this.debugSer&&this.debugSer.warn("十进制转换仅限整型类型")},l.prototype.toPercent=function(t,e){return Number(100*t).toFixed(Number(e))+"%"},l.prototype.currencyToUpperCase=function(t){return t.replace(/[a-z]+/g,function(t){return t.toUpperCase()})},l.prototype.dateToUpperCase=function(t){var e;return e=!0===/Y/g.test(t)?t.replace(/Y/g,"y"):t,!0===/D/g.test(e)&&(e=e.replace(/D/g,"d")),e},l.prototype.getFormatEnumValue=function(t){var i=this;if(t==undefined||null===t||""===t)return"";if(this.data&&this.data.length){for(var r=(""+t).split(this.enumDelimiter),n=[],e=function(e){var t=o.data.find(function(t){return t[i.valueField]==r[e]});t?n.push(t[o.textField]):n.push(r[e])},o=this,s=0;s<r.length;s++)e(s);return 0<n.length?n.join(this.enumDelimiter):""}return t},l.prototype.getFormatCheckBoxValue=function(t){return!0===t?this.localeService.getValue("text.yes"):!1===t||null==t||void 0===t?this.localeService.getValue("text.no"):t},l.prototype.timeFormatTo=function(t,e,i){void 0===i&&(i=12)},l.prototype.makeFormater=function(t){return t},l.prototype.dateformat=function(t){var e=this;return this.format||(this.format="YYYY-MM-DD"),"timeago"===this.format?this.dtHelper.relativeTime(t,this.localeService.localeId||"zh-CHS"):(this.returnFormat&&"yyyy-MM-dd"!=this.returnFormat&&"string"==typeof t&&(t=this.getDateFromFormatedString(t,this.returnFormat)),"hh:mm:ss"===this.format||"HH:mm:ss"===this.format?t:this.multiSelect&&t?(["yyyy-MM-dd","yyyy/MM/dd","MM/dd/yyyy","yyyy年MM月dd日","yyyyMMdd"].find(function(t){return t===e.format})||(this.format="yyyy-MM-dd"),t.split(this.separator).map(function(t){return-1<t.indexOf("年")&&(t=t.replace("年","-")),-1<t.indexOf("月")&&(t=t.replace("月","-")),-1<t.indexOf("日")&&(t=t.replace("日","")),e.dtHelper.formatTo(t,e.dateToUpperCase(e.format))}).join(this.separator)):this.dtHelper.formatTo(t,this.dateToUpperCase(this.format)))},l.prototype.getDateFromFormatedString=function(n,t){var o={year:0,month:0,day:0,hour:0,minite:0,second:0};return n&&t.replace(/y+|Y+|M+|d+|D+|h+|H+|m+|s+/g,function(t,e,i,r){n.substring(e).replace(/\d+/,function(t){r=parseInt(t,10)}),/y+/i.test(t)&&!o.year&&(o.year=r),/M+/.test(t)&&!o.month&&(o.month=r),/d+/i.test(t)&&!o.day&&(o.day=r),/h+/i.test(t)&&!o.hour&&(o.hour=r),/m+/.test(t)&&!o.minite&&(o.minite=r),/s+/.test(t)&&!o.second&&(o.second=r)}),new Date(o.year+"/"+o.month+"/"+o.day+" "+o.hour+":"+o.minite+":"+o.second)},l.prototype.formatValue=function(t){var e,i=this;if(this.currentLanguage)return this.formatLang(t);if("boolean"!==this.type&&(null==t||void 0===t))return"";switch(this.type){case"string":e=t;break;case"date":case"datetime":if(this.dateRange){var r=t.split(this.dateRangeDelimiter),n=[];r&&r.length&&r.forEach(function(t){var e=i.dateformat(t);n.push(e)}),e=n.join(this.dateRangeDelimiter)}else e=this.dateformat(t);break;case"number":e=this.getFormatNumberValue(t);break;case"enum":e=this.getFormatEnumValue(t);break;case"boolean":e=this.getFormatCheckBoxValue(t)}return e},l.prototype.setText2Star=function(t){if(this.isPassword){var e=t?"******":"";return this.text=e,this.control=e,!0}return!1},l.prototype.writeValue=function(t){if(!this.setText2Star(t)){if(this.beforeWriteValue){var e={localizationType:this.localizationType,showTime:this.showTime,ref:this},i=this.beforeWriteValue(t,e);if(i!==undefined)return void(this.text=i)}this.control=this.formatValue(t),this.controlChange(t)}},l.prototype.registerOnChange=function(t){this.controlChange=t},l.prototype.registerOnTouched=function(t){this.controlTouch=t},l.decorators=[{type:o.Component,args:[{selector:"farris-text",template:"\n        <span #textInner\n            [ngClass]=\"{'f-form-control-text':!isTextArea,'f-form-control-textarea':isTextArea,'f-component-text-auto-size': this.autoSize}\"\n            [title]=\"staticTitle\" [style.text-align]=\"textAlign\"\n            [style.height]=\"!autoSize&&height>0?height+'px':null\" [style.minHeight]=\"autoSize&&height>0?height+'px':null\"\n            [style.maxHeight]=\"autoSize&&maxHeight>0?maxHeight+'px':null\">{{text && text.length > 0 ?  text : control}}</span>\n    ",providers:[{provide:e.NG_VALUE_ACCESSOR,useExisting:o.forwardRef(function(){return l}),multi:!0}]}]}],l.ctorParameters=function(){return[{type:a.DateTimeHelperService},{type:r.NumberHelperService},{type:o.Injector},{type:o.NgZone}]},l.propDecorators={cls:[{type:o.HostBinding,args:["class.f-component-text"]}],textInnerEl:[{type:o.ViewChild,args:["textInner",{read:o.ElementRef}]}],textChange:[{type:o.Output}],isPassword:[{type:o.Input}],isTextArea:[{type:o.Input}],autoSize:[{type:o.Input}],maxHeight:[{type:o.Input}],height:[{type:o.Input}],type:[{type:o.Input}],dateRange:[{type:o.Input}],format:[{type:o.Input}],lang:[{type:o.Input}],data:[{type:o.Input}],thousand:[{type:o.Input}],decimal:[{type:o.Input}],expression:[{type:o.Input}],currentLanguage:[{type:o.Input}],showTime:[{type:o.Input}],textField:[{type:o.Input}],valueField:[{type:o.Input}],returnFormat:[{type:o.Input}],textAlign:[{type:o.Input}],dateRangeDelimiter:[{type:o.Input}],enumDelimiter:[{type:o.Input}],showType:[{type:o.Input}],localizationType:[{type:o.Input}],filledSymbol:[{type:o.Input}],value:[{type:o.Input}],changeTitle:[{type:o.HostListener,args:["mouseenter",["$event"]]}],showTitle:[{type:o.Input}],option:[{type:o.Input}],multiSelect:[{type:o.Input}],separator:[{type:o.Input}]},l);function l(t,e,i,r){this.dtHelper=t,this.numberHelper=e,this.injector=i,this.ngzone=r,this.cls=!0,this.textChange=new o.EventEmitter,this.isPassword=!1,this.isTextArea=!1,this.autoSize=!1,this.height=0,this.dateRange=!1,this.thousand=",",this.decimal=".",this.expression="%s%v",this.textField="name",this.valueField="value",this.returnFormat="",this.dateRangeDelimiter="~",this.enumDelimiter=",",this._tshowType=0,this.currencySymbol="￥",this.filledSymbol="0",this.staticTitle="",this.showTitle=!1,this.multiSelect=!1,this.separator=",",this.beforeWriteValue=null,this.controlChange=function(t){},this.controlTouch=function(t){},this.debugSer=null,this.localeService=this.injector.get(s.LocaleService),this.debugSer=this.injector.get(n.DebugService,null)}var c=(m.decorators=[{type:o.NgModule,args:[{declarations:[h],imports:[i.CommonModule,s.LocaleModule,r.NumberHelperModule,a.DateHelperModule],exports:[h]}]}],m);function m(){}t.StaticTextControlService=u,t.TextComponent=h,t.TextModule=c,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=farris-ui-text.umd.min.js.map