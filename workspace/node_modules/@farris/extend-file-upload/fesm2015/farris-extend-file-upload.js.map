{"version":3,"file":"farris-extend-file-upload.js","sources":["ng://@farris/extend-file-upload/lib/service/f-file-upload-api.service.ts","ng://@farris/extend-file-upload/lib/model/f-file-upload.model.ts","ng://@farris/extend-file-upload/lib/model/column.model.ts","ng://@farris/extend-file-upload/lib/locale.ts","ng://@farris/extend-file-upload/lib/utils/f-file.utils.ts","ng://@farris/extend-file-upload/lib/service/f-file-uploader.service.ts","ng://@farris/extend-file-upload/lib/service/f-file-upload-default.service.ts","ng://@farris/extend-file-upload/lib/directive/f-file-drop.directive.ts","ng://@farris/extend-file-upload/lib/directive/f-file-select.directive.ts","ng://@farris/extend-file-upload/lib/directive/f-file-preview.directive.ts","ng://@farris/extend-file-upload/lib/directive/f-file-upload.directive.ts","ng://@farris/extend-file-upload/lib/pipe/index.ts","ng://@farris/extend-file-upload/lib/components/view-image/f-file-view-image.component.ts","ng://@farris/extend-file-upload/lib/components/upload/f-file-upload.component.ts","ng://@farris/extend-file-upload/lib/components/preview/f-file-preview.component.ts","ng://@farris/extend-file-upload/lib/components/preview-checkbox/preview-checkbox.component.ts","ng://@farris/extend-file-upload/lib/components/multi-download-info/multi-download-info.component.ts","ng://@farris/extend-file-upload/lib/components/upload-and-preview/upload-and-preview.component.ts","ng://@farris/extend-file-upload/lib/components/upload-progress/upload-progress.component.ts","ng://@farris/extend-file-upload/lib/components/upload-and-preview/file-order-drag.directive.ts","ng://@farris/extend-file-upload/lib/f-file-upload.module.ts"],"sourcesContent":["import { Injectable, Optional, Inject, InjectionToken } from '@angular/core';\r\nimport { UploadInput, UploadConfig } from '../model/index';\r\n\r\n\r\nexport interface FFileUploadServerConfig extends UploadConfig {\r\n    upload?: UploadInput | null;\r\n    remove?: UploadInput | null;\r\n}\r\n\r\nexport const FFileUploadAPIServiceToken = new InjectionToken<FFileUploadServerConfig>('MFFileUploadServerConfig');\r\n\r\n@Injectable({\r\n    providedIn: 'root'\r\n})\r\nexport class FFileUploadAPIService {\r\n    private config: FFileUploadServerConfig;\r\n    private commonAPI: UploadInput;\r\n    private apiArray = ['upload','remove'];\r\n    constructor(@Optional() @Inject(FFileUploadAPIServiceToken) exConfig: FFileUploadServerConfig) {\r\n\r\n        this.config = { upload: null,  remove: null };\r\n        this.commonAPI = { type: 'config', url: '', timeout: 0, headers: null, data: {} };\r\n        if (exConfig) {\r\n            for (const key in this.commonAPI) {\r\n                if (exConfig.hasOwnProperty(key)) {\r\n                    this.commonAPI[key] = exConfig[key];\r\n                }\r\n            }\r\n        }\r\n        this.apiArray.forEach(item => {\r\n            this.config[item] = Object.assign({}, this.commonAPI);\r\n            if (exConfig && exConfig.hasOwnProperty(item)) {\r\n                if (exConfig[item].hasOwnProperty('url')) {\r\n                    this.config[item] = Object.assign({}, this.config[item], exConfig[item], { url: this.combinUrl(exConfig[item].url) });\r\n                }\r\n            }\r\n        });\r\n\r\n        // if (exConfig) {\r\n        //     Object.assign(this.config, exConfig);\r\n        // }\r\n    }\r\n    private combinUrl(typeUrl) {\r\n        let result = typeUrl;\r\n        result = this.commonAPI.url + typeUrl;\r\n        return result;\r\n    }\r\n    /**\r\n     * 获取API定义\r\n     */\r\n    getAPI() {\r\n        return this.config;\r\n    }\r\n    /**\r\n     * \r\n     * @param type \r\n     * @param object \r\n     */\r\n    getAssignAPI(type, object) {\r\n        // removeAll,uploadAll 用于内部传递使用，应当传递的是remove和upload对应的参数\r\n        // 通过设置对应关系\r\n        const infoMap = { 'removeAll': 'remove', 'uploadAll': 'upload','multipartUpload':'upload' };\r\n        if(infoMap.hasOwnProperty(type)){\r\n            type=infoMap[type];\r\n        }\r\n        if (this.config[type] && object) {\r\n            return Object.assign({}, this.config[type], object);\r\n        }\r\n        if (this.config[type]) {\r\n            return this.config[type];\r\n        }\r\n        if (object) {\r\n            return object;\r\n        }\r\n        return null;\r\n\r\n    }\r\n}\r\n","import { Subscription, Observable } from 'rxjs';\r\n\r\nexport interface UploaderOptions {\r\n    concurrency?: number;\r\n    allowedContentTypes?: string[];\r\n    maxUploads?: number;\r\n    maxFileSize?: number;//MB为单位\r\n    uploadedCount?: number;\r\n}\r\n\r\nexport interface BlobFile extends Blob {\r\n    name: string;\r\n}\r\n\r\nexport enum UploadStatus {\r\n    Queue,\r\n    Uploading,\r\n    Done,\r\n    Cancelled,\r\n    Remove,// 正在删除\r\n    Error\r\n}\r\n\r\nexport interface UploadProgress {\r\n    status: UploadStatus;\r\n    data?: {\r\n        percentage: number;\r\n        speed?: number;\r\n        speedHuman?: string;\r\n        startTime?: number | null;\r\n        endTime?: number | null;\r\n        eta?: number | null;\r\n        etaHuman?: string | null;\r\n    };\r\n}\r\nexport interface FUploadFileExtend {\r\n    id: string;\r\n    name: string;\r\n    disabled?: boolean;\r\n    checked?: boolean;\r\n    size?: number | undefined;//文件大小\r\n    createTime?: string | undefined;//创建日期\r\n    type?: string;\r\n    extend?: any | null;//记录返回数据\r\n    extendStatus?: number;\r\n    extendHeaders?: { [key: string]: string } | null;\r\n    showDownload?: boolean;\r\n    showComments?:boolean;// 预览是否显示修订记录\r\n    modeless?:boolean;//预览是否在非模态框\r\n}\r\n\r\nexport interface UploadFile {\r\n    id: string;\r\n    fileIndex: number;\r\n    lastModifiedDate: Date;\r\n    name: string;\r\n    size: number;\r\n    type: string;\r\n    form: FormData;\r\n    progress: UploadProgress;//\r\n    response?: any;//记录返回数据\r\n    responseStatus?: number;\r\n    sub?: Subscription | any;\r\n    nativeFile?: File;\r\n    responseHeaders?: { [key: string]: string };\r\n}\r\n\r\n\r\nexport interface UploadOutput {\r\n    type: 'addedToQueue' | 'allAddedToQueue' | 'uploading' | 'done' | 'start' | 'cancelled' | 'dragOver'\r\n    | 'dragOut' | 'drop' | 'removed' | 'allRemoved' | 'rejected' | 'allDone' | 'allStart' | 'allCancelled' | 'error';\r\n    file?: UploadFile;\r\n    nativeFile?: File;\r\n    message?: String;\r\n    files?: UploadFile[];\r\n}\r\nexport interface UploadConfig {\r\n    url?: string;\r\n    method?: string;// POST，GET \r\n    id?: string;\r\n    fieldName?: string;\r\n    fileIndex?: number;\r\n    file?: UploadFile;\r\n    data?: {\r\n        [key: string]: any,\r\n        extProperty?: DocMetaProperty | null //\r\n    };\r\n    headers?: { [key: string]: string } | null;\r\n    includeWebKitFormBoundary?: boolean; // If false, only the file is send trough xhr.send (WebKitFormBoundary is omit)\r\n    withCredentials?: boolean;\r\n    timeout?: number;// 暂不支持\r\n}\r\n\r\nexport interface UploadInput extends UploadConfig {\r\n    type: 'upload' | 'uploadAll' | 'cancel' | 'cancelAll' | 'remove' | 'removeAll' | 'config' | 'hide' | 'multipartUpload' | 'sliceUpload';\r\n    /** 分块上传时，每块大小默认为 1M */\r\n    chunkSize?: number\r\n}\r\n\r\n\r\nexport abstract class UploadServerService {\r\n    constructor() {\r\n\r\n    }\r\n    abstract upload(files: UploadFile[], event: UploadInput, extendService: any): Observable<any>;\r\n    abstract remove(files: UploadFile[], event: UploadInput, extendService: any): Observable<any>;\r\n    abstract multipartUpload(file: UploadFile, event: UploadInput, extendService: any): Observable<any>;\r\n}\r\n\r\nexport interface DocMetaProperty {\r\n    extProperties1?: string;\r\n    extProperties2?: string;\r\n    extProperties3?: string;\r\n    extProperties4?: string;\r\n    extProperties5?: string;\r\n}\r\n\r\n","import { TemplateRef } from \"@angular/core\";\r\n\r\nexport interface ColumnFormatter {\r\n    type?: 'datetime' | 'number' | 'enum' | 'image' | 'boolean' | 'boolean2' | 'timeago';\r\n    options?: any;\r\n}\r\n\r\ntype ColumnFormatterFn = (column, rowData, otherCtx) => any;\r\n/**\r\n * 附件展示列信息\r\n * formatter：格式化\r\n */\r\nexport interface ColumnData{\r\n    field:string;\r\n    width:number;\r\n    title:string;\r\n    checkbox?:boolean;\r\n    formatter?:ColumnFormatterFn| ColumnFormatterFn;\r\n    template?:TemplateRef<any>;\r\n}","export const FARRIS_UPLOADFILE_LOCALEDATA = {\r\n    en: {\r\n        uploadAndPreview: {\r\n            downloadTitle: 'Download Files',\r\n            downloadCount: '{0} files in total.',\r\n            ok: 'Ok',\r\n            cancel: 'Cancel',\r\n            uploadSelectText: 'Select Files',\r\n            newName: 'New name',\r\n            filesCount: '<span class=\"count\">{0}</span> files in total.',\r\n            selectCount: '（<span class=\"count-selected\">{0}</span> files selected.）',\r\n            download: 'Download',\r\n            delete: 'Delete',\r\n            authMsg: 'You are not authorized to operate attachments',\r\n            nofiles: 'No attachment information',\r\n            uploading: 'Uploading...',\r\n            uploadSuccess: 'Upload succeeded',\r\n            successed: 'Uploaded',\r\n            supportType: 'Support Type',\r\n            maxSize: 'Maximum size of a single file',\r\n            maxFileCount: 'Maximum number of files',\r\n            maxCountShow:' files',\r\n            notAallowedChars: 'Characters not allowed in attachment names',\r\n            columns: {\r\n                name: 'File name',\r\n                size: 'Size',\r\n                createTime: 'Date',\r\n                state: 'Status',\r\n                action: 'Action'\r\n            },\r\n            tips: {\r\n                download: 'Download',\r\n                preview: 'Preview',\r\n                remove: 'Delete',\r\n                edit: 'Edit',\r\n                notedit: 'This type of file does not support online editing'\r\n            }\r\n        },\r\n        uploadService: {\r\n            failedSameName: 'Upload failed: a file with the same name already exists',\r\n            failedType: 'Upload failed: only documents of type {0} are allowed to be uploaded',\r\n            failedName: 'Upload failed: {0} characters are not allowed in the attachment name',\r\n            failedCount: 'Upload failed: total number of files exceeds {0} limit',\r\n            failedSize: 'Upload failed: file size exceeds {0}MB limit',\r\n            failedEmpty: 'Upload failed: file not allowed to be empty',\r\n            removed: 'Deleted',                \r\n            cancelUpload:'Uploaded Canceled',\r\n            deleteSuccess:'Delete Successful'\r\n        },\r\n        upload: {\r\n            drop: 'Drag File Here',\r\n            select: 'Click to upload',\r\n            back: 'Return',\r\n            orText: 'or',\r\n            hasUploaded: 'Uploaded',\r\n            delText: 'Delete',\r\n            uploading: 'Uploading',\r\n            waitUpload: 'Wait',\r\n            upload: 'Upload',\r\n            remove: 'Remove',\r\n            numFile: 'files',\r\n            continueAdd: 'Continue selecting',\r\n            mutilUpload: 'Batch upload',\r\n            cancelUpload: 'Cancel upload'\r\n        },\r\n        preview: {\r\n            selectAll: 'Select All',\r\n            selected: 'Selected',\r\n            modifyName: 'Modify Name',\r\n            multiDownload: 'Batch Download'\r\n        }\r\n    },\r\n    'zh-CHS': {\r\n        uploadAndPreview: {\r\n            downloadTitle: '附件下载',\r\n            downloadCount: '等{0}个文件',\r\n            ok: '确定',\r\n            cancel: '取消',\r\n            newName: '文件名',\r\n            uploadSelectText: '上传附件',\r\n            filesCount: '共<span class=\"count\">{0}</span>个附件',\r\n            selectCount: '（已选<span class=\"count-selected\">{0}</span>个）',\r\n            download: '下载',\r\n            delete: '删除',\r\n            authMsg: '您无权操作附件',\r\n            nofiles: '无附件信息',\r\n            uploading: '正在上传...',\r\n            uploadSuccess: '上传成功',\r\n            successed: '已上传',\r\n            supportType: '支持类型',\r\n            maxSize: '单个文件限制',\r\n            maxFileCount: '文件总数限制',\r\n            maxCountShow:'个',\r\n            notAallowedChars: '附件名称中不允许包含的字符',\r\n            columns: {\r\n                name: '文件名',\r\n                size: '大小',\r\n                createTime: '日期',\r\n                state: '状态',\r\n                action: '操作'\r\n            },\r\n            tips: {\r\n                download: '下载',\r\n                preview: '预览',\r\n                remove: '删除',\r\n                edit: '编辑',\r\n                notedit: '此类型文件不支持在线编辑'\r\n            }\r\n        },\r\n        uploadService: {\r\n            failedSameName: '上传失败：已存在同名文件',\r\n            failedType: '上传失败：只允许上传{0}类型的文档',\r\n            failedName: '上传失败：附件名称中不允许{0}这些字符',\r\n            failedCount: '上传失败：文件总个数超出{0}限制',\r\n            failedSize: '上传失败：单个文件大小超出{0}MB的限制',\r\n            failedEmpty: '上传失败：不允许文件为空',\r\n            removed: '被删除',\r\n            cancelUpload:'已取消附件上传',\r\n            deleteSuccess:'删除附件成功'\r\n        },\r\n        upload: {\r\n            drop: '可将文件拖拽此处',\r\n            select: '点击上传',\r\n            back: '返回',\r\n            orText: '或',\r\n            hasUploaded: '已上传',\r\n            delText: '删除',\r\n            uploading: '上传中',\r\n            waitUpload: '待上传',\r\n            upload: '上传',\r\n            remove: '移除',\r\n            numFile: '个文件',\r\n            continueAdd: '继续添加',\r\n            mutilUpload: '批量上传',\r\n            cancelUpload: '取消上传'\r\n        },\r\n        preview: {\r\n            selectAll: '全选',\r\n            selected: '已选',\r\n            modifyName: '修改名称',\r\n            multiDownload: '批量下载'\r\n        }\r\n    },\r\n    'zh-CHT': {\r\n        uploadAndPreview: {\r\n            downloadTitle: '附件下載',\r\n            downloadCount: '等{0}個文件',\r\n            ok: '確定',\r\n            cancel: '取消',\r\n            newName: '文件名',\r\n            uploadSelectText: '上傳附件',\r\n            filesCount: '共<span class=\"count\">{0}</span>個附件',\r\n            selectCount: '（已選<span class=\"count-selected\">{0}</span>個）',\r\n            download: '下載',\r\n            delete: '刪除',\r\n            authMsg: '您無權操作附件',\r\n            nofiles: '無附件信息',\r\n            uploading: '正在上傳...',\r\n            uploadSuccess: '上傳成功',\r\n            successed: '已上傳',\r\n            supportType: '支持類型',\r\n            maxSize: '單個文件限制',\r\n            maxFileCount: '文件總數限制',\r\n            maxCountShow:'個',\r\n            notAallowedChars: '附件名稱中不允許包含的字元',\r\n            columns: {\r\n                name: '文件名',\r\n                size: '大小',\r\n                createTime: '日期',\r\n                state: '狀態',\r\n                action: '操作'\r\n            },\r\n            tips: {\r\n                download: '下載',\r\n                preview: '預覽',\r\n                remove: '删除',\r\n                edit: '編輯',\r\n                notedit: '此類型文件不支持在線編輯'\r\n            }\r\n        },\r\n        uploadService: {\r\n            failedSameName: '上傳失敗：已存在同名檔案',\r\n            failedType: '上傳失敗：只允許上傳{0}類型的檔案',\r\n            failedName: '上傳失敗：附件名稱中不允許{0}這些字元',\r\n            failedCount: '上傳失敗：檔案總個數超出{0}限制',\r\n            failedSize: '上傳失敗：單個文件大小超出 {0}mb 的限制',\r\n            failedEmpty: '上傳失敗：不允許檔案為空',\r\n            removed: '被删除',            \r\n            cancelUpload:'已取消附件上傳',\r\n            deleteSuccess:'删除附件成功'\r\n        },\r\n        upload: {\r\n            drop: '可將檔案拖拽此處',\r\n            select: '點擊上傳',\r\n            back: '返回',\r\n            orText: '或',\r\n            hasUploaded: '已上傳',\r\n            delText: '删除',\r\n            uploading: '上傳中',\r\n            waitUpload: '待上傳',\r\n            upload: '上傳',\r\n            remove: '移除',\r\n            numFile: '個檔案',\r\n            continueAdd: '繼續添加',\r\n            mutilUpload: '批量上傳',\r\n            cancelUpload: '取消上傳'\r\n        },\r\n\r\n        preview: {\r\n            selectAll: '全選',\r\n            selected: '已選',\r\n            modifyName: '修改名稱',\r\n            multiDownload: '批量下載'\r\n\r\n        }\r\n    }\r\n}","import { LocaleService } from '@farris/ui-locale';\r\nimport { UploadFile, UploadStatus, FUploadFileExtend } from '../model';\r\nimport { FARRIS_UPLOADFILE_LOCALEDATA } from '../locale';\r\nconst isObject = value => typeof value === 'object' && value !== null;\r\nconst isArray = value => Array.isArray(value);\r\nlet localSerStorage=null;\r\n// 暂时用不到\r\nconst deepCloneObject = (src) => {\r\n    if (!isObject(src)) return src;\r\n    const target = isArray(src) ? [] : {};\r\n    for (const key in src) {\r\n        if (!src.hasOwnProperty(key)) continue;\r\n        const v = src[key];\r\n        target[key] = v && isObject(v) ? deepCloneObject(v) : v;\r\n    }\r\n    return target;\r\n}\r\n\r\nconst humanizeBytes = (bytes: number): string => {\r\n    if (bytes === 0) {\r\n        return '0 Byte';\r\n    }\r\n\r\n    const k = 1024;\r\n    const sizes: string[] = ['Bytes', 'KB', 'MB', 'GB', 'TB', 'PB'];\r\n    const i: number = Math.floor(Math.log(bytes) / Math.log(k));\r\n\r\n    return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];\r\n}\r\nconst generateId = (): string => {\r\n    return Math.random().toString(36).substring(7);\r\n}\r\nconst makeUploadFile = (file: File, index: number): UploadFile => {\r\n    return {\r\n        fileIndex: index,\r\n        id: generateId(),\r\n        name: file.name,\r\n        size: file.size,\r\n        type: file.type,\r\n        form: new FormData(),\r\n        progress: {\r\n            status: UploadStatus.Queue,\r\n            data: {\r\n                percentage: 0,\r\n                speed: 0,\r\n                speedHuman: `${humanizeBytes(0)}/s`,\r\n                startTime: null,\r\n                endTime: null,\r\n                eta: null,\r\n                etaHuman: null\r\n            }\r\n        },\r\n        lastModifiedDate: new Date(file.lastModified),\r\n        sub: undefined,\r\n        nativeFile: file\r\n    };\r\n}\r\n\r\nconst allMineTypes = {\r\n    '.pdf': 'application/pdf',\r\n    '.gif': 'image/gif',\r\n    '.png': 'image/png',\r\n    '.txt': 'text/plain',\r\n    '.htm': 'text/html',\r\n    '.html': 'text/html',\r\n    '.jpe': 'image/jpeg',\r\n    '.jpeg': 'image/jpeg',\r\n    '.jpg': 'image/jpeg',\r\n    '.js': 'text/javascript,application/javascript',\r\n    '.json': 'application/json',\r\n    '.pps': 'application/vnd.ms-powerpoint',\r\n    '.ppt': 'application/vnd.ms-powerpoint',\r\n    '.doc': 'application/msword',\r\n    '.xml': 'text/xml,application/xml',\r\n    '.zip': 'aplication/zip',\r\n    '.xlsx': 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet',\r\n    '.wps': 'application/vnd.ms-works',\r\n    '.3gpp': 'audio/3gpp, video/3gpp',\r\n    '.ac3': 'audio/ac3',\r\n    '.asf': 'allpication/vnd.ms-asf',\r\n    '.au': 'audio/basic',\r\n    '.css': 'text/css',\r\n    '.csv': 'text/csv',\r\n    '.dot': 'application/msword',\r\n    '.dtd': 'application/xml-dtd',\r\n    '.dwg': 'image/vnd.dwg',\r\n    '.dxf': 'image/vnd.dxf',\r\n    '.jp2': 'image/jp2',\r\n    '.mp2': 'audio/mpeg, video/mpeg',\r\n    '.mp3': ' audio/mpeg',\r\n    '.mp4': 'audio/mp4, video/mp4',\r\n    '.mpeg': 'video/mpeg',\r\n    '.mpg': 'video/mpeg',\r\n    '.mpp': 'application/vnd.ms-project',\r\n    '.ogg': 'application/ogg, audio/ogg',\r\n    '.pot': 'application/vnd.ms-powerpoint',\r\n    '.rtf': 'application/rtf,text/rtf',\r\n    '.svf': 'image/vnd.svf',\r\n    '.tif': 'image/tiff',\r\n    '.tiff': 'image/tiff',\r\n    '.wdb': 'application/vnd.ms-works',\r\n    '.xhtml': 'application/xhtml+xml',\r\n    '.xlc': 'application/vnd.ms-excel',\r\n    '.xlm': 'application/vnd.ms-excel',\r\n    '.xls': 'application/vnd.ms-excel',\r\n    '.xlt': 'application/vnd.ms-excel',\r\n    '.xlw': 'application/vnd.ms-excel'\r\n};\r\nconst findMineTypeBySuffix = (suffix: string): string => {\r\n    if (allMineTypes.hasOwnProperty(suffix)) {\r\n        return allMineTypes[suffix];\r\n    }\r\n    return '';\r\n}\r\n\r\nconst changeUploadFileToFileExtend = (files: UploadFile[]): FUploadFileExtend[] => {\r\n    // 如果是数组\r\n    let result=[];\r\n    files.forEach(file=>{\r\n        let preExtend = { id: '', name: '', size: 0, type: '', extend: null, extendStatus: 0, extendHeaders: null } as FUploadFileExtend;\r\n        for (let resultProp in preExtend) {\r\n            let tempProp = resultProp.replace('extend', 'response');\r\n            if (file.hasOwnProperty(tempProp)) {\r\n                preExtend[resultProp] = file[tempProp];\r\n            }\r\n        }\r\n        result.push(preExtend);\r\n    });\r\n    \r\n    return result;\r\n}\r\n/**\r\n * 标记是否已处理多语言\r\n * 解决\r\n * 1、f-file-uploader.service.ts和f-file-preview.component.ts 构造函数中没有引入多语言，\r\n * 要支持多语言就必须重新编译的问题\r\n * 2、引入通用处理的类，在类中进行保存服务\r\n */\r\nconst getLocalState=(localSer:LocaleService)=>{\r\n    if(localSerStorage){\r\n        return true;\r\n    }\r\n    if(localSer&&!localSerStorage){\r\n            localSer.setLocaleData(FARRIS_UPLOADFILE_LOCALEDATA);\r\n            localSerStorage=localSer;\r\n            return true;\r\n    }\r\n    return false;\r\n}\r\n/**\r\n * 替换字符串\r\n * @param value \r\n * @param args \r\n * @returns \r\n */\r\nconst  replaceStr=(value: any, ...args: any[]):string =>{\r\n    args.forEach((v, i) => {\r\n        value = value.replace(`{${i}}`, v);\r\n    });\r\n    return value;\r\n}\r\n/**\r\n * 获取多语言数据\r\n * 某些组件没有重新生成，要支持多语言\r\n * @param key \r\n * @param replaceInfo \r\n */\r\nconst getLocalStr=(lanKey:string,replaceInfo:Array<string>=[])=>{\r\n    let result=\"\";\r\n    let defaultLocalId='zh-CHS';\r\n    if(localSerStorage){\r\n        result=localSerStorage.getValue(lanKey);\r\n    }else{\r\n        defaultLocalId= localStorage.getItem('languageCode')||'zh-CHS';\r\n    }\r\n    if(!result){\r\n    //说明前面的语言环境没有取到\r\n        result = lanKey.split('.').reduce((obj, key) => {\r\n            if (obj) {\r\n                return obj[key];\r\n            } else {\r\n                return null;\r\n            }\r\n        }, FARRIS_UPLOADFILE_LOCALEDATA[defaultLocalId]);\r\n    }\r\n    if(result&&replaceInfo.length>0){\r\n        return replaceStr(result,replaceInfo);\r\n    }\r\n    return result;\r\n}\r\n\r\n\r\nexport const FFileUtils = {\r\n    isObject,\r\n    isArray,\r\n    deepCloneObject,\r\n    humanizeBytes,\r\n    makeUploadFile,\r\n    findMineTypeBySuffix,\r\n    changeUploadFileToFileExtend,\r\n    getLocalState,\r\n    getLocalStr\r\n}","import { EventEmitter, Injector, Optional } from \"@angular/core\";\r\nimport { Observable, Subject, Subscription, of } from \"rxjs\";\r\nimport { mergeMap, finalize } from \"rxjs/operators\";\r\nimport { FFileUtils } from \"../utils/index\";\r\nimport {\r\n    UploadFile,\r\n    UploadOutput,\r\n    UploadInput,\r\n    UploadStatus,\r\n    BlobFile,\r\n    UploadServerService,\r\n    UploaderOptions,\r\n} from \"../model/index\";\r\nimport { LocaleService } from \"@farris/ui-locale\";\r\nimport { FARRIS_UPLOADFILE_LOCALEDATA } from \"../locale\";\r\n\r\nexport class FFileUploaderService {\r\n    queue: UploadFile[];\r\n    serviceEvents: EventEmitter<UploadOutput>;\r\n    uploadScheduler: Subject<{\r\n        file: UploadFile;\r\n        event: UploadInput;\r\n        files?: UploadFile[];\r\n    }>;\r\n    subs: { id: string; sub: Subscription; ids?: string[] }[];\r\n    allowedContentTypes: string[] = [\"*\"];\r\n    //默认不限制,0代表不限制 Number.POSITIVE_INFINITY\r\n    maxUploads: number = 0;\r\n    /** 单位M，默认是12M,0代表不限制 */\r\n    maxFileSize: number = 12;\r\n    concurrency: number = Number.POSITIVE_INFINITY;\r\n    uploadedCount: number = 0;\r\n    // 不允许名称中包含特殊字符\r\n    notAllowedCharsInFileName=[];\r\n    private extendServerConfig = null;\r\n    private hasLocalSer=false;\r\n    constructor(@Optional() private uploadServerSer: UploadServerService,@Optional() private inject:Injector ) {\r\n        this.queue = [];\r\n        this.serviceEvents = new EventEmitter<UploadOutput>();\r\n        // 看是否多语言服务已更新\r\n        this.hasLocalSer=FFileUtils.getLocalState(null);\r\n        // 为多语言服务赋值\r\n        if(this.inject&&!this.hasLocalSer){\r\n           this.hasLocalSer=FFileUtils.getLocalState(this.inject.get(LocaleService));\r\n        }\r\n        this.uploadScheduler = new Subject();\r\n        this.subs = [];      \r\n        this.uploadScheduler\r\n            .pipe(\r\n                mergeMap((upload) => {\r\n                    return this.serverMethod(upload);\r\n                }, this.concurrency)\r\n            )\r\n            .subscribe((uploadOutput) => {\r\n                // if (uploadOutput.type == 'removed' || uploadOutput.type == 'done') {\r\n                //   // 删除或者done移除\r\n                //   const subIndex = this.subs.findIndex(sub => sub.id === uploadOutput.file.id);\r\n                //   if (subIndex > -1 && this.subs[subIndex].sub) {\r\n                //     this.subs[subIndex].sub.unsubscribe();\r\n                //   }\r\n                //   this.subs.splice(subIndex, 1);\r\n                // }\r\n                if (uploadOutput.type == \"removed\") {\r\n                    // 事件中返回的都是\r\n                    this.queue = this.queue.filter(\r\n                        (item) => item.progress.status !== UploadStatus.Remove\r\n                    );\r\n                    if (!uploadOutput.hasOwnProperty(\"message\")) {\r\n                        uploadOutput[\"message\"] =FFileUtils.getLocalStr(\"uploadService.removed\");\r\n                    }\r\n                }\r\n                if (uploadOutput.type == \"error\") {\r\n                    // 上传失败的附件移除\r\n                    this.queue = this.queue.filter((queueItem) => {\r\n                        return (\r\n                            uploadOutput.files.findIndex((item) => queueItem.id == item.id) <\r\n                            0\r\n                        );\r\n                    });\r\n                }\r\n                this.serviceEvents.emit(uploadOutput);\r\n            });\r\n    }\r\n    setOptions(options: UploaderOptions) {\r\n        // 重置文件大小、类型、个数限制\r\n        if (options) {\r\n            for (let prop in options) {\r\n                this[prop] = options[prop];\r\n            }\r\n        }\r\n    }\r\n    handleFiles(incomingFiles: FileList): void {\r\n        const allowedIncomingFiles: File[] = [].reduce.call(\r\n            incomingFiles,\r\n            (acc: File[], checkFile: File, i: number) => {\r\n                const futureQueueLength = acc.length + this.queue.length + 1;\r\n                let judgeResult = this.rejectedReason(\r\n                    checkFile.name,\r\n                    checkFile.type,\r\n                    futureQueueLength,\r\n                    checkFile.size\r\n                );\r\n                if (judgeResult.allowed) {\r\n                    acc = acc.concat(checkFile);\r\n                } else {\r\n                    // 不符合当前文件类型或者内容超出限制，抛出事件\r\n                    const rejectedFile: UploadFile = FFileUtils.makeUploadFile(\r\n                        checkFile,\r\n                        i\r\n                    );\r\n                    this.serviceEvents.emit({\r\n                        type: \"rejected\",\r\n                        file: rejectedFile,\r\n                        message: judgeResult.message,\r\n                    });\r\n                }\r\n                return acc;\r\n            },\r\n            []\r\n        );\r\n\r\n        // 构造文件结构，并单个抛出事件\r\n        [].map.call(allowedIncomingFiles, (file: File, i: number) => {\r\n            const uploadFile: UploadFile = FFileUtils.makeUploadFile(file, i);\r\n            this.queue.push(uploadFile);\r\n            this.serviceEvents.emit({ type: \"addedToQueue\", file: uploadFile });\r\n        });\r\n\r\n        // 所有的文件都已经添加，抛出事件\r\n        this.serviceEvents.emit({ type: \"allAddedToQueue\" });\r\n    }\r\n    private rejectedReason(name, type, queuelength, size) {\r\n        let allowed = false;\r\n        let message = \"\";\r\n        // 已存在同名文件\r\n        let findDuplicateIndex = this.queue.findIndex((file) => file.name == name);\r\n        if (findDuplicateIndex > -1) {\r\n            message =FFileUtils.getLocalStr(\"uploadService.failedSameName\");\r\n        } else if (!this.isContentTypeAllowed(name)) {\r\n            message =FFileUtils.getLocalStr(\"uploadService.failedType\",[this.allowedContentTypes.join(\",\")]);\r\n        } else if(!this.isNameAllowed(name)){\r\n            let notAllowedLen=this.notAllowedCharsInFileName.length;\r\n            let tMssage='';\r\n            this.notAllowedCharsInFileName.map((notAllowItem,curIndex)=>{\r\n                tMssage +=`<b style=\"display:inline-block;margin:0 4px;min-width:8px;text-align: center;\">${notAllowItem?notAllowItem:\"&nbsp;\"}</b>`;\r\n                if(curIndex!=notAllowedLen-1){\r\n                    tMssage+=\",\"\r\n                }\r\n            });\r\n            message=FFileUtils.getLocalStr(\"uploadService.failedName\",[tMssage]);\r\n        }\r\n        else if (\r\n            this.maxUploads > 0 &&\r\n            (this.maxUploads <= this.uploadedCount ||\r\n                queuelength + this.uploadedCount > this.maxUploads)\r\n        ) {\r\n            message =FFileUtils.getLocalStr(\"uploadService.failedCount\",[this.maxUploads+'']);\r\n        } else if (!this.isFileSizeAllowed(size)) {\r\n            message =FFileUtils.getLocalStr(\"uploadService.failedSize\",[this.maxFileSize+'']);\r\n        } else if (size == 0) {\r\n            message =FFileUtils.getLocalStr(\"uploadService.failedEmpty\");\r\n        } else {\r\n            allowed = true;\r\n        }\r\n        return {\r\n            allowed,\r\n            message,\r\n        };\r\n    }\r\n    /**\r\n     * 从前端传来事件，进行服务器端方法类型判断\r\n     * @param input\r\n     */\r\n    initInputEvents(input: EventEmitter<UploadInput>): Subscription {\r\n        return input.subscribe((event: UploadInput) => {\r\n            switch (event.type) {\r\n                case 'sliceUpload':\r\n                    const _files = this.queue.filter(\r\n                        (file) => file.progress.status === UploadStatus.Queue && (!event.file || file.fileIndex === event.file.fileIndex )\r\n                    );\r\n\r\n                    if (_files.length > 0) {\r\n                        this.uploadScheduler.next({\r\n                            files: _files,\r\n                            event: event,\r\n                            file: null,\r\n                        });\r\n                    }\r\n                    break;\r\n                case \"upload\":\r\n                case \"multipartUpload\":\r\n                    const uploadFileIndex = this.queue.findIndex(\r\n                        (file) => file === event.file\r\n                    );\r\n                    if (uploadFileIndex !== -1 && event.file) {\r\n                        this.uploadScheduler.next({\r\n                            files: [this.queue[uploadFileIndex]],\r\n                            event: event,\r\n                            file: null,\r\n                        });\r\n                    }\r\n                    break;\r\n                case \"uploadAll\":\r\n                    const files = this.queue.filter(\r\n                        (file) => file.progress.status === UploadStatus.Queue\r\n                    );\r\n                    if (files.length > 0) {\r\n                        event.type = \"upload\";\r\n                        this.uploadScheduler.next({\r\n                            files: files,\r\n                            event: event,\r\n                            file: null,\r\n                        });\r\n                    }\r\n                    break;\r\n                case \"cancel\":\r\n                    const id = event.id || null;\r\n                    if (!id) {\r\n                        return;\r\n                    }\r\n                    const fileIndex = this.queue.findIndex((file) => file.id === id);\r\n                    if (fileIndex !== -1) {\r\n                        this.serviceEvents.emit({\r\n                            type: \"cancelled\",\r\n                            files: [this.queue[fileIndex]],\r\n                            message: FFileUtils.getLocalStr(\"uploadService.cancelUpload\")\r\n                        });\r\n                        this.queue.splice(fileIndex, 1);\r\n                    }\r\n                    break;\r\n                    // case 'cancel':\r\n                    // const id = event.id || null;\r\n                    // if (!id) {\r\n                    //   return;\r\n                    // }\r\n                    // const subs = this.subs.filter(sub => sub.id === id);\r\n                    // subs.forEach(sub => {\r\n                    //   if (sub.sub) {\r\n                    //     sub.sub.unsubscribe();\r\n                    //     const fileIndex = this.queue.findIndex(file => file.id === id);\r\n                    //     if (fileIndex !== -1) {\r\n                    //       this.queue[fileIndex].progress.status = UploadStatus.Cancelled;\r\n                    //       this.serviceEvents.emit({ type: 'cancelled', file: this.queue[fileIndex] });\r\n                    //     }\r\n                    //   }\r\n                    // });\r\n                    break;\r\n                // case 'cancelAll':\r\n                //   this.subs.forEach(sub => {\r\n                //     if (sub.sub) {\r\n                //       sub.sub.unsubscribe();\r\n                //     }\r\n\r\n                //     const file = this.queue.find(uploadFile => uploadFile.id === sub.id);\r\n                //     if (file) {\r\n                //       file.progress.status = UploadStatus.Cancelled;\r\n                //       this.serviceEvents.emit({ type: 'cancelled', file: file });\r\n                //     }\r\n                //   });\r\n                //   break;\r\n                case \"hide\":\r\n                    if (!event.id) {\r\n                        return;\r\n                    }\r\n                    let ids = event.id.split(\",\");\r\n                    this.queue = this.queue.filter((file) => {\r\n                        let tIndex = ids.findIndex((tId) => tId == file.id);\r\n                        return tIndex > -1 ? false : true;\r\n                    });\r\n                    break;\r\n                case \"cancelAll\":\r\n                    // 取消，直接从队列中移除，不用修改状态\r\n                    const queueFiles = this.queue.filter(\r\n                        (uploadFile) => uploadFile.progress.status === UploadStatus.Queue\r\n                    );\r\n                    if (queueFiles.length) {\r\n                        this.serviceEvents.emit({\r\n                            type: \"cancelled\",\r\n                            files: queueFiles,\r\n                            message:FFileUtils.getLocalStr(\"uploadService.cancelUpload\"),\r\n                        });\r\n                        this.queue = this.queue.filter(\r\n                            (uploadFile) => uploadFile.progress.status != UploadStatus.Queue\r\n                        );\r\n                    }\r\n                    break;\r\n                case \"remove\":\r\n                    if (!event.id) {\r\n                        return;\r\n                    }\r\n                    const removeIndex = this.queue.findIndex(\r\n                        (file) => file.id === event.id\r\n                    );\r\n                    if (removeIndex !== -1) {\r\n                        // 得有个开始删除和已经删除\r\n                        this.queue[removeIndex].progress.status = UploadStatus.Remove;\r\n                        this.uploadScheduler.next({\r\n                            files: [this.queue[removeIndex]],\r\n                            event: event,\r\n                            file: null,\r\n                        });\r\n                    }\r\n                    break;\r\n                case \"removeAll\":\r\n                    const removeQueueFiles = this.queue.filter(\r\n                        (uploadFile) => uploadFile.progress.status === UploadStatus.Queue\r\n                    );\r\n                    if (removeQueueFiles.length) {\r\n                        this.serviceEvents.emit({\r\n                            type: \"cancelled\",\r\n                            files: removeQueueFiles,\r\n                            message: FFileUtils.getLocalStr(\"uploadService.deleteSuccess\"),\r\n                        });\r\n                        this.queue = this.queue.filter(\r\n                            (uploadFile) => uploadFile.progress.status != UploadStatus.Queue\r\n                        );\r\n                    }\r\n                    // 正在上传的附件是如何处理\r\n                    // const doneFiles = this.queue.filter(uploadFile => uploadFile.progress.status === UploadStatus.Done);\r\n                    if (this.queue.length) {\r\n                        event.type = \"remove\";\r\n                        this.queue.map(\r\n                            (item) => (item.progress.status = UploadStatus.Remove)\r\n                        );\r\n                        this.uploadScheduler.next({\r\n                            files: this.queue,\r\n                            event: event,\r\n                            file: null,\r\n                        });\r\n                    }\r\n                    break;\r\n            }\r\n        });\r\n    }\r\n\r\n    setExtendServerConfig(extendSer) {\r\n        this.extendServerConfig = extendSer;\r\n    }\r\n\r\n    serverMethod(upload: {\r\n        file: UploadFile;\r\n        event: UploadInput;\r\n        files?: UploadFile[];\r\n    }): Observable<UploadOutput> {\r\n        return new Observable((observer) => {\r\n            let sub;\r\n            let ids = upload.files.map((fileItem) => fileItem.id);\r\n            switch (upload.event.type) {\r\n                case 'sliceUpload':\r\n                    sub = this.upload(upload.files, upload.event);\r\n                    break;\r\n                case \"upload\":\r\n                    sub = this.upload(upload.files, upload.event);\r\n                    break;\r\n                case \"multipartUpload\":\r\n                    sub = this.multipartUpload(upload.files[0], upload.event);\r\n                    break;\r\n                // case 'uploadAll':\r\n                //   ids = upload.files.map(fileItem => fileItem.id);\r\n                //   sub = this.uploadAll(upload.files, upload.event);\r\n                //   break;\r\n                case \"remove\":\r\n                    sub = this.remove(upload.files, upload.event);\r\n                    break;\r\n                // case 'removeAll':\r\n                //   ids = upload.files.map(fileItem => fileItem.id);\r\n                //   sub = this.removeAll(upload.files, upload.event);\r\n                //   break;\r\n                default:\r\n                    sub = null;\r\n            }\r\n            if (!sub) {\r\n                return;\r\n            }\r\n            sub.pipe(finalize(() => {\r\n                if (!observer.closed) {\r\n                    observer.complete();\r\n                }\r\n            })).subscribe(\r\n                    (output) => {\r\n                        observer.next(output);\r\n                    },\r\n                    (err) => {\r\n                        observer.next(err);\r\n                    },\r\n                    () => {\r\n                        observer.complete();\r\n                    }\r\n                );\r\n            this.subs.push({ ids: ids, sub: sub, id: \"\" });\r\n            // switch (upload.event.type) {\r\n            //   case 'uploadAll':\r\n            //     this.subs.push({ ids: ids, sub: sub, id: '' });\r\n            //     break;\r\n            //   case 'removeAll':\r\n            //     this.subs.push({ ids: ids, sub: sub, id: '' });\r\n            //     break;\r\n            //   default:\r\n\r\n            // }\r\n        });\r\n    }\r\n    /**\r\n     * 单个文件上传\r\n     * @param file\r\n     * @param event\r\n     */\r\n    // uploadFile(file: UploadFile, event: UploadInput): Observable<UploadOutput> {\r\n    //   const uploadFile = <BlobFile>file.nativeFile;\r\n    //   const uploadIndex = this.queue.findIndex(outFile => outFile.nativeFile === uploadFile);\r\n\r\n    //   // 已经被取消的不能被上传\r\n    //   if (this.queue[uploadIndex].progress.status === UploadStatus.Cancelled) {\r\n    //     return new Observable(observer => {\r\n    //       observer.complete();\r\n    //     });\r\n    //   }\r\n    //   // 抛出开始上传的事件\r\n    //   this.serviceEvents.emit({ type: 'start', files: [file] });\r\n    //   return this.uploadServerSer.upload(file, event, this.extendServerConfig);\r\n    // }\r\n    multipartUpload(\r\n        file: UploadFile,\r\n        event: UploadInput\r\n    ): Observable<UploadOutput> {\r\n        // 抛出开始上传的事件\r\n        this.serviceEvents.emit({ type: \"start\", files: [file] });\r\n        return this.uploadServerSer.multipartUpload(\r\n            file,\r\n            event,\r\n            this.extendServerConfig\r\n        );\r\n    }\r\n    upload(files: UploadFile[], event: UploadInput): Observable<UploadOutput> {\r\n        // 抛出开始上传的事件\r\n        this.serviceEvents.emit({ type: \"start\", files: files });\r\n        return this.uploadServerSer.upload(files, event, this.extendServerConfig);\r\n    }\r\n\r\n    remove(files: UploadFile[], event: UploadInput): Observable<UploadOutput> {\r\n        return this.uploadServerSer.remove(files, event, this.extendServerConfig);\r\n    }\r\n    // removeAll(files: UploadFile[], event: UploadInput): Observable<UploadOutput> {\r\n    //   return this.uploadServerSer.removeAll(files, event, this.extendServerConfig);\r\n    // }\r\n    // 重置\r\n    reset() {\r\n        this.queue = [];\r\n        //this.uploadScheduler = new Subject();\r\n        // this.subs.forEach(sub => {\r\n        //   if (sub.sub) {\r\n        //     sub.sub.unsubscribe();\r\n        //   }\r\n        // });\r\n        this.subs = [];\r\n    }\r\n\r\n    // 暂时\r\n    setContentTypes(contentTypes: string[]): void {\r\n        if (typeof contentTypes !== \"undefined\" && contentTypes instanceof Array) {\r\n            if (contentTypes.find((type: string) => type === \"*\") !== undefined) {\r\n                this.allowedContentTypes = [\"*\"];\r\n            } else {\r\n                this.allowedContentTypes = contentTypes;\r\n            }\r\n            return;\r\n        }\r\n        this.allowedContentTypes = [\"*\"];\r\n    }\r\n\r\n    allContentTypesAllowed(): boolean {\r\n        return (\r\n            this.allowedContentTypes.find((type: string) => type === \"*\") !==\r\n            undefined\r\n        );\r\n    }\r\n    /**\r\n     *\r\n     * @param name\r\n     */\r\n    isContentTypeAllowed(name: string): boolean {\r\n        if (this.allContentTypesAllowed()) {\r\n            return true;\r\n        }\r\n        // 附件没有后缀\r\n        if (name.lastIndexOf(\".\") < 0) {\r\n            return false;\r\n        }\r\n        let namesuffix = name.substr(name.lastIndexOf(\".\"));\r\n        // 简化计算\r\n        return (\r\n            this.allowedContentTypes.findIndex(\r\n                (item) => item.toLowerCase() == namesuffix.toLowerCase()\r\n            ) > -1\r\n        );\r\n    }\r\n    private isNameAllowed(name:string):boolean{\r\n        if(!this.notAllowedCharsInFileName||this.notAllowedCharsInFileName.length==0){\r\n            return true;\r\n        }\r\n        let purName=name.lastIndexOf(\".\")>-1? name.substr(0,name.lastIndexOf(\".\")):name;\r\n         // 简化计算\r\n         return !(\r\n            this.notAllowedCharsInFileName.findIndex(\r\n                (item) => purName.indexOf(item)>-1\r\n            ) > -1\r\n        );\r\n    }\r\n\r\n    isFileSizeAllowed(fileSize: number): boolean {\r\n        if (!this.maxFileSize) {\r\n            return true;\r\n        }\r\n        // fileSize是b单位 maxFileSize是MB单位\r\n        return fileSize <= this.maxFileSize * 1024 * 1024; // * 8\r\n    }\r\n}\r\n","\r\nimport { UploadFile, UploadOutput, UploadInput, UploadStatus, BlobFile, UploadServerService } from '../model/index';\r\nimport { Observable } from 'rxjs';\r\nimport { FFileUtils } from '../utils/index';\r\nexport class FFileUploadDefaultService extends UploadServerService {\r\n    /**\r\n     * 2019年3月2日，先假定一个一个传入\r\n     * @param file \r\n     * @param event \r\n     */\r\n    upload(files: UploadFile[], event: UploadInput,extendService:any): Observable<UploadOutput> {\r\n        let file = files[0];\r\n        return new Observable(observer => {\r\n            const url = event.url ||extendService.url|| '';\r\n\r\n            const method = event.method || 'POST';\r\n            const data = event.data || {};\r\n            const headers = event.headers || {};\r\n\r\n            const xhr = new XMLHttpRequest();\r\n            const time: number = new Date().getTime();\r\n            let progressStartTime: number = (file.progress.data && file.progress.data.startTime) || time;\r\n            let speed = 0;\r\n            let eta: number | null = null;\r\n\r\n            xhr.upload.addEventListener('progress', (e: ProgressEvent) => {\r\n                if (e.lengthComputable) {\r\n                    const percentage = Math.round((e.loaded * 100) / e.total);\r\n                    const diff = new Date().getTime() - time;\r\n                    speed = Math.round(e.loaded / diff * 1000);\r\n                    progressStartTime = (file.progress.data && file.progress.data.startTime) || new Date().getTime();\r\n                    eta = Math.ceil((e.total - e.loaded) / speed);\r\n\r\n                    file.progress = {\r\n                        status: UploadStatus.Uploading,\r\n                        data: {\r\n                            percentage: percentage,\r\n                            speed: speed,\r\n                            speedHuman: `${FFileUtils.humanizeBytes(speed)}/s`,\r\n                            startTime: progressStartTime,\r\n                            endTime: null,\r\n                            eta: eta,\r\n                            etaHuman: this.secondsToHuman(eta)\r\n                        }\r\n                    };\r\n\r\n                    observer.next({ type: 'uploading', file: file });\r\n                }\r\n            }, false);\r\n\r\n            xhr.upload.addEventListener('error', (e: Event) => {\r\n                observer.error(e);\r\n                observer.complete();\r\n            });\r\n\r\n            xhr.onreadystatechange = () => {\r\n                if (xhr.readyState === XMLHttpRequest.DONE) {\r\n                    const speedAverage = Math.round(file.size / (new Date().getTime() - progressStartTime) * 1000);\r\n                    file.progress = {\r\n                        status: UploadStatus.Done,\r\n                        data: {\r\n                            percentage: 100,\r\n                            speed: speedAverage,\r\n                            speedHuman: `${FFileUtils.humanizeBytes(speedAverage)}/s`,\r\n                            startTime: progressStartTime,\r\n                            endTime: new Date().getTime(),\r\n                            eta: eta,\r\n                            etaHuman: this.secondsToHuman(eta || 0)\r\n                        }\r\n                    };\r\n\r\n                    file.responseStatus = xhr.status;\r\n\r\n                    try {\r\n                        file.response = JSON.parse(xhr.response);\r\n                    } catch (e) {\r\n                        file.response = xhr.response;\r\n                    }\r\n\r\n                    file.responseHeaders = this.parseResponseHeaders(xhr.getAllResponseHeaders());\r\n\r\n                    observer.next({ type: 'done', files: [file] });\r\n\r\n                    observer.complete();\r\n                }\r\n            };\r\n\r\n            xhr.open(method, url, true);\r\n            xhr.withCredentials = event.withCredentials ? true : false;\r\n\r\n            try {\r\n                const uploadFile = <BlobFile>file.nativeFile;\r\n                // const uploadIndex = this.queue.findIndex(outFile => outFile.nativeFile === uploadFile);\r\n\r\n                // if (this.queue[uploadIndex].progress.status === UploadStatus.Cancelled) {\r\n                //     observer.complete();\r\n                // }\r\n\r\n                Object.keys(headers).forEach(key => xhr.setRequestHeader(key, headers[key]));\r\n\r\n                let bodyToSend: FormData | BlobFile;\r\n\r\n                if (event.includeWebKitFormBoundary !== false) {\r\n                    Object.keys(data).forEach(key => file.form.append(key, data[key]));\r\n                    file.form.append(event.fieldName || 'file', uploadFile, uploadFile.name);\r\n                    bodyToSend = file.form;\r\n                } else {\r\n                    bodyToSend = uploadFile;\r\n                }\r\n\r\n                //this.serviceEvents.emit({ type: 'start', file: file });\r\n                xhr.send(bodyToSend);\r\n            } catch (e) {\r\n                observer.complete();\r\n            }\r\n\r\n            return () => {\r\n                xhr.abort();\r\n            };\r\n        });\r\n    }\r\n    // 删除附件\r\n    remove(files: UploadFile[], event: UploadInput, extendService: any): Observable<UploadOutput> {\r\n        return new Observable(observer => {\r\n            observer.next({ type: 'removed', files: files });\r\n            observer.complete();\r\n        });\r\n    }\r\n    multipartUpload(file: UploadFile, event: UploadInput, extendService: any): Observable<any>{\r\n        return new Observable(observer => {\r\n            observer.complete();\r\n        });\r\n    };\r\n\r\n    private secondsToHuman(sec: number): string {\r\n        return new Date(sec * 1000).toISOString().substr(11, 8);\r\n    }\r\n    private parseResponseHeaders(httpHeaders: string) {\r\n        if (!httpHeaders) {\r\n            return;\r\n        }\r\n\r\n        return httpHeaders.split('\\n')\r\n            .map((x: string) => x.split(/: */, 2))\r\n            .filter((x: string[]) => x[0])\r\n            .reduce((acc: Object, x: string[]) => {\r\n                acc[x[0]] = x[1];\r\n                return acc;\r\n            }, {});\r\n    }\r\n}","import { Directive, ElementRef, EventEmitter, Input, Output, OnInit, OnDestroy } from '@angular/core';\r\nimport { UploadOutput, UploadInput, UploaderOptions } from '../model/index';\r\nimport { FFileUploaderService } from '../service/index';\r\nimport { Subscription } from 'rxjs';\r\n\r\n@Directive({\r\n    selector: '[FFileDrop]'\r\n})\r\nexport class FFileDropDirective implements OnInit, OnDestroy {\r\n    private tDisabled = false;\r\n    // 是否禁用\r\n    @Input()\r\n    set disabled(value: boolean) {\r\n        if (this.tDisabled !== value) {\r\n            this.tDisabled = value;\r\n            if (value) {\r\n                this.unbindDragAndDropEvent();\r\n            } else {\r\n                this.bindDragAndDropEvent();\r\n            }\r\n        }\r\n    };\r\n    get disabled(): boolean {\r\n        return this.tDisabled;\r\n    }\r\n    // 配置\r\n    @Input()\r\n    set options(value: UploaderOptions) {\r\n        this.upload.setOptions(value);\r\n    };\r\n    // 已上传\r\n    @Input()\r\n    set uploadedCount(value){\r\n        this.upload.setOptions({'uploadedCount':value});\r\n    }\r\n    // 传递\r\n    @Input() uploadInput: EventEmitter<UploadInput>;\r\n    @Output() uploadOutput: EventEmitter<UploadOutput>;\r\n\r\n    //upload: FFileUploaderService;\r\n    el: HTMLInputElement;\r\n\r\n    _sub: Subscription[];\r\n\r\n    // eventListener\r\n    dropListener: any = null;\r\n    dragOverListener: any = null;\r\n    dragLeaveListener: any = null;\r\n    dragEnterListener: any = null;\r\n\r\n    constructor(public elementRef: ElementRef, private upload: FFileUploaderService) {\r\n        this.uploadOutput = new EventEmitter<UploadOutput>();\r\n    }\r\n\r\n    ngOnInit() {\r\n        this._sub = [];\r\n        this.el = this.elementRef.nativeElement;\r\n\r\n        this._sub.push(\r\n            this.upload.serviceEvents.subscribe((event: UploadOutput) => {\r\n                this.uploadOutput.emit(event);\r\n            })\r\n        );\r\n\r\n        if (this.uploadInput instanceof EventEmitter) {\r\n            this._sub.push(this.upload.initInputEvents(this.uploadInput));\r\n        }\r\n        // 绑定事件\r\n        if (!this.disabled) {\r\n            this.bindDragAndDropEvent();\r\n        }\r\n    }\r\n\r\n    ngOnDestroy() {\r\n        this.unbindDragAndDropEvent();\r\n        this._sub.forEach(sub => sub.unsubscribe());\r\n    }\r\n    private bindDragAndDropEvent() {\r\n        // this.ngzone.runOutsideAngular(() => {\r\n        this.dropListener = this.onDrop.bind(this);\r\n        this.el.addEventListener('drop', this.dropListener);\r\n        this.dragOverListener = this.onDragOver.bind(this);\r\n        this.el.addEventListener('dragover', this.dragOverListener);\r\n        this.dragLeaveListener = this.onDragLeave.bind(this);\r\n        this.el.addEventListener('dragleave', this.dragLeaveListener);\r\n        this.dragEnterListener = this.onDropEnter.bind(this);\r\n        this.el.addEventListener('dragenter', this.dragEnterListener);\r\n        //  });\r\n    }\r\n    private unbindDragAndDropEvent() {\r\n        this.dropListener && this.el.removeEventListener('drop', this.dropListener);\r\n        this.dragOverListener && this.el.removeEventListener('dragover', this.dragOverListener);\r\n        this.dragLeaveListener && this.el.removeEventListener('dragleave', this.dragLeaveListener);\r\n        this.dragEnterListener && this.el.removeEventListener('dragenter', this.dragEnterListener);\r\n    }\r\n\r\n    onDropEnter = (e: Event) => {\r\n        e.stopPropagation();\r\n        e.preventDefault();\r\n    }\r\n\r\n\r\n    // @HostListener('drop', ['$event'])\r\n    public onDrop(e) {\r\n        e.stopPropagation();\r\n        e.preventDefault();\r\n        const event: UploadOutput = { type: 'drop' };\r\n        // console.log('dorp Events');\r\n        this.uploadOutput.emit(event);\r\n        this.upload.handleFiles(e.dataTransfer.files);\r\n    }\r\n\r\n    // @HostListener('dragover', ['$event'])\r\n    public onDragOver(e: Event) {\r\n        if (!e) {\r\n            return;\r\n        }\r\n        e.stopPropagation();\r\n        e.preventDefault();\r\n        const event: UploadOutput = { type: 'dragOver' };\r\n        this.uploadOutput.emit(event);\r\n    }\r\n\r\n    // @HostListener('dragleave', ['$event'])\r\n    public onDragLeave(e: Event) {\r\n        if (!e) {\r\n            return;\r\n        }\r\n        e.stopPropagation();\r\n        e.preventDefault();\r\n        const event: UploadOutput = { type: 'dragOut' };\r\n        this.uploadOutput.emit(event);\r\n    }\r\n    /**\r\n     * 重置\r\n     */\r\n    reset() {\r\n       /*if (this.el) {\r\n            this._sub.forEach(sub => sub.unsubscribe());\r\n            this._sub = [];\r\n            this.upload.reset();\r\n        }*/\r\n        this.upload.reset();\r\n    }\r\n}\r\n","import { Directive, ElementRef, EventEmitter, Input, Output, OnInit, OnDestroy } from '@angular/core';\r\nimport { UploadOutput, UploaderOptions } from '../model/f-file-upload.model';\r\nimport { FFileUploaderService } from '../service/f-file-uploader.service';\r\nimport { Subscription } from 'rxjs';\r\n\r\n@Directive({\r\n  selector: '[FFileSelect]'\r\n})\r\nexport class FFileSelectDirective implements OnInit, OnDestroy {\r\n  private tDisabled = false;\r\n  @Input()\r\n  set disabled(value: boolean) {\r\n    if (this.tDisabled !== value) {\r\n      this.tDisabled = value;\r\n      if (value) {\r\n        this.unbindEvent();\r\n      } else {\r\n        this.bindEvent();\r\n      }\r\n    }\r\n  }\r\n  get disabled(): boolean {\r\n    return this.tDisabled;\r\n  }\r\n  @Input()\r\n  set options(value: UploaderOptions) {\r\n    if (value) {\r\n      this.upload.setOptions(value);\r\n    }\r\n  };\r\n   // 已上传\r\n   @Input()\r\n   set uploadedCount(value){\r\n       this.upload.setOptions({'uploadedCount':value});\r\n   }\r\n  @Input() uploadInput: EventEmitter<any>;\r\n  @Output() uploadOutput: EventEmitter<UploadOutput>;\r\n\r\n  //upload: FFileUploaderService;\r\n  el: HTMLInputElement;\r\n  private _sub: Subscription[];\r\n  private changeListener: any = null;\r\n\r\n  constructor(public elementRef: ElementRef, private upload: FFileUploaderService) {\r\n    this.uploadOutput = new EventEmitter<UploadOutput>();\r\n    this.el = this.elementRef.nativeElement;\r\n  }\r\n\r\n  ngOnInit() {\r\n    this._sub = [];\r\n    // 对外抛出事件\r\n    this._sub.push(\r\n      this.upload.serviceEvents.subscribe((event: UploadOutput) => {\r\n        this.uploadOutput.emit(event);\r\n      })\r\n    );\r\n    // 对内的事件\r\n    if (this.uploadInput instanceof EventEmitter) {\r\n      this._sub.push(this.upload.initInputEvents(this.uploadInput));\r\n    }\r\n    if (!this.disabled) {\r\n      this.bindEvent();\r\n    }\r\n  }\r\n  private bindEvent() {\r\n    this.changeListener = this.onChange.bind(this);\r\n    this.el.addEventListener('change', this.changeListener);\r\n  }\r\n  private unbindEvent() {\r\n    this.changeListener = null;\r\n    this.el.removeEventListener('change', this.changeListener);\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    if (this.el) {\r\n      this._sub.forEach(sub => sub.unsubscribe());\r\n    }\r\n  }\r\n\r\n  onChange = () => {\r\n    if (this.el.files) {\r\n      this.upload.handleFiles(this.el.files);\r\n      this.el.value=null;\r\n    }\r\n  }\r\n  /**\r\n   * 重置\r\n   */\r\n  reset(){\r\n    // if (this.el) {\r\n    //   //this._sub.forEach(sub => sub.unsubscribe());\r\n    //   //this._sub=[];\r\n    //   this.upload.reset();\r\n    // }    \r\n    this.upload.reset();\r\n  }\r\n}\r\n","import {  Directive, TemplateRef, Input } from '@angular/core';\r\n\r\n@Directive({\r\n    selector: '[filePreviewListTypeTemplate]'\r\n})\r\nexport class FFilePreviewListTypeTemplateDirective {\r\n    constructor(public template: TemplateRef<any>) { }\r\n}\r\n\r\n@Directive({\r\n    selector: '[filePreviewToolbarTemplate]'\r\n})\r\nexport class FFilePreviewToolbarTemplateDirective {\r\n    constructor(public template: TemplateRef<any>) { }\r\n}\r\n","import { Directive, TemplateRef, Input } from '@angular/core';\r\n\r\n@Directive({\r\n  selector: '[fFielUpload],[fFileUpload]',\r\n})\r\nexport class FFileUploadDirective {\r\n  constructor(\r\n    public templateRef: TemplateRef<any>\r\n  ) { \r\n  }\r\n\r\n}","import { Pipe, PipeTransform } from \"@angular/core\";\r\nimport { Injector, ElementRef, LOCALE_ID } from \"@angular/core\";\r\nimport { ColumnFormatService } from \"@farris/ui-common/column\";\r\nimport { FFileUtils } from \"../utils/f-file.utils\";\r\nimport { DateTimeHelperService } from \"@farris/ui-common/date\";\r\n/**\r\n * 文件大小格式化\r\n */\r\n@Pipe({\r\n    name: \"fFileSize\",\r\n})\r\nexport class FFileSizePipe implements PipeTransform {\r\n    transform(value: any, args?: any): any {\r\n        // 如果是字符串\r\n        let tvalue = value;\r\n        if (!value) {\r\n            return \"0 Byte\";\r\n        }\r\n        if (typeof value == \"string\") {\r\n            tvalue = parseInt(value);\r\n        }\r\n        return FFileUtils.humanizeBytes(tvalue);\r\n    }\r\n}\r\n/**\r\n * 日期格式化\r\n */\r\n@Pipe({\r\n    name: \"fFileDate\",\r\n})\r\nexport class FFileDatePipe implements PipeTransform {\r\n    constructor(private dateSer: DateTimeHelperService) { }\r\n    transform(value: any, returnFormat: string = \"yyyy-MM-dd\"): any {\r\n        if(!value) return '';\r\n        return this.dateSer.formatTo(value, returnFormat);\r\n    }\r\n}\r\n\r\n/**\r\n * 格式化自定义数据\r\n */\r\n\r\n@Pipe({ name: \"formatCellData\", pure: false })\r\nexport class FormatCellDataPipe implements PipeTransform {\r\n    private elRef: ElementRef;\r\n    // 先不处理多语言\r\n    private localeId = \"ZH-CHS\";\r\n    constructor(private cfs: ColumnFormatService, private injector: Injector) { }\r\n    /**\r\n     * 格式化数据\r\n     * @param column:列信息\r\n     * @param rowData:当前数据\r\n     * @param settings:配置信息\r\n     * @param state: 状态\r\n     * @returns\r\n     */\r\n    transform(column, rowData, rowIndex, settings, state = \"preview\"): any {\r\n        if (rowData && column && column.field) {\r\n            // 值\r\n            let value =this.getRealDataValue(rowData,column.field);\r\n            let formatterFn = column.formatter;\r\n            if (formatterFn) {\r\n                if (formatterFn.type === \"number\") {\r\n                    if (\r\n                        !formatterFn.options ||\r\n                        !Object.keys(formatterFn.options).length\r\n                    ) {\r\n                        formatterFn.options = {\r\n                            thousand: \",\",\r\n                            precision: 2,\r\n                        };\r\n                    }\r\n                }\r\n                // 不需要特殊处理\r\n                // if (formatterFn.type === \"datetime\") {\r\n                // }\r\n            }\r\n            //参数1： 值，参数2：行数据 参数3：格式化方法\r\n            return this.cfs.format(value, rowData, formatterFn, { rowIndex, settings });\r\n        }\r\n        return \"\";\r\n    }\r\n    /**\r\n     * 获取真正的数据\r\n     * @param rowData \r\n     * @param field \r\n     * @returns \r\n     */\r\n    private getRealDataValue(rowData, field) {\r\n        if (!field||!rowData) return '';\r\n        let fieldArray = field.split('.');\r\n        if (fieldArray.length == 1) {\r\n            return rowData[fieldArray[0]];\r\n        }\r\n        let curItemVal = rowData;\r\n        for (var k = 0; k < fieldArray.length; k++) {\r\n            curItemVal = curItemVal[fieldArray[k]];\r\n            // 没有值或者没有此属性\r\n            if (curItemVal == null || curItemVal == undefined) {\r\n                break;\r\n            }\r\n        }\r\n        if (k == fieldArray.length) {\r\n            return curItemVal == null || curItemVal == undefined?\"\":curItemVal;\r\n        } else {\r\n            return '';\r\n        }\r\n    }\r\n    \r\n}\r\n/**\r\n * 附件可能之前生成的单据中并没有多语言服务\r\n * 调用附件的公共服务\r\n */\r\n@Pipe({name: 'upLocale'})\r\nexport class UPLocalePipe implements PipeTransform {\r\n    constructor() {}\r\n    transform(name: any, ...replaceVal: any[]): any {\r\n          return  FFileUtils.getLocalStr(name,replaceVal);\r\n    }\r\n}\r\n\r\n/**\r\n * 解决变量有个默认的文字，变量最终可能是默认值也可能不是\r\n */\r\n@Pipe({name: 'upLocaleDefault'})\r\nexport class UPLocaleDefaultPipe implements PipeTransform {\r\n    constructor() {}\r\n    transform(realValue: any,compareTxt:string,localeName:string): any {\r\n        if(realValue==compareTxt){\r\n            return  FFileUtils.getLocalStr(localeName);\r\n        }\r\n        return realValue;\r\n    }         \r\n}\r\n\r\n\r\n","import { Component, OnInit, HostBinding, Input, ViewChild, ElementRef, Host } from '@angular/core';\r\n@Component({\r\n  selector: 'f-file-view-image',\r\n  templateUrl: './f-file-view-image.component.html',\r\n  styleUrls: ['./f-file-view-image.component.css']\r\n})\r\nexport class FFileViewImageComponent implements OnInit {\r\n  @Input() maxHeight = 200;\r\n  @Input() maxWidth = 300;\r\n  @HostBinding('class.f-file-view-image') cls = true;\r\n  @HostBinding('style.height') selfHeight='50px';\r\n  @ViewChild('canvas') canvas: ElementRef;\r\n  private tFile: File;\r\n  @Input()\r\n  set file(fileContent: File) {\r\n    this.tFile = fileContent;\r\n    this.createImageByCanvas();\r\n  }\r\n  get file(): File {\r\n    return this.tFile;\r\n  }\r\n\r\n  constructor() { }\r\n\r\n  ngOnInit() {\r\n  }\r\n  private changeImageSize(originWidth,originHeight) {\r\n\r\n    // 图片原始尺寸\r\n\r\n    // 目标尺寸\r\n    var targetWidth = originWidth, targetHeight = originHeight;\r\n    // 图片尺寸超过400x400的限制\r\n    if (originWidth > this.maxWidth || originHeight > this.maxHeight) {\r\n      if (originWidth / originHeight > this.maxWidth / this.maxHeight) {\r\n        // 更宽，按照宽度限定尺寸\r\n        targetWidth = this.maxWidth;\r\n        targetHeight = Math.round(this.maxWidth * (originHeight / originWidth));\r\n      } else {\r\n        targetHeight = this.maxHeight;\r\n        targetWidth = Math.round(this.maxHeight * (originWidth / originHeight));\r\n      }\r\n    }\r\n    this.selfHeight=targetHeight+\"px\";\r\n    return {\r\n      width: targetWidth,\r\n      height: targetHeight\r\n    }\r\n  }\r\n  // 压缩图片需要的一些元素和对象\r\n\r\n  private createImageByCanvas() {\r\n    let reader = new FileReader();\r\n    let tImage = new Image();\r\n    let canvas = this.canvas.nativeElement;\r\n    let context = canvas.getContext('2d');\r\n    // base64地址图片加载完毕后\r\n    tImage.onload = () => {\r\n      let imgSize = this.changeImageSize(tImage.width,tImage.height);\r\n      // canvas对图片进行缩放\r\n      canvas.width = imgSize.width;\r\n      canvas.height = imgSize.height;\r\n      // 清除画布\r\n      context.clearRect(0, 0,this.maxWidth,this.maxHeight);\r\n      // 图片压缩\r\n      context.drawImage(tImage, 0, 0, imgSize.width, imgSize.height);\r\n    };\r\n\r\n    // 文件base64化，以便获知图片原始尺寸\r\n    reader.onload =(ev)=>{\r\n      tImage.src = reader.result as string;\r\n    };\r\n    reader.onerror = function (e) {\r\n    }\r\n    reader.readAsDataURL(this.file);\r\n  }\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n}\r\n","import {\r\n    Component,\r\n    OnInit,\r\n    Input,\r\n    HostBinding,\r\n    ViewChild,\r\n    EventEmitter,\r\n    Output,\r\n    ContentChild,\r\n    ElementRef,\r\n    AfterViewInit,\r\n} from \"@angular/core\";\r\nimport {\r\n    FFileSelectDirective,\r\n    FFileDropDirective,\r\n    FFileUploadDirective,\r\n} from \"../../directive/index\";\r\nimport {\r\n    UploadOutput,\r\n    UploadInput,\r\n    UploadFile,\r\n    UploaderOptions,\r\n    FUploadFileExtend,\r\n    DocMetaProperty,\r\n} from \"../../model/index\";\r\nimport { FFileUtils } from \"../../utils/index\";\r\nimport {\r\n    FFileUploadAPIService,\r\n    FFileUploaderService,\r\n} from \"../../service/index\";\r\nimport { NotifyService, NotifyOptions } from \"@farris/ui-notify\";\r\nimport { Observable, Subject } from \"rxjs\";\r\n\r\nimport { trigger,style,state,animate,transition } from \"@angular/animations\";\r\nimport { NgZone } from \"@angular/core\";\r\nimport { LocaleService } from \"@farris/ui-locale\";\r\n\r\n@Component({\r\n    selector: \"f-file-upload\",\r\n    templateUrl: \"./f-file-upload.component.html\",\r\n    styleUrls: [\"./f-file-upload.component.css\"],\r\n    providers: [FFileUploaderService],\r\n    animations: [\r\n        trigger(\"hideUploaded\", [\r\n            state(\"show\", style({ opacity: 1, height: \"*\" })),\r\n            state(\"hide\", style({ opacity: 0, height: 0 })),\r\n            // transition('* => void', [\r\n            //   style({ opacity: 1}),\r\n            //   animate(200, style({ opacity: 0}))\r\n            // ])\r\n            transition(\"* => hide\", animate(\"0.5s\")),\r\n        ]),\r\n    ],\r\n})\r\nexport class FFileUploadComponent implements OnInit, AfterViewInit {\r\n    @HostBinding(\"class.ffileupload\") cls = true;\r\n    // 不可见\r\n    @HostBinding(\"class.ffileupload-unvisible\") get visibleState() {\r\n        return !this.visible;\r\n    }\r\n    // 自定义样式\r\n    @HostBinding(\"class.ffileupload-selfdefine\") get selfDirectiveDefine() {\r\n        if (this.fFileUploadDir) {\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n    @HostBinding(\"class.ffileupload-uploading\") get uploading() {\r\n        return this.files.length > 0;\r\n    }\r\n\r\n    // 不能在Construct里追加el\r\n    @ViewChild(\"uploadAssist\") fFileUploadAssist: ElementRef;\r\n    // 自定义指令\r\n    @ContentChild(FFileUploadDirective) fFileUploadDir: any;\r\n    //\r\n    @ViewChild(FFileSelectDirective) fileUpload: FFileSelectDirective;\r\n    @ViewChild(FFileDropDirective) fileDropUpload: FFileDropDirective;\r\n    // 启用图片预览\r\n    @Input() enableImagePreview = true;\r\n    // 启用立即上传\r\n    @Input() uploadImmediately = false;\r\n    // 上传完成后隐藏\r\n    @Input() uploadedThenHide = true;\r\n    // 禁用状态\r\n    @Input() disabled = false;\r\n    /** 启用分块上传 */\r\n    @Input() enableSliceUpload = true;\r\n    /** 分块上传每片大小，单位：M, 默认 1M/块 */\r\n    @Input() chunkSize = 1;\r\n\r\n    private tVisible = true;\r\n    // 是否可见\r\n    @Input()\r\n    set visible(value) {\r\n        this.tVisible = value;\r\n        if (!value) {\r\n            this.reset();\r\n        }\r\n    }\r\n    get visible() {\r\n        return this.tVisible;\r\n    }\r\n    // 需要重置,通过不断的赋值来改变\r\n    @Input() needReset: Observable<any> = new Subject();\r\n    // 启用拖拽\r\n    @Input() enableDrop = false;\r\n    @Input() dropText = \"可将文件拖拽此处\";\r\n    // 启用选择文件按钮\r\n    @Input() enableSelect = true;\r\n    @Input() selectText = \"点击上传\";\r\n    // 启用多选\r\n    @Input() multiple = true;\r\n    // 已经上传文件\r\n    @Input() uploadedCount = 0;\r\n    // 公共的扩展数据\r\n    @Input() extendDatas: {\r\n        [key: string]: any;\r\n        extProperty?: DocMetaProperty | null; //\r\n    };\r\n    // 宽度阈值，当宽度超过760时候，没有附件上传时，宽度是固定值，有附件上传时，有最大宽度值\r\n    @Input() widthThreshold = 760;\r\n    // 上传和删除对外抛出的事件\r\n    @Output() fUploadDoneEvent = new EventEmitter<FUploadFileExtend[]>();\r\n    @Output() fUploadRemovedEvent = new EventEmitter<FUploadFileExtend[]>();\r\n\r\n    // 允许上传的文件类型\r\n    allowedContentTypes = \"*\";\r\n    // 默认不限制附件上传个数\r\n    maxUploads = 0;\r\n    // 单位KB，默认是12M\r\n    maxFileSize = \"12MB\";\r\n\r\n    private selfUploadOpts: UploaderOptions = {};\r\n    // 上传配置项\r\n    @Input()\r\n    set options(uploadOpts: UploaderOptions) {\r\n        if (uploadOpts) {\r\n            if (uploadOpts.hasOwnProperty(\"allowedContentTypes\")) {\r\n                this.allowedContentTypes = uploadOpts.allowedContentTypes.join(\",\");\r\n                this.allowedContentTypes =\r\n                    this.allowedContentTypes == \"\" ? \"*\" : this.allowedContentTypes;\r\n            }\r\n            if (uploadOpts.hasOwnProperty(\"maxUploads\")) {\r\n                this.maxUploads = uploadOpts.maxUploads;\r\n            }\r\n            if (uploadOpts.hasOwnProperty(\"maxFileSize\")) {\r\n                this.maxFileSize = FFileUtils.humanizeBytes(\r\n                    1024 * 1024 * uploadOpts.maxFileSize\r\n                );\r\n            }\r\n            this.selfUploadOpts = Object.assign(this.selfUploadOpts, uploadOpts);\r\n        }\r\n    }\r\n    get options() {\r\n        return this.selfUploadOpts;\r\n    }\r\n    /**\r\n     * 每个组可以设置特殊服务参数，来覆盖默认的统一模块级配置\r\n     */\r\n    @Input()\r\n    set extendServerConfig(config: any) {\r\n        if (config) {\r\n            this.fileUploaderSer.setExtendServerConfig(config);\r\n        }\r\n    }\r\n    // 记录文件个数\r\n    files: UploadOutput[];\r\n    // 标记通过选择按钮处理的事件\r\n    uploadSelectInput: EventEmitter<UploadInput>;\r\n    // 标记通过拖拽处理的事件\r\n    uploadDragInput: EventEmitter<UploadInput>;\r\n    // 控制是否显示追加附件的面板\r\n    showAppendPanel = false;\r\n    // 显示loading\r\n    showLoading = false;\r\n\r\n    settings = {\r\n        disabled: this.disabled,\r\n        visible: this.visible,\r\n    };\r\n    // 多语言信息\r\n    localInfo\r\n    constructor(\r\n        private uploadAPISer: FFileUploadAPIService,\r\n        private fileUploaderSer: FFileUploaderService,\r\n        private notifyService: NotifyService,\r\n        private ngZone: NgZone\r\n    ) {\r\n        this.files = [];\r\n        this.uploadSelectInput = new EventEmitter<UploadInput>();\r\n        this.uploadDragInput = new EventEmitter<UploadInput>();\r\n        // 重置\r\n        this.needReset.subscribe((data) => {\r\n            this.reset();\r\n        });\r\n        FFileUtils.getLocalState(this.notifyService.localeService);        \r\n    }\r\n\r\n    ngOnInit() {\r\n        // 模板的情况下只能是立即上传\r\n        if (this.fFileUploadDir) {\r\n            this.uploadImmediately = true;\r\n        }\r\n        this.computeWidthThreshold();\r\n    }\r\n    /**\r\n     * 视图初始化后\r\n     */\r\n    ngAfterViewInit() { }\r\n    /**\r\n     * 触发绑定\r\n     */\r\n    triggerFileSelect(ev) {\r\n        ev && ev.stopPropagation();\r\n        // 禁用时\r\n        if (this.disabled) {\r\n            return false;\r\n        }\r\n        this.fileUpload.elementRef.nativeElement.click();\r\n    }\r\n    /**\r\n     * 选择附件按钮，处理抛出事件\r\n     * @param output\r\n     */\r\n    selectUploadOutput(output: UploadOutput): void {\r\n        this.uploadOutputHandler(output);\r\n    }\r\n    /**\r\n     * 拖拽区域处理抛出事件\r\n     * @param output\r\n     */\r\n    dropUploadOutput(output: UploadOutput): void {\r\n        if (this.enableSelect) {\r\n            return;\r\n        }\r\n        // 暂不处理拖拽的事件\r\n        if (\r\n            output.type !== \"dragOver\" &&\r\n            output.type !== \"dragOut\" &&\r\n            output.type !== \"drop\"\r\n        ) {\r\n            this.uploadOutputHandler(output);\r\n        }\r\n    }\r\n    /**\r\n     * allAddedToQueue 选中文件追加到队列\r\n     * @param output\r\n     */\r\n    private uploadOutputHandler(output: UploadOutput): void {\r\n        // 显示追加面板\r\n        if (this.showAppendPanel) {\r\n            this.showAppendPanel = false;\r\n        }\r\n\r\n        if (output.type === \"addedToQueue\" && typeof output.file !== \"undefined\") {\r\n            this.files.push({ type: output.type, file: output.file });\r\n            // 如果启用立即上传\r\n            if (this.uploadImmediately) {\r\n                this.showLoading = true;\r\n                this.startUpload(output.file);\r\n            }\r\n        } else if (output.type === \"start\") {\r\n            // 开始上传\r\n            this.updateFilesState(output, \"\");\r\n        } else if (output.type == \"done\") {\r\n            // 上传完成\r\n            this.updateFilesState(output, \"done\");\r\n            this.fUploadDoneEvent.emit(\r\n                FFileUtils.changeUploadFileToFileExtend(output.files)\r\n            );\r\n            this.hideAfterLoaded(output);\r\n            // 隐藏正在加载\r\n            if (\r\n                this.uploadImmediately &&\r\n                this.showLoading &&\r\n                this.allFileUploaded()\r\n            ) {\r\n                this.showLoading = false;\r\n            }\r\n        } else if (\r\n            output.type === \"cancelled\" ||\r\n            output.type === \"removed\" ||\r\n            output.type == \"error\"\r\n        ) {\r\n            // 删除或者移除文件\r\n            this.files = this.files.filter((fileOutput: UploadOutput) => {\r\n                return (\r\n                    output.files.findIndex((item) => fileOutput.file.id == item.id) < 0\r\n                );\r\n            });\r\n            // 隐藏正在加载\r\n            if (\r\n                this.uploadImmediately &&\r\n                this.showLoading &&\r\n                this.allFileUploaded()\r\n            ) {\r\n                this.showLoading = false;\r\n            }\r\n            this.showNotify(output);\r\n        } else if (\r\n            output.type === \"rejected\" &&\r\n            typeof output.file !== \"undefined\"\r\n        ) {\r\n            // 上传被拒绝\r\n            this.showNotify(output);\r\n            // 隐藏正在加载\r\n            if (\r\n                this.uploadImmediately &&\r\n                this.showLoading &&\r\n                this.allFileUploaded()\r\n            ) {\r\n                this.showLoading = false;\r\n            }\r\n        }\r\n    }\r\n\r\n    private showNotify(output) {\r\n        let notifyType = \"warning\";\r\n        if (output.type == \"cancelled\" || output.type == \"removed\") {\r\n            notifyType = \"success\";\r\n        }\r\n        let message = output.hasOwnProperty(\"message\") ? output[\"message\"] : \"\";\r\n        this.notifyService[notifyType](<NotifyOptions>{\r\n            msg: message,\r\n            timeout: 3000,\r\n        });\r\n    }\r\n    // 判断是否所有文件都已上传\r\n    private allFileUploaded() {\r\n        let findNotDoneIndex = this.files.findIndex((item) => {\r\n            let doneTypes = [\"done\", \"cancelled\", \"removed\"];\r\n            let findTypeIndex = doneTypes.findIndex((type) => {\r\n                return type == item.type;\r\n            });\r\n            return findTypeIndex == -1;\r\n        });\r\n        return findNotDoneIndex == -1 ? true : false;\r\n    }\r\n    /**\r\n     * 更新附件的状态\r\n     * @param output\r\n     * @param eventType\r\n     */\r\n    private updateFilesState(output: UploadOutput, eventType) {\r\n        let startFiles = [];\r\n        if (output.hasOwnProperty(\"files\") && output.files.length > 0) {\r\n            // 此处更新界面可能有性能问题\r\n            startFiles = output.files;\r\n        } else if (typeof output.file !== \"undefined\") {\r\n            startFiles = [output.file];\r\n        }\r\n        eventType = eventType ? eventType : output.type;\r\n        startFiles.map((item) => {\r\n            const index = this.files.findIndex(\r\n                (fileOutput) =>\r\n                    typeof item !== \"undefined\" && fileOutput.file.id === item.id\r\n            );\r\n            // 变更状态\r\n            if (index > -1) {\r\n                this.files[index] = { type: eventType, file: item };\r\n            }\r\n        });\r\n    }\r\n\r\n    /**单个文件上传 */\r\n    startUpload(file: UploadFile): void {\r\n        /**\r\n         * Todo:后续可以从上传区块上取内容进行扩展\r\n         */\r\n        const event: UploadInput = this.uploadAPISer.getAssignAPI(\"upload\", {\r\n            file: file,\r\n            type: this.enableSliceUpload ? 'sliceUpload': 'upload',\r\n            data: this.extendDatas,\r\n            chunkSize: this.chunkSize\r\n        });\r\n        this.inputUploadEventEmit(event);\r\n    }\r\n    /**\r\n     * 上传所有\r\n     */\r\n    startUploadAll(): void {\r\n        /**\r\n         *  Todo：后续，如果每个数据不一样，此处的数据得重新归集\r\n         */\r\n        const event: UploadInput = this.uploadAPISer.getAssignAPI(\"uploadAll\", {\r\n            type: this.enableSliceUpload ? 'sliceUpload': \"uploadAll\",\r\n            files: [],\r\n            data: this.extendDatas,\r\n            chunkSize: this.chunkSize\r\n        });\r\n        this.inputUploadEventEmit(event);\r\n    }\r\n    /**\r\n     * 已上传隐藏属性\r\n     */\r\n    hideAfterLoaded(output: UploadOutput): void {\r\n        //上传完成后删除\r\n        if (this.uploadedThenHide) {\r\n            // this.ngZone.runOutsideAngular(() => {\r\n            setTimeout(() => {\r\n                // 删除或者移除文件\r\n                let ids = output.files.map((fileItem) => fileItem.id);\r\n                this.files = this.files.filter((fileOutput: UploadOutput) => {\r\n                    let tIndex = ids.findIndex((tId) => tId == fileOutput.file.id);\r\n                    return tIndex > -1 ? false : true;\r\n                });\r\n\r\n                const event: UploadInput = this.uploadAPISer.getAssignAPI(\"hide\", {\r\n                    type: \"hide\",\r\n                    id: ids.join(\",\"),\r\n                });\r\n                this.inputUploadEventEmit(event);\r\n            }, 1000);\r\n            // });\r\n        }\r\n    }\r\n    /**\r\n     * 取消上传\r\n     */\r\n    cancelUpload(id: string): void {\r\n        const event: UploadInput = this.uploadAPISer.getAssignAPI(\"cancel\", {\r\n            id: id,\r\n            type: \"cancel\",\r\n        });\r\n        this.inputUploadEventEmit(event);\r\n    }\r\n    /**\r\n     * 删除已上传文件\r\n     */\r\n    removelAllUpload(): void {\r\n        const event: UploadInput = this.uploadAPISer.getAssignAPI(\"removeAll\", {\r\n            type: \"removeAll\",\r\n            files: [],\r\n        });\r\n        this.inputUploadEventEmit(event);\r\n    }\r\n    /**\r\n     * 删除已上传文件\r\n     */\r\n    removeFile(id: string): void {\r\n        const event: UploadInput = this.uploadAPISer.getAssignAPI(\"remove\", {\r\n            id: id,\r\n            type: \"remove\",\r\n        });\r\n        this.inputUploadEventEmit(event);\r\n    }\r\n    /** */\r\n    /**\r\n     *\r\n     * @param bytes\r\n     */\r\n    formateBytes(bytes) {\r\n        return FFileUtils.humanizeBytes(bytes);\r\n    }\r\n    /**\r\n     * 判断是图片\r\n     * @param type\r\n     */\r\n    isImage(type) {\r\n        return type.indexOf(\"image\") > -1;\r\n    }\r\n    // inProgress(progress) {\r\n    //   console.log('进入inProgress');\r\n    //   if (progress.data.percentage == 100) {\r\n    //     return 'done'\r\n    //   }\r\n    //   if (progress.data.percentage == 0) {\r\n    //     return 'uploadi';\r\n    //   }\r\n    //   return 'progress';\r\n    // }\r\n\r\n    /**\r\n     * 是否判断有类型限制\r\n     */\r\n    judgeContentTypeLimit() {\r\n        let tTypes = this.allowedContentTypes.split(\",\");\r\n        let hasAllIndex = tTypes.findIndex((item) => {\r\n            return item == \"*\";\r\n        });\r\n        return hasAllIndex == -1;\r\n    }\r\n    /**\r\n     * 判断是否有文件大小的限制\r\n     */\r\n    judegeFileSizeLimit() {\r\n        return this.maxFileSize != \"0 Byte\";\r\n    }\r\n    /**\r\n     * 追加\r\n     */\r\n    appendNewFiles(ev) {\r\n        //启用拖拽\r\n        if (this.enableDrop) {\r\n            this.showAppendPanel = true;\r\n        } else {\r\n            ev && ev.stopPropagation();\r\n            this.triggerFileSelect(ev);\r\n        }\r\n    }\r\n    /**\r\n     * 关闭追加面板\r\n     */\r\n    closeAppendPanel() {\r\n        this.showAppendPanel = false;\r\n    }\r\n    /**\r\n     * 统一触发 附件选择和拖拽附件的事件\r\n     * @param ev\r\n     */\r\n    private inputUploadEventEmit(ev: UploadInput) {\r\n        // 如果文件上传启用\r\n        if (this.enableSelect) {\r\n            this.uploadSelectInput.emit(ev);\r\n        } else {\r\n            this.uploadDragInput.emit(ev);\r\n        }\r\n    }\r\n    // 重置方法\r\n    reset() {\r\n        this.files = [];\r\n        // 如果文件上传启用\r\n        if (this.enableSelect) {\r\n            this.fileUpload && this.fileUpload.reset();\r\n        } else {\r\n            this.fileDropUpload && this.fileDropUpload.reset();\r\n        }\r\n        this.computeWidthThreshold();\r\n    }\r\n    /**\r\n     * 计算阈值\r\n     */\r\n    private computeWidthThreshold() {\r\n        //\r\n        this.ngZone.runOutsideAngular(() => {\r\n            let self = this;\r\n            setTimeout(() => {\r\n                let tNeedComputedCls = false;\r\n                if (self.fFileUploadDir || !self.visible) {\r\n                    tNeedComputedCls = false;\r\n                }\r\n                // 计算元素\r\n                let assistEl = self.fFileUploadAssist\r\n                    ? self.fFileUploadAssist.nativeElement\r\n                    : null;\r\n\r\n                if (assistEl) {\r\n                    assistEl.parentElement.classList[\"add\"](\"ffileupload-default\");\r\n                }\r\n\r\n                return;\r\n\r\n                // // 超过阈值\r\n                // if (assistEl && assistEl.getBoundingClientRect().width > self.widthThreshold) {\r\n                //   tNeedComputedCls = true;\r\n                // } else {\r\n                //   tNeedComputedCls = false;\r\n                // }\r\n                // if (assistEl) {\r\n                //   let actionFun = tNeedComputedCls ? 'add' : 'remove';\r\n                //   assistEl.parentElement.classList[actionFun]('ffileupload-default');\r\n                // }\r\n            }, 0);\r\n        });\r\n    }\r\n}\r\n","import { Component, OnInit, Input, HostBinding, Output, EventEmitter, ContentChild, TemplateRef, ViewEncapsulation, SimpleChanges, OnChanges, ChangeDetectorRef, ViewChildren, ElementRef, ViewChild, Optional, inject, Injector } from '@angular/core';\r\nimport { FUploadFileExtend } from '../../model/index';\r\nimport { FFilePreviewListTypeTemplateDirective, FFilePreviewToolbarTemplateDirective } from '../../directive/index';\r\nimport { FFileUtils } from '../../utils';\r\nimport { LocaleService } from '@farris/ui-locale';\r\n\r\n@Component({\r\n    selector: 'f-file-preview',\r\n    templateUrl: './f-file-preview.component.html',\r\n    styleUrls: ['./f-file-preview.component.css'],\r\n    encapsulation: ViewEncapsulation.None\r\n})\r\nexport class FFilePreviewComponent implements OnInit, OnChanges {\r\n    @HostBinding('class.ffilepreview--wrapper') cls = true;\r\n    @HostBinding('class.ffilepreview-unvisible') get visibleState() {\r\n        return !this.visible;\r\n    }\r\n    // 只读的状态，控制附件是否可删除\r\n    @Input() readonly = true;\r\n    private _defaultItemCls = '';\r\n    @Input()\r\n    set defaultItemCls(value: string) {\r\n        this._defaultItemCls = value;\r\n    }\r\n    get defaultItemCls(): string {\r\n        //如果有自定义的值\r\n        if (this._defaultItemCls) {\r\n            return this._defaultItemCls + ' ';\r\n        }\r\n        // 如果有自定义模板\r\n        if (this.listTypeTemplate) {\r\n            return 'ffilepreview--item ';\r\n        }\r\n        return this.type == 'list' ? 'ffilepreview--item ' : 'ffilepreview--item col-sm-12 col-md-6 col-xl-3 col-el-2 ';\r\n    }\r\n    @Input() visible = true;\r\n    // 是否启用批量操作\r\n    @Input() enableMulti = false;\r\n    // list类型 card类型\r\n    @Input() type = \"list\";\r\n    // 列项上的class\r\n    @Input() itemCls = \"\";\r\n    // Header的class\r\n    @Input() headerCls = '';\r\n    // 启用重命名\r\n    @Input() canRename = false;\r\n    // 默认重命名\r\n    @Input() defaultRename = '';\r\n    // \r\n    @Input() enableCardAreaResponse = true;\r\n    // 标记是否显示重命名输入框\r\n    showRenameInput = false;\r\n    @ViewChild('multiRenameInput') multiRenameRef: ElementRef;\r\n    //@Input() fileInfos:FUploadFileExtend[]=[];\r\n    private _fileInfos: FUploadFileExtend[] = [];\r\n    @Input()\r\n    set fileInfos(val: FUploadFileExtend[]) {\r\n        this._fileInfos = this.formatDatas(val);;\r\n    }\r\n    get fileInfos(): FUploadFileExtend[] {\r\n        return this._fileInfos;\r\n    };\r\n    // 附件预览信息，抛出对象给第三方处理\r\n    @Output() filePreviewEvent = new EventEmitter<FUploadFileExtend>();\r\n    // 附件下载事件，抛出对象给第三方处理\r\n    @Output() fileDownloadEvent = new EventEmitter<{ fileInfos: FUploadFileExtend[], name: string }>();\r\n    @Output() multiSelectedEvent = new EventEmitter<FUploadFileExtend[]>();\r\n    // 附件删除事件，抛出对象给第三方处理\r\n    @Output() fileRemoveEvent = new EventEmitter<FUploadFileExtend>();\r\n    @ContentChild(FFilePreviewListTypeTemplateDirective, { read: TemplateRef }) listTypeTemplate: TemplateRef<any>;\r\n    @ContentChild(FFilePreviewToolbarTemplateDirective, { read: TemplateRef }) toolbarTemplate: TemplateRef<any>;\r\n    multiSelected: FUploadFileExtend[] = [];\r\n    // 全选状态\r\n    selectAllBtnChecked = false;\r\n    settings = {\r\n        readonly: this.readonly,\r\n        visible: this.visible,\r\n        enableMulti: this.enableMulti\r\n    };\r\n    /**2023年12月23日，标记\r\n     * 预览组件，没有多语言服务相关的，\r\n     * 如果只有预览组件，重新生成、编译，也会获取多语言服务。\r\n     */\r\n    private hasLocalSer=false;\r\n    constructor(private cd: ChangeDetectorRef,@Optional() private inject:Injector) {\r\n         // 看是否多语言服务已更新\r\n         this.hasLocalSer=FFileUtils.getLocalState(null);\r\n         // 为多语言服务赋值\r\n         if(this.inject&&!this.hasLocalSer){\r\n            this.hasLocalSer=FFileUtils.getLocalState(this.inject.get(LocaleService));\r\n         }\r\n    }\r\n    ngOnInit() {\r\n\r\n    }\r\n    ngOnChanges(changes: SimpleChanges) {\r\n        // if (changes['enableMultiDownload']) {\r\n        //     this.formatDatas(this.fileInfos);\r\n        // }\r\n    }\r\n    /**\r\n     * 格式化数据\r\n     * @param val \r\n     */\r\n    formatDatas(val) {\r\n        if (this.enableMulti) {\r\n            let formatValue= val.map((item: FUploadFileExtend) => {\r\n                // if (!item.hasOwnProperty('checked')) {\r\n                //     //\r\n                //     let findItem = this._fileInfos.find(olditem => {\r\n                //         return item.id == olditem.id;\r\n                //     });\r\n                //     if (findItem && findItem.hasOwnProperty('checked')) {\r\n                //         item['checked'] = findItem['checked'];\r\n                //     } else {\r\n                //         item['checked'] = this.selectAllBtnChecked;\r\n                //     }\r\n                // }\r\n                item['checked'] = this.selectAllBtnChecked;\r\n                return item;\r\n            });\r\n            // 归集已选数据\r\n            if(this.selectAllBtnChecked){\r\n                this.multiSelected=[...formatValue];\r\n            }else{\r\n                this.multiSelected=[];\r\n            }\r\n            // 返回格式化数据\r\n            return formatValue;\r\n        } else {\r\n            return val;\r\n        }\r\n    }\r\n    /**\r\n     * 预览\r\n     * @param ev \r\n     * @param fileInfo \r\n     */\r\n    filePreviewHandler(ev: Event, fileInfo: FUploadFileExtend) {\r\n        ev.stopImmediatePropagation();\r\n        this.filePreviewEvent.emit(fileInfo);\r\n    }\r\n    /**\r\n     * 下载\r\n     * @param ev \r\n     * @param fileInfo \r\n     */\r\n    fileDownloadHandler(ev: Event, fileInfo: FUploadFileExtend) {\r\n        ev.stopImmediatePropagation();\r\n        this.fileDownloadEvent.emit({ fileInfos: [fileInfo], name: '' });\r\n    }\r\n    fileMultiDownloadHandler(ev: Event) {\r\n        ev.stopImmediatePropagation();\r\n        let rename = '';\r\n        if (this.showRenameInput) {\r\n            rename = this.multiRenameRef.nativeElement.value;\r\n        }\r\n        if (rename == '') {\r\n            rename = this.defaultRename;\r\n        }\r\n        this.fileDownloadEvent.emit({ fileInfos: this.multiSelected, name: rename });\r\n    }\r\n    /**\r\n     * checkbox多选\r\n     * @param ev \r\n     */\r\n    multiSelectChange(ev) {\r\n        let hasInArray = this.multiSelected.findIndex(item => item['id'] == ev['id']);\r\n        let findInArray = this.fileInfos.findIndex(item => item['id'] == ev['id']);\r\n        if (findInArray > -1) {\r\n            this.fileInfos[findInArray]['checked'] = ev['checked'];\r\n        }\r\n\r\n        if (ev['checked']) {\r\n            //选入\r\n            if (hasInArray == -1) {\r\n                if (findInArray > -1) {\r\n                    this.multiSelected.push(this.fileInfos[findInArray]);\r\n                }\r\n            }\r\n        } else {\r\n            //移出\r\n            if (hasInArray > -1) {\r\n                this.multiSelected.splice(hasInArray, 1);\r\n            }\r\n        }\r\n        // 判断是否全选\r\n        if (this.fileInfos.length > 0) {\r\n            if (this.multiSelected.length == this.fileInfos.length) {\r\n                //都全选\r\n                this.selectAllBtnChecked = true;\r\n            } else {\r\n                // 未全选\r\n                this.selectAllBtnChecked = false;\r\n            }\r\n        }\r\n        // 抛出多选\r\n        this.multiSelectedEvent.emit(this.multiSelected);\r\n    }\r\n    /**\r\n     * 删除数据\r\n     * @param ev \r\n     * @param fileInfo \r\n     */\r\n    fileRemoveHandler(ev: Event, fileInfo: FUploadFileExtend) {\r\n        ev.stopImmediatePropagation();\r\n        this.fileRemoveEvent.emit(fileInfo);\r\n    }\r\n    /**\r\n     * 获取文档类型对应的class\r\n     * @param fileName \r\n     */\r\n    getFileTypeClassName(fileName) {\r\n        let clsName = 'ffilepreview--filetype';\r\n        // 如果名称为空\r\n        if (!fileName) {\r\n            return clsName + '-any';\r\n        }\r\n        let lastDotIndex = fileName.lastIndexOf(\".\");\r\n        let fileSuffix = '';\r\n        if (lastDotIndex > -1) {\r\n            fileSuffix = fileName.substring(lastDotIndex + 1).toLocaleLowerCase();\r\n        }\r\n        switch (fileSuffix) {\r\n            case 'pdf':\r\n                clsName += '-pdf';\r\n                break;\r\n            case 'jpeg':\r\n            case 'jpg':\r\n            case 'gif':\r\n            case 'svg':\r\n            case 'png':\r\n            case 'bmp':\r\n                clsName += '-img';\r\n                break;\r\n            case 'ppt':\r\n            case 'pptx':\r\n                clsName += '-ppt';\r\n                break;\r\n            case 'doc':\r\n            case 'docx':\r\n                clsName += '-doc';\r\n                break;\r\n            case 'xls':\r\n            case 'xlsx':\r\n                clsName += '-xls';\r\n                break;\r\n            case 'txt':\r\n                clsName += '-txt';\r\n                break;\r\n            case 'zip':\r\n                clsName += '-zip';\r\n                break;\r\n            default:\r\n                clsName += '-any';\r\n        }\r\n        return clsName;\r\n    }\r\n    \r\n    /**\r\n     * 是不是有附件名称\r\n     * @param name \r\n     */\r\n    hasFileName(name): boolean {\r\n        if (!name) {\r\n            return false;\r\n        }\r\n        return true;\r\n    }\r\n    /**\r\n     * 选择或取消所有\r\n     * @param ev \r\n     */\r\n    selectOrCancelAllHandler(ev) {\r\n        if (ev['checked']) {\r\n            // 全选\r\n            this.fileInfos.forEach(item => {\r\n                item.checked = true;\r\n            });\r\n            this.multiSelected = [...this.fileInfos];\r\n            this.selectAllBtnChecked = true;\r\n\r\n        } else {\r\n            // 取消\r\n            this.multiSelected = [];\r\n            this.fileInfos.forEach(item => {\r\n                item.checked = false;\r\n            });\r\n            this.selectAllBtnChecked = false;\r\n        }\r\n        this.cd.detectChanges();\r\n    }\r\n    /**\r\n     * 显示隐藏输入名称\r\n     */\r\n    toggleRenameInput(ev) {\r\n        ev.stopPropagation();\r\n        this.showRenameInput = !this.showRenameInput;\r\n        if (!this.multiRenameRef.nativeElement.value) {\r\n            this.multiRenameRef.nativeElement.value = this.defaultRename;\r\n        }\r\n    }\r\n}\r\n","import {\r\n    Component,\r\n    OnInit,\r\n    Input,\r\n    Output,\r\n    EventEmitter,\r\n    HostBinding,\r\n} from \"@angular/core\";\r\n\r\n@Component({\r\n    selector: \"f-file-preview-checkbox\",\r\n    templateUrl: \"./preview-checkbox.component.html\",\r\n    styleUrls: [],\r\n})\r\nexport class PreviewCheckboxComponent implements OnInit {\r\n    @HostBinding(\"class.align-middle\") cls1 = true;\r\n    @HostBinding(\"class.d-inline-flex\") cls2 = true;\r\n    @HostBinding(\"class.preview-checkbox\") cls3 = true;\r\n\r\n    @Input() checked: boolean = false;\r\n    @Input() id: string;\r\n    @Input() disabled: boolean = false;\r\n\r\n    @Input() showDragBar = false;\r\n\r\n    @Output() checkedChange = new EventEmitter();\r\n\r\n    constructor() { }\r\n\r\n    ngOnInit() { }\r\n\r\n    clickHandler(event) {\r\n        event.stopPropagation();\r\n        if (!this.disabled) {\r\n            this.checked = !this.checked;\r\n            this.checkedChange.emit({ checked: this.checked, id: this.id });\r\n        }\r\n    }\r\n}\r\n","import { Component, OnInit, Input, ElementRef, ViewChild, AfterViewInit, HostBinding, SimpleChange } from '@angular/core';\r\nimport { FUploadFileExtend } from '../../model';\r\n\r\n@Component({\r\n  selector: 'ffile-multi-download-info',\r\n  templateUrl: './multi-download-info.component.html',\r\n  styleUrls: ['./multi-download-info.component.css']\r\n})\r\nexport class MultiDownloadInfoComponent implements OnInit,AfterViewInit {\r\n  @HostBinding('class.ffile-multi-download-info') cls=true;\r\n  @ViewChild('multiRenameInput') multiRenameRef: ElementRef;\r\n  // 记载下载数据\r\n  private _downloadInfos: FUploadFileExtend[] = [];\r\n  @Input()\r\n  set downloadInfos(value) {\r\n    if (value && value.length > 0) {\r\n      this._downloadInfos = value;\r\n      if (!this._downloadName) {\r\n        this.downloadName = this.getName(this._downloadInfos[0]['name']);\r\n      }\r\n    }\r\n  }\r\n  get downloadInfos() {\r\n    return this._downloadInfos;\r\n  }\r\n  // 默认名称\r\n  private _downloadName = '';\r\n  @Input()\r\n  set downloadName(value: string) {\r\n    this._downloadName=value;    \r\n  }\r\n  get downloadName() {\r\n    if(!this._downloadName&&this._downloadInfos.length>0){\r\n      this._downloadName = this.getName(this._downloadInfos[0]['name']);\r\n    }    \r\n    return this._downloadName;\r\n  }\r\n\r\n  fileTypeCls = '';\r\n\r\n  constructor() { }\r\n\r\n  ngOnInit() {\r\n   \r\n  }\r\n  ngAfterViewInit(){\r\n    //this.multiRenameRef.nativeElement.value = this.downloadName;\r\n  }\r\n  /**\r\n   * 获取下载名称\r\n   */\r\n  getDownloadName() {\r\n    return  this.multiRenameRef.nativeElement.value;\r\n  }\r\n  private getName(name: string) {\r\n    if (name.lastIndexOf('.') > 0) {\r\n      return name.substring(0, name.lastIndexOf('.'));\r\n    }\r\n    return '';\r\n  }\r\n\r\n  getFileTypeClassName(filename: string) {\r\n\r\n  }\r\n}\r\n","import {\r\n  Component,\r\n  OnInit,\r\n  AfterViewInit,\r\n  ElementRef,\r\n  Input,\r\n  Output,\r\n  EventEmitter,\r\n  HostBinding,\r\n  ViewChild,\r\n  TemplateRef,\r\n  NgZone,\r\n  ChangeDetectorRef,\r\n  OnChanges,\r\n  SimpleChanges,\r\n  ViewEncapsulation,\r\n  Optional,\r\n  Injector,\r\n} from \"@angular/core\";\r\nimport { NotifyService, NotifyOptions } from \"@farris/ui-notify\";\r\nimport { BsModalService } from \"@farris/ui-modal\";\r\nimport {\r\n  FFileUploadAPIService,\r\n  FFileUploaderService,\r\n} from \"../../service/index\";\r\nimport { FFileSelectDirective } from \"../../directive/index\";\r\nimport { MultiDownloadInfoComponent } from \"../multi-download-info/multi-download-info.component\";\r\nimport {\r\n  UploadOutput,\r\n  UploadInput,\r\n  UploadFile,\r\n  UploaderOptions,\r\n  FUploadFileExtend,\r\n  DocMetaProperty,\r\n  UploadStatus,\r\n  ColumnData,\r\n} from \"../../model/index\";\r\nimport { Observable, Subject } from \"rxjs\";\r\nimport { FFileUtils } from \"../../utils/index\";\r\nimport {\r\n  trigger,\r\n  style,\r\n  state,\r\n  animate,\r\n  transition,\r\n} from \"@angular/animations\";\r\n\r\nimport ResizeObserver from \"resize-observer-polyfill\";\r\nimport { LocaleService } from \"@farris/ui-locale\";\r\nimport { DateTimeHelperService } from \"@farris/ui-common/date\";\r\nimport { WEBAPI_PREFIX_TOKEN } from \"@farris/ui-common\";\r\n\r\nexport type CanEditableFn = (fileInfo: any) => boolean;\r\nexport type FileCanEditable = CanEditableFn | boolean;\r\nexport enum DocModeType {\r\n  Normal = \"normal\", //默认模式，不开启修订模式，隐藏标记\r\n  RevisionOnly = \"revisionOnly\", //仅修订模式，开启修订模式，但是用户不可接受或拒绝修订、不可接受所有修订\r\n  Admin = \"admin\", //开启修订，用户可接受或拒绝修订、可接受所有修订\r\n}\r\n\r\n@Component({\r\n  selector: \"f-file-upload-and-preview\",\r\n  templateUrl: \"./upload-and-preview.component.html\",\r\n  styleUrls: [\"./upload-and-preview.component.css\"],\r\n  providers: [FFileUploaderService],\r\n  animations: [\r\n    trigger(\"hideUploaded\", [\r\n      state(\"show\", style({ opacity: 1, height: \"*\" })),\r\n      state(\"hide\", style({ opacity: 0, height: 0 })),\r\n      // transition('* => void', [\r\n      //   style({ opacity: 1}),\r\n      //   animate(200, style({ opacity: 0}))\r\n      // ])\r\n      transition(\"* => hide\", animate(\"0.5s\")),\r\n    ]),\r\n  ],\r\n  encapsulation: ViewEncapsulation.None,\r\n})\r\nexport class UploadAndPreviewComponent\r\n  implements OnInit, AfterViewInit, OnChanges {\r\n  @HostBinding(\"class.ffileUploadAndPreview\") cls = true;\r\n  @HostBinding(\"class.ffileUploadAndPreview-content-fill\") get fillState() {\r\n    return this.contentFill;\r\n  }\r\n  // 预览模板\r\n  @ViewChild(\"previewFileNameTmpl\") previewFileNameTmpl: TemplateRef<void>;\r\n  // 文件大小模板\r\n  @ViewChild(\"fileSizeTmpl\") fileSizeTmpl: TemplateRef<void>;\r\n  // 文件状态模板\r\n  @ViewChild(\"uapStateTmpl\") uapStateTmpl: TemplateRef<void>;\r\n  // 预览操作模板\r\n  @ViewChild(\"previewActionTmpl\") previewActionTmpl: TemplateRef<void>;\r\n  // 预览操作模板\r\n  @ViewChild(\"previewDateTmpl\") previewDateTmpl: TemplateRef<void>;\r\n  // 上传操作模板\r\n  @ViewChild(\"uploadFileNameTmpl\") uploadFileNameTmpl: TemplateRef<void>;\r\n  /**\r\n   * 每个组可以设置特殊服务参数，来覆盖默认的统一模块级配置\r\n   */\r\n  @Input()\r\n  set extendServerConfig(config: any) {\r\n    if (config) {\r\n      this.fileUploaderSer.setExtendServerConfig(config);\r\n    }\r\n  }\r\n  // 内容区域填充\r\n  @Input() contentFill = false;\r\n  /** 启用手动调整展示顺序 */\r\n  @Input() enableOrder = false;\r\n  /** 排序字段 */\r\n  @Input() orderField = \"order\";\r\n  /** 是否允许编辑文档，默认为 false */\r\n  @Input() editfile: FileCanEditable = false;\r\n  // doc文档打开模式，预设3种模式，默认normal\r\n  private _docMode = DocModeType.Normal;\r\n  @Input()\r\n  set docMode(value) {\r\n    switch (value) {\r\n      case DocModeType.Normal:\r\n      case DocModeType.Admin:\r\n      case DocModeType.RevisionOnly:\r\n        this._docMode = value;\r\n        break;\r\n      default:\r\n        this._docMode = DocModeType.Normal;\r\n    }\r\n  }\r\n  get docMode() {\r\n    return this._docMode;\r\n  }\r\n  private _renameFromDialog = \"\";\r\n  // 记录列字段\r\n  private _previewColumnsFields = [];\r\n  /**\r\n   * 预置列信息\r\n   * 调整：\r\n   * 1、把列上的checkbox属性去掉，改为只有启用批量选择时，第一列才会有多选，不允许其他列有多选\r\n   * 2、解决field重名问题，通过判断是否extend=true来判断，是否是自定义列，如果是自定义列，不使用默认的模版\r\n   */\r\n  private _presetPreviewColumns:Array<ColumnData> = [\r\n    { field: \"name\", width: 200, title: \"文件名\"},\r\n    { field: \"size\", width: 100, title: \"大小\" },\r\n    { field: \"createTime\", width: 100, title: \"日期\" },\r\n    { field: \"state\", width: 100, title: \"状态\" },\r\n    { field: \"action\", width: 120, title: \"操作\" },\r\n  ];\r\n  // 内部记录列信息,与命令构件约定\r\n  private _previewColumns = [];\r\n  @Input()\r\n  set previewColumns(value) {\r\n    if (value) {\r\n      this._previewColumns = [...value];\r\n    } else {\r\n      this._presetPreviewColumns = [...this._presetPreviewColumns];\r\n    }\r\n    this.getFieldsFromColumns();\r\n  }\r\n  get previewColumns() {\r\n    return this._previewColumns;\r\n  }\r\n  // 格式化预览数据\r\n  private _fileInfos: FUploadFileExtend[] = [];\r\n  // 处理扩展数据 数组\r\n  @Input() extendInfos;\r\n\r\n  @Input()\r\n  set fileInfos(val: FUploadFileExtend[]) {\r\n    this._fileInfos = this.formatPreviewDatas(val);\r\n    this._renameFromDialog = \"\";\r\n  }\r\n  get fileInfos(): FUploadFileExtend[] {\r\n    return this._fileInfos;\r\n  }\r\n  /**\r\n   * 附件预览配置---------------------------------------开始\r\n   */\r\n  @Input() previewDateFormat = \"yyyy-MM-dd\";\r\n  // 只读的状态，控制附件是否可删除\r\n  // 默认处于查看状态\r\n  @Input() previewReadonly = true;\r\n\r\n  @Input() previewVisible = true;\r\n  // 是否启用批量操作\r\n  @Input() previewEnableMulti = true;\r\n  // 预览显示类别\r\n  @Input() previewShowType = \"list\";\r\n  // 启用重命名\r\n  @Input() previewEnableRename = true;\r\n  // 默认重命名\r\n  @Input() previewDefaultRename = \"\";\r\n  // 预览是否显示修订记录\r\n  @Input() previewShowComments = false;\r\n  // 预览是否在非模态窗口\r\n  @Input() previewModeless=false;\r\n  // 附件预览，预览事件\r\n  @Output() filePreviewEvent = new EventEmitter<FUploadFileExtend>();\r\n  // 附件预览，下载事件，抛出对象给第三方处理\r\n  @Output() fileDownloadEvent = new EventEmitter<{\r\n    fileInfos: FUploadFileExtend[];\r\n    name: string;\r\n  }>();\r\n  // 附件预览，多选事件\r\n  @Output() fPreviewMultiSelectedEvent = new EventEmitter<\r\n    FUploadFileExtend[]\r\n  >();\r\n  // 当前行\r\n  @Output() fSelectedEvent=new EventEmitter<FUploadFileExtend>();\r\n  // 附件预览，删除事件，抛出对象给第三方处理\r\n  @Output() fileRemoveEvent = new EventEmitter<FUploadFileExtend[]>();\r\n  // 全选状态\r\n  previewSelectAllBtnChecked = false;\r\n  // 记录选中数据\r\n  previewMultiSelected: FUploadFileExtend[] = [];\r\n  // 记录当前行数据\r\n  previewCurrent:string=\"\";\r\n  // 构造预览的配置数据\r\n  get previewSettings() {\r\n    return {\r\n      readonly: this.previewReadonly,\r\n      visible: this.previewVisible,\r\n      enableMulti: this.previewEnableMulti,\r\n      enableRename: this.previewEnableRename,\r\n    };\r\n  }\r\n  \r\n  /**\r\n   * 下载或者删除的状态，应用在如下场景\r\n   * 比如：只要允许下载或者删除，就可以显示多选框\r\n   */\r\n  get downloadOrDeleteState(){\r\n    //删除没有单独控制的时候跟着下载的状态走\r\n    if(this.noDelete=='default') return !this.noDownload;\r\n    return !this.noDownload||!this.noDelete;\r\n  }\r\n  /**\r\n   * 附件预览配置---------------------------------------结束\r\n   */\r\n\r\n  /**\r\n   * 附件上传配置---------------------------------------开始\r\n   */\r\n  // 附件上传选择指令\r\n  @ViewChild(FFileSelectDirective) fileUpload: FFileSelectDirective;\r\n  // 附件上传部分禁用状态\r\n  @Input() uploadDisabled = false;\r\n  private tUploadVisible = true;\r\n\r\n  // 附件上传部分是否可见\r\n  @Input()\r\n  set uploadVisible(value) {\r\n    this.tUploadVisible = value;\r\n    if (!value) {\r\n      this.uploadReset();\r\n    }\r\n  }\r\n  get uploadVisible() {\r\n    return this.tUploadVisible;\r\n  }\r\n  // 需要重置,通过不断的赋值来改变\r\n  @Input() uploadNeedReset: Observable<any> = new Subject();\r\n  // 启用选择文件按钮\r\n  @Input() uploadEnableSelect = true;\r\n  // 选择文件按钮上传问题\r\n  @Input() uploadSelectText = \"上传附件\";\r\n  // 启用多选\r\n  @Input() uploadEnableMulti = true;\r\n  // 已经上传文件\r\n  @Input() uploadedCount = 0;\r\n  // 公共的扩展数据\r\n  @Input() extendDatas: {\r\n    [key: string]: any;\r\n    extProperty?: DocMetaProperty | null; //\r\n  };\r\n\r\n  /** 整个控件禁用 */\r\n  @Input() disabled = false;\r\n  /** 禁止下载 */\r\n  @Input() noDownload = false;\r\n  /** 禁止预览 */\r\n  @Input() noPreview = false;\r\n  /**禁止删除,约定default是默认，按照noDownload的状态走 */\r\n  @Input() noDelete='default';\r\n  /**\r\n   * 是否内部排序\r\n   * 目的：命令构件会根据新指令指定字段进行排序，不需要进行内部排序。为了区分内外排序。\r\n   */\r\n @Input() enableSorting=true;\r\n\r\n  @Input()\r\n  set uploadOptions(uploadOpts: UploaderOptions) {\r\n    if (uploadOpts) {\r\n      if (uploadOpts.hasOwnProperty(\"allowedContentTypes\")) {\r\n        this.allowedContentTypes = uploadOpts.allowedContentTypes.join(\",\");\r\n        this.allowedContentTypes =\r\n          this.allowedContentTypes == \"\" ? \"*\" : this.allowedContentTypes;\r\n      }\r\n      if (uploadOpts.hasOwnProperty(\"maxUploads\")) {\r\n        this.maxUploads = uploadOpts.maxUploads;\r\n      }\r\n      if (uploadOpts.hasOwnProperty(\"maxFileSize\")) {\r\n        this.maxFileSize = FFileUtils.humanizeBytes(\r\n          1024 * 1024 * uploadOpts.maxFileSize\r\n        );\r\n      }\r\n      if(uploadOpts.hasOwnProperty(\"notAllowedCharsInFileName\")){\r\n        let tNotAllowed=uploadOpts['notAllowedCharsInFileName'];\r\n        this.notAllowedCharsInFileName=tNotAllowed&&tNotAllowed.length>0?[...tNotAllowed]:[];\r\n      }\r\n      this.selfUploadOpts = Object.assign(this.selfUploadOpts, uploadOpts);\r\n    }\r\n  }\r\n  get uploadOptions() {\r\n    return this.selfUploadOpts;\r\n  }\r\n   /** 启用分块上传 */\r\n   @Input() enableSliceUpload = false;\r\n   /** 分块上传每片大小，单位：M, 默认 1M/块 */\r\n   @Input() chunkSize = 1;\r\n  // 展示用户自定义的信息\r\n  @Input() customInfo: any;\r\n  // 附件上传中，上传完成抛出的事件\r\n  @Output() fUploadDoneEvent = new EventEmitter<FUploadFileExtend[]>();\r\n  // 附件上传中，删除附件事件\r\n  @Output() fUploadRemovedEvent = new EventEmitter<FUploadFileExtend[]>();\r\n\r\n  /** 文件放下事件 */\r\n  @Output() afterOrdered = new EventEmitter();\r\n\r\n  @ViewChild(\"uaptb\") uploadAndPreviewTbodyRef: ElementRef<any>;\r\n\r\n  private uploadAndPreviewTableHeader: ElementRef = null;\r\n  private uploadAndPreviewTableHeaderCreated$ = new Subject();\r\n  @ViewChild(\"uapth\") set uploadAndPreviewTheadRef(th: ElementRef) {\r\n    if (th) {\r\n      this.uploadAndPreviewTableHeader = th;\r\n      this.setColumnWidth();\r\n      this.ro.observe(th.nativeElement);\r\n      this.uploadAndPreviewTableHeaderCreated$.next(th);\r\n    } else {\r\n      this.uploadAndPreviewTableHeader = null;\r\n      if (this.ro) {\r\n        this.ro.disconnect();\r\n      }\r\n      this.uploadAndPreviewTableHeaderCreated$.next(null);\r\n    }\r\n  }\r\n  get uploadSettings() {\r\n    return {\r\n      disabled: this.uploadDisabled,\r\n      visible: this.uploadVisible,\r\n      enableMulti: this.uploadEnableMulti,\r\n      extendDatas: this.extendDatas,\r\n    };\r\n  }\r\n  // 允许上传的文件类型\r\n  allowedContentTypes = \"*\";\r\n  // 默认不限制附件上传个数\r\n  maxUploads = 0;\r\n  // 单位KB，默认是12M\r\n  maxFileSize = \"12MB\";\r\n  // 记录文件个数\r\n  uploadFiles: UploadOutput[];\r\n  // 附件名称中不允许的字符\r\n  notAllowedCharsInFileName=[];\r\n  // 标记通过选择按钮处理的事件\r\n  uploadSelectInput: EventEmitter<UploadInput>;\r\n  private selfUploadOpts: UploaderOptions = {};\r\n\r\n  private ro: ResizeObserver | null = null;\r\n\r\n  private localSer: LocaleService = null;\r\n\r\n  private dateHlp: DateTimeHelperService;\r\n\r\n  tips = {\r\n    download: \"下载\",\r\n    preview: \"预览\",\r\n    remove: \"删除\",\r\n    edit: \"编辑\",\r\n    notedit: \"此类型文件不支持在线编辑\",\r\n  };\r\n  // 处理基路径\r\n  perfixStr='';\r\n  /**\r\n   * 附件上传配置---------------------------------------结束\r\n   */\r\n\r\n  /**\r\n   *\r\n   * @param el\r\n   * @param uploadAPISer\r\n   * @param fileUploaderSer\r\n   * @param notifyService\r\n   * @param ngZone\r\n   */\r\n  constructor(\r\n    private el: ElementRef,\r\n    private uploadAPISer: FFileUploadAPIService,\r\n    private fileUploaderSer: FFileUploaderService,\r\n    private notifyService: NotifyService,\r\n    private ngZone: NgZone,\r\n    private modalSer: BsModalService,\r\n    private cd: ChangeDetectorRef,\r\n    @Optional() private inject:Injector\r\n  ) {\r\n    if (!Array.prototype.includes) {\r\n      Object.defineProperty(Array.prototype, \"includes\", {\r\n        value: function (valueToFind, fromIndex) {\r\n          if (this == null) {\r\n            throw new TypeError('\"this\" is null or not defined');\r\n          }\r\n          var o = Object(this);\r\n          var len = o.length >>> 0;\r\n          if (len === 0) {\r\n            return false;\r\n          }\r\n          var n = fromIndex | 0;\r\n          var k = Math.max(n >= 0 ? n : len - Math.abs(n), 0);\r\n          function sameValueZero(x, y) {\r\n            return (\r\n              x === y ||\r\n              (typeof x === \"number\" &&\r\n                typeof y === \"number\" &&\r\n                isNaN(x) &&\r\n                isNaN(y))\r\n            );\r\n          }\r\n          while (k < len) {\r\n            if (sameValueZero(o[k], valueToFind)) {\r\n              return true;\r\n            }\r\n            k++;\r\n          }\r\n          return false;\r\n        },\r\n      });\r\n    }\r\n    if(this.inject){\r\n      if(WEBAPI_PREFIX_TOKEN){\r\n          this.perfixStr = this.inject.get(WEBAPI_PREFIX_TOKEN, '');\r\n      }\r\n   }\r\n    this.uploadFiles = [];\r\n    this.uploadSelectInput = new EventEmitter<UploadInput>();\r\n    // 重置----------可能有问题\r\n    this.uploadNeedReset.subscribe((data) => {\r\n      this.uploadReset();\r\n    });\r\n\r\n    this.ro = new ResizeObserver((e) => {\r\n      this.setColumnWidth();\r\n    });\r\n    this.localSer = this.notifyService.localeService;\r\n    FFileUtils.getLocalState(this.localSer);\r\n    this._presetPreviewColumns.forEach((col) => {\r\n      col.title = FFileUtils.getLocalStr(`uploadAndPreview.columns.${col.field}`);\r\n    });\r\n\r\n    this.tips.download =FFileUtils.getLocalStr(\"uploadAndPreview.tips.download\");\r\n    this.tips.preview =FFileUtils.getLocalStr(\"uploadAndPreview.tips.preview\");\r\n    this.tips.remove = FFileUtils.getLocalStr(\"uploadAndPreview.tips.remove\");\r\n    this.tips.edit =FFileUtils.getLocalStr(\"uploadAndPreview.tips.edit\");\r\n    this.tips.notedit =FFileUtils.getLocalStr(\"uploadAndPreview.tips.notedit\");\r\n\r\n    this.dateHlp = new DateTimeHelperService();\r\n  }\r\n\r\n  ngOnInit() {\r\n    if (this._previewColumns.length == 0) {\r\n      this.previewColumns = [...this._presetPreviewColumns];\r\n    }\r\n  }\r\n  ngAfterViewInit() { }\r\n\r\n  ngOnChanges(changes: SimpleChanges): void {\r\n    const {\r\n      previewReadonly,\r\n      previewVisible,\r\n      previewEnableMulti,\r\n      previewDefaultRename,\r\n    } = changes;\r\n    if (previewReadonly || previewVisible || previewEnableMulti) {\r\n      this.previewUpdateRefresh();\r\n    }\r\n    if (previewDefaultRename) {\r\n      // 重置预览重命名记录\r\n      this._renameFromDialog = \"\";\r\n    }\r\n  }\r\n  /**\r\n   * 选择或取消所有\r\n   * @param ev\r\n   */\r\n  selectOrCancelAllHandler(ev) {\r\n    if (ev[\"checked\"]) {\r\n      // 全选\r\n      this.fileInfos.forEach((item) => {\r\n        item.checked = true;\r\n      });\r\n      this.previewMultiSelected = [...this.fileInfos];\r\n      this.previewSelectAllBtnChecked = true;\r\n    } else {\r\n      // 取消\r\n      this.previewMultiSelected = [];\r\n      this.fileInfos.forEach((item) => {\r\n        item.checked = false;\r\n      });\r\n      this.previewSelectAllBtnChecked = false;\r\n    }\r\n    // 抛出多选\r\n    this.fPreviewMultiSelectedEvent.emit(this.previewMultiSelected);\r\n    // 解决附件在丛丛表时，从表处于编辑状态时，勾选附件界面不变更的问题\r\n    this.cd.detectChanges();\r\n  }\r\n  /**\r\n   * 格式化文件大小\r\n   * @param bytes\r\n   */\r\n  formateBytes(bytes) {\r\n    return FFileUtils.humanizeBytes(bytes);\r\n  }\r\n  /**\r\n   * 获取文档类型对应的class\r\n   * @param fileName\r\n   */\r\n  getFileTypeClassName(fileName) {\r\n    let clsName = \"ffilepreview--filetype\";\r\n    // 如果名称为空\r\n    if (!fileName) {\r\n      return clsName + \"-any\";\r\n    }\r\n    let lastDotIndex = fileName.lastIndexOf(\".\");\r\n    let fileSuffix = \"\";\r\n    if (lastDotIndex > -1) {\r\n      fileSuffix = fileName.substring(lastDotIndex + 1).toLocaleLowerCase();\r\n    }\r\n    switch (fileSuffix) {\r\n      case \"pdf\":\r\n        clsName += \"-pdf\";\r\n        break;\r\n      case \"jpeg\":\r\n      case \"jpg\":\r\n      case \"gif\":\r\n      case \"svg\":\r\n      case \"png\":\r\n      case \"bmp\":\r\n        clsName += \"-img\";\r\n        break;\r\n      case \"ppt\":\r\n      case \"pptx\":\r\n        clsName += \"-ppt\";\r\n        break;\r\n      case \"doc\":\r\n      case \"docx\":\r\n        clsName += \"-doc\";\r\n        break;\r\n      case \"xls\":\r\n      case \"xlsx\":\r\n        clsName += \"-xls\";\r\n        break;\r\n      case \"txt\":\r\n        clsName += \"-txt\";\r\n        break;\r\n      case \"zip\":\r\n        clsName += \"-zip\";\r\n        break;\r\n      case \"wps\":\r\n        clsName += \"-wps\";\r\n        break;\r\n      case \"wpt\":\r\n        clsName += \"-wpt\";\r\n        break;\r\n      default:\r\n        clsName += \"-any\";\r\n    }\r\n    return clsName;\r\n  }\r\n  /**\r\n   * 格式化预览数据\r\n   * @param val\r\n   */\r\n  private formatPreviewDatas(val) {\r\n    if (!val.length || this.previewMultiSelected.length !== val.length) {\r\n      this.previewSelectAllBtnChecked = false;\r\n    }\r\n\r\n    let formatValue = val.map((item: FUploadFileExtend) => {\r\n      if (!item.hasOwnProperty(\"size\")) {\r\n        item[\"size\"] = undefined;\r\n      }\r\n      if (!item.hasOwnProperty(\"createTime\")) {\r\n        item[\"createTime\"] = undefined;\r\n      }\r\n\r\n      return item;\r\n    });\r\n\r\n    if (this.enableOrder && this.orderField) {\r\n      formatValue.sort(this.sortPreviewData(this.orderField));\r\n    } else if(this.enableSorting){\r\n      formatValue.sort(this.sortPreviewData(\"createTime\"));\r\n    }\r\n    if (this.previewEnableMulti) {\r\n      let newFormatValue = formatValue.map((item: FUploadFileExtend) => {\r\n        item[\"checked\"] =\r\n          !!this.previewMultiSelected.find((n) => n.id === item.id) ||\r\n          this.previewSelectAllBtnChecked;\r\n        return item;\r\n      });\r\n      // 归集已选数据\r\n      // if (this.previewSelectAllBtnChecked) {\r\n      //     this.previewMultiSelected = [...newFormatValue].filter(n => n.checked);\r\n      // } else {\r\n      //     this.previewMultiSelected = [];\r\n      // }\r\n      this.previewMultiSelected = [...newFormatValue].filter((n) => n.checked);\r\n      // 返回格式化数据\r\n      return newFormatValue;\r\n    } else {\r\n      return formatValue;\r\n    }\r\n  }\r\n\r\n  private getValue(field: string, data: any) {\r\n    if (!data) {\r\n      return \"\";\r\n    }\r\n    let resultVal = \"\";\r\n    if (field.indexOf(\".\") === -1 && data.hasOwnProperty(field)) {\r\n      resultVal = data[field];\r\n    } else {\r\n      resultVal = field.split(\".\").reduce((obj, key) => {\r\n        if (obj) {\r\n          return obj[key];\r\n        } else {\r\n          return null;\r\n        }\r\n      }, data);\r\n    }\r\n    return resultVal;\r\n  }\r\n\r\n  private sortPreviewData(key) {\r\n    const _this = this;\r\n    return (x, y) => {\r\n      // 如果没有这个key属性\r\n      if (!x.hasOwnProperty(key)||x[key]===undefined||x[key]===null) {\r\n        return 1;\r\n      }\r\n      if (!y.hasOwnProperty(key)||y[key]===undefined||y[key]===null) {\r\n        return -1;\r\n      }\r\n\r\n      if (_this[\"orderField\"] && key === _this[\"orderField\"]) {\r\n        let a = \"\";\r\n        let b = \"\";\r\n        if (key.indexOf(\".\") > -1) {\r\n          a = _this.getValue(key, x);\r\n          b = _this.getValue(key, y);\r\n        } else {\r\n          a = x[key];\r\n          b = y[key];\r\n        }\r\n        return a > b ? 1 : -1;\r\n      } else {\r\n        var oDate1 = new Date(x[key]);\r\n        var oDate2 = new Date(y[key]);\r\n        return oDate1.getTime() > oDate2.getTime() ? -1 : 1;\r\n      }\r\n    };\r\n  }\r\n\r\n  /**\r\n   * 格式化处理数据\r\n   */\r\n  private getFieldsFromColumns() {\r\n    this._previewColumnsFields = this._previewColumns.map(\r\n      (item) => item[\"field\"]\r\n    );\r\n  }\r\n  /**\r\n   * 根据列获取对应的列模板\r\n   * @param columnInfo\r\n   */\r\n  getColumnTemplate(columnInfo, type = \"preview\") {\r\n    let result;\r\n    if(columnInfo.hasOwnProperty('extend')&&columnInfo.extend){\r\n      return \"\";\r\n    }\r\n    if (type == \"preview\") {\r\n      switch (columnInfo[\"field\"]) {\r\n        case \"state\":\r\n          result = this[\"uapStateTmpl\"];\r\n          break;\r\n        case \"name\":\r\n          result = this[\"previewFileNameTmpl\"];\r\n          break;\r\n        case \"action\":\r\n          result = this[\"previewActionTmpl\"];\r\n          break;\r\n        case \"size\":\r\n          result = this[\"fileSizeTmpl\"];\r\n          break;\r\n        case \"createTime\":\r\n          result = this[\"previewDateTmpl\"];\r\n          break;\r\n        default:\r\n          result = \"\";\r\n      }\r\n    } else {\r\n      switch (columnInfo[\"field\"]) {\r\n        case \"state\":\r\n          result = this[\"uapStateTmpl\"];\r\n          break;\r\n        case \"name\":\r\n          result = this[\"uploadFileNameTmpl\"];\r\n          break;\r\n        case \"size\":\r\n          result = this[\"fileSizeTmpl\"];\r\n          break;\r\n        default:\r\n          result = \"\";\r\n      }\r\n    }\r\n    return result;\r\n  }\r\n  /**\r\n   * 多选变更\r\n   */\r\n  previewMultiSelectChange(ev) {\r\n    let hasInArray = this.previewMultiSelected.findIndex(\r\n      (item) => item[\"id\"] == ev[\"id\"]\r\n    );\r\n    let findInArray = this.fileInfos.findIndex(\r\n      (item) => item[\"id\"] == ev[\"id\"]\r\n    );\r\n    if (findInArray > -1) {\r\n      this.fileInfos[findInArray][\"checked\"] = ev[\"checked\"];\r\n    }\r\n\r\n    if (ev[\"checked\"]) {\r\n      //选入\r\n      if (hasInArray == -1) {\r\n        if (findInArray > -1) {\r\n          this.previewMultiSelected.push(this.fileInfos[findInArray]);\r\n        }\r\n        \r\n      }\r\n    } else {\r\n      //移出\r\n      if (hasInArray > -1) {\r\n        this.previewMultiSelected.splice(hasInArray, 1);\r\n      }\r\n    }\r\n    // 判断是否全选\r\n    if (this.fileInfos.length > 0) {\r\n      if (this.previewMultiSelected.length == this.fileInfos.length) {\r\n        //都全选\r\n        this.previewSelectAllBtnChecked = true;\r\n      } else {\r\n        // 未全选\r\n        this.previewSelectAllBtnChecked = false;\r\n      }\r\n    }\r\n    // 只要点击就有当前行 此处肯定有值\r\n    this.fileSelected(null,this.fileInfos[findInArray]);\r\n    // 抛出多选\r\n    this.fPreviewMultiSelectedEvent.emit(this.previewMultiSelected);\r\n    // 解决附件在丛丛表时，从表处于编辑状态时，勾选附件界面不变更的问题\r\n    this.cd.detectChanges();\r\n  }\r\n  /**处理附件上传---------------------------------------------------------开始-- */\r\n  /**\r\n   * 统一触发 附件选择和拖拽附件的事件\r\n   * @param ev\r\n   */\r\n  private inputUploadEventEmit(ev: UploadInput) {\r\n    // 如果文件上传启用\r\n    if (this.uploadEnableSelect) {\r\n      this.uploadSelectInput.emit(ev);\r\n    }\r\n    // this.uploadDragInput.emit(ev);\r\n  }\r\n  /**单个文件上传 */\r\n  startUpload(file: UploadFile): void {\r\n    /**\r\n     * Todo:后续可以从上传区块上取内容进行扩展\r\n     */\r\n    const event: UploadInput = this.uploadAPISer.getAssignAPI(\r\n      \"multipartUpload\",\r\n      {\r\n        file: file,\r\n        type: this.enableSliceUpload ? 'sliceUpload': 'multipartUpload',\r\n        data: this.extendDatas,\r\n        chunkSize: this.chunkSize\r\n      }\r\n    );\r\n    this.inputUploadEventEmit(event);\r\n  }\r\n  /**\r\n   * 当主从表切换数据当前行时，\r\n   * 解决刷新时候已勾选数据的问题\r\n   */\r\n  previewUpdateRefresh(){\r\n      this.previewMultiSelected = [];    \r\n      this.previewSelectAllBtnChecked = false;\r\n      this._renameFromDialog = \"\";\r\n      this.fileInfos.forEach((item) => {\r\n        item.checked = false;\r\n      });\r\n  }\r\n  // 重置方法\r\n  uploadReset() {\r\n    this.uploadFiles = [];\r\n    // 如果文件上传启用\r\n    if (this.uploadEnableSelect) {\r\n      this.fileUpload && this.fileUpload.reset();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 触发绑定\r\n   */\r\n  triggerFileSelect(ev) {\r\n    ev && ev.stopPropagation();\r\n    // 禁用时\r\n    if (this.uploadDisabled) {\r\n      return false;\r\n    }\r\n    this.fileUpload.elementRef.nativeElement.click();\r\n  }\r\n  /**\r\n   * 选择附件按钮，处理抛出事件\r\n   * @param output\r\n   */\r\n  selectUploadOutput(output: UploadOutput): void {\r\n    this.uploadOutputHandler(output);\r\n  }\r\n  /**\r\n   * allAddedToQueue 选中文件追加到队列\r\n   * @param output\r\n   */\r\n  private uploadOutputHandler(output: UploadOutput): void {\r\n    if (output.type === \"addedToQueue\" && typeof output.file !== \"undefined\") {\r\n      this.uploadFiles.push({ type: output.type, file: output.file });\r\n      // 开始上传\r\n      this.startUpload(output.file);\r\n    } else if (output.type === \"start\") {\r\n      // 开始上传\r\n      this.updateFilesState(output, \"\");\r\n    } else if (output.type == \"done\") {\r\n      // 上传完成\r\n      this.updateFilesState(output, \"done\");\r\n      this.fUploadDoneEvent.emit(\r\n        FFileUtils.changeUploadFileToFileExtend(output.files)\r\n      );\r\n\r\n      const newAddFiles = output.files.map((n) => {\r\n        return {\r\n          checked: false,\r\n          id: n.id,\r\n          name: n.name,\r\n          size: n.size,\r\n          createTime: this.dateHlp.formatTo(new Date(), \"yyyy-MM-dd HH:mm:ss\"),\r\n        };\r\n      });\r\n\r\n      this.fileInfos = [...newAddFiles, ...this.fileInfos];\r\n\r\n      // 上传完成后不在当前页面上显示\r\n      this.hideAfterLoaded(output);\r\n    } else if (\r\n      output.type === \"cancelled\" ||\r\n      output.type === \"removed\" ||\r\n      output.type == \"error\"\r\n    ) {\r\n      // 删除或者移除文件\r\n      this.uploadFiles = this.uploadFiles.filter((fileOutput: UploadOutput) => {\r\n        return (\r\n          output.files.findIndex((item) => fileOutput.file.id == item.id) < 0\r\n        );\r\n      });\r\n      // 给出提示\r\n      this.showNotify(output);\r\n    } else if (\r\n      output.type === \"rejected\" &&\r\n      typeof output.file !== \"undefined\"\r\n    ) {\r\n      // 上传被拒绝\r\n      this.showNotify(output);\r\n    }\r\n  }\r\n  /**\r\n   * 临时删除附件\r\n   * @param output\r\n   */\r\n  private hideAfterLoaded(output: UploadOutput): void {\r\n    // 删除或者移除文件\r\n    let ids = output.files.map((fileItem) => fileItem.id);\r\n    this.uploadFiles = this.uploadFiles.filter((fileOutput: UploadOutput) => {\r\n      let tIndex = ids.findIndex((tId) => tId == fileOutput.file.id);\r\n      return tIndex > -1 ? false : true;\r\n    });\r\n    const event: UploadInput = this.uploadAPISer.getAssignAPI(\"hide\", {\r\n      type: \"hide\",\r\n      id: ids.join(\",\"),\r\n    });\r\n    this.inputUploadEventEmit(event);\r\n  }\r\n  /**\r\n   * 处理上传\r\n   * @param output\r\n   */\r\n  private showNotify(output) {\r\n    let notifyType = \"warning\";\r\n    if (output.type == \"cancelled\" || output.type == \"removed\") {\r\n      notifyType = \"success\";\r\n    }\r\n    let message = output.hasOwnProperty(\"message\") ? output[\"message\"] : \"\";\r\n    this.notifyService[notifyType](<NotifyOptions>{\r\n      msg: message,\r\n      timeout: 3000,\r\n    });\r\n  }\r\n  /**\r\n   * 更新附件的状态\r\n   * @param output\r\n   * @param eventType\r\n   */\r\n  private updateFilesState(output: UploadOutput, eventType) {\r\n    let startFiles = [];\r\n    if (output.hasOwnProperty(\"files\") && output.files.length > 0) {\r\n      // 此处更新界面可能有性能问题\r\n      startFiles = output.files;\r\n    } else if (typeof output.file !== \"undefined\") {\r\n      startFiles = [output.file];\r\n    }\r\n    eventType = eventType ? eventType : output.type;\r\n    startFiles.map((item) => {\r\n      const index = this.uploadFiles.findIndex(\r\n        (fileOutput) =>\r\n          typeof item !== \"undefined\" && fileOutput.file.id === item.id\r\n      );\r\n      // 变更状态\r\n      if (index > -1) {\r\n        this.uploadFiles[index] = { type: eventType, file: item };\r\n      }\r\n    });\r\n  }\r\n  /**\r\n   * 是否判断有类型限制\r\n   */\r\n  judgeContentTypeLimit() {\r\n    let tTypes = this.allowedContentTypes.split(\",\");\r\n    let hasAllIndex = tTypes.findIndex((item) => {\r\n      return item == \"*\";\r\n    });\r\n    return hasAllIndex == -1;\r\n  }\r\n  /**\r\n   * 判断是否有文件大小的限制\r\n   */\r\n  judegeFileSizeLimit() {\r\n    return this.maxFileSize != \"0 Byte\";\r\n  }\r\n  /**\r\n   * 获取上传进度\r\n   */\r\n  getUploadProgress(uploadInfo: UploadOutput) {\r\n    if (uploadInfo[\"type\"] == \"done\") {\r\n      return 100;\r\n    }\r\n    if (uploadInfo[\"file\"][\"progress\"] && uploadInfo[\"file\"][\"progress\"]) {\r\n      if (uploadInfo[\"file\"][\"progress\"][\"status\"] == UploadStatus.Uploading) {\r\n        let tPercentage = uploadInfo[\"file\"][\"progress\"][\"data\"][\"percentage\"];\r\n        return tPercentage > 5 ? tPercentage : 5;\r\n      }\r\n      return 5;\r\n    }\r\n    return 5;\r\n  }\r\n  /**\r\n   * 处理显示\r\n   * @param ev\r\n   * @param fileInfo\r\n   */\r\n  getUploadFileSizeProgress(uploadInfo: UploadOutput) {\r\n    if (!uploadInfo) {\r\n      return \"\";\r\n    }\r\n    if (uploadInfo[\"type\"] == \"done\") {\r\n      return FFileUtils.humanizeBytes(uploadInfo.file.size);\r\n    }\r\n    let tPercentage = 5;\r\n    if (uploadInfo[\"file\"][\"progress\"] && uploadInfo[\"file\"][\"progress\"]) {\r\n      if (uploadInfo[\"file\"][\"progress\"][\"status\"] == UploadStatus.Uploading) {\r\n        tPercentage = uploadInfo[\"file\"][\"progress\"][\"data\"][\"percentage\"];\r\n        tPercentage = tPercentage > 5 ? tPercentage : 5;\r\n      }\r\n    }\r\n    return (\r\n      FFileUtils.humanizeBytes((uploadInfo.file.size * tPercentage) / 100) +\r\n      \"/\" +\r\n      FFileUtils.humanizeBytes(uploadInfo.file.size)\r\n    );\r\n  }\r\n\r\n  /**\r\n   * 处理附件上传---------------------------------------------------------结束--\r\n   */\r\n\r\n  /**\r\n   * 预览\r\n   * @param ev\r\n   * @param fileInfo\r\n   */\r\n  filePreviewHandler(ev: Event, fileInfo: FUploadFileExtend) {\r\n    // ev.stopImmediatePropagation();\r\n    //------------------------------TODO\r\n    if (this.noPreview) {\r\n      return;\r\n    }\r\n    fileInfo.showDownload = !this.noDownload;\r\n    fileInfo.showComments = this.previewShowComments;\r\n    fileInfo.modeless=this.previewModeless;\r\n    this.filePreviewEvent.emit(fileInfo);\r\n  }\r\n  /**\r\n   * 下载\r\n   * @param ev\r\n   * @param fileInfo\r\n   */\r\n  fileDownloadHandler(ev: Event, fileInfo: FUploadFileExtend) {\r\n   // ev.stopImmediatePropagation();\r\n    this.fileDownloadEvent.emit({ fileInfos: [fileInfo], name: \"\" });\r\n  }\r\n  /**\r\n   * 删除数据\r\n   * @param ev\r\n   * @param fileInfo\r\n   */\r\n  fileRemoveHandler(ev: Event, fileInfo: FUploadFileExtend) {\r\n   //ev.stopImmediatePropagation();\r\n    if (fileInfo.checked) {\r\n      this.previewMultiSelected = this.previewMultiSelected.filter(\r\n        (n) => n.id !== fileInfo.id\r\n      );\r\n    }\r\n    this.fileRemoveEvent.emit([fileInfo]);\r\n  }\r\n  /**\r\n   * 批量删除\r\n   * @param ev\r\n   */\r\n  multiFileRemoveHandler(ev: Event) {\r\n    ev.stopImmediatePropagation();\r\n    this.fileRemoveEvent.emit(this.previewMultiSelected);\r\n  }\r\n  fileMultiDownloadHandler(ev: Event) {\r\n    ev.stopImmediatePropagation();\r\n    let rename = \"\";\r\n    if (this.previewMultiSelected.length == 1) {\r\n      this.fileDownloadEvent.emit({\r\n        fileInfos: this.previewMultiSelected,\r\n        name: rename,\r\n      });\r\n      return;\r\n    }\r\n    // 启用了重命名\r\n    if (this.previewEnableRename) {\r\n      let self = this;\r\n      const dlgRef = this.modalSer.show(MultiDownloadInfoComponent, {\r\n        width: 440,\r\n        height: 200,\r\n        showMaxButton: false,\r\n        title:FFileUtils.getLocalStr(\"uploadAndPreview.downloadTitle\"),\r\n        initialState: {\r\n          fileTypeCls: this.getFileTypeClassName(\r\n            self.previewMultiSelected[0].name\r\n          ),\r\n          downloadInfos: self.previewMultiSelected,\r\n          downloadName:\r\n            self._renameFromDialog && !self.previewDefaultRename\r\n              ? self._renameFromDialog\r\n              : self.previewDefaultRename,\r\n        },\r\n        showButtons: true,\r\n        buttons: [\r\n          {\r\n            text: FFileUtils.getLocalStr(\"uploadAndPreview.cancel\"),\r\n            cls: \"btn btn-secondary\",\r\n            handle: () => {\r\n              dlgRef.close();\r\n            },\r\n          },\r\n          {\r\n            text: FFileUtils.getLocalStr(\"uploadAndPreview.ok\"),\r\n            cls: \"btn btn-primary\",\r\n            handle: () => {\r\n              const contentRef = dlgRef.content as MultiDownloadInfoComponent;\r\n              rename = contentRef.getDownloadName();\r\n              self.fileDownloadEvent.emit({\r\n                fileInfos: self.previewMultiSelected,\r\n                name: rename,\r\n              });\r\n              dlgRef.close();\r\n            },\r\n          },\r\n        ],\r\n      });\r\n    } else {\r\n      //未启用重命名\r\n      rename = this.getName(this.previewMultiSelected[0][\"name\"]);\r\n      this.fileDownloadEvent.emit({\r\n        fileInfos: this.previewMultiSelected,\r\n        name: rename,\r\n      });\r\n    }\r\n  }\r\n  private getName(name: string) {\r\n    if (name.lastIndexOf(\".\") > 0) {\r\n      return name.substring(0, name.lastIndexOf(\".\"));\r\n    }\r\n    return \"\";\r\n  }\r\n  showPreviewStateColumn(columnInfo) {\r\n    if (\r\n      columnInfo[\"field\"] == \"state\" &&\r\n      (this.uploadDisabled || !this.uploadVisible || this.noDownload)\r\n    ) {\r\n      return false;\r\n    }\r\n    return true;\r\n  }\r\n\r\n  /** 拖拽排序后事件 */\r\n  onOrderFileDrop($event) {\r\n    const { removedIndex, addedIndex, payload } = $event;\r\n\r\n    const removedItem = this.fileInfos.splice(removedIndex, 1);\r\n    this.fileInfos.splice(addedIndex, 0, ...removedItem);\r\n\r\n    this.cd.detectChanges();\r\n\r\n    const newOrderItems = this.fileInfos.map((n) => n.id);\r\n    this.afterOrdered.emit({ data: newOrderItems });\r\n  }\r\n\r\n  private setColumnWidth() {\r\n    if (this.uploadAndPreviewTableHeader && this.enableOrder) {\r\n      const tableWidth =\r\n        this.uploadAndPreviewTableHeader.nativeElement.offsetWidth;\r\n      const cols =\r\n        this.uploadAndPreviewTableHeader.nativeElement.querySelectorAll(\"th\");\r\n      const trs =\r\n        this.uploadAndPreviewTbodyRef.nativeElement.querySelectorAll(\"tr\");\r\n\r\n      this.uploadAndPreviewTbodyRef.nativeElement.style.flexDirection =\r\n        \"column\";\r\n      this.uploadAndPreviewTbodyRef.nativeElement.style.display = \"flex\";\r\n      this.uploadAndPreviewTbodyRef.nativeElement.style.width =\r\n        tableWidth + \"px\";\r\n\r\n      Array.from(trs).forEach((tr: any) => {\r\n        tr.style.width = tableWidth + \"px\";\r\n        const tds = tr.querySelectorAll(\"td\");\r\n        Array.from(cols).forEach((th: any, index: number) => {\r\n          tds[index].style.width = th.offsetWidth + \"px\";\r\n\r\n          if (index === 0) {\r\n            tds[index].querySelector(\r\n              \".uploadAndpreview--title-container\"\r\n            ).style.width = th.offsetWidth - 56 + \"px\";\r\n          }\r\n        });\r\n      });\r\n    }\r\n  }\r\n\r\n  editFileHandler($event, fileInfo: FUploadFileExtend) {\r\n    // console.log($event, fileInfo);\r\n\r\n    window.open(\r\n      `${this.perfixStr}/platform/runtime/dfs/editpage/index.html?id=${fileInfo.id}&docMode=${this.docMode}`\r\n    );\r\n  }\r\n\r\n  canEdit(fileInfo: FUploadFileExtend) {\r\n    if (!fileInfo||!fileInfo.name) {\r\n      return false;\r\n    }\r\n    const editType = [\r\n      \"doc\",\r\n      \"docx\",\r\n      \"xls\",\r\n      \"xlsx\",\r\n      \"ppt\",\r\n      \"pptx\",\r\n      \"txt\",\r\n      \"wps\",\r\n      \"wpt\",\r\n    ];\r\n    const extendName = fileInfo.name\r\n      .substr(fileInfo.name.lastIndexOf(\".\") + 1)\r\n      .toLowerCase();\r\n    if (extendName) {\r\n      return editType.includes(extendName);\r\n    }\r\n\r\n    return false;\r\n  }\r\n  /**\r\n   * 点击当前行\r\n   * @param ev \r\n   * @param fileInfo \r\n   */\r\n  fileSelected(ev: Event,fileInfo:FUploadFileExtend){\r\n    if(ev){\r\n      ev.stopImmediatePropagation();\r\n      ev.stopPropagation();\r\n    }\r\n    if(!this.previewCurrent||fileInfo.id!=this.previewCurrent){\r\n      this.previewCurrent = fileInfo.id;\r\n      // 抛出当前行数据\r\n      this.fSelectedEvent.emit(fileInfo);\r\n    }\r\n  }\r\n  /**\r\n   * 返回模板上下文\r\n   * @param previewIndex \r\n   * @param colIndex \r\n   * @returns \r\n   */\r\n  getPreviewCtx(previewIndex,colIndex){\r\n    let curRowData=this.getRowData(previewIndex);\r\n    let columnInfo=this.previewColumns[colIndex];\r\n    let curValue=this.getRealDataValue(previewIndex,columnInfo['field'],curRowData);\r\n    return {\r\n      value:curValue,\r\n      rowData: curRowData,\r\n      settings:this.previewSettings,\r\n      column: columnInfo,\r\n      state: 'preview'\r\n    }\r\n  }\r\n  /**\r\n   * 放回当前行数据\r\n   * @param previewIndex \r\n   * @returns \r\n   */\r\n  getRowData(previewIndex){\r\n    return this.extendInfos&&this.extendInfos[previewIndex]?this.extendInfos[previewIndex]:this.fileInfos[previewIndex];\r\n  }\r\n  /**\r\n   * 获取真正的值\r\n   * @param previewIndex \r\n   * @param field \r\n   * @returns \r\n   */\r\n  getRealDataValue(previewIndex,field,rowData=null){\r\n    if(!rowData){\r\n      rowData=this.getRowData(previewIndex);\r\n    }   \r\n    if(!field||!rowData) return '';\r\n    let fieldArray=field.split('.');\r\n    if(fieldArray.length==1){\r\n      return rowData[fieldArray[0]];\r\n    }\r\n    let curItemVal=rowData;\r\n    for(var k=0;k<fieldArray.length;k++){\r\n      curItemVal=curItemVal[fieldArray[k]];\r\n      // 没有值或者没有此属性\r\n      if(curItemVal==null||curItemVal==undefined){\r\n        break;\r\n      }\r\n    }\r\n    if(k==fieldArray.length){\r\n      return curItemVal == null || curItemVal == undefined?\"\":curItemVal;\r\n    }else{\r\n      return '';\r\n    }\r\n  }\r\n  /**\r\n   * 解决附件上传更新时，自定义列没有字段值或者是预置列有自定义的情况\r\n   */\r\n  canUpdateSelfColumn(previewIndex,column){\r\n    let rowData=this.getRowData(previewIndex);\r\n    let field=column['field'];\r\n    if(!field||!rowData) return false;\r\n    let fieldArray=field.split('.');\r\n    // 假定A.B这种字段，只要A字段在，B一定在\r\n    if(rowData.hasOwnProperty(fieldArray[0])){\r\n      return true;\r\n    }\r\n    return false;\r\n  }\r\n}\r\n","import { Component, OnInit, Input, SimpleChanges, OnChanges } from '@angular/core';\r\n//进度条状态 默认normal\r\nexport type UploadProgressStatusType = 'success' | 'error' | 'active' | 'normal';\r\n\r\n// const statusColorMap = new Map([\r\n//   ['normal', '#388fff'],\r\n//   ['exception', '#f24645'],\r\n//   ['success', '#51bd78']\r\n// ]);\r\n@Component({\r\n  selector: 'upload-progress',\r\n  templateUrl: './upload-progress.component.html',\r\n  styleUrls: ['./upload-progress.component.css']\r\n})\r\nexport class UploadProgressComponent implements OnInit, OnChanges {\r\n  //是否显示进度条信息\r\n  @Input() showInfo: boolean = true;\r\n  //进度条状态 默认'normal'\r\n  @Input() status: UploadProgressStatusType;\r\n  //已完成的分段百分比\r\n  @Input() successPercent: number;\r\n  @Input() percent = 0;\r\n  @Input() maxWidth =0;\r\n  //存储的状态\r\n  private cachedStatus: UploadProgressStatusType = 'normal';\r\n  //计算的状态\r\n  private inferredStatus: UploadProgressStatusType = 'normal';\r\n\r\n  //获得进度条状态\r\n  get progressStatus(): UploadProgressStatusType {\r\n    return this.status || this.inferredStatus;\r\n  }\r\n  constructor() { }\r\n  ngOnChanges(changes: SimpleChanges): void {\r\n    const { status, percent, successPercent } = changes;\r\n    //状态变化\r\n    if (status) {\r\n      this.cachedStatus = this.status || this.cachedStatus;\r\n    }\r\n    //进度 已完成的分段百分比 变化\r\n    if (percent || successPercent) {\r\n      const fillAll = parseInt(this.percent.toString(), 10) >= 100;\r\n      if (fillAll) {\r\n        if ((this.isNotNil(this.successPercent) && this.successPercent! >= 100) || this.successPercent === undefined) {\r\n          this.inferredStatus = 'success';\r\n          // this.status = this.inferredStatus;\r\n        }\r\n      } else {\r\n        this.inferredStatus = this.cachedStatus;\r\n      }\r\n      this.status = this.inferredStatus;\r\n    }\r\n  }\r\n  ngOnInit() {\r\n  }\r\n\r\n  isNotNil<T>(value: T): value is NonNullable<T> {\r\n    return typeof value !== 'undefined' && value !== null;\r\n  }\r\n\r\n}\r\n","import {\r\n  Directive,\r\n  NgZone,\r\n  Injector,\r\n  Renderer2,\r\n  ElementRef,\r\n  AfterViewInit,\r\n  Input,\r\n  Output,\r\n  EventEmitter,\r\n  OnDestroy,\r\n} from \"@angular/core\";\r\nimport {\r\n  dropHandlers,\r\n  smoothDnD as SmoothDndForVisible,\r\n  DropResult,\r\n  ContainerOptions,\r\n  constants,\r\n} from \"@farris/smooth-dnd\";\r\n\r\nconst { wrapperClass, animationClass } = constants;\r\nSmoothDndForVisible.dropHandler = dropHandlers.reactDropHandler().handler;\r\nSmoothDndForVisible.wrapChild = false;\r\n\r\nexport interface DragStartEndInfo {\r\n  isSource: boolean;\r\n  payload: any;\r\n  willAcceptDrop: boolean;\r\n}\r\n\r\n@Directive({\r\n  selector: \"[upfile-order-drag]\",\r\n})\r\nexport class UploadFileOrderDragDirective implements AfterViewInit, OnDestroy {\r\n  private container: any;\r\n  @Input('upfile-order-drag') enableDrag = false;\r\n  @Output() drop = new EventEmitter();\r\n  @Input() options: ContainerOptions = {\r\n    behaviour: \"move\",\r\n    dragHandleSelector: \".upfile-drag-handle\",\r\n    dropPlaceholder: {\r\n      className: \"drop-group-field\",\r\n    },\r\n    getGhostParent: () => {\r\n      return document.body;\r\n    },\r\n    getChildPayload: this.getChildPayload.bind(this),\r\n    shouldAcceptDrop: (sourceContainerOptions, payload) => {\r\n      return true;\r\n    },\r\n    onDropReady: (dropResult: DropResult) => {\r\n      this.ngzone.run(() => {\r\n        this.onDropReady(dropResult);\r\n      });\r\n    },\r\n    onDrop: (dropResult: DropResult) => {\r\n      this.ngzone.run(() => {\r\n        this.drop.emit(dropResult);\r\n      });\r\n    },\r\n    onDragEnter: () => {\r\n      this.ngzone.run(() => {\r\n        this.onDragEnter();\r\n      });\r\n    },\r\n    onDragStart: (info: DragStartEndInfo) => {\r\n      this.ngzone.run(() => {\r\n        this.onDragStart(info);\r\n      });\r\n    },\r\n    onDragEnd: (info: DragStartEndInfo) => {\r\n      this.ngzone.run(() => {\r\n        this.onDragEnd(info);\r\n      });\r\n    },\r\n  };\r\n\r\n  constructor(\r\n    private ngzone: NgZone,\r\n    private injector: Injector,\r\n    private render: Renderer2,\r\n    private el: ElementRef\r\n  ) {}\r\n  ngAfterViewInit() {\r\n    if (this.enableDrag) {\r\n        this.initDnD();\r\n    }\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.disposeDnd();\r\n  }\r\n\r\n  private disposeDnd() {\r\n    if (this.container) {\r\n      this.container.dispose();\r\n      this.container = null;\r\n    }\r\n  }\r\n\r\n  private initDnD() {\r\n    this.disposeDnd();\r\n    this.container = SmoothDndForVisible(this.el.nativeElement, this.options);\r\n  }\r\n\r\n  private getChildPayload(index) {\r\n    return index;\r\n  }\r\n\r\n  private onDropReady(dropResult) {\r\n    // console.log('DROP READY', dropResult);\r\n  }\r\n\r\n  private onDragStart(info) {\r\n    // console.log(\"DRAG START\", info);\r\n  }\r\n\r\n  private onDragEnd(info) {\r\n    // console.log('DRAG END', info);\r\n  }\r\n\r\n  private onDragEnter() {\r\n    // console.log('DRAG ENTER');\r\n  }\r\n}\r\n","import { NgModule, ModuleWithProviders } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FFileDropDirective, FFileSelectDirective, FFilePreviewListTypeTemplateDirective, FFileUploadDirective, FFilePreviewToolbarTemplateDirective } from './directive/index';\r\nimport { FFileUploadComponent, FFileViewImageComponent, FFilePreviewComponent, PreviewCheckboxComponent } from './components/index';\r\nimport { UploadServerService } from './model/index';\r\nimport { FFileSizePipe, FFileDatePipe,FormatCellDataPipe,UPLocalePipe,UPLocaleDefaultPipe } from './pipe/index';\r\nimport { FFileUploadServerConfig, FFileUploadAPIServiceToken, FFileUploadDefaultService, FFileUploaderService } from './service/index';\r\nimport { NotifyModule } from '@farris/ui-notify';\r\nimport { ModalModule } from '@farris/ui-modal';\r\nimport { DateHelperModule } from '@farris/ui-common/date';\r\nimport { MessagerModule } from '@farris/ui-messager';\r\nimport { FAreaResponseModule } from '@farris/ui-area-response';\r\nimport { UploadAndPreviewComponent } from './components/upload-and-preview/upload-and-preview.component';\r\nimport { UploadProgressComponent } from './components/upload-progress/upload-progress.component';\r\nimport { MultiDownloadInfoComponent } from './components/multi-download-info/multi-download-info.component';\r\nimport { UploadFileOrderDragDirective } from './components/upload-and-preview/file-order-drag.directive';\r\nimport { LocaleModule } from '@farris/ui-locale';\r\nimport { FarrisCommonModule } from '@farris/ui-common';\r\nimport { DataColumnModule } from '@farris/ui-common/column';\r\n\r\n\r\n@NgModule({\r\n  declarations: [FFileDropDirective, FFileSelectDirective, FFileUploadComponent, \r\n    FFileViewImageComponent, FFilePreviewComponent, FFilePreviewListTypeTemplateDirective, FFileUploadDirective, \r\n    PreviewCheckboxComponent, FFilePreviewToolbarTemplateDirective, FFileSizePipe, UploadAndPreviewComponent, UploadProgressComponent, \r\n    FFileDatePipe,MultiDownloadInfoComponent, UploadFileOrderDragDirective,FormatCellDataPipe,UPLocalePipe,UPLocaleDefaultPipe\r\n  ],\r\n  exports: [FFileDropDirective, FFileSelectDirective, FFileUploadComponent, FFileViewImageComponent, \r\n    FFilePreviewComponent, FFilePreviewListTypeTemplateDirective, FFileUploadDirective, FFilePreviewToolbarTemplateDirective, FFileSizePipe,\r\n    UploadAndPreviewComponent, UploadProgressComponent, FFileDatePipe, UploadFileOrderDragDirective],\r\n  imports: [\r\n    CommonModule,\r\n    NotifyModule, \r\n    MessagerModule,\r\n    FAreaResponseModule, \r\n    FarrisCommonModule,\r\n    DateHelperModule.forRoot(), \r\n    ModalModule.forRoot(),\r\n    LocaleModule.forRoot(),\r\n    DataColumnModule.forRoot()\r\n  ],\r\n  providers: [\r\n    FFileUploaderService,\r\n    {\r\n      provide: UploadServerService,\r\n      useClass: FFileUploadDefaultService\r\n    }\r\n  ],\r\n  entryComponents:[\r\n    MultiDownloadInfoComponent\r\n  ]\r\n})\r\nexport class FFileUploadModule {\r\n  static forRoot(config?: FFileUploadServerConfig, uploadSer?: any): ModuleWithProviders {\r\n    return {\r\n      ngModule: FFileUploadModule,\r\n      providers: [\r\n        { provide: FFileUploadAPIServiceToken, useValue: config },\r\n        FFileUploaderService,\r\n        {\r\n          provide: UploadServerService,\r\n          useClass: uploadSer || FFileUploadDefaultService\r\n        }\r\n      ]\r\n    };\r\n  }\r\n}\r\n"],"names":["SmoothDndForVisible"],"mappings":"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"}