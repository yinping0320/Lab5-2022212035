/**
 * @fileoverview added by tsickle
 * Generated from: lib/utils/f-file.utils.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { UploadStatus } from '../model';
import { FARRIS_UPLOADFILE_LOCALEDATA } from '../locale';
/** @type {?} */
var isObject = (/**
 * @param {?} value
 * @return {?}
 */
function (value) { return typeof value === 'object' && value !== null; });
var ɵ0 = isObject;
/** @type {?} */
var isArray = (/**
 * @param {?} value
 * @return {?}
 */
function (value) { return Array.isArray(value); });
var ɵ1 = isArray;
/** @type {?} */
var localSerStorage = null;
// 暂时用不到
/** @type {?} */
var deepCloneObject = (/**
 * @param {?} src
 * @return {?}
 */
function (src) {
    if (!isObject(src))
        return src;
    /** @type {?} */
    var target = isArray(src) ? [] : {};
    for (var key in src) {
        if (!src.hasOwnProperty(key))
            continue;
        /** @type {?} */
        var v = src[key];
        target[key] = v && isObject(v) ? deepCloneObject(v) : v;
    }
    return target;
});
var ɵ2 = deepCloneObject;
/** @type {?} */
var humanizeBytes = (/**
 * @param {?} bytes
 * @return {?}
 */
function (bytes) {
    if (bytes === 0) {
        return '0 Byte';
    }
    /** @type {?} */
    var k = 1024;
    /** @type {?} */
    var sizes = ['Bytes', 'KB', 'MB', 'GB', 'TB', 'PB'];
    /** @type {?} */
    var i = Math.floor(Math.log(bytes) / Math.log(k));
    return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
});
var ɵ3 = humanizeBytes;
/** @type {?} */
var generateId = (/**
 * @return {?}
 */
function () {
    return Math.random().toString(36).substring(7);
});
var ɵ4 = generateId;
/** @type {?} */
var makeUploadFile = (/**
 * @param {?} file
 * @param {?} index
 * @return {?}
 */
function (file, index) {
    return {
        fileIndex: index,
        id: generateId(),
        name: file.name,
        size: file.size,
        type: file.type,
        form: new FormData(),
        progress: {
            status: UploadStatus.Queue,
            data: {
                percentage: 0,
                speed: 0,
                speedHuman: humanizeBytes(0) + "/s",
                startTime: null,
                endTime: null,
                eta: null,
                etaHuman: null
            }
        },
        lastModifiedDate: new Date(file.lastModified),
        sub: undefined,
        nativeFile: file
    };
});
var ɵ5 = makeUploadFile;
/** @type {?} */
var allMineTypes = {
    '.pdf': 'application/pdf',
    '.gif': 'image/gif',
    '.png': 'image/png',
    '.txt': 'text/plain',
    '.htm': 'text/html',
    '.html': 'text/html',
    '.jpe': 'image/jpeg',
    '.jpeg': 'image/jpeg',
    '.jpg': 'image/jpeg',
    '.js': 'text/javascript,application/javascript',
    '.json': 'application/json',
    '.pps': 'application/vnd.ms-powerpoint',
    '.ppt': 'application/vnd.ms-powerpoint',
    '.doc': 'application/msword',
    '.xml': 'text/xml,application/xml',
    '.zip': 'aplication/zip',
    '.xlsx': 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet',
    '.wps': 'application/vnd.ms-works',
    '.3gpp': 'audio/3gpp, video/3gpp',
    '.ac3': 'audio/ac3',
    '.asf': 'allpication/vnd.ms-asf',
    '.au': 'audio/basic',
    '.css': 'text/css',
    '.csv': 'text/csv',
    '.dot': 'application/msword',
    '.dtd': 'application/xml-dtd',
    '.dwg': 'image/vnd.dwg',
    '.dxf': 'image/vnd.dxf',
    '.jp2': 'image/jp2',
    '.mp2': 'audio/mpeg, video/mpeg',
    '.mp3': ' audio/mpeg',
    '.mp4': 'audio/mp4, video/mp4',
    '.mpeg': 'video/mpeg',
    '.mpg': 'video/mpeg',
    '.mpp': 'application/vnd.ms-project',
    '.ogg': 'application/ogg, audio/ogg',
    '.pot': 'application/vnd.ms-powerpoint',
    '.rtf': 'application/rtf,text/rtf',
    '.svf': 'image/vnd.svf',
    '.tif': 'image/tiff',
    '.tiff': 'image/tiff',
    '.wdb': 'application/vnd.ms-works',
    '.xhtml': 'application/xhtml+xml',
    '.xlc': 'application/vnd.ms-excel',
    '.xlm': 'application/vnd.ms-excel',
    '.xls': 'application/vnd.ms-excel',
    '.xlt': 'application/vnd.ms-excel',
    '.xlw': 'application/vnd.ms-excel'
};
/** @type {?} */
var findMineTypeBySuffix = (/**
 * @param {?} suffix
 * @return {?}
 */
function (suffix) {
    if (allMineTypes.hasOwnProperty(suffix)) {
        return allMineTypes[suffix];
    }
    return '';
});
var ɵ6 = findMineTypeBySuffix;
/** @type {?} */
var changeUploadFileToFileExtend = (/**
 * @param {?} files
 * @return {?}
 */
function (files) {
    // 如果是数组
    /** @type {?} */
    var result = [];
    files.forEach((/**
     * @param {?} file
     * @return {?}
     */
    function (file) {
        /** @type {?} */
        var preExtend = (/** @type {?} */ ({ id: '', name: '', size: 0, type: '', extend: null, extendStatus: 0, extendHeaders: null }));
        for (var resultProp in preExtend) {
            /** @type {?} */
            var tempProp = resultProp.replace('extend', 'response');
            if (file.hasOwnProperty(tempProp)) {
                preExtend[resultProp] = file[tempProp];
            }
        }
        result.push(preExtend);
    }));
    return result;
})
/**
 * 标记是否已处理多语言
 * 解决
 * 1、f-file-uploader.service.ts和f-file-preview.component.ts 构造函数中没有引入多语言，
 * 要支持多语言就必须重新编译的问题
 * 2、引入通用处理的类，在类中进行保存服务
 */
;
var ɵ7 = changeUploadFileToFileExtend;
/**
 * 标记是否已处理多语言
 * 解决
 * 1、f-file-uploader.service.ts和f-file-preview.component.ts 构造函数中没有引入多语言，
 * 要支持多语言就必须重新编译的问题
 * 2、引入通用处理的类，在类中进行保存服务
 * @type {?}
 */
var getLocalState = (/**
 * @param {?} localSer
 * @return {?}
 */
function (localSer) {
    if (localSerStorage) {
        return true;
    }
    if (localSer && !localSerStorage) {
        localSer.setLocaleData(FARRIS_UPLOADFILE_LOCALEDATA);
        localSerStorage = localSer;
        return true;
    }
    return false;
})
/**
 * 替换字符串
 * @param value
 * @param args
 * @returns
 */
;
var ɵ8 = getLocalState;
/**
 * 替换字符串
 * \@param value
 * \@param args
 * \@return
 * @type {?}
 */
var replaceStr = (/**
 * @param {?} value
 * @param {...?} args
 * @return {?}
 */
function (value) {
    var args = [];
    for (var _i = 1; _i < arguments.length; _i++) {
        args[_i - 1] = arguments[_i];
    }
    args.forEach((/**
     * @param {?} v
     * @param {?} i
     * @return {?}
     */
    function (v, i) {
        value = value.replace("{" + i + "}", v);
    }));
    return value;
})
/**
 * 获取多语言数据
 * 某些组件没有重新生成，要支持多语言
 * @param key
 * @param replaceInfo
 */
;
var ɵ9 = replaceStr;
/**
 * 获取多语言数据
 * 某些组件没有重新生成，要支持多语言
 * \@param key
 * \@param replaceInfo
 * @type {?}
 */
var getLocalStr = (/**
 * @param {?} lanKey
 * @param {?=} replaceInfo
 * @return {?}
 */
function (lanKey, replaceInfo) {
    if (replaceInfo === void 0) { replaceInfo = []; }
    /** @type {?} */
    var result = "";
    /** @type {?} */
    var defaultLocalId = 'zh-CHS';
    if (localSerStorage) {
        result = localSerStorage.getValue(lanKey);
    }
    else {
        defaultLocalId = localStorage.getItem('languageCode') || 'zh-CHS';
    }
    if (!result) {
        //说明前面的语言环境没有取到
        result = lanKey.split('.').reduce((/**
         * @param {?} obj
         * @param {?} key
         * @return {?}
         */
        function (obj, key) {
            if (obj) {
                return obj[key];
            }
            else {
                return null;
            }
        }), FARRIS_UPLOADFILE_LOCALEDATA[defaultLocalId]);
    }
    if (result && replaceInfo.length > 0) {
        return replaceStr(result, replaceInfo);
    }
    return result;
});
var ɵ10 = getLocalStr;
/** @type {?} */
export var FFileUtils = {
    isObject: isObject,
    isArray: isArray,
    deepCloneObject: deepCloneObject,
    humanizeBytes: humanizeBytes,
    makeUploadFile: makeUploadFile,
    findMineTypeBySuffix: findMineTypeBySuffix,
    changeUploadFileToFileExtend: changeUploadFileToFileExtend,
    getLocalState: getLocalState,
    getLocalStr: getLocalStr
};
export { ɵ0, ɵ1, ɵ2, ɵ3, ɵ4, ɵ5, ɵ6, ɵ7, ɵ8, ɵ9, ɵ10 };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZi1maWxlLnV0aWxzLmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGZhcnJpcy9leHRlbmQtZmlsZS11cGxvYWQvIiwic291cmNlcyI6WyJsaWIvdXRpbHMvZi1maWxlLnV0aWxzLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7O0FBQ0EsT0FBTyxFQUFjLFlBQVksRUFBcUIsTUFBTSxVQUFVLENBQUM7QUFDdkUsT0FBTyxFQUFFLDRCQUE0QixFQUFFLE1BQU0sV0FBVyxDQUFDOztJQUNuRCxRQUFROzs7O0FBQUcsVUFBQSxLQUFLLElBQUksT0FBQSxPQUFPLEtBQUssS0FBSyxRQUFRLElBQUksS0FBSyxLQUFLLElBQUksRUFBM0MsQ0FBMkMsQ0FBQTs7O0lBQy9ELE9BQU87Ozs7QUFBRyxVQUFBLEtBQUssSUFBSSxPQUFBLEtBQUssQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFDLEVBQXBCLENBQW9CLENBQUE7OztJQUN6QyxlQUFlLEdBQUMsSUFBSTs7O0lBRWxCLGVBQWU7Ozs7QUFBRyxVQUFDLEdBQUc7SUFDeEIsSUFBSSxDQUFDLFFBQVEsQ0FBQyxHQUFHLENBQUM7UUFBRSxPQUFPLEdBQUcsQ0FBQzs7UUFDekIsTUFBTSxHQUFHLE9BQU8sQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxFQUFFO0lBQ3JDLEtBQUssSUFBTSxHQUFHLElBQUksR0FBRyxFQUFFO1FBQ25CLElBQUksQ0FBQyxHQUFHLENBQUMsY0FBYyxDQUFDLEdBQUcsQ0FBQztZQUFFLFNBQVM7O1lBQ2pDLENBQUMsR0FBRyxHQUFHLENBQUMsR0FBRyxDQUFDO1FBQ2xCLE1BQU0sQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLElBQUksUUFBUSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxlQUFlLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztLQUMzRDtJQUNELE9BQU8sTUFBTSxDQUFDO0FBQ2xCLENBQUMsQ0FB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QUFBLGdCQUE0Qjs7UUFDckQsTUFBTSxHQUFDLEVBQUU7O1FBQ1QsY0FBYyxHQUFDLFFBQVE7SUFDM0IsSUFBRyxlQUFlLEVBQUM7UUFDZixNQUFNLEdBQUMsZUFBZSxDQUFDLFFBQVEsQ0FBQyxNQUFNLENBQUMsQ0FBQztLQUMzQztTQUFJO1FBQ0QsY0FBYyxHQUFFLFlBQVksQ0FBQyxPQUFPLENBQUMsY0FBYyxDQUFDLElBQUUsUUFBUSxDQUFDO0tBQ2xFO0lBQ0QsSUFBRyxDQUFDLE1BQU0sRUFBQztRQUNYLGVBQWU7UUFDWCxNQUFNLEdBQUcsTUFBTSxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQyxNQUFNOzs7OztRQUFDLFVBQUMsR0FBRyxFQUFFLEdBQUc7WUFDdkMsSUFBSSxHQUFHLEVBQUU7Z0JBQ0wsT0FBTyxHQUFHLENBQUMsR0FBRyxDQUFDLENBQUM7YUFDbkI7aUJBQU07Z0JBQ0gsT0FBTyxJQUFJLENBQUM7YUFDZjtRQUNMLENBQUMsR0FBRSw0QkFBNEIsQ0FBQyxjQUFjLENBQUMsQ0FBQyxDQUFDO0tBQ3BEO0lBQ0QsSUFBRyxNQUFNLElBQUUsV0FBVyxDQUFDLE1BQU0sR0FBQyxDQUFDLEVBQUM7UUFDNUIsT0FBTyxVQUFVLENBQUMsTUFBTSxFQUFDLFdBQVcsQ0FBQyxDQUFDO0tBQ3pDO0lBQ0QsT0FBTyxNQUFNLENBQUM7QUFDbEIsQ0FBQyxDQUFBOzs7QUFHRCxNQUFNLEtBQU8sVUFBVSxHQUFHO0lBQ3RCLFFBQVEsVUFBQTtJQUNSLE9BQU8sU0FBQTtJQUNQLGVBQWUsaUJBQUE7SUFDZixhQUFhLGVBQUE7SUFDYixjQUFjLGdCQUFBO0lBQ2Qsb0JBQW9CLHNCQUFBO0lBQ3BCLDRCQUE0Qiw4QkFBQTtJQUM1QixhQUFhLGVBQUE7SUFDYixXQUFXLGFBQUE7Q0FDZCIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IExvY2FsZVNlcnZpY2UgfSBmcm9tICdAZmFycmlzL3VpLWxvY2FsZSc7XHJcbmltcG9ydCB7IFVwbG9hZEZpbGUsIFVwbG9hZFN0YXR1cywgRlVwbG9hZEZpbGVFeHRlbmQgfSBmcm9tICcuLi9tb2RlbCc7XHJcbmltcG9ydCB7IEZBUlJJU19VUExPQURGSUxFX0xPQ0FMRURBVEEgfSBmcm9tICcuLi9sb2NhbGUnO1xyXG5jb25zdCBpc09iamVjdCA9IHZhbHVlID0+IHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUgIT09IG51bGw7XHJcbmNvbnN0IGlzQXJyYXkgPSB2YWx1ZSA9PiBBcnJheS5pc0FycmF5KHZhbHVlKTtcclxubGV0IGxvY2FsU2VyU3RvcmFnZT1udWxsO1xyXG4vLyDmmoLml7bnlKjkuI3liLBcclxuY29uc3QgZGVlcENsb25lT2JqZWN0ID0gKHNyYykgPT4ge1xyXG4gICAgaWYgKCFpc09iamVjdChzcmMpKSByZXR1cm4gc3JjO1xyXG4gICAgY29uc3QgdGFyZ2V0ID0gaXNBcnJheShzcmMpID8gW10gOiB7fTtcclxuICAgIGZvciAoY29uc3Qga2V5IGluIHNyYykge1xyXG4gICAgICAgIGlmICghc3JjLmhhc093blByb3BlcnR5KGtleSkpIGNvbnRpbnVlO1xyXG4gICAgICAgIGNvbnN0IHYgPSBzcmNba2V5XTtcclxuICAgICAgICB0YXJnZXRba2V5XSA9IHYgJiYgaXNPYmplY3QodikgPyBkZWVwQ2xvbmVPYmplY3QodikgOiB2O1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHRhcmdldDtcclxufVxyXG5cclxuY29uc3QgaHVtYW5pemVCeXRlcyA9IChieXRlczogbnVtYmVyKTogc3RyaW5nID0+IHtcclxuICAgIGlmIChieXRlcyA9PT0gMCkge1xyXG4gICAgICAgIHJldHVybiAnMCBCeXRlJztcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBrID0gMTAyNDtcclxuICAgIGNvbnN0IHNpemVzOiBzdHJpbmdbXSA9IFsnQnl0ZXMnLCAnS0InLCAnTUInLCAnR0InLCAnVEInLCAnUEInXTtcclxuICAgIGNvbnN0IGk6IG51bWJlciA9IE1hdGguZmxvb3IoTWF0aC5sb2coYnl0ZXMpIC8gTWF0aC5sb2coaykpO1xyXG5cclxuICAgIHJldHVybiBwYXJzZUZsb2F0KChieXRlcyAvIE1hdGgucG93KGssIGkpKS50b0ZpeGVkKDIpKSArICcgJyArIHNpemVzW2ldO1xyXG59XHJcbmNvbnN0IGdlbmVyYXRlSWQgPSAoKTogc3RyaW5nID0+IHtcclxuICAgIHJldHVybiBNYXRoLnJhbmRvbSgpLnRvU3RyaW5nKDM2KS5zdWJzdHJpbmcoNyk7XHJcbn1cclxuY29uc3QgbWFrZVVwbG9hZEZpbGUgPSAoZmlsZTogRmlsZSwgaW5kZXg6IG51bWJlcik6IFVwbG9hZEZpbGUgPT4ge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICBmaWxlSW5kZXg6IGluZGV4LFxyXG4gICAgICAgIGlkOiBnZW5lcmF0ZUlkKCksXHJcbiAgICAgICAgbmFtZTogZmlsZS5uYW1lLFxyXG4gICAgICAgIHNpemU6IGZpbGUuc2l6ZSxcclxuICAgICAgICB0eXBlOiBmaWxlLnR5cGUsXHJcbiAgICAgICAgZm9ybTogbmV3IEZvcm1EYXRhKCksXHJcbiAgICAgICAgcHJvZ3Jlc3M6IHtcclxuICAgICAgICAgICAgc3RhdHVzOiBVcGxvYWRTdGF0dXMuUXVldWUsXHJcbiAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgIHBlcmNlbnRhZ2U6IDAsXHJcbiAgICAgICAgICAgICAgICBzcGVlZDogMCxcclxuICAgICAgICAgICAgICAgIHNwZWVkSHVtYW46IGAke2h1bWFuaXplQnl0ZXMoMCl9L3NgLFxyXG4gICAgICAgICAgICAgICAgc3RhcnRUaW1lOiBudWxsLFxyXG4gICAgICAgICAgICAgICAgZW5kVGltZTogbnVsbCxcclxuICAgICAgICAgICAgICAgIGV0YTogbnVsbCxcclxuICAgICAgICAgICAgICAgIGV0YUh1bWFuOiBudWxsXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG4gICAgICAgIGxhc3RNb2RpZmllZERhdGU6IG5ldyBEYXRlKGZpbGUubGFzdE1vZGlmaWVkKSxcclxuICAgICAgICBzdWI6IHVuZGVmaW5lZCxcclxuICAgICAgICBuYXRpdmVGaWxlOiBmaWxlXHJcbiAgICB9O1xyXG59XHJcblxyXG5jb25zdCBhbGxNaW5lVHlwZXMgPSB7XHJcbiAgICAnLnBkZic6ICdhcHBsaWNhdGlvbi9wZGYnLFxyXG4gICAgJy5naWYnOiAnaW1hZ2UvZ2lmJyxcclxuICAgICcucG5nJzogJ2ltYWdlL3BuZycsXHJcbiAgICAnLnR4dCc6ICd0ZXh0L3BsYWluJyxcclxuICAgICcuaHRtJzogJ3RleHQvaHRtbCcsXHJcbiAgICAnLmh0bWwnOiAndGV4dC9odG1sJyxcclxuICAgICcuanBlJzogJ2ltYWdlL2pwZWcnLFxyXG4gICAgJy5qcGVnJzogJ2ltYWdlL2pwZWcnLFxyXG4gICAgJy5qcGcnOiAnaW1hZ2UvanBlZycsXHJcbiAgICAnLmpzJzogJ3RleHQvamF2YXNjcmlwdCxhcHBsaWNhdGlvbi9qYXZhc2NyaXB0JyxcclxuICAgICcuanNvbic6ICdhcHBsaWNhdGlvbi9qc29uJyxcclxuICAgICcucHBzJzogJ2FwcGxpY2F0aW9uL3ZuZC5tcy1wb3dlcnBvaW50JyxcclxuICAgICcucHB0JzogJ2FwcGxpY2F0aW9uL3ZuZC5tcy1wb3dlcnBvaW50JyxcclxuICAgICcuZG9jJzogJ2FwcGxpY2F0aW9uL21zd29yZCcsXHJcbiAgICAnLnhtbCc6ICd0ZXh0L3htbCxhcHBsaWNhdGlvbi94bWwnLFxyXG4gICAgJy56aXAnOiAnYXBsaWNhdGlvbi96aXAnLFxyXG4gICAgJy54bHN4JzogJ2FwcGxpY2F0aW9uL3ZuZC5vcGVueG1sZm9ybWF0cy1vZmZpY2Vkb2N1bWVudC5zcHJlYWRzaGVldG1sLnNoZWV0JyxcclxuICAgICcud3BzJzogJ2FwcGxpY2F0aW9uL3ZuZC5tcy13b3JrcycsXHJcbiAgICAnLjNncHAnOiAnYXVkaW8vM2dwcCwgdmlkZW8vM2dwcCcsXHJcbiAgICAnLmFjMyc6ICdhdWRpby9hYzMnLFxyXG4gICAgJy5hc2YnOiAnYWxscGljYXRpb24vdm5kLm1zLWFzZicsXHJcbiAgICAnLmF1JzogJ2F1ZGlvL2Jhc2ljJyxcclxuICAgICcuY3NzJzogJ3RleHQvY3NzJyxcclxuICAgICcuY3N2JzogJ3RleHQvY3N2JyxcclxuICAgICcuZG90JzogJ2FwcGxpY2F0aW9uL21zd29yZCcsXHJcbiAgICAnLmR0ZCc6ICdhcHBsaWNhdGlvbi94bWwtZHRkJyxcclxuICAgICcuZHdnJzogJ2ltYWdlL3ZuZC5kd2cnLFxyXG4gICAgJy5keGYnOiAnaW1hZ2Uvdm5kLmR4ZicsXHJcbiAgICAnLmpwMic6ICdpbWFnZS9qcDInLFxyXG4gICAgJy5tcDInOiAnYXVkaW8vbXBlZywgdmlkZW8vbXBlZycsXHJcbiAgICAnLm1wMyc6ICcgYXVkaW8vbXBlZycsXHJcbiAgICAnLm1wNCc6ICdhdWRpby9tcDQsIHZpZGVvL21wNCcsXHJcbiAgICAnLm1wZWcnOiAndmlkZW8vbXBlZycsXHJcbiAgICAnLm1wZyc6ICd2aWRlby9tcGVnJyxcclxuICAgICcubXBwJzogJ2FwcGxpY2F0aW9uL3ZuZC5tcy1wcm9qZWN0JyxcclxuICAgICcub2dnJzogJ2FwcGxpY2F0aW9uL29nZywgYXVkaW8vb2dnJyxcclxuICAgICcucG90JzogJ2FwcGxpY2F0aW9uL3ZuZC5tcy1wb3dlcnBvaW50JyxcclxuICAgICcucnRmJzogJ2FwcGxpY2F0aW9uL3J0Zix0ZXh0L3J0ZicsXHJcbiAgICAnLnN2Zic6ICdpbWFnZS92bmQuc3ZmJyxcclxuICAgICcudGlmJzogJ2ltYWdlL3RpZmYnLFxyXG4gICAgJy50aWZmJzogJ2ltYWdlL3RpZmYnLFxyXG4gICAgJy53ZGInOiAnYXBwbGljYXRpb24vdm5kLm1zLXdvcmtzJyxcclxuICAgICcueGh0bWwnOiAnYXBwbGljYXRpb24veGh0bWwreG1sJyxcclxuICAgICcueGxjJzogJ2FwcGxpY2F0aW9uL3ZuZC5tcy1leGNlbCcsXHJcbiAgICAnLnhsbSc6ICdhcHBsaWNhdGlvbi92bmQubXMtZXhjZWwnLFxyXG4gICAgJy54bHMnOiAnYXBwbGljYXRpb24vdm5kLm1zLWV4Y2VsJyxcclxuICAgICcueGx0JzogJ2FwcGxpY2F0aW9uL3ZuZC5tcy1leGNlbCcsXHJcbiAgICAnLnhsdyc6ICdhcHBsaWNhdGlvbi92bmQubXMtZXhjZWwnXHJcbn07XHJcbmNvbnN0IGZpbmRNaW5lVHlwZUJ5U3VmZml4ID0gKHN1ZmZpeDogc3RyaW5nKTogc3RyaW5nID0+IHtcclxuICAgIGlmIChhbGxNaW5lVHlwZXMuaGFzT3duUHJvcGVydHkoc3VmZml4KSkge1xyXG4gICAgICAgIHJldHVybiBhbGxNaW5lVHlwZXNbc3VmZml4XTtcclxuICAgIH1cclxuICAgIHJldHVybiAnJztcclxufVxyXG5cclxuY29uc3QgY2hhbmdlVXBsb2FkRmlsZVRvRmlsZUV4dGVuZCA9IChmaWxlczogVXBsb2FkRmlsZVtdKTogRlVwbG9hZEZpbGVFeHRlbmRbXSA9PiB7XHJcbiAgICAvLyDlpoLmnpzmmK/mlbDnu4RcclxuICAgIGxldCByZXN1bHQ9W107XHJcbiAgICBmaWxlcy5mb3JFYWNoKGZpbGU9PntcclxuICAgICAgICBsZXQgcHJlRXh0ZW5kID0geyBpZDogJycsIG5hbWU6ICcnLCBzaXplOiAwLCB0eXBlOiAnJywgZXh0ZW5kOiBudWxsLCBleHRlbmRTdGF0dXM6IDAsIGV4dGVuZEhlYWRlcnM6IG51bGwgfSBhcyBGVXBsb2FkRmlsZUV4dGVuZDtcclxuICAgICAgICBmb3IgKGxldCByZXN1bHRQcm9wIGluIHByZUV4dGVuZCkge1xyXG4gICAgICAgICAgICBsZXQgdGVtcFByb3AgPSByZXN1bHRQcm9wLnJlcGxhY2UoJ2V4dGVuZCcsICdyZXNwb25zZScpO1xyXG4gICAgICAgICAgICBpZiAoZmlsZS5oYXNPd25Qcm9wZXJ0eSh0ZW1wUHJvcCkpIHtcclxuICAgICAgICAgICAgICAgIHByZUV4dGVuZFtyZXN1bHRQcm9wXSA9IGZpbGVbdGVtcFByb3BdO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJlc3VsdC5wdXNoKHByZUV4dGVuZCk7XHJcbiAgICB9KTtcclxuICAgIFxyXG4gICAgcmV0dXJuIHJlc3VsdDtcclxufVxyXG4vKipcclxuICog5qCH6K6w5piv5ZCm5bey5aSE55CG5aSa6K+t6KiAXHJcbiAqIOino+WGs1xyXG4gKiAx44CBZi1maWxlLXVwbG9hZGVyLnNlcnZpY2UudHPlkoxmLWZpbGUtcHJldmlldy5jb21wb25lbnQudHMg5p6E6YCg5Ye95pWw5Lit5rKh5pyJ5byV5YWl5aSa6K+t6KiA77yMXHJcbiAqIOimgeaUr+aMgeWkmuivreiogOWwseW/hemhu+mHjeaWsOe8luivkeeahOmXrumimFxyXG4gKiAy44CB5byV5YWl6YCa55So5aSE55CG55qE57G777yM5Zyo57G75Lit6L+b6KGM5L+d5a2Y5pyN5YqhXHJcbiAqL1xyXG5jb25zdCBnZXRMb2NhbFN0YXRlPShsb2NhbFNlcjpMb2NhbGVTZXJ2aWNlKT0+e1xyXG4gICAgaWYobG9jYWxTZXJTdG9yYWdlKXtcclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH1cclxuICAgIGlmKGxvY2FsU2VyJiYhbG9jYWxTZXJTdG9yYWdlKXtcclxuICAgICAgICAgICAgbG9jYWxTZXIuc2V0TG9jYWxlRGF0YShGQVJSSVNfVVBMT0FERklMRV9MT0NBTEVEQVRBKTtcclxuICAgICAgICAgICAgbG9jYWxTZXJTdG9yYWdlPWxvY2FsU2VyO1xyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH1cclxuICAgIHJldHVybiBmYWxzZTtcclxufVxyXG4vKipcclxuICog5pu/5o2i5a2X56ym5LiyXHJcbiAqIEBwYXJhbSB2YWx1ZSBcclxuICogQHBhcmFtIGFyZ3MgXHJcbiAqIEByZXR1cm5zIFxyXG4gKi9cclxuY29uc3QgIHJlcGxhY2VTdHI9KHZhbHVlOiBhbnksIC4uLmFyZ3M6IGFueVtdKTpzdHJpbmcgPT57XHJcbiAgICBhcmdzLmZvckVhY2goKHYsIGkpID0+IHtcclxuICAgICAgICB2YWx1ZSA9IHZhbHVlLnJlcGxhY2UoYHske2l9fWAsIHYpO1xyXG4gICAgfSk7XHJcbiAgICByZXR1cm4gdmFsdWU7XHJcbn1cclxuLyoqXHJcbiAqIOiOt+WPluWkmuivreiogOaVsOaNrlxyXG4gKiDmn5Dkupvnu4Tku7bmsqHmnInph43mlrDnlJ/miJDvvIzopoHmlK/mjIHlpJror63oqIBcclxuICogQHBhcmFtIGtleSBcclxuICogQHBhcmFtIHJlcGxhY2VJbmZvIFxyXG4gKi9cclxuY29uc3QgZ2V0TG9jYWxTdHI9KGxhbktleTpzdHJpbmcscmVwbGFjZUluZm86QXJyYXk8c3RyaW5nPj1bXSk9PntcclxuICAgIGxldCByZXN1bHQ9XCJcIjtcclxuICAgIGxldCBkZWZhdWx0TG9jYWxJZD0nemgtQ0hTJztcclxuICAgIGlmKGxvY2FsU2VyU3RvcmFnZSl7XHJcbiAgICAgICAgcmVzdWx0PWxvY2FsU2VyU3RvcmFnZS5nZXRWYWx1ZShsYW5LZXkpO1xyXG4gICAgfWVsc2V7XHJcbiAgICAgICAgZGVmYXVsdExvY2FsSWQ9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdsYW5ndWFnZUNvZGUnKXx8J3poLUNIUyc7XHJcbiAgICB9XHJcbiAgICBpZighcmVzdWx0KXtcclxuICAgIC8v6K+05piO5YmN6Z2i55qE6K+t6KiA546v5aKD5rKh5pyJ5Y+W5YiwXHJcbiAgICAgICAgcmVzdWx0ID0gbGFuS2V5LnNwbGl0KCcuJykucmVkdWNlKChvYmosIGtleSkgPT4ge1xyXG4gICAgICAgICAgICBpZiAob2JqKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gb2JqW2tleV07XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sIEZBUlJJU19VUExPQURGSUxFX0xPQ0FMRURBVEFbZGVmYXVsdExvY2FsSWRdKTtcclxuICAgIH1cclxuICAgIGlmKHJlc3VsdCYmcmVwbGFjZUluZm8ubGVuZ3RoPjApe1xyXG4gICAgICAgIHJldHVybiByZXBsYWNlU3RyKHJlc3VsdCxyZXBsYWNlSW5mbyk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gcmVzdWx0O1xyXG59XHJcblxyXG5cclxuZXhwb3J0IGNvbnN0IEZGaWxlVXRpbHMgPSB7XHJcbiAgICBpc09iamVjdCxcclxuICAgIGlzQXJyYXksXHJcbiAgICBkZWVwQ2xvbmVPYmplY3QsXHJcbiAgICBodW1hbml6ZUJ5dGVzLFxyXG4gICAgbWFrZVVwbG9hZEZpbGUsXHJcbiAgICBmaW5kTWluZVR5cGVCeVN1ZmZpeCxcclxuICAgIGNoYW5nZVVwbG9hZEZpbGVUb0ZpbGVFeHRlbmQsXHJcbiAgICBnZXRMb2NhbFN0YXRlLFxyXG4gICAgZ2V0TG9jYWxTdHJcclxufSJdfQ==