/**
 * @fileoverview added by tsickle
 * Generated from: lib/pipe/index.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Pipe } from "@angular/core";
import { Injector } from "@angular/core";
import { ColumnFormatService } from "@farris/ui-common/column";
import { FFileUtils } from "../utils/f-file.utils";
import { DateTimeHelperService } from "@farris/ui-common/date";
/**
 * 文件大小格式化
 */
var FFileSizePipe = /** @class */ (function () {
    function FFileSizePipe() {
    }
    /**
     * @param {?} value
     * @param {?=} args
     * @return {?}
     */
    FFileSizePipe.prototype.transform = /**
     * @param {?} value
     * @param {?=} args
     * @return {?}
     */
    function (value, args) {
        // 如果是字符串
        /** @type {?} */
        var tvalue = value;
        if (!value) {
            return "0 Byte";
        }
        if (typeof value == "string") {
            tvalue = parseInt(value);
        }
        return FFileUtils.humanizeBytes(tvalue);
    };
    FFileSizePipe.decorators = [
        { type: Pipe, args: [{
                    name: "fFileSize",
                },] }
    ];
    return FFileSizePipe;
}());
export { FFileSizePipe };
/**
 * 日期格式化
 */
var FFileDatePipe = /** @class */ (function () {
    function FFileDatePipe(dateSer) {
        this.dateSer = dateSer;
    }
    /**
     * @param {?} value
     * @param {?=} returnFormat
     * @return {?}
     */
    FFileDatePipe.prototype.transform = /**
     * @param {?} value
     * @param {?=} returnFormat
     * @return {?}
     */
    function (value, returnFormat) {
        if (returnFormat === void 0) { returnFormat = "yyyy-MM-dd"; }
        if (!value)
            return '';
        return this.dateSer.formatTo(value, returnFormat);
    };
    FFileDatePipe.decorators = [
        { type: Pipe, args: [{
                    name: "fFileDate",
                },] }
    ];
    /** @nocollapse */
    FFileDatePipe.ctorParameters = function () { return [
        { type: DateTimeHelperService }
    ]; };
    return FFileDatePipe;
}());
export { FFileDatePipe };
if (false) {
    /**
     * @type {?}
     * @private
     */
    FFileDatePipe.prototype.dateSer;
}
/**
 * 格式化自定义数据
 */
var FormatCellDataPipe = /** @class */ (function () {
    function FormatCellDataPipe(cfs, injector) {
        this.cfs = cfs;
        this.injector = injector;
        // 先不处理多语言
        this.localeId = "ZH-CHS";
    }
    /**
     * 格式化数据
     * @param column:列信息
     * @param rowData:当前数据
     * @param settings:配置信息
     * @param state: 状态
     * @returns
     */
    /**
     * 格式化数据
     * @param {?} column
     * @param {?} rowData
     * @param {?} rowIndex
     * @param {?} settings
     * @param {?=} state
     * @return {?}
     */
    FormatCellDataPipe.prototype.transform = /**
     * 格式化数据
     * @param {?} column
     * @param {?} rowData
     * @param {?} rowIndex
     * @param {?} settings
     * @param {?=} state
     * @return {?}
     */
    function (column, rowData, rowIndex, settings, state) {
        if (state === void 0) { state = "preview"; }
        if (rowData && column && column.field) {
            // 值
            /** @type {?} */
            var value = this.getRealDataValue(rowData, column.field);
            /** @type {?} */
            var formatterFn = column.formatter;
            if (formatterFn) {
                if (formatterFn.type === "number") {
                    if (!formatterFn.options ||
                        !Object.keys(formatterFn.options).length) {
                        formatterFn.options = {
                            thousand: ",",
                            precision: 2,
                        };
                    }
                }
                // 不需要特殊处理
                // if (formatterFn.type === "datetime") {
                // }
            }
            //参数1： 值，参数2：行数据 参数3：格式化方法
            return this.cfs.format(value, rowData, formatterFn, { rowIndex: rowIndex, settings: settings });
        }
        return "";
    };
    /**
     * 获取真正的数据
     * @param rowData
     * @param field
     * @returns
     */
    /**
     * 获取真正的数据
     * @private
     * @param {?} rowData
     * @param {?} field
     * @return {?}
     */
    FormatCellDataPipe.prototype.getRealDataValue = /**
     * 获取真正的数据
     * @private
     * @param {?} rowData
     * @param {?} field
     * @return {?}
     */
    function (rowData, field) {
        if (!field || !rowData)
            return '';
        /** @type {?} */
        var fieldArray = field.split('.');
        if (fieldArray.length == 1) {
            return rowData[fieldArray[0]];
        }
        /** @type {?} */
        var curItemVal = rowData;
        for (var k = 0; k < fieldArray.length; k++) {
            curItemVal = curItemVal[fieldArray[k]];
            // 没有值或者没有此属性
            if (curItemVal == null || curItemVal == undefined) {
                break;
            }
        }
        if (k == fieldArray.length) {
            return curItemVal == null || curItemVal == undefined ? "" : curItemVal;
        }
        else {
            return '';
        }
    };
    FormatCellDataPipe.decorators = [
        { type: Pipe, args: [{ name: "formatCellData", pure: false },] }
    ];
    /** @nocollapse */
    FormatCellDataPipe.ctorParameters = function () { return [
        { type: ColumnFormatService },
        { type: Injector }
    ]; };
    return FormatCellDataPipe;
}());
export { FormatCellDataPipe };
if (false) {
    /**
     * @type {?}
     * @private
     */
    FormatCellDataPipe.prototype.elRef;
    /**
     * @type {?}
     * @private
     */
    FormatCellDataPipe.prototype.localeId;
    /**
     * @type {?}
     * @private
     */
    FormatCellDataPipe.prototype.cfs;
    /**
     * @type {?}
     * @private
     */
    FormatCellDataPipe.prototype.injector;
}
/**
 * 附件可能之前生成的单据中并没有多语言服务
 * 调用附件的公共服务
 */
var UPLocalePipe = /** @class */ (function () {
    function UPLocalePipe() {
    }
    /**
     * @param {?} name
     * @param {...?} replaceVal
     * @return {?}
     */
    UPLocalePipe.prototype.transform = /**
     * @param {?} name
     * @param {...?} replaceVal
     * @return {?}
     */
    function (name) {
        var replaceVal = [];
        for (var _i = 1; _i < arguments.length; _i++) {
            replaceVal[_i - 1] = arguments[_i];
        }
        return FFileUtils.getLocalStr(name, replaceVal);
    };
    UPLocalePipe.decorators = [
        { type: Pipe, args: [{ name: 'upLocale' },] }
    ];
    /** @nocollapse */
    UPLocalePipe.ctorParameters = function () { return []; };
    return UPLocalePipe;
}());
export { UPLocalePipe };
/**
 * 解决变量有个默认的文字，变量最终可能是默认值也可能不是
 */
var UPLocaleDefaultPipe = /** @class */ (function () {
    function UPLocaleDefaultPipe() {
    }
    /**
     * @param {?} realValue
     * @param {?} compareTxt
     * @param {?} localeName
     * @return {?}
     */
    UPLocaleDefaultPipe.prototype.transform = /**
     * @param {?} realValue
     * @param {?} compareTxt
     * @param {?} localeName
     * @return {?}
     */
    function (realValue, compareTxt, localeName) {
        if (realValue == compareTxt) {
            return FFileUtils.getLocalStr(localeName);
        }
        return realValue;
    };
    UPLocaleDefaultPipe.decorators = [
        { type: Pipe, args: [{ name: 'upLocaleDefault' },] }
    ];
    /** @nocollapse */
    UPLocaleDefaultPipe.ctorParameters = function () { return []; };
    return UPLocaleDefaultPipe;
}());
export { UPLocaleDefaultPipe };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZmFycmlzL2V4dGVuZC1maWxlLXVwbG9hZC8iLCJzb3VyY2VzIjpbImxpYi9waXBlL2luZGV4LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7O0FBQUEsT0FBTyxFQUFFLElBQUksRUFBaUIsTUFBTSxlQUFlLENBQUM7QUFDcEQsT0FBTyxFQUFFLFFBQVEsRUFBeUIsTUFBTSxlQUFlLENBQUM7QUFDaEUsT0FBTyxFQUFFLG1CQUFtQixFQUFFLE1BQU0sMEJBQTBCLENBQUM7QUFDL0QsT0FBTyxFQUFFLFVBQVUsRUFBRSxNQUFNLHVCQUF1QixDQUFDO0FBQ25ELE9BQU8sRUFBRSxxQkFBcUIsRUFBRSxNQUFNLHdCQUF3QixDQUFDOzs7O0FBSS9EO0lBQUE7SUFlQSxDQUFDOzs7Ozs7SUFYRyxpQ0FBUzs7Ozs7SUFBVCxVQUFVLEtBQVUsRUFBRSxJQUFVOzs7WUFFeEIsTUFBTSxHQUFHLEtBQUs7UUFDbEIsSUFBSSxDQUFDLEtBQUssRUFBRTtZQUNSLE9BQU8sUUFBUSxDQUFDO1NBQ25CO1FBQ0QsSUFBSSxPQUFPLEtBQUssSUFBSSxRQUFRLEVBQUU7WUFDMUIsTUFBTSxHQUFHLFFBQVEsQ0FBQyxLQUFLLENBQUMsQ0FBQztTQUM1QjtRQUNELE9BQU8sVUFBVSxDQUFDLGFBQWEsQ0FBQyxNQUFNLENBQUMsQ0FBQztJQUM1QyxDQUFDOztnQkFkSixJQUFJLFNBQUM7b0JBQ0YsSUFBSSxFQUFFLFdBQVc7aUJBQ3BCOztJQWFELG9CQUFDO0NBQUEsQUFmRCxJQWVDO1NBWlksYUFBYTs7OztBQWdCMUI7SUFJSSx1QkFBb0IsT0FBOEI7UUFBOUIsWUFBTyxHQUFQLE9BQU8sQ0FBdUI7SUFBSSxDQUFDOzs7Ozs7SUFDdkQsaUNBQVM7Ozs7O0lBQVQsVUFBVSxLQUFVLEVBQUUsWUFBbUM7UUFBbkMsNkJBQUEsRUFBQSwyQkFBbUM7UUFDckQsSUFBRyxDQUFDLEtBQUs7WUFBRSxPQUFPLEVBQUUsQ0FBQztRQUNy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QUFLLEVBQUU7Ozs7Z0JBeENwQyxtQkFBbUI7Z0JBRG5CLFFBQVE7O0lBNEdqQix5QkFBQztDQUFBLEFBbkVELElBbUVDO1NBbEVZLGtCQUFrQjs7Ozs7O0lBQzNCLG1DQUEwQjs7Ozs7SUFFMUIsc0NBQTRCOzs7OztJQUNoQixpQ0FBZ0M7Ozs7O0lBQUUsc0NBQTBCOzs7Ozs7QUFtRTVFO0lBRUk7SUFBZSxDQUFDOzs7Ozs7SUFDaEIsZ0NBQVM7Ozs7O0lBQVQsVUFBVSxJQUFTO1FBQUUsb0JBQW9CO2FBQXBCLFVBQW9CLEVBQXBCLHFCQUFvQixFQUFwQixJQUFvQjtZQUFwQixtQ0FBb0I7O1FBQ25DLE9BQVEsVUFBVSxDQUFDLFdBQVcsQ0FBQyxJQUFJLEVBQUMsVUFBVSxDQUFDLENBQUM7SUFDdEQsQ0FBQzs7Z0JBTEosSUFBSSxTQUFDLEVBQUMsSUFBSSxFQUFFLFVBQVUsRUFBQzs7OztJQU14QixtQkFBQztDQUFBLEFBTkQsSUFNQztTQUxZLFlBQVk7Ozs7QUFVekI7SUFFSTtJQUFlLENBQUM7Ozs7Ozs7SUFDaEIsdUNBQVM7Ozs7OztJQUFULFVBQVUsU0FBYyxFQUFDLFVBQWlCLEVBQUMsVUFBaUI7UUFDeEQsSUFBRyxTQUFTLElBQUUsVUFBVSxFQUFDO1lBQ3JCLE9BQVEsVUFBVSxDQUFDLFdBQVcsQ0FBQyxVQUFVLENBQUMsQ0FBQztTQUM5QztRQUNELE9BQU8sU0FBUyxDQUFDO0lBQ3JCLENBQUM7O2dCQVJKLElBQUksU0FBQyxFQUFDLElBQUksRUFBRSxpQkFBaUIsRUFBQzs7OztJQVMvQiwwQkFBQztDQUFBLEFBVEQsSUFTQztTQVJZLG1CQUFtQiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFBpcGUsIFBpcGVUcmFuc2Zvcm0gfSBmcm9tIFwiQGFuZ3VsYXIvY29yZVwiO1xyXG5pbXBvcnQgeyBJbmplY3RvciwgRWxlbWVudFJlZiwgTE9DQUxFX0lEIH0gZnJvbSBcIkBhbmd1bGFyL2NvcmVcIjtcclxuaW1wb3J0IHsgQ29sdW1uRm9ybWF0U2VydmljZSB9IGZyb20gXCJAZmFycmlzL3VpLWNvbW1vbi9jb2x1bW5cIjtcclxuaW1wb3J0IHsgRkZpbGVVdGlscyB9IGZyb20gXCIuLi91dGlscy9mLWZpbGUudXRpbHNcIjtcclxuaW1wb3J0IHsgRGF0ZVRpbWVIZWxwZXJTZXJ2aWNlIH0gZnJvbSBcIkBmYXJyaXMvdWktY29tbW9uL2RhdGVcIjtcclxuLyoqXHJcbiAqIOaWh+S7tuWkp+Wwj+agvOW8j+WMllxyXG4gKi9cclxuQFBpcGUoe1xyXG4gICAgbmFtZTogXCJmRmlsZVNpemVcIixcclxufSlcclxuZXhwb3J0IGNsYXNzIEZGaWxlU2l6ZVBpcGUgaW1wbGVtZW50cyBQaXBlVHJhbnNmb3JtIHtcclxuICAgIHRyYW5zZm9ybSh2YWx1ZTogYW55LCBhcmdzPzogYW55KTogYW55IHtcclxuICAgICAgICAvLyDlpoLmnpzmmK/lrZfnrKbkuLJcclxuICAgICAgICBsZXQgdHZhbHVlID0gdmFsdWU7XHJcbiAgICAgICAgaWYgKCF2YWx1ZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gXCIwIEJ5dGVcIjtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHR5cGVvZiB2YWx1ZSA9PSBcInN0cmluZ1wiKSB7XHJcbiAgICAgICAgICAgIHR2YWx1ZSA9IHBhcnNlSW50KHZhbHVlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIEZGaWxlVXRpbHMuaHVtYW5pemVCeXRlcyh0dmFsdWUpO1xyXG4gICAgfVxyXG59XHJcbi8qKlxyXG4gKiDml6XmnJ/moLzlvI/ljJZcclxuICovXHJcbkBQaXBlKHtcclxuICAgIG5hbWU6IFwiZkZpbGVEYXRlXCIsXHJcbn0pXHJcbmV4cG9ydCBjbGFzcyBGRmlsZURhdGVQaXBlIGltcGxlbWVudHMgUGlwZVRyYW5zZm9ybSB7XHJcbiAgICBjb25zdHJ1Y3Rvcihwcml2YXRlIGRhdGVTZXI6IERhdGVUaW1lSGVscGVyU2VydmljZSkgeyB9XHJcbiAgICB0cmFuc2Zvcm0odmFsdWU6IGFueSwgcmV0dXJuRm9ybWF0OiBzdHJpbmcgPSBcInl5eXktTU0tZGRcIik6IGFueSB7XHJcbiAgICAgICAgaWYoIXZhbHVlKSByZXR1cm4gJyc7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZGF0ZVNlci5mb3JtYXRUbyh2YWx1ZSwgcmV0dXJuRm9ybWF0KTtcclxuICAgIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIOagvOW8j+WMluiHquWumuS5ieaVsOaNrlxyXG4gKi9cclxuXHJcbkBQaXBlKHsgbmFtZTogXCJmb3JtYXRDZWxsRGF0YVwiLCBwdXJlOiBmYWxzZSB9KVxyXG5leHBvcnQgY2xhc3MgRm9ybWF0Q2VsbERhdGFQaXBlIGltcGxlbWVudHMgUGlwZVRyYW5zZm9ybSB7XHJcbiAgICBwcml2YXRlIGVsUmVmOiBFbGVtZW50UmVmO1xyXG4gICAgLy8g5YWI5LiN5aSE55CG5aSa6K+t6KiAXHJcbiAgICBwcml2YXRlIGxvY2FsZUlkID0gXCJaSC1DSFNcIjtcclxuICAgIGNvbnN0cnVjdG9yKHByaXZhdGUgY2ZzOiBDb2x1bW5Gb3JtYXRTZXJ2aWNlLCBwcml2YXRlIGluamVjdG9yOiBJbmplY3RvcikgeyB9XHJcbiAgICAvKipcclxuICAgICAqIOagvOW8j+WMluaVsOaNrlxyXG4gICAgICogQHBhcmFtIGNvbHVtbjrliJfkv6Hmga9cclxuICAgICAqIEBwYXJhbSByb3dEYXRhOuW9k+WJjeaVsOaNrlxyXG4gICAgICogQHBhcmFtIHNldHRpbmdzOumFjee9ruS/oeaBr1xyXG4gICAgICogQHBhcmFtIHN0YXRlOiDnirbmgIFcclxuICAgICAqIEByZXR1cm5zXHJcbiAgICAgKi9cclxuICAgIHRyYW5zZm9ybShjb2x1bW4sIHJvd0RhdGEsIHJvd0luZGV4LCBzZXR0aW5ncywgc3RhdGUgPSBcInByZXZpZXdcIik6IGFueSB7XHJcbiAgICAgICAgaWYgKHJvd0RhdGEgJiYgY29sdW1uICYmIGNvbHVtbi5maWVsZCkge1xyXG4gICAgICAgICAgICAvLyDlgLxcclxuICAgICAgICAgICAgbGV0IHZhbHVlID10aGlzLmdldFJlYWxEYXRhVmFsdWUocm93RGF0YSxjb2x1bW4uZmllbGQpO1xyXG4gICAgICAgICAgICBsZXQgZm9ybWF0dGVyRm4gPSBjb2x1bW4uZm9ybWF0dGVyO1xyXG4gICAgICAgICAgICBpZiAoZm9ybWF0dGVyRm4pIHtcclxuICAgICAgICAgICAgICAgIGlmIChmb3JtYXR0ZXJGbi50eXBlID09PSBcIm51bWJlclwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAhZm9ybWF0dGVyRm4ub3B0aW9ucyB8fFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAhT2JqZWN0LmtleXMoZm9ybWF0dGVyRm4ub3B0aW9ucykubGVuZ3RoXHJcbiAgICAgICAgICAgICAgICAgICAgKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvcm1hdHRlckZuLm9wdGlvbnMgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aG91c2FuZDogXCIsXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmVjaXNpb246IDIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgLy8g5LiN6ZyA6KaB54m55q6K5aSE55CGXHJcbiAgICAgICAgICAgICAgICAvLyBpZiAoZm9ybWF0dGVyRm4udHlwZSA9PT0gXCJkYXRldGltZVwiKSB7XHJcbiAgICAgICAgICAgICAgICAvLyB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy/lj4LmlbAx77yaIOWAvO+8jOWPguaVsDLvvJrooYzmlbDmja4g5Y+C5pWwM++8muagvOW8j+WMluaWueazlVxyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5jZnMuZm9ybWF0KHZhbHVlLCByb3dEYXRhLCBmb3JtYXR0ZXJGbiwgeyByb3dJbmRleCwgc2V0dGluZ3MgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBcIlwiO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiDojrflj5bnnJ/mraPnmoTmlbDmja5cclxuICAgICAqIEBwYXJhbSByb3dEYXRhIFxyXG4gICAgICogQHBhcmFtIGZpZWxkIFxyXG4gICAgICogQHJldHVybnMgXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgZ2V0UmVhbERhdGFWYWx1ZShyb3dEYXRhLCBmaWVsZCkge1xyXG4gICAgICAgIGlmICghZmllbGR8fCFyb3dEYXRhKSByZXR1cm4gJyc7XHJcbiAgICAgICAgbGV0IGZpZWxkQXJyYXkgPSBmaWVsZC5zcGxpdCgnLicpO1xyXG4gICAgICAgIGlmIChmaWVsZEFycmF5Lmxlbmd0aCA9PSAxKSB7XHJcbiAgICAgICAgICAgIHJldHVybiByb3dEYXRhW2ZpZWxkQXJyYXlbMF1dO1xyXG4gICAgICAgIH1cclxuICAgICAgICBsZXQgY3VySXRlbVZhbCA9IHJvd0RhdGE7XHJcbiAgICAgICAgZm9yICh2YXIgayA9IDA7IGsgPCBmaWVsZEFycmF5Lmxlbmd0aDsgaysrKSB7XHJcbiAgICAgICAgICAgIGN1ckl0ZW1WYWwgPSBjdXJJdGVtVmFsW2ZpZWxkQXJyYXlba11dO1xyXG4gICAgICAgICAgICAvLyDmsqHmnInlgLzmiJbogIXmsqHmnInmraTlsZ7mgKdcclxuICAgICAgICAgICAgaWYgKGN1ckl0ZW1WYWwgPT0gbnVsbCB8fCBjdXJJdGVtVmFsID09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGsgPT0gZmllbGRBcnJheS5sZW5ndGgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGN1ckl0ZW1WYWwgPT0gbnVsbCB8fCBjdXJJdGVtVmFsID09IHVuZGVmaW5lZD9cIlwiOmN1ckl0ZW1WYWw7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuICcnO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIFxyXG59XHJcbi8qKlxyXG4gKiDpmYTku7blj6/og73kuYvliY3nlJ/miJDnmoTljZXmja7kuK3lubbmsqHmnInlpJror63oqIDmnI3liqFcclxuICog6LCD55So6ZmE5Lu255qE5YWs5YWx5pyN5YqhXHJcbiAqL1xyXG5AUGlwZSh7bmFtZTogJ3VwTG9jYWxlJ30pXHJcbmV4cG9ydCBjbGFzcyBVUExvY2FsZVBpcGUgaW1wbGVtZW50cyBQaXBlVHJhbnNmb3JtIHtcclxuICAgIGNvbnN0cnVjdG9yKCkge31cclxuICAgIHRyYW5zZm9ybShuYW1lOiBhbnksIC4uLnJlcGxhY2VWYWw6IGFueVtdKTogYW55IHtcclxuICAgICAgICAgIHJldHVybiAgRkZpbGVVdGlscy5nZXRMb2NhbFN0cihuYW1lLHJlcGxhY2VWYWwpO1xyXG4gICAgfVxyXG59XHJcblxyXG4vKipcclxuICog6Kej5Yaz5Y+Y6YeP5pyJ5Liq6buY6K6k55qE5paH5a2X77yM5Y+Y6YeP5pyA57uI5Y+v6IO95piv6buY6K6k5YC85Lmf5Y+v6IO95LiN5pivXHJcbiAqL1xyXG5AUGlwZSh7bmFtZTogJ3VwTG9jYWxlRGVmYXVsdCd9KVxyXG5leHBvcnQgY2xhc3MgVVBMb2NhbGVEZWZhdWx0UGlwZSBpbXBsZW1lbnRzIFBpcGVUcmFuc2Zvcm0ge1xyXG4gICAgY29uc3RydWN0b3IoKSB7fVxyXG4gICAgdHJhbnNmb3JtKHJlYWxWYWx1ZTogYW55LGNvbXBhcmVUeHQ6c3RyaW5nLGxvY2FsZU5hbWU6c3RyaW5nKTogYW55IHtcclxuICAgICAgICBpZihyZWFsVmFsdWU9PWNvbXBhcmVUeHQpe1xyXG4gICAgICAgICAgICByZXR1cm4gIEZGaWxlVXRpbHMuZ2V0TG9jYWxTdHIobG9jYWxlTmFtZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiByZWFsVmFsdWU7XHJcbiAgICB9ICAgICAgICAgXHJcbn1cclxuXHJcblxyXG4iXX0=