/**
 * @fileoverview added by tsickle
 * Generated from: lib/utils/f-file.utils.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { UploadStatus } from '../model';
import { FARRIS_UPLOADFILE_LOCALEDATA } from '../locale';
/** @type {?} */
const isObject = (/**
 * @param {?} value
 * @return {?}
 */
value => typeof value === 'object' && value !== null);
const ɵ0 = isObject;
/** @type {?} */
const isArray = (/**
 * @param {?} value
 * @return {?}
 */
value => Array.isArray(value));
const ɵ1 = isArray;
/** @type {?} */
let localSerStorage = null;
// 暂时用不到
/** @type {?} */
const deepCloneObject = (/**
 * @param {?} src
 * @return {?}
 */
(src) => {
    if (!isObject(src))
        return src;
    /** @type {?} */
    const target = isArray(src) ? [] : {};
    for (const key in src) {
        if (!src.hasOwnProperty(key))
            continue;
        /** @type {?} */
        const v = src[key];
        target[key] = v && isObject(v) ? deepCloneObject(v) : v;
    }
    return target;
});
const ɵ2 = deepCloneObject;
/** @type {?} */
const humanizeBytes = (/**
 * @param {?} bytes
 * @return {?}
 */
(bytes) => {
    if (bytes === 0) {
        return '0 Byte';
    }
    /** @type {?} */
    const k = 1024;
    /** @type {?} */
    const sizes = ['Bytes', 'KB', 'MB', 'GB', 'TB', 'PB'];
    /** @type {?} */
    const i = Math.floor(Math.log(bytes) / Math.log(k));
    return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
});
const ɵ3 = humanizeBytes;
/** @type {?} */
const generateId = (/**
 * @return {?}
 */
() => {
    return Math.random().toString(36).substring(7);
});
const ɵ4 = generateId;
/** @type {?} */
const makeUploadFile = (/**
 * @param {?} file
 * @param {?} index
 * @return {?}
 */
(file, index) => {
    return {
        fileIndex: index,
        id: generateId(),
        name: file.name,
        size: file.size,
        type: file.type,
        form: new FormData(),
        progress: {
            status: UploadStatus.Queue,
            data: {
                percentage: 0,
                speed: 0,
                speedHuman: `${humanizeBytes(0)}/s`,
                startTime: null,
                endTime: null,
                eta: null,
                etaHuman: null
            }
        },
        lastModifiedDate: new Date(file.lastModified),
        sub: undefined,
        nativeFile: file
    };
});
const ɵ5 = makeUploadFile;
/** @type {?} */
const allMineTypes = {
    '.pdf': 'application/pdf',
    '.gif': 'image/gif',
    '.png': 'image/png',
    '.txt': 'text/plain',
    '.htm': 'text/html',
    '.html': 'text/html',
    '.jpe': 'image/jpeg',
    '.jpeg': 'image/jpeg',
    '.jpg': 'image/jpeg',
    '.js': 'text/javascript,application/javascript',
    '.json': 'application/json',
    '.pps': 'application/vnd.ms-powerpoint',
    '.ppt': 'application/vnd.ms-powerpoint',
    '.doc': 'application/msword',
    '.xml': 'text/xml,application/xml',
    '.zip': 'aplication/zip',
    '.xlsx': 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet',
    '.wps': 'application/vnd.ms-works',
    '.3gpp': 'audio/3gpp, video/3gpp',
    '.ac3': 'audio/ac3',
    '.asf': 'allpication/vnd.ms-asf',
    '.au': 'audio/basic',
    '.css': 'text/css',
    '.csv': 'text/csv',
    '.dot': 'application/msword',
    '.dtd': 'application/xml-dtd',
    '.dwg': 'image/vnd.dwg',
    '.dxf': 'image/vnd.dxf',
    '.jp2': 'image/jp2',
    '.mp2': 'audio/mpeg, video/mpeg',
    '.mp3': ' audio/mpeg',
    '.mp4': 'audio/mp4, video/mp4',
    '.mpeg': 'video/mpeg',
    '.mpg': 'video/mpeg',
    '.mpp': 'application/vnd.ms-project',
    '.ogg': 'application/ogg, audio/ogg',
    '.pot': 'application/vnd.ms-powerpoint',
    '.rtf': 'application/rtf,text/rtf',
    '.svf': 'image/vnd.svf',
    '.tif': 'image/tiff',
    '.tiff': 'image/tiff',
    '.wdb': 'application/vnd.ms-works',
    '.xhtml': 'application/xhtml+xml',
    '.xlc': 'application/vnd.ms-excel',
    '.xlm': 'application/vnd.ms-excel',
    '.xls': 'application/vnd.ms-excel',
    '.xlt': 'application/vnd.ms-excel',
    '.xlw': 'application/vnd.ms-excel'
};
/** @type {?} */
const findMineTypeBySuffix = (/**
 * @param {?} suffix
 * @return {?}
 */
(suffix) => {
    if (allMineTypes.hasOwnProperty(suffix)) {
        return allMineTypes[suffix];
    }
    return '';
});
const ɵ6 = findMineTypeBySuffix;
/** @type {?} */
const changeUploadFileToFileExtend = (/**
 * @param {?} files
 * @return {?}
 */
(files) => {
    // 如果是数组
    /** @type {?} */
    let result = [];
    files.forEach((/**
     * @param {?} file
     * @return {?}
     */
    file => {
        /** @type {?} */
        let preExtend = (/** @type {?} */ ({ id: '', name: '', size: 0, type: '', extend: null, extendStatus: 0, extendHeaders: null }));
        for (let resultProp in preExtend) {
            /** @type {?} */
            let tempProp = resultProp.replace('extend', 'response');
            if (file.hasOwnProperty(tempProp)) {
                preExtend[resultProp] = file[tempProp];
            }
        }
        result.push(preExtend);
    }));
    return result;
})
/**
 * 标记是否已处理多语言
 * 解决
 * 1、f-file-uploader.service.ts和f-file-preview.component.ts 构造函数中没有引入多语言，
 * 要支持多语言就必须重新编译的问题
 * 2、引入通用处理的类，在类中进行保存服务
 */
;
const ɵ7 = changeUploadFileToFileExtend;
/**
 * 标记是否已处理多语言
 * 解决
 * 1、f-file-uploader.service.ts和f-file-preview.component.ts 构造函数中没有引入多语言，
 * 要支持多语言就必须重新编译的问题
 * 2、引入通用处理的类，在类中进行保存服务
 * @type {?}
 */
const getLocalState = (/**
 * @param {?} localSer
 * @return {?}
 */
(localSer) => {
    if (localSerStorage) {
        return true;
    }
    if (localSer && !localSerStorage) {
        localSer.setLocaleData(FARRIS_UPLOADFILE_LOCALEDATA);
        localSerStorage = localSer;
        return true;
    }
    return false;
})
/**
 * 替换字符串
 * @param value
 * @param args
 * @returns
 */
;
const ɵ8 = getLocalState;
/**
 * 替换字符串
 * \@param value
 * \@param args
 * \@return
 * @type {?}
 */
const replaceStr = (/**
 * @param {?} value
 * @param {...?} args
 * @return {?}
 */
(value, ...args) => {
    args.forEach((/**
     * @param {?} v
     * @param {?} i
     * @return {?}
     */
    (v, i) => {
        value = value.replace(`{${i}}`, v);
    }));
    return value;
})
/**
 * 获取多语言数据
 * 某些组件没有重新生成，要支持多语言
 * @param key
 * @param replaceInfo
 */
;
const ɵ9 = replaceStr;
/**
 * 获取多语言数据
 * 某些组件没有重新生成，要支持多语言
 * \@param key
 * \@param replaceInfo
 * @type {?}
 */
const getLocalStr = (/**
 * @param {?} lanKey
 * @param {?=} replaceInfo
 * @return {?}
 */
(lanKey, replaceInfo = []) => {
    /** @type {?} */
    let result = "";
    /** @type {?} */
    let defaultLocalId = 'zh-CHS';
    if (localSerStorage) {
        result = localSerStorage.getValue(lanKey);
    }
    else {
        defaultLocalId = localStorage.getItem('languageCode') || 'zh-CHS';
    }
    if (!result) {
        //说明前面的语言环境没有取到
        result = lanKey.split('.').reduce((/**
         * @param {?} obj
         * @param {?} key
         * @return {?}
         */
        (obj, key) => {
            if (obj) {
                return obj[key];
            }
            else {
                return null;
            }
        }), FARRIS_UPLOADFILE_LOCALEDATA[defaultLocalId]);
    }
    if (result && replaceInfo.length > 0) {
        return replaceStr(result, replaceInfo);
    }
    return result;
});
const ɵ10 = getLocalStr;
/** @type {?} */
export const FFileUtils = {
    isObject,
    isArray,
    deepCloneObject,
    humanizeBytes,
    makeUploadFile,
    findMineTypeBySuffix,
    changeUploadFileToFileExtend,
    getLocalState,
    getLocalStr
};
export { ɵ0, ɵ1, ɵ2, ɵ3, ɵ4, ɵ5, ɵ6, ɵ7, ɵ8, ɵ9, ɵ10 };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZi1maWxlLnV0aWxzLmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGZhcnJpcy9leHRlbmQtZmlsZS11cGxvYWQvIiwic291cmNlcyI6WyJsaWIvdXRpbHMvZi1maWxlLnV0aWxzLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7O0FBQ0EsT0FBTyxFQUFjLFlBQVksRUFBcUIsTUFBTSxVQUFVLENBQUM7QUFDdkUsT0FBTyxFQUFFLDRCQUE0QixFQUFFLE1BQU0sV0FBVyxDQUFDOztNQUNuRCxRQUFROzs7O0FBQUcsS0FBSyxDQUFDLEVBQUUsQ0FBQyxPQUFPLEtBQUssS0FBSyxRQUFRLElBQUksS0FBSyxLQUFLLElBQUksQ0FBQTs7O01BQy9ELE9BQU87Ozs7QUFBRyxLQUFLLENBQUMsRUFBRSxDQUFDLEtBQUssQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFDLENBQUE7OztJQUN6QyxlQUFlLEdBQUMsSUFBSTs7O01BRWxCLGVBQWU7Ozs7QUFBRyxDQUFDLEdBQUcsRUFBRSxFQUFFO0lBQzVCLElBQUksQ0FBQyxRQUFRLENBQUMsR0FBRyxDQUFDO1FBQUUsT0FBTyxHQUFHLENBQUM7O1VBQ3pCLE1BQU0sR0FBRyxPQUFPLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsRUFBRTtJQUNyQyxLQUFLLE1BQU0sR0FBRyxJQUFJLEdBQUcsRUFBRTtRQUNuQixJQUFJLENBQUMsR0FBRyxDQUFDLGNBQWMsQ0FBQyxHQUFHLENBQUM7WUFBRSxTQUFTOztjQUNqQyxDQUFDLEdBQUcsR0FBRyxDQUFDLEdBQUcsQ0FBQztRQUNsQixNQUFNLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxJQUFJLFFBQVEsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsZUFBZSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7S0FDM0Q7SUFDRCxPQUFPLE1BQU0sQ0FBQztBQUNsQixDQUFDLENBQUE7OztNQUVLLGFBQWE7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OztBQUFDLENBQUMsTUFBYSxFQUFDLGNBQTBCLEVBQUUsRUFBQyxFQUFFOztRQUN4RCxNQUFNLEdBQUMsRUFBRTs7UUFDVCxjQUFjLEdBQUMsUUFBUTtJQUMzQixJQUFHLGVBQWUsRUFBQztRQUNmLE1BQU0sR0FBQyxlQUFlLENBQUMsUUFBUSxDQUFDLE1BQU0sQ0FBQyxDQUFDO0tBQzNDO1NBQUk7UUFDRCxjQUFjLEdBQUUsWUFBWSxDQUFDLE9BQU8sQ0FBQyxjQUFjLENBQUMsSUFBRSxRQUFRLENBQUM7S0FDbEU7SUFDRCxJQUFHLENBQUMsTUFBTSxFQUFDO1FBQ1gsZUFBZTtRQUNYLE1BQU0sR0FBRyxNQUFNLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDLE1BQU07Ozs7O1FBQUMsQ0FBQyxHQUFHLEVBQUUsR0FBRyxFQUFFLEVBQUU7WUFDM0MsSUFBSSxHQUFHLEVBQUU7Z0JBQ0wsT0FBTyxHQUFHLENBQUMsR0FBRyxDQUFDLENBQUM7YUFDbkI7aUJBQU07Z0JBQ0gsT0FBTyxJQUFJLENBQUM7YUFDZjtRQUNMLENBQUMsR0FBRSw0QkFBNEIsQ0FBQyxjQUFjLENBQUMsQ0FBQyxDQUFDO0tBQ3BEO0lBQ0QsSUFBRyxNQUFNLElBQUUsV0FBVyxDQUFDLE1BQU0sR0FBQyxDQUFDLEVBQUM7UUFDNUIsT0FBTyxVQUFVLENBQUMsTUFBTSxFQUFDLFdBQVcsQ0FBQyxDQUFDO0tBQ3pDO0lBQ0QsT0FBTyxNQUFNLENBQUM7QUFDbEIsQ0FBQyxDQUFBOzs7QUFHRCxNQUFNLE9BQU8sVUFBVSxHQUFHO0lBQ3RCLFFBQVE7SUFDUixPQUFPO0lBQ1AsZUFBZTtJQUNmLGFBQWE7SUFDYixjQUFjO0lBQ2Qsb0JBQW9CO0lBQ3BCLDRCQUE0QjtJQUM1QixhQUFhO0lBQ2IsV0FBVztDQUNkIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTG9jYWxlU2VydmljZSB9IGZyb20gJ0BmYXJyaXMvdWktbG9jYWxlJztcclxuaW1wb3J0IHsgVXBsb2FkRmlsZSwgVXBsb2FkU3RhdHVzLCBGVXBsb2FkRmlsZUV4dGVuZCB9IGZyb20gJy4uL21vZGVsJztcclxuaW1wb3J0IHsgRkFSUklTX1VQTE9BREZJTEVfTE9DQUxFREFUQSB9IGZyb20gJy4uL2xvY2FsZSc7XHJcbmNvbnN0IGlzT2JqZWN0ID0gdmFsdWUgPT4gdHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyAmJiB2YWx1ZSAhPT0gbnVsbDtcclxuY29uc3QgaXNBcnJheSA9IHZhbHVlID0+IEFycmF5LmlzQXJyYXkodmFsdWUpO1xyXG5sZXQgbG9jYWxTZXJTdG9yYWdlPW51bGw7XHJcbi8vIOaaguaXtueUqOS4jeWIsFxyXG5jb25zdCBkZWVwQ2xvbmVPYmplY3QgPSAoc3JjKSA9PiB7XHJcbiAgICBpZiAoIWlzT2JqZWN0KHNyYykpIHJldHVybiBzcmM7XHJcbiAgICBjb25zdCB0YXJnZXQgPSBpc0FycmF5KHNyYykgPyBbXSA6IHt9O1xyXG4gICAgZm9yIChjb25zdCBrZXkgaW4gc3JjKSB7XHJcbiAgICAgICAgaWYgKCFzcmMuaGFzT3duUHJvcGVydHkoa2V5KSkgY29udGludWU7XHJcbiAgICAgICAgY29uc3QgdiA9IHNyY1trZXldO1xyXG4gICAgICAgIHRhcmdldFtrZXldID0gdiAmJiBpc09iamVjdCh2KSA/IGRlZXBDbG9uZU9iamVjdCh2KSA6IHY7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gdGFyZ2V0O1xyXG59XHJcblxyXG5jb25zdCBodW1hbml6ZUJ5dGVzID0gKGJ5dGVzOiBudW1iZXIpOiBzdHJpbmcgPT4ge1xyXG4gICAgaWYgKGJ5dGVzID09PSAwKSB7XHJcbiAgICAgICAgcmV0dXJuICcwIEJ5dGUnO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IGsgPSAxMDI0O1xyXG4gICAgY29uc3Qgc2l6ZXM6IHN0cmluZ1tdID0gWydCeXRlcycsICdLQicsICdNQicsICdHQicsICdUQicsICdQQiddO1xyXG4gICAgY29uc3QgaTogbnVtYmVyID0gTWF0aC5mbG9vcihNYXRoLmxvZyhieXRlcykgLyBNYXRoLmxvZyhrKSk7XHJcblxyXG4gICAgcmV0dXJuIHBhcnNlRmxvYXQoKGJ5dGVzIC8gTWF0aC5wb3coaywgaSkpLnRvRml4ZWQoMikpICsgJyAnICsgc2l6ZXNbaV07XHJcbn1cclxuY29uc3QgZ2VuZXJhdGVJZCA9ICgpOiBzdHJpbmcgPT4ge1xyXG4gICAgcmV0dXJuIE1hdGgucmFuZG9tKCkudG9TdHJpbmcoMzYpLnN1YnN0cmluZyg3KTtcclxufVxyXG5jb25zdCBtYWtlVXBsb2FkRmlsZSA9IChmaWxlOiBGaWxlLCBpbmRleDogbnVtYmVyKTogVXBsb2FkRmlsZSA9PiB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIGZpbGVJbmRleDogaW5kZXgsXHJcbiAgICAgICAgaWQ6IGdlbmVyYXRlSWQoKSxcclxuICAgICAgICBuYW1lOiBmaWxlLm5hbWUsXHJcbiAgICAgICAgc2l6ZTogZmlsZS5zaXplLFxyXG4gICAgICAgIHR5cGU6IGZpbGUudHlwZSxcclxuICAgICAgICBmb3JtOiBuZXcgRm9ybURhdGEoKSxcclxuICAgICAgICBwcm9ncmVzczoge1xyXG4gICAgICAgICAgICBzdGF0dXM6IFVwbG9hZFN0YXR1cy5RdWV1ZSxcclxuICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgcGVyY2VudGFnZTogMCxcclxuICAgICAgICAgICAgICAgIHNwZWVkOiAwLFxyXG4gICAgICAgICAgICAgICAgc3BlZWRIdW1hbjogYCR7aHVtYW5pemVCeXRlcygwKX0vc2AsXHJcbiAgICAgICAgICAgICAgICBzdGFydFRpbWU6IG51bGwsXHJcbiAgICAgICAgICAgICAgICBlbmRUaW1lOiBudWxsLFxyXG4gICAgICAgICAgICAgICAgZXRhOiBudWxsLFxyXG4gICAgICAgICAgICAgICAgZXRhSHVtYW46IG51bGxcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgbGFzdE1vZGlmaWVkRGF0ZTogbmV3IERhdGUoZmlsZS5sYXN0TW9kaWZpZWQpLFxyXG4gICAgICAgIHN1YjogdW5kZWZpbmVkLFxyXG4gICAgICAgIG5hdGl2ZUZpbGU6IGZpbGVcclxuICAgIH07XHJcbn1cclxuXHJcbmNvbnN0IGFsbE1pbmVUeXBlcyA9IHtcclxuICAgICcucGRmJzogJ2FwcGxpY2F0aW9uL3BkZicsXHJcbiAgICAnLmdpZic6ICdpbWFnZS9naWYnLFxyXG4gICAgJy5wbmcnOiAnaW1hZ2UvcG5nJyxcclxuICAgICcudHh0JzogJ3RleHQvcGxhaW4nLFxyXG4gICAgJy5odG0nOiAndGV4dC9odG1sJyxcclxuICAgICcuaHRtbCc6ICd0ZXh0L2h0bWwnLFxyXG4gICAgJy5qcGUnOiAnaW1hZ2UvanBlZycsXHJcbiAgICAnLmpwZWcnOiAnaW1hZ2UvanBlZycsXHJcbiAgICAnLmpwZyc6ICdpbWFnZS9qcGVnJyxcclxuICAgICcuanMnOiAndGV4dC9qYXZhc2NyaXB0LGFwcGxpY2F0aW9uL2phdmFzY3JpcHQnLFxyXG4gICAgJy5qc29uJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxyXG4gICAgJy5wcHMnOiAnYXBwbGljYXRpb24vdm5kLm1zLXBvd2VycG9pbnQnLFxyXG4gICAgJy5wcHQnOiAnYXBwbGljYXRpb24vdm5kLm1zLXBvd2VycG9pbnQnLFxyXG4gICAgJy5kb2MnOiAnYXBwbGljYXRpb24vbXN3b3JkJyxcclxuICAgICcueG1sJzogJ3RleHQveG1sLGFwcGxpY2F0aW9uL3htbCcsXHJcbiAgICAnLnppcCc6ICdhcGxpY2F0aW9uL3ppcCcsXHJcbiAgICAnLnhsc3gnOiAnYXBwbGljYXRpb24vdm5kLm9wZW54bWxmb3JtYXRzLW9mZmljZWRvY3VtZW50LnNwcmVhZHNoZWV0bWwuc2hlZXQnLFxyXG4gICAgJy53cHMnOiAnYXBwbGljYXRpb24vdm5kLm1zLXdvcmtzJyxcclxuICAgICcuM2dwcCc6ICdhdWRpby8zZ3BwLCB2aWRlby8zZ3BwJyxcclxuICAgICcuYWMzJzogJ2F1ZGlvL2FjMycsXHJcbiAgICAnLmFzZic6ICdhbGxwaWNhdGlvbi92bmQubXMtYXNmJyxcclxuICAgICcuYXUnOiAnYXVkaW8vYmFzaWMnLFxyXG4gICAgJy5jc3MnOiAndGV4dC9jc3MnLFxyXG4gICAgJy5jc3YnOiAndGV4dC9jc3YnLFxyXG4gICAgJy5kb3QnOiAnYXBwbGljYXRpb24vbXN3b3JkJyxcclxuICAgICcuZHRkJzogJ2FwcGxpY2F0aW9uL3htbC1kdGQnLFxyXG4gICAgJy5kd2cnOiAnaW1hZ2Uvdm5kLmR3ZycsXHJcbiAgICAnLmR4Zic6ICdpbWFnZS92bmQuZHhmJyxcclxuICAgICcuanAyJzogJ2ltYWdlL2pwMicsXHJcbiAgICAnLm1wMic6ICdhdWRpby9tcGVnLCB2aWRlby9tcGVnJyxcclxuICAgICcubXAzJzogJyBhdWRpby9tcGVnJyxcclxuICAgICcubXA0JzogJ2F1ZGlvL21wNCwgdmlkZW8vbXA0JyxcclxuICAgICcubXBlZyc6ICd2aWRlby9tcGVnJyxcclxuICAgICcubXBnJzogJ3ZpZGVvL21wZWcnLFxyXG4gICAgJy5tcHAnOiAnYXBwbGljYXRpb24vdm5kLm1zLXByb2plY3QnLFxyXG4gICAgJy5vZ2cnOiAnYXBwbGljYXRpb24vb2dnLCBhdWRpby9vZ2cnLFxyXG4gICAgJy5wb3QnOiAnYXBwbGljYXRpb24vdm5kLm1zLXBvd2VycG9pbnQnLFxyXG4gICAgJy5ydGYnOiAnYXBwbGljYXRpb24vcnRmLHRleHQvcnRmJyxcclxuICAgICcuc3ZmJzogJ2ltYWdlL3ZuZC5zdmYnLFxyXG4gICAgJy50aWYnOiAnaW1hZ2UvdGlmZicsXHJcbiAgICAnLnRpZmYnOiAnaW1hZ2UvdGlmZicsXHJcbiAgICAnLndkYic6ICdhcHBsaWNhdGlvbi92bmQubXMtd29ya3MnLFxyXG4gICAgJy54aHRtbCc6ICdhcHBsaWNhdGlvbi94aHRtbCt4bWwnLFxyXG4gICAgJy54bGMnOiAnYXBwbGljYXRpb24vdm5kLm1zLWV4Y2VsJyxcclxuICAgICcueGxtJzogJ2FwcGxpY2F0aW9uL3ZuZC5tcy1leGNlbCcsXHJcbiAgICAnLnhscyc6ICdhcHBsaWNhdGlvbi92bmQubXMtZXhjZWwnLFxyXG4gICAgJy54bHQnOiAnYXBwbGljYXRpb24vdm5kLm1zLWV4Y2VsJyxcclxuICAgICcueGx3JzogJ2FwcGxpY2F0aW9uL3ZuZC5tcy1leGNlbCdcclxufTtcclxuY29uc3QgZmluZE1pbmVUeXBlQnlTdWZmaXggPSAoc3VmZml4OiBzdHJpbmcpOiBzdHJpbmcgPT4ge1xyXG4gICAgaWYgKGFsbE1pbmVUeXBlcy5oYXNPd25Qcm9wZXJ0eShzdWZmaXgpKSB7XHJcbiAgICAgICAgcmV0dXJuIGFsbE1pbmVUeXBlc1tzdWZmaXhdO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuICcnO1xyXG59XHJcblxyXG5jb25zdCBjaGFuZ2VVcGxvYWRGaWxlVG9GaWxlRXh0ZW5kID0gKGZpbGVzOiBVcGxvYWRGaWxlW10pOiBGVXBsb2FkRmlsZUV4dGVuZFtdID0+IHtcclxuICAgIC8vIOWmguaenOaYr+aVsOe7hFxyXG4gICAgbGV0IHJlc3VsdD1bXTtcclxuICAgIGZpbGVzLmZvckVhY2goZmlsZT0+e1xyXG4gICAgICAgIGxldCBwcmVFeHRlbmQgPSB7IGlkOiAnJywgbmFtZTogJycsIHNpemU6IDAsIHR5cGU6ICcnLCBleHRlbmQ6IG51bGwsIGV4dGVuZFN0YXR1czogMCwgZXh0ZW5kSGVhZGVyczogbnVsbCB9IGFzIEZVcGxvYWRGaWxlRXh0ZW5kO1xyXG4gICAgICAgIGZvciAobGV0IHJlc3VsdFByb3AgaW4gcHJlRXh0ZW5kKSB7XHJcbiAgICAgICAgICAgIGxldCB0ZW1wUHJvcCA9IHJlc3VsdFByb3AucmVwbGFjZSgnZXh0ZW5kJywgJ3Jlc3BvbnNlJyk7XHJcbiAgICAgICAgICAgIGlmIChmaWxlLmhhc093blByb3BlcnR5KHRlbXBQcm9wKSkge1xyXG4gICAgICAgICAgICAgICAgcHJlRXh0ZW5kW3Jlc3VsdFByb3BdID0gZmlsZVt0ZW1wUHJvcF07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmVzdWx0LnB1c2gocHJlRXh0ZW5kKTtcclxuICAgIH0pO1xyXG4gICAgXHJcbiAgICByZXR1cm4gcmVzdWx0O1xyXG59XHJcbi8qKlxyXG4gKiDmoIforrDmmK/lkKblt7LlpITnkIblpJror63oqIBcclxuICog6Kej5YazXHJcbiAqIDHjgIFmLWZpbGUtdXBsb2FkZXIuc2VydmljZS50c+WSjGYtZmlsZS1wcmV2aWV3LmNvbXBvbmVudC50cyDmnoTpgKDlh73mlbDkuK3msqHmnInlvJXlhaXlpJror63oqIDvvIxcclxuICog6KaB5pSv5oyB5aSa6K+t6KiA5bCx5b+F6aG76YeN5paw57yW6K+R55qE6Zeu6aKYXHJcbiAqIDLjgIHlvJXlhaXpgJrnlKjlpITnkIbnmoTnsbvvvIzlnKjnsbvkuK3ov5vooYzkv53lrZjmnI3liqFcclxuICovXHJcbmNvbnN0IGdldExvY2FsU3RhdGU9KGxvY2FsU2VyOkxvY2FsZVNlcnZpY2UpPT57XHJcbiAgICBpZihsb2NhbFNlclN0b3JhZ2Upe1xyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfVxyXG4gICAgaWYobG9jYWxTZXImJiFsb2NhbFNlclN0b3JhZ2Upe1xyXG4gICAgICAgICAgICBsb2NhbFNlci5zZXRMb2NhbGVEYXRhKEZBUlJJU19VUExPQURGSUxFX0xPQ0FMRURBVEEpO1xyXG4gICAgICAgICAgICBsb2NhbFNlclN0b3JhZ2U9bG9jYWxTZXI7XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGZhbHNlO1xyXG59XHJcbi8qKlxyXG4gKiDmm7/mjaLlrZfnrKbkuLJcclxuICogQHBhcmFtIHZhbHVlIFxyXG4gKiBAcGFyYW0gYXJncyBcclxuICogQHJldHVybnMgXHJcbiAqL1xyXG5jb25zdCAgcmVwbGFjZVN0cj0odmFsdWU6IGFueSwgLi4uYXJnczogYW55W10pOnN0cmluZyA9PntcclxuICAgIGFyZ3MuZm9yRWFjaCgodiwgaSkgPT4ge1xyXG4gICAgICAgIHZhbHVlID0gdmFsdWUucmVwbGFjZShgeyR7aX19YCwgdik7XHJcbiAgICB9KTtcclxuICAgIHJldHVybiB2YWx1ZTtcclxufVxyXG4vKipcclxuICog6I635Y+W5aSa6K+t6KiA5pWw5o2uXHJcbiAqIOafkOS6m+e7hOS7tuayoeaciemHjeaWsOeUn+aIkO+8jOimgeaUr+aMgeWkmuivreiogFxyXG4gKiBAcGFyYW0ga2V5IFxyXG4gKiBAcGFyYW0gcmVwbGFjZUluZm8gXHJcbiAqL1xyXG5jb25zdCBnZXRMb2NhbFN0cj0obGFuS2V5OnN0cmluZyxyZXBsYWNlSW5mbzpBcnJheTxzdHJpbmc+PVtdKT0+e1xyXG4gICAgbGV0IHJlc3VsdD1cIlwiO1xyXG4gICAgbGV0IGRlZmF1bHRMb2NhbElkPSd6aC1DSFMnO1xyXG4gICAgaWYobG9jYWxTZXJTdG9yYWdlKXtcclxuICAgICAgICByZXN1bHQ9bG9jYWxTZXJTdG9yYWdlLmdldFZhbHVlKGxhbktleSk7XHJcbiAgICB9ZWxzZXtcclxuICAgICAgICBkZWZhdWx0TG9jYWxJZD0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2xhbmd1YWdlQ29kZScpfHwnemgtQ0hTJztcclxuICAgIH1cclxuICAgIGlmKCFyZXN1bHQpe1xyXG4gICAgLy/or7TmmI7liY3pnaLnmoTor63oqIDnjq/looPmsqHmnInlj5bliLBcclxuICAgICAgICByZXN1bHQgPSBsYW5LZXkuc3BsaXQoJy4nKS5yZWR1Y2UoKG9iaiwga2V5KSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChvYmopIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBvYmpba2V5XTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSwgRkFSUklTX1VQTE9BREZJTEVfTE9DQUxFREFUQVtkZWZhdWx0TG9jYWxJZF0pO1xyXG4gICAgfVxyXG4gICAgaWYocmVzdWx0JiZyZXBsYWNlSW5mby5sZW5ndGg+MCl7XHJcbiAgICAgICAgcmV0dXJuIHJlcGxhY2VTdHIocmVzdWx0LHJlcGxhY2VJbmZvKTtcclxuICAgIH1cclxuICAgIHJldHVybiByZXN1bHQ7XHJcbn1cclxuXHJcblxyXG5leHBvcnQgY29uc3QgRkZpbGVVdGlscyA9IHtcclxuICAgIGlzT2JqZWN0LFxyXG4gICAgaXNBcnJheSxcclxuICAgIGRlZXBDbG9uZU9iamVjdCxcclxuICAgIGh1bWFuaXplQnl0ZXMsXHJcbiAgICBtYWtlVXBsb2FkRmlsZSxcclxuICAgIGZpbmRNaW5lVHlwZUJ5U3VmZml4LFxyXG4gICAgY2hhbmdlVXBsb2FkRmlsZVRvRmlsZUV4dGVuZCxcclxuICAgIGdldExvY2FsU3RhdGUsXHJcbiAgICBnZXRMb2NhbFN0clxyXG59Il19