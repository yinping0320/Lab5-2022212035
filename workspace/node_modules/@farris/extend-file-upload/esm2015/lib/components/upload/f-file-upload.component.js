/**
 * @fileoverview added by tsickle
 * Generated from: lib/components/upload/f-file-upload.component.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, Input, HostBinding, ViewChild, EventEmitter, Output, ContentChild, ElementRef, } from "@angular/core";
import { FFileSelectDirective, FFileDropDirective, FFileUploadDirective, } from "../../directive/index";
import { FFileUtils } from "../../utils/index";
import { FFileUploadAPIService, FFileUploaderService, } from "../../service/index";
import { NotifyService } from "@farris/ui-notify";
import { Observable, Subject } from "rxjs";
import { trigger, style, state, animate, transition } from "@angular/animations";
import { NgZone } from "@angular/core";
export class FFileUploadComponent {
    /**
     * @param {?} uploadAPISer
     * @param {?} fileUploaderSer
     * @param {?} notifyService
     * @param {?} ngZone
     */
    constructor(uploadAPISer, fileUploaderSer, notifyService, ngZone) {
        this.uploadAPISer = uploadAPISer;
        this.fileUploaderSer = fileUploaderSer;
        this.notifyService = notifyService;
        this.ngZone = ngZone;
        this.cls = true;
        // 启用图片预览
        this.enableImagePreview = true;
        // 启用立即上传
        this.uploadImmediately = false;
        // 上传完成后隐藏
        this.uploadedThenHide = true;
        // 禁用状态
        this.disabled = false;
        /**
         * 启用分块上传
         */
        this.enableSliceUpload = true;
        /**
         * 分块上传每片大小，单位：M, 默认 1M/块
         */
        this.chunkSize = 1;
        this.tVisible = true;
        // 需要重置,通过不断的赋值来改变
        this.needReset = new Subject();
        // 启用拖拽
        this.enableDrop = false;
        this.dropText = "可将文件拖拽此处";
        // 启用选择文件按钮
        this.enableSelect = true;
        this.selectText = "点击上传";
        // 启用多选
        this.multiple = true;
        // 已经上传文件
        this.uploadedCount = 0;
        // 宽度阈值，当宽度超过760时候，没有附件上传时，宽度是固定值，有附件上传时，有最大宽度值
        this.widthThreshold = 760;
        // 上传和删除对外抛出的事件
        this.fUploadDoneEvent = new EventEmitter();
        this.fUploadRemovedEvent = new EventEmitter();
        // 允许上传的文件类型
        this.allowedContentTypes = "*";
        // 默认不限制附件上传个数
        this.maxUploads = 0;
        // 单位KB，默认是12M
        this.maxFileSize = "12MB";
        this.selfUploadOpts = {};
        // 控制是否显示追加附件的面板
        this.showAppendPanel = false;
        // 显示loading
        this.showLoading = false;
        this.settings = {
            disabled: this.disabled,
            visible: this.visible,
        };
        this.files = [];
        this.uploadSelectInput = new EventEmitter();
        this.uploadDragInput = new EventEmitter();
        // 重置
        this.needReset.subscribe((/**
         * @param {?} data
         * @return {?}
         */
        (data) => {
            this.reset();
        }));
        FFileUtils.getLocalState(this.notifyService.localeService);
    }
    // 不可见
    /**
     * @return {?}
     */
    get visibleState() {
        return !this.visible;
    }
    // 自定义样式
    /**
     * @return {?}
     */
    get selfDirectiveDefine() {
        if (this.fFileUploadDir) {
            return true;
        }
        return false;
    }
    /**
     * @return {?}
     */
    get uploading() {
        return this.files.length > 0;
    }
    // 是否可见
    /**
     * @param {?} value
     * @return {?}
     */
    set visible(value) {
        this.tVisible = value;
        if (!value) {
            this.reset();
        }
    }
    /**
     * @return {?}
     */
    get visible() {
        return this.tVisible;
    }
    // 上传配置项
    /**
     * @param {?} uploadOpts
     * @return {?}
     */
    set options(uploadOpts) {
        if (uploadOpts) {
            if (uploadOpts.hasOwnProperty("allowedContentTypes")) {
                this.allowedContentTypes = uploadOpts.allowedContentTypes.join(",");
                this.allowedContentTypes =
                    this.allowedContentTypes == "" ? "*" : this.allowedContentTypes;
            }
            if (uploadOpts.hasOwnProperty("maxUploads")) {
                this.maxUploads = uploadOpts.maxUploads;
            }
            if (uploadOpts.hasOwnProperty("maxFileSize")) {
                this.maxFileSize = FFileUtils.humanizeBytes(1024 * 1024 * uploadOpts.maxFileSize);
            }
            this.selfUploadOpts = Object.assign(this.selfUploadOpts, uploadOpts);
        }
    }
    /**
     * @return {?}
     */
    get options() {
        return this.selfUploadOpts;
    }
    /**
     * 每个组可以设置特殊服务参数，来覆盖默认的统一模块级配置
     * @param {?} config
     * @return {?}
     */
    set extendServerConfig(config) {
        if (config) {
            this.fileUploaderSer.setExtendServerConfig(config);
        }
    }
    /**
     * @return {?}
     */
    ngOnInit() {
        // 模板的情况下只能是立即上传
        if (this.fFileUploadDir) {
            this.uploadImmediately = true;
        }
        this.computeWidthThreshold();
    }
    /**
     * 视图初始化后
     * @return {?}
     */
    ngAfterViewInit() { }
    /**
     * 触发绑定
     * @param {?} ev
     * @return {?}
     */
    triggerFileSelect(ev) {
        ev && ev.stopPropagation();
        // 禁用时
        if (this.disabled) {
            return false;
        }
        this.fileUpload.elementRef.nativeElement.click();
    }
    /**
     * 选择附件按钮，处理抛出事件
     * @param {?} output
     * @return {?}
     */
    selectUploadOutput(output) {
        this.uploadOutputHandler(output);
    }
    /**
     * 拖拽区域处理抛出事件
     * @param {?} output
     * @return {?}
     */
    dropUploadOutput(output) {
        if (this.enableSelect) {
            return;
        }
        // 暂不处理拖拽的事件
        if (output.type !== "dragOver" &&
            output.type !== "dragOut" &&
            output.type !== "drop") {
            this.uploadOutputHandler(output);
        }
    }
    /**
     * allAddedToQueue 选中文件追加到队列
     * @private
     * @param {?} output
     * @return {?}
     */
    uploadOutputHandler(output) {
        // 显示追加面板
        if (this.showAppendPanel) {
            this.showAppendPanel = false;
        }
        if (output.type === "addedToQueue" && typeof output.file !== "undefined") {
            this.files.push({ type: output.type, file: output.file });
            // 如果启用立即上传
            if (this.uploadImmediately) {
                this.showLoading = true;
                this.startUpload(output.file);
            }
        }
        else if (output.type === "start") {
            // 开始上传
            this.updateFilesState(output, "");
        }
        else if (output.type == "done") {
            // 上传完成
            this.updateFilesState(output, "done");
            this.fUploadDoneEvent.emit(FFileUtils.changeUploadFileToFileExtend(output.files));
            this.hideAfterLoaded(output);
            // 隐藏正在加载
            if (this.uploadImmediately &&
                this.showLoading &&
                this.allFileUploaded()) {
                this.showLoading = false;
            }
        }
        else if (output.type === "cancelled" ||
            output.type === "removed" ||
            output.type == "error") {
            // 删除或者移除文件
            this.files = this.files.filter((/**
             * @param {?} fileOutput
             * @return {?}
             */
            (fileOutput) => {
                return (output.files.findIndex((/**
                 * @param {?} item
                 * @return {?}
                 */
                (item) => fileOutput.file.id == item.id)) < 0);
            }));
            // 隐藏正在加载
            if (this.uploadImmediately &&
                this.showLoading &&
                this.allFileUploaded()) {
                this.showLoading = false;
            }
            this.showNotify(output);
        }
        else if (output.type === "rejected" &&
            typeof output.file !== "undefined") {
            // 上传被拒绝
            this.showNotify(output);
            // 隐藏正在加载
            if (this.uploadImmediately &&
                this.showLoading &&
                this.allFileUploaded()) {
                this.showLoading = false;
            }
        }
    }
    /**
     * @private
     * @param {?} output
     * @return {?}
     */
    showNotify(output) {
        /** @type {?} */
        let notifyType = "warning";
        if (output.type == "cancelled" || output.type == "removed") {
            notifyType = "success";
        }
        /** @type {?} */
        let message = output.hasOwnProperty("message") ? output["message"] : "";
        this.notifyService[notifyType]((/** @type {?} */ ({
            msg: message,
            timeout: 3000,
        })));
    }
    // 判断是否所有文件都已上传
    /**
     * @private
     * @return {?}
     */
    allFileUploaded() {
        /** @type {?} */
        let findNotDoneIndex = this.files.findIndex((/**
         * @param {?} item
         * @return {?}
         */
        (item) => {
            /** @type {?} */
            let doneTypes = ["done", "cancelled", "removed"];
            /** @type {?} */
            let findTypeIndex = doneTypes.findIndex((/**
             * @param {?} type
             * @return {?}
             */
            (type) => {
                return type == item.type;
            }));
            return findTypeIndex == -1;
        }));
        return findNotDoneIndex == -1 ? true : false;
    }
    /**
     * 更新附件的状态
     * @private
     * @param {?} output
     * @param {?} eventType
     * @return {?}
     */
    updateFilesState(output, eventType) {
        /** @type {?} */
        let startFiles = [];
        if (output.hasOwnProperty("files") && output.files.length > 0) {
            // 此处更新界面可能有性能问题
            startFiles = output.files;
        }
        else if (typeof output.file !== "undefined") {
            startFiles = [output.file];
        }
        eventType = eventType ? eventType : output.type;
        startFiles.map((/**
         * @param {?} item
         * @return {?}
         */
        (item) => {
            /** @type {?} */
            const index = this.files.findIndex((/**
             * @param {?} fileOutput
             * @return {?}
             */
            (fileOutput) => typeof item !== "undefined" && fileOutput.file.id === item.id));
            // 变更状态
            if (index > -1) {
                this.files[index] = { type: eventType, file: item };
            }
        }));
    }
    /**
     * 单个文件上传
     * @param {?} file
     * @return {?}
     */
    startUpload(file) {
        /**
         * Todo:后续可以从上传区块上取内容进行扩展
         * @type {?}
         */
        const event = this.uploadAPISer.getAssignAPI("upload", {
            file: file,
            type: this.enableSliceUpload ? 'sliceUpload' : 'upload',
            data: this.extendDatas,
            chunkSize: this.chunkSize
        });
        this.inputUploadEventEmit(event);
    }
    /**
     * 上传所有
     * @return {?}
     */
    startUploadAll() {
        /**
         *  Todo：后续，如果每个数据不一样，此处的数据得重新归集
         * @type {?}
         */
        const event = this.uploadAPISer.getAssignAPI("uploadAll", {
            type: this.enableSliceUpload ? 'sliceUpload' : "uploadAll",
            files: [],
            data: this.extendDatas,
            chunkSize: this.chunkSize
        });
        this.inputUploadEventEmit(event);
    }
    /**
     * 已上传隐藏属性
     * @param {?} output
     * @return {?}
     */
    hideAfterLoaded(output) {
        //上传完成后删除
        if (this.uploadedThenHide) {
            // this.ngZone.runOutsideAngular(() => {
            setTimeout((/**
             * @return {?}
             */
            () => {
                // 删除或者移除文件
                /** @type {?} */
                let ids = output.files.map((/**
                 * @param {?} fileItem
                 * @return {?}
                 */
                (fileItem) => fileItem.id));
                this.files = this.files.filter((/**
                 * @param {?} fileOutput
                 * @return {?}
                 */
                (fileOutput) => {
                    /** @type {?} */
                    let tIndex = ids.findIndex((/**
                     * @param {?} tId
                     * @return {?}
                     */
                    (tId) => tId == fileOutput.file.id));
                    return tIndex > -1 ? false : true;
                }));
                /** @type {?} */
                const event = this.uploadAPISer.getAssignAPI("hide", {
                    type: "hide",
                    id: ids.join(","),
                });
                this.inputUploadEventEmit(event);
            }), 1000);
            // });
        }
    }
    /**
     * 取消上传
     * @param {?} id
     * @return {?}
     */
    cancelUpload(id) {
        /** @type {?} */
        const event = this.uploadAPISer.getAssignAPI("cancel", {
            id: id,
            type: "cancel",
        });
        this.inputUploadEventEmit(event);
    }
    /**
     * 删除已上传文件
     * @return {?}
     */
    removelAllUpload() {
        /** @type {?} */
        const event = this.uploadAPISer.getAssignAPI("removeAll", {
            type: "removeAll",
            files: [],
        });
        this.inputUploadEventEmit(event);
    }
    /**
     * 删除已上传文件
     * @param {?} id
     * @return {?}
     */
    removeFile(id) {
        /** @type {?} */
        const event = this.uploadAPISer.getAssignAPI("remove", {
            id: id,
            type: "remove",
        });
        this.inputUploadEventEmit(event);
    }
    /** */
    /**
     *
     * @param {?} bytes
     * @return {?}
     */
    formateBytes(bytes) {
        return FFileUtils.humanizeBytes(bytes);
    }
    /**
     * 判断是图片
     * @param {?} type
     * @return {?}
     */
    isImage(type) {
        return type.indexOf("image") > -1;
    }
    // inProgress(progress) {
    //   console.log('进入inProgress');
    //   if (progress.data.percentage == 100) {
    //     return 'done'
    //   }
    //   if (progress.data.percentage == 0) {
    //     return 'uploadi';
    //   }
    //   return 'progress';
    // }
    /**
     * 是否判断有类型限制
     * @return {?}
     */
    judgeContentTypeLimit() {
        /** @type {?} */
        let tTypes = this.allowedContentTypes.split(",");
        /** @type {?} */
        let hasAllIndex = tTypes.findIndex((/**
         * @param {?} item
         * @return {?}
         */
        (item) => {
            return item == "*";
        }));
        return hasAllIndex == -1;
    }
    /**
     * 判断是否有文件大小的限制
     * @return {?}
     */
    judegeFileSizeLimit() {
        return this.maxFileSize != "0 Byte";
    }
    /**
     * 追加
     * @param {?} ev
     * @return {?}
     */
    appendNewFiles(ev) {
        //启用拖拽
        if (this.enableDrop) {
            this.showAppendPanel = true;
        }
        else {
            ev && ev.stopPropagation();
            this.triggerFileSelect(ev);
        }
    }
    /**
     * 关闭追加面板
     * @return {?}
     */
    closeAppendPanel() {
        this.showAppendPanel = false;
    }
    /**
     * 统一触发 附件选择和拖拽附件的事件
     * @private
     * @param {?} ev
     * @return {?}
     */
    inputUploadEventEmit(ev) {
        // 如果文件上传启用
        if (this.enableSelect) {
            this.uploadSelectInput.emit(ev);
        }
        else {
            this.uploadDragInput.emit(ev);
        }
    }
    // 重置方法
    /**
     * @return {?}
     */
    reset() {
        this.files = [];
        // 如果文件上传启用
        if (this.enableSelect) {
            this.fileUpload && this.fileUpload.reset();
        }
        else {
            this.fileDropUpload && this.fileDropUpload.reset();
        }
        this.computeWidthThreshold();
    }
    /**
     * 计算阈值
     * @private
     * @return {?}
     */
    computeWidthThreshold() {
        //
        this.ngZone.runOutsideAngular((/**
         * @return {?}
         */
        () => {
            /** @type {?} */
            let self = this;
            setTimeout((/**
             * @return {?}
             */
            () => {
                /** @type {?} */
                let tNeedComputedCls = false;
                if (self.fFileUploadDir || !self.visible) {
                    tNeedComputedCls = false;
                }
                // 计算元素
                /** @type {?} */
                let assistEl = self.fFileUploadAssist
                    ? self.fFileUploadAssist.nativeElement
                    : null;
                if (assistEl) {
                    assistEl.parentElement.classList["add"]("ffileupload-default");
                }
                return;
                // // 超过阈值
                // if (assistEl && assistEl.getBoundingClientRect().width > self.widthThreshold) {
                //   tNeedComputedCls = true;
                // } else {
                //   tNeedComputedCls = false;
                // }
                // if (assistEl) {
                //   let actionFun = tNeedComputedCls ? 'add' : 'remove';
                //   assistEl.parentElement.classList[actionFun]('ffileupload-default');
                // }
            }), 0);
        }));
    }
}
FFileUploadComponent.decorators = [
    { type: Component, args: [{
                selector: "f-file-upload",
                template: "<div class=\"ffileupload--assist\" #uploadAssist></div>\r\n<ng-container *ngIf=\"visible\">    \r\n    <ng-container *ngIf=\"enableSelect\">\r\n        <input type=\"file\" class=\"ffileupload--browser\" [disabled]=\"disabled\" FFileSelect [options]=\"options\"\r\n            (uploadOutput)=\"selectUploadOutput($event)\" [uploadInput]=\"uploadSelectInput\" [multiple]=\"multiple\"\r\n            [accept]=\"allowedContentTypes\"  [uploadedCount]=\"uploadedCount\">\r\n    </ng-container>\r\n    <ng-container *ngIf=\"!fFileUploadDir\">\r\n        <ng-container *ngIf=\"enableDrop\">\r\n            <div class=\"ffileupload--drop-wrapper\"\r\n                [ngClass]=\"{'drop-wrapper--append':files.length>0,'drop-wrapper--append-show':showAppendPanel}\">\r\n                <div class=\"action-wrapper--is-upload drop-wrapper--header\" [ngClass]=\"showAppendPanel?'':'d-none'\">\r\n                    <div class=\"action-wrapper--header-left\">\r\n                        <button type=\"button\" class=\"btn btn-link mr-2\" (click)=\"closeAppendPanel()\">{{ 'upload.back' | upLocale }}</button>\r\n                    </div>\r\n                </div>\r\n                <div class=\"drop-wrapper--drop-area\" FFileDrop [options]=\"options\"\r\n                    (uploadOutput)=\"dropUploadOutput($event)\" [uploadInput]=\"uploadDragInput\" [disabled]=\"disabled\" [uploadedCount]=\"uploadedCount\">\r\n\r\n                    <button type=\"button\" class=\"btn-upload-icon\" [disabled]=\"disabled\" (click)=\"triggerFileSelect($event)\">\r\n                        <i class=\"f-icon f-icon-upload_big\"></i>\r\n                    </button>\r\n                    <div class=\"drop-wrapper--action\" *ngIf=\"!disabled\">\r\n                        <label class=\"drop-wrapper--action-label\">\r\n                            {{dropText | upLocaleDefault:'\u53EF\u5C06\u6587\u4EF6\u62D6\u62FD\u6B64\u5904':'upload.drop' }}\r\n                        </label> {{ 'upload.orText' | upLocale }} <button type=\"button\" class=\"drop-wrapper--action-select\" [disabled]=\"disabled\"\r\n                            (click)=\"triggerFileSelect($event)\">{{selectText|upLocaleDefault:'\u70B9\u51FB\u4E0A\u4F20':'upload.select'}}</button>\r\n                    </div>\r\n                    <ng-container *ngTemplateOutlet=\"beforeUploadSupportInfo\"></ng-container>\r\n                </div>\r\n            </div>\r\n            <ng-container *ngIf=\"files.length>0\">\r\n                <ng-container *ngTemplateOutlet=\"afterSelectHeader\"></ng-container>\r\n            </ng-container>\r\n        </ng-container>\r\n        <ng-container *ngIf=\"!enableDrop&&enableSelect\">\r\n            <div class=\"ffileupload--action-wrapper\" [ngClass]=\"{'select-wrapper--append':files.length>0}\">\r\n                <ng-container *ngIf=\"files.length==0;else afterSelectHeader\">\r\n                    <div class=\"action-wrapper--before-upload\">\r\n                        <button type=\"button\" class=\"btn-upload-icon\" [disabled]=\"disabled\"\r\n                            (click)=\"triggerFileSelect($event)\">\r\n                            <i class=\"f-icon f-icon-upload_big\"></i>\r\n                        </button>\r\n                    </div>\r\n                </ng-container>\r\n            </div>\r\n        </ng-container>\r\n    </ng-container>\r\n    <div *ngIf=\"fFileUploadDir&&fFileUploadDir.templateRef\" (click)=\"triggerFileSelect($event)\">\r\n        <ng-container [ngTemplateOutlet]=\"fFileUploadDir.templateRef\" [ngTemplateOutletContext]=\"{'disabled':disabled,'settings':settings,'uploadedCount':uploadedCount}\"></ng-container>\r\n    </div>\r\n    <!--\u5F53\u9009\u4E2D\u6587\u4EF6\u4E4B\u540E\u9690\u85CF-->\r\n    <ng-container *ngIf=\"!fFileUploadDir&&!enableDrop&&enableSelect&&files.length==0\">\r\n        <ng-container *ngTemplateOutlet=\"beforeUploadSupportInfo\"></ng-container>\r\n    </ng-container>\r\n    <!-- <div class=\"ffileupload--common-action\" *ngIf=\"files.length>0\">\r\n    <span class=\"common-action--info\">\u5171<span class=\"text-info mx-1\">{{files.length}}</span>\u4E2A\u6587\u4EF6</span>\r\n   <button type=\"button\" class=\"btn btn-link\" *ngIf=\"!uploadImmediately\">\u4E0A\u4F20\u6240\u6709</button>\r\n</div> -->\r\n    <ul class=\"ffileupload--list\" *ngIf=\"!uploadImmediately\">\r\n        <ng-container *ngFor=\"let fileItem of files\">\r\n            <!-- <ng-container *ngIf=\"!uploadImmediately||fileItem.type!='done'\"> -->\r\n            <li class=\"ffileupload--item\" [@hideUploaded]=\"uploadImmediately&&fileItem.type=='done'?'hide':''\">\r\n                <fieldset class=\"ffileupload--file-wrapper\">\r\n                    <legend>{{fileItem['file'].id}}</legend>\r\n                    <input type=\"hidden\" name=\"ffileupload\" [value]=\"fileItem['file'].nativeFile.name\" />\r\n                    <div class=\"ffileupload--file\"\r\n                        [ngClass]=\"isImage(fileItem['file'].type)?'ffileupload--file-imgpreview':'ffileupload--file-panel'\">\r\n                        <div class=\"ffileupload--action\">\r\n                            <div class=\"ffileupload--action-basic\">\r\n                                <div class=\"action-basic--info\">\r\n                                    <div class=\"action-basic--info-title\" [title]=\"fileItem['file'].nativeFile.name\">{{fileItem['file'].nativeFile.name}}</div>\r\n                                    <div class=\"action-basic--info-byte\">{{formateBytes(fileItem['file'].size)}}</div>\r\n                                </div>\r\n                                <ng-container [ngSwitch]=\"fileItem.type\">\r\n                                    <ng-container *ngSwitchCase=\"'done'\">\r\n                                        <div class=\"action-basic--state\">\r\n                                            <span>{{ 'upload.hasUploaded' | upLocale }}</span>\r\n                                        </div>\r\n                                        <div class=\"action-basic--action\">\r\n                                            <span class=\"action-basic--action-btn action-btn--done\" [title]=\"'upload.hasUploaded' | upLocale\"><i\r\n                                                    class=\"f-icon f-icon-checkmark\"></i></span>\r\n                                            <span class=\"action-basic--action-btn\" [title]=\"'upload.delText' | upLocale\"\r\n                                                (click)=\"removeFile(fileItem['file'].id)\"><i\r\n                                                    class=\"f-icon f-icon-enclosure_delete\"></i></span>\r\n                                        </div>\r\n                                    </ng-container>\r\n                                    <ng-container *ngSwitchCase=\"'start'\">\r\n                                        <div class=\"action-basic--state\">\r\n                                            <span>{{ 'upload.uploading' | upLocale }}</span>\r\n                                        </div>\r\n                                        <div class=\"action-basic--action\">\r\n                                            <span class=\"action-basic--action-btn uploadpreview-btn--primary\"><i\r\n                                                    class=\"ffile-spin f-icon f-icon-refresh\"></i></span>\r\n                                        </div>\r\n                                    </ng-container>\r\n                                    <ng-container *ngSwitchDefault>\r\n                                        <div class=\"action-basic--state\">\r\n                                            <span>{{ 'upload.waitUpload' | upLocale }}</span>\r\n                                        </div>\r\n                                        <div class=\"action-basic--action\">\r\n                                            <span class=\"action-basic--action-btn uploadpreview-btn--primary\" [title]=\"'upload.upload' | upLocale\"\r\n                                                (click)=\"startUpload(fileItem['file'])\"><i\r\n                                                    class=\"f-icon f-icon-enclosure_upload\"></i></span>\r\n                                            <span class=\"action-basic--action-btn\"  [title]=\"'upload.remove' | upLocale\"\r\n                                                (click)=\"cancelUpload(fileItem['file'].id)\"><i\r\n                                                    class=\"f-icon f-icon-enclosure_delete\"></i></span>\r\n                                        </div>\r\n                                    </ng-container>\r\n                                </ng-container>\r\n                            </div>\r\n                        </div>\r\n                        <ng-container *ngIf=\"enableImagePreview&&isImage(fileItem['file'].type)\">\r\n                            <f-file-view-image [file]=\"fileItem['file'].nativeFile\"></f-file-view-image>\r\n                        </ng-container>\r\n                    </div>\r\n                </fieldset>\r\n            </li>\r\n            <!-- </ng-container> -->\r\n        </ng-container>\r\n    </ul>\r\n    <div class=\"ffile-load-wrapper\" *ngIf=\"showLoading\">\r\n        <div class=\"loader\"></div>\r\n    </div>\r\n</ng-container>\r\n<ng-template #afterSelectHeader>\r\n    <div class=\"action-wrapper--is-upload\">\r\n        <div class=\"action-wrapper--header-title\"><span class=\"common-action--info\">{{ 'upload.waitUpload' | upLocale }}<span\r\n                    class=\"mx-1\">{{files.length}}</span>{{ 'upload.numFile' | upLocale }}</span></div>\r\n        <div class=\"action-wrapper--header-right\">\r\n            <button type=\"button\" class=\"btn btn-secondary btn-icontext\" (click)=\"appendNewFiles($event)\">\r\n                <span class=\"f-icon f-icon-add\"></span>{{ 'upload.upload' | upLocale }}\r\n            </button>\r\n        </div>\r\n        <div class=\"action-wrapper--header-left\">\r\n            <button type=\"button\" class=\"btn btn-primary  mr-2\" (click)=\"startUploadAll()\">{{ 'upload.mutilUpload' | upLocale }}</button>\r\n            <button type=\"button\" class=\"btn btn-secondary\" (click)=\"removelAllUpload()\">{{ 'upload.cancelUpload' | upLocale }}</button>\r\n        </div>\r\n    </div>\r\n</ng-template>\r\n<ng-template #beforeUploadSupportInfo>\r\n    <div class=\"ffileupload--support-info\">\r\n        <ul class=\"support-info--wrapper\">\r\n            <li *ngIf=\"judgeContentTypeLimit()\">\r\n                <span>{{'uploadAndPreview.supportType' | upLocale }}\uFF1A</span>\r\n                <span class=\"support-info--item-detail\">{{allowedContentTypes}}</span>\r\n            </li>\r\n            <li *ngIf=\"judegeFileSizeLimit()\">\r\n                <span>{{'uploadAndPreview.maxSize' | upLocale }}\uFF1A</span>\r\n                <span class=\"support-info--item-detail\">{{maxFileSize}}</span>\r\n            </li>\r\n            <li *ngIf=\"maxUploads>0\">\r\n                <span>{{'uploadAndPreview.maxFileCount' | upLocale }}\uFF1A</span>\r\n                <span class=\"support-info--item-detail\">{{'uploadAndPreview.maxCountShow' | upLocale}}</span>\r\n            </li>\r\n        </ul>\r\n    </div>\r\n</ng-template>",
                providers: [FFileUploaderService],
                animations: [
                    trigger("hideUploaded", [
                        state("show", style({ opacity: 1, height: "*" })),
                        state("hide", style({ opacity: 0, height: 0 })),
                        // transition('* => void', [
                        //   style({ opacity: 1}),
                        //   animate(200, style({ opacity: 0}))
                        // ])
                        transition("* => hide", animate("0.5s")),
                    ]),
                ],
                styles: [":host{position:relative;display:block;padding:10px;background:#fafcfd;max-width:100%;max-height:100%;outline:0;border:1px dashed #d8dfed;border-radius:3px;font-size:13px;-webkit-transition:height .2s linear;transition:height .2s linear}:host.ffileupload-unvisible{display:none!important}:host.ffileupload-selfdefine{background:0 0;border:none;padding:0}.ffileupload--browser{position:absolute;margin:0;padding:0;left:1em;top:-9000px;width:calc(100% - 2em);opacity:0;font-size:0}:host.ffileupload-default{width:435px}:host.ffileupload-uploading{width:654px}.ffileupload--assist{width:100%;height:0;opacity:0}.drop-wrapper--drop-area{text-align:center;padding:10px 0 0}.drop-wrapper--action{padding:10px 16px 6px;display:-webkit-box;display:flex;-webkit-box-align:center;align-items:center;color:#6a6f79;-webkit-box-pack:center;justify-content:center}.drop-wrapper--drop-area .ffileupload--support-info{padding-top:0}.drop-wrapper--action-label{margin:0}.drop-wrapper--action-select{color:#1e5fb3;margin:0;padding:0 4px;box-shadow:none;outline:0;background:0 0;border:none}.ffileupload--action{cursor:pointer}.drop-wrapper--header{margin-bottom:.5rem!important}.drop-wrapper--append{position:absolute;top:0;left:0;right:0;z-index:100;height:0;background:rgba(250,250,250,.9);border-radius:1rem;overflow:hidden;-webkit-transition:height .2s linear;transition:height .2s linear}.drop-wrapper--append-show{padding:10px;height:210px}.action-wrapper--before-upload{padding:.5rem;text-align:center}.ffileupload--action-wrapper .btn-upload-icon,.ffileupload--drop-wrapper .btn-upload-icon{border:none;outline:0;box-shadow:none;color:#ccd5e1;background:0 0;margin:0 auto .5rem 0;cursor:pointer;padding:0}.ffileupload--action-wrapper .btn-upload-icon:disabled,.ffileupload--drop-wrapper .btn-upload-icon:disabled{cursor:default;opacity:.4}.ffileupload--action-wrapper .btn-upload-icon:hover,.ffileupload--drop-wrapper .btn-upload-icon:hover{color:#1e5fb3}.ffileupload--action-wrapper .btn-upload-icon:disabled:hover,.ffileupload--drop-wrapper .btn-upload-icon:disabled:hover{color:#ccd5e1}.btn-upload-icon .f-icon{font-size:36px;height:36px}.action-wrapper--is-upload{padding:4px 10px 16px;text-align:center;font-size:14px;margin:0 -10px;clear:both;overflow:hidden;position:relative}.action-wrapper--header-title{float:left}.action-wrapper--header-right{text-align:right;float:right;position:relative;z-index:100}.action-wrapper--header-left{float:left;position:relative;z-index:100}.ffileupload--item{margin:0 .625rem .625rem 0;list-style:none;width:100%;max-width:308px}.ffileupload--support-info{padding:0 .5rem .5rem;line-height:1.6;color:#b4bccc;text-align:center}.support-info--wrapper{padding:0;margin:0 auto}.support-info--wrapper li{padding:0;margin:0 4px 0 0;list-style:none;display:inline-block;word-break:break-all}.ffileupload--file-wrapper{border:none;margin:0;padding:0;min-width:0;height:100%;-webkit-transition:opacity .15s ease-out;transition:opacity .15s ease-out;position:relative}.ffileupload--file-wrapper>legend{position:absolute;overflow:hidden;height:1px;width:1px;padding:0;border:0;clip:rect(1px,1px,1px,1px);-webkit-clip-path:inset(50%);clip-path:inset(50%);white-space:nowrap}.ffileupload--file{position:static;display:-webkit-box;display:flex;-webkit-box-align:start;align-items:flex-start;color:#2d2f33;border-radius:3px;overflow:hidden;background:#fff;border:1px solid #e5e8ed;box-shadow:0 2px 4px 0 rgba(220,227,237,.53);max-height:200px;height:100%;box-sizing:content-box}.f-file-view-image{display:-webkit-box;display:flex;-webkit-box-align:center;align-items:center;height:100%;width:100%;pointer-events:none;will-change:transform,opacity;border-radius:1rem;min-height:6rem}.ffileupload--action-basic{display:-webkit-box;display:flex;padding:6px 10px;-webkit-box-align:center;align-items:center;min-height:66px}.ffileupload--list{display:-webkit-box;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;flex-direction:row;flex-wrap:wrap;margin-right:-.625rem}.action-basic--info{-webkit-box-flex:1;flex:1 1 auto;white-space:nowrap;overflow:hidden}.action-basic--state{background:#e6f8f9;position:absolute;right:0;top:0;font-size:12px;color:#62c8ca;height:28px;min-width:56px;border-radius:0 0 0 50px/0 0 0 28px;text-align:right;line-height:24px;padding:0 6px 0 0}.action-basic--info-title{margin:0 0 4px;text-overflow:ellipsis;overflow:hidden}.action-basic--info-byte{color:rgba(45,47,51,.45)}.action-basic--action-btn{text-align:center;background:#c7d4ee;height:18px;width:18px;border-radius:9px;display:inline-block;line-height:18px;-webkit-transition:box-shadow .25s ease-in;transition:box-shadow .25s ease-in}.action-basic--action-btn:hover{box-shadow:0 0 0 .125em rgba(43,135,255,.2);background:#2b87ff}.action-btn--done{background:#51bd78!important;color:#fff}.action-basic--action-btn .f-icon{color:#fff;font-size:12px}.ffileupload--file-panel .ffileupload--action{width:100%}.action-basic--action{position:absolute;right:12px;bottom:14px}.action-basic--action-btn+.action-basic--action-btn{margin-left:12px}.ffileupload--common-action{border-top:1px solid #eaeaea;text-align:center;font-size:14px;margin:0 -10px;padding:4px}.common-action--info{margin:0 16px 0 0;display:inline-block}.common-action--info span{font-size:17px;font-weight:600}.ffileupload--file-imgpreview .ffileupload--action-basic{width:100%;height:100%;position:absolute;z-index:80;background:rgba(255,255,255,.8)}.ffile-spin{-webkit-animation:2s linear infinite fa-spin;animation:2s linear infinite ffile-spin}@-webkit-keyframes ffile-spin{0%{-webkit-transform:rotate(0);transform:rotate(0)}100%{-webkit-transform:rotate(359deg);transform:rotate(359deg)}}@keyframes ffile-spin{0%{-webkit-transform:rotate(0);transform:rotate(0)}100%{-webkit-transform:rotate(359deg);transform:rotate(359deg)}}.ffile-load-wrapper{position:absolute;top:0;left:0;right:0;bottom:0;display:-webkit-box;display:flex;-webkit-box-align:center;align-items:center;background:rgba(255,255,255,.4)}.ffile-load-wrapper .loader,.ffile-load-wrapper .loader:after,.ffile-load-wrapper .loader:before{background:#2a87ff;-webkit-animation:1s ease-in-out infinite ffile-load-spin;animation:1s ease-in-out infinite ffile-load-spin;width:2px;height:6px}.ffile-load-wrapper .loader{color:#2a87ff;text-indent:-200em;margin:0 auto;position:relative;font-size:12px;-webkit-transform:translateZ(0);transform:translateZ(0);-webkit-animation-delay:-.16s;animation-delay:-.16s}.ffile-load-wrapper .loader:after,.ffile-load-wrapper .loader:before{position:absolute;top:0;content:''}.ffile-load-wrapper .loader:before{left:-6px;-webkit-animation-delay:-.32s;animation-delay:-.32s}.ffile-load-wrapper .loader:after{left:6px}.ffileupload-default-size{width:432px}@-webkit-keyframes ffile-load-spin{0%,100%,80%{box-shadow:0 0;height:10px}40%{box-shadow:0 -6px;height:18px}}@keyframes ffile-load-spin{0%,100%,80%{box-shadow:0 0;height:10px}40%{box-shadow:0 -6px;height:18px}}"]
            }] }
];
/** @nocollapse */
FFileUploadComponent.ctorParameters = () => [
    { type: FFileUploadAPIService },
    { type: FFileUploaderService },
    { type: NotifyService },
    { type: NgZone }
];
FFileUploadComponent.propDecorators = {
    cls: [{ type: HostBinding, args: ["class.ffileupload",] }],
    visibleState: [{ type: HostBinding, args: ["class.ffileupload-unvisible",] }],
    selfDirectiveDefine: [{ type: HostBinding, args: ["class.ffileupload-selfdefine",] }],
    uploading: [{ type: HostBinding, args: ["class.ffileupload-uploading",] }],
    fFileUploadAssist: [{ type: ViewChild, args: ["uploadAssist",] }],
    fFileUploadDir: [{ type: ContentChild, args: [FFileUploadDirective,] }],
    fileUpload: [{ type: ViewChild, args: [FFileSelectDirective,] }],
    fileDropUpload: [{ type: ViewChild, args: [FFileDropDirective,] }],
    enableImagePreview: [{ type: Input }],
    uploadImmediately: [{ type: Input }],
    uploadedThenHide: [{ type: Input }],
    disabled: [{ type: Input }],
    enableSliceUpload: [{ type: Input }],
    chunkSize: [{ type: Input }],
    visible: [{ type: Input }],
    needReset: [{ type: Input }],
    enableDrop: [{ type: Input }],
    dropText: [{ type: Input }],
    enableSelect: [{ type: Input }],
    selectText: [{ type: Input }],
    multiple: [{ type: Input }],
    uploadedCount: [{ type: Input }],
    extendDatas: [{ type: Input }],
    widthThreshold: [{ type: Input }],
    fUploadDoneEvent: [{ type: Output }],
    fUploadRemovedEvent: [{ type: Output }],
    options: [{ type: Input }],
    extendServerConfig: [{ type: Input }]
};
if (false) {
    /** @type {?} */
    FFileUploadComponent.prototype.cls;
    /** @type {?} */
    FFileUploadComponent.prototype.fFileUploadAssist;
    /** @type {?} */
    FFileUploadComponent.prototype.fFileUploadDir;
    /** @type {?} */
    FFileUploadComponent.prototype.fileUpload;
    /** @type {?} */
    FFileUploadComponent.prototype.fileDropUpload;
    /** @type {?} */
    FFileUploadComponent.prototype.enableImagePreview;
    /** @type {?} */
    FFileUploadComponent.prototype.uploadImmediately;
    /** @type {?} */
    FFileUploadComponent.prototype.uploadedThenHide;
    /** @type {?} */
    FFileUploadComponent.prototype.disabled;
    /**
     * 启用分块上传
     * @type {?}
     */
    FFileUploadComponent.prototype.enableSliceUpload;
    /**
     * 分块上传每片大小，单位：M, 默认 1M/块
     * @type {?}
     */
    FFileUploadComponent.prototype.chunkSize;
    /**
     * @type {?}
     * @private
     */
    FFileUploadComponent.prototype.tVisible;
    /** @type {?} */
    FFileUploadComponent.prototype.needReset;
    /** @type {?} */
    FFileUploadComponent.prototype.enableDrop;
    /** @type {?} */
    FFileUploadComponent.prototype.dropText;
    /** @type {?} */
    FFileUploadComponent.prototype.enableSelect;
    /** @type {?} */
    FFileUploadComponent.prototype.selectText;
    /** @type {?} */
    FFileUploadComponent.prototype.multiple;
    /** @type {?} */
    FFileUploadComponent.prototype.uploadedCount;
    /** @type {?} */
    FFileUploadComponent.prototype.extendDatas;
    /** @type {?} */
    FFileUploadComponent.prototype.widthThreshold;
    /** @type {?} */
    FFileUploadComponent.prototype.fUploadDoneEvent;
    /** @type {?} */
    FFileUploadComponent.prototype.fUploadRemovedEvent;
    /** @type {?} */
    FFileUploadComponent.prototype.allowedContentTypes;
    /** @type {?} */
    FFileUploadComponent.prototype.maxUploads;
    /** @type {?} */
    FFileUploadComponent.prototype.maxFileSize;
    /**
     * @type {?}
     * @private
     */
    FFileUploadComponent.prototype.selfUploadOpts;
    /** @type {?} */
    FFileUploadComponent.prototype.files;
    /** @type {?} */
    FFileUploadComponent.prototype.uploadSelectInput;
    /** @type {?} */
    FFileUploadComponent.prototype.uploadDragInput;
    /** @type {?} */
    FFileUploadComponent.prototype.showAppendPanel;
    /** @type {?} */
    FFileUploadComponent.prototype.showLoading;
    /** @type {?} */
    FFileUploadComponent.prototype.settings;
    /** @type {?} */
    FFileUploadComponent.prototype.localInfo;
    /**
     * @type {?}
     * @private
     */
    FFileUploadComponent.prototype.uploadAPISer;
    /**
     * @type {?}
     * @private
     */
    FFileUploadComponent.prototype.fileUploaderSer;
    /**
     * @type {?}
     * @private
     */
    FFileUploadComponent.prototype.notifyService;
    /**
     * @type {?}
     * @private
     */
    FFileUploadComponent.prototype.ngZone;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZi1maWxlLXVwbG9hZC5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZmFycmlzL2V4dGVuZC1maWxlLXVwbG9hZC8iLCJzb3VyY2VzIjpbImxpYi9jb21wb25lbnRzL3VwbG9hZC9mLWZpbGUtdXBsb2FkLmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7OztBQUFBLE9BQU8sRUFDSCxTQUFTLEVBRVQsS0FBSyxFQUNMLFdBQVcsRUFDWCxTQUFTLEVBQ1QsWUFBWSxFQUNaLE1BQU0sRUFDTixZQUFZLEVBQ1osVUFBVSxHQUViLE1BQU0sZUFBZSxDQUFDO0FBQ3ZCLE9BQU8sRUFDSCxvQkFBb0IsRUFDcEIsa0JBQWtCLEVBQ2xCLG9CQUFvQixHQUN2QixNQUFNLHVCQUF1QixDQUFDO0FBUy9CLE9BQU8sRUFBRSxVQUFVLEVBQUUsTUFBTSxtQkFBbUIsQ0FBQztBQUMvQyxPQUFPLEVBQ0gscUJBQXFCLEVBQ3JCLG9CQUFvQixHQUN2QixNQUFNLHFCQUFxQixDQUFDO0FBQzdCLE9BQU8sRUFBRSxhQUFhLEVBQWlCLE1BQU0sbUJBQW1CLENBQUM7QUFDakUsT0FBTyxFQUFFLFVBQVUsRUFBRSxPQUFPLEVBQUUsTUFBTSxNQUFNLENBQUM7QUFFM0MsT0FBTyxFQUFFLE9BQU8sRUFBQyxLQUFLLEVBQUMsS0FBSyxFQUFDLE9BQU8sRUFBQyxVQUFVLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQztBQUM3RSxPQUFPLEVBQUUsTUFBTSxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBb0J2QyxNQUFNLE9BQU8sb0JBQW9COzs7Ozs7O0lBaUk3QixZQUNZLFlBQW1DLEVBQ25DLGVBQXFDLEVBQ3JDLGFBQTRCLEVBQzVCLE1BQWM7UUFIZCxpQkFBWSxHQUFaLFlBQVksQ0FBdUI7UUFDbkMsb0JBQWUsR0FBZixlQUFlLENBQXNCO1FBQ3JDLGtCQUFhLEdBQWIsYUFBYSxDQUFlO1FBQzVCLFdBQU0sR0FBTixNQUFNLENBQVE7UUFwSVEsUUFBRyxHQUFHLElB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Q0FFTCxLQUFLO3dCQUVMLEtBQUs7c0JBSUwsS0FBSzt3QkFXTCxLQUFLO3lCQUVMLEtBQUs7dUJBQ0wsS0FBSzsyQkFFTCxLQUFLO3lCQUNMLEtBQUs7dUJBRUwsS0FBSzs0QkFFTCxLQUFLOzBCQUVMLEtBQUs7NkJBS0wsS0FBSzsrQkFFTCxNQUFNO2tDQUNOLE1BQU07c0JBV04sS0FBSztpQ0F5QkwsS0FBSzs7OztJQXpHTixtQ0FBNkM7O0lBaUI3QyxpREFBeUQ7O0lBRXpELDhDQUF3RDs7SUFFeEQsMENBQWtFOztJQUNsRSw4Q0FBa0U7O0lBRWxFLGtEQUFtQzs7SUFFbkMsaURBQW1DOztJQUVuQyxnREFBaUM7O0lBRWpDLHdDQUEwQjs7Ozs7SUFFMUIsaURBQWtDOzs7OztJQUVsQyx5Q0FBdUI7Ozs7O0lBRXZCLHdDQUF3Qjs7SUFheEIseUNBQW9EOztJQUVwRCwwQ0FBNEI7O0lBQzVCLHdDQUErQjs7SUFFL0IsNENBQTZCOztJQUM3QiwwQ0FBNkI7O0lBRTdCLHdDQUF5Qjs7SUFFekIsNkNBQTJCOztJQUUzQiwyQ0FHRTs7SUFFRiw4Q0FBOEI7O0lBRTlCLGdEQUFxRTs7SUFDckUsbURBQXdFOztJQUd4RSxtREFBMEI7O0lBRTFCLDBDQUFlOztJQUVmLDJDQUFxQjs7Ozs7SUFFckIsOENBQTZDOztJQWtDN0MscUNBQXNCOztJQUV0QixpREFBNkM7O0lBRTdDLCtDQUEyQzs7SUFFM0MsK0NBQXdCOztJQUV4QiwyQ0FBb0I7O0lBRXBCLHdDQUdFOztJQUVGLHlDQUFTOzs7OztJQUVMLDRDQUEyQzs7Ozs7SUFDM0MsK0NBQTZDOzs7OztJQUM3Qyw2Q0FBb0M7Ozs7O0lBQ3BDLHNDQUFzQiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XHJcbiAgICBDb21wb25lbnQsXHJcbiAgICBPbkluaXQsXHJcbiAgICBJbnB1dCxcclxuICAgIEhvc3RCaW5kaW5nLFxyXG4gICAgVmlld0NoaWxkLFxyXG4gICAgRXZlbnRFbWl0dGVyLFxyXG4gICAgT3V0cHV0LFxyXG4gICAgQ29udGVudENoaWxkLFxyXG4gICAgRWxlbWVudFJlZixcclxuICAgIEFmdGVyVmlld0luaXQsXHJcbn0gZnJvbSBcIkBhbmd1bGFyL2NvcmVcIjtcclxuaW1wb3J0IHtcclxuICAgIEZGaWxlU2VsZWN0RGlyZWN0aXZlLFxyXG4gICAgRkZpbGVEcm9wRGlyZWN0aXZlLFxyXG4gICAgRkZpbGVVcGxvYWREaXJlY3RpdmUsXHJcbn0gZnJvbSBcIi4uLy4uL2RpcmVjdGl2ZS9pbmRleFwiO1xyXG5pbXBvcnQge1xyXG4gICAgVXBsb2FkT3V0cHV0LFxyXG4gICAgVXBsb2FkSW5wdXQsXHJcbiAgICBVcGxvYWRGaWxlLFxyXG4gICAgVXBsb2FkZXJPcHRpb25zLFxyXG4gICAgRlVwbG9hZEZpbGVFeHRlbmQsXHJcbiAgICBEb2NNZXRhUHJvcGVydHksXHJcbn0gZnJvbSBcIi4uLy4uL21vZGVsL2luZGV4XCI7XHJcbmltcG9ydCB7IEZGaWxlVXRpbHMgfSBmcm9tIFwiLi4vLi4vdXRpbHMvaW5kZXhcIjtcclxuaW1wb3J0IHtcclxuICAgIEZGaWxlVXBsb2FkQVBJU2VydmljZSxcclxuICAgIEZGaWxlVXBsb2FkZXJTZXJ2aWNlLFxyXG59IGZyb20gXCIuLi8uLi9zZXJ2aWNlL2luZGV4XCI7XHJcbmltcG9ydCB7IE5vdGlmeVNlcnZpY2UsIE5vdGlmeU9wdGlvbnMgfSBmcm9tIFwiQGZhcnJpcy91aS1ub3RpZnlcIjtcclxuaW1wb3J0IHsgT2JzZXJ2YWJsZSwgU3ViamVjdCB9IGZyb20gXCJyeGpzXCI7XHJcblxyXG5pbXBvcnQgeyB0cmlnZ2VyLHN0eWxlLHN0YXRlLGFuaW1hdGUsdHJhbnNpdGlvbiB9IGZyb20gXCJAYW5ndWxhci9hbmltYXRpb25zXCI7XHJcbmltcG9ydCB7IE5nWm9uZSB9IGZyb20gXCJAYW5ndWxhci9jb3JlXCI7XHJcbmltcG9ydCB7IExvY2FsZVNlcnZpY2UgfSBmcm9tIFwiQGZhcnJpcy91aS1sb2NhbGVcIjtcclxuXHJcbkBDb21wb25lbnQoe1xyXG4gICAgc2VsZWN0b3I6IFwiZi1maWxlLXVwbG9hZFwiLFxyXG4gICAgdGVtcGxhdGVVcmw6IFwiLi9mLWZpbGUtdXBsb2FkLmNvbXBvbmVudC5odG1sXCIsXHJcbiAgICBzdHlsZVVybHM6IFtcIi4vZi1maWxlLXVwbG9hZC5jb21wb25lbnQuY3NzXCJdLFxyXG4gICAgcHJvdmlkZXJzOiBbRkZpbGVVcGxvYWRlclNlcnZpY2VdLFxyXG4gICAgYW5pbWF0aW9uczogW1xyXG4gICAgICAgIHRyaWdnZXIoXCJoaWRlVXBsb2FkZWRcIiwgW1xyXG4gICAgICAgICAgICBzdGF0ZShcInNob3dcIiwgc3R5bGUoeyBvcGFjaXR5OiAxLCBoZWlnaHQ6IFwiKlwiIH0pKSxcclxuICAgICAgICAgICAgc3RhdGUoXCJoaWRlXCIsIHN0eWxlKHsgb3BhY2l0eTogMCwgaGVpZ2h0OiAwIH0pKSxcclxuICAgICAgICAgICAgLy8gdHJhbnNpdGlvbignKiA9PiB2b2lkJywgW1xyXG4gICAgICAgICAgICAvLyAgIHN0eWxlKHsgb3BhY2l0eTogMX0pLFxyXG4gICAgICAgICAgICAvLyAgIGFuaW1hdGUoMjAwLCBzdHlsZSh7IG9wYWNpdHk6IDB9KSlcclxuICAgICAgICAgICAgLy8gXSlcclxuICAgICAgICAgICAgdHJhbnNpdGlvbihcIiogPT4gaGlkZVwiLCBhbmltYXRlKFwiMC41c1wiKSksXHJcbiAgICAgICAgXSksXHJcbiAgICBdLFxyXG59KVxyXG5leHBvcnQgY2xhc3MgRkZpbGVVcGxvYWRDb21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQsIEFmdGVyVmlld0luaXQge1xyXG4gICAgQEhvc3RCaW5kaW5nKFwiY2xhc3MuZmZpbGV1cGxvYWRcIikgY2xzID0gdHJ1ZTtcclxuICAgIC8vIOS4jeWPr+ingVxyXG4gICAgQEhvc3RCaW5kaW5nKFwiY2xhc3MuZmZpbGV1cGxvYWQtdW52aXNpYmxlXCIpIGdldCB2aXNpYmxlU3RhdGUoKSB7XHJcbiAgICAgICAgcmV0dXJuICF0aGlzLnZpc2libGU7XHJcbiAgICB9XHJcbiAgICAvLyDoh6rlrprkuYnmoLflvI9cclxuICAgIEBIb3N0QmluZGluZyhcImNsYXNzLmZmaWxldXBsb2FkLXNlbGZkZWZpbmVcIikgZ2V0IHNlbGZEaXJlY3RpdmVEZWZpbmUoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuZkZpbGVVcGxvYWREaXIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuICAgIEBIb3N0QmluZGluZyhcImNsYXNzLmZmaWxldXBsb2FkLXVwbG9hZGluZ1wiKSBnZXQgdXBsb2FkaW5nKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmZpbGVzLmxlbmd0aCA+IDA7XHJcbiAgICB9XHJcblxyXG4gICAgLy8g5LiN6IO95ZyoQ29uc3RydWN06YeM6L+95YqgZWxcclxuICAgIEBWaWV3Q2hpbGQoXCJ1cGxvYWRBc3Npc3RcIikgZkZpbGVVcGxvYWRBc3Npc3Q6IEVsZW1lbnRSZWY7XHJcbiAgICAvLyDoh6rlrprkuYnmjIfku6RcclxuICAgIEBDb250ZW50Q2hpbGQoRkZpbGVVcGxvYWREaXJlY3RpdmUpIGZGaWxlVXBsb2FkRGlyOiBhbnk7XHJcbiAgICAvL1xyXG4gICAgQFZpZXdDaGlsZChGRmlsZVNlbGVjdERpcmVjdGl2ZSkgZmlsZVVwbG9hZDogRkZpbGVTZWxlY3REaXJlY3RpdmU7XHJcbiAgICBAVmlld0NoaWxkKEZGaWxlRHJvcERpcmVjdGl2ZSkgZmlsZURyb3BVcGxvYWQ6IEZGaWxlRHJvcERpcmVjdGl2ZTtcclxuICAgIC8vIOWQr+eUqOWbvueJh+mihOiniFxyXG4gICAgQElucHV0KCkgZW5hYmxlSW1hZ2VQcmV2aWV3ID0gdHJ1ZTtcclxuICAgIC8vIOWQr+eUqOeri+WNs+S4iuS8oFxyXG4gICAgQElucHV0KCkgdXBsb2FkSW1tZWRpYXRlbHkgPSBmYWxzZTtcclxuICAgIC8vIOS4iuS8oOWujOaIkOWQjumakOiXj1xyXG4gICAgQElucHV0KCkgdXBsb2FkZWRUaGVuSGlkZSA9IHRydWU7XHJcbiAgICAvLyDnpoHnlKjnirbmgIFcclxuICAgIEBJbnB1dCgpIGRpc2FibGVkID0gZmFsc2U7XHJcbiAgICAvKiog5ZCv55So5YiG5Z2X5LiK5LygICovXHJcbiAgICBASW5wdXQoKSBlbmFibGVTbGljZVVwbG9hZCA9IHRydWU7XHJcbiAgICAvKiog5YiG5Z2X5LiK5Lyg5q+P54mH5aSn5bCP77yM5Y2V5L2N77yaTSwg6buY6K6kIDFNL+WdlyAqL1xyXG4gICAgQElucHV0KCkgY2h1bmtTaXplID0gMTtcclxuXHJcbiAgICBwcml2YXRlIHRWaXNpYmxlID0gdHJ1ZTtcclxuICAgIC8vIOaYr+WQpuWPr+ingVxyXG4gICAgQElucHV0KClcclxuICAgIHNldCB2aXNpYmxlKHZhbHVlKSB7XHJcbiAgICAgICAgdGhpcy50VmlzaWJsZSA9IHZhbHVlO1xyXG4gICAgICAgIGlmICghdmFsdWUpIHtcclxuICAgICAgICAgICAgdGhpcy5yZXNldCgpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGdldCB2aXNpYmxlKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnRWaXNpYmxlO1xyXG4gICAgfVxyXG4gICAgLy8g6ZyA6KaB6YeN572uLOmAmui/h+S4jeaWreeahOi1i+WAvOadpeaUueWPmFxyXG4gICAgQElucHV0KCkgbmVlZFJlc2V0OiBPYnNlcnZhYmxlPGFueT4gPSBuZXcgU3ViamVjdCgpO1xyXG4gICAgLy8g5ZCv55So5ouW5ou9XHJcbiAgICBASW5wdXQoKSBlbmFibGVEcm9wID0gZmFsc2U7XHJcbiAgICBASW5wdXQoKSBkcm9wVGV4dCA9IFwi5Y+v5bCG5paH5Lu25ouW5ou95q2k5aSEXCI7XHJcbiAgICAvLyDlkK/nlKjpgInmi6nmlofku7bmjInpkq5cclxuICAgIEBJbnB1dCgpIGVuYWJsZVNlbGVjdCA9IHRydWU7XHJcbiAgICBASW5wdXQoKSBzZWxlY3RUZXh0ID0gXCLngrnlh7vkuIrkvKBcIjtcclxuICAgIC8vIOWQr+eUqOWkmumAiVxyXG4gICAgQElucHV0KCkgbXVsdGlwbGUgPSB0cnVlO1xyXG4gICAgLy8g5bey57uP5LiK5Lyg5paH5Lu2XHJcbiAgICBASW5wdXQoKSB1cGxvYWRlZENvdW50ID0gMDtcclxuICAgIC8vIOWFrOWFseeahOaJqeWxleaVsOaNrlxyXG4gICAgQElucHV0KCkgZXh0ZW5kRGF0YXM6IHtcclxuICAgICAgICBba2V5OiBzdHJpbmddOiBhbnk7XHJcbiAgICAgICAgZXh0UHJvcGVydHk/OiBEb2NNZXRhUHJvcGVydHkgfCBudWxsOyAvL1xyXG4gICAgfTtcclxuICAgIC8vIOWuveW6pumYiOWAvO+8jOW9k+WuveW6pui2hei/hzc2MOaXtuWAme+8jOayoeaciemZhOS7tuS4iuS8oOaXtu+8jOWuveW6puaYr+WbuuWumuWAvO+8jOaciemZhOS7tuS4iuS8oOaXtu+8jOacieacgOWkp+WuveW6puWAvFxyXG4gICAgQElucHV0KCkgd2lkdGhUaHJlc2hvbGQgPSA3NjA7XHJcbiAgICAvLyDkuIrkvKDlkozliKDpmaTlr7nlpJbmipvlh7rnmoTkuovku7ZcclxuICAgIEBPdXRwdXQoKSBmVXBsb2FkRG9uZUV2ZW50ID0gbmV3IEV2ZW50RW1pdHRlcjxGVXBsb2FkRmlsZUV4dGVuZFtdPigpO1xyXG4gICAgQE91dHB1dCgpIGZVcGxvYWRSZW1vdmVkRXZlbnQgPSBuZXcgRXZlbnRFbWl0dGVyPEZVcGxvYWRGaWxlRXh0ZW5kW10+KCk7XHJcblxyXG4gICAgLy8g5YWB6K645LiK5Lyg55qE5paH5Lu257G75Z6LXHJcbiAgICBhbGxvd2VkQ29udGVudFR5cGVzID0gXCIqXCI7XHJcbiAgICAvLyDpu5jorqTkuI3pmZDliLbpmYTku7bkuIrkvKDkuKrmlbBcclxuICAgIG1heFVwbG9hZHMgPSAwO1xyXG4gICAgLy8g5Y2V5L2NS0LvvIzpu5jorqTmmK8xMk1cclxuICAgIG1heEZpbGVTaXplID0gXCIxMk1CXCI7XHJcblxyXG4gICAgcHJpdmF0ZSBzZWxmVXBsb2FkT3B0czogVXBsb2FkZXJPcHRpb25zID0ge307XHJcbiAgICAvLyDkuIrkvKDphY3nva7poblcclxuICAgIEBJbnB1dCgpXHJcbiAgICBzZXQgb3B0aW9ucyh1cGxvYWRPcHRzOiBVcGxvYWRlck9wdGlvbnMpIHtcclxuICAgICAgICBpZiAodXBsb2FkT3B0cykge1xyXG4gICAgICAgICAgICBpZiAodXBsb2FkT3B0cy5oYXNPd25Qcm9wZXJ0eShcImFsbG93ZWRDb250ZW50VHlwZXNcIikpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuYWxsb3dlZENvbnRlbnRUeXBlcyA9IHVwbG9hZE9wdHMuYWxsb3dlZENvbnRlbnRUeXBlcy5qb2luKFwiLFwiKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuYWxsb3dlZENvbnRlbnRUeXBlcyA9XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5hbGxvd2VkQ29udGVudFR5cGVzID09IFwiXCIgPyBcIipcIiA6IHRoaXMuYWxsb3dlZENvbnRlbnRUeXBlcztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAodXBsb2FkT3B0cy5oYXNPd25Qcm9wZXJ0eShcIm1heFVwbG9hZHNcIikpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMubWF4VXBsb2FkcyA9IHVwbG9hZE9wdHMubWF4VXBsb2FkcztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAodXBsb2FkT3B0cy5oYXNPd25Qcm9wZXJ0eShcIm1heEZpbGVTaXplXCIpKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm1heEZpbGVTaXplID0gRkZpbGVVdGlscy5odW1hbml6ZUJ5dGVzKFxyXG4gICAgICAgICAgICAgICAgICAgIDEwMjQgKiAxMDI0ICogdXBsb2FkT3B0cy5tYXhGaWxlU2l6ZVxyXG4gICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLnNlbGZVcGxvYWRPcHRzID0gT2JqZWN0LmFzc2lnbih0aGlzLnNlbGZVcGxvYWRPcHRzLCB1cGxvYWRPcHRzKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBnZXQgb3B0aW9ucygpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5zZWxmVXBsb2FkT3B0cztcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICog5q+P5Liq57uE5Y+v5Lul6K6+572u54m55q6K5pyN5Yqh5Y+C5pWw77yM5p2l6KaG55uW6buY6K6k55qE57uf5LiA5qih5Z2X57qn6YWN572uXHJcbiAgICAgKi9cclxuICAgIEBJbnB1dCgpXHJcbiAgICBzZXQgZXh0ZW5kU2VydmVyQ29uZmlnKGNvbmZpZzogYW55KSB7XHJcbiAgICAgICAgaWYgKGNvbmZpZykge1xyXG4gICAgICAgICAgICB0aGlzLmZpbGVVcGxvYWRlclNlci5zZXRFeHRlbmRTZXJ2ZXJDb25maWcoY29uZmlnKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICAvLyDorrDlvZXmlofku7bkuKrmlbBcclxuICAgIGZpbGVzOiBVcGxvYWRPdXRwdXRbXTtcclxuICAgIC8vIOagh+iusOmAmui/h+mAieaLqeaMiemSruWkhOeQhueahOS6i+S7tlxyXG4gICAgdXBsb2FkU2VsZWN0SW5wdXQ6IEV2ZW50RW1pdHRlcjxVcGxvYWRJbnB1dD47XHJcbiAgICAvLyDmoIforrDpgJrov4fmi5bmi73lpITnkIbnmoTkuovku7ZcclxuICAgIHVwbG9hZERyYWdJbnB1dDogRXZlbnRFbWl0dGVyPFVwbG9hZElucHV0PjtcclxuICAgIC8vIOaOp+WItuaYr+WQpuaYvuekuui/veWKoOmZhOS7tueahOmdouadv1xyXG4gICAgc2hvd0FwcGVuZFBhbmVsID0gZmFsc2U7XHJcbiAgICAvLyDmmL7npLpsb2FkaW5nXHJcbiAgICBzaG93TG9hZGluZyA9IGZhbHNlO1xyXG5cclxuICAgIHNldHRpbmdzID0ge1xyXG4gICAgICAgIGRpc2FibGVkOiB0aGlzLmRpc2FibGVkLFxyXG4gICAgICAgIHZpc2libGU6IHRoaXMudmlzaWJsZSxcclxuICAgIH07XHJcbiAgICAvLyDlpJror63oqIDkv6Hmga9cclxuICAgIGxvY2FsSW5mb1xyXG4gICAgY29uc3RydWN0b3IoXHJcbiAgICAgICAgcHJpdmF0ZSB1cGxvYWRBUElTZXI6IEZGaWxlVXBsb2FkQVBJU2VydmljZSxcclxuICAgICAgICBwcml2YXRlIGZpbGVVcGxvYWRlclNlcjogRkZpbGVVcGxvYWRlclNlcnZpY2UsXHJcbiAgICAgICAgcHJpdmF0ZSBub3RpZnlTZXJ2aWNlOiBOb3RpZnlTZXJ2aWNlLFxyXG4gICAgICAgIHByaXZhdGUgbmdab25lOiBOZ1pvbmVcclxuICAgICkge1xyXG4gICAgICAgIHRoaXMuZmlsZXMgPSBbXTtcclxuICAgICAgICB0aGlzLnVwbG9hZFNlbGVjdElucHV0ID0gbmV3IEV2ZW50RW1pdHRlcjxVcGxvYWRJbnB1dD4oKTtcclxuICAgICAgICB0aGlzLnVwbG9hZERyYWdJbnB1dCA9IG5ldyBFdmVudEVtaXR0ZXI8VXBsb2FkSW5wdXQ+KCk7XHJcbiAgICAgICAgLy8g6YeN572uXHJcbiAgICAgICAgdGhpcy5uZWVkUmVzZXQuc3Vic2NyaWJlKChkYXRhKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMucmVzZXQoKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICBGRmlsZVV0aWxzLmdldExvY2FsU3RhdGUodGhpcy5ub3RpZnlTZXJ2aWNlLmxvY2FsZVNlcnZpY2UpOyAgICAgICAgXHJcbiAgICB9XHJcblxyXG4gICAgbmdPbkluaXQoKSB7XHJcbiAgICAgICAgLy8g5qih5p2/55qE5oOF5Ya15LiL5Y+q6IO95piv56uL5Y2z5LiK5LygXHJcbiAgICAgICAgaWYgKHRoaXMuZkZpbGVVcGxvYWREaXIpIHtcclxuICAgICAgICAgICAgdGhpcy51cGxvYWRJbW1lZGlhdGVseSA9IHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuY29tcHV0ZVdpZHRoVGhyZXNob2xkKCk7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIOinhuWbvuWIneWni+WMluWQjlxyXG4gICAgICovXHJcbiAgICBuZ0FmdGVyVmlld0luaXQoKSB7IH1cclxuICAgIC8qKlxyXG4gICAgICog6Kem5Y+R57uR5a6aXHJcbiAgICAgKi9cclxuICAgIHRyaWdnZXJGaWxlU2VsZWN0KGV2KSB7XHJcbiAgICAgICAgZXYgJiYgZXYuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgLy8g56aB55So5pe2XHJcbiAgICAgICAgaWYgKHRoaXMuZGlzYWJsZWQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmZpbGVVcGxvYWQuZWxlbWVudFJlZi5uYXRpdmVFbGVtZW50LmNsaWNrKCk7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIOmAieaLqemZhOS7tuaMiemSru+8jOWkhOeQhuaKm+WHuuS6i+S7tlxyXG4gICAgICogQHBhcmFtIG91dHB1dFxyXG4gICAgICovXHJcbiAgICBzZWxlY3RVcGxvYWRPdXRwdXQob3V0cHV0OiBVcGxvYWRPdXRwdXQpOiB2b2lkIHtcclxuICAgICAgICB0aGlzLnVwbG9hZE91dHB1dEhhbmRsZXIob3V0cHV0KTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICog5ouW5ou95Yy65Z+f5aSE55CG5oqb5Ye65LqL5Lu2XHJcbiAgICAgKiBAcGFyYW0gb3V0cHV0XHJcbiAgICAgKi9cclxuICAgIGRyb3BVcGxvYWRPdXRwdXQob3V0cHV0OiBVcGxvYWRPdXRwdXQpOiB2b2lkIHtcclxuICAgICAgICBpZiAodGhpcy5lbmFibGVTZWxlY3QpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyDmmoLkuI3lpITnkIbmi5bmi73nmoTkuovku7ZcclxuICAgICAgICBpZiAoXHJcbiAgICAgICAgICAgIG91dHB1dC50eXBlICE9PSBcImRyYWdPdmVyXCIgJiZcclxuICAgICAgICAgICAgb3V0cHV0LnR5cGUgIT09IFwiZHJhZ091dFwiICYmXHJcbiAgICAgICAgICAgIG91dHB1dC50eXBlICE9PSBcImRyb3BcIlxyXG4gICAgICAgICkge1xyXG4gICAgICAgICAgICB0aGlzLnVwbG9hZE91dHB1dEhhbmRsZXIob3V0cHV0KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIGFsbEFkZGVkVG9RdWV1ZSDpgInkuK3mlofku7bov73liqDliLDpmJ/liJdcclxuICAgICAqIEBwYXJhbSBvdXRwdXRcclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSB1cGxvYWRPdXRwdXRIYW5kbGVyKG91dHB1dDogVXBsb2FkT3V0cHV0KTogdm9pZCB7XHJcbiAgICAgICAgLy8g5pi+56S66L+95Yqg6Z2i5p2/XHJcbiAgICAgICAgaWYgKHRoaXMuc2hvd0FwcGVuZFBhbmVsKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2hvd0FwcGVuZFBhbmVsID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAob3V0cHV0LnR5cGUgPT09IFwiYWRkZWRUb1F1ZXVlXCIgJiYgdHlwZW9mIG91dHB1dC5maWxlICE9PSBcInVuZGVmaW5lZFwiKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZmlsZXMucHVzaCh7IHR5cGU6IG91dHB1dC50eXBlLCBmaWxlOiBvdXRwdXQuZmlsZSB9KTtcclxuICAgICAgICAgICAgLy8g5aaC5p6c5ZCv55So56uL5Y2z5LiK5LygXHJcbiAgICAgICAgICAgIGlmICh0aGlzLnVwbG9hZEltbWVkaWF0ZWx5KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNob3dMb2FkaW5nID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc3RhcnRVcGxvYWQob3V0cHV0LmZpbGUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIGlmIChvdXRwdXQudHlwZSA9PT0gXCJzdGFydFwiKSB7XHJcbiAgICAgICAgICAgIC8vIOW8gOWni+S4iuS8oFxyXG4gICAgICAgICAgICB0aGlzLnVwZGF0ZUZpbGVzU3RhdGUob3V0cHV0LCBcIlwiKTtcclxuICAgICAgICB9IGVsc2UgaWYgKG91dHB1dC50eXBlID09IFwiZG9uZVwiKSB7XHJcbiAgICAgICAgICAgIC8vIOS4iuS8oOWujOaIkFxyXG4gICAgICAgICAgICB0aGlzLnVwZGF0ZUZpbGVzU3RhdGUob3V0cHV0LCBcImRvbmVcIik7XHJcbiAgICAgICAgICAgIHRoaXMuZlVwbG9hZERvbmVFdmVudC5lbWl0KFxyXG4gICAgICAgICAgICAgICAgRkZpbGVVdGlscy5jaGFuZ2VVcGxvYWRGaWxlVG9GaWxlRXh0ZW5kKG91dHB1dC5maWxlcylcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgdGhpcy5oaWRlQWZ0ZXJMb2FkZWQob3V0cHV0KTtcclxuICAgICAgICAgICAgLy8g6ZqQ6JeP5q2j5Zyo5Yqg6L29XHJcbiAgICAgICAgICAgIGlmIChcclxuICAgICAgICAgICAgICAgIHRoaXMudXBsb2FkSW1tZWRpYXRlbHkgJiZcclxuICAgICAgICAgICAgICAgIHRoaXMuc2hvd0xvYWRpbmcgJiZcclxuICAgICAgICAgICAgICAgIHRoaXMuYWxsRmlsZVVwbG9hZGVkKClcclxuICAgICAgICAgICAgKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNob3dMb2FkaW5nID0gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2UgaWYgKFxyXG4gICAgICAgICAgICBvdXRwdXQudHlwZSA9PT0gXCJjYW5jZWxsZWRcIiB8fFxyXG4gICAgICAgICAgICBvdXRwdXQudHlwZSA9PT0gXCJyZW1vdmVkXCIgfHxcclxuICAgICAgICAgICAgb3V0cHV0LnR5cGUgPT0gXCJlcnJvclwiXHJcbiAgICAgICAgKSB7XHJcbiAgICAgICAgICAgIC8vIOWIoOmZpOaIluiAheenu+mZpOaWh+S7tlxyXG4gICAgICAgICAgICB0aGlzLmZpbGVzID0gdGhpcy5maWxlcy5maWx0ZXIoKGZpbGVPdXRwdXQ6IFVwbG9hZE91dHB1dCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIChcclxuICAgICAgICAgICAgICAgICAgICBvdXRwdXQuZmlsZXMuZmluZEluZGV4KChpdGVtKSA9PiBmaWxlT3V0cHV0LmZpbGUuaWQgPT0gaXRlbS5pZCkgPCAwXHJcbiAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgLy8g6ZqQ6JeP5q2j5Zyo5Yqg6L29XHJcbiAgICAgICAgICAgIGlmIChcclxuICAgICAgICAgICAgICAgIHRoaXMudXBsb2FkSW1tZWRpYXRlbHkgJiZcclxuICAgICAgICAgICAgICAgIHRoaXMuc2hvd0xvYWRpbmcgJiZcclxuICAgICAgICAgICAgICAgIHRoaXMuYWxsRmlsZVVwbG9hZGVkKClcclxuICAgICAgICAgICAgKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNob3dMb2FkaW5nID0gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5zaG93Tm90aWZ5KG91dHB1dCk7XHJcbiAgICAgICAgfSBlbHNlIGlmIChcclxuICAgICAgICAgICAgb3V0cHV0LnR5cGUgPT09IFwicmVqZWN0ZWRcIiAmJlxyXG4gICAgICAgICAgICB0eXBlb2Ygb3V0cHV0LmZpbGUgIT09IFwidW5kZWZpbmVkXCJcclxuICAgICAgICApIHtcclxuICAgICAgICAgICAgLy8g5LiK5Lyg6KKr5ouS57udXHJcbiAgICAgICAgICAgIHRoaXMuc2hvd05vdGlmeShvdXRwdXQpO1xyXG4gICAgICAgICAgICAvLyDpmpDol4/mraPlnKjliqDovb1cclxuICAgICAgICAgICAgaWYgKFxyXG4gICAgICAgICAgICAgICAgdGhpcy51cGxvYWRJbW1lZGlhdGVseSAmJlxyXG4gICAgICAgICAgICAgICAgdGhpcy5zaG93TG9hZGluZyAmJlxyXG4gICAgICAgICAgICAgICAgdGhpcy5hbGxGaWxlVXBsb2FkZWQoKVxyXG4gICAgICAgICAgICApIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2hvd0xvYWRpbmcgPSBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIHNob3dOb3RpZnkob3V0cHV0KSB7XHJcbiAgICAgICAgbGV0IG5vdGlmeVR5cGUgPSBcIndhcm5pbmdcIjtcclxuICAgICAgICBpZiAob3V0cHV0LnR5cGUgPT0gXCJjYW5jZWxsZWRcIiB8fCBvdXRwdXQudHlwZSA9PSBcInJlbW92ZWRcIikge1xyXG4gICAgICAgICAgICBub3RpZnlUeXBlID0gXCJzdWNjZXNzXCI7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGxldCBtZXNzYWdlID0gb3V0cHV0Lmhhc093blByb3BlcnR5KFwibWVzc2FnZVwiKSA/IG91dHB1dFtcIm1lc3NhZ2VcIl0gOiBcIlwiO1xyXG4gICAgICAgIHRoaXMubm90aWZ5U2VydmljZVtub3RpZnlUeXBlXSg8Tm90aWZ5T3B0aW9ucz57XHJcbiAgICAgICAgICAgIG1zZzogbWVzc2FnZSxcclxuICAgICAgICAgICAgdGltZW91dDogMzAwMCxcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIC8vIOWIpOaWreaYr+WQpuaJgOacieaWh+S7tumDveW3suS4iuS8oFxyXG4gICAgcHJpdmF0ZSBhbGxGaWxlVXBsb2FkZWQoKSB7XHJcbiAgICAgICAgbGV0IGZpbmROb3REb25lSW5kZXggPSB0aGlzLmZpbGVzLmZpbmRJbmRleCgoaXRlbSkgPT4ge1xyXG4gICAgICAgICAgICBsZXQgZG9uZVR5cGVzID0gW1wiZG9uZVwiLCBcImNhbmNlbGxlZFwiLCBcInJlbW92ZWRcIl07XHJcbiAgICAgICAgICAgIGxldCBmaW5kVHlwZUluZGV4ID0gZG9uZVR5cGVzLmZpbmRJbmRleCgodHlwZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHR5cGUgPT0gaXRlbS50eXBlO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgcmV0dXJuIGZpbmRUeXBlSW5kZXggPT0gLTE7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIGZpbmROb3REb25lSW5kZXggPT0gLTEgPyB0cnVlIDogZmFsc2U7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIOabtOaWsOmZhOS7tueahOeKtuaAgVxyXG4gICAgICogQHBhcmFtIG91dHB1dFxyXG4gICAgICogQHBhcmFtIGV2ZW50VHlwZVxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIHVwZGF0ZUZpbGVzU3RhdGUob3V0cHV0OiBVcGxvYWRPdXRwdXQsIGV2ZW50VHlwZSkge1xyXG4gICAgICAgIGxldCBzdGFydEZpbGVzID0gW107XHJcbiAgICAgICAgaWYgKG91dHB1dC5oYXNPd25Qcm9wZXJ0eShcImZpbGVzXCIpICYmIG91dHB1dC5maWxlcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIC8vIOatpOWkhOabtOaWsOeVjOmdouWPr+iDveacieaAp+iDvemXrumimFxyXG4gICAgICAgICAgICBzdGFydEZpbGVzID0gb3V0cHV0LmZpbGVzO1xyXG4gICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIG91dHB1dC5maWxlICE9PSBcInVuZGVmaW5lZFwiKSB7XHJcbiAgICAgICAgICAgIHN0YXJ0RmlsZXMgPSBbb3V0cHV0LmZpbGVdO1xyXG4gICAgICAgIH1cclxuICAgICAgICBldmVudFR5cGUgPSBldmVudFR5cGUgPyBldmVudFR5cGUgOiBvdXRwdXQudHlwZTtcclxuICAgICAgICBzdGFydEZpbGVzLm1hcCgoaXRlbSkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBpbmRleCA9IHRoaXMuZmlsZXMuZmluZEluZGV4KFxyXG4gICAgICAgICAgICAgICAgKGZpbGVPdXRwdXQpID0+XHJcbiAgICAgICAgICAgICAgICAgICAgdHlwZW9mIGl0ZW0gIT09IFwidW5kZWZpbmVkXCIgJiYgZmlsZU91dHB1dC5maWxlLmlkID09PSBpdGVtLmlkXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIC8vIOWPmOabtOeKtuaAgVxyXG4gICAgICAgICAgICBpZiAoaW5kZXggPiAtMSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5maWxlc1tpbmRleF0gPSB7IHR5cGU6IGV2ZW50VHlwZSwgZmlsZTogaXRlbSB9O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoq5Y2V5Liq5paH5Lu25LiK5LygICovXHJcbiAgICBzdGFydFVwbG9hZChmaWxlOiBVcGxvYWRGaWxlKTogdm9pZCB7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogVG9kbzrlkI7nu63lj6/ku6Xku47kuIrkvKDljLrlnZfkuIrlj5blhoXlrrnov5vooYzmianlsZVcclxuICAgICAgICAgKi9cclxuICAgICAgICBjb25zdCBldmVudDogVXBsb2FkSW5wdXQgPSB0aGlzLnVwbG9hZEFQSVNlci5nZXRBc3NpZ25BUEkoXCJ1cGxvYWRcIiwge1xyXG4gICAgICAgICAgICBmaWxlOiBmaWxlLFxyXG4gICAgICAgICAgICB0eXBlOiB0aGlzLmVuYWJsZVNsaWNlVXBsb2FkID8gJ3NsaWNlVXBsb2FkJzogJ3VwbG9hZCcsXHJcbiAgICAgICAgICAgIGRhdGE6IHRoaXMuZXh0ZW5kRGF0YXMsXHJcbiAgICAgICAgICAgIGNodW5rU2l6ZTogdGhpcy5jaHVua1NpemVcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLmlucHV0VXBsb2FkRXZlbnRFbWl0KGV2ZW50KTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICog5LiK5Lyg5omA5pyJXHJcbiAgICAgKi9cclxuICAgIHN0YXJ0VXBsb2FkQWxsKCk6IHZvaWQge1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqICBUb2Rv77ya5ZCO57ut77yM5aaC5p6c5q+P5Liq5pWw5o2u5LiN5LiA5qC377yM5q2k5aSE55qE5pWw5o2u5b6X6YeN5paw5b2S6ZuGXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgY29uc3QgZXZlbnQ6IFVwbG9hZElucHV0ID0gdGhpcy51cGxvYWRBUElTZXIuZ2V0QXNzaWduQVBJKFwidXBsb2FkQWxsXCIsIHtcclxuICAgICAgICAgICAgdHlwZTogdGhpcy5lbmFibGVTbGljZVVwbG9hZCA/ICdzbGljZVVwbG9hZCc6IFwidXBsb2FkQWxsXCIsXHJcbiAgICAgICAgICAgIGZpbGVzOiBbXSxcclxuICAgICAgICAgICAgZGF0YTogdGhpcy5leHRlbmREYXRhcyxcclxuICAgICAgICAgICAgY2h1bmtTaXplOiB0aGlzLmNodW5rU2l6ZVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMuaW5wdXRVcGxvYWRFdmVudEVtaXQoZXZlbnQpO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiDlt7LkuIrkvKDpmpDol4/lsZ7mgKdcclxuICAgICAqL1xyXG4gICAgaGlkZUFmdGVyTG9hZGVkKG91dHB1dDogVXBsb2FkT3V0cHV0KTogdm9pZCB7XHJcbiAgICAgICAgLy/kuIrkvKDlrozmiJDlkI7liKDpmaRcclxuICAgICAgICBpZiAodGhpcy51cGxvYWRlZFRoZW5IaWRlKSB7XHJcbiAgICAgICAgICAgIC8vIHRoaXMubmdab25lLnJ1bk91dHNpZGVBbmd1bGFyKCgpID0+IHtcclxuICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAvLyDliKDpmaTmiJbogIXnp7vpmaTmlofku7ZcclxuICAgICAgICAgICAgICAgIGxldCBpZHMgPSBvdXRwdXQuZmlsZXMubWFwKChmaWxlSXRlbSkgPT4gZmlsZUl0ZW0uaWQpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5maWxlcyA9IHRoaXMuZmlsZXMuZmlsdGVyKChmaWxlT3V0cHV0OiBVcGxvYWRPdXRwdXQpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgdEluZGV4ID0gaWRzLmZpbmRJbmRleCgodElkKSA9PiB0SWQgPT0gZmlsZU91dHB1dC5maWxlLmlkKTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdEluZGV4ID4gLTEgPyBmYWxzZSA6IHRydWU7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICBjb25zdCBldmVudDogVXBsb2FkSW5wdXQgPSB0aGlzLnVwbG9hZEFQSVNlci5nZXRBc3NpZ25BUEkoXCJoaWRlXCIsIHtcclxuICAgICAgICAgICAgICAgICAgICB0eXBlOiBcImhpZGVcIixcclxuICAgICAgICAgICAgICAgICAgICBpZDogaWRzLmpvaW4oXCIsXCIpLFxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmlucHV0VXBsb2FkRXZlbnRFbWl0KGV2ZW50KTtcclxuICAgICAgICAgICAgfSwgMTAwMCk7XHJcbiAgICAgICAgICAgIC8vIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICog5Y+W5raI5LiK5LygXHJcbiAgICAgKi9cclxuICAgIGNhbmNlbFVwbG9hZChpZDogc3RyaW5nKTogdm9pZCB7XHJcbiAgICAgICAgY29uc3QgZXZlbnQ6IFVwbG9hZElucHV0ID0gdGhpcy51cGxvYWRBUElTZXIuZ2V0QXNzaWduQVBJKFwiY2FuY2VsXCIsIHtcclxuICAgICAgICAgICAgaWQ6IGlkLFxyXG4gICAgICAgICAgICB0eXBlOiBcImNhbmNlbFwiLFxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMuaW5wdXRVcGxvYWRFdmVudEVtaXQoZXZlbnQpO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiDliKDpmaTlt7LkuIrkvKDmlofku7ZcclxuICAgICAqL1xyXG4gICAgcmVtb3ZlbEFsbFVwbG9hZCgpOiB2b2lkIHtcclxuICAgICAgICBjb25zdCBldmVudDogVXBsb2FkSW5wdXQgPSB0aGlzLnVwbG9hZEFQSVNlci5nZXRBc3NpZ25BUEkoXCJyZW1vdmVBbGxcIiwge1xyXG4gICAgICAgICAgICB0eXBlOiBcInJlbW92ZUFsbFwiLFxyXG4gICAgICAgICAgICBmaWxlczogW10sXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5pbnB1dFVwbG9hZEV2ZW50RW1pdChldmVudCk7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIOWIoOmZpOW3suS4iuS8oOaWh+S7tlxyXG4gICAgICovXHJcbiAgICByZW1vdmVGaWxlKGlkOiBzdHJpbmcpOiB2b2lkIHtcclxuICAgICAgICBjb25zdCBldmVudDogVXBsb2FkSW5wdXQgPSB0aGlzLnVwbG9hZEFQSVNlci5nZXRBc3NpZ25BUEkoXCJyZW1vdmVcIiwge1xyXG4gICAgICAgICAgICBpZDogaWQsXHJcbiAgICAgICAgICAgIHR5cGU6IFwicmVtb3ZlXCIsXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5pbnB1dFVwbG9hZEV2ZW50RW1pdChldmVudCk7XHJcbiAgICB9XHJcbiAgICAvKiogKi9cclxuICAgIC8qKlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBieXRlc1xyXG4gICAgICovXHJcbiAgICBmb3JtYXRlQnl0ZXMoYnl0ZXMpIHtcclxuICAgICAgICByZXR1cm4gRkZpbGVVdGlscy5odW1hbml6ZUJ5dGVzKGJ5dGVzKTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICog5Yik5pat5piv5Zu+54mHXHJcbiAgICAgKiBAcGFyYW0gdHlwZVxyXG4gICAgICovXHJcbiAgICBpc0ltYWdlKHR5cGUpIHtcclxuICAgICAgICByZXR1cm4gdHlwZS5pbmRleE9mKFwiaW1hZ2VcIikgPiAtMTtcclxuICAgIH1cclxuICAgIC8vIGluUHJvZ3Jlc3MocHJvZ3Jlc3MpIHtcclxuICAgIC8vICAgY29uc29sZS5sb2coJ+i/m+WFpWluUHJvZ3Jlc3MnKTtcclxuICAgIC8vICAgaWYgKHByb2dyZXNzLmRhdGEucGVyY2VudGFnZSA9PSAxMDApIHtcclxuICAgIC8vICAgICByZXR1cm4gJ2RvbmUnXHJcbiAgICAvLyAgIH1cclxuICAgIC8vICAgaWYgKHByb2dyZXNzLmRhdGEucGVyY2VudGFnZSA9PSAwKSB7XHJcbiAgICAvLyAgICAgcmV0dXJuICd1cGxvYWRpJztcclxuICAgIC8vICAgfVxyXG4gICAgLy8gICByZXR1cm4gJ3Byb2dyZXNzJztcclxuICAgIC8vIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOaYr+WQpuWIpOaWreacieexu+Wei+mZkOWItlxyXG4gICAgICovXHJcbiAgICBqdWRnZUNvbnRlbnRUeXBlTGltaXQoKSB7XHJcbiAgICAgICAgbGV0IHRUeXBlcyA9IHRoaXMuYWxsb3dlZENvbnRlbnRUeXBlcy5zcGxpdChcIixcIik7XHJcbiAgICAgICAgbGV0IGhhc0FsbEluZGV4ID0gdFR5cGVzLmZpbmRJbmRleCgoaXRlbSkgPT4ge1xyXG4gICAgICAgICAgICByZXR1cm4gaXRlbSA9PSBcIipcIjtcclxuICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4gaGFzQWxsSW5kZXggPT0gLTE7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIOWIpOaWreaYr+WQpuacieaWh+S7tuWkp+Wwj+eahOmZkOWItlxyXG4gICAgICovXHJcbiAgICBqdWRlZ2VGaWxlU2l6ZUxpbWl0KCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLm1heEZpbGVTaXplICE9IFwiMCBCeXRlXCI7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIOi/veWKoFxyXG4gICAgICovXHJcbiAgICBhcHBlbmROZXdGaWxlcyhldikge1xyXG4gICAgICAgIC8v5ZCv55So5ouW5ou9XHJcbiAgICAgICAgaWYgKHRoaXMuZW5hYmxlRHJvcCkge1xyXG4gICAgICAgICAgICB0aGlzLnNob3dBcHBlbmRQYW5lbCA9IHRydWU7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgZXYgJiYgZXYuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgICAgIHRoaXMudHJpZ2dlckZpbGVTZWxlY3QoZXYpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICog5YWz6Zet6L+95Yqg6Z2i5p2/XHJcbiAgICAgKi9cclxuICAgIGNsb3NlQXBwZW5kUGFuZWwoKSB7XHJcbiAgICAgICAgdGhpcy5zaG93QXBwZW5kUGFuZWwgPSBmYWxzZTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICog57uf5LiA6Kem5Y+RIOmZhOS7tumAieaLqeWSjOaLluaLvemZhOS7tueahOS6i+S7tlxyXG4gICAgICogQHBhcmFtIGV2XHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgaW5wdXRVcGxvYWRFdmVudEVtaXQoZXY6IFVwbG9hZElucHV0KSB7XHJcbiAgICAgICAgLy8g5aaC5p6c5paH5Lu25LiK5Lyg5ZCv55SoXHJcbiAgICAgICAgaWYgKHRoaXMuZW5hYmxlU2VsZWN0KSB7XHJcbiAgICAgICAgICAgIHRoaXMudXBsb2FkU2VsZWN0SW5wdXQuZW1pdChldik7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy51cGxvYWREcmFnSW5wdXQuZW1pdChldik7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgLy8g6YeN572u5pa55rOVXHJcbiAgICByZXNldCgpIHtcclxuICAgICAgICB0aGlzLmZpbGVzID0gW107XHJcbiAgICAgICAgLy8g5aaC5p6c5paH5Lu25LiK5Lyg5ZCv55SoXHJcbiAgICAgICAgaWYgKHRoaXMuZW5hYmxlU2VsZWN0KSB7XHJcbiAgICAgICAgICAgIHRoaXMuZmlsZVVwbG9hZCAmJiB0aGlzLmZpbGVVcGxvYWQucmVzZXQoKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLmZpbGVEcm9wVXBsb2FkICYmIHRoaXMuZmlsZURyb3BVcGxvYWQucmVzZXQoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5jb21wdXRlV2lkdGhUaHJlc2hvbGQoKTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICog6K6h566X6ZiI5YC8XHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgY29tcHV0ZVdpZHRoVGhyZXNob2xkKCkge1xyXG4gICAgICAgIC8vXHJcbiAgICAgICAgdGhpcy5uZ1pvbmUucnVuT3V0c2lkZUFuZ3VsYXIoKCkgPT4ge1xyXG4gICAgICAgICAgICBsZXQgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgbGV0IHROZWVkQ29tcHV0ZWRDbHMgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIGlmIChzZWxmLmZGaWxlVXBsb2FkRGlyIHx8ICFzZWxmLnZpc2libGUpIHtcclxuICAgICAgICAgICAgICAgICAgICB0TmVlZENvbXB1dGVkQ2xzID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAvLyDorqHnrpflhYPntKBcclxuICAgICAgICAgICAgICAgIGxldCBhc3Npc3RFbCA9IHNlbGYuZkZpbGVVcGxvYWRBc3Npc3RcclxuICAgICAgICAgICAgICAgICAgICA/IHNlbGYuZkZpbGVVcGxvYWRBc3Npc3QubmF0aXZlRWxlbWVudFxyXG4gICAgICAgICAgICAgICAgICAgIDogbnVsbDtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoYXNzaXN0RWwpIHtcclxuICAgICAgICAgICAgICAgICAgICBhc3Npc3RFbC5wYXJlbnRFbGVtZW50LmNsYXNzTGlzdFtcImFkZFwiXShcImZmaWxldXBsb2FkLWRlZmF1bHRcIik7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG5cclxuICAgICAgICAgICAgICAgIC8vIC8vIOi2hei/h+mYiOWAvFxyXG4gICAgICAgICAgICAgICAgLy8gaWYgKGFzc2lzdEVsICYmIGFzc2lzdEVsLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLndpZHRoID4gc2VsZi53aWR0aFRocmVzaG9sZCkge1xyXG4gICAgICAgICAgICAgICAgLy8gICB0TmVlZENvbXB1dGVkQ2xzID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIC8vIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAvLyAgIHROZWVkQ29tcHV0ZWRDbHMgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIC8vIH1cclxuICAgICAgICAgICAgICAgIC8vIGlmIChhc3Npc3RFbCkge1xyXG4gICAgICAgICAgICAgICAgLy8gICBsZXQgYWN0aW9uRnVuID0gdE5lZWRDb21wdXRlZENscyA/ICdhZGQnIDogJ3JlbW92ZSc7XHJcbiAgICAgICAgICAgICAgICAvLyAgIGFzc2lzdEVsLnBhcmVudEVsZW1lbnQuY2xhc3NMaXN0W2FjdGlvbkZ1bl0oJ2ZmaWxldXBsb2FkLWRlZmF1bHQnKTtcclxuICAgICAgICAgICAgICAgIC8vIH1cclxuICAgICAgICAgICAgfSwgMCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbn1cclxuIl19