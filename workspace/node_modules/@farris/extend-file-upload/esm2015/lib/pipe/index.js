/**
 * @fileoverview added by tsickle
 * Generated from: lib/pipe/index.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Pipe } from "@angular/core";
import { Injector } from "@angular/core";
import { ColumnFormatService } from "@farris/ui-common/column";
import { FFileUtils } from "../utils/f-file.utils";
import { DateTimeHelperService } from "@farris/ui-common/date";
/**
 * 文件大小格式化
 */
export class FFileSizePipe {
    /**
     * @param {?} value
     * @param {?=} args
     * @return {?}
     */
    transform(value, args) {
        // 如果是字符串
        /** @type {?} */
        let tvalue = value;
        if (!value) {
            return "0 Byte";
        }
        if (typeof value == "string") {
            tvalue = parseInt(value);
        }
        return FFileUtils.humanizeBytes(tvalue);
    }
}
FFileSizePipe.decorators = [
    { type: Pipe, args: [{
                name: "fFileSize",
            },] }
];
/**
 * 日期格式化
 */
export class FFileDatePipe {
    /**
     * @param {?} dateSer
     */
    constructor(dateSer) {
        this.dateSer = dateSer;
    }
    /**
     * @param {?} value
     * @param {?=} returnFormat
     * @return {?}
     */
    transform(value, returnFormat = "yyyy-MM-dd") {
        if (!value)
            return '';
        return this.dateSer.formatTo(value, returnFormat);
    }
}
FFileDatePipe.decorators = [
    { type: Pipe, args: [{
                name: "fFileDate",
            },] }
];
/** @nocollapse */
FFileDatePipe.ctorParameters = () => [
    { type: DateTimeHelperService }
];
if (false) {
    /**
     * @type {?}
     * @private
     */
    FFileDatePipe.prototype.dateSer;
}
/**
 * 格式化自定义数据
 */
export class FormatCellDataPipe {
    /**
     * @param {?} cfs
     * @param {?} injector
     */
    constructor(cfs, injector) {
        this.cfs = cfs;
        this.injector = injector;
        // 先不处理多语言
        this.localeId = "ZH-CHS";
    }
    /**
     * 格式化数据
     * @param {?} column
     * @param {?} rowData
     * @param {?} rowIndex
     * @param {?} settings
     * @param {?=} state
     * @return {?}
     */
    transform(column, rowData, rowIndex, settings, state = "preview") {
        if (rowData && column && column.field) {
            // 值
            /** @type {?} */
            let value = this.getRealDataValue(rowData, column.field);
            /** @type {?} */
            let formatterFn = column.formatter;
            if (formatterFn) {
                if (formatterFn.type === "number") {
                    if (!formatterFn.options ||
                        !Object.keys(formatterFn.options).length) {
                        formatterFn.options = {
                            thousand: ",",
                            precision: 2,
                        };
                    }
                }
                // 不需要特殊处理
                // if (formatterFn.type === "datetime") {
                // }
            }
            //参数1： 值，参数2：行数据 参数3：格式化方法
            return this.cfs.format(value, rowData, formatterFn, { rowIndex, settings });
        }
        return "";
    }
    /**
     * 获取真正的数据
     * @private
     * @param {?} rowData
     * @param {?} field
     * @return {?}
     */
    getRealDataValue(rowData, field) {
        if (!field || !rowData)
            return '';
        /** @type {?} */
        let fieldArray = field.split('.');
        if (fieldArray.length == 1) {
            return rowData[fieldArray[0]];
        }
        /** @type {?} */
        let curItemVal = rowData;
        for (var k = 0; k < fieldArray.length; k++) {
            curItemVal = curItemVal[fieldArray[k]];
            // 没有值或者没有此属性
            if (curItemVal == null || curItemVal == undefined) {
                break;
            }
        }
        if (k == fieldArray.length) {
            return curItemVal == null || curItemVal == undefined ? "" : curItemVal;
        }
        else {
            return '';
        }
    }
}
FormatCellDataPipe.decorators = [
    { type: Pipe, args: [{ name: "formatCellData", pure: false },] }
];
/** @nocollapse */
FormatCellDataPipe.ctorParameters = () => [
    { type: ColumnFormatService },
    { type: Injector }
];
if (false) {
    /**
     * @type {?}
     * @private
     */
    FormatCellDataPipe.prototype.elRef;
    /**
     * @type {?}
     * @private
     */
    FormatCellDataPipe.prototype.localeId;
    /**
     * @type {?}
     * @private
     */
    FormatCellDataPipe.prototype.cfs;
    /**
     * @type {?}
     * @private
     */
    FormatCellDataPipe.prototype.injector;
}
/**
 * 附件可能之前生成的单据中并没有多语言服务
 * 调用附件的公共服务
 */
export class UPLocalePipe {
    constructor() { }
    /**
     * @param {?} name
     * @param {...?} replaceVal
     * @return {?}
     */
    transform(name, ...replaceVal) {
        return FFileUtils.getLocalStr(name, replaceVal);
    }
}
UPLocalePipe.decorators = [
    { type: Pipe, args: [{ name: 'upLocale' },] }
];
/** @nocollapse */
UPLocalePipe.ctorParameters = () => [];
/**
 * 解决变量有个默认的文字，变量最终可能是默认值也可能不是
 */
export class UPLocaleDefaultPipe {
    constructor() { }
    /**
     * @param {?} realValue
     * @param {?} compareTxt
     * @param {?} localeName
     * @return {?}
     */
    transform(realValue, compareTxt, localeName) {
        if (realValue == compareTxt) {
            return FFileUtils.getLocalStr(localeName);
        }
        return realValue;
    }
}
UPLocaleDefaultPipe.decorators = [
    { type: Pipe, args: [{ name: 'upLocaleDefault' },] }
];
/** @nocollapse */
UPLocaleDefaultPipe.ctorParameters = () => [];
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZmFycmlzL2V4dGVuZC1maWxlLXVwbG9hZC8iLCJzb3VyY2VzIjpbImxpYi9waXBlL2luZGV4LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7O0FBQUEsT0FBTyxFQUFFLElBQUksRUFBaUIsTUFBTSxlQUFlLENBQUM7QUFDcEQsT0FBTyxFQUFFLFFBQVEsRUFBeUIsTUFBTSxlQUFlLENBQUM7QUFDaEUsT0FBTyxFQUFFLG1CQUFtQixFQUFFLE1BQU0sMEJBQTBCLENBQUM7QUFDL0QsT0FBTyxFQUFFLFVBQVUsRUFBRSxNQUFNLHVCQUF1QixDQUFDO0FBQ25ELE9BQU8sRUFBRSxxQkFBcUIsRUFBRSxNQUFNLHdCQUF3QixDQUFDOzs7O0FBTy9ELE1BQU0sT0FBTyxhQUFhOzs7Ozs7SUFDdEIsU0FBUyxDQUFDLEtBQVUsRUFBRSxJQUFVOzs7WUFFeEIsTUFBTSxHQUFHLEtBQUs7UUFDbEIsSUFBSSxDQUFDLEtBQUssRUFBRTtZQUNSLE9BQU8sUUFBUSxDQUFDO1NBQ25CO1FBQ0QsSUFBSSxPQUFPLEtBQUssSUFBSSxRQUFRLEVBQUU7WUFDMUIsTUFBTSxHQUFHLFFBQVEsQ0FBQyxLQUFLLENBQUMsQ0FBQztTQUM1QjtRQUNELE9BQU8sVUFBVSxDQUFDLGFBQWEsQ0FBQyxNQUFNLENBQUMsQ0FBQztJQUM1QyxDQUFDOzs7WUFkSixJQUFJLFNBQUM7Z0JBQ0YsSUFBSSxFQUFFLFdBQVc7YUFDcEI7Ozs7O0FBb0JELE1BQU0sT0FBTyxhQUFhOzs7O0lBQ3RCLFlBQW9CLE9BQThCO1FBQTlCLFlBQU8sR0FBUCxPQUFPLENBQXVCO0lBQUksQ0FBQzs7Ozs7O0lBQ3ZELFNBQVMsQ0FBQyxLQUFVLEVBQUUsZUFBdUIsWUFBWTtRQUNyRCxJQUFHLENBQUMsS0FBSztZQUFFLE9BQU8sRUFBRSxDQUFDO1FBQ3JCLE9BQU8sSUFBSSxDQUFDLE9BQU8sQ0FBQyxRQUFRLENBQUMsS0FBSyxFQUFFLFlBQVksQ0FBQyxD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aEIsU0FBUyxDQUFDLElBQVMsRUFBRSxHQUFHLFVBQWlCO1FBQ25DLE9BQVEsVUFBVSxDQUFDLFdBQVcsQ0FBQyxJQUFJLEVBQUMsVUFBVSxDQUFDLENBQUM7SUFDdEQsQ0FBQzs7O1lBTEosSUFBSSxTQUFDLEVBQUMsSUFBSSxFQUFFLFVBQVUsRUFBQzs7Ozs7OztBQVl4QixNQUFNLE9BQU8sbUJBQW1CO0lBQzVCLGdCQUFlLENBQUM7Ozs7Ozs7SUFDaEIsU0FBUyxDQUFDLFNBQWMsRUFBQyxVQUFpQixFQUFDLFVBQWlCO1FBQ3hELElBQUcsU0FBUyxJQUFFLFVBQVUsRUFBQztZQUNyQixPQUFRLFVBQVUsQ0FBQyxXQUFXLENBQUMsVUFBVSxDQUFDLENBQUM7U0FDOUM7UUFDRCxPQUFPLFNBQVMsQ0FBQztJQUNyQixDQUFDOzs7WUFSSixJQUFJLFNBQUMsRUFBQyxJQUFJLEVBQUUsaUJBQWlCLEVBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBQaXBlLCBQaXBlVHJhbnNmb3JtIH0gZnJvbSBcIkBhbmd1bGFyL2NvcmVcIjtcclxuaW1wb3J0IHsgSW5qZWN0b3IsIEVsZW1lbnRSZWYsIExPQ0FMRV9JRCB9IGZyb20gXCJAYW5ndWxhci9jb3JlXCI7XHJcbmltcG9ydCB7IENvbHVtbkZvcm1hdFNlcnZpY2UgfSBmcm9tIFwiQGZhcnJpcy91aS1jb21tb24vY29sdW1uXCI7XHJcbmltcG9ydCB7IEZGaWxlVXRpbHMgfSBmcm9tIFwiLi4vdXRpbHMvZi1maWxlLnV0aWxzXCI7XHJcbmltcG9ydCB7IERhdGVUaW1lSGVscGVyU2VydmljZSB9IGZyb20gXCJAZmFycmlzL3VpLWNvbW1vbi9kYXRlXCI7XHJcbi8qKlxyXG4gKiDmlofku7blpKflsI/moLzlvI/ljJZcclxuICovXHJcbkBQaXBlKHtcclxuICAgIG5hbWU6IFwiZkZpbGVTaXplXCIsXHJcbn0pXHJcbmV4cG9ydCBjbGFzcyBGRmlsZVNpemVQaXBlIGltcGxlbWVudHMgUGlwZVRyYW5zZm9ybSB7XHJcbiAgICB0cmFuc2Zvcm0odmFsdWU6IGFueSwgYXJncz86IGFueSk6IGFueSB7XHJcbiAgICAgICAgLy8g5aaC5p6c5piv5a2X56ym5LiyXHJcbiAgICAgICAgbGV0IHR2YWx1ZSA9IHZhbHVlO1xyXG4gICAgICAgIGlmICghdmFsdWUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIFwiMCBCeXRlXCI7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT0gXCJzdHJpbmdcIikge1xyXG4gICAgICAgICAgICB0dmFsdWUgPSBwYXJzZUludCh2YWx1ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBGRmlsZVV0aWxzLmh1bWFuaXplQnl0ZXModHZhbHVlKTtcclxuICAgIH1cclxufVxyXG4vKipcclxuICog5pel5pyf5qC85byP5YyWXHJcbiAqL1xyXG5AUGlwZSh7XHJcbiAgICBuYW1lOiBcImZGaWxlRGF0ZVwiLFxyXG59KVxyXG5leHBvcnQgY2xhc3MgRkZpbGVEYXRlUGlwZSBpbXBsZW1lbnRzIFBpcGVUcmFuc2Zvcm0ge1xyXG4gICAgY29uc3RydWN0b3IocHJpdmF0ZSBkYXRlU2VyOiBEYXRlVGltZUhlbHBlclNlcnZpY2UpIHsgfVxyXG4gICAgdHJhbnNmb3JtKHZhbHVlOiBhbnksIHJldHVybkZvcm1hdDogc3RyaW5nID0gXCJ5eXl5LU1NLWRkXCIpOiBhbnkge1xyXG4gICAgICAgIGlmKCF2YWx1ZSkgcmV0dXJuICcnO1xyXG4gICAgICAgIHJldHVybiB0aGlzLmRhdGVTZXIuZm9ybWF0VG8odmFsdWUsIHJldHVybkZvcm1hdCk7XHJcbiAgICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiDmoLzlvI/ljJboh6rlrprkuYnmlbDmja5cclxuICovXHJcblxyXG5AUGlwZSh7IG5hbWU6IFwiZm9ybWF0Q2VsbERhdGFcIiwgcHVyZTogZmFsc2UgfSlcclxuZXhwb3J0IGNsYXNzIEZvcm1hdENlbGxEYXRhUGlwZSBpbXBsZW1lbnRzIFBpcGVUcmFuc2Zvcm0ge1xyXG4gICAgcHJpdmF0ZSBlbFJlZjogRWxlbWVudFJlZjtcclxuICAgIC8vIOWFiOS4jeWkhOeQhuWkmuivreiogFxyXG4gICAgcHJpdmF0ZSBsb2NhbGVJZCA9IFwiWkgtQ0hTXCI7XHJcbiAgICBjb25zdHJ1Y3Rvcihwcml2YXRlIGNmczogQ29sdW1uRm9ybWF0U2VydmljZSwgcHJpdmF0ZSBpbmplY3RvcjogSW5qZWN0b3IpIHsgfVxyXG4gICAgLyoqXHJcbiAgICAgKiDmoLzlvI/ljJbmlbDmja5cclxuICAgICAqIEBwYXJhbSBjb2x1bW465YiX5L+h5oGvXHJcbiAgICAgKiBAcGFyYW0gcm93RGF0YTrlvZPliY3mlbDmja5cclxuICAgICAqIEBwYXJhbSBzZXR0aW5nczrphY3nva7kv6Hmga9cclxuICAgICAqIEBwYXJhbSBzdGF0ZTog54q25oCBXHJcbiAgICAgKiBAcmV0dXJuc1xyXG4gICAgICovXHJcbiAgICB0cmFuc2Zvcm0oY29sdW1uLCByb3dEYXRhLCByb3dJbmRleCwgc2V0dGluZ3MsIHN0YXRlID0gXCJwcmV2aWV3XCIpOiBhbnkge1xyXG4gICAgICAgIGlmIChyb3dEYXRhICYmIGNvbHVtbiAmJiBjb2x1bW4uZmllbGQpIHtcclxuICAgICAgICAgICAgLy8g5YC8XHJcbiAgICAgICAgICAgIGxldCB2YWx1ZSA9dGhpcy5nZXRSZWFsRGF0YVZhbHVlKHJvd0RhdGEsY29sdW1uLmZpZWxkKTtcclxuICAgICAgICAgICAgbGV0IGZvcm1hdHRlckZuID0gY29sdW1uLmZvcm1hdHRlcjtcclxuICAgICAgICAgICAgaWYgKGZvcm1hdHRlckZuKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoZm9ybWF0dGVyRm4udHlwZSA9PT0gXCJudW1iZXJcIikge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChcclxuICAgICAgICAgICAgICAgICAgICAgICAgIWZvcm1hdHRlckZuLm9wdGlvbnMgfHxcclxuICAgICAgICAgICAgICAgICAgICAgICAgIU9iamVjdC5rZXlzKGZvcm1hdHRlckZuLm9wdGlvbnMpLmxlbmd0aFxyXG4gICAgICAgICAgICAgICAgICAgICkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3JtYXR0ZXJGbi5vcHRpb25zID0ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhvdXNhbmQ6IFwiLFwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJlY2lzaW9uOiAyLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIC8vIOS4jemcgOimgeeJueauiuWkhOeQhlxyXG4gICAgICAgICAgICAgICAgLy8gaWYgKGZvcm1hdHRlckZuLnR5cGUgPT09IFwiZGF0ZXRpbWVcIikge1xyXG4gICAgICAgICAgICAgICAgLy8gfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8v5Y+C5pWwMe+8miDlgLzvvIzlj4LmlbAy77ya6KGM5pWw5o2uIOWPguaVsDPvvJrmoLzlvI/ljJbmlrnms5VcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuY2ZzLmZvcm1hdCh2YWx1ZSwgcm93RGF0YSwgZm9ybWF0dGVyRm4sIHsgcm93SW5kZXgsIHNldHRpbmdzIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gXCJcIjtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICog6I635Y+W55yf5q2j55qE5pWw5o2uXHJcbiAgICAgKiBAcGFyYW0gcm93RGF0YSBcclxuICAgICAqIEBwYXJhbSBmaWVsZCBcclxuICAgICAqIEByZXR1cm5zIFxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIGdldFJlYWxEYXRhVmFsdWUocm93RGF0YSwgZmllbGQpIHtcclxuICAgICAgICBpZiAoIWZpZWxkfHwhcm93RGF0YSkgcmV0dXJuICcnO1xyXG4gICAgICAgIGxldCBmaWVsZEFycmF5ID0gZmllbGQuc3BsaXQoJy4nKTtcclxuICAgICAgICBpZiAoZmllbGRBcnJheS5sZW5ndGggPT0gMSkge1xyXG4gICAgICAgICAgICByZXR1cm4gcm93RGF0YVtmaWVsZEFycmF5WzBdXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgbGV0IGN1ckl0ZW1WYWwgPSByb3dEYXRhO1xyXG4gICAgICAgIGZvciAodmFyIGsgPSAwOyBrIDwgZmllbGRBcnJheS5sZW5ndGg7IGsrKykge1xyXG4gICAgICAgICAgICBjdXJJdGVtVmFsID0gY3VySXRlbVZhbFtmaWVsZEFycmF5W2tdXTtcclxuICAgICAgICAgICAgLy8g5rKh5pyJ5YC85oiW6ICF5rKh5pyJ5q2k5bGe5oCnXHJcbiAgICAgICAgICAgIGlmIChjdXJJdGVtVmFsID09IG51bGwgfHwgY3VySXRlbVZhbCA9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChrID09IGZpZWxkQXJyYXkubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBjdXJJdGVtVmFsID09IG51bGwgfHwgY3VySXRlbVZhbCA9PSB1bmRlZmluZWQ/XCJcIjpjdXJJdGVtVmFsO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiAnJztcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBcclxufVxyXG4vKipcclxuICog6ZmE5Lu25Y+v6IO95LmL5YmN55Sf5oiQ55qE5Y2V5o2u5Lit5bm25rKh5pyJ5aSa6K+t6KiA5pyN5YqhXHJcbiAqIOiwg+eUqOmZhOS7tueahOWFrOWFseacjeWKoVxyXG4gKi9cclxuQFBpcGUoe25hbWU6ICd1cExvY2FsZSd9KVxyXG5leHBvcnQgY2xhc3MgVVBMb2NhbGVQaXBlIGltcGxlbWVudHMgUGlwZVRyYW5zZm9ybSB7XHJcbiAgICBjb25zdHJ1Y3RvcigpIHt9XHJcbiAgICB0cmFuc2Zvcm0obmFtZTogYW55LCAuLi5yZXBsYWNlVmFsOiBhbnlbXSk6IGFueSB7XHJcbiAgICAgICAgICByZXR1cm4gIEZGaWxlVXRpbHMuZ2V0TG9jYWxTdHIobmFtZSxyZXBsYWNlVmFsKTtcclxuICAgIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIOino+WGs+WPmOmHj+acieS4qum7mOiupOeahOaWh+Wtl++8jOWPmOmHj+acgOe7iOWPr+iDveaYr+m7mOiupOWAvOS5n+WPr+iDveS4jeaYr1xyXG4gKi9cclxuQFBpcGUoe25hbWU6ICd1cExvY2FsZURlZmF1bHQnfSlcclxuZXhwb3J0IGNsYXNzIFVQTG9jYWxlRGVmYXVsdFBpcGUgaW1wbGVtZW50cyBQaXBlVHJhbnNmb3JtIHtcclxuICAgIGNvbnN0cnVjdG9yKCkge31cclxuICAgIHRyYW5zZm9ybShyZWFsVmFsdWU6IGFueSxjb21wYXJlVHh0OnN0cmluZyxsb2NhbGVOYW1lOnN0cmluZyk6IGFueSB7XHJcbiAgICAgICAgaWYocmVhbFZhbHVlPT1jb21wYXJlVHh0KXtcclxuICAgICAgICAgICAgcmV0dXJuICBGRmlsZVV0aWxzLmdldExvY2FsU3RyKGxvY2FsZU5hbWUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcmVhbFZhbHVlO1xyXG4gICAgfSAgICAgICAgIFxyXG59XHJcblxyXG5cclxuIl19