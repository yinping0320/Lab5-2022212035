!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@farris/ui-modal/utils"),require("rxjs"),require("@angular/core"),require("@angular/common"),require("@farris/ui-modal/component-loader"),require("@farris/ui-modal/positioning"),require("@farris/ui-common")):"function"==typeof define&&define.amd?define("@farris/ui-popover",["exports","@farris/ui-modal/utils","rxjs","@angular/core","@angular/common","@farris/ui-modal/component-loader","@farris/ui-modal/positioning","@farris/ui-common"],t):t((e.farris=e.farris||{},e.farris["ui-popover"]={}),e.utils,e.rxjs,e.ng.core,e.ng.common,e.componentLoader,e.positioning,e.uiCommon)}(this,function(e,t,o,p,n,i,r,a){"use strict";var h=(s.decorators=[{type:p.Injectable,args:[{providedIn:"root"}]}],s.ngInjectableDef=p.defineInjectable({factory:function(){return new s},token:s,providedIn:"root"}),s);function s(){this.placement="top",this.triggers="click",this.outsideClick=!0}var u=(Object.defineProperty(c.prototype,"isBs3",{get:function(){return t.isBs3()},enumerable:!0,configurable:!0}),c.prototype.ngAfterViewInit=function(){this.el&&(this.mouseenterEvent=this.changeMouseState.bind(this,!0),this.mouseleaveEvent=this.changeMouseState.bind(this,!1),this.el.nativeElement.addEventListener("mouseenter",this.mouseenterEvent),this.el.nativeElement.addEventListener("mouseleave",this.mouseleaveEvent))},c.prototype.getMouseState=function(){return this.mounseState},c.prototype.changeMouseState=function(e){this.mounseState.next(e)},c.prototype.ngOnDestroy=function(){this.mouseenterEvent&&this.el.nativeElement.removeEventListener("mouseenter",this.mouseenterEvent),this.mouseleaveEvent&&this.el.nativeElement.removeEventListener("mouseleave",this.mouseleaveEvent),this.mounseState.unsubscribe()},c.decorators=[{type:p.Component,args:[{selector:"farris-popover",changeDetection:p.ChangeDetectionStrategy.OnPush,host:{"[class]":'"popover in popover-" + placement + " " + "bs-popover-" + placement + " " + placement + " " + containerClass',"[class.show]":"!isBs3","[class.bs3]":"isBs3",role:"tooltip",style:"display:block;"},template:'<div class="popover-arrow arrow"></div>\r\n<h3 class="popover-title popover-header" *ngIf="title">{{ title }}</h3>\r\n<div #innerEle class="popover-content popover-body" [ngClass]="containerClass">\r\n  <ng-content></ng-content>\r\n</div>\r\n',styles:["\n    :host.bs3.popover-top {\n      margin-bottom: 10px;\n    }\n    :host.bs3.popover.top>.arrow {\n      margin-left: -2px;\n    }\n    :host.bs3.popover.top {\n      margin-bottom: 10px;\n    }\n    :host.popover.bottom>.arrow {\n      margin-left: -4px;\n    }\n    :host.bs3.bs-popover-left {\n      margin-right: .5rem;\n    }\n    :host.bs3.bs-popover-right .arrow, :host.bs3.bs-popover-left .arrow{\n      margin: .3rem 0;\n    }\n    :host.arrow-left .arrow {\n        left: calc(50% - 10px);\n    }\n    "]}]}],c.ctorParameters=function(){return[{type:h},{type:p.ElementRef,decorators:[{type:p.Optional}]}]},c.propDecorators={innerNode:[{type:p.ViewChild,args:["innerEle",{read:p.ElementRef}]}],placement:[{type:p.Input}],title:[{type:p.Input}]},c);function c(e,t){this.el=t,this.mounseState=new o.Subject,Object.assign(this,e)}var l=(Object.defineProperty(v.prototype,"isOpen",{get:function(){return this._popover.isShown},set:function(e){e?this[this.showAction]():this.hide()},enumerable:!0,configurable:!0}),v.prototype.hasScrollbarY=function(){return this._bodyOverflow||(this._bodyOverflow=getComputedStyle(document.body).overflow),document.body.scrollHeight>window.innerHeight&&"hidden"!==this._bodyOverflow},v.prototype.show=function(){var o=this;if(this.popActive&&!this._popover.isShown&&this.popover){this._popover.attach(u).to(this.container).position({attachment:this.placement}).show({showType:"popover",content:this.popover,context:this.popoverContext,placement:this.placement,title:this.popoverTitle,containerClass:this.containerClass});var e=this.commonUtils.getFloatingLayerIndex();this._popover.instance.el.nativeElement.style.position="fixed",this._popover.instance.el.nativeElement.style.zIndex=e,this.overlaySer.registerMouseEvent(this._elementRef.nativeElement,function(e){var t=e.target;o._popover.instance.el.nativeElement.contains(t)||t.closest(".overlay-pane")||o.hide()}),"hover"==this.triggers&&this._popover.instance&&this._popover.instance.getMouseState&&this._popover.instance.getMouseState().subscribe(function(e){(o.containerInOutState=e)||o.hide()})}},v.prototype.show2=function(){var e=this;if(this.popActive&&!this._popover.isShown&&this.popover){var t=this._popover.attach(u).to(this.container).show({content:this.popover,context:this.popoverContext,placement:this.placement,title:this.popoverTitle,containerClass:this.containerClass});this.overlaySer.registerMouseEvent(this._elementRef.nativeElement,function(){e.hide()});var o,n,i=this._elementRef.nativeElement.getBoundingClientRect(),r=(i.height,i.width),s=i.top,p=i.left,a=t.location.nativeElement.getBoundingClientRect(),h=a.height,c=a.width;switch(this.placement){case"bottom":case"left":case"right":default:o=s-h-8+"px",n=p+r/2-c/2+"px",this._renderer.addClass(t.location.nativeElement,"arrow-left")}var l={top:o,left:n,zIndex:this.commonUtils.getFloatingLayerIndex()};this.setStyles(t.location.nativeElement,l)}},v.prototype.setStyles=function(t,o){var n=this,e=Object.keys(o);e&&e.forEach(function(e){n._renderer.setStyle(t,e,o[e])})},v.prototype._hide=function(){this._popover.hide(),this.overlaySer.destory(this._elementRef.nativeElement)},v.prototype.hide=function(){var e=this;"hover"==this.triggers&&this.ngZone?this.isOpen&&this.ngZone.runOutsideAngular(function(){setTimeout(function(){e.containerInOutState||e._hide()},300)}):this.isOpen&&this._hide()},v.prototype.toggle=function(){if(this.isOpen)return this.hide();this.show()},v.prototype.ngOnInit=function(){var e=this;this._isInited||(this._isInited=!0,this.isFixed&&this._positionService.setOptions({modifiers:{preventOverflow:{enabled:!1}}}),"hover"==this.triggers?this._popover.listen({triggers:this.triggers,outsideClick:this.outsideClick,show:function(){return e[e.showAction]()},hide:function(){return e.hide()}}):this._popover.listen({triggers:this.triggers,outsideClick:this.outsideClick,show:function(){return e[e.showAction]()}}))},v.prototype.ngOnDestroy=function(){this._popover.dispose()},v.decorators=[{type:p.Directive,args:[{selector:"[farrisPopover]",exportAs:"bs-popover"}]}],v.ctorParameters=function(){return[{type:h},{type:p.ElementRef},{type:p.Renderer2},{type:p.ViewContainerRef},{type:i.ComponentLoaderFactory},{type:r.PositioningService},{type:p.Injector,decorators:[{type:p.Optional}]}]},v.propDecorators={popover:[{type:p.Input}],popoverContext:[{type:p.Input}],popoverTitle:[{type:p.Input}],placement:[{type:p.Input}],outsideClick:[{type:p.Input}],triggers:[{type:p.Input}],container:[{type:p.Input}],containerClass:[{type:p.Input}],popActive:[{type:p.Input}],showAction:[{type:p.Input}],isOpen:[{type:p.Input}],isFixed:[{type:p.Input}],onShown:[{type:p.Output}],onHidden:[{type:p.Output}]},v);function v(e,t,o,n,i,r,s){this._elementRef=t,this._renderer=o,this._positionService=r,this.inject=s,this.outsideClick=!0,this.container="body",this.containerClass="",this.popActive=!0,this.showAction="show",this.isFixed=!1,this._isInited=!1,this.containerInOutState=!1,this._bodyOverflow="",this.inject&&(this.ngZone=this.inject.get(p.NgZone,null),this.overlaySer=this.inject.get(a.OverLayHiddenService,null),this.commonUtils=this.inject.get(a.CommonUtils,new a.CommonUtils)),this._popover=i.createLoader(t,n,o).provide({provide:h,useValue:e}),Object.assign(this,e),this.onShown=this._popover.onShown,this.onHidden=this._popover.onHidden,"undefined"!=typeof window&&t.nativeElement.addEventListener("click",function(){try{t.nativeElement.focus()}catch(e){return}}),this.overlaySer||(this.overlaySer=new a.OverLayHiddenService)}var d=(m.forRoot=function(){return{ngModule:m,providers:[h,i.ComponentLoaderFactory,r.PositioningService]}},m.decorators=[{type:p.NgModule,args:[{imports:[n.CommonModule,a.FarrisCommonModule],declarations:[l,u],exports:[l],entryComponents:[u]}]}],m);function m(){}e.PopoverDirective=l,e.PopoverModule=d,e.PopoverConfig=h,e.PopoverContainerComponent=u,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=farris-ui-popover.umd.min.js.map