/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, Input, ElementRef, Renderer2, ViewChild, Output, EventEmitter, NgZone } from '@angular/core';
import { AngularResizableDirective } from '@farris/ui-draggable';
import { LayoutComponent } from './../layout.component';
export class LayoutPanelComponent {
    /**
     * @param {?} el
     * @param {?} render2
     * @param {?} layout
     * @param {?} ngZone
     */
    constructor(el, render2, layout, ngZone) {
        this.el = el;
        this.render2 = render2;
        this.layout = layout;
        this.ngZone = ngZone;
        this.minHeight = 100;
        this.minWidth = 100;
        this.title = '';
        this.iconCls = '';
        this.overflow = 'auto';
        this._resizable = true;
        this.bsColClass = '';
        this.showBorder = true;
        this.resizing = new EventEmitter();
        this.resized = new EventEmitter();
    }
    /**
     * @return {?}
     */
    get split() {
        return this._resizable;
    }
    /**
     * @param {?} val
     * @return {?}
     */
    set split(val) {
        this._resizable = val;
    }
    /**
     * @private
     * @return {?}
     */
    setStyles() {
        // this.ngZone.runOutsideAngular(() => {
        setTimeout((/**
         * @return {?}
         */
        () => {
            /** @type {?} */
            let width;
            /** @type {?} */
            let height;
            /** @type {?} */
            const rect = this.el.nativeElement.getBoundingClientRect();
            if (this.height) {
                height = this.height;
                this.render2.setStyle(this.el.nativeElement, 'height', height + 'px');
                this.render2.setStyle(this.panel.nativeElement, 'height', height + 'px');
            }
            if (this.width) {
                width = this.width;
                if (rect.width > this.width) {
                    width = rect.width;
                    this.width = width;
                }
                this.render2.setStyle(this.el.nativeElement, 'width', width + 'px');
                this.render2.setStyle(this.panel.nativeElement, 'width', width + 'px');
                this.resetFlex();
            }
        }));
        // });
    }
    /**
     * @private
     * @return {?}
     */
    getrzHandler() {
        if (this.region) {
            /** @type {?} */
            let rzdir = '';
            switch (this.region) {
                case 'west':
                    rzdir = 'e';
                    break;
                case 'east':
                    rzdir = 'w';
                    break;
                case 'north':
                    rzdir = 's';
                    break;
                case 'south':
                    rzdir = 'n';
                    break;
            }
            this.rzHandler = rzdir;
        }
        else {
            this.rzHandler = '';
        }
    }
    /**
     * @return {?}
     */
    isCenterPanel() {
        return this.region === 'center';
    }
    /**
     * @param {?} changes
     * @return {?}
     */
    ngOnChanges(changes) {
        if (changes.width && !changes.width.isFirstChange()) {
            this.setStyles();
        }
    }
    /**
     * @private
     * @return {?}
     */
    getBsClass() {
        return Array.from(this.el.nativeElement.classList).find((/**
         * @param {?} c
         * @return {?}
         */
        (c) => c.indexOf('col-') > -1));
    }
    /**
     * @private
     * @return {?}
     */
    hasBsClass() {
        return this.getBsClass() !== undefined;
    }
    /**
     * @private
     * @return {?}
     */
    initSize() {
        this.setStyles();
        if (this.region) {
            if (this.region === 'west' || this.region === 'east') {
                this.render2.setStyle(this.panel.nativeElement, 'height', '100%');
            }
        }
    }
    /**
     * @private
     * @return {?}
     */
    initClass() {
        if (this.isCenterPanel()) {
            this.render2.addClass(this.panel.nativeElement, this.overflow == 'auto' ? 'flex-fill' : 'f-utils-fill');
            if (this.el.nativeElement.parentElement.attributes['layout-panel']) {
                this.render2.addClass(this.el.nativeElement.parentElement, 'd-flex');
            }
            this.render2.addClass(this.el.nativeElement, 'd-flex');
            this.render2.addClass(this.el.nativeElement, 'f-utils-fill');
        }
        if (this.showBorder) {
            this.render2.addClass(this.panel.nativeElement, 'layout-border');
        }
    }
    /**
     * @return {?}
     */
    ngOnInit() {
        this.initSize();
        this.initClass();
        this.getrzHandler();
        this.bsColClass = this.getBsClass();
        this.layout.panels.push(this);
    }
    /**
     * @param {?} $event
     * @return {?}
     */
    onResizeStart($event) {
        this.resetFlex();
    }
    /**
     * @private
     * @return {?}
     */
    resetFlex() {
        if (this.region === 'west' || this.region === 'east') {
            this.render2.setStyle(this.el.nativeElement, 'flex', 'none');
            this.render2.setStyle(this.el.nativeElement, 'max-width', 'none');
        }
    }
    /**
     * @param {?} size
     * @return {?}
     */
    resize(size) {
        this.setStyles();
        this.onResized({ size });
    }
    /**
     * @param {?} $event
     * @return {?}
     */
    onReizing($event) {
        this.updatePanelSize($event);
        // console.log($event);
        this.resizing.emit({ target: this, size: $event.size });
    }
    /**
     * @private
     * @param {?} $event
     * @return {?}
     */
    updatePanelSize($event) {
        if (this.region === 'south') {
            this.render2.setStyle(this.panel.nativeElement, 'top', 0);
        }
        if (this.region === 'east') {
            this.render2.setStyle(this.panel.nativeElement, 'left', 0);
        }
        if (this.region === 'south' || this.region === 'north') {
            this.render2.setStyle(this.el.nativeElement, 'height', $event.size.height + 'px');
        }
        if (this.region === 'west' || this.region === 'east') {
            this.render2.setStyle(this.el.nativeElement, 'width', $event.size.width + 'px');
        }
    }
    /**
     * @param {?} $event
     * @return {?}
     */
    onResized($event) {
        if (this.region === 'south' || this.region === 'north') {
            this.height = $event.size.height;
        }
        if (this.region === 'west' || this.region === 'east') {
            this.width = $event.size.width;
        }
        this.updatePanelSize($event);
        this.layout.setPanelMaxSize();
        this.resized.emit($event.size);
        this.layout.getPanel('center').resized.emit($event.size);
    }
}
LayoutPanelComponent.decorators = [
    { type: Component, args: [{
                selector: 'layout-panel',
                template: `
        <div #panel #ngResizable class="layout-panel"
            [ngResizable]="split" [attr.region]="region"
            [rzHandles]="rzHandler"
            [rzMinWidth]="minWidth"
            [rzMaxWidth]="maxWidth"
            [rzMinHeight]="minHeight"
            [rzMaxHeight]="maxHeight"
            (rzResizing)="onReizing($event)"
            (rzStop) = "onResized($event)"
            (rzStart) ="onResizeStart($event)" >

            <layout-panel-title *ngIf="title" [title]="title"></layout-panel-title>

            <ng-content></ng-content>
        <div>
    `,
                styles: [".layout-border{border:1px solid #f2f2f2}.layout-panel{background:#fff}.ng-resizeable-bar{position:relative}.ng-resizable-w>.ng-resizeable-bar{right:1px;height:100%;width:5px}.ng-resizable-e>.ng-resizeable-bar{left:3px;height:100%;width:5px}.ng-resizable-s>.ng-resizeable-bar{top:3px;width:100%;height:5px}.ng-resizable-n>.ng-resizeable-bar{bottom:0;width:100%;height:5px}.ng-resizable-handle:hover>.ng-resizeable-bar{background-color:#bababa}.ng-resizable-handle:active>.ng-resizeable-bar{background-color:#5b5b5b}:host{padding:0}"]
            }] }
];
/** @nocollapse */
LayoutPanelComponent.ctorParameters = () => [
    { type: ElementRef },
    { type: Renderer2 },
    { type: LayoutComponent },
    { type: NgZone }
];
LayoutPanelComponent.propDecorators = {
    region: [{ type: Input }],
    height: [{ type: Input }],
    width: [{ type: Input }],
    minHeight: [{ type: Input }],
    minWidth: [{ type: Input }],
    maxHeight: [{ type: Input }],
    maxWidth: [{ type: Input }],
    title: [{ type: Input }],
    iconCls: [{ type: Input }],
    overflow: [{ type: Input }],
    split: [{ type: Input }],
    showBorder: [{ type: Input }],
    resizing: [{ type: Output }],
    resized: [{ type: Output }],
    panel: [{ type: ViewChild, args: ['panel',] }],
    ngResizable: [{ type: ViewChild, args: [AngularResizableDirective,] }]
};
if (false) {
    /** @type {?} */
    LayoutPanelComponent.prototype.region;
    /** @type {?} */
    LayoutPanelComponent.prototype.height;
    /** @type {?} */
    LayoutPanelComponent.prototype.width;
    /** @type {?} */
    LayoutPanelComponent.prototype.minHeight;
    /** @type {?} */
    LayoutPanelComponent.prototype.minWidth;
    /** @type {?} */
    LayoutPanelComponent.prototype.maxHeight;
    /** @type {?} */
    LayoutPanelComponent.prototype.maxWidth;
    /** @type {?} */
    LayoutPanelComponent.prototype.title;
    /** @type {?} */
    LayoutPanelComponent.prototype.iconCls;
    /** @type {?} */
    LayoutPanelComponent.prototype.overflow;
    /**
     * @type {?}
     * @private
     */
    LayoutPanelComponent.prototype._resizable;
    /** @type {?} */
    LayoutPanelComponent.prototype.rzHandler;
    /**
     * @type {?}
     * @private
     */
    LayoutPanelComponent.prototype.bsColClass;
    /** @type {?} */
    LayoutPanelComponent.prototype.showBorder;
    /** @type {?} */
    LayoutPanelComponent.prototype.resizing;
    /** @type {?} */
    LayoutPanelComponent.prototype.resized;
    /** @type {?} */
    LayoutPanelComponent.prototype.panel;
    /** @type {?} */
    LayoutPanelComponent.prototype.ngResizable;
    /** @type {?} */
    LayoutPanelComponent.prototype.el;
    /**
     * @type {?}
     * @private
     */
    LayoutPanelComponent.prototype.render2;
    /**
     * @type {?}
     * @private
     */
    LayoutPanelComponent.prototype.layout;
    /**
     * @type {?}
     * @private
     */
    LayoutPanelComponent.prototype.ngZone;
}
export class LayoutPanelTitleComponent {
    constructor() {
        this.title = '';
        this.iconCls = '';
    }
}
LayoutPanelTitleComponent.decorators = [
    { type: Component, args: [{
                selector: 'layout-panel-title',
                template: `
        <div class="d-flex flex-row" style="height: 28px; line-height: 28px">
            <div class="layout-panel-title">
                <span *ngIf="iconCls" [class]="iconCls"></span>
                {{ title }}
            </div>
            <div class="layout-panel-title-tools flex-fill">

            </div>
        </div>
    `
            }] }
];
LayoutPanelTitleComponent.propDecorators = {
    title: [{ type: Input }],
    iconCls: [{ type: Input }]
};
if (false) {
    /** @type {?} */
    LayoutPanelTitleComponent.prototype.title;
    /** @type {?} */
    LayoutPanelTitleComponent.prototype.iconCls;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibGF5b3V0LXBhbmVsLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BmYXJyaXMvdWktbGF5b3V0LyIsInNvdXJjZXMiOlsibGliL3BhbmVscy9sYXlvdXQtcGFuZWwuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7QUFBQSxPQUFPLEVBQ0gsU0FBUyxFQUFVLEtBQUssRUFBRSxVQUFVLEVBQUUsU0FBUyxFQUFFLFNBQVMsRUFDMUQsTUFBTSxFQUFFLFlBQVksRUFBZ0QsTUFBTSxFQUM3RSxNQUFNLGVBQWUsQ0FBQztBQUN2QixPQUFPLEVBQUUseUJBQXlCLEVBQUUsTUFBTSxzQkFBc0IsQ0FBQztBQUNqRSxPQUFPLEVBQUUsZUFBZSxFQUFFLE1BQU0sdUJBQXVCLENBQUM7QUF1QnhELE1BQU0sT0FBTyxvQkFBb0I7Ozs7Ozs7SUFxRjdCLFlBQW1CLEVBQWMsRUFBVSxPQUFrQixFQUFVLE1BQXVCLEVBQVUsTUFBYztRQUFuRyxPQUFFLEdBQUYsRUFBRSxDQUFZO1FBQVUsWUFBTyxHQUFQLE9BQU8sQ0FBVztRQUFVLFdBQU0sR0FBTixNQUFNLENBQWlCO1FBQVUsV0FBTSxHQUFOLE1BQU0sQ0FBUTtRQWpGN0csY0FBUyxHQUFHLEdBQUcsQ0FBQztRQUNoQixhQUFRLEdBQUcsR0FBRyxDQUFDO1FBR2YsVUFBSyxHQUFHLEVBQUUsQ0FBQztRQUNYLFlBQU8sR0FBRyxFQUFFLENBQUM7UUFDYixhQUFRLEdBQUcsTUFBTSxDQUFDO1FBRW5CLGVBQVUsR0FBRyxJQUFJLENBQUM7UUFFbEIsZUFBVSxHQUFHLEVBQUUsQ0FBQztRQVVmLGVBQVUsR0FBRyxJQUFJLENBQUM7UUFFakIsYUFBUSxHQUFHLElBQUksWUFBWSxFQUFFLENBQUM7UUFDOUIsWUFBTyxHQUFHLElBQUksWUFBWSxFQUFFLENBQUM7SUEwRG1GLENBQUM7Ozs7SUF0RTNILElBQWEsS0FBSztRQUNkLE9BQU8sSUFBSSxDQUFDLFVBQVUsQ0FBQztJQUMzQixDQUFDOzs7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Ozs7SUFDbEIsMENBQXdCOztJQVV4QiwwQ0FBMkI7O0lBRTNCLHdDQUF3Qzs7SUFDeEMsdUNBQXVDOztJQUN2QyxxQ0FBc0M7O0lBQ3RDLDJDQUE2RTs7SUF3RGpFLGtDQUFxQjs7Ozs7SUFBRSx1Q0FBMEI7Ozs7O0lBQUUsc0NBQStCOzs7OztJQUFFLHNDQUFzQjs7QUF1SDFILE1BQU0sT0FBTyx5QkFBeUI7SUFkdEM7UUFlYSxVQUFLLEdBQUcsRUFBRSxDQUFDO1FBQ1gsWUFBTyxHQUFHLEVBQUUsQ0FBQztJQUMxQixDQUFDOzs7WUFqQkEsU0FBUyxTQUFDO2dCQUNQLFFBQVEsRUFBRSxvQkFBb0I7Z0JBQzlCLFFBQVEsRUFBRTs7Ozs7Ozs7OztLQVVUO2FBQ0o7OztvQkFFSSxLQUFLO3NCQUNMLEtBQUs7Ozs7SUFETiwwQ0FBb0I7O0lBQ3BCLDRDQUFzQiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XHJcbiAgICBDb21wb25lbnQsIE9uSW5pdCwgSW5wdXQsIEVsZW1lbnRSZWYsIFJlbmRlcmVyMiwgVmlld0NoaWxkLFxyXG4gICAgT3V0cHV0LCBFdmVudEVtaXR0ZXIsIEluamVjdCwgZm9yd2FyZFJlZiwgU2ltcGxlQ2hhbmdlcywgT25DaGFuZ2VzLCBOZ1pvbmVcclxufSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgQW5ndWxhclJlc2l6YWJsZURpcmVjdGl2ZSB9IGZyb20gJ0BmYXJyaXMvdWktZHJhZ2dhYmxlJztcclxuaW1wb3J0IHsgTGF5b3V0Q29tcG9uZW50IH0gZnJvbSAnLi8uLi9sYXlvdXQuY29tcG9uZW50JztcclxuXHJcbkBDb21wb25lbnQoe1xyXG4gICAgc2VsZWN0b3I6ICdsYXlvdXQtcGFuZWwnLFxyXG4gICAgdGVtcGxhdGU6IGBcclxuICAgICAgICA8ZGl2ICNwYW5lbCAjbmdSZXNpemFibGUgY2xhc3M9XCJsYXlvdXQtcGFuZWxcIlxyXG4gICAgICAgICAgICBbbmdSZXNpemFibGVdPVwic3BsaXRcIiBbYXR0ci5yZWdpb25dPVwicmVnaW9uXCJcclxuICAgICAgICAgICAgW3J6SGFuZGxlc109XCJyekhhbmRsZXJcIlxyXG4gICAgICAgICAgICBbcnpNaW5XaWR0aF09XCJtaW5XaWR0aFwiXHJcbiAgICAgICAgICAgIFtyek1heFdpZHRoXT1cIm1heFdpZHRoXCJcclxuICAgICAgICAgICAgW3J6TWluSGVpZ2h0XT1cIm1pbkhlaWdodFwiXHJcbiAgICAgICAgICAgIFtyek1heEhlaWdodF09XCJtYXhIZWlnaHRcIlxyXG4gICAgICAgICAgICAocnpSZXNpemluZyk9XCJvblJlaXppbmcoJGV2ZW50KVwiXHJcbiAgICAgICAgICAgIChyelN0b3ApID0gXCJvblJlc2l6ZWQoJGV2ZW50KVwiXHJcbiAgICAgICAgICAgIChyelN0YXJ0KSA9XCJvblJlc2l6ZVN0YXJ0KCRldmVudClcIiA+XHJcblxyXG4gICAgICAgICAgICA8bGF5b3V0LXBhbmVsLXRpdGxlICpuZ0lmPVwidGl0bGVcIiBbdGl0bGVdPVwidGl0bGVcIj48L2xheW91dC1wYW5lbC10aXRsZT5cclxuXHJcbiAgICAgICAgICAgIDxuZy1jb250ZW50PjwvbmctY29udGVudD5cclxuICAgICAgICA8ZGl2PlxyXG4gICAgYCxcclxuICAgIHN0eWxlVXJsczogWycuL2xheW91dC1wYW5lbC5jc3MnXVxyXG59KVxyXG5leHBvcnQgY2xhc3MgTGF5b3V0UGFuZWxDb21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQsIE9uQ2hhbmdlcyB7XHJcbiAgICBASW5wdXQoKSByZWdpb246IHN0cmluZztcclxuICAgIEBJbnB1dCgpIGhlaWdodDogbnVtYmVyO1xyXG4gICAgQElucHV0KCkgd2lkdGg6IG51bWJlcjtcclxuICAgIEBJbnB1dCgpIG1pbkhlaWdodCA9IDEwMDtcclxuICAgIEBJbnB1dCgpIG1pbldpZHRoID0gMTAwO1xyXG4gICAgQElucHV0KCkgbWF4SGVpZ2h0OiBudW1iZXI7XHJcbiAgICBASW5wdXQoKSBtYXhXaWR0aDogbnVtYmVyO1xyXG4gICAgQElucHV0KCkgdGl0bGUgPSAnJztcclxuICAgIEBJbnB1dCgpIGljb25DbHMgPSAnJztcclxuICAgIEBJbnB1dCgpIG92ZXJmbG93ID0gJ2F1dG8nO1xyXG5cclxuICAgIHByaXZhdGUgX3Jlc2l6YWJsZSA9IHRydWU7XHJcbiAgICByekhhbmRsZXI6IHN0cmluZztcclxuICAgIHByaXZhdGUgYnNDb2xDbGFzcyA9ICcnO1xyXG4gICAgQElucHV0KCkgZ2V0IHNwbGl0KCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9yZXNpemFibGU7XHJcbiAgICB9XHJcblxyXG4gICAgc2V0IHNwbGl0KHZhbDogYm9vbGVhbikge1xyXG4gICAgICAgIHRoaXMuX3Jlc2l6YWJsZSA9IHZhbDtcclxuICAgIH1cclxuXHJcblxyXG4gICAgQElucHV0KCkgc2hvd0JvcmRlciA9IHRydWU7XHJcblxyXG4gICAgQE91dHB1dCgpIHJlc2l6aW5nID0gbmV3IEV2ZW50RW1pdHRlcigpO1xyXG4gICAgQE91dHB1dCgpIHJlc2l6ZWQgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XHJcbiAgICBAVmlld0NoaWxkKCdwYW5lbCcpIHBhbmVsOiBFbGVtZW50UmVmO1xyXG4gICAgQFZpZXdDaGlsZChBbmd1bGFyUmVzaXphYmxlRGlyZWN0aXZlKSBuZ1Jlc2l6YWJsZTogQW5ndWxhclJlc2l6YWJsZURpcmVjdGl2ZTtcclxuXHJcbiAgICBwcml2YXRlIHNldFN0eWxlcygpIHtcclxuICAgICAgICAvLyB0aGlzLm5nWm9uZS5ydW5PdXRzaWRlQW5ndWxhcigoKSA9PiB7XHJcbiAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgbGV0IHdpZHRoLCBoZWlnaHQ7XHJcbiAgICAgICAgICAgICAgICBjb25zdCByZWN0ID0gdGhpcy5lbC5uYXRpdmVFbGVtZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmhlaWdodCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGhlaWdodCA9IHRoaXMuaGVpZ2h0O1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyMi5zZXRTdHlsZSh0aGlzLmVsLm5hdGl2ZUVsZW1lbnQsICdoZWlnaHQnLCBoZWlnaHQgKyAncHgnKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbmRlcjIuc2V0U3R5bGUodGhpcy5wYW5lbC5uYXRpdmVFbGVtZW50LCAnaGVpZ2h0JywgaGVpZ2h0ICsgJ3B4Jyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy53aWR0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHdpZHRoID0gdGhpcy53aWR0aDtcclxuICAgICAgICAgICAgICAgICAgICBpZiAocmVjdC53aWR0aCA+IHRoaXMud2lkdGgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGggPSByZWN0LndpZHRoO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLndpZHRoID0gd2lkdGg7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyMi5zZXRTdHlsZSh0aGlzLmVsLm5hdGl2ZUVsZW1lbnQsICd3aWR0aCcsIHdpZHRoICsgJ3B4Jyk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW5kZXIyLnNldFN0eWxlKHRoaXMucGFuZWwubmF0aXZlRWxlbWVudCwgJ3dpZHRoJywgd2lkdGggKyAncHgnKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZXNldEZsZXgoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgLy8gfSk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBnZXRyekhhbmRsZXIoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMucmVnaW9uKSB7XHJcbiAgICAgICAgICAgIGxldCByemRpciA9ICcnO1xyXG4gICAgICAgICAgICBzd2l0Y2ggKHRoaXMucmVnaW9uKSB7XHJcbiAgICAgICAgICAgICAgICBjYXNlICd3ZXN0JzpcclxuICAgICAgICAgICAgICAgICAgICByemRpciA9ICdlJztcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgJ2Vhc3QnOlxyXG4gICAgICAgICAgICAgICAgICAgIHJ6ZGlyID0gJ3cnO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSAnbm9ydGgnOlxyXG4gICAgICAgICAgICAgICAgICAgIHJ6ZGlyID0gJ3MnO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSAnc291dGgnOlxyXG4gICAgICAgICAgICAgICAgICAgIHJ6ZGlyID0gJ24nO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB0aGlzLnJ6SGFuZGxlciA9IHJ6ZGlyO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMucnpIYW5kbGVyID0gJyc7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGlzQ2VudGVyUGFuZWwoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMucmVnaW9uID09PSAnY2VudGVyJztcclxuICAgIH1cclxuXHJcbiAgICBjb25zdHJ1Y3RvcihwdWJsaWMgZWw6IEVsZW1lbnRSZWYsIHByaXZhdGUgcmVuZGVyMjogUmVuZGVyZXIyLCBwcml2YXRlIGxheW91dDogTGF5b3V0Q29tcG9uZW50LCBwcml2YXRlIG5nWm9uZTogTmdab25lKSB7IH1cclxuXHJcbiAgICBuZ09uQ2hhbmdlcyhjaGFuZ2VzOiBTaW1wbGVDaGFuZ2VzKSB7XHJcbiAgICAgICAgaWYgKGNoYW5nZXMud2lkdGggJiYgIWNoYW5nZXMud2lkdGguaXNGaXJzdENoYW5nZSgpKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2V0U3R5bGVzKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgZ2V0QnNDbGFzcygpIHtcclxuICAgICAgICByZXR1cm4gQXJyYXkuZnJvbTxzdHJpbmc+KHRoaXMuZWwubmF0aXZlRWxlbWVudC5jbGFzc0xpc3QpLmZpbmQoKGM6IHN0cmluZykgPT4gYy5pbmRleE9mKCdjb2wtJykgPiAtMSk7XHJcbiAgICB9XHJcbiAgICBwcml2YXRlIGhhc0JzQ2xhc3MoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0QnNDbGFzcygpICE9PSB1bmRlZmluZWQ7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBpbml0U2l6ZSgpIHtcclxuICAgICAgICB0aGlzLnNldFN0eWxlcygpO1xyXG5cclxuICAgICAgICBpZiAodGhpcy5yZWdpb24pIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMucmVnaW9uID09PSAnd2VzdCcgfHwgdGhpcy5yZWdpb24gPT09ICdlYXN0Jykge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5yZW5kZXIyLnNldFN0eWxlKHRoaXMucGFuZWwubmF0aXZlRWxlbWVudCwgJ2hlaWdodCcsICcxMDAlJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBpbml0Q2xhc3MoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuaXNDZW50ZXJQYW5lbCgpKSB7XHJcbiAgICAgICAgICAgIHRoaXMucmVuZGVyMi5hZGRDbGFzcyh0aGlzLnBhbmVsLm5hdGl2ZUVsZW1lbnQsIHRoaXMub3ZlcmZsb3cgPT0gJ2F1dG8nID8nZmxleC1maWxsJzogJ2YtdXRpbHMtZmlsbCcpO1xyXG4gICAgICAgICAgICBpZiAodGhpcy5lbC5uYXRpdmVFbGVtZW50LnBhcmVudEVsZW1lbnQuYXR0cmlidXRlc1snbGF5b3V0LXBhbmVsJ10pIHtcclxuICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyMi5hZGRDbGFzcyh0aGlzLmVsLm5hdGl2ZUVsZW1lbnQucGFyZW50RWxlbWVudCwgJ2QtZmxleCcpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB0aGlzLnJlbmRlcjIuYWRkQ2xhc3ModGhpcy5lbC5uYXRpdmVFbGVtZW50LCAnZC1mbGV4Jyk7XHJcbiAgICAgICAgICAgIHRoaXMucmVuZGVyMi5hZGRDbGFzcyh0aGlzLmVsLm5hdGl2ZUVsZW1lbnQsICdmLXV0aWxzLWZpbGwnKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICh0aGlzLnNob3dCb3JkZXIpIHtcclxuICAgICAgICAgICAgdGhpcy5yZW5kZXIyLmFkZENsYXNzKHRoaXMucGFuZWwubmF0aXZlRWxlbWVudCwgJ2xheW91dC1ib3JkZXInKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgbmdPbkluaXQoKSB7XHJcbiAgICAgICAgdGhpcy5pbml0U2l6ZSgpO1xyXG4gICAgICAgIHRoaXMuaW5pdENsYXNzKCk7XHJcbiAgICAgICAgdGhpcy5nZXRyekhhbmRsZXIoKTtcclxuXHJcbiAgICAgICAgdGhpcy5ic0NvbENsYXNzID0gdGhpcy5nZXRCc0NsYXNzKCk7XHJcblxyXG4gICAgICAgIHRoaXMubGF5b3V0LnBhbmVscy5wdXNoKHRoaXMpO1xyXG4gICAgfVxyXG5cclxuICAgIG9uUmVzaXplU3RhcnQoJGV2ZW50OiBhbnkpIHtcclxuICAgICAgICB0aGlzLnJlc2V0RmxleCgpO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgcmVzZXRGbGV4KCkge1xyXG4gICAgICAgIGlmICh0aGlzLnJlZ2lvbiA9PT0gJ3dlc3QnIHx8IHRoaXMucmVnaW9uID09PSAnZWFzdCcpIHtcclxuICAgICAgICAgICAgdGhpcy5yZW5kZXIyLnNldFN0eWxlKHRoaXMuZWwubmF0aXZlRWxlbWVudCwgJ2ZsZXgnLCAnbm9uZScpO1xyXG4gICAgICAgICAgICB0aGlzLnJlbmRlcjIuc2V0U3R5bGUodGhpcy5lbC5uYXRpdmVFbGVtZW50LCAnbWF4LXdpZHRoJywgJ25vbmUnKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcmVzaXplKHNpemU6IHsgd2lkdGg/OiBudW1iZXIsIGhlaWdodD86IG51bWJlciB9KSB7XHJcbiAgICAgICAgdGhpcy5zZXRTdHlsZXMoKTtcclxuICAgICAgICB0aGlzLm9uUmVzaXplZCh7IHNpemUgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgb25SZWl6aW5nKCRldmVudDogYW55KSB7XHJcbiAgICAgICAgdGhpcy51cGRhdGVQYW5lbFNpemUoJGV2ZW50KTtcclxuICAgICAgICAvLyBjb25zb2xlLmxvZygkZXZlbnQpO1xyXG4gICAgICAgIHRoaXMucmVzaXppbmcuZW1pdCh7IHRhcmdldDogdGhpcywgc2l6ZTogJGV2ZW50LnNpemUgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSB1cGRhdGVQYW5lbFNpemUoJGV2ZW50OiBhbnkpIHtcclxuICAgICAgICBpZiAodGhpcy5yZWdpb24gPT09ICdzb3V0aCcpIHtcclxuICAgICAgICAgICAgdGhpcy5yZW5kZXIyLnNldFN0eWxlKHRoaXMucGFuZWwubmF0aXZlRWxlbWVudCwgJ3RvcCcsIDApO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy5yZWdpb24gPT09ICdlYXN0Jykge1xyXG4gICAgICAgICAgICB0aGlzLnJlbmRlcjIuc2V0U3R5bGUodGhpcy5wYW5lbC5uYXRpdmVFbGVtZW50LCAnbGVmdCcsIDApO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy5yZWdpb24gPT09ICdzb3V0aCcgfHwgdGhpcy5yZWdpb24gPT09ICdub3J0aCcpIHtcclxuICAgICAgICAgICAgdGhpcy5yZW5kZXIyLnNldFN0eWxlKHRoaXMuZWwubmF0aXZlRWxlbWVudCwgJ2hlaWdodCcsICRldmVudC5zaXplLmhlaWdodCArICdweCcpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy5yZWdpb24gPT09ICd3ZXN0JyB8fCB0aGlzLnJlZ2lvbiA9PT0gJ2Vhc3QnKSB7XHJcbiAgICAgICAgICAgIHRoaXMucmVuZGVyMi5zZXRTdHlsZSh0aGlzLmVsLm5hdGl2ZUVsZW1lbnQsICd3aWR0aCcsICRldmVudC5zaXplLndpZHRoICsgJ3B4Jyk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIG9uUmVzaXplZCgkZXZlbnQ6IGFueSkge1xyXG4gICAgICAgIGlmICh0aGlzLnJlZ2lvbiA9PT0gJ3NvdXRoJyB8fCB0aGlzLnJlZ2lvbiA9PT0gJ25vcnRoJykge1xyXG4gICAgICAgICAgICB0aGlzLmhlaWdodCA9ICRldmVudC5zaXplLmhlaWdodDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICh0aGlzLnJlZ2lvbiA9PT0gJ3dlc3QnIHx8IHRoaXMucmVnaW9uID09PSAnZWFzdCcpIHtcclxuICAgICAgICAgICAgdGhpcy53aWR0aCA9ICRldmVudC5zaXplLndpZHRoO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy51cGRhdGVQYW5lbFNpemUoJGV2ZW50KTtcclxuXHJcbiAgICAgICAgdGhpcy5sYXlvdXQuc2V0UGFuZWxNYXhTaXplKCk7XHJcbiAgICAgICAgdGhpcy5yZXNpemVkLmVtaXQoJGV2ZW50LnNpemUpO1xyXG4gICAgICAgIHRoaXMubGF5b3V0LmdldFBhbmVsKCdjZW50ZXInKS5yZXNpemVkLmVtaXQoJGV2ZW50LnNpemUpO1xyXG4gICAgfVxyXG59XHJcblxyXG5AQ29tcG9uZW50KHtcclxuICAgIHNlbGVjdG9yOiAnbGF5b3V0LXBhbmVsLXRpdGxlJyxcclxuICAgIHRlbXBsYXRlOiBgXHJcbiAgICAgICAgPGRpdiBjbGFzcz1cImQtZmxleCBmbGV4LXJvd1wiIHN0eWxlPVwiaGVpZ2h0OiAyOHB4OyBsaW5lLWhlaWdodDogMjhweFwiPlxyXG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwibGF5b3V0LXBhbmVsLXRpdGxlXCI+XHJcbiAgICAgICAgICAgICAgICA8c3BhbiAqbmdJZj1cImljb25DbHNcIiBbY2xhc3NdPVwiaWNvbkNsc1wiPjwvc3Bhbj5cclxuICAgICAgICAgICAgICAgIHt7IHRpdGxlIH19XHJcbiAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwibGF5b3V0LXBhbmVsLXRpdGxlLXRvb2xzIGZsZXgtZmlsbFwiPlxyXG5cclxuICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgPC9kaXY+XHJcbiAgICBgXHJcbn0pXHJcbmV4cG9ydCBjbGFzcyBMYXlvdXRQYW5lbFRpdGxlQ29tcG9uZW50IHtcclxuICAgIEBJbnB1dCgpIHRpdGxlID0gJyc7XHJcbiAgICBASW5wdXQoKSBpY29uQ2xzID0gJyc7XHJcbn1cclxuIl19