/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { ChangeDetectorRef, Component, EventEmitter, HostBinding, Injector, Input, Output, ViewEncapsulation, HostListener, ViewChild, ElementRef } from '@angular/core';
import { LocaleService } from '@farris/ui-locale';
import { MessagerService } from '@farris/ui-messager';
import { getMultilingualValue } from '../getValueWithLocaleId';
import { NotifyService } from '@farris/ui-notify';
import { ColumnTreeComponent } from '../multi-headers/column-tree.component';
import { mergeSortInfo, multiHeadersHasDataFields, reset2DefaultForMultiHeaders } from '../mutli-headers.helper';
import { cloneDeep } from 'lodash-es';
export class SimpleColumnsComponent {
    /**
     * @param {?} injector
     * @param {?} cd
     */
    constructor(injector, cd) {
        this.injector = injector;
        this.cd = cd;
        this.enableScheme = false;
        this.seartTypes = [];
        /**
         * 所有列
         */
        this.columns = [];
        /**
         * 显示的列
         */
        this.fields = [];
        /**
         * 点击侧边样式以外的区域隐藏面板。默认为 true
         */
        this.clickToHidden = true;
        this.top = 0;
        this._schemeList = [];
        this.cls = 'f-datagrid-settings-simple-host';
        this.formatChange = new EventEmitter();
        this.fieldsChange = new EventEmitter();
        this.submit = new EventEmitter();
        /**
         * 分组表头确定事件
         */
        this.submitForGroupHeader = new EventEmitter();
        this.closed = new EventEmitter();
        this.advanced = new EventEmitter();
        this.canceld = new EventEmitter();
        this.addNewScheme = new EventEmitter();
        this.showSchemeList = new EventEmitter();
        this.activeItemChange = new EventEmitter();
        this.schemeChanged = new EventEmitter();
        this.allCols = [];
        this.columnType = 'all';
        this.isEn = false;
        this.showSchemePanel = false;
        this.switchValue = false;
        // 当前方案
        this.currentSchemeItem = null;
        this.searchResultIsVisibleAll = { checkAll: false, unCheckAll: false };
        this.defaultSchemeName = '系统预制';
        /**
         * 配置多表头相关设置
         */
        this.multiHeaderOptions = {};
        // 启用多表头
        this.enableMultipleHeaders = false;
        this.prevSchemeItem = null;
        this.settings = {};
        this.schemeSer = null;
        this.noDisplyColumnTip = '';
        this.localeSer = this.injector.get(LocaleService, null);
        this.messager = this.injector.get(MessagerService, null);
        this.notify = this.injector.get(NotifyService, null);
        this.noDisplyColumnTip = this.localeSer.getValue('datagrid-scheme.noDisplyColumnTip');
    }
    /**
     * @return {?}
     */
    get schemeList() {
        return this._schemeList;
    }
    /**
     * @param {?} val
     * @return {?}
     */
    set schemeList(val) {
        if (val && val.length) {
            val = val.filter((/**
             * @param {?} n
             * @return {?}
             */
            n => {
                return JSON.parse(n.name)[this.localeSer.localeId];
            })); // 仅获取当前语言的方案
            val.forEach((/**
             * @param {?} n
             * @return {?}
             */
            n => {
                n['_title_'] = getMultilingualValue(JSON.parse(n.name), this.localeSer.localeId);
                if (this.currentSchemeItem && n.id === this.currentSchemeItem.id) {
                    this.currentSchemeItem['_title_'] = n['_title_'];
                }
            }));
        }
        this._schemeList = val || [];
    }
    /**
     * @param {?} $event
     * @return {?}
     */
    onClick($event) {
        $event.stopPropagation();
        /** @type {?} */
        const clsname = $event.target['className'] || '';
        if (clsname.indexOf('f-datagrid-settings-simple-host') > -1) {
            // 隐藏侧边栏；
            if (this.clickToHidden) {
                this.cancel();
            }
        }
        this.showSchemePanel = false;
    }
    /**
     * @param {?} $event
     * @return {?}
     */
    onEscKeydown($event) {
        $event.stopPropagation();
        if (!document.querySelector('modal-container')) {
            this.close();
        }
    }
    /**
     * @param {?} $event
     * @return {?}
     */
    onEnterKeydown($event) {
        $event.stopPropagation();
        if (!document.querySelector('modal-container')) {
            this.onSubmitClick();
        }
    }
    /**
     * @param {?} $event
     * @return {?}
     */
    onControlGKeydown($event) {
        if ($event.ctrlKey && !document.querySelector('modal-container')) {
            /** @type {?} */
            const _key = $event.key.toLowerCase();
            if (['g', 'r', 's'].includes(_key)) {
                $event.preventDefault();
                $event.stopPropagation();
            }
            if (_key === 'g') {
                this.showAdvanced($event);
            }
            else if (_key === 'r') {
                this.onSettingReset();
            }
            else if (_key === 's') {
                this.searchInput.nativeElement.focus();
            }
        }
    }
    /**
     * @private
     * @return {?}
     */
    getCurrentSchemeSettings() {
        if (this.currentSchemeItem && this.currentSchemeItem.queryConditionString) {
            /** @type {?} */
            const schemeSettings = JSON.parse(this.currentSchemeItem.queryConditionString);
            return (/** @type {?} */ (schemeSettings[this.localeSer.localeId]));
        }
        return null;
    }
    /**
     * @return {?}
     */
    ngOnInit() {
        // 判断是否启用多表头列设置
        this.enableMultipleHeaders = this.gridInstance.enableSetMultiHeaders;
        // const options = this.gridInstance.dfs['_state'].initialOptions;
        // if (options.columnFields && options.columnFields.length) {
        //     this.allCols = options.columnFields.filter((f: any) => f.field !== '_datagrid-setting-control_');
        // } else {
        //     this.allCols = this.columns[0];
        // }
        this.allCols = this.columns[0];
        if (this.gridInstance.enableScheme) {
            if (!this.prevSchemeItem) {
                this.prevSchemeItem = cloneDeep(this.currentSchemeItem);
            }
            if (this.currentSchemeItem) {
                this.settings = this.getCurrentSchemeSettings() || {};
            }
            else {
                if (!this.settings || !Object.keys(this.settings).length) {
                    this._reset2Default();
                }
            }
        }
        const { multiHeaders } = this.settings;
        this.multiHeaderOptions = { columns: this.columns, treeData: multiHeaders ? multiHeaders.treeData : null };
        if (!this.enableMultipleHeaders) {
            if (this.settings && this.settings.viewColumns) {
                this.fields = this.settings.viewColumns.filter((/**
                 * @param {?} n
                 * @return {?}
                 */
                n => n != '_datagrid-setting-control_'));
                this.dirtySettings(true);
            }
            else {
                this.fields = this.getViewColumns();
            }
        }
        this.container.nativeElement.focus();
        this.searchResultIsVisibleAll = this.seachResultIsCheckAll();
        this.defaultSchemeName = this.localeSer.getValue('datagrid-scheme.syspreset') || this.gridInstance.defaultSchemeName;
        if (this.schemeSer) {
            if (this.settings && !Object.keys(this.settings).length) {
                if (this.gridInstance.enableScheme) {
                    this.resetToDefault();
                }
                else {
                    this.settings = this.getCurrentSettings();
                }
            }
            this.schemeSer.setSettings(this.settings);
            this.defaultSettings();
        }
    }
    /**
     * @return {?}
     */
    ngAfterViewInit() {
        // console.log(this.fields);
    }
    /**
     * @private
     * @return {?}
     */
    getViewColumns() {
        // 多表头
        /** @type {?} */
        let visibleCls = [];
        if (this.columns.length > 1) {
            this.columns.forEach((/**
             * @param {?} cols
             * @return {?}
             */
            cols => {
                visibleCls = visibleCls.concat(this._getViewColumns(cols));
            }));
        }
        else {
            visibleCls = this.columns[0].filter((/**
             * @param {?} n
             * @return {?}
             */
            n => (n.visible || n.visible === undefined)));
        }
        return visibleCls.map((/**
         * @param {?} n
         * @return {?}
         */
        n => n.field));
    }
    /**
     * @private
     * @param {?} cols
     * @return {?}
     */
    _getViewColumns(cols) {
        return cols.filter((/**
         * @param {?} c
         * @return {?}
         */
        c => !c.colspan && (c.visible || c.visible === undefined)));
    }
    // 根据列的类型进行筛选过滤，
    // all 所有列
    // visible 可见列
    // hidden 隐藏列
    // group 分组列
    /**
     * @param {?=} searchWords
     * @return {?}
     */
    filterColumns(searchWords = '') {
        /** @type {?} */
        let cols = [];
        if (this.switchValue) {
            cols = this.columns[0].filter((/**
             * @param {?} n
             * @return {?}
             */
            n => this.fields.indexOf(n.field) > -1));
        }
        else {
            cols = this.columns[0];
        }
        if (searchWords) {
            cols = cols.filter((/**
             * @param {?} c
             * @return {?}
             */
            c => c.title.toLowerCase().indexOf(searchWords.toLowerCase()) > -1));
        }
        this.allCols = cols;
        this.searchResultIsVisibleAll = this.seachResultIsCheckAll(this.allCols.filter((/**
         * @param {?} n
         * @return {?}
         */
        n => n.visible)));
    }
    /**
     * @private
     * @param {?=} searchFields
     * @return {?}
     */
    seachResultIsCheckAll(searchFields) {
        /** @type {?} */
        const allColsLength = this.allCols.filter((/**
         * @param {?} n
         * @return {?}
         */
        n => n.field != '_datagrid-setting-control_')).length;
        /** @type {?} */
        let fieldsLength = this.fields.filter((/**
         * @param {?} n
         * @return {?}
         */
        n => n != '_datagrid-setting-control_')).length;
        if (searchFields) {
            fieldsLength = searchFields.length;
        }
        return {
            checkAll: allColsLength && allColsLength === fieldsLength,
            unCheckAll: !searchFields ? !this.fields.length : !fieldsLength
        };
    }
    /**
     * @private
     * @return {?}
     */
    onFieldsChanged() {
        if (!this.gridInstance.enableScheme) {
            this.fieldsChange.emit(this.fields);
        }
    }
    /**
     * @param {?} $event
     * @param {?} col
     * @return {?}
     */
    onDblClick($event, col) {
        this.onCheckboxClick($event, col);
    }
    /**
     * @param {?} $event
     * @param {?} col
     * @return {?}
     */
    onCheckboxClick($event, col) {
        $event.stopPropagation();
        this.showSchemePanel = false;
        /** @type {?} */
        let checked = false;
        /** @type {?} */
        const index = this.fields.indexOf(col.field);
        if (index === -1) {
            this.fields.push(col.field);
            checked = true;
        }
        else {
            this.fields.splice(index, 1);
            checked = false;
        }
        this.columns[0].forEach((/**
         * @param {?} f
         * @return {?}
         */
        f => {
            f.visible = this.fields.indexOf(f.field) > -1;
        }));
        this.fields = this.columns[0].filter((/**
         * @param {?} n
         * @return {?}
         */
        n => n.visible)).map((/**
         * @param {?} n
         * @return {?}
         */
        n => n.field));
        /** @type {?} */
        const _fields = this.allCols.filter((/**
         * @param {?} n
         * @return {?}
         */
        n => n.visible)).map((/**
         * @param {?} n
         * @return {?}
         */
        n => n.field));
        this.searchResultIsVisibleAll = this.seachResultIsCheckAll(_fields);
        this.dirtySettings(true);
        this.onFieldsChanged();
    }
    /**
     * @param {?} $event
     * @return {?}
     */
    searchColumn($event) {
        this.switchValue = false;
        /** @type {?} */
        const txt = $event.target.value;
        this.filterColumns(txt);
    }
    /**
     * @param {?} fieldInfo
     * @param {?} txt
     * @param {?} ulElRef
     * @return {?}
     */
    onFieldDrop(fieldInfo, txt, ulElRef) {
        this.showSchemePanel = false;
        const { removedIndex, addedIndex } = fieldInfo;
        /** @type {?} */
        const moveItem = this.allCols[removedIndex];
        /** @type {?} */
        const targetItem = this.allCols[addedIndex];
        /** @type {?} */
        const moveItemIndex = this.columns[0].findIndex((/**
         * @param {?} n
         * @return {?}
         */
        n => n.field === moveItem.field));
        /** @type {?} */
        const targetItemIndex = this.columns[0].findIndex((/**
         * @param {?} n
         * @return {?}
         */
        n => n.field === targetItem.field));
        /** @type {?} */
        const removedItem = this.columns[0].splice(moveItemIndex, 1);
        this.columns[0].splice(targetItemIndex, 0, ...removedItem);
        this.fields = this.columns[0].filter((/**
         * @param {?} n
         * @return {?}
         */
        n => n.visible)).map((/**
         * @param {?} n
         * @return {?}
         */
        n => n.field));
        this.onFieldsChanged();
        this.filterColumns(txt);
    }
    /**
     * 0: 1个也没有选中； 1: 全部选中； 2: 有选中的也有没选中的
     * @private
     * @return {?}
     */
    getCheckAllState() {
        if (!this.searchInput.nativeElement.value) {
            if (this.fields.length === 0) {
                return 0;
            }
            else {
                if (this.fields.length === this.columns[0].length) {
                    return 1;
                }
                return 2;
            }
        }
        else {
            /** @type {?} */
            const visibleLen = this.allCols.filter((/**
             * @param {?} n
             * @return {?}
             */
            n => n.visible)).length;
            if (visibleLen === this.allCols.length) {
                return 1;
            }
            else {
                if (visibleLen < this.allCols.length) {
                    if (visibleLen === 0) {
                        return 0;
                    }
                    return 1;
                }
            }
        }
    }
    // 全选
    /**
     * @param {?} $event
     * @param {?} txt
     * @return {?}
     */
    onCheckAllClick($event, txt) {
        $event.stopPropagation();
        if (!this.allCols || !this.allCols.length) {
            return;
        }
        this.showSchemePanel = false;
        /** @type {?} */
        const state = this.getCheckAllState();
        /** @type {?} */
        const isCheckAll = state === 0 || state === 2;
        /** @type {?} */
        let _fields = null;
        if (!txt) {
            this.columns[0].forEach((/**
             * @param {?} n
             * @return {?}
             */
            n => n.visible = isCheckAll));
        }
        else {
            this.columns[0].forEach((/**
             * @param {?} n
             * @return {?}
             */
            n => {
                /** @type {?} */
                const item = this.allCols.find((/**
                 * @param {?} a
                 * @return {?}
                 */
                a => n.field == a.field));
                if (item) {
                    n.visible = isCheckAll;
                    item.visible = isCheckAll;
                }
            }));
            _fields = this.allCols.filter((/**
             * @param {?} n
             * @return {?}
             */
            n => n.visible)).map((/**
             * @param {?} n
             * @return {?}
             */
            n => n.field));
        }
        this.fields = this.columns[0].filter((/**
         * @param {?} n
         * @return {?}
         */
        n => n.visible)).map((/**
         * @param {?} n
         * @return {?}
         */
        n => n.field));
        this.searchResultIsVisibleAll = this.seachResultIsCheckAll(!txt ? null : _fields);
        this.dirtySettings(true);
        this.cd.detectChanges();
        this.onFieldsChanged();
        // this.filterColumns(txt);
    }
    /**
     * @param {?=} $event
     * @return {?}
     */
    close($event) {
        if ($event) {
            $event.stopPropagation();
        }
        this.closed.emit();
    }
    /**
     * @param {?=} $event
     * @return {?}
     */
    cancel($event) {
        this.currentSchemeItem = this.prevSchemeItem;
        // this.schemeChanged.emit(this.prevSchemeItem);
        this.close($event);
        this.canceld.emit();
    }
    // 打开高级设置窗口
    /**
     * @param {?} $event
     * @return {?}
     */
    showAdvanced($event) {
        this.close($event);
        this.settings = this.getCurrentSettings();
        if (this.enableMultipleHeaders) {
            if (this.multiHeaderRef) {
                this.settings.multiHeaders = this.multiHeaderRef.getSettings();
            }
        }
        this.advanced.emit({ viewFields: this.fields, settings: this.settings, columns: this.columns });
    }
    // 恢复默认
    /**
     * @param {?=} $event
     * @return {?}
     */
    onSettingReset($event) {
        if ($event) {
            $event.stopPropagation();
        }
        this.showSchemePanel = false;
        /** @type {?} */
        const restorDefaultText = this.localeSer.getValue('datagrid.settings.restoreDefaultSettingsText') || '您确定要恢复默认设置吗？';
        this.messager.confirm(restorDefaultText, 2035).subscribe((/**
         * @param {?} t
         * @return {?}
         */
        (t) => {
            if (t) {
                this.resetToDefault();
                this.dirtySettings(true);
                this.searchResultIsVisibleAll = this.seachResultIsCheckAll();
            }
        }));
    }
    /**
     * @return {?}
     */
    resetToDefault() {
        if (this.enableMultipleHeaders) {
            this._reset2DefalutFormMultiHeaders();
        }
        else {
            this._reset2Default();
        }
    }
    /**
     * @private
     * @return {?}
     */
    _reset2DefalutFormMultiHeaders() {
        const { settings, multiHeaderOptions } = reset2DefaultForMultiHeaders(this.gridInstance);
        this.settings = settings,
            this.multiHeaderOptions = multiHeaderOptions;
    }
    /**
     * @private
     * @return {?}
     */
    _reset2Default() {
        /** @type {?} */
        const options = this.gridInstance.dfs['_state'].initialOptions;
        if (options.columnFields && options.columnFields.length) {
            /** @type {?} */
            const newColumns = [];
            options.columnFields.forEach((/**
             * @param {?} c
             * @return {?}
             */
            c => {
                if (c.field !== '_datagrid-setting-control_') {
                    /** @type {?} */
                    const col = this.columns[0].find((/**
                     * @param {?} n
                     * @return {?}
                     */
                    (n) => n.field === c.field));
                    if (col) {
                        col.visible = c.visible;
                        col.halign = c.halign;
                        col.align = c.align;
                        col.width = c.width;
                        col.footer = Object.assign({}, c.footer || {});
                        col.groupFooter = Object.assign({}, c.groupFooter || {});
                        col.title = c.title;
                        col.fixed = c.fixed || '';
                        newColumns.push(col);
                    }
                }
            }));
            this.columns = [newColumns];
        }
        this.allCols = this.columns[0];
        this.settings = {};
        this.fields = this.getViewColumns();
        this.settings.viewColumns = this.fields;
        this.settings.columnFormat = [...this.columns[0]];
        if (options.sort) {
            /** @type {?} */
            const sortOrders = options.sort.sortOrder ? options.sort.sortOrder.split(',') : [];
            /** @type {?} */
            const sortNames = options.sort.sortName ? options.sort.sortName.split(',') : [];
            this.settings.sortInfo = { sortName: sortNames, sortOrder: sortOrders };
        }
        else {
            this.settings.sortInfo = {};
        }
        this.settings.groupField = options.groupField ? options.groupField.split(',') : [];
        this.settings.expandGroupRows = !!options.expandGroupRows;
    }
    /**
     * @private
     * @return {?}
     */
    getCurrentSettings() {
        /** @type {?} */
        let _settings = {};
        _settings.viewColumns = this.fields;
        if (!this.enableScheme) {
            if (!_settings.columnFormat) {
                _settings.columnFormat = [...this.columns[0]];
            }
            if (!_settings.sortInfo) {
                _settings.sortInfo = {
                    sortName: this.gridInstance.sortName ? this.gridInstance.sortName.split(',') : [],
                    sortOrder: this.gridInstance.sortOrder ? this.gridInstance.sortOrder.split(',') : []
                };
            }
            if (_settings.groupField === undefined) {
                _settings.groupField = this.gridInstance.groupField ? this.gridInstance.groupField.split(',') : [];
            }
        }
        else {
            _settings = Object.assign(this.settings || {}, _settings);
        }
        if (_settings.expandGroupRows == undefined) {
            _settings.expandGroupRows = this.gridInstance['expandGroupRows'];
        }
        return _settings;
    }
    // 确定按钮点击事件
    /**
     * @param {?=} $event
     * @return {?}
     */
    onSubmitClick($event) {
        if ($event) {
            $event.stopPropagation();
        }
        if (!this.enableMultipleHeaders) {
            if (!this.fields || !this.fields.length) {
                this.notify.warning(this.noDisplyColumnTip);
                return;
            }
        }
        this.prevSchemeItem = this.currentSchemeItem;
        this.showSchemePanel = false;
        this.settings = this.getCurrentSettings();
        // 启用多表头时，触发新的事件
        if (this.enableMultipleHeaders) {
            if (this.multiHeaderRef) {
                /** @type {?} */
                const _multiHeaders = this.multiHeaderRef.getSettings();
                if (!multiHeadersHasDataFields(_multiHeaders.viewCols)) {
                    this.notify.info(this.noDisplyColumnTip);
                    return;
                }
                mergeSortInfo(_multiHeaders.viewCols, this.settings.sortInfo);
                this.settings.multiHeaders = _multiHeaders;
            }
            this.submitForGroupHeader.emit({
                content: this.settings,
                close: this.close.bind(this),
                target: this.btnOk.nativeElement,
                currentScheme: this.currentSchemeItem
            });
        }
        else {
            this.submit.emit({
                content: this.settings,
                close: this.close.bind(this),
                target: this.btnOk.nativeElement,
                currentScheme: this.currentSchemeItem
            });
        }
    }
    /**
     * @return {?}
     */
    collectSettings() {
        this.settings = this.getCurrentSettings();
        // 启用多表头时，触发新的事件
        if (this.enableMultipleHeaders) {
            if (this.multiHeaderRef) {
                /** @type {?} */
                const _multiHeaders = this.multiHeaderRef.getSettings();
                if (!multiHeadersHasDataFields(_multiHeaders.viewCols)) {
                    this.notify.info(this.noDisplyColumnTip);
                    return;
                }
                mergeSortInfo(_multiHeaders.viewCols, this.settings.sortInfo);
                this.settings.multiHeaders = _multiHeaders;
            }
        }
        return Object.assign({}, this.settings);
    }
    // 显示下拉方案列表
    /**
     * @param {?} $event
     * @return {?}
     */
    onChooseScheme($event) {
        if ($event) {
            $event.stopPropagation();
        }
        this.showSchemePanel = !this.showSchemePanel;
        setTimeout((/**
         * @return {?}
         */
        () => {
            if (this.schemeitemsEleRef && this.currentSchemeItem) {
                /** @type {?} */
                const itemEl = this.schemeitemsEleRef.nativeElement.querySelector(`#schemeitem_${this.currentSchemeItem.id}`);
                if (itemEl) {
                    if (itemEl.scrollIntoViewIfNeeded) {
                        itemEl.scrollIntoViewIfNeeded();
                    }
                    else {
                        itemEl.scrollIntoView();
                    }
                }
            }
        }));
    }
    // 仅显示可见列
    /**
     * @param {?} $event
     * @param {?} searchWords
     * @return {?}
     */
    onlySeeVisibleColumns($event, searchWords) {
        this.switchValue = $event;
        this.filterColumns(searchWords);
    }
    /**
     * @return {?}
     */
    refresh() {
        if (!this.cd['destroyed']) {
            this.cd.detectChanges();
        }
    }
    /**
     * @return {?}
     */
    hidePanel() {
        this.showSchemePanel = false;
        this.refresh();
    }
    // 新增方案
    /**
     * @param {?} $event
     * @param {?=} saveas
     * @return {?}
     */
    onNewSchemeClick($event, saveas = 'new') {
        if ($event) {
            $event.stopPropagation();
        }
        this.hidePanel();
        this.addNewScheme.emit({ type: saveas || 'new' });
    }
    // 显示方案列表管理窗口
    /**
     * @param {?} $event
     * @return {?}
     */
    onShowSchemeList($event) {
        if ($event) {
            $event.stopPropagation();
        }
        this.hidePanel();
        this.showSchemeList.emit();
    }
    /**
     * @private
     * @param {?} schemeSettings
     * @return {?}
     */
    schemeChangedForSingleHeader(schemeSettings) {
        if (!schemeSettings) {
            this._reset2Default();
        }
        else {
            this.settings = schemeSettings;
            this.fields = schemeSettings.viewColumns;
            this.columns[0].forEach((/**
             * @param {?} f
             * @return {?}
             */
            f => {
                f.visible = this.fields.indexOf(f.field) > -1;
            }));
        }
        this.searchResultIsVisibleAll = this.seachResultIsCheckAll();
    }
    /**
     * @private
     * @param {?} schemeSettings
     * @return {?}
     */
    schemeChangedForMultiHeaders(schemeSettings) {
        if (schemeSettings) {
            this.settings = schemeSettings;
            /** @type {?} */
            const options = this.gridInstance.dfs['_state'].initialOptions;
            this.multiHeaderOptions = {
                treeData: this.settings.multiHeaders ? this.settings.multiHeaders.treeData : null,
                columns: options.groupHeaderFields
            };
        }
        else {
            this._reset2DefalutFormMultiHeaders();
        }
    }
    // 方案点击
    /**
     * @param {?} $event
     * @param {?} item
     * @return {?}
     */
    onSchemeItemClick($event, item) {
        setTimeout((/**
         * @return {?}
         */
        () => {
            this.currentSchemeItem = item;
            this.showSchemePanel = false;
            /** @type {?} */
            let schemeSettings = null;
            if (item && item.queryConditionString) {
                schemeSettings = JSON.parse(item.queryConditionString);
                schemeSettings = schemeSettings[this.localeSer.localeId];
            }
            if (this.enableMultipleHeaders) {
                this.schemeChangedForMultiHeaders(schemeSettings);
            }
            else {
                this.schemeChangedForSingleHeader(schemeSettings);
            }
            this.schemeSer.setSettings(this.settings);
            this.defaultSettings(item);
            this.schemeChanged.emit(item);
            this.refresh();
        }));
    }
    /**
     * 多表头默认设置
     * @private
     * @param {?=} item
     * @return {?}
     */
    defaultSettings(item) {
        if (this.enableMultipleHeaders) {
            if (!item || (this.settings && this.settings.multiHeaders && !this.settings.multiHeaders.treeData)) { // 系统预置
                setTimeout((/**
                 * @return {?}
                 */
                () => {
                    this.settings.multiHeaders = this.multiHeaderRef.getSettings();
                    this.schemeSer.setSettings(this.settings);
                }));
            }
        }
    }
    /**
     * @param {?} flag
     * @return {?}
     */
    dirtySettings(flag) {
        // this.isChanged = flag;
    }
    /**
     * @param {?} $event
     * @param {?} input
     * @return {?}
     */
    clearSearch($event, input) {
        if (input && input.value) {
            this.filterColumns('');
            input.value = '';
        }
    }
}
SimpleColumnsComponent.decorators = [
    { type: Component, args: [{
                selector: 'datagrid-settings-simple',
                template: "<div class=\"d-flex flex-column f-datagrid-settings-simple\" tabindex=\"0\" #colcontainer\r\n    [style.top.px]=\"top\" [style.height]=\"'calc(100vh - ' +  top + 'px)'\" >\r\n\r\n    <div class=\"header d-flex\">\r\n        <div class=\"f-utils-fill title d-flex flex-row\"> {{ 'datagrid.settings.simple.title' | locale }} \r\n            <button #btnSchemeName class=\"btn ml-3 px-2 scheme-name d-flex flex-row\"  *ngIf=\"enableScheme\" (click)=\"onChooseScheme($event)\">\r\n                <!-- <span *ngIf=\"isChanged\">*</span> -->\r\n                <span>{{ currentSchemeItem? currentSchemeItem._title_ : defaultSchemeName }}</span>\r\n                <span class=\"f-icon f-icon-arrow-chevron-down ml-2\" style=\"font-size: 12px;\"></span>\r\n            </button>\r\n        </div>\r\n        <div class=\"closed\" (click)=\"cancel($event)\">\r\n            <span class=\"f-icon f-icon-close\" style=\"font-size: 20px;\"></span>\r\n        </div>\r\n    </div>\r\n    <div class=\"scheme-manager-dropdown\" [style.display]=\"showSchemePanel? '': 'none'\" [style.left.px]=\"btnRef? btnRef.nativeElement.offsetLeft : 97\"  (click)=\"$event.stopPropagation()\">\r\n        <div class=\"f-utils-fill f-utils-flex-column m-2\">\r\n            <div class=\"pb-2\" style=\"max-height: calc(100vh - 300px);overflow: auto\">\r\n                <ul #schemeitems>\r\n                    <li class=\"scheme-manager__item\" [class.active]=\"!currentSchemeItem\" (click)=\"onSchemeItemClick($event, null)\"> \r\n                        <!-- <span *ngIf=\"isChanged && !activeSchemeItem\">*</span> -->\r\n                        {{'datagrid-scheme.syspreset' | locale}}\r\n                    </li>\r\n                    <li [attr.id]=\"'schemeitem_'+ item.id\" class=\"scheme-manager__item d-flex flex-row\" \r\n                        [class.active]=\"currentSchemeItem && currentSchemeItem?.id === item.id\"  \r\n                        *ngFor=\"let item of schemeList\" (click)=\"onSchemeItemClick($event, item)\" title=\"{{item._title_}}\">\r\n                        <!-- <span *ngIf=\"isChanged && activeSchemeItem?.id==item.id\">*</span> -->\r\n                        <span class=\"f-utils-fill mr-1\" style=\"text-overflow: ellipsis;\">{{item._title_}}</span>\r\n                        <span class=\"scheme-manager__label default\" *ngIf=\"item.isDefault\">{{'datagrid-scheme.isDefault' | locale}}</span>\r\n                        <span class=\"scheme-manager__label public\" *ngIf=\"item.type === 'public'\">{{'datagrid-scheme.isPublic' | locale}}</span>\r\n                        <span class=\"scheme-manager__label private\" *ngIf=\"!item.isDefault && item.type === 'private'\">{{'datagrid-scheme.isPrivate' | locale}}</span>\r\n                        <span class=\"scheme-manager__label org\" *ngIf=\"item.type === 'org'\">{{'datagrid-scheme.isOrg' | locale}}</span>\r\n                    </li>\r\n                </ul>\r\n            </div>\r\n\r\n            <div class=\"d-flex scheme-manager__button-add\">\r\n                <button (click)=\"onNewSchemeClick($event)\">\r\n                    <span class=\"f-icon f-icon-plus\"></span>{{'datagrid-scheme.newScheme' | locale}}\r\n                </button>\r\n            </div>\r\n\r\n            <div class=\"p-2 mt-2\">\r\n                <div class=\"btn-toolbar\" style=\"justify-content: flex-end;\">\r\n                    <button class=\"btn btn-link mr-3\" (click)=\"onShowSchemeList($event)\">{{'datagrid-scheme.mgrScheme' | locale}}</button>\r\n                    <button class=\"btn btn-primary mr-1\" (click)=\"onNewSchemeClick($event, 'saveas')\">{{'datagrid-scheme.saveas' | locale}} </button>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n    <div class=\"f-utils-fill content d-flex flex-column mb-0\">\r\n        <div class=\"d-flex flex-column\">\r\n            <div class=\"d-flex flex-row mb-2\" style=\"align-items: center; height: 24px;\">\r\n                <h5 *ngIf=\"!enableMultipleHeaders\" class=\"count f-utils-fill m-0\" [innerHTML]=\"'datagrid.settings.simple.count' | locale | replaceX: fields.length\"></h5>\r\n                <h5 *ngIf=\"enableMultipleHeaders\" class=\"count m-0\" style=\"font-size: 18px;\">{{ 'headerGroup.title' | locale }}</h5>\r\n                <div class=\"d-flex flex-row \" style=\"align-items: center;justify-content: end;\" [class.f-utils-fill]=\"enableMultipleHeaders\" >\r\n                    <div [class.d-flex]=\"!inputWord.value\"  class=\"flex-row\" [style.display]=\"inputWord.value ? 'none': ''\"  *ngIf=\"!enableMultipleHeaders\">{{'datagrid-scheme.onlyshowcolumns' | locale}} \r\n                        <farris-switch style=\"position: relative;\r\n                        top: 2px;\r\n                        margin-left: 5px;\"\r\n                        id=\"only-visible-columns\"\r\n                        [square]=\"false\" [size]=\"'small'\"\r\n                        [ngModel]=\"switchValue\" \r\n                        (valueChange)=\"onlySeeVisibleColumns($event, inputWord.value)\"\r\n                      \r\n                        ></farris-switch>\r\n                    </div>\r\n                   \r\n                    <button class=\"btn btn-link\" style=\"height: 32px;padding-left: 4px;\" [preview-headers]=\"gh\" [dlgTitle]=\"'headerGroup.preview'|locale\" *ngIf=\"enableMultipleHeaders\"> {{ 'headerGroup.preview' | locale }}</button>\r\n                    <farris-switch style=\"position: relative; top: 2px; margin-left: 5px; display: none;\" id=\"only-visible-columns\"\r\n                        [square]=\"false\" [size]=\"'small'\" [(ngModel)]=\"enableMultipleHeaders\"></farris-switch>\r\n                </div>\r\n            </div>\r\n\r\n            <div class=\"tip\">\r\n                <ng-container  *ngIf=\"!enableMultipleHeaders\">\r\n                    {{ 'datagrid.settings.simple.tip' | locale }}\r\n                </ng-container>\r\n                <ng-container *ngIf=\"enableMultipleHeaders\">\r\n                    {{ 'headerGroup.tips' | locale }}\r\n                </ng-container>\r\n            </div>\r\n            <div class=\"input-group mb-2 scheme-manager__search-box\" [style.display]=\"enableMultipleHeaders?'none':''\">\r\n                <input #inputWord type=\"text\" class=\"form-control\" placeholder=\"{{'datagrid.settings.searchPlaceholder' | locale}}\"\r\n                (input)=\"searchColumn($event)\" style=\"height: 26px;\">\r\n                <div  class=\"input-group-append\" style=\"cursor: pointer\">\r\n                    <span  class=\"fa f-icon-search\" [class.f-icon-close]=\"inputWord.value\" (click)=\"clearSearch($event, inputWord)\"></span>\r\n                </div>\r\n            </div>\r\n        </div>\r\n\r\n        <div style=\"padding: 5px 0px;\" class=\"d-flex flex-row\" *ngIf=\"!enableMultipleHeaders\">\r\n            <button class=\"btn btn-link \" style=\"height: 32px;padding-left: 4px;\" (click)=\"onCheckAllClick($event,inputWord.value)\" [disabled]=\"!(allCols && allCols.length)\">\r\n                <span class=\"f-icon f-icon-minus-outline checkall\" \r\n                    [class.f-icon-checkbox]=\"searchResultIsVisibleAll.unCheckAll\"\r\n                    [class.f-icon-checkbox-checked]=\"searchResultIsVisibleAll.checkAll\"></span>\r\n                {{ 'datagrid.settings.checkall' | locale }}\r\n            </button>\r\n        </div>\r\n\r\n        <div style=\"overflow: auto;padding-right:3px;\" class=\"f-utils-fill\" [ngStyle]=\"enableMultipleHeaders? {border: '1px solid #dae9ff','border-radius': '6px'} : {}\">\r\n            <ul [style.display]=\"enableMultipleHeaders? 'none':''\" class=\"list-group list-group-flush\" #ul column-visible-drag (drop)=\"onFieldDrop($event, inputWord.value, ul)\">\r\n                <li class=\"list-group-item list-group-item-action smooth-dnd-draggable-wrapper format-setting-column\" *ngFor=\"let col of allCols\" \r\n                    (click)=\"onDblClick($event, col)\">\r\n                    <span class=\"f-icon checkbox\"\r\n                        [class.f-icon-checkbox-checked]=\"fields.length && fields.indexOf(col.field) > -1\"\r\n                        [class.f-icon-checkbox]=\"!fields.length || fields.indexOf(col.field) == -1\"\r\n                        (click)=\"onCheckboxClick($event, col)\"></span>\r\n                    {{ col.title}} \r\n\r\n                    <span class=\"f-icon f-icon-drag-vertical field-drag-handle\" *ngIf=\"!inputWord.value\"></span>\r\n                </li>\r\n            </ul>\r\n            <column-tree #gh=\"groupHeaderTree\" [dg]=\"gridInstance\" [options]=\"multiHeaderOptions\"\r\n                [style.display]=\"enableMultipleHeaders? 'block': 'none'\" style=\"height: 100%;padding-top: 5px;\"></column-tree>\r\n        </div>\r\n\r\n    </div>\r\n    <div class=\"footer\">\r\n\r\n        <div class=\"buttons\">\r\n            <button class=\"btn btn-link advanced\" (click)=\"showAdvanced($event)\">{{ 'datagrid.settings.advancedMode' | locale: '\u9AD8\u7EA7\u6A21\u5F0F' }}</button>\r\n            <button class=\"btn btn-link reset\" (click)=\"onSettingReset($event)\">{{ 'datagrid.settings.reset' | locale: '\u6062\u590D\u9ED8\u8BA4' }}</button>\r\n            <button class=\"btn btn-secondary cancel\"\r\n                (click)=\"cancel($event)\">{{'datagrid.settings.cancel' | locale}}</button>\r\n            <button class=\"btn btn-primary ok\" #okbtn\r\n                (click)=\"onSubmitClick($event)\">{{'datagrid.settings.ok' | locale}}</button>\r\n        </div>\r\n\r\n    </div>\r\n\r\n</div>\r\n\r\n\r\n",
                encapsulation: ViewEncapsulation.None
            }] }
];
/** @nocollapse */
SimpleColumnsComponent.ctorParameters = () => [
    { type: Injector },
    { type: ChangeDetectorRef }
];
SimpleColumnsComponent.propDecorators = {
    enableScheme: [{ type: Input }],
    seartTypes: [{ type: Input }],
    columns: [{ type: Input }],
    fields: [{ type: Input }],
    clickToHidden: [{ type: Input }],
    top: [{ type: Input }],
    schemeList: [{ type: Input }],
    cls: [{ type: HostBinding, args: ['class',] }],
    container: [{ type: ViewChild, args: ['colcontainer',] }],
    btnOk: [{ type: ViewChild, args: ['okbtn',] }],
    searchInput: [{ type: ViewChild, args: ['inputWord',] }],
    schemeitemsEleRef: [{ type: ViewChild, args: ['schemeitems',] }],
    btnRef: [{ type: ViewChild, args: ['btnSchemeName',] }],
    multiHeaderRef: [{ type: ViewChild, args: ['gh',] }],
    formatChange: [{ type: Output }],
    fieldsChange: [{ type: Output }],
    submit: [{ type: Output }],
    submitForGroupHeader: [{ type: Output }],
    closed: [{ type: Output }],
    advanced: [{ type: Output }],
    canceld: [{ type: Output }],
    addNewScheme: [{ type: Output }],
    showSchemeList: [{ type: Output }],
    activeItemChange: [{ type: Output }],
    schemeChanged: [{ type: Output }],
    onClick: [{ type: HostListener, args: ['click', ['$event'],] }],
    onEscKeydown: [{ type: HostListener, args: ['window:keydown.esc', ['$event'],] }],
    onEnterKeydown: [{ type: HostListener, args: ['window:keydown.enter', ['$event'],] }],
    onControlGKeydown: [{ type: HostListener, args: ['keydown', ['$event'],] }]
};
if (false) {
    /** @type {?} */
    SimpleColumnsComponent.prototype.enableScheme;
    /** @type {?} */
    SimpleColumnsComponent.prototype.seartTypes;
    /**
     * 所有列
     * @type {?}
     */
    SimpleColumnsComponent.prototype.columns;
    /**
     * 显示的列
     * @type {?}
     */
    SimpleColumnsComponent.prototype.fields;
    /**
     * 点击侧边样式以外的区域隐藏面板。默认为 true
     * @type {?}
     */
    SimpleColumnsComponent.prototype.clickToHidden;
    /** @type {?} */
    SimpleColumnsComponent.prototype.top;
    /**
     * @type {?}
     * @private
     */
    SimpleColumnsComponent.prototype._schemeList;
    /** @type {?} */
    SimpleColumnsComponent.prototype.cls;
    /** @type {?} */
    SimpleColumnsComponent.prototype.container;
    /** @type {?} */
    SimpleColumnsComponent.prototype.btnOk;
    /** @type {?} */
    SimpleColumnsComponent.prototype.searchInput;
    /** @type {?} */
    SimpleColumnsComponent.prototype.schemeitemsEleRef;
    /** @type {?} */
    SimpleColumnsComponent.prototype.btnRef;
    /** @type {?} */
    SimpleColumnsComponent.prototype.multiHeaderRef;
    /** @type {?} */
    SimpleColumnsComponent.prototype.formatChange;
    /** @type {?} */
    SimpleColumnsComponent.prototype.fieldsChange;
    /** @type {?} */
    SimpleColumnsComponent.prototype.submit;
    /**
     * 分组表头确定事件
     * @type {?}
     */
    SimpleColumnsComponent.prototype.submitForGroupHeader;
    /** @type {?} */
    SimpleColumnsComponent.prototype.closed;
    /** @type {?} */
    SimpleColumnsComponent.prototype.advanced;
    /** @type {?} */
    SimpleColumnsComponent.prototype.canceld;
    /** @type {?} */
    SimpleColumnsComponent.prototype.addNewScheme;
    /** @type {?} */
    SimpleColumnsComponent.prototype.showSchemeList;
    /** @type {?} */
    SimpleColumnsComponent.prototype.activeItemChange;
    /** @type {?} */
    SimpleColumnsComponent.prototype.schemeChanged;
    /** @type {?} */
    SimpleColumnsComponent.prototype.allCols;
    /** @type {?} */
    SimpleColumnsComponent.prototype.columnType;
    /** @type {?} */
    SimpleColumnsComponent.prototype.gridInstance;
    /** @type {?} */
    SimpleColumnsComponent.prototype.localeSer;
    /** @type {?} */
    SimpleColumnsComponent.prototype.isEn;
    /** @type {?} */
    SimpleColumnsComponent.prototype.showSchemePanel;
    /** @type {?} */
    SimpleColumnsComponent.prototype.switchValue;
    /** @type {?} */
    SimpleColumnsComponent.prototype.currentSchemeItem;
    /** @type {?} */
    SimpleColumnsComponent.prototype.searchResultIsVisibleAll;
    /** @type {?} */
    SimpleColumnsComponent.prototype.defaultSchemeName;
    /**
     * 配置多表头相关设置
     * @type {?}
     */
    SimpleColumnsComponent.prototype.multiHeaderOptions;
    /** @type {?} */
    SimpleColumnsComponent.prototype.enableMultipleHeaders;
    /**
     * @type {?}
     * @private
     */
    SimpleColumnsComponent.prototype.messager;
    /**
     * @type {?}
     * @private
     */
    SimpleColumnsComponent.prototype.notify;
    /**
     * @type {?}
     * @private
     */
    SimpleColumnsComponent.prototype.prevSchemeItem;
    /** @type {?} */
    SimpleColumnsComponent.prototype.settings;
    /** @type {?} */
    SimpleColumnsComponent.prototype.schemeSer;
    /** @type {?} */
    SimpleColumnsComponent.prototype.noDisplyColumnTip;
    /**
     * @type {?}
     * @private
     */
    SimpleColumnsComponent.prototype.injector;
    /** @type {?} */
    SimpleColumnsComponent.prototype.cd;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2ltcGxlLWNvbHVtbnMuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGZhcnJpcy91aS1kYXRhZ3JpZC1zZXR0aW5ncy8iLCJzb3VyY2VzIjpbImxpYi9zaW1wbGUtbW9kZS9zaW1wbGUtY29sdW1ucy5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUNBLE9BQU8sRUFBRSxpQkFBaUIsRUFBRSxTQUFTLEVBQUUsWUFBWSxFQUFFLFdBQVcsRUFBRSxRQUFRLEVBQUUsS0FBSyxFQUN6RSxNQUFNLEVBQUUsaUJBQWlCLEVBQUUsWUFBWSxFQUFFLFNBQVMsRUFBRSxVQUFVLEVBQWlCLE1BQU0sZUFBZSxDQUFDO0FBQzdHLE9BQU8sRUFBRSxhQUFhLEVBQUUsTUFBTSxtQkFBbUIsQ0FBQztBQUNsRCxPQUFPLEVBQUUsZUFBZSxFQUFFLE1BQU0scUJBQXFCLENBQUM7QUFHdEQsT0FBTyxFQUFFLG9CQUFvQixFQUFFLE1BQU0seUJBQXlCLENBQUM7QUFDL0QsT0FBTyxFQUFFLGFBQWEsRUFBRSxNQUFNLG1CQUFtQixDQUFDO0FBQ2xELE9BQU8sRUFBRSxtQkFBbUIsRUFBRSxNQUFNLHdDQUF3QyxDQUFDO0FBQzdFLE9BQU8sRUFBRSxhQUFhLEVBQUUseUJBQXlCLEVBQUUsNEJBQTRCLEVBQUUsTUFBTSx5QkFBeUIsQ0FBQztBQUNqSCxPQUFPLEVBQUUsU0FBUyxFQUFFLE1BQU0sV0FBVyxDQUFDO0FBUXRDLE1BQU0sT0FBTyxzQkFBc0I7Ozs7O0lBMkYvQixZQUFvQixRQUFrQixFQUFTLEVBQXFCO1FBQWhELGFBQVEsR0FBUixRQUFRLENBQVU7UUFBUyxPQUFFLEdBQUYsRUFBRSxDQUFtQjtRQTFGM0QsaUJBQVksR0FBRyxLQUFLLENBQUM7UUFDckIsZUFBVSxHQUFRLEVBQUUsQ0FBQzs7OztRQUVyQixZQUFPLEdBQUcsRUFBRSxDQUFDOzs7O1FBRWIsV0FBTSxHQUFHLEVBQUUsQ0FBQzs7OztRQUVaLGtCQUFhLEdBQUcsSUFB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QXNDOztJQUN0Qyw2Q0FBZ0Q7O0lBRWhELG1EQUF3RDs7SUFDeEQsd0NBQStDOztJQUUvQyxnREFBcUQ7O0lBRXJELDhDQUE0Qzs7SUFDNUMsOENBQTRDOztJQUM1Qyx3Q0FBc0M7Ozs7O0lBRXRDLHNEQUFvRDs7SUFDcEQsd0NBQXNDOztJQUN0QywwQ0FBd0M7O0lBQ3hDLHlDQUF1Qzs7SUFFdkMsOENBQTRDOztJQUM1QyxnREFBOEM7O0lBQzlDLGtEQUFnRDs7SUFFaEQsK0NBQTZDOztJQUU3Qyx5Q0FBYTs7SUFDYiw0Q0FBbUI7O0lBRW5CLDhDQUFnQzs7SUFDaEMsMkNBQXlCOztJQUN6QixzQ0FBYTs7SUFFYixpREFBd0I7O0lBRXhCLDZDQUFvQjs7SUFFcEIsbURBQXlCOztJQUV6QiwwREFBa0U7O0lBQ2xFLG1EQUEyQjs7Ozs7SUFJM0Isb0RBQW9EOztJQUVwRCx1REFBOEI7Ozs7O0lBRTlCLDBDQUFrQzs7Ozs7SUFDbEMsd0NBQThCOzs7OztJQUU5QixnREFBOEI7O0lBRTlCLDBDQUE0Qjs7SUFFNUIsMkNBQXdDOztJQUV4QyxtREFBdUI7Ozs7O0lBR1gsMENBQTBCOztJQUFFLG9DQUE0QiIsInNvdXJjZXNDb250ZW50IjpbIlxyXG5pbXBvcnQgeyBDaGFuZ2VEZXRlY3RvclJlZiwgQ29tcG9uZW50LCBFdmVudEVtaXR0ZXIsIEhvc3RCaW5kaW5nLCBJbmplY3RvciwgSW5wdXQsIE9uSW5pdCxcclxuICAgICAgICBPdXRwdXQsIFZpZXdFbmNhcHN1bGF0aW9uLCBIb3N0TGlzdGVuZXIsIFZpZXdDaGlsZCwgRWxlbWVudFJlZiwgQWZ0ZXJWaWV3SW5pdCB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBMb2NhbGVTZXJ2aWNlIH0gZnJvbSAnQGZhcnJpcy91aS1sb2NhbGUnO1xyXG5pbXBvcnQgeyBNZXNzYWdlclNlcnZpY2UgfSBmcm9tICdAZmFycmlzL3VpLW1lc3NhZ2VyJztcclxuaW1wb3J0IHsgRGF0YWdyaWRDb21wb25lbnQgfSBmcm9tICdAZmFycmlzL3VpLWRhdGFncmlkJztcclxuaW1wb3J0IHsgQ29sdW1uVHJlZU9wdGlvbnMsIFNldHRpbmdNb2RlbCB9IGZyb20gJy4uL3NldHRpbmcubW9kZWwnO1xyXG5pbXBvcnQgeyBnZXRNdWx0aWxpbmd1YWxWYWx1ZSB9IGZyb20gJy4uL2dldFZhbHVlV2l0aExvY2FsZUlkJztcclxuaW1wb3J0IHsgTm90aWZ5U2VydmljZSB9IGZyb20gJ0BmYXJyaXMvdWktbm90aWZ5JztcclxuaW1wb3J0IHsgQ29sdW1uVHJlZUNvbXBvbmVudCB9IGZyb20gJy4uL211bHRpLWhlYWRlcnMvY29sdW1uLXRyZWUuY29tcG9uZW50JztcclxuaW1wb3J0IHsgbWVyZ2VTb3J0SW5mbywgbXVsdGlIZWFkZXJzSGFzRGF0YUZpZWxkcywgcmVzZXQyRGVmYXVsdEZvck11bHRpSGVhZGVycyB9IGZyb20gJy4uL211dGxpLWhlYWRlcnMuaGVscGVyJztcclxuaW1wb3J0IHsgY2xvbmVEZWVwIH0gZnJvbSAnbG9kYXNoLWVzJztcclxuaW1wb3J0IHsgRGF0YWdyaWRTY2hlbWVTZXJ2aWNlIH0gZnJvbSAnLi4vZGF0YWdyaWQtc2NoZW1lLnNlcnZpY2UnO1xyXG5cclxuQENvbXBvbmVudCh7XHJcbiAgICBzZWxlY3RvcjogJ2RhdGFncmlkLXNldHRpbmdzLXNpbXBsZScsXHJcbiAgICB0ZW1wbGF0ZVVybDogJy4vc2ltcGxlLWNvbHVtbnMuY29tcG9uZW50Lmh0bWwnLFxyXG4gICAgZW5jYXBzdWxhdGlvbjogVmlld0VuY2Fwc3VsYXRpb24uTm9uZVxyXG59KVxyXG5leHBvcnQgY2xhc3MgU2ltcGxlQ29sdW1uc0NvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCwgQWZ0ZXJWaWV3SW5pdCB7XHJcbiAgICBASW5wdXQoKSBlbmFibGVTY2hlbWUgPSBmYWxzZTtcclxuICAgIEBJbnB1dCgpIHNlYXJ0VHlwZXM6IGFueSA9IFtdO1xyXG4gICAgLyoqIOaJgOacieWIlyAqL1xyXG4gICAgQElucHV0KCkgY29sdW1ucyA9IFtdO1xyXG4gICAgLyoqIOaYvuekuueahOWIlyAqL1xyXG4gICAgQElucHV0KCkgZmllbGRzID0gW107XHJcbiAgICAvKiog54K55Ye75L6n6L655qC35byP5Lul5aSW55qE5Yy65Z+f6ZqQ6JeP6Z2i5p2/44CC6buY6K6k5Li6IHRydWUgKi9cclxuICAgIEBJbnB1dCgpIGNsaWNrVG9IaWRkZW4gPSB0cnVlO1xyXG5cclxuICAgIEBJbnB1dCgpIHRvcCA9IDA7XHJcbiAgICBwcml2YXRlIF9zY2hlbWVMaXN0ID0gW107XHJcbiAgICBASW5wdXQoKVxyXG4gICAgZ2V0IHNjaGVtZUxpc3QoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX3NjaGVtZUxpc3Q7XHJcbiAgICB9XHJcbiAgICBzZXQgc2NoZW1lTGlzdCh2YWwpIHtcclxuICAgICAgICBpZiAodmFsICYmIHZhbC5sZW5ndGgpIHtcclxuICAgICAgICAgICAgdmFsID0gdmFsLmZpbHRlcihuID0+IHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBKU09OLnBhcnNlKG4ubmFtZSlbdGhpcy5sb2NhbGVTZXIubG9jYWxlSWRdXHJcbiAgICAgICAgICAgIH0pOyAvLyDku4Xojrflj5blvZPliY3or63oqIDnmoTmlrnmoYhcclxuICAgICAgICAgICAgdmFsLmZvckVhY2gobiA9PiB7XHJcbiAgICAgICAgICAgICAgICBuWydfdGl0bGVfJ10gPSBnZXRNdWx0aWxpbmd1YWxWYWx1ZShKU09OLnBhcnNlKG4ubmFtZSksIHRoaXMubG9jYWxlU2VyLmxvY2FsZUlkKTtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmN1cnJlbnRTY2hlbWVJdGVtICYmIG4uaWQgPT09IHRoaXMuY3VycmVudFNjaGVtZUl0ZW0uaWQpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRTY2hlbWVJdGVtWydfdGl0bGVfJ10gPSBuWydfdGl0bGVfJ107XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLl9zY2hlbWVMaXN0ID0gdmFsIHx8IFtdO1xyXG4gICAgfVxyXG5cclxuICAgIEBIb3N0QmluZGluZygnY2xhc3MnKSBjbHMgPSAnZi1kYXRhZ3JpZC1zZXR0aW5ncy1zaW1wbGUtaG9zdCc7XHJcblxyXG4gICAgQFZpZXdDaGlsZCgnY29sY29udGFpbmVyJykgY29udGFpbmVyOiBFbGVtZW50UmVmO1xyXG4gICAgQFZpZXdDaGlsZCgnb2tidG4nKSBidG5PazogRWxlbWVudFJlZjtcclxuICAgIEBWaWV3Q2hpbGQoJ2lucHV0V29yZCcpIHNlYXJjaElucHV0OiBFbGVtZW50UmVmO1xyXG5cclxuICAgIEBWaWV3Q2hpbGQoJ3NjaGVtZWl0ZW1zJykgc2NoZW1laXRlbXNFbGVSZWY6IEVsZW1lbnRSZWY7XHJcbiAgICBAVmlld0NoaWxkKCdidG5TY2hlbWVOYW1lJykgYnRuUmVmOiBFbGVtZW50UmVmO1xyXG5cclxuICAgIEBWaWV3Q2hpbGQoJ2doJykgbXVsdGlIZWFkZXJSZWY6IENvbHVtblRyZWVDb21wb25lbnQ7XHJcblxyXG4gICAgQE91dHB1dCgpIGZvcm1hdENoYW5nZSA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcclxuICAgIEBPdXRwdXQoKSBmaWVsZHNDaGFuZ2UgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XHJcbiAgICBAT3V0cHV0KCkgc3VibWl0ID0gbmV3IEV2ZW50RW1pdHRlcigpO1xyXG4gICAgLyoqIOWIhue7hOihqOWktOehruWumuS6i+S7tiAqL1xyXG4gICAgQE91dHB1dCgpIHN1Ym1pdEZvckdyb3VwSGVhZGVyID0gbmV3IEV2ZW50RW1pdHRlcigpO1xyXG4gICAgQE91dHB1dCgpIGNsb3NlZCA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcclxuICAgIEBPdXRwdXQoKSBhZHZhbmNlZCA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcclxuICAgIEBPdXRwdXQoKSBjYW5jZWxkID0gbmV3IEV2ZW50RW1pdHRlcigpO1xyXG5cclxuICAgIEBPdXRwdXQoKSBhZGROZXdTY2hlbWUgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XHJcbiAgICBAT3V0cHV0KCkgc2hvd1NjaGVtZUxpc3QgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XHJcbiAgICBAT3V0cHV0KCkgYWN0aXZlSXRlbUNoYW5nZSA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcclxuXHJcbiAgICBAT3V0cHV0KCkgc2NoZW1lQ2hhbmdlZCA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcclxuXHJcbiAgICBhbGxDb2xzID0gW107XHJcbiAgICBjb2x1bW5UeXBlID0gJ2FsbCc7XHJcblxyXG4gICAgZ3JpZEluc3RhbmNlOiBEYXRhZ3JpZENvbXBvbmVudDtcclxuICAgIGxvY2FsZVNlcjogTG9jYWxlU2VydmljZTtcclxuICAgIGlzRW4gPSBmYWxzZTtcclxuXHJcbiAgICBzaG93U2NoZW1lUGFuZWwgPSBmYWxzZTtcclxuXHJcbiAgICBzd2l0Y2hWYWx1ZSA9IGZhbHNlO1xyXG4gICAgLy8g5b2T5YmN5pa55qGIXHJcbiAgICBjdXJyZW50U2NoZW1lSXRlbSA9IG51bGw7XHJcblxyXG4gICAgc2VhcmNoUmVzdWx0SXNWaXNpYmxlQWxsID0geyBjaGVja0FsbDogZmFsc2UsIHVuQ2hlY2tBbGw6IGZhbHNlIH07XHJcbiAgICBkZWZhdWx0U2NoZW1lTmFtZSA9ICfns7vnu5/pooTliLYnO1xyXG5cclxuICAgIFxyXG4gICAgLyoqIOmFjee9ruWkmuihqOWktOebuOWFs+iuvue9riAqL1xyXG4gICAgbXVsdGlIZWFkZXJPcHRpb25zOiBQYXJ0aWFsPENvbHVtblRyZWVPcHRpb25zPiA9IHt9O1xyXG4gICAgLy8g5ZCv55So5aSa6KGo5aS0XHJcbiAgICBlbmFibGVNdWx0aXBsZUhlYWRlcnMgPSBmYWxzZTtcclxuXHJcbiAgICBwcml2YXRlIG1lc3NhZ2VyOiBNZXNzYWdlclNlcnZpY2U7XHJcbiAgICBwcml2YXRlIG5vdGlmeTogTm90aWZ5U2VydmljZTtcclxuXHJcbiAgICBwcml2YXRlIHByZXZTY2hlbWVJdGVtID0gbnVsbDtcclxuICAgIFxyXG4gICAgc2V0dGluZ3M6IFNldHRpbmdNb2RlbCA9IHt9O1xyXG5cclxuICAgIHNjaGVtZVNlcjogRGF0YWdyaWRTY2hlbWVTZXJ2aWNlID0gbnVsbDtcclxuXHJcbiAgICBub0Rpc3BseUNvbHVtblRpcCA9ICcnO1xyXG5cclxuXHJcbiAgICBjb25zdHJ1Y3Rvcihwcml2YXRlIGluamVjdG9yOiBJbmplY3RvciwgcHVibGljIGNkOiBDaGFuZ2VEZXRlY3RvclJlZikge1xyXG4gICAgICAgIHRoaXMubG9jYWxlU2VyID0gdGhpcy5pbmplY3Rvci5nZXQoTG9jYWxlU2VydmljZSwgbnVsbCk7XHJcbiAgICAgICAgdGhpcy5tZXNzYWdlciA9IHRoaXMuaW5qZWN0b3IuZ2V0KE1lc3NhZ2VyU2VydmljZSwgbnVsbCk7XHJcbiAgICAgICAgdGhpcy5ub3RpZnkgPSB0aGlzLmluamVjdG9yLmdldChOb3RpZnlTZXJ2aWNlLCBudWxsKTtcclxuXHJcbiAgICAgICAgdGhpcy5ub0Rpc3BseUNvbHVtblRpcCA9IHRoaXMubG9jYWxlU2VyLmdldFZhbHVlKCdkYXRhZ3JpZC1zY2hlbWUubm9EaXNwbHlDb2x1bW5UaXAnKTtcclxuICAgIH1cclxuXHJcbiAgICBASG9zdExpc3RlbmVyKCdjbGljaycsIFsnJGV2ZW50J10pXHJcbiAgICBvbkNsaWNrKCRldmVudDogTW91c2VFdmVudCkge1xyXG4gICAgICAgICRldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICBjb25zdCBjbHNuYW1lID0gJGV2ZW50LnRhcmdldFsnY2xhc3NOYW1lJ10gfHwgJyc7XHJcbiAgICAgICAgaWYgKGNsc25hbWUuaW5kZXhPZignZi1kYXRhZ3JpZC1zZXR0aW5ncy1zaW1wbGUtaG9zdCcpID4gLTEpIHtcclxuICAgICAgICAgICAgLy8g6ZqQ6JeP5L6n6L655qCP77ybXHJcbiAgICAgICAgICAgIGlmICh0aGlzLmNsaWNrVG9IaWRkZW4pIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuY2FuY2VsKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuc2hvd1NjaGVtZVBhbmVsID0gZmFsc2U7XHJcbiAgICB9XHJcblxyXG4gICAgQEhvc3RMaXN0ZW5lcignd2luZG93OmtleWRvd24uZXNjJywgWyckZXZlbnQnXSlcclxuICAgIG9uRXNjS2V5ZG93bigkZXZlbnQpIHtcclxuICAgICAgICAkZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgaWYgKCFkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdtb2RhbC1jb250YWluZXInKSkge1xyXG4gICAgICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIEBIb3N0TGlzdGVuZXIoJ3dpbmRvdzprZXlkb3duLmVudGVyJywgWyckZXZlbnQnXSlcclxuICAgIG9uRW50ZXJLZXlkb3duKCRldmVudCkge1xyXG4gICAgICAgICRldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICBpZiAoIWRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ21vZGFsLWNvbnRhaW5lcicpKSB7XHJcbiAgICAgICAgICAgIHRoaXMub25TdWJtaXRDbGljaygpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBASG9zdExpc3RlbmVyKCdrZXlkb3duJywgWyckZXZlbnQnXSlcclxuICAgIG9uQ29udHJvbEdLZXlkb3duKCRldmVudDogS2V5Ym9hcmRFdmVudCkge1xyXG4gICAgICAgIGlmICgkZXZlbnQuY3RybEtleSAmJiAhZG9jdW1lbnQucXVlcnlTZWxlY3RvcignbW9kYWwtY29udGFpbmVyJykpIHtcclxuICAgICAgICAgICAgY29uc3QgX2tleSA9ICRldmVudC5rZXkudG9Mb3dlckNhc2UoKTtcclxuICAgICAgICAgICAgaWYgKFsnZycsICdyJywgJ3MnXS5pbmNsdWRlcyhfa2V5KSkge1xyXG4gICAgICAgICAgICAgICAgJGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgICAgICAkZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKF9rZXkgPT09ICdnJykge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zaG93QWR2YW5jZWQoJGV2ZW50KTtcclxuICAgICAgICAgICAgfSBlbHNlIGlmIChfa2V5ID09PSAncicpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMub25TZXR0aW5nUmVzZXQoKTtcclxuICAgICAgICAgICAgfSBlbHNlIGlmIChfa2V5ID09PSAncycpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2VhcmNoSW5wdXQubmF0aXZlRWxlbWVudC5mb2N1cygpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgZ2V0Q3VycmVudFNjaGVtZVNldHRpbmdzKCkge1xyXG4gICAgICAgIGlmICh0aGlzLmN1cnJlbnRTY2hlbWVJdGVtICYmIHRoaXMuY3VycmVudFNjaGVtZUl0ZW0ucXVlcnlDb25kaXRpb25TdHJpbmcpIHtcclxuICAgICAgICAgICAgY29uc3Qgc2NoZW1lU2V0dGluZ3MgPSBKU09OLnBhcnNlKHRoaXMuY3VycmVudFNjaGVtZUl0ZW0ucXVlcnlDb25kaXRpb25TdHJpbmcpO1xyXG4gICAgICAgICAgICByZXR1cm4gc2NoZW1lU2V0dGluZ3NbdGhpcy5sb2NhbGVTZXIubG9jYWxlSWRdIGFzIFNldHRpbmdNb2RlbDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfVxyXG5cclxuICAgIG5nT25Jbml0KCk6IHZvaWQge1xyXG4gICAgICAgIC8vIOWIpOaWreaYr+WQpuWQr+eUqOWkmuihqOWktOWIl+iuvue9rlxyXG4gICAgICAgIHRoaXMuZW5hYmxlTXVsdGlwbGVIZWFkZXJzID0gdGhpcy5ncmlkSW5zdGFuY2UuZW5hYmxlU2V0TXVsdGlIZWFkZXJzO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIGNvbnN0IG9wdGlvbnMgPSB0aGlzLmdyaWRJbnN0YW5jZS5kZnNbJ19zdGF0ZSddLmluaXRpYWxPcHRpb25zO1xyXG4gICAgICAgIC8vIGlmIChvcHRpb25zLmNvbHVtbkZpZWxkcyAmJiBvcHRpb25zLmNvbHVtbkZpZWxkcy5sZW5ndGgpIHtcclxuICAgICAgICAvLyAgICAgdGhpcy5hbGxDb2xzID0gb3B0aW9ucy5jb2x1bW5GaWVsZHMuZmlsdGVyKChmOiBhbnkpID0+IGYuZmllbGQgIT09ICdfZGF0YWdyaWQtc2V0dGluZy1jb250cm9sXycpO1xyXG4gICAgICAgIC8vIH0gZWxzZSB7XHJcbiAgICAgICAgLy8gICAgIHRoaXMuYWxsQ29scyA9IHRoaXMuY29sdW1uc1swXTtcclxuICAgICAgICAvLyB9XHJcbiAgICAgICAgdGhpcy5hbGxDb2xzID0gdGhpcy5jb2x1bW5zWzBdO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGlmICh0aGlzLmdyaWRJbnN0YW5jZS5lbmFibGVTY2hlbWUpIHtcclxuICAgICAgICAgICAgaWYgKCF0aGlzLnByZXZTY2hlbWVJdGVtKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnByZXZTY2hlbWVJdGVtID0gY2xvbmVEZWVwKHRoaXMuY3VycmVudFNjaGVtZUl0ZW0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICggdGhpcy5jdXJyZW50U2NoZW1lSXRlbSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXR0aW5ncyA9IHRoaXMuZ2V0Q3VycmVudFNjaGVtZVNldHRpbmdzKCkgfHwge307XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMuc2V0dGluZ3MgfHwgIU9iamVjdC5rZXlzKHRoaXMuc2V0dGluZ3MpLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3Jlc2V0MkRlZmF1bHQoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICBjb25zdCB7IG11bHRpSGVhZGVycyB9ID0gdGhpcy5zZXR0aW5ncztcclxuXHJcbiAgICAgICAgdGhpcy5tdWx0aUhlYWRlck9wdGlvbnMgPSB7IGNvbHVtbnM6IHRoaXMuY29sdW1ucywgdHJlZURhdGE6IG11bHRpSGVhZGVycz9tdWx0aUhlYWRlcnMudHJlZURhdGE6IG51bGwgfTtcclxuICAgICAgICBpZiAoIXRoaXMuZW5hYmxlTXVsdGlwbGVIZWFkZXJzKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLnNldHRpbmdzICYmIHRoaXMuc2V0dGluZ3Mudmlld0NvbHVtbnMpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZmllbGRzID0gdGhpcy5zZXR0aW5ncy52aWV3Q29sdW1ucy5maWx0ZXIobiA9PiBuICE9ICdfZGF0YWdyaWQtc2V0dGluZy1jb250cm9sXycpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5kaXJ0eVNldHRpbmdzKHRydWUpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5maWVsZHMgPSB0aGlzLmdldFZpZXdDb2x1bW5zKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuY29udGFpbmVyLm5hdGl2ZUVsZW1lbnQuZm9jdXMoKTtcclxuICAgICAgICB0aGlzLnNlYXJjaFJlc3VsdElzVmlzaWJsZUFsbCA9IHRoaXMuc2VhY2hSZXN1bHRJc0NoZWNrQWxsKCk7XHJcbiAgICAgICAgdGhpcy5kZWZhdWx0U2NoZW1lTmFtZSA9IHRoaXMubG9jYWxlU2VyLmdldFZhbHVlKCdkYXRhZ3JpZC1zY2hlbWUuc3lzcHJlc2V0JykgfHwgdGhpcy5ncmlkSW5zdGFuY2UuZGVmYXVsdFNjaGVtZU5hbWU7XHJcblxyXG4gICAgICAgIGlmICh0aGlzLnNjaGVtZVNlcikge1xyXG5cclxuICAgICAgICAgICAgaWYgKHRoaXMuc2V0dGluZ3MgJiYgIU9iamVjdC5rZXlzKHRoaXMuc2V0dGluZ3MpLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuZ3JpZEluc3RhbmNlLmVuYWJsZVNjaGVtZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVzZXRUb0RlZmF1bHQoKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXR0aW5ncyA9IHRoaXMuZ2V0Q3VycmVudFNldHRpbmdzKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5zY2hlbWVTZXIuc2V0U2V0dGluZ3ModGhpcy5zZXR0aW5ncyk7XHJcblxyXG4gICAgICAgICAgICB0aGlzLmRlZmF1bHRTZXR0aW5ncygpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBuZ0FmdGVyVmlld0luaXQoKSB7XHJcbiAgICAgICAgLy8gY29uc29sZS5sb2codGhpcy5maWVsZHMpO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgZ2V0Vmlld0NvbHVtbnMoKSB7XHJcbiAgICAgICAgLy8g5aSa6KGo5aS0XHJcbiAgICAgICAgbGV0IHZpc2libGVDbHMgPSBbXTtcclxuICAgICAgICBpZiAodGhpcy5jb2x1bW5zLmxlbmd0aCA+IDEgKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY29sdW1ucy5mb3JFYWNoKGNvbHMgPT4ge1xyXG4gICAgICAgICAgICAgICAgdmlzaWJsZUNscyA9IHZpc2libGVDbHMuY29uY2F0KHRoaXMuX2dldFZpZXdDb2x1bW5zKGNvbHMpKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdmlzaWJsZUNscyA9IHRoaXMuY29sdW1uc1swXS5maWx0ZXIobiA9PiAobi52aXNpYmxlIHx8IG4udmlzaWJsZSA9PT0gdW5kZWZpbmVkKSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gdmlzaWJsZUNscy5tYXAobiA9PiBuLmZpZWxkKTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIF9nZXRWaWV3Q29sdW1ucyhjb2xzOiBhbnlbXSkge1xyXG4gICAgICAgIHJldHVybiBjb2xzLmZpbHRlcihjID0+ICFjLmNvbHNwYW4gJiYgKGMudmlzaWJsZSB8fCBjLnZpc2libGUgPT09IHVuZGVmaW5lZCkpO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyDmoLnmja7liJfnmoTnsbvlnovov5vooYznrZvpgInov4fmu6TvvIxcclxuICAgIC8vIGFsbCDmiYDmnInliJdcclxuICAgIC8vIHZpc2libGUg5Y+v6KeB5YiXXHJcbiAgICAvLyBoaWRkZW4g6ZqQ6JeP5YiXXHJcbiAgICAvLyBncm91cCDliIbnu4TliJdcclxuICAgIGZpbHRlckNvbHVtbnMoc2VhcmNoV29yZHMgPSAnJykge1xyXG4gICAgICAgIGxldCBjb2xzID0gW107XHJcblxyXG4gICAgICAgIGlmICh0aGlzLnN3aXRjaFZhbHVlKSB7XHJcbiAgICAgICAgICAgIGNvbHMgPSB0aGlzLmNvbHVtbnNbMF0uZmlsdGVyKG4gPT4gdGhpcy5maWVsZHMuaW5kZXhPZihuLmZpZWxkKSA+IC0xKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBjb2xzID0gdGhpcy5jb2x1bW5zWzBdO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHNlYXJjaFdvcmRzKSB7XHJcbiAgICAgICAgICAgIGNvbHMgPSBjb2xzLmZpbHRlcihjID0+IGMudGl0bGUudG9Mb3dlckNhc2UoKS5pbmRleE9mKHNlYXJjaFdvcmRzLnRvTG93ZXJDYXNlKCkpID4gLTEpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5hbGxDb2xzID0gY29scztcclxuICAgICAgICB0aGlzLnNlYXJjaFJlc3VsdElzVmlzaWJsZUFsbCA9IHRoaXMuc2VhY2hSZXN1bHRJc0NoZWNrQWxsKHRoaXMuYWxsQ29scy5maWx0ZXIobiA9PiBuLnZpc2libGUpKTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIHNlYWNoUmVzdWx0SXNDaGVja0FsbChzZWFyY2hGaWVsZHM/OiBhbnkpIHtcclxuICAgICAgICBjb25zdCBhbGxDb2xzTGVuZ3RoID0gdGhpcy5hbGxDb2xzLmZpbHRlcihuID0+IG4uZmllbGQgIT0gJ19kYXRhZ3JpZC1zZXR0aW5nLWNvbnRyb2xfJykubGVuZ3RoO1xyXG4gICAgICAgIGxldCBmaWVsZHNMZW5ndGggPSB0aGlzLmZpZWxkcy5maWx0ZXIobiA9PiBuICE9ICAnX2RhdGFncmlkLXNldHRpbmctY29udHJvbF8nKS5sZW5ndGg7XHJcblxyXG4gICAgICAgIGlmIChzZWFyY2hGaWVsZHMpIHtcclxuICAgICAgICAgICAgZmllbGRzTGVuZ3RoID0gc2VhcmNoRmllbGRzLmxlbmd0aDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIGNoZWNrQWxsOiBhbGxDb2xzTGVuZ3RoICYmIGFsbENvbHNMZW5ndGggPT09IGZpZWxkc0xlbmd0aCxcclxuICAgICAgICAgICAgdW5DaGVja0FsbDohc2VhcmNoRmllbGRzID8gIXRoaXMuZmllbGRzLmxlbmd0aCA6ICFmaWVsZHNMZW5ndGhcclxuICAgICAgICB9O1xyXG4gICAgfVxyXG5cclxuXHJcbiAgICBwcml2YXRlIG9uRmllbGRzQ2hhbmdlZCgpIHtcclxuICAgICAgICBpZiAoIXRoaXMuZ3JpZEluc3RhbmNlLmVuYWJsZVNjaGVtZSkge1xyXG4gICAgICAgICAgICB0aGlzLmZpZWxkc0NoYW5nZS5lbWl0KHRoaXMuZmllbGRzKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgb25EYmxDbGljaygkZXZlbnQsIGNvbCkge1xyXG4gICAgICAgIHRoaXMub25DaGVja2JveENsaWNrKCRldmVudCwgY29sKTtcclxuICAgIH1cclxuXHJcbiAgICBvbkNoZWNrYm94Q2xpY2soJGV2ZW50LCBjb2wpIHtcclxuICAgICAgICAkZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgdGhpcy5zaG93U2NoZW1lUGFuZWwgPSBmYWxzZTtcclxuICAgICAgICBsZXQgY2hlY2tlZCA9IGZhbHNlO1xyXG4gICAgICAgIGNvbnN0IGluZGV4ID0gdGhpcy5maWVsZHMuaW5kZXhPZihjb2wuZmllbGQpO1xyXG4gICAgICAgIGlmIChpbmRleCA9PT0gLTEpIHtcclxuICAgICAgICAgICAgdGhpcy5maWVsZHMucHVzaChjb2wuZmllbGQpO1xyXG4gICAgICAgICAgICBjaGVja2VkID0gdHJ1ZTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLmZpZWxkcy5zcGxpY2UoaW5kZXgsIDEpO1xyXG4gICAgICAgICAgICBjaGVja2VkID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLmNvbHVtbnNbMF0uZm9yRWFjaChmID0+IHtcclxuICAgICAgICAgICAgZi52aXNpYmxlID0gdGhpcy5maWVsZHMuaW5kZXhPZihmLmZpZWxkKSA+IC0xO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICB0aGlzLmZpZWxkcyA9IHRoaXMuY29sdW1uc1swXS5maWx0ZXIobiA9PiBuLnZpc2libGUpLm1hcChuID0+IG4uZmllbGQpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGNvbnN0IF9maWVsZHMgPSB0aGlzLmFsbENvbHMuZmlsdGVyKG4gPT4gbi52aXNpYmxlKS5tYXAobiA9PiBuLmZpZWxkKTtcclxuICAgICAgICB0aGlzLnNlYXJjaFJlc3VsdElzVmlzaWJsZUFsbCA9IHRoaXMuc2VhY2hSZXN1bHRJc0NoZWNrQWxsKF9maWVsZHMpO1xyXG4gICAgICBcclxuICAgICAgICB0aGlzLmRpcnR5U2V0dGluZ3ModHJ1ZSk7XHJcbiAgICAgICAgdGhpcy5vbkZpZWxkc0NoYW5nZWQoKTtcclxuICAgIH1cclxuXHJcbiAgICBzZWFyY2hDb2x1bW4oJGV2ZW50KSB7XHJcbiAgICAgICAgdGhpcy5zd2l0Y2hWYWx1ZSA9IGZhbHNlO1xyXG4gICAgICAgIGNvbnN0IHR4dCA9ICRldmVudC50YXJnZXQudmFsdWU7XHJcbiAgICAgICAgdGhpcy5maWx0ZXJDb2x1bW5zKHR4dCk7XHJcbiAgICB9XHJcblxyXG4gICAgb25GaWVsZERyb3AoZmllbGRJbmZvLCB0eHQsIHVsRWxSZWY6IGFueSkge1xyXG4gICAgICAgIHRoaXMuc2hvd1NjaGVtZVBhbmVsID0gZmFsc2U7XHJcbiAgICAgICAgY29uc3QgeyByZW1vdmVkSW5kZXgsIGFkZGVkSW5kZXggfSA9IGZpZWxkSW5mbztcclxuXHJcbiAgICAgICAgY29uc3QgbW92ZUl0ZW0gPSB0aGlzLmFsbENvbHNbcmVtb3ZlZEluZGV4XTtcclxuICAgICAgICBjb25zdCB0YXJnZXRJdGVtID0gdGhpcy5hbGxDb2xzW2FkZGVkSW5kZXhdO1xyXG5cclxuICAgICAgICBjb25zdCBtb3ZlSXRlbUluZGV4ID0gdGhpcy5jb2x1bW5zWzBdLmZpbmRJbmRleChuID0+IG4uZmllbGQgPT09IG1vdmVJdGVtLmZpZWxkKTtcclxuICAgICAgICBjb25zdCB0YXJnZXRJdGVtSW5kZXggPSB0aGlzLmNvbHVtbnNbMF0uZmluZEluZGV4KG4gPT4gbi5maWVsZCA9PT0gdGFyZ2V0SXRlbS5maWVsZCk7XHJcblxyXG4gICAgICAgIGNvbnN0IHJlbW92ZWRJdGVtID0gdGhpcy5jb2x1bW5zWzBdLnNwbGljZShtb3ZlSXRlbUluZGV4LCAxKTtcclxuICAgICAgICB0aGlzLmNvbHVtbnNbMF0uc3BsaWNlKHRhcmdldEl0ZW1JbmRleCwgMCwgLi4ucmVtb3ZlZEl0ZW0pO1xyXG5cclxuICAgICAgICB0aGlzLmZpZWxkcyA9IHRoaXMuY29sdW1uc1swXS5maWx0ZXIobiA9PiBuLnZpc2libGUpLm1hcChuID0+IG4uZmllbGQpO1xyXG5cclxuICAgICAgICB0aGlzLm9uRmllbGRzQ2hhbmdlZCgpO1xyXG4gICAgICAgIHRoaXMuZmlsdGVyQ29sdW1ucyh0eHQpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogMDogMeS4quS5n+ayoeaciemAieS4re+8myAxOiDlhajpg6jpgInkuK3vvJsgMjog5pyJ6YCJ5Lit55qE5Lmf5pyJ5rKh6YCJ5Lit55qEXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgZ2V0Q2hlY2tBbGxTdGF0ZSgpIHtcclxuICAgICAgICBpZiAoIXRoaXMuc2VhcmNoSW5wdXQubmF0aXZlRWxlbWVudC52YWx1ZSkge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5maWVsZHMubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gMDtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmZpZWxkcy5sZW5ndGggPT09IHRoaXMuY29sdW1uc1swXS5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gMTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiAyO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgY29uc3QgdmlzaWJsZUxlbiA9IHRoaXMuYWxsQ29scy5maWx0ZXIobiA9PiBuLnZpc2libGUpLmxlbmd0aDtcclxuICAgICAgICAgICAgaWYgKHZpc2libGVMZW4gPT09IHRoaXMuYWxsQ29scy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiAxO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgaWYgKHZpc2libGVMZW4gPCB0aGlzLmFsbENvbHMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHZpc2libGVMZW4gPT09IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDBcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDE7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy8g5YWo6YCJXHJcbiAgICBvbkNoZWNrQWxsQ2xpY2soJGV2ZW50OiBNb3VzZUV2ZW50LCB0eHQpIHtcclxuICAgICAgICAkZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgaWYgKCF0aGlzLmFsbENvbHMgfHwgIXRoaXMuYWxsQ29scy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnNob3dTY2hlbWVQYW5lbCA9IGZhbHNlO1xyXG4gICAgICAgIGNvbnN0IHN0YXRlID0gdGhpcy5nZXRDaGVja0FsbFN0YXRlKCk7XHJcblxyXG4gICAgICAgIGNvbnN0IGlzQ2hlY2tBbGwgPSBzdGF0ZSA9PT0gMCB8fCBzdGF0ZSA9PT0gMjtcclxuXHJcbiAgICAgICAgbGV0IF9maWVsZHMgPSBudWxsO1xyXG4gICAgICAgIGlmICghdHh0KSB7XHJcbiAgICAgICAgICAgIHRoaXMuY29sdW1uc1swXS5mb3JFYWNoKG4gPT4gbi52aXNpYmxlID0gaXNDaGVja0FsbCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5jb2x1bW5zWzBdLmZvckVhY2gobiA9PiB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpdGVtID0gdGhpcy5hbGxDb2xzLmZpbmQoYSA9PiBuLmZpZWxkID09IGEuZmllbGQpO1xyXG4gICAgICAgICAgICAgICAgaWYgKGl0ZW0pIHtcclxuICAgICAgICAgICAgICAgICAgICBuLnZpc2libGUgPSBpc0NoZWNrQWxsO1xyXG4gICAgICAgICAgICAgICAgICAgIGl0ZW0udmlzaWJsZSA9IGlzQ2hlY2tBbGw7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBfZmllbGRzID0gdGhpcy5hbGxDb2xzLmZpbHRlcihuID0+IG4udmlzaWJsZSkubWFwKG4gPT4gbi5maWVsZCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuZmllbGRzID0gdGhpcy5jb2x1bW5zWzBdLmZpbHRlcihuID0+IG4udmlzaWJsZSkubWFwKG4gPT4gbi5maWVsZCk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgdGhpcy5zZWFyY2hSZXN1bHRJc1Zpc2libGVBbGwgPSB0aGlzLnNlYWNoUmVzdWx0SXNDaGVja0FsbCghdHh0ID8gbnVsbDogX2ZpZWxkcyk7XHJcblxyXG4gICAgICAgIHRoaXMuZGlydHlTZXR0aW5ncyh0cnVlKTtcclxuICAgICAgICB0aGlzLmNkLmRldGVjdENoYW5nZXMoKTtcclxuICAgICAgICB0aGlzLm9uRmllbGRzQ2hhbmdlZCgpO1xyXG4gICAgICAgIC8vIHRoaXMuZmlsdGVyQ29sdW1ucyh0eHQpO1xyXG4gICAgfVxyXG5cclxuICAgIGNsb3NlKCRldmVudD86IE1vdXNlRXZlbnQpIHtcclxuICAgICAgICBpZiAoJGV2ZW50KSB7XHJcbiAgICAgICAgICAgICRldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5jbG9zZWQuZW1pdCgpO1xyXG4gICAgfVxyXG5cclxuICAgIGNhbmNlbCgkZXZlbnQ/OiBNb3VzZUV2ZW50KSB7XHJcbiAgICAgICAgdGhpcy5jdXJyZW50U2NoZW1lSXRlbSA9IHRoaXMucHJldlNjaGVtZUl0ZW07XHJcbiAgICAgICAgLy8gdGhpcy5zY2hlbWVDaGFuZ2VkLmVtaXQodGhpcy5wcmV2U2NoZW1lSXRlbSk7XHJcbiAgICAgICAgdGhpcy5jbG9zZSgkZXZlbnQpO1xyXG4gICAgICAgIHRoaXMuY2FuY2VsZC5lbWl0KCk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8g5omT5byA6auY57qn6K6+572u56qX5Y+jXHJcbiAgICBzaG93QWR2YW5jZWQoJGV2ZW50KSB7XHJcbiAgICAgICAgdGhpcy5jbG9zZSgkZXZlbnQpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIHRoaXMuc2V0dGluZ3MgPSB0aGlzLmdldEN1cnJlbnRTZXR0aW5ncygpO1xyXG5cclxuICAgICAgICBpZiAodGhpcy5lbmFibGVNdWx0aXBsZUhlYWRlcnMpIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMubXVsdGlIZWFkZXJSZWYpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0dGluZ3MubXVsdGlIZWFkZXJzID0gdGhpcy5tdWx0aUhlYWRlclJlZi5nZXRTZXR0aW5ncygpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSAgICBcclxuICAgICAgICB0aGlzLmFkdmFuY2VkLmVtaXQoeyB2aWV3RmllbGRzOiB0aGlzLmZpZWxkcywgc2V0dGluZ3M6IHRoaXMuc2V0dGluZ3MsIGNvbHVtbnM6IHRoaXMuY29sdW1ucyB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvLyDmgaLlpI3pu5jorqRcclxuICAgIG9uU2V0dGluZ1Jlc2V0KCRldmVudD86IGFueSkge1xyXG4gICAgICAgIGlmICgkZXZlbnQpIHtcclxuICAgICAgICAgICAgJGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5zaG93U2NoZW1lUGFuZWwgPSBmYWxzZTtcclxuICAgICAgICBjb25zdCByZXN0b3JEZWZhdWx0VGV4dCA9IHRoaXMubG9jYWxlU2VyLmdldFZhbHVlKCdkYXRhZ3JpZC5zZXR0aW5ncy5yZXN0b3JlRGVmYXVsdFNldHRpbmdzVGV4dCcpIHx8ICfmgqjnoa7lrpropoHmgaLlpI3pu5jorqTorr7nva7lkJfvvJ8nO1xyXG4gICAgICAgIHRoaXMubWVzc2FnZXIuY29uZmlybShyZXN0b3JEZWZhdWx0VGV4dCwgMjAzNSkuc3Vic2NyaWJlKCh0OiBib29sZWFuKSA9PiB7XHJcbiAgICAgICAgICAgIGlmICh0KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnJlc2V0VG9EZWZhdWx0KCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmRpcnR5U2V0dGluZ3ModHJ1ZSk7XHJcblxyXG4gICAgICAgICAgICAgICAgdGhpcy5zZWFyY2hSZXN1bHRJc1Zpc2libGVBbGwgPSB0aGlzLnNlYWNoUmVzdWx0SXNDaGVja0FsbCgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgcmVzZXRUb0RlZmF1bHQoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuZW5hYmxlTXVsdGlwbGVIZWFkZXJzKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3Jlc2V0MkRlZmFsdXRGb3JtTXVsdGlIZWFkZXJzKClcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLl9yZXNldDJEZWZhdWx0KCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuXHJcbiAgICBwcml2YXRlIF9yZXNldDJEZWZhbHV0Rm9ybU11bHRpSGVhZGVycygpIHtcclxuICAgICAgICBjb25zdCB7IHNldHRpbmdzLCBtdWx0aUhlYWRlck9wdGlvbnMgfSA9IHJlc2V0MkRlZmF1bHRGb3JNdWx0aUhlYWRlcnModGhpcy5ncmlkSW5zdGFuY2UpO1xyXG4gICAgICAgIHRoaXMuc2V0dGluZ3MgPSBzZXR0aW5ncyxcclxuICAgICAgICB0aGlzLm11bHRpSGVhZGVyT3B0aW9ucyA9IG11bHRpSGVhZGVyT3B0aW9ucztcclxuICAgIH1cclxuXHJcblxyXG4gICAgcHJpdmF0ZSBfcmVzZXQyRGVmYXVsdCgpIHtcclxuICAgICAgICBjb25zdCBvcHRpb25zID0gdGhpcy5ncmlkSW5zdGFuY2UuZGZzWydfc3RhdGUnXS5pbml0aWFsT3B0aW9ucztcclxuICAgICAgICBpZiAob3B0aW9ucy5jb2x1bW5GaWVsZHMgJiYgb3B0aW9ucy5jb2x1bW5GaWVsZHMubGVuZ3RoKSB7XHJcblxyXG4gICAgICAgICAgICBjb25zdCBuZXdDb2x1bW5zID0gW107XHJcbiAgICAgICAgICAgIG9wdGlvbnMuY29sdW1uRmllbGRzLmZvckVhY2goYyA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAoYy5maWVsZCAhPT0gJ19kYXRhZ3JpZC1zZXR0aW5nLWNvbnRyb2xfJykge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGNvbCA9IHRoaXMuY29sdW1uc1swXS5maW5kKChuOiBhbnkpID0+IG4uZmllbGQgPT09IGMuZmllbGQpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChjb2wpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29sLnZpc2libGUgPSBjLnZpc2libGU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbC5oYWxpZ24gPSBjLmhhbGlnbjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29sLmFsaWduID0gYy5hbGlnbjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29sLndpZHRoID0gYy53aWR0aDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29sLmZvb3RlciA9IHsuLi5jLmZvb3RlciB8fCB7fX07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbC5ncm91cEZvb3RlciA9IHsuLi5jLmdyb3VwRm9vdGVyIHx8IHt9fTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29sLnRpdGxlID0gYy50aXRsZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29sLmZpeGVkID0gYy5maXhlZCB8fCAnJztcclxuICAgICAgICAgICAgICAgICAgICAgICAgbmV3Q29sdW1ucy5wdXNoKGNvbCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuY29sdW1ucyA9IFtuZXdDb2x1bW5zXTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuYWxsQ29scyA9IHRoaXMuY29sdW1uc1swXTtcclxuICAgICAgICB0aGlzLnNldHRpbmdzID0ge307XHJcbiAgICAgICAgdGhpcy5maWVsZHMgPSB0aGlzLmdldFZpZXdDb2x1bW5zKCk7XHJcbiAgICAgICAgdGhpcy5zZXR0aW5ncy52aWV3Q29sdW1ucyA9IHRoaXMuZmllbGRzO1xyXG4gICAgICAgIHRoaXMuc2V0dGluZ3MuY29sdW1uRm9ybWF0ID0gWy4uLnRoaXMuY29sdW1uc1swXV07XHJcbiAgICAgICAgaWYgKG9wdGlvbnMuc29ydCkge1xyXG4gICAgICAgICAgICBjb25zdCBzb3J0T3JkZXJzID0gb3B0aW9ucy5zb3J0LnNvcnRPcmRlcj8gb3B0aW9ucy5zb3J0LnNvcnRPcmRlci5zcGxpdCgnLCcpIDogW107XHJcbiAgICAgICAgICAgIGNvbnN0IHNvcnROYW1lcyA9IG9wdGlvbnMuc29ydC5zb3J0TmFtZSA/IG9wdGlvbnMuc29ydC5zb3J0TmFtZS5zcGxpdCgnLCcpIDogW107XHJcbiAgICAgICAgICAgIHRoaXMuc2V0dGluZ3Muc29ydEluZm8gPSB7IHNvcnROYW1lOiBzb3J0TmFtZXMsIHNvcnRPcmRlcjogIHNvcnRPcmRlcnMgfTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLnNldHRpbmdzLnNvcnRJbmZvID0ge307XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuc2V0dGluZ3MuZ3JvdXBGaWVsZCA9ICBvcHRpb25zLmdyb3VwRmllbGQgPyBvcHRpb25zLmdyb3VwRmllbGQuc3BsaXQoJywnKSA6IFtdO1xyXG4gICAgICAgIHRoaXMuc2V0dGluZ3MuZXhwYW5kR3JvdXBSb3dzID0gISFvcHRpb25zLmV4cGFuZEdyb3VwUm93cztcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGdldEN1cnJlbnRTZXR0aW5ncygpIHtcclxuICAgICAgICBsZXQgX3NldHRpbmdzOiBhbnkgPSB7fTtcclxuICAgICAgICBfc2V0dGluZ3Mudmlld0NvbHVtbnMgPSB0aGlzLmZpZWxkcztcclxuXHJcbiAgICAgICAgaWYgKCF0aGlzLmVuYWJsZVNjaGVtZSkge1xyXG4gICAgICAgICAgICBpZiAoIV9zZXR0aW5ncy5jb2x1bW5Gb3JtYXQpIHtcclxuICAgICAgICAgICAgICAgIF9zZXR0aW5ncy5jb2x1bW5Gb3JtYXQgPSBbLi4udGhpcy5jb2x1bW5zWzBdXTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKCFfc2V0dGluZ3Muc29ydEluZm8pIHtcclxuICAgICAgICAgICAgICAgIF9zZXR0aW5ncy5zb3J0SW5mbyA9IHtcclxuICAgICAgICAgICAgICAgICAgICBzb3J0TmFtZTogdGhpcy5ncmlkSW5zdGFuY2Uuc29ydE5hbWUgPyB0aGlzLmdyaWRJbnN0YW5jZS5zb3J0TmFtZS5zcGxpdCgnLCcpIDogW10sXHJcbiAgICAgICAgICAgICAgICAgICAgc29ydE9yZGVyOiAgdGhpcy5ncmlkSW5zdGFuY2Uuc29ydE9yZGVyID8gdGhpcy5ncmlkSW5zdGFuY2Uuc29ydE9yZGVyLnNwbGl0KCcsJykgOiBbXVxyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKF9zZXR0aW5ncy5ncm91cEZpZWxkID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgIF9zZXR0aW5ncy5ncm91cEZpZWxkID0gdGhpcy5ncmlkSW5zdGFuY2UuZ3JvdXBGaWVsZCA/IHRoaXMuZ3JpZEluc3RhbmNlLmdyb3VwRmllbGQuc3BsaXQoJywnKSA6IFtdO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgX3NldHRpbmdzID0gT2JqZWN0LmFzc2lnbih0aGlzLnNldHRpbmdzfHwge30sICBfc2V0dGluZ3MpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKF9zZXR0aW5ncy5leHBhbmRHcm91cFJvd3MgPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIF9zZXR0aW5ncy5leHBhbmRHcm91cFJvd3MgPSB0aGlzLmdyaWRJbnN0YW5jZVsnZXhwYW5kR3JvdXBSb3dzJ107XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gX3NldHRpbmdzO1xyXG4gICAgfVxyXG5cclxuXHJcbiAgICAvLyDnoa7lrprmjInpkq7ngrnlh7vkuovku7ZcclxuICAgIG9uU3VibWl0Q2xpY2soJGV2ZW50PzogYW55KSB7XHJcbiAgICAgICAgaWYgKCRldmVudCkge1xyXG4gICAgICAgICAgICAkZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoIXRoaXMuZW5hYmxlTXVsdGlwbGVIZWFkZXJzKSB7XHJcbiAgICAgICAgICAgIGlmICghdGhpcy5maWVsZHMgfHwgIXRoaXMuZmllbGRzLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5ub3RpZnkud2FybmluZyh0aGlzLm5vRGlzcGx5Q29sdW1uVGlwKTtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gXHJcblxyXG4gICAgICAgIHRoaXMucHJldlNjaGVtZUl0ZW0gPSB0aGlzLmN1cnJlbnRTY2hlbWVJdGVtO1xyXG5cclxuICAgICAgICB0aGlzLnNob3dTY2hlbWVQYW5lbCA9IGZhbHNlO1xyXG5cclxuICAgICAgICB0aGlzLnNldHRpbmdzID0gdGhpcy5nZXRDdXJyZW50U2V0dGluZ3MoKTtcclxuXHJcbiAgICAgICAgLy8g5ZCv55So5aSa6KGo5aS05pe277yM6Kem5Y+R5paw55qE5LqL5Lu2XHJcbiAgICAgICAgaWYgKHRoaXMuZW5hYmxlTXVsdGlwbGVIZWFkZXJzKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLm11bHRpSGVhZGVyUmVmKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBfbXVsdGlIZWFkZXJzID0gdGhpcy5tdWx0aUhlYWRlclJlZi5nZXRTZXR0aW5ncygpO1xyXG4gICAgICAgICAgICAgICAgaWYgKCFtdWx0aUhlYWRlcnNIYXNEYXRhRmllbGRzKF9tdWx0aUhlYWRlcnMudmlld0NvbHMpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5ub3RpZnkuaW5mbyh0aGlzLm5vRGlzcGx5Q29sdW1uVGlwKTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgbWVyZ2VTb3J0SW5mbyhfbXVsdGlIZWFkZXJzLnZpZXdDb2xzLCB0aGlzLnNldHRpbmdzLnNvcnRJbmZvKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0dGluZ3MubXVsdGlIZWFkZXJzID0gX211bHRpSGVhZGVycztcclxuICAgICAgICAgICAgfVxyXG5cclxuXHJcbiAgICAgICAgICAgIHRoaXMuc3VibWl0Rm9yR3JvdXBIZWFkZXIuZW1pdCh7XHJcbiAgICAgICAgICAgICAgICBjb250ZW50OiB0aGlzLnNldHRpbmdzLFxyXG4gICAgICAgICAgICAgICAgY2xvc2U6IHRoaXMuY2xvc2UuYmluZCh0aGlzKSxcclxuICAgICAgICAgICAgICAgIHRhcmdldDogdGhpcy5idG5Pay5uYXRpdmVFbGVtZW50LFxyXG4gICAgICAgICAgICAgICAgY3VycmVudFNjaGVtZTogdGhpcy5jdXJyZW50U2NoZW1lSXRlbVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLnN1Ym1pdC5lbWl0KHtcclxuICAgICAgICAgICAgICAgIGNvbnRlbnQ6IHRoaXMuc2V0dGluZ3MsXHJcbiAgICAgICAgICAgICAgICBjbG9zZTogdGhpcy5jbG9zZS5iaW5kKHRoaXMpLFxyXG4gICAgICAgICAgICAgICAgdGFyZ2V0OiB0aGlzLmJ0bk9rLm5hdGl2ZUVsZW1lbnQsXHJcbiAgICAgICAgICAgICAgICBjdXJyZW50U2NoZW1lOiB0aGlzLmN1cnJlbnRTY2hlbWVJdGVtXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBjb2xsZWN0U2V0dGluZ3MoKSB7XHJcbiAgICAgICBcclxuICAgICAgICB0aGlzLnNldHRpbmdzID0gdGhpcy5nZXRDdXJyZW50U2V0dGluZ3MoKTtcclxuXHJcbiAgICAgICAgLy8g5ZCv55So5aSa6KGo5aS05pe277yM6Kem5Y+R5paw55qE5LqL5Lu2XHJcbiAgICAgICAgaWYgKHRoaXMuZW5hYmxlTXVsdGlwbGVIZWFkZXJzKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLm11bHRpSGVhZGVyUmVmKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBfbXVsdGlIZWFkZXJzID0gdGhpcy5tdWx0aUhlYWRlclJlZi5nZXRTZXR0aW5ncygpO1xyXG4gICAgICAgICAgICAgICAgaWYgKCFtdWx0aUhlYWRlcnNIYXNEYXRhRmllbGRzKF9tdWx0aUhlYWRlcnMudmlld0NvbHMpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5ub3RpZnkuaW5mbyh0aGlzLm5vRGlzcGx5Q29sdW1uVGlwKTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgbWVyZ2VTb3J0SW5mbyhfbXVsdGlIZWFkZXJzLnZpZXdDb2xzLCB0aGlzLnNldHRpbmdzLnNvcnRJbmZvKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0dGluZ3MubXVsdGlIZWFkZXJzID0gX211bHRpSGVhZGVycztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgXHJcbiAgICAgICAgcmV0dXJuIHsgLi4udGhpcy5zZXR0aW5ncyB9O1xyXG4gICAgfVxyXG5cclxuICAgIC8vIOaYvuekuuS4i+aLieaWueahiOWIl+ihqFxyXG4gICAgb25DaG9vc2VTY2hlbWUoJGV2ZW50KSB7XHJcbiAgICAgICAgaWYgKCRldmVudCkge1xyXG4gICAgICAgICAgICAkZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLnNob3dTY2hlbWVQYW5lbCA9ICF0aGlzLnNob3dTY2hlbWVQYW5lbDtcclxuXHJcbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLnNjaGVtZWl0ZW1zRWxlUmVmICYmIHRoaXMuY3VycmVudFNjaGVtZUl0ZW0pIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGl0ZW1FbCA9IHRoaXMuc2NoZW1laXRlbXNFbGVSZWYubmF0aXZlRWxlbWVudC5xdWVyeVNlbGVjdG9yKGAjc2NoZW1laXRlbV8ke3RoaXMuY3VycmVudFNjaGVtZUl0ZW0uaWR9YCk7XHJcbiAgICAgICAgICAgICAgICBpZiAoaXRlbUVsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGl0ZW1FbC5zY3JvbGxJbnRvVmlld0lmTmVlZGVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW1FbC5zY3JvbGxJbnRvVmlld0lmTmVlZGVkKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaXRlbUVsLnNjcm9sbEludG9WaWV3KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSlcclxuICAgIH1cclxuXHJcbiAgICAvLyDku4XmmL7npLrlj6/op4HliJdcclxuICAgIG9ubHlTZWVWaXNpYmxlQ29sdW1ucygkZXZlbnQsIHNlYXJjaFdvcmRzKSB7XHJcbiAgICAgICAgdGhpcy5zd2l0Y2hWYWx1ZSA9ICRldmVudDtcclxuICAgICAgICB0aGlzLmZpbHRlckNvbHVtbnMoc2VhcmNoV29yZHMpO1xyXG4gICAgfVxyXG5cclxuICAgIHJlZnJlc2goKSB7XHJcbiAgICAgICAgaWYgKCF0aGlzLmNkWydkZXN0cm95ZWQnXSkge1xyXG4gICAgICAgICAgICB0aGlzLmNkLmRldGVjdENoYW5nZXMoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgaGlkZVBhbmVsKCkge1xyXG4gICAgICAgIHRoaXMuc2hvd1NjaGVtZVBhbmVsID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5yZWZyZXNoKCk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8g5paw5aKe5pa55qGIXHJcbiAgICBvbk5ld1NjaGVtZUNsaWNrKCRldmVudCwgc2F2ZWFzID0gJ25ldycpIHtcclxuICAgICAgICBpZiAoJGV2ZW50KSB7XHJcbiAgICAgICAgICAgICRldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5oaWRlUGFuZWwoKTtcclxuICAgICAgICB0aGlzLmFkZE5ld1NjaGVtZS5lbWl0KHsgdHlwZTogc2F2ZWFzIHx8ICduZXcnIH0pO1xyXG5cclxuICAgICAgICBcclxuICAgIH1cclxuXHJcbiAgICAvLyDmmL7npLrmlrnmoYjliJfooajnrqHnkIbnqpflj6NcclxuICAgIG9uU2hvd1NjaGVtZUxpc3QoJGV2ZW50KSB7XHJcbiAgICAgICAgaWYgKCRldmVudCkge1xyXG4gICAgICAgICAgICAkZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuaGlkZVBhbmVsKCk7XHJcbiAgICAgICAgdGhpcy5zaG93U2NoZW1lTGlzdC5lbWl0KCk7XHJcbiAgICB9XHJcblxyXG5cclxuICAgIHByaXZhdGUgc2NoZW1lQ2hhbmdlZEZvclNpbmdsZUhlYWRlcihzY2hlbWVTZXR0aW5ncykge1xyXG4gICAgICAgIGlmICghc2NoZW1lU2V0dGluZ3MpIHtcclxuICAgICAgICAgICAgdGhpcy5fcmVzZXQyRGVmYXVsdCgpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2V0dGluZ3MgPSBzY2hlbWVTZXR0aW5ncztcclxuICAgICAgICAgICAgdGhpcy5maWVsZHMgPSBzY2hlbWVTZXR0aW5ncy52aWV3Q29sdW1ucztcclxuICAgICAgICAgICAgdGhpcy5jb2x1bW5zWzBdLmZvckVhY2goZiA9PiB7XHJcbiAgICAgICAgICAgICAgICBmLnZpc2libGUgPSB0aGlzLmZpZWxkcy5pbmRleE9mKGYuZmllbGQpID4gLTE7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5zZWFyY2hSZXN1bHRJc1Zpc2libGVBbGwgPSB0aGlzLnNlYWNoUmVzdWx0SXNDaGVja0FsbCgpO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgc2NoZW1lQ2hhbmdlZEZvck11bHRpSGVhZGVycyhzY2hlbWVTZXR0aW5ncykge1xyXG4gICAgICAgIGlmIChzY2hlbWVTZXR0aW5ncykge1xyXG4gICAgICAgICAgICB0aGlzLnNldHRpbmdzID0gc2NoZW1lU2V0dGluZ3M7XHJcbiAgICAgICAgICAgIGNvbnN0IG9wdGlvbnMgPSB0aGlzLmdyaWRJbnN0YW5jZS5kZnNbJ19zdGF0ZSddLmluaXRpYWxPcHRpb25zO1xyXG4gICAgICAgICAgICB0aGlzLm11bHRpSGVhZGVyT3B0aW9ucyA9IHtcclxuICAgICAgICAgICAgICAgIHRyZWVEYXRhOiB0aGlzLnNldHRpbmdzLm11bHRpSGVhZGVycz8gdGhpcy5zZXR0aW5ncy5tdWx0aUhlYWRlcnMudHJlZURhdGE6IG51bGwsXHJcbiAgICAgICAgICAgICAgICBjb2x1bW5zOiBvcHRpb25zLmdyb3VwSGVhZGVyRmllbGRzXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLl9yZXNldDJEZWZhbHV0Rm9ybU11bHRpSGVhZGVycygpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyDmlrnmoYjngrnlh7tcclxuICAgIG9uU2NoZW1lSXRlbUNsaWNrKCRldmVudCwgaXRlbSkge1xyXG4gICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRTY2hlbWVJdGVtID0gaXRlbTtcclxuICAgICAgICAgICAgdGhpcy5zaG93U2NoZW1lUGFuZWwgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgICAgIGxldCBzY2hlbWVTZXR0aW5ncyA9IG51bGw7XHJcbiAgICAgICAgICAgIGlmIChpdGVtICYmIGl0ZW0ucXVlcnlDb25kaXRpb25TdHJpbmcpIHtcclxuICAgICAgICAgICAgICAgIHNjaGVtZVNldHRpbmdzID0gSlNPTi5wYXJzZShpdGVtLnF1ZXJ5Q29uZGl0aW9uU3RyaW5nKTtcclxuICAgICAgICAgICAgICAgIHNjaGVtZVNldHRpbmdzID0gc2NoZW1lU2V0dGluZ3NbdGhpcy5sb2NhbGVTZXIubG9jYWxlSWRdO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAodGhpcy5lbmFibGVNdWx0aXBsZUhlYWRlcnMpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2NoZW1lQ2hhbmdlZEZvck11bHRpSGVhZGVycyhzY2hlbWVTZXR0aW5ncyk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNjaGVtZUNoYW5nZWRGb3JTaW5nbGVIZWFkZXIoc2NoZW1lU2V0dGluZ3MpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB0aGlzLnNjaGVtZVNlci5zZXRTZXR0aW5ncyh0aGlzLnNldHRpbmdzKTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuZGVmYXVsdFNldHRpbmdzKGl0ZW0pO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5zY2hlbWVDaGFuZ2VkLmVtaXQoaXRlbSk7XHJcbiAgICAgICAgICAgIHRoaXMucmVmcmVzaCgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKiDlpJrooajlpLTpu5jorqTorr7nva4gKi9cclxuICAgIHByaXZhdGUgZGVmYXVsdFNldHRpbmdzKGl0ZW0/OiBhbnkpIHtcclxuICAgICAgICBpZiAodGhpcy5lbmFibGVNdWx0aXBsZUhlYWRlcnMpIHtcclxuICAgICAgICAgICAgaWYgKCFpdGVtIHx8ICh0aGlzLnNldHRpbmdzICYmIHRoaXMuc2V0dGluZ3MubXVsdGlIZWFkZXJzICYmICF0aGlzLnNldHRpbmdzLm11bHRpSGVhZGVycy50cmVlRGF0YSkpIHsgLy8g57O757uf6aKE572uXHJcbiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNldHRpbmdzLm11bHRpSGVhZGVycyA9IHRoaXMubXVsdGlIZWFkZXJSZWYuZ2V0U2V0dGluZ3MoKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNjaGVtZVNlci5zZXRTZXR0aW5ncyh0aGlzLnNldHRpbmdzKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGRpcnR5U2V0dGluZ3MoZmxhZykge1xyXG4gICAgICAgIC8vIHRoaXMuaXNDaGFuZ2VkID0gZmxhZztcclxuICAgIH1cclxuXHJcbiAgICBjbGVhclNlYXJjaCgkZXZlbnQsIGlucHV0KSB7XHJcbiAgICAgICAgaWYgKGlucHV0ICYmIGlucHV0LnZhbHVlKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZmlsdGVyQ29sdW1ucygnJyk7XHJcbiAgICAgICAgICAgIGlucHV0LnZhbHVlID0gJyc7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcbiJdfQ==