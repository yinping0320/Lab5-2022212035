/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { map, switchMap } from 'rxjs/operators';
import { forkJoin, of, timer } from 'rxjs';
import { Injectable, Injector, InjectionToken, ComponentFactoryResolver, ApplicationRef } from '@angular/core';
import { BsModalService } from '@farris/ui-modal';
import { MessagerService } from '@farris/ui-messager';
import { DatagridSettingsComponent } from './datagrid-settings.component';
import { cloneDeep } from 'lodash-es';
import { LocaleService } from '@farris/ui-locale';
import { CommonUtils, DebugService, IdService } from '@farris/ui-common';
import { SimpleColumnsComponent } from './simple-mode/simple-columns.component';
import { DatagridSchemeService } from './datagrid-scheme.service';
import { NewSchemeComponent } from './scheme/newscheme.component';
import { SchemeListComponent } from './scheme/scheme-list.component';
import { NotifyService } from '@farris/ui-notify';
import { DATAGRID_SETTINGS_LOCALEDATA } from './datagrid-settings-locale';
import { cleanGroupFields, cleanSortFields, getDataFieldsForMultiHeaders, mergetColumnOptions, refreshGridColumns } from './mutli-headers.helper';
/** @type {?} */
export const GRID_SETTINGS_WEBAPI = new InjectionToken(' Farris DataGrid User Setting WebApi URI.');
export class DatagridSettingsService {
    /**
     * @param {?} injector
     * @param {?} modalSer
     * @param {?} messager
     * @param {?} idService
     * @param {?} localeSer
     */
    constructor(injector, modalSer, messager, idService, localeSer) {
        this.injector = injector;
        this.modalSer = modalSer;
        this.messager = messager;
        this.idService = idService;
        this.localeSer = localeSer;
        this.multiSortMsg = '列表中未开启多列排序的功能。 请检查！';
        this.columnsSortableMsg = '未开启列的排序功能。请检查！';
        this.notShowDialog = '多表头暂不支持列显示设置；同时未启用列排序功能。';
        this._httpRestService = null;
        this.languages = [];
        this.gridRefs = null;
        this.activeSchemeItem = null;
        this.saving = false;
        this.cfr = null;
        this.app = null;
        this.schemeListSubscription = null;
        this.currentSchemeitem = null;
        this.prevSchemeItem = null;
        this.debugSer = null;
        this.cfr = this.injector.get(ComponentFactoryResolver);
        this.app = this.injector.get(ApplicationRef);
        this.notifyService = this.injector.get(NotifyService, null);
        this.debugSer = this.injector.get(DebugService, null);
        this.commonUtils = this.injector.get(CommonUtils, new CommonUtils());
        this.schemeService = new DatagridSchemeService(this.injector);
        this.localeSer.setLocaleData(DATAGRID_SETTINGS_LOCALEDATA);
    }
    /**
     * @return {?}
     */
    get httpRestService() {
        return this._httpRestService;
    }
    ;
    /**
     * @param {?} httpSer
     * @return {?}
     */
    set httpRestService(httpSer) {
        this._httpRestService = httpSer;
        if (this.schemeService) {
            this.schemeService.setRestService(httpSer);
        }
    }
    /**
     * @param {?} perfixStr
     * @return {?}
     */
    setUriPerfixStr(perfixStr) {
        if (perfixStr == '') {
            if (window['gspframeworkService'] && window['gspframeworkService'].common) {
                /** @type {?} */
                const basePath = window['gspframeworkService'].common.getBasePath;
                if (basePath && basePath.get) {
                    perfixStr = basePath.get();
                }
            }
        }
        if (perfixStr != '' && perfixStr !== null) {
            this.schemeService.setUriPerfix(perfixStr);
        }
    }
    /**
     * @param {?=} id
     * @return {?}
     */
    destroy(id) {
        if (this.gridRefs) {
            if (id && this.gridRefs[id]) {
                this.gridRefs[id] = null;
                delete this.gridRefs[id];
            }
            else {
                if (!Object.keys(this.gridRefs).length) {
                    this.gridRefs = null;
                }
            }
        }
        this.saving = false;
        this.setActiveSchemeItem(id, null);
        this.schemeService.destory(id);
    }
    /**
     * @private
     * @param {?} msg
     * @param {?=} type
     * @return {?}
     */
    writeDebugMsg(msg, type = 'warn') {
        if (this.debugSer) {
            if (this.debugSer[type]) {
                this.debugSer[type](msg);
            }
            else {
                console[type](msg);
            }
        }
    }
    /**
     * @param {?} dg
     * @return {?}
     */
    registerGridInstance(dg) {
        if (!dg) {
            this.writeDebugMsg('DatagridSettingService: grid instance is null.');
            return;
        }
        /** @type {?} */
        const id = dg.id;
        this.gridRefs = this.gridRefs || {};
        if (!this.gridRefs[id]) {
            this.gridRefs[id] = dg;
        }
    }
    /**
     * @param {?} dgID
     * @return {?}
     */
    getGridInstance(dgID) {
        return this.gridRefs ? this.gridRefs[dgID] : null;
    }
    /**
     * 更新方案中的配置数据
     * @private
     * @param {?} schemeItem
     * @param {?} settings
     * @return {?}
     */
    updateSchemeSettings(schemeItem, settings) {
        if (schemeItem && settings) {
            /** @type {?} */
            const schemeContentObj = schemeItem.queryConditionString ? JSON.parse(schemeItem.queryConditionString) : {};
            if (schemeContentObj) {
                if (schemeContentObj[this.localeSer.localeId]) {
                    /** @type {?} */
                    const schemeSettings = schemeContentObj[this.localeSer.localeId] || {};
                    schemeContentObj[this.localeSer.localeId] = Object.assign(schemeSettings, settings);
                }
                else {
                    schemeContentObj[this.localeSer.localeId] = settings;
                }
                schemeItem.queryConditionString = JSON.stringify(schemeContentObj);
            }
        }
    }
    /**
     * 更新当前方案配置数据
     * @param {?} dgId
     * @param {?} settings
     * @return {?}
     */
    updateActiveSchemeItemSettings(dgId, settings) {
        /** @type {?} */
        const schemeItem = this.getActiveSchemeItem(dgId);
        this.updateSchemeSettings(schemeItem, settings);
        if (schemeItem) {
            this.schemeService.updateSchemeData(dgId, schemeItem);
        }
    }
    /**
     * 设置活动的方案
     * @param {?} dgId
     * @param {?} activeItem
     * @return {?}
     */
    setActiveSchemeItem(dgId, activeItem) {
        /** @type {?} */
        const schemekey = this.schemeService.getSchemeKey(dgId);
        this.activeSchemeItem = this.activeSchemeItem || {};
        if (activeItem) {
            this.activeSchemeItem[schemekey] = cloneDeep(activeItem);
        }
        else {
            delete this.activeSchemeItem[schemekey];
        }
    }
    /**
     * 获取当前活动的方案
     * @param {?} dgId
     * @return {?}
     */
    getActiveSchemeItem(dgId) {
        /** @type {?} */
        const schemekey = this.schemeService.getSchemeKey(dgId);
        return this.activeSchemeItem ? this.activeSchemeItem[schemekey] : null;
    }
    /**
     * @return {?}
     */
    getSearchTypes() {
        return [
            { value: 'all', title: this.localeSer.getValue('datagrid.settings.allColumns') },
            { value: 'visible', title: this.localeSer.getValue('datagrid.settings.visibleColumns') },
            { value: 'hidden', title: this.localeSer.getValue('datagrid.settings.hiddenColumns') }
        ];
    }
    /**
     * @param {?} gridInstance
     * @param {?=} settings
     * @param {?=} selectedSchemeItem
     * @return {?}
     */
    showSimple(gridInstance, settings, selectedSchemeItem) {
        /** @type {?} */
        let _columns = this.getCurrentConfigs().columns || gridInstance.columns;
        /** @type {?} */
        const columns = this.convertColumnsToSimple(_columns);
        columns[0] = [...columns[0].filter((/**
             * @param {?} n
             * @return {?}
             */
            n => n.field && n.field !== gridInstance.ControlPanelFeild))];
        /** @type {?} */
        const searchTypes = this.getSearchTypes();
        if (this.cfr) {
            /** @type {?} */
            const cmpFactory = this.cfr.resolveComponentFactory(SimpleColumnsComponent);
            /** @type {?} */
            let simpleRef = cmpFactory.create(this.injector);
            this.app.attachView(simpleRef.hostView);
            simpleRef.instance.columns = columns;
            simpleRef.instance.seartTypes = searchTypes;
            simpleRef.instance.gridInstance = gridInstance;
            simpleRef.instance.schemeSer = this.schemeService;
            if (document.querySelector('#page-wrapper')) {
                simpleRef.instance.top = 76;
            }
            simpleRef.instance.enableScheme = gridInstance.enableScheme;
            if (!settings) {
                settings = this.getCurrentConfigs();
            }
            if (gridInstance.enableScheme) {
                /** @type {?} */
                const _currentSchemtItem = this.getActiveSchemeItem(gridInstance.id);
                if (settings) {
                    //  从高级模式 转到 简洁模式时，保存原始值
                    if (!simpleRef.instance['prevSchemeItem'] && this.prevSchemeItem) {
                        simpleRef.instance['prevSchemeItem'] = cloneDeep(this.prevSchemeItem);
                    }
                    if (selectedSchemeItem) {
                        this.updateSchemeSettings(selectedSchemeItem, settings);
                        simpleRef.instance.currentSchemeItem = selectedSchemeItem;
                    }
                    else {
                        if (_currentSchemtItem) {
                            this.currentSchemeitem = _currentSchemtItem;
                            this.prevSchemeItem = cloneDeep(_currentSchemtItem);
                            simpleRef.instance.currentSchemeItem = _currentSchemtItem;
                        }
                        else {
                            if (!Object.keys(settings).length) {
                                settings = this.getLocalSettings(this.createConfigKey(gridInstance.id));
                            }
                            simpleRef.instance.currentSchemeItem = null;
                            simpleRef.instance.settings = settings;
                        }
                    }
                }
                else {
                    this.currentSchemeitem = _currentSchemtItem;
                    this.prevSchemeItem = cloneDeep(_currentSchemtItem);
                    simpleRef.instance.currentSchemeItem = _currentSchemtItem;
                }
            }
            else {
                if (gridInstance.enableSetMultiHeaders) {
                    simpleRef.instance.settings = this.getCurrentConfigs();
                }
                else {
                    simpleRef.instance.settings = settings;
                }
            }
            /** @type {?} */
            const zIndex = this.commonUtils.getFloatingLayerIndex();
            simpleRef.location.nativeElement.style.zIndex = '' + zIndex;
            document.body.appendChild(simpleRef.location.nativeElement);
            simpleRef.instance.canceld.subscribe((/**
             * @return {?}
             */
            () => {
                this.restoreScheme(gridInstance);
            }));
            simpleRef.instance.closed.pipe(switchMap((/**
             * @return {?}
             */
            () => {
                if (simpleRef) {
                    simpleRef.instance.container.nativeElement.style.right = '-500px';
                    return timer(500);
                }
            }))).subscribe((/**
             * @return {?}
             */
            () => {
                simpleRef.location.nativeElement.remove();
                simpleRef.destroy();
                simpleRef = null;
                if (this.schemeListSubscription) {
                    this.schemeListSubscription.unsubscribe();
                }
                /** @type {?} */
                const _activeSchemtItem = this.getActiveSchemeItem(gridInstance.id);
                if ((!this.currentSchemeitem || (_activeSchemtItem && _activeSchemtItem.id !== this.currentSchemeitem.id)) && (_activeSchemtItem && _activeSchemtItem.queryConditionString)) {
                    /** @type {?} */
                    const _currentSettings = JSON.parse(_activeSchemtItem.queryConditionString)[this.localeSer.localeId];
                    if (_currentSettings) {
                        columns[0].forEach((/**
                         * @param {?} f
                         * @return {?}
                         */
                        f => {
                            f.visible = _currentSettings.viewColumns.indexOf(f.field) > -1;
                        }));
                    }
                }
            }));
            // 打开高级设置窗口
            simpleRef.instance.advanced.subscribe((/**
             * @param {?} __0
             * @return {?}
             */
            ({ viewFields, settings, columns }) => {
                // if (viewFields && viewFields.length){
                //     this.updateSchemeSettings(simpleRef.instance.currentSchemeItem, {viewColumns: viewFields});
                // }
                this.setCurrentConfigs(Object.assign({}, settings, { columns }));
                this.prevSchemeItem = simpleRef.instance['prevSchemeItem'];
                this['SCHEME_DEFAULT_TITLE'] = simpleRef.instance.defaultSchemeName;
                this.showAdvanced(gridInstance, null, simpleRef.instance.currentSchemeItem);
            }));
            simpleRef.instance.submit.subscribe((/**
             * @param {?} e
             * @return {?}
             */
            (e) => {
                this.applySettings(e, gridInstance);
            }));
            // 多表列设置
            simpleRef.instance.submitForGroupHeader.subscribe((/**
             * @param {?} e
             * @return {?}
             */
            (e) => {
                this.applySettings(e, gridInstance);
            }));
            // simpleRef.instance.fieldsChange.subscribe((visibleFields: string[]) => {
            //     this.updateActiveSchemeItemSettings(gridInstance.id, {viewColumns: visibleFields})
            // });
            // 打开新增方案窗口
            simpleRef.instance.addNewScheme.subscribe((/**
             * @param {?} e
             * @return {?}
             */
            (e) => {
                this.showNewSchemeDialog(gridInstance, e, simpleRef.instance.collectSettings(), {
                    ok: (/**
                     * @param {?} t
                     * @return {?}
                     */
                    (t) => {
                        // 更换为新的方案
                        simpleRef.instance.onSchemeItemClick(null, t);
                        this.saveUserConfig;
                    })
                });
            }));
            simpleRef.instance.schemeList = this.schemeService.getStateValue(gridInstance.id, 'list') || [];
            // 打开方案管理列表窗口
            simpleRef.instance.showSchemeList.subscribe((/**
             * @return {?}
             */
            () => {
                this.getSchemeList(gridInstance.id).pipe(switchMap((/**
                 * @param {?} t
                 * @return {?}
                 */
                (t) => {
                    return this.schemeService.checkAuthority().pipe(map((/**
                     * @param {?} auth
                     * @return {?}
                     */
                    (auth) => {
                        return Object.assign({ list: t }, auth);
                    })));
                }))).subscribe((/**
                 * @param {?} t
                 * @return {?}
                 */
                (t) => {
                    this.schemeService.setSchemeList(gridInstance.id, t.list || []);
                    this.showSchemeListDialog(gridInstance, cloneDeep(t.list || []), t, simpleRef);
                }));
            }));
            this.schemeListSubscription = this.schemeService.schemeList$.subscribe((/**
             * @param {?} list
             * @return {?}
             */
            (list) => {
                simpleRef.instance.schemeList = list;
                if (!list || !list.length) {
                    this.setActiveSchemeItem(gridInstance.id, null);
                    return;
                }
                /** @type {?} */
                const _activeSchemeItem = this.getActiveSchemeItem(gridInstance.id);
                if (_activeSchemeItem) {
                    /** @type {?} */
                    let hasActiveItem = list.find((/**
                     * @param {?} n
                     * @return {?}
                     */
                    n => n.id === _activeSchemeItem.id));
                    if (!hasActiveItem) {
                        hasActiveItem = this.getDefaultScheme(list); // 获取设置为当前方案的项
                        this.setActiveSchemeItem(gridInstance.id, hasActiveItem || null);
                    }
                    simpleRef.instance.currentSchemeItem = hasActiveItem;
                }
            }));
            // 切换方案
            simpleRef.instance.schemeChanged.subscribe((/**
             * @param {?} t
             * @return {?}
             */
            (t) => {
                this.currentSchemeitem = t;
                this.setActiveSchemeItem(gridInstance.id, cloneDeep(t));
            }));
            simpleRef.hostView.detectChanges();
            simpleRef.instance.cd.detectChanges();
            simpleRef.instance.container.nativeElement.style.right = '0px';
            return simpleRef;
        }
    }
    /**
     * @param {?} gridInstance
     * @param {?=} opts
     * @return {?}
     */
    show(gridInstance, opts) {
        this.registerGridInstance(gridInstance);
        if (gridInstance.enableSimpleMode) {
            this.schemeService.createSchemeTaskID();
            return this.showSimple(gridInstance);
        }
        else {
            return this.showAdvanced(gridInstance, opts);
        }
    }
    /**
     * @private
     * @param {?} gridInstance
     * @return {?}
     */
    restoreScheme(gridInstance) {
        if (gridInstance.enableScheme) {
            this.setActiveSchemeItem(gridInstance.id, this.prevSchemeItem);
            if (!this.prevSchemeItem) {
                this.setCurrentConfigs(null);
            }
        }
        else {
            this.setCurrentConfigs(null);
        }
    }
    /**
     * @private
     * @param {?} gridInstance
     * @param {?=} opts
     * @param {?=} selectedSchemeItem
     * @return {?}
     */
    showAdvanced(gridInstance, opts, selectedSchemeItem) {
        /** @type {?} */
        let _editColSortInfo = true;
        /** @type {?} */
        const editColSortInfo = this.canSetColumnSort(gridInstance);
        if (editColSortInfo !== true) {
            _editColSortInfo = false;
        }
        // 判断是否为多表头
        /** @type {?} */
        const showSetColumnsTab = !gridInstance.isMultiHeader() || (gridInstance.isMultiHeader() && gridInstance.enableSetMultiHeaders);
        /** @type {?} */
        const getActiveTabIndex = (/**
         * @return {?}
         */
        () => {
            if (showSetColumnsTab) {
                return 1;
            }
            else {
                if (_editColSortInfo) {
                    return 2;
                }
                else {
                    return -1;
                }
            }
        });
        /** @type {?} */
        const activeTabIndex = getActiveTabIndex();
        if (activeTabIndex === -1) {
            this.messager.warning(this.notShowDialog);
            return;
        }
        /** @type {?} */
        const columns = this.convertColumnsToSimple(this.getCurrentConfigs().columns || gridInstance.columns);
        // 获取当前方案中当前语言的配置数据
        /** @type {?} */
        let currentSettings = this.getCurrentConfigs();
        /** @type {?} */
        const multiHeaderTree = currentSettings && currentSettings.multiHeaders ? currentSettings.multiHeaders.treeData : null;
        if (selectedSchemeItem && selectedSchemeItem.queryConditionString) {
            /** @type {?} */
            const _currentSettings = JSON.parse(selectedSchemeItem.queryConditionString)[this.localeSer.localeId];
            currentSettings = Object.assign(_currentSettings || {}, currentSettings || {});
            if (currentSettings.columnFormat && currentSettings.columnFormat.length) {
                columns[0] = columns[0].map((/**
                 * @param {?} col
                 * @return {?}
                 */
                (col) => {
                    /** @type {?} */
                    const fcol = currentSettings.columnFormat.find((/**
                     * @param {?} n
                     * @return {?}
                     */
                    n => n.field === col.field));
                    if (fcol) {
                        col = Object.assign(col, fcol);
                    }
                    return col;
                }));
            }
        }
        if (!gridInstance.enableSetMultiHeaders && currentSettings.viewColumns && currentSettings.viewColumns.length) {
            columns[0].forEach((/**
             * @param {?} f
             * @return {?}
             */
            f => {
                f.visible = currentSettings.viewColumns.indexOf(f.field) > -1;
            }));
        }
        columns[0] = columns[0].filter((/**
         * @param {?} n
         * @return {?}
         */
        n => n.field && n.field !== gridInstance.ControlPanelFeild));
        /** @type {?} */
        let sortFields = getDataFieldsForMultiHeaders(cloneDeep(columns)).filter((/**
         * @param {?} n
         * @return {?}
         */
        (n) => n.field.indexOf('farris-datagrid-column_') == -1 && n.sortable));
        if (gridInstance.enableSetMultiHeaders && currentSettings && currentSettings.multiHeaders) {
            sortFields = getDataFieldsForMultiHeaders(currentSettings.multiHeaders.viewCols).filter((/**
             * @param {?} n
             * @return {?}
             */
            (n) => n.field.indexOf('farris-datagrid-column_') == -1 && n.sortable));
        }
        // const treeData = this.convertColumns2TreeData(cloneDeep(columns), true);
        // const viewColumnsTreeData = this.convertColumns2TreeData(cloneDeep(columns), false);
        // this.checkViewTreeNodes(viewColumnsTreeData);
        /** @type {?} */
        let modalRef = null;
        // const okText = this.localeSer.getValue('datagrid.settings.ok') || '确定';
        // const cancelText = this.localeSer.getValue('datagrid.settings.cancel') || '取消';
        // const resetText =  this.localeSer.getValue('datagrid.settings.reset') || '重置';
        /** @type {?} */
        const defaultOpts = {
            width: 760, height: 560, showHeader: false, title: '控制面板',
            initialState: {
                columns,
                sortTreeData: sortFields,
                // viewTreeData: viewColumnsTreeData,
                gridInstance,
                canSetColumnSort: _editColSortInfo,
                canSetColumnVisible: showSetColumnsTab,
                activeTabIndex,
                schemeInfo: currentSettings,
                enableMultipleHeaders: gridInstance.enableSetMultiHeaders,
                multiHeaders: {
                    columns,
                    treeData: multiHeaderTree
                },
                schemeName: selectedSchemeItem ? selectedSchemeItem['_title_'] : this['SCHEME_DEFAULT_TITLE']
            },
            showButtons: false,
            closed: (/**
             * @param {?} isCloseBtn
             * @param {?} opts
             * @return {?}
             */
            (isCloseBtn, opts) => {
                const { event } = opts;
                if (event && event.code === 'Escape') {
                    this.restoreScheme(gridInstance);
                }
            })
        };
        /** @type {?} */
        const modalOpts = Object.assign(defaultOpts, opts || {});
        modalRef = this.modalSer.show(DatagridSettingsComponent, modalOpts);
        /** @type {?} */
        const instance = (/** @type {?} */ (modalRef.content));
        instance.enableReset = true;
        instance.modalRef = modalRef;
        instance.canSetColumnSort = _editColSortInfo;
        instance.canSetColumnVisible = showSetColumnsTab;
        instance.submitHandle.subscribe((/**
         * @param {?} e
         * @return {?}
         */
        (e) => {
            this.applySettings(e, gridInstance, { modalRef, currentScheme: selectedSchemeItem });
        }));
        instance.cancelHandle.subscribe((/**
         * @param {?} e
         * @return {?}
         */
        (e) => {
            modalRef.close();
            this.restoreScheme(gridInstance);
        }));
        // 切换到侧边栏简洁模式
        instance.concise.subscribe((/**
         * @param {?} e
         * @return {?}
         */
        (e) => {
            modalRef.close();
            /** @type {?} */
            const settings = modalRef.content;
            const { sortInfo, viewColumns, columnFormat, groupField, multiHeaders } = settings;
            this.setCurrentConfigs({ sortInfo, viewColumns, columnFormat, groupField, multiHeaders });
            this.showSimple(gridInstance, { sortInfo, viewColumns, columnFormat, groupField, multiHeaders }, cloneDeep(selectedSchemeItem));
        }));
        /** @type {?} */
        const modalContainer = (/** @type {?} */ (modalRef.dialog.instance));
        modalContainer.draggbar.handle = instance.header.nativeElement;
        return modalRef;
    }
    /**
     * @private
     * @param {?} gridInstance
     * @return {?}
     */
    canSetColumnSort(gridInstance) {
        if (gridInstance.multiSort && this.hasEnableSortColumns(gridInstance)) {
            return true;
        }
        else {
            if (!this.hasEnableSortColumns(gridInstance)) {
                return this.columnsSortableMsg;
            }
            else if (!gridInstance.multiSort) {
                return this.multiSortMsg;
            }
        }
    }
    /**
     * @private
     * @param {?} gridInstance
     * @return {?}
     */
    hasEnableSortColumns(gridInstance) {
        /** @type {?} */
        const sortColumnsCount = gridInstance.flatColumns.reduce((/**
         * @param {?} c
         * @param {?} r
         * @return {?}
         */
        (c, r) => {
            if (r.sortable) {
                return c + 1;
            }
            return c;
        }), 0);
        return sortColumnsCount > 0;
    }
    // private getChilds(cols, rowIndex, colStartIndex, colCount, forSort = false) {
    //     const childCols = [];
    //     let _count = colStartIndex;
    //     if (!cols[rowIndex]) {
    //         return  [];
    //     }
    //     cols[rowIndex].slice().forEach(element => {
    //         _count = _count + element.colspan;
    //         if ( _count <= colCount ) {
    //             childCols.push(element);
    //         }
    //     });
    //     cols[rowIndex].splice(0, childCols.length);
    //     return childCols.map((c, i) => {
    //         let n: any = {
    //             data: c,
    //             selectable: forSort ? !!c.sortable : true
    //         };
    //         if (c.colspan && c.colspan > 1) {
    //             n = {
    //                 data: c,
    //                 selectable: false,
    //                 expanded: true,
    //                 children: this.getChilds(cols, rowIndex + 1, 0 , c.colspan)
    //             };
    //         }
    //         return n;
    //     });
    // }
    // convertColumns2TreeData(cols: DataColumn[][], forSort = false) {
    //     const columns = cols.map((c: any) => {
    //         const aa = c.map((_) => {
    //             if (_.field.indexOf('farris-datagrid-column_') == -1) {
    //                 _.colspan = _.colspan || 1;
    //                 return _;
    //             }
    //             return null;
    //         });
    //         return aa.filter(n => n);
    //     });
    //     if (columns.length === 1) {
    //         return columns[0].map(c => {
    //             return {
    //                 data: c,
    //                 selectable: forSort ? !!c.sortable : true
    //             };
    //         });
    //     } else {
    //         return columns[0].map((c, i) => {
    //             if (c.colspan && c.colspan > 1) {
    //                 return {
    //                     data: c,
    //                     selectable: false,
    //                     expanded: true,
    //                     children: this.getChilds(columns, 1, 0, c.colspan, forSort)
    //                 };
    //             } else {
    //                 return {
    //                     data: c,
    //                     selectable: forSort ? !!c.sortable : true
    //                 };
    //             }
    //         });
    //     }
    // }
    // private checkViewTreeNodes(treeNodes: TreeNode[]) {
    //     treeNodes.forEach((tn: TreeNode) => {
    //         if (!tn.children || !tn.children.length) {
    //             tn.selectable = true;
    //         } else {
    //             tn.selectable = false;
    //             this.checkViewTreeNodes(tn.children);
    //         }
    //     });
    // }
    /**
     * @private
     * @param {?} gridInstance
     * @return {?}
     */
    _convertColumnsToSimple(gridInstance) {
        /** @type {?} */
        let cols = gridInstance.columns;
        // 重置列顺序为最初设计时的顺序
        /** @type {?} */
        const gridOpts = gridInstance.dfs._state.initialOptions;
        if (gridOpts.columnFields) {
            /** @type {?} */
            let desginCols = gridOpts.columnFields;
            /** @type {?} */
            const newColumns = [];
            desginCols.forEach((/**
             * @param {?} c
             * @return {?}
             */
            c => {
                if (c.field !== '_datagrid-setting-control_') {
                    /** @type {?} */
                    const col = gridInstance.columns[0].find((/**
                     * @param {?} n
                     * @return {?}
                     */
                    (n) => n.field === c.field));
                    if (col) {
                        newColumns.push(col);
                    }
                }
            }));
            cols = [newColumns];
        }
        return cols;
    }
    /**
     * @param {?} cols
     * @return {?}
     */
    convertColumnsToSimple(cols) {
        if (!Array.isArray(cols[0])) {
            cols = [cols];
        }
        return cols.map((/**
         * @param {?} _cols
         * @return {?}
         */
        (_cols) => {
            return _cols.map((/**
             * @param {?} c
             * @return {?}
             */
            (c) => {
                if (c.field !== '_datagrid-setting-control_') {
                    return {
                        field: c.field,
                        title: c.title,
                        colspan: c.colspan,
                        rowspan: c.rowspan,
                        sortable: c.sortable,
                        order: c.order,
                        halign: c.halign || 'left',
                        align: c.align || 'left',
                        visible: c.visible,
                        allowGrouping: c.allowGrouping,
                        groupFooter: c.groupFooter,
                        footer: c.footer,
                        width: c.width || 100,
                        dataType: c.dataType || 'string',
                        fixed: c.fixed || 'UNFIXED'
                    };
                }
            })).filter((/**
             * @param {?} n
             * @return {?}
             */
            n => n));
        }));
    }
    /**
     * @private
     * @param {?} gridInstance
     * @return {?}
     */
    resetGridView(gridInstance) {
        if (!gridInstance) {
            return;
        }
        /** @type {?} */
        const dfs = gridInstance.dfs;
        if (dfs) {
            /** @type {?} */
            const options = dfs['_state'].initialOptions;
            if (options.sort) {
                if (options.sort.sortName) {
                    gridInstance.sortName = options.sort.sortName;
                }
                if (options.sort.sortOrder) {
                    gridInstance.sortOrder = options.sort.sortOrder;
                }
            }
            gridInstance.groupField = options.groupField || '';
            // TODO: 还需要修正默认列的显示顺序
            if (options.columnFields && options.columnFields.length) {
                /** @type {?} */
                const newColumns = [];
                options.columnFields.forEach((/**
                 * @param {?} c
                 * @return {?}
                 */
                c => {
                    /** @type {?} */
                    const col = gridInstance.columns[0].find((/**
                     * @param {?} n
                     * @return {?}
                     */
                    (n) => n.field === c.field));
                    if (col) {
                        col.visible = c.visible;
                        col.halign = c.halign;
                        col.align = c.align;
                        col.width = c.width;
                        col.footer = c.footer;
                        col.groupFooter = c.groupFooter;
                        newColumns.push(col);
                    }
                }));
                gridInstance.columns[0] = newColumns;
            }
            // gridInstance['checkOptions']();
            gridInstance['columnsChanged']();
        }
    }
    /**
     * @private
     * @param {?} modalRef
     * @param {?} gridInstance
     * @param {?=} btn
     * @param {?=} _scheme
     * @return {?}
     */
    updateGridView(modalRef, gridInstance, btn = null, _scheme = null) {
        /** @type {?} */
        const settings = modalRef.content;
        if (settings) {
            const { sortInfo, viewColumns, columnFormat, groupField, expandGroupRows, multiHeaders } = settings;
            /** @type {?} */
            const _colformats = columnFormat ? this.convertColumnsToSimple(columnFormat)[0] : [];
            this.saving = true;
            /** @type {?} */
            let _groupField = '';
            if (gridInstance.groupRows && groupField && groupField.length) {
                if (typeof groupField === 'string') {
                    _groupField = groupField;
                }
                else if (Array.isArray(groupField)) {
                    _groupField = groupField.join(',');
                }
            }
            /** @type {?} */
            let _sortInfo = sortInfo;
            // 当多表头需要清理排序字段与分组字段，保证这些字段必须在表头中
            if (gridInstance.enableSetMultiHeaders && multiHeaders) {
                if (_groupField) {
                    _groupField = cleanGroupFields(multiHeaders.viewCols, _groupField.split(','));
                }
                if (sortInfo && sortInfo.sortName && sortInfo.sortName.length) {
                    _sortInfo = cleanSortFields(multiHeaders.viewCols, sortInfo);
                }
            }
            /** @type {?} */
            const saveData = { sortInfo: _sortInfo, viewColumns, groupField: _groupField, columnFormat: _colformats, expandGroupRows: expandGroupRows, multiHeaders };
            /** @type {?} */
            const refreshGrid = (/**
             * @return {?}
             */
            () => {
                if (gridInstance.groupRows) {
                    gridInstance.expandGroupRows = expandGroupRows;
                    gridInstance.groupField = _groupField;
                }
                if (gridInstance.enableSetMultiHeaders) {
                    // 设置表头
                    refreshGridColumns(gridInstance, multiHeaders.viewCols || []);
                }
                else {
                    if (viewColumns && viewColumns.length) {
                        gridInstance.columns = gridInstance.columns.map((/**
                         * @param {?} cols
                         * @return {?}
                         */
                        cols => {
                            this.updateColumnFormat(cols, columnFormat, gridInstance);
                            return this.newVisibleOrderColumns(cols, viewColumns, columnFormat, gridInstance);
                        }));
                    }
                }
                gridInstance.columnsChanged(true);
                if (sortInfo && Object.keys(sortInfo).length) {
                    const { sortName, sortOrder } = sortInfo;
                    if (sortName && sortName.length) {
                        gridInstance.sort(sortName.join(','), sortOrder.join(','));
                    }
                    else {
                        gridInstance.clearSort();
                    }
                }
                else {
                    gridInstance.clearSort();
                }
            });
            /** @type {?} */
            const saveCurrent = (/**
             * @return {?}
             */
            () => {
                this.setUserConfig(gridInstance.id, saveData).subscribe((/**
                 * @return {?}
                 */
                () => {
                    if (btn) {
                        btn.disabled = false;
                    }
                    this.saving = false;
                    refreshGrid();
                    this.setActiveSchemeItem(gridInstance.id, _scheme);
                    this.prevSchemeItem = _scheme;
                    this.updateActiveSchemeItemSettings(gridInstance.id, saveData);
                    this.setCurrentConfigs(saveData);
                    modalRef.close();
                }));
            });
            if (gridInstance.showConfirmWhenSchemeChanged && gridInstance.enableScheme) {
                /** @type {?} */
                const languageRes = this.localeSer.getValue('datagrid-scheme.schemeChanged');
                /** @type {?} */
                const _changed = this.schemeService.isSchemeChanged(saveData, gridInstance.enableSetMultiHeaders);
                if (_changed) {
                    /** @type {?} */
                    const msgDlg = this.messager.question2(languageRes.title, [
                        {
                            text: languageRes.cancel,
                            cls: 'btn btn-light',
                            handle: (/**
                             * @return {?}
                             */
                            () => {
                                this.saving = false;
                                modalRef.close();
                                msgDlg.close();
                                this.restoreScheme(gridInstance);
                            })
                        },
                        {
                            text: languageRes.no,
                            cls: 'btn btn-secondary',
                            handle: (/**
                             * @return {?}
                             */
                            () => {
                                // 保存到当前方案
                                msgDlg.close();
                                saveCurrent();
                            })
                        },
                        {
                            text: languageRes.yes,
                            cls: 'btn btn-primary',
                            handle: (/**
                             * @return {?}
                             */
                            () => {
                                // 另存新方案
                                this.showNewSchemeDialog(gridInstance, { type: 'saveas' }, saveData, {
                                    ok: (/**
                                     * @param {?} t
                                     * @return {?}
                                     */
                                    (t) => {
                                        this.saving = false;
                                        modalRef.close();
                                        this.currentSchemeitem = t;
                                        this.setActiveSchemeItem(gridInstance.id, cloneDeep(t));
                                        refreshGrid();
                                    }),
                                    cancel: (/**
                                     * @return {?}
                                     */
                                    () => {
                                        this.saving = false;
                                        if (btn) {
                                            btn.disabled = false;
                                        }
                                    })
                                });
                                msgDlg.close();
                            })
                        },
                    ]);
                }
                else {
                    if (this.currentSchemeitem && this.prevSchemeItem && this.currentSchemeitem.id === this.prevSchemeItem.id) {
                        this.saving = false;
                        modalRef.close();
                        refreshGrid();
                    }
                    else {
                        saveCurrent();
                    }
                }
            }
            else {
                saveCurrent();
            }
        }
        else {
            modalRef.close();
        }
    }
    /**
     * @param {?} cols
     * @param {?} viewColumns
     * @param {?} columnFormat
     * @param {?} gridInstance
     * @return {?}
     */
    newVisibleOrderColumns(cols, viewColumns, columnFormat, gridInstance) {
        /** @type {?} */
        const hideColumns = [];
        cols.forEach((/**
         * @param {?} element
         * @param {?} index
         * @return {?}
         */
        (element, index) => {
            if (this.isNewAddColumn(element.field, columnFormat) && element.field !== '_datagrid-setting-control_' && !gridInstance.enableScheme) {
                viewColumns.push(element.field);
            }
            else {
                element.visible = viewColumns.includes(element.field);
                if (!element.visible) {
                    hideColumns.push(element);
                }
            }
        }));
        // 清理不存在的列
        /** @type {?} */
        let newCols = viewColumns.map((/**
         * @param {?} field
         * @return {?}
         */
        field => {
            return cols.find((/**
             * @param {?} c
             * @return {?}
             */
            c => c.field === field));
        })).filter((/**
         * @param {?} n
         * @return {?}
         */
        n => n));
        if (hideColumns.length) {
            newCols = newCols.concat(hideColumns);
        }
        return newCols.filter((/**
         * @param {?} c
         * @return {?}
         */
        c => c && c.field && c.field !== '_datagrid-setting-control_'));
    }
    /**
     * 是否为新增加的字段
     * 新增的字段，需要在列表中展示出来，并保存到个性化设置中
     * @private
     * @param {?} field
     * @param {?} columns
     * @return {?}
     */
    isNewAddColumn(field, columns) {
        columns = columns || [];
        return !columns.find((/**
         * @param {?} c
         * @return {?}
         */
        c => c.field === field));
    }
    /**
     * @param {?} cols
     * @param {?} columnFormat
     * @param {?} gridInstance
     * @return {?}
     */
    updateColumnFormat(cols, columnFormat, gridInstance) {
        if (columnFormat && columnFormat.length) {
            cols.forEach((/**
             * @param {?} col
             * @return {?}
             */
            col => {
                /** @type {?} */
                const formatCol = columnFormat.find((/**
                 * @param {?} f
                 * @return {?}
                 */
                f => f.field === col.field));
                if (formatCol) {
                    col.width = formatCol.width;
                    col.halign = formatCol.halign || 'left';
                    col.align = formatCol.align || 'left';
                    col.fixed = formatCol.fixed === 'UNFIXED' ? '' : formatCol.fixed;
                    col.title = formatCol.title;
                    if (gridInstance.groupRows && (col.allowGrouping || col.allowGrouping === undefined)) {
                        if (!col.groupFooter) {
                            col.groupFooter = formatCol.groupFooter;
                        }
                        if (col.groupFooter && col.groupFooter.options) {
                            if (!formatCol.groupFooter.options) {
                                formatCol.groupFooter.options = {};
                            }
                            col.groupFooter.options.text = formatCol.groupFooter.options.text || '';
                            col.groupFooter.options.calculationType =
                                formatCol.groupFooter.options.calculationType !== undefined &&
                                    formatCol.groupFooter.options.calculationType !== null ?
                                    parseInt(formatCol.groupFooter.options.calculationType, 10) : -1;
                        }
                    }
                    if (gridInstance.showFooter && !gridInstance.footerTemplate) {
                        if (!col.footer) {
                            col.footer = formatCol.footer;
                        }
                        if (col.footer && col.footer.options) {
                            if (!formatCol.footer.options) {
                                formatCol.footer.options = {};
                            }
                            col.footer.options.text = formatCol.footer.options.text || '';
                            col.footer.options.calculationType =
                                formatCol.footer.options.calculationType !== undefined &&
                                    formatCol.footer.options.calculationType !== null ?
                                    parseInt(formatCol.footer.options.calculationType, 10) : -1;
                        }
                    }
                }
            }));
        }
    }
    // 创建唯一key, 由uri + gridId 组成，并混淆
    /**
     * @private
     * @param {?} gridId
     * @return {?}
     */
    createConfigKey(gridId) {
        /** @type {?} */
        const grid = this.getGridInstance(gridId);
        if (grid) {
            return grid.dgs.createConfigKey(gridId);
        }
        else {
            this.writeDebugMsg('DatagridSettingService: Can not find the grid instance.');
        }
    }
    /**
     * @private
     * @param {?} gridId
     * @return {?}
     */
    getCurrentUserSettings(gridId) {
        /** @type {?} */
        const gridInstance = this.getGridInstance(gridId);
        /** @type {?} */
        const config = { sortInfo: {}, viewColumns: [], groupField: '', columnFormat: [] };
        if (gridInstance) {
            const { sortName, sortOrder, columns } = gridInstance;
            if (sortName) {
                /** @type {?} */
                const sortInfo = {
                    sortName: sortName.split(','),
                    sortOrder: sortOrder.split(',')
                };
                config.sortInfo = sortInfo;
            }
            /** @type {?} */
            const viewColumns = columns[0].filter((/**
             * @param {?} n
             * @return {?}
             */
            n => n.visible || n.visible === undefined)).map((/**
             * @param {?} n
             * @return {?}
             */
            n => n.field));
            config.viewColumns = viewColumns;
            config.columnFormat = this.convertColumnsToSimple(this._convertColumnsToSimple(gridInstance))[0];
            if (gridInstance.groupRows) {
                config.groupField = gridInstance.groupField;
            }
        }
        return config;
    }
    /**
     * @param {?} gridId
     * @return {?}
     */
    saveUserConfig(gridId) {
        /** @type {?} */
        const config = this.getCurrentUserSettings(gridId);
        return this.setUserConfig(gridId, config);
    }
    /**
     * @param {?} gridId
     * @param {?} config
     * @return {?}
     */
    setUserConfig(gridId, config) {
        /** @type {?} */
        const gridIns = this.getGridInstance(gridId);
        /** @type {?} */
        const key = this.createConfigKey(gridId);
        /** @type {?} */
        const LOCALEID = this.localeSer.localeId;
        /** @type {?} */
        const currentConfig = localStorage.getItem(key);
        /** @type {?} */
        const _config = (currentConfig ? JSON.parse(currentConfig) : {}) || {};
        if (config) {
            if (_config) {
                _config[LOCALEID] = config;
            }
            if (gridIns && gridIns.enableSetMultiHeaders) {
                _config['isMultiHeader'] = true;
            }
            localStorage.setItem(key, JSON.stringify(_config));
        }
        else {
            localStorage.removeItem(key);
        }
        if (this.httpRestService) {
            if (gridIns && gridIns.enableScheme) {
                /** @type {?} */
                const activeScheme = this.getActiveSchemeItem(gridId);
                if (activeScheme) {
                    this.updateSchemeSettings(activeScheme, config);
                    if (activeScheme.type === 'private') {
                        return this.schemeService.saveScheme(activeScheme, gridId, true, gridIns.enableSetMultiHeaders);
                    }
                    else {
                        return this.schemeService.checkAuthority().pipe(switchMap((/**
                         * @param {?} t
                         * @return {?}
                         */
                        (t) => {
                            if (t.success) {
                                /** @type {?} */
                                const hasOrgAuthority = t.authOrganizationData && t.authOrganizationData.length;
                                if (activeScheme.type === 'public' || (activeScheme.type === 'org' && hasOrgAuthority)) {
                                    return this.schemeService.saveScheme(activeScheme, gridId, true, gridIns.enableSetMultiHeaders);
                                }
                            }
                            return of(true);
                        })));
                    }
                }
                else {
                    // 如为系统预制时，按无方案处理
                    return this._saveUserConfig(key, config ? _config : '');
                    // return of(true);
                }
            }
            // 保存至数据库
            return this._saveUserConfig(key, config ? _config : '');
        }
        return of(true);
    }
    /**
     * @param {?} key
     * @param {?=} isMultiHeader
     * @return {?}
     */
    getUserConfig(key, isMultiHeader = false) {
        if (this.httpRestService) {
            return this._getUserConfig(key, isMultiHeader);
        }
        else {
            return of(this.getLocalSettings(key, isMultiHeader));
        }
    }
    /**
     * @param {?} key
     * @param {?=} isMultiHeader
     * @return {?}
     */
    getLocalSettings(key, isMultiHeader = false) {
        /** @type {?} */
        const config = localStorage.getItem(key);
        if (config) {
            /** @type {?} */
            const con = JSON.parse(config);
            if (isMultiHeader && !con['isMultiHeader']) {
                return null;
            }
            else {
                if (con['isMultiHeader']) {
                    return null;
                }
            }
            if (con[this.localeSer.localeId]) {
                return con[this.localeSer.localeId];
            }
            else {
                if (Object.keys(con).indexOf('viewColumns') > -1) {
                    return con;
                }
                return null;
            }
        }
        else {
            return null;
        }
    }
    /**
     * @private
     * @param {?} schemeList
     * @return {?}
     */
    getDefaultScheme(schemeList) {
        // 0、过滤出当前语言的方案列表
        // 1、有个人默认的返回个人默认方案
        // 2、没有个人默认方案的，返回公共方案第1个
        // 3、没有公共方案，返回组织方案第1个
        // 4、没有组织方案的, 返回个人方案第1个
        // 5、没有个人方案的，返回系统预制，即表单设计时的格式
        schemeList = schemeList.filter((/**
         * @param {?} n
         * @return {?}
         */
        n => {
            return JSON.parse(n.name)[this.localeSer.localeId];
        }));
        /** @type {?} */
        let defaultScheme = null;
        if (!schemeList || !schemeList.length) {
            return defaultScheme;
        }
        else {
            defaultScheme = schemeList.find((/**
             * @param {?} n
             * @return {?}
             */
            n => n.isDefault));
            if (!defaultScheme) {
                /** @type {?} */
                let publicSchemes = schemeList.filter((/**
                 * @param {?} n
                 * @return {?}
                 */
                n => n.type === 'public'));
                if (!publicSchemes.length) {
                    publicSchemes = schemeList.filter((/**
                     * @param {?} n
                     * @return {?}
                     */
                    n => n.type === 'org'));
                }
                if (publicSchemes.length) {
                    defaultScheme = publicSchemes[0];
                }
                else {
                    defaultScheme = schemeList[0];
                }
            }
        }
        return defaultScheme;
    }
    /**
     * @param {?} gridId
     * @return {?}
     */
    getSettings(gridId) {
        /** @type {?} */
        const key = this.createConfigKey(gridId);
        /** @type {?} */
        const gridIns = this.getGridInstance(gridId);
        /** @type {?} */
        let schemeList$ = of([]);
        if (gridIns && gridIns.enableScheme) {
            schemeList$ = this.getSchemeList(gridId);
        }
        return forkJoin(schemeList$, this.getUserConfig(key), this.schemeService.getLanguages()).pipe(map((/**
         * @param {?} __0
         * @return {?}
         */
        ([schemeList, userSetting, supportedLanguages]) => {
            schemeList = schemeList || [];
            this.languages = supportedLanguages;
            if (!schemeList.length) {
                return userSetting;
            }
            else {
                // 缓存方案列表
                this.setSchemeList(schemeList, gridId);
                // 查找默认方案
                /** @type {?} */
                const defaultScheme = this.getDefaultScheme(schemeList);
                if (!defaultScheme) {
                    return userSetting;
                }
                else {
                    this.setActiveSchemeItem(gridId, defaultScheme);
                    /** @type {?} */
                    let userSettings = null;
                    if (defaultScheme.queryConditionString) {
                        userSettings = JSON.parse(defaultScheme.queryConditionString);
                    }
                    if (userSettings) {
                        /** @type {?} */
                        const localeId = this.localeSer.localeId;
                        if (userSettings[localeId]) {
                            localStorage.setItem(key, JSON.stringify(userSettings));
                            return userSettings[localeId];
                        }
                        else {
                            userSettings[localeId] = null;
                            localStorage.setItem(key, JSON.stringify(userSettings));
                            return null;
                        }
                    }
                    else {
                        return null;
                    }
                }
            }
        })));
    }
    /**
     * @private
     * @param {?} key
     * @param {?} config
     * @return {?}
     */
    _saveUserConfig(key, config) {
        try {
            /** @type {?} */
            const userConfigSetting = {
                configkey1: key,
                configkey2: '',
                configkey3: '',
                textvalue: config ? JSON.stringify(config) : ''
            };
            return this.httpRestService.saveUserSettings(userConfigSetting);
        }
        catch (e) {
            this.writeDebugMsg(e, 'error');
        }
    }
    /**
     * @param {?} gridInstance
     * @param {?} modalRef
     * @return {?}
     */
    resetUserConfig(gridInstance, modalRef) {
        /** @type {?} */
        const restorDefaultText = this.localeSer.getValue('datagrid.settings.restoreDefaultSettingsText') || '确认要恢复默认设置吗？';
        this.messager.confirm(restorDefaultText).pipe(switchMap((/**
         * @param {?} t
         * @return {?}
         */
        (t) => {
            if (t) {
                return this.setUserConfig(gridInstance.id, '');
            }
            return of(t);
        }))).subscribe((/**
         * @param {?} t
         * @return {?}
         */
        (t) => {
            if (t) {
                this.resetGridView(gridInstance);
                modalRef.close();
            }
        }));
    }
    /**
     * @private
     * @param {?} key
     * @param {?=} isMultiHeader
     * @return {?}
     */
    _getUserConfig(key, isMultiHeader = false) {
        try {
            return this.httpRestService.getUserSettings(key).pipe(map((/**
             * @param {?} ucs
             * @return {?}
             */
            (ucs) => {
                if (ucs && ucs.textValue) {
                    /** @type {?} */
                    let c = JSON.parse(ucs.textValue);
                    if (c) {
                        if (isMultiHeader && !c['isMultiHeader']) {
                            return null;
                        }
                        else {
                            if (c['isMultiHeader']) {
                                return null;
                            }
                        }
                        if (c[this.localeSer.localeId]) {
                            localStorage.setItem(key, ucs.textValue);
                            return c[this.localeSer.localeId];
                        }
                        else {
                            c[this.localeSer.localeId] = null;
                            localStorage.setItem(key, JSON.stringify(c));
                            return null;
                        }
                    }
                    return null;
                }
                return null;
            })));
        }
        catch (e) {
            if (this.debugSer) {
                this.debugSer.error(e);
            }
        }
    }
    /**
     * @private
     * @param {?} gridId
     * @param {?=} settings
     * @return {?}
     */
    buildSubmitData(gridId, settings = null) {
        /** @type {?} */
        const LOCALEID = this.localeSer.localeId;
        if (!settings) {
            settings = this.getCurrentUserSettings(gridId);
        }
        /** @type {?} */
        const localeKey = this.createConfigKey(gridId);
        /** @type {?} */
        const currentConfig = localStorage.getItem(localeKey);
        /** @type {?} */
        const _config = (currentConfig ? JSON.parse(currentConfig) : {}) || {};
        if (_config) {
            _config[LOCALEID] = settings;
        }
        return _config;
    }
    // ----------------------------------------------------------------------------------------------- \\
    /**
     * @private
     * @param {?} gridInstance
     * @param {?} schemeList
     * @param {?} authInfo
     * @param {?} simpleRef
     * @return {?}
     */
    showSchemeListDialog(gridInstance, schemeList, authInfo, simpleRef) {
        /** @type {?} */
        const modalOpts = {
            width: 760, height: 577, showHeader: false, title: '控制面板',
            initialState: {
                items: (schemeList || []).filter((/**
                 * @param {?} n
                 * @return {?}
                 */
                n => {
                    return JSON.parse(n.name)[this.localeSer.localeId];
                })),
                removeItem: authInfo.success,
                currentUserId: authInfo.currentUserId,
                currentSchemeId: this.currentSchemeitem ? this.currentSchemeitem.id : ''
            },
            showButtons: false
        };
        /** @type {?} */
        const schemeListDlg = this.modalSer.show(SchemeListComponent, modalOpts);
        // schemeListDlg.dialog.location.nativeElement.style.zIndex = 2031;
        /** @type {?} */
        const instance = (/** @type {?} */ (schemeListDlg.content));
        instance.closeModal.subscribe((/**
         * @return {?}
         */
        () => {
            schemeListDlg.close();
        }));
        instance.submitModal.subscribe((/**
         * @param {?} t
         * @return {?}
         */
        (t) => {
            this.schemeService.updateScheme(t, gridInstance.id, gridInstance.enableSetMultiHeaders).subscribe((/**
             * @param {?} e
             * @return {?}
             */
            (e) => {
                if (e === false) {
                    schemeListDlg.close();
                    return;
                }
                /** @type {?} */
                const msg = '列设置方案保存成功。';
                if (this.notifyService) {
                    this.notifyService.success(msg);
                }
                else {
                    this.messager.success(msg);
                }
                if (t.defaultId) {
                    schemeList.forEach((/**
                     * @param {?} n
                     * @return {?}
                     */
                    n => {
                        n.isDefault = false;
                        if (n.id === t.defaultId) {
                            n.isDefault = true;
                            // this.setActiveSchemeItem(gridInstance.id, n);
                        }
                    }));
                }
                /** @type {?} */
                let newSchemeList = schemeList;
                if (t.deletedIds && t.deletedIds.length) {
                    newSchemeList = schemeList.filter((/**
                     * @param {?} n
                     * @return {?}
                     */
                    n => {
                        return !t.deletedIds.includes(n.id);
                    }));
                }
                this.schemeService.setSchemeList(gridInstance.id, newSchemeList);
                schemeListDlg.close();
                /** @type {?} */
                const currentScheme = this.getActiveSchemeItem(gridInstance.id);
                if (!currentScheme) {
                    this.setActiveSchemeItem(gridInstance.id, null);
                    simpleRef.instance.currentSchemeItem = null;
                    simpleRef.instance.resetToDefault();
                    this.prevSchemeItem = null;
                    simpleRef.instance.onSubmitClick();
                }
            }));
        }));
        /** @type {?} */
        const modalContainer = (/** @type {?} */ (schemeListDlg.dialog.instance));
        modalContainer.draggbar.handle = instance.header.nativeElement;
    }
    // 新增或另存方案
    /**
     * @private
     * @param {?} gridInstance
     * @param {?} e
     * @param {?} settings
     * @param {?} callback
     * @return {?}
     */
    showNewSchemeDialog(gridInstance, e, settings, callback) {
        /** @type {?} */
        const modalOpts = {
            width: 480, height: 269, showHeader: false, title: '控制面板',
            initialState: {
                languages: this.languages
            },
            showButtons: false,
            resizable: false
        };
        /** @type {?} */
        const newSchemeDlg = this.modalSer.show(NewSchemeComponent, modalOpts);
        // newSchemeDlg.dialog.location.nativeElement.style.zIndex = 2031;
        /** @type {?} */
        const instance = (/** @type {?} */ (newSchemeDlg.content));
        instance.closeModal.subscribe((/**
         * @return {?}
         */
        () => {
            newSchemeDlg.close();
            if (callback && callback.cancel) {
                callback.cancel();
            }
        }));
        instance.submitModal.pipe(switchMap((/**
         * @param {?} t
         * @return {?}
         */
        (t) => {
            return this.createNewScheme(gridInstance.id, t, e.type === 'new', settings);
        }))).subscribe((/**
         * @param {?} t
         * @return {?}
         */
        (t) => {
            if (t.flag === false) {
                /** @type {?} */
                const msg = t.msg;
                /** @type {?} */
                let _msg = msg;
                if (msg) {
                    if (msg.indexOf('|') > -1) {
                        _msg = msg.split('|').map((/**
                         * @param {?} langcode
                         * @return {?}
                         */
                        (langcode) => {
                            return this.localeSer.getValue('datagrid-settings.' + langcode);
                        })).join('');
                    }
                    else {
                        _msg = this.localeSer.getValue('datagrid-settings.' + msg);
                    }
                    if (this.notifyService) {
                        this.notifyService.info(_msg);
                    }
                    else {
                        this.messager.info(_msg);
                    }
                }
                return;
            }
            // 更新方案列表
            /** @type {?} */
            const schemeList = this.schemeService.getStateValue(gridInstance.id, 'list') || [];
            if (t.isDefault) {
                schemeList.forEach((/**
                 * @param {?} n
                 * @return {?}
                 */
                n => {
                    n.isDefault = false;
                }));
            }
            schemeList.push(t);
            this.schemeService.setSchemeList(gridInstance.id, schemeList);
            if (callback && callback.ok) {
                callback.ok(t);
            }
            newSchemeDlg.close();
        }));
        instance.checkAuthority.pipe(switchMap((/**
         * @param {?} t
         * @return {?}
         */
        (t) => {
            return this.schemeService.checkAuthority().pipe(map((/**
             * @param {?} auth
             * @return {?}
             */
            (auth) => {
                return Object.assign({ type: t }, auth);
            })));
        }))).subscribe((/**
         * @param {?} t
         * @return {?}
         */
        (t) => {
            /** @type {?} */
            let hasAuthority = { public: true, org: true };
            // 您没有将方案的使用范围设置为公共的权限。
            /** @type {?} */
            let _msg = 'noAuth.public';
            if (t.type.value === 'org') {
                // 您没有将方案的使用范围设置为组织的权限。
                _msg = 'noAuth.org';
            }
            /** @type {?} */
            const msg = this.localeSer.getValue('datagrid-settings.' + _msg);
            if (t.success) {
                /** @type {?} */
                const hasPublicAuthority = t.authOperationData && t.authOperationData.length;
                hasAuthority.public = hasPublicAuthority;
                /** @type {?} */
                const hasOrgAuthority = t.authOrganizationData && t.authOrganizationData.length;
                hasAuthority.org = hasOrgAuthority;
                if (t.type.value === 'public') {
                    instance.schemeInfo.type = t.type.value;
                }
                else if (t.type.value === 'org') {
                    if (!hasOrgAuthority) {
                        this.notifyService.warning(msg);
                    }
                    else {
                        instance.schemeInfo.type = t.type.value;
                        instance.schemeInfo.orgids = t.authOrganizationData.join(',');
                        instance.dataPermissionIds = t.authOrganizationData;
                    }
                }
            }
            else {
                this.notifyService.warning(msg);
                hasAuthority = { public: false, org: false };
                ;
            }
            instance.refresh(hasAuthority);
        }));
        /** @type {?} */
        const modalContainer = (/** @type {?} */ (newSchemeDlg.dialog.instance));
        modalContainer.draggbar.handle = instance.header.nativeElement;
    }
    /**
     * @param {?} gridId
     * @return {?}
     */
    getSchemeList(gridId) {
        /** @type {?} */
        const gridIns = this.getGridInstance(gridId);
        return this.schemeService.getSchemeList(gridId, gridIns.enableSetMultiHeaders);
    }
    /**
     * 新增方案
     *  isNewScheme，是否新加方案，否则为另存为
     *  currentSettings： 当前配置信息
     *  data: 新建方案窗口传递数据
     * @param {?} gridId
     * @param {?} data
     * @param {?=} isNewScheme
     * @param {?=} currentSettings
     * @return {?}
     */
    createNewScheme(gridId, data, isNewScheme = true, currentSettings) {
        if (!data.name) {
            // msg 请输入方案名称
            return of({ flag: false, msg: 'required.schemeName' });
        }
        else {
            /** @type {?} */
            const hasName = this.schemeService.hasSchemeName(gridId, data.name);
            if (typeof hasName === 'boolean' && hasName) {
                // msg '方案名称已存在，请修改。'
                return of({ flag: false, msg: 'has.exist' });
            }
            else if (Array.isArray(hasName) && hasName.length) {
                /** @type {?} */
                const getMessageCode = (/**
                 * @param {?} langCode
                 * @return {?}
                 */
                (langCode) => {
                    if (langCode === 'zh-CHS') {
                        return 'has.chs'; // 简体中文名称已存在。
                    }
                    else if (langCode === 'zh-CHT') {
                        return 'has.cht'; // 繁體中文名稱已存在。
                    }
                    else {
                        return 'has.en'; // 英文名称已存在
                    }
                });
                if (hasName.includes(this.localeSer.localeId)) {
                    /** @type {?} */
                    const msg = getMessageCode(this.localeSer.localeId);
                    return of({ flag: false, msg });
                }
                else {
                    /** @type {?} */
                    const msgs = hasName.map((/**
                     * @param {?} n
                     * @return {?}
                     */
                    n => {
                        return getMessageCode(n);
                    }));
                    return of({ flag: false, msg: msgs.join('|') });
                }
            }
        }
        /** @type {?} */
        const requiredName = [];
        if (!data.name[this.localeSer.localeId]) {
            requiredName.push(this.localeSer.localeId);
        }
        // this.languages.forEach(n => {
        //     if (data.name[n.code] === '' || data.name[n.code] === undefined) {
        //         requiredName.push(n.code);
        //     }
        // });
        if (requiredName.length) {
            /** @type {?} */
            const msgs = requiredName.map((/**
             * @param {?} n
             * @return {?}
             */
            n => {
                if (n === 'zh-CHS') {
                    return 'required.chs'; //'请输入简体中文名称。';
                }
                else if (n === 'zh-CHT') {
                    return 'required.cht'; //'请输入繁体中文名称。';
                }
                else {
                    return 'required.en'; // '请输入英文名称。';
                }
            }));
            return of({ flag: false, msg: msgs.join('|') });
        }
        if (data.type && data.type === 'org' && (!data.orgids || !data.orgids.length)) {
            // msg '请选择组织'
            return of({ flag: false, msg: 'required.org' });
        }
        /** @type {?} */
        let _config = null;
        if (!isNewScheme) {
            /** @type {?} */
            const LOCALEID = this.localeSer.localeId;
            if (currentSettings && currentSettings.columnFormat) {
                currentSettings.columnFormat = this.convertColumnsToSimple(currentSettings.columnFormat);
            }
            _config = { [LOCALEID]: currentSettings };
        }
        /** @type {?} */
        const newId = this.idService.guid();
        /** @type {?} */
        let isDefault = data.isDefault;
        if (isDefault) {
            if (data.type !== 'private') {
                isDefault = false;
            }
        }
        if (data.name && typeof data.name === 'object') {
            data.name = JSON.stringify(data.name);
        }
        /** @type {?} */
        const gridInstance = this.getGridInstance(gridId);
        if (gridInstance && gridInstance.enableSetMultiHeaders && _config) {
            _config['isMultiHeader'] = gridInstance.enableSetMultiHeaders;
        }
        /** @type {?} */
        const scheme = {
            id: newId,
            belongId: '',
            code: '',
            name: data.name,
            type: data.type,
            isDefault: isDefault,
            isSystem: false,
            extendId: 'datagrid-settings-scheme',
            extendInfo: this.buildOrgAndSchemeRelations(newId, data.orgids),
            queryConditionString: _config ? JSON.stringify(_config) : '',
        };
        return this.schemeService.saveScheme(scheme, gridId, false, gridInstance.enableSetMultiHeaders).pipe(map((/**
         * @return {?}
         */
        () => {
            return scheme;
        })));
    }
    /**
     * @param {?} schemeList
     * @param {?} gridId
     * @return {?}
     */
    setSchemeList(schemeList, gridId) {
        this.schemeService.update({ list: schemeList }, gridId);
    }
    /**
     * @private
     * @param {?} schemeId
     * @param {?} orgIds
     * @return {?}
     */
    buildOrgAndSchemeRelations(schemeId, orgIds) {
        if (!orgIds || !orgIds.length) {
            return [];
        }
        if (typeof orgIds === 'string') {
            orgIds = orgIds.split(',');
        }
        return orgIds.map((/**
         * @param {?} n
         * @return {?}
         */
        n => {
            return {
                id: this.idService.guid(),
                orgId: n,
                relatedId: schemeId
            };
        }));
    }
    /**
     * @private
     * @param {?} gridId
     * @return {?}
     */
    getCurrentSchemeSettings(gridId) {
        /** @type {?} */
        const activeScheme = (/** @type {?} */ (this.getActiveSchemeItem(gridId)));
        if (activeScheme && activeScheme.queryConditionString) {
            return JSON.parse(activeScheme.queryConditionString);
        }
        return null;
    }
    /**
     * @param {?} settings
     * @return {?}
     */
    setCurrentConfigs(settings) {
        this['CURRENT_CONFIGS'] = settings;
    }
    /**
     * @private
     * @return {?}
     */
    getCurrentConfigs() {
        return this['CURRENT_CONFIGS'] || {};
    }
    /**
     * @private
     * @param {?} e
     * @param {?} gridInstance
     * @param {?=} modal
     * @return {?}
     */
    applySettings(e, gridInstance, modal) {
        e.target.disabled = true;
        if (this.saving) {
            return;
        }
        if (!this.saving) {
            /** @type {?} */
            let _scheme;
            /** @type {?} */
            let dlg;
            if (modal) {
                const { modalRef, currentScheme } = modal;
                dlg = modalRef;
                _scheme = currentScheme;
            }
            else {
                dlg = e;
                _scheme = e.currentScheme;
            }
            this.updateGridView(dlg, gridInstance, e.target, _scheme);
        }
    }
    /**
     * @param {?} viewCols
     * @param {?} gridInitOptions
     * @return {?}
     */
    getMultiHeaderColumns(viewCols, gridInitOptions) {
        return mergetColumnOptions(viewCols, gridInitOptions);
    }
}
DatagridSettingsService.decorators = [
    { type: Injectable }
];
/** @nocollapse */
DatagridSettingsService.ctorParameters = () => [
    { type: Injector },
    { type: BsModalService },
    { type: MessagerService },
    { type: IdService },
    { type: LocaleService }
];
if (false) {
    /**
     * @type {?}
     * @private
     */
    DatagridSettingsService.prototype.multiSortMsg;
    /**
     * @type {?}
     * @private
     */
    DatagridSettingsService.prototype.columnsSortableMsg;
    /**
     * @type {?}
     * @private
     */
    DatagridSettingsService.prototype.notShowDialog;
    /**
     * @type {?}
     * @private
     */
    DatagridSettingsService.prototype._httpRestService;
    /**
     * @type {?}
     * @private
     */
    DatagridSettingsService.prototype.languages;
    /**
     * @type {?}
     * @private
     */
    DatagridSettingsService.prototype.gridRefs;
    /**
     * @type {?}
     * @private
     */
    DatagridSettingsService.prototype.activeSchemeItem;
    /**
     * @type {?}
     * @private
     */
    DatagridSettingsService.prototype.saving;
    /**
     * @type {?}
     * @private
     */
    DatagridSettingsService.prototype.cfr;
    /**
     * @type {?}
     * @private
     */
    DatagridSettingsService.prototype.app;
    /**
     * @type {?}
     * @private
     */
    DatagridSettingsService.prototype.schemeListSubscription;
    /**
     * @type {?}
     * @private
     */
    DatagridSettingsService.prototype.schemeService;
    /**
     * @type {?}
     * @private
     */
    DatagridSettingsService.prototype.notifyService;
    /**
     * @type {?}
     * @private
     */
    DatagridSettingsService.prototype.commonUtils;
    /**
     * @type {?}
     * @private
     */
    DatagridSettingsService.prototype.currentSchemeitem;
    /**
     * @type {?}
     * @private
     */
    DatagridSettingsService.prototype.prevSchemeItem;
    /**
     * @type {?}
     * @private
     */
    DatagridSettingsService.prototype.debugSer;
    /**
     * @type {?}
     * @private
     */
    DatagridSettingsService.prototype.injector;
    /**
     * @type {?}
     * @private
     */
    DatagridSettingsService.prototype.modalSer;
    /**
     * @type {?}
     * @private
     */
    DatagridSettingsService.prototype.messager;
    /**
     * @type {?}
     * @private
     */
    DatagridSettingsService.prototype.idService;
    /**
     * @type {?}
     * @private
     */
    DatagridSettingsService.prototype.localeSer;
    /* Skipping unhandled member: ;*/
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGF0YWdyaWQtc2V0dGluZ3Muc2VydmljZS5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BmYXJyaXMvdWktZGF0YWdyaWQtc2V0dGluZ3MvIiwic291cmNlcyI6WyJsaWIvZGF0YWdyaWQtc2V0dGluZ3Muc2VydmljZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7O0FBQUEsT0FBTyxFQUF3QixHQUFHLEVBQUUsU0FBUyxFQUFPLE1BQU0sZ0JBQWdCLENBQUM7QUFDM0UsT0FBTyxFQUFFLFFBQVEsRUFBYyxFQUFFLEVBQWdCLEtBQUssRUFBRSxNQUFNLE1BQU0sQ0FBQztBQUNyRSxPQUFPLEVBQUUsVUFBVSxFQUFFLFFBQVEsRUFBRSxjQUFjLEVBQUUsd0JBQXdCLEVBQUUsY0FBYyxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBRS9HLE9BQU8sRUFBRSxjQUFjLEVBQXlDLE1BQU0sa0JBQWtCLENBQUM7QUFDekYsT0FBTyxFQUFFLGVBQWUsRUFBRSxNQUFNLHFCQUFxQixDQUFDO0FBQ3RELE9BQU8sRUFBRSx5QkFBeUIsRUFBRSxNQUFNLCtCQUErQixDQUFDO0FBQzFFLE9BQU8sRUFBRSxTQUFTLEVBQXFCLE1BQU0sV0FBVyxDQUFDO0FBQ3pELE9BQU8sRUFBRSxhQUFhLEVBQUUsTUFBTSxtQkFBbUIsQ0FBQztBQUVsRCxPQUFPLEVBQUUsV0FBVyxFQUFFLFlBQVksRUFBRSxTQUFTLEVBQXVCLE1BQU0sbUJBQW1CLENBQUM7QUFDOUYsT0FBTyxFQUFFLHNCQUFzQixFQUFFLE1BQU0sd0NBQXdDLENBQUM7QUFDaEYsT0FBTyxFQUFFLHFCQUFxQixFQUFFLE1BQU0sMkJBQTJCLENBQUM7QUFDbEUsT0FBTyxFQUFFLGtCQUFrQixFQUFFLE1BQU0sOEJBQThCLENBQUM7QUFDbEUsT0FBTyxFQUFFLG1CQUFtQixFQUFFLE1BQU0sZ0NBQWdDLENBQUM7QUFDckUsT0FBTyxFQUFFLGFBQWEsRUFBRSxNQUFNLG1CQUFtQixDQUFDO0FBR2xELE9BQU8sRUFBRSw0QkFBNEIs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dGVudCI6WyJpbXBvcnQgeyBkZWJvdW5jZVRpbWUsIGZpbHRlciwgbWFwLCBzd2l0Y2hNYXAsIHRhcCB9IGZyb20gJ3J4anMvb3BlcmF0b3JzJztcclxuaW1wb3J0IHsgZm9ya0pvaW4sIE9ic2VydmFibGUsIG9mLCBTdWJzY3JpcHRpb24sIHRpbWVyIH0gZnJvbSAncnhqcyc7XHJcbmltcG9ydCB7IEluamVjdGFibGUsIEluamVjdG9yLCBJbmplY3Rpb25Ub2tlbiwgQ29tcG9uZW50RmFjdG9yeVJlc29sdmVyLCBBcHBsaWNhdGlvblJlZiB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBEYXRhZ3JpZENvbXBvbmVudCwgRGF0YUNvbHVtbiB9IGZyb20gJ0BmYXJyaXMvdWktZGF0YWdyaWQnO1xyXG5pbXBvcnQgeyBCc01vZGFsU2VydmljZSwgTW9kYWxPcHRpb25zLCBNb2RhbENvbnRhaW5lckNvbXBvbmVudCB9IGZyb20gJ0BmYXJyaXMvdWktbW9kYWwnO1xyXG5pbXBvcnQgeyBNZXNzYWdlclNlcnZpY2UgfSBmcm9tICdAZmFycmlzL3VpLW1lc3NhZ2VyJztcclxuaW1wb3J0IHsgRGF0YWdyaWRTZXR0aW5nc0NvbXBvbmVudCB9IGZyb20gJy4vZGF0YWdyaWQtc2V0dGluZ3MuY29tcG9uZW50JztcclxuaW1wb3J0IHsgY2xvbmVEZWVwLCBkZWJvdW5jZSwgZmxhdHRlbiB9IGZyb20gJ2xvZGFzaC1lcyc7XHJcbmltcG9ydCB7IExvY2FsZVNlcnZpY2UgfSBmcm9tICdAZmFycmlzL3VpLWxvY2FsZSc7XHJcbmltcG9ydCB7IFRyZWVOb2RlIH0gZnJvbSAnQGZhcnJpcy91aS10cmVldGFibGUnO1xyXG5pbXBvcnQgeyBDb21tb25VdGlscywgRGVidWdTZXJ2aWNlLCBJZFNlcnZpY2UsIFdFQkFQSV9QUkVGSVhfVE9LRU4gfSBmcm9tICdAZmFycmlzL3VpLWNvbW1vbic7XHJcbmltcG9ydCB7IFNpbXBsZUNvbHVtbnNDb21wb25lbnQgfSBmcm9tICcuL3NpbXBsZS1tb2RlL3NpbXBsZS1jb2x1bW5zLmNvbXBvbmVudCc7XHJcbmltcG9ydCB7IERhdGFncmlkU2NoZW1lU2VydmljZSB9IGZyb20gJy4vZGF0YWdyaWQtc2NoZW1lLnNlcnZpY2UnO1xyXG5pbXBvcnQgeyBOZXdTY2hlbWVDb21wb25lbnQgfSBmcm9tICcuL3NjaGVtZS9uZXdzY2hlbWUuY29tcG9uZW50JztcclxuaW1wb3J0IHsgU2NoZW1lTGlzdENvbXBvbmVudCB9IGZyb20gJy4vc2NoZW1lL3NjaGVtZS1saXN0LmNvbXBvbmVudCc7XHJcbmltcG9ydCB7IE5vdGlmeVNlcnZpY2UgfSBmcm9tICdAZmFycmlzL3VpLW5vdGlmeSc7XHJcbmltcG9ydCB7IERhdGFncmlkU2NoZW1lTW9kZWwsIElTX01VTFRJX0hFQURFUl9TVFJJTkcsIFNjaGVtZUF1dGhNb2RlbCwgU2V0dGluZ01vZGVsIH0gZnJvbSAnLi9zZXR0aW5nLm1vZGVsJztcclxuXHJcbmltcG9ydCB7IERBVEFHUklEX1NFVFRJTkdTX0xPQ0FMRURBVEEgfSAgZnJvbSAnLi9kYXRhZ3JpZC1zZXR0aW5ncy1sb2NhbGUnO1xyXG5pbXBvcnQgeyBjbGVhbkdyb3VwRmllbGRzLCBjbGVhblNvcnRGaWVsZHMsIGNvbHVtbnNUb1RyZWVOb2RlcywgZ2V0RGF0YUZpZWxkc0Zvck11bHRpSGVhZGVycywgbWVyZ2V0Q29sdW1uT3B0aW9ucywgcmVmcmVzaEdyaWRDb2x1bW5zIH0gZnJvbSAnLi9tdXRsaS1oZWFkZXJzLmhlbHBlcic7XHJcblxyXG5cclxuZXhwb3J0IGNvbnN0IEdSSURfU0VUVElOR1NfV0VCQVBJID0gIG5ldyBJbmplY3Rpb25Ub2tlbignIEZhcnJpcyBEYXRhR3JpZCBVc2VyIFNldHRpbmcgV2ViQXBpIFVSSS4nKTtcclxuXHJcbmV4cG9ydCB0eXBlIE5ld1NjaGVtZUNhbGxCYWNrID0ge1xyXG4gICAgY2FuY2VsPzogKHA/OiBhbnkpID0+IHZvaWQsXHJcbiAgICBvazogKHA6IGFueSkgPT4gdm9pZFxyXG59O1xyXG5cclxuQEluamVjdGFibGUoKVxyXG5leHBvcnQgY2xhc3MgRGF0YWdyaWRTZXR0aW5nc1NlcnZpY2Uge1xyXG5cclxuICAgIHByaXZhdGUgbXVsdGlTb3J0TXNnID0gJ+WIl+ihqOS4reacquW8gOWQr+WkmuWIl+aOkuW6j+eahOWKn+iDveOAgiDor7fmo4Dmn6XvvIEnO1xyXG4gICAgcHJpdmF0ZSBjb2x1bW5zU29ydGFibGVNc2cgPSAn5pyq5byA5ZCv5YiX55qE5o6S5bqP5Yqf6IO944CC6K+35qOA5p+l77yBJztcclxuICAgIHByaXZhdGUgbm90U2hvd0RpYWxvZyA9ICflpJrooajlpLTmmoLkuI3mlK/mjIHliJfmmL7npLrorr7nva7vvJvlkIzml7bmnKrlkK/nlKjliJfmjpLluo/lip/og73jgIInO1xyXG5cclxuICAgIHByaXZhdGUgX2h0dHBSZXN0U2VydmljZSA9IG51bGw7XHJcblxyXG4gICAgcHJpdmF0ZSBsYW5ndWFnZXM6IGFueSA9IFtdO1xyXG5cclxuICAgIGdldCBodHRwUmVzdFNlcnZpY2UoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2h0dHBSZXN0U2VydmljZTtcclxuICAgIH07XHJcblxyXG4gICAgc2V0IGh0dHBSZXN0U2VydmljZShodHRwU2VyKSB7XHJcbiAgICAgICAgdGhpcy5faHR0cFJlc3RTZXJ2aWNlID0gaHR0cFNlcjtcclxuXHJcbiAgICAgICAgaWYgKHRoaXMuc2NoZW1lU2VydmljZSkge1xyXG4gICAgICAgICAgICB0aGlzLnNjaGVtZVNlcnZpY2Uuc2V0UmVzdFNlcnZpY2UoaHR0cFNlcik7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgZ3JpZFJlZnM6IHtba2V5OiBzdHJpbmddOiBEYXRhZ3JpZENvbXBvbmVudH0gPSBudWxsO1xyXG4gICAgcHJpdmF0ZSBhY3RpdmVTY2hlbWVJdGVtOiB7W3NjaGVtZWlkOiBzdHJpbmddOiBhbnl9ID0gbnVsbDtcclxuXHJcbiAgICBwcml2YXRlIHNhdmluZyA9IGZhbHNlO1xyXG4gICAgcHJpdmF0ZSBjZnI6IENvbXBvbmVudEZhY3RvcnlSZXNvbHZlciA9IG51bGw7XHJcbiAgICBwcml2YXRlIGFwcDogQXBwbGljYXRpb25SZWYgPSBudWxsO1xyXG4gICAgcHJpdmF0ZSBzY2hlbWVMaXN0U3Vic2NyaXB0aW9uOiBTdWJzY3JpcHRpb24gPSBudWxsO1xyXG5cclxuICAgIHByaXZhdGUgc2NoZW1lU2VydmljZTogRGF0YWdyaWRTY2hlbWVTZXJ2aWNlO1xyXG4gICAgcHJpdmF0ZSBub3RpZnlTZXJ2aWNlOiBOb3RpZnlTZXJ2aWNlO1xyXG5cclxuICAgIHByaXZhdGUgY29tbW9uVXRpbHM6IENvbW1vblV0aWxzO1xyXG5cclxuICAgIHByaXZhdGUgY3VycmVudFNjaGVtZWl0ZW0gPSBudWxsO1xyXG4gICAgcHJpdmF0ZSBwcmV2U2NoZW1lSXRlbSA9IG51bGw7XHJcbiAgICBwcml2YXRlIGRlYnVnU2VyOiBEZWJ1Z1NlcnZpY2UgPSBudWxsO1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKHByaXZhdGUgaW5qZWN0b3I6IEluamVjdG9yLCBwcml2YXRlIG1vZGFsU2VyOiBCc01vZGFsU2VydmljZSxcclxuICAgICAgICAgICAgICAgIHByaXZhdGUgbWVzc2FnZXI6IE1lc3NhZ2VyU2VydmljZSwgcHJpdmF0ZSBpZFNlcnZpY2U6IElkU2VydmljZSxcclxuICAgICAgICAgICAgICAgIHByaXZhdGUgbG9jYWxlU2VyOiBMb2NhbGVTZXJ2aWNlKSB7XHJcblxyXG4gICAgICAgIHRoaXMuY2ZyID0gdGhpcy5pbmplY3Rvci5nZXQoQ29tcG9uZW50RmFjdG9yeVJlc29sdmVyKTtcclxuICAgICAgICB0aGlzLmFwcCA9IHRoaXMuaW5qZWN0b3IuZ2V0KEFwcGxpY2F0aW9uUmVmKTtcclxuICAgICAgICB0aGlzLm5vdGlmeVNlcnZpY2UgPSB0aGlzLmluamVjdG9yLmdldChOb3RpZnlTZXJ2aWNlLCBudWxsKTtcclxuICAgICAgICB0aGlzLmRlYnVnU2VyID0gdGhpcy5pbmplY3Rvci5nZXQoRGVidWdTZXJ2aWNlLCBudWxsKTtcclxuICAgICAgICB0aGlzLmNvbW1vblV0aWxzID0gdGhpcy5pbmplY3Rvci5nZXQoQ29tbW9uVXRpbHMsIG5ldyBDb21tb25VdGlscygpKTtcclxuICAgICAgICB0aGlzLnNjaGVtZVNlcnZpY2UgPSBuZXcgRGF0YWdyaWRTY2hlbWVTZXJ2aWNlKHRoaXMuaW5qZWN0b3IpO1xyXG5cclxuIFxyXG4gICAgICAgIHRoaXMubG9jYWxlU2VyLnNldExvY2FsZURhdGEoREFUQUdSSURfU0VUVElOR1NfTE9DQUxFREFUQSk7XHJcbiAgICB9XHJcblxyXG4gICAgc2V0VXJpUGVyZml4U3RyKHBlcmZpeFN0cjogc3RyaW5nKSB7XHJcblxyXG4gICAgICAgIGlmIChwZXJmaXhTdHIgPT0gJycpIHtcclxuICAgICAgICAgICAgaWYgKHdpbmRvd1snZ3NwZnJhbWV3b3JrU2VydmljZSddICYmIHdpbmRvd1snZ3NwZnJhbWV3b3JrU2VydmljZSddLmNvbW1vbikge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgYmFzZVBhdGggPSB3aW5kb3dbJ2dzcGZyYW1ld29ya1NlcnZpY2UnXS5jb21tb24uZ2V0QmFzZVBhdGg7XHJcbiAgICAgICAgICAgICAgICBpZiAoYmFzZVBhdGggJiYgYmFzZVBhdGguZ2V0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcGVyZml4U3RyID0gYmFzZVBhdGguZ2V0KCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChwZXJmaXhTdHIgIT0gJycgJiYgcGVyZml4U3RyICE9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2NoZW1lU2VydmljZS5zZXRVcmlQZXJmaXgocGVyZml4U3RyKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgfVxyXG5cclxuICAgIGRlc3Ryb3koaWQ/OiBzdHJpbmcpIHtcclxuICAgICAgICBpZiAodGhpcy5ncmlkUmVmcykge1xyXG4gICAgICAgICAgICBpZiAoaWQgJiYgdGhpcy5ncmlkUmVmc1tpZF0pIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZ3JpZFJlZnNbaWRdID0gbnVsbDtcclxuICAgICAgICAgICAgICAgIGRlbGV0ZSB0aGlzLmdyaWRSZWZzW2lkXTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGlmICghT2JqZWN0LmtleXModGhpcy5ncmlkUmVmcykubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5ncmlkUmVmcyA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5zYXZpbmcgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLnNldEFjdGl2ZVNjaGVtZUl0ZW0oaWQsIG51bGwpO1xyXG4gICAgICAgIHRoaXMuc2NoZW1lU2VydmljZS5kZXN0b3J5KGlkKTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIHdyaXRlRGVidWdNc2cobXNnLCB0eXBlID0gJ3dhcm4nKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuZGVidWdTZXIpIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuZGVidWdTZXJbdHlwZV0pIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZGVidWdTZXJbdHlwZV0obXNnKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGVbdHlwZV0obXNnKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICByZWdpc3RlckdyaWRJbnN0YW5jZShkZzogRGF0YWdyaWRDb21wb25lbnQpIHtcclxuICAgICAgICBpZiAoIWRnKSB7XHJcbiAgICAgICAgICAgIHRoaXMud3JpdGVEZWJ1Z01zZygnRGF0YWdyaWRTZXR0aW5nU2VydmljZTogZ3JpZCBpbnN0YW5jZSBpcyBudWxsLicpXHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgaWQgPSBkZy5pZDtcclxuICAgICAgICB0aGlzLmdyaWRSZWZzID0gdGhpcy5ncmlkUmVmcyB8fCB7fTtcclxuICAgICAgICBpZiAoIXRoaXMuZ3JpZFJlZnNbaWRdKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZ3JpZFJlZnNbaWRdID0gZGc7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGdldEdyaWRJbnN0YW5jZShkZ0lEOiBzdHJpbmcpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5ncmlkUmVmcyA/IHRoaXMuZ3JpZFJlZnNbZGdJRF0gOiBudWxsO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKiDmm7TmlrDmlrnmoYjkuK3nmoTphY3nva7mlbDmja4gKi9cclxuICAgIHByaXZhdGUgdXBkYXRlU2NoZW1lU2V0dGluZ3Moc2NoZW1lSXRlbTogRGF0YWdyaWRTY2hlbWVNb2RlbCwgc2V0dGluZ3M6IFBhcnRpYWw8U2V0dGluZ01vZGVsPikge1xyXG4gICAgICAgIGlmIChzY2hlbWVJdGVtICYmIHNldHRpbmdzKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHNjaGVtZUNvbnRlbnRPYmogPSBzY2hlbWVJdGVtLnF1ZXJ5Q29uZGl0aW9uU3RyaW5nID8gSlNPTi5wYXJzZShzY2hlbWVJdGVtLnF1ZXJ5Q29uZGl0aW9uU3RyaW5nKSA6IHt9O1xyXG4gICAgICAgICAgICBpZiAoc2NoZW1lQ29udGVudE9iaikge1xyXG4gICAgICAgICAgICAgICAgaWYgKCBzY2hlbWVDb250ZW50T2JqW3RoaXMubG9jYWxlU2VyLmxvY2FsZUlkXSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHNjaGVtZVNldHRpbmdzID0gc2NoZW1lQ29udGVudE9ialt0aGlzLmxvY2FsZVNlci5sb2NhbGVJZF0gfHwge307XHJcbiAgICAgICAgICAgICAgICAgICAgc2NoZW1lQ29udGVudE9ialt0aGlzLmxvY2FsZVNlci5sb2NhbGVJZF0gPSBPYmplY3QuYXNzaWduKHNjaGVtZVNldHRpbmdzLCBzZXR0aW5ncyk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHNjaGVtZUNvbnRlbnRPYmpbdGhpcy5sb2NhbGVTZXIubG9jYWxlSWRdID0gIHNldHRpbmdzO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgc2NoZW1lSXRlbS5xdWVyeUNvbmRpdGlvblN0cmluZyA9IEpTT04uc3RyaW5naWZ5KHNjaGVtZUNvbnRlbnRPYmopO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8qKiDmm7TmlrDlvZPliY3mlrnmoYjphY3nva7mlbDmja4gKi9cclxuICAgIHVwZGF0ZUFjdGl2ZVNjaGVtZUl0ZW1TZXR0aW5ncyhkZ0lkOiBzdHJpbmcsIHNldHRpbmdzOiBQYXJ0aWFsPFNldHRpbmdNb2RlbD4pIHtcclxuICAgICAgICBjb25zdCBzY2hlbWVJdGVtID0gdGhpcy5nZXRBY3RpdmVTY2hlbWVJdGVtKGRnSWQpO1xyXG4gICAgICAgIHRoaXMudXBkYXRlU2NoZW1lU2V0dGluZ3Moc2NoZW1lSXRlbSwgc2V0dGluZ3MpO1xyXG4gICAgICAgIGlmIChzY2hlbWVJdGVtKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2NoZW1lU2VydmljZS51cGRhdGVTY2hlbWVEYXRhKGRnSWQsIHNjaGVtZUl0ZW0pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvKiog6K6+572u5rS75Yqo55qE5pa55qGIICovXHJcbiAgICBzZXRBY3RpdmVTY2hlbWVJdGVtKGRnSWQ6IHN0cmluZywgYWN0aXZlSXRlbTogYW55KSB7XHJcbiAgICAgICAgY29uc3Qgc2NoZW1la2V5ID0gdGhpcy5zY2hlbWVTZXJ2aWNlLmdldFNjaGVtZUtleShkZ0lkKTtcclxuICAgICAgICB0aGlzLmFjdGl2ZVNjaGVtZUl0ZW0gPSB0aGlzLmFjdGl2ZVNjaGVtZUl0ZW0gfHwge307XHJcbiAgICAgICAgaWYgKGFjdGl2ZUl0ZW0pIHtcclxuICAgICAgICAgICAgdGhpcy5hY3RpdmVTY2hlbWVJdGVtW3NjaGVtZWtleV0gPSBjbG9uZURlZXAoYWN0aXZlSXRlbSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgZGVsZXRlIHRoaXMuYWN0aXZlU2NoZW1lSXRlbVtzY2hlbWVrZXldO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIC8qKiDojrflj5blvZPliY3mtLvliqjnmoTmlrnmoYggKi9cclxuICAgIGdldEFjdGl2ZVNjaGVtZUl0ZW0oZGdJZDogc3RyaW5nKTogRGF0YWdyaWRTY2hlbWVNb2RlbCB7XHJcbiAgICAgICAgY29uc3Qgc2NoZW1la2V5ID0gdGhpcy5zY2hlbWVTZXJ2aWNlLmdldFNjaGVtZUtleShkZ0lkKTtcclxuICAgICAgICByZXR1cm4gdGhpcy5hY3RpdmVTY2hlbWVJdGVtID8gdGhpcy5hY3RpdmVTY2hlbWVJdGVtW3NjaGVtZWtleV0gOiBudWxsO1xyXG4gICAgfVxyXG5cclxuICAgIGdldFNlYXJjaFR5cGVzKCkge1xyXG4gICAgICAgIHJldHVybiBbXHJcbiAgICAgICAgICAgIHsgdmFsdWU6ICdhbGwnLCB0aXRsZTogdGhpcy5sb2NhbGVTZXIuZ2V0VmFsdWUoJ2RhdGFncmlkLnNldHRpbmdzLmFsbENvbHVtbnMnKSB9LFxyXG4gICAgICAgICAgICB7IHZhbHVlOiAndmlzaWJsZScsIHRpdGxlOiB0aGlzLmxvY2FsZVNlci5nZXRWYWx1ZSgnZGF0YWdyaWQuc2V0dGluZ3MudmlzaWJsZUNvbHVtbnMnKSB9LFxyXG4gICAgICAgICAgICB7IHZhbHVlOiAnaGlkZGVuJywgdGl0bGU6IHRoaXMubG9jYWxlU2VyLmdldFZhbHVlKCdkYXRhZ3JpZC5zZXR0aW5ncy5oaWRkZW5Db2x1bW5zJykgfVxyXG4gICAgICAgIF07XHJcbiAgICB9XHJcblxyXG4gICAgc2hvd1NpbXBsZShncmlkSW5zdGFuY2U6IERhdGFncmlkQ29tcG9uZW50LCBzZXR0aW5ncz86IFBhcnRpYWw8U2V0dGluZ01vZGVsPiwgc2VsZWN0ZWRTY2hlbWVJdGVtPzogRGF0YWdyaWRTY2hlbWVNb2RlbCkge1xyXG4gICAgICAgIGxldCBfY29sdW1ucyA9IHRoaXMuZ2V0Q3VycmVudENvbmZpZ3MoKS5jb2x1bW5zIHx8IGdyaWRJbnN0YW5jZS5jb2x1bW5zO1xyXG5cclxuICAgICAgICBjb25zdCBjb2x1bW5zID0gdGhpcy5jb252ZXJ0Q29sdW1uc1RvU2ltcGxlKF9jb2x1bW5zKTtcclxuICAgICAgICBjb2x1bW5zWzBdID0gWy4uLmNvbHVtbnNbMF0uZmlsdGVyKG4gPT4gbi5maWVsZCAmJiBuLmZpZWxkICE9PSBncmlkSW5zdGFuY2UuQ29udHJvbFBhbmVsRmVpbGQpXTtcclxuXHJcbiAgICAgICAgY29uc3Qgc2VhcmNoVHlwZXMgPSB0aGlzLmdldFNlYXJjaFR5cGVzKCk7XHJcblxyXG4gICAgICAgIGlmICh0aGlzLmNmcikge1xyXG4gICAgICAgICAgICBjb25zdCBjbXBGYWN0b3J5ID0gdGhpcy5jZnIucmVzb2x2ZUNvbXBvbmVudEZhY3RvcnkoU2ltcGxlQ29sdW1uc0NvbXBvbmVudCk7XHJcbiAgICAgICAgICAgIGxldCBzaW1wbGVSZWYgPSBjbXBGYWN0b3J5LmNyZWF0ZSh0aGlzLmluamVjdG9yKTtcclxuICAgICAgICAgICAgdGhpcy5hcHAuYXR0YWNoVmlldyhzaW1wbGVSZWYuaG9zdFZpZXcpO1xyXG4gICAgICAgICAgICBzaW1wbGVSZWYuaW5zdGFuY2UuY29sdW1ucyA9IGNvbHVtbnM7XHJcbiAgICAgICAgICAgIHNpbXBsZVJlZi5pbnN0YW5jZS5zZWFydFR5cGVzID0gc2VhcmNoVHlwZXM7XHJcbiAgICAgICAgICAgIHNpbXBsZVJlZi5pbnN0YW5jZS5ncmlkSW5zdGFuY2UgPSBncmlkSW5zdGFuY2U7XHJcblxyXG4gICAgICAgICAgICBzaW1wbGVSZWYuaW5zdGFuY2Uuc2NoZW1lU2VyID0gdGhpcy5zY2hlbWVTZXJ2aWNlO1xyXG5cclxuICAgICAgICAgICAgaWYgKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNwYWdlLXdyYXBwZXInKSkge1xyXG4gICAgICAgICAgICAgICAgc2ltcGxlUmVmLmluc3RhbmNlLnRvcCA9IDc2O1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBzaW1wbGVSZWYuaW5zdGFuY2UuZW5hYmxlU2NoZW1lID0gZ3JpZEluc3RhbmNlLmVuYWJsZVNjaGVtZTtcclxuXHJcbiAgICAgICAgICAgIGlmICghc2V0dGluZ3MpIHtcclxuICAgICAgICAgICAgICAgIHNldHRpbmdzID0gdGhpcy5nZXRDdXJyZW50Q29uZmlncygpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBpZiAoZ3JpZEluc3RhbmNlLmVuYWJsZVNjaGVtZSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgX2N1cnJlbnRTY2hlbXRJdGVtID0gdGhpcy5nZXRBY3RpdmVTY2hlbWVJdGVtKGdyaWRJbnN0YW5jZS5pZCk7XHJcbiAgICAgICAgICAgICAgICBpZiAoc2V0dGluZ3MpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyAg5LuO6auY57qn5qih5byPIOi9rOWIsCDnroDmtIHmqKHlvI/ml7bvvIzkv53lrZjljp/lp4vlgLxcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIXNpbXBsZVJlZi5pbnN0YW5jZVsncHJldlNjaGVtZUl0ZW0nXSAmJiB0aGlzLnByZXZTY2hlbWVJdGVtKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNpbXBsZVJlZi5pbnN0YW5jZVsncHJldlNjaGVtZUl0ZW0nXSA9IGNsb25lRGVlcCh0aGlzLnByZXZTY2hlbWVJdGVtKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChzZWxlY3RlZFNjaGVtZUl0ZW0pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy51cGRhdGVTY2hlbWVTZXR0aW5ncyhzZWxlY3RlZFNjaGVtZUl0ZW0sIHNldHRpbmdzKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2ltcGxlUmVmLmluc3RhbmNlLmN1cnJlbnRTY2hlbWVJdGVtID0gc2VsZWN0ZWRTY2hlbWVJdGVtO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChfY3VycmVudFNjaGVtdEl0ZW0pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudFNjaGVtZWl0ZW0gPSBfY3VycmVudFNjaGVtdEl0ZW07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnByZXZTY2hlbWVJdGVtID0gY2xvbmVEZWVwKF9jdXJyZW50U2NoZW10SXRlbSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaW1wbGVSZWYuaW5zdGFuY2UuY3VycmVudFNjaGVtZUl0ZW0gPSBfY3VycmVudFNjaGVtdEl0ZW07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFPYmplY3Qua2V5cyhzZXR0aW5ncykubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2V0dGluZ3MgPSB0aGlzLmdldExvY2FsU2V0dGluZ3ModGhpcy5jcmVhdGVDb25maWdLZXkoZ3JpZEluc3RhbmNlLmlkKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2ltcGxlUmVmLmluc3RhbmNlLmN1cnJlbnRTY2hlbWVJdGVtID0gbnVsbDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpbXBsZVJlZi5pbnN0YW5jZS5zZXR0aW5ncyA9IHNldHRpbmdzO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRTY2hlbWVpdGVtID0gX2N1cnJlbnRTY2hlbXRJdGVtO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJldlNjaGVtZUl0ZW0gPSBjbG9uZURlZXAoX2N1cnJlbnRTY2hlbXRJdGVtKTtcclxuICAgICAgICAgICAgICAgICAgICBzaW1wbGVSZWYuaW5zdGFuY2UuY3VycmVudFNjaGVtZUl0ZW0gPSBfY3VycmVudFNjaGVtdEl0ZW07XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoZ3JpZEluc3RhbmNlLmVuYWJsZVNldE11bHRpSGVhZGVycykge1xyXG4gICAgICAgICAgICAgICAgICAgIHNpbXBsZVJlZi5pbnN0YW5jZS5zZXR0aW5ncyA9IHRoaXMuZ2V0Q3VycmVudENvbmZpZ3MoKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2ltcGxlUmVmLmluc3RhbmNlLnNldHRpbmdzID0gc2V0dGluZ3M7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcblxyXG4gICAgICAgICAgICBjb25zdCB6SW5kZXggPSB0aGlzLmNvbW1vblV0aWxzLmdldEZsb2F0aW5nTGF5ZXJJbmRleCgpO1xyXG4gICAgICAgICAgICBzaW1wbGVSZWYubG9jYXRpb24ubmF0aXZlRWxlbWVudC5zdHlsZS56SW5kZXggPSAnJyArIHpJbmRleDtcclxuXHJcbiAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoc2ltcGxlUmVmLmxvY2F0aW9uLm5hdGl2ZUVsZW1lbnQpO1xyXG5cclxuICAgICAgICAgICAgc2ltcGxlUmVmLmluc3RhbmNlLmNhbmNlbGQuc3Vic2NyaWJlKCAoKSA9PntcclxuICAgICAgICAgICAgICAgIHRoaXMucmVzdG9yZVNjaGVtZShncmlkSW5zdGFuY2UpO1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIHNpbXBsZVJlZi5pbnN0YW5jZS5jbG9zZWQucGlwZShcclxuICAgICAgICAgICAgICAgIHN3aXRjaE1hcCggKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChzaW1wbGVSZWYpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2ltcGxlUmVmLmluc3RhbmNlLmNvbnRhaW5lci5uYXRpdmVFbGVtZW50LnN0eWxlLnJpZ2h0ID0gJy01MDBweCc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0aW1lcig1MDApO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICkuc3Vic2NyaWJlKCgpID0+IHtcclxuICAgICAgICAgICAgICAgIHNpbXBsZVJlZi5sb2NhdGlvbi5uYXRpdmVFbGVtZW50LnJlbW92ZSgpO1xyXG4gICAgICAgICAgICAgICAgc2ltcGxlUmVmLmRlc3Ryb3koKTtcclxuICAgICAgICAgICAgICAgIHNpbXBsZVJlZiA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5zY2hlbWVMaXN0U3Vic2NyaXB0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zY2hlbWVMaXN0U3Vic2NyaXB0aW9uLnVuc3Vic2NyaWJlKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgY29uc3QgX2FjdGl2ZVNjaGVtdEl0ZW0gPSB0aGlzLmdldEFjdGl2ZVNjaGVtZUl0ZW0oZ3JpZEluc3RhbmNlLmlkKTtcclxuICAgICAgICAgICAgICAgIGlmICgoIXRoaXMuY3VycmVudFNjaGVtZWl0ZW0gfHwgKF9hY3RpdmVTY2hlbXRJdGVtICYmIF9hY3RpdmVTY2hlbXRJdGVtLmlkICE9PSB0aGlzLmN1cnJlbnRTY2hlbWVpdGVtLmlkKSkgJiYgKF9hY3RpdmVTY2hlbXRJdGVtICYmX2FjdGl2ZVNjaGVtdEl0ZW0ucXVlcnlDb25kaXRpb25TdHJpbmcpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgX2N1cnJlbnRTZXR0aW5ncyA9IEpTT04ucGFyc2UoX2FjdGl2ZVNjaGVtdEl0ZW0ucXVlcnlDb25kaXRpb25TdHJpbmcpW3RoaXMubG9jYWxlU2VyLmxvY2FsZUlkXTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoX2N1cnJlbnRTZXR0aW5ncykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb2x1bW5zWzBdLmZvckVhY2goZiA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmLnZpc2libGUgPSBfY3VycmVudFNldHRpbmdzLnZpZXdDb2x1bW5zLmluZGV4T2YoZi5maWVsZCkgPiAtMTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSAgICAgIFxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIC8vIOaJk+W8gOmrmOe6p+iuvue9rueql+WPo1xyXG4gICAgICAgICAgICBzaW1wbGVSZWYuaW5zdGFuY2UuYWR2YW5jZWQuc3Vic2NyaWJlKCh7IHZpZXdGaWVsZHMsIHNldHRpbmdzLCBjb2x1bW5zIH0pID0+IHtcclxuICAgICAgICAgICAgICAgIC8vIGlmICh2aWV3RmllbGRzICYmIHZpZXdGaWVsZHMubGVuZ3RoKXtcclxuICAgICAgICAgICAgICAgIC8vICAgICB0aGlzLnVwZGF0ZVNjaGVtZVNldHRpbmdzKHNpbXBsZVJlZi5pbnN0YW5jZS5jdXJyZW50U2NoZW1lSXRlbSwge3ZpZXdDb2x1bW5zOiB2aWV3RmllbGRzfSk7XHJcbiAgICAgICAgICAgICAgICAvLyB9XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNldEN1cnJlbnRDb25maWdzKHsuLi5zZXR0aW5ncywgY29sdW1uc30pO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5wcmV2U2NoZW1lSXRlbSA9IHNpbXBsZVJlZi5pbnN0YW5jZVsncHJldlNjaGVtZUl0ZW0nXTtcclxuICAgICAgICAgICAgICAgIHRoaXNbJ1NDSEVNRV9ERUZBVUxUX1RJVExFJ10gPSBzaW1wbGVSZWYuaW5zdGFuY2UuZGVmYXVsdFNjaGVtZU5hbWU7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNob3dBZHZhbmNlZChncmlkSW5zdGFuY2UsIG51bGwsIHNpbXBsZVJlZi5pbnN0YW5jZS5jdXJyZW50U2NoZW1lSXRlbSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgc2ltcGxlUmVmLmluc3RhbmNlLnN1Ym1pdC5zdWJzY3JpYmUoIChlOiBhbnkpID0+IHtcclxuICAgICAgICAgICAgICAgIHRoaXMuYXBwbHlTZXR0aW5ncyhlLCBncmlkSW5zdGFuY2UpO1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIC8vIOWkmuihqOWIl+iuvue9rlxyXG4gICAgICAgICAgICBzaW1wbGVSZWYuaW5zdGFuY2Uuc3VibWl0Rm9yR3JvdXBIZWFkZXIuc3Vic2NyaWJlKChlOiBhbnkpID0+IHtcclxuICAgICAgICAgICAgICAgIHRoaXMuYXBwbHlTZXR0aW5ncyhlLCBncmlkSW5zdGFuY2UpO1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIC8vIHNpbXBsZVJlZi5pbnN0YW5jZS5maWVsZHNDaGFuZ2Uuc3Vic2NyaWJlKCh2aXNpYmxlRmllbGRzOiBzdHJpbmdbXSkgPT4ge1xyXG4gICAgICAgICAgICAvLyAgICAgdGhpcy51cGRhdGVBY3RpdmVTY2hlbWVJdGVtU2V0dGluZ3MoZ3JpZEluc3RhbmNlLmlkLCB7dmlld0NvbHVtbnM6IHZpc2libGVGaWVsZHN9KVxyXG4gICAgICAgICAgICAvLyB9KTtcclxuXHJcbiAgICAgICAgICAgIC8vIOaJk+W8gOaWsOWinuaWueahiOeql+WPo1xyXG4gICAgICAgICAgICBzaW1wbGVSZWYuaW5zdGFuY2UuYWRkTmV3U2NoZW1lLnN1YnNjcmliZSgoZTogeyB0eXBlOiAnbmV3JyB8ICdzYXZlYXMnfSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zaG93TmV3U2NoZW1lRGlhbG9nKGdyaWRJbnN0YW5jZSwgZSwgc2ltcGxlUmVmLmluc3RhbmNlLmNvbGxlY3RTZXR0aW5ncygpLCB7XHJcbiAgICAgICAgICAgICAgICAgICAgb2s6ICh0OiBhbnkpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8g5pu05o2i5Li65paw55qE5pa55qGIXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNpbXBsZVJlZi5pbnN0YW5jZS5vblNjaGVtZUl0ZW1DbGljayhudWxsLCB0KTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2F2ZVVzZXJDb25maWdcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBzaW1wbGVSZWYuaW5zdGFuY2Uuc2NoZW1lTGlzdCA9IHRoaXMuc2NoZW1lU2VydmljZS5nZXRTdGF0ZVZhbHVlKGdyaWRJbnN0YW5jZS5pZCwgJ2xpc3QnKSB8fCBbXTtcclxuXHJcbiAgICAgICAgICAgIC8vIOaJk+W8gOaWueahiOeuoeeQhuWIl+ihqOeql+WPo1xyXG4gICAgICAgICAgICBzaW1wbGVSZWYuaW5zdGFuY2Uuc2hvd1NjaGVtZUxpc3Quc3Vic2NyaWJlKCgpID0+IHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZ2V0U2NoZW1lTGlzdChncmlkSW5zdGFuY2UuaWQpLnBpcGUoXHJcbiAgICAgICAgICAgICAgICAgICAgc3dpdGNoTWFwKCh0KSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnNjaGVtZVNlcnZpY2UuY2hlY2tBdXRob3JpdHkoKS5waXBlKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFwKChhdXRoOiBTY2hlbWVBdXRoTW9kZWwpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaXN0OiB0LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuLi5hdXRoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgKVxyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICApLnN1YnNjcmliZSgodDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zY2hlbWVTZXJ2aWNlLnNldFNjaGVtZUxpc3QoZ3JpZEluc3RhbmNlLmlkLCB0Lmxpc3QgfHwgW10pO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2hvd1NjaGVtZUxpc3REaWFsb2coZ3JpZEluc3RhbmNlLCBjbG9uZURlZXAodC5saXN0IHx8IFtdKSwgdCwgc2ltcGxlUmVmKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuc2NoZW1lTGlzdFN1YnNjcmlwdGlvbiA9IHRoaXMuc2NoZW1lU2VydmljZS5zY2hlbWVMaXN0JC5zdWJzY3JpYmUoKGxpc3Q6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgc2ltcGxlUmVmLmluc3RhbmNlLnNjaGVtZUxpc3QgPSBsaXN0O1xyXG5cclxuICAgICAgICAgICAgICAgIGlmICghbGlzdCB8fCAhbGlzdC5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNldEFjdGl2ZVNjaGVtZUl0ZW0oZ3JpZEluc3RhbmNlLmlkLCBudWxsKTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgY29uc3QgX2FjdGl2ZVNjaGVtZUl0ZW0gPSB0aGlzLmdldEFjdGl2ZVNjaGVtZUl0ZW0oZ3JpZEluc3RhbmNlLmlkKTtcclxuICAgICAgICAgICAgICAgIGlmIChfYWN0aXZlU2NoZW1lSXRlbSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCBoYXNBY3RpdmVJdGVtID0gbGlzdC5maW5kKG4gPT4gbi5pZCA9PT0gX2FjdGl2ZVNjaGVtZUl0ZW0uaWQpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghaGFzQWN0aXZlSXRlbSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBoYXNBY3RpdmVJdGVtID0gdGhpcy5nZXREZWZhdWx0U2NoZW1lKGxpc3QpOyAvLyDojrflj5borr7nva7kuLrlvZPliY3mlrnmoYjnmoTpoblcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRBY3RpdmVTY2hlbWVJdGVtKGdyaWRJbnN0YW5jZS5pZCwgaGFzQWN0aXZlSXRlbSB8fCBudWxsKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHNpbXBsZVJlZi5pbnN0YW5jZS5jdXJyZW50U2NoZW1lSXRlbSA9IGhhc0FjdGl2ZUl0ZW07XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgLy8g5YiH5o2i5pa55qGIXHJcbiAgICAgICAgICAgIHNpbXBsZVJlZi5pbnN0YW5jZS5zY2hlbWVDaGFuZ2VkLnN1YnNjcmliZSgodDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRTY2hlbWVpdGVtID0gdDtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0QWN0aXZlU2NoZW1lSXRlbShncmlkSW5zdGFuY2UuaWQsIGNsb25lRGVlcCh0KSk7XHJcbiAgICAgICAgICAgIH0pXHJcblxyXG4gICAgICAgICAgICBzaW1wbGVSZWYuaG9zdFZpZXcuZGV0ZWN0Q2hhbmdlcygpO1xyXG4gICAgICAgICAgICBzaW1wbGVSZWYuaW5zdGFuY2UuY2QuZGV0ZWN0Q2hhbmdlcygpO1xyXG4gICAgICAgICAgICBzaW1wbGVSZWYuaW5zdGFuY2UuY29udGFpbmVyLm5hdGl2ZUVsZW1lbnQuc3R5bGUucmlnaHQgPSAnMHB4JztcclxuXHJcbiAgICAgICAgICAgIHJldHVybiBzaW1wbGVSZWY7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuXHJcbiAgICBzaG93KGdyaWRJbnN0YW5jZTogRGF0YWdyaWRDb21wb25lbnQsIG9wdHM/OiBNb2RhbE9wdGlvbnMpIHtcclxuICAgICAgICB0aGlzLnJlZ2lzdGVyR3JpZEluc3RhbmNlKGdyaWRJbnN0YW5jZSk7XHJcblxyXG4gICAgICAgIGlmIChncmlkSW5zdGFuY2UuZW5hYmxlU2ltcGxlTW9kZSkge1xyXG4gICAgICAgICAgICB0aGlzLnNjaGVtZVNlcnZpY2UuY3JlYXRlU2NoZW1lVGFza0lEKCk7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnNob3dTaW1wbGUoZ3JpZEluc3RhbmNlKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zaG93QWR2YW5jZWQoZ3JpZEluc3RhbmNlLCBvcHRzKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSByZXN0b3JlU2NoZW1lKGdyaWRJbnN0YW5jZSkge1xyXG4gICAgICAgIGlmIChncmlkSW5zdGFuY2UuZW5hYmxlU2NoZW1lKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2V0QWN0aXZlU2NoZW1lSXRlbShncmlkSW5zdGFuY2UuaWQsIHRoaXMucHJldlNjaGVtZUl0ZW0pO1xyXG4gICAgICAgICAgICBpZiAoIXRoaXMucHJldlNjaGVtZUl0ZW0pIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0Q3VycmVudENvbmZpZ3MobnVsbCk7ICAgIFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5zZXRDdXJyZW50Q29uZmlncyhudWxsKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBzaG93QWR2YW5jZWQoZ3JpZEluc3RhbmNlOiBEYXRhZ3JpZENvbXBvbmVudCwgb3B0cz86IE1vZGFsT3B0aW9ucywgc2VsZWN0ZWRTY2hlbWVJdGVtPzogRGF0YWdyaWRTY2hlbWVNb2RlbCkge1xyXG4gICAgICAgIGxldCBfZWRpdENvbFNvcnRJbmZvID0gdHJ1ZTtcclxuICAgICAgICBjb25zdCBlZGl0Q29sU29ydEluZm8gPSB0aGlzLmNhblNldENvbHVtblNvcnQoZ3JpZEluc3RhbmNlKTtcclxuICAgICAgICBpZiAoZWRpdENvbFNvcnRJbmZvICE9PSB0cnVlKSB7XHJcbiAgICAgICAgICAgIF9lZGl0Q29sU29ydEluZm8gPSBmYWxzZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIOWIpOaWreaYr+WQpuS4uuWkmuihqOWktFxyXG4gICAgICAgIGNvbnN0IHNob3dTZXRDb2x1bW5zVGFiID0gIWdyaWRJbnN0YW5jZS5pc011bHRpSGVhZGVyKCkgfHwgKGdyaWRJbnN0YW5jZS5pc011bHRpSGVhZGVyKCkgJiYgZ3JpZEluc3RhbmNlLmVuYWJsZVNldE11bHRpSGVhZGVycyk7XHJcbiAgICAgICAgY29uc3QgZ2V0QWN0aXZlVGFiSW5kZXggPSAoKSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChzaG93U2V0Q29sdW1uc1RhYikge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIDE7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoX2VkaXRDb2xTb3J0SW5mbykge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAyO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gLTE7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICAgIGNvbnN0IGFjdGl2ZVRhYkluZGV4ID0gZ2V0QWN0aXZlVGFiSW5kZXgoKTtcclxuXHJcbiAgICAgICAgaWYgKGFjdGl2ZVRhYkluZGV4ID09PSAtMSkge1xyXG4gICAgICAgICAgICB0aGlzLm1lc3NhZ2VyLndhcm5pbmcodGhpcy5ub3RTaG93RGlhbG9nKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3QgY29sdW1ucyA9IHRoaXMuY29udmVydENvbHVtbnNUb1NpbXBsZSh0aGlzLmdldEN1cnJlbnRDb25maWdzKCkuY29sdW1ucyB8fCBncmlkSW5zdGFuY2UuY29sdW1ucyk7XHJcblxyXG4gICAgICAgIC8vIOiOt+WPluW9k+WJjeaWueahiOS4reW9k+WJjeivreiogOeahOmFjee9ruaVsOaNrlxyXG4gICAgICAgIGxldCBjdXJyZW50U2V0dGluZ3M6IFNldHRpbmdNb2RlbCA9IHRoaXMuZ2V0Q3VycmVudENvbmZpZ3MoKTtcclxuICAgICAgICBjb25zdCBtdWx0aUhlYWRlclRyZWUgPSBjdXJyZW50U2V0dGluZ3MgJiYgY3VycmVudFNldHRpbmdzLm11bHRpSGVhZGVycz8gY3VycmVudFNldHRpbmdzLm11bHRpSGVhZGVycy50cmVlRGF0YSA6IG51bGw7XHJcbiAgICAgICAgaWYgKHNlbGVjdGVkU2NoZW1lSXRlbSAmJiBzZWxlY3RlZFNjaGVtZUl0ZW0ucXVlcnlDb25kaXRpb25TdHJpbmcpIHtcclxuICAgICAgICAgICAgY29uc3QgX2N1cnJlbnRTZXR0aW5ncyA9IEpTT04ucGFyc2Uoc2VsZWN0ZWRTY2hlbWVJdGVtLnF1ZXJ5Q29uZGl0aW9uU3RyaW5nKVt0aGlzLmxvY2FsZVNlci5sb2NhbGVJZF07XHJcbiAgICAgICAgICAgIGN1cnJlbnRTZXR0aW5ncyA9IE9iamVjdC5hc3NpZ24oX2N1cnJlbnRTZXR0aW5ncyB8fCB7fSwgY3VycmVudFNldHRpbmdzIHx8IHt9KTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGlmIChjdXJyZW50U2V0dGluZ3MuY29sdW1uRm9ybWF0ICYmIGN1cnJlbnRTZXR0aW5ncy5jb2x1bW5Gb3JtYXQubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICBjb2x1bW5zWzBdID0gY29sdW1uc1swXS5tYXAoKGNvbCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGZjb2wgPSBjdXJyZW50U2V0dGluZ3MuY29sdW1uRm9ybWF0LmZpbmQobiA9PiBuLmZpZWxkID09PSBjb2wuZmllbGQpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChmY29sKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbCA9IE9iamVjdC5hc3NpZ24oY29sLCBmY29sKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNvbDtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIFxyXG4gICAgICAgIGlmICghZ3JpZEluc3RhbmNlLmVuYWJsZVNldE11bHRpSGVhZGVycyAmJiBjdXJyZW50U2V0dGluZ3Mudmlld0NvbHVtbnMgJiYgY3VycmVudFNldHRpbmdzLnZpZXdDb2x1bW5zLmxlbmd0aCkge1xyXG4gICAgICAgICAgICBjb2x1bW5zWzBdLmZvckVhY2goZiA9PiB7XHJcbiAgICAgICAgICAgICAgICBmLnZpc2libGUgPSBjdXJyZW50U2V0dGluZ3Mudmlld0NvbHVtbnMuaW5kZXhPZihmLmZpZWxkKSA+IC0xO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgY29sdW1uc1swXSA9IGNvbHVtbnNbMF0uZmlsdGVyKG4gPT4gbi5maWVsZCAmJiBuLmZpZWxkICE9PSBncmlkSW5zdGFuY2UuQ29udHJvbFBhbmVsRmVpbGQpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGxldCBzb3J0RmllbGRzID0gZ2V0RGF0YUZpZWxkc0Zvck11bHRpSGVhZGVycyhjbG9uZURlZXAoY29sdW1ucykpLmZpbHRlciggKG46IGFueSkgPT4gbi5maWVsZC5pbmRleE9mKCdmYXJyaXMtZGF0YWdyaWQtY29sdW1uXycpID09IC0xICYmIG4uc29ydGFibGUpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGlmIChncmlkSW5zdGFuY2UuZW5hYmxlU2V0TXVsdGlIZWFkZXJzICYmIGN1cnJlbnRTZXR0aW5ncyAmJiBjdXJyZW50U2V0dGluZ3MubXVsdGlIZWFkZXJzICkge1xyXG4gICAgICAgICAgICBzb3J0RmllbGRzID0gZ2V0RGF0YUZpZWxkc0Zvck11bHRpSGVhZGVycyhjdXJyZW50U2V0dGluZ3MubXVsdGlIZWFkZXJzLnZpZXdDb2xzKS5maWx0ZXIoIChuOiBhbnkpID0+IG4uZmllbGQuaW5kZXhPZignZmFycmlzLWRhdGFncmlkLWNvbHVtbl8nKSA9PSAtMSAmJiBuLnNvcnRhYmxlKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIGNvbnN0IHRyZWVEYXRhID0gdGhpcy5jb252ZXJ0Q29sdW1uczJUcmVlRGF0YShjbG9uZURlZXAoY29sdW1ucyksIHRydWUpO1xyXG4gICAgICAgIC8vIGNvbnN0IHZpZXdDb2x1bW5zVHJlZURhdGEgPSB0aGlzLmNvbnZlcnRDb2x1bW5zMlRyZWVEYXRhKGNsb25lRGVlcChjb2x1bW5zKSwgZmFsc2UpO1xyXG4gICAgICAgIC8vIHRoaXMuY2hlY2tWaWV3VHJlZU5vZGVzKHZpZXdDb2x1bW5zVHJlZURhdGEpO1xyXG5cclxuICAgICAgICBsZXQgbW9kYWxSZWYgPSBudWxsO1xyXG5cclxuICAgICAgICAvLyBjb25zdCBva1RleHQgPSB0aGlzLmxvY2FsZVNlci5nZXRWYWx1ZSgnZGF0YWdyaWQuc2V0dGluZ3Mub2snKSB8fCAn56Gu5a6aJztcclxuICAgICAgICAvLyBjb25zdCBjYW5jZWxUZXh0ID0gdGhpcy5sb2NhbGVTZXIuZ2V0VmFsdWUoJ2RhdGFncmlkLnNldHRpbmdzLmNhbmNlbCcpIHx8ICflj5bmtognO1xyXG4gICAgICAgIC8vIGNvbnN0IHJlc2V0VGV4dCA9ICB0aGlzLmxvY2FsZVNlci5nZXRWYWx1ZSgnZGF0YWdyaWQuc2V0dGluZ3MucmVzZXQnKSB8fCAn6YeN572uJztcclxuXHJcbiAgICAgICAgY29uc3QgZGVmYXVsdE9wdHMgPSB7XHJcbiAgICAgICAgICAgIHdpZHRoOiA3NjAsIGhlaWdodDogNTYwLCBzaG93SGVhZGVyOiBmYWxzZSwgdGl0bGU6ICfmjqfliLbpnaLmnb8nLFxyXG4gICAgICAgICAgICBpbml0aWFsU3RhdGU6IHtcclxuICAgICAgICAgICAgICAgIGNvbHVtbnMsXHJcbiAgICAgICAgICAgICAgICBzb3J0VHJlZURhdGE6IHNvcnRGaWVsZHMsXHJcbiAgICAgICAgICAgICAgICAvLyB2aWV3VHJlZURhdGE6IHZpZXdDb2x1bW5zVHJlZURhdGEsXHJcbiAgICAgICAgICAgICAgICBncmlkSW5zdGFuY2UsXHJcbiAgICAgICAgICAgICAgICBjYW5TZXRDb2x1bW5Tb3J0OiBfZWRpdENvbFNvcnRJbmZvLFxyXG4gICAgICAgICAgICAgICAgY2FuU2V0Q29sdW1uVmlzaWJsZTogc2hvd1NldENvbHVtbnNUYWIsXHJcbiAgICAgICAgICAgICAgICBhY3RpdmVUYWJJbmRleCxcclxuICAgICAgICAgICAgICAgIHNjaGVtZUluZm86IGN1cnJlbnRTZXR0aW5ncyxcclxuICAgICAgICAgICAgICAgIGVuYWJsZU11bHRpcGxlSGVhZGVyczogZ3JpZEluc3RhbmNlLmVuYWJsZVNldE11bHRpSGVhZGVycyxcclxuICAgICAgICAgICAgICAgIG11bHRpSGVhZGVyczoge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbHVtbnMsXHJcbiAgICAgICAgICAgICAgICAgICAgdHJlZURhdGE6IG11bHRpSGVhZGVyVHJlZVxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIHNjaGVtZU5hbWU6IHNlbGVjdGVkU2NoZW1lSXRlbT8gc2VsZWN0ZWRTY2hlbWVJdGVtWydfdGl0bGVfJ10gOiB0aGlzWydTQ0hFTUVfREVGQVVMVF9USVRMRSddXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHNob3dCdXR0b25zOiBmYWxzZSxcclxuICAgICAgICAgICAgY2xvc2VkOiAoaXNDbG9zZUJ0biwgb3B0cykgPT4ge1xyXG4gICAgICAgICAgICAgICAgY29uc3Qge2V2ZW50fSA9IG9wdHM7XHJcbiAgICAgICAgICAgICAgICBpZiAoZXZlbnQgJiYgZXZlbnQuY29kZSA9PT0gJ0VzY2FwZScpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnJlc3RvcmVTY2hlbWUoZ3JpZEluc3RhbmNlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgY29uc3QgbW9kYWxPcHRzID0gT2JqZWN0LmFzc2lnbihkZWZhdWx0T3B0cywgb3B0cyB8fCB7fSk7XHJcblxyXG4gICAgICAgIG1vZGFsUmVmID0gdGhpcy5tb2RhbFNlci5zaG93KERhdGFncmlkU2V0dGluZ3NDb21wb25lbnQsIG1vZGFsT3B0cyk7XHJcbiAgICAgICAgY29uc3QgaW5zdGFuY2UgPSBtb2RhbFJlZi5jb250ZW50IGFzIERhdGFncmlkU2V0dGluZ3NDb21wb25lbnQ7XHJcbiAgICAgICAgaW5zdGFuY2UuZW5hYmxlUmVzZXQgPSB0cnVlO1xyXG4gICAgICAgIGluc3RhbmNlLm1vZGFsUmVmID0gbW9kYWxSZWY7XHJcbiAgICAgICAgaW5zdGFuY2UuY2FuU2V0Q29sdW1uU29ydCA9IF9lZGl0Q29sU29ydEluZm87XHJcbiAgICAgICAgaW5zdGFuY2UuY2FuU2V0Q29sdW1uVmlzaWJsZSA9IHNob3dTZXRDb2x1bW5zVGFiO1xyXG5cclxuICAgICAgICBpbnN0YW5jZS5zdWJtaXRIYW5kbGUuc3Vic2NyaWJlKChlKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuYXBwbHlTZXR0aW5ncyhlLCBncmlkSW5zdGFuY2UsIHttb2RhbFJlZiwgY3VycmVudFNjaGVtZTogc2VsZWN0ZWRTY2hlbWVJdGVtfSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGluc3RhbmNlLmNhbmNlbEhhbmRsZS5zdWJzY3JpYmUoKGUpID0+IHtcclxuICAgICAgICAgICAgbW9kYWxSZWYuY2xvc2UoKTtcclxuICAgICAgICAgICAgdGhpcy5yZXN0b3JlU2NoZW1lKGdyaWRJbnN0YW5jZSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIC8vIOWIh+aNouWIsOS+p+i+ueagj+eugOa0geaooeW8j1xyXG4gICAgICAgIGluc3RhbmNlLmNvbmNpc2Uuc3Vic2NyaWJlKChlKSA9PiB7XHJcbiAgICAgICAgICAgIG1vZGFsUmVmLmNsb3NlKCk7XHJcbiAgICAgICAgICAgIGNvbnN0IHNldHRpbmdzID0gbW9kYWxSZWYuY29udGVudDtcclxuICAgICAgICAgICAgY29uc3QgeyBzb3J0SW5mbywgdmlld0NvbHVtbnMsIGNvbHVtbkZvcm1hdCwgZ3JvdXBGaWVsZCwgbXVsdGlIZWFkZXJzIH0gPSBzZXR0aW5ncztcclxuICAgICAgICAgICAgdGhpcy5zZXRDdXJyZW50Q29uZmlncyh7IHNvcnRJbmZvLCB2aWV3Q29sdW1ucywgY29sdW1uRm9ybWF0LCBncm91cEZpZWxkLCBtdWx0aUhlYWRlcnMgfSk7XHJcbiAgICAgICAgICAgIHRoaXMuc2hvd1NpbXBsZShncmlkSW5zdGFuY2UsIFxyXG4gICAgICAgICAgICAgICAgeyBzb3J0SW5mbywgdmlld0NvbHVtbnMsIGNvbHVtbkZvcm1hdCwgZ3JvdXBGaWVsZCwgbXVsdGlIZWFkZXJzIH0sIFxyXG4gICAgICAgICAgICAgICAgY2xvbmVEZWVwKHNlbGVjdGVkU2NoZW1lSXRlbSkpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBjb25zdCBtb2RhbENvbnRhaW5lciA9IG1vZGFsUmVmLmRpYWxvZy5pbnN0YW5jZSBhcyBNb2RhbENvbnRhaW5lckNvbXBvbmVudDtcclxuICAgICAgICBtb2RhbENvbnRhaW5lci5kcmFnZ2Jhci5oYW5kbGUgPSBpbnN0YW5jZS5oZWFkZXIubmF0aXZlRWxlbWVudDtcclxuXHJcbiAgICAgICAgcmV0dXJuIG1vZGFsUmVmO1xyXG4gICAgfVxyXG5cclxuXHJcblxyXG4gICAgcHJpdmF0ZSBjYW5TZXRDb2x1bW5Tb3J0KGdyaWRJbnN0YW5jZTogRGF0YWdyaWRDb21wb25lbnQpIHtcclxuICAgICAgICBpZiAoZ3JpZEluc3RhbmNlLm11bHRpU29ydCAmJiB0aGlzLmhhc0VuYWJsZVNvcnRDb2x1bW5zKGdyaWRJbnN0YW5jZSkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgaWYgKCF0aGlzLmhhc0VuYWJsZVNvcnRDb2x1bW5zKGdyaWRJbnN0YW5jZSkpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmNvbHVtbnNTb3J0YWJsZU1zZztcclxuICAgICAgICAgICAgfSBlbHNlIGlmICghZ3JpZEluc3RhbmNlLm11bHRpU29ydCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMubXVsdGlTb3J0TXNnO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgaGFzRW5hYmxlU29ydENvbHVtbnMoZ3JpZEluc3RhbmNlOiBEYXRhZ3JpZENvbXBvbmVudCkge1xyXG4gICAgICAgIGNvbnN0IHNvcnRDb2x1bW5zQ291bnQgPSBncmlkSW5zdGFuY2UuZmxhdENvbHVtbnMucmVkdWNlKChjLCByKSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChyLnNvcnRhYmxlKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gYyArIDE7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIGM7XHJcbiAgICAgICAgfSwgMCk7XHJcblxyXG4gICAgICAgIHJldHVybiBzb3J0Q29sdW1uc0NvdW50ID4gMDtcclxuICAgIH1cclxuXHJcblxyXG4gICAgLy8gcHJpdmF0ZSBnZXRDaGlsZHMoY29scywgcm93SW5kZXgsIGNvbFN0YXJ0SW5kZXgsIGNvbENvdW50LCBmb3JTb3J0ID0gZmFsc2UpIHtcclxuICAgIC8vICAgICBjb25zdCBjaGlsZENvbHMgPSBbXTtcclxuICAgIC8vICAgICBsZXQgX2NvdW50ID0gY29sU3RhcnRJbmRleDtcclxuICAgIC8vICAgICBpZiAoIWNvbHNbcm93SW5kZXhdKSB7XHJcbiAgICAvLyAgICAgICAgIHJldHVybiAgW107XHJcbiAgICAvLyAgICAgfVxyXG5cclxuICAgIC8vICAgICBjb2xzW3Jvd0luZGV4XS5zbGljZSgpLmZvckVhY2goZWxlbWVudCA9PiB7XHJcbiAgICAvLyAgICAgICAgIF9jb3VudCA9IF9jb3VudCArIGVsZW1lbnQuY29sc3BhbjtcclxuICAgIC8vICAgICAgICAgaWYgKCBfY291bnQgPD0gY29sQ291bnQgKSB7XHJcbiAgICAvLyAgICAgICAgICAgICBjaGlsZENvbHMucHVzaChlbGVtZW50KTtcclxuICAgIC8vICAgICAgICAgfVxyXG4gICAgLy8gICAgIH0pO1xyXG5cclxuICAgIC8vICAgICBjb2xzW3Jvd0luZGV4XS5zcGxpY2UoMCwgY2hpbGRDb2xzLmxlbmd0aCk7XHJcblxyXG4gICAgLy8gICAgIHJldHVybiBjaGlsZENvbHMubWFwKChjLCBpKSA9PiB7XHJcbiAgICAvLyAgICAgICAgIGxldCBuOiBhbnkgPSB7XHJcbiAgICAvLyAgICAgICAgICAgICBkYXRhOiBjLFxyXG4gICAgLy8gICAgICAgICAgICAgc2VsZWN0YWJsZTogZm9yU29ydCA/ICEhYy5zb3J0YWJsZSA6IHRydWVcclxuICAgIC8vICAgICAgICAgfTtcclxuXHJcbiAgICAvLyAgICAgICAgIGlmIChjLmNvbHNwYW4gJiYgYy5jb2xzcGFuID4gMSkge1xyXG4gICAgLy8gICAgICAgICAgICAgbiA9IHtcclxuICAgIC8vICAgICAgICAgICAgICAgICBkYXRhOiBjLFxyXG4gICAgLy8gICAgICAgICAgICAgICAgIHNlbGVjdGFibGU6IGZhbHNlLFxyXG4gICAgLy8gICAgICAgICAgICAgICAgIGV4cGFuZGVkOiB0cnVlLFxyXG4gICAgLy8gICAgICAgICAgICAgICAgIGNoaWxkcmVuOiB0aGlzLmdldENoaWxkcyhjb2xzLCByb3dJbmRleCArIDEsIDAgLCBjLmNvbHNwYW4pXHJcbiAgICAvLyAgICAgICAgICAgICB9O1xyXG4gICAgLy8gICAgICAgICB9XHJcbiAgICAvLyAgICAgICAgIHJldHVybiBuO1xyXG4gICAgLy8gICAgIH0pO1xyXG4gICAgLy8gfVxyXG4gICAgLy8gY29udmVydENvbHVtbnMyVHJlZURhdGEoY29sczogRGF0YUNvbHVtbltdW10sIGZvclNvcnQgPSBmYWxzZSkge1xyXG5cclxuXHJcblxyXG4gICAgLy8gICAgIGNvbnN0IGNvbHVtbnMgPSBjb2xzLm1hcCgoYzogYW55KSA9PiB7XHJcbiAgICAvLyAgICAgICAgIGNvbnN0IGFhID0gYy5tYXAoKF8pID0+IHtcclxuICAgIC8vICAgICAgICAgICAgIGlmIChfLmZpZWxkLmluZGV4T2YoJ2ZhcnJpcy1kYXRhZ3JpZC1jb2x1bW5fJykgPT0gLTEpIHtcclxuICAgIC8vICAgICAgICAgICAgICAgICBfLmNvbHNwYW4gPSBfLmNvbHNwYW4gfHwgMTtcclxuICAgIC8vICAgICAgICAgICAgICAgICByZXR1cm4gXztcclxuICAgIC8vICAgICAgICAgICAgIH1cclxuICAgIC8vICAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgLy8gICAgICAgICB9KTtcclxuICAgIC8vICAgICAgICAgcmV0dXJuIGFhLmZpbHRlcihuID0+IG4pO1xyXG4gICAgLy8gICAgIH0pO1xyXG4gICAgLy8gICAgIGlmIChjb2x1bW5zLmxlbmd0aCA9PT0gMSkge1xyXG4gICAgLy8gICAgICAgICByZXR1cm4gY29sdW1uc1swXS5tYXAoYyA9PiB7XHJcbiAgICAvLyAgICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgLy8gICAgICAgICAgICAgICAgIGRhdGE6IGMsXHJcbiAgICAvLyAgICAgICAgICAgICAgICAgc2VsZWN0YWJsZTogZm9yU29ydCA/ICEhYy5zb3J0YWJsZSA6IHRydWVcclxuICAgIC8vICAgICAgICAgICAgIH07XHJcbiAgICAvLyAgICAgICAgIH0pO1xyXG4gICAgLy8gICAgIH0gZWxzZSB7XHJcbiAgICAvLyAgICAgICAgIHJldHVybiBjb2x1bW5zWzBdLm1hcCgoYywgaSkgPT4ge1xyXG4gICAgLy8gICAgICAgICAgICAgaWYgKGMuY29sc3BhbiAmJiBjLmNvbHNwYW4gPiAxKSB7XHJcbiAgICAvLyAgICAgICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgIC8vICAgICAgICAgICAgICAgICAgICAgZGF0YTogYyxcclxuICAgIC8vICAgICAgICAgICAgICAgICAgICAgc2VsZWN0YWJsZTogZmFsc2UsXHJcbiAgICAvLyAgICAgICAgICAgICAgICAgICAgIGV4cGFuZGVkOiB0cnVlLFxyXG4gICAgLy8gICAgICAgICAgICAgICAgICAgICBjaGlsZHJlbjogdGhpcy5nZXRDaGlsZHMoY29sdW1ucywgMSwgMCwgYy5jb2xzcGFuLCBmb3JTb3J0KVxyXG4gICAgLy8gICAgICAgICAgICAgICAgIH07XHJcbiAgICAvLyAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgLy8gICAgICAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAvLyAgICAgICAgICAgICAgICAgICAgIGRhdGE6IGMsXHJcbiAgICAvLyAgICAgICAgICAgICAgICAgICAgIHNlbGVjdGFibGU6IGZvclNvcnQgPyAhIWMuc29ydGFibGUgOiB0cnVlXHJcbiAgICAvLyAgICAgICAgICAgICAgICAgfTtcclxuICAgIC8vICAgICAgICAgICAgIH1cclxuICAgIC8vICAgICAgICAgfSk7XHJcbiAgICAvLyAgICAgfVxyXG4gICAgLy8gfVxyXG5cclxuICAgIC8vIHByaXZhdGUgY2hlY2tWaWV3VHJlZU5vZGVzKHRyZWVOb2RlczogVHJlZU5vZGVbXSkge1xyXG4gICAgLy8gICAgIHRyZWVOb2Rlcy5mb3JFYWNoKCh0bjogVHJlZU5vZGUpID0+IHtcclxuICAgIC8vICAgICAgICAgaWYgKCF0bi5jaGlsZHJlbiB8fCAhdG4uY2hpbGRyZW4ubGVuZ3RoKSB7XHJcbiAgICAvLyAgICAgICAgICAgICB0bi5zZWxlY3RhYmxlID0gdHJ1ZTtcclxuICAgIC8vICAgICAgICAgfSBlbHNlIHtcclxuICAgIC8vICAgICAgICAgICAgIHRuLnNlbGVjdGFibGUgPSBmYWxzZTtcclxuICAgIC8vICAgICAgICAgICAgIHRoaXMuY2hlY2tWaWV3VHJlZU5vZGVzKHRuLmNoaWxkcmVuKTtcclxuICAgIC8vICAgICAgICAgfVxyXG4gICAgLy8gICAgIH0pO1xyXG4gICAgLy8gfVxyXG5cclxuICAgIHByaXZhdGUgX2NvbnZlcnRDb2x1bW5zVG9TaW1wbGUoZ3JpZEluc3RhbmNlOiBhbnkpIHtcclxuXHJcbiAgICAgICAgbGV0IGNvbHMgPSBncmlkSW5zdGFuY2UuY29sdW1ucztcclxuICAgICAgICAvLyDph43nva7liJfpobrluo/kuLrmnIDliJ3orr7orqHml7bnmoTpobrluo9cclxuICAgICAgICBjb25zdCBncmlkT3B0cyA9IGdyaWRJbnN0YW5jZS5kZnMuX3N0YXRlLmluaXRpYWxPcHRpb25zO1xyXG4gICAgICAgIGlmIChncmlkT3B0cy5jb2x1bW5GaWVsZHMpIHtcclxuICAgICAgICAgICAgbGV0IGRlc2dpbkNvbHMgPSBncmlkT3B0cy5jb2x1bW5GaWVsZHM7XHJcbiAgICAgICAgICAgIGNvbnN0IG5ld0NvbHVtbnMgPSBbXTtcclxuXHJcbiAgICAgICAgICAgIGRlc2dpbkNvbHMuZm9yRWFjaChjID0+IHtcclxuICAgICAgICAgICAgICAgIGlmIChjLmZpZWxkICE9PSAnX2RhdGFncmlkLXNldHRpbmctY29udHJvbF8nKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgY29sID0gZ3JpZEluc3RhbmNlLmNvbHVtbnNbMF0uZmluZCgobjogYW55KSA9PiBuLmZpZWxkID09PSBjLmZpZWxkKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoY29sKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ld0NvbHVtbnMucHVzaChjb2wpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBjb2xzID0gW25ld0NvbHVtbnNdO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIGNvbHM7XHJcbiAgICB9XHJcblxyXG4gICAgY29udmVydENvbHVtbnNUb1NpbXBsZShjb2xzOiBhbnkpIHtcclxuICAgICAgICBpZiAoIUFycmF5LmlzQXJyYXkoY29sc1swXSkpIHtcclxuICAgICAgICAgICAgY29scyA9IFtjb2xzXTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBjb2xzLm1hcCggKF9jb2xzOiBEYXRhQ29sdW1uW10pID0+IHtcclxuICAgICAgICAgICAgcmV0dXJuIF9jb2xzLm1hcCggKGM6IERhdGFDb2x1bW4pID0+IHtcclxuICAgICAgICAgICAgICAgIGlmIChjLmZpZWxkICE9PSAnX2RhdGFncmlkLXNldHRpbmctY29udHJvbF8nKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZmllbGQ6IGMuZmllbGQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlOiBjLnRpdGxlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb2xzcGFuOiBjLmNvbHNwYW4sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJvd3NwYW46IGMucm93c3BhbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgc29ydGFibGU6IGMuc29ydGFibGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG9yZGVyOiBjLm9yZGVyLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBoYWxpZ246IGMuaGFsaWduIHx8ICdsZWZ0JyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWxpZ246IGMuYWxpZ24gfHwgJ2xlZnQnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB2aXNpYmxlOiBjLnZpc2libGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFsbG93R3JvdXBpbmc6IGMuYWxsb3dHcm91cGluZyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZ3JvdXBGb290ZXI6IGMuZ3JvdXBGb290ZXIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvb3RlcjogYy5mb290ZXIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoOiBjLndpZHRoIHx8IDEwMCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YVR5cGU6IGMuZGF0YVR5cGUgfHwgJ3N0cmluZycsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZpeGVkOiBjLmZpeGVkIHx8ICdVTkZJWEVEJ1xyXG4gICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pLmZpbHRlcihuID0+IG4pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgcmVzZXRHcmlkVmlldyhncmlkSW5zdGFuY2U6IGFueSkge1xyXG4gICAgICAgIGlmICghZ3JpZEluc3RhbmNlKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgZGZzID0gZ3JpZEluc3RhbmNlLmRmcztcclxuICAgICAgICBpZiAoZGZzKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IG9wdGlvbnMgPSBkZnNbJ19zdGF0ZSddLmluaXRpYWxPcHRpb25zO1xyXG5cclxuICAgICAgICAgICAgaWYgKG9wdGlvbnMuc29ydCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKG9wdGlvbnMuc29ydC5zb3J0TmFtZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGdyaWRJbnN0YW5jZS5zb3J0TmFtZSA9IG9wdGlvbnMuc29ydC5zb3J0TmFtZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChvcHRpb25zLnNvcnQuc29ydE9yZGVyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZ3JpZEluc3RhbmNlLnNvcnRPcmRlciA9IG9wdGlvbnMuc29ydC5zb3J0T3JkZXI7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdyaWRJbnN0YW5jZS5ncm91cEZpZWxkID0gb3B0aW9ucy5ncm91cEZpZWxkIHx8ICcnO1xyXG4gICAgICAgICAgICAvLyBUT0RPOiDov5jpnIDopoHkv67mraPpu5jorqTliJfnmoTmmL7npLrpobrluo9cclxuICAgICAgICAgICAgaWYgKG9wdGlvbnMuY29sdW1uRmllbGRzICYmIG9wdGlvbnMuY29sdW1uRmllbGRzLmxlbmd0aCkge1xyXG5cclxuICAgICAgICAgICAgICAgIGNvbnN0IG5ld0NvbHVtbnMgPSBbXTtcclxuICAgICAgICAgICAgICAgIG9wdGlvbnMuY29sdW1uRmllbGRzLmZvckVhY2goYyA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgY29sID0gZ3JpZEluc3RhbmNlLmNvbHVtbnNbMF0uZmluZCgobjogYW55KSA9PiBuLmZpZWxkID09PSBjLmZpZWxkKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoY29sKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbC52aXNpYmxlID0gYy52aXNpYmxlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb2wuaGFsaWduID0gYy5oYWxpZ247XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbC5hbGlnbiA9IGMuYWxpZ247XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbC53aWR0aCA9IGMud2lkdGg7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbC5mb290ZXIgPSBjLmZvb3RlcjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29sLmdyb3VwRm9vdGVyID0gYy5ncm91cEZvb3RlcjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbmV3Q29sdW1ucy5wdXNoKGNvbCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgZ3JpZEluc3RhbmNlLmNvbHVtbnNbMF0gPSBuZXdDb2x1bW5zO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvLyBncmlkSW5zdGFuY2VbJ2NoZWNrT3B0aW9ucyddKCk7XHJcbiAgICAgICAgICAgIGdyaWRJbnN0YW5jZVsnY29sdW1uc0NoYW5nZWQnXSgpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiBcclxuXHJcbiAgICBwcml2YXRlIHVwZGF0ZUdyaWRWaWV3KG1vZGFsUmVmLCBncmlkSW5zdGFuY2UsIGJ0biA9IG51bGwsIF9zY2hlbWUgPSBudWxsKSB7XHJcbiAgICAgICAgY29uc3Qgc2V0dGluZ3MgPSBtb2RhbFJlZi5jb250ZW50O1xyXG5cclxuICAgICAgICBpZiAoc2V0dGluZ3MpIHtcclxuICAgICAgICAgICAgY29uc3QgeyBzb3J0SW5mbywgdmlld0NvbHVtbnMsIGNvbHVtbkZvcm1hdCwgZ3JvdXBGaWVsZCwgZXhwYW5kR3JvdXBSb3dzLCBtdWx0aUhlYWRlcnMgfSA9IHNldHRpbmdzO1xyXG4gICAgICAgICAgICBjb25zdCBfY29sZm9ybWF0cyA9IGNvbHVtbkZvcm1hdCA/IHRoaXMuY29udmVydENvbHVtbnNUb1NpbXBsZShjb2x1bW5Gb3JtYXQpWzBdIDogW107XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICB0aGlzLnNhdmluZyA9IHRydWU7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBsZXQgX2dyb3VwRmllbGQgPSAnJztcclxuICAgICAgICAgICAgaWYgKGdyaWRJbnN0YW5jZS5ncm91cFJvd3MgJiYgZ3JvdXBGaWVsZCAmJiBncm91cEZpZWxkLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBncm91cEZpZWxkID09PSAnc3RyaW5nJykge1xyXG4gICAgICAgICAgICAgICAgICAgIF9ncm91cEZpZWxkID0gZ3JvdXBGaWVsZDtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZihBcnJheS5pc0FycmF5KGdyb3VwRmllbGQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgX2dyb3VwRmllbGQgPSBncm91cEZpZWxkLmpvaW4oJywnKTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGxldCBfc29ydEluZm8gPSBzb3J0SW5mbztcclxuICAgICAgICAgICAgLy8g5b2T5aSa6KGo5aS06ZyA6KaB5riF55CG5o6S5bqP5a2X5q615LiO5YiG57uE5a2X5q6177yM5L+d6K+B6L+Z5Lqb5a2X5q615b+F6aG75Zyo6KGo5aS05LitXHJcbiAgICAgICAgICAgIGlmIChncmlkSW5zdGFuY2UuZW5hYmxlU2V0TXVsdGlIZWFkZXJzICYmIG11bHRpSGVhZGVycykge1xyXG4gICAgICAgICAgICAgICAgaWYgKF9ncm91cEZpZWxkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgX2dyb3VwRmllbGQgPSBjbGVhbkdyb3VwRmllbGRzKG11bHRpSGVhZGVycy52aWV3Q29scywgX2dyb3VwRmllbGQuc3BsaXQoJywnKSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKHNvcnRJbmZvICYmIHNvcnRJbmZvLnNvcnROYW1lICYmIHNvcnRJbmZvLnNvcnROYW1lLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgIF9zb3J0SW5mbyA9IGNsZWFuU29ydEZpZWxkcyhtdWx0aUhlYWRlcnMudmlld0NvbHMsIHNvcnRJbmZvKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGNvbnN0IHNhdmVEYXRhID0geyBzb3J0SW5mbzogX3NvcnRJbmZvLCB2aWV3Q29sdW1ucywgZ3JvdXBGaWVsZDogX2dyb3VwRmllbGQsIGNvbHVtbkZvcm1hdDogX2NvbGZvcm1hdHMsIGV4cGFuZEdyb3VwUm93czogZXhwYW5kR3JvdXBSb3dzLCBtdWx0aUhlYWRlcnMgfTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBjb25zdCByZWZyZXNoR3JpZCA9ICgpID0+IHtcclxuICAgICAgICAgICAgICAgIGlmIChncmlkSW5zdGFuY2UuZ3JvdXBSb3dzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZ3JpZEluc3RhbmNlLmV4cGFuZEdyb3VwUm93cyA9IGV4cGFuZEdyb3VwUm93cztcclxuICAgICAgICAgICAgICAgICAgICBncmlkSW5zdGFuY2UuZ3JvdXBGaWVsZCA9IF9ncm91cEZpZWxkO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGlmIChncmlkSW5zdGFuY2UuZW5hYmxlU2V0TXVsdGlIZWFkZXJzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8g6K6+572u6KGo5aS0XHJcbiAgICAgICAgICAgICAgICAgICAgcmVmcmVzaEdyaWRDb2x1bW5zKGdyaWRJbnN0YW5jZSwgbXVsdGlIZWFkZXJzLnZpZXdDb2xzIHx8IFtdKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHZpZXdDb2x1bW5zICYmIHZpZXdDb2x1bW5zLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBncmlkSW5zdGFuY2UuY29sdW1ucyA9IGdyaWRJbnN0YW5jZS5jb2x1bW5zLm1hcChjb2xzID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlQ29sdW1uRm9ybWF0KGNvbHMsIGNvbHVtbkZvcm1hdCwgZ3JpZEluc3RhbmNlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLm5ld1Zpc2libGVPcmRlckNvbHVtbnMoY29scywgdmlld0NvbHVtbnMsIGNvbHVtbkZvcm1hdCwgZ3JpZEluc3RhbmNlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGdyaWRJbnN0YW5jZS5jb2x1bW5zQ2hhbmdlZCh0cnVlKTtcclxuICAgICAgICAgICAgICAgIGlmIChzb3J0SW5mbyAmJiBPYmplY3Qua2V5cyhzb3J0SW5mbykubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgeyBzb3J0TmFtZSwgc29ydE9yZGVyIH0gPSBzb3J0SW5mbztcclxuICAgICAgICAgICAgICAgICAgICBpZiAoc29ydE5hbWUgJiYgc29ydE5hbWUubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGdyaWRJbnN0YW5jZS5zb3J0KHNvcnROYW1lLmpvaW4oJywnKSwgc29ydE9yZGVyLmpvaW4oJywnKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZ3JpZEluc3RhbmNlLmNsZWFyU29ydCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZ3JpZEluc3RhbmNlLmNsZWFyU29ydCgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjb25zdCBzYXZlQ3VycmVudCA9ICgpID0+IHtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0VXNlckNvbmZpZyhncmlkSW5zdGFuY2UuaWQsIHNhdmVEYXRhKS5zdWJzY3JpYmUoICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoYnRuKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJ0bi5kaXNhYmxlZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNhdmluZyA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIHJlZnJlc2hHcmlkKCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0QWN0aXZlU2NoZW1lSXRlbShncmlkSW5zdGFuY2UuaWQsIF9zY2hlbWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJldlNjaGVtZUl0ZW0gPSBfc2NoZW1lO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlQWN0aXZlU2NoZW1lSXRlbVNldHRpbmdzKGdyaWRJbnN0YW5jZS5pZCwgc2F2ZURhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0Q3VycmVudENvbmZpZ3Moc2F2ZURhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgIG1vZGFsUmVmLmNsb3NlKCk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG5cclxuXHJcbiAgICAgICAgICAgIGlmIChncmlkSW5zdGFuY2Uuc2hvd0NvbmZpcm1XaGVuU2NoZW1lQ2hhbmdlZCAmJiBncmlkSW5zdGFuY2UuZW5hYmxlU2NoZW1lKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBsYW5ndWFnZVJlcyA9IHRoaXMubG9jYWxlU2VyLmdldFZhbHVlKCdkYXRhZ3JpZC1zY2hlbWUuc2NoZW1lQ2hhbmdlZCcpXHJcbiAgICAgICAgICAgICAgICBjb25zdCBfY2hhbmdlZCA9IHRoaXMuc2NoZW1lU2VydmljZS5pc1NjaGVtZUNoYW5nZWQoc2F2ZURhdGEsIGdyaWRJbnN0YW5jZS5lbmFibGVTZXRNdWx0aUhlYWRlcnMpO1xyXG4gICAgICAgICAgICAgICAgaWYgKF9jaGFuZ2VkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbXNnRGxnID0gdGhpcy5tZXNzYWdlci5xdWVzdGlvbjIobGFuZ3VhZ2VSZXMudGl0bGUsIFtcclxuICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dDogbGFuZ3VhZ2VSZXMuY2FuY2VsLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xzOiAnYnRuIGJ0bi1saWdodCcsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoYW5kbGU6ICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNhdmluZyA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vZGFsUmVmLmNsb3NlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbXNnRGxnLmNsb3NlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZXN0b3JlU2NoZW1lKGdyaWRJbnN0YW5jZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ6IGxhbmd1YWdlUmVzLm5vLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xzOiAnYnRuIGJ0bi1zZWNvbmRhcnknLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaGFuZGxlOiAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8g5L+d5a2Y5Yiw5b2T5YmN5pa55qGIXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbXNnRGxnLmNsb3NlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2F2ZUN1cnJlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dDogbGFuZ3VhZ2VSZXMueWVzLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xzOiAnYnRuIGJ0bi1wcmltYXJ5JyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhhbmRsZTogKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIOWPpuWtmOaWsOaWueahiFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2hvd05ld1NjaGVtZURpYWxvZyhncmlkSW5zdGFuY2UsIHt0eXBlOiAnc2F2ZWFzJ30sIHNhdmVEYXRhLCB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9rOiAodCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zYXZpbmcgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vZGFsUmVmLmNsb3NlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRTY2hlbWVpdGVtID0gdDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0QWN0aXZlU2NoZW1lSXRlbShncmlkSW5zdGFuY2UuaWQsIGNsb25lRGVlcCh0KSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWZyZXNoR3JpZCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYW5jZWw6ICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2F2aW5nID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYnRuKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnRuLmRpc2FibGVkID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtc2dEbGcuY2xvc2UoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICBdKTsgIC8vICwgbGFuZ3VhZ2VSZXMudGlwcyDlrZDmoIfpophcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuY3VycmVudFNjaGVtZWl0ZW0gJiYgdGhpcy5wcmV2U2NoZW1lSXRlbSAmJiB0aGlzLmN1cnJlbnRTY2hlbWVpdGVtLmlkID09PSB0aGlzLnByZXZTY2hlbWVJdGVtLmlkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2F2aW5nID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1vZGFsUmVmLmNsb3NlKCk7ICAgICAgICBcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVmcmVzaEdyaWQoKTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzYXZlQ3VycmVudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHNhdmVDdXJyZW50KCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgXHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgbW9kYWxSZWYuY2xvc2UoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG5cclxuICAgIG5ld1Zpc2libGVPcmRlckNvbHVtbnMoY29sczogYW55LCB2aWV3Q29sdW1uczogYW55LCBjb2x1bW5Gb3JtYXQ6IGFueSwgZ3JpZEluc3RhbmNlOiBhbnkpIHtcclxuICAgICAgICBjb25zdCBoaWRlQ29sdW1ucyA9IFtdO1xyXG4gICAgICAgIGNvbHMuZm9yRWFjaCgoZWxlbWVudCwgaW5kZXgpID0+IHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuaXNOZXdBZGRDb2x1bW4oZWxlbWVudC5maWVsZCwgY29sdW1uRm9ybWF0KSAmJiBlbGVtZW50LmZpZWxkICE9PSAnX2RhdGFncmlkLXNldHRpbmctY29udHJvbF8nICYmICFncmlkSW5zdGFuY2UuZW5hYmxlU2NoZW1lKSB7XHJcbiAgICAgICAgICAgICAgICB2aWV3Q29sdW1ucy5wdXNoKGVsZW1lbnQuZmllbGQpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgZWxlbWVudC52aXNpYmxlID0gdmlld0NvbHVtbnMuaW5jbHVkZXMoZWxlbWVudC5maWVsZCk7XHJcbiAgICAgICAgICAgICAgICBpZiAoIWVsZW1lbnQudmlzaWJsZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGhpZGVDb2x1bW5zLnB1c2goZWxlbWVudCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLy8g5riF55CG5LiN5a2Y5Zyo55qE5YiXXHJcbiAgICAgICAgbGV0IG5ld0NvbHMgPSB2aWV3Q29sdW1ucy5tYXAoIGZpZWxkID0+IHtcclxuICAgICAgICAgICAgcmV0dXJuIGNvbHMuZmluZChjID0+IGMuZmllbGQgPT09IGZpZWxkKTtcclxuICAgICAgICB9KS5maWx0ZXIobiA9PiBuKTtcclxuXHJcbiAgICAgICAgaWYgKGhpZGVDb2x1bW5zLmxlbmd0aCkge1xyXG4gICAgICAgICAgICBuZXdDb2xzID0gbmV3Q29scy5jb25jYXQoaGlkZUNvbHVtbnMpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIG5ld0NvbHMuZmlsdGVyKGMgPT4gYyAmJiBjLmZpZWxkICYmIGMuZmllbGQgIT09ICdfZGF0YWdyaWQtc2V0dGluZy1jb250cm9sXycgKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOaYr+WQpuS4uuaWsOWinuWKoOeahOWtl+autVxyXG4gICAgICog5paw5aKe55qE5a2X5q6177yM6ZyA6KaB5Zyo5YiX6KGo5Lit5bGV56S65Ye65p2l77yM5bm25L+d5a2Y5Yiw5Liq5oCn5YyW6K6+572u5LitXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgaXNOZXdBZGRDb2x1bW4oZmllbGQ6IGFueSwgY29sdW1uczogYW55KSB7XHJcbiAgICAgICAgY29sdW1ucyA9IGNvbHVtbnMgfHwgW107XHJcbiAgICAgICAgcmV0dXJuICFjb2x1bW5zLmZpbmQoYyA9PiBjLmZpZWxkID09PSBmaWVsZCk7XHJcbiAgICB9XHJcblxyXG5cclxuICAgIHVwZGF0ZUNvbHVtbkZvcm1hdChjb2xzOiBhbnlbXSwgY29sdW1uRm9ybWF0OiBhbnlbXSwgZ3JpZEluc3RhbmNlKSB7XHJcbiAgICAgICAgaWYgKGNvbHVtbkZvcm1hdCAmJiBjb2x1bW5Gb3JtYXQubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIGNvbHMuZm9yRWFjaChjb2wgPT4ge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZm9ybWF0Q29sID0gY29sdW1uRm9ybWF0LmZpbmQoZj0+IGYuZmllbGQgPT09IGNvbC5maWVsZCk7XHJcbiAgICAgICAgICAgICAgICBpZiAoZm9ybWF0Q29sKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29sLndpZHRoID0gZm9ybWF0Q29sLndpZHRoO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbC5oYWxpZ24gPSBmb3JtYXRDb2wuaGFsaWduIHx8ICdsZWZ0JztcclxuICAgICAgICAgICAgICAgICAgICBjb2wuYWxpZ24gPSBmb3JtYXRDb2wuYWxpZ24gfHwgJ2xlZnQnO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbC5maXhlZCA9IGZvcm1hdENvbC5maXhlZCA9PT0gJ1VORklYRUQnPyAnJzogZm9ybWF0Q29sLmZpeGVkO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbC50aXRsZSA9IGZvcm1hdENvbC50aXRsZTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGdyaWRJbnN0YW5jZS5ncm91cFJvd3MgJiYgKGNvbC5hbGxvd0dyb3VwaW5nIHx8IGNvbC5hbGxvd0dyb3VwaW5nID09PSB1bmRlZmluZWQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghY29sLmdyb3VwRm9vdGVyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2wuZ3JvdXBGb290ZXIgPSBmb3JtYXRDb2wuZ3JvdXBGb290ZXI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjb2wuZ3JvdXBGb290ZXIgJiYgY29sLmdyb3VwRm9vdGVyLm9wdGlvbnMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghZm9ybWF0Q29sLmdyb3VwRm9vdGVyLm9wdGlvbnMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3JtYXRDb2wuZ3JvdXBGb290ZXIub3B0aW9ucyA9IHt9O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sLmdyb3VwRm9vdGVyLm9wdGlvbnMudGV4dCA9IGZvcm1hdENvbC5ncm91cEZvb3Rlci5vcHRpb25zLnRleHQgfHwgJyc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2wuZ3JvdXBGb290ZXIub3B0aW9ucy5jYWxjdWxhdGlvblR5cGUgPVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvcm1hdENvbC5ncm91cEZvb3Rlci5vcHRpb25zLmNhbGN1bGF0aW9uVHlwZSAhPT0gdW5kZWZpbmVkICYmXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9ybWF0Q29sLmdyb3VwRm9vdGVyLm9wdGlvbnMuY2FsY3VsYXRpb25UeXBlICE9PSBudWxsID9cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJzZUludChmb3JtYXRDb2wuZ3JvdXBGb290ZXIub3B0aW9ucy5jYWxjdWxhdGlvblR5cGUsIDEwKSA6IC0xO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICBpZiAoZ3JpZEluc3RhbmNlLnNob3dGb290ZXIgJiYgIWdyaWRJbnN0YW5jZS5mb290ZXJUZW1wbGF0ZSkge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFjb2wuZm9vdGVyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2wuZm9vdGVyID0gZm9ybWF0Q29sLmZvb3RlcjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNvbC5mb290ZXIgJiYgY29sLmZvb3Rlci5vcHRpb25zKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWZvcm1hdENvbC5mb290ZXIub3B0aW9ucykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvcm1hdENvbC5mb290ZXIub3B0aW9ucyA9IHt9O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sLmZvb3Rlci5vcHRpb25zLnRleHQgPSBmb3JtYXRDb2wuZm9vdGVyLm9wdGlvbnMudGV4dCB8fCAnJztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbC5mb290ZXIub3B0aW9ucy5jYWxjdWxhdGlvblR5cGUgPVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvcm1hdENvbC5mb290ZXIub3B0aW9ucy5jYWxjdWxhdGlvblR5cGUgIT09IHVuZGVmaW5lZCAmJlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvcm1hdENvbC5mb290ZXIub3B0aW9ucy5jYWxjdWxhdGlvblR5cGUgIT09IG51bGwgP1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcnNlSW50KGZvcm1hdENvbC5mb290ZXIub3B0aW9ucy5jYWxjdWxhdGlvblR5cGUsIDEwKSA6IC0xO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy8g5Yib5bu65ZSv5LiAa2V5LCDnlLF1cmkgKyBncmlkSWQg57uE5oiQ77yM5bm25re35reGXHJcbiAgICBwcml2YXRlIGNyZWF0ZUNvbmZpZ0tleShncmlkSWQ6IHN0cmluZykge1xyXG4gICAgICAgIGNvbnN0IGdyaWQgPSB0aGlzLmdldEdyaWRJbnN0YW5jZShncmlkSWQpO1xyXG4gICAgICAgIGlmIChncmlkKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBncmlkLmRncy5jcmVhdGVDb25maWdLZXkoZ3JpZElkKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLndyaXRlRGVidWdNc2coJ0RhdGFncmlkU2V0dGluZ1NlcnZpY2U6IENhbiBub3QgZmluZCB0aGUgZ3JpZCBpbnN0YW5jZS4nKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgfVxyXG5cclxuXHJcbiAgICBwcml2YXRlIGdldEN1cnJlbnRVc2VyU2V0dGluZ3MoZ3JpZElkOiBzdHJpbmcpIHtcclxuICAgICAgICBjb25zdCBncmlkSW5zdGFuY2UgPSB0aGlzLmdldEdyaWRJbnN0YW5jZShncmlkSWQpO1xyXG4gICAgICAgIGNvbnN0IGNvbmZpZyA9IHtzb3J0SW5mbzoge30sIHZpZXdDb2x1bW5zOiBbXSwgZ3JvdXBGaWVsZDogJycsIGNvbHVtbkZvcm1hdDogW119O1xyXG5cclxuICAgICAgICBpZiAoZ3JpZEluc3RhbmNlKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHsgc29ydE5hbWUsIHNvcnRPcmRlciwgY29sdW1uc30gPSBncmlkSW5zdGFuY2U7XHJcbiAgICAgICAgICAgIGlmIChzb3J0TmFtZSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3Qgc29ydEluZm8gPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc29ydE5hbWU6IHNvcnROYW1lLnNwbGl0KCcsJyksXHJcbiAgICAgICAgICAgICAgICAgICAgc29ydE9yZGVyOiBzb3J0T3JkZXIuc3BsaXQoJywnKVxyXG4gICAgICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgICAgICBjb25maWcuc29ydEluZm8gPSBzb3J0SW5mbztcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgY29uc3Qgdmlld0NvbHVtbnMgPSBjb2x1bW5zWzBdLmZpbHRlcihuID0+IG4udmlzaWJsZSB8fCBuLnZpc2libGUgPT09IHVuZGVmaW5lZCkubWFwKG4gPT4gbi5maWVsZCk7XHJcbiAgICAgICAgICAgIGNvbmZpZy52aWV3Q29sdW1ucyA9IHZpZXdDb2x1bW5zO1xyXG4gICAgICAgICAgICBjb25maWcuY29sdW1uRm9ybWF0ID0gdGhpcy5jb252ZXJ0Q29sdW1uc1RvU2ltcGxlKHRoaXMuX2NvbnZlcnRDb2x1bW5zVG9TaW1wbGUoZ3JpZEluc3RhbmNlKSlbMF07XHJcblxyXG4gICAgICAgICAgICBpZiAoZ3JpZEluc3RhbmNlLmdyb3VwUm93cykge1xyXG4gICAgICAgICAgICAgICAgY29uZmlnLmdyb3VwRmllbGQgPSBncmlkSW5zdGFuY2UuZ3JvdXBGaWVsZDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gY29uZmlnO1xyXG4gICAgfVxyXG5cclxuXHJcbiAgICBzYXZlVXNlckNvbmZpZyhncmlkSWQ6IHN0cmluZykge1xyXG4gICAgICAgIGNvbnN0IGNvbmZpZyA9IHRoaXMuZ2V0Q3VycmVudFVzZXJTZXR0aW5ncyhncmlkSWQpO1xyXG4gICAgICAgIHJldHVybiB0aGlzLnNldFVzZXJDb25maWcoZ3JpZElkLCBjb25maWcpO1xyXG4gICAgfVxyXG5cclxuICAgIHNldFVzZXJDb25maWcoZ3JpZElkOiBzdHJpbmcsIGNvbmZpZzogYW55ICk6IE9ic2VydmFibGU8YW55PiB7XHJcbiAgICAgICAgY29uc3QgZ3JpZElucyA9IHRoaXMuZ2V0R3JpZEluc3RhbmNlKGdyaWRJZCk7XHJcbiAgICAgICAgY29uc3Qga2V5ID0gdGhpcy5jcmVhdGVDb25maWdLZXkoZ3JpZElkKTtcclxuICAgICAgICBjb25zdCBMT0NBTEVJRCA9IHRoaXMubG9jYWxlU2VyLmxvY2FsZUlkO1xyXG4gICAgICAgIGNvbnN0IGN1cnJlbnRDb25maWcgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShrZXkpO1xyXG4gICAgICAgIGNvbnN0IF9jb25maWcgPSAoY3VycmVudENvbmZpZyA/IEpTT04ucGFyc2UoY3VycmVudENvbmZpZykgOiB7IH0pIHx8IHt9O1xyXG4gICAgICAgIGlmIChjb25maWcpIHtcclxuICAgICAgICAgICAgaWYgKF9jb25maWcpIHtcclxuICAgICAgICAgICAgICAgIF9jb25maWdbTE9DQUxFSURdID0gY29uZmlnO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAoZ3JpZElucyAmJiBncmlkSW5zLmVuYWJsZVNldE11bHRpSGVhZGVycykge1xyXG4gICAgICAgICAgICAgICAgX2NvbmZpZ1snaXNNdWx0aUhlYWRlciddID0gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oa2V5LCBKU09OLnN0cmluZ2lmeShfY29uZmlnKSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oa2V5KTtcclxuICAgICAgICB9XHJcblxyXG5cclxuICAgICAgICBpZiAodGhpcy5odHRwUmVzdFNlcnZpY2UpIHtcclxuICAgICAgICAgICAgaWYgKGdyaWRJbnMgJiYgZ3JpZElucy5lbmFibGVTY2hlbWUpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGFjdGl2ZVNjaGVtZSA9IHRoaXMuZ2V0QWN0aXZlU2NoZW1lSXRlbShncmlkSWQpO1xyXG4gICAgICAgICAgICAgICAgaWYgKGFjdGl2ZVNjaGVtZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlU2NoZW1lU2V0dGluZ3MoYWN0aXZlU2NoZW1lLCBjb25maWcpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChhY3RpdmVTY2hlbWUudHlwZSA9PT0gJ3ByaXZhdGUnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnNjaGVtZVNlcnZpY2Uuc2F2ZVNjaGVtZShhY3RpdmVTY2hlbWUsIGdyaWRJZCwgdHJ1ZSwgZ3JpZElucy5lbmFibGVTZXRNdWx0aUhlYWRlcnMpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnNjaGVtZVNlcnZpY2UuY2hlY2tBdXRob3JpdHkoKS5waXBlKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoTWFwKCh0OiBTY2hlbWVBdXRoTW9kZWwpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodC5zdWNjZXNzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGhhc09yZ0F1dGhvcml0eSA9IHQuYXV0aE9yZ2FuaXphdGlvbkRhdGEgJiYgdC5hdXRoT3JnYW5pemF0aW9uRGF0YS5sZW5ndGg7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhY3RpdmVTY2hlbWUudHlwZSA9PT0gJ3B1YmxpYycgfHwgKGFjdGl2ZVNjaGVtZS50eXBlID09PSAnb3JnJyAmJiBoYXNPcmdBdXRob3JpdHkpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5zY2hlbWVTZXJ2aWNlLnNhdmVTY2hlbWUoYWN0aXZlU2NoZW1lLCBncmlkSWQsIHRydWUsIGdyaWRJbnMuZW5hYmxlU2V0TXVsdGlIZWFkZXJzKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG9mKHRydWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIClcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIOWmguS4uuezu+e7n+mihOWItuaXtu+8jOaMieaXoOaWueahiOWkhOeQhlxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9zYXZlVXNlckNvbmZpZyhrZXksICBjb25maWcgPyBfY29uZmlnIDogICcnKTtcclxuICAgICAgICAgICAgICAgICAgICAvLyByZXR1cm4gb2YodHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC8vIOS/neWtmOiHs+aVsOaNruW6k1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fc2F2ZVVzZXJDb25maWcoa2V5LCAgY29uZmlnID8gX2NvbmZpZyA6ICAnJyk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gb2YodHJ1ZSk7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0VXNlckNvbmZpZyhrZXksIGlzTXVsdGlIZWFkZXIgPSBmYWxzZSk6IE9ic2VydmFibGU8YW55PiB7XHJcbiAgICAgICAgaWYgKHRoaXMuaHR0cFJlc3RTZXJ2aWNlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9nZXRVc2VyQ29uZmlnKGtleSwgaXNNdWx0aUhlYWRlcik7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIG9mKHRoaXMuZ2V0TG9jYWxTZXR0aW5ncyhrZXksIGlzTXVsdGlIZWFkZXIpKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG5cclxuICAgIGdldExvY2FsU2V0dGluZ3Moa2V5OiBzdHJpbmcsIGlzTXVsdGlIZWFkZXIgPSBmYWxzZSkge1xyXG4gICAgICAgIGNvbnN0IGNvbmZpZyA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKGtleSk7XHJcbiAgICAgICAgaWYgKGNvbmZpZykge1xyXG4gICAgICAgICAgICBjb25zdCBjb24gPSBKU09OLnBhcnNlKGNvbmZpZyk7XHJcblxyXG4gICAgICAgICAgICBpZiAoaXNNdWx0aUhlYWRlciAmJiAhY29uWydpc011bHRpSGVhZGVyJ10pIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgaWYgKGNvblsnaXNNdWx0aUhlYWRlciddKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmIChjb25bdGhpcy5sb2NhbGVTZXIubG9jYWxlSWRdKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gY29uW3RoaXMubG9jYWxlU2VyLmxvY2FsZUlkXTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGlmIChPYmplY3Qua2V5cyhjb24pLmluZGV4T2YoJ3ZpZXdDb2x1bW5zJykgPiAtMSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBjb247XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcblxyXG4gICAgcHJpdmF0ZSBnZXREZWZhdWx0U2NoZW1lKHNjaGVtZUxpc3Q6IEFycmF5PERhdGFncmlkU2NoZW1lTW9kZWw+KSB7XHJcbiAgICAgICAgLy8gMOOAgei/h+a7pOWHuuW9k+WJjeivreiogOeahOaWueahiOWIl+ihqFxyXG4gICAgICAgIC8vIDHjgIHmnInkuKrkurrpu5jorqTnmoTov5Tlm57kuKrkurrpu5jorqTmlrnmoYhcclxuICAgICAgICAvLyAy44CB5rKh5pyJ5Liq5Lq66buY6K6k5pa55qGI55qE77yM6L+U5Zue5YWs5YWx5pa55qGI56ysMeS4qlxyXG4gICAgICAgIC8vIDPjgIHmsqHmnInlhazlhbHmlrnmoYjvvIzov5Tlm57nu4Tnu4fmlrnmoYjnrKwx5LiqXHJcbiAgICAgICAgLy8gNOOAgeayoeaciee7hOe7h+aWueahiOeahCwg6L+U5Zue5Liq5Lq65pa55qGI56ysMeS4qlxyXG4gICAgICAgIC8vIDXjgIHmsqHmnInkuKrkurrmlrnmoYjnmoTvvIzov5Tlm57ns7vnu5/pooTliLbvvIzljbPooajljZXorr7orqHml7bnmoTmoLzlvI9cclxuICAgICAgICBzY2hlbWVMaXN0ID0gc2NoZW1lTGlzdC5maWx0ZXIobiA9PiB7XHJcbiAgICAgICAgICAgIHJldHVybiBKU09OLnBhcnNlKG4ubmFtZSlbdGhpcy5sb2NhbGVTZXIubG9jYWxlSWRdXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgbGV0IGRlZmF1bHRTY2hlbWUgPSBudWxsO1xyXG4gICAgICAgIGlmICghc2NoZW1lTGlzdCB8fCAhc2NoZW1lTGlzdC5sZW5ndGgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGRlZmF1bHRTY2hlbWU7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgZGVmYXVsdFNjaGVtZSA9IHNjaGVtZUxpc3QuZmluZChuID0+IG4uaXNEZWZhdWx0KTtcclxuICAgICAgICAgICAgaWYgKCFkZWZhdWx0U2NoZW1lKSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgcHVibGljU2NoZW1lcyA9IHNjaGVtZUxpc3QuZmlsdGVyKG4gPT4gbi50eXBlID09PSAncHVibGljJyk7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKCFwdWJsaWNTY2hlbWVzLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHB1YmxpY1NjaGVtZXMgPSBzY2hlbWVMaXN0LmZpbHRlcihuID0+IG4udHlwZSA9PT0gJ29yZycpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGlmIChwdWJsaWNTY2hlbWVzLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGRlZmF1bHRTY2hlbWUgPSBwdWJsaWNTY2hlbWVzWzBdO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBkZWZhdWx0U2NoZW1lID0gc2NoZW1lTGlzdFswXTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIGRlZmF1bHRTY2hlbWU7XHJcbiAgICB9XHJcblxyXG5cclxuICAgIGdldFNldHRpbmdzKGdyaWRJZDogc3RyaW5nKSB7XHJcbiAgICAgICAgY29uc3Qga2V5ID0gdGhpcy5jcmVhdGVDb25maWdLZXkoZ3JpZElkKTtcclxuICAgICAgICBjb25zdCBncmlkSW5zID0gdGhpcy5nZXRHcmlkSW5zdGFuY2UoZ3JpZElkKTtcclxuXHJcbiAgICAgICAgbGV0IHNjaGVtZUxpc3QkID0gb2YoW10pO1xyXG4gICAgICAgIGlmIChncmlkSW5zICYmIGdyaWRJbnMuZW5hYmxlU2NoZW1lKSB7XHJcbiAgICAgICAgICAgIHNjaGVtZUxpc3QkID0gdGhpcy5nZXRTY2hlbWVMaXN0KGdyaWRJZCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gZm9ya0pvaW4oc2NoZW1lTGlzdCQsIHRoaXMuZ2V0VXNlckNvbmZpZyhrZXkpLCB0aGlzLnNjaGVtZVNlcnZpY2UuZ2V0TGFuZ3VhZ2VzKCkpLnBpcGUoXHJcbiAgICAgICAgICAgIG1hcCgoW3NjaGVtZUxpc3QsIHVzZXJTZXR0aW5nLCBzdXBwb3J0ZWRMYW5ndWFnZXNdKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBzY2hlbWVMaXN0ID0gc2NoZW1lTGlzdCB8fCBbXTtcclxuICAgICAgICAgICAgICAgIHRoaXMubGFuZ3VhZ2VzID0gc3VwcG9ydGVkTGFuZ3VhZ2VzO1xyXG4gICAgICAgICAgICAgICAgaWYgKCFzY2hlbWVMaXN0Lmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB1c2VyU2V0dGluZztcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8g57yT5a2Y5pa55qGI5YiX6KGoXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRTY2hlbWVMaXN0KHNjaGVtZUxpc3QsIGdyaWRJZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8g5p+l5om+6buY6K6k5pa55qGIXHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZGVmYXVsdFNjaGVtZTogRGF0YWdyaWRTY2hlbWVNb2RlbCA9IHRoaXMuZ2V0RGVmYXVsdFNjaGVtZShzY2hlbWVMaXN0KTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIWRlZmF1bHRTY2hlbWUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHVzZXJTZXR0aW5nO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0QWN0aXZlU2NoZW1lSXRlbShncmlkSWQsIGRlZmF1bHRTY2hlbWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgdXNlclNldHRpbmdzID0gbnVsbDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRlZmF1bHRTY2hlbWUucXVlcnlDb25kaXRpb25TdHJpbmcpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJTZXR0aW5ncyA9IEpTT04ucGFyc2UoZGVmYXVsdFNjaGVtZS5xdWVyeUNvbmRpdGlvblN0cmluZyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHVzZXJTZXR0aW5ncykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbG9jYWxlSWQgPSB0aGlzLmxvY2FsZVNlci5sb2NhbGVJZDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh1c2VyU2V0dGluZ3NbbG9jYWxlSWRdKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oa2V5LCBKU09OLnN0cmluZ2lmeSh1c2VyU2V0dGluZ3MpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdXNlclNldHRpbmdzW2xvY2FsZUlkXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNlclNldHRpbmdzW2xvY2FsZUlkXSA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oa2V5LCBKU09OLnN0cmluZ2lmeSh1c2VyU2V0dGluZ3MpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICk7XHJcbiAgICB9XHJcblxyXG5cclxuICAgIHByaXZhdGUgX3NhdmVVc2VyQ29uZmlnKGtleSwgY29uZmlnKSB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgY29uc3QgdXNlckNvbmZpZ1NldHRpbmcgPSB7XHJcbiAgICAgICAgICAgICAgICBjb25maWdrZXkxOiBrZXksXHJcbiAgICAgICAgICAgICAgICBjb25maWdrZXkyOiAnJyxcclxuICAgICAgICAgICAgICAgIGNvbmZpZ2tleTM6ICcnLFxyXG4gICAgICAgICAgICAgICAgdGV4dHZhbHVlOiBjb25maWcgPyBKU09OLnN0cmluZ2lmeShjb25maWcpIDogICcnXHJcbiAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5odHRwUmVzdFNlcnZpY2Uuc2F2ZVVzZXJTZXR0aW5ncyh1c2VyQ29uZmlnU2V0dGluZyk7XHJcbiAgICAgICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICAgICAgICB0aGlzLndyaXRlRGVidWdNc2coZSwgJ2Vycm9yJyk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHJlc2V0VXNlckNvbmZpZyhncmlkSW5zdGFuY2UsIG1vZGFsUmVmKSB7XHJcbiAgICAgICAgY29uc3QgcmVzdG9yRGVmYXVsdFRleHQgPSB0aGlzLmxvY2FsZVNlci5nZXRWYWx1ZSgnZGF0YWdyaWQuc2V0dGluZ3MucmVzdG9yZURlZmF1bHRTZXR0aW5nc1RleHQnKSB8fCAn56Gu6K6k6KaB5oGi5aSN6buY6K6k6K6+572u5ZCX77yfJztcclxuICAgICAgICB0aGlzLm1lc3NhZ2VyLmNvbmZpcm0ocmVzdG9yRGVmYXVsdFRleHQpLnBpcGUoXHJcbiAgICAgICAgICAgIHN3aXRjaE1hcCggKHQ6IGJvb2xlYW4pID0+IHtcclxuICAgICAgICAgICAgICAgIGlmICh0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuc2V0VXNlckNvbmZpZyhncmlkSW5zdGFuY2UuaWQsICcnKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBvZih0KTtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICApLnN1YnNjcmliZSgodDogYm9vbGVhbikgPT4ge1xyXG4gICAgICAgICAgICBpZiAodCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5yZXNldEdyaWRWaWV3KGdyaWRJbnN0YW5jZSk7XHJcbiAgICAgICAgICAgICAgICBtb2RhbFJlZi5jbG9zZSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBfZ2V0VXNlckNvbmZpZyhrZXksIGlzTXVsdGlIZWFkZXIgPSBmYWxzZSkge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmh0dHBSZXN0U2VydmljZS5nZXRVc2VyU2V0dGluZ3Moa2V5KS5waXBlKFxyXG4gICAgICAgICAgICAgICAgbWFwKCh1Y3M6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh1Y3MgJiYgdWNzLnRleHRWYWx1ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgYyA9IEpTT04ucGFyc2UodWNzLnRleHRWYWx1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXNNdWx0aUhlYWRlciAmJiAhY1snaXNNdWx0aUhlYWRlciddKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjWydpc011bHRpSGVhZGVyJ10pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjW3RoaXMubG9jYWxlU2VyLmxvY2FsZUlkXSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKGtleSwgdWNzLnRleHRWYWx1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNbdGhpcy5sb2NhbGVTZXIubG9jYWxlSWRdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjW3RoaXMubG9jYWxlU2VyLmxvY2FsZUlkXSA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oa2V5LCBKU09OLnN0cmluZ2lmeShjKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5kZWJ1Z1Nlcikge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5kZWJ1Z1Nlci5lcnJvcihlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGJ1aWxkU3VibWl0RGF0YShncmlkSWQ6IHN0cmluZywgc2V0dGluZ3MgPSBudWxsKSB7XHJcbiAgICAgICAgY29uc3QgTE9DQUxFSUQgPSB0aGlzLmxvY2FsZVNlci5sb2NhbGVJZDtcclxuICAgICAgICBpZiAoIXNldHRpbmdzKSB7XHJcbiAgICAgICAgICAgIHNldHRpbmdzID0gdGhpcy5nZXRDdXJyZW50VXNlclNldHRpbmdzKGdyaWRJZCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IGxvY2FsZUtleSA9IHRoaXMuY3JlYXRlQ29uZmlnS2V5KGdyaWRJZCk7XHJcbiAgICAgICAgY29uc3QgY3VycmVudENvbmZpZyA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKGxvY2FsZUtleSk7XHJcbiAgICAgICAgY29uc3QgX2NvbmZpZyA9IChjdXJyZW50Q29uZmlnID8gSlNPTi5wYXJzZShjdXJyZW50Q29uZmlnKSA6IHsgfSkgfHwge307XHJcbiAgICAgICAgaWYgKF9jb25maWcpIHtcclxuICAgICAgICAgICAgX2NvbmZpZ1tMT0NBTEVJRF0gPSBzZXR0aW5ncztcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBfY29uZmlnO1xyXG4gICAgfVxyXG5cclxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gXFxcXFxyXG5cclxuICAgIHByaXZhdGUgc2hvd1NjaGVtZUxpc3REaWFsb2coZ3JpZEluc3RhbmNlOiBhbnksIHNjaGVtZUxpc3Q6IGFueSwgYXV0aEluZm86IFNjaGVtZUF1dGhNb2RlbCwgc2ltcGxlUmVmOiBhbnkpIHtcclxuICAgICAgICBjb25zdCBtb2RhbE9wdHMgPSB7XHJcbiAgICAgICAgICAgIHdpZHRoOiA3NjAsIGhlaWdodDogNTc3LCBzaG93SGVhZGVyOiBmYWxzZSwgdGl0bGU6ICfmjqfliLbpnaLmnb8nLFxyXG4gICAgICAgICAgICBpbml0aWFsU3RhdGU6IHtcclxuICAgICAgICAgICAgICAgIGl0ZW1zOiAoc2NoZW1lTGlzdCB8fCBbXSkuZmlsdGVyKG4gPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBKU09OLnBhcnNlKG4ubmFtZSlbdGhpcy5sb2NhbGVTZXIubG9jYWxlSWRdXHJcbiAgICAgICAgICAgICAgICB9KSxcclxuICAgICAgICAgICAgICAgIHJlbW92ZUl0ZW06IGF1dGhJbmZvLnN1Y2Nlc3MsXHJcbiAgICAgICAgICAgICAgICBjdXJyZW50VXNlcklkOiBhdXRoSW5mby5jdXJyZW50VXNlcklkLFxyXG4gICAgICAgICAgICAgICAgY3VycmVudFNjaGVtZUlkOiB0aGlzLmN1cnJlbnRTY2hlbWVpdGVtID8gdGhpcy5jdXJyZW50U2NoZW1laXRlbS5pZDogJydcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgc2hvd0J1dHRvbnM6IGZhbHNlXHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgY29uc3Qgc2NoZW1lTGlzdERsZyA9IHRoaXMubW9kYWxTZXIuc2hvdyhTY2hlbWVMaXN0Q29tcG9uZW50LCBtb2RhbE9wdHMpO1xyXG4gICAgICAgIC8vIHNjaGVtZUxpc3REbGcuZGlhbG9nLmxvY2F0aW9uLm5hdGl2ZUVsZW1lbnQuc3R5bGUuekluZGV4ID0gMjAzMTtcclxuXHJcbiAgICAgICAgY29uc3QgaW5zdGFuY2UgPSBzY2hlbWVMaXN0RGxnLmNvbnRlbnQgYXMgU2NoZW1lTGlzdENvbXBvbmVudDtcclxuICAgICAgICBpbnN0YW5jZS5jbG9zZU1vZGFsLnN1YnNjcmliZSggKCkgPT4ge1xyXG4gICAgICAgICAgICBzY2hlbWVMaXN0RGxnLmNsb3NlKCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGluc3RhbmNlLnN1Ym1pdE1vZGFsLnN1YnNjcmliZSgodDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuc2NoZW1lU2VydmljZS51cGRhdGVTY2hlbWUodCwgZ3JpZEluc3RhbmNlLmlkLCBncmlkSW5zdGFuY2UuZW5hYmxlU2V0TXVsdGlIZWFkZXJzKS5zdWJzY3JpYmUoKGU6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYoZSA9PT0gZmFsc2UpIHtcclxuICAgICAgICAgICAgICAgICAgICBzY2hlbWVMaXN0RGxnLmNsb3NlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29uc3QgbXNnID0gJ+WIl+iuvue9ruaWueahiOS/neWtmOaIkOWKn+OAgic7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5ub3RpZnlTZXJ2aWNlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5ub3RpZnlTZXJ2aWNlLnN1Y2Nlc3MobXNnKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5tZXNzYWdlci5zdWNjZXNzKG1zZyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgaWYodC5kZWZhdWx0SWQpIHtcclxuICAgICAgICAgICAgICAgICAgICBzY2hlbWVMaXN0LmZvckVhY2gobiA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG4uaXNEZWZhdWx0ID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChuLmlkID09PSB0LmRlZmF1bHRJZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbi5pc0RlZmF1bHQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGhpcy5zZXRBY3RpdmVTY2hlbWVJdGVtKGdyaWRJbnN0YW5jZS5pZCwgbik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBsZXQgbmV3U2NoZW1lTGlzdCA9IHNjaGVtZUxpc3Q7XHJcbiAgICAgICAgICAgICAgICBpZiAodC5kZWxldGVkSWRzICYmIHQuZGVsZXRlZElkcy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICBuZXdTY2hlbWVMaXN0ID0gc2NoZW1lTGlzdC5maWx0ZXIobiA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAhdC5kZWxldGVkSWRzLmluY2x1ZGVzKG4uaWQpXHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgdGhpcy5zY2hlbWVTZXJ2aWNlLnNldFNjaGVtZUxpc3QoZ3JpZEluc3RhbmNlLmlkLCBuZXdTY2hlbWVMaXN0KTtcclxuICAgICAgICAgICAgICAgIHNjaGVtZUxpc3REbGcuY2xvc2UoKTtcclxuXHJcbiAgICAgICAgICAgICAgICBjb25zdCBjdXJyZW50U2NoZW1lID0gdGhpcy5nZXRBY3RpdmVTY2hlbWVJdGVtKGdyaWRJbnN0YW5jZS5pZCk7XHJcbiAgICAgICAgICAgICAgICBpZiAoIWN1cnJlbnRTY2hlbWUpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNldEFjdGl2ZVNjaGVtZUl0ZW0oZ3JpZEluc3RhbmNlLmlkLCBudWxsKTtcclxuICAgICAgICAgICAgICAgICAgICBzaW1wbGVSZWYuaW5zdGFuY2UuY3VycmVudFNjaGVtZUl0ZW0gPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgICAgIHNpbXBsZVJlZi5pbnN0YW5jZS5yZXNldFRvRGVmYXVsdCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJldlNjaGVtZUl0ZW0gPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgICAgIHNpbXBsZVJlZi5pbnN0YW5jZS5vblN1Ym1pdENsaWNrKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgY29uc3QgbW9kYWxDb250YWluZXIgPSBzY2hlbWVMaXN0RGxnLmRpYWxvZy5pbnN0YW5jZSBhcyBNb2RhbENvbnRhaW5lckNvbXBvbmVudDtcclxuICAgICAgICBtb2RhbENvbnRhaW5lci5kcmFnZ2Jhci5oYW5kbGUgPSBpbnN0YW5jZS5oZWFkZXIubmF0aXZlRWxlbWVudDtcclxuICAgIH1cclxuXHJcbiAgICAvLyDmlrDlop7miJblj6blrZjmlrnmoYhcclxuICAgIHByaXZhdGUgc2hvd05ld1NjaGVtZURpYWxvZyhncmlkSW5zdGFuY2UsIGU6IHsgdHlwZTogJ25ldycgfCAnc2F2ZWFzJ30sIHNldHRpbmdzLCBjYWxsYmFjazogTmV3U2NoZW1lQ2FsbEJhY2spIHtcclxuICAgICAgICBjb25zdCBtb2RhbE9wdHMgPSB7XHJcbiAgICAgICAgICAgIHdpZHRoOiA0ODAsIGhlaWdodDogMjY5LCBzaG93SGVhZGVyOiBmYWxzZSwgdGl0bGU6ICfmjqfliLbpnaLmnb8nLFxyXG4gICAgICAgICAgICBpbml0aWFsU3RhdGU6IHtcclxuICAgICAgICAgICAgICAgIGxhbmd1YWdlczogdGhpcy5sYW5ndWFnZXNcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgc2hvd0J1dHRvbnM6IGZhbHNlLFxyXG4gICAgICAgICAgICByZXNpemFibGU6IGZhbHNlXHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgY29uc3QgbmV3U2NoZW1lRGxnID0gdGhpcy5tb2RhbFNlci5zaG93KE5ld1NjaGVtZUNvbXBvbmVudCwgbW9kYWxPcHRzKTtcclxuICAgICAgICAvLyBuZXdTY2hlbWVEbGcuZGlhbG9nLmxvY2F0aW9uLm5hdGl2ZUVsZW1lbnQuc3R5bGUuekluZGV4ID0gMjAzMTtcclxuICAgICAgICBjb25zdCBpbnN0YW5jZSA9IG5ld1NjaGVtZURsZy5jb250ZW50IGFzIE5ld1NjaGVtZUNvbXBvbmVudDtcclxuICAgICAgICBpbnN0YW5jZS5jbG9zZU1vZGFsLnN1YnNjcmliZSggKCkgPT4ge1xyXG4gICAgICAgICAgICBuZXdTY2hlbWVEbGcuY2xvc2UoKTtcclxuICAgICAgICAgICAgaWYgKGNhbGxiYWNrICYmIGNhbGxiYWNrLmNhbmNlbCkge1xyXG4gICAgICAgICAgICAgICAgY2FsbGJhY2suY2FuY2VsKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaW5zdGFuY2Uuc3VibWl0TW9kYWwucGlwZShcclxuICAgICAgICAgICAgc3dpdGNoTWFwKCh0OiBhbnkpID0+IHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmNyZWF0ZU5ld1NjaGVtZShncmlkSW5zdGFuY2UuaWQsIHQsIGUudHlwZSA9PT0gJ25ldycsIHNldHRpbmdzKTtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICApLnN1YnNjcmliZSgodDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGlmICh0LmZsYWcgPT09IGZhbHNlKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBtc2cgPSB0Lm1zZztcclxuICAgICAgICAgICAgICAgIGxldCBfbXNnID0gbXNnO1xyXG4gICAgICAgICAgICAgICAgaWYgKG1zZykge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChtc2cuaW5kZXhPZignfCcpID4gLTEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX21zZyA9IG1zZy5zcGxpdCgnfCcpLm1hcCgobGFuZ2NvZGUpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmxvY2FsZVNlci5nZXRWYWx1ZSgnZGF0YWdyaWQtc2V0dGluZ3MuJysgbGFuZ2NvZGUpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pLmpvaW4oJycpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9tc2cgPSB0aGlzLmxvY2FsZVNlci5nZXRWYWx1ZSgnZGF0YWdyaWQtc2V0dGluZ3MuJysgbXNnICk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLm5vdGlmeVNlcnZpY2UpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5ub3RpZnlTZXJ2aWNlLmluZm8oX21zZyk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5tZXNzYWdlci5pbmZvKF9tc2cpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvLyDmm7TmlrDmlrnmoYjliJfooahcclxuICAgICAgICAgICAgY29uc3Qgc2NoZW1lTGlzdCA9IHRoaXMuc2NoZW1lU2VydmljZS5nZXRTdGF0ZVZhbHVlKGdyaWRJbnN0YW5jZS5pZCwgJ2xpc3QnKSB8fCBbXTtcclxuICAgICAgICAgICAgaWYgKHQuaXNEZWZhdWx0KSB7XHJcbiAgICAgICAgICAgICAgICBzY2hlbWVMaXN0LmZvckVhY2gobiA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgbi5pc0RlZmF1bHQgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHNjaGVtZUxpc3QucHVzaCh0KTtcclxuICAgICAgICAgICAgdGhpcy5zY2hlbWVTZXJ2aWNlLnNldFNjaGVtZUxpc3QoZ3JpZEluc3RhbmNlLmlkLCBzY2hlbWVMaXN0KTtcclxuICAgICAgICAgICAgaWYgKGNhbGxiYWNrICYmIGNhbGxiYWNrLm9rKSB7XHJcbiAgICAgICAgICAgICAgICBjYWxsYmFjay5vayh0KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBuZXdTY2hlbWVEbGcuY2xvc2UoKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaW5zdGFuY2UuY2hlY2tBdXRob3JpdHkucGlwZShcclxuICAgICAgICAgICAgc3dpdGNoTWFwKCh0OiBhbnkpID0+IHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnNjaGVtZVNlcnZpY2UuY2hlY2tBdXRob3JpdHkoKS5waXBlKFxyXG4gICAgICAgICAgICAgICAgICAgIG1hcCgoYXV0aDogU2NoZW1lQXV0aE1vZGVsKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiB0LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLi4uYXV0aFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIClcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICApLnN1YnNjcmliZSgodDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGxldCBoYXNBdXRob3JpdHkgPSB7IHB1YmxpYzogdHJ1ZSwgb3JnOiB0cnVlIH07XHJcbiAgICAgICAgICAgIC8vIOaCqOayoeacieWwhuaWueahiOeahOS9v+eUqOiMg+WbtOiuvue9ruS4uuWFrOWFseeahOadg+mZkOOAglxyXG4gICAgICAgICAgICBsZXQgX21zZyA9ICdub0F1dGgucHVibGljJztcclxuICAgICAgICAgICAgaWYgKHQudHlwZS52YWx1ZSA9PT0gJ29yZycpIHtcclxuICAgICAgICAgICAgICAgIC8vIOaCqOayoeacieWwhuaWueahiOeahOS9v+eUqOiMg+WbtOiuvue9ruS4uue7hOe7h+eahOadg+mZkOOAglxyXG4gICAgICAgICAgICAgICAgX21zZyA9ICdub0F1dGgub3JnJztcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgY29uc3QgbXNnID0gdGhpcy5sb2NhbGVTZXIuZ2V0VmFsdWUoJ2RhdGFncmlkLXNldHRpbmdzLicrIF9tc2cgKTtcclxuICAgICAgICAgICAgaWYgKHQuc3VjY2Vzcykge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaGFzUHVibGljQXV0aG9yaXR5ID0gdC5hdXRoT3BlcmF0aW9uRGF0YSAmJiB0LmF1dGhPcGVyYXRpb25EYXRhLmxlbmd0aDtcclxuICAgICAgICAgICAgICAgIGhhc0F1dGhvcml0eS5wdWJsaWMgPSBoYXNQdWJsaWNBdXRob3JpdHk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBoYXNPcmdBdXRob3JpdHkgPSB0LmF1dGhPcmdhbml6YXRpb25EYXRhICYmIHQuYXV0aE9yZ2FuaXphdGlvbkRhdGEubGVuZ3RoO1xyXG4gICAgICAgICAgICAgICAgaGFzQXV0aG9yaXR5Lm9yZyA9IGhhc09yZ0F1dGhvcml0eTtcclxuICAgICAgICAgICAgICAgIGlmICh0LnR5cGUudmFsdWUgPT09ICdwdWJsaWMnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaW5zdGFuY2Uuc2NoZW1lSW5mby50eXBlID0gdC50eXBlLnZhbHVlO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0LnR5cGUudmFsdWUgPT09ICdvcmcnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFoYXNPcmdBdXRob3JpdHkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5ub3RpZnlTZXJ2aWNlLndhcm5pbmcobXNnKTtcclxuICAgICAgICAgICAgICAgICAgICB9ZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGluc3RhbmNlLnNjaGVtZUluZm8udHlwZSA9IHQudHlwZS52YWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaW5zdGFuY2Uuc2NoZW1lSW5mby5vcmdpZHMgPSB0LmF1dGhPcmdhbml6YXRpb25EYXRhLmpvaW4oJywnKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpbnN0YW5jZS5kYXRhUGVybWlzc2lvbklkcyA9IHQuYXV0aE9yZ2FuaXphdGlvbkRhdGE7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5ub3RpZnlTZXJ2aWNlLndhcm5pbmcobXNnKTtcclxuICAgICAgICAgICAgICAgIGhhc0F1dGhvcml0eSA9IHsgcHVibGljOiBmYWxzZSwgb3JnOiBmYWxzZSB9OztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpbnN0YW5jZS5yZWZyZXNoKGhhc0F1dGhvcml0eSk7XHJcbiAgICAgICAgfSlcclxuXHJcbiAgICAgICAgY29uc3QgbW9kYWxDb250YWluZXIgPSBuZXdTY2hlbWVEbGcuZGlhbG9nLmluc3RhbmNlIGFzIE1vZGFsQ29udGFpbmVyQ29tcG9uZW50O1xyXG4gICAgICAgIG1vZGFsQ29udGFpbmVyLmRyYWdnYmFyLmhhbmRsZSA9IGluc3RhbmNlLmhlYWRlci5uYXRpdmVFbGVtZW50O1xyXG4gICAgfVxyXG5cclxuICAgIGdldFNjaGVtZUxpc3QoZ3JpZElkOiBzdHJpbmcpIHtcclxuICAgICAgICBjb25zdCBncmlkSW5zID0gdGhpcy5nZXRHcmlkSW5zdGFuY2UoZ3JpZElkKTtcclxuICAgICAgICByZXR1cm4gdGhpcy5zY2hlbWVTZXJ2aWNlLmdldFNjaGVtZUxpc3QoZ3JpZElkLCBncmlkSW5zLmVuYWJsZVNldE11bHRpSGVhZGVycyk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqIOaWsOWinuaWueahiFxyXG4gICAgICogIGlzTmV3U2NoZW1l77yM5piv5ZCm5paw5Yqg5pa55qGI77yM5ZCm5YiZ5Li65Y+m5a2Y5Li6XHJcbiAgICAgKiAgY3VycmVudFNldHRpbmdz77yaIOW9k+WJjemFjee9ruS/oeaBr1xyXG4gICAgICogIGRhdGE6IOaWsOW7uuaWueahiOeql+WPo+S8oOmAkuaVsOaNrlxyXG4gICAgICovXHJcbiAgICBjcmVhdGVOZXdTY2hlbWUoZ3JpZElkOiBzdHJpbmcsIGRhdGE6IGFueSwgaXNOZXdTY2hlbWUgPSB0cnVlLCBjdXJyZW50U2V0dGluZ3M6IGFueSkge1xyXG4gICAgICAgIGlmKCFkYXRhLm5hbWUpIHtcclxuICAgICAgICAgICAgLy8gbXNnIOivt+i+k+WFpeaWueahiOWQjeensFxyXG4gICAgICAgICAgICByZXR1cm4gb2Yoe2ZsYWc6IGZhbHNlLCBtc2c6ICdyZXF1aXJlZC5zY2hlbWVOYW1lJ30pO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGhhc05hbWUgPSB0aGlzLnNjaGVtZVNlcnZpY2UuaGFzU2NoZW1lTmFtZShncmlkSWQsIGRhdGEubmFtZSk7XHJcblxyXG4gICAgICAgICAgICBpZiAodHlwZW9mIGhhc05hbWUgPT09ICdib29sZWFuJyAmJiBoYXNOYW1lKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBtc2cgJ+aWueahiOWQjeensOW3suWtmOWcqO+8jOivt+S/ruaUueOAgidcclxuICAgICAgICAgICAgICAgIHJldHVybiBvZih7ZmxhZzogZmFsc2UsIG1zZzogJ2hhcy5leGlzdCd9KTtcclxuICAgICAgICAgICAgfSBlbHNlIGlmIChBcnJheS5pc0FycmF5KGhhc05hbWUpICYmIGhhc05hbWUubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgIGNvbnN0IGdldE1lc3NhZ2VDb2RlID0gKGxhbmdDb2RlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGxhbmdDb2RlID09PSAnemgtQ0hTJykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gJ2hhcy5jaHMnOyAvLyDnroDkvZPkuK3mloflkI3np7Dlt7LlrZjlnKjjgIJcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYobGFuZ0NvZGUgPT09ICd6aC1DSFQnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAnaGFzLmNodCc7IC8vIOe5gemrlOS4reaWh+WQjeeoseW3suWtmOWcqOOAglxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAnaGFzLmVuJzsgLy8g6Iux5paH5ZCN56ew5bey5a2Y5ZyoXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGlmIChoYXNOYW1lLmluY2x1ZGVzKHRoaXMubG9jYWxlU2VyLmxvY2FsZUlkKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG1zZyA9IGdldE1lc3NhZ2VDb2RlKHRoaXMubG9jYWxlU2VyLmxvY2FsZUlkKTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gb2Yoe2ZsYWc6IGZhbHNlLCBtc2d9KTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbXNncyA9IGhhc05hbWUubWFwKG4gPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZ2V0TWVzc2FnZUNvZGUobik7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBvZih7ZmxhZzogZmFsc2UsIG1zZzogbXNncy5qb2luKCd8Jyl9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3QgcmVxdWlyZWROYW1lID0gW107XHJcblxyXG4gICAgICAgIGlmICghZGF0YS5uYW1lW3RoaXMubG9jYWxlU2VyLmxvY2FsZUlkXSkge1xyXG4gICAgICAgICAgICByZXF1aXJlZE5hbWUucHVzaCh0aGlzLmxvY2FsZVNlci5sb2NhbGVJZCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyB0aGlzLmxhbmd1YWdlcy5mb3JFYWNoKG4gPT4ge1xyXG4gICAgICAgIC8vICAgICBpZiAoZGF0YS5uYW1lW24uY29kZV0gPT09ICcnIHx8IGRhdGEubmFtZVtuLmNvZGVdID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAvLyAgICAgICAgIHJlcXVpcmVkTmFtZS5wdXNoKG4uY29kZSk7XHJcbiAgICAgICAgLy8gICAgIH1cclxuICAgICAgICAvLyB9KTtcclxuXHJcbiAgICAgICAgaWYgKHJlcXVpcmVkTmFtZS5sZW5ndGgpIHtcclxuICAgICAgICAgICAgY29uc3QgbXNncyA9IHJlcXVpcmVkTmFtZS5tYXAobiA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAobiA9PT0gJ3poLUNIUycpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gJ3JlcXVpcmVkLmNocyc7IC8vJ+ivt+i+k+WFpeeugOS9k+S4reaWh+WQjeensOOAgic7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYobiA9PT0gJ3poLUNIVCcpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gJ3JlcXVpcmVkLmNodCc7IC8vJ+ivt+i+k+WFpee5geS9k+S4reaWh+WQjeensOOAgic7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAncmVxdWlyZWQuZW4nOyAvLyAn6K+36L6T5YWl6Iux5paH5ZCN56ew44CCJztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHJldHVybiBvZih7ZmxhZzogZmFsc2UsIG1zZzogbXNncy5qb2luKCd8Jyl9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChkYXRhLnR5cGUgJiYgZGF0YS50eXBlID09PSAnb3JnJyAmJiAoIWRhdGEub3JnaWRzIHx8ICFkYXRhLm9yZ2lkcy5sZW5ndGgpKSB7XHJcbiAgICAgICAgICAgIC8vIG1zZyAn6K+36YCJ5oup57uE57uHJ1xyXG4gICAgICAgICAgICByZXR1cm4gb2Yoe2ZsYWc6IGZhbHNlLCBtc2c6ICdyZXF1aXJlZC5vcmcnfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGxldCBfY29uZmlnID0gbnVsbDtcclxuXHJcbiAgICAgICAgaWYgKCFpc05ld1NjaGVtZSkge1xyXG4gICAgICAgICAgICBjb25zdCBMT0NBTEVJRCA9IHRoaXMubG9jYWxlU2VyLmxvY2FsZUlkO1xyXG5cclxuICAgICAgICAgICAgaWYgKGN1cnJlbnRTZXR0aW5ncyAmJiBjdXJyZW50U2V0dGluZ3MuY29sdW1uRm9ybWF0KSB7XHJcbiAgICAgICAgICAgICAgICBjdXJyZW50U2V0dGluZ3MuY29sdW1uRm9ybWF0ID0gdGhpcy5jb252ZXJ0Q29sdW1uc1RvU2ltcGxlKGN1cnJlbnRTZXR0aW5ncy5jb2x1bW5Gb3JtYXQpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfY29uZmlnID17IFtMT0NBTEVJRF06IGN1cnJlbnRTZXR0aW5ncyB9O1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3QgbmV3SWQgPSB0aGlzLmlkU2VydmljZS5ndWlkKCk7XHJcbiAgICAgICAgbGV0IGlzRGVmYXVsdCA9IGRhdGEuaXNEZWZhdWx0O1xyXG4gICAgICAgIGlmIChpc0RlZmF1bHQpIHtcclxuICAgICAgICAgICAgaWYgKGRhdGEudHlwZSAhPT0gJ3ByaXZhdGUnKSB7XHJcbiAgICAgICAgICAgICAgICBpc0RlZmF1bHQgPSBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKGRhdGEubmFtZSAmJiB0eXBlb2YgZGF0YS5uYW1lID09PSAnb2JqZWN0Jykge1xyXG4gICAgICAgICAgICBkYXRhLm5hbWUgPSBKU09OLnN0cmluZ2lmeShkYXRhLm5hbWUpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3QgZ3JpZEluc3RhbmNlID0gdGhpcy5nZXRHcmlkSW5zdGFuY2UoZ3JpZElkKTtcclxuICAgICAgICBpZiAoZ3JpZEluc3RhbmNlICYmIGdyaWRJbnN0YW5jZS5lbmFibGVTZXRNdWx0aUhlYWRlcnMgJiYgX2NvbmZpZykge1xyXG4gICAgICAgICAgICBfY29uZmlnWydpc011bHRpSGVhZGVyJ10gPSBncmlkSW5zdGFuY2UuZW5hYmxlU2V0TXVsdGlIZWFkZXJzO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3Qgc2NoZW1lOiBEYXRhZ3JpZFNjaGVtZU1vZGVsID0ge1xyXG4gICAgICAgICAgICBpZDogbmV3SWQsXHJcbiAgICAgICAgICAgIGJlbG9uZ0lkOiAnJyxcclxuICAgICAgICAgICAgY29kZTogJycsXHJcbiAgICAgICAgICAgIG5hbWU6IGRhdGEubmFtZSxcclxuICAgICAgICAgICAgdHlwZTogZGF0YS50eXBlLFxyXG4gICAgICAgICAgICBpc0RlZmF1bHQ6IGlzRGVmYXVsdCxcclxuICAgICAgICAgICAgaXNTeXN0ZW06IGZhbHNlLFxyXG4gICAgICAgICAgICBleHRlbmRJZDogJ2RhdGFncmlkLXNldHRpbmdzLXNjaGVtZScsXHJcbiAgICAgICAgICAgIGV4dGVuZEluZm86IHRoaXMuYnVpbGRPcmdBbmRTY2hlbWVSZWxhdGlvbnMobmV3SWQsIGRhdGEub3JnaWRzKSxcclxuICAgICAgICAgICAgcXVlcnlDb25kaXRpb25TdHJpbmc6IF9jb25maWc/IEpTT04uc3RyaW5naWZ5KF9jb25maWcpOiAnJyxcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICByZXR1cm4gdGhpcy5zY2hlbWVTZXJ2aWNlLnNhdmVTY2hlbWUoc2NoZW1lLCBncmlkSWQsIGZhbHNlLCBncmlkSW5zdGFuY2UuZW5hYmxlU2V0TXVsdGlIZWFkZXJzKS5waXBlKFxyXG4gICAgICAgICAgICBtYXAoKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHNjaGVtZTtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICApO1xyXG4gICAgfVxyXG5cclxuICAgIHNldFNjaGVtZUxpc3Qoc2NoZW1lTGlzdDogRGF0YWdyaWRTY2hlbWVNb2RlbFtdLCBncmlkSWQ6IHN0cmluZykge1xyXG4gICAgICAgIHRoaXMuc2NoZW1lU2VydmljZS51cGRhdGUoe2xpc3Q6IHNjaGVtZUxpc3R9LCBncmlkSWQpO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgYnVpbGRPcmdBbmRTY2hlbWVSZWxhdGlvbnMoc2NoZW1lSWQ6IHN0cmluZywgb3JnSWRzOiBhbnkpIHtcclxuICAgICAgICBpZiAoIW9yZ0lkcyB8fCAhb3JnSWRzLmxlbmd0aCkge1xyXG4gICAgICAgICAgICByZXR1cm4gIFtdO1xyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICBpZiAodHlwZW9mIG9yZ0lkcyA9PT0gJ3N0cmluZycpIHtcclxuICAgICAgICAgICAgb3JnSWRzID0gb3JnSWRzLnNwbGl0KCcsJyk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gb3JnSWRzLm1hcChuID0+IHtcclxuICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgIGlkOiB0aGlzLmlkU2VydmljZS5ndWlkKCksXHJcbiAgICAgICAgICAgICAgICBvcmdJZDogbixcclxuICAgICAgICAgICAgICAgIHJlbGF0ZWRJZDogc2NoZW1lSWRcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgZ2V0Q3VycmVudFNjaGVtZVNldHRpbmdzKGdyaWRJZDogc3RyaW5nKTogU2V0dGluZ01vZGVsIHtcclxuICAgICAgICBjb25zdCBhY3RpdmVTY2hlbWUgPSB0aGlzLmdldEFjdGl2ZVNjaGVtZUl0ZW0oZ3JpZElkKSBhcyBEYXRhZ3JpZFNjaGVtZU1vZGVsO1xyXG4gICAgICAgIGlmIChhY3RpdmVTY2hlbWUgJiYgYWN0aXZlU2NoZW1lLnF1ZXJ5Q29uZGl0aW9uU3RyaW5nKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBKU09OLnBhcnNlKGFjdGl2ZVNjaGVtZS5xdWVyeUNvbmRpdGlvblN0cmluZyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfVxyXG5cclxuICAgIHNldEN1cnJlbnRDb25maWdzKHNldHRpbmdzOiBTZXR0aW5nTW9kZWwpIHtcclxuICAgICAgICB0aGlzWydDVVJSRU5UX0NPTkZJR1MnXSA9IHNldHRpbmdzO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgZ2V0Q3VycmVudENvbmZpZ3MoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXNbJ0NVUlJFTlRfQ09ORklHUyddIHx8IHt9O1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgYXBwbHlTZXR0aW5ncyhlOiBhbnksIGdyaWRJbnN0YW5jZTogYW55LCBtb2RhbD86IGFueSkge1xyXG4gICAgICAgIGUudGFyZ2V0LmRpc2FibGVkID0gdHJ1ZTtcclxuICAgICAgICBpZiAodGhpcy5zYXZpbmcpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoIXRoaXMuc2F2aW5nKSB7XHJcbiAgICAgICAgICAgIGxldCBfc2NoZW1lLCBkbGc7XHJcbiAgICAgICAgICAgIGlmIChtb2RhbCl7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB7bW9kYWxSZWYsIGN1cnJlbnRTY2hlbWV9ID0gbW9kYWw7XHJcbiAgICAgICAgICAgICAgICBkbGcgPSBtb2RhbFJlZjtcclxuICAgICAgICAgICAgICAgIF9zY2hlbWUgPSBjdXJyZW50U2NoZW1lO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgZGxnID0gZTtcclxuICAgICAgICAgICAgICAgIF9zY2hlbWUgPSBlLmN1cnJlbnRTY2hlbWU7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHRoaXMudXBkYXRlR3JpZFZpZXcoZGxnLCBncmlkSW5zdGFuY2UsIGUudGFyZ2V0LCBfc2NoZW1lKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0TXVsdGlIZWFkZXJDb2x1bW5zKHZpZXdDb2xzLCBncmlkSW5pdE9wdGlvbnMpIHtcclxuICAgICAgICByZXR1cm4gbWVyZ2V0Q29sdW1uT3B0aW9ucyh2aWV3Q29scywgZ3JpZEluaXRPcHRpb25zKVxyXG4gICAgfVxyXG59XHJcbiJdfQ==