/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
import { LocaleService } from '@farris/ui-locale';
import { Component, Input, Injector, ViewChild, Output, EventEmitter, ChangeDetectorRef, ViewEncapsulation } from '@angular/core';
import { NgForm } from '@angular/forms';
import { DatagridSettingsComponent } from '../datagrid-settings.component';
import { ColumnTreeComponent } from '../multi-headers/column-tree.component';
var ColumnFormatSettingComponent = /** @class */ (function () {
    function ColumnFormatSettingComponent(injector, gridSettingComponentRef, cd) {
        this.injector = injector;
        this.gridSettingComponentRef = gridSettingComponentRef;
        this.cd = cd;
        this.columns = [];
        this.fields = [];
        this.formatChange = new EventEmitter();
        this.fieldsChange = new EventEmitter();
        this.allCols = [];
        /**
         * format Data
         */
        this.formatData = [];
        this.columnType = 'all';
        this.activeField = null;
        this.showGridFooter = false;
        this.searchItems = [];
        this.alignItems = [];
        this.summaryItems = [];
        this.summaryItems2 = [];
        this.fixedItems = [];
        this.isEn = false;
        this.switchValue = false;
        this._searchResult = { checkAll: false, unCheckAll: false };
        /**
         * 配置多表头相关设置
         */
        this.multiHeaderOptions = {};
        // 启用多表头
        this.enableMultipleHeaders = false;
        this.selectTreeNode = null;
        this.showGridFooter = this.gridSettingComponentRef.gridInstance.showFooter &&
            !this.gridSettingComponentRef.gridInstance.footerTemplate;
        this.localeSer = this.injector.get(LocaleService, null);
    }
    Object.defineProperty(ColumnFormatSettingComponent.prototype, "isShowfixed", {
        get: /**
         * @return {?}
         */
        function () {
            if (this.groupHeadersRef && this.selectTreeNode && this.selectTreeNode.id !== '__HOU_XUAN_LIE_ID__') { // 多表头
                // 多表头
                /** @type {?} */
                var rn = this.groupHeadersRef.tt.findRowNode(this.selectTreeNode.id);
                return rn && !rn.level;
            }
            else {
                return true;
            }
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @param {?} changes
     * @return {?}
     */
    ColumnFormatSettingComponent.prototype.ngOnChanges = /**
     * @param {?} changes
     * @return {?}
     */
    function (changes) {
        if (changes.columns && !changes.columns.isFirstChange()) {
            this.setFormatData();
            this.allCols = this.columns[0];
            this.setActiveField();
            this.checkColumnOptions();
            this._searchResult = this.seachResultIsCheckAll();
        }
        if (changes.multiHeaderOptions && !changes.multiHeaderOptions.isFirstChange()) {
            this.setActiveField();
        }
    };
    /**
     * @return {?}
     */
    ColumnFormatSettingComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        this.isEn = this.localeSer.localeId === 'en';
        this.initData();
    };
    /**
     * @return {?}
     */
    ColumnFormatSettingComponent.prototype.ngAfterViewInit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this.setActiveField();
        setTimeout((/**
         * @return {?}
         */
        function () {
            if (_this.colForm) {
                _this.colForm.valueChanges.subscribe((/**
                 * @param {?} v
                 * @return {?}
                 */
                function (v) {
                    _this.formatChange.emit(_this.formatData);
                }));
            }
        }), 50);
    };
    /**
     * @private
     * @return {?}
     */
    ColumnFormatSettingComponent.prototype.setActiveField = /**
     * @private
     * @return {?}
     */
    function () {
        var _this = this;
        setTimeout((/**
         * @return {?}
         */
        function () {
            if (_this.enableMultipleHeaders && _this.multiHeaderOptions) {
                var columns = _this.multiHeaderOptions.columns;
                if (columns && columns.length) {
                    _this.groupHeadersRef.tt.selectFirstNode();
                }
                else {
                    _this.activeField = null;
                }
            }
            else {
                _this.activeField = _this.columns[0][0];
            }
        }));
    };
    /**
     * @private
     * @return {?}
     */
    ColumnFormatSettingComponent.prototype.setFormatData = /**
     * @private
     * @return {?}
     */
    function () {
        // this.formatData = this.fields.map(n => {
        //     return this.columns[0].find(col => col.field === n);
        // });
        this.formatData = this.columns[0];
    };
    /**
     * @private
     * @return {?}
     */
    ColumnFormatSettingComponent.prototype.initData = /**
     * @private
     * @return {?}
     */
    function () {
        this.alignItems = this.gridSettingComponentRef.alignItems;
        this.searchItems = this.gridSettingComponentRef.searchItems;
        this.summaryItems = this.gridSettingComponentRef.summaryItems;
        this.summaryItems2 = this.gridSettingComponentRef.summaryItems2;
        this.fixedItems = this.gridSettingComponentRef.fixedItems;
        this.setFormatData();
        this.allCols = this.columns[0];
        this.checkColumnOptions();
        this.filterColumns();
    };
    /**
     * @private
     * @return {?}
     */
    ColumnFormatSettingComponent.prototype.checkColumnOptions = /**
     * @private
     * @return {?}
     */
    function () {
        if (this.activeField) {
            if (this.activeField.allowGrouping === undefined) {
                this.activeField.allowGrouping = true;
            }
            if (this.activeField.groupFooter === undefined) {
                this.activeField.groupFooter = { options: { calculationType: -1 } };
            }
            else {
                this.activeField.groupFooter.options = this.activeField.groupFooter.options || { calculationType: -1 };
                if (this.activeField.groupFooter.options.calculationType === undefined) {
                    this.activeField.groupFooter.options.calculationType = -1;
                }
            }
            if (this.activeField.footer === undefined) {
                this.activeField.footer = { options: { calculationType: -1 } };
            }
            else {
                this.activeField.footer.options = this.activeField.footer.options || { calculationType: -1 };
                if (this.activeField.footer.options.calculationType === undefined) {
                    this.activeField.footer.options.calculationType = -1;
                }
            }
            if (!this.activeField.fixed || (this.activeField.fixed !== 'left' && this.activeField.fixed !== 'right')) {
                this.activeField.fixed = 'UNFIXED';
            }
        }
    };
    // 根据列的类型进行筛选过滤，
    // all 所有列
    // visible 可见列
    // hidden 隐藏列
    // group 分组列
    // 根据列的类型进行筛选过滤，
    // all 所有列
    // visible 可见列
    // hidden 隐藏列
    // group 分组列
    /**
     * @param {?=} searchWords
     * @return {?}
     */
    ColumnFormatSettingComponent.prototype.filterColumns = 
    // 根据列的类型进行筛选过滤，
    // all 所有列
    // visible 可见列
    // hidden 隐藏列
    // group 分组列
    /**
     * @param {?=} searchWords
     * @return {?}
     */
    function (searchWords) {
        var _this = this;
        if (searchWords === void 0) { searchWords = ''; }
        /** @type {?} */
        var cols = [];
        if (this.switchValue) {
            cols = this.columns[0].filter((/**
             * @param {?} n
             * @return {?}
             */
            function (n) { return _this.fields.indexOf(n.field) > -1; }));
        }
        else {
            cols = this.columns[0];
        }
        if (searchWords) {
            cols = cols.filter((/**
             * @param {?} c
             * @return {?}
             */
            function (c) { return c.title.toLowerCase().indexOf(searchWords) > -1; }));
        }
        this.allCols = cols;
        this._searchResult = this.seachResultIsCheckAll(this.allCols.filter((/**
         * @param {?} n
         * @return {?}
         */
        function (n) { return n.visible; })));
    };
    /**
     * @private
     * @param {?=} searchFields
     * @return {?}
     */
    ColumnFormatSettingComponent.prototype.seachResultIsCheckAll = /**
     * @private
     * @param {?=} searchFields
     * @return {?}
     */
    function (searchFields) {
        /** @type {?} */
        var allColsLength = this.allCols.filter((/**
         * @param {?} n
         * @return {?}
         */
        function (n) { return n.field != '_datagrid-setting-control_'; })).length;
        /** @type {?} */
        var fieldsLength = this.fields.filter((/**
         * @param {?} n
         * @return {?}
         */
        function (n) { return n != '_datagrid-setting-control_'; })).length;
        if (searchFields) {
            fieldsLength = searchFields.length;
        }
        return {
            checkAll: allColsLength && allColsLength === fieldsLength,
            unCheckAll: !searchFields ? !this.fields.length : !fieldsLength
        };
    };
    /**
     * @param {?} col
     * @param {?} $event
     * @return {?}
     */
    ColumnFormatSettingComponent.prototype.onFieldClick = /**
     * @param {?} col
     * @param {?} $event
     * @return {?}
     */
    function (col, $event) {
        this.activeField = col;
        this.checkColumnOptions();
    };
    /**
     * @private
     * @return {?}
     */
    ColumnFormatSettingComponent.prototype.onFieldsChanged = /**
     * @private
     * @return {?}
     */
    function () {
        this.setFormatData();
        this.fieldsChange.emit(this.fields);
    };
    /**
     * @param {?} $event
     * @param {?} col
     * @return {?}
     */
    ColumnFormatSettingComponent.prototype.onDblClick = /**
     * @param {?} $event
     * @param {?} col
     * @return {?}
     */
    function ($event, col) {
        $event.target.style.userSelect = 'none';
        this.onCheckboxClick($event, col);
        $event.target.style.userSelect = '';
    };
    /**
     * @param {?} $event
     * @param {?} col
     * @return {?}
     */
    ColumnFormatSettingComponent.prototype.onCheckboxClick = /**
     * @param {?} $event
     * @param {?} col
     * @return {?}
     */
    function ($event, col) {
        var _this = this;
        $event.stopPropagation();
        /** @type {?} */
        var index = this.fields.indexOf(col.field);
        if (index === -1) {
            this.fields.push(col.field);
        }
        else {
            this.fields.splice(index, 1);
        }
        this.columns[0].forEach((/**
         * @param {?} f
         * @return {?}
         */
        function (f) {
            f.visible = _this.fields.indexOf(f.field) > -1;
        }));
        this.fields = this.columns[0].filter((/**
         * @param {?} n
         * @return {?}
         */
        function (n) { return n.visible; })).map((/**
         * @param {?} n
         * @return {?}
         */
        function (n) { return n.field; }));
        /** @type {?} */
        var _fields = this.allCols.filter((/**
         * @param {?} n
         * @return {?}
         */
        function (n) { return n.visible; })).map((/**
         * @param {?} n
         * @return {?}
         */
        function (n) { return n.field; }));
        this._searchResult = this.seachResultIsCheckAll(_fields);
        this.onFieldsChanged();
    };
    /**
     * @param {?} $event
     * @return {?}
     */
    ColumnFormatSettingComponent.prototype.searchColumn = /**
     * @param {?} $event
     * @return {?}
     */
    function ($event) {
        this.switchValue = false;
        /** @type {?} */
        var txt = $event.target.value;
        this.filterColumns(txt);
    };
    /**
     * @param {?} fieldInfo
     * @param {?} txt
     * @param {?} ulElRef
     * @return {?}
     */
    ColumnFormatSettingComponent.prototype.onFieldDrop = /**
     * @param {?} fieldInfo
     * @param {?} txt
     * @param {?} ulElRef
     * @return {?}
     */
    function (fieldInfo, txt, ulElRef) {
        var _a;
        var removedIndex = fieldInfo.removedIndex, addedIndex = fieldInfo.addedIndex;
        /** @type {?} */
        var moveItem = this.allCols[removedIndex];
        /** @type {?} */
        var targetItem = this.allCols[addedIndex];
        /** @type {?} */
        var moveItemIndex = this.columns[0].findIndex((/**
         * @param {?} n
         * @return {?}
         */
        function (n) { return n.field === moveItem.field; }));
        /** @type {?} */
        var targetItemIndex = this.columns[0].findIndex((/**
         * @param {?} n
         * @return {?}
         */
        function (n) { return n.field === targetItem.field; }));
        /** @type {?} */
        var removedItem = this.columns[0].splice(moveItemIndex, 1);
        (_a = this.columns[0]).splice.apply(_a, tslib_1.__spread([targetItemIndex, 0], removedItem));
        this.fields = this.columns[0].filter((/**
         * @param {?} n
         * @return {?}
         */
        function (n) { return n.visible; })).map((/**
         * @param {?} n
         * @return {?}
         */
        function (n) { return n.field; }));
        this.onFieldsChanged();
        this.filterColumns(txt);
    };
    /**
     * 0: 1个也没有选中； 1: 全部选中； 2: 有选中的也有没选中的
     */
    /**
     * 0: 1个也没有选中； 1: 全部选中； 2: 有选中的也有没选中的
     * @private
     * @param {?=} search
     * @return {?}
     */
    ColumnFormatSettingComponent.prototype.getCheckAllState = /**
     * 0: 1个也没有选中； 1: 全部选中； 2: 有选中的也有没选中的
     * @private
     * @param {?=} search
     * @return {?}
     */
    function (search) {
        if (search === void 0) { search = false; }
        if (this.fields.length === 0) {
            return 0;
        }
        else {
            if (search) {
                if (this._searchResult.checkAll) {
                    return 1;
                }
            }
            else {
                if (this.fields.length === this.columns[0].length) {
                    return 1;
                }
            }
            return 2;
        }
    };
    /**
     * @param {?} $event
     * @param {?} txt
     * @return {?}
     */
    ColumnFormatSettingComponent.prototype.onCheckAllClick = /**
     * @param {?} $event
     * @param {?} txt
     * @return {?}
     */
    function ($event, txt) {
        var _this = this;
        if (!this.allCols || !this.allCols.length) {
            return;
        }
        /** @type {?} */
        var state = this.getCheckAllState(txt);
        /** @type {?} */
        var isVisible = state === 0 || state === 2;
        /** @type {?} */
        var _fields = null;
        if (txt == '') {
            if (isVisible) {
                // 执行全选
                this.columns[0].forEach((/**
                 * @param {?} n
                 * @return {?}
                 */
                function (n) { return n.visible = true; }));
                this.fields = this.columns[0].map((/**
                 * @param {?} n
                 * @return {?}
                 */
                function (n) { return n.field; }));
            }
            else {
                // 取消全选
                this.columns[0].forEach((/**
                 * @param {?} n
                 * @return {?}
                 */
                function (n) { return n.visible = false; }));
                this.fields = [];
            }
        }
        else {
            this.allCols.forEach((/**
             * @param {?} c
             * @return {?}
             */
            function (c) {
                /** @type {?} */
                var col = _this.columns[0].find((/**
                 * @param {?} n
                 * @return {?}
                 */
                function (n) { return c.field === n.field; }));
                col.visible = isVisible;
                c.visible = isVisible;
            }));
            _fields = this.allCols.filter((/**
             * @param {?} n
             * @return {?}
             */
            function (n) { return n.visible; })).map((/**
             * @param {?} n
             * @return {?}
             */
            function (n) { return n.field; }));
            this.fields = this.columns[0].filter((/**
             * @param {?} n
             * @return {?}
             */
            function (n) { return n.visible; })).map((/**
             * @param {?} n
             * @return {?}
             */
            function (n) { return n.field; }));
        }
        this._searchResult = this.seachResultIsCheckAll(!txt ? null : _fields);
        this.cd.detectChanges();
        this.onFieldsChanged();
        // this.filterColumns(txt);
    };
    // 仅显示可见列
    // 仅显示可见列
    /**
     * @param {?} $event
     * @param {?} txt
     * @return {?}
     */
    ColumnFormatSettingComponent.prototype.onlySeeVisibleColumns = 
    // 仅显示可见列
    /**
     * @param {?} $event
     * @param {?} txt
     * @return {?}
     */
    function ($event, txt) {
        this.switchValue = $event;
        this.filterColumns(txt);
    };
    /**
     * @param {?} $event
     * @param {?} searchInput
     * @return {?}
     */
    ColumnFormatSettingComponent.prototype.clearSearch = /**
     * @param {?} $event
     * @param {?} searchInput
     * @return {?}
     */
    function ($event, searchInput) {
        if (searchInput && searchInput.value) {
            this.filterColumns('');
            searchInput.value = '';
        }
    };
    /**
     * @param {?} $event
     * @return {?}
     */
    ColumnFormatSettingComponent.prototype.onNodeSelected = /**
     * @param {?} $event
     * @return {?}
     */
    function ($event) {
        if ($event && $event.node.id !== "__HOU_XUAN_LIE_ID__") {
            this.activeField = $event.node.data;
            this.selectTreeNode = $event.node;
            this.checkColumnOptions();
        }
        else {
            this.activeField = null;
            this.selectTreeNode = null;
        }
    };
    /**
     * @return {?}
     */
    ColumnFormatSettingComponent.prototype.getMultiHeaders = /**
     * @return {?}
     */
    function () {
        return this.groupHeadersRef ? this.groupHeadersRef.getSettings() : null;
    };
    ColumnFormatSettingComponent.decorators = [
        { type: Component, args: [{
                    selector: 'column-format-setting',
                    template: "<div class=\"d-flex flex-row flex-fill dg-column-format-setting\" style=\"height: 100%\">\r\n    <div region=\"west\" class=\"west d-flex flex-column \" *ngIf=\"!enableMultipleHeaders\">\r\n        <div style=\"margin: 0 6px;\">\r\n\r\n            <div class=\"input-group mb-2 scheme-manager__search-box\">\r\n                <input #inputWord type=\"text\" class=\"form-control\" placeholder=\"{{'datagrid.settings.searchPlaceholder' | locale}}\" (input)=\"searchColumn($event)\" style=\"height: 30px;\">\r\n                <div  class=\"input-group-append\" style=\"cursor: pointer\">\r\n                    <span  class=\"f-icon f-icon-search\" [class.f-icon-close]=\"inputWord.value\" (click)=\"clearSearch($event, inputWord)\"></span>\r\n                </div>\r\n            </div>\r\n            <div style=\"padding: 5px 0px;background-color: #fff;justify-content: space-between;align-items: center;\" class=\"d-flex flex-row\">\r\n                <button class=\"btn btn-link\" style=\"height: 32px;padding-left: 4px;\" [disabled]=\"!(allCols && allCols.length)\" (click)=\"onCheckAllClick($event, inputWord.value)\">\r\n                    <span class=\"f-icon f-icon-minus-outline checkbox\" \r\n                    [class.f-icon-checkbox]=\"_searchResult.unCheckAll\" \r\n                    [class.f-icon-checkbox-checked]=\"_searchResult.checkAll \"></span>\r\n                    {{ 'datagrid.settings.checkall' | locale }}\r\n                </button>\r\n\r\n                <div [class.d-flex]=\"!inputWord.value\"  class=\"flex-row\" [style.display]=\"inputWord.value ? 'none': ''\" >{{'datagrid-scheme.onlyshowcolumns' | locale}} \r\n                    <farris-switch style=\"position: relative;\r\n                    top: 2px;\r\n                    margin-left: 5px;\"\r\n                    id=\"only-visible-columns\"\r\n                    [square]=\"false\" [size]=\"'small'\"\r\n                    [ngModel]=\"switchValue\" \r\n                    (valueChange)=\"onlySeeVisibleColumns($event, inputWord.value)\"\r\n                    ></farris-switch>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <div style=\"overflow: auto;padding-right:3px; cursor: pointer;\" class=\"flex-fill\">\r\n            <ul class=\"list-group  list-group-flush\" #ul column-visible-drag (drop)=\"onFieldDrop($event, inputWord.value, ul)\">\r\n                <li class=\"list-group-item list-group-item-action smooth-dnd-draggable-wrapper format-setting-column\" *ngFor=\"let col of allCols\" \r\n                    (click)=\"onFieldClick(col, $event)\" [class.active]=\"activeField && activeField.field === col.field\"\r\n                    f-dbl-click (dblClickHandler)=\"onDblClick($event, col)\">\r\n                    <span class=\"f-icon checkbox\"\r\n                        [class.f-icon-checkbox-checked]=\"fields.indexOf(col.field) > -1\"\r\n                        [class.f-icon-checkbox]=\"fields.indexOf(col.field) == -1\"\r\n                        (click)=\"onCheckboxClick($event, col)\"></span>\r\n                    {{ col.title}} \r\n\r\n                    <span class=\"f-icon f-icon-drag-vertical field-drag-handle\" *ngIf=\"!inputWord.value\"></span>\r\n                </li>\r\n            </ul>\r\n        </div>\r\n    </div>\r\n\r\n    <div region=\"west\" class=\"west d-flex flex-column \" *ngIf=\"enableMultipleHeaders\">\r\n        <div style=\"margin: 0 6px;\" class=\"mb-2\">\r\n            <div class=\"d-flex flex-row mb-2\" style=\"align-items: center; height: 24px;\">\r\n                <h5 class=\"count m-0\" style=\"font-size: 18px;\"> {{ 'headerGroup.title' | locale }}</h5>\r\n                <div class=\"d-flex flex-row \" style=\"align-items: center;justify-content: end;\" [class.f-utils-fill]=\"enableMultipleHeaders\">\r\n                    <button class=\"btn btn-link\" style=\"height: 32px;padding-left: 4px;\" [preview-headers]=\"gh\" *ngIf=\"enableMultipleHeaders\"> {{ 'headerGroup.preview' | locale }}</button>\r\n                </div>\r\n            </div>\r\n\r\n            <div class=\"tip p-2\" style=\"background: #f7faff; border-radius: 4px;\" >\r\n                {{ 'headerGroup.tips' | locale }}\r\n            </div>\r\n        </div>\r\n        <div style=\"overflow: auto;padding-right:3px; cursor: pointer;\" class=\"flex-fill\">\r\n            <column-tree #gh=\"groupHeaderTree\" [dg]=\"gridSettingComponentRef?.gridInstance\" [options]=\"multiHeaderOptions\"\r\n             class=\"flex-fill d-flex pt-2\" [inModal]=\"true\" (nodeSelected)=\"onNodeSelected($event)\"></column-tree>\r\n        </div>\r\n    </div>\r\n\r\n    <div region=\"center\" class=\"center flex-fill\" style=\"overflow:auto;padding: 0 10px; padding-left: 20px;border-right: 0;\">\r\n\r\n        <h6 style=\"margin: 15px 0px;font-weight: bold;\">{{ 'datagrid.settings.properties' | locale }}</h6>\r\n\r\n        <form #colformatform=\"ngForm\" style=\"margin-top: 5px;\" *ngIf=\"activeField\">\r\n            <!-- \u5217\u6807\u9898 -->\r\n            <div class=\"farris-group-wrap mb-3\">\r\n                <div class=\"form-group farris-form-group\">\r\n                    <label for=\"hpinput01\" class=\"col-form-label\">\r\n                        <span class=\"farris-label-text\" >{{ 'datagrid-settings.column.title' | locale }}</span>\r\n                    </label>\r\n                    <div class=\"farris-input-wrap\">\r\n                        <input class=\"form-control\" name=\"title\" [(ngModel)]=\"activeField.title\" type=\"text\">\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <!-- \u8868\u5934\u5BF9\u9F50 -->\r\n            <div class=\"farris-group-wrap mb-3\">\r\n                <div class=\"form-group farris-form-group\">\r\n                    <label for=\"hpinput01\" class=\"col-form-label\">\r\n                        <span class=\"farris-label-text\" >{{ 'datagrid.settings.headeralign' | locale }}</span>\r\n                    </label>\r\n                    <div class=\"farris-input-wrap\">\r\n                        <farris-combo-list name=\"halign\" \r\n                        [data]=\"alignItems\" \r\n                        [editable]=\"false\"\r\n                        [(ngModel)]=\"activeField.halign\"\r\n                        [idField]=\"'value'\"\r\n                        [textField]=\"'title'\"\r\n                        [enableClear]=\"false\"></farris-combo-list>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <!-- \u6570\u636E\u5BF9\u9F50 -->\r\n            <div class=\"farris-group-wrap  mb-3\" *ngIf=\"activeField && !activeField.groupHeader\">\r\n                <div class=\"form-group farris-form-group\">\r\n                    <label for=\"hpinput01\" class=\"col-form-label\">\r\n                        <span class=\"farris-label-text\">{{ 'datagrid.settings.dataalign' | locale }}</span>\r\n                    </label>\r\n                    <div class=\"farris-input-wrap\">\r\n                        <farris-combo-list name=\"align\" \r\n                        [data]=\"alignItems\" \r\n                        [editable]=\"false\"\r\n                        [(ngModel)]=\"activeField.align\"\r\n                        [idField]=\"'value'\"\r\n                        [textField]=\"'title'\"\r\n                        [enableClear]=\"false\"></farris-combo-list>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <!-- \u662F\u5426\u56FA\u5B9A -->\r\n            <div class=\"farris-group-wrap  mb-3\" *ngIf=\"isShowfixed\">\r\n                <div class=\"form-group farris-form-group\">\r\n                    <label for=\"hpinput01\" class=\"col-form-label\">\r\n                        <span class=\"farris-label-text\">{{ 'datagrid-settings.column.fixed' | locale }}</span>\r\n                    </label>\r\n                    <div class=\"farris-input-wrap\">\r\n                        <farris-combo-list name=\"fixed\" \r\n                        [data]=\"fixedItems\" \r\n                        [editable]=\"false\"\r\n                        [(ngModel)]=\"activeField.fixed\"\r\n                        [idField]=\"'value'\"\r\n                        [textField]=\"'title'\"\r\n                        [enableClear]=\"false\"></farris-combo-list>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <!-- \u5408\u8BA1 -->\r\n            <div class=\"farris-group-wrap  mb-3\" *ngIf=\"showGridFooter && activeField && !activeField.groupHeader\" >\r\n                <div class=\"form-group farris-form-group\">\r\n                    <label for=\"hpinput01\" class=\"col-form-label\">\r\n                        <span class=\"farris-label-text\">{{ 'datagrid.settings.summarytype' | locale }}</span>\r\n                    </label>\r\n                    <div class=\"farris-input-wrap \">\r\n                       \r\n                        <farris-combo-list name=\"footer.options.calculationType\" \r\n                        [data]=\" activeField.dataType === 'number'?  summaryItems : summaryItems2 \" \r\n                        [editable]=\"false\"\r\n                        [(ngModel)]=\"activeField.footer.options.calculationType\"\r\n                        [idField]=\"'value'\"\r\n                        [textField]=\"'title'\"\r\n                        [enableClear]=\"false\"></farris-combo-list>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <div class=\"farris-group-wrap  mb-3\" *ngIf=\"activeField && !activeField.groupHeader && showGridFooter && ( \r\n                (!activeField.footer.options.calculationType && activeField.footer.options.calculationType != 0)  ||activeField.footer.options.calculationType == -1)\">\r\n                <div class=\"form-group farris-form-group\">\r\n                    <label for=\"hpinput01\" class=\"col-form-label\">\r\n                        <span class=\"farris-label-text\">{{ 'datagrid.settings.summarytext' | locale }}</span>\r\n                    </label>\r\n                    <div class=\"farris-input-wrap\">\r\n                        <input type=\"input\" name=\"footer.options.text\" class=\"form-control\" [(ngModel)]=\"activeField.footer.options.text\">\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </form>\r\n    </div>\r\n   \r\n</div>",
                    encapsulation: ViewEncapsulation.None
                }] }
    ];
    /** @nocollapse */
    ColumnFormatSettingComponent.ctorParameters = function () { return [
        { type: Injector },
        { type: DatagridSettingsComponent },
        { type: ChangeDetectorRef }
    ]; };
    ColumnFormatSettingComponent.propDecorators = {
        columns: [{ type: Input }],
        fields: [{ type: Input }],
        colForm: [{ type: ViewChild, args: ['colformatform',] }],
        groupHeadersRef: [{ type: ViewChild, args: ['gh',] }],
        formatChange: [{ type: Output }],
        fieldsChange: [{ type: Output }],
        multiHeaderOptions: [{ type: Input }],
        enableMultipleHeaders: [{ type: Input }]
    };
    return ColumnFormatSettingComponent;
}());
export { ColumnFormatSettingComponent };
if (false) {
    /** @type {?} */
    ColumnFormatSettingComponent.prototype.columns;
    /** @type {?} */
    ColumnFormatSettingComponent.prototype.fields;
    /** @type {?} */
    ColumnFormatSettingComponent.prototype.colForm;
    /** @type {?} */
    ColumnFormatSettingComponent.prototype.groupHeadersRef;
    /** @type {?} */
    ColumnFormatSettingComponent.prototype.formatChange;
    /** @type {?} */
    ColumnFormatSettingComponent.prototype.fieldsChange;
    /** @type {?} */
    ColumnFormatSettingComponent.prototype.allCols;
    /**
     * format Data
     * @type {?}
     */
    ColumnFormatSettingComponent.prototype.formatData;
    /** @type {?} */
    ColumnFormatSettingComponent.prototype.columnType;
    /** @type {?} */
    ColumnFormatSettingComponent.prototype.activeField;
    /** @type {?} */
    ColumnFormatSettingComponent.prototype.showGridFooter;
    /** @type {?} */
    ColumnFormatSettingComponent.prototype.searchItems;
    /** @type {?} */
    ColumnFormatSettingComponent.prototype.alignItems;
    /** @type {?} */
    ColumnFormatSettingComponent.prototype.summaryItems;
    /** @type {?} */
    ColumnFormatSettingComponent.prototype.summaryItems2;
    /** @type {?} */
    ColumnFormatSettingComponent.prototype.fixedItems;
    /** @type {?} */
    ColumnFormatSettingComponent.prototype.localeSer;
    /** @type {?} */
    ColumnFormatSettingComponent.prototype.isEn;
    /** @type {?} */
    ColumnFormatSettingComponent.prototype.switchValue;
    /** @type {?} */
    ColumnFormatSettingComponent.prototype._searchResult;
    /**
     * 配置多表头相关设置
     * @type {?}
     */
    ColumnFormatSettingComponent.prototype.multiHeaderOptions;
    /** @type {?} */
    ColumnFormatSettingComponent.prototype.enableMultipleHeaders;
    /** @type {?} */
    ColumnFormatSettingComponent.prototype.selectTreeNode;
    /**
     * @type {?}
     * @private
     */
    ColumnFormatSettingComponent.prototype.injector;
    /** @type {?} */
    ColumnFormatSettingComponent.prototype.gridSettingComponentRef;
    /**
     * @type {?}
     * @private
     */
    ColumnFormatSettingComponent.prototype.cd;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29sdW1uLWZvcm1hdC1zZXR0aW5nLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BmYXJyaXMvdWktZGF0YWdyaWQtc2V0dGluZ3MvIiwic291cmNlcyI6WyJsaWIvY29sdW1uLWZvcm1hdC1zZXR0aW5nL2NvbHVtbi1mb3JtYXQtc2V0dGluZy5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQSxPQUFPLEVBQUUsYUFBYSxFQUFFLE1BQU0sbUJBQW1CLENBQUM7QUFDbEQsT0FBTyxFQUFFLFNBQVMsRUFBRSxLQUFLLEVBQVUsUUFBUSxFQUFFLFNBQVMsRUFBRSxNQUFNLEVBQUUsWUFBWSxFQUFFLGlCQUFpQixFQUE0QixpQkFBaUIsRUFBNkIsTUFBTSxlQUFlLENBQUM7QUFDL0wsT0FBTyxFQUFFLE1BQU0sRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBQ3hDLE9BQU8sRUFBRSx5QkFBeUIsRUFBRSxNQUFNLGdDQUFnQyxDQUFDO0FBRzNFLE9BQU8sRUFBRSxtQkFBbUIsRUFBRSxNQUFNLHdDQUF3QyxDQUFDO0FBRzdFO0lBb0RJLHNDQUFvQixRQUFrQixFQUFTLHVCQUFrRCxFQUFVLEVBQXFCO1FBQTVHLGFBQVEsR0FBUixRQUFRLENBQVU7UUFBUyw0QkFBdUIsR0FBdkIsdUJBQXVCLENBQTJCO1FBQVUsT0FBRSxHQUFGLEVBQUUsQ0FBbUI7UUE5Q3ZILFlBQU8sR0FBRyxFQUFFLENBQUM7UUFDYixXQUFNLEdBQUcsRUFBRSxDQUFDO1FBS1gsaUJBQVksR0FBRyxJQUFJLFlBQVksRUFBRSxDQUFDO1FBQ2xDLGlCQUFZLEdBQUcsSUFBSSxZQUFZLEVBQUUsQ0FBQztRQUU1QyxZQUFPLEdBQUcsRUFBRSxDQUFDOzs7O1FBR2IsZUFBVSxHQUFHLEVBQUUsQ0FBQztRQUNoQixlQUFVLEdBQUcsS0FBSyxDQUFDO1FBQ25CLGdCQUFXLEdBQUcsSUFBSSxDQUFDO1FBQ25CLG1CQUFjLEdBQUcsS0FBSyxDQUFDO1FBRXZCLGdCQUFXLEdBQUcsRUFBRSxDQUFDO1FBQ2pCLGVBQVUsR0FBRyxFQUFFLENBQUM7UUFDaEIsaUJBQVksR0FBRyxFQUFFLENBQUM7UUFDbEIsa0JBQWEsR0FBRyxFQUFFLENBQUM7UUFDbkIsZUFBVSxHQUFHLEVBQUUsQ0FBQztRQUVoQixTQUFJLEdBQUcsS0FBSyxDQUFDO1FBRWIsZ0JBQVcsR0FBRyxLQUFLLENBQUM7UUFFcEIsa0JBQWEsR0FBRyxFQUFFLFFBQVEsRUFBRSxLQUFLLEVBQUUsVUFBVSxFQUFFLEtBQUssRUFBRSxDQUFDOzs7O1FBSTlDLHVCQUFrQixHQUErQixFQUFFLENBQUM7O1FBRXBELDBCQUFxQixHQUFHLEtBQUssQ0FBQztRQUV2QyxtQkFBYyxHQUFHLElBQUksQ0FBQztRQVlsQixJQUFJLENBQUMsY0FBYyxHQUFHLElBQUksQ0FBQyx1QkFBdUIsQ0FBQyxZQUFZLENBQUMsVUFBVTtZQUNsRCxDQUFDLElBQUksQ0FBQyx1QkFBdUIsQ0FBQyxZQUFZLENBQUMsY0FBYyxDQUFDO1FBQ2xGLElBQUksQ0FBQyxTQUFTLEdBQUcsSUFBSSxDQUFDLFFBQVEsQ0FBQyxHQUFHLENBQUMsYUFBYSxFQUFFLElBQUksQ0FBQyxDQUFDO0lBQzVELENBQUM7SUFiRCxzQkFBSSxxREFBVzs7OztRQUFmO1lBQ0ksSUFBSSxJQUFJLENBQUMsZUFBZSxJQUFJLElBQUksQ0FBQyxjQUFjLElBQUksSUFBSSxDQUFDLGNBQWMsQ0FBQyxFQUFFLEtBQUsscUJBQXFCLEVBQUcsRUFBRSxNQUFNOzs7b0JBQ3BHLEVBQUUsR0FBRyxJQUFJLENBQUMsZUFBZSxDQUFDLEVBQUUsQ0FBQyxXQUFXLENBQUMsSUFBSSxDQUFDLGNBQWMsQ0FBQyxFQUFFLENBQUM7Z0JBQ3RFLE9BQU8sRUFBRSxJQUFJLENBQUMsRUFBRSxDQUFDLEtBQUssQ0FBQzthQUMxQjtpQkFBTTtnQkFDSCxPQUFPLElBQUksQ0FBQzthQUNmO1FBQ0wsQ0FBQzs7O09BQUE7Ozs7O0lBUUQsa0RBQVc7Ozs7SUFBWCxVQUFZLE9BQXNCO1FBQzlCLElBQUksT0FBTyxDQUFDLE9BQU8sSUFBSSxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsYUFBYSxFQUFFLEVBQUU7WUFDckQsSUFBSSxDQUFDLGFBQWEsRUFBRSxDQUFDO1lBQ3JCLElBQUksQ0FBQyxPQUFPLEdBQUcsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUMvQixJQUFJLENBQUMsY0FBYyxFQUFFLENBQUM7WUFDdEIsSUFBSSxDQUFDLGtCQUFrQixFQUFFLENBQUM7WUFDMUIsSUFBSSxDQUFDLGFBQWEsR0FBRyxJQUFJLENBQUMscUJBQXFCLEVBQUUsQ0FBQztTQUNyRDtRQUVELElBQUksT0FBTyxDQUFDLGtCQUFrQixJQUFJLENBQUMsT0FBTyxDQUFDLGtCQUFrQixDQUFDLGFBQWEsRUFBRSxFQUFFO1lBQzNFLElBQUksQ0FBQyxjQUFjLEVBQUUsQ0FBQztTQUN6QjtJQUVMLENBQUM7Ozs7SUFFRCwrQ0FBUTs7O0lBQVI7UUFDSSxJQUFJLENBQUMsSUFBSSxHQUFHLElBQUksQ0FBQyxTQUFTLENBQUMsUUFBUSxLQUFLLElBQUksQ0FBQztRQUM3QyxJQUFJLENBQUMsUUFBUSxFQUFFLENBQUM7SUFDcEIsQ0FBQzs7OztJQUVELHNEQUFlOzs7SUFBZjtRQUFBLGlCQVVDO1FBVEcsSUFBSSxDQUFDLGNBQWMsRUFBRSxDQUFDO1FBRXRCLFVBQVU7OztRQUFDO1lBQ1AsSUFBSSxLQUFJLENBQUMsT0FBTyxFQUFFO2dCQUNkLEtBQUksQ0FBQyxPQUFPLENBQUMsWUFBWSxDQUFDLFNBQVM7Ozs7Z0JBQUMsVUFBQSxDQUFDO29CQUNqQyxLQUFJLENBQUMsWUFBWSxDQUFDLElBQUksQ0FBQyxLQUFJLENBQUMsVUFBVSxDQUFDLENBQUM7Z0JBQzVDLENBQUMsRUFBQyxDQUFDO2FBQ047UUFDTCxDQUFDLEdBQUUsRUFBRSxDQUFDLENBQUM7SUFDWCxDQUFDOzs7OztJQUVPLHFEQUFjOzs7O0lBQXRCO1FBQUEsaUJBYUM7UUFaRyxVQUFVOzs7UUFBQztZQUNQLElBQUksS0FBSSxDQUFDLHFCQUFxQixJQUFJLEtBQUksQ0FBQyxrQkFBa0IsRUFBRTtnQkFDaEQsSUFBQSwwQ0FBTztnQkFDZCxJQUFJLE9BQU8sSUFBSSxPQUFPLENBQUMsTUFBTSxFQUFFO29CQUMzQixLQUFJLENBQUMsZUFBZSxDQUFDLEVBQUUsQ0FBQyxlQUFlLEVBQUUsQ0FBQztpQkFDN0M7cUJBQU07b0JBQ0gsS0FBSSxDQUFDLFdBQVcsR0FBRyxJQUFJLENBQUM7aUJBQzNCO2FBQ0o7aUJBQU07Z0JBQ0gsS0FBSSxDQUFDLFdBQVcsR0FBRyxLQUFJLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO2FBQ3pDO1FBQ0wsQ0FBQyxFQUFDLENBQUM7SUFDUCxDQUFDOzs7OztJQUVPLG9EQUFhOzs7O0lBQXJCO1FBQ0ksMkNBQTJDO1FBQzNDLDJEQUEyRDtRQUMzRCxNQUFNO1FBQ04sSUFBSSxDQUFDLFVBQVUsR0FBSSxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDO0lBQ3ZDLENBQUM7Ozs7O0lBRU8sK0NBQVE7Ozs7SUFBaEI7UUFFSSxJQUFJLENBQUMsVUFBVSxHQUFHLElBQUksQ0FBQyx1QkFBdUIsQ0FBQyxVQUFVLENBQUM7UUFDMUQsSUFBSSxDQUFDLFdBQVcsR0FBRyxJQUFJLENBQUMsdUJBQXVCLENBQUMsV0FBVyxDQUFDO1FBQzVELElBQUksQ0FBQyxZQUFZLEdBQUcsSUFBSSxDQUFDLHVCQUF1QixDQUFDLFlBQVksQ0FBQztRQUM5RCxJQUFJLENBQUMsYUFBYSxHQUFHLElBQUksQ0FBQyx1QkFBdUIsQ0FBQyxhQUFhLENBQUM7UUFDaEUsSUFBSSxDQUFDLFVBQVUsR0FBRyxJQUFJLENBQUMsdUJBQXVCLENBQUMsVUFBVSxDQUFDO1FBRzFELElBQUksQ0FBQyxhQUFhLEVBQUUsQ0FBQztRQUNyQixJQUFJLENBQUMsT0FBTyxHQUFHLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDL0IsSUFBSSxDQUFDLGtCQUFrQixFQUFFLENBQUM7UUFFMUIsSUFBSSxDQUFDLGFBQWEsRUFBRSxDQUFDO0lBQ3pCLENBQUM7Ozs7O0lBRU8seURBQWtCOzs7O0lBQTFCO1FBQ0ksSUFBSSxJQUFJLENBQUMsV0FBVyxFQUFFO1lBQ2xCLElBQUksSUFBSSxDQUFDLFdBQVcsQ0FBQyxhQUFhLEtBQUssU0FBUyxFQUFFO2dCQUM5QyxJQUFJLENBQUMsV0FBVyxDQUFDLGFBQWEsR0FBRyxJQUFJLENBQUM7YUFDekM7WUFFRCxJQUFJLElBQUksQ0FBQyxXQUFXLENBQUMsV0FBVyxLQUFLLFNBQVMsRUFBRTtnQkFDNUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxXQUFXLEdBQUcsRUFBRSxPQUFPLEVBQUUsRUFBQyxlQUFlLEVBQUUsQ0FBQyxDQUFDLEVBQUMsRUFBRSxDQUFDO2FBQ3JFO2lCQUFNO2dCQUNILElBQUksQ0FBQyxXQUFXLENBQUMsV0FBVyxDQUFDLE9BQU8sR0FBRyxJQUFJLENBQUMsV0FBVyxDQUFDLFdBQVcsQ0FBQyxPQUFPLElBQUksRUFBQyxlQUFlLEVBQUUsQ0FBQyxDQUFDLEVBQUMsQ0FBQztnQkFDckcsSUFBSSxJQUFJLENBQUMsV0FBVyxDQUFDLFdBQVcsQ0FBQyxPQUFPLENBQUMsZUFBZSxLQUFLLFNBQVMsRUFBRTtvQkFDcEUsSUFBSSxDQUFDLFdBQVcsQ0FBQyxXQUFXLENBQUMsT0FBTyxDQUFDLGVBQWUsR0FBRyxDQUFDLENBQUMsQ0FBQztpQkFDN0Q7YUFDSjtZQUVELElBQUksSUFBSSxDQUFDLFdBQVcsQ0FBQyxNQUFNLEtBQUssU0FBUyxFQUFFO2dCQUN2QyxJQUFJLENBQUMsV0FBVyxDQUFDLE1BQU0sR0FBSSxFQUFFLE9BQU8sRUFBRSxFQUFDLGVBQWUsRUFBRSxDQUFDLENBQUMsRUFBQyxFQUFFLENBQUM7YUFDakU7aUJBQU07Z0JBQ0gsSUFBSSxDQUFDLFdBQVcsQ0FBQyxNQUFNLENBQUMsT0FBTyxHQUFHLElBQUksQ0FBQyxXQUFXLENBQUMsTUFBTSxDQUFDLE9BQU8sSUFBSSxFQUFDLGVBQWUsRUFBRSxDQUFDLENBQUMsRUFBQyxDQUFDO2dCQUMzRixJQUFJLElBQUksQ0FBQyxXQUFXLENBQUMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxlQUFlLEtBQUssU0FBUyxFQUFFO29CQUMvRCxJQUFJLENBQUMsV0FBVyxDQUFDLE1BQU0sQ0FBQyxPQUFPLENBQUMsZUFBZSxHQUFHLENBQUMsQ0FBQyxDQUFDO2lCQUN4RDthQUNKO1lBRUQsSUFBSSxDQUFDLElBQUksQ0FBQyxXQUFXLENBQUMsS0FBSyxJQUFJLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxLQUFLLEtBQUssTUFBTSxJQUFJLElBQUksQ0FBQyxXQUFXLENBQUMsS0FBSyxLQUFLLE9BQU8sQ0FBQyxFQUFFO2dCQUN0RyxJQUFJLENBQUMsV0FBVyxDQUFDLEtBQUssR0FBRyxTQUFTLENBQUM7YUFDdEM7U0FDSjtJQUNMLENBQUM7SUFFRCxnQkFBZ0I7SUFDaEIsVUFBVTtJQUNWLGNBQWM7SUFDZCxhQUFhO0lBQ2IsWUFBWTs7Ozs7Ozs7OztJQUNaLG9EQUFhOzs7Ozs7Ozs7O0lBQWIsVUFBZSxXQUFnQjtRQUEvQixpQkFnQkM7UUFoQmMsNEJBQUEsRUFBQSxnQkFBZ0I7O1lBQ3ZCLElBQUksR0FBRyxFQUFFO1FBRWIsSUFBSSxJQUFJLENBQUMsV0FBVyxFQUFFO1lBQ2xCLElBQUksR0FBRyxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDLE1BQU07Ozs7WUFBQyxVQUFBLENBQUMsSUFBSSxPQUFBLEtBQUksQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLENBQUMsRUFBakMsQ0FBaUMsRUFBQyxDQUFDO1NBQ3pFO2FBQU07WUFDSCxJQUFJLEdBQUcsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQztTQUMxQjtRQUdELElBQUksV0FBVyxFQUFFO1lBQ2IsSUFBSSxHQUFHLElBQUksQ0FBQyxNQUFNOzs7O1lBQUMsVUFBQSxDQUFDLElBQUksT0FBQSxDQUFDLENBQUMsS0FBSyxDQUFDLFdBQVcsRUFBRSxDQUFDLE9BQU8sQ0FBQyxXQUFXLENBQUMsR0FBRyxDQUFDLENBQUMsRUFBL0MsQ0FBK0MsRUFBQyxDQUFDO1NBQzVFO1FBRUQsSUFBSSxDQUFDLE9BQU8sR0FBRyxJQUFJLENBQUM7UUFDcEIsSUFBSSxDQUFDLGFBQWEsR0FBRyxJQUFJLENBQUMscUJBQXFCLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxNQUFNOzs7O1FBQUMsVUFBQSxDQUFDLElBQUksT0FBQSxDQUFDLENBQUMsT0FBTyxFQUFULENBQVMsRUFBQyxDQUFDLENBQUM7SUFDekYsQ0FBQzs7Ozs7O0lBRU8sNERBQXFCOzs7OztJQUE3QixVQUE4QixZQUFrQjs7WUFDdEMsYUFBYSxHQUFHLElBQUksQ0FBQyxPQUFPLENBQUMsTUFBTTs7OztRQUFDLFVBQUEsQ0FBQyxJQUFJLE9BQUEsQ0FBQyxDQUFDLEtBQUssSUFBSSw0QkFBNEIsRUFBdkMsQ0FBdUMsRUFBQyxDQUFDLE1BQU07O1lBQzFGLFlBQVksR0FBRyxJQUFJLENBQUMsTUFBTSxDQUFDLE1BQU07Ozs7UUFBQyxVQUFBLENBQUMsSUFBSSxPQUFBLENBQUMsSUFBSyw0QkFBNEIsRUFBbEMsQ0FBa0MsRUFBQyxDQUFDLE1BQU07UUFFckYsSUFBSSxZQUFZLEVBQUU7WUFDZCxZQUFZLEdBQUcsWUFBWSxDQUFDLE1BQU0sQ0FBQztTQUN0QztRQUdELE9BQU87WUFDSCxRQUFRLEVBQUUsYUFBYSxJQUFJLGFBQWEsS0FBSyxZQUFZO1lBQ3pELFVBQVUsRUFBQyxDQUFDLFlBQVksQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxZQUFZO1NBQ2pFLENBQUM7SUFDTixDQUFDOzs7Ozs7SUFFRCxtREFBWTs7Ozs7SUFBWixVQUFhLEdBQUcsRUFBRSxNQUFNO1FBQ3BCLElBQUksQ0FBQyxXQUFXLEdBQUcsR0FBRyxDQUFDO1FBQ3ZCLElBQUksQ0FBQyxrQkFBa0IsRUFBRSxDQUFDO0lBQzlCLENBQUM7Ozs7O0lBR08sc0RBQWU7Ozs7SUFBdkI7UUFDSSxJQUFJLENBQUMsYUFBYSxFQUFFLENBQUM7UUFDckIsSUFBSSxDQUFDLFlBQVksQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFDO0lBQ3hDLENBQUM7Ozs7OztJQUVELGlEQUFVOzs7OztJQUFWLFVBQVcsTUFBTSxFQUFFLEdBQUc7UUFDbEIsTUFBTSxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsVUFBVSxHQUFHLE1BQU0sQ0FBQztRQUN4QyxJQUFJLENBQUMsZUFBZSxDQUFDLE1BQU0sRUFBRSxHQUFHLENBQUMsQ0FBQztRQUNsQyxNQUFNLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxVQUFVLEdBQUcsRUFBRSxDQUFDO0lBQ3hDLENBQUM7Ozs7OztJQUVELHNEQUFlOzs7OztJQUFmLFVBQWdCLE1BQU0sRUFBRSxHQUFHO1FBQTNCLGlCQW1CQztRQWxCRyxNQUFNLENBQUMsZUFBZSxFQUFFLENBQUM7O1lBQ25CLEtBQUssR0FBRyxJQUFJLENBQUMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDO1FBQzVDLElBQUksS0FBSyxLQUFLLENBQUMsQ0FBQyxFQUFFO1lBQ2QsSUFBSSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQyxDQUFDO1NBQy9CO2FBQU07WUFDSCxJQUFJLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxLQUFLLEVBQUUsQ0FBQyxDQUFDLENBQUM7U0FDaEM7UUFFRCxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDLE9BQU87Ozs7UUFBQyxVQUFBLENBQUM7WUFDckIsQ0FBQyxDQUFDLE9BQU8sR0FBRyxLQUFJLENBQUMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUM7UUFDbEQsQ0FBQyxFQUFDLENBQUM7UUFFSCxJQUFJLENBQUMsTUFBTSxHQUFHLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUMsTUFBTTs7OztRQUFDLFVBQUEsQ0FBQyxJQUFJLE9BQUEsQ0FBQyxDQUFDLE9BQU8sRUFBVCxDQUFTLEVBQUMsQ0FBQyxHQUFHOzs7O1FBQUMsVUFBQSxDQUFDLElBQUksT0FBQSxDQUFDLENBQUMsS0FBSyxFQUFQLENBQU8sRUFBQyxDQUFDOztZQUVqRSxPQUFPLEdBQUcsSUFBSSxDQUFDLE9BQU8sQ0FBQyxNQUFNOzs7O1FBQUMsVUFBQSxDQUFDLElBQUksT0FBQSxDQUFDLENBQUMsT0FBTyxFQUFULENBQVMsRUFBQyxDQUFDLEdBQUc7Ozs7UUFBQyxVQUFBLENBQUMsSUFBSSxPQUFBLENBQUMsQ0FBQyxLQUFLLEVBQVAsQ0FBTyxFQUFDO1FBQ3JFLElBQUksQ0FBQyxhQUFhLEdBQUcsSUFBSSxDQUFDLHFCQUFxQixDQUFDLE9BQU8sQ0FBQyxDQUFDO1FBRXpELElBQUksQ0FBQyxlQUFlLEVBQUUsQ0FBQztJQUMzQixDQUFDOzs7OztJQUVELG1EQUFZOzs7O0lBQVosVUFBYSxNQUFNO1FBQ2YsSUFBSSxDQUFDLFdBQVcsR0FBRyxLQUFLLENBQUM7O1lBQ25CLEdBQUcsR0FBRyxNQUFNLENBQUMsTUFBTSxDQUFDLEtBQUs7UUFDL0IsSUFBSSxDQUFDLGFBQWEsQ0FBQyxHQUFHLENBQUMsQ0FBQztJQUM1QixDQUFDOzs7Ozs7O0lBRUQsa0RBQVc7Ozs7OztJQUFYLFVBQVksU0FBUyxFQUFFLEdBQUcsRUFBRSxPQUFZOztRQUM1QixJQUFBLHFDQUFZLEVBQUUsaUNBQVU7O1lBRTFCLFFBQVEsR0FBRyxJQUFJLENBQUMsT0FBTyxDQUFDLFlBQVksQ0FBQzs7WUFDckMsVUFBVSxHQUFHLElBQUksQ0FBQyxPQUFPLENBQUMsVUFBVSxDQUFDOztZQUVyQyxhQUFhLEdBQUcsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQyxTQUFTOzs7O1FBQUMsVUFBQSxDQUFDLElBQUksT0FBQSxDQUFDLENBQUMsS0FBSyxLQUFLLFFBQVEsQ0FBQyxLQUFLLEVBQTFCLENBQTBCLEVBQUM7O1lBQzFFLGVBQWUsR0FBRyxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDLFNBQVM7Ozs7UUFBQyxVQUFBLENBQUMsSUFBSSxPQUFBLENBQUMsQ0FBQyxLQUFLLEtBQUssVUFBVSxDQUFDLEtBQUssRUFBNUIsQ0FBNEIsRUFBQzs7WUFFOUUsV0FBVyxHQUFHLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLGFBQWEsRUFBRSxDQUFDLENBQUM7UUFDNUQsQ0FBQSxLQUFBLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUEsQ0FBQyxNQUFNLDZCQUFDLGVBQWUsRUFBRSxDQUFDLEdBQUssV0FBVyxHQUFFO1FBRTNELElBQUksQ0FBQyxNQUFNLEdBQUcsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQyxNQUFNOzs7O1FBQUMsVUFBQSxDQUFDLElBQUksT0FBQSxDQUFDLENBQUMsT0FBTyxFQUFULENBQVMsRUFBQyxDQUFDLEdBQUc7Ozs7UUFBQyxVQUFBLENBQUMsSUFBSSxPQUFBLENBQUMsQ0FBQyxLQUFLLEVBQVAsQ0FBTyxFQUFDLENBQUM7UUFDdkUsSUFBSSxDQUFDLGVBQWUsRUFBRSxDQUFDO1FBRXZCLElBQUksQ0FBQyxhQUFhLENBQUMsR0FBRyxDQUFDLENBQUM7SUFFNUIsQ0FBQztJQUVEOztPQUVHOzs7Ozs7O0lBQ0ssdURBQWdCOzs7Ozs7SUFBeEIsVUFBeUIsTUFBYztRQUFkLHVCQUFBLEVBQUEsY0FBYztRQUNuQyxJQUFJLElBQUksQ0FBQyxNQUFNLENBQUMsTUFBTSxLQUFLLENBQUMsRUFBRTtZQUMxQixPQUFPLENBQUMsQ0FBQztTQUNaO2FBQU07WUFDSCxJQUFJLE1BQU0sRUFBRTtnQkFDUixJQUFJLElBQUksQ0FBQyxhQUFhLENBQUMsUUFBUSxFQUFFO29CQUM3QixPQUFPLENBQUMsQ0FBQztpQkFDWjthQUNKO2lCQUFNO2dCQUNILElBQUksSUFBSSxDQUFDLE1BQU0sQ0FBQyxNQUFNLEtBQUssSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQyxNQUFNLEVBQUU7b0JBQy9DLE9BQU8sQ0FBQyxDQUFDO2lCQUNaO2FBQ0o7WUFDRCxPQUFPLENBQUMsQ0FBQztTQUNaO0lBQ0wsQ0FBQzs7Ozs7O0lBRUQsc0RBQWU7Ozs7O0lBQWYsVUFBZ0IsTUFBTSxFQUFFLEdBQUc7UUFBM0IsaUJBOEJDO1FBN0JHLElBQUksQ0FBQyxJQUFJLENBQUMsT0FBTyxJQUFJLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxNQUFNLEVBQUU7WUFDdkMsT0FBTztTQUNWOztZQUNLLEtBQUssR0FBRyxJQUFJLENBQUMsZ0JBQWdCLENBQUMsR0FBRyxDQUFDOztZQUNsQyxTQUFTLEdBQUcsS0FBSyxLQUFLLENBQUMsSUFBSSxLQUFLLEtBQUssQ0FBQzs7WUFDeEMsT0FBTyxHQUFHLElBQUk7UUFDbEIsSUFBSSxHQUFHLElBQUksRUFBRSxFQUFFO1lBQ1gsSUFBSSxTQUFTLEVBQUU7Z0JBQ1gsT0FBTztnQkFDUCxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDLE9BQU87Ozs7Z0JBQUMsVUFBQSxDQUFDLElBQUksT0FBQSxDQUFDLENBQUMsT0FBTyxHQUFHLElBQUksRUFBaEIsQ0FBZ0IsRUFBQyxDQUFDO2dCQUMvQyxJQUFJLENBQUMsTUFBTSxHQUFHLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRzs7OztnQkFBQyxVQUFBLENBQUMsSUFBSSxPQUFBLENBQUMsQ0FBQyxLQUFLLEVBQVAsQ0FBTyxFQUFDLENBQUM7YUFDbkQ7aUJBQU07Z0JBQ0gsT0FBTztnQkFDUCxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDLE9BQU87Ozs7Z0JBQUMsVUFBQSxDQUFDLElBQUksT0FBQSxDQUFDLENBQUMsT0FBTyxHQUFHLEtBQUssRUFBakIsQ0FBaUIsRUFBQyxDQUFDO2dCQUNoRCxJQUFJLENBQUMsTUFBTSxHQUFHLEVBQUUsQ0FBQzthQUNwQjtTQUNKO2FBQU07WUFDSCxJQUFJLENBQUMsT0FBTyxDQUFDLE9BQU87Ozs7WUFBQyxVQUFBLENBQUM7O29CQUNaLEdBQUcsR0FBRyxLQUFJLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUk7Ozs7Z0JBQUMsVUFBQSxDQUFDLElBQUksT0FBQSxDQUFDLENBQUMsS0FBSyxLQUFLLENBQUMsQ0FBQyxLQUFLLEVBQW5CLENBQW1CLEVBQUM7Z0JBQzFELEdBQUcsQ0FBQyxPQUFPLEdBQUcsU0FBUyxDQUFDO2dCQUN4QixDQUFDLENBQUMsT0FBTyxHQUFHLFNBQVMsQ0FBQztZQUMxQixDQUFDLEVBQUMsQ0FBQztZQUNILE9BQU8sR0FBRyxJQUFJLENBQUMsT0FBTyxDQUFDLE1BQU07Ozs7WUFBQyxVQUFBLENBQUMsSUFBSSxPQUFBLENBQUMsQ0FBQyxPQUFPLEVBQVQsQ0FBUyxFQUFDLENBQUMsR0FBRzs7OztZQUFDLFVBQUEsQ0FBQyxJQUFJLE9BQUEsQ0FBQyxDQUFDLEtBQUssRUFBUCxDQUFPLEVBQUMsQ0FBQztZQUNoRSxJQUFJLENBQUMsTUFBTSxHQUFHLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUMsTUFBTTs7OztZQUFDLFVBQUEsQ0FBQyxJQUFJLE9BQUEsQ0FBQyxDQUFDLE9BQU8sRUFBVCxDQUFTLEVBQUMsQ0FBQyxHQUFHOzs7O1lBQUMsVUFBQSxDQUFDLElBQUksT0FBQSxDQUFDLENBQUMsS0FBSyxFQUFQLENBQU8sRUFBQyxDQUFDO1NBQzFFO1FBQ0QsSUFBSSxDQUFDLGFBQWEsR0FBRyxJQUFJLENBQUMscUJBQXFCLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQSxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUM7UUFDdEUsSUFBSSxDQUFDLEVBQUUsQ0FBQyxhQUFhLEVBQUUsQ0FBQztRQUN4QixJQUFJLENBQUMsZUFBZSxFQUFFLENBQUM7UUFDdkIsMkJBQTJCO0lBQy9CLENBQUM7SUFFQSxTQUFTOzs7Ozs7O0lBQ1QsNERBQXFCOzs7Ozs7O0lBQXJCLFVBQXNCLE1BQU0sRUFBRSxHQUFHO1FBQzlCLElBQUksQ0FBQyxXQUFXLEdBQUcsTUFBTSxDQUFDO1FBQzFCLElBQUksQ0FBQyxhQUFhLENBQUMsR0FBRyxDQUFDLENBQUM7SUFDNUIsQ0FBQzs7Ozs7O0lBRUQsa0RBQVc7Ozs7O0lBQVgsVUFBWSxNQUFNLEVBQUUsV0FBVztRQUMzQixJQUFJLFdBQVcsSUFBSSxXQUFXLENBQUMsS0FBSyxFQUFFO1lBQ2xDLElBQUksQ0FBQyxhQUFhLENBQUMsRUFBRSxDQUFDLENBQUM7WUFDdkIsV0FBVyxDQUFDLEtBQUssR0FBRyxFQUFFLENBQUM7U0FDMUI7SUFDTCxDQUFDOzs7OztJQUVELHFEQUFjOzs7O0lBQWQsVUFBZSxNQUFlO1FBQzFCLElBQUksTUFBTSxJQUFJLE1BQU0sQ0FBQyxJQUFJLENBQUMsRUFBRSxLQUFLLHFCQUFxQixFQUFFO1lBQ3BELElBQUksQ0FBQyxXQUFXLEdBQUcsTUFBTSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUM7WUFDcEMsSUFBSSxDQUFDLGNBQWMsR0FBRyxNQUFNLENBQUMsSUFBSSxDQUFDO1lBQ2xDLElBQUksQ0FBQyxrQkFBa0IsRUFBRSxDQUFDO1NBQzdCO2FBQU07WUFDSCxJQUFJLENBQUMsV0FBVyxHQUFHLElBQUksQ0FBQztZQUN4QixJQUFJLENBQUMsY0FBYyxHQUFHLElBQUksQ0FBQztTQUM5QjtJQUNMLENBQUM7Ozs7SUFFRCxzREFBZTs7O0lBQWY7UUFJSSxPQUFPLElBQUksQ0FBQyxlQUFlLENBQUEsQ0FBQyxDQUFDLElBQUksQ0FBQyxlQUFlLENBQUMsV0FBVyxFQUFFLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQztJQUMzRSxDQUFDOztnQkFwVkosU0FBUyxTQUFDO29CQUNQLFFBQVEsRUFBRSx1QkFBdUI7b0JBQ2pDLDB2VUFBcUQ7b0JBQ3JELGFBQWEsRUFBRSxpQkFBaUIsQ0FBQyxJQUFJO2lCQUN4Qzs7OztnQkFaa0MsUUFBUTtnQkFFbEMseUJBQXlCO2dCQUY0QyxpQkFBaUI7OzswQkFjMUYsS0FBSzt5QkFDTCxLQUFLOzBCQUVMLFNBQVMsU0FBQyxlQUFlO2tDQUN6QixTQUFTLFNBQUMsSUFBSTsrQkFFZCxNQUFNOytCQUNOLE1BQU07cUNBd0JOLEtBQUs7d0NBRUwsS0FBSzs7SUE4U1YsbUNBQUM7Q0FBQSxBQXJWRCxJQXFWQztTQWhWWSw0QkFBNEI7OztJQUNyQywrQ0FBc0I7O0lBQ3RCLDhDQUFxQjs7SUFFckIsK0NBQTRDOztJQUM1Qyx1REFBc0Q7O0lBRXRELG9EQUE0Qzs7SUFDNUMsb0RBQTRDOztJQUU1QywrQ0FBYTs7Ozs7SUFHYixrREFBZ0I7O0lBQ2hCLGtEQUFtQjs7SUFDbkIsbURBQW1COztJQUNuQixzREFBdUI7O0lBRXZCLG1EQUFpQjs7SUFDakIsa0RBQWdCOztJQUNoQixvREFBa0I7O0lBQ2xCLHFEQUFtQjs7SUFDbkIsa0RBQWdCOztJQUNoQixpREFBeUI7O0lBQ3pCLDRDQUFhOztJQUViLG1EQUFvQjs7SUFFcEIscURBQXVEOzs7OztJQUl2RCwwREFBNkQ7O0lBRTdELDZEQUF1Qzs7SUFFdkMsc0RBQXNCOzs7OztJQVdWLGdEQUEwQjs7SUFBRSwrREFBeUQ7Ozs7O0lBQUUsMENBQTZCIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTG9jYWxlU2VydmljZSB9IGZyb20gJ0BmYXJyaXMvdWktbG9jYWxlJztcclxuaW1wb3J0IHsgQ29tcG9uZW50LCBJbnB1dCwgT25Jbml0LCBJbmplY3RvciwgVmlld0NoaWxkLCBPdXRwdXQsIEV2ZW50RW1pdHRlciwgQ2hhbmdlRGV0ZWN0b3JSZWYsIE9uQ2hhbmdlcywgU2ltcGxlQ2hhbmdlcywgVmlld0VuY2Fwc3VsYXRpb24sIEVsZW1lbnRSZWYsIEFmdGVyVmlld0luaXQgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgTmdGb3JtIH0gZnJvbSAnQGFuZ3VsYXIvZm9ybXMnO1xyXG5pbXBvcnQgeyBEYXRhZ3JpZFNldHRpbmdzQ29tcG9uZW50IH0gZnJvbSAnLi4vZGF0YWdyaWQtc2V0dGluZ3MuY29tcG9uZW50JztcclxuaW1wb3J0IHsgQ29sdW1uVHJlZU9wdGlvbnMgfSBmcm9tICcuLi9zZXR0aW5nLm1vZGVsJztcclxuaW1wb3J0IHsgUm93Tm9kZSwgVHJlZU5vZGUgfSBmcm9tICdAZmFycmlzL3VpLXRyZWV0YWJsZSc7XHJcbmltcG9ydCB7IENvbHVtblRyZWVDb21wb25lbnQgfSBmcm9tICcuLi9tdWx0aS1oZWFkZXJzL2NvbHVtbi10cmVlLmNvbXBvbmVudCc7XHJcblxyXG5cclxuQENvbXBvbmVudCh7XHJcbiAgICBzZWxlY3RvcjogJ2NvbHVtbi1mb3JtYXQtc2V0dGluZycsXHJcbiAgICB0ZW1wbGF0ZVVybDogJy4vY29sdW1uLWZvcm1hdC1zZXR0aW5nLmNvbXBvbmVudC5odG1sJyxcclxuICAgIGVuY2Fwc3VsYXRpb246IFZpZXdFbmNhcHN1bGF0aW9uLk5vbmVcclxufSlcclxuZXhwb3J0IGNsYXNzIENvbHVtbkZvcm1hdFNldHRpbmdDb21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQsIE9uQ2hhbmdlcywgQWZ0ZXJWaWV3SW5pdCB7XHJcbiAgICBASW5wdXQoKSBjb2x1bW5zID0gW107XHJcbiAgICBASW5wdXQoKSBmaWVsZHMgPSBbXTtcclxuXHJcbiAgICBAVmlld0NoaWxkKCdjb2xmb3JtYXRmb3JtJykgY29sRm9ybTogTmdGb3JtO1xyXG4gICAgQFZpZXdDaGlsZCgnZ2gnKSBncm91cEhlYWRlcnNSZWY6IENvbHVtblRyZWVDb21wb25lbnQ7XHJcblxyXG4gICAgQE91dHB1dCgpIGZvcm1hdENoYW5nZSA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcclxuICAgIEBPdXRwdXQoKSBmaWVsZHNDaGFuZ2UgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XHJcblxyXG4gICAgYWxsQ29scyA9IFtdO1xyXG5cclxuICAgIC8qKiBmb3JtYXQgRGF0YSAqL1xyXG4gICAgZm9ybWF0RGF0YSA9IFtdO1xyXG4gICAgY29sdW1uVHlwZSA9ICdhbGwnO1xyXG4gICAgYWN0aXZlRmllbGQgPSBudWxsO1xyXG4gICAgc2hvd0dyaWRGb290ZXIgPSBmYWxzZTtcclxuXHJcbiAgICBzZWFyY2hJdGVtcyA9IFtdO1xyXG4gICAgYWxpZ25JdGVtcyA9IFtdO1xyXG4gICAgc3VtbWFyeUl0ZW1zID0gW107XHJcbiAgICBzdW1tYXJ5SXRlbXMyID0gW107XHJcbiAgICBmaXhlZEl0ZW1zID0gW107XHJcbiAgICBsb2NhbGVTZXI6IExvY2FsZVNlcnZpY2U7XHJcbiAgICBpc0VuID0gZmFsc2U7XHJcblxyXG4gICAgc3dpdGNoVmFsdWUgPSBmYWxzZTtcclxuXHJcbiAgICBfc2VhcmNoUmVzdWx0ID0geyBjaGVja0FsbDogZmFsc2UsIHVuQ2hlY2tBbGw6IGZhbHNlIH07XHJcblxyXG5cclxuICAgIC8qKiDphY3nva7lpJrooajlpLTnm7jlhbPorr7nva4gKi9cclxuICAgIEBJbnB1dCgpIG11bHRpSGVhZGVyT3B0aW9uczogUGFydGlhbDxDb2x1bW5UcmVlT3B0aW9ucz4gPSB7fTtcclxuICAgIC8vIOWQr+eUqOWkmuihqOWktFxyXG4gICAgQElucHV0KCkgZW5hYmxlTXVsdGlwbGVIZWFkZXJzID0gZmFsc2U7XHJcblxyXG4gICAgc2VsZWN0VHJlZU5vZGUgPSBudWxsO1xyXG5cclxuICAgIGdldCBpc1Nob3dmaXhlZCgpIHtcclxuICAgICAgICBpZiAodGhpcy5ncm91cEhlYWRlcnNSZWYgJiYgdGhpcy5zZWxlY3RUcmVlTm9kZSAmJiB0aGlzLnNlbGVjdFRyZWVOb2RlLmlkICE9PSAnX19IT1VfWFVBTl9MSUVfSURfXycgKSB7IC8vIOWkmuihqOWktFxyXG4gICAgICAgICAgICBjb25zdCBybiA9IHRoaXMuZ3JvdXBIZWFkZXJzUmVmLnR0LmZpbmRSb3dOb2RlKHRoaXMuc2VsZWN0VHJlZU5vZGUuaWQpO1xyXG4gICAgICAgICAgICByZXR1cm4gcm4gJiYgIXJuLmxldmVsO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIFxyXG4gICAgY29uc3RydWN0b3IocHJpdmF0ZSBpbmplY3RvcjogSW5qZWN0b3IsIHB1YmxpYyBncmlkU2V0dGluZ0NvbXBvbmVudFJlZjogRGF0YWdyaWRTZXR0aW5nc0NvbXBvbmVudCwgcHJpdmF0ZSBjZDogQ2hhbmdlRGV0ZWN0b3JSZWYpIHtcclxuICAgICAgICB0aGlzLnNob3dHcmlkRm9vdGVyID0gdGhpcy5ncmlkU2V0dGluZ0NvbXBvbmVudFJlZi5ncmlkSW5zdGFuY2Uuc2hvd0Zvb3RlciAmJlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICF0aGlzLmdyaWRTZXR0aW5nQ29tcG9uZW50UmVmLmdyaWRJbnN0YW5jZS5mb290ZXJUZW1wbGF0ZTtcclxuICAgICAgICB0aGlzLmxvY2FsZVNlciA9IHRoaXMuaW5qZWN0b3IuZ2V0KExvY2FsZVNlcnZpY2UsIG51bGwpO1xyXG4gICAgfVxyXG5cclxuICAgIG5nT25DaGFuZ2VzKGNoYW5nZXM6IFNpbXBsZUNoYW5nZXMpIHtcclxuICAgICAgICBpZiAoY2hhbmdlcy5jb2x1bW5zICYmICFjaGFuZ2VzLmNvbHVtbnMuaXNGaXJzdENoYW5nZSgpKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2V0Rm9ybWF0RGF0YSgpO1xyXG4gICAgICAgICAgICB0aGlzLmFsbENvbHMgPSB0aGlzLmNvbHVtbnNbMF07XHJcbiAgICAgICAgICAgIHRoaXMuc2V0QWN0aXZlRmllbGQoKTtcclxuICAgICAgICAgICAgdGhpcy5jaGVja0NvbHVtbk9wdGlvbnMoKTtcclxuICAgICAgICAgICAgdGhpcy5fc2VhcmNoUmVzdWx0ID0gdGhpcy5zZWFjaFJlc3VsdElzQ2hlY2tBbGwoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChjaGFuZ2VzLm11bHRpSGVhZGVyT3B0aW9ucyAmJiAhY2hhbmdlcy5tdWx0aUhlYWRlck9wdGlvbnMuaXNGaXJzdENoYW5nZSgpKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2V0QWN0aXZlRmllbGQoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgfVxyXG5cclxuICAgIG5nT25Jbml0KCk6IHZvaWQge1xyXG4gICAgICAgIHRoaXMuaXNFbiA9IHRoaXMubG9jYWxlU2VyLmxvY2FsZUlkID09PSAnZW4nO1xyXG4gICAgICAgIHRoaXMuaW5pdERhdGEoKTtcclxuICAgIH1cclxuXHJcbiAgICBuZ0FmdGVyVmlld0luaXQoKTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy5zZXRBY3RpdmVGaWVsZCgpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5jb2xGb3JtKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNvbEZvcm0udmFsdWVDaGFuZ2VzLnN1YnNjcmliZSh2ID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmZvcm1hdENoYW5nZS5lbWl0KHRoaXMuZm9ybWF0RGF0YSk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sIDUwKTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIHNldEFjdGl2ZUZpZWxkKCkge1xyXG4gICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5lbmFibGVNdWx0aXBsZUhlYWRlcnMgJiYgdGhpcy5tdWx0aUhlYWRlck9wdGlvbnMpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHtjb2x1bW5zfSA9IHRoaXMubXVsdGlIZWFkZXJPcHRpb25zO1xyXG4gICAgICAgICAgICAgICAgaWYgKGNvbHVtbnMgJiYgY29sdW1ucy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmdyb3VwSGVhZGVyc1JlZi50dC5zZWxlY3RGaXJzdE5vZGUoKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5hY3RpdmVGaWVsZCA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmFjdGl2ZUZpZWxkID0gdGhpcy5jb2x1bW5zWzBdWzBdO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBzZXRGb3JtYXREYXRhKCkge1xyXG4gICAgICAgIC8vIHRoaXMuZm9ybWF0RGF0YSA9IHRoaXMuZmllbGRzLm1hcChuID0+IHtcclxuICAgICAgICAvLyAgICAgcmV0dXJuIHRoaXMuY29sdW1uc1swXS5maW5kKGNvbCA9PiBjb2wuZmllbGQgPT09IG4pO1xyXG4gICAgICAgIC8vIH0pO1xyXG4gICAgICAgIHRoaXMuZm9ybWF0RGF0YSA9ICB0aGlzLmNvbHVtbnNbMF07XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBpbml0RGF0YSgpIHtcclxuXHJcbiAgICAgICAgdGhpcy5hbGlnbkl0ZW1zID0gdGhpcy5ncmlkU2V0dGluZ0NvbXBvbmVudFJlZi5hbGlnbkl0ZW1zO1xyXG4gICAgICAgIHRoaXMuc2VhcmNoSXRlbXMgPSB0aGlzLmdyaWRTZXR0aW5nQ29tcG9uZW50UmVmLnNlYXJjaEl0ZW1zO1xyXG4gICAgICAgIHRoaXMuc3VtbWFyeUl0ZW1zID0gdGhpcy5ncmlkU2V0dGluZ0NvbXBvbmVudFJlZi5zdW1tYXJ5SXRlbXM7XHJcbiAgICAgICAgdGhpcy5zdW1tYXJ5SXRlbXMyID0gdGhpcy5ncmlkU2V0dGluZ0NvbXBvbmVudFJlZi5zdW1tYXJ5SXRlbXMyO1xyXG4gICAgICAgIHRoaXMuZml4ZWRJdGVtcyA9IHRoaXMuZ3JpZFNldHRpbmdDb21wb25lbnRSZWYuZml4ZWRJdGVtcztcclxuXHJcblxyXG4gICAgICAgIHRoaXMuc2V0Rm9ybWF0RGF0YSgpO1xyXG4gICAgICAgIHRoaXMuYWxsQ29scyA9IHRoaXMuY29sdW1uc1swXTtcclxuICAgICAgICB0aGlzLmNoZWNrQ29sdW1uT3B0aW9ucygpO1xyXG5cclxuICAgICAgICB0aGlzLmZpbHRlckNvbHVtbnMoKTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGNoZWNrQ29sdW1uT3B0aW9ucygpIHtcclxuICAgICAgICBpZiAodGhpcy5hY3RpdmVGaWVsZCkge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5hY3RpdmVGaWVsZC5hbGxvd0dyb3VwaW5nID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuYWN0aXZlRmllbGQuYWxsb3dHcm91cGluZyA9IHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmICh0aGlzLmFjdGl2ZUZpZWxkLmdyb3VwRm9vdGVyID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuYWN0aXZlRmllbGQuZ3JvdXBGb290ZXIgPSB7IG9wdGlvbnM6IHtjYWxjdWxhdGlvblR5cGU6IC0xfSB9O1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5hY3RpdmVGaWVsZC5ncm91cEZvb3Rlci5vcHRpb25zID0gdGhpcy5hY3RpdmVGaWVsZC5ncm91cEZvb3Rlci5vcHRpb25zIHx8IHtjYWxjdWxhdGlvblR5cGU6IC0xfTtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmFjdGl2ZUZpZWxkLmdyb3VwRm9vdGVyLm9wdGlvbnMuY2FsY3VsYXRpb25UeXBlID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmFjdGl2ZUZpZWxkLmdyb3VwRm9vdGVyLm9wdGlvbnMuY2FsY3VsYXRpb25UeXBlID0gLTE7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmICh0aGlzLmFjdGl2ZUZpZWxkLmZvb3RlciA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmFjdGl2ZUZpZWxkLmZvb3RlciA9ICB7IG9wdGlvbnM6IHtjYWxjdWxhdGlvblR5cGU6IC0xfSB9O1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5hY3RpdmVGaWVsZC5mb290ZXIub3B0aW9ucyA9IHRoaXMuYWN0aXZlRmllbGQuZm9vdGVyLm9wdGlvbnMgfHwge2NhbGN1bGF0aW9uVHlwZTogLTF9O1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuYWN0aXZlRmllbGQuZm9vdGVyLm9wdGlvbnMuY2FsY3VsYXRpb25UeXBlID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmFjdGl2ZUZpZWxkLmZvb3Rlci5vcHRpb25zLmNhbGN1bGF0aW9uVHlwZSA9IC0xO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAoIXRoaXMuYWN0aXZlRmllbGQuZml4ZWQgfHwgKHRoaXMuYWN0aXZlRmllbGQuZml4ZWQgIT09ICdsZWZ0JyAmJiB0aGlzLmFjdGl2ZUZpZWxkLmZpeGVkICE9PSAncmlnaHQnKSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5hY3RpdmVGaWVsZC5maXhlZCA9ICdVTkZJWEVEJztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyDmoLnmja7liJfnmoTnsbvlnovov5vooYznrZvpgInov4fmu6TvvIxcclxuICAgIC8vIGFsbCDmiYDmnInliJdcclxuICAgIC8vIHZpc2libGUg5Y+v6KeB5YiXXHJcbiAgICAvLyBoaWRkZW4g6ZqQ6JeP5YiXXHJcbiAgICAvLyBncm91cCDliIbnu4TliJdcclxuICAgIGZpbHRlckNvbHVtbnMoIHNlYXJjaFdvcmRzID0gJycpIHtcclxuICAgICAgICBsZXQgY29scyA9IFtdO1xyXG4gICAgIFxyXG4gICAgICAgIGlmICh0aGlzLnN3aXRjaFZhbHVlKSB7XHJcbiAgICAgICAgICAgIGNvbHMgPSB0aGlzLmNvbHVtbnNbMF0uZmlsdGVyKG4gPT4gdGhpcy5maWVsZHMuaW5kZXhPZihuLmZpZWxkKSA+IC0xKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBjb2xzID0gdGhpcy5jb2x1bW5zWzBdO1xyXG4gICAgICAgIH1cclxuXHJcblxyXG4gICAgICAgIGlmIChzZWFyY2hXb3Jkcykge1xyXG4gICAgICAgICAgICBjb2xzID0gY29scy5maWx0ZXIoYyA9PiBjLnRpdGxlLnRvTG93ZXJDYXNlKCkuaW5kZXhPZihzZWFyY2hXb3JkcykgPiAtMSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLmFsbENvbHMgPSBjb2xzO1xyXG4gICAgICAgIHRoaXMuX3NlYXJjaFJlc3VsdCA9IHRoaXMuc2VhY2hSZXN1bHRJc0NoZWNrQWxsKHRoaXMuYWxsQ29scy5maWx0ZXIobiA9PiBuLnZpc2libGUpKTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIHNlYWNoUmVzdWx0SXNDaGVja0FsbChzZWFyY2hGaWVsZHM/OiBhbnkpIHtcclxuICAgICAgICBjb25zdCBhbGxDb2xzTGVuZ3RoID0gdGhpcy5hbGxDb2xzLmZpbHRlcihuID0+IG4uZmllbGQgIT0gJ19kYXRhZ3JpZC1zZXR0aW5nLWNvbnRyb2xfJykubGVuZ3RoO1xyXG4gICAgICAgIGxldCBmaWVsZHNMZW5ndGggPSB0aGlzLmZpZWxkcy5maWx0ZXIobiA9PiBuICE9ICAnX2RhdGFncmlkLXNldHRpbmctY29udHJvbF8nKS5sZW5ndGg7XHJcblxyXG4gICAgICAgIGlmIChzZWFyY2hGaWVsZHMpIHtcclxuICAgICAgICAgICAgZmllbGRzTGVuZ3RoID0gc2VhcmNoRmllbGRzLmxlbmd0aDtcclxuICAgICAgICB9XHJcblxyXG5cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBjaGVja0FsbDogYWxsQ29sc0xlbmd0aCAmJiBhbGxDb2xzTGVuZ3RoID09PSBmaWVsZHNMZW5ndGgsXHJcbiAgICAgICAgICAgIHVuQ2hlY2tBbGw6IXNlYXJjaEZpZWxkcyA/ICF0aGlzLmZpZWxkcy5sZW5ndGggOiAhZmllbGRzTGVuZ3RoXHJcbiAgICAgICAgfTtcclxuICAgIH1cclxuXHJcbiAgICBvbkZpZWxkQ2xpY2soY29sLCAkZXZlbnQpIHtcclxuICAgICAgICB0aGlzLmFjdGl2ZUZpZWxkID0gY29sO1xyXG4gICAgICAgIHRoaXMuY2hlY2tDb2x1bW5PcHRpb25zKCk7XHJcbiAgICB9XHJcblxyXG5cclxuICAgIHByaXZhdGUgb25GaWVsZHNDaGFuZ2VkKCkge1xyXG4gICAgICAgIHRoaXMuc2V0Rm9ybWF0RGF0YSgpO1xyXG4gICAgICAgIHRoaXMuZmllbGRzQ2hhbmdlLmVtaXQodGhpcy5maWVsZHMpO1xyXG4gICAgfVxyXG5cclxuICAgIG9uRGJsQ2xpY2soJGV2ZW50LCBjb2wpIHtcclxuICAgICAgICAkZXZlbnQudGFyZ2V0LnN0eWxlLnVzZXJTZWxlY3QgPSAnbm9uZSc7XHJcbiAgICAgICAgdGhpcy5vbkNoZWNrYm94Q2xpY2soJGV2ZW50LCBjb2wpO1xyXG4gICAgICAgICRldmVudC50YXJnZXQuc3R5bGUudXNlclNlbGVjdCA9ICcnO1xyXG4gICAgfVxyXG5cclxuICAgIG9uQ2hlY2tib3hDbGljaygkZXZlbnQsIGNvbCkge1xyXG4gICAgICAgICRldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICBjb25zdCBpbmRleCA9IHRoaXMuZmllbGRzLmluZGV4T2YoY29sLmZpZWxkKTtcclxuICAgICAgICBpZiAoaW5kZXggPT09IC0xKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZmllbGRzLnB1c2goY29sLmZpZWxkKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLmZpZWxkcy5zcGxpY2UoaW5kZXgsIDEpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5jb2x1bW5zWzBdLmZvckVhY2goZiA9PiB7XHJcbiAgICAgICAgICAgIGYudmlzaWJsZSA9IHRoaXMuZmllbGRzLmluZGV4T2YoZi5maWVsZCkgPiAtMTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgdGhpcy5maWVsZHMgPSB0aGlzLmNvbHVtbnNbMF0uZmlsdGVyKG4gPT4gbi52aXNpYmxlKS5tYXAobiA9PiBuLmZpZWxkKTtcclxuXHJcbiAgICAgICAgY29uc3QgX2ZpZWxkcyA9IHRoaXMuYWxsQ29scy5maWx0ZXIobiA9PiBuLnZpc2libGUpLm1hcChuID0+IG4uZmllbGQpO1xyXG4gICAgICAgIHRoaXMuX3NlYXJjaFJlc3VsdCA9IHRoaXMuc2VhY2hSZXN1bHRJc0NoZWNrQWxsKF9maWVsZHMpO1xyXG4gICAgICBcclxuICAgICAgICB0aGlzLm9uRmllbGRzQ2hhbmdlZCgpO1xyXG4gICAgfVxyXG5cclxuICAgIHNlYXJjaENvbHVtbigkZXZlbnQpIHtcclxuICAgICAgICB0aGlzLnN3aXRjaFZhbHVlID0gZmFsc2U7XHJcbiAgICAgICAgY29uc3QgdHh0ID0gJGV2ZW50LnRhcmdldC52YWx1ZTtcclxuICAgICAgICB0aGlzLmZpbHRlckNvbHVtbnModHh0KTtcclxuICAgIH1cclxuXHJcbiAgICBvbkZpZWxkRHJvcChmaWVsZEluZm8sIHR4dCwgdWxFbFJlZjogYW55KSB7XHJcbiAgICAgICAgY29uc3QgeyByZW1vdmVkSW5kZXgsIGFkZGVkSW5kZXggfSA9IGZpZWxkSW5mbztcclxuXHJcbiAgICAgICAgY29uc3QgbW92ZUl0ZW0gPSB0aGlzLmFsbENvbHNbcmVtb3ZlZEluZGV4XTtcclxuICAgICAgICBjb25zdCB0YXJnZXRJdGVtID0gdGhpcy5hbGxDb2xzW2FkZGVkSW5kZXhdO1xyXG5cclxuICAgICAgICBjb25zdCBtb3ZlSXRlbUluZGV4ID0gdGhpcy5jb2x1bW5zWzBdLmZpbmRJbmRleChuID0+IG4uZmllbGQgPT09IG1vdmVJdGVtLmZpZWxkKTtcclxuICAgICAgICBjb25zdCB0YXJnZXRJdGVtSW5kZXggPSB0aGlzLmNvbHVtbnNbMF0uZmluZEluZGV4KG4gPT4gbi5maWVsZCA9PT0gdGFyZ2V0SXRlbS5maWVsZCk7XHJcblxyXG4gICAgICAgIGNvbnN0IHJlbW92ZWRJdGVtID0gdGhpcy5jb2x1bW5zWzBdLnNwbGljZShtb3ZlSXRlbUluZGV4LCAxKTtcclxuICAgICAgICB0aGlzLmNvbHVtbnNbMF0uc3BsaWNlKHRhcmdldEl0ZW1JbmRleCwgMCwgLi4ucmVtb3ZlZEl0ZW0pO1xyXG5cclxuICAgICAgICB0aGlzLmZpZWxkcyA9IHRoaXMuY29sdW1uc1swXS5maWx0ZXIobiA9PiBuLnZpc2libGUpLm1hcChuID0+IG4uZmllbGQpO1xyXG4gICAgICAgIHRoaXMub25GaWVsZHNDaGFuZ2VkKCk7XHJcblxyXG4gICAgICAgIHRoaXMuZmlsdGVyQ29sdW1ucyh0eHQpO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIDA6IDHkuKrkuZ/msqHmnInpgInkuK3vvJsgMTog5YWo6YOo6YCJ5Lit77ybIDI6IOaciemAieS4reeahOS5n+acieayoemAieS4reeahFxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIGdldENoZWNrQWxsU3RhdGUoc2VhcmNoID0gZmFsc2UpIHtcclxuICAgICAgICBpZiAodGhpcy5maWVsZHMubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAwO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGlmIChzZWFyY2gpIHtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9zZWFyY2hSZXN1bHQuY2hlY2tBbGwpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gMTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmZpZWxkcy5sZW5ndGggPT09IHRoaXMuY29sdW1uc1swXS5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gMTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gMjtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgb25DaGVja0FsbENsaWNrKCRldmVudCwgdHh0KSB7XHJcbiAgICAgICAgaWYgKCF0aGlzLmFsbENvbHMgfHwgIXRoaXMuYWxsQ29scy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCBzdGF0ZSA9IHRoaXMuZ2V0Q2hlY2tBbGxTdGF0ZSh0eHQpO1xyXG4gICAgICAgIGNvbnN0IGlzVmlzaWJsZSA9IHN0YXRlID09PSAwIHx8IHN0YXRlID09PSAyO1xyXG4gICAgICAgIGxldCBfZmllbGRzID0gbnVsbDtcclxuICAgICAgICBpZiAodHh0ID09ICcnKSB7XHJcbiAgICAgICAgICAgIGlmIChpc1Zpc2libGUpIHtcclxuICAgICAgICAgICAgICAgIC8vIOaJp+ihjOWFqOmAiVxyXG4gICAgICAgICAgICAgICAgdGhpcy5jb2x1bW5zWzBdLmZvckVhY2gobiA9PiBuLnZpc2libGUgPSB0cnVlKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuZmllbGRzID0gdGhpcy5jb2x1bW5zWzBdLm1hcChuID0+IG4uZmllbGQpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgLy8g5Y+W5raI5YWo6YCJXHJcbiAgICAgICAgICAgICAgICB0aGlzLmNvbHVtbnNbMF0uZm9yRWFjaChuID0+IG4udmlzaWJsZSA9IGZhbHNlKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuZmllbGRzID0gW107XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLmFsbENvbHMuZm9yRWFjaChjID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGNvbCA9IHRoaXMuY29sdW1uc1swXS5maW5kKG4gPT4gYy5maWVsZCA9PT0gbi5maWVsZCk7XHJcbiAgICAgICAgICAgICAgICBjb2wudmlzaWJsZSA9IGlzVmlzaWJsZTtcclxuICAgICAgICAgICAgICAgIGMudmlzaWJsZSA9IGlzVmlzaWJsZTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIF9maWVsZHMgPSB0aGlzLmFsbENvbHMuZmlsdGVyKG4gPT4gbi52aXNpYmxlKS5tYXAobiA9PiBuLmZpZWxkKTtcclxuICAgICAgICAgICAgdGhpcy5maWVsZHMgPSB0aGlzLmNvbHVtbnNbMF0uZmlsdGVyKG4gPT4gbi52aXNpYmxlKS5tYXAobiA9PiBuLmZpZWxkKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5fc2VhcmNoUmVzdWx0ID0gdGhpcy5zZWFjaFJlc3VsdElzQ2hlY2tBbGwoIXR4dCA/IG51bGw6IF9maWVsZHMpO1xyXG4gICAgICAgIHRoaXMuY2QuZGV0ZWN0Q2hhbmdlcygpO1xyXG4gICAgICAgIHRoaXMub25GaWVsZHNDaGFuZ2VkKCk7XHJcbiAgICAgICAgLy8gdGhpcy5maWx0ZXJDb2x1bW5zKHR4dCk7XHJcbiAgICB9XHJcblxyXG4gICAgIC8vIOS7heaYvuekuuWPr+ingeWIl1xyXG4gICAgIG9ubHlTZWVWaXNpYmxlQ29sdW1ucygkZXZlbnQsIHR4dCkge1xyXG4gICAgICAgIHRoaXMuc3dpdGNoVmFsdWUgPSAkZXZlbnQ7XHJcbiAgICAgICAgdGhpcy5maWx0ZXJDb2x1bW5zKHR4dCk7XHJcbiAgICB9XHJcblxyXG4gICAgY2xlYXJTZWFyY2goJGV2ZW50LCBzZWFyY2hJbnB1dCkge1xyXG4gICAgICAgIGlmIChzZWFyY2hJbnB1dCAmJiBzZWFyY2hJbnB1dC52YWx1ZSkge1xyXG4gICAgICAgICAgICB0aGlzLmZpbHRlckNvbHVtbnMoJycpO1xyXG4gICAgICAgICAgICBzZWFyY2hJbnB1dC52YWx1ZSA9ICcnO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBvbk5vZGVTZWxlY3RlZCgkZXZlbnQ6IFJvd05vZGUpIHtcclxuICAgICAgICBpZiAoJGV2ZW50ICYmICRldmVudC5ub2RlLmlkICE9PSBcIl9fSE9VX1hVQU5fTElFX0lEX19cIikge1xyXG4gICAgICAgICAgICB0aGlzLmFjdGl2ZUZpZWxkID0gJGV2ZW50Lm5vZGUuZGF0YTtcclxuICAgICAgICAgICAgdGhpcy5zZWxlY3RUcmVlTm9kZSA9ICRldmVudC5ub2RlO1xyXG4gICAgICAgICAgICB0aGlzLmNoZWNrQ29sdW1uT3B0aW9ucygpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuYWN0aXZlRmllbGQgPSBudWxsO1xyXG4gICAgICAgICAgICB0aGlzLnNlbGVjdFRyZWVOb2RlID0gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0TXVsdGlIZWFkZXJzKCk6IHtcclxuICAgICAgICB2aWV3Q29sczogYW55W107XHJcbiAgICAgICAgdHJlZURhdGE6IGFueVtdO1xyXG4gICAgfSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZ3JvdXBIZWFkZXJzUmVmPyB0aGlzLmdyb3VwSGVhZGVyc1JlZi5nZXRTZXR0aW5ncygpIDogbnVsbDtcclxuICAgIH1cclxufVxyXG4iXX0=