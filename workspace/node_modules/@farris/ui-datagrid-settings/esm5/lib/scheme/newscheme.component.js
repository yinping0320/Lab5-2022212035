/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
import { ChangeDetectorRef, Component, ElementRef, EventEmitter, Input, Output, ViewChild, ViewEncapsulation } from '@angular/core';
var NewSchemeComponent = /** @class */ (function () {
    function NewSchemeComponent(cd) {
        this.cd = cd;
        this.dataPermissionIds = [];
        this.closeModal = new EventEmitter();
        this.submitModal = new EventEmitter();
        this.checkAuthority = new EventEmitter();
        this.schemeInfo = {
            name: '',
            isDefault: false,
            type: 'private',
            orgids: ''
        };
        this.schemeType = 'private';
        this.noPublicAuthority = false;
        this.noOrgAuthority = false;
        this.languages = [{ code: 'zh-CHS', name: '中文简体', default: true }, { code: 'en', name: 'English' }, { code: 'zh-CHT', name: '中文繁体' }];
        this.nameMaxLength = { 'zh-CHS': 9, 'zh-CHT': 9, en: 20 };
    }
    /**
     * @return {?}
     */
    NewSchemeComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
    };
    /**
     * @param {?} $event
     * @return {?}
     */
    NewSchemeComponent.prototype.close = /**
     * @param {?} $event
     * @return {?}
     */
    function ($event) {
        this.closeModal.emit();
    };
    /**
     * @param {?} $event
     * @return {?}
     */
    NewSchemeComponent.prototype.submit = /**
     * @param {?} $event
     * @return {?}
     */
    function ($event) {
        this.submitModal.emit(this.schemeInfo);
    };
    /**
     * @param {?} $event
     * @return {?}
     */
    NewSchemeComponent.prototype.onCancelClick = /**
     * @param {?} $event
     * @return {?}
     */
    function ($event) {
        this.close($event);
    };
    /**
     * @param {?} $event
     * @return {?}
     */
    NewSchemeComponent.prototype.onSelectedOrg = /**
     * @param {?} $event
     * @return {?}
     */
    function ($event) {
        if ($event.selections && $event.selections.length) {
            /** @type {?} */
            var orgids = $event.selections.map((/**
             * @param {?} n
             * @return {?}
             */
            function (n) { return n.orgId; }));
            this.schemeInfo.orgids = orgids;
        }
    };
    /**
     * @param {?} $event
     * @param {?} val
     * @return {?}
     */
    NewSchemeComponent.prototype.onSetRangeType = /**
     * @param {?} $event
     * @param {?} val
     * @return {?}
     */
    function ($event, val) {
        $event.stopPropagation();
        this.schemeType = val;
        if (val === 'public' || val === 'org') {
            this.checkAuthority.emit({ value: val, schemeInfo: this.schemeInfo });
        }
        else {
            this.schemeInfo.type = val;
        }
    };
    /**
     * @param {?=} hasAuthority
     * @return {?}
     */
    NewSchemeComponent.prototype.refresh = /**
     * @param {?=} hasAuthority
     * @return {?}
     */
    function (hasAuthority) {
        if (hasAuthority === void 0) { hasAuthority = { public: true, org: true }; }
        this.schemeInfo = tslib_1.__assign({}, this.schemeInfo);
        this.schemeType = this.schemeInfo.type;
        this.noPublicAuthority = !hasAuthority.public;
        this.noOrgAuthority = !hasAuthority.org;
        this.cd.detectChanges();
    };
    /**
     * @param {?} $event
     * @return {?}
     */
    NewSchemeComponent.prototype.getSelectedId = /**
     * @param {?} $event
     * @return {?}
     */
    function ($event) {
        if ($event.selections && $event.selections.length) {
            this.schemeInfo.orgids = $event.selections.map((/**
             * @param {?} n
             * @return {?}
             */
            function (n) { return n.orgId; }));
        }
        else {
            this.schemeInfo.orgids = '';
        }
    };
    /**
     * @return {?}
     */
    NewSchemeComponent.prototype.clearAllOrgs = /**
     * @return {?}
     */
    function () {
        this.schemeInfo.orgids = '';
    };
    NewSchemeComponent.decorators = [
        { type: Component, args: [{
                    selector: 'new-scheme',
                    template: "\r\n\r\n\r\n<div class=\"f-datagrid-save-scheme d-flex flex-column\" style=\"height: 100%;\">\r\n\r\n    <div class=\"d-flex justify-content-between header\" #header >\r\n        <div class=\"title\">{{'datagrid-scheme.saveTitle' | locale}}</div>\r\n        <div class=\"close\" style=\"margin-right: 20px;\">\r\n            <span class=\"f-icon modal_close\" (click)=\"close($event)\"></span>\r\n        </div>\r\n    </div>\r\n\r\n    <div class=\"f-utils-fill  mx-3 p-3 mt-1\" >\r\n        <!-- <div class=\"input-group mb-3 scheme-manager__search-box\">\r\n            <input #schemeName type=\"text\" class=\"form-control\" maxlength=\"9\" placeholder=\"{{'datagrid-scheme.namePlaceholder' | locale}}\" style=\"height: 26px;\" name=\"name\" [(ngModel)]=\"schemeInfo.name\">\r\n        </div> -->\r\n        <div class=\" mb-3\">\r\n            <language-textbox [(ngModel)]=\"schemeInfo.name\" [editable]=\"true\" [languages]=\"languages\" [maxWords]=\"nameMaxLength\"></language-textbox>\r\n        </div>\r\n            \r\n    \r\n        <div class=\"input-group mb-2\" style=\"border: 0;\">\r\n          \r\n            <div class=\"custom-control custom-radio  custom-control-inline \" style=\"align-items: center\">\r\n                <input class=\"custom-control-input\" type=\"radio\" id=\"private-scheme\"  name=\"schemeType\"  (click)=\"onSetRangeType($event, 'private')\" value=\"private\" [checked]=\"schemeType === 'private'\">\r\n                <label class=\"custom-control-label\" for=\"private-scheme\">{{'datagrid-scheme.setPrivate' | locale}}</label>\r\n                <span class=\"icon-question\" farrisTooltip [zIndex]=\"2040\" [placement]=\"'right'\" [delay]=\"500\" [content]=\"'datagrid-scheme.privateTip' | locale\">?</span>\r\n            </div>\r\n            <div class=\"custom-control custom-radio  custom-control-inline \" style=\"align-items: center\">\r\n                <input class=\"custom-control-input\" type=\"radio\" id=\"public-scheme\" name=\"schemeType\" (click)=\"onSetRangeType($event, 'public')\" value=\"public\" [checked]=\"schemeType === 'public'\" >\r\n                <label class=\"custom-control-label\" for=\"public-scheme\">{{'datagrid-scheme.setPublic' | locale}}</label>\r\n                <span class=\"icon-question\" farrisTooltip [zIndex]=\"2040\" [placement]=\"'right'\" [delay]=\"500\" [content]=\"'datagrid-scheme.publicTip' | locale\">?</span>\r\n            </div>\r\n            <div class=\"custom-control custom-radio  custom-control-inline \" style=\"align-items: center\">\r\n                <input class=\"custom-control-input\" type=\"radio\" id=\"org-scheme\" name=\"schemeType\" (click)=\"onSetRangeType($event, 'org')\"  value=\"org\" [checked]=\"schemeType === 'org'\" >\r\n                <label class=\"custom-control-label\" for=\"org-scheme\">{{'datagrid-scheme.setOrg' | locale}}</label>\r\n                <span class=\"icon-question\" farrisTooltip [zIndex]=\"2040\" [placement]=\"'right'\" [delay]=\"500\" [content]=\"'datagrid-scheme.orgTip' | locale\">?</span>\r\n            </div>\r\n        </div>\r\n        <div class=\"input-group mb-2\" style=\"border: 0;\" *ngIf=\"schemeInfo.type === 'private'\">\r\n            <div class=\"custom-control custom-checkbox  custom-control-inline \" style=\"align-items: center\">\r\n                <input class=\"custom-control-input\" type=\"checkbox\" id=\"default-scheme\" name=\"isDefault\" [(ngModel)]=\"schemeInfo.isDefault\">\r\n                <label class=\"custom-control-label\" for=\"default-scheme\">{{'datagrid-scheme.setDefault' | locale}} <i class=\"scheme-org-tip\">({{'datagrid-scheme.defaultTip' | locale}})</i></label>\r\n                <!-- <span class=\"icon-question\" farrisTooltip [placement]=\"'right'\" [delay]=\"500\" [content]=\"'\u4E0B\u6B21\u8FDB\u5165\u6B64\u529F\u80FD\u65F6\uFF0C\u9ED8\u8BA4\u52A0\u8F7D\u8BE5\u65B9\u6848'\">?</span> -->\r\n            </div>\r\n        </div>\r\n\r\n        <div class=\"input-group mb-2\" style=\"border: 0;\" *ngIf=\"schemeInfo.type === 'org' && !noOrgAuthority\">\r\n            <div class=\"input-group mb-3\">\r\n                <farris-organization-selector\r\n                    [primaryField]=\"'orgId'\" [displayField]=\"'name'\"\r\n                    [absOrgType]=\"'System_organization'\"\r\n                    [layer]=\"1\" [multiSelect]=\"true\" [showTabIds]=\"'organization'\"\r\n                    [enableHierarchicalLoading]=\"true\" \r\n                    [cascadeCheck]=\"true\" [cascadeDown]=\"true\"\r\n                    (selectionsChange)=\"onSelectedOrg($event)\"\r\n                    [cascadeUp]=\"false\"\r\n                    [orgIds]=\"dataPermissionIds\"\r\n                    (inputClear)=\"clearAllOrgs()\" (tagRemoved)=\"getSelectedId($event)\"\r\n                    [dataPermission]=\"true\" [dataPermissionIds]=\"dataPermissionIds\" \r\n                ></farris-organization-selector>\r\n            </div>\r\n        </div>\r\n    </div>\r\n\r\n    <div class=\"p-3 mb-3\" style=\"height: 50px;text-align: right;\">\r\n        <button class=\"btn btn-secondary cancel btn-lg mr-3\" style=\"width: 70px\"\r\n            (click)=\"onCancelClick($event)\">{{'datagrid.settings.cancel' | locale}}</button>\r\n        <button class=\"btn btn-primary ok btn-lg\" style=\"width: 70px\"\r\n            (click)=\"submit($event)\">{{'datagrid.settings.ok' | locale}}</button>\r\n    </div>\r\n\r\n</div>",
                    encapsulation: ViewEncapsulation.None
                }] }
    ];
    /** @nocollapse */
    NewSchemeComponent.ctorParameters = function () { return [
        { type: ChangeDetectorRef }
    ]; };
    NewSchemeComponent.propDecorators = {
        header: [{ type: ViewChild, args: ['header',] }],
        dataPermissionIds: [{ type: Input }],
        closeModal: [{ type: Output }],
        submitModal: [{ type: Output }],
        checkAuthority: [{ type: Output }]
    };
    return NewSchemeComponent;
}());
export { NewSchemeComponent };
if (false) {
    /** @type {?} */
    NewSchemeComponent.prototype.header;
    /** @type {?} */
    NewSchemeComponent.prototype.dataPermissionIds;
    /** @type {?} */
    NewSchemeComponent.prototype.closeModal;
    /** @type {?} */
    NewSchemeComponent.prototype.submitModal;
    /** @type {?} */
    NewSchemeComponent.prototype.checkAuthority;
    /** @type {?} */
    NewSchemeComponent.prototype.schemeInfo;
    /** @type {?} */
    NewSchemeComponent.prototype.schemeType;
    /** @type {?} */
    NewSchemeComponent.prototype.noPublicAuthority;
    /** @type {?} */
    NewSchemeComponent.prototype.noOrgAuthority;
    /** @type {?} */
    NewSchemeComponent.prototype.languages;
    /** @type {?} */
    NewSchemeComponent.prototype.nameMaxLength;
    /**
     * @type {?}
     * @private
     */
    NewSchemeComponent.prototype.cd;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibmV3c2NoZW1lLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BmYXJyaXMvdWktZGF0YWdyaWQtc2V0dGluZ3MvIiwic291cmNlcyI6WyJsaWIvc2NoZW1lL25ld3NjaGVtZS5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQSxPQUFPLEVBQUUsaUJBQWlCLEVBQUUsU0FBUyxFQUFFLFVBQVUsRUFBRSxZQUFZLEVBQUUsS0FBSyxFQUFVLE1BQU0sRUFBRSxTQUFTLEVBQUUsaUJBQWlCLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFFNUk7SUE4QkksNEJBQW9CLEVBQXFCO1FBQXJCLE9BQUUsR0FBRixFQUFFLENBQW1CO1FBckJoQyxzQkFBaUIsR0FBRyxFQUFFLENBQUM7UUFFdEIsZUFBVSxHQUFHLElBQUksWUFBWSxFQUFFLENBQUM7UUFDaEMsZ0JBQVcsR0FBRyxJQUFJLFlBQVksRUFBRSxDQUFDO1FBQ2pDLG1CQUFjLEdBQUcsSUFBSSxZQUFZLEVBQUUsQ0FBQztRQUU5QyxlQUFVLEdBQUc7WUFDVCxJQUFJLEVBQUUsRUFBRTtZQUNSLFNBQVMsRUFBRSxLQUFLO1lBQ2hCLElBQUksRUFBRSxTQUFTO1lBQ2YsTUFBTSxFQUFFLEVBQUU7U0FDYixDQUFBO1FBRUQsZUFBVSxHQUFHLFNBQVMsQ0FBQztRQUV2QixzQkFBaUIsR0FBRyxLQUFLLENBQUM7UUFDMUIsbUJBQWMsR0FBRyxLQUFLLENBQUM7UUFFdkIsY0FBUyxHQUFHLENBQUMsRUFBRSxJQUFJLEVBQUUsUUFBUSxFQUFFLElBQUksRUFBRSxNQUFNLEVBQUUsT0FBTyxFQUFFLElBQUksRUFBRSxFQUFDLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsU0FBUyxFQUFFLEVBQUMsRUFBRSxJQUFJLEVBQUUsUUFBUSxFQUFFLElBQUksRUFBRSxNQUFNLEVBQUMsQ0FBQyxDQUFDO1FBQzlILGtCQUFhLEdBQUcsRUFBRSxRQUFRLEVBQUUsQ0FBQyxFQUFF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U3JCLFNBQVMsU0FBQyxRQUFRO29DQUVsQixLQUFLOzZCQUVMLE1BQU07OEJBQ04sTUFBTTtpQ0FDTixNQUFNOztJQXNFWCx5QkFBQztDQUFBLEFBbkZELElBbUZDO1NBOUVZLGtCQUFrQjs7O0lBRTNCLG9DQUE2Qzs7SUFFN0MsK0NBQWdDOztJQUVoQyx3Q0FBMEM7O0lBQzFDLHlDQUEyQzs7SUFDM0MsNENBQThDOztJQUU5Qyx3Q0FLQzs7SUFFRCx3Q0FBdUI7O0lBRXZCLCtDQUEwQjs7SUFDMUIsNENBQXVCOztJQUV2Qix1Q0FBOEg7O0lBQzlILDJDQUFxRDs7Ozs7SUFFekMsZ0NBQTZCIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ2hhbmdlRGV0ZWN0b3JSZWYsIENvbXBvbmVudCwgRWxlbWVudFJlZiwgRXZlbnRFbWl0dGVyLCBJbnB1dCwgT25Jbml0LCBPdXRwdXQsIFZpZXdDaGlsZCwgVmlld0VuY2Fwc3VsYXRpb24gfSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuXHJcbkBDb21wb25lbnQoe1xyXG4gICAgc2VsZWN0b3I6ICduZXctc2NoZW1lJyxcclxuICAgIHRlbXBsYXRlVXJsOiAnLi9uZXdzY2hlbWUuY29tcG9uZW50Lmh0bWwnLFxyXG4gICAgZW5jYXBzdWxhdGlvbjogVmlld0VuY2Fwc3VsYXRpb24uTm9uZVxyXG59KVxyXG5leHBvcnQgY2xhc3MgTmV3U2NoZW1lQ29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0IHtcclxuXHJcbiAgICBAVmlld0NoaWxkKCdoZWFkZXInKSBoZWFkZXI6IEVsZW1lbnRSZWY8YW55PjtcclxuXHJcbiAgICBASW5wdXQoKSBkYXRhUGVybWlzc2lvbklkcyA9IFtdO1xyXG5cclxuICAgIEBPdXRwdXQoKSBjbG9zZU1vZGFsID0gbmV3IEV2ZW50RW1pdHRlcigpO1xyXG4gICAgQE91dHB1dCgpIHN1Ym1pdE1vZGFsID0gbmV3IEV2ZW50RW1pdHRlcigpO1xyXG4gICAgQE91dHB1dCgpIGNoZWNrQXV0aG9yaXR5ID0gbmV3IEV2ZW50RW1pdHRlcigpO1xyXG5cclxuICAgIHNjaGVtZUluZm8gPSB7XHJcbiAgICAgICAgbmFtZTogJycsXHJcbiAgICAgICAgaXNEZWZhdWx0OiBmYWxzZSxcclxuICAgICAgICB0eXBlOiAncHJpdmF0ZScsXHJcbiAgICAgICAgb3JnaWRzOiAnJ1xyXG4gICAgfVxyXG5cclxuICAgIHNjaGVtZVR5cGUgPSAncHJpdmF0ZSc7XHJcblxyXG4gICAgbm9QdWJsaWNBdXRob3JpdHkgPSBmYWxzZTtcclxuICAgIG5vT3JnQXV0aG9yaXR5ID0gZmFsc2U7XHJcblxyXG4gICAgbGFuZ3VhZ2VzID0gW3sgY29kZTogJ3poLUNIUycsIG5hbWU6ICfkuK3mlofnroDkvZMnLCBkZWZhdWx0OiB0cnVlIH0seyBjb2RlOiAnZW4nLCBuYW1lOiAnRW5nbGlzaCcgfSx7IGNvZGU6ICd6aC1DSFQnLCBuYW1lOiAn5Lit5paH57mB5L2TJ31dO1xyXG4gICAgbmFtZU1heExlbmd0aCA9IHsgJ3poLUNIUyc6IDksICd6aC1DSFQnOiA5LCBlbjogMjAgfTtcclxuICAgIFxyXG4gICAgY29uc3RydWN0b3IocHJpdmF0ZSBjZDogQ2hhbmdlRGV0ZWN0b3JSZWYpIHsgfVxyXG5cclxuICAgIG5nT25Jbml0KCk6IHZvaWQge1xyXG4gICAgfVxyXG5cclxuICAgIGNsb3NlKCRldmVudCkge1xyXG4gICAgICAgIHRoaXMuY2xvc2VNb2RhbC5lbWl0KCk7XHJcbiAgICB9XHJcblxyXG4gICAgc3VibWl0KCRldmVudCkge1xyXG4gICAgICAgIHRoaXMuc3VibWl0TW9kYWwuZW1pdCh0aGlzLnNjaGVtZUluZm8pO1xyXG4gICAgfVxyXG5cclxuICAgIG9uQ2FuY2VsQ2xpY2soJGV2ZW50KSB7XHJcbiAgICAgICAgdGhpcy5jbG9zZSgkZXZlbnQpO1xyXG4gICAgfVxyXG5cclxuICAgIG9uU2VsZWN0ZWRPcmcoJGV2ZW50KSB7XHJcbiAgICAgICAgaWYgKCRldmVudC5zZWxlY3Rpb25zICYmICRldmVudC5zZWxlY3Rpb25zLmxlbmd0aCApIHtcclxuICAgICAgICAgICAgbGV0IG9yZ2lkcyA9ICRldmVudC5zZWxlY3Rpb25zLm1hcChuID0+IG4ub3JnSWQpO1xyXG4gICAgICAgICAgICB0aGlzLnNjaGVtZUluZm8ub3JnaWRzID0gb3JnaWRzO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBvblNldFJhbmdlVHlwZSgkZXZlbnQ6IE1vdXNlRXZlbnQsIHZhbCkge1xyXG4gICAgICAgICRldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICB0aGlzLnNjaGVtZVR5cGUgPSB2YWw7XHJcbiAgICAgICAgaWYgKHZhbCA9PT0gJ3B1YmxpYycgfHwgdmFsID09PSAnb3JnJykge1xyXG4gICAgICAgICAgICB0aGlzLmNoZWNrQXV0aG9yaXR5LmVtaXQoeyB2YWx1ZTogdmFsLCBzY2hlbWVJbmZvOiB0aGlzLnNjaGVtZUluZm8gfSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5zY2hlbWVJbmZvLnR5cGUgPSB2YWw7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHJlZnJlc2goaGFzQXV0aG9yaXR5ID0geyBwdWJsaWM6IHRydWUsIG9yZzogdHJ1ZSB9KSB7XHJcbiAgICAgICAgdGhpcy5zY2hlbWVJbmZvID0gey4uLnRoaXMuc2NoZW1lSW5mb307XHJcbiAgICAgICAgdGhpcy5zY2hlbWVUeXBlID0gdGhpcy5zY2hlbWVJbmZvLnR5cGU7XHJcbiAgICAgICAgdGhpcy5ub1B1YmxpY0F1dGhvcml0eSA9ICFoYXNBdXRob3JpdHkucHVibGljO1xyXG4gICAgICAgIHRoaXMubm9PcmdBdXRob3JpdHkgPSAhaGFzQXV0aG9yaXR5Lm9yZztcclxuICAgICAgICB0aGlzLmNkLmRldGVjdENoYW5nZXMoKTtcclxuICAgIH1cclxuXHJcbiAgICBnZXRTZWxlY3RlZElkKCRldmVudCkge1xyXG4gICAgICAgIGlmICgkZXZlbnQuc2VsZWN0aW9ucyAmJiRldmVudC5zZWxlY3Rpb25zLmxlbmd0aCkge1xyXG4gICAgICAgICAgICB0aGlzLnNjaGVtZUluZm8ub3JnaWRzID0gJGV2ZW50LnNlbGVjdGlvbnMubWFwKG4gPT4gbi5vcmdJZCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5zY2hlbWVJbmZvLm9yZ2lkcyA9ICcnO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBjbGVhckFsbE9yZ3MoKSB7XHJcbiAgICAgICAgdGhpcy5zY2hlbWVJbmZvLm9yZ2lkcyA9ICcnO1xyXG4gICAgfVxyXG59XHJcbiJdfQ==