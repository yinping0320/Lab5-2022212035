/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { EventEmitter, ChangeDetectorRef, Component, Injector, Input, Output } from '@angular/core';
var DynamicViewComponent = /** @class */ (function () {
    function DynamicViewComponent(injector, cd) {
        this.injector = injector;
        this.cd = cd;
        this._value = '';
        this._data = null;
        this.previousMaxDays = 30;
        this.futureMaxDays = 30;
        this.previous_dateType = 'day';
        this.previous_days = 1;
        this.future_dateType = 'day';
        this.future_days = 1;
        this.present_first_dateType = 'month';
        this.present_last_dateType = 'month';
        this.valueChange = new EventEmitter();
    }
    Object.defineProperty(DynamicViewComponent.prototype, "value", {
        get: /**
         * @return {?}
         */
        function () {
            return this._value;
        },
        set: /**
         * @param {?} val
         * @return {?}
         */
        function (val) {
            this._value = val;
            this.valueChange.emit(val);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(DynamicViewComponent.prototype, "data", {
        get: /**
         * @return {?}
         */
        function () {
            return this._data;
        },
        set: /**
         * @param {?} val
         * @return {?}
         */
        function (val) {
            this._data = val;
            this.setValue(val);
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    DynamicViewComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () { };
    /**
     * @param {?} $event
     * @return {?}
     */
    DynamicViewComponent.prototype.onListItemFormControlClick = /**
     * @param {?} $event
     * @return {?}
     */
    function ($event) {
        /** @type {?} */
        var lbl = $event.target.closest('label');
        if (lbl) {
            lbl.click();
        }
    };
    /**
     * @param {?} val
     * @return {?}
     */
    DynamicViewComponent.prototype.setValue = /**
     * @param {?} val
     * @return {?}
     */
    function (val) {
        if (val) {
            this.value = val.name;
            switch (this.value) {
                case 'present_day': // 今天
                case 'present_month': // 本月
                case 'present_year':
                    break;
                case 'previou':
                    this.previous_dateType = val.dateType;
                    this.previous_days = val.count;
                    break;
                case 'future':
                    this.future_dateType = val.dateType;
                    this.future_days = val.count;
                    break;
                case 'present_first':
                    this.present_first_dateType = val.dateType;
                    break;
                case 'present_last':
                    this.present_last_dateType = val.dateType;
                    break;
            }
            this.cd.detectChanges();
        }
    };
    /**
     * @return {?}
     */
    DynamicViewComponent.prototype.getValue = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var val = null;
        if (this.value) {
            switch (this.value) {
                case 'present_day': // 今天
                    val = { dateType: 'day', period: 'present', count: null, isFirstDay: false, isLastDay: false };
                    break;
                case 'present_month': // 本月
                    val = { dateType: 'month', period: 'present', count: null, isFirstDay: false, isLastDay: false };
                    break;
                case 'present_year':
                    val = { dateType: 'year', period: 'present', count: null, isFirstDay: false, isLastDay: false };
                    break;
                case 'previou':
                    val = { dateType: this.previous_dateType, period: 'previous', count: this.previous_days, isFirstDay: false, isLastDay: false };
                    break;
                case 'future':
                    val = { dateType: this.future_dateType, period: 'future', count: this.future_days, isFirstDay: false, isLastDay: false };
                    break;
                case 'present_first':
                    val = { dateType: this.present_first_dateType, period: 'present', count: null, isFirstDay: true, isLastDay: false };
                    break;
                case 'present_last':
                    val = { dateType: this.present_last_dateType, period: 'present', count: null, isFirstDay: false, isLastDay: true };
                    break;
            }
            if (val) {
                val.name = this.value;
            }
        }
        return val;
    };
    /**
     * @private
     * @param {?} dt
     * @return {?}
     */
    DynamicViewComponent.prototype.getDateTypeString = /**
     * @private
     * @param {?} dt
     * @return {?}
     */
    function (dt) {
        switch (dt) {
            case 'week':
                return this.locale.week || '天';
            case 'day':
                return this.locale.day || '天';
            case 'month':
                return this.locale.month || '月';
            case 'year':
                return this.locale.year || '年';
        }
    };
    /**
     * @return {?}
     */
    DynamicViewComponent.prototype.formatValue = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var val = this.getValue();
        if (val) {
            /** @type {?} */
            var fval = '';
            switch (val.name) {
                case 'present_day': // 今天
                    fval = this.locale.today || '今天';
                    break;
                case 'present_month': // 本月
                    fval = this.locale.presentMonth || '本月';
                    break;
                case 'present_year':
                    fval = this.locale.presentYear || '本年';
                    break;
                case 'previou':
                    fval = (this.locale.previous || '过去') + ' ' + val.count + ' ' + this.getDateTypeString(val.dateType);
                    break;
                case 'future':
                    fval = (this.locale.future || '未来') + ' ' + val.count + ' ' + this.getDateTypeString(val.dateType);
                    break;
                case 'present_first':
                    fval = (this.locale.current || '本') + this.getDateTypeString(val.dateType) + (this.locale.first || '第 1 天');
                    break;
                case 'present_last':
                    fval = (this.locale.current || '本') + this.getDateTypeString(val.dateType) + (this.locale.last || '最后 1 天');
                    break;
            }
            return fval;
        }
        else {
            return '';
        }
    };
    /**
     * @private
     * @param {?} typ
     * @param {?} days
     * @return {?}
     */
    DynamicViewComponent.prototype.setDays = /**
     * @private
     * @param {?} typ
     * @param {?} days
     * @return {?}
     */
    function (typ, days) {
        if (typ === 'previous') {
            this.previous_days = days;
        }
        else {
            this.future_days = days;
        }
    };
    /**
     * @param {?} $event
     * @param {?} tye
     * @return {?}
     */
    DynamicViewComponent.prototype.checkMaxDays = /**
     * @param {?} $event
     * @param {?} tye
     * @return {?}
     */
    function ($event, tye) {
        /** @type {?} */
        var target = (/** @type {?} */ ($event.target));
        /** @type {?} */
        var val = target.value.replace(/[^\d]/g, '');
        /** @type {?} */
        var days = Number(val);
        target.value = days;
        /** @type {?} */
        var max = tye === 'previous' ? this.previousMaxDays : this.futureMaxDays;
        this.setDays(tye, days);
        if (days > max) {
            target.value = max;
            this.setDays(tye, max);
            return;
        }
        else {
            if (days < 1) {
                target.value = 1;
                this.setDays(tye, 1);
                return;
            }
        }
    };
    /**
     * @param {?} $event
     * @return {?}
     */
    DynamicViewComponent.prototype.onNumberKeydown = /**
     * @param {?} $event
     * @return {?}
     */
    function ($event) {
        $event.stopPropagation();
        if ($event.key === '.' || $event.key === '-' || $event.key === '+') {
            $event.preventDefault();
        }
    };
    DynamicViewComponent.decorators = [
        { type: Component, args: [{
                    selector: 'lib-dynamic-view',
                    template: "<div class=\"datepicker_dynamic-view\">\r\n    <ul>\r\n        <li class=\"dynamic-view-item\" [class.active]=\"value === 'present_day'\">  \r\n            <div class=\"custom-control custom-radio\">\r\n                <input class=\"custom-control-input\" type=\"radio\" name=\"dynamic_date\" id=\"radio_dynamic_today\" value=\"present_day\" tabindex=\"0\" [(ngModel)]=\"value\">\r\n                <label class=\"custom-control-label\" for=\"radio_dynamic_today\">{{locale?.today}}</label>\r\n            </div>\r\n        </li>\r\n        <!--\r\n        <li class=\"dynamic-view-item\" [class.active]=\"value === 'present_week'\">\r\n            <div class=\"custom-control custom-radio\">\r\n                <input class=\"custom-control-input\" type=\"radio\" name=\"dynamic_date\" id=\"radio_dynamic_present_week\" value=\"present_week\" tabindex=\"0\" [(ngModel)]=\"value\">\r\n                <label class=\"custom-control-label\" for=\"radio_dynamic_present_week\">\u672C\u5468</label>\r\n            </div>\r\n        </li>\r\n        -->\r\n        <li class=\"dynamic-view-item\" [class.active]=\"value === 'present_month'\">\r\n            <div class=\"custom-control custom-radio\">\r\n            <input class=\"custom-control-input\" type=\"radio\" name=\"dynamic_date\" id=\"radio_dynamic_present_month\" value=\"present_month\" tabindex=\"0\" [(ngModel)]=\"value\">\r\n            <label class=\"custom-control-label\" for=\"radio_dynamic_present_month\">{{locale?.presentMonth}}</label>\r\n        </div></li>\r\n        <li class=\"dynamic-view-item\" [class.active]=\"value === 'present_year'\">\r\n            <div class=\"custom-control custom-radio\">\r\n            <input class=\"custom-control-input\" type=\"radio\" name=\"dynamic_date\" id=\"radio_dynamic_present_year\" value=\"present_year\" tabindex=\"0\" [(ngModel)]=\"value\">\r\n            <label class=\"custom-control-label\" for=\"radio_dynamic_present_year\">{{locale?.presentYear}}</label>\r\n        </div></li>\r\n        <li class=\"dynamic-view-item\" [class.active]=\"value === 'previou'\">\r\n            <div class=\"custom-control custom-radio\">\r\n                <input class=\"custom-control-input\" type=\"radio\" name=\"dynamic_date\" id=\"radio_dynamic_previou\" value=\"previou\" tabindex=\"0\" [(ngModel)]=\"value\">\r\n                <label class=\"custom-control-label\" for=\"radio_dynamic_previou\">\r\n                    {{locale?.previous}} <input type=\"number\" [ngModel]=\"previous_days\" name=\"previous_days\" \r\n                    (mousedown)=\"onListItemFormControlClick($event)\" (keydown)=\"onNumberKeydown($event)\"\r\n                    min=\"1\" max=\"{{previousMaxDays}}\" (input)=\"checkMaxDays($event, 'previous')\">\r\n                    <select (mousedown)=\"onListItemFormControlClick($event)\" name=\"previous_dateType\" [(ngModel)]=\"previous_dateType\">\r\n                        <option value=\"day\">{{locale?.day}}</option>\r\n                        <option value=\"week\">{{locale?.week}}</option>\r\n                        <option value=\"month\">{{locale?.month}}</option>    \r\n                        <option value=\"year\">{{locale?.year}}</option>      \r\n                    </select>\r\n                </label>\r\n            </div> </li>\r\n        <li class=\"dynamic-view-item\" [class.active]=\"value === 'future'\">\r\n            <div class=\"custom-control custom-radio\">\r\n                <input class=\"custom-control-input\" type=\"radio\" name=\"dynamic_date\" id=\"radio_dynamic_future\" value=\"future\" tabindex=\"0\" [(ngModel)]=\"value\">\r\n                <label class=\"custom-control-label\" for=\"radio_dynamic_future\">\r\n                    {{locale?.future}} <input type=\"number\" [ngModel]=\"future_days\" name=\"future_days\" \r\n                    (mousedown)=\"onListItemFormControlClick($event)\" (keydown)=\"onNumberKeydown($event)\"\r\n                    min=\"1\" max=\"{{futureMaxDays}}\" (input)=\"checkMaxDays($event, 'future')\">\r\n                    <select (mousedown)=\"onListItemFormControlClick($event)\" [(ngModel)]=\"future_dateType\" name=\"future_dateType\">\r\n                        <option value=\"day\">{{locale?.day}}</option>\r\n                        <option value=\"week\">{{locale?.week}}</option>\r\n                        <option value=\"month\">{{locale?.month}}</option>    \r\n                        <option value=\"year\">{{locale?.year}}</option>    \r\n                    </select>\r\n                </label>\r\n            </div>    \r\n        </li>\r\n        <li class=\"dynamic-view-item\" [class.active]=\"value === 'present_first'\">\r\n            <div class=\"custom-control custom-radio\">\r\n                <input class=\"custom-control-input\" type=\"radio\" name=\"dynamic_date\" id=\"radio_dynamic_present_first\" value=\"present_first\" tabindex=\"0\" [(ngModel)]=\"value\">\r\n                <label class=\"custom-control-label\" for=\"radio_dynamic_present_first\">\r\n                    {{locale?.current}}<select (mousedown)=\"onListItemFormControlClick($event)\" [(ngModel)]=\"present_first_dateType\" name=\"present_first_dateType\">\r\n                        <option value=\"week\">{{locale?.week}}</option>\r\n                        <option value=\"month\">{{locale?.month}}</option>    \r\n                        <option value=\"year\">{{locale?.year}}</option>    \r\n                    </select>{{locale?.first}}\r\n                </label>\r\n            </div>    \r\n            \r\n        </li>\r\n        <li class=\"dynamic-view-item\" [class.active]=\"value === 'present_last'\">\r\n            <div class=\"custom-control custom-radio\">\r\n                <input class=\"custom-control-input\" type=\"radio\" name=\"dynamic_date\" id=\"radio_dynamic_present_last\" value=\"present_last\" tabindex=\"0\" [(ngModel)]=\"value\">\r\n                <label class=\"custom-control-label\" for=\"radio_dynamic_present_last\" >\r\n                    {{locale?.current}}<select (mousedown)=\"onListItemFormControlClick($event)\" [(ngModel)]=\"present_last_dateType\" name=\"present_last_dateType\">\r\n                        <option value=\"week\">{{locale?.week}}</option>\r\n                        <option value=\"month\">{{locale?.month}}</option>    \r\n                        <option value=\"year\">{{locale?.year}}</option>    \r\n                    </select>{{locale?.last}}\r\n                </label>\r\n            </div>  \r\n        </li>\r\n    </ul>\r\n</div>\r\n\r\n\r\n\r\n",
                    styles: [".datepicker_dynamic-view ul{margin:10px 8px;list-style:none}.dynamic-view-item{line-height:30px;padding-left:8px;list-style:none}.dynamic-view-item.active{background:#f7f8fb;border-radius:6px}.dynamic-view-item input[type=number]{width:46px;text-align:center;-moz-appearance:textfield}.dynamic-view-item select{width:60px;padding-left:5px;margin:0 6px}.dynamic-view-item input,.dynamic-view-item select{height:26px;border-radius:6px;border:1px solid #d9dee7}.dynamic-view-item input:focus,.dynamic-view-item select:focus{outline:0}.dynamic-view-item .custom-radio .custom-control-label::before{top:7px}.dynamic-view-item label{padding-left:20px;display:inline-block;width:100%}.dynamic-view-item input::-webkit-inner-spin-button,.dynamic-view-item input::-webkit-outer-spin-button{-webkit-appearance:none!important}"]
                }] }
    ];
    /** @nocollapse */
    DynamicViewComponent.ctorParameters = function () { return [
        { type: Injector },
        { type: ChangeDetectorRef }
    ]; };
    DynamicViewComponent.propDecorators = {
        data: [{ type: Input }],
        previousMaxDays: [{ type: Input }],
        futureMaxDays: [{ type: Input }],
        locale: [{ type: Input }],
        valueChange: [{ type: Output }]
    };
    return DynamicViewComponent;
}());
export { DynamicViewComponent };
if (false) {
    /** @type {?} */
    DynamicViewComponent.prototype._value;
    /**
     * @type {?}
     * @private
     */
    DynamicViewComponent.prototype._data;
    /** @type {?} */
    DynamicViewComponent.prototype.previousMaxDays;
    /** @type {?} */
    DynamicViewComponent.prototype.futureMaxDays;
    /** @type {?} */
    DynamicViewComponent.prototype.locale;
    /** @type {?} */
    DynamicViewComponent.prototype.previous_dateType;
    /** @type {?} */
    DynamicViewComponent.prototype.previous_days;
    /** @type {?} */
    DynamicViewComponent.prototype.future_dateType;
    /** @type {?} */
    DynamicViewComponent.prototype.future_days;
    /** @type {?} */
    DynamicViewComponent.prototype.present_first_dateType;
    /** @type {?} */
    DynamicViewComponent.prototype.present_last_dateType;
    /** @type {?} */
    DynamicViewComponent.prototype.valueChange;
    /**
     * @type {?}
     * @private
     */
    DynamicViewComponent.prototype.injector;
    /**
     * @type {?}
     * @private
     */
    DynamicViewComponent.prototype.cd;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZHluYW1pYy12aWV3LmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BmYXJyaXMvdWktZGF0ZXBpY2tlci8iLCJzb3VyY2VzIjpbImxpYi9jb21wb25lbnRzL2R5bmFtaWMtdmlldy9keW5hbWljLXZpZXcuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7QUFBQSxPQUFPLEVBQUUsWUFBWSxFQUFFLGlCQUFpQixFQUFFLFNBQVMsRUFBRSxRQUFRLEVBQUUsS0FBSyxFQUFVLE1BQU0sRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUc1RztJQThDSSw4QkFBb0IsUUFBa0IsRUFBVSxFQUFxQjtRQUFqRCxhQUFRLEdBQVIsUUFBUSxDQUFVO1FBQVUsT0FBRSxHQUFGLEVBQUUsQ0FBbUI7UUFyQ3JFLFdBQU0sR0FBVyxFQUFFLENBQUM7UUFXWixVQUFLLEdBQWdCLElBQUksQ0FBQztRQVV6QixvQkFBZSxHQUFHLEVBQUUsQ0FBQztRQUNyQixrQkFBYSxHQUFHLEVBQUUsQ0FBQztRQUk1QixzQkFBaUIsR0FBcUIsS0FBSyxDQUFDO1FBQzVDLGtCQUFhLEdBQVcsQ0FBQyxDQUFDO1FBRTFCLG9CQUFlLEdBQW9CLEtBQUssQ0FBQTtRQUN4QyxnQkFBVyxHQUFHLENBQUMsQ0FBQztRQUVoQiwyQkFBc0IsR0FBb0IsT0FBTyxDQUFDO1FBQ2xELDBCQUFxQixHQUFvQixPQUFPLENBQUM7UUFFdkMsZ0JBQVcsR0FBRyxJQUFJLFlBQVksRUFBRSxDQUFDO0lBRThCLENBQUM7SUFuQzFFLHNCQUFJLHVDQUFLOzs7O1FBQVQ7WUFDSSxPQUFPLElBQUksQ0FBQyxNQUFNLENBQUM7UUFDdkIsQ0FBQzs7Ozs7UUFFRCxVQUFVLEdBQUc7WUFDVCxJQUFJLENBQUMsTUFBTSxHQUFHLEdBQUcsQ0FBQztZQUNsQixJQUFJLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQztRQUMvQixDQUFDOzs7T0FMQTtJQVFELHNCQUFhLHNDQUFJOzs7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RS9CLHdDQUEwQjs7Ozs7SUFBRSxrQ0FBNkIiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBFdmVudEVtaXR0ZXIsIENoYW5nZURldGVjdG9yUmVmLCBDb21wb25lbnQsIEluamVjdG9yLCBJbnB1dCwgT25Jbml0LCBPdXRwdXQgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgRHluYW1pY0RhdGEsIER5bmFtaWNEYXRlVHlwZSB9IGZyb20gJy4uLy4uL2ludGVyZmFjZXMvZHluYW1pYy1kYXRhLXR5cGUuaW50ZXJmYWNlJztcclxuXHJcbkBDb21wb25lbnQoe1xyXG4gICAgc2VsZWN0b3I6ICdsaWItZHluYW1pYy12aWV3JyxcclxuICAgIHRlbXBsYXRlVXJsOiAnZHluYW1pYy12aWV3LmNvbXBvbmVudC5odG1sJyxcclxuICAgIHN0eWxlVXJsczogW1xyXG4gICAgICAgICcuL2R5bmFtaWMtdmlldy5jc3MnXHJcbiAgICBdXHJcbn0pXHJcblxyXG5leHBvcnQgY2xhc3MgRHluYW1pY1ZpZXdDb21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQge1xyXG4gICAgX3ZhbHVlOiBzdHJpbmcgPSAnJztcclxuXHJcbiAgICBnZXQgdmFsdWUoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX3ZhbHVlO1xyXG4gICAgfVxyXG5cclxuICAgIHNldCB2YWx1ZSh2YWwpIHtcclxuICAgICAgICB0aGlzLl92YWx1ZSA9IHZhbDtcclxuICAgICAgICB0aGlzLnZhbHVlQ2hhbmdlLmVtaXQodmFsKTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIF9kYXRhOiBEeW5hbWljRGF0YSA9IG51bGw7XHJcbiAgICBASW5wdXQoKSBzZXQgZGF0YSh2YWw6IER5bmFtaWNEYXRhKSB7XHJcbiAgICAgICAgdGhpcy5fZGF0YSA9IHZhbDtcclxuICAgICAgICB0aGlzLnNldFZhbHVlKHZhbCk7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0IGRhdGEoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2RhdGE7XHJcbiAgICB9XHJcblxyXG4gICAgQElucHV0KCkgcHJldmlvdXNNYXhEYXlzID0gMzA7XHJcbiAgICBASW5wdXQoKSBmdXR1cmVNYXhEYXlzID0gMzA7XHJcblxyXG4gICAgQElucHV0KCkgbG9jYWxlOiBhbnk7XHJcblxyXG4gICAgcHJldmlvdXNfZGF0ZVR5cGU6IER5bmFtaWNEYXRlVHlwZSAgPSAnZGF5JztcclxuICAgIHByZXZpb3VzX2RheXM6IG51bWJlciA9IDE7XHJcblxyXG4gICAgZnV0dXJlX2RhdGVUeXBlOiBEeW5hbWljRGF0ZVR5cGUgPSAnZGF5J1xyXG4gICAgZnV0dXJlX2RheXMgPSAxO1xyXG5cclxuICAgIHByZXNlbnRfZmlyc3RfZGF0ZVR5cGU6IER5bmFtaWNEYXRlVHlwZSA9ICdtb250aCc7XHJcbiAgICBwcmVzZW50X2xhc3RfZGF0ZVR5cGU6IER5bmFtaWNEYXRlVHlwZSA9ICdtb250aCc7XHJcblxyXG4gICAgQE91dHB1dCgpIHZhbHVlQ2hhbmdlID0gbmV3IEV2ZW50RW1pdHRlcigpO1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKHByaXZhdGUgaW5qZWN0b3I6IEluamVjdG9yLCBwcml2YXRlIGNkOiBDaGFuZ2VEZXRlY3RvclJlZikgeyB9XHJcblxyXG4gICAgbmdPbkluaXQoKSB7IH1cclxuXHJcbiAgICBvbkxpc3RJdGVtRm9ybUNvbnRyb2xDbGljaygkZXZlbnQpIHtcclxuICAgICAgICBjb25zdCBsYmwgPSAkZXZlbnQudGFyZ2V0LmNsb3Nlc3QoJ2xhYmVsJyk7XHJcbiAgICAgICAgaWYgKGxibCkge1xyXG4gICAgICAgICAgICBsYmwuY2xpY2soKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgc2V0VmFsdWUodmFsOiBEeW5hbWljRGF0YSkge1xyXG4gICAgICAgIGlmICh2YWwpIHtcclxuICAgICAgICAgICAgdGhpcy52YWx1ZSA9IHZhbC5uYW1lO1xyXG4gICAgICAgICAgICBzd2l0Y2godGhpcy52YWx1ZSkge1xyXG4gICAgICAgICAgICAgICAgY2FzZSAncHJlc2VudF9kYXknOiAvLyDku4rlpKlcclxuICAgICAgICAgICAgICAgIGNhc2UgJ3ByZXNlbnRfbW9udGgnOiAvLyDmnKzmnIhcclxuICAgICAgICAgICAgICAgIGNhc2UgJ3ByZXNlbnRfeWVhcic6XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlICdwcmV2aW91JzpcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnByZXZpb3VzX2RhdGVUeXBlID0gdmFsLmRhdGVUeXBlO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJldmlvdXNfZGF5cyA9IHZhbC5jb3VudDtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgJ2Z1dHVyZSc6XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5mdXR1cmVfZGF0ZVR5cGUgPSB2YWwuZGF0ZVR5cGU7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5mdXR1cmVfZGF5cyA9IHZhbC5jb3VudDtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgJ3ByZXNlbnRfZmlyc3QnOlxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJlc2VudF9maXJzdF9kYXRlVHlwZSA9IHZhbC5kYXRlVHlwZTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgJ3ByZXNlbnRfbGFzdCc6XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcmVzZW50X2xhc3RfZGF0ZVR5cGUgPSB2YWwuZGF0ZVR5cGU7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7IFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMuY2QuZGV0ZWN0Q2hhbmdlcygpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBnZXRWYWx1ZSgpOiBEeW5hbWljRGF0YSB7XHJcbiAgICAgICAgbGV0IHZhbCA9IG51bGw7XHJcbiAgICAgICAgaWYgKHRoaXMudmFsdWUpIHtcclxuICAgICAgICAgICAgc3dpdGNoKHRoaXMudmFsdWUpIHtcclxuICAgICAgICAgICAgICAgIGNhc2UgJ3ByZXNlbnRfZGF5JzogLy8g5LuK5aSpXHJcbiAgICAgICAgICAgICAgICAgICAgdmFsID0ge2RhdGVUeXBlOidkYXknLCBwZXJpb2Q6J3ByZXNlbnQnLCBjb3VudDogbnVsbCwgaXNGaXJzdERheTogZmFsc2UsIGlzTGFzdERheTogZmFsc2V9O1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSAncHJlc2VudF9tb250aCc6IC8vIOacrOaciFxyXG4gICAgICAgICAgICAgICAgICAgIHZhbCA9IHtkYXRlVHlwZTonbW9udGgnLCBwZXJpb2Q6J3ByZXNlbnQnLCBjb3VudDogbnVsbCwgaXNGaXJzdERheTogZmFsc2UsIGlzTGFzdERheTogZmFsc2V9O1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSAncHJlc2VudF95ZWFyJzpcclxuICAgICAgICAgICAgICAgICAgICB2YWwgPSB7ZGF0ZVR5cGU6J3llYXInLCBwZXJpb2Q6J3ByZXNlbnQnLCBjb3VudDogbnVsbCwgaXNGaXJzdERheTogZmFsc2UsIGlzTGFzdERheTogZmFsc2V9O1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSAncHJldmlvdSc6XHJcbiAgICAgICAgICAgICAgICAgICAgdmFsID0geyBkYXRlVHlwZTogdGhpcy5wcmV2aW91c19kYXRlVHlwZSAsIHBlcmlvZDoncHJldmlvdXMnLCBjb3VudDogdGhpcy5wcmV2aW91c19kYXlzLCBpc0ZpcnN0RGF5OiBmYWxzZSwgaXNMYXN0RGF5OiBmYWxzZX07XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlICdmdXR1cmUnOlxyXG4gICAgICAgICAgICAgICAgICAgIHZhbCA9IHsgZGF0ZVR5cGU6IHRoaXMuZnV0dXJlX2RhdGVUeXBlICwgcGVyaW9kOidmdXR1cmUnLCBjb3VudDogdGhpcy5mdXR1cmVfZGF5cywgaXNGaXJzdERheTogZmFsc2UsIGlzTGFzdERheTogZmFsc2V9O1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSAncHJlc2VudF9maXJzdCc6XHJcbiAgICAgICAgICAgICAgICAgICAgdmFsID0geyBkYXRlVHlwZTogdGhpcy5wcmVzZW50X2ZpcnN0X2RhdGVUeXBlICwgcGVyaW9kOidwcmVzZW50JywgY291bnQ6IG51bGwsIGlzRmlyc3REYXk6IHRydWUsIGlzTGFzdERheTogZmFsc2V9O1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSAncHJlc2VudF9sYXN0JzpcclxuICAgICAgICAgICAgICAgICAgICB2YWwgPSB7IGRhdGVUeXBlOiB0aGlzLnByZXNlbnRfbGFzdF9kYXRlVHlwZSAsIHBlcmlvZDoncHJlc2VudCcsIGNvdW50OiBudWxsLCBpc0ZpcnN0RGF5OiBmYWxzZSwgaXNMYXN0RGF5OiB0cnVlfTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKHZhbCkge1xyXG4gICAgICAgICAgICAgICAgdmFsLm5hbWUgPSB0aGlzLnZhbHVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB2YWw7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBnZXREYXRlVHlwZVN0cmluZyhkdDogRHluYW1pY0RhdGVUeXBlKSB7XHJcbiAgICAgICAgc3dpdGNoKGR0KSB7XHJcbiAgICAgICAgICAgIGNhc2UgJ3dlZWsnOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMubG9jYWxlLndlZWsgfHwgJ+WkqSc7XHJcbiAgICAgICAgICAgIGNhc2UgJ2RheSc6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5sb2NhbGUuZGF5IHx8ICflpKknO1xyXG4gICAgICAgICAgICBjYXNlICdtb250aCc6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5sb2NhbGUubW9udGggfHwgJ+aciCc7XHJcbiAgICAgICAgICAgIGNhc2UgJ3llYXInOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMubG9jYWxlLnllYXIgfHwgJ+W5tCc7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGZvcm1hdFZhbHVlKCkge1xyXG4gICAgICAgIGNvbnN0IHZhbCA9IHRoaXMuZ2V0VmFsdWUoKTtcclxuICAgICAgICBpZiAodmFsKSB7XHJcbiAgICAgICAgICAgIGxldCBmdmFsID0gJyc7XHJcbiAgICAgICAgICAgIHN3aXRjaCh2YWwubmFtZSkge1xyXG4gICAgICAgICAgICAgICAgY2FzZSAncHJlc2VudF9kYXknOiAvLyDku4rlpKlcclxuICAgICAgICAgICAgICAgIGZ2YWwgPSB0aGlzLmxvY2FsZS50b2RheSB8fCAn5LuK5aSpJztcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlICdwcmVzZW50X21vbnRoJzogLy8g5pys5pyIXHJcbiAgICAgICAgICAgICAgICBmdmFsID0gdGhpcy5sb2NhbGUucHJlc2VudE1vbnRoIHx8ICfmnKzmnIgnO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgJ3ByZXNlbnRfeWVhcic6XHJcbiAgICAgICAgICAgICAgICBmdmFsID0gdGhpcy5sb2NhbGUucHJlc2VudFllYXIgfHwn5pys5bm0JztcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlICdwcmV2aW91JzpcclxuICAgICAgICAgICAgICAgIGZ2YWwgPSAgKHRoaXMubG9jYWxlLnByZXZpb3VzfHwgJ+i/h+WOuycpICsgJyAnICsgdmFsLmNvdW50ICsgJyAnICsgdGhpcy5nZXREYXRlVHlwZVN0cmluZyh2YWwuZGF0ZVR5cGUpO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgJ2Z1dHVyZSc6XHJcbiAgICAgICAgICAgICAgICBmdmFsID0gKHRoaXMubG9jYWxlLmZ1dHVyZSB8fCAn5pyq5p2lJykgKyAnICcrIHZhbC5jb3VudCArICcgJyArdGhpcy5nZXREYXRlVHlwZVN0cmluZyh2YWwuZGF0ZVR5cGUpO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgJ3ByZXNlbnRfZmlyc3QnOlxyXG4gICAgICAgICAgICAgICAgZnZhbCA9ICh0aGlzLmxvY2FsZS5jdXJyZW50fHwn5pysJykgKyB0aGlzLmdldERhdGVUeXBlU3RyaW5nKHZhbC5kYXRlVHlwZSkgKyAodGhpcy5sb2NhbGUuZmlyc3R8fCfnrKwgMSDlpKknKTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlICdwcmVzZW50X2xhc3QnOlxyXG4gICAgICAgICAgICAgICAgZnZhbCA9ICh0aGlzLmxvY2FsZS5jdXJyZW50fHwn5pysJykgKyB0aGlzLmdldERhdGVUeXBlU3RyaW5nKHZhbC5kYXRlVHlwZSkgKyAodGhpcy5sb2NhbGUubGFzdHx8J+acgOWQjiAxIOWkqScpO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJldHVybiBmdmFsO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiAnJztcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG5cclxuICAgIHByaXZhdGUgc2V0RGF5cyh0eXA6IHN0cmluZywgZGF5czogbnVtYmVyKSB7XHJcbiAgICAgICAgaWYgKHR5cCA9PT0gJ3ByZXZpb3VzJykge1xyXG4gICAgICAgICAgICB0aGlzLnByZXZpb3VzX2RheXMgPSBkYXlzO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuZnV0dXJlX2RheXMgPSBkYXlzO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBjaGVja01heERheXMoJGV2ZW50LCB0eWU6IHN0cmluZykge1xyXG4gICAgICAgIGNvbnN0IHRhcmdldCA9ICRldmVudC50YXJnZXQgYXMgYW55O1xyXG4gICAgICAgIGNvbnN0IHZhbCA9IHRhcmdldC52YWx1ZS5yZXBsYWNlKC9bXlxcZF0vZywnJyk7XHJcbiAgICAgICAgY29uc3QgZGF5cyA9IE51bWJlcih2YWwpO1xyXG4gICAgICAgIHRhcmdldC52YWx1ZSA9IGRheXM7XHJcbiAgICAgICAgY29uc3QgbWF4ID0gdHllID09PSAncHJldmlvdXMnID8gdGhpcy5wcmV2aW91c01heERheXM6IHRoaXMuZnV0dXJlTWF4RGF5czsgXHJcbiAgICAgICAgdGhpcy5zZXREYXlzKHR5ZSwgZGF5cyk7XHJcblxyXG4gICAgICAgIGlmIChkYXlzID4gbWF4KSB7XHJcbiAgICAgICAgICAgIHRhcmdldC52YWx1ZSA9IG1heDtcclxuICAgICAgICAgICAgdGhpcy5zZXREYXlzKHR5ZSwgbWF4KTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGlmIChkYXlzIDwgMSkge1xyXG4gICAgICAgICAgICAgICAgdGFyZ2V0LnZhbHVlID0gMTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0RGF5cyh0eWUsIDEpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIG9uTnVtYmVyS2V5ZG93bigkZXZlbnQ6IEtleWJvYXJkRXZlbnQpIHtcclxuICAgICAgICAkZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgaWYgKCRldmVudC5rZXkgPT09ICcuJyB8fCAkZXZlbnQua2V5ID09PSAnLScgfHwgJGV2ZW50LmtleSA9PT0gJysnKSB7XHJcbiAgICAgICAgICAgICRldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufSJdfQ==