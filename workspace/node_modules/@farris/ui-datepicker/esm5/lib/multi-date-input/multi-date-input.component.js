/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { ChangeDetectorRef, Component, ElementRef, EventEmitter, Injector, Input, Output, Renderer2, ViewChild } from '@angular/core';
import { CommonUtils, OverLayHiddenService } from '@farris/ui-common';
import { BehaviorSubject } from 'rxjs';
import { UtilService } from '../services/farris-datepicker.util.service';
var MultiSelectDateInputComponent = /** @class */ (function () {
    function MultiSelectDateInputComponent(injector, render, el, overLayService, cd, utilService) {
        this.injector = injector;
        this.render = render;
        this.el = el;
        this.overLayService = overLayService;
        this.cd = cd;
        this.utilService = utilService;
        this.dates = '';
        this.separator = ',';
        this.placeholder = '';
        this.editable = true;
        this.orderBy = 'none';
        this.clickHandle = new EventEmitter();
        this.remove = new EventEmitter();
        this._dateItems = [];
        this.hiddenItemsCount$ = new BehaviorSubject(0);
        this.commonUtils = null;
        this.commonUtils = this.injector.get(CommonUtils, null);
    }
    /**
     * @return {?}
     */
    MultiSelectDateInputComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
    };
    /**
     * @return {?}
     */
    MultiSelectDateInputComponent.prototype.ngOnDestroy = /**
     * @return {?}
     */
    function () {
        if (this.overLayService) {
            this.overLayService.destory(this.shadowBox.nativeElement);
        }
        if (this.shadowBox) {
            this.shadowBox.nativeElement.remove();
        }
    };
    /**
     * @param {?} changes
     * @return {?}
     */
    MultiSelectDateInputComponent.prototype.ngOnChanges = /**
     * @param {?} changes
     * @return {?}
     */
    function (changes) {
        if (changes.dates && !changes.dates.isFirstChange()) {
            this.initDateItems();
        }
    };
    /**
     * @private
     * @return {?}
     */
    MultiSelectDateInputComponent.prototype.initDateItems = /**
     * @private
     * @return {?}
     */
    function () {
        var _this = this;
        /** @type {?} */
        var _dateItems = this.dates.split(this.separator).filter((/**
         * @param {?} n
         * @return {?}
         */
        function (n) { return n; }));
        this._dateItems = this.utilService.orderSelectedDates(_dateItems, this.orderBy);
        setTimeout((/**
         * @return {?}
         */
        function () {
            _this.setHiddenCount();
        }));
    };
    /**
     * @return {?}
     */
    MultiSelectDateInputComponent.prototype.ngAfterViewInit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this.initDateItems();
        setTimeout((/**
         * @return {?}
         */
        function () {
            _this.moveShadowToBody();
        }));
    };
    /**
     * @param {?} $event
     * @return {?}
     */
    MultiSelectDateInputComponent.prototype.onClick = /**
     * @param {?} $event
     * @return {?}
     */
    function ($event) {
        $event.stopPropagation();
        this.toggleShadowBox($event, false);
        this.clickHandle.emit($event);
    };
    /**
     * @param {?} $event
     * @param {?} txt
     * @param {?} index
     * @return {?}
     */
    MultiSelectDateInputComponent.prototype.onRemove = /**
     * @param {?} $event
     * @param {?} txt
     * @param {?} index
     * @return {?}
     */
    function ($event, txt, index) {
        if ($event) {
            $event.stopPropagation();
        }
        this.remove.emit({ index: index, value: txt });
    };
    /**
     * @param {?} $event
     * @return {?}
     */
    MultiSelectDateInputComponent.prototype.onResized = /**
     * @param {?} $event
     * @return {?}
     */
    function ($event) {
        var _this = this;
        this.updateShadowBoxPosition($event);
        setTimeout((/**
         * @return {?}
         */
        function () {
            _this.setHiddenCount();
            _this.cd.detectChanges();
        }));
    };
    /**
     * @private
     * @return {?}
     */
    MultiSelectDateInputComponent.prototype.setHiddenCount = /**
     * @private
     * @return {?}
     */
    function () {
        /** @type {?} */
        var len = 0;
        if (!this._dateItems || !this._dateItems.length) {
            this.hiddenItemsCount$.next(len);
            return;
        }
        /** @type {?} */
        var items = Array.from(this.container.nativeElement.querySelectorAll('span.search-tag-item'));
        if (items && items.length) {
            len = items.map((/**
             * @param {?} n
             * @return {?}
             */
            function (n) {
                return n.offsetTop;
            })).filter((/**
             * @param {?} n
             * @return {?}
             */
            function (n) { return n > 20; })).length;
        }
        this.hiddenItemsCount$.next(len);
    };
    /**
     * @param {?=} __0
     * @return {?}
     */
    MultiSelectDateInputComponent.prototype.updateShadowBoxPosition = /**
     * @param {?=} __0
     * @return {?}
     */
    function (_a) {
        var _b = _a === void 0 ? { top: null, left: null, width: null } : _a, top = _b.top, left = _b.left, width = _b.width;
        if (!top && !left && !width) {
            /** @type {?} */
            var e = this.el.nativeElement.getBoundingClientRect();
            top = e.top;
            left = e.left;
            width = e.width;
        }
        this.render.setStyle(this.shadowBox.nativeElement, 'left', left + 'px');
        this.render.setStyle(this.shadowBox.nativeElement, 'top', top + 'px');
        this.render.setStyle(this.shadowBox.nativeElement, 'width', width + 'px');
        this.render.setStyle(this.shadowBox.nativeElement, 'zIndex', this.commonUtils.getFloatingLayerIndex());
    };
    /**
     * @private
     * @return {?}
     */
    MultiSelectDateInputComponent.prototype.moveShadowToBody = /**
     * @private
     * @return {?}
     */
    function () {
        var _this = this;
        this.updateShadowBoxPosition();
        document.body.append(this.shadowBox.nativeElement);
        this.overLayService.registerMouseEvent(this.shadowBox.nativeElement, (/**
         * @param {?} e
         * @return {?}
         */
        function (e) {
            if (e.target && e.target.className.indexOf('search-box_delete-keys') > -1) {
                return;
            }
            if (!_this.shadowBox || _this.shadowBox.nativeElement.contains(e.target)) {
                return;
            }
            _this.toggleShadowBox(null, false);
        }));
    };
    /**
     * @param {?} $event
     * @param {?=} show
     * @return {?}
     */
    MultiSelectDateInputComponent.prototype.toggleShadowBox = /**
     * @param {?} $event
     * @param {?=} show
     * @return {?}
     */
    function ($event, show) {
        if (show === void 0) { show = true; }
        if ($event) {
            $event.stopPropagation();
        }
        if (!this.hiddenItemsCount$.value) {
            show = false;
        }
        if (show) {
            this.updateShadowBoxPosition();
            this.render.removeStyle(this.shadowBox.nativeElement, 'display');
            this.container.nativeElement.style.visibility = 'hidden';
        }
        else {
            this.container.nativeElement.style.visibility = 'visible';
            this.render.setStyle(this.shadowBox.nativeElement, 'display', 'none');
        }
    };
    MultiSelectDateInputComponent.decorators = [
        { type: Component, args: [{
                    selector: 'multi-select-input',
                    template: "\r\n<div #searchbox class=\"input-group f-search-box f-multi-select-date\" [class.f-state-disabled]=\"!editable\" resizeObserver (resize)=\"onResized($event)\"\r\n[attr.title]=\"dates\" (mousedown)=\"$event.preventDefault()\">\r\n    <div class=\"form-control f-cmp-inputgroup--multi-wrapper multi-more\" style=\"min-height: 26px;padding: 0px 5px;\" [style.height]=\"'26px'\" (click)=\"toggleShadowBox($event)\">\r\n        <div class=\"multi--content d-flex flex-row multi-date-display\" #tagContainer \r\n        [attr.placeholder]=\"placeholder\">\r\n            <span class=\"multi--item search-tag-item\" [class.multi-date-display-readonly]=\"!editable\" *ngFor=\"let txt of _dateItems; index as i\" >\r\n                <span class=\"search-tag\" >{{txt}}</span>\r\n                <i class=\"f-icon f-icon-close search-box_delete-keys\" *ngIf=\"editable\" style=\"top:5px\" (click)=\"onRemove($event, txt, i)\"></i>\r\n            </span>\r\n        </div>\r\n\r\n        <div class=\"d-flex flex-row\" style=\"cursor: pointer;align-items: center;color: #2A87FF;font-weight: 600;\" *ngIf=\"hiddenItemsCount$ | async\">\r\n            <span class=\"multi--more-text\">+{{hiddenItemsCount$ | async}}</span>\r\n        </div>\r\n    </div>\r\n    <div class=\"input-group-append f-cmp-iconbtn-wrapper\" *ngIf=\"editable\" style=\"position: relative;\" (mouseenter)=\"$event.stopPropagation()\">\r\n        <span class=\"input-group-text input-group-clear datepicker-clear \" \r\n            style=\"position: absolute; height: 100%; right: 0px; top: 0px; z-index: 100; visibility: hidden;\">\r\n            <i class=\"f-icon modal_close\"></i></span>\r\n        <button class=\"btn f-cmp-iconbtn\" type=\"button\" (click)=\"onClick($event)\"><span class=\"f-icon f-icon-date\"></span></button>\r\n    </div>\r\n    \r\n</div>\r\n\r\n\r\n\r\n<div #searchbox2 class=\"input-group f-search-box f-cmp-inputgroup f-multi-select-date\" [class.f-state-disabled]=\"!editable\" style=\"position:absolute;display: none; z-index: 2999;\"\r\n (mousedown)=\"$event.preventDefault()\" >\r\n    <div class=\"form-control f-cmp-inputgroup--multi-wrapper multi-more  d-flex\" style=\"height: auto; min-height: 26px;padding: 0px 5px;\">\r\n        <div class=\"multi--content d-flex flex-row\" style=\"width: 100%;flex-wrap: wrap;align-items: center;\" #tagContainer>\r\n            <span class=\"multi--item search-tag-item\" [class.multi-date-display-readonly]=\"!editable\" *ngFor=\"let txt of _dateItems; index as i\">\r\n                <span class=\"search-tag\">{{txt}}</span>\r\n                <i class=\"f-icon f-icon-close search-box_delete-keys\" *ngIf=\"editable\" style=\"top:5px\" (click)=\"onRemove($event, txt, i)\"></i>\r\n            </span>\r\n\r\n        </div>\r\n    </div>\r\n    <div class=\"input-group-append f-cmp-iconbtn-wrapper\" *ngIf=\"editable\" style=\"position: relative;\" (mouseenter)=\"$event.stopPropagation()\">\r\n        <span class=\"input-group-text input-group-clear datepicker-clear \" \r\n            style=\"position: absolute; height: 100%; right: 0px; top: 0px; z-index: 100; visibility: hidden;\">\r\n            <i class=\"f-icon modal_close\"></i></span>\r\n        <button class=\"btn f-cmp-iconbtn\" type=\"button\" (click)=\"onClick($event)\"><span class=\"f-icon f-icon-date\"></span></button>\r\n    </div>\r\n</div>\r\n",
                    styles: ["\n        .multi-date-display {\n            width: 100%;flex-wrap: wrap;align-items: center;cursor: text;\n        }\n\n        .multi-date-display:empty:before {\n            content: attr(placeholder);\n            color: #c4c4c4;\n        }\n\n        .multi-date-display-readonly {\n            padding-right: 5px;\n        }\n\n        .f-multi-select-date.f-state-disabled .search-tag-item {\n            background: #F1F3F7;\n            border: 1px solid #F1F3F7;\n            color:  #2D2F33;\n        }\n\n        .f-multi-select-date.f-state-disabled .multi--more-text {\n            color: #c7c7c7;\n        }\n\n        "]
                }] }
    ];
    /** @nocollapse */
    MultiSelectDateInputComponent.ctorParameters = function () { return [
        { type: Injector },
        { type: Renderer2 },
        { type: ElementRef },
        { type: OverLayHiddenService },
        { type: ChangeDetectorRef },
        { type: UtilService }
    ]; };
    MultiSelectDateInputComponent.propDecorators = {
        dates: [{ type: Input }],
        separator: [{ type: Input }],
        placeholder: [{ type: Input }],
        editable: [{ type: Input }],
        orderBy: [{ type: Input }],
        clickHandle: [{ type: Output }],
        remove: [{ type: Output }],
        shadowBox: [{ type: ViewChild, args: ['searchbox2',] }],
        container: [{ type: ViewChild, args: ['searchbox',] }]
    };
    return MultiSelectDateInputComponent;
}());
export { MultiSelectDateInputComponent };
if (false) {
    /** @type {?} */
    MultiSelectDateInputComponent.prototype.dates;
    /** @type {?} */
    MultiSelectDateInputComponent.prototype.separator;
    /** @type {?} */
    MultiSelectDateInputComponent.prototype.placeholder;
    /** @type {?} */
    MultiSelectDateInputComponent.prototype.editable;
    /** @type {?} */
    MultiSelectDateInputComponent.prototype.orderBy;
    /** @type {?} */
    MultiSelectDateInputComponent.prototype.clickHandle;
    /** @type {?} */
    MultiSelectDateInputComponent.prototype.remove;
    /** @type {?} */
    MultiSelectDateInputComponent.prototype.shadowBox;
    /** @type {?} */
    MultiSelectDateInputComponent.prototype.container;
    /** @type {?} */
    MultiSelectDateInputComponent.prototype._dateItems;
    /** @type {?} */
    MultiSelectDateInputComponent.prototype.hiddenItemsCount$;
    /** @type {?} */
    MultiSelectDateInputComponent.prototype.commonUtils;
    /**
     * @type {?}
     * @private
     */
    MultiSelectDateInputComponent.prototype.injector;
    /**
     * @type {?}
     * @private
     */
    MultiSelectDateInputComponent.prototype.render;
    /**
     * @type {?}
     * @private
     */
    MultiSelectDateInputComponent.prototype.el;
    /** @type {?} */
    MultiSelectDateInputComponent.prototype.overLayService;
    /**
     * @type {?}
     * @protected
     */
    MultiSelectDateInputComponent.prototype.cd;
    /**
     * @type {?}
     * @private
     */
    MultiSelectDateInputComponent.prototype.utilService;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibXVsdGktZGF0ZS1pbnB1dC5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZmFycmlzL3VpLWRhdGVwaWNrZXIvIiwic291cmNlcyI6WyJsaWIvbXVsdGktZGF0ZS1pbnB1dC9tdWx0aS1kYXRlLWlucHV0LmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7O0FBQUEsT0FBTyxFQUFpQixpQkFBaUIsRUFBRSxTQUFTLEVBQUUsVUFBVSxFQUFFLFlBQVksRUFBRSxRQUFRLEVBQUUsS0FBSyxFQUFnQyxNQUFNLEVBQUUsU0FBUyxFQUFpQixTQUFTLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFDbE0sT0FBTyxFQUFFLFdBQVcsRUFBRSxvQkFBb0IsRUFBRSxNQUFNLG1CQUFtQixDQUFDO0FBQ3RFLE9BQU8sRUFBRSxlQUFlLEVBQUUsTUFBTSxNQUFNLENBQUM7QUFDdkMsT0FBTyxFQUFFLFdBQVcsRUFBRSxNQUFNLDRDQUE0QyxDQUFDO0FBR3pFO0lBbURJLHVDQUFvQixRQUFrQixFQUFVLE1BQWlCLEVBQVUsRUFBYyxFQUFTLGNBQW9DLEVBQVksRUFBcUIsRUFDM0osV0FBd0I7UUFEaEIsYUFBUSxHQUFSLFFBQVEsQ0FBVTtRQUFVLFdBQU0sR0FBTixNQUFNLENBQVc7UUFBVSxPQUFFLEdBQUYsRUFBRSxDQUFZO1FBQVMsbUJBQWMsR0FBZCxjQUFjLENBQXNCO1FBQVksT0FBRSxHQUFGLEVBQUUsQ0FBbUI7UUFDM0osZ0JBQVcsR0FBWCxXQUFXLENBQWE7UUFsQjNCLFVBQUssR0FBRyxFQUFFLENBQUM7UUFDWCxjQUFTLEdBQUcsR0FBRyxDQUFDO1FBQ2hCLGdCQUFXLEdBQUcsRUFBRSxDQUFDO1FBQ2pCLGFBQVEsR0FBRyxJQUFJLENBQUM7UUFDaEIsWUFBTyxHQUF5QixNQUFNLENBQUM7UUFFdEMsZ0JBQVcsR0FBRyxJQUFJLFlBQVksRUFBRSxDQUFDO1FBQ2pDLFdBQU0sR0FBRyxJQUFJLFlBQVksRUFBRSxDQUFDO1FBS3RDLGVB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QUEyQzs7SUFDM0MsK0NBQXNDOztJQUV0QyxrREFBK0M7O0lBQy9DLGtEQUE4Qzs7SUFFOUMsbURBQWdCOztJQUVoQiwwREFBMkM7O0lBQzNDLG9EQUFtQjs7Ozs7SUFFUCxpREFBMEI7Ozs7O0lBQUUsK0NBQXlCOzs7OztJQUFFLDJDQUFzQjs7SUFBRSx1REFBMkM7Ozs7O0lBQUUsMkNBQStCOzs7OztJQUNuSyxvREFBZ0MiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBZnRlclZpZXdJbml0LCBDaGFuZ2VEZXRlY3RvclJlZiwgQ29tcG9uZW50LCBFbGVtZW50UmVmLCBFdmVudEVtaXR0ZXIsIEluamVjdG9yLCBJbnB1dCwgT25DaGFuZ2VzLCBPbkRlc3Ryb3ksIE9uSW5pdCwgT3V0cHV0LCBSZW5kZXJlcjIsIFNpbXBsZUNoYW5nZXMsIFZpZXdDaGlsZCB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBDb21tb25VdGlscywgT3ZlckxheUhpZGRlblNlcnZpY2UgfSBmcm9tICdAZmFycmlzL3VpLWNvbW1vbic7XHJcbmltcG9ydCB7IEJlaGF2aW9yU3ViamVjdCB9IGZyb20gJ3J4anMnO1xyXG5pbXBvcnQgeyBVdGlsU2VydmljZSB9IGZyb20gJy4uL3NlcnZpY2VzL2ZhcnJpcy1kYXRlcGlja2VyLnV0aWwuc2VydmljZSc7XHJcbmltcG9ydCB7IE11bHRpU2VsZWN0ZWRPcmRlckJ5IH0gZnJvbSAnLi4vaW50ZXJmYWNlcy9teS1vcHRpb25zLmludGVyZmFjZSc7XHJcblxyXG5AQ29tcG9uZW50KHtcclxuICAgIHNlbGVjdG9yOiAnbXVsdGktc2VsZWN0LWlucHV0JyxcclxuICAgIHRlbXBsYXRlVXJsOiAnLi9tdWx0aS1kYXRlLWlucHV0LmNvbXBvbmVudC5odG1sJyxcclxuICAgIHN0eWxlczogW1xyXG4gICAgICAgIGBcclxuICAgICAgICAubXVsdGktZGF0ZS1kaXNwbGF5IHtcclxuICAgICAgICAgICAgd2lkdGg6IDEwMCU7ZmxleC13cmFwOiB3cmFwO2FsaWduLWl0ZW1zOiBjZW50ZXI7Y3Vyc29yOiB0ZXh0O1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLm11bHRpLWRhdGUtZGlzcGxheTplbXB0eTpiZWZvcmUge1xyXG4gICAgICAgICAgICBjb250ZW50OiBhdHRyKHBsYWNlaG9sZGVyKTtcclxuICAgICAgICAgICAgY29sb3I6ICNjNGM0YzQ7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAubXVsdGktZGF0ZS1kaXNwbGF5LXJlYWRvbmx5IHtcclxuICAgICAgICAgICAgcGFkZGluZy1yaWdodDogNXB4O1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLmYtbXVsdGktc2VsZWN0LWRhdGUuZi1zdGF0ZS1kaXNhYmxlZCAuc2VhcmNoLXRhZy1pdGVtIHtcclxuICAgICAgICAgICAgYmFja2dyb3VuZDogI0YxRjNGNztcclxuICAgICAgICAgICAgYm9yZGVyOiAxcHggc29saWQgI0YxRjNGNztcclxuICAgICAgICAgICAgY29sb3I6ICAjMkQyRjMzO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLmYtbXVsdGktc2VsZWN0LWRhdGUuZi1zdGF0ZS1kaXNhYmxlZCAubXVsdGktLW1vcmUtdGV4dCB7XHJcbiAgICAgICAgICAgIGNvbG9yOiAjYzdjN2M3O1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgYFxyXG4gICAgXVxyXG59KVxyXG5cclxuZXhwb3J0IGNsYXNzIE11bHRpU2VsZWN0RGF0ZUlucHV0Q29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0LCBPbkNoYW5nZXMsIEFmdGVyVmlld0luaXQsIE9uRGVzdHJveSB7XHJcblxyXG4gICAgQElucHV0KCkgZGF0ZXMgPSAnJztcclxuICAgIEBJbnB1dCgpIHNlcGFyYXRvciA9ICcsJztcclxuICAgIEBJbnB1dCgpIHBsYWNlaG9sZGVyID0gJyc7XHJcbiAgICBASW5wdXQoKSBlZGl0YWJsZSA9IHRydWU7XHJcbiAgICBASW5wdXQoKSBvcmRlckJ5OiBNdWx0aVNlbGVjdGVkT3JkZXJCeSA9ICdub25lJztcclxuXHJcbiAgICBAT3V0cHV0KCkgY2xpY2tIYW5kbGUgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XHJcbiAgICBAT3V0cHV0KCkgcmVtb3ZlID0gbmV3IEV2ZW50RW1pdHRlcigpO1xyXG5cclxuICAgIEBWaWV3Q2hpbGQoJ3NlYXJjaGJveDInKSBzaGFkb3dCb3g6IEVsZW1lbnRSZWY7XHJcbiAgICBAVmlld0NoaWxkKCdzZWFyY2hib3gnKSBjb250YWluZXI6IEVsZW1lbnRSZWY7XHJcblxyXG4gICAgX2RhdGVJdGVtcyA9IFtdO1xyXG5cclxuICAgIGhpZGRlbkl0ZW1zQ291bnQkID0gbmV3IEJlaGF2aW9yU3ViamVjdCgwKTtcclxuICAgIGNvbW1vblV0aWxzID0gbnVsbDtcclxuXHJcbiAgICBjb25zdHJ1Y3Rvcihwcml2YXRlIGluamVjdG9yOiBJbmplY3RvciwgcHJpdmF0ZSByZW5kZXI6IFJlbmRlcmVyMiwgcHJpdmF0ZSBlbDogRWxlbWVudFJlZiwgcHVibGljIG92ZXJMYXlTZXJ2aWNlOiBPdmVyTGF5SGlkZGVuU2VydmljZSwgcHJvdGVjdGVkIGNkOiBDaGFuZ2VEZXRlY3RvclJlZixcclxuICAgICAgICBwcml2YXRlIHV0aWxTZXJ2aWNlOiBVdGlsU2VydmljZSkge1xyXG4gICAgICAgIHRoaXMuY29tbW9uVXRpbHMgPSB0aGlzLmluamVjdG9yLmdldChDb21tb25VdGlscywgbnVsbCk7XHJcbiAgICB9XHJcblxyXG4gICAgbmdPbkluaXQoKSB7XHJcbiAgICAgICAgXHJcbiAgICB9XHJcblxyXG4gICAgbmdPbkRlc3Ryb3koKSB7XHJcbiAgICAgICAgaWYgKHRoaXMub3ZlckxheVNlcnZpY2UpIHtcclxuICAgICAgICAgICAgdGhpcy5vdmVyTGF5U2VydmljZS5kZXN0b3J5KHRoaXMuc2hhZG93Qm94Lm5hdGl2ZUVsZW1lbnQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy5zaGFkb3dCb3gpIHtcclxuICAgICAgICAgICAgdGhpcy5zaGFkb3dCb3gubmF0aXZlRWxlbWVudC5yZW1vdmUoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgbmdPbkNoYW5nZXMoY2hhbmdlczogU2ltcGxlQ2hhbmdlcykge1xyXG4gICAgICAgIGlmIChjaGFuZ2VzLmRhdGVzICYmICFjaGFuZ2VzLmRhdGVzLmlzRmlyc3RDaGFuZ2UoKSkge1xyXG4gICAgICAgICAgICB0aGlzLmluaXREYXRlSXRlbXMoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBpbml0RGF0ZUl0ZW1zKCkge1xyXG4gICAgICAgIGNvbnN0IF9kYXRlSXRlbXMgPSB0aGlzLmRhdGVzLnNwbGl0KHRoaXMuc2VwYXJhdG9yKS5maWx0ZXIobiA9PiBuKTtcclxuICAgICAgICB0aGlzLl9kYXRlSXRlbXMgPSB0aGlzLnV0aWxTZXJ2aWNlLm9yZGVyU2VsZWN0ZWREYXRlcyhfZGF0ZUl0ZW1zLCB0aGlzLm9yZGVyQnkpO1xyXG5cclxuICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5zZXRIaWRkZW5Db3VudCgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIG5nQWZ0ZXJWaWV3SW5pdCgpIHtcclxuXHJcbiAgICAgICAgdGhpcy5pbml0RGF0ZUl0ZW1zKCk7XHJcblxyXG4gICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLm1vdmVTaGFkb3dUb0JvZHkoKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBvbkNsaWNrKCRldmVudDogTW91c2VFdmVudCkge1xyXG4gICAgICAgICRldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICB0aGlzLnRvZ2dsZVNoYWRvd0JveCgkZXZlbnQsIGZhbHNlKTtcclxuICAgICAgICB0aGlzLmNsaWNrSGFuZGxlLmVtaXQoJGV2ZW50KTtcclxuICAgIH1cclxuXHJcbiAgICBvblJlbW92ZSgkZXZlbnQ6IE1vdXNlRXZlbnQsIHR4dCwgaW5kZXgpIHtcclxuICAgICAgICBpZiAoJGV2ZW50KSB7XHJcbiAgICAgICAgICAgICRldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5yZW1vdmUuZW1pdCh7aW5kZXgsIHZhbHVlOiB0eHR9KTtcclxuICAgIH1cclxuXHJcbiAgICBcclxuICAgIG9uUmVzaXplZCgkZXZlbnQpIHtcclxuICAgICAgICB0aGlzLnVwZGF0ZVNoYWRvd0JveFBvc2l0aW9uKCRldmVudCk7XHJcbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuc2V0SGlkZGVuQ291bnQoKTtcclxuICAgICAgICAgICAgdGhpcy5jZC5kZXRlY3RDaGFuZ2VzKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG5cclxuICAgIHByaXZhdGUgc2V0SGlkZGVuQ291bnQoKSB7XHJcbiAgICAgICAgbGV0IGxlbiA9IDA7XHJcbiAgICAgICAgaWYgKCF0aGlzLl9kYXRlSXRlbXMgfHwgIXRoaXMuX2RhdGVJdGVtcy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgdGhpcy5oaWRkZW5JdGVtc0NvdW50JC5uZXh0KGxlbik7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgaXRlbXMgPSBBcnJheS5mcm9tKHRoaXMuY29udGFpbmVyLm5hdGl2ZUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCgnc3Bhbi5zZWFyY2gtdGFnLWl0ZW0nKSk7XHJcbiAgICAgICAgaWYgKGl0ZW1zICYmIGl0ZW1zLmxlbmd0aCkge1xyXG4gICAgICAgICAgICBsZW4gPSBpdGVtcy5tYXAoKG46IGFueSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG4ub2Zmc2V0VG9wO1xyXG4gICAgICAgICAgICB9KS5maWx0ZXIobiA9PiBuID4gMjApLmxlbmd0aFxyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmhpZGRlbkl0ZW1zQ291bnQkLm5leHQobGVuKTtcclxuICAgIH1cclxuXHJcbiAgICBcclxuICAgIHVwZGF0ZVNoYWRvd0JveFBvc2l0aW9uKHt0b3AsIGxlZnQsIHdpZHRofSA9IHt0b3A6IG51bGwsIGxlZnQ6IG51bGwsIHdpZHRoOiBudWxsfSkge1xyXG4gICAgICAgIGlmICghdG9wICYmICFsZWZ0ICYmICF3aWR0aCkge1xyXG4gICAgICAgICAgICBjb25zdCBlID0gdGhpcy5lbC5uYXRpdmVFbGVtZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xyXG4gICAgICAgICAgICB0b3AgPSBlLnRvcDtcclxuICAgICAgICAgICAgbGVmdCA9IGUubGVmdDtcclxuICAgICAgICAgICAgd2lkdGggPSBlLndpZHRoO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnJlbmRlci5zZXRTdHlsZSh0aGlzLnNoYWRvd0JveC5uYXRpdmVFbGVtZW50LCAnbGVmdCcsIGxlZnQgKyAncHgnKTtcclxuICAgICAgICB0aGlzLnJlbmRlci5zZXRTdHlsZSh0aGlzLnNoYWRvd0JveC5uYXRpdmVFbGVtZW50LCAndG9wJywgdG9wICsgJ3B4Jyk7XHJcbiAgICAgICAgdGhpcy5yZW5kZXIuc2V0U3R5bGUodGhpcy5zaGFkb3dCb3gubmF0aXZlRWxlbWVudCwgJ3dpZHRoJywgd2lkdGggKyAncHgnKTtcclxuXHJcbiAgICAgICAgdGhpcy5yZW5kZXIuc2V0U3R5bGUodGhpcy5zaGFkb3dCb3gubmF0aXZlRWxlbWVudCwgJ3pJbmRleCcsIHRoaXMuY29tbW9uVXRpbHMuZ2V0RmxvYXRpbmdMYXllckluZGV4KCkpO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgbW92ZVNoYWRvd1RvQm9keSgpIHtcclxuICAgICAgICB0aGlzLnVwZGF0ZVNoYWRvd0JveFBvc2l0aW9uKCk7XHJcbiAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmQodGhpcy5zaGFkb3dCb3gubmF0aXZlRWxlbWVudCk7XHJcblxyXG4gICAgICAgIHRoaXMub3ZlckxheVNlcnZpY2UucmVnaXN0ZXJNb3VzZUV2ZW50KHRoaXMuc2hhZG93Qm94Lm5hdGl2ZUVsZW1lbnQsIChlKSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChlLnRhcmdldCAmJiBlLnRhcmdldC5jbGFzc05hbWUuaW5kZXhPZignc2VhcmNoLWJveF9kZWxldGUta2V5cycpID4gLTEpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKCF0aGlzLnNoYWRvd0JveCB8fCB0aGlzLnNoYWRvd0JveC5uYXRpdmVFbGVtZW50LmNvbnRhaW5zKGUudGFyZ2V0KSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB0aGlzLnRvZ2dsZVNoYWRvd0JveChudWxsLCBmYWxzZSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIHRvZ2dsZVNoYWRvd0JveCgkZXZlbnQsIHNob3cgPSB0cnVlKSB7XHJcbiAgICAgICAgaWYgKCRldmVudCkge1xyXG4gICAgICAgICAgICAkZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICghdGhpcy5oaWRkZW5JdGVtc0NvdW50JC52YWx1ZSkge1xyXG4gICAgICAgICAgICBzaG93ID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChzaG93KSB7XHJcbiAgICAgICAgICAgIHRoaXMudXBkYXRlU2hhZG93Qm94UG9zaXRpb24oKTtcclxuICAgICAgICAgICAgdGhpcy5yZW5kZXIucmVtb3ZlU3R5bGUodGhpcy5zaGFkb3dCb3gubmF0aXZlRWxlbWVudCwgJ2Rpc3BsYXknKTtcclxuICAgICAgICAgICAgdGhpcy5jb250YWluZXIubmF0aXZlRWxlbWVudC5zdHlsZS52aXNpYmlsaXR5ID0gJ2hpZGRlbic7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5jb250YWluZXIubmF0aXZlRWxlbWVudC5zdHlsZS52aXNpYmlsaXR5ID0gJ3Zpc2libGUnO1xyXG4gICAgICAgICAgICB0aGlzLnJlbmRlci5zZXRTdHlsZSh0aGlzLnNoYWRvd0JveC5uYXRpdmVFbGVtZW50LCAnZGlzcGxheScsICdub25lJyk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59Il19