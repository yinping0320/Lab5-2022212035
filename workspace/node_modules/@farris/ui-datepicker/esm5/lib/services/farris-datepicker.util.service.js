/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
/*
 * @Author: 疯狂秀才(Lucas Huang)
 * @Date: 2019-09-04 07:40:04
 * @LastEditors: 疯狂秀才(Lucas Huang)
 * @LastEditTime: 2019-09-04 15:21:46
 * @QQ: 1055818239
 * @Version: v0.0.1
 */
import { Injectable } from '@angular/core';
import { KeyCode, KeyName, ShowType } from '../enums/public-api';
import { D, DD, M, MM, MMM, YYYY, SU, MO, TU, WE, TH, FR, SA, ZERO_STR, EMPTY_STR } from '../constants/constants';
import { orderBy } from 'lodash-es';
var UtilService = /** @class */ (function () {
    function UtilService() {
        this.weekDays = [SU, MO, TU, WE, TH, FR, SA];
    }
    /**
     * @param {?} dateStr
     * @param {?} options
     * @param {?=} isReturn
     * @return {?}
     */
    UtilService.prototype.isDateValid = /**
     * @param {?} dateStr
     * @param {?} options
     * @param {?=} isReturn
     * @return {?}
     */
    function (dateStr, options, isReturn) {
        if (isReturn === void 0) { isReturn = false; }
        // tslint:disable-next-line:one-variable-per-declaration
        /** @type {?} */
        var _dateStr;
        /** @type {?} */
        var hour = 0;
        /** @type {?} */
        var minute = 0;
        /** @type {?} */
        var second = 0;
        /** @type {?} */
        var returnDate = this.resetDate();
        if (!dateStr || !dateStr.length) {
            return returnDate;
        }
        var dateFormat = options.dateFormat, minYear = options.minYear, maxYear = options.maxYear, monthLabels = options.monthLabels, showTime = options.showTime, returnFormat = options.returnFormat, showType = options.showType;
        /** @type {?} */
        var _st = showTime;
        /** @type {?} */
        var formatStr = dateFormat;
        if (isReturn) {
            formatStr = returnFormat.replace(/[年,月]/g, '-').replace(/[日]/, '').replace(/[时,分]/g, ':').replace(/[秒]/g, '');
            dateStr = dateStr.replace(/[年,月]/g, '-').replace(/[日]/, '').replace(/[时,分]/g, ':').replace(/[秒]/g, '');
            if (dateStr[dateStr.length - 1] === '-' || dateStr[dateStr.length - 1] === ':') {
                dateStr = dateStr.substring(0, dateStr.length - 1);
            }
            if (!showTime && returnFormat.toLocaleLowerCase().indexOf('hh:mm') > -1) {
                _st = true;
            }
        }
        /** @type {?} */
        var daysInMonth = [31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31];
        /** @type {?} */
        var isMonthStr = formatStr.indexOf(MMM) !== -1;
        /** @type {?} */
        var delimeters = formatStr.match(/[^(DdMmYy)]{1,}/g);
        if (_st && dateStr) {
            _dateStr = dateStr.split(' ')[0];
            Object.assign(returnDate, { hour: 0, minute: 0, second: 0 });
            /** @type {?} */
            var timeStr = dateStr.split(' ')[1];
            if (timeStr) {
                /** @type {?} */
                var _timer = timeStr.replace('时', ':').replace('分', ':').replace('秒', '').split(':');
                if (_timer[0]) {
                    hour = Number(_timer[0].substr(0, 2));
                    hour = isNaN(hour) ? 0 : hour;
                }
                if (_timer[1]) {
                    minute = Number(_timer[1].substr(0, 2));
                    minute = isNaN(minute) ? 0 : minute;
                }
                if (_timer[2]) {
                    second = Number(_timer[2].substr(0, 2));
                    second = isNaN(second) ? 0 : second;
                }
            }
            else {
                delimeters = undefined;
                /** @type {?} */
                var reg = /^\d{1,}$/;
                if (reg.test(dateStr)) { // 验证传入的格式为 yyyyMMddHHmmss
                    // 验证传入的格式为 yyyyMMddHHmmss
                    /** @type {?} */
                    var df = formatStr;
                    _dateStr = dateStr.substr(0, 8);
                    /** @type {?} */
                    var _timer = dateStr.substr(8);
                    if (_timer) {
                        if (df.includes('HH')) {
                            if (_timer) {
                                hour = +_timer.slice(0, 2);
                                _timer = _timer.slice(2);
                            }
                        }
                        if (df.includes('mm')) {
                            if (_timer) {
                                minute = +_timer.slice(0, 2);
                                _timer = _timer.slice(2);
                            }
                        }
                        if (df.includes('ss')) {
                            if (_timer) {
                                second = +_timer.slice(0, 2);
                            }
                        }
                    }
                }
            }
        }
        else {
            _dateStr = dateStr ? dateStr.split(' ')[0] : '';
        }
        /** @type {?} */
        var dateValue = this.getDateValue(_dateStr, formatStr, delimeters);
        /** @type {?} */
        var year = this.getNumberByValue(dateValue[0]);
        /** @type {?} */
        var month = isMonthStr
            ? this.getMonthNumberByMonthName(dateValue[1], monthLabels)
            : this.getNumberByValue(dateValue[1]);
        /** @type {?} */
        var day = this.getNumberByValue(dateValue[2]);
        if (showType === ShowType.noDateAndMonth) {
            return { year: year, month: 1, day: 1 };
        }
        if (month !== -1 && day !== -1 && year !== -1) {
            if (year < minYear || year > maxYear || month < 1 || month > 12) {
                return returnDate;
            }
            /** @type {?} */
            var date = _st ? { year: year, month: month, day: day, hour: hour, minute: minute, second: second } : { year: year, month: month, day: day };
            if (this.isDisabledDate(date, options)) {
                return returnDate;
            }
            if (year % 400 === 0 || (year % 100 !== 0 && year % 4 === 0)) {
                daysInMonth[1] = 29;
            }
            if (day < 1 || day > daysInMonth[month - 1]) {
                return returnDate;
            }
            // Valid date
            if (options.showType === ShowType.noDate) {
                return { year: date.year, month: date.month };
            }
            else if (options.showType === ShowType.noDateAndMonth) {
                return { year: date.year };
            }
            else {
                return date;
            }
        }
        return returnDate;
    };
    /**
     * @param {?} dateRangeStr
     * @param {?} options
     * @return {?}
     */
    UtilService.prototype.isDateValidDateRange = /**
     * @param {?} dateRangeStr
     * @param {?} options
     * @return {?}
     */
    function (dateRangeStr, options) {
        /** @type {?} */
        var dateRange = {
            begin: this.resetDate(),
            end: this.resetDate()
        };
        if (dateRangeStr && dateRangeStr.length) {
            /** @type {?} */
            var dates = dateRangeStr.split(options.dateRangeDatesDelimiter);
            if (dates && dates.length === 2) {
                var _a = tslib_1.__read(dates, 2), beginDate = _a[0], endDate = _a[1];
                /** @type {?} */
                var begin = this.isDateValid(beginDate, options, true);
                if (this.isInitializedDate(begin)) {
                    /** @type {?} */
                    var end = this.isDateValid(endDate, options, true);
                    if (this.isInitializedDate(end) && this.isDateSameOrEarlier(begin, end)) {
                        dateRange = { begin: begin, end: end };
                    }
                }
            }
        }
        return dateRange;
    };
    /**
     * @param {?} dateStr
     * @param {?} dateFormat
     * @param {?} delimeters
     * @return {?}
     */
    UtilService.prototype.getDateValue = /**
     * @param {?} dateStr
     * @param {?} dateFormat
     * @param {?} delimeters
     * @return {?}
     */
    function (dateStr, dateFormat, delimeters) {
        /** @type {?} */
        var da = [];
        if (delimeters) {
            /** @type {?} */
            var del = delimeters[0];
            if (delimeters[0] !== delimeters[1]) {
                del = delimeters[0] + delimeters[1];
                if (delimeters[2] && delimeters[1] !== delimeters[2]) {
                    del = del + delimeters[2];
                }
            }
            /** @type {?} */
            var re = new RegExp('[' + del + ']');
            /** @type {?} */
            var ds = dateStr.split(re);
            /** @type {?} */
            var df = dateFormat.split(re);
            for (var i = 0; i < df.length; i++) {
                if (df[i].indexOf(YYYY) !== -1) {
                    da[0] = { value: ds[i], format: df[i] };
                }
                if (df[i].indexOf(M) !== -1) {
                    da[1] = ds[i] === undefined ? { value: '1', format: df[i] } : { value: ds[i], format: df[i] };
                }
                if (df[i].indexOf(D) !== -1) {
                    da[2] = ds[i] === undefined ? { value: '1', format: df[i] } : { value: ds[i], format: df[i] };
                }
            }
        }
        else {
            /** @type {?} */
            var yearIndex = (dateFormat + '').indexOf(YYYY);
            /** @type {?} */
            var monthIndex = (dateFormat + '').indexOf(MM);
            /** @type {?} */
            var dayIndex = (dateFormat + '').indexOf(DD);
            if (yearIndex >= 0) {
                da[0] = { value: dateStr.substring(yearIndex, yearIndex + 4), format: dateFormat.substring(yearIndex, yearIndex + 4) };
            }
            if (monthIndex >= 0) {
                da[1] = { value: dateStr.substring(monthIndex, monthIndex + 2), format: dateFormat.substring(monthIndex, monthIndex + 2) };
            }
            if (dayIndex >= 0) {
                da[2] = { value: dateStr.substring(dayIndex, dayIndex + 2) || '01', format: dateFormat.substring(dayIndex, dayIndex + 2) };
            }
        }
        return da;
    };
    /**
     * @param {?} df
     * @param {?} monthLabels
     * @return {?}
     */
    UtilService.prototype.getMonthNumberByMonthName = /**
     * @param {?} df
     * @param {?} monthLabels
     * @return {?}
     */
    function (df, monthLabels) {
        if (df.value) {
            for (var key = 1; key <= 12; key++) {
                if (df.value.toLowerCase() === monthLabels[key].toLowerCase()) {
                    return key;
                }
            }
        }
        return -1;
    };
    /**
     * @param {?} df
     * @return {?}
     */
    UtilService.prototype.getNumberByValue = /**
     * @param {?} df
     * @return {?}
     */
    function (df) {
        if (!df) {
            return 1;
        }
        if (!/^\d+$/.test(df.value)) {
            return -1;
        }
        /** @type {?} */
        var nbr = Number(df.value);
        if ((df.format.length === 1 && df.value.length !== 1 && nbr < 10) ||
            (df.format.length === 1 && df.value.length !== 2 && nbr >= 10)) {
            nbr = -1;
        }
        else if (df.format.length === 2 && df.value.length > 2) {
            nbr = -1;
        }
        return nbr;
    };
    /**
     * @param {?} monthString
     * @return {?}
     */
    UtilService.prototype.parseDefaultMonth = /**
     * @param {?} monthString
     * @return {?}
     */
    function (monthString) {
        /** @type {?} */
        var month = { monthTxt: EMPTY_STR, monthNbr: 0, year: 0 };
        if (monthString !== EMPTY_STR) {
            /** @type {?} */
            var split = monthString.split(monthString.match(/[^0-9]/)[0]);
            month.monthNbr = split[0].length === 2 ? Number(split[0]) : Number(split[1]);
            month.year = split[0].length === 2 ? Number(split[1]) : Number(split[0]);
        }
        return month;
    };
    /**
     * @param {?} date
     * @param {?} options
     * @return {?}
     */
    UtilService.prototype.isDisabledDate = /**
     * @param {?} date
     * @param {?} options
     * @return {?}
     */
    function (date, options) {
        var e_1, _a, e_2, _b, e_3, _c;
        var minYear = options.minYear, maxYear = options.maxYear, disableUntil = options.disableUntil, disableSince = options.disableSince, disableWeekends = options.disableWeekends, disableDates = options.disableDates, disableDateRanges = options.disableDateRanges, disableWeekdays = options.disableWeekdays, enableDates = options.enableDates;
        // for (const d of enableDates) {
        //     if (
        //         (d.year === 0 || d.year === date.year) &&
        //         (d.month === 0 || d.month === date.month) &&
        //         d.day === date.day
        //     ) {
        //         return false;
        //     }
        // }
        if ((date.year < minYear && date.month === 12) || (date.year > maxYear && date.month === 1)) {
            return true;
        }
        /** @type {?} */
        var dateMs = this.getTimeInMilliseconds(date);
        if (this.isInitializedDate(disableUntil) && (dateMs + 24 * 60 * 60 * 1000 - 1) < this.getTimeInMilliseconds(disableUntil)) {
            return true;
        }
        if (this.isInitializedDate(disableSince) && dateMs > this.getTimeInMilliseconds(disableSince)) {
            return true;
        }
        if (disableWeekends) {
            /** @type {?} */
            var dayNbr = this.getDayNumber(date);
            if (dayNbr === 0 || dayNbr === 6) {
                return true;
            }
        }
        /** @type {?} */
        var dn = this.getDayNumber(date);
        if (disableWeekdays.length > 0) {
            try {
                for (var disableWeekdays_1 = tslib_1.__values(disableWeekdays), disableWeekdays_1_1 = disableWeekdays_1.next(); !disableWeekdays_1_1.done; disableWeekdays_1_1 = disableWeekdays_1.next()) {
                    var wd = disableWeekdays_1_1.value;
                    if (dn === this.getWeekdayIndex(wd)) {
                        return true;
                    }
                }
            }
            catch (e_1_1) { e_1 = { error: e_1_1 }; }
            finally {
                try {
                    if (disableWeekdays_1_1 && !disableWeekdays_1_1.done && (_a = disableWeekdays_1.return)) _a.call(disableWeekdays_1);
                }
                finally { if (e_1) throw e_1.error; }
            }
        }
        try {
            for (var disableDates_1 = tslib_1.__values(disableDates), disableDates_1_1 = disableDates_1.next(); !disableDates_1_1.done; disableDates_1_1 = disableDates_1.next()) {
                var d = disableDates_1_1.value;
                if ((d.year === 0 || d.year === date.year) &&
                    (d.month === 0 || d.month === date.month) &&
                    d.day === date.day) {
                    return true;
                }
            }
        }
        catch (e_2_1) { e_2 = { error: e_2_1 }; }
        finally {
            try {
                if (disableDates_1_1 && !disableDates_1_1.done && (_b = disableDates_1.return)) _b.call(disableDates_1);
            }
            finally { if (e_2) throw e_2.error; }
        }
        try {
            for (var disableDateRanges_1 = tslib_1.__values(disableDateRanges), disableDateRanges_1_1 = disableDateRanges_1.next(); !disableDateRanges_1_1.done; disableDateRanges_1_1 = disableDateRanges_1.next()) {
                var d = disableDateRanges_1_1.value;
                if (this.isInitializedDate(d.begin) &&
                    this.isInitializedDate(d.end) &&
                    dateMs >= this.getTimeInMilliseconds(d.begin) &&
                    dateMs <= this.getTimeInMilliseconds(d.end)) {
                    return true;
                }
            }
        }
        catch (e_3_1) { e_3 = { error: e_3_1 }; }
        finally {
            try {
                if (disableDateRanges_1_1 && !disableDateRanges_1_1.done && (_c = disableDateRanges_1.return)) _c.call(disableDateRanges_1);
            }
            finally { if (e_3) throw e_3.error; }
        }
        return false;
    };
    /**
     * @param {?} date
     * @param {?} markedDates
     * @param {?} markWeekends
     * @return {?}
     */
    UtilService.prototype.isMarkedDate = /**
     * @param {?} date
     * @param {?} markedDates
     * @param {?} markWeekends
     * @return {?}
     */
    function (date, markedDates, markWeekends) {
        var e_4, _a, e_5, _b;
        try {
            for (var markedDates_1 = tslib_1.__values(markedDates), markedDates_1_1 = markedDates_1.next(); !markedDates_1_1.done; markedDates_1_1 = markedDates_1.next()) {
                var md = markedDates_1_1.value;
                try {
                    for (var _c = tslib_1.__values(md.dates), _d = _c.next(); !_d.done; _d = _c.next()) {
                        var d = _d.value;
                        if ((d.year === 0 || d.year === date.year) &&
                            (d.month === 0 || d.month === date.month) &&
                            d.day === date.day) {
                            return { marked: true, color: md.color };
                        }
                    }
                }
                catch (e_5_1) { e_5 = { error: e_5_1 }; }
                finally {
                    try {
                        if (_d && !_d.done && (_b = _c.return)) _b.call(_c);
                    }
                    finally { if (e_5) throw e_5.error; }
                }
            }
        }
        catch (e_4_1) { e_4 = { error: e_4_1 }; }
        finally {
            try {
                if (markedDates_1_1 && !markedDates_1_1.done && (_a = markedDates_1.return)) _a.call(markedDates_1);
            }
            finally { if (e_4) throw e_4.error; }
        }
        if (markWeekends && markWeekends.marked) {
            /** @type {?} */
            var dayNbr = this.getDayNumber(date);
            if (dayNbr === 0 || dayNbr === 6) {
                return { marked: true, color: markWeekends.color };
            }
        }
        return { marked: false, color: EMPTY_STR };
    };
    /**
     * @param {?} date
     * @param {?} sunHighlight
     * @param {?} satHighlight
     * @param {?} highlightDates
     * @return {?}
     */
    UtilService.prototype.isHighlightedDate = /**
     * @param {?} date
     * @param {?} sunHighlight
     * @param {?} satHighlight
     * @param {?} highlightDates
     * @return {?}
     */
    function (date, sunHighlight, satHighlight, highlightDates) {
        var e_6, _a;
        /** @type {?} */
        var dayNbr = this.getDayNumber(date);
        if ((sunHighlight && dayNbr === 0) || (satHighlight && dayNbr === 6)) {
            return true;
        }
        try {
            for (var highlightDates_1 = tslib_1.__values(highlightDates), highlightDates_1_1 = highlightDates_1.next(); !highlightDates_1_1.done; highlightDates_1_1 = highlightDates_1.next()) {
                var d = highlightDates_1_1.value;
                if ((d.year === 0 || d.year === date.year) &&
                    (d.month === 0 || d.month === date.month) &&
                    d.day === date.day) {
                    return true;
                }
            }
        }
        catch (e_6_1) { e_6 = { error: e_6_1 }; }
        finally {
            try {
                if (highlightDates_1_1 && !highlightDates_1_1.done && (_a = highlightDates_1.return)) _a.call(highlightDates_1);
            }
            finally { if (e_6) throw e_6.error; }
        }
        return false;
    };
    /**
     * @param {?} date
     * @return {?}
     */
    UtilService.prototype.getWeekNumber = /**
     * @param {?} date
     * @return {?}
     */
    function (date) {
        /** @type {?} */
        var d = new Date(date.year, date.month - 1, date.day, 0, 0, 0, 0);
        d.setDate(d.getDate() + (d.getDay() === 0 ? -3 : 4 - d.getDay()));
        return Math.round((d.getTime() - new Date(d.getFullYear(), 0, 4).getTime()) / 86400000 / 7) + 1;
    };
    /**
     * @param {?} date
     * @return {?}
     */
    UtilService.prototype.getNowWeekTime = /**
     * @param {?} date
     * @return {?}
     */
    function (date) {
        date.setDate(date.getDate() - ((date.getDay() + 6) % 7));
        /** @type {?} */
        var begin = {
            year: date.getFullYear(),
            month: date.getMonth() + 1,
            day: date.getDate()
        };
        date.setDate(date.getDate() + 6);
        /** @type {?} */
        var end = {
            year: date.getFullYear(),
            month: date.getMonth() + 1,
            day: date.getDate()
        };
        return { begin: begin, end: end };
    };
    /**
     * @param {?} date
     * @param {?} disableUntil
     * @return {?}
     */
    UtilService.prototype.isMonthDisabledByDisableUntil = /**
     * @param {?} date
     * @param {?} disableUntil
     * @return {?}
     */
    function (date, disableUntil) {
        return (this.isInitializedDate(disableUntil) &&
            this.getTimeInMilliseconds(date) <= this.getTimeInMilliseconds(disableUntil));
    };
    /**
     * @param {?} date
     * @param {?} disableSince
     * @return {?}
     */
    UtilService.prototype.isMonthDisabledByDisableSince = /**
     * @param {?} date
     * @param {?} disableSince
     * @return {?}
     */
    function (date, disableSince) {
        return (this.isInitializedDate(disableSince) &&
            this.getTimeInMilliseconds(date) >= this.getTimeInMilliseconds(disableSince));
    };
    /**
     * @param {?} date
     * @param {?} dateRange
     * @param {?} dateFormat
     * @param {?} monthLabels
     * @param {?} rangeDelimiter
     * @param {?} returnFormat
     * @param {?=} dateStr
     * @return {?}
     */
    UtilService.prototype.getDateModel = /**
     * @param {?} date
     * @param {?} dateRange
     * @param {?} dateFormat
     * @param {?} monthLabels
     * @param {?} rangeDelimiter
     * @param {?} returnFormat
     * @param {?=} dateStr
     * @return {?}
     */
    function (date, dateRange, dateFormat, monthLabels, rangeDelimiter, returnFormat, dateStr) {
        if (dateStr === void 0) { dateStr = EMPTY_STR; }
        /** @type {?} */
        var singleDateModel = null;
        /** @type {?} */
        var dateRangeModel = null;
        if (date) {
            singleDateModel = {
                date: date,
                jsDate: this.getDate2(date),
                formatted: dateStr.length ? dateStr : this.formatDate(date, dateFormat, monthLabels),
                returnFormatted: this.formatDate(date, returnFormat, monthLabels),
                epoc: this.getEpocTime(date)
            };
        }
        else {
            dateRangeModel = {
                beginDate: dateRange.begin,
                beginJsDate: this.getDate(dateRange.begin),
                beginEpoc: this.getEpocTime(dateRange.begin),
                endDate: dateRange.end,
                endJsDate: this.getDate(dateRange.end),
                endEpoc: this.getEpocTime(dateRange.end),
                formatted: this.formatDate(dateRange.begin, dateFormat, monthLabels) +
                    rangeDelimiter +
                    this.formatDate(dateRange.end, dateFormat, monthLabels),
                returnFormatted: this.formatDate(dateRange.begin, returnFormat, monthLabels) +
                    rangeDelimiter +
                    this.formatDate(dateRange.end, returnFormat, monthLabels),
            };
        }
        return {
            isRange: date === null,
            singleDate: singleDateModel,
            dateRange: dateRangeModel
        };
    };
    /**
     * @param {?} date
     * @param {?} dateFormat
     * @param {?} monthLabels
     * @return {?}
     */
    UtilService.prototype.formatDate = /**
     * @param {?} date
     * @param {?} dateFormat
     * @param {?} monthLabels
     * @return {?}
     */
    function (date, dateFormat, monthLabels) {
        if (!date.month && dateFormat.indexOf(MM) === -1) {
            dateFormat = this.delete(dateFormat, MM);
        }
        if (!date.day && dateFormat.indexOf(DD) === -1) {
            dateFormat = this.delete(dateFormat, DD);
        }
        /** @type {?} */
        var formatted = dateFormat.replace(YYYY, String(date.year));
        if (dateFormat.indexOf(M) === -1) {
            formatted = formatted.replace(MM, '01');
        }
        else {
            if (dateFormat.indexOf(MMM) !== -1) {
                formatted = formatted.replace(MMM, monthLabels[date.month]);
            }
            else if (dateFormat.indexOf(MM) !== -1) {
                formatted = formatted.replace(MM, this.preZero(date.month || 1));
            }
            else {
                formatted = formatted.replace(M, String(date.month || 1));
            }
        }
        if (dateFormat.indexOf(DD) === -1) {
            formatted = formatted.replace(DD, '01');
        }
        else if (dateFormat.indexOf(DD) !== -1) {
            formatted = formatted.replace(DD, this.preZero(date.day || 1));
        }
        else {
            formatted = formatted.replace(D, String(date.day || 1));
        }
        formatted = formatted.replace('MM', 'mm').replace('HH', this.preZero(date.hour || 0))
            .replace('mm', this.preZero(date.minute || 0))
            .replace('ss', this.preZero(date.second || 0));
        return formatted && formatted.length > 2 ? formatted : '';
    };
    /**
     * @param {?} format
     * @param {?} delStr
     * @return {?}
     */
    UtilService.prototype.delete = /**
     * @param {?} format
     * @param {?} delStr
     * @return {?}
     */
    function (format, delStr) {
        /** @type {?} */
        var re = format.match(/[^(DdMmYy)]{1,}/g);
        /** @type {?} */
        var index = format.indexOf(delStr);
        if (index < 0) {
            return format;
        }
        else if (index === 0) {
            if (re) {
                return format.substring(3);
            }
            else {
                return format.substring(2);
            }
        }
        else if (index + 2 === format.length) {
            if (re) {
                return format.substring(0, format.length - 3);
            }
            else {
                return format.substring(0, format.length - 2);
            }
        }
        else {
            if (re) {
                return format.substring(0, index) + format.substring(index + 3);
            }
            else {
                return format.substring(0, index) + format.substring(index + 2);
            }
        }
    };
    /**
     * @param {?} model
     * @return {?}
     */
    UtilService.prototype.getFormattedDate = /**
     * @param {?} model
     * @return {?}
     */
    function (model) {
        return !model.isRange ? model.singleDate.formatted : model.dateRange.formatted;
    };
    /**
     * @param {?} val
     * @return {?}
     */
    UtilService.prototype.preZero = /**
     * @param {?} val
     * @return {?}
     */
    function (val) {
        return val < 10 ? ZERO_STR + Number(val) : String(val);
    };
    /**
     * @param {?} date
     * @return {?}
     */
    UtilService.prototype.isInitializedDate = /**
     * @param {?} date
     * @return {?}
     */
    function (date) {
        return date && date.year !== 0 && date.month !== 0 && date.day !== 0;
    };
    /**
     * @param {?} date
     * @return {?}
     */
    UtilService.prototype.isInitializedMonth = /**
     * @param {?} date
     * @return {?}
     */
    function (date) {
        return date && date.year !== 0 && date.month !== 0;
    };
    /**
     * @param {?} date
     * @return {?}
     */
    UtilService.prototype.isInitializedYear = /**
     * @param {?} date
     * @return {?}
     */
    function (date) {
        return date && date.year !== 0;
    };
    /**
     * @param {?} firstDate
     * @param {?} secondDate
     * @return {?}
     */
    UtilService.prototype.isDateEarlier = /**
     * @param {?} firstDate
     * @param {?} secondDate
     * @return {?}
     */
    function (firstDate, secondDate) {
        return this.getTimeInMilliseconds(firstDate) < this.getTimeInMilliseconds(secondDate);
    };
    /**
     * @param {?} firstDate
     * @param {?} secondDate
     * @return {?}
     */
    UtilService.prototype.isDateSameOrEarlier = /**
     * @param {?} firstDate
     * @param {?} secondDate
     * @return {?}
     */
    function (firstDate, secondDate) {
        return this.getTimeInMilliseconds(firstDate) <= this.getTimeInMilliseconds(secondDate);
    };
    /**
     * @param {?} firstDate
     * @param {?} secondDate
     * @return {?}
     */
    UtilService.prototype.isDateSame = /**
     * @param {?} firstDate
     * @param {?} secondDate
     * @return {?}
     */
    function (firstDate, secondDate) {
        return this.getTimeInMilliseconds(firstDate) === this.getTimeInMilliseconds(secondDate);
    };
    /**
     * @param {?} dateRange
     * @param {?} date
     * @return {?}
     */
    UtilService.prototype.isDateRangeBeginOrEndSame = /**
     * @param {?} dateRange
     * @param {?} date
     * @return {?}
     */
    function (dateRange, date) {
        /** @type {?} */
        var dateMs = this.getTimeInMilliseconds(date);
        return (this.getTimeInMilliseconds(dateRange.begin) === dateMs ||
            this.getTimeInMilliseconds(dateRange.end) === dateMs);
    };
    /**
     * @param {?} date
     * @param {?} dateRange
     * @return {?}
     */
    UtilService.prototype.isDateInRange = /**
     * @param {?} date
     * @param {?} dateRange
     * @return {?}
     */
    function (date, dateRange) {
        if (!this.isInitializedDate(dateRange.begin) || !this.isInitializedDate(dateRange.end)) {
            return false;
        }
        return this.isDateSameOrEarlier(dateRange.begin, date) && this.isDateSameOrEarlier(date, dateRange.end);
    };
    /**
     * @return {?}
     */
    UtilService.prototype.resetDate = /**
     * @return {?}
     */
    function () {
        return { year: 0, month: 0, day: 0 };
    };
    /**
     * @param {?} date
     * @return {?}
     */
    UtilService.prototype.getTimeInMilliseconds = /**
     * @param {?} date
     * @return {?}
     */
    function (date) {
        return this.getDate(date).getTime();
    };
    /**
     * @param {?} date
     * @return {?}
     */
    UtilService.prototype.getDate2 = /**
     * @param {?} date
     * @return {?}
     */
    function (date) {
        /** @type {?} */
        var now = new Date();
        if (!date.year) {
            date.year = now.getFullYear();
        }
        if (!date.month) {
            date.month = now.getMonth() + 1;
        }
        if (!date.day) {
            date.day = 1;
        }
        return new Date(date.year, date.month - 1, date.day, date.hour ? date.hour : 0, date.minute ? date.minute : 0, date.second ? date.second : 0, 0);
    };
    /**
     * @param {?} date
     * @return {?}
     */
    UtilService.prototype.getDate = /**
     * @param {?} date
     * @return {?}
     */
    function (date) {
        return new Date(date.year || 0, date.month ? date.month - 1 : 0, date.day || 0, date.hour ? date.hour : 0, date.minute ? date.minute : 0, date.second ? date.second : 0, 0);
    };
    /**
     * @param {?} date
     * @return {?}
     */
    UtilService.prototype.getDayNumber = /**
     * @param {?} date
     * @return {?}
     */
    function (date) {
        return new Date(date.year, date.month - 1, date.day, date.hour ? date.hour : 0, date.minute ? date.minute : 0, date.second ? date.second : 0, 0).getDay();
    };
    /**
     * @param {?} wd
     * @return {?}
     */
    UtilService.prototype.getWeekdayIndex = /**
     * @param {?} wd
     * @return {?}
     */
    function (wd) {
        return this.weekDays.indexOf(wd);
    };
    /**
     * @param {?} date
     * @return {?}
     */
    UtilService.prototype.getEpocTime = /**
     * @param {?} date
     * @return {?}
     */
    function (date) {
        return Math.round(this.getTimeInMilliseconds(date) / 1000.0);
    };
    /**
     * @param {?} event
     * @return {?}
     */
    UtilService.prototype.getKeyCodeFromEvent = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        /** @type {?} */
        var key = event.key || event.keyCode;
        if (key === KeyName.enter || key === KeyCode.enter) {
            return KeyCode.enter;
        }
        else if (key === KeyName.esc || key === KeyCode.esc) {
            return KeyCode.esc;
        }
        else if (key === KeyName.space || key === KeyCode.space) {
            return KeyCode.space;
        }
        else if (key === KeyName.leftArrow || key === KeyCode.leftArrow) {
            return KeyCode.leftArrow;
        }
        else if (key === KeyName.upArrow || key === KeyCode.upArrow) {
            return KeyCode.upArrow;
        }
        else if (key === KeyName.rightArrow || key === KeyCode.rightArrow) {
            return KeyCode.rightArrow;
        }
        else if (key === KeyName.downArrow || key === KeyCode.downArrow) {
            return KeyCode.downArrow;
        }
        else if (key === KeyName.tab || key === KeyCode.tab) {
            return KeyCode.tab;
        }
        else if (key === KeyName.shift || key === KeyCode.shift) {
            return KeyCode.shift;
        }
        else {
            return null;
        }
    };
    /**
     * @param {?} now
     * @param {?} min
     * @param {?} max
     * @return {?}
     */
    UtilService.prototype.getNearDate = /**
     * @param {?} now
     * @param {?} min
     * @param {?} max
     * @return {?}
     */
    function (now, min, max) {
        /** @type {?} */
        var minMilliseconds = this.getTimeInMilliseconds(min);
        /** @type {?} */
        var maxMilliseconds = this.getTimeInMilliseconds(max);
        /** @type {?} */
        var nowMilliseconds = this.getTimeInMilliseconds(now);
        if (maxMilliseconds - nowMilliseconds > nowMilliseconds - minMilliseconds) {
            return min;
        }
        else {
            return max;
        }
    };
    // 禁用时间对应的小时
    // 选中日期等于左区间日期时，禁用左端点的左部分[0，minHour）
    // 选中日期等于右区间日期时，禁用右端点的右部分(maxHour,23]
    // 禁用时间对应的小时
    // 选中日期等于左区间日期时，禁用左端点的左部分[0，minHour）
    // 选中日期等于右区间日期时，禁用右端点的右部分(maxHour,23]
    /**
     * @param {?} min
     * @param {?} max
     * @param {?} currentDate
     * @return {?}
     */
    UtilService.prototype.disabledHours = 
    // 禁用时间对应的小时
    // 选中日期等于左区间日期时，禁用左端点的左部分[0，minHour）
    // 选中日期等于右区间日期时，禁用右端点的右部分(maxHour,23]
    /**
     * @param {?} min
     * @param {?} max
     * @param {?} currentDate
     * @return {?}
     */
    function (min, max, currentDate) {
        /** @type {?} */
        var minHour = min.hour;
        /** @type {?} */
        var maxHour = max.hour;
        /** @type {?} */
        var res = [];
        if (this.isDateSame({ year: currentDate.year, month: currentDate.month, day: currentDate.day }, { year: min.year, month: min.month, day: min.day })) {
            while (minHour-- >= 0) {
                res.push(minHour);
            }
        }
        if (this.isDateSame({ year: currentDate.year, month: currentDate.month, day: currentDate.day }, { year: max.year, month: max.month, day: max.day })) {
            while (maxHour++ < 24) {
                res.push(maxHour);
            }
        }
        return res;
    };
    //禁用时间对应的分钟 
    //选中日期等于左区间日期时，禁用左端点的左部分[0，minMinute）
    //选中日期等于右区间日期时，禁用右端点的右部分（maxMinute，59]
    //禁用时间对应的分钟 
    //选中日期等于左区间日期时，禁用左端点的左部分[0，minMinute）
    //选中日期等于右区间日期时，禁用右端点的右部分（maxMinute，59]
    /**
     * @param {?} min
     * @param {?} max
     * @param {?} _hour
     * @param {?} currentDate
     * @return {?}
     */
    UtilService.prototype.disabledMinutes = 
    //禁用时间对应的分钟 
    //选中日期等于左区间日期时，禁用左端点的左部分[0，minMinute）
    //选中日期等于右区间日期时，禁用右端点的右部分（maxMinute，59]
    /**
     * @param {?} min
     * @param {?} max
     * @param {?} _hour
     * @param {?} currentDate
     * @return {?}
     */
    function (min, max, _hour, currentDate) {
        /** @type {?} */
        var maxHour = max.hour;
        /** @type {?} */
        var maxMinute = max.minute;
        /** @type {?} */
        var minHour = min.hour;
        /** @type {?} */
        var minMinute = min.minute;
        /** @type {?} */
        var res = [];
        if (this.isDateSame({ year: currentDate.year, month: currentDate.month, day: currentDate.day }, { year: min.year, month: min.month, day: min.day })) {
            if (_hour == minHour) {
                while (minMinute-- >= 0) {
                    res.push(minMinute);
                }
            }
        }
        if (this.isDateSame({ year: currentDate.year, month: currentDate.month, day: currentDate.day }, { year: max.year, month: max.month, day: max.day })) {
            if (_hour == maxHour) {
                while (maxMinute++ < 60) {
                    res.push(maxMinute);
                }
            }
        }
        return res;
    };
    //禁用时间对应的秒 
    //选中日期等于左区间日期时，禁用左端点的左部分[0，minSecond）
    //选中日期等于右区间日期时，禁用右端点的右部分（maxSecond，59]
    //禁用时间对应的秒 
    //选中日期等于左区间日期时，禁用左端点的左部分[0，minSecond）
    //选中日期等于右区间日期时，禁用右端点的右部分（maxSecond，59]
    /**
     * @param {?} min
     * @param {?} max
     * @param {?} _hour
     * @param {?} _minute
     * @param {?} currentDate
     * @return {?}
     */
    UtilService.prototype.disabledSeconds = 
    //禁用时间对应的秒 
    //选中日期等于左区间日期时，禁用左端点的左部分[0，minSecond）
    //选中日期等于右区间日期时，禁用右端点的右部分（maxSecond，59]
    /**
     * @param {?} min
     * @param {?} max
     * @param {?} _hour
     * @param {?} _minute
     * @param {?} currentDate
     * @return {?}
     */
    function (min, max, _hour, _minute, currentDate) {
        /** @type {?} */
        var maxHour = max.hour;
        /** @type {?} */
        var maxMinute = max.minute;
        /** @type {?} */
        var maxSecond = max.second;
        /** @type {?} */
        var minHour = min.hour;
        /** @type {?} */
        var minMinute = min.minute;
        /** @type {?} */
        var minSecond = min.second;
        /** @type {?} */
        var res = [];
        if (this.isDateSame({ year: currentDate.year, month: currentDate.month, day: currentDate.day }, { year: min.year, month: min.month, day: min.day })) {
            if (_hour == minHour && _minute == minMinute) {
                while (minSecond-- >= 0) {
                    res.push(minSecond);
                }
            }
        }
        if (this.isDateSame({ year: currentDate.year, month: currentDate.month, day: currentDate.day }, { year: max.year, month: max.month, day: max.day })) {
            if (_hour == maxHour && _minute == maxMinute) {
                while (maxSecond++ < 60) {
                    res.push(maxSecond);
                }
            }
        }
        return res;
    };
    /**
     * @private
     * @param {?} dt
     * @param {?} dynamicLocale
     * @return {?}
     */
    UtilService.prototype.getDateTypeString = /**
     * @private
     * @param {?} dt
     * @param {?} dynamicLocale
     * @return {?}
     */
    function (dt, dynamicLocale) {
        switch (dt) {
            case 'week':
                return dynamicLocale.week || '周';
            case 'day':
                return dynamicLocale.day || '天';
            case 'month':
                return dynamicLocale.month || '月';
            case 'year':
                return dynamicLocale.year || '年';
        }
    };
    /**
     * @param {?} val
     * @param {?} dynamicLocale
     * @return {?}
     */
    UtilService.prototype.formatDynamicValue = /**
     * @param {?} val
     * @param {?} dynamicLocale
     * @return {?}
     */
    function (val, dynamicLocale) {
        if (val) {
            /** @type {?} */
            var fval = '';
            switch (val.name) {
                case 'present_day': // 今天
                    fval = dynamicLocale.today || '今天';
                    break;
                case 'present_month': // 本月
                    fval = dynamicLocale.presentMonth || '本月';
                    break;
                case 'present_year':
                    fval = dynamicLocale.presentYear || '本年';
                    break;
                case 'previou':
                    fval = (dynamicLocale.previous || '过去') + ' ' + val.count + ' ' + this.getDateTypeString(val.dateType, dynamicLocale);
                    break;
                case 'future':
                    fval = (dynamicLocale.future || '未来') + ' ' + val.count + ' ' + this.getDateTypeString(val.dateType, dynamicLocale);
                    break;
                case 'present_first':
                    fval = (dynamicLocale.current || '本') + this.getDateTypeString(val.dateType, dynamicLocale) + (dynamicLocale.first || '第 1 天');
                    break;
                case 'present_last':
                    fval = (dynamicLocale.current || '本') + this.getDateTypeString(val.dateType, dynamicLocale) + (dynamicLocale.last || '最后 1 天');
                    break;
            }
            return fval;
        }
        else {
            return '';
        }
    };
    /**
     * @param {?} str
     * @return {?}
     */
    UtilService.prototype.padStartZero = /**
     * @param {?} str
     * @return {?}
     */
    function (str) {
        if (str != null && str !== undefined) {
            return ('' + str).padStart(2, '0');
        }
        return '00';
    };
    /**
     * @param {?} items
     * @param {?=} order
     * @return {?}
     */
    UtilService.prototype.orderSelectedDates = /**
     * @param {?} items
     * @param {?=} order
     * @return {?}
     */
    function (items, order) {
        if (order === void 0) { order = 'none'; }
        if (order !== 'asc' && order !== 'desc') {
            order = 'none';
        }
        if (order === 'none') {
            return items;
        }
        return orderBy(items, ['year', 'month', 'day'], [order, order, order]);
    };
    UtilService.decorators = [
        { type: Injectable }
    ];
    return UtilService;
}());
export { UtilService };
if (false) {
    /** @type {?} */
    UtilService.prototype.weekDays;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZmFycmlzLWRhdGVwaWNrZXIudXRpbC5zZXJ2aWNlLmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGZhcnJpcy91aS1kYXRlcGlja2VyLyIsInNvdXJjZXMiOlsibGliL3NlcnZpY2VzL2ZhcnJpcy1kYXRlcGlja2VyLnV0aWwuc2VydmljZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7O0FBUUEsT0FBTyxFQUFFLFVBQVUsRUFBRSxNQUFNLGVBQWUsQ0FBQztBQWMzQyxPQUFPLEVBQUUsT0FBTyxFQUFFLE9BQU8sRUFBRSxRQUFRLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQztBQUNqRSxPQUFPLEVBQUUsQ0FBQyxFQUFFLEVBQUUsRUFBRSxDQUFDLEVBQUUsRUFBRSxFQUFFLEdBQUcsRUFBRSxJQUFJLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLFFBQVEsRUFBRSxTQUFTLEVBQUUsTUFBTSx3QkFBd0IsQ0FBQztBQUdsSCxPQUFPLEVBQUUsT0FBTyxFQUFFLE1BQU0sV0FBVyxDQUFDO0FBR3BDO0lBQUE7UUFFSSxhQUFRLEdBQWtCLENBQUMsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxDQUFDLENBQUM7SUEyd0IzRCxDQUFDOzs7Ozs7O0lBendCRyxpQ0FBVzs7Ozs7O0lBQVgsVUFBWSxPQUFlLEVBQUUsT0FBbUIsRUFBRSxRQUFnQjtRQUFoQix5QkFBQSxFQUFBLGdCQUFnQjs7O1lBRTFELFFBQWdCOztZQUFFLElBQUksR0FBRyxDQUFDOztZQUFFLE1BQU0sR0FBRyxDQUFDOztZQUFFLE1BQU0sR0FBRyxDQUFDOztZQUVoRCxVQUFVLEdBQVksSUFBSSxDQUFDLFNBQVMsRUFBRTtRQUU1QyxJQUFJLENBQUMsT0FBTyxJQUFJLENBQUMsT0FBTyxDQUFDLE1BQU0sRUFBRTtZQUM3QixP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OztJQUVELHdDQUFrQjs7Ozs7SUFBbEIsVUFBbUIsS0FBSyxFQUFFLEtBQW9DO1FBQXBDLHNCQUFBLEVBQUEsY0FBb0M7UUFDMUQsSUFBSSxLQUFLLEtBQUssS0FBSyxJQUFJLEtBQUssS0FBSyxNQUFNLEVBQUU7WUFDckMsS0FBSyxHQUFHLE1BQU0sQ0FBQztTQUNsQjtRQUVELElBQUksS0FBSyxLQUFLLE1BQU0sRUFBRTtZQUNsQixPQUFPLEtBQUssQ0FBQztTQUNoQjtRQUVELE9BQU8sT0FBTyxDQUFDLEtBQUssRUFBRSxDQUFDLE1BQU0sRUFBRSxPQUFPLEVBQUUsS0FBSyxDQUFDLEVBQUUsQ0FBQyxLQUFLLEVBQUUsS0FBSyxFQUFFLEtBQUssQ0FBQyxDQUFDLENBQUM7SUFDM0UsQ0FBQzs7Z0JBNXdCSixVQUFVOztJQTZ3Qlgsa0JBQUM7Q0FBQSxBQTd3QkQsSUE2d0JDO1NBNXdCWSxXQUFXOzs7SUFDcEIsK0JBQXVEIiwic291cmNlc0NvbnRlbnQiOlsiLypcclxuICogQEF1dGhvcjog55av54uC56eA5omNKEx1Y2FzIEh1YW5nKVxyXG4gKiBARGF0ZTogMjAxOS0wOS0wNCAwNzo0MDowNFxyXG4gKiBATGFzdEVkaXRvcnM6IOeWr+eLguengOaJjShMdWNhcyBIdWFuZylcclxuICogQExhc3RFZGl0VGltZTogMjAxOS0wOS0wNCAxNToyMTo0NlxyXG4gKiBAUVE6IDEwNTU4MTgyMzlcclxuICogQFZlcnNpb246IHYwLjAuMVxyXG4gKi9cclxuaW1wb3J0IHsgSW5qZWN0YWJsZSB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQge1xyXG4gICAgSU15RGF0ZU1vZGVsLFxyXG4gICAgSU15U2luZ2xlRGF0ZU1vZGVsLFxyXG4gICAgSU15RGF0ZVJhbmdlTW9kZWwsXHJcbiAgICBJTXlEYXRlLFxyXG4gICAgSU15RGF0ZVJhbmdlLFxyXG4gICAgSU15TW9udGgsXHJcbiAgICBJTXlNb250aExhYmVscyxcclxuICAgIElNeU1hcmtlZERhdGVzLFxyXG4gICAgSU15TWFya2VkRGF0ZSxcclxuICAgIElNeURhdGVGb3JtYXQsXHJcbiAgICBJTXlPcHRpb25zXHJcbn0gZnJvbSAnLi4vaW50ZXJmYWNlcy9wdWJsaWMtYXBpJztcclxuaW1wb3J0IHsgS2V5Q29kZSwgS2V5TmFtZSwgU2hvd1R5cGUgfSBmcm9tICcuLi9lbnVtcy9wdWJsaWMtYXBpJztcclxuaW1wb3J0IHsgRCwgREQsIE0sIE1NLCBNTU0sIFlZWVksIFNVLCBNTywgVFUsIFdFLCBUSCwgRlIsIFNBLCBaRVJPX1NUUiwgRU1QVFlfU1RSIH0gZnJvbSAnLi4vY29uc3RhbnRzL2NvbnN0YW50cyc7XHJcbmltcG9ydCB7IER5bmFtaWNEYXRhLCBEeW5hbWljRGF0ZVR5cGUgfSBmcm9tICcuLi9pbnRlcmZhY2VzL2R5bmFtaWMtZGF0YS10eXBlLmludGVyZmFjZSc7XHJcblxyXG5pbXBvcnQgeyBvcmRlckJ5IH0gZnJvbSAnbG9kYXNoLWVzJztcclxuaW1wb3J0IHsgTXVsdGlTZWxlY3RlZE9yZGVyQnkgfSBmcm9tICcuLi9pbnRlcmZhY2VzL215LW9wdGlvbnMuaW50ZXJmYWNlJztcclxuXHJcbkBJbmplY3RhYmxlKClcclxuZXhwb3J0IGNsYXNzIFV0aWxTZXJ2aWNlIHtcclxuICAgIHdlZWtEYXlzOiBBcnJheTxzdHJpbmc+ID0gW1NVLCBNTywgVFUsIFdFLCBUSCwgRlIsIFNBXTtcclxuXHJcbiAgICBpc0RhdGVWYWxpZChkYXRlU3RyOiBzdHJpbmcsIG9wdGlvbnM6IElNeU9wdGlvbnMsIGlzUmV0dXJuID0gZmFsc2UpOiBJTXlEYXRlIHtcclxuICAgICAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6b25lLXZhcmlhYmxlLXBlci1kZWNsYXJhdGlvblxyXG4gICAgICAgIGxldCBfZGF0ZVN0cjogc3RyaW5nLCBob3VyID0gMCwgbWludXRlID0gMCwgc2Vjb25kID0gMDtcclxuXHJcbiAgICAgICAgY29uc3QgcmV0dXJuRGF0ZTogSU15RGF0ZSA9IHRoaXMucmVzZXREYXRlKCk7XHJcblxyXG4gICAgICAgIGlmICghZGF0ZVN0ciB8fCAhZGF0ZVN0ci5sZW5ndGgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHJldHVybkRhdGU7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zdCB7IGRhdGVGb3JtYXQsIG1pblllYXIsIG1heFllYXIsIG1vbnRoTGFiZWxzLCBzaG93VGltZSwgcmV0dXJuRm9ybWF0LCBzaG93VHlwZSB9ID0gb3B0aW9ucztcclxuICAgICAgICBsZXQgX3N0ID0gc2hvd1RpbWU7XHJcbiAgICAgICAgbGV0IGZvcm1hdFN0ciA9IGRhdGVGb3JtYXQ7XHJcbiAgICAgICAgaWYgKGlzUmV0dXJuKSB7XHJcbiAgICAgICAgICAgIGZvcm1hdFN0ciA9IHJldHVybkZvcm1hdC5yZXBsYWNlKC9b5bm0LOaciF0vZywgJy0nKS5yZXBsYWNlKC9b5pelXS8sICcnKS5yZXBsYWNlKC9b5pe2LOWIhl0vZywgJzonKS5yZXBsYWNlKC9b56eSXS9nLCAnJyk7XHJcbiAgICAgICAgICAgIGRhdGVTdHIgPSBkYXRlU3RyLnJlcGxhY2UoL1vlubQs5pyIXS9nLCAnLScpLnJlcGxhY2UoL1vml6VdLywgJycpLnJlcGxhY2UoL1vml7Ys5YiGXS9nLCAnOicpLnJlcGxhY2UoL1vnp5JdL2csICcnKTtcclxuXHJcbiAgICAgICAgICAgIGlmIChkYXRlU3RyW2RhdGVTdHIubGVuZ3RoIC0gMV0gPT09ICctJyB8fCBkYXRlU3RyW2RhdGVTdHIubGVuZ3RoIC0gMV0gPT09ICc6Jykge1xyXG4gICAgICAgICAgICAgICAgZGF0ZVN0ciA9IGRhdGVTdHIuc3Vic3RyaW5nKDAsIGRhdGVTdHIubGVuZ3RoIC0gMSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmICghc2hvd1RpbWUgJiYgcmV0dXJuRm9ybWF0LnRvTG9jYWxlTG93ZXJDYXNlKCkuaW5kZXhPZignaGg6bW0nKSA+IC0xKSB7XHJcbiAgICAgICAgICAgICAgICBfc3QgPSB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zdCBkYXlzSW5Nb250aDogQXJyYXk8bnVtYmVyPiA9IFszMSwgMjgsIDMxLCAzMCwgMzEsIDMwLCAzMSwgMzEsIDMwLCAzMSwgMzAsIDMxXTtcclxuICAgICAgICBjb25zdCBpc01vbnRoU3RyOiBib29sZWFuID0gZm9ybWF0U3RyLmluZGV4T2YoTU1NKSAhPT0gLTE7XHJcbiAgICAgICAgbGV0IGRlbGltZXRlcnM6IEFycmF5PHN0cmluZz4gPSBmb3JtYXRTdHIubWF0Y2goL1teKERkTW1ZeSldezEsfS9nKTtcclxuICAgICAgICBpZiAoX3N0ICYmIGRhdGVTdHIpIHtcclxuICAgICAgICAgICAgX2RhdGVTdHIgPSBkYXRlU3RyLnNwbGl0KCcgJylbMF07XHJcbiAgICAgICAgICAgIE9iamVjdC5hc3NpZ24ocmV0dXJuRGF0ZSwgeyBob3VyOiAwLCBtaW51dGU6IDAsIHNlY29uZDogMCB9KTtcclxuICAgICAgICAgICAgY29uc3QgdGltZVN0ciA9IGRhdGVTdHIuc3BsaXQoJyAnKVsxXTtcclxuICAgICAgICAgICAgaWYgKHRpbWVTdHIpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IF90aW1lciA9IHRpbWVTdHIucmVwbGFjZSgn5pe2JywgJzonKS5yZXBsYWNlKCfliIYnLCAnOicpLnJlcGxhY2UoJ+enkicsICcnKS5zcGxpdCgnOicpO1xyXG4gICAgICAgICAgICAgICAgaWYgKF90aW1lclswXSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGhvdXIgPSBOdW1iZXIoX3RpbWVyWzBdLnN1YnN0cigwLCAyKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgaG91ciA9IGlzTmFOKGhvdXIpID8gMCA6IGhvdXI7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoX3RpbWVyWzFdKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbWludXRlID0gTnVtYmVyKF90aW1lclsxXS5zdWJzdHIoMCwgMikpO1xyXG4gICAgICAgICAgICAgICAgICAgIG1pbnV0ZSA9IGlzTmFOKG1pbnV0ZSkgPyAwIDogbWludXRlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGlmIChfdGltZXJbMl0pIHtcclxuICAgICAgICAgICAgICAgICAgICBzZWNvbmQgPSBOdW1iZXIoX3RpbWVyWzJdLnN1YnN0cigwLCAyKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgc2Vjb25kID0gaXNOYU4oc2Vjb25kKSA/IDAgOiBzZWNvbmQ7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBkZWxpbWV0ZXJzID0gdW5kZWZpbmVkO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgcmVnID0gL15cXGR7MSx9JC87XHJcbiAgICAgICAgICAgICAgICBpZiAocmVnLnRlc3QoZGF0ZVN0cikpIHsgLy8g6aqM6K+B5Lyg5YWl55qE5qC85byP5Li6IHl5eXlNTWRkSEhtbXNzXHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZGYgPSBmb3JtYXRTdHI7XHJcbiAgICAgICAgICAgICAgICAgICAgX2RhdGVTdHIgPSBkYXRlU3RyLnN1YnN0cigwLCA4KTtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgX3RpbWVyID0gZGF0ZVN0ci5zdWJzdHIoOCk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKF90aW1lcikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGYuaW5jbHVkZXMoJ0hIJykpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChfdGltZXIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBob3VyID0gK190aW1lci5zbGljZSgwLCAyKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGltZXIgPSBfdGltZXIuc2xpY2UoMik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRmLmluY2x1ZGVzKCdtbScpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoX3RpbWVyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWludXRlID0gK190aW1lci5zbGljZSgwLCAyKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGltZXIgPSBfdGltZXIuc2xpY2UoMik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRmLmluY2x1ZGVzKCdzcycpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoX3RpbWVyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2Vjb25kID0gK190aW1lci5zbGljZSgwLCAyKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIF9kYXRlU3RyID0gZGF0ZVN0ciA/IGRhdGVTdHIuc3BsaXQoJyAnKVswXSA6ICcnO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCBkYXRlVmFsdWU6IEFycmF5PElNeURhdGVGb3JtYXQ+ID0gdGhpcy5nZXREYXRlVmFsdWUoX2RhdGVTdHIsIGZvcm1hdFN0ciwgZGVsaW1ldGVycyk7XHJcblxyXG4gICAgICAgIGNvbnN0IHllYXI6IG51bWJlciA9IHRoaXMuZ2V0TnVtYmVyQnlWYWx1ZShkYXRlVmFsdWVbMF0pO1xyXG4gICAgICAgIGNvbnN0IG1vbnRoOiBudW1iZXIgPSBpc01vbnRoU3RyXHJcbiAgICAgICAgICAgID8gdGhpcy5nZXRNb250aE51bWJlckJ5TW9udGhOYW1lKGRhdGVWYWx1ZVsxXSwgbW9udGhMYWJlbHMpXHJcbiAgICAgICAgICAgIDogdGhpcy5nZXROdW1iZXJCeVZhbHVlKGRhdGVWYWx1ZVsxXSk7XHJcbiAgICAgICAgY29uc3QgZGF5OiBudW1iZXIgPSB0aGlzLmdldE51bWJlckJ5VmFsdWUoZGF0ZVZhbHVlWzJdKTtcclxuXHJcbiAgICAgICAgaWYgKHNob3dUeXBlID09PSBTaG93VHlwZS5ub0RhdGVBbmRNb250aCkge1xyXG4gICAgICAgICAgICByZXR1cm4geyB5ZWFyLCBtb250aDogMSwgZGF5OiAxIH07XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAobW9udGggIT09IC0xICYmIGRheSAhPT0gLTEgJiYgeWVhciAhPT0gLTEpIHtcclxuICAgICAgICAgICAgaWYgKHllYXIgPCBtaW5ZZWFyIHx8IHllYXIgPiBtYXhZZWFyIHx8IG1vbnRoIDwgMSB8fCBtb250aCA+IDEyKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcmV0dXJuRGF0ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjb25zdCBkYXRlOiBJTXlEYXRlID0gX3N0ID8geyB5ZWFyLCBtb250aCwgZGF5LCBob3VyLCBtaW51dGUsIHNlY29uZCB9IDogeyB5ZWFyLCBtb250aCwgZGF5IH07XHJcblxyXG4gICAgICAgICAgICBpZiAodGhpcy5pc0Rpc2FibGVkRGF0ZShkYXRlLCBvcHRpb25zKSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJldHVybkRhdGU7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmICh5ZWFyICUgNDAwID09PSAwIHx8ICh5ZWFyICUgMTAwICE9PSAwICYmIHllYXIgJSA0ID09PSAwKSkge1xyXG4gICAgICAgICAgICAgICAgZGF5c0luTW9udGhbMV0gPSAyOTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKGRheSA8IDEgfHwgZGF5ID4gZGF5c0luTW9udGhbbW9udGggLSAxXSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJldHVybkRhdGU7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC8vIFZhbGlkIGRhdGVcclxuICAgICAgICAgICAgaWYgKG9wdGlvbnMuc2hvd1R5cGUgPT09IFNob3dUeXBlLm5vRGF0ZSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHsgeWVhcjogZGF0ZS55ZWFyLCBtb250aDogZGF0ZS5tb250aCB9O1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKG9wdGlvbnMuc2hvd1R5cGUgPT09IFNob3dUeXBlLm5vRGF0ZUFuZE1vbnRoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4geyB5ZWFyOiBkYXRlLnllYXIgfTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBkYXRlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiByZXR1cm5EYXRlO1xyXG4gICAgfVxyXG5cclxuICAgIGlzRGF0ZVZhbGlkRGF0ZVJhbmdlKGRhdGVSYW5nZVN0cjogc3RyaW5nLCBvcHRpb25zOiBJTXlPcHRpb25zKTogSU15RGF0ZVJhbmdlIHtcclxuICAgICAgICBsZXQgZGF0ZVJhbmdlOiBJTXlEYXRlUmFuZ2UgPSB7XHJcbiAgICAgICAgICAgIGJlZ2luOiB0aGlzLnJlc2V0RGF0ZSgpLFxyXG4gICAgICAgICAgICBlbmQ6IHRoaXMucmVzZXREYXRlKClcclxuICAgICAgICB9O1xyXG4gICAgICAgIGlmIChkYXRlUmFuZ2VTdHIgJiYgZGF0ZVJhbmdlU3RyLmxlbmd0aCkge1xyXG4gICAgICAgICAgICBjb25zdCBkYXRlczogQXJyYXk8c3RyaW5nPiA9IGRhdGVSYW5nZVN0ci5zcGxpdChvcHRpb25zLmRhdGVSYW5nZURhdGVzRGVsaW1pdGVyKTtcclxuICAgICAgICAgICAgaWYgKGRhdGVzICYmIGRhdGVzLmxlbmd0aCA9PT0gMikge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgW2JlZ2luRGF0ZSwgZW5kRGF0ZV0gPSBkYXRlcztcclxuICAgICAgICAgICAgICAgIGNvbnN0IGJlZ2luOiBJTXlEYXRlID0gdGhpcy5pc0RhdGVWYWxpZChiZWdpbkRhdGUsIG9wdGlvbnMsIHRydWUpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaXNJbml0aWFsaXplZERhdGUoYmVnaW4pKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZW5kOiBJTXlEYXRlID0gdGhpcy5pc0RhdGVWYWxpZChlbmREYXRlLCBvcHRpb25zLCB0cnVlKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuaXNJbml0aWFsaXplZERhdGUoZW5kKSAmJiB0aGlzLmlzRGF0ZVNhbWVPckVhcmxpZXIoYmVnaW4sIGVuZCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZVJhbmdlID0geyBiZWdpbiwgZW5kIH07XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBkYXRlUmFuZ2U7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0RGF0ZVZhbHVlKGRhdGVTdHI6IHN0cmluZywgZGF0ZUZvcm1hdDogc3RyaW5nLCBkZWxpbWV0ZXJzOiBBcnJheTxzdHJpbmc+KTogQXJyYXk8SU15RGF0ZUZvcm1hdD4ge1xyXG4gICAgICAgIGNvbnN0IGRhOiBBcnJheTxJTXlEYXRlRm9ybWF0PiA9IFtdO1xyXG5cclxuICAgICAgICBpZiAoZGVsaW1ldGVycykge1xyXG4gICAgICAgICAgICBsZXQgZGVsOiBzdHJpbmcgPSBkZWxpbWV0ZXJzWzBdO1xyXG4gICAgICAgICAgICBpZiAoZGVsaW1ldGVyc1swXSAhPT0gZGVsaW1ldGVyc1sxXSkge1xyXG4gICAgICAgICAgICAgICAgZGVsID0gZGVsaW1ldGVyc1swXSArIGRlbGltZXRlcnNbMV07XHJcbiAgICAgICAgICAgICAgICBpZiAoZGVsaW1ldGVyc1syXSAmJiBkZWxpbWV0ZXJzWzFdICE9PSBkZWxpbWV0ZXJzWzJdKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZGVsID0gZGVsICsgZGVsaW1ldGVyc1syXTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjb25zdCByZTogYW55ID0gbmV3IFJlZ0V4cCgnWycgKyBkZWwgKyAnXScpO1xyXG4gICAgICAgICAgICBjb25zdCBkczogQXJyYXk8c3RyaW5nPiA9IGRhdGVTdHIuc3BsaXQocmUpO1xyXG4gICAgICAgICAgICBjb25zdCBkZjogQXJyYXk8c3RyaW5nPiA9IGRhdGVGb3JtYXQuc3BsaXQocmUpO1xyXG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGRmLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoZGZbaV0uaW5kZXhPZihZWVlZKSAhPT0gLTEpIHtcclxuICAgICAgICAgICAgICAgICAgICBkYVswXSA9IHsgdmFsdWU6IGRzW2ldLCBmb3JtYXQ6IGRmW2ldIH07XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoZGZbaV0uaW5kZXhPZihNKSAhPT0gLTEpIHtcclxuICAgICAgICAgICAgICAgICAgICBkYVsxXSA9IGRzW2ldID09PSB1bmRlZmluZWQgPyB7IHZhbHVlOiAnMScsIGZvcm1hdDogZGZbaV0gfSA6IHsgdmFsdWU6IGRzW2ldLCBmb3JtYXQ6IGRmW2ldIH07XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoZGZbaV0uaW5kZXhPZihEKSAhPT0gLTEpIHtcclxuICAgICAgICAgICAgICAgICAgICBkYVsyXSA9IGRzW2ldID09PSB1bmRlZmluZWQgPyB7IHZhbHVlOiAnMScsIGZvcm1hdDogZGZbaV0gfSA6IHsgdmFsdWU6IGRzW2ldLCBmb3JtYXQ6IGRmW2ldIH07XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBjb25zdCB5ZWFySW5kZXggPSAoZGF0ZUZvcm1hdCArICcnKS5pbmRleE9mKFlZWVkpO1xyXG4gICAgICAgICAgICBjb25zdCBtb250aEluZGV4ID0gKGRhdGVGb3JtYXQgKyAnJykuaW5kZXhPZihNTSk7XHJcbiAgICAgICAgICAgIGNvbnN0IGRheUluZGV4ID0gKGRhdGVGb3JtYXQgKyAnJykuaW5kZXhPZihERCk7XHJcbiAgICAgICAgICAgIGlmICh5ZWFySW5kZXggPj0gMCkge1xyXG4gICAgICAgICAgICAgICAgZGFbMF0gPSB7IHZhbHVlOiBkYXRlU3RyLnN1YnN0cmluZyh5ZWFySW5kZXgsIHllYXJJbmRleCArIDQpLCBmb3JtYXQ6IGRhdGVGb3JtYXQuc3Vic3RyaW5nKHllYXJJbmRleCwgeWVhckluZGV4ICsgNCkgfTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAobW9udGhJbmRleCA+PSAwKSB7XHJcbiAgICAgICAgICAgICAgICBkYVsxXSA9IHsgdmFsdWU6IGRhdGVTdHIuc3Vic3RyaW5nKG1vbnRoSW5kZXgsIG1vbnRoSW5kZXggKyAyKSwgZm9ybWF0OiBkYXRlRm9ybWF0LnN1YnN0cmluZyhtb250aEluZGV4LCBtb250aEluZGV4ICsgMikgfTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoZGF5SW5kZXggPj0gMCkge1xyXG4gICAgICAgICAgICAgICAgZGFbMl0gPSB7IHZhbHVlOiBkYXRlU3RyLnN1YnN0cmluZyhkYXlJbmRleCwgZGF5SW5kZXggKyAyKSB8fCAnMDEnLCBmb3JtYXQ6IGRhdGVGb3JtYXQuc3Vic3RyaW5nKGRheUluZGV4LCBkYXlJbmRleCArIDIpIH07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGRhO1xyXG4gICAgfVxyXG5cclxuICAgIGdldE1vbnRoTnVtYmVyQnlNb250aE5hbWUoZGY6IElNeURhdGVGb3JtYXQsIG1vbnRoTGFiZWxzOiBJTXlNb250aExhYmVscyk6IG51bWJlciB7XHJcbiAgICAgICAgaWYgKGRmLnZhbHVlKSB7XHJcbiAgICAgICAgICAgIGZvciAobGV0IGtleSA9IDE7IGtleSA8PSAxMjsga2V5KyspIHtcclxuICAgICAgICAgICAgICAgIGlmIChkZi52YWx1ZS50b0xvd2VyQ2FzZSgpID09PSBtb250aExhYmVsc1trZXldLnRvTG93ZXJDYXNlKCkpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4ga2V5O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiAtMTtcclxuICAgIH1cclxuXHJcbiAgICBnZXROdW1iZXJCeVZhbHVlKGRmOiBJTXlEYXRlRm9ybWF0KTogbnVtYmVyIHtcclxuICAgICAgICBpZiAoIWRmKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAxO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoIS9eXFxkKyQvLnRlc3QoZGYudmFsdWUpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAtMTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGxldCBuYnI6IG51bWJlciA9IE51bWJlcihkZi52YWx1ZSk7XHJcbiAgICAgICAgaWYgKFxyXG4gICAgICAgICAgICAoZGYuZm9ybWF0Lmxlbmd0aCA9PT0gMSAmJiBkZi52YWx1ZS5sZW5ndGggIT09IDEgJiYgbmJyIDwgMTApIHx8XHJcbiAgICAgICAgICAgIChkZi5mb3JtYXQubGVuZ3RoID09PSAxICYmIGRmLnZhbHVlLmxlbmd0aCAhPT0gMiAmJiBuYnIgPj0gMTApXHJcbiAgICAgICAgKSB7XHJcbiAgICAgICAgICAgIG5iciA9IC0xO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoZGYuZm9ybWF0Lmxlbmd0aCA9PT0gMiAmJiBkZi52YWx1ZS5sZW5ndGggPiAyKSB7XHJcbiAgICAgICAgICAgIG5iciA9IC0xO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gbmJyO1xyXG4gICAgfVxyXG5cclxuICAgIHBhcnNlRGVmYXVsdE1vbnRoKG1vbnRoU3RyaW5nOiBzdHJpbmcpOiBJTXlNb250aCB7XHJcbiAgICAgICAgY29uc3QgbW9udGg6IElNeU1vbnRoID0geyBtb250aFR4dDogRU1QVFlfU1RSLCBtb250aE5icjogMCwgeWVhcjogMCB9O1xyXG4gICAgICAgIGlmIChtb250aFN0cmluZyAhPT0gRU1QVFlfU1RSKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHNwbGl0ID0gbW9udGhTdHJpbmcuc3BsaXQobW9udGhTdHJpbmcubWF0Y2goL1teMC05XS8pWzBdKTtcclxuICAgICAgICAgICAgbW9udGgubW9udGhOYnIgPSBzcGxpdFswXS5sZW5ndGggPT09IDIgPyBOdW1iZXIoc3BsaXRbMF0pIDogTnVtYmVyKHNwbGl0WzFdKTtcclxuICAgICAgICAgICAgbW9udGgueWVhciA9IHNwbGl0WzBdLmxlbmd0aCA9PT0gMiA/IE51bWJlcihzcGxpdFsxXSkgOiBOdW1iZXIoc3BsaXRbMF0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gbW9udGg7XHJcbiAgICB9XHJcblxyXG4gICAgaXNEaXNhYmxlZERhdGUoZGF0ZTogSU15RGF0ZSwgb3B0aW9uczogSU15T3B0aW9ucyk6IGJvb2xlYW4ge1xyXG4gICAgICAgIGNvbnN0IHtcclxuICAgICAgICAgICAgbWluWWVhcixcclxuICAgICAgICAgICAgbWF4WWVhcixcclxuICAgICAgICAgICAgZGlzYWJsZVVudGlsLFxyXG4gICAgICAgICAgICBkaXNhYmxlU2luY2UsXHJcbiAgICAgICAgICAgIGRpc2FibGVXZWVrZW5kcyxcclxuICAgICAgICAgICAgZGlzYWJsZURhdGVzLFxyXG4gICAgICAgICAgICBkaXNhYmxlRGF0ZVJhbmdlcyxcclxuICAgICAgICAgICAgZGlzYWJsZVdlZWtkYXlzLFxyXG4gICAgICAgICAgICBlbmFibGVEYXRlc1xyXG4gICAgICAgIH0gPSBvcHRpb25zO1xyXG5cclxuICAgICAgICAvLyBmb3IgKGNvbnN0IGQgb2YgZW5hYmxlRGF0ZXMpIHtcclxuICAgICAgICAvLyAgICAgaWYgKFxyXG4gICAgICAgIC8vICAgICAgICAgKGQueWVhciA9PT0gMCB8fCBkLnllYXIgPT09IGRhdGUueWVhcikgJiZcclxuICAgICAgICAvLyAgICAgICAgIChkLm1vbnRoID09PSAwIHx8IGQubW9udGggPT09IGRhdGUubW9udGgpICYmXHJcbiAgICAgICAgLy8gICAgICAgICBkLmRheSA9PT0gZGF0ZS5kYXlcclxuICAgICAgICAvLyAgICAgKSB7XHJcbiAgICAgICAgLy8gICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgLy8gICAgIH1cclxuICAgICAgICAvLyB9XHJcblxyXG4gICAgICAgIGlmICgoZGF0ZS55ZWFyIDwgbWluWWVhciAmJiBkYXRlLm1vbnRoID09PSAxMikgfHwgKGRhdGUueWVhciA+IG1heFllYXIgJiYgZGF0ZS5tb250aCA9PT0gMSkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IGRhdGVNczogbnVtYmVyID0gdGhpcy5nZXRUaW1lSW5NaWxsaXNlY29uZHMoZGF0ZSk7XHJcbiAgICAgICAgaWYgKHRoaXMuaXNJbml0aWFsaXplZERhdGUoZGlzYWJsZVVudGlsKSAmJiAoZGF0ZU1zICsgMjQgKiA2MCAqIDYwICogMTAwMCAtIDEpIDwgdGhpcy5nZXRUaW1lSW5NaWxsaXNlY29uZHMoZGlzYWJsZVVudGlsKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMuaXNJbml0aWFsaXplZERhdGUoZGlzYWJsZVNpbmNlKSAmJiBkYXRlTXMgPiB0aGlzLmdldFRpbWVJbk1pbGxpc2Vjb25kcyhkaXNhYmxlU2luY2UpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKGRpc2FibGVXZWVrZW5kcykge1xyXG4gICAgICAgICAgICBjb25zdCBkYXlOYnIgPSB0aGlzLmdldERheU51bWJlcihkYXRlKTtcclxuICAgICAgICAgICAgaWYgKGRheU5iciA9PT0gMCB8fCBkYXlOYnIgPT09IDYpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zdCBkbiA9IHRoaXMuZ2V0RGF5TnVtYmVyKGRhdGUpO1xyXG4gICAgICAgIGlmIChkaXNhYmxlV2Vla2RheXMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICBmb3IgKGNvbnN0IHdkIG9mIGRpc2FibGVXZWVrZGF5cykge1xyXG4gICAgICAgICAgICAgICAgaWYgKGRuID09PSB0aGlzLmdldFdlZWtkYXlJbmRleCh3ZCkpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZm9yIChjb25zdCBkIG9mIGRpc2FibGVEYXRlcykge1xyXG4gICAgICAgICAgICBpZiAoXHJcbiAgICAgICAgICAgICAgICAoZC55ZWFyID09PSAwIHx8IGQueWVhciA9PT0gZGF0ZS55ZWFyKSAmJlxyXG4gICAgICAgICAgICAgICAgKGQubW9udGggPT09IDAgfHwgZC5tb250aCA9PT0gZGF0ZS5tb250aCkgJiZcclxuICAgICAgICAgICAgICAgIGQuZGF5ID09PSBkYXRlLmRheVxyXG4gICAgICAgICAgICApIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmb3IgKGNvbnN0IGQgb2YgZGlzYWJsZURhdGVSYW5nZXMpIHtcclxuICAgICAgICAgICAgaWYgKFxyXG4gICAgICAgICAgICAgICAgdGhpcy5pc0luaXRpYWxpemVkRGF0ZShkLmJlZ2luKSAmJlxyXG4gICAgICAgICAgICAgICAgdGhpcy5pc0luaXRpYWxpemVkRGF0ZShkLmVuZCkgJiZcclxuICAgICAgICAgICAgICAgIGRhdGVNcyA+PSB0aGlzLmdldFRpbWVJbk1pbGxpc2Vjb25kcyhkLmJlZ2luKSAmJlxyXG4gICAgICAgICAgICAgICAgZGF0ZU1zIDw9IHRoaXMuZ2V0VGltZUluTWlsbGlzZWNvbmRzKGQuZW5kKVxyXG4gICAgICAgICAgICApIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuXHJcbiAgICBpc01hcmtlZERhdGUoZGF0ZTogSU15RGF0ZSwgbWFya2VkRGF0ZXM6IEFycmF5PElNeU1hcmtlZERhdGVzPiwgbWFya1dlZWtlbmRzOiBJTXlNYXJrZWREYXRlKTogSU15TWFya2VkRGF0ZSB7XHJcbiAgICAgICAgZm9yIChjb25zdCBtZCBvZiBtYXJrZWREYXRlcykge1xyXG4gICAgICAgICAgICBmb3IgKGNvbnN0IGQgb2YgbWQuZGF0ZXMpIHtcclxuICAgICAgICAgICAgICAgIGlmIChcclxuICAgICAgICAgICAgICAgICAgICAoZC55ZWFyID09PSAwIHx8IGQueWVhciA9PT0gZGF0ZS55ZWFyKSAmJlxyXG4gICAgICAgICAgICAgICAgICAgIChkLm1vbnRoID09PSAwIHx8IGQubW9udGggPT09IGRhdGUubW9udGgpICYmXHJcbiAgICAgICAgICAgICAgICAgICAgZC5kYXkgPT09IGRhdGUuZGF5XHJcbiAgICAgICAgICAgICAgICApIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4geyBtYXJrZWQ6IHRydWUsIGNvbG9yOiBtZC5jb2xvciB9O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChtYXJrV2Vla2VuZHMgJiYgbWFya1dlZWtlbmRzLm1hcmtlZCkge1xyXG4gICAgICAgICAgICBjb25zdCBkYXlOYnIgPSB0aGlzLmdldERheU51bWJlcihkYXRlKTtcclxuICAgICAgICAgICAgaWYgKGRheU5iciA9PT0gMCB8fCBkYXlOYnIgPT09IDYpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB7IG1hcmtlZDogdHJ1ZSwgY29sb3I6IG1hcmtXZWVrZW5kcy5jb2xvciB9O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB7IG1hcmtlZDogZmFsc2UsIGNvbG9yOiBFTVBUWV9TVFIgfTtcclxuICAgIH1cclxuXHJcbiAgICBpc0hpZ2hsaWdodGVkRGF0ZShcclxuICAgICAgICBkYXRlOiBJTXlEYXRlLFxyXG4gICAgICAgIHN1bkhpZ2hsaWdodDogYm9vbGVhbixcclxuICAgICAgICBzYXRIaWdobGlnaHQ6IGJvb2xlYW4sXHJcbiAgICAgICAgaGlnaGxpZ2h0RGF0ZXM6IEFycmF5PElNeURhdGU+XHJcbiAgICApOiBib29sZWFuIHtcclxuICAgICAgICBjb25zdCBkYXlOYnI6IG51bWJlciA9IHRoaXMuZ2V0RGF5TnVtYmVyKGRhdGUpO1xyXG4gICAgICAgIGlmICgoc3VuSGlnaGxpZ2h0ICYmIGRheU5iciA9PT0gMCkgfHwgKHNhdEhpZ2hsaWdodCAmJiBkYXlOYnIgPT09IDYpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBmb3IgKGNvbnN0IGQgb2YgaGlnaGxpZ2h0RGF0ZXMpIHtcclxuICAgICAgICAgICAgaWYgKFxyXG4gICAgICAgICAgICAgICAgKGQueWVhciA9PT0gMCB8fCBkLnllYXIgPT09IGRhdGUueWVhcikgJiZcclxuICAgICAgICAgICAgICAgIChkLm1vbnRoID09PSAwIHx8IGQubW9udGggPT09IGRhdGUubW9udGgpICYmXHJcbiAgICAgICAgICAgICAgICBkLmRheSA9PT0gZGF0ZS5kYXlcclxuICAgICAgICAgICAgKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0V2Vla051bWJlcihkYXRlOiBJTXlEYXRlKTogbnVtYmVyIHtcclxuICAgICAgICBjb25zdCBkOiBEYXRlID0gbmV3IERhdGUoZGF0ZS55ZWFyLCBkYXRlLm1vbnRoIC0gMSwgZGF0ZS5kYXksIDAsIDAsIDAsIDApO1xyXG4gICAgICAgIGQuc2V0RGF0ZShkLmdldERhdGUoKSArIChkLmdldERheSgpID09PSAwID8gLTMgOiA0IC0gZC5nZXREYXkoKSkpO1xyXG4gICAgICAgIHJldHVybiBNYXRoLnJvdW5kKChkLmdldFRpbWUoKSAtIG5ldyBEYXRlKGQuZ2V0RnVsbFllYXIoKSwgMCwgNCkuZ2V0VGltZSgpKSAvIDg2NDAwMDAwIC8gNykgKyAxO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBnZXROb3dXZWVrVGltZShkYXRlOiBEYXRlKTogSU15RGF0ZVJhbmdlIHtcclxuICAgICAgICBkYXRlLnNldERhdGUoZGF0ZS5nZXREYXRlKCkgLSAoKGRhdGUuZ2V0RGF5KCkgKyA2KSAlIDcpKTtcclxuICAgICAgICBjb25zdCBiZWdpbiA9IHtcclxuICAgICAgICAgICAgeWVhcjogZGF0ZS5nZXRGdWxsWWVhcigpLFxyXG4gICAgICAgICAgICBtb250aDogZGF0ZS5nZXRNb250aCgpICsgMSxcclxuICAgICAgICAgICAgZGF5OiBkYXRlLmdldERhdGUoKVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgZGF0ZS5zZXREYXRlKGRhdGUuZ2V0RGF0ZSgpICsgNik7XHJcbiAgICAgICAgY29uc3QgZW5kID0ge1xyXG4gICAgICAgICAgICB5ZWFyOiBkYXRlLmdldEZ1bGxZZWFyKCksXHJcbiAgICAgICAgICAgIG1vbnRoOiBkYXRlLmdldE1vbnRoKCkgKyAxLFxyXG4gICAgICAgICAgICBkYXk6IGRhdGUuZ2V0RGF0ZSgpXHJcbiAgICAgICAgfTtcclxuICAgICAgICByZXR1cm4geyBiZWdpbiwgZW5kIH07XHJcbiAgICB9XHJcblxyXG4gICAgaXNNb250aERpc2FibGVkQnlEaXNhYmxlVW50aWwoZGF0ZTogSU15RGF0ZSwgZGlzYWJsZVVudGlsOiBJTXlEYXRlKTogYm9vbGVhbiB7XHJcbiAgICAgICAgcmV0dXJuIChcclxuICAgICAgICAgICAgdGhpcy5pc0luaXRpYWxpemVkRGF0ZShkaXNhYmxlVW50aWwpICYmXHJcbiAgICAgICAgICAgIHRoaXMuZ2V0VGltZUluTWlsbGlzZWNvbmRzKGRhdGUpIDw9IHRoaXMuZ2V0VGltZUluTWlsbGlzZWNvbmRzKGRpc2FibGVVbnRpbClcclxuICAgICAgICApO1xyXG4gICAgfVxyXG5cclxuICAgIGlzTW9udGhEaXNhYmxlZEJ5RGlzYWJsZVNpbmNlKGRhdGU6IElNeURhdGUsIGRpc2FibGVTaW5jZTogSU15RGF0ZSk6IGJvb2xlYW4ge1xyXG4gICAgICAgIHJldHVybiAoXHJcbiAgICAgICAgICAgIHRoaXMuaXNJbml0aWFsaXplZERhdGUoZGlzYWJsZVNpbmNlKSAmJlxyXG4gICAgICAgICAgICB0aGlzLmdldFRpbWVJbk1pbGxpc2Vjb25kcyhkYXRlKSA+PSB0aGlzLmdldFRpbWVJbk1pbGxpc2Vjb25kcyhkaXNhYmxlU2luY2UpXHJcbiAgICAgICAgKTtcclxuICAgIH1cclxuXHJcbiAgICBnZXREYXRlTW9kZWwoXHJcbiAgICAgICAgZGF0ZTogSU15RGF0ZSxcclxuICAgICAgICBkYXRlUmFuZ2U6IElNeURhdGVSYW5nZSxcclxuICAgICAgICBkYXRlRm9ybWF0OiBzdHJpbmcsXHJcbiAgICAgICAgbW9udGhMYWJlbHM6IElNeU1vbnRoTGFiZWxzLFxyXG4gICAgICAgIHJhbmdlRGVsaW1pdGVyOiBzdHJpbmcsXHJcbiAgICAgICAgcmV0dXJuRm9ybWF0OiBzdHJpbmcsXHJcbiAgICAgICAgZGF0ZVN0cjogc3RyaW5nID0gRU1QVFlfU1RSXHJcbiAgICApOiBJTXlEYXRlTW9kZWwge1xyXG4gICAgICAgIGxldCBzaW5nbGVEYXRlTW9kZWw6IElNeVNpbmdsZURhdGVNb2RlbCA9IG51bGw7XHJcbiAgICAgICAgbGV0IGRhdGVSYW5nZU1vZGVsOiBJTXlEYXRlUmFuZ2VNb2RlbCA9IG51bGw7XHJcblxyXG4gICAgICAgIGlmIChkYXRlKSB7XHJcbiAgICAgICAgICAgIHNpbmdsZURhdGVNb2RlbCA9IHtcclxuICAgICAgICAgICAgICAgIGRhdGUsXHJcbiAgICAgICAgICAgICAgICBqc0RhdGU6IHRoaXMuZ2V0RGF0ZTIoZGF0ZSksXHJcbiAgICAgICAgICAgICAgICBmb3JtYXR0ZWQ6IGRhdGVTdHIubGVuZ3RoID8gZGF0ZVN0ciA6IHRoaXMuZm9ybWF0RGF0ZShkYXRlLCBkYXRlRm9ybWF0LCBtb250aExhYmVscyksXHJcbiAgICAgICAgICAgICAgICByZXR1cm5Gb3JtYXR0ZWQ6IHRoaXMuZm9ybWF0RGF0ZShkYXRlLCByZXR1cm5Gb3JtYXQsIG1vbnRoTGFiZWxzKSxcclxuICAgICAgICAgICAgICAgIGVwb2M6IHRoaXMuZ2V0RXBvY1RpbWUoZGF0ZSlcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBkYXRlUmFuZ2VNb2RlbCA9IHtcclxuICAgICAgICAgICAgICAgIGJlZ2luRGF0ZTogZGF0ZVJhbmdlLmJlZ2luLFxyXG4gICAgICAgICAgICAgICAgYmVnaW5Kc0RhdGU6IHRoaXMuZ2V0RGF0ZShkYXRlUmFuZ2UuYmVnaW4pLFxyXG4gICAgICAgICAgICAgICAgYmVnaW5FcG9jOiB0aGlzLmdldEVwb2NUaW1lKGRhdGVSYW5nZS5iZWdpbiksXHJcbiAgICAgICAgICAgICAgICBlbmREYXRlOiBkYXRlUmFuZ2UuZW5kLFxyXG4gICAgICAgICAgICAgICAgZW5kSnNEYXRlOiB0aGlzLmdldERhdGUoZGF0ZVJhbmdlLmVuZCksXHJcbiAgICAgICAgICAgICAgICBlbmRFcG9jOiB0aGlzLmdldEVwb2NUaW1lKGRhdGVSYW5nZS5lbmQpLFxyXG4gICAgICAgICAgICAgICAgZm9ybWF0dGVkOlxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZm9ybWF0RGF0ZShkYXRlUmFuZ2UuYmVnaW4sIGRhdGVGb3JtYXQsIG1vbnRoTGFiZWxzKSArXHJcbiAgICAgICAgICAgICAgICAgICAgcmFuZ2VEZWxpbWl0ZXIgK1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZm9ybWF0RGF0ZShkYXRlUmFuZ2UuZW5kLCBkYXRlRm9ybWF0LCBtb250aExhYmVscyksXHJcbiAgICAgICAgICAgICAgICByZXR1cm5Gb3JtYXR0ZWQ6XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5mb3JtYXREYXRlKGRhdGVSYW5nZS5iZWdpbiwgcmV0dXJuRm9ybWF0LCBtb250aExhYmVscykgK1xyXG4gICAgICAgICAgICAgICAgICAgIHJhbmdlRGVsaW1pdGVyICtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmZvcm1hdERhdGUoZGF0ZVJhbmdlLmVuZCwgcmV0dXJuRm9ybWF0LCBtb250aExhYmVscyksXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIGlzUmFuZ2U6IGRhdGUgPT09IG51bGwsXHJcbiAgICAgICAgICAgIHNpbmdsZURhdGU6IHNpbmdsZURhdGVNb2RlbCxcclxuICAgICAgICAgICAgZGF0ZVJhbmdlOiBkYXRlUmFuZ2VNb2RlbFxyXG4gICAgICAgIH07XHJcbiAgICB9XHJcblxyXG4gICAgZm9ybWF0RGF0ZShkYXRlOiBJTXlEYXRlLCBkYXRlRm9ybWF0OiBzdHJpbmcsIG1vbnRoTGFiZWxzOiBJTXlNb250aExhYmVscyk6IHN0cmluZyB7XHJcbiAgICAgICAgaWYgKCFkYXRlLm1vbnRoICYmIGRhdGVGb3JtYXQuaW5kZXhPZihNTSkgPT09IC0xKSB7XHJcbiAgICAgICAgICAgIGRhdGVGb3JtYXQgPSB0aGlzLmRlbGV0ZShkYXRlRm9ybWF0LCBNTSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICghZGF0ZS5kYXkgJiYgZGF0ZUZvcm1hdC5pbmRleE9mKEREKSA9PT0gLTEpIHtcclxuICAgICAgICAgICAgZGF0ZUZvcm1hdCA9IHRoaXMuZGVsZXRlKGRhdGVGb3JtYXQsIEREKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgbGV0IGZvcm1hdHRlZDogc3RyaW5nID0gZGF0ZUZvcm1hdC5yZXBsYWNlKFlZWVksIFN0cmluZyhkYXRlLnllYXIpKTtcclxuXHJcbiAgICAgICAgaWYgKGRhdGVGb3JtYXQuaW5kZXhPZihNKSA9PT0gLTEpIHtcclxuICAgICAgICAgICAgZm9ybWF0dGVkID0gZm9ybWF0dGVkLnJlcGxhY2UoTU0sICcwMScpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGlmIChkYXRlRm9ybWF0LmluZGV4T2YoTU1NKSAhPT0gLTEpIHtcclxuICAgICAgICAgICAgICAgIGZvcm1hdHRlZCA9IGZvcm1hdHRlZC5yZXBsYWNlKE1NTSwgbW9udGhMYWJlbHNbZGF0ZS5tb250aF0pO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKGRhdGVGb3JtYXQuaW5kZXhPZihNTSkgIT09IC0xKSB7XHJcbiAgICAgICAgICAgICAgICBmb3JtYXR0ZWQgPSBmb3JtYXR0ZWQucmVwbGFjZShNTSwgdGhpcy5wcmVaZXJvKGRhdGUubW9udGggfHwgMSkpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgZm9ybWF0dGVkID0gZm9ybWF0dGVkLnJlcGxhY2UoTSwgU3RyaW5nKGRhdGUubW9udGggfHwgMSkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoZGF0ZUZvcm1hdC5pbmRleE9mKEREKSA9PT0gLTEpIHtcclxuICAgICAgICAgICAgZm9ybWF0dGVkID0gZm9ybWF0dGVkLnJlcGxhY2UoREQsICcwMScpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoZGF0ZUZvcm1hdC5pbmRleE9mKEREKSAhPT0gLTEpIHtcclxuICAgICAgICAgICAgZm9ybWF0dGVkID0gZm9ybWF0dGVkLnJlcGxhY2UoREQsIHRoaXMucHJlWmVybyhkYXRlLmRheSB8fCAxKSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgZm9ybWF0dGVkID0gZm9ybWF0dGVkLnJlcGxhY2UoRCwgU3RyaW5nKGRhdGUuZGF5IHx8IDEpKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZvcm1hdHRlZCA9IGZvcm1hdHRlZC5yZXBsYWNlKCdNTScsICdtbScpLnJlcGxhY2UoJ0hIJywgdGhpcy5wcmVaZXJvKGRhdGUuaG91ciB8fCAwKSlcclxuICAgICAgICAucmVwbGFjZSgnbW0nLCB0aGlzLnByZVplcm8oZGF0ZS5taW51dGUgfHwgMCkpXHJcbiAgICAgICAgLnJlcGxhY2UoJ3NzJywgdGhpcy5wcmVaZXJvKGRhdGUuc2Vjb25kIHx8IDApKTtcclxuXHJcbiAgICAgICAgcmV0dXJuIGZvcm1hdHRlZCAmJiBmb3JtYXR0ZWQubGVuZ3RoID4gMiA/IGZvcm1hdHRlZCA6ICcnO1xyXG4gICAgfVxyXG5cclxuICAgIGRlbGV0ZShmb3JtYXQ6IHN0cmluZywgZGVsU3RyOiBzdHJpbmcpIHtcclxuICAgICAgICBjb25zdCByZSA9IGZvcm1hdC5tYXRjaCgvW14oRGRNbVl5KV17MSx9L2cpO1xyXG4gICAgICAgIGNvbnN0IGluZGV4ID0gZm9ybWF0LmluZGV4T2YoZGVsU3RyKTtcclxuXHJcbiAgICAgICAgaWYgKGluZGV4IDwgMCkge1xyXG4gICAgICAgICAgICByZXR1cm4gZm9ybWF0O1xyXG4gICAgICAgIH0gZWxzZSBpZiAoaW5kZXggPT09IDApIHtcclxuICAgICAgICAgICAgaWYgKHJlKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZm9ybWF0LnN1YnN0cmluZygzKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmb3JtYXQuc3Vic3RyaW5nKDIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIGlmIChpbmRleCArIDIgPT09IGZvcm1hdC5sZW5ndGgpIHtcclxuICAgICAgICAgICAgaWYgKHJlKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZm9ybWF0LnN1YnN0cmluZygwLCBmb3JtYXQubGVuZ3RoIC0gMyk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZm9ybWF0LnN1YnN0cmluZygwLCBmb3JtYXQubGVuZ3RoIC0gMik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBpZiAocmUpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmb3JtYXQuc3Vic3RyaW5nKDAsIGluZGV4KSArIGZvcm1hdC5zdWJzdHJpbmcoaW5kZXggKyAzKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmb3JtYXQuc3Vic3RyaW5nKDAsIGluZGV4KSArIGZvcm1hdC5zdWJzdHJpbmcoaW5kZXggKyAyKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGdldEZvcm1hdHRlZERhdGUobW9kZWw6IElNeURhdGVNb2RlbCk6IHN0cmluZyB7XHJcbiAgICAgICAgcmV0dXJuICFtb2RlbC5pc1JhbmdlID8gbW9kZWwuc2luZ2xlRGF0ZS5mb3JtYXR0ZWQgOiBtb2RlbC5kYXRlUmFuZ2UuZm9ybWF0dGVkO1xyXG4gICAgfVxyXG5cclxuICAgIHByZVplcm8odmFsOiBudW1iZXIpOiBzdHJpbmcge1xyXG4gICAgICAgIHJldHVybiB2YWwgPCAxMCA/IFpFUk9fU1RSICsgTnVtYmVyKHZhbCkgOiBTdHJpbmcodmFsKTtcclxuICAgIH1cclxuXHJcbiAgICBpc0luaXRpYWxpemVkRGF0ZShkYXRlOiBJTXlEYXRlKTogYm9vbGVhbiB7XHJcbiAgICAgICAgcmV0dXJuIGRhdGUgJiYgZGF0ZS55ZWFyICE9PSAwICYmIGRhdGUubW9udGggIT09IDAgJiYgZGF0ZS5kYXkgIT09IDA7XHJcbiAgICB9XHJcblxyXG4gICAgaXNJbml0aWFsaXplZE1vbnRoKGRhdGU6IElNeURhdGUpOiBib29sZWFuIHtcclxuICAgICAgICByZXR1cm4gZGF0ZSAmJiBkYXRlLnllYXIgIT09IDAgJiYgZGF0ZS5tb250aCAhPT0gMDtcclxuICAgIH1cclxuXHJcbiAgICBpc0luaXRpYWxpemVkWWVhcihkYXRlOiBJTXlEYXRlKTogYm9vbGVhbiB7XHJcbiAgICAgICAgcmV0dXJuIGRhdGUgJiYgZGF0ZS55ZWFyICE9PSAwO1xyXG4gICAgfVxyXG5cclxuICAgIGlzRGF0ZUVhcmxpZXIoZmlyc3REYXRlOiBJTXlEYXRlLCBzZWNvbmREYXRlOiBJTXlEYXRlKTogYm9vbGVhbiB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0VGltZUluTWlsbGlzZWNvbmRzKGZpcnN0RGF0ZSkgPCB0aGlzLmdldFRpbWVJbk1pbGxpc2Vjb25kcyhzZWNvbmREYXRlKTtcclxuICAgIH1cclxuXHJcbiAgICBpc0RhdGVTYW1lT3JFYXJsaWVyKGZpcnN0RGF0ZTogSU15RGF0ZSwgc2Vjb25kRGF0ZTogSU15RGF0ZSk6IGJvb2xlYW4ge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmdldFRpbWVJbk1pbGxpc2Vjb25kcyhmaXJzdERhdGUpIDw9IHRoaXMuZ2V0VGltZUluTWlsbGlzZWNvbmRzKHNlY29uZERhdGUpO1xyXG4gICAgfVxyXG5cclxuICAgIGlzRGF0ZVNhbWUoZmlyc3REYXRlOiBJTXlEYXRlLCBzZWNvbmREYXRlOiBJTXlEYXRlKTogYm9vbGVhbiB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0VGltZUluTWlsbGlzZWNvbmRzKGZpcnN0RGF0ZSkgPT09IHRoaXMuZ2V0VGltZUluTWlsbGlzZWNvbmRzKHNlY29uZERhdGUpO1xyXG4gICAgfVxyXG5cclxuICAgIGlzRGF0ZVJhbmdlQmVnaW5PckVuZFNhbWUoZGF0ZVJhbmdlOiBJTXlEYXRlUmFuZ2UsIGRhdGU6IElNeURhdGUpOiBib29sZWFuIHtcclxuICAgICAgICBjb25zdCBkYXRlTXM6IG51bWJlciA9IHRoaXMuZ2V0VGltZUluTWlsbGlzZWNvbmRzKGRhdGUpO1xyXG4gICAgICAgIHJldHVybiAoXHJcbiAgICAgICAgICAgIHRoaXMuZ2V0VGltZUluTWlsbGlzZWNvbmRzKGRhdGVSYW5nZS5iZWdpbikgPT09IGRhdGVNcyB8fFxyXG4gICAgICAgICAgICB0aGlzLmdldFRpbWVJbk1pbGxpc2Vjb25kcyhkYXRlUmFuZ2UuZW5kKSA9PT0gZGF0ZU1zXHJcbiAgICAgICAgKTtcclxuICAgIH1cclxuXHJcbiAgICBpc0RhdGVJblJhbmdlKGRhdGU6IElNeURhdGUsIGRhdGVSYW5nZTogSU15RGF0ZVJhbmdlKTogYm9vbGVhbiB7XHJcbiAgICAgICAgaWYgKCF0aGlzLmlzSW5pdGlhbGl6ZWREYXRlKGRhdGVSYW5nZS5iZWdpbikgfHwgIXRoaXMuaXNJbml0aWFsaXplZERhdGUoZGF0ZVJhbmdlLmVuZCkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdGhpcy5pc0RhdGVTYW1lT3JFYXJsaWVyKGRhdGVSYW5nZS5iZWdpbiwgZGF0ZSkgJiYgdGhpcy5pc0RhdGVTYW1lT3JFYXJsaWVyKGRhdGUsIGRhdGVSYW5nZS5lbmQpO1xyXG4gICAgfVxyXG5cclxuICAgIHJlc2V0RGF0ZSgpOiBJTXlEYXRlIHtcclxuICAgICAgICByZXR1cm4geyB5ZWFyOiAwLCBtb250aDogMCwgZGF5OiAwIH07XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0VGltZUluTWlsbGlzZWNvbmRzKGRhdGU6IElNeURhdGUpOiBudW1iZXIge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmdldERhdGUoZGF0ZSkuZ2V0VGltZSgpO1xyXG4gICAgfVxyXG5cclxuICAgIGdldERhdGUyKGRhdGU6IElNeURhdGUpOiBEYXRlIHtcclxuICAgICAgICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpO1xyXG5cclxuICAgICAgICBpZiAoIWRhdGUueWVhcikge1xyXG4gICAgICAgICAgICBkYXRlLnllYXIgPSBub3cuZ2V0RnVsbFllYXIoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICghZGF0ZS5tb250aCkge1xyXG4gICAgICAgICAgICBkYXRlLm1vbnRoID0gbm93LmdldE1vbnRoKCkgKyAxO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKCFkYXRlLmRheSkge1xyXG4gICAgICAgICAgICBkYXRlLmRheSA9IDE7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gbmV3IERhdGUoXHJcbiAgICAgICAgICAgIGRhdGUueWVhcixcclxuICAgICAgICAgICAgZGF0ZS5tb250aCAtIDEsXHJcbiAgICAgICAgICAgIGRhdGUuZGF5LFxyXG4gICAgICAgICAgICBkYXRlLmhvdXIgPyBkYXRlLmhvdXIgOiAwLFxyXG4gICAgICAgICAgICBkYXRlLm1pbnV0ZSA/IGRhdGUubWludXRlIDogMCxcclxuICAgICAgICAgICAgZGF0ZS5zZWNvbmQgPyBkYXRlLnNlY29uZCA6IDAsXHJcbiAgICAgICAgICAgIDBcclxuICAgICAgICApO1xyXG4gICAgfVxyXG5cclxuICAgIGdldERhdGUoZGF0ZTogSU15RGF0ZSk6IERhdGUge1xyXG4gICAgICAgIHJldHVybiBuZXcgRGF0ZShcclxuICAgICAgICAgICAgZGF0ZS55ZWFyIHx8IDAsXHJcbiAgICAgICAgICAgIGRhdGUubW9udGggPyBkYXRlLm1vbnRoIC0gMSA6IDAsXHJcbiAgICAgICAgICAgIGRhdGUuZGF5IHx8IDAsXHJcbiAgICAgICAgICAgIGRhdGUuaG91ciA/IGRhdGUuaG91ciA6IDAsXHJcbiAgICAgICAgICAgIGRhdGUubWludXRlID8gZGF0ZS5taW51dGUgOiAwLFxyXG4gICAgICAgICAgICBkYXRlLnNlY29uZCA/IGRhdGUuc2Vjb25kIDogMCxcclxuICAgICAgICAgICAgMFxyXG4gICAgICAgICk7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0RGF5TnVtYmVyKGRhdGU6IElNeURhdGUpOiBudW1iZXIge1xyXG4gICAgICAgIHJldHVybiBuZXcgRGF0ZShcclxuICAgICAgICAgICAgZGF0ZS55ZWFyLFxyXG4gICAgICAgICAgICBkYXRlLm1vbnRoIC0gMSxcclxuICAgICAgICAgICAgZGF0ZS5kYXksXHJcbiAgICAgICAgICAgIGRhdGUuaG91ciA/IGRhdGUuaG91ciA6IDAsXHJcbiAgICAgICAgICAgIGRhdGUubWludXRlID8gZGF0ZS5taW51dGUgOiAwLFxyXG4gICAgICAgICAgICBkYXRlLnNlY29uZCA/IGRhdGUuc2Vjb25kIDogMCxcclxuICAgICAgICAgICAgMFxyXG4gICAgICAgICkuZ2V0RGF5KCk7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0V2Vla2RheUluZGV4KHdkOiBzdHJpbmcpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy53ZWVrRGF5cy5pbmRleE9mKHdkKTtcclxuICAgIH1cclxuXHJcbiAgICBnZXRFcG9jVGltZShkYXRlOiBJTXlEYXRlKTogbnVtYmVyIHtcclxuICAgICAgICByZXR1cm4gTWF0aC5yb3VuZCh0aGlzLmdldFRpbWVJbk1pbGxpc2Vjb25kcyhkYXRlKSAvIDEwMDAuMCk7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0S2V5Q29kZUZyb21FdmVudChldmVudDogYW55KTogbnVtYmVyIHtcclxuICAgICAgICBjb25zdCBrZXk6IGFueSA9IGV2ZW50LmtleSB8fCBldmVudC5rZXlDb2RlO1xyXG5cclxuICAgICAgICBpZiAoa2V5ID09PSBLZXlOYW1lLmVudGVyIHx8IGtleSA9PT0gS2V5Q29kZS5lbnRlcikge1xyXG4gICAgICAgICAgICByZXR1cm4gS2V5Q29kZS5lbnRlcjtcclxuICAgICAgICB9IGVsc2UgaWYgKGtleSA9PT0gS2V5TmFtZS5lc2MgfHwga2V5ID09PSBLZXlDb2RlLmVzYykge1xyXG4gICAgICAgICAgICByZXR1cm4gS2V5Q29kZS5lc2M7XHJcbiAgICAgICAgfSBlbHNlIGlmIChrZXkgPT09IEtleU5hbWUuc3BhY2UgfHwga2V5ID09PSBLZXlDb2RlLnNwYWNlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBLZXlDb2RlLnNwYWNlO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoa2V5ID09PSBLZXlOYW1lLmxlZnRBcnJvdyB8fCBrZXkgPT09IEtleUNvZGUubGVmdEFycm93KSB7XHJcbiAgICAgICAgICAgIHJldHVybiBLZXlDb2RlLmxlZnRBcnJvdztcclxuICAgICAgICB9IGVsc2UgaWYgKGtleSA9PT0gS2V5TmFtZS51cEFycm93IHx8IGtleSA9PT0gS2V5Q29kZS51cEFycm93KSB7XHJcbiAgICAgICAgICAgIHJldHVybiBLZXlDb2RlLnVwQXJyb3c7XHJcbiAgICAgICAgfSBlbHNlIGlmIChrZXkgPT09IEtleU5hbWUucmlnaHRBcnJvdyB8fCBrZXkgPT09IEtleUNvZGUucmlnaHRBcnJvdykge1xyXG4gICAgICAgICAgICByZXR1cm4gS2V5Q29kZS5yaWdodEFycm93O1xyXG4gICAgICAgIH0gZWxzZSBpZiAoa2V5ID09PSBLZXlOYW1lLmRvd25BcnJvdyB8fCBrZXkgPT09IEtleUNvZGUuZG93bkFycm93KSB7XHJcbiAgICAgICAgICAgIHJldHVybiBLZXlDb2RlLmRvd25BcnJvdztcclxuICAgICAgICB9IGVsc2UgaWYgKGtleSA9PT0gS2V5TmFtZS50YWIgfHwga2V5ID09PSBLZXlDb2RlLnRhYikge1xyXG4gICAgICAgICAgICByZXR1cm4gS2V5Q29kZS50YWI7XHJcbiAgICAgICAgfSBlbHNlIGlmIChrZXkgPT09IEtleU5hbWUuc2hpZnQgfHwga2V5ID09PSBLZXlDb2RlLnNoaWZ0KSB7XHJcbiAgICAgICAgICAgIHJldHVybiBLZXlDb2RlLnNoaWZ0O1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGdldE5lYXJEYXRlKG5vdzogSU15RGF0ZSwgbWluOiBJTXlEYXRlLCBtYXg6IElNeURhdGUpIHtcclxuICAgICAgICBjb25zdCBtaW5NaWxsaXNlY29uZHMgPSB0aGlzLmdldFRpbWVJbk1pbGxpc2Vjb25kcyhtaW4pXHJcbiAgICAgICAgY29uc3QgbWF4TWlsbGlzZWNvbmRzID0gdGhpcy5nZXRUaW1lSW5NaWxsaXNlY29uZHMobWF4KVxyXG4gICAgICAgIGNvbnN0IG5vd01pbGxpc2Vjb25kcyA9IHRoaXMuZ2V0VGltZUluTWlsbGlzZWNvbmRzKG5vdylcclxuICAgICAgICBpZiAobWF4TWlsbGlzZWNvbmRzIC0gbm93TWlsbGlzZWNvbmRzID4gbm93TWlsbGlzZWNvbmRzIC0gbWluTWlsbGlzZWNvbmRzKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBtaW47XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIG1heDtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICAvLyDnpoHnlKjml7bpl7Tlr7nlupTnmoTlsI/ml7ZcclxuICAgIC8vIOmAieS4reaXpeacn+etieS6juW3puWMuumXtOaXpeacn+aXtu+8jOemgeeUqOW3puerr+eCueeahOW3pumDqOWIhlsw77yMbWluSG91cu+8iVxyXG4gICAgLy8g6YCJ5Lit5pel5pyf562J5LqO5Y+z5Yy66Ze05pel5pyf5pe277yM56aB55So5Y+z56uv54K555qE5Y+z6YOo5YiGKG1heEhvdXIsMjNdXHJcbiAgICBkaXNhYmxlZEhvdXJzKG1pbjogSU15RGF0ZSwgbWF4OiBJTXlEYXRlLCBjdXJyZW50RGF0ZTogSU15RGF0ZSkge1xyXG4gICAgICAgIGxldCBtaW5Ib3VyID0gbWluLmhvdXI7XHJcbiAgICAgICAgbGV0IG1heEhvdXIgPSBtYXguaG91cjtcclxuICAgICAgICBsZXQgcmVzID0gW107XHJcbiAgICAgICAgaWYgKHRoaXMuaXNEYXRlU2FtZSh7IHllYXI6IGN1cnJlbnREYXRlLnllYXIsIG1vbnRoOiBjdXJyZW50RGF0ZS5tb250aCwgZGF5OiBjdXJyZW50RGF0ZS5kYXkgfSwgeyB5ZWFyOiBtaW4ueWVhciwgbW9udGg6IG1pbi5tb250aCwgZGF5OiBtaW4uZGF5IH0pKSB7XHJcbiAgICAgICAgICAgIHdoaWxlIChtaW5Ib3VyLS0gPj0gMCkge1xyXG4gICAgICAgICAgICAgICAgcmVzLnB1c2gobWluSG91cik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICh0aGlzLmlzRGF0ZVNhbWUoeyB5ZWFyOiBjdXJyZW50RGF0ZS55ZWFyLCBtb250aDogY3VycmVudERhdGUubW9udGgsIGRheTogY3VycmVudERhdGUuZGF5IH0sIHsgeWVhcjogbWF4LnllYXIsIG1vbnRoOiBtYXgubW9udGgsIGRheTogbWF4LmRheSB9KSkge1xyXG4gICAgICAgICAgICB3aGlsZSAobWF4SG91cisrIDwgMjQpIHtcclxuICAgICAgICAgICAgICAgIHJlcy5wdXNoKG1heEhvdXIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiByZXM7XHJcbiAgICB9XHJcbiAgICAvL+emgeeUqOaXtumXtOWvueW6lOeahOWIhumSnyBcclxuICAgIC8v6YCJ5Lit5pel5pyf562J5LqO5bem5Yy66Ze05pel5pyf5pe277yM56aB55So5bem56uv54K555qE5bem6YOo5YiGWzDvvIxtaW5NaW51dGXvvIlcclxuICAgIC8v6YCJ5Lit5pel5pyf562J5LqO5Y+z5Yy66Ze05pel5pyf5pe277yM56aB55So5Y+z56uv54K555qE5Y+z6YOo5YiG77yIbWF4TWludXRl77yMNTldXHJcbiAgICBkaXNhYmxlZE1pbnV0ZXMobWluOiBJTXlEYXRlLCBtYXg6IElNeURhdGUsIF9ob3VyOiBudW1iZXIsIGN1cnJlbnREYXRlOiBJTXlEYXRlKSB7XHJcbiAgICAgICAgbGV0IG1heEhvdXIgPSBtYXguaG91cjtcclxuICAgICAgICBsZXQgbWF4TWludXRlID0gbWF4Lm1pbnV0ZTtcclxuICAgICAgICBsZXQgbWluSG91ciA9IG1pbi5ob3VyO1xyXG4gICAgICAgIGxldCBtaW5NaW51dGUgPSBtaW4ubWludXRlO1xyXG4gICAgICAgIGxldCByZXMgPSBbXTtcclxuICAgICAgICBpZiAodGhpcy5pc0RhdGVTYW1lKHsgeWVhcjogY3VycmVudERhdGUueWVhciwgbW9udGg6IGN1cnJlbnREYXRlLm1vbnRoLCBkYXk6IGN1cnJlbnREYXRlLmRheSB9LCB7IHllYXI6IG1pbi55ZWFyLCBtb250aDogbWluLm1vbnRoLCBkYXk6IG1pbi5kYXkgfSkpIHtcclxuICAgICAgICAgICAgaWYgKF9ob3VyID09IG1pbkhvdXIpIHtcclxuICAgICAgICAgICAgICAgIHdoaWxlIChtaW5NaW51dGUtLSA+PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVzLnB1c2gobWluTWludXRlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcblxyXG4gICAgICAgIGlmICh0aGlzLmlzRGF0ZVNhbWUoeyB5ZWFyOiBjdXJyZW50RGF0ZS55ZWFyLCBtb250aDogY3VycmVudERhdGUubW9udGgsIGRheTogY3VycmVudERhdGUuZGF5IH0sIHsgeWVhcjogbWF4LnllYXIsIG1vbnRoOiBtYXgubW9udGgsIGRheTogbWF4LmRheSB9KSkge1xyXG4gICAgICAgICAgICBpZiAoX2hvdXIgPT0gbWF4SG91cikge1xyXG4gICAgICAgICAgICAgICAgd2hpbGUgKG1heE1pbnV0ZSsrIDwgNjApIHtcclxuICAgICAgICAgICAgICAgICAgICByZXMucHVzaChtYXhNaW51dGUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gcmVzO1xyXG5cclxuICAgIH1cclxuICAgIC8v56aB55So5pe26Ze05a+55bqU55qE56eSIFxyXG4gICAgLy/pgInkuK3ml6XmnJ/nrYnkuo7lt6bljLrpl7Tml6XmnJ/ml7bvvIznpoHnlKjlt6bnq6/ngrnnmoTlt6bpg6jliIZbMO+8jG1pblNlY29uZO+8iVxyXG4gICAgLy/pgInkuK3ml6XmnJ/nrYnkuo7lj7PljLrpl7Tml6XmnJ/ml7bvvIznpoHnlKjlj7Pnq6/ngrnnmoTlj7Ppg6jliIbvvIhtYXhTZWNvbmTvvIw1OV1cclxuICAgIGRpc2FibGVkU2Vjb25kcyhtaW46IElNeURhdGUsIG1heDogSU15RGF0ZSwgX2hvdXI6IG51bWJlciwgX21pbnV0ZTogbnVtYmVyLCBjdXJyZW50RGF0ZTogSU15RGF0ZSkge1xyXG4gICAgICAgIGxldCBtYXhIb3VyID0gbWF4LmhvdXI7XHJcbiAgICAgICAgbGV0IG1heE1pbnV0ZSA9IG1heC5taW51dGU7XHJcbiAgICAgICAgbGV0IG1heFNlY29uZCA9IG1heC5zZWNvbmQ7XHJcbiAgICAgICAgbGV0IG1pbkhvdXIgPSBtaW4uaG91cjtcclxuICAgICAgICBsZXQgbWluTWludXRlID0gbWluLm1pbnV0ZTtcclxuICAgICAgICBsZXQgbWluU2Vjb25kID0gbWluLnNlY29uZDtcclxuICAgICAgICBsZXQgcmVzID0gW107XHJcbiAgICAgICAgaWYgKHRoaXMuaXNEYXRlU2FtZSh7IHllYXI6IGN1cnJlbnREYXRlLnllYXIsIG1vbnRoOiBjdXJyZW50RGF0ZS5tb250aCwgZGF5OiBjdXJyZW50RGF0ZS5kYXkgfSwgeyB5ZWFyOiBtaW4ueWVhciwgbW9udGg6IG1pbi5tb250aCwgZGF5OiBtaW4uZGF5IH0pKSB7XHJcbiAgICAgICAgICAgIGlmIChfaG91ciA9PSBtaW5Ib3VyICYmIF9taW51dGUgPT0gbWluTWludXRlKSB7XHJcbiAgICAgICAgICAgICAgICB3aGlsZSAobWluU2Vjb25kLS0gPj0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJlcy5wdXNoKG1pblNlY29uZCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICh0aGlzLmlzRGF0ZVNhbWUoeyB5ZWFyOiBjdXJyZW50RGF0ZS55ZWFyLCBtb250aDogY3VycmVudERhdGUubW9udGgsIGRheTogY3VycmVudERhdGUuZGF5IH0sIHsgeWVhcjogbWF4LnllYXIsIG1vbnRoOiBtYXgubW9udGgsIGRheTogbWF4LmRheSB9KSkge1xyXG4gICAgICAgICAgICBpZiAoX2hvdXIgPT0gbWF4SG91ciAmJiBfbWludXRlID09IG1heE1pbnV0ZSkge1xyXG4gICAgICAgICAgICAgICAgd2hpbGUgKG1heFNlY29uZCsrIDwgNjApIHtcclxuICAgICAgICAgICAgICAgICAgICByZXMucHVzaChtYXhTZWNvbmQpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gcmVzO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBwcml2YXRlIGdldERhdGVUeXBlU3RyaW5nKGR0OiBEeW5hbWljRGF0ZVR5cGUsIGR5bmFtaWNMb2NhbGUpIHtcclxuICAgICAgICBzd2l0Y2goZHQpIHtcclxuICAgICAgICAgICAgY2FzZSAnd2Vlayc6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZHluYW1pY0xvY2FsZS53ZWVrIHx8ICflkagnO1xyXG4gICAgICAgICAgICBjYXNlICdkYXknOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGR5bmFtaWNMb2NhbGUuZGF5IHx8ICflpKknO1xyXG4gICAgICAgICAgICBjYXNlICdtb250aCc6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZHluYW1pY0xvY2FsZS5tb250aCB8fCAn5pyIJztcclxuICAgICAgICAgICAgY2FzZSAneWVhcic6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZHluYW1pY0xvY2FsZS55ZWFyIHx8ICflubQnO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBmb3JtYXREeW5hbWljVmFsdWUodmFsOiBEeW5hbWljRGF0YSwgZHluYW1pY0xvY2FsZSkge1xyXG4gICAgICAgIGlmICh2YWwpIHtcclxuICAgICAgICAgICAgbGV0IGZ2YWwgPSAnJztcclxuICAgICAgICAgICAgc3dpdGNoKHZhbC5uYW1lKSB7XHJcbiAgICAgICAgICAgICAgICBjYXNlICdwcmVzZW50X2RheSc6IC8vIOS7iuWkqVxyXG4gICAgICAgICAgICAgICAgZnZhbCA9IGR5bmFtaWNMb2NhbGUudG9kYXkgfHwgJ+S7iuWkqSc7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAncHJlc2VudF9tb250aCc6IC8vIOacrOaciFxyXG4gICAgICAgICAgICAgICAgZnZhbCA9IGR5bmFtaWNMb2NhbGUucHJlc2VudE1vbnRoIHx8ICfmnKzmnIgnO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgJ3ByZXNlbnRfeWVhcic6XHJcbiAgICAgICAgICAgICAgICBmdmFsID0gZHluYW1pY0xvY2FsZS5wcmVzZW50WWVhciB8fCfmnKzlubQnO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgJ3ByZXZpb3UnOlxyXG4gICAgICAgICAgICAgICAgZnZhbCA9ICAoZHluYW1pY0xvY2FsZS5wcmV2aW91c3x8ICfov4fljrsnKSArICcgJyArIHZhbC5jb3VudCArICcgJyArIHRoaXMuZ2V0RGF0ZVR5cGVTdHJpbmcodmFsLmRhdGVUeXBlLCBkeW5hbWljTG9jYWxlKTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlICdmdXR1cmUnOlxyXG4gICAgICAgICAgICAgICAgZnZhbCA9IChkeW5hbWljTG9jYWxlLmZ1dHVyZSB8fCAn5pyq5p2lJykgKyAnICcrIHZhbC5jb3VudCArICcgJyArdGhpcy5nZXREYXRlVHlwZVN0cmluZyh2YWwuZGF0ZVR5cGUsIGR5bmFtaWNMb2NhbGUpO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgJ3ByZXNlbnRfZmlyc3QnOlxyXG4gICAgICAgICAgICAgICAgZnZhbCA9IChkeW5hbWljTG9jYWxlLmN1cnJlbnR8fCfmnKwnKSArIHRoaXMuZ2V0RGF0ZVR5cGVTdHJpbmcodmFsLmRhdGVUeXBlLCBkeW5hbWljTG9jYWxlKSArIChkeW5hbWljTG9jYWxlLmZpcnN0fHwn56ysIDEg5aSpJyk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAncHJlc2VudF9sYXN0JzpcclxuICAgICAgICAgICAgICAgIGZ2YWwgPSAoZHluYW1pY0xvY2FsZS5jdXJyZW50fHwn5pysJykgKyB0aGlzLmdldERhdGVUeXBlU3RyaW5nKHZhbC5kYXRlVHlwZSwgZHluYW1pY0xvY2FsZSkgKyAoZHluYW1pY0xvY2FsZS5sYXN0fHwn5pyA5ZCOIDEg5aSpJyk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgcmV0dXJuIGZ2YWw7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuICcnO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwYWRTdGFydFplcm8oc3RyOiBhbnkpIHtcclxuICAgICAgICBpZihzdHIgIT0gbnVsbCAgJiYgc3RyICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgcmV0dXJuICAoJycgKyBzdHIpLnBhZFN0YXJ0KDIsICcwJyk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gICcwMCc7XHJcbiAgICB9XHJcblxyXG4gICAgb3JkZXJTZWxlY3RlZERhdGVzKGl0ZW1zLCBvcmRlcjogTXVsdGlTZWxlY3RlZE9yZGVyQnkgPSAnbm9uZScpIHtcclxuICAgICAgICBpZiAob3JkZXIgIT09ICdhc2MnICYmIG9yZGVyICE9PSAnZGVzYycpIHtcclxuICAgICAgICAgICAgb3JkZXIgPSAnbm9uZSc7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAob3JkZXIgPT09ICdub25lJykge1xyXG4gICAgICAgICAgICByZXR1cm4gaXRlbXM7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gb3JkZXJCeShpdGVtcywgWyd5ZWFyJywgJ21vbnRoJywgJ2RheSddLCBbb3JkZXIsIG9yZGVyLCBvcmRlcl0pO1xyXG4gICAgfVxyXG59XHJcbiJdfQ==