/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Directive, Input, ElementRef, ViewContainerRef, Renderer2, ChangeDetectorRef, ComponentFactoryResolver, forwardRef, EventEmitter, Output, HostListener, NgZone } from '@angular/core';
import { NG_VALIDATORS, NG_VALUE_ACCESSOR } from '@angular/forms';
import { CalendarComponent } from './components/calendar/calendar.component';
import { UtilService, DatepickerLocaleService, DefaultConfigService } from './services/public-api';
import { KeyCode, CalToggle, Year, ResetDateType } from './enums/public-api';
import { KEYUP, BLUR, EMPTY_STR, DISABLED, CLICK, VALUE, OPTIONS, DEFAULT_MONTH, LOCALE, OBJECT, PX } from './constants/constants';
/** @type {?} */
var NGX_DP_VALUE_ACCESSOR = {
    provide: NG_VALUE_ACCESSOR,
    useExisting: forwardRef((/**
     * @return {?}
     */
    function () { return FarrisDatePickerDirective; })),
    multi: true
};
/** @type {?} */
var NGX_DP_VALIDATORS = {
    provide: NG_VALIDATORS,
    useExisting: forwardRef((/**
     * @return {?}
     */
    function () { return FarrisDatePickerDirective; })),
    multi: true
};
var FarrisDatePickerDirective = /** @class */ (function () {
    function FarrisDatePickerDirective(localeService, utilService, vcRef, cfr, renderer, cdr, elem, config, zone) {
        var _this = this;
        this.localeService = localeService;
        this.utilService = utilService;
        this.vcRef = vcRef;
        this.cfr = cfr;
        this.renderer = renderer;
        this.cdr = cdr;
        this.elem = elem;
        this.config = config;
        this.zone = zone;
        this.dateChanged = new EventEmitter();
        this.inputFieldChanged = new EventEmitter();
        this.calendarViewChanged = new EventEmitter();
        this.calendarToggle = new EventEmitter();
        this.rangeDateSelection = new EventEmitter();
        this.cRef = null;
        this.inputText = '';
        this.preventClose = false;
        this.disabled = false;
        // scrollFn: any = (e) => {
        //     console.log((e.target as any).scrollTop);
        // };
        this.onChangeCb = (/**
         * @return {?}
         */
        function () { });
        this.onTouchedCb = (/**
         * @return {?}
         */
        function () { });
        // wrapper with arrow function to preserve the use of 'this' word
        this.onClickWrapper = (/**
         * @param {?} ev
         * @return {?}
         */
        function (ev) {
            _this.onClick(ev);
        });
        this.opts = this.config.getDefaultConfig();
        this.parseOptions(this.opts);
    }
    /**
     * @param {?} event
     * @return {?}
     */
    FarrisDatePickerDirective.prototype.onKeyUp = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        /** @type {?} */
        var keyCode = this.utilService.getKeyCodeFromEvent(event);
        if (this.ignoreKeyPress(keyCode)) {
            return;
        }
        else if (keyCode === KeyCode.esc) {
            this.closeSelector(CalToggle.CloseByEsc);
        }
        else {
            var value = this.elem.nativeElement.value;
            /** @type {?} */
            var valid = false;
            if (!this.opts.dateRange) {
                /** @type {?} */
                var date = this.utilService.isDateValid(value, this.opts);
                valid = this.utilService.isInitializedDate(date);
            }
            else {
                var _a = this.utilService.isDateValidDateRange(value, this.opts), begin = _a.begin, end = _a.end;
                valid =
                    this.utilService.isInitializedDate(begin) &&
                        this.utilService.isInitializedDate(end);
            }
            this.emitInputFieldChanged(value, valid);
        }
    };
    /**
     * @return {?}
     */
    FarrisDatePickerDirective.prototype.onBlur = /**
     * @return {?}
     */
    function () {
        var _a = this.opts, inputFieldValidation = _a.inputFieldValidation, dateRange = _a.dateRange;
        if (inputFieldValidation) {
            var value = this.elem.nativeElement.value;
            /** @type {?} */
            var valid = false;
            if (!dateRange) {
                /** @type {?} */
                var date = this.utilService.isDateValid(value, this.opts);
                valid = this.utilService.isInitializedDate(date);
            }
            else {
                /** @type {?} */
                var _dateRange = this.utilService.isDateValidDateRange(value, this.opts);
                var begin = _dateRange.begin, end = _dateRange.end;
                valid =
                    this.utilService.isInitializedDate(begin) &&
                        this.utilService.isInitializedDate(end);
            }
            if (!valid && this.inputText !== value) {
                this.clearDate();
            }
            this.onChangeCb(value);
        }
        this.onTouchedCb();
    };
    /**
     * @param {?} evt
     * @return {?}
     */
    FarrisDatePickerDirective.prototype.onClick = /**
     * @param {?} evt
     * @return {?}
     */
    function (evt) {
        if (this.opts.closeSelectorOnDocumentClick &&
            !this.preventClose &&
            evt.target &&
            this.cRef !== null &&
            this.elem.nativeElement !== evt.target &&
            !this.cRef.location.nativeElement.contains(evt.target) &&
            !this.disabled) {
            this.closeSelector(CalToggle.CloseByOutClick);
        }
    };
    /**
     * @param {?} changes
     * @return {?}
     */
    FarrisDatePickerDirective.prototype.ngOnChanges = /**
     * @param {?} changes
     * @return {?}
     */
    function (changes) {
        if (changes.hasOwnProperty(LOCALE)) {
            this.setLocaleOptions();
        }
        if (changes.hasOwnProperty(DEFAULT_MONTH)) {
            /** @type {?} */
            var dm = changes[DEFAULT_MONTH].currentValue;
            if (typeof dm === OBJECT) {
                dm = dm.defMonth;
            }
            this.defaultMonth = dm;
        }
        if (changes.hasOwnProperty(OPTIONS)) {
            this.parseOptions(changes[OPTIONS].currentValue);
        }
    };
    /**
     * @return {?}
     */
    FarrisDatePickerDirective.prototype.ngOnDestroy = /**
     * @return {?}
     */
    function () {
        this.closeCalendar();
    };
    /**
     * @return {?}
     */
    FarrisDatePickerDirective.prototype.setLocaleOptions = /**
     * @return {?}
     */
    function () {
        var _this = this;
        /** @type {?} */
        var opts = this.localeService.getLocaleOptions(this.locale);
        Object.keys(opts).forEach((/**
         * @param {?} k
         * @return {?}
         */
        function (k) {
            ((/** @type {?} */ (_this.opts)))[k] = opts[k];
        }));
    };
    /**
     * @param {?} opts
     * @return {?}
     */
    FarrisDatePickerDirective.prototype.parseOptions = /**
     * @param {?} opts
     * @return {?}
     */
    function (opts) {
        var _this = this;
        if (opts !== undefined) {
            Object.keys(opts).forEach((/**
             * @param {?} k
             * @return {?}
             */
            function (k) {
                if (opts[k] !== undefined && opts[k] !== '') {
                    ((/** @type {?} */ (_this.opts)))[k] = opts[k];
                }
            }));
        }
        if (this.opts.minYear < Year.min) {
            this.opts.minYear = Year.min;
        }
        if (this.opts.maxYear > Year.max) {
            this.opts.maxYear = Year.max;
        }
    };
    /**
     * @param {?} value
     * @return {?}
     */
    FarrisDatePickerDirective.prototype.formatDate = /**
     * @param {?} value
     * @return {?}
     */
    function (value) {
        var _a = this.opts, dateRange = _a.dateRange, dateFormat = _a.dateFormat, monthLabels = _a.monthLabels, dateRangeDatesDelimiter = _a.dateRangeDatesDelimiter, returnFormat = _a.returnFormat;
        if (!dateRange) {
            // Single date mode
            /** @type {?} */
            var date = this.utilService.isDateValid(value, this.opts);
            return this.utilService.getDateModel(date, null, dateFormat, monthLabels, dateRangeDatesDelimiter, returnFormat);
        }
        else {
            // Date range mode
            /** @type {?} */
            var _dateRange = this.utilService.isDateValidDateRange(value, this.opts);
            return this.utilService.getDateModel(null, _dateRange, dateFormat, monthLabels, dateRangeDatesDelimiter, returnFormat);
        }
    };
    /**
     * @param {?} value
     * @return {?}
     */
    FarrisDatePickerDirective.prototype.writeValue = /**
     * @param {?} value
     * @return {?}
     */
    function (value) {
        if (this.disabled) {
            return;
        }
        if (value) {
            value = this.formatDate(value);
        }
        if (!value) {
            this.setInputValue(EMPTY_STR);
            this.emitInputFieldChanged(EMPTY_STR, false);
            if (this.cRef !== null) {
                this.cRef.instance.resetDateValue(ResetDateType.both);
            }
        }
        else if (value.isRange === false && value.singleDate) {
            // single date
            var _a = value.singleDate, date = _a.date, formatted = _a.formatted;
            /** @type {?} */
            var valid = this.utilService.isInitializedDate(date);
            if (valid) {
                this.setInputValue(formatted);
                this.emitInputFieldChanged(formatted, valid);
                if (this.cRef !== null) {
                    this.cRef.instance.resetDateValue(ResetDateType.dateRange);
                }
            }
        }
        else if (value.isRange === true && value.dateRange) {
            // date range
            var _b = value.dateRange, beginDate = _b.beginDate, endDate = _b.endDate, formatted = _b.formatted;
            if (beginDate && endDate) {
                /** @type {?} */
                var valid = this.utilService.isInitializedDate(beginDate) &&
                    this.utilService.isInitializedDate(endDate);
                if (valid) {
                    this.setInputValue(formatted);
                    this.emitInputFieldChanged(formatted, valid);
                    if (this.cRef !== null) {
                        this.cRef.instance.resetDateValue(ResetDateType.singleDate);
                    }
                }
            }
        }
    };
    /**
     * @param {?} fn
     * @return {?}
     */
    FarrisDatePickerDirective.prototype.registerOnChange = /**
     * @param {?} fn
     * @return {?}
     */
    function (fn) {
        this.onChangeCb = fn;
    };
    /**
     * @param {?} fn
     * @return {?}
     */
    FarrisDatePickerDirective.prototype.registerOnTouched = /**
     * @param {?} fn
     * @return {?}
     */
    function (fn) {
        this.onTouchedCb = fn;
    };
    /**
     * @param {?} isDisabled
     * @return {?}
     */
    FarrisDatePickerDirective.prototype.setDisabledState = /**
     * @param {?} isDisabled
     * @return {?}
     */
    function (isDisabled) {
        this.disabled = isDisabled;
        this.renderer.setProperty(this.elem.nativeElement, DISABLED, isDisabled);
        if (isDisabled) {
            this.closeCalendar();
        }
    };
    /**
     * @param {?} c
     * @return {?}
     */
    FarrisDatePickerDirective.prototype.validate = /**
     * @param {?} c
     * @return {?}
     */
    function (c) {
        return null;
    };
    /**
     * @return {?}
     */
    FarrisDatePickerDirective.prototype.openCalendar = /**
     * @return {?}
     */
    function () {
        var _this = this;
        if (this.disabled) {
            return;
        }
        this.preventClose = true;
        this.cdr.detectChanges();
        if (this.cRef === null) {
            this.cRef = this.vcRef.createComponent(this.cfr.resolveComponentFactory(CalendarComponent));
            this.appendSelector(this.cRef.location.nativeElement);
            this.cRef.instance.initialize(this.opts, this.defaultMonth, this.getSelectorPosition(this.elem.nativeElement), this.elem.nativeElement.value, (/**
             * @param {?} dm
             * @param {?} close
             * @return {?}
             */
            function (dm, close) {
                _this.focusToInput();
                _this.updateModel(dm);
                if (close) {
                    _this.closeSelector(CalToggle.CloseByDateSel);
                }
                _this.emitDateChanged(dm);
                _this.emitInputFieldChanged(_this.utilService.getFormattedDate(dm), true);
            }), (/**
             * @param {?} cvc
             * @return {?}
             */
            function (cvc) {
                _this.emitCalendarChanged(cvc);
            }), (/**
             * @param {?} rds
             * @return {?}
             */
            function (rds) {
                _this.emitRangeDateSelection(rds);
            }), (/**
             * @return {?}
             */
            function () {
                _this.closeSelector(CalToggle.CloseByEsc);
            }));
            this.emitCalendarToggle(CalToggle.Open);
            this.cdr.detectChanges();
        }
        else {
            this.appendSelector(this.cRef.location.nativeElement);
        }
        this.preventClose = false;
    };
    /**
     * @return {?}
     */
    FarrisDatePickerDirective.prototype.closeCalendar = /**
     * @return {?}
     */
    function () {
        this.closeSelector(CalToggle.CloseByCalBtn);
    };
    /**
     * @param {?} event
     * @return {?}
     */
    FarrisDatePickerDirective.prototype.toggleCalendar = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        var _this = this;
        event.stopPropagation();
        if (this.disabled) {
            return;
        }
        if (this.cRef === null) {
            document.addEventListener(CLICK, this.onClickWrapper, true);
            this.openCalendar();
            /** @type {?} */
            var container = document.querySelector('.date-overlay-container');
            this.renderer.setStyle(container, 'pointer-events', 'auto');
        }
        else {
            /** @type {?} */
            var flag_1 = true;
            /** @type {?} */
            var container = document.querySelector('.date-overlay-container');
            if (container && this.cRef.location) {
                if (container.hasChildNodes()) {
                    container.childNodes.forEach((/**
                     * @param {?} el
                     * @return {?}
                     */
                    function (el) {
                        if (el === _this.cRef.location.nativeElement) {
                            flag_1 = false;
                        }
                    }));
                }
            }
            if (flag_1) {
                this.renderer.setStyle(container, 'pointer-events', 'auto');
                this.openCalendar();
            }
            else {
                document.removeEventListener(CLICK, this.onClickWrapper);
                this.closeSelector(CalToggle.CloseByCalBtn);
                this.renderer.setStyle(container, 'pointer-events', '');
            }
        }
    };
    /**
     * @return {?}
     */
    FarrisDatePickerDirective.prototype.clearDate = /**
     * @return {?}
     */
    function () {
        if (this.disabled) {
            return;
        }
        this.setInputValue(EMPTY_STR);
        this.emitDateChanged({
            isRange: this.opts.dateRange,
            singleDate: {
                date: this.utilService.resetDate(),
                jsDate: null,
                formatted: EMPTY_STR,
                epoc: 0
            },
            dateRange: {
                beginDate: this.utilService.resetDate(),
                beginJsDate: null,
                beginEpoc: 0,
                endDate: this.utilService.resetDate(),
                endJsDate: null,
                endEpoc: 0,
                formatted: EMPTY_STR
            }
        });
        this.onChangeCb(null);
        this.onTouchedCb();
        this.closeSelector(CalToggle.CloseByCalBtn);
    };
    /**
     * @return {?}
     */
    FarrisDatePickerDirective.prototype.isDateValid = /**
     * @return {?}
     */
    function () {
        var value = this.elem.nativeElement.value;
        if (value !== EMPTY_STR) {
            /** @type {?} */
            var date = this.utilService.isDateValid(value, this.opts);
            if (this.utilService.isInitializedDate(date)) {
                this.emitInputFieldChanged(value, true);
                return true;
            }
        }
        this.emitInputFieldChanged(value, false);
        return false;
    };
    /**
     * @private
     * @param {?} keyCode
     * @return {?}
     */
    FarrisDatePickerDirective.prototype.ignoreKeyPress = /**
     * @private
     * @param {?} keyCode
     * @return {?}
     */
    function (keyCode) {
        // keyCode === KeyCode.tab ||
        return (keyCode === KeyCode.leftArrow ||
            keyCode === KeyCode.rightArrow ||
            keyCode === KeyCode.upArrow ||
            keyCode === KeyCode.downArrow ||
            keyCode === KeyCode.shift);
    };
    /**
     * @private
     * @param {?} reason
     * @return {?}
     */
    FarrisDatePickerDirective.prototype.closeSelector = /**
     * @private
     * @param {?} reason
     * @return {?}
     */
    function (reason) {
        if (this.cRef !== null) {
            this.vcRef.remove(this.vcRef.indexOf(this.cRef.hostView));
            this.cRef = null;
            this.cdr.detectChanges();
            this.emitCalendarToggle(reason);
            /** @type {?} */
            var container = document.querySelector('.date-overlay-container');
            this.renderer.setStyle(container, 'pointer-events', '');
        }
    };
    /**
     * @private
     * @param {?} model
     * @return {?}
     */
    FarrisDatePickerDirective.prototype.updateModel = /**
     * @private
     * @param {?} model
     * @return {?}
     */
    function (model) {
        this.setInputValue(this.utilService.getFormattedDate(model));
        this.onChangeCb(this.utilService.getFormattedDate(model));
        this.onTouchedCb();
    };
    /**
     * @private
     * @param {?} value
     * @return {?}
     */
    FarrisDatePickerDirective.prototype.setInputValue = /**
     * @private
     * @param {?} value
     * @return {?}
     */
    function (value) {
        this.inputText = value;
        this.renderer.setProperty(this.elem.nativeElement, VALUE, value);
    };
    /**
     * @private
     * @return {?}
     */
    FarrisDatePickerDirective.prototype.focusToInput = /**
     * @private
     * @return {?}
     */
    function () {
        if (this.opts.focusInputOnDateSelect) {
            this.elem.nativeElement.focus();
        }
    };
    /**
     * @private
     * @param {?} dateModel
     * @return {?}
     */
    FarrisDatePickerDirective.prototype.emitDateChanged = /**
     * @private
     * @param {?} dateModel
     * @return {?}
     */
    function (dateModel) {
        this.dateChanged.emit(dateModel);
    };
    /**
     * @private
     * @param {?} value
     * @param {?} valid
     * @return {?}
     */
    FarrisDatePickerDirective.prototype.emitInputFieldChanged = /**
     * @private
     * @param {?} value
     * @param {?} valid
     * @return {?}
     */
    function (value, valid) {
        this.inputFieldChanged.emit({
            value: value,
            dateFormat: this.opts.dateFormat,
            valid: valid
        });
    };
    /**
     * @private
     * @param {?} cvc
     * @return {?}
     */
    FarrisDatePickerDirective.prototype.emitCalendarChanged = /**
     * @private
     * @param {?} cvc
     * @return {?}
     */
    function (cvc) {
        this.calendarViewChanged.emit(cvc);
    };
    /**
     * @private
     * @param {?} rds
     * @return {?}
     */
    FarrisDatePickerDirective.prototype.emitRangeDateSelection = /**
     * @private
     * @param {?} rds
     * @return {?}
     */
    function (rds) {
        this.rangeDateSelection.emit(rds);
    };
    /**
     * @private
     * @param {?} reason
     * @return {?}
     */
    FarrisDatePickerDirective.prototype.emitCalendarToggle = /**
     * @private
     * @param {?} reason
     * @return {?}
     */
    function (reason) {
        this.calendarToggle.emit(reason);
    };
    /**
     * @private
     * @param {?} date
     * @return {?}
     */
    FarrisDatePickerDirective.prototype.jsDateToMyDate = /**
     * @private
     * @param {?} date
     * @return {?}
     */
    function (date) {
        return {
            year: date.getFullYear(),
            month: date.getMonth() + 1,
            day: date.getDate()
        };
    };
    /**
     * @private
     * @param {?} elem
     * @return {?}
     */
    FarrisDatePickerDirective.prototype.appendSelector = /**
     * @private
     * @param {?} elem
     * @return {?}
     */
    function (elem) {
        /** @type {?} */
        var container = document.querySelector('.date-overlay-container');
        if (container) {
            if (container.hasChildNodes()) {
                container.childNodes.forEach((/**
                 * @param {?} el
                 * @return {?}
                 */
                function (el) {
                    if (el !== elem) {
                        container.removeChild(el);
                    }
                }));
            }
        }
        else {
            container = document.createElement('div');
            container.classList.add('date-overlay-container');
            container.classList.add('overlay-container');
            document.body.appendChild(container);
        }
        container.appendChild(elem);
    };
    /**
     * @private
     * @param {?} elem
     * @return {?}
     */
    FarrisDatePickerDirective.prototype.getSelectorPosition = /**
     * @private
     * @param {?} elem
     * @return {?}
     */
    function (elem) {
        /** @type {?} */
        var top = 0;
        /** @type {?} */
        var left = 0;
        /** @type {?} */
        var _selectorHeight = 0;
        /** @type {?} */
        var _selectorWidth = 0;
        var _a = this.opts, selectorHeight = _a.selectorHeight, selectorWidth = _a.selectorWidth, showTime = _a.showTime, dateRange = _a.dateRange;
        /** @type {?} */
        var b = document.body.getBoundingClientRect();
        /** @type {?} */
        var e = elem.getBoundingClientRect();
        top = e.top - b.top;
        left = e.left - b.left;
        /** @type {?} */
        var position = 'bottom';
        if (dateRange) {
            _selectorWidth = this.getSelectorDimension(selectorWidth) * 2;
        }
        else {
            _selectorWidth = this.getSelectorDimension(selectorWidth);
        }
        if (showTime) {
            _selectorHeight = this.getSelectorDimension(selectorHeight) + 36;
        }
        else {
            _selectorHeight = this.getSelectorDimension(selectorHeight);
        }
        if (top + elem.offsetHeight + _selectorHeight > window.innerHeight && top - _selectorHeight - 2 > 0) {
            top = top - _selectorHeight - 2;
            position = 'top';
        }
        else {
            top = top + elem.offsetHeight + 2;
        }
        if (left + _selectorWidth > b.width) {
            left = b.width - _selectorWidth - 15;
        }
        left = left > 0 ? left : 0;
        return { top: top, left: left, position: position };
    };
    /**
     * @private
     * @param {?} value
     * @return {?}
     */
    FarrisDatePickerDirective.prototype.getSelectorDimension = /**
     * @private
     * @param {?} value
     * @return {?}
     */
    function (value) {
        return Number(value.replace(PX, EMPTY_STR));
    };
    FarrisDatePickerDirective.decorators = [
        { type: Directive, args: [{
                    selector: '[farris-datepicker]',
                    exportAs: 'farris-datepicker',
                    providers: [
                        UtilService,
                        DatepickerLocaleService,
                        DefaultConfigService,
                        NGX_DP_VALUE_ACCESSOR,
                        NGX_DP_VALIDATORS
                    ]
                },] }
    ];
    /** @nocollapse */
    FarrisDatePickerDirective.ctorParameters = function () { return [
        { type: DatepickerLocaleService },
        { type: UtilService },
        { type: ViewContainerRef },
        { type: ComponentFactoryResolver },
        { type: Renderer2 },
        { type: ChangeDetectorRef },
        { type: ElementRef },
        { type: DefaultConfigService },
        { type: NgZone }
    ]; };
    FarrisDatePickerDirective.propDecorators = {
        options: [{ type: Input }],
        locale: [{ type: Input }],
        defaultMonth: [{ type: Input }],
        dateChanged: [{ type: Output }],
        inputFieldChanged: [{ type: Output }],
        calendarViewChanged: [{ type: Output }],
        calendarToggle: [{ type: Output }],
        rangeDateSelection: [{ type: Output }],
        onKeyUp: [{ type: HostListener, args: [KEYUP, ['$event'],] }],
        onBlur: [{ type: HostListener, args: [BLUR,] }]
    };
    return FarrisDatePickerDirective;
}());
export { FarrisDatePickerDirective };
if (false) {
    /** @type {?} */
    FarrisDatePickerDirective.prototype.options;
    /** @type {?} */
    FarrisDatePickerDirective.prototype.locale;
    /** @type {?} */
    FarrisDatePickerDirective.prototype.defaultMonth;
    /** @type {?} */
    FarrisDatePickerDirective.prototype.dateChanged;
    /** @type {?} */
    FarrisDatePickerDirective.prototype.inputFieldChanged;
    /** @type {?} */
    FarrisDatePickerDirective.prototype.calendarViewChanged;
    /** @type {?} */
    FarrisDatePickerDirective.prototype.calendarToggle;
    /** @type {?} */
    FarrisDatePickerDirective.prototype.rangeDateSelection;
    /**
     * @type {?}
     * @private
     */
    FarrisDatePickerDirective.prototype.cRef;
    /**
     * @type {?}
     * @private
     */
    FarrisDatePickerDirective.prototype.inputText;
    /**
     * @type {?}
     * @private
     */
    FarrisDatePickerDirective.prototype.preventClose;
    /**
     * @type {?}
     * @private
     */
    FarrisDatePickerDirective.prototype.disabled;
    /**
     * @type {?}
     * @private
     */
    FarrisDatePickerDirective.prototype.opts;
    /** @type {?} */
    FarrisDatePickerDirective.prototype.onChangeCb;
    /** @type {?} */
    FarrisDatePickerDirective.prototype.onTouchedCb;
    /**
     * @type {?}
     * @private
     */
    FarrisDatePickerDirective.prototype.onClickWrapper;
    /** @type {?} */
    FarrisDatePickerDirective.prototype.localeService;
    /**
     * @type {?}
     * @private
     */
    FarrisDatePickerDirective.prototype.utilService;
    /**
     * @type {?}
     * @private
     */
    FarrisDatePickerDirective.prototype.vcRef;
    /**
     * @type {?}
     * @private
     */
    FarrisDatePickerDirective.prototype.cfr;
    /**
     * @type {?}
     * @private
     */
    FarrisDatePickerDirective.prototype.renderer;
    /**
     * @type {?}
     * @private
     */
    FarrisDatePickerDirective.prototype.cdr;
    /**
     * @type {?}
     * @private
     */
    FarrisDatePickerDirective.prototype.elem;
    /**
     * @type {?}
     * @private
     */
    FarrisDatePickerDirective.prototype.config;
    /**
     * @type {?}
     * @private
     */
    FarrisDatePickerDirective.prototype.zone;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZmFycmlzLWRhdGVwaWNrZXIuaW5wdXQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZmFycmlzL3VpLWRhdGVwaWNrZXIvIiwic291cmNlcyI6WyJsaWIvZmFycmlzLWRhdGVwaWNrZXIuaW5wdXQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUFBLE9BQU8sRUFDSCxTQUFTLEVBQ1QsS0FBSyxFQUVMLFVBQVUsRUFDVixnQkFBZ0IsRUFDaEIsU0FBUyxFQUNULGlCQUFpQixFQUNqQix3QkFBd0IsRUFDeEIsVUFBVSxFQUNWLFlBQVksRUFDWixNQUFNLEVBR04sWUFBWSxFQUVaLE1BQU0sRUFDVCxNQUFNLGVBQWUsQ0FBQztBQUN2QixPQUFPLEVBR0gsYUFBYSxFQUNiLGlCQUFpQixFQUVwQixNQUFNLGdCQUFnQixDQUFDO0FBQ3hCLE9BQU8sRUFBRSxpQkFBaUIsRUFBRSxNQUFNLDBDQUEwQyxDQUFDO0FBYTdFLE9BQU8sRUFDSCxXQUFXLEVBQ1gsdUJBQXVCLEVBQ3ZCLG9CQUFvQixFQUN2QixNQUFNLHVCQUF1QixDQUFDO0FBRS9CLE9BQU8sRUFBRSxPQUFPLEVBQUUsU0FBUyxFQUFFLElBQUksRUFBRSxhQUFhLEVBQUUsTUFBTSxvQkFBb0IsQ0FBQztBQUU3RSxPQUFPLEVBQ0gsS0FBSyxFQUNMLElBQUksRUFDSixTQUFTLEVBQ1QsUUFBUSxFQUNSLEtBQUssRUFFTCxLQUFLLEVBQ0wsT0FBTyxFQUNQLGFBQWEsRUFDYixNQUFNLEVBQ04sTUFBTSxFQUNOLEVBQUUsRUFDTCxNQUFNLHVCQUF1QixDQUFDOztJQUV6QixxQkFBcUIsR0FBRztJQUMxQixPQUFPLEVBQUUsaUJBQWlCO0lBQzFCLFdBQVcsRUFBRSxVQUFVOzs7SUFBQyxjQUFNLE9BQUEseUJBQXlCLEVBQXpCLENBQXlCLEVBQUM7SUFDeEQsS0FBSyxFQUFFLElBQUk7Q0FDZDs7SUFFSyxpQkFBaUIsR0FBRztJQUN0QixPQUFPLEVBQUUsYUFBYTtJQUN0QixXQUFXLEVBQUUsVUFBVTs7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TixNQUFNO3FDQUNOLE1BQU07MEJBaUNOLFlBQVksU0FBQyxLQUFLLEVBQUUsQ0FBQyxRQUFRLENBQUM7eUJBNkI5QixZQUFZLFNBQUMsSUFBSTs7SUEyZHRCLGdDQUFDO0NBQUEsQUFwakJELElBb2pCQztTQXppQlkseUJBQXlCOzs7SUFFbEMsNENBQTZCOztJQUM3QiwyQ0FBd0I7O0lBQ3hCLGlEQUE4Qjs7SUFFOUIsZ0RBRUk7O0lBQ0osc0RBRTZDOztJQUM3Qyx3REFFK0M7O0lBQy9DLG1EQUE0RTs7SUFDNUUsdURBRThDOzs7OztJQUU5Qyx5Q0FBcUQ7Ozs7O0lBQ3JELDhDQUF1Qjs7Ozs7SUFDdkIsaURBQTZCOzs7OztJQUM3Qiw2Q0FBeUI7Ozs7O0lBRXpCLHlDQUF5Qjs7SUFNekIsK0NBQXdDOztJQUN4QyxnREFBbUM7Ozs7O0lBa0ZuQyxtREFFQzs7SUFqRkcsa0RBQTZDOzs7OztJQUM3QyxnREFBZ0M7Ozs7O0lBQ2hDLDBDQUErQjs7Ozs7SUFDL0Isd0NBQXFDOzs7OztJQUNyQyw2Q0FBMkI7Ozs7O0lBQzNCLHdDQUE4Qjs7Ozs7SUFDOUIseUNBQXdCOzs7OztJQUN4QiwyQ0FBb0M7Ozs7O0lBQ3BDLHlDQUFvQiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XHJcbiAgICBEaXJlY3RpdmUsXHJcbiAgICBJbnB1dCxcclxuICAgIENvbXBvbmVudFJlZixcclxuICAgIEVsZW1lbnRSZWYsXHJcbiAgICBWaWV3Q29udGFpbmVyUmVmLFxyXG4gICAgUmVuZGVyZXIyLFxyXG4gICAgQ2hhbmdlRGV0ZWN0b3JSZWYsXHJcbiAgICBDb21wb25lbnRGYWN0b3J5UmVzb2x2ZXIsXHJcbiAgICBmb3J3YXJkUmVmLFxyXG4gICAgRXZlbnRFbWl0dGVyLFxyXG4gICAgT3V0cHV0LFxyXG4gICAgU2ltcGxlQ2hhbmdlcyxcclxuICAgIE9uQ2hhbmdlcyxcclxuICAgIEhvc3RMaXN0ZW5lcixcclxuICAgIE9uRGVzdHJveSxcclxuICAgIE5nWm9uZVxyXG59IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQge1xyXG4gICAgQWJzdHJhY3RDb250cm9sLFxyXG4gICAgQ29udHJvbFZhbHVlQWNjZXNzb3IsXHJcbiAgICBOR19WQUxJREFUT1JTLFxyXG4gICAgTkdfVkFMVUVfQUNDRVNTT1IsXHJcbiAgICBWYWxpZGF0b3JcclxufSBmcm9tICdAYW5ndWxhci9mb3Jtcyc7XHJcbmltcG9ydCB7IENhbGVuZGFyQ29tcG9uZW50IH0gZnJvbSAnLi9jb21wb25lbnRzL2NhbGVuZGFyL2NhbGVuZGFyLmNvbXBvbmVudCc7XHJcblxyXG5pbXBvcnQge1xyXG4gICAgSU15T3B0aW9ucyxcclxuICAgIElNeURhdGUsXHJcbiAgICBJTXlEYXRlTW9kZWwsXHJcbiAgICBJTXlEYXRlUmFuZ2UsXHJcbiAgICBJTXlSYW5nZURhdGVTZWxlY3Rpb24sXHJcbiAgICBJTXlDYWxlbmRhclZpZXdDaGFuZ2VkLFxyXG4gICAgSU15SW5wdXRGaWVsZENoYW5nZWQsXHJcbiAgICBJTXlTZWxlY3RvclBvc2l0aW9uXHJcbn0gZnJvbSAnLi9pbnRlcmZhY2VzL3B1YmxpYy1hcGknO1xyXG5cclxuaW1wb3J0IHtcclxuICAgIFV0aWxTZXJ2aWNlLFxyXG4gICAgRGF0ZXBpY2tlckxvY2FsZVNlcnZpY2UsXHJcbiAgICBEZWZhdWx0Q29uZmlnU2VydmljZVxyXG59IGZyb20gJy4vc2VydmljZXMvcHVibGljLWFwaSc7XHJcblxyXG5pbXBvcnQgeyBLZXlDb2RlLCBDYWxUb2dnbGUsIFllYXIsIFJlc2V0RGF0ZVR5cGUgfSBmcm9tICcuL2VudW1zL3B1YmxpYy1hcGknO1xyXG5cclxuaW1wb3J0IHtcclxuICAgIEtFWVVQLFxyXG4gICAgQkxVUixcclxuICAgIEVNUFRZX1NUUixcclxuICAgIERJU0FCTEVELFxyXG4gICAgQ0xJQ0ssXHJcbiAgICBCT0RZLFxyXG4gICAgVkFMVUUsXHJcbiAgICBPUFRJT05TLFxyXG4gICAgREVGQVVMVF9NT05USCxcclxuICAgIExPQ0FMRSxcclxuICAgIE9CSkVDVCxcclxuICAgIFBYXHJcbn0gZnJvbSAnLi9jb25zdGFudHMvY29uc3RhbnRzJztcclxuXHJcbmNvbnN0IE5HWF9EUF9WQUxVRV9BQ0NFU1NPUiA9IHtcclxuICAgIHByb3ZpZGU6IE5HX1ZBTFVFX0FDQ0VTU09SLFxyXG4gICAgdXNlRXhpc3Rpbmc6IGZvcndhcmRSZWYoKCkgPT4gRmFycmlzRGF0ZVBpY2tlckRpcmVjdGl2ZSksXHJcbiAgICBtdWx0aTogdHJ1ZVxyXG59O1xyXG5cclxuY29uc3QgTkdYX0RQX1ZBTElEQVRPUlMgPSB7XHJcbiAgICBwcm92aWRlOiBOR19WQUxJREFUT1JTLFxyXG4gICAgdXNlRXhpc3Rpbmc6IGZvcndhcmRSZWYoKCkgPT4gRmFycmlzRGF0ZVBpY2tlckRpcmVjdGl2ZSksXHJcbiAgICBtdWx0aTogdHJ1ZVxyXG59O1xyXG5cclxuQERpcmVjdGl2ZSh7XHJcbiAgICBzZWxlY3RvcjogJ1tmYXJyaXMtZGF0ZXBpY2tlcl0nLFxyXG4gICAgZXhwb3J0QXM6ICdmYXJyaXMtZGF0ZXBpY2tlcicsXHJcbiAgICBwcm92aWRlcnM6IFtcclxuICAgICAgICBVdGlsU2VydmljZSxcclxuICAgICAgICBEYXRlcGlja2VyTG9jYWxlU2VydmljZSxcclxuICAgICAgICBEZWZhdWx0Q29uZmlnU2VydmljZSxcclxuICAgICAgICBOR1hfRFBfVkFMVUVfQUNDRVNTT1IsXHJcbiAgICAgICAgTkdYX0RQX1ZBTElEQVRPUlNcclxuICAgIF1cclxufSlcclxuZXhwb3J0IGNsYXNzIEZhcnJpc0RhdGVQaWNrZXJEaXJlY3RpdmVcclxuICAgIGltcGxlbWVudHMgT25DaGFuZ2VzLCBPbkRlc3Ryb3ksIENvbnRyb2xWYWx1ZUFjY2Vzc29yLCBWYWxpZGF0b3Ige1xyXG4gICAgQElucHV0KCkgb3B0aW9uczogSU15T3B0aW9ucztcclxuICAgIEBJbnB1dCgpIGxvY2FsZTogc3RyaW5nO1xyXG4gICAgQElucHV0KCkgZGVmYXVsdE1vbnRoOiBzdHJpbmc7XHJcblxyXG4gICAgQE91dHB1dCgpIGRhdGVDaGFuZ2VkOiBFdmVudEVtaXR0ZXI8SU15RGF0ZU1vZGVsPiA9IG5ldyBFdmVudEVtaXR0ZXI8XHJcbiAgICAgICAgSU15RGF0ZU1vZGVsXHJcbiAgICA+KCk7XHJcbiAgICBAT3V0cHV0KCkgaW5wdXRGaWVsZENoYW5nZWQ6IEV2ZW50RW1pdHRlcjxcclxuICAgICAgICBJTXlJbnB1dEZpZWxkQ2hhbmdlZFxyXG4gICAgPiA9IG5ldyBFdmVudEVtaXR0ZXI8SU15SW5wdXRGaWVsZENoYW5nZWQ+KCk7XHJcbiAgICBAT3V0cHV0KCkgY2FsZW5kYXJWaWV3Q2hhbmdlZDogRXZlbnRFbWl0dGVyPFxyXG4gICAgICAgIElNeUNhbGVuZGFyVmlld0NoYW5nZWRcclxuICAgID4gPSBuZXcgRXZlbnRFbWl0dGVyPElNeUNhbGVuZGFyVmlld0NoYW5nZWQ+KCk7XHJcbiAgICBAT3V0cHV0KCkgY2FsZW5kYXJUb2dnbGU6IEV2ZW50RW1pdHRlcjxudW1iZXI+ID0gbmV3IEV2ZW50RW1pdHRlcjxudW1iZXI+KCk7XHJcbiAgICBAT3V0cHV0KCkgcmFuZ2VEYXRlU2VsZWN0aW9uOiBFdmVudEVtaXR0ZXI8XHJcbiAgICAgICAgSU15UmFuZ2VEYXRlU2VsZWN0aW9uXHJcbiAgICA+ID0gbmV3IEV2ZW50RW1pdHRlcjxJTXlSYW5nZURhdGVTZWxlY3Rpb24+KCk7XHJcblxyXG4gICAgcHJpdmF0ZSBjUmVmOiBDb21wb25lbnRSZWY8Q2FsZW5kYXJDb21wb25lbnQ+ID0gbnVsbDtcclxuICAgIHByaXZhdGUgaW5wdXRUZXh0ID0gJyc7XHJcbiAgICBwcml2YXRlIHByZXZlbnRDbG9zZSA9IGZhbHNlO1xyXG4gICAgcHJpdmF0ZSBkaXNhYmxlZCA9IGZhbHNlO1xyXG5cclxuICAgIHByaXZhdGUgb3B0czogSU15T3B0aW9ucztcclxuXHJcbiAgICAvLyBzY3JvbGxGbjogYW55ID0gKGUpID0+IHtcclxuICAgIC8vICAgICBjb25zb2xlLmxvZygoZS50YXJnZXQgYXMgYW55KS5zY3JvbGxUb3ApO1xyXG4gICAgLy8gfTtcclxuXHJcbiAgICBvbkNoYW5nZUNiOiAoXzogYW55KSA9PiB2b2lkID0gKCkgPT4ge307XHJcbiAgICBvblRvdWNoZWRDYjogKCkgPT4gdm9pZCA9ICgpID0+IHt9O1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKFxyXG4gICAgICAgIHB1YmxpYyBsb2NhbGVTZXJ2aWNlOiBEYXRlcGlja2VyTG9jYWxlU2VydmljZSxcclxuICAgICAgICBwcml2YXRlIHV0aWxTZXJ2aWNlOiBVdGlsU2VydmljZSxcclxuICAgICAgICBwcml2YXRlIHZjUmVmOiBWaWV3Q29udGFpbmVyUmVmLFxyXG4gICAgICAgIHByaXZhdGUgY2ZyOiBDb21wb25lbnRGYWN0b3J5UmVzb2x2ZXIsXHJcbiAgICAgICAgcHJpdmF0ZSByZW5kZXJlcjogUmVuZGVyZXIyLFxyXG4gICAgICAgIHByaXZhdGUgY2RyOiBDaGFuZ2VEZXRlY3RvclJlZixcclxuICAgICAgICBwcml2YXRlIGVsZW06IEVsZW1lbnRSZWYsXHJcbiAgICAgICAgcHJpdmF0ZSBjb25maWc6IERlZmF1bHRDb25maWdTZXJ2aWNlLFxyXG4gICAgICAgIHByaXZhdGUgem9uZTogTmdab25lXHJcbiAgICApIHtcclxuICAgICAgICB0aGlzLm9wdHMgPSB0aGlzLmNvbmZpZy5nZXREZWZhdWx0Q29uZmlnKCk7XHJcbiAgICAgICAgdGhpcy5wYXJzZU9wdGlvbnModGhpcy5vcHRzKTtcclxuICAgIH1cclxuXHJcbiAgICBASG9zdExpc3RlbmVyKEtFWVVQLCBbJyRldmVudCddKSBvbktleVVwKGV2ZW50OiBLZXlib2FyZEV2ZW50KSB7XHJcbiAgICAgICAgY29uc3Qga2V5Q29kZTogbnVtYmVyID0gdGhpcy51dGlsU2VydmljZS5nZXRLZXlDb2RlRnJvbUV2ZW50KGV2ZW50KTtcclxuICAgICAgICBpZiAodGhpcy5pZ25vcmVLZXlQcmVzcyhrZXlDb2RlKSkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfSBlbHNlIGlmIChrZXlDb2RlID09PSBLZXlDb2RlLmVzYykge1xyXG4gICAgICAgICAgICB0aGlzLmNsb3NlU2VsZWN0b3IoQ2FsVG9nZ2xlLkNsb3NlQnlFc2MpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHsgdmFsdWUgfSA9IHRoaXMuZWxlbS5uYXRpdmVFbGVtZW50O1xyXG5cclxuICAgICAgICAgICAgbGV0IHZhbGlkID0gZmFsc2U7XHJcbiAgICAgICAgICAgIGlmICghdGhpcy5vcHRzLmRhdGVSYW5nZSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZGF0ZTogSU15RGF0ZSA9IHRoaXMudXRpbFNlcnZpY2UuaXNEYXRlVmFsaWQoXHJcbiAgICAgICAgICAgICAgICAgICAgdmFsdWUsXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vcHRzXHJcbiAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgdmFsaWQgPSB0aGlzLnV0aWxTZXJ2aWNlLmlzSW5pdGlhbGl6ZWREYXRlKGRhdGUpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgeyBiZWdpbiwgZW5kIH0gPSB0aGlzLnV0aWxTZXJ2aWNlLmlzRGF0ZVZhbGlkRGF0ZVJhbmdlKFxyXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlLFxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMub3B0c1xyXG4gICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgIHZhbGlkID1cclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnV0aWxTZXJ2aWNlLmlzSW5pdGlhbGl6ZWREYXRlKGJlZ2luKSAmJlxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMudXRpbFNlcnZpY2UuaXNJbml0aWFsaXplZERhdGUoZW5kKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLmVtaXRJbnB1dEZpZWxkQ2hhbmdlZCh2YWx1ZSwgdmFsaWQpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBASG9zdExpc3RlbmVyKEJMVVIpIG9uQmx1cigpIHtcclxuICAgICAgICBjb25zdCB7XHJcbiAgICAgICAgICAgIGlucHV0RmllbGRWYWxpZGF0aW9uLFxyXG4gICAgICAgICAgICBkYXRlUmFuZ2VcclxuICAgICAgICB9ID0gdGhpcy5vcHRzO1xyXG5cclxuICAgICAgICBpZiAoaW5wdXRGaWVsZFZhbGlkYXRpb24pIHtcclxuICAgICAgICAgICAgY29uc3QgeyB2YWx1ZSB9ID0gdGhpcy5lbGVtLm5hdGl2ZUVsZW1lbnQ7XHJcbiAgICAgICAgICAgIGxldCB2YWxpZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICBpZiAoIWRhdGVSYW5nZSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZGF0ZTogSU15RGF0ZSA9IHRoaXMudXRpbFNlcnZpY2UuaXNEYXRlVmFsaWQoXHJcbiAgICAgICAgICAgICAgICAgICAgdmFsdWUsXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vcHRzXHJcbiAgICAgICAgICAgICAgICApO1xyXG5cclxuICAgICAgICAgICAgICAgIHZhbGlkID0gdGhpcy51dGlsU2VydmljZS5pc0luaXRpYWxpemVkRGF0ZShkYXRlKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IF9kYXRlUmFuZ2U6IElNeURhdGVSYW5nZSA9IHRoaXMudXRpbFNlcnZpY2UuaXNEYXRlVmFsaWREYXRlUmFuZ2UoXHJcbiAgICAgICAgICAgICAgICAgICAgdmFsdWUsXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vcHRzXHJcbiAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgeyBiZWdpbiwgZW5kIH0gPSBfZGF0ZVJhbmdlO1xyXG4gICAgICAgICAgICAgICAgdmFsaWQgPVxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMudXRpbFNlcnZpY2UuaXNJbml0aWFsaXplZERhdGUoYmVnaW4pICYmXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy51dGlsU2VydmljZS5pc0luaXRpYWxpemVkRGF0ZShlbmQpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAoIXZhbGlkICYmIHRoaXMuaW5wdXRUZXh0ICE9PSB2YWx1ZSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jbGVhckRhdGUoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLm9uQ2hhbmdlQ2IodmFsdWUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLm9uVG91Y2hlZENiKCk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gd3JhcHBlciB3aXRoIGFycm93IGZ1bmN0aW9uIHRvIHByZXNlcnZlIHRoZSB1c2Ugb2YgJ3RoaXMnIHdvcmRcclxuICAgIHByaXZhdGUgb25DbGlja1dyYXBwZXIgPSAoZXY6IE1vdXNlRXZlbnQpID0+IHtcclxuICAgICAgICB0aGlzLm9uQ2xpY2soZXYpO1xyXG4gICAgfVxyXG5cclxuICAgIG9uQ2xpY2soZXZ0OiBNb3VzZUV2ZW50KSB7XHJcbiAgICAgICAgaWYgKFxyXG4gICAgICAgICAgICB0aGlzLm9wdHMuY2xvc2VTZWxlY3Rvck9uRG9jdW1lbnRDbGljayAmJlxyXG4gICAgICAgICAgICAhdGhpcy5wcmV2ZW50Q2xvc2UgJiZcclxuICAgICAgICAgICAgZXZ0LnRhcmdldCAmJlxyXG4gICAgICAgICAgICB0aGlzLmNSZWYgIT09IG51bGwgJiZcclxuICAgICAgICAgICAgdGhpcy5lbGVtLm5hdGl2ZUVsZW1lbnQgIT09IGV2dC50YXJnZXQgJiZcclxuICAgICAgICAgICAgIXRoaXMuY1JlZi5sb2NhdGlvbi5uYXRpdmVFbGVtZW50LmNvbnRhaW5zKGV2dC50YXJnZXQpICYmXHJcbiAgICAgICAgICAgICF0aGlzLmRpc2FibGVkXHJcbiAgICAgICAgKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2xvc2VTZWxlY3RvcihDYWxUb2dnbGUuQ2xvc2VCeU91dENsaWNrKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBwdWJsaWMgbmdPbkNoYW5nZXMoY2hhbmdlczogU2ltcGxlQ2hhbmdlcyk6IHZvaWQge1xyXG4gICAgICAgIGlmIChjaGFuZ2VzLmhhc093blByb3BlcnR5KExPQ0FMRSkpIHtcclxuICAgICAgICAgICAgdGhpcy5zZXRMb2NhbGVPcHRpb25zKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoY2hhbmdlcy5oYXNPd25Qcm9wZXJ0eShERUZBVUxUX01PTlRIKSkge1xyXG4gICAgICAgICAgICBsZXQgZG06IGFueSA9IGNoYW5nZXNbREVGQVVMVF9NT05USF0uY3VycmVudFZhbHVlO1xyXG4gICAgICAgICAgICBpZiAodHlwZW9mIGRtID09PSBPQkpFQ1QpIHtcclxuICAgICAgICAgICAgICAgIGRtID0gZG0uZGVmTW9udGg7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5kZWZhdWx0TW9udGggPSBkbTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChjaGFuZ2VzLmhhc093blByb3BlcnR5KE9QVElPTlMpKSB7XHJcbiAgICAgICAgICAgIHRoaXMucGFyc2VPcHRpb25zKGNoYW5nZXNbT1BUSU9OU10uY3VycmVudFZhbHVlKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIG5nT25EZXN0cm95KCk6IHZvaWQge1xyXG4gICAgICAgIHRoaXMuY2xvc2VDYWxlbmRhcigpO1xyXG4gICAgfVxyXG5cclxuICAgIHNldExvY2FsZU9wdGlvbnMoKTogdm9pZCB7XHJcbiAgICAgICAgY29uc3Qgb3B0czogSU15T3B0aW9ucyA9IHRoaXMubG9jYWxlU2VydmljZS5nZXRMb2NhbGVPcHRpb25zKFxyXG4gICAgICAgICAgICB0aGlzLmxvY2FsZVxyXG4gICAgICAgICk7XHJcbiAgICAgICAgT2JqZWN0LmtleXMob3B0cykuZm9yRWFjaChrID0+IHtcclxuICAgICAgICAgICAgKHRoaXMub3B0cyBhcyBJTXlPcHRpb25zKVtrXSA9IG9wdHNba107XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIHBhcnNlT3B0aW9ucyhvcHRzOiBJTXlPcHRpb25zKTogdm9pZCB7XHJcbiAgICAgICAgaWYgKG9wdHMgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICBPYmplY3Qua2V5cyhvcHRzKS5mb3JFYWNoKGsgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKG9wdHNba10gIT09IHVuZGVmaW5lZCAmJiBvcHRzW2tdICE9PSAnJykge1xyXG4gICAgICAgICAgICAgICAgICAgICh0aGlzLm9wdHMgYXMgSU15T3B0aW9ucylba10gPSBvcHRzW2tdO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMub3B0cy5taW5ZZWFyIDwgWWVhci5taW4pIHtcclxuICAgICAgICAgICAgdGhpcy5vcHRzLm1pblllYXIgPSBZZWFyLm1pbjtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMub3B0cy5tYXhZZWFyID4gWWVhci5tYXgpIHtcclxuICAgICAgICAgICAgdGhpcy5vcHRzLm1heFllYXIgPSBZZWFyLm1heDtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBmb3JtYXREYXRlKHZhbHVlOiBhbnkpIHtcclxuICAgICAgICBjb25zdCB7XHJcbiAgICAgICAgICAgIGRhdGVSYW5nZSxcclxuICAgICAgICAgICAgZGF0ZUZvcm1hdCxcclxuICAgICAgICAgICAgbW9udGhMYWJlbHMsXHJcbiAgICAgICAgICAgIGRhdGVSYW5nZURhdGVzRGVsaW1pdGVyLFxyXG4gICAgICAgICAgICByZXR1cm5Gb3JtYXRcclxuICAgICAgICB9ID0gdGhpcy5vcHRzO1xyXG4gICAgICAgIGlmICghZGF0ZVJhbmdlKSB7XHJcbiAgICAgICAgICAgIC8vIFNpbmdsZSBkYXRlIG1vZGVcclxuICAgICAgICAgICAgY29uc3QgZGF0ZTogSU15RGF0ZSA9IHRoaXMudXRpbFNlcnZpY2UuaXNEYXRlVmFsaWQoXHJcbiAgICAgICAgICAgICAgICB2YWx1ZSxcclxuICAgICAgICAgICAgICAgIHRoaXMub3B0c1xyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy51dGlsU2VydmljZS5nZXREYXRlTW9kZWwoXHJcbiAgICAgICAgICAgICAgICBkYXRlLFxyXG4gICAgICAgICAgICAgICAgbnVsbCxcclxuICAgICAgICAgICAgICAgIGRhdGVGb3JtYXQsXHJcbiAgICAgICAgICAgICAgICBtb250aExhYmVscyxcclxuICAgICAgICAgICAgICAgIGRhdGVSYW5nZURhdGVzRGVsaW1pdGVyLFxyXG4gICAgICAgICAgICAgICAgcmV0dXJuRm9ybWF0XHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgLy8gRGF0ZSByYW5nZSBtb2RlXHJcbiAgICAgICAgICAgIGNvbnN0IF9kYXRlUmFuZ2UgPSB0aGlzLnV0aWxTZXJ2aWNlLmlzRGF0ZVZhbGlkRGF0ZVJhbmdlKFxyXG4gICAgICAgICAgICAgICAgdmFsdWUsXHJcbiAgICAgICAgICAgICAgICB0aGlzLm9wdHNcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMudXRpbFNlcnZpY2UuZ2V0RGF0ZU1vZGVsKFxyXG4gICAgICAgICAgICAgICAgbnVsbCxcclxuICAgICAgICAgICAgICAgIF9kYXRlUmFuZ2UsXHJcbiAgICAgICAgICAgICAgICBkYXRlRm9ybWF0LFxyXG4gICAgICAgICAgICAgICAgbW9udGhMYWJlbHMsXHJcbiAgICAgICAgICAgICAgICBkYXRlUmFuZ2VEYXRlc0RlbGltaXRlcixcclxuICAgICAgICAgICAgICAgIHJldHVybkZvcm1hdFxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHB1YmxpYyB3cml0ZVZhbHVlKHZhbHVlOiBhbnkpOiB2b2lkIHtcclxuICAgICAgICBpZiAodGhpcy5kaXNhYmxlZCkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh2YWx1ZSkge1xyXG4gICAgICAgICAgICB2YWx1ZSA9IHRoaXMuZm9ybWF0RGF0ZSh2YWx1ZSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoIXZhbHVlKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2V0SW5wdXRWYWx1ZShFTVBUWV9TVFIpO1xyXG4gICAgICAgICAgICB0aGlzLmVtaXRJbnB1dEZpZWxkQ2hhbmdlZChFTVBUWV9TVFIsIGZhbHNlKTtcclxuXHJcbiAgICAgICAgICAgIGlmICh0aGlzLmNSZWYgIT09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuY1JlZi5pbnN0YW5jZS5yZXNldERhdGVWYWx1ZShSZXNldERhdGVUeXBlLmJvdGgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIGlmICh2YWx1ZS5pc1JhbmdlID09PSBmYWxzZSAmJiB2YWx1ZS5zaW5nbGVEYXRlKSB7XHJcbiAgICAgICAgICAgIC8vIHNpbmdsZSBkYXRlXHJcbiAgICAgICAgICAgIGNvbnN0IHsgZGF0ZSwgZm9ybWF0dGVkIH0gPSB2YWx1ZS5zaW5nbGVEYXRlO1xyXG4gICAgICAgICAgICBjb25zdCB2YWxpZDogYm9vbGVhbiA9IHRoaXMudXRpbFNlcnZpY2UuaXNJbml0aWFsaXplZERhdGUoZGF0ZSk7XHJcbiAgICAgICAgICAgIGlmICh2YWxpZCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXRJbnB1dFZhbHVlKGZvcm1hdHRlZCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmVtaXRJbnB1dEZpZWxkQ2hhbmdlZChmb3JtYXR0ZWQsIHZhbGlkKTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5jUmVmICE9PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jUmVmLmluc3RhbmNlLnJlc2V0RGF0ZVZhbHVlKFJlc2V0RGF0ZVR5cGUuZGF0ZVJhbmdlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSBpZiAodmFsdWUuaXNSYW5nZSA9PT0gdHJ1ZSAmJiB2YWx1ZS5kYXRlUmFuZ2UpIHtcclxuICAgICAgICAgICAgLy8gZGF0ZSByYW5nZVxyXG4gICAgICAgICAgICBjb25zdCB7IGJlZ2luRGF0ZSwgZW5kRGF0ZSwgZm9ybWF0dGVkIH0gPSB2YWx1ZS5kYXRlUmFuZ2U7XHJcblxyXG4gICAgICAgICAgICBpZiAoYmVnaW5EYXRlICYmIGVuZERhdGUpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHZhbGlkOiBib29sZWFuID1cclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnV0aWxTZXJ2aWNlLmlzSW5pdGlhbGl6ZWREYXRlKGJlZ2luRGF0ZSkgJiZcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnV0aWxTZXJ2aWNlLmlzSW5pdGlhbGl6ZWREYXRlKGVuZERhdGUpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHZhbGlkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRJbnB1dFZhbHVlKGZvcm1hdHRlZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5lbWl0SW5wdXRGaWVsZENoYW5nZWQoZm9ybWF0dGVkLCB2YWxpZCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmNSZWYgIT09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jUmVmLmluc3RhbmNlLnJlc2V0RGF0ZVZhbHVlKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgUmVzZXREYXRlVHlwZS5zaW5nbGVEYXRlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyByZWdpc3Rlck9uQ2hhbmdlKGZuOiBhbnkpOiB2b2lkIHtcclxuICAgICAgICB0aGlzLm9uQ2hhbmdlQ2IgPSBmbjtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgcmVnaXN0ZXJPblRvdWNoZWQoZm46IGFueSk6IHZvaWQge1xyXG4gICAgICAgIHRoaXMub25Ub3VjaGVkQ2IgPSBmbjtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgc2V0RGlzYWJsZWRTdGF0ZShpc0Rpc2FibGVkOiBib29sZWFuKTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy5kaXNhYmxlZCA9IGlzRGlzYWJsZWQ7XHJcbiAgICAgICAgdGhpcy5yZW5kZXJlci5zZXRQcm9wZXJ0eShcclxuICAgICAgICAgICAgdGhpcy5lbGVtLm5hdGl2ZUVsZW1lbnQsXHJcbiAgICAgICAgICAgIERJU0FCTEVELFxyXG4gICAgICAgICAgICBpc0Rpc2FibGVkXHJcbiAgICAgICAgKTtcclxuXHJcbiAgICAgICAgaWYgKGlzRGlzYWJsZWQpIHtcclxuICAgICAgICAgICAgdGhpcy5jbG9zZUNhbGVuZGFyKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyB2YWxpZGF0ZShjOiBBYnN0cmFjdENvbnRyb2wpOiB7IFtwOiBzdHJpbmddOiBhbnkgfSB7XHJcbiAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIG9wZW5DYWxlbmRhcigpOiB2b2lkIHtcclxuICAgICAgICBpZiAodGhpcy5kaXNhYmxlZCkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMucHJldmVudENsb3NlID0gdHJ1ZTtcclxuICAgICAgICB0aGlzLmNkci5kZXRlY3RDaGFuZ2VzKCk7XHJcbiAgICAgICAgaWYgKHRoaXMuY1JlZiA9PT0gbnVsbCkge1xyXG4gICAgICAgICAgICB0aGlzLmNSZWYgPSB0aGlzLnZjUmVmLmNyZWF0ZUNvbXBvbmVudChcclxuICAgICAgICAgICAgICAgIHRoaXMuY2ZyLnJlc29sdmVDb21wb25lbnRGYWN0b3J5KENhbGVuZGFyQ29tcG9uZW50KVxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgICAgICB0aGlzLmFwcGVuZFNlbGVjdG9yKHRoaXMuY1JlZi5sb2NhdGlvbi5uYXRpdmVFbGVtZW50KTtcclxuICAgICAgICAgICAgdGhpcy5jUmVmLmluc3RhbmNlLmluaXRpYWxpemUoXHJcbiAgICAgICAgICAgICAgICB0aGlzLm9wdHMsXHJcbiAgICAgICAgICAgICAgICB0aGlzLmRlZmF1bHRNb250aCxcclxuICAgICAgICAgICAgICAgIHRoaXMuZ2V0U2VsZWN0b3JQb3NpdGlvbih0aGlzLmVsZW0ubmF0aXZlRWxlbWVudCksXHJcbiAgICAgICAgICAgICAgICB0aGlzLmVsZW0ubmF0aXZlRWxlbWVudC52YWx1ZSxcclxuICAgICAgICAgICAgICAgIChkbTogSU15RGF0ZU1vZGVsLCBjbG9zZTogYm9vbGVhbikgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZm9jdXNUb0lucHV0KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy51cGRhdGVNb2RlbChkbSk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNsb3NlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY2xvc2VTZWxlY3RvcihDYWxUb2dnbGUuQ2xvc2VCeURhdGVTZWwpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmVtaXREYXRlQ2hhbmdlZChkbSk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5lbWl0SW5wdXRGaWVsZENoYW5nZWQoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudXRpbFNlcnZpY2UuZ2V0Rm9ybWF0dGVkRGF0ZShkbSksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRydWVcclxuICAgICAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIChjdmM6IElNeUNhbGVuZGFyVmlld0NoYW5nZWQpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmVtaXRDYWxlbmRhckNoYW5nZWQoY3ZjKTtcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAocmRzOiBJTXlSYW5nZURhdGVTZWxlY3Rpb24pID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmVtaXRSYW5nZURhdGVTZWxlY3Rpb24ocmRzKTtcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jbG9zZVNlbGVjdG9yKENhbFRvZ2dsZS5DbG9zZUJ5RXNjKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgdGhpcy5lbWl0Q2FsZW5kYXJUb2dnbGUoQ2FsVG9nZ2xlLk9wZW4pO1xyXG4gICAgICAgICAgICB0aGlzLmNkci5kZXRlY3RDaGFuZ2VzKCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5hcHBlbmRTZWxlY3Rvcih0aGlzLmNSZWYubG9jYXRpb24ubmF0aXZlRWxlbWVudCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMucHJldmVudENsb3NlID0gZmFsc2U7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGNsb3NlQ2FsZW5kYXIoKTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy5jbG9zZVNlbGVjdG9yKENhbFRvZ2dsZS5DbG9zZUJ5Q2FsQnRuKTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgdG9nZ2xlQ2FsZW5kYXIoZXZlbnQ6IE1vdXNlRXZlbnQpOiB2b2lkIHtcclxuICAgICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICBpZiAodGhpcy5kaXNhYmxlZCkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLmNSZWYgPT09IG51bGwpIHtcclxuICAgICAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihDTElDSywgdGhpcy5vbkNsaWNrV3JhcHBlciwgdHJ1ZSk7XHJcbiAgICAgICAgICAgIHRoaXMub3BlbkNhbGVuZGFyKCk7XHJcbiAgICAgICAgICAgIGNvbnN0IGNvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5kYXRlLW92ZXJsYXktY29udGFpbmVyJyk7XHJcbiAgICAgICAgICAgIHRoaXMucmVuZGVyZXIuc2V0U3R5bGUoY29udGFpbmVyLCAncG9pbnRlci1ldmVudHMnLCAnYXV0bycpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGxldCBmbGFnID0gdHJ1ZTtcclxuICAgICAgICAgICAgY29uc3QgY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmRhdGUtb3ZlcmxheS1jb250YWluZXInKTtcclxuICAgICAgICAgICAgaWYgKGNvbnRhaW5lciAmJiB0aGlzLmNSZWYubG9jYXRpb24pIHtcclxuICAgICAgICAgICAgICAgIGlmIChjb250YWluZXIuaGFzQ2hpbGROb2RlcygpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29udGFpbmVyLmNoaWxkTm9kZXMuZm9yRWFjaChlbCA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlbCA9PT0gdGhpcy5jUmVmLmxvY2F0aW9uLm5hdGl2ZUVsZW1lbnQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZsYWcgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChmbGFnKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnJlbmRlcmVyLnNldFN0eWxlKGNvbnRhaW5lciwgJ3BvaW50ZXItZXZlbnRzJywgJ2F1dG8nKTtcclxuICAgICAgICAgICAgICAgIHRoaXMub3BlbkNhbGVuZGFyKCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKENMSUNLLCB0aGlzLm9uQ2xpY2tXcmFwcGVyKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuY2xvc2VTZWxlY3RvcihDYWxUb2dnbGUuQ2xvc2VCeUNhbEJ0bik7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnJlbmRlcmVyLnNldFN0eWxlKGNvbnRhaW5lciwgJ3BvaW50ZXItZXZlbnRzJywgJycpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBjbGVhckRhdGUoKTogdm9pZCB7XHJcbiAgICAgICAgaWYgKHRoaXMuZGlzYWJsZWQpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnNldElucHV0VmFsdWUoRU1QVFlfU1RSKTtcclxuICAgICAgICB0aGlzLmVtaXREYXRlQ2hhbmdlZCh7XHJcbiAgICAgICAgICAgIGlzUmFuZ2U6IHRoaXMub3B0cy5kYXRlUmFuZ2UsXHJcbiAgICAgICAgICAgIHNpbmdsZURhdGU6IHtcclxuICAgICAgICAgICAgICAgIGRhdGU6IHRoaXMudXRpbFNlcnZpY2UucmVzZXREYXRlKCksXHJcbiAgICAgICAgICAgICAgICBqc0RhdGU6IG51bGwsXHJcbiAgICAgICAgICAgICAgICBmb3JtYXR0ZWQ6IEVNUFRZX1NUUixcclxuICAgICAgICAgICAgICAgIGVwb2M6IDBcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgZGF0ZVJhbmdlOiB7XHJcbiAgICAgICAgICAgICAgICBiZWdpbkRhdGU6IHRoaXMudXRpbFNlcnZpY2UucmVzZXREYXRlKCksXHJcbiAgICAgICAgICAgICAgICBiZWdpbkpzRGF0ZTogbnVsbCxcclxuICAgICAgICAgICAgICAgIGJlZ2luRXBvYzogMCxcclxuICAgICAgICAgICAgICAgIGVuZERhdGU6IHRoaXMudXRpbFNlcnZpY2UucmVzZXREYXRlKCksXHJcbiAgICAgICAgICAgICAgICBlbmRKc0RhdGU6IG51bGwsXHJcbiAgICAgICAgICAgICAgICBlbmRFcG9jOiAwLFxyXG4gICAgICAgICAgICAgICAgZm9ybWF0dGVkOiBFTVBUWV9TVFJcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMub25DaGFuZ2VDYihudWxsKTtcclxuICAgICAgICB0aGlzLm9uVG91Y2hlZENiKCk7XHJcbiAgICAgICAgdGhpcy5jbG9zZVNlbGVjdG9yKENhbFRvZ2dsZS5DbG9zZUJ5Q2FsQnRuKTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgaXNEYXRlVmFsaWQoKTogYm9vbGVhbiB7XHJcbiAgICAgICAgY29uc3QgeyB2YWx1ZSB9ID0gdGhpcy5lbGVtLm5hdGl2ZUVsZW1lbnQ7XHJcblxyXG4gICAgICAgIGlmICh2YWx1ZSAhPT0gRU1QVFlfU1RSKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGRhdGU6IElNeURhdGUgPSB0aGlzLnV0aWxTZXJ2aWNlLmlzRGF0ZVZhbGlkKFxyXG4gICAgICAgICAgICAgICAgdmFsdWUsXHJcbiAgICAgICAgICAgICAgICB0aGlzLm9wdHNcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgaWYgKHRoaXMudXRpbFNlcnZpY2UuaXNJbml0aWFsaXplZERhdGUoZGF0ZSkpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZW1pdElucHV0RmllbGRDaGFuZ2VkKHZhbHVlLCB0cnVlKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuZW1pdElucHV0RmllbGRDaGFuZ2VkKHZhbHVlLCBmYWxzZSk7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgaWdub3JlS2V5UHJlc3Moa2V5Q29kZTogbnVtYmVyKTogYm9vbGVhbiB7XHJcbiAgICAgICAgLy8ga2V5Q29kZSA9PT0gS2V5Q29kZS50YWIgfHxcclxuXHJcbiAgICAgICAgcmV0dXJuIChcclxuICAgICAgICAgICAga2V5Q29kZSA9PT0gS2V5Q29kZS5sZWZ0QXJyb3cgfHxcclxuICAgICAgICAgICAga2V5Q29kZSA9PT0gS2V5Q29kZS5yaWdodEFycm93IHx8XHJcbiAgICAgICAgICAgIGtleUNvZGUgPT09IEtleUNvZGUudXBBcnJvdyB8fFxyXG4gICAgICAgICAgICBrZXlDb2RlID09PSBLZXlDb2RlLmRvd25BcnJvdyB8fFxyXG4gICAgICAgICAgICBrZXlDb2RlID09PSBLZXlDb2RlLnNoaWZ0XHJcbiAgICAgICAgKTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGNsb3NlU2VsZWN0b3IocmVhc29uOiBudW1iZXIpOiB2b2lkIHtcclxuICAgICAgICBpZiAodGhpcy5jUmVmICE9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHRoaXMudmNSZWYucmVtb3ZlKHRoaXMudmNSZWYuaW5kZXhPZih0aGlzLmNSZWYuaG9zdFZpZXcpKTtcclxuICAgICAgICAgICAgdGhpcy5jUmVmID0gbnVsbDtcclxuICAgICAgICAgICAgdGhpcy5jZHIuZGV0ZWN0Q2hhbmdlcygpO1xyXG4gICAgICAgICAgICB0aGlzLmVtaXRDYWxlbmRhclRvZ2dsZShyZWFzb24pO1xyXG4gICAgICAgICAgICBjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZGF0ZS1vdmVybGF5LWNvbnRhaW5lcicpO1xyXG4gICAgICAgICAgICB0aGlzLnJlbmRlcmVyLnNldFN0eWxlKGNvbnRhaW5lciwgJ3BvaW50ZXItZXZlbnRzJywgJycpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIHVwZGF0ZU1vZGVsKG1vZGVsOiBJTXlEYXRlTW9kZWwpOiB2b2lkIHtcclxuICAgICAgICB0aGlzLnNldElucHV0VmFsdWUodGhpcy51dGlsU2VydmljZS5nZXRGb3JtYXR0ZWREYXRlKG1vZGVsKSk7XHJcbiAgICAgICAgdGhpcy5vbkNoYW5nZUNiKHRoaXMudXRpbFNlcnZpY2UuZ2V0Rm9ybWF0dGVkRGF0ZShtb2RlbCkpO1xyXG4gICAgICAgIHRoaXMub25Ub3VjaGVkQ2IoKTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIHNldElucHV0VmFsdWUodmFsdWU6IHN0cmluZyk6IHZvaWQge1xyXG4gICAgICAgIHRoaXMuaW5wdXRUZXh0ID0gdmFsdWU7XHJcbiAgICAgICAgdGhpcy5yZW5kZXJlci5zZXRQcm9wZXJ0eSh0aGlzLmVsZW0ubmF0aXZlRWxlbWVudCwgVkFMVUUsIHZhbHVlKTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGZvY3VzVG9JbnB1dCgpOiB2b2lkIHtcclxuICAgICAgICBpZiAodGhpcy5vcHRzLmZvY3VzSW5wdXRPbkRhdGVTZWxlY3QpIHtcclxuICAgICAgICAgICAgdGhpcy5lbGVtLm5hdGl2ZUVsZW1lbnQuZm9jdXMoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBlbWl0RGF0ZUNoYW5nZWQoZGF0ZU1vZGVsOiBJTXlEYXRlTW9kZWwpOiB2b2lkIHtcclxuICAgICAgICB0aGlzLmRhdGVDaGFuZ2VkLmVtaXQoZGF0ZU1vZGVsKTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGVtaXRJbnB1dEZpZWxkQ2hhbmdlZCh2YWx1ZTogc3RyaW5nLCB2YWxpZDogYm9vbGVhbik6IHZvaWQge1xyXG4gICAgICAgIHRoaXMuaW5wdXRGaWVsZENoYW5nZWQuZW1pdCh7XHJcbiAgICAgICAgICAgIHZhbHVlLFxyXG4gICAgICAgICAgICBkYXRlRm9ybWF0OiB0aGlzLm9wdHMuZGF0ZUZvcm1hdCxcclxuICAgICAgICAgICAgdmFsaWRcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGVtaXRDYWxlbmRhckNoYW5nZWQoY3ZjOiBJTXlDYWxlbmRhclZpZXdDaGFuZ2VkKSB7XHJcbiAgICAgICAgdGhpcy5jYWxlbmRhclZpZXdDaGFuZ2VkLmVtaXQoY3ZjKTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGVtaXRSYW5nZURhdGVTZWxlY3Rpb24ocmRzOiBJTXlSYW5nZURhdGVTZWxlY3Rpb24pIHtcclxuICAgICAgICB0aGlzLnJhbmdlRGF0ZVNlbGVjdGlvbi5lbWl0KHJkcyk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBlbWl0Q2FsZW5kYXJUb2dnbGUocmVhc29uOiBudW1iZXIpOiB2b2lkIHtcclxuICAgICAgICB0aGlzLmNhbGVuZGFyVG9nZ2xlLmVtaXQocmVhc29uKTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGpzRGF0ZVRvTXlEYXRlKGRhdGU6IERhdGUpOiBJTXlEYXRlIHtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICB5ZWFyOiBkYXRlLmdldEZ1bGxZZWFyKCksXHJcbiAgICAgICAgICAgIG1vbnRoOiBkYXRlLmdldE1vbnRoKCkgKyAxLFxyXG4gICAgICAgICAgICBkYXk6IGRhdGUuZ2V0RGF0ZSgpXHJcbiAgICAgICAgfTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGFwcGVuZFNlbGVjdG9yKGVsZW06IGFueSk6IHZvaWQge1xyXG4gICAgICAgIGxldCBjb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZGF0ZS1vdmVybGF5LWNvbnRhaW5lcicpO1xyXG4gICAgICAgIGlmIChjb250YWluZXIpIHtcclxuICAgICAgICAgICAgaWYgKGNvbnRhaW5lci5oYXNDaGlsZE5vZGVzKCkpIHtcclxuICAgICAgICAgICAgICAgIGNvbnRhaW5lci5jaGlsZE5vZGVzLmZvckVhY2goZWwgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChlbCAhPT0gZWxlbSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250YWluZXIucmVtb3ZlQ2hpbGQoZWwpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgY29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICAgICAgICAgIGNvbnRhaW5lci5jbGFzc0xpc3QuYWRkKCdkYXRlLW92ZXJsYXktY29udGFpbmVyJyk7XHJcbiAgICAgICAgICAgIGNvbnRhaW5lci5jbGFzc0xpc3QuYWRkKCdvdmVybGF5LWNvbnRhaW5lcicpO1xyXG4gICAgICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGNvbnRhaW5lcik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZChlbGVtKTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGdldFNlbGVjdG9yUG9zaXRpb24oZWxlbTogYW55KTogSU15U2VsZWN0b3JQb3NpdGlvbiB7XHJcbiAgICAgICAgbGV0IHRvcCA9IDA7XHJcbiAgICAgICAgbGV0IGxlZnQgPSAwO1xyXG4gICAgICAgIGxldCBfc2VsZWN0b3JIZWlnaHQgPSAwO1xyXG4gICAgICAgIGxldCBfc2VsZWN0b3JXaWR0aCA9IDA7XHJcbiAgICAgICAgY29uc3Qge1xyXG4gICAgICAgICAgICBzZWxlY3RvckhlaWdodCxcclxuICAgICAgICAgICAgc2VsZWN0b3JXaWR0aCxcclxuICAgICAgICAgICAgc2hvd1RpbWUsXHJcbiAgICAgICAgICAgIGRhdGVSYW5nZVxyXG4gICAgICAgIH0gPSB0aGlzLm9wdHM7XHJcblxyXG4gICAgICAgIGNvbnN0IGI6IGFueSA9IGRvY3VtZW50LmJvZHkuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XHJcbiAgICAgICAgY29uc3QgZTogYW55ID0gZWxlbS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcclxuICAgICAgICB0b3AgPSBlLnRvcCAtIGIudG9wO1xyXG4gICAgICAgIGxlZnQgPSBlLmxlZnQgLSBiLmxlZnQ7XHJcbiAgICAgICAgbGV0IHBvc2l0aW9uID0gJ2JvdHRvbSc7XHJcbiAgICAgICAgaWYgKGRhdGVSYW5nZSkge1xyXG4gICAgICAgICAgICBfc2VsZWN0b3JXaWR0aCA9IHRoaXMuZ2V0U2VsZWN0b3JEaW1lbnNpb24oc2VsZWN0b3JXaWR0aCkgKiAyO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIF9zZWxlY3RvcldpZHRoID0gdGhpcy5nZXRTZWxlY3RvckRpbWVuc2lvbihzZWxlY3RvcldpZHRoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChzaG93VGltZSkge1xyXG4gICAgICAgICAgICBfc2VsZWN0b3JIZWlnaHQgPSB0aGlzLmdldFNlbGVjdG9yRGltZW5zaW9uKHNlbGVjdG9ySGVpZ2h0KSArIDM2O1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIF9zZWxlY3RvckhlaWdodCA9IHRoaXMuZ2V0U2VsZWN0b3JEaW1lbnNpb24oc2VsZWN0b3JIZWlnaHQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodG9wICsgZWxlbS5vZmZzZXRIZWlnaHQgKyBfc2VsZWN0b3JIZWlnaHQgPiB3aW5kb3cuaW5uZXJIZWlnaHQgJiYgdG9wIC0gX3NlbGVjdG9ySGVpZ2h0IC0gMiA+IDApIHtcclxuICAgICAgICAgICAgdG9wID0gdG9wIC0gX3NlbGVjdG9ySGVpZ2h0IC0gMjtcclxuICAgICAgICAgICAgcG9zaXRpb24gPSAndG9wJztcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0b3AgPSB0b3AgKyBlbGVtLm9mZnNldEhlaWdodCArIDI7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAobGVmdCArIF9zZWxlY3RvcldpZHRoID4gYi53aWR0aCkge1xyXG4gICAgICAgICAgICBsZWZ0ID0gYi53aWR0aCAtIF9zZWxlY3RvcldpZHRoIC0gMTU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGxlZnQgPSBsZWZ0ID4gMCA/IGxlZnQgOiAwO1xyXG4gICAgICAgIHJldHVybiB7IHRvcCAsIGxlZnQsIHBvc2l0aW9uIH07XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBnZXRTZWxlY3RvckRpbWVuc2lvbih2YWx1ZTogc3RyaW5nKTogbnVtYmVyIHtcclxuICAgICAgICByZXR1cm4gTnVtYmVyKHZhbHVlLnJlcGxhY2UoUFgsIEVNUFRZX1NUUikpO1xyXG4gICAgfVxyXG59XHJcbiJdfQ==