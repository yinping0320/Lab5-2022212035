/**
 * @fileoverview added by tsickle
 * Generated from: lib/querycondition-advanced/querycondition-advanced.component.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, Input, Output, EventEmitter, ElementRef, Injector, ViewChild } from '@angular/core';
import { StateService } from './service/state.service';
import { NotifyService } from '@farris/ui-notify';
import { cloneDeep } from 'lodash-es';
import { SolutionService } from '../service/solution.service';
import { QuerySolutionVo } from '../entity/querysolutionvo';
import { MessagerService } from '@farris/ui-messager';
import { LocaleService } from '@farris/ui-locale';
var QueryconditionAdvancedComponent = /** @class */ (function () {
    function QueryconditionAdvancedComponent(notifySer, msgSer, localeService, solutionService, stateSer, injector) {
        var _this = this;
        this.notifySer = notifySer;
        this.msgSer = msgSer;
        this.localeService = localeService;
        this.solutionService = solutionService;
        this.stateSer = stateSer;
        this.injector = injector;
        this.dataSubscribe = null;
        this.dataListSubscribe = null;
        this._self = null;
        //子组件受否需要限定最大高度，默认true拖动高度后false
        this.isLimitHeight = true;
        this.conditionChange = new EventEmitter();
        // this.fieldConfig = this.stateSer.getFieldConfig()
        this.dataSubscribe = this.stateSer.queryconditionData$.subscribe((/**
         * @param {?} data
         * @return {?}
         */
        function (data) {
            _this.queryconditionData = data;
            _this.selectSolution.queryConditionsAdvanced = data;
        }));
        this.dataListSubscribe = this.stateSer.queryconditionListData$.subscribe((/**
         * @param {?} queryconditionListData
         * @return {?}
         */
        function (queryconditionListData) {
            _this.conditionChange.emit(queryconditionListData);
        }));
        this._self = this.injector.get(ElementRef);
    }
    Object.defineProperty(QueryconditionAdvancedComponent.prototype, "selectSolution", {
        get: /**
         * @return {?}
         */
        function () {
            return this._selectSolution;
        },
        set: /**
         * @param {?} value
         * @return {?}
         */
        function (value) {
            if (value && this._selectSolution && value.id === this._selectSolution.id) {
                return;
            }
            this._selectSolution = value;
            this.queryconditionData = value.queryConditionsAdvanced;
            this.stateSer.setQueryconditionData(value.queryConditionsAdvanced);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(QueryconditionAdvancedComponent.prototype, "fieldConfig", {
        get: /**
         * @return {?}
         */
        function () {
            return this._fieldConfig;
        },
        set: /**
         * @param {?} value
         * @return {?}
         */
        function (value) {
            //undo 范围型的组件暂不支持 
            //doing 将范围型组件重置为单值类型，方法，先反格式化，拿到基础值，遍历rangeList，将相关控件类型替换后再进行格式化
            //undo 范围型的组件暂不支持 
            //doing 将范围型组件重置为单值类型，方法，先反格式化，拿到基础值，遍历rangeList，将相关控件类型替换后再进行格式化
            /** @type {?} */
            var _value = cloneDeep(value);
            _value.forEach((/**
             * @param {?} val
             * @return {?}
             */
            function (val) {
                if (val.control.controltype === 'single-date') {
                    val.control.isDynamicDate = false;
                }
                else if (val.control.controltype === 'radio') {
                    val.control.horizontal = true;
                }
            }));
            //将单日期里面的支持动态日期属性群不改为false
            /** @type {?} */
            var modifyFieldConfig = this.rangeToSimpleControlType(_value);
            this._fieldConfig = this.solutionService.convertToQueryConditions(modifyFieldConfig);
            //波尔选择控件如果没有默认值，赋值位false，为什么不放在上面。因为不敢动之前的构造函数
            this._fieldConfig.forEach((/**
             * @param {?} val
             * @return {?}
             */
            function (val) {
                if (val.control.getControlType() === 8 && !val.value.getOriginalValue().length) {
                    val.value.setOriginalValue([false]);
                }
            }));
            this.stateSer.changeFieldConfig(this._fieldConfig);
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    QueryconditionAdvancedComponent.prototype.ngAfterViewInit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        //监听resize事件变化
        setTimeout((/**
         * @return {?}
         */
        function () { _this.handleResizeChange(); }), 1000);
    };
    /**
     * @return {?}
     */
    QueryconditionAdvancedComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () { };
    /**
     * @return {?}
     */
    QueryconditionAdvancedComponent.prototype.ngOnDestroy = /**
     * @return {?}
     */
    function () {
        this.dataSubscribe.unsubscribe();
        this.dataListSubscribe.unsubscribe();
    };
    //最外层增加筛选条件
    //最外层增加筛选条件
    /**
     * @return {?}
     */
    QueryconditionAdvancedComponent.prototype.addItem = 
    //最外层增加筛选条件
    /**
     * @return {?}
     */
    function () {
        if (!this.fieldConfig.length) {
            this.notifySer.error('未检测到存在筛选条件。');
        }
        else {
            /** @type {?} */
            var item = cloneDeep(this.fieldConfig[0]);
            this.stateSer.changeQueryconditionData({ item: item, path: [1] }, 'add', true);
            this.advancedContent.nativeElement.scrollTo({ top: this.advancedContent.nativeElement.scrollHeight });
        }
    };
    //增加分组
    //增加分组
    /**
     * @return {?}
     */
    QueryconditionAdvancedComponent.prototype.addGroup = 
    //增加分组
    /**
     * @return {?}
     */
    function () {
        this.stateSer.addGroup();
    };
    //重置
    //重置
    /**
     * @return {?}
     */
    QueryconditionAdvancedComponent.prototype.reset = 
    //重置
    /**
     * @return {?}
     */
    function () {
        var _this = this;
        this.msgSer.confirm(this.localeService.getValue('advancedMode.info.resetInfo')).subscribe((/**
         * @param {?} isConfirm
         * @return {?}
         */
        function (isConfirm) {
            if (isConfirm) {
                _this.stateSer.reset();
                //触发回车，进行查询操作
                /** @type {?} */
                var event_1 = document.createEvent('Event');
                event_1.initEvent('keydown', true, false);
                event_1 = Object.assign(event_1, {
                    ctrlKey: false,
                    metaKey: false,
                    altKey: false,
                    which: 13,
                    keyCode: 13,
                    key: 'Enter',
                    code: 'Enter'
                });
                _this._self.nativeElement.dispatchEvent(event_1);
            }
        }));
    };
    /**
     * @param {?} configs
     * @return {?}
     */
    QueryconditionAdvancedComponent.prototype.rangeToSimpleControlType = /**
     * @param {?} configs
     * @return {?}
     */
    function (configs) {
        var _this = this;
        /** @type {?} */
        var unformatConfigs = cloneDeep(configs);
        unformatConfigs.forEach((/**
         * @param {?} val
         * @return {?}
         */
        function (val) {
            if (val.control && val.control.controltype) {
                val.control.controltype = _this.rangeToSimpleTypeModify(val.control.controltype);
            }
        }));
        return unformatConfigs;
    };
    //转化部分控件类型
    //转化部分控件类型
    /**
     * @param {?} controlType
     * @return {?}
     */
    QueryconditionAdvancedComponent.prototype.rangeToSimpleTypeModify = 
    //转化部分控件类型
    /**
     * @param {?} controlType
     * @return {?}
     */
    function (controlType) {
        /** @type {?} */
        var result = '';
        switch (controlType) {
            case 'date':
                result = 'single-date';
                break;
            case 'date-time':
                result = 'single-date-time';
                break;
            case 'month':
                result = 'single-month';
                break;
            case 'number':
                result = 'single-number';
                break;
            default:
                result = controlType;
        }
        return result;
    };
    /**
     * 监听筛选条件组件大小变化的方法，高度超过指定值时取消内部组件最大高度值限制
     */
    /**
     * 监听筛选条件组件大小变化的方法，高度超过指定值时取消内部组件最大高度值限制
     * @return {?}
     */
    QueryconditionAdvancedComponent.prototype.handleResizeChange = /**
     * 监听筛选条件组件大小变化的方法，高度超过指定值时取消内部组件最大高度值限制
     * @return {?}
     */
    function () {
        var _this = this;
        //@ts-ignore
        /** @type {?} */
        var myObserver = new ResizeObserver((/**
         * @param {?} entries
         * @return {?}
         */
        function (entries) {
            entries.forEach((/**
             * @param {?} entry
             * @return {?}
             */
            function (entry) {
                if (entry.target.style.height < 431) {
                    _this.isLimitHeight = true;
                }
                else {
                    _this.isLimitHeight = false;
                }
            }));
        }));
        myObserver.observe(this.advancedElement.nativeElement);
    };
    QueryconditionAdvancedComponent.decorators = [
        { type: Component, args: [{
                    selector: 'querycondition-advanced',
                    template: "<div class=\"querycondition-advanced\" #advancedElement>\r\n\r\n    <div class=\"querycondition-advanced-body\" #advancedContent [ngClass]=\"{'querycondition-advanced-body-maxh':isLimitHeight}\">\r\n        <querycondition-group [data]=\"queryconditionData\"></querycondition-group>\r\n\r\n    </div>\r\n    <div class=\"querycondition-advanced-bottom\">\r\n        <div class=\"add-condition-btn mb-1 mr-3\" (click)=\"addItem()\"><span class=\"f-icon f-icon-filter-add\"></span><span\r\n                class=\"ml-1\">{{'advancedMode.text.addCondition' | locale}}</span></div>\r\n        <div class=\"add-condition-btn mb-1\" (click)=\"addGroup()\"><span\r\n                class=\"f-icon f-icon-filter-grouping\"></span><span class=\"ml-1\">{{'advancedMode.text.addConditionGroup'\r\n                | locale}}</span></div>\r\n        <div *ngIf=\"queryconditionData && (queryconditionData.items.length || queryconditionData.children.length)\" class=\"querycondition-advanced-reset add-condition-btn\" (click)=\"reset()\">{{'advancedMode.text.reset' |\r\n            locale}}</div>\r\n    </div>\r\n\r\n</div>",
                    providers: [SolutionService],
                    styles: [".querycondition-advanced{width:100%;display:-webkit-box;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-direction:column;overflow-y:hidden;resize:vertical;min-height:50px}.querycondition-advanced-body{height:calc(100% - 32px);overflow-y:auto}.querycondition-advanced-body-maxh{max-height:380px}.querycondition-advanced-bottom{position:relative;margin:14px 0 14px 6px}.querycondition-advanced-reset{position:absolute;right:32px;bottom:4px}.add-group-btn{width:100%;background:rgb(239,245,255,.65);border:1px solid rgba(219,233,255,1);border-radius:6px;color:#2a87ff;font-size:13px}.add-condition-btn{font-size:13px;display:inline-block}.add-condition-btn:hover{cursor:pointer}.add-condition-btn .f-icon{vertical-align:text-bottom;position:relative;width:16px;height:16px;border-radius:50%}.add-condition-btn .f-icon-filter-add::before{position:relative;bottom:3px;left:2px;font-size:12px}.add-condition-btn .f-icon-filter-grouping::before{position:relative;bottom:3px;left:1px;font-size:12px}"]
                }] }
    ];
    /** @nocollapse */
    QueryconditionAdvancedComponent.ctorParameters = function () { return [
        { type: NotifyService },
        { type: MessagerService },
        { type: LocaleService },
        { type: SolutionService },
        { type: StateService },
        { type: Injector }
    ]; };
    QueryconditionAdvancedComponent.propDecorators = {
        selectSolution: [{ type: Input }],
        fieldConfig: [{ type: Input }],
        conditionChange: [{ type: Output, args: ['conditionChange',] }],
        advancedContent: [{ type: ViewChild, args: ['advancedContent',] }],
        advancedElement: [{ type: ViewChild, args: ['advancedElement',] }]
    };
    return QueryconditionAdvancedComponent;
}());
export { QueryconditionAdvancedComponent };
if (false) {
    /** @type {?} */
    QueryconditionAdvancedComponent.prototype.queryconditionData;
    /** @type {?} */
    QueryconditionAdvancedComponent.prototype._selectSolution;
    /** @type {?} */
    QueryconditionAdvancedComponent.prototype._fieldConfig;
    /** @type {?} */
    QueryconditionAdvancedComponent.prototype.dataSubscribe;
    /** @type {?} */
    QueryconditionAdvancedComponent.prototype.dataListSubscribe;
    /** @type {?} */
    QueryconditionAdvancedComponent.prototype._self;
    /** @type {?} */
    QueryconditionAdvancedComponent.prototype.isLimitHeight;
    /** @type {?} */
    QueryconditionAdvancedComponent.prototype.conditionChange;
    /** @type {?} */
    QueryconditionAdvancedComponent.prototype.advancedContent;
    /** @type {?} */
    QueryconditionAdvancedComponent.prototype.advancedElement;
    /**
     * @type {?}
     * @private
     */
    QueryconditionAdvancedComponent.prototype.notifySer;
    /**
     * @type {?}
     * @private
     */
    QueryconditionAdvancedComponent.prototype.msgSer;
    /**
     * @type {?}
     * @private
     */
    QueryconditionAdvancedComponent.prototype.localeService;
    /**
     * @type {?}
     * @private
     */
    QueryconditionAdvancedComponent.prototype.solutionService;
    /**
     * @type {?}
     * @private
     */
    QueryconditionAdvancedComponent.prototype.stateSer;
    /**
     * @type {?}
     * @private
     */
    QueryconditionAdvancedComponent.prototype.injector;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicXVlcnljb25kaXRpb24tYWR2YW5jZWQuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGZhcnJpcy9jb21wb25lbnQtcXVlcnljb25kaXRpb24vIiwic291cmNlcyI6WyJsaWIvcXVlcnljb25kaXRpb24tYWR2YW5jZWQvcXVlcnljb25kaXRpb24tYWR2YW5jZWQuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7O0FBQUEsT0FBTyxFQUFFLFNBQVMsRUFBRSxLQUFLLEVBQW9CLE1BQU0sRUFBRSxZQUFZLEVBQWEsVUFBVSxFQUFFLFFBQVEsRUFBRSxTQUFTLEVBQWlCLE1BQU0sZUFBZSxDQUFDO0FBR3BKLE9BQU8sRUFBRSxZQUFZLEVBQUUsTUFBTSx5QkFBeUIsQ0FBQztBQUV2RCxPQUFPLEVBQUUsYUFBYSxFQUFFLE1BQU0sbUJBQW1CLENBQUM7QUFDbEQsT0FBTyxFQUFFLFNBQVMsRUFBRSxNQUFNLFdBQVcsQ0FBQztBQUN0QyxPQUFPLEVBQUUsZUFBZSxFQUFFLE1BQU0sNkJBQTZCLENBQUM7QUFFOUQsT0FBTyxFQUFFLGVBQWUsRUFBRSxNQUFNLDJCQUEyQixDQUFBO0FBQzNELE9BQU8sRUFBRSxlQUFlLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQztBQUN0RCxPQUFPLEVBQUUsYUFBYSxFQUFFLE1BQU0sbUJBQW1CLENBQUM7QUFFbEQ7SUE2REUseUNBQW9CLFNBQXdCLEVBQVUsTUFBdUIsRUFBVSxhQUE0QixFQUFVLGVBQWdDLEVBQVUsUUFBc0IsRUFBVSxRQUFrQjtRQUF6TixpQkFhQztRQWJtQixjQUFTLEdBQVQsU0FBUyxDQUFlO1FBQVUsV0FBTSxHQUFOLE1BQU0sQ0FBaUI7UUFBVSxrQkFBYSxHQUFiLGFBQWEsQ0FBZTtRQUFVLG9CQUFlLEdBQWYsZUFBZSxDQUFpQjtRQUFVLGFBQVEsR0FBUixRQUFRLENBQWM7UUFBVSxhQUFRLEdBQVIsUUFBUSxDQUFVO1FBVnpOLGtCQUFhLEdBQWlCLElBQUksQ0FBQTtRQUNs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LGVBQWU7Z0JBSmYsWUFBWTtnQkFIcUUsUUFBUTs7O2lDQXdCL0YsS0FBSzs4QkFXTCxLQUFLO2tDQW1DTCxNQUFNLFNBQUMsaUJBQWlCO2tDQUV4QixTQUFTLFNBQUMsaUJBQWlCO2tDQUMzQixTQUFTLFNBQUMsaUJBQWlCOztJQTRIOUIsc0NBQUM7Q0FBQSxBQXhMRCxJQXdMQztTQWpMWSwrQkFBK0I7OztJQUUxQyw2REFBOEM7O0lBQzlDLDBEQUFnQzs7SUF3Q2hDLHVEQUFtQzs7SUFDbkMsd0RBQWtDOztJQUNsQyw0REFBc0M7O0lBQ3RDLGdEQUFZOztJQUdaLHdEQUFvQjs7SUFDcEIsMERBQWdFOztJQUVoRSwwREFBMEQ7O0lBQzFELDBEQUEwRDs7Ozs7SUFDOUMsb0RBQWdDOzs7OztJQUFFLGlEQUErQjs7Ozs7SUFBRSx3REFBb0M7Ozs7O0lBQUUsMERBQXdDOzs7OztJQUFFLG1EQUE4Qjs7Ozs7SUFBRSxtREFBMEIiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb21wb25lbnQsIElucHV0LCBPbkluaXQsIE9wdGlvbmFsLCBPdXRwdXQsIEV2ZW50RW1pdHRlciwgT25EZXN0cm95LCBFbGVtZW50UmVmLCBJbmplY3RvciwgVmlld0NoaWxkLCBBZnRlclZpZXdJbml0IH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcblxyXG5pbXBvcnQgeyBRdWVyeWNvbmRpdGlvbkFkdmFuY2VkRGF0YSB9IGZyb20gJy4vdHlwZS90eXBlJ1xyXG5pbXBvcnQgeyBTdGF0ZVNlcnZpY2UgfSBmcm9tICcuL3NlcnZpY2Uvc3RhdGUuc2VydmljZSc7XHJcbmltcG9ydCB7IFF1ZXJ5Q29uZGl0aW9uIH0gZnJvbSAnLi4vZW50aXR5L3F1ZXJ5Q29uZGl0aW9uJ1xyXG5pbXBvcnQgeyBOb3RpZnlTZXJ2aWNlIH0gZnJvbSAnQGZhcnJpcy91aS1ub3RpZnknO1xyXG5pbXBvcnQgeyBjbG9uZURlZXAgfSBmcm9tICdsb2Rhc2gtZXMnO1xyXG5pbXBvcnQgeyBTb2x1dGlvblNlcnZpY2UgfSBmcm9tICcuLi9zZXJ2aWNlL3NvbHV0aW9uLnNlcnZpY2UnO1xyXG5pbXBvcnQgeyBDb250cm9sVHlwZSB9IGZyb20gJy4uL2VudGl0eS9jb250cm9sdHlwZSc7XHJcbmltcG9ydCB7IFF1ZXJ5U29sdXRpb25WbyB9IGZyb20gJy4uL2VudGl0eS9xdWVyeXNvbHV0aW9udm8nXHJcbmltcG9ydCB7IE1lc3NhZ2VyU2VydmljZSB9IGZyb20gJ0BmYXJyaXMvdWktbWVzc2FnZXInO1xyXG5pbXBvcnQgeyBMb2NhbGVTZXJ2aWNlIH0gZnJvbSAnQGZhcnJpcy91aS1sb2NhbGUnO1xyXG5pbXBvcnQgeyBTdWJzY3JpcHRpb24gfSBmcm9tICdyeGpzL2ludGVybmFsL1N1YnNjcmlwdGlvbic7XHJcbkBDb21wb25lbnQoe1xyXG4gIHNlbGVjdG9yOiAncXVlcnljb25kaXRpb24tYWR2YW5jZWQnLFxyXG4gIHRlbXBsYXRlVXJsOiAnLi9xdWVyeWNvbmRpdGlvbi1hZHZhbmNlZC5jb21wb25lbnQuaHRtbCcsXHJcbiAgc3R5bGVVcmxzOiBbJy4vcXVlcnljb25kaXRpb24tYWR2YW5jZWQuY29tcG9uZW50LmNzcyddLFxyXG4gIHByb3ZpZGVyczogW1NvbHV0aW9uU2VydmljZV1cclxufSlcclxuXHJcbmV4cG9ydCBjbGFzcyBRdWVyeWNvbmRpdGlvbkFkdmFuY2VkQ29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0LCBPbkRlc3Ryb3ksIEFmdGVyVmlld0luaXQge1xyXG5cclxuICBxdWVyeWNvbmRpdGlvbkRhdGE6IFF1ZXJ5Y29uZGl0aW9uQWR2YW5jZWREYXRhXHJcbiAgX3NlbGVjdFNvbHV0aW9uOiBRdWVyeVNvbHV0aW9uVm9cclxuICBASW5wdXQoKSBnZXQgc2VsZWN0U29sdXRpb24oKSB7XHJcbiAgICByZXR1cm4gdGhpcy5fc2VsZWN0U29sdXRpb25cclxuICB9XHJcbiAgc2V0IHNlbGVjdFNvbHV0aW9uKHZhbHVlOiBRdWVyeVNvbHV0aW9uVm8pIHtcclxuICAgIGlmICh2YWx1ZSAmJiB0aGlzLl9zZWxlY3RTb2x1dGlvbiAmJiB2YWx1ZS5pZCA9PT0gdGhpcy5fc2VsZWN0U29sdXRpb24uaWQpIHtcclxuICAgICAgcmV0dXJuXHJcbiAgICB9XHJcbiAgICB0aGlzLl9zZWxlY3RTb2x1dGlvbiA9IHZhbHVlXHJcbiAgICB0aGlzLnF1ZXJ5Y29uZGl0aW9uRGF0YSA9IHZhbHVlLnF1ZXJ5Q29uZGl0aW9uc0FkdmFuY2VkXHJcbiAgICB0aGlzLnN0YXRlU2VyLnNldFF1ZXJ5Y29uZGl0aW9uRGF0YSh2YWx1ZS5xdWVyeUNvbmRpdGlvbnNBZHZhbmNlZClcclxuICB9XHJcbiAgQElucHV0KCkgZ2V0IGZpZWxkQ29uZmlnKCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX2ZpZWxkQ29uZmlnXHJcbiAgfVxyXG4gIHNldCBmaWVsZENvbmZpZyh2YWx1ZSkge1xyXG4gICAgLy91bmRvIOiMg+WbtOWei+eahOe7hOS7tuaaguS4jeaUr+aMgSBcclxuICAgIC8vZG9pbmcg5bCG6IyD5Zu05Z6L57uE5Lu26YeN572u5Li65Y2V5YC857G75Z6L77yM5pa55rOV77yM5YWI5Y+N5qC85byP5YyW77yM5ou/5Yiw5Z+656GA5YC877yM6YGN5Y6GcmFuZ2VMaXN077yM5bCG55u45YWz5o6n5Lu257G75Z6L5pu/5o2i5ZCO5YaN6L+b6KGM5qC85byP5YyWXHJcblxyXG4gICAgbGV0IF92YWx1ZSA9IGNsb25lRGVlcCh2YWx1ZSlcclxuICAgIF92YWx1ZS5mb3JFYWNoKHZhbCA9PiB7XHJcbiAgICAgIGlmICh2YWwuY29udHJvbC5jb250cm9sdHlwZSA9PT0gJ3NpbmdsZS1kYXRlJykge1xyXG4gICAgICAgIHZhbC5jb250cm9sLmlzRHluYW1pY0RhdGUgPSBmYWxzZVxyXG4gICAgICB9IGVsc2UgaWYodmFsLmNvbnRyb2wuY29udHJvbHR5cGUgPT09ICdyYWRpbycpIHtcclxuICAgICAgICB2YWwuY29udHJvbC5ob3Jpem9udGFsID0gdHJ1ZVxyXG4gICAgICB9XHJcbiAgICAgIFxyXG4gICAgfSlcclxuICAgIC8v5bCG5Y2V5pel5pyf6YeM6Z2i55qE5pSv5oyB5Yqo5oCB5pel5pyf5bGe5oCn576k5LiN5pS55Li6ZmFsc2VcclxuICAgIGxldCBtb2RpZnlGaWVsZENvbmZpZyA9IHRoaXMucmFuZ2VUb1NpbXBsZUNvbnRyb2xUeXBlKF92YWx1ZSlcclxuICAgIHRoaXMuX2ZpZWxkQ29uZmlnID0gdGhpcy5zb2x1dGlvblNlcnZpY2UuY29udmVydFRvUXVlcnlDb25kaXRpb25zKG1vZGlmeUZpZWxkQ29uZmlnKTtcclxuICAgIC8v5rOi5bCU6YCJ5oup5o6n5Lu25aaC5p6c5rKh5pyJ6buY6K6k5YC877yM6LWL5YC85L2NZmFsc2XvvIzkuLrku4DkuYjkuI3mlL7lnKjkuIrpnaLjgILlm6DkuLrkuI3mlaLliqjkuYvliY3nmoTmnoTpgKDlh73mlbBcclxuICAgIHRoaXMuX2ZpZWxkQ29uZmlnLmZvckVhY2godmFsID0+IHtcclxuICAgICAgaWYgKHZhbC5jb250cm9sLmdldENvbnRyb2xUeXBlKCkgPT09IDggJiYgIXZhbC52YWx1ZS5nZXRPcmlnaW5hbFZhbHVlKCkubGVuZ3RoKSB7XHJcbiAgICAgICAgdmFsLnZhbHVlLnNldE9yaWdpbmFsVmFsdWUoW2ZhbHNlXSlcclxuICAgICAgfVxyXG4gICAgfSlcclxuICAgIHRoaXMuc3RhdGVTZXIuY2hhbmdlRmllbGRDb25maWcodGhpcy5fZmllbGRDb25maWcpXHJcblxyXG4gIH1cclxuICBfZmllbGRDb25maWc6IEFycmF5PFF1ZXJ5Q29uZGl0aW9uPlxyXG4gIGRhdGFTdWJzY3JpYmU6IFN1YnNjcmlwdGlvbiA9IG51bGxcclxuICBkYXRhTGlzdFN1YnNjcmliZTogU3Vic2NyaXB0aW9uID0gbnVsbFxyXG4gIF9zZWxmID0gbnVsbFxyXG4gIC8v5a2Q57uE5Lu25Y+X5ZCm6ZyA6KaB6ZmQ5a6a5pyA5aSn6auY5bqm77yM6buY6K6kdHJ1ZeaLluWKqOmrmOW6puWQjmZhbHNlXHJcblxyXG4gIGlzTGltaXRIZWlnaHQgPSB0cnVlXHJcbiAgQE91dHB1dCgnY29uZGl0aW9uQ2hhbmdlJykgY29uZGl0aW9uQ2hhbmdlID0gbmV3IEV2ZW50RW1pdHRlcigpO1xyXG5cclxuICBAVmlld0NoaWxkKCdhZHZhbmNlZENvbnRlbnQnKSBhZHZhbmNlZENvbnRlbnQ6IEVsZW1lbnRSZWY7XHJcbiAgQFZpZXdDaGlsZCgnYWR2YW5jZWRFbGVtZW50JykgYWR2YW5jZWRFbGVtZW50OiBFbGVtZW50UmVmO1xyXG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgbm90aWZ5U2VyOiBOb3RpZnlTZXJ2aWNlLCBwcml2YXRlIG1zZ1NlcjogTWVzc2FnZXJTZXJ2aWNlLCBwcml2YXRlIGxvY2FsZVNlcnZpY2U6IExvY2FsZVNlcnZpY2UsIHByaXZhdGUgc29sdXRpb25TZXJ2aWNlOiBTb2x1dGlvblNlcnZpY2UsIHByaXZhdGUgc3RhdGVTZXI6IFN0YXRlU2VydmljZSwgcHJpdmF0ZSBpbmplY3RvcjogSW5qZWN0b3IpIHtcclxuXHJcbiAgICAvLyB0aGlzLmZpZWxkQ29uZmlnID0gdGhpcy5zdGF0ZVNlci5nZXRGaWVsZENvbmZpZygpXHJcbiAgICB0aGlzLmRhdGFTdWJzY3JpYmUgPSB0aGlzLnN0YXRlU2VyLnF1ZXJ5Y29uZGl0aW9uRGF0YSQuc3Vic2NyaWJlKChkYXRhOiBRdWVyeWNvbmRpdGlvbkFkdmFuY2VkRGF0YSkgPT4ge1xyXG4gICAgICB0aGlzLnF1ZXJ5Y29uZGl0aW9uRGF0YSA9IGRhdGFcclxuICAgICAgdGhpcy5zZWxlY3RTb2x1dGlvbi5xdWVyeUNvbmRpdGlvbnNBZHZhbmNlZCA9IGRhdGFcclxuICAgIH0pXHJcbiAgICB0aGlzLmRhdGFMaXN0U3Vic2NyaWJlID0gdGhpcy5zdGF0ZVNlci5xdWVyeWNvbmRpdGlvbkxpc3REYXRhJC5zdWJzY3JpYmUoKHF1ZXJ5Y29uZGl0aW9uTGlzdERhdGE6IEFycmF5PFF1ZXJ5Q29uZGl0aW9uPikgPT4ge1xyXG4gICAgICB0aGlzLmNvbmRpdGlvbkNoYW5nZS5lbWl0KHF1ZXJ5Y29uZGl0aW9uTGlzdERhdGEpO1xyXG5cclxuICAgIH0pXHJcbiAgICB0aGlzLl9zZWxmID0gdGhpcy5pbmplY3Rvci5nZXQoRWxlbWVudFJlZik7XHJcblxyXG4gIH1cclxuXHJcbiAgbmdBZnRlclZpZXdJbml0KCk6IHZvaWQge1xyXG4gICAgLy/nm5HlkKxyZXNpemXkuovku7blj5jljJZcclxuICAgIHNldFRpbWVvdXQoKCk9Pnt0aGlzLmhhbmRsZVJlc2l6ZUNoYW5nZSgpfSwxMDAwKVxyXG4gIH1cclxuXHJcbiAgbmdPbkluaXQoKSB7fVxyXG5cclxuICBuZ09uRGVzdHJveSgpOiB2b2lkIHtcclxuICAgIHRoaXMuZGF0YVN1YnNjcmliZS51bnN1YnNjcmliZSgpXHJcbiAgICB0aGlzLmRhdGFMaXN0U3Vic2NyaWJlLnVuc3Vic2NyaWJlKClcclxuICB9XHJcblxyXG4gIC8v5pyA5aSW5bGC5aKe5Yqg562b6YCJ5p2h5Lu2XHJcbiAgYWRkSXRlbSgpIHtcclxuICAgIGlmICghdGhpcy5maWVsZENvbmZpZy5sZW5ndGgpIHtcclxuICAgICAgdGhpcy5ub3RpZnlTZXIuZXJyb3IoJ+acquajgOa1i+WIsOWtmOWcqOetm+mAieadoeS7tuOAgicpXHJcbiAgICB9IGVsc2Uge1xyXG5cclxuICAgICAgbGV0IGl0ZW0gPSBjbG9uZURlZXAodGhpcy5maWVsZENvbmZpZ1swXSlcclxuICAgICAgdGhpcy5zdGF0ZVNlci5jaGFuZ2VRdWVyeWNvbmRpdGlvbkRhdGEoeyBpdGVtLCBwYXRoOiBbMV0gfSwgJ2FkZCcsIHRydWUpXHJcbiAgICAgIHRoaXMuYWR2YW5jZWRDb250ZW50Lm5hdGl2ZUVsZW1lbnQuc2Nyb2xsVG8oeyB0b3A6IHRoaXMuYWR2YW5jZWRDb250ZW50Lm5hdGl2ZUVsZW1lbnQuc2Nyb2xsSGVpZ2h0IH0pXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvL+WinuWKoOWIhue7hFxyXG4gIGFkZEdyb3VwKCkge1xyXG4gICAgdGhpcy5zdGF0ZVNlci5hZGRHcm91cCgpXHJcbiAgfVxyXG5cclxuICAvL+mHjee9rlxyXG4gIHJlc2V0KCkge1xyXG4gICAgdGhpcy5tc2dTZXIuY29uZmlybSh0aGlzLmxvY2FsZVNlcnZpY2UuZ2V0VmFsdWUoJ2FkdmFuY2VkTW9kZS5pbmZvLnJlc2V0SW5mbycpKS5zdWJzY3JpYmUoKGlzQ29uZmlybSkgPT4ge1xyXG4gICAgICBpZiAoaXNDb25maXJtKSB7XHJcbiAgICAgICAgdGhpcy5zdGF0ZVNlci5yZXNldCgpXHJcbiAgICAgICAgLy/op6blj5Hlm57ovabvvIzov5vooYzmn6Xor6Lmk43kvZxcclxuICAgICAgICBsZXQgZXZlbnQgPSBkb2N1bWVudC5jcmVhdGVFdmVudCgnRXZlbnQnKVxyXG4gICAgICAgIGV2ZW50LmluaXRFdmVudCgna2V5ZG93bicsIHRydWUsIGZhbHNlKVxyXG5cclxuICAgICAgICBldmVudCA9IE9iamVjdC5hc3NpZ24oZXZlbnQsIHtcclxuICAgICAgICAgIGN0cmxLZXk6IGZhbHNlLFxyXG4gICAgICAgICAgbWV0YUtleTogZmFsc2UsXHJcbiAgICAgICAgICBhbHRLZXk6IGZhbHNlLFxyXG4gICAgICAgICAgd2hpY2g6IDEzLFxyXG4gICAgICAgICAga2V5Q29kZTogMTMsXHJcbiAgICAgICAgICBrZXk6ICdFbnRlcicsXHJcbiAgICAgICAgICBjb2RlOiAnRW50ZXInXHJcbiAgICAgICAgfSlcclxuICAgICAgICB0aGlzLl9zZWxmLm5hdGl2ZUVsZW1lbnQuZGlzcGF0Y2hFdmVudChldmVudClcclxuICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gIH1cclxuXHJcblxyXG4gIHJhbmdlVG9TaW1wbGVDb250cm9sVHlwZShjb25maWdzKSB7XHJcbiAgICBsZXQgdW5mb3JtYXRDb25maWdzID0gY2xvbmVEZWVwKGNvbmZpZ3MpXHJcbiAgICB1bmZvcm1hdENvbmZpZ3MuZm9yRWFjaCh2YWwgPT4ge1xyXG4gICAgICBpZiAodmFsLmNvbnRyb2wgJiYgdmFsLmNvbnRyb2wuY29udHJvbHR5cGUpIHtcclxuXHJcbiAgICAgICAgdmFsLmNvbnRyb2wuY29udHJvbHR5cGUgPSB0aGlzLnJhbmdlVG9TaW1wbGVUeXBlTW9kaWZ5KHZhbC5jb250cm9sLmNvbnRyb2x0eXBlKVxyXG4gICAgICB9XHJcblxyXG4gICAgfSlcclxuICAgIHJldHVybiB1bmZvcm1hdENvbmZpZ3NcclxuXHJcbiAgfVxyXG5cclxuICAvL+i9rOWMlumDqOWIhuaOp+S7tuexu+Wei1xyXG4gIHJhbmdlVG9TaW1wbGVUeXBlTW9kaWZ5KGNvbnRyb2xUeXBlKSB7XHJcblxyXG4gICAgbGV0IHJlc3VsdCA9ICcnXHJcbiAgICBzd2l0Y2ggKGNvbnRyb2xUeXBlKSB7XHJcblxyXG4gICAgICBjYXNlICdkYXRlJzpcclxuICAgICAgICByZXN1bHQgPSAnc2luZ2xlLWRhdGUnXHJcbiAgICAgICAgYnJlYWtcclxuICAgICAgY2FzZSAnZGF0ZS10aW1lJzpcclxuICAgICAgICByZXN1bHQgPSAnc2luZ2xlLWRhdGUtdGltZSdcclxuICAgICAgICBicmVha1xyXG4gICAgICBjYXNlICdtb250aCc6XHJcbiAgICAgICAgcmVzdWx0ID0gJ3NpbmdsZS1tb250aCdcclxuICAgICAgICBicmVha1xyXG4gICAgICBjYXNlICdudW1iZXInOlxyXG4gICAgICAgIHJlc3VsdCA9ICdzaW5nbGUtbnVtYmVyJ1xyXG4gICAgICAgIGJyZWFrXHJcbiAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgcmVzdWx0ID0gY29udHJvbFR5cGVcclxuICAgIH1cclxuICAgIHJldHVybiByZXN1bHRcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOebkeWQrOetm+mAieadoeS7tue7hOS7tuWkp+Wwj+WPmOWMlueahOaWueazle+8jOmrmOW6pui2hei/h+aMh+WumuWAvOaXtuWPlua2iOWGhemDqOe7hOS7tuacgOWkp+mrmOW6puWAvOmZkOWItlxyXG4gICAqL1xyXG4gIGhhbmRsZVJlc2l6ZUNoYW5nZSgpIHtcclxuICAgIC8vQHRzLWlnbm9yZVxyXG4gICAgY29uc3QgbXlPYnNlcnZlciA9IG5ldyBSZXNpemVPYnNlcnZlcihlbnRyaWVzID0+IHtcclxuICAgICAgZW50cmllcy5mb3JFYWNoKGVudHJ5ID0+IHtcclxuICAgICAgICBpZihlbnRyeS50YXJnZXQuc3R5bGUuaGVpZ2h0IDwgNDMxICkge1xyXG4gICAgICAgICAgdGhpcy5pc0xpbWl0SGVpZ2h0ID0gdHJ1ZVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICB0aGlzLmlzTGltaXRIZWlnaHQgPSBmYWxzZVxyXG4gICAgICAgIH1cclxuICAgICAgfSlcclxuICAgIH0pXHJcbiAgICBteU9ic2VydmVyLm9ic2VydmUodGhpcy5hZHZhbmNlZEVsZW1lbnQubmF0aXZlRWxlbWVudClcclxuICB9XHJcblxyXG59XHJcbiJdfQ==