/**
 * @fileoverview added by tsickle
 * Generated from: lib/controlcomponent/smarthelp/smarthelp.component.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, Input, Output, EventEmitter, ViewChild } from '@angular/core';
import { SolutionService } from '../../service/solution.service';
import { LookupGridComponent } from '@farris/ui-lookup';
import { of } from 'rxjs';
var SolutionSmartHelpComponent = /** @class */ (function () {
    function SolutionSmartHelpComponent(solutionService) {
        var _this = this;
        this.solutionService = solutionService;
        this.hideLabel = false;
        /**
         * 某个字段发生值变化事件时，需要同步清空的字段，可能不是当前字段
         */
        this.changeFields = [];
        this.conditionChange = new EventEmitter();
        this.mappingEmitter = new EventEmitter();
        this.clearFieldsChange = new EventEmitter();
        /**
         * 每页记录数
         */
        this.pageSize = 20;
        /**
         * 可用分页记录数列表
         */
        this.pageList = [10, 20, 30, 50, 100];
        // 启用多字段查询
        this.enableMultiFieldSearch = false;
        this.onBeforeOpen = (/**
         * @return {?}
         */
        function () {
            /** @type {?} */
            var t = (/** @type {?} */ (_this.item.value));
            if (t && t.value) {
                /** @type {?} */
                var ids = t.value.map((/**
                 * @param {?} n
                 * @return {?}
                 */
                function (n) { return n[_this.idField || 'id']; })).join(',');
                _this.lookup.displayValue = ids;
            }
            _this.clearFieldsChange.emit({
                controlType: ((/** @type {?} */ (_this.item.control))).getControlType(),
                canClearRelatedFields: true
            });
            return of(true);
        });
    }
    /**
     * @return {?}
     */
    SolutionSmartHelpComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this.getSmartHelpBindingInfo();
        //this.testId = this.solutionService.getGuid();
        this.testId = this.instanceId;
        this.placeholder = (this.item.placeHolder) ? (this.item.placeHolder) : (this.item.control.placeholder);
        this.lookup.textChanged.subscribe((/**
         * @param {?} v
         * @return {?}
         */
        function (v) {
            _this.textChangedHandler(v);
        }));
    };
    /**
     * @param {?} changes
     * @return {?}
     */
    SolutionSmartHelpComponent.prototype.ngOnChanges = /**
     * @param {?} changes
     * @return {?}
     */
    function (changes) {
        var _this = this;
        this.getSmartHelpBindingInfo();
        if (changes['changeFields'] && changes['changeFields'].currentValue && !changes['changeFields'].firstChange) {
            /** @type {?} */
            var isChange = changes['changeFields'].currentValue.some((/**
             * @param {?} field
             * @return {?}
             */
            function (field) { return field == _this.item.fieldCode; }));
            if (isChange) {
                this.textValue = ((/** @type {?} */ (this.item.value))).textValue;
            }
        }
    };
    //ITEM：
    //control: SmartHelpContol {uri: "WuLiao.wOrgId", textField: "name", valueField: "code", mapFields: {}, idField: "id"}
    // fieldCode: "wOrgId"
    // fieldName: "所属机构"
    // id: "WuLiao.wOrgId"
    // value: SmartHelpValue {valueField: null, value: null}
    // valueType: 0
    //ITEM：
    //control: SmartHelpContol {uri: "WuLiao.wOrgId", textField: "name", valueField: "code", mapFields: {}, idField: "id"}
    // fieldCode: "wOrgId"
    // fieldName: "所属机构"
    // id: "WuLiao.wOrgId"
    // value: SmartHelpValue {valueField: null, value: null}
    // valueType: 0
    /**
     * @return {?}
     */
    SolutionSmartHelpComponent.prototype.getSmartHelpBindingInfo = 
    //ITEM：
    //control: SmartHelpContol {uri: "WuLiao.wOrgId", textField: "name", valueField: "code", mapFields: {}, idField: "id"}
    // fieldCode: "wOrgId"
    // fieldName: "所属机构"
    // id: "WuLiao.wOrgId"
    // value: SmartHelpValue {valueField: null, value: null}
    // valueType: 0
    /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var smartHelpControl = ((/** @type {?} */ (this.item.control)));
        this.uri = smartHelpControl.uri;
        this.textField = smartHelpControl.textField;
        this.idField = smartHelpControl.idField;
        this.valueField = smartHelpControl.valueField;
        this.displayType = smartHelpControl.displayType;
        this.mapFields = smartHelpControl.mapFields;
        this.context = smartHelpControl.context;
        this.preEventCmd = smartHelpControl.preEventCmd;
        this.postEventCmd = smartHelpControl.postEventCmd;
        this.enableFullTree = smartHelpControl.enableFullTree;
        this.loadTreeDataType = smartHelpControl.loadTreeDataType;
        this.singleSelect = smartHelpControl.singleSelect === false ? false : true;
        this.expandLevel = smartHelpControl.expandLevel;
        this.enableCascade = smartHelpControl.enableCascade;
        this.cascadeStatus = smartHelpControl.cascadeStatus ? smartHelpControl.cascadeStatus : 'enable';
        // 标题
        this.dialogTitle = smartHelpControl.dialogTitle ? smartHelpControl.dialogTitle : '';
        // 宽度
        this.dialogWidth = smartHelpControl.panelWidth;
        // 高度
        this.dialogHeight = smartHelpControl.panelHeight;
        /** @type {?} */
        var smartHelpValue = ((/** @type {?} */ (this.item.value)));
        if (smartHelpValue.textValue == 'help-text-value-null') { //旧数据兼容
            this.textValue = smartHelpValue.getTextValue(this.textField);
        }
        else {
            this.textValue = smartHelpValue.textValue;
        }
        this.nosearch = smartHelpControl.nosearch; //默认false
        this.displayFields = smartHelpControl.displayFields ? smartHelpControl.displayFields : '';
        this.displayTextSeparator = smartHelpControl.displayTextSeparator ? smartHelpControl.displayTextSeparator : '_';
        this.editable = smartHelpControl.editable;
        this.clearFields = smartHelpControl.clearFields;
        if (smartHelpControl.hasOwnProperty('pageSize') && smartHelpControl.pageSize) {
            this.pageSize = smartHelpControl.pageSize;
        }
        if (smartHelpControl.hasOwnProperty('pageList') && smartHelpControl.pageList) {
            this.pageList = smartHelpControl.pageList.split(",").map((/**
             * @param {?} item
             * @return {?}
             */
            function (item) { return parseInt(item); }));
        }
        if (smartHelpControl.hasOwnProperty('quickSelect') && smartHelpControl.quickSelect) {
            this.quickSelect = smartHelpControl.quickSelect;
        }
        if (smartHelpControl.hasOwnProperty('enableMultiFieldSearch') && smartHelpControl.enableMultiFieldSearch) {
            this.enableMultiFieldSearch = smartHelpControl.enableMultiFieldSearch;
        }
    };
    /**
     * @param {?} data
     * @return {?}
     */
    SolutionSmartHelpComponent.prototype.clearData = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        ((/** @type {?} */ (this.item.value))).clearValue();
        if (this.item.control.clear) {
            this.item.control.clear();
        }
        this.conditionChange.emit();
    };
    /**
     * @param {?} field
     * @return {?}
     */
    SolutionSmartHelpComponent.prototype.getConditionItemTitle = /**
     * @param {?} field
     * @return {?}
     */
    function (field) {
        return this.solutionService.getConditionItemTitle(field);
    };
    /**
     * selectedItem
     * code: "code02"
        id: "id02"
        name: "机构02"
        version: "2019-10-21T00:00:00"
    */
    /**
     * selectedItem
     * code: "code02"
     * id: "id02"
     * name: "机构02"
     * version: "2019-10-21T00:00:00"
     * @param {?} data
     * @return {?}
     */
    SolutionSmartHelpComponent.prototype.textChangedHandler = /**
     * selectedItem
     * code: "code02"
     * id: "id02"
     * name: "机构02"
     * version: "2019-10-21T00:00:00"
     * @param {?} data
     * @return {?}
     */
    function (data) {
        if (this.item && this.item.value) {
            /** @type {?} */
            var helpValue = ((/** @type {?} */ (this.item.value)));
            helpValue.value = [data];
            helpValue.textValue = data;
            helpValue.isInputText = true;
            // this.textValue = helpValue.textValue;
            this.conditionChange.emit();
        }
    };
    /**
     * @param {?} selectedItem
     * @return {?}
     */
    SolutionSmartHelpComponent.prototype.selectedDataHandler = /**
     * @param {?} selectedItem
     * @return {?}
     */
    function (selectedItem) {
        //选择时触发
        /** @type {?} */
        var helpValue = ((/** @type {?} */ (this.item.value)));
        helpValue.value = this.singleSelect ? [selectedItem] : selectedItem; //单选返回对象，多选返回数组
        helpValue.valueField = this.valueField;
        helpValue.textValue = this.textValue;
        helpValue.isInputText = false;
        this.conditionChange.emit();
    };
    SolutionSmartHelpComponent.decorators = [
        { type: Component, args: [{
                    selector: 'app-solution-smarthelp',
                    template: "<div class=\"farris-group-wrap\" id=\"{{item.id}}\" >\r\n    <div class=\"form-group farris-form-group common-group\" [ngClass]=\"{'q-state-readonly':item.readonly}\">\r\n        <label class=\"col-form-label\" title=\"{{getConditionItemTitle(item)}}\" *ngIf=\"item && !hideLabel\">\r\n            <span class=\"farris-label-info text-danger\" *ngIf=\"item.control.isRequired()\">*</span>\r\n            <span class=\"farris-label-text\">{{item.fieldName}}</span>\r\n        </label>\r\n        <div class=\"farris-input-wrap\">\r\n            <farris-lookup-grid #lookup\r\n                id=\"{{testId}}\"                \r\n                [clear-fields]=\"clearFields\"\r\n                [uri]=\"uri\"\r\n                [placeholder]=\"placeholder\"\r\n                [(ngModel)]=\"textValue\"\r\n                [textField]=\"textField\"\r\n                [valueField]=\"valueField\"\r\n                [idField]=\"idField\"\r\n                [mapFields]=\"mapFields\"\r\n                [displayType]=\"displayType\"\r\n                [title]=\"dialogTitle\"\r\n                [dialogWidth]=\"dialogWidth\"\r\n                [dialogHeight]=\"dialogHeight\"\r\n                [context]=\"context\"\r\n                [dictPicking]=\"preEventCmd\"\r\n                [dictPicked]=\"postEventCmd\"\r\n                [enableFullTree]=\"enableFullTree\"\r\n                [loadTreeDataType]=\"loadTreeDataType\"\r\n                [singleSelect]=\"singleSelect\"\r\n                [expandLevel]=\"expandLevel\"\r\n                [enableCascade]=\"enableCascade\"\r\n                [cascadeStatus]=\"cascadeStatus\"\r\n                [readonly]=\"item.readonly\"\r\n                [nosearch]=\"nosearch\"\r\n                [beforeOpen]=\"onBeforeOpen\"\r\n                [displayFields]=\"displayFields\"\r\n                [displayTextSeparator]=\"displayTextSeparator\"\r\n                [editable]=\"editable\"\r\n                [pageSize]=\"pageSize\"\r\n                [pageList]=\"pageList\"\r\n                [useFavorite]=\"true\"\r\n                [quickSelect]=\"quickSelect\"\r\n                [enableMultiFieldSearch]=\"enableMultiFieldSearch\"\r\n                (selectedData)=\"selectedDataHandler($event)\"\r\n                (clear)=\"clearData($event)\"\r\n            >\r\n        </farris-lookup-grid>\r\n        <!-- [singleSelect]=\"true\" -->\r\n        </div>\r\n\r\n    </div>\r\n</div>"
                }] }
    ];
    /** @nocollapse */
    SolutionSmartHelpComponent.ctorParameters = function () { return [
        { type: SolutionService }
    ]; };
    SolutionSmartHelpComponent.propDecorators = {
        hideLabel: [{ type: Input }],
        item: [{ type: Input }],
        changeFields: [{ type: Input }],
        instanceId: [{ type: Input }],
        conditionChange: [{ type: Output, args: ['conditionChange',] }],
        mappingEmitter: [{ type: Output, args: ['helpMapping',] }],
        clearFieldsChange: [{ type: Output, args: ['clearFieldsChange',] }],
        lookup: [{ type: ViewChild, args: ['lookup',] }]
    };
    return SolutionSmartHelpComponent;
}());
export { SolutionSmartHelpComponent };
if (false) {
    /** @type {?} */
    SolutionSmartHelpComponent.prototype.hideLabel;
    /**
     * QueryCondition类型
     * @type {?}
     */
    SolutionSmartHelpComponent.prototype.item;
    /**
     * 某个字段发生值变化事件时，需要同步清空的字段，可能不是当前字段
     * @type {?}
     */
    SolutionSmartHelpComponent.prototype.changeFields;
    /** @type {?} */
    SolutionSmartHelpComponent.prototype.instanceId;
    /** @type {?} */
    SolutionSmartHelpComponent.prototype.conditionChange;
    /** @type {?} */
    SolutionSmartHelpComponent.prototype.mappingEmitter;
    /** @type {?} */
    SolutionSmartHelpComponent.prototype.clearFieldsChange;
    /** @type {?} */
    SolutionSmartHelpComponent.prototype.lookup;
    /** @type {?} */
    SolutionSmartHelpComponent.prototype.uri;
    /** @type {?} */
    SolutionSmartHelpComponent.prototype.textField;
    /** @type {?} */
    SolutionSmartHelpComponent.prototype.mapFields;
    /** @type {?} */
    SolutionSmartHelpComponent.prototype.idField;
    /** @type {?} */
    SolutionSmartHelpComponent.prototype.valueField;
    /** @type {?} */
    SolutionSmartHelpComponent.prototype.textValue;
    /** @type {?} */
    SolutionSmartHelpComponent.prototype.displayType;
    /** @type {?} */
    SolutionSmartHelpComponent.prototype.context;
    /** @type {?} */
    SolutionSmartHelpComponent.prototype.preEventCmd;
    /** @type {?} */
    SolutionSmartHelpComponent.prototype.postEventCmd;
    /** @type {?} */
    SolutionSmartHelpComponent.prototype.loadTreeDataType;
    /** @type {?} */
    SolutionSmartHelpComponent.prototype.enableFullTree;
    /** @type {?} */
    SolutionSmartHelpComponent.prototype.singleSelect;
    /** @type {?} */
    SolutionSmartHelpComponent.prototype.expandLevel;
    /** @type {?} */
    SolutionSmartHelpComponent.prototype.enableCascade;
    /** @type {?} */
    SolutionSmartHelpComponent.prototype.cascadeStatus;
    /** @type {?} */
    SolutionSmartHelpComponent.prototype.testId;
    /** @type {?} */
    SolutionSmartHelpComponent.prototype.placeholder;
    /** @type {?} */
    SolutionSmartHelpComponent.prototype.nosearch;
    /** @type {?} */
    SolutionSmartHelpComponent.prototype.displayFields;
    /** @type {?} */
    SolutionSmartHelpComponent.prototype.displayTextSeparator;
    /** @type {?} */
    SolutionSmartHelpComponent.prototype.editable;
    /** @type {?} */
    SolutionSmartHelpComponent.prototype.clearFields;
    /** @type {?} */
    SolutionSmartHelpComponent.prototype.dialogTitle;
    /** @type {?} */
    SolutionSmartHelpComponent.prototype.dialogWidth;
    /** @type {?} */
    SolutionSmartHelpComponent.prototype.dialogHeight;
    /**
     * 每页记录数
     * @type {?}
     */
    SolutionSmartHelpComponent.prototype.pageSize;
    /**
     * 可用分页记录数列表
     * @type {?}
     */
    SolutionSmartHelpComponent.prototype.pageList;
    /** @type {?} */
    SolutionSmartHelpComponent.prototype.quickSelect;
    /** @type {?} */
    SolutionSmartHelpComponent.prototype.enableMultiFieldSearch;
    /** @type {?} */
    SolutionSmartHelpComponent.prototype.onBeforeOpen;
    /**
     * @type {?}
     * @private
     */
    SolutionSmartHelpComponent.prototype.solutionService;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic21hcnRoZWxwLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BmYXJyaXMvY29tcG9uZW50LXF1ZXJ5Y29uZGl0aW9uLyIsInNvdXJjZXMiOlsibGliL2NvbnRyb2xjb21wb25lbnQvc21hcnRoZWxwL3NtYXJ0aGVscC5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQSxPQUFPLEVBQUUsU0FBUyxFQUFFLEtBQUssRUFBcUIsTUFBTSxFQUFFLFlBQVksRUFBWSxTQUFTLEVBQWlCLE1BQU0sZUFBZSxDQUFDO0FBTTlILE9BQU8sRUFBRSxlQUFlLEVBQUUsTUFBTSxnQ0FBZ0MsQ0FBQztBQUNqRSxPQUFPLEVBQUUsbUJBQW1CLEVBQUUsTUFBTSxtQkFBbUIsQ0FBQztBQUN4RCxPQUFPLEVBQUUsRUFBRSxFQUFFLE1BQU0sTUFBTSxDQUFDO0FBRTFCO0lBb0VJLG9DQUFvQixlQUFnQztRQUFwRCxpQkFBeUQ7UUFBckMsb0JBQWUsR0FBZixlQUFlLENBQWlCO1FBN0QzQyxjQUFTLEdBQVcsS0FBSyxDQUFBOzs7O1FBV3pCLGlCQUFZLEdBQWtCLEVBQUUsQ0FBQztRQUlmLG9CQUFlLEdBQUcsSUFBSSxZQUFZLEVBQUUsQ0FBQztRQUV6QyxtQkFBYyxHQUFHLElBQUksWUFBWSxFQUFFLENBQUM7UUFFOUIsc0JBQWlCLEdBQUcsSUFBSSxZQUFZLEVBQUUsQ0FBQzs7OztRQWtDcEUsYUFBUSxHQUFXLEVBQUUsQ0FBQzs7OztRQUV0QixhQUFRLEdBQWtCLENBQUMsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLEdBQUcsQ0FBQyxDQUFDOztRQUloRCwyQkFBc0IsR0FBWSxLQUFLLENBQUM7UUFnRnhDLGlCQUFZOzs7UUFBRzs7Z0JBQ0wsQ0FBQyxHQUFHLG1CQUFBLEtBQUksQ0FBQyxJQUFJLENBQUMsS0FBSyxFQUFrQjtZQUMzQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUMsS0FBSyxFQUFFOztvQkFD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O0lBQ2pCLGtEQUFrQjs7SUFDbEIsc0RBQXlCOztJQUN6QixvREFBd0I7O0lBQ3hCLGtEQUFzQjs7SUFDdEIsaURBQW9COztJQUNwQixtREFBdUI7O0lBQ3ZCLG1EQUFvRDs7SUFDcEQsNENBQWU7O0lBQ2YsaURBQW9COztJQUNwQiw4Q0FBa0I7O0lBQ2xCLG1EQUFzQjs7SUFDdEIsMERBQTZCOztJQUM3Qiw4Q0FBa0I7O0lBQ2xCLGlEQUFvQjs7SUFFcEIsaURBQW9COztJQUVwQixpREFBb0I7O0lBRXBCLGtEQUFxQjs7Ozs7SUFFckIsOENBQXNCOzs7OztJQUV0Qiw4Q0FBZ0Q7O0lBRWhELGlEQUErQjs7SUFFL0IsNERBQXdDOztJQWdGeEMsa0RBV0M7Ozs7O0lBekZXLHFEQUF3QyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbXBvbmVudCwgSW5wdXQsIE9uSW5pdCwgT25DaGFuZ2VzLCBPdXRwdXQsIEV2ZW50RW1pdHRlciwgSW5qZWN0b3IsIFZpZXdDaGlsZCwgU2ltcGxlQ2hhbmdlcyB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBRdWVyeUNvbmRpdGlvbiB9IGZyb20gJy4uLy4uL2VudGl0eS9xdWVyeWNvbmRpdGlvbic7XHJcbmltcG9ydCB7IENvbnRyb2xUeXBlIH0gZnJvbSAnLi4vLi4vZW50aXR5L2NvbnRyb2x0eXBlJztcclxuaW1wb3J0IHsgUXVpY2tTZWxlY3RPcHRpb24sIFNtYXJ0SGVscENvbnRvbCB9IGZyb20gJy4uLy4uL2VudGl0eS9jb250cm9sdHlwZS9zbWFydGhlbHAvc21hcnRoZWxwY29udHJvbCc7XHJcbmltcG9ydCB7IElDb250cm9sIH0gZnJvbSAnLi4vLi4vZW50aXR5L2NvbnRyb2x0eXBlL2ljb250cm9sJztcclxuaW1wb3J0IHsgU21hcnRIZWxwVmFsdWUgfSBmcm9tICcuLi8uLi9lbnRpdHkvY29uZGl0aW9udmFsdWUvc21hcnRoZWxwdmFsdWUnO1xyXG5pbXBvcnQgeyBTb2x1dGlvblNlcnZpY2UgfSBmcm9tICcuLi8uLi9zZXJ2aWNlL3NvbHV0aW9uLnNlcnZpY2UnO1xyXG5pbXBvcnQgeyBMb29rdXBHcmlkQ29tcG9uZW50IH0gZnJvbSAnQGZhcnJpcy91aS1sb29rdXAnO1xyXG5pbXBvcnQgeyBvZiB9IGZyb20gJ3J4anMnO1xyXG5cclxuQENvbXBvbmVudCh7XHJcbiAgICBzZWxlY3RvcjogJ2FwcC1zb2x1dGlvbi1zbWFydGhlbHAnLFxyXG4gICAgdGVtcGxhdGVVcmw6ICcuL3NtYXJ0aGVscC5jb21wb25lbnQuaHRtbCcsXHJcbn0pXHJcblxyXG5leHBvcnQgY2xhc3MgU29sdXRpb25TbWFydEhlbHBDb21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQsIE9uQ2hhbmdlcyB7XHJcblxyXG4gICAgQElucHV0KCkgaGlkZUxhYmVsOmJvb2xlYW4gPSBmYWxzZVxyXG5cclxuXHJcbiAgICAvKipcclxuICAgICAqIFF1ZXJ5Q29uZGl0aW9u57G75Z6LXHJcbiAgICAgKi9cclxuICAgIEBJbnB1dCgpIGl0ZW06IGFueTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIOafkOS4quWtl+auteWPkeeUn+WAvOWPmOWMluS6i+S7tuaXtu+8jOmcgOimgeWQjOatpea4heepuueahOWtl+aute+8jOWPr+iDveS4jeaYr+W9k+WJjeWtl+autVxyXG4gICAgICovXHJcbiAgICBASW5wdXQoKSBjaGFuZ2VGaWVsZHM6IEFycmF5PHN0cmluZz4gPSBbXTtcclxuXHJcbiAgICBASW5wdXQoKSBpbnN0YW5jZUlkOiBzdHJpbmc7XHJcblxyXG4gICAgQE91dHB1dCgnY29uZGl0aW9uQ2hhbmdlJykgY29uZGl0aW9uQ2hhbmdlID0gbmV3IEV2ZW50RW1pdHRlcigpO1xyXG5cclxuICAgIEBPdXRwdXQoJ2hlbHBNYXBwaW5nJykgbWFwcGluZ0VtaXR0ZXIgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XHJcblxyXG4gICAgQE91dHB1dCgnY2xlYXJGaWVsZHNDaGFuZ2UnKSBjbGVhckZpZWxkc0NoYW5nZSA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcclxuXHJcbiAgICBAVmlld0NoaWxkKCdsb29rdXAnKSBsb29rdXA6IExvb2t1cEdyaWRDb21wb25lbnQ7XHJcblxyXG4gICAgdXJpOiBzdHJpbmc7XHJcbiAgICB0ZXh0RmllbGQ6IHN0cmluZztcclxuICAgIG1hcEZpZWxkczogYW55O1xyXG4gICAgaWRGaWVsZDogYW55O1xyXG4gICAgdmFsdWVGaWVsZDogYW55O1xyXG4gICAgdGV4dFZhbHVlOiBhbnk7XHJcbiAgICBkaXNwbGF5VHlwZTogYW55O1xyXG4gICAgY29udGV4dDogYW55O1xyXG4gICAgcHJlRXZlbnRDbWQ6IGFueTtcclxuICAgIHBvc3RFdmVudENtZDogYW55O1xyXG4gICAgbG9hZFRyZWVEYXRhVHlwZTogc3RyaW5nO1xyXG4gICAgZW5hYmxlRnVsbFRyZWU6IGJvb2xlYW47XHJcbiAgICBzaW5nbGVTZWxlY3Q6IGJvb2xlYW47XHJcbiAgICBleHBhbmRMZXZlbDogbnVtYmVyO1xyXG4gICAgZW5hYmxlQ2FzY2FkZTogYm9vbGVhbjtcclxuICAgIGNhc2NhZGVTdGF0dXM6IFwiZW5hYmxlXCIgfCBcInVwXCIgfCBcImRvd25cIiB8IFwiZGlzYWJsZVwiO1xyXG4gICAgdGVzdElkOiBzdHJpbmc7XHJcbiAgICBwbGFjZWhvbGRlcjogc3RyaW5nO1xyXG4gICAgbm9zZWFyY2g6IGJvb2xlYW47XHJcbiAgICBkaXNwbGF5RmllbGRzOiBzdHJpbmc7XHJcbiAgICBkaXNwbGF5VGV4dFNlcGFyYXRvcjogc3RyaW5nO1xyXG4gICAgZWRpdGFibGU6IGJvb2xlYW47XHJcbiAgICBjbGVhckZpZWxkczogc3RyaW5nO1xyXG4gICAgLy8g5qCH6aKYXHJcbiAgICBkaWFsb2dUaXRsZTogc3RyaW5nO1xyXG4gICAgLy8g5a695bqmXHJcbiAgICBkaWFsb2dXaWR0aDogbnVtYmVyO1xyXG4gICAgLy8g6auY5bqmXHJcbiAgICBkaWFsb2dIZWlnaHQ6IG51bWJlcjtcclxuICAgIC8qKiDmr4/pobXorrDlvZXmlbAgKi9cclxuICAgIHBhZ2VTaXplOiBudW1iZXIgPSAyMDtcclxuICAgIC8qKiDlj6/nlKjliIbpobXorrDlvZXmlbDliJfooaggKi9cclxuICAgIHBhZ2VMaXN0OiBBcnJheTxudW1iZXI+ID0gWzEwLCAyMCwgMzAsIDUwLCAxMDBdO1xyXG4gICAgLy8g5b+r5o236YCJ5oup6YWN572uXHJcbiAgICBxdWlja1NlbGVjdDogUXVpY2tTZWxlY3RPcHRpb247XHJcbiAgICAvLyDlkK/nlKjlpJrlrZfmrrXmn6Xor6JcclxuICAgIGVuYWJsZU11bHRpRmllbGRTZWFyY2g6IGJvb2xlYW4gPSBmYWxzZTtcclxuXHJcbiAgICBjb25zdHJ1Y3Rvcihwcml2YXRlIHNvbHV0aW9uU2VydmljZTogU29sdXRpb25TZXJ2aWNlKSB7IH1cclxuXHJcbiAgICBuZ09uSW5pdCgpOiB2b2lkIHtcclxuICAgICAgICB0aGlzLmdldFNtYXJ0SGVscEJpbmRpbmdJbmZvKCk7XHJcbiAgICAgICAgLy90aGlzLnRlc3RJZCA9IHRoaXMuc29sdXRpb25TZXJ2aWNlLmdldEd1aWQoKTtcclxuICAgICAgICB0aGlzLnRlc3RJZCA9IHRoaXMuaW5zdGFuY2VJZDtcclxuICAgICAgICB0aGlzLnBsYWNlaG9sZGVyID0gKHRoaXMuaXRlbS5wbGFjZUhvbGRlcikgPyAodGhpcy5pdGVtLnBsYWNlSG9sZGVyKSA6ICh0aGlzLml0ZW0uY29udHJvbC5wbGFjZWhvbGRlcik7XHJcblxyXG4gICAgICAgIHRoaXMubG9va3VwLnRleHRDaGFuZ2VkLnN1YnNjcmliZSgodikgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLnRleHRDaGFuZ2VkSGFuZGxlcih2KTtcclxuICAgICAgICB9KVxyXG4gICAgfVxyXG5cclxuICAgIG5nT25DaGFuZ2VzKGNoYW5nZXM6IFNpbXBsZUNoYW5nZXMpOiB2b2lkIHtcclxuICAgICAgICB0aGlzLmdldFNtYXJ0SGVscEJpbmRpbmdJbmZvKCk7XHJcbiAgICAgICAgaWYgKGNoYW5nZXNbJ2NoYW5nZUZpZWxkcyddICYmIGNoYW5nZXNbJ2NoYW5nZUZpZWxkcyddLmN1cnJlbnRWYWx1ZSAmJiAhY2hhbmdlc1snY2hhbmdlRmllbGRzJ10uZmlyc3RDaGFuZ2UpIHtcclxuICAgICAgICAgICAgY29uc3QgaXNDaGFuZ2UgPSBjaGFuZ2VzWydjaGFuZ2VGaWVsZHMnXS5jdXJyZW50VmFsdWUuc29tZShmaWVsZCA9PiBmaWVsZCA9PSB0aGlzLml0ZW0uZmllbGRDb2RlKTtcclxuICAgICAgICAgICAgaWYgKGlzQ2hhbmdlKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnRleHRWYWx1ZSA9ICh0aGlzLml0ZW0udmFsdWUgYXMgU21hcnRIZWxwVmFsdWUpLnRleHRWYWx1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvL0lURU3vvJpcclxuICAgIC8vY29udHJvbDogU21hcnRIZWxwQ29udG9sIHt1cmk6IFwiV3VMaWFvLndPcmdJZFwiLCB0ZXh0RmllbGQ6IFwibmFtZVwiLCB2YWx1ZUZpZWxkOiBcImNvZGVcIiwgbWFwRmllbGRzOiB7fSwgaWRGaWVsZDogXCJpZFwifVxyXG4gICAgLy8gZmllbGRDb2RlOiBcIndPcmdJZFwiXHJcbiAgICAvLyBmaWVsZE5hbWU6IFwi5omA5bGe5py65p6EXCJcclxuICAgIC8vIGlkOiBcIld1TGlhby53T3JnSWRcIlxyXG4gICAgLy8gdmFsdWU6IFNtYXJ0SGVscFZhbHVlIHt2YWx1ZUZpZWxkOiBudWxsLCB2YWx1ZTogbnVsbH1cclxuICAgIC8vIHZhbHVlVHlwZTogMFxyXG4gICAgZ2V0U21hcnRIZWxwQmluZGluZ0luZm8oKSB7XHJcbiAgICAgICAgY29uc3Qgc21hcnRIZWxwQ29udHJvbCA9ICh0aGlzLml0ZW0uY29udHJvbCBhcyBTbWFydEhlbHBDb250b2wpO1xyXG4gICAgICAgIHRoaXMudXJpID0gc21hcnRIZWxwQ29udHJvbC51cmk7XHJcbiAgICAgICAgdGhpcy50ZXh0RmllbGQgPSBzbWFydEhlbHBDb250cm9sLnRleHRGaWVsZDtcclxuICAgICAgICB0aGlzLmlkRmllbGQgPSBzbWFydEhlbHBDb250cm9sLmlkRmllbGQ7XHJcbiAgICAgICAgdGhpcy52YWx1ZUZpZWxkID0gc21hcnRIZWxwQ29udHJvbC52YWx1ZUZpZWxkO1xyXG4gICAgICAgIHRoaXMuZGlzcGxheVR5cGUgPSBzbWFydEhlbHBDb250cm9sLmRpc3BsYXlUeXBlO1xyXG4gICAgICAgIHRoaXMubWFwRmllbGRzID0gc21hcnRIZWxwQ29udHJvbC5tYXBGaWVsZHM7XHJcbiAgICAgICAgdGhpcy5jb250ZXh0ID0gc21hcnRIZWxwQ29udHJvbC5jb250ZXh0O1xyXG4gICAgICAgIHRoaXMucHJlRXZlbnRDbWQgPSBzbWFydEhlbHBDb250cm9sLnByZUV2ZW50Q21kO1xyXG4gICAgICAgIHRoaXMucG9zdEV2ZW50Q21kID0gc21hcnRIZWxwQ29udHJvbC5wb3N0RXZlbnRDbWQ7XHJcbiAgICAgICAgdGhpcy5lbmFibGVGdWxsVHJlZSA9IHNtYXJ0SGVscENvbnRyb2wuZW5hYmxlRnVsbFRyZWU7XHJcbiAgICAgICAgdGhpcy5sb2FkVHJlZURhdGFUeXBlID0gc21hcnRIZWxwQ29udHJvbC5sb2FkVHJlZURhdGFUeXBlO1xyXG4gICAgICAgIHRoaXMuc2luZ2xlU2VsZWN0ID0gc21hcnRIZWxwQ29udHJvbC5zaW5nbGVTZWxlY3QgPT09IGZhbHNlID8gZmFsc2UgOiB0cnVlO1xyXG4gICAgICAgIHRoaXMuZXhwYW5kTGV2ZWwgPSBzbWFydEhlbHBDb250cm9sLmV4cGFuZExldmVsO1xyXG4gICAgICAgIHRoaXMuZW5hYmxlQ2FzY2FkZSA9IHNtYXJ0SGVscENvbnRyb2wuZW5hYmxlQ2FzY2FkZTtcclxuICAgICAgICB0aGlzLmNhc2NhZGVTdGF0dXMgPSBzbWFydEhlbHBDb250cm9sLmNhc2NhZGVTdGF0dXMgPyBzbWFydEhlbHBDb250cm9sLmNhc2NhZGVTdGF0dXMgOiAnZW5hYmxlJztcclxuICAgICAgICAvLyDmoIfpophcclxuICAgICAgICB0aGlzLmRpYWxvZ1RpdGxlID0gc21hcnRIZWxwQ29udHJvbC5kaWFsb2dUaXRsZT9zbWFydEhlbHBDb250cm9sLmRpYWxvZ1RpdGxlOicnO1xyXG4gICAgICAgIC8vIOWuveW6plxyXG4gICAgICAgIHRoaXMuZGlhbG9nV2lkdGggPSBzbWFydEhlbHBDb250cm9sLnBhbmVsV2lkdGg7XHJcbiAgICAgICAgLy8g6auY5bqmXHJcbiAgICAgICAgdGhpcy5kaWFsb2dIZWlnaHQgPSBzbWFydEhlbHBDb250cm9sLnBhbmVsSGVpZ2h0O1xyXG4gICAgICAgIGNvbnN0IHNtYXJ0SGVscFZhbHVlID0gKHRoaXMuaXRlbS52YWx1ZSBhcyBTbWFydEhlbHBWYWx1ZSk7XHJcbiAgICAgICAgaWYgKHNtYXJ0SGVscFZhbHVlLnRleHRWYWx1ZSA9PSAnaGVscC10ZXh0LXZhbHVlLW51bGwnKSB7Ly/ml6fmlbDmja7lhbzlrrlcclxuICAgICAgICAgICAgdGhpcy50ZXh0VmFsdWUgPSBzbWFydEhlbHBWYWx1ZS5nZXRUZXh0VmFsdWUodGhpcy50ZXh0RmllbGQpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMudGV4dFZhbHVlID0gc21hcnRIZWxwVmFsdWUudGV4dFZhbHVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLm5vc2VhcmNoID0gc21hcnRIZWxwQ29udHJvbC5ub3NlYXJjaDsvL+m7mOiupGZhbHNlXHJcbiAgICAgICAgdGhpcy5kaXNwbGF5RmllbGRzID0gc21hcnRIZWxwQ29udHJvbC5kaXNwbGF5RmllbGRzID8gc21hcnRIZWxwQ29udHJvbC5kaXNwbGF5RmllbGRzIDogJyc7XHJcbiAgICAgICAgdGhpcy5kaXNwbGF5VGV4dFNlcGFyYXRvciA9IHNtYXJ0SGVscENvbnRyb2wuZGlzcGxheVRleHRTZXBhcmF0b3IgPyBzbWFydEhlbHBDb250cm9sLmRpc3BsYXlUZXh0U2VwYXJhdG9yIDogJ18nO1xyXG4gICAgICAgIHRoaXMuZWRpdGFibGUgPSBzbWFydEhlbHBDb250cm9sLmVkaXRhYmxlO1xyXG4gICAgICAgIHRoaXMuY2xlYXJGaWVsZHMgPSBzbWFydEhlbHBDb250cm9sLmNsZWFyRmllbGRzO1xyXG4gICAgICAgIGlmIChzbWFydEhlbHBDb250cm9sLmhhc093blByb3BlcnR5KCdwYWdlU2l6ZScpICYmIHNtYXJ0SGVscENvbnRyb2wucGFnZVNpemUpIHtcclxuICAgICAgICAgICAgdGhpcy5wYWdlU2l6ZSA9IHNtYXJ0SGVscENvbnRyb2wucGFnZVNpemVcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHNtYXJ0SGVscENvbnRyb2wuaGFzT3duUHJvcGVydHkoJ3BhZ2VMaXN0JykgJiYgc21hcnRIZWxwQ29udHJvbC5wYWdlTGlzdCkge1xyXG4gICAgICAgICAgICB0aGlzLnBhZ2VMaXN0ID0gc21hcnRIZWxwQ29udHJvbC5wYWdlTGlzdC5zcGxpdChcIixcIikubWFwKGl0ZW0gPT4geyByZXR1cm4gcGFyc2VJbnQoaXRlbSk7IH0pXHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChzbWFydEhlbHBDb250cm9sLmhhc093blByb3BlcnR5KCdxdWlja1NlbGVjdCcpICYmIHNtYXJ0SGVscENvbnRyb2wucXVpY2tTZWxlY3QpIHtcclxuICAgICAgICAgICAgdGhpcy5xdWlja1NlbGVjdCA9IHNtYXJ0SGVscENvbnRyb2wucXVpY2tTZWxlY3Q7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChzbWFydEhlbHBDb250cm9sLmhhc093blByb3BlcnR5KCdlbmFibGVNdWx0aUZpZWxkU2VhcmNoJykgJiYgc21hcnRIZWxwQ29udHJvbC5lbmFibGVNdWx0aUZpZWxkU2VhcmNoKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZW5hYmxlTXVsdGlGaWVsZFNlYXJjaCA9IHNtYXJ0SGVscENvbnRyb2wuZW5hYmxlTXVsdGlGaWVsZFNlYXJjaDtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgb25CZWZvcmVPcGVuID0gKCkgPT4ge1xyXG4gICAgICAgIGNvbnN0IHQgPSB0aGlzLml0ZW0udmFsdWUgYXMgU21hcnRIZWxwVmFsdWU7XHJcbiAgICAgICAgaWYgKHQgJiYgdC52YWx1ZSkge1xyXG4gICAgICAgICAgICBjb25zdCBpZHMgPSB0LnZhbHVlLm1hcChuID0+IG5bdGhpcy5pZEZpZWxkIHx8ICdpZCddKS5qb2luKCcsJyk7XHJcbiAgICAgICAgICAgIHRoaXMubG9va3VwLmRpc3BsYXlWYWx1ZSA9IGlkcztcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5jbGVhckZpZWxkc0NoYW5nZS5lbWl0KHtcclxuICAgICAgICAgICAgY29udHJvbFR5cGU6ICh0aGlzLml0ZW0uY29udHJvbCBhcyBTbWFydEhlbHBDb250b2wpLmdldENvbnRyb2xUeXBlKCksXHJcbiAgICAgICAgICAgIGNhbkNsZWFyUmVsYXRlZEZpZWxkczogdHJ1ZVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiBvZih0cnVlKTtcclxuICAgIH1cclxuXHJcbiAgICBjbGVhckRhdGEoZGF0YTogYW55KSB7XHJcbiAgICAgICAgKHRoaXMuaXRlbS52YWx1ZSBhcyBTbWFydEhlbHBWYWx1ZSkuY2xlYXJWYWx1ZSgpO1xyXG4gICAgICAgIGlmICh0aGlzLml0ZW0uY29udHJvbC5jbGVhcikge1xyXG4gICAgICAgICAgICB0aGlzLml0ZW0uY29udHJvbC5jbGVhcigpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmNvbmRpdGlvbkNoYW5nZS5lbWl0KCk7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0Q29uZGl0aW9uSXRlbVRpdGxlKGZpZWxkOiBRdWVyeUNvbmRpdGlvbikge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnNvbHV0aW9uU2VydmljZS5nZXRDb25kaXRpb25JdGVtVGl0bGUoZmllbGQpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogc2VsZWN0ZWRJdGVtXHJcbiAgICAgKiBjb2RlOiBcImNvZGUwMlwiXHJcbiAgICAgICAgaWQ6IFwiaWQwMlwiXHJcbiAgICAgICAgbmFtZTogXCLmnLrmnoQwMlwiXHJcbiAgICAgICAgdmVyc2lvbjogXCIyMDE5LTEwLTIxVDAwOjAwOjAwXCJcclxuICAgICovXHJcbiAgICB0ZXh0Q2hhbmdlZEhhbmRsZXIoZGF0YTogc3RyaW5nKSB7Ly/miYvlt6XovpPlhaXml7bop6blj5FcclxuICAgICAgICBpZiAodGhpcy5pdGVtICYmIHRoaXMuaXRlbS52YWx1ZSkge1xyXG4gICAgICAgICAgICBjb25zdCBoZWxwVmFsdWUgPSAodGhpcy5pdGVtLnZhbHVlIGFzIFNtYXJ0SGVscFZhbHVlKTtcclxuICAgICAgICAgICAgaGVscFZhbHVlLnZhbHVlID0gW2RhdGFdO1xyXG4gICAgICAgICAgICBoZWxwVmFsdWUudGV4dFZhbHVlID0gZGF0YTtcclxuICAgICAgICAgICAgaGVscFZhbHVlLmlzSW5wdXRUZXh0ID0gdHJ1ZTtcclxuICAgICAgICAgICAgLy8gdGhpcy50ZXh0VmFsdWUgPSBoZWxwVmFsdWUudGV4dFZhbHVlO1xyXG4gICAgICAgICAgICB0aGlzLmNvbmRpdGlvbkNoYW5nZS5lbWl0KCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHNlbGVjdGVkRGF0YUhhbmRsZXIoc2VsZWN0ZWRJdGVtOiBhbnkpIHsvL+mAieaLqeaXtuinpuWPkVxyXG4gICAgICAgIGNvbnN0IGhlbHBWYWx1ZSA9ICh0aGlzLml0ZW0udmFsdWUgYXMgU21hcnRIZWxwVmFsdWUpO1xyXG4gICAgICAgIGhlbHBWYWx1ZS52YWx1ZSA9IHRoaXMuc2luZ2xlU2VsZWN0ID8gW3NlbGVjdGVkSXRlbV0gOiBzZWxlY3RlZEl0ZW07Ly/ljZXpgInov5Tlm57lr7nosaHvvIzlpJrpgInov5Tlm57mlbDnu4RcclxuICAgICAgICBoZWxwVmFsdWUudmFsdWVGaWVsZCA9IHRoaXMudmFsdWVGaWVsZDtcclxuICAgICAgICBoZWxwVmFsdWUudGV4dFZhbHVlID0gdGhpcy50ZXh0VmFsdWU7XHJcbiAgICAgICAgaGVscFZhbHVlLmlzSW5wdXRUZXh0ID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5jb25kaXRpb25DaGFuZ2UuZW1pdCgpO1xyXG4gICAgfVxyXG59Il19