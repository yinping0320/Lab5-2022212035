/**
 * @fileoverview added by tsickle
 * Generated from: lib/controlcomponent/dropdown/dropdownlist.component.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, Input, EventEmitter, Output } from '@angular/core';
import { SolutionService } from '../../service/solution.service';
import { DropDownListValue } from '../../entity/conditionvalue/dropdownlistvalue';
var DropDownListComponent = /** @class */ (function () {
    function DropDownListComponent(solutionService) {
        this.solutionService = solutionService;
        this.hideLabel = false;
        /**
         * 某个字段发生值变化事件时，需要同步清空的字段，可能不是当前字段
         */
        this.changeFields = [];
        this.conditionChange = new EventEmitter();
        //下拉列表数据源
        this.dropDownListDataSource = new Array();
        //下拉列表控件内显示文本
        this.selectedItemId = '';
        //是否允许编辑，当通过服务器端api取数时为true
        this.editable = false;
    }
    /**
     * @return {?}
     */
    DropDownListComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this.getDataSource();
        /** @type {?} */
        var initialValue = (/** @type {?} */ (this.item.value));
        initialValue.key && (this.selectedItemId = initialValue.key);
        this.testId = this.solutionService.getGuid();
        this.placeholder = (this.item.placeHolder) ? (this.item.placeHolder) : (this.item.control.placeholder);
        this.beforeShow = ((/** @type {?} */ (this.item.control))).beforeShow;
        this.beforeHide = ((/** @type {?} */ (this.item.control))).beforeHide;
        this.idField = ((/** @type {?} */ (this.item.control))).idField ? ((/** @type {?} */ (this.item.control))).idField : 'value';
        this.textField = ((/** @type {?} */ (this.item.control))).textField ? ((/** @type {?} */ (this.item.control))).textField : 'name';
        if (this.uri) {
            this.selectedItemId = (initialValue.value || []).map((/**
             * @param {?} n
             * @return {?}
             */
            function (n) { return n[_this.textField]; })).join(',');
            this.editable = true;
        }
    };
    /**
     * @param {?} changes
     * @return {?}
     */
    DropDownListComponent.prototype.ngOnChanges = /**
     * @param {?} changes
     * @return {?}
     */
    function (changes) {
        var _this = this;
        this.getDataSource();
        if (changes['changeFields'] && changes['changeFields'].currentValue && !changes['changeFields'].firstChange) {
            /** @type {?} */
            var isChange = changes['changeFields'].currentValue.some((/**
             * @param {?} field
             * @return {?}
             */
            function (field) { return field == _this.item.fieldCode; }));
            if (isChange) {
                this.selectedItemId = ((/** @type {?} */ (this.item.value))).key;
            }
        }
    };
    /**
     * @return {?}
     */
    DropDownListComponent.prototype.getDataSource = /**
     * @return {?}
     */
    function () {
        this.dropDownListDataSource = ((/** @type {?} */ (this.item.control))).enumValues;
        this.uri = ((/** @type {?} */ (this.item.control))).uri;
    };
    /**
     * @param {?} selected
     * @return {?}
     */
    DropDownListComponent.prototype.selectChange = /**
     * @param {?} selected
     * @return {?}
     */
    function (selected) {
        var _this = this;
        /** @type {?} */
        var selectedValue = selected['selections'].map((/**
         * @param {?} selection
         * @return {?}
         */
        function (selection) {
            return {
                value: _this.uri ? selection[_this.textField] : selection[_this.idField],
                name: selection[_this.textField]
            };
        }));
        this.item.value = new DropDownListValue({
            value: selectedValue,
            key: selected['value']
        });
        this.conditionChange.emit();
    };
    /**
     * @param {?} event
     * @return {?}
     */
    DropDownListComponent.prototype.onClear = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        this.item.value = new DropDownListValue();
    };
    /**
     * @param {?} field
     * @return {?}
     */
    DropDownListComponent.prototype.getConditionItemTitle = /**
     * @param {?} field
     * @return {?}
     */
    function (field) {
        return this.solutionService.getConditionItemTitle(field);
    };
    DropDownListComponent.decorators = [
        { type: Component, args: [{
                    selector: 'app-solution-dropdownlist',
                    template: "<div class=\"farris-group-wrap\" id=\"{{item.id}}\">\r\n    <div class=\"form-group farris-form-group  common-group\"  [ngClass]=\"{'q-state-readonly':item.readonly}\">\r\n    <label class=\"col-form-label\" *ngIf=\"item && !hideLabel\" title=\"{{getConditionItemTitle(item)}}\">\r\n      <span class=\"farris-label-info text-danger\" *ngIf=\"item.control.isRequired()\">*</span>\r\n      <span class=\"farris-label-text\">{{item.fieldName}}</span>\r\n    </label>\r\n    <div class=\"farris-input-wrap\">\r\n    <farris-combo-list \r\n        [(ngModel)]=\"selectedItemId\"\r\n        [idField]=\"idField\"\r\n        [valueField]=\"idField\"\r\n        [textField]=\"textField\"\r\n        [editable]=\"editable\"\r\n        [data]=\"dropDownListDataSource\"\r\n        [uri]=\"uri\"\r\n        [beforeShow]=\"beforeShow\"\r\n        [beforeHide]=\"beforeHide\"\r\n        [multiSelect]=\"item.control.multiSelect\"\r\n        [placeholder]=\"placeholder\"\r\n        [panelHeight]=\"item.control.panelHeight ? item.control.panelHeight : 'auto'\"\r\n        (valueChange)=\"selectChange($event)\"\r\n        (clear)=\"onClear($event)\" \r\n        id=\"{{testId}}\"\r\n        [readonly]=\"item.readonly\">\r\n      </farris-combo-list>\r\n    </div>\r\n  </div>\r\n</div>\r\n"
                }] }
    ];
    /** @nocollapse */
    DropDownListComponent.ctorParameters = function () { return [
        { type: SolutionService }
    ]; };
    DropDownListComponent.propDecorators = {
        hideLabel: [{ type: Input }],
        item: [{ type: Input }],
        changeFields: [{ type: Input }],
        conditionChange: [{ type: Output, args: ['conditionChange',] }]
    };
    return DropDownListComponent;
}());
export { DropDownListComponent };
if (false) {
    /** @type {?} */
    DropDownListComponent.prototype.hideLabel;
    /**
     * QueryCondition类型
     * @type {?}
     */
    DropDownListComponent.prototype.item;
    /**
     * 某个字段发生值变化事件时，需要同步清空的字段，可能不是当前字段
     * @type {?}
     */
    DropDownListComponent.prototype.changeFields;
    /** @type {?} */
    DropDownListComponent.prototype.conditionChange;
    /** @type {?} */
    DropDownListComponent.prototype.dropDownListDataSource;
    /** @type {?} */
    DropDownListComponent.prototype.uri;
    /** @type {?} */
    DropDownListComponent.prototype.beforeShow;
    /** @type {?} */
    DropDownListComponent.prototype.beforeHide;
    /** @type {?} */
    DropDownListComponent.prototype.idField;
    /** @type {?} */
    DropDownListComponent.prototype.textField;
    /** @type {?} */
    DropDownListComponent.prototype.selectedItemId;
    /** @type {?} */
    DropDownListComponent.prototype.testId;
    /** @type {?} */
    DropDownListComponent.prototype.placeholder;
    /** @type {?} */
    DropDownListComponent.prototype.editable;
    /**
     * @type {?}
     * @private
     */
    DropDownListComponent.prototype.solutionService;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZHJvcGRvd25saXN0LmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BmYXJyaXMvY29tcG9uZW50LXF1ZXJ5Y29uZGl0aW9uLyIsInNvdXJjZXMiOlsibGliL2NvbnRyb2xjb21wb25lbnQvZHJvcGRvd24vZHJvcGRvd25saXN0LmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7OztBQUFBLE9BQU8sRUFBRSxTQUFTLEVBQUUsS0FBSyxFQUFxQixZQUFZLEVBQUUsTUFBTSxFQUFpQixNQUFNLGVBQWUsQ0FBQztBQVF6RyxPQUFPLEVBQUUsZUFBZSxFQUFFLE1BQU0sZ0NBQWdDLENBQUM7QUFFakUsT0FBTyxFQUFFLGlCQUFpQixFQUFFLE1BQU0sK0NBQStDLENBQUM7QUFFbEY7SUF5Q0ksK0JBQW9CLGVBQWdDO1FBQWhDLG9CQUFlLEdBQWYsZUFBZSxDQUFpQjtRQWxDM0MsY0FBUyxHQUFXLEtBQUssQ0FBQTs7OztRQVN6QixpQkFBWSxHQUFrQixFQUFFLENBQUM7UUFFZixvQkFBZSxHQUFHLElBQUksWUFBWSxFQUFFLENBQUM7O1FBR2hFLDJCQUFzQixHQUFlLElBQUksS0FBSyxFQUFPLENBQUM7O1FBWXRELG1CQUFjLEdBQVEsRUFBRSxDQUFDOztRQU16QixhQUFRLEdBQVksS0FBSyxDQUFDO0lBRTZCLENBQUM7Ozs7SUFFeEQsd0NBQVE7OztJQUFSO1FBQUEsaUJBY0M7UUFiRyxJQUFJLENBQUMsYUFBYSxFQUFFLENBQUM7O1lBQ2YsWUFBWSxHQUFHLG1CQUFBLElBQUksQ0FBQyxJQUFJLENBQUMsS0FBSyxFQUFxQjtRQUN6RCxZQUFZLENBQUMsR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDLGNBQWMsR0FBRyxZQUFZLENBQUMsR0FBRyxDQUFDLENBQUM7UUFDN0QsSUFBSSxDQUFDLE1BQU0sR0FBRyxJQUFJLENBQUMsZUFBZSxDQUFDLE9BQU8sRUFBRSxDQUFDO1FBQzdDLElBQUksQ0FBQyxXQUFXLEdBQUcsQ0FBQyxJQUFJ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Q29udGVudCI6WyJpbXBvcnQgeyBDb21wb25lbnQsIElucHV0LCBPbkluaXQsIE9uQ2hhbmdlcywgRXZlbnRFbWl0dGVyLCBPdXRwdXQsIFNpbXBsZUNoYW5nZXMgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgUXVlcnlDb25kaXRpb24gfSBmcm9tICcuLi8uLi9lbnRpdHkvcXVlcnljb25kaXRpb24nO1xyXG5pbXBvcnQgeyBDb250cm9sVHlwZSB9IGZyb20gJy4uLy4uL2VudGl0eS9jb250cm9sdHlwZSc7XHJcbmltcG9ydCB7IERyb3BEb3duTGlzdENvbnRyb2wgfSBmcm9tICcuLi8uLi9lbnRpdHkvY29udHJvbHR5cGUvZHJvcGRvd25saXN0L2Ryb3Bkb3dubGlzdGNvbnRyb2wnO1xyXG5pbXBvcnQgeyBFbnVtVHlwZSB9IGZyb20gJy4uLy4uL2VudGl0eS9jb250cm9sdHlwZS9kcm9wZG93bmxpc3QvZW51bXR5cGUnO1xyXG5pbXBvcnQgeyBFbnVtSW50ZWdlclZhbHVlIH0gZnJvbSAnLi4vLi4vZW50aXR5L2NvbnRyb2x0eXBlL2Ryb3Bkb3dubGlzdC9pbnRlZ2VyZW51bXZhbHVlJztcclxuaW1wb3J0IHsgRW51bVN0cmluZ1ZhbHVlIH0gZnJvbSAnLi4vLi4vZW50aXR5L2NvbnRyb2x0eXBlL2Ryb3Bkb3dubGlzdC9zdHJpbmdlbnVtdmFsdWUnO1xyXG5pbXBvcnQgeyBFbnVtQm9vbFZhbHVlIH0gZnJvbSAnLi4vLi4vZW50aXR5L2NvbnRyb2x0eXBlL2Ryb3Bkb3dubGlzdC9ib29sZW51bXZhbHVlJztcclxuaW1wb3J0IHsgU29sdXRpb25TZXJ2aWNlIH0gZnJvbSAnLi4vLi4vc2VydmljZS9zb2x1dGlvbi5zZXJ2aWNlJztcclxuaW1wb3J0IHsgSVZhbHVlIH0gZnJvbSAnLi4vLi4vZW50aXR5L2NvbmRpdGlvbnZhbHVlL2l2YWx1ZSc7XHJcbmltcG9ydCB7IERyb3BEb3duTGlzdFZhbHVlIH0gZnJvbSAnLi4vLi4vZW50aXR5L2NvbmRpdGlvbnZhbHVlL2Ryb3Bkb3dubGlzdHZhbHVlJztcclxuXHJcbkBDb21wb25lbnQoe1xyXG4gICAgc2VsZWN0b3I6ICdhcHAtc29sdXRpb24tZHJvcGRvd25saXN0JyxcclxuICAgIHRlbXBsYXRlVXJsOiAnLi9kcm9wZG93bmxpc3QuY29tcG9uZW50Lmh0bWwnLFxyXG59KVxyXG5cclxuZXhwb3J0IGNsYXNzIERyb3BEb3duTGlzdENvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCwgT25DaGFuZ2VzIHtcclxuXHJcbiAgICBASW5wdXQoKSBoaWRlTGFiZWw6Ym9vbGVhbiA9IGZhbHNlXHJcbiAgICAvKipcclxuICAgICAqIFF1ZXJ5Q29uZGl0aW9u57G75Z6LXHJcbiAgICAgKi9cclxuICAgIEBJbnB1dCgpIGl0ZW06IGFueTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIOafkOS4quWtl+auteWPkeeUn+WAvOWPmOWMluS6i+S7tuaXtu+8jOmcgOimgeWQjOatpea4heepuueahOWtl+aute+8jOWPr+iDveS4jeaYr+W9k+WJjeWtl+autVxyXG4gICAgICovXHJcbiAgICBASW5wdXQoKSBjaGFuZ2VGaWVsZHM6IEFycmF5PHN0cmluZz4gPSBbXTtcclxuXHJcbiAgICBAT3V0cHV0KCdjb25kaXRpb25DaGFuZ2UnKSBjb25kaXRpb25DaGFuZ2UgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XHJcblxyXG4gICAgLy/kuIvmi4nliJfooajmlbDmja7mupBcclxuICAgIGRyb3BEb3duTGlzdERhdGFTb3VyY2U6IEFycmF5PGFueT4gPSBuZXcgQXJyYXk8YW55PigpO1xyXG4gICAgLy/mnI3liqHlmajnq69BUEnlnLDlnYBcclxuICAgIHVyaTogc3RyaW5nO1xyXG4gICAgLy/pnaLmnb/mmL7npLrliY3kuovku7ZcclxuICAgIGJlZm9yZVNob3c6IGFueTtcclxuICAgIC8v6Z2i5p2/6ZqQ6JeP5YmN5LqL5Lu2XHJcbiAgICBiZWZvcmVIaWRlOiBhbnk7XHJcbiAgICAvL+aemuS4vuWAvOWtl+autVxyXG4gICAgaWRGaWVsZDogc3RyaW5nO1xyXG4gICAgLy/mnprkuL7lkI3np7DlrZfmrrVcclxuICAgIHRleHRGaWVsZDogc3RyaW5nO1xyXG4gICAgLy/kuIvmi4nliJfooajmjqfku7blhoXmmL7npLrmlofmnKxcclxuICAgIHNlbGVjdGVkSXRlbUlkOiBhbnkgPSAnJztcclxuICAgIC8v57uE5Lu2aWRcclxuICAgIHRlc3RJZDogc3RyaW5nO1xyXG4gICAgLy/ml6fnu5PmnoTkuK1wbGFjZWhvbGRlcuWxnuaAp+WcqGl0ZW0uY29udHJvbOWGhVxyXG4gICAgcGxhY2Vob2xkZXI6IHN0cmluZztcclxuICAgIC8v5piv5ZCm5YWB6K6457yW6L6R77yM5b2T6YCa6L+H5pyN5Yqh5Zmo56uvYXBp5Y+W5pWw5pe25Li6dHJ1ZVxyXG4gICAgZWRpdGFibGU6IGJvb2xlYW4gPSBmYWxzZTtcclxuXHJcbiAgICBjb25zdHJ1Y3Rvcihwcml2YXRlIHNvbHV0aW9uU2VydmljZTogU29sdXRpb25TZXJ2aWNlKSB7fVxyXG5cclxuICAgIG5nT25Jbml0KCk6IHZvaWQge1xyXG4gICAgICAgIHRoaXMuZ2V0RGF0YVNvdXJjZSgpO1xyXG4gICAgICAgIGNvbnN0IGluaXRpYWxWYWx1ZSA9IHRoaXMuaXRlbS52YWx1ZSBhcyBEcm9wRG93bkxpc3RWYWx1ZTtcclxuICAgICAgICBpbml0aWFsVmFsdWUua2V5ICYmICh0aGlzLnNlbGVjdGVkSXRlbUlkID0gaW5pdGlhbFZhbHVlLmtleSk7XHJcbiAgICAgICAgdGhpcy50ZXN0SWQgPSB0aGlzLnNvbHV0aW9uU2VydmljZS5nZXRHdWlkKCk7XHJcbiAgICAgICAgdGhpcy5wbGFjZWhvbGRlciA9ICh0aGlzLml0ZW0ucGxhY2VIb2xkZXIpID8gKHRoaXMuaXRlbS5wbGFjZUhvbGRlcikgOiAodGhpcy5pdGVtLmNvbnRyb2wucGxhY2Vob2xkZXIpO1xyXG4gICAgICAgIHRoaXMuYmVmb3JlU2hvdyA9ICh0aGlzLml0ZW0uY29udHJvbCBhcyBEcm9wRG93bkxpc3RDb250cm9sKS5iZWZvcmVTaG93O1xyXG4gICAgICAgIHRoaXMuYmVmb3JlSGlkZSA9ICh0aGlzLml0ZW0uY29udHJvbCBhcyBEcm9wRG93bkxpc3RDb250cm9sKS5iZWZvcmVIaWRlO1xyXG4gICAgICAgIHRoaXMuaWRGaWVsZCA9ICh0aGlzLml0ZW0uY29udHJvbCBhcyBEcm9wRG93bkxpc3RDb250cm9sKS5pZEZpZWxkID8gKHRoaXMuaXRlbS5jb250cm9sIGFzIERyb3BEb3duTGlzdENvbnRyb2wpLmlkRmllbGQgOiAndmFsdWUnO1xyXG4gICAgICAgIHRoaXMudGV4dEZpZWxkID0gKHRoaXMuaXRlbS5jb250cm9sIGFzIERyb3BEb3duTGlzdENvbnRyb2wpLnRleHRGaWVsZCA/ICh0aGlzLml0ZW0uY29udHJvbCBhcyBEcm9wRG93bkxpc3RDb250cm9sKS50ZXh0RmllbGQgOiAnbmFtZSc7XHJcbiAgICAgICAgaWYodGhpcy51cmkpIHtcclxuICAgICAgICAgICAgdGhpcy5zZWxlY3RlZEl0ZW1JZCA9IChpbml0aWFsVmFsdWUudmFsdWUgfHwgW10pLm1hcChuID0+IG5bdGhpcy50ZXh0RmllbGRdKS5qb2luKCcsJyk7XHJcbiAgICAgICAgICAgIHRoaXMuZWRpdGFibGUgPSB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBuZ09uQ2hhbmdlcyhjaGFuZ2VzOiBTaW1wbGVDaGFuZ2VzKTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy5nZXREYXRhU291cmNlKCk7XHJcbiAgICAgICAgaWYoY2hhbmdlc1snY2hhbmdlRmllbGRzJ10gJiYgY2hhbmdlc1snY2hhbmdlRmllbGRzJ10uY3VycmVudFZhbHVlICYmICFjaGFuZ2VzWydjaGFuZ2VGaWVsZHMnXS5maXJzdENoYW5nZSkge1xyXG4gICAgICAgICAgICBjb25zdCBpc0NoYW5nZSA9IGNoYW5nZXNbJ2NoYW5nZUZpZWxkcyddLmN1cnJlbnRWYWx1ZS5zb21lKGZpZWxkID0+IGZpZWxkID09IHRoaXMuaXRlbS5maWVsZENvZGUpO1xyXG4gICAgICAgICAgICBpZihpc0NoYW5nZSl7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGVkSXRlbUlkID0gKHRoaXMuaXRlbS52YWx1ZSBhcyBEcm9wRG93bkxpc3RWYWx1ZSkua2V5O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGdldERhdGFTb3VyY2UoKSB7XHJcbiAgICAgICAgdGhpcy5kcm9wRG93bkxpc3REYXRhU291cmNlID0gKHRoaXMuaXRlbS5jb250cm9sIGFzIERyb3BEb3duTGlzdENvbnRyb2wpLmVudW1WYWx1ZXM7XHJcbiAgICAgICAgdGhpcy51cmkgPSAodGhpcy5pdGVtLmNvbnRyb2wgYXMgRHJvcERvd25MaXN0Q29udHJvbCkudXJpO1xyXG4gICAgfVxyXG5cclxuICAgIHNlbGVjdENoYW5nZShzZWxlY3RlZDogYW55KSB7XHJcbiAgICAgICAgY29uc3Qgc2VsZWN0ZWRWYWx1ZSA9IHNlbGVjdGVkWydzZWxlY3Rpb25zJ10ubWFwKChzZWxlY3Rpb246IGFueSkgPT4ge1xyXG4gICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgdmFsdWU6IHRoaXMudXJpID8gc2VsZWN0aW9uW3RoaXMudGV4dEZpZWxkXSA6IHNlbGVjdGlvblt0aGlzLmlkRmllbGRdLFxyXG4gICAgICAgICAgICAgICAgbmFtZTogc2VsZWN0aW9uW3RoaXMudGV4dEZpZWxkXVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5pdGVtLnZhbHVlID0gbmV3IERyb3BEb3duTGlzdFZhbHVlKHtcclxuICAgICAgICAgICAgdmFsdWUgOiBzZWxlY3RlZFZhbHVlLFxyXG4gICAgICAgICAgICBrZXkgOiAgc2VsZWN0ZWRbJ3ZhbHVlJ11cclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLmNvbmRpdGlvbkNoYW5nZS5lbWl0KCk7XHJcbiAgICB9XHJcblxyXG4gICAgb25DbGVhcihldmVudDogYW55KSB7XHJcbiAgICAgICAgdGhpcy5pdGVtLnZhbHVlID0gbmV3IERyb3BEb3duTGlzdFZhbHVlKCk7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0Q29uZGl0aW9uSXRlbVRpdGxlKGZpZWxkOlF1ZXJ5Q29uZGl0aW9uKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuc29sdXRpb25TZXJ2aWNlLmdldENvbmRpdGlvbkl0ZW1UaXRsZShmaWVsZCk7XHJcbiAgICB9XHJcbn0iXX0=