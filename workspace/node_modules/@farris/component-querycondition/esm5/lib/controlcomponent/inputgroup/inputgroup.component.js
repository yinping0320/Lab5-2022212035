/**
 * @fileoverview added by tsickle
 * Generated from: lib/controlcomponent/inputgroup/inputgroup.component.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, Input, EventEmitter, Output } from '@angular/core';
import { SolutionService } from '../../service/solution.service';
var InputGroupComponent = /** @class */ (function () {
    function InputGroupComponent(solutionService) {
        this.solutionService = solutionService;
        this.hideLabel = false;
        this.conditionChange = new EventEmitter();
        //控件内显示文本是否为弹窗返回的文本，手动输入或者手动做出修改时为false
        this.isTextFromDialog = false;
    }
    Object.defineProperty(InputGroupComponent.prototype, "item", {
        get: /**
         * @return {?}
         */
        function () {
            return this.constructInputGroupItem(this._inputItem);
        },
        set: /**
         * @param {?} inputGroupItem
         * @return {?}
         */
        function (inputGroupItem) {
            this._inputItem = inputGroupItem;
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @param {?} inputGroupItem
     * @return {?}
     */
    InputGroupComponent.prototype.constructInputGroupItem = /**
     * @param {?} inputGroupItem
     * @return {?}
     */
    function (inputGroupItem) {
        /** @type {?} */
        var inputGroupValueObj = (/** @type {?} */ (inputGroupItem.value));
        // inputGroupValueObj.textValue = inputGroupValueObj.textValue && inputGroupValueObj.textValue.trim();
        inputGroupValueObj.textValue = inputGroupValueObj.textValue && inputGroupValueObj.textValue;
        inputGroupItem.value = inputGroupValueObj;
        return inputGroupItem;
    };
    /**
     * @return {?}
     */
    InputGroupComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        this.testId = this.solutionService.getGuid();
        this.getInputGroupBindingInfo();
    };
    /**
     * @return {?}
     */
    InputGroupComponent.prototype.ngOnDestroy = /**
     * @return {?}
     */
    function () {
        this.item = null;
    };
    /**
     * @return {?}
     */
    InputGroupComponent.prototype.getInputGroupBindingInfo = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var inputGroupControl = ((/** @type {?} */ (this.item.control)));
        this.usageMode = inputGroupControl.usageMode;
        if (this.usageMode == 'open-modal' || this.usageMode == 'open-remote-modal') {
            this.dialogOptions = inputGroupControl.dialogOptions;
            /*
                example of dialogOptions = {
                   modalId: "1e011720-eb0f-4c9c-82b6-6844c89b2303"
                   mapFields: {hDepartment: "Name"}
                   title: "测试标题栏"
                   width: 800
                   height: 600
                }
             */
            if (this.dialogOptions.mapFields) {
                this.textField = JSON.stringify(this.dialogOptions.mapFields).split('"')[1];
            }
        }
    };
    /**
     * @param {?} field
     * @return {?}
     */
    InputGroupComponent.prototype.getConditionItemTitle = /**
     * @param {?} field
     * @return {?}
     */
    function (field) {
        return this.solutionService.getConditionItemTitle(field);
    };
    /**
     * @param {?} event
     * @return {?}
     */
    InputGroupComponent.prototype.onClick = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        var _this = this;
        if (this.usageMode == 'text') {
            this.item.control.click();
        }
        else {
            /** @type {?} */
            var options = this.dialogOptions;
            options.handle = (/**
             * @param {?} selectedItem
             * @return {?}
             */
            function (selectedItem) {
                if (selectedItem && _this.textField) {
                    _this.item.value.value = selectedItem;
                    _this.item.value.textValue = _this.item.value.getTextValue(_this.textField);
                    _this.item.value.textField = _this.textField;
                    _this.item.value.isInputText = false;
                    _this.isTextFromDialog = true;
                    _this.textFormDialog = _this.item.value.textValue;
                    _this.onBlur();
                }
            });
            this.item.control.click({ event: event, options: options });
        }
    };
    /**
     * @return {?}
     */
    InputGroupComponent.prototype.onBlur = /**
     * @return {?}
     */
    function () {
        if (this.usageMode == 'text') {
            this.item.value.isInputText = true;
        }
        if (this.usageMode == 'open-modal' || this.usageMode == 'open-remote-modal') {
            if (!this.isTextFromDialog) {
                //console.log('弹窗模式下控件内文本是手动输入的');
                this.item.value.isInputText = true;
            }
            if (this.item.value.textValue != this.textFormDialog) {
                //console.log('通过弹窗选择的值已被手动修改');
                this.isTextFromDialog = false;
                this.item.value.value = [];
                this.item.value.textField = undefined;
                this.item.value.isInputText = true;
            }
        }
        this.conditionChange.emit();
    };
    /**
     * @return {?}
     */
    InputGroupComponent.prototype.clearData = /**
     * @return {?}
     */
    function () {
        ((/** @type {?} */ (this.item.value))).clearValue();
        this.conditionChange.emit();
    };
    InputGroupComponent.decorators = [
        { type: Component, args: [{
                    selector: 'app-solution-inputgroup',
                    template: "<div class=\"farris-group-wrap\" id=\"{{item.id}}\">\r\n    <div class=\"form-group farris-form-group  common-group\"  [ngClass]=\"{'q-state-readonly':item.readonly}\">\r\n        <label class=\"col-form-label\" *ngIf=\"item && !hideLabel\" title=\"{{getConditionItemTitle(item)}}\">\r\n            <span class=\"farris-label-info text-danger\" *ngIf=\"item.control.isRequired()\">*</span>\r\n            <span class=\"farris-label-text\">{{item.fieldName}}</span>\r\n        </label>\r\n        <div class=\"farris-input-wrap\">\r\n            <input-group \r\n                [(ngModel)]=\"item.value.textValue\" \r\n                name=\"{{item.fieldName}}\" \r\n                id=\"{{testId}}\"\r\n                [groupText]=\"item.control.groupText\"\r\n                [editable]=\"item.control.editable\"\r\n                [placeholder]=\"item.placeHolder\"\r\n                [readonly]=\"item.readonly\"\r\n                (clickHandle)=\"onClick($event)\"\r\n                (blurHandle)=\"onBlur()\"\r\n                (clear)=\"clearData()\">\r\n            </input-group>\r\n        </div>\r\n    </div>\r\n</div>"
                }] }
    ];
    /** @nocollapse */
    InputGroupComponent.ctorParameters = function () { return [
        { type: SolutionService }
    ]; };
    InputGroupComponent.propDecorators = {
        hideLabel: [{ type: Input }],
        item: [{ type: Input }],
        conditionChange: [{ type: Output, args: ['conditionChange',] }]
    };
    return InputGroupComponent;
}());
export { InputGroupComponent };
if (false) {
    /** @type {?} */
    InputGroupComponent.prototype.hideLabel;
    /**
     * QueryCondition类型
     * @type {?}
     */
    InputGroupComponent.prototype._inputItem;
    /** @type {?} */
    InputGroupComponent.prototype.conditionChange;
    /** @type {?} */
    InputGroupComponent.prototype.testId;
    /** @type {?} */
    InputGroupComponent.prototype.usageMode;
    /** @type {?} */
    InputGroupComponent.prototype.dialogOptions;
    /** @type {?} */
    InputGroupComponent.prototype.textField;
    /** @type {?} */
    InputGroupComponent.prototype.isTextFromDialog;
    /** @type {?} */
    InputGroupComponent.prototype.textFormDialog;
    /**
     * @type {?}
     * @private
     */
    InputGroupComponent.prototype.solutionService;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5wdXRncm91cC5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZmFycmlzL2NvbXBvbmVudC1xdWVyeWNvbmRpdGlvbi8iLCJzb3VyY2VzIjpbImxpYi9jb250cm9sY29tcG9uZW50L2lucHV0Z3JvdXAvaW5wdXRncm91cC5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQSxPQUFPLEVBQUUsU0FBUyxFQUFFLEtBQUssRUFBVSxZQUFZLEVBQUUsTUFBTSxFQUFhLE1BQU0sZUFBZSxDQUFDO0FBRTFGLE9BQU8sRUFBRSxlQUFlLEVBQUUsTUFBTSxnQ0FBZ0MsQ0FBQztBQUtqRTtJQTRDSSw2QkFBb0IsZUFBK0I7UUFBL0Isb0JBQWUsR0FBZixlQUFlLENBQWdCO1FBckMxQyxjQUFTLEdBQVcsS0FBSyxDQUFBO1FBZVAsb0JBQWUsR0FBRyxJQUFJLFlBQVksRUFBRSxDQUFDOztRQVVoRSxxQkFBZ0IsR0FBWSxLQUFLLENBQUM7SUFZbUIsQ0FBQztJQTlCdEQsc0JBQ0kscUNBQUk7Ozs7UUFHUjtZQUNJLE9BQU8sSUFBSSxDQUFDLHVCQUF1QixDQUFDLElBQUksQ0FBQyxVQUFVLENBQUMsQ0FBQztRQUN6RCxDQUFDOzs7OztRQU5ELFVBQ1MsY0FBbUI7WUFDeEIsSUFBSSxDQUFDLFVBQVUsR0FBRyxjQUFjLENBQUM7UUFDckMsQ0FBQzs7O09BQUE7Ozs7O0lBbUJELHFEQUF1Qjs7OztJQUF2QixVQUF3QixjQUE4Qjs7WUFDNUMsa0JBQWtCLEdBQUcsbUJBQUEsY0FBYyxDQUFDLEtBQUssRUFBbUI7UUFDbEUsc0dBQXNHO1FBQ3RHLGtCQUFrQixDQUFDLFNBQVMsR0FBRyxrQkFBa0IsQ0FBQyxTQUFTLElBQUksa0JBQWtCLENBQUMsU0FBUyxDQUFDO1FBQzVGLGNBQWMsQ0FBQyxLQUFLLEdBQUcsa0JBQWtCLENBQUM7UUFDMUMsT0FBTyxjQUFjLENBQUM7SUFDMUIsQ0FBQzs7OztJQUlELHNDQUFROzs7SUFBUjtRQUNJ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ImltcG9ydCB7IENvbXBvbmVudCwgSW5wdXQsIE9uSW5pdCwgRXZlbnRFbWl0dGVyLCBPdXRwdXQsIE9uRGVzdHJveSB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBRdWVyeUNvbmRpdGlvbiB9IGZyb20gJy4uLy4uL2VudGl0eS9xdWVyeWNvbmRpdGlvbic7XHJcbmltcG9ydCB7IFNvbHV0aW9uU2VydmljZSB9IGZyb20gJy4uLy4uL3NlcnZpY2Uvc29sdXRpb24uc2VydmljZSc7XHJcbmltcG9ydCB7IElucHV0R3JvdXBDb250cm9sIH0gZnJvbSAnLi4vLi4vZW50aXR5L2NvbnRyb2x0eXBlL2lucHV0LWdyb3VwL2lucHV0Z3JvdXBjb250cm9sJztcclxuaW1wb3J0IHsgSW5wdXRHcm91cFZhbHVlIH0gZnJvbSAnLi4vLi4vZW50aXR5L2NvbmRpdGlvbnZhbHVlL2lucHV0Z3JvdXB2YWx1ZSc7XHJcblxyXG5cclxuQENvbXBvbmVudCh7XHJcbiAgICBzZWxlY3RvcjogJ2FwcC1zb2x1dGlvbi1pbnB1dGdyb3VwJyxcclxuICAgIHRlbXBsYXRlVXJsOiAnLi9pbnB1dGdyb3VwLmNvbXBvbmVudC5odG1sJyxcclxufSlcclxuXHJcbmV4cG9ydCBjbGFzcyBJbnB1dEdyb3VwQ29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0LCBPbkRlc3Ryb3kge1xyXG5cclxuICAgIEBJbnB1dCgpIGhpZGVMYWJlbDpib29sZWFuID0gZmFsc2VcclxuXHJcbiAgICAvKipcclxuICAgICAqIFF1ZXJ5Q29uZGl0aW9u57G75Z6LXHJcbiAgICAgKi9cclxuICAgIF9pbnB1dEl0ZW06IFF1ZXJ5Q29uZGl0aW9uO1xyXG5cclxuICAgIEBJbnB1dCgpXHJcbiAgICBzZXQgaXRlbShpbnB1dEdyb3VwSXRlbTogYW55KSB7XHJcbiAgICAgICAgdGhpcy5faW5wdXRJdGVtID0gaW5wdXRHcm91cEl0ZW07XHJcbiAgICB9XHJcbiAgICBnZXQgaXRlbSgpOiBhbnl7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuY29uc3RydWN0SW5wdXRHcm91cEl0ZW0odGhpcy5faW5wdXRJdGVtKTtcclxuICAgIH1cclxuXHJcbiAgICBAT3V0cHV0KCdjb25kaXRpb25DaGFuZ2UnKSBjb25kaXRpb25DaGFuZ2UgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XHJcbiAgICAvL+e7hOS7tmlkXHJcbiAgICB0ZXN0SWQ6IHN0cmluZztcclxuICAgIC8v5L2/55So5qih5byP77yM5paH5pysdGV4dOaIluiAheW8ueeql29wZW4tbW9kYWxcclxuICAgIHVzYWdlTW9kZTogc3RyaW5nO1xyXG4gICAgLy/lvLnnqpflkb3ku6TpnIDopoHmjqXmlLbnmoTlj4LmlbBcclxuICAgIGRpYWxvZ09wdGlvbnM6IGFueTtcclxuICAgIC8v5by556qX5qih5byP5LiL77yM5Y+W5YiX6KGo5Lit5ZOq5Liq5a2X5q6155qE5YC85pig5bCE5Yiw5b2T5YmN5a2X5q61XHJcbiAgICB0ZXh0RmllbGQ6IHN0cmluZztcclxuICAgIC8v5o6n5Lu25YaF5pi+56S65paH5pys5piv5ZCm5Li65by556qX6L+U5Zue55qE5paH5pys77yM5omL5Yqo6L6T5YWl5oiW6ICF5omL5Yqo5YGa5Ye65L+u5pS55pe25Li6ZmFsc2VcclxuICAgIGlzVGV4dEZyb21EaWFsb2c6IGJvb2xlYW4gPSBmYWxzZTtcclxuICAgIC8v5by556qX6L+U5Zue55qE5paH5pysXHJcbiAgICB0ZXh0Rm9ybURpYWxvZzogc3RyaW5nO1xyXG5cclxuICAgIGNvbnN0cnVjdElucHV0R3JvdXBJdGVtKGlucHV0R3JvdXBJdGVtOiBRdWVyeUNvbmRpdGlvbik6IFF1ZXJ5Q29uZGl0aW9uIHtcclxuICAgICAgICBjb25zdCBpbnB1dEdyb3VwVmFsdWVPYmogPSBpbnB1dEdyb3VwSXRlbS52YWx1ZSBhcyBJbnB1dEdyb3VwVmFsdWU7XHJcbiAgICAgICAgLy8gaW5wdXRHcm91cFZhbHVlT2JqLnRleHRWYWx1ZSA9IGlucHV0R3JvdXBWYWx1ZU9iai50ZXh0VmFsdWUgJiYgaW5wdXRHcm91cFZhbHVlT2JqLnRleHRWYWx1ZS50cmltKCk7XHJcbiAgICAgICAgaW5wdXRHcm91cFZhbHVlT2JqLnRleHRWYWx1ZSA9IGlucHV0R3JvdXBWYWx1ZU9iai50ZXh0VmFsdWUgJiYgaW5wdXRHcm91cFZhbHVlT2JqLnRleHRWYWx1ZTtcclxuICAgICAgICBpbnB1dEdyb3VwSXRlbS52YWx1ZSA9IGlucHV0R3JvdXBWYWx1ZU9iajtcclxuICAgICAgICByZXR1cm4gaW5wdXRHcm91cEl0ZW07XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3RydWN0b3IocHJpdmF0ZSBzb2x1dGlvblNlcnZpY2U6U29sdXRpb25TZXJ2aWNlKXt9XHJcblxyXG4gICAgbmdPbkluaXQoKTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy50ZXN0SWQgPSB0aGlzLnNvbHV0aW9uU2VydmljZS5nZXRHdWlkKCk7XHJcbiAgICAgICAgdGhpcy5nZXRJbnB1dEdyb3VwQmluZGluZ0luZm8oKTtcclxuICAgIH1cclxuXHJcbiAgICBuZ09uRGVzdHJveSgpOiB2b2lkIHtcclxuICAgICAgICB0aGlzLml0ZW0gPSBudWxsO1xyXG4gICAgfVxyXG5cclxuICAgIGdldElucHV0R3JvdXBCaW5kaW5nSW5mbygpIHtcclxuICAgICAgICBjb25zdCBpbnB1dEdyb3VwQ29udHJvbCA9ICh0aGlzLml0ZW0uY29udHJvbCBhcyBJbnB1dEdyb3VwQ29udHJvbCk7XHJcbiAgICAgICAgdGhpcy51c2FnZU1vZGUgPSBpbnB1dEdyb3VwQ29udHJvbC51c2FnZU1vZGU7XHJcbiAgICAgICAgaWYodGhpcy51c2FnZU1vZGUgPT0gJ29wZW4tbW9kYWwnfHx0aGlzLnVzYWdlTW9kZSA9PSAnb3Blbi1yZW1vdGUtbW9kYWwnKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZGlhbG9nT3B0aW9ucyA9IGlucHV0R3JvdXBDb250cm9sLmRpYWxvZ09wdGlvbnM7XHJcbiAgICAgICAgICAgIC8qXHJcbiAgICAgICAgICAgICAgICBleGFtcGxlIG9mIGRpYWxvZ09wdGlvbnMgPSB7XHJcbiAgICAgICAgICAgICAgICAgICBtb2RhbElkOiBcIjFlMDExNzIwLWViMGYtNGM5Yy04MmI2LTY4NDRjODliMjMwM1wiXHJcbiAgICAgICAgICAgICAgICAgICBtYXBGaWVsZHM6IHtoRGVwYXJ0bWVudDogXCJOYW1lXCJ9XHJcbiAgICAgICAgICAgICAgICAgICB0aXRsZTogXCLmtYvor5XmoIfpopjmoI9cIlxyXG4gICAgICAgICAgICAgICAgICAgd2lkdGg6IDgwMFxyXG4gICAgICAgICAgICAgICAgICAgaGVpZ2h0OiA2MDBcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICovXHJcbiAgICAgICAgICAgIGlmKHRoaXMuZGlhbG9nT3B0aW9ucy5tYXBGaWVsZHMpe1xyXG4gICAgICAgICAgICAgICAgdGhpcy50ZXh0RmllbGQgPSBKU09OLnN0cmluZ2lmeSh0aGlzLmRpYWxvZ09wdGlvbnMubWFwRmllbGRzKS5zcGxpdCgnXCInKVsxXTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBnZXRDb25kaXRpb25JdGVtVGl0bGUoZmllbGQ6UXVlcnlDb25kaXRpb24pe1xyXG4gICAgICAgIHJldHVybiB0aGlzLnNvbHV0aW9uU2VydmljZS5nZXRDb25kaXRpb25JdGVtVGl0bGUoZmllbGQpO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBvbkNsaWNrKGV2ZW50OiBhbnkpe1xyXG4gICAgICAgIGlmKHRoaXMudXNhZ2VNb2RlID09ICd0ZXh0Jyl7XHJcbiAgICAgICAgICAgIHRoaXMuaXRlbS5jb250cm9sLmNsaWNrKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2V7XHJcbiAgICAgICAgICAgIGNvbnN0IG9wdGlvbnMgPSB0aGlzLmRpYWxvZ09wdGlvbnM7XHJcbiAgICAgICAgICAgIG9wdGlvbnMuaGFuZGxlID0gKHNlbGVjdGVkSXRlbSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYoc2VsZWN0ZWRJdGVtICYmIHRoaXMudGV4dEZpZWxkKXtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLml0ZW0udmFsdWUudmFsdWUgPSBzZWxlY3RlZEl0ZW07XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5pdGVtLnZhbHVlLnRleHRWYWx1ZSA9IHRoaXMuaXRlbS52YWx1ZS5nZXRUZXh0VmFsdWUodGhpcy50ZXh0RmllbGQpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaXRlbS52YWx1ZS50ZXh0RmllbGQgPSB0aGlzLnRleHRGaWVsZDtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLml0ZW0udmFsdWUuaXNJbnB1dFRleHQgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5pc1RleHRGcm9tRGlhbG9nID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnRleHRGb3JtRGlhbG9nID0gdGhpcy5pdGVtLnZhbHVlLnRleHRWYWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLm9uQmx1cigpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMuaXRlbS5jb250cm9sLmNsaWNrKHtldmVudCwgb3B0aW9uc30pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBvbkJsdXIoKXtcclxuICAgICAgICBpZih0aGlzLnVzYWdlTW9kZSA9PSAndGV4dCcpIHtcclxuICAgICAgICAgICAgdGhpcy5pdGVtLnZhbHVlLmlzSW5wdXRUZXh0ID0gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYodGhpcy51c2FnZU1vZGUgPT0gJ29wZW4tbW9kYWwnfHx0aGlzLnVzYWdlTW9kZSA9PSAnb3Blbi1yZW1vdGUtbW9kYWwnKSB7XHJcbiAgICAgICAgICAgIGlmKCF0aGlzLmlzVGV4dEZyb21EaWFsb2cpIHtcclxuICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coJ+W8ueeql+aooeW8j+S4i+aOp+S7tuWGheaWh+acrOaYr+aJi+WKqOi+k+WFpeeahCcpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5pdGVtLnZhbHVlLmlzSW5wdXRUZXh0ID0gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZih0aGlzLml0ZW0udmFsdWUudGV4dFZhbHVlICE9IHRoaXMudGV4dEZvcm1EaWFsb2cpe1xyXG4gICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZygn6YCa6L+H5by556qX6YCJ5oup55qE5YC85bey6KKr5omL5Yqo5L+u5pS5Jyk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmlzVGV4dEZyb21EaWFsb2cgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIHRoaXMuaXRlbS52YWx1ZS52YWx1ZSA9IFtdO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5pdGVtLnZhbHVlLnRleHRGaWVsZCA9IHVuZGVmaW5lZDtcclxuICAgICAgICAgICAgICAgIHRoaXMuaXRlbS52YWx1ZS5pc0lucHV0VGV4dCA9IHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5jb25kaXRpb25DaGFuZ2UuZW1pdCgpO1xyXG4gICAgfVxyXG5cclxuICAgIGNsZWFyRGF0YSgpIHtcclxuICAgICAgICAodGhpcy5pdGVtLnZhbHVlIGFzIElucHV0R3JvdXBWYWx1ZSkuY2xlYXJWYWx1ZSgpO1xyXG4gICAgICAgIHRoaXMuY29uZGl0aW9uQ2hhbmdlLmVtaXQoKTtcclxuICAgIH1cclxufSJdfQ==