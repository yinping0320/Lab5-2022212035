/**
 * @fileoverview added by tsickle
 * Generated from: lib/entity/querysolutionvo.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
import { QueryConditionConvert } from "./querycondition";
import { cloneDeep } from 'lodash-es';
/**
 * 查询方案实体类
 */
var /**
 * 查询方案实体类
 */
QuerySolutionVo = /** @class */ (function () {
    function QuerySolutionVo() {
        /**
         * 是否默认查询方案
         * 初始时，为false
         */
        this.isDefault = false;
        this.isChanged = false;
        this.extendId = 'query-scheme-1';
    }
    return QuerySolutionVo;
}());
/**
 * 查询方案实体类
 */
export { QuerySolutionVo };
if (false) {
    /**
     * 唯一性标识
     * @type {?}
     */
    QuerySolutionVo.prototype.id;
    /**
     * 所属ID，例如所属表单ID
     * @type {?}
     */
    QuerySolutionVo.prototype.belongId;
    /**
     * 查询方案编号
     * @type {?}
     */
    QuerySolutionVo.prototype.code;
    /**
     * 查询方案名称
     * @type {?}
     */
    QuerySolutionVo.prototype.name;
    /**
     * 查询条件
     * @type {?}
     */
    QuerySolutionVo.prototype.queryConditions;
    /**
     * 是否系统预置查询方案
     * @type {?}
     */
    QuerySolutionVo.prototype.isSystem;
    /**
     * 是否默认查询方案
     * 初始时，为false
     * @type {?}
     */
    QuerySolutionVo.prototype.isDefault;
    /** @type {?} */
    QuerySolutionVo.prototype.isChanged;
    /**
     * 类型： pre是上次查询
     * @type {?}
     */
    QuerySolutionVo.prototype.type;
    /** @type {?} */
    QuerySolutionVo.prototype.extendId;
    /** @type {?} */
    QuerySolutionVo.prototype.extendInfo;
    /** @type {?} */
    QuerySolutionVo.prototype.code_chs;
    /** @type {?} */
    QuerySolutionVo.prototype.code_en;
    /** @type {?} */
    QuerySolutionVo.prototype.code_cht;
    /**
     * 高级模式新增字段，1为标准模式，2为高级模式
     * @type {?}
     */
    QuerySolutionVo.prototype.mode;
    /**
     * 高级模式新增辅助字段，用来展示condition的树结构
     * @type {?}
     */
    QuerySolutionVo.prototype.queryConditionsAdvanced;
}
/**
 * 查询方案实体类序列化与反序列化器
 */
var /**
 * 查询方案实体类序列化与反序列化器
 */
QuerySolutionVoConvertor = /** @class */ (function () {
    function QuerySolutionVoConvertor() {
    }
    /**
     * 序列化
     * @param obj 查询方案实体
     */
    /**
     * 序列化
     * @param {?} obj 查询方案实体
     * @return {?}
     */
    QuerySolutionVoConvertor.prototype.convertJObject = /**
     * 序列化
     * @param {?} obj 查询方案实体
     * @return {?}
     */
    function (obj) {
        /** @type {?} */
        var querySolutionVo = (/** @type {?} */ (obj));
        /** @type {?} */
        var jobj = new Object();
        jobj["id"] = querySolutionVo.id;
        jobj["belongId"] = querySolutionVo.belongId;
        jobj["code"] = querySolutionVo.code;
        jobj["name"] = querySolutionVo.name;
        jobj["isSystem"] = querySolutionVo.isSystem;
        jobj["isDefault"] = querySolutionVo.isDefault;
        jobj["type"] = querySolutionVo.type;
        jobj["extendId"] = querySolutionVo.extendId;
        jobj["extendInfo"] = querySolutionVo.extendInfo;
        jobj["code_chs"] = querySolutionVo.code_chs;
        jobj["code_en"] = querySolutionVo.code_en;
        jobj["code_cht"] = querySolutionVo.code_cht;
        jobj["mode"] = querySolutionVo.mode || '1';
        //针对树数据中做简化处理，仅保留对应条件的conditionid
        if (querySolutionVo.mode === '2') {
            // let _queryConditionsAdvanced = querySolutionVo.queryConditionsAdvanced
            // let _advancedFlatConditions = this.getFlatConditions(_queryConditionsAdvanced)
            // _advancedFlatConditions.forEach(val => val.conditionid = val.conditionid *2)
            /** @type {?} */
            var _queryConditionsAdvanced = this.simplifyTreeData(cloneDeep(querySolutionVo.queryConditionsAdvanced));
            jobj["advancedQueryConditionsString"] = JSON.stringify(_queryConditionsAdvanced);
        }
        if (querySolutionVo.queryConditions && querySolutionVo.queryConditions.length > 0) {
            /** @type {?} */
            var jArray_1 = [];
            /** @type {?} */
            var convertor_1 = new QueryConditionConvert();
            querySolutionVo.queryConditions.forEach((/**
             * @param {?} element
             * @return {?}
             */
            function (element) {
                jArray_1.push(convertor_1.convertJObject(element));
            }));
            //向服务端发送数据时，发送query condition list的json string
            jobj["queryConditionString"] = JSON.stringify(jArray_1);
        }
        return jobj;
    };
    /**
     * 反序列化(初始化)
     * @param jobj 查询方案序列化后的Object
     */
    /**
     * 反序列化(初始化)
     * @param {?} jobj 查询方案序列化后的Object
     * @return {?}
     */
    QuerySolutionVoConvertor.prototype.initFromJobject = /**
     * 反序列化(初始化)
     * @param {?} jobj 查询方案序列化后的Object
     * @return {?}
     */
    function (jobj) {
        /** @type {?} */
        var querySolutionVo = new QuerySolutionVo();
        querySolutionVo.id = jobj["id"];
        querySolutionVo.code = jobj["code"];
        querySolutionVo.name = jobj["name"];
        querySolutionVo.belongId = jobj["belongId"];
        querySolutionVo.isSystem = jobj["isSystem"];
        querySolutionVo.isDefault = jobj["isDefault"];
        querySolutionVo.type = jobj.hasOwnProperty('type') ? jobj["type"] : '';
        querySolutionVo.extendId = jobj.hasOwnProperty('extendId') ? jobj["extendId"] : "";
        querySolutionVo.queryConditions = new Array();
        //高级模式新增mode,1为传统模式，2为高级模式
        querySolutionVo.mode = jobj["mode"] || 1;
        //服务器端返回的query condition list实际是 json string
        /** @type {?} */
        var queryConditionString = jobj["queryConditionString"];
        if (queryConditionString) {
            /** @type {?} */
            var conditionJarry = JSON.parse(queryConditionString);
            /** @type {?} */
            var convertor_2 = new QueryConditionConvert();
            conditionJarry.forEach((/**
             * @param {?} element
             * @return {?}
             */
            function (element) {
                querySolutionVo.queryConditions.push(convertor_2.initFromJobject(element));
            }));
        }
        querySolutionVo.queryConditionsAdvanced = jobj["advancedQueryConditionsString"] ? JSON.parse(jobj["advancedQueryConditionsString"]) : null;
        return querySolutionVo;
    };
    /**
     * 从缓存中取回的JSON数据需要转化
     * 从大写转换到小写条件
     */
    /**
     * 从缓存中取回的JSON数据需要转化
     * 从大写转换到小写条件
     * @param {?} jobj
     * @return {?}
     */
    QuerySolutionVoConvertor.prototype.formatFromJobject = /**
     * 从缓存中取回的JSON数据需要转化
     * 从大写转换到小写条件
     * @param {?} jobj
     * @return {?}
     */
    function (jobj) {
        /** @type {?} */
        var queryConditions = new Array();
        /** @type {?} */
        var conditionJarry;
        if (typeof jobj == 'string') {
            conditionJarry = JSON.parse(jobj);
        }
        else {
            conditionJarry = jobj;
        }
        /** @type {?} */
        var convertor = new QueryConditionConvert();
        conditionJarry.forEach((/**
         * @param {?} element
         * @return {?}
         */
        function (element) {
            queryConditions.push(convertor.initFromJobject(element));
        }));
        return queryConditions;
    };
    /**
     * 存入缓存中
     * 从大写转换到小写条件
     */
    /**
     * 存入缓存中
     * 从大写转换到小写条件
     * @param {?} jobj
     * @return {?}
     */
    QuerySolutionVoConvertor.prototype.formatConvertJObject = /**
     * 存入缓存中
     * 从大写转换到小写条件
     * @param {?} jobj
     * @return {?}
     */
    function (jobj) {
        /** @type {?} */
        var queryConditions = [];
        /** @type {?} */
        var convertor = new QueryConditionConvert();
        jobj.forEach((/**
         * @param {?} element
         * @return {?}
         */
        function (element) {
            queryConditions.push(convertor.convertJObject(element));
        }));
        return queryConditions;
    };
    /**
     * 将高级模式下树结构condition扁平化
     * @param data
     * @returns
     */
    /**
     * 将高级模式下树结构condition扁平化
     * @param {?} data
     * @return {?}
     */
    QuerySolutionVoConvertor.prototype.getFlatConditions = /**
     * 将高级模式下树结构condition扁平化
     * @param {?} data
     * @return {?}
     */
    function (data) {
        var _this = this;
        if (data.children) {
            return [].concat.apply([], tslib_1.__spread([data.items], data.children.map((/**
             * @param {?} val
             * @return {?}
             */
            function (val) { return _this.getFlatConditions(val); }))));
        }
        return [].concat(data.items);
    };
    /**
     * @param {?} data
     * @return {?}
     */
    QuerySolutionVoConvertor.prototype.simplifyTreeData = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        var _this = this;
        if (data.items && data.items.length) {
            /** @type {?} */
            var _items = data.items.map((/**
             * @param {?} val
             * @return {?}
             */
            function (val) { return { conditionid: val.conditionid }; }));
            data.items = _items;
        }
        if (data.children) {
            data.children.forEach((/**
             * @param {?} val
             * @return {?}
             */
            function (val) { return _this.simplifyTreeData(val); }));
        }
        return data;
    };
    /**
     * @param {?} originData
     * @param {?} conditionList
     * @return {?}
     */
    QuerySolutionVoConvertor.prototype.complicateTreeData = /**
     * @param {?} originData
     * @param {?} conditionList
     * @return {?}
     */
    function (originData, conditionList) {
        /** @type {?} */
        var handleFunc = (/**
         * @param {?} treeData
         * @return {?}
         */
        function (treeData) {
            if (treeData.items && treeData.items.length) {
                treeData.items = treeData.items.map((/**
                 * @param {?} val
                 * @return {?}
                 */
                function (val) {
                    /** @type {?} */
                    var target = conditionList.find((/**
                     * @param {?} item
                     * @return {?}
                     */
                    function (item) { return item.conditionid === val.conditionid; }));
                    if (target) {
                        /** @type {?} */
                        var result = cloneDeep(target);
                        result.groupid = undefined;
                        result.Lbracket = undefined;
                        result.Rbracket = undefined;
                        return result;
                    }
                    return null;
                }));
            }
            if (treeData.children && treeData.children.length) {
                treeData.children.forEach((/**
                 * @param {?} val
                 * @return {?}
                 */
                function (val) {
                    handleFunc(val);
                }));
            }
            //仅供返回顶层数据，遍历过程使用不到
            return treeData;
        });
        return handleFunc(originData);
    };
    return QuerySolutionVoConvertor;
}());
/**
 * 查询方案实体类序列化与反序列化器
 */
export { QuerySolutionVoConvertor };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicXVlcnlzb2x1dGlvbnZvLmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGZhcnJpcy9jb21wb25lbnQtcXVlcnljb25kaXRpb24vIiwic291cmNlcyI6WyJsaWIvZW50aXR5L3F1ZXJ5c29sdXRpb252by50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxPQUFPLEVBQWtCLHFCQUFxQixFQUFFLE1BQU0sa0JBQWtCLENBQUM7QUFHekUsT0FBTyxFQUFFLFNBQVMsRUFBRSxNQUFNLFdBQVcsQ0FBQzs7OztBQUl0Qzs7OztJQUFBOzs7OztRQW1DSSxjQUFTLEdBQVksS0FBSyxDQUFDO1FBRTNCLGNBQVMsR0FBWSxLQUFLLENBQUM7UUFNM0IsYUFBUSxHQUFXLGdCQUFnQixDQUFDO0lBaUJ4QyxDQUFDO0lBQUQsc0JBQUM7QUFBRCxDQUFDLEFBNURELElBNERDOzs7Ozs7Ozs7O0lBeERHLDZCQUFXOzs7OztJQUtYLG1DQUFpQjs7Ozs7SUFLakIsK0JBQWE7Ozs7O0lBS2IsK0JBQWE7Ozs7O0lBS2IsMENBQXVDOzs7OztJQUt2QyxtQ0FBa0I7Ozs7OztJQU1sQixvQ0FBMkI7O0lBRTNCLG9DQUEyQjs7Ozs7SUFJM0IsK0JBQWE7O0lBRWIsbUNBQW9DOztJQUVwQyxxQ0FBeUM7O0lBRXpDLG1DQUFpQjs7SUFFakIsa0NBQWdCOztJQUVoQixtQ0FBaUI7Ozs7O0lBSWpCLCtCQUFhOzs7OztJQUliLGtEQUFvRDs7Ozs7QUFNeEQ7Ozs7SUFBQTtJQTZKQSxDQUFDO0lBM0pHOzs7T0FHRzs7Ozs7O0lBQ0gsaURBQWM7Ozs7O0lBQWQsVUFBZSxHQUFvQjs7WUFDM0IsZUFBZSxHQUFHLG1CQUFBLEdBQUcsRUFBbUI7O1lBQ3hDLElBQUksR0FBRyxJQUFJLE1BQU0sRUFBRTtRQUN2QixJQUFJLENBQUMsSUFBSSxDQUFDLEdBQUcsZUFBZSxDQUFDLEVBQUUsQ0FBQztRQUNoQyxJQUFJLENBQUMsVUFBVSxDQUFDLEdBQUcsZUFBZSxDQUFDLFFBQVEsQ0FBQztRQUM1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LFVBQUEsR0FBRztvQkFDekIsVUFBVSxDQUFDLEdBQUcsQ0FBQyxDQUFBO2dCQUNuQixDQUFDLEVBQUMsQ0FBQTthQUNMO1lBQ0QsbUJBQW1CO1lBQ25CLE9BQU8sUUFBUSxDQUFBO1FBQ25CLENBQUMsQ0FBQTtRQUNELE9BQU8sVUFBVSxDQUFDLFVBQVUsQ0FBQyxDQUFBO0lBRWpDLENBQUM7SUFDTCwrQkFBQztBQUFELENBQUMsQUE3SkQsSUE2SkMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBRdWVyeUNvbmRpdGlvbiwgUXVlcnlDb25kaXRpb25Db252ZXJ0IH0gZnJvbSBcIi4vcXVlcnljb25kaXRpb25cIjtcclxuaW1wb3J0IHsgUXVlcnlTb2x1dGlvbkV4dGVuZFZvIH0gZnJvbSAnLi9xdWVyeXNvbHV0aW9uZXh0ZW5kdm8nO1xyXG5pbXBvcnQge1F1ZXJ5Y29uZGl0aW9uQWR2YW5jZWREYXRhfSBmcm9tICcuLi9xdWVyeWNvbmRpdGlvbi1hZHZhbmNlZC90eXBlL3R5cGUnXHJcbmltcG9ydCB7IGNsb25lRGVlcCB9IGZyb20gJ2xvZGFzaC1lcyc7XHJcbi8qKlxyXG4gKiDmn6Xor6LmlrnmoYjlrp7kvZPnsbsgXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgUXVlcnlTb2x1dGlvblZvIHtcclxuICAgIC8qKlxyXG4gICAgICog5ZSv5LiA5oCn5qCH6K+GXHJcbiAgICAgKi9cclxuICAgIGlkOiBzdHJpbmc7XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDmiYDlsZ5JRO+8jOS+i+WmguaJgOWxnuihqOWNlUlEXHJcbiAgICAgKi9cclxuICAgIGJlbG9uZ0lkOiBzdHJpbmc7XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDmn6Xor6LmlrnmoYjnvJblj7dcclxuICAgICAqL1xyXG4gICAgY29kZTogc3RyaW5nO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICog5p+l6K+i5pa55qGI5ZCN56ewXHJcbiAgICAgKi9cclxuICAgIG5hbWU6IHN0cmluZztcclxuXHJcbiAgICAvKipcclxuICAgICAqIOafpeivouadoeS7tlxyXG4gICAgICovXHJcbiAgICBxdWVyeUNvbmRpdGlvbnM6IEFycmF5PFF1ZXJ5Q29uZGl0aW9uPjtcclxuXHJcbiAgICAvKipcclxuICAgICAqIOaYr+WQpuezu+e7n+mihOe9ruafpeivouaWueahiFxyXG4gICAgICovXHJcbiAgICBpc1N5c3RlbTogYm9vbGVhbjtcclxuXHJcbiAgICAvKipcclxuICAgICAqIOaYr+WQpum7mOiupOafpeivouaWueahiFxyXG4gICAgICog5Yid5aeL5pe277yM5Li6ZmFsc2VcclxuICAgICAqL1xyXG4gICAgaXNEZWZhdWx0OiBib29sZWFuID0gZmFsc2U7XHJcblxyXG4gICAgaXNDaGFuZ2VkOiBib29sZWFuID0gZmFsc2U7XHJcbiAgICAvKipcclxuICAgICAqIOexu+Wei++8miBwcmXmmK/kuIrmrKHmn6Xor6JcclxuICAgICAqL1xyXG4gICAgdHlwZTogc3RyaW5nO1xyXG5cclxuICAgIGV4dGVuZElkOiBzdHJpbmcgPSAncXVlcnktc2NoZW1lLTEnO1xyXG5cclxuICAgIGV4dGVuZEluZm86IEFycmF5PFF1ZXJ5U29sdXRpb25FeHRlbmRWbz47XHJcblxyXG4gICAgY29kZV9jaHM6IHN0cmluZztcclxuXHJcbiAgICBjb2RlX2VuOiBzdHJpbmc7XHJcblxyXG4gICAgY29kZV9jaHQ6IHN0cmluZztcclxuICAgIC8qKlxyXG4gICAgICog6auY57qn5qih5byP5paw5aKe5a2X5q6177yMMeS4uuagh+WHhuaooeW8j++8jDLkuLrpq5jnuqfmqKHlvI9cclxuICAgICAqL1xyXG4gICAgbW9kZTogc3RyaW5nO1xyXG4gICAgLyoqXHJcbiAgICAgKiDpq5jnuqfmqKHlvI/mlrDlop7ovoXliqnlrZfmrrXvvIznlKjmnaXlsZXnpLpjb25kaXRpb27nmoTmoJHnu5PmnoRcclxuICAgICAqL1xyXG4gICAgcXVlcnlDb25kaXRpb25zQWR2YW5jZWQ6IFF1ZXJ5Y29uZGl0aW9uQWR2YW5jZWREYXRhO1xyXG59XHJcblxyXG4vKipcclxuICog5p+l6K+i5pa55qGI5a6e5L2T57G75bqP5YiX5YyW5LiO5Y+N5bqP5YiX5YyW5ZmoXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgUXVlcnlTb2x1dGlvblZvQ29udmVydG9yIHtcclxuXHJcbiAgICAvKipcclxuICAgICAqIOW6j+WIl+WMllxyXG4gICAgICogQHBhcmFtIG9iaiDmn6Xor6LmlrnmoYjlrp7kvZNcclxuICAgICAqL1xyXG4gICAgY29udmVydEpPYmplY3Qob2JqOiBRdWVyeVNvbHV0aW9uVm8pOiBPYmplY3Qge1xyXG4gICAgICAgIGxldCBxdWVyeVNvbHV0aW9uVm8gPSBvYmogYXMgUXVlcnlTb2x1dGlvblZvO1xyXG4gICAgICAgIGxldCBqb2JqID0gbmV3IE9iamVjdCgpO1xyXG4gICAgICAgIGpvYmpbXCJpZFwiXSA9IHF1ZXJ5U29sdXRpb25Wby5pZDtcclxuICAgICAgICBqb2JqW1wiYmVsb25nSWRcIl0gPSBxdWVyeVNvbHV0aW9uVm8uYmVsb25nSWQ7XHJcbiAgICAgICAgam9ialtcImNvZGVcIl0gPSBxdWVyeVNvbHV0aW9uVm8uY29kZTtcclxuICAgICAgICBqb2JqW1wibmFtZVwiXSA9IHF1ZXJ5U29sdXRpb25Wby5uYW1lO1xyXG4gICAgICAgIGpvYmpbXCJpc1N5c3RlbVwiXSA9IHF1ZXJ5U29sdXRpb25Wby5pc1N5c3RlbTtcclxuICAgICAgICBqb2JqW1wiaXNEZWZhdWx0XCJdID0gcXVlcnlTb2x1dGlvblZvLmlzRGVmYXVsdDtcclxuICAgICAgICBqb2JqW1widHlwZVwiXSA9IHF1ZXJ5U29sdXRpb25Wby50eXBlO1xyXG4gICAgICAgIGpvYmpbXCJleHRlbmRJZFwiXSA9IHF1ZXJ5U29sdXRpb25Wby5leHRlbmRJZDtcclxuICAgICAgICBqb2JqW1wiZXh0ZW5kSW5mb1wiXSA9IHF1ZXJ5U29sdXRpb25Wby5leHRlbmRJbmZvO1xyXG4gICAgICAgIGpvYmpbXCJjb2RlX2Noc1wiXSA9IHF1ZXJ5U29sdXRpb25Wby5jb2RlX2NocztcclxuICAgICAgICBqb2JqW1wiY29kZV9lblwiXSA9IHF1ZXJ5U29sdXRpb25Wby5jb2RlX2VuO1xyXG4gICAgICAgIGpvYmpbXCJjb2RlX2NodFwiXSA9IHF1ZXJ5U29sdXRpb25Wby5jb2RlX2NodDtcclxuICAgICAgICBqb2JqW1wibW9kZVwiXSA9IHF1ZXJ5U29sdXRpb25Wby5tb2RlIHx8ICcxJztcclxuICAgICAgICAvL+mSiOWvueagkeaVsOaNruS4reWBmueugOWMluWkhOeQhu+8jOS7heS/neeVmeWvueW6lOadoeS7tueahGNvbmRpdGlvbmlkXHJcblxyXG4gICAgICAgIGlmKHF1ZXJ5U29sdXRpb25Wby5tb2RlID09PSAnMicpIHtcclxuICAgICAgICAgICAgLy8gbGV0IF9xdWVyeUNvbmRpdGlvbnNBZHZhbmNlZCA9IHF1ZXJ5U29sdXRpb25Wby5xdWVyeUNvbmRpdGlvbnNBZHZhbmNlZFxyXG4gICAgICAgICAgICAvLyBsZXQgX2FkdmFuY2VkRmxhdENvbmRpdGlvbnMgPSB0aGlzLmdldEZsYXRDb25kaXRpb25zKF9xdWVyeUNvbmRpdGlvbnNBZHZhbmNlZClcclxuICAgICAgICAgICAgLy8gX2FkdmFuY2VkRmxhdENvbmRpdGlvbnMuZm9yRWFjaCh2YWwgPT4gdmFsLmNvbmRpdGlvbmlkID0gdmFsLmNvbmRpdGlvbmlkICoyKVxyXG4gICAgICAgICAgICBsZXQgX3F1ZXJ5Q29uZGl0aW9uc0FkdmFuY2VkID0gdGhpcy5zaW1wbGlmeVRyZWVEYXRhKGNsb25lRGVlcChxdWVyeVNvbHV0aW9uVm8ucXVlcnlDb25kaXRpb25zQWR2YW5jZWQpKVxyXG4gICAgICAgICAgICBqb2JqW1wiYWR2YW5jZWRRdWVyeUNvbmRpdGlvbnNTdHJpbmdcIl0gPSBKU09OLnN0cmluZ2lmeShfcXVlcnlDb25kaXRpb25zQWR2YW5jZWQpXHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIGlmIChxdWVyeVNvbHV0aW9uVm8ucXVlcnlDb25kaXRpb25zICYmIHF1ZXJ5U29sdXRpb25Wby5xdWVyeUNvbmRpdGlvbnMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICBsZXQgakFycmF5ID0gW107XHJcbiAgICAgICAgICAgIGxldCBjb252ZXJ0b3IgPSBuZXcgUXVlcnlDb25kaXRpb25Db252ZXJ0KCk7XHJcbiAgICAgICAgICAgIHF1ZXJ5U29sdXRpb25Wby5xdWVyeUNvbmRpdGlvbnMuZm9yRWFjaChlbGVtZW50ID0+IHtcclxuICAgICAgICAgICAgICAgIGpBcnJheS5wdXNoKGNvbnZlcnRvci5jb252ZXJ0Sk9iamVjdChlbGVtZW50KSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAvL+WQkeacjeWKoeerr+WPkemAgeaVsOaNruaXtu+8jOWPkemAgXF1ZXJ5IGNvbmRpdGlvbiBsaXN055qEanNvbiBzdHJpbmdcclxuICAgICAgICAgICAgam9ialtcInF1ZXJ5Q29uZGl0aW9uU3RyaW5nXCJdID0gSlNPTi5zdHJpbmdpZnkoakFycmF5KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGpvYmo7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDlj43luo/liJfljJYo5Yid5aeL5YyWKVxyXG4gICAgICogQHBhcmFtIGpvYmog5p+l6K+i5pa55qGI5bqP5YiX5YyW5ZCO55qET2JqZWN0XHJcbiAgICAgKi9cclxuICAgIGluaXRGcm9tSm9iamVjdChqb2JqOiBPYmplY3QpOiBRdWVyeVNvbHV0aW9uVm8ge1xyXG4gICAgICAgIGxldCBxdWVyeVNvbHV0aW9uVm8gPSBuZXcgUXVlcnlTb2x1dGlvblZvKCk7XHJcbiAgICAgICAgcXVlcnlTb2x1dGlvblZvLmlkID0gam9ialtcImlkXCJdO1xyXG4gICAgICAgIHF1ZXJ5U29sdXRpb25Wby5jb2RlID0gam9ialtcImNvZGVcIl07XHJcbiAgICAgICAgcXVlcnlTb2x1dGlvblZvLm5hbWUgPSBqb2JqW1wibmFtZVwiXTtcclxuICAgICAgICBxdWVyeVNvbHV0aW9uVm8uYmVsb25nSWQgPSBqb2JqW1wiYmVsb25nSWRcIl07XHJcbiAgICAgICAgcXVlcnlTb2x1dGlvblZvLmlzU3lzdGVtID0gam9ialtcImlzU3lzdGVtXCJdO1xyXG4gICAgICAgIHF1ZXJ5U29sdXRpb25Wby5pc0RlZmF1bHQgPSBqb2JqW1wiaXNEZWZhdWx0XCJdO1xyXG4gICAgICAgIHF1ZXJ5U29sdXRpb25Wby50eXBlID0gam9iai5oYXNPd25Qcm9wZXJ0eSgndHlwZScpID8gam9ialtcInR5cGVcIl0gOiAnJztcclxuICAgICAgICBxdWVyeVNvbHV0aW9uVm8uZXh0ZW5kSWQgPSBqb2JqLmhhc093blByb3BlcnR5KCdleHRlbmRJZCcpID8gam9ialtcImV4dGVuZElkXCJdIDogXCJcIjtcclxuICAgICAgICBxdWVyeVNvbHV0aW9uVm8ucXVlcnlDb25kaXRpb25zID0gbmV3IEFycmF5PFF1ZXJ5Q29uZGl0aW9uPigpO1xyXG4gICAgICAgIC8v6auY57qn5qih5byP5paw5aKebW9kZSwx5Li65Lyg57uf5qih5byP77yMMuS4uumrmOe6p+aooeW8j1xyXG4gICAgICAgIHF1ZXJ5U29sdXRpb25Wby5tb2RlID0gam9ialtcIm1vZGVcIl0gfHwgMTtcclxuICAgICAgICBcclxuICAgICAgICAvL+acjeWKoeWZqOerr+i/lOWbnueahHF1ZXJ5IGNvbmRpdGlvbiBsaXN05a6e6ZmF5pivIGpzb24gc3RyaW5nXHJcbiAgICAgICAgY29uc3QgcXVlcnlDb25kaXRpb25TdHJpbmcgPSBqb2JqW1wicXVlcnlDb25kaXRpb25TdHJpbmdcIl07XHJcbiAgICAgICAgaWYgKHF1ZXJ5Q29uZGl0aW9uU3RyaW5nKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGNvbmRpdGlvbkphcnJ5ID0gSlNPTi5wYXJzZShxdWVyeUNvbmRpdGlvblN0cmluZyk7XHJcbiAgICAgICAgICAgIGxldCBjb252ZXJ0b3IgPSBuZXcgUXVlcnlDb25kaXRpb25Db252ZXJ0KCk7XHJcbiAgICAgICAgICAgIGNvbmRpdGlvbkphcnJ5LmZvckVhY2goZWxlbWVudCA9PiB7XHJcbiAgICAgICAgICAgICAgICBxdWVyeVNvbHV0aW9uVm8ucXVlcnlDb25kaXRpb25zLnB1c2goY29udmVydG9yLmluaXRGcm9tSm9iamVjdChlbGVtZW50KSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBxdWVyeVNvbHV0aW9uVm8ucXVlcnlDb25kaXRpb25zQWR2YW5jZWQgPSBqb2JqW1wiYWR2YW5jZWRRdWVyeUNvbmRpdGlvbnNTdHJpbmdcIl0gPyBKU09OLnBhcnNlKGpvYmpbXCJhZHZhbmNlZFF1ZXJ5Q29uZGl0aW9uc1N0cmluZ1wiXSkgOiBudWxsO1xyXG5cclxuICAgICAgICByZXR1cm4gcXVlcnlTb2x1dGlvblZvO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiDku47nvJPlrZjkuK3lj5blm57nmoRKU09O5pWw5o2u6ZyA6KaB6L2s5YyWXHJcbiAgICAgKiDku47lpKflhpnovazmjaLliLDlsI/lhpnmnaHku7ZcclxuICAgICAqL1xyXG4gICAgZm9ybWF0RnJvbUpvYmplY3Qoam9iajogQXJyYXk8YW55PiB8IHN0cmluZyk6IEFycmF5PFF1ZXJ5Q29uZGl0aW9uPiB7XHJcbiAgICAgICAgbGV0IHF1ZXJ5Q29uZGl0aW9ucyA9IG5ldyBBcnJheTxRdWVyeUNvbmRpdGlvbj4oKTtcclxuICAgICAgICBsZXQgY29uZGl0aW9uSmFycnk7XHJcbiAgICAgICAgaWYgKHR5cGVvZiBqb2JqID09ICdzdHJpbmcnKSB7XHJcbiAgICAgICAgICAgIGNvbmRpdGlvbkphcnJ5ID0gSlNPTi5wYXJzZShqb2JqKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBjb25kaXRpb25KYXJyeSA9IGpvYmo7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGxldCBjb252ZXJ0b3IgPSBuZXcgUXVlcnlDb25kaXRpb25Db252ZXJ0KCk7XHJcbiAgICAgICAgY29uZGl0aW9uSmFycnkuZm9yRWFjaChlbGVtZW50ID0+IHtcclxuICAgICAgICAgICAgcXVlcnlDb25kaXRpb25zLnB1c2goY29udmVydG9yLmluaXRGcm9tSm9iamVjdChlbGVtZW50KSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIHF1ZXJ5Q29uZGl0aW9ucztcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICog5a2Y5YWl57yT5a2Y5LitXHJcbiAgICAgKiDku47lpKflhpnovazmjaLliLDlsI/lhpnmnaHku7ZcclxuICAgICAqL1xyXG4gICAgZm9ybWF0Q29udmVydEpPYmplY3Qoam9iajogQXJyYXk8UXVlcnlDb25kaXRpb24+KTpBcnJheTxhbnk+e1xyXG4gICAgICAgIGxldCBxdWVyeUNvbmRpdGlvbnMgPVtdO1xyXG4gICAgICAgIGxldCBjb252ZXJ0b3IgPSBuZXcgUXVlcnlDb25kaXRpb25Db252ZXJ0KCk7XHJcbiAgICAgICAgam9iai5mb3JFYWNoKGVsZW1lbnQgPT4ge1xyXG4gICAgICAgICAgICBxdWVyeUNvbmRpdGlvbnMucHVzaChjb252ZXJ0b3IuY29udmVydEpPYmplY3QoZWxlbWVudCkpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiBxdWVyeUNvbmRpdGlvbnM7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDlsIbpq5jnuqfmqKHlvI/kuIvmoJHnu5PmnoRjb25kaXRpb27miYHlubPljJZcclxuICAgICAqIEBwYXJhbSBkYXRhIFxyXG4gICAgICogQHJldHVybnMgXHJcbiAgICAgKi9cclxuICAgIGdldEZsYXRDb25kaXRpb25zKGRhdGEpIHtcclxuICAgICAgICBpZiAoZGF0YS5jaGlsZHJlbikge1xyXG4gICAgICAgICAgcmV0dXJuIFtdLmNvbmNhdChkYXRhLml0ZW1zLCAuLi5kYXRhLmNoaWxkcmVuLm1hcCh2YWwgPT4gdGhpcy5nZXRGbGF0Q29uZGl0aW9ucyh2YWwpKSlcclxuICAgIFxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gW10uY29uY2F0KGRhdGEuaXRlbXMpXHJcbiAgICBcclxuICAgICAgfVxyXG4gICAgICBzaW1wbGlmeVRyZWVEYXRhKGRhdGEpIHtcclxuICAgICAgICBpZihkYXRhLml0ZW1zICYmIGRhdGEuaXRlbXMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIGxldCBfaXRlbXMgPSBkYXRhLml0ZW1zLm1hcCh2YWwgPT4gIHtyZXR1cm4ge2NvbmRpdGlvbmlkOiB2YWwuY29uZGl0aW9uaWR9fSlcclxuICAgICAgICAgICAgZGF0YS5pdGVtcyA9IF9pdGVtc1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZihkYXRhLmNoaWxkcmVuKSB7XHJcbiAgICAgICAgICAgIGRhdGEuY2hpbGRyZW4uZm9yRWFjaCh2YWwgPT4gdGhpcy5zaW1wbGlmeVRyZWVEYXRhKHZhbCkpXHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBkYXRhXHJcbiAgICB9XHJcbiAgICBjb21wbGljYXRlVHJlZURhdGEob3JpZ2luRGF0YSwgY29uZGl0aW9uTGlzdCkge1xyXG4gICAgICAgIFxyXG4gICAgICAgIGxldCBoYW5kbGVGdW5jID0gKHRyZWVEYXRhKSA9PiB7XHJcblxyXG4gICAgICAgICAgICBpZiAodHJlZURhdGEuaXRlbXMgJiYgdHJlZURhdGEuaXRlbXMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICB0cmVlRGF0YS5pdGVtcyA9IHRyZWVEYXRhLml0ZW1zLm1hcCh2YWwgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCB0YXJnZXQgPSBjb25kaXRpb25MaXN0LmZpbmQoaXRlbSA9PiBpdGVtLmNvbmRpdGlvbmlkID09PSB2YWwuY29uZGl0aW9uaWQpXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRhcmdldCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgcmVzdWx0ID0gY2xvbmVEZWVwKHRhcmdldClcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0Lmdyb3VwaWQgPSB1bmRlZmluZWRcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0LkxicmFja2V0ID0gdW5kZWZpbmVkXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdC5SYnJhY2tldCA9IHVuZGVmaW5lZFxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsXHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmKHRyZWVEYXRhLmNoaWxkcmVuICYmIHRyZWVEYXRhLmNoaWxkcmVuLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgdHJlZURhdGEuY2hpbGRyZW4uZm9yRWFjaCh2YWwgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGhhbmRsZUZ1bmModmFsKVxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvL+S7heS+m+i/lOWbnumhtuWxguaVsOaNru+8jOmBjeWOhui/h+eoi+S9v+eUqOS4jeWIsFxyXG4gICAgICAgICAgICByZXR1cm4gdHJlZURhdGFcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGhhbmRsZUZ1bmMob3JpZ2luRGF0YSlcclxuXHJcbiAgICB9XHJcbn0iXX0=