/**
 * @fileoverview added by tsickle
 * Generated from: lib/entity/querysolutionvo.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { QueryConditionConvert } from "./querycondition";
import { cloneDeep } from 'lodash-es';
/**
 * 查询方案实体类
 */
export class QuerySolutionVo {
    constructor() {
        /**
         * 是否默认查询方案
         * 初始时，为false
         */
        this.isDefault = false;
        this.isChanged = false;
        this.extendId = 'query-scheme-1';
    }
}
if (false) {
    /**
     * 唯一性标识
     * @type {?}
     */
    QuerySolutionVo.prototype.id;
    /**
     * 所属ID，例如所属表单ID
     * @type {?}
     */
    QuerySolutionVo.prototype.belongId;
    /**
     * 查询方案编号
     * @type {?}
     */
    QuerySolutionVo.prototype.code;
    /**
     * 查询方案名称
     * @type {?}
     */
    QuerySolutionVo.prototype.name;
    /**
     * 查询条件
     * @type {?}
     */
    QuerySolutionVo.prototype.queryConditions;
    /**
     * 是否系统预置查询方案
     * @type {?}
     */
    QuerySolutionVo.prototype.isSystem;
    /**
     * 是否默认查询方案
     * 初始时，为false
     * @type {?}
     */
    QuerySolutionVo.prototype.isDefault;
    /** @type {?} */
    QuerySolutionVo.prototype.isChanged;
    /**
     * 类型： pre是上次查询
     * @type {?}
     */
    QuerySolutionVo.prototype.type;
    /** @type {?} */
    QuerySolutionVo.prototype.extendId;
    /** @type {?} */
    QuerySolutionVo.prototype.extendInfo;
    /** @type {?} */
    QuerySolutionVo.prototype.code_chs;
    /** @type {?} */
    QuerySolutionVo.prototype.code_en;
    /** @type {?} */
    QuerySolutionVo.prototype.code_cht;
    /**
     * 高级模式新增字段，1为标准模式，2为高级模式
     * @type {?}
     */
    QuerySolutionVo.prototype.mode;
    /**
     * 高级模式新增辅助字段，用来展示condition的树结构
     * @type {?}
     */
    QuerySolutionVo.prototype.queryConditionsAdvanced;
}
/**
 * 查询方案实体类序列化与反序列化器
 */
export class QuerySolutionVoConvertor {
    /**
     * 序列化
     * @param {?} obj 查询方案实体
     * @return {?}
     */
    convertJObject(obj) {
        /** @type {?} */
        let querySolutionVo = (/** @type {?} */ (obj));
        /** @type {?} */
        let jobj = new Object();
        jobj["id"] = querySolutionVo.id;
        jobj["belongId"] = querySolutionVo.belongId;
        jobj["code"] = querySolutionVo.code;
        jobj["name"] = querySolutionVo.name;
        jobj["isSystem"] = querySolutionVo.isSystem;
        jobj["isDefault"] = querySolutionVo.isDefault;
        jobj["type"] = querySolutionVo.type;
        jobj["extendId"] = querySolutionVo.extendId;
        jobj["extendInfo"] = querySolutionVo.extendInfo;
        jobj["code_chs"] = querySolutionVo.code_chs;
        jobj["code_en"] = querySolutionVo.code_en;
        jobj["code_cht"] = querySolutionVo.code_cht;
        jobj["mode"] = querySolutionVo.mode || '1';
        //针对树数据中做简化处理，仅保留对应条件的conditionid
        if (querySolutionVo.mode === '2') {
            // let _queryConditionsAdvanced = querySolutionVo.queryConditionsAdvanced
            // let _advancedFlatConditions = this.getFlatConditions(_queryConditionsAdvanced)
            // _advancedFlatConditions.forEach(val => val.conditionid = val.conditionid *2)
            /** @type {?} */
            let _queryConditionsAdvanced = this.simplifyTreeData(cloneDeep(querySolutionVo.queryConditionsAdvanced));
            jobj["advancedQueryConditionsString"] = JSON.stringify(_queryConditionsAdvanced);
        }
        if (querySolutionVo.queryConditions && querySolutionVo.queryConditions.length > 0) {
            /** @type {?} */
            let jArray = [];
            /** @type {?} */
            let convertor = new QueryConditionConvert();
            querySolutionVo.queryConditions.forEach((/**
             * @param {?} element
             * @return {?}
             */
            element => {
                jArray.push(convertor.convertJObject(element));
            }));
            //向服务端发送数据时，发送query condition list的json string
            jobj["queryConditionString"] = JSON.stringify(jArray);
        }
        return jobj;
    }
    /**
     * 反序列化(初始化)
     * @param {?} jobj 查询方案序列化后的Object
     * @return {?}
     */
    initFromJobject(jobj) {
        /** @type {?} */
        let querySolutionVo = new QuerySolutionVo();
        querySolutionVo.id = jobj["id"];
        querySolutionVo.code = jobj["code"];
        querySolutionVo.name = jobj["name"];
        querySolutionVo.belongId = jobj["belongId"];
        querySolutionVo.isSystem = jobj["isSystem"];
        querySolutionVo.isDefault = jobj["isDefault"];
        querySolutionVo.type = jobj.hasOwnProperty('type') ? jobj["type"] : '';
        querySolutionVo.extendId = jobj.hasOwnProperty('extendId') ? jobj["extendId"] : "";
        querySolutionVo.queryConditions = new Array();
        //高级模式新增mode,1为传统模式，2为高级模式
        querySolutionVo.mode = jobj["mode"] || 1;
        //服务器端返回的query condition list实际是 json string
        /** @type {?} */
        const queryConditionString = jobj["queryConditionString"];
        if (queryConditionString) {
            /** @type {?} */
            const conditionJarry = JSON.parse(queryConditionString);
            /** @type {?} */
            let convertor = new QueryConditionConvert();
            conditionJarry.forEach((/**
             * @param {?} element
             * @return {?}
             */
            element => {
                querySolutionVo.queryConditions.push(convertor.initFromJobject(element));
            }));
        }
        querySolutionVo.queryConditionsAdvanced = jobj["advancedQueryConditionsString"] ? JSON.parse(jobj["advancedQueryConditionsString"]) : null;
        return querySolutionVo;
    }
    /**
     * 从缓存中取回的JSON数据需要转化
     * 从大写转换到小写条件
     * @param {?} jobj
     * @return {?}
     */
    formatFromJobject(jobj) {
        /** @type {?} */
        let queryConditions = new Array();
        /** @type {?} */
        let conditionJarry;
        if (typeof jobj == 'string') {
            conditionJarry = JSON.parse(jobj);
        }
        else {
            conditionJarry = jobj;
        }
        /** @type {?} */
        let convertor = new QueryConditionConvert();
        conditionJarry.forEach((/**
         * @param {?} element
         * @return {?}
         */
        element => {
            queryConditions.push(convertor.initFromJobject(element));
        }));
        return queryConditions;
    }
    /**
     * 存入缓存中
     * 从大写转换到小写条件
     * @param {?} jobj
     * @return {?}
     */
    formatConvertJObject(jobj) {
        /** @type {?} */
        let queryConditions = [];
        /** @type {?} */
        let convertor = new QueryConditionConvert();
        jobj.forEach((/**
         * @param {?} element
         * @return {?}
         */
        element => {
            queryConditions.push(convertor.convertJObject(element));
        }));
        return queryConditions;
    }
    /**
     * 将高级模式下树结构condition扁平化
     * @param {?} data
     * @return {?}
     */
    getFlatConditions(data) {
        if (data.children) {
            return [].concat(data.items, ...data.children.map((/**
             * @param {?} val
             * @return {?}
             */
            val => this.getFlatConditions(val))));
        }
        return [].concat(data.items);
    }
    /**
     * @param {?} data
     * @return {?}
     */
    simplifyTreeData(data) {
        if (data.items && data.items.length) {
            /** @type {?} */
            let _items = data.items.map((/**
             * @param {?} val
             * @return {?}
             */
            val => { return { conditionid: val.conditionid }; }));
            data.items = _items;
        }
        if (data.children) {
            data.children.forEach((/**
             * @param {?} val
             * @return {?}
             */
            val => this.simplifyTreeData(val)));
        }
        return data;
    }
    /**
     * @param {?} originData
     * @param {?} conditionList
     * @return {?}
     */
    complicateTreeData(originData, conditionList) {
        /** @type {?} */
        let handleFunc = (/**
         * @param {?} treeData
         * @return {?}
         */
        (treeData) => {
            if (treeData.items && treeData.items.length) {
                treeData.items = treeData.items.map((/**
                 * @param {?} val
                 * @return {?}
                 */
                val => {
                    /** @type {?} */
                    let target = conditionList.find((/**
                     * @param {?} item
                     * @return {?}
                     */
                    item => item.conditionid === val.conditionid));
                    if (target) {
                        /** @type {?} */
                        let result = cloneDeep(target);
                        result.groupid = undefined;
                        result.Lbracket = undefined;
                        result.Rbracket = undefined;
                        return result;
                    }
                    return null;
                }));
            }
            if (treeData.children && treeData.children.length) {
                treeData.children.forEach((/**
                 * @param {?} val
                 * @return {?}
                 */
                val => {
                    handleFunc(val);
                }));
            }
            //仅供返回顶层数据，遍历过程使用不到
            return treeData;
        });
        return handleFunc(originData);
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicXVlcnlzb2x1dGlvbnZvLmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGZhcnJpcy9jb21wb25lbnQtcXVlcnljb25kaXRpb24vIiwic291cmNlcyI6WyJsaWIvZW50aXR5L3F1ZXJ5c29sdXRpb252by50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7OztBQUFBLE9BQU8sRUFBa0IscUJBQXFCLEVBQUUsTUFBTSxrQkFBa0IsQ0FBQztBQUd6RSxPQUFPLEVBQUUsU0FBUyxFQUFFLE1BQU0sV0FBVyxDQUFDOzs7O0FBSXRDLE1BQU0sT0FBTyxlQUFlO0lBQTVCOzs7OztRQW1DSSxjQUFTLEdBQVksS0FBSyxDQUFDO1FBRTNCLGNBQVMsR0FBWSxLQUFLLENBQUM7UUFNM0IsYUFBUSxHQUFXLGdCQUFnQixDQUFDO0lBaUJ4QyxDQUFDO0NBQUE7Ozs7OztJQXhERyw2QkFBVzs7Ozs7SUFLWCxtQ0FBaUI7Ozs7O0lBS2pCLCtCQUFhOzs7OztJQUtiLCtCQUFhOzs7OztJQUtiLDBDQUF1Qzs7Ozs7SUFLdkMsbUNBQWtCOzs7Ozs7SUFNbEIsb0NBQTJCOztJQUUzQixvQ0FBMkI7Ozs7O0lBSTNCLCtCQUFhOztJQUViLG1DQUFvQzs7SUFFcEMscUNBQXlDOztJQUV6QyxtQ0FBaUI7O0lBRWpCLGtDQUFnQjs7SUFFaEIsbUNBQWlCOzs7OztJQUlqQiwrQkFBYTs7Ozs7SUFJYixrREFBb0Q7Ozs7O0FBTXhELE1BQU0sT0FBTyx3QkFBd0I7Ozs7OztJQU1qQyxjQUFjLENBQUMsR0FBb0I7O1lBQzNCLGVBQWUsR0FBRyxtQkFBQSxHQUFHLEVBQW1COztZQUN4QyxJQUFJLEdBQUcsSUFBSSxNQUFNLEVBQUU7UUFDdkIsSUFBSSxDQUFDLElBQUksQ0FBQyxHQUFHLGVBQWUsQ0FBQyxFQUFFLENBQUM7UUFDaEMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxHQUFHLGVBQWUsQ0FBQyxRQUFRLENBQUM7UUFDNUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxHQUFHLGVBQWUsQ0FBQyxJQUFJLENB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dXJjZXNDb250ZW50IjpbImltcG9ydCB7IFF1ZXJ5Q29uZGl0aW9uLCBRdWVyeUNvbmRpdGlvbkNvbnZlcnQgfSBmcm9tIFwiLi9xdWVyeWNvbmRpdGlvblwiO1xyXG5pbXBvcnQgeyBRdWVyeVNvbHV0aW9uRXh0ZW5kVm8gfSBmcm9tICcuL3F1ZXJ5c29sdXRpb25leHRlbmR2byc7XHJcbmltcG9ydCB7UXVlcnljb25kaXRpb25BZHZhbmNlZERhdGF9IGZyb20gJy4uL3F1ZXJ5Y29uZGl0aW9uLWFkdmFuY2VkL3R5cGUvdHlwZSdcclxuaW1wb3J0IHsgY2xvbmVEZWVwIH0gZnJvbSAnbG9kYXNoLWVzJztcclxuLyoqXHJcbiAqIOafpeivouaWueahiOWunuS9k+exuyBcclxuICovXHJcbmV4cG9ydCBjbGFzcyBRdWVyeVNvbHV0aW9uVm8ge1xyXG4gICAgLyoqXHJcbiAgICAgKiDllK/kuIDmgKfmoIfor4ZcclxuICAgICAqL1xyXG4gICAgaWQ6IHN0cmluZztcclxuXHJcbiAgICAvKipcclxuICAgICAqIOaJgOWxnklE77yM5L6L5aaC5omA5bGe6KGo5Y2VSURcclxuICAgICAqL1xyXG4gICAgYmVsb25nSWQ6IHN0cmluZztcclxuXHJcbiAgICAvKipcclxuICAgICAqIOafpeivouaWueahiOe8luWPt1xyXG4gICAgICovXHJcbiAgICBjb2RlOiBzdHJpbmc7XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDmn6Xor6LmlrnmoYjlkI3np7BcclxuICAgICAqL1xyXG4gICAgbmFtZTogc3RyaW5nO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICog5p+l6K+i5p2h5Lu2XHJcbiAgICAgKi9cclxuICAgIHF1ZXJ5Q29uZGl0aW9uczogQXJyYXk8UXVlcnlDb25kaXRpb24+O1xyXG5cclxuICAgIC8qKlxyXG4gICAgICog5piv5ZCm57O757uf6aKE572u5p+l6K+i5pa55qGIXHJcbiAgICAgKi9cclxuICAgIGlzU3lzdGVtOiBib29sZWFuO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICog5piv5ZCm6buY6K6k5p+l6K+i5pa55qGIXHJcbiAgICAgKiDliJ3lp4vml7bvvIzkuLpmYWxzZVxyXG4gICAgICovXHJcbiAgICBpc0RlZmF1bHQ6IGJvb2xlYW4gPSBmYWxzZTtcclxuXHJcbiAgICBpc0NoYW5nZWQ6IGJvb2xlYW4gPSBmYWxzZTtcclxuICAgIC8qKlxyXG4gICAgICog57G75Z6L77yaIHByZeaYr+S4iuasoeafpeivolxyXG4gICAgICovXHJcbiAgICB0eXBlOiBzdHJpbmc7XHJcblxyXG4gICAgZXh0ZW5kSWQ6IHN0cmluZyA9ICdxdWVyeS1zY2hlbWUtMSc7XHJcblxyXG4gICAgZXh0ZW5kSW5mbzogQXJyYXk8UXVlcnlTb2x1dGlvbkV4dGVuZFZvPjtcclxuXHJcbiAgICBjb2RlX2Noczogc3RyaW5nO1xyXG5cclxuICAgIGNvZGVfZW46IHN0cmluZztcclxuXHJcbiAgICBjb2RlX2NodDogc3RyaW5nO1xyXG4gICAgLyoqXHJcbiAgICAgKiDpq5jnuqfmqKHlvI/mlrDlop7lrZfmrrXvvIwx5Li65qCH5YeG5qih5byP77yMMuS4uumrmOe6p+aooeW8j1xyXG4gICAgICovXHJcbiAgICBtb2RlOiBzdHJpbmc7XHJcbiAgICAvKipcclxuICAgICAqIOmrmOe6p+aooeW8j+aWsOWinui+heWKqeWtl+aute+8jOeUqOadpeWxleekumNvbmRpdGlvbueahOagkee7k+aehFxyXG4gICAgICovXHJcbiAgICBxdWVyeUNvbmRpdGlvbnNBZHZhbmNlZDogUXVlcnljb25kaXRpb25BZHZhbmNlZERhdGE7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiDmn6Xor6LmlrnmoYjlrp7kvZPnsbvluo/liJfljJbkuI7lj43luo/liJfljJblmahcclxuICovXHJcbmV4cG9ydCBjbGFzcyBRdWVyeVNvbHV0aW9uVm9Db252ZXJ0b3Ige1xyXG5cclxuICAgIC8qKlxyXG4gICAgICog5bqP5YiX5YyWXHJcbiAgICAgKiBAcGFyYW0gb2JqIOafpeivouaWueahiOWunuS9k1xyXG4gICAgICovXHJcbiAgICBjb252ZXJ0Sk9iamVjdChvYmo6IFF1ZXJ5U29sdXRpb25Wbyk6IE9iamVjdCB7XHJcbiAgICAgICAgbGV0IHF1ZXJ5U29sdXRpb25WbyA9IG9iaiBhcyBRdWVyeVNvbHV0aW9uVm87XHJcbiAgICAgICAgbGV0IGpvYmogPSBuZXcgT2JqZWN0KCk7XHJcbiAgICAgICAgam9ialtcImlkXCJdID0gcXVlcnlTb2x1dGlvblZvLmlkO1xyXG4gICAgICAgIGpvYmpbXCJiZWxvbmdJZFwiXSA9IHF1ZXJ5U29sdXRpb25Wby5iZWxvbmdJZDtcclxuICAgICAgICBqb2JqW1wiY29kZVwiXSA9IHF1ZXJ5U29sdXRpb25Wby5jb2RlO1xyXG4gICAgICAgIGpvYmpbXCJuYW1lXCJdID0gcXVlcnlTb2x1dGlvblZvLm5hbWU7XHJcbiAgICAgICAgam9ialtcImlzU3lzdGVtXCJdID0gcXVlcnlTb2x1dGlvblZvLmlzU3lzdGVtO1xyXG4gICAgICAgIGpvYmpbXCJpc0RlZmF1bHRcIl0gPSBxdWVyeVNvbHV0aW9uVm8uaXNEZWZhdWx0O1xyXG4gICAgICAgIGpvYmpbXCJ0eXBlXCJdID0gcXVlcnlTb2x1dGlvblZvLnR5cGU7XHJcbiAgICAgICAgam9ialtcImV4dGVuZElkXCJdID0gcXVlcnlTb2x1dGlvblZvLmV4dGVuZElkO1xyXG4gICAgICAgIGpvYmpbXCJleHRlbmRJbmZvXCJdID0gcXVlcnlTb2x1dGlvblZvLmV4dGVuZEluZm87XHJcbiAgICAgICAgam9ialtcImNvZGVfY2hzXCJdID0gcXVlcnlTb2x1dGlvblZvLmNvZGVfY2hzO1xyXG4gICAgICAgIGpvYmpbXCJjb2RlX2VuXCJdID0gcXVlcnlTb2x1dGlvblZvLmNvZGVfZW47XHJcbiAgICAgICAgam9ialtcImNvZGVfY2h0XCJdID0gcXVlcnlTb2x1dGlvblZvLmNvZGVfY2h0O1xyXG4gICAgICAgIGpvYmpbXCJtb2RlXCJdID0gcXVlcnlTb2x1dGlvblZvLm1vZGUgfHwgJzEnO1xyXG4gICAgICAgIC8v6ZKI5a+55qCR5pWw5o2u5Lit5YGa566A5YyW5aSE55CG77yM5LuF5L+d55WZ5a+55bqU5p2h5Lu255qEY29uZGl0aW9uaWRcclxuXHJcbiAgICAgICAgaWYocXVlcnlTb2x1dGlvblZvLm1vZGUgPT09ICcyJykge1xyXG4gICAgICAgICAgICAvLyBsZXQgX3F1ZXJ5Q29uZGl0aW9uc0FkdmFuY2VkID0gcXVlcnlTb2x1dGlvblZvLnF1ZXJ5Q29uZGl0aW9uc0FkdmFuY2VkXHJcbiAgICAgICAgICAgIC8vIGxldCBfYWR2YW5jZWRGbGF0Q29uZGl0aW9ucyA9IHRoaXMuZ2V0RmxhdENvbmRpdGlvbnMoX3F1ZXJ5Q29uZGl0aW9uc0FkdmFuY2VkKVxyXG4gICAgICAgICAgICAvLyBfYWR2YW5jZWRGbGF0Q29uZGl0aW9ucy5mb3JFYWNoKHZhbCA9PiB2YWwuY29uZGl0aW9uaWQgPSB2YWwuY29uZGl0aW9uaWQgKjIpXHJcbiAgICAgICAgICAgIGxldCBfcXVlcnlDb25kaXRpb25zQWR2YW5jZWQgPSB0aGlzLnNpbXBsaWZ5VHJlZURhdGEoY2xvbmVEZWVwKHF1ZXJ5U29sdXRpb25Wby5xdWVyeUNvbmRpdGlvbnNBZHZhbmNlZCkpXHJcbiAgICAgICAgICAgIGpvYmpbXCJhZHZhbmNlZFF1ZXJ5Q29uZGl0aW9uc1N0cmluZ1wiXSA9IEpTT04uc3RyaW5naWZ5KF9xdWVyeUNvbmRpdGlvbnNBZHZhbmNlZClcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgaWYgKHF1ZXJ5U29sdXRpb25Wby5xdWVyeUNvbmRpdGlvbnMgJiYgcXVlcnlTb2x1dGlvblZvLnF1ZXJ5Q29uZGl0aW9ucy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIGxldCBqQXJyYXkgPSBbXTtcclxuICAgICAgICAgICAgbGV0IGNvbnZlcnRvciA9IG5ldyBRdWVyeUNvbmRpdGlvbkNvbnZlcnQoKTtcclxuICAgICAgICAgICAgcXVlcnlTb2x1dGlvblZvLnF1ZXJ5Q29uZGl0aW9ucy5mb3JFYWNoKGVsZW1lbnQgPT4ge1xyXG4gICAgICAgICAgICAgICAgakFycmF5LnB1c2goY29udmVydG9yLmNvbnZlcnRKT2JqZWN0KGVsZW1lbnQpKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIC8v5ZCR5pyN5Yqh56uv5Y+R6YCB5pWw5o2u5pe277yM5Y+R6YCBcXVlcnkgY29uZGl0aW9uIGxpc3TnmoRqc29uIHN0cmluZ1xyXG4gICAgICAgICAgICBqb2JqW1wicXVlcnlDb25kaXRpb25TdHJpbmdcIl0gPSBKU09OLnN0cmluZ2lmeShqQXJyYXkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gam9iajtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOWPjeW6j+WIl+WMlijliJ3lp4vljJYpXHJcbiAgICAgKiBAcGFyYW0gam9iaiDmn6Xor6LmlrnmoYjluo/liJfljJblkI7nmoRPYmplY3RcclxuICAgICAqL1xyXG4gICAgaW5pdEZyb21Kb2JqZWN0KGpvYmo6IE9iamVjdCk6IFF1ZXJ5U29sdXRpb25WbyB7XHJcbiAgICAgICAgbGV0IHF1ZXJ5U29sdXRpb25WbyA9IG5ldyBRdWVyeVNvbHV0aW9uVm8oKTtcclxuICAgICAgICBxdWVyeVNvbHV0aW9uVm8uaWQgPSBqb2JqW1wiaWRcIl07XHJcbiAgICAgICAgcXVlcnlTb2x1dGlvblZvLmNvZGUgPSBqb2JqW1wiY29kZVwiXTtcclxuICAgICAgICBxdWVyeVNvbHV0aW9uVm8ubmFtZSA9IGpvYmpbXCJuYW1lXCJdO1xyXG4gICAgICAgIHF1ZXJ5U29sdXRpb25Wby5iZWxvbmdJZCA9IGpvYmpbXCJiZWxvbmdJZFwiXTtcclxuICAgICAgICBxdWVyeVNvbHV0aW9uVm8uaXNTeXN0ZW0gPSBqb2JqW1wiaXNTeXN0ZW1cIl07XHJcbiAgICAgICAgcXVlcnlTb2x1dGlvblZvLmlzRGVmYXVsdCA9IGpvYmpbXCJpc0RlZmF1bHRcIl07XHJcbiAgICAgICAgcXVlcnlTb2x1dGlvblZvLnR5cGUgPSBqb2JqLmhhc093blByb3BlcnR5KCd0eXBlJykgPyBqb2JqW1widHlwZVwiXSA6ICcnO1xyXG4gICAgICAgIHF1ZXJ5U29sdXRpb25Wby5leHRlbmRJZCA9IGpvYmouaGFzT3duUHJvcGVydHkoJ2V4dGVuZElkJykgPyBqb2JqW1wiZXh0ZW5kSWRcIl0gOiBcIlwiO1xyXG4gICAgICAgIHF1ZXJ5U29sdXRpb25Wby5xdWVyeUNvbmRpdGlvbnMgPSBuZXcgQXJyYXk8UXVlcnlDb25kaXRpb24+KCk7XHJcbiAgICAgICAgLy/pq5jnuqfmqKHlvI/mlrDlop5tb2RlLDHkuLrkvKDnu5/mqKHlvI/vvIwy5Li66auY57qn5qih5byPXHJcbiAgICAgICAgcXVlcnlTb2x1dGlvblZvLm1vZGUgPSBqb2JqW1wibW9kZVwiXSB8fCAxO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8v5pyN5Yqh5Zmo56uv6L+U5Zue55qEcXVlcnkgY29uZGl0aW9uIGxpc3Tlrp7pmYXmmK8ganNvbiBzdHJpbmdcclxuICAgICAgICBjb25zdCBxdWVyeUNvbmRpdGlvblN0cmluZyA9IGpvYmpbXCJxdWVyeUNvbmRpdGlvblN0cmluZ1wiXTtcclxuICAgICAgICBpZiAocXVlcnlDb25kaXRpb25TdHJpbmcpIHtcclxuICAgICAgICAgICAgY29uc3QgY29uZGl0aW9uSmFycnkgPSBKU09OLnBhcnNlKHF1ZXJ5Q29uZGl0aW9uU3RyaW5nKTtcclxuICAgICAgICAgICAgbGV0IGNvbnZlcnRvciA9IG5ldyBRdWVyeUNvbmRpdGlvbkNvbnZlcnQoKTtcclxuICAgICAgICAgICAgY29uZGl0aW9uSmFycnkuZm9yRWFjaChlbGVtZW50ID0+IHtcclxuICAgICAgICAgICAgICAgIHF1ZXJ5U29sdXRpb25Wby5xdWVyeUNvbmRpdGlvbnMucHVzaChjb252ZXJ0b3IuaW5pdEZyb21Kb2JqZWN0KGVsZW1lbnQpKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHF1ZXJ5U29sdXRpb25Wby5xdWVyeUNvbmRpdGlvbnNBZHZhbmNlZCA9IGpvYmpbXCJhZHZhbmNlZFF1ZXJ5Q29uZGl0aW9uc1N0cmluZ1wiXSA/IEpTT04ucGFyc2Uoam9ialtcImFkdmFuY2VkUXVlcnlDb25kaXRpb25zU3RyaW5nXCJdKSA6IG51bGw7XHJcblxyXG4gICAgICAgIHJldHVybiBxdWVyeVNvbHV0aW9uVm87XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIOS7jue8k+WtmOS4reWPluWbnueahEpTT07mlbDmja7pnIDopoHovazljJZcclxuICAgICAqIOS7juWkp+WGmei9rOaNouWIsOWwj+WGmeadoeS7tlxyXG4gICAgICovXHJcbiAgICBmb3JtYXRGcm9tSm9iamVjdChqb2JqOiBBcnJheTxhbnk+IHwgc3RyaW5nKTogQXJyYXk8UXVlcnlDb25kaXRpb24+IHtcclxuICAgICAgICBsZXQgcXVlcnlDb25kaXRpb25zID0gbmV3IEFycmF5PFF1ZXJ5Q29uZGl0aW9uPigpO1xyXG4gICAgICAgIGxldCBjb25kaXRpb25KYXJyeTtcclxuICAgICAgICBpZiAodHlwZW9mIGpvYmogPT0gJ3N0cmluZycpIHtcclxuICAgICAgICAgICAgY29uZGl0aW9uSmFycnkgPSBKU09OLnBhcnNlKGpvYmopO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGNvbmRpdGlvbkphcnJ5ID0gam9iajtcclxuICAgICAgICB9XHJcbiAgICAgICAgbGV0IGNvbnZlcnRvciA9IG5ldyBRdWVyeUNvbmRpdGlvbkNvbnZlcnQoKTtcclxuICAgICAgICBjb25kaXRpb25KYXJyeS5mb3JFYWNoKGVsZW1lbnQgPT4ge1xyXG4gICAgICAgICAgICBxdWVyeUNvbmRpdGlvbnMucHVzaChjb252ZXJ0b3IuaW5pdEZyb21Kb2JqZWN0KGVsZW1lbnQpKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4gcXVlcnlDb25kaXRpb25zO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiDlrZjlhaXnvJPlrZjkuK1cclxuICAgICAqIOS7juWkp+WGmei9rOaNouWIsOWwj+WGmeadoeS7tlxyXG4gICAgICovXHJcbiAgICBmb3JtYXRDb252ZXJ0Sk9iamVjdChqb2JqOiBBcnJheTxRdWVyeUNvbmRpdGlvbj4pOkFycmF5PGFueT57XHJcbiAgICAgICAgbGV0IHF1ZXJ5Q29uZGl0aW9ucyA9W107XHJcbiAgICAgICAgbGV0IGNvbnZlcnRvciA9IG5ldyBRdWVyeUNvbmRpdGlvbkNvbnZlcnQoKTtcclxuICAgICAgICBqb2JqLmZvckVhY2goZWxlbWVudCA9PiB7XHJcbiAgICAgICAgICAgIHF1ZXJ5Q29uZGl0aW9ucy5wdXNoKGNvbnZlcnRvci5jb252ZXJ0Sk9iamVjdChlbGVtZW50KSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIHF1ZXJ5Q29uZGl0aW9ucztcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOWwhumrmOe6p+aooeW8j+S4i+agkee7k+aehGNvbmRpdGlvbuaJgeW5s+WMllxyXG4gICAgICogQHBhcmFtIGRhdGEgXHJcbiAgICAgKiBAcmV0dXJucyBcclxuICAgICAqL1xyXG4gICAgZ2V0RmxhdENvbmRpdGlvbnMoZGF0YSkge1xyXG4gICAgICAgIGlmIChkYXRhLmNoaWxkcmVuKSB7XHJcbiAgICAgICAgICByZXR1cm4gW10uY29uY2F0KGRhdGEuaXRlbXMsIC4uLmRhdGEuY2hpbGRyZW4ubWFwKHZhbCA9PiB0aGlzLmdldEZsYXRDb25kaXRpb25zKHZhbCkpKVxyXG4gICAgXHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBbXS5jb25jYXQoZGF0YS5pdGVtcylcclxuICAgIFxyXG4gICAgICB9XHJcbiAgICAgIHNpbXBsaWZ5VHJlZURhdGEoZGF0YSkge1xyXG4gICAgICAgIGlmKGRhdGEuaXRlbXMgJiYgZGF0YS5pdGVtcy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgbGV0IF9pdGVtcyA9IGRhdGEuaXRlbXMubWFwKHZhbCA9PiAge3JldHVybiB7Y29uZGl0aW9uaWQ6IHZhbC5jb25kaXRpb25pZH19KVxyXG4gICAgICAgICAgICBkYXRhLml0ZW1zID0gX2l0ZW1zXHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmKGRhdGEuY2hpbGRyZW4pIHtcclxuICAgICAgICAgICAgZGF0YS5jaGlsZHJlbi5mb3JFYWNoKHZhbCA9PiB0aGlzLnNpbXBsaWZ5VHJlZURhdGEodmFsKSlcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGRhdGFcclxuICAgIH1cclxuICAgIGNvbXBsaWNhdGVUcmVlRGF0YShvcmlnaW5EYXRhLCBjb25kaXRpb25MaXN0KSB7XHJcbiAgICAgICAgXHJcbiAgICAgICAgbGV0IGhhbmRsZUZ1bmMgPSAodHJlZURhdGEpID0+IHtcclxuXHJcbiAgICAgICAgICAgIGlmICh0cmVlRGF0YS5pdGVtcyAmJiB0cmVlRGF0YS5pdGVtcy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgIHRyZWVEYXRhLml0ZW1zID0gdHJlZURhdGEuaXRlbXMubWFwKHZhbCA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IHRhcmdldCA9IGNvbmRpdGlvbkxpc3QuZmluZChpdGVtID0+IGl0ZW0uY29uZGl0aW9uaWQgPT09IHZhbC5jb25kaXRpb25pZClcclxuICAgICAgICAgICAgICAgICAgICBpZiAodGFyZ2V0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCByZXN1bHQgPSBjbG9uZURlZXAodGFyZ2V0KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQuZ3JvdXBpZCA9IHVuZGVmaW5lZFxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQuTGJyYWNrZXQgPSB1bmRlZmluZWRcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0LlJicmFja2V0ID0gdW5kZWZpbmVkXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHRcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGxcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYodHJlZURhdGEuY2hpbGRyZW4gJiYgdHJlZURhdGEuY2hpbGRyZW4ubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICB0cmVlRGF0YS5jaGlsZHJlbi5mb3JFYWNoKHZhbCA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgaGFuZGxlRnVuYyh2YWwpXHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8v5LuF5L6b6L+U5Zue6aG25bGC5pWw5o2u77yM6YGN5Y6G6L+H56iL5L2/55So5LiN5YiwXHJcbiAgICAgICAgICAgIHJldHVybiB0cmVlRGF0YVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gaGFuZGxlRnVuYyhvcmlnaW5EYXRhKVxyXG5cclxuICAgIH1cclxufSJdfQ==