/**
 * @fileoverview added by tsickle
 * Generated from: lib/controlcomponent/numberrangecomponent/numberrange.component.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, Input, Output, EventEmitter } from '@angular/core';
import { SolutionService } from '../../service/solution.service';
import { NumberRangeValue } from '../../entity/conditionvalue/numberrangevaue';
export class NumberRangeComponent {
    /**
     * @param {?} solutionService
     */
    constructor(solutionService) {
        this.solutionService = solutionService;
        /**
         * 某个字段发生值变化事件时，需要同步清空的字段，可能不是当前字段
         */
        this.changeFields = [];
        this.conditionChange = new EventEmitter();
    }
    /**
     * @param {?} changes
     * @return {?}
     */
    ngOnChanges(changes) {
        if (changes['changeFields'] && changes['changeFields'].currentValue && !changes['changeFields'].firstChange) {
            /** @type {?} */
            const isChange = changes['changeFields'].currentValue.some((/**
             * @param {?} field
             * @return {?}
             */
            field => field == this.item.fieldCode));
            if (isChange) {
                this.constructMultiFieldNumberRange((/** @type {?} */ (this.item.value)));
            }
        }
    }
    /**
     * @return {?}
     */
    ngOnInit() {
        this.testId = this.solutionService.getGuid();
        this.canNull = true;
        this.placeholder = (this.item.placeHolder) ? (this.item.placeHolder) : (this.item.control.placeholder);
        this.beginPlaceHolder = this.item.beginPlaceHolder ? this.item.beginPlaceHolder : this.placeholder;
        this.endPlaceHolder = this.item.endPlaceHolder ? this.item.endPlaceHolder : this.placeholder;
        this.precision = this.item.control.precision;
        this.textAlign = this.item.control.textAlign;
        this.bigNumber = this.item.control.bigNumber ? this.item.control.bigNumber : false;
        if (!this.bigNumber) {
            this.min = (this.item.control.min === undefined || this.item.control.min === null) ? -2147483648 : (this.item.control.min);
            this.max = (this.item.control.max === undefined || this.item.control.max === null) ? 2147483647 : (this.item.control.max);
        }
        this.constructMultiFieldNumberRange((/** @type {?} */ (this.item.value)));
    }
    /**
     * @param {?} data
     * @return {?}
     */
    valueChange(data) {
        if (typeof data !== 'string') {
            return;
        }
        /** @type {?} */
        const dataArray = data.split("~");
        /** @type {?} */
        const start = dataArray[0] && dataArray[0].length > 0 ? dataArray[0] : null;
        /** @type {?} */
        const end = dataArray[1] && dataArray[1].length > 0 ? dataArray[1] : null;
        if (!this.bigNumber) {
            this.item.value = new NumberRangeValue({ startValue: start, endValue: end });
        }
        else {
            /** @type {?} */
            const numberRangeValue = new NumberRangeValue();
            isNaN(parseFloat(start)) ? numberRangeValue.startValue = null : numberRangeValue.startValue = parseFloat(start);
            isNaN(parseFloat(end)) ? numberRangeValue.endValue = null : numberRangeValue.endValue = parseFloat(end);
            this.item.value = numberRangeValue;
        }
        this.conditionChange.emit();
    }
    // constructNumberRange(value: NumberRangeValue): string {
    //   return "a~b".replace(/a/, value.startValue ? value.startValue.toString().trim() : "").replace(/b/, value.endValue ? value.endValue.toString().trim() : "");
    // }
    /**
     * @param {?} value
     * @return {?}
     */
    constructMultiFieldNumberRange(value) {
        // this.beginValue = value && value.startValue ? value.startValue.toString().trim() : '';
        // this.endValue = value && value.endValue ? value.endValue.toString().trim() : '';
        this.beginValue = value.startValue == null ? null : value.startValue;
        this.endValue = value.endValue == null ? null : value.endValue;
    }
    // getConditionItemStyle(field: QueryCondition, controlType: any) {
    //     return this.solutionService.getConditionItemStyle(field,controlType);
    // }
    /**
     * @param {?} field
     * @return {?}
     */
    getConditionItemTitle(field) {
        return this.solutionService.getConditionItemTitle(field);
    }
    /**
     * @param {?} $event
     * @return {?}
     */
    beginValueChange($event) {
        this.beginValue = $event;
    }
    /**
     * @param {?} $event
     * @return {?}
     */
    endValueChange($event) {
        this.endValue = $event;
    }
}
NumberRangeComponent.decorators = [
    { type: Component, args: [{
                selector: 'app-solution-numberrange',
                template: "<div class=\"farris-group-wrap\" id=\"{{item.id}}\">\r\n  <div class=\"form-group farris-form-group  common-group number-range-group\" [ngClass]=\"{'q-state-readonly':item.readonly}\">\r\n    <label class=\"col-form-label\" *ngIf=\"item\" title=\"{{getConditionItemTitle(item)}}\">\r\n      <span class=\"farris-label-info text-danger\" *ngIf=\"item.control.isRequired()\">*</span>\r\n      <span class=\"farris-label-text\">{{item.fieldName}}</span>\r\n    </label>\r\n    <div class=\"farris-input-wrap\">\r\n      <farris-number-range *ngIf=\"!bigNumber\"\r\n        [beginValue]=\"beginValue\"\r\n        [endValue]=\"endValue\"\r\n        [min]=\"min\"\r\n        [max]=\"max\"\r\n        (beginValueChange)=\"beginValueChange($event)\"\r\n        (endValueChange)=\"endValueChange($event)\"\r\n        (valueChange)=\"valueChange($event)\" \r\n        id=\"{{testId}}\"\r\n        [canNull]=\"canNull\"\r\n        [bigNumber]=\"bigNumber\"\r\n        [placeholder]=\"placeholder\"\r\n        [precision]=\"precision\"\r\n        [textAlign]=\"textAlign\"\r\n        [readonly]=\"item.readonly\"\r\n        [beginPlaceHolder]=\"beginPlaceHolder\"\r\n        [endPlaceHolder]=\"endPlaceHolder\">\r\n      </farris-number-range>\r\n      <farris-number-range *ngIf=\"bigNumber\"\r\n        [beginValue]=\"beginValue\"\r\n        [endValue]=\"endValue\"\r\n        (beginValueChange)=\"beginValueChange($event)\"\r\n        (endValueChange)=\"endValueChange($event)\"\r\n        (valueChange)=\"valueChange($event)\" \r\n        id=\"{{testId}}\"\r\n        [canNull]=\"canNull\"\r\n        [bigNumber]=\"bigNumber\"\r\n        [placeholder]=\"placeholder\"\r\n        [precision]=\"precision\"\r\n        [textAlign]=\"textAlign\"\r\n        [readonly]=\"item.readonly\"        \r\n        [beginPlaceHolder]=\"beginPlaceHolder\"\r\n        [endPlaceHolder]=\"endPlaceHolder\">\r\n      </farris-number-range>\r\n    </div>\r\n  </div>\r\n</div>"
            }] }
];
/** @nocollapse */
NumberRangeComponent.ctorParameters = () => [
    { type: SolutionService }
];
NumberRangeComponent.propDecorators = {
    item: [{ type: Input }],
    changeFields: [{ type: Input }],
    conditionChange: [{ type: Output, args: ['conditionChange',] }]
};
if (false) {
    /** @type {?} */
    NumberRangeComponent.prototype.beginValue;
    /** @type {?} */
    NumberRangeComponent.prototype.endValue;
    /** @type {?} */
    NumberRangeComponent.prototype.testId;
    /** @type {?} */
    NumberRangeComponent.prototype.precision;
    /** @type {?} */
    NumberRangeComponent.prototype.textAlign;
    /** @type {?} */
    NumberRangeComponent.prototype.placeholder;
    /** @type {?} */
    NumberRangeComponent.prototype.item;
    /** @type {?} */
    NumberRangeComponent.prototype.canNull;
    /** @type {?} */
    NumberRangeComponent.prototype.bigNumber;
    /** @type {?} */
    NumberRangeComponent.prototype.min;
    /** @type {?} */
    NumberRangeComponent.prototype.max;
    /** @type {?} */
    NumberRangeComponent.prototype.beginPlaceHolder;
    /** @type {?} */
    NumberRangeComponent.prototype.endPlaceHolder;
    /**
     * 某个字段发生值变化事件时，需要同步清空的字段，可能不是当前字段
     * @type {?}
     */
    NumberRangeComponent.prototype.changeFields;
    /** @type {?} */
    NumberRangeComponent.prototype.conditionChange;
    /**
     * @type {?}
     * @private
     */
    NumberRangeComponent.prototype.solutionService;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibnVtYmVycmFuZ2UuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGZhcnJpcy9jb21wb25lbnQtcXVlcnljb25kaXRpb24vIiwic291cmNlcyI6WyJsaWIvY29udHJvbGNvbXBvbmVudC9udW1iZXJyYW5nZWNvbXBvbmVudC9udW1iZXJyYW5nZS5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQSxPQUFPLEVBQUUsU0FBUyxFQUFFLEtBQUssRUFBVSxNQUFNLEVBQUUsWUFBWSxFQUE0QixNQUFNLGVBQWUsQ0FBQztBQUV6RyxPQUFPLEVBQUUsZUFBZSxFQUFFLE1BQU0sZ0NBQWdDLENBQUM7QUFDakUsT0FBTyxFQUFFLGdCQUFnQixFQUE2QixNQUFNLDZDQUE2QyxDQUFDO0FBUTFHLE1BQU0sT0FBTyxvQkFBb0I7Ozs7SUF1Qi9CLFlBQW9CLGVBQWdDO1FBQWhDLG9CQUFlLEdBQWYsZUFBZSxDQUFpQjs7OztRQUozQyxpQkFBWSxHQUFrQixFQUFFLENBQUM7UUFFZixvQkFBZSxHQUFHLElBQUksWUFBWSxFQUFFLENBQUM7SUFFUixDQUFDOzs7OztJQUV6RCxXQUFXLENBQUMsT0FBc0I7UUFDaEMsSUFBRyxPQUFPLENBQUMsY0FBYyxDQUFDLElBQUksT0FBTyxDQUFDLGNBQWMsQ0FBQyxDQUFDLFlBQVksSUFBSSxDQUFDLE9BQU8sQ0FBQyxjQUFjLENBQUMsQ0FBQyxXQUFXLEVBQUU7O2tCQUNwRyxRQUFRLEdBQUcsT0FBTyxDQUFDLGNBQWMsQ0FBQyxDQUFDLFlBQVksQ0FBQyxJQUFJOzs7O1lBQUMsS0FBSyxDQUFDLEVBQUUsQ0FBQyxLQUFLLElBQUksSUFBSSxDQUFDLElBQUksQ0FBQyxTQUFTLEVBQUM7WUFDakcsSUFBRyxRQUFRLEVBQUM7Z0JBQ1YsSUFBSSxDQUFDLDhCQUE4QixDQUFDLG1CQUFBLElBQUksQ0FBQyxJQUFJLENBQUMsS0FBSyxFQUFvQixDQUFDLENBQUM7YUFDMUU7U0FDSjtJQUNELENBQUM7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QXFCLENBQUMsS0FBSyxDQUFDLENBQUM7SUFDM0QsQ0FBQzs7Ozs7SUFFRCxnQkFBZ0IsQ0FBQyxNQUFNO1FBQ3JCLElBQUksQ0FBQyxVQUFVLEdBQUcsTUFBTSxDQUFDO0lBQzNCLENBQUM7Ozs7O0lBRUQsY0FBYyxDQUFDLE1BQU07UUFDbkIsSUFBSSxDQUFDLFFBQVEsR0FBRyxNQUFNLENBQUM7SUFDekIsQ0FBQzs7O1lBbEdGLFNBQVMsU0FBQztnQkFDVCxRQUFRLEVBQUUsMEJBQTBCO2dCQUNwQyx3NkRBQTJDO2FBQzVDOzs7O1lBUFEsZUFBZTs7O21CQWlCckIsS0FBSzsyQkFXTCxLQUFLOzhCQUVMLE1BQU0sU0FBQyxpQkFBaUI7Ozs7SUFuQnpCLDBDQUFnQjs7SUFDaEIsd0NBQWM7O0lBQ2Qsc0NBQWU7O0lBQ2YseUNBQWtCOztJQUNsQix5Q0FBa0I7O0lBQ2xCLDJDQUFvQjs7SUFDcEIsb0NBQW1COztJQUNuQix1Q0FBaUI7O0lBQ2pCLHlDQUFtQjs7SUFDbkIsbUNBQVk7O0lBQ1osbUNBQVk7O0lBQ1osZ0RBQXdCOztJQUN4Qiw4Q0FBc0I7Ozs7O0lBS3RCLDRDQUEwQzs7SUFFMUMsK0NBQWdFOzs7OztJQUVwRCwrQ0FBd0MiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb21wb25lbnQsIElucHV0LCBPbkluaXQsIE91dHB1dCwgRXZlbnRFbWl0dGVyLCBPbkNoYW5nZXMsIFNpbXBsZUNoYW5nZXMgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgUXVlcnlDb25kaXRpb24gfSBmcm9tICcuLi8uLi9lbnRpdHkvcXVlcnljb25kaXRpb24nO1xyXG5pbXBvcnQgeyBTb2x1dGlvblNlcnZpY2UgfSBmcm9tICcuLi8uLi9zZXJ2aWNlL3NvbHV0aW9uLnNlcnZpY2UnO1xyXG5pbXBvcnQgeyBOdW1iZXJSYW5nZVZhbHVlLCBOdW1iZXJSYW5nZVZhbHVlQ29udmVydG9yIH0gZnJvbSAnLi4vLi4vZW50aXR5L2NvbmRpdGlvbnZhbHVlL251bWJlcnJhbmdldmF1ZSc7XHJcblxyXG5cclxuQENvbXBvbmVudCh7XHJcbiAgc2VsZWN0b3I6ICdhcHAtc29sdXRpb24tbnVtYmVycmFuZ2UnLFxyXG4gIHRlbXBsYXRlVXJsOiAnLi9udW1iZXJyYW5nZS5jb21wb25lbnQuaHRtbCcsXHJcbn0pXHJcblxyXG5leHBvcnQgY2xhc3MgTnVtYmVyUmFuZ2VDb21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQsIE9uQ2hhbmdlcyB7XHJcbiAgLy8gbnVtYmVyUmFuZ2U6IHN0cmluZztcclxuICBiZWdpblZhbHVlOiBhbnk7XHJcbiAgZW5kVmFsdWU6IGFueTtcclxuICB0ZXN0SWQ6IHN0cmluZztcclxuICBwcmVjaXNpb246IG51bWJlcjtcclxuICB0ZXh0QWxpZ246IHN0cmluZztcclxuICBwbGFjZWhvbGRlcjogc3RyaW5nO1xyXG4gIEBJbnB1dCgpIGl0ZW06IGFueTtcclxuICBjYW5OdWxsOiBib29sZWFuO1xyXG4gIGJpZ051bWJlcjogYm9vbGVhbjtcclxuICBtaW46IG51bWJlcjtcclxuICBtYXg6IG51bWJlcjtcclxuICBiZWdpblBsYWNlSG9sZGVyOnN0cmluZztcclxuICBlbmRQbGFjZUhvbGRlcjpzdHJpbmc7XHJcblxyXG4gIC8qKlxyXG4gICAqIOafkOS4quWtl+auteWPkeeUn+WAvOWPmOWMluS6i+S7tuaXtu+8jOmcgOimgeWQjOatpea4heepuueahOWtl+aute+8jOWPr+iDveS4jeaYr+W9k+WJjeWtl+autVxyXG4gICAqL1xyXG4gIEBJbnB1dCgpIGNoYW5nZUZpZWxkczogQXJyYXk8c3RyaW5nPiA9IFtdO1xyXG5cclxuICBAT3V0cHV0KCdjb25kaXRpb25DaGFuZ2UnKSBjb25kaXRpb25DaGFuZ2UgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XHJcblxyXG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgc29sdXRpb25TZXJ2aWNlOiBTb2x1dGlvblNlcnZpY2UpIHsgfVxyXG5cclxuICBuZ09uQ2hhbmdlcyhjaGFuZ2VzOiBTaW1wbGVDaGFuZ2VzKTogdm9pZCB7XHJcbiAgICBpZihjaGFuZ2VzWydjaGFuZ2VGaWVsZHMnXSAmJiBjaGFuZ2VzWydjaGFuZ2VGaWVsZHMnXS5jdXJyZW50VmFsdWUgJiYgIWNoYW5nZXNbJ2NoYW5nZUZpZWxkcyddLmZpcnN0Q2hhbmdlKSB7XHJcbiAgICAgIGNvbnN0IGlzQ2hhbmdlID0gY2hhbmdlc1snY2hhbmdlRmllbGRzJ10uY3VycmVudFZhbHVlLnNvbWUoZmllbGQgPT4gZmllbGQgPT0gdGhpcy5pdGVtLmZpZWxkQ29kZSk7XHJcbiAgICAgIGlmKGlzQ2hhbmdlKXtcclxuICAgICAgICB0aGlzLmNvbnN0cnVjdE11bHRpRmllbGROdW1iZXJSYW5nZSh0aGlzLml0ZW0udmFsdWUgYXMgTnVtYmVyUmFuZ2VWYWx1ZSk7XHJcbiAgICAgIH1cclxuICB9XHJcbiAgfVxyXG5cclxuICBuZ09uSW5pdCgpOiB2b2lkIHtcclxuICAgIHRoaXMudGVzdElkID0gdGhpcy5zb2x1dGlvblNlcnZpY2UuZ2V0R3VpZCgpO1xyXG4gICAgdGhpcy5jYW5OdWxsID0gdHJ1ZTtcclxuICAgIHRoaXMucGxhY2Vob2xkZXIgPSAodGhpcy5pdGVtLnBsYWNlSG9sZGVyKSA/ICh0aGlzLml0ZW0ucGxhY2VIb2xkZXIpIDogKHRoaXMuaXRlbS5jb250cm9sLnBsYWNlaG9sZGVyKTtcclxuICAgIHRoaXMuYmVnaW5QbGFjZUhvbGRlcj10aGlzLml0ZW0uYmVnaW5QbGFjZUhvbGRlcj90aGlzLml0ZW0uYmVnaW5QbGFjZUhvbGRlcjp0aGlzLnBsYWNlaG9sZGVyO1xyXG4gICAgdGhpcy5lbmRQbGFjZUhvbGRlcj10aGlzLml0ZW0uZW5kUGxhY2VIb2xkZXI/dGhpcy5pdGVtLmVuZFBsYWNlSG9sZGVyOnRoaXMucGxhY2Vob2xkZXI7XHJcbiAgICB0aGlzLnByZWNpc2lvbiA9IHRoaXMuaXRlbS5jb250cm9sLnByZWNpc2lvbjtcclxuICAgIHRoaXMudGV4dEFsaWduID0gdGhpcy5pdGVtLmNvbnRyb2wudGV4dEFsaWduO1xyXG4gICAgdGhpcy5iaWdOdW1iZXIgPSB0aGlzLml0ZW0uY29udHJvbC5iaWdOdW1iZXIgPyB0aGlzLml0ZW0uY29udHJvbC5iaWdOdW1iZXIgOiBmYWxzZTtcclxuICAgIGlmKCF0aGlzLmJpZ051bWJlcil7XHJcbiAgICAgIHRoaXMubWluID0gKHRoaXMuaXRlbS5jb250cm9sLm1pbiA9PT0gdW5kZWZpbmVkIHx8IHRoaXMuaXRlbS5jb250cm9sLm1pbiA9PT0gbnVsbCkgPyAtMjE0NzQ4MzY0OCA6ICh0aGlzLml0ZW0uY29udHJvbC5taW4pO1xyXG4gICAgICB0aGlzLm1heCA9ICh0aGlzLml0ZW0uY29udHJvbC5tYXggPT09IHVuZGVmaW5lZCB8fCB0aGlzLml0ZW0uY29udHJvbC5tYXggPT09IG51bGwpID8gMjE0NzQ4MzY0NyA6ICh0aGlzLml0ZW0uY29udHJvbC5tYXgpO1xyXG4gICAgfVxyXG4gICAgdGhpcy5jb25zdHJ1Y3RNdWx0aUZpZWxkTnVtYmVyUmFuZ2UodGhpcy5pdGVtLnZhbHVlIGFzIE51bWJlclJhbmdlVmFsdWUpO1xyXG4gIH1cclxuXHJcbiAgdmFsdWVDaGFuZ2UoZGF0YTogYW55KSB7XHJcbiAgICBpZih0eXBlb2YgZGF0YSAhPT0gJ3N0cmluZycpIHtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgY29uc3QgZGF0YUFycmF5ID0gZGF0YS5zcGxpdChcIn5cIik7XHJcbiAgICBjb25zdCBzdGFydCA9IGRhdGFBcnJheVswXSAmJiBkYXRhQXJyYXlbMF0ubGVuZ3RoID4gMCA/IGRhdGFBcnJheVswXSA6IG51bGw7XHJcbiAgICBjb25zdCBlbmQgPSBkYXRhQXJyYXlbMV0gJiYgZGF0YUFycmF5WzFdLmxlbmd0aCA+IDAgPyBkYXRhQXJyYXlbMV0gOiBudWxsO1xyXG4gICAgaWYoIXRoaXMuYmlnTnVtYmVyKSB7XHJcbiAgICAgIHRoaXMuaXRlbS52YWx1ZSA9IG5ldyBOdW1iZXJSYW5nZVZhbHVlKHtzdGFydFZhbHVlOiBzdGFydCwgZW5kVmFsdWU6IGVuZH0pO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgY29uc3QgbnVtYmVyUmFuZ2VWYWx1ZSA9IG5ldyBOdW1iZXJSYW5nZVZhbHVlKCk7XHJcbiAgICAgIGlzTmFOKHBhcnNlRmxvYXQoc3RhcnQpKSA/IG51bWJlclJhbmdlVmFsdWUuc3RhcnRWYWx1ZSA9IG51bGwgOiBudW1iZXJSYW5nZVZhbHVlLnN0YXJ0VmFsdWUgPSBwYXJzZUZsb2F0KHN0YXJ0KTtcclxuICAgICAgaXNOYU4ocGFyc2VGbG9hdChlbmQpKSA/IG51bWJlclJhbmdlVmFsdWUuZW5kVmFsdWUgPSBudWxsIDogbnVtYmVyUmFuZ2VWYWx1ZS5lbmRWYWx1ZSA9IHBhcnNlRmxvYXQoZW5kKTtcclxuICAgICAgdGhpcy5pdGVtLnZhbHVlID0gbnVtYmVyUmFuZ2VWYWx1ZTtcclxuICAgIH1cclxuICAgIHRoaXMuY29uZGl0aW9uQ2hhbmdlLmVtaXQoKTtcclxuICB9XHJcblxyXG4gIC8vIGNvbnN0cnVjdE51bWJlclJhbmdlKHZhbHVlOiBOdW1iZXJSYW5nZVZhbHVlKTogc3RyaW5nIHtcclxuICAvLyAgIHJldHVybiBcImF+YlwiLnJlcGxhY2UoL2EvLCB2YWx1ZS5zdGFydFZhbHVlID8gdmFsdWUuc3RhcnRWYWx1ZS50b1N0cmluZygpLnRyaW0oKSA6IFwiXCIpLnJlcGxhY2UoL2IvLCB2YWx1ZS5lbmRWYWx1ZSA/IHZhbHVlLmVuZFZhbHVlLnRvU3RyaW5nKCkudHJpbSgpIDogXCJcIik7XHJcbiAgLy8gfVxyXG5cclxuICBjb25zdHJ1Y3RNdWx0aUZpZWxkTnVtYmVyUmFuZ2UodmFsdWU6IE51bWJlclJhbmdlVmFsdWUpIHtcclxuICAgIC8vIHRoaXMuYmVnaW5WYWx1ZSA9IHZhbHVlICYmIHZhbHVlLnN0YXJ0VmFsdWUgPyB2YWx1ZS5zdGFydFZhbHVlLnRvU3RyaW5nKCkudHJpbSgpIDogJyc7XHJcbiAgICAvLyB0aGlzLmVuZFZhbHVlID0gdmFsdWUgJiYgdmFsdWUuZW5kVmFsdWUgPyB2YWx1ZS5lbmRWYWx1ZS50b1N0cmluZygpLnRyaW0oKSA6ICcnO1xyXG4gICAgdGhpcy5iZWdpblZhbHVlID0gdmFsdWUuc3RhcnRWYWx1ZSA9PSBudWxsID8gbnVsbCA6IHZhbHVlLnN0YXJ0VmFsdWU7XHJcbiAgICB0aGlzLmVuZFZhbHVlID0gdmFsdWUuZW5kVmFsdWUgPT0gbnVsbCA/IG51bGwgOiB2YWx1ZS5lbmRWYWx1ZTtcclxuICB9XHJcblxyXG4gIC8vIGdldENvbmRpdGlvbkl0ZW1TdHlsZShmaWVsZDogUXVlcnlDb25kaXRpb24sIGNvbnRyb2xUeXBlOiBhbnkpIHtcclxuICAvLyAgICAgcmV0dXJuIHRoaXMuc29sdXRpb25TZXJ2aWNlLmdldENvbmRpdGlvbkl0ZW1TdHlsZShmaWVsZCxjb250cm9sVHlwZSk7XHJcbiAgLy8gfVxyXG5cclxuICBnZXRDb25kaXRpb25JdGVtVGl0bGUoZmllbGQ6IFF1ZXJ5Q29uZGl0aW9uKSB7XHJcbiAgICByZXR1cm4gdGhpcy5zb2x1dGlvblNlcnZpY2UuZ2V0Q29uZGl0aW9uSXRlbVRpdGxlKGZpZWxkKTtcclxuICB9XHJcblxyXG4gIGJlZ2luVmFsdWVDaGFuZ2UoJGV2ZW50KSB7XHJcbiAgICB0aGlzLmJlZ2luVmFsdWUgPSAkZXZlbnQ7XHJcbiAgfVxyXG5cclxuICBlbmRWYWx1ZUNoYW5nZSgkZXZlbnQpIHtcclxuICAgIHRoaXMuZW5kVmFsdWUgPSAkZXZlbnQ7XHJcbiAgfVxyXG59XHJcbiJdfQ==