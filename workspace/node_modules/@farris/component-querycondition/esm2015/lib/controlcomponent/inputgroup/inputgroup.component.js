/**
 * @fileoverview added by tsickle
 * Generated from: lib/controlcomponent/inputgroup/inputgroup.component.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, Input, EventEmitter, Output } from '@angular/core';
import { SolutionService } from '../../service/solution.service';
export class InputGroupComponent {
    /**
     * @param {?} solutionService
     */
    constructor(solutionService) {
        this.solutionService = solutionService;
        this.hideLabel = false;
        this.conditionChange = new EventEmitter();
        //控件内显示文本是否为弹窗返回的文本，手动输入或者手动做出修改时为false
        this.isTextFromDialog = false;
    }
    /**
     * @param {?} inputGroupItem
     * @return {?}
     */
    set item(inputGroupItem) {
        this._inputItem = inputGroupItem;
    }
    /**
     * @return {?}
     */
    get item() {
        return this.constructInputGroupItem(this._inputItem);
    }
    /**
     * @param {?} inputGroupItem
     * @return {?}
     */
    constructInputGroupItem(inputGroupItem) {
        /** @type {?} */
        const inputGroupValueObj = (/** @type {?} */ (inputGroupItem.value));
        // inputGroupValueObj.textValue = inputGroupValueObj.textValue && inputGroupValueObj.textValue.trim();
        inputGroupValueObj.textValue = inputGroupValueObj.textValue && inputGroupValueObj.textValue;
        inputGroupItem.value = inputGroupValueObj;
        return inputGroupItem;
    }
    /**
     * @return {?}
     */
    ngOnInit() {
        this.testId = this.solutionService.getGuid();
        this.getInputGroupBindingInfo();
    }
    /**
     * @return {?}
     */
    ngOnDestroy() {
        this.item = null;
    }
    /**
     * @return {?}
     */
    getInputGroupBindingInfo() {
        /** @type {?} */
        const inputGroupControl = ((/** @type {?} */ (this.item.control)));
        this.usageMode = inputGroupControl.usageMode;
        if (this.usageMode == 'open-modal' || this.usageMode == 'open-remote-modal') {
            this.dialogOptions = inputGroupControl.dialogOptions;
            /*
                example of dialogOptions = {
                   modalId: "1e011720-eb0f-4c9c-82b6-6844c89b2303"
                   mapFields: {hDepartment: "Name"}
                   title: "测试标题栏"
                   width: 800
                   height: 600
                }
             */
            if (this.dialogOptions.mapFields) {
                this.textField = JSON.stringify(this.dialogOptions.mapFields).split('"')[1];
            }
        }
    }
    /**
     * @param {?} field
     * @return {?}
     */
    getConditionItemTitle(field) {
        return this.solutionService.getConditionItemTitle(field);
    }
    /**
     * @param {?} event
     * @return {?}
     */
    onClick(event) {
        if (this.usageMode == 'text') {
            this.item.control.click();
        }
        else {
            /** @type {?} */
            const options = this.dialogOptions;
            options.handle = (/**
             * @param {?} selectedItem
             * @return {?}
             */
            (selectedItem) => {
                if (selectedItem && this.textField) {
                    this.item.value.value = selectedItem;
                    this.item.value.textValue = this.item.value.getTextValue(this.textField);
                    this.item.value.textField = this.textField;
                    this.item.value.isInputText = false;
                    this.isTextFromDialog = true;
                    this.textFormDialog = this.item.value.textValue;
                    this.onBlur();
                }
            });
            this.item.control.click({ event, options });
        }
    }
    /**
     * @return {?}
     */
    onBlur() {
        if (this.usageMode == 'text') {
            this.item.value.isInputText = true;
        }
        if (this.usageMode == 'open-modal' || this.usageMode == 'open-remote-modal') {
            if (!this.isTextFromDialog) {
                //console.log('弹窗模式下控件内文本是手动输入的');
                this.item.value.isInputText = true;
            }
            if (this.item.value.textValue != this.textFormDialog) {
                //console.log('通过弹窗选择的值已被手动修改');
                this.isTextFromDialog = false;
                this.item.value.value = [];
                this.item.value.textField = undefined;
                this.item.value.isInputText = true;
            }
        }
        this.conditionChange.emit();
    }
    /**
     * @return {?}
     */
    clearData() {
        ((/** @type {?} */ (this.item.value))).clearValue();
        this.conditionChange.emit();
    }
}
InputGroupComponent.decorators = [
    { type: Component, args: [{
                selector: 'app-solution-inputgroup',
                template: "<div class=\"farris-group-wrap\" id=\"{{item.id}}\">\r\n    <div class=\"form-group farris-form-group  common-group\"  [ngClass]=\"{'q-state-readonly':item.readonly}\">\r\n        <label class=\"col-form-label\" *ngIf=\"item && !hideLabel\" title=\"{{getConditionItemTitle(item)}}\">\r\n            <span class=\"farris-label-info text-danger\" *ngIf=\"item.control.isRequired()\">*</span>\r\n            <span class=\"farris-label-text\">{{item.fieldName}}</span>\r\n        </label>\r\n        <div class=\"farris-input-wrap\">\r\n            <input-group \r\n                [(ngModel)]=\"item.value.textValue\" \r\n                name=\"{{item.fieldName}}\" \r\n                id=\"{{testId}}\"\r\n                [groupText]=\"item.control.groupText\"\r\n                [editable]=\"item.control.editable\"\r\n                [placeholder]=\"item.placeHolder\"\r\n                [readonly]=\"item.readonly\"\r\n                (clickHandle)=\"onClick($event)\"\r\n                (blurHandle)=\"onBlur()\"\r\n                (clear)=\"clearData()\">\r\n            </input-group>\r\n        </div>\r\n    </div>\r\n</div>"
            }] }
];
/** @nocollapse */
InputGroupComponent.ctorParameters = () => [
    { type: SolutionService }
];
InputGroupComponent.propDecorators = {
    hideLabel: [{ type: Input }],
    item: [{ type: Input }],
    conditionChange: [{ type: Output, args: ['conditionChange',] }]
};
if (false) {
    /** @type {?} */
    InputGroupComponent.prototype.hideLabel;
    /**
     * QueryCondition类型
     * @type {?}
     */
    InputGroupComponent.prototype._inputItem;
    /** @type {?} */
    InputGroupComponent.prototype.conditionChange;
    /** @type {?} */
    InputGroupComponent.prototype.testId;
    /** @type {?} */
    InputGroupComponent.prototype.usageMode;
    /** @type {?} */
    InputGroupComponent.prototype.dialogOptions;
    /** @type {?} */
    InputGroupComponent.prototype.textField;
    /** @type {?} */
    InputGroupComponent.prototype.isTextFromDialog;
    /** @type {?} */
    InputGroupComponent.prototype.textFormDialog;
    /**
     * @type {?}
     * @private
     */
    InputGroupComponent.prototype.solutionService;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5wdXRncm91cC5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZmFycmlzL2NvbXBvbmVudC1xdWVyeWNvbmRpdGlvbi8iLCJzb3VyY2VzIjpbImxpYi9jb250cm9sY29tcG9uZW50L2lucHV0Z3JvdXAvaW5wdXRncm91cC5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQSxPQUFPLEVBQUUsU0FBUyxFQUFFLEtBQUssRUFBVSxZQUFZLEVBQUUsTUFBTSxFQUFhLE1BQU0sZUFBZSxDQUFDO0FBRTFGLE9BQU8sRUFBRSxlQUFlLEVBQUUsTUFBTSxnQ0FBZ0MsQ0FBQztBQVVqRSxNQUFNLE9BQU8sbUJBQW1COzs7O0lBdUM1QixZQUFvQixlQUErQjtRQUEvQixvQkFBZSxHQUFmLGVBQWUsQ0FBZ0I7UUFyQzFDLGNBQVMsR0FBVyxLQUFLLENBQUE7UUFlUCxvQkFBZSxHQUFHLElBQUksWUFBWSxFQUFFLENBQUM7O1FBVWhFLHFCQUFnQixHQUFZLEtBQUssQ0FBQztJQVltQixDQUFDOzs7OztJQTlCdEQsSUFDSSxJQUFJLENBQUMsY0FBbUI7UUFDeEIsSUFBSSxDQUFDLFVBQVUsR0FBRyxjQUFjLENBQUM7SUFDckMsQ0FBQzs7OztJQUNELElBQUksSUFBSTtRQUNKLE9BQU8sSUFBSSxDQUFDLHVCQUF1QixDQUFDLElBQUksQ0FBQyxVQUFVLENBQUMsQ0FBQztJQUN6RCxDQUFDOzs7OztJQWdCRCx1QkFBdUIsQ0FBQyxjQUE4Qjs7Y0FDNUMsa0JBQWtCLEdBQUcsbUJBQUEsY0FBYyxDQUFDLEtBQUssRUFBbUI7UUFDbEUsc0dBQXNHO1FBQ3RHLGtCQUFrQixDQUFDLFNBQVMsR0FBRyxrQkFBa0IsQ0FBQyxTQUFTLElBQUksa0JBQWtCLENBQUMsU0FBUyxDQUFDO1FBQzVGLGNBQWMsQ0FBQyxLQUFLLEdBQUcsa0JBQWtCLENBQUM7UUFDMUMsT0FBTyxjQUFjLENBQUM7SUFDMUIsQ0FBQzs7OztJQUlELFFBQVE7UUFDSixJ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QzthQUN0QztZQUNELElBQUcsSUFBSSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsU0FBUyxJQUFJLElBQUksQ0FBQyxjQUFjLEVBQUM7Z0JBQ2hELGdDQUFnQztnQkFDaEMsSUFBSSxDQUFDLGdCQUFnQixHQUFHLEtBQUssQ0FBQztnQkFDOUIsSUFBSSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsS0FBSyxHQUFHLEVBQUUsQ0FBQztnQkFDM0IsSUFBSSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsU0FBUyxHQUFHLFNBQVMsQ0FBQztnQkFDdEMsSUFBSSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsV0FBVyxHQUFHLElBQUksQ0FBQzthQUN0QztTQUNKO1FBQ0QsSUFBSSxDQUFDLGVBQWUsQ0FBQyxJQUFJLEVBQUUsQ0FBQztJQUNoQyxDQUFDOzs7O0lBRUQsU0FBUztRQUNMLENBQUMsbUJBQUEsSUFBSSxDQUFDLElBQUksQ0FBQyxLQUFLLEVBQW1CLENBQUMsQ0FBQyxVQUFVLEVBQUUsQ0FBQztRQUNsRCxJQUFJLENBQUMsZUFBZSxDQUFDLElBQUksRUFBRSxDQUFDO0lBQ2hDLENBQUM7OztZQTVISixTQUFTLFNBQUM7Z0JBQ1AsUUFBUSxFQUFFLHlCQUF5QjtnQkFDbkMsc25DQUEwQzthQUM3Qzs7OztZQVJRLGVBQWU7Ozt3QkFZbkIsS0FBSzttQkFPTCxLQUFLOzhCQVFMLE1BQU0sU0FBQyxpQkFBaUI7Ozs7SUFmekIsd0NBQWtDOzs7OztJQUtsQyx5Q0FBMkI7O0lBVTNCLDhDQUFnRTs7SUFFaEUscUNBQWU7O0lBRWYsd0NBQWtCOztJQUVsQiw0Q0FBbUI7O0lBRW5CLHdDQUFrQjs7SUFFbEIsK0NBQWtDOztJQUVsQyw2Q0FBdUI7Ozs7O0lBVVgsOENBQXVDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ29tcG9uZW50LCBJbnB1dCwgT25Jbml0LCBFdmVudEVtaXR0ZXIsIE91dHB1dCwgT25EZXN0cm95IH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IFF1ZXJ5Q29uZGl0aW9uIH0gZnJvbSAnLi4vLi4vZW50aXR5L3F1ZXJ5Y29uZGl0aW9uJztcclxuaW1wb3J0IHsgU29sdXRpb25TZXJ2aWNlIH0gZnJvbSAnLi4vLi4vc2VydmljZS9zb2x1dGlvbi5zZXJ2aWNlJztcclxuaW1wb3J0IHsgSW5wdXRHcm91cENvbnRyb2wgfSBmcm9tICcuLi8uLi9lbnRpdHkvY29udHJvbHR5cGUvaW5wdXQtZ3JvdXAvaW5wdXRncm91cGNvbnRyb2wnO1xyXG5pbXBvcnQgeyBJbnB1dEdyb3VwVmFsdWUgfSBmcm9tICcuLi8uLi9lbnRpdHkvY29uZGl0aW9udmFsdWUvaW5wdXRncm91cHZhbHVlJztcclxuXHJcblxyXG5AQ29tcG9uZW50KHtcclxuICAgIHNlbGVjdG9yOiAnYXBwLXNvbHV0aW9uLWlucHV0Z3JvdXAnLFxyXG4gICAgdGVtcGxhdGVVcmw6ICcuL2lucHV0Z3JvdXAuY29tcG9uZW50Lmh0bWwnLFxyXG59KVxyXG5cclxuZXhwb3J0IGNsYXNzIElucHV0R3JvdXBDb21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQsIE9uRGVzdHJveSB7XHJcblxyXG4gICAgQElucHV0KCkgaGlkZUxhYmVsOmJvb2xlYW4gPSBmYWxzZVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogUXVlcnlDb25kaXRpb27nsbvlnotcclxuICAgICAqL1xyXG4gICAgX2lucHV0SXRlbTogUXVlcnlDb25kaXRpb247XHJcblxyXG4gICAgQElucHV0KClcclxuICAgIHNldCBpdGVtKGlucHV0R3JvdXBJdGVtOiBhbnkpIHtcclxuICAgICAgICB0aGlzLl9pbnB1dEl0ZW0gPSBpbnB1dEdyb3VwSXRlbTtcclxuICAgIH1cclxuICAgIGdldCBpdGVtKCk6IGFueXtcclxuICAgICAgICByZXR1cm4gdGhpcy5jb25zdHJ1Y3RJbnB1dEdyb3VwSXRlbSh0aGlzLl9pbnB1dEl0ZW0pO1xyXG4gICAgfVxyXG5cclxuICAgIEBPdXRwdXQoJ2NvbmRpdGlvbkNoYW5nZScpIGNvbmRpdGlvbkNoYW5nZSA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcclxuICAgIC8v57uE5Lu2aWRcclxuICAgIHRlc3RJZDogc3RyaW5nO1xyXG4gICAgLy/kvb/nlKjmqKHlvI/vvIzmlofmnKx0ZXh05oiW6ICF5by556qXb3Blbi1tb2RhbFxyXG4gICAgdXNhZ2VNb2RlOiBzdHJpbmc7XHJcbiAgICAvL+W8ueeql+WRveS7pOmcgOimgeaOpeaUtueahOWPguaVsFxyXG4gICAgZGlhbG9nT3B0aW9uczogYW55O1xyXG4gICAgLy/lvLnnqpfmqKHlvI/kuIvvvIzlj5bliJfooajkuK3lk6rkuKrlrZfmrrXnmoTlgLzmmKDlsITliLDlvZPliY3lrZfmrrVcclxuICAgIHRleHRGaWVsZDogc3RyaW5nO1xyXG4gICAgLy/mjqfku7blhoXmmL7npLrmlofmnKzmmK/lkKbkuLrlvLnnqpfov5Tlm57nmoTmlofmnKzvvIzmiYvliqjovpPlhaXmiJbogIXmiYvliqjlgZrlh7rkv67mlLnml7bkuLpmYWxzZVxyXG4gICAgaXNUZXh0RnJvbURpYWxvZzogYm9vbGVhbiA9IGZhbHNlO1xyXG4gICAgLy/lvLnnqpfov5Tlm57nmoTmlofmnKxcclxuICAgIHRleHRGb3JtRGlhbG9nOiBzdHJpbmc7XHJcblxyXG4gICAgY29uc3RydWN0SW5wdXRHcm91cEl0ZW0oaW5wdXRHcm91cEl0ZW06IFF1ZXJ5Q29uZGl0aW9uKTogUXVlcnlDb25kaXRpb24ge1xyXG4gICAgICAgIGNvbnN0IGlucHV0R3JvdXBWYWx1ZU9iaiA9IGlucHV0R3JvdXBJdGVtLnZhbHVlIGFzIElucHV0R3JvdXBWYWx1ZTtcclxuICAgICAgICAvLyBpbnB1dEdyb3VwVmFsdWVPYmoudGV4dFZhbHVlID0gaW5wdXRHcm91cFZhbHVlT2JqLnRleHRWYWx1ZSAmJiBpbnB1dEdyb3VwVmFsdWVPYmoudGV4dFZhbHVlLnRyaW0oKTtcclxuICAgICAgICBpbnB1dEdyb3VwVmFsdWVPYmoudGV4dFZhbHVlID0gaW5wdXRHcm91cFZhbHVlT2JqLnRleHRWYWx1ZSAmJiBpbnB1dEdyb3VwVmFsdWVPYmoudGV4dFZhbHVlO1xyXG4gICAgICAgIGlucHV0R3JvdXBJdGVtLnZhbHVlID0gaW5wdXRHcm91cFZhbHVlT2JqO1xyXG4gICAgICAgIHJldHVybiBpbnB1dEdyb3VwSXRlbTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdHJ1Y3Rvcihwcml2YXRlIHNvbHV0aW9uU2VydmljZTpTb2x1dGlvblNlcnZpY2Upe31cclxuXHJcbiAgICBuZ09uSW5pdCgpOiB2b2lkIHtcclxuICAgICAgICB0aGlzLnRlc3RJZCA9IHRoaXMuc29sdXRpb25TZXJ2aWNlLmdldEd1aWQoKTtcclxuICAgICAgICB0aGlzLmdldElucHV0R3JvdXBCaW5kaW5nSW5mbygpO1xyXG4gICAgfVxyXG5cclxuICAgIG5nT25EZXN0cm95KCk6IHZvaWQge1xyXG4gICAgICAgIHRoaXMuaXRlbSA9IG51bGw7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0SW5wdXRHcm91cEJpbmRpbmdJbmZvKCkge1xyXG4gICAgICAgIGNvbnN0IGlucHV0R3JvdXBDb250cm9sID0gKHRoaXMuaXRlbS5jb250cm9sIGFzIElucHV0R3JvdXBDb250cm9sKTtcclxuICAgICAgICB0aGlzLnVzYWdlTW9kZSA9IGlucHV0R3JvdXBDb250cm9sLnVzYWdlTW9kZTtcclxuICAgICAgICBpZih0aGlzLnVzYWdlTW9kZSA9PSAnb3Blbi1tb2RhbCd8fHRoaXMudXNhZ2VNb2RlID09ICdvcGVuLXJlbW90ZS1tb2RhbCcpIHtcclxuICAgICAgICAgICAgdGhpcy5kaWFsb2dPcHRpb25zID0gaW5wdXRHcm91cENvbnRyb2wuZGlhbG9nT3B0aW9ucztcclxuICAgICAgICAgICAgLypcclxuICAgICAgICAgICAgICAgIGV4YW1wbGUgb2YgZGlhbG9nT3B0aW9ucyA9IHtcclxuICAgICAgICAgICAgICAgICAgIG1vZGFsSWQ6IFwiMWUwMTE3MjAtZWIwZi00YzljLTgyYjYtNjg0NGM4OWIyMzAzXCJcclxuICAgICAgICAgICAgICAgICAgIG1hcEZpZWxkczoge2hEZXBhcnRtZW50OiBcIk5hbWVcIn1cclxuICAgICAgICAgICAgICAgICAgIHRpdGxlOiBcIua1i+ivleagh+mimOagj1wiXHJcbiAgICAgICAgICAgICAgICAgICB3aWR0aDogODAwXHJcbiAgICAgICAgICAgICAgICAgICBoZWlnaHQ6IDYwMFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgKi9cclxuICAgICAgICAgICAgaWYodGhpcy5kaWFsb2dPcHRpb25zLm1hcEZpZWxkcyl7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnRleHRGaWVsZCA9IEpTT04uc3RyaW5naWZ5KHRoaXMuZGlhbG9nT3B0aW9ucy5tYXBGaWVsZHMpLnNwbGl0KCdcIicpWzFdO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGdldENvbmRpdGlvbkl0ZW1UaXRsZShmaWVsZDpRdWVyeUNvbmRpdGlvbil7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuc29sdXRpb25TZXJ2aWNlLmdldENvbmRpdGlvbkl0ZW1UaXRsZShmaWVsZCk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIG9uQ2xpY2soZXZlbnQ6IGFueSl7XHJcbiAgICAgICAgaWYodGhpcy51c2FnZU1vZGUgPT0gJ3RleHQnKXtcclxuICAgICAgICAgICAgdGhpcy5pdGVtLmNvbnRyb2wuY2xpY2soKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZXtcclxuICAgICAgICAgICAgY29uc3Qgb3B0aW9ucyA9IHRoaXMuZGlhbG9nT3B0aW9ucztcclxuICAgICAgICAgICAgb3B0aW9ucy5oYW5kbGUgPSAoc2VsZWN0ZWRJdGVtKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZihzZWxlY3RlZEl0ZW0gJiYgdGhpcy50ZXh0RmllbGQpe1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaXRlbS52YWx1ZS52YWx1ZSA9IHNlbGVjdGVkSXRlbTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLml0ZW0udmFsdWUudGV4dFZhbHVlID0gdGhpcy5pdGVtLnZhbHVlLmdldFRleHRWYWx1ZSh0aGlzLnRleHRGaWVsZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5pdGVtLnZhbHVlLnRleHRGaWVsZCA9IHRoaXMudGV4dEZpZWxkO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaXRlbS52YWx1ZS5pc0lucHV0VGV4dCA9IGZhbHNlO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmlzVGV4dEZyb21EaWFsb2cgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMudGV4dEZvcm1EaWFsb2cgPSB0aGlzLml0ZW0udmFsdWUudGV4dFZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMub25CbHVyKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5pdGVtLmNvbnRyb2wuY2xpY2soe2V2ZW50LCBvcHRpb25zfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIG9uQmx1cigpe1xyXG4gICAgICAgIGlmKHRoaXMudXNhZ2VNb2RlID09ICd0ZXh0Jykge1xyXG4gICAgICAgICAgICB0aGlzLml0ZW0udmFsdWUuaXNJbnB1dFRleHQgPSB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZih0aGlzLnVzYWdlTW9kZSA9PSAnb3Blbi1tb2RhbCd8fHRoaXMudXNhZ2VNb2RlID09ICdvcGVuLXJlbW90ZS1tb2RhbCcpIHtcclxuICAgICAgICAgICAgaWYoIXRoaXMuaXNUZXh0RnJvbURpYWxvZykge1xyXG4gICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZygn5by556qX5qih5byP5LiL5o6n5Lu25YaF5paH5pys5piv5omL5Yqo6L6T5YWl55qEJyk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLml0ZW0udmFsdWUuaXNJbnB1dFRleHQgPSB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmKHRoaXMuaXRlbS52YWx1ZS50ZXh0VmFsdWUgIT0gdGhpcy50ZXh0Rm9ybURpYWxvZyl7XHJcbiAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKCfpgJrov4flvLnnqpfpgInmi6nnmoTlgLzlt7LooqvmiYvliqjkv67mlLknKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuaXNUZXh0RnJvbURpYWxvZyA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5pdGVtLnZhbHVlLnZhbHVlID0gW107XHJcbiAgICAgICAgICAgICAgICB0aGlzLml0ZW0udmFsdWUudGV4dEZpZWxkID0gdW5kZWZpbmVkO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5pdGVtLnZhbHVlLmlzSW5wdXRUZXh0ID0gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmNvbmRpdGlvbkNoYW5nZS5lbWl0KCk7XHJcbiAgICB9XHJcblxyXG4gICAgY2xlYXJEYXRhKCkge1xyXG4gICAgICAgICh0aGlzLml0ZW0udmFsdWUgYXMgSW5wdXRHcm91cFZhbHVlKS5jbGVhclZhbHVlKCk7XHJcbiAgICAgICAgdGhpcy5jb25kaXRpb25DaGFuZ2UuZW1pdCgpO1xyXG4gICAgfVxyXG59Il19