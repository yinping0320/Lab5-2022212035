/**
 * @fileoverview added by tsickle
 * Generated from: lib/controlcomponent/smarthelp/smarthelp.component.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, Input, Output, EventEmitter, ViewChild } from '@angular/core';
import { SolutionService } from '../../service/solution.service';
import { LookupGridComponent } from '@farris/ui-lookup';
import { of } from 'rxjs';
export class SolutionSmartHelpComponent {
    /**
     * @param {?} solutionService
     */
    constructor(solutionService) {
        this.solutionService = solutionService;
        this.hideLabel = false;
        /**
         * 某个字段发生值变化事件时，需要同步清空的字段，可能不是当前字段
         */
        this.changeFields = [];
        this.conditionChange = new EventEmitter();
        this.mappingEmitter = new EventEmitter();
        this.clearFieldsChange = new EventEmitter();
        /**
         * 每页记录数
         */
        this.pageSize = 20;
        /**
         * 可用分页记录数列表
         */
        this.pageList = [10, 20, 30, 50, 100];
        // 启用多字段查询
        this.enableMultiFieldSearch = false;
        this.onBeforeOpen = (/**
         * @return {?}
         */
        () => {
            /** @type {?} */
            const t = (/** @type {?} */ (this.item.value));
            if (t && t.value) {
                /** @type {?} */
                const ids = t.value.map((/**
                 * @param {?} n
                 * @return {?}
                 */
                n => n[this.idField || 'id'])).join(',');
                this.lookup.displayValue = ids;
            }
            this.clearFieldsChange.emit({
                controlType: ((/** @type {?} */ (this.item.control))).getControlType(),
                canClearRelatedFields: true
            });
            return of(true);
        });
    }
    /**
     * @return {?}
     */
    ngOnInit() {
        this.getSmartHelpBindingInfo();
        //this.testId = this.solutionService.getGuid();
        this.testId = this.instanceId;
        this.placeholder = (this.item.placeHolder) ? (this.item.placeHolder) : (this.item.control.placeholder);
        this.lookup.textChanged.subscribe((/**
         * @param {?} v
         * @return {?}
         */
        (v) => {
            this.textChangedHandler(v);
        }));
    }
    /**
     * @param {?} changes
     * @return {?}
     */
    ngOnChanges(changes) {
        this.getSmartHelpBindingInfo();
        if (changes['changeFields'] && changes['changeFields'].currentValue && !changes['changeFields'].firstChange) {
            /** @type {?} */
            const isChange = changes['changeFields'].currentValue.some((/**
             * @param {?} field
             * @return {?}
             */
            field => field == this.item.fieldCode));
            if (isChange) {
                this.textValue = ((/** @type {?} */ (this.item.value))).textValue;
            }
        }
    }
    //ITEM：
    //control: SmartHelpContol {uri: "WuLiao.wOrgId", textField: "name", valueField: "code", mapFields: {}, idField: "id"}
    // fieldCode: "wOrgId"
    // fieldName: "所属机构"
    // id: "WuLiao.wOrgId"
    // value: SmartHelpValue {valueField: null, value: null}
    // valueType: 0
    /**
     * @return {?}
     */
    getSmartHelpBindingInfo() {
        /** @type {?} */
        const smartHelpControl = ((/** @type {?} */ (this.item.control)));
        this.uri = smartHelpControl.uri;
        this.textField = smartHelpControl.textField;
        this.idField = smartHelpControl.idField;
        this.valueField = smartHelpControl.valueField;
        this.displayType = smartHelpControl.displayType;
        this.mapFields = smartHelpControl.mapFields;
        this.context = smartHelpControl.context;
        this.preEventCmd = smartHelpControl.preEventCmd;
        this.postEventCmd = smartHelpControl.postEventCmd;
        this.enableFullTree = smartHelpControl.enableFullTree;
        this.loadTreeDataType = smartHelpControl.loadTreeDataType;
        this.singleSelect = smartHelpControl.singleSelect === false ? false : true;
        this.expandLevel = smartHelpControl.expandLevel;
        this.enableCascade = smartHelpControl.enableCascade;
        this.cascadeStatus = smartHelpControl.cascadeStatus ? smartHelpControl.cascadeStatus : 'enable';
        // 标题
        this.dialogTitle = smartHelpControl.dialogTitle ? smartHelpControl.dialogTitle : '';
        // 宽度
        this.dialogWidth = smartHelpControl.panelWidth;
        // 高度
        this.dialogHeight = smartHelpControl.panelHeight;
        /** @type {?} */
        const smartHelpValue = ((/** @type {?} */ (this.item.value)));
        if (smartHelpValue.textValue == 'help-text-value-null') { //旧数据兼容
            this.textValue = smartHelpValue.getTextValue(this.textField);
        }
        else {
            this.textValue = smartHelpValue.textValue;
        }
        this.nosearch = smartHelpControl.nosearch; //默认false
        this.displayFields = smartHelpControl.displayFields ? smartHelpControl.displayFields : '';
        this.displayTextSeparator = smartHelpControl.displayTextSeparator ? smartHelpControl.displayTextSeparator : '_';
        this.editable = smartHelpControl.editable;
        this.clearFields = smartHelpControl.clearFields;
        if (smartHelpControl.hasOwnProperty('pageSize') && smartHelpControl.pageSize) {
            this.pageSize = smartHelpControl.pageSize;
        }
        if (smartHelpControl.hasOwnProperty('pageList') && smartHelpControl.pageList) {
            this.pageList = smartHelpControl.pageList.split(",").map((/**
             * @param {?} item
             * @return {?}
             */
            item => { return parseInt(item); }));
        }
        if (smartHelpControl.hasOwnProperty('quickSelect') && smartHelpControl.quickSelect) {
            this.quickSelect = smartHelpControl.quickSelect;
        }
        if (smartHelpControl.hasOwnProperty('enableMultiFieldSearch') && smartHelpControl.enableMultiFieldSearch) {
            this.enableMultiFieldSearch = smartHelpControl.enableMultiFieldSearch;
        }
    }
    /**
     * @param {?} data
     * @return {?}
     */
    clearData(data) {
        ((/** @type {?} */ (this.item.value))).clearValue();
        if (this.item.control.clear) {
            this.item.control.clear();
        }
        this.conditionChange.emit();
    }
    /**
     * @param {?} field
     * @return {?}
     */
    getConditionItemTitle(field) {
        return this.solutionService.getConditionItemTitle(field);
    }
    /**
     * selectedItem
     * code: "code02"
     * id: "id02"
     * name: "机构02"
     * version: "2019-10-21T00:00:00"
     * @param {?} data
     * @return {?}
     */
    textChangedHandler(data) {
        if (this.item && this.item.value) {
            /** @type {?} */
            const helpValue = ((/** @type {?} */ (this.item.value)));
            helpValue.value = [data];
            helpValue.textValue = data;
            helpValue.isInputText = true;
            // this.textValue = helpValue.textValue;
            this.conditionChange.emit();
        }
    }
    /**
     * @param {?} selectedItem
     * @return {?}
     */
    selectedDataHandler(selectedItem) {
        //选择时触发
        /** @type {?} */
        const helpValue = ((/** @type {?} */ (this.item.value)));
        helpValue.value = this.singleSelect ? [selectedItem] : selectedItem; //单选返回对象，多选返回数组
        helpValue.valueField = this.valueField;
        helpValue.textValue = this.textValue;
        helpValue.isInputText = false;
        this.conditionChange.emit();
    }
}
SolutionSmartHelpComponent.decorators = [
    { type: Component, args: [{
                selector: 'app-solution-smarthelp',
                template: "<div class=\"farris-group-wrap\" id=\"{{item.id}}\" >\r\n    <div class=\"form-group farris-form-group common-group\" [ngClass]=\"{'q-state-readonly':item.readonly}\">\r\n        <label class=\"col-form-label\" title=\"{{getConditionItemTitle(item)}}\" *ngIf=\"item && !hideLabel\">\r\n            <span class=\"farris-label-info text-danger\" *ngIf=\"item.control.isRequired()\">*</span>\r\n            <span class=\"farris-label-text\">{{item.fieldName}}</span>\r\n        </label>\r\n        <div class=\"farris-input-wrap\">\r\n            <farris-lookup-grid #lookup\r\n                id=\"{{testId}}\"                \r\n                [clear-fields]=\"clearFields\"\r\n                [uri]=\"uri\"\r\n                [placeholder]=\"placeholder\"\r\n                [(ngModel)]=\"textValue\"\r\n                [textField]=\"textField\"\r\n                [valueField]=\"valueField\"\r\n                [idField]=\"idField\"\r\n                [mapFields]=\"mapFields\"\r\n                [displayType]=\"displayType\"\r\n                [title]=\"dialogTitle\"\r\n                [dialogWidth]=\"dialogWidth\"\r\n                [dialogHeight]=\"dialogHeight\"\r\n                [context]=\"context\"\r\n                [dictPicking]=\"preEventCmd\"\r\n                [dictPicked]=\"postEventCmd\"\r\n                [enableFullTree]=\"enableFullTree\"\r\n                [loadTreeDataType]=\"loadTreeDataType\"\r\n                [singleSelect]=\"singleSelect\"\r\n                [expandLevel]=\"expandLevel\"\r\n                [enableCascade]=\"enableCascade\"\r\n                [cascadeStatus]=\"cascadeStatus\"\r\n                [readonly]=\"item.readonly\"\r\n                [nosearch]=\"nosearch\"\r\n                [beforeOpen]=\"onBeforeOpen\"\r\n                [displayFields]=\"displayFields\"\r\n                [displayTextSeparator]=\"displayTextSeparator\"\r\n                [editable]=\"editable\"\r\n                [pageSize]=\"pageSize\"\r\n                [pageList]=\"pageList\"\r\n                [useFavorite]=\"true\"\r\n                [quickSelect]=\"quickSelect\"\r\n                [enableMultiFieldSearch]=\"enableMultiFieldSearch\"\r\n                (selectedData)=\"selectedDataHandler($event)\"\r\n                (clear)=\"clearData($event)\"\r\n            >\r\n        </farris-lookup-grid>\r\n        <!-- [singleSelect]=\"true\" -->\r\n        </div>\r\n\r\n    </div>\r\n</div>"
            }] }
];
/** @nocollapse */
SolutionSmartHelpComponent.ctorParameters = () => [
    { type: SolutionService }
];
SolutionSmartHelpComponent.propDecorators = {
    hideLabel: [{ type: Input }],
    item: [{ type: Input }],
    changeFields: [{ type: Input }],
    instanceId: [{ type: Input }],
    conditionChange: [{ type: Output, args: ['conditionChange',] }],
    mappingEmitter: [{ type: Output, args: ['helpMapping',] }],
    clearFieldsChange: [{ type: Output, args: ['clearFieldsChange',] }],
    lookup: [{ type: ViewChild, args: ['lookup',] }]
};
if (false) {
    /** @type {?} */
    SolutionSmartHelpComponent.prototype.hideLabel;
    /**
     * QueryCondition类型
     * @type {?}
     */
    SolutionSmartHelpComponent.prototype.item;
    /**
     * 某个字段发生值变化事件时，需要同步清空的字段，可能不是当前字段
     * @type {?}
     */
    SolutionSmartHelpComponent.prototype.changeFields;
    /** @type {?} */
    SolutionSmartHelpComponent.prototype.instanceId;
    /** @type {?} */
    SolutionSmartHelpComponent.prototype.conditionChange;
    /** @type {?} */
    SolutionSmartHelpComponent.prototype.mappingEmitter;
    /** @type {?} */
    SolutionSmartHelpComponent.prototype.clearFieldsChange;
    /** @type {?} */
    SolutionSmartHelpComponent.prototype.lookup;
    /** @type {?} */
    SolutionSmartHelpComponent.prototype.uri;
    /** @type {?} */
    SolutionSmartHelpComponent.prototype.textField;
    /** @type {?} */
    SolutionSmartHelpComponent.prototype.mapFields;
    /** @type {?} */
    SolutionSmartHelpComponent.prototype.idField;
    /** @type {?} */
    SolutionSmartHelpComponent.prototype.valueField;
    /** @type {?} */
    SolutionSmartHelpComponent.prototype.textValue;
    /** @type {?} */
    SolutionSmartHelpComponent.prototype.displayType;
    /** @type {?} */
    SolutionSmartHelpComponent.prototype.context;
    /** @type {?} */
    SolutionSmartHelpComponent.prototype.preEventCmd;
    /** @type {?} */
    SolutionSmartHelpComponent.prototype.postEventCmd;
    /** @type {?} */
    SolutionSmartHelpComponent.prototype.loadTreeDataType;
    /** @type {?} */
    SolutionSmartHelpComponent.prototype.enableFullTree;
    /** @type {?} */
    SolutionSmartHelpComponent.prototype.singleSelect;
    /** @type {?} */
    SolutionSmartHelpComponent.prototype.expandLevel;
    /** @type {?} */
    SolutionSmartHelpComponent.prototype.enableCascade;
    /** @type {?} */
    SolutionSmartHelpComponent.prototype.cascadeStatus;
    /** @type {?} */
    SolutionSmartHelpComponent.prototype.testId;
    /** @type {?} */
    SolutionSmartHelpComponent.prototype.placeholder;
    /** @type {?} */
    SolutionSmartHelpComponent.prototype.nosearch;
    /** @type {?} */
    SolutionSmartHelpComponent.prototype.displayFields;
    /** @type {?} */
    SolutionSmartHelpComponent.prototype.displayTextSeparator;
    /** @type {?} */
    SolutionSmartHelpComponent.prototype.editable;
    /** @type {?} */
    SolutionSmartHelpComponent.prototype.clearFields;
    /** @type {?} */
    SolutionSmartHelpComponent.prototype.dialogTitle;
    /** @type {?} */
    SolutionSmartHelpComponent.prototype.dialogWidth;
    /** @type {?} */
    SolutionSmartHelpComponent.prototype.dialogHeight;
    /**
     * 每页记录数
     * @type {?}
     */
    SolutionSmartHelpComponent.prototype.pageSize;
    /**
     * 可用分页记录数列表
     * @type {?}
     */
    SolutionSmartHelpComponent.prototype.pageList;
    /** @type {?} */
    SolutionSmartHelpComponent.prototype.quickSelect;
    /** @type {?} */
    SolutionSmartHelpComponent.prototype.enableMultiFieldSearch;
    /** @type {?} */
    SolutionSmartHelpComponent.prototype.onBeforeOpen;
    /**
     * @type {?}
     * @private
     */
    SolutionSmartHelpComponent.prototype.solutionService;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic21hcnRoZWxwLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BmYXJyaXMvY29tcG9uZW50LXF1ZXJ5Y29uZGl0aW9uLyIsInNvdXJjZXMiOlsibGliL2NvbnRyb2xjb21wb25lbnQvc21hcnRoZWxwL3NtYXJ0aGVscC5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQSxPQUFPLEVBQUUsU0FBUyxFQUFFLEtBQUssRUFBcUIsTUFBTSxFQUFFLFlBQVksRUFBWSxTQUFTLEVBQWlCLE1BQU0sZUFBZSxDQUFDO0FBTTlILE9BQU8sRUFBRSxlQUFlLEVBQUUsTUFBTSxnQ0FBZ0MsQ0FBQztBQUNqRSxPQUFPLEVBQUUsbUJBQW1CLEVBQUUsTUFBTSxtQkFBbUIsQ0FBQztBQUN4RCxPQUFPLEVBQUUsRUFBRSxFQUFFLE1BQU0sTUFBTSxDQUFDO0FBTzFCLE1BQU0sT0FBTywwQkFBMEI7Ozs7SUErRG5DLFlBQW9CLGVBQWdDO1FBQWhDLG9CQUFlLEdBQWYsZUFBZSxDQUFpQjtRQTdEM0MsY0FBUyxHQUFXLEtBQUssQ0FBQTs7OztRQVd6QixpQkFBWSxHQUFrQixFQUFFLENBQUM7UUFJZixvQkFBZSxHQUFHLElBQUksWUFBWSxFQUFFLENBQUM7UUFFekMsbUJBQWMsR0FBRyxJQUFJLFlBQVksRUFBRSxDQUFDO1FBRTlCLHNCQUFpQixHQUFHLElBQUksWUFBWSxFQUFFLENBQUM7Ozs7UUFrQ3BFLGFBQVEsR0FBVyxFQUFFLENBQUM7Ozs7UUFFdEIsYUFBUSxHQUFrQixDQUFDLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxHQUFHLENBQUMsQ0FBQzs7UUFJaEQsMkJBQXNCLEdBQVksS0FBSyxDQUFDO1FBZ0Z4QyxpQkFBWTs7O1FBQUcsR0FBRyxFQUFFOztrQkFDVixDQUFDLEdBQUcsbUJBQUEsSUFBSSxDQUFDLElBQUksQ0FBQyxLQUFLLEVBQWtCO1lBQzNDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FB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Ozs7OztJQUVyQiw4Q0FBc0I7Ozs7O0lBRXRCLDhDQUFnRDs7SUFFaEQsaURBQStCOztJQUUvQiw0REFBd0M7O0lBZ0Z4QyxrREFXQzs7Ozs7SUF6RlcscURBQXdDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ29tcG9uZW50LCBJbnB1dCwgT25Jbml0LCBPbkNoYW5nZXMsIE91dHB1dCwgRXZlbnRFbWl0dGVyLCBJbmplY3RvciwgVmlld0NoaWxkLCBTaW1wbGVDaGFuZ2VzIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IFF1ZXJ5Q29uZGl0aW9uIH0gZnJvbSAnLi4vLi4vZW50aXR5L3F1ZXJ5Y29uZGl0aW9uJztcclxuaW1wb3J0IHsgQ29udHJvbFR5cGUgfSBmcm9tICcuLi8uLi9lbnRpdHkvY29udHJvbHR5cGUnO1xyXG5pbXBvcnQgeyBRdWlja1NlbGVjdE9wdGlvbiwgU21hcnRIZWxwQ29udG9sIH0gZnJvbSAnLi4vLi4vZW50aXR5L2NvbnRyb2x0eXBlL3NtYXJ0aGVscC9zbWFydGhlbHBjb250cm9sJztcclxuaW1wb3J0IHsgSUNvbnRyb2wgfSBmcm9tICcuLi8uLi9lbnRpdHkvY29udHJvbHR5cGUvaWNvbnRyb2wnO1xyXG5pbXBvcnQgeyBTbWFydEhlbHBWYWx1ZSB9IGZyb20gJy4uLy4uL2VudGl0eS9jb25kaXRpb252YWx1ZS9zbWFydGhlbHB2YWx1ZSc7XHJcbmltcG9ydCB7IFNvbHV0aW9uU2VydmljZSB9IGZyb20gJy4uLy4uL3NlcnZpY2Uvc29sdXRpb24uc2VydmljZSc7XHJcbmltcG9ydCB7IExvb2t1cEdyaWRDb21wb25lbnQgfSBmcm9tICdAZmFycmlzL3VpLWxvb2t1cCc7XHJcbmltcG9ydCB7IG9mIH0gZnJvbSAncnhqcyc7XHJcblxyXG5AQ29tcG9uZW50KHtcclxuICAgIHNlbGVjdG9yOiAnYXBwLXNvbHV0aW9uLXNtYXJ0aGVscCcsXHJcbiAgICB0ZW1wbGF0ZVVybDogJy4vc21hcnRoZWxwLmNvbXBvbmVudC5odG1sJyxcclxufSlcclxuXHJcbmV4cG9ydCBjbGFzcyBTb2x1dGlvblNtYXJ0SGVscENvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCwgT25DaGFuZ2VzIHtcclxuXHJcbiAgICBASW5wdXQoKSBoaWRlTGFiZWw6Ym9vbGVhbiA9IGZhbHNlXHJcblxyXG5cclxuICAgIC8qKlxyXG4gICAgICogUXVlcnlDb25kaXRpb27nsbvlnotcclxuICAgICAqL1xyXG4gICAgQElucHV0KCkgaXRlbTogYW55O1xyXG5cclxuICAgIC8qKlxyXG4gICAgICog5p+Q5Liq5a2X5q615Y+R55Sf5YC85Y+Y5YyW5LqL5Lu25pe277yM6ZyA6KaB5ZCM5q2l5riF56m655qE5a2X5q6177yM5Y+v6IO95LiN5piv5b2T5YmN5a2X5q61XHJcbiAgICAgKi9cclxuICAgIEBJbnB1dCgpIGNoYW5nZUZpZWxkczogQXJyYXk8c3RyaW5nPiA9IFtdO1xyXG5cclxuICAgIEBJbnB1dCgpIGluc3RhbmNlSWQ6IHN0cmluZztcclxuXHJcbiAgICBAT3V0cHV0KCdjb25kaXRpb25DaGFuZ2UnKSBjb25kaXRpb25DaGFuZ2UgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XHJcblxyXG4gICAgQE91dHB1dCgnaGVscE1hcHBpbmcnKSBtYXBwaW5nRW1pdHRlciA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcclxuXHJcbiAgICBAT3V0cHV0KCdjbGVhckZpZWxkc0NoYW5nZScpIGNsZWFyRmllbGRzQ2hhbmdlID0gbmV3IEV2ZW50RW1pdHRlcigpO1xyXG5cclxuICAgIEBWaWV3Q2hpbGQoJ2xvb2t1cCcpIGxvb2t1cDogTG9va3VwR3JpZENvbXBvbmVudDtcclxuXHJcbiAgICB1cmk6IHN0cmluZztcclxuICAgIHRleHRGaWVsZDogc3RyaW5nO1xyXG4gICAgbWFwRmllbGRzOiBhbnk7XHJcbiAgICBpZEZpZWxkOiBhbnk7XHJcbiAgICB2YWx1ZUZpZWxkOiBhbnk7XHJcbiAgICB0ZXh0VmFsdWU6IGFueTtcclxuICAgIGRpc3BsYXlUeXBlOiBhbnk7XHJcbiAgICBjb250ZXh0OiBhbnk7XHJcbiAgICBwcmVFdmVudENtZDogYW55O1xyXG4gICAgcG9zdEV2ZW50Q21kOiBhbnk7XHJcbiAgICBsb2FkVHJlZURhdGFUeXBlOiBzdHJpbmc7XHJcbiAgICBlbmFibGVGdWxsVHJlZTogYm9vbGVhbjtcclxuICAgIHNpbmdsZVNlbGVjdDogYm9vbGVhbjtcclxuICAgIGV4cGFuZExldmVsOiBudW1iZXI7XHJcbiAgICBlbmFibGVDYXNjYWRlOiBib29sZWFuO1xyXG4gICAgY2FzY2FkZVN0YXR1czogXCJlbmFibGVcIiB8IFwidXBcIiB8IFwiZG93blwiIHwgXCJkaXNhYmxlXCI7XHJcbiAgICB0ZXN0SWQ6IHN0cmluZztcclxuICAgIHBsYWNlaG9sZGVyOiBzdHJpbmc7XHJcbiAgICBub3NlYXJjaDogYm9vbGVhbjtcclxuICAgIGRpc3BsYXlGaWVsZHM6IHN0cmluZztcclxuICAgIGRpc3BsYXlUZXh0U2VwYXJhdG9yOiBzdHJpbmc7XHJcbiAgICBlZGl0YWJsZTogYm9vbGVhbjtcclxuICAgIGNsZWFyRmllbGRzOiBzdHJpbmc7XHJcbiAgICAvLyDmoIfpophcclxuICAgIGRpYWxvZ1RpdGxlOiBzdHJpbmc7XHJcbiAgICAvLyDlrr3luqZcclxuICAgIGRpYWxvZ1dpZHRoOiBudW1iZXI7XHJcbiAgICAvLyDpq5jluqZcclxuICAgIGRpYWxvZ0hlaWdodDogbnVtYmVyO1xyXG4gICAgLyoqIOavj+mhteiusOW9leaVsCAqL1xyXG4gICAgcGFnZVNpemU6IG51bWJlciA9IDIwO1xyXG4gICAgLyoqIOWPr+eUqOWIhumhteiusOW9leaVsOWIl+ihqCAqL1xyXG4gICAgcGFnZUxpc3Q6IEFycmF5PG51bWJlcj4gPSBbMTAsIDIwLCAzMCwgNTAsIDEwMF07XHJcbiAgICAvLyDlv6vmjbfpgInmi6nphY3nva5cclxuICAgIHF1aWNrU2VsZWN0OiBRdWlja1NlbGVjdE9wdGlvbjtcclxuICAgIC8vIOWQr+eUqOWkmuWtl+auteafpeivolxyXG4gICAgZW5hYmxlTXVsdGlGaWVsZFNlYXJjaDogYm9vbGVhbiA9IGZhbHNlO1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKHByaXZhdGUgc29sdXRpb25TZXJ2aWNlOiBTb2x1dGlvblNlcnZpY2UpIHsgfVxyXG5cclxuICAgIG5nT25Jbml0KCk6IHZvaWQge1xyXG4gICAgICAgIHRoaXMuZ2V0U21hcnRIZWxwQmluZGluZ0luZm8oKTtcclxuICAgICAgICAvL3RoaXMudGVzdElkID0gdGhpcy5zb2x1dGlvblNlcnZpY2UuZ2V0R3VpZCgpO1xyXG4gICAgICAgIHRoaXMudGVzdElkID0gdGhpcy5pbnN0YW5jZUlkO1xyXG4gICAgICAgIHRoaXMucGxhY2Vob2xkZXIgPSAodGhpcy5pdGVtLnBsYWNlSG9sZGVyKSA/ICh0aGlzLml0ZW0ucGxhY2VIb2xkZXIpIDogKHRoaXMuaXRlbS5jb250cm9sLnBsYWNlaG9sZGVyKTtcclxuXHJcbiAgICAgICAgdGhpcy5sb29rdXAudGV4dENoYW5nZWQuc3Vic2NyaWJlKCh2KSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMudGV4dENoYW5nZWRIYW5kbGVyKHYpO1xyXG4gICAgICAgIH0pXHJcbiAgICB9XHJcblxyXG4gICAgbmdPbkNoYW5nZXMoY2hhbmdlczogU2ltcGxlQ2hhbmdlcyk6IHZvaWQge1xyXG4gICAgICAgIHRoaXMuZ2V0U21hcnRIZWxwQmluZGluZ0luZm8oKTtcclxuICAgICAgICBpZiAoY2hhbmdlc1snY2hhbmdlRmllbGRzJ10gJiYgY2hhbmdlc1snY2hhbmdlRmllbGRzJ10uY3VycmVudFZhbHVlICYmICFjaGFuZ2VzWydjaGFuZ2VGaWVsZHMnXS5maXJzdENoYW5nZSkge1xyXG4gICAgICAgICAgICBjb25zdCBpc0NoYW5nZSA9IGNoYW5nZXNbJ2NoYW5nZUZpZWxkcyddLmN1cnJlbnRWYWx1ZS5zb21lKGZpZWxkID0+IGZpZWxkID09IHRoaXMuaXRlbS5maWVsZENvZGUpO1xyXG4gICAgICAgICAgICBpZiAoaXNDaGFuZ2UpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMudGV4dFZhbHVlID0gKHRoaXMuaXRlbS52YWx1ZSBhcyBTbWFydEhlbHBWYWx1ZSkudGV4dFZhbHVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8vSVRFTe+8mlxyXG4gICAgLy9jb250cm9sOiBTbWFydEhlbHBDb250b2wge3VyaTogXCJXdUxpYW8ud09yZ0lkXCIsIHRleHRGaWVsZDogXCJuYW1lXCIsIHZhbHVlRmllbGQ6IFwiY29kZVwiLCBtYXBGaWVsZHM6IHt9LCBpZEZpZWxkOiBcImlkXCJ9XHJcbiAgICAvLyBmaWVsZENvZGU6IFwid09yZ0lkXCJcclxuICAgIC8vIGZpZWxkTmFtZTogXCLmiYDlsZ7mnLrmnoRcIlxyXG4gICAgLy8gaWQ6IFwiV3VMaWFvLndPcmdJZFwiXHJcbiAgICAvLyB2YWx1ZTogU21hcnRIZWxwVmFsdWUge3ZhbHVlRmllbGQ6IG51bGwsIHZhbHVlOiBudWxsfVxyXG4gICAgLy8gdmFsdWVUeXBlOiAwXHJcbiAgICBnZXRTbWFydEhlbHBCaW5kaW5nSW5mbygpIHtcclxuICAgICAgICBjb25zdCBzbWFydEhlbHBDb250cm9sID0gKHRoaXMuaXRlbS5jb250cm9sIGFzIFNtYXJ0SGVscENvbnRvbCk7XHJcbiAgICAgICAgdGhpcy51cmkgPSBzbWFydEhlbHBDb250cm9sLnVyaTtcclxuICAgICAgICB0aGlzLnRleHRGaWVsZCA9IHNtYXJ0SGVscENvbnRyb2wudGV4dEZpZWxkO1xyXG4gICAgICAgIHRoaXMuaWRGaWVsZCA9IHNtYXJ0SGVscENvbnRyb2wuaWRGaWVsZDtcclxuICAgICAgICB0aGlzLnZhbHVlRmllbGQgPSBzbWFydEhlbHBDb250cm9sLnZhbHVlRmllbGQ7XHJcbiAgICAgICAgdGhpcy5kaXNwbGF5VHlwZSA9IHNtYXJ0SGVscENvbnRyb2wuZGlzcGxheVR5cGU7XHJcbiAgICAgICAgdGhpcy5tYXBGaWVsZHMgPSBzbWFydEhlbHBDb250cm9sLm1hcEZpZWxkcztcclxuICAgICAgICB0aGlzLmNvbnRleHQgPSBzbWFydEhlbHBDb250cm9sLmNvbnRleHQ7XHJcbiAgICAgICAgdGhpcy5wcmVFdmVudENtZCA9IHNtYXJ0SGVscENvbnRyb2wucHJlRXZlbnRDbWQ7XHJcbiAgICAgICAgdGhpcy5wb3N0RXZlbnRDbWQgPSBzbWFydEhlbHBDb250cm9sLnBvc3RFdmVudENtZDtcclxuICAgICAgICB0aGlzLmVuYWJsZUZ1bGxUcmVlID0gc21hcnRIZWxwQ29udHJvbC5lbmFibGVGdWxsVHJlZTtcclxuICAgICAgICB0aGlzLmxvYWRUcmVlRGF0YVR5cGUgPSBzbWFydEhlbHBDb250cm9sLmxvYWRUcmVlRGF0YVR5cGU7XHJcbiAgICAgICAgdGhpcy5zaW5nbGVTZWxlY3QgPSBzbWFydEhlbHBDb250cm9sLnNpbmdsZVNlbGVjdCA9PT0gZmFsc2UgPyBmYWxzZSA6IHRydWU7XHJcbiAgICAgICAgdGhpcy5leHBhbmRMZXZlbCA9IHNtYXJ0SGVscENvbnRyb2wuZXhwYW5kTGV2ZWw7XHJcbiAgICAgICAgdGhpcy5lbmFibGVDYXNjYWRlID0gc21hcnRIZWxwQ29udHJvbC5lbmFibGVDYXNjYWRlO1xyXG4gICAgICAgIHRoaXMuY2FzY2FkZVN0YXR1cyA9IHNtYXJ0SGVscENvbnRyb2wuY2FzY2FkZVN0YXR1cyA/IHNtYXJ0SGVscENvbnRyb2wuY2FzY2FkZVN0YXR1cyA6ICdlbmFibGUnO1xyXG4gICAgICAgIC8vIOagh+mimFxyXG4gICAgICAgIHRoaXMuZGlhbG9nVGl0bGUgPSBzbWFydEhlbHBDb250cm9sLmRpYWxvZ1RpdGxlP3NtYXJ0SGVscENvbnRyb2wuZGlhbG9nVGl0bGU6Jyc7XHJcbiAgICAgICAgLy8g5a695bqmXHJcbiAgICAgICAgdGhpcy5kaWFsb2dXaWR0aCA9IHNtYXJ0SGVscENvbnRyb2wucGFuZWxXaWR0aDtcclxuICAgICAgICAvLyDpq5jluqZcclxuICAgICAgICB0aGlzLmRpYWxvZ0hlaWdodCA9IHNtYXJ0SGVscENvbnRyb2wucGFuZWxIZWlnaHQ7XHJcbiAgICAgICAgY29uc3Qgc21hcnRIZWxwVmFsdWUgPSAodGhpcy5pdGVtLnZhbHVlIGFzIFNtYXJ0SGVscFZhbHVlKTtcclxuICAgICAgICBpZiAoc21hcnRIZWxwVmFsdWUudGV4dFZhbHVlID09ICdoZWxwLXRleHQtdmFsdWUtbnVsbCcpIHsvL+aXp+aVsOaNruWFvOWuuVxyXG4gICAgICAgICAgICB0aGlzLnRleHRWYWx1ZSA9IHNtYXJ0SGVscFZhbHVlLmdldFRleHRWYWx1ZSh0aGlzLnRleHRGaWVsZCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy50ZXh0VmFsdWUgPSBzbWFydEhlbHBWYWx1ZS50ZXh0VmFsdWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMubm9zZWFyY2ggPSBzbWFydEhlbHBDb250cm9sLm5vc2VhcmNoOy8v6buY6K6kZmFsc2VcclxuICAgICAgICB0aGlzLmRpc3BsYXlGaWVsZHMgPSBzbWFydEhlbHBDb250cm9sLmRpc3BsYXlGaWVsZHMgPyBzbWFydEhlbHBDb250cm9sLmRpc3BsYXlGaWVsZHMgOiAnJztcclxuICAgICAgICB0aGlzLmRpc3BsYXlUZXh0U2VwYXJhdG9yID0gc21hcnRIZWxwQ29udHJvbC5kaXNwbGF5VGV4dFNlcGFyYXRvciA/IHNtYXJ0SGVscENvbnRyb2wuZGlzcGxheVRleHRTZXBhcmF0b3IgOiAnXyc7XHJcbiAgICAgICAgdGhpcy5lZGl0YWJsZSA9IHNtYXJ0SGVscENvbnRyb2wuZWRpdGFibGU7XHJcbiAgICAgICAgdGhpcy5jbGVhckZpZWxkcyA9IHNtYXJ0SGVscENvbnRyb2wuY2xlYXJGaWVsZHM7XHJcbiAgICAgICAgaWYgKHNtYXJ0SGVscENvbnRyb2wuaGFzT3duUHJvcGVydHkoJ3BhZ2VTaXplJykgJiYgc21hcnRIZWxwQ29udHJvbC5wYWdlU2l6ZSkge1xyXG4gICAgICAgICAgICB0aGlzLnBhZ2VTaXplID0gc21hcnRIZWxwQ29udHJvbC5wYWdlU2l6ZVxyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoc21hcnRIZWxwQ29udHJvbC5oYXNPd25Qcm9wZXJ0eSgncGFnZUxpc3QnKSAmJiBzbWFydEhlbHBDb250cm9sLnBhZ2VMaXN0KSB7XHJcbiAgICAgICAgICAgIHRoaXMucGFnZUxpc3QgPSBzbWFydEhlbHBDb250cm9sLnBhZ2VMaXN0LnNwbGl0KFwiLFwiKS5tYXAoaXRlbSA9PiB7IHJldHVybiBwYXJzZUludChpdGVtKTsgfSlcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHNtYXJ0SGVscENvbnRyb2wuaGFzT3duUHJvcGVydHkoJ3F1aWNrU2VsZWN0JykgJiYgc21hcnRIZWxwQ29udHJvbC5xdWlja1NlbGVjdCkge1xyXG4gICAgICAgICAgICB0aGlzLnF1aWNrU2VsZWN0ID0gc21hcnRIZWxwQ29udHJvbC5xdWlja1NlbGVjdDtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHNtYXJ0SGVscENvbnRyb2wuaGFzT3duUHJvcGVydHkoJ2VuYWJsZU11bHRpRmllbGRTZWFyY2gnKSAmJiBzbWFydEhlbHBDb250cm9sLmVuYWJsZU11bHRpRmllbGRTZWFyY2gpIHtcclxuICAgICAgICAgICAgdGhpcy5lbmFibGVNdWx0aUZpZWxkU2VhcmNoID0gc21hcnRIZWxwQ29udHJvbC5lbmFibGVNdWx0aUZpZWxkU2VhcmNoO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBvbkJlZm9yZU9wZW4gPSAoKSA9PiB7XHJcbiAgICAgICAgY29uc3QgdCA9IHRoaXMuaXRlbS52YWx1ZSBhcyBTbWFydEhlbHBWYWx1ZTtcclxuICAgICAgICBpZiAodCAmJiB0LnZhbHVlKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGlkcyA9IHQudmFsdWUubWFwKG4gPT4gblt0aGlzLmlkRmllbGQgfHwgJ2lkJ10pLmpvaW4oJywnKTtcclxuICAgICAgICAgICAgdGhpcy5sb29rdXAuZGlzcGxheVZhbHVlID0gaWRzO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmNsZWFyRmllbGRzQ2hhbmdlLmVtaXQoe1xyXG4gICAgICAgICAgICBjb250cm9sVHlwZTogKHRoaXMuaXRlbS5jb250cm9sIGFzIFNtYXJ0SGVscENvbnRvbCkuZ2V0Q29udHJvbFR5cGUoKSxcclxuICAgICAgICAgICAgY2FuQ2xlYXJSZWxhdGVkRmllbGRzOiB0cnVlXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIG9mKHRydWUpO1xyXG4gICAgfVxyXG5cclxuICAgIGNsZWFyRGF0YShkYXRhOiBhbnkpIHtcclxuICAgICAgICAodGhpcy5pdGVtLnZhbHVlIGFzIFNtYXJ0SGVscFZhbHVlKS5jbGVhclZhbHVlKCk7XHJcbiAgICAgICAgaWYgKHRoaXMuaXRlbS5jb250cm9sLmNsZWFyKSB7XHJcbiAgICAgICAgICAgIHRoaXMuaXRlbS5jb250cm9sLmNsZWFyKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuY29uZGl0aW9uQ2hhbmdlLmVtaXQoKTtcclxuICAgIH1cclxuXHJcbiAgICBnZXRDb25kaXRpb25JdGVtVGl0bGUoZmllbGQ6IFF1ZXJ5Q29uZGl0aW9uKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuc29sdXRpb25TZXJ2aWNlLmdldENvbmRpdGlvbkl0ZW1UaXRsZShmaWVsZCk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBzZWxlY3RlZEl0ZW1cclxuICAgICAqIGNvZGU6IFwiY29kZTAyXCJcclxuICAgICAgICBpZDogXCJpZDAyXCJcclxuICAgICAgICBuYW1lOiBcIuacuuaehDAyXCJcclxuICAgICAgICB2ZXJzaW9uOiBcIjIwMTktMTAtMjFUMDA6MDA6MDBcIlxyXG4gICAgKi9cclxuICAgIHRleHRDaGFuZ2VkSGFuZGxlcihkYXRhOiBzdHJpbmcpIHsvL+aJi+W3pei+k+WFpeaXtuinpuWPkVxyXG4gICAgICAgIGlmICh0aGlzLml0ZW0gJiYgdGhpcy5pdGVtLnZhbHVlKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGhlbHBWYWx1ZSA9ICh0aGlzLml0ZW0udmFsdWUgYXMgU21hcnRIZWxwVmFsdWUpO1xyXG4gICAgICAgICAgICBoZWxwVmFsdWUudmFsdWUgPSBbZGF0YV07XHJcbiAgICAgICAgICAgIGhlbHBWYWx1ZS50ZXh0VmFsdWUgPSBkYXRhO1xyXG4gICAgICAgICAgICBoZWxwVmFsdWUuaXNJbnB1dFRleHQgPSB0cnVlO1xyXG4gICAgICAgICAgICAvLyB0aGlzLnRleHRWYWx1ZSA9IGhlbHBWYWx1ZS50ZXh0VmFsdWU7XHJcbiAgICAgICAgICAgIHRoaXMuY29uZGl0aW9uQ2hhbmdlLmVtaXQoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgc2VsZWN0ZWREYXRhSGFuZGxlcihzZWxlY3RlZEl0ZW06IGFueSkgey8v6YCJ5oup5pe26Kem5Y+RXHJcbiAgICAgICAgY29uc3QgaGVscFZhbHVlID0gKHRoaXMuaXRlbS52YWx1ZSBhcyBTbWFydEhlbHBWYWx1ZSk7XHJcbiAgICAgICAgaGVscFZhbHVlLnZhbHVlID0gdGhpcy5zaW5nbGVTZWxlY3QgPyBbc2VsZWN0ZWRJdGVtXSA6IHNlbGVjdGVkSXRlbTsvL+WNlemAiei/lOWbnuWvueixoe+8jOWkmumAiei/lOWbnuaVsOe7hFxyXG4gICAgICAgIGhlbHBWYWx1ZS52YWx1ZUZpZWxkID0gdGhpcy52YWx1ZUZpZWxkO1xyXG4gICAgICAgIGhlbHBWYWx1ZS50ZXh0VmFsdWUgPSB0aGlzLnRleHRWYWx1ZTtcclxuICAgICAgICBoZWxwVmFsdWUuaXNJbnB1dFRleHQgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLmNvbmRpdGlvbkNoYW5nZS5lbWl0KCk7XHJcbiAgICB9XHJcbn0iXX0=