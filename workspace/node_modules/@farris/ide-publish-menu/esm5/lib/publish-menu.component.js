/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { cloneDeep } from 'lodash-es';
import { LoadingService } from '@farris/ui-loading';
import { MessagerService } from '@farris/ui-messager';
import { Component, Injector, Input, LOCALE_ID, ViewChild, TemplateRef, ChangeDetectorRef, ViewEncapsulation } from '@angular/core';
import { HttpService } from '@farris/ide-devkit';
import { BsModalService } from '@farris/ui-modal';
import { GspAppManagerComponent } from './gsp-app/gsp-app.component';
import { IdService } from '@farris/ui-common';
import { BizobjectOperatorsComponent } from './biz-object-operators/bizobject-operators.component';
import { SelectAppComponent } from './select-app/select-app.component';
import { of } from 'rxjs';
import { LocaleService } from '@farris/ui-locale';
import { CommonUtils } from '@farris/ui-common';
import { PUBLISH_MENU_LOCALE } from './locale';
var PublishMenuComponent = /** @class */ (function () {
    function PublishMenuComponent(http, injector, modalService, uuid, messagerSer, loadingSer, cd) {
        this.http = http;
        this.injector = injector;
        this.modalService = modalService;
        this.uuid = uuid;
        this.messagerSer = messagerSer;
        this.loadingSer = loadingSer;
        this.cd = cd;
        this.serverIp = '';
        this.publishPath = '';
        /**
         * 所有功能菜单数据
         */
        this.allFuncTreeData = [];
        this.funcIdField = 'id';
        this.showMask = true;
        this.languages = [
            { code: 'zh-CHS', name: '中文简体' },
            { code: 'en', name: 'English' },
            { code: 'zh-CHT', name: '中文繁体' }
        ];
        this.funcModel = null;
        this.localeId = 'zh-CHS';
        this.commonUtil = this.injector.get(CommonUtils);
        this.localeId = this.injector.get(LOCALE_ID, 'zh-CHS');
        if (this.localeId === 'zh') {
            this.localeId = 'zh-CHS';
        }
        if (!this.localeSer) {
            this.localeSer = this.injector.get(LocaleService, null);
            if (!this.localeSer) {
                this.localeSer = new LocaleService(this.localeId, this.commonUtil, PUBLISH_MENU_LOCALE);
            }
            else {
                if (!this.localeSer.langData['publishmenu']) {
                    this.localeSer.setLocaleData(PUBLISH_MENU_LOCALE);
                }
            }
        }
    }
    Object.defineProperty(PublishMenuComponent.prototype, "FUNC_URI", {
        get: /**
         * @private
         * @return {?}
         */
        function () {
            return this.serverIp + '/api/runtime/sys/v1.0/functions/allFuncs';
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(PublishMenuComponent.prototype, "APP_URI", {
        get: /**
         * @private
         * @return {?}
         */
        function () {
            return this.serverIp + '/api/runtime/sys/v1.0/gspapp/all';
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(PublishMenuComponent.prototype, "APP_POST_URI", {
        get: /**
         * @private
         * @return {?}
         */
        function () {
            return this.serverIp + '/api/runtime/sys/v1.0/gspapp';
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(PublishMenuComponent.prototype, "FUNC_POST_URI", {
        get: /**
         * @private
         * @return {?}
         */
        function () {
            return this.serverIp + '/api/runtime/sys/v1.0/functions';
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    PublishMenuComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        // this.initAllFuncTree();
    };
    /**
     * @param {?} changes
     * @return {?}
     */
    PublishMenuComponent.prototype.ngOnChanges = /**
     * @param {?} changes
     * @return {?}
     */
    function (changes) {
    };
    /**
     * @return {?}
     */
    PublishMenuComponent.prototype.emptyData = /**
     * @return {?}
     */
    function () {
        this.funcModel = {
            appId: '',
            appInvokId: '',
            bizObjectId: '',
            bizOpId: '',
            code: '',
            creator: '',
            description: '',
            funcType: '4',
            id: this.uuid.generate(),
            icon: '',
            isDetail: true,
            isDisplayed: true,
            isSysInit: false,
            layer: '4',
            menuType: '1',
            name: '',
            parentId: '',
            path: '',
            staticParams: [{ name: 'mode', value: 'spa' }],
            url: '',
            nameLanguage: null
        };
    };
    /**
     * @return {?}
     */
    PublishMenuComponent.prototype.validate = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var msg = '';
        if (!this.funcModel.parentId) {
            msg += this.localeSer.getValue('publishmenu.func.message.parentId'); // '请在左侧选择上级菜单！<br>';
        }
        if (!msg) {
            if (!this.funcModel.code) {
                msg += this.localeSer.getValue('publishmenu.func.message.code'); // '功能编号不能为空！<br>';
            }
            if (!this.funcModel.name) {
                msg += this.localeSer.getValue('publishmenu.func.message.name'); // '功能名称不能为空！<br>';
            }
            if (!this.funcModel.bizOpId) {
                msg += this.localeSer.getValue('publishmenu.func.message.bizOpId'); // '请选择功能操作！ <br>';
            }
            if (!this.funcModel.appId) {
                msg += this.localeSer.getValue('publishmenu.func.message.appid'); // '请选择关联应用！<br>';
            }
            if (!this.funcModel.appInvokId) {
                msg += this.localeSer.getValue('publishmenu.func.message.appInvokId'); // '请选择关联应用入口！<br>';
            }
        }
        // if (!this.funcModel.bizObjectId) {
        //     msg += this.localeSer.getValue('publishmenu.func.message.bizObjectId');  // '请选择左侧业务操作对象！ <br>';
        // }
        if (msg) {
            this.messagerSer.show('warning', msg, { safeHtml: false, height: 300 });
            return false;
        }
        return true;
    };
    /**
     * @return {?}
     */
    PublishMenuComponent.prototype.saveMenu = /**
     * @return {?}
     */
    function () {
        this.funcModel.name = this.funcModel.nameLanguage ? this.funcModel.nameLanguage[this.localeId] : '';
        if (this.validate()) {
            /** @type {?} */
            var staticParams = JSON.stringify(this.funcModel.staticParams);
            /** @type {?} */
            var _funcModel = cloneDeep(this.funcModel);
            _funcModel.staticParams = staticParams;
            _funcModel.name = _funcModel.nameLanguage[this.localeId];
            return this.http.post(this.FUNC_POST_URI, _funcModel);
        }
        return of(false);
    };
    /**
     * @return {?}
     */
    PublishMenuComponent.prototype.show = /**
     * @return {?}
     */
    function () {
        var _this = this;
        /** @type {?} */
        var modalRef = this.modalService.show(this.dlgContent, {
            title: this.localeSer.getValue('publishmenu.dialog.title'),
            width: 760, height: 500,
            showMaxButton: false,
            resizable: false,
            enableScroll: false,
            buttons: [
                {
                    text: this.localeSer.getValue('publishmenu.dialog.btnOk'),
                    cls: 'btn btn-primary',
                    handle: (/**
                     * @return {?}
                     */
                    function () {
                        _this.saveMenu().subscribe((/**
                         * @param {?} r
                         * @return {?}
                         */
                        function (r) {
                            if (r) {
                                _this.messagerSer.success(_this.localeSer.getValue('publishmenu.dialog.success'));
                                modalRef.close();
                                _this.showMask = true;
                            }
                        }), (/**
                         * @param {?} err
                         * @return {?}
                         */
                        function (err) {
                            console.error(err);
                            if (err) {
                                /** @type {?} */
                                var error = err.error;
                                if (error) {
                                    /** @type {?} */
                                    var mesg = error.Message;
                                    _this.messagerSer.warning(mesg);
                                }
                            }
                        }));
                    })
                },
                {
                    text: this.localeSer.getValue('publishmenu.dialog.btnCancel'),
                    cls: 'btn btn-secondary',
                    handle: (/**
                     * @return {?}
                     */
                    function () {
                        modalRef.close();
                        _this.showMask = true;
                    })
                }
            ],
            opened: (/**
             * @return {?}
             */
            function () {
                _this.initAllFuncTree();
            })
        });
        this.emptyData();
        return modalRef;
    };
    // 选择关联应用
    // 选择关联应用
    /**
     * @return {?}
     */
    PublishMenuComponent.prototype.showSelectAppModal = 
    // 选择关联应用
    /**
     * @return {?}
     */
    function () {
        var _this = this;
        /** @type {?} */
        var modalRef = this.modalService.show(SelectAppComponent, {
            title: this.localeSer.getValue('publishmenu.dialog.selectapp'),
            width: 760, height: 500,
            enableScroll: false,
            showMaxButton: false,
            resizable: false,
            initialState: {
                serverIp: this.serverIp,
                funcModel: this.funcModel
            },
            buttons: [
                {
                    text: this.localeSer.getValue('publishmenu.dialog.btnOk'),
                    cls: 'btn btn-primary',
                    handle: (/**
                     * @return {?}
                     */
                    function () {
                        /** @type {?} */
                        var sac = (/** @type {?} */ (modalRef.content));
                        /** @type {?} */
                        var msg = '';
                        if (sac.appId && sac.appInvokId) {
                            _this.funcModel.appId = sac.appId;
                            _this.funcModel.appInvokId = sac.appInvokId;
                            msg = '';
                        }
                        if (!sac.appId) {
                            msg = _this.localeSer.getValue('publishmenu.dialog.selectInfo');
                        }
                        else if (!sac.appInvokId) {
                            msg = _this.localeSer.getValue('publishmenu.dialog.appentry');
                        }
                        if (msg) {
                            _this.messagerSer.warning(msg);
                        }
                        else {
                            modalRef.close();
                        }
                    })
                },
                {
                    text: this.localeSer.getValue('publishmenu.dialog.btnCancel'),
                    cls: 'btn btn-secondary',
                    handle: (/**
                     * @return {?}
                     */
                    function () {
                        modalRef.close();
                    })
                }
            ]
        });
        return modalRef;
    };
    // 选择业务操作
    // 选择业务操作
    /**
     * @return {?}
     */
    PublishMenuComponent.prototype.showBizObjectOperatorModal = 
    // 选择业务操作
    /**
     * @return {?}
     */
    function () {
        var _this = this;
        /** @type {?} */
        var modalRef = this.modalService.show(BizobjectOperatorsComponent, {
            title: this.localeSer.getValue('publishmenu.dialog.bizOptitle'),
            width: 760, height: 500,
            enableScroll: false,
            showMaxButton: false,
            resizable: false,
            initialState: {
                serverIp: this.serverIp,
                funcModel: this.funcModel
            },
            buttons: [
                {
                    text: this.localeSer.getValue('publishmenu.dialog.btnOk'),
                    cls: 'btn btn-primary',
                    handle: (/**
                     * @return {?}
                     */
                    function () {
                        /** @type {?} */
                        var boc = (/** @type {?} */ (modalRef.content));
                        /** @type {?} */
                        var bizObj = (/** @type {?} */ (boc.bizObjectId));
                        /** @type {?} */
                        var bizOp = (/** @type {?} */ (boc.bizOpId));
                        if (bizOp) {
                            /** @type {?} */
                            var bizObjID = '';
                            if (!bizObj) {
                                bizObjID = bizOp.data.businessId;
                            }
                            else {
                                bizObjID = bizObj.id;
                            }
                            if (bizObjID) {
                                _this.funcModel.bizObjectId = bizObjID;
                                _this.funcModel.bizOpId = bizOp.id;
                                modalRef.close();
                            }
                            else {
                                _this.messagerSer.warning(_this.localeSer.getValue('publishmenu.dialog.bizwarn'));
                            }
                        }
                        else {
                            _this.messagerSer.warning(_this.localeSer.getValue('publishmenu.dialog.bizaction'));
                        }
                    })
                },
                {
                    text: this.localeSer.getValue('publishmenu.dialog.btnCancel'),
                    cls: 'btn btn-secondary',
                    handle: (/**
                     * @return {?}
                     */
                    function () {
                        modalRef.close();
                    })
                }
            ]
        });
        return modalRef;
    };
    // 新建应用
    // 新建应用
    /**
     * @return {?}
     */
    PublishMenuComponent.prototype.showAppModal = 
    // 新建应用
    /**
     * @return {?}
     */
    function () {
        var _this = this;
        /** @type {?} */
        var modalRef = this.modalService.show(GspAppManagerComponent, {
            title: this.localeSer.getValue('publishmenu.dialog.app'),
            width: 760, height: 500,
            showMaxButton: false,
            resizable: false,
            enableScroll: false,
            initialState: {
                serverIp: this.serverIp,
                path: (this.publishPath || '').replace('index.htmlindex.html', 'index.html'),
                funcModel: this.funcModel
            },
            buttons: [
                {
                    text: this.localeSer.getValue('publishmenu.dialog.btnOk'),
                    cls: 'btn btn-primary',
                    handle: (/**
                     * @return {?}
                     */
                    function () {
                        /** @type {?} */
                        var amc = (/** @type {?} */ (modalRef.content));
                        if (amc.validate()) {
                            _this.loadingSer.show();
                            _this.http.post(_this.APP_POST_URI, amc.appModel).subscribe((/**
                             * @param {?} r
                             * @return {?}
                             */
                            function (r) {
                                if (r) {
                                    _this.funcModel.appId = amc.appModel.id;
                                    _this.funcModel.appInvokId = amc.appModel.appInvoks[0].id;
                                    _this.loadingSer.close();
                                    modalRef.close();
                                }
                            }));
                        }
                        // console.log(amc.appModel);
                    })
                },
                {
                    text: this.localeSer.getValue('publishmenu.dialog.btnCancel'),
                    cls: 'btn btn-secondary',
                    handle: (/**
                     * @return {?}
                     */
                    function () {
                        modalRef.close();
                    })
                }
            ]
        });
        return modalRef;
    };
    /**
     * @param {?} e
     * @return {?}
     */
    PublishMenuComponent.prototype.treeNodeClicked = /**
     * @param {?} e
     * @return {?}
     */
    function (e) {
        this.funcModel.parentId = e.node.data.id;
        this.showMask = false;
        this.cd.detectChanges();
        /** @type {?} */
        var input = document.querySelector('#txtFuncCode');
        if (input) {
            input.click();
            input.focus();
        }
    };
    /**
     * @param {?} name
     * @return {?}
     */
    PublishMenuComponent.prototype.removeStaticParams = /**
     * @param {?} name
     * @return {?}
     */
    function (name) {
        this.funcModel.staticParams = this.funcModel.staticParams.filter((/**
         * @param {?} n
         * @return {?}
         */
        function (n) { return n.name !== name; }));
    };
    /**
     * @return {?}
     */
    PublishMenuComponent.prototype.addStaticParams = /**
     * @return {?}
     */
    function () {
        this.funcModel.staticParams.push({ name: '', value: '' });
    };
    /**
     * @private
     * @return {?}
     */
    PublishMenuComponent.prototype.initAllFuncTree = /**
     * @private
     * @return {?}
     */
    function () {
        var _this = this;
        this.http.get(this.FUNC_URI).subscribe((/**
         * @param {?} data
         * @return {?}
         */
        function (data) {
            if (data) {
                _this.allFuncTreeData = _this.convert2TreeNodes(data);
            }
        }));
    };
    /**
     * @private
     * @param {?} data
     * @param {?=} parentId
     * @return {?}
     */
    PublishMenuComponent.prototype.convert2TreeNodes = /**
     * @private
     * @param {?} data
     * @param {?=} parentId
     * @return {?}
     */
    function (data, parentId) {
        var _this = this;
        if (parentId === void 0) { parentId = '0'; }
        if (data.length) {
            /** @type {?} */
            var nodes = data.filter((/**
             * @param {?} v
             * @return {?}
             */
            function (v) { return v.parentId === parentId; }));
            return nodes.map((/**
             * @param {?} item
             * @return {?}
             */
            function (item) {
                /** @type {?} */
                var node = {
                    data: item,
                    children: [],
                    selectable: item.layer === '3'
                };
                node.children = _this.convert2TreeNodes(data, item.id);
                return node;
            }));
        }
        return [];
    };
    PublishMenuComponent.decorators = [
        { type: Component, args: [{
                    selector: 'publish-menu',
                    template: "\r\n<ng-template #dlgContent>\r\n\r\n<div class=\"d-flex flex-row\" style=\"width: 760px; height: 400px;border:0px solid #ae00e6\">\r\n    <!-- Left -->\r\n    <div region=\"west\" class=\"west\" style=\"width: 280px;min-width:280px; height: 100%; background-color: #fff;border-right: 1px solid #e2e8f0;\">\r\n        <!-- \u83DC\u5355\u6811 -->\r\n        <div class=\"ps\" style=\"position: relative; height: 100%;\" [perfectScrollbar]=\"{}\">\r\n            <farris-treetable #tt=\"treeTable\" [data]=\"allFuncTreeData\" [idField]=\"funcIdField\" [striped]=\"false\" [fit]=\"true\"\r\n            [findField]=\"'name'\" (nodeSelected)=\"treeNodeClicked($event)\"\r\n            [singleSelect]=\"true\" [showIcon]=\"true\" [showFilterBar]=\"false\" [selectOnCheck]=\"true\" [checkOnSelect]=\"true\">\r\n                <ng-template farrisTemplate=\"body\" let-rowNode let-treeNode=\"node\" let-rowData=\"rowData\" >\r\n                    <tr #row=\"row\" [selectRow]=\"rowNode\" [selectRowDisabled]=\"!rowNode.node.selectable\" [dblclick]=\"true\">\r\n                        <td style=\"border: 0; cursor: pointer;\" [style.color]=\"row.selectRowDisabled? '#595959': '#000000'\">\r\n                            <farris-treeTableToggler [rowNode]=\"rowNode\"></farris-treeTableToggler>\r\n                            <span [innerHTML]=\"rowData['name'] | highlight: tt.findValue : 'name' : 'name'\"></span>\r\n                        </td>\r\n                    </tr>\r\n                </ng-template>\r\n            </farris-treetable>\r\n        </div>\r\n    </div>\r\n\r\n    <!-- main -->\r\n    <div region=\"center\" class=\"center flex-fill public-menu-main\" style=\"color: #000000;overflow: auto;\">\r\n        <div class=\"mengbanban\" *ngIf=\"showMask\" \r\n        style=\"position: absolute; z-index: 10; top: 0; width: 100%; height: 100%;opacity: 0.5; background: #fff; display: block; font-size: 40px; \">\r\n            <h1 style=\"margin-top: 145px; color: #000; margin-left: 20px; \">\u2190 {{ 'publishmenu.func.message.info' | locale }}</h1>\r\n        </div>\r\n        <div class=\"row\" style=\"margin: 10px 15px;\">\r\n            <div class=\"col-12\">\r\n                <div class=\"form-group\">\r\n                    <label for=\"txtFuncId\">{{ 'publishmenu.func.id' | locale: '\u529F\u80FD\u6807\u8BC6' }}</label>\r\n                    <input type=\"text\" class=\"form-control\" id=\"txtFuncId\" disabled [ngModel]=\"funcModel.id\">\r\n                </div>\r\n                <div class=\"form-group\">\r\n                    <label for=\"txtFuncCode\"><span class=\"farris-label-info text-danger\">*</span>{{ 'publishmenu.func.code' | locale: '\u529F\u80FD\u7F16\u53F7' }}</label>\r\n                    <input type=\"text\" class=\"form-control\" id=\"txtFuncCode\" [(ngModel)]=\"funcModel.code\">\r\n                </div>\r\n                <div class=\"form-group\">\r\n                    <label for=\"txtFuncName\"><span class=\"farris-label-info text-danger\">*</span>{{ 'publishmenu.func.name' | locale: '\u529F\u80FD\u540D\u79F0' }}</label>\r\n                    <!-- <input type=\"text\" class=\"form-control\" id=\"txtFuncName\" [(ngModel)]=\"funcModel.name\" > -->\r\n                    <language-textbox \r\n                    [languages]=\"languages\" [(ngModel)]=\"funcModel.nameLanguage\"\r\n                    [enableClear]=\"false\"\r\n                    [readonly]=\"false\"\r\n                    [disabled]=\"false\"\r\n                    [autoFocus]=\"true\"\r\n                    ></language-textbox>\r\n                </div>\r\n                <div class=\"form-group\">\r\n                    <label for=\"txtFuncAction\"><span class=\"farris-label-info text-danger\">*</span>{{ 'publishmenu.func.action' | locale: '\u529F\u80FD\u64CD\u4F5C' }}</label>\r\n\r\n                    <div class=\"input-group\">\r\n                        <input type=\"text\" class=\"form-control\" [(ngModel)]=\"funcModel.bizOpId\" readonly >\r\n                        <div class=\"input-group-append\">\r\n                            <button class=\"btn btn-outline-secondary\" (click)=\"showBizObjectOperatorModal()\" type=\"button\">{{ 'publishmenu.func.selectBiz' | locale: '\u9009\u62E9' }}</button>\r\n                        </div>\r\n                    </div>\r\n\r\n                </div>\r\n                <div class=\"form-group\">\r\n                    <label for=\"txtFuncRemark\">{{ 'publishmenu.func.remark' | locale: '\u529F\u80FD\u63CF\u8FF0' }}</label>\r\n                    <input type=\"text\" class=\"form-control\" id=\"txtFuncRemark\" [(ngModel)]=\"funcModel.description\" >\r\n                </div>\r\n\r\n                <div class=\"form-group\">\r\n                    <label><span class=\"farris-label-info text-danger\">*</span>{{ 'publishmenu.func.linkapp' | locale: '\u5173\u8054\u5E94\u7528' }}</label>\r\n                    <div class=\"input-group\">\r\n                        <input type=\"text\" class=\"form-control\" [(ngModel)]=\"funcModel.appId\" readonly>\r\n                        <div class=\"input-group-append\">\r\n                            <button class=\"btn btn-outline-secondary\" type=\"button\" (click)=\"showSelectAppModal()\">{{ 'publishmenu.func.selectapp' | locale: '\u9009\u62E9' }}</button>\r\n                            <button class=\"btn btn-outline-secondary\" type=\"button\" (click)=\"showAppModal()\">{{ 'publishmenu.func.addapp' | locale: '\u65B0\u5EFA' }}</button>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                <div class=\"form-group\">\r\n                    <label for=\"txtappInvokid\"><span class=\"farris-label-info text-danger\">*</span>{{ 'publishmenu.func.appentry' | locale: '\u5E94\u7528\u5165\u53E3' }}</label>\r\n                    <input type=\"text\" class=\"form-control\" id=\"txtappInvokid\" [ngModel]=\"funcModel.appInvokId\" disabled>\r\n                </div>\r\n\r\n                <div class=\"form-group\">\r\n                    <label for=\"txtAppRemark\">{{ 'publishmenu.func.appParam' | locale: '\u53C2\u6570\u8BBE\u7F6E' }}</label>\r\n                    <table class=\"table table-bordered\">\r\n                        <colgroup>\r\n                            <col width=\"140\">\r\n                            <col width=\"200\">\r\n                            <col width=\"\">\r\n                        </colgroup>\r\n                        <thead>\r\n                            <tr>\r\n                                <td>\r\n                                    {{ 'publishmenu.func.paramName' | locale: '\u53C2\u6570\u540D\u79F0' }}\r\n                                </td>\r\n                                <td>\r\n                                    {{ 'publishmenu.func.paramValue' | locale: '\u53C2\u6570\u503C' }}\r\n                                </td>\r\n                                <td align=\"center\">\r\n                                    {{ 'publishmenu.func.paramAction' | locale: '\u64CD\u4F5C' }}\r\n                                </td>\r\n                            </tr>\r\n                        </thead>\r\n                        <tbody>\r\n                            <tr *ngFor=\"let n of funcModel.staticParams\">\r\n                                <td>\r\n                                    <input type=\"text\" [(ngModel)]=\"n.name\" class=\"form-control\">\r\n                                </td>\r\n                                <td>\r\n                                    <input type=\"text\" class=\"form-control\" [(ngModel)]=\"n.value\" >\r\n                                </td>\r\n                                <td style=\"padding-left: 0; padding-right: 0; text-align: center\">\r\n                                    <button type=\"button\" (click)=\"removeStaticParams(n.name)\" class=\"btn\">\r\n                                        <span class=\"k-icon k-i-minus\"></span></button>\r\n                                </td>\r\n                            </tr>\r\n                        </tbody>\r\n                        <tfoot>\r\n                            <tr>\r\n                                <td colspan=\"3\">\r\n                                    <button type=\"button\" (click)=\"addStaticParams()\" class=\"btn btn-primary\">\r\n                                        <span class=\"k-icon k-i-plus\"></span> {{ 'publishmenu.func.addParam' | locale: '\u65B0\u589E\u53C2\u6570' }}</button>\r\n                                </td>\r\n                            </tr>\r\n                        </tfoot>\r\n                    </table>\r\n\r\n                </div>\r\n\r\n                <div class=\"form-group\">\r\n                    <label for=\"txtFuncRemark\">ParentId</label>\r\n                    <input type=\"text\" class=\"form-control\" id=\"txtFuncRemark\" [ngModel]=\"funcModel.parentId\" disabled>\r\n                </div>\r\n                    \r\n            </div>\r\n        </div>\r\n\r\n    </div>\r\n</div>\r\n\r\n\r\n</ng-template>",
                    exportAs: 'publishMenu',
                    encapsulation: ViewEncapsulation.None,
                    styles: ["\n        .public-menu-main::-webkit-scrollbar-track-piece{width:8px;background-color:#e2e2e2;}\n        .public-menu-main::-webkit-scrollbar{width:8px;height:6px;}\n        .public-menu-main::-webkit-scrollbar-thumb{height:50px;background:#9fa1a0; cursor:pointer;}\n        .public-menu-main::-webkit-scrollbar-thumb:hover{background:#686868; cursor:pointer\n        "]
                }] }
    ];
    /** @nocollapse */
    PublishMenuComponent.ctorParameters = function () { return [
        { type: HttpService },
        { type: Injector },
        { type: BsModalService },
        { type: IdService },
        { type: MessagerService },
        { type: LoadingService },
        { type: ChangeDetectorRef }
    ]; };
    PublishMenuComponent.propDecorators = {
        serverIp: [{ type: Input }],
        dlgContent: [{ type: ViewChild, args: ['dlgContent',] }],
        publishPath: [{ type: Input }]
    };
    return PublishMenuComponent;
}());
export { PublishMenuComponent };
if (false) {
    /** @type {?} */
    PublishMenuComponent.prototype.serverIp;
    /** @type {?} */
    PublishMenuComponent.prototype.dlgContent;
    /** @type {?} */
    PublishMenuComponent.prototype.publishPath;
    /**
     * 所有功能菜单数据
     * @type {?}
     */
    PublishMenuComponent.prototype.allFuncTreeData;
    /** @type {?} */
    PublishMenuComponent.prototype.funcIdField;
    /** @type {?} */
    PublishMenuComponent.prototype.showMask;
    /** @type {?} */
    PublishMenuComponent.prototype.languages;
    /** @type {?} */
    PublishMenuComponent.prototype.funcModel;
    /** @type {?} */
    PublishMenuComponent.prototype.localeId;
    /** @type {?} */
    PublishMenuComponent.prototype.localeSer;
    /** @type {?} */
    PublishMenuComponent.prototype.commonUtil;
    /**
     * @type {?}
     * @private
     */
    PublishMenuComponent.prototype.http;
    /**
     * @type {?}
     * @private
     */
    PublishMenuComponent.prototype.injector;
    /**
     * @type {?}
     * @private
     */
    PublishMenuComponent.prototype.modalService;
    /**
     * @type {?}
     * @private
     */
    PublishMenuComponent.prototype.uuid;
    /**
     * @type {?}
     * @private
     */
    PublishMenuComponent.prototype.messagerSer;
    /**
     * @type {?}
     * @private
     */
    PublishMenuComponent.prototype.loadingSer;
    /**
     * @type {?}
     * @private
     */
    PublishMenuComponent.prototype.cd;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicHVibGlzaC1tZW51LmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BmYXJyaXMvaWRlLXB1Ymxpc2gtbWVudS8iLCJzb3VyY2VzIjpbImxpYi9wdWJsaXNoLW1lbnUuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7QUFBQSxPQUFPLEVBQUUsU0FBUyxFQUFFLE1BQU0sV0FBVyxDQUFDO0FBQ3RDLE9BQU8sRUFBRSxjQUFjLEVBQUUsTUFBTSxvQkFBb0IsQ0FBQztBQUNwRCxPQUFPLEVBQUUsZUFBZSxFQUFFLE1BQU0scUJBQXFCLENBQUM7QUFDdEQsT0FBTyxFQUFFLFNBQVMsRUFBVSxRQUFRLEVBQUUsS0FBSyxFQUFhLFNBQVMsRUFDekMsU0FBUyxFQUFFLFdBQVcsRUFBRSxpQkFBaUIsRUFBRSxpQkFBaUIsRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUM1RyxPQUFPLEVBQUUsV0FBVyxFQUFFLE1BQU0sb0JBQW9CLENBQUM7QUFDakQsT0FBTyxFQUFFLGNBQWMsRUFBRSxNQUFNLGtCQUFrQixDQUFDO0FBRWxELE9BQU8sRUFBRSxzQkFBc0IsRUFBRSxNQUFNLDZCQUE2QixDQUFDO0FBQ3JFLE9BQU8sRUFBRSxTQUFTLEVBQUUsTUFBTSxtQkFBbUIsQ0FBQztBQUU5QyxPQUFPLEVBQUUsMkJBQTJCLEVBQUUsTUFBTSxzREFBc0QsQ0FBQztBQUNuRyxPQUFPLEVBQUUsa0JBQWtCLEVBQUUsTUFBTSxtQ0FBbUMsQ0FBQztBQUV2RSxPQUFPLEVBQUUsRUFBRSxFQUFFLE1BQU0sTUFBTSxDQUFDO0FBQzFCLE9BQU8sRUFBRSxhQUFhLEVBQUUsTUFBTSxtQkFBbUIsQ0FBQztBQUNsRCxPQUFPLEVBQUUsV0FBVyxFQUFFLE1BQU0sbUJBQW1CLENBQUM7QUFDaEQsT0FBTyxFQUFFLG1CQUFtQixFQUFFLE1BQU0sVUFBVSxDQUFDO0FBQy9DO0lBbURJLDhCQUNZLElBQWlCLEVBQ2pCLFFBQWtCLEVBQ2xCLFlBQTRCLEVBQzVCLElBQWUs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OztJQXNZViwyQkFBQztDQUFBLEFBeFpELElBd1pDO1NBMVlZLG9CQUFvQjs7O0lBRTdCLHdDQUF1Qjs7SUFDdkIsMENBQXNEOztJQUN0RCwyQ0FBMEI7Ozs7O0lBRzFCLCtDQUFxQjs7SUFDckIsMkNBQW1COztJQUVuQix3Q0FBZ0I7O0lBRWhCLHlDQUlFOztJQWlCRix5Q0FBOEI7O0lBQzlCLHdDQUFvQjs7SUFDcEIseUNBQXlCOztJQUN6QiwwQ0FBd0I7Ozs7O0lBRXBCLG9DQUF5Qjs7Ozs7SUFDekIsd0NBQTBCOzs7OztJQUMxQiw0Q0FBb0M7Ozs7O0lBQ3BDLG9DQUF1Qjs7Ozs7SUFDdkIsMkNBQW9DOzs7OztJQUNwQywwQ0FBa0M7Ozs7O0lBQ2xDLGtDQUE2QiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGNsb25lRGVlcCB9IGZyb20gJ2xvZGFzaC1lcyc7XHJcbmltcG9ydCB7IExvYWRpbmdTZXJ2aWNlIH0gZnJvbSAnQGZhcnJpcy91aS1sb2FkaW5nJztcclxuaW1wb3J0IHsgTWVzc2FnZXJTZXJ2aWNlIH0gZnJvbSAnQGZhcnJpcy91aS1tZXNzYWdlcic7XHJcbmltcG9ydCB7IENvbXBvbmVudCwgT25Jbml0LCBJbmplY3RvciwgSW5wdXQsIE9uQ2hhbmdlcywgTE9DQUxFX0lELFxyXG4gICAgICAgICBTaW1wbGVDaGFuZ2VzLCBWaWV3Q2hpbGQsIFRlbXBsYXRlUmVmLCBDaGFuZ2VEZXRlY3RvclJlZiwgVmlld0VuY2Fwc3VsYXRpb24gfSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgSHR0cFNlcnZpY2UgfSBmcm9tICdAZmFycmlzL2lkZS1kZXZraXQnO1xyXG5pbXBvcnQgeyBCc01vZGFsU2VydmljZSB9IGZyb20gJ0BmYXJyaXMvdWktbW9kYWwnO1xyXG5pbXBvcnQgeyBUcmVlTm9kZSB9IGZyb20gJ0BmYXJyaXMvdWktdHJlZXRhYmxlJztcclxuaW1wb3J0IHsgR3NwQXBwTWFuYWdlckNvbXBvbmVudCB9IGZyb20gJy4vZ3NwLWFwcC9nc3AtYXBwLmNvbXBvbmVudCc7XHJcbmltcG9ydCB7IElkU2VydmljZSB9IGZyb20gJ0BmYXJyaXMvdWktY29tbW9uJztcclxuaW1wb3J0IHsgQXBwRnVuY3Rpb24gfSBmcm9tICcuL21vZGVscy9nc3AtYXBwLm1vZGVsJztcclxuaW1wb3J0IHsgQml6b2JqZWN0T3BlcmF0b3JzQ29tcG9uZW50IH0gZnJvbSAnLi9iaXotb2JqZWN0LW9wZXJhdG9ycy9iaXpvYmplY3Qtb3BlcmF0b3JzLmNvbXBvbmVudCc7XHJcbmltcG9ydCB7IFNlbGVjdEFwcENvbXBvbmVudCB9IGZyb20gJy4vc2VsZWN0LWFwcC9zZWxlY3QtYXBwLmNvbXBvbmVudCc7XHJcbmltcG9ydCB7IFNlbGVjdGVkUm93IH0gZnJvbSAnQGZhcnJpcy91aS1kYXRhZ3JpZCc7XHJcbmltcG9ydCB7IG9mIH0gZnJvbSAncnhqcyc7XHJcbmltcG9ydCB7IExvY2FsZVNlcnZpY2UgfSBmcm9tICdAZmFycmlzL3VpLWxvY2FsZSc7XHJcbmltcG9ydCB7IENvbW1vblV0aWxzIH0gZnJvbSAnQGZhcnJpcy91aS1jb21tb24nO1xyXG5pbXBvcnQgeyBQVUJMSVNIX01FTlVfTE9DQUxFIH0gZnJvbSAnLi9sb2NhbGUnO1xyXG5AQ29tcG9uZW50KHtcclxuICAgIHNlbGVjdG9yOiAncHVibGlzaC1tZW51JyxcclxuICAgIHRlbXBsYXRlVXJsOiAnLi9wdWJsaXNoLW1lbnUuY29tcG9uZW50Lmh0bWwnLFxyXG4gICAgc3R5bGVzOiBbXHJcbiAgICAgICAgYFxyXG4gICAgICAgIC5wdWJsaWMtbWVudS1tYWluOjotd2Via2l0LXNjcm9sbGJhci10cmFjay1waWVjZXt3aWR0aDo4cHg7YmFja2dyb3VuZC1jb2xvcjojZTJlMmUyO31cclxuICAgICAgICAucHVibGljLW1lbnUtbWFpbjo6LXdlYmtpdC1zY3JvbGxiYXJ7d2lkdGg6OHB4O2hlaWdodDo2cHg7fVxyXG4gICAgICAgIC5wdWJsaWMtbWVudS1tYWluOjotd2Via2l0LXNjcm9sbGJhci10aHVtYntoZWlnaHQ6NTBweDtiYWNrZ3JvdW5kOiM5ZmExYTA7IGN1cnNvcjpwb2ludGVyO31cclxuICAgICAgICAucHVibGljLW1lbnUtbWFpbjo6LXdlYmtpdC1zY3JvbGxiYXItdGh1bWI6aG92ZXJ7YmFja2dyb3VuZDojNjg2ODY4OyBjdXJzb3I6cG9pbnRlclxyXG4gICAgICAgIGBcclxuICAgIF0sXHJcbiAgICBleHBvcnRBczogJ3B1Ymxpc2hNZW51JyxcclxuICAgIGVuY2Fwc3VsYXRpb246IFZpZXdFbmNhcHN1bGF0aW9uLk5vbmVcclxufSlcclxuZXhwb3J0IGNsYXNzIFB1Ymxpc2hNZW51Q29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0LCBPbkNoYW5nZXMge1xyXG5cclxuICAgIEBJbnB1dCgpIHNlcnZlcklwID0gJyc7XHJcbiAgICBAVmlld0NoaWxkKCdkbGdDb250ZW50JykgZGxnQ29udGVudDogVGVtcGxhdGVSZWY8YW55PjtcclxuICAgIEBJbnB1dCgpIHB1Ymxpc2hQYXRoID0gJyc7XHJcblxyXG4gICAgLyoqIOaJgOacieWKn+iDveiPnOWNleaVsOaNriAqL1xyXG4gICAgYWxsRnVuY1RyZWVEYXRhID0gW107XHJcbiAgICBmdW5jSWRGaWVsZCA9ICdpZCc7XHJcblxyXG4gICAgc2hvd01hc2sgPSB0cnVlO1xyXG5cclxuICAgIGxhbmd1YWdlcyA9IFtcclxuICAgICAgICB7IGNvZGU6ICd6aC1DSFMnLCBuYW1lOiAn5Lit5paH566A5L2TJyB9LFxyXG4gICAgICAgIHsgY29kZTogJ2VuJywgbmFtZTogJ0VuZ2xpc2gnIH0sXHJcbiAgICAgICAgeyBjb2RlOiAnemgtQ0hUJywgbmFtZTogJ+S4reaWh+e5geS9kycgfVxyXG4gICAgXTtcclxuXHJcbiAgICBwcml2YXRlIGdldCBGVU5DX1VSSSgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5zZXJ2ZXJJcCArICcvYXBpL3J1bnRpbWUvc3lzL3YxLjAvZnVuY3Rpb25zL2FsbEZ1bmNzJztcclxuICAgIH1cclxuICAgIHByaXZhdGUgZ2V0IEFQUF9VUkkoKSB7XHJcbiAgICAgICAgcmV0dXJuICB0aGlzLnNlcnZlcklwICsgJy9hcGkvcnVudGltZS9zeXMvdjEuMC9nc3BhcHAvYWxsJztcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGdldCBBUFBfUE9TVF9VUkkoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuc2VydmVySXAgKyAnL2FwaS9ydW50aW1lL3N5cy92MS4wL2dzcGFwcCc7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBnZXQgRlVOQ19QT1NUX1VSSSgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5zZXJ2ZXJJcCArICcvYXBpL3J1bnRpbWUvc3lzL3YxLjAvZnVuY3Rpb25zJztcclxuICAgIH1cclxuXHJcbiAgICBmdW5jTW9kZWw6IEFwcEZ1bmN0aW9uID0gbnVsbDtcclxuICAgIGxvY2FsZUlkID0gJ3poLUNIUyc7XHJcbiAgICBsb2NhbGVTZXI6IExvY2FsZVNlcnZpY2U7XHJcbiAgICBjb21tb25VdGlsOiBDb21tb25VdGlscztcclxuICAgIGNvbnN0cnVjdG9yKFxyXG4gICAgICAgIHByaXZhdGUgaHR0cDogSHR0cFNlcnZpY2UsXHJcbiAgICAgICAgcHJpdmF0ZSBpbmplY3RvcjogSW5qZWN0b3IsXHJcbiAgICAgICAgcHJpdmF0ZSBtb2RhbFNlcnZpY2U6IEJzTW9kYWxTZXJ2aWNlLFxyXG4gICAgICAgIHByaXZhdGUgdXVpZDogSWRTZXJ2aWNlLFxyXG4gICAgICAgIHByaXZhdGUgbWVzc2FnZXJTZXI6IE1lc3NhZ2VyU2VydmljZSxcclxuICAgICAgICBwcml2YXRlIGxvYWRpbmdTZXI6IExvYWRpbmdTZXJ2aWNlLFxyXG4gICAgICAgIHByaXZhdGUgY2Q6IENoYW5nZURldGVjdG9yUmVmXHJcbiAgICApIHtcclxuXHJcbiAgICAgICAgdGhpcy5jb21tb25VdGlsID0gdGhpcy5pbmplY3Rvci5nZXQoQ29tbW9uVXRpbHMpO1xyXG4gICAgICAgIHRoaXMubG9jYWxlSWQgPSB0aGlzLmluamVjdG9yLmdldChMT0NBTEVfSUQsICd6aC1DSFMnKTtcclxuXHJcbiAgICAgICAgaWYgKHRoaXMubG9jYWxlSWQgPT09ICd6aCcpIHtcclxuICAgICAgICAgICAgdGhpcy5sb2NhbGVJZCA9ICd6aC1DSFMnO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKCF0aGlzLmxvY2FsZVNlcikge1xyXG4gICAgICAgICAgICB0aGlzLmxvY2FsZVNlciA9IHRoaXMuaW5qZWN0b3IuZ2V0KExvY2FsZVNlcnZpY2UsIG51bGwpO1xyXG4gICAgICAgICAgICBpZiAoIXRoaXMubG9jYWxlU2VyKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmxvY2FsZVNlciA9IG5ldyBMb2NhbGVTZXJ2aWNlKHRoaXMubG9jYWxlSWQsIHRoaXMuY29tbW9uVXRpbCwgUFVCTElTSF9NRU5VX0xPQ0FMRSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMubG9jYWxlU2VyLmxhbmdEYXRhWydwdWJsaXNobWVudSddKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2NhbGVTZXIuc2V0TG9jYWxlRGF0YShQVUJMSVNIX01FTlVfTE9DQUxFKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICB9XHJcblxyXG4gICAgbmdPbkluaXQoKSB7XHJcbiAgICAgICAgLy8gdGhpcy5pbml0QWxsRnVuY1RyZWUoKTtcclxuICAgIH1cclxuXHJcbiAgICBuZ09uQ2hhbmdlcyhjaGFuZ2VzOiBTaW1wbGVDaGFuZ2VzKSB7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIGVtcHR5RGF0YSgpIHtcclxuICAgICAgICB0aGlzLmZ1bmNNb2RlbCA9IHtcclxuICAgICAgICAgICAgYXBwSWQ6ICcnLFxyXG4gICAgICAgICAgICBhcHBJbnZva0lkOiAnJyxcclxuICAgICAgICAgICAgYml6T2JqZWN0SWQ6ICcnLFxyXG4gICAgICAgICAgICBiaXpPcElkOiAnJyxcclxuICAgICAgICAgICAgY29kZTogJycsXHJcbiAgICAgICAgICAgIGNyZWF0b3I6ICcnLFxyXG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogJycsXHJcbiAgICAgICAgICAgIGZ1bmNUeXBlOiAnNCcsXHJcbiAgICAgICAgICAgIGlkOiB0aGlzLnV1aWQuZ2VuZXJhdGUoKSxcclxuICAgICAgICAgICAgaWNvbjogJycsXHJcbiAgICAgICAgICAgIGlzRGV0YWlsOiB0cnVlLFxyXG4gICAgICAgICAgICBpc0Rpc3BsYXllZDogdHJ1ZSxcclxuICAgICAgICAgICAgaXNTeXNJbml0OiBmYWxzZSxcclxuICAgICAgICAgICAgbGF5ZXI6ICc0JyxcclxuICAgICAgICAgICAgbWVudVR5cGU6ICcxJyxcclxuICAgICAgICAgICAgbmFtZTogJycsXHJcbiAgICAgICAgICAgIHBhcmVudElkOiAnJyxcclxuICAgICAgICAgICAgcGF0aDogJycsXHJcbiAgICAgICAgICAgIHN0YXRpY1BhcmFtczogW3tuYW1lOiAnbW9kZScsIHZhbHVlOiAnc3BhJ31dLFxyXG4gICAgICAgICAgICB1cmw6ICcnLFxyXG4gICAgICAgICAgICBuYW1lTGFuZ3VhZ2U6IG51bGxcclxuICAgICAgICB9O1xyXG4gICAgfVxyXG5cclxuICAgIHZhbGlkYXRlKCkge1xyXG4gICAgICAgIGxldCBtc2cgPSAnJztcclxuICAgICAgICBpZiAoIXRoaXMuZnVuY01vZGVsLnBhcmVudElkKSB7XHJcbiAgICAgICAgICAgIG1zZyArPSB0aGlzLmxvY2FsZVNlci5nZXRWYWx1ZSgncHVibGlzaG1lbnUuZnVuYy5tZXNzYWdlLnBhcmVudElkJyk7IC8vICfor7flnKjlt6bkvqfpgInmi6nkuIrnuqfoj5zljZXvvIE8YnI+JztcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICghbXNnKSB7XHJcbiAgICAgICAgICAgIGlmICghdGhpcy5mdW5jTW9kZWwuY29kZSkge1xyXG4gICAgICAgICAgICAgICAgbXNnICs9ICB0aGlzLmxvY2FsZVNlci5nZXRWYWx1ZSgncHVibGlzaG1lbnUuZnVuYy5tZXNzYWdlLmNvZGUnKTsgLy8gJ+WKn+iDvee8luWPt+S4jeiDveS4uuepuu+8gTxicj4nO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAoIXRoaXMuZnVuY01vZGVsLm5hbWUpIHtcclxuICAgICAgICAgICAgICAgIG1zZyArPSAgdGhpcy5sb2NhbGVTZXIuZ2V0VmFsdWUoJ3B1Ymxpc2htZW51LmZ1bmMubWVzc2FnZS5uYW1lJyk7IC8vICflip/og73lkI3np7DkuI3og73kuLrnqbrvvIE8YnI+JztcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKCF0aGlzLmZ1bmNNb2RlbC5iaXpPcElkKSB7XHJcbiAgICAgICAgICAgICAgICBtc2cgKz0gdGhpcy5sb2NhbGVTZXIuZ2V0VmFsdWUoJ3B1Ymxpc2htZW51LmZ1bmMubWVzc2FnZS5iaXpPcElkJyk7ICAvLyAn6K+36YCJ5oup5Yqf6IO95pON5L2c77yBIDxicj4nO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAoIXRoaXMuZnVuY01vZGVsLmFwcElkKSB7XHJcbiAgICAgICAgICAgICAgICBtc2cgKz0gdGhpcy5sb2NhbGVTZXIuZ2V0VmFsdWUoJ3B1Ymxpc2htZW51LmZ1bmMubWVzc2FnZS5hcHBpZCcpOyAgLy8gJ+ivt+mAieaLqeWFs+iBlOW6lOeUqO+8gTxicj4nO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAoIXRoaXMuZnVuY01vZGVsLmFwcEludm9rSWQpIHtcclxuICAgICAgICAgICAgICAgIG1zZyArPSB0aGlzLmxvY2FsZVNlci5nZXRWYWx1ZSgncHVibGlzaG1lbnUuZnVuYy5tZXNzYWdlLmFwcEludm9rSWQnKTsgIC8vICfor7fpgInmi6nlhbPogZTlupTnlKjlhaXlj6PvvIE8YnI+JztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBpZiAoIXRoaXMuZnVuY01vZGVsLmJpek9iamVjdElkKSB7XHJcbiAgICAgICAgLy8gICAgIG1zZyArPSB0aGlzLmxvY2FsZVNlci5nZXRWYWx1ZSgncHVibGlzaG1lbnUuZnVuYy5tZXNzYWdlLmJpek9iamVjdElkJyk7ICAvLyAn6K+36YCJ5oup5bem5L6n5Lia5Yqh5pON5L2c5a+56LGh77yBIDxicj4nO1xyXG4gICAgICAgIC8vIH1cclxuXHJcblxyXG4gICAgICAgIGlmIChtc2cpIHtcclxuICAgICAgICAgICAgdGhpcy5tZXNzYWdlclNlci5zaG93KCd3YXJuaW5nJywgbXNnLCB7IHNhZmVIdG1sOiBmYWxzZSwgaGVpZ2h0OiAzMDAgfSk7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9XHJcblxyXG4gICAgc2F2ZU1lbnUoKSB7XHJcbiAgICAgICAgdGhpcy5mdW5jTW9kZWwubmFtZSA9IHRoaXMuZnVuY01vZGVsLm5hbWVMYW5ndWFnZSA/IHRoaXMuZnVuY01vZGVsLm5hbWVMYW5ndWFnZVt0aGlzLmxvY2FsZUlkXSA6ICcnO1xyXG4gICAgICAgIGlmICh0aGlzLnZhbGlkYXRlKCkpIHtcclxuICAgICAgICAgICAgY29uc3Qgc3RhdGljUGFyYW1zID0gSlNPTi5zdHJpbmdpZnkodGhpcy5mdW5jTW9kZWwuc3RhdGljUGFyYW1zKTtcclxuICAgICAgICAgICAgY29uc3QgX2Z1bmNNb2RlbCA9IGNsb25lRGVlcCh0aGlzLmZ1bmNNb2RlbCk7XHJcbiAgICAgICAgICAgIF9mdW5jTW9kZWwuc3RhdGljUGFyYW1zID0gc3RhdGljUGFyYW1zO1xyXG4gICAgICAgICAgICBfZnVuY01vZGVsLm5hbWUgPSBfZnVuY01vZGVsLm5hbWVMYW5ndWFnZVt0aGlzLmxvY2FsZUlkXTtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuaHR0cC5wb3N0KHRoaXMuRlVOQ19QT1NUX1VSSSwgX2Z1bmNNb2RlbCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gb2YoZmFsc2UpO1xyXG4gICAgfVxyXG5cclxuICAgIHNob3coKSB7XHJcbiAgICAgICAgY29uc3QgbW9kYWxSZWYgPSB0aGlzLm1vZGFsU2VydmljZS5zaG93KHRoaXMuZGxnQ29udGVudCwge1xyXG4gICAgICAgICAgICB0aXRsZTogdGhpcy5sb2NhbGVTZXIuZ2V0VmFsdWUoJ3B1Ymxpc2htZW51LmRpYWxvZy50aXRsZScpLFxyXG4gICAgICAgICAgICB3aWR0aDogNzYwLCBoZWlnaHQ6IDUwMCxcclxuICAgICAgICAgICAgc2hvd01heEJ1dHRvbjogZmFsc2UsXHJcbiAgICAgICAgICAgIHJlc2l6YWJsZTogZmFsc2UsXHJcbiAgICAgICAgICAgIGVuYWJsZVNjcm9sbDogZmFsc2UsXHJcbiAgICAgICAgICAgIGJ1dHRvbnM6IFtcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICB0ZXh0OiB0aGlzLmxvY2FsZVNlci5nZXRWYWx1ZSgncHVibGlzaG1lbnUuZGlhbG9nLmJ0bk9rJyksXHJcbiAgICAgICAgICAgICAgICAgICAgY2xzOiAnYnRuIGJ0bi1wcmltYXJ5JyxcclxuICAgICAgICAgICAgICAgICAgICBoYW5kbGU6ICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zYXZlTWVudSgpLnN1YnNjcmliZShyID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5tZXNzYWdlclNlci5zdWNjZXNzKCB0aGlzLmxvY2FsZVNlci5nZXRWYWx1ZSgncHVibGlzaG1lbnUuZGlhbG9nLnN1Y2Nlc3MnKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbW9kYWxSZWYuY2xvc2UoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNob3dNYXNrID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfSwgKGVycjogYW55KSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGVycik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXJyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZXJyb3IgPSBlcnIuZXJyb3I7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG1lc2cgPSBlcnJvci5NZXNzYWdlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm1lc3NhZ2VyU2VyLndhcm5pbmcobWVzZyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIHRleHQ6IHRoaXMubG9jYWxlU2VyLmdldFZhbHVlKCdwdWJsaXNobWVudS5kaWFsb2cuYnRuQ2FuY2VsJyksXHJcbiAgICAgICAgICAgICAgICAgICAgY2xzOiAnYnRuIGJ0bi1zZWNvbmRhcnknLFxyXG4gICAgICAgICAgICAgICAgICAgIGhhbmRsZTogKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBtb2RhbFJlZi5jbG9zZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNob3dNYXNrID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIF0sXHJcbiAgICAgICAgICAgIG9wZW5lZDogKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5pbml0QWxsRnVuY1RyZWUoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMuZW1wdHlEYXRhKCk7XHJcbiAgICAgICAgcmV0dXJuIG1vZGFsUmVmO1xyXG4gICAgfVxyXG4gICAgLy8g6YCJ5oup5YWz6IGU5bqU55SoXHJcbiAgICBzaG93U2VsZWN0QXBwTW9kYWwoKSB7XHJcbiAgICAgICAgY29uc3QgbW9kYWxSZWYgPSB0aGlzLm1vZGFsU2VydmljZS5zaG93KFNlbGVjdEFwcENvbXBvbmVudCwge1xyXG4gICAgICAgICAgICB0aXRsZTogdGhpcy5sb2NhbGVTZXIuZ2V0VmFsdWUoJ3B1Ymxpc2htZW51LmRpYWxvZy5zZWxlY3RhcHAnKSxcclxuICAgICAgICAgICAgd2lkdGg6IDc2MCwgaGVpZ2h0OiA1MDAsXHJcbiAgICAgICAgICAgIGVuYWJsZVNjcm9sbDogZmFsc2UsXHJcbiAgICAgICAgICAgIHNob3dNYXhCdXR0b246IGZhbHNlLFxyXG4gICAgICAgICAgICByZXNpemFibGU6IGZhbHNlLFxyXG4gICAgICAgICAgICBpbml0aWFsU3RhdGU6IHtcclxuICAgICAgICAgICAgICAgIHNlcnZlcklwOiB0aGlzLnNlcnZlcklwLFxyXG4gICAgICAgICAgICAgICAgZnVuY01vZGVsOiB0aGlzLmZ1bmNNb2RlbFxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBidXR0b25zOiBbXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGV4dDogdGhpcy5sb2NhbGVTZXIuZ2V0VmFsdWUoJ3B1Ymxpc2htZW51LmRpYWxvZy5idG5PaycpLFxyXG4gICAgICAgICAgICAgICAgICAgIGNsczogJ2J0biBidG4tcHJpbWFyeScsXHJcbiAgICAgICAgICAgICAgICAgICAgaGFuZGxlOiAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHNhYyA9IG1vZGFsUmVmLmNvbnRlbnQgYXMgU2VsZWN0QXBwQ29tcG9uZW50O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgbXNnID0gJyc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzYWMuYXBwSWQgJiYgc2FjLmFwcEludm9rSWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZnVuY01vZGVsLmFwcElkID0gc2FjLmFwcElkO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5mdW5jTW9kZWwuYXBwSW52b2tJZCA9IHNhYy5hcHBJbnZva0lkO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbXNnID0gJyc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghc2FjLmFwcElkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtc2cgPSB0aGlzLmxvY2FsZVNlci5nZXRWYWx1ZSgncHVibGlzaG1lbnUuZGlhbG9nLnNlbGVjdEluZm8nKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICghc2FjLmFwcEludm9rSWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1zZyA9IHRoaXMubG9jYWxlU2VyLmdldFZhbHVlKCdwdWJsaXNobWVudS5kaWFsb2cuYXBwZW50cnknKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG1zZykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5tZXNzYWdlclNlci53YXJuaW5nKG1zZyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtb2RhbFJlZi5jbG9zZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICB0ZXh0OiAgdGhpcy5sb2NhbGVTZXIuZ2V0VmFsdWUoJ3B1Ymxpc2htZW51LmRpYWxvZy5idG5DYW5jZWwnKSxcclxuICAgICAgICAgICAgICAgICAgICBjbHM6ICdidG4gYnRuLXNlY29uZGFyeScsXHJcbiAgICAgICAgICAgICAgICAgICAgaGFuZGxlOiAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1vZGFsUmVmLmNsb3NlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBdXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiBtb2RhbFJlZjtcclxuICAgIH1cclxuXHJcbiAgICAvLyDpgInmi6nkuJrliqHmk43kvZxcclxuICAgIHNob3dCaXpPYmplY3RPcGVyYXRvck1vZGFsKCkge1xyXG4gICAgICAgIGNvbnN0IG1vZGFsUmVmID0gdGhpcy5tb2RhbFNlcnZpY2Uuc2hvdyhCaXpvYmplY3RPcGVyYXRvcnNDb21wb25lbnQsIHtcclxuICAgICAgICAgICAgdGl0bGU6IHRoaXMubG9jYWxlU2VyLmdldFZhbHVlKCdwdWJsaXNobWVudS5kaWFsb2cuYml6T3B0aXRsZScpLFxyXG4gICAgICAgICAgICB3aWR0aDogNzYwLCBoZWlnaHQ6IDUwMCxcclxuICAgICAgICAgICAgZW5hYmxlU2Nyb2xsOiBmYWxzZSxcclxuICAgICAgICAgICAgc2hvd01heEJ1dHRvbjogZmFsc2UsXHJcbiAgICAgICAgICAgIHJlc2l6YWJsZTogZmFsc2UsXHJcbiAgICAgICAgICAgIGluaXRpYWxTdGF0ZToge1xyXG4gICAgICAgICAgICAgICAgc2VydmVySXA6IHRoaXMuc2VydmVySXAsXHJcbiAgICAgICAgICAgICAgICBmdW5jTW9kZWw6IHRoaXMuZnVuY01vZGVsXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGJ1dHRvbnM6IFtcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICB0ZXh0OiB0aGlzLmxvY2FsZVNlci5nZXRWYWx1ZSgncHVibGlzaG1lbnUuZGlhbG9nLmJ0bk9rJyksXHJcbiAgICAgICAgICAgICAgICAgICAgY2xzOiAnYnRuIGJ0bi1wcmltYXJ5JyxcclxuICAgICAgICAgICAgICAgICAgICBoYW5kbGU6ICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgYm9jID0gbW9kYWxSZWYuY29udGVudCBhcyBCaXpvYmplY3RPcGVyYXRvcnNDb21wb25lbnQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGJpek9iaiA9IGJvYy5iaXpPYmplY3RJZCBhcyBUcmVlTm9kZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgYml6T3AgPSBib2MuYml6T3BJZCBhcyBTZWxlY3RlZFJvdztcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChiaXpPcCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGJpek9iaklEID0gJyc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWJpek9iaikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJpek9iaklEID0gYml6T3AuZGF0YS5idXNpbmVzc0lkO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiaXpPYmpJRCA9IGJpek9iai5pZDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYml6T2JqSUQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmZ1bmNNb2RlbC5iaXpPYmplY3RJZCA9IGJpek9iaklEO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZnVuY01vZGVsLmJpek9wSWQgPSBiaXpPcC5pZDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtb2RhbFJlZi5jbG9zZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm1lc3NhZ2VyU2VyLndhcm5pbmcodGhpcy5sb2NhbGVTZXIuZ2V0VmFsdWUoJ3B1Ymxpc2htZW51LmRpYWxvZy5iaXp3YXJuJykpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5tZXNzYWdlclNlci53YXJuaW5nKHRoaXMubG9jYWxlU2VyLmdldFZhbHVlKCdwdWJsaXNobWVudS5kaWFsb2cuYml6YWN0aW9uJykpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICB0ZXh0OiAgdGhpcy5sb2NhbGVTZXIuZ2V0VmFsdWUoJ3B1Ymxpc2htZW51LmRpYWxvZy5idG5DYW5jZWwnKSxcclxuICAgICAgICAgICAgICAgICAgICBjbHM6ICdidG4gYnRuLXNlY29uZGFyeScsXHJcbiAgICAgICAgICAgICAgICAgICAgaGFuZGxlOiAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1vZGFsUmVmLmNsb3NlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBdXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiBtb2RhbFJlZjtcclxuICAgIH1cclxuICAgIC8vIOaWsOW7uuW6lOeUqFxyXG4gICAgc2hvd0FwcE1vZGFsKCkge1xyXG4gICAgICAgIGNvbnN0IG1vZGFsUmVmID0gdGhpcy5tb2RhbFNlcnZpY2Uuc2hvdyhHc3BBcHBNYW5hZ2VyQ29tcG9uZW50LCB7XHJcbiAgICAgICAgICAgIHRpdGxlOiB0aGlzLmxvY2FsZVNlci5nZXRWYWx1ZSgncHVibGlzaG1lbnUuZGlhbG9nLmFwcCcpLFxyXG4gICAgICAgICAgICB3aWR0aDogNzYwLCBoZWlnaHQ6IDUwMCxcclxuICAgICAgICAgICAgc2hvd01heEJ1dHRvbjogZmFsc2UsXHJcbiAgICAgICAgICAgIHJlc2l6YWJsZTogZmFsc2UsXHJcbiAgICAgICAgICAgIGVuYWJsZVNjcm9sbDogZmFsc2UsXHJcbiAgICAgICAgICAgIGluaXRpYWxTdGF0ZToge1xyXG4gICAgICAgICAgICAgICAgc2VydmVySXA6IHRoaXMuc2VydmVySXAsXHJcbiAgICAgICAgICAgICAgICBwYXRoOiAodGhpcy5wdWJsaXNoUGF0aCB8fCAnJykucmVwbGFjZSgnaW5kZXguaHRtbGluZGV4Lmh0bWwnLCAnaW5kZXguaHRtbCcpLFxyXG4gICAgICAgICAgICAgICAgZnVuY01vZGVsOiB0aGlzLmZ1bmNNb2RlbFxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBidXR0b25zOiBbXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGV4dDogdGhpcy5sb2NhbGVTZXIuZ2V0VmFsdWUoJ3B1Ymxpc2htZW51LmRpYWxvZy5idG5PaycpLFxyXG4gICAgICAgICAgICAgICAgICAgIGNsczogJ2J0biBidG4tcHJpbWFyeScsXHJcbiAgICAgICAgICAgICAgICAgICAgaGFuZGxlOiAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGFtYyA9IG1vZGFsUmVmLmNvbnRlbnQgYXMgR3NwQXBwTWFuYWdlckNvbXBvbmVudDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFtYy52YWxpZGF0ZSgpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmxvYWRpbmdTZXIuc2hvdygpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5odHRwLnBvc3QodGhpcy5BUFBfUE9TVF9VUkksIGFtYy5hcHBNb2RlbCkuc3Vic2NyaWJlKHIgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZnVuY01vZGVsLmFwcElkID0gYW1jLmFwcE1vZGVsLmlkO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmZ1bmNNb2RlbC5hcHBJbnZva0lkID0gYW1jLmFwcE1vZGVsLmFwcEludm9rc1swXS5pZDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2FkaW5nU2VyLmNsb3NlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vZGFsUmVmLmNsb3NlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coYW1jLmFwcE1vZGVsKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIHRleHQ6IHRoaXMubG9jYWxlU2VyLmdldFZhbHVlKCdwdWJsaXNobWVudS5kaWFsb2cuYnRuQ2FuY2VsJyksXHJcbiAgICAgICAgICAgICAgICAgICAgY2xzOiAnYnRuIGJ0bi1zZWNvbmRhcnknLFxyXG4gICAgICAgICAgICAgICAgICAgIGhhbmRsZTogKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBtb2RhbFJlZi5jbG9zZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgXVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXR1cm4gbW9kYWxSZWY7XHJcbiAgICB9XHJcblxyXG4gICAgdHJlZU5vZGVDbGlja2VkKGUpIHtcclxuICAgICAgICB0aGlzLmZ1bmNNb2RlbC5wYXJlbnRJZCA9IGUubm9kZS5kYXRhLmlkO1xyXG4gICAgICAgIHRoaXMuc2hvd01hc2sgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLmNkLmRldGVjdENoYW5nZXMoKTtcclxuICAgICAgICBjb25zdCBpbnB1dDogYW55ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3R4dEZ1bmNDb2RlJyk7XHJcbiAgICAgICAgaWYgKGlucHV0KSB7XHJcbiAgICAgICAgICAgIGlucHV0LmNsaWNrKCk7XHJcbiAgICAgICAgICAgIGlucHV0LmZvY3VzKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHJlbW92ZVN0YXRpY1BhcmFtcyhuYW1lKSB7XHJcbiAgICAgICAgdGhpcy5mdW5jTW9kZWwuc3RhdGljUGFyYW1zID0gdGhpcy5mdW5jTW9kZWwuc3RhdGljUGFyYW1zLmZpbHRlcihuID0+IG4ubmFtZSAhPT0gbmFtZSk7XHJcbiAgICB9XHJcblxyXG4gICAgYWRkU3RhdGljUGFyYW1zKCkge1xyXG4gICAgICAgIHRoaXMuZnVuY01vZGVsLnN0YXRpY1BhcmFtcy5wdXNoKHtuYW1lOiAnJywgdmFsdWU6ICcnfSk7XHJcbiAgICB9XHJcblxyXG5cclxuICAgIHByaXZhdGUgaW5pdEFsbEZ1bmNUcmVlKCkge1xyXG4gICAgICAgIHRoaXMuaHR0cC5nZXQodGhpcy5GVU5DX1VSSSkuc3Vic2NyaWJlKGRhdGEgPT4ge1xyXG4gICAgICAgICAgICBpZiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5hbGxGdW5jVHJlZURhdGEgPSB0aGlzLmNvbnZlcnQyVHJlZU5vZGVzKGRhdGEpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBjb252ZXJ0MlRyZWVOb2RlcyhkYXRhOiBhbnlbXSwgcGFyZW50SWQgPSAnMCcpOiBUcmVlTm9kZVtdIHtcclxuICAgICAgICBpZiAoZGF0YS5sZW5ndGgpIHtcclxuICAgICAgICAgICAgY29uc3Qgbm9kZXMgPSBkYXRhLmZpbHRlcigodikgPT4gdi5wYXJlbnRJZCA9PT0gcGFyZW50SWQpO1xyXG4gICAgICAgICAgICByZXR1cm4gbm9kZXMubWFwKGl0ZW0gPT4ge1xyXG4gICAgICAgICAgICAgICAgY29uc3Qgbm9kZSA9IHtcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiBpdGVtLFxyXG4gICAgICAgICAgICAgICAgICAgIGNoaWxkcmVuOiBbXSxcclxuICAgICAgICAgICAgICAgICAgICBzZWxlY3RhYmxlOiBpdGVtLmxheWVyID09PSAnMydcclxuICAgICAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICAgICAgbm9kZS5jaGlsZHJlbiA9IHRoaXMuY29udmVydDJUcmVlTm9kZXMoZGF0YSwgaXRlbS5pZCk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbm9kZTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBbXTtcclxuICAgIH1cclxuXHJcbn1cclxuIl19