/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { cloneDeep } from 'lodash-es';
import { LoadingService } from '@farris/ui-loading';
import { MessagerService } from '@farris/ui-messager';
import { Component, Injector, Input, LOCALE_ID, ViewChild, TemplateRef, ChangeDetectorRef, ViewEncapsulation } from '@angular/core';
import { HttpService } from '@farris/ide-devkit';
import { BsModalService } from '@farris/ui-modal';
import { GspAppManagerComponent } from './gsp-app/gsp-app.component';
import { IdService } from '@farris/ui-common';
import { BizobjectOperatorsComponent } from './biz-object-operators/bizobject-operators.component';
import { SelectAppComponent } from './select-app/select-app.component';
import { of } from 'rxjs';
import { LocaleService } from '@farris/ui-locale';
import { CommonUtils } from '@farris/ui-common';
import { PUBLISH_MENU_LOCALE } from './locale';
export class PublishMenuComponent {
    /**
     * @param {?} http
     * @param {?} injector
     * @param {?} modalService
     * @param {?} uuid
     * @param {?} messagerSer
     * @param {?} loadingSer
     * @param {?} cd
     */
    constructor(http, injector, modalService, uuid, messagerSer, loadingSer, cd) {
        this.http = http;
        this.injector = injector;
        this.modalService = modalService;
        this.uuid = uuid;
        this.messagerSer = messagerSer;
        this.loadingSer = loadingSer;
        this.cd = cd;
        this.serverIp = '';
        this.publishPath = '';
        /**
         * 所有功能菜单数据
         */
        this.allFuncTreeData = [];
        this.funcIdField = 'id';
        this.showMask = true;
        this.languages = [
            { code: 'zh-CHS', name: '中文简体' },
            { code: 'en', name: 'English' },
            { code: 'zh-CHT', name: '中文繁体' }
        ];
        this.funcModel = null;
        this.localeId = 'zh-CHS';
        this.commonUtil = this.injector.get(CommonUtils);
        this.localeId = this.injector.get(LOCALE_ID, 'zh-CHS');
        if (this.localeId === 'zh') {
            this.localeId = 'zh-CHS';
        }
        if (!this.localeSer) {
            this.localeSer = this.injector.get(LocaleService, null);
            if (!this.localeSer) {
                this.localeSer = new LocaleService(this.localeId, this.commonUtil, PUBLISH_MENU_LOCALE);
            }
            else {
                if (!this.localeSer.langData['publishmenu']) {
                    this.localeSer.setLocaleData(PUBLISH_MENU_LOCALE);
                }
            }
        }
    }
    /**
     * @private
     * @return {?}
     */
    get FUNC_URI() {
        return this.serverIp + '/api/runtime/sys/v1.0/functions/allFuncs';
    }
    /**
     * @private
     * @return {?}
     */
    get APP_URI() {
        return this.serverIp + '/api/runtime/sys/v1.0/gspapp/all';
    }
    /**
     * @private
     * @return {?}
     */
    get APP_POST_URI() {
        return this.serverIp + '/api/runtime/sys/v1.0/gspapp';
    }
    /**
     * @private
     * @return {?}
     */
    get FUNC_POST_URI() {
        return this.serverIp + '/api/runtime/sys/v1.0/functions';
    }
    /**
     * @return {?}
     */
    ngOnInit() {
        // this.initAllFuncTree();
    }
    /**
     * @param {?} changes
     * @return {?}
     */
    ngOnChanges(changes) {
    }
    /**
     * @return {?}
     */
    emptyData() {
        this.funcModel = {
            appId: '',
            appInvokId: '',
            bizObjectId: '',
            bizOpId: '',
            code: '',
            creator: '',
            description: '',
            funcType: '4',
            id: this.uuid.generate(),
            icon: '',
            isDetail: true,
            isDisplayed: true,
            isSysInit: false,
            layer: '4',
            menuType: '1',
            name: '',
            parentId: '',
            path: '',
            staticParams: [{ name: 'mode', value: 'spa' }],
            url: '',
            nameLanguage: null
        };
    }
    /**
     * @return {?}
     */
    validate() {
        /** @type {?} */
        let msg = '';
        if (!this.funcModel.parentId) {
            msg += this.localeSer.getValue('publishmenu.func.message.parentId'); // '请在左侧选择上级菜单！<br>';
        }
        if (!msg) {
            if (!this.funcModel.code) {
                msg += this.localeSer.getValue('publishmenu.func.message.code'); // '功能编号不能为空！<br>';
            }
            if (!this.funcModel.name) {
                msg += this.localeSer.getValue('publishmenu.func.message.name'); // '功能名称不能为空！<br>';
            }
            if (!this.funcModel.bizOpId) {
                msg += this.localeSer.getValue('publishmenu.func.message.bizOpId'); // '请选择功能操作！ <br>';
            }
            if (!this.funcModel.appId) {
                msg += this.localeSer.getValue('publishmenu.func.message.appid'); // '请选择关联应用！<br>';
            }
            if (!this.funcModel.appInvokId) {
                msg += this.localeSer.getValue('publishmenu.func.message.appInvokId'); // '请选择关联应用入口！<br>';
            }
        }
        // if (!this.funcModel.bizObjectId) {
        //     msg += this.localeSer.getValue('publishmenu.func.message.bizObjectId');  // '请选择左侧业务操作对象！ <br>';
        // }
        if (msg) {
            this.messagerSer.show('warning', msg, { safeHtml: false, height: 300 });
            return false;
        }
        return true;
    }
    /**
     * @return {?}
     */
    saveMenu() {
        this.funcModel.name = this.funcModel.nameLanguage ? this.funcModel.nameLanguage[this.localeId] : '';
        if (this.validate()) {
            /** @type {?} */
            const staticParams = JSON.stringify(this.funcModel.staticParams);
            /** @type {?} */
            const _funcModel = cloneDeep(this.funcModel);
            _funcModel.staticParams = staticParams;
            _funcModel.name = _funcModel.nameLanguage[this.localeId];
            return this.http.post(this.FUNC_POST_URI, _funcModel);
        }
        return of(false);
    }
    /**
     * @return {?}
     */
    show() {
        /** @type {?} */
        const modalRef = this.modalService.show(this.dlgContent, {
            title: this.localeSer.getValue('publishmenu.dialog.title'),
            width: 760, height: 500,
            showMaxButton: false,
            resizable: false,
            enableScroll: false,
            buttons: [
                {
                    text: this.localeSer.getValue('publishmenu.dialog.btnOk'),
                    cls: 'btn btn-primary',
                    handle: (/**
                     * @return {?}
                     */
                    () => {
                        this.saveMenu().subscribe((/**
                         * @param {?} r
                         * @return {?}
                         */
                        r => {
                            if (r) {
                                this.messagerSer.success(this.localeSer.getValue('publishmenu.dialog.success'));
                                modalRef.close();
                                this.showMask = true;
                            }
                        }), (/**
                         * @param {?} err
                         * @return {?}
                         */
                        (err) => {
                            console.error(err);
                            if (err) {
                                /** @type {?} */
                                const error = err.error;
                                if (error) {
                                    /** @type {?} */
                                    const mesg = error.Message;
                                    this.messagerSer.warning(mesg);
                                }
                            }
                        }));
                    })
                },
                {
                    text: this.localeSer.getValue('publishmenu.dialog.btnCancel'),
                    cls: 'btn btn-secondary',
                    handle: (/**
                     * @return {?}
                     */
                    () => {
                        modalRef.close();
                        this.showMask = true;
                    })
                }
            ],
            opened: (/**
             * @return {?}
             */
            () => {
                this.initAllFuncTree();
            })
        });
        this.emptyData();
        return modalRef;
    }
    // 选择关联应用
    /**
     * @return {?}
     */
    showSelectAppModal() {
        /** @type {?} */
        const modalRef = this.modalService.show(SelectAppComponent, {
            title: this.localeSer.getValue('publishmenu.dialog.selectapp'),
            width: 760, height: 500,
            enableScroll: false,
            showMaxButton: false,
            resizable: false,
            initialState: {
                serverIp: this.serverIp,
                funcModel: this.funcModel
            },
            buttons: [
                {
                    text: this.localeSer.getValue('publishmenu.dialog.btnOk'),
                    cls: 'btn btn-primary',
                    handle: (/**
                     * @return {?}
                     */
                    () => {
                        /** @type {?} */
                        const sac = (/** @type {?} */ (modalRef.content));
                        /** @type {?} */
                        let msg = '';
                        if (sac.appId && sac.appInvokId) {
                            this.funcModel.appId = sac.appId;
                            this.funcModel.appInvokId = sac.appInvokId;
                            msg = '';
                        }
                        if (!sac.appId) {
                            msg = this.localeSer.getValue('publishmenu.dialog.selectInfo');
                        }
                        else if (!sac.appInvokId) {
                            msg = this.localeSer.getValue('publishmenu.dialog.appentry');
                        }
                        if (msg) {
                            this.messagerSer.warning(msg);
                        }
                        else {
                            modalRef.close();
                        }
                    })
                },
                {
                    text: this.localeSer.getValue('publishmenu.dialog.btnCancel'),
                    cls: 'btn btn-secondary',
                    handle: (/**
                     * @return {?}
                     */
                    () => {
                        modalRef.close();
                    })
                }
            ]
        });
        return modalRef;
    }
    // 选择业务操作
    /**
     * @return {?}
     */
    showBizObjectOperatorModal() {
        /** @type {?} */
        const modalRef = this.modalService.show(BizobjectOperatorsComponent, {
            title: this.localeSer.getValue('publishmenu.dialog.bizOptitle'),
            width: 760, height: 500,
            enableScroll: false,
            showMaxButton: false,
            resizable: false,
            initialState: {
                serverIp: this.serverIp,
                funcModel: this.funcModel
            },
            buttons: [
                {
                    text: this.localeSer.getValue('publishmenu.dialog.btnOk'),
                    cls: 'btn btn-primary',
                    handle: (/**
                     * @return {?}
                     */
                    () => {
                        /** @type {?} */
                        const boc = (/** @type {?} */ (modalRef.content));
                        /** @type {?} */
                        const bizObj = (/** @type {?} */ (boc.bizObjectId));
                        /** @type {?} */
                        const bizOp = (/** @type {?} */ (boc.bizOpId));
                        if (bizOp) {
                            /** @type {?} */
                            let bizObjID = '';
                            if (!bizObj) {
                                bizObjID = bizOp.data.businessId;
                            }
                            else {
                                bizObjID = bizObj.id;
                            }
                            if (bizObjID) {
                                this.funcModel.bizObjectId = bizObjID;
                                this.funcModel.bizOpId = bizOp.id;
                                modalRef.close();
                            }
                            else {
                                this.messagerSer.warning(this.localeSer.getValue('publishmenu.dialog.bizwarn'));
                            }
                        }
                        else {
                            this.messagerSer.warning(this.localeSer.getValue('publishmenu.dialog.bizaction'));
                        }
                    })
                },
                {
                    text: this.localeSer.getValue('publishmenu.dialog.btnCancel'),
                    cls: 'btn btn-secondary',
                    handle: (/**
                     * @return {?}
                     */
                    () => {
                        modalRef.close();
                    })
                }
            ]
        });
        return modalRef;
    }
    // 新建应用
    /**
     * @return {?}
     */
    showAppModal() {
        /** @type {?} */
        const modalRef = this.modalService.show(GspAppManagerComponent, {
            title: this.localeSer.getValue('publishmenu.dialog.app'),
            width: 760, height: 500,
            showMaxButton: false,
            resizable: false,
            enableScroll: false,
            initialState: {
                serverIp: this.serverIp,
                path: (this.publishPath || '').replace('index.htmlindex.html', 'index.html'),
                funcModel: this.funcModel
            },
            buttons: [
                {
                    text: this.localeSer.getValue('publishmenu.dialog.btnOk'),
                    cls: 'btn btn-primary',
                    handle: (/**
                     * @return {?}
                     */
                    () => {
                        /** @type {?} */
                        const amc = (/** @type {?} */ (modalRef.content));
                        if (amc.validate()) {
                            this.loadingSer.show();
                            this.http.post(this.APP_POST_URI, amc.appModel).subscribe((/**
                             * @param {?} r
                             * @return {?}
                             */
                            r => {
                                if (r) {
                                    this.funcModel.appId = amc.appModel.id;
                                    this.funcModel.appInvokId = amc.appModel.appInvoks[0].id;
                                    this.loadingSer.close();
                                    modalRef.close();
                                }
                            }));
                        }
                        // console.log(amc.appModel);
                    })
                },
                {
                    text: this.localeSer.getValue('publishmenu.dialog.btnCancel'),
                    cls: 'btn btn-secondary',
                    handle: (/**
                     * @return {?}
                     */
                    () => {
                        modalRef.close();
                    })
                }
            ]
        });
        return modalRef;
    }
    /**
     * @param {?} e
     * @return {?}
     */
    treeNodeClicked(e) {
        this.funcModel.parentId = e.node.data.id;
        this.showMask = false;
        this.cd.detectChanges();
        /** @type {?} */
        const input = document.querySelector('#txtFuncCode');
        if (input) {
            input.click();
            input.focus();
        }
    }
    /**
     * @param {?} name
     * @return {?}
     */
    removeStaticParams(name) {
        this.funcModel.staticParams = this.funcModel.staticParams.filter((/**
         * @param {?} n
         * @return {?}
         */
        n => n.name !== name));
    }
    /**
     * @return {?}
     */
    addStaticParams() {
        this.funcModel.staticParams.push({ name: '', value: '' });
    }
    /**
     * @private
     * @return {?}
     */
    initAllFuncTree() {
        this.http.get(this.FUNC_URI).subscribe((/**
         * @param {?} data
         * @return {?}
         */
        data => {
            if (data) {
                this.allFuncTreeData = this.convert2TreeNodes(data);
            }
        }));
    }
    /**
     * @private
     * @param {?} data
     * @param {?=} parentId
     * @return {?}
     */
    convert2TreeNodes(data, parentId = '0') {
        if (data.length) {
            /** @type {?} */
            const nodes = data.filter((/**
             * @param {?} v
             * @return {?}
             */
            (v) => v.parentId === parentId));
            return nodes.map((/**
             * @param {?} item
             * @return {?}
             */
            item => {
                /** @type {?} */
                const node = {
                    data: item,
                    children: [],
                    selectable: item.layer === '3'
                };
                node.children = this.convert2TreeNodes(data, item.id);
                return node;
            }));
        }
        return [];
    }
}
PublishMenuComponent.decorators = [
    { type: Component, args: [{
                selector: 'publish-menu',
                template: "\r\n<ng-template #dlgContent>\r\n\r\n<div class=\"d-flex flex-row\" style=\"width: 760px; height: 400px;border:0px solid #ae00e6\">\r\n    <!-- Left -->\r\n    <div region=\"west\" class=\"west\" style=\"width: 280px;min-width:280px; height: 100%; background-color: #fff;border-right: 1px solid #e2e8f0;\">\r\n        <!-- \u83DC\u5355\u6811 -->\r\n        <div class=\"ps\" style=\"position: relative; height: 100%;\" [perfectScrollbar]=\"{}\">\r\n            <farris-treetable #tt=\"treeTable\" [data]=\"allFuncTreeData\" [idField]=\"funcIdField\" [striped]=\"false\" [fit]=\"true\"\r\n            [findField]=\"'name'\" (nodeSelected)=\"treeNodeClicked($event)\"\r\n            [singleSelect]=\"true\" [showIcon]=\"true\" [showFilterBar]=\"false\" [selectOnCheck]=\"true\" [checkOnSelect]=\"true\">\r\n                <ng-template farrisTemplate=\"body\" let-rowNode let-treeNode=\"node\" let-rowData=\"rowData\" >\r\n                    <tr #row=\"row\" [selectRow]=\"rowNode\" [selectRowDisabled]=\"!rowNode.node.selectable\" [dblclick]=\"true\">\r\n                        <td style=\"border: 0; cursor: pointer;\" [style.color]=\"row.selectRowDisabled? '#595959': '#000000'\">\r\n                            <farris-treeTableToggler [rowNode]=\"rowNode\"></farris-treeTableToggler>\r\n                            <span [innerHTML]=\"rowData['name'] | highlight: tt.findValue : 'name' : 'name'\"></span>\r\n                        </td>\r\n                    </tr>\r\n                </ng-template>\r\n            </farris-treetable>\r\n        </div>\r\n    </div>\r\n\r\n    <!-- main -->\r\n    <div region=\"center\" class=\"center flex-fill public-menu-main\" style=\"color: #000000;overflow: auto;\">\r\n        <div class=\"mengbanban\" *ngIf=\"showMask\" \r\n        style=\"position: absolute; z-index: 10; top: 0; width: 100%; height: 100%;opacity: 0.5; background: #fff; display: block; font-size: 40px; \">\r\n            <h1 style=\"margin-top: 145px; color: #000; margin-left: 20px; \">\u2190 {{ 'publishmenu.func.message.info' | locale }}</h1>\r\n        </div>\r\n        <div class=\"row\" style=\"margin: 10px 15px;\">\r\n            <div class=\"col-12\">\r\n                <div class=\"form-group\">\r\n                    <label for=\"txtFuncId\">{{ 'publishmenu.func.id' | locale: '\u529F\u80FD\u6807\u8BC6' }}</label>\r\n                    <input type=\"text\" class=\"form-control\" id=\"txtFuncId\" disabled [ngModel]=\"funcModel.id\">\r\n                </div>\r\n                <div class=\"form-group\">\r\n                    <label for=\"txtFuncCode\"><span class=\"farris-label-info text-danger\">*</span>{{ 'publishmenu.func.code' | locale: '\u529F\u80FD\u7F16\u53F7' }}</label>\r\n                    <input type=\"text\" class=\"form-control\" id=\"txtFuncCode\" [(ngModel)]=\"funcModel.code\">\r\n                </div>\r\n                <div class=\"form-group\">\r\n                    <label for=\"txtFuncName\"><span class=\"farris-label-info text-danger\">*</span>{{ 'publishmenu.func.name' | locale: '\u529F\u80FD\u540D\u79F0' }}</label>\r\n                    <!-- <input type=\"text\" class=\"form-control\" id=\"txtFuncName\" [(ngModel)]=\"funcModel.name\" > -->\r\n                    <language-textbox \r\n                    [languages]=\"languages\" [(ngModel)]=\"funcModel.nameLanguage\"\r\n                    [enableClear]=\"false\"\r\n                    [readonly]=\"false\"\r\n                    [disabled]=\"false\"\r\n                    [autoFocus]=\"true\"\r\n                    ></language-textbox>\r\n                </div>\r\n                <div class=\"form-group\">\r\n                    <label for=\"txtFuncAction\"><span class=\"farris-label-info text-danger\">*</span>{{ 'publishmenu.func.action' | locale: '\u529F\u80FD\u64CD\u4F5C' }}</label>\r\n\r\n                    <div class=\"input-group\">\r\n                        <input type=\"text\" class=\"form-control\" [(ngModel)]=\"funcModel.bizOpId\" readonly >\r\n                        <div class=\"input-group-append\">\r\n                            <button class=\"btn btn-outline-secondary\" (click)=\"showBizObjectOperatorModal()\" type=\"button\">{{ 'publishmenu.func.selectBiz' | locale: '\u9009\u62E9' }}</button>\r\n                        </div>\r\n                    </div>\r\n\r\n                </div>\r\n                <div class=\"form-group\">\r\n                    <label for=\"txtFuncRemark\">{{ 'publishmenu.func.remark' | locale: '\u529F\u80FD\u63CF\u8FF0' }}</label>\r\n                    <input type=\"text\" class=\"form-control\" id=\"txtFuncRemark\" [(ngModel)]=\"funcModel.description\" >\r\n                </div>\r\n\r\n                <div class=\"form-group\">\r\n                    <label><span class=\"farris-label-info text-danger\">*</span>{{ 'publishmenu.func.linkapp' | locale: '\u5173\u8054\u5E94\u7528' }}</label>\r\n                    <div class=\"input-group\">\r\n                        <input type=\"text\" class=\"form-control\" [(ngModel)]=\"funcModel.appId\" readonly>\r\n                        <div class=\"input-group-append\">\r\n                            <button class=\"btn btn-outline-secondary\" type=\"button\" (click)=\"showSelectAppModal()\">{{ 'publishmenu.func.selectapp' | locale: '\u9009\u62E9' }}</button>\r\n                            <button class=\"btn btn-outline-secondary\" type=\"button\" (click)=\"showAppModal()\">{{ 'publishmenu.func.addapp' | locale: '\u65B0\u5EFA' }}</button>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                <div class=\"form-group\">\r\n                    <label for=\"txtappInvokid\"><span class=\"farris-label-info text-danger\">*</span>{{ 'publishmenu.func.appentry' | locale: '\u5E94\u7528\u5165\u53E3' }}</label>\r\n                    <input type=\"text\" class=\"form-control\" id=\"txtappInvokid\" [ngModel]=\"funcModel.appInvokId\" disabled>\r\n                </div>\r\n\r\n                <div class=\"form-group\">\r\n                    <label for=\"txtAppRemark\">{{ 'publishmenu.func.appParam' | locale: '\u53C2\u6570\u8BBE\u7F6E' }}</label>\r\n                    <table class=\"table table-bordered\">\r\n                        <colgroup>\r\n                            <col width=\"140\">\r\n                            <col width=\"200\">\r\n                            <col width=\"\">\r\n                        </colgroup>\r\n                        <thead>\r\n                            <tr>\r\n                                <td>\r\n                                    {{ 'publishmenu.func.paramName' | locale: '\u53C2\u6570\u540D\u79F0' }}\r\n                                </td>\r\n                                <td>\r\n                                    {{ 'publishmenu.func.paramValue' | locale: '\u53C2\u6570\u503C' }}\r\n                                </td>\r\n                                <td align=\"center\">\r\n                                    {{ 'publishmenu.func.paramAction' | locale: '\u64CD\u4F5C' }}\r\n                                </td>\r\n                            </tr>\r\n                        </thead>\r\n                        <tbody>\r\n                            <tr *ngFor=\"let n of funcModel.staticParams\">\r\n                                <td>\r\n                                    <input type=\"text\" [(ngModel)]=\"n.name\" class=\"form-control\">\r\n                                </td>\r\n                                <td>\r\n                                    <input type=\"text\" class=\"form-control\" [(ngModel)]=\"n.value\" >\r\n                                </td>\r\n                                <td style=\"padding-left: 0; padding-right: 0; text-align: center\">\r\n                                    <button type=\"button\" (click)=\"removeStaticParams(n.name)\" class=\"btn\">\r\n                                        <span class=\"k-icon k-i-minus\"></span></button>\r\n                                </td>\r\n                            </tr>\r\n                        </tbody>\r\n                        <tfoot>\r\n                            <tr>\r\n                                <td colspan=\"3\">\r\n                                    <button type=\"button\" (click)=\"addStaticParams()\" class=\"btn btn-primary\">\r\n                                        <span class=\"k-icon k-i-plus\"></span> {{ 'publishmenu.func.addParam' | locale: '\u65B0\u589E\u53C2\u6570' }}</button>\r\n                                </td>\r\n                            </tr>\r\n                        </tfoot>\r\n                    </table>\r\n\r\n                </div>\r\n\r\n                <div class=\"form-group\">\r\n                    <label for=\"txtFuncRemark\">ParentId</label>\r\n                    <input type=\"text\" class=\"form-control\" id=\"txtFuncRemark\" [ngModel]=\"funcModel.parentId\" disabled>\r\n                </div>\r\n                    \r\n            </div>\r\n        </div>\r\n\r\n    </div>\r\n</div>\r\n\r\n\r\n</ng-template>",
                exportAs: 'publishMenu',
                encapsulation: ViewEncapsulation.None,
                styles: [`
        .public-menu-main::-webkit-scrollbar-track-piece{width:8px;background-color:#e2e2e2;}
        .public-menu-main::-webkit-scrollbar{width:8px;height:6px;}
        .public-menu-main::-webkit-scrollbar-thumb{height:50px;background:#9fa1a0; cursor:pointer;}
        .public-menu-main::-webkit-scrollbar-thumb:hover{background:#686868; cursor:pointer
        `]
            }] }
];
/** @nocollapse */
PublishMenuComponent.ctorParameters = () => [
    { type: HttpService },
    { type: Injector },
    { type: BsModalService },
    { type: IdService },
    { type: MessagerService },
    { type: LoadingService },
    { type: ChangeDetectorRef }
];
PublishMenuComponent.propDecorators = {
    serverIp: [{ type: Input }],
    dlgContent: [{ type: ViewChild, args: ['dlgContent',] }],
    publishPath: [{ type: Input }]
};
if (false) {
    /** @type {?} */
    PublishMenuComponent.prototype.serverIp;
    /** @type {?} */
    PublishMenuComponent.prototype.dlgContent;
    /** @type {?} */
    PublishMenuComponent.prototype.publishPath;
    /**
     * 所有功能菜单数据
     * @type {?}
     */
    PublishMenuComponent.prototype.allFuncTreeData;
    /** @type {?} */
    PublishMenuComponent.prototype.funcIdField;
    /** @type {?} */
    PublishMenuComponent.prototype.showMask;
    /** @type {?} */
    PublishMenuComponent.prototype.languages;
    /** @type {?} */
    PublishMenuComponent.prototype.funcModel;
    /** @type {?} */
    PublishMenuComponent.prototype.localeId;
    /** @type {?} */
    PublishMenuComponent.prototype.localeSer;
    /** @type {?} */
    PublishMenuComponent.prototype.commonUtil;
    /**
     * @type {?}
     * @private
     */
    PublishMenuComponent.prototype.http;
    /**
     * @type {?}
     * @private
     */
    PublishMenuComponent.prototype.injector;
    /**
     * @type {?}
     * @private
     */
    PublishMenuComponent.prototype.modalService;
    /**
     * @type {?}
     * @private
     */
    PublishMenuComponent.prototype.uuid;
    /**
     * @type {?}
     * @private
     */
    PublishMenuComponent.prototype.messagerSer;
    /**
     * @type {?}
     * @private
     */
    PublishMenuComponent.prototype.loadingSer;
    /**
     * @type {?}
     * @private
     */
    PublishMenuComponent.prototype.cd;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicHVibGlzaC1tZW51LmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BmYXJyaXMvaWRlLXB1Ymxpc2gtbWVudS8iLCJzb3VyY2VzIjpbImxpYi9wdWJsaXNoLW1lbnUuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7QUFBQSxPQUFPLEVBQUUsU0FBUyxFQUFFLE1BQU0sV0FBVyxDQUFDO0FBQ3RDLE9BQU8sRUFBRSxjQUFjLEVBQUUsTUFBTSxvQkFBb0IsQ0FBQztBQUNwRCxPQUFPLEVBQUUsZUFBZSxFQUFFLE1BQU0scUJBQXFCLENBQUM7QUFDdEQsT0FBTyxFQUFFLFNBQVMsRUFBVSxRQUFRLEVBQUUsS0FBSyxFQUFhLFNBQVMsRUFDekMsU0FBUyxFQUFFLFdBQVcsRUFBRSxpQkFBaUIsRUFBRSxpQkFBaUIsRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUM1RyxPQUFPLEVBQUUsV0FBVyxFQUFFLE1BQU0sb0JBQW9CLENBQUM7QUFDakQsT0FBTyxFQUFFLGNBQWMsRUFBRSxNQUFNLGtCQUFrQixDQUFDO0FBRWxELE9BQU8sRUFBRSxzQkFBc0IsRUFBRSxNQUFNLDZCQUE2QixDQUFDO0FBQ3JFLE9BQU8sRUFBRSxTQUFTLEVBQUUsTUFBTSxtQkFBbUIsQ0FBQztBQUU5QyxPQUFPLEVBQUUsMkJBQTJCLEVBQUUsTUFBTSxzREFBc0QsQ0FBQztBQUNuRyxPQUFPLEVBQUUsa0JBQWtCLEVBQUUsTUFBTSxtQ0FBbUMsQ0FBQztBQUV2RSxPQUFPLEVBQUUsRUFBRSxFQUFFLE1BQU0sTUFBTSxDQUFDO0FBQzFCLE9BQU8sRUFBRSxhQUFhLEVBQUUsTUFBTSxtQkFBbUIsQ0FBQztBQUNsRCxPQUFPLEVBQUUsV0FBVyxFQUFFLE1BQU0sbUJBQW1CLENBQUM7QUFDaEQsT0FBTyxFQUFFLG1CQUFtQixFQUFFLE1BQU0sVUFBVSxDQUFDO0FBZS9DLE1BQU0sT0FBTyxvQkFBb0I7Ozs7Ozs7Ozs7SUFxQzdCLFlBQ1ksSUFBaUIsRUFDakIsUUFB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OztJQUN6Qix3Q0FBMEI7Ozs7O0lBQzFCLDRDQUFvQzs7Ozs7SUFDcEMsb0NBQXVCOzs7OztJQUN2QiwyQ0FBb0M7Ozs7O0lBQ3BDLDBDQUFrQzs7Ozs7SUFDbEMsa0NBQTZCIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgY2xvbmVEZWVwIH0gZnJvbSAnbG9kYXNoLWVzJztcclxuaW1wb3J0IHsgTG9hZGluZ1NlcnZpY2UgfSBmcm9tICdAZmFycmlzL3VpLWxvYWRpbmcnO1xyXG5pbXBvcnQgeyBNZXNzYWdlclNlcnZpY2UgfSBmcm9tICdAZmFycmlzL3VpLW1lc3NhZ2VyJztcclxuaW1wb3J0IHsgQ29tcG9uZW50LCBPbkluaXQsIEluamVjdG9yLCBJbnB1dCwgT25DaGFuZ2VzLCBMT0NBTEVfSUQsXHJcbiAgICAgICAgIFNpbXBsZUNoYW5nZXMsIFZpZXdDaGlsZCwgVGVtcGxhdGVSZWYsIENoYW5nZURldGVjdG9yUmVmLCBWaWV3RW5jYXBzdWxhdGlvbiB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBIdHRwU2VydmljZSB9IGZyb20gJ0BmYXJyaXMvaWRlLWRldmtpdCc7XHJcbmltcG9ydCB7IEJzTW9kYWxTZXJ2aWNlIH0gZnJvbSAnQGZhcnJpcy91aS1tb2RhbCc7XHJcbmltcG9ydCB7IFRyZWVOb2RlIH0gZnJvbSAnQGZhcnJpcy91aS10cmVldGFibGUnO1xyXG5pbXBvcnQgeyBHc3BBcHBNYW5hZ2VyQ29tcG9uZW50IH0gZnJvbSAnLi9nc3AtYXBwL2dzcC1hcHAuY29tcG9uZW50JztcclxuaW1wb3J0IHsgSWRTZXJ2aWNlIH0gZnJvbSAnQGZhcnJpcy91aS1jb21tb24nO1xyXG5pbXBvcnQgeyBBcHBGdW5jdGlvbiB9IGZyb20gJy4vbW9kZWxzL2dzcC1hcHAubW9kZWwnO1xyXG5pbXBvcnQgeyBCaXpvYmplY3RPcGVyYXRvcnNDb21wb25lbnQgfSBmcm9tICcuL2Jpei1vYmplY3Qtb3BlcmF0b3JzL2Jpem9iamVjdC1vcGVyYXRvcnMuY29tcG9uZW50JztcclxuaW1wb3J0IHsgU2VsZWN0QXBwQ29tcG9uZW50IH0gZnJvbSAnLi9zZWxlY3QtYXBwL3NlbGVjdC1hcHAuY29tcG9uZW50JztcclxuaW1wb3J0IHsgU2VsZWN0ZWRSb3cgfSBmcm9tICdAZmFycmlzL3VpLWRhdGFncmlkJztcclxuaW1wb3J0IHsgb2YgfSBmcm9tICdyeGpzJztcclxuaW1wb3J0IHsgTG9jYWxlU2VydmljZSB9IGZyb20gJ0BmYXJyaXMvdWktbG9jYWxlJztcclxuaW1wb3J0IHsgQ29tbW9uVXRpbHMgfSBmcm9tICdAZmFycmlzL3VpLWNvbW1vbic7XHJcbmltcG9ydCB7IFBVQkxJU0hfTUVOVV9MT0NBTEUgfSBmcm9tICcuL2xvY2FsZSc7XHJcbkBDb21wb25lbnQoe1xyXG4gICAgc2VsZWN0b3I6ICdwdWJsaXNoLW1lbnUnLFxyXG4gICAgdGVtcGxhdGVVcmw6ICcuL3B1Ymxpc2gtbWVudS5jb21wb25lbnQuaHRtbCcsXHJcbiAgICBzdHlsZXM6IFtcclxuICAgICAgICBgXHJcbiAgICAgICAgLnB1YmxpYy1tZW51LW1haW46Oi13ZWJraXQtc2Nyb2xsYmFyLXRyYWNrLXBpZWNle3dpZHRoOjhweDtiYWNrZ3JvdW5kLWNvbG9yOiNlMmUyZTI7fVxyXG4gICAgICAgIC5wdWJsaWMtbWVudS1tYWluOjotd2Via2l0LXNjcm9sbGJhcnt3aWR0aDo4cHg7aGVpZ2h0OjZweDt9XHJcbiAgICAgICAgLnB1YmxpYy1tZW51LW1haW46Oi13ZWJraXQtc2Nyb2xsYmFyLXRodW1ie2hlaWdodDo1MHB4O2JhY2tncm91bmQ6IzlmYTFhMDsgY3Vyc29yOnBvaW50ZXI7fVxyXG4gICAgICAgIC5wdWJsaWMtbWVudS1tYWluOjotd2Via2l0LXNjcm9sbGJhci10aHVtYjpob3ZlcntiYWNrZ3JvdW5kOiM2ODY4Njg7IGN1cnNvcjpwb2ludGVyXHJcbiAgICAgICAgYFxyXG4gICAgXSxcclxuICAgIGV4cG9ydEFzOiAncHVibGlzaE1lbnUnLFxyXG4gICAgZW5jYXBzdWxhdGlvbjogVmlld0VuY2Fwc3VsYXRpb24uTm9uZVxyXG59KVxyXG5leHBvcnQgY2xhc3MgUHVibGlzaE1lbnVDb21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQsIE9uQ2hhbmdlcyB7XHJcblxyXG4gICAgQElucHV0KCkgc2VydmVySXAgPSAnJztcclxuICAgIEBWaWV3Q2hpbGQoJ2RsZ0NvbnRlbnQnKSBkbGdDb250ZW50OiBUZW1wbGF0ZVJlZjxhbnk+O1xyXG4gICAgQElucHV0KCkgcHVibGlzaFBhdGggPSAnJztcclxuXHJcbiAgICAvKiog5omA5pyJ5Yqf6IO96I+c5Y2V5pWw5o2uICovXHJcbiAgICBhbGxGdW5jVHJlZURhdGEgPSBbXTtcclxuICAgIGZ1bmNJZEZpZWxkID0gJ2lkJztcclxuXHJcbiAgICBzaG93TWFzayA9IHRydWU7XHJcblxyXG4gICAgbGFuZ3VhZ2VzID0gW1xyXG4gICAgICAgIHsgY29kZTogJ3poLUNIUycsIG5hbWU6ICfkuK3mlofnroDkvZMnIH0sXHJcbiAgICAgICAgeyBjb2RlOiAnZW4nLCBuYW1lOiAnRW5nbGlzaCcgfSxcclxuICAgICAgICB7IGNvZGU6ICd6aC1DSFQnLCBuYW1lOiAn5Lit5paH57mB5L2TJyB9XHJcbiAgICBdO1xyXG5cclxuICAgIHByaXZhdGUgZ2V0IEZVTkNfVVJJKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnNlcnZlcklwICsgJy9hcGkvcnVudGltZS9zeXMvdjEuMC9mdW5jdGlvbnMvYWxsRnVuY3MnO1xyXG4gICAgfVxyXG4gICAgcHJpdmF0ZSBnZXQgQVBQX1VSSSgpIHtcclxuICAgICAgICByZXR1cm4gIHRoaXMuc2VydmVySXAgKyAnL2FwaS9ydW50aW1lL3N5cy92MS4wL2dzcGFwcC9hbGwnO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgZ2V0IEFQUF9QT1NUX1VSSSgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5zZXJ2ZXJJcCArICcvYXBpL3J1bnRpbWUvc3lzL3YxLjAvZ3NwYXBwJztcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGdldCBGVU5DX1BPU1RfVVJJKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnNlcnZlcklwICsgJy9hcGkvcnVudGltZS9zeXMvdjEuMC9mdW5jdGlvbnMnO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmNNb2RlbDogQXBwRnVuY3Rpb24gPSBudWxsO1xyXG4gICAgbG9jYWxlSWQgPSAnemgtQ0hTJztcclxuICAgIGxvY2FsZVNlcjogTG9jYWxlU2VydmljZTtcclxuICAgIGNvbW1vblV0aWw6IENvbW1vblV0aWxzO1xyXG4gICAgY29uc3RydWN0b3IoXHJcbiAgICAgICAgcHJpdmF0ZSBodHRwOiBIdHRwU2VydmljZSxcclxuICAgICAgICBwcml2YXRlIGluamVjdG9yOiBJbmplY3RvcixcclxuICAgICAgICBwcml2YXRlIG1vZGFsU2VydmljZTogQnNNb2RhbFNlcnZpY2UsXHJcbiAgICAgICAgcHJpdmF0ZSB1dWlkOiBJZFNlcnZpY2UsXHJcbiAgICAgICAgcHJpdmF0ZSBtZXNzYWdlclNlcjogTWVzc2FnZXJTZXJ2aWNlLFxyXG4gICAgICAgIHByaXZhdGUgbG9hZGluZ1NlcjogTG9hZGluZ1NlcnZpY2UsXHJcbiAgICAgICAgcHJpdmF0ZSBjZDogQ2hhbmdlRGV0ZWN0b3JSZWZcclxuICAgICkge1xyXG5cclxuICAgICAgICB0aGlzLmNvbW1vblV0aWwgPSB0aGlzLmluamVjdG9yLmdldChDb21tb25VdGlscyk7XHJcbiAgICAgICAgdGhpcy5sb2NhbGVJZCA9IHRoaXMuaW5qZWN0b3IuZ2V0KExPQ0FMRV9JRCwgJ3poLUNIUycpO1xyXG5cclxuICAgICAgICBpZiAodGhpcy5sb2NhbGVJZCA9PT0gJ3poJykge1xyXG4gICAgICAgICAgICB0aGlzLmxvY2FsZUlkID0gJ3poLUNIUyc7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoIXRoaXMubG9jYWxlU2VyKSB7XHJcbiAgICAgICAgICAgIHRoaXMubG9jYWxlU2VyID0gdGhpcy5pbmplY3Rvci5nZXQoTG9jYWxlU2VydmljZSwgbnVsbCk7XHJcbiAgICAgICAgICAgIGlmICghdGhpcy5sb2NhbGVTZXIpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMubG9jYWxlU2VyID0gbmV3IExvY2FsZVNlcnZpY2UodGhpcy5sb2NhbGVJZCwgdGhpcy5jb21tb25VdGlsLCBQVUJMSVNIX01FTlVfTE9DQUxFKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGlmICghdGhpcy5sb2NhbGVTZXIubGFuZ0RhdGFbJ3B1Ymxpc2htZW51J10pIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmxvY2FsZVNlci5zZXRMb2NhbGVEYXRhKFBVQkxJU0hfTUVOVV9MT0NBTEUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgIH1cclxuXHJcbiAgICBuZ09uSW5pdCgpIHtcclxuICAgICAgICAvLyB0aGlzLmluaXRBbGxGdW5jVHJlZSgpO1xyXG4gICAgfVxyXG5cclxuICAgIG5nT25DaGFuZ2VzKGNoYW5nZXM6IFNpbXBsZUNoYW5nZXMpIHtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgZW1wdHlEYXRhKCkge1xyXG4gICAgICAgIHRoaXMuZnVuY01vZGVsID0ge1xyXG4gICAgICAgICAgICBhcHBJZDogJycsXHJcbiAgICAgICAgICAgIGFwcEludm9rSWQ6ICcnLFxyXG4gICAgICAgICAgICBiaXpPYmplY3RJZDogJycsXHJcbiAgICAgICAgICAgIGJpek9wSWQ6ICcnLFxyXG4gICAgICAgICAgICBjb2RlOiAnJyxcclxuICAgICAgICAgICAgY3JlYXRvcjogJycsXHJcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiAnJyxcclxuICAgICAgICAgICAgZnVuY1R5cGU6ICc0JyxcclxuICAgICAgICAgICAgaWQ6IHRoaXMudXVpZC5nZW5lcmF0ZSgpLFxyXG4gICAgICAgICAgICBpY29uOiAnJyxcclxuICAgICAgICAgICAgaXNEZXRhaWw6IHRydWUsXHJcbiAgICAgICAgICAgIGlzRGlzcGxheWVkOiB0cnVlLFxyXG4gICAgICAgICAgICBpc1N5c0luaXQ6IGZhbHNlLFxyXG4gICAgICAgICAgICBsYXllcjogJzQnLFxyXG4gICAgICAgICAgICBtZW51VHlwZTogJzEnLFxyXG4gICAgICAgICAgICBuYW1lOiAnJyxcclxuICAgICAgICAgICAgcGFyZW50SWQ6ICcnLFxyXG4gICAgICAgICAgICBwYXRoOiAnJyxcclxuICAgICAgICAgICAgc3RhdGljUGFyYW1zOiBbe25hbWU6ICdtb2RlJywgdmFsdWU6ICdzcGEnfV0sXHJcbiAgICAgICAgICAgIHVybDogJycsXHJcbiAgICAgICAgICAgIG5hbWVMYW5ndWFnZTogbnVsbFxyXG4gICAgICAgIH07XHJcbiAgICB9XHJcblxyXG4gICAgdmFsaWRhdGUoKSB7XHJcbiAgICAgICAgbGV0IG1zZyA9ICcnO1xyXG4gICAgICAgIGlmICghdGhpcy5mdW5jTW9kZWwucGFyZW50SWQpIHtcclxuICAgICAgICAgICAgbXNnICs9IHRoaXMubG9jYWxlU2VyLmdldFZhbHVlKCdwdWJsaXNobWVudS5mdW5jLm1lc3NhZ2UucGFyZW50SWQnKTsgLy8gJ+ivt+WcqOW3puS+p+mAieaLqeS4iue6p+iPnOWNle+8gTxicj4nO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKCFtc2cpIHtcclxuICAgICAgICAgICAgaWYgKCF0aGlzLmZ1bmNNb2RlbC5jb2RlKSB7XHJcbiAgICAgICAgICAgICAgICBtc2cgKz0gIHRoaXMubG9jYWxlU2VyLmdldFZhbHVlKCdwdWJsaXNobWVudS5mdW5jLm1lc3NhZ2UuY29kZScpOyAvLyAn5Yqf6IO957yW5Y+35LiN6IO95Li656m677yBPGJyPic7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmICghdGhpcy5mdW5jTW9kZWwubmFtZSkge1xyXG4gICAgICAgICAgICAgICAgbXNnICs9ICB0aGlzLmxvY2FsZVNlci5nZXRWYWx1ZSgncHVibGlzaG1lbnUuZnVuYy5tZXNzYWdlLm5hbWUnKTsgLy8gJ+WKn+iDveWQjeensOS4jeiDveS4uuepuu+8gTxicj4nO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAoIXRoaXMuZnVuY01vZGVsLmJpek9wSWQpIHtcclxuICAgICAgICAgICAgICAgIG1zZyArPSB0aGlzLmxvY2FsZVNlci5nZXRWYWx1ZSgncHVibGlzaG1lbnUuZnVuYy5tZXNzYWdlLmJpek9wSWQnKTsgIC8vICfor7fpgInmi6nlip/og73mk43kvZzvvIEgPGJyPic7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmICghdGhpcy5mdW5jTW9kZWwuYXBwSWQpIHtcclxuICAgICAgICAgICAgICAgIG1zZyArPSB0aGlzLmxvY2FsZVNlci5nZXRWYWx1ZSgncHVibGlzaG1lbnUuZnVuYy5tZXNzYWdlLmFwcGlkJyk7ICAvLyAn6K+36YCJ5oup5YWz6IGU5bqU55So77yBPGJyPic7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmICghdGhpcy5mdW5jTW9kZWwuYXBwSW52b2tJZCkge1xyXG4gICAgICAgICAgICAgICAgbXNnICs9IHRoaXMubG9jYWxlU2VyLmdldFZhbHVlKCdwdWJsaXNobWVudS5mdW5jLm1lc3NhZ2UuYXBwSW52b2tJZCcpOyAgLy8gJ+ivt+mAieaLqeWFs+iBlOW6lOeUqOWFpeWPo++8gTxicj4nO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIGlmICghdGhpcy5mdW5jTW9kZWwuYml6T2JqZWN0SWQpIHtcclxuICAgICAgICAvLyAgICAgbXNnICs9IHRoaXMubG9jYWxlU2VyLmdldFZhbHVlKCdwdWJsaXNobWVudS5mdW5jLm1lc3NhZ2UuYml6T2JqZWN0SWQnKTsgIC8vICfor7fpgInmi6nlt6bkvqfkuJrliqHmk43kvZzlr7nosaHvvIEgPGJyPic7XHJcbiAgICAgICAgLy8gfVxyXG5cclxuXHJcbiAgICAgICAgaWYgKG1zZykge1xyXG4gICAgICAgICAgICB0aGlzLm1lc3NhZ2VyU2VyLnNob3coJ3dhcm5pbmcnLCBtc2csIHsgc2FmZUh0bWw6IGZhbHNlLCBoZWlnaHQ6IDMwMCB9KTtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH1cclxuXHJcbiAgICBzYXZlTWVudSgpIHtcclxuICAgICAgICB0aGlzLmZ1bmNNb2RlbC5uYW1lID0gdGhpcy5mdW5jTW9kZWwubmFtZUxhbmd1YWdlID8gdGhpcy5mdW5jTW9kZWwubmFtZUxhbmd1YWdlW3RoaXMubG9jYWxlSWRdIDogJyc7XHJcbiAgICAgICAgaWYgKHRoaXMudmFsaWRhdGUoKSkge1xyXG4gICAgICAgICAgICBjb25zdCBzdGF0aWNQYXJhbXMgPSBKU09OLnN0cmluZ2lmeSh0aGlzLmZ1bmNNb2RlbC5zdGF0aWNQYXJhbXMpO1xyXG4gICAgICAgICAgICBjb25zdCBfZnVuY01vZGVsID0gY2xvbmVEZWVwKHRoaXMuZnVuY01vZGVsKTtcclxuICAgICAgICAgICAgX2Z1bmNNb2RlbC5zdGF0aWNQYXJhbXMgPSBzdGF0aWNQYXJhbXM7XHJcbiAgICAgICAgICAgIF9mdW5jTW9kZWwubmFtZSA9IF9mdW5jTW9kZWwubmFtZUxhbmd1YWdlW3RoaXMubG9jYWxlSWRdO1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5odHRwLnBvc3QodGhpcy5GVU5DX1BPU1RfVVJJLCBfZnVuY01vZGVsKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBvZihmYWxzZSk7XHJcbiAgICB9XHJcblxyXG4gICAgc2hvdygpIHtcclxuICAgICAgICBjb25zdCBtb2RhbFJlZiA9IHRoaXMubW9kYWxTZXJ2aWNlLnNob3codGhpcy5kbGdDb250ZW50LCB7XHJcbiAgICAgICAgICAgIHRpdGxlOiB0aGlzLmxvY2FsZVNlci5nZXRWYWx1ZSgncHVibGlzaG1lbnUuZGlhbG9nLnRpdGxlJyksXHJcbiAgICAgICAgICAgIHdpZHRoOiA3NjAsIGhlaWdodDogNTAwLFxyXG4gICAgICAgICAgICBzaG93TWF4QnV0dG9uOiBmYWxzZSxcclxuICAgICAgICAgICAgcmVzaXphYmxlOiBmYWxzZSxcclxuICAgICAgICAgICAgZW5hYmxlU2Nyb2xsOiBmYWxzZSxcclxuICAgICAgICAgICAgYnV0dG9uczogW1xyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIHRleHQ6IHRoaXMubG9jYWxlU2VyLmdldFZhbHVlKCdwdWJsaXNobWVudS5kaWFsb2cuYnRuT2snKSxcclxuICAgICAgICAgICAgICAgICAgICBjbHM6ICdidG4gYnRuLXByaW1hcnknLFxyXG4gICAgICAgICAgICAgICAgICAgIGhhbmRsZTogKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNhdmVNZW51KCkuc3Vic2NyaWJlKHIgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm1lc3NhZ2VyU2VyLnN1Y2Nlc3MoIHRoaXMubG9jYWxlU2VyLmdldFZhbHVlKCdwdWJsaXNobWVudS5kaWFsb2cuc3VjY2VzcycpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtb2RhbFJlZi5jbG9zZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2hvd01hc2sgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LCAoZXJyOiBhbnkpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlcnIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBlcnJvciA9IGVyci5lcnJvcjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXJyb3IpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbWVzZyA9IGVycm9yLk1lc3NhZ2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubWVzc2FnZXJTZXIud2FybmluZyhtZXNnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGV4dDogdGhpcy5sb2NhbGVTZXIuZ2V0VmFsdWUoJ3B1Ymxpc2htZW51LmRpYWxvZy5idG5DYW5jZWwnKSxcclxuICAgICAgICAgICAgICAgICAgICBjbHM6ICdidG4gYnRuLXNlY29uZGFyeScsXHJcbiAgICAgICAgICAgICAgICAgICAgaGFuZGxlOiAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1vZGFsUmVmLmNsb3NlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2hvd01hc2sgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgXSxcclxuICAgICAgICAgICAgb3BlbmVkOiAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmluaXRBbGxGdW5jVHJlZSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5lbXB0eURhdGEoKTtcclxuICAgICAgICByZXR1cm4gbW9kYWxSZWY7XHJcbiAgICB9XHJcbiAgICAvLyDpgInmi6nlhbPogZTlupTnlKhcclxuICAgIHNob3dTZWxlY3RBcHBNb2RhbCgpIHtcclxuICAgICAgICBjb25zdCBtb2RhbFJlZiA9IHRoaXMubW9kYWxTZXJ2aWNlLnNob3coU2VsZWN0QXBwQ29tcG9uZW50LCB7XHJcbiAgICAgICAgICAgIHRpdGxlOiB0aGlzLmxvY2FsZVNlci5nZXRWYWx1ZSgncHVibGlzaG1lbnUuZGlhbG9nLnNlbGVjdGFwcCcpLFxyXG4gICAgICAgICAgICB3aWR0aDogNzYwLCBoZWlnaHQ6IDUwMCxcclxuICAgICAgICAgICAgZW5hYmxlU2Nyb2xsOiBmYWxzZSxcclxuICAgICAgICAgICAgc2hvd01heEJ1dHRvbjogZmFsc2UsXHJcbiAgICAgICAgICAgIHJlc2l6YWJsZTogZmFsc2UsXHJcbiAgICAgICAgICAgIGluaXRpYWxTdGF0ZToge1xyXG4gICAgICAgICAgICAgICAgc2VydmVySXA6IHRoaXMuc2VydmVySXAsXHJcbiAgICAgICAgICAgICAgICBmdW5jTW9kZWw6IHRoaXMuZnVuY01vZGVsXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGJ1dHRvbnM6IFtcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICB0ZXh0OiB0aGlzLmxvY2FsZVNlci5nZXRWYWx1ZSgncHVibGlzaG1lbnUuZGlhbG9nLmJ0bk9rJyksXHJcbiAgICAgICAgICAgICAgICAgICAgY2xzOiAnYnRuIGJ0bi1wcmltYXJ5JyxcclxuICAgICAgICAgICAgICAgICAgICBoYW5kbGU6ICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2FjID0gbW9kYWxSZWYuY29udGVudCBhcyBTZWxlY3RBcHBDb21wb25lbnQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBtc2cgPSAnJztcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNhYy5hcHBJZCAmJiBzYWMuYXBwSW52b2tJZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5mdW5jTW9kZWwuYXBwSWQgPSBzYWMuYXBwSWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmZ1bmNNb2RlbC5hcHBJbnZva0lkID0gc2FjLmFwcEludm9rSWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtc2cgPSAnJztcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFzYWMuYXBwSWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1zZyA9IHRoaXMubG9jYWxlU2VyLmdldFZhbHVlKCdwdWJsaXNobWVudS5kaWFsb2cuc2VsZWN0SW5mbycpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCFzYWMuYXBwSW52b2tJZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbXNnID0gdGhpcy5sb2NhbGVTZXIuZ2V0VmFsdWUoJ3B1Ymxpc2htZW51LmRpYWxvZy5hcHBlbnRyeScpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobXNnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm1lc3NhZ2VyU2VyLndhcm5pbmcobXNnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vZGFsUmVmLmNsb3NlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIHRleHQ6ICB0aGlzLmxvY2FsZVNlci5nZXRWYWx1ZSgncHVibGlzaG1lbnUuZGlhbG9nLmJ0bkNhbmNlbCcpLFxyXG4gICAgICAgICAgICAgICAgICAgIGNsczogJ2J0biBidG4tc2Vjb25kYXJ5JyxcclxuICAgICAgICAgICAgICAgICAgICBoYW5kbGU6ICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbW9kYWxSZWYuY2xvc2UoKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIF1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIG1vZGFsUmVmO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIOmAieaLqeS4muWKoeaTjeS9nFxyXG4gICAgc2hvd0Jpek9iamVjdE9wZXJhdG9yTW9kYWwoKSB7XHJcbiAgICAgICAgY29uc3QgbW9kYWxSZWYgPSB0aGlzLm1vZGFsU2VydmljZS5zaG93KEJpem9iamVjdE9wZXJhdG9yc0NvbXBvbmVudCwge1xyXG4gICAgICAgICAgICB0aXRsZTogdGhpcy5sb2NhbGVTZXIuZ2V0VmFsdWUoJ3B1Ymxpc2htZW51LmRpYWxvZy5iaXpPcHRpdGxlJyksXHJcbiAgICAgICAgICAgIHdpZHRoOiA3NjAsIGhlaWdodDogNTAwLFxyXG4gICAgICAgICAgICBlbmFibGVTY3JvbGw6IGZhbHNlLFxyXG4gICAgICAgICAgICBzaG93TWF4QnV0dG9uOiBmYWxzZSxcclxuICAgICAgICAgICAgcmVzaXphYmxlOiBmYWxzZSxcclxuICAgICAgICAgICAgaW5pdGlhbFN0YXRlOiB7XHJcbiAgICAgICAgICAgICAgICBzZXJ2ZXJJcDogdGhpcy5zZXJ2ZXJJcCxcclxuICAgICAgICAgICAgICAgIGZ1bmNNb2RlbDogdGhpcy5mdW5jTW9kZWxcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgYnV0dG9uczogW1xyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIHRleHQ6IHRoaXMubG9jYWxlU2VyLmdldFZhbHVlKCdwdWJsaXNobWVudS5kaWFsb2cuYnRuT2snKSxcclxuICAgICAgICAgICAgICAgICAgICBjbHM6ICdidG4gYnRuLXByaW1hcnknLFxyXG4gICAgICAgICAgICAgICAgICAgIGhhbmRsZTogKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBib2MgPSBtb2RhbFJlZi5jb250ZW50IGFzIEJpem9iamVjdE9wZXJhdG9yc0NvbXBvbmVudDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgYml6T2JqID0gYm9jLmJpek9iamVjdElkIGFzIFRyZWVOb2RlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBiaXpPcCA9IGJvYy5iaXpPcElkIGFzIFNlbGVjdGVkUm93O1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGJpek9wKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgYml6T2JqSUQgPSAnJztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghYml6T2JqKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYml6T2JqSUQgPSBiaXpPcC5kYXRhLmJ1c2luZXNzSWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJpek9iaklEID0gYml6T2JqLmlkO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChiaXpPYmpJRCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZnVuY01vZGVsLmJpek9iamVjdElkID0gYml6T2JqSUQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5mdW5jTW9kZWwuYml6T3BJZCA9IGJpek9wLmlkO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vZGFsUmVmLmNsb3NlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubWVzc2FnZXJTZXIud2FybmluZyh0aGlzLmxvY2FsZVNlci5nZXRWYWx1ZSgncHVibGlzaG1lbnUuZGlhbG9nLmJpendhcm4nKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm1lc3NhZ2VyU2VyLndhcm5pbmcodGhpcy5sb2NhbGVTZXIuZ2V0VmFsdWUoJ3B1Ymxpc2htZW51LmRpYWxvZy5iaXphY3Rpb24nKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIHRleHQ6ICB0aGlzLmxvY2FsZVNlci5nZXRWYWx1ZSgncHVibGlzaG1lbnUuZGlhbG9nLmJ0bkNhbmNlbCcpLFxyXG4gICAgICAgICAgICAgICAgICAgIGNsczogJ2J0biBidG4tc2Vjb25kYXJ5JyxcclxuICAgICAgICAgICAgICAgICAgICBoYW5kbGU6ICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbW9kYWxSZWYuY2xvc2UoKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIF1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIG1vZGFsUmVmO1xyXG4gICAgfVxyXG4gICAgLy8g5paw5bu65bqU55SoXHJcbiAgICBzaG93QXBwTW9kYWwoKSB7XHJcbiAgICAgICAgY29uc3QgbW9kYWxSZWYgPSB0aGlzLm1vZGFsU2VydmljZS5zaG93KEdzcEFwcE1hbmFnZXJDb21wb25lbnQsIHtcclxuICAgICAgICAgICAgdGl0bGU6IHRoaXMubG9jYWxlU2VyLmdldFZhbHVlKCdwdWJsaXNobWVudS5kaWFsb2cuYXBwJyksXHJcbiAgICAgICAgICAgIHdpZHRoOiA3NjAsIGhlaWdodDogNTAwLFxyXG4gICAgICAgICAgICBzaG93TWF4QnV0dG9uOiBmYWxzZSxcclxuICAgICAgICAgICAgcmVzaXphYmxlOiBmYWxzZSxcclxuICAgICAgICAgICAgZW5hYmxlU2Nyb2xsOiBmYWxzZSxcclxuICAgICAgICAgICAgaW5pdGlhbFN0YXRlOiB7XHJcbiAgICAgICAgICAgICAgICBzZXJ2ZXJJcDogdGhpcy5zZXJ2ZXJJcCxcclxuICAgICAgICAgICAgICAgIHBhdGg6ICh0aGlzLnB1Ymxpc2hQYXRoIHx8ICcnKS5yZXBsYWNlKCdpbmRleC5odG1saW5kZXguaHRtbCcsICdpbmRleC5odG1sJyksXHJcbiAgICAgICAgICAgICAgICBmdW5jTW9kZWw6IHRoaXMuZnVuY01vZGVsXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGJ1dHRvbnM6IFtcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICB0ZXh0OiB0aGlzLmxvY2FsZVNlci5nZXRWYWx1ZSgncHVibGlzaG1lbnUuZGlhbG9nLmJ0bk9rJyksXHJcbiAgICAgICAgICAgICAgICAgICAgY2xzOiAnYnRuIGJ0bi1wcmltYXJ5JyxcclxuICAgICAgICAgICAgICAgICAgICBoYW5kbGU6ICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgYW1jID0gbW9kYWxSZWYuY29udGVudCBhcyBHc3BBcHBNYW5hZ2VyQ29tcG9uZW50O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoYW1jLnZhbGlkYXRlKCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubG9hZGluZ1Nlci5zaG93KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmh0dHAucG9zdCh0aGlzLkFQUF9QT1NUX1VSSSwgYW1jLmFwcE1vZGVsKS5zdWJzY3JpYmUociA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5mdW5jTW9kZWwuYXBwSWQgPSBhbWMuYXBwTW9kZWwuaWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZnVuY01vZGVsLmFwcEludm9rSWQgPSBhbWMuYXBwTW9kZWwuYXBwSW52b2tzWzBdLmlkO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmxvYWRpbmdTZXIuY2xvc2UoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbW9kYWxSZWYuY2xvc2UoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhhbWMuYXBwTW9kZWwpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGV4dDogdGhpcy5sb2NhbGVTZXIuZ2V0VmFsdWUoJ3B1Ymxpc2htZW51LmRpYWxvZy5idG5DYW5jZWwnKSxcclxuICAgICAgICAgICAgICAgICAgICBjbHM6ICdidG4gYnRuLXNlY29uZGFyeScsXHJcbiAgICAgICAgICAgICAgICAgICAgaGFuZGxlOiAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1vZGFsUmVmLmNsb3NlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBdXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiBtb2RhbFJlZjtcclxuICAgIH1cclxuXHJcbiAgICB0cmVlTm9kZUNsaWNrZWQoZSkge1xyXG4gICAgICAgIHRoaXMuZnVuY01vZGVsLnBhcmVudElkID0gZS5ub2RlLmRhdGEuaWQ7XHJcbiAgICAgICAgdGhpcy5zaG93TWFzayA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuY2QuZGV0ZWN0Q2hhbmdlcygpO1xyXG4gICAgICAgIGNvbnN0IGlucHV0OiBhbnkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjdHh0RnVuY0NvZGUnKTtcclxuICAgICAgICBpZiAoaW5wdXQpIHtcclxuICAgICAgICAgICAgaW5wdXQuY2xpY2soKTtcclxuICAgICAgICAgICAgaW5wdXQuZm9jdXMoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcmVtb3ZlU3RhdGljUGFyYW1zKG5hbWUpIHtcclxuICAgICAgICB0aGlzLmZ1bmNNb2RlbC5zdGF0aWNQYXJhbXMgPSB0aGlzLmZ1bmNNb2RlbC5zdGF0aWNQYXJhbXMuZmlsdGVyKG4gPT4gbi5uYW1lICE9PSBuYW1lKTtcclxuICAgIH1cclxuXHJcbiAgICBhZGRTdGF0aWNQYXJhbXMoKSB7XHJcbiAgICAgICAgdGhpcy5mdW5jTW9kZWwuc3RhdGljUGFyYW1zLnB1c2goe25hbWU6ICcnLCB2YWx1ZTogJyd9KTtcclxuICAgIH1cclxuXHJcblxyXG4gICAgcHJpdmF0ZSBpbml0QWxsRnVuY1RyZWUoKSB7XHJcbiAgICAgICAgdGhpcy5odHRwLmdldCh0aGlzLkZVTkNfVVJJKS5zdWJzY3JpYmUoZGF0YSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmFsbEZ1bmNUcmVlRGF0YSA9IHRoaXMuY29udmVydDJUcmVlTm9kZXMoZGF0YSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGNvbnZlcnQyVHJlZU5vZGVzKGRhdGE6IGFueVtdLCBwYXJlbnRJZCA9ICcwJyk6IFRyZWVOb2RlW10ge1xyXG4gICAgICAgIGlmIChkYXRhLmxlbmd0aCkge1xyXG4gICAgICAgICAgICBjb25zdCBub2RlcyA9IGRhdGEuZmlsdGVyKCh2KSA9PiB2LnBhcmVudElkID09PSBwYXJlbnRJZCk7XHJcbiAgICAgICAgICAgIHJldHVybiBub2Rlcy5tYXAoaXRlbSA9PiB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBub2RlID0ge1xyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IGl0ZW0sXHJcbiAgICAgICAgICAgICAgICAgICAgY2hpbGRyZW46IFtdLFxyXG4gICAgICAgICAgICAgICAgICAgIHNlbGVjdGFibGU6IGl0ZW0ubGF5ZXIgPT09ICczJ1xyXG4gICAgICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgICAgICBub2RlLmNoaWxkcmVuID0gdGhpcy5jb252ZXJ0MlRyZWVOb2RlcyhkYXRhLCBpdGVtLmlkKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBub2RlO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIFtdO1xyXG4gICAgfVxyXG5cclxufVxyXG4iXX0=