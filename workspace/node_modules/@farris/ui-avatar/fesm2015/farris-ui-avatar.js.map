{"version":3,"file":"farris-ui-avatar.js.map","sources":["ng://@farris/ui-avatar/lib/avatar.service.ts","ng://@farris/ui-avatar/lib/avatar.component.ts","ng://@farris/ui-avatar/lib/avatar.module.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class AvatarService {\r\n\r\n  constructor() { }\r\n}\r\n","import { Component, OnInit, ViewChildren, ElementRef, Input, Output, EventEmitter, HostListener, ViewChild, forwardRef, Injector, Optional } from '@angular/core';\r\nimport { Observable, Subject } from 'rxjs';\r\nimport { NotifyService } from '@farris/ui-notify';\r\nimport { ControlValueAccessor, NG_VALUE_ACCESSOR } from '@angular/forms';\r\nimport { LocaleService } from '@farris/ui-locale';\r\nimport { WEBAPI_PREFIX_TOKEN } from '@farris/ui-common';\r\n\r\nexport interface upImageFile {\r\n  size: number;\r\n  name: string;\r\n  type: string;\r\n  lastModified?: string;\r\n  lastModifiedDate?: Date;\r\n  state?: string;\r\n  base64?: string;\r\n}\r\n\r\n@Component({\r\n  selector: 'farris-avatar',\r\n  templateUrl: './avatar.component.html',\r\n  styleUrls: ['./avatar.component.scss'],\r\n  providers: [\r\n    {\r\n      provide: NG_VALUE_ACCESSOR,\r\n      useExisting: forwardRef(() => AvatarComponent),\r\n      multi: true\r\n    }\r\n  ]\r\n})\r\nexport class AvatarComponent implements ControlValueAccessor, OnInit {\r\n  private defaultImgSrc = 'data:image/jpeg;base64,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'\r\n  private errorImgSrc = 'data:image/jpeg;base64,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';\r\n  public imgSrc;\r\n  // public fileBinary: string;\r\n  @ViewChild('file') file: ElementRef;\r\n  // @Input() cover = '';\r\n  tReadOnly: boolean = false;\r\n  @Input()\r\n  set readonly(value: boolean) {\r\n    if (value !== this.tReadOnly) {\r\n      let localeTitle = this.localeService.getValue('avatar.imgtitle');\r\n      this.imgtitle = value ? '' : (this.imgTitle ? this.imgTitle : localeTitle);\r\n      this.tReadOnly = value;\r\n    }\r\n\r\n  };\r\n  get readonly(): boolean {\r\n    return this.tReadOnly;\r\n  }\r\n  // @Input() type;\r\n  @Input() size: number = 1;\r\n  @Input() imgTitle: string;\r\n  @Input() avatarWidth: number = 100;\r\n  @Input() avatarHeight: number = 100;\r\n  @Input() imgShape: string = 'circle';\r\n  imgtitle: string = 'ç¹å»ä¿®æ¹';\r\n  // @Input() isBase64:boolean = true;\r\n  @Output('imgChange') imgChange = new EventEmitter();\r\n\r\n  _type;\r\n  @Input()\r\n  set type(val) {\r\n    if (val && val.length) {\r\n      let types = val;\r\n      if (typeof val === 'string') {\r\n        types = val.split(',');\r\n      }\r\n      if (types && types.length) {\r\n        this.currentImgType = [];\r\n        types.forEach(t => {\r\n          if ((typeof t == 'string') && t.constructor == String) {\r\n            let tImgtype = 'image/' + t;\r\n            if (t === 'jpg') {\r\n              let jpgType = 'image/jpeg';\r\n              this.currentImgType.push(jpgType);\r\n            }\r\n            this.currentImgType.push(tImgtype);\r\n          }\r\n        });\r\n        if (this.currentImgType.length > 0) {\r\n          this.imgType = this.currentImgType.join(',')\r\n        }\r\n      }\r\n    }\r\n  }\r\n  get type() {\r\n    return this._type;\r\n  }\r\n  _cover;\r\n  @Input()\r\n  set cover(val) {\r\n    if (val) {\r\n      this._cover = val;\r\n      this.imgsrcInit(this.cover);\r\n    }\r\n    else {\r\n      this.imgSrc = this.defaultImgSrc;\r\n    }\r\n  }\r\n  get cover() {\r\n    return this._cover;\r\n  }\r\n\r\n  private onChangeCallback: Function = () => { }\r\n  private onTouchedCallback: Function = () => { }\r\n  private perfixStr='';\r\n  //æ¯å¦å è½½ä¸­\r\n  loadingImg: boolean;\r\n  imgType = 'image/*';\r\n  imgFileObj: upImageFile;\r\n  currentImgType = ['image/image', 'image/webp', 'image/png', 'image/svg', 'image/gif', 'image/jpg', 'image/jpeg', 'image/bmp'];\r\n  constructor(private notifyService: NotifyService, public localeService: LocaleService,@Optional() private inject:Injector) {\r\n    this.notifyService.config.position = 'top-center';\r\n\r\n    if(this.inject){\r\n      if(WEBAPI_PREFIX_TOKEN){\r\n          this.perfixStr = this.inject.get(WEBAPI_PREFIX_TOKEN, '');\r\n      }\r\n   }\r\n  }\r\n\r\n  ngOnInit() {\r\n    // if(this.cover){\r\n    //   this.imgsrcInit(this.cover);\r\n    // }\r\n    // else{\r\n    //   this.imgSrc = this.defaultImgSrc;\r\n    // }\r\n    if (this.readonly) {\r\n      this.imgtitle = '';\r\n    }\r\n    else if (this.imgTitle) {\r\n      this.imgtitle = this.imgTitle;\r\n    }\r\n    else {\r\n      this.imgtitle = this.localeService.getValue('avatar.imgtitle');\r\n    }\r\n  }\r\n  /*å¤æ­coveræ°æ®æ ¼å¼ï¼ååºä¿®æ¹èµå¼ç»imgSrc\r\n  */\r\n  imgsrcInit(val) {\r\n    let isImg = this.isSrc(val);\r\n    if (isImg) {\r\n      this.imgSrc = this.perfixStr+val;\r\n    }\r\n    else {\r\n      let isFullBase64 = this.isBaseSrc(val);\r\n      if (isFullBase64) {\r\n        this.imgSrc = val\r\n      }\r\n      else {\r\n        this.imgSrc = this.addBase64(val);\r\n      }\r\n    }\r\n  }\r\n\r\n  @HostListener('click')\r\n  onClick(): void {\r\n    if (this.readonly) {\r\n      return;\r\n    }\r\n    (this.file.nativeElement as HTMLInputElement).click();\r\n  }\r\n\r\n  getfiledata(event) {\r\n    if (this.readonly) {\r\n      return;\r\n    }\r\n    const filetarget = event.target as HTMLInputElement;\r\n    let getfile = filetarget.files;\r\n    if (!getfile[0]) {\r\n      return;\r\n    }\r\n    let fileType = getfile[0].type;\r\n    const isLtSize = getfile[0].size / 1024 / 1024 < this.size;\r\n    if (this.currentImgType.indexOf(fileType) < 0) {\r\n      let typeerrorText = this.localeService.getValue('avatar.typeError');\r\n      this.notifyService.error({\r\n        type: 'error',\r\n        title: '',\r\n        msg: typeerrorText\r\n      });\r\n      filetarget.value = '';\r\n      // this.notifyService.error('ä¸ä¼ å¾çç±»åä¸æ­£ç¡®');\r\n      return;\r\n    }\r\n\r\n    if (!isLtSize) {\r\n      let sizeerrorText = this.localeService.getValue('avatar.sizeError');\r\n      let errormes: string = sizeerrorText + this.size + \"M!\";\r\n      this.notifyService.error({\r\n        type: 'error',\r\n        title: '',\r\n        msg: errormes\r\n      });\r\n      filetarget.value = '';\r\n      // this.notifyService.error(`ä¸ä¼ å¾çä¸è½å¤§äº${this.size}M!`);\r\n      return;\r\n    }\r\n    this.transformFile(getfile[0]);\r\n    filetarget.value = '';\r\n  }\r\n\r\n  public getImgFileObj() {\r\n    return this.imgFileObj;\r\n  }\r\n\r\n  transformFile(getfile: any) {\r\n    // const subject = new Subject();\r\n    this.imgFileObj = {\r\n      size: getfile.size,\r\n      name: getfile.name,\r\n      type: getfile.type,\r\n      lastModified: getfile.lastModified,\r\n      lastModifiedDate: getfile.lastModifiedDate\r\n    }\r\n    this.do(getfile).subscribe(res => {\r\n      this.loadingImg = false;\r\n      if (res['state'] === 'done') {\r\n        this.imgSrc = res['result'];\r\n\r\n        //this.onChangeCallback(this.imgSrc);\r\n        this.onChangeCallback(this.removeBase64(this.imgSrc));\r\n        this.onTouchedCallback();\r\n      }\r\n      else if (res['state'] === 'error') {\r\n        let uploaderrorText = this.localeService.getValue('avatar.uploadError');\r\n        this.notifyService.error({\r\n          type: 'error',\r\n          title: '',\r\n          msg: uploaderrorText\r\n        })\r\n        // this.notifyService.error('å¾çä¸ä¼ å¤±è´¥ï¼è¯·éè¯!');\r\n      }\r\n      this.imgFileObj.state = res['state'];\r\n      this.imgFileObj.base64 = res['result'];\r\n      this.imgChange.emit(this.imgFileObj);\r\n    });\r\n  }\r\n\r\n  read(file: File): Observable<string> {\r\n    return Observable.create(observer => {\r\n      const reader = new FileReader();\r\n      reader.readAsDataURL(file);\r\n      //this.loadingImg = true;\r\n      // reader.onloadstart=function(){}\r\n      reader.onload = () => {\r\n        //console.log(reader.result);\r\n        observer.next({ state: 'done', 'result': reader.result });\r\n        observer.complete();\r\n      };\r\n      reader.onerror = function () {\r\n        observer.next({ state: 'error', 'result': reader.result });\r\n        observer.complete();\r\n      }\r\n    });\r\n  }\r\n  do(file: any): Observable<string> {\r\n    return this.read(file as File);\r\n  }\r\n\r\n  writeValue(val: any): void {\r\n    if (val && val.length) {\r\n      // if(this.isBase64){\r\n      //   this.imgSrc = this.addBase64(val);\r\n      // }\r\n      // else{\r\n      //   this.imgSrc = val;\r\n      // }\r\n      this.imgsrcInit(val);\r\n    }\r\n    else if (this.cover) {\r\n      this.imgsrcInit(this.cover);\r\n    }\r\n    else {\r\n      this.imgSrc = this.defaultImgSrc;\r\n    }\r\n  }\r\n  registerOnChange(fn: any): void {\r\n    this.onChangeCallback = fn;\r\n  }\r\n  registerOnTouched(fn: any): void {\r\n    this.onTouchedCallback = fn;\r\n  }\r\n  // setDisabledState?(isDisabled: boolean): void {\r\n  //     this.disabled = isDisabled;\r\n  // }\r\n\r\n  addBase64(val) {\r\n    if (!val) return;\r\n    return 'data:image/jpeg;base64,' + val;\r\n  }\r\n\r\n  removeBase64(val) {\r\n    if (!val) return;\r\n    let img_arr = val.split(',');\r\n    if (img_arr.length) {\r\n      return img_arr[1];\r\n    }\r\n\r\n  }\r\n  //å¤æ­æ¯å¦æ¯å¾çè·¯å¾\r\n  isSrc(url) {\r\n    return (url.match(/\\.(jpeg|jpg|gif|png|svg|bmp|webp)$/) != null)\r\n  }\r\n  //å¤æ­æ¯å¦æ¯å®æbase64\r\n  isBaseSrc(url) {\r\n    return (url.indexOf('data:image/') > -1 ? true : false)\r\n  }\r\n\r\n  errorSrc() {\r\n    this.imgSrc = this.errorImgSrc;\r\n    this.imgtitle = this.localeService.getValue('avatar.loadError');\r\n  }\r\n\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { NotifyModule } from '@farris/ui-notify';\r\nimport { AvatarComponent } from './avatar.component';\r\nimport { FormsModule } from '@angular/forms';\r\nimport { LocaleModule } from '@farris/ui-locale';\r\nimport { FarrisCommonModule } from '@farris/ui-common';\r\n\r\n@NgModule({\r\n  declarations: [AvatarComponent],\r\n  imports: [\r\n    CommonModule,\r\n    FormsModule,\r\n    NotifyModule,\r\n    FarrisCommonModule,\r\n    LocaleModule.forRoot()\r\n  ],\r\n  exports: [AvatarComponent]\r\n})\r\nexport class AvatarModule { }\r\n"],"names":[],"mappings":";;;;;;;;;;;;AAAA,MAKa,aAAa;IAExB,iBAAiB;;;YALlB,UAAU,SAAC;gBACV,UAAU,EAAE,MAAM;aACnB;;;;;;;;;;ACJD,MA6Ba,eAAe;;;;;;IAkF1B,YAAoB,aAA4B,EAAS,aAA4B,EAAqB,MAAe;QAArG,kBAAa,GAAb,aAAa,CAAe;QAAS,kBAAa,GAAb,aAAa,CAAe;QAAqB,WAAM,GAAN,MAAM,CAAS;QAjFjH,kBAAa,GAAG,ysGAAysG,CAAA;QACztG,gBAAW,GAAG,6kFAA6kF,CAAC;;QAKpmF,cAAS,GAAY,KAAK,CAAC;;QAclB,SAAI,GAAW,CAAC,CAAC;QAEjB,gBAAW,GAAW,GAAG,CAAC;QAC1B,iBAAY,GAAW,GAAG,CAAC;QAC3B,aAAQ,GAAW,QAAQ,CAAC;QACrC,aAAQ,GAAW,MAAM,CAAC;;QAEL,cAAS,GAAG,IAAI,YAAY,EAAE,CAAC;QA8C5C,qBAAgB;;;QAAa,SAAS,EAAA;QACtC,sBAAiB;;;QAAa,SAAS,EAAA;QACvC,cAAS,GAAC,EAAE,CAAC;QAGrB,YAAO,GAAG,SAAS,CAAC;QAEpB,mBAAc,GAAG,CAAC,aAAa,EAAE,YAAY,EAAE,WAAW,EAAE,WAAW,EAAE,WAAW,EAAE,WAAW,EAAE,YAAY,EAAE,WAAW,CAAC,CAAC;QAE5H,IAAI,CAAC,aAAa,CAAC,MAAM,CAAC,QAAQ,GAAG,YAAY,CAAC;QAElD,IAAG,IAAI,CAAC,MAAM,EAAC;YACb,IAAG,mBAAmB,EAAC;gBACnB,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,mBAAmB,EAAE,EAAE,CAAC,CAAC;aAC7D;SACH;KACD;;;;;IAlFD,IACI,QAAQ,CAAC,KAAc;QACzB,IAAI,KAAK,KAAK,IAAI,CAAC,SAAS,EAAE;;gBACxB,WAAW,GAAG,IAAI,CAAC,aAAa,CAAC,QAAQ,CAAC,iBAAiB,CAAC;YAChE,IAAI,CAAC,QAAQ,GAAG,KAAK,GAAG,EAAE,IAAI,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,QAAQ,GAAG,WAAW,CAAC,CAAC;YAC3E,IAAI,CAAC,SAAS,GAAG,KAAK,CAAC;SACxB;KAEF;;;;;IACD,IAAI,QAAQ;QACV,OAAO,IAAI,CAAC,SAAS,CAAC;KACvB;;;;;IAYD,IACI,IAAI,CAAC,GAAG;QACV,IAAI,GAAG,IAAI,GAAG,CAAC,MAAM,EAAE;;gBACjB,KAAK,GAAG,GAAG;YACf,IAAI,OAAO,GAAG,KAAK,QAAQ,EAAE;gBAC3B,KAAK,GAAG,GAAG,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;aACxB;YACD,IAAI,KAAK,IAAI,KAAK,CAAC,MAAM,EAAE;gBACzB,IAAI,CAAC,cAAc,GAAG,EAAE,CAAC;gBACzB,KAAK,CAAC,OAAO;;;;gBAAC,CAAC;oBACb,IAAI,CAAC,OAAO,CAAC,IAAI,QAAQ,KAAK,CAAC,CAAC,WAAW,IAAI,MAAM,EAAE;;4BACjD,QAAQ,GAAG,QAAQ,GAAG,CAAC;wBAC3B,IAAI,CAAC,KAAK,KAAK,EAAE;;gCACX,OAAO,GAAG,YAAY;4BAC1B,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;yBACnC;wBACD,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;qBACpC;iBACF,EAAC,CAAC;gBACH,IAAI,IAAI,CAAC,cAAc,CAAC,MAAM,GAAG,CAAC,EAAE;oBAClC,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,GAAG,CAAC,CAAA;iBAC7C;aACF;SACF;KACF;;;;IACD,IAAI,IAAI;QACN,OAAO,IAAI,CAAC,KAAK,CAAC;KACnB;;;;;IAED,IACI,KAAK,CAAC,GAAG;QACX,IAAI,GAAG,EAAE;YACP,IAAI,CAAC,MAAM,GAAG,GAAG,CAAC;YAClB,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;SAC7B;aACI;YACH,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,aAAa,CAAC;SAClC;KACF;;;;IACD,IAAI,KAAK;QACP,OAAO,IAAI,CAAC,MAAM,CAAC;KACpB;;;;IAoBD,QAAQ;;;;;;;QAON,IAAI,IAAI,CAAC,QAAQ,EAAE;YACjB,IAAI,CAAC,QAAQ,GAAG,EAAE,CAAC;SACpB;aACI,IAAI,IAAI,CAAC,QAAQ,EAAE;YACtB,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,QAAQ,CAAC;SAC/B;aACI;YACH,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,aAAa,CAAC,QAAQ,CAAC,iBAAiB,CAAC,CAAC;SAChE;KACF;;;;;;;IAGD,UAAU,CAAC,GAAG;;YACR,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC;QAC3B,IAAI,KAAK,EAAE;YACT,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,SAAS,GAAC,GAAG,CAAC;SAClC;aACI;;gBACC,YAAY,GAAG,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC;YACtC,IAAI,YAAY,EAAE;gBAChB,IAAI,CAAC,MAAM,GAAG,GAAG,CAAA;aAClB;iBACI;gBACH,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,CAAC;aACnC;SACF;KACF;;;;IAGD,OAAO;QACL,IAAI,IAAI,CAAC,QAAQ,EAAE;YACjB,OAAO;SACR;QACD,oBAAC,IAAI,CAAC,IAAI,CAAC,aAAa,IAAsB,KAAK,EAAE,CAAC;KACvD;;;;;IAED,WAAW,CAAC,KAAK;QACf,IAAI,IAAI,CAAC,QAAQ,EAAE;YACjB,OAAO;SACR;;cACK,UAAU,sBAAG,KAAK,CAAC,MAAM,EAAoB;;YAC/C,OAAO,GAAG,UAAU,CAAC,KAAK;QAC9B,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC,EAAE;YACf,OAAO;SACR;;YACG,QAAQ,GAAG,OAAO,CAAC,CAAC,CAAC,CAAC,IAAI;;cACxB,QAAQ,GAAG,OAAO,CAAC,CAAC,CAAC,CAAC,IAAI,GAAG,IAAI,GAAG,IAAI,GAAG,IAAI,CAAC,IAAI;QAC1D,IAAI,IAAI,CAAC,cAAc,CAAC,OAAO,CAAC,QAAQ,CAAC,GAAG,CAAC,EAAE;;gBACzC,aAAa,GAAG,IAAI,CAAC,aAAa,CAAC,QAAQ,CAAC,kBAAkB,CAAC;YACnE,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC;gBACvB,IAAI,EAAE,OAAO;gBACb,KAAK,EAAE,EAAE;gBACT,GAAG,EAAE,aAAa;aACnB,CAAC,CAAC;YACH,UAAU,CAAC,KAAK,GAAG,EAAE,CAAC;;YAEtB,OAAO;SACR;QAED,IAAI,CAAC,QAAQ,EAAE;;gBACT,aAAa,GAAG,IAAI,CAAC,aAAa,CAAC,QAAQ,CAAC,kBAAkB,CAAC;;gBAC/D,QAAQ,GAAW,aAAa,GAAG,IAAI,CAAC,IAAI,GAAG,IAAI;YACvD,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC;gBACvB,IAAI,EAAE,OAAO;gBACb,KAAK,EAAE,EAAE;gBACT,GAAG,EAAE,QAAQ;aACd,CAAC,CAAC;YACH,UAAU,CAAC,KAAK,GAAG,EAAE,CAAC;;YAEtB,OAAO;SACR;QACD,IAAI,CAAC,aAAa,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC;QAC/B,UAAU,CAAC,KAAK,GAAG,EAAE,CAAC;KACvB;;;;IAEM,aAAa;QAClB,OAAO,IAAI,CAAC,UAAU,CAAC;KACxB;;;;;IAED,aAAa,CAAC,OAAY;;QAExB,IAAI,CAAC,UAAU,GAAG;YAChB,IAAI,EAAE,OAAO,CAAC,IAAI;YAClB,IAAI,EAAE,OAAO,CAAC,IAAI;YAClB,IAAI,EAAE,OAAO,CAAC,IAAI;YAClB,YAAY,EAAE,OAAO,CAAC,YAAY;YAClC,gBAAgB,EAAE,OAAO,CAAC,gBAAgB;SAC3C,CAAA;QACD,IAAI,CAAC,EAAE,CAAC,OAAO,CAAC,CAAC,SAAS;;;;QAAC,GAAG;YAC5B,IAAI,CAAC,UAAU,GAAG,KAAK,CAAC;YACxB,IAAI,GAAG,CAAC,OAAO,CAAC,KAAK,MAAM,EAAE;gBAC3B,IAAI,CAAC,MAAM,GAAG,GAAG,CAAC,QAAQ,CAAC,CAAC;;gBAG5B,IAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC;gBACtD,IAAI,CAAC,iBAAiB,EAAE,CAAC;aAC1B;iBACI,IAAI,GAAG,CAAC,OAAO,CAAC,KAAK,OAAO,EAAE;;oBAC7B,eAAe,GAAG,IAAI,CAAC,aAAa,CAAC,QAAQ,CAAC,oBAAoB,CAAC;gBACvE,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC;oBACvB,IAAI,EAAE,OAAO;oBACb,KAAK,EAAE,EAAE;oBACT,GAAG,EAAE,eAAe;iBACrB,CAAC,CAAA;;aAEH;YACD,IAAI,CAAC,UAAU,CAAC,KAAK,GAAG,GAAG,CAAC,OAAO,CAAC,CAAC;YACrC,IAAI,CAAC,UAAU,CAAC,MAAM,GAAG,GAAG,CAAC,QAAQ,CAAC,CAAC;YACvC,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;SACtC,EAAC,CAAC;KACJ;;;;;IAED,IAAI,CAAC,IAAU;QACb,OAAO,UAAU,CAAC,MAAM;;;;QAAC,QAAQ;;kBACzB,MAAM,GAAG,IAAI,UAAU,EAAE;YAC/B,MAAM,CAAC,aAAa,CAAC,IAAI,CAAC,CAAC;;;YAG3B,MAAM,CAAC,MAAM;;;YAAG;;gBAEd,QAAQ,CAAC,IAAI,CAAC,EAAE,KAAK,EAAE,MAAM,EAAE,QAAQ,EAAE,MAAM,CAAC,MAAM,EAAE,CAAC,CAAC;gBAC1D,QAAQ,CAAC,QAAQ,EAAE,CAAC;aACrB,CAAA,CAAC;YACF,MAAM,CAAC,OAAO;;;YAAG;gBACf,QAAQ,CAAC,IAAI,CAAC,EAAE,KAAK,EAAE,OAAO,EAAE,QAAQ,EAAE,MAAM,CAAC,MAAM,EAAE,CAAC,CAAC;gBAC3D,QAAQ,CAAC,QAAQ,EAAE,CAAC;aACrB,CAAA,CAAA;SACF,EAAC,CAAC;KACJ;;;;;IACD,EAAE,CAAC,IAAS;QACV,OAAO,IAAI,CAAC,IAAI,oBAAC,IAAI,GAAS,CAAC;KAChC;;;;;IAED,UAAU,CAAC,GAAQ;QACjB,IAAI,GAAG,IAAI,GAAG,CAAC,MAAM,EAAE;;;;;;;YAOrB,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,CAAC;SACtB;aACI,IAAI,IAAI,CAAC,KAAK,EAAE;YACnB,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;SAC7B;aACI;YACH,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,aAAa,CAAC;SAClC;KACF;;;;;IACD,gBAAgB,CAAC,EAAO;QACtB,IAAI,CAAC,gBAAgB,GAAG,EAAE,CAAC;KAC5B;;;;;IACD,iBAAiB,CAAC,EAAO;QACvB,IAAI,CAAC,iBAAiB,GAAG,EAAE,CAAC;KAC7B;;;;;;;;IAKD,SAAS,CAAC,GAAG;QACX,IAAI,CAAC,GAAG;YAAE,OAAO;QACjB,OAAO,yBAAyB,GAAG,GAAG,CAAC;KACxC;;;;;IAED,YAAY,CAAC,GAAG;QACd,IAAI,CAAC,GAAG;YAAE,OAAO;;YACb,OAAO,GAAG,GAAG,CAAC,KAAK,CAAC,GAAG,CAAC;QAC5B,IAAI,OAAO,CAAC,MAAM,EAAE;YAClB,OAAO,OAAO,CAAC,CAAC,CAAC,CAAC;SACnB;KAEF;;;;;;IAED,KAAK,CAAC,GAAG;QACP,QAAQ,GAAG,CAAC,KAAK,CAAC,oCAAoC,CAAC,IAAI,IAAI,EAAC;KACjE;;;;;;IAED,SAAS,CAAC,GAAG;QACX,QAAQ,GAAG,CAAC,OAAO,CAAC,aAAa,CAAC,GAAG,CAAC,CAAC,GAAG,IAAI,GAAG,KAAK,EAAC;KACxD;;;;IAED,QAAQ;QACN,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,WAAW,CAAC;QAC/B,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,aAAa,CAAC,QAAQ,CAAC,kBAAkB,CAAC,CAAC;KACjE;;;YAxSF,SAAS,SAAC;gBACT,QAAQ,EAAE,eAAe;gBACzB,w4BAAsC;gBAEtC,SAAS,EAAE;oBACT;wBACE,OAAO,EAAE,iBAAiB;wBAC1B,WAAW,EAAE,UAAU;;;wBAAC,MAAM,eAAe,EAAC;wBAC9C,KAAK,EAAE,IAAI;qBACZ;iBACF;;aACF;;;;YA1BQ,aAAa;YAEb,aAAa;YAJkG,QAAQ,uBA+GvC,QAAQ;;;mBA7E9F,SAAS,SAAC,MAAM;uBAGhB,KAAK;mBAaL,KAAK;uBACL,KAAK;0BACL,KAAK;2BACL,KAAK;uBACL,KAAK;wBAGL,MAAM,SAAC,WAAW;mBAGlB,KAAK;oBA6BL,KAAK;sBAmEL,YAAY,SAAC,OAAO;;;;;;;AC5JvB,MAmBa,YAAY;;;YAXxB,QAAQ,SAAC;gBACR,YAAY,EAAE,CAAC,eAAe,CAAC;gBAC/B,OAAO,EAAE;oBACP,YAAY;oBACZ,WAAW;oBACX,YAAY;oBACZ,kBAAkB;oBAClB,YAAY,CAAC,OAAO,EAAE;iBACvB;gBACD,OAAO,EAAE,CAAC,eAAe,CAAC;aAC3B;;;;;;;;;;;;;;;"}
