/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, Input, TemplateRef, ElementRef, ViewChild, ViewContainerRef, ViewEncapsulation, Renderer2 } from '@angular/core';
export class TooltipComponent {
    /**
     * @param {?} el
     * @param {?} render
     */
    constructor(el, render) {
        this.el = el;
        this.render = render;
        this.zIndex = "1070";
        this.contentIsString = true;
        this._tipWidth = '';
        this._tipCls = '';
        /* 位置 */
        this.placement = 'top';
        this.rectifyPlacement = 'top';
        this.rectifyGutter = 20;
        /* 位置样式 */
        this.positionStyle = {};
    }
    /* 普通文本内容 */
    /**
     * @param {?} value
     * @return {?}
     */
    set content(value) {
        if (value instanceof TemplateRef) {
            this.contentIsString = false;
            this.contentViewf.createEmbeddedView(value);
        }
        else {
            this.contentIsString = true;
            this.nfContent = value;
        }
    }
    /**
     * @return {?}
     */
    get content() {
        return this.nfContent;
    }
    /**
     * 因为表单生成没有排除factory,不能使用模板
     * @param {?} value
     * @return {?}
     */
    set tipWidth(value) {
        if (value != this._tipWidth) {
            if (value) {
                this.render.setStyle(this.innerNode.nativeElement, 'width', value);
                this.render.setStyle(this.innerNode.nativeElement, 'max-width', 'none');
            }
            else {
                this.render.removeStyle(this.innerNode.nativeElement, 'width');
                this.render.removeStyle(this.innerNode.nativeElement, 'max-width');
            }
            this._tipWidth = value;
        }
    }
    /**
     * @return {?}
     */
    get tipWidth() {
        return this._tipWidth;
    }
    /**
     * @param {?} value
     * @return {?}
     */
    set tipCls(value) {
        if (value != this._tipCls) {
            //移除旧样式
            this._tipCls && this.render.removeClass(this.el.nativeElement, this._tipCls);
            //追加新样式
            value && this.render.addClass(this.el.nativeElement, value);
            this._tipCls = value;
        }
    }
    /**
     * @return {?}
     */
    get tipCls() {
        return this._tipCls;
    }
    /**
     * @return {?}
     */
    ngOnInit() {
    }
    /**
     * @return {?}
     */
    ngAfterViewInit() {
        if (this.hostBoundingClientRect) {
            this.judgeWidth();
            this.autoRectifyDirection();
            this.calculatePosition(this.hostBoundingClientRect);
        }
    }
    /**
     * 规则判断默认样式下出现滚动条，尺寸从默认变成大号
     * @return {?}
     */
    judgeWidth() {
        if (this.innerNode.nativeElement.scrollHeight > this.innerNode.nativeElement.clientHeight) {
            this.render.addClass(this.innerNode.nativeElement, 'tooltip-inner-lg');
        }
    }
    // 自动纠正方向
    /**
     * @private
     * @return {?}
     */
    autoRectifyDirection() {
        // 标记默认值
        this.rectifyPlacement = this.placement;
        // 整个提示位置
        /** @type {?} */
        const tooltipSize = this.tooltipNode.nativeElement.getBoundingClientRect();
        /** @type {?} */
        const arrowSize = this.arrowNode.nativeElement.getBoundingClientRect();
        /*不考虑，提示框太大的情况,只考虑一次转换位置，
        太复杂的场景，实际项目中不会出现，简化处理此问题
        if(this.referenceBoundingRect.width>tooltipSize){
        }*/
        switch (this.placement) {
            case 'top':
            case 'top-left':
            case 'top-right':
                if (Math.abs(this.hostBoundingClientRect.top - this.referenceBoundingRect.top) < tooltipSize.height + arrowSize.height) {
                    // 高度放不开，转向
                    this.rectifyPlacement = this.rectifyPlacement.replace('top', 'bottom');
                }
                break;
            case 'bottom':
            case 'bottom-left':
            case 'bottom-right':
                if (Math.abs(this.hostBoundingClientRect.bottom - this.referenceBoundingRect.bottom) < tooltipSize.height + arrowSize.height) {
                    // 高度放不开，转向
                    this.rectifyPlacement = this.rectifyPlacement.replace('bottom', 'top');
                }
                break;
            case 'right':
            case 'right-top':
            case 'right-bottom':
                if (Math.abs(this.hostBoundingClientRect.right - this.referenceBoundingRect.right) < tooltipSize.width + arrowSize.width) {
                    // 宽度放不开，转向
                    this.rectifyPlacement = this.rectifyPlacement.replace('right', 'left');
                }
                break;
            case 'left':
            case 'left-top':
            case 'left-bottom':
                if (Math.abs(this.hostBoundingClientRect.left - this.referenceBoundingRect.left) < tooltipSize.width + arrowSize.width) {
                    // 宽度放不开，转向
                    this.rectifyPlacement = this.rectifyPlacement.replace('left', 'right');
                }
                break;
        }
        if (this.rectifyPlacement != this.placement) {
            this.tooltipNode.nativeElement.classList.remove('bs-tooltip-' + this.offsetDirection(this.placement));
            this.tooltipNode.nativeElement.classList.add('bs-tooltip-' + this.offsetDirection(this.rectifyPlacement));
        }
    }
    /**
     * 判断是否超出边界
     * @private
     * @param {?} rect
     * @param {?} value
     * @return {?}
     */
    isOverBounding(rect, value) {
        /** @type {?} */
        let isOver = false;
        /** @type {?} */
        let newValue = 0;
        switch (rect) {
            case 'left':
                if (value <= this.referenceBoundingRect.left) {
                    isOver = true;
                    newValue = this.referenceBoundingRect.left + this.rectifyGutter;
                }
                break;
            case 'right':
                if (value >= this.referenceBoundingRect.right) {
                    isOver = true;
                    newValue = this.referenceBoundingRect.right - this.rectifyGutter;
                }
                break;
            case 'top':
                if (value <= this.referenceBoundingRect.top) {
                    isOver = true;
                    newValue = this.referenceBoundingRect.top + this.rectifyGutter;
                }
                break;
            case 'bottom':
                if (value >= this.referenceBoundingRect.bottom) {
                    isOver = true;
                    newValue = this.referenceBoundingRect.bottom - this.rectifyGutter;
                }
                break;
        }
        return { isOver, newValue };
    }
    /**
     * @private
     * @param {?} datas
     * @param {?=} specialEl
     * @return {?}
     */
    containsEl(datas, specialEl = '') {
        if (!specialEl) {
            specialEl = this.rectifyPlacement;
        }
        for (var i = 0; i < datas.length; i++) {
            if (datas[i] == specialEl)
                return true;
        }
        return false;
    }
    /* 计算tooltip最新位置 */
    /**
     * @param {?} hostPosition
     * @return {?}
     */
    calculatePosition(hostPosition) {
        /** @type {?} */
        let top = 0;
        /** @type {?} */
        let left = 0;
        /** @type {?} */
        let right = 0;
        /** @type {?} */
        let bottom = 0;
        // 整个提示位置
        /** @type {?} */
        const tooltipSize = this.tooltipNode.nativeElement.getBoundingClientRect();
        /** @type {?} */
        const arrowSize = this.arrowNode.nativeElement.getBoundingClientRect();
        switch (this.rectifyPlacement) {
            case 'top':
                top = hostPosition.top - tooltipSize.height - 2;
                left = hostPosition.left + (hostPosition.width - tooltipSize.width) / 2;
                right = left + tooltipSize.width;
                break;
            case 'left':
                top = hostPosition.top + (hostPosition.height - tooltipSize.height) / 2;
                left = hostPosition.left - tooltipSize.width - 2;
                break;
            case 'right':
                top = hostPosition.top + (hostPosition.height - tooltipSize.height) / 2;
                left = hostPosition.right + 2;
                break;
            case 'bottom':
                top = hostPosition.bottom + arrowSize.height + 2;
                left = hostPosition.left + (hostPosition.width - tooltipSize.width) / 2;
                right = left + tooltipSize.width;
                break;
            case 'top-left':
                top = hostPosition.top - tooltipSize.height - 2;
                left = hostPosition.left;
                right = left + tooltipSize.width;
                break;
            case 'top-right':
                top = hostPosition.top - tooltipSize.height - 2;
                left = hostPosition.right - tooltipSize.width;
                right = hostPosition.right;
                break;
            case 'right-top':
                top = hostPosition.top;
                left = hostPosition.right + 2;
                this.arrowNode.nativeElement.style.top = '10%';
                break;
            case 'right-bottom':
                top = hostPosition.bottom - tooltipSize.height;
                left = hostPosition.right + 2;
                this.arrowNode.nativeElement.style.bottom = '10%';
                break;
            case 'bottom-left':
                top = hostPosition.bottom + arrowSize.height + 2;
                left = hostPosition.left;
                right = left + tooltipSize.width;
                break;
            case 'bottom-right':
                top = hostPosition.bottom + arrowSize.height + 2;
                left = hostPosition.right - tooltipSize.width;
                right = hostPosition.right;
                break;
            case 'left-top':
                top = hostPosition.top;
                left = hostPosition.left - tooltipSize.width - 2;
                this.arrowNode.nativeElement.style.top = '10%';
                break;
            case 'left-bottom':
                top = hostPosition.bottom - tooltipSize.height;
                left = hostPosition.left - tooltipSize.width - 2;
                this.arrowNode.nativeElement.style.bottom = '10%';
        }
        /** @type {?} */
        let overResult;
        /** @type {?} */
        let arrowLeft = 0;
        /** @type {?} */
        let arrowTop = 0;
        switch (this.rectifyPlacement) {
            case 'top':
            case 'top-left':
            case 'top-right':
            case 'bottom':
            case 'bottom-left':
            case 'bottom-right':
                overResult = this.isOverBounding('left', left);
                if (overResult.isOver) {
                    left = overResult.newValue;
                }
                else {
                    overResult = this.isOverBounding('right', right);
                    if (overResult.isOver) {
                        left = overResult.newValue - tooltipSize.width;
                    }
                }
                arrowLeft = left - hostPosition.left - hostPosition.width * 0.5 + arrowSize.width * 0.5;
                if (this.rectifyPlacement.indexOf('-left') > 0) {
                    arrowLeft += hostPosition.width * 0.4;
                }
                else if (this.rectifyPlacement.indexOf('-right') > 0) {
                    arrowLeft -= hostPosition.width * 0.4;
                }
                this.arrowNode.nativeElement.style.left = Math.abs(arrowLeft) + 'px';
                break;
            default:
                overResult = this.isOverBounding('top', top);
                if (overResult.isOver) {
                    top = overResult.newValue;
                }
                else {
                    overResult = this.isOverBounding('bottom', bottom);
                    if (overResult.isOver) {
                        top = overResult.newValue - tooltipSize.height;
                    }
                }
                arrowTop = top - hostPosition.top - hostPosition.height * 0.5 + arrowSize.height * 0.5;
                ;
                if (this.rectifyPlacement.indexOf('-top') > 0) {
                    arrowTop += hostPosition.height * 0.4;
                }
                else if (this.rectifyPlacement.indexOf('-bottom') > 0) {
                    arrowTop -= hostPosition.height * 0.4;
                }
                this.arrowNode.nativeElement.style.top = Math.abs(arrowTop) + 'px';
        }
        this.tooltipNode.nativeElement.style.top = top + 'px';
        this.tooltipNode.nativeElement.style.left = left + 'px';
    }
    /*
        *12个位置名解析
        * 因表单生成没有排除factory,而且使用了[class],只能在此处变更
        */
    /**
     * @param {?=} tplacement
     * @return {?}
     */
    offsetDirection(tplacement = '') {
        if (!tplacement) {
            tplacement = this.placement;
        }
        if (tplacement.indexOf('-') !== -1) {
            /** @type {?} */
            const index = tplacement.indexOf('-');
            return tplacement.substring(0, index);
        }
        return tplacement;
    }
}
TooltipComponent.decorators = [
    { type: Component, args: [{
                selector: 'farris-tooltip',
                template: "<div #tooltipEle [class]=\"('bs-tooltip-'+offsetDirection())+' tooltip show'\" [style.zIndex]=\"zIndex\">\r\n    <div #arrowEle class=\"arrow\"></div>\r\n    <div #innerEle class=\"tooltip-inner\">\r\n        <div #contentViewf class=\"tooltip-tmpl\">\r\n            <div *ngIf=\"contentIsString\" class=\"tooltip-text\" [innerHtml]=\"nfContent|tooltipHtml\"></div>\r\n            <ng-container *ngIf=\"!contentIsString\"> {{nfContent}}</ng-container>\r\n        </div>       \r\n    </div>\r\n</div>",
                encapsulation: ViewEncapsulation.None,
                styles: [".bs-tooltip-bottom .arrow,.bs-tooltip-top .arrow{left:50%}.bs-tooltip-left .arrow,.bs-tooltip-right .arrow{top:25%}"]
            }] }
];
/** @nocollapse */
TooltipComponent.ctorParameters = () => [
    { type: ElementRef },
    { type: Renderer2 }
];
TooltipComponent.propDecorators = {
    contentViewf: [{ type: ViewChild, args: ['contentViewf', { read: ViewContainerRef },] }],
    tooltipNode: [{ type: ViewChild, args: ['tooltipEle', { read: ElementRef },] }],
    arrowNode: [{ type: ViewChild, args: ['arrowEle', { read: ElementRef },] }],
    innerNode: [{ type: ViewChild, args: ['innerEle', { read: ElementRef },] }],
    zIndex: [{ type: Input }],
    content: [{ type: Input }],
    tipWidth: [{ type: Input }],
    tipCls: [{ type: Input }],
    placement: [{ type: Input }]
};
if (false) {
    /** @type {?} */
    TooltipComponent.prototype.contentViewf;
    /** @type {?} */
    TooltipComponent.prototype.tooltipNode;
    /** @type {?} */
    TooltipComponent.prototype.arrowNode;
    /** @type {?} */
    TooltipComponent.prototype.innerNode;
    /** @type {?} */
    TooltipComponent.prototype.zIndex;
    /** @type {?} */
    TooltipComponent.prototype.contentIsString;
    /**
     * @type {?}
     * @private
     */
    TooltipComponent.prototype._tipWidth;
    /**
     * @type {?}
     * @private
     */
    TooltipComponent.prototype._tipCls;
    /** @type {?} */
    TooltipComponent.prototype.placement;
    /**
     * @type {?}
     * @private
     */
    TooltipComponent.prototype.rectifyPlacement;
    /** @type {?} */
    TooltipComponent.prototype.hostBoundingClientRect;
    /** @type {?} */
    TooltipComponent.prototype.referenceBoundingRect;
    /**
     * @type {?}
     * @private
     */
    TooltipComponent.prototype.rectifyGutter;
    /** @type {?} */
    TooltipComponent.prototype.nfContent;
    /** @type {?} */
    TooltipComponent.prototype.positionStyle;
    /** @type {?} */
    TooltipComponent.prototype.el;
    /**
     * @type {?}
     * @private
     */
    TooltipComponent.prototype.render;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidG9vbHRpcC5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZmFycmlzL3VpLXRvb2x0aXAvIiwic291cmNlcyI6WyJsaWIvdG9vbHRpcC1jb21wb25lbnQvdG9vbHRpcC5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUFBLE9BQU8sRUFDSCxTQUFTLEVBQUUsS0FBSyxFQUFFLFdBQVcsRUFBRSxVQUFVLEVBQ3pDLFNBQVMsRUFBRSxnQkFBZ0IsRUFBZSxpQkFBaUIsRUFBaUIsU0FBUyxFQUN4RixNQUFNLGVBQWUsQ0FBQztBQVN2QixNQUFNLE9BQU8sZ0JBQWdCOzs7OztJQXVFekIsWUFDVyxFQUFjLEVBQ2IsTUFBaUI7UUFEbEIsT0FBRSxHQUFGLEVBQUUsQ0FBWTtRQUNiLFdBQU0sR0FBTixNQUFNLENBQVc7UUFqRXBCLFdBQU0sR0FBRyxNQUFNLENBQUM7UUFFekIsb0JBQWUsR0FBRyxJQUFJLENBQUM7UUFlZixjQUFTLEdBQUcsRUFBRSxDQUFDO1FBa0JmLFlBQU8sR0FBRyxFQUFFLENBQUM7O1FBZVosY0FBUyxHQUFHLEtBQUssQ0FBQztRQUNuQixxQkFBZ0IsR0FBRyxLQUFLLENBQUM7UUFLekIsa0JBQWEsR0FBRyxFQUFFLENBQUM7O1FBSzNCLGtCQUFhLEdBQUcsRUFBRSxDQUFDO0lBTW5CLENBQUM7Ozs7OztJQS9ERCxJQUNJLE9BQU8sQ0FBQyxLQUFnQztRQUN4QyxJQUFJLEtBQUssWUFBWSxXQUFXLEVBQUU7WUFDOUIsSUFBSSxDQUFDLGVBQWUsR0FBRyxLQUFLLENBQUM7WUFDN0IsSUFBSSxDQUFDLFlBQVksQ0FBQyxrQkFBa0IsQ0FBQyxLQUFLLENBQUMsQ0FBQztTQUMvQzthQUFNO1lBQ0gsSUFBSSxDQUFDLGVBQWUsR0FBRyxJQUFJLENBQUM7WUFDNUIsSUFBSSxDQUFDLFNBQVMsR0FBRyxLQUFLLENBQUM7U0FDMUI7SUFDTCxDQUFDOzs7O0lBQ0QsSUFBSSxPQUFPO1FBQ1AsT0FBTyxJQUFJLENB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YXRlUmVmLCBFbGVtZW50UmVmLCBPbkluaXQsXHJcbiAgICBWaWV3Q2hpbGQsIFZpZXdDb250YWluZXJSZWYsIEhvc3RCaW5kaW5nLCBWaWV3RW5jYXBzdWxhdGlvbiwgU2ltcGxlQ2hhbmdlcywgUmVuZGVyZXIyLCBOZ1pvbmVcclxufSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgQWZ0ZXJWaWV3SW5pdCB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5AQ29tcG9uZW50KHtcclxuICAgIHNlbGVjdG9yOiAnZmFycmlzLXRvb2x0aXAnLFxyXG4gICAgdGVtcGxhdGVVcmw6ICcuL3Rvb2x0aXAuY29tcG9uZW50Lmh0bWwnLFxyXG4gICAgc3R5bGVVcmxzOiBbJy4vdG9vbHRpcC5jb21wb25lbnQuc2NzcyddLFxyXG4gICAgZW5jYXBzdWxhdGlvbjogVmlld0VuY2Fwc3VsYXRpb24uTm9uZVxyXG59KVxyXG5cclxuZXhwb3J0IGNsYXNzIFRvb2x0aXBDb21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQsIEFmdGVyVmlld0luaXQge1xyXG5cclxuICAgIEBWaWV3Q2hpbGQoJ2NvbnRlbnRWaWV3ZicsIHsgcmVhZDogVmlld0NvbnRhaW5lclJlZiB9KSBjb250ZW50Vmlld2Y6IFZpZXdDb250YWluZXJSZWY7XHJcblxyXG4gICAgQFZpZXdDaGlsZCgndG9vbHRpcEVsZScsIHsgcmVhZDogRWxlbWVudFJlZiB9KSB0b29sdGlwTm9kZTogRWxlbWVudFJlZjtcclxuICAgIEBWaWV3Q2hpbGQoJ2Fycm93RWxlJywgeyByZWFkOiBFbGVtZW50UmVmIH0pIGFycm93Tm9kZTogRWxlbWVudFJlZjtcclxuICAgIEBWaWV3Q2hpbGQoJ2lubmVyRWxlJywgeyByZWFkOiBFbGVtZW50UmVmIH0pIGlubmVyTm9kZTogRWxlbWVudFJlZjtcclxuXHJcbiAgICBASW5wdXQoKSB6SW5kZXggPSBcIjEwNzBcIjtcclxuXHJcbiAgICBjb250ZW50SXNTdHJpbmcgPSB0cnVlO1xyXG4gICAgLyog5pmu6YCa5paH5pys5YaF5a65ICovXHJcbiAgICBASW5wdXQoKVxyXG4gICAgc2V0IGNvbnRlbnQodmFsdWU6IHN0cmluZyB8IFRlbXBsYXRlUmVmPGFueT4pIHtcclxuICAgICAgICBpZiAodmFsdWUgaW5zdGFuY2VvZiBUZW1wbGF0ZVJlZikge1xyXG4gICAgICAgICAgICB0aGlzLmNvbnRlbnRJc1N0cmluZyA9IGZhbHNlO1xyXG4gICAgICAgICAgICB0aGlzLmNvbnRlbnRWaWV3Zi5jcmVhdGVFbWJlZGRlZFZpZXcodmFsdWUpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuY29udGVudElzU3RyaW5nID0gdHJ1ZTtcclxuICAgICAgICAgICAgdGhpcy5uZkNvbnRlbnQgPSB2YWx1ZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBnZXQgY29udGVudCgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5uZkNvbnRlbnQ7XHJcbiAgICB9XHJcbiAgICBwcml2YXRlIF90aXBXaWR0aCA9ICcnO1xyXG4gICAgLyoq5Zug5Li66KGo5Y2V55Sf5oiQ5rKh5pyJ5o6S6ZmkZmFjdG9yeSzkuI3og73kvb/nlKjmqKHmnb8gKi9cclxuICAgIEBJbnB1dCgpXHJcbiAgICBzZXQgdGlwV2lkdGgodmFsdWUpIHtcclxuICAgICAgICBpZiAodmFsdWUgIT0gdGhpcy5fdGlwV2lkdGgpIHtcclxuICAgICAgICAgICAgaWYgKHZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnJlbmRlci5zZXRTdHlsZSh0aGlzLmlubmVyTm9kZS5uYXRpdmVFbGVtZW50LCAnd2lkdGgnLCB2YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnJlbmRlci5zZXRTdHlsZSh0aGlzLmlubmVyTm9kZS5uYXRpdmVFbGVtZW50LCAnbWF4LXdpZHRoJywgJ25vbmUnKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyLnJlbW92ZVN0eWxlKHRoaXMuaW5uZXJOb2RlLm5hdGl2ZUVsZW1lbnQsICd3aWR0aCcpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5yZW5kZXIucmVtb3ZlU3R5bGUodGhpcy5pbm5lck5vZGUubmF0aXZlRWxlbWVudCwgJ21heC13aWR0aCcpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMuX3RpcFdpZHRoID0gdmFsdWU7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgZ2V0IHRpcFdpZHRoKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl90aXBXaWR0aDtcclxuICAgIH1cclxuICAgIHByaXZhdGUgX3RpcENscyA9ICcnO1xyXG4gICAgQElucHV0KClcclxuICAgIHNldCB0aXBDbHModmFsdWUpIHtcclxuICAgICAgICBpZiAodmFsdWUgIT0gdGhpcy5fdGlwQ2xzKSB7XHJcbiAgICAgICAgICAgIC8v56e76Zmk5pen5qC35byPXHJcbiAgICAgICAgICAgIHRoaXMuX3RpcENscyAmJiB0aGlzLnJlbmRlci5yZW1vdmVDbGFzcyh0aGlzLmVsLm5hdGl2ZUVsZW1lbnQsIHRoaXMuX3RpcENscyk7XHJcbiAgICAgICAgICAgIC8v6L+95Yqg5paw5qC35byPXHJcbiAgICAgICAgICAgIHZhbHVlICYmIHRoaXMucmVuZGVyLmFkZENsYXNzKHRoaXMuZWwubmF0aXZlRWxlbWVudCwgdmFsdWUpO1xyXG4gICAgICAgICAgICB0aGlzLl90aXBDbHMgPSB2YWx1ZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBnZXQgdGlwQ2xzKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl90aXBDbHM7XHJcbiAgICB9XHJcbiAgICAvKiDkvY3nva4gKi9cclxuICAgIEBJbnB1dCgpIHBsYWNlbWVudCA9ICd0b3AnO1xyXG4gICAgcHJpdmF0ZSByZWN0aWZ5UGxhY2VtZW50ID0gJ3RvcCc7XHJcbiAgICAvLyDnrq3lpLTkvY3nva7lj4LnhadcclxuICAgIGhvc3RCb3VuZGluZ0NsaWVudFJlY3Q6IGFueTtcclxuICAgIC8vIOi+ueeVjOS9jee9ruWPgueFp1xyXG4gICAgcmVmZXJlbmNlQm91bmRpbmdSZWN0OiBhbnk7XHJcbiAgICBwcml2YXRlIHJlY3RpZnlHdXR0ZXIgPSAyMDtcclxuXHJcbiAgICBuZkNvbnRlbnQ6IHN0cmluZyB8IFRlbXBsYXRlUmVmPGFueT47XHJcblxyXG4gICAgLyog5L2N572u5qC35byPICovXHJcbiAgICBwb3NpdGlvblN0eWxlID0ge307XHJcblxyXG4gICAgY29uc3RydWN0b3IoXHJcbiAgICAgICAgcHVibGljIGVsOiBFbGVtZW50UmVmLFxyXG4gICAgICAgIHByaXZhdGUgcmVuZGVyOiBSZW5kZXJlcjJcclxuICAgICkge1xyXG4gICAgfVxyXG5cclxuICAgIG5nT25Jbml0KCkge1xyXG4gICAgfVxyXG4gICAgbmdBZnRlclZpZXdJbml0KCkge1xyXG4gICAgICAgIGlmICh0aGlzLmhvc3RCb3VuZGluZ0NsaWVudFJlY3QpIHtcclxuICAgICAgICAgICAgdGhpcy5qdWRnZVdpZHRoKCk7XHJcbiAgICAgICAgICAgIHRoaXMuYXV0b1JlY3RpZnlEaXJlY3Rpb24oKTtcclxuICAgICAgICAgICAgdGhpcy5jYWxjdWxhdGVQb3NpdGlvbih0aGlzLmhvc3RCb3VuZGluZ0NsaWVudFJlY3QpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICog6KeE5YiZ5Yik5pat6buY6K6k5qC35byP5LiL5Ye6546w5rua5Yqo5p2h77yM5bC65a+45LuO6buY6K6k5Y+Y5oiQ5aSn5Y+3XHJcbiAgICAgKi9cclxuICAgIGp1ZGdlV2lkdGgoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuaW5uZXJOb2RlLm5hdGl2ZUVsZW1lbnQuc2Nyb2xsSGVpZ2h0ID4gdGhpcy5pbm5lck5vZGUubmF0aXZlRWxlbWVudC5jbGllbnRIZWlnaHQpIHtcclxuICAgICAgICAgICAgdGhpcy5yZW5kZXIuYWRkQ2xhc3ModGhpcy5pbm5lck5vZGUubmF0aXZlRWxlbWVudCwgJ3Rvb2x0aXAtaW5uZXItbGcnKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICAvLyDoh6rliqjnuqDmraPmlrnlkJFcclxuICAgIHByaXZhdGUgYXV0b1JlY3RpZnlEaXJlY3Rpb24oKSB7XHJcbiAgICAgICAgLy8g5qCH6K6w6buY6K6k5YC8XHJcbiAgICAgICAgdGhpcy5yZWN0aWZ5UGxhY2VtZW50ID0gdGhpcy5wbGFjZW1lbnQ7XHJcbiAgICAgICAgLy8g5pW05Liq5o+Q56S65L2N572uXHJcbiAgICAgICAgY29uc3QgdG9vbHRpcFNpemUgPSB0aGlzLnRvb2x0aXBOb2RlLm5hdGl2ZUVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XHJcbiAgICAgICAgY29uc3QgYXJyb3dTaXplID0gdGhpcy5hcnJvd05vZGUubmF0aXZlRWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcclxuICAgICAgICAvKuS4jeiAg+iZke+8jOaPkOekuuahhuWkquWkp+eahOaDheWGtSzlj6rogIPomZHkuIDmrKHovazmjaLkvY3nva7vvIxcclxuICAgICAgICDlpKrlpI3mnYLnmoTlnLrmma/vvIzlrp7pmYXpobnnm67kuK3kuI3kvJrlh7rnjrDvvIznroDljJblpITnkIbmraTpl67pophcclxuICAgICAgICBpZih0aGlzLnJlZmVyZW5jZUJvdW5kaW5nUmVjdC53aWR0aD50b29sdGlwU2l6ZSl7XHJcbiAgICAgICAgfSovXHJcbiAgICAgICAgc3dpdGNoICh0aGlzLnBsYWNlbWVudCkge1xyXG4gICAgICAgICAgICBjYXNlICd0b3AnOlxyXG4gICAgICAgICAgICBjYXNlICd0b3AtbGVmdCc6XHJcbiAgICAgICAgICAgIGNhc2UgJ3RvcC1yaWdodCc6XHJcbiAgICAgICAgICAgICAgICBpZiAoTWF0aC5hYnModGhpcy5ob3N0Qm91bmRpbmdDbGllbnRSZWN0LnRvcCAtIHRoaXMucmVmZXJlbmNlQm91bmRpbmdSZWN0LnRvcCkgPCB0b29sdGlwU2l6ZS5oZWlnaHQgKyBhcnJvd1NpemUuaGVpZ2h0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8g6auY5bqm5pS+5LiN5byA77yM6L2s5ZCRXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZWN0aWZ5UGxhY2VtZW50ID0gdGhpcy5yZWN0aWZ5UGxhY2VtZW50LnJlcGxhY2UoJ3RvcCcsICdib3R0b20nKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlICdib3R0b20nOlxyXG4gICAgICAgICAgICBjYXNlICdib3R0b20tbGVmdCc6XHJcbiAgICAgICAgICAgIGNhc2UgJ2JvdHRvbS1yaWdodCc6XHJcbiAgICAgICAgICAgICAgICBpZiAoTWF0aC5hYnModGhpcy5ob3N0Qm91bmRpbmdDbGllbnRSZWN0LmJvdHRvbSAtIHRoaXMucmVmZXJlbmNlQm91bmRpbmdSZWN0LmJvdHRvbSkgPCB0b29sdGlwU2l6ZS5oZWlnaHQgKyBhcnJvd1NpemUuaGVpZ2h0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8g6auY5bqm5pS+5LiN5byA77yM6L2s5ZCRXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZWN0aWZ5UGxhY2VtZW50ID0gdGhpcy5yZWN0aWZ5UGxhY2VtZW50LnJlcGxhY2UoJ2JvdHRvbScsICd0b3AnKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlICdyaWdodCc6XHJcbiAgICAgICAgICAgIGNhc2UgJ3JpZ2h0LXRvcCc6XHJcbiAgICAgICAgICAgIGNhc2UgJ3JpZ2h0LWJvdHRvbSc6XHJcbiAgICAgICAgICAgICAgICBpZiAoTWF0aC5hYnModGhpcy5ob3N0Qm91bmRpbmdDbGllbnRSZWN0LnJpZ2h0IC0gdGhpcy5yZWZlcmVuY2VCb3VuZGluZ1JlY3QucmlnaHQpIDwgdG9vbHRpcFNpemUud2lkdGggKyBhcnJvd1NpemUud2lkdGgpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyDlrr3luqbmlL7kuI3lvIDvvIzovazlkJFcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnJlY3RpZnlQbGFjZW1lbnQgPSB0aGlzLnJlY3RpZnlQbGFjZW1lbnQucmVwbGFjZSgncmlnaHQnLCAnbGVmdCcpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgJ2xlZnQnOlxyXG4gICAgICAgICAgICBjYXNlICdsZWZ0LXRvcCc6XHJcbiAgICAgICAgICAgIGNhc2UgJ2xlZnQtYm90dG9tJzpcclxuICAgICAgICAgICAgICAgIGlmIChNYXRoLmFicyh0aGlzLmhvc3RCb3VuZGluZ0NsaWVudFJlY3QubGVmdCAtIHRoaXMucmVmZXJlbmNlQm91bmRpbmdSZWN0LmxlZnQpIDwgdG9vbHRpcFNpemUud2lkdGggKyBhcnJvd1NpemUud2lkdGgpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyDlrr3luqbmlL7kuI3lvIDvvIzovazlkJFcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnJlY3RpZnlQbGFjZW1lbnQgPSB0aGlzLnJlY3RpZnlQbGFjZW1lbnQucmVwbGFjZSgnbGVmdCcsICdyaWdodCcpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy5yZWN0aWZ5UGxhY2VtZW50ICE9IHRoaXMucGxhY2VtZW50KSB7XHJcbiAgICAgICAgICAgIHRoaXMudG9vbHRpcE5vZGUubmF0aXZlRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKCdicy10b29sdGlwLScgKyB0aGlzLm9mZnNldERpcmVjdGlvbih0aGlzLnBsYWNlbWVudCkpO1xyXG4gICAgICAgICAgICB0aGlzLnRvb2x0aXBOb2RlLm5hdGl2ZUVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnYnMtdG9vbHRpcC0nICsgdGhpcy5vZmZzZXREaXJlY3Rpb24odGhpcy5yZWN0aWZ5UGxhY2VtZW50KSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiDliKTmlq3mmK/lkKbotoXlh7rovrnnlYxcclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBpc092ZXJCb3VuZGluZyhyZWN0LCB2YWx1ZSkge1xyXG4gICAgICAgIGxldCBpc092ZXIgPSBmYWxzZTtcclxuICAgICAgICBsZXQgbmV3VmFsdWUgPSAwO1xyXG4gICAgICAgIHN3aXRjaCAocmVjdCkge1xyXG4gICAgICAgICAgICBjYXNlICdsZWZ0JzpcclxuICAgICAgICAgICAgICAgIGlmICh2YWx1ZSA8PSB0aGlzLnJlZmVyZW5jZUJvdW5kaW5nUmVjdC5sZWZ0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaXNPdmVyID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICBuZXdWYWx1ZSA9IHRoaXMucmVmZXJlbmNlQm91bmRpbmdSZWN0LmxlZnQgKyB0aGlzLnJlY3RpZnlHdXR0ZXI7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAncmlnaHQnOlxyXG4gICAgICAgICAgICAgICAgaWYgKHZhbHVlID49IHRoaXMucmVmZXJlbmNlQm91bmRpbmdSZWN0LnJpZ2h0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaXNPdmVyID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICBuZXdWYWx1ZSA9IHRoaXMucmVmZXJlbmNlQm91bmRpbmdSZWN0LnJpZ2h0IC0gdGhpcy5yZWN0aWZ5R3V0dGVyO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgJ3RvcCc6XHJcbiAgICAgICAgICAgICAgICBpZiAodmFsdWUgPD0gdGhpcy5yZWZlcmVuY2VCb3VuZGluZ1JlY3QudG9wKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaXNPdmVyID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICBuZXdWYWx1ZSA9IHRoaXMucmVmZXJlbmNlQm91bmRpbmdSZWN0LnRvcCArIHRoaXMucmVjdGlmeUd1dHRlcjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlICdib3R0b20nOlxyXG4gICAgICAgICAgICAgICAgaWYgKHZhbHVlID49IHRoaXMucmVmZXJlbmNlQm91bmRpbmdSZWN0LmJvdHRvbSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlzT3ZlciA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgbmV3VmFsdWUgPSB0aGlzLnJlZmVyZW5jZUJvdW5kaW5nUmVjdC5ib3R0b20gLSB0aGlzLnJlY3RpZnlHdXR0ZXI7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHsgaXNPdmVyLCBuZXdWYWx1ZSB9O1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgY29udGFpbnNFbChkYXRhcywgc3BlY2lhbEVsID0gJycpIHtcclxuICAgICAgICBpZiAoIXNwZWNpYWxFbCkge1xyXG4gICAgICAgICAgICBzcGVjaWFsRWwgPSB0aGlzLnJlY3RpZnlQbGFjZW1lbnQ7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZGF0YXMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgaWYgKGRhdGFzW2ldID09IHNwZWNpYWxFbClcclxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcblxyXG4gICAgLyog6K6h566XdG9vbHRpcOacgOaWsOS9jee9riAqL1xyXG4gICAgY2FsY3VsYXRlUG9zaXRpb24oaG9zdFBvc2l0aW9uOiBhbnkpIHtcclxuICAgICAgICBsZXQgdG9wID0gMDtcclxuICAgICAgICBsZXQgbGVmdCA9IDA7XHJcbiAgICAgICAgbGV0IHJpZ2h0ID0gMDtcclxuICAgICAgICBsZXQgYm90dG9tID0gMDtcclxuICAgICAgICAvLyDmlbTkuKrmj5DnpLrkvY3nva5cclxuICAgICAgICBjb25zdCB0b29sdGlwU2l6ZSA9IHRoaXMudG9vbHRpcE5vZGUubmF0aXZlRWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcclxuICAgICAgICBjb25zdCBhcnJvd1NpemUgPSB0aGlzLmFycm93Tm9kZS5uYXRpdmVFbGVtZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xyXG5cclxuICAgICAgICBzd2l0Y2ggKHRoaXMucmVjdGlmeVBsYWNlbWVudCkge1xyXG4gICAgICAgICAgICBjYXNlICd0b3AnOlxyXG4gICAgICAgICAgICAgICAgdG9wID0gaG9zdFBvc2l0aW9uLnRvcCAtIHRvb2x0aXBTaXplLmhlaWdodCAtIDI7XHJcbiAgICAgICAgICAgICAgICBsZWZ0ID0gaG9zdFBvc2l0aW9uLmxlZnQgKyAoaG9zdFBvc2l0aW9uLndpZHRoIC0gdG9vbHRpcFNpemUud2lkdGgpIC8gMjtcclxuICAgICAgICAgICAgICAgIHJpZ2h0ID0gbGVmdCArIHRvb2x0aXBTaXplLndpZHRoO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgJ2xlZnQnOlxyXG4gICAgICAgICAgICAgICAgdG9wID0gaG9zdFBvc2l0aW9uLnRvcCArIChob3N0UG9zaXRpb24uaGVpZ2h0IC0gdG9vbHRpcFNpemUuaGVpZ2h0KSAvIDI7XHJcbiAgICAgICAgICAgICAgICBsZWZ0ID0gaG9zdFBvc2l0aW9uLmxlZnQgLSB0b29sdGlwU2l6ZS53aWR0aCAtIDI7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAncmlnaHQnOlxyXG4gICAgICAgICAgICAgICAgdG9wID0gaG9zdFBvc2l0aW9uLnRvcCArIChob3N0UG9zaXRpb24uaGVpZ2h0IC0gdG9vbHRpcFNpemUuaGVpZ2h0KSAvIDI7XHJcbiAgICAgICAgICAgICAgICBsZWZ0ID0gaG9zdFBvc2l0aW9uLnJpZ2h0ICsgMjtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlICdib3R0b20nOlxyXG4gICAgICAgICAgICAgICAgdG9wID0gaG9zdFBvc2l0aW9uLmJvdHRvbSArIGFycm93U2l6ZS5oZWlnaHQgKyAyO1xyXG4gICAgICAgICAgICAgICAgbGVmdCA9IGhvc3RQb3NpdGlvbi5sZWZ0ICsgKGhvc3RQb3NpdGlvbi53aWR0aCAtIHRvb2x0aXBTaXplLndpZHRoKSAvIDI7XHJcbiAgICAgICAgICAgICAgICByaWdodCA9IGxlZnQgKyB0b29sdGlwU2l6ZS53aWR0aDtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlICd0b3AtbGVmdCc6XHJcbiAgICAgICAgICAgICAgICB0b3AgPSBob3N0UG9zaXRpb24udG9wIC0gdG9vbHRpcFNpemUuaGVpZ2h0IC0gMjtcclxuICAgICAgICAgICAgICAgIGxlZnQgPSBob3N0UG9zaXRpb24ubGVmdDtcclxuICAgICAgICAgICAgICAgIHJpZ2h0ID0gbGVmdCArIHRvb2x0aXBTaXplLndpZHRoO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgJ3RvcC1yaWdodCc6XHJcbiAgICAgICAgICAgICAgICB0b3AgPSBob3N0UG9zaXRpb24udG9wIC0gdG9vbHRpcFNpemUuaGVpZ2h0IC0gMjtcclxuICAgICAgICAgICAgICAgIGxlZnQgPSBob3N0UG9zaXRpb24ucmlnaHQgLSB0b29sdGlwU2l6ZS53aWR0aDtcclxuICAgICAgICAgICAgICAgIHJpZ2h0ID0gaG9zdFBvc2l0aW9uLnJpZ2h0O1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgJ3JpZ2h0LXRvcCc6XHJcbiAgICAgICAgICAgICAgICB0b3AgPSBob3N0UG9zaXRpb24udG9wO1xyXG4gICAgICAgICAgICAgICAgbGVmdCA9IGhvc3RQb3NpdGlvbi5yaWdodCArIDI7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmFycm93Tm9kZS5uYXRpdmVFbGVtZW50LnN0eWxlLnRvcCA9ICcxMCUnO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgJ3JpZ2h0LWJvdHRvbSc6XHJcbiAgICAgICAgICAgICAgICB0b3AgPSBob3N0UG9zaXRpb24uYm90dG9tIC0gdG9vbHRpcFNpemUuaGVpZ2h0O1xyXG4gICAgICAgICAgICAgICAgbGVmdCA9IGhvc3RQb3NpdGlvbi5yaWdodCArIDI7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmFycm93Tm9kZS5uYXRpdmVFbGVtZW50LnN0eWxlLmJvdHRvbSA9ICcxMCUnO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgJ2JvdHRvbS1sZWZ0JzpcclxuICAgICAgICAgICAgICAgIHRvcCA9IGhvc3RQb3NpdGlvbi5ib3R0b20gKyBhcnJvd1NpemUuaGVpZ2h0ICsgMjtcclxuICAgICAgICAgICAgICAgIGxlZnQgPSBob3N0UG9zaXRpb24ubGVmdDtcclxuICAgICAgICAgICAgICAgIHJpZ2h0ID0gbGVmdCArIHRvb2x0aXBTaXplLndpZHRoO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgJ2JvdHRvbS1yaWdodCc6XHJcbiAgICAgICAgICAgICAgICB0b3AgPSBob3N0UG9zaXRpb24uYm90dG9tICsgYXJyb3dTaXplLmhlaWdodCArIDI7XHJcbiAgICAgICAgICAgICAgICBsZWZ0ID0gaG9zdFBvc2l0aW9uLnJpZ2h0IC0gdG9vbHRpcFNpemUud2lkdGg7XHJcbiAgICAgICAgICAgICAgICByaWdodCA9IGhvc3RQb3NpdGlvbi5yaWdodDtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlICdsZWZ0LXRvcCc6XHJcbiAgICAgICAgICAgICAgICB0b3AgPSBob3N0UG9zaXRpb24udG9wO1xyXG4gICAgICAgICAgICAgICAgbGVmdCA9IGhvc3RQb3NpdGlvbi5sZWZ0IC0gdG9vbHRpcFNpemUud2lkdGggLSAyO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5hcnJvd05vZGUubmF0aXZlRWxlbWVudC5zdHlsZS50b3AgPSAnMTAlJztcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlICdsZWZ0LWJvdHRvbSc6XHJcbiAgICAgICAgICAgICAgICB0b3AgPSBob3N0UG9zaXRpb24uYm90dG9tIC0gdG9vbHRpcFNpemUuaGVpZ2h0O1xyXG4gICAgICAgICAgICAgICAgbGVmdCA9IGhvc3RQb3NpdGlvbi5sZWZ0IC0gdG9vbHRpcFNpemUud2lkdGggLSAyO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5hcnJvd05vZGUubmF0aXZlRWxlbWVudC5zdHlsZS5ib3R0b20gPSAnMTAlJztcclxuICAgICAgICB9XHJcbiAgICAgICAgbGV0IG92ZXJSZXN1bHQ7XHJcbiAgICAgICAgbGV0IGFycm93TGVmdCA9IDA7XHJcbiAgICAgICAgbGV0IGFycm93VG9wID0gMFxyXG4gICAgICAgIHN3aXRjaCAodGhpcy5yZWN0aWZ5UGxhY2VtZW50KSB7XHJcbiAgICAgICAgICAgIGNhc2UgJ3RvcCc6XHJcbiAgICAgICAgICAgIGNhc2UgJ3RvcC1sZWZ0JzpcclxuICAgICAgICAgICAgY2FzZSAndG9wLXJpZ2h0JzpcclxuICAgICAgICAgICAgY2FzZSAnYm90dG9tJzpcclxuICAgICAgICAgICAgY2FzZSAnYm90dG9tLWxlZnQnOlxyXG4gICAgICAgICAgICBjYXNlICdib3R0b20tcmlnaHQnOlxyXG4gICAgICAgICAgICAgICAgb3ZlclJlc3VsdCA9IHRoaXMuaXNPdmVyQm91bmRpbmcoJ2xlZnQnLCBsZWZ0KTtcclxuICAgICAgICAgICAgICAgIGlmIChvdmVyUmVzdWx0LmlzT3Zlcikge1xyXG4gICAgICAgICAgICAgICAgICAgIGxlZnQgPSBvdmVyUmVzdWx0Lm5ld1ZhbHVlO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBvdmVyUmVzdWx0ID0gdGhpcy5pc092ZXJCb3VuZGluZygncmlnaHQnLCByaWdodCk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG92ZXJSZXN1bHQuaXNPdmVyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxlZnQgPSBvdmVyUmVzdWx0Lm5ld1ZhbHVlIC0gdG9vbHRpcFNpemUud2lkdGg7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgYXJyb3dMZWZ0ID0gbGVmdCAtIGhvc3RQb3NpdGlvbi5sZWZ0IC0gaG9zdFBvc2l0aW9uLndpZHRoICogMC41ICsgYXJyb3dTaXplLndpZHRoICogMC41O1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMucmVjdGlmeVBsYWNlbWVudC5pbmRleE9mKCctbGVmdCcpID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGFycm93TGVmdCArPSBob3N0UG9zaXRpb24ud2lkdGggKiAwLjQ7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMucmVjdGlmeVBsYWNlbWVudC5pbmRleE9mKCctcmlnaHQnKSA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICBhcnJvd0xlZnQgLT0gaG9zdFBvc2l0aW9uLndpZHRoICogMC40O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdGhpcy5hcnJvd05vZGUubmF0aXZlRWxlbWVudC5zdHlsZS5sZWZ0ID0gTWF0aC5hYnMoYXJyb3dMZWZ0KSArICdweCc7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgIG92ZXJSZXN1bHQgPSB0aGlzLmlzT3ZlckJvdW5kaW5nKCd0b3AnLCB0b3ApO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmIChvdmVyUmVzdWx0LmlzT3Zlcikge1xyXG4gICAgICAgICAgICAgICAgICAgIHRvcCA9IG92ZXJSZXN1bHQubmV3VmFsdWU7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIG92ZXJSZXN1bHQgPSB0aGlzLmlzT3ZlckJvdW5kaW5nKCdib3R0b20nLCBib3R0b20pO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChvdmVyUmVzdWx0LmlzT3Zlcikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0b3AgPSBvdmVyUmVzdWx0Lm5ld1ZhbHVlIC0gdG9vbHRpcFNpemUuaGVpZ2h0O1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGFycm93VG9wID0gdG9wIC0gaG9zdFBvc2l0aW9uLnRvcCAtIGhvc3RQb3NpdGlvbi5oZWlnaHQgKiAwLjUgKyBhcnJvd1NpemUuaGVpZ2h0ICogMC41OztcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLnJlY3RpZnlQbGFjZW1lbnQuaW5kZXhPZignLXRvcCcpID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGFycm93VG9wICs9IGhvc3RQb3NpdGlvbi5oZWlnaHQgKiAwLjQ7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMucmVjdGlmeVBsYWNlbWVudC5pbmRleE9mKCctYm90dG9tJykgPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYXJyb3dUb3AgLT0gaG9zdFBvc2l0aW9uLmhlaWdodCAqIDAuNDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHRoaXMuYXJyb3dOb2RlLm5hdGl2ZUVsZW1lbnQuc3R5bGUudG9wID0gTWF0aC5hYnMoYXJyb3dUb3ApICsgJ3B4JztcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy50b29sdGlwTm9kZS5uYXRpdmVFbGVtZW50LnN0eWxlLnRvcCA9IHRvcCArICdweCc7XHJcbiAgICAgICAgdGhpcy50b29sdGlwTm9kZS5uYXRpdmVFbGVtZW50LnN0eWxlLmxlZnQgPSBsZWZ0ICsgJ3B4JztcclxuXHJcbiAgICB9XHJcblxyXG4gICAgLyogXHJcbiAgICAqMTLkuKrkvY3nva7lkI3op6PmnpAgXHJcbiAgICAqIOWboOihqOWNleeUn+aIkOayoeacieaOkumZpGZhY3Rvcnks6ICM5LiU5L2/55So5LqGW2NsYXNzXSzlj6rog73lnKjmraTlpITlj5jmm7RcclxuICAgICovXHJcbiAgICBvZmZzZXREaXJlY3Rpb24odHBsYWNlbWVudCA9ICcnKSB7XHJcbiAgICAgICAgaWYgKCF0cGxhY2VtZW50KSB7XHJcbiAgICAgICAgICAgIHRwbGFjZW1lbnQgPSB0aGlzLnBsYWNlbWVudDtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRwbGFjZW1lbnQuaW5kZXhPZignLScpICE9PSAtMSkge1xyXG4gICAgICAgICAgICBjb25zdCBpbmRleCA9IHRwbGFjZW1lbnQuaW5kZXhPZignLScpO1xyXG4gICAgICAgICAgICByZXR1cm4gdHBsYWNlbWVudC5zdWJzdHJpbmcoMCwgaW5kZXgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdHBsYWNlbWVudDtcclxuICAgIH1cclxufVxyXG4iXX0=