!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/common"),require("@angular/forms"),require("@farris/ui-forms"),require("@farris/ui-lookup"),require("@farris/ui-combo-list"),require("@farris/ui-input-group"),require("@farris/ui-modal"),require("@farris/ui-datepicker"),require("@farris/ui-number-spinner"),require("@farris/ui-time-picker"),require("@farris/ui-locale"),require("@farris/ui-switch"),require("@farris/ui-tooltip"),require("@farris/ui-common"),require("@angular/core"),require("rxjs")):"function"==typeof define&&define.amd?define("@farris/ui-batch-edit-dialog",["exports","@angular/common","@angular/forms","@farris/ui-forms","@farris/ui-lookup","@farris/ui-combo-list","@farris/ui-input-group","@farris/ui-modal","@farris/ui-datepicker","@farris/ui-number-spinner","@farris/ui-time-picker","@farris/ui-locale","@farris/ui-switch","@farris/ui-tooltip","@farris/ui-common","@angular/core","rxjs"],t):t((e.farris=e.farris||{},e.farris["ui-batch-edit-dialog"]={}),e.ng.common,e.ng.forms,e.uiForms,e.uiLookup,e.uiComboList,e.uiInputGroup,e.uiModal,e.uiDatepicker,e.uiNumberSpinner,e.uiTimePicker,e.uiLocale,e.uiSwitch,e.uiTooltip,e.uiCommon,e.ng.core,e.rxjs)}(this,function(e,t,n,i,o,r,l,a,s,c,p,d,u,f,g,m,h){"use strict";var v=(x.prototype.ngOnInit=function(){this.inputs.push({fields:this.fields.slice(0),field:"",controlType:"default",id:"input0",value:null,options:{}}),this.cdr.markForCheck()},x.prototype.cancel=function(e){this.canceled.emit({instance:this,event:e})},x.prototype.confirm=function(e){this.confirmed.emit({instance:this,event:e})},x.prototype.appendRow=function(){var e=this.computeFields()||[];this.inputs.push({fields:e,controlType:"default",value:null,id:"input"+this.inputs.length}),this.cdr.markForCheck()},x.prototype.removeRow=function(e,t){this.inputs.splice(t,1),this.updateFields(),this.cdr.markForCheck()},x.prototype.onFieldChanged=function(e,t){var n=(e||{}).value,i=void 0===n?null:n,o=this.inputs[t];o.fields=this.computeFields(),o.field=i;var r=this.fields.find(function(e){return e.id===i}),l=r&&r.dataType||null;if(o.dataType=l,i){var a=this.eidtors.find(function(e){return e.field===i});a&&a.editor&&(o.controlType=a.editor.controlType||"default",o.options=a.editor.options||{})}this.updateFields()},x.prototype.onSelectRows=function(e){var t=e||{},n=t.field,i=void 0===n?null:n,o=t.rows,r=void 0===o?[]:o;i&&(this.inputs.find(function(e){return e.field===i}).value=r)},x.prototype.computeFields=function(e){var n=this;return this.fields.filter(function(t){return!(!e||t.id!==e)||!n.inputs.find(function(e){return e.field===t.id})})},x.prototype.updateFields=function(){var t=this;this.inputs.forEach(function(e){e.fields=t.computeFields(e.field)}),this.cdr.markForCheck()},x.decorators=[{type:m.Component,args:[{selector:"farris-batch-edit-dialog",template:'<div class="bulkedit-controls-container f-utils-flex-column">\r\n  <div class="modal-header ng-draggable" #header>\r\n    <div class="modal-title">\r\n      <span class="modal-title-label">{{\'batchEditDialog.title\' | locale:\'批量编辑\'}}</span>\r\n    </div>\r\n    <div class="actions">\r\n      <ul>\r\n        <li class="f-btn-icon f-bare" (click)=\'cancel($event)\'><span class="f-icon modal_close"></span></li>\r\n      </ul>\r\n    </div>\r\n  </div>\r\n  <div class="fields-panel flex-fill f-utils-overflow-xhya">\r\n    <div class="clause-row clause">\r\n      <table>\r\n        <tr>\r\n          <th colspan="2" class="header">{{ \'batchEditDialog.field\' | locale: \'请选择要编辑的列：\' }}</th>\r\n          <th colspan="2" class="header">{{ \'batchEditDialog.fieldValue\' | locale: \'请输入要更改的值：\' }}</th>\r\n        </tr>\r\n        <tr *ngFor="let input of inputs;let row = index">\r\n          <td class="field-wrapper">\r\n            <farris-combo-list [enableClear]="false" (valueChange)="onFieldChanged($event,row)" [idField]="\'id\'"\r\n              [textField]="\'label\'" [data]="input.fields">\r\n            </farris-combo-list>\r\n          </td>\r\n          <td class="middle-arrow">\r\n            <svg width="14px" height="14px" viewBox="0 0 14 14" version="1.1" xmlns="http://www.w3.org/2000/svg"\r\n              xmlns:xlink="http://www.w3.org/1999/xlink">\r\n              <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\r\n                <g transform="translate(-659.000000, -232.000000)" fill="#BDC2D3" fill-rule="nonzero">\r\n                  <g transform="translate(287.000000, 120.000000)">\r\n                    <g>\r\n                      <g transform="translate(372.000000, 112.000000)">\r\n                        <path\r\n                          d="M0,8.27882064 L13.6922097,8.27882064 L13.6922097,9.99034539 L0,9.99034539 L0,8.27882064 Z M0,4 L13.6922097,4 L13.6922097,5.71152475 L0,5.71152475 L0,4 Z">\r\n                        </path>\r\n                      </g>\r\n                    </g>\r\n                  </g>\r\n                </g>\r\n              </g>\r\n            </svg>\r\n          </td>\r\n          <td class="value-wrapper">\r\n            \x3c!--帮助--\x3e\r\n            <ng-template [ngIf]="input?.controlType===\'lookup\'">\r\n              \x3c!-- <ng-container *ngTemplateOutlet="lookupTemplate;context:input"></ng-container> --\x3e\r\n              <farris-lookup-grid #lookupGrid [lookup-extra]="input?.field" [ins]="lookupGrid" [enableClear]=\'false\'\r\n                (onSelectRows)="onSelectRows($event)" input-end-edit [uri]="input?.options?.uri" [editable]="false"\r\n                [mapFields]="input?.options?.mapFields" [displayType]="input?.options?.displayType"\r\n                [idField]="input?.options?.idField" [singleSelect]="input?.options?.singleSelect"\r\n                [pageSize]="input?.options?.pageSize" [pageIndex]="1" [pagination]="input?.options?.pagination"\r\n                [textField]="input?.options?.textField" [valueField]="input?.options?.valueField"\r\n                [title]="input?.options?.dialogTitle" [showMaxButton]="input?.options?.showMaxButton"\r\n                [showCloseButton]="input?.options?.showCloseButton" [resizable]="input?.options?.resizable"\r\n                [context]="input?.options?.context" [expandLevel]="input?.options?.expandLevel"\r\n                [isRecordSize]="input?.options?.isRecordSize" [enableFullTree]="input?.options?.enableFullTree"\r\n                [loadTreeDataType]="\'default\'">\r\n              </farris-lookup-grid>\r\n            </ng-template>\r\n            \x3c!--输入框--\x3e\r\n            <ng-template\r\n              [ngIf]="input?.controlType===\'textbox\' ||input?.controlType===\'textarea\' || input?.controlType === \'input-group\'">\r\n              \x3c!-- <ng-container *ngTemplateOutlet="textboxTemplate;context:input"></ng-container> --\x3e\r\n              <input-group [(ngModel)]="input.value"></input-group>\r\n            </ng-template>\r\n            \x3c!--日期--\x3e\r\n            <ng-template [ngIf]="input?.controlType === \'datepicker\'">\r\n              \x3c!-- <ng-container *ngTemplateOutlet="datepickerTemplate;context:input"></ng-container> --\x3e\r\n              <farris-datepicker [(ngModel)]="input.value" [dateRange]="input?.options?.dateRange">\r\n              </farris-datepicker>\r\n            </ng-template>\r\n            \x3c!--数字--\x3e\r\n            <ng-template [ngIf]="input?.controlType === \'numberbox\'">\r\n              \x3c!-- <ng-container *ngTemplateOutlet="numberboxTemplate;context:input"></ng-container> --\x3e\r\n              <farris-number-spinner [(ngModel)]="input.value" [min]="input?.options?.min" [max]="input?.options?.max"\r\n                [precision]="input?.options?.precision" [step]="input?.options?.step">\r\n              </farris-number-spinner>\r\n            </ng-template>\r\n            \x3c!--下拉--\x3e\r\n            <ng-template [ngIf]="input?.controlType === \'combolist\' || input?.controlType === \'select\'">\r\n              \x3c!-- <ng-container *ngTemplateOutlet="combolistTemplate;context:input"></ng-container> --\x3e\r\n              <farris-combo-list [(ngModel)]="input.value"\r\n                [idField]="input?.options?.valueField || input?.options?.idField || \'id\'"\r\n                [textField]="input?.options?.textField ||\'label\'" [data]="input?.options?.data">\r\n              </farris-combo-list>\r\n            </ng-template>\r\n            \x3c!--时间--\x3e\r\n            <ng-template [ngIf]="input?.controlType === \'timepicker\'">\r\n              \x3c!-- <ng-container *ngTemplateOutlet="timepickerTemplate;context:input"></ng-container> --\x3e\r\n              <farris-time-picker [(ngModel)]="input.value" [use12Hours]="input?.options?.use12Hours">\r\n              </farris-time-picker>\r\n            </ng-template>\r\n            \x3c!--复选框--\x3e\r\n            <ng-template [ngIf]="input?.controlType === \'checkbox\'">\r\n              <div class="custom-control custom-checkbox f-checkradio-single pl-5">\r\n                <input [id]="input.id" class="custom-control-input" type="checkbox" [(ngModel)]="input.value">\r\n                <label class="custom-control-label" [for]="input.id"></label>\r\n              </div>\r\n            </ng-template>\r\n            \x3c!--开关--\x3e\r\n            <ng-template [ngIf]="input?.controlType === \'switch\'">\r\n              <farris-switch [(ngModel)]="input.value" class="ml-5">\r\n              </farris-switch>\r\n            </ng-template>\r\n            \x3c!--默认--\x3e\r\n            <ng-template [ngIf]="!input?.controlType || input?.controlType===\'default\'">\r\n              <div class="default-input"></div>\r\n            </ng-template>\r\n\r\n          </td>\r\n          <td class="remove-wrapper">\r\n            <a href="javascript:;" (click)="removeRow($event,row)">\r\n              <svg width="14px" height="14px" viewBox="0 0 14 14" version="1.1" xmlns="http://www.w3.org/2000/svg"\r\n                xmlns:xlink="http://www.w3.org/1999/xlink">\r\n                <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\r\n                  <g transform="translate(-1031.000000, -270.000000)">\r\n                    <g transform="translate(287.000000, 120.000000)">\r\n                      <g transform="translate(26.000000, 82.000000)">\r\n                        <g>\r\n                          <g transform="translate(718.000000, 68.000000)">\r\n                            <rect x="0" y="0" width="14" height="14"></rect>\r\n                            <circle fill="#F46160" cx="7" cy="7" r="6.125"></circle>\r\n                            <rect fill="#FFFFFF" x="3.9375" y="6.3875" width="6.125" height="1.225"></rect>\r\n                          </g>\r\n                        </g>\r\n                      </g>\r\n                    </g>\r\n                  </g>\r\n                </g>\r\n              </svg>\r\n            </a>\r\n          </td>\r\n        </tr>\r\n      </table>\r\n      <a href="javascript:;" (click)="appendRow()" class="append"><i class="f-icon f-icon-add"></i>{{\r\n        \'batchEditDialog.appendText\' | locale: \'添加新编辑列\' }}</a>\r\n      <span class="farris-label-tips" farrisTooltip [content]="\'batchEditDialog.appendTips\' | locale:\'添加更多列进行批量操作\'"\r\n        [placement]="\'right\'">\r\n        <svg width="14px" height="14px" viewBox="0 0 14 14" version="1.1" xmlns="http://www.w3.org/2000/svg"\r\n          xmlns:xlink="http://www.w3.org/1999/xlink">\r\n          <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\r\n            <g transform="translate(-415.000000, -308.000000)">\r\n              <g transform="translate(287.000000, 120.000000)">\r\n                <g>\r\n                  <g transform="translate(128.000000, 188.000000)">\r\n                    <g>\r\n                      <circle fill="#EAF4FF" cx="7" cy="7" r="7"></circle>\r\n                      <path\r\n                        d="M8.89254404,3.34549258 C9.3007073,3.75365584 9.50478893,4.26385992 9.50478893,4.97814564 C9.50478893,5.48834972 9.40274812,5.9985538 9.09662567,6.30467625 C9.09662567,6.40671707 8.79050322,6.71283951 8.17825832,7.2230436 C7.97417669,7.42712523 7.87213587,7.52916604 7.77009506,7.73324768 C7.66805424,7.93732931 7.56601342,8.24345176 7.56601342,8.54957421 L7.56601342,8.75365584 L6.34152363,8.75365584 L6.34152363,8.54957421 C6.34152363,8.14141094 6.44356444,7.73324768 6.54560526,7.52916604 C6.74968689,7.2230436 7.15785016,6.71283951 7.87213587,6.10059462 L8.07621751,5.79447217 C8.28029914,5.48834972 8.38233995,5.28426809 8.38233995,4.97814564 C8.38233995,4.56998237 8.28029914,4.26385992 8.07621751,4.05977829 C7.87213587,3.85569666 7.46397261,3.75365584 7.05580934,3.75365584 C6.64764608,3.75365584 6.23948281,3.95773747 6.03540118,4.26385992 C5.83131955,4.46794155 5.72927873,4.87610482 5.72927873,5.3863089 L4.50478893,5.3863089 C4.50478893,4.56998237 4.70887057,3.95773747 5.21907465,3.44753339 C5.72927873,2.93732931 6.34152363,2.73324768 7.15785016,2.73324768 C7.87213587,2.73324768 8.48438077,2.93732931 8.89254404,3.34549258 Z M6.95024133,11.2385252 C7.39206913,11.2385252 7.75024133,10.880353 7.75024133,10.4385252 C7.75024133,9.99669739 7.39206913,9.63852519 6.95024133,9.63852519 C6.50841353,9.63852519 6.15024133,9.99669739 6.15024133,10.4385252 C6.15024133,10.880353 6.50841353,11.2385252 6.95024133,11.2385252 Z"\r\n                        fill="#2A87FF" fill-rule="nonzero"></path>\r\n                    </g>\r\n                  </g>\r\n                </g>\r\n              </g>\r\n            </g>\r\n          </g>\r\n        </svg>\r\n      </span>\r\n    </div>\r\n  </div>\r\n  <div class="buttons flex-shrink-0">\r\n    <div class="modal-footer">\r\n      <div class="footer-info">{{\'batchEditDialog.selected\' | locale:\'已选\'}}<span>{{rows}}</span>{{\'batchEditDialog.row\'\r\n        | locale:\'行\'}}</div>\r\n      <button type="button" class="btn btn-secondary" (click)=\'cancel($event)\'>{{\'batchEditDialog.cancelText\' |\r\n        locale:\'取消\'}}</button>\r\n      <button type="button" class="btn btn-primary" (click)="confirm($event)">{{\'batchEditDialog.okText\' | locale:\'确定\'}}\r\n      </button>\r\n    </div>\r\n  </div>\r\n</div>\r\n\x3c!--帮助控件--\x3e\r\n\x3c!-- <ng-template #lookupTemplate let-options="options" let-field="field">\r\n    <farris-lookup-grid #lookupGrid [lookup-extra]="field" [ins]="lookupGrid" (onSelectRows)="onSelectRows($event)"\r\n        input-end-edit [uri]="options?.uri" [editable]="false" [mapFields]="options?.mapFields"\r\n        [displayType]="options?.displayType" [idField]="options?.idField" [singleSelect]="options?.singleSelect"\r\n        [pageSize]="options?.pageSize" [pageIndex]="1" [pagination]="options?.pagination"\r\n        [textField]="options?.textField" [valueField]="options?.valueField" [title]="options?.dialogTitle"\r\n        [showMaxButton]="options?.showMaxButton" [showCloseButton]="options?.showCloseButton"\r\n        [resizable]="options?.resizable" [context]="options?.context" [expandLevel]="options?.expandLevel"\r\n        [isRecordSize]="options?.isRecordSize" [enableFullTree]="options?.enableFullTree"\r\n        [loadTreeDataType]="\'default\'"></farris-lookup-grid>\r\n</ng-template> --\x3e\r\n\x3c!--输入框控件--\x3e\r\n\x3c!-- <ng-template #textboxTemplate let-value1="value">\r\n    <input-group [(ngModel)]="value1"></input-group>\r\n</ng-template> --\x3e\r\n\x3c!--日期控件--\x3e\r\n\x3c!-- <ng-template #datepickerTemplate let-value="value" let-options="options">\r\n    <farris-datepicker [(ngModel)]="value" [dateRange]="options?.dateRange"></farris-datepicker>\r\n</ng-template> --\x3e\r\n\x3c!--数字控件--\x3e\r\n\x3c!-- <ng-template #numberboxTemplate let-value="value" let-options="options">\r\n    <farris-number-spinner [(ngModel)]="value" [min]="options?.min" [max]="options?.max"\r\n        [precision]="options?.precision" [step]="options?.step">\r\n    </farris-number-spinner>\r\n</ng-template> --\x3e\r\n\x3c!--checkbox--\x3e\r\n\x3c!-- <ng-template>\r\n    <farris-checkboxgroup [(ngModel)]="value" [data]="">\r\n    </farris-checkboxgroup>\r\n</ng-template> --\x3e\r\n\x3c!--下拉--\x3e\r\n\x3c!-- <ng-template #combolistTemplate let-value="value" let-options="options">\r\n    <farris-combo-list [(ngModel)]="value" [idField]="options?.idField || \'id\'"\r\n        [textField]="options?.labelField ||\'label\'" [data]="options?.items"></farris-combo-list>\r\n</ng-template> --\x3e\r\n\r\n\x3c!--时间--\x3e\r\n\x3c!-- <ng-template #timepickerTemplate let-value="value" let-options="options">\r\n    <farris-time-picker [(ngModel)]="value" [use12Hours]="options?.use12Hours"></farris-time-picker>\r\n</ng-template> --\x3e',styles:[".bulkedit-controls-container{position:relative;height:100%;padding:10px;min-height:450px;min-height:350px}.fields-panel{height:100%;padding:15px;overflow:auto;opacity:.85;border:1px solid #e9ecf3;background:#fff;border-radius:8px}.clause-row table{width:100%;margin-bottom:10px}.clause-row table tr{height:35px}.clause-row table tr th.header{width:50%;text-align:left;padding-left:5px;font-weight:400}.clause-row table tr td.field-wrapper,.clause-row table tr td.value-wrapper{width:45%}.clause-row table tr td.middle-arrow{width:50px;text-align:center}.clause-row table tr td.remove-wrapper{width:45px;text-align:center}.clause-row .remove-wrapper .f-icon-remove_face{color:#f46160;font-size:13px}.clauses{border-collapse:collapse;width:100%;padding:1px}.clauses .header{color:#666}.multi-field-edit .clauses .field{width:35%}.multi-field-edit .clauses .operator{width:35px}.clauses .clause-row{height:25px;vertical-align:top}.clause-row a.f-icon-add{padding-right:3px}.clause-row a.append{color:#4e94ff;line-height:18px}.clause-row .default-input{height:30px;background-color:#f5f6f9;border:1px solid #dee1ea;border-radius:3px}.bulkedit-controls-container .modal-title-label{font-weight:400;font-size:17px}.bulkedit-controls-container .modal-header{border-bottom:none;padding-bottom:20px}.bulkedit-controls-container .modal-footer{background:0 0;border-top:none}.bulkedit-controls-container .footer-info{text-align:left;width:90%;color:#2d2f33;font-size:14px}.bulkedit-controls-container .footer-info span{color:#000015;font-size:17px;padding:0 5px;font-weight:700}.bulkedit-controls-container .farris-label-tips{margin-left:5px}.bulkedit-controls-container .farris-label-tips .f-icon{color:#2a84ff;font-size:17px;opacity:.6}.bulkedit-controls-container .buttons{padding-top:5px}"]}]}],x.ctorParameters=function(){return[{type:m.Injector},{type:m.ChangeDetectorRef},{type:d.LocaleService}]},x.propDecorators={header:[{type:m.ViewChild,args:["header"]}],fields:[{type:m.Input}],eidtors:[{type:m.Input}],dialogRef:[{type:m.Input}],title:[{type:m.Input}],rows:[{type:m.Input}],confirmed:[{type:m.Output}],canceled:[{type:m.Output}]},x);function x(e,t,n){this.injector=e,this.cdr=t,this.localeService=n,this.inputs=[],this.fields=[],this.eidtors=[],this.dialogRef=null,this.title=null,this.rows=1,this.confirmed=new m.EventEmitter,this.canceled=new m.EventEmitter}var b=(Object.defineProperty(w.prototype,"showNotify",{get:function(){var e=localStorage.getItem("BATCH_EDIT_DIALOG_SHOW_NOTIFY");return"always"===e||!e},set:function(e){var t="never";t=!0===e?"always":"never",localStorage.setItem("BATCH_EDIT_DIALOG_SHOW_NOTIFY",t)},enumerable:!0,configurable:!0}),w.prototype.ngOnInit=function(){},w.prototype.cancel=function(e){this.canceled.emit({instance:this,event:e})},w.prototype.confirm=function(e){this.confirmed.emit({instance:this,event:e})},w.prototype.setRemindOpporunity=function(e){var t=e&&e.target&&e.target.checked||!1;this.showNotify=!0!==t},w.decorators=[{type:m.Component,args:[{selector:"lib-result-confirm",template:'<div class="result-confirm modal-message">\n  <div class="modal-content">\n    <div class="modal-header">\n      <div class="modal-title">\n        <span class="modal-title-label">{{\'batchEditDialog.confirmTitle\' | locale:\'提示\'}}</span>\n      </div>\n      <div class="actions">\n        <ul>\n          <li class="f-btn-icon f-bare"><span class="f-icon modal_close" (click)=\'cancel($event)\'></span></li>\n        </ul>\n      </div>\n    </div>\n    <div class="f-utils-absolute-all" style="height: 10px; z-index: 1; display: none;"></div>\n    <div class="modal-body">\n      <div style="position: static;" class="ps">\n        <div class="ps-content">\n          <div class="farris-messager">\n            <section class="modal-tips d-flex flex-row messager-type-question">\n              <div class="float-left modal-tips-iconwrap"><span class="f-icon f-icon-warning"></span></div>\n              <div class="modal-tips-content">\n                <p class="toast-msg-title">{{\'batchEditDialog.confirmText\' | locale:\'将修改{0}行数据，确定修改吗？\' | replaceX:\n                  rows}}</p>\n              </div>\n            </section>\n            <div class="modal-footer">\n              <div class="custom-control custom-checkbox custom-control-inline never-show">\n                <input class="custom-control-input" id="never" type="checkbox" (change)="setRemindOpporunity($event)">\n                <label class="custom-control-label" for="never">{{\'batchEditDialog.neverShow\' | locale:\'不再提示\'}}</label>\n              </div>\n              <button class="btn btn-secondary  btn-lg" type="button"\n                (click)=\'cancel($event)\'>{{\'batchEditDialog.cancelText\' | locale:\'取消\'}}</button>\n              <button class="btn btn-primary btn-lg" type="button" (click)="confirm($event)">{{\'batchEditDialog.okText\'\n                | locale:\'确定\'}}</button>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>',styles:[".result-confirm{height:100%}.result-confirm .modal-header{border-bottom:none}.modal-footer .never-show{text-align:left;width:90%;color:#2d2f33;font-size:14px}"]}]}],w.ctorParameters=function(){return[]},w.propDecorators={dialogRef:[{type:m.Input}],rows:[{type:m.Input}],confirmed:[{type:m.Output}],canceled:[{type:m.Output}],showNotify:[{type:m.Input}]},w);function w(){this.dialogRef=null,this.rows=0,this.confirmed=new m.EventEmitter,this.canceled=new m.EventEmitter}var y=(k.prototype.batchEdit=function(e,t){var n=this,i=this.localeService.getValue("batchEditDialog.title"),o=this.localeService.getValue("batchEditDialog.okText"),r=this.localeService.getValue("batchEditDialog.cancelText"),l=t||{},a=l.width,s=void 0===a?792:a,c=l.height,p=void 0===c?580:c,d=l.title,u=void 0===d?i:d,f=l.rows,g=void 0===f?1:f,m=this.componentFactoryResolver.resolveComponentFactory(v);return this.componentRef=m.create(this.injector),this.componentRef.instance.fields=this.getFields(e),this.componentRef.instance.eidtors=this.getEditors(e),this.componentRef.instance.title=u,this.componentRef.instance.rows=g,this.dialogRef=this.modalService.show(this.componentRef,{title:u,width:s,height:p,buttons:[{text:r,cls:"btn btn-secondary",handle:function(){n.dialogRef.close()}},{text:o,cls:"btn btn-primary",handle:function(){n.userConfired()}}],showHeader:!1,showButtons:!1}),this.componentRef.instance.confirmed.subscribe(function(e){n.canConfirm(t).subscribe(function(e){!0===e&&(n.userConfired(t),n.dialogRef.close())})}),this.componentRef.instance.canceled.subscribe(function(e){n.dialogRef.close()}),this.componentRef.instance.dialogRef=this.dialogRef,this.dialogRef.dialog.instance.draggbar.handle=this.componentRef.instance.header.nativeElement,this.dialogRef},k.prototype.userConfired=function(e){var t=this.componentRef&&this.componentRef.instance&&this.componentRef.instance.inputs||[];t&&0<t.length&&t.forEach(function(e){var t=e.controlType,n=e.dataType;"checkbox"===t&&"boolean"===n&&(e.value=!!e.value)}),e&&e.onConfirm&&"function"==typeof e.onConfirm&&e.onConfirm(t),this.onUserConfirmed.next(t)},k.prototype.getFields=function(e){var c=[];return!e||e.length<1||e.forEach(function(e){e&&0<e.length&&e.forEach(function(e){var t=e||{},n=t.field,i=void 0===n?null:n,o=t.title,r=void 0===o?"":o,l=t.dataType,a=void 0===l?null:l,s=t.enableBatchEdit;i&&void 0!==s&&s&&c.push({id:i,label:r,dataType:a})})}),c},k.prototype.getEditors=function(e){var a=[];return!e||e.length<1||e.forEach(function(e){e&&0<e.length&&e.forEach(function(e){var t=e||{},n=t.field,i=void 0===n?null:n,o=t.editor,r=void 0===o?{}:o,l=t.enableBatchEdit;r&&i&&void 0!==l&&l&&(r.controlType=r.type,a.push({field:i,editor:r}))})}),a},k.prototype.canConfirm=function(e){var t=new h.Subject,n=e&&e.showNotify,i=(e||{}).rows,o=void 0===i?1:i;if(!this.isValueChanged())return h.of(!0);if(n===undefined&&(n=!0),!n)return h.of(!0);var r=null;try{var l=this.componentFactoryResolver.resolveComponentFactory(b).create(this.injector),a=l.instance.showNotify||!1;if(l.instance.rows=o,!a)return h.of(!0);r=this.modalService.show(l,{title:"",width:500,height:240,showHeader:!1,showButtons:!1,buttons:[]}),l.instance.confirmed.subscribe(function(e){r&&r.close(),t.next(!0)}),l.instance.canceled.subscribe(function(e){r&&r.close(),t.next(!1)})}catch(s){return h.of(!0)}return t},k.prototype.isValueChanged=function(){var e=this.componentRef&&this.componentRef.instance&&this.componentRef.instance.inputs||[];return!(!e||e.length<1||e.every(function(e){return!e.field}))},k.decorators=[{type:m.Injectable}],k.ctorParameters=function(){return[{type:m.Injector},{type:a.BsModalService},{type:m.ComponentFactoryResolver},{type:d.LocaleService}]},k);function k(e,t,n,i){this.injector=e,this.modalService=t,this.componentFactoryResolver=n,this.localeService=i,this.dialogRef=null,this.componentRef=null,this.onUserConfirmed=new m.EventEmitter}var T=(F.prototype.ngAfterViewInit=function(){var t=this;this.lookup&&(this.lookup.dictPicked=function(e){return t.onSelectRows&&t.onSelectRows.emit({field:t.field,rows:[].concat(e)}),h.of({closeDialog:!0})})},F.decorators=[{type:m.Directive,args:[{selector:"[lookup-extra]"}]}],F.ctorParameters=function(){return[]},F.propDecorators={field:[{type:m.Input,args:["lookup-extra"]}],lookup:[{type:m.Input,args:["ins"]}],onSelectRows:[{type:m.Output}]},F);function F(){this.onSelectRows=new m.EventEmitter}var C=(R.decorators=[{type:m.NgModule,args:[{declarations:[v,T,b],imports:[t.CommonModule,n.FormsModule,i.FarrisFormsModule,o.LookupModule,r.ComboListModule,l.InputGroupModule,a.ModalModule,s.FarrisDatePickerModule,c.NumberSpinnerModule,p.TimePickerModule,u.SwitchModule,f.FarrisTooltipModule,g.FarrisCommonModule,d.LocaleModule.forRoot()],exports:[v,T,b],entryComponents:[v,b]}]}],R);function R(){}e.BatchEditDialogService=y,e.BatchEditDialogComponent=v,e.ResultConfirmComponent=b,e.BatchEditDialogModule=C,e.LookupDirective=T,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=farris-ui-batch-edit-dialog.umd.min.js.map