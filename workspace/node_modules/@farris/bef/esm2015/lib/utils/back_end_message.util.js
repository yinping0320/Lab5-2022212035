/**
 * @fileoverview added by tsickle
 * Generated from: lib/utils/back_end_message.util.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { AppContext, BackEndMessage, BACK_END_MESSAGE_HANDLER_TOKEN, NAMESPACE } from "@farris/devkit";
export class BackEndMessageUtil {
    /**
     * @param {?} messages
     * @param {?} injector
     * @param {?=} options
     * @return {?}
     */
    static handleMessage(messages, injector, options) {
        /** @type {?} */
        const namespace = injector.get(NAMESPACE, null);
        /** @type {?} */
        const appContext = injector.get(AppContext, null);
        /** @type {?} */
        const context = {
            ns: namespace,
            appContext
        };
        /** @type {?} */
        const bizMessages = this.buildBackEndMessages(messages);
        /** @type {?} */
        const backEndMessage = new BackEndMessage.Message(bizMessages, context);
        /** @type {?} */
        const backEndMessageHandler = injector.get(BACK_END_MESSAGE_HANDLER_TOKEN, null);
        if (backEndMessageHandler) {
            backEndMessageHandler.handle(backEndMessage, options);
        }
    }
    /**
     * @param {?} injector
     * @return {?}
     */
    static isBackEndMessageHandlerExist(injector) {
        /** @type {?} */
        const backEndMessageHandler = injector.get(BACK_END_MESSAGE_HANDLER_TOKEN, null);
        return backEndMessageHandler && true || false;
    }
    /**
     * @param {?} messages
     * @return {?}
     */
    static getFormlessMessages(messages) {
        /** @type {?} */
        const bizMessages = this.buildBackEndMessages(messages) || [];
        return bizMessages.filter((/**
         * @param {?} message
         * @return {?}
         */
        (message) => {
            return !message.location || !message.location.columns || message.location.columns.length < 1 || !message.location.nodeCode;
        }));
    }
    /**
     * @param {?} messages
     * @return {?}
     */
    static buildBackEndMessages(messages) {
        if (!messages || messages.length < 1 || !Array.isArray(messages)) {
            return null;
        }
        /** @type {?} */
        const bizMessages = [];
        messages.forEach((/**
         * @param {?} message
         * @return {?}
         */
        (message) => {
            /** @type {?} */
            const bizMessage = {
                level: message.level,
                message: message.message
            };
            if (message.hasOwnProperty('location') && message.location) {
                bizMessage.location = {
                    nodeCode: message.location.nodeCode,
                    rows: message.location.dataIds,
                    columns: message.location.columnNames
                };
            }
            bizMessages.push(bizMessage);
        }));
        return bizMessages;
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYmFja19lbmRfbWVzc2FnZS51dGlsLmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGZhcnJpcy9iZWYvIiwic291cmNlcyI6WyJsaWIvdXRpbHMvYmFja19lbmRfbWVzc2FnZS51dGlsLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7O0FBQ0EsT0FBTyxFQUFFLFVBQVUsRUFBRSxjQUFjLEVBQUUsOEJBQThCLEVBQUUsU0FBUyxFQUFFLE1BQU0sZ0JBQWdCLENBQUM7QUFFdkcsTUFBTSxPQUFPLGtCQUFrQjs7Ozs7OztJQUN0QixNQUFNLENBQUMsYUFBYSxDQUFDLFFBQWtCLEVBQUUsUUFBa0IsRUFBRSxPQUFhOztjQUN6RSxTQUFTLEdBQUcsUUFBUSxDQUFDLEdBQUcsQ0FBQyxTQUFTLEVBQUUsSUFBSSxDQUFDOztjQUN6QyxVQUFVLEdBQUcsUUFBUSxDQUFDLEdBQUcsQ0FBYSxVQUFVLEVBQUUsSUFBSSxDQUFDOztjQUN2RCxPQUFPLEdBQW1DO1lBQzlDLEVBQUUsRUFBRSxTQUFTO1lBQ2IsVUFBVTtTQUNYOztjQUNLLFdBQVcsR0FBRyxJQUFJLENBQUMsb0JBQW9CLENBQUMsUUFBUSxDQUFDOztjQUNqRCxjQUFjLEdBQUcsSUFBSSxjQUFjLENBQUMsT0FBTyxDQUFDLFdBQVcsRUFBRSxPQUFPLENBQUM7O2NBQ2pFLHFCQUFxQixHQUFHLFFBQVEsQ0FBQyxHQUFHLENBQXdDLDhCQUE4QixFQUFFLElBQUksQ0FBQztRQUN2SCxJQUFJLHFCQUFxQixFQUFFO1lBQ3pCLHFCQUFxQixDQUFDLE1BQU0sQ0FBQyxjQUFjLEVBQUUsT0FBTyxDQUFDLENBQUM7U0FDdkQ7SUFDSCxDQUFDOzs7OztJQUNNLE1BQU0sQ0FBQyw0QkFBNEIsQ0FBQyxRQUFrQjs7Y0FDckQscUJBQXFCLEdBQUcsUUFBUSxDQUFDLEdBQUcsQ0FBd0MsOEJBQThCLEVBQUUsSUFBSSxDQUFDO1FBQ3ZILE9BQU8scUJBQXFCLElBQUksSUFBSSxJQUFJLEtBQUssQ0FBQztJQUNoRCxDQUFDOzs7OztJQUNNLE1BQU0sQ0FBQyxtQkFBbUIsQ0FBQyxRQUFzQzs7Y0FDaEUsV0FBVyxHQUFHLElBQUksQ0FBQyxvQkFBb0IsQ0FBQyxRQUFRLENBQUMsSUFBSSxFQUFFO1FBQzdELE9BQU8sV0FBVyxDQUFDLE1BQU07Ozs7UUFBQyxDQUFDLE9BQW1DLEVBQUUsRUFBRTtZQUNoRSxPQUFPLENBQUMsT0FBTyxDQUFDLFFBQVEsSUFBSSxDQUFDLE9BQU8sQ0FBQyxRQUFRLENBQUMsT0FBTyxJQUFJLE9BQU8sQ0FBQyxRQUFRLENBQUMsT0FBTyxDQUFDLE1BQU0sR0FBRyxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsUUFBUSxDQUFDLFFBQVEsQ0FBQztRQUM3SCxDQUFDLEVBQUMsQ0FBQztJQUNMLENBQUM7Ozs7O0lBQ00sTUFBTSxDQUFDLG9CQUFvQixDQUFDLFFBQWtCO1FBQ25ELElBQUksQ0FBQyxRQUFRLElBQUksUUFBUSxDQUFDLE1BQU0sR0FBRyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLFFBQVEsQ0FBQyxFQUFFO1lBQ2hFLE9BQU8sSUFBSSxDQUFDO1NBQ2I7O2NBQ0ssV0FBVyxHQUFpQyxFQUFFO1FBQ3BELFFBQVEsQ0FBQyxPQUFPOzs7O1FBQUMsQ0FBQyxPQUFZLEVBQUUsRUFBRTs7a0JBQzFCLFVBQVUsR0FBK0I7Z0JBQzdDLEtBQUssRUFBRSxPQUFPLENBQUMsS0FBSztnQkFDcEIsT0FBTyxFQUFFLE9BQU8sQ0FBQyxPQUFPO2FBQ3pCO1lBQ0QsSUFBSSxPQUFPLENBQUMsY0FBYyxDQUFDLFVBQVUsQ0FBQyxJQUFJLE9BQU8sQ0FBQyxRQUFRLEVBQUU7Z0JBQzFELFVBQVUsQ0FBQyxRQUFRLEdBQUc7b0JBQ3BCLFFBQVEsRUFBRSxPQUFPLENBQUMsUUFBUSxDQUFDLFFBQVE7b0JBQ25DLElBQUksRUFBRSxPQUFPLENBQUMsUUFBUSxDQUFDLE9BQU87b0JBQzlCLE9BQU8sRUFBRSxPQUFPLENBQUMsUUFBUSxDQUFDLFdBQVc7aUJBQ3RDLENBQUM7YUFDSDtZQUNELFdBQVcsQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLENBQUM7UUFDL0IsQ0FBQyxFQUFDLENBQUM7UUFDSCxPQUFPLFdBQVcsQ0FBQztJQUNyQixDQUFDO0NBQ0YiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBJbmplY3RvciB9IGZyb20gXCJAYW5ndWxhci9jb3JlXCI7XHJcbmltcG9ydCB7IEFwcENvbnRleHQsIEJhY2tFbmRNZXNzYWdlLCBCQUNLX0VORF9NRVNTQUdFX0hBTkRMRVJfVE9LRU4sIE5BTUVTUEFDRSB9IGZyb20gXCJAZmFycmlzL2RldmtpdFwiO1xyXG5cclxuZXhwb3J0IGNsYXNzIEJhY2tFbmRNZXNzYWdlVXRpbCB7XHJcbiAgcHVibGljIHN0YXRpYyBoYW5kbGVNZXNzYWdlKG1lc3NhZ2VzOiBvYmplY3RbXSwgaW5qZWN0b3I6IEluamVjdG9yLCBvcHRpb25zPzogYW55KSB7XHJcbiAgICBjb25zdCBuYW1lc3BhY2UgPSBpbmplY3Rvci5nZXQoTkFNRVNQQUNFLCBudWxsKTtcclxuICAgIGNvbnN0IGFwcENvbnRleHQgPSBpbmplY3Rvci5nZXQ8QXBwQ29udGV4dD4oQXBwQ29udGV4dCwgbnVsbCk7XHJcbiAgICBjb25zdCBjb250ZXh0OiBCYWNrRW5kTWVzc2FnZS5JTWVzc2FnZUNvbnRleHQgPSB7XHJcbiAgICAgIG5zOiBuYW1lc3BhY2UsXHJcbiAgICAgIGFwcENvbnRleHRcclxuICAgIH07XHJcbiAgICBjb25zdCBiaXpNZXNzYWdlcyA9IHRoaXMuYnVpbGRCYWNrRW5kTWVzc2FnZXMobWVzc2FnZXMpO1xyXG4gICAgY29uc3QgYmFja0VuZE1lc3NhZ2UgPSBuZXcgQmFja0VuZE1lc3NhZ2UuTWVzc2FnZShiaXpNZXNzYWdlcywgY29udGV4dCk7XHJcbiAgICBjb25zdCBiYWNrRW5kTWVzc2FnZUhhbmRsZXIgPSBpbmplY3Rvci5nZXQ8QmFja0VuZE1lc3NhZ2UuSUJhY2tFbmRNZXNzYWdlSGFuZGxlcj4oQkFDS19FTkRfTUVTU0FHRV9IQU5ETEVSX1RPS0VOLCBudWxsKTtcclxuICAgIGlmIChiYWNrRW5kTWVzc2FnZUhhbmRsZXIpIHtcclxuICAgICAgYmFja0VuZE1lc3NhZ2VIYW5kbGVyLmhhbmRsZShiYWNrRW5kTWVzc2FnZSwgb3B0aW9ucyk7XHJcbiAgICB9XHJcbiAgfVxyXG4gIHB1YmxpYyBzdGF0aWMgaXNCYWNrRW5kTWVzc2FnZUhhbmRsZXJFeGlzdChpbmplY3RvcjogSW5qZWN0b3IpIHtcclxuICAgIGNvbnN0IGJhY2tFbmRNZXNzYWdlSGFuZGxlciA9IGluamVjdG9yLmdldDxCYWNrRW5kTWVzc2FnZS5JQmFja0VuZE1lc3NhZ2VIYW5kbGVyPihCQUNLX0VORF9NRVNTQUdFX0hBTkRMRVJfVE9LRU4sIG51bGwpO1xyXG4gICAgcmV0dXJuIGJhY2tFbmRNZXNzYWdlSGFuZGxlciAmJiB0cnVlIHx8IGZhbHNlO1xyXG4gIH1cclxuICBwdWJsaWMgc3RhdGljIGdldEZvcm1sZXNzTWVzc2FnZXMobWVzc2FnZXM6IEJhY2tFbmRNZXNzYWdlLklCaXpNZXNzYWdlW10pIHtcclxuICAgIGNvbnN0IGJpek1lc3NhZ2VzID0gdGhpcy5idWlsZEJhY2tFbmRNZXNzYWdlcyhtZXNzYWdlcykgfHwgW107XHJcbiAgICByZXR1cm4gYml6TWVzc2FnZXMuZmlsdGVyKChtZXNzYWdlOiBCYWNrRW5kTWVzc2FnZS5JQml6TWVzc2FnZSkgPT4ge1xyXG4gICAgICByZXR1cm4gIW1lc3NhZ2UubG9jYXRpb24gfHwgIW1lc3NhZ2UubG9jYXRpb24uY29sdW1ucyB8fCBtZXNzYWdlLmxvY2F0aW9uLmNvbHVtbnMubGVuZ3RoIDwgMSB8fCAhbWVzc2FnZS5sb2NhdGlvbi5ub2RlQ29kZTtcclxuICAgIH0pO1xyXG4gIH1cclxuICBwdWJsaWMgc3RhdGljIGJ1aWxkQmFja0VuZE1lc3NhZ2VzKG1lc3NhZ2VzOiBvYmplY3RbXSk6IEJhY2tFbmRNZXNzYWdlLklCaXpNZXNzYWdlW10ge1xyXG4gICAgaWYgKCFtZXNzYWdlcyB8fCBtZXNzYWdlcy5sZW5ndGggPCAxIHx8ICFBcnJheS5pc0FycmF5KG1lc3NhZ2VzKSkge1xyXG4gICAgICByZXR1cm4gbnVsbDtcclxuICAgIH1cclxuICAgIGNvbnN0IGJpek1lc3NhZ2VzOiBCYWNrRW5kTWVzc2FnZS5JQml6TWVzc2FnZVtdID0gW107XHJcbiAgICBtZXNzYWdlcy5mb3JFYWNoKChtZXNzYWdlOiBhbnkpID0+IHtcclxuICAgICAgY29uc3QgYml6TWVzc2FnZTogQmFja0VuZE1lc3NhZ2UuSUJpek1lc3NhZ2UgPSB7XHJcbiAgICAgICAgbGV2ZWw6IG1lc3NhZ2UubGV2ZWwsXHJcbiAgICAgICAgbWVzc2FnZTogbWVzc2FnZS5tZXNzYWdlXHJcbiAgICAgIH07XHJcbiAgICAgIGlmIChtZXNzYWdlLmhhc093blByb3BlcnR5KCdsb2NhdGlvbicpICYmIG1lc3NhZ2UubG9jYXRpb24pIHtcclxuICAgICAgICBiaXpNZXNzYWdlLmxvY2F0aW9uID0ge1xyXG4gICAgICAgICAgbm9kZUNvZGU6IG1lc3NhZ2UubG9jYXRpb24ubm9kZUNvZGUsXHJcbiAgICAgICAgICByb3dzOiBtZXNzYWdlLmxvY2F0aW9uLmRhdGFJZHMsXHJcbiAgICAgICAgICBjb2x1bW5zOiBtZXNzYWdlLmxvY2F0aW9uLmNvbHVtbk5hbWVzXHJcbiAgICAgICAgfTtcclxuICAgICAgfVxyXG4gICAgICBiaXpNZXNzYWdlcy5wdXNoKGJpek1lc3NhZ2UpO1xyXG4gICAgfSk7XHJcbiAgICByZXR1cm4gYml6TWVzc2FnZXM7XHJcbiAgfVxyXG59Il19