/**
 * @fileoverview added by tsickle
 * Generated from: lib/session/bef_session_service.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
/*
 * @Author: Witt
 * @Date: 2018-10-11 20:32:02
 * @Last Modified by: Witt
 * @Last Modified time: 2020-03-03 16:46:39
 */
import { Injectable, Injector, InjectFlags } from '@angular/core';
import { HttpClient } from '@angular/common/http';
import { FrameworkSessionService } from '../framework_session_service';
import { BE_SESSION_HANDLING_STRATEGY_TOKEN } from '../tokens';
import { BefSessionHandlingStrategyFactory } from './bef_session_handling_strategy_factory';
import { AppContext } from '@farris/devkit';
class BefSessionService {
    /**
     * 构造函数
     * \@summary
     * 产品部存在new BeSessionService()的场景，injector可能为空，必须要兼容。
     * @param {?} httpClient
     * @param {?} beBaseUri
     * @param {?} frmSessionService
     * @param {?=} injector
     */
    constructor(httpClient, beBaseUri, frmSessionService, injector) {
        this.beBaseUri = beBaseUri;
        this.injector = injector;
        this.handlingStrategy = this.createHandlingStrategy(injector, httpClient, frmSessionService, beBaseUri);
    }
    /**
     * 获取token
     * @return {?}
     */
    get token() {
        return this.handlingStrategy.getFrameworkSessionId();
    }
    /**
     * 获取BeSessionId
     * @return {?}
     */
    getBeSessionId() {
        return this.handlingStrategy.getSessionId();
    }
    /**
     * 设置sessionId
     * @param {?} sessionId sessionId
     * @return {?}
     */
    setBeSessionId(sessionId) {
        this.handlingStrategy.setSessionId(sessionId);
        this.setSessionId(sessionId);
    }
    /**
     * 清空BeSessionId
     * @return {?}
     */
    clearBeSessionId() {
        this.handlingStrategy.clearSessionId();
    }
    /**
     * 扩展请求header
     * @param {?} headers
     * @param {?=} runtimeContext
     * @return {?}
     */
    extendRequestHeaders(headers, runtimeContext) {
        return this.handlingStrategy.extendRequestHeaders(headers, runtimeContext);
    }
    /**
     * 处理响应header
     * @param {?} headers
     * @return {?}
     */
    handleResponseHeaders(headers) {
        return this.handlingStrategy.handleReponseHeaders(headers);
    }
    /**
     * 创建BeSessionId
     * @deprecated
     * 不再提供封装，请自行调用EAPI上的createSession方法。
     * \@summary
     * 1、兼容产品部直接new BeSessionService()，并调用该方法的场景；
     * 2、此场景肯定是BefSeparatedSessionHandlingStrategy.
     * @return {?}
     */
    createBeSession() {
        /** @type {?} */
        const handlingStrategy = (/** @type {?} */ (this.handlingStrategy));
        return handlingStrategy.createSession();
    }
    /**
     * @private
     * @param {?} sessionId
     * @return {?}
     */
    setSessionId(sessionId) {
        /** @type {?} */
        const appContext = this.injector.get(AppContext, null, InjectFlags.Optional);
        if (appContext && sessionId) {
            appContext.params.set('sessionId', sessionId);
        }
    }
    /**
     * 创建BeSession处理策略
     * \@summary session处理策略
     *
     * 1、开发自己实例化BefSessionService，使用老的模式（分开创建session），判断的标准是有没有injector
     *
     * 2、老表单，使用老的模式（兼容老的模式，分开创建session），判断的标准是有`injector`，但`没有注入策略`
     *
     * 3、新表单，使用用户设置的模式（单表单：使用统一session，组合表单：使用分开的session）
     * @private
     * @param {?} injector
     * @param {?} httpClient
     * @param {?} frmSessionService
     * @param {?} beBaseUri
     * @return {?}
     */
    createHandlingStrategy(injector, httpClient, frmSessionService, beBaseUri) {
        /** @type {?} */
        let handlingStrategyName;
        // 开发自己实例化的befSessionService
        if (!injector) {
            handlingStrategyName = 'SeparatedSession';
        }
        else {
            // bef 实例化
            handlingStrategyName = injector.get(BE_SESSION_HANDLING_STRATEGY_TOKEN, null, InjectFlags.Optional);
        }
        // 老表单，兼容老的模式，分开创建session
        if (!handlingStrategyName) {
            handlingStrategyName = 'SeparatedSession';
        }
        /** @type {?} */
        const handlingStrategyFactory = new BefSessionHandlingStrategyFactory();
        return handlingStrategyFactory.create(handlingStrategyName, frmSessionService, beBaseUri, httpClient, injector);
    }
}
BefSessionService.decorators = [
    { type: Injectable }
];
/** @nocollapse */
BefSessionService.ctorParameters = () => [
    { type: HttpClient },
    { type: String },
    { type: FrameworkSessionService },
    { type: Injector }
];
if (false) {
    /** @type {?} */
    BefSessionService.prototype.beBaseUri;
    /**
     * Session处理策略类
     * @type {?}
     * @private
     */
    BefSessionService.prototype.handlingStrategy;
    /**
     * @type {?}
     * @private
     */
    BefSessionService.prototype.injector;
}
export { BefSessionService };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYmVmX3Nlc3Npb25fc2VydmljZS5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BmYXJyaXMvYmVmLyIsInNvdXJjZXMiOlsibGliL3Nlc3Npb24vYmVmX3Nlc3Npb25fc2VydmljZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztBQU9BLE9BQU8sRUFBRSxVQUFVLEVBQUUsUUFBUSxFQUFFLFdBQVcsRUFBVSxNQUFNLGVBQWUsQ0FBQztBQUMxRSxPQUFPLEVBQUUsVUFBVSxFQUFlLE1BQU0sc0JBQXNCLENBQUM7QUFFL0QsT0FBTyxFQUFFLHVCQUF1QixFQUFFLE1BQU0sOEJBQThCLENBQUM7QUFDdkUsT0FBTyxFQUFFLGtDQUFrQyxFQUFFLE1BQU0sV0FBVyxDQUFDO0FBRS9ELE9BQU8sRUFBRSxpQ0FBaUMsRUFBRSxNQUFNLHlDQUF5QyxDQUFDO0FBQzVGLE9BQU8sRUFBRSxVQUFVLEVBQUUsTUFBTSxnQkFBZ0IsQ0FBQztBQUU1QyxNQUNNLGlCQUFpQjs7Ozs7Ozs7OztJQVlyQixZQUNFLFVBQXNCLEVBQUUsU0FBaUIsRUFDekMsaUJBQTBDLEVBQUUsUUFBbUI7UUFFL0QsSUFBSSxDQUFDLFNBQVMsR0FBRyxTQUFTLENBQUM7UUFDM0IsSUFBSSxDQUFDLFFBQVEsR0FBRyxRQUFRLENBQUM7UUFDekIsSUFBSSxDQUFDLGdCQUFnQixHQUFHLElBQUksQ0FBQyxzQkFBc0IsQ0FBQyxRQUFRLEVBQUUsVUFBVSxFQUFFLGlCQUFpQixFQUFFLFNBQVMsQ0FBQyxDQUFDO0lBQzFHLENBQUM7Ozs7O0lBSUQsSUFBVyxLQUFLO1FBQ2QsT0FBTyxJQUFJLENBQUMsZ0JBQWdCLENBQUMscUJBQXFCLEVBQUUsQ0FBQztJQUN2RCxDQUFDOzs7OztJQUtNLGNBQWM7UUFDbkIsT0FBTyxJQUFJLENBQUMsZ0JBQWdCLENBQUMsWUFBWSxFQUFFLENBQUM7SUFDOUMsQ0FBQzs7Ozs7O0lBTU0sY0FBYyxDQUFDLFNBQWlCO1FBQ3JDLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxZQUFZLENBQUMsU0FBUyxDQUFDLENBQUM7UUFDOUMsSUFBSSxDQUFDLFlBQVksQ0FBQyxTQUFTLENBQUMsQ0FBQztJQUMvQixDQUFDOzs7OztJQUtNLGdCQUFnQjtRQUNyQixJQUFJLENBQUMsZ0JBQWdCLENBQUMsY0FBYyxFQUFFLENBQUM7SUFDekMsQ0FBQzs7Ozs7OztJQUtNLG9CQUFvQixDQUFDLE9BQW9CLEVBQUUsY0FBb0I7UUFDcEUsT0FBTyxJQUFJLENBQUMsZ0JBQWdCLENBQUMsb0JBQW9CLENBQUMsT0FBTyxFQUFFLGNBQWMsQ0FBQyxDQUFDO0lBQzdFLENBQUM7Ozs7OztJQUtNLHFCQUFxQixDQUFDLE9BQW9CO1FBQy9DLE9BQU8sSUFBSSxDQUFDLGdCQUFnQixDQUFDLG9CQUFvQixDQUFDLE9BQU8sQ0FBQyxDQUFDO0lBQzdELENBQUM7Ozs7Ozs7Ozs7SUFVTSxlQUFlOztjQUNkLGdCQUFnQixHQUFHLG1CQUFBLElBQUksQ0FBQyxnQkFBZ0IsRUFBdUM7UUFDckYsT0FBTyxnQkFBZ0IsQ0FBQyxhQUFhLEVBQUUsQ0FBQztJQUMxQyxDQUFDOzs7Ozs7SUFDTyxZQUFZLENBQUMsU0FBaUI7O2NBQzlCLFVBQVUsR0FBRyxJQUFJLENBQUMsUUFBUSxDQUFDLEdBQUcsQ0FBYSxVQUFVLEVBQUUsSUFBSSxFQUFFLFdBQVcsQ0FBQyxRQUFRLENBQUM7UUFDeEYsSUFBSSxVQUFVLElBQUksU0FBUyxFQUFFO1lBQzNCLFVBQVUsQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLFdBQVcsRUFBRSxTQUFTLENBQUMsQ0FBQztTQUMvQztJQUNILENBQUM7Ozs7Ozs7Ozs7Ozs7Ozs7O0lBV08sc0JBQXNCLENBQzVCLFFBQWtCLEVBQUUsVUFBc0IsRUFDMUMsaUJBQTBDLEVBQUUsU0FBaUI7O1lBRXpELG9CQUE0QjtRQUNoQyw0QkFBNEI7UUFDNUIsSUFBSSxDQUFDLFFBQVEsRUFBRTtZQUNiLG9CQUFvQixHQUFHLGtCQUFrQixDQUFDO1NBQzNDO2FBQU07WUFDTCxVQUFVO1lBQ1Ysb0JBQW9CLEdBQUcsUUFBUSxDQUFDLEdBQUcsQ0FBUyxrQ0FBa0MsRUFBRSxJQUFJLEVBQUUsV0FBVyxDQUFDLFFBQVEsQ0FBQyxDQUFDO1NBQzdHO1FBQ0QseUJBQXlCO1FBQ3pCLElBQUksQ0FBQyxvQkFBb0IsRUFBRTtZQUN6QixvQkFBb0IsR0FBRyxrQkFBa0IsQ0FBQztTQUMzQzs7Y0FDSyx1QkFBdUIsR0FBRyxJQUFJLGlDQUFpQyxFQUFFO1FBQ3ZFLE9BQU8sdUJBQXVCLENBQUMsTUFBTSxDQUFDLG9CQUFvQixFQUFFLGlCQUFpQixFQUFFLFNBQVMsRUFBRSxVQUFVLEVBQUUsUUFBUSxDQUFDLENBQUM7SUFDbEgsQ0FBQzs7O1lBL0dGLFVBQVU7Ozs7WUFSRixVQUFVOztZQUVWLHVCQUF1QjtZQUhYLFFBQVE7Ozs7SUFXM0Isc0NBQXlCOzs7Ozs7SUFJekIsNkNBQXFEOzs7OztJQUNyRCxxQ0FBMkI7O0FBNEc3QixPQUFPLEVBQUUsaUJBQWlCLEVBQUUsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbIi8qXHJcbiAqIEBBdXRob3I6IFdpdHRcclxuICogQERhdGU6IDIwMTgtMTAtMTEgMjA6MzI6MDJcclxuICogQExhc3QgTW9kaWZpZWQgYnk6IFdpdHRcclxuICogQExhc3QgTW9kaWZpZWQgdGltZTogMjAyMC0wMy0wMyAxNjo0NjozOVxyXG4gKi9cclxuXHJcbmltcG9ydCB7IEluamVjdGFibGUsIEluamVjdG9yLCBJbmplY3RGbGFncywgaW5qZWN0IH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IEh0dHBDbGllbnQsIEh0dHBIZWFkZXJzIH0gZnJvbSAnQGFuZ3VsYXIvY29tbW9uL2h0dHAnO1xyXG5pbXBvcnQgeyBPYnNlcnZhYmxlIH0gZnJvbSAncnhqcyc7XHJcbmltcG9ydCB7IEZyYW1ld29ya1Nlc3Npb25TZXJ2aWNlIH0gZnJvbSAnLi4vZnJhbWV3b3JrX3Nlc3Npb25fc2VydmljZSc7XHJcbmltcG9ydCB7IEJFX1NFU1NJT05fSEFORExJTkdfU1RSQVRFR1lfVE9LRU4gfSBmcm9tICcuLi90b2tlbnMnO1xyXG5pbXBvcnQgeyBCZWZTZXNzaW9uSGFuZGxpbmdTdHJhdGVneSwgQmVmU2VwYXJhdGVkU2Vzc2lvbkhhbmRsaW5nU3RyYXRlZ3kgfSBmcm9tICcuL2JlZl9zZXNzaW9uX2hhbmRsaW5nX3N0cmF0ZWd5JztcclxuaW1wb3J0IHsgQmVmU2Vzc2lvbkhhbmRsaW5nU3RyYXRlZ3lGYWN0b3J5IH0gZnJvbSAnLi9iZWZfc2Vzc2lvbl9oYW5kbGluZ19zdHJhdGVneV9mYWN0b3J5JztcclxuaW1wb3J0IHsgQXBwQ29udGV4dCB9IGZyb20gJ0BmYXJyaXMvZGV2a2l0JztcclxuXHJcbkBJbmplY3RhYmxlKClcclxuY2xhc3MgQmVmU2Vzc2lvblNlcnZpY2Uge1xyXG4gIHB1YmxpYyBiZUJhc2VVcmk6IHN0cmluZztcclxuICAvKipcclxuICAgKiBTZXNzaW9u5aSE55CG562W55Wl57G7XHJcbiAgICovXHJcbiAgcHJpdmF0ZSBoYW5kbGluZ1N0cmF0ZWd5OiBCZWZTZXNzaW9uSGFuZGxpbmdTdHJhdGVneTtcclxuICBwcml2YXRlIGluamVjdG9yOiBJbmplY3RvcjtcclxuICAvKipcclxuICAgKiDmnoTpgKDlh73mlbBcclxuICAgKiBAc3VtbWFyeVxyXG4gICAqIOS6p+WTgemDqOWtmOWcqG5ldyBCZVNlc3Npb25TZXJ2aWNlKCnnmoTlnLrmma/vvIxpbmplY3RvcuWPr+iDveS4uuepuu+8jOW/hemhu+imgeWFvOWuueOAglxyXG4gICAqL1xyXG4gIGNvbnN0cnVjdG9yKFxyXG4gICAgaHR0cENsaWVudDogSHR0cENsaWVudCwgYmVCYXNlVXJpOiBzdHJpbmcsXHJcbiAgICBmcm1TZXNzaW9uU2VydmljZTogRnJhbWV3b3JrU2Vzc2lvblNlcnZpY2UsIGluamVjdG9yPzogSW5qZWN0b3JcclxuICApIHtcclxuICAgIHRoaXMuYmVCYXNlVXJpID0gYmVCYXNlVXJpO1xyXG4gICAgdGhpcy5pbmplY3RvciA9IGluamVjdG9yO1xyXG4gICAgdGhpcy5oYW5kbGluZ1N0cmF0ZWd5ID0gdGhpcy5jcmVhdGVIYW5kbGluZ1N0cmF0ZWd5KGluamVjdG9yLCBodHRwQ2xpZW50LCBmcm1TZXNzaW9uU2VydmljZSwgYmVCYXNlVXJpKTtcclxuICB9XHJcbiAgLyoqXHJcbiAgICog6I635Y+WdG9rZW5cclxuICAgKi9cclxuICBwdWJsaWMgZ2V0IHRva2VuKCkge1xyXG4gICAgcmV0dXJuIHRoaXMuaGFuZGxpbmdTdHJhdGVneS5nZXRGcmFtZXdvcmtTZXNzaW9uSWQoKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOiOt+WPlkJlU2Vzc2lvbklkXHJcbiAgICovXHJcbiAgcHVibGljIGdldEJlU2Vzc2lvbklkKCk6IE9ic2VydmFibGU8c3RyaW5nPiB7XHJcbiAgICByZXR1cm4gdGhpcy5oYW5kbGluZ1N0cmF0ZWd5LmdldFNlc3Npb25JZCgpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog6K6+572uc2Vzc2lvbklkXHJcbiAgICogQHBhcmFtIHNlc3Npb25JZCBzZXNzaW9uSWRcclxuICAgKi9cclxuICBwdWJsaWMgc2V0QmVTZXNzaW9uSWQoc2Vzc2lvbklkOiBzdHJpbmcpIHtcclxuICAgIHRoaXMuaGFuZGxpbmdTdHJhdGVneS5zZXRTZXNzaW9uSWQoc2Vzc2lvbklkKTtcclxuICAgIHRoaXMuc2V0U2Vzc2lvbklkKHNlc3Npb25JZCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDmuIXnqbpCZVNlc3Npb25JZFxyXG4gICAqL1xyXG4gIHB1YmxpYyBjbGVhckJlU2Vzc2lvbklkKCkge1xyXG4gICAgdGhpcy5oYW5kbGluZ1N0cmF0ZWd5LmNsZWFyU2Vzc2lvbklkKCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDmianlsZXor7fmsYJoZWFkZXJcclxuICAgKi9cclxuICBwdWJsaWMgZXh0ZW5kUmVxdWVzdEhlYWRlcnMoaGVhZGVyczogSHR0cEhlYWRlcnMsIHJ1bnRpbWVDb250ZXh0PzogYW55KTogSHR0cEhlYWRlcnMge1xyXG4gICAgcmV0dXJuIHRoaXMuaGFuZGxpbmdTdHJhdGVneS5leHRlbmRSZXF1ZXN0SGVhZGVycyhoZWFkZXJzLCBydW50aW1lQ29udGV4dCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDlpITnkIblk43lupRoZWFkZXJcclxuICAgKi9cclxuICBwdWJsaWMgaGFuZGxlUmVzcG9uc2VIZWFkZXJzKGhlYWRlcnM6IEh0dHBIZWFkZXJzKTogdm9pZCB7XHJcbiAgICByZXR1cm4gdGhpcy5oYW5kbGluZ1N0cmF0ZWd5LmhhbmRsZVJlcG9uc2VIZWFkZXJzKGhlYWRlcnMpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog5Yib5bu6QmVTZXNzaW9uSWRcclxuICAgKiBAZGVwcmVjYXRlZFxyXG4gICAqIOS4jeWGjeaPkOS+m+Wwgeijhe+8jOivt+iHquihjOiwg+eUqEVBUEnkuIrnmoRjcmVhdGVTZXNzaW9u5pa55rOV44CCXHJcbiAgICogQHN1bW1hcnlcclxuICAgKiAx44CB5YW85a655Lqn5ZOB6YOo55u05o6lbmV3IEJlU2Vzc2lvblNlcnZpY2UoKe+8jOW5tuiwg+eUqOivpeaWueazleeahOWcuuaZr++8m1xyXG4gICAqIDLjgIHmraTlnLrmma/ogq/lrprmmK9CZWZTZXBhcmF0ZWRTZXNzaW9uSGFuZGxpbmdTdHJhdGVneS5cclxuICAgKi9cclxuICBwdWJsaWMgY3JlYXRlQmVTZXNzaW9uKCk6IE9ic2VydmFibGU8c3RyaW5nPiB7XHJcbiAgICBjb25zdCBoYW5kbGluZ1N0cmF0ZWd5ID0gdGhpcy5oYW5kbGluZ1N0cmF0ZWd5IGFzIEJlZlNlcGFyYXRlZFNlc3Npb25IYW5kbGluZ1N0cmF0ZWd5O1xyXG4gICAgcmV0dXJuIGhhbmRsaW5nU3RyYXRlZ3kuY3JlYXRlU2Vzc2lvbigpO1xyXG4gIH1cclxuICBwcml2YXRlIHNldFNlc3Npb25JZChzZXNzaW9uSWQ6IHN0cmluZykge1xyXG4gICAgY29uc3QgYXBwQ29udGV4dCA9IHRoaXMuaW5qZWN0b3IuZ2V0PEFwcENvbnRleHQ+KEFwcENvbnRleHQsIG51bGwsIEluamVjdEZsYWdzLk9wdGlvbmFsKTtcclxuICAgIGlmIChhcHBDb250ZXh0ICYmIHNlc3Npb25JZCkge1xyXG4gICAgICBhcHBDb250ZXh0LnBhcmFtcy5zZXQoJ3Nlc3Npb25JZCcsIHNlc3Npb25JZCk7XHJcbiAgICB9XHJcbiAgfVxyXG4gIC8qKlxyXG4gICAqIOWIm+W7ukJlU2Vzc2lvbuWkhOeQhuetlueVpVxyXG4gICAqIEBzdW1tYXJ5IHNlc3Npb27lpITnkIbnrZbnlaVcclxuICAgKlxyXG4gICAqIDHjgIHlvIDlj5Hoh6rlt7Hlrp7kvovljJZCZWZTZXNzaW9uU2VydmljZe+8jOS9v+eUqOiAgeeahOaooeW8j++8iOWIhuW8gOWIm+W7unNlc3Npb27vvInvvIzliKTmlq3nmoTmoIflh4bmmK/mnInmsqHmnIlpbmplY3RvclxyXG4gICAqXHJcbiAgICogMuOAgeiAgeihqOWNle+8jOS9v+eUqOiAgeeahOaooeW8j++8iOWFvOWuueiAgeeahOaooeW8j++8jOWIhuW8gOWIm+W7unNlc3Npb27vvInvvIzliKTmlq3nmoTmoIflh4bmmK/mnIlgaW5qZWN0b3Jg77yM5L2GYOayoeacieazqOWFpeetlueVpWBcclxuICAgKlxyXG4gICAqIDPjgIHmlrDooajljZXvvIzkvb/nlKjnlKjmiLforr7nva7nmoTmqKHlvI/vvIjljZXooajljZXvvJrkvb/nlKjnu5/kuIBzZXNzaW9u77yM57uE5ZCI6KGo5Y2V77ya5L2/55So5YiG5byA55qEc2Vzc2lvbu+8iVxyXG4gICAqL1xyXG4gIHByaXZhdGUgY3JlYXRlSGFuZGxpbmdTdHJhdGVneShcclxuICAgIGluamVjdG9yOiBJbmplY3RvciwgaHR0cENsaWVudDogSHR0cENsaWVudCxcclxuICAgIGZybVNlc3Npb25TZXJ2aWNlOiBGcmFtZXdvcmtTZXNzaW9uU2VydmljZSwgYmVCYXNlVXJpOiBzdHJpbmdcclxuICApOiBCZWZTZXNzaW9uSGFuZGxpbmdTdHJhdGVneSB7XHJcbiAgICBsZXQgaGFuZGxpbmdTdHJhdGVneU5hbWU6IHN0cmluZztcclxuICAgIC8vIOW8gOWPkeiHquW3seWunuS+i+WMlueahGJlZlNlc3Npb25TZXJ2aWNlXHJcbiAgICBpZiAoIWluamVjdG9yKSB7XHJcbiAgICAgIGhhbmRsaW5nU3RyYXRlZ3lOYW1lID0gJ1NlcGFyYXRlZFNlc3Npb24nO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgLy8gYmVmIOWunuS+i+WMllxyXG4gICAgICBoYW5kbGluZ1N0cmF0ZWd5TmFtZSA9IGluamVjdG9yLmdldDxzdHJpbmc+KEJFX1NFU1NJT05fSEFORExJTkdfU1RSQVRFR1lfVE9LRU4sIG51bGwsIEluamVjdEZsYWdzLk9wdGlvbmFsKTtcclxuICAgIH1cclxuICAgIC8vIOiAgeihqOWNle+8jOWFvOWuueiAgeeahOaooeW8j++8jOWIhuW8gOWIm+W7unNlc3Npb25cclxuICAgIGlmICghaGFuZGxpbmdTdHJhdGVneU5hbWUpIHtcclxuICAgICAgaGFuZGxpbmdTdHJhdGVneU5hbWUgPSAnU2VwYXJhdGVkU2Vzc2lvbic7XHJcbiAgICB9XHJcbiAgICBjb25zdCBoYW5kbGluZ1N0cmF0ZWd5RmFjdG9yeSA9IG5ldyBCZWZTZXNzaW9uSGFuZGxpbmdTdHJhdGVneUZhY3RvcnkoKTtcclxuICAgIHJldHVybiBoYW5kbGluZ1N0cmF0ZWd5RmFjdG9yeS5jcmVhdGUoaGFuZGxpbmdTdHJhdGVneU5hbWUsIGZybVNlc3Npb25TZXJ2aWNlLCBiZUJhc2VVcmksIGh0dHBDbGllbnQsIGluamVjdG9yKTtcclxuICB9XHJcbn1cclxuXHJcblxyXG5leHBvcnQgeyBCZWZTZXNzaW9uU2VydmljZSB9O1xyXG4iXX0=