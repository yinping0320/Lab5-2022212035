/**
 * @fileoverview added by tsickle
 * Generated from: lib/deprecated/deprecated_bef_repository.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
/*
 * @Author: Sagi, Lucas, Witt
 * @Date: 2018-10-11 17:34:26
 * @Last Modified by: aalizzwell
 * @Last Modified time: 2019-06-29 11:39:02
 */
// tslint:disable: max-line-length
import { Injectable } from '@angular/core';
import { of } from 'rxjs';
import { Repository } from '@farris/devkit';
/**
 * 适配老的API，保持兼容
 * @abstract
 * @template T
 */
class DeprecatedBefRepository extends Repository {
    // #endregion
    /**
     * 构造函数
     */
    constructor() {
        super();
    }
    // #region 老的属性包装成get方法进行兼容
    /**
     * 取数服务
     * @return {?}
     */
    get restService() {
        return this.dataService.restService;
    }
    /**
     * 实体变更（前端）=> BE变更（后端）
     * @return {?}
     */
    get changeBuilder() {
        return this.entityManager.changeBuilder;
    }
    /**
     * BE变更（后端）=> 实体变更（前端）
     * @return {?}
     */
    get changeHandler() {
        return this.entityManager.changeHandler;
    }
    // #region 数据访问
    /**
     * 获取实体集合
     * @return {?}
     */
    getList() {
        return this.dataService.getList(null, null, null, null);
    }
    /**
     * 获取单个实体
     * @param {?} id 主实体id
     * @return {?}
     */
    getById(id) {
        return this.dataService.getById(id);
    }
    /**
     * 根据id更新实体
     * @param {?} id 实体id
     * @return {?}
     */
    updateById(id) {
        return this.dataService.updateById(id);
    }
    /**
     * 创建新实体，并加载
     * @param {?=} defaultValue
     * @return {?}
     */
    create(defaultValue) {
        return this.dataService.create(defaultValue);
    }
    /**
     * 追加实体
     * @param {?=} defaultValue
     * @return {?}
     */
    append(defaultValue) {
        return this.dataService.append(defaultValue);
    }
    /**
     * 创建子实体，并追加
     * @param {?} fpath 父路径，格式形如：/1/edus（从表）或/1/edus/2/grades（从从表）
     * @return {?}
     */
    appendByPath(fpath) {
        return this.dataService.appendByPath(fpath);
    }
    /**
     * 根据id删除实体
     * @param {?} id 内码
     * @param {?=} ifSave
     * @return {?}
     */
    removeById(id, ifSave) {
        return this.dataService.removeById(id, ifSave);
    }
    /**
     * 批量删除
     * @param {?} ids
     * @param {?=} ifSave 是否保存
     * @return {?}
     */
    removeByIds(ids, ifSave) {
        return this.dataService.removeByIds(ids, ifSave);
    }
    /**
     * 删除子级
     * @param {?} fpath
     * @param {?} id   内码
     * @return {?}
     */
    removeByPath(fpath, id) {
        return this.dataService.removeByPath(fpath, id);
    }
    /**
     * 将id对应的实体的变更提交的服务器端
     * @param {?} id
     * @return {?}
     */
    updateChangesById(id) {
        return this.dataService.updateChangesById(id);
    }
    /**
     * 提交path对应实体的变更
     * @param {?} path
     * @param {?} id
     * @return {?}
     */
    updateChangesByPath(path, id) {
        throw new Error('Not Implement');
    }
    /**
     * 提交所有变更
     * @return {?}
     */
    updateAllChanges() {
        return this.dataService.updateAllChanges();
    }
    /**
     * 应用变更
     * @return {?}
     */
    applyChanges() {
        return this.dataService.applyChanges();
    }
    /**
     * 提交数据变更和变量变更，通过retrieve模拟
     * \@internal
     * @return {?}
     */
    updateDataAndVariableChanges() {
        /** @type {?} */
        const filterConditions = [];
        /** @type {?} */
        const sortConditions = [];
        /** @type {?} */
        const entityFilter = {
            FilterConditions: filterConditions,
            SortConditions: sortConditions,
            IsUsePagination: true,
            Pagination: {
                PageIndex: 1,
                PageSize: 1,
                PageCount: 0,
                TotalCount: 0
            }
        };
        /** @type {?} */
        const entityFilterJson = JSON.stringify(entityFilter);
        /** @type {?} */
        const requestInfo = this.restService.buildRequestInfo();
        // 没有变更时不再提交变更
        if (this.isEmptyRequestInfo(requestInfo)) {
            return of(null);
        }
        /** @type {?} */
        const url = `${this.restService.baseUri}/extension/query?entityFilter=${entityFilterJson}`;
        /** @type {?} */
        const body = requestInfo;
        /** @type {?} */
        const options = {
            body
        };
        return this.restService.invoke(url, 'PUT', null, options, false, true, true);
    }
    /**
     * 应用id对应数据的变更
     * @param {?} id
     * @return {?}
     */
    applyChangesById(id) {
        return this.dataService.applyChangesById(id);
    }
    /**
     * 取消变更
     * @param {?=} options
     * @return {?}
     */
    cancelChanges(options) {
        return this.dataService.cancelChanges(options);
    }
    // #endregion
    // #region 数据变更集处理
    /**
     * 清空所有本地实体的变更集
     * @return {?}
     */
    clearAllEntityChanges() {
        return this.entityManager.clearAllEntityChanges();
    }
    /**
     * 获取数据变更
     * @return {?}
     */
    getDataChangeDetails() {
        return this.entityManager.buildAllEntityChangeDetails();
    }
    /**
     * 处理数据变更
     * @param {?} changeDetails
     * @return {?}
     */
    handleDataChangeDetails(changeDetails) {
        return this.entityManager.handleDataChangeDetails(changeDetails);
    }
    // #endregion
    // #region 变量变更集处理
    /**
     * 获取变量变更
     * @return {?}
     */
    getVariableChangeDetail() {
        return this.variableManager.buildChangeDetail();
    }
    /**
     * 处理变量变更
     * @param {?} changeDetail
     * @return {?}
     */
    handleVariableChangeDetail(changeDetail) {
        this.variableManager.handleChangeDetail(changeDetail);
    }
    // #endregion
    /**
     * 变更集是否为空
     * @private
     * @param {?} requestInfo requestInfo
     * @return {?}
     */
    isEmptyRequestInfo(requestInfo) {
        if (!requestInfo) {
            return true;
        }
        if ((!requestInfo.dataChange || requestInfo.dataChange.length < 1) && (!requestInfo.variableChange || Object.keys(requestInfo.variableChange).length < 1)) {
            return true;
        }
        return false;
    }
}
DeprecatedBefRepository.decorators = [
    { type: Injectable }
];
/** @nocollapse */
DeprecatedBefRepository.ctorParameters = () => [];
if (false) {
    /**
     * 实体管理器
     * \@internal
     * @type {?}
     */
    DeprecatedBefRepository.prototype.entityManager;
    /**
     * 变量管理器
     * \@internal
     * @type {?}
     */
    DeprecatedBefRepository.prototype.variableManager;
    /**
     * 取数服务
     * \@internal
     * @type {?}
     * @protected
     */
    DeprecatedBefRepository.prototype.dataService;
}
export { DeprecatedBefRepository };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGVwcmVjYXRlZF9iZWZfcmVwb3NpdG9yeS5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BmYXJyaXMvYmVmLyIsInNvdXJjZXMiOlsibGliL2RlcHJlY2F0ZWQvZGVwcmVjYXRlZF9iZWZfcmVwb3NpdG9yeS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7QUFPQSxPQUFPLEVBQUUsVUFBVSxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBQzNDLE9BQU8sRUFBYyxFQUFFLEVBQUUsTUFBTSxNQUFNLENBQUM7QUFFdEMsT0FBTyxFQUFVLFVBQVUsRUFBRSxNQUFNLGdCQUFnQixDQUFDOzs7Ozs7QUFlcEQsTUFDZSx1QkFBMEMsU0FBUSxVQUFhOzs7OztJQWtENUU7UUFDRSxLQUFLLEVBQUUsQ0FBQztJQUNWLENBQUM7Ozs7OztJQTFCRCxJQUFXLFdBQVc7UUFDcEIsT0FBTyxJQUFJLENBQUMsV0FBVyxDQUFDLFdBQVcsQ0FBQztJQUN0QyxDQUFDOzs7OztJQUtELElBQVcsYUFBYTtRQUN0QixPQUFPLElBQUksQ0FBQyxhQUFhLENBQUMsYUFBYSxDQUFDO0lBQzFDLENBQUM7Ozs7O0lBS0QsSUFBVyxhQUFhO1FBQ3RCLE9BQU8sSUFBSSxDQUFDLGFBQWEsQ0FBQyxhQUFhLENBQUM7SUFDMUMsQ0FBQzs7Ozs7O0lBaUJNLE9BQU87UUFDWixPQUFPLElBQUksQ0FBQyxXQUFXLENBQUMsT0FBTyxDQUFDLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUksQ0FBQyxDQUFDO0lBQzFELENBQUM7Ozs7OztJQU1NLE9BQU8sQ0FBQyxFQUFVO1FBQ3ZCLE9BQU8sSUFBSSxDQUFDLFdBQVcsQ0FBQyxPQUFPLENBQUMsRUFBRSxDQUFDLENBQUM7SUFDdEMsQ0FBQzs7Ozs7O0lBTU0sVUFBVSxDQUFDLEVBQVU7UUFDMUIsT0FBTyxJQUFJLENBQUMsV0FBVyxDQUFDLFVBQVUsQ0FBQyxFQUFFLENBQUMsQ0FBQztJQUN6QyxDQUFDOzs7Ozs7SUFLTSxNQUFN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QEF1dGhvcjogU2FnaSwgTHVjYXMsIFdpdHRcclxuICogQERhdGU6IDIwMTgtMTAtMTEgMTc6MzQ6MjZcclxuICogQExhc3QgTW9kaWZpZWQgYnk6IGFhbGl6endlbGxcclxuICogQExhc3QgTW9kaWZpZWQgdGltZTogMjAxOS0wNi0yOSAxMTozOTowMlxyXG4gKi9cclxuLy8gdHNsaW50OmRpc2FibGU6IG1heC1saW5lLWxlbmd0aFxyXG5pbXBvcnQgeyBJbmplY3RhYmxlIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IE9ic2VydmFibGUsIG9mIH0gZnJvbSAncnhqcyc7XHJcblxyXG5pbXBvcnQgeyBFbnRpdHksIFJlcG9zaXRvcnkgfSBmcm9tICdAZmFycmlzL2RldmtpdCc7XHJcblxyXG5pbXBvcnQgeyBDaGFuZ2VEZXRhaWwsIFJlcXVlc3RJbmZvIH0gZnJvbSAnLi4vdHlwZXMnO1xyXG5cclxuaW1wb3J0IHsgQmVmUmVzdFNlcnZpY2UgfSBmcm9tICcuLi9iZWZfcmVzdF9zZXJ2aWNlJztcclxuaW1wb3J0IHsgQmVmQ2hhbmdlQnVpbGRlciB9IGZyb20gJy4uL2JlZl9jaGFuZ2VfYnVpbGRlcic7XHJcbmltcG9ydCB7IEJlZkNoYW5nZUhhbmRsZXIgfSBmcm9tICcuLi9iZWZfY2hhbmdlX2hhbmRsZXInO1xyXG5cclxuaW1wb3J0IHsgQmVmRW50aXR5TWFuYWdlciB9IGZyb20gJy4uL2JlZl9lbnRpdHlfbWFuYWdlcic7XHJcbmltcG9ydCB7IEJlZlZhcmlhYmxlTWFuYWdlciB9IGZyb20gJy4uL2JlZl92YXJpYWJsZV9tYW5hZ2VyJztcclxuaW1wb3J0IHsgQmVmRGF0YVNlcnZpY2UgfSBmcm9tICcuLi9iZWZfZGF0YV9zZXJ2aWNlJztcclxuXHJcbi8qKlxyXG4gKiDpgILphY3ogIHnmoRBUEnvvIzkv53mjIHlhbzlrrlcclxuICovXHJcbkBJbmplY3RhYmxlKClcclxuYWJzdHJhY3QgY2xhc3MgRGVwcmVjYXRlZEJlZlJlcG9zaXRvcnk8VCBleHRlbmRzIEVudGl0eT4gZXh0ZW5kcyBSZXBvc2l0b3J5PFQ+IHtcclxuXHJcbiAgLyoqXHJcbiAgICog5a6e5L2T566h55CG5ZmoXHJcbiAgICogQGludGVybmFsXHJcbiAgICovXHJcbiAgcHVibGljIGVudGl0eU1hbmFnZXI6IEJlZkVudGl0eU1hbmFnZXI8VD47XHJcblxyXG4gIC8qKlxyXG4gICAqIOWPmOmHj+euoeeQhuWZqFxyXG4gICAqIEBpbnRlcm5hbFxyXG4gICAqL1xyXG4gIHB1YmxpYyB2YXJpYWJsZU1hbmFnZXI6IEJlZlZhcmlhYmxlTWFuYWdlcjtcclxuXHJcbiAgLyoqXHJcbiAgICog5Y+W5pWw5pyN5YqhXHJcbiAgICogQGludGVybmFsXHJcbiAgICovXHJcbiAgcHJvdGVjdGVkIGRhdGFTZXJ2aWNlOiBCZWZEYXRhU2VydmljZTxUPjtcclxuXHJcblxyXG4gIC8vICNyZWdpb24g6ICB55qE5bGe5oCn5YyF6KOF5oiQZ2V05pa55rOV6L+b6KGM5YW85a65XHJcblxyXG4gIC8qKlxyXG4gICAqIOWPluaVsOacjeWKoVxyXG4gICAqL1xyXG4gIHB1YmxpYyBnZXQgcmVzdFNlcnZpY2UoKTogQmVmUmVzdFNlcnZpY2Uge1xyXG4gICAgcmV0dXJuIHRoaXMuZGF0YVNlcnZpY2UucmVzdFNlcnZpY2U7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDlrp7kvZPlj5jmm7TvvIjliY3nq6/vvIk9PiBCReWPmOabtO+8iOWQjuerr++8iVxyXG4gICAqL1xyXG4gIHB1YmxpYyBnZXQgY2hhbmdlQnVpbGRlcigpOiBCZWZDaGFuZ2VCdWlsZGVyIHtcclxuICAgIHJldHVybiB0aGlzLmVudGl0eU1hbmFnZXIuY2hhbmdlQnVpbGRlcjtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEJF5Y+Y5pu077yI5ZCO56uv77yJPT4g5a6e5L2T5Y+Y5pu077yI5YmN56uv77yJXHJcbiAgICovXHJcbiAgcHVibGljIGdldCBjaGFuZ2VIYW5kbGVyKCk6IEJlZkNoYW5nZUhhbmRsZXIge1xyXG4gICAgcmV0dXJuIHRoaXMuZW50aXR5TWFuYWdlci5jaGFuZ2VIYW5kbGVyO1xyXG4gIH1cclxuXHJcbiAgLy8gI2VuZHJlZ2lvblxyXG5cclxuXHJcbiAgLyoqXHJcbiAgKiDmnoTpgKDlh73mlbBcclxuICAqL1xyXG4gIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgc3VwZXIoKTtcclxuICB9XHJcblxyXG4gIC8vICNyZWdpb24g5pWw5o2u6K6/6ZeuXHJcblxyXG4gIC8qKlxyXG4gICog6I635Y+W5a6e5L2T6ZuG5ZCIXHJcbiAgKi9cclxuICBwdWJsaWMgZ2V0TGlzdCgpOiBPYnNlcnZhYmxlPFRbXT4ge1xyXG4gICAgcmV0dXJuIHRoaXMuZGF0YVNlcnZpY2UuZ2V0TGlzdChudWxsLCBudWxsLCBudWxsLCBudWxsKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOiOt+WPluWNleS4quWunuS9k1xyXG4gICAqIEBwYXJhbSBpZCDkuLvlrp7kvZNpZFxyXG4gICAqL1xyXG4gIHB1YmxpYyBnZXRCeUlkKGlkOiBzdHJpbmcpOiBPYnNlcnZhYmxlPFQ+IHtcclxuICAgIHJldHVybiB0aGlzLmRhdGFTZXJ2aWNlLmdldEJ5SWQoaWQpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog5qC55o2uaWTmm7TmlrDlrp7kvZNcclxuICAgKiBAcGFyYW0gaWQg5a6e5L2TaWRcclxuICAgKi9cclxuICBwdWJsaWMgdXBkYXRlQnlJZChpZDogc3RyaW5nKTogT2JzZXJ2YWJsZTxUPiB7XHJcbiAgICByZXR1cm4gdGhpcy5kYXRhU2VydmljZS51cGRhdGVCeUlkKGlkKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOWIm+W7uuaWsOWunuS9k++8jOW5tuWKoOi9vVxyXG4gICAqL1xyXG4gIHB1YmxpYyBjcmVhdGUoZGVmYXVsdFZhbHVlPzogYW55KTogT2JzZXJ2YWJsZTxhbnk+IHtcclxuICAgIHJldHVybiB0aGlzLmRhdGFTZXJ2aWNlLmNyZWF0ZShkZWZhdWx0VmFsdWUpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog6L+95Yqg5a6e5L2TXHJcbiAgICovXHJcbiAgcHVibGljIGFwcGVuZChkZWZhdWx0VmFsdWU/OiBhbnkpOiBPYnNlcnZhYmxlPFQ+IHtcclxuICAgIHJldHVybiB0aGlzLmRhdGFTZXJ2aWNlLmFwcGVuZChkZWZhdWx0VmFsdWUpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog5Yib5bu65a2Q5a6e5L2T77yM5bm26L+95YqgXHJcbiAgICogQHBhcmFtIGZwYXRoIOeItui3r+W+hO+8jOagvOW8j+W9ouWmgu+8mi8xL2VkdXPvvIjku47ooajvvInmiJYvMS9lZHVzLzIvZ3JhZGVz77yI5LuO5LuO6KGo77yJXHJcbiAgICovXHJcbiAgcHVibGljIGFwcGVuZEJ5UGF0aChmcGF0aDogc3RyaW5nKTogT2JzZXJ2YWJsZTxhbnk+IHtcclxuICAgIHJldHVybiB0aGlzLmRhdGFTZXJ2aWNlLmFwcGVuZEJ5UGF0aChmcGF0aCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDmoLnmja5pZOWIoOmZpOWunuS9k1xyXG4gICAqIEBwYXJhbSBpZCDlhoXnoIFcclxuICAgKi9cclxuICBwdWJsaWMgcmVtb3ZlQnlJZChpZDogc3RyaW5nLCBpZlNhdmU/OiBib29sZWFuKTogT2JzZXJ2YWJsZTxib29sZWFuPiB7XHJcbiAgICByZXR1cm4gdGhpcy5kYXRhU2VydmljZS5yZW1vdmVCeUlkKGlkLCBpZlNhdmUpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog5om56YeP5Yig6ZmkXHJcbiAgICogQHBhcmFtIGlkIOWGheeggVxyXG4gICAqIEBwYXJhbSBpZlNhdmUg5piv5ZCm5L+d5a2YXHJcbiAgICovXHJcbiAgcHVibGljIHJlbW92ZUJ5SWRzKGlkczogc3RyaW5nW10sIGlmU2F2ZT86IGJvb2xlYW4pOiBPYnNlcnZhYmxlPGFueT4ge1xyXG4gICAgcmV0dXJuIHRoaXMuZGF0YVNlcnZpY2UucmVtb3ZlQnlJZHMoaWRzLCBpZlNhdmUpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog5Yig6Zmk5a2Q57qnXHJcbiAgICogQHBhcmFtIHBhdGgg6Lev5b6EXHJcbiAgICogQHBhcmFtIGlkICAg5YaF56CBXHJcbiAgICovXHJcbiAgcHVibGljIHJlbW92ZUJ5UGF0aChmcGF0aDogc3RyaW5nLCBpZDogc3RyaW5nKTogT2JzZXJ2YWJsZTxib29sZWFuPiB7XHJcbiAgICByZXR1cm4gdGhpcy5kYXRhU2VydmljZS5yZW1vdmVCeVBhdGgoZnBhdGgsIGlkKTtcclxuICB9XHJcbiAgLyoqXHJcbiAgICog5bCGaWTlr7nlupTnmoTlrp7kvZPnmoTlj5jmm7Tmj5DkuqTnmoTmnI3liqHlmajnq69cclxuICAgKi9cclxuICBwdWJsaWMgdXBkYXRlQ2hhbmdlc0J5SWQoaWQ6IHN0cmluZyk6IE9ic2VydmFibGU8Ym9vbGVhbj4ge1xyXG4gICAgcmV0dXJuIHRoaXMuZGF0YVNlcnZpY2UudXBkYXRlQ2hhbmdlc0J5SWQoaWQpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog5o+Q5LqkcGF0aOWvueW6lOWunuS9k+eahOWPmOabtFxyXG4gICAqL1xyXG4gIHB1YmxpYyB1cGRhdGVDaGFuZ2VzQnlQYXRoKHBhdGg6IHN0cmluZywgaWQ6IHN0cmluZyk6IE9ic2VydmFibGU8YW55PiB7XHJcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ05vdCBJbXBsZW1lbnQnKTtcclxuICB9XHJcbiAgLyoqXHJcbiAgICog5o+Q5Lqk5omA5pyJ5Y+Y5pu0XHJcbiAgICovXHJcbiAgcHVibGljIHVwZGF0ZUFsbENoYW5nZXMoKTogT2JzZXJ2YWJsZTxib29sZWFuPiB7XHJcbiAgICByZXR1cm4gdGhpcy5kYXRhU2VydmljZS51cGRhdGVBbGxDaGFuZ2VzKCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDlupTnlKjlj5jmm7RcclxuICAgKi9cclxuICBwdWJsaWMgYXBwbHlDaGFuZ2VzKCk6IE9ic2VydmFibGU8Ym9vbGVhbj4ge1xyXG4gICAgcmV0dXJuIHRoaXMuZGF0YVNlcnZpY2UuYXBwbHlDaGFuZ2VzKCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDmj5DkuqTmlbDmja7lj5jmm7Tlkozlj5jph4/lj5jmm7TvvIzpgJrov4dyZXRyaWV2ZeaooeaLn1xyXG4gICAqIEBpbnRlcm5hbFxyXG4gICAqL1xyXG4gIHB1YmxpYyB1cGRhdGVEYXRhQW5kVmFyaWFibGVDaGFuZ2VzKCk6IE9ic2VydmFibGU8YW55PiB7XHJcbiAgICBjb25zdCBmaWx0ZXJDb25kaXRpb25zOiBhbnlbXSA9IFtdO1xyXG4gICAgY29uc3Qgc29ydENvbmRpdGlvbnM6IGFueVtdID0gW107XHJcbiAgICBjb25zdCBlbnRpdHlGaWx0ZXIgPSB7XHJcbiAgICAgIEZpbHRlckNvbmRpdGlvbnM6IGZpbHRlckNvbmRpdGlvbnMsXHJcbiAgICAgIFNvcnRDb25kaXRpb25zOiBzb3J0Q29uZGl0aW9ucyxcclxuICAgICAgSXNVc2VQYWdpbmF0aW9uOiB0cnVlLFxyXG4gICAgICBQYWdpbmF0aW9uOiB7XHJcbiAgICAgICAgUGFnZUluZGV4OiAxLFxyXG4gICAgICAgIFBhZ2VTaXplOiAxLFxyXG4gICAgICAgIFBhZ2VDb3VudDogMCxcclxuICAgICAgICBUb3RhbENvdW50OiAwXHJcbiAgICAgIH1cclxuICAgIH07XHJcbiAgICBjb25zdCBlbnRpdHlGaWx0ZXJKc29uID0gSlNPTi5zdHJpbmdpZnkoZW50aXR5RmlsdGVyKTtcclxuICAgIGNvbnN0IHJlcXVlc3RJbmZvID0gdGhpcy5yZXN0U2VydmljZS5idWlsZFJlcXVlc3RJbmZvKCk7XHJcbiAgICAvLyDmsqHmnInlj5jmm7Tml7bkuI3lho3mj5DkuqTlj5jmm7RcclxuICAgIGlmICh0aGlzLmlzRW1wdHlSZXF1ZXN0SW5mbyhyZXF1ZXN0SW5mbykpIHtcclxuICAgICAgcmV0dXJuIG9mKG51bGwpO1xyXG4gICAgfVxyXG4gICAgY29uc3QgdXJsID0gYCR7dGhpcy5yZXN0U2VydmljZS5iYXNlVXJpfS9leHRlbnNpb24vcXVlcnk/ZW50aXR5RmlsdGVyPSR7ZW50aXR5RmlsdGVySnNvbn1gO1xyXG4gICAgY29uc3QgYm9keSA9IHJlcXVlc3RJbmZvO1xyXG4gICAgY29uc3Qgb3B0aW9ucyA9IHtcclxuICAgICAgYm9keVxyXG4gICAgfTtcclxuICAgIHJldHVybiB0aGlzLnJlc3RTZXJ2aWNlLmludm9rZSh1cmwsICdQVVQnLCBudWxsLCBvcHRpb25zLCBmYWxzZSwgdHJ1ZSwgdHJ1ZSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDlupTnlKhpZOWvueW6lOaVsOaNrueahOWPmOabtFxyXG4gICAqL1xyXG4gIHB1YmxpYyBhcHBseUNoYW5nZXNCeUlkKGlkOiBzdHJpbmcpOiBPYnNlcnZhYmxlPGJvb2xlYW4+IHtcclxuICAgIHJldHVybiB0aGlzLmRhdGFTZXJ2aWNlLmFwcGx5Q2hhbmdlc0J5SWQoaWQpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog5Y+W5raI5Y+Y5pu0XHJcbiAgICovXHJcbiAgcHVibGljIGNhbmNlbENoYW5nZXMob3B0aW9ucz86IGFueSk6IE9ic2VydmFibGU8Ym9vbGVhbj4ge1xyXG4gICAgcmV0dXJuIHRoaXMuZGF0YVNlcnZpY2UuY2FuY2VsQ2hhbmdlcyhvcHRpb25zKTtcclxuICB9XHJcblxyXG4gIC8vICNlbmRyZWdpb25cclxuXHJcblxyXG4gIC8vICNyZWdpb24g5pWw5o2u5Y+Y5pu06ZuG5aSE55CGXHJcblxyXG4gIC8qKlxyXG4gICAqIOa4heepuuaJgOacieacrOWcsOWunuS9k+eahOWPmOabtOmbhlxyXG4gICAqL1xyXG4gIHB1YmxpYyBjbGVhckFsbEVudGl0eUNoYW5nZXMoKTogdm9pZCB7XHJcbiAgICByZXR1cm4gdGhpcy5lbnRpdHlNYW5hZ2VyLmNsZWFyQWxsRW50aXR5Q2hhbmdlcygpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog6I635Y+W5pWw5o2u5Y+Y5pu0XHJcbiAgICovXHJcbiAgcHVibGljIGdldERhdGFDaGFuZ2VEZXRhaWxzKCk6IENoYW5nZURldGFpbFtdIHtcclxuICAgIHJldHVybiB0aGlzLmVudGl0eU1hbmFnZXIuYnVpbGRBbGxFbnRpdHlDaGFuZ2VEZXRhaWxzKCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDlpITnkIbmlbDmja7lj5jmm7RcclxuICAgKi9cclxuICBwdWJsaWMgaGFuZGxlRGF0YUNoYW5nZURldGFpbHMoY2hhbmdlRGV0YWlsczogQ2hhbmdlRGV0YWlsW10pOiB2b2lkIHtcclxuICAgIHJldHVybiB0aGlzLmVudGl0eU1hbmFnZXIuaGFuZGxlRGF0YUNoYW5nZURldGFpbHMoY2hhbmdlRGV0YWlscyk7XHJcbiAgfVxyXG5cclxuICAvLyAjZW5kcmVnaW9uXHJcblxyXG5cclxuICAvLyAjcmVnaW9uIOWPmOmHj+WPmOabtOmbhuWkhOeQhlxyXG5cclxuICAvKipcclxuICAgKiDojrflj5blj5jph4/lj5jmm7RcclxuICAgKi9cclxuICBwdWJsaWMgZ2V0VmFyaWFibGVDaGFuZ2VEZXRhaWwoKTogQ2hhbmdlRGV0YWlsIHtcclxuICAgIHJldHVybiB0aGlzLnZhcmlhYmxlTWFuYWdlci5idWlsZENoYW5nZURldGFpbCgpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog5aSE55CG5Y+Y6YeP5Y+Y5pu0XHJcbiAgICovXHJcbiAgcHVibGljIGhhbmRsZVZhcmlhYmxlQ2hhbmdlRGV0YWlsKGNoYW5nZURldGFpbDogQ2hhbmdlRGV0YWlsKSB7XHJcbiAgICB0aGlzLnZhcmlhYmxlTWFuYWdlci5oYW5kbGVDaGFuZ2VEZXRhaWwoY2hhbmdlRGV0YWlsKTtcclxuICB9XHJcblxyXG4gIC8vICNlbmRyZWdpb25cclxuICAvKipcclxuICAgKiDlj5jmm7Tpm4bmmK/lkKbkuLrnqbpcclxuICAgKiBAcGFyYW0gcmVxdWVzdEluZm8gcmVxdWVzdEluZm9cclxuICAgKi9cclxuICBwcml2YXRlIGlzRW1wdHlSZXF1ZXN0SW5mbyhyZXF1ZXN0SW5mbzogUmVxdWVzdEluZm8pIHtcclxuICAgIGlmICghcmVxdWVzdEluZm8pIHtcclxuICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9XHJcbiAgICBpZiAoKCFyZXF1ZXN0SW5mby5kYXRhQ2hhbmdlIHx8IHJlcXVlc3RJbmZvLmRhdGFDaGFuZ2UubGVuZ3RoIDwgMSkgJiYgKCFyZXF1ZXN0SW5mby52YXJpYWJsZUNoYW5nZSB8fCBPYmplY3Qua2V5cyhyZXF1ZXN0SW5mby52YXJpYWJsZUNoYW5nZSkubGVuZ3RoIDwgMSkpIHtcclxuICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gZmFsc2U7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgeyBEZXByZWNhdGVkQmVmUmVwb3NpdG9yeSB9O1xyXG4iXX0=