/**
 * @fileoverview added by tsickle
 * Generated from: lib/exception-services/exception.servcie.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { HttpUtil, HttpStatusType } from './http';
/**
 * 实体操作服务
 */
var /**
 * 实体操作服务
 */
ExceptionService = /** @class */ (function () {
    /**
     * 构造函数
     */
    function ExceptionService(notifyService, jsBridgeService) {
        this.notifyService = notifyService;
        this.jsBridgeService = jsBridgeService;
    }
    /**
     * 显示异常信息
     */
    /**
     * 显示异常信息
     * @param {?} error
     * @return {?}
     */
    ExceptionService.prototype.show = /**
     * 显示异常信息
     * @param {?} error
     * @return {?}
     */
    function (error) {
        this.exception(error);
    };
    /**
   * 异常处理路由方法
   */
    /**
     * 异常处理路由方法
     * @private
     * @param {?} error
     * @return {?}
     */
    ExceptionService.prototype.exception = /**
     * 异常处理路由方法
     * @private
     * @param {?} error
     * @return {?}
     */
    function (error) {
        var _this = this;
        // 针对session失效做特殊处理
        if (error.message && error.message.indexOf('401') !== -1) {
            this.notifyService.error('登录信息已失效请重新打开');
            setTimeout((/**
             * @return {?}
             */
            function () { _this.jsBridgeService.closeWindow(); }), 2000);
            return;
        }
        if (error && error.response) {
            this.httpErrorHandler(error.response);
        }
    };
    /**
   * http请求异常处理器
   */
    /**
     * http请求异常处理器
     * @private
     * @param {?} httpError
     * @return {?}
     */
    ExceptionService.prototype.httpErrorHandler = /**
     * http请求异常处理器
     * @private
     * @param {?} httpError
     * @return {?}
     */
    function (httpError) {
        if (!httpError) {
            return;
        }
        /** @type {?} */
        var statusType = HttpUtil.getHttpStatusType(httpError.status);
        switch (statusType) {
            case HttpStatusType.ClientError:
                this.httpErrorInClient(httpError);
                break;
            case HttpStatusType.ServerError:
                this.httpErrorInServer(httpError);
                break;
            default:
                throw new Error('Get invalid status code when using httpErrorHandler method.');
        }
    };
    /**
   * 服务器端异常提示弹框
   */
    /**
     * 服务器端异常提示弹框
     * @private
     * @param {?} httpError
     * @return {?}
     */
    ExceptionService.prototype.httpErrorInServer = /**
     * 服务器端异常提示弹框
     * @private
     * @param {?} httpError
     * @return {?}
     */
    function (httpError) {
        /** @type {?} */
        var error = httpError.data;
        if (typeof (error) === 'string') {
            try {
                error = JSON.parse(error);
            }
            catch (e) { }
        }
        if (!error || error.Level == null || error.Level == undefined) { // 未封装error或未设置异常等级
            this.notifyService.error(httpError.message);
            return;
        }
        /** @type {?} */
        var getNotifyServiceMethodName = this.getNotifyServiceMethodName(error.Level);
        this.notifyService["" + getNotifyServiceMethodName](error.Message);
    };
    /**
     * 客户端异常提示弹框
     */
    /**
     * 客户端异常提示弹框
     * @private
     * @param {?} httpError
     * @return {?}
     */
    ExceptionService.prototype.httpErrorInClient = /**
     * 客户端异常提示弹框
     * @private
     * @param {?} httpError
     * @return {?}
     */
    function (httpError) {
        if (!httpError) {
            return;
        }
        /** @type {?} */
        var url = httpError.config && httpError.config.url && httpError.config.url;
        /** @type {?} */
        var status = httpError.status && httpError.status;
        this.notifyService.error(url + " " + status);
    };
    /**
   * 获取异常处理策略
   * @param exceptionLevel 异常等级
   */
    /**
     * 获取异常处理策略
     * @param {?} exceptionLevel 异常等级
     * @return {?}
     */
    ExceptionService.prototype.getNotifyServiceMethodName = /**
     * 获取异常处理策略
     * @param {?} exceptionLevel 异常等级
     * @return {?}
     */
    function (exceptionLevel) {
        /** @type {?} */
        var exception;
        switch (exceptionLevel) {
            case 0 /* Info */:
                exception = 'info';
                break;
            case 1 /* Warning */:
                exception = 'warning';
                break;
            case 2 /* Error */:
                exception = 'error';
                break;
            case 3 /* Fatal */:
                exception = 'fatal';
                break;
            default:
                // 默认异常等级是错误
                exception = 'error';
                break;
        }
        return exception;
    };
    return ExceptionService;
}());
if (false) {
    /**
     * @type {?}
     * @private
     */
    ExceptionService.prototype.notifyService;
    /**
     * @type {?}
     * @private
     */
    ExceptionService.prototype.jsBridgeService;
}
export { ExceptionService };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZXhjZXB0aW9uLnNlcnZjaWUuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZmFycmlzL21vYmlsZS1jb21tYW5kLXNlcnZpY2VzLyIsInNvdXJjZXMiOlsibGliL2V4Y2VwdGlvbi1zZXJ2aWNlcy9leGNlcHRpb24uc2VydmNpZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7OztBQUVBLE9BQU8sRUFBRSxRQUFRLEVBQUUsY0FBYyxFQUFFLE1BQU0sUUFBUSxDQUFDOzs7O0FBTWxEOzs7O0lBRUU7O09BRUc7SUFDSCwwQkFBb0IsYUFBNEIsRUFBVSxlQUFnQztRQUF0RSxrQkFBYSxHQUFiLGFBQWEsQ0FBZTtRQUFVLG9CQUFlLEdBQWYsZUFBZSxDQUFpQjtJQUMxRixDQUFDO0lBRUQ7O09BRUc7Ozs7OztJQUNILCtCQUFJOzs7OztJQUFKLFVBQUssS0FBSztRQUNSLElBQUksQ0FBQyxTQUFTLENBQUMsS0FBSyxDQUFDLENBQUM7SUFDeEIsQ0FBQztJQUVEOztLQUVDOzs7Ozs7O0lBQ08sb0NBQVM7Ozs7OztJQUFqQixVQUFrQixLQUFVO1FBQTVCLGlCQVVDO1FBVEMsbUJBQW1CO1FBQ25CLElBQUksS0FBSyxDQUFDLE9BQU8sSUFBSSxLQUFLLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLENBQUMsRUFBRTtZQUN4RCxJQUFJLENBQUMsYUFBYSxDQUFDLEtBQUssQ0FBQyxjQUFjLENBQUMsQ0FBQztZQUN6QyxVQUFVOzs7WUFBQyxjQUFRLEtBQUksQ0FBQyxlQUFlLENBQUMsV0FBVyxFQUFFLENBQUEsQ0FBQyxDQUFDLEdBQUUsSUFBSSxDQUFDLENBQUE7WUFDOUQsT0FBTztTQUNSO1FBQ0QsSUFBSSxLQUFLLElBQUksS0FBSyxDQUFDLFFBQVEsRUFBRTtZQUMzQixJQUFJLENBQUMsZ0JBQWdCLENBQUMsS0FBSyxDQUFDLFFBQVEsQ0FBQyxDQUFDO1NBQ3ZDO0lBQ0gsQ0FBQztJQUVEOztLQUVDOzs7Ozs7O0lBQ08sMkNBQWdCOzs7Ozs7SUFBeEIsVUFBeUIsU0FBUztRQUNoQyxJQUFJLENBQUMsU0FBUyxFQUFFO1lBQ2QsT0FBTztTQUNSOztZQUVLLFVBQVUsR0FBRyxRQUFRLENBQUMsaUJBQWlCLENBQUMsU0FBUyxDQUFDLE1BQU0sQ0FBQztRQUUvRCxRQUFRLFVBQVUsRUFBRTtZQUNsQixLQUFLLGNBQWMsQ0FBQyxXQUFXO2dCQUM3QixJQUFJLENBQUMsaUJBQWlCLENBQUMsU0FBUyxDQUFDLENBQUM7Z0JBQ2xDLE1BQU07WUFDUixLQUFLLGNBQWMsQ0FBQyxXQUFXO2dCQUM3QixJQUFJLENBQUMsaUJBQWlCLENBQUMsU0FBUyxDQUFDLENBQUM7Z0JBQ2xDLE1BQU07WUFDUjtnQkFDRSxNQUFNLElBQUksS0FBSyxDQUFDLDZEQUE2RCxDQUFDLENBQUM7U0FDbEY7SUFDSCxDQUFDO0lBR0Q7O0tBRUM7Ozs7Ozs7SUFDTyw0Q0FBaUI7Ozs7OztJQUF6QixVQUEwQixTQUFTOztZQUM3QixLQUFLLEdBQUcsU0FBUyxDQUFDLElBQUk7UUFDMUIsSUFBSSxPQUFPLENBQUMsS0FBSyxDQUFDLEtBQUssUUFBUSxFQUFFO1lBQy9CLElBQUk7Z0JBQ0YsS0FBSyxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLENBQUM7YUFDM0I7WUFBQyxPQUFPLENBQUMsRUFBRSxHQUFHO1NBQ2hCO1FBQ0QsSUFBSSxDQUFDLEtBQUssSUFBSSxLQUFLLENBQUMsS0FBSyxJQUFJLElBQUksSUFBSSxLQUFLLENBQUMsS0FBSyxJQUFJLFNBQVMsRUFBRSxFQUFFLG1CQUFtQjtZQUNsRixJQUFJLENBQUMsYUFBYSxDQUFDLEtBQUssQ0FBQyxTQUFTLENBQUMsT0FBTyxDQUFDLENBQUM7WUFDNUMsT0FBTztTQUNSOztZQUVLLDBCQUEwQixHQUFXLElBQUksQ0FBQywwQkFBMEIsQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDO1FBRXZGLElBQUksQ0FBQyxhQUFhLENBQUMsS0FBRywwQkFBNEIsQ0FBQyxDQUFDLEtBQUssQ0FBQyxPQUFPLENBQUMsQ0FBQztJQUNyRSxDQUFDO0lBRUQ7O09BRUc7Ozs7Ozs7SUFDSyw0Q0FBaUI7Ozs7OztJQUF6QixVQUEwQixTQUFTO1FBQ2pDLElBQUksQ0FBQyxTQUFTLEVBQUU7WUFDZCxPQUFPO1NBQ1I7O1lBQ0ssR0FBRyxHQUFHLFNBQVMsQ0FBQyxNQUFNLElBQUksU0FBUyxDQUFDLE1BQU0sQ0FBQyxHQUFHLElBQUksU0FBUyxDQUFDLE1BQU0sQ0FBQyxHQUFHOztZQUN0RSxNQUFNLEdBQUcsU0FBUyxDQUFDLE1BQU0sSUFBSSxTQUFTLENBQUMsTUFBTTtRQUNuRCxJQUFJLENBQUMsYUFBYSxDQUFDLEtBQUssQ0FBSSxHQUFHLFNBQUksTUFBUSxDQUFDLENBQUM7SUFDL0MsQ0FBQztJQUdEOzs7S0FHQzs7Ozs7O0lBQ00scURBQTBCOzs7OztJQUFqQyxVQUFrQyxjQUFjOztZQUMxQyxTQUFTO1FBQ2IsUUFBUSxjQUFjLEVBQUU7WUFDdEI7Z0JBQ0UsU0FBUyxHQUFHLE1BQU0sQ0FBQztnQkFDbkIsTUFBTTtZQUNSO2dCQUNFLFNBQVMsR0FBRyxTQUFTLENBQUM7Z0JBQ3RCLE1BQU07WUFDUjtnQkFDRSxTQUFTLEdBQUcsT0FBTyxDQUFDO2dCQUNwQixNQUFNO1lBQ1I7Z0JBQ0UsU0FBUyxHQUFHLE9BQU8sQ0FBQztnQkFDcEIsTUFBTTtZQUNSO2dCQUNFLFlBQVk7Z0JBQ1osU0FBUyxHQUFHLE9BQU8sQ0FBQztnQkFDcEIsTUFBTTtTQUNUO1FBRUQsT0FBTyxTQUFTLENBQUM7SUFDbkIsQ0FBQztJQUNILHVCQUFDO0FBQUQsQ0FBQyxBQWpIRCxJQWlIQzs7Ozs7O0lBNUdhLHlDQUFvQzs7Ozs7SUFBRSwyQ0FBd0M7O0FBOEc1RixPQUFPLEVBQUUsZ0JBQWdCLEVBQUUsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IElFcnJvclNlcnZlIH0gZnJvbSAnQGZhcnJpcy9tb2JpbGUtYmVmJztcclxuaW1wb3J0IHsgTm90aWZ5U2VydmljZSB9IGZyb20gJy4uL3VpLXNlcnZpY2VzJztcclxuaW1wb3J0IHsgSHR0cFV0aWwsIEh0dHBTdGF0dXNUeXBlIH0gZnJvbSAnLi9odHRwJztcclxuaW1wb3J0IHsgRXhjZXB0aW9uTGV2ZWwgfSBmcm9tICcuL3R5cGVzJztcclxuaW1wb3J0IHsgSnNCcmlkZ2VTZXJ2aWNlIH0gZnJvbSAnLi4vanMtYnJpZGdlLXNlcnZpY2UvaW5kZXgnO1xyXG4vKipcclxuICog5a6e5L2T5pON5L2c5pyN5YqhXHJcbiAqL1xyXG5jbGFzcyBFeGNlcHRpb25TZXJ2aWNlIGltcGxlbWVudHMgSUVycm9yU2VydmUge1xyXG5cclxuICAvKipcclxuICAgKiDmnoTpgKDlh73mlbBcclxuICAgKi9cclxuICBjb25zdHJ1Y3Rvcihwcml2YXRlIG5vdGlmeVNlcnZpY2U6IE5vdGlmeVNlcnZpY2UsIHByaXZhdGUganNCcmlkZ2VTZXJ2aWNlOiBKc0JyaWRnZVNlcnZpY2UpIHtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOaYvuekuuW8guW4uOS/oeaBr1xyXG4gICAqL1xyXG4gIHNob3coZXJyb3IpIHtcclxuICAgIHRoaXMuZXhjZXB0aW9uKGVycm9yKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gKiDlvILluLjlpITnkIbot6/nlLHmlrnms5VcclxuICovXHJcbiAgcHJpdmF0ZSBleGNlcHRpb24oZXJyb3I6IGFueSkge1xyXG4gICAgLy8g6ZKI5a+5c2Vzc2lvbuWkseaViOWBmueJueauiuWkhOeQhlxyXG4gICAgaWYgKGVycm9yLm1lc3NhZ2UgJiYgZXJyb3IubWVzc2FnZS5pbmRleE9mKCc0MDEnKSAhPT0gLTEpIHtcclxuICAgICAgdGhpcy5ub3RpZnlTZXJ2aWNlLmVycm9yKCfnmbvlvZXkv6Hmga/lt7LlpLHmlYjor7fph43mlrDmiZPlvIAnKTtcclxuICAgICAgc2V0VGltZW91dCgoKSA9PiB7IHRoaXMuanNCcmlkZ2VTZXJ2aWNlLmNsb3NlV2luZG93KCkgfSwgMjAwMClcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgaWYgKGVycm9yICYmIGVycm9yLnJlc3BvbnNlKSB7XHJcbiAgICAgIHRoaXMuaHR0cEVycm9ySGFuZGxlcihlcnJvci5yZXNwb25zZSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICogaHR0cOivt+axguW8guW4uOWkhOeQhuWZqFxyXG4gKi9cclxuICBwcml2YXRlIGh0dHBFcnJvckhhbmRsZXIoaHR0cEVycm9yKTogdm9pZCB7XHJcbiAgICBpZiAoIWh0dHBFcnJvcikge1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3Qgc3RhdHVzVHlwZSA9IEh0dHBVdGlsLmdldEh0dHBTdGF0dXNUeXBlKGh0dHBFcnJvci5zdGF0dXMpO1xyXG5cclxuICAgIHN3aXRjaCAoc3RhdHVzVHlwZSkge1xyXG4gICAgICBjYXNlIEh0dHBTdGF0dXNUeXBlLkNsaWVudEVycm9yOlxyXG4gICAgICAgIHRoaXMuaHR0cEVycm9ySW5DbGllbnQoaHR0cEVycm9yKTtcclxuICAgICAgICBicmVhaztcclxuICAgICAgY2FzZSBIdHRwU3RhdHVzVHlwZS5TZXJ2ZXJFcnJvcjpcclxuICAgICAgICB0aGlzLmh0dHBFcnJvckluU2VydmVyKGh0dHBFcnJvcik7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdHZXQgaW52YWxpZCBzdGF0dXMgY29kZSB3aGVuIHVzaW5nIGh0dHBFcnJvckhhbmRsZXIgbWV0aG9kLicpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcblxyXG4gIC8qKlxyXG4gKiDmnI3liqHlmajnq6/lvILluLjmj5DnpLrlvLnmoYZcclxuICovXHJcbiAgcHJpdmF0ZSBodHRwRXJyb3JJblNlcnZlcihodHRwRXJyb3IpOiB2b2lkIHtcclxuICAgIGxldCBlcnJvciA9IGh0dHBFcnJvci5kYXRhO1xyXG4gICAgaWYgKHR5cGVvZiAoZXJyb3IpID09PSAnc3RyaW5nJykge1xyXG4gICAgICB0cnkge1xyXG4gICAgICAgIGVycm9yID0gSlNPTi5wYXJzZShlcnJvcik7XHJcbiAgICAgIH0gY2F0Y2ggKGUpIHsgfVxyXG4gICAgfVxyXG4gICAgaWYgKCFlcnJvciB8fCBlcnJvci5MZXZlbCA9PSBudWxsIHx8IGVycm9yLkxldmVsID09IHVuZGVmaW5lZCkgeyAvLyDmnKrlsIHoo4VlcnJvcuaIluacquiuvue9ruW8guW4uOetiee6p1xyXG4gICAgICB0aGlzLm5vdGlmeVNlcnZpY2UuZXJyb3IoaHR0cEVycm9yLm1lc3NhZ2UpO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgZ2V0Tm90aWZ5U2VydmljZU1ldGhvZE5hbWU6IFN0cmluZyA9IHRoaXMuZ2V0Tm90aWZ5U2VydmljZU1ldGhvZE5hbWUoZXJyb3IuTGV2ZWwpO1xyXG5cclxuICAgIHRoaXMubm90aWZ5U2VydmljZVtgJHtnZXROb3RpZnlTZXJ2aWNlTWV0aG9kTmFtZX1gXShlcnJvci5NZXNzYWdlKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOWuouaIt+err+W8guW4uOaPkOekuuW8ueahhlxyXG4gICAqL1xyXG4gIHByaXZhdGUgaHR0cEVycm9ySW5DbGllbnQoaHR0cEVycm9yKTogdm9pZCB7XHJcbiAgICBpZiAoIWh0dHBFcnJvcikge1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBjb25zdCB1cmwgPSBodHRwRXJyb3IuY29uZmlnICYmIGh0dHBFcnJvci5jb25maWcudXJsICYmIGh0dHBFcnJvci5jb25maWcudXJsO1xyXG4gICAgY29uc3Qgc3RhdHVzID0gaHR0cEVycm9yLnN0YXR1cyAmJiBodHRwRXJyb3Iuc3RhdHVzO1xyXG4gICAgdGhpcy5ub3RpZnlTZXJ2aWNlLmVycm9yKGAke3VybH0gJHtzdGF0dXN9YCk7XHJcbiAgfVxyXG5cclxuXHJcbiAgLyoqXHJcbiAqIOiOt+WPluW8guW4uOWkhOeQhuetlueVpVxyXG4gKiBAcGFyYW0gZXhjZXB0aW9uTGV2ZWwg5byC5bi4562J57qnXHJcbiAqL1xyXG4gIHB1YmxpYyBnZXROb3RpZnlTZXJ2aWNlTWV0aG9kTmFtZShleGNlcHRpb25MZXZlbCk6IFN0cmluZyB7XHJcbiAgICBsZXQgZXhjZXB0aW9uO1xyXG4gICAgc3dpdGNoIChleGNlcHRpb25MZXZlbCkge1xyXG4gICAgICBjYXNlIEV4Y2VwdGlvbkxldmVsLkluZm86XHJcbiAgICAgICAgZXhjZXB0aW9uID0gJ2luZm8nO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICBjYXNlIEV4Y2VwdGlvbkxldmVsLldhcm5pbmc6XHJcbiAgICAgICAgZXhjZXB0aW9uID0gJ3dhcm5pbmcnO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICBjYXNlIEV4Y2VwdGlvbkxldmVsLkVycm9yOlxyXG4gICAgICAgIGV4Y2VwdGlvbiA9ICdlcnJvcic7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIGNhc2UgRXhjZXB0aW9uTGV2ZWwuRmF0YWw6XHJcbiAgICAgICAgZXhjZXB0aW9uID0gJ2ZhdGFsJztcclxuICAgICAgICBicmVhaztcclxuICAgICAgZGVmYXVsdDpcclxuICAgICAgICAvLyDpu5jorqTlvILluLjnrYnnuqfmmK/plJnor69cclxuICAgICAgICBleGNlcHRpb24gPSAnZXJyb3InO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBleGNlcHRpb247XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgeyBFeGNlcHRpb25TZXJ2aWNlIH07XHJcbiJdfQ==