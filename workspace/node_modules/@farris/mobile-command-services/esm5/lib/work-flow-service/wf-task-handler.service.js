/**
 * @fileoverview added by tsickle
 * Generated from: lib/work-flow-service/wf-task-handler.service.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Subject } from 'rxjs';
import { StartProcessPayload, CancelSubmitPayload } from './entity/start-process-payload';
/**
 * @record
 */
function Response() { }
if (false) {
    /** @type {?} */
    Response.prototype.type;
    /** @type {?} */
    Response.prototype.message;
}
;
var WfTaskHandlerService = /** @class */ (function () {
    function WfTaskHandlerService(processSelectorService, taskService, loadingService, notifyService) {
        this.processSelectorService = processSelectorService;
        this.taskService = taskService;
        this.loadingService = loadingService;
        this.notifyService = notifyService;
        this.subject = new Subject();
    }
    /**
     * 提交审批
     * @param payload 上下文参数
     */
    /**
     * 提交审批
     * @param {?} payload 上下文参数
     * @return {?}
     */
    WfTaskHandlerService.prototype.startProcess = /**
     * 提交审批
     * @param {?} payload 上下文参数
     * @return {?}
     */
    function (payload) {
        var _this = this;
        /** @type {?} */
        var subject = new Subject();
        this.processSelectorService.setParam(payload);
        this.processSelectorService.getSubject().subscribe((/**
         * @param {?} response
         * @return {?}
         */
        function (response) {
            if (response.type === 'success') {
                if (response.message) {
                    _this.notifyService.success(response.message);
                    subject.next(true);
                }
            }
            else if (response.type === 'error') {
                subject.next(false);
                _this.notifyService.error(response.message);
            }
        }), (/**
         * @return {?}
         */
        function () {
            _this.loadingService.hide();
        }));
        return subject.asObservable();
    };
    /**
     * 取消提交
     * @payload payload 参数
     */
    /**
     * 取消提交
     * \@payload payload 参数
     * @param {?} payload
     * @return {?}
     */
    WfTaskHandlerService.prototype.cancelSubmit = /**
     * 取消提交
     * \@payload payload 参数
     * @param {?} payload
     * @return {?}
     */
    function (payload) {
        var _this = this;
        /** @type {?} */
        var subject = new Subject();
        this.loadingService.show();
        this.taskService.cancelSubmit(payload).subscribe((/**
         * @param {?} re
         * @return {?}
         */
        function (re) {
            subject.next(true);
            _this.loadingService.hide();
            _this.notifyService.success('取消提交成功');
        }), (/**
         * @param {?} error
         * @return {?}
         */
        function (error) {
            subject.next(false);
            _this.loadingService.hide();
            _this.notifyService.error(error && error.response && error.response.data && error.response.data.Message || '取消提交失败');
        }));
        return subject.asObservable();
    };
    /**
   * 提交审批
   * @param dataId 表单id
   * @param bizDefKey 入口单据id
   */
    /**
     * 提交审批
     * @param {?} dataId 表单id
     * @param {?} bizDefKey 入口单据id
     * @return {?}
     */
    WfTaskHandlerService.prototype.submitWithBizDefKey = /**
     * 提交审批
     * @param {?} dataId 表单id
     * @param {?} bizDefKey 入口单据id
     * @return {?}
     */
    function (dataId, bizDefKey) {
        if (!dataId) {
            this.notifyService.error('表单id不能为空');
            return;
        }
        if (!bizDefKey) {
            this.notifyService.error('入口单据Id不能为空');
            return;
        }
        /** @type {?} */
        var startProcessPayload = new StartProcessPayload();
        startProcessPayload.dataId = dataId;
        startProcessPayload.bizDefKey = bizDefKey;
        return this.startProcess(startProcessPayload);
    };
    /**
     * 取消提交审批
     * @param dataId 表单id
     * @param bizDefKey 入口单据id
     */
    /**
     * 取消提交审批
     * @param {?} dataId 表单id
     * @param {?} bizDefKey 入口单据id
     * @return {?}
     */
    WfTaskHandlerService.prototype.cancelSubmitWithDataId = /**
     * 取消提交审批
     * @param {?} dataId 表单id
     * @param {?} bizDefKey 入口单据id
     * @return {?}
     */
    function (dataId, bizDefKey) {
        if (!dataId) {
            this.notifyService.error('表单id不能为空');
            return;
        }
        if (!bizDefKey) {
            this.notifyService.error('入口单据Id不能为空');
            return;
        }
        /** @type {?} */
        var cancelSubmitPayload = new CancelSubmitPayload();
        cancelSubmitPayload.dataId = dataId;
        cancelSubmitPayload.bizDefKey = bizDefKey;
        return this.cancelSubmit(cancelSubmitPayload);
    };
    /**
     * 批量提交审批
     * @param dataIds 表单ID集合
     * @param bizDefKey 入口单据id
     */
    /**
     * 批量提交审批
     * @param {?} dataIds 表单ID集合
     * @param {?} bizDefKey 入口单据id
     * @return {?}
     */
    WfTaskHandlerService.prototype.batchSubmitWithBizDefKey = /**
     * 批量提交审批
     * @param {?} dataIds 表单ID集合
     * @param {?} bizDefKey 入口单据id
     * @return {?}
     */
    function (dataIds, bizDefKey) {
        var _this = this;
        if (!dataIds) {
            this.notifyService.error('dataId不能为空');
            return;
        }
        if (!dataIds.length) {
            this.notifyService.error('请选择数据');
            return;
        }
        if (!bizDefKey) {
            this.notifyService.error('入口单据ID不能为空');
            return;
        }
        if (dataIds.length === 1) {
            /** @type {?} */
            var startPayload = new StartProcessPayload();
            startPayload.bizDefKey = bizDefKey;
            startPayload.dataId = dataIds[0];
            return this.startProcess(startPayload);
        }
        /** @type {?} */
        var successNum = 0;
        /** @type {?} */
        var failedNum = 0;
        /** @type {?} */
        var subject = new Subject();
        this.loadingService.show();
        for (var i = 0; i < dataIds.length; i++) {
            /** @type {?} */
            var startPayload = new StartProcessPayload();
            startPayload.bizDefKey = bizDefKey;
            startPayload.dataId = dataIds[i];
            startPayload.variables = { simulate: false };
            this.taskService.startProcess(startPayload).subscribe((/**
             * @param {?} response
             * @return {?}
             */
            function (response) {
                if (response.procDefs.length > 1 || response.nextFlowNodes.length > 1) { //存在多个流程，单独提交//多个节点，单独提交
                    failedNum++;
                }
                else {
                    successNum++;
                }
                if (successNum + failedNum === dataIds.length) {
                    _this.loadingService.hide();
                    subject.next(true); //全部执行完再返回
                    _this.showBatchSubmitInfo("submit", successNum, failedNum);
                }
            }), (/**
             * @return {?}
             */
            function () {
                failedNum++;
                if (successNum + failedNum === dataIds.length) {
                    _this.loadingService.hide();
                    subject.next(false); //全部执行完再返回
                    _this.showBatchSubmitInfo("submit", successNum, failedNum);
                }
            }));
        }
        return subject.asObservable();
    };
    /**
     * 批量取消提交审批
     * @param dataIds 表单ID集合
     * @param bizDefKey 入口单据id
     */
    /**
     * 批量取消提交审批
     * @param {?} dataIds 表单ID集合
     * @param {?} bizDefKey 入口单据id
     * @return {?}
     */
    WfTaskHandlerService.prototype.batchCancelSubmitWithDataId = /**
     * 批量取消提交审批
     * @param {?} dataIds 表单ID集合
     * @param {?} bizDefKey 入口单据id
     * @return {?}
     */
    function (dataIds, bizDefKey) {
        var _this = this;
        if (!dataIds) {
            this.notifyService.error('dataId不能为空');
            return;
        }
        if (!dataIds.length) {
            this.notifyService.error('请选择数据');
            return;
        }
        if (!bizDefKey) {
            this.notifyService.error('入口单据ID不能为空');
            return;
        }
        /** @type {?} */
        var subject = new Subject();
        /** @type {?} */
        var successNum = 0;
        /** @type {?} */
        var failedNum = 0;
        this.loadingService.show();
        for (var i = 0; i < dataIds.length; i++) {
            /** @type {?} */
            var cancelSubmitPayload = new CancelSubmitPayload();
            cancelSubmitPayload.dataId = dataIds[i];
            cancelSubmitPayload.bizDefKey = bizDefKey;
            this.taskService.cancelSubmit(cancelSubmitPayload).subscribe((/**
             * @param {?} re
             * @return {?}
             */
            function (re) {
                successNum++;
                if (successNum + failedNum === dataIds.length) {
                    _this.loadingService.hide();
                    subject.next(true);
                    _this.showBatchSubmitInfo("cancel", successNum, failedNum);
                }
            }), (/**
             * @return {?}
             */
            function () {
                failedNum++;
                if (successNum + failedNum === dataIds.length) {
                    _this.loadingService.hide();
                    subject.next(false);
                    _this.showBatchSubmitInfo("cancel", successNum, failedNum);
                }
            }));
        }
        return subject.asObservable();
    };
    /**
   * 子表提交审批
   * @param parentDataId 主表id
   * @param childDataId 子表id
   * @param bizDefKey 入口单据id
   */
    /**
     * 子表提交审批
     * @param {?} parentDataId 主表id
     * @param {?} childDataId 子表id
     * @param {?} bizDefKey 入口单据id
     * @return {?}
     */
    WfTaskHandlerService.prototype.childSubmit = /**
     * 子表提交审批
     * @param {?} parentDataId 主表id
     * @param {?} childDataId 子表id
     * @param {?} bizDefKey 入口单据id
     * @return {?}
     */
    function (parentDataId, childDataId, bizDefKey) {
        if (!parentDataId || !childDataId) {
            this.notifyService.error('dataId不能为空');
            return;
        }
        if (!bizDefKey) {
            this.notifyService.error('入口单据ID不能为空');
            return;
        }
        /** @type {?} */
        var startProcessPayload = new StartProcessPayload();
        startProcessPayload.dataId = parentDataId + "," + childDataId;
        startProcessPayload.bizDefKey = bizDefKey;
        return this.startProcess(startProcessPayload);
    };
    /**
   * 子表取消提交审批
   * @param parentDataId 主表id
   * @param childDataId 子表id
   * @param bizDefKey 入口单据id
   */
    /**
     * 子表取消提交审批
     * @param {?} parentDataId 主表id
     * @param {?} childDataId 子表id
     * @param {?} bizDefKey 入口单据id
     * @return {?}
     */
    WfTaskHandlerService.prototype.childCancelSubmit = /**
     * 子表取消提交审批
     * @param {?} parentDataId 主表id
     * @param {?} childDataId 子表id
     * @param {?} bizDefKey 入口单据id
     * @return {?}
     */
    function (parentDataId, childDataId, bizDefKey) {
        if (!parentDataId || !childDataId) {
            this.notifyService.error('dataId不能为空');
            return;
        }
        if (!bizDefKey) {
            this.notifyService.error('入口单据ID不能为空');
            return;
        }
        /** @type {?} */
        var cancelSubmitPayload = new CancelSubmitPayload();
        cancelSubmitPayload.dataId = parentDataId + "," + childDataId;
        cancelSubmitPayload.bizDefKey = bizDefKey;
        return this.cancelSubmit(cancelSubmitPayload);
    };
    /**
   * 子表批量提交审批
   * @param parentDataId 主表id
   * @param childDataIds 子表id集合
   * @param bizDefKey 入口单据id
   */
    /**
     * 子表批量提交审批
     * @param {?} parentDataId 主表id
     * @param {?} childDataIds 子表id集合
     * @param {?} bizDefKey 入口单据id
     * @return {?}
     */
    WfTaskHandlerService.prototype.childBatchSubmit = /**
     * 子表批量提交审批
     * @param {?} parentDataId 主表id
     * @param {?} childDataIds 子表id集合
     * @param {?} bizDefKey 入口单据id
     * @return {?}
     */
    function (parentDataId, childDataIds, bizDefKey) {
        if (!parentDataId || !childDataIds) {
            this.notifyService.error('dataId不能为空');
            return;
        }
        if (!bizDefKey) {
            this.notifyService.error('入口单据ID不能为空');
            return;
        }
        /** @type {?} */
        var dataIds = childDataIds.map((/**
         * @param {?} childDataId
         * @return {?}
         */
        function (childDataId) { return parentDataId + "," + childDataId; }));
        return this.batchSubmitWithBizDefKey(dataIds, bizDefKey);
    };
    /**
   * 子表批量取消提交审批
   * @param parentDataId 主表id
   * @param childDataIds 子表id集合
   * @param bizDefKey 入口单据id
   */
    /**
     * 子表批量取消提交审批
     * @param {?} parentDataId 主表id
     * @param {?} childDataIds 子表id集合
     * @param {?} bizDefKey 入口单据id
     * @return {?}
     */
    WfTaskHandlerService.prototype.childBatchCancelSubmit = /**
     * 子表批量取消提交审批
     * @param {?} parentDataId 主表id
     * @param {?} childDataIds 子表id集合
     * @param {?} bizDefKey 入口单据id
     * @return {?}
     */
    function (parentDataId, childDataIds, bizDefKey) {
        if (!parentDataId || !childDataIds) {
            this.notifyService.error('dataId不能为空');
            return;
        }
        if (!bizDefKey) {
            this.notifyService.error('入口单据ID不能为空');
            return;
        }
        /** @type {?} */
        var dataIds = childDataIds.map((/**
         * @param {?} childDataId
         * @return {?}
         */
        function (childDataId) { return parentDataId + "," + childDataId; }));
        return this.batchCancelSubmitWithDataId(dataIds, bizDefKey);
    };
    /**
   * 批量提交、取消提交提示信息
   */
    /**
     * 批量提交、取消提交提示信息
     * @private
     * @param {?} actionCode
     * @param {?} successNum
     * @param {?} failedNum
     * @return {?}
     */
    WfTaskHandlerService.prototype.showBatchSubmitInfo = /**
     * 批量提交、取消提交提示信息
     * @private
     * @param {?} actionCode
     * @param {?} successNum
     * @param {?} failedNum
     * @return {?}
     */
    function (actionCode, successNum, failedNum) {
        if (successNum && !failedNum) { //批量全部成功
            actionCode === "submit" && this.notifyService.success('提交审批成功！');
            actionCode === "cancel" && this.notifyService.success('取消提交成功！');
        }
        if (successNum && failedNum) { //批量有成功有失败
            this.notifyService.warning("\u64CD\u4F5C\u6210\u529F" + successNum + "\u6761\uFF0C\u5931\u8D25" + failedNum + "\u6761!");
        }
        if (!successNum && failedNum) { //批量全部失败
            actionCode === "submit" && this.notifyService.error('提交审批失败！');
            actionCode === "cancel" && this.notifyService.error('取消提交失败！');
        }
    };
    return WfTaskHandlerService;
}());
export { WfTaskHandlerService };
if (false) {
    /** @type {?} */
    WfTaskHandlerService.prototype.subject;
    /**
     * @type {?}
     * @private
     */
    WfTaskHandlerService.prototype.processSelectorService;
    /**
     * @type {?}
     * @private
     */
    WfTaskHandlerService.prototype.taskService;
    /**
     * @type {?}
     * @private
     */
    WfTaskHandlerService.prototype.loadingService;
    /**
     * @type {?}
     * @private
     */
    WfTaskHandlerService.prototype.notifyService;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoid2YtdGFzay1oYW5kbGVyLnNlcnZpY2UuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZmFycmlzL21vYmlsZS1jb21tYW5kLXNlcnZpY2VzLyIsInNvdXJjZXMiOlsibGliL3dvcmstZmxvdy1zZXJ2aWNlL3dmLXRhc2staGFuZGxlci5zZXJ2aWNlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7O0FBQUEsT0FBTyxFQUFjLE9BQU8sRUFBTSxNQUFNLE1BQU0sQ0FBQztBQUUvQyxPQUFPLEVBQUUsbUJBQW1CLEVBQUUsbUJBQW1CLEVBQUUsTUFBTSxnQ0FBZ0MsQ0FBQzs7OztBQUkxRix1QkFBb0Q7OztJQUEvQix3QkFBYTs7SUFBQywyQkFBZTs7QUFBRSxDQUFDO0FBRXJEO0lBSUUsOEJBQ1Usc0JBQThDLEVBQzlDLFdBQXdCLEVBQ3hCLGNBQThCLEVBQzlCLGFBQTRCO1FBSDVCLDJCQUFzQixHQUF0QixzQkFBc0IsQ0FBd0I7UUFDOUMsZ0JBQVcsR0FBWCxXQUFXLENBQWE7UUFDeEIsbUJBQWMsR0FBZCxjQUFjLENBQWdCO1FBQzlCLGtCQUFhLEdBQWIsYUFBYSxDQUFlO1FBTnRDLFlBQU8sR0FBRyxJQUFJLE9BQU8sRUFBTyxDQUFDO0lBT3pCLENBQUM7SUFFTDs7O09BR0c7Ozs7OztJQUNILDJDQUFZOzs7OztJQUFaLFVBQWEsT0FBNEI7UUFBekMsaUJBbUJDOztZQWxCTyxPQUFPLEdBQUcsSUFBSSxPQUFPLEVBQUU7UUFDN0IsSUFBSSxDQUFDLHNCQUFzQixDQUFDLFFBQVEsQ0FBQyxPQUFPLENBQUMsQ0FBQztRQUM5QyxJQUFJLENBQUMsc0JBQXNCLENBQUMsVUFBVSxFQUFFLENBQUMsU0FBUzs7OztRQUNoRCxVQUFDLFFBQWtCO1lBQ2pCLElBQUksUUFBUSxDQUFDLElBQUksS0FBSyxTQUFTLEVBQUU7Z0JBQy9CLElBQUksUUFBUSxDQUFDLE9BQU8sRUFBRTtvQkFDcEIsS0FBSSxDQUFDLGFBQWEsQ0FBQyxPQUFPLENBQUMsUUFBUSxDQUFDLE9B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LElBQUksSUFBSSxDQUFDLGFBQWEsQ0FBQyxLQUFLLENBQUMsU0FBUyxDQUFDLENBQUM7U0FDaEU7SUFDSCxDQUFDO0lBRUgsMkJBQUM7QUFBRCxDQUFDLEFBeFNELElBd1NDOzs7O0lBdFNDLHVDQUE2Qjs7Ozs7SUFHM0Isc0RBQXNEOzs7OztJQUN0RCwyQ0FBZ0M7Ozs7O0lBQ2hDLDhDQUFzQzs7Ozs7SUFDdEMsNkNBQW9DIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgT2JzZXJ2YWJsZSwgU3ViamVjdCwgb2YgfSBmcm9tICdyeGpzJztcclxuaW1wb3J0IHsgVGFza1NlcnZpY2UgfSBmcm9tICcuL3NlcnZpY2UvdGFzay5zZXJ2aWNlJztcclxuaW1wb3J0IHsgU3RhcnRQcm9jZXNzUGF5bG9hZCwgQ2FuY2VsU3VibWl0UGF5bG9hZCB9IGZyb20gJy4vZW50aXR5L3N0YXJ0LXByb2Nlc3MtcGF5bG9hZCc7XHJcbmltcG9ydCB7IFByb2Nlc3NTZWxlY3RvclNlcnZpY2UgfSBmcm9tICcuL3N1Ym1pdC9wcm9jZXNzLXNlbGVjdG9yLXZ1ZS9wcm9jZXNzLXNlbGVjdG9yLnNlcnZpY2UnXHJcblxyXG5pbXBvcnQgeyBMb2FkaW5nU2VydmljZSwgTm90aWZ5U2VydmljZSB9IGZyb20gJy4uL3VpLXNlcnZpY2VzL2luZGV4JztcclxuaW50ZXJmYWNlIFJlc3BvbnNlIHsgdHlwZTogc3RyaW5nLCBtZXNzYWdlOiBzdHJpbmcgfTtcclxuXHJcbmV4cG9ydCBjbGFzcyBXZlRhc2tIYW5kbGVyU2VydmljZSB7XHJcblxyXG4gIHN1YmplY3QgPSBuZXcgU3ViamVjdDxhbnk+KCk7XHJcblxyXG4gIGNvbnN0cnVjdG9yKFxyXG4gICAgcHJpdmF0ZSBwcm9jZXNzU2VsZWN0b3JTZXJ2aWNlOiBQcm9jZXNzU2VsZWN0b3JTZXJ2aWNlLFxyXG4gICAgcHJpdmF0ZSB0YXNrU2VydmljZTogVGFza1NlcnZpY2UsXHJcbiAgICBwcml2YXRlIGxvYWRpbmdTZXJ2aWNlOiBMb2FkaW5nU2VydmljZSxcclxuICAgIHByaXZhdGUgbm90aWZ5U2VydmljZTogTm90aWZ5U2VydmljZVxyXG4gICkgeyB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOaPkOS6pOWuoeaJuVxyXG4gICAqIEBwYXJhbSBwYXlsb2FkIOS4iuS4i+aWh+WPguaVsFxyXG4gICAqL1xyXG4gIHN0YXJ0UHJvY2VzcyhwYXlsb2FkOiBTdGFydFByb2Nlc3NQYXlsb2FkKTogT2JzZXJ2YWJsZTxhbnk+IHtcclxuICAgIGNvbnN0IHN1YmplY3QgPSBuZXcgU3ViamVjdCgpO1xyXG4gICAgdGhpcy5wcm9jZXNzU2VsZWN0b3JTZXJ2aWNlLnNldFBhcmFtKHBheWxvYWQpO1xyXG4gICAgdGhpcy5wcm9jZXNzU2VsZWN0b3JTZXJ2aWNlLmdldFN1YmplY3QoKS5zdWJzY3JpYmUoXHJcbiAgICAgIChyZXNwb25zZTogUmVzcG9uc2UpID0+IHtcclxuICAgICAgICBpZiAocmVzcG9uc2UudHlwZSA9PT0gJ3N1Y2Nlc3MnKSB7XHJcbiAgICAgICAgICBpZiAocmVzcG9uc2UubWVzc2FnZSkge1xyXG4gICAgICAgICAgICB0aGlzLm5vdGlmeVNlcnZpY2Uuc3VjY2VzcyhyZXNwb25zZS5tZXNzYWdlKTtcclxuICAgICAgICAgICAgc3ViamVjdC5uZXh0KHRydWUpXHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIGlmIChyZXNwb25zZS50eXBlID09PSAnZXJyb3InKSB7XHJcbiAgICAgICAgICBzdWJqZWN0Lm5leHQoZmFsc2UpXHJcbiAgICAgICAgICB0aGlzLm5vdGlmeVNlcnZpY2UuZXJyb3IocmVzcG9uc2UubWVzc2FnZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9LFxyXG4gICAgICAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5sb2FkaW5nU2VydmljZS5oaWRlKCk7XHJcbiAgICAgIH0pXHJcbiAgICByZXR1cm4gc3ViamVjdC5hc09ic2VydmFibGUoKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOWPlua2iOaPkOS6pFxyXG4gICAqIEBwYXlsb2FkIHBheWxvYWQg5Y+C5pWwXHJcbiAgICovXHJcbiAgY2FuY2VsU3VibWl0KHBheWxvYWQ6IENhbmNlbFN1Ym1pdFBheWxvYWQpOiBPYnNlcnZhYmxlPGFueT4ge1xyXG4gICAgY29uc3Qgc3ViamVjdCA9IG5ldyBTdWJqZWN0KCk7XHJcbiAgICB0aGlzLmxvYWRpbmdTZXJ2aWNlLnNob3coKTtcclxuICAgIHRoaXMudGFza1NlcnZpY2UuY2FuY2VsU3VibWl0KHBheWxvYWQpLnN1YnNjcmliZShyZSA9PiB7XHJcbiAgICAgIHN1YmplY3QubmV4dCh0cnVlKTtcclxuICAgICAgdGhpcy5sb2FkaW5nU2VydmljZS5oaWRlKCk7XHJcbiAgICAgIHRoaXMubm90aWZ5U2VydmljZS5zdWNjZXNzKCflj5bmtojmj5DkuqTmiJDlip8nKTtcclxuICAgIH0sIGVycm9yID0+IHtcclxuICAgICAgc3ViamVjdC5uZXh0KGZhbHNlKTtcclxuICAgICAgdGhpcy5sb2FkaW5nU2VydmljZS5oaWRlKCk7XHJcbiAgICAgIHRoaXMubm90aWZ5U2VydmljZS5lcnJvcihlcnJvciAmJiBlcnJvci5yZXNwb25zZSAmJiBlcnJvci5yZXNwb25zZS5kYXRhICYmIGVycm9yLnJlc3BvbnNlLmRhdGEuTWVzc2FnZSB8fCAn5Y+W5raI5o+Q5Lqk5aSx6LSlJyk7XHJcbiAgICB9KVxyXG4gICAgcmV0dXJuIHN1YmplY3QuYXNPYnNlcnZhYmxlKCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICog5o+Q5Lqk5a6h5om5XHJcbiAqIEBwYXJhbSBkYXRhSWQg6KGo5Y2VaWRcclxuICogQHBhcmFtIGJpekRlZktleSDlhaXlj6PljZXmja5pZFxyXG4gKi9cclxuICBzdWJtaXRXaXRoQml6RGVmS2V5KGRhdGFJZDogc3RyaW5nLCBiaXpEZWZLZXk6IHN0cmluZyk6IE9ic2VydmFibGU8YW55PiB7XHJcbiAgICBpZiAoIWRhdGFJZCkge1xyXG4gICAgICB0aGlzLm5vdGlmeVNlcnZpY2UuZXJyb3IoJ+ihqOWNlWlk5LiN6IO95Li656m6Jyk7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIGlmICghYml6RGVmS2V5KSB7XHJcbiAgICAgIHRoaXMubm90aWZ5U2VydmljZS5lcnJvcign5YWl5Y+j5Y2V5o2uSWTkuI3og73kuLrnqbonKTtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgdmFyIHN0YXJ0UHJvY2Vzc1BheWxvYWQgPSBuZXcgU3RhcnRQcm9jZXNzUGF5bG9hZCgpO1xyXG4gICAgc3RhcnRQcm9jZXNzUGF5bG9hZC5kYXRhSWQgPSBkYXRhSWQ7XHJcbiAgICBzdGFydFByb2Nlc3NQYXlsb2FkLmJpekRlZktleSA9IGJpekRlZktleTtcclxuICAgIHJldHVybiB0aGlzLnN0YXJ0UHJvY2VzcyhzdGFydFByb2Nlc3NQYXlsb2FkKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOWPlua2iOaPkOS6pOWuoeaJuVxyXG4gICAqIEBwYXJhbSBkYXRhSWQg6KGo5Y2VaWRcclxuICAgKiBAcGFyYW0gYml6RGVmS2V5IOWFpeWPo+WNleaNrmlkXHJcbiAgICovXHJcbiAgY2FuY2VsU3VibWl0V2l0aERhdGFJZChkYXRhSWQ6IHN0cmluZywgYml6RGVmS2V5OiBzdHJpbmcpOiBPYnNlcnZhYmxlPGFueT4ge1xyXG4gICAgaWYgKCFkYXRhSWQpIHtcclxuICAgICAgdGhpcy5ub3RpZnlTZXJ2aWNlLmVycm9yKCfooajljZVpZOS4jeiDveS4uuepuicpO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBpZiAoIWJpekRlZktleSkge1xyXG4gICAgICB0aGlzLm5vdGlmeVNlcnZpY2UuZXJyb3IoJ+WFpeWPo+WNleaNrklk5LiN6IO95Li656m6Jyk7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIHZhciBjYW5jZWxTdWJtaXRQYXlsb2FkID0gbmV3IENhbmNlbFN1Ym1pdFBheWxvYWQoKTtcclxuICAgIGNhbmNlbFN1Ym1pdFBheWxvYWQuZGF0YUlkID0gZGF0YUlkO1xyXG4gICAgY2FuY2VsU3VibWl0UGF5bG9hZC5iaXpEZWZLZXkgPSBiaXpEZWZLZXk7XHJcbiAgICByZXR1cm4gdGhpcy5jYW5jZWxTdWJtaXQoY2FuY2VsU3VibWl0UGF5bG9hZCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDmibnph4/mj5DkuqTlrqHmiblcclxuICAgKiBAcGFyYW0gZGF0YUlkcyDooajljZVJROmbhuWQiFxyXG4gICAqIEBwYXJhbSBiaXpEZWZLZXkg5YWl5Y+j5Y2V5o2uaWRcclxuICAgKi9cclxuICBiYXRjaFN1Ym1pdFdpdGhCaXpEZWZLZXkoZGF0YUlkczogc3RyaW5nW10sIGJpekRlZktleTogc3RyaW5nKTogT2JzZXJ2YWJsZTxhbnk+IHtcclxuICAgIGlmICghZGF0YUlkcykge1xyXG4gICAgICB0aGlzLm5vdGlmeVNlcnZpY2UuZXJyb3IoJ2RhdGFJZOS4jeiDveS4uuepuicpO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBpZiAoIWRhdGFJZHMubGVuZ3RoKSB7XHJcbiAgICAgIHRoaXMubm90aWZ5U2VydmljZS5lcnJvcign6K+36YCJ5oup5pWw5o2uJyk7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIGlmICghYml6RGVmS2V5KSB7XHJcbiAgICAgIHRoaXMubm90aWZ5U2VydmljZS5lcnJvcign5YWl5Y+j5Y2V5o2uSUTkuI3og73kuLrnqbonKTtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgaWYgKGRhdGFJZHMubGVuZ3RoID09PSAxKSB7XHJcbiAgICAgIHZhciBzdGFydFBheWxvYWQgPSBuZXcgU3RhcnRQcm9jZXNzUGF5bG9hZCgpXHJcbiAgICAgIHN0YXJ0UGF5bG9hZC5iaXpEZWZLZXkgPSBiaXpEZWZLZXk7XHJcbiAgICAgIHN0YXJ0UGF5bG9hZC5kYXRhSWQgPSBkYXRhSWRzWzBdO1xyXG4gICAgICByZXR1cm4gdGhpcy5zdGFydFByb2Nlc3Moc3RhcnRQYXlsb2FkKTtcclxuICAgIH1cclxuXHJcbiAgICB2YXIgc3VjY2Vzc051bTogbnVtYmVyID0gMDtcclxuICAgIHZhciBmYWlsZWROdW06IG51bWJlciA9IDA7XHJcbiAgICBjb25zdCBzdWJqZWN0ID0gbmV3IFN1YmplY3QoKTtcclxuICAgIHRoaXMubG9hZGluZ1NlcnZpY2Uuc2hvdygpO1xyXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBkYXRhSWRzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgIHZhciBzdGFydFBheWxvYWQgPSBuZXcgU3RhcnRQcm9jZXNzUGF5bG9hZCgpXHJcbiAgICAgIHN0YXJ0UGF5bG9hZC5iaXpEZWZLZXkgPSBiaXpEZWZLZXk7XHJcbiAgICAgIHN0YXJ0UGF5bG9hZC5kYXRhSWQgPSBkYXRhSWRzW2ldO1xyXG4gICAgICBzdGFydFBheWxvYWQudmFyaWFibGVzID0geyBzaW11bGF0ZTogZmFsc2UgfTtcclxuICAgICAgdGhpcy50YXNrU2VydmljZS5zdGFydFByb2Nlc3Moc3RhcnRQYXlsb2FkKS5zdWJzY3JpYmUoKHJlc3BvbnNlOiBhbnkpID0+IHtcclxuICAgICAgICBpZiAocmVzcG9uc2UucHJvY0RlZnMubGVuZ3RoID4gMSB8fCByZXNwb25zZS5uZXh0Rmxvd05vZGVzLmxlbmd0aCA+IDEpIHsgLy/lrZjlnKjlpJrkuKrmtYHnqIvvvIzljZXni6zmj5DkuqQvL+WkmuS4quiKgueCue+8jOWNleeLrOaPkOS6pFxyXG4gICAgICAgICAgZmFpbGVkTnVtKys7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIHN1Y2Nlc3NOdW0rKztcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHN1Y2Nlc3NOdW0gKyBmYWlsZWROdW0gPT09IGRhdGFJZHMubGVuZ3RoKSB7XHJcbiAgICAgICAgICB0aGlzLmxvYWRpbmdTZXJ2aWNlLmhpZGUoKTtcclxuICAgICAgICAgIHN1YmplY3QubmV4dCh0cnVlKTsvL+WFqOmDqOaJp+ihjOWujOWGjei/lOWbnlxyXG4gICAgICAgICAgdGhpcy5zaG93QmF0Y2hTdWJtaXRJbmZvKFwic3VibWl0XCIsIHN1Y2Nlc3NOdW0sIGZhaWxlZE51bSk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9LCAoKSA9PiB7XHJcbiAgICAgICAgZmFpbGVkTnVtKys7XHJcbiAgICAgICAgaWYgKHN1Y2Nlc3NOdW0gKyBmYWlsZWROdW0gPT09IGRhdGFJZHMubGVuZ3RoKSB7XHJcbiAgICAgICAgICB0aGlzLmxvYWRpbmdTZXJ2aWNlLmhpZGUoKTtcclxuICAgICAgICAgIHN1YmplY3QubmV4dChmYWxzZSk7Ly/lhajpg6jmiafooYzlrozlho3ov5Tlm55cclxuICAgICAgICAgIHRoaXMuc2hvd0JhdGNoU3VibWl0SW5mbyhcInN1Ym1pdFwiLCBzdWNjZXNzTnVtLCBmYWlsZWROdW0pO1xyXG4gICAgICAgIH1cclxuICAgICAgfSlcclxuICAgIH1cclxuICAgIHJldHVybiBzdWJqZWN0LmFzT2JzZXJ2YWJsZSgpO1xyXG4gIH1cclxuXHJcblxyXG4gIC8qKlxyXG4gICAqIOaJuemHj+WPlua2iOaPkOS6pOWuoeaJuVxyXG4gICAqIEBwYXJhbSBkYXRhSWRzIOihqOWNlUlE6ZuG5ZCIXHJcbiAgICogQHBhcmFtIGJpekRlZktleSDlhaXlj6PljZXmja5pZFxyXG4gICAqL1xyXG4gIGJhdGNoQ2FuY2VsU3VibWl0V2l0aERhdGFJZChkYXRhSWRzOiBzdHJpbmdbXSwgYml6RGVmS2V5OiBzdHJpbmcpOiBPYnNlcnZhYmxlPGFueT4ge1xyXG4gICAgaWYgKCFkYXRhSWRzKSB7XHJcbiAgICAgIHRoaXMubm90aWZ5U2VydmljZS5lcnJvcignZGF0YUlk5LiN6IO95Li656m6Jyk7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIGlmICghZGF0YUlkcy5sZW5ndGgpIHtcclxuICAgICAgdGhpcy5ub3RpZnlTZXJ2aWNlLmVycm9yKCfor7fpgInmi6nmlbDmja4nKTtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgaWYgKCFiaXpEZWZLZXkpIHtcclxuICAgICAgdGhpcy5ub3RpZnlTZXJ2aWNlLmVycm9yKCflhaXlj6PljZXmja5JROS4jeiDveS4uuepuicpO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBjb25zdCBzdWJqZWN0ID0gbmV3IFN1YmplY3QoKTtcclxuICAgIHZhciBzdWNjZXNzTnVtOiBudW1iZXIgPSAwO1xyXG4gICAgdmFyIGZhaWxlZE51bTogbnVtYmVyID0gMDtcclxuICAgIHRoaXMubG9hZGluZ1NlcnZpY2Uuc2hvdygpO1xyXG5cclxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZGF0YUlkcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICB2YXIgY2FuY2VsU3VibWl0UGF5bG9hZCA9IG5ldyBDYW5jZWxTdWJtaXRQYXlsb2FkKCk7XHJcbiAgICAgIGNhbmNlbFN1Ym1pdFBheWxvYWQuZGF0YUlkID0gZGF0YUlkc1tpXTtcclxuICAgICAgY2FuY2VsU3VibWl0UGF5bG9hZC5iaXpEZWZLZXkgPSBiaXpEZWZLZXk7XHJcbiAgICAgIHRoaXMudGFza1NlcnZpY2UuY2FuY2VsU3VibWl0KGNhbmNlbFN1Ym1pdFBheWxvYWQpLnN1YnNjcmliZShyZSA9PiB7XHJcbiAgICAgICAgc3VjY2Vzc051bSsrO1xyXG4gICAgICAgIGlmIChzdWNjZXNzTnVtICsgZmFpbGVkTnVtID09PSBkYXRhSWRzLmxlbmd0aCkge1xyXG4gICAgICAgICAgdGhpcy5sb2FkaW5nU2VydmljZS5oaWRlKCk7XHJcbiAgICAgICAgICBzdWJqZWN0Lm5leHQodHJ1ZSk7XHJcbiAgICAgICAgICB0aGlzLnNob3dCYXRjaFN1Ym1pdEluZm8oXCJjYW5jZWxcIiwgc3VjY2Vzc051bSwgZmFpbGVkTnVtKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0sICgpID0+IHtcclxuICAgICAgICBmYWlsZWROdW0rKztcclxuICAgICAgICBpZiAoc3VjY2Vzc051bSArIGZhaWxlZE51bSA9PT0gZGF0YUlkcy5sZW5ndGgpIHtcclxuICAgICAgICAgIHRoaXMubG9hZGluZ1NlcnZpY2UuaGlkZSgpO1xyXG4gICAgICAgICAgc3ViamVjdC5uZXh0KGZhbHNlKTtcclxuICAgICAgICAgIHRoaXMuc2hvd0JhdGNoU3VibWl0SW5mbyhcImNhbmNlbFwiLCBzdWNjZXNzTnVtLCBmYWlsZWROdW0pO1xyXG4gICAgICAgIH1cclxuICAgICAgfSlcclxuICAgIH1cclxuICAgIHJldHVybiBzdWJqZWN0LmFzT2JzZXJ2YWJsZSgpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAqIOWtkOihqOaPkOS6pOWuoeaJuVxyXG4gKiBAcGFyYW0gcGFyZW50RGF0YUlkIOS4u+ihqGlkXHJcbiAqIEBwYXJhbSBjaGlsZERhdGFJZCDlrZDooahpZFxyXG4gKiBAcGFyYW0gYml6RGVmS2V5IOWFpeWPo+WNleaNrmlkXHJcbiAqL1xyXG4gIGNoaWxkU3VibWl0KHBhcmVudERhdGFJZDogc3RyaW5nLCBjaGlsZERhdGFJZDogc3RyaW5nLCBiaXpEZWZLZXk6IHN0cmluZyk6IE9ic2VydmFibGU8YW55PiB7XHJcbiAgICBpZiAoIXBhcmVudERhdGFJZCB8fCAhY2hpbGREYXRhSWQpIHtcclxuICAgICAgdGhpcy5ub3RpZnlTZXJ2aWNlLmVycm9yKCdkYXRhSWTkuI3og73kuLrnqbonKTtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgaWYgKCFiaXpEZWZLZXkpIHtcclxuICAgICAgdGhpcy5ub3RpZnlTZXJ2aWNlLmVycm9yKCflhaXlj6PljZXmja5JROS4jeiDveS4uuepuicpO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICB2YXIgc3RhcnRQcm9jZXNzUGF5bG9hZCA9IG5ldyBTdGFydFByb2Nlc3NQYXlsb2FkKCk7XHJcbiAgICBzdGFydFByb2Nlc3NQYXlsb2FkLmRhdGFJZCA9IGAke3BhcmVudERhdGFJZH0sJHtjaGlsZERhdGFJZH1gO1xyXG4gICAgc3RhcnRQcm9jZXNzUGF5bG9hZC5iaXpEZWZLZXkgPSBiaXpEZWZLZXk7XHJcbiAgICByZXR1cm4gdGhpcy5zdGFydFByb2Nlc3Moc3RhcnRQcm9jZXNzUGF5bG9hZCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICog5a2Q6KGo5Y+W5raI5o+Q5Lqk5a6h5om5XHJcbiAqIEBwYXJhbSBwYXJlbnREYXRhSWQg5Li76KGoaWRcclxuICogQHBhcmFtIGNoaWxkRGF0YUlkIOWtkOihqGlkXHJcbiAqIEBwYXJhbSBiaXpEZWZLZXkg5YWl5Y+j5Y2V5o2uaWRcclxuICovXHJcbiAgY2hpbGRDYW5jZWxTdWJtaXQocGFyZW50RGF0YUlkOiBzdHJpbmcsIGNoaWxkRGF0YUlkOiBzdHJpbmcsIGJpekRlZktleTogc3RyaW5nKTogT2JzZXJ2YWJsZTxhbnk+IHtcclxuICAgIGlmICghcGFyZW50RGF0YUlkIHx8ICFjaGlsZERhdGFJZCkge1xyXG4gICAgICB0aGlzLm5vdGlmeVNlcnZpY2UuZXJyb3IoJ2RhdGFJZOS4jeiDveS4uuepuicpO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBpZiAoIWJpekRlZktleSkge1xyXG4gICAgICB0aGlzLm5vdGlmeVNlcnZpY2UuZXJyb3IoJ+WFpeWPo+WNleaNrklE5LiN6IO95Li656m6Jyk7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIHZhciBjYW5jZWxTdWJtaXRQYXlsb2FkID0gbmV3IENhbmNlbFN1Ym1pdFBheWxvYWQoKTtcclxuICAgIGNhbmNlbFN1Ym1pdFBheWxvYWQuZGF0YUlkID0gYCR7cGFyZW50RGF0YUlkfSwke2NoaWxkRGF0YUlkfWA7XHJcbiAgICBjYW5jZWxTdWJtaXRQYXlsb2FkLmJpekRlZktleSA9IGJpekRlZktleTtcclxuICAgIHJldHVybiB0aGlzLmNhbmNlbFN1Ym1pdChjYW5jZWxTdWJtaXRQYXlsb2FkKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gKiDlrZDooajmibnph4/mj5DkuqTlrqHmiblcclxuICogQHBhcmFtIHBhcmVudERhdGFJZCDkuLvooahpZFxyXG4gKiBAcGFyYW0gY2hpbGREYXRhSWRzIOWtkOihqGlk6ZuG5ZCIXHJcbiAqIEBwYXJhbSBiaXpEZWZLZXkg5YWl5Y+j5Y2V5o2uaWRcclxuICovXHJcbiAgY2hpbGRCYXRjaFN1Ym1pdChwYXJlbnREYXRhSWQ6IHN0cmluZywgY2hpbGREYXRhSWRzOiBzdHJpbmdbXSwgYml6RGVmS2V5OiBzdHJpbmcpOiBPYnNlcnZhYmxlPGFueT4ge1xyXG4gICAgaWYgKCFwYXJlbnREYXRhSWQgfHwgIWNoaWxkRGF0YUlkcykge1xyXG4gICAgICB0aGlzLm5vdGlmeVNlcnZpY2UuZXJyb3IoJ2RhdGFJZOS4jeiDveS4uuepuicpO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBpZiAoIWJpekRlZktleSkge1xyXG4gICAgICB0aGlzLm5vdGlmeVNlcnZpY2UuZXJyb3IoJ+WFpeWPo+WNleaNrklE5LiN6IO95Li656m6Jyk7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIGNvbnN0IGRhdGFJZHMgPSBjaGlsZERhdGFJZHMubWFwKGNoaWxkRGF0YUlkID0+IGAke3BhcmVudERhdGFJZH0sJHtjaGlsZERhdGFJZH1gKTtcclxuICAgIHJldHVybiB0aGlzLmJhdGNoU3VibWl0V2l0aEJpekRlZktleShkYXRhSWRzLCBiaXpEZWZLZXkpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAqIOWtkOihqOaJuemHj+WPlua2iOaPkOS6pOWuoeaJuVxyXG4gKiBAcGFyYW0gcGFyZW50RGF0YUlkIOS4u+ihqGlkXHJcbiAqIEBwYXJhbSBjaGlsZERhdGFJZHMg5a2Q6KGoaWTpm4blkIhcclxuICogQHBhcmFtIGJpekRlZktleSDlhaXlj6PljZXmja5pZFxyXG4gKi9cclxuICBjaGlsZEJhdGNoQ2FuY2VsU3VibWl0KHBhcmVudERhdGFJZDogc3RyaW5nLCBjaGlsZERhdGFJZHM6IHN0cmluZ1tdLCBiaXpEZWZLZXk6IHN0cmluZyk6IE9ic2VydmFibGU8YW55PiB7XHJcbiAgICBpZiAoIXBhcmVudERhdGFJZCB8fCAhY2hpbGREYXRhSWRzKSB7XHJcbiAgICAgIHRoaXMubm90aWZ5U2VydmljZS5lcnJvcignZGF0YUlk5LiN6IO95Li656m6Jyk7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIGlmICghYml6RGVmS2V5KSB7XHJcbiAgICAgIHRoaXMubm90aWZ5U2VydmljZS5lcnJvcign5YWl5Y+j5Y2V5o2uSUTkuI3og73kuLrnqbonKTtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgY29uc3QgZGF0YUlkcyA9IGNoaWxkRGF0YUlkcy5tYXAoY2hpbGREYXRhSWQgPT4gYCR7cGFyZW50RGF0YUlkfSwke2NoaWxkRGF0YUlkfWApO1xyXG4gICAgcmV0dXJuIHRoaXMuYmF0Y2hDYW5jZWxTdWJtaXRXaXRoRGF0YUlkKGRhdGFJZHMsIGJpekRlZktleSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICog5om56YeP5o+Q5Lqk44CB5Y+W5raI5o+Q5Lqk5o+Q56S65L+h5oGvXHJcbiAqL1xyXG4gIHByaXZhdGUgc2hvd0JhdGNoU3VibWl0SW5mbyhhY3Rpb25Db2RlOiBzdHJpbmcsIHN1Y2Nlc3NOdW06IG51bWJlciwgZmFpbGVkTnVtOiBudW1iZXIpIHtcclxuICAgIGlmIChzdWNjZXNzTnVtICYmICFmYWlsZWROdW0pIHsvL+aJuemHj+WFqOmDqOaIkOWKn1xyXG4gICAgICBhY3Rpb25Db2RlID09PSBcInN1Ym1pdFwiICYmIHRoaXMubm90aWZ5U2VydmljZS5zdWNjZXNzKCfmj5DkuqTlrqHmibnmiJDlip/vvIEnKTtcclxuICAgICAgYWN0aW9uQ29kZSA9PT0gXCJjYW5jZWxcIiAmJiB0aGlzLm5vdGlmeVNlcnZpY2Uuc3VjY2Vzcygn5Y+W5raI5o+Q5Lqk5oiQ5Yqf77yBJyk7XHJcbiAgICB9XHJcbiAgICBpZiAoc3VjY2Vzc051bSAmJiBmYWlsZWROdW0pIHsvL+aJuemHj+acieaIkOWKn+acieWksei0pVxyXG4gICAgICB0aGlzLm5vdGlmeVNlcnZpY2Uud2FybmluZyhg5pON5L2c5oiQ5YqfJHtzdWNjZXNzTnVtfeadoe+8jOWksei0pSR7ZmFpbGVkTnVtfeadoSFgKTtcclxuICAgIH1cclxuICAgIGlmICghc3VjY2Vzc051bSAmJiBmYWlsZWROdW0pIHsvL+aJuemHj+WFqOmDqOWksei0pVxyXG4gICAgICBhY3Rpb25Db2RlID09PSBcInN1Ym1pdFwiICYmIHRoaXMubm90aWZ5U2VydmljZS5lcnJvcign5o+Q5Lqk5a6h5om55aSx6LSl77yBJyk7XHJcbiAgICAgIGFjdGlvbkNvZGUgPT09IFwiY2FuY2VsXCIgJiYgdGhpcy5ub3RpZnlTZXJ2aWNlLmVycm9yKCflj5bmtojmj5DkuqTlpLHotKXvvIEnKTtcclxuICAgIH1cclxuICB9XHJcblxyXG59XHJcbiJdfQ==