/**
 * @fileoverview added by tsickle
 * Generated from: lib/data-services/create-data.service.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { tap } from 'rxjs/operators';
import { BaseDataService } from './base-data.service';
import { DataUtil } from './data-util';
/**
 * 新增数据服务类
 */
export class CreateDataService extends BaseDataService {
    /**
     * @param {?} viewModelContext
     */
    constructor(viewModelContext) {
        super(viewModelContext);
    }
    /**
     * 新增数据
     * @return {?}
     */
    create() {
        this.befRepository.entityCollection.clear();
        DataUtil.clearFromValidateType(this.viewModelContext);
        this.loadingService.show();
        /** @type {?} */
        const create$ = this.befRepository.createEntity();
        return create$.pipe(tap((/**
         * @return {?}
         */
        () => {
            this.loadingService.hide();
        }), (/**
         * @param {?} exception
         * @return {?}
         */
        (exception) => {
            this.loadingService.hide();
        })));
    }
    /**
     * 新增后代节点
     * @param {?} path
     * @return {?}
     */
    createByPath(path) {
        this.loadingService.show();
        // 当前为新增
        /** @type {?} */
        const entityPath = DataUtil.convertBindingPathToEntityPath(path, this.viewModelContext);
        /** @type {?} */
        const append$ = this.befRepository.appendEntityByPath(entityPath);
        /** @type {?} */
        const result$ = append$.pipe(tap((/**
         * @param {?} e
         * @return {?}
         */
        (e) => {
            this.viewModelContext.uiState.setPropertyValue('$isAdd', { status: true, id: e['id'], path, child: Object.assign({}, e.data) });
            this.loadingService.hide();
        }), (/**
         * @param {?} exception
         * @return {?}
         */
        (exception) => {
            this.loadingService.hide();
        })));
        return result$;
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY3JlYXRlLWRhdGEuc2VydmljZS5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BmYXJyaXMvbW9iaWxlLWNvbW1hbmQtc2VydmljZXMvIiwic291cmNlcyI6WyJsaWIvZGF0YS1zZXJ2aWNlcy9jcmVhdGUtZGF0YS5zZXJ2aWNlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7O0FBQ0EsT0FBTyxFQUFFLEdBQUcsRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBR3JDLE9BQU8sRUFBRSxlQUFlLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQztBQUN0RCxPQUFPLEVBQUUsUUFBUSxFQUFFLE1BQU0sYUFBYSxDQUFDOzs7O0FBS3ZDLE1BQU0sT0FBTyxpQkFBa0IsU0FBUSxlQUFlOzs7O0lBRXBELFlBQVksZ0JBQWtDO1FBQzVDLEtBQUssQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDO0lBQzFCLENBQUM7Ozs7O0lBS00sTUFBTTtRQUNYLElBQUksQ0FBQyxhQUFhLENBQUMsZ0JBQWdCLENBQUMsS0FBSyxFQUFFLENBQUM7UUFDNUMsUUFBUSxDQUFDLHFCQUFxQixDQUFDLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDO1FBQ3RELElBQUksQ0FBQyxjQUFjLENBQUMsSUFBSSxFQUFFLENBQUM7O2NBQ3JCLE9BQU8sR0FBRyxJQUFJLENBQUMsYUFBYSxDQUFDLFlBQVksRUFBRTtRQUNqRCxPQUFPLE9BQU8sQ0FBQyxJQUFJLENBQ2pCLEdBQUc7OztRQUNELEdBQUcsRUFBRTtZQUNILElBQUksQ0FBQyxjQUFjLENBQUMsSUFBSSxFQUFFLENBQUM7UUFDN0IsQ0FBQzs7OztRQUNELENBQUMsU0FBYyxFQUFFLEVBQUU7WUFDakIsSUFBSSxDQUFDLGNBQWMsQ0FBQyxJQUFJLEVBQUUsQ0FBQztRQUM3QixDQUFDLEVBQ0YsQ0FDRixDQUFDO0lBQ0osQ0FBQzs7Ozs7O0lBS00sWUFBWSxDQUFDLElBQVk7UUFDOUIsSUFBSSxDQUFDLGNBQWMsQ0FBQyxJQUFJLEVBQUUsQ0FBQzs7O2NBRXJCLFVBQVUsR0FBRyxRQUFRLENBQUMsOEJBQThCLENBQUMsSUFBSSxFQUFFLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQzs7Y0FDakYsT0FBTyxHQUFHLElBQUksQ0FBQyxhQUFhLENBQUMsa0JBQWtCLENBQUMsVUFBVSxDQUFDOztjQUMzRCxPQUFPLEdBQUcsT0FBTyxDQUFDLElBQUksQ0FDMUIsR0FBRzs7OztRQUNELENBQUMsQ0FBQyxFQUFFLEVBQUU7WUFDSixJQUFJLENBQUMsZ0JBQWdCLENBQUMsT0FBTyxDQUFDLGdCQUFnQixDQUFDLFFBQVEsRUFBRSxFQUFFLE1BQU0sRUFBRSxJQUFJLEVBQUUsRUFBRSxFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsRUFBRSxJQUFJLEVBQUUsS0FBSyxvQkFBTyxDQUFDLENBQUMsSUFBSSxDQUFFLEVBQUUsQ0FBQyxDQUFDO1lBQ3BILElBQUksQ0FBQyxjQUFjLENBQUMsSUFBSSxFQUFFLENBQUM7UUFDN0IsQ0FBQzs7OztRQUNELENBQUMsU0FBYyxFQUFFLEVBQUU7WUFDakIsSUFBSSxDQUFDLGNBQWMsQ0FBQyxJQUFJLEVBQUUsQ0FBQztRQUM3QixDQUFDLEVBQ0YsQ0FDRjtRQUVELE9BQU8sT0FBTyxDQUFDO0lBQ2pCLENBQUM7Q0FFRiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE9ic2VydmFibGUgfSBmcm9tICdyeGpzJztcclxuaW1wb3J0IHsgdGFwIH0gZnJvbSAncnhqcy9vcGVyYXRvcnMnO1xyXG5pbXBvcnQgeyBFbnRpdHksIFZpZXdNb2RlbENvbnRleHQgfSBmcm9tICdAZmFycmlzL21vYmlsZS1kZXZraXQnO1xyXG5cclxuaW1wb3J0IHsgQmFzZURhdGFTZXJ2aWNlIH0gZnJvbSAnLi9iYXNlLWRhdGEuc2VydmljZSc7XHJcbmltcG9ydCB7IERhdGFVdGlsIH0gZnJvbSAnLi9kYXRhLXV0aWwnO1xyXG5cclxuLyoqXHJcbiAqIOaWsOWinuaVsOaNruacjeWKoeexu1xyXG4gKi9cclxuZXhwb3J0IGNsYXNzIENyZWF0ZURhdGFTZXJ2aWNlIGV4dGVuZHMgQmFzZURhdGFTZXJ2aWNlIHtcclxuXHJcbiAgY29uc3RydWN0b3Iodmlld01vZGVsQ29udGV4dDogVmlld01vZGVsQ29udGV4dCkge1xyXG4gICAgc3VwZXIodmlld01vZGVsQ29udGV4dCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDmlrDlop7mlbDmja5cclxuICAgKi9cclxuICBwdWJsaWMgY3JlYXRlKCk6IE9ic2VydmFibGU8RW50aXR5PiB7XHJcbiAgICB0aGlzLmJlZlJlcG9zaXRvcnkuZW50aXR5Q29sbGVjdGlvbi5jbGVhcigpO1xyXG4gICAgRGF0YVV0aWwuY2xlYXJGcm9tVmFsaWRhdGVUeXBlKHRoaXMudmlld01vZGVsQ29udGV4dCk7XHJcbiAgICB0aGlzLmxvYWRpbmdTZXJ2aWNlLnNob3coKTtcclxuICAgIGNvbnN0IGNyZWF0ZSQgPSB0aGlzLmJlZlJlcG9zaXRvcnkuY3JlYXRlRW50aXR5KCk7XHJcbiAgICByZXR1cm4gY3JlYXRlJC5waXBlKFxyXG4gICAgICB0YXAoXHJcbiAgICAgICAgKCkgPT4ge1xyXG4gICAgICAgICAgdGhpcy5sb2FkaW5nU2VydmljZS5oaWRlKCk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICAoZXhjZXB0aW9uOiBhbnkpID0+IHtcclxuICAgICAgICAgIHRoaXMubG9hZGluZ1NlcnZpY2UuaGlkZSgpO1xyXG4gICAgICAgIH1cclxuICAgICAgKVxyXG4gICAgKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOaWsOWinuWQjuS7o+iKgueCuVxyXG4gICAqL1xyXG4gIHB1YmxpYyBjcmVhdGVCeVBhdGgocGF0aDogc3RyaW5nKTogT2JzZXJ2YWJsZTxFbnRpdHk+IHtcclxuICAgIHRoaXMubG9hZGluZ1NlcnZpY2Uuc2hvdygpO1xyXG4gICAgLy8g5b2T5YmN5Li65paw5aKeXHJcbiAgICBjb25zdCBlbnRpdHlQYXRoID0gRGF0YVV0aWwuY29udmVydEJpbmRpbmdQYXRoVG9FbnRpdHlQYXRoKHBhdGgsIHRoaXMudmlld01vZGVsQ29udGV4dCk7XHJcbiAgICBjb25zdCBhcHBlbmQkID0gdGhpcy5iZWZSZXBvc2l0b3J5LmFwcGVuZEVudGl0eUJ5UGF0aChlbnRpdHlQYXRoKTtcclxuICAgIGNvbnN0IHJlc3VsdCQgPSBhcHBlbmQkLnBpcGUoXHJcbiAgICAgIHRhcChcclxuICAgICAgICAoZSkgPT4ge1xyXG4gICAgICAgICAgdGhpcy52aWV3TW9kZWxDb250ZXh0LnVpU3RhdGUuc2V0UHJvcGVydHlWYWx1ZSgnJGlzQWRkJywgeyBzdGF0dXM6IHRydWUsIGlkOiBlWydpZCddLCBwYXRoLCBjaGlsZDogeyAuLi5lLmRhdGEgfSB9KTtcclxuICAgICAgICAgIHRoaXMubG9hZGluZ1NlcnZpY2UuaGlkZSgpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgKGV4Y2VwdGlvbjogYW55KSA9PiB7XHJcbiAgICAgICAgICB0aGlzLmxvYWRpbmdTZXJ2aWNlLmhpZGUoKTtcclxuICAgICAgICB9XHJcbiAgICAgIClcclxuICAgICk7XHJcblxyXG4gICAgcmV0dXJuIHJlc3VsdCQ7XHJcbiAgfVxyXG5cclxufVxyXG4iXX0=