/**
 * @fileoverview added by tsickle
 * Generated from: lib/work-flow-service/submit/process-selector-vue/process-selector.service.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Subject } from 'rxjs';
import { StartProcessPayload, FlowNodeInfo } from '../../entity/start-process-payload';
import { SubmitApprove } from '@farris/mobile-business-ui';
export class ProcessSelectorService {
    /**
     * @param {?} taskService
     */
    constructor(taskService) {
        this.taskService = taskService;
        //候选下一环节
        this.processPlaceholder = '选择流程'; //选择流程placeholder
        //保存模拟流程后返回的内容，选择节点时使用
        this.assignInfos = [];
        //选择的下一环节ID，后续环节id的拼接
        this.selectedValues = ['clear'];
        this.payload = new StartProcessPayload; //保存表单上传来的payload
        //保存表单上传来的payload
        this.subject = new Subject();
        this.processReadOnly = false; //选择流程框是否只读
        //选择流程框是否只读
        this.nodeReadOnly = true; //选择节点下拉框是否只读
    }
    //弹框实例
    /**
     * @param {?} param
     * @return {?}
     */
    setParam(param) {
        this.payload.id = param.id;
        this.payload.processDefinitionId = param.processDefinitionId;
        this.payload.processDefinitionKey = param.processDefinitionKey;
        this.payload.bizDefKey = param.bizDefKey;
        this.payload.dataModelId = param.dataModelId;
        this.payload.dataId = param.dataId;
        this.payload.name = param.name;
        this.payload.startUserId = param.startUserId;
        this.payload.nextFlowNodes = [];
        this.startProcessSimulate(this.payload);
    }
    /**
     * @param {?} payload
     * @return {?}
     */
    startProcessSimulate(payload) {
        this.taskService.startProcessSimulate(payload).subscribe((/**
         * @param {?} response
         * @return {?}
         */
        (response) => {
            this.destProcesses = response.procDefs.map((/**
             * @param {?} process
             * @return {?}
             */
            process => ({ id: process.procDefId, name: process.procDefName })));
            if (this.destProcesses.length === 1) {
                this.processReadOnly = true;
                this.selectedProcessId = response.procDefs[0].procDefId;
                this.vm = ((/** @type {?} */ (SubmitApprove))).confirm({
                    process: this.selectedProcessId,
                    processData: this.destProcesses,
                    processOc: this.selectProcessChange.bind(this),
                    processReadFlag: this.processReadOnly,
                    processHolder: this.processPlaceholder,
                    nextNodeReadFlag: this.nodeReadOnly,
                    submit: this.submit.bind(this),
                    cancel: this.back.bind(this)
                });
                this.response = response;
                this.setNextNode(response);
            }
            else {
                this.vm = ((/** @type {?} */ (SubmitApprove))).confirm({
                    processData: this.destProcesses,
                    processOc: this.selectProcessChange.bind(this),
                    processReadFlag: this.processReadOnly,
                    processHolder: this.processPlaceholder,
                    nextNodeReadFlag: this.nodeReadOnly,
                    submit: this.submit.bind(this),
                    cancel: this.back.bind(this)
                });
            }
        }), (/**
         * @param {?} error
         * @return {?}
         */
        error => {
            this.subject.next({ type: 'error', message: error && error.response && error.response.data && error.response.data.Message || '提交失败' });
        }));
    }
    /**
     * 选择某个流程后
     * @param {?} data
     * @return {?}
     */
    selectProcessChange(data) {
        this.clearHelp();
        this.clearNode();
        this.selectedProcessId = data;
        /** @type {?} */
        var payload = new StartProcessPayload();
        payload.processDefinitionId = this.selectedProcessId;
        payload.dataId = this.payload.dataId;
        // const load = this.loadingService.show();
        this.taskService.startProcessSimulate(payload).subscribe((/**
         * @param {?} response
         * @return {?}
         */
        (response) => {
            // load.close();
            this.response = response;
            this.setNextNode(response);
        }), (/**
         * @param {?} error
         * @return {?}
         */
        error => {
            //load.close();
            this.subject.next({ type: 'error', message: error && error.response && error.response.data && error.response.data.Message || '该流程存在问题' });
        }));
    }
    /**
     * @param {?} data
     * @return {?}
     */
    getsimulationPathsIndexData(data) {
        return this.destNodes.findIndex((/**
         * @param {?} item
         * @return {?}
         */
        item => item.id === data));
    }
    /**
     * 选择节点后事件
     * @param {?} data
     * @return {?}
     */
    selectNodeChange(data) {
        this.clearHelp();
        this.clearAssignInfos();
        this.selectedNodeId = data;
        this.vm.open({
            nextNode: this.selectedNodeId,
        });
        //const nodeNames = data.data.name.split('，');
        /** @type {?} */
        const index = this.getsimulationPathsIndexData(data);
        if (this.response.simulationPaths[index].nodeInfoList.every((/**
         * @param {?} node
         * @return {?}
         */
        node => node.resolved === true))) { //已预解析参与者
            this.setAssignInfo(this.response.simulationPaths[index]);
        }
        else { //未预解析参与者
            //未预解析参与者
            /** @type {?} */
            let payload = new StartProcessPayload();
            payload.processDefinitionId = this.selectedProcessId;
            payload.dataId = this.payload.dataId;
            payload.nextFlowNodes = [];
            this.selectedNodeId.split('，').forEach((/**
             * @param {?} nodeId
             * @param {?} index
             * @return {?}
             */
            (nodeId, index) => {
                /** @type {?} */
                let nextFlowNode = new FlowNodeInfo();
                nextFlowNode.activityDefinitionId = nodeId;
                //nextFlowNode.activityDefinitionName = nodeNames[index];
                payload.nextFlowNodes.push(nextFlowNode);
            }));
            //const load = this.loadingService.show();
            this.taskService.startProcessSimulate(payload).subscribe((/**
             * @param {?} response
             * @return {?}
             */
            (response) => {
                //load.close();
                this.setAssignInfo(response.simulationPaths[0]); //选择的下一环节应该在同一条路径上，故取simulationPaths[0]
            }), (/**
             * @param {?} error
             * @return {?}
             */
            error => {
                //load.close();
                this.subject.next({ type: 'error', message: error && error.response && error.response.data && error.response.data.Message || '该节点存在问题' });
            }));
        }
    }
    /**
     * 设置下一环节
     * @private
     * @param {?} response
     * @return {?}
     */
    setNextNode(response) {
        this.destNodes = response.simulationPaths && response.simulationPaths.map((/**
         * @param {?} path
         * @return {?}
         */
        path => ({
            id: path.nodeInfoList.map((/**
             * @param {?} node
             * @return {?}
             */
            node => node.activityDefinitionId)).join('，'),
            name: path.nodeInfoList.map((/**
             * @param {?} node
             * @return {?}
             */
            node => node.activityDefinitionName)).join('，')
        })));
        //处理默认分支，无默认分支返回-1
        /** @type {?} */
        const defaultIndex = response.simulationPaths.findIndex((/**
         * @param {?} a
         * @return {?}
         */
        a => a.default));
        if (defaultIndex > -1) {
            this.destNodes.length === 1 ? (this.nodeReadOnly = true) : (this.nodeReadOnly = false);
            this.selectedNodeId = this.destNodes[defaultIndex].id;
            this.setAssignInfo(response.simulationPaths[defaultIndex]);
        }
        else {
            this.selectedNodeId = '';
            this.nodeReadOnly = false;
            this.nodePlaceholder = '请选择';
        }
        this.vm.open({
            nextNodeOc: this.selectNodeChange.bind(this),
            nextNode: this.selectedNodeId,
            nextNodeData: this.destNodes,
            nextNodeReadFlag: this.nodeReadOnly,
            nextNodeHolder: this.nodePlaceholder
        });
    }
    /**
     * 设置当前指派信息帮助参数
     * @private
     * @param {?} simulationPaths
     * @return {?}
     */
    setAssignInfo(simulationPaths) {
        this.assignInfos = [];
        this.selectedNodeId.split('，').forEach((/**
         * @param {?} nodeId
         * @return {?}
         */
        nodeId => {
            /** @type {?} */
            const node = simulationPaths.nodeInfoList.find((/**
             * @param {?} node
             * @return {?}
             */
            node => node.activityDefinitionId === nodeId));
            if (node) {
                /** @type {?} */
                const selectedAssignees = node.selectedAssignees;
                /** @type {?} */
                let assigneeReadFlag = false;
                /** @type {?} */
                let assignee = '';
                /** @type {?} */
                let assigneeHolder = '请选择人员';
                if (selectedAssignees && selectedAssignees.length >= 1) {
                    assigneeReadFlag = true;
                    assigneeHolder = "";
                    selectedAssignees.forEach((/**
                     * @param {?} user
                     * @return {?}
                     */
                    user => {
                        assignee = assignee + user.name + ', ';
                    }));
                    assignee = assignee.slice(0, assignee.length - 2);
                }
                if (node.anonymous) {
                    assignee = node.anonymousText === '' ? '' : node.anonymousText && node.anonymousText;
                }
                this.assignInfos.push({
                    label: `${this.selectedNodeId && this.selectedNodeId.split('，').length > 1 ? node.activityDefinitionName : ''}办理人员`,
                    selectedAssignees,
                    assigneeReadFlag,
                    assignee,
                    assigneeHolder,
                    assigneeInfo: Object.assign({}, node.assigneeInfo, { assigneeUsers: { items: (node.assigneeInfo && node.assigneeInfo.assigneeUsers) || [] } }),
                    assignees: node.selectedAssignees.map((/**
                     * @param {?} user
                     * @return {?}
                     */
                    user => { return { id: user.id, name: user.name }; })),
                    activityName: node.activityDefinitionName,
                    dependency: node.dependency,
                    anonymous: node.anonymous,
                    anonymousText: node.anonymousText
                });
            }
            else {
                this.assignInfos.push({
                    selectedAssignees: [],
                    assigneeInfo: null,
                    assignees: [],
                    activityName: '',
                    dependency: '',
                    anonymous: node.anonymous,
                    anonymousText: node.anonymousText
                });
            }
        }));
        this.vm.open({
            assigneeOc: this.assigneeOc.bind(this),
            assignInfos: this.assignInfos
        });
    }
    // 办理人员选择事件
    /**
     * @param {?} data
     * @param {?} index
     * @return {?}
     */
    assigneeOc(data, index) {
        this.assignInfos[index].assignees = data.items;
        this.selectedValues[index] = data.value;
        this.vm.open({
            selectedValues: this.selectedValues
        });
    }
    /**
     * @return {?}
     */
    clearHelp() {
        this.vm.open({
            selectedValues: ['clear']
        });
    }
    // 清空节点
    /**
     * @return {?}
     */
    clearNode() {
        this.selectedNodeId = '',
            this.destNodes = [],
            this.nodeReadOnly = true,
            this.nodePlaceholder = '',
            this.assignInfos = [];
        this.vm.open({
            nextNode: this.selectedNodeId,
            nextNodeData: this.destNodes,
            nextNodeReadFlag: this.nodeReadOnly,
            nodePlaceholder: this.nodePlaceholder,
            assignInfos: this.assignInfos
        });
    }
    // 清空办理人员
    /**
     * @return {?}
     */
    clearAssignInfos() {
        this.assignInfos = [];
        this.vm.open({
            assignInfos: this.assignInfos
        });
    }
    /**
     * 取消页面弹框
     * @return {?}
     */
    back() {
        this.clearProcess();
        this.subject.next({ type: 'success', message: '' });
    }
    /**
     * @return {?}
     */
    submit() {
        if (!this.selectedProcessId) {
            this.subject.next({ type: 'error', message: '请选流程' });
            return;
        }
        if (!this.selectedNodeId) {
            this.subject.next({ type: 'error', message: '请选节点' });
            return;
        }
        if (this.assignInfos.filter((/**
         * @param {?} info
         * @return {?}
         */
        info => ((info.assigneeInfo && info.assigneeInfo.assigneeUsers.items.length) || info.selectedAssignees.length) && !info.assignees.length)).length) {
            this.subject.next({ type: 'error', message: '请选办理人员' });
            return;
        }
        /** @type {?} */
        const nodes = this.selectedNodeId.split('，');
        for (let i = 0; i < nodes.length; i++) {
            /** @type {?} */
            let nextFlowNode = {
                activityDefinitionId: nodes[i],
                activityDefinitionName: this.assignInfos[i].activityName,
                dependency: this.assignInfos[i].dependency,
                selectedAssignees: this.assignInfos[i].assigneeInfo ? this.assignInfos[i].assignees : [],
                assigneeInfo: null,
                resolved: false,
                anonymous: false,
                anonymousText: ''
            };
            this.payload.nextFlowNodes.push(nextFlowNode);
        }
        this.payload.processDefinitionId = this.selectedProcessId;
        this.taskService.startProcess(this.payload).subscribe((/**
         * @return {?}
         */
        () => {
            this.clearProcess();
            this.subject.next({ type: 'success', message: '提交成功' });
        }), (/**
         * @param {?} error
         * @return {?}
         */
        (error) => {
            this.subject.next({ type: 'error', message: error && error.response && error.response.data && error.response.data.Message || '提交失败' });
        }));
    }
    /**
     * @return {?}
     */
    getSubject() {
        return this.subject.asObservable();
    }
    /**
     * @return {?}
     */
    clearProcess() {
        this.vm.close();
        this.vm = null;
        this.selectedProcessId = '';
        this.selectedNodeId = '';
        this.processReadOnly = false;
        this.nodeReadOnly = true;
    }
}
if (false) {
    /** @type {?} */
    ProcessSelectorService.prototype.destProcesses;
    /** @type {?} */
    ProcessSelectorService.prototype.destNodes;
    /** @type {?} */
    ProcessSelectorService.prototype.processPlaceholder;
    /** @type {?} */
    ProcessSelectorService.prototype.nodePlaceholder;
    /** @type {?} */
    ProcessSelectorService.prototype.response;
    /** @type {?} */
    ProcessSelectorService.prototype.assignInfos;
    /** @type {?} */
    ProcessSelectorService.prototype.selectedProcessId;
    /** @type {?} */
    ProcessSelectorService.prototype.selectedNodeId;
    /** @type {?} */
    ProcessSelectorService.prototype.selectedValues;
    /** @type {?} */
    ProcessSelectorService.prototype.payload;
    /** @type {?} */
    ProcessSelectorService.prototype.subject;
    /** @type {?} */
    ProcessSelectorService.prototype.processReadOnly;
    /** @type {?} */
    ProcessSelectorService.prototype.nodeReadOnly;
    /** @type {?} */
    ProcessSelectorService.prototype.vm;
    /**
     * @type {?}
     * @private
     */
    ProcessSelectorService.prototype.taskService;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicHJvY2Vzcy1zZWxlY3Rvci5zZXJ2aWNlLmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGZhcnJpcy9tb2JpbGUtY29tbWFuZC1zZXJ2aWNlcy8iLCJzb3VyY2VzIjpbImxpYi93b3JrLWZsb3ctc2VydmljZS9zdWJtaXQvcHJvY2Vzcy1zZWxlY3Rvci12dWUvcHJvY2Vzcy1zZWxlY3Rvci5zZXJ2aWNlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7O0FBQ0EsT0FBTyxFQUFFLE9BQU8sRUFBRSxNQUFNLE1BQU0sQ0FBQztBQUUvQixPQUFPLEVBQUUsbUJBQW1CLEVBQUUsWUFBWSxFQUFFLE1BQU0sb0NBQW9DLENBQUM7QUFJdkYsT0FBTyxFQUFFLGFBQWEsRUFBRSxNQUFNLDRCQUE0QixDQUFDO0FBRzNELE1BQU0sT0FBTyxzQkFBc0I7Ozs7SUFFakMsWUFDVSxXQUF3QjtRQUF4QixnQkFBVyxHQUFYLFdBQVcsQ0FBYTs7UUFNbEMsdUJBQWtCLEdBQVcsTUFBTSxDQUFDLENBQUEsaUJBQWlCOztRQUlyRCxnQkFBVyxHQUFHLEVBQUUsQ0FBQzs7UUFLakIsbUJBQWMsR0FBRyxDQUFDLE9BQU8sQ0FBQyxDQUFDO1FBRTNCLFlBQU8sR0FBRyxJQUFJLG1CQUFtQixDQUFDLENBQUEsaUJBQWlCOztRQUNuRCxZQUFPLEdBQUcsSUFBSSxPQUFPLEVBQUUsQ0FBQztRQUN4QixvQkFBZSxHQUFZLEtBQUssQ0FBQyxDQUFBLFdBQVc7O1FBQzVDLGlCQUFZLEdBQVksSUFBSSxDQUFDLENBQUEsYUFBYTtJQW5CdEMsQ0FBQzs7Ozs7O0lBdUJMLFFBQVEsQ0FBQyxLQUEwQjtRQUNqQyxJQUFJLENBQUMsT0FBTyxDQUFDLEVBQUUsR0FBRyxLQUFLLENBQUMsRUFBRSxDQUFDO1FBQzNCLElBQUksQ0FBQyxPQUFPLENBQUMsbUJBQW1CLEdBQUcsS0FBSyxDQUFDLG1CQUFtQixDQUFDO1FBQzdELElBQUksQ0FBQyxPQUFPLENBQUMsb0JBQW9CLEdBQUcsS0FBSyxDQUFDLG9CQUFvQixDQUFDO1FBQy9ELElBQUksQ0FBQyxPQUFPLENBQUMsU0FBUyxHQUFHLEtBQUssQ0FBQyxTQUFTLENBQUM7UUFDekMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxXQUFXLEdBQUcsS0FBSyxDQUFDLFdBQVcsQ0FBQztRQUM3QyxJQUFJLENBQUMsT0FBTyxDQUFDLE1BQU0sR0FBRyxLQUFLLENBQUMsTUFBTSxDQUFDO1FBQ25DLElBQUksQ0FBQyxPQUFPLENBQUMsSUFBSSxHQUFHLEtBQUssQ0FBQyxJQUFJLENBQUM7UUFDL0IsSUFBSSxDQUFDLE9BQU8sQ0FBQyxXQUFXLEdBQUcsS0FBSyxDQUFDLFdBQVcsQ0FBQztRQUM3QyxJQUFJLENBQUMsT0FBTyxDQUFDLGFBQWEsR0FBRyxFQUFFLENBQUM7UUFDaEMsSUFBSSxDQUFDLG9CQUFvQixDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQztJQUMxQyxDQUFDOzs7OztJQUVELG9CQUFvQixDQUFDLE9BQTRCO1FBQy9DLElBQUksQ0FBQyxXQUFXLENBQUMsb0JBQW9CLENBQUMsT0FBTyxDQUFDLENBQUMsU0FBUzs7OztRQUFDLENBQUMsUUFBMEIsRUFBRSxFQUFFO1lBQ3RGLElBQUksQ0FBQyxhQUFhLEdBQUcsUUFBUSxDQUFDLFFBQVEsQ0FBQyxHQUFHOzs7O1lBQUMsT0FBTyxDQUFDLEVBQUUsQ0FBQyxDQUFDLEVBQUUsRUFBRSxFQUFFLE9BQU8sQ0FBQyxTQUFTLEVBQUUsSUFBSSxFQUFFLE9BQU8sQ0FBQyxXQUFXLEVBQUUsQ0FBQyxFQUFDLENBQUM7WUFDOUcsSUFBSSxJQUFJLENBQUMsYUFBYSxDQUFDLE1BQU0sS0FBSyxDQUFDLEVBQUU7Z0JBQ25DLElBQUksQ0FBQyxlQUFlLEdBQUcsSUFBSSxDQUFDO2dCQUM1QixJQUFJLENBQUMsaUJBQWlCLEdBQUcsUUFBUSxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsQ0FBQyxTQUFTLENBQUM7Z0JBQ3hELElBQUksQ0FBQyxFQUFFLEdBQUcsQ0FBQyxtQkFBQSxhQUFhLEVBQU8sQ0FBQyxDQUFDLE9BQU8sQ0FDdEM7b0JBQ0UsT0FBTyxFQUFFLElBQUksQ0FBQyxpQkFBaUI7b0JBQy9CLFdBQVcsRUFBRSxJQUFJLENBQUMsYUFBYTtvQkFDL0IsU0FBUyxFQUFFLElBQUksQ0FBQyxtQkFBbUIsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDO29CQUM5QyxlQUFlLEVBQUUsSUFBSSxDQUFDLGVBQWU7b0JBQ3JDLGFBQWEsRUFBRSxJQUFJLENBQUMsa0JBQWtCO29CQUN0QyxnQkFBZ0IsRUFBRSxJQUFJLENBQUMsWUFBWTtvQkFDbkMsTUFBTSxFQUFFLElBQUksQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQztvQkFDOUIsTUFBTSxFQUFFLElBQUksQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQztpQkFDN0IsQ0FDRixDQUFBO2dCQUNELElBQUksQ0FBQyxRQUFRLEdBQUcsUUFBUSxDQUFDO2dCQUN6QixJQUFJLENBQUMsV0FBVyxDQUFDLFFBQVEsQ0FBQyxDQUFDO2FBQzVCO2lCQUFNO2dCQUNMLElBQUksQ0FBQyxFQUFFLEdBQUcsQ0FBQyxtQkFBQSxhQUFhLEVBQU8sQ0FBQyxDQUFDLE9BQU8sQ0FDdEM7b0JBQ0UsV0FBVyxFQUFFLElBQUksQ0FBQyxhQUFhO29CQUMvQixTQUFTLEVBQUUsSUFBSSxDQUFDLG1CQUFtQixDQUFDLElBQUksQ0FBQyxJQUFJLENBQUM7b0JBQzlDLGVBQWUsRUFBRSxJQUFJLENBQUMsZUFBZTtvQkFDckMsYUFBYSxFQUFFLElBQUksQ0FBQyxrQkFBa0I7b0JBQ3RDLGdCQUFnQixFQUFFLElBQUksQ0FBQyxZQUFZO29CQUNuQyxNQUFNLEVBQUUsSUFBSSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDO29CQUM5QixNQUFNLEVBQUUsSUFBSSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDO2lCQUM3QixDQUNGLENBQUE7YUFDRjtRQUNILENBQUM7Ozs7UUFBRSxLQUFLLENBQUMsRUFBRTtZQUNULElBQUksQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLEVBQUUsSUFBSSxFQUFFLE9BQU8sRUFBRSxPQUFPLEVBQUUsS0FBSyxJQUFJLEtBQUssQ0FBQyxRQUFRLElBQUksS0FBSyxDQUFDLFFBQVEsQ0FBQyxJQUFJLElBQUksS0FBSyxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsT0FBTyxJQUFJLE1BQU0sRUFBRSxDQUFDLENBQUM7UUFDekksQ0FBQyxFQUFDLENBQUE7SUFDSixDQUFDOzs7Ozs7SUFNRCxtQkFBbUIsQ0FBQyxJQUFTO1FBQzNCLElBQUksQ0FBQyxTQUFTLEVBQUUsQ0FBQztRQUNqQixJQUFJLENBQUMsU0FBUyxFQUFFLENBQUM7UUFDakIsSUFBSSxDQUFDLGlCQUFpQixHQUFHLElBQUksQ0FBQzs7WUFFMUIsT0FBTyxHQUFHLElBQUksbUJBQW1CLEVBQUU7UUFDdkMsT0FBTyxDQUFDLG1CQUFtQixHQUFHLElBQUksQ0FBQyxpQkFBaUIsQ0FBQztRQUNyRCxPQUFPLENBQUMsTUFBTSxHQUFHLElBQUksQ0FBQyxPQUFPLENBQUMsTUFBTSxDQUFDO1FBRXJDLDJDQUEyQztRQUMzQyxJQUFJLENBQUMsV0FBVyxDQUFDLG9CQUFvQixDQUFDLE9BQU8sQ0FBQyxDQUFDLFNBQVM7Ozs7UUFBQyxDQUFDLFFBQTBCLEVBQUUsRUFBRTtZQUN0RixnQkFBZ0I7WUFDaEIsSUFBSSxDQUFDLFFBQVEsR0FBRyxRQUFRLENBQUM7WUFDekIsSUFBSSxDQUFDLFdBQVcsQ0FBQyxRQUFRLENBQUMsQ0FBQztRQUM3QixDQUFDOzs7O1FBQUUsS0FBSyxDQUFDLEVBQUU7WUFDVCxlQUFlO1lBQ2YsSUFBSSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsRUFBRSxJQUFJLEVBQUUsT0FBTyxFQUFFLE9BQU8sRUFBRSxLQUFLLElBQUksS0FBSyxDQUFDLFFBQVEsSUFBSSxLQUFLLENBQUMsUUFBUSxDQUFDLElBQUksSUFBSSxLQUFLLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxPQUFPLElBQUksU0FBUyxFQUFFLENBQUMsQ0FBQztRQUM1SSxDQUFDLEVBQUMsQ0FBQTtJQUNKLENBQUM7Ozs7O0lBR0QsMkJBQTJCLENBQUMsSUFBSTtRQUM5QixPQUFPLElBQUksQ0FBQyxTQUFTLENBQUMsU0FBUzs7OztRQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsSUFBSSxDQUFDLEVBQUUsS0FBSyxJQUFJLEVBQUMsQ0FBQTtJQUMzRCxDQUFDOzs7Ozs7SUFLRCxnQkFBZ0IsQ0FBQyxJQUFTO1FBQ3hCLElBQUksQ0FBQyxTQUFTLEVBQUUsQ0FBQztRQUNqQixJQUFJLENBQUMsZ0JBQWdCLEVBQUUsQ0FBQztRQUN4QixJQUFJLENBQUMsY0FBYyxHQUFHLElBQUksQ0FBQztRQUMzQixJQUFJLENBQUMsRUFBRSxDQUFDLElBQUksQ0FBQztZQUNYLFFBQVEsRUFBRSxJQUFJLENBQUMsY0FBYztTQUM5QixDQUFDLENBQUE7OztjQUVJLEtBQUssR0FBRyxJQUFJLENBQUMsMkJBQTJCLENBQUMsSUFBSSxDQUFDO1FBQ3BELElBQUksSUFBSSxDQUFDLFFBQVEsQ0FBQyxlQUFlLENBQUMsS0FBSyxDQUFDLENBQUMsWUFBWSxDQUFDLEtBQUs7Ozs7UUFBQyxJQUFJLENBQUMsRUFBRSxDQUFDLElBQUksQ0FBQyxRQUFRLEtBQUssSUFBSSxFQUFDLEVBQUUsRUFBQyxTQUFTO1lBQ3JHLElBQUksQ0FBQyxhQUFhLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxlQUFlLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQztTQUMxRDthQUFNLEVBQUMsU0FBUzs7O2dCQUNYLE9BQU8sR0FBRyxJQUFJLG1CQUFtQixFQUFFO1lBQ3ZDLE9BQU8sQ0FBQyxtQkFBbUIsR0FBRyxJQUFJLENBQUMsaUJBQWlCLENBQUM7WUFDckQsT0FBTyxDQUFDLE1BQU0sR0FBRyxJQUFJLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBQztZQUNyQyxPQUFPLENBQUMsYUFBYSxHQUFHLEVBQUUsQ0FBQztZQUUzQixJQUFJLENBQUMsY0FBYyxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQyxPQUFPOzs7OztZQUFDLENBQUMsTUFBTSxFQUFFLEtBQUssRUFBRSxFQUFFOztvQkFDbkQsWUFBWSxHQUFHLElBQUksWUFBWSxFQUFFO2dCQUNyQyxZQUFZLENBQUMsb0JBQW9CLEdBQUcsTUFBTSxDQUFDO2dCQUMzQyx5REFBeUQ7Z0JBQ3pELE9BQU8sQ0FBQyxhQUFhLENBQUMsSUFBSSxDQUFDLFlBQVksQ0FBQyxDQUFDO1lBQzNDLENBQUMsRUFBQyxDQUFDO1lBRUgsMENBQTBDO1lBQzFDLElBQUksQ0FBQyxXQUFXLENBQUMsb0JBQW9CLENBQUMsT0FBTyxDQUFDLENBQUMsU0FBUzs7OztZQUFDLENBQUMsUUFBMEIsRUFBRSxFQUFFO2dCQUN0RixlQUFlO2dCQUNmLElBQUksQ0FBQyxhQUFhLENBQUMsUUFBUSxDQUFDLGVBQWUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUEsdUNBQXVDO1lBQ3pGLENBQUM7Ozs7WUFBRSxLQUFLLENBQUMsRUFBRTtnQkFDVCxlQUFlO2dCQUNmLElBQUksQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLEVBQUUsSUFBSSxFQUFFLE9BQU8sRUFBRSxPQUFPLEVBQUUsS0FBSyxJQUFJLEtBQUssQ0FBQyxRQUFRLElBQUksS0FBSyxDQUFDLFFBQVEsQ0FBQyxJQUFJLElBQUksS0FBSyxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsT0FBTyxJQUFJLFNBQVMsRUFBRSxDQUFDLENBQUM7WUFDNUksQ0FBQyxFQUFDLENBQUE7U0FDSDtJQUNILENBQUM7Ozs7Ozs7SUFLTyxXQUFXLENBQUMsUUFBMEI7UUFDNUMsSUFBSSxDQUFDLFNBQVMsR0FBRyxRQUFRLENBQUMsZUFBZSxJQUFJLFFBQVEsQ0FBQyxlQUFlLENBQUMsR0FBRzs7OztRQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQztZQUNqRixFQUFFLEVBQUUsSUFBSSxDQUFDLFlBQVksQ0FBQyxHQUFHOzs7O1lBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxJQUFJLENBQUMsb0JBQW9CLEVBQUMsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDO1lBQ3RFLElBQUksRUFBRSxJQUFJLENBQUMsWUFBWSxDQUFDLEdBQUc7Ozs7WUFBQyxJQUFJLENBQUMsRUFBRSxDQUFDLElBQUksQ0FBQyxzQkFBc0IsRUFBQyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUM7U0FDM0UsQ0FBQyxFQUFDLENBQUM7OztjQUVFLFlBQVksR0FBRyxRQUFRLENBQUMsZUFBZSxDQUFDLFNBQVM7Ozs7UUFBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxPQUFPLEVBQUM7UUFDdkUsSUFBSSxZQUFZLEdBQUcsQ0FBQyxDQUFDLEVBQUU7WUFDckIsSUFBSSxDQUFDLFNBQVMsQ0FBQyxNQUFNLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxZQUFZLEdBQUcsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLFlBQVksR0FBRyxLQUFLLENBQUMsQ0FBQztZQUN2RixJQUFJLENBQUMsY0FBYyxHQUFHLElBQUksQ0FBQyxTQUFTLENBQUMsWUFBWSxDQUFDLENBQUMsRUFBRSxDQUFDO1lBQ3RELElBQUksQ0FBQyxhQUFhLENBQUMsUUFBUSxDQUFDLGVBQWUsQ0FBQyxZQUFZLENBQUMsQ0FBQyxDQUFDO1NBQzVEO2FBQU07WUFDTCxJQUFJLENBQUMsY0FBYyxHQUFHLEVBQUUsQ0FBQztZQUN6QixJQUFJLENBQUMsWUFBWSxHQUFHLEtBQUssQ0FBQztZQUMxQixJQUFJLENBQUMsZUFBZSxHQUFHLEtBQUssQ0FBQztTQUM5QjtRQUNELElBQUksQ0FBQyxFQUFFLENBQUMsSUFBSSxDQUFDO1lBQ1gsVUFBVSxFQUFFLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDO1lBQzVDLFFBQVEsRUFBRSxJQUFJLENBQUMsY0FBYztZQUM3QixZQUFZLEVBQUUsSUFBSSxDQUFDLFNBQVM7WUFDNUIsZ0JBQWdCLEVBQUUsSUFBSSxDQUFDLFlBQVk7WUFDbkMsY0FBYyxFQUFFLElBQUksQ0FBQyxlQUFlO1NBQ3JDLENBQUMsQ0FBQTtJQUNKLENBQUM7Ozs7Ozs7SUFLTyxhQUFhLENBQUMsZUFBK0I7UUFDbkQsSUFBSSxDQUFDLFdBQVcsR0FBRyxFQUFFLENBQUM7UUFDdEIsSUFBSSxDQUFDLGNBQWMsQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLENBQUMsT0FBTzs7OztRQUFDLE1BQU0sQ0FBQyxFQUFFOztrQkFDeEMsSUFBSSxHQUFHLGVBQWUsQ0FBQyxZQUFZLENBQUMsSUFBSTs7OztZQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsSUFBSSxDQUFDLG9CQUFvQixLQUFLLE1BQU0sRUFBQztZQUM1RixJQUFJLElBQUksRUFBRTs7c0JBQ0YsaUJBQWlCLEdBQUcsSUFBSSxDQUFDLGlCQUFpQjs7b0JBQzVDLGdCQUFnQixHQUFHLEtBQUs7O29CQUN4QixRQUFRLEdBQUcsRUFBRTs7b0JBQ2IsY0FBYyxHQUFHLE9BQU87Z0JBQzVCLElBQUksaUJBQWlCLElBQUksaUJBQWlCLENBQUMsTUFBTSxJQUFJLENBQUMsRUFBRTtvQkFDdEQsZ0JBQWdCLEdBQUcsSUFBSSxDQUFDO29CQUN4QixjQUFjLEdBQUcsRUFBRSxDQUFDO29CQUNwQixpQkFBaUIsQ0FBQyxPQUFPOzs7O29CQUFDLElBQUksQ0FBQyxFQUFFO3dCQUMvQixRQUFRLEdBQUcsUUFBUSxHQUFHLElBQUksQ0FBQyxJQUFJLEdBQUcsSUFBSSxDQUFDO29CQUN6QyxDQUFDLEVBQUMsQ0FBQTtvQkFDRixRQUFRLEdBQUcsUUFBUSxDQUFDLEtBQUssQ0FBQyxDQUFDLEVBQUUsUUFBUSxDQUFDLE1BQU0sR0FBRyxDQUFDLENBQUMsQ0FBQTtpQkFDbEQ7Z0JBQ0QsSUFBSSxJQUFJLENBQUMsU0FBUyxFQUFFO29CQUNsQixRQUFRLEdBQUcsSUFBSSxDQUFDLGFBQWEsS0FBSyxFQUFFLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLGFBQWEsSUFBSSxJQUFJLENBQUMsYUFBYSxDQUFBO2lCQUNyRjtnQkFDRCxJQUFJLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBQztvQkFDcEIsS0FBSyxFQUFFLEdBQUcsSUFBSSxDQUFDLGNBQWMsSUFBSSxJQUFJLENBQUMsY0FBYyxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQyxNQUFNLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsc0JBQXNCLENBQUMsQ0FBQyxDQUFDLEVBQUUsTUFBTTtvQkFDbkgsaUJBQWlCO29CQUNqQixnQkFBZ0I7b0JBQ2hCLFFBQVE7b0JBQ1IsY0FBYztvQkFDZCxZQUFZLG9CQUFPLElBQUksQ0FBQyxZQUFZLElBQUUsYUFBYSxFQUFFLEVBQUUsS0FBSyxFQUFFLENBQUMsSUFBSSxDQUFDLFlBQVksSUFBSSxJQUFJLENBQUMsWUFBWSxDQUFDLGFBQWEsQ0FBQyxJQUFJLEVBQUUsRUFBRSxHQUFFO29CQUM5SCxTQUFTLEVBQUUsSUFBSSxDQUFDLGlCQUFpQixDQUFDLEdBQUc7Ozs7b0JBQUMsSUFBSSxDQUFDLEVBQUUsR0FBRyxPQUFPLEVBQUUsRUFBRSxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUUsSUFBSSxFQUFFLElBQUksQ0FBQyxJQUFJLEVBQUUsQ0FBQSxDQUFDLENBQUMsRUFBQztvQkFDMUYsWUFBWSxFQUFFLElBQUksQ0FBQyxzQkFBc0I7b0JBQ3pDLFVBQVUsRUFBRSxJQUFJLENBQUMsVUFBVTtvQkFDM0IsU0FBUyxFQUFFLElBQUksQ0FBQyxTQUFTO29CQUN6QixhQUFhLEVBQUUsSUFBSSxDQUFDLGFBQWE7aUJBQ2xDLENBQUMsQ0FBQTthQUNIO2lCQUFNO2dCQUNMLElBQUksQ0FBQyxXQUFXLENBQUMsSUFBSSxDQUFDO29CQUNwQixpQkFBaUIsRUFBRSxFQUFFO29CQUNyQixZQUFZLEVBQUUsSUFBSTtvQkFDbEIsU0FBUyxFQUFFLEVBQUU7b0JBQ2IsWUFBWSxFQUFFLEVBQUU7b0JBQ2hCLFVBQVUsRUFBRSxFQUFFO29CQUNkLFNBQVMsRUFBRSxJQUFJLENBQUMsU0FBUztvQkFDekIsYUFBYSxFQUFFLElBQUksQ0FBQyxhQUFhO2lCQUNsQyxDQUFDLENBQUE7YUFDSDtRQUNILENBQUMsRUFBQyxDQUFBO1FBQ0YsSUFBSSxDQUFDLEVBQUUsQ0FBQyxJQUFJLENBQUM7WUFDWCxVQUFVLEVBQUUsSUFBSSxDQUFDLFVBQVUsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDO1lBQ3RDLFdBQVcsRUFBRSxJQUFJLENBQUMsV0FBVztTQUM5QixDQUFDLENBQUE7SUFDSixDQUFDOzs7Ozs7O0lBR0QsVUFBVSxDQUFDLElBQVMsRUFBRSxLQUFhO1FBQ2pDLElBQUksQ0FBQyxXQUFXLENBQUMsS0FBSyxDQUFDLENBQUMsU0FBUyxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUM7UUFDL0MsSUFBSSxDQUFDLGNBQWMsQ0FBQyxLQUFLLENBQUMsR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDO1FBQ3hDLElBQUksQ0FBQyxFQUFFLENBQUMsSUFBSSxDQUFDO1lBQ1gsY0FBYyxFQUFFLElBQUksQ0FBQyxjQUFjO1NBQ3BDLENBQUMsQ0FBQTtJQUNKLENBQUM7Ozs7SUFFRCxTQUFTO1FBQ1AsSUFBSSxDQUFDLEVBQUUsQ0FBQyxJQUFJLENBQUM7WUFDWCxjQUFjLEVBQUUsQ0FBQyxPQUFPLENBQUM7U0FDMUIsQ0FBQyxDQUFBO0lBQ0osQ0FBQzs7Ozs7SUFHRCxTQUFTO1FBQ1AsSUFBSSxDQUFDLGNBQWMsR0FBRyxFQUFFO1lBQ3RCLElBQUksQ0FBQyxTQUFTLEdBQUcsRUFBRTtZQUNuQixJQUFJLENBQUMsWUFBWSxHQUFHLElBQUk7WUFDeEIsSUFBSSxDQUFDLGVBQWUsR0FBRyxFQUFFO1lBQ3pCLElBQUksQ0FBQyxXQUFXLEdBQUcsRUFBRSxDQUFDO1FBQ3hCLElBQUksQ0FBQyxFQUFFLENBQUMsSUFBSSxDQUFDO1lBQ1gsUUFBUSxFQUFFLElBQUksQ0FBQyxjQUFjO1lBQzdCLFlBQVksRUFBRSxJQUFJLENBQUMsU0FBUztZQUM1QixnQkFBZ0IsRUFBRSxJQUFJLENBQUMsWUFBWTtZQUNuQyxlQUFlLEVBQUUsSUFBSSxDQUFDLGVBQWU7WUFDckMsV0FBVyxFQUFFLElBQUksQ0FBQyxXQUFXO1NBQzlCLENBQUMsQ0FBQTtJQUNKLENBQUM7Ozs7O0lBR0QsZ0JBQWdCO1FBQ2QsSUFBSSxDQUFDLFdBQVcsR0FBRyxFQUFFLENBQUM7UUFDdEIsSUFBSSxDQUFDLEVBQUUsQ0FBQyxJQUFJLENBQUM7WUFDWCxXQUFXLEVBQUUsSUFBSSxDQUFDLFdBQVc7U0FDOUIsQ0FBQyxDQUFBO0lBQ0osQ0FBQzs7Ozs7SUFLRCxJQUFJO1FBQ0YsSUFBSSxDQUFDLFlBQVksRUFBRSxDQUFDO1FBQ3BCLElBQUksQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLEVBQUUsSUFBSSxFQUFFLFNBQVMsRUFBRSxPQUFPLEVBQUUsRUFBRSxFQUFFLENBQUMsQ0FBQztJQUN0RCxDQUFDOzs7O0lBRUQsTUFBTTtRQUNKLElBQUksQ0FBQyxJQUFJLENBQUMsaUJBQWlCLEVBQUU7WUFDM0IsSUFBSSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsRUFBRSxJQUFJLEVBQUUsT0FBTyxFQUFFLE9BQU8sRUFBRSxNQUFNLEVBQUUsQ0FBQyxDQUFDO1lBQ3RELE9BQU87U0FDUjtRQUNELElBQUksQ0FBQyxJQUFJLENBQUMsY0FBYyxFQUFFO1lBQ3hCLElBQUksQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLEVBQUUsSUFBSSxFQUFFLE9BQU8sRUFBRSxPQUFPLEVBQUUsTUFBTSxFQUFFLENBQUMsQ0FBQztZQUN0RCxPQUFPO1NBQ1I7UUFDRCxJQUFJLElBQUksQ0FBQyxXQUFXLENBQUMsTUFBTTs7OztRQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxZQUFZLElBQUksSUFBSSxDQUFDLFlBQVksQ0FBQyxhQUFhLENBQUMsS0FBSyxDQUFDLE1BQU0sQ0FBQyxJQUFJLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUMsTUFBTSxFQUFDLENBQUMsTUFBTSxFQUFFO1lBQzVLLElBQUksQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLEVBQUUsSUFBSSxFQUFFLE9BQU8sRUFBRSxPQUFPLEVBQUUsUUFBUSxFQUFFLENBQUMsQ0FBQztZQUN4RCxPQUFPO1NBQ1I7O2NBQ0ssS0FBSyxHQUFhLElBQUksQ0FBQyxjQUFjLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQztRQUN0RCxLQUFLLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsS0FBSyxDQUFDLE1BQU0sRUFBRSxDQUFDLEVBQUUsRUFBRTs7Z0JBQ2pDLFlBQVksR0FBaUI7Z0JBQy9CLG9CQUFvQixFQUFFLEtBQUssQ0FBQyxDQUFDLENBQUM7Z0JBQzlCLHNCQUFzQixFQUFFLElBQUksQ0FBQyxXQUFXLENBQUMsQ0FBQyxDQUFDLENBQUMsWUFBWTtnQkFDeEQsVUFBVSxFQUFFLElBQUksQ0FBQyxXQUFXLENBQUMsQ0FBQyxDQUFDLENBQUMsVUFBVTtnQkFDMUMsaUJBQWlCLEVBQUUsSUFBSSxDQUFDLFdBQVcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxZQUFZLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxXQUFXLENBQUMsQ0FBQyxDQUFDLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxFQUFFO2dCQUN4RixZQUFZLEVBQUUsSUFBSTtnQkFDbEIsUUFBUSxFQUFFLEtBQUs7Z0JBQ2YsU0FBUyxFQUFFLEtBQUs7Z0JBQ2hCLGFBQWEsRUFBRSxFQUFFO2FBQ2xCO1lBQ0QsSUFBSSxDQUFDLE9BQU8sQ0FBQyxhQUFhLENBQUMsSUFBSSxDQUFDLFlBQVksQ0FBQyxDQUFDO1NBQy9DO1FBQ0QsSUFBSSxDQUFDLE9BQU8sQ0FBQyxtQkFBbUIsR0FBRyxJQUFJLENBQUMsaUJBQWlCLENBQUM7UUFDMUQsSUFBSSxDQUFDLFdBQVcsQ0FBQyxZQUFZLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDLFNBQVM7OztRQUFDLEdBQUcsRUFBRTtZQUN6RCxJQUFJLENBQUMsWUFBWSxFQUFFLENBQUM7WUFDcEIsSUFBSSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsRUFBRSxJQUFJLEVBQUUsU0FBUyxFQUFFLE9BQU8sRUFBRSxNQUFNLEVBQUUsQ0FBQyxDQUFDO1FBQzFELENBQUM7Ozs7UUFBRSxDQUFDLEtBQUssRUFBRSxFQUFFO1lBQ1gsSUFBSSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsRUFBRSxJQUFJLEVBQUUsT0FBTyxFQUFFLE9BQU8sRUFBRSxLQUFLLElBQUksS0FBSyxDQUFDLFFBQVEsSUFBSSxLQUFLLENBQUMsUUFBUSxDQUFDLElBQUksSUFBSSxLQUFLLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxPQUFPLElBQUksTUFBTSxFQUFFLENBQUMsQ0FBQztRQUN6SSxDQUFDLEVBQUMsQ0FBQTtJQUNKLENBQUM7Ozs7SUFFRCxVQUFVO1FBQ1IsT0FBTyxJQUFJLENBQUMsT0FBTyxDQUFDLFlBQVksRUFBRSxDQUFDO0lBQ3JDLENBQUM7Ozs7SUFFRCxZQUFZO1FBQ1YsSUFBSSxDQUFDLEVBQUUsQ0FBQyxLQUFLLEVBQUUsQ0FBQztRQUNoQixJQUFJLENBQUMsRUFBRSxHQUFHLElBQUksQ0FBQztRQUNmLElBQUksQ0FBQyxpQkFBaUIsR0FBRyxFQUFFLENBQUE7UUFDM0IsSUFBSSxDQUFDLGNBQWMsR0FBRyxFQUFFLENBQUE7UUFDeEIsSUFBSSxDQUFDLGVBQWUsR0FBRyxLQUFLLENBQUM7UUFDN0IsSUFBSSxDQUFDLFlBQVksR0FBRSxJQUFJLENBQUM7SUFDMUIsQ0FBQztDQUNGOzs7SUE1VEMsK0NBQThDOztJQUM5QywyQ0FBMEM7O0lBRTFDLG9EQUFvQzs7SUFDcEMsaURBQXdCOztJQUN4QiwwQ0FBMkI7O0lBRTNCLDZDQUFpQjs7SUFFakIsbURBQTBCOztJQUMxQixnREFBdUI7O0lBRXZCLGdEQUEyQjs7SUFFM0IseUNBQWtDOztJQUNsQyx5Q0FBd0I7O0lBQ3hCLGlEQUFpQzs7SUFDakMsOENBQTZCOztJQUU3QixvQ0FBUTs7Ozs7SUF0Qk4sNkNBQWdDIiwic291cmNlc0NvbnRlbnQiOlsiXHJcbmltcG9ydCB7IFN1YmplY3QgfSBmcm9tICdyeGpzJztcclxuXHJcbmltcG9ydCB7IFN0YXJ0UHJvY2Vzc1BheWxvYWQsIEZsb3dOb2RlSW5mbyB9IGZyb20gJy4uLy4uL2VudGl0eS9zdGFydC1wcm9jZXNzLXBheWxvYWQnO1xyXG5pbXBvcnQgeyBTaW11bGF0ZVJlc3BvbnNlLCBTaW11bGF0aW9uUGF0aCB9IGZyb20gJy4uLy4uL2VudGl0eS9zaW11bGF0ZS1yZXNwb25zZSc7XHJcblxyXG5pbXBvcnQgeyBUYXNrU2VydmljZSB9IGZyb20gJy4uLy4uL3NlcnZpY2UvdGFzay5zZXJ2aWNlJztcclxuaW1wb3J0IHsgU3VibWl0QXBwcm92ZSB9IGZyb20gJ0BmYXJyaXMvbW9iaWxlLWJ1c2luZXNzLXVpJztcclxuXHJcblxyXG5leHBvcnQgY2xhc3MgUHJvY2Vzc1NlbGVjdG9yU2VydmljZSB7XHJcblxyXG4gIGNvbnN0cnVjdG9yKFxyXG4gICAgcHJpdmF0ZSB0YXNrU2VydmljZTogVGFza1NlcnZpY2VcclxuICApIHsgfVxyXG5cclxuICBkZXN0UHJvY2Vzc2VzOiB7IGlkOiBzdHJpbmcsIG5hbWU6IHN0cmluZyB9W107Ly/lgJnpgInmtYHnqItcclxuICBkZXN0Tm9kZXM6IHsgaWQ6IHN0cmluZywgbmFtZTogc3RyaW5nIH1bXTsvL+WAmemAieS4i+S4gOeOr+iKglxyXG5cclxuICBwcm9jZXNzUGxhY2Vob2xkZXI6IHN0cmluZyA9ICfpgInmi6nmtYHnqIsnOy8v6YCJ5oup5rWB56iLcGxhY2Vob2xkZXJcclxuICBub2RlUGxhY2Vob2xkZXI6IHN0cmluZzsvL+mAieaLqeS4i+S4gOeOr+iKgnBsYWNlaG9sZGVyXHJcbiAgcmVzcG9uc2U6IFNpbXVsYXRlUmVzcG9uc2U7Ly/kv53lrZjmqKHmi5/mtYHnqIvlkI7ov5Tlm57nmoTlhoXlrrnvvIzpgInmi6noioLngrnml7bkvb/nlKhcclxuXHJcbiAgYXNzaWduSW5mb3MgPSBbXTtcclxuXHJcbiAgc2VsZWN0ZWRQcm9jZXNzSWQ6IHN0cmluZzsvL+mAieaLqeeahOa1geeoi+WumuS5iUlEXHJcbiAgc2VsZWN0ZWROb2RlSWQ6IHN0cmluZzsgLy/pgInmi6nnmoTkuIvkuIDnjq/oioJJRO+8jOWQjue7reeOr+iKgmlk55qE5ou85o6lXHJcblxyXG4gIHNlbGVjdGVkVmFsdWVzID0gWydjbGVhciddO1xyXG5cclxuICBwYXlsb2FkID0gbmV3IFN0YXJ0UHJvY2Vzc1BheWxvYWQ7Ly/kv53lrZjooajljZXkuIrkvKDmnaXnmoRwYXlsb2FkXHJcbiAgc3ViamVjdCA9IG5ldyBTdWJqZWN0KCk7XHJcbiAgcHJvY2Vzc1JlYWRPbmx5OiBib29sZWFuID0gZmFsc2U7Ly/pgInmi6nmtYHnqIvmoYbmmK/lkKblj6ror7tcclxuICBub2RlUmVhZE9ubHk6IGJvb2xlYW4gPSB0cnVlOy8v6YCJ5oup6IqC54K55LiL5ouJ5qGG5piv5ZCm5Y+q6K+7XHJcblxyXG4gIHZtOiBhbnk7Ly/lvLnmoYblrp7kvotcclxuXHJcbiAgc2V0UGFyYW0ocGFyYW06IFN0YXJ0UHJvY2Vzc1BheWxvYWQpIHtcclxuICAgIHRoaXMucGF5bG9hZC5pZCA9IHBhcmFtLmlkO1xyXG4gICAgdGhpcy5wYXlsb2FkLnByb2Nlc3NEZWZpbml0aW9uSWQgPSBwYXJhbS5wcm9jZXNzRGVmaW5pdGlvbklkO1xyXG4gICAgdGhpcy5wYXlsb2FkLnByb2Nlc3NEZWZpbml0aW9uS2V5ID0gcGFyYW0ucHJvY2Vzc0RlZmluaXRpb25LZXk7XHJcbiAgICB0aGlzLnBheWxvYWQuYml6RGVmS2V5ID0gcGFyYW0uYml6RGVmS2V5O1xyXG4gICAgdGhpcy5wYXlsb2FkLmRhdGFNb2RlbElkID0gcGFyYW0uZGF0YU1vZGVsSWQ7XHJcbiAgICB0aGlzLnBheWxvYWQuZGF0YUlkID0gcGFyYW0uZGF0YUlkO1xyXG4gICAgdGhpcy5wYXlsb2FkLm5hbWUgPSBwYXJhbS5uYW1lO1xyXG4gICAgdGhpcy5wYXlsb2FkLnN0YXJ0VXNlcklkID0gcGFyYW0uc3RhcnRVc2VySWQ7XHJcbiAgICB0aGlzLnBheWxvYWQubmV4dEZsb3dOb2RlcyA9IFtdO1xyXG4gICAgdGhpcy5zdGFydFByb2Nlc3NTaW11bGF0ZSh0aGlzLnBheWxvYWQpO1xyXG4gIH1cclxuXHJcbiAgc3RhcnRQcm9jZXNzU2ltdWxhdGUocGF5bG9hZDogU3RhcnRQcm9jZXNzUGF5bG9hZCkge1xyXG4gICAgdGhpcy50YXNrU2VydmljZS5zdGFydFByb2Nlc3NTaW11bGF0ZShwYXlsb2FkKS5zdWJzY3JpYmUoKHJlc3BvbnNlOiBTaW11bGF0ZVJlc3BvbnNlKSA9PiB7XHJcbiAgICAgIHRoaXMuZGVzdFByb2Nlc3NlcyA9IHJlc3BvbnNlLnByb2NEZWZzLm1hcChwcm9jZXNzID0+ICh7IGlkOiBwcm9jZXNzLnByb2NEZWZJZCwgbmFtZTogcHJvY2Vzcy5wcm9jRGVmTmFtZSB9KSk7XHJcbiAgICAgIGlmICh0aGlzLmRlc3RQcm9jZXNzZXMubGVuZ3RoID09PSAxKSB7XHJcbiAgICAgICAgdGhpcy5wcm9jZXNzUmVhZE9ubHkgPSB0cnVlO1xyXG4gICAgICAgIHRoaXMuc2VsZWN0ZWRQcm9jZXNzSWQgPSByZXNwb25zZS5wcm9jRGVmc1swXS5wcm9jRGVmSWQ7XHJcbiAgICAgICAgdGhpcy52bSA9IChTdWJtaXRBcHByb3ZlIGFzIGFueSkuY29uZmlybShcclxuICAgICAgICAgIHtcclxuICAgICAgICAgICAgcHJvY2VzczogdGhpcy5zZWxlY3RlZFByb2Nlc3NJZCxcclxuICAgICAgICAgICAgcHJvY2Vzc0RhdGE6IHRoaXMuZGVzdFByb2Nlc3NlcyxcclxuICAgICAgICAgICAgcHJvY2Vzc09jOiB0aGlzLnNlbGVjdFByb2Nlc3NDaGFuZ2UuYmluZCh0aGlzKSxcclxuICAgICAgICAgICAgcHJvY2Vzc1JlYWRGbGFnOiB0aGlzLnByb2Nlc3NSZWFkT25seSxcclxuICAgICAgICAgICAgcHJvY2Vzc0hvbGRlcjogdGhpcy5wcm9jZXNzUGxhY2Vob2xkZXIsXHJcbiAgICAgICAgICAgIG5leHROb2RlUmVhZEZsYWc6IHRoaXMubm9kZVJlYWRPbmx5LFxyXG4gICAgICAgICAgICBzdWJtaXQ6IHRoaXMuc3VibWl0LmJpbmQodGhpcyksXHJcbiAgICAgICAgICAgIGNhbmNlbDogdGhpcy5iYWNrLmJpbmQodGhpcylcclxuICAgICAgICAgIH1cclxuICAgICAgICApXHJcbiAgICAgICAgdGhpcy5yZXNwb25zZSA9IHJlc3BvbnNlO1xyXG4gICAgICAgIHRoaXMuc2V0TmV4dE5vZGUocmVzcG9uc2UpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHRoaXMudm0gPSAoU3VibWl0QXBwcm92ZSBhcyBhbnkpLmNvbmZpcm0oXHJcbiAgICAgICAgICB7XHJcbiAgICAgICAgICAgIHByb2Nlc3NEYXRhOiB0aGlzLmRlc3RQcm9jZXNzZXMsXHJcbiAgICAgICAgICAgIHByb2Nlc3NPYzogdGhpcy5zZWxlY3RQcm9jZXNzQ2hhbmdlLmJpbmQodGhpcyksXHJcbiAgICAgICAgICAgIHByb2Nlc3NSZWFkRmxhZzogdGhpcy5wcm9jZXNzUmVhZE9ubHksXHJcbiAgICAgICAgICAgIHByb2Nlc3NIb2xkZXI6IHRoaXMucHJvY2Vzc1BsYWNlaG9sZGVyLFxyXG4gICAgICAgICAgICBuZXh0Tm9kZVJlYWRGbGFnOiB0aGlzLm5vZGVSZWFkT25seSxcclxuICAgICAgICAgICAgc3VibWl0OiB0aGlzLnN1Ym1pdC5iaW5kKHRoaXMpLFxyXG4gICAgICAgICAgICBjYW5jZWw6IHRoaXMuYmFjay5iaW5kKHRoaXMpXHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgKVxyXG4gICAgICB9XHJcbiAgICB9LCBlcnJvciA9PiB7XHJcbiAgICAgIHRoaXMuc3ViamVjdC5uZXh0KHsgdHlwZTogJ2Vycm9yJywgbWVzc2FnZTogZXJyb3IgJiYgZXJyb3IucmVzcG9uc2UgJiYgZXJyb3IucmVzcG9uc2UuZGF0YSAmJiBlcnJvci5yZXNwb25zZS5kYXRhLk1lc3NhZ2UgfHwgJ+aPkOS6pOWksei0pScgfSk7XHJcbiAgICB9KVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAqIOmAieaLqeafkOS4qua1geeoi+WQjlxyXG4gKiBAcGFyYW0gZGF0YVxyXG4gKi9cclxuICBzZWxlY3RQcm9jZXNzQ2hhbmdlKGRhdGE6IGFueSkge1xyXG4gICAgdGhpcy5jbGVhckhlbHAoKTtcclxuICAgIHRoaXMuY2xlYXJOb2RlKCk7XHJcbiAgICB0aGlzLnNlbGVjdGVkUHJvY2Vzc0lkID0gZGF0YTtcclxuXHJcbiAgICB2YXIgcGF5bG9hZCA9IG5ldyBTdGFydFByb2Nlc3NQYXlsb2FkKCk7XHJcbiAgICBwYXlsb2FkLnByb2Nlc3NEZWZpbml0aW9uSWQgPSB0aGlzLnNlbGVjdGVkUHJvY2Vzc0lkO1xyXG4gICAgcGF5bG9hZC5kYXRhSWQgPSB0aGlzLnBheWxvYWQuZGF0YUlkO1xyXG5cclxuICAgIC8vIGNvbnN0IGxvYWQgPSB0aGlzLmxvYWRpbmdTZXJ2aWNlLnNob3coKTtcclxuICAgIHRoaXMudGFza1NlcnZpY2Uuc3RhcnRQcm9jZXNzU2ltdWxhdGUocGF5bG9hZCkuc3Vic2NyaWJlKChyZXNwb25zZTogU2ltdWxhdGVSZXNwb25zZSkgPT4ge1xyXG4gICAgICAvLyBsb2FkLmNsb3NlKCk7XHJcbiAgICAgIHRoaXMucmVzcG9uc2UgPSByZXNwb25zZTtcclxuICAgICAgdGhpcy5zZXROZXh0Tm9kZShyZXNwb25zZSk7XHJcbiAgICB9LCBlcnJvciA9PiB7XHJcbiAgICAgIC8vbG9hZC5jbG9zZSgpO1xyXG4gICAgICB0aGlzLnN1YmplY3QubmV4dCh7IHR5cGU6ICdlcnJvcicsIG1lc3NhZ2U6IGVycm9yICYmIGVycm9yLnJlc3BvbnNlICYmIGVycm9yLnJlc3BvbnNlLmRhdGEgJiYgZXJyb3IucmVzcG9uc2UuZGF0YS5NZXNzYWdlIHx8ICfor6XmtYHnqIvlrZjlnKjpl67popgnIH0pO1xyXG4gICAgfSlcclxuICB9XHJcblxyXG5cclxuICBnZXRzaW11bGF0aW9uUGF0aHNJbmRleERhdGEoZGF0YSkge1xyXG4gICAgcmV0dXJuIHRoaXMuZGVzdE5vZGVzLmZpbmRJbmRleChpdGVtID0+IGl0ZW0uaWQgPT09IGRhdGEpXHJcbiAgfVxyXG5cclxuICAvKipcclxuICog6YCJ5oup6IqC54K55ZCO5LqL5Lu2XHJcbiAqL1xyXG4gIHNlbGVjdE5vZGVDaGFuZ2UoZGF0YTogYW55KSB7XHJcbiAgICB0aGlzLmNsZWFySGVscCgpO1xyXG4gICAgdGhpcy5jbGVhckFzc2lnbkluZm9zKCk7XHJcbiAgICB0aGlzLnNlbGVjdGVkTm9kZUlkID0gZGF0YTtcclxuICAgIHRoaXMudm0ub3Blbih7XHJcbiAgICAgIG5leHROb2RlOiB0aGlzLnNlbGVjdGVkTm9kZUlkLFxyXG4gICAgfSlcclxuICAgIC8vY29uc3Qgbm9kZU5hbWVzID0gZGF0YS5kYXRhLm5hbWUuc3BsaXQoJ++8jCcpO1xyXG4gICAgY29uc3QgaW5kZXggPSB0aGlzLmdldHNpbXVsYXRpb25QYXRoc0luZGV4RGF0YShkYXRhKTtcclxuICAgIGlmICh0aGlzLnJlc3BvbnNlLnNpbXVsYXRpb25QYXRoc1tpbmRleF0ubm9kZUluZm9MaXN0LmV2ZXJ5KG5vZGUgPT4gbm9kZS5yZXNvbHZlZCA9PT0gdHJ1ZSkpIHsvL+W3sumihOino+aekOWPguS4juiAhVxyXG4gICAgICB0aGlzLnNldEFzc2lnbkluZm8odGhpcy5yZXNwb25zZS5zaW11bGF0aW9uUGF0aHNbaW5kZXhdKTtcclxuICAgIH0gZWxzZSB7Ly/mnKrpooTop6PmnpDlj4LkuI7ogIVcclxuICAgICAgbGV0IHBheWxvYWQgPSBuZXcgU3RhcnRQcm9jZXNzUGF5bG9hZCgpO1xyXG4gICAgICBwYXlsb2FkLnByb2Nlc3NEZWZpbml0aW9uSWQgPSB0aGlzLnNlbGVjdGVkUHJvY2Vzc0lkO1xyXG4gICAgICBwYXlsb2FkLmRhdGFJZCA9IHRoaXMucGF5bG9hZC5kYXRhSWQ7XHJcbiAgICAgIHBheWxvYWQubmV4dEZsb3dOb2RlcyA9IFtdO1xyXG5cclxuICAgICAgdGhpcy5zZWxlY3RlZE5vZGVJZC5zcGxpdCgn77yMJykuZm9yRWFjaCgobm9kZUlkLCBpbmRleCkgPT4ge1xyXG4gICAgICAgIGxldCBuZXh0Rmxvd05vZGUgPSBuZXcgRmxvd05vZGVJbmZvKCk7XHJcbiAgICAgICAgbmV4dEZsb3dOb2RlLmFjdGl2aXR5RGVmaW5pdGlvbklkID0gbm9kZUlkO1xyXG4gICAgICAgIC8vbmV4dEZsb3dOb2RlLmFjdGl2aXR5RGVmaW5pdGlvbk5hbWUgPSBub2RlTmFtZXNbaW5kZXhdO1xyXG4gICAgICAgIHBheWxvYWQubmV4dEZsb3dOb2Rlcy5wdXNoKG5leHRGbG93Tm9kZSk7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgLy9jb25zdCBsb2FkID0gdGhpcy5sb2FkaW5nU2VydmljZS5zaG93KCk7XHJcbiAgICAgIHRoaXMudGFza1NlcnZpY2Uuc3RhcnRQcm9jZXNzU2ltdWxhdGUocGF5bG9hZCkuc3Vic2NyaWJlKChyZXNwb25zZTogU2ltdWxhdGVSZXNwb25zZSkgPT4ge1xyXG4gICAgICAgIC8vbG9hZC5jbG9zZSgpO1xyXG4gICAgICAgIHRoaXMuc2V0QXNzaWduSW5mbyhyZXNwb25zZS5zaW11bGF0aW9uUGF0aHNbMF0pOy8v6YCJ5oup55qE5LiL5LiA546v6IqC5bqU6K+l5Zyo5ZCM5LiA5p2h6Lev5b6E5LiK77yM5pWF5Y+Wc2ltdWxhdGlvblBhdGhzWzBdXHJcbiAgICAgIH0sIGVycm9yID0+IHtcclxuICAgICAgICAvL2xvYWQuY2xvc2UoKTtcclxuICAgICAgICB0aGlzLnN1YmplY3QubmV4dCh7IHR5cGU6ICdlcnJvcicsIG1lc3NhZ2U6IGVycm9yICYmIGVycm9yLnJlc3BvbnNlICYmIGVycm9yLnJlc3BvbnNlLmRhdGEgJiYgZXJyb3IucmVzcG9uc2UuZGF0YS5NZXNzYWdlIHx8ICfor6XoioLngrnlrZjlnKjpl67popgnIH0pO1xyXG4gICAgICB9KVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAqIOiuvue9ruS4i+S4gOeOr+iKglxyXG4gKi9cclxuICBwcml2YXRlIHNldE5leHROb2RlKHJlc3BvbnNlOiBTaW11bGF0ZVJlc3BvbnNlKSB7XHJcbiAgICB0aGlzLmRlc3ROb2RlcyA9IHJlc3BvbnNlLnNpbXVsYXRpb25QYXRocyAmJiByZXNwb25zZS5zaW11bGF0aW9uUGF0aHMubWFwKHBhdGggPT4gKHtcclxuICAgICAgaWQ6IHBhdGgubm9kZUluZm9MaXN0Lm1hcChub2RlID0+IG5vZGUuYWN0aXZpdHlEZWZpbml0aW9uSWQpLmpvaW4oJ++8jCcpLFxyXG4gICAgICBuYW1lOiBwYXRoLm5vZGVJbmZvTGlzdC5tYXAobm9kZSA9PiBub2RlLmFjdGl2aXR5RGVmaW5pdGlvbk5hbWUpLmpvaW4oJ++8jCcpXHJcbiAgICB9KSk7XHJcbiAgICAvL+WkhOeQhum7mOiupOWIhuaUr++8jOaXoOm7mOiupOWIhuaUr+i/lOWbni0xXHJcbiAgICBjb25zdCBkZWZhdWx0SW5kZXggPSByZXNwb25zZS5zaW11bGF0aW9uUGF0aHMuZmluZEluZGV4KGEgPT4gYS5kZWZhdWx0KTtcclxuICAgIGlmIChkZWZhdWx0SW5kZXggPiAtMSkge1xyXG4gICAgICB0aGlzLmRlc3ROb2Rlcy5sZW5ndGggPT09IDEgPyAodGhpcy5ub2RlUmVhZE9ubHkgPSB0cnVlKSA6ICh0aGlzLm5vZGVSZWFkT25seSA9IGZhbHNlKTtcclxuICAgICAgdGhpcy5zZWxlY3RlZE5vZGVJZCA9IHRoaXMuZGVzdE5vZGVzW2RlZmF1bHRJbmRleF0uaWQ7XHJcbiAgICAgIHRoaXMuc2V0QXNzaWduSW5mbyhyZXNwb25zZS5zaW11bGF0aW9uUGF0aHNbZGVmYXVsdEluZGV4XSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLnNlbGVjdGVkTm9kZUlkID0gJyc7XHJcbiAgICAgIHRoaXMubm9kZVJlYWRPbmx5ID0gZmFsc2U7XHJcbiAgICAgIHRoaXMubm9kZVBsYWNlaG9sZGVyID0gJ+ivt+mAieaLqSc7XHJcbiAgICB9XHJcbiAgICB0aGlzLnZtLm9wZW4oe1xyXG4gICAgICBuZXh0Tm9kZU9jOiB0aGlzLnNlbGVjdE5vZGVDaGFuZ2UuYmluZCh0aGlzKSxcclxuICAgICAgbmV4dE5vZGU6IHRoaXMuc2VsZWN0ZWROb2RlSWQsXHJcbiAgICAgIG5leHROb2RlRGF0YTogdGhpcy5kZXN0Tm9kZXMsXHJcbiAgICAgIG5leHROb2RlUmVhZEZsYWc6IHRoaXMubm9kZVJlYWRPbmx5LFxyXG4gICAgICBuZXh0Tm9kZUhvbGRlcjogdGhpcy5ub2RlUGxhY2Vob2xkZXJcclxuICAgIH0pXHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDorr7nva7lvZPliY3mjIfmtL7kv6Hmga/luK7liqnlj4LmlbBcclxuICAgKi9cclxuICBwcml2YXRlIHNldEFzc2lnbkluZm8oc2ltdWxhdGlvblBhdGhzOiBTaW11bGF0aW9uUGF0aCkge1xyXG4gICAgdGhpcy5hc3NpZ25JbmZvcyA9IFtdO1xyXG4gICAgdGhpcy5zZWxlY3RlZE5vZGVJZC5zcGxpdCgn77yMJykuZm9yRWFjaChub2RlSWQgPT4ge1xyXG4gICAgICBjb25zdCBub2RlID0gc2ltdWxhdGlvblBhdGhzLm5vZGVJbmZvTGlzdC5maW5kKG5vZGUgPT4gbm9kZS5hY3Rpdml0eURlZmluaXRpb25JZCA9PT0gbm9kZUlkKTtcclxuICAgICAgaWYgKG5vZGUpIHtcclxuICAgICAgICBjb25zdCBzZWxlY3RlZEFzc2lnbmVlcyA9IG5vZGUuc2VsZWN0ZWRBc3NpZ25lZXM7XHJcbiAgICAgICAgbGV0IGFzc2lnbmVlUmVhZEZsYWcgPSBmYWxzZTtcclxuICAgICAgICBsZXQgYXNzaWduZWUgPSAnJztcclxuICAgICAgICBsZXQgYXNzaWduZWVIb2xkZXIgPSAn6K+36YCJ5oup5Lq65ZGYJztcclxuICAgICAgICBpZiAoc2VsZWN0ZWRBc3NpZ25lZXMgJiYgc2VsZWN0ZWRBc3NpZ25lZXMubGVuZ3RoID49IDEpIHtcclxuICAgICAgICAgIGFzc2lnbmVlUmVhZEZsYWcgPSB0cnVlO1xyXG4gICAgICAgICAgYXNzaWduZWVIb2xkZXIgPSBcIlwiO1xyXG4gICAgICAgICAgc2VsZWN0ZWRBc3NpZ25lZXMuZm9yRWFjaCh1c2VyID0+IHtcclxuICAgICAgICAgICAgYXNzaWduZWUgPSBhc3NpZ25lZSArIHVzZXIubmFtZSArICcsICc7XHJcbiAgICAgICAgICB9KVxyXG4gICAgICAgICAgYXNzaWduZWUgPSBhc3NpZ25lZS5zbGljZSgwLCBhc3NpZ25lZS5sZW5ndGggLSAyKVxyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAobm9kZS5hbm9ueW1vdXMpIHtcclxuICAgICAgICAgIGFzc2lnbmVlID0gbm9kZS5hbm9ueW1vdXNUZXh0ID09PSAnJyA/ICcnIDogbm9kZS5hbm9ueW1vdXNUZXh0ICYmIG5vZGUuYW5vbnltb3VzVGV4dFxyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmFzc2lnbkluZm9zLnB1c2goe1xyXG4gICAgICAgICAgbGFiZWw6IGAke3RoaXMuc2VsZWN0ZWROb2RlSWQgJiYgdGhpcy5zZWxlY3RlZE5vZGVJZC5zcGxpdCgn77yMJykubGVuZ3RoID4gMSA/IG5vZGUuYWN0aXZpdHlEZWZpbml0aW9uTmFtZSA6ICcnfeWKnueQhuS6uuWRmGAsXHJcbiAgICAgICAgICBzZWxlY3RlZEFzc2lnbmVlcyxcclxuICAgICAgICAgIGFzc2lnbmVlUmVhZEZsYWcsXHJcbiAgICAgICAgICBhc3NpZ25lZSxcclxuICAgICAgICAgIGFzc2lnbmVlSG9sZGVyLFxyXG4gICAgICAgICAgYXNzaWduZWVJbmZvOiB7IC4uLm5vZGUuYXNzaWduZWVJbmZvLCBhc3NpZ25lZVVzZXJzOiB7IGl0ZW1zOiAobm9kZS5hc3NpZ25lZUluZm8gJiYgbm9kZS5hc3NpZ25lZUluZm8uYXNzaWduZWVVc2VycykgfHwgW10gfSB9LFxyXG4gICAgICAgICAgYXNzaWduZWVzOiBub2RlLnNlbGVjdGVkQXNzaWduZWVzLm1hcCh1c2VyID0+IHsgcmV0dXJuIHsgaWQ6IHVzZXIuaWQsIG5hbWU6IHVzZXIubmFtZSB9IH0pLFxyXG4gICAgICAgICAgYWN0aXZpdHlOYW1lOiBub2RlLmFjdGl2aXR5RGVmaW5pdGlvbk5hbWUsXHJcbiAgICAgICAgICBkZXBlbmRlbmN5OiBub2RlLmRlcGVuZGVuY3ksXHJcbiAgICAgICAgICBhbm9ueW1vdXM6IG5vZGUuYW5vbnltb3VzLFxyXG4gICAgICAgICAgYW5vbnltb3VzVGV4dDogbm9kZS5hbm9ueW1vdXNUZXh0XHJcbiAgICAgICAgfSlcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICB0aGlzLmFzc2lnbkluZm9zLnB1c2goe1xyXG4gICAgICAgICAgc2VsZWN0ZWRBc3NpZ25lZXM6IFtdLFxyXG4gICAgICAgICAgYXNzaWduZWVJbmZvOiBudWxsLFxyXG4gICAgICAgICAgYXNzaWduZWVzOiBbXSxcclxuICAgICAgICAgIGFjdGl2aXR5TmFtZTogJycsXHJcbiAgICAgICAgICBkZXBlbmRlbmN5OiAnJyxcclxuICAgICAgICAgIGFub255bW91czogbm9kZS5hbm9ueW1vdXMsXHJcbiAgICAgICAgICBhbm9ueW1vdXNUZXh0OiBub2RlLmFub255bW91c1RleHRcclxuICAgICAgICB9KVxyXG4gICAgICB9XHJcbiAgICB9KVxyXG4gICAgdGhpcy52bS5vcGVuKHtcclxuICAgICAgYXNzaWduZWVPYzogdGhpcy5hc3NpZ25lZU9jLmJpbmQodGhpcyksXHJcbiAgICAgIGFzc2lnbkluZm9zOiB0aGlzLmFzc2lnbkluZm9zXHJcbiAgICB9KVxyXG4gIH1cclxuXHJcbiAgLy8g5Yqe55CG5Lq65ZGY6YCJ5oup5LqL5Lu2XHJcbiAgYXNzaWduZWVPYyhkYXRhOiBhbnksIGluZGV4OiBudW1iZXIpIHtcclxuICAgIHRoaXMuYXNzaWduSW5mb3NbaW5kZXhdLmFzc2lnbmVlcyA9IGRhdGEuaXRlbXM7XHJcbiAgICB0aGlzLnNlbGVjdGVkVmFsdWVzW2luZGV4XSA9IGRhdGEudmFsdWU7XHJcbiAgICB0aGlzLnZtLm9wZW4oe1xyXG4gICAgICBzZWxlY3RlZFZhbHVlczogdGhpcy5zZWxlY3RlZFZhbHVlc1xyXG4gICAgfSlcclxuICB9XHJcblxyXG4gIGNsZWFySGVscCgpIHtcclxuICAgIHRoaXMudm0ub3Blbih7XHJcbiAgICAgIHNlbGVjdGVkVmFsdWVzOiBbJ2NsZWFyJ11cclxuICAgIH0pXHJcbiAgfVxyXG5cclxuICAvLyDmuIXnqbroioLngrlcclxuICBjbGVhck5vZGUoKSB7XHJcbiAgICB0aGlzLnNlbGVjdGVkTm9kZUlkID0gJycsXHJcbiAgICAgIHRoaXMuZGVzdE5vZGVzID0gW10sXHJcbiAgICAgIHRoaXMubm9kZVJlYWRPbmx5ID0gdHJ1ZSxcclxuICAgICAgdGhpcy5ub2RlUGxhY2Vob2xkZXIgPSAnJyxcclxuICAgICAgdGhpcy5hc3NpZ25JbmZvcyA9IFtdO1xyXG4gICAgdGhpcy52bS5vcGVuKHtcclxuICAgICAgbmV4dE5vZGU6IHRoaXMuc2VsZWN0ZWROb2RlSWQsXHJcbiAgICAgIG5leHROb2RlRGF0YTogdGhpcy5kZXN0Tm9kZXMsXHJcbiAgICAgIG5leHROb2RlUmVhZEZsYWc6IHRoaXMubm9kZVJlYWRPbmx5LFxyXG4gICAgICBub2RlUGxhY2Vob2xkZXI6IHRoaXMubm9kZVBsYWNlaG9sZGVyLFxyXG4gICAgICBhc3NpZ25JbmZvczogdGhpcy5hc3NpZ25JbmZvc1xyXG4gICAgfSlcclxuICB9XHJcblxyXG4gIC8vIOa4heepuuWKnueQhuS6uuWRmFxyXG4gIGNsZWFyQXNzaWduSW5mb3MoKSB7XHJcbiAgICB0aGlzLmFzc2lnbkluZm9zID0gW107XHJcbiAgICB0aGlzLnZtLm9wZW4oe1xyXG4gICAgICBhc3NpZ25JbmZvczogdGhpcy5hc3NpZ25JbmZvc1xyXG4gICAgfSlcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOWPlua2iOmhtemdouW8ueahhlxyXG4gICAqL1xyXG4gIGJhY2soKSB7XHJcbiAgICB0aGlzLmNsZWFyUHJvY2VzcygpO1xyXG4gICAgdGhpcy5zdWJqZWN0Lm5leHQoeyB0eXBlOiAnc3VjY2VzcycsIG1lc3NhZ2U6ICcnIH0pO1xyXG4gIH1cclxuXHJcbiAgc3VibWl0KCkge1xyXG4gICAgaWYgKCF0aGlzLnNlbGVjdGVkUHJvY2Vzc0lkKSB7XHJcbiAgICAgIHRoaXMuc3ViamVjdC5uZXh0KHsgdHlwZTogJ2Vycm9yJywgbWVzc2FnZTogJ+ivt+mAiea1geeoiycgfSk7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIGlmICghdGhpcy5zZWxlY3RlZE5vZGVJZCkge1xyXG4gICAgICB0aGlzLnN1YmplY3QubmV4dCh7IHR5cGU6ICdlcnJvcicsIG1lc3NhZ2U6ICfor7fpgInoioLngrknIH0pO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBpZiAodGhpcy5hc3NpZ25JbmZvcy5maWx0ZXIoaW5mbyA9PiAoKGluZm8uYXNzaWduZWVJbmZvICYmIGluZm8uYXNzaWduZWVJbmZvLmFzc2lnbmVlVXNlcnMuaXRlbXMubGVuZ3RoKSB8fCBpbmZvLnNlbGVjdGVkQXNzaWduZWVzLmxlbmd0aCkgJiYgIWluZm8uYXNzaWduZWVzLmxlbmd0aCkubGVuZ3RoKSB7XHJcbiAgICAgIHRoaXMuc3ViamVjdC5uZXh0KHsgdHlwZTogJ2Vycm9yJywgbWVzc2FnZTogJ+ivt+mAieWKnueQhuS6uuWRmCcgfSk7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIGNvbnN0IG5vZGVzOiBzdHJpbmdbXSA9IHRoaXMuc2VsZWN0ZWROb2RlSWQuc3BsaXQoJ++8jCcpO1xyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBub2Rlcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICBsZXQgbmV4dEZsb3dOb2RlOiBGbG93Tm9kZUluZm8gPSB7XHJcbiAgICAgICAgYWN0aXZpdHlEZWZpbml0aW9uSWQ6IG5vZGVzW2ldLFxyXG4gICAgICAgIGFjdGl2aXR5RGVmaW5pdGlvbk5hbWU6IHRoaXMuYXNzaWduSW5mb3NbaV0uYWN0aXZpdHlOYW1lLFxyXG4gICAgICAgIGRlcGVuZGVuY3k6IHRoaXMuYXNzaWduSW5mb3NbaV0uZGVwZW5kZW5jeSxcclxuICAgICAgICBzZWxlY3RlZEFzc2lnbmVlczogdGhpcy5hc3NpZ25JbmZvc1tpXS5hc3NpZ25lZUluZm8gPyB0aGlzLmFzc2lnbkluZm9zW2ldLmFzc2lnbmVlcyA6IFtdLFxyXG4gICAgICAgIGFzc2lnbmVlSW5mbzogbnVsbCxcclxuICAgICAgICByZXNvbHZlZDogZmFsc2UsXHJcbiAgICAgICAgYW5vbnltb3VzOiBmYWxzZSxcclxuICAgICAgICBhbm9ueW1vdXNUZXh0OiAnJ1xyXG4gICAgICB9XHJcbiAgICAgIHRoaXMucGF5bG9hZC5uZXh0Rmxvd05vZGVzLnB1c2gobmV4dEZsb3dOb2RlKTtcclxuICAgIH1cclxuICAgIHRoaXMucGF5bG9hZC5wcm9jZXNzRGVmaW5pdGlvbklkID0gdGhpcy5zZWxlY3RlZFByb2Nlc3NJZDtcclxuICAgIHRoaXMudGFza1NlcnZpY2Uuc3RhcnRQcm9jZXNzKHRoaXMucGF5bG9hZCkuc3Vic2NyaWJlKCgpID0+IHtcclxuICAgICAgdGhpcy5jbGVhclByb2Nlc3MoKTtcclxuICAgICAgdGhpcy5zdWJqZWN0Lm5leHQoeyB0eXBlOiAnc3VjY2VzcycsIG1lc3NhZ2U6ICfmj5DkuqTmiJDlip8nIH0pO1xyXG4gICAgfSwgKGVycm9yKSA9PiB7XHJcbiAgICAgIHRoaXMuc3ViamVjdC5uZXh0KHsgdHlwZTogJ2Vycm9yJywgbWVzc2FnZTogZXJyb3IgJiYgZXJyb3IucmVzcG9uc2UgJiYgZXJyb3IucmVzcG9uc2UuZGF0YSAmJiBlcnJvci5yZXNwb25zZS5kYXRhLk1lc3NhZ2UgfHwgJ+aPkOS6pOWksei0pScgfSk7XHJcbiAgICB9KVxyXG4gIH1cclxuXHJcbiAgZ2V0U3ViamVjdCgpIHtcclxuICAgIHJldHVybiB0aGlzLnN1YmplY3QuYXNPYnNlcnZhYmxlKCk7XHJcbiAgfVxyXG5cclxuICBjbGVhclByb2Nlc3MoKSB7XHJcbiAgICB0aGlzLnZtLmNsb3NlKCk7XHJcbiAgICB0aGlzLnZtID0gbnVsbDtcclxuICAgIHRoaXMuc2VsZWN0ZWRQcm9jZXNzSWQgPSAnJ1xyXG4gICAgdGhpcy5zZWxlY3RlZE5vZGVJZCA9ICcnXHJcbiAgICB0aGlzLnByb2Nlc3NSZWFkT25seSA9IGZhbHNlO1xyXG4gICAgdGhpcy5ub2RlUmVhZE9ubHk9IHRydWU7XHJcbiAgfVxyXG59XHJcbiJdfQ==