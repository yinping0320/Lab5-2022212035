/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Directive, ElementRef, Injector, NgZone, Renderer2, HostListener } from '@angular/core';
import { of } from 'rxjs';
import { DatagridComponent } from '../../datagrid.component';
import { Utils } from '../../utils/utils';
var DatagridRowDblClickDirective = /** @class */ (function () {
    function DatagridRowDblClickDirective(el, injector, ngZone, render, dg) {
        this.el = el;
        this.injector = injector;
        this.ngZone = ngZone;
        this.render = render;
        this.dg = dg;
    }
    /**
     * @return {?}
     */
    DatagridRowDblClickDirective.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
    };
    /**
     * @return {?}
     */
    DatagridRowDblClickDirective.prototype.ngOnDestroy = /**
     * @return {?}
     */
    function () {
    };
    /**
     * @param {?} event
     * @return {?}
     */
    DatagridRowDblClickDirective.prototype.dblclickRowEvent = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        var _this = this;
        /** @type {?} */
        var tr = event.target.closest('tr');
        if (!tr) {
            return;
        }
        if (tr.id == null || tr.id == undefined) {
            return;
        }
        // const rowid = tr.id.replace(TR_PREFIX, '').replace('_fixedright', '').replace('_fixedleft', '').replace('');
        /** @type {?} */
        var rowid = Utils.getRowIdByTr(tr);
        if (tr.className.indexOf('f-datagrid-group-row') > -1) {
            /** @type {?} */
            var groupRowid = rowid.replace('group-tr_', '');
            var _a = this.dg.getGroupRow(groupRowid), groupData = _a.data, groupIndex = _a.index;
            if (groupData && !isNaN(groupIndex)) {
                if (groupData.expanded) {
                    this.dg.collapseGroupRow(groupIndex);
                }
                else {
                    this.dg.expandGroupRow(groupIndex);
                }
            }
            return;
        }
        /** @type {?} */
        var rowIndex = tr.getAttribute('index');
        /** @type {?} */
        var rowData = this.dg.dfs.findRow(rowid);
        if (!rowData) {
            return;
        }
        if (this.dg.disableRow) {
            if (this.dg.disableRow(rowData.data, rowData.index)) {
                event.stopPropagation();
                return false;
            }
        }
        /** @type {?} */
        var handler = (/**
         * @return {?}
         */
        function () {
            if (!_this.dg.dfs.isRowSelected(rowid)) {
                /** @type {?} */
                var r = _this.dg.beforeSelect({ rowIndex: rowIndex, rowData: rowData.data, gridInstance: _this.dg });
                /** @type {?} */
                var r$ = of(true);
                if (r && r.subscribe) {
                    r$ = r;
                }
                r$.subscribe((/**
                 * @param {?} t
                 * @return {?}
                 */
                function (t) {
                    if (t) {
                        _this.dg.selectRow(rowid, true, false);
                        _this.dg.dblclickRow.emit({ rowData: rowData, id: rowid, index: rowIndex, grid: _this.dg, dblclick: true });
                    }
                }));
            }
            else {
                _this.dg.dblclickRow.emit({ rowData: rowData, id: rowid, index: rowIndex, grid: _this.dg, dblclick: true });
            }
        });
        if (this.dg.editable) {
            if (this.dg.editMode === 'row' && this.dg.clickToEdit) {
                this.dg.endRowEdit();
                setTimeout((/**
                 * @return {?}
                 */
                function () {
                    _this.dg.editRow(rowid);
                }), 200);
            }
            else {
                this.dg.isSingleClick = false;
                // this.dg.dblclickRow.emit({ rowData, id: rowid, index: rowIndex, grid: this.dg, dblclick: true });
                handler();
            }
        }
        else {
            // this.dg.dblclickRow.emit({ rowData, id: rowid, index: rowIndex, grid: this.dg,  dblclick: true });
            handler();
        }
        event.stopPropagation();
        event.preventDefault();
    };
    DatagridRowDblClickDirective.decorators = [
        { type: Directive, args: [{
                    selector: '[row-dblclick]',
                },] }
    ];
    /** @nocollapse */
    DatagridRowDblClickDirective.ctorParameters = function () { return [
        { type: ElementRef },
        { type: Injector },
        { type: NgZone },
        { type: Renderer2 },
        { type: DatagridComponent }
    ]; };
    DatagridRowDblClickDirective.propDecorators = {
        dblclickRowEvent: [{ type: HostListener, args: ['dblclick', ['$event'],] }]
    };
    return DatagridRowDblClickDirective;
}());
export { DatagridRowDblClickDirective };
if (false) {
    /**
     * @type {?}
     * @private
     */
    DatagridRowDblClickDirective.prototype.el;
    /**
     * @type {?}
     * @private
     */
    DatagridRowDblClickDirective.prototype.injector;
    /**
     * @type {?}
     * @private
     */
    DatagridRowDblClickDirective.prototype.ngZone;
    /**
     * @type {?}
     * @private
     */
    DatagridRowDblClickDirective.prototype.render;
    /** @type {?} */
    DatagridRowDblClickDirective.prototype.dg;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGF0YWdyaWQtcm93LWRibGNsaWNrLmRpcmVjdGl2ZS5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BmYXJyaXMvdWktZGF0YWdyaWQvIiwic291cmNlcyI6WyJsaWIvY29tcG9uZW50cy9ib2R5L2RhdGFncmlkLXJvdy1kYmxjbGljay5kaXJlY3RpdmUudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUFBLE9BQU8sRUFBRSxTQUFTLEVBQUUsVUFBVSxFQUFFLFFBQVEsRUFBVSxNQUFNLEVBQUUsU0FBUyxFQUFhLFlBQVksRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUNwSCxPQUFPLEVBQWMsRUFBRSxFQUFFLE1BQU0sTUFBTSxDQUFDO0FBQ3RDLE9BQU8sRUFBRSxpQkFBaUIsRUFBRSxNQUFNLDBCQUEwQixDQUFDO0FBRTdELE9BQU8sRUFBRSxLQUFLLEVBQUUsTUFBTSxtQkFBbUIsQ0FBQztBQUUxQztJQU1JLHNDQUFvQixFQUFjLEVBQVUsUUFBa0IsRUFBVSxNQUFjLEVBQVUsTUFBaUIsRUFDOUYsRUFBcUI7UUFEcEIsT0FBRSxHQUFGLEVBQUUsQ0FBWTtRQUFVLGFBQVEsR0FBUixRQUFRLENBQVU7UUFBVSxXQUFNLEdBQU4sTUFBTSxDQUFRO1FBQVUsV0FBTSxHQUFOLE1BQU0sQ0FBVztRQUM5RixPQUFFLEdBQUYsRUFBRSxDQUFtQjtJQUV4QyxDQUFDOzs7O0lBRUQsK0NBQVE7OztJQUFSO0lBRUEsQ0FBQzs7OztJQUVELGtEQUFXOzs7SUFBWDtJQUVBLENBQUM7Ozs7O0lBSUQsdURBQWdCOzs7O0lBRGhCLFVBQ2lCLEtBQVU7UUFEM0IsaUJBZ0ZDOztZQTdFUyxFQUFFLEdBQUcsS0FBSyxDQUFDLE1BQU0sQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDO1FBQ3JDLElBQUksQ0FBQyxFQUFFLEVBQUU7WUFDTCxPQUFPO1NBQ1Y7UUFFRCxJQUFJLEVBQUUsQ0FBQyxFQUFFLElBQUksSUFBSSxJQUFJLEVBQUUsQ0FBQyxFQUFFLElBQUksU0FBUyxFQUFFO1lB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SUFBSSxDQUFDLEVBQUUsQ0FBQyxVQUFVLEVBQUUsQ0FBQztnQkFDckIsVUFBVTs7O2dCQUFDO29CQUNQLEtBQUksQ0FBQyxFQUFFLENBQUMsT0FBTyxDQUFDLEtBQUssQ0FBQyxDQUFDO2dCQUMzQixDQUFDLEdBQUUsR0FBRyxDQUFDLENBQUM7YUFDWDtpQkFBTTtnQkFDSCxJQUFJLENBQUMsRUFBRSxDQUFDLGFBQWEsR0FBRyxLQUFLLENBQUM7Z0JBQzlCLG9HQUFvRztnQkFDcEcsT0FBTyxFQUFFLENBQUM7YUFDYjtTQUNKO2FBQU07WUFDSCxxR0FBcUc7WUFDckcsT0FBTyxFQUFFLENBQUM7U0FDYjtRQUVELEtBQUssQ0FBQyxlQUFlLEVBQUUsQ0FBQztRQUN4QixLQUFLLENBQUMsY0FBYyxFQUFFLENBQUM7SUFDM0IsQ0FBQzs7Z0JBcEdKLFNBQVMsU0FBQztvQkFDUCxRQUFRLEVBQUUsZ0JBQWdCO2lCQUM3Qjs7OztnQkFSbUIsVUFBVTtnQkFBRSxRQUFRO2dCQUFVLE1BQU07Z0JBQUUsU0FBUztnQkFFMUQsaUJBQWlCOzs7bUNBd0JyQixZQUFZLFNBQUMsVUFBVSxFQUFFLENBQUMsUUFBUSxDQUFDOztJQWlGeEMsbUNBQUM7Q0FBQSxBQXJHRCxJQXFHQztTQWxHWSw0QkFBNEI7Ozs7OztJQUd6QiwwQ0FBc0I7Ozs7O0lBQUUsZ0RBQTBCOzs7OztJQUFFLDhDQUFzQjs7Ozs7SUFBRSw4Q0FBeUI7O0lBQ3JHLDBDQUE0QiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IERpcmVjdGl2ZSwgRWxlbWVudFJlZiwgSW5qZWN0b3IsIE9uSW5pdCwgTmdab25lLCBSZW5kZXJlcjIsIE9uRGVzdHJveSwgSG9zdExpc3RlbmVyIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IE9ic2VydmFibGUsIG9mIH0gZnJvbSAncnhqcyc7XHJcbmltcG9ydCB7IERhdGFncmlkQ29tcG9uZW50IH0gZnJvbSAnLi4vLi4vZGF0YWdyaWQuY29tcG9uZW50JztcclxuaW1wb3J0IHsgVFJfUFJFRklYIH0gZnJvbSAnLi4vLi4vdHlwZXMvY29uc3RhbnQnO1xyXG5pbXBvcnQgeyBVdGlscyB9IGZyb20gJy4uLy4uL3V0aWxzL3V0aWxzJztcclxuXHJcbkBEaXJlY3RpdmUoe1xyXG4gICAgc2VsZWN0b3I6ICdbcm93LWRibGNsaWNrXScsXHJcbn0pXHJcbmV4cG9ydCBjbGFzcyBEYXRhZ3JpZFJvd0RibENsaWNrRGlyZWN0aXZlIGltcGxlbWVudHMgT25Jbml0LCBPbkRlc3Ryb3kge1xyXG5cclxuXHJcbiAgICBjb25zdHJ1Y3Rvcihwcml2YXRlIGVsOiBFbGVtZW50UmVmLCBwcml2YXRlIGluamVjdG9yOiBJbmplY3RvciwgcHJpdmF0ZSBuZ1pvbmU6IE5nWm9uZSwgcHJpdmF0ZSByZW5kZXI6IFJlbmRlcmVyMixcclxuICAgICAgICAgICAgICAgIHB1YmxpYyBkZzogRGF0YWdyaWRDb21wb25lbnQpIHtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgbmdPbkluaXQoKSB7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIG5nT25EZXN0cm95KCkge1xyXG5cclxuICAgIH1cclxuXHJcblxyXG4gICAgQEhvc3RMaXN0ZW5lcignZGJsY2xpY2snLCBbJyRldmVudCddKVxyXG4gICAgZGJsY2xpY2tSb3dFdmVudChldmVudDogYW55KSB7XHJcblxyXG4gICAgICAgIGNvbnN0IHRyID0gZXZlbnQudGFyZ2V0LmNsb3Nlc3QoJ3RyJyk7XHJcbiAgICAgICAgaWYgKCF0cikge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAodHIuaWQgPT0gbnVsbCB8fCB0ci5pZCA9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gY29uc3Qgcm93aWQgPSB0ci5pZC5yZXBsYWNlKFRSX1BSRUZJWCwgJycpLnJlcGxhY2UoJ19maXhlZHJpZ2h0JywgJycpLnJlcGxhY2UoJ19maXhlZGxlZnQnLCAnJykucmVwbGFjZSgnJyk7XHJcbiAgICAgICAgY29uc3Qgcm93aWQgPSBVdGlscy5nZXRSb3dJZEJ5VHIodHIpO1xyXG5cclxuICAgICAgICBpZiAodHIuY2xhc3NOYW1lLmluZGV4T2YoJ2YtZGF0YWdyaWQtZ3JvdXAtcm93JykgPiAtMSkge1xyXG4gICAgICAgICAgICBjb25zdCBncm91cFJvd2lkID0gcm93aWQucmVwbGFjZSgnZ3JvdXAtdHJfJywgJycpO1xyXG4gICAgICAgICAgICBjb25zdCB7ZGF0YTogZ3JvdXBEYXRhLCBpbmRleDogZ3JvdXBJbmRleH0gPSB0aGlzLmRnLmdldEdyb3VwUm93KGdyb3VwUm93aWQpO1xyXG4gICAgICAgICAgICBpZiAoZ3JvdXBEYXRhICYmICFpc05hTihncm91cEluZGV4KSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGdyb3VwRGF0YS5leHBhbmRlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZGcuY29sbGFwc2VHcm91cFJvdyhncm91cEluZGV4KTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5kZy5leHBhbmRHcm91cFJvdyhncm91cEluZGV4KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuXHJcbiAgICAgICAgY29uc3Qgcm93SW5kZXggPSB0ci5nZXRBdHRyaWJ1dGUoJ2luZGV4Jyk7XHJcbiAgICAgICAgY29uc3Qgcm93RGF0YSA9IHRoaXMuZGcuZGZzLmZpbmRSb3cocm93aWQpO1xyXG5cclxuICAgICAgICBpZiAoIXJvd0RhdGEpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgIFxyXG4gICAgICAgIGlmICh0aGlzLmRnLmRpc2FibGVSb3cpIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuZGcuZGlzYWJsZVJvdyhyb3dEYXRhLmRhdGEsIHJvd0RhdGEuaW5kZXgpKSB7XHJcbiAgICAgICAgICAgICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3QgaGFuZGxlciA9ICgpID0+IHtcclxuXHJcbiAgICAgICAgICAgIGlmICghdGhpcy5kZy5kZnMuaXNSb3dTZWxlY3RlZChyb3dpZCkpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHIgPSB0aGlzLmRnLmJlZm9yZVNlbGVjdCh7IHJvd0luZGV4OiByb3dJbmRleCwgcm93RGF0YTogcm93RGF0YS5kYXRhLCBncmlkSW5zdGFuY2U6IHRoaXMuZGcgfSk7XHJcbiAgICAgICAgICAgICAgICBsZXQgciQ6IE9ic2VydmFibGU8YW55PiA9IG9mKHRydWUpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHIgJiYgci5zdWJzY3JpYmUpIHtcclxuICAgICAgICAgICAgICAgICAgICByJCA9IHI7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByJC5zdWJzY3JpYmUoKHQpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRnLnNlbGVjdFJvdyhyb3dpZCwgdHJ1ZSwgZmFsc2UpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRnLmRibGNsaWNrUm93LmVtaXQoeyByb3dEYXRhLCBpZDogcm93aWQsIGluZGV4OiByb3dJbmRleCwgZ3JpZDogdGhpcy5kZywgZGJsY2xpY2s6IHRydWUgfSk7ICAgICAgICBcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5kZy5kYmxjbGlja1Jvdy5lbWl0KHsgcm93RGF0YSwgaWQ6IHJvd2lkLCBpbmRleDogcm93SW5kZXgsIGdyaWQ6IHRoaXMuZGcsIGRibGNsaWNrOiB0cnVlIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAodGhpcy5kZy5lZGl0YWJsZSkge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5kZy5lZGl0TW9kZSA9PT0gJ3JvdycgJiYgdGhpcy5kZy5jbGlja1RvRWRpdCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5kZy5lbmRSb3dFZGl0KCk7XHJcbiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmRnLmVkaXRSb3cocm93aWQpO1xyXG4gICAgICAgICAgICAgICAgfSwgMjAwKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZGcuaXNTaW5nbGVDbGljayA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgLy8gdGhpcy5kZy5kYmxjbGlja1Jvdy5lbWl0KHsgcm93RGF0YSwgaWQ6IHJvd2lkLCBpbmRleDogcm93SW5kZXgsIGdyaWQ6IHRoaXMuZGcsIGRibGNsaWNrOiB0cnVlIH0pO1xyXG4gICAgICAgICAgICAgICAgaGFuZGxlcigpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgLy8gdGhpcy5kZy5kYmxjbGlja1Jvdy5lbWl0KHsgcm93RGF0YSwgaWQ6IHJvd2lkLCBpbmRleDogcm93SW5kZXgsIGdyaWQ6IHRoaXMuZGcsICBkYmxjbGljazogdHJ1ZSB9KTtcclxuICAgICAgICAgICAgaGFuZGxlcigpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgIH1cclxufVxyXG4iXX0=