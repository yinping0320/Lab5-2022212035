/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
/*
 * @Author: 疯狂秀才(Lucas Huang)
 * @Date: 2019-08-06 07:43:07
 * @LastEditors: 疯狂秀才(Lucas Huang)
 * @LastEditTime: 2019-11-19 15:48:27
 * @QQ: 1055818239
 * @Version: v0.0.1
 */
import { Directive, Input, ElementRef, Renderer2, ContentChild, Injector, forwardRef, Inject, NgZone } from '@angular/core';
import { filter, debounceTime, takeUntil } from 'rxjs/operators';
import { DatagridService } from './../../services/datagrid.service';
import { DatagridCellComponent } from './datagrid-cell.component';
import { DatagridBodyComponent } from './datagrid-body.component';
import { DatagridRowDirective } from './datagrid-row.directive';
import { DatagridFacadeService } from '../../services/datagrid-facade.service';
import { DatagridComponent } from '../../datagrid.component';
import { CELL_SELECTED_CLS, CELL_EDITING_CLS, ALLOW_EDIT_CELL_HIGHLIGHT_CLS } from '../../types/constant';
import { of, noop, Subject } from 'rxjs';
import { Utils } from '../../utils/utils';
var DatagridCellEditableDirective = /** @class */ (function () {
    function DatagridCellEditableDirective(injector, el, render, dg, ngZone) {
        var _this = this;
        this.injector = injector;
        this.el = el;
        this.render = render;
        this.dg = dg;
        this.ngZone = ngZone;
        // private _readonly$ = null;
        this.cellEditorCreatedSubscription = null;
        this.cellEditorDestorySubscription = null;
        this.destroy$ = new Subject();
        this.validMessageEle = null;
        this.dgb = this.injector.get(DatagridBodyComponent);
        this.dr = this.injector.get(DatagridRowDirective);
        this.dfs = this.injector.get(DatagridFacadeService);
        this.dgs = this.injector.get(DatagridService);
        if (!this.cellEditorCreatedSubscription) {
            this.cellEditorCreatedSubscription = this.dgs.cellEditorCreated.pipe(takeUntil(this.destroy$)).pipe(filter((/**
             * @param {?} __0
             * @return {?}
             */
            function (_a) {
                var column = _a.column, editorRef = _a.editorRef, cellEditorRef = _a.cellEditorRef, templateRef = _a.templateRef;
                return column.field === _this.column.field && _this.dg.selectedRow.id === _this.dr.rowId;
            }))).subscribe((/**
             * @param {?} __0
             * @return {?}
             */
            function (_a) {
                var editorRef = _a.editorRef, cellEditorRef = _a.cellEditorRef, templateRef = _a.templateRef;
                if (editorRef) {
                    _this['editor'] = editorRef.instance;
                    _this['formControl'] = (/** @type {?} */ (_this.editor.formControl));
                    _this.cellEditorRef = cellEditorRef;
                    _this.emitBeginEdit();
                }
                else {
                    _this['formControl'] = (/** @type {?} */ (_this.dr.form.get(_this.column.field)));
                    _this.bindEditorInputEvent();
                    _this.dg.beginEdit.emit({ editor: null, column: _this.column, rowData: _this.rowData, gridInstance: _this.dg, template: templateRef });
                }
                _this.dg.rowClick.emit({ data: _this.rowData, grid: _this.dg, dblclick: false });
            }));
        }
        this.dg.dgs.cellEditorDestory.pipe(takeUntil(this.destroy$)).pipe(filter((/**
         * @param {?} __0
         * @return {?}
         */
        function (_a) {
            var column = _a.column;
            return _this.dg.selectedRow && column.field === _this.column.field && _this.dg.selectedRow.id === _this.dr.rowId;
        }))).subscribe((/**
         * @param {?} e
         * @return {?}
         */
        function (e) {
            if (_this.dg.editMode === 'cell') {
                _this.dg.selectedRow.editors = [];
                if (_this.dg.currentCell) {
                    _this.dg.currentCell.editor = null;
                    _this.dg.currentCell.cellEditorRef = null;
                }
            }
            _this.unBindEditorInputEvent();
            _this.cellEditorRef = null;
            _this.formControl = null;
            _this.editor = null;
            _this.removeValidMessage();
        }));
    }
    /**
     * @return {?}
     */
    DatagridCellEditableDirective.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
    };
    /**
     * @param {?} changes
     * @return {?}
     */
    DatagridCellEditableDirective.prototype.ngOnChanges = /**
     * @param {?} changes
     * @return {?}
     */
    function (changes) {
        if (changes.rowData && !changes.rowData.isFirstChange()) {
            this.initCellEvent();
            this.setCellClsWithEditorType();
        }
    };
    /**
     * @return {?}
     */
    DatagridCellEditableDirective.prototype.ngAfterViewInit = /**
     * @return {?}
     */
    function () {
        this.initCellEvent();
        this.setCellClsWithEditorType();
    };
    /**
     * @private
     * @param {?} e
     * @return {?}
     */
    DatagridCellEditableDirective.prototype.runZoneClick = /**
     * @private
     * @param {?} e
     * @return {?}
     */
    function (e) {
        if (this['zoneClick']) {
            Object.assign(e, { rowData: this.rowData });
            this['zoneClick'].forEach((/**
             * @param {?} n
             * @return {?}
             */
            function (n) {
                n.target.style.pointerEvents = 'auto';
                if (n.callback) {
                    n.callback(e);
                }
                else if (n.handler) {
                    n.handler(e);
                }
            }));
            if (this.dg.isFF) {
                e.target['__zone_symbol__clickfalse'] = this['zoneClick'];
            }
        }
    };
    /**
     * @private
     * @return {?}
     */
    DatagridCellEditableDirective.prototype.initCellEvent = /**
     * @private
     * @return {?}
     */
    function () {
        var _this = this;
        if (this.column && (this.column.editor || this.column.editorTemplate)) {
            if (!this.dg.clickToEdit) {
                this.celldblclick = this.render.listen(this.el.nativeElement, 'dblclick', (/**
                 * @param {?} e
                 * @return {?}
                 */
                function (e) {
                    _this.onDblClickCell(e);
                }));
            }
            this.el.nativeElement.edit = (/**
             * @param {?} e
             * @return {?}
             */
            function (e) {
                _this.closeEditingCell().subscribe((/**
                 * @param {?} canEdit
                 * @return {?}
                 */
                function (canEdit) {
                    if (canEdit) {
                        _this.onClickCell(e);
                        if (!_this.dg.selectedRow || _this.dg.selectedRow.id !== _this.dr.rowId) {
                            _this.dg.selectRow(_this.dr.rowId, true, false);
                        }
                        _this.runZoneClick(e);
                    }
                }));
            });
            this.el.nativeElement.editCell = (/**
             * @param {?} e
             * @return {?}
             */
            function (e) {
                _this.openCellEditor();
            });
        }
        else {
            this.clickTimer = 0;
        }
        /** @type {?} */
        var excludeTarget = (/**
         * @param {?} e
         * @return {?}
         */
        function (e) {
            return e.target.parentElement.nodeName !== 'GRID-BODY-CELL' &&
                e.target.nodeName !== 'INPUT' && e.target.nodeName !== 'TEXTAREA' &&
                !(e.target.className.indexOf('custom-control-label') > -1 &&
                    e.target.parentElement && e.target.parentElement.className.indexOf('custom-control') > -1) &&
                !e.target.closest('input-group') && !e.target.closest('farris-switch') &&
                !e.target.closest('farris-number-spinner') &&
                !e.target.closest('farris-datepicker') &&
                !e.target.closest('farris-time-picker') &&
                !e.target.closest('grid-editor-textarea') &&
                !e.target.closest('farris-checkboxgroup') &&
                !e.target.closest('grid-editor-checkbox') && !e.target.closest('farris-radiogroup') &&
                !e.target.closest('farris-organization-selector') && !e.target.closest('farris-personnel-selector');
        });
        if (this.column.proxyClick === undefined) {
            this.column.proxyClick = true;
        }
        if (this.column.template && this.column.proxyClick) {
            if (this['_tdmousedown_']) {
                this.el.nativeElement.removeEventListener('mousedown', this['_tdmousedown_'], true);
                this['_tdmousedown_'] = null;
            }
            this.el.nativeElement.addEventListener('mousedown', this['_tdmousedown_'] = (/**
             * @param {?} e
             * @return {?}
             */
            function (e) {
                if (excludeTarget(e)) {
                    _this['zoneClick'] = e.target['__zone_symbol__clickfalse'] || e.target['__zone_symbol__ANGULARclickFALSE'];
                    if (_this['zoneClick'] && _this['zoneClick'].length) {
                        if (!_this.dg.isFF) {
                            e.target.style.pointerEvents = 'none';
                        }
                        else {
                            if (e.target['__zone_symbol__clickfalse']) {
                                delete (e.target['__zone_symbol__clickfalse']);
                            }
                            if (e.target['__zone_symbol__ANGULARclickFALSE']) {
                                delete (e.target['__zone_symbol__ANGULARclickFALSE']);
                            }
                        }
                        _this['zoneClick'].forEach(((/**
                         * @param {?} proxyClick
                         * @return {?}
                         */
                        function (proxyClick) {
                            if (!proxyClick.target) {
                                proxyClick.target = e.target;
                            }
                        })));
                    }
                }
            }), true);
            /*
            this['_tdmousedown_'] = this.render.listen(this.el.nativeElement, 'mousedown', (e: any) => {
                if (excludeTarget(e)) {
                    this['zoneClick'] = e.target['__zone_symbol__clickfalse'] || e.target['__zone_symbol__ANGULARclickFALSE'];
                    if (this['zoneClick'] && this['zoneClick'].length) {
                        e.target.style.pointerEvents = 'none';
                        this['zoneClick'].forEach((proxyClick => {
                            if (!proxyClick.target) {
                                proxyClick.target = e.target;
                            }
                        }));
                    }
                }
            });
            */
        }
        this.el.nativeElement.gridCellData = { rowData: this.rowData, rowIndex: this.dr.rowIndex };
        this.el.nativeElement.closeEdit = (/**
         * @return {?}
         */
        function () { return _this.closeEditingCell(); });
        this.el.nativeElement.selectCell = (/**
         * @param {?} e
         * @param {?} el
         * @return {?}
         */
        function (e, el) {
            if (_this.dg.disableRow && _this.dg.disableRow(_this.rowData, _this.dr.rowIndex)) {
                return;
            }
            /** @type {?} */
            var beforEventParam = {
                rowIndex: _this.dr.rowIndex,
                rowData: _this.rowData,
                gridInstance: _this.dg
            };
            /** @type {?} */
            var runTemplateClickEvent = (/**
             * @return {?}
             */
            function () {
                if (!_this.dg.currentCell) {
                    _this.selectCell(_this.column.field, el);
                    if (!_this.dg.currentCell) {
                        _this.dg.currentCell = { rowData: _this.rowData };
                    }
                    else {
                        if (!_this.dg.currentCell.rowData) {
                            _this.dg.currentCell.rowData = _this.rowData;
                        }
                    }
                }
                if (_this['zoneClick']) {
                    _this.runZoneClick(e);
                }
                _this.dg.cellClick.emit({ column: _this.column, rowData: _this.rowData, gridInstance: _this.dg, event: e });
            });
            /** @type {?} */
            var useNewSelectionMode = _this.dg.sms.beforRowClick(tslib_1.__assign({}, beforEventParam, { e: e, id: _this.dr.rowId, dr: _this.dr, cellref: _this }));
            if (useNewSelectionMode) {
                _this.selectCell(_this.column.field, el);
                if (!_this.dg.currentCell) {
                    _this.dg.currentCell = { rowData: _this.rowData };
                }
                else {
                    if (!_this.dg.currentCell.rowData) {
                        _this.dg.currentCell.rowData = _this.rowData;
                    }
                }
                _this.dg.cellClick.emit({ column: _this.column, rowData: _this.rowData, gridInstance: _this.dg, event: e });
                return;
            }
            if (_this.dfs.isRowSelected(_this.dr.rowId)) {
                if (!_this.dg.keepSelect && !_this.column.template) {
                    if (_this.dg.currentCell && _this.dg.currentCell.cellElement && _this.dg.currentCell.cellElement.id === el.id) {
                        _this.dg.cancelSelectCell();
                    }
                    _this.dg.beforeUnselect(beforEventParam).pipe(takeUntil(_this.destroy$)).subscribe((/**
                     * @param {?} canUnselect
                     * @return {?}
                     */
                    function (canUnselect) {
                        if (canUnselect) {
                            // this.dg.unSelect.emit(this.dg.selectedRow);
                            _this.dfs.unSelectRow(_this.dr.rowIndex, _this.rowData, { instance: _this.dg });
                            /** @type {?} */
                            var trCLS = _this.el.nativeElement.className;
                            if (trCLS.indexOf('f-datagrid-row-selected') > -1) {
                                _this.el.nativeElement.className = trCLS.replace('f-datagrid-row-selected', '');
                            }
                        }
                        _this.dg.rowClick.emit({ data: _this.rowData, grid: _this.dg, dblclick: false });
                        _this.dg.dgs.setSelecedRow.emit();
                    }));
                }
                else {
                    _this.dg.rowClick.emit({ data: _this.rowData, grid: _this.dg, dblclick: false });
                    runTemplateClickEvent();
                }
            }
            else {
                /** @type {?} */
                var r$ = of(true);
                if (_this.dg.beforeSelect) {
                    /** @type {?} */
                    var r = _this.dg.beforeSelect({ rowIndex: _this.dr.rowIndex, rowData: _this.rowData, gridInstance: _this.dg });
                    if (r && r.subscribe) {
                        r$ = r;
                    }
                }
                /** @type {?} */
                var zoneClick = _this['zoneClick'];
                /** @type {?} */
                var _timer_1 = zoneClick && zoneClick.length ? 100 : 0;
                r$.pipe(debounceTime(_timer_1)).subscribe((/**
                 * @param {?} t
                 * @return {?}
                 */
                function (t) {
                    if (t) {
                        _this.selectCell(_this.column.field, el);
                        _this.dg.cellClick.emit({ column: _this.column, rowData: _this.rowData, gridInstance: _this.dg, event: e });
                        if (_timer_1) {
                            _this.runZoneClick(e);
                        }
                    }
                    _this.dg.rowClick.emit({ data: _this.rowData, grid: _this.dg, dblclick: false });
                    _this.dg.dgs.setSelecedRow.emit();
                }));
            }
        });
        this.el.nativeElement.cancelSelected = (/**
         * @return {?}
         */
        function () {
            _this.render.removeClass(_this.el.nativeElement, CELL_SELECTED_CLS);
            _this.render.removeClass(_this.el.nativeElement, CELL_EDITING_CLS);
        });
    };
    /**
     * @return {?}
     */
    DatagridCellEditableDirective.prototype.ngOnDestroy = /**
     * @return {?}
     */
    function () {
        this.destroy$.next();
        this.destroy$.complete();
        if (this.cellclick) {
            this.cellclick();
        }
        if (this.celldblclick) {
            this.celldblclick();
        }
        this.unBindEditorInputEvent();
        if (this.bindCellEventSubscription) {
            this.bindCellEventSubscription.unsubscribe();
            this.bindCellEventSubscription = null;
        }
        if (this.cellEditorCreatedSubscription) {
            this.cellEditorCreatedSubscription.unsubscribe();
            this.cellEditorCreatedSubscription = null;
        }
        if (this.cellEditorDestorySubscription) {
            this.cellEditorDestorySubscription.unsubscribe();
            this.cellEditorDestorySubscription = null;
        }
        this.editor = null;
        this.cellEditorRef = null;
        this.formControl = null;
        if (this.el) {
            this.el.nativeElement.cancelSelected = noop;
            this.el.nativeElement.selectCell = noop;
            this.el.nativeElement.closeEdit = noop;
            this.el.nativeElement.gridCellData = noop;
            this.el.nativeElement.edit = noop;
            this.el.nativeElement.selectCell = noop;
            if (this['_tdmousedown_']) {
                this.el.nativeElement.removeEventListener('mousedown', this['_tdmousedown_'], true);
                this['_tdmousedown_'] = null;
            }
            this.el = null;
        }
    };
    /**
     * @private
     * @return {?}
     */
    DatagridCellEditableDirective.prototype.isDifferentCell = /**
     * @private
     * @return {?}
     */
    function () {
        if (!this.dg.currentCell) {
            return true;
        }
        else {
            if (!this.dg.selectedRow || this.dg.selectedRow.index !== this.dr.rowIndex) {
                return true;
            }
            else {
                if (this.dr.rowIndex !== this.dg.currentCell.rowIndex) {
                    return true;
                }
                else {
                    return this.dg.currentCell.field !== this.column.field;
                }
            }
        }
    };
    /**
     * @private
     * @param {?} event
     * @return {?}
     */
    DatagridCellEditableDirective.prototype.onClickCell = /**
     * @private
     * @param {?} event
     * @return {?}
     */
    function (event) {
        var _this = this;
        // 关闭其他Grid 的编辑器
        document.body.click();
        this.dg.beforeClickCell.emit({ rowIndex: this.dr.rowIndex, rowData: this.rowData, column: this.column, gridInstance: this.dg });
        if (this.dr.disabled) {
            return;
        }
        if (this.dg.disabled) {
            return;
        }
        else {
            if (!this.dg.editable || this.isReadonly()) {
                if (this.dg.enableHighlightCell) {
                    event.stopPropagation();
                    this.dg.endEditing();
                    this.selectCell(this.column.field);
                }
                // 只读单元格，点击后须触发行点击事件 tfs 574551
                this.dg.rowClick.emit({ data: this.rowData, grid: this.dg, dblclick: false });
                return;
            }
            else {
                if (this.dg.editMode === 'row') {
                    return;
                }
            }
        }
        if (this.dg.selectionMode === 'default' && event) {
            if (event.ctrlKey || event.shiftKey) {
                return;
            }
        }
        event.stopPropagation();
        if (event.target['nodeName'] === 'INPUT') {
            return;
        }
        // if (this.dg.clickToEdit && !this.dg.dblclickRow.observers.length) {
        //     this.dg.clickDelay = 0;
        // }
        this.render.addClass(this.dg.el.nativeElement, 'f-datagrid-unselect');
        if (!this.dg.isSingleClick && this.dg.editMode) {
            this.dg.isSingleClick = true;
            if (this.clickTimer) {
                clearTimeout(this.clickTimer);
            }
            this.clickTimer = setTimeout((/**
             * @return {?}
             */
            function () {
                if (_this.dg.isSingleClick && _this.dg.editable && _this.dg.editMode === 'cell') {
                    _this.dg.isSingleClick = false;
                    clearTimeout(_this.clickTimer);
                    // if (!this.closeEditingCell()) {
                    //     return;
                    // }
                    _this.closeEditingCell().pipe(takeUntil(_this.destroy$)).subscribe((/**
                     * @param {?} f
                     * @return {?}
                     */
                    function (f) {
                        if (f) {
                            if (_this.dg.clickToEdit) {
                                !_this.dg.nowrap && _this.dgb.updateRowHeight();
                                _this.openCellEditor();
                            }
                            else {
                                _this.selectCell(_this.column.field);
                            }
                            _this.render.removeClass(_this.dg.el.nativeElement, 'f-datagrid-unselect');
                            event.preventDefault();
                        }
                    }));
                }
            }), this.dg.clickDelay);
        }
    };
    /**
     * @private
     * @param {?} event
     * @return {?}
     */
    DatagridCellEditableDirective.prototype.onDblClickCell = /**
     * @private
     * @param {?} event
     * @return {?}
     */
    function (event) {
        var _this = this;
        if (this.dg.disabled || this.isReadonly()) {
            return;
        }
        if (event.target['nodeName'] === 'INPUT' || event.target['nodeName'] === 'TEXTAREA') {
            return;
        }
        if (this.dg.editable && this.dg.editMode === 'cell') {
            if (this.clickTimer) {
                this.dg.isSingleClick = false;
                clearTimeout(this.clickTimer);
                this.clickTimer = null;
            }
            this.closeEditingCell().pipe(takeUntil(this.destroy$)).subscribe((/**
             * @param {?} f
             * @return {?}
             */
            function (f) {
                if (f) {
                    setTimeout((/**
                     * @return {?}
                     */
                    function () {
                        _this.openCellEditor();
                    }));
                }
            }));
        }
    };
    /**
     * @param {?=} col
     * @return {?}
     */
    DatagridCellEditableDirective.prototype.isReadonly = /**
     * @param {?=} col
     * @return {?}
     */
    function (col) {
        if (col === void 0) { col = this.column; }
        if (this.dg.editable) {
            // 参与合并的单元格不允许编辑
            if (this.dg.mergeCell && this.dg.mergeFields.indexOf(col.field) > -1) {
                return true;
            }
            return this.getReadonlyValue(col);
        }
        else {
            return true;
        }
    };
    /**
     * @private
     * @param {?=} col
     * @return {?}
     */
    DatagridCellEditableDirective.prototype.getReadonlyValue = /**
     * @private
     * @param {?=} col
     * @return {?}
     */
    function (col) {
        if (col === void 0) { col = this.column; }
        if (col.readonly !== undefined) {
            if (typeof col.readonly === 'boolean') {
                return col.readonly;
            }
            else if (typeof col.readonly === 'function') {
                return col.readonly(this.rowData);
            }
        }
        return false;
    };
    /**
     * @return {?}
     */
    DatagridCellEditableDirective.prototype.openCellEditor = /**
     * @return {?}
     */
    function () {
        var _this = this;
        // 当前行禁用，不允许编辑。
        if (this.dr.disabled) {
            return;
        }
        if ((!this.column.editor && !this.column.editorTemplate) || !this.dg.editable || this.isReadonly()) {
            if (this.dg.selectionMode === 'default' && this.dg.multiSelect) {
                this.dg.clearCheckeds();
            }
            this.selectCell(this.column.field);
            return;
        }
        /** @type {?} */
        var beforeEditEvent = this.dg.beforeEdit({ rowIndex: this.dr.rowIndex, rowData: this.rowData, column: this.column, gridInstance: this.dg });
        if (!beforeEditEvent || !beforeEditEvent.subscribe) {
            this.dg.writeConsole('please return an Observable Type.');
            return;
        }
        if (this.dg.currentCell) {
            if (!this.dg.currentCell.cellRef || this.dg.currentCell.cellRef.column.field !== this.column.field) {
                this.dg.currentCell.cellRef = this.dc;
            }
        }
        beforeEditEvent.pipe(takeUntil(this.destroy$)).subscribe((/**
         * @param {?} flag
         * @return {?}
         */
        function (flag) {
            if (flag) {
                if (_this.isDifferentCell()) {
                    if (_this.dg.selectionMode === 'default' && _this.dg.multiSelect) {
                        _this.dg.clearCheckeds();
                    }
                    _this.selectCell(_this.column.field);
                }
                _this.dfs.editCell();
            }
            else {
                _this.selectCell(_this.column.field);
                // tfs 574612
                _this.dg.rowClick.emit({ data: _this.rowData, grid: _this.dg, dblclick: false });
            }
        }));
    };
    /**
     * @private
     * @return {?}
     */
    DatagridCellEditableDirective.prototype.emitBeginEdit = /**
     * @private
     * @return {?}
     */
    function () {
        var _this = this;
        /** @type {?} */
        var _cellEditorRef = this.cellEditorRef || this.dc.cellEditor;
        this.render.removeClass(this.dg.el.nativeElement, 'f-datagrid-unselect');
        if (this.dg.editMode === 'cell') {
            this.dg.selectedRow.editors = [this.editor];
            this.dg.currentCell.editor = this.editor;
            this.dg.currentCell.cellEditorRef = _cellEditorRef;
            this.bindEditorInputEvent();
            this.render.addClass(this.el.nativeElement, CELL_EDITING_CLS);
            // this.formControl.setValue(this.dc.value);
            this.dg.beginEdit.emit({ editor: _cellEditorRef, column: this.column, rowData: this.rowData, gridInstance: this.dg });
            if (this.column.editor.type === 'textarea' && this.column.editor.options && this.column.editor.options.editType === 'dialog') {
                this.editor.showDialog();
            }
        }
        if (this.dr && !this.dg.nowrap) {
            setTimeout((/**
             * @return {?}
             */
            function () {
                _this.dr.updateRowHeight();
            }));
        }
        if (this.editor) {
            this.validMessageEle = this.showValidMessage();
        }
    };
    /**
     * @return {?}
     */
    DatagridCellEditableDirective.prototype.removeValidMessage = /**
     * @return {?}
     */
    function () {
        // 移除验证信息
        if (this.validMessageEle) {
            this.validMessageEle.remove();
            this.validMessageEle = null;
            if (this.dg.formValidations) {
                delete this.dg.formValidations[this.column.field];
            }
        }
    };
    /**
     * @return {?}
     */
    DatagridCellEditableDirective.prototype.showValidMessage = /**
     * @return {?}
     */
    function () {
        if (this.dg.formValidations && this.dg.formValidations[this.column.field]) {
            var _a = this.dg.formValidations[this.column.field], isValid = _a.isValid, message = _a.message;
            if (!isValid && message) {
                /** @type {?} */
                var tr = this.editor.el.nativeElement.closest('tr');
                /** @type {?} */
                var td = this.editor.el.nativeElement.closest('td');
                /** @type {?} */
                var parentContainver = this.editor.el.nativeElement.closest('.f-datagrid-table');
                /** @type {?} */
                var box = document.createElement('div');
                /** @type {?} */
                var msgWrap = document.createElement('span');
                box.appendChild(msgWrap);
                msgWrap.innerText = message;
                box.style.position = 'absolute';
                box.style.background = '#FDEFEF';
                box.style.color = '#F46160';
                /** @type {?} */
                var top_1 = tr.offsetTop - 21;
                if (tr.getAttribute('index') == '0') {
                    top_1 = tr.offsetHeight;
                }
                box.style.top = top_1 + "px";
                box.style.left = td.offsetLeft + 5 + "px";
                box.style.zIndex = '996';
                box.style.padding = '0.1875rem 0.5rem';
                box.style.fontSize = '.8125rem';
                box.style.lineHeight = '14px';
                // document.body.append(box);
                parentContainver.append(box);
                return box;
            }
            return null;
        }
    };
    /**
     * @return {?}
     */
    DatagridCellEditableDirective.prototype.closeEditingCell = /**
     * @return {?}
     */
    function () {
        var _this = this;
        if (!this.dg.isCellEditing()) {
            return of(true);
        }
        /** @type {?} */
        var currentCell = null;
        /** @type {?} */
        var editor = null;
        if (this.dg.currentCell) {
            currentCell = (/** @type {?} */ (this.dg.currentCell.cellRef));
            if (currentCell) {
                if (!currentCell.isEditing) {
                    return of(true);
                }
                if (currentCell.cellEditor && currentCell.cellEditor.componentRef && !currentCell.column.editorTemplate) {
                    editor = currentCell.cellEditor.componentRef.instance;
                    if (editor) {
                        // 执行blur 事件
                        if (editor.inputElement) {
                            /** @type {?} */
                            var domName = editor.inputElement.nodeName;
                            /** @type {?} */
                            var blurFn = editor.options && editor.options.onBlur;
                            if (blurFn) {
                                if ((domName === 'INPUT' || domName === 'TEXTAREA') && this.dg['focusElement'] === editor.inputElement) {
                                    blurFn({ editorRef: editor, rowData: currentCell.rowData });
                                }
                            }
                            if (editor.inputElement.blur) {
                                editor.inputElement.blur();
                            }
                            this.dg['focusElement'] = null;
                        }
                        if (editor.blur) {
                            editor.blur();
                        }
                        if (editor.pending) {
                            return of(false);
                        }
                        if (editor.formControl) {
                            if (editor.formControl.pending) {
                                return of(false);
                            }
                            if (editor.formControl && editor.formControl.invalid && !this.dg.endEditByInvalid) {
                                return of(false);
                            }
                        }
                        else {
                            return of(true);
                        }
                    }
                    else {
                        return of(true);
                    }
                }
            }
        }
        else {
            return of(true);
        }
        this.dg.isSingleClick = false;
        /** @type {?} */
        var _col_ = (editor || currentCell).column;
        /** @type {?} */
        var afterEditEvent = this.dg.afterEdit(currentCell.rowIndex, currentCell.rowData, _col_, editor);
        if (!afterEditEvent || !afterEditEvent.subscribe) {
            this.dg.writeConsole('please return an Observable Type.');
            return of(undefined);
        }
        // let cellEndEdit = of(undefined);
        /** @type {?} */
        var cellEndEdit = new Subject();
        afterEditEvent.pipe(takeUntil(this.destroy$)).subscribe((/**
         * @param {?} flag
         * @return {?}
         */
        function (flag) {
            if (flag) {
                /** @type {?} */
                var val_1 = currentCell.value === undefined ? '' : currentCell.value;
                if (currentCell && currentCell.formControl && currentCell.formControl.value !== undefined && val_1 !== currentCell.formControl.value) {
                    val_1 = currentCell.formControl.value;
                    currentCell.isEditing = false;
                    currentCell.updateValue(val_1);
                }
                _this.dfs.endEditCell();
                _this.dgs.onEndCellEdit(_this.dfs.getCurrentCell());
                _this.unBindEditorInputEvent();
                // 移除编辑样式
                _this.render.removeClass(_this.el.nativeElement, CELL_EDITING_CLS);
                if (_this.dg.selectedRow) {
                    _this.dg.selectedRow.editors = [];
                }
                // this.dg.selectedRow.data = this.rowData;
                // 更新行样式或者单元格样式
                /** @type {?} */
                var _rid = _this.dfs.primaryId(currentCell.rowData);
                _this.dfs.rowUpdate$.next({ index: currentCell.rowIndex, data: currentCell.rowData, cellRef: currentCell, keyID: _rid });
                if (_this.dg.showFooter) {
                    // 更新footerData
                    _this.dgs.refreshFooterData.emit();
                }
                // 刷新行数据
                // this.dr.refresh();
                if (_this.dg.selectedRow && _this.dg.selectedRow.dr) {
                    _this.dg.selectedRow.dr.refresh();
                }
                if (_this['ENDEDIT_TIMER']) {
                    clearTimeout(_this['ENDEDIT_TIMER']);
                }
                var rowIndex_1 = currentCell.rowIndex, rowData_1 = currentCell.rowData;
                _this['ENDEDIT_TIMER'] = setTimeout((/**
                 * @return {?}
                 */
                function () {
                    _this.dg.endEdit.emit({ rowIndex: rowIndex_1, rowData: rowData_1, column: _col_, value: val_1 });
                    // cellEndEdit = of(true);
                    cellEndEdit.next(true);
                }), 100);
            }
            else {
                if (currentCell && currentCell.cellEditor && currentCell.cellEditor.componentRef && currentCell.cellEditor.componentRef.instance) {
                    editor = currentCell.cellEditor.componentRef.instance;
                    editor.inputElement.focus();
                    // cellEndEdit = of(false);
                    cellEndEdit.next(false);
                }
                else {
                    // cellEndEdit = of(true);
                    cellEndEdit.next(true);
                }
            }
        }));
        return cellEndEdit.asObservable();
    };
    /**
     * @return {?}
     */
    DatagridCellEditableDirective.prototype.cancelCellEditing = /**
     * @return {?}
     */
    function () {
        if (this.dg.currentCell && this.dg.currentCell.isEditing && this.dg.selectedRow.index > -1) {
            // this.dfs.resetRow(this.dg.selectedRow.id);
            this.dc.rowData = this.dg.selectedRow.data;
            this.formControl.reset(Utils.getValue(this.column.field, this.dc.rowData));
            this.closeEditingCell();
        }
    };
    /**
     * @return {?}
     */
    DatagridCellEditableDirective.prototype.bindEditorInputEvent = /**
     * @return {?}
     */
    function () {
        var _this = this;
        /** @type {?} */
        var ceRef = this.cellEditorRef || this.dc.cellEditor;
        /** @type {?} */
        var input = null;
        if (ceRef) {
            input = ceRef.componentRef.instance.inputElement;
        }
        else {
            if (this.column.editorTemplate) {
                input = this.dc.el.nativeElement.querySelector('input,textarea');
            }
        }
        if (input) {
            input.focus();
            if (this.dg.selectOnEditing && this.column.editorTemplate) {
                setTimeout((/**
                 * @return {?}
                 */
                function () {
                    if (input.select) {
                        input.select();
                    }
                }));
            }
            this.editorInputKeydownEvent = this.render.listen(input, 'keydown', (/**
             * @param {?} e
             * @return {?}
             */
            function (e) {
                _this.onKeyDownForInput(e);
            }));
        }
    };
    /**
     * @return {?}
     */
    DatagridCellEditableDirective.prototype.unBindEditorInputEvent = /**
     * @return {?}
     */
    function () {
        if (this.editorInputKeydownEvent) {
            this.editorInputKeydownEvent();
            this.editorInputKeydownEvent = null;
        }
    };
    // private isLastCell() {
    //     let i = this.dg.flatColumns.length;
    //     while(i <= ) {
    //         if (this.dg.flatColumns[i])
    //     }
    // }
    // private isLastCell() {
    //     let i = this.dg.flatColumns.length;
    //     while(i <= ) {
    //         if (this.dg.flatColumns[i])
    //     }
    // }
    /**
     * @return {?}
     */
    DatagridCellEditableDirective.prototype.findLastEditCell = 
    // private isLastCell() {
    //     let i = this.dg.flatColumns.length;
    //     while(i <= ) {
    //         if (this.dg.flatColumns[i])
    //     }
    // }
    /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var i = this.dg.colGroup.columns.length - 1;
        /** @type {?} */
        var _col = null;
        while (i >= 0) {
            /** @type {?} */
            var col = this.dg.colGroup.columns[i];
            if (col.editor || col.editorTemplate) {
                _col = col;
                break;
            }
            else {
                i--;
            }
        }
        return _col;
    };
    /**
     * @param {?} e
     * @return {?}
     */
    DatagridCellEditableDirective.prototype.onKeyDownForInput = /**
     * @param {?} e
     * @return {?}
     */
    function (e) {
        var _this = this;
        /** @type {?} */
        var keyCode = e.keyCode;
        if (e.altKey || e.ctrlKey) {
            return;
        }
        if ((this.editor && this.editor.stopPropagation) || keyCode === 13 || this.column.editorTemplate) {
            e.stopPropagation();
        }
        switch (keyCode) {
            case 32: // SPACE
                if (this.column.editor.type === 'switch') {
                    e.preventDefault();
                    this.editor.instance.updateChecked(e, false);
                }
                break;
            case 13: // Enter
                this.closeEditingCell().pipe(takeUntil(this.destroy$)).pipe(debounceTime(100)).subscribe((/**
                 * @param {?} f
                 * @return {?}
                 */
                function (f) {
                    if (f) {
                        _this.dg.dgContainer.nativeElement.focus();
                        /** @type {?} */
                        var lastEditCell = _this.findLastEditCell();
                        /** @type {?} */
                        var enterParam = { gird: _this.dg, cell: _this.dg.currentCell, event: e, lastCell: lastEditCell.field === _this.column.field };
                        if (_this.column.onEnterHandler) {
                            _this.column.onEnterHandler(enterParam);
                        }
                        else {
                            /** @type {?} */
                            var nextTd = _this.dg.findNextCell(_this.column.field, 'right');
                            if (_this.dg.currentCell.lastRow && (!nextTd || lastEditCell.field === _this.column.field)) {
                                _this.dg.lastCellEnterHandler.emit(enterParam);
                            }
                        }
                    }
                }));
                break;
            case 27: // ESC
                this.cancelCellEditing();
                break;
            case 9: // Tab
                e.stopPropagation();
                this.dg.clickDelay = 0;
                if (e.shiftKey) {
                    this.closeEditingCell().pipe(takeUntil(this.destroy$)).subscribe((/**
                     * @param {?} f
                     * @return {?}
                     */
                    function (f) {
                        if (f) {
                            _this.movePrevCellAndEdit();
                        }
                    }));
                }
                else {
                    this.closeEditingCell().pipe(takeUntil(this.destroy$)).subscribe((/**
                     * @param {?} f
                     * @return {?}
                     */
                    function (f) {
                        if (f) {
                            _this.moveNextCellAndEdit(e);
                        }
                    }));
                    e.preventDefault();
                }
                break;
            case 40: // ↓
                /** 选中下一行，且当前列进入编辑态; 仅普通文本输入框支持 */
                if (this.column.editor.type === 'textbox') {
                    this.closeEditingCell().pipe(takeUntil(this.destroy$)).subscribe((/**
                     * @param {?} f
                     * @return {?}
                     */
                    function (f) {
                        if (f) {
                            _this.selectNextRowAndEditCell(_this.column.field, 'down');
                        }
                    }));
                    e.preventDefault();
                }
                break;
            case 38: // ↑
                /** 选中上一行，且当前列进入编辑态; 仅普通文本输入框支持 */
                if (this.column.editor.type === 'textbox') {
                    this.closeEditingCell().pipe(takeUntil(this.destroy$)).subscribe((/**
                     * @param {?} f
                     * @return {?}
                     */
                    function (f) {
                        if (f) {
                            _this.selectNextRowAndEditCell(_this.column.field, 'up');
                        }
                    }));
                    e.preventDefault();
                }
                break;
        }
    };
    /**
     * @private
     * @param {?} field
     * @param {?=} tdElement
     * @return {?}
     */
    DatagridCellEditableDirective.prototype.selectCell = /**
     * @private
     * @param {?} field
     * @param {?=} tdElement
     * @return {?}
     */
    function (field, tdElement) {
        var _this = this;
        this.closeEditingCell().subscribe((/**
         * @param {?} t
         * @return {?}
         */
        function (t) {
            if (!t) {
                return;
            }
            tdElement = tdElement || _this.el.nativeElement;
            _this.clearCellSelectedClass();
            if (field && field !== _this.dg.ControlPanelFeild && field.indexOf('farris-datagrid-column') === -1) {
                _this.render.addClass(tdElement, CELL_SELECTED_CLS);
            }
            // this.dr.drHover.setRowHoverCls(false);
            _this.dfs.setCurrentCell(_this.dr, field, tdElement, _this.dc);
            if (!_this.dg.fast && _this.column.fixed !== 'left' && _this.column.fixed !== 'right') {
                _this.moveScrollbar(tdElement);
            }
        }));
    };
    /**
     * @private
     * @param {?} td
     * @return {?}
     */
    DatagridCellEditableDirective.prototype.moveScrollbar = /**
     * @private
     * @param {?} td
     * @return {?}
     */
    function (td) {
        /** @type {?} */
        var tdPosLeft = td.offsetLeft + td.offsetWidth;
        /** @type {?} */
        var containerWidth = this.dg.width - this.dgb.columnsGroup.leftFixedWidth - this.dgb.columnsGroup.rightFixedWidth;
        /** @type {?} */
        var tdRect = td.getBoundingClientRect();
        /** @type {?} */
        var scrollContainer = this.dgb.ps.elementRef.nativeElement;
        /** @type {?} */
        var psContainer = scrollContainer.getBoundingClientRect();
        /** @type {?} */
        var scrollTop = scrollContainer.scrollTop;
        /** @type {?} */
        var scrollLeft = scrollContainer.scrollLeft;
        /** @type {?} */
        var scrollbarXLeft = this.dgb.ps.elementRef.nativeElement.scrollLeft;
        if (tdPosLeft > containerWidth) {
            /** @type {?} */
            var x = tdPosLeft - containerWidth + 2;
            // const x = tdPosLeft - this.dgb.ps.instance.scrollbarXWidth + 2;
            if (x > scrollbarXLeft) {
                this.dgb.ps.scrollToX(x);
            }
        }
        else {
            // if (tdRect.x < psContainer.x) {
            //     const x = scrollLeft - tdRect.x;
            //     this.dgb.ps.scrollToX(x);
            // }
            if (td.offsetLeft < scrollLeft) {
                this.dgb.ps.scrollToX(td.offsetLeft);
            }
        }
        /** @type {?} */
        var tdPosTop = tdRect.top - psContainer.top + tdRect.height;
        if (tdPosTop > psContainer.height) {
            /** @type {?} */
            var y = tdPosTop - psContainer.height;
            this.dgb.ps.scrollToY(scrollTop + y);
        }
        else {
            if (tdRect.y < psContainer.y) {
                this.dgb.ps.scrollToY(scrollTop - (psContainer.y - tdRect.y));
            }
        }
    };
    /**
     * @private
     * @param {?=} event
     * @return {?}
     */
    DatagridCellEditableDirective.prototype.moveNextCellAndEdit = /**
     * @private
     * @param {?=} event
     * @return {?}
     */
    function (event) {
        var _this = this;
        // if (!this.closeEditingCell()) {
        //     return;
        // }
        // const fieldIndex = this.dfs.getColumnIndex(this.column.field);
        /** @type {?} */
        var fieldIndex = this.dg.colGroup.columns.findIndex((/**
         * @param {?} n
         * @return {?}
         */
        function (n) { return (n.id && n.id === _this.column.id) || n.field === _this.column.field; }));
        if (fieldIndex + 1 < this.dgb.columnsGroup.columns.length) {
            /** @type {?} */
            var nextColumn = this.dgb.columnsGroup.columns[fieldIndex + 1];
            /** @type {?} */
            var nextTd = this.dg.findNextTd(nextColumn);
            if (nextTd && (!nextColumn.fixed || nextColumn.fixed === 'center')) {
                this.moveScrollbar(nextTd);
            }
            // const nextTd = this.dg.currentCell.cellElement.nextElementSibling;
            if (nextColumn && ((!nextColumn.editor && !nextColumn.editorTemplate) || this.isReadonly(nextColumn))) {
                if (nextTd) {
                    nextTd.selectCell(event, nextTd);
                }
                return;
            }
            if (nextTd) {
                nextTd.focus();
                if (nextColumn.editor || nextColumn.editorTemplate) {
                    nextTd.editCell();
                    this.dgs.onCellEdit(nextTd);
                }
            }
        }
        else {
            // next row's first cell to editing
            /** @type {?} */
            var nextTr = this.dg.currentCell.cellElement.parentElement.nextElementSibling;
            if (nextTr && nextTr.tagName === 'TR') {
                // nextTr.children.find(td => td.editCell).editCell();
                /** @type {?} */
                var firstEditor = false;
                /** @type {?} */
                var i = 0;
                while (!firstEditor) {
                    firstEditor = !!nextTr.children[i].editCell;
                    if (!firstEditor) {
                        i++;
                    }
                }
                if (this.dg.selectionMode === 'default') {
                    this.dg.clearCheckeds();
                }
                nextTr.children[i].editCell();
            }
        }
    };
    /**
     * @private
     * @return {?}
     */
    DatagridCellEditableDirective.prototype.movePrevCellAndEdit = /**
     * @private
     * @return {?}
     */
    function () {
        // if (!this.closeEditingCell()) {
        //     return;
        // }
        /** @type {?} */
        var fieldIndex = this.dfs.getColumnIndex(this.column.field);
        if (fieldIndex - 1 >= 0) {
            /** @type {?} */
            var nextColumn = this.dgb.columnsGroup.normalColumns[fieldIndex - 1];
            if (nextColumn && this.isReadonly(nextColumn)) {
                return;
            }
            /** @type {?} */
            var nextTd = this.dg.currentCell.cellElement.previousElementSibling;
            if (nextTd) {
                // this.selectCell(nextColumn.field, nextTd);
                nextTd.focus();
                if (nextColumn.editor) {
                    // this.dfs.editCell();
                    nextTd.click();
                    this.dgs.onCellEdit(nextTd);
                }
            }
        }
    };
    /**
     * @private
     * @param {?} cellFieldName
     * @param {?} dir
     * @return {?}
     */
    DatagridCellEditableDirective.prototype.selectNextRowAndEditCell = /**
     * @private
     * @param {?} cellFieldName
     * @param {?} dir
     * @return {?}
     */
    function (cellFieldName, dir) {
        if (!this.dg.currentCell) {
            this.dg.writeConsole('当前选中单元格为空');
            return;
        }
        /** @type {?} */
        var p = dir === 'down' ? 'nextElementSibling' : 'previousElementSibling';
        /** @type {?} */
        var nextTr = this.dg.currentCell.cellElement.parentElement[p];
        if (nextTr && nextTr.tagName === 'TR') {
            /** @type {?} */
            var td = Array.from(nextTr.children).find((/**
             * @param {?} td
             * @return {?}
             */
            function (td) { return td.getAttribute('field') == cellFieldName; }));
            if (td && td.editCell) {
                if (this.dg.selectionMode === 'default') {
                    this.dg.clearCheckeds();
                }
                td.editCell();
            }
        }
    };
    /**
     * @private
     * @return {?}
     */
    DatagridCellEditableDirective.prototype.clearCellSelectedClass = /**
     * @private
     * @return {?}
     */
    function () {
        this.dg.removeCellSelectedCls();
    };
    /**
     * @private
     * @return {?}
     */
    DatagridCellEditableDirective.prototype.setCellClsWithEditorType = /**
     * @private
     * @return {?}
     */
    function () {
        // 设置当前选中单元格样式
        if (this.dg.currentCell && this.dg.enableHighlightCell) {
            if (this.dg.currentCell.field === this.column.field && this.dg.currentCell.rowId === this.rowData[this.dg.idField] && !this.dc.isEditing) {
                this.clearCellSelectedClass();
                this.render.addClass(this.el.nativeElement, CELL_SELECTED_CLS);
            }
        }
        if (!this.dg.enableEditCellStyle) {
            return;
        }
        /** @type {?} */
        var td = this.el.nativeElement;
        this.cleanOtherEditorIcon(td);
        // 当前行禁用，不允许编辑。
        if (this.dr.disabled) {
            return;
        }
        if (!this.column.editor) {
            return;
        }
        if (this.isReadonly()) {
            return;
        }
        /** @type {?} */
        var editorType = this.column.editor.type;
        /** @type {?} */
        var cls = this.column.align === 'right' ? 'allow-edit-cell-left' : 'allow-edit-cell';
        this.render.addClass(td, cls);
        this.render.addClass(td, ALLOW_EDIT_CELL_HIGHLIGHT_CLS[editorType]);
    };
    /**
     * @private
     * @param {?} td
     * @return {?}
     */
    DatagridCellEditableDirective.prototype.cleanOtherEditorIcon = /**
     * @private
     * @param {?} td
     * @return {?}
     */
    function (td) {
        /** @type {?} */
        var values = Object.values(ALLOW_EDIT_CELL_HIGHLIGHT_CLS);
        values.forEach((/**
         * @param {?} v
         * @return {?}
         */
        function (v) {
            if (td.className.indexOf(v) > -1) {
                td.className = td.className.replace('allow-edit-cell-left', '').replace('allow-edit-cell', '');
                td.className = td.className.replace(v, '');
            }
        }));
    };
    DatagridCellEditableDirective.decorators = [
        { type: Directive, args: [{
                    selector: '[cell-editable]',
                    exportAs: 'cellEditable'
                },] }
    ];
    /** @nocollapse */
    DatagridCellEditableDirective.ctorParameters = function () { return [
        { type: Injector },
        { type: ElementRef },
        { type: Renderer2 },
        { type: DatagridComponent, decorators: [{ type: Inject, args: [forwardRef((/**
                         * @return {?}
                         */
                        function () { return DatagridComponent; })),] }] },
        { type: NgZone }
    ]; };
    DatagridCellEditableDirective.propDecorators = {
        rowData: [{ type: Input, args: ['cell-editable',] }],
        column: [{ type: Input }],
        dc: [{ type: ContentChild, args: [DatagridCellComponent,] }]
    };
    return DatagridCellEditableDirective;
}());
export { DatagridCellEditableDirective };
if (false) {
    /** @type {?} */
    DatagridCellEditableDirective.prototype.rowData;
    /** @type {?} */
    DatagridCellEditableDirective.prototype.column;
    /**
     * @type {?}
     * @private
     */
    DatagridCellEditableDirective.prototype.clickTimer;
    /**
     * @type {?}
     * @private
     */
    DatagridCellEditableDirective.prototype.cellclick;
    /**
     * @type {?}
     * @private
     */
    DatagridCellEditableDirective.prototype.celldblclick;
    /**
     * @type {?}
     * @private
     */
    DatagridCellEditableDirective.prototype.bindCellEventSubscription;
    /**
     * @type {?}
     * @private
     */
    DatagridCellEditableDirective.prototype.editorInputKeydownEvent;
    /** @type {?} */
    DatagridCellEditableDirective.prototype.editor;
    /** @type {?} */
    DatagridCellEditableDirective.prototype.formControl;
    /** @type {?} */
    DatagridCellEditableDirective.prototype.cellEditorRef;
    /** @type {?} */
    DatagridCellEditableDirective.prototype.dc;
    /**
     * @type {?}
     * @private
     */
    DatagridCellEditableDirective.prototype.dgb;
    /**
     * @type {?}
     * @private
     */
    DatagridCellEditableDirective.prototype.dr;
    /**
     * @type {?}
     * @private
     */
    DatagridCellEditableDirective.prototype.dfs;
    /**
     * @type {?}
     * @private
     */
    DatagridCellEditableDirective.prototype.dgs;
    /**
     * @type {?}
     * @private
     */
    DatagridCellEditableDirective.prototype.cellEditorCreatedSubscription;
    /**
     * @type {?}
     * @private
     */
    DatagridCellEditableDirective.prototype.cellEditorDestorySubscription;
    /**
     * @type {?}
     * @private
     */
    DatagridCellEditableDirective.prototype.destroy$;
    /**
     * @type {?}
     * @private
     */
    DatagridCellEditableDirective.prototype.validMessageEle;
    /**
     * @type {?}
     * @private
     */
    DatagridCellEditableDirective.prototype.injector;
    /** @type {?} */
    DatagridCellEditableDirective.prototype.el;
    /**
     * @type {?}
     * @private
     */
    DatagridCellEditableDirective.prototype.render;
    /** @type {?} */
    DatagridCellEditableDirective.prototype.dg;
    /** @type {?} */
    DatagridCellEditableDirective.prototype.ngZone;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGF0YWdyaWQtY2VsbC1lZGl0YWJsZS5kaXJlY3RpdmUuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZmFycmlzL3VpLWRhdGFncmlkLyIsInNvdXJjZXMiOlsibGliL2NvbXBvbmVudHMvYm9keS9kYXRhZ3JpZC1jZWxsLWVkaXRhYmxlLmRpcmVjdGl2ZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7O0FBUUEsT0FBTyxFQUFFLFNBQVMsRUFBRSxLQUFLLEVBQUUsVUFBVSxFQUFFLFNBQVMsRUFBVSxZQUFZLEVBQWEsUUFBUSxFQUFFLFVBQVUsRUFBRSxNQUFNLEVBQWlCLE1BQU0sRUFBNEIsTUFBTSxlQUFlLENBQUM7QUFFeEwsT0FBTyxFQUFFLE1BQU0sRUFBNEIsWUFBWSxFQUFFLFNBQVMsRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBQzNGLE9BQU8sRUFBRSxlQUFlLEVBQUUsTUFBTSxtQ0FBbUMsQ0FBQztBQUNwRSxPQUFPLEVBQUUscUJBQXFCLEVBQUUsTUFBTSwyQkFBMkIsQ0FBQztBQUNsRSxPQUFPLEVBQUUscUJBQXFCLEVBQUUsTUFBTSwyQkFBMkIsQ0FBQztBQUNsRSxPQUFPLEVBQUUsb0JBQW9CLEVBQUUsTUFBTSwwQkFBMEIsQ0FBQztBQUVoRSxPQUFPLEVBQUUscUJBQXFCLEVBQUUsTUFBTSx3Q0FBd0MsQ0FBQztBQUMvRSxPQUFPLEVBQUUsaUJBQWlCLEVBQUUsTUFBTSwwQkFBMEIsQ0FBQztBQUM3RCxPQUFPLEVBQUUsaUJBQWlCLEVBQUUsZ0JBQWdCLEVBQUUsNkJBQTZCLEVBQTJCLE1BQU0sc0JBQXNCLENBQUM7QUFFbkksT0FBTyxFQUFFLEVBQUUsRUFBaUIsSUFBSSxFQUFFLE9BQU8sRUFBZSxNQUFNLE1BQU0sQ0FBQztBQUNyRSxPQUFPLEVBQUUsS0FBSyxFQUFFLE1BQU0sbUJBQW1CLENBQUM7QUFFMUM7SUFnQ0ksdUNBQ1ksUUFBa0IsRUFBUyxFQUFjLEVBQVUsTUFBaUIsRUFDeEIsRUFBcUIsRUFBUyxNQUFj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VUFBVTs7O3dCQUFDLGNBQU0sT0FBQSxpQkFBaUIsRUFBakIsQ0FBaUIsRUFBQztnQkFqRDZFLE1BQU07OzswQkFvQmpJLEtBQUssU0FBQyxlQUFlO3lCQUNyQixLQUFLO3FCQWNMLFlBQVksU0FBQyxxQkFBcUI7O0lBZ2xDdkMsb0NBQUM7Q0FBQSxBQXBtQ0QsSUFvbUNDO1NBaG1DWSw2QkFBNkI7OztJQUN0QyxnREFBcUM7O0lBQ3JDLCtDQUE0Qjs7Ozs7SUFFNUIsbURBQXdCOzs7OztJQUV4QixrREFBdUI7Ozs7O0lBQ3ZCLHFEQUEwQjs7Ozs7SUFDMUIsa0VBQWdEOzs7OztJQUVoRCxnRUFBcUM7O0lBQ3JDLCtDQUFZOztJQUNaLG9EQUF5Qjs7SUFDekIsc0RBQW1COztJQUduQiwyQ0FBK0Q7Ozs7O0lBQy9ELDRDQUFtQzs7Ozs7SUFDbkMsMkNBQWlDOzs7OztJQUNqQyw0Q0FBbUM7Ozs7O0lBQ25DLDRDQUE2Qjs7Ozs7SUFHN0Isc0VBQTZDOzs7OztJQUM3QyxzRUFBNkM7Ozs7O0lBQzdDLGlEQUFpQzs7Ozs7SUFDakMsd0RBQStCOzs7OztJQUczQixpREFBMEI7O0lBQUUsMkNBQXFCOzs7OztJQUFFLCtDQUF5Qjs7SUFDNUUsMkNBQXlFOztJQUFFLCtDQUFxQiIsInNvdXJjZXNDb250ZW50IjpbIi8qXHJcbiAqIEBBdXRob3I6IOeWr+eLguengOaJjShMdWNhcyBIdWFuZylcclxuICogQERhdGU6IDIwMTktMDgtMDYgMDc6NDM6MDdcclxuICogQExhc3RFZGl0b3JzOiDnlq/ni4Lnp4DmiY0oTHVjYXMgSHVhbmcpXHJcbiAqIEBMYXN0RWRpdFRpbWU6IDIwMTktMTEtMTkgMTU6NDg6MjdcclxuICogQFFROiAxMDU1ODE4MjM5XHJcbiAqIEBWZXJzaW9uOiB2MC4wLjFcclxuICovXHJcbmltcG9ydCB7IERpcmVjdGl2ZSwgSW5wdXQsIEVsZW1lbnRSZWYsIFJlbmRlcmVyMiwgT25Jbml0LCBDb250ZW50Q2hpbGQsIE9uRGVzdHJveSwgSW5qZWN0b3IsIGZvcndhcmRSZWYsIEluamVjdCwgQWZ0ZXJWaWV3SW5pdCwgTmdab25lLCBPbkNoYW5nZXMsIFNpbXBsZUNoYW5nZXMgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgRm9ybUNvbnRyb2wgfSBmcm9tICdAYW5ndWxhci9mb3Jtcyc7XHJcbmltcG9ydCB7IGZpbHRlciwgbWFwLCBzd2l0Y2hNYXAsIHRha2VMYXN0LCBkZWJvdW5jZVRpbWUsIHRha2VVbnRpbCB9IGZyb20gJ3J4anMvb3BlcmF0b3JzJztcclxuaW1wb3J0IHsgRGF0YWdyaWRTZXJ2aWNlIH0gZnJvbSAnLi8uLi8uLi9zZXJ2aWNlcy9kYXRhZ3JpZC5zZXJ2aWNlJztcclxuaW1wb3J0IHsgRGF0YWdyaWRDZWxsQ29tcG9uZW50IH0gZnJvbSAnLi9kYXRhZ3JpZC1jZWxsLmNvbXBvbmVudCc7XHJcbmltcG9ydCB7IERhdGFncmlkQm9keUNvbXBvbmVudCB9IGZyb20gJy4vZGF0YWdyaWQtYm9keS5jb21wb25lbnQnO1xyXG5pbXBvcnQgeyBEYXRhZ3JpZFJvd0RpcmVjdGl2ZSB9IGZyb20gJy4vZGF0YWdyaWQtcm93LmRpcmVjdGl2ZSc7XHJcbmltcG9ydCB7IERhdGFDb2x1bW4gfSBmcm9tICcuLy4uLy4uL3R5cGVzL2RhdGEtY29sdW1uJztcclxuaW1wb3J0IHsgRGF0YWdyaWRGYWNhZGVTZXJ2aWNlIH0gZnJvbSAnLi4vLi4vc2VydmljZXMvZGF0YWdyaWQtZmFjYWRlLnNlcnZpY2UnO1xyXG5pbXBvcnQgeyBEYXRhZ3JpZENvbXBvbmVudCB9IGZyb20gJy4uLy4uL2RhdGFncmlkLmNvbXBvbmVudCc7XHJcbmltcG9ydCB7IENFTExfU0VMRUNURURfQ0xTLCBDRUxMX0VESVRJTkdfQ0xTLCBBTExPV19FRElUX0NFTExfSElHSExJR0hUX0NMUywgVFJfUFJFRklYLCBUUl9JRF9QUkVGSVggfSBmcm9tICcuLi8uLi90eXBlcy9jb25zdGFudCc7XHJcbmltcG9ydCB7IERvbUhhbmRsZXIgfSBmcm9tICcuLi8uLi9zZXJ2aWNlcy9kb21oYW5kbGVyJztcclxuaW1wb3J0IHsgb2YsIFN1YnNjcmlwdGlvbiwgIG5vb3AsIFN1YmplY3QsIE9ic2VydmFibGUgIH0gZnJvbSAncnhqcyc7XHJcbmltcG9ydCB7IFV0aWxzIH0gZnJvbSAnLi4vLi4vdXRpbHMvdXRpbHMnO1xyXG5cclxuQERpcmVjdGl2ZSh7XHJcbiAgICBzZWxlY3RvcjogJ1tjZWxsLWVkaXRhYmxlXScsXHJcbiAgICBleHBvcnRBczogJ2NlbGxFZGl0YWJsZSdcclxufSlcclxuZXhwb3J0IGNsYXNzIERhdGFncmlkQ2VsbEVkaXRhYmxlRGlyZWN0aXZlIGltcGxlbWVudHMgT25Jbml0LCBPbkRlc3Ryb3ksIE9uQ2hhbmdlcywgQWZ0ZXJWaWV3SW5pdCB7XHJcbiAgICBASW5wdXQoJ2NlbGwtZWRpdGFibGUnKSByb3dEYXRhOiBhbnk7XHJcbiAgICBASW5wdXQoKSBjb2x1bW46IERhdGFDb2x1bW47XHJcblxyXG4gICAgcHJpdmF0ZSBjbGlja1RpbWVyOiBhbnk7XHJcblxyXG4gICAgcHJpdmF0ZSBjZWxsY2xpY2s6IGFueTtcclxuICAgIHByaXZhdGUgY2VsbGRibGNsaWNrOiBhbnk7XHJcbiAgICBwcml2YXRlIGJpbmRDZWxsRXZlbnRTdWJzY3JpcHRpb246IFN1YnNjcmlwdGlvbjtcclxuXHJcbiAgICBwcml2YXRlIGVkaXRvcklucHV0S2V5ZG93bkV2ZW50OiBhbnk7XHJcbiAgICBlZGl0b3I6IGFueTtcclxuICAgIGZvcm1Db250cm9sOiBGb3JtQ29udHJvbDtcclxuICAgIGNlbGxFZGl0b3JSZWY6IGFueTtcclxuXHJcblxyXG4gICAgQENvbnRlbnRDaGlsZChEYXRhZ3JpZENlbGxDb21wb25lbnQpIGRjOiBEYXRhZ3JpZENlbGxDb21wb25lbnQ7XHJcbiAgICBwcml2YXRlIGRnYjogRGF0YWdyaWRCb2R5Q29tcG9uZW50O1xyXG4gICAgcHJpdmF0ZSBkcjogRGF0YWdyaWRSb3dEaXJlY3RpdmU7XHJcbiAgICBwcml2YXRlIGRmczogRGF0YWdyaWRGYWNhZGVTZXJ2aWNlO1xyXG4gICAgcHJpdmF0ZSBkZ3M6IERhdGFncmlkU2VydmljZTtcclxuXHJcbiAgICAvLyBwcml2YXRlIF9yZWFkb25seSQgPSBudWxsO1xyXG4gICAgcHJpdmF0ZSBjZWxsRWRpdG9yQ3JlYXRlZFN1YnNjcmlwdGlvbiA9IG51bGw7XHJcbiAgICBwcml2YXRlIGNlbGxFZGl0b3JEZXN0b3J5U3Vic2NyaXB0aW9uID0gbnVsbDtcclxuICAgIHByaXZhdGUgZGVzdHJveSQgPSBuZXcgU3ViamVjdCgpO1xyXG4gICAgcHJpdmF0ZSB2YWxpZE1lc3NhZ2VFbGUgPSBudWxsO1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKFxyXG4gICAgICAgIHByaXZhdGUgaW5qZWN0b3I6IEluamVjdG9yLCBwdWJsaWMgZWw6IEVsZW1lbnRSZWYsIHByaXZhdGUgcmVuZGVyOiBSZW5kZXJlcjIsXHJcbiAgICAgICAgQEluamVjdChmb3J3YXJkUmVmKCgpID0+IERhdGFncmlkQ29tcG9uZW50KSkgcHVibGljIGRnOiBEYXRhZ3JpZENvbXBvbmVudCwgcHVibGljIG5nWm9uZTogTmdab25lKSB7XHJcbiAgICAgICAgdGhpcy5kZ2IgPSB0aGlzLmluamVjdG9yLmdldChEYXRhZ3JpZEJvZHlDb21wb25lbnQpO1xyXG4gICAgICAgIHRoaXMuZHIgPSB0aGlzLmluamVjdG9yLmdldChEYXRhZ3JpZFJvd0RpcmVjdGl2ZSk7XHJcbiAgICAgICAgdGhpcy5kZnMgPSB0aGlzLmluamVjdG9yLmdldChEYXRhZ3JpZEZhY2FkZVNlcnZpY2UpO1xyXG4gICAgICAgIHRoaXMuZGdzID0gdGhpcy5pbmplY3Rvci5nZXQoRGF0YWdyaWRTZXJ2aWNlKTtcclxuXHJcblxyXG4gICAgICAgIGlmICghdGhpcy5jZWxsRWRpdG9yQ3JlYXRlZFN1YnNjcmlwdGlvbikge1xyXG4gICAgICAgICAgICB0aGlzLmNlbGxFZGl0b3JDcmVhdGVkU3Vic2NyaXB0aW9uID0gdGhpcy5kZ3MuY2VsbEVkaXRvckNyZWF0ZWQucGlwZShcclxuICAgICAgICAgICAgICAgIHRha2VVbnRpbCh0aGlzLmRlc3Ryb3kkKVxyXG4gICAgICAgICAgICApLnBpcGUoXHJcbiAgICAgICAgICAgICAgICBmaWx0ZXIoKHsgY29sdW1uLCBlZGl0b3JSZWYsIGNlbGxFZGl0b3JSZWYsIHRlbXBsYXRlUmVmIH0pID0+IHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gY29sdW1uLmZpZWxkID09PSB0aGlzLmNvbHVtbi5maWVsZCAmJiB0aGlzLmRnLnNlbGVjdGVkUm93LmlkID09PSB0aGlzLmRyLnJvd0lkO1xyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgKS5zdWJzY3JpYmUoKHsgZWRpdG9yUmVmLCBjZWxsRWRpdG9yUmVmLCB0ZW1wbGF0ZVJlZiB9KSA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAoZWRpdG9yUmVmKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpc1snZWRpdG9yJ10gPSBlZGl0b3JSZWYuaW5zdGFuY2U7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpc1snZm9ybUNvbnRyb2wnXSA9IHRoaXMuZWRpdG9yLmZvcm1Db250cm9sIGFzIEZvcm1Db250cm9sO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY2VsbEVkaXRvclJlZiA9IGNlbGxFZGl0b3JSZWY7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5lbWl0QmVnaW5FZGl0KCk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXNbJ2Zvcm1Db250cm9sJ10gPSB0aGlzLmRyLmZvcm0uZ2V0KHRoaXMuY29sdW1uLmZpZWxkKSBhcyBGb3JtQ29udHJvbDtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmJpbmRFZGl0b3JJbnB1dEV2ZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5kZy5iZWdpbkVkaXQuZW1pdCh7IGVkaXRvcjogbnVsbCwgY29sdW1uOiB0aGlzLmNvbHVtbiwgcm93RGF0YTogdGhpcy5yb3dEYXRhLCBncmlkSW5zdGFuY2U6IHRoaXMuZGcsIHRlbXBsYXRlOiB0ZW1wbGF0ZVJlZiB9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICB0aGlzLmRnLnJvd0NsaWNrLmVtaXQoeyBkYXRhOiB0aGlzLnJvd0RhdGEsIGdyaWQ6IHRoaXMuZGcsIGRibGNsaWNrOiBmYWxzZSB9KTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLmRnLmRncy5jZWxsRWRpdG9yRGVzdG9yeS5waXBlKFxyXG4gICAgICAgICAgICB0YWtlVW50aWwodGhpcy5kZXN0cm95JClcclxuICAgICAgICApLnBpcGUoXHJcbiAgICAgICAgICAgIGZpbHRlcigoeyBjb2x1bW4gfSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZGcuc2VsZWN0ZWRSb3cgJiYgY29sdW1uLmZpZWxkID09PSB0aGlzLmNvbHVtbi5maWVsZCAmJiB0aGlzLmRnLnNlbGVjdGVkUm93LmlkID09PSB0aGlzLmRyLnJvd0lkO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICkuc3Vic2NyaWJlKChlOiBhbnkpID0+IHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuZGcuZWRpdE1vZGUgPT09ICdjZWxsJykge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5kZy5zZWxlY3RlZFJvdy5lZGl0b3JzID0gW107XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5kZy5jdXJyZW50Q2VsbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZGcuY3VycmVudENlbGwuZWRpdG9yID0gbnVsbDtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmRnLmN1cnJlbnRDZWxsLmNlbGxFZGl0b3JSZWYgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMudW5CaW5kRWRpdG9ySW5wdXRFdmVudCgpO1xyXG4gICAgICAgICAgICB0aGlzLmNlbGxFZGl0b3JSZWYgPSBudWxsO1xyXG4gICAgICAgICAgICB0aGlzLmZvcm1Db250cm9sID0gbnVsbDtcclxuICAgICAgICAgICAgdGhpcy5lZGl0b3IgPSBudWxsO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5yZW1vdmVWYWxpZE1lc3NhZ2UoKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBuZ09uSW5pdCgpIHtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgbmdPbkNoYW5nZXMoY2hhbmdlczogU2ltcGxlQ2hhbmdlcykge1xyXG4gICAgICAgIGlmIChjaGFuZ2VzLnJvd0RhdGEgJiYgIWNoYW5nZXMucm93RGF0YS5pc0ZpcnN0Q2hhbmdlKCkpIHtcclxuICAgICAgICAgICAgdGhpcy5pbml0Q2VsbEV2ZW50KCk7XHJcbiAgICAgICAgICAgIHRoaXMuc2V0Q2VsbENsc1dpdGhFZGl0b3JUeXBlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIG5nQWZ0ZXJWaWV3SW5pdCgpIHtcclxuICAgICAgICB0aGlzLmluaXRDZWxsRXZlbnQoKTtcclxuICAgICAgICB0aGlzLnNldENlbGxDbHNXaXRoRWRpdG9yVHlwZSgpO1xyXG4gICAgfVxyXG5cclxuXHJcbiAgICBwcml2YXRlIHJ1blpvbmVDbGljayhlOiBhbnkpIHtcclxuICAgICAgICBpZih0aGlzWyd6b25lQ2xpY2snXSkge1xyXG5cclxuICAgICAgICAgICAgT2JqZWN0LmFzc2lnbihlLCB7cm93RGF0YTogdGhpcy5yb3dEYXRhfSk7XHJcblxyXG4gICAgICAgICAgICB0aGlzWyd6b25lQ2xpY2snXS5mb3JFYWNoKG4gPT4ge1xyXG4gICAgICAgICAgICAgICAgbi50YXJnZXQuc3R5bGUucG9pbnRlckV2ZW50cyA9ICdhdXRvJztcclxuICAgICAgICAgICAgICAgIGlmIChuLmNhbGxiYWNrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbi5jYWxsYmFjayhlKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAobi5oYW5kbGVyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbi5oYW5kbGVyKGUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGlmICh0aGlzLmRnLmlzRkYpIHtcclxuICAgICAgICAgICAgICAgIGUudGFyZ2V0WydfX3pvbmVfc3ltYm9sX19jbGlja2ZhbHNlJ10gPSB0aGlzWyd6b25lQ2xpY2snXTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGluaXRDZWxsRXZlbnQoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuY29sdW1uICYmICh0aGlzLmNvbHVtbi5lZGl0b3IgfHwgdGhpcy5jb2x1bW4uZWRpdG9yVGVtcGxhdGUpKSB7XHJcbiAgICAgICAgICAgIGlmICghdGhpcy5kZy5jbGlja1RvRWRpdCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jZWxsZGJsY2xpY2sgPSB0aGlzLnJlbmRlci5saXN0ZW4odGhpcy5lbC5uYXRpdmVFbGVtZW50LCAnZGJsY2xpY2snLCAoZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMub25EYmxDbGlja0NlbGwoZSk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLmVsLm5hdGl2ZUVsZW1lbnQuZWRpdCA9IChlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNsb3NlRWRpdGluZ0NlbGwoKS5zdWJzY3JpYmUoKGNhbkVkaXQ6IGJvb2xlYW4pID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoY2FuRWRpdCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9uQ2xpY2tDZWxsKGUpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLmRnLnNlbGVjdGVkUm93IHx8IHRoaXMuZGcuc2VsZWN0ZWRSb3cuaWQgIT09IHRoaXMuZHIucm93SWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZGcuc2VsZWN0Um93KHRoaXMuZHIucm93SWQsIHRydWUsIGZhbHNlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5ydW5ab25lQ2xpY2soZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5lbC5uYXRpdmVFbGVtZW50LmVkaXRDZWxsID0gKGUpID0+IHtcclxuICAgICAgICAgICAgICAgIHRoaXMub3BlbkNlbGxFZGl0b3IoKTtcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLmNsaWNrVGltZXIgPSAwO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgXHJcbiAgICAgICAgY29uc3QgZXhjbHVkZVRhcmdldCA9IChlOiBhbnkpID0+IHtcclxuICAgICAgICAgICAgcmV0dXJuIGUudGFyZ2V0LnBhcmVudEVsZW1lbnQubm9kZU5hbWUgIT09ICdHUklELUJPRFktQ0VMTCcgJiZcclxuICAgICAgICAgICAgZS50YXJnZXQubm9kZU5hbWUgIT09ICdJTlBVVCcgJiYgIGUudGFyZ2V0Lm5vZGVOYW1lICE9PSAnVEVYVEFSRUEnICYmXHJcbiAgICAgICAgICAgICEoZS50YXJnZXQuY2xhc3NOYW1lLmluZGV4T2YoJ2N1c3RvbS1jb250cm9sLWxhYmVsJykgPiAtMSAmJiBcclxuICAgICAgICAgICAgZS50YXJnZXQucGFyZW50RWxlbWVudCAmJiBlLnRhcmdldC5wYXJlbnRFbGVtZW50LmNsYXNzTmFtZS5pbmRleE9mKCdjdXN0b20tY29udHJvbCcpID4gLTEpICYmXHJcbiAgICAgICAgICAgICFlLnRhcmdldC5jbG9zZXN0KCdpbnB1dC1ncm91cCcpICYmICFlLnRhcmdldC5jbG9zZXN0KCdmYXJyaXMtc3dpdGNoJykgJiZcclxuICAgICAgICAgICAgIWUudGFyZ2V0LmNsb3Nlc3QoJ2ZhcnJpcy1udW1iZXItc3Bpbm5lcicpICYmXHJcbiAgICAgICAgICAgICFlLnRhcmdldC5jbG9zZXN0KCdmYXJyaXMtZGF0ZXBpY2tlcicpICYmXHJcbiAgICAgICAgICAgICFlLnRhcmdldC5jbG9zZXN0KCdmYXJyaXMtdGltZS1waWNrZXInKSAmJiBcclxuICAgICAgICAgICAgIWUudGFyZ2V0LmNsb3Nlc3QoJ2dyaWQtZWRpdG9yLXRleHRhcmVhJykgJiZcclxuICAgICAgICAgICAgIWUudGFyZ2V0LmNsb3Nlc3QoJ2ZhcnJpcy1jaGVja2JveGdyb3VwJykgJiYgXHJcbiAgICAgICAgICAgICFlLnRhcmdldC5jbG9zZXN0KCdncmlkLWVkaXRvci1jaGVja2JveCcpICYmICFlLnRhcmdldC5jbG9zZXN0KCdmYXJyaXMtcmFkaW9ncm91cCcpICYmXHJcbiAgICAgICAgICAgICFlLnRhcmdldC5jbG9zZXN0KCdmYXJyaXMtb3JnYW5pemF0aW9uLXNlbGVjdG9yJykgJiYgIWUudGFyZ2V0LmNsb3Nlc3QoJ2ZhcnJpcy1wZXJzb25uZWwtc2VsZWN0b3InKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICh0aGlzLmNvbHVtbi5wcm94eUNsaWNrID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgdGhpcy5jb2x1bW4ucHJveHlDbGljayA9IHRydWU7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAodGhpcy5jb2x1bW4udGVtcGxhdGUgJiYgdGhpcy5jb2x1bW4ucHJveHlDbGljaykge1xyXG4gICAgICAgICAgICBpZiAodGhpc1snX3RkbW91c2Vkb3duXyddKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmVsLm5hdGl2ZUVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgdGhpc1snX3RkbW91c2Vkb3duXyddLCB0cnVlKTtcclxuICAgICAgICAgICAgICAgIHRoaXNbJ190ZG1vdXNlZG93bl8nXSA9IG51bGw7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHRoaXMuZWwubmF0aXZlRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCB0aGlzWydfdGRtb3VzZWRvd25fJ10gPSAoZTogYW55KSA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAoZXhjbHVkZVRhcmdldChlKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXNbJ3pvbmVDbGljayddID0gZS50YXJnZXRbJ19fem9uZV9zeW1ib2xfX2NsaWNrZmFsc2UnXSB8fCBlLnRhcmdldFsnX196b25lX3N5bWJvbF9fQU5HVUxBUmNsaWNrRkFMU0UnXTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpc1snem9uZUNsaWNrJ10gJiYgdGhpc1snem9uZUNsaWNrJ10ubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5kZy5pc0ZGKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlLnRhcmdldC5zdHlsZS5wb2ludGVyRXZlbnRzID0gJ25vbmUnO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGUudGFyZ2V0WydfX3pvbmVfc3ltYm9sX19jbGlja2ZhbHNlJ10pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUoZS50YXJnZXRbJ19fem9uZV9zeW1ib2xfX2NsaWNrZmFsc2UnXSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZS50YXJnZXRbJ19fem9uZV9zeW1ib2xfX0FOR1VMQVJjbGlja0ZBTFNFJ10pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUoZS50YXJnZXRbJ19fem9uZV9zeW1ib2xfX0FOR1VMQVJjbGlja0ZBTFNFJ10pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNbJ3pvbmVDbGljayddLmZvckVhY2goKHByb3h5Q2xpY2sgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFwcm94eUNsaWNrLnRhcmdldCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb3h5Q2xpY2sudGFyZ2V0ID0gZS50YXJnZXQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sIHRydWUpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLypcclxuICAgICAgICAgICAgdGhpc1snX3RkbW91c2Vkb3duXyddID0gdGhpcy5yZW5kZXIubGlzdGVuKHRoaXMuZWwubmF0aXZlRWxlbWVudCwgJ21vdXNlZG93bicsIChlOiBhbnkpID0+IHtcclxuICAgICAgICAgICAgICAgIGlmIChleGNsdWRlVGFyZ2V0KGUpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpc1snem9uZUNsaWNrJ10gPSBlLnRhcmdldFsnX196b25lX3N5bWJvbF9fY2xpY2tmYWxzZSddIHx8IGUudGFyZ2V0WydfX3pvbmVfc3ltYm9sX19BTkdVTEFSY2xpY2tGQUxTRSddO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzWyd6b25lQ2xpY2snXSAmJiB0aGlzWyd6b25lQ2xpY2snXS5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZS50YXJnZXQuc3R5bGUucG9pbnRlckV2ZW50cyA9ICdub25lJztcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpc1snem9uZUNsaWNrJ10uZm9yRWFjaCgocHJveHlDbGljayA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXByb3h5Q2xpY2sudGFyZ2V0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJveHlDbGljay50YXJnZXQgPSBlLnRhcmdldDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfSkpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICovXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLmVsLm5hdGl2ZUVsZW1lbnQuZ3JpZENlbGxEYXRhID0geyByb3dEYXRhOiB0aGlzLnJvd0RhdGEsIHJvd0luZGV4OiB0aGlzLmRyLnJvd0luZGV4IH07XHJcbiAgICAgICAgdGhpcy5lbC5uYXRpdmVFbGVtZW50LmNsb3NlRWRpdCA9ICgpID0+IHRoaXMuY2xvc2VFZGl0aW5nQ2VsbCgpO1xyXG4gICAgICAgIHRoaXMuZWwubmF0aXZlRWxlbWVudC5zZWxlY3RDZWxsID0gKGUsIGVsKSA9PiB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmRnLmRpc2FibGVSb3cgJiYgdGhpcy5kZy5kaXNhYmxlUm93KHRoaXMucm93RGF0YSwgdGhpcy5kci5yb3dJbmRleCkpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgY29uc3QgYmVmb3JFdmVudFBhcmFtID0ge1xyXG4gICAgICAgICAgICAgICAgcm93SW5kZXg6IHRoaXMuZHIucm93SW5kZXgsXHJcbiAgICAgICAgICAgICAgICByb3dEYXRhOiB0aGlzLnJvd0RhdGEsXHJcbiAgICAgICAgICAgICAgICBncmlkSW5zdGFuY2U6IHRoaXMuZGdcclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IHJ1blRlbXBsYXRlQ2xpY2tFdmVudCA9ICgpID0+IHtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMuZGcuY3VycmVudENlbGwpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdENlbGwodGhpcy5jb2x1bW4uZmllbGQsIGVsKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMuZGcuY3VycmVudENlbGwpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kZy5jdXJyZW50Q2VsbCA9IHsgcm93RGF0YTogdGhpcy5yb3dEYXRhIH1cclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMuZGcuY3VycmVudENlbGwucm93RGF0YSl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRnLmN1cnJlbnRDZWxsLnJvd0RhdGEgPSB0aGlzLnJvd0RhdGE7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgaWYodGhpc1snem9uZUNsaWNrJ10pIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnJ1blpvbmVDbGljayhlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICB0aGlzLmRnLmNlbGxDbGljay5lbWl0KHsgY29sdW1uOiB0aGlzLmNvbHVtbiwgcm93RGF0YTogdGhpcy5yb3dEYXRhLCBncmlkSW5zdGFuY2U6IHRoaXMuZGcsIGV2ZW50OiBlIH0pO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjb25zdCB1c2VOZXdTZWxlY3Rpb25Nb2RlID0gdGhpcy5kZy5zbXMuYmVmb3JSb3dDbGljayh7IC4uLmJlZm9yRXZlbnRQYXJhbSwgZSwgaWQ6IHRoaXMuZHIucm93SWQsIGRyOiB0aGlzLmRyLCBjZWxscmVmOiB0aGlzIH0pO1xyXG4gICAgICAgICAgICBpZiAodXNlTmV3U2VsZWN0aW9uTW9kZSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RDZWxsKHRoaXMuY29sdW1uLmZpZWxkLCBlbCk7XHJcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMuZGcuY3VycmVudENlbGwpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmRnLmN1cnJlbnRDZWxsID0geyByb3dEYXRhOiB0aGlzLnJvd0RhdGEgfVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMuZGcuY3VycmVudENlbGwucm93RGF0YSl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZGcuY3VycmVudENlbGwucm93RGF0YSA9IHRoaXMucm93RGF0YTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0aGlzLmRnLmNlbGxDbGljay5lbWl0KHsgY29sdW1uOiB0aGlzLmNvbHVtbiwgcm93RGF0YTogdGhpcy5yb3dEYXRhLCBncmlkSW5zdGFuY2U6IHRoaXMuZGcsIGV2ZW50OiBlIH0pO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGlmICh0aGlzLmRmcy5pc1Jvd1NlbGVjdGVkKHRoaXMuZHIucm93SWQpKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMuZGcua2VlcFNlbGVjdCAmJiAhdGhpcy5jb2x1bW4udGVtcGxhdGUpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuZGcuY3VycmVudENlbGwgJiYgdGhpcy5kZy5jdXJyZW50Q2VsbC5jZWxsRWxlbWVudCAmJiB0aGlzLmRnLmN1cnJlbnRDZWxsLmNlbGxFbGVtZW50LmlkID09PSBlbC5pZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRnLmNhbmNlbFNlbGVjdENlbGwoKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZGcuYmVmb3JlVW5zZWxlY3QoYmVmb3JFdmVudFBhcmFtKS5waXBlKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0YWtlVW50aWwodGhpcy5kZXN0cm95JCksXHJcbiAgICAgICAgICAgICAgICAgICAgKS5zdWJzY3JpYmUoKGNhblVuc2VsZWN0OiBib29sZWFuKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjYW5VbnNlbGVjdCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGhpcy5kZy51blNlbGVjdC5lbWl0KHRoaXMuZGcuc2VsZWN0ZWRSb3cpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kZnMudW5TZWxlY3RSb3codGhpcy5kci5yb3dJbmRleCwgdGhpcy5yb3dEYXRhLCB7aW5zdGFuY2U6IHRoaXMuZGd9KTtcclxuICAgIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdHJDTFMgPSB0aGlzLmVsLm5hdGl2ZUVsZW1lbnQuY2xhc3NOYW1lO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRyQ0xTLmluZGV4T2YoJ2YtZGF0YWdyaWQtcm93LXNlbGVjdGVkJykgPiAtMSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZWwubmF0aXZlRWxlbWVudC5jbGFzc05hbWUgPSB0ckNMUy5yZXBsYWNlKCdmLWRhdGFncmlkLXJvdy1zZWxlY3RlZCcsICcnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRnLnJvd0NsaWNrLmVtaXQoeyBkYXRhOiB0aGlzLnJvd0RhdGEsIGdyaWQ6IHRoaXMuZGcsIGRibGNsaWNrOiBmYWxzZSB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kZy5kZ3Muc2V0U2VsZWNlZFJvdy5lbWl0KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZGcucm93Q2xpY2suZW1pdCh7IGRhdGE6IHRoaXMucm93RGF0YSwgZ3JpZDogdGhpcy5kZywgZGJsY2xpY2s6IGZhbHNlIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIHJ1blRlbXBsYXRlQ2xpY2tFdmVudCgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgbGV0IHIkOiBPYnNlcnZhYmxlPGFueT4gPSBvZih0cnVlKTtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmRnLmJlZm9yZVNlbGVjdCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHIgPSB0aGlzLmRnLmJlZm9yZVNlbGVjdCh7IHJvd0luZGV4OiB0aGlzLmRyLnJvd0luZGV4ICwgcm93RGF0YTogdGhpcy5yb3dEYXRhLCBncmlkSW5zdGFuY2U6IHRoaXMuZGcgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHIgJiYgci5zdWJzY3JpYmUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgciQgPSByO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNvbnN0IHpvbmVDbGljayA9IHRoaXNbJ3pvbmVDbGljayddO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgX3RpbWVyID0gem9uZUNsaWNrICYmIHpvbmVDbGljay5sZW5ndGggPyAxMDA6IDA7XHJcbiAgICAgICAgICAgICAgICByJC5waXBlKGRlYm91bmNlVGltZShfdGltZXIpKS5zdWJzY3JpYmUoKHQpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdENlbGwodGhpcy5jb2x1bW4uZmllbGQsIGVsKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kZy5jZWxsQ2xpY2suZW1pdCh7IGNvbHVtbjogdGhpcy5jb2x1bW4sIHJvd0RhdGE6IHRoaXMucm93RGF0YSwgZ3JpZEluc3RhbmNlOiB0aGlzLmRnLCBldmVudDogZSB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKF90aW1lcikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5ydW5ab25lQ2xpY2soZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5kZy5yb3dDbGljay5lbWl0KHsgZGF0YTogdGhpcy5yb3dEYXRhLCBncmlkOiB0aGlzLmRnLCBkYmxjbGljazogZmFsc2UgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5kZy5kZ3Muc2V0U2VsZWNlZFJvdy5lbWl0KCk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5lbC5uYXRpdmVFbGVtZW50LmNhbmNlbFNlbGVjdGVkID0gKCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLnJlbmRlci5yZW1vdmVDbGFzcyh0aGlzLmVsLm5hdGl2ZUVsZW1lbnQsIENFTExfU0VMRUNURURfQ0xTKTtcclxuICAgICAgICAgICAgdGhpcy5yZW5kZXIucmVtb3ZlQ2xhc3ModGhpcy5lbC5uYXRpdmVFbGVtZW50LCBDRUxMX0VESVRJTkdfQ0xTKTtcclxuICAgICAgICB9O1xyXG4gICAgfVxyXG5cclxuICAgIG5nT25EZXN0cm95KCkge1xyXG4gICAgICAgIHRoaXMuZGVzdHJveSQubmV4dCgpO1xyXG4gICAgICAgIHRoaXMuZGVzdHJveSQuY29tcGxldGUoKTtcclxuXHJcbiAgICAgICAgaWYgKHRoaXMuY2VsbGNsaWNrKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2VsbGNsaWNrKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAodGhpcy5jZWxsZGJsY2xpY2spIHtcclxuICAgICAgICAgICAgdGhpcy5jZWxsZGJsY2xpY2soKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMudW5CaW5kRWRpdG9ySW5wdXRFdmVudCgpO1xyXG5cclxuICAgICAgICBpZiAodGhpcy5iaW5kQ2VsbEV2ZW50U3Vic2NyaXB0aW9uKSB7XHJcbiAgICAgICAgICAgIHRoaXMuYmluZENlbGxFdmVudFN1YnNjcmlwdGlvbi51bnN1YnNjcmliZSgpO1xyXG4gICAgICAgICAgICB0aGlzLmJpbmRDZWxsRXZlbnRTdWJzY3JpcHRpb24gPSBudWxsO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHRoaXMuY2VsbEVkaXRvckNyZWF0ZWRTdWJzY3JpcHRpb24pIHtcclxuICAgICAgICAgICAgdGhpcy5jZWxsRWRpdG9yQ3JlYXRlZFN1YnNjcmlwdGlvbi51bnN1YnNjcmliZSgpO1xyXG4gICAgICAgICAgICB0aGlzLmNlbGxFZGl0b3JDcmVhdGVkU3Vic2NyaXB0aW9uID0gbnVsbDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICh0aGlzLmNlbGxFZGl0b3JEZXN0b3J5U3Vic2NyaXB0aW9uKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2VsbEVkaXRvckRlc3RvcnlTdWJzY3JpcHRpb24udW5zdWJzY3JpYmUoKTtcclxuICAgICAgICAgICAgdGhpcy5jZWxsRWRpdG9yRGVzdG9yeVN1YnNjcmlwdGlvbiA9IG51bGw7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLmVkaXRvciA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5jZWxsRWRpdG9yUmVmID0gbnVsbDtcclxuICAgICAgICB0aGlzLmZvcm1Db250cm9sID0gbnVsbDtcclxuXHJcbiAgICAgICAgaWYgKHRoaXMuZWwpIHtcclxuICAgICAgICAgICAgdGhpcy5lbC5uYXRpdmVFbGVtZW50LmNhbmNlbFNlbGVjdGVkID0gbm9vcDtcclxuICAgICAgICAgICAgdGhpcy5lbC5uYXRpdmVFbGVtZW50LnNlbGVjdENlbGwgPSBub29wO1xyXG4gICAgICAgICAgICB0aGlzLmVsLm5hdGl2ZUVsZW1lbnQuY2xvc2VFZGl0ID0gbm9vcDtcclxuICAgICAgICAgICAgdGhpcy5lbC5uYXRpdmVFbGVtZW50LmdyaWRDZWxsRGF0YSA9IG5vb3A7XHJcbiAgICAgICAgICAgIHRoaXMuZWwubmF0aXZlRWxlbWVudC5lZGl0ID0gbm9vcDtcclxuICAgICAgICAgICAgdGhpcy5lbC5uYXRpdmVFbGVtZW50LnNlbGVjdENlbGwgPSBub29wO1xyXG5cclxuICAgICAgICAgICAgaWYgKHRoaXNbJ190ZG1vdXNlZG93bl8nXSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5lbC5uYXRpdmVFbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIHRoaXNbJ190ZG1vdXNlZG93bl8nXSwgdHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzWydfdGRtb3VzZWRvd25fJ10gPSBudWxsO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMuZWwgPSBudWxsO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBpc0RpZmZlcmVudENlbGwoKSB7XHJcbiAgICAgICAgaWYgKCF0aGlzLmRnLmN1cnJlbnRDZWxsKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGlmICghdGhpcy5kZy5zZWxlY3RlZFJvdyB8fCB0aGlzLmRnLnNlbGVjdGVkUm93LmluZGV4ICE9PSB0aGlzLmRyLnJvd0luZGV4KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmRyLnJvd0luZGV4ICE9PSB0aGlzLmRnLmN1cnJlbnRDZWxsLnJvd0luZGV4KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmRnLmN1cnJlbnRDZWxsLmZpZWxkICE9PSB0aGlzLmNvbHVtbi5maWVsZDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIG9uQ2xpY2tDZWxsKGV2ZW50OiBhbnkpIHtcclxuICAgICAgICAvLyDlhbPpl63lhbbku5ZHcmlkIOeahOe8lui+keWZqFxyXG4gICAgICAgIGRvY3VtZW50LmJvZHkuY2xpY2soKTtcclxuXHJcbiAgICAgICAgdGhpcy5kZy5iZWZvcmVDbGlja0NlbGwuZW1pdCh7IHJvd0luZGV4OiB0aGlzLmRyLnJvd0luZGV4LCByb3dEYXRhOiB0aGlzLnJvd0RhdGEsIGNvbHVtbjogdGhpcy5jb2x1bW4sIGdyaWRJbnN0YW5jZTogdGhpcy5kZyB9KTtcclxuXHJcbiAgICAgICAgaWYgKHRoaXMuZHIuZGlzYWJsZWQpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHRoaXMuZGcuZGlzYWJsZWQpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGlmICghdGhpcy5kZy5lZGl0YWJsZSB8fCB0aGlzLmlzUmVhZG9ubHkoKSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuZGcuZW5hYmxlSGlnaGxpZ2h0Q2VsbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZGcuZW5kRWRpdGluZygpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0Q2VsbCh0aGlzLmNvbHVtbi5maWVsZCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAvLyDlj6ror7vljZXlhYPmoLzvvIzngrnlh7vlkI7pobvop6blj5HooYzngrnlh7vkuovku7YgdGZzIDU3NDU1MVxyXG4gICAgICAgICAgICAgICAgdGhpcy5kZy5yb3dDbGljay5lbWl0KHsgZGF0YTogdGhpcy5yb3dEYXRhLCBncmlkOiB0aGlzLmRnLCBkYmxjbGljazogZmFsc2UgfSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5kZy5lZGl0TW9kZSA9PT0gJ3JvdycpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICh0aGlzLmRnLnNlbGVjdGlvbk1vZGUgPT09ICdkZWZhdWx0JyAmJiBldmVudCkge1xyXG4gICAgICAgICAgICBpZiAoZXZlbnQuY3RybEtleSB8fCBldmVudC5zaGlmdEtleSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuXHJcbiAgICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgaWYgKGV2ZW50LnRhcmdldFsnbm9kZU5hbWUnXSA9PT0gJ0lOUFVUJykge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuXHJcbiAgICAgICAgLy8gaWYgKHRoaXMuZGcuY2xpY2tUb0VkaXQgJiYgIXRoaXMuZGcuZGJsY2xpY2tSb3cub2JzZXJ2ZXJzLmxlbmd0aCkge1xyXG4gICAgICAgIC8vICAgICB0aGlzLmRnLmNsaWNrRGVsYXkgPSAwO1xyXG4gICAgICAgIC8vIH1cclxuXHJcblxyXG4gICAgICAgIHRoaXMucmVuZGVyLmFkZENsYXNzKHRoaXMuZGcuZWwubmF0aXZlRWxlbWVudCwgJ2YtZGF0YWdyaWQtdW5zZWxlY3QnKTtcclxuXHJcbiAgICAgICAgaWYgKCF0aGlzLmRnLmlzU2luZ2xlQ2xpY2sgJiYgdGhpcy5kZy5lZGl0TW9kZSkge1xyXG4gICAgICAgICAgICB0aGlzLmRnLmlzU2luZ2xlQ2xpY2sgPSB0cnVlO1xyXG5cclxuICAgICAgICAgICAgaWYgKHRoaXMuY2xpY2tUaW1lcikge1xyXG4gICAgICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHRoaXMuY2xpY2tUaW1lcik7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHRoaXMuY2xpY2tUaW1lciA9IHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuZGcuaXNTaW5nbGVDbGljayAmJiB0aGlzLmRnLmVkaXRhYmxlICYmIHRoaXMuZGcuZWRpdE1vZGUgPT09ICdjZWxsJykge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZGcuaXNTaW5nbGVDbGljayA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aGlzLmNsaWNrVGltZXIpO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIGlmICghdGhpcy5jbG9zZUVkaXRpbmdDZWxsKCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIH1cclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmNsb3NlRWRpdGluZ0NlbGwoKS5waXBlKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0YWtlVW50aWwodGhpcy5kZXN0cm95JClcclxuICAgICAgICAgICAgICAgICAgICApLnN1YnNjcmliZSgoZjogYW55KSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5kZy5jbGlja1RvRWRpdCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICF0aGlzLmRnLm5vd3JhcCAmJiB0aGlzLmRnYi51cGRhdGVSb3dIZWlnaHQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9wZW5DZWxsRWRpdG9yKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0Q2VsbCh0aGlzLmNvbHVtbi5maWVsZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbmRlci5yZW1vdmVDbGFzcyh0aGlzLmRnLmVsLm5hdGl2ZUVsZW1lbnQsICdmLWRhdGFncmlkLXVuc2VsZWN0Jyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sIHRoaXMuZGcuY2xpY2tEZWxheSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgb25EYmxDbGlja0NlbGwoZXZlbnQ6IE1vdXNlRXZlbnQpIHtcclxuICAgICAgICBpZiAodGhpcy5kZy5kaXNhYmxlZCB8fCB0aGlzLmlzUmVhZG9ubHkoKSkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoZXZlbnQudGFyZ2V0Wydub2RlTmFtZSddID09PSAnSU5QVVQnIHx8IGV2ZW50LnRhcmdldFsnbm9kZU5hbWUnXSA9PT0gJ1RFWFRBUkVBJykge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLmRnLmVkaXRhYmxlICYmIHRoaXMuZGcuZWRpdE1vZGUgPT09ICdjZWxsJykge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5jbGlja1RpbWVyKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmRnLmlzU2luZ2xlQ2xpY2sgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aGlzLmNsaWNrVGltZXIpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jbGlja1RpbWVyID0gbnVsbDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgdGhpcy5jbG9zZUVkaXRpbmdDZWxsKCkucGlwZSh0YWtlVW50aWwodGhpcy5kZXN0cm95JCkpLnN1YnNjcmliZShmID0+IHtcclxuICAgICAgICAgICAgICAgIGlmIChmKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub3BlbkNlbGxFZGl0b3IoKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gIFxyXG4gICAgfVxyXG5cclxuICAgIGlzUmVhZG9ubHkoY29sID0gdGhpcy5jb2x1bW4pIHtcclxuICAgICAgICBpZiAodGhpcy5kZy5lZGl0YWJsZSkge1xyXG4gICAgICAgICAgICAvLyDlj4LkuI7lkIjlubbnmoTljZXlhYPmoLzkuI3lhYHorrjnvJbovpFcclxuICAgICAgICAgICAgaWYgKHRoaXMuZGcubWVyZ2VDZWxsICYmIHRoaXMuZGcubWVyZ2VGaWVsZHMuaW5kZXhPZihjb2wuZmllbGQpID4gLTEpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmdldFJlYWRvbmx5VmFsdWUoY29sKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBnZXRSZWFkb25seVZhbHVlKGNvbCA9IHRoaXMuY29sdW1uKSB7XHJcbiAgICAgICAgaWYgKGNvbC5yZWFkb25seSAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIGlmICh0eXBlb2YgY29sLnJlYWRvbmx5ID09PSAnYm9vbGVhbicpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBjb2wucmVhZG9ubHk7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIGNvbC5yZWFkb25seSA9PT0gJ2Z1bmN0aW9uJykge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGNvbC5yZWFkb25seSh0aGlzLnJvd0RhdGEpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuXHJcbiAgICBvcGVuQ2VsbEVkaXRvcigpIHtcclxuICAgICAgICAvLyDlvZPliY3ooYznpoHnlKjvvIzkuI3lhYHorrjnvJbovpHjgIJcclxuICAgICAgICBpZiAodGhpcy5kci5kaXNhYmxlZCkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoKCF0aGlzLmNvbHVtbi5lZGl0b3IgJiYgIXRoaXMuY29sdW1uLmVkaXRvclRlbXBsYXRlKSB8fCAhdGhpcy5kZy5lZGl0YWJsZSB8fCB0aGlzLmlzUmVhZG9ubHkoKSkge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5kZy5zZWxlY3Rpb25Nb2RlID09PSAnZGVmYXVsdCcgJiYgdGhpcy5kZy5tdWx0aVNlbGVjdCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5kZy5jbGVhckNoZWNrZWRzKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5zZWxlY3RDZWxsKHRoaXMuY29sdW1uLmZpZWxkKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3QgYmVmb3JlRWRpdEV2ZW50ID0gdGhpcy5kZy5iZWZvcmVFZGl0KHsgcm93SW5kZXg6IHRoaXMuZHIucm93SW5kZXgsIHJvd0RhdGE6IHRoaXMucm93RGF0YSwgY29sdW1uOiB0aGlzLmNvbHVtbiwgZ3JpZEluc3RhbmNlOiB0aGlzLmRnIH0pO1xyXG4gICAgICAgIGlmICghYmVmb3JlRWRpdEV2ZW50IHx8ICFiZWZvcmVFZGl0RXZlbnQuc3Vic2NyaWJlKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZGcud3JpdGVDb25zb2xlKCdwbGVhc2UgcmV0dXJuIGFuIE9ic2VydmFibGUgVHlwZS4nKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHRoaXMuZGcuY3VycmVudENlbGwpIHtcclxuICAgICAgICAgICAgaWYgKCF0aGlzLmRnLmN1cnJlbnRDZWxsLmNlbGxSZWYgfHwgdGhpcy5kZy5jdXJyZW50Q2VsbC5jZWxsUmVmLmNvbHVtbi5maWVsZCAhPT0gdGhpcy5jb2x1bW4uZmllbGQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZGcuY3VycmVudENlbGwuY2VsbFJlZiA9IHRoaXMuZGM7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG5cclxuICAgICAgICBiZWZvcmVFZGl0RXZlbnQucGlwZSh0YWtlVW50aWwodGhpcy5kZXN0cm95JCkpLnN1YnNjcmliZSgoZmxhZykgPT4ge1xyXG4gICAgICAgICAgICBpZiAoZmxhZykge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaXNEaWZmZXJlbnRDZWxsKCkpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuZGcuc2VsZWN0aW9uTW9kZSA9PT0gJ2RlZmF1bHQnICYmIHRoaXMuZGcubXVsdGlTZWxlY3QpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kZy5jbGVhckNoZWNrZWRzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdENlbGwodGhpcy5jb2x1bW4uZmllbGQpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdGhpcy5kZnMuZWRpdENlbGwoKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0Q2VsbCh0aGlzLmNvbHVtbi5maWVsZCk7XHJcbiAgICAgICAgICAgICAgICAvLyB0ZnMgNTc0NjEyXHJcbiAgICAgICAgICAgICAgICB0aGlzLmRnLnJvd0NsaWNrLmVtaXQoeyBkYXRhOiB0aGlzLnJvd0RhdGEsIGdyaWQ6IHRoaXMuZGcsIGRibGNsaWNrOiBmYWxzZSB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgZW1pdEJlZ2luRWRpdCgpIHtcclxuXHJcbiAgICAgICAgY29uc3QgX2NlbGxFZGl0b3JSZWYgPSB0aGlzLmNlbGxFZGl0b3JSZWYgfHwgdGhpcy5kYy5jZWxsRWRpdG9yO1xyXG5cclxuICAgICAgICB0aGlzLnJlbmRlci5yZW1vdmVDbGFzcyh0aGlzLmRnLmVsLm5hdGl2ZUVsZW1lbnQsICdmLWRhdGFncmlkLXVuc2VsZWN0Jyk7XHJcblxyXG4gICAgICAgIGlmICh0aGlzLmRnLmVkaXRNb2RlID09PSAnY2VsbCcpIHtcclxuICAgICAgICAgICAgdGhpcy5kZy5zZWxlY3RlZFJvdy5lZGl0b3JzID0gW3RoaXMuZWRpdG9yXTtcclxuICAgICAgICAgICAgdGhpcy5kZy5jdXJyZW50Q2VsbC5lZGl0b3IgPSB0aGlzLmVkaXRvcjtcclxuICAgICAgICAgICAgdGhpcy5kZy5jdXJyZW50Q2VsbC5jZWxsRWRpdG9yUmVmID0gX2NlbGxFZGl0b3JSZWY7XHJcbiAgICAgICAgICAgIHRoaXMuYmluZEVkaXRvcklucHV0RXZlbnQoKTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMucmVuZGVyLmFkZENsYXNzKHRoaXMuZWwubmF0aXZlRWxlbWVudCwgQ0VMTF9FRElUSU5HX0NMUyk7XHJcblxyXG4gICAgICAgICAgICAvLyB0aGlzLmZvcm1Db250cm9sLnNldFZhbHVlKHRoaXMuZGMudmFsdWUpO1xyXG4gICAgICAgICAgICB0aGlzLmRnLmJlZ2luRWRpdC5lbWl0KHsgZWRpdG9yOiBfY2VsbEVkaXRvclJlZiwgY29sdW1uOiB0aGlzLmNvbHVtbiwgcm93RGF0YTogdGhpcy5yb3dEYXRhLCBncmlkSW5zdGFuY2U6IHRoaXMuZGcgfSk7XHJcblxyXG4gICAgICAgICAgICBpZiAodGhpcy5jb2x1bW4uZWRpdG9yLnR5cGUgPT09ICd0ZXh0YXJlYScgJiYgdGhpcy5jb2x1bW4uZWRpdG9yLm9wdGlvbnMgJiYgdGhpcy5jb2x1bW4uZWRpdG9yLm9wdGlvbnMuZWRpdFR5cGUgPT09ICdkaWFsb2cnKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmVkaXRvci5zaG93RGlhbG9nKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICh0aGlzLmRyICYmICF0aGlzLmRnLm5vd3JhcCkge1xyXG4gICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZHIudXBkYXRlUm93SGVpZ2h0KCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHRoaXMuZWRpdG9yKSB7XHJcbiAgICAgICAgICAgIHRoaXMudmFsaWRNZXNzYWdlRWxlID0gdGhpcy5zaG93VmFsaWRNZXNzYWdlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHJlbW92ZVZhbGlkTWVzc2FnZSgpIHtcclxuICAgICAgICAvLyDnp7vpmaTpqozor4Hkv6Hmga9cclxuICAgICAgICBpZiAodGhpcy52YWxpZE1lc3NhZ2VFbGUpIHtcclxuICAgICAgICAgICAgdGhpcy52YWxpZE1lc3NhZ2VFbGUucmVtb3ZlKCk7XHJcbiAgICAgICAgICAgIHRoaXMudmFsaWRNZXNzYWdlRWxlID0gbnVsbDtcclxuICAgICAgICAgICAgaWYgKHRoaXMuZGcuZm9ybVZhbGlkYXRpb25zKSB7XHJcbiAgICAgICAgICAgICAgICBkZWxldGUgdGhpcy5kZy5mb3JtVmFsaWRhdGlvbnNbdGhpcy5jb2x1bW4uZmllbGRdO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHNob3dWYWxpZE1lc3NhZ2UoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuZGcuZm9ybVZhbGlkYXRpb25zICYmIHRoaXMuZGcuZm9ybVZhbGlkYXRpb25zW3RoaXMuY29sdW1uLmZpZWxkXSkge1xyXG4gICAgICAgICAgICBjb25zdCB7aXNWYWxpZCwgbWVzc2FnZX0gPSB0aGlzLmRnLmZvcm1WYWxpZGF0aW9uc1t0aGlzLmNvbHVtbi5maWVsZF07XHJcbiAgICAgICAgICAgIGlmICghaXNWYWxpZCAmJiBtZXNzYWdlKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ciA9IHRoaXMuZWRpdG9yLmVsLm5hdGl2ZUVsZW1lbnQuY2xvc2VzdCgndHInKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHRkID0gdGhpcy5lZGl0b3IuZWwubmF0aXZlRWxlbWVudC5jbG9zZXN0KCd0ZCcpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgcGFyZW50Q29udGFpbnZlciA9IHRoaXMuZWRpdG9yLmVsLm5hdGl2ZUVsZW1lbnQuY2xvc2VzdCgnLmYtZGF0YWdyaWQtdGFibGUnKTtcclxuXHJcbiAgICAgICAgICAgICAgICBjb25zdCBib3ggPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG1zZ1dyYXAgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7XHJcbiAgICAgICAgICAgICAgICBib3guYXBwZW5kQ2hpbGQobXNnV3JhcCk7XHJcbiAgICAgICAgICAgICAgICBtc2dXcmFwLmlubmVyVGV4dCA9IG1lc3NhZ2U7XHJcblxyXG4gICAgICAgICAgICAgICAgYm94LnN0eWxlLnBvc2l0aW9uID0gJ2Fic29sdXRlJztcclxuICAgICAgICAgICAgICAgIGJveC5zdHlsZS5iYWNrZ3JvdW5kID0gJyNGREVGRUYnO1xyXG4gICAgICAgICAgICAgICAgYm94LnN0eWxlLmNvbG9yID0gJyNGNDYxNjAnO1xyXG5cclxuICAgICAgICAgICAgICAgIGxldCB0b3AgPSB0ci5vZmZzZXRUb3AgLSAyMTtcclxuICAgICAgICAgICAgICAgIGlmICh0ci5nZXRBdHRyaWJ1dGUoJ2luZGV4JykgPT0gJzAnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdG9wID0gdHIub2Zmc2V0SGVpZ2h0OyBcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBib3guc3R5bGUudG9wID0gYCR7dG9wfXB4YDtcclxuICAgICAgICAgICAgICAgIGJveC5zdHlsZS5sZWZ0ID0gYCR7dGQub2Zmc2V0TGVmdCArIDV9cHhgO1xyXG4gICAgICAgICAgICAgICAgYm94LnN0eWxlLnpJbmRleCA9ICc5OTYnO1xyXG4gICAgICAgICAgICAgICAgYm94LnN0eWxlLnBhZGRpbmcgPSAnMC4xODc1cmVtIDAuNXJlbSc7XHJcbiAgICAgICAgICAgICAgICBib3guc3R5bGUuZm9udFNpemUgPSAnLjgxMjVyZW0nO1xyXG4gICAgICAgICAgICAgICAgYm94LnN0eWxlLmxpbmVIZWlnaHQgPSAnMTRweCc7XHJcblxyXG4gICAgICAgICAgICAgICAgLy8gZG9jdW1lbnQuYm9keS5hcHBlbmQoYm94KTtcclxuICAgICAgICAgICAgICAgIHBhcmVudENvbnRhaW52ZXIuYXBwZW5kKGJveCk7XHJcblxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGJveDtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGNsb3NlRWRpdGluZ0NlbGwoKSB7XHJcbiAgICAgICAgaWYgKCF0aGlzLmRnLmlzQ2VsbEVkaXRpbmcoKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gb2YodHJ1ZSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBsZXQgY3VycmVudENlbGwgPSBudWxsO1xyXG4gICAgICAgIGxldCBlZGl0b3I6IGFueSA9IG51bGw7XHJcbiAgICAgICAgaWYgKHRoaXMuZGcuY3VycmVudENlbGwpIHtcclxuXHJcbiAgICAgICAgICAgIGN1cnJlbnRDZWxsID0gdGhpcy5kZy5jdXJyZW50Q2VsbC5jZWxsUmVmIGFzIERhdGFncmlkQ2VsbENvbXBvbmVudDtcclxuICAgICAgICAgICAgaWYgKGN1cnJlbnRDZWxsKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIWN1cnJlbnRDZWxsLmlzRWRpdGluZykge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBvZih0cnVlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoY3VycmVudENlbGwuY2VsbEVkaXRvciAmJiBjdXJyZW50Q2VsbC5jZWxsRWRpdG9yLmNvbXBvbmVudFJlZiAmJiAhY3VycmVudENlbGwuY29sdW1uLmVkaXRvclRlbXBsYXRlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZWRpdG9yID0gY3VycmVudENlbGwuY2VsbEVkaXRvci5jb21wb25lbnRSZWYuaW5zdGFuY2U7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChlZGl0b3IpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8g5omn6KGMYmx1ciDkuovku7ZcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVkaXRvci5pbnB1dEVsZW1lbnQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGRvbU5hbWUgPSBlZGl0b3IuaW5wdXRFbGVtZW50Lm5vZGVOYW1lO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgYmx1ckZuID0gIGVkaXRvci5vcHRpb25zICYmIGVkaXRvci5vcHRpb25zLm9uQmx1cjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChibHVyRm4pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoKGRvbU5hbWUgPT09ICdJTlBVVCcgfHwgZG9tTmFtZSA9PT0gJ1RFWFRBUkVBJykgJiYgIHRoaXMuZGdbJ2ZvY3VzRWxlbWVudCddID09PSBlZGl0b3IuaW5wdXRFbGVtZW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJsdXJGbih7IGVkaXRvclJlZjogZWRpdG9yLCByb3dEYXRhOiBjdXJyZW50Q2VsbC5yb3dEYXRhfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVkaXRvci5pbnB1dEVsZW1lbnQuYmx1cikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVkaXRvci5pbnB1dEVsZW1lbnQuYmx1cigpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZGdbJ2ZvY3VzRWxlbWVudCddID0gbnVsbDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVkaXRvci5ibHVyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlZGl0b3IuYmx1cigpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZWRpdG9yLnBlbmRpbmcpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBvZihmYWxzZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlZGl0b3IuZm9ybUNvbnRyb2wpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlZGl0b3IuZm9ybUNvbnRyb2wucGVuZGluZykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBvZihmYWxzZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVkaXRvci5mb3JtQ29udHJvbCAmJiBlZGl0b3IuZm9ybUNvbnRyb2wuaW52YWxpZCAmJiAhdGhpcy5kZy5lbmRFZGl0QnlJbnZhbGlkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG9mKGZhbHNlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBvZih0cnVlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBvZih0cnVlKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gb2YodHJ1ZSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLmRnLmlzU2luZ2xlQ2xpY2sgPSBmYWxzZTtcclxuICAgICAgICBjb25zdCBfY29sXyA9IChlZGl0b3IgfHwgY3VycmVudENlbGwpLmNvbHVtbjtcclxuICAgICAgICBjb25zdCBhZnRlckVkaXRFdmVudCA9IHRoaXMuZGcuYWZ0ZXJFZGl0KGN1cnJlbnRDZWxsLnJvd0luZGV4LCBjdXJyZW50Q2VsbC5yb3dEYXRhLCBfY29sXywgZWRpdG9yKTtcclxuICAgICAgICBpZiAoIWFmdGVyRWRpdEV2ZW50IHx8ICFhZnRlckVkaXRFdmVudC5zdWJzY3JpYmUpIHtcclxuICAgICAgICAgICAgdGhpcy5kZy53cml0ZUNvbnNvbGUoJ3BsZWFzZSByZXR1cm4gYW4gT2JzZXJ2YWJsZSBUeXBlLicpO1xyXG4gICAgICAgICAgICByZXR1cm4gb2YodW5kZWZpbmVkKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIGxldCBjZWxsRW5kRWRpdCA9IG9mKHVuZGVmaW5lZCk7XHJcbiAgICAgICAgbGV0IGNlbGxFbmRFZGl0ID0gbmV3IFN1YmplY3QoKTtcclxuXHJcbiAgICAgICAgYWZ0ZXJFZGl0RXZlbnQucGlwZSh0YWtlVW50aWwodGhpcy5kZXN0cm95JCkpLnN1YnNjcmliZSgoZmxhZzogYm9vbGVhbikgPT4ge1xyXG4gICAgICAgICAgICBpZiAoZmxhZykge1xyXG5cclxuICAgICAgICAgICAgICAgIGxldCB2YWwgPSBjdXJyZW50Q2VsbC52YWx1ZSA9PT0gdW5kZWZpbmVkID8gJycgOiBjdXJyZW50Q2VsbC52YWx1ZTtcclxuICAgICAgICAgICAgICAgIGlmIChjdXJyZW50Q2VsbCAmJiBjdXJyZW50Q2VsbC5mb3JtQ29udHJvbCAmJiBjdXJyZW50Q2VsbC5mb3JtQ29udHJvbC52YWx1ZSAhPT0gdW5kZWZpbmVkICYmIHZhbCAhPT0gY3VycmVudENlbGwuZm9ybUNvbnRyb2wudmFsdWUpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YWwgPSBjdXJyZW50Q2VsbC5mb3JtQ29udHJvbC52YWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICBjdXJyZW50Q2VsbC5pc0VkaXRpbmcgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICBjdXJyZW50Q2VsbC51cGRhdGVWYWx1ZSh2YWwpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIHRoaXMuZGZzLmVuZEVkaXRDZWxsKCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmRncy5vbkVuZENlbGxFZGl0KHRoaXMuZGZzLmdldEN1cnJlbnRDZWxsKCkpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy51bkJpbmRFZGl0b3JJbnB1dEV2ZW50KCk7XHJcbiAgICAgICAgICAgICAgICAvLyDnp7vpmaTnvJbovpHmoLflvI9cclxuICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyLnJlbW92ZUNsYXNzKHRoaXMuZWwubmF0aXZlRWxlbWVudCwgQ0VMTF9FRElUSU5HX0NMUyk7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuZGcuc2VsZWN0ZWRSb3cpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmRnLnNlbGVjdGVkUm93LmVkaXRvcnMgPSBbXTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIC8vIHRoaXMuZGcuc2VsZWN0ZWRSb3cuZGF0YSA9IHRoaXMucm93RGF0YTtcclxuICAgICAgICAgICAgICAgIC8vIOabtOaWsOihjOagt+W8j+aIluiAheWNleWFg+agvOagt+W8j1xyXG4gICAgICAgICAgICAgICAgY29uc3QgX3JpZCA9IHRoaXMuZGZzLnByaW1hcnlJZChjdXJyZW50Q2VsbC5yb3dEYXRhKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuZGZzLnJvd1VwZGF0ZSQubmV4dCh7IGluZGV4OiBjdXJyZW50Q2VsbC5yb3dJbmRleCwgZGF0YTogY3VycmVudENlbGwucm93RGF0YSwgY2VsbFJlZjogY3VycmVudENlbGwsIGtleUlEOiBfcmlkIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmRnLnNob3dGb290ZXIpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyDmm7TmlrBmb290ZXJEYXRhXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5kZ3MucmVmcmVzaEZvb3RlckRhdGEuZW1pdCgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgIC8vIOWIt+aWsOihjOaVsOaNrlxyXG4gICAgICAgICAgICAgICAgLy8gdGhpcy5kci5yZWZyZXNoKCk7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5kZy5zZWxlY3RlZFJvdyAmJiB0aGlzLmRnLnNlbGVjdGVkUm93LmRyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5kZy5zZWxlY3RlZFJvdy5kci5yZWZyZXNoKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXNbJ0VOREVESVRfVElNRVInXSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aGlzWydFTkRFRElUX1RJTUVSJ10pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGNvbnN0IHsgcm93SW5kZXgsIHJvd0RhdGEgfSA9IGN1cnJlbnRDZWxsO1xyXG5cclxuICAgICAgICAgICAgICAgIHRoaXNbJ0VOREVESVRfVElNRVInXSA9IHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZGcuZW5kRWRpdC5lbWl0KHsgcm93SW5kZXgsIHJvd0RhdGEsIGNvbHVtbjogX2NvbF8sIHZhbHVlOiB2YWx9KTtcclxuICAgICAgICAgICAgICAgICAgICAvLyBjZWxsRW5kRWRpdCA9IG9mKHRydWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNlbGxFbmRFZGl0Lm5leHQodHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICB9LCAxMDApO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRDZWxsICYmIGN1cnJlbnRDZWxsLmNlbGxFZGl0b3IgJiYgY3VycmVudENlbGwuY2VsbEVkaXRvci5jb21wb25lbnRSZWYgJiYgY3VycmVudENlbGwuY2VsbEVkaXRvci5jb21wb25lbnRSZWYuaW5zdGFuY2UpIHtcclxuICAgICAgICAgICAgICAgICAgICBlZGl0b3IgPSBjdXJyZW50Q2VsbC5jZWxsRWRpdG9yLmNvbXBvbmVudFJlZi5pbnN0YW5jZTtcclxuICAgICAgICAgICAgICAgICAgICBlZGl0b3IuaW5wdXRFbGVtZW50LmZvY3VzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gY2VsbEVuZEVkaXQgPSBvZihmYWxzZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgY2VsbEVuZEVkaXQubmV4dChmYWxzZSk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIGNlbGxFbmRFZGl0ID0gb2YodHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgY2VsbEVuZEVkaXQubmV4dCh0cnVlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiBjZWxsRW5kRWRpdC5hc09ic2VydmFibGUoKTtcclxuICAgIH1cclxuXHJcbiAgICBjYW5jZWxDZWxsRWRpdGluZygpIHtcclxuICAgICAgICBpZiAodGhpcy5kZy5jdXJyZW50Q2VsbCAmJiB0aGlzLmRnLmN1cnJlbnRDZWxsLmlzRWRpdGluZyAmJiB0aGlzLmRnLnNlbGVjdGVkUm93LmluZGV4ID4gLTEpIHtcclxuICAgICAgICAgICAgLy8gdGhpcy5kZnMucmVzZXRSb3codGhpcy5kZy5zZWxlY3RlZFJvdy5pZCk7XHJcbiAgICAgICAgICAgIHRoaXMuZGMucm93RGF0YSA9IHRoaXMuZGcuc2VsZWN0ZWRSb3cuZGF0YTtcclxuICAgICAgICAgICAgdGhpcy5mb3JtQ29udHJvbC5yZXNldChVdGlscy5nZXRWYWx1ZSh0aGlzLmNvbHVtbi5maWVsZCwgdGhpcy5kYy5yb3dEYXRhKSk7XHJcbiAgICAgICAgICAgIHRoaXMuY2xvc2VFZGl0aW5nQ2VsbCgpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcblxyXG4gICAgYmluZEVkaXRvcklucHV0RXZlbnQoKSB7XHJcbiAgICAgICAgY29uc3QgY2VSZWYgPSB0aGlzLmNlbGxFZGl0b3JSZWYgfHwgdGhpcy5kYy5jZWxsRWRpdG9yO1xyXG4gICAgICAgIGxldCBpbnB1dCA9IG51bGw7XHJcbiAgICAgICAgaWYgKGNlUmVmKSB7XHJcbiAgICAgICAgICAgIGlucHV0ID0gY2VSZWYuY29tcG9uZW50UmVmLmluc3RhbmNlLmlucHV0RWxlbWVudDtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5jb2x1bW4uZWRpdG9yVGVtcGxhdGUpIHtcclxuICAgICAgICAgICAgICAgIGlucHV0ID0gdGhpcy5kYy5lbC5uYXRpdmVFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ2lucHV0LHRleHRhcmVhJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGlucHV0KSB7XHJcbiAgICAgICAgICAgIGlucHV0LmZvY3VzKCk7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmRnLnNlbGVjdE9uRWRpdGluZyAmJiB0aGlzLmNvbHVtbi5lZGl0b3JUZW1wbGF0ZSkge1xyXG4gICAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGlucHV0LnNlbGVjdCkgeyBpbnB1dC5zZWxlY3QoKTsgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHRoaXMuZWRpdG9ySW5wdXRLZXlkb3duRXZlbnQgPSB0aGlzLnJlbmRlci5saXN0ZW4oaW5wdXQsICdrZXlkb3duJywgKGUpID0+IHtcclxuICAgICAgICAgICAgICAgIHRoaXMub25LZXlEb3duRm9ySW5wdXQoZSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICB1bkJpbmRFZGl0b3JJbnB1dEV2ZW50KCkge1xyXG4gICAgICAgIGlmICh0aGlzLmVkaXRvcklucHV0S2V5ZG93bkV2ZW50KSB7XHJcbiAgICAgICAgICAgIHRoaXMuZWRpdG9ySW5wdXRLZXlkb3duRXZlbnQoKTtcclxuICAgICAgICAgICAgdGhpcy5lZGl0b3JJbnB1dEtleWRvd25FdmVudCA9IG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8vIHByaXZhdGUgaXNMYXN0Q2VsbCgpIHtcclxuICAgIC8vICAgICBsZXQgaSA9IHRoaXMuZGcuZmxhdENvbHVtbnMubGVuZ3RoO1xyXG4gICAgLy8gICAgIHdoaWxlKGkgPD0gKSB7XHJcbiAgICAvLyAgICAgICAgIGlmICh0aGlzLmRnLmZsYXRDb2x1bW5zW2ldKVxyXG4gICAgLy8gICAgIH1cclxuICAgIC8vIH1cclxuXHJcbiAgICBmaW5kTGFzdEVkaXRDZWxsKCkge1xyXG4gICAgICAgIGxldCBpID0gdGhpcy5kZy5jb2xHcm91cC5jb2x1bW5zLmxlbmd0aCAtIDE7XHJcbiAgICAgICAgbGV0IF9jb2wgPSBudWxsO1xyXG4gICAgICAgIHdoaWxlKGkgPj0gMCkge1xyXG4gICAgICAgICAgICBjb25zdCBjb2wgPSB0aGlzLmRnLmNvbEdyb3VwLmNvbHVtbnNbaV07XHJcbiAgICAgICAgICAgIGlmIChjb2wuZWRpdG9yIHx8IGNvbC5lZGl0b3JUZW1wbGF0ZSkge1xyXG4gICAgICAgICAgICAgICAgX2NvbCA9IGNvbDtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgaS0tO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gX2NvbDtcclxuICAgIH1cclxuXHJcbiAgICBvbktleURvd25Gb3JJbnB1dChlOiBLZXlib2FyZEV2ZW50KSB7XHJcbiAgICAgICAgY29uc3Qga2V5Q29kZSA9IGUua2V5Q29kZTtcclxuICAgICAgICBpZiAoZS5hbHRLZXkgfHwgZS5jdHJsS2V5KSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKCh0aGlzLmVkaXRvciAmJiB0aGlzLmVkaXRvci5zdG9wUHJvcGFnYXRpb24pIHx8IGtleUNvZGUgPT09IDEzIHx8IHRoaXMuY29sdW1uLmVkaXRvclRlbXBsYXRlKSB7XHJcbiAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBzd2l0Y2ggKGtleUNvZGUpIHtcclxuICAgICAgICAgICAgY2FzZSAzMjogIC8vIFNQQUNFXHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5jb2x1bW4uZWRpdG9yLnR5cGUgPT09ICdzd2l0Y2gnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZWRpdG9yLmluc3RhbmNlLnVwZGF0ZUNoZWNrZWQoZSwgZmFsc2UpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgMTM6ICAvLyBFbnRlclxyXG4gICAgICAgICAgICAgICAgdGhpcy5jbG9zZUVkaXRpbmdDZWxsKCkucGlwZSh0YWtlVW50aWwodGhpcy5kZXN0cm95JCkpLnBpcGUoXHJcbiAgICAgICAgICAgICAgICAgICAgZGVib3VuY2VUaW1lKDEwMClcclxuICAgICAgICAgICAgICAgICkuc3Vic2NyaWJlKGYgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChmKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZGcuZGdDb250YWluZXIubmF0aXZlRWxlbWVudC5mb2N1cygpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBsYXN0RWRpdENlbGwgPSB0aGlzLmZpbmRMYXN0RWRpdENlbGwoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGVudGVyUGFyYW0gPSB7IGdpcmQ6IHRoaXMuZGcsIGNlbGw6IHRoaXMuZGcuY3VycmVudENlbGwsIGV2ZW50OiBlLCBsYXN0Q2VsbDogbGFzdEVkaXRDZWxsLmZpZWxkID09PSB0aGlzLmNvbHVtbi5maWVsZCB9O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5jb2x1bW4ub25FbnRlckhhbmRsZXIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY29sdW1uLm9uRW50ZXJIYW5kbGVyKGVudGVyUGFyYW0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbmV4dFRkID0gdGhpcy5kZy5maW5kTmV4dENlbGwodGhpcy5jb2x1bW4uZmllbGQsICdyaWdodCcpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuZGcuY3VycmVudENlbGwubGFzdFJvdyAmJiAoIW5leHRUZCB8fCBsYXN0RWRpdENlbGwuZmllbGQgPT09IHRoaXMuY29sdW1uLmZpZWxkKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZGcubGFzdENlbGxFbnRlckhhbmRsZXIuZW1pdChlbnRlclBhcmFtKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgMjc6IC8vIEVTQ1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jYW5jZWxDZWxsRWRpdGluZygpO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgOTogLy8gVGFiXHJcbiAgICAgICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5kZy5jbGlja0RlbGF5ID0gMDtcclxuICAgICAgICAgICAgICAgIGlmIChlLnNoaWZ0S2V5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jbG9zZUVkaXRpbmdDZWxsKCkucGlwZSh0YWtlVW50aWwodGhpcy5kZXN0cm95JCkpLnN1YnNjcmliZShmID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGYpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubW92ZVByZXZDZWxsQW5kRWRpdCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY2xvc2VFZGl0aW5nQ2VsbCgpLnBpcGUodGFrZVVudGlsKHRoaXMuZGVzdHJveSQpKS5zdWJzY3JpYmUoZiA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm1vdmVOZXh0Q2VsbEFuZEVkaXQoZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSA0MDogLy8g4oaTXHJcbiAgICAgICAgICAgICAgICAvKiog6YCJ5Lit5LiL5LiA6KGM77yM5LiU5b2T5YmN5YiX6L+b5YWl57yW6L6R5oCBOyDku4Xmma7pgJrmlofmnKzovpPlhaXmoYbmlK/mjIEgKi9cclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmNvbHVtbi5lZGl0b3IudHlwZSA9PT0gJ3RleHRib3gnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jbG9zZUVkaXRpbmdDZWxsKCkucGlwZSh0YWtlVW50aWwodGhpcy5kZXN0cm95JCkpLnN1YnNjcmliZShmID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGYpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0TmV4dFJvd0FuZEVkaXRDZWxsKHRoaXMuY29sdW1uLmZpZWxkLCAnZG93bicpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgMzg6IC8vIOKGkVxyXG4gICAgICAgICAgICAgICAgLyoqIOmAieS4reS4iuS4gOihjO+8jOS4lOW9k+WJjeWIl+i/m+WFpee8lui+keaAgTsg5LuF5pmu6YCa5paH5pys6L6T5YWl5qGG5pSv5oyBICovXHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5jb2x1bW4uZWRpdG9yLnR5cGUgPT09ICd0ZXh0Ym94Jykge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY2xvc2VFZGl0aW5nQ2VsbCgpLnBpcGUodGFrZVVudGlsKHRoaXMuZGVzdHJveSQpKS5zdWJzY3JpYmUoZiA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdE5leHRSb3dBbmRFZGl0Q2VsbCh0aGlzLmNvbHVtbi5maWVsZCwgJ3VwJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBzZWxlY3RDZWxsKGZpZWxkOiBzdHJpbmcsIHRkRWxlbWVudD86IGFueSkge1xyXG4gICAgICAgIHRoaXMuY2xvc2VFZGl0aW5nQ2VsbCgpLnN1YnNjcmliZSh0ID0+IHtcclxuICAgICAgICAgICAgaWYgKCF0KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGRFbGVtZW50ID0gdGRFbGVtZW50IHx8IHRoaXMuZWwubmF0aXZlRWxlbWVudDtcclxuICAgICAgICAgICAgdGhpcy5jbGVhckNlbGxTZWxlY3RlZENsYXNzKCk7XHJcblxyXG4gICAgICAgICAgICBpZiAoZmllbGQgJiYgZmllbGQgIT09IHRoaXMuZGcuQ29udHJvbFBhbmVsRmVpbGQgJiYgZmllbGQuaW5kZXhPZignZmFycmlzLWRhdGFncmlkLWNvbHVtbicpID09PSAtMSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5yZW5kZXIuYWRkQ2xhc3ModGRFbGVtZW50LCBDRUxMX1NFTEVDVEVEX0NMUyk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC8vIHRoaXMuZHIuZHJIb3Zlci5zZXRSb3dIb3ZlckNscyhmYWxzZSk7XHJcbiAgICAgICAgICAgIHRoaXMuZGZzLnNldEN1cnJlbnRDZWxsKHRoaXMuZHIsIGZpZWxkLCB0ZEVsZW1lbnQsIHRoaXMuZGMpO1xyXG4gICAgICAgICAgICBpZiAoIXRoaXMuZGcuZmFzdCAmJiB0aGlzLmNvbHVtbi5maXhlZCAhPT0gJ2xlZnQnICYmIHRoaXMuY29sdW1uLmZpeGVkICE9PSAncmlnaHQnKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm1vdmVTY3JvbGxiYXIodGRFbGVtZW50KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgbW92ZVNjcm9sbGJhcih0ZDogYW55KSB7XHJcbiAgICAgICAgY29uc3QgdGRQb3NMZWZ0ID0gdGQub2Zmc2V0TGVmdCArIHRkLm9mZnNldFdpZHRoO1xyXG4gICAgICAgIGNvbnN0IGNvbnRhaW5lcldpZHRoID0gdGhpcy5kZy53aWR0aCAtIHRoaXMuZGdiLmNvbHVtbnNHcm91cC5sZWZ0Rml4ZWRXaWR0aCAtIHRoaXMuZGdiLmNvbHVtbnNHcm91cC5yaWdodEZpeGVkV2lkdGg7XHJcbiAgICAgICAgY29uc3QgdGRSZWN0ID0gdGQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XHJcbiAgICAgICAgY29uc3Qgc2Nyb2xsQ29udGFpbmVyID0gdGhpcy5kZ2IucHMuZWxlbWVudFJlZi5uYXRpdmVFbGVtZW50O1xyXG4gICAgICAgIGNvbnN0IHBzQ29udGFpbmVyID0gc2Nyb2xsQ29udGFpbmVyLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xyXG4gICAgICAgIGNvbnN0IHNjcm9sbFRvcCA9IHNjcm9sbENvbnRhaW5lci5zY3JvbGxUb3A7XHJcbiAgICAgICAgY29uc3Qgc2Nyb2xsTGVmdCA9IHNjcm9sbENvbnRhaW5lci5zY3JvbGxMZWZ0O1xyXG4gICAgICAgIGNvbnN0IHNjcm9sbGJhclhMZWZ0ID0gdGhpcy5kZ2IucHMuZWxlbWVudFJlZi5uYXRpdmVFbGVtZW50LnNjcm9sbExlZnQ7XHJcbiAgICAgICAgaWYgKHRkUG9zTGVmdCA+IGNvbnRhaW5lcldpZHRoKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHggPSB0ZFBvc0xlZnQgLSBjb250YWluZXJXaWR0aCArIDI7XHJcbiAgICAgICAgICAgIC8vIGNvbnN0IHggPSB0ZFBvc0xlZnQgLSB0aGlzLmRnYi5wcy5pbnN0YW5jZS5zY3JvbGxiYXJYV2lkdGggKyAyO1xyXG4gICAgICAgICAgICBpZiAoeCA+IHNjcm9sbGJhclhMZWZ0KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmRnYi5wcy5zY3JvbGxUb1goeCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAvLyBpZiAodGRSZWN0LnggPCBwc0NvbnRhaW5lci54KSB7XHJcbiAgICAgICAgICAgIC8vICAgICBjb25zdCB4ID0gc2Nyb2xsTGVmdCAtIHRkUmVjdC54O1xyXG4gICAgICAgICAgICAvLyAgICAgdGhpcy5kZ2IucHMuc2Nyb2xsVG9YKHgpO1xyXG4gICAgICAgICAgICAvLyB9XHJcbiAgICAgICAgICAgIGlmICh0ZC5vZmZzZXRMZWZ0IDwgc2Nyb2xsTGVmdCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5kZ2IucHMuc2Nyb2xsVG9YKHRkLm9mZnNldExlZnQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zdCB0ZFBvc1RvcCA9IHRkUmVjdC50b3AgLSBwc0NvbnRhaW5lci50b3AgKyB0ZFJlY3QuaGVpZ2h0O1xyXG4gICAgICAgIGlmICh0ZFBvc1RvcCA+IHBzQ29udGFpbmVyLmhlaWdodCkge1xyXG4gICAgICAgICAgICBjb25zdCB5ID0gdGRQb3NUb3AgLSBwc0NvbnRhaW5lci5oZWlnaHQ7XHJcbiAgICAgICAgICAgIHRoaXMuZGdiLnBzLnNjcm9sbFRvWShzY3JvbGxUb3AgKyB5KTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBpZiAodGRSZWN0LnkgPCBwc0NvbnRhaW5lci55KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmRnYi5wcy5zY3JvbGxUb1koc2Nyb2xsVG9wIC0gKHBzQ29udGFpbmVyLnkgLSB0ZFJlY3QueSkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgbW92ZU5leHRDZWxsQW5kRWRpdChldmVudD86IGFueSkge1xyXG4gICAgICAgIC8vIGlmICghdGhpcy5jbG9zZUVkaXRpbmdDZWxsKCkpIHtcclxuICAgICAgICAvLyAgICAgcmV0dXJuO1xyXG4gICAgICAgIC8vIH1cclxuICAgICAgICAvLyBjb25zdCBmaWVsZEluZGV4ID0gdGhpcy5kZnMuZ2V0Q29sdW1uSW5kZXgodGhpcy5jb2x1bW4uZmllbGQpO1xyXG4gICAgICAgIGNvbnN0IGZpZWxkSW5kZXggPSB0aGlzLmRnLmNvbEdyb3VwLmNvbHVtbnMuZmluZEluZGV4KG4gPT4gKG4uaWQgJiYgbi5pZCA9PT0gdGhpcy5jb2x1bW4uaWQpIHx8IG4uZmllbGQgPT09IHRoaXMuY29sdW1uLmZpZWxkKTtcclxuICAgICAgICBpZiAoZmllbGRJbmRleCArIDEgPCB0aGlzLmRnYi5jb2x1bW5zR3JvdXAuY29sdW1ucy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgY29uc3QgbmV4dENvbHVtbiA9IHRoaXMuZGdiLmNvbHVtbnNHcm91cC5jb2x1bW5zW2ZpZWxkSW5kZXggKyAxXTtcclxuICAgICAgICAgICAgY29uc3QgbmV4dFRkOiBhbnkgPSB0aGlzLmRnLmZpbmROZXh0VGQobmV4dENvbHVtbik7XHJcblxyXG4gICAgICAgICAgICBpZiAobmV4dFRkICYmICghbmV4dENvbHVtbi5maXhlZCB8fCBuZXh0Q29sdW1uLmZpeGVkID09PSAnY2VudGVyJykpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMubW92ZVNjcm9sbGJhcihuZXh0VGQpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvLyBjb25zdCBuZXh0VGQgPSB0aGlzLmRnLmN1cnJlbnRDZWxsLmNlbGxFbGVtZW50Lm5leHRFbGVtZW50U2libGluZztcclxuICAgICAgICAgICAgaWYgKG5leHRDb2x1bW4gJiYgKCghbmV4dENvbHVtbi5lZGl0b3IgJiYgIW5leHRDb2x1bW4uZWRpdG9yVGVtcGxhdGUpIHx8IHRoaXMuaXNSZWFkb25seShuZXh0Q29sdW1uKSkpIHtcclxuICAgICAgICAgICAgICAgIGlmIChuZXh0VGQpIHtcclxuICAgICAgICAgICAgICAgICAgICBuZXh0VGQuc2VsZWN0Q2VsbChldmVudCwgbmV4dFRkKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKG5leHRUZCkge1xyXG4gICAgICAgICAgICAgICAgbmV4dFRkLmZvY3VzKCk7XHJcbiAgICAgICAgICAgICAgICBpZiAobmV4dENvbHVtbi5lZGl0b3IgfHwgbmV4dENvbHVtbi5lZGl0b3JUZW1wbGF0ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIG5leHRUZC5lZGl0Q2VsbCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZGdzLm9uQ2VsbEVkaXQobmV4dFRkKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIC8vIG5leHQgcm93J3MgZmlyc3QgY2VsbCB0byBlZGl0aW5nXHJcbiAgICAgICAgICAgIGNvbnN0IG5leHRUciA9IHRoaXMuZGcuY3VycmVudENlbGwuY2VsbEVsZW1lbnQucGFyZW50RWxlbWVudC5uZXh0RWxlbWVudFNpYmxpbmc7XHJcbiAgICAgICAgICAgIGlmIChuZXh0VHIgJiYgbmV4dFRyLnRhZ05hbWUgPT09ICdUUicpIHtcclxuICAgICAgICAgICAgICAgIC8vIG5leHRUci5jaGlsZHJlbi5maW5kKHRkID0+IHRkLmVkaXRDZWxsKS5lZGl0Q2VsbCgpO1xyXG4gICAgICAgICAgICAgICAgbGV0IGZpcnN0RWRpdG9yID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICBsZXQgaSA9IDA7XHJcbiAgICAgICAgICAgICAgICB3aGlsZSAoIWZpcnN0RWRpdG9yKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZmlyc3RFZGl0b3IgPSAhIW5leHRUci5jaGlsZHJlbltpXS5lZGl0Q2VsbDtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIWZpcnN0RWRpdG9yKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGkrKztcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5kZy5zZWxlY3Rpb25Nb2RlID09PSAnZGVmYXVsdCcpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmRnLmNsZWFyQ2hlY2tlZHMoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIG5leHRUci5jaGlsZHJlbltpXS5lZGl0Q2VsbCgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgbW92ZVByZXZDZWxsQW5kRWRpdCgpIHtcclxuICAgICAgICAvLyBpZiAoIXRoaXMuY2xvc2VFZGl0aW5nQ2VsbCgpKSB7XHJcbiAgICAgICAgLy8gICAgIHJldHVybjtcclxuICAgICAgICAvLyB9XHJcbiAgICAgICAgY29uc3QgZmllbGRJbmRleCA9IHRoaXMuZGZzLmdldENvbHVtbkluZGV4KHRoaXMuY29sdW1uLmZpZWxkKTtcclxuICAgICAgICBpZiAoZmllbGRJbmRleCAtIDEgPj0gMCkge1xyXG4gICAgICAgICAgICBjb25zdCBuZXh0Q29sdW1uID0gdGhpcy5kZ2IuY29sdW1uc0dyb3VwLm5vcm1hbENvbHVtbnNbZmllbGRJbmRleCAtIDFdO1xyXG4gICAgICAgICAgICBpZiAobmV4dENvbHVtbiAmJiB0aGlzLmlzUmVhZG9ubHkobmV4dENvbHVtbikpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjb25zdCBuZXh0VGQgPSB0aGlzLmRnLmN1cnJlbnRDZWxsLmNlbGxFbGVtZW50LnByZXZpb3VzRWxlbWVudFNpYmxpbmc7XHJcbiAgICAgICAgICAgIGlmIChuZXh0VGQpIHtcclxuICAgICAgICAgICAgICAgIC8vIHRoaXMuc2VsZWN0Q2VsbChuZXh0Q29sdW1uLmZpZWxkLCBuZXh0VGQpO1xyXG4gICAgICAgICAgICAgICAgbmV4dFRkLmZvY3VzKCk7XHJcbiAgICAgICAgICAgICAgICBpZiAobmV4dENvbHVtbi5lZGl0b3IpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyB0aGlzLmRmcy5lZGl0Q2VsbCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIG5leHRUZC5jbGljaygpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZGdzLm9uQ2VsbEVkaXQobmV4dFRkKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIHNlbGVjdE5leHRSb3dBbmRFZGl0Q2VsbChjZWxsRmllbGROYW1lOiBzdHJpbmcsIGRpcjogJ2Rvd24nIHwgJ3VwJykge1xyXG5cclxuICAgICAgICBpZighdGhpcy5kZy5jdXJyZW50Q2VsbCkge1xyXG4gICAgICAgICAgICB0aGlzLmRnLndyaXRlQ29uc29sZSgn5b2T5YmN6YCJ5Lit5Y2V5YWD5qC85Li656m6Jyk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IHAgPSBkaXIgPT09ICdkb3duJyA/ICduZXh0RWxlbWVudFNpYmxpbmcnOiAncHJldmlvdXNFbGVtZW50U2libGluZyc7XHJcbiAgICAgICAgY29uc3QgbmV4dFRyID0gdGhpcy5kZy5jdXJyZW50Q2VsbC5jZWxsRWxlbWVudC5wYXJlbnRFbGVtZW50W3BdO1xyXG4gICAgICAgIGlmIChuZXh0VHIgJiYgbmV4dFRyLnRhZ05hbWUgPT09ICdUUicpIHtcclxuICAgICAgICAgICAgY29uc3QgdGQ6IGFueSA9IEFycmF5LmZyb20obmV4dFRyLmNoaWxkcmVuKS5maW5kKCh0ZDogYW55KSA9PiB0ZC5nZXRBdHRyaWJ1dGUoJ2ZpZWxkJykgPT0gY2VsbEZpZWxkTmFtZSk7XHJcbiAgICAgICAgICAgIGlmICh0ZCAmJiB0ZC5lZGl0Q2VsbCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuZGcuc2VsZWN0aW9uTW9kZSA9PT0gJ2RlZmF1bHQnICkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZGcuY2xlYXJDaGVja2VkcygpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdGQuZWRpdENlbGwoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGNsZWFyQ2VsbFNlbGVjdGVkQ2xhc3MoKSB7XHJcbiAgICAgICAgdGhpcy5kZy5yZW1vdmVDZWxsU2VsZWN0ZWRDbHMoKTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIHNldENlbGxDbHNXaXRoRWRpdG9yVHlwZSgpIHtcclxuXHJcbiAgICAgICAgLy8g6K6+572u5b2T5YmN6YCJ5Lit5Y2V5YWD5qC85qC35byPXHJcbiAgICAgICAgaWYgKHRoaXMuZGcuY3VycmVudENlbGwgJiYgdGhpcy5kZy5lbmFibGVIaWdobGlnaHRDZWxsKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmRnLmN1cnJlbnRDZWxsLmZpZWxkID09PSB0aGlzLmNvbHVtbi5maWVsZCAmJiB0aGlzLmRnLmN1cnJlbnRDZWxsLnJvd0lkID09PSB0aGlzLnJvd0RhdGFbdGhpcy5kZy5pZEZpZWxkXSAmJiAhdGhpcy5kYy5pc0VkaXRpbmcpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuY2xlYXJDZWxsU2VsZWN0ZWRDbGFzcygpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5yZW5kZXIuYWRkQ2xhc3ModGhpcy5lbC5uYXRpdmVFbGVtZW50LCBDRUxMX1NFTEVDVEVEX0NMUyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG5cclxuICAgICAgICBpZiAoIXRoaXMuZGcuZW5hYmxlRWRpdENlbGxTdHlsZSkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zdCB0ZCA9IHRoaXMuZWwubmF0aXZlRWxlbWVudDtcclxuICAgICAgICB0aGlzLmNsZWFuT3RoZXJFZGl0b3JJY29uKHRkKTtcclxuICAgICAgICAvLyDlvZPliY3ooYznpoHnlKjvvIzkuI3lhYHorrjnvJbovpHjgIJcclxuICAgICAgICBpZiAodGhpcy5kci5kaXNhYmxlZCkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoIXRoaXMuY29sdW1uLmVkaXRvcikge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAodGhpcy5pc1JlYWRvbmx5KCkpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3QgZWRpdG9yVHlwZSA9IHRoaXMuY29sdW1uLmVkaXRvci50eXBlO1xyXG4gICAgICAgIGNvbnN0IGNscyA9IHRoaXMuY29sdW1uLmFsaWduID09PSAncmlnaHQnID8gJ2FsbG93LWVkaXQtY2VsbC1sZWZ0JyA6ICdhbGxvdy1lZGl0LWNlbGwnO1xyXG4gICAgICAgIHRoaXMucmVuZGVyLmFkZENsYXNzKHRkLCBjbHMpO1xyXG4gICAgICAgIHRoaXMucmVuZGVyLmFkZENsYXNzKHRkLCBBTExPV19FRElUX0NFTExfSElHSExJR0hUX0NMU1tlZGl0b3JUeXBlXSk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBjbGVhbk90aGVyRWRpdG9ySWNvbih0ZCkge1xyXG4gICAgICAgIGNvbnN0IHZhbHVlcyA9IE9iamVjdC52YWx1ZXMoQUxMT1dfRURJVF9DRUxMX0hJR0hMSUdIVF9DTFMpO1xyXG4gICAgICAgIHZhbHVlcy5mb3JFYWNoKHYgPT4ge1xyXG4gICAgICAgICAgICBpZiAodGQuY2xhc3NOYW1lLmluZGV4T2YodikgPiAtMSkge1xyXG4gICAgICAgICAgICAgICAgdGQuY2xhc3NOYW1lID0gdGQuY2xhc3NOYW1lLnJlcGxhY2UoJ2FsbG93LWVkaXQtY2VsbC1sZWZ0JywgJycpLnJlcGxhY2UoJ2FsbG93LWVkaXQtY2VsbCcsICcnKTtcclxuICAgICAgICAgICAgICAgIHRkLmNsYXNzTmFtZSA9IHRkLmNsYXNzTmFtZS5yZXBsYWNlKHYsICcnKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG59XHJcbiJdfQ==