/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
import { switchMap, delay, debounceTime, takeUntil } from 'rxjs/operators';
import { of, Subject } from 'rxjs';
import ResizeObserver from 'resize-observer-polyfill';
/*
 * @Author: 疯狂秀才(Lucas Huang)
 * @Date: 2019-08-12 07:47:12
 * @LastEditors: 疯狂秀才(Lucas Huang)
 * @LastEditTime: 2019-11-26 10:21:25
 * @QQ: 1055818239
 * @Version: v0.0.1
 */
import { Component, Input, ViewChild, Renderer2, ElementRef, ChangeDetectorRef, ChangeDetectionStrategy, NgZone, Injector, Optional, ApplicationRef, Output, EventEmitter } from '@angular/core';
import { DatagridFacadeService } from '../../services/datagrid-facade.service';
import { ScrollbarDirective } from '../../scrollbar/scrollbar.directive';
import { GROUP_ROW_FIELD, IS_GROUP_FOOTER_ROW_FIELD, GROUP_VISIBLE_FIELD } from '../../services/state';
import { SCROLL_X_ACTION, SCROLL_Y_ACTION, SCROLL_X_REACH_START_ACTION, TR_PREFIX, WORDWRAP_ROW_HEIGHT_CLS } from '../../types/constant';
import { DatagridService } from '../../services/datagrid.service';
import { DatagridComponent } from '../../datagrid.component';
import { FormatCellDataPipe } from '../../utils/format-cell-data.pipe';
import { ColumnFormatService } from '@farris/ui-common/column';
import { Utils } from '../../utils/utils';
var DatagridBodyComponent = /** @class */ (function () {
    function DatagridBodyComponent(injector, app, dg, cd, el) {
        var _this = this;
        this.injector = injector;
        this.app = app;
        this.dg = dg;
        this.cd = cd;
        this.el = el;
        // 自动高度时，禁用纵向滚动条
        this.psConfig = { swipeEasing: false, minScrollbarLength: 15, handlers: ['click-rail', 'drag-thumb', 'wheel', 'touch'], suppressScrollY: this.dg.autoHeight && this.dg.maxHeight ? false : this.dg.autoHeight };
        this.scrollTop = 0;
        this.scrollLeft = 0;
        this.deltaTopHeight = 0;
        // wheelHeight = 0;
        this.wheelWidth = 0;
        this._fixedRightScrollLeft = 0;
        this.maxScrollLeft = 0;
        this.showRightShadow = false;
        this.footerHeight = 0;
        // 虚拟加载
        this.topHideHeight = 0;
        this.bottomHideHeight = 0;
        this.startRowIndex = 0;
        this.dataChange = new EventEmitter();
        this.scrollBarMode = 'auto';
        this.checkedRows = [];
        /**
         * 性能优化版，默认为 false
         */
        this.fast = false;
        this.visibleContextMenus = [];
        this.currentRowId = undefined;
        this._hoverRowIndex = -1;
        this.subscriptions = [];
        this.minRowBuffer = 3;
        this.vScrollDir = 1;
        this.rowsCache = {};
        this.lastRenderedScrollTop = 0;
        this.lastRenderedScrollLeft = 0;
        this.prevScrollTop = 0;
        this.prevScrollLeft = 0;
        this.rows = [];
        this.blankTopHeight = 0;
        this.blankBottomHeight = 0;
        this.cellContentFormatter = null;
        // 当启用多选且允许多选中，列表不能编辑时，取选中后禁止触发body 的click 事件
        this.__triggerBodyClickEvent = true;
        this.destroy$ = new Subject();
        this._onMouseClick = null;
        this._scrollTimer = 0;
        this._scrollXTimer = 0;
        this.ro = null;
        this.resizeObserverTimer = 0;
        this._clickCellWeakMap = new WeakMap();
        this.onBeforeShowContextMenu = (/**
         * @param {?} e
         * @return {?}
         */
        function (e) {
            // row_1_fixedleft  row_1  row_1_fixedright
            var contextMenuDom = e.contextMenuDom, event = e.event;
            if (event.target.closest('.datagrid-editor')) {
                return of({ show: false });
            }
            /** @type {?} */
            var rowID = event.target.id;
            if (contextMenuDom) {
                // 排除分组行、分组合计行
                if (contextMenuDom.className.indexOf('f-datagrid-group-row') === -1 && contextMenuDom.className.indexOf('f-datagrid-group-footer') === -1) {
                    rowID = Utils.getRowIdByTr(contextMenuDom);
                    /** @type {?} */
                    var rowData_1 = _this.dfs.findRow(rowID);
                    /** @type {?} */
                    var focusTargetWidth_1 = _this.viewportW > _this.totalWidth ? _this.totalWidth : _this.viewportW;
                    /** @type {?} */
                    var td = event.target.closest('td');
                    /** @type {?} */
                    var colInfo_1 = null;
                    if (td) {
                        /** @type {?} */
                        var fieldName = td.getAttribute('field');
                        colInfo_1 = fieldName ? _this.dfs.getColumn(fieldName) : null;
                    }
                    /** @type {?} */
                    var beforeShowContextMenus$ = of(true);
                    if (_this.dg.beforeShowContextMenus) {
                        /** @type {?} */
                        var showContextMenu = _this.dg.beforeShowContextMenus({ rowid: rowID, data: rowData_1.data, grid: _this.dg, column: colInfo_1 });
                        if (typeof showContextMenu === 'boolean') {
                            beforeShowContextMenus$ = of(showContextMenu);
                        }
                        else {
                            if (showContextMenu['subscribe']) {
                                beforeShowContextMenus$ = showContextMenu;
                            }
                        }
                    }
                    return beforeShowContextMenus$.pipe(switchMap((/**
                     * @param {?} e
                     * @return {?}
                     */
                    function (e) {
                        /** @type {?} */
                        var params = { rowid: rowID, data: rowData_1.data, grid: _this.dg, column: colInfo_1 };
                        if (typeof e === 'object') {
                            var isShow = e.show, customData = e.customData;
                            return of({ show: isShow, data: Object.assign(params, { customData: customData ? customData : null }), focusTargetWidth: focusTargetWidth_1 });
                        }
                        else {
                            return of({ show: e, data: params, focusTargetWidth: focusTargetWidth_1 });
                        }
                    })));
                }
            }
            return of({ show: false });
        });
        this.dfs = this.injector.get(DatagridFacadeService);
        this.dgs = this.injector.get(DatagridService);
        this.ngZone = this.injector.get(NgZone);
        this.render = this.injector.get(Renderer2);
        /** @type {?} */
        var columnFormatService = this.injector.get(ColumnFormatService);
        this.cellContentFormatter = new FormatCellDataPipe(columnFormatService, this.injector);
    }
    Object.defineProperty(DatagridBodyComponent.prototype, "fixedRightScrollLeft", {
        get: /**
         * @return {?}
         */
        function () {
            return this._fixedRightScrollLeft;
        },
        set: /**
         * @param {?} val
         * @return {?}
         */
        function (val) {
            this._fixedRightScrollLeft = val;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(DatagridBodyComponent.prototype, "hoverRowIndex", {
        get: /**
         * @return {?}
         */
        function () {
            return this._hoverRowIndex;
        },
        set: /**
         * @param {?} rowIdx
         * @return {?}
         */
        function (rowIdx) {
            this._hoverRowIndex = rowIdx;
            this.cd.detectChanges();
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(DatagridBodyComponent.prototype, "selectedRows", {
        get: /**
         * @return {?}
         */
        function () {
            return this.dg.selections;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(DatagridBodyComponent.prototype, "scrollbarXHeight", {
        //////////////////////////////////////////////////////////////////////////
        get: 
        //////////////////////////////////////////////////////////////////////////
        /**
         * @return {?}
         */
        function () {
            if (this.dg && this.ps && this.ps.instance) {
                /** @type {?} */
                var h = this.dg.scrollBarShowMode === 'allways' && this.ps.instance['scrollbarXActive'] ? 22 : 0;
                if (this.ps.instance['scrollbarYActive'] && h) {
                    return h + 18; // + (this.dg.showScrollArrow && this.ps.instance['scrollbarYActive'] ? 18 : 0);
                }
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(DatagridBodyComponent.prototype, "scrollbarYWidth", {
        get: /**
         * @return {?}
         */
        function () {
            if (this.dg && this.ps && this.ps.instance) {
                return this.dg.scrollBarShowMode === 'allways' && this.ps.instance['scrollbarYActive'] && this.showRightShadow ? 18 : 0;
            }
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    DatagridBodyComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this.listenSubjects();
        this.dg.scrollInstance = this.ps;
        /** @type {?} */
        var s1 = this.dgs.showGridHeader.subscribe((/**
         * @param {?} headerHeight
         * @return {?}
         */
        function (headerHeight) {
            _this.updateContainerSize(headerHeight);
        }));
        this.subscriptions.push(s1);
        /** @type {?} */
        var s10 = this.dgs.footerPositionChanged.subscribe((/**
         * @return {?}
         */
        function () {
            _this.updateContainerSize();
        }));
        this.subscriptions.push(s10);
        /** @type {?} */
        var s2 = this.dgs.rowHeightChanged.subscribe((/**
         * @return {?}
         */
        function () {
            _this.cd.detectChanges();
        }));
        this.subscriptions.push(s2);
        /** @type {?} */
        var s3 = this.dfs.clientSort$.subscribe((/**
         * @return {?}
         */
        function () {
            _this.checkScrollbarPosition(true);
            _this.cd.detectChanges();
            // this.dg.columnSorted.emit();
        }));
        this.subscriptions.push(s3);
        /** @type {?} */
        var s5 = this.dg.dgs.columnsChanged.pipe(delay(50)).subscribe((/**
         * @param {?} e
         * @return {?}
         */
        function (e) {
            if (e && e.scrollToLeft) {
                _this.ps.elementRef.nativeElement.scrollTo(0, 0);
                _this.ps.scrollToLeft(0, 100);
            }
        }));
        this.subscriptions.push(s5);
        this.viewScrollContainer.nativeElement.addEventListener('click', this._onMouseClick = (/**
         * @param {?} e
         * @return {?}
         */
        function (e) {
            _this.onMouseClick(e);
        }));
        if (!this.dg.nowrap) {
            this.dgs.dataloaded.subscribe((/**
             * @return {?}
             */
            function () {
                _this.updateRowHeight();
            }));
        }
    };
    /**
     * @private
     * @param {?=} headerHeight
     * @return {?}
     */
    DatagridBodyComponent.prototype.updateContainerSize = /**
     * @private
     * @param {?=} headerHeight
     * @return {?}
     */
    function (headerHeight) {
        /** @type {?} */
        var hh = headerHeight || this.dg.realHeaderHeight;
        this.setPositionTop(hh);
        this.height = this.dg.height - this.top;
        this.bodyStyle = this.getBodyStyle();
        this.cd.detectChanges();
    };
    /**
     * @param {?} changes
     * @return {?}
     */
    DatagridBodyComponent.prototype.ngOnChanges = /**
     * @param {?} changes
     * @return {?}
     */
    function (changes) {
        var _this = this;
        if (changes.data && !changes.data.isFirstChange()) {
            this.bodyStyle = this.getBodyStyle();
            this.dfs.setCurrentPageData(changes.data.currentValue);
            /** @type {?} */
            var isDiffrentDataSource = !!changes.data.currentValue.filter((/**
             * @param {?} n
             * @return {?}
             */
            function (n) { return !n['__group__']; })).map((/**
             * @param {?} n
             * @return {?}
             */
            function (n) { return n.id; })).filter((/**
             * @param {?} n
             * @return {?}
             */
            function (n) {
                return !changes.data.previousValue.filter((/**
                 * @param {?} n
                 * @return {?}
                 */
                function (n) { return !n['__group__']; })).find((/**
                 * @param {?} p
                 * @return {?}
                 */
                function (p) { return p.id === n; }));
            })).length;
            /** @type {?} */
            var isSameLength = changes.data.currentValue.filter((/**
             * @param {?} n
             * @return {?}
             */
            function (n) { return !n['__group__']; })).length >= changes.data.previousValue.filter((/**
             * @param {?} n
             * @return {?}
             */
            function (n) { return !n['__group__']; })).length;
            this.onDataChanged(isSameLength, isDiffrentDataSource);
            if (!changes.data.currentValue || !changes.data.currentValue.length) {
                setTimeout((/**
                 * @return {?}
                 */
                function () {
                    _this.setPositionTop(_this.dg.realHeaderHeight);
                }));
            }
        }
        if (changes.footerHeight !== undefined && !changes.footerHeight.isFirstChange()) {
            this.bodyStyle = this.getBodyStyle();
        }
        if (changes.scrollBarMode !== undefined && !changes.scrollBarMode.isFirstChange()) {
            if (this.ps && this.ps.instance && this.scrollBarMode === 'allways' && this.ps.instance.scrollbarYActive) {
                this.rightFixedWidth += this.showRightShadow ? 18 : 0;
            }
            else {
                this.rightFixedWidth = this.columnsGroup.rightFixedWidth;
            }
            if (this.dg.scrollBarShowMode === 'allways' && this.ps && this.ps.instance && this.ps.instance.scrollbarXActive) {
                this.blankBottomHeight += 22;
            }
        }
        if (changes.showScrollArrow && !changes.showScrollArrow.isFirstChange()) {
            this.ps && this.ps.update();
        }
    };
    /**
     * @return {?}
     */
    DatagridBodyComponent.prototype.ngOnDestroy = /**
     * @return {?}
     */
    function () {
        this.destroy$.next();
        this.destroy$.complete();
        this.cellContentFormatter = null;
        this.dg.scrollInstance = null;
        this.destroySubscriptions();
        this.viewScrollContainer.nativeElement.removeEventListener('click', this._onMouseClick);
        if (this.ro) {
            this.ro.unobserve(this.viewScrollContainer.nativeElement);
            this.ro.disconnect();
        }
        if (this.resizeObserverTimer) {
            clearTimeout(this.resizeObserverTimer);
        }
    };
    /**
     * @return {?}
     */
    DatagridBodyComponent.prototype.ngAfterViewInit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this.ro = new ResizeObserver((/**
         * @param {?} e
         * @return {?}
         */
        function (e) {
            if (_this.viewScrollContainer.nativeElement.offsetParent) {
                if (_this.resizeObserverTimer) {
                    clearTimeout(_this.resizeObserverTimer);
                }
                _this.resizeObserverTimer = setTimeout((/**
                 * @return {?}
                 */
                function () {
                    _this.updateCanvasHeight();
                    if (_this.scrollBarMode === 'allways') {
                        _this.ps.update();
                    }
                    // this.setFixedRightWidth();
                    _this.cd.detectChanges();
                    _this.dgs.scrollbarUpdate.emit({ scrollbarRef: _this.ps.instance, rightWidth: _this.rightFixedWidth, showRightShadow: _this.showRightShadow });
                }), 100);
            }
        }));
        this.ro.observe(this.viewScrollContainer.nativeElement);
    };
    /**
     * @return {?}
     */
    DatagridBodyComponent.prototype.ngAfterViewChecked = /**
     * @return {?}
     */
    function () {
    };
    /**
     * @private
     * @param {?} headerHeight
     * @return {?}
     */
    DatagridBodyComponent.prototype.setPositionTop = /**
     * @private
     * @param {?} headerHeight
     * @return {?}
     */
    function (headerHeight) {
        this.top = headerHeight;
        if ((this.dg.enableFilterRow || this.dg.enableSmartFilter) && this.dg.showFilterBar) {
            this.top += this.dg.filterBarHeight;
        }
        if (this.dg.showRowGroupPanel) {
            this.top += this.dg.rowGroupPanelHeight;
        }
        if (this.dg.showFooter && (this.dg.footerPosition === 'top' || this.dg.footerPosition === 'both')) {
            // headerHeight 已包括过滤行的高度 tfs 542471
            if (this.data && this.data.length) {
                this.top += this.dg.footerHeight;
            }
        }
    };
    /**
     * @private
     * @param {?=} toTop
     * @return {?}
     */
    DatagridBodyComponent.prototype.checkScrollbarPosition = /**
     * @private
     * @param {?=} toTop
     * @return {?}
     */
    function (toTop) {
        if (toTop === void 0) { toTop = false; }
        if (!this.dg.data || !this.dg.data.length) {
            return;
        }
        /** @type {?} */
        var scrollBar = this.ps.instance;
        /** @type {?} */
        var scrollElRef = this.ps.elementRef.nativeElement;
        // scrollBar.update();
        /** @type {?} */
        var lastScrollLeft = scrollBar ? scrollBar.lastScrollLeft : 0;
        /** @type {?} */
        var lastScrollTop = scrollBar ? scrollBar.lastScrollTop : 0;
        // const lastScrollLeft = this.scrollLeft;
        // const lastScrollTop = this.scrollTop;
        /** @type {?} */
        var scrollTop = scrollElRef.scrollTop;
        /** @type {?} */
        var scrollLeft = scrollElRef.scrollLeft;
        if (!toTop) {
            if (scrollTop != lastScrollTop) {
                this.ps.scrollToTop(lastScrollTop);
                this.dgs.onScrollMove(lastScrollTop, SCROLL_Y_ACTION);
            }
        }
        else {
            this.ps.scrollToTop();
            this.dgs.onScrollMove(lastScrollTop, SCROLL_Y_ACTION);
        }
        this.scrollLeft = lastScrollLeft;
        if (scrollLeft != lastScrollLeft) {
            this.ps.scrollToX(lastScrollLeft);
            this.dgs.onScrollMove(lastScrollLeft, SCROLL_X_ACTION);
        }
        else {
            if (lastScrollLeft) {
                this.dgs.onScrollMove(lastScrollLeft, SCROLL_X_ACTION);
            }
        }
    };
    /**
     * 数据发生变化，重新加载数据时执行
     * 重置滚动条位置
     */
    /**
     * 数据发生变化，重新加载数据时执行
     * 重置滚动条位置
     * @private
     * @param {?=} isSameLength
     * @param {?=} isDiffrentDataSource
     * @return {?}
     */
    DatagridBodyComponent.prototype.onDataChanged = /**
     * 数据发生变化，重新加载数据时执行
     * 重置滚动条位置
     * @private
     * @param {?=} isSameLength
     * @param {?=} isDiffrentDataSource
     * @return {?}
     */
    function (isSameLength, isDiffrentDataSource) {
        var _this = this;
        if (isSameLength === void 0) { isSameLength = true; }
        if (isDiffrentDataSource === void 0) { isDiffrentDataSource = false; }
        this.dg.setPagerHeight();
        this.viewportH = this.getViewPortHeight();
        this.bodyStyle = this.getBodyStyle();
        /**
         * update:
         * node_modules\perfect-scrollbar\types\perfect-scrollbar.d.ts
         * lastScrollTop: number
         */
        if (this.ps && this.ps.instance && !this.dg.isEditing() && !this.dg.clientFilterChanged && !this.dg.autoHeight) {
            this.scrollTop = 0;
            this.lastRenderedScrollTop = 0;
            this.ps.scrollToTop();
            this.scrollLeft = 0;
            this.ps.scrollToLeft();
        }
        this.rowsCache = {};
        /** @type {?} */
        var keepscrollPos = (/**
         * @return {?}
         */
        function () {
            /** @type {?} */
            var scrollInfo = _this.dg.dfs.getState().scrollInfo;
            if (scrollInfo) {
                if (scrollInfo.y) {
                    _this.scrollTop = scrollInfo.y;
                    _this.dg.scrollInstance.scrollToY(scrollInfo.y);
                    _this.dgs.onScrollMove(scrollInfo.y, SCROLL_Y_ACTION);
                }
                if (scrollInfo.x) {
                    _this.scrollLeft = scrollInfo.x;
                    _this.dg.scrollInstance.scrollToX(scrollInfo.x);
                    _this.dg.dgs.onScrollMove(scrollInfo.x, SCROLL_X_ACTION);
                }
            }
        });
        if (!this.dg.nowrap || this.dg.autoHeight) {
            this.renderData(false);
            this.dgs.cellContentWrapChanged.next(this.width);
        }
        else {
            if (isSameLength) {
                keepscrollPos();
            }
            this.renderData(false);
            this.ps.update();
        }
        if (isDiffrentDataSource) {
            this.dg.initSelectOrChecked();
        }
        else {
            this.dg.refreshSelectedData();
        }
        this.dg.clientFilterChanged = false;
        this.dataChange.emit(this.data);
        if (this.dg.scrollBarShowMode === 'allways' && this.ps.instance && !this.dg.showScrollArrow) {
            this.hasYScrollbar();
        }
    };
    /**
     * @private
     * @return {?}
     */
    DatagridBodyComponent.prototype.destroySubscriptions = /**
     * @private
     * @return {?}
     */
    function () {
        if (this.subscriptions && this.subscriptions.length) {
            this.subscriptions.forEach((/**
             * @param {?} sub
             * @return {?}
             */
            function (sub) {
                if (sub) {
                    sub.unsubscribe();
                    sub = null;
                }
            }));
            this.subscriptions = [];
        }
    };
    /**
     * @private
     * @return {?}
     */
    DatagridBodyComponent.prototype.listenSubjects = /**
     * @private
     * @return {?}
     */
    function () {
        var _this = this;
        this.destroySubscriptions();
        this.gridSizeSubscribe = this.dfs.gridSize$.pipe(takeUntil(this.destroy$)).pipe(debounceTime(50)).subscribe((/**
         * @param {?} state
         * @return {?}
         */
        function (state) {
            if (state) {
                _this.dg.setPagerHeight();
                /** @type {?} */
                var hh = _this.dg.setHeaderHeight();
                _this.setPositionTop(hh);
                _this.height = state.height - _this.top;
                /** @type {?} */
                var oldWidth_1 = _this.width;
                _this.width = Math.floor(state.width);
                _this.rowHeight = state.rowHeight;
                if (_this.dg.showBorder) {
                    _this.width -= 2;
                }
                _this.viewportW = _this.width;
                _this.viewportH = _this.getViewPortHeight();
                _this.canvasHeight = _this.getCanvasHeight();
                _this.ngZone.runOutsideAngular((/**
                 * @return {?}
                 */
                function () {
                    _this.columnsGroup = state.columnsGroup;
                    _this.checkScrollbarPosition();
                    // this.setFixedRightPosition();
                    _this.updateColumnSize(state.columnsGroup);
                    _this.dgs.showFixedShadow.emit({ showRightShadow: _this.showRightShadow, x: _this.fixedRightScrollLeft });
                    _this.renderData(false);
                    if ((!_this.dg.nowrap || _this.dg.autoHeight) && _this.rows && _this.rows.length) {
                        if (oldWidth_1 !== _this.width) {
                            _this.dgs.cellContentWrapChanged.next(oldWidth_1);
                        }
                        else {
                            _this.keepScrollbarPosition(oldWidth_1);
                        }
                    }
                    else {
                        if (_this._scrollXTimer) {
                            clearTimeout(_this._scrollXTimer);
                        }
                        _this._scrollXTimer = setTimeout((/**
                         * @return {?}
                         */
                        function () {
                            _this.keepScrollbarPosition(oldWidth_1);
                        }), 100);
                    }
                }));
            }
        }));
        this.subscriptions.push(this.gridSizeSubscribe);
        this.columnResizeSubscribe = this.dfs.columnResize$.subscribe((/**
         * @param {?} cg
         * @return {?}
         */
        function (cg) {
            _this.updateColumnSize(cg);
            _this.cd.detectChanges();
        }));
        this.subscriptions.push(this.columnResizeSubscribe);
        this.dgs.setSelecedRow.subscribe((/**
         * @param {?} r
         * @return {?}
         */
        function (r) {
            if (r && r.selected) {
                _this.currentRowId = r.id;
            }
            else {
                _this.currentRowId = undefined;
            }
        }));
        this.selectRowSubscribe = this.dfs.selectRow$.subscribe((/**
         * @param {?} row
         * @return {?}
         */
        function (row) {
            if (row) {
                _this.currentRowId = row.id;
                // 20210817 方向键移动后刷新视图状态
                _this.cd.detectChanges();
            }
        }));
        this.subscriptions.push(this.selectRowSubscribe);
        this.unselectRowSubscribe = this.dfs.unSelectRow$.subscribe((/**
         * @param {?} prevRow
         * @return {?}
         */
        function (prevRow) {
            if (prevRow && prevRow.id === _this.currentRowId) {
                _this.currentRowId = undefined;
                _this.dg.selectedRow = null;
            }
            if (!_this.dg.editable && _this.dg.multiSelect) {
                _this.__triggerBodyClickEvent = _this.dg.selectionMode === 'default';
            }
            _this.cd.detectChanges();
        }));
        this.subscriptions.push(this.unselectRowSubscribe);
        this.selectAllSubscribe = this.dfs.selectAll$.subscribe((/**
         * @param {?} rows
         * @return {?}
         */
        function (rows) {
            _this.dg.selectAll.emit(rows);
            _this.cd.detectChanges();
        }));
        this.subscriptions.push(this.selectAllSubscribe);
        this.checkRowSubscribe = this.dfs.checkRow$.subscribe((/**
         * @param {?} row
         * @return {?}
         */
        function (row) {
            _this.dg.checked.emit(row);
            _this.checkedRowsChanged();
            // this.cd.detectChanges();
        }));
        this.subscriptions.push(this.checkRowSubscribe);
        this.clearSelectionsSubscribe = this.dfs.clearSelections$.subscribe((/**
         * @return {?}
         */
        function () {
            _this.currentRowId = undefined;
            if (_this.dg.checkOnSelect) {
                _this.checkedRowsChanged();
            }
            _this.dg.unSelectAll.emit();
        }));
        this.subscriptions.push(this.clearSelectionsSubscribe);
        this.uncheckRowSubscribe = this.dfs.unCheckRow$.subscribe((/**
         * @param {?} prevRow
         * @return {?}
         */
        function (prevRow) {
            _this.dg.unChecked.emit(prevRow);
            _this.checkedRowsChanged();
            // this.cd.detectChanges();
        }));
        this.subscriptions.push(this.uncheckRowSubscribe);
        this.checkAllSubscribe = this.dfs.checkAll$.subscribe((/**
         * @param {?} rows
         * @return {?}
         */
        function (rows) {
            _this.dg.checkAll.emit(rows);
            _this.checkedRowsChanged();
            // this.cd.detectChanges();
        }));
        this.subscriptions.push(this.checkAllSubscribe);
        this.clearCheckedsSubscribe = this.dfs.clearCheckeds$.subscribe((/**
         * @param {?} rows
         * @return {?}
         */
        function (rows) {
            if (_this.dg.selectOnCheck) {
                _this.currentRowId = undefined;
            }
            _this.dg.unCheckAll.emit(rows);
            _this.checkedRowsChanged();
            _this.cd.detectChanges();
        }));
        this.subscriptions.push(this.clearCheckedsSubscribe);
        this.subscriptions.push(this.dgs.setScrollbarPosition.subscribe((/**
         * @return {?}
         */
        function () {
            _this.checkScrollbarPosition();
            _this.updateScrollPosition(_this.scrollLeft);
        })));
        this.dgs.columnResized.pipe(delay(100)).subscribe((/**
         * @param {?} e
         * @return {?}
         */
        function (e) {
            if (!_this.dg.nowrap ||
                (_this.dg.currentCell && _this.dg.currentCell.isEditing && _this.dg.currentCell.column &&
                    _this.dg.currentCell.column.editor && _this.dg.currentCell.column.editor.type === 'textarea')) {
                /** @type {?} */
                var trdoms = _this.dg.dgContainer.nativeElement.querySelectorAll('.f-datagrid-body-row:not(.f-datagrid-footer-row)');
                trdoms.forEach((/**
                 * @param {?} n
                 * @return {?}
                 */
                function (n) {
                    _this.render.setStyle(n, 'height', 'auto');
                }));
                /** @type {?} */
                var trID = '';
                if (e) {
                    /** @type {?} */
                    var rowId = e.id;
                    trID = TR_PREFIX + rowId;
                }
                _this.updateRowHeight(trID);
            }
            if (_this.dg.headerWrap) {
                _this.dg.setHeaderHeight();
                _this.dfs.columnResizeEnd();
            }
        }));
        this.dgs.cellContentWrapChanged.pipe(takeUntil(this.destroy$), debounceTime(100)).subscribe((/**
         * @param {?} oldWidth
         * @return {?}
         */
        function (oldWidth) {
            _this.updateRowHeight();
            if (oldWidth != null) {
                _this.keepScrollbarPosition(oldWidth);
            }
            else {
                _this.ps && _this.ps.instance && _this.ps.instance.update();
            }
        }));
        this.dg.dfs.rowUpdate$.subscribe((/**
         * @param {?} row
         * @return {?}
         */
        function (row) {
            if (row && row.data) {
                _this.buildCustomCellStyle(row);
            }
        }));
        if (this.dg.groupRows) {
            this.dfs.expandGroupRow.pipe(takeUntil(this.destroy$)).subscribe((/**
             * @param {?} e
             * @return {?}
             */
            function (e) {
                if (e && e.data) {
                    _this.groupRowStateChanged(e.data, true);
                    setTimeout((/**
                     * @return {?}
                     */
                    function () { _this.updateRowHeight(); }));
                }
            }));
            this.dfs.collapseGroupRow.pipe(takeUntil(this.destroy$)).subscribe((/**
             * @param {?} e
             * @return {?}
             */
            function (e) {
                if (e && e.data) {
                    _this.groupRowStateChanged(e.data, false);
                }
            }));
        }
    };
    /**
     * @private
     * @param {?} groupRow
     * @param {?} isExpand
     * @return {?}
     */
    DatagridBodyComponent.prototype.groupRowExpandUpdate = /**
     * @private
     * @param {?} groupRow
     * @param {?} isExpand
     * @return {?}
     */
    function (groupRow, isExpand) {
        var _this = this;
        if (groupRow.rows && groupRow.rows.length) {
            groupRow.rows.forEach((/**
             * @param {?} n
             * @return {?}
             */
            function (n) {
                if (n[IS_GROUP_FOOTER_ROW_FIELD]) {
                    _this.data.filter((/**
                     * @param {?} t
                     * @return {?}
                     */
                    function (t) { return t[GROUP_ROW_FIELD] === n[GROUP_ROW_FIELD]; })).forEach((/**
                     * @param {?} d
                     * @return {?}
                     */
                    function (d) {
                        d[GROUP_VISIBLE_FIELD] = isExpand && groupRow.expanded;
                    }));
                }
                else {
                    /** @type {?} */
                    var item = _this.data.find((/**
                     * @param {?} e
                     * @return {?}
                     */
                    function (e) { return e.id === n.id; }));
                    if (item) {
                        item[GROUP_VISIBLE_FIELD] = isExpand && groupRow.expanded;
                        if (item.rows && item.rows.length) {
                            _this.groupRowExpandUpdate(item, isExpand);
                        }
                    }
                }
            }));
        }
    };
    /**
     * @private
     * @param {?} rowData
     * @param {?} expand
     * @return {?}
     */
    DatagridBodyComponent.prototype.groupRowStateChanged = /**
     * @private
     * @param {?} rowData
     * @param {?} expand
     * @return {?}
     */
    function (rowData, expand) {
        var _this = this;
        if (this.dg.virtualized) {
            /** @type {?} */
            var gr = this.data.find((/**
             * @param {?} n
             * @return {?}
             */
            function (n) { return n.id === rowData.id; }));
            this.groupRowExpandUpdate(gr, expand);
            this.renderData(false);
        }
        else {
            this.getCanvasHeight();
        }
        if (this['_psUpdateTimer_']) {
            clearTimeout(this['_psUpdateTimer_']);
        }
        this['_psUpdateTimer_'] = setTimeout((/**
         * @return {?}
         */
        function () {
            _this.ps.update();
            _this.cd.detectChanges();
        }), 100);
    };
    /**
     * @private
     * @param {?} oldWidth
     * @return {?}
     */
    DatagridBodyComponent.prototype.keepScrollbarPosition = /**
     * @private
     * @param {?} oldWidth
     * @return {?}
     */
    function (oldWidth) {
        var _this = this;
        if (!this.cd["destroyed"]) {
            this.cd.detectChanges();
        }
        if (!this.ps.instance) {
            return;
        }
        if (this["keepScrollbarPositionTIMER"]) {
            clearTimeout(this["keepScrollbarPositionTIMER"]);
        }
        this["keepScrollbarPositionTIMER"] = setTimeout((/**
         * @return {?}
         */
        function () {
            if (_this.width > oldWidth) {
                /** @type {?} */
                var x = _this.scrollLeft - (_this.width - oldWidth);
                _this.ps.elementRef.nativeElement.scrollLeft = x < 0 ? 0 : x;
            }
            if (!_this.dg.nowrap || _this.dg.autoHeight) {
                _this.updateCanvasHeight();
            }
            _this.ps.update();
            _this.updateScrollPosition(_this.ps.elementRef.nativeElement.scrollLeft);
            _this.dgs.scrollbarUpdate.emit({ scrollbarRef: _this.ps.instance, rightWidth: _this.rightFixedWidth, showRightShadow: _this.showRightShadow });
        }), 50);
    };
    /**
     * @private
     * @param {?} cg
     * @return {?}
     */
    DatagridBodyComponent.prototype.updateColumnSize = /**
     * @private
     * @param {?} cg
     * @return {?}
     */
    function (cg) {
        if (cg) {
            this.columnsGroup = cg;
            this.leftFixedWidth = this.columnsGroup.leftFixedWidth;
            this.colsWidth = this.columnsGroup.normalWidth;
            this.scrollLeft = this.ps.elementRef.nativeElement.scrollLeft;
            this.maxScrollLeft = this.colsWidth + this.leftFixedWidth;
            this.fixedRightScrollLeft = this.maxScrollLeft;
            // grid 容器宽度
            /** @type {?} */
            var dgContainerWidth = this.dg.dgContainer.nativeElement.offsetWidth;
            // 所有列宽之和
            /** @type {?} */
            var allColsWidth = Math.floor(this.columnsGroup.totalWidth);
            this.bodyStyle = this.getBodyStyle();
            if (dgContainerWidth > allColsWidth || dgContainerWidth === allColsWidth) {
                this.showRightShadow = false;
            }
            else {
                this.showRightShadow = true;
                // 右侧固定列的位置
                this.fixedRightScrollLeft = this.width + this.scrollLeft;
            }
            this.setFixedRightWidth();
        }
    };
    /**
     * @private
     * @return {?}
     */
    DatagridBodyComponent.prototype.setFixedRightWidth = /**
     * @private
     * @return {?}
     */
    function () {
        this.rightFixedWidth = this.columnsGroup.rightFixedWidth;
        this.totalWidth = this.columnsGroup.totalWidth;
        if (this.ps && this.ps.instance && this.dg.scrollBarShowMode === 'allways') {
            if (this.ps.instance.scrollbarYActive) {
                this.rightFixedWidth += 18;
            }
        }
    };
    /**
     * @private
     * @param {?} row
     * @return {?}
     */
    DatagridBodyComponent.prototype.buildCustomCellStyle = /**
     * @private
     * @param {?} row
     * @return {?}
     */
    function (row) {
        var _this = this;
        /** @type {?} */
        var rightTrs = [];
        /** @type {?} */
        var leftTrs = [];
        if (this.fixedRightEl) {
            rightTrs = this.fixedRightEl.nativeElement.querySelectorAll('tr');
        }
        if (this.fixedLeftEl) {
            leftTrs = this.fixedLeftEl.nativeElement.querySelectorAll('.fixed-left-row');
        }
        /** @type {?} */
        var trs = this.mainArea.nativeElement.querySelectorAll('tr.f-datagrid-body-row');
        /** @type {?} */
        var updateCellStyle = (/**
         * @param {?} arr
         * @param {?} col
         * @param {?} style
         * @return {?}
         */
        function (arr, col, style) {
            if (arr.length) {
                /** @type {?} */
                var td = arr[row.index].querySelector("[field=\"" + col.field + "\"]");
                if (td) {
                    _this.dg.renderCustomStyle(style, td);
                }
            }
        });
        this.dg.flatColumns.forEach((/**
         * @param {?} col
         * @return {?}
         */
        function (col) {
            if (col.styler) {
                /** @type {?} */
                var _rd = row.data;
                /** @type {?} */
                var val = Utils.getValue(col.field, _rd);
                /** @type {?} */
                var cs = col.styler(val, _rd, row.index);
                if (cs && Object.keys(cs).length) {
                    updateCellStyle(leftTrs, col, cs);
                    updateCellStyle(rightTrs, col, cs);
                    updateCellStyle(trs, col, cs);
                }
            }
        }));
    };
    /**
     * @private
     * @return {?}
     */
    DatagridBodyComponent.prototype.checkedRowsChanged = /**
     * @private
     * @return {?}
     */
    function () {
        this.dgs.onCheckedRowsCountChange();
        /** @type {?} */
        var checkedRows = this.dg.checkeds;
        this.dg.checkValues = checkedRows.map((/**
         * @param {?} r
         * @return {?}
         */
        function (r) { return r.id; }));
        this.dg.checkValuesChange.emit(this.dg.checkValues);
        this.dg.checkedChange.emit(checkedRows);
    };
    /**
     * @private
     * @return {?}
     */
    DatagridBodyComponent.prototype.getTrDomHeight = /**
     * @private
     * @return {?}
     */
    function () {
        var _this = this;
        /** @type {?} */
        var list = [];
        /** @type {?} */
        var rightTrs = [];
        /** @type {?} */
        var leftTrs = [];
        /** @type {?} */
        var trdoms = [];
        if (this.fixedRightEl) {
            rightTrs = this.fixedRightEl.nativeElement.querySelectorAll('tr');
        }
        if (this.fixedLeftEl) {
            leftTrs = this.fixedLeftEl.nativeElement.querySelectorAll('.fixed-left-row');
        }
        if (this.mainArea) {
            trdoms = this.mainArea.nativeElement.querySelectorAll('tr.f-datagrid-body-row');
        }
        trdoms.forEach((/**
         * @param {?} tr
         * @param {?} i
         * @return {?}
         */
        function (tr, i) {
            /** @type {?} */
            var t1 = 0;
            /** @type {?} */
            var t2 = Math.ceil(tr.offsetHeight);
            /** @type {?} */
            var t3 = 0;
            if (leftTrs && leftTrs.length) {
                t1 = Math.ceil(leftTrs[i].offsetHeight);
            }
            if (rightTrs && rightTrs.length) {
                t3 = Math.ceil(rightTrs[i].offsetHeight);
            }
            /** @type {?} */
            var _h = Math.max(t1, t2, t3, _this.dg.rowHeight);
            list.push(_h);
        }));
        return list;
    };
    /**
     * @return {?}
     */
    DatagridBodyComponent.prototype.updateRowHeight2 = /**
     * @return {?}
     */
    function () {
        var _this = this;
        /** @type {?} */
        var rightTrs = [];
        /** @type {?} */
        var leftTrs = [];
        /** @type {?} */
        var trdoms = [];
        if (this.fixedRightEl) {
            rightTrs = this.fixedRightEl.nativeElement.querySelectorAll('tr');
        }
        if (this.fixedLeftEl) {
            leftTrs = this.fixedLeftEl.nativeElement.querySelectorAll('.fixed-left-row');
        }
        if (this.mainArea) {
            trdoms = this.mainArea.nativeElement.querySelectorAll('tr.f-datagrid-body-row');
        }
        trdoms.forEach((/**
         * @param {?} tr
         * @param {?} i
         * @return {?}
         */
        function (tr, i) {
            _this.removeRowHeightCls(tr);
            if (leftTrs && leftTrs[i]) {
                _this.removeRowHeightCls(leftTrs[i]);
            }
            if (rightTrs && rightTrs[i]) {
                _this.removeRowHeightCls(rightTrs[i]);
            }
        }));
        if (this['UPDATE_ROW_HEIGHT_TIMER']) {
            clearTimeout(this['UPDATE_ROW_HEIGHT_TIMER']);
        }
        this['UPDATE_ROW_HEIGHT_TIMER'] = setTimeout((/**
         * @return {?}
         */
        function () {
            trdoms.forEach((/**
             * @param {?} tr
             * @param {?} i
             * @return {?}
             */
            function (tr, i) {
                /** @type {?} */
                var t1 = 0;
                /** @type {?} */
                var t2 = Math.ceil(tr.offsetHeight);
                /** @type {?} */
                var t3 = 0;
                /** @type {?} */
                var leftTr = null;
                /** @type {?} */
                var rightTr = null;
                if (leftTrs && leftTrs.length) {
                    t1 = Math.ceil(leftTrs[i].offsetHeight);
                    leftTr = leftTrs[i];
                }
                if (rightTrs && rightTrs.length) {
                    t3 = Math.ceil(rightTrs[i].offsetHeight);
                    rightTr = rightTrs[i];
                }
                /** @type {?} */
                var _h = Math.max(t1, t2, t3, _this.dg.rowHeight);
                if (!_this.dg.nowrap || _this.dg.autoHeight) {
                    /** @type {?} */
                    var heightClsName_1 = WORDWRAP_ROW_HEIGHT_CLS + '_' + _h;
                    /** @type {?} */
                    var minRowHeightClsName_1 = 'min_row_height_' + _this.rowHeight;
                    /** @type {?} */
                    var _addRowHeightClsToDom = (/**
                     * @param {?} trdom
                     * @return {?}
                     */
                    function (trdom) {
                        _this.removeRowHeightCls(trdom);
                        _this.render.addClass(trdom, heightClsName_1);
                        _this.render.addClass(trdom, minRowHeightClsName_1);
                    });
                    _this.addRowHeightCls(heightClsName_1, _h);
                    _addRowHeightClsToDom(tr);
                    if (leftTr) {
                        _addRowHeightClsToDom(leftTr);
                    }
                    if (rightTr) {
                        _addRowHeightClsToDom(rightTr);
                    }
                }
            }));
        }), 100);
    };
    /**
     * @private
     * @param {?} tr
     * @return {?}
     */
    DatagridBodyComponent.prototype.removeRowHeightCls = /**
     * @private
     * @param {?} tr
     * @return {?}
     */
    function (tr) {
        if (!tr) {
            return;
        }
        /** @type {?} */
        var _cls = Array.from(tr.classList).find((/**
         * @param {?} n
         * @return {?}
         */
        function (n) { return n.indexOf(WORDWRAP_ROW_HEIGHT_CLS) > -1; }));
        if (_cls) {
            tr.classList.remove(_cls);
        }
    };
    /**
     * @private
     * @param {?} heightClsName
     * @param {?} _h
     * @return {?}
     */
    DatagridBodyComponent.prototype.addRowHeightCls = /**
     * @private
     * @param {?} heightClsName
     * @param {?} _h
     * @return {?}
     */
    function (heightClsName, _h) {
        this.dgs.removeCssRule(this.dg.customStyleKey() + " ." + heightClsName);
        this.dg.renderCustomStyle2({ style: { height: _h + 'px!important' } }, null, heightClsName);
    };
    /** 允许数据折行时，计算行号的行高 */
    /**
     * 允许数据折行时，计算行号的行高
     * @param {?=} trDomId
     * @return {?}
     */
    DatagridBodyComponent.prototype.updateRowHeight = /**
     * 允许数据折行时，计算行号的行高
     * @param {?=} trDomId
     * @return {?}
     */
    function (trDomId) {
        if (trDomId === void 0) { trDomId = null; }
        if (this.fast) {
            return;
        }
        if (!this.mainArea) {
            return;
        }
        /** @type {?} */
        var dgBody = this.el.nativeElement.querySelector('div.f-datagrid-body');
        if (dgBody) {
            if (!this.dg.nowrap || this.dg.autoHeight) {
                this.render.addClass(dgBody, 'data-wrap');
            }
            else {
                this.render.removeClass(dgBody, 'data-wrap');
            }
        }
        if (!trDomId) {
            this.updateRowHeight2();
        }
        else {
            /** @type {?} */
            var tr = Utils.getTrDomById(trDomId, document);
            if (!tr) {
                return;
            }
            /** @type {?} */
            var leftTrId = trDomId + '_fixedleft';
            /** @type {?} */
            var rightTrId = trDomId + '_fixedright';
            /** @type {?} */
            var leftTr = Utils.getTrDomById(leftTrId, document);
            /** @type {?} */
            var rightTr = Utils.getTrDomById(rightTrId, document);
            this.removeRowHeightCls(tr);
            this.removeRowHeightCls(leftTr);
            this.removeRowHeightCls(rightTr);
            /** @type {?} */
            var _arr = [];
            if (this.fixedRightEl) {
                /** @type {?} */
                var rtr = Utils.getTrDomById(trDomId, this.fixedRightEl.nativeElement);
                if (rtr) {
                    _arr.push(Math.ceil(rtr.offsetHeight));
                }
            }
            if (this.fixedLeftEl) {
                /** @type {?} */
                var ltr = Utils.getTrDomById(trDomId, this.fixedLeftEl.nativeElement);
                if (ltr) {
                    _arr.push(Math.ceil(ltr.offsetHeight));
                }
            }
            if (this.mainArea) {
                /** @type {?} */
                var tr_1 = Utils.getTrDomById(trDomId, this.mainArea.nativeElement);
                if (tr_1) {
                    _arr.push(Math.ceil(tr_1.offsetHeight));
                }
            }
            /** @type {?} */
            var _h = Math.max.apply(Math, tslib_1.__spread(_arr));
            /** @type {?} */
            var heightClsName = WORDWRAP_ROW_HEIGHT_CLS + '_' + _h;
            if (!this.dg.nowrap || this.dg.autoHeight) {
                this.render.addClass(tr, heightClsName);
                this.addRowHeightCls(heightClsName, _h);
                if (leftTr) {
                    this.render.addClass(leftTr, heightClsName);
                }
                if (rightTr) {
                    this.render.addClass(rightTr, heightClsName);
                }
            }
        }
        this.updateCanvasHeight();
        // 移除height: auto
        /** @type {?} */
        var trdoms = this.dg.dgContainer.nativeElement.querySelectorAll('.f-datagrid-body-row:not(f-datagrid-footer-row)');
        trdoms.forEach((/**
         * @param {?} n
         * @return {?}
         */
        function (n) { return n.style.height = ''; }));
        if (!this.cd['destroyed']) {
            this.cd.detectChanges();
        }
    };
    /**
     * @private
     * @return {?}
     */
    DatagridBodyComponent.prototype.getBodyStyle = /**
     * @private
     * @return {?}
     */
    function () {
        /** @type {?} */
        var h = this.getViewPortHeight();
        if (!this.data.length) {
            if (this.dg.useBlankWhenDataIsEmpty) {
                h = this.dg.emptyDataHeight;
            }
            else {
                if (this.dg.autoHeight) {
                    h = this.dg.emptyDataHeight;
                }
                if (this.dg.footerData && this.dg.showFooter) {
                    /** @type {?} */
                    var fd = this.dg.footerData;
                    if (this.dg.footerData.subscribe) {
                        fd = this.dg.footerData['value'];
                    }
                    if (fd && Array.isArray(fd) && fd.length) {
                        h = h - this.dg.footerHeight;
                        if (this.dg.footerPosition === 'both') {
                            h = h - this.dg.footerHeight;
                        }
                    }
                }
            }
        }
        else {
            if (this.dg.showFooter && this.dg.footerPosition === 'both') {
                h = h - this.dg.footerHeight;
            }
        }
        return {
            height: Math.floor(h) + 1 + "px"
        };
    };
    /**
     * @private
     * @param {?} scrollLeft
     * @return {?}
     */
    DatagridBodyComponent.prototype.updateScrollPosition = /**
     * @private
     * @param {?} scrollLeft
     * @return {?}
     */
    function (scrollLeft) {
        this.scrollLeft = scrollLeft;
        this.fixedRightScrollLeft = this.scrollLeft + this.width - this.rightFixedWidth;
        if (this.fixedRightScrollLeft === this.maxScrollLeft || this.fixedRightScrollLeft > this.maxScrollLeft) {
            this.fixedRightScrollLeft = this.maxScrollLeft;
            this.showRightShadow = false;
        }
        else {
            this.showRightShadow = true;
        }
        if (this.fixedLeftEl) {
            this.render.setStyle(this.fixedLeftEl.nativeElement, 'transform', "translate3d(" + this.scrollLeft + "px, 0px, 0px)");
        }
        if (this.fixedRightEl) {
            /** @type {?} */
            var l = this.dg.width - (this.dg.showBorder ? 2 : 0) - this.columnsGroup.rightFixedWidth;
            if (this.ps && this.ps.instance && this.ps.instance.scrollbarYActive && this.dg.scrollBarShowMode === 'allways') {
                l -= 18;
            }
            /** @type {?} */
            var realWidth = this.columnsGroup.leftFixedWidth + this.columnsGroup.normalWidth + this.columnsGroup.rightFixedWidth;
            if (this.dg.width - (this.dg.showBorder ? 2 : 0) > realWidth) {
                l = this.columnsGroup.leftFixedWidth + this.columnsGroup.normalWidth;
            }
            l += this.scrollLeft;
            this.fixedRightScrollLeft = l;
            this.render.setStyle(this.fixedRightEl.nativeElement, 'transform', "translate3d(" + this.fixedRightScrollLeft + "px, 0px, 0px)");
        }
    };
    /**
     * @param {?} $event
     * @return {?}
     */
    DatagridBodyComponent.prototype.onScrollToX = /**
     * @param {?} $event
     * @return {?}
     */
    function ($event) {
        /** @type {?} */
        var x = $event.target.scrollLeft;
        this.updateScrollPosition(x);
        // this.cd.detectChanges();
        this.dgs.onScrollMove(x, SCROLL_X_ACTION);
        this.dfs.updateProperty('scrollInfo', { y: $event.target.scrollTop, x: x });
        this.dgs.showFixedShadow.emit({ showRightShadow: this.showRightShadow, x: this.fixedRightScrollLeft });
    };
    /**
     * @param {?} $event
     * @return {?}
     */
    DatagridBodyComponent.prototype.onScrollToY = /**
     * @param {?} $event
     * @return {?}
     */
    function ($event) {
        var _this = this;
        if (this._scrollTimer) {
            clearTimeout(this._scrollTimer);
        }
        this._scrollTimer = setTimeout((/**
         * @return {?}
         */
        function () {
            /** @type {?} */
            var y = $event.target.scrollTop;
            if (_this.dg.virtualized) {
                _this.handleScroll();
            }
            _this.scrollTop = y;
            _this.dfs.updateProperty('scrollInfo', { y: y, x: $event.target.scrollLeft });
            _this.dg.scrollY.emit(y);
            _this.dgs.onScrollMove(y, SCROLL_Y_ACTION);
        }), 100);
    };
    /**
     * @param {?} $event
     * @return {?}
     */
    DatagridBodyComponent.prototype.onPsXReachStart = /**
     * @param {?} $event
     * @return {?}
     */
    function ($event) {
        /** @type {?} */
        var x = $event.target.scrollLeft;
        this.updateScrollPosition(x);
        this.dgs.onScrollMove(x, SCROLL_X_REACH_START_ACTION);
    };
    /**
     * @param {?} $event
     * @return {?}
     */
    DatagridBodyComponent.prototype.onPsXReachEnd = /**
     * @param {?} $event
     * @return {?}
     */
    function ($event) {
        this.showRightShadow = false;
        // const x = $event.target.scrollLeft;
        // this.updateScrollPosition(x);
        // this.cd.detectChanges();
        // // this.dgs.onShowFixedShadow(this.showRightShadow);
        // this.dgs.onScrollMove(x, SCROLL_X_REACH_END_ACTION);
    };
    /**
     * @param {?} rowData
     * @return {?}
     */
    DatagridBodyComponent.prototype.isChecked = /**
     * @param {?} rowData
     * @return {?}
     */
    function (rowData) {
        if (rowData) {
            return this.dfs.isRowChecked(rowData[this.dg.idField]);
        }
        else {
            return false;
        }
    };
    /**
     * @param {?} rowData
     * @return {?}
     */
    DatagridBodyComponent.prototype.isSelected = /**
     * @param {?} rowData
     * @return {?}
     */
    function (rowData) {
        if (rowData) {
            return this.dfs.isRowSelected(rowData[this.dg.idField]);
        }
        return false;
    };
    /**
     * @param {?} row
     * @param {?=} open
     * @return {?}
     */
    DatagridBodyComponent.prototype.toggleGroupRow = /**
     * @param {?} row
     * @param {?=} open
     * @return {?}
     */
    function (row, open) {
        if (open === void 0) { open = true; }
        row.expanded = open;
        this.ps.update();
    };
    /** =================================== 分 ====== 隔 ====== 线 =================================== */
    /** 获取可视区域高度 */
    /** =================================== 分 ====== 隔 ====== 线 =================================== */
    /**
     * 获取可视区域高度
     * @return {?}
     */
    DatagridBodyComponent.prototype.getViewPortHeight = /** =================================== 分 ====== 隔 ====== 线 =================================== */
    /**
     * 获取可视区域高度
     * @return {?}
     */
    function () {
        /** @type {?} */
        var viewPortHeight = this.dg.height;
        if (this.dg.showHeader) {
            viewPortHeight = viewPortHeight - this.dg.realHeaderHeight;
        }
        if ((this.dg.enableFilterRow || this.dg.enableSmartFilter) && this.dg.showFilterBar) {
            viewPortHeight -= this.dg.filterBarHeight;
        }
        if (this.dg.showRowGroupPanel) {
            viewPortHeight -= this.dg.rowGroupPanelHeight;
        }
        if (this.dg.showFooter && this.data.length) {
            viewPortHeight = viewPortHeight - this.dg.footerHeight;
        }
        if (this.dg.pagination) {
            viewPortHeight = viewPortHeight - this.dg.pagerHeight - 2;
        }
        if (this.dg.showBorder) {
            viewPortHeight -= 2;
        }
        this.viewportH = viewPortHeight;
        return viewPortHeight;
    };
    // 不折行时，所有数据的高度
    // 不折行时，所有数据的高度
    /**
     * @private
     * @return {?}
     */
    DatagridBodyComponent.prototype.allRowsHeight = 
    // 不折行时，所有数据的高度
    /**
     * @private
     * @return {?}
     */
    function () {
        /** @type {?} */
        var rowHeightpatch = 1;
        // this.dg.autoHeight ? 2 : 1;
        /** @type {?} */
        var rowHeight = this.dg.rowHeight + rowHeightpatch;
        /** @type {?} */
        var itemsCount = 0;
        if (this.dg.groupRows) {
            /** @type {?} */
            var data = this.data.filter((/**
             * @param {?} n
             * @return {?}
             */
            function (n) { return n['__group_visible__'] || n['__group_visible__'] === undefined; }));
            if (this.dg.groupSummaryPosition === 'inGroupRow') {
                itemsCount = data.filter((/**
                 * @param {?} n
                 * @return {?}
                 */
                function (n) { return !n['__group_footer__']; })).length;
            }
            else {
                itemsCount = data.length;
            }
        }
        else {
            itemsCount = this.data.length;
        }
        /** @type {?} */
        var h = itemsCount * rowHeight;
        if (this.dg.autoHeight) {
            h += itemsCount;
        }
        else {
            h += 2;
        }
        return h;
    };
    /**
     * @private
     * @return {?}
     */
    DatagridBodyComponent.prototype.getCanvasHeight = /**
     * @private
     * @return {?}
     */
    function () {
        /** @type {?} */
        var canvasHeight = 0;
        if (!this.data || !this.data.length) {
            this.canvasHeight = 0;
            return 0;
        }
        if (this.dg.nowrap) {
            // tfs 572022
            if (this.dg.maxHeight && this.dg.autoHeight && this.mainArea) {
                canvasHeight = Math.floor(this.mainArea.nativeElement.getBoundingClientRect().height);
            }
            else {
                canvasHeight = this.allRowsHeight();
            }
        }
        else {
            canvasHeight = this.getTrDomHeight().reduce((/**
             * @param {?} r
             * @param {?} c
             * @return {?}
             */
            function (r, c) { return r + c; }), 0);
        }
        if (!canvasHeight) {
            canvasHeight = this.viewportH;
        }
        canvasHeight = canvasHeight + (this.dg.scrollBarShowMode === 'allways' && (this.ps.instance && this.ps.instance['scrollbarXActive']) ? 18 : 0);
        this.canvasHeight = canvasHeight;
        return canvasHeight;
    };
    /**
     * @return {?}
     */
    DatagridBodyComponent.prototype.updateCanvasHeight = /**
     * @return {?}
     */
    function () {
        this.canvasHeight = this.getCanvasHeight();
    };
    /**
     * @private
     * @param {?} y
     * @return {?}
     */
    DatagridBodyComponent.prototype.getRowFromPosition = /**
     * @private
     * @param {?} y
     * @return {?}
     */
    function (y) {
        return Math.floor(y / (this.dg.rowHeight + 1));
    };
    /**
     * @param {?=} viewportTop
     * @param {?=} viewportLeft
     * @return {?}
     */
    DatagridBodyComponent.prototype.getVisibleRange = /**
     * @param {?=} viewportTop
     * @param {?=} viewportLeft
     * @return {?}
     */
    function (viewportTop, viewportLeft) {
        if (viewportTop == null) {
            viewportTop = this.scrollTop;
        }
        if (viewportLeft == null) {
            viewportLeft = this.scrollLeft;
        }
        return {
            top: this.getRowFromPosition(viewportTop),
            bottom: this.getRowFromPosition(viewportTop + this.viewportH) + 1,
            leftPx: viewportLeft,
            rightPx: viewportLeft + this.viewportW
        };
    };
    /**
     * @private
     * @param {?=} viewportTop
     * @param {?=} viewportLeft
     * @return {?}
     */
    DatagridBodyComponent.prototype.getRenderedRange = /**
     * @private
     * @param {?=} viewportTop
     * @param {?=} viewportLeft
     * @return {?}
     */
    function (viewportTop, viewportLeft) {
        /** @type {?} */
        var range = this.getVisibleRange(viewportTop, viewportLeft);
        /** @type {?} */
        var buffer = Math.round(this.viewportH / (this.dg.rowHeight + 1));
        /** @type {?} */
        var minBuffer = this.minRowBuffer;
        if (this.vScrollDir == -1) {
            range.top -= buffer;
            range.bottom += minBuffer;
        }
        else if (this.vScrollDir == 1) {
            range.top -= minBuffer;
            range.bottom += buffer;
        }
        else {
            range.top -= minBuffer;
            range.bottom += minBuffer;
        }
        range.top = Math.max(0, range.top);
        range.bottom = Math.min(this.data.length - 1, range.bottom);
        range.leftPx -= this.viewportW;
        range.rightPx += this.viewportW;
        range.leftPx = Math.max(0, range.leftPx);
        range.rightPx = Math.min(this.canvasWidth, range.rightPx);
        return range;
    };
    /**
     * @private
     * @param {?} range
     * @return {?}
     */
    DatagridBodyComponent.prototype.renderRows = /**
     * @private
     * @param {?} range
     * @return {?}
     */
    function (range) {
        var _this = this;
        /** @type {?} */
        var rows = [];
        /** @type {?} */
        var dataLength = this.data.length;
        /** @type {?} */
        var _data = this.data;
        // 启用分组
        if (this.dg.groupRows && this.dg.groupField) {
            _data = _data.filter((/**
             * @param {?} n
             * @return {?}
             */
            function (n) { return n['__group_visible__'] || n['__group_visible__'] === undefined; }));
            if (this.dg.groupSummaryPosition === 'inGroupRow') {
                _data = _data.filter((/**
                 * @param {?} n
                 * @return {?}
                 */
                function (n) { return !n['__group_footer__']; }));
            }
            dataLength = _data.length;
            this.rowsCache = {};
        }
        for (var i = range.top; i <= range.bottom; i++) {
            if (this.rowsCache[i] || (i == dataLength)) {
                continue;
            }
            rows.push(i);
            // Create an entry right away so that appendRowHtml() can
            // start populatating it.
            this.rowsCache[i] = {
                rowNode: null,
                // ColSpans of rendered cells (by column idx).
                // Can also be used for checking whether a cell has been rendered.
                cellColSpans: [],
                // Cell nodes (by column idx).  Lazy-populated by ensureCellNodesInRowsCache().
                cellNodesByColumnIdx: [],
                // Column indices of cell nodes that have been rendered, but not yet indexed in
                // cellNodesByColumnIdx.  These are in the same order as cell nodes added at the
                // end of the row.
                cellRenderQueue: []
            };
        }
        for (var i = 0, ii = rows.length; i < ii; i++) {
            this.rowsCache[rows[i]].rowNode = _data[rows[i]];
        }
        return Object.keys(this.rowsCache).map((/**
         * @param {?} n
         * @return {?}
         */
        function (n) { return _this.rowsCache[n].rowNode; })).filter((/**
         * @param {?} n
         * @return {?}
         */
        function (n) { return n; }));
    };
    /**
     * @private
     * @param {?} row
     * @return {?}
     */
    DatagridBodyComponent.prototype.removeRowFromCache = /**
     * @private
     * @param {?} row
     * @return {?}
     */
    function (row) {
        /** @type {?} */
        var cacheEntry = this.rowsCache[row];
        if (!cacheEntry) {
            return;
        }
        delete this.rowsCache[row];
    };
    /**
     * @private
     * @param {?} rangeToKeep
     * @return {?}
     */
    DatagridBodyComponent.prototype.cleanupRows = /**
     * @private
     * @param {?} rangeToKeep
     * @return {?}
     */
    function (rangeToKeep) {
        for (var i in this.rowsCache) {
            if (i < rangeToKeep.top || i > rangeToKeep.bottom) {
                this.removeRowFromCache(i);
            }
        }
    };
    /**
     * @param {?=} showYscrollbar
     * @return {?}
     */
    DatagridBodyComponent.prototype.hasYScrollbar = /**
     * @param {?=} showYscrollbar
     * @return {?}
     */
    function (showYscrollbar) {
        var _this = this;
        setTimeout((/**
         * @return {?}
         */
        function () {
            showYscrollbar = showYscrollbar == undefined ? _this.ps.instance.scrollbarYActive : showYscrollbar;
            /** @type {?} */
            var hasY = showYscrollbar && _this.dg.scrollBarShowMode === 'allways' ? 18 : 0;
            _this.dfs.updateProperty('scrollbarY', hasY);
            _this.dfs.resize();
        }), 60);
    };
    /**
     * @param {?} $event
     * @return {?}
     */
    DatagridBodyComponent.prototype.onClickScrollArrow = /**
     * @param {?} $event
     * @return {?}
     */
    function ($event) {
        var dir = $event.dir, event = $event.event;
        if (this.ps && this.ps.instance) {
            var _a = this.ps.instance.reach, x = _a.x, y = _a.y;
            switch (dir) {
                case 'left':
                    if (x !== 'start') {
                        this.viewScrollContainer.nativeElement.scrollLeft = this.viewScrollContainer.nativeElement.scrollLeft - 40;
                    }
                    break;
                case 'right':
                    if (x !== 'end') {
                        this.viewScrollContainer.nativeElement.scrollLeft = this.viewScrollContainer.nativeElement.scrollLeft + 40;
                    }
                    break;
                case 'top':
                    if (y !== 'start') {
                        this.viewScrollContainer.nativeElement.scrollTop = this.viewScrollContainer.nativeElement.scrollTop - 40;
                    }
                    break;
                case 'bottom':
                    if (y !== 'end') {
                        this.viewScrollContainer.nativeElement.scrollTop = this.viewScrollContainer.nativeElement.scrollTop + 40;
                    }
                    break;
            }
            this.ps.update();
        }
    };
    /**
     * @private
     * @param {?=} detectchanges
     * @return {?}
     */
    DatagridBodyComponent.prototype.renderData = /**
     * @private
     * @param {?=} detectchanges
     * @return {?}
     */
    function (detectchanges) {
        if (detectchanges === void 0) { detectchanges = true; }
        this.canvasHeight = this.getCanvasHeight();
        if (!this.dg.virtualized || this.dg.autoHeight) {
            this.rows = this.data;
        }
        else {
            /** @type {?} */
            var visible = this.getVisibleRange();
            /** @type {?} */
            var rendered = this.getRenderedRange();
            // remove rows no longer in the viewport
            this.cleanupRows(rendered);
            // render missing rows
            this.rows = this.renderRows(rendered);
            this.startRowIndex = rendered.top;
            this.lastRenderedScrollTop = this.scrollTop;
            this.lastRenderedScrollLeft = this.scrollLeft;
            this.blankTopHeight = this.startRowIndex * (this.dg.rowHeight + 1);
            this.blankBottomHeight = this.canvasHeight - this.blankTopHeight - (this.rows.length * (this.dg.rowHeight + 1));
            if (this.dg.scrollBarShowMode === 'allways' && this.ps && this.ps.instance && this.ps.instance.scrollbarXActive) {
                this.blankBottomHeight += 22;
            }
            if (detectchanges) {
                this.cd.detectChanges();
            }
        }
    };
    /**
     * @private
     * @return {?}
     */
    DatagridBodyComponent.prototype.handleScroll = /**
     * @private
     * @return {?}
     */
    function () {
        this.scrollTop = this.ps.elementRef.nativeElement.scrollTop;
        this.scrollLeft = this.ps.elementRef.nativeElement.scrollLeft;
        return this._handleScroll();
    };
    /**
     * @private
     * @return {?}
     */
    DatagridBodyComponent.prototype._handleScroll = /**
     * @private
     * @return {?}
     */
    function () {
        /** @type {?} */
        var viewportContainer = this.viewScrollContainer.nativeElement;
        /** @type {?} */
        var maxScrollDistanceY = viewportContainer.scrollHeight - viewportContainer.clientHeight;
        /** @type {?} */
        var maxScrollDistanceX = viewportContainer.scrollWidth - viewportContainer.clientWidth;
        // Protect against erroneous clientHeight/Width greater than scrollHeight/Width.
        // Sometimes seen in Chrome.
        maxScrollDistanceY = Math.max(0, maxScrollDistanceY);
        maxScrollDistanceX = Math.max(0, maxScrollDistanceX);
        // Ceiling the max scroll values
        if (this.scrollTop > maxScrollDistanceY) {
            this.scrollTop = maxScrollDistanceY;
        }
        if (this.scrollLeft > maxScrollDistanceX) {
            this.scrollLeft = maxScrollDistanceX;
        }
        /** @type {?} */
        var vScrollDist = Math.abs(this.scrollTop - this.prevScrollTop);
        /** @type {?} */
        var hScrollDist = Math.abs(this.scrollLeft - this.prevScrollLeft);
        if (hScrollDist) {
            this.prevScrollLeft = this.scrollLeft;
            // $viewportScrollContainerX[0].scrollLeft = scrollLeft;
            // if (hasFrozenColumns()) {
            //     if (hasFrozenRows) {
            //         $viewportTopR[0].scrollLeft = scrollLeft;
            //     }
            // } else {
            //     if (hasFrozenRows) {
            //         $viewportTopL[0].scrollLeft = scrollLeft;
            //     }
            // }
        }
        /** @type {?} */
        var lastScrollTop = this.lastRenderedScrollTop;
        if (vScrollDist) {
            this.vScrollDir = this.prevScrollTop < this.scrollTop ? 1 : -1;
            this.prevScrollTop = this.scrollTop;
            // if (hasFrozenColumns()) {
            //     if (hasFrozenRows && !options.frozenBottom) {
            //         $viewportBottomL[0].scrollTop = scrollTop;
            //     } else {
            //         $viewportTopL[0].scrollTop = scrollTop;
            //     }
            // }
            // switch virtual pages if needed
            if (vScrollDist < this.viewportH) {
                this._scrollTo(this.scrollTop);
            }
        }
        if (hScrollDist || vScrollDist) {
            /** @type {?} */
            var dx = Math.abs(this.lastRenderedScrollLeft - this.scrollLeft);
            /** @type {?} */
            var dy = Math.abs(lastScrollTop - this.scrollTop);
            if (dx > 20 || dy > 20) {
                // if rendering is forced or scrolling is small enough to be "easy", just render
                if (dy < this.viewportH && dx < this.viewportW) {
                    this.renderData();
                }
                else {
                    this.renderData();
                }
            }
        }
        if (hScrollDist || vScrollDist) {
            return true;
        }
        return false;
    };
    /**
     * @private
     * @param {?} y
     * @return {?}
     */
    DatagridBodyComponent.prototype._scrollTo = /**
     * @private
     * @param {?} y
     * @return {?}
     */
    function (y) {
        /** @type {?} */
        var $viewportScrollContainerY = this.viewScrollContainer.nativeElement;
        y = Math.max(y, 0);
        y = Math.min(y, this.canvasHeight - this.viewportH);
        /** @type {?} */
        var newScrollTop = y;
        if (this.prevScrollTop != newScrollTop) {
            this.vScrollDir = (this.prevScrollTop < newScrollTop) ? 1 : -1;
            this.lastRenderedScrollTop = (this.scrollTop = this.prevScrollTop = newScrollTop);
            // if (hasFrozenColumns()) {
            //     $viewportTopL[0].scrollTop = newScrollTop;
            // }
            // if (hasFrozenRows) {
            //     $viewportBottomL[0].scrollTop = $viewportBottomR[0].scrollTop = newScrollTop;
            // }
            // $viewportScrollContainerY.scrollTop = newScrollTop;
        }
    };
    /**
     * @param {?} $event
     * @return {?}
     */
    DatagridBodyComponent.prototype.onMouseClick = /**
     * @param {?} $event
     * @return {?}
     */
    function ($event) {
        var _this = this;
        // document.body.click();
        /** @type {?} */
        var target = (/** @type {?} */ ($event.target));
        if (target.nodeName === 'TEXTAREA' || target.nodeName === 'INPUT') {
            return;
        }
        /** @type {?} */
        var td = target;
        if (target.nodeName !== 'TD') {
            td = target.closest('TD');
        }
        if (!td) {
            if (this.dg.isEditing() && (this.dg.exitRowEditingWhenBodyClick || this.dg.editMode == 'cell')) {
                this.dg.endEditing();
            }
            return;
        }
        /** @type {?} */
        var curT = new Date().getTime()
        //上一次时间戳
        ;
        //上一次时间戳
        /** @type {?} */
        var lastT = this['lastTapDiffTime'] || 0;
        //对上一次时间戳重新赋值
        this['lastTapDiffTime'] = curT;
        //做差
        /** @type {?} */
        var diff = curT - lastT;
        /** @type {?} */
        var isClickSameRow = (/**
         * @return {?}
         */
        function () {
            if (_this._clickCellWeakMap.has(_this.el.nativeElement) && td && td.parentElement === _this._clickCellWeakMap.get(_this.el.nativeElement)) {
                _this._clickCellWeakMap.delete(_this.el.nativeElement);
                return true;
            }
            return false;
        });
        /** @type {?} */
        var runTdClick = (/**
         * @return {?}
         */
        function () {
            if (td && td.selectCell) {
                td.selectCell($event, td);
            }
            else {
                _this._selectRow(td, (/**
                 * @param {?} id
                 * @param {?} rowSelected
                 * @return {?}
                 */
                function (id, rowSelected) {
                    /** @type {?} */
                    var emit = !rowSelected;
                    if (_this.dg.selectionMode === 'default') {
                        _this.dg.clearCheckeds();
                        emit = true;
                    }
                    _this.dg.selectRow(id, emit, false);
                    _this.dg['updateAllCheckboxStatus']();
                }));
            }
        });
        /** @type {?} */
        var runSelectRow = (/**
         * @return {?}
         */
        function () {
            /** @type {?} */
            var dblclickTimer = _this.dg.dblclickRow.observers.length ? 200 : 0;
            if (isClickSameRow()) {
                if (diff < dblclickTimer) {
                    _this.dg.writeConsole('双击');
                    //清除上一次单击的定时器ID
                    clearTimeout(_this['lastTapTimeFunc']);
                }
                else {
                    //定时器id
                    _this['lastTapTimeFunc'] = setTimeout((/**
                     * @return {?}
                     */
                    function () {
                        runTdClick();
                    }), dblclickTimer);
                }
            }
            else {
                _this['lastTapTimeFunc'] = setTimeout((/**
                 * @return {?}
                 */
                function () {
                    runTdClick();
                }), dblclickTimer ? 180 : 0);
            }
            _this._clickCellWeakMap.set(_this.el.nativeElement, td.parentElement);
        });
        if (!this.dg.editable && td) {
            // 解决超链点击事件，要先执行选中行
            $event.stopPropagation();
            runSelectRow();
            return;
        }
        if (this.dg.editMode === 'row') {
            if (this.dg.exitRowEditingWhenBodyClick && this.dg.isEditing()) {
                this.dg.endEditing();
            }
            this._selectRow(td, (/**
             * @param {?} id
             * @param {?} rowSelected
             * @return {?}
             */
            function (id, rowSelected) {
                _this.dg.selectRow(id, !rowSelected, false);
            }));
            return;
        }
        if (!td && this.dg.currentCell) {
            td = this.dg.currentCell.cellElement;
            if (td && td.closeEdit) {
                $event.stopPropagation();
                td.closeEdit();
                return;
            }
        }
        if (td) {
            // 行禁用时
            if (this.dg.disableRow) {
                /** @type {?} */
                var rowData = null;
                /** @type {?} */
                var rowIndex = -1;
                if (td.gridCellData) {
                    rowData = td.gridCellData.rowData;
                    rowIndex = td.gridCellData.rowIndex;
                }
                else {
                    /** @type {?} */
                    var rowInfo = this.dg.getRowIdByTr(td.parentElement);
                    if (rowInfo) {
                        rowData = rowInfo.data;
                        rowIndex = rowInfo.index;
                    }
                }
                if (rowData) {
                    if (this.dg.disableRow(rowData, rowIndex)) {
                        this.dg.endEditing();
                        return;
                    }
                }
                else {
                    this.dg.writeConsole('未获取到行数据。');
                    return;
                }
            }
            $event.stopPropagation();
            if (this.dg.editable && this.dg.editMode === 'cell') {
                if (td.edit) {
                    this._selectRow(td, (/**
                     * @return {?}
                     */
                    function () {
                        td.edit($event);
                    }));
                }
                else {
                    // 允许编辑点击行号时，可以选中行
                    if (td.selectCell || td.className.indexOf('f-datagrid-cell-rownumber') > -1) {
                        runSelectRow();
                    }
                    else {
                        // 当点分组行或合计行时，须结束编辑
                        this.dg.isEditing() && this.dg.endEditing();
                    }
                }
            }
            else {
                if (td.selectCell) {
                    runSelectRow();
                }
                else {
                    if (this.dg.isEditing() && (this.dg.exitRowEditingWhenBodyClick || this.dg.editMode === 'cell')) {
                        this.dg.endEditing();
                    }
                    // this._selectRow(td, (id, rowSelected) => {
                    //     this.dg.selectRow(id, !rowSelected, false);
                    // });
                    runTdClick();
                }
            }
        }
    };
    /**
     * @private
     * @param {?} tdEl
     * @param {?} callback
     * @return {?}
     */
    DatagridBodyComponent.prototype._selectRow = /**
     * @private
     * @param {?} tdEl
     * @param {?} callback
     * @return {?}
     */
    function (tdEl, callback) {
        if (tdEl) {
            /** @type {?} */
            var tr = tdEl.parentElement;
            /** @type {?} */
            var rowInfo = this.dg.getRowIdByTr(tr);
            if (!rowInfo) {
                return;
            }
            var data = rowInfo.data, index = rowInfo.index, id_1 = rowInfo.id;
            /** @type {?} */
            var rowisSelected_1 = this.dfs.isRowSelected(id_1);
            this.dg._beforeSelectRow$(index, data, id_1).pipe(takeUntil(this.destroy$)).subscribe((/**
             * @param {?} t
             * @return {?}
             */
            function (t) {
                if (t) {
                    callback(id_1, rowisSelected_1);
                }
            }));
        }
    };
    DatagridBodyComponent.decorators = [
        { type: Component, args: [{
                    selector: 'datagrid-body',
                    template: "<!--\r\n * @Author: \u75AF\u72C2\u79C0\u624D(Lucas Huang)\r\n * @Date: 2019-08-06 07:43:07\r\n * @LastEditors: \u75AF\u72C2\u79C0\u624D(Lucas Huang)\r\n * @LastEditTime: 2019-11-26 08:20:46\r\n * @QQ: 1055818239\r\n * @Version: v0.0.1\r\n -->\r\n\r\n<ng-container  *ngIf=\"(!data || !data.length) && !dg.useBlankWhenDataIsEmpty\" >\r\n\r\n    <div *ngIf=\"!dg.emptyTemplate && !dg.emptyComponentType\" class=\"d-flex flex-column f-datagrid-norecords\"\r\n        style=\"position:absolute; margin:0;left: 0; z-index: 1;justify-content: center; align-items: center;pointer-events: none;\" \r\n        [ngStyle]=\"bodyStyle\" [style.top.px]=\"top\" [style.width.px]=\"viewportW\" >\r\n        <div class=\"f-datagrid-norecords-content\" style=\"margin: 0;width: 100%;position: relative; top: 0\">\r\n            {{ 'datagrid.emptyMessage' | locale }}\r\n        </div>\r\n    </div>\r\n    <div class=\"f-datagrid-body\" [ngStyle]=\"bodyStyle\" [style.top.px]=\"top\" [style.width.px]=\"viewportW\" style=\"z-index: 1;\"  *ngIf=\"dg.emptyTemplate && !dg.emptyComponentType\">\r\n        <ng-container #emptyTemplate [ngTemplateOutlet]=\"dg.emptyTemplate\" ></ng-container>\r\n    </div>\r\n    <div class=\"f-datagrid-body\" [ngStyle]=\"bodyStyle\" [style.top.px]=\"top\" [style.width.px]=\"viewportW\" style=\"z-index: 1;\"  *ngIf=\"dg.emptyComponentType\"\r\n    component-template [ctx]=\"{ instance: dg }\" [cmpRef]=\"dg.emptyComponentType\">\r\n    </div>\r\n   \r\n</ng-container>\r\n\r\n\r\n\r\n<div class=\"f-datagrid-body\" [ngStyle]=\"bodyStyle\" [style.top.px]=\"top\" [style.width.px]=\"viewportW\" \r\n[farris-context-menus]=\"contextMenuItems\" [disabled]=\"!dg.enableContextMenu\" [activeDomName]=\"'tr'\" [beforeShowContextMenu]=\"onBeforeShowContextMenu\"\r\n[menuClass]=\"'f-datagrid-context-menu'\">\r\n\r\n    <div #viewScrollContainer [scrollbar]=\"psConfig\" #ps=\"ngxScrollbar\"\r\n        class=\"ps f-datagrid-body-wheel-area\" \r\n        style=\"width: 100%;\"\r\n        [ngStyle]=\"bodyStyle\"\r\n        (psXReachEnd)=\"onPsXReachEnd($event)\"\r\n        (psScrollY)=\"onScrollToY($event)\"\r\n        (psScrollX)=\"onScrollToX($event)\" (psXReachStart)=\"onPsXReachStart($event)\"\r\n        [style.paddingRight.px]=\"scrollbarYWidth\">\r\n       \r\n        <div class=\"f-datagrid-norecords\"  [auto-height]=\"dg.autoHeight\" [wheelHeight]=\"dg.emptyDataHeight || 240\" style=\"height: 100%\" [style.width.px]=\"canvasWidth - 2\"  *ngIf=\"!data || !data.length\">\r\n            <!-- <div *ngIf=\"!dg.emptyTemplate\" class=\"f-datagrid-norecords-content\" style=\"width: 100%\" >{{ 'datagrid.emptyMessage' | locale }}</div>\r\n            <ng-container #emptyTemplate *ngIf=\"dg.emptyTemplate\" [ngTemplateOutlet]=\"dg.emptyTemplate\" ></ng-container> -->\r\n        </div>\r\n\r\n        <div [style.display]=\"dg.flatColumns?.length ? '': 'none'\"  *ngIf=\"data && data.length && !fast\"\r\n            class=\"f-datagrid-bg\" [auto-height]=\"dg.autoHeight\" [wheelHeight]=\"canvasHeight\"\r\n            [style.height.px]=\"canvasHeight\" [style.width.px]=\"totalWidth\" >\r\n            \r\n                <div #blankTop hidefocus style=\"width: 100%\" [style.height.px]=\"blankTopHeight\"></div>\r\n                \r\n                <div #fixedLeft class=\"f-datagrid-table f-datagrid-body-fixed-left\" style=\"z-index:999\" [class.f-datagrid-fixed-left-shadow]=\"!!scrollLeft && !dg.groupRows\"\r\n                    *ngIf=\"dg.showLineNumber || dg.showCheckbox || (columnsGroup?.leftFixed && columnsGroup?.leftFixed.length)\"  [style.width.px]=\"leftFixedWidth\" \r\n                    [style.transform]=\"'translate3d('+ scrollLeft +'px, 0px, 0px)'\">\r\n\r\n                    <fixed-left-rows [columns]=\"columnsGroup?.leftFixed\" [checkedRows]=\"checkedRows\" [selectedRows]=\"selectedRows\" [data]=\"rows\"></fixed-left-rows>\r\n                </div>\r\n\r\n                <div #fixedRight class=\"f-datagrid-table f-datagrid-body-fixed-right\" \r\n                    *ngIf=\"columnsGroup?.rightFixed && columnsGroup?.rightFixed.length\"\r\n                    [class.f-datagrid-fixed-right-shadow]=\"showRightShadow\" \r\n                    style=\"border: 0\" [style.width.px]=\"rightFixedWidth\" \r\n                    [style.transform]=\"'translate3d('+ fixedRightScrollLeft +'px, 0px, 0px)'\">\r\n                    \r\n                    <datagrid-rows #rightRows [fixedRight]=\"true\" [startRowIndex]=\"startRowIndex\" \r\n                    [width]=\"columnsGroup?.rightFixedWidth\"\r\n                    [columns]=\"columnsGroup?.rightFixed\" [data]=\"rows\"></datagrid-rows>\r\n                </div>\r\n\r\n                <div #main [style.width.px]=\"colsWidth\" style=\"position: relative;\" [style.left.px]=\"leftFixedWidth\" class=\"f-datagrid-table f-datagrid-body-center\">\r\n                    <datagrid-rows #mainRows [hasFixedColumns]=\"columnsGroup?.leftFixed && columnsGroup?.leftFixed?.length\" [startRowIndex]=\"startRowIndex\" [columns]=\"columnsGroup?.normalColumns\" [data]=\"rows\"></datagrid-rows>\r\n                </div>\r\n\r\n                <div hidefocus style=\"width: 100%\" [style.height.px]=\"blankBottomHeight\"></div>\r\n\r\n        </div>\r\n\r\n\r\n        <div [style.display]=\"dg.flatColumns?.length ? '': 'none'\"  *ngIf=\"data && data.length && fast\"\r\n        class=\"f-datagrid-bg\" [auto-height]=\"dg.autoHeight\" [wheelHeight]=\"canvasHeight\"\r\n        [style.height.px]=\"canvasHeight\" [style.width.px]=\"totalWidth\" >\r\n        \r\n                <div #blankTop hidefocus style=\"width: 100%\" [style.height.px]=\"blankTopHeight\"></div>\r\n\r\n                <div #main style=\"position: relative;\"  class=\"f-datagrid-table f-datagrid-body-center\">\r\n                    <datagrid-rows #mainRows [hasFixedColumns]=\"columnsGroup?.leftFixed && columnsGroup?.leftFixed?.length\"  [startRowIndex]=\"startRowIndex\" [columns]=\"columnsGroup?.columns\" [data]=\"rows\"></datagrid-rows>\r\n                </div>\r\n\r\n                <div hidefocus style=\"width: 100%\" [style.height.px]=\"blankBottomHeight\"></div>\r\n\r\n        </div>\r\n    </div>\r\n\r\n    <scrollbar-arrows [scrollbarXActive]=\"ps.instance && ps.instance.scrollbarXActive\" [scrollbarYActive]=\"ps.instance && ps.instance.scrollbarYActive\" \r\n    *ngIf=\"dg.scrollBarShowMode === 'allways' && dg.showScrollArrow\" (hasYScrollbar)=\"hasYScrollbar($event)\" (scrollMoveTo)=\"onClickScrollArrow($event)\"\r\n    [reachX]=\"ps.instance && ps.instance.reach.x\" [reachY]=\"ps.instance && ps.instance.reach.y\"></scrollbar-arrows>\r\n\r\n\r\n</div>\r\n\r\n\r\n\r\n",
                    changeDetection: ChangeDetectionStrategy.OnPush
                }] }
    ];
    /** @nocollapse */
    DatagridBodyComponent.ctorParameters = function () { return [
        { type: Injector },
        { type: ApplicationRef },
        { type: DatagridComponent, decorators: [{ type: Optional }] },
        { type: ChangeDetectorRef },
        { type: ElementRef }
    ]; };
    DatagridBodyComponent.propDecorators = {
        footerHeight: [{ type: Input }],
        canvasWidth: [{ type: Input }],
        columnsGroup: [{ type: Input }],
        topHideHeight: [{ type: Input }],
        bottomHideHeight: [{ type: Input }],
        startRowIndex: [{ type: Input }],
        data: [{ type: Input }],
        dataChange: [{ type: Output }],
        scrollBarMode: [{ type: Input }],
        contextMenuItems: [{ type: Input }],
        checkedRows: [{ type: Input }],
        fast: [{ type: Input }],
        ps: [{ type: ViewChild, args: ['ps',] }],
        tableRowsCmp: [{ type: ViewChild, args: ['mainRows',] }],
        rightRowsCmp: [{ type: ViewChild, args: ['rightRows',] }],
        fixedLeftEl: [{ type: ViewChild, args: ['fixedLeft',] }],
        fixedRightEl: [{ type: ViewChild, args: ['fixedRight',] }],
        mainArea: [{ type: ViewChild, args: ['main',] }],
        viewScrollContainer: [{ type: ViewChild, args: ['viewScrollContainer',] }]
    };
    return DatagridBodyComponent;
}());
export { DatagridBodyComponent };
if (false) {
    /** @type {?} */
    DatagridBodyComponent.prototype.psConfig;
    /** @type {?} */
    DatagridBodyComponent.prototype.top;
    /** @type {?} */
    DatagridBodyComponent.prototype.height;
    /** @type {?} */
    DatagridBodyComponent.prototype.width;
    /** @type {?} */
    DatagridBodyComponent.prototype.colsWidth;
    /** @type {?} */
    DatagridBodyComponent.prototype.totalWidth;
    /** @type {?} */
    DatagridBodyComponent.prototype.leftFixedWidth;
    /** @type {?} */
    DatagridBodyComponent.prototype.rightFixedWidth;
    /** @type {?} */
    DatagridBodyComponent.prototype.rowHeight;
    /** @type {?} */
    DatagridBodyComponent.prototype.bodyStyle;
    /** @type {?} */
    DatagridBodyComponent.prototype.scrollTop;
    /** @type {?} */
    DatagridBodyComponent.prototype.scrollLeft;
    /** @type {?} */
    DatagridBodyComponent.prototype.deltaTopHeight;
    /** @type {?} */
    DatagridBodyComponent.prototype.wheelWidth;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype._fixedRightScrollLeft;
    /** @type {?} */
    DatagridBodyComponent.prototype.maxScrollLeft;
    /** @type {?} */
    DatagridBodyComponent.prototype.showRightShadow;
    /** @type {?} */
    DatagridBodyComponent.prototype.footerHeight;
    /** @type {?} */
    DatagridBodyComponent.prototype.canvasWidth;
    /** @type {?} */
    DatagridBodyComponent.prototype.columnsGroup;
    /** @type {?} */
    DatagridBodyComponent.prototype.topHideHeight;
    /** @type {?} */
    DatagridBodyComponent.prototype.bottomHideHeight;
    /** @type {?} */
    DatagridBodyComponent.prototype.startRowIndex;
    /** @type {?} */
    DatagridBodyComponent.prototype.data;
    /** @type {?} */
    DatagridBodyComponent.prototype.dataChange;
    /** @type {?} */
    DatagridBodyComponent.prototype.scrollBarMode;
    /** @type {?} */
    DatagridBodyComponent.prototype.contextMenuItems;
    /** @type {?} */
    DatagridBodyComponent.prototype.checkedRows;
    /**
     * 性能优化版，默认为 false
     * @type {?}
     */
    DatagridBodyComponent.prototype.fast;
    /** @type {?} */
    DatagridBodyComponent.prototype.ps;
    /** @type {?} */
    DatagridBodyComponent.prototype.tableRowsCmp;
    /** @type {?} */
    DatagridBodyComponent.prototype.rightRowsCmp;
    /** @type {?} */
    DatagridBodyComponent.prototype.fixedLeftEl;
    /** @type {?} */
    DatagridBodyComponent.prototype.fixedRightEl;
    /** @type {?} */
    DatagridBodyComponent.prototype.mainArea;
    /** @type {?} */
    DatagridBodyComponent.prototype.viewScrollContainer;
    /** @type {?} */
    DatagridBodyComponent.prototype.visibleContextMenus;
    /** @type {?} */
    DatagridBodyComponent.prototype.currentRowId;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype._hoverRowIndex;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.gridSizeSubscribe;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.columnResizeSubscribe;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.onDataSourceChangeSubscribe;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.selectRowSubscribe;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.unselectRowSubscribe;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.selectAllSubscribe;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.checkRowSubscribe;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.clearSelectionsSubscribe;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.checkAllSubscribe;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.uncheckRowSubscribe;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.clearCheckedsSubscribe;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.subscriptions;
    /** @type {?} */
    DatagridBodyComponent.prototype.dfs;
    /** @type {?} */
    DatagridBodyComponent.prototype.dgs;
    /** @type {?} */
    DatagridBodyComponent.prototype.ngZone;
    /** @type {?} */
    DatagridBodyComponent.prototype.render;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.viewportH;
    /** @type {?} */
    DatagridBodyComponent.prototype.viewportW;
    /** @type {?} */
    DatagridBodyComponent.prototype.canvasHeight;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.minRowBuffer;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.vScrollDir;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.rowsCache;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.lastRenderedScrollTop;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.lastRenderedScrollLeft;
    /** @type {?} */
    DatagridBodyComponent.prototype.prevScrollTop;
    /** @type {?} */
    DatagridBodyComponent.prototype.prevScrollLeft;
    /** @type {?} */
    DatagridBodyComponent.prototype.rows;
    /** @type {?} */
    DatagridBodyComponent.prototype.blankTopHeight;
    /** @type {?} */
    DatagridBodyComponent.prototype.blankBottomHeight;
    /** @type {?} */
    DatagridBodyComponent.prototype.cellContentFormatter;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.__triggerBodyClickEvent;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.destroy$;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype._onMouseClick;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype._scrollTimer;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype._scrollXTimer;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.ro;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.resizeObserverTimer;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype._clickCellWeakMap;
    /** @type {?} */
    DatagridBodyComponent.prototype.onBeforeShowContextMenu;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.injector;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.app;
    /** @type {?} */
    DatagridBodyComponent.prototype.dg;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.cd;
    /**
     * @type {?}
     * @private
     */
    DatagridBodyComponent.prototype.el;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGF0YWdyaWQtYm9keS5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZmFycmlzL3VpLWRhdGFncmlkLyIsInNvdXJjZXMiOlsibGliL2NvbXBvbmVudHMvYm9keS9kYXRhZ3JpZC1ib2R5LmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7OztBQUNBLE9BQU8sRUFBRSxTQUFTLEVBQUUsS0FBSyxFQUFFLFlBQVksRUFBTyxTQUFTLEVBQUUsTUFBTSxnQkFBZ0IsQ0FBQztBQUNoRixPQUFPLEVBQWdCLEVBQUUsRUFBRSxPQUFPLEVBQUUsTUFBTSxNQUFNLENBQUM7QUFDakQsT0FBTyxjQUFjLE1BQU0sMEJBQTBCLENBQUM7Ozs7Ozs7OztBQVN0RCxPQUFPLEVBQ0gsU0FBUyxFQUFVLEtBQUssRUFBRSxTQUFTLEVBQUUsU0FBUyxFQUM5QyxVQUFVLEVBQWEsaUJBQWlCLEVBQ2QsdUJBQXVCLEVBQUUsTUFBTSxFQUFFLFFBQVEsRUFBc0IsUUFBUSxFQUFFLGNBQWMsRUFBZ0IsTUFBTSxFQUFFLFlBQVksRUFDeEosTUFBTSxlQUFlLENBQUM7QUFFdkIsT0FBTyxFQUFFLHFCQUFxQixFQUFFLE1BQU0sd0NBQXdDLENBQUM7QUFDL0UsT0FBTyxFQUFFLGtCQUFrQixFQUFFLE1BQU0scUNBQXFDLENBQUM7QUFFekUsT0FBTyxFQUFnRSxlQUFlLEVBQUUseUJBQXlCLEVBQUUsbUJBQW1CLEVBQUUsTUFBTSxzQkFBc0IsQ0FBQztBQUNySyxPQUFPLEVBQUUsZUFBZSxFQUFFLGVBQWUsRUFBRSwyQkFBMkIsRUFBNkIsU0FBUyxFQUFFLHVCQUF1QixFQUFFLE1BQU0sc0JBQXNCLENBQUM7QUFDcEssT0FBTyxFQUFFLGVBQWUsRUFBRSxNQUFNLGlDQUFpQyxDQUFDO0FBQ2xFLE9BQU8sRUFBRSxpQkFBaUIsRUFBRSxNQUFNLDBCQUEwQixDQUFDO0FBQzdELE9BQU8sRUFBRSxrQkFBa0IsRUFBRSxNQUFNLG1DQUFtQyxDQUFDO0FBQ3ZFLE9B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QzVCLHVDQUFzQjs7SUFDdEIsdUNBQXlCOzs7OztJQUd6QiwwQ0FBa0I7O0lBQ2xCLDBDQUFVOztJQUNWLDZDQUFhOzs7OztJQUNiLDZDQUF5Qjs7Ozs7SUFDekIsMkNBQXVCOzs7OztJQUN2QiwwQ0FBdUI7Ozs7O0lBQ3ZCLHNEQUFrQzs7Ozs7SUFDbEMsdURBQW1DOztJQUNuQyw4Q0FBa0I7O0lBQ2xCLCtDQUFtQjs7SUFDbkIscUNBQVU7O0lBQ1YsK0NBQW1COztJQUNuQixrREFBc0I7O0lBbUJ0QixxREFBZ0Q7Ozs7O0lBR2hELHdEQUF1Qzs7Ozs7SUFDdkMseUNBQWlDOzs7OztJQUNqQyw4Q0FBNkI7Ozs7O0lBQzdCLDZDQUE4Qjs7Ozs7SUFDOUIsOENBQStCOzs7OztJQUMvQixtQ0FBeUM7Ozs7O0lBQ3pDLG9EQUFxQzs7Ozs7SUFFckMsa0RBQTBDOztJQXdpRDFDLHdEQXFEQzs7Ozs7SUExbERHLHlDQUEwQjs7Ozs7SUFDMUIsb0NBQTJCOztJQUMzQixtQ0FBd0M7Ozs7O0lBQ3hDLG1DQUE2Qjs7Ozs7SUFBRSxtQ0FBc0IiLCJzb3VyY2VzQ29udGVudCI6WyJcclxuaW1wb3J0IHsgc3dpdGNoTWFwLCBkZWxheSwgZGVib3VuY2VUaW1lLCB0YXAsIHRha2VVbnRpbCB9IGZyb20gJ3J4anMvb3BlcmF0b3JzJztcclxuaW1wb3J0IHsgU3Vic2NyaXB0aW9uLCBvZiwgU3ViamVjdCB9IGZyb20gJ3J4anMnO1xyXG5pbXBvcnQgUmVzaXplT2JzZXJ2ZXIgZnJvbSAncmVzaXplLW9ic2VydmVyLXBvbHlmaWxsJztcclxuLypcclxuICogQEF1dGhvcjog55av54uC56eA5omNKEx1Y2FzIEh1YW5nKVxyXG4gKiBARGF0ZTogMjAxOS0wOC0xMiAwNzo0NzoxMlxyXG4gKiBATGFzdEVkaXRvcnM6IOeWr+eLguengOaJjShMdWNhcyBIdWFuZylcclxuICogQExhc3RFZGl0VGltZTogMjAxOS0xMS0yNiAxMDoyMToyNVxyXG4gKiBAUVE6IDEwNTU4MTgyMzlcclxuICogQFZlcnNpb246IHYwLjAuMVxyXG4gKi9cclxuaW1wb3J0IHtcclxuICAgIENvbXBvbmVudCwgT25Jbml0LCBJbnB1dCwgVmlld0NoaWxkLCBSZW5kZXJlcjIsXHJcbiAgICBFbGVtZW50UmVmLCBPbkRlc3Ryb3ksIENoYW5nZURldGVjdG9yUmVmLCBBZnRlclZpZXdJbml0LCBBZnRlclZpZXdDaGVja2VkLFxyXG4gICAgT25DaGFuZ2VzLCBTaW1wbGVDaGFuZ2VzLCBDaGFuZ2VEZXRlY3Rpb25TdHJhdGVneSwgTmdab25lLCBJbmplY3RvciwgZm9yd2FyZFJlZiwgSW5qZWN0LCBPcHRpb25hbCwgQXBwbGljYXRpb25SZWYsIEhvc3RMaXN0ZW5lciwgT3V0cHV0LCBFdmVudEVtaXR0ZXJcclxufSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuXHJcbmltcG9ydCB7IERhdGFncmlkRmFjYWRlU2VydmljZSB9IGZyb20gJy4uLy4uL3NlcnZpY2VzL2RhdGFncmlkLWZhY2FkZS5zZXJ2aWNlJztcclxuaW1wb3J0IHsgU2Nyb2xsYmFyRGlyZWN0aXZlIH0gZnJvbSAnLi4vLi4vc2Nyb2xsYmFyL3Njcm9sbGJhci5kaXJlY3RpdmUnO1xyXG5pbXBvcnQgeyBDb2x1bW5Hcm91cCB9IGZyb20gJy4uLy4uL3R5cGVzJztcclxuaW1wb3J0IHsgU2VsZWN0ZWRSb3csIERhdGFSZXN1bHQsIFJPV19JTkRFWF9GSUVMRCwgSVNfR1JPVVBfUk9XX0ZJRUxELCBHUk9VUF9ST1dfRklFTEQsIElTX0dST1VQX0ZPT1RFUl9ST1dfRklFTEQsIEdST1VQX1ZJU0lCTEVfRklFTEQgfSBmcm9tICcuLi8uLi9zZXJ2aWNlcy9zdGF0ZSc7XHJcbmltcG9ydCB7IFNDUk9MTF9YX0FDVElPTiwgU0NST0xMX1lfQUNUSU9OLCBTQ1JPTExfWF9SRUFDSF9TVEFSVF9BQ1RJT04sIFNDUk9MTF9YX1JFQUNIX0VORF9BQ1RJT04sIFRSX1BSRUZJWCwgV09SRFdSQVBfUk9XX0hFSUdIVF9DTFMgfSBmcm9tICcuLi8uLi90eXBlcy9jb25zdGFudCc7XHJcbmltcG9ydCB7IERhdGFncmlkU2VydmljZSB9IGZyb20gJy4uLy4uL3NlcnZpY2VzL2RhdGFncmlkLnNlcnZpY2UnO1xyXG5pbXBvcnQgeyBEYXRhZ3JpZENvbXBvbmVudCB9IGZyb20gJy4uLy4uL2RhdGFncmlkLmNvbXBvbmVudCc7XHJcbmltcG9ydCB7IEZvcm1hdENlbGxEYXRhUGlwZSB9IGZyb20gJy4uLy4uL3V0aWxzL2Zvcm1hdC1jZWxsLWRhdGEucGlwZSc7XHJcbmltcG9ydCB7IENvbHVtbkZvcm1hdFNlcnZpY2UgfSBmcm9tICdAZmFycmlzL3VpLWNvbW1vbi9jb2x1bW4nO1xyXG5pbXBvcnQgeyBDb250ZXh0TWVudUl0ZW0gfSBmcm9tICdAZmFycmlzL3VpLWNvbnRleHQtbWVudSc7XHJcbmltcG9ydCB7IFV0aWxzIH0gZnJvbSAnLi4vLi4vdXRpbHMvdXRpbHMnO1xyXG5cclxuQENvbXBvbmVudCh7XHJcbiAgICBzZWxlY3RvcjogJ2RhdGFncmlkLWJvZHknLFxyXG4gICAgdGVtcGxhdGVVcmw6ICcuL2JvZHkuY29tcG9uZW50Lmh0bWwnLFxyXG4gICAgY2hhbmdlRGV0ZWN0aW9uOiBDaGFuZ2VEZXRlY3Rpb25TdHJhdGVneS5PblB1c2hcclxufSlcclxuZXhwb3J0IGNsYXNzIERhdGFncmlkQm9keUNvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCwgT25EZXN0cm95LCBPbkNoYW5nZXMsIEFmdGVyVmlld0luaXQsIEFmdGVyVmlld0NoZWNrZWQge1xyXG4gICAgLy8g6Ieq5Yqo6auY5bqm5pe277yM56aB55So57q15ZCR5rua5Yqo5p2hXHJcbiAgICBwc0NvbmZpZyA9IHsgc3dpcGVFYXNpbmc6IGZhbHNlLCBtaW5TY3JvbGxiYXJMZW5ndGg6IDE1LCBoYW5kbGVyczogWydjbGljay1yYWlsJywgJ2RyYWctdGh1bWInLCAnd2hlZWwnLCAndG91Y2gnXSwgc3VwcHJlc3NTY3JvbGxZOiB0aGlzLmRnLmF1dG9IZWlnaHQgJiYgdGhpcy5kZy5tYXhIZWlnaHQgPyBmYWxzZTogdGhpcy5kZy5hdXRvSGVpZ2h0IH07XHJcblxyXG4gICAgdG9wOiBudW1iZXI7XHJcbiAgICBoZWlnaHQ6IG51bWJlcjtcclxuICAgIHdpZHRoOiBudW1iZXI7XHJcbiAgICBjb2xzV2lkdGg6IG51bWJlcjtcclxuICAgIHRvdGFsV2lkdGg6IG51bWJlcjtcclxuICAgIGxlZnRGaXhlZFdpZHRoOiBudW1iZXI7XHJcbiAgICByaWdodEZpeGVkV2lkdGg6IG51bWJlcjtcclxuICAgIHJvd0hlaWdodDogbnVtYmVyO1xyXG4gICAgYm9keVN0eWxlOiBhbnk7XHJcbiAgICBzY3JvbGxUb3AgPSAwO1xyXG4gICAgc2Nyb2xsTGVmdCA9IDA7XHJcbiAgICBkZWx0YVRvcEhlaWdodCA9IDA7XHJcbiAgICAvLyB3aGVlbEhlaWdodCA9IDA7XHJcbiAgICB3aGVlbFdpZHRoID0gMDtcclxuICAgIHByaXZhdGUgX2ZpeGVkUmlnaHRTY3JvbGxMZWZ0ID0gMDtcclxuICAgIGdldCBmaXhlZFJpZ2h0U2Nyb2xsTGVmdCgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fZml4ZWRSaWdodFNjcm9sbExlZnQ7XHJcbiAgICB9XHJcbiAgICBzZXQgZml4ZWRSaWdodFNjcm9sbExlZnQodmFsKSB7XHJcbiAgICAgICAgdGhpcy5fZml4ZWRSaWdodFNjcm9sbExlZnQgPSB2YWw7XHJcbiAgICB9XHJcblxyXG4gICAgbWF4U2Nyb2xsTGVmdCA9IDA7XHJcbiAgICBzaG93UmlnaHRTaGFkb3cgPSBmYWxzZTtcclxuICAgIEBJbnB1dCgpIGZvb3RlckhlaWdodCA9IDA7XHJcbiAgICBASW5wdXQoKSBjYW52YXNXaWR0aDtcclxuICAgIEBJbnB1dCgpIGNvbHVtbnNHcm91cDogQ29sdW1uR3JvdXA7XHJcbiAgICAvLyDomZrmi5/liqDovb1cclxuICAgIEBJbnB1dCgpIHRvcEhpZGVIZWlnaHQgPSAwO1xyXG4gICAgQElucHV0KCkgYm90dG9tSGlkZUhlaWdodCA9IDA7XHJcblxyXG4gICAgQElucHV0KCkgc3RhcnRSb3dJbmRleCA9IDA7XHJcbiAgICBASW5wdXQoKSBkYXRhOiBhbnk7XHJcblxyXG4gICAgQE91dHB1dCgpIGRhdGFDaGFuZ2UgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XHJcblxyXG4gICAgQElucHV0KCkgc2Nyb2xsQmFyTW9kZSA9ICdhdXRvJztcclxuICAgIEBJbnB1dCgpIGNvbnRleHRNZW51SXRlbXM6IENvbnRleHRNZW51SXRlbVtdO1xyXG5cclxuICAgIEBJbnB1dCgpIGNoZWNrZWRSb3dzID0gW107XHJcblxyXG4gICAgLyoqIOaAp+iDveS8mOWMlueJiO+8jOm7mOiupOS4uiBmYWxzZSAqL1xyXG4gICAgQElucHV0KCkgZmFzdCA9IGZhbHNlO1xyXG5cclxuXHJcbiAgICBAVmlld0NoaWxkKCdwcycpIHBzPzogU2Nyb2xsYmFyRGlyZWN0aXZlO1xyXG4gICAgQFZpZXdDaGlsZCgnbWFpblJvd3MnKSB0YWJsZVJvd3NDbXA6IGFueTtcclxuICAgIEBWaWV3Q2hpbGQoJ3JpZ2h0Um93cycpIHJpZ2h0Um93c0NtcDogYW55O1xyXG4gICAgQFZpZXdDaGlsZCgnZml4ZWRMZWZ0JykgZml4ZWRMZWZ0RWw6IEVsZW1lbnRSZWY7XHJcbiAgICBAVmlld0NoaWxkKCdmaXhlZFJpZ2h0JykgZml4ZWRSaWdodEVsOiBFbGVtZW50UmVmO1xyXG4gICAgQFZpZXdDaGlsZCgnbWFpbicpIG1haW5BcmVhOiBFbGVtZW50UmVmO1xyXG4gICAgQFZpZXdDaGlsZCgndmlld1Njcm9sbENvbnRhaW5lcicpIHZpZXdTY3JvbGxDb250YWluZXI6IEVsZW1lbnRSZWY7XHJcblxyXG5cclxuICAgIHZpc2libGVDb250ZXh0TWVudXMgPSBbXTtcclxuICAgIGN1cnJlbnRSb3dJZCA9IHVuZGVmaW5lZDtcclxuXHJcbiAgICBwcml2YXRlIF9ob3ZlclJvd0luZGV4ID0gLTE7XHJcbiAgICBnZXQgaG92ZXJSb3dJbmRleCgpOiBudW1iZXIge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9ob3ZlclJvd0luZGV4O1xyXG4gICAgfVxyXG4gICAgc2V0IGhvdmVyUm93SW5kZXgocm93SWR4OiBudW1iZXIpIHtcclxuICAgICAgICB0aGlzLl9ob3ZlclJvd0luZGV4ID0gcm93SWR4O1xyXG4gICAgICAgIHRoaXMuY2QuZGV0ZWN0Q2hhbmdlcygpO1xyXG4gICAgfVxyXG5cclxuICAgIGdldCBzZWxlY3RlZFJvd3MoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZGcuc2VsZWN0aW9ucztcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGdyaWRTaXplU3Vic2NyaWJlOiBTdWJzY3JpcHRpb247XHJcbiAgICBwcml2YXRlIGNvbHVtblJlc2l6ZVN1YnNjcmliZTogU3Vic2NyaXB0aW9uO1xyXG4gICAgcHJpdmF0ZSBvbkRhdGFTb3VyY2VDaGFuZ2VTdWJzY3JpYmU6IFN1YnNjcmlwdGlvbjtcclxuICAgIHByaXZhdGUgc2VsZWN0Um93U3Vic2NyaWJlOiBTdWJzY3JpcHRpb247XHJcbiAgICBwcml2YXRlIHVuc2VsZWN0Um93U3Vic2NyaWJlOiBTdWJzY3JpcHRpb247XHJcbiAgICBwcml2YXRlIHNlbGVjdEFsbFN1YnNjcmliZTogU3Vic2NyaXB0aW9uO1xyXG4gICAgcHJpdmF0ZSBjaGVja1Jvd1N1YnNjcmliZTogU3Vic2NyaXB0aW9uO1xyXG4gICAgcHJpdmF0ZSBjbGVhclNlbGVjdGlvbnNTdWJzY3JpYmU6IFN1YnNjcmlwdGlvbjtcclxuICAgIHByaXZhdGUgY2hlY2tBbGxTdWJzY3JpYmU6IFN1YnNjcmlwdGlvbjtcclxuICAgIHByaXZhdGUgdW5jaGVja1Jvd1N1YnNjcmliZTogU3Vic2NyaXB0aW9uO1xyXG4gICAgcHJpdmF0ZSBjbGVhckNoZWNrZWRzU3Vic2NyaWJlOiBTdWJzY3JpcHRpb247XHJcblxyXG4gICAgcHJpdmF0ZSBzdWJzY3JpcHRpb25zID0gW107XHJcblxyXG4gICAgcHVibGljIGRmczogRGF0YWdyaWRGYWNhZGVTZXJ2aWNlO1xyXG4gICAgcHVibGljIGRnczogRGF0YWdyaWRTZXJ2aWNlO1xyXG4gICAgcHVibGljIG5nWm9uZTogTmdab25lO1xyXG4gICAgcHVibGljIHJlbmRlcjogUmVuZGVyZXIyO1xyXG5cclxuICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xyXG4gICAgcHJpdmF0ZSB2aWV3cG9ydEg7XHJcbiAgICB2aWV3cG9ydFc7XHJcbiAgICBjYW52YXNIZWlnaHQ7XHJcbiAgICBwcml2YXRlIG1pblJvd0J1ZmZlciA9IDM7XHJcbiAgICBwcml2YXRlIHZTY3JvbGxEaXIgPSAxO1xyXG4gICAgcHJpdmF0ZSByb3dzQ2FjaGUgPSB7fTtcclxuICAgIHByaXZhdGUgbGFzdFJlbmRlcmVkU2Nyb2xsVG9wID0gMDtcclxuICAgIHByaXZhdGUgbGFzdFJlbmRlcmVkU2Nyb2xsTGVmdCA9IDA7XHJcbiAgICBwcmV2U2Nyb2xsVG9wID0gMDtcclxuICAgIHByZXZTY3JvbGxMZWZ0ID0gMDtcclxuICAgIHJvd3MgPSBbXTtcclxuICAgIGJsYW5rVG9wSGVpZ2h0ID0gMDtcclxuICAgIGJsYW5rQm90dG9tSGVpZ2h0ID0gMDtcclxuXHJcbiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xyXG5cclxuICAgIGdldCBzY3JvbGxiYXJYSGVpZ2h0KCkge1xyXG4gICAgICAgIGlmICh0aGlzLmRnICYmIHRoaXMucHMgJiYgdGhpcy5wcy5pbnN0YW5jZSkge1xyXG4gICAgICAgICAgICBjb25zdCBoID0gdGhpcy5kZy5zY3JvbGxCYXJTaG93TW9kZSA9PT0gJ2FsbHdheXMnICYmIHRoaXMucHMuaW5zdGFuY2VbJ3Njcm9sbGJhclhBY3RpdmUnXSA/IDIyIDogMDtcclxuICAgICAgICAgICAgaWYgKHRoaXMucHMuaW5zdGFuY2VbJ3Njcm9sbGJhcllBY3RpdmUnXSAmJiBoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gaCArIDE4OyAvLyArICh0aGlzLmRnLnNob3dTY3JvbGxBcnJvdyAmJiB0aGlzLnBzLmluc3RhbmNlWydzY3JvbGxiYXJZQWN0aXZlJ10gPyAxOCA6IDApO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGdldCBzY3JvbGxiYXJZV2lkdGgoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuZGcgJiYgdGhpcy5wcyAmJiB0aGlzLnBzLmluc3RhbmNlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmRnLnNjcm9sbEJhclNob3dNb2RlID09PSAnYWxsd2F5cycgJiYgdGhpcy5wcy5pbnN0YW5jZVsnc2Nyb2xsYmFyWUFjdGl2ZSddICYmIHRoaXMuc2hvd1JpZ2h0U2hhZG93ID8gMTggOiAwO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBjZWxsQ29udGVudEZvcm1hdHRlcjogRm9ybWF0Q2VsbERhdGFQaXBlID0gbnVsbDtcclxuXHJcbiAgICAvLyDlvZPlkK/nlKjlpJrpgInkuJTlhYHorrjlpJrpgInkuK3vvIzliJfooajkuI3og73nvJbovpHml7bvvIzlj5bpgInkuK3lkI7npoHmraLop6blj5Fib2R5IOeahGNsaWNrIOS6i+S7tlxyXG4gICAgcHJpdmF0ZSBfX3RyaWdnZXJCb2R5Q2xpY2tFdmVudCA9IHRydWU7XHJcbiAgICBwcml2YXRlIGRlc3Ryb3kkID0gbmV3IFN1YmplY3QoKTtcclxuICAgIHByaXZhdGUgX29uTW91c2VDbGljayA9IG51bGw7XHJcbiAgICBwcml2YXRlIF9zY3JvbGxUaW1lcjogYW55ID0gMDtcclxuICAgIHByaXZhdGUgX3Njcm9sbFhUaW1lcjogYW55ID0gMDtcclxuICAgIHByaXZhdGUgcm86IFJlc2l6ZU9ic2VydmVyIHwgbnVsbCA9IG51bGw7XHJcbiAgICBwcml2YXRlIHJlc2l6ZU9ic2VydmVyVGltZXI6IGFueSA9IDA7XHJcblxyXG4gICAgcHJpdmF0ZSBfY2xpY2tDZWxsV2Vha01hcCA9IG5ldyBXZWFrTWFwKCk7XHJcblxyXG4gICAgY29uc3RydWN0b3IoXHJcbiAgICAgICAgcHJpdmF0ZSBpbmplY3RvcjogSW5qZWN0b3IsXHJcbiAgICAgICAgcHJpdmF0ZSBhcHA6IEFwcGxpY2F0aW9uUmVmLFxyXG4gICAgICAgIEBPcHRpb25hbCgpIHB1YmxpYyBkZzogRGF0YWdyaWRDb21wb25lbnQsXHJcbiAgICAgICAgcHJpdmF0ZSBjZDogQ2hhbmdlRGV0ZWN0b3JSZWYsIHByaXZhdGUgZWw6IEVsZW1lbnRSZWZcclxuICAgICkge1xyXG4gICAgICAgIHRoaXMuZGZzID0gdGhpcy5pbmplY3Rvci5nZXQoRGF0YWdyaWRGYWNhZGVTZXJ2aWNlKTtcclxuICAgICAgICB0aGlzLmRncyA9IHRoaXMuaW5qZWN0b3IuZ2V0KERhdGFncmlkU2VydmljZSk7XHJcbiAgICAgICAgdGhpcy5uZ1pvbmUgPSB0aGlzLmluamVjdG9yLmdldChOZ1pvbmUpO1xyXG4gICAgICAgIHRoaXMucmVuZGVyID0gdGhpcy5pbmplY3Rvci5nZXQoUmVuZGVyZXIyKTtcclxuXHJcbiAgICAgICAgY29uc3QgY29sdW1uRm9ybWF0U2VydmljZSA9IHRoaXMuaW5qZWN0b3IuZ2V0KENvbHVtbkZvcm1hdFNlcnZpY2UpO1xyXG4gICAgICAgIHRoaXMuY2VsbENvbnRlbnRGb3JtYXR0ZXIgPSBuZXcgRm9ybWF0Q2VsbERhdGFQaXBlKGNvbHVtbkZvcm1hdFNlcnZpY2UsIHRoaXMuaW5qZWN0b3IpO1xyXG4gICAgfVxyXG5cclxuICAgIG5nT25Jbml0KCk6IHZvaWQge1xyXG5cclxuICAgICAgICB0aGlzLmxpc3RlblN1YmplY3RzKCk7XHJcbiAgICAgICAgdGhpcy5kZy5zY3JvbGxJbnN0YW5jZSA9IHRoaXMucHM7XHJcbiAgICAgICAgY29uc3QgczEgPSB0aGlzLmRncy5zaG93R3JpZEhlYWRlci5zdWJzY3JpYmUoaGVhZGVySGVpZ2h0ID0+IHtcclxuICAgICAgICAgICAgdGhpcy51cGRhdGVDb250YWluZXJTaXplKGhlYWRlckhlaWdodCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5zdWJzY3JpcHRpb25zLnB1c2goczEpO1xyXG5cclxuICAgICAgICBjb25zdCBzMTAgPSB0aGlzLmRncy5mb290ZXJQb3NpdGlvbkNoYW5nZWQuc3Vic2NyaWJlKCgpID0+IHtcclxuICAgICAgICAgICAgdGhpcy51cGRhdGVDb250YWluZXJTaXplKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5zdWJzY3JpcHRpb25zLnB1c2goczEwKTtcclxuXHJcbiAgICAgICAgY29uc3QgczIgPSB0aGlzLmRncy5yb3dIZWlnaHRDaGFuZ2VkLnN1YnNjcmliZSgoKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuY2QuZGV0ZWN0Q2hhbmdlcygpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMuc3Vic2NyaXB0aW9ucy5wdXNoKHMyKTtcclxuXHJcbiAgICAgICAgY29uc3QgczMgPSB0aGlzLmRmcy5jbGllbnRTb3J0JC5zdWJzY3JpYmUoKCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLmNoZWNrU2Nyb2xsYmFyUG9zaXRpb24odHJ1ZSk7XHJcbiAgICAgICAgICAgIHRoaXMuY2QuZGV0ZWN0Q2hhbmdlcygpO1xyXG4gICAgICAgICAgICAvLyB0aGlzLmRnLmNvbHVtblNvcnRlZC5lbWl0KCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5zdWJzY3JpcHRpb25zLnB1c2goczMpO1xyXG4gICAgICAgXHJcbiAgICAgICAgY29uc3QgczUgPSB0aGlzLmRnLmRncy5jb2x1bW5zQ2hhbmdlZC5waXBlKFxyXG4gICAgICAgICAgICBkZWxheSg1MClcclxuICAgICAgICApLnN1YnNjcmliZSgoZTogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChlICYmIGUuc2Nyb2xsVG9MZWZ0KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnBzLmVsZW1lbnRSZWYubmF0aXZlRWxlbWVudC5zY3JvbGxUbygwLCAwKTtcclxuICAgICAgICAgICAgICAgIHRoaXMucHMuc2Nyb2xsVG9MZWZ0KDAsIDEwMCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLnN1YnNjcmlwdGlvbnMucHVzaChzNSk7XHJcbiAgICAgICBcclxuICAgICAgICB0aGlzLnZpZXdTY3JvbGxDb250YWluZXIubmF0aXZlRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuX29uTW91c2VDbGljayA9IChlKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMub25Nb3VzZUNsaWNrKGUpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpZiAoIXRoaXMuZGcubm93cmFwKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZGdzLmRhdGFsb2FkZWQuc3Vic2NyaWJlKCgpID0+IHtcclxuICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlUm93SGVpZ2h0KCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIHVwZGF0ZUNvbnRhaW5lclNpemUoaGVhZGVySGVpZ2h0PzogYW55KSB7XHJcbiAgICAgICAgY29uc3QgaGggPSBoZWFkZXJIZWlnaHQgfHwgdGhpcy5kZy5yZWFsSGVhZGVySGVpZ2h0O1xyXG4gICAgICAgIHRoaXMuc2V0UG9zaXRpb25Ub3AoaGgpO1xyXG4gICAgICAgIHRoaXMuaGVpZ2h0ID0gdGhpcy5kZy5oZWlnaHQgLSB0aGlzLnRvcDtcclxuICAgICAgICB0aGlzLmJvZHlTdHlsZSA9IHRoaXMuZ2V0Qm9keVN0eWxlKCk7XHJcbiAgICAgICAgdGhpcy5jZC5kZXRlY3RDaGFuZ2VzKCk7XHJcbiAgICB9XHJcblxyXG4gICAgbmdPbkNoYW5nZXMoY2hhbmdlczogU2ltcGxlQ2hhbmdlcykge1xyXG4gICAgICAgIGlmIChjaGFuZ2VzLmRhdGEgJiYgIWNoYW5nZXMuZGF0YS5pc0ZpcnN0Q2hhbmdlKCkpIHtcclxuICAgICAgICAgICAgdGhpcy5ib2R5U3R5bGUgPSB0aGlzLmdldEJvZHlTdHlsZSgpO1xyXG4gICAgICAgICAgICB0aGlzLmRmcy5zZXRDdXJyZW50UGFnZURhdGEoY2hhbmdlcy5kYXRhLmN1cnJlbnRWYWx1ZSk7XHJcblxyXG4gICAgICAgICAgICBjb25zdCBpc0RpZmZyZW50RGF0YVNvdXJjZSA9ICEhY2hhbmdlcy5kYXRhLmN1cnJlbnRWYWx1ZS5maWx0ZXIobiA9PiAhblsnX19ncm91cF9fJ10pLm1hcChuID0+IG4uaWQpLmZpbHRlcihuID0+IHtcclxuICAgICAgICAgICAgICAgIHJldHVybiAhY2hhbmdlcy5kYXRhLnByZXZpb3VzVmFsdWUuZmlsdGVyKG4gPT4gIW5bJ19fZ3JvdXBfXyddKS5maW5kKHAgPT4gcC5pZCA9PT0gbilcclxuICAgICAgICAgICAgfSkubGVuZ3RoO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgaXNTYW1lTGVuZ3RoID0gY2hhbmdlcy5kYXRhLmN1cnJlbnRWYWx1ZS5maWx0ZXIobiA9PiAhblsnX19ncm91cF9fJ10pLmxlbmd0aCA+PSBjaGFuZ2VzLmRhdGEucHJldmlvdXNWYWx1ZS5maWx0ZXIobiA9PiAhblsnX19ncm91cF9fJ10pLmxlbmd0aDtcclxuICAgICAgICAgICAgdGhpcy5vbkRhdGFDaGFuZ2VkKGlzU2FtZUxlbmd0aCwgaXNEaWZmcmVudERhdGFTb3VyY2UpO1xyXG5cclxuICAgICAgICAgICAgaWYgKCFjaGFuZ2VzLmRhdGEuY3VycmVudFZhbHVlIHx8ICFjaGFuZ2VzLmRhdGEuY3VycmVudFZhbHVlLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRQb3NpdGlvblRvcCh0aGlzLmRnLnJlYWxIZWFkZXJIZWlnaHQpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChjaGFuZ2VzLmZvb3RlckhlaWdodCAhPT0gdW5kZWZpbmVkICYmICFjaGFuZ2VzLmZvb3RlckhlaWdodC5pc0ZpcnN0Q2hhbmdlKCkpIHtcclxuICAgICAgICAgICAgdGhpcy5ib2R5U3R5bGUgPSB0aGlzLmdldEJvZHlTdHlsZSgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKGNoYW5nZXMuc2Nyb2xsQmFyTW9kZSAhPT0gdW5kZWZpbmVkICYmICFjaGFuZ2VzLnNjcm9sbEJhck1vZGUuaXNGaXJzdENoYW5nZSgpKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLnBzICYmIHRoaXMucHMuaW5zdGFuY2UgJiYgdGhpcy5zY3JvbGxCYXJNb2RlID09PSAnYWxsd2F5cycgJiYgdGhpcy5wcy5pbnN0YW5jZS5zY3JvbGxiYXJZQWN0aXZlKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnJpZ2h0Rml4ZWRXaWR0aCArPSB0aGlzLnNob3dSaWdodFNoYWRvdyA/IDE4IDogMDtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHRoaXMucmlnaHRGaXhlZFdpZHRoID0gdGhpcy5jb2x1bW5zR3JvdXAucmlnaHRGaXhlZFdpZHRoO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICBcclxuICAgICAgICAgICAgaWYgKHRoaXMuZGcuc2Nyb2xsQmFyU2hvd01vZGUgPT09ICdhbGx3YXlzJyAmJiB0aGlzLnBzICYmIHRoaXMucHMuaW5zdGFuY2UgJiYgdGhpcy5wcy5pbnN0YW5jZS5zY3JvbGxiYXJYQWN0aXZlKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmJsYW5rQm90dG9tSGVpZ2h0ICs9IDIyO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoY2hhbmdlcy5zaG93U2Nyb2xsQXJyb3cgJiYgIWNoYW5nZXMuc2hvd1Njcm9sbEFycm93LmlzRmlyc3RDaGFuZ2UoKSkge1xyXG4gICAgICAgICAgICB0aGlzLnBzICYmIHRoaXMucHMudXBkYXRlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIG5nT25EZXN0cm95KCkge1xyXG4gICAgICAgIHRoaXMuZGVzdHJveSQubmV4dCgpO1xyXG4gICAgICAgIHRoaXMuZGVzdHJveSQuY29tcGxldGUoKTtcclxuICAgICAgICB0aGlzLmNlbGxDb250ZW50Rm9ybWF0dGVyID0gbnVsbDtcclxuICAgICAgICB0aGlzLmRnLnNjcm9sbEluc3RhbmNlID0gbnVsbDtcclxuICAgICAgICB0aGlzLmRlc3Ryb3lTdWJzY3JpcHRpb25zKCk7XHJcbiAgICAgICAgdGhpcy52aWV3U2Nyb2xsQ29udGFpbmVyLm5hdGl2ZUVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLl9vbk1vdXNlQ2xpY2spO1xyXG5cclxuICAgICAgICBpZiAodGhpcy5ybykge1xyXG4gICAgICAgICAgICB0aGlzLnJvLnVub2JzZXJ2ZSh0aGlzLnZpZXdTY3JvbGxDb250YWluZXIubmF0aXZlRWxlbWVudCk7XHJcbiAgICAgICAgICAgIHRoaXMucm8uZGlzY29ubmVjdCgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHRoaXMucmVzaXplT2JzZXJ2ZXJUaW1lcikge1xyXG4gICAgICAgICAgICBjbGVhclRpbWVvdXQodGhpcy5yZXNpemVPYnNlcnZlclRpbWVyKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgfVxyXG5cclxuICAgIG5nQWZ0ZXJWaWV3SW5pdCgpIHtcclxuICAgICAgICB0aGlzLnJvID0gbmV3IFJlc2l6ZU9ic2VydmVyKChlKSA9PiB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLnZpZXdTY3JvbGxDb250YWluZXIubmF0aXZlRWxlbWVudC5vZmZzZXRQYXJlbnQpIHtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLnJlc2l6ZU9ic2VydmVyVGltZXIpIHtcclxuICAgICAgICAgICAgICAgICAgICBjbGVhclRpbWVvdXQodGhpcy5yZXNpemVPYnNlcnZlclRpbWVyKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHRoaXMucmVzaXplT2JzZXJ2ZXJUaW1lciA9IHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlQ2FudmFzSGVpZ2h0KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuc2Nyb2xsQmFyTW9kZSA9PT0gJ2FsbHdheXMnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHMudXBkYXRlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIC8vIHRoaXMuc2V0Rml4ZWRSaWdodFdpZHRoKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jZC5kZXRlY3RDaGFuZ2VzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5kZ3Muc2Nyb2xsYmFyVXBkYXRlLmVtaXQoeyBzY3JvbGxiYXJSZWY6IHRoaXMucHMuaW5zdGFuY2UsIHJpZ2h0V2lkdGg6IHRoaXMucmlnaHRGaXhlZFdpZHRoLCBzaG93UmlnaHRTaGFkb3c6IHRoaXMuc2hvd1JpZ2h0U2hhZG93IH0pO1xyXG4gICAgICAgICAgICAgICAgfSwgMTAwKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICB0aGlzLnJvLm9ic2VydmUodGhpcy52aWV3U2Nyb2xsQ29udGFpbmVyLm5hdGl2ZUVsZW1lbnQpO1xyXG4gICAgfVxyXG5cclxuICAgIG5nQWZ0ZXJWaWV3Q2hlY2tlZCgpIHtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIHNldFBvc2l0aW9uVG9wKGhlYWRlckhlaWdodDogbnVtYmVyKSB7XHJcbiAgICAgICAgdGhpcy50b3AgPSBoZWFkZXJIZWlnaHQ7XHJcbiAgICAgICAgXHJcbiAgICAgICAgaWYgKCh0aGlzLmRnLmVuYWJsZUZpbHRlclJvdyB8fCB0aGlzLmRnLmVuYWJsZVNtYXJ0RmlsdGVyKSAmJiB0aGlzLmRnLnNob3dGaWx0ZXJCYXIpIHtcclxuICAgICAgICAgICAgdGhpcy50b3AgKz0gdGhpcy5kZy5maWx0ZXJCYXJIZWlnaHQ7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAodGhpcy5kZy5zaG93Um93R3JvdXBQYW5lbCkge1xyXG4gICAgICAgICAgICB0aGlzLnRvcCArPSB0aGlzLmRnLnJvd0dyb3VwUGFuZWxIZWlnaHQ7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAodGhpcy5kZy5zaG93Rm9vdGVyICYmICh0aGlzLmRnLmZvb3RlclBvc2l0aW9uID09PSAndG9wJyB8fCB0aGlzLmRnLmZvb3RlclBvc2l0aW9uID09PSAnYm90aCcpKSB7XHJcbiAgICAgICAgICAgIC8vIGhlYWRlckhlaWdodCDlt7LljIXmi6zov4fmu6TooYznmoTpq5jluqYgdGZzIDU0MjQ3MVxyXG4gICAgICAgICAgICBpZiAodGhpcy5kYXRhICYmIHRoaXMuZGF0YS5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMudG9wICs9IHRoaXMuZGcuZm9vdGVySGVpZ2h0O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgY2hlY2tTY3JvbGxiYXJQb3NpdGlvbih0b1RvcCA9IGZhbHNlKSB7XHJcbiAgICAgICAgaWYgKCF0aGlzLmRnLmRhdGEgfHwgIXRoaXMuZGcuZGF0YS5sZW5ndGgpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCBzY3JvbGxCYXI6IGFueSA9IHRoaXMucHMuaW5zdGFuY2U7XHJcbiAgICAgICAgY29uc3Qgc2Nyb2xsRWxSZWYgPSB0aGlzLnBzLmVsZW1lbnRSZWYubmF0aXZlRWxlbWVudDtcclxuICAgICAgICAvLyBzY3JvbGxCYXIudXBkYXRlKCk7XHJcbiAgICAgICAgY29uc3QgbGFzdFNjcm9sbExlZnQgPSBzY3JvbGxCYXIgPyBzY3JvbGxCYXIubGFzdFNjcm9sbExlZnQgOiAwO1xyXG4gICAgICAgIGNvbnN0IGxhc3RTY3JvbGxUb3AgPSBzY3JvbGxCYXIgPyBzY3JvbGxCYXIubGFzdFNjcm9sbFRvcCA6IDA7XHJcblxyXG4gICAgICAgIC8vIGNvbnN0IGxhc3RTY3JvbGxMZWZ0ID0gdGhpcy5zY3JvbGxMZWZ0O1xyXG4gICAgICAgIC8vIGNvbnN0IGxhc3RTY3JvbGxUb3AgPSB0aGlzLnNjcm9sbFRvcDtcclxuXHJcbiAgICAgICAgY29uc3Qgc2Nyb2xsVG9wID0gc2Nyb2xsRWxSZWYuc2Nyb2xsVG9wO1xyXG4gICAgICAgIGNvbnN0IHNjcm9sbExlZnQgPSBzY3JvbGxFbFJlZi5zY3JvbGxMZWZ0O1xyXG5cclxuICAgICAgICBpZiAoIXRvVG9wKSB7XHJcbiAgICAgICAgICAgIGlmIChzY3JvbGxUb3AgIT0gbGFzdFNjcm9sbFRvcCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5wcy5zY3JvbGxUb1RvcChsYXN0U2Nyb2xsVG9wKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuZGdzLm9uU2Nyb2xsTW92ZShsYXN0U2Nyb2xsVG9wLCBTQ1JPTExfWV9BQ1RJT04pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5wcy5zY3JvbGxUb1RvcCgpO1xyXG4gICAgICAgICAgICB0aGlzLmRncy5vblNjcm9sbE1vdmUobGFzdFNjcm9sbFRvcCwgU0NST0xMX1lfQUNUSU9OKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuc2Nyb2xsTGVmdCA9IGxhc3RTY3JvbGxMZWZ0O1xyXG4gICAgICAgIGlmIChzY3JvbGxMZWZ0ICE9IGxhc3RTY3JvbGxMZWZ0KSB7XHJcbiAgICAgICAgICAgIHRoaXMucHMuc2Nyb2xsVG9YKGxhc3RTY3JvbGxMZWZ0KTtcclxuICAgICAgICAgICAgdGhpcy5kZ3Mub25TY3JvbGxNb3ZlKGxhc3RTY3JvbGxMZWZ0LCBTQ1JPTExfWF9BQ1RJT04pO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGlmIChsYXN0U2Nyb2xsTGVmdCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5kZ3Mub25TY3JvbGxNb3ZlKGxhc3RTY3JvbGxMZWZ0LCBTQ1JPTExfWF9BQ1RJT04pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog5pWw5o2u5Y+R55Sf5Y+Y5YyW77yM6YeN5paw5Yqg6L295pWw5o2u5pe25omn6KGMXHJcbiAgICAgKiDph43nva7mu5rliqjmnaHkvY3nva5cclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBvbkRhdGFDaGFuZ2VkKGlzU2FtZUxlbmd0aCA9IHRydWUsIGlzRGlmZnJlbnREYXRhU291cmNlID0gZmFsc2UpIHtcclxuICAgICAgICB0aGlzLmRnLnNldFBhZ2VySGVpZ2h0KCk7XHJcbiAgICAgICAgdGhpcy52aWV3cG9ydEggPSB0aGlzLmdldFZpZXdQb3J0SGVpZ2h0KCk7XHJcbiAgICAgICAgdGhpcy5ib2R5U3R5bGUgPSB0aGlzLmdldEJvZHlTdHlsZSgpO1xyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiB1cGRhdGU6XHJcbiAgICAgICAgICogbm9kZV9tb2R1bGVzXFxwZXJmZWN0LXNjcm9sbGJhclxcdHlwZXNcXHBlcmZlY3Qtc2Nyb2xsYmFyLmQudHNcclxuICAgICAgICAgKiBsYXN0U2Nyb2xsVG9wOiBudW1iZXJcclxuICAgICAgICAgKi9cclxuICAgICAgICBpZiAodGhpcy5wcyAmJiB0aGlzLnBzLmluc3RhbmNlICYmICF0aGlzLmRnLmlzRWRpdGluZygpICYmICF0aGlzLmRnLmNsaWVudEZpbHRlckNoYW5nZWQgJiYgIXRoaXMuZGcuYXV0b0hlaWdodCApIHtcclxuICAgICAgICAgICAgdGhpcy5zY3JvbGxUb3AgPSAwO1xyXG4gICAgICAgICAgICB0aGlzLmxhc3RSZW5kZXJlZFNjcm9sbFRvcCA9IDA7XHJcbiAgICAgICAgICAgIHRoaXMucHMuc2Nyb2xsVG9Ub3AoKTtcclxuICAgICAgICAgICAgdGhpcy5zY3JvbGxMZWZ0ID0gMDtcclxuICAgICAgICAgICAgdGhpcy5wcy5zY3JvbGxUb0xlZnQoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMucm93c0NhY2hlID0ge307XHJcbiAgICAgICAgY29uc3Qga2VlcHNjcm9sbFBvcyA9ICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3Qgc2Nyb2xsSW5mbyA9IHRoaXMuZGcuZGZzLmdldFN0YXRlKCkuc2Nyb2xsSW5mbztcclxuICAgICAgICAgICAgaWYgKHNjcm9sbEluZm8gKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoc2Nyb2xsSW5mby55KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zY3JvbGxUb3AgPSBzY3JvbGxJbmZvLnk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5kZy5zY3JvbGxJbnN0YW5jZS5zY3JvbGxUb1koc2Nyb2xsSW5mby55KTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmRncy5vblNjcm9sbE1vdmUoc2Nyb2xsSW5mby55LCBTQ1JPTExfWV9BQ1RJT04pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGlmIChzY3JvbGxJbmZvLngpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNjcm9sbExlZnQgPSBzY3JvbGxJbmZvLng7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5kZy5zY3JvbGxJbnN0YW5jZS5zY3JvbGxUb1goc2Nyb2xsSW5mby54KTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmRnLmRncy5vblNjcm9sbE1vdmUoc2Nyb2xsSW5mby54LCBTQ1JPTExfWF9BQ1RJT04pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgaWYgKCF0aGlzLmRnLm5vd3JhcCB8fCB0aGlzLmRnLmF1dG9IZWlnaHQpIHtcclxuICAgICAgICAgICAgdGhpcy5yZW5kZXJEYXRhKGZhbHNlKTtcclxuICAgICAgICAgICAgdGhpcy5kZ3MuY2VsbENvbnRlbnRXcmFwQ2hhbmdlZC5uZXh0KHRoaXMud2lkdGgpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGlmIChpc1NhbWVMZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgIGtlZXBzY3JvbGxQb3MoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLnJlbmRlckRhdGEoZmFsc2UpO1xyXG4gICAgICAgICAgICB0aGlzLnBzLnVwZGF0ZSgpO1xyXG4gICAgICAgIH1cclxuICAgICAgIFxyXG5cclxuICAgICAgICBpZiAoaXNEaWZmcmVudERhdGFTb3VyY2UpIHtcclxuICAgICAgICAgICAgdGhpcy5kZy5pbml0U2VsZWN0T3JDaGVja2VkKCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5kZy5yZWZyZXNoU2VsZWN0ZWREYXRhKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuZGcuY2xpZW50RmlsdGVyQ2hhbmdlZCA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuZGF0YUNoYW5nZS5lbWl0KHRoaXMuZGF0YSk7XHJcblxyXG4gICAgICAgIGlmICh0aGlzLmRnLnNjcm9sbEJhclNob3dNb2RlID09PSAnYWxsd2F5cycgJiYgdGhpcy5wcy5pbnN0YW5jZSAmJiAhdGhpcy5kZy5zaG93U2Nyb2xsQXJyb3cpIHtcclxuICAgICAgICAgICAgdGhpcy5oYXNZU2Nyb2xsYmFyKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgZGVzdHJveVN1YnNjcmlwdGlvbnMoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuc3Vic2NyaXB0aW9ucyAmJiB0aGlzLnN1YnNjcmlwdGlvbnMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc3Vic2NyaXB0aW9ucy5mb3JFYWNoKChzdWI6IFN1YnNjcmlwdGlvbikgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKHN1Yikge1xyXG4gICAgICAgICAgICAgICAgICAgIHN1Yi51bnN1YnNjcmliZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIHN1YiA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5zdWJzY3JpcHRpb25zID0gW107XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgbGlzdGVuU3ViamVjdHMoKSB7XHJcbiAgICAgICAgdGhpcy5kZXN0cm95U3Vic2NyaXB0aW9ucygpO1xyXG5cclxuICAgICAgICB0aGlzLmdyaWRTaXplU3Vic2NyaWJlID0gdGhpcy5kZnMuZ3JpZFNpemUkLnBpcGUoXHJcbiAgICAgICAgICAgIHRha2VVbnRpbCh0aGlzLmRlc3Ryb3kkKVxyXG4gICAgICAgICkucGlwZShcclxuICAgICAgICAgICAgZGVib3VuY2VUaW1lKDUwKVxyXG4gICAgICAgICkuc3Vic2NyaWJlKHN0YXRlID0+IHtcclxuICAgICAgICAgICAgaWYgKHN0YXRlKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmRnLnNldFBhZ2VySGVpZ2h0KCk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBoaCA9IHRoaXMuZGcuc2V0SGVhZGVySGVpZ2h0KCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNldFBvc2l0aW9uVG9wKGhoKTtcclxuXHJcbiAgICAgICAgICAgICAgICB0aGlzLmhlaWdodCA9IHN0YXRlLmhlaWdodCAtIHRoaXMudG9wO1xyXG5cclxuICAgICAgICAgICAgICAgIGNvbnN0IG9sZFdpZHRoID0gdGhpcy53aWR0aDtcclxuICAgICAgICAgICAgICAgIHRoaXMud2lkdGggPSBNYXRoLmZsb29yKHN0YXRlLndpZHRoKTtcclxuICAgICAgICAgICAgICAgIHRoaXMucm93SGVpZ2h0ID0gc3RhdGUucm93SGVpZ2h0O1xyXG5cclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmRnLnNob3dCb3JkZXIpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLndpZHRoIC09IDI7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgdGhpcy52aWV3cG9ydFcgPSB0aGlzLndpZHRoO1xyXG4gICAgICAgICAgICAgICAgdGhpcy52aWV3cG9ydEggPSB0aGlzLmdldFZpZXdQb3J0SGVpZ2h0KCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNhbnZhc0hlaWdodCA9IHRoaXMuZ2V0Q2FudmFzSGVpZ2h0KCk7XHJcblxyXG4gICAgICAgICAgICAgICAgdGhpcy5uZ1pvbmUucnVuT3V0c2lkZUFuZ3VsYXIoKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY29sdW1uc0dyb3VwID0gc3RhdGUuY29sdW1uc0dyb3VwO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY2hlY2tTY3JvbGxiYXJQb3NpdGlvbigpO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIHRoaXMuc2V0Rml4ZWRSaWdodFBvc2l0aW9uKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy51cGRhdGVDb2x1bW5TaXplKHN0YXRlLmNvbHVtbnNHcm91cCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZGdzLnNob3dGaXhlZFNoYWRvdy5lbWl0KHsgc2hvd1JpZ2h0U2hhZG93OiB0aGlzLnNob3dSaWdodFNoYWRvdywgeDogdGhpcy5maXhlZFJpZ2h0U2Nyb2xsTGVmdCB9KTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbmRlckRhdGEoZmFsc2UpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBpZiAoKCF0aGlzLmRnLm5vd3JhcCB8fCB0aGlzLmRnLmF1dG9IZWlnaHQpICYmIHRoaXMucm93cyAmJiB0aGlzLnJvd3MubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvbGRXaWR0aCAhPT0gdGhpcy53aWR0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kZ3MuY2VsbENvbnRlbnRXcmFwQ2hhbmdlZC5uZXh0KG9sZFdpZHRoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMua2VlcFNjcm9sbGJhclBvc2l0aW9uKG9sZFdpZHRoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLl9zY3JvbGxYVGltZXIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aGlzLl9zY3JvbGxYVGltZXIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9zY3JvbGxYVGltZXIgPSBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMua2VlcFNjcm9sbGJhclBvc2l0aW9uKG9sZFdpZHRoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSwgMTAwKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgdGhpcy5zdWJzY3JpcHRpb25zLnB1c2godGhpcy5ncmlkU2l6ZVN1YnNjcmliZSk7XHJcblxyXG4gICAgICAgIHRoaXMuY29sdW1uUmVzaXplU3Vic2NyaWJlID0gdGhpcy5kZnMuY29sdW1uUmVzaXplJC5zdWJzY3JpYmUoKGNnOiBDb2x1bW5Hcm91cCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLnVwZGF0ZUNvbHVtblNpemUoY2cpO1xyXG4gICAgICAgICAgICB0aGlzLmNkLmRldGVjdENoYW5nZXMoKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLnN1YnNjcmlwdGlvbnMucHVzaCh0aGlzLmNvbHVtblJlc2l6ZVN1YnNjcmliZSk7XHJcblxyXG4gICAgICAgIHRoaXMuZGdzLnNldFNlbGVjZWRSb3cuc3Vic2NyaWJlKChyOiBhbnkpID0+IHtcclxuICAgICAgICAgICAgaWYgKHIgJiYgci5zZWxlY3RlZCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50Um93SWQgPSByLmlkO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50Um93SWQgPSB1bmRlZmluZWQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLnNlbGVjdFJvd1N1YnNjcmliZSA9IHRoaXMuZGZzLnNlbGVjdFJvdyQuc3Vic2NyaWJlKChyb3c6IFNlbGVjdGVkUm93KSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChyb3cpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudFJvd0lkID0gcm93LmlkO1xyXG4gICAgICAgICAgICAgICAgLy8gMjAyMTA4MTcg5pa55ZCR6ZSu56e75Yqo5ZCO5Yi35paw6KeG5Zu+54q25oCBXHJcbiAgICAgICAgICAgICAgICB0aGlzLmNkLmRldGVjdENoYW5nZXMoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMuc3Vic2NyaXB0aW9ucy5wdXNoKHRoaXMuc2VsZWN0Um93U3Vic2NyaWJlKTtcclxuXHJcbiAgICAgICAgdGhpcy51bnNlbGVjdFJvd1N1YnNjcmliZSA9IHRoaXMuZGZzLnVuU2VsZWN0Um93JC5zdWJzY3JpYmUoKHByZXZSb3c6IFNlbGVjdGVkUm93KSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChwcmV2Um93ICYmIHByZXZSb3cuaWQgPT09IHRoaXMuY3VycmVudFJvd0lkKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRSb3dJZCA9IHVuZGVmaW5lZDtcclxuICAgICAgICAgICAgICAgIHRoaXMuZGcuc2VsZWN0ZWRSb3cgPSBudWxsO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAoIXRoaXMuZGcuZWRpdGFibGUgJiYgdGhpcy5kZy5tdWx0aVNlbGVjdCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fX3RyaWdnZXJCb2R5Q2xpY2tFdmVudCA9IHRoaXMuZGcuc2VsZWN0aW9uTW9kZSA9PT0gJ2RlZmF1bHQnO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB0aGlzLmNkLmRldGVjdENoYW5nZXMoKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLnN1YnNjcmlwdGlvbnMucHVzaCh0aGlzLnVuc2VsZWN0Um93U3Vic2NyaWJlKTtcclxuXHJcbiAgICAgICAgdGhpcy5zZWxlY3RBbGxTdWJzY3JpYmUgPSB0aGlzLmRmcy5zZWxlY3RBbGwkLnN1YnNjcmliZSgocm93czogU2VsZWN0ZWRSb3dbXSkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLmRnLnNlbGVjdEFsbC5lbWl0KHJvd3MpO1xyXG4gICAgICAgICAgICB0aGlzLmNkLmRldGVjdENoYW5nZXMoKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLnN1YnNjcmlwdGlvbnMucHVzaCh0aGlzLnNlbGVjdEFsbFN1YnNjcmliZSk7XHJcblxyXG4gICAgICAgIHRoaXMuY2hlY2tSb3dTdWJzY3JpYmUgPSB0aGlzLmRmcy5jaGVja1JvdyQuc3Vic2NyaWJlKChyb3c6IFNlbGVjdGVkUm93KSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuZGcuY2hlY2tlZC5lbWl0KHJvdyk7XHJcbiAgICAgICAgICAgIHRoaXMuY2hlY2tlZFJvd3NDaGFuZ2VkKCk7XHJcbiAgICAgICAgICAgIC8vIHRoaXMuY2QuZGV0ZWN0Q2hhbmdlcygpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMuc3Vic2NyaXB0aW9ucy5wdXNoKHRoaXMuY2hlY2tSb3dTdWJzY3JpYmUpO1xyXG5cclxuICAgICAgICB0aGlzLmNsZWFyU2VsZWN0aW9uc1N1YnNjcmliZSA9IHRoaXMuZGZzLmNsZWFyU2VsZWN0aW9ucyQuc3Vic2NyaWJlKCgpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5jdXJyZW50Um93SWQgPSB1bmRlZmluZWQ7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmRnLmNoZWNrT25TZWxlY3QpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuY2hlY2tlZFJvd3NDaGFuZ2VkKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5kZy51blNlbGVjdEFsbC5lbWl0KCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5zdWJzY3JpcHRpb25zLnB1c2godGhpcy5jbGVhclNlbGVjdGlvbnNTdWJzY3JpYmUpO1xyXG5cclxuICAgICAgICB0aGlzLnVuY2hlY2tSb3dTdWJzY3JpYmUgPSB0aGlzLmRmcy51bkNoZWNrUm93JC5zdWJzY3JpYmUoKHByZXZSb3c6IFNlbGVjdGVkUm93KSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuZGcudW5DaGVja2VkLmVtaXQocHJldlJvdyk7XHJcbiAgICAgICAgICAgIHRoaXMuY2hlY2tlZFJvd3NDaGFuZ2VkKCk7XHJcbiAgICAgICAgICAgIC8vIHRoaXMuY2QuZGV0ZWN0Q2hhbmdlcygpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMuc3Vic2NyaXB0aW9ucy5wdXNoKHRoaXMudW5jaGVja1Jvd1N1YnNjcmliZSk7XHJcblxyXG4gICAgICAgIHRoaXMuY2hlY2tBbGxTdWJzY3JpYmUgPSB0aGlzLmRmcy5jaGVja0FsbCQuc3Vic2NyaWJlKChyb3dzOiBTZWxlY3RlZFJvd1tdKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuZGcuY2hlY2tBbGwuZW1pdChyb3dzKTtcclxuICAgICAgICAgICAgdGhpcy5jaGVja2VkUm93c0NoYW5nZWQoKTtcclxuICAgICAgICAgICAgLy8gdGhpcy5jZC5kZXRlY3RDaGFuZ2VzKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5zdWJzY3JpcHRpb25zLnB1c2godGhpcy5jaGVja0FsbFN1YnNjcmliZSk7XHJcblxyXG4gICAgICAgIHRoaXMuY2xlYXJDaGVja2Vkc1N1YnNjcmliZSA9IHRoaXMuZGZzLmNsZWFyQ2hlY2tlZHMkLnN1YnNjcmliZSgocm93czogU2VsZWN0ZWRSb3dbXSkgPT4ge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5kZy5zZWxlY3RPbkNoZWNrKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRSb3dJZCA9IHVuZGVmaW5lZDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLmRnLnVuQ2hlY2tBbGwuZW1pdChyb3dzKTtcclxuICAgICAgICAgICAgdGhpcy5jaGVja2VkUm93c0NoYW5nZWQoKTtcclxuICAgICAgICAgICAgdGhpcy5jZC5kZXRlY3RDaGFuZ2VzKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5zdWJzY3JpcHRpb25zLnB1c2godGhpcy5jbGVhckNoZWNrZWRzU3Vic2NyaWJlKTtcclxuXHJcbiAgICAgICAgdGhpcy5zdWJzY3JpcHRpb25zLnB1c2godGhpcy5kZ3Muc2V0U2Nyb2xsYmFyUG9zaXRpb24uc3Vic2NyaWJlKCgpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5jaGVja1Njcm9sbGJhclBvc2l0aW9uKCk7XHJcbiAgICAgICAgICAgIHRoaXMudXBkYXRlU2Nyb2xsUG9zaXRpb24odGhpcy5zY3JvbGxMZWZ0KTtcclxuICAgICAgICB9KSk7XHJcblxyXG4gICAgICAgIHRoaXMuZGdzLmNvbHVtblJlc2l6ZWQucGlwZShcclxuICAgICAgICAgICAgZGVsYXkoMTAwKVxyXG4gICAgICAgICkuc3Vic2NyaWJlKChlOiBhbnkpID0+IHtcclxuICAgICAgICAgICAgaWYgKCF0aGlzLmRnLm5vd3JhcCB8fFxyXG4gICAgICAgICAgICAgICAgKHRoaXMuZGcuY3VycmVudENlbGwgJiYgdGhpcy5kZy5jdXJyZW50Q2VsbC5pc0VkaXRpbmcgJiYgdGhpcy5kZy5jdXJyZW50Q2VsbC5jb2x1bW4gJiZcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmRnLmN1cnJlbnRDZWxsLmNvbHVtbi5lZGl0b3IgJiYgdGhpcy5kZy5jdXJyZW50Q2VsbC5jb2x1bW4uZWRpdG9yLnR5cGUgPT09ICd0ZXh0YXJlYScpKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0cmRvbXMgPSB0aGlzLmRnLmRnQ29udGFpbmVyLm5hdGl2ZUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmYtZGF0YWdyaWQtYm9keS1yb3c6bm90KC5mLWRhdGFncmlkLWZvb3Rlci1yb3cpJyk7XHJcbiAgICAgICAgICAgICAgICB0cmRvbXMuZm9yRWFjaChuID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbmRlci5zZXRTdHlsZShuLCAnaGVpZ2h0JywgJ2F1dG8nKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgIGxldCB0cklEID0gJyc7XHJcbiAgICAgICAgICAgICAgICBpZiAoZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHJvd0lkID0gZS5pZDtcclxuICAgICAgICAgICAgICAgICAgICB0cklEID0gVFJfUFJFRklYICsgcm93SWQ7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgdGhpcy51cGRhdGVSb3dIZWlnaHQodHJJRCk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmICh0aGlzLmRnLmhlYWRlcldyYXApIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZGcuc2V0SGVhZGVySGVpZ2h0KCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmRmcy5jb2x1bW5SZXNpemVFbmQoKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgdGhpcy5kZ3MuY2VsbENvbnRlbnRXcmFwQ2hhbmdlZC5waXBlKFxyXG4gICAgICAgICAgICB0YWtlVW50aWwodGhpcy5kZXN0cm95JCksXHJcbiAgICAgICAgICAgIGRlYm91bmNlVGltZSgxMDApXHJcbiAgICAgICAgKS5zdWJzY3JpYmUoKG9sZFdpZHRoOiBudW1iZXIpID0+IHtcclxuICAgICAgICAgICAgdGhpcy51cGRhdGVSb3dIZWlnaHQoKTtcclxuICAgICAgICAgICAgaWYgKG9sZFdpZHRoICE9IG51bGwpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMua2VlcFNjcm9sbGJhclBvc2l0aW9uKG9sZFdpZHRoKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHRoaXMucHMgJiYgdGhpcy5wcy5pbnN0YW5jZSAmJiB0aGlzLnBzLmluc3RhbmNlLnVwZGF0ZSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG5cclxuICAgICAgICB0aGlzLmRnLmRmcy5yb3dVcGRhdGUkLnN1YnNjcmliZSgocm93OiB7IGluZGV4OiBudW1iZXIsIGRhdGE6IGFueSB9KSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChyb3cgJiYgcm93LmRhdGEpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuYnVpbGRDdXN0b21DZWxsU3R5bGUocm93KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpZiAodGhpcy5kZy5ncm91cFJvd3MpIHtcclxuICAgICAgICAgICAgdGhpcy5kZnMuZXhwYW5kR3JvdXBSb3cucGlwZShcclxuICAgICAgICAgICAgICAgIHRha2VVbnRpbCh0aGlzLmRlc3Ryb3kkKVxyXG4gICAgICAgICAgICApLnN1YnNjcmliZSgoZTogYW55KSA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAoZSAmJiBlLmRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmdyb3VwUm93U3RhdGVDaGFuZ2VkKGUuZGF0YSwgdHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7dGhpcy51cGRhdGVSb3dIZWlnaHQoKTt9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHRoaXMuZGZzLmNvbGxhcHNlR3JvdXBSb3cucGlwZShcclxuICAgICAgICAgICAgICAgIHRha2VVbnRpbCh0aGlzLmRlc3Ryb3kkKVxyXG4gICAgICAgICAgICApLnN1YnNjcmliZSgoZTogYW55KSA9PntcclxuICAgICAgICAgICAgICAgIGlmIChlICYmIGUuZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZ3JvdXBSb3dTdGF0ZUNoYW5nZWQoZS5kYXRhLCBmYWxzZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGdyb3VwUm93RXhwYW5kVXBkYXRlKGdyb3VwUm93LCBpc0V4cGFuZCkge1xyXG4gICAgICAgIGlmIChncm91cFJvdy5yb3dzICYmIGdyb3VwUm93LnJvd3MubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIGdyb3VwUm93LnJvd3MuZm9yRWFjaChuID0+IHtcclxuICAgICAgICAgICAgICAgIGlmIChuW0lTX0dST1VQX0ZPT1RFUl9ST1dfRklFTERdKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5kYXRhLmZpbHRlcih0ID0+IHRbR1JPVVBfUk9XX0ZJRUxEXSA9PT0gbltHUk9VUF9ST1dfRklFTERdKS5mb3JFYWNoKGQgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkW0dST1VQX1ZJU0lCTEVfRklFTERdID0gaXNFeHBhbmQgJiYgZ3JvdXBSb3cuZXhwYW5kZWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGl0ZW0gPSB0aGlzLmRhdGEuZmluZChlID0+IGUuaWQgPT09IG4uaWQpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChpdGVtKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW1bR1JPVVBfVklTSUJMRV9GSUVMRF0gPSBpc0V4cGFuZCAmJiBncm91cFJvdy5leHBhbmRlZDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGl0ZW0ucm93cyAmJiBpdGVtLnJvd3MubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmdyb3VwUm93RXhwYW5kVXBkYXRlKGl0ZW0sIGlzRXhwYW5kKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuXHJcblxyXG4gICAgcHJpdmF0ZSBncm91cFJvd1N0YXRlQ2hhbmdlZChyb3dEYXRhLCBleHBhbmQ6IGJvb2xlYW4pIHtcclxuICAgICAgICBpZiAodGhpcy5kZy52aXJ0dWFsaXplZCkge1xyXG4gICAgICAgICAgICBjb25zdCBnciA9IHRoaXMuZGF0YS5maW5kKG4gPT4gbi5pZCA9PT0gcm93RGF0YS5pZCk7XHJcbiAgICAgICAgICAgIHRoaXMuZ3JvdXBSb3dFeHBhbmRVcGRhdGUoZ3IsIGV4cGFuZCk7XHJcbiAgICAgICAgICAgIHRoaXMucmVuZGVyRGF0YShmYWxzZSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5nZXRDYW52YXNIZWlnaHQoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICh0aGlzWydfcHNVcGRhdGVUaW1lcl8nXSkge1xyXG4gICAgICAgICAgICBjbGVhclRpbWVvdXQodGhpc1snX3BzVXBkYXRlVGltZXJfJ10pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpc1snX3BzVXBkYXRlVGltZXJfJ10gPSBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5wcy51cGRhdGUoKTtcclxuICAgICAgICAgICAgdGhpcy5jZC5kZXRlY3RDaGFuZ2VzKCk7XHJcbiAgICAgICAgfSwgMTAwKVxyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUga2VlcFNjcm9sbGJhclBvc2l0aW9uKG9sZFdpZHRoOiBudW1iZXIpIHtcclxuICAgICAgICBpZiAoIXRoaXMuY2RbXCJkZXN0cm95ZWRcIl0pIHtcclxuICAgICAgICAgICAgdGhpcy5jZC5kZXRlY3RDaGFuZ2VzKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoIXRoaXMucHMuaW5zdGFuY2UpIHtcclxuICAgICAgICAgICAgcmV0dXJuOyAgIFxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHRoaXNbXCJrZWVwU2Nyb2xsYmFyUG9zaXRpb25USU1FUlwiXSkge1xyXG4gICAgICAgICAgICBjbGVhclRpbWVvdXQodGhpc1tcImtlZXBTY3JvbGxiYXJQb3NpdGlvblRJTUVSXCJdKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXNbXCJrZWVwU2Nyb2xsYmFyUG9zaXRpb25USU1FUlwiXSA9IHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgICBpZiAodGhpcy53aWR0aCA+IG9sZFdpZHRoKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB4ID0gdGhpcy5zY3JvbGxMZWZ0IC0gKHRoaXMud2lkdGggLSBvbGRXaWR0aCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnBzLmVsZW1lbnRSZWYubmF0aXZlRWxlbWVudC5zY3JvbGxMZWZ0ID0geCA8IDAgPyAwIDogeDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoIXRoaXMuZGcubm93cmFwIHx8IHRoaXMuZGcuYXV0b0hlaWdodCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy51cGRhdGVDYW52YXNIZWlnaHQoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLnBzLnVwZGF0ZSgpO1xyXG4gICAgICAgICAgICB0aGlzLnVwZGF0ZVNjcm9sbFBvc2l0aW9uKHRoaXMucHMuZWxlbWVudFJlZi5uYXRpdmVFbGVtZW50LnNjcm9sbExlZnQpO1xyXG4gICAgICAgICAgICB0aGlzLmRncy5zY3JvbGxiYXJVcGRhdGUuZW1pdCh7IHNjcm9sbGJhclJlZjogdGhpcy5wcy5pbnN0YW5jZSwgcmlnaHRXaWR0aDogdGhpcy5yaWdodEZpeGVkV2lkdGgsIHNob3dSaWdodFNoYWRvdzogdGhpcy5zaG93UmlnaHRTaGFkb3cgIH0pO1xyXG4gICAgICAgIH0sIDUwKTtcclxuICAgIH1cclxuXHJcblxyXG4gICAgcHJpdmF0ZSB1cGRhdGVDb2x1bW5TaXplKGNnOiBDb2x1bW5Hcm91cCkge1xyXG4gICAgICAgIGlmIChjZykge1xyXG4gICAgICAgICAgICB0aGlzLmNvbHVtbnNHcm91cCA9IGNnO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgdGhpcy5sZWZ0Rml4ZWRXaWR0aCA9IHRoaXMuY29sdW1uc0dyb3VwLmxlZnRGaXhlZFdpZHRoO1xyXG4gICAgICAgICAgICB0aGlzLmNvbHNXaWR0aCA9IHRoaXMuY29sdW1uc0dyb3VwLm5vcm1hbFdpZHRoO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5zY3JvbGxMZWZ0ID0gdGhpcy5wcy5lbGVtZW50UmVmLm5hdGl2ZUVsZW1lbnQuc2Nyb2xsTGVmdDtcclxuICAgICAgICAgICAgdGhpcy5tYXhTY3JvbGxMZWZ0ID0gdGhpcy5jb2xzV2lkdGggKyB0aGlzLmxlZnRGaXhlZFdpZHRoO1xyXG4gICAgICAgICAgICB0aGlzLmZpeGVkUmlnaHRTY3JvbGxMZWZ0ID0gdGhpcy5tYXhTY3JvbGxMZWZ0O1xyXG4gICAgICAgICAgICAvLyBncmlkIOWuueWZqOWuveW6plxyXG4gICAgICAgICAgICBjb25zdCBkZ0NvbnRhaW5lcldpZHRoID0gdGhpcy5kZy5kZ0NvbnRhaW5lci5uYXRpdmVFbGVtZW50Lm9mZnNldFdpZHRoO1xyXG4gICAgICAgICAgICAvLyDmiYDmnInliJflrr3kuYvlkoxcclxuICAgICAgICAgICAgY29uc3QgYWxsQ29sc1dpZHRoID0gTWF0aC5mbG9vcih0aGlzLmNvbHVtbnNHcm91cC50b3RhbFdpZHRoKTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuYm9keVN0eWxlID0gdGhpcy5nZXRCb2R5U3R5bGUoKTtcclxuICAgICAgICAgICAgaWYgKGRnQ29udGFpbmVyV2lkdGggPiBhbGxDb2xzV2lkdGggfHwgZGdDb250YWluZXJXaWR0aCA9PT0gYWxsQ29sc1dpZHRoKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNob3dSaWdodFNoYWRvdyA9IGZhbHNlO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zaG93UmlnaHRTaGFkb3cgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgLy8g5Y+z5L6n5Zu65a6a5YiX55qE5L2N572uXHJcbiAgICAgICAgICAgICAgICB0aGlzLmZpeGVkUmlnaHRTY3JvbGxMZWZ0ID0gdGhpcy53aWR0aCAgKyB0aGlzLnNjcm9sbExlZnQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5zZXRGaXhlZFJpZ2h0V2lkdGgoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBzZXRGaXhlZFJpZ2h0V2lkdGgoKSB7XHJcbiAgICAgICAgdGhpcy5yaWdodEZpeGVkV2lkdGggPSB0aGlzLmNvbHVtbnNHcm91cC5yaWdodEZpeGVkV2lkdGg7XHJcbiAgICAgICAgdGhpcy50b3RhbFdpZHRoID0gdGhpcy5jb2x1bW5zR3JvdXAudG90YWxXaWR0aDtcclxuICAgICAgICBpZiAodGhpcy5wcyAmJiB0aGlzLnBzLmluc3RhbmNlICYmIHRoaXMuZGcuc2Nyb2xsQmFyU2hvd01vZGUgPT09ICdhbGx3YXlzJykge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5wcy5pbnN0YW5jZS5zY3JvbGxiYXJZQWN0aXZlKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnJpZ2h0Rml4ZWRXaWR0aCArPSAxODtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGJ1aWxkQ3VzdG9tQ2VsbFN0eWxlKHJvdzogeyBpbmRleDogbnVtYmVyLCBkYXRhOiBhbnkgfSkge1xyXG5cclxuICAgICAgICBsZXQgcmlnaHRUcnMgPSBbXTtcclxuICAgICAgICBsZXQgbGVmdFRycyA9IFtdO1xyXG4gICAgICAgIGlmICh0aGlzLmZpeGVkUmlnaHRFbCkge1xyXG4gICAgICAgICAgICByaWdodFRycyA9IHRoaXMuZml4ZWRSaWdodEVsLm5hdGl2ZUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCgndHInKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICh0aGlzLmZpeGVkTGVmdEVsKSB7XHJcbiAgICAgICAgICAgIGxlZnRUcnMgPSB0aGlzLmZpeGVkTGVmdEVsLm5hdGl2ZUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmZpeGVkLWxlZnQtcm93Jyk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zdCB0cnMgPSB0aGlzLm1haW5BcmVhLm5hdGl2ZUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCgndHIuZi1kYXRhZ3JpZC1ib2R5LXJvdycpO1xyXG5cclxuICAgICAgICBjb25zdCB1cGRhdGVDZWxsU3R5bGUgPSAoYXJyLCBjb2wsIHN0eWxlKSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChhcnIubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ZCA9IGFycltyb3cuaW5kZXhdLnF1ZXJ5U2VsZWN0b3IoYFtmaWVsZD1cIiR7Y29sLmZpZWxkfVwiXWApO1xyXG4gICAgICAgICAgICAgICAgaWYgKHRkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5kZy5yZW5kZXJDdXN0b21TdHlsZShzdHlsZSwgdGQpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdGhpcy5kZy5mbGF0Q29sdW1ucy5mb3JFYWNoKGNvbCA9PiB7XHJcbiAgICAgICAgICAgIGlmIChjb2wuc3R5bGVyKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBfcmQgPSByb3cuZGF0YTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHZhbCA9IFV0aWxzLmdldFZhbHVlKGNvbC5maWVsZCwgX3JkKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGNzID0gY29sLnN0eWxlcih2YWwsIF9yZCwgcm93LmluZGV4KTtcclxuICAgICAgICAgICAgICAgIGlmIChjcyAmJiBPYmplY3Qua2V5cyhjcykubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdXBkYXRlQ2VsbFN0eWxlKGxlZnRUcnMsIGNvbCwgY3MpO1xyXG4gICAgICAgICAgICAgICAgICAgIHVwZGF0ZUNlbGxTdHlsZShyaWdodFRycywgY29sLCBjcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgdXBkYXRlQ2VsbFN0eWxlKHRycywgY29sLCBjcyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGNoZWNrZWRSb3dzQ2hhbmdlZCgpIHtcclxuICAgICAgICB0aGlzLmRncy5vbkNoZWNrZWRSb3dzQ291bnRDaGFuZ2UoKTtcclxuICAgICAgICBjb25zdCBjaGVja2VkUm93cyA9IHRoaXMuZGcuY2hlY2tlZHM7XHJcbiAgICAgICAgdGhpcy5kZy5jaGVja1ZhbHVlcyA9IGNoZWNrZWRSb3dzLm1hcChyID0+IHIuaWQpO1xyXG4gICAgICAgIHRoaXMuZGcuY2hlY2tWYWx1ZXNDaGFuZ2UuZW1pdCh0aGlzLmRnLmNoZWNrVmFsdWVzKTtcclxuICAgICAgICB0aGlzLmRnLmNoZWNrZWRDaGFuZ2UuZW1pdChjaGVja2VkUm93cyk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBnZXRUckRvbUhlaWdodCgpIHtcclxuICAgICAgICBjb25zdCBsaXN0ID0gW107XHJcbiAgICAgICAgbGV0IHJpZ2h0VHJzID0gW107XHJcbiAgICAgICAgbGV0IGxlZnRUcnMgPSBbXTtcclxuICAgICAgICBsZXQgdHJkb21zID0gW107XHJcbiAgICAgICAgaWYgKHRoaXMuZml4ZWRSaWdodEVsKSB7XHJcbiAgICAgICAgICAgIHJpZ2h0VHJzID0gdGhpcy5maXhlZFJpZ2h0RWwubmF0aXZlRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKCd0cicpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHRoaXMuZml4ZWRMZWZ0RWwpIHtcclxuICAgICAgICAgICAgbGVmdFRycyA9IHRoaXMuZml4ZWRMZWZ0RWwubmF0aXZlRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuZml4ZWQtbGVmdC1yb3cnKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICh0aGlzLm1haW5BcmVhKSB7XHJcbiAgICAgICAgICAgIHRyZG9tcyA9IHRoaXMubWFpbkFyZWEubmF0aXZlRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKCd0ci5mLWRhdGFncmlkLWJvZHktcm93Jyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRyZG9tcy5mb3JFYWNoKCh0ciwgaSkgPT4ge1xyXG4gICAgICAgICAgICBsZXQgdDEgPSAwO1xyXG4gICAgICAgICAgICBjb25zdCB0MiA9IE1hdGguY2VpbCh0ci5vZmZzZXRIZWlnaHQpO1xyXG4gICAgICAgICAgICBsZXQgdDMgPSAwO1xyXG4gICAgICAgICAgICBpZiAobGVmdFRycyAmJiBsZWZ0VHJzLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgdDEgPSBNYXRoLmNlaWwobGVmdFRyc1tpXS5vZmZzZXRIZWlnaHQpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAocmlnaHRUcnMgJiYgcmlnaHRUcnMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICB0MyA9IE1hdGguY2VpbChyaWdodFRyc1tpXS5vZmZzZXRIZWlnaHQpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjb25zdCBfaCA9IE1hdGgubWF4KHQxLCB0MiwgdDMsIHRoaXMuZGcucm93SGVpZ2h0KTtcclxuICAgICAgICAgICAgbGlzdC5wdXNoKF9oKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4gbGlzdDtcclxuICAgIH1cclxuXHJcblxyXG4gICAgdXBkYXRlUm93SGVpZ2h0MigpIHtcclxuICAgICAgICBsZXQgcmlnaHRUcnMgPSBbXTtcclxuICAgICAgICBsZXQgbGVmdFRycyA9IFtdO1xyXG4gICAgICAgIGxldCB0cmRvbXMgPSBbXTtcclxuICAgICAgICBpZiAodGhpcy5maXhlZFJpZ2h0RWwpIHtcclxuICAgICAgICAgICAgcmlnaHRUcnMgPSB0aGlzLmZpeGVkUmlnaHRFbC5uYXRpdmVFbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ3RyJyk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAodGhpcy5maXhlZExlZnRFbCkge1xyXG4gICAgICAgICAgICBsZWZ0VHJzID0gdGhpcy5maXhlZExlZnRFbC5uYXRpdmVFbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5maXhlZC1sZWZ0LXJvdycpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHRoaXMubWFpbkFyZWEpIHtcclxuICAgICAgICAgICAgdHJkb21zID0gdGhpcy5tYWluQXJlYS5uYXRpdmVFbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ3RyLmYtZGF0YWdyaWQtYm9keS1yb3cnKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRyZG9tcy5mb3JFYWNoKCh0cjogYW55LCBpKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMucmVtb3ZlUm93SGVpZ2h0Q2xzKHRyKTtcclxuICAgICAgICAgICAgaWYgKGxlZnRUcnMgJiYgbGVmdFRyc1tpXSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5yZW1vdmVSb3dIZWlnaHRDbHMobGVmdFRyc1tpXSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHJpZ2h0VHJzICYmIHJpZ2h0VHJzW2ldKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnJlbW92ZVJvd0hlaWdodENscyhyaWdodFRyc1tpXSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaWYgKHRoaXNbJ1VQREFURV9ST1dfSEVJR0hUX1RJTUVSJ10pIHtcclxuICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHRoaXNbJ1VQREFURV9ST1dfSEVJR0hUX1RJTUVSJ10pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpc1snVVBEQVRFX1JPV19IRUlHSFRfVElNRVInXSA9IHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgICB0cmRvbXMuZm9yRWFjaCgodHIsIGkpID0+IHtcclxuICAgICAgICAgICAgICAgIGxldCB0MSA9IDA7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0MiA9IE1hdGguY2VpbCh0ci5vZmZzZXRIZWlnaHQpO1xyXG4gICAgICAgICAgICAgICAgbGV0IHQzID0gMDtcclxuXHJcbiAgICAgICAgICAgICAgICBsZXQgbGVmdFRyID0gbnVsbDtcclxuICAgICAgICAgICAgICAgIGxldCByaWdodFRyID0gbnVsbDtcclxuICAgICAgICAgICAgICAgIGlmIChsZWZ0VHJzICYmIGxlZnRUcnMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdDEgPSBNYXRoLmNlaWwobGVmdFRyc1tpXS5vZmZzZXRIZWlnaHQpO1xyXG4gICAgICAgICAgICAgICAgICAgIGxlZnRUciA9IGxlZnRUcnNbaV1cclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBpZiAocmlnaHRUcnMgJiYgcmlnaHRUcnMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdDMgPSBNYXRoLmNlaWwocmlnaHRUcnNbaV0ub2Zmc2V0SGVpZ2h0KTtcclxuICAgICAgICAgICAgICAgICAgICByaWdodFRyID0gcmlnaHRUcnNbaV07XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgY29uc3QgX2ggPSBNYXRoLm1heCh0MSwgdDIsIHQzLCB0aGlzLmRnLnJvd0hlaWdodCk7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLmRnLm5vd3JhcCB8fCB0aGlzLmRnLmF1dG9IZWlnaHQpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBoZWlnaHRDbHNOYW1lID0gV09SRFdSQVBfUk9XX0hFSUdIVF9DTFMgKyAnXycgKyBfaDtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBtaW5Sb3dIZWlnaHRDbHNOYW1lID0gJ21pbl9yb3dfaGVpZ2h0XycgKyB0aGlzLnJvd0hlaWdodDtcclxuICAgICAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBfYWRkUm93SGVpZ2h0Q2xzVG9Eb20gPSAodHJkb20pID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW1vdmVSb3dIZWlnaHRDbHModHJkb20pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbmRlci5hZGRDbGFzcyh0cmRvbSwgaGVpZ2h0Q2xzTmFtZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyLmFkZENsYXNzKHRyZG9tLCBtaW5Sb3dIZWlnaHRDbHNOYW1lKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYWRkUm93SGVpZ2h0Q2xzKGhlaWdodENsc05hbWUsIF9oKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgX2FkZFJvd0hlaWdodENsc1RvRG9tKHRyKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGxlZnRUcikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYWRkUm93SGVpZ2h0Q2xzVG9Eb20obGVmdFRyKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChyaWdodFRyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hZGRSb3dIZWlnaHRDbHNUb0RvbShyaWdodFRyKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0sIDEwMCk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSByZW1vdmVSb3dIZWlnaHRDbHModHIpIHtcclxuICAgICAgICBpZiAoIXRyKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgX2NscyA9IEFycmF5LmZyb20odHIuY2xhc3NMaXN0KS5maW5kKChuOiBzdHJpbmcpID0+IG4uaW5kZXhPZihXT1JEV1JBUF9ST1dfSEVJR0hUX0NMUykgPiAtMSk7XHJcbiAgICAgICAgaWYgKF9jbHMpIHtcclxuICAgICAgICAgICAgdHIuY2xhc3NMaXN0LnJlbW92ZShfY2xzKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBhZGRSb3dIZWlnaHRDbHMoaGVpZ2h0Q2xzTmFtZTogc3RyaW5nLCBfaDogbnVtYmVyKSB7XHJcbiAgICAgICAgdGhpcy5kZ3MucmVtb3ZlQ3NzUnVsZShgJHt0aGlzLmRnLmN1c3RvbVN0eWxlS2V5KCl9IC4ke2hlaWdodENsc05hbWV9YCk7XHJcbiAgICAgICAgdGhpcy5kZy5yZW5kZXJDdXN0b21TdHlsZTIoe3N0eWxlOiB7IGhlaWdodDogX2ggKyAncHghaW1wb3J0YW50JyB9fSwgbnVsbCwgaGVpZ2h0Q2xzTmFtZSk7XHJcbiAgICB9XHJcblxyXG5cclxuICAgIC8qKiDlhYHorrjmlbDmja7mipjooYzml7bvvIzorqHnrpfooYzlj7fnmoTooYzpq5ggKi9cclxuICAgIHVwZGF0ZVJvd0hlaWdodCh0ckRvbUlkID0gbnVsbCkge1xyXG4gICAgICAgIGlmICh0aGlzLmZhc3QpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKCF0aGlzLm1haW5BcmVhKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IGRnQm9keSA9IHRoaXMuZWwubmF0aXZlRWxlbWVudC5xdWVyeVNlbGVjdG9yKCdkaXYuZi1kYXRhZ3JpZC1ib2R5Jyk7XHJcbiAgICAgICAgaWYgKGRnQm9keSkge1xyXG4gICAgICAgICAgICBpZiAoIXRoaXMuZGcubm93cmFwIHx8IHRoaXMuZGcuYXV0b0hlaWdodCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5yZW5kZXIuYWRkQ2xhc3MoZGdCb2R5LCAnZGF0YS13cmFwJyk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnJlbmRlci5yZW1vdmVDbGFzcyhkZ0JvZHksICdkYXRhLXdyYXAnKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuXHJcbiAgICAgICAgaWYgKCF0ckRvbUlkKSB7XHJcbiAgICAgICAgICAgIHRoaXMudXBkYXRlUm93SGVpZ2h0MigpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHRyID0gVXRpbHMuZ2V0VHJEb21CeUlkKHRyRG9tSWQsIGRvY3VtZW50KTtcclxuICAgICAgICAgICAgaWYgKCF0cikge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjb25zdCBsZWZ0VHJJZCA9IHRyRG9tSWQgKyAnX2ZpeGVkbGVmdCc7XHJcbiAgICAgICAgICAgIGNvbnN0IHJpZ2h0VHJJZCA9IHRyRG9tSWQgKyAnX2ZpeGVkcmlnaHQnO1xyXG4gICAgICAgICAgICBjb25zdCBsZWZ0VHIgPSBVdGlscy5nZXRUckRvbUJ5SWQobGVmdFRySWQsIGRvY3VtZW50KTtcclxuICAgICAgICAgICAgY29uc3QgcmlnaHRUciA9IFV0aWxzLmdldFRyRG9tQnlJZChyaWdodFRySWQsIGRvY3VtZW50KTtcclxuICAgICAgICAgICAgdGhpcy5yZW1vdmVSb3dIZWlnaHRDbHModHIpO1xyXG4gICAgICAgICAgICB0aGlzLnJlbW92ZVJvd0hlaWdodENscyhsZWZ0VHIpO1xyXG4gICAgICAgICAgICB0aGlzLnJlbW92ZVJvd0hlaWdodENscyhyaWdodFRyKTtcclxuXHJcblxyXG4gICAgICAgICAgICBjb25zdCBfYXJyID0gW107XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmZpeGVkUmlnaHRFbCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgcnRyID0gVXRpbHMuZ2V0VHJEb21CeUlkKHRyRG9tSWQsIHRoaXMuZml4ZWRSaWdodEVsLm5hdGl2ZUVsZW1lbnQpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHJ0cikge1xyXG4gICAgICAgICAgICAgICAgICAgIF9hcnIucHVzaChNYXRoLmNlaWwocnRyLm9mZnNldEhlaWdodCkpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAodGhpcy5maXhlZExlZnRFbCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbHRyID0gVXRpbHMuZ2V0VHJEb21CeUlkKHRyRG9tSWQsIHRoaXMuZml4ZWRMZWZ0RWwubmF0aXZlRWxlbWVudCk7XHJcbiAgICAgICAgICAgICAgICBpZiAobHRyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgX2Fyci5wdXNoKE1hdGguY2VpbChsdHIub2Zmc2V0SGVpZ2h0KSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmICh0aGlzLm1haW5BcmVhKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ciA9IFV0aWxzLmdldFRyRG9tQnlJZCh0ckRvbUlkLCB0aGlzLm1haW5BcmVhLm5hdGl2ZUVsZW1lbnQpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHRyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgX2Fyci5wdXNoKE1hdGguY2VpbCh0ci5vZmZzZXRIZWlnaHQpKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgY29uc3QgX2ggPSBNYXRoLm1heCguLi5fYXJyKTtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IGhlaWdodENsc05hbWUgPSBXT1JEV1JBUF9ST1dfSEVJR0hUX0NMUyArICdfJyArIF9oO1xyXG5cclxuICAgICAgICAgICAgaWYgKCF0aGlzLmRnLm5vd3JhcCB8fCB0aGlzLmRnLmF1dG9IZWlnaHQpIHtcclxuXHJcbiAgICAgICAgICAgICAgICB0aGlzLnJlbmRlci5hZGRDbGFzcyh0ciwgaGVpZ2h0Q2xzTmFtZSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmFkZFJvd0hlaWdodENscyhoZWlnaHRDbHNOYW1lLCBfaCk7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKGxlZnRUcikge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyLmFkZENsYXNzKGxlZnRUciwgaGVpZ2h0Q2xzTmFtZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKHJpZ2h0VHIpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbmRlci5hZGRDbGFzcyhyaWdodFRyLCBoZWlnaHRDbHNOYW1lKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy51cGRhdGVDYW52YXNIZWlnaHQoKTtcclxuXHJcbiAgICAgICAgLy8g56e76ZmkaGVpZ2h0OiBhdXRvXHJcbiAgICAgICAgY29uc3QgdHJkb21zID0gdGhpcy5kZy5kZ0NvbnRhaW5lci5uYXRpdmVFbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5mLWRhdGFncmlkLWJvZHktcm93Om5vdChmLWRhdGFncmlkLWZvb3Rlci1yb3cpJyk7XHJcbiAgICAgICAgdHJkb21zLmZvckVhY2gobiA9PiBuLnN0eWxlLmhlaWdodCA9ICcnKTtcclxuXHJcbiAgICAgICAgaWYgKCF0aGlzLmNkWydkZXN0cm95ZWQnXSkge1xyXG4gICAgICAgICAgICB0aGlzLmNkLmRldGVjdENoYW5nZXMoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG5cclxuICAgIHByaXZhdGUgZ2V0Qm9keVN0eWxlKCkge1xyXG4gICAgICAgIGxldCBoID0gdGhpcy5nZXRWaWV3UG9ydEhlaWdodCgpO1xyXG4gICAgICAgIGlmICghdGhpcy5kYXRhLmxlbmd0aCkge1xyXG5cclxuICAgICAgICAgICAgaWYgKHRoaXMuZGcudXNlQmxhbmtXaGVuRGF0YUlzRW1wdHkpIHtcclxuICAgICAgICAgICAgICAgIGggPSB0aGlzLmRnLmVtcHR5RGF0YUhlaWdodDtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmRnLmF1dG9IZWlnaHQpIHtcclxuICAgICAgICAgICAgICAgICAgICBoID0gdGhpcy5kZy5lbXB0eURhdGFIZWlnaHQ7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuZGcuZm9vdGVyRGF0YSAmJiB0aGlzLmRnLnNob3dGb290ZXIpIHtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgZmQgPSB0aGlzLmRnLmZvb3RlckRhdGE7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuZGcuZm9vdGVyRGF0YS5zdWJzY3JpYmUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZmQgPSB0aGlzLmRnLmZvb3RlckRhdGFbJ3ZhbHVlJ107XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICBpZiAoZmQgJiYgQXJyYXkuaXNBcnJheShmZCkgJiYgZmQubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGggPSBoIC0gdGhpcy5kZy5mb290ZXJIZWlnaHQ7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5kZy5mb290ZXJQb3NpdGlvbiA9PT0gJ2JvdGgnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoID0gaCAtIHRoaXMuZGcuZm9vdGVySGVpZ2h0O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIHtcclxuXHJcbiAgICAgICAgICAgIGlmICh0aGlzLmRnLnNob3dGb290ZXIgJiYgdGhpcy5kZy5mb290ZXJQb3NpdGlvbiA9PT0gJ2JvdGgnKSB7XHJcbiAgICAgICAgICAgICAgICBoID0gaCAtIHRoaXMuZGcuZm9vdGVySGVpZ2h0O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIGhlaWdodDogYCR7TWF0aC5mbG9vcihoKSArIDF9cHhgXHJcbiAgICAgICAgfTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIHVwZGF0ZVNjcm9sbFBvc2l0aW9uKHNjcm9sbExlZnQ6IGFueSkge1xyXG4gICAgICAgIHRoaXMuc2Nyb2xsTGVmdCA9IHNjcm9sbExlZnQ7XHJcblxyXG4gICAgICAgIHRoaXMuZml4ZWRSaWdodFNjcm9sbExlZnQgPSB0aGlzLnNjcm9sbExlZnQgKyB0aGlzLndpZHRoIC0gdGhpcy5yaWdodEZpeGVkV2lkdGg7XHJcbiAgICAgICAgaWYgKHRoaXMuZml4ZWRSaWdodFNjcm9sbExlZnQgPT09IHRoaXMubWF4U2Nyb2xsTGVmdCB8fCB0aGlzLmZpeGVkUmlnaHRTY3JvbGxMZWZ0ID4gdGhpcy5tYXhTY3JvbGxMZWZ0KSB7XHJcbiAgICAgICAgICAgIHRoaXMuZml4ZWRSaWdodFNjcm9sbExlZnQgPSB0aGlzLm1heFNjcm9sbExlZnQ7XHJcbiAgICAgICAgICAgIHRoaXMuc2hvd1JpZ2h0U2hhZG93ID0gZmFsc2U7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5zaG93UmlnaHRTaGFkb3cgPSB0cnVlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHRoaXMuZml4ZWRMZWZ0RWwpIHtcclxuICAgICAgICAgICAgdGhpcy5yZW5kZXIuc2V0U3R5bGUodGhpcy5maXhlZExlZnRFbC5uYXRpdmVFbGVtZW50LCAndHJhbnNmb3JtJywgYHRyYW5zbGF0ZTNkKCR7dGhpcy5zY3JvbGxMZWZ0fXB4LCAwcHgsIDBweClgKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICh0aGlzLmZpeGVkUmlnaHRFbCkge1xyXG4gICAgICAgICAgICBsZXQgbCA9IHRoaXMuZGcud2lkdGggLSAodGhpcy5kZy5zaG93Qm9yZGVyID8gMiA6IDApIC0gdGhpcy5jb2x1bW5zR3JvdXAucmlnaHRGaXhlZFdpZHRoO1xyXG4gICAgICAgICAgICBpZiAodGhpcy5wcyAmJiB0aGlzLnBzLmluc3RhbmNlICYmIHRoaXMucHMuaW5zdGFuY2Uuc2Nyb2xsYmFyWUFjdGl2ZSAmJiB0aGlzLmRnLnNjcm9sbEJhclNob3dNb2RlID09PSAnYWxsd2F5cycpIHtcclxuICAgICAgICAgICAgICAgIGwgLT0gMTg7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgbGV0IHJlYWxXaWR0aCA9IHRoaXMuY29sdW1uc0dyb3VwLmxlZnRGaXhlZFdpZHRoICsgdGhpcy5jb2x1bW5zR3JvdXAubm9ybWFsV2lkdGggKyB0aGlzLmNvbHVtbnNHcm91cC5yaWdodEZpeGVkV2lkdGg7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmRnLndpZHRoIC0gKHRoaXMuZGcuc2hvd0JvcmRlciA/IDIgOiAwKSA+IHJlYWxXaWR0aCkge1xyXG4gICAgICAgICAgICAgICAgbCA9IHRoaXMuY29sdW1uc0dyb3VwLmxlZnRGaXhlZFdpZHRoICsgdGhpcy5jb2x1bW5zR3JvdXAubm9ybWFsV2lkdGg7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgbCArPSB0aGlzLnNjcm9sbExlZnQ7XHJcblxyXG4gICAgICAgICAgICB0aGlzLmZpeGVkUmlnaHRTY3JvbGxMZWZ0ID0gbDtcclxuICAgICAgICAgICAgdGhpcy5yZW5kZXIuc2V0U3R5bGUodGhpcy5maXhlZFJpZ2h0RWwubmF0aXZlRWxlbWVudCwgJ3RyYW5zZm9ybScsIGB0cmFuc2xhdGUzZCgke3RoaXMuZml4ZWRSaWdodFNjcm9sbExlZnR9cHgsIDBweCwgMHB4KWApO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBvblNjcm9sbFRvWCgkZXZlbnQ6IGFueSkge1xyXG4gICAgICAgIGNvbnN0IHggPSAkZXZlbnQudGFyZ2V0LnNjcm9sbExlZnQ7XHJcbiAgICAgICAgdGhpcy51cGRhdGVTY3JvbGxQb3NpdGlvbih4KTtcclxuICAgICAgICAvLyB0aGlzLmNkLmRldGVjdENoYW5nZXMoKTtcclxuICAgICAgICB0aGlzLmRncy5vblNjcm9sbE1vdmUoeCwgU0NST0xMX1hfQUNUSU9OKTtcclxuICAgICAgICB0aGlzLmRmcy51cGRhdGVQcm9wZXJ0eSgnc2Nyb2xsSW5mbycsIHsgeTogJGV2ZW50LnRhcmdldC5zY3JvbGxUb3AsIHggfSk7XHJcbiAgICAgICAgdGhpcy5kZ3Muc2hvd0ZpeGVkU2hhZG93LmVtaXQoeyBzaG93UmlnaHRTaGFkb3c6IHRoaXMuc2hvd1JpZ2h0U2hhZG93LCB4OiB0aGlzLmZpeGVkUmlnaHRTY3JvbGxMZWZ0IH0pO1xyXG4gICAgfVxyXG5cclxuICAgIG9uU2Nyb2xsVG9ZKCRldmVudDogYW55KSB7XHJcblxyXG4gICAgICAgIGlmICh0aGlzLl9zY3JvbGxUaW1lcikge1xyXG4gICAgICAgICAgICBjbGVhclRpbWVvdXQodGhpcy5fc2Nyb2xsVGltZXIpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5fc2Nyb2xsVGltZXIgPSBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgeSA9ICRldmVudC50YXJnZXQuc2Nyb2xsVG9wO1xyXG5cclxuICAgICAgICAgICAgaWYgKHRoaXMuZGcudmlydHVhbGl6ZWQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlU2Nyb2xsKCk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHRoaXMuc2Nyb2xsVG9wID0geTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuZGZzLnVwZGF0ZVByb3BlcnR5KCdzY3JvbGxJbmZvJywgeyB5LCB4OiAkZXZlbnQudGFyZ2V0LnNjcm9sbExlZnQgfSk7XHJcblxyXG4gICAgICAgICAgICB0aGlzLmRnLnNjcm9sbFkuZW1pdCh5KTtcclxuICAgICAgICAgICAgdGhpcy5kZ3Mub25TY3JvbGxNb3ZlKHksIFNDUk9MTF9ZX0FDVElPTik7XHJcbiAgICAgICAgfSwgMTAwKTtcclxuICAgIH1cclxuXHJcbiAgICBvblBzWFJlYWNoU3RhcnQoJGV2ZW50OiBhbnkpIHtcclxuICAgICAgICBjb25zdCB4ID0gJGV2ZW50LnRhcmdldC5zY3JvbGxMZWZ0O1xyXG4gICAgICAgIHRoaXMudXBkYXRlU2Nyb2xsUG9zaXRpb24oeCk7XHJcbiAgICAgICAgdGhpcy5kZ3Mub25TY3JvbGxNb3ZlKHgsIFNDUk9MTF9YX1JFQUNIX1NUQVJUX0FDVElPTik7XHJcbiAgICB9XHJcblxyXG4gICAgb25Qc1hSZWFjaEVuZCgkZXZlbnQ6IGFueSkge1xyXG4gICAgICAgIHRoaXMuc2hvd1JpZ2h0U2hhZG93ID0gZmFsc2U7XHJcbiAgICAgICAgLy8gY29uc3QgeCA9ICRldmVudC50YXJnZXQuc2Nyb2xsTGVmdDtcclxuICAgICAgICAvLyB0aGlzLnVwZGF0ZVNjcm9sbFBvc2l0aW9uKHgpO1xyXG4gICAgICAgIC8vIHRoaXMuY2QuZGV0ZWN0Q2hhbmdlcygpO1xyXG4gICAgICAgIC8vIC8vIHRoaXMuZGdzLm9uU2hvd0ZpeGVkU2hhZG93KHRoaXMuc2hvd1JpZ2h0U2hhZG93KTtcclxuICAgICAgICAvLyB0aGlzLmRncy5vblNjcm9sbE1vdmUoeCwgU0NST0xMX1hfUkVBQ0hfRU5EX0FDVElPTik7XHJcbiAgICB9XHJcblxyXG4gICAgaXNDaGVja2VkKHJvd0RhdGE6IGFueSkge1xyXG4gICAgICAgIGlmIChyb3dEYXRhKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmRmcy5pc1Jvd0NoZWNrZWQocm93RGF0YVt0aGlzLmRnLmlkRmllbGRdKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGlzU2VsZWN0ZWQocm93RGF0YTogYW55KSB7XHJcbiAgICAgICAgaWYgKHJvd0RhdGEpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZGZzLmlzUm93U2VsZWN0ZWQocm93RGF0YVt0aGlzLmRnLmlkRmllbGRdKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIHRvZ2dsZUdyb3VwUm93KHJvdywgb3BlbiA9IHRydWUpIHtcclxuICAgICAgICByb3cuZXhwYW5kZWQgPSBvcGVuO1xyXG4gICAgICAgIHRoaXMucHMudXBkYXRlKCk7XHJcbiAgICB9XHJcblxyXG5cclxuXHJcbiAgICAvKiogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0g5YiGID09PT09PSDpmpQgPT09PT09IOe6vyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSAqL1xyXG5cclxuICAgIC8qKiDojrflj5blj6/op4bljLrln5/pq5jluqYgKi9cclxuICAgIHB1YmxpYyBnZXRWaWV3UG9ydEhlaWdodCgpIHtcclxuICAgICAgICBsZXQgdmlld1BvcnRIZWlnaHQgPSB0aGlzLmRnLmhlaWdodDtcclxuICAgICAgICBpZiAodGhpcy5kZy5zaG93SGVhZGVyKSB7XHJcbiAgICAgICAgICAgIHZpZXdQb3J0SGVpZ2h0ID0gdmlld1BvcnRIZWlnaHQgLSB0aGlzLmRnLnJlYWxIZWFkZXJIZWlnaHQ7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoKHRoaXMuZGcuZW5hYmxlRmlsdGVyUm93IHx8IHRoaXMuZGcuZW5hYmxlU21hcnRGaWx0ZXIpICYmIHRoaXMuZGcuc2hvd0ZpbHRlckJhcikge1xyXG4gICAgICAgICAgICB2aWV3UG9ydEhlaWdodCAtPSB0aGlzLmRnLmZpbHRlckJhckhlaWdodDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICh0aGlzLmRnLnNob3dSb3dHcm91cFBhbmVsKSB7XHJcbiAgICAgICAgICAgIHZpZXdQb3J0SGVpZ2h0IC09IHRoaXMuZGcucm93R3JvdXBQYW5lbEhlaWdodDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICh0aGlzLmRnLnNob3dGb290ZXIgJiYgdGhpcy5kYXRhLmxlbmd0aCkge1xyXG4gICAgICAgICAgICB2aWV3UG9ydEhlaWdodCA9IHZpZXdQb3J0SGVpZ2h0IC0gdGhpcy5kZy5mb290ZXJIZWlnaHQ7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAodGhpcy5kZy5wYWdpbmF0aW9uKSB7XHJcbiAgICAgICAgICAgIHZpZXdQb3J0SGVpZ2h0ID0gdmlld1BvcnRIZWlnaHQgLSB0aGlzLmRnLnBhZ2VySGVpZ2h0IC0gMjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICh0aGlzLmRnLnNob3dCb3JkZXIpIHtcclxuICAgICAgICAgICAgdmlld1BvcnRIZWlnaHQgLT0gMjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMudmlld3BvcnRIID0gdmlld1BvcnRIZWlnaHQ7XHJcbiAgICAgICAgcmV0dXJuIHZpZXdQb3J0SGVpZ2h0O1xyXG4gICAgfVxyXG5cclxuICAgIC8vIOS4jeaKmOihjOaXtu+8jOaJgOacieaVsOaNrueahOmrmOW6plxyXG4gICAgcHJpdmF0ZSBhbGxSb3dzSGVpZ2h0KCkge1xyXG4gICAgICAgIGNvbnN0IHJvd0hlaWdodHBhdGNoID0gMTsgIC8vIHRoaXMuZGcuYXV0b0hlaWdodCA/IDIgOiAxO1xyXG4gICAgICAgIGNvbnN0IHJvd0hlaWdodCA9IHRoaXMuZGcucm93SGVpZ2h0ICsgcm93SGVpZ2h0cGF0Y2g7XHJcblxyXG4gICAgICAgIGxldCBpdGVtc0NvdW50ID0gMDtcclxuICAgICAgICBpZiAodGhpcy5kZy5ncm91cFJvd3MpIHtcclxuICAgICAgICAgICAgY29uc3QgZGF0YSA9IHRoaXMuZGF0YS5maWx0ZXIobiA9PiBuWydfX2dyb3VwX3Zpc2libGVfXyddIHx8IG5bJ19fZ3JvdXBfdmlzaWJsZV9fJ109PT11bmRlZmluZWQpO1xyXG4gICAgICAgICAgICBpZiAodGhpcy5kZy5ncm91cFN1bW1hcnlQb3NpdGlvbiA9PT0gJ2luR3JvdXBSb3cnKSB7XHJcbiAgICAgICAgICAgICAgICBpdGVtc0NvdW50ID0gZGF0YS5maWx0ZXIobiA9PiAhblsnX19ncm91cF9mb290ZXJfXyddKS5sZW5ndGg7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBpdGVtc0NvdW50ID0gZGF0YS5sZW5ndGg7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBpdGVtc0NvdW50ID0gdGhpcy5kYXRhLmxlbmd0aDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGxldCBoID0gaXRlbXNDb3VudCAqIHJvd0hlaWdodDtcclxuXHJcbiAgICAgICAgaWYgKHRoaXMuZGcuYXV0b0hlaWdodCkge1xyXG4gICAgICAgICAgICBoICs9IGl0ZW1zQ291bnQ7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgaCArPSAyO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIGg7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBnZXRDYW52YXNIZWlnaHQoKSB7XHJcbiAgICAgICAgbGV0IGNhbnZhc0hlaWdodCA9IDA7XHJcblxyXG4gICAgICAgIGlmICghdGhpcy5kYXRhIHx8ICF0aGlzLmRhdGEubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2FudmFzSGVpZ2h0ID0gMDtcclxuICAgICAgICAgICAgcmV0dXJuIDA7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAodGhpcy5kZy5ub3dyYXApIHtcclxuICAgICAgICAgICAgLy8gdGZzIDU3MjAyMlxyXG4gICAgICAgICAgICBpZiAodGhpcy5kZy5tYXhIZWlnaHQgJiYgdGhpcy5kZy5hdXRvSGVpZ2h0ICYmIHRoaXMubWFpbkFyZWEpIHtcclxuICAgICAgICAgICAgICAgIGNhbnZhc0hlaWdodCA9IE1hdGguZmxvb3IodGhpcy5tYWluQXJlYS5uYXRpdmVFbGVtZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLmhlaWdodCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBjYW52YXNIZWlnaHQgPSB0aGlzLmFsbFJvd3NIZWlnaHQoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGNhbnZhc0hlaWdodCA9IHRoaXMuZ2V0VHJEb21IZWlnaHQoKS5yZWR1Y2UoKHIsIGMpID0+IHIgKyBjLCAwKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICghY2FudmFzSGVpZ2h0KSB7XHJcbiAgICAgICAgICAgIGNhbnZhc0hlaWdodCA9IHRoaXMudmlld3BvcnRIO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY2FudmFzSGVpZ2h0ID0gY2FudmFzSGVpZ2h0ICsgKHRoaXMuZGcuc2Nyb2xsQmFyU2hvd01vZGUgPT09ICdhbGx3YXlzJyAmJiAodGhpcy5wcy5pbnN0YW5jZSAmJiB0aGlzLnBzLmluc3RhbmNlWydzY3JvbGxiYXJYQWN0aXZlJ10pID8gMTggOiAwKTtcclxuICAgICAgICB0aGlzLmNhbnZhc0hlaWdodCA9IGNhbnZhc0hlaWdodDtcclxuICAgICAgICByZXR1cm4gY2FudmFzSGVpZ2h0O1xyXG4gICAgfVxyXG5cclxuICAgIHVwZGF0ZUNhbnZhc0hlaWdodCgpIHtcclxuICAgICAgICB0aGlzLmNhbnZhc0hlaWdodCA9IHRoaXMuZ2V0Q2FudmFzSGVpZ2h0KCk7XHJcbiAgICB9XHJcblxyXG5cclxuICAgIHByaXZhdGUgZ2V0Um93RnJvbVBvc2l0aW9uKHkpIHtcclxuICAgICAgICByZXR1cm4gTWF0aC5mbG9vcih5IC8gKHRoaXMuZGcucm93SGVpZ2h0ICsgMSkpO1xyXG4gICAgfVxyXG5cclxuICAgIGdldFZpc2libGVSYW5nZSh2aWV3cG9ydFRvcD86IG51bWJlciwgdmlld3BvcnRMZWZ0PzogbnVtYmVyKSB7XHJcbiAgICAgICAgaWYgKHZpZXdwb3J0VG9wID09IG51bGwpIHtcclxuICAgICAgICAgICAgdmlld3BvcnRUb3AgPSB0aGlzLnNjcm9sbFRvcDtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHZpZXdwb3J0TGVmdCA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHZpZXdwb3J0TGVmdCA9IHRoaXMuc2Nyb2xsTGVmdDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHRvcDogdGhpcy5nZXRSb3dGcm9tUG9zaXRpb24odmlld3BvcnRUb3ApLFxyXG4gICAgICAgICAgICBib3R0b206IHRoaXMuZ2V0Um93RnJvbVBvc2l0aW9uKHZpZXdwb3J0VG9wICsgdGhpcy52aWV3cG9ydEgpICsgMSxcclxuICAgICAgICAgICAgbGVmdFB4OiB2aWV3cG9ydExlZnQsXHJcbiAgICAgICAgICAgIHJpZ2h0UHg6IHZpZXdwb3J0TGVmdCArIHRoaXMudmlld3BvcnRXXHJcbiAgICAgICAgfTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGdldFJlbmRlcmVkUmFuZ2Uodmlld3BvcnRUb3A/OiBudW1iZXIsIHZpZXdwb3J0TGVmdD86IG51bWJlcikge1xyXG4gICAgICAgIGNvbnN0IHJhbmdlID0gdGhpcy5nZXRWaXNpYmxlUmFuZ2Uodmlld3BvcnRUb3AsIHZpZXdwb3J0TGVmdCk7XHJcbiAgICAgICAgY29uc3QgYnVmZmVyID0gTWF0aC5yb3VuZCh0aGlzLnZpZXdwb3J0SCAvICh0aGlzLmRnLnJvd0hlaWdodCArIDEpKTtcclxuICAgICAgICBjb25zdCBtaW5CdWZmZXIgPSB0aGlzLm1pblJvd0J1ZmZlcjtcclxuXHJcbiAgICAgICAgaWYgKHRoaXMudlNjcm9sbERpciA9PSAtMSkge1xyXG4gICAgICAgICAgICByYW5nZS50b3AgLT0gYnVmZmVyO1xyXG4gICAgICAgICAgICByYW5nZS5ib3R0b20gKz0gbWluQnVmZmVyO1xyXG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy52U2Nyb2xsRGlyID09IDEpIHtcclxuICAgICAgICAgICAgcmFuZ2UudG9wIC09IG1pbkJ1ZmZlcjtcclxuICAgICAgICAgICAgcmFuZ2UuYm90dG9tICs9IGJ1ZmZlcjtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByYW5nZS50b3AgLT0gbWluQnVmZmVyO1xyXG4gICAgICAgICAgICByYW5nZS5ib3R0b20gKz0gbWluQnVmZmVyO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmFuZ2UudG9wID0gTWF0aC5tYXgoMCwgcmFuZ2UudG9wKTtcclxuICAgICAgICByYW5nZS5ib3R0b20gPSBNYXRoLm1pbih0aGlzLmRhdGEubGVuZ3RoIC0gMSwgcmFuZ2UuYm90dG9tKTtcclxuXHJcbiAgICAgICAgcmFuZ2UubGVmdFB4IC09IHRoaXMudmlld3BvcnRXO1xyXG4gICAgICAgIHJhbmdlLnJpZ2h0UHggKz0gdGhpcy52aWV3cG9ydFc7XHJcblxyXG4gICAgICAgIHJhbmdlLmxlZnRQeCA9IE1hdGgubWF4KDAsIHJhbmdlLmxlZnRQeCk7XHJcbiAgICAgICAgcmFuZ2UucmlnaHRQeCA9IE1hdGgubWluKHRoaXMuY2FudmFzV2lkdGgsIHJhbmdlLnJpZ2h0UHgpO1xyXG5cclxuICAgICAgICByZXR1cm4gcmFuZ2U7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSByZW5kZXJSb3dzKHJhbmdlKSB7XHJcbiAgICAgICAgY29uc3Qgcm93cyA9IFtdO1xyXG4gICAgICAgIGxldCBkYXRhTGVuZ3RoID0gdGhpcy5kYXRhLmxlbmd0aDtcclxuICAgICAgICBsZXQgX2RhdGEgPSAgdGhpcy5kYXRhO1xyXG5cclxuICAgICAgICAgLy8g5ZCv55So5YiG57uEXHJcbiAgICAgICAgaWYgKHRoaXMuZGcuZ3JvdXBSb3dzICYmIHRoaXMuZGcuZ3JvdXBGaWVsZCkge1xyXG4gICAgICAgICAgICBfZGF0YSA9ICBfZGF0YS5maWx0ZXIobiA9PiBuWydfX2dyb3VwX3Zpc2libGVfXyddIHx8IG5bJ19fZ3JvdXBfdmlzaWJsZV9fJ109PT11bmRlZmluZWQpO1xyXG5cclxuICAgICAgICAgICAgaWYgKHRoaXMuZGcuZ3JvdXBTdW1tYXJ5UG9zaXRpb24gPT09ICdpbkdyb3VwUm93Jykge1xyXG4gICAgICAgICAgICAgICAgX2RhdGEgPSBfZGF0YS5maWx0ZXIobiA9PiAhblsnX19ncm91cF9mb290ZXJfXyddKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZGF0YUxlbmd0aCA9IF9kYXRhLmxlbmd0aDtcclxuICAgICAgICAgICAgdGhpcy5yb3dzQ2FjaGUgPSB7fTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZvciAobGV0IGkgPSByYW5nZS50b3A7IGkgPD0gcmFuZ2UuYm90dG9tOyBpKyspIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMucm93c0NhY2hlW2ldIHx8IChpID09IGRhdGFMZW5ndGgpICkge1xyXG4gICAgICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJvd3MucHVzaChpKTtcclxuXHJcbiAgICAgICAgICAgIC8vIENyZWF0ZSBhbiBlbnRyeSByaWdodCBhd2F5IHNvIHRoYXQgYXBwZW5kUm93SHRtbCgpIGNhblxyXG4gICAgICAgICAgICAvLyBzdGFydCBwb3B1bGF0YXRpbmcgaXQuXHJcbiAgICAgICAgICAgIHRoaXMucm93c0NhY2hlW2ldID0ge1xyXG4gICAgICAgICAgICAgICAgcm93Tm9kZTogbnVsbCxcclxuXHJcbiAgICAgICAgICAgICAgICAvLyBDb2xTcGFucyBvZiByZW5kZXJlZCBjZWxscyAoYnkgY29sdW1uIGlkeCkuXHJcbiAgICAgICAgICAgICAgICAvLyBDYW4gYWxzbyBiZSB1c2VkIGZvciBjaGVja2luZyB3aGV0aGVyIGEgY2VsbCBoYXMgYmVlbiByZW5kZXJlZC5cclxuICAgICAgICAgICAgICAgIGNlbGxDb2xTcGFuczogW10sXHJcblxyXG4gICAgICAgICAgICAgICAgLy8gQ2VsbCBub2RlcyAoYnkgY29sdW1uIGlkeCkuICBMYXp5LXBvcHVsYXRlZCBieSBlbnN1cmVDZWxsTm9kZXNJblJvd3NDYWNoZSgpLlxyXG4gICAgICAgICAgICAgICAgY2VsbE5vZGVzQnlDb2x1bW5JZHg6IFtdLFxyXG5cclxuICAgICAgICAgICAgICAgIC8vIENvbHVtbiBpbmRpY2VzIG9mIGNlbGwgbm9kZXMgdGhhdCBoYXZlIGJlZW4gcmVuZGVyZWQsIGJ1dCBub3QgeWV0IGluZGV4ZWQgaW5cclxuICAgICAgICAgICAgICAgIC8vIGNlbGxOb2Rlc0J5Q29sdW1uSWR4LiAgVGhlc2UgYXJlIGluIHRoZSBzYW1lIG9yZGVyIGFzIGNlbGwgbm9kZXMgYWRkZWQgYXQgdGhlXHJcbiAgICAgICAgICAgICAgICAvLyBlbmQgb2YgdGhlIHJvdy5cclxuICAgICAgICAgICAgICAgIGNlbGxSZW5kZXJRdWV1ZTogW11cclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZvciAobGV0IGkgPSAwLCBpaSA9IHJvd3MubGVuZ3RoOyBpIDwgaWk7IGkrKykge1xyXG4gICAgICAgICAgICB0aGlzLnJvd3NDYWNoZVtyb3dzW2ldXS5yb3dOb2RlID0gX2RhdGFbcm93c1tpXV07XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gT2JqZWN0LmtleXModGhpcy5yb3dzQ2FjaGUpLm1hcChuID0+IHRoaXMucm93c0NhY2hlW25dLnJvd05vZGUpLmZpbHRlcihuID0+IG4pO1xyXG4gICAgfVxyXG5cclxuXHJcbiAgICBwcml2YXRlIHJlbW92ZVJvd0Zyb21DYWNoZShyb3cpIHtcclxuICAgICAgICBjb25zdCBjYWNoZUVudHJ5ID0gdGhpcy5yb3dzQ2FjaGVbcm93XTtcclxuICAgICAgICBpZiAoIWNhY2hlRW50cnkpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZGVsZXRlIHRoaXMucm93c0NhY2hlW3Jvd107XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBjbGVhbnVwUm93cyhyYW5nZVRvS2VlcCkge1xyXG4gICAgICAgIGZvciAoY29uc3QgaSBpbiB0aGlzLnJvd3NDYWNoZSkge1xyXG4gICAgICAgICAgICBpZiAoaSA8IHJhbmdlVG9LZWVwLnRvcCB8fCBpID4gcmFuZ2VUb0tlZXAuYm90dG9tKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnJlbW92ZVJvd0Zyb21DYWNoZShpKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBoYXNZU2Nyb2xsYmFyKHNob3dZc2Nyb2xsYmFyPzogYm9vbGVhbikge1xyXG4gICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgICBzaG93WXNjcm9sbGJhciA9IHNob3dZc2Nyb2xsYmFyID09IHVuZGVmaW5lZCA/IHRoaXMucHMuaW5zdGFuY2Uuc2Nyb2xsYmFyWUFjdGl2ZTogc2hvd1lzY3JvbGxiYXI7XHJcbiAgICAgICAgICAgIGNvbnN0IGhhc1kgPSBzaG93WXNjcm9sbGJhciAmJiB0aGlzLmRnLnNjcm9sbEJhclNob3dNb2RlID09PSAnYWxsd2F5cycgPyAxOCA6IDA7XHJcbiAgICAgICAgICAgIHRoaXMuZGZzLnVwZGF0ZVByb3BlcnR5KCdzY3JvbGxiYXJZJywgaGFzWSk7XHJcbiAgICAgICAgICAgIHRoaXMuZGZzLnJlc2l6ZSgpO1xyXG4gICAgICAgIH0sIDYwKTtcclxuICAgIH1cclxuXHJcbiAgICBvbkNsaWNrU2Nyb2xsQXJyb3coJGV2ZW50KSB7XHJcbiAgICAgICAgY29uc3QgeyBkaXIsIGV2ZW50IH0gPSAkZXZlbnQ7XHJcbiAgICAgICAgaWYgKHRoaXMucHMgJiYgdGhpcy5wcy5pbnN0YW5jZSkge1xyXG4gICAgICAgICAgICBjb25zdCB7IHgsIHkgfSA9IHRoaXMucHMuaW5zdGFuY2UucmVhY2g7XHJcbiAgICBcclxuICAgICAgICAgICAgc3dpdGNoKGRpcikge1xyXG4gICAgICAgICAgICAgICAgY2FzZSAnbGVmdCc6XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHghPT0gJ3N0YXJ0Jykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnZpZXdTY3JvbGxDb250YWluZXIubmF0aXZlRWxlbWVudC5zY3JvbGxMZWZ0ID0gdGhpcy52aWV3U2Nyb2xsQ29udGFpbmVyLm5hdGl2ZUVsZW1lbnQuc2Nyb2xsTGVmdCAtIDQwO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgJ3JpZ2h0JzpcclxuICAgICAgICAgICAgICAgICAgICBpZiAoeCE9PSAnZW5kJykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnZpZXdTY3JvbGxDb250YWluZXIubmF0aXZlRWxlbWVudC5zY3JvbGxMZWZ0ID0gdGhpcy52aWV3U2Nyb2xsQ29udGFpbmVyLm5hdGl2ZUVsZW1lbnQuc2Nyb2xsTGVmdCArIDQwO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgJ3RvcCc6XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHkgIT09ICdzdGFydCcpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy52aWV3U2Nyb2xsQ29udGFpbmVyLm5hdGl2ZUVsZW1lbnQuc2Nyb2xsVG9wID0gdGhpcy52aWV3U2Nyb2xsQ29udGFpbmVyLm5hdGl2ZUVsZW1lbnQuc2Nyb2xsVG9wIC0gNDA7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSAnYm90dG9tJzpcclxuICAgICAgICAgICAgICAgICAgICBpZiAoeSAhPT0gJ2VuZCcpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy52aWV3U2Nyb2xsQ29udGFpbmVyLm5hdGl2ZUVsZW1lbnQuc2Nyb2xsVG9wID0gdGhpcy52aWV3U2Nyb2xsQ29udGFpbmVyLm5hdGl2ZUVsZW1lbnQuc2Nyb2xsVG9wICsgNDA7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB0aGlzLnBzLnVwZGF0ZSgpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIHJlbmRlckRhdGEoZGV0ZWN0Y2hhbmdlcyA9IHRydWUpIHtcclxuICAgICAgICB0aGlzLmNhbnZhc0hlaWdodCA9IHRoaXMuZ2V0Q2FudmFzSGVpZ2h0KCk7XHJcbiAgICAgICAgaWYgKCF0aGlzLmRnLnZpcnR1YWxpemVkIHx8IHRoaXMuZGcuYXV0b0hlaWdodCkge1xyXG4gICAgICAgICAgICB0aGlzLnJvd3MgPSB0aGlzLmRhdGE7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgY29uc3QgdmlzaWJsZSA9IHRoaXMuZ2V0VmlzaWJsZVJhbmdlKCk7XHJcbiAgICAgICAgICAgIGNvbnN0IHJlbmRlcmVkID0gdGhpcy5nZXRSZW5kZXJlZFJhbmdlKCk7XHJcblxyXG4gICAgICAgICAgICAvLyByZW1vdmUgcm93cyBubyBsb25nZXIgaW4gdGhlIHZpZXdwb3J0XHJcbiAgICAgICAgICAgIHRoaXMuY2xlYW51cFJvd3MocmVuZGVyZWQpO1xyXG5cclxuICAgICAgICAgICAgLy8gcmVuZGVyIG1pc3Npbmcgcm93c1xyXG4gICAgICAgICAgICB0aGlzLnJvd3MgPSB0aGlzLnJlbmRlclJvd3MocmVuZGVyZWQpO1xyXG4gICAgICAgICAgICB0aGlzLnN0YXJ0Um93SW5kZXggPSByZW5kZXJlZC50b3A7XHJcbiAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHRoaXMubGFzdFJlbmRlcmVkU2Nyb2xsVG9wID0gdGhpcy5zY3JvbGxUb3A7XHJcbiAgICAgICAgICAgIHRoaXMubGFzdFJlbmRlcmVkU2Nyb2xsTGVmdCA9IHRoaXMuc2Nyb2xsTGVmdDtcclxuXHJcblxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgdGhpcy5ibGFua1RvcEhlaWdodCA9IHRoaXMuc3RhcnRSb3dJbmRleCAqICh0aGlzLmRnLnJvd0hlaWdodCArIDEpO1xyXG4gICAgICAgICAgICB0aGlzLmJsYW5rQm90dG9tSGVpZ2h0ID0gdGhpcy5jYW52YXNIZWlnaHQgLSB0aGlzLmJsYW5rVG9wSGVpZ2h0IC0gKHRoaXMucm93cy5sZW5ndGggKiAodGhpcy5kZy5yb3dIZWlnaHQgKyAxKSk7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmRnLnNjcm9sbEJhclNob3dNb2RlID09PSAnYWxsd2F5cycgJiYgdGhpcy5wcyAmJiB0aGlzLnBzLmluc3RhbmNlICYmIHRoaXMucHMuaW5zdGFuY2Uuc2Nyb2xsYmFyWEFjdGl2ZSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5ibGFua0JvdHRvbUhlaWdodCArPSAyMjtcclxuICAgICAgICAgICAgfVxyXG5cclxuXHJcbiAgICAgICAgICAgIGlmIChkZXRlY3RjaGFuZ2VzKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNkLmRldGVjdENoYW5nZXMoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGhhbmRsZVNjcm9sbCgpIHtcclxuICAgICAgICB0aGlzLnNjcm9sbFRvcCA9IHRoaXMucHMuZWxlbWVudFJlZi5uYXRpdmVFbGVtZW50LnNjcm9sbFRvcDtcclxuICAgICAgICB0aGlzLnNjcm9sbExlZnQgPSB0aGlzLnBzLmVsZW1lbnRSZWYubmF0aXZlRWxlbWVudC5zY3JvbGxMZWZ0O1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9oYW5kbGVTY3JvbGwoKTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIF9oYW5kbGVTY3JvbGwoKSB7XHJcbiAgICAgICAgY29uc3Qgdmlld3BvcnRDb250YWluZXIgPSB0aGlzLnZpZXdTY3JvbGxDb250YWluZXIubmF0aXZlRWxlbWVudDtcclxuICAgICAgICBsZXQgbWF4U2Nyb2xsRGlzdGFuY2VZID0gdmlld3BvcnRDb250YWluZXIuc2Nyb2xsSGVpZ2h0IC0gdmlld3BvcnRDb250YWluZXIuY2xpZW50SGVpZ2h0O1xyXG4gICAgICAgIGxldCBtYXhTY3JvbGxEaXN0YW5jZVggPSB2aWV3cG9ydENvbnRhaW5lci5zY3JvbGxXaWR0aCAtIHZpZXdwb3J0Q29udGFpbmVyLmNsaWVudFdpZHRoO1xyXG5cclxuICAgICAgICAvLyBQcm90ZWN0IGFnYWluc3QgZXJyb25lb3VzIGNsaWVudEhlaWdodC9XaWR0aCBncmVhdGVyIHRoYW4gc2Nyb2xsSGVpZ2h0L1dpZHRoLlxyXG4gICAgICAgIC8vIFNvbWV0aW1lcyBzZWVuIGluIENocm9tZS5cclxuICAgICAgICBtYXhTY3JvbGxEaXN0YW5jZVkgPSBNYXRoLm1heCgwLCBtYXhTY3JvbGxEaXN0YW5jZVkpO1xyXG4gICAgICAgIG1heFNjcm9sbERpc3RhbmNlWCA9IE1hdGgubWF4KDAsIG1heFNjcm9sbERpc3RhbmNlWCk7XHJcblxyXG4gICAgICAgIC8vIENlaWxpbmcgdGhlIG1heCBzY3JvbGwgdmFsdWVzXHJcbiAgICAgICAgaWYgKHRoaXMuc2Nyb2xsVG9wID4gbWF4U2Nyb2xsRGlzdGFuY2VZKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2Nyb2xsVG9wID0gbWF4U2Nyb2xsRGlzdGFuY2VZO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy5zY3JvbGxMZWZ0ID4gbWF4U2Nyb2xsRGlzdGFuY2VYKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2Nyb2xsTGVmdCA9IG1heFNjcm9sbERpc3RhbmNlWDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IHZTY3JvbGxEaXN0ID0gTWF0aC5hYnModGhpcy5zY3JvbGxUb3AgLSB0aGlzLnByZXZTY3JvbGxUb3ApO1xyXG4gICAgICAgIGNvbnN0IGhTY3JvbGxEaXN0ID0gTWF0aC5hYnModGhpcy5zY3JvbGxMZWZ0IC0gdGhpcy5wcmV2U2Nyb2xsTGVmdCk7XHJcblxyXG4gICAgICAgIGlmIChoU2Nyb2xsRGlzdCkge1xyXG4gICAgICAgICAgICB0aGlzLnByZXZTY3JvbGxMZWZ0ID0gdGhpcy5zY3JvbGxMZWZ0O1xyXG5cclxuICAgICAgICAgICAgLy8gJHZpZXdwb3J0U2Nyb2xsQ29udGFpbmVyWFswXS5zY3JvbGxMZWZ0ID0gc2Nyb2xsTGVmdDtcclxuICAgICAgICAgICAgLy8gaWYgKGhhc0Zyb3plbkNvbHVtbnMoKSkge1xyXG4gICAgICAgICAgICAvLyAgICAgaWYgKGhhc0Zyb3plblJvd3MpIHtcclxuICAgICAgICAgICAgLy8gICAgICAgICAkdmlld3BvcnRUb3BSWzBdLnNjcm9sbExlZnQgPSBzY3JvbGxMZWZ0O1xyXG4gICAgICAgICAgICAvLyAgICAgfVxyXG4gICAgICAgICAgICAvLyB9IGVsc2Uge1xyXG4gICAgICAgICAgICAvLyAgICAgaWYgKGhhc0Zyb3plblJvd3MpIHtcclxuICAgICAgICAgICAgLy8gICAgICAgICAkdmlld3BvcnRUb3BMWzBdLnNjcm9sbExlZnQgPSBzY3JvbGxMZWZ0O1xyXG4gICAgICAgICAgICAvLyAgICAgfVxyXG4gICAgICAgICAgICAvLyB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zdCBsYXN0U2Nyb2xsVG9wID0gdGhpcy5sYXN0UmVuZGVyZWRTY3JvbGxUb3A7XHJcblxyXG4gICAgICAgIGlmICh2U2Nyb2xsRGlzdCkge1xyXG4gICAgICAgICAgICB0aGlzLnZTY3JvbGxEaXIgPSB0aGlzLnByZXZTY3JvbGxUb3AgPCB0aGlzLnNjcm9sbFRvcCA/IDEgOiAtMTtcclxuICAgICAgICAgICAgdGhpcy5wcmV2U2Nyb2xsVG9wID0gdGhpcy5zY3JvbGxUb3A7XHJcblxyXG4gICAgICAgICAgICAvLyBpZiAoaGFzRnJvemVuQ29sdW1ucygpKSB7XHJcbiAgICAgICAgICAgIC8vICAgICBpZiAoaGFzRnJvemVuUm93cyAmJiAhb3B0aW9ucy5mcm96ZW5Cb3R0b20pIHtcclxuICAgICAgICAgICAgLy8gICAgICAgICAkdmlld3BvcnRCb3R0b21MWzBdLnNjcm9sbFRvcCA9IHNjcm9sbFRvcDtcclxuICAgICAgICAgICAgLy8gICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIC8vICAgICAgICAgJHZpZXdwb3J0VG9wTFswXS5zY3JvbGxUb3AgPSBzY3JvbGxUb3A7XHJcbiAgICAgICAgICAgIC8vICAgICB9XHJcbiAgICAgICAgICAgIC8vIH1cclxuXHJcbiAgICAgICAgICAgIC8vIHN3aXRjaCB2aXJ0dWFsIHBhZ2VzIGlmIG5lZWRlZFxyXG4gICAgICAgICAgICBpZiAodlNjcm9sbERpc3QgPCB0aGlzLnZpZXdwb3J0SCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fc2Nyb2xsVG8odGhpcy5zY3JvbGxUb3ApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoaFNjcm9sbERpc3QgfHwgdlNjcm9sbERpc3QpIHtcclxuICAgICAgICAgICAgY29uc3QgZHggPSBNYXRoLmFicyh0aGlzLmxhc3RSZW5kZXJlZFNjcm9sbExlZnQgLSB0aGlzLnNjcm9sbExlZnQpO1xyXG4gICAgICAgICAgICBjb25zdCBkeSA9IE1hdGguYWJzKGxhc3RTY3JvbGxUb3AgLSB0aGlzLnNjcm9sbFRvcCk7XHJcbiAgICAgICAgICAgIGlmIChkeCA+IDIwIHx8IGR5ID4gMjApIHtcclxuICAgICAgICAgICAgICAgIC8vIGlmIHJlbmRlcmluZyBpcyBmb3JjZWQgb3Igc2Nyb2xsaW5nIGlzIHNtYWxsIGVub3VnaCB0byBiZSBcImVhc3lcIiwganVzdCByZW5kZXJcclxuICAgICAgICAgICAgICAgIGlmIChkeSA8IHRoaXMudmlld3BvcnRIICYmIGR4IDwgdGhpcy52aWV3cG9ydFcpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbmRlckRhdGEoKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW5kZXJEYXRhKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChoU2Nyb2xsRGlzdCB8fCB2U2Nyb2xsRGlzdCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgX3Njcm9sbFRvKHkpIHtcclxuICAgICAgICBjb25zdCAkdmlld3BvcnRTY3JvbGxDb250YWluZXJZID0gdGhpcy52aWV3U2Nyb2xsQ29udGFpbmVyLm5hdGl2ZUVsZW1lbnQ7XHJcbiAgICAgICAgeSA9IE1hdGgubWF4KHksIDApO1xyXG4gICAgICAgIHkgPSBNYXRoLm1pbih5LCB0aGlzLmNhbnZhc0hlaWdodCAtIHRoaXMudmlld3BvcnRIKTtcclxuXHJcbiAgICAgICAgY29uc3QgbmV3U2Nyb2xsVG9wID0geTtcclxuXHJcbiAgICAgICAgaWYgKHRoaXMucHJldlNjcm9sbFRvcCAhPSBuZXdTY3JvbGxUb3ApIHtcclxuICAgICAgICAgICAgdGhpcy52U2Nyb2xsRGlyID0gKHRoaXMucHJldlNjcm9sbFRvcCA8IG5ld1Njcm9sbFRvcCkgPyAxIDogLTE7XHJcbiAgICAgICAgICAgIHRoaXMubGFzdFJlbmRlcmVkU2Nyb2xsVG9wID0gKHRoaXMuc2Nyb2xsVG9wID0gdGhpcy5wcmV2U2Nyb2xsVG9wID0gbmV3U2Nyb2xsVG9wKTtcclxuXHJcbiAgICAgICAgICAgIC8vIGlmIChoYXNGcm96ZW5Db2x1bW5zKCkpIHtcclxuICAgICAgICAgICAgLy8gICAgICR2aWV3cG9ydFRvcExbMF0uc2Nyb2xsVG9wID0gbmV3U2Nyb2xsVG9wO1xyXG4gICAgICAgICAgICAvLyB9XHJcblxyXG4gICAgICAgICAgICAvLyBpZiAoaGFzRnJvemVuUm93cykge1xyXG4gICAgICAgICAgICAvLyAgICAgJHZpZXdwb3J0Qm90dG9tTFswXS5zY3JvbGxUb3AgPSAkdmlld3BvcnRCb3R0b21SWzBdLnNjcm9sbFRvcCA9IG5ld1Njcm9sbFRvcDtcclxuICAgICAgICAgICAgLy8gfVxyXG5cclxuICAgICAgICAgICAgLy8gJHZpZXdwb3J0U2Nyb2xsQ29udGFpbmVyWS5zY3JvbGxUb3AgPSBuZXdTY3JvbGxUb3A7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuXHJcblxyXG4gICAgb25Nb3VzZUNsaWNrKCRldmVudDogTW91c2VFdmVudCkge1xyXG4gICAgICAgIC8vIGRvY3VtZW50LmJvZHkuY2xpY2soKTtcclxuICAgICAgICBjb25zdCB0YXJnZXQgPSAkZXZlbnQudGFyZ2V0IGFzIGFueTtcclxuXHJcbiAgICAgICAgaWYgKHRhcmdldC5ub2RlTmFtZSA9PT0gJ1RFWFRBUkVBJyB8fCB0YXJnZXQubm9kZU5hbWUgPT09ICdJTlBVVCcgKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICBcclxuICAgICAgICBsZXQgdGQgPSB0YXJnZXQ7XHJcbiAgICAgICAgaWYgKHRhcmdldC5ub2RlTmFtZSAhPT0gJ1REJykge1xyXG4gICAgICAgICAgICB0ZCA9IHRhcmdldC5jbG9zZXN0KCdURCcpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKCF0ZCkge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5kZy5pc0VkaXRpbmcoKSAmJiAodGhpcy5kZy5leGl0Um93RWRpdGluZ1doZW5Cb2R5Q2xpY2sgfHwgdGhpcy5kZy5lZGl0TW9kZSA9PSAnY2VsbCcpICkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5kZy5lbmRFZGl0aW5nKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgbGV0IGN1clQgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKVxyXG4gICAgICAgIC8v5LiK5LiA5qyh5pe26Ze05oizXHJcbiAgICAgICAgbGV0IGxhc3RUID0gdGhpc1snbGFzdFRhcERpZmZUaW1lJ10gfHwgMDtcclxuICAgICAgICAvL+WvueS4iuS4gOasoeaXtumXtOaIs+mHjeaWsOi1i+WAvFxyXG4gICAgICAgIHRoaXNbJ2xhc3RUYXBEaWZmVGltZSddID0gY3VyVDtcclxuICAgICAgICAvL+WBmuW3rlxyXG4gICAgICAgIGxldCBkaWZmID0gY3VyVCAtIGxhc3RUO1xyXG4gICAgICAgXHJcblxyXG4gICAgICAgIGNvbnN0IGlzQ2xpY2tTYW1lUm93ID0gKCkgPT4ge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5fY2xpY2tDZWxsV2Vha01hcC5oYXModGhpcy5lbC5uYXRpdmVFbGVtZW50KSAmJiB0ZCAmJiB0ZC5wYXJlbnRFbGVtZW50ID09PSB0aGlzLl9jbGlja0NlbGxXZWFrTWFwLmdldCh0aGlzLmVsLm5hdGl2ZUVsZW1lbnQpKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9jbGlja0NlbGxXZWFrTWFwLmRlbGV0ZSh0aGlzLmVsLm5hdGl2ZUVsZW1lbnQpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3QgcnVuVGRDbGljayA9ICgpID0+IHtcclxuICAgICAgICAgICAgaWYgKHRkICYmIHRkLnNlbGVjdENlbGwpIHtcclxuICAgICAgICAgICAgICAgIHRkLnNlbGVjdENlbGwoJGV2ZW50LCB0ZCk7IFxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fc2VsZWN0Um93KHRkLCAoaWQsIHJvd1NlbGVjdGVkKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IGVtaXQgPSAhcm93U2VsZWN0ZWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuZGcuc2VsZWN0aW9uTW9kZSA9PT0gJ2RlZmF1bHQnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZGcuY2xlYXJDaGVja2VkcygpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBlbWl0ID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5kZy5zZWxlY3RSb3coaWQsIGVtaXQsIGZhbHNlKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmRnWyd1cGRhdGVBbGxDaGVja2JveFN0YXR1cyddKCk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3QgcnVuU2VsZWN0Um93ID0gKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBkYmxjbGlja1RpbWVyID0gdGhpcy5kZy5kYmxjbGlja1Jvdy5vYnNlcnZlcnMubGVuZ3RoID8gMjAwOiAwO1xyXG5cclxuICAgICAgICAgICAgaWYgKGlzQ2xpY2tTYW1lUm93KCkgKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoZGlmZiA8IGRibGNsaWNrVGltZXIpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmRnLndyaXRlQ29uc29sZSgn5Y+M5Ye7Jyk7XHJcbiAgICAgICAgICAgICAgICAgICAgLy/muIXpmaTkuIrkuIDmrKHljZXlh7vnmoTlrprml7blmahJRFxyXG4gICAgICAgICAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aGlzWydsYXN0VGFwVGltZUZ1bmMnXSlcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy/lrprml7blmahpZFxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXNbJ2xhc3RUYXBUaW1lRnVuYyddID0gc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJ1blRkQ2xpY2soKTtcclxuICAgICAgICAgICAgICAgICAgICB9LCBkYmxjbGlja1RpbWVyKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHRoaXNbJ2xhc3RUYXBUaW1lRnVuYyddID0gc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgcnVuVGRDbGljaygpO1xyXG4gICAgICAgICAgICAgICAgfSwgZGJsY2xpY2tUaW1lciA/IDE4MDogMCk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHRoaXMuX2NsaWNrQ2VsbFdlYWtNYXAuc2V0KHRoaXMuZWwubmF0aXZlRWxlbWVudCwgdGQucGFyZW50RWxlbWVudCk7XHJcbiAgICAgICAgfVxyXG5cclxuXHJcbiAgICAgICAgaWYgKCF0aGlzLmRnLmVkaXRhYmxlICYmIHRkKSB7XHJcbiAgICAgICAgICAgIC8vIOino+WGs+i2hemTvueCueWHu+S6i+S7tu+8jOimgeWFiOaJp+ihjOmAieS4reihjFxyXG4gICAgICAgICAgICAkZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgICAgIHJ1blNlbGVjdFJvdygpO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAodGhpcy5kZy5lZGl0TW9kZSA9PT0gJ3JvdycpIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuZGcuZXhpdFJvd0VkaXRpbmdXaGVuQm9keUNsaWNrICYmIHRoaXMuZGcuaXNFZGl0aW5nKCkpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZGcuZW5kRWRpdGluZygpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMuX3NlbGVjdFJvdyh0ZCwgKGlkLCByb3dTZWxlY3RlZCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5kZy5zZWxlY3RSb3coaWQsICFyb3dTZWxlY3RlZCwgZmFsc2UpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoIXRkICYmIHRoaXMuZGcuY3VycmVudENlbGwpIHtcclxuICAgICAgICAgICAgdGQgPSB0aGlzLmRnLmN1cnJlbnRDZWxsLmNlbGxFbGVtZW50O1xyXG4gICAgICAgICAgICBpZiAodGQgJiYgdGQuY2xvc2VFZGl0KSB7XHJcbiAgICAgICAgICAgICAgICAkZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgICAgICAgICB0ZC5jbG9zZUVkaXQoKTtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcblxyXG4gICAgICAgIGlmICh0ZCkge1xyXG4gICAgICAgICAgICAvLyDooYznpoHnlKjml7ZcclxuICAgICAgICAgICAgaWYgKHRoaXMuZGcuZGlzYWJsZVJvdykge1xyXG4gICAgICAgICAgICAgICAgbGV0IHJvd0RhdGEgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgbGV0IHJvd0luZGV4ID0gLTE7XHJcbiAgICAgICAgICAgICAgICBpZiAodGQuZ3JpZENlbGxEYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcm93RGF0YSA9IHRkLmdyaWRDZWxsRGF0YS5yb3dEYXRhO1xyXG4gICAgICAgICAgICAgICAgICAgIHJvd0luZGV4ID0gdGQuZ3JpZENlbGxEYXRhLnJvd0luZGV4O1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCByb3dJbmZvID0gdGhpcy5kZy5nZXRSb3dJZEJ5VHIodGQucGFyZW50RWxlbWVudCk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJvd0luZm8pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcm93RGF0YSA9IHJvd0luZm8uZGF0YTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcm93SW5kZXggPSByb3dJbmZvLmluZGV4O1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBpZiAocm93RGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmRnLmRpc2FibGVSb3cocm93RGF0YSwgcm93SW5kZXgpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZGcuZW5kRWRpdGluZygpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmRnLndyaXRlQ29uc29sZSgn5pyq6I635Y+W5Yiw6KGM5pWw5o2u44CCJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICRldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICAgICAgaWYgKHRoaXMuZGcuZWRpdGFibGUgJiYgdGhpcy5kZy5lZGl0TW9kZSA9PT0gJ2NlbGwnKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGQuZWRpdCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3NlbGVjdFJvdyh0ZCwgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0ZC5lZGl0KCRldmVudCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIOWFgeiuuOe8lui+keeCueWHu+ihjOWPt+aXtu+8jOWPr+S7pemAieS4reihjFxyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0ZC5zZWxlY3RDZWxsIHx8IHRkLmNsYXNzTmFtZS5pbmRleE9mKCdmLWRhdGFncmlkLWNlbGwtcm93bnVtYmVyJykgPiAtMSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBydW5TZWxlY3RSb3coKTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyDlvZPngrnliIbnu4TooYzmiJblkIjorqHooYzml7bvvIzpobvnu5PmnZ/nvJbovpFcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kZy5pc0VkaXRpbmcoKSAmJiB0aGlzLmRnLmVuZEVkaXRpbmcoKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGQuc2VsZWN0Q2VsbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJ1blNlbGVjdFJvdygpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5kZy5pc0VkaXRpbmcoKSAmJiAodGhpcy5kZy5leGl0Um93RWRpdGluZ1doZW5Cb2R5Q2xpY2sgfHwgdGhpcy5kZy5lZGl0TW9kZSA9PT0gJ2NlbGwnKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRnLmVuZEVkaXRpbmcoKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gdGhpcy5fc2VsZWN0Um93KHRkLCAoaWQsIHJvd1NlbGVjdGVkKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgIHRoaXMuZGcuc2VsZWN0Um93KGlkLCAhcm93U2VsZWN0ZWQsIGZhbHNlKTtcclxuICAgICAgICAgICAgICAgICAgICAvLyB9KTtcclxuICAgICAgICAgICAgICAgICAgICBydW5UZENsaWNrKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgfVxyXG5cclxuXHJcblxyXG4gICAgcHJpdmF0ZSBfc2VsZWN0Um93KHRkRWw6IEhUTUxFbGVtZW50LCBjYWxsYmFjaykge1xyXG4gICAgICAgIGlmICh0ZEVsKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHRyID0gdGRFbC5wYXJlbnRFbGVtZW50O1xyXG4gICAgICAgICAgICBjb25zdCByb3dJbmZvID0gdGhpcy5kZy5nZXRSb3dJZEJ5VHIodHIpO1xyXG5cclxuICAgICAgICAgICAgaWYgKCFyb3dJbmZvKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGNvbnN0IHtkYXRhLCBpbmRleCwgaWR9ID0gcm93SW5mb1xyXG4gICAgICAgICAgICBjb25zdCByb3dpc1NlbGVjdGVkID0gdGhpcy5kZnMuaXNSb3dTZWxlY3RlZChpZCk7XHJcbiAgICAgICAgICAgIHRoaXMuZGcuX2JlZm9yZVNlbGVjdFJvdyQoaW5kZXgsIGRhdGEsIGlkKS5waXBlKHRha2VVbnRpbCh0aGlzLmRlc3Ryb3kkKSkuc3Vic2NyaWJlKCh0OiBhbnkpID0+IHtcclxuICAgICAgICAgICAgICAgIGlmICh0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2soaWQsIHJvd2lzU2VsZWN0ZWQpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgb25CZWZvcmVTaG93Q29udGV4dE1lbnUgPSAoZTogYW55KSA9PiB7XHJcbiAgICAgICAgLy8gcm93XzFfZml4ZWRsZWZ0ICByb3dfMSAgcm93XzFfZml4ZWRyaWdodFxyXG4gICAgICAgIGNvbnN0IHsgY29udGV4dE1lbnVEb20sIGV2ZW50IH0gPSBlO1xyXG5cclxuICAgICAgICBpZiAoZXZlbnQudGFyZ2V0LmNsb3Nlc3QoJy5kYXRhZ3JpZC1lZGl0b3InKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gb2Yoe3Nob3c6IGZhbHNlfSk7XHJcbiAgICAgICAgfVxyXG5cclxuXHJcbiAgICAgICAgbGV0IHJvd0lEID0gZXZlbnQudGFyZ2V0LmlkO1xyXG5cclxuICAgICAgICBpZiAoY29udGV4dE1lbnVEb20pIHtcclxuICAgICAgICAgICAgLy8g5o6S6Zmk5YiG57uE6KGM44CB5YiG57uE5ZCI6K6h6KGMXHJcbiAgICAgICAgICAgIGlmIChjb250ZXh0TWVudURvbS5jbGFzc05hbWUuaW5kZXhPZignZi1kYXRhZ3JpZC1ncm91cC1yb3cnKSA9PT0gLTEgJiYgY29udGV4dE1lbnVEb20uY2xhc3NOYW1lLmluZGV4T2YoJ2YtZGF0YWdyaWQtZ3JvdXAtZm9vdGVyJykgPT09IC0xKSB7XHJcbiAgICAgICAgICAgICAgICByb3dJRCA9IFV0aWxzLmdldFJvd0lkQnlUcihjb250ZXh0TWVudURvbSk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCByb3dEYXRhID0gdGhpcy5kZnMuZmluZFJvdyhyb3dJRCk7XHJcblxyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgY29uc3QgZm9jdXNUYXJnZXRXaWR0aCA9IHRoaXMudmlld3BvcnRXID4gdGhpcy50b3RhbFdpZHRoID8gdGhpcy50b3RhbFdpZHRoIDogdGhpcy52aWV3cG9ydFc7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ZCA9IGV2ZW50LnRhcmdldC5jbG9zZXN0KCd0ZCcpIDtcclxuICAgICAgICAgICAgICAgIGxldCBjb2xJbmZvID0gbnVsbDtcclxuICAgICAgICAgICAgICAgIGlmICh0ZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGZpZWxkTmFtZSA9IHRkLmdldEF0dHJpYnV0ZSgnZmllbGQnKTtcclxuICAgICAgICAgICAgICAgICAgICBjb2xJbmZvID0gZmllbGROYW1lID8gdGhpcy5kZnMuZ2V0Q29sdW1uKGZpZWxkTmFtZSkgOiBudWxsO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGxldCBiZWZvcmVTaG93Q29udGV4dE1lbnVzJCA9IG9mKHRydWUpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuZGcuYmVmb3JlU2hvd0NvbnRleHRNZW51cykge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHNob3dDb250ZXh0TWVudTogYW55ID0gdGhpcy5kZy5iZWZvcmVTaG93Q29udGV4dE1lbnVzKHsgcm93aWQ6IHJvd0lELCBkYXRhOiByb3dEYXRhLmRhdGEsIGdyaWQ6IHRoaXMuZGcsIGNvbHVtbjogY29sSW5mb30pO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2Ygc2hvd0NvbnRleHRNZW51ID09PSAnYm9vbGVhbicpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYmVmb3JlU2hvd0NvbnRleHRNZW51cyQgPSBvZihzaG93Q29udGV4dE1lbnUpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzaG93Q29udGV4dE1lbnVbJ3N1YnNjcmliZSddKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZWZvcmVTaG93Q29udGV4dE1lbnVzJCA9IHNob3dDb250ZXh0TWVudTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gYmVmb3JlU2hvd0NvbnRleHRNZW51cyQucGlwZShcclxuICAgICAgICAgICAgICAgICAgICBzd2l0Y2hNYXAoKGU6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBwYXJhbXMgPSB7IHJvd2lkOiByb3dJRCwgZGF0YTogcm93RGF0YS5kYXRhLCBncmlkOiB0aGlzLmRnLCBjb2x1bW46IGNvbEluZm99O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGUgPT09ICdvYmplY3QnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB7IHNob3c6IGlzU2hvdywgY3VzdG9tRGF0YSB9ID0gZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBvZih7c2hvdzogaXNTaG93LCBkYXRhOiBPYmplY3QuYXNzaWduKHBhcmFtcywgeyBjdXN0b21EYXRhOiBjdXN0b21EYXRhID8gY3VzdG9tRGF0YTogbnVsbCB9KSwgZm9jdXNUYXJnZXRXaWR0aH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG9mKHsgc2hvdzogZSwgZGF0YTogcGFyYW1zLCBmb2N1c1RhcmdldFdpZHRoIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG9mKHsgc2hvdzogZmFsc2UgfSk7XHJcbiAgICB9XHJcbn1cclxuIl19