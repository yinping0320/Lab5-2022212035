/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Directive, ElementRef, Renderer2, Injector, Input } from '@angular/core';
import { DatagridComponent } from '../../datagrid.component';
var HeaderStyleDirective = /** @class */ (function () {
    function HeaderStyleDirective(el, render, inject) {
        this.el = el;
        this.render = render;
        this.inject = inject;
        this.groupHeader = false;
        this.dg = null;
        this.dg = this.inject.get(DatagridComponent);
    }
    /**
     * @return {?}
     */
    HeaderStyleDirective.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        this.renderCss2Element();
    };
    /**
     * @return {?}
     */
    HeaderStyleDirective.prototype.ngAfterViewInit = /**
     * @return {?}
     */
    function () {
        // 启用表头自提示
        if (this.column.halign && this.column.halign !== 'left') {
            /** @type {?} */
            var tipEl = this.el.nativeElement.querySelector('.farris-label-tips');
            if (tipEl && tipEl.parentElement && tipEl.parentElement.nodeName == 'DIV') {
                this.render.setStyle(tipEl.parentElement, 'width', '100%');
                if (this.column.halign === 'right') {
                    this.render.setStyle(tipEl.parentElement, 'justify-content', 'end');
                }
                else {
                    this.render.setStyle(tipEl.parentElement, 'justify-content', 'center');
                }
            }
            else {
                if (this.groupHeader) {
                    if (this.column.halign === 'right') {
                        this.render.setStyle(this.el.nativeElement, 'justify-content', 'end');
                    }
                    else {
                        this.render.setStyle(this.el.nativeElement, 'justify-content', 'center');
                    }
                }
            }
        }
    };
    /**
     * @private
     * @return {?}
     */
    HeaderStyleDirective.prototype.renderCss2Element = /**
     * @private
     * @return {?}
     */
    function () {
        if (this.column && this.column.headerStyler) {
            /** @type {?} */
            var styler = this.column.headerStyler;
            /** @type {?} */
            var dom = this.el.nativeElement;
            /** @type {?} */
            var st = typeof this.column.headerStyler;
            if (st === 'string') {
                this.render.addClass(this.el.nativeElement, (/** @type {?} */ (styler)));
            }
            else if (st === 'function') {
                /** @type {?} */
                var r = ((/** @type {?} */ (this.column.headerStyler)))(this.column);
                if (r.cls) {
                    this.render.addClass(this.el.nativeElement, r.cls);
                }
                if (r.style) {
                    this.renderStyle(dom, r.style);
                }
            }
            else if (st === 'object' && Object.keys(st).length) {
                this.renderStyle(dom, styler);
            }
        }
    };
    /**
     * @private
     * @param {?} targetEl
     * @param {?} styleObj
     * @return {?}
     */
    HeaderStyleDirective.prototype.renderStyle = /**
     * @private
     * @param {?} targetEl
     * @param {?} styleObj
     * @return {?}
     */
    function (targetEl, styleObj) {
        /** @type {?} */
        var clskey = this.dg.customStyleKey() + " td[field=\"" + this.column.field + "\"] span.f-datagrid-header-cell-title";
        this.dg.renderCustomStyle2({ style: styleObj }, targetEl, clskey);
        /** @type {?} */
        var tdClskey = this.dg.customStyleKey() + " td[field=\"" + this.column.field + "\"].f-datagrid-header-cell";
        this.dg.renderCustomStyle2({ style: styleObj }, targetEl, tdClskey);
        /** @type {?} */
        var bg = Object.keys(styleObj).filter((/**
         * @param {?} n
         * @return {?}
         */
        function (n) { return n.toLowerCase().indexOf('background') > -1; }));
        if (bg && bg.length) {
            /** @type {?} */
            var _bgcolor = styleObj[bg[bg.length - 1]];
            /** @type {?} */
            var tdClskey2 = this.dg.customStyleKey() + " td[field=\"" + this.column.field + "\"] div.f-datagrid-header-cell-content::after";
            this.dg.renderCustomStyle2({ style: { 'background-color': _bgcolor } }, targetEl, tdClskey2);
        }
    };
    HeaderStyleDirective.decorators = [
        { type: Directive, args: [{
                    selector: '[header-style]',
                    exportAs: 'HeaderStyler'
                },] }
    ];
    /** @nocollapse */
    HeaderStyleDirective.ctorParameters = function () { return [
        { type: ElementRef },
        { type: Renderer2 },
        { type: Injector }
    ]; };
    HeaderStyleDirective.propDecorators = {
        column: [{ type: Input, args: ['header-style',] }],
        groupHeader: [{ type: Input }]
    };
    return HeaderStyleDirective;
}());
export { HeaderStyleDirective };
if (false) {
    /** @type {?} */
    HeaderStyleDirective.prototype.column;
    /** @type {?} */
    HeaderStyleDirective.prototype.groupHeader;
    /**
     * @type {?}
     * @private
     */
    HeaderStyleDirective.prototype.dg;
    /**
     * @type {?}
     * @private
     */
    HeaderStyleDirective.prototype.el;
    /**
     * @type {?}
     * @private
     */
    HeaderStyleDirective.prototype.render;
    /**
     * @type {?}
     * @private
     */
    HeaderStyleDirective.prototype.inject;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaGVhZGVyLXN0eWxlLmRpcmVjdGl2ZS5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BmYXJyaXMvdWktZGF0YWdyaWQvIiwic291cmNlcyI6WyJsaWIvY29tcG9uZW50cy9oZWFkZXIvaGVhZGVyLXN0eWxlLmRpcmVjdGl2ZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7O0FBQUEsT0FBTyxFQUFFLFNBQVMsRUFBRSxVQUFVLEVBQUUsU0FBUyxFQUFFLFFBQVEsRUFBRSxLQUFLLEVBQThDLE1BQU0sZUFBZSxDQUFDO0FBQzlILE9BQU8sRUFBRSxpQkFBaUIsRUFBRSxNQUFNLDBCQUEwQixDQUFDO0FBRzdEO0lBVUksOEJBQW9CLEVBQWMsRUFBVSxNQUFpQixFQUFVLE1BQWdCO1FBQW5FLE9BQUUsR0FBRixFQUFFLENBQVk7UUFBVSxXQUFNLEdBQU4sTUFBTSxDQUFXO1FBQVUsV0FBTSxHQUFOLE1BQU0sQ0FBVTtRQUo5RSxnQkFBVyxHQUFHLEtBQUssQ0FBQztRQUdyQixPQUFFLEdBQXNCLElBQUksQ0FBQztRQUVqQyxJQUFJLENBQUMsRUFBRSxHQUFHLElBQUksQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLGlCQUFpQixDQUFDLENBQUM7SUFDakQsQ0FBQzs7OztJQUVELHVDQUFROzs7SUFBUjtRQUNJLElBQUksQ0FBQyxpQkFBaUIsRUFBRSxDQUFDO0lBQzdCLENBQUM7Ozs7SUFFRCw4Q0FBZTs7O0lBQWY7UUFDSSxVQUFVO1FBQ1YsSUFBSSxJQUFJLENBQUMsTUFBTSxDQUFDLE1BQU0sSUFBSSxJQUFJLENBQUMsTUFBTSxDQUFDLE1BQU0sS0FBSyxNQUFNLEVBQUU7O2dCQUMvQyxLQUFLLEdBQUcsSUFBSSxDQUFDLEVBQUUsQ0FBQyxhQUFhLENBQUMsYUFBYSxDQUFDLG9CQUFvQixDQUFDO1lBQ3ZFLElBQUksS0FBSyxJQUFJLEtBQUssQ0FBQyxhQUFhLElBQUksS0FBSyxDQUFDLGFBQWEsQ0FBQyxRQUFRLElBQUksS0FBSyxFQUFFO2dCQUN2RSxJQUFJ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ZWN0aXZlLCBFbGVtZW50UmVmLCBSZW5kZXJlcjIsIEluamVjdG9yLCBJbnB1dCwgT25Jbml0LCBSZW5kZXJlclN0eWxlRmxhZ3MyLCBBZnRlclZpZXdJbml0IH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IERhdGFncmlkQ29tcG9uZW50IH0gZnJvbSAnLi4vLi4vZGF0YWdyaWQuY29tcG9uZW50JztcclxuaW1wb3J0IHsgRGF0YUNvbHVtbiwgSGVhZGVyU3R5bGVGbiB9IGZyb20gJy4vLi4vLi4vdHlwZXMvZGF0YS1jb2x1bW4nO1xyXG5cclxuQERpcmVjdGl2ZSh7XHJcbiAgICBzZWxlY3RvcjogJ1toZWFkZXItc3R5bGVdJyxcclxuICAgIGV4cG9ydEFzOiAnSGVhZGVyU3R5bGVyJ1xyXG59KVxyXG5leHBvcnQgY2xhc3MgSGVhZGVyU3R5bGVEaXJlY3RpdmUgaW1wbGVtZW50cyBPbkluaXQsIEFmdGVyVmlld0luaXQge1xyXG4gICAgQElucHV0KCdoZWFkZXItc3R5bGUnKSBjb2x1bW46IERhdGFDb2x1bW47XHJcbiAgICBASW5wdXQoKSBncm91cEhlYWRlciA9IGZhbHNlO1xyXG5cclxuXHJcbiAgICBwcml2YXRlIGRnOiBEYXRhZ3JpZENvbXBvbmVudCA9IG51bGw7XHJcbiAgICBjb25zdHJ1Y3Rvcihwcml2YXRlIGVsOiBFbGVtZW50UmVmLCBwcml2YXRlIHJlbmRlcjogUmVuZGVyZXIyLCBwcml2YXRlIGluamVjdDogSW5qZWN0b3IpIHtcclxuICAgICAgICB0aGlzLmRnID0gdGhpcy5pbmplY3QuZ2V0KERhdGFncmlkQ29tcG9uZW50KTtcclxuICAgIH1cclxuXHJcbiAgICBuZ09uSW5pdCgpIHtcclxuICAgICAgICB0aGlzLnJlbmRlckNzczJFbGVtZW50KCk7XHJcbiAgICB9XHJcblxyXG4gICAgbmdBZnRlclZpZXdJbml0KCk6IHZvaWQge1xyXG4gICAgICAgIC8vIOWQr+eUqOihqOWktOiHquaPkOekulxyXG4gICAgICAgIGlmICh0aGlzLmNvbHVtbi5oYWxpZ24gJiYgdGhpcy5jb2x1bW4uaGFsaWduICE9PSAnbGVmdCcpIHtcclxuICAgICAgICAgICAgY29uc3QgdGlwRWwgPSB0aGlzLmVsLm5hdGl2ZUVsZW1lbnQucXVlcnlTZWxlY3RvcignLmZhcnJpcy1sYWJlbC10aXBzJyk7XHJcbiAgICAgICAgICAgIGlmICh0aXBFbCAmJiB0aXBFbC5wYXJlbnRFbGVtZW50ICYmIHRpcEVsLnBhcmVudEVsZW1lbnQubm9kZU5hbWUgPT0gJ0RJVicpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyLnNldFN0eWxlKHRpcEVsLnBhcmVudEVsZW1lbnQsICd3aWR0aCcsICcxMDAlJyk7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5jb2x1bW4uaGFsaWduID09PSAncmlnaHQnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW5kZXIuc2V0U3R5bGUodGlwRWwucGFyZW50RWxlbWVudCwgJ2p1c3RpZnktY29udGVudCcsICdlbmQnKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW5kZXIuc2V0U3R5bGUodGlwRWwucGFyZW50RWxlbWVudCwgJ2p1c3RpZnktY29udGVudCcsICdjZW50ZXInKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmdyb3VwSGVhZGVyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuY29sdW1uLmhhbGlnbiA9PT0gJ3JpZ2h0Jykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbmRlci5zZXRTdHlsZSh0aGlzLmVsLm5hdGl2ZUVsZW1lbnQsICdqdXN0aWZ5LWNvbnRlbnQnLCAnZW5kJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW5kZXIuc2V0U3R5bGUodGhpcy5lbC5uYXRpdmVFbGVtZW50LCAnanVzdGlmeS1jb250ZW50JywgJ2NlbnRlcicpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gICBcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIHJlbmRlckNzczJFbGVtZW50KCkge1xyXG4gICAgICAgIGlmICh0aGlzLmNvbHVtbiAmJiB0aGlzLmNvbHVtbi5oZWFkZXJTdHlsZXIpIHtcclxuICAgICAgICAgICAgY29uc3Qgc3R5bGVyID0gdGhpcy5jb2x1bW4uaGVhZGVyU3R5bGVyO1xyXG4gICAgICAgICAgICBjb25zdCBkb20gPSB0aGlzLmVsLm5hdGl2ZUVsZW1lbnQ7XHJcbiAgICAgICAgICAgIGNvbnN0IHN0ID0gdHlwZW9mIHRoaXMuY29sdW1uLmhlYWRlclN0eWxlcjtcclxuXHJcbiAgICAgICAgICAgIGlmIChzdCA9PT0gJ3N0cmluZycpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyLmFkZENsYXNzKHRoaXMuZWwubmF0aXZlRWxlbWVudCwgc3R5bGVyIGFzIHN0cmluZyk7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoc3QgPT09ICdmdW5jdGlvbicpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHIgPSAodGhpcy5jb2x1bW4uaGVhZGVyU3R5bGVyIGFzIEhlYWRlclN0eWxlRm4pKHRoaXMuY29sdW1uKTtcclxuICAgICAgICAgICAgICAgIGlmIChyLmNscykge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyLmFkZENsYXNzKHRoaXMuZWwubmF0aXZlRWxlbWVudCwgci5jbHMpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKHIuc3R5bGUpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbmRlclN0eWxlKGRvbSwgci5zdHlsZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoc3QgPT09ICdvYmplY3QnICYmIE9iamVjdC5rZXlzKHN0KS5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyU3R5bGUoZG9tLCBzdHlsZXIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgcmVuZGVyU3R5bGUodGFyZ2V0RWw6IGFueSwgc3R5bGVPYmo6IGFueSkge1xyXG4gICAgICAgIGNvbnN0IGNsc2tleSA9IGAke3RoaXMuZGcuY3VzdG9tU3R5bGVLZXkoKX0gdGRbZmllbGQ9XCIke3RoaXMuY29sdW1uLmZpZWxkfVwiXSBzcGFuLmYtZGF0YWdyaWQtaGVhZGVyLWNlbGwtdGl0bGVgO1xyXG4gICAgICAgIHRoaXMuZGcucmVuZGVyQ3VzdG9tU3R5bGUyKHtzdHlsZTogc3R5bGVPYmp9LCB0YXJnZXRFbCwgY2xza2V5KTtcclxuXHJcblxyXG4gICAgICAgIGNvbnN0IHRkQ2xza2V5ID0gYCR7dGhpcy5kZy5jdXN0b21TdHlsZUtleSgpfSB0ZFtmaWVsZD1cIiR7dGhpcy5jb2x1bW4uZmllbGR9XCJdLmYtZGF0YWdyaWQtaGVhZGVyLWNlbGxgO1xyXG4gICAgICAgIHRoaXMuZGcucmVuZGVyQ3VzdG9tU3R5bGUyKHtzdHlsZTogc3R5bGVPYmp9LCB0YXJnZXRFbCwgdGRDbHNrZXkpO1xyXG5cclxuICAgICAgICBjb25zdCBiZyA9IE9iamVjdC5rZXlzKHN0eWxlT2JqKS5maWx0ZXIobiA9PiBuLnRvTG93ZXJDYXNlKCkuaW5kZXhPZignYmFja2dyb3VuZCcpID4gLTEpO1xyXG4gICAgICAgIGlmIChiZyAmJiBiZy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgY29uc3QgX2JnY29sb3IgPSBzdHlsZU9ialtiZ1tiZy5sZW5ndGggLSAxXV07XHJcbiAgICAgICAgICAgIGNvbnN0IHRkQ2xza2V5MiA9IGAke3RoaXMuZGcuY3VzdG9tU3R5bGVLZXkoKX0gdGRbZmllbGQ9XCIke3RoaXMuY29sdW1uLmZpZWxkfVwiXSBkaXYuZi1kYXRhZ3JpZC1oZWFkZXItY2VsbC1jb250ZW50OjphZnRlcmA7XHJcbiAgICAgICAgICAgIHRoaXMuZGcucmVuZGVyQ3VzdG9tU3R5bGUyKHtzdHlsZTogeydiYWNrZ3JvdW5kLWNvbG9yJzogX2JnY29sb3J9fSwgdGFyZ2V0RWwsIHRkQ2xza2V5Mik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgfVxyXG5cclxufVxyXG4iXX0=