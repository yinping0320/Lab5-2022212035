/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Directive, ElementRef, Renderer2, Injector, Input } from '@angular/core';
import { DatagridComponent } from '../../datagrid.component';
export class HeaderStyleDirective {
    /**
     * @param {?} el
     * @param {?} render
     * @param {?} inject
     */
    constructor(el, render, inject) {
        this.el = el;
        this.render = render;
        this.inject = inject;
        this.groupHeader = false;
        this.dg = null;
        this.dg = this.inject.get(DatagridComponent);
    }
    /**
     * @return {?}
     */
    ngOnInit() {
        this.renderCss2Element();
    }
    /**
     * @return {?}
     */
    ngAfterViewInit() {
        // 启用表头自提示
        if (this.column.halign && this.column.halign !== 'left') {
            /** @type {?} */
            const tipEl = this.el.nativeElement.querySelector('.farris-label-tips');
            if (tipEl && tipEl.parentElement && tipEl.parentElement.nodeName == 'DIV') {
                this.render.setStyle(tipEl.parentElement, 'width', '100%');
                if (this.column.halign === 'right') {
                    this.render.setStyle(tipEl.parentElement, 'justify-content', 'end');
                }
                else {
                    this.render.setStyle(tipEl.parentElement, 'justify-content', 'center');
                }
            }
            else {
                if (this.groupHeader) {
                    if (this.column.halign === 'right') {
                        this.render.setStyle(this.el.nativeElement, 'justify-content', 'end');
                    }
                    else {
                        this.render.setStyle(this.el.nativeElement, 'justify-content', 'center');
                    }
                }
            }
        }
    }
    /**
     * @private
     * @return {?}
     */
    renderCss2Element() {
        if (this.column && this.column.headerStyler) {
            /** @type {?} */
            const styler = this.column.headerStyler;
            /** @type {?} */
            const dom = this.el.nativeElement;
            /** @type {?} */
            const st = typeof this.column.headerStyler;
            if (st === 'string') {
                this.render.addClass(this.el.nativeElement, (/** @type {?} */ (styler)));
            }
            else if (st === 'function') {
                /** @type {?} */
                const r = ((/** @type {?} */ (this.column.headerStyler)))(this.column);
                if (r.cls) {
                    this.render.addClass(this.el.nativeElement, r.cls);
                }
                if (r.style) {
                    this.renderStyle(dom, r.style);
                }
            }
            else if (st === 'object' && Object.keys(st).length) {
                this.renderStyle(dom, styler);
            }
        }
    }
    /**
     * @private
     * @param {?} targetEl
     * @param {?} styleObj
     * @return {?}
     */
    renderStyle(targetEl, styleObj) {
        /** @type {?} */
        const clskey = `${this.dg.customStyleKey()} td[field="${this.column.field}"] span.f-datagrid-header-cell-title`;
        this.dg.renderCustomStyle2({ style: styleObj }, targetEl, clskey);
        /** @type {?} */
        const tdClskey = `${this.dg.customStyleKey()} td[field="${this.column.field}"].f-datagrid-header-cell`;
        this.dg.renderCustomStyle2({ style: styleObj }, targetEl, tdClskey);
        /** @type {?} */
        const bg = Object.keys(styleObj).filter((/**
         * @param {?} n
         * @return {?}
         */
        n => n.toLowerCase().indexOf('background') > -1));
        if (bg && bg.length) {
            /** @type {?} */
            const _bgcolor = styleObj[bg[bg.length - 1]];
            /** @type {?} */
            const tdClskey2 = `${this.dg.customStyleKey()} td[field="${this.column.field}"] div.f-datagrid-header-cell-content::after`;
            this.dg.renderCustomStyle2({ style: { 'background-color': _bgcolor } }, targetEl, tdClskey2);
        }
    }
}
HeaderStyleDirective.decorators = [
    { type: Directive, args: [{
                selector: '[header-style]',
                exportAs: 'HeaderStyler'
            },] }
];
/** @nocollapse */
HeaderStyleDirective.ctorParameters = () => [
    { type: ElementRef },
    { type: Renderer2 },
    { type: Injector }
];
HeaderStyleDirective.propDecorators = {
    column: [{ type: Input, args: ['header-style',] }],
    groupHeader: [{ type: Input }]
};
if (false) {
    /** @type {?} */
    HeaderStyleDirective.prototype.column;
    /** @type {?} */
    HeaderStyleDirective.prototype.groupHeader;
    /**
     * @type {?}
     * @private
     */
    HeaderStyleDirective.prototype.dg;
    /**
     * @type {?}
     * @private
     */
    HeaderStyleDirective.prototype.el;
    /**
     * @type {?}
     * @private
     */
    HeaderStyleDirective.prototype.render;
    /**
     * @type {?}
     * @private
     */
    HeaderStyleDirective.prototype.inject;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaGVhZGVyLXN0eWxlLmRpcmVjdGl2ZS5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BmYXJyaXMvdWktZGF0YWdyaWQvIiwic291cmNlcyI6WyJsaWIvY29tcG9uZW50cy9oZWFkZXIvaGVhZGVyLXN0eWxlLmRpcmVjdGl2ZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7O0FBQUEsT0FBTyxFQUFFLFNBQVMsRUFBRSxVQUFVLEVBQUUsU0FBUyxFQUFFLFFBQVEsRUFBRSxLQUFLLEVBQThDLE1BQU0sZUFBZSxDQUFDO0FBQzlILE9BQU8sRUFBRSxpQkFBaUIsRUFBRSxNQUFNLDBCQUEwQixDQUFDO0FBTzdELE1BQU0sT0FBTyxvQkFBb0I7Ozs7OztJQU03QixZQUFvQixFQUFjLEVBQVUsTUFBaUIsRUFBVSxNQUFnQjtRQUFuRSxPQUFFLEdBQUYsRUFBRSxDQUFZO1FBQVUsV0FBTSxHQUFOLE1BQU0sQ0FBVztRQUFVLFdBQU0sR0FBTixNQUFNLENBQVU7UUFKOUUsZ0JBQVcsR0FBRyxLQUFLLENBQUM7UUFHckIsT0FBRSxHQUFzQixJQUFJLENBQUM7UUFFakMsSUFBSSxDQUFDLEVBQUUsR0FBRyxJQUFJLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxpQkFBaUIsQ0FBQyxDQUFDO0lBQ2pELENBQUM7Ozs7SUFFRCxRQUFRO1FBQ0osSUFBSSxDQUFDLGlCQUFpQixFQUFFLENBQUM7SUFDN0IsQ0FBQzs7OztJQUVELGVBQWU7UUFDWCxVQUFVO1FBQ1YsSUFBSSxJQUFJLENBQUMsTUFBTSxDQUFDLE1BQU0sSUFBSSxJQUFJLENBQUMsTUFBTSxDQUFDLE1BQU0sS0FBSyxNQUFNLEVBQUU7O2tCQUMvQyxLQUFLLEdBQUcsSUFBSSxDQUFDLEVBQUUsQ0FBQyxhQUFhLENBQUMsYUFBYSxDQUFDLG9CQUFvQixDQUFDO1lBQ3ZFLElBQUksS0FBSyxJQUFJLEtBQUssQ0FBQyxhQUFhLElBQUksS0FBSyxDQUFDLGFBQWEsQ0FBQyxRQUFRLElBQUksS0FBSyxFQUFFO2dCQUN2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LElBQUksQ0FBQyxFQUFFLENBQUMsa0JBQWtCLENBQUMsRUFBQyxLQUFLLEVBQUUsUUFBUSxFQUFDLEVBQUUsUUFBUSxFQUFFLFFBQVEsQ0FBQyxDQUFDOztjQUU1RCxFQUFFLEdBQUcsTUFBTSxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsQ0FBQyxNQUFNOzs7O1FBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsV0FBVyxFQUFFLENBQUMsT0FBTyxDQUFDLFlBQVksQ0FBQyxHQUFHLENBQUMsQ0FBQyxFQUFDO1FBQ3hGLElBQUksRUFBRSxJQUFJLEVBQUUsQ0FBQyxNQUFNLEVBQUU7O2tCQUNYLFFBQVEsR0FBRyxRQUFRLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxNQUFNLEdBQUcsQ0FBQyxDQUFDLENBQUM7O2tCQUN0QyxTQUFTLEdBQUcsR0FBRyxJQUFJLENBQUMsRUFBRSxDQUFDLGNBQWMsRUFBRSxjQUFjLElBQUksQ0FBQyxNQUFNLENBQUMsS0FBSyw4Q0FBOEM7WUFDMUgsSUFBSSxDQUFDLEVBQUUsQ0FBQyxrQkFBa0IsQ0FBQyxFQUFDLEtBQUssRUFBRSxFQUFDLGtCQUFrQixFQUFFLFFBQVEsRUFBQyxFQUFDLEVBQUUsUUFBUSxFQUFFLFNBQVMsQ0FBQyxDQUFDO1NBQzVGO0lBRUwsQ0FBQzs7O1lBOUVKLFNBQVMsU0FBQztnQkFDUCxRQUFRLEVBQUUsZ0JBQWdCO2dCQUMxQixRQUFRLEVBQUUsY0FBYzthQUMzQjs7OztZQVBtQixVQUFVO1lBQUUsU0FBUztZQUFFLFFBQVE7OztxQkFTOUMsS0FBSyxTQUFDLGNBQWM7MEJBQ3BCLEtBQUs7Ozs7SUFETixzQ0FBMEM7O0lBQzFDLDJDQUE2Qjs7Ozs7SUFHN0Isa0NBQXFDOzs7OztJQUN6QixrQ0FBc0I7Ozs7O0lBQUUsc0NBQXlCOzs7OztJQUFFLHNDQUF3QiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IERpcmVjdGl2ZSwgRWxlbWVudFJlZiwgUmVuZGVyZXIyLCBJbmplY3RvciwgSW5wdXQsIE9uSW5pdCwgUmVuZGVyZXJTdHlsZUZsYWdzMiwgQWZ0ZXJWaWV3SW5pdCB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBEYXRhZ3JpZENvbXBvbmVudCB9IGZyb20gJy4uLy4uL2RhdGFncmlkLmNvbXBvbmVudCc7XHJcbmltcG9ydCB7IERhdGFDb2x1bW4sIEhlYWRlclN0eWxlRm4gfSBmcm9tICcuLy4uLy4uL3R5cGVzL2RhdGEtY29sdW1uJztcclxuXHJcbkBEaXJlY3RpdmUoe1xyXG4gICAgc2VsZWN0b3I6ICdbaGVhZGVyLXN0eWxlXScsXHJcbiAgICBleHBvcnRBczogJ0hlYWRlclN0eWxlcidcclxufSlcclxuZXhwb3J0IGNsYXNzIEhlYWRlclN0eWxlRGlyZWN0aXZlIGltcGxlbWVudHMgT25Jbml0LCBBZnRlclZpZXdJbml0IHtcclxuICAgIEBJbnB1dCgnaGVhZGVyLXN0eWxlJykgY29sdW1uOiBEYXRhQ29sdW1uO1xyXG4gICAgQElucHV0KCkgZ3JvdXBIZWFkZXIgPSBmYWxzZTtcclxuXHJcblxyXG4gICAgcHJpdmF0ZSBkZzogRGF0YWdyaWRDb21wb25lbnQgPSBudWxsO1xyXG4gICAgY29uc3RydWN0b3IocHJpdmF0ZSBlbDogRWxlbWVudFJlZiwgcHJpdmF0ZSByZW5kZXI6IFJlbmRlcmVyMiwgcHJpdmF0ZSBpbmplY3Q6IEluamVjdG9yKSB7XHJcbiAgICAgICAgdGhpcy5kZyA9IHRoaXMuaW5qZWN0LmdldChEYXRhZ3JpZENvbXBvbmVudCk7XHJcbiAgICB9XHJcblxyXG4gICAgbmdPbkluaXQoKSB7XHJcbiAgICAgICAgdGhpcy5yZW5kZXJDc3MyRWxlbWVudCgpO1xyXG4gICAgfVxyXG5cclxuICAgIG5nQWZ0ZXJWaWV3SW5pdCgpOiB2b2lkIHtcclxuICAgICAgICAvLyDlkK/nlKjooajlpLToh6rmj5DnpLpcclxuICAgICAgICBpZiAodGhpcy5jb2x1bW4uaGFsaWduICYmIHRoaXMuY29sdW1uLmhhbGlnbiAhPT0gJ2xlZnQnKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHRpcEVsID0gdGhpcy5lbC5uYXRpdmVFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5mYXJyaXMtbGFiZWwtdGlwcycpO1xyXG4gICAgICAgICAgICBpZiAodGlwRWwgJiYgdGlwRWwucGFyZW50RWxlbWVudCAmJiB0aXBFbC5wYXJlbnRFbGVtZW50Lm5vZGVOYW1lID09ICdESVYnKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnJlbmRlci5zZXRTdHlsZSh0aXBFbC5wYXJlbnRFbGVtZW50LCAnd2lkdGgnLCAnMTAwJScpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuY29sdW1uLmhhbGlnbiA9PT0gJ3JpZ2h0Jykge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyLnNldFN0eWxlKHRpcEVsLnBhcmVudEVsZW1lbnQsICdqdXN0aWZ5LWNvbnRlbnQnLCAnZW5kJyk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyLnNldFN0eWxlKHRpcEVsLnBhcmVudEVsZW1lbnQsICdqdXN0aWZ5LWNvbnRlbnQnLCAnY2VudGVyJyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5ncm91cEhlYWRlcikge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmNvbHVtbi5oYWxpZ24gPT09ICdyaWdodCcpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW5kZXIuc2V0U3R5bGUodGhpcy5lbC5uYXRpdmVFbGVtZW50LCAnanVzdGlmeS1jb250ZW50JywgJ2VuZCcpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyLnNldFN0eWxlKHRoaXMuZWwubmF0aXZlRWxlbWVudCwgJ2p1c3RpZnktY29udGVudCcsICdjZW50ZXInKTtcclxuICAgICAgICAgICAgICAgICAgICB9ICAgXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSByZW5kZXJDc3MyRWxlbWVudCgpIHtcclxuICAgICAgICBpZiAodGhpcy5jb2x1bW4gJiYgdGhpcy5jb2x1bW4uaGVhZGVyU3R5bGVyKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHN0eWxlciA9IHRoaXMuY29sdW1uLmhlYWRlclN0eWxlcjtcclxuICAgICAgICAgICAgY29uc3QgZG9tID0gdGhpcy5lbC5uYXRpdmVFbGVtZW50O1xyXG4gICAgICAgICAgICBjb25zdCBzdCA9IHR5cGVvZiB0aGlzLmNvbHVtbi5oZWFkZXJTdHlsZXI7XHJcblxyXG4gICAgICAgICAgICBpZiAoc3QgPT09ICdzdHJpbmcnKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnJlbmRlci5hZGRDbGFzcyh0aGlzLmVsLm5hdGl2ZUVsZW1lbnQsIHN0eWxlciBhcyBzdHJpbmcpO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHN0ID09PSAnZnVuY3Rpb24nKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCByID0gKHRoaXMuY29sdW1uLmhlYWRlclN0eWxlciBhcyBIZWFkZXJTdHlsZUZuKSh0aGlzLmNvbHVtbik7XHJcbiAgICAgICAgICAgICAgICBpZiAoci5jbHMpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbmRlci5hZGRDbGFzcyh0aGlzLmVsLm5hdGl2ZUVsZW1lbnQsIHIuY2xzKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChyLnN0eWxlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW5kZXJTdHlsZShkb20sIHIuc3R5bGUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHN0ID09PSAnb2JqZWN0JyAmJiBPYmplY3Qua2V5cyhzdCkubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnJlbmRlclN0eWxlKGRvbSwgc3R5bGVyKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIHJlbmRlclN0eWxlKHRhcmdldEVsOiBhbnksIHN0eWxlT2JqOiBhbnkpIHtcclxuICAgICAgICBjb25zdCBjbHNrZXkgPSBgJHt0aGlzLmRnLmN1c3RvbVN0eWxlS2V5KCl9IHRkW2ZpZWxkPVwiJHt0aGlzLmNvbHVtbi5maWVsZH1cIl0gc3Bhbi5mLWRhdGFncmlkLWhlYWRlci1jZWxsLXRpdGxlYDtcclxuICAgICAgICB0aGlzLmRnLnJlbmRlckN1c3RvbVN0eWxlMih7c3R5bGU6IHN0eWxlT2JqfSwgdGFyZ2V0RWwsIGNsc2tleSk7XHJcblxyXG5cclxuICAgICAgICBjb25zdCB0ZENsc2tleSA9IGAke3RoaXMuZGcuY3VzdG9tU3R5bGVLZXkoKX0gdGRbZmllbGQ9XCIke3RoaXMuY29sdW1uLmZpZWxkfVwiXS5mLWRhdGFncmlkLWhlYWRlci1jZWxsYDtcclxuICAgICAgICB0aGlzLmRnLnJlbmRlckN1c3RvbVN0eWxlMih7c3R5bGU6IHN0eWxlT2JqfSwgdGFyZ2V0RWwsIHRkQ2xza2V5KTtcclxuXHJcbiAgICAgICAgY29uc3QgYmcgPSBPYmplY3Qua2V5cyhzdHlsZU9iaikuZmlsdGVyKG4gPT4gbi50b0xvd2VyQ2FzZSgpLmluZGV4T2YoJ2JhY2tncm91bmQnKSA+IC0xKTtcclxuICAgICAgICBpZiAoYmcgJiYgYmcubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IF9iZ2NvbG9yID0gc3R5bGVPYmpbYmdbYmcubGVuZ3RoIC0gMV1dO1xyXG4gICAgICAgICAgICBjb25zdCB0ZENsc2tleTIgPSBgJHt0aGlzLmRnLmN1c3RvbVN0eWxlS2V5KCl9IHRkW2ZpZWxkPVwiJHt0aGlzLmNvbHVtbi5maWVsZH1cIl0gZGl2LmYtZGF0YWdyaWQtaGVhZGVyLWNlbGwtY29udGVudDo6YWZ0ZXJgO1xyXG4gICAgICAgICAgICB0aGlzLmRnLnJlbmRlckN1c3RvbVN0eWxlMih7c3R5bGU6IHsnYmFja2dyb3VuZC1jb2xvcic6IF9iZ2NvbG9yfX0sIHRhcmdldEVsLCB0ZENsc2tleTIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgIH1cclxuXHJcbn1cclxuIl19