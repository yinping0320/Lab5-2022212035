/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
/*
* @Author: 疯狂秀才(Lucas Huang)
* @Date: 2019-08-06 07:43:53
* @LastEditors: 疯狂秀才(Lucas Huang)
* @LastEditTime: 2019-11-09 20:44:54
* @QQ: 1055818239
* @Version: v0.0.1
*/
import { EventEmitter } from '@angular/core';
import { Subject, BehaviorSubject } from 'rxjs';
import { filter, map, debounceTime } from 'rxjs/operators';
import { IdService } from '@farris/ui-common';
import { Utils } from './../utils/utils';
import { CUSTOM_CELL_CLS, CUSTOM_GROUP_ROW_CLS, CUSTOM_ROW_CLS } from '../types/constant';
export class DatagridService {
    constructor() {
        this.scorllSubject = new Subject();
        this.scrollX = new BehaviorSubject(0);
        this.rowHoverSubject = new Subject();
        this.rowSelectSubject = new Subject();
        this.dataSourceChangedSubject = new Subject();
        /**
         * 编辑单元格
         */
        this.editCellSubject = new Subject();
        /**
         * 选中单元格
         */
        this.selectCellSubject = new Subject();
        /**
         * 结束单元编辑
         */
        this.endCellEdit = new Subject();
        this.changeCheckedRows = new Subject();
        /**
         * 结束行编辑
         */
        // private endRowEdit = new BehaviorSubject(true);
        this.scorll$ = this.scorllSubject.asObservable();
        this.scrollX$ = this.scorll$.pipe(filter((/**
         * @param {?} p
         * @return {?}
         */
        (p) => p.type === 'psScrollX')), map((/**
         * @param {?} t
         * @return {?}
         */
        t => t.x)), debounceTime(50));
        this.scrollY$ = this.scorll$.pipe(filter((/**
         * @param {?} p
         * @return {?}
         */
        (p) => p.type === 'psScrollY')), map((/**
         * @param {?} t
         * @return {?}
         */
        t => t.x)), debounceTime(50));
        this.rowHover$ = this.rowHoverSubject.asObservable();
        this.rowClick$ = this.rowSelectSubject.asObservable();
        this.onDataSourceChange = this.dataSourceChangedSubject.asObservable();
        this.cellEdit$ = this.editCellSubject.asObservable();
        this.endCellEdit$ = this.endCellEdit.asObservable();
        this.checkedRowsTotalChanged$ = this.changeCheckedRows.asObservable();
        this.updateEmptyStyle$ = new EventEmitter();
        this.showGridHeader = new EventEmitter();
        // 取消全选
        this.uncheckAll = new EventEmitter();
        // 全部选中
        this.checkAll = new EventEmitter();
        this.columnResized = new EventEmitter();
        this.rowHeightChanged = new EventEmitter();
        this.loadVirtualData = new EventEmitter();
        /**
         * 显示固定列隐影
         */
        this.showFixedShadow = new EventEmitter();
        // public endRowEdit$ = this.endRowEdit.asObservable();
        this.setSelecedRow = new EventEmitter();
        this.setCheckedRows = new EventEmitter();
        this.scrollToCurrentRow = new EventEmitter();
        this.columnsChanged = new EventEmitter();
        this.cellContentWrapChanged = new EventEmitter();
        this.onFilterChanged = new EventEmitter();
        this.clearFilter = new EventEmitter();
        this.filterTextChange = new EventEmitter();
        this.toggleFilterRow = new EventEmitter();
        this.closeFilterPanel = new EventEmitter();
        this.refreshFooterData = new EventEmitter();
        this.disableHeader = new EventEmitter();
        /**
         * 更新全选复选框状态
         */
        this.changeCheckAllStatus = new EventEmitter();
        this.setScrollbarPosition = new EventEmitter();
        this.smartFilterBarExpand = new EventEmitter();
        this.smartFilterDataChange = new EventEmitter();
        this.scrollbarUpdate = new EventEmitter();
        this.footerPositionChanged = new EventEmitter();
        this.styleElement = null;
        this.commonUtils = null;
        this.idService = null;
        // 单元格编辑器创建完成
        this.cellEditorCreated = new EventEmitter();
        // 单元格编辑器销毁
        this.cellEditorDestory = new EventEmitter();
        // 焦点行切换
        this.focusRowChanged = new EventEmitter();
        this.dataloaded = new EventEmitter();
        this.toggleGroupRow$ = new EventEmitter();
        this.toggleAllGroupRows$ = new EventEmitter();
        // CSS 文本缓存
        this.cssTextCache = [];
        this.groupBy = (/**
         * @param {?} arr
         * @param {?} fn
         * @return {?}
         */
        (arr, fn) => arr.map(typeof fn === 'function' ? fn : (/**
         * @param {?} val
         * @return {?}
         */
        val => Utils.getValue(fn, val))).reduce((/**
         * @param {?} acc
         * @param {?} val
         * @param {?} i
         * @return {?}
         */
        (acc, val, i) => {
            acc[val] = (acc[val] || []).concat(arr[i]);
            return acc;
        }), {}));
    }
    /**
     * @param {?} x
     * @param {?} action
     * @return {?}
     */
    onScrollMove(x, action) {
        this.scorllSubject.next({ x, type: action });
    }
    /**
     * @return {?}
     */
    dataSourceChanged() {
        this.dataSourceChangedSubject.next();
    }
    /**
     * @param {?} rowIndex
     * @param {?} rowData
     * @param {?} mouseEnter
     * @return {?}
     */
    onRowHover(rowIndex, rowData, mouseEnter) {
        this.rowHoverSubject.next({ index: rowIndex, data: rowData, mouseenter: mouseEnter });
    }
    /**
     * @param {?} rowIndex
     * @param {?} rowData
     * @return {?}
     */
    onRowClick(rowIndex, rowData) {
        this.rowSelectSubject.next({ index: rowIndex, data: rowData });
    }
    /**
     * @param {?} tdElement
     * @return {?}
     */
    onCellEdit(tdElement) {
        this.editCellSubject.next(tdElement);
    }
    /**
     * @param {?} cell
     * @return {?}
     */
    onEndCellEdit(cell) {
        this.endCellEdit.next(cell);
    }
    /**
     * @param {?} cell
     * @return {?}
     */
    onSelectCell(cell) {
        this.selectCellSubject.next(cell);
    }
    /**
     * @return {?}
     */
    onCheckedRowsCountChange() {
        this.changeCheckedRows.next();
    }
    /**
     * @param {?} rowHeight
     * @return {?}
     */
    onRowHeightChange(rowHeight) {
        this.rowHeightChanged.emit(rowHeight);
    }
    /**
     * @param {?} data
     * @return {?}
     */
    onLoadVirtualData(data) {
        this.loadVirtualData.emit({ data });
    }
    /**
     * @return {?}
     */
    onClearFilter() {
        this.clearFilter.emit();
        this.filterTextChange.emit('');
    }
    /**
     * @param {?} txt
     * @return {?}
     */
    onFilterTextChange(txt) {
        this.filterTextChange.emit(txt);
    }
    /**
     * @return {?}
     */
    restoreScrollbarPosition() {
        this.setScrollbarPosition.emit();
    }
    /**
     * @return {?}
     */
    updateEmptyStyle() {
        this.updateEmptyStyle$.emit();
    }
    /**
     * @param {?} data
     * @param {?} mergeFields
     * @return {?}
     */
    getMergeCellInfo(data, mergeFields) {
        /** @type {?} */
        const result = {};
        /** @type {?} */
        let firstVal = null;
        /** @type {?} */
        let currVal;
        mergeFields.forEach((/**
         * @param {?} f
         * @param {?} i
         * @return {?}
         */
        (f, i) => {
            if (i === 0) {
                data.forEach((/**
                 * @param {?} d
                 * @param {?} j
                 * @return {?}
                 */
                (d, j) => {
                    /** @type {?} */
                    const item = { [f]: { show: true, rowspan: 1 } };
                    if (!result[j]) {
                        result[j] = item;
                    }
                    else {
                        if (!result[j][f]) {
                            result[j] = Object.assign(result[j], item);
                        }
                    }
                    /** @type {?} */
                    const _item = result[j];
                    currVal = d[f];
                    if (firstVal === null || firstVal !== currVal) {
                        firstVal = currVal;
                        _item[f].show = true;
                        _item[f].startIndex = j;
                    }
                    else {
                        /** @type {?} */
                        const strIndex = result[j - 1][f].startIndex;
                        _item[f].startIndex = strIndex;
                        _item[f].show = false;
                        result[strIndex][f].rowspan++;
                    }
                }));
            }
        }));
        return result;
    }
    /**
     * @param {?} data
     * @param {?} field
     * @return {?}
     */
    getMergeCellInfo0(data, field) {
        /** @type {?} */
        const result = {};
        /** @type {?} */
        let firstVal;
        /** @type {?} */
        let currVal;
        data.forEach((/**
         * @param {?} d
         * @param {?} j
         * @return {?}
         */
        (d, j) => {
            /** @type {?} */
            const item = { [field]: { show: true, rowspan: 1, value: '' } };
            if (!result[j]) {
                result[j] = item;
            }
            /** @type {?} */
            const _item = result[j];
            currVal = Utils.getValue(field, d);
            _item[field].value = currVal;
            if (firstVal === undefined || firstVal !== currVal) {
                firstVal = currVal;
                _item[field].show = true;
                _item[field].startIndex = j;
            }
            else {
                /** @type {?} */
                const strIndex = result[j - 1][field].startIndex;
                _item[field].startIndex = strIndex;
                _item[field].show = false;
                result[strIndex][field].rowspan++;
            }
        }));
        return result;
    }
    /**
     * @param {?} data
     * @param {?} mergeFields
     * @return {?}
     */
    getMergeCellInfo2(data, mergeFields) {
        /** @type {?} */
        let result = {};
        /** @type {?} */
        let firstVal = null;
        result = this.getMergeCellInfo0(data, mergeFields.splice(0, 1)[0]);
        /** @type {?} */
        const groupData = this.groupBy(data, mergeFields[0]);
        /** @type {?} */
        const groupKeys = Object.keys(groupData);
        /** @type {?} */
        let startRowIndex = 0;
        mergeFields.forEach((/**
         * @param {?} f
         * @param {?} i
         * @return {?}
         */
        (f, i) => {
            groupKeys.forEach((/**
             * @param {?} k
             * @param {?} j
             * @return {?}
             */
            (k, j) => {
                /** @type {?} */
                let currVal;
                groupData[k].forEach((/**
                 * @param {?} d
                 * @param {?} n
                 * @return {?}
                 */
                (d, n) => {
                    if (result[startRowIndex] && !result[startRowIndex][f]) {
                        result[startRowIndex] = Object.assign(result[startRowIndex], { [f]: { show: true, rowspan: 1, value: '' } });
                    }
                    /** @type {?} */
                    const _item = result[startRowIndex];
                    currVal = Utils.getValue(f, d);
                    _item[f].value = currVal;
                    if (firstVal === null || firstVal !== currVal) {
                        firstVal = currVal;
                        _item[f].show = true;
                        _item[f].startIndex = startRowIndex;
                    }
                    else {
                        /** @type {?} */
                        const strIndex = result[startRowIndex - 1][f].startIndex;
                        _item[f].startIndex = strIndex;
                        _item[f].show = false;
                        result[strIndex][f].rowspan++;
                    }
                    startRowIndex++;
                }));
            }));
        }));
        return result;
    }
    /**
     * @param {?} data
     * @param {?} mergeFields
     * @return {?}
     */
    getMergeCellInfo3(data, mergeFields) {
        /** @type {?} */
        let result = {};
        /** @type {?} */
        const firstField = mergeFields.splice(0, 1)[0];
        result = this.getMergeCellInfo0(data, firstField);
        /** @type {?} */
        let prevGroupField = firstField;
        // const groupData = this.groupBy(data, firstField);
        // const groupKeys = Object.keys(groupData);
        mergeFields.forEach((/**
         * @param {?} f
         * @param {?} i
         * @return {?}
         */
        (f, i) => {
            /** @type {?} */
            let startRowIndex = 0;
            /** @type {?} */
            let firstVal;
            /** @type {?} */
            let currVal;
            if (i > 0) {
                prevGroupField = mergeFields[i - 1];
            }
            data.forEach((/**
             * @param {?} d
             * @param {?} n
             * @return {?}
             */
            (d, n) => {
                if (result[startRowIndex] && !result[startRowIndex][f]) {
                    result[startRowIndex] = Object.assign(result[startRowIndex], { [f]: { show: true, rowspan: 1, value: '' } });
                }
                /** @type {?} */
                const _item = result[startRowIndex];
                currVal = Utils.getValue(f, d);
                _item[f].value = currVal;
                if (startRowIndex > 0) {
                    /** @type {?} */
                    const prevItem = result[startRowIndex - 1];
                    /** @type {?} */
                    const _c = Object.keys(_item).map((/**
                     * @param {?} c
                     * @return {?}
                     */
                    c => '' + _item[c].value)).join(',');
                    /** @type {?} */
                    const _p = Object.keys(prevItem).map((/**
                     * @param {?} p
                     * @return {?}
                     */
                    p => '' + prevItem[p].value)).join(',');
                    if (_c !== _p) {
                        firstVal = undefined;
                    }
                }
                if ((firstVal === undefined || firstVal !== currVal)) {
                    firstVal = currVal;
                    _item[f].show = true;
                    _item[f].startIndex = startRowIndex;
                }
                else {
                    /** @type {?} */
                    const startIndex = result[startRowIndex - 1][f].startIndex;
                    _item[f].startIndex = startIndex;
                    _item[f].show = false;
                    result[startIndex][f].rowspan++;
                }
                if (data.length - 1 > startRowIndex) {
                    startRowIndex++;
                }
            }));
        }));
        return result;
    }
    /**
     * @param {?} rowIndex
     * @param {?} field
     * @param {?} mergeCellInfo
     * @return {?}
     */
    getMergeInfo(rowIndex, field, mergeCellInfo) {
        if (field && mergeCellInfo && mergeCellInfo[rowIndex] && mergeCellInfo[rowIndex][field]) {
            return mergeCellInfo[rowIndex][field];
        }
        return null;
    }
    /**
     * @return {?}
     */
    removeStyleSheet() {
        if (this.styleElement) {
            this.styleElement.remove();
            this.styleElement = null;
            // 清空缓存
            this.cssTextCache = [];
        }
    }
    /**
     * @param {?} styleSheetId
     * @return {?}
     */
    createStyleElement(styleSheetId) {
        this.styleElement = this._createStyleSheet(styleSheetId);
    }
    /**
     * @param {?} rules
     * @return {?}
     */
    appendCssRules(rules) {
        if (this.styleElement) {
            this._appendCssRules(rules, this.styleElement.sheet);
        }
    }
    /**
     * @param {?} ruleName
     * @return {?}
     */
    removeCssRule(ruleName) {
        if (this.styleElement) {
            if (typeof ruleName === 'string') {
                this._removeCssRule(ruleName, this.styleElement.sheet);
                this.cssTextCache = this.cssTextCache.filter((/**
                 * @param {?} n
                 * @return {?}
                 */
                n => n.indexOf(ruleName) == -1));
            }
            else {
                if (Array.isArray(ruleName)) {
                    ruleName.forEach((/**
                     * @param {?} n
                     * @return {?}
                     */
                    n => {
                        this._removeCssRule(n, this.styleElement.sheet);
                        this.cssTextCache = this.cssTextCache.filter((/**
                         * @param {?} n
                         * @return {?}
                         */
                        n => n.indexOf(n) == -1));
                    }));
                }
            }
        }
    }
    /**
     * @private
     * @param {?} styleSheetId
     * @return {?}
     */
    _createStyleSheet(styleSheetId) {
        /** @type {?} */
        const htmlHead = document.querySelector('head');
        /** @type {?} */
        const styleEleId = styleSheetId;
        /** @type {?} */
        let styleElement = null;
        if (document.querySelector('#' + styleEleId)) {
            styleElement = document.querySelector('#' + styleEleId);
            styleElement.innerText = '';
        }
        else {
            styleElement = document.createElement('style');
            styleElement.id = styleEleId;
            styleElement.type = 'text/css';
            htmlHead.appendChild(styleElement);
        }
        return styleElement;
    }
    /**
     * @private
     * @param {?} rules
     * @param {?} styleSheet
     * @return {?}
     */
    _appendCssRules(rules, styleSheet) {
        /** @type {?} */
        let allCssText = '';
        for (const rule of rules) {
            /** @type {?} */
            const ruleName = rule.slice(0, rule.indexOf('{')).trim();
            // const removedCssRule = this._removeCssRule(ruleName, styleSheet);
            /** @type {?} */
            const removedCssRule = this._getCssTextBySelector(ruleName, styleSheet);
            /** @type {?} */
            let cssText = '';
            if (removedCssRule && ruleName.indexOf(CUSTOM_CELL_CLS) == -1 && ruleName.indexOf(CUSTOM_GROUP_ROW_CLS) == -1 && ruleName.indexOf(CUSTOM_ROW_CLS) == -1) {
                cssText += removedCssRule.cssText.slice(removedCssRule.cssText.indexOf('{') + 1, removedCssRule.cssText.indexOf('}'));
            }
            cssText += rule.slice(rule.indexOf('{') + 1, rule.indexOf('}')).replace(/"/g, '').replace(/,/g, ';') + ';';
            /** @type {?} */
            const _newRule = `${ruleName}{ ${cssText} }`;
            allCssText += _newRule;
            if (!this.cssTextCache.includes(_newRule)) {
                // 将合并后CSS文本添加到缓存
                this.cssTextCache.push(_newRule);
                if (styleSheet.addRule) {
                    styleSheet.addRule(ruleName, cssText, 0);
                }
                else {
                    styleSheet.insertRule(_newRule, 0);
                }
            }
        }
        return allCssText;
    }
    /**
     * @private
     * @param {?} ruleName
     * @param {?} styleSheet
     * @return {?}
     */
    _removeCssRule(ruleName, styleSheet) {
        if (!styleSheet) {
            return;
        }
        /** @type {?} */
        const cssRules = (/** @type {?} */ ((styleSheet.cssRules || styleSheet.rules)));
        /** @type {?} */
        let ii = 0;
        /** @type {?} */
        let cssRule = false;
        do {
            cssRule = cssRules[ii];
            if (cssRule) {
                if (cssRule.selectorText.toLowerCase() == ruleName.toLowerCase()) {
                    if (styleSheet.cssRules) {
                        styleSheet.deleteRule(ii);
                    }
                    else {
                        styleSheet.removeRule(ii);
                    }
                    return cssRule;
                }
            }
            ii++;
        } while (cssRule);
    }
    /**
     * @param {?} gridID
     * @return {?}
     */
    createConfigKey(gridID) {
        const { host, hash, href, pathname } = location;
        /** @type {?} */
        let formCode = '';
        /** @type {?} */
        let menuId = '';
        if (hash) {
            /** @type {?} */
            const _searchArr = hash.split('?');
            formCode = _searchArr[0];
            /** @type {?} */
            const searchObj = {};
            if (_searchArr[1]) {
                _searchArr[1].split('&').map((/**
                 * @param {?} n
                 * @return {?}
                 */
                n => {
                    searchObj[n.split('=')[0]] = n.split('=')[1];
                }));
            }
            /** @type {?} */
            const catchFuncIdKEY = `${pathname}`;
            if (searchObj && Object.keys(searchObj).length) {
                menuId = searchObj.funcId || '';
                if (menuId) {
                    localStorage.setItem(catchFuncIdKEY, menuId);
                }
            }
            if (!menuId) {
                menuId = localStorage.getItem(catchFuncIdKEY);
            }
        }
        /** @type {?} */
        const key = formCode + '_' + menuId + '_' + gridID;
        if (!this.idService) {
            this.idService = new IdService();
        }
        return this.idService.encrypt(key);
    }
    /**
     * @param {?} styler
     * @param {?} args
     * @return {?}
     */
    getCustomStyle(styler, args) {
        if (typeof styler === 'object') {
            return styler;
        }
        else {
            if (typeof styler === 'function') {
                /** @type {?} */
                const p = args || [];
                return styler(...p);
            }
        }
    }
    /**
     * @param {?} nextTr
     * @param {?} dir
     * @return {?}
     */
    findNextTr(nextTr, dir) {
        /** @type {?} */
        const getNextElement = (/**
         * @param {?} target
         * @return {?}
         */
        (target) => {
            if (target && target.className.indexOf('f-datagrid-disable-row') == -1) {
                return target;
            }
            return false;
        });
        /** @type {?} */
        const m = dir === 'down' ? 'nextElementSibling' : 'previousElementSibling';
        /** @type {?} */
        const getEle = (/**
         * @param {?} t
         * @return {?}
         */
        (t) => {
            /** @type {?} */
            let n = null;
            /** @type {?} */
            let next = true;
            while (next) {
                n = getNextElement(t);
                if (n) {
                    next = false;
                }
                else {
                    if (t && t[m]) {
                        n = getNextElement(t[m]);
                        if (n) {
                            break;
                        }
                    }
                    else {
                        next = false;
                    }
                }
            }
            return n;
        });
        return getEle(nextTr);
    }
    /**
     * @private
     * @param {?} selector
     * @param {?} styleSheet
     * @return {?}
     */
    _getCssTextBySelector(selector, styleSheet) {
        if (!styleSheet) {
            return;
        }
        /** @type {?} */
        const cssRules = (/** @type {?} */ ((styleSheet.cssRules || styleSheet.rules)));
        /** @type {?} */
        let ii = 0;
        /** @type {?} */
        let cssRule = false;
        do {
            cssRule = cssRules[ii];
            if (cssRule) {
                if (cssRule.selectorText.toLowerCase() == selector.toLowerCase()) {
                    return cssRule;
                }
            }
            ii++;
        } while (cssRule);
    }
}
if (false) {
    /**
     * @type {?}
     * @private
     */
    DatagridService.prototype.scorllSubject;
    /**
     * @type {?}
     * @private
     */
    DatagridService.prototype.scrollX;
    /**
     * @type {?}
     * @private
     */
    DatagridService.prototype.rowHoverSubject;
    /**
     * @type {?}
     * @private
     */
    DatagridService.prototype.rowSelectSubject;
    /**
     * @type {?}
     * @private
     */
    DatagridService.prototype.dataSourceChangedSubject;
    /**
     * 编辑单元格
     * @type {?}
     * @private
     */
    DatagridService.prototype.editCellSubject;
    /**
     * 选中单元格
     * @type {?}
     * @private
     */
    DatagridService.prototype.selectCellSubject;
    /**
     * 结束单元编辑
     * @type {?}
     * @private
     */
    DatagridService.prototype.endCellEdit;
    /**
     * @type {?}
     * @private
     */
    DatagridService.prototype.changeCheckedRows;
    /**
     * 结束行编辑
     * @type {?}
     */
    DatagridService.prototype.scorll$;
    /** @type {?} */
    DatagridService.prototype.scrollX$;
    /** @type {?} */
    DatagridService.prototype.scrollY$;
    /** @type {?} */
    DatagridService.prototype.rowHover$;
    /** @type {?} */
    DatagridService.prototype.rowClick$;
    /** @type {?} */
    DatagridService.prototype.onDataSourceChange;
    /** @type {?} */
    DatagridService.prototype.cellEdit$;
    /** @type {?} */
    DatagridService.prototype.endCellEdit$;
    /** @type {?} */
    DatagridService.prototype.checkedRowsTotalChanged$;
    /** @type {?} */
    DatagridService.prototype.updateEmptyStyle$;
    /** @type {?} */
    DatagridService.prototype.showGridHeader;
    /** @type {?} */
    DatagridService.prototype.uncheckAll;
    /** @type {?} */
    DatagridService.prototype.checkAll;
    /** @type {?} */
    DatagridService.prototype.columnResized;
    /** @type {?} */
    DatagridService.prototype.rowHeightChanged;
    /** @type {?} */
    DatagridService.prototype.loadVirtualData;
    /**
     * 显示固定列隐影
     * @type {?}
     */
    DatagridService.prototype.showFixedShadow;
    /** @type {?} */
    DatagridService.prototype.setSelecedRow;
    /** @type {?} */
    DatagridService.prototype.setCheckedRows;
    /** @type {?} */
    DatagridService.prototype.scrollToCurrentRow;
    /** @type {?} */
    DatagridService.prototype.columnsChanged;
    /** @type {?} */
    DatagridService.prototype.cellContentWrapChanged;
    /** @type {?} */
    DatagridService.prototype.onFilterChanged;
    /** @type {?} */
    DatagridService.prototype.clearFilter;
    /** @type {?} */
    DatagridService.prototype.filterTextChange;
    /** @type {?} */
    DatagridService.prototype.toggleFilterRow;
    /** @type {?} */
    DatagridService.prototype.closeFilterPanel;
    /** @type {?} */
    DatagridService.prototype.refreshFooterData;
    /** @type {?} */
    DatagridService.prototype.disableHeader;
    /**
     * 更新全选复选框状态
     * @type {?}
     */
    DatagridService.prototype.changeCheckAllStatus;
    /** @type {?} */
    DatagridService.prototype.setScrollbarPosition;
    /** @type {?} */
    DatagridService.prototype.smartFilterBarExpand;
    /** @type {?} */
    DatagridService.prototype.smartFilterDataChange;
    /** @type {?} */
    DatagridService.prototype.scrollbarUpdate;
    /** @type {?} */
    DatagridService.prototype.footerPositionChanged;
    /** @type {?} */
    DatagridService.prototype.styleElement;
    /** @type {?} */
    DatagridService.prototype.commonUtils;
    /** @type {?} */
    DatagridService.prototype.idService;
    /** @type {?} */
    DatagridService.prototype.cellEditorCreated;
    /** @type {?} */
    DatagridService.prototype.cellEditorDestory;
    /** @type {?} */
    DatagridService.prototype.focusRowChanged;
    /** @type {?} */
    DatagridService.prototype.dataloaded;
    /** @type {?} */
    DatagridService.prototype.toggleGroupRow$;
    /** @type {?} */
    DatagridService.prototype.toggleAllGroupRows$;
    /**
     * @type {?}
     * @private
     */
    DatagridService.prototype.cssTextCache;
    /** @type {?} */
    DatagridService.prototype.groupBy;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGF0YWdyaWQuc2VydmljZS5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BmYXJyaXMvdWktZGF0YWdyaWQvIiwic291cmNlcyI6WyJsaWIvc2VydmljZXMvZGF0YWdyaWQuc2VydmljZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7QUFRQSxPQUFPLEVBQUUsWUFBWSxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBRTdDLE9BQU8sRUFBRSxPQUFPLEVBQUUsZUFBZSxFQUFFLE1BQU0sTUFBTSxDQUFDO0FBQ2hELE9BQU8sRUFBRSxNQUFNLEVBQUUsR0FBRyxFQUFFLFlBQVksRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBQzNELE9BQU8sRUFBZSxTQUFTLEVBQUUsTUFBTSxtQkFBbUIsQ0FBQztBQUczRCxPQUFPLEVBQUUsS0FBSyxFQUFFLE1BQU0sa0JBQWtCLENBQUM7QUFDekMsT0FBTyxFQUFFLGVBQWUsRUFBRSxvQkFBb0IsRUFBRSxjQUFjLEVBQUUsTUFBTSxtQkFBbUIsQ0FBQztBQWMxRixNQUFNLE9BQU8sZUFBZTtJQXNHeEI7UUFyR1Esa0JBQWEsR0FBRyxJQUFJLE9BQU8sRUFBRSxDQUFDO1FBQzlCLFlBQU8sR0FBRyxJQUFJLGVBQWUsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUVqQyxvQkFBZSxHQUFHLElBQUksT0FBTyxFQUFzQixDQUFDO1FBQ3BELHFCQUFnQixHQUFHLElBQUksT0FBTyxFQUErQixDQUFDO1FBRTlELDZCQUF3QixHQUFHLElBQUksT0FBTyxFQUFFLENBQUM7Ozs7UUFFekMsb0JBQWUsR0FBRyxJQUFJLE9BQU8sRUFBRSxDQUFDOzs7O1FBRWhDLHNCQUFpQixHQUFHLElBQUksT0FBTyxFQUFFLENBQUM7Ozs7UUFFbEMsZ0JBQVcsR0FBRyxJQUFJLE9BQU8sRUFBRSxDQUFDO1FBQzVCLHNCQUFpQixHQUFHLElBQUksT0FBTyxFQUFFLENBQUM7Ozs7O1FBSW5DLFlBQU8sR0FBRyxJQUFJLENBQUMsYUFBYSxDQUFDLFlBQVks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RCwrQ0FBaUQ7O0lBRWpELCtDQUFpRDs7SUFDakQsZ0RBQWtEOztJQUVsRCwwQ0FBNEM7O0lBRTVDLGdEQUEyQzs7SUFFM0MsdUNBQXNDOztJQUN0QyxzQ0FBZ0M7O0lBRWhDLG9DQUE0Qjs7SUFHNUIsNENBQXVDOztJQUV2Qyw0Q0FBdUM7O0lBRXZDLDBDQUFxQzs7SUFDckMscUNBQWdDOztJQUVoQywwQ0FBaUY7O0lBQ2pGLDhDQUE2RDs7Ozs7SUFHN0QsdUNBQXlDOztJQTZEekMsa0NBR00iLCJzb3VyY2VzQ29udGVudCI6WyIvKlxyXG4qIEBBdXRob3I6IOeWr+eLguengOaJjShMdWNhcyBIdWFuZylcclxuKiBARGF0ZTogMjAxOS0wOC0wNiAwNzo0Mzo1M1xyXG4qIEBMYXN0RWRpdG9yczog55av54uC56eA5omNKEx1Y2FzIEh1YW5nKVxyXG4qIEBMYXN0RWRpdFRpbWU6IDIwMTktMTEtMDkgMjA6NDQ6NTRcclxuKiBAUVE6IDEwNTU4MTgyMzlcclxuKiBAVmVyc2lvbjogdjAuMC4xXHJcbiovXHJcbmltcG9ydCB7IEV2ZW50RW1pdHRlciB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBJbmplY3RhYmxlIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IFN1YmplY3QsIEJlaGF2aW9yU3ViamVjdCB9IGZyb20gJ3J4anMnO1xyXG5pbXBvcnQgeyBmaWx0ZXIsIG1hcCwgZGVib3VuY2VUaW1lIH0gZnJvbSAncnhqcy9vcGVyYXRvcnMnO1xyXG5pbXBvcnQgeyBDb21tb25VdGlscywgSWRTZXJ2aWNlIH0gZnJvbSAnQGZhcnJpcy91aS1jb21tb24nO1xyXG5pbXBvcnQgeyBSb3dFdmVudFBhcmFtLCBSb3dIb3ZlckV2ZW50UGFyYW0gfSBmcm9tICcuLi90eXBlcy9ldmVudC1wYXJhbXMnO1xyXG5pbXBvcnQgeyBDZWxsSW5mbyB9IGZyb20gJy4vc3RhdGUnO1xyXG5pbXBvcnQgeyBVdGlscyB9IGZyb20gJy4vLi4vdXRpbHMvdXRpbHMnO1xyXG5pbXBvcnQgeyBDVVNUT01fQ0VMTF9DTFMsIENVU1RPTV9HUk9VUF9ST1dfQ0xTLCBDVVNUT01fUk9XX0NMUyB9IGZyb20gJy4uL3R5cGVzL2NvbnN0YW50JztcclxuXHJcbmV4cG9ydCB0eXBlIFNjcm9sbEFjdGlvbiA9XHJcbiAgICB8ICdwc1Njcm9sbFknXHJcbiAgICB8ICdwc1Njcm9sbFgnXHJcbiAgICB8ICdwc1Njcm9sbFVwJ1xyXG4gICAgfCAncHNTY3JvbGxEb3duJ1xyXG4gICAgfCAncHNTY3JvbGxMZWZ0J1xyXG4gICAgfCAncHNTY3JvbGxSaWdodCdcclxuICAgIHwgJ3BzWVJlYWNoRW5kJ1xyXG4gICAgfCAncHNZUmVhY2hTdGFydCdcclxuICAgIHwgJ3BzWFJlYWNoRW5kJ1xyXG4gICAgfCAncHNYUmVhY2hTdGFydCc7XHJcblxyXG5leHBvcnQgY2xhc3MgRGF0YWdyaWRTZXJ2aWNlIHtcclxuICAgIHByaXZhdGUgc2NvcmxsU3ViamVjdCA9IG5ldyBTdWJqZWN0KCk7XHJcbiAgICBwcml2YXRlIHNjcm9sbFggPSBuZXcgQmVoYXZpb3JTdWJqZWN0KDApO1xyXG5cclxuICAgIHByaXZhdGUgcm93SG92ZXJTdWJqZWN0ID0gbmV3IFN1YmplY3Q8Um93SG92ZXJFdmVudFBhcmFtPigpO1xyXG4gICAgcHJpdmF0ZSByb3dTZWxlY3RTdWJqZWN0ID0gbmV3IFN1YmplY3Q8UGFydGlhbDxSb3dIb3ZlckV2ZW50UGFyYW0+PigpO1xyXG5cclxuICAgIHByaXZhdGUgZGF0YVNvdXJjZUNoYW5nZWRTdWJqZWN0ID0gbmV3IFN1YmplY3QoKTtcclxuICAgIC8qKiDnvJbovpHljZXlhYPmoLwgKi9cclxuICAgIHByaXZhdGUgZWRpdENlbGxTdWJqZWN0ID0gbmV3IFN1YmplY3QoKTtcclxuICAgIC8qKiDpgInkuK3ljZXlhYPmoLwgKi9cclxuICAgIHByaXZhdGUgc2VsZWN0Q2VsbFN1YmplY3QgPSBuZXcgU3ViamVjdCgpO1xyXG4gICAgLyoqIOe7k+adn+WNleWFg+e8lui+kSAqL1xyXG4gICAgcHJpdmF0ZSBlbmRDZWxsRWRpdCA9IG5ldyBTdWJqZWN0KCk7XHJcbiAgICBwcml2YXRlIGNoYW5nZUNoZWNrZWRSb3dzID0gbmV3IFN1YmplY3QoKTtcclxuICAgIC8qKiDnu5PmnZ/ooYznvJbovpEgKi9cclxuICAgIC8vIHByaXZhdGUgZW5kUm93RWRpdCA9IG5ldyBCZWhhdmlvclN1YmplY3QodHJ1ZSk7XHJcblxyXG4gICAgcHVibGljIHNjb3JsbCQgPSB0aGlzLnNjb3JsbFN1YmplY3QuYXNPYnNlcnZhYmxlKCk7XHJcbiAgICBwdWJsaWMgc2Nyb2xsWCQgPSB0aGlzLnNjb3JsbCQucGlwZShcclxuICAgICAgICBmaWx0ZXIoKHA6IGFueSkgPT4gcC50eXBlID09PSAncHNTY3JvbGxYJyksXHJcbiAgICAgICAgbWFwKHQgPT4gdC54KSxcclxuICAgICAgICBkZWJvdW5jZVRpbWUoNTApXHJcbiAgICApO1xyXG4gICAgcHVibGljIHNjcm9sbFkkID0gdGhpcy5zY29ybGwkLnBpcGUoXHJcbiAgICAgICAgZmlsdGVyKChwOiBhbnkpID0+IHAudHlwZSA9PT0gJ3BzU2Nyb2xsWScpLFxyXG4gICAgICAgIG1hcCh0ID0+IHQueCksXHJcbiAgICAgICAgZGVib3VuY2VUaW1lKDUwKVxyXG4gICAgKTtcclxuICAgIHB1YmxpYyByb3dIb3ZlciQgPSB0aGlzLnJvd0hvdmVyU3ViamVjdC5hc09ic2VydmFibGUoKTtcclxuICAgIHB1YmxpYyByb3dDbGljayQgPSB0aGlzLnJvd1NlbGVjdFN1YmplY3QuYXNPYnNlcnZhYmxlKCk7XHJcbiAgICBwdWJsaWMgb25EYXRhU291cmNlQ2hhbmdlID0gdGhpcy5kYXRhU291cmNlQ2hhbmdlZFN1YmplY3QuYXNPYnNlcnZhYmxlKCk7XHJcbiAgICBwdWJsaWMgY2VsbEVkaXQkID0gdGhpcy5lZGl0Q2VsbFN1YmplY3QuYXNPYnNlcnZhYmxlKCk7XHJcbiAgICBwdWJsaWMgZW5kQ2VsbEVkaXQkID0gdGhpcy5lbmRDZWxsRWRpdC5hc09ic2VydmFibGUoKTtcclxuICAgIHB1YmxpYyBjaGVja2VkUm93c1RvdGFsQ2hhbmdlZCQgPSB0aGlzLmNoYW5nZUNoZWNrZWRSb3dzLmFzT2JzZXJ2YWJsZSgpO1xyXG4gICAgcHVibGljIHVwZGF0ZUVtcHR5U3R5bGUkID0gbmV3IEV2ZW50RW1pdHRlcigpO1xyXG5cclxuICAgIHB1YmxpYyBzaG93R3JpZEhlYWRlciA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcclxuICAgIC8vIOWPlua2iOWFqOmAiVxyXG4gICAgcHVibGljIHVuY2hlY2tBbGwgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XHJcbiAgICAvLyDlhajpg6jpgInkuK1cclxuICAgIHB1YmxpYyBjaGVja0FsbCA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcclxuXHJcbiAgICBwdWJsaWMgY29sdW1uUmVzaXplZCA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcclxuXHJcbiAgICBwdWJsaWMgcm93SGVpZ2h0Q2hhbmdlZCA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcclxuXHJcbiAgICBwdWJsaWMgbG9hZFZpcnR1YWxEYXRhID0gbmV3IEV2ZW50RW1pdHRlcigpO1xyXG4gICAgLyoqIOaYvuekuuWbuuWumuWIl+makOW9sSAqL1xyXG4gICAgcHVibGljIHNob3dGaXhlZFNoYWRvdyA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcclxuICAgIC8vIHB1YmxpYyBlbmRSb3dFZGl0JCA9IHRoaXMuZW5kUm93RWRpdC5hc09ic2VydmFibGUoKTtcclxuXHJcbiAgICBwdWJsaWMgc2V0U2VsZWNlZFJvdyA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcclxuICAgIHB1YmxpYyBzZXRDaGVja2VkUm93cyA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcclxuXHJcbiAgICBwdWJsaWMgc2Nyb2xsVG9DdXJyZW50Um93ID0gbmV3IEV2ZW50RW1pdHRlcigpO1xyXG5cclxuICAgIHB1YmxpYyBjb2x1bW5zQ2hhbmdlZCA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcclxuXHJcbiAgICBwdWJsaWMgY2VsbENvbnRlbnRXcmFwQ2hhbmdlZCA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcclxuXHJcbiAgICBwdWJsaWMgb25GaWx0ZXJDaGFuZ2VkID0gbmV3IEV2ZW50RW1pdHRlcigpO1xyXG4gICAgcHVibGljIGNsZWFyRmlsdGVyID0gbmV3IEV2ZW50RW1pdHRlcigpO1xyXG4gICAgcHVibGljIGZpbHRlclRleHRDaGFuZ2UgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XHJcbiAgICBwdWJsaWMgdG9nZ2xlRmlsdGVyUm93ID0gbmV3IEV2ZW50RW1pdHRlcigpO1xyXG5cclxuICAgIHB1YmxpYyBjbG9zZUZpbHRlclBhbmVsID0gbmV3IEV2ZW50RW1pdHRlcigpO1xyXG5cclxuICAgIHB1YmxpYyByZWZyZXNoRm9vdGVyRGF0YSA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcclxuXHJcbiAgICBwdWJsaWMgZGlzYWJsZUhlYWRlciA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcclxuICAgIC8qKiDmm7TmlrDlhajpgInlpI3pgInmoYbnirbmgIEgKi9cclxuICAgIHB1YmxpYyBjaGFuZ2VDaGVja0FsbFN0YXR1cyA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcclxuXHJcbiAgICBwdWJsaWMgc2V0U2Nyb2xsYmFyUG9zaXRpb24gPSBuZXcgRXZlbnRFbWl0dGVyKCk7XHJcblxyXG4gICAgcHVibGljIHNtYXJ0RmlsdGVyQmFyRXhwYW5kID0gbmV3IEV2ZW50RW1pdHRlcigpO1xyXG4gICAgcHVibGljIHNtYXJ0RmlsdGVyRGF0YUNoYW5nZSA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcclxuXHJcbiAgICBwdWJsaWMgc2Nyb2xsYmFyVXBkYXRlID0gbmV3IEV2ZW50RW1pdHRlcigpO1xyXG5cclxuICAgIGZvb3RlclBvc2l0aW9uQ2hhbmdlZCA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcclxuXHJcbiAgICBzdHlsZUVsZW1lbnQ6IEhUTUxTdHlsZUVsZW1lbnQgPSBudWxsO1xyXG4gICAgY29tbW9uVXRpbHM6IENvbW1vblV0aWxzID0gbnVsbDtcclxuXHJcbiAgICBpZFNlcnZpY2U6IElkU2VydmljZSA9IG51bGw7XHJcblxyXG4gICAgLy8g5Y2V5YWD5qC857yW6L6R5Zmo5Yib5bu65a6M5oiQXHJcbiAgICBjZWxsRWRpdG9yQ3JlYXRlZCA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcclxuICAgIC8vIOWNleWFg+agvOe8lui+keWZqOmUgOavgVxyXG4gICAgY2VsbEVkaXRvckRlc3RvcnkgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XHJcbiAgICAvLyDnhKbngrnooYzliIfmjaJcclxuICAgIGZvY3VzUm93Q2hhbmdlZCA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcclxuICAgIGRhdGFsb2FkZWQgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XHJcblxyXG4gICAgdG9nZ2xlR3JvdXBSb3ckID0gbmV3IEV2ZW50RW1pdHRlcjx7IGdyb3VwUm93SW5kZXg6IG51bWJlciwgZXhwYW5kOiBib29sZWFuIH0+KCk7XHJcbiAgICB0b2dnbGVBbGxHcm91cFJvd3MkID0gbmV3IEV2ZW50RW1pdHRlcjx7ZXhwYW5kOiBib29sZWFuIH0+KCk7XHJcbiAgICBcclxuICAgIC8vIENTUyDmlofmnKznvJPlrZhcclxuICAgIHByaXZhdGUgY3NzVGV4dENhY2hlOiBBcnJheTxzdHJpbmc+ID0gW107XHJcblxyXG4gICAgY29uc3RydWN0b3IoKSB7IH1cclxuXHJcbiAgICBvblNjcm9sbE1vdmUoeDogbnVtYmVyLCBhY3Rpb246IFNjcm9sbEFjdGlvbikge1xyXG4gICAgICAgIHRoaXMuc2NvcmxsU3ViamVjdC5uZXh0KHsgeCwgdHlwZTogYWN0aW9uIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIGRhdGFTb3VyY2VDaGFuZ2VkKCkge1xyXG4gICAgICAgIHRoaXMuZGF0YVNvdXJjZUNoYW5nZWRTdWJqZWN0Lm5leHQoKTtcclxuICAgIH1cclxuXHJcbiAgICBvblJvd0hvdmVyKHJvd0luZGV4OiBudW1iZXIsIHJvd0RhdGE6IGFueSwgbW91c2VFbnRlcjogYm9vbGVhbikge1xyXG4gICAgICAgIHRoaXMucm93SG92ZXJTdWJqZWN0Lm5leHQoeyBpbmRleDogcm93SW5kZXgsIGRhdGE6IHJvd0RhdGEsIG1vdXNlZW50ZXI6IG1vdXNlRW50ZXIgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgb25Sb3dDbGljayhyb3dJbmRleDogbnVtYmVyLCByb3dEYXRhOiBhbnkpIHtcclxuICAgICAgICB0aGlzLnJvd1NlbGVjdFN1YmplY3QubmV4dCh7IGluZGV4OiByb3dJbmRleCwgZGF0YTogcm93RGF0YSB9KTtcclxuICAgIH1cclxuXHJcbiAgICBvbkNlbGxFZGl0KHRkRWxlbWVudDogYW55KSB7XHJcbiAgICAgICAgdGhpcy5lZGl0Q2VsbFN1YmplY3QubmV4dCh0ZEVsZW1lbnQpO1xyXG4gICAgfVxyXG5cclxuICAgIG9uRW5kQ2VsbEVkaXQoY2VsbDogQ2VsbEluZm8pIHtcclxuICAgICAgICB0aGlzLmVuZENlbGxFZGl0Lm5leHQoY2VsbCk7XHJcbiAgICB9XHJcblxyXG4gICAgb25TZWxlY3RDZWxsKGNlbGw6IENlbGxJbmZvKSB7XHJcbiAgICAgICAgdGhpcy5zZWxlY3RDZWxsU3ViamVjdC5uZXh0KGNlbGwpO1xyXG4gICAgfVxyXG5cclxuICAgIG9uQ2hlY2tlZFJvd3NDb3VudENoYW5nZSgpIHtcclxuICAgICAgICB0aGlzLmNoYW5nZUNoZWNrZWRSb3dzLm5leHQoKTtcclxuICAgIH1cclxuXHJcbiAgICBvblJvd0hlaWdodENoYW5nZShyb3dIZWlnaHQ6IG51bWJlcikge1xyXG4gICAgICAgIHRoaXMucm93SGVpZ2h0Q2hhbmdlZC5lbWl0KHJvd0hlaWdodCk7XHJcbiAgICB9XHJcblxyXG4gICAgb25Mb2FkVmlydHVhbERhdGEoZGF0YTogYW55KSB7XHJcbiAgICAgICAgdGhpcy5sb2FkVmlydHVhbERhdGEuZW1pdCh7IGRhdGEgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgb25DbGVhckZpbHRlcigpIHtcclxuICAgICAgICB0aGlzLmNsZWFyRmlsdGVyLmVtaXQoKTtcclxuICAgICAgICB0aGlzLmZpbHRlclRleHRDaGFuZ2UuZW1pdCgnJyk7XHJcbiAgICB9XHJcblxyXG4gICAgb25GaWx0ZXJUZXh0Q2hhbmdlKHR4dDogc3RyaW5nKSB7XHJcbiAgICAgICAgdGhpcy5maWx0ZXJUZXh0Q2hhbmdlLmVtaXQodHh0KTtcclxuICAgIH1cclxuXHJcbiAgICByZXN0b3JlU2Nyb2xsYmFyUG9zaXRpb24oKSB7XHJcbiAgICAgICAgdGhpcy5zZXRTY3JvbGxiYXJQb3NpdGlvbi5lbWl0KCk7XHJcbiAgICB9XHJcblxyXG4gICAgdXBkYXRlRW1wdHlTdHlsZSgpIHtcclxuICAgICAgICB0aGlzLnVwZGF0ZUVtcHR5U3R5bGUkLmVtaXQoKTtcclxuICAgIH1cclxuXHJcbiAgICBncm91cEJ5ID0gKGFyciwgZm4pID0+IGFyci5tYXAodHlwZW9mIGZuID09PSAnZnVuY3Rpb24nID8gZm4gOiB2YWwgPT4gVXRpbHMuZ2V0VmFsdWUoZm4sIHZhbCkpLnJlZHVjZSgoYWNjLCB2YWwsIGkpID0+IHtcclxuICAgICAgICBhY2NbdmFsXSA9IChhY2NbdmFsXSB8fCBbXSkuY29uY2F0KGFycltpXSk7XHJcbiAgICAgICAgcmV0dXJuIGFjYztcclxuICAgIH0sIHt9KVxyXG5cclxuICAgIGdldE1lcmdlQ2VsbEluZm8oZGF0YSwgbWVyZ2VGaWVsZHMpIHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSB7fTtcclxuICAgICAgICBsZXQgZmlyc3RWYWwgPSBudWxsO1xyXG4gICAgICAgIGxldCBjdXJyVmFsO1xyXG5cclxuICAgICAgICBtZXJnZUZpZWxkcy5mb3JFYWNoKChmLCBpKSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChpID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICBkYXRhLmZvckVhY2goKGQsIGopID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBpdGVtID0geyBbZl06IHsgc2hvdzogdHJ1ZSwgcm93c3BhbjogMSB9IH07XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFyZXN1bHRbal0pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0W2pdID0gaXRlbTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXJlc3VsdFtqXVtmXSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0W2pdID0gT2JqZWN0LmFzc2lnbihyZXN1bHRbal0sIGl0ZW0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBfaXRlbSA9IHJlc3VsdFtqXTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgY3VyclZhbCA9IGRbZl07XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGZpcnN0VmFsID09PSBudWxsIHx8IGZpcnN0VmFsICE9PSBjdXJyVmFsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZpcnN0VmFsID0gY3VyclZhbDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2l0ZW1bZl0uc2hvdyA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9pdGVtW2ZdLnN0YXJ0SW5kZXggPSBqO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHN0ckluZGV4ID0gcmVzdWx0W2ogLSAxXVtmXS5zdGFydEluZGV4O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfaXRlbVtmXS5zdGFydEluZGV4ID0gc3RySW5kZXg7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9pdGVtW2ZdLnNob3cgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0W3N0ckluZGV4XVtmXS5yb3dzcGFuKys7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgIH1cclxuXHJcbiAgICBnZXRNZXJnZUNlbGxJbmZvMChkYXRhLCBmaWVsZCkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IHt9O1xyXG4gICAgICAgIGxldCBmaXJzdFZhbDtcclxuICAgICAgICBsZXQgY3VyclZhbDtcclxuICAgICAgICBkYXRhLmZvckVhY2goKGQsIGopID0+IHtcclxuICAgICAgICAgICAgY29uc3QgaXRlbSA9IHsgW2ZpZWxkXTogeyBzaG93OiB0cnVlLCByb3dzcGFuOiAxLCB2YWx1ZTogJycgfSB9O1xyXG4gICAgICAgICAgICBpZiAoIXJlc3VsdFtqXSkge1xyXG4gICAgICAgICAgICAgICAgcmVzdWx0W2pdID0gaXRlbTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgY29uc3QgX2l0ZW0gPSByZXN1bHRbal07XHJcbiAgICAgICAgICAgIGN1cnJWYWwgPSBVdGlscy5nZXRWYWx1ZShmaWVsZCwgZCk7XHJcbiAgICAgICAgICAgIF9pdGVtW2ZpZWxkXS52YWx1ZSA9IGN1cnJWYWw7XHJcbiAgICAgICAgICAgIGlmIChmaXJzdFZhbCA9PT0gdW5kZWZpbmVkIHx8IGZpcnN0VmFsICE9PSBjdXJyVmFsKSB7XHJcbiAgICAgICAgICAgICAgICBmaXJzdFZhbCA9IGN1cnJWYWw7XHJcbiAgICAgICAgICAgICAgICBfaXRlbVtmaWVsZF0uc2hvdyA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICBfaXRlbVtmaWVsZF0uc3RhcnRJbmRleCA9IGo7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBzdHJJbmRleCA9IHJlc3VsdFtqIC0gMV1bZmllbGRdLnN0YXJ0SW5kZXg7XHJcbiAgICAgICAgICAgICAgICBfaXRlbVtmaWVsZF0uc3RhcnRJbmRleCA9IHN0ckluZGV4O1xyXG4gICAgICAgICAgICAgICAgX2l0ZW1bZmllbGRdLnNob3cgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIHJlc3VsdFtzdHJJbmRleF1bZmllbGRdLnJvd3NwYW4rKztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0TWVyZ2VDZWxsSW5mbzIoZGF0YSwgbWVyZ2VGaWVsZHMpIHtcclxuICAgICAgICBsZXQgcmVzdWx0ID0ge307XHJcbiAgICAgICAgbGV0IGZpcnN0VmFsID0gbnVsbDtcclxuICAgICAgICByZXN1bHQgPSB0aGlzLmdldE1lcmdlQ2VsbEluZm8wKGRhdGEsIG1lcmdlRmllbGRzLnNwbGljZSgwLCAxKVswXSk7XHJcblxyXG4gICAgICAgIGNvbnN0IGdyb3VwRGF0YSA9IHRoaXMuZ3JvdXBCeShkYXRhLCBtZXJnZUZpZWxkc1swXSk7XHJcbiAgICAgICAgY29uc3QgZ3JvdXBLZXlzID0gT2JqZWN0LmtleXMoZ3JvdXBEYXRhKTtcclxuICAgICAgICBsZXQgc3RhcnRSb3dJbmRleCA9IDA7XHJcbiAgICAgICAgbWVyZ2VGaWVsZHMuZm9yRWFjaCgoZiwgaSkgPT4ge1xyXG4gICAgICAgICAgICBncm91cEtleXMuZm9yRWFjaCgoaywgaikgPT4ge1xyXG4gICAgICAgICAgICAgICAgbGV0IGN1cnJWYWw7XHJcbiAgICAgICAgICAgICAgICBncm91cERhdGFba10uZm9yRWFjaCgoZCwgbikgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChyZXN1bHRbc3RhcnRSb3dJbmRleF0gJiYgIXJlc3VsdFtzdGFydFJvd0luZGV4XVtmXSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHRbc3RhcnRSb3dJbmRleF0gPSBPYmplY3QuYXNzaWduKHJlc3VsdFtzdGFydFJvd0luZGV4XSwgeyBbZl06IHsgc2hvdzogdHJ1ZSwgcm93c3BhbjogMSwgdmFsdWU6ICcnIH0gfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBfaXRlbSA9IHJlc3VsdFtzdGFydFJvd0luZGV4XTtcclxuICAgICAgICAgICAgICAgICAgICBjdXJyVmFsID0gVXRpbHMuZ2V0VmFsdWUoZiwgZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgX2l0ZW1bZl0udmFsdWUgPSBjdXJyVmFsO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChmaXJzdFZhbCA9PT0gbnVsbCB8fCBmaXJzdFZhbCAhPT0gY3VyclZhbCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmaXJzdFZhbCA9IGN1cnJWYWw7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9pdGVtW2ZdLnNob3cgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfaXRlbVtmXS5zdGFydEluZGV4ID0gc3RhcnRSb3dJbmRleDtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzdHJJbmRleCA9IHJlc3VsdFtzdGFydFJvd0luZGV4IC0gMV1bZl0uc3RhcnRJbmRleDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2l0ZW1bZl0uc3RhcnRJbmRleCA9IHN0ckluZGV4O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfaXRlbVtmXS5zaG93ID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdFtzdHJJbmRleF1bZl0ucm93c3BhbisrO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgc3RhcnRSb3dJbmRleCsrO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICB9XHJcblxyXG5cclxuICAgIGdldE1lcmdlQ2VsbEluZm8zKGRhdGEsIG1lcmdlRmllbGRzKSB7XHJcbiAgICAgICAgbGV0IHJlc3VsdCA9IHt9O1xyXG4gICAgICAgIGNvbnN0IGZpcnN0RmllbGQgPSBtZXJnZUZpZWxkcy5zcGxpY2UoMCwgMSlbMF07XHJcbiAgICAgICAgcmVzdWx0ID0gdGhpcy5nZXRNZXJnZUNlbGxJbmZvMChkYXRhLCBmaXJzdEZpZWxkKTtcclxuICAgICAgICBsZXQgcHJldkdyb3VwRmllbGQgPSBmaXJzdEZpZWxkO1xyXG4gICAgICAgIC8vIGNvbnN0IGdyb3VwRGF0YSA9IHRoaXMuZ3JvdXBCeShkYXRhLCBmaXJzdEZpZWxkKTtcclxuICAgICAgICAvLyBjb25zdCBncm91cEtleXMgPSBPYmplY3Qua2V5cyhncm91cERhdGEpO1xyXG4gICAgICAgIG1lcmdlRmllbGRzLmZvckVhY2goKGYsIGkpID0+IHtcclxuICAgICAgICAgICAgbGV0IHN0YXJ0Um93SW5kZXggPSAwO1xyXG5cclxuICAgICAgICAgICAgbGV0IGZpcnN0VmFsO1xyXG4gICAgICAgICAgICBsZXQgY3VyclZhbDtcclxuXHJcbiAgICAgICAgICAgIGlmIChpID4gMCkge1xyXG4gICAgICAgICAgICAgICAgcHJldkdyb3VwRmllbGQgPSBtZXJnZUZpZWxkc1tpIC0gMV07XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGRhdGEuZm9yRWFjaCgoZCwgbikgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKHJlc3VsdFtzdGFydFJvd0luZGV4XSAmJiAhcmVzdWx0W3N0YXJ0Um93SW5kZXhdW2ZdKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0W3N0YXJ0Um93SW5kZXhdID0gT2JqZWN0LmFzc2lnbihyZXN1bHRbc3RhcnRSb3dJbmRleF0sIHsgW2ZdOiB7IHNob3c6IHRydWUsIHJvd3NwYW46IDEsIHZhbHVlOiAnJyB9IH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGNvbnN0IF9pdGVtID0gcmVzdWx0W3N0YXJ0Um93SW5kZXhdO1xyXG4gICAgICAgICAgICAgICAgY3VyclZhbCA9IFV0aWxzLmdldFZhbHVlKGYsIGQpO1xyXG4gICAgICAgICAgICAgICAgX2l0ZW1bZl0udmFsdWUgPSBjdXJyVmFsO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmIChzdGFydFJvd0luZGV4ID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHByZXZJdGVtID0gcmVzdWx0W3N0YXJ0Um93SW5kZXggLSAxXTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBfYyA9IE9iamVjdC5rZXlzKF9pdGVtKS5tYXAoYyA9PiAnJyArIF9pdGVtW2NdLnZhbHVlKS5qb2luKCcsJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgX3AgPSBPYmplY3Qua2V5cyhwcmV2SXRlbSkubWFwKHAgPT4gJycgKyBwcmV2SXRlbVtwXS52YWx1ZSkuam9pbignLCcpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBpZiAoX2MgIT09IF9wKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZpcnN0VmFsID0gdW5kZWZpbmVkO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoKGZpcnN0VmFsID09PSB1bmRlZmluZWQgfHwgZmlyc3RWYWwgIT09IGN1cnJWYWwpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZmlyc3RWYWwgPSBjdXJyVmFsO1xyXG4gICAgICAgICAgICAgICAgICAgIF9pdGVtW2ZdLnNob3cgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIF9pdGVtW2ZdLnN0YXJ0SW5kZXggPSBzdGFydFJvd0luZGV4O1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBzdGFydEluZGV4ID0gcmVzdWx0W3N0YXJ0Um93SW5kZXggLSAxXVtmXS5zdGFydEluZGV4O1xyXG4gICAgICAgICAgICAgICAgICAgIF9pdGVtW2ZdLnN0YXJ0SW5kZXggPSBzdGFydEluZGV4O1xyXG4gICAgICAgICAgICAgICAgICAgIF9pdGVtW2ZdLnNob3cgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICByZXN1bHRbc3RhcnRJbmRleF1bZl0ucm93c3BhbisrO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGlmIChkYXRhLmxlbmd0aCAtIDEgPiBzdGFydFJvd0luZGV4KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc3RhcnRSb3dJbmRleCsrO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgfVxyXG5cclxuXHJcbiAgICBnZXRNZXJnZUluZm8ocm93SW5kZXg6IG51bWJlciwgZmllbGQ6IHN0cmluZywgbWVyZ2VDZWxsSW5mbzogYW55KSB7XHJcbiAgICAgICAgaWYgKGZpZWxkICYmIG1lcmdlQ2VsbEluZm8gJiYgbWVyZ2VDZWxsSW5mb1tyb3dJbmRleF0gJiYgbWVyZ2VDZWxsSW5mb1tyb3dJbmRleF1bZmllbGRdKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBtZXJnZUNlbGxJbmZvW3Jvd0luZGV4XVtmaWVsZF07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfVxyXG5cclxuICAgIHJlbW92ZVN0eWxlU2hlZXQoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuc3R5bGVFbGVtZW50KSB7XHJcbiAgICAgICAgICAgIHRoaXMuc3R5bGVFbGVtZW50LnJlbW92ZSgpO1xyXG4gICAgICAgICAgICB0aGlzLnN0eWxlRWxlbWVudCA9IG51bGw7XHJcbiAgICAgICAgICAgIC8vIOa4heepuue8k+WtmFxyXG4gICAgICAgICAgICB0aGlzLmNzc1RleHRDYWNoZSA9IFtdO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBjcmVhdGVTdHlsZUVsZW1lbnQoc3R5bGVTaGVldElkOiBzdHJpbmcpIHtcclxuICAgICAgICB0aGlzLnN0eWxlRWxlbWVudCA9IHRoaXMuX2NyZWF0ZVN0eWxlU2hlZXQoc3R5bGVTaGVldElkKTtcclxuICAgIH1cclxuXHJcbiAgICBhcHBlbmRDc3NSdWxlcyhydWxlczogc3RyaW5nW10pIHtcclxuICAgICAgICBpZiAodGhpcy5zdHlsZUVsZW1lbnQpIHtcclxuICAgICAgICAgICAgdGhpcy5fYXBwZW5kQ3NzUnVsZXMocnVsZXMsIHRoaXMuc3R5bGVFbGVtZW50LnNoZWV0KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcmVtb3ZlQ3NzUnVsZShydWxlTmFtZTogc3RyaW5nIHwgQXJyYXk8c3RyaW5nPikge1xyXG4gICAgICAgIGlmICh0aGlzLnN0eWxlRWxlbWVudCkge1xyXG4gICAgICAgICAgICBpZiAodHlwZW9mIHJ1bGVOYW1lID09PSAnc3RyaW5nJykge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fcmVtb3ZlQ3NzUnVsZShydWxlTmFtZSwgdGhpcy5zdHlsZUVsZW1lbnQuc2hlZXQpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jc3NUZXh0Q2FjaGUgPSB0aGlzLmNzc1RleHRDYWNoZS5maWx0ZXIobiA9PiBuLmluZGV4T2YocnVsZU5hbWUpID09IC0xKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGlmIChBcnJheS5pc0FycmF5KHJ1bGVOYW1lKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJ1bGVOYW1lLmZvckVhY2gobiA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3JlbW92ZUNzc1J1bGUobiwgdGhpcy5zdHlsZUVsZW1lbnQuc2hlZXQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNzc1RleHRDYWNoZSA9IHRoaXMuY3NzVGV4dENhY2hlLmZpbHRlcihuID0+IG4uaW5kZXhPZihuKSA9PSAtMSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG5cclxuICAgIHByaXZhdGUgX2NyZWF0ZVN0eWxlU2hlZXQoc3R5bGVTaGVldElkOiBzdHJpbmcpOiBIVE1MU3R5bGVFbGVtZW50IHtcclxuICAgICAgICBjb25zdCBodG1sSGVhZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2hlYWQnKTtcclxuXHJcbiAgICAgICAgY29uc3Qgc3R5bGVFbGVJZCA9IHN0eWxlU2hlZXRJZDtcclxuICAgICAgICBsZXQgc3R5bGVFbGVtZW50ID0gbnVsbDtcclxuICAgICAgICBpZiAoZG9jdW1lbnQucXVlcnlTZWxlY3RvcignIycgKyBzdHlsZUVsZUlkKSkge1xyXG4gICAgICAgICAgICBzdHlsZUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjJyArIHN0eWxlRWxlSWQpO1xyXG4gICAgICAgICAgICBzdHlsZUVsZW1lbnQuaW5uZXJUZXh0ID0gJyc7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgc3R5bGVFbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3R5bGUnKTtcclxuICAgICAgICAgICAgc3R5bGVFbGVtZW50LmlkID0gc3R5bGVFbGVJZDtcclxuICAgICAgICAgICAgc3R5bGVFbGVtZW50LnR5cGUgPSAndGV4dC9jc3MnO1xyXG4gICAgICAgICAgICBodG1sSGVhZC5hcHBlbmRDaGlsZChzdHlsZUVsZW1lbnQpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHN0eWxlRWxlbWVudDtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIF9hcHBlbmRDc3NSdWxlcyhydWxlczogc3RyaW5nW10sIHN0eWxlU2hlZXQpIHtcclxuICAgICAgICBsZXQgYWxsQ3NzVGV4dCA9ICcnO1xyXG4gICAgICAgIGZvciAoY29uc3QgcnVsZSBvZiBydWxlcykge1xyXG4gICAgICAgICAgICBjb25zdCBydWxlTmFtZSA9IHJ1bGUuc2xpY2UoMCwgcnVsZS5pbmRleE9mKCd7JykpLnRyaW0oKTtcclxuXHJcbiAgICAgICAgICAgIC8vIGNvbnN0IHJlbW92ZWRDc3NSdWxlID0gdGhpcy5fcmVtb3ZlQ3NzUnVsZShydWxlTmFtZSwgc3R5bGVTaGVldCk7XHJcbiAgICAgICAgICAgIGNvbnN0IHJlbW92ZWRDc3NSdWxlID0gdGhpcy5fZ2V0Q3NzVGV4dEJ5U2VsZWN0b3IocnVsZU5hbWUsIHN0eWxlU2hlZXQpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgbGV0IGNzc1RleHQgPSAnJztcclxuICAgICAgICAgICAgaWYgKHJlbW92ZWRDc3NSdWxlICYmIHJ1bGVOYW1lLmluZGV4T2YoQ1VTVE9NX0NFTExfQ0xTKSA9PSAtMSAmJiBydWxlTmFtZS5pbmRleE9mKENVU1RPTV9HUk9VUF9ST1dfQ0xTKSA9PSAtMSAgJiYgcnVsZU5hbWUuaW5kZXhPZihDVVNUT01fUk9XX0NMUykgPT0gLTEpIHtcclxuICAgICAgICAgICAgICAgIGNzc1RleHQgKz0gcmVtb3ZlZENzc1J1bGUuY3NzVGV4dC5zbGljZShyZW1vdmVkQ3NzUnVsZS5jc3NUZXh0LmluZGV4T2YoJ3snKSArIDEsIHJlbW92ZWRDc3NSdWxlLmNzc1RleHQuaW5kZXhPZignfScpKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjc3NUZXh0ICs9IHJ1bGUuc2xpY2UocnVsZS5pbmRleE9mKCd7JykgKyAxLCBydWxlLmluZGV4T2YoJ30nKSkucmVwbGFjZSgvXCIvZywgJycpLnJlcGxhY2UoLywvZywgJzsnKSArICc7JztcclxuICAgICAgICAgICAgY29uc3QgX25ld1J1bGUgPSAgYCR7cnVsZU5hbWV9eyAke2Nzc1RleHR9IH1gO1xyXG4gICAgICAgICAgICBhbGxDc3NUZXh0ICs9IF9uZXdSdWxlO1xyXG4gICAgICAgICAgICBcclxuXHJcbiAgICAgICAgICAgIGlmICghdGhpcy5jc3NUZXh0Q2FjaGUuaW5jbHVkZXMoX25ld1J1bGUpKSB7XHJcbiAgICAgICAgICAgICAgICAvLyDlsIblkIjlubblkI5DU1PmlofmnKzmt7vliqDliLDnvJPlrZhcclxuICAgICAgICAgICAgICAgIHRoaXMuY3NzVGV4dENhY2hlLnB1c2goX25ld1J1bGUpO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmIChzdHlsZVNoZWV0LmFkZFJ1bGUpIHtcclxuICAgICAgICAgICAgICAgICAgICBzdHlsZVNoZWV0LmFkZFJ1bGUocnVsZU5hbWUsIGNzc1RleHQsIDApO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBzdHlsZVNoZWV0Lmluc2VydFJ1bGUoX25ld1J1bGUsIDApO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBhbGxDc3NUZXh0O1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgX3JlbW92ZUNzc1J1bGUocnVsZU5hbWU6IHN0cmluZywgc3R5bGVTaGVldCkge1xyXG5cclxuICAgICAgICBpZiAoIXN0eWxlU2hlZXQpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3QgY3NzUnVsZXMgPSAoc3R5bGVTaGVldC5jc3NSdWxlcyB8fCBzdHlsZVNoZWV0LnJ1bGVzKSBhcyBhbnk7XHJcbiAgICAgICAgbGV0IGlpID0gMDtcclxuICAgICAgICBsZXQgY3NzUnVsZTogYW55ID0gZmFsc2U7XHJcblxyXG4gICAgICAgIGRvIHtcclxuICAgICAgICAgICAgY3NzUnVsZSA9IGNzc1J1bGVzW2lpXTtcclxuICAgICAgICAgICAgaWYgKGNzc1J1bGUpIHtcclxuICAgICAgICAgICAgICAgIGlmIChjc3NSdWxlLnNlbGVjdG9yVGV4dC50b0xvd2VyQ2FzZSgpID09IHJ1bGVOYW1lLnRvTG93ZXJDYXNlKCkpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoc3R5bGVTaGVldC5jc3NSdWxlcykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzdHlsZVNoZWV0LmRlbGV0ZVJ1bGUoaWkpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlU2hlZXQucmVtb3ZlUnVsZShpaSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gY3NzUnVsZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpaSsrO1xyXG4gICAgICAgIH0gd2hpbGUgKGNzc1J1bGUpO1xyXG4gICAgfVxyXG5cclxuICAgIGNyZWF0ZUNvbmZpZ0tleShncmlkSUQ6IHN0cmluZykge1xyXG4gICAgICAgIGNvbnN0IHsgaG9zdCwgaGFzaCwgaHJlZiwgcGF0aG5hbWUgfSA9IGxvY2F0aW9uO1xyXG4gICAgICAgIGxldCBmb3JtQ29kZSA9ICcnO1xyXG4gICAgICAgIGxldCBtZW51SWQgPSAnJztcclxuICAgICAgICBpZiAoaGFzaCkge1xyXG4gICAgICAgICAgICBjb25zdCBfc2VhcmNoQXJyID0gaGFzaC5zcGxpdCgnPycpO1xyXG4gICAgICAgICAgICBmb3JtQ29kZSA9IF9zZWFyY2hBcnJbMF07XHJcblxyXG4gICAgICAgICAgICBjb25zdCBzZWFyY2hPYmo6IGFueSA9IHt9O1xyXG4gICAgICAgICAgICBpZiAoX3NlYXJjaEFyclsxXSkge1xyXG4gICAgICAgICAgICAgICAgX3NlYXJjaEFyclsxXS5zcGxpdCgnJicpLm1hcChuID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBzZWFyY2hPYmpbbi5zcGxpdCgnPScpWzBdXSA9IG4uc3BsaXQoJz0nKVsxXTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjb25zdCBjYXRjaEZ1bmNJZEtFWSA9IGAke3BhdGhuYW1lfWA7XHJcbiAgICAgICAgICAgIGlmIChzZWFyY2hPYmogJiYgT2JqZWN0LmtleXMoc2VhcmNoT2JqKS5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgIG1lbnVJZCA9IHNlYXJjaE9iai5mdW5jSWQgfHwgJyc7XHJcbiAgICAgICAgICAgICAgICBpZiAobWVudUlkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oY2F0Y2hGdW5jSWRLRVksIG1lbnVJZCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmICghbWVudUlkKSB7XHJcbiAgICAgICAgICAgICAgICBtZW51SWQgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShjYXRjaEZ1bmNJZEtFWSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3Qga2V5ID0gZm9ybUNvZGUgKyAnXycgKyBtZW51SWQgKyAnXycgKyBncmlkSUQ7XHJcblxyXG4gICAgICAgIGlmICghdGhpcy5pZFNlcnZpY2UpIHtcclxuICAgICAgICAgICAgdGhpcy5pZFNlcnZpY2UgPSBuZXcgSWRTZXJ2aWNlKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gdGhpcy5pZFNlcnZpY2UuZW5jcnlwdChrZXkpO1xyXG4gICAgfVxyXG5cclxuXHJcbiAgICBnZXRDdXN0b21TdHlsZShzdHlsZXI6IGFueSwgYXJnczogYW55KTogeyBjbHM/OiBhbnksIHN0eWxlPzogYW55IH0ge1xyXG4gICAgICAgIGlmICh0eXBlb2Ygc3R5bGVyID09PSAnb2JqZWN0Jykge1xyXG4gICAgICAgICAgICByZXR1cm4gc3R5bGVyO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGlmICh0eXBlb2Ygc3R5bGVyID09PSAnZnVuY3Rpb24nKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBwID0gYXJncyB8fCBbXTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBzdHlsZXIoLi4ucCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG5cclxuICAgIGZpbmROZXh0VHIobmV4dFRyLCBkaXIpIHtcclxuICAgICAgICBjb25zdCBnZXROZXh0RWxlbWVudCA9ICh0YXJnZXQpID0+IHtcclxuICAgICAgICAgICAgaWYgKHRhcmdldCAmJiB0YXJnZXQuY2xhc3NOYW1lLmluZGV4T2YoJ2YtZGF0YWdyaWQtZGlzYWJsZS1yb3cnKSA9PSAtMSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRhcmdldDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgY29uc3QgbSA9IGRpciA9PT0gJ2Rvd24nID8gJ25leHRFbGVtZW50U2libGluZycgOiAncHJldmlvdXNFbGVtZW50U2libGluZyc7XHJcblxyXG4gICAgICAgIGNvbnN0IGdldEVsZSA9ICh0KSA9PiB7XHJcbiAgICAgICAgICAgIGxldCBuID0gbnVsbDtcclxuICAgICAgICAgICAgbGV0IG5leHQgPSB0cnVlO1xyXG4gICAgICAgICAgICB3aGlsZSAobmV4dCkge1xyXG4gICAgICAgICAgICAgICAgbiA9IGdldE5leHRFbGVtZW50KHQpO1xyXG4gICAgICAgICAgICAgICAgaWYgKG4pIHtcclxuICAgICAgICAgICAgICAgICAgICBuZXh0ID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0ICYmIHRbbV0pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbiA9IGdldE5leHRFbGVtZW50KHRbbV0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXh0ID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBuO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHJldHVybiBnZXRFbGUobmV4dFRyKTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIF9nZXRDc3NUZXh0QnlTZWxlY3RvcihzZWxlY3Rvcjogc3RyaW5nLCBzdHlsZVNoZWV0KSB7XHJcbiAgICAgICAgaWYgKCFzdHlsZVNoZWV0KSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IGNzc1J1bGVzID0gKHN0eWxlU2hlZXQuY3NzUnVsZXMgfHwgc3R5bGVTaGVldC5ydWxlcykgYXMgYW55O1xyXG4gICAgICAgIGxldCBpaSA9IDA7XHJcbiAgICAgICAgbGV0IGNzc1J1bGU6IGFueSA9IGZhbHNlO1xyXG5cclxuICAgICAgICBkbyB7XHJcbiAgICAgICAgICAgIGNzc1J1bGUgPSBjc3NSdWxlc1tpaV07XHJcbiAgICAgICAgICAgIGlmIChjc3NSdWxlKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoY3NzUnVsZS5zZWxlY3RvclRleHQudG9Mb3dlckNhc2UoKSA9PSBzZWxlY3Rvci50b0xvd2VyQ2FzZSgpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNzc1J1bGU7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWkrKztcclxuICAgICAgICB9IHdoaWxlIChjc3NSdWxlKTtcclxuICAgIH1cclxufVxyXG4iXX0=