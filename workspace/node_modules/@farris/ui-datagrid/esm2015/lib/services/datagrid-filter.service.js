/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { LocaleService } from '@farris/ui-locale';
import { Injectable, Injector, EventEmitter } from '@angular/core';
import { Compare } from '@farris/ui-common/types';
import { DatagridFacadeService } from './datagrid-facade.service';
import { Utils } from './../utils/utils';
import { ColumnFilterType } from '../types/data-column';
import { DatagridColumnsHelper } from './datagrid-columns.helper';
import { trim } from 'lodash-es';
export class DatagridFilterService {
    /**
     * @param {?} dfs
     * @param {?} localeSer
     * @param {?} inject
     */
    constructor(dfs, localeSer, inject) {
        this.dfs = dfs;
        this.localeSer = localeSer;
        this.inject = inject;
        this.removeField = new EventEmitter();
    }
    /**
     * @param {?} rowData
     * @param {?} conditions
     * @return {?}
     */
    validateRowData(rowData, conditions) {
        if (!conditions || Object.keys(conditions).length === 0) {
            return true;
        }
        return this.checkAllFieldInRowData(rowData, conditions);
    }
    /**
     * @param {?} data
     * @param {?} conditions
     * @return {?}
     */
    executeFilter(data, conditions) {
        if (this.dfs.getState().enableSmartFilter) {
            return this.executeSmartFilter(data, conditions);
        }
        if (data && data.length) {
            return data.filter((/**
             * @param {?} n
             * @return {?}
             */
            n => this.validateRowData(n, conditions)));
        }
        return data;
    }
    /**
     * @private
     * @param {?} fieldDataValue
     * @param {?} operator
     * @param {?} targetValue
     * @return {?}
     */
    getCompareResult(fieldDataValue, operator, targetValue) {
        /** @type {?} */
        const op = parseInt('' + operator, 10);
        switch (op) {
            case Compare.Equal:
                return fieldDataValue == targetValue;
            case Compare.NotEqual:
                return ('' + fieldDataValue).toLowerCase() !== ('' + targetValue).toLowerCase();
            case Compare.Greater:
                return fieldDataValue > targetValue;
            case Compare.GreaterOrEqual:
                return fieldDataValue >= targetValue;
            case Compare.Less:
                return fieldDataValue < targetValue;
            case Compare.LessOrEqual:
                return fieldDataValue <= targetValue;
            case Compare.Like:
                if (fieldDataValue == null) {
                    fieldDataValue = '';
                }
                return ('' + fieldDataValue).toLowerCase().indexOf(targetValue.toLowerCase()) > -1;
            case Compare.NotLike:
                return ('' + fieldDataValue).toLowerCase().indexOf(targetValue.toLowerCase()) === -1;
            case Compare.In:
                targetValue = targetValue || [];
                return targetValue.findIndex((/**
                 * @param {?} n
                 * @return {?}
                 */
                n => n == fieldDataValue)) > -1;
            case 1001: // Empty
                return trim(fieldDataValue) === '' || fieldDataValue === null || fieldDataValue === undefined;
            case 1002: // NotEmpty
                return trim(fieldDataValue) !== '' && fieldDataValue !== null && fieldDataValue !== undefined;
            case 1003: // Null
                return fieldDataValue === null;
            case 1004: // NotNull
                return fieldDataValue !== null;
        }
    }
    /**
     * @private
     * @param {?} result1
     * @param {?} relation
     * @param {?} result2
     * @return {?}
     */
    getRelationResult(result1, relation, result2) {
        /** @type {?} */
        const _relation = relation.toLowerCase();
        if (_relation === 'and') {
            return result1 && result2;
        }
        else {
            return result1 || result2;
        }
    }
    /**
     * @private
     * @param {?} resultObj
     * @return {?}
     */
    checkAllFieldResult(resultObj) {
        if (!resultObj) {
            return true;
        }
        return Object.values(resultObj).reduce((/**
         * @param {?} c
         * @param {?} n
         * @return {?}
         */
        (c, n) => {
            return c && n;
        }), true);
    }
    /**
     * @private
     * @param {?} rowData
     * @param {?} conditions
     * @return {?}
     */
    checkAllFieldInRowData(rowData, conditions) {
        // this.state = conditions;
        /** @type {?} */
        let resultObj = null;
        if (conditions) {
            /** @type {?} */
            const fields = Object.keys(conditions);
            resultObj = {};
            fields.forEach((/**
             * @param {?} field
             * @return {?}
             */
            field => {
                /** @type {?} */
                let fieldValue = Utils.getValue(field, rowData);
                /** @type {?} */
                const columnObj = this.dfs.getColumn(field);
                if (columnObj && columnObj.isMultilingualField) {
                    fieldValue = Utils.getMultilingualValue(fieldValue, this.localeSer.localeId);
                }
                /** @type {?} */
                const where = conditions[field];
                const { value1, operator1, relation, operator2, value2 } = where;
                if (where) {
                    /** @type {?} */
                    const result = this.getCompareResult(fieldValue, operator1, value1);
                    resultObj[field] = result;
                    if (relation) {
                        /** @type {?} */
                        const result2 = this.getCompareResult(fieldValue, operator2, value2);
                        resultObj[field] = this.getRelationResult(result, relation, result2);
                    }
                }
            }));
        }
        return this.checkAllFieldResult(resultObj);
    }
    /**
     * @param {?} field
     * @return {?}
     */
    removeFilterField(field) {
        this.removeField.emit(field);
    }
    /**
     * @param {?} conditions
     * @return {?}
     */
    convertFilterCondition2String(conditions) {
        if (!conditions) {
            return '';
        }
        /** @type {?} */
        let str = '';
        /** @type {?} */
        const andText = this.localeSer.getValue('datagrid.filter.and');
        /** @type {?} */
        const orText = this.localeSer.getValue('datagrid.filter.or');
        /** @type {?} */
        const and = `<span class='badge badge-success'>${andText}</span>`;
        /** @type {?} */
        const and2 = `<span class='badge badge-info'>${andText}</span>`;
        /** @type {?} */
        const or = `<span class='badge badge-warning'>${orText}</span>`;
        /** @type {?} */
        const lbracket = `<b>〔</b>`;
        /** @type {?} */
        const rbracket = `<b>〕</b>`;
        /** @type {?} */
        const ellipsis = `[ <span class="ellipsis" title="$title$">  $value$<i class="f-icon f-icon-lookup"></i></span> ]`;
        str = Object.keys(conditions).reduce((/**
         * @param {?} c
         * @param {?} r
         * @return {?}
         */
        (c, r) => {
            /** @type {?} */
            const filter = conditions[r];
            /** @type {?} */
            const col = this.dfs.getColumn(r);
            /** @type {?} */
            const t = `<b>${col.title}</b>`;
            /** @type {?} */
            let s = ` ${t} ${this.getCompareString(filter.operator1)} ${Utils.escapeValue(filter.value1)}  `;
            if (filter.operator1 == Compare.In) {
                /** @type {?} */
                let txt = filter.value1;
                /** @type {?} */
                let txt2 = txt;
                if (col.filter.type === ColumnFilterType.enum) {
                    /** @type {?} */
                    const enumOpts = DatagridColumnsHelper.getFilterEnumOptions(col);
                    txt = DatagridColumnsHelper.getEnumText(enumOpts, filter.value1);
                    txt2 = txt.split(',').slice(0, 2).join(',');
                }
                else {
                    txt2 = txt.slice(0, 2).join(',');
                }
                s = ` ${t} ${this.getCompareString(filter.operator1)} [ ${txt} ]  `;
                if (filter.value1.length > 2) {
                    s = ` ${t} ${this.getCompareString(filter.operator1)} ${ellipsis.replace('$title$', txt).replace('$value$', txt2)}  `;
                }
            }
            else {
                if (filter.operator1 == Compare.Equal && Array.isArray(filter.value1)) {
                    if (!filter.value1.length) {
                        s = ` ${t} ${this.getCompareString(filter.operator1)} ''  `;
                    }
                }
            }
            if (filter.relation) {
                /** @type {?} */
                const s2 = `${t} ${this.getCompareString(filter.operator2)} ${filter.value2}`;
                s = `${lbracket} ${s} ${filter.relation === 'and' ? and2 : or} ${s2} ${rbracket}`;
            }
            return `${c} <span class="filter-field filter-column-${r}"> ${s} AND </span>`;
        }), '');
        /** @type {?} */
        const lastANDidx = str.lastIndexOf('AND');
        /** @type {?} */
        let resultStr = str.substr(0, lastANDidx);
        resultStr += str.substr(lastANDidx + 3);
        return resultStr.replace(/AND/g, and).replace(/OR/g, or);
    }
    /**
     * @private
     * @param {?} operator
     * @return {?}
     */
    getCompareString(operator) {
        /** @type {?} */
        const op = parseInt('' + operator, 10);
        /** @type {?} */
        let code = '';
        switch (op) {
            case Compare.Equal:
            case Compare.NotEqual:
            case Compare.Greater:
            case Compare.GreaterOrEqual:
            case Compare.Less:
            case Compare.LessOrEqual:
            case Compare.Like:
            case Compare.NotLike:
            case Compare.In:
                code = Compare[op];
                code = code[0].toLowerCase() + code.substr(1);
                return this.localeSer.getValue('datagrid.filter.operators.' + code);
            case 1001: // Empty
                return ' ' + this.localeSer.getValue('datagrid.filter.operators.empty');
            case 1002: // NotEmpty
                return ' ' + this.localeSer.getValue('datagrid.filter.operators.notEmpty');
            case 1003: // Null
                return ' ' + this.localeSer.getValue('datagrid.filter.operators.null');
            case 1004: // NotNull
                return ' ' + this.localeSer.getValue('datagrid.filter.operators.notNull');
        }
    }
    /**
     * @param {?} condition
     * @return {?}
     */
    convert2FilterArray(condition) {
        /** @type {?} */
        const filterArr = [];
        /** @type {?} */
        const excludeDataTypes = ['number', 'date', 'datetime'];
        if (condition) {
            /** @type {?} */
            const fields = Object.keys(condition);
            if (fields && fields.length) {
                fields.forEach((/**
                 * @param {?} field
                 * @return {?}
                 */
                field => {
                    /** @type {?} */
                    const columnInfo = this.dfs.getColumn(field);
                    /** @type {?} */
                    const dataType = columnInfo.dataType || 'string';
                    /** @type {?} */
                    const obj = { filterField: field, value: '', lbracket: '', rbracket: '', relation: 1, compare: 0 };
                    /** @type {?} */
                    const conditionVal = condition[field];
                    if (typeof conditionVal === 'object') {
                        // tfs 568484
                        /** @type {?} */
                        const operator1 = parseInt('' + conditionVal.operator1, 10);
                        if (operator1 === 1001 || operator1 === 1002) {
                            obj.compare = operator1 === 1001 ? Compare.Equal : Compare.NotEqual;
                            obj.lbracket = '(';
                            obj.relation = operator1 === 1002 ? 1 : 2;
                            filterArr.push(obj);
                            if (excludeDataTypes.includes(dataType)) {
                                obj.value = null;
                                obj.lbracket = '';
                                obj.relation = 1;
                                obj.compare = operator1 === 1002 ? Compare.IsNot : Compare.Is;
                                return;
                            }
                            /** @type {?} */
                            const obj2 = { filterField: field, value: null, lbracket: '', rbracket: ')', relation: 1, compare: 0 };
                            if (operator1 === 1002) {
                                obj2.compare = Compare.IsNot;
                            }
                            else {
                                obj2.compare = Compare.Is;
                            }
                            filterArr.push(obj2);
                            return;
                        }
                        obj.compare = conditionVal.operator1;
                        obj.value = conditionVal.value1;
                        filterArr.push(obj);
                        if (conditionVal.value2) {
                            obj.lbracket = '(';
                            obj.relation = conditionVal.relation === 'and' ? 1 : 2;
                            /** @type {?} */
                            const obj2 = { filterField: field, value: '', lbracket: '', rbracket: ')', relation: 1, compare: 0 };
                            obj2.compare = conditionVal.operator2;
                            obj2.value = conditionVal.value2;
                            filterArr.push(obj2);
                        }
                        else {
                            if (conditionVal.operator2) {
                                /** @type {?} */
                                const op2 = parseInt('' + conditionVal.operator2, 10);
                                if (op2 === 1001 || op2 === 1002) {
                                    obj.lbracket = '(';
                                    obj.relation = conditionVal.relation === 'and' ? 1 : 2;
                                    /** @type {?} */
                                    const obj2 = { filterField: field, value: '', lbracket: '(', rbracket: '', relation: 2, compare: 0 };
                                    obj2.compare = op2 === 1001 ? Compare.Equal : Compare.NotEqual;
                                    obj2.relation = op2 === 1002 ? 1 : 2;
                                    filterArr.push(obj2);
                                    if (excludeDataTypes.includes(dataType)) {
                                        obj2.value = null;
                                        obj2.lbracket = '';
                                        obj2.rbracket = ')';
                                        obj2.relation = 1;
                                        obj2.compare = op2 === 1002 ? Compare.IsNot : Compare.Is;
                                        return;
                                    }
                                    /** @type {?} */
                                    const obj21 = { filterField: field, value: null, lbracket: '', rbracket: '))', relation: 1, compare: 0 };
                                    obj21.compare = op2 === 1001 ? Compare.Is : Compare.IsNot;
                                    filterArr.push(obj21);
                                }
                            }
                        }
                    }
                    return obj;
                }));
            }
        }
        if (filterArr.length) {
            this.checkEnumTypeFilters(filterArr);
            filterArr[filterArr.length - 1].relation = 0;
        }
        return filterArr;
    }
    /**
     * @private
     * @param {?} filterArr
     * @return {?}
     */
    checkEnumTypeFilters(filterArr) {
        /** @type {?} */
        const enumFilters = {};
        filterArr.forEach((/**
         * @param {?} f
         * @param {?} i
         * @return {?}
         */
        (f, i) => {
            /** @type {?} */
            const enumFilterArr = this.convertEnumTypeFilter(f);
            if (enumFilterArr && enumFilterArr.length) {
                enumFilters[f.filterField] = enumFilterArr;
            }
        }));
        /** @type {?} */
        const keys = Object.keys(enumFilters);
        if (keys.length) {
            keys.forEach((/**
             * @param {?} k
             * @return {?}
             */
            (k) => {
                /** @type {?} */
                const i = filterArr.findIndex((/**
                 * @param {?} n
                 * @return {?}
                 */
                n => n.filterField === k));
                filterArr.splice(i, 1, ...enumFilters[k]);
            }));
        }
        return filterArr;
    }
    // 将enum 类型的条件转换多个条件
    /**
     * @private
     * @param {?} filter
     * @return {?}
     */
    convertEnumTypeFilter(filter) {
        if (filter) {
            /** @type {?} */
            const col = (/** @type {?} */ (this.dfs.getColumn(filter.filterField)));
            if (col && col.filter && col.filter.type === ColumnFilterType.enum) {
                if (Array.isArray(filter.value) && filter.value.length) {
                    if (filter.value.length === 1) {
                        filter.compare = Compare.Equal;
                        filter.value = filter.value[0];
                        return [];
                    }
                    else {
                        // > 1
                        /** @type {?} */
                        let filterArr = filter.value.map((/**
                         * @param {?} val
                         * @return {?}
                         */
                        (val) => {
                            return {
                                filterField: filter.filterField,
                                value: val,
                                lbracket: '',
                                rbracket: '',
                                relation: 2,
                                // or
                                compare: 0
                            };
                        }));
                        filterArr[0].lbracket = '(';
                        filterArr[filter.value.length - 1].rbracket = ')';
                        filterArr[filter.value.length - 1].relation = 1;
                        return filterArr;
                    }
                }
            }
        }
        return [];
    }
    /**
     * @param {?} col
     * @return {?}
     */
    createColumnFilterOptions(col) {
        /** @type {?} */
        let filterTypeOptions = {
            type: ColumnFilterType.string,
            enableOperator: true
        };
        if (col.editor) {
            switch (col.editor.type) {
                case 'textarea':
                case 'textbox':
                case 'language-textbox':
                    filterTypeOptions = {
                        type: ColumnFilterType.string,
                        enableOperator: true
                    };
                    break;
                case 'checkbox':
                case 'switch':
                    filterTypeOptions = {
                        type: ColumnFilterType.boolean,
                        enableOperator: false
                    };
                    break;
                case 'numberbox':
                    filterTypeOptions = {
                        type: ColumnFilterType.number,
                        enableOperator: true
                    };
                    break;
                case 'combolist':
                case 'select':
                    filterTypeOptions = {
                        type: ColumnFilterType.enum,
                        enableOperator: true,
                        options: col.editor.options
                    };
                    break;
                case 'datepicker':
                    filterTypeOptions = {
                        type: col['dataType'] === 'datetime' ? ColumnFilterType.datetime : ColumnFilterType.date,
                        enableOperator: true,
                        options: {
                            dateFormat: col.editor.options.dateFormat,
                            returnFormat: col.editor.options.returnFormat
                        }
                    };
                    break;
                case 'timepicker':
                    filterTypeOptions = {
                        type: ColumnFilterType.time,
                        enableOperator: true
                    };
                    break;
            }
        }
        else if (col.formatter) {
            if (typeof col.formatter === 'object' && Object.keys(col.formatter).length) {
                /** @type {?} */
                const options = col.formatter['options'];
                switch (col.formatter['type']) {
                    case 'number':
                        filterTypeOptions = {
                            type: ColumnFilterType.number,
                            enableOperator: true
                        };
                        break;
                    case 'enum':
                        filterTypeOptions = {
                            type: ColumnFilterType.enum,
                            enableOperator: true,
                            options
                        };
                        break;
                    case 'boolean':
                        filterTypeOptions = {
                            type: ColumnFilterType.boolean,
                            enableOperator: false
                        };
                        break;
                    case 'datetime':
                        /** @type {?} */
                        let tye = ColumnFilterType.datetime;
                        /** @type {?} */
                        let fmt = 'yyyy-MM-dd';
                        /** @type {?} */
                        let returnFmt = 'yyyy-MM-dd';
                        if (options && options.format) {
                            fmt = options.format;
                            if (fmt.indexOf('HH:') == -1) {
                                tye = ColumnFilterType.date;
                            }
                            else {
                                returnFmt += ' HH:mm';
                                if (fmt.indexOf('ss') > -1) {
                                    returnFmt += ':ss';
                                }
                            }
                        }
                        else {
                            tye = ColumnFilterType.date;
                        }
                        filterTypeOptions = {
                            type: tye,
                            enableOperator: true
                        };
                        filterTypeOptions.options = { dateFormat: fmt, returnFormat: returnFmt };
                        break;
                    default:
                        filterTypeOptions = {
                            type: ColumnFilterType.string,
                            enableOperator: true
                        };
                }
            }
        }
        else {
            filterTypeOptions = {
                type: ColumnFilterType.string,
                enableOperator: true
            };
        }
        return filterTypeOptions;
    }
    //#region  Smart Filter
    /**
     * @param {?} conditions
     * @return {?}
     */
    convertSmartFilter2EntityFilter(conditions) {
        if (conditions && conditions.length) {
            return conditions.map((/**
             * @param {?} n
             * @return {?}
             */
            n => {
                return n;
            }));
        }
        return [];
    }
    /**
     * @private
     * @param {?} rowData
     * @param {?} conditions
     * @return {?}
     */
    validateRowData2(rowData, conditions) {
        if (!conditions || conditions.length === 0) {
            return true;
        }
        return this.checkRowDataWithCondition(rowData, conditions);
    }
    /**
     * @private
     * @param {?} rowData
     * @param {?} conditions
     * @return {?}
     */
    checkRowDataWithCondition(rowData, conditions) {
        /** @type {?} */
        let resultObj = null;
        if (conditions) {
            resultObj = {};
            conditions.forEach((/**
             * @param {?} condition
             * @return {?}
             */
            condition => {
                /** @type {?} */
                const field = condition.FilterField;
                /** @type {?} */
                let fieldValue = Utils.getValue(field, rowData);
                /** @type {?} */
                const columnObj = this.dfs.getColumn(field);
                if (columnObj && columnObj.isMultilingualField) {
                    fieldValue = Utils.getMultilingualValue(fieldValue, this.localeSer.localeId);
                }
                /** @type {?} */
                const where = condition;
                const { Value, Relation, Compare: operator1 } = where;
                if (where) {
                    /** @type {?} */
                    const r = this.getCompareResult(fieldValue, operator1, Value);
                    if (resultObj[field] === undefined) {
                        resultObj[field] = [r];
                    }
                    else {
                        resultObj[field].push(r);
                    }
                }
            }));
        }
        // return this.checkAllFieldResult(resultObj);
        /** @type {?} */
        const fields = Object.keys(resultObj);
        /** @type {?} */
        const result = [];
        fields.forEach((/**
         * @param {?} f
         * @return {?}
         */
        (f) => {
            /** @type {?} */
            const _filters = conditions.filter((/**
             * @param {?} n
             * @return {?}
             */
            n => n.FilterField === f));
            if (resultObj[f].length === 1) {
                result.push(resultObj[f][0]);
            }
            else {
                if (_filters[0].Relation === 1 && resultObj[f].length === 2) { // and
                    result.push(resultObj[f][0] && resultObj[f][1]);
                }
                else { // or
                    result.push(resultObj[f].indexOf(true) > -1);
                }
            }
        }));
        return result.indexOf(false) === -1;
    }
    /**
     * @param {?} data
     * @param {?} conditions
     * @return {?}
     */
    executeSmartFilter(data, conditions) {
        if (data && data.length) {
            return data.filter((/**
             * @param {?} n
             * @return {?}
             */
            n => this.validateRowData2(n, conditions)));
        }
        return data;
    }
}
DatagridFilterService.decorators = [
    { type: Injectable }
];
/** @nocollapse */
DatagridFilterService.ctorParameters = () => [
    { type: DatagridFacadeService },
    { type: LocaleService },
    { type: Injector }
];
if (false) {
    /** @type {?} */
    DatagridFilterService.prototype.removeField;
    /**
     * @type {?}
     * @private
     */
    DatagridFilterService.prototype.dfs;
    /**
     * @type {?}
     * @private
     */
    DatagridFilterService.prototype.localeSer;
    /**
     * @type {?}
     * @private
     */
    DatagridFilterService.prototype.inject;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGF0YWdyaWQtZmlsdGVyLnNlcnZpY2UuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZmFycmlzL3VpLWRhdGFncmlkLyIsInNvdXJjZXMiOlsibGliL3NlcnZpY2VzL2RhdGFncmlkLWZpbHRlci5zZXJ2aWNlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7QUFBQSxPQUFPLEVBQUUsYUFBYSxFQUFFLE1BQU0sbUJBQW1CLENBQUM7QUFDbEQsT0FBTyxFQUFFLFVBQVUsRUFBRSxRQUFRLEVBQUUsWUFBWSxFQUFZLE1BQU0sZUFBZSxDQUFDO0FBQzdFLE9BQU8sRUFBRSxPQUFPLEVBQTZCLE1BQU0seUJBQXlCLENBQUM7QUFDN0UsT0FBTyxFQUFFLHFCQUFxQixFQUFFLE1BQU0sMkJBQTJCLENBQUM7QUFDbEUsT0FBTyxFQUFFLEtBQUssRUFBRSxNQUFNLGtCQUFrQixDQUFDO0FBQ3pDLE9BQU8sRUFBYyxnQkFBZ0IsRUFBMEQsTUFBTSxzQkFBc0IsQ0FBQztBQUM1SCxPQUFPLEVBQUUscUJBQXFCLEVBQUUsTUFBTSwyQkFBMkIsQ0FBQztBQUNsRSxPQUFPLEVBQUUsSUFBSSxFQUFFLE1BQU0sV0FBVyxDQUFDO0FBR2pDLE1BQU0sT0FBTyxxQkFBcUI7Ozs7OztJQUc5QixZQUFvQixHQUEwQixFQUFVLFNBQXdCLEVBQVUsTUFBZ0I7UUFBdEYsUUFBRyxHQUFILEdBQUcsQ0FBdUI7UUFBVSxjQUFTLEdBQVQsU0FBUyxDQUFlO1FBQVUsV0FBTSxHQUFOLE1BQU0sQ0FBVTtRQUYxRyxnQkFBVyxHQUFHLElBQUksWUFBWSxFQUFVLENBQUM7SUFHekMsQ0FBQzs7Ozs7O0lBRUQsZUFBZSxDQUFDLE9BQVksRUFBRSxVQUFzRDtRQUNoRixJQUFJLENBQUMsVUFBVSxJQUFJLE1BQU0sQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLENBQUMsTUFBTSxLQUFLLENBQUMsRUFBRTtZQUNyRCxPQUFPLElBQUksQ0FBQztTQUNmO1FBQ0QsT0FBTyxJQUFJLENBQUMsc0JBQXNC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QUUsdUNBQXdCIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTG9jYWxlU2VydmljZSB9IGZyb20gJ0BmYXJyaXMvdWktbG9jYWxlJztcclxuaW1wb3J0IHsgSW5qZWN0YWJsZSwgSW5qZWN0b3IsIEV2ZW50RW1pdHRlciwgT3B0aW9uYWwgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgQ29tcGFyZSwgRmlsdGVyQ29uZGl0aW9uLCBSZWxhdGlvbiB9IGZyb20gJ0BmYXJyaXMvdWktY29tbW9uL3R5cGVzJztcclxuaW1wb3J0IHsgRGF0YWdyaWRGYWNhZGVTZXJ2aWNlIH0gZnJvbSAnLi9kYXRhZ3JpZC1mYWNhZGUuc2VydmljZSc7XHJcbmltcG9ydCB7IFV0aWxzIH0gZnJvbSAnLi8uLi91dGlscy91dGlscyc7XHJcbmltcG9ydCB7IERhdGFDb2x1bW4sIENvbHVtbkZpbHRlclR5cGUsIENvbHVtbkZpbHRlciwgRmlsdGVyQ29uZGl0aW9uIGFzIENsaWVudEZpbHRlckNvbmRpdGlvbiB9IGZyb20gJy4uL3R5cGVzL2RhdGEtY29sdW1uJztcclxuaW1wb3J0IHsgRGF0YWdyaWRDb2x1bW5zSGVscGVyIH0gZnJvbSAnLi9kYXRhZ3JpZC1jb2x1bW5zLmhlbHBlcic7XHJcbmltcG9ydCB7IHRyaW0gfSBmcm9tICdsb2Rhc2gtZXMnO1xyXG5cclxuQEluamVjdGFibGUoKVxyXG5leHBvcnQgY2xhc3MgRGF0YWdyaWRGaWx0ZXJTZXJ2aWNlIHtcclxuICAgIHJlbW92ZUZpZWxkID0gbmV3IEV2ZW50RW1pdHRlcjxzdHJpbmc+KCk7XHJcblxyXG4gICAgY29uc3RydWN0b3IocHJpdmF0ZSBkZnM6IERhdGFncmlkRmFjYWRlU2VydmljZSwgcHJpdmF0ZSBsb2NhbGVTZXI6IExvY2FsZVNlcnZpY2UsIHByaXZhdGUgaW5qZWN0OiBJbmplY3Rvcikge1xyXG4gICAgfVxyXG5cclxuICAgIHZhbGlkYXRlUm93RGF0YShyb3dEYXRhOiBhbnksIGNvbmRpdGlvbnM6IHsgW2ZpZWxkOiBzdHJpbmddOiBDbGllbnRGaWx0ZXJDb25kaXRpb24gfSkge1xyXG4gICAgICAgIGlmICghY29uZGl0aW9ucyB8fCBPYmplY3Qua2V5cyhjb25kaXRpb25zKS5sZW5ndGggPT09IDApIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0aGlzLmNoZWNrQWxsRmllbGRJblJvd0RhdGEocm93RGF0YSwgY29uZGl0aW9ucyk7XHJcbiAgICB9XHJcblxyXG4gICAgZXhlY3V0ZUZpbHRlcihkYXRhOiBbXSwgY29uZGl0aW9uczogYW55KTogYW55W10ge1xyXG4gICAgICAgIGlmICggdGhpcy5kZnMuZ2V0U3RhdGUoKS5lbmFibGVTbWFydEZpbHRlcikge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5leGVjdXRlU21hcnRGaWx0ZXIoZGF0YSwgY29uZGl0aW9ucyk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoZGF0YSAmJiBkYXRhLmxlbmd0aCkge1xyXG4gICAgICAgICAgICByZXR1cm4gZGF0YS5maWx0ZXIobiA9PiB0aGlzLnZhbGlkYXRlUm93RGF0YShuLCBjb25kaXRpb25zKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBkYXRhO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgZ2V0Q29tcGFyZVJlc3VsdChmaWVsZERhdGFWYWx1ZTogYW55LCBvcGVyYXRvcjogQ29tcGFyZSwgdGFyZ2V0VmFsdWU6IGFueSkge1xyXG4gICAgICAgIGNvbnN0IG9wID0gcGFyc2VJbnQoJycgKyBvcGVyYXRvciwgMTApO1xyXG4gICAgICAgIHN3aXRjaCAob3ApIHtcclxuICAgICAgICAgICAgY2FzZSBDb21wYXJlLkVxdWFsOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZpZWxkRGF0YVZhbHVlID09IHRhcmdldFZhbHVlO1xyXG4gICAgICAgICAgICBjYXNlIENvbXBhcmUuTm90RXF1YWw6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gKCcnICsgZmllbGREYXRhVmFsdWUpLnRvTG93ZXJDYXNlKCkgIT09ICgnJyArIHRhcmdldFZhbHVlKS50b0xvd2VyQ2FzZSgpO1xyXG4gICAgICAgICAgICBjYXNlIENvbXBhcmUuR3JlYXRlcjpcclxuICAgICAgICAgICAgICAgIHJldHVybiBmaWVsZERhdGFWYWx1ZSA+IHRhcmdldFZhbHVlO1xyXG4gICAgICAgICAgICBjYXNlIENvbXBhcmUuR3JlYXRlck9yRXF1YWw6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmllbGREYXRhVmFsdWUgPj0gdGFyZ2V0VmFsdWU7XHJcbiAgICAgICAgICAgIGNhc2UgQ29tcGFyZS5MZXNzOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZpZWxkRGF0YVZhbHVlIDwgdGFyZ2V0VmFsdWU7XHJcbiAgICAgICAgICAgIGNhc2UgQ29tcGFyZS5MZXNzT3JFcXVhbDpcclxuICAgICAgICAgICAgICAgIHJldHVybiBmaWVsZERhdGFWYWx1ZSA8PSB0YXJnZXRWYWx1ZTtcclxuICAgICAgICAgICAgY2FzZSBDb21wYXJlLkxpa2U6XHJcbiAgICAgICAgICAgICAgICBpZiAoZmllbGREYXRhVmFsdWUgPT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGZpZWxkRGF0YVZhbHVlID0gJyc7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gKCcnICsgZmllbGREYXRhVmFsdWUpLnRvTG93ZXJDYXNlKCkuaW5kZXhPZih0YXJnZXRWYWx1ZS50b0xvd2VyQ2FzZSgpKSA+IC0xO1xyXG4gICAgICAgICAgICBjYXNlIENvbXBhcmUuTm90TGlrZTpcclxuICAgICAgICAgICAgICAgIHJldHVybiAoJycgKyBmaWVsZERhdGFWYWx1ZSkudG9Mb3dlckNhc2UoKS5pbmRleE9mKHRhcmdldFZhbHVlLnRvTG93ZXJDYXNlKCkpID09PSAtMTtcclxuICAgICAgICAgICAgY2FzZSBDb21wYXJlLkluOlxyXG4gICAgICAgICAgICAgICAgdGFyZ2V0VmFsdWUgPSB0YXJnZXRWYWx1ZSB8fCBbXTtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0YXJnZXRWYWx1ZS5maW5kSW5kZXgoIG4gPT4gbiA9PSBmaWVsZERhdGFWYWx1ZSkgPiAtMTtcclxuICAgICAgICAgICAgY2FzZSAxMDAxOiAvLyBFbXB0eVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRyaW0oZmllbGREYXRhVmFsdWUpID09PSAnJyB8fCBmaWVsZERhdGFWYWx1ZSA9PT0gbnVsbCB8fCBmaWVsZERhdGFWYWx1ZSA9PT0gdW5kZWZpbmVkO1xyXG4gICAgICAgICAgICBjYXNlIDEwMDI6ICAvLyBOb3RFbXB0eVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRyaW0oZmllbGREYXRhVmFsdWUpICE9PSAnJyAmJiBmaWVsZERhdGFWYWx1ZSAhPT0gbnVsbCAmJiBmaWVsZERhdGFWYWx1ZSAhPT0gdW5kZWZpbmVkO1xyXG4gICAgICAgICAgICBjYXNlIDEwMDM6IC8vIE51bGxcclxuICAgICAgICAgICAgICAgIHJldHVybiBmaWVsZERhdGFWYWx1ZSA9PT0gbnVsbDtcclxuICAgICAgICAgICAgY2FzZSAxMDA0OiAvLyBOb3ROdWxsXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmllbGREYXRhVmFsdWUgIT09IG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgZ2V0UmVsYXRpb25SZXN1bHQocmVzdWx0MTogYm9vbGVhbiwgcmVsYXRpb246ICdhbmQnIHwgJ29yJywgcmVzdWx0MjogYm9vbGVhbikge1xyXG4gICAgICAgIGNvbnN0IF9yZWxhdGlvbiA9IHJlbGF0aW9uLnRvTG93ZXJDYXNlKCk7XHJcbiAgICAgICAgaWYgKF9yZWxhdGlvbiA9PT0gJ2FuZCcpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDEgJiYgcmVzdWx0MjtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0MSB8fCByZXN1bHQyO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGNoZWNrQWxsRmllbGRSZXN1bHQocmVzdWx0T2JqOiB7IFtrZXk6IHN0cmluZ106IGJvb2xlYW4gfSkge1xyXG4gICAgICAgIGlmICghcmVzdWx0T2JqKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIE9iamVjdC52YWx1ZXMocmVzdWx0T2JqKS5yZWR1Y2UoKGMsIG4pID0+IHtcclxuICAgICAgICAgICAgcmV0dXJuIGMgJiYgbjtcclxuICAgICAgICB9LCB0cnVlKTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGNoZWNrQWxsRmllbGRJblJvd0RhdGEocm93RGF0YTogYW55LCBjb25kaXRpb25zOiB7IFtmaWVsZDogc3RyaW5nXTogQ2xpZW50RmlsdGVyQ29uZGl0aW9uIH0pIHtcclxuICAgICAgICAvLyB0aGlzLnN0YXRlID0gY29uZGl0aW9ucztcclxuICAgICAgICBsZXQgcmVzdWx0T2JqID0gbnVsbDtcclxuICAgICAgICBpZiAoY29uZGl0aW9ucykge1xyXG4gICAgICAgICAgICBjb25zdCBmaWVsZHMgPSBPYmplY3Qua2V5cyhjb25kaXRpb25zKTtcclxuICAgICAgICAgICAgcmVzdWx0T2JqID0ge307XHJcbiAgICAgICAgICAgIGZpZWxkcy5mb3JFYWNoKGZpZWxkID0+IHtcclxuICAgICAgICAgICAgICAgIGxldCBmaWVsZFZhbHVlID0gVXRpbHMuZ2V0VmFsdWUoZmllbGQsIHJvd0RhdGEpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgY29sdW1uT2JqID0gdGhpcy5kZnMuZ2V0Q29sdW1uKGZpZWxkKTtcclxuICAgICAgICAgICAgICAgIGlmIChjb2x1bW5PYmogJiYgY29sdW1uT2JqLmlzTXVsdGlsaW5ndWFsRmllbGQpIHtcclxuICAgICAgICAgICAgICAgICAgICBmaWVsZFZhbHVlID0gVXRpbHMuZ2V0TXVsdGlsaW5ndWFsVmFsdWUoZmllbGRWYWx1ZSwgdGhpcy5sb2NhbGVTZXIubG9jYWxlSWQpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGNvbnN0IHdoZXJlID0gY29uZGl0aW9uc1tmaWVsZF07XHJcbiAgICAgICAgICAgICAgICBjb25zdCB7IHZhbHVlMSwgb3BlcmF0b3IxLCByZWxhdGlvbiwgb3BlcmF0b3IyLCB2YWx1ZTIgfSA9IHdoZXJlO1xyXG4gICAgICAgICAgICAgICAgaWYgKHdoZXJlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gdGhpcy5nZXRDb21wYXJlUmVzdWx0KGZpZWxkVmFsdWUgLCBvcGVyYXRvcjEsIHZhbHVlMSk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0T2JqW2ZpZWxkXSA9IHJlc3VsdDtcclxuICAgICAgICAgICAgICAgICAgICBpZiAocmVsYXRpb24pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcmVzdWx0MiA9IHRoaXMuZ2V0Q29tcGFyZVJlc3VsdChmaWVsZFZhbHVlLCBvcGVyYXRvcjIsIHZhbHVlMik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdE9ialtmaWVsZF0gPSB0aGlzLmdldFJlbGF0aW9uUmVzdWx0KHJlc3VsdCwgcmVsYXRpb24sIHJlc3VsdDIpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHRoaXMuY2hlY2tBbGxGaWVsZFJlc3VsdChyZXN1bHRPYmopO1xyXG4gICAgfVxyXG5cclxuICAgIHJlbW92ZUZpbHRlckZpZWxkKGZpZWxkKSB7XHJcbiAgICAgICAgdGhpcy5yZW1vdmVGaWVsZC5lbWl0KGZpZWxkKTtcclxuICAgIH1cclxuXHJcbiAgICBjb252ZXJ0RmlsdGVyQ29uZGl0aW9uMlN0cmluZyhjb25kaXRpb25zOiBhbnkpIHtcclxuICAgICAgICBpZiAoIWNvbmRpdGlvbnMpIHtcclxuICAgICAgICAgICAgcmV0dXJuICcnO1xyXG4gICAgICAgIH1cclxuICAgICAgICBsZXQgc3RyID0gJyc7XHJcbiAgICAgICAgY29uc3QgYW5kVGV4dCA9IHRoaXMubG9jYWxlU2VyLmdldFZhbHVlKCdkYXRhZ3JpZC5maWx0ZXIuYW5kJyk7XHJcbiAgICAgICAgY29uc3Qgb3JUZXh0ID0gdGhpcy5sb2NhbGVTZXIuZ2V0VmFsdWUoJ2RhdGFncmlkLmZpbHRlci5vcicpO1xyXG4gICAgICAgIGNvbnN0IGFuZCA9IGA8c3BhbiBjbGFzcz0nYmFkZ2UgYmFkZ2Utc3VjY2Vzcyc+JHthbmRUZXh0fTwvc3Bhbj5gO1xyXG4gICAgICAgIGNvbnN0IGFuZDIgPSBgPHNwYW4gY2xhc3M9J2JhZGdlIGJhZGdlLWluZm8nPiR7YW5kVGV4dH08L3NwYW4+YDtcclxuICAgICAgICBjb25zdCBvciA9IGA8c3BhbiBjbGFzcz0nYmFkZ2UgYmFkZ2Utd2FybmluZyc+JHtvclRleHR9PC9zcGFuPmA7XHJcbiAgICAgICAgY29uc3QgbGJyYWNrZXQgPSBgPGI+44CUPC9iPmA7XHJcbiAgICAgICAgY29uc3QgcmJyYWNrZXQgPSBgPGI+44CVPC9iPmA7XHJcbiAgICAgICAgY29uc3QgZWxsaXBzaXMgPSBgWyA8c3BhbiBjbGFzcz1cImVsbGlwc2lzXCIgdGl0bGU9XCIkdGl0bGUkXCI+ICAkdmFsdWUkPGkgY2xhc3M9XCJmLWljb24gZi1pY29uLWxvb2t1cFwiPjwvaT48L3NwYW4+IF1gO1xyXG5cclxuICAgICAgICBzdHIgPSBPYmplY3Qua2V5cyhjb25kaXRpb25zKS5yZWR1Y2UoKGMsIHIpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgZmlsdGVyID0gY29uZGl0aW9uc1tyXTtcclxuICAgICAgICAgICAgY29uc3QgY29sID0gdGhpcy5kZnMuZ2V0Q29sdW1uKHIpO1xyXG4gICAgICAgICAgICBjb25zdCB0ID0gYDxiPiR7Y29sLnRpdGxlfTwvYj5gO1xyXG5cclxuICAgICAgICAgICAgbGV0IHMgPSBgICR7dH0gJHt0aGlzLmdldENvbXBhcmVTdHJpbmcoZmlsdGVyLm9wZXJhdG9yMSl9ICR7VXRpbHMuZXNjYXBlVmFsdWUoZmlsdGVyLnZhbHVlMSl9ICBgO1xyXG4gICAgICAgICAgICBpZiAoZmlsdGVyLm9wZXJhdG9yMSA9PSBDb21wYXJlLkluKSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgdHh0ID0gZmlsdGVyLnZhbHVlMTtcclxuICAgICAgICAgICAgICAgIGxldCB0eHQyID0gdHh0O1xyXG4gICAgICAgICAgICAgICAgaWYgKGNvbC5maWx0ZXIudHlwZSA9PT0gQ29sdW1uRmlsdGVyVHlwZS5lbnVtKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZW51bU9wdHMgPSBEYXRhZ3JpZENvbHVtbnNIZWxwZXIuZ2V0RmlsdGVyRW51bU9wdGlvbnMoY29sKTtcclxuICAgICAgICAgICAgICAgICAgICB0eHQgPSBEYXRhZ3JpZENvbHVtbnNIZWxwZXIuZ2V0RW51bVRleHQoZW51bU9wdHMsIGZpbHRlci52YWx1ZTEpO1xyXG4gICAgICAgICAgICAgICAgICAgIHR4dDIgPSB0eHQuc3BsaXQoJywnKS5zbGljZSgwLCAyKS5qb2luKCcsJyk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHR4dDIgPSB0eHQuc2xpY2UoMCwgMikuam9pbignLCcpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIHMgPSBgICR7dH0gJHt0aGlzLmdldENvbXBhcmVTdHJpbmcoZmlsdGVyLm9wZXJhdG9yMSl9IFsgJHt0eHR9IF0gIGA7XHJcbiAgICAgICAgICAgICAgICBpZiAoZmlsdGVyLnZhbHVlMS5sZW5ndGggPiAyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcyA9IGAgJHt0fSAke3RoaXMuZ2V0Q29tcGFyZVN0cmluZyhmaWx0ZXIub3BlcmF0b3IxKX0gJHtlbGxpcHNpcy5yZXBsYWNlKCckdGl0bGUkJywgdHh0KS5yZXBsYWNlKCckdmFsdWUkJywgdHh0Mil9ICBgO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgaWYgKGZpbHRlci5vcGVyYXRvcjEgPT0gQ29tcGFyZS5FcXVhbCAmJiBBcnJheS5pc0FycmF5KGZpbHRlci52YWx1ZTEpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFmaWx0ZXIudmFsdWUxLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzID0gYCAke3R9ICR7dGhpcy5nZXRDb21wYXJlU3RyaW5nKGZpbHRlci5vcGVyYXRvcjEpfSAnJyAgYDtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGZpbHRlci5yZWxhdGlvbikge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgczIgPSBgJHt0fSAke3RoaXMuZ2V0Q29tcGFyZVN0cmluZyhmaWx0ZXIub3BlcmF0b3IyKX0gJHtmaWx0ZXIudmFsdWUyfWA7XHJcbiAgICAgICAgICAgICAgICBzID0gYCR7bGJyYWNrZXR9ICR7c30gJHtmaWx0ZXIucmVsYXRpb24gPT09ICdhbmQnID8gYW5kMiA6IG9yfSAke3MyfSAke3JicmFja2V0fWA7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIGAke2N9IDxzcGFuIGNsYXNzPVwiZmlsdGVyLWZpZWxkIGZpbHRlci1jb2x1bW4tJHtyfVwiPiAke3N9IEFORCA8L3NwYW4+YDtcclxuICAgICAgICB9LCAnJyk7XHJcbiAgICAgICAgY29uc3QgbGFzdEFORGlkeCA9IHN0ci5sYXN0SW5kZXhPZignQU5EJyk7XHJcbiAgICAgICAgbGV0IHJlc3VsdFN0ciA9IHN0ci5zdWJzdHIoMCwgbGFzdEFORGlkeCk7XHJcbiAgICAgICAgcmVzdWx0U3RyICs9IHN0ci5zdWJzdHIobGFzdEFORGlkeCArIDMpO1xyXG4gICAgICAgIHJldHVybiByZXN1bHRTdHIucmVwbGFjZSgvQU5EL2csIGFuZCkucmVwbGFjZSgvT1IvZywgb3IpO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgZ2V0Q29tcGFyZVN0cmluZyhvcGVyYXRvcjogQ29tcGFyZSkge1xyXG4gICAgICAgIGNvbnN0IG9wID0gcGFyc2VJbnQoJycgKyBvcGVyYXRvciwgMTApO1xyXG4gICAgICAgIGxldCBjb2RlID0gJyc7XHJcbiAgICAgICAgc3dpdGNoIChvcCkge1xyXG4gICAgICAgICAgICBjYXNlIENvbXBhcmUuRXF1YWw6XHJcbiAgICAgICAgICAgIGNhc2UgQ29tcGFyZS5Ob3RFcXVhbDpcclxuICAgICAgICAgICAgY2FzZSBDb21wYXJlLkdyZWF0ZXI6XHJcbiAgICAgICAgICAgIGNhc2UgQ29tcGFyZS5HcmVhdGVyT3JFcXVhbDpcclxuICAgICAgICAgICAgY2FzZSBDb21wYXJlLkxlc3M6XHJcbiAgICAgICAgICAgIGNhc2UgQ29tcGFyZS5MZXNzT3JFcXVhbDpcclxuICAgICAgICAgICAgY2FzZSBDb21wYXJlLkxpa2U6XHJcbiAgICAgICAgICAgIGNhc2UgQ29tcGFyZS5Ob3RMaWtlOlxyXG4gICAgICAgICAgICBjYXNlIENvbXBhcmUuSW46XHJcbiAgICAgICAgICAgICAgICBjb2RlID0gQ29tcGFyZVtvcF07XHJcbiAgICAgICAgICAgICAgICBjb2RlID0gY29kZVswXS50b0xvd2VyQ2FzZSgpICsgY29kZS5zdWJzdHIoMSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5sb2NhbGVTZXIuZ2V0VmFsdWUoJ2RhdGFncmlkLmZpbHRlci5vcGVyYXRvcnMuJyArIGNvZGUpO1xyXG4gICAgICAgICAgICBjYXNlIDEwMDE6IC8vIEVtcHR5XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gJyAnICsgdGhpcy5sb2NhbGVTZXIuZ2V0VmFsdWUoJ2RhdGFncmlkLmZpbHRlci5vcGVyYXRvcnMuZW1wdHknKTtcclxuICAgICAgICAgICAgY2FzZSAxMDAyOiAgLy8gTm90RW1wdHlcclxuICAgICAgICAgICAgICAgIHJldHVybiAnICcgKyB0aGlzLmxvY2FsZVNlci5nZXRWYWx1ZSgnZGF0YWdyaWQuZmlsdGVyLm9wZXJhdG9ycy5ub3RFbXB0eScpO1xyXG4gICAgICAgICAgICBjYXNlIDEwMDM6IC8vIE51bGxcclxuICAgICAgICAgICAgICAgIHJldHVybiAnICcgKyB0aGlzLmxvY2FsZVNlci5nZXRWYWx1ZSgnZGF0YWdyaWQuZmlsdGVyLm9wZXJhdG9ycy5udWxsJyk7XHJcbiAgICAgICAgICAgIGNhc2UgMTAwNDogLy8gTm90TnVsbFxyXG4gICAgICAgICAgICAgICAgcmV0dXJuICcgJyArIHRoaXMubG9jYWxlU2VyLmdldFZhbHVlKCdkYXRhZ3JpZC5maWx0ZXIub3BlcmF0b3JzLm5vdE51bGwnKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgY29udmVydDJGaWx0ZXJBcnJheShjb25kaXRpb246IHsgW2ZpZWxkOiBzdHJpbmddOiBhbnkgfSk6IEZpbHRlckNvbmRpdGlvbltdIHtcclxuICAgICAgICBjb25zdCBmaWx0ZXJBcnIgPSBbXTtcclxuICAgICAgICBjb25zdCBleGNsdWRlRGF0YVR5cGVzID0gWydudW1iZXInLCAnZGF0ZScsICdkYXRldGltZSddO1xyXG4gICAgICAgIGlmIChjb25kaXRpb24pIHtcclxuICAgICAgICAgICAgY29uc3QgZmllbGRzID0gT2JqZWN0LmtleXMoY29uZGl0aW9uKTtcclxuICAgICAgICAgICAgaWYgKGZpZWxkcyAmJiBmaWVsZHMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICBmaWVsZHMuZm9yRWFjaChmaWVsZCA9PiB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGNvbHVtbkluZm8gPSB0aGlzLmRmcy5nZXRDb2x1bW4oZmllbGQpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGRhdGFUeXBlID0gY29sdW1uSW5mby5kYXRhVHlwZSB8fCAnc3RyaW5nJztcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgb2JqID0geyBmaWx0ZXJGaWVsZDogZmllbGQsIHZhbHVlOiAnJywgbGJyYWNrZXQ6ICcnLCByYnJhY2tldDogJycsIHJlbGF0aW9uOiAxLCBjb21wYXJlOiAwIH07XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgY29uZGl0aW9uVmFsID0gY29uZGl0aW9uW2ZpZWxkXTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGNvbmRpdGlvblZhbCA9PT0gJ29iamVjdCcpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGZzIDU2ODQ4NFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBvcGVyYXRvcjEgPSBwYXJzZUludCgnJyArIGNvbmRpdGlvblZhbC5vcGVyYXRvcjEsIDEwKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG9wZXJhdG9yMSA9PT0gMTAwMSB8fCBvcGVyYXRvcjEgPT09IDEwMDIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9iai5jb21wYXJlID0gb3BlcmF0b3IxID09PSAxMDAxID8gQ29tcGFyZS5FcXVhbCA6IENvbXBhcmUuTm90RXF1YWw7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYmoubGJyYWNrZXQgPSAnKCc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYmoucmVsYXRpb24gPSBvcGVyYXRvcjEgPT09IDEwMDIgPyAxIDogMjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbHRlckFyci5wdXNoKG9iaik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXhjbHVkZURhdGFUeXBlcy5pbmNsdWRlcyhkYXRhVHlwZSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYmoudmFsdWUgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9iai5sYnJhY2tldCA9ICcnO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9iai5yZWxhdGlvbiA9IDE7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2JqLmNvbXBhcmUgPSBvcGVyYXRvcjEgPT09IDEwMDIgPyBDb21wYXJlLklzTm90IDogQ29tcGFyZS5JcztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgb2JqMiA9IHsgZmlsdGVyRmllbGQ6IGZpZWxkLCB2YWx1ZTogbnVsbCwgbGJyYWNrZXQ6ICcnLCByYnJhY2tldDogJyknLCByZWxhdGlvbjogMSwgY29tcGFyZTogMCB9O1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvcGVyYXRvcjEgPT09IDEwMDIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYmoyLmNvbXBhcmUgPSBDb21wYXJlLklzTm90O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYmoyLmNvbXBhcmUgPSBDb21wYXJlLklzO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWx0ZXJBcnIucHVzaChvYmoyKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgb2JqLmNvbXBhcmUgPSBjb25kaXRpb25WYWwub3BlcmF0b3IxO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBvYmoudmFsdWUgPSBjb25kaXRpb25WYWwudmFsdWUxO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmaWx0ZXJBcnIucHVzaChvYmopO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoY29uZGl0aW9uVmFsLnZhbHVlMikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb2JqLmxicmFja2V0ID0gJygnO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb2JqLnJlbGF0aW9uID0gY29uZGl0aW9uVmFsLnJlbGF0aW9uID09PSAnYW5kJyA/IDEgOiAyO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG9iajIgPSB7IGZpbHRlckZpZWxkOiBmaWVsZCwgdmFsdWU6ICcnLCBsYnJhY2tldDogJycsIHJicmFja2V0OiAnKScsIHJlbGF0aW9uOiAxLCBjb21wYXJlOiAwIH07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYmoyLmNvbXBhcmUgPSBjb25kaXRpb25WYWwub3BlcmF0b3IyO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb2JqMi52YWx1ZSA9IGNvbmRpdGlvblZhbC52YWx1ZTI7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsdGVyQXJyLnB1c2gob2JqMik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY29uZGl0aW9uVmFsLm9wZXJhdG9yMikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG9wMiA9IHBhcnNlSW50KCcnICsgY29uZGl0aW9uVmFsLm9wZXJhdG9yMiwgMTApOyAvLyAgRW1wdHk6IDEwMDEsIE5vdEVtcHR5OiAxMDAyXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG9wMiA9PT0gMTAwMSB8fCBvcDIgPT09IDEwMDIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2JqLmxicmFja2V0ID0gJygnO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYmoucmVsYXRpb24gPSBjb25kaXRpb25WYWwucmVsYXRpb24gPT09ICdhbmQnID8gMSA6IDI7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBvYmoyID0geyBmaWx0ZXJGaWVsZDogZmllbGQsIHZhbHVlOiAnJywgbGJyYWNrZXQ6ICcoJywgcmJyYWNrZXQ6ICcnLCByZWxhdGlvbjogMiwgY29tcGFyZTogMCB9O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYmoyLmNvbXBhcmUgPSBvcDIgPT09IDEwMDEgPyBDb21wYXJlLkVxdWFsIDogQ29tcGFyZS5Ob3RFcXVhbDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2JqMi5yZWxhdGlvbiA9IG9wMiA9PT0gMTAwMj8gMTogMjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsdGVyQXJyLnB1c2gob2JqMik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChleGNsdWRlRGF0YVR5cGVzLmluY2x1ZGVzKGRhdGFUeXBlKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2JqMi52YWx1ZSA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYmoyLmxicmFja2V0ID0gJyc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYmoyLnJicmFja2V0ID0gJyknO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2JqMi5yZWxhdGlvbiA9IDE7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYmoyLmNvbXBhcmUgPSBvcDIgPT09IDEwMDIgPyBDb21wYXJlLklzTm90IDogQ29tcGFyZS5JcztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgb2JqMjEgPSB7IGZpbHRlckZpZWxkOiBmaWVsZCwgdmFsdWU6IG51bGwsIGxicmFja2V0OiAnJywgcmJyYWNrZXQ6ICcpKScsIHJlbGF0aW9uOiAxLCBjb21wYXJlOiAwIH07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9iajIxLmNvbXBhcmUgPSBvcDIgPT09IDEwMDEgPyBDb21wYXJlLklzIDogQ29tcGFyZS5Jc05vdDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsdGVyQXJyLnB1c2gob2JqMjEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gb2JqO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChmaWx0ZXJBcnIubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2hlY2tFbnVtVHlwZUZpbHRlcnMoZmlsdGVyQXJyKTtcclxuICAgICAgICAgICAgZmlsdGVyQXJyW2ZpbHRlckFyci5sZW5ndGggLSAxXS5yZWxhdGlvbiA9IDA7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gZmlsdGVyQXJyO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgY2hlY2tFbnVtVHlwZUZpbHRlcnMoZmlsdGVyQXJyOiBGaWx0ZXJDb25kaXRpb25bXSkge1xyXG4gICAgICAgIGNvbnN0IGVudW1GaWx0ZXJzOntba2V5OnN0cmluZ106IGFueVtdfSA9IHsgfTtcclxuICAgICAgICBmaWx0ZXJBcnIuZm9yRWFjaCgoZiwgaSkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBlbnVtRmlsdGVyQXJyID0gdGhpcy5jb252ZXJ0RW51bVR5cGVGaWx0ZXIoZik7XHJcbiAgICAgICAgICAgIGlmIChlbnVtRmlsdGVyQXJyICYmIGVudW1GaWx0ZXJBcnIubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICBlbnVtRmlsdGVyc1tmLmZpbHRlckZpZWxkXSA9IGVudW1GaWx0ZXJBcnJcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBjb25zdCBrZXlzID0gT2JqZWN0LmtleXMoZW51bUZpbHRlcnMpO1xyXG4gICAgICAgIGlmIChrZXlzLmxlbmd0aCkge1xyXG4gICAgICAgICAgICBrZXlzLmZvckVhY2goKGspID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSBmaWx0ZXJBcnIuZmluZEluZGV4KG4gPT4gbi5maWx0ZXJGaWVsZCA9PT0gayk7XHJcbiAgICAgICAgICAgICAgICBmaWx0ZXJBcnIuc3BsaWNlKGksIDEsIC4uLmVudW1GaWx0ZXJzW2tdKTtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBmaWx0ZXJBcnI7XHJcbiAgICB9XHJcblxyXG4gICAgLy8g5bCGZW51bSDnsbvlnovnmoTmnaHku7bovazmjaLlpJrkuKrmnaHku7ZcclxuICAgIHByaXZhdGUgY29udmVydEVudW1UeXBlRmlsdGVyKGZpbHRlcjogRmlsdGVyQ29uZGl0aW9uKSA6IEZpbHRlckNvbmRpdGlvbltdIHtcclxuICAgICAgICBpZiAoZmlsdGVyKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGNvbCA9IHRoaXMuZGZzLmdldENvbHVtbihmaWx0ZXIuZmlsdGVyRmllbGQpIGFzIERhdGFDb2x1bW47XHJcbiAgICAgICAgICAgIGlmIChjb2wgJiYgY29sLmZpbHRlciAmJiBjb2wuZmlsdGVyLnR5cGUgPT09ICBDb2x1bW5GaWx0ZXJUeXBlLmVudW0pICB7XHJcbiAgICAgICAgICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShmaWx0ZXIudmFsdWUpICYmIGZpbHRlci52YWx1ZS5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoZmlsdGVyLnZhbHVlLmxlbmd0aCA9PT0gMSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmaWx0ZXIuY29tcGFyZSA9IENvbXBhcmUuRXF1YWw7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZpbHRlci52YWx1ZSA9IGZpbHRlci52YWx1ZVswXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFtdO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vID4gMVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgZmlsdGVyQXJyID0gZmlsdGVyLnZhbHVlLm1hcCgodmFsOiBhbnkpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsdGVyRmllbGQ6IGZpbHRlci5maWx0ZXJGaWVsZCwgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IHZhbCwgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGJyYWNrZXQ6ICcnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJicmFja2V0OiAnJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWxhdGlvbjogMiwgIC8vIG9yXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29tcGFyZTogMFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZmlsdGVyQXJyWzBdLmxicmFja2V0ID0gJygnO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmaWx0ZXJBcnJbZmlsdGVyLnZhbHVlLmxlbmd0aCAtMV0ucmJyYWNrZXQgPSAnKSc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZpbHRlckFycltmaWx0ZXIudmFsdWUubGVuZ3RoIC0xXS5yZWxhdGlvbiA9IDE7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmaWx0ZXJBcnI7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gW107XHJcbiAgICB9XHJcblxyXG4gICAgY3JlYXRlQ29sdW1uRmlsdGVyT3B0aW9ucyhjb2w6IERhdGFDb2x1bW4pIHtcclxuICAgICAgICBsZXQgZmlsdGVyVHlwZU9wdGlvbnM6IENvbHVtbkZpbHRlciA9IHtcclxuICAgICAgICAgICAgdHlwZTogQ29sdW1uRmlsdGVyVHlwZS5zdHJpbmcsXHJcbiAgICAgICAgICAgIGVuYWJsZU9wZXJhdG9yOiB0cnVlXHJcbiAgICAgICAgfTtcclxuICAgICAgICBpZiAoY29sLmVkaXRvcikge1xyXG4gICAgICAgICAgICBzd2l0Y2ggKGNvbC5lZGl0b3IudHlwZSkge1xyXG4gICAgICAgICAgICAgICAgY2FzZSAndGV4dGFyZWEnOlxyXG4gICAgICAgICAgICAgICAgY2FzZSAndGV4dGJveCc6XHJcbiAgICAgICAgICAgICAgICBjYXNlICdsYW5ndWFnZS10ZXh0Ym94JzpcclxuICAgICAgICAgICAgICAgICAgICBmaWx0ZXJUeXBlT3B0aW9ucyA9IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogQ29sdW1uRmlsdGVyVHlwZS5zdHJpbmcsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGVuYWJsZU9wZXJhdG9yOiB0cnVlXHJcbiAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgJ2NoZWNrYm94JzpcclxuICAgICAgICAgICAgICAgIGNhc2UgJ3N3aXRjaCc6XHJcbiAgICAgICAgICAgICAgICAgICAgZmlsdGVyVHlwZU9wdGlvbnMgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IENvbHVtbkZpbHRlclR5cGUuYm9vbGVhbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgZW5hYmxlT3BlcmF0b3I6IGZhbHNlXHJcbiAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgJ251bWJlcmJveCc6XHJcbiAgICAgICAgICAgICAgICAgICAgZmlsdGVyVHlwZU9wdGlvbnMgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IENvbHVtbkZpbHRlclR5cGUubnVtYmVyLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBlbmFibGVPcGVyYXRvcjogdHJ1ZVxyXG4gICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlICdjb21ib2xpc3QnOlxyXG4gICAgICAgICAgICAgICAgY2FzZSAnc2VsZWN0JzpcclxuICAgICAgICAgICAgICAgICAgICBmaWx0ZXJUeXBlT3B0aW9ucyA9IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogQ29sdW1uRmlsdGVyVHlwZS5lbnVtLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBlbmFibGVPcGVyYXRvcjogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9uczogY29sLmVkaXRvci5vcHRpb25zXHJcbiAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgJ2RhdGVwaWNrZXInOlxyXG4gICAgICAgICAgICAgICAgICAgIGZpbHRlclR5cGVPcHRpb25zID0ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBjb2xbJ2RhdGFUeXBlJ10gPT09ICdkYXRldGltZScgPyBDb2x1bW5GaWx0ZXJUeXBlLmRhdGV0aW1lIDogQ29sdW1uRmlsdGVyVHlwZS5kYXRlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBlbmFibGVPcGVyYXRvcjogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9uczoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZUZvcm1hdDogY29sLmVkaXRvci5vcHRpb25zLmRhdGVGb3JtYXQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm5Gb3JtYXQ6IGNvbC5lZGl0b3Iub3B0aW9ucy5yZXR1cm5Gb3JtYXRcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlICd0aW1lcGlja2VyJzpcclxuICAgICAgICAgICAgICAgICAgICBmaWx0ZXJUeXBlT3B0aW9ucyA9IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogQ29sdW1uRmlsdGVyVHlwZS50aW1lLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBlbmFibGVPcGVyYXRvcjogdHJ1ZVxyXG4gICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIGlmIChjb2wuZm9ybWF0dGVyKSB7XHJcbiAgICAgICAgICAgIGlmICh0eXBlb2YgY29sLmZvcm1hdHRlciA9PT0gJ29iamVjdCcgJiYgT2JqZWN0LmtleXMoY29sLmZvcm1hdHRlcikubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBvcHRpb25zOiBhbnkgPSBjb2wuZm9ybWF0dGVyWydvcHRpb25zJ107XHJcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKGNvbC5mb3JtYXR0ZXJbJ3R5cGUnXSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ251bWJlcic6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZpbHRlclR5cGVPcHRpb25zID0ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogQ29sdW1uRmlsdGVyVHlwZS5udW1iZXIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmFibGVPcGVyYXRvcjogdHJ1ZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICBjYXNlICdlbnVtJzpcclxuICAgICAgICAgICAgICAgICAgICAgICAgZmlsdGVyVHlwZU9wdGlvbnMgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBDb2x1bW5GaWx0ZXJUeXBlLmVudW0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmFibGVPcGVyYXRvcjogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnNcclxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnYm9vbGVhbic6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZpbHRlclR5cGVPcHRpb25zID0ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogQ29sdW1uRmlsdGVyVHlwZS5ib29sZWFuLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5hYmxlT3BlcmF0b3I6IGZhbHNlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ2RhdGV0aW1lJzpcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHR5ZSA9IENvbHVtbkZpbHRlclR5cGUuZGF0ZXRpbWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBmbXQgPSAneXl5eS1NTS1kZCc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCByZXR1cm5GbXQgPSAneXl5eS1NTS1kZCc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvcHRpb25zICYmIG9wdGlvbnMuZm9ybWF0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmbXQgPSBvcHRpb25zLmZvcm1hdDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmbXQuaW5kZXhPZignSEg6JykgPT0gLTEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eWUgPSBDb2x1bW5GaWx0ZXJUeXBlLmRhdGU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybkZtdCArPSAnIEhIOm1tJztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZm10LmluZGV4T2YoJ3NzJykgPiAtMSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm5GbXQgKz0gJzpzcyc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHllID0gQ29sdW1uRmlsdGVyVHlwZS5kYXRlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZpbHRlclR5cGVPcHRpb25zID0ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogdHllLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5hYmxlT3BlcmF0b3I6IHRydWVcclxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZpbHRlclR5cGVPcHRpb25zLm9wdGlvbnMgPSB7IGRhdGVGb3JtYXQ6IGZtdCwgcmV0dXJuRm9ybWF0OiByZXR1cm5GbXQgfTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgZmlsdGVyVHlwZU9wdGlvbnMgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBDb2x1bW5GaWx0ZXJUeXBlLnN0cmluZyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuYWJsZU9wZXJhdG9yOiB0cnVlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBmaWx0ZXJUeXBlT3B0aW9ucyA9IHtcclxuICAgICAgICAgICAgICAgIHR5cGU6IENvbHVtbkZpbHRlclR5cGUuc3RyaW5nLFxyXG4gICAgICAgICAgICAgICAgZW5hYmxlT3BlcmF0b3I6IHRydWVcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGZpbHRlclR5cGVPcHRpb25zO1xyXG4gICAgfVxyXG5cclxuICAgIC8vI3JlZ2lvbiAgU21hcnQgRmlsdGVyXHJcblxyXG4gICAgY29udmVydFNtYXJ0RmlsdGVyMkVudGl0eUZpbHRlcihjb25kaXRpb25zOiBhbnlbXSkge1xyXG4gICAgICAgIGlmIChjb25kaXRpb25zICYmIGNvbmRpdGlvbnMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBjb25kaXRpb25zLm1hcChuID0+IHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBuO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBbXTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIHZhbGlkYXRlUm93RGF0YTIocm93RGF0YTogYW55LCBjb25kaXRpb25zOiBhbnkpIHtcclxuICAgICAgICBpZiAoIWNvbmRpdGlvbnMgfHwgY29uZGl0aW9ucy5sZW5ndGggPT09IDApIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0aGlzLmNoZWNrUm93RGF0YVdpdGhDb25kaXRpb24ocm93RGF0YSwgY29uZGl0aW9ucyk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBjaGVja1Jvd0RhdGFXaXRoQ29uZGl0aW9uKHJvd0RhdGE6IGFueSwgY29uZGl0aW9ucykge1xyXG4gICAgICAgIGxldCByZXN1bHRPYmogPSBudWxsO1xyXG4gICAgICAgIGlmIChjb25kaXRpb25zKSB7XHJcbiAgICAgICAgICAgIHJlc3VsdE9iaiA9IHt9O1xyXG4gICAgICAgICAgICBjb25kaXRpb25zLmZvckVhY2goY29uZGl0aW9uID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGZpZWxkID0gY29uZGl0aW9uLkZpbHRlckZpZWxkO1xyXG4gICAgICAgICAgICAgICAgbGV0IGZpZWxkVmFsdWUgPSBVdGlscy5nZXRWYWx1ZShmaWVsZCwgcm93RGF0YSk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBjb2x1bW5PYmogPSB0aGlzLmRmcy5nZXRDb2x1bW4oZmllbGQpO1xyXG4gICAgICAgICAgICAgICAgaWYgKGNvbHVtbk9iaiAmJiBjb2x1bW5PYmouaXNNdWx0aWxpbmd1YWxGaWVsZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGZpZWxkVmFsdWUgPSBVdGlscy5nZXRNdWx0aWxpbmd1YWxWYWx1ZShmaWVsZFZhbHVlLCB0aGlzLmxvY2FsZVNlci5sb2NhbGVJZCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgY29uc3Qgd2hlcmUgPSBjb25kaXRpb247XHJcbiAgICAgICAgICAgICAgICBjb25zdCB7IFZhbHVlLCBSZWxhdGlvbiwgQ29tcGFyZTogb3BlcmF0b3IxIH0gPSB3aGVyZTtcclxuICAgICAgICAgICAgICAgIGlmICh3aGVyZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHIgPSB0aGlzLmdldENvbXBhcmVSZXN1bHQoZmllbGRWYWx1ZSwgb3BlcmF0b3IxLCBWYWx1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3VsdE9ialtmaWVsZF0gPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHRPYmpbZmllbGRdID0gWyByIF07XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0T2JqW2ZpZWxkXS5wdXNoKHIpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gcmV0dXJuIHRoaXMuY2hlY2tBbGxGaWVsZFJlc3VsdChyZXN1bHRPYmopO1xyXG4gICAgICAgIGNvbnN0IGZpZWxkcyA9IE9iamVjdC5rZXlzKHJlc3VsdE9iaik7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gW107XHJcbiAgICAgICAgZmllbGRzLmZvckVhY2goIChmKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IF9maWx0ZXJzID0gY29uZGl0aW9ucy5maWx0ZXIobiA9PiBuLkZpbHRlckZpZWxkID09PSBmKTtcclxuICAgICAgICAgICAgaWYgKHJlc3VsdE9ialtmXS5sZW5ndGggPT09IDEpIHtcclxuICAgICAgICAgICAgICAgIHJlc3VsdC5wdXNoKHJlc3VsdE9ialtmXVswXSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoX2ZpbHRlcnNbMF0uUmVsYXRpb24gPT09IDEgJiYgcmVzdWx0T2JqW2ZdLmxlbmd0aCA9PT0gMikgeyAgLy8gYW5kXHJcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0LnB1c2gocmVzdWx0T2JqW2ZdWzBdICYmIHJlc3VsdE9ialtmXVsxXSk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgeyAgLy8gb3JcclxuICAgICAgICAgICAgICAgICAgICByZXN1bHQucHVzaChyZXN1bHRPYmpbZl0uaW5kZXhPZih0cnVlKSA+IC0xKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXR1cm4gcmVzdWx0LmluZGV4T2YoZmFsc2UpID09PSAtMTtcclxuICAgIH1cclxuXHJcbiAgICBleGVjdXRlU21hcnRGaWx0ZXIoZGF0YTogW10sIGNvbmRpdGlvbnM6IGFueVtdKSB7XHJcbiAgICAgICAgaWYgKGRhdGEgJiYgZGF0YS5sZW5ndGgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGRhdGEuZmlsdGVyKG4gPT4gdGhpcy52YWxpZGF0ZVJvd0RhdGEyKG4sIGNvbmRpdGlvbnMpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGRhdGE7XHJcbiAgICB9XHJcblxyXG4gICAgLy8jZW5kcmVnaW9uXHJcbn1cclxuIl19