/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { LocaleService } from '@farris/ui-locale';
/*
 * @Author: 疯狂秀才(Lucas Huang)
 * @Date: 2019-08-14 13:53:03
 * @LastEditors: 疯狂秀才(Lucas Huang)
 * @LastEditTime: 2019-10-01 15:02:29
 * @QQ: 1055818239
 * @Version: v0.0.1
 */
import { Component, Input, Output, Optional, ElementRef, Renderer2, EventEmitter, Directive, HostListener, Injector, ViewChild, NgZone } from '@angular/core';
import { convertColumns } from '../datatable-column';
import { DataTableService } from '../datatable.service';
import { DataTableComponent } from '../datatable.component';
import { ColumnFormatService } from '@farris/ui-common/column';
import { CommonUtils } from '@farris/ui-common';
export class DTDblClickRowDirective {
    /**
     * @param {?} el
     * @param {?} dt
     */
    constructor(el, dt) {
        this.el = el;
        this.dt = dt;
    }
    /**
     * @return {?}
     */
    ngOnInit() { }
    /**
     * @param {?} event
     * @return {?}
     */
    ondblclick(event) {
        if (this.row) {
            this.dt.rowDblClick.emit(this.row);
        }
        event.stopPropagation();
    }
}
DTDblClickRowDirective.decorators = [
    { type: Directive, args: [{
                selector: '[dblclick]'
            },] }
];
/** @nocollapse */
DTDblClickRowDirective.ctorParameters = () => [
    { type: ElementRef },
    { type: DataTableComponent, decorators: [{ type: Optional }] }
];
DTDblClickRowDirective.propDecorators = {
    row: [{ type: Input, args: ['dblclick',] }],
    ondblclick: [{ type: HostListener, args: ['dblclick', ['$event'],] }]
};
if (false) {
    /** @type {?} */
    DTDblClickRowDirective.prototype.row;
    /** @type {?} */
    DTDblClickRowDirective.prototype.el;
    /** @type {?} */
    DTDblClickRowDirective.prototype.dt;
}
export class DataTableBodyComponent {
    /**
     * @param {?} el
     * @param {?} dataService
     * @param {?} render
     * @param {?} dt
     * @param {?} colFormatSer
     * @param {?} utils
     * @param {?} injector
     */
    constructor(el, dataService, render, dt, colFormatSer, utils, injector) {
        this.el = el;
        this.dataService = dataService;
        this.render = render;
        this.dt = dt;
        this.colFormatSer = colFormatSer;
        this.utils = utils;
        this.injector = injector;
        this.rows = [];
        this.rowDblClick = new EventEmitter();
        this.selectRow = new EventEmitter();
        this.cellEdit = new EventEmitter();
        this.cellClick = new EventEmitter();
        this.lastRowIndex = 0;
        this.lastColumnIndex = 0;
        this.edit = {};
        this.className = {};
        this.isRowTempl = false;
        this.selectedRowIndex = -1;
        this._selections = {};
        this.emptyMessage = '暂无数据';
        this.localeService = this.injector.get(LocaleService);
        this.ngzone = this.injector.get(NgZone, null);
    }
    // 已选择的行 默认为空
    /**
     * @param {?} v
     * @return {?}
     */
    set selections(v) {
        this._selections = v || {};
        this.dt.updateCheckboxState(this.rows);
    }
    /**
     * @return {?}
     */
    get selections() {
        if (!this._selections) {
            return;
        }
        /** @type {?} */
        const keys = Object.keys(this._selections);
        if (keys.length) {
            if (this.dt.singleSelect) {
                return this._selections;
            }
            else {
                return keys.map((/**
                 * @param {?} k
                 * @return {?}
                 */
                k => this._selections[k]));
            }
        }
        return undefined;
    }
    /**
     * @return {?}
     */
    ngOnInit() {
        this.dataService.selectedAll.subscribe((/**
         * @param {?} allChecked
         * @return {?}
         */
        allChecked => {
            /** @type {?} */
            const idfield = this.idField();
            this.rows.forEach((/**
             * @param {?} row
             * @return {?}
             */
            row => {
                if (allChecked) {
                    this._selections[row[idfield]] = row;
                }
                else {
                    delete this._selections[row[idfield]];
                }
            }));
        }));
        if (this.rows) {
            this.isRowTempl = this.rows.some((/**
             * @param {?} row
             * @return {?}
             */
            row => {
                return row.hasOwnProperty('rowTempl');
            }));
        }
        if (this.fixed === 'left') {
            this.columns = convertColumns(this.columns, 'left');
        }
        if (this.fixed === 'right') {
            this.columns = convertColumns(this.columns, 'right');
        }
        this.emptyMessage = this.localeService.getValue('datagrid.emptyMessage');
    }
    /**
     * @return {?}
     */
    ngAfterViewInit() {
        this._rows = this.el.nativeElement.querySelectorAll('tr');
        this.checkBodyHeightWhenEmptyData();
    }
    /**
     * @return {?}
     */
    checkBodyHeightWhenEmptyData() {
        if (this.emptyTbodyElRef && !(this.rows && this.rows.length)) {
            if (this.emptyTbodyElRef.nativeElement.offsetHeight < 130) {
                this.emptyTbodyElRef.nativeElement.style.height = this.dt.pagination ? '150px' : '120px';
            }
        }
    }
    /**
     * @param {?} changes
     * @return {?}
     */
    ngOnChanges(changes) {
        if (changes.rows && !changes.rows.isFirstChange()) {
            if (!this.dt.singleSelect) {
                /** @type {?} */
                const _rows = changes.rows.currentValue || [];
                /** @type {?} */
                const checkedRows = _rows.map((/**
                 * @param {?} n
                 * @return {?}
                 */
                n => {
                    return this.isSelected(n) ? n : 0;
                })).filter((/**
                 * @param {?} n
                 * @return {?}
                 */
                n => n));
                if (!_rows.length) {
                    this.dataService.updateCheckAllStatus.next(0);
                    return;
                }
                /** @type {?} */
                const idfield = this.idField();
                /** @type {?} */
                let checkTotal = 0;
                _rows.forEach((/**
                 * @param {?} element
                 * @return {?}
                 */
                element => {
                    if (checkedRows.find((/**
                     * @param {?} n
                     * @return {?}
                     */
                    n => n[idfield] === element[idfield]))) {
                        checkTotal += 1;
                    }
                }));
                if (_rows.length === checkTotal) {
                    this.dataService.updateCheckAllStatus.next(1);
                }
                else {
                    if (checkedRows.length === 0) {
                        this.dataService.updateCheckAllStatus.next(0);
                    }
                    else {
                        this.dataService.updateCheckAllStatus.next(2);
                    }
                }
            }
        }
    }
    /**
     * 获取对象中指定字段的值。 field: 可以为带有层级结构的路径，如： user.firstName | name 等
     * @param {?} field
     * @param {?} data
     * @return {?}
     */
    getValue(field, data) {
        if (field.indexOf('.') === -1) {
            return data[field];
        }
        else {
            return (field.split('.').reduce((/**
             * @param {?} obj
             * @param {?} key
             * @return {?}
             */
            (obj, key) => {
                return obj[key];
            }), data) || '');
        }
    }
    /**
     * @param {?} event
     * @param {?} index
     * @param {?} data
     * @return {?}
     */
    selectedRow(event, index, data) {
        if (event) {
            event.stopPropagation();
            event.preventDefault();
        }
        /** @type {?} */
        let isSelected = false;
        /** @type {?} */
        const idfield = this.idField();
        if (this.dt.singleSelect) {
            if (this.selectedRowIndex !== index || !this._selections || this._selections[idfield] !== data[idfield]) {
                this.selectedRowIndex = index;
                this._selections = data;
                isSelected = true;
                this.dataService.selectedRow.next({
                    rowIndex: index,
                    rowData: data
                });
            }
            else {
                if (!this.dt.keepSelect) {
                    this.selectedRowIndex = -1;
                    this._selections = undefined;
                    isSelected = false;
                    this.dataService.unSelectedRow.next({
                        rowIndex: index,
                        rowData: data
                    });
                }
                else {
                    isSelected = true;
                }
            }
        }
        else {
            if (this.isSelected(data)) {
                delete this._selections[data[idfield]];
                isSelected = false;
                this.dataService.unSelectedRow.next({
                    rowIndex: index,
                    rowData: data
                });
            }
            else {
                this._selections[data[this.idField()]] = data;
                isSelected = true;
                this.dataService.selectedRow.next({
                    rowIndex: index,
                    rowData: data
                });
            }
        }
        if (isSelected) {
            this.dt.selectedRow.emit({ data, index });
            // 兼容
            this.dt.selectRows.emit({ data, index });
        }
        else {
            this.dt.unSelectRow.emit({ data, index });
        }
    }
    /**
     * @param {?} event
     * @param {?} index
     * @param {?} data
     * @return {?}
     */
    onChecked(event, index, data) {
        /** @type {?} */
        const state = event.checked;
        /** @type {?} */
        const idfield = this.dt.idField;
        if (state) {
            this._selections[data[idfield]] = data;
            this.dataService.selectedRow.next({
                rowIndex: index,
                rowData: data
            });
            this.dt.selectedRow.emit({ data, index });
            // 兼容
            this.dt.selectRows.emit({ data, index });
        }
        else {
            delete this._selections[data[idfield]];
            this.dataService.unSelectedRow.next({
                rowIndex: index,
                rowData: data
            });
            this.dt.unSelectRow.emit({ data, index });
        }
        event.originalEvent.stopPropagation();
    }
    /**
     * @private
     * @return {?}
     */
    idField() {
        return this.dt.idField;
    }
    /**
     * @param {?} row
     * @param {?=} tr
     * @return {?}
     */
    isSelected(row, tr) {
        /** @type {?} */
        const idfield = this.idField();
        if (this._selections) {
            if (this.dt.singleSelect) {
                return this._selections[idfield] === row[idfield];
            }
            else {
                return this._selections[row[idfield]] !== undefined;
            }
        }
        return false;
    }
    /**
     * @param {?} field
     * @param {?} data
     * @param {?} formatter
     * @return {?}
     */
    formatData(field, data, formatter) {
        /** @type {?} */
        const value = this.utils.getValue(field, data, true);
        return this.colFormatSer.format(value, data, formatter);
    }
    // 添加自定义设置列 单元格类样式
    /**
     * @param {?} value
     * @param {?} col
     * @return {?}
     */
    getTdClassName(value, col) {
        /** @type {?} */
        const tempClassName = {};
        // 列类的样式
        if (col.className &&
            Object.prototype.toString.call(col.className) === '[object String]') {
            tempClassName[col.className] = true;
        }
        if (this.cellClassName && this.cellClassName(value, col)) {
            tempClassName[this.cellClassName(value, col)] = true;
        }
        return tempClassName;
    }
    /**
     * @param {?} row
     * @param {?} index
     * @return {?}
     */
    createRowClassName(row, index) {
        return this.rowClassName ? this.rowClassName(row, index) : '';
    }
    /**
     * @param {?} event
     * @param {?} col
     * @param {?} row
     * @return {?}
     */
    onCellClick(event, col, row) {
        this.cellClick.emit({ event, col, row });
    }
    /**
     * @param {?} row
     * @param {?} index
     * @return {?}
     */
    renderRowStyle(row, index) {
        if (this.dt.rowStyler) {
            return this.dt.rowStyler({ data: row, index });
        }
        return '';
    }
    /**
     * @param {?} val
     * @param {?} row
     * @param {?} index
     * @param {?} col
     * @return {?}
     */
    renderCellStyle(val, row, index, col) {
        if (this.dt.cellStyler) {
            return this.dt.cellStyler({ value: val, data: row, index, col, field: col.field });
        }
        return '';
    }
}
DataTableBodyComponent.decorators = [
    { type: Component, args: [{
                selector: 'datatable-body',
                template: `
        <table
            class="table"
            [class.table-sm]="size === 'small'"
            [class.table-hover]="dt.hover"
            [class.table-striped]="striped"
            [class.table-bordered]="bordered"
            [class.f-table-norecords]="!rows || !rows.length"
            style="border-collapse: separate;border-spacing: 0;"
        >
            <colgroup>
                <col class="dt-checkbox-cell" *ngIf="!dt.singleSelect" />
                <col *ngFor="let col of columns" [style.width]="col.width + 'px'" />
            </colgroup>

            <tbody class="ui-table-tbody " *ngIf="rows && rows.length">
                <tr
                    *ngFor="let row of rows; trackBy: dt.trackByRows; let rowIndex = index"
                    [ngClass]="createRowClassName(row, rowIndex)"
                    (click)="selectedRow($event, rowIndex, row)"
                    [class.selected]="isSelected(row, tr)" #tr
                    [dblclick]="row"
                    [ngStyle]="renderRowStyle(row, rowIndex)"
                >
                    <td class="dt-checkbox-cell datatable-fixed-left" *ngIf="!dt.singleSelect" 
                    [cell-styler]="{row: row, index: rowIndex}">
                        <dt-checkbox
                            [checked]="isSelected(row, tr)"
                            (checkedChange)="onChecked($event, rowIndex, row)"
                        ></dt-checkbox>
                    </td>
                    <td
                        [ngClass]="getTdClassName(row[col.field], col)"
                        *ngFor="let col of columns; let colIndex = index"
                        [style.textAlign]="col.align || 'left'"
                        
                        (click)="onCellClick($event, col, row)"
                        [class.datatable-fixed-right]="col['fixed'] === 'right'"
                        [cell-styler]="{val:utils.getValue(col.field, row), row: row, index: rowIndex, col: col}"
                    >
                        <ng-container *ngIf="!col.cellTempl; else cellTemp">
                            <span *ngIf="col.formatter" [innerHTML]="formatData(col.field, row, col.formatter) | safe:'html'" ></span>
                            <!-- <span *ngIf="col.formatter" [innerHTML]=" col.field | getvalue: row | columnformatter: col : row | safe: 'html'" ></span> -->
                            <span *ngIf="!col.formatter" [title]="utils.getValue(col.field, row)"
                             [textContent]="utils.getValue(col.field, row)"></span>
                        </ng-container>
                        <ng-template
                            #cellTemp
                            [ngTemplateOutlet]="col.cellTempl"
                            [ngTemplateOutletContext]="{
                                $implicit: row,
                                rowIndex: rowIndex,
                                value: row[col.field]
                            }"
                        ></ng-template>
                    </td>
                </tr>
            </tbody>

            <tbody class="ui-table-tbody" *ngIf="!rows || !rows.length" #emptyTbody>
                <tr class="f-table-norecords-row">
                    <td [attr.align]="'center'"
                        class="farris-treetable-emptydata"
                        [attr.colspan]="columns.length"
                    >
                        <div
                            class="f-table-norecords-content"
                            [innerHTML]="emptyMessage | safe: 'html'"
                        ></div>
                    </td>
                </tr>
            </tbody>
        </table>
    `,
                styles: [`
            .table td:focus-within {
                box-shadow: inset 0 0 0 2px rgba(0, 0, 0, 0.13);
            }
            .table td div {
                width: 100%;
                height: 100%;
            }
            .table td input {
                width: 100%;
                height: 100%;
                font-family: auto;
                line-height: 1;
                font-size: 13px;
            }
            .table td input:focus {
                border: 0;
            }
            input[type='checkbox']:focus {
                outline: none;
            }

            .f-table-norecords-row:hover {
                background-color: transparent!important;
                cursor: default!important;
            }
        `]
            }] }
];
/** @nocollapse */
DataTableBodyComponent.ctorParameters = () => [
    { type: ElementRef },
    { type: DataTableService },
    { type: Renderer2 },
    { type: DataTableComponent, decorators: [{ type: Optional }] },
    { type: ColumnFormatService },
    { type: CommonUtils },
    { type: Injector }
];
DataTableBodyComponent.propDecorators = {
    size: [{ type: Input }],
    hover: [{ type: Input }],
    bordered: [{ type: Input }],
    striped: [{ type: Input }],
    columns: [{ type: Input }],
    fixed: [{ type: Input }],
    rows: [{ type: Input }],
    rowClassName: [{ type: Input }],
    cellClassName: [{ type: Input }],
    rowDblClick: [{ type: Output }],
    selectRow: [{ type: Output }],
    cellEdit: [{ type: Output }],
    cellClick: [{ type: Output }],
    emptyTbodyElRef: [{ type: ViewChild, args: ['emptyTbody',] }]
};
if (false) {
    /** @type {?} */
    DataTableBodyComponent.prototype.size;
    /** @type {?} */
    DataTableBodyComponent.prototype.hover;
    /** @type {?} */
    DataTableBodyComponent.prototype.bordered;
    /** @type {?} */
    DataTableBodyComponent.prototype.striped;
    /** @type {?} */
    DataTableBodyComponent.prototype.columns;
    /** @type {?} */
    DataTableBodyComponent.prototype.fixed;
    /** @type {?} */
    DataTableBodyComponent.prototype.rows;
    /** @type {?} */
    DataTableBodyComponent.prototype.rowClassName;
    /** @type {?} */
    DataTableBodyComponent.prototype.cellClassName;
    /** @type {?} */
    DataTableBodyComponent.prototype.rowDblClick;
    /** @type {?} */
    DataTableBodyComponent.prototype.selectRow;
    /** @type {?} */
    DataTableBodyComponent.prototype.cellEdit;
    /** @type {?} */
    DataTableBodyComponent.prototype.cellClick;
    /** @type {?} */
    DataTableBodyComponent.prototype.emptyTbodyElRef;
    /** @type {?} */
    DataTableBodyComponent.prototype.lastRowIndex;
    /** @type {?} */
    DataTableBodyComponent.prototype.lastColumnIndex;
    /** @type {?} */
    DataTableBodyComponent.prototype.boxShadow;
    /** @type {?} */
    DataTableBodyComponent.prototype._rows;
    /** @type {?} */
    DataTableBodyComponent.prototype.edit;
    /** @type {?} */
    DataTableBodyComponent.prototype.className;
    /** @type {?} */
    DataTableBodyComponent.prototype.isRowTempl;
    /** @type {?} */
    DataTableBodyComponent.prototype.selectedRowIndex;
    /** @type {?} */
    DataTableBodyComponent.prototype._selections;
    /** @type {?} */
    DataTableBodyComponent.prototype.emptyMessage;
    /**
     * @type {?}
     * @private
     */
    DataTableBodyComponent.prototype.localeService;
    /**
     * @type {?}
     * @private
     */
    DataTableBodyComponent.prototype.ngzone;
    /** @type {?} */
    DataTableBodyComponent.prototype.el;
    /**
     * @type {?}
     * @private
     */
    DataTableBodyComponent.prototype.dataService;
    /**
     * @type {?}
     * @private
     */
    DataTableBodyComponent.prototype.render;
    /** @type {?} */
    DataTableBodyComponent.prototype.dt;
    /** @type {?} */
    DataTableBodyComponent.prototype.colFormatSer;
    /** @type {?} */
    DataTableBodyComponent.prototype.utils;
    /**
     * @type {?}
     * @private
     */
    DataTableBodyComponent.prototype.injector;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGF0YXRhYmxlLWJvZHkuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGZhcnJpcy91aS1kYXRhdGFibGUvIiwic291cmNlcyI6WyJsaWIvdGFibGUvZGF0YXRhYmxlLWJvZHkuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7QUFBQSxPQUFPLEVBQUUsYUFBYSxFQUFFLE1BQU0sbUJBQW1CLENBQUM7Ozs7Ozs7OztBQVNsRCxPQUFPLEVBQ0gsU0FBUyxFQUVULEtBQUssRUFDTCxNQUFNLEVBQ04sUUFBUSxFQUNSLFVBQVUsRUFDVixTQUFTLEVBRVQsWUFBWSxFQUNaLFNBQVMsRUFDVCxZQUFZLEVBRVosUUFBUSxFQUdSLFNBQVMsRUFDVCxNQUFNLEVBQ1QsTUFBTSxlQUFlLENBQUM7QUFDdkIsT0FBTyxFQUFFLGNBQWMsRUFBRSxNQUFNLHFCQUFxQixDQUFDO0FBQ3JELE9BQU8sRUFBRSxnQkFBZ0IsRUFBRSxNQUFNLHNCQUFzQixDQUFDO0FBQ3hELE9BQU8sRUFBRSxrQkFBa0IsRUFBRSxNQUFNLHdCQUF3QixDQUFDO0FBQzVELE9BQU8sRUFBRSxtQkFBbUIsRUFBYyxNQUFNLDBCQUEwQixDQUFDO0FBQzNFLE9BQU8sRUFBRSxXQUFXLEVBQUUsTUFBTSxtQkFBbUIsQ0FBQztBQUtoRCxNQUFNLE9BQU8sc0JBQXNCOzs7OztJQUUvQixZQUNXLEVBQWMsRUFDRixFQUFzQjtRQURsQyxPQUFFLEdBQUYsRUFBRSxDQUFZO1FBQ0YsT0FBRSxHQUFGLEVBQUUsQ0FBb0I7SUFDMUMsQ0FBQzs7OztJQUVKLFFBQVEsS0FBSSxDQUFDOzs7OztJQUdiLFVBQVUsQ0FBQyxLQUFZO1FBQ25CLElBQUksSUFBSSxDQUFDLEdBQUcsRUFBRTtZQUNWLElBQUksQ0FBQyxFQUFFLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUM7U0FDdEM7UUFFRCxLQUFLLENBQUMsZUFBZSxFQUFFLENBQUM7SUFDNUIs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QUs7bUJBQ0wsS0FBSzsyQkFDTCxLQUFLOzRCQUNMLEtBQUs7MEJBQ0wsTUFBTTt3QkFDTixNQUFNO3VCQUNOLE1BQU07d0JBQ04sTUFBTTs4QkFFTixTQUFTLFNBQUMsWUFBWTs7OztJQWR2QixzQ0FBc0I7O0lBQ3RCLHVDQUF3Qjs7SUFDeEIsMENBQTJCOztJQUMzQix5Q0FBMEI7O0lBQzFCLHlDQUErQjs7SUFDL0IsdUNBQXVCOztJQUN2QixzQ0FBMEI7O0lBQzFCLDhDQUEyRDs7SUFDM0QsK0NBQXlEOztJQUN6RCw2Q0FBMkM7O0lBQzNDLDJDQUFpRTs7SUFDakUsMENBQWdFOztJQUNoRSwyQ0FBaUU7O0lBRWpFLGlEQUFxRDs7SUFFckQsOENBQWlCOztJQUNqQixpREFBb0I7O0lBQ3BCLDJDQUFrQjs7SUFDbEIsdUNBQVc7O0lBQ1gsc0NBQVU7O0lBQ1YsMkNBQWU7O0lBQ2YsNENBQW1COztJQUNuQixrREFBc0I7O0lBQ3RCLDZDQUFpQjs7SUFDakIsOENBQXNCOzs7OztJQXVCdEIsK0NBQXFDOzs7OztJQUNyQyx3Q0FBdUI7O0lBRW5CLG9DQUFxQjs7Ozs7SUFDckIsNkNBQXFDOzs7OztJQUNyQyx3Q0FBeUI7O0lBQ3pCLG9DQUF5Qzs7SUFDekMsOENBQXdDOztJQUN4Qyx1Q0FBeUI7Ozs7O0lBQ3pCLDBDQUEwQiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IExvY2FsZVNlcnZpY2UgfSBmcm9tICdAZmFycmlzL3VpLWxvY2FsZSc7XHJcbi8qXHJcbiAqIEBBdXRob3I6IOeWr+eLguengOaJjShMdWNhcyBIdWFuZylcclxuICogQERhdGU6IDIwMTktMDgtMTQgMTM6NTM6MDNcclxuICogQExhc3RFZGl0b3JzOiDnlq/ni4Lnp4DmiY0oTHVjYXMgSHVhbmcpXHJcbiAqIEBMYXN0RWRpdFRpbWU6IDIwMTktMTAtMDEgMTU6MDI6MjlcclxuICogQFFROiAxMDU1ODE4MjM5XHJcbiAqIEBWZXJzaW9uOiB2MC4wLjFcclxuICovXHJcbmltcG9ydCB7XHJcbiAgICBDb21wb25lbnQsXHJcbiAgICBPbkluaXQsXHJcbiAgICBJbnB1dCxcclxuICAgIE91dHB1dCxcclxuICAgIE9wdGlvbmFsLFxyXG4gICAgRWxlbWVudFJlZixcclxuICAgIFJlbmRlcmVyMixcclxuICAgIEFmdGVyVmlld0luaXQsXHJcbiAgICBFdmVudEVtaXR0ZXIsXHJcbiAgICBEaXJlY3RpdmUsXHJcbiAgICBIb3N0TGlzdGVuZXIsXHJcbiAgICBTa2lwU2VsZixcclxuICAgIEluamVjdG9yLFxyXG4gICAgT25DaGFuZ2VzLFxyXG4gICAgU2ltcGxlQ2hhbmdlcyxcclxuICAgIFZpZXdDaGlsZCxcclxuICAgIE5nWm9uZVxyXG59IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBjb252ZXJ0Q29sdW1ucyB9IGZyb20gJy4uL2RhdGF0YWJsZS1jb2x1bW4nO1xyXG5pbXBvcnQgeyBEYXRhVGFibGVTZXJ2aWNlIH0gZnJvbSAnLi4vZGF0YXRhYmxlLnNlcnZpY2UnO1xyXG5pbXBvcnQgeyBEYXRhVGFibGVDb21wb25lbnQgfSBmcm9tICcuLi9kYXRhdGFibGUuY29tcG9uZW50JztcclxuaW1wb3J0IHsgQ29sdW1uRm9ybWF0U2VydmljZSwgRGF0YUNvbHVtbiB9IGZyb20gJ0BmYXJyaXMvdWktY29tbW9uL2NvbHVtbic7XHJcbmltcG9ydCB7IENvbW1vblV0aWxzIH0gZnJvbSAnQGZhcnJpcy91aS1jb21tb24nO1xyXG5cclxuQERpcmVjdGl2ZSh7XHJcbiAgICBzZWxlY3RvcjogJ1tkYmxjbGlja10nXHJcbn0pXHJcbmV4cG9ydCBjbGFzcyBEVERibENsaWNrUm93RGlyZWN0aXZlIGltcGxlbWVudHMgT25Jbml0IHtcclxuICAgIEBJbnB1dCgnZGJsY2xpY2snKSByb3c7XHJcbiAgICBjb25zdHJ1Y3RvcihcclxuICAgICAgICBwdWJsaWMgZWw6IEVsZW1lbnRSZWYsXHJcbiAgICAgICAgQE9wdGlvbmFsKCkgcHVibGljIGR0OiBEYXRhVGFibGVDb21wb25lbnRcclxuICAgICkge31cclxuXHJcbiAgICBuZ09uSW5pdCgpIHt9XHJcblxyXG4gICAgQEhvc3RMaXN0ZW5lcignZGJsY2xpY2snLCBbJyRldmVudCddKVxyXG4gICAgb25kYmxjbGljayhldmVudDogRXZlbnQpIHtcclxuICAgICAgICBpZiAodGhpcy5yb3cpIHtcclxuICAgICAgICAgICAgdGhpcy5kdC5yb3dEYmxDbGljay5lbWl0KHRoaXMucm93KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgfVxyXG59XHJcblxyXG5AQ29tcG9uZW50KHtcclxuICAgIHNlbGVjdG9yOiAnZGF0YXRhYmxlLWJvZHknLFxyXG4gICAgdGVtcGxhdGU6IGBcclxuICAgICAgICA8dGFibGVcclxuICAgICAgICAgICAgY2xhc3M9XCJ0YWJsZVwiXHJcbiAgICAgICAgICAgIFtjbGFzcy50YWJsZS1zbV09XCJzaXplID09PSAnc21hbGwnXCJcclxuICAgICAgICAgICAgW2NsYXNzLnRhYmxlLWhvdmVyXT1cImR0LmhvdmVyXCJcclxuICAgICAgICAgICAgW2NsYXNzLnRhYmxlLXN0cmlwZWRdPVwic3RyaXBlZFwiXHJcbiAgICAgICAgICAgIFtjbGFzcy50YWJsZS1ib3JkZXJlZF09XCJib3JkZXJlZFwiXHJcbiAgICAgICAgICAgIFtjbGFzcy5mLXRhYmxlLW5vcmVjb3Jkc109XCIhcm93cyB8fCAhcm93cy5sZW5ndGhcIlxyXG4gICAgICAgICAgICBzdHlsZT1cImJvcmRlci1jb2xsYXBzZTogc2VwYXJhdGU7Ym9yZGVyLXNwYWNpbmc6IDA7XCJcclxuICAgICAgICA+XHJcbiAgICAgICAgICAgIDxjb2xncm91cD5cclxuICAgICAgICAgICAgICAgIDxjb2wgY2xhc3M9XCJkdC1jaGVja2JveC1jZWxsXCIgKm5nSWY9XCIhZHQuc2luZ2xlU2VsZWN0XCIgLz5cclxuICAgICAgICAgICAgICAgIDxjb2wgKm5nRm9yPVwibGV0IGNvbCBvZiBjb2x1bW5zXCIgW3N0eWxlLndpZHRoXT1cImNvbC53aWR0aCArICdweCdcIiAvPlxyXG4gICAgICAgICAgICA8L2NvbGdyb3VwPlxyXG5cclxuICAgICAgICAgICAgPHRib2R5IGNsYXNzPVwidWktdGFibGUtdGJvZHkgXCIgKm5nSWY9XCJyb3dzICYmIHJvd3MubGVuZ3RoXCI+XHJcbiAgICAgICAgICAgICAgICA8dHJcclxuICAgICAgICAgICAgICAgICAgICAqbmdGb3I9XCJsZXQgcm93IG9mIHJvd3M7IHRyYWNrQnk6IGR0LnRyYWNrQnlSb3dzOyBsZXQgcm93SW5kZXggPSBpbmRleFwiXHJcbiAgICAgICAgICAgICAgICAgICAgW25nQ2xhc3NdPVwiY3JlYXRlUm93Q2xhc3NOYW1lKHJvdywgcm93SW5kZXgpXCJcclxuICAgICAgICAgICAgICAgICAgICAoY2xpY2spPVwic2VsZWN0ZWRSb3coJGV2ZW50LCByb3dJbmRleCwgcm93KVwiXHJcbiAgICAgICAgICAgICAgICAgICAgW2NsYXNzLnNlbGVjdGVkXT1cImlzU2VsZWN0ZWQocm93LCB0cilcIiAjdHJcclxuICAgICAgICAgICAgICAgICAgICBbZGJsY2xpY2tdPVwicm93XCJcclxuICAgICAgICAgICAgICAgICAgICBbbmdTdHlsZV09XCJyZW5kZXJSb3dTdHlsZShyb3csIHJvd0luZGV4KVwiXHJcbiAgICAgICAgICAgICAgICA+XHJcbiAgICAgICAgICAgICAgICAgICAgPHRkIGNsYXNzPVwiZHQtY2hlY2tib3gtY2VsbCBkYXRhdGFibGUtZml4ZWQtbGVmdFwiICpuZ0lmPVwiIWR0LnNpbmdsZVNlbGVjdFwiIFxyXG4gICAgICAgICAgICAgICAgICAgIFtjZWxsLXN0eWxlcl09XCJ7cm93OiByb3csIGluZGV4OiByb3dJbmRleH1cIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPGR0LWNoZWNrYm94XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbY2hlY2tlZF09XCJpc1NlbGVjdGVkKHJvdywgdHIpXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIChjaGVja2VkQ2hhbmdlKT1cIm9uQ2hlY2tlZCgkZXZlbnQsIHJvd0luZGV4LCByb3cpXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgPjwvZHQtY2hlY2tib3g+XHJcbiAgICAgICAgICAgICAgICAgICAgPC90ZD5cclxuICAgICAgICAgICAgICAgICAgICA8dGRcclxuICAgICAgICAgICAgICAgICAgICAgICAgW25nQ2xhc3NdPVwiZ2V0VGRDbGFzc05hbWUocm93W2NvbC5maWVsZF0sIGNvbClcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAqbmdGb3I9XCJsZXQgY29sIG9mIGNvbHVtbnM7IGxldCBjb2xJbmRleCA9IGluZGV4XCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgW3N0eWxlLnRleHRBbGlnbl09XCJjb2wuYWxpZ24gfHwgJ2xlZnQnXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIChjbGljayk9XCJvbkNlbGxDbGljaygkZXZlbnQsIGNvbCwgcm93KVwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFtjbGFzcy5kYXRhdGFibGUtZml4ZWQtcmlnaHRdPVwiY29sWydmaXhlZCddID09PSAncmlnaHQnXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgW2NlbGwtc3R5bGVyXT1cInt2YWw6dXRpbHMuZ2V0VmFsdWUoY29sLmZpZWxkLCByb3cpLCByb3c6IHJvdywgaW5kZXg6IHJvd0luZGV4LCBjb2w6IGNvbH1cIlxyXG4gICAgICAgICAgICAgICAgICAgID5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPG5nLWNvbnRhaW5lciAqbmdJZj1cIiFjb2wuY2VsbFRlbXBsOyBlbHNlIGNlbGxUZW1wXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiAqbmdJZj1cImNvbC5mb3JtYXR0ZXJcIiBbaW5uZXJIVE1MXT1cImZvcm1hdERhdGEoY29sLmZpZWxkLCByb3csIGNvbC5mb3JtYXR0ZXIpIHwgc2FmZTonaHRtbCdcIiA+PC9zcGFuPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPCEtLSA8c3BhbiAqbmdJZj1cImNvbC5mb3JtYXR0ZXJcIiBbaW5uZXJIVE1MXT1cIiBjb2wuZmllbGQgfCBnZXR2YWx1ZTogcm93IHwgY29sdW1uZm9ybWF0dGVyOiBjb2wgOiByb3cgfCBzYWZlOiAnaHRtbCdcIiA+PC9zcGFuPiAtLT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuICpuZ0lmPVwiIWNvbC5mb3JtYXR0ZXJcIiBbdGl0bGVdPVwidXRpbHMuZ2V0VmFsdWUoY29sLmZpZWxkLCByb3cpXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbdGV4dENvbnRlbnRdPVwidXRpbHMuZ2V0VmFsdWUoY29sLmZpZWxkLCByb3cpXCI+PC9zcGFuPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8L25nLWNvbnRhaW5lcj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPG5nLXRlbXBsYXRlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAjY2VsbFRlbXBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtuZ1RlbXBsYXRlT3V0bGV0XT1cImNvbC5jZWxsVGVtcGxcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgW25nVGVtcGxhdGVPdXRsZXRDb250ZXh0XT1cIntcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkaW1wbGljaXQ6IHJvdyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByb3dJbmRleDogcm93SW5kZXgsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IHJvd1tjb2wuZmllbGRdXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgPjwvbmctdGVtcGxhdGU+XHJcbiAgICAgICAgICAgICAgICAgICAgPC90ZD5cclxuICAgICAgICAgICAgICAgIDwvdHI+XHJcbiAgICAgICAgICAgIDwvdGJvZHk+XHJcblxyXG4gICAgICAgICAgICA8dGJvZHkgY2xhc3M9XCJ1aS10YWJsZS10Ym9keVwiICpuZ0lmPVwiIXJvd3MgfHwgIXJvd3MubGVuZ3RoXCIgI2VtcHR5VGJvZHk+XHJcbiAgICAgICAgICAgICAgICA8dHIgY2xhc3M9XCJmLXRhYmxlLW5vcmVjb3Jkcy1yb3dcIj5cclxuICAgICAgICAgICAgICAgICAgICA8dGQgW2F0dHIuYWxpZ25dPVwiJ2NlbnRlcidcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjbGFzcz1cImZhcnJpcy10cmVldGFibGUtZW1wdHlkYXRhXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgW2F0dHIuY29sc3Bhbl09XCJjb2x1bW5zLmxlbmd0aFwiXHJcbiAgICAgICAgICAgICAgICAgICAgPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8ZGl2XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzcz1cImYtdGFibGUtbm9yZWNvcmRzLWNvbnRlbnRcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgW2lubmVySFRNTF09XCJlbXB0eU1lc3NhZ2UgfCBzYWZlOiAnaHRtbCdcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA+PC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgPC90ZD5cclxuICAgICAgICAgICAgICAgIDwvdHI+XHJcbiAgICAgICAgICAgIDwvdGJvZHk+XHJcbiAgICAgICAgPC90YWJsZT5cclxuICAgIGAsXHJcbiAgICBzdHlsZXM6IFtcclxuICAgICAgICBgXHJcbiAgICAgICAgICAgIC50YWJsZSB0ZDpmb2N1cy13aXRoaW4ge1xyXG4gICAgICAgICAgICAgICAgYm94LXNoYWRvdzogaW5zZXQgMCAwIDAgMnB4IHJnYmEoMCwgMCwgMCwgMC4xMyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLnRhYmxlIHRkIGRpdiB7XHJcbiAgICAgICAgICAgICAgICB3aWR0aDogMTAwJTtcclxuICAgICAgICAgICAgICAgIGhlaWdodDogMTAwJTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAudGFibGUgdGQgaW5wdXQge1xyXG4gICAgICAgICAgICAgICAgd2lkdGg6IDEwMCU7XHJcbiAgICAgICAgICAgICAgICBoZWlnaHQ6IDEwMCU7XHJcbiAgICAgICAgICAgICAgICBmb250LWZhbWlseTogYXV0bztcclxuICAgICAgICAgICAgICAgIGxpbmUtaGVpZ2h0OiAxO1xyXG4gICAgICAgICAgICAgICAgZm9udC1zaXplOiAxM3B4O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC50YWJsZSB0ZCBpbnB1dDpmb2N1cyB7XHJcbiAgICAgICAgICAgICAgICBib3JkZXI6IDA7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaW5wdXRbdHlwZT0nY2hlY2tib3gnXTpmb2N1cyB7XHJcbiAgICAgICAgICAgICAgICBvdXRsaW5lOiBub25lO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAuZi10YWJsZS1ub3JlY29yZHMtcm93OmhvdmVyIHtcclxuICAgICAgICAgICAgICAgIGJhY2tncm91bmQtY29sb3I6IHRyYW5zcGFyZW50IWltcG9ydGFudDtcclxuICAgICAgICAgICAgICAgIGN1cnNvcjogZGVmYXVsdCFpbXBvcnRhbnQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICBgXHJcbiAgICBdXHJcbn0pXHJcbmV4cG9ydCBjbGFzcyBEYXRhVGFibGVCb2R5Q29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0LCBBZnRlclZpZXdJbml0LCBPbkNoYW5nZXMge1xyXG4gICAgQElucHV0KCkgc2l6ZTogc3RyaW5nO1xyXG4gICAgQElucHV0KCkgaG92ZXI6IGJvb2xlYW47XHJcbiAgICBASW5wdXQoKSBib3JkZXJlZDogYm9vbGVhbjtcclxuICAgIEBJbnB1dCgpIHN0cmlwZWQ6IGJvb2xlYW47XHJcbiAgICBASW5wdXQoKSBjb2x1bW5zOiBEYXRhQ29sdW1uW107XHJcbiAgICBASW5wdXQoKSBmaXhlZDogc3RyaW5nO1xyXG4gICAgQElucHV0KCkgcm93czogYW55W10gPSBbXTtcclxuICAgIEBJbnB1dCgpIHJvd0NsYXNzTmFtZTogKHJvdzogYW55LCBpbmRleDogbnVtYmVyKSA9PiBzdHJpbmc7XHJcbiAgICBASW5wdXQoKSBjZWxsQ2xhc3NOYW1lOiAodmFsdWU6IGFueSwgY29sOiBhbnkpID0+IHN0cmluZztcclxuICAgIEBPdXRwdXQoKSByb3dEYmxDbGljayA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcclxuICAgIEBPdXRwdXQoKSBzZWxlY3RSb3c6IEV2ZW50RW1pdHRlcjxhbnk+ID0gbmV3IEV2ZW50RW1pdHRlcjxhbnk+KCk7XHJcbiAgICBAT3V0cHV0KCkgY2VsbEVkaXQ6IEV2ZW50RW1pdHRlcjxhbnk+ID0gbmV3IEV2ZW50RW1pdHRlcjxhbnk+KCk7XHJcbiAgICBAT3V0cHV0KCkgY2VsbENsaWNrOiBFdmVudEVtaXR0ZXI8YW55PiA9IG5ldyBFdmVudEVtaXR0ZXI8YW55PigpO1xyXG5cclxuICAgIEBWaWV3Q2hpbGQoJ2VtcHR5VGJvZHknKSBlbXB0eVRib2R5RWxSZWY6IEVsZW1lbnRSZWY7XHJcblxyXG4gICAgbGFzdFJvd0luZGV4ID0gMDtcclxuICAgIGxhc3RDb2x1bW5JbmRleCA9IDA7XHJcbiAgICBib3hTaGFkb3c6IHN0cmluZztcclxuICAgIF9yb3dzOiBhbnk7XHJcbiAgICBlZGl0ID0ge307XHJcbiAgICBjbGFzc05hbWUgPSB7fTtcclxuICAgIGlzUm93VGVtcGwgPSBmYWxzZTtcclxuICAgIHNlbGVjdGVkUm93SW5kZXggPSAtMTtcclxuICAgIF9zZWxlY3Rpb25zID0ge307XHJcbiAgICBlbXB0eU1lc3NhZ2UgPSAn5pqC5peg5pWw5o2uJztcclxuXHJcbiAgICAvLyDlt7LpgInmi6nnmoTooYwg6buY6K6k5Li656m6XHJcbiAgICBzZXQgc2VsZWN0aW9ucyh2KSB7XHJcbiAgICAgICAgdGhpcy5fc2VsZWN0aW9ucyA9IHYgfHwge307XHJcbiAgICAgICAgdGhpcy5kdC51cGRhdGVDaGVja2JveFN0YXRlKHRoaXMucm93cyk7XHJcbiAgICB9XHJcbiAgICBnZXQgc2VsZWN0aW9ucygpOiBhbnkge1xyXG4gICAgICAgIGlmICghdGhpcy5fc2VsZWN0aW9ucykge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IGtleXMgPSBPYmplY3Qua2V5cyh0aGlzLl9zZWxlY3Rpb25zKTtcclxuICAgICAgICBpZiAoa2V5cy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuZHQuc2luZ2xlU2VsZWN0KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fc2VsZWN0aW9ucztcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBrZXlzLm1hcChrID0+IHRoaXMuX3NlbGVjdGlvbnNba10pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgbG9jYWxlU2VydmljZTogTG9jYWxlU2VydmljZTtcclxuICAgIHByaXZhdGUgbmd6b25lOiBOZ1pvbmU7XHJcbiAgICBjb25zdHJ1Y3RvcihcclxuICAgICAgICBwdWJsaWMgZWw6IEVsZW1lbnRSZWYsXHJcbiAgICAgICAgcHJpdmF0ZSBkYXRhU2VydmljZTogRGF0YVRhYmxlU2VydmljZSxcclxuICAgICAgICBwcml2YXRlIHJlbmRlcjogUmVuZGVyZXIyLFxyXG4gICAgICAgIEBPcHRpb25hbCgpIHB1YmxpYyBkdDogRGF0YVRhYmxlQ29tcG9uZW50LFxyXG4gICAgICAgIHB1YmxpYyBjb2xGb3JtYXRTZXI6IENvbHVtbkZvcm1hdFNlcnZpY2UsXHJcbiAgICAgICAgcHVibGljIHV0aWxzOiBDb21tb25VdGlscyxcclxuICAgICAgICBwcml2YXRlIGluamVjdG9yOiBJbmplY3RvclxyXG4gICAgKSB7XHJcbiAgICAgICAgdGhpcy5sb2NhbGVTZXJ2aWNlID0gdGhpcy5pbmplY3Rvci5nZXQoTG9jYWxlU2VydmljZSk7XHJcbiAgICAgICAgdGhpcy5uZ3pvbmUgPSB0aGlzLmluamVjdG9yLmdldChOZ1pvbmUsIG51bGwpO1xyXG4gICAgfVxyXG5cclxuICAgIG5nT25Jbml0KCkge1xyXG4gICAgICAgIHRoaXMuZGF0YVNlcnZpY2Uuc2VsZWN0ZWRBbGwuc3Vic2NyaWJlKGFsbENoZWNrZWQgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBpZGZpZWxkID0gdGhpcy5pZEZpZWxkKCk7XHJcbiAgICAgICAgICAgIHRoaXMucm93cy5mb3JFYWNoKHJvdyA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAoYWxsQ2hlY2tlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3NlbGVjdGlvbnNbcm93W2lkZmllbGRdXSA9IHJvdztcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHRoaXMuX3NlbGVjdGlvbnNbcm93W2lkZmllbGRdXTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgaWYgKHRoaXMucm93cykge1xyXG4gICAgICAgICAgICB0aGlzLmlzUm93VGVtcGwgPSB0aGlzLnJvd3Muc29tZShyb3cgPT4ge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJvdy5oYXNPd25Qcm9wZXJ0eSgncm93VGVtcGwnKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLmZpeGVkID09PSAnbGVmdCcpIHtcclxuICAgICAgICAgICAgdGhpcy5jb2x1bW5zID0gY29udmVydENvbHVtbnModGhpcy5jb2x1bW5zLCAnbGVmdCcpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy5maXhlZCA9PT0gJ3JpZ2h0Jykge1xyXG4gICAgICAgICAgICB0aGlzLmNvbHVtbnMgPSBjb252ZXJ0Q29sdW1ucyh0aGlzLmNvbHVtbnMsICdyaWdodCcpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5lbXB0eU1lc3NhZ2UgPSB0aGlzLmxvY2FsZVNlcnZpY2UuZ2V0VmFsdWUoJ2RhdGFncmlkLmVtcHR5TWVzc2FnZScpO1xyXG4gICAgfVxyXG4gICAgbmdBZnRlclZpZXdJbml0KCkge1xyXG4gICAgICAgIHRoaXMuX3Jvd3MgPSB0aGlzLmVsLm5hdGl2ZUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCgndHInKTtcclxuICAgICAgICB0aGlzLmNoZWNrQm9keUhlaWdodFdoZW5FbXB0eURhdGEoKTtcclxuICAgIH1cclxuXHJcbiAgICBjaGVja0JvZHlIZWlnaHRXaGVuRW1wdHlEYXRhKCkge1xyXG4gICAgICAgIGlmICh0aGlzLmVtcHR5VGJvZHlFbFJlZiAmJiAhKHRoaXMucm93cyAmJiB0aGlzLnJvd3MubGVuZ3RoKSkge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5lbXB0eVRib2R5RWxSZWYubmF0aXZlRWxlbWVudC5vZmZzZXRIZWlnaHQgPCAxMzApIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZW1wdHlUYm9keUVsUmVmLm5hdGl2ZUVsZW1lbnQuc3R5bGUuaGVpZ2h0ID0gdGhpcy5kdC5wYWdpbmF0aW9uID8gJzE1MHB4JzogJzEyMHB4JztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBuZ09uQ2hhbmdlcyhjaGFuZ2VzOiBTaW1wbGVDaGFuZ2VzKSB7XHJcbiAgICAgICAgaWYgKGNoYW5nZXMucm93cyAmJiAhY2hhbmdlcy5yb3dzLmlzRmlyc3RDaGFuZ2UoKSkge1xyXG4gICAgICAgICAgICBpZiAoIXRoaXMuZHQuc2luZ2xlU2VsZWN0KSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBfcm93cyA9IGNoYW5nZXMucm93cy5jdXJyZW50VmFsdWUgfHwgW107XHJcbiAgICAgICAgICAgICAgICBjb25zdCBjaGVja2VkUm93cyA9IF9yb3dzLm1hcChuID0+IHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5pc1NlbGVjdGVkKG4pID8gbiA6IDA7XHJcbiAgICAgICAgICAgICAgICB9KS5maWx0ZXIobiA9PiBuKTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoIV9yb3dzLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZGF0YVNlcnZpY2UudXBkYXRlQ2hlY2tBbGxTdGF0dXMubmV4dCgwKTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpZGZpZWxkID0gdGhpcy5pZEZpZWxkKCk7XHJcbiAgICAgICAgICAgICAgICBsZXQgY2hlY2tUb3RhbCA9IDA7XHJcbiAgICAgICAgICAgICAgICBfcm93cy5mb3JFYWNoKGVsZW1lbnQgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChjaGVja2VkUm93cy5maW5kKG4gPT4gbltpZGZpZWxkXSA9PT0gZWxlbWVudFtpZGZpZWxkXSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2hlY2tUb3RhbCArPSAxO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoX3Jvd3MubGVuZ3RoICA9PT0gY2hlY2tUb3RhbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZGF0YVNlcnZpY2UudXBkYXRlQ2hlY2tBbGxTdGF0dXMubmV4dCgxKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNoZWNrZWRSb3dzLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRhdGFTZXJ2aWNlLnVwZGF0ZUNoZWNrQWxsU3RhdHVzLm5leHQoMCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kYXRhU2VydmljZS51cGRhdGVDaGVja0FsbFN0YXR1cy5uZXh0KDIpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICog6I635Y+W5a+56LGh5Lit5oyH5a6a5a2X5q6155qE5YC844CCIGZpZWxkOiDlj6/ku6XkuLrluKbmnInlsYLnuqfnu5PmnoTnmoTot6/lvoTvvIzlpoLvvJogdXNlci5maXJzdE5hbWUgfCBuYW1lIOetiVxyXG4gICAgICovXHJcbiAgICBnZXRWYWx1ZShmaWVsZDogc3RyaW5nLCBkYXRhOiBhbnkpIHtcclxuICAgICAgICBpZiAoZmllbGQuaW5kZXhPZignLicpID09PSAtMSkge1xyXG4gICAgICAgICAgICByZXR1cm4gZGF0YVtmaWVsZF07XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIChcclxuICAgICAgICAgICAgICAgIGZpZWxkLnNwbGl0KCcuJykucmVkdWNlKChvYmosIGtleSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBvYmpba2V5XTtcclxuICAgICAgICAgICAgICAgIH0sIGRhdGEpIHx8ICcnXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgc2VsZWN0ZWRSb3coZXZlbnQ6IGFueSwgaW5kZXg6IG51bWJlciwgZGF0YTogYW55KSB7XHJcbiAgICAgICAgaWYgKGV2ZW50KSB7XHJcbiAgICAgICAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBsZXQgaXNTZWxlY3RlZCA9IGZhbHNlO1xyXG4gICAgICAgIGNvbnN0IGlkZmllbGQgPSB0aGlzLmlkRmllbGQoKTtcclxuXHJcblxyXG4gICAgICAgIGlmICh0aGlzLmR0LnNpbmdsZVNlbGVjdCkge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5zZWxlY3RlZFJvd0luZGV4ICE9PSBpbmRleCB8fCAhdGhpcy5fc2VsZWN0aW9ucyB8fCB0aGlzLl9zZWxlY3Rpb25zW2lkZmllbGRdICE9PSBkYXRhW2lkZmllbGRdKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGVkUm93SW5kZXggPSBpbmRleDtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3NlbGVjdGlvbnMgPSBkYXRhO1xyXG4gICAgICAgICAgICAgICAgaXNTZWxlY3RlZCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmRhdGFTZXJ2aWNlLnNlbGVjdGVkUm93Lm5leHQoe1xyXG4gICAgICAgICAgICAgICAgICAgIHJvd0luZGV4OiBpbmRleCxcclxuICAgICAgICAgICAgICAgICAgICByb3dEYXRhOiBkYXRhXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGlmICghdGhpcy5kdC5rZWVwU2VsZWN0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RlZFJvd0luZGV4ID0gLTE7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fc2VsZWN0aW9ucyA9IHVuZGVmaW5lZDtcclxuICAgICAgICAgICAgICAgICAgICBpc1NlbGVjdGVkID0gZmFsc2U7XHJcblxyXG5cclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmRhdGFTZXJ2aWNlLnVuU2VsZWN0ZWRSb3cubmV4dCh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJvd0luZGV4OiBpbmRleCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcm93RGF0YTogZGF0YVxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBpc1NlbGVjdGVkID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmlzU2VsZWN0ZWQoZGF0YSkpIHtcclxuICAgICAgICAgICAgICAgIGRlbGV0ZSB0aGlzLl9zZWxlY3Rpb25zW2RhdGFbaWRmaWVsZF1dO1xyXG5cclxuICAgICAgICAgICAgICAgIGlzU2VsZWN0ZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIHRoaXMuZGF0YVNlcnZpY2UudW5TZWxlY3RlZFJvdy5uZXh0KHtcclxuICAgICAgICAgICAgICAgICAgICByb3dJbmRleDogaW5kZXgsXHJcbiAgICAgICAgICAgICAgICAgICAgcm93RGF0YTogZGF0YVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9zZWxlY3Rpb25zW2RhdGFbdGhpcy5pZEZpZWxkKCldXSA9IGRhdGE7XHJcbiAgICAgICAgICAgICAgICBpc1NlbGVjdGVkID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIHRoaXMuZGF0YVNlcnZpY2Uuc2VsZWN0ZWRSb3cubmV4dCh7XHJcbiAgICAgICAgICAgICAgICAgICAgcm93SW5kZXg6IGluZGV4LFxyXG4gICAgICAgICAgICAgICAgICAgIHJvd0RhdGE6IGRhdGFcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoaXNTZWxlY3RlZCkge1xyXG4gICAgICAgICAgICB0aGlzLmR0LnNlbGVjdGVkUm93LmVtaXQoeyBkYXRhLCBpbmRleCB9KTtcclxuICAgICAgICAgICAgLy8g5YW85a65XHJcbiAgICAgICAgICAgIHRoaXMuZHQuc2VsZWN0Um93cy5lbWl0KHsgZGF0YSwgaW5kZXggfSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5kdC51blNlbGVjdFJvdy5lbWl0KHsgZGF0YSwgaW5kZXggfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIG9uQ2hlY2tlZChldmVudDogYW55LCBpbmRleDogbnVtYmVyLCBkYXRhOiBhbnkpIHtcclxuICAgICAgICBjb25zdCBzdGF0ZSA9IGV2ZW50LmNoZWNrZWQ7XHJcbiAgICAgICAgY29uc3QgaWRmaWVsZCA9IHRoaXMuZHQuaWRGaWVsZDtcclxuICAgICAgICBpZiAoc3RhdGUpIHtcclxuICAgICAgICAgICAgdGhpcy5fc2VsZWN0aW9uc1tkYXRhW2lkZmllbGRdXSA9IGRhdGE7XHJcbiAgICAgICAgICAgIHRoaXMuZGF0YVNlcnZpY2Uuc2VsZWN0ZWRSb3cubmV4dCh7XHJcbiAgICAgICAgICAgICAgICByb3dJbmRleDogaW5kZXgsXHJcbiAgICAgICAgICAgICAgICByb3dEYXRhOiBkYXRhXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB0aGlzLmR0LnNlbGVjdGVkUm93LmVtaXQoeyBkYXRhLCBpbmRleCB9KTtcclxuICAgICAgICAgICAgLy8g5YW85a65XHJcbiAgICAgICAgICAgIHRoaXMuZHQuc2VsZWN0Um93cy5lbWl0KHsgZGF0YSwgaW5kZXggfSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgZGVsZXRlIHRoaXMuX3NlbGVjdGlvbnNbZGF0YVtpZGZpZWxkXV07XHJcbiAgICAgICAgICAgIHRoaXMuZGF0YVNlcnZpY2UudW5TZWxlY3RlZFJvdy5uZXh0KHtcclxuICAgICAgICAgICAgICAgIHJvd0luZGV4OiBpbmRleCxcclxuICAgICAgICAgICAgICAgIHJvd0RhdGE6IGRhdGFcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHRoaXMuZHQudW5TZWxlY3RSb3cuZW1pdCh7IGRhdGEsIGluZGV4IH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBldmVudC5vcmlnaW5hbEV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgaWRGaWVsZCgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5kdC5pZEZpZWxkO1xyXG4gICAgfVxyXG5cclxuICAgIGlzU2VsZWN0ZWQocm93OiBhbnksIHRyPzogYW55KSB7XHJcbiAgICAgICAgY29uc3QgaWRmaWVsZCA9IHRoaXMuaWRGaWVsZCgpO1xyXG4gICAgICAgIFxyXG5cclxuXHJcbiAgICAgICAgaWYgKHRoaXMuX3NlbGVjdGlvbnMpIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuZHQuc2luZ2xlU2VsZWN0KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fc2VsZWN0aW9uc1tpZGZpZWxkXSA9PT0gcm93W2lkZmllbGRdO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3NlbGVjdGlvbnNbcm93W2lkZmllbGRdXSAhPT0gdW5kZWZpbmVkO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcblxyXG4gICAgZm9ybWF0RGF0YShmaWVsZDogYW55LCBkYXRhOiBhbnksIGZvcm1hdHRlcjogYW55KSB7XHJcbiAgICAgICAgY29uc3QgdmFsdWUgPSB0aGlzLnV0aWxzLmdldFZhbHVlKGZpZWxkLCBkYXRhLCB0cnVlKTtcclxuICAgICAgICByZXR1cm4gdGhpcy5jb2xGb3JtYXRTZXIuZm9ybWF0KHZhbHVlLCBkYXRhLCBmb3JtYXR0ZXIpO1xyXG4gICAgfVxyXG4gICAgLy8g5re75Yqg6Ieq5a6a5LmJ6K6+572u5YiXIOWNleWFg+agvOexu+agt+W8j1xyXG4gICAgZ2V0VGRDbGFzc05hbWUodmFsdWUsIGNvbCkge1xyXG4gICAgICAgIGNvbnN0IHRlbXBDbGFzc05hbWUgPSB7fTtcclxuICAgICAgICAvLyDliJfnsbvnmoTmoLflvI9cclxuICAgICAgICBpZiAoXHJcbiAgICAgICAgICAgIGNvbC5jbGFzc05hbWUgJiZcclxuICAgICAgICAgICAgT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKGNvbC5jbGFzc05hbWUpID09PSAnW29iamVjdCBTdHJpbmddJ1xyXG4gICAgICAgICkge1xyXG4gICAgICAgICAgICB0ZW1wQ2xhc3NOYW1lW2NvbC5jbGFzc05hbWVdID0gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMuY2VsbENsYXNzTmFtZSAmJiB0aGlzLmNlbGxDbGFzc05hbWUodmFsdWUsIGNvbCkpIHtcclxuICAgICAgICAgICAgdGVtcENsYXNzTmFtZVt0aGlzLmNlbGxDbGFzc05hbWUodmFsdWUsIGNvbCldID0gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRlbXBDbGFzc05hbWU7XHJcbiAgICB9XHJcbiAgICBjcmVhdGVSb3dDbGFzc05hbWUocm93LCBpbmRleCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnJvd0NsYXNzTmFtZSA/IHRoaXMucm93Q2xhc3NOYW1lKHJvdywgaW5kZXgpIDogJyc7XHJcbiAgICB9XHJcbiAgICBvbkNlbGxDbGljayhldmVudDogRXZlbnQsIGNvbDogYW55LCByb3c6IGFueSkge1xyXG4gICAgICAgIHRoaXMuY2VsbENsaWNrLmVtaXQoe2V2ZW50LCBjb2wsIHJvd30pO1xyXG4gICAgfVxyXG5cclxuICAgIHJlbmRlclJvd1N0eWxlKHJvdywgaW5kZXgpIHtcclxuICAgICAgICBpZiAodGhpcy5kdC5yb3dTdHlsZXIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZHQucm93U3R5bGVyKHsgZGF0YTogcm93LCBpbmRleCB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuICcnO1xyXG4gICAgfVxyXG5cclxuICAgIHJlbmRlckNlbGxTdHlsZSh2YWwsIHJvdywgaW5kZXgsIGNvbCkge1xyXG4gICAgICAgIGlmICh0aGlzLmR0LmNlbGxTdHlsZXIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZHQuY2VsbFN0eWxlcih7IHZhbHVlOiB2YWwsIGRhdGE6IHJvdywgaW5kZXgsIGNvbCwgZmllbGQ6IGNvbC5maWVsZCB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuICcnO1xyXG4gICAgfVxyXG59XHJcbiJdfQ==