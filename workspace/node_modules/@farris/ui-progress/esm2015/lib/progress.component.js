/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, Input } from '@angular/core';
import { handleLinearGradient, handleCircleGradient } from './progress-utils';
/** @type {?} */
const defaultFormatter = (/**
 * @param {?} p
 * @return {?}
 */
(p) => `${p}%`);
const ɵ0 = defaultFormatter;
/** @type {?} */
let gradientIdSeed = 0;
/** @type {?} */
const statusColorMap = new Map([
    ['normal', '#388fff'],
    ['exception', '#f24645'],
    ['success', '#51bd78']
]);
export class ProgressComponent {
    constructor() {
        //进度条类型
        this.type = 'line';
        //进度条尺寸 'default' | 'small'
        this.size = 'default';
        //是否显示进度条信息
        this.showInfo = true;
        //仪表盘缺口位置
        this.gapPosition = 'top';
        //仪表盘上角度 0-360度
        //进度条短点形状 默认圆角 可选直角square
        this.strokeLinecap = 'round';
        //进度条百分比
        this._percent = 0;
        //存储的状态
        this.cachedStatus = 'normal';
        //计算的状态
        this.inferredStatus = 'normal';
        //圆环路径
        this.progressCirclePath = [];
        //是否渐变
        this.isGradient = false;
        this.gradientId = gradientIdSeed++;
        this.lineGradient = null;
        this.trackByFn = (/**
         * @param {?} index
         * @return {?}
         */
        (index) => `${index}`);
    }
    /**
     * @return {?}
     */
    get percent() {
        return this._percent;
    }
    /**
     * @param {?} percent
     * @return {?}
     */
    set percent(percent) {
        this._percent = percent;
    }
    //获得进度条状态
    /**
     * @return {?}
     */
    get progressStatus() {
        return this.status || this.inferredStatus;
    }
    //进度条信息格式化
    /**
     * @return {?}
     */
    get progressFormatter() {
        return this.format || defaultFormatter;
    }
    //计算进度条宽度 默认8px small为6px
    /**
     * @return {?}
     */
    get strokeW() {
        return this.strokeWidth || (this.type === 'line' && this.size !== 'small' ? 8 : 6);
    }
    //判断是否为环形进度条
    /**
     * @return {?}
     */
    get isCircleStyle() {
        return this.type === 'circle' || this.type === 'dashboard';
    }
    /**
     * @return {?}
     */
    ngOnInit() {
        //圆环宽度判断
        if (this.type === 'circle' || this.type === 'dashboard') {
            this.width = this.width || (this.size !== 'small' ? 80 : 50);
        }
        this.setStrokeColor();
        this.getCirclePaths();
    }
    /**
     * @param {?} changes
     * @return {?}
     */
    ngOnChanges(changes) {
        const { gapPosition, strokeLinecap, strokeColor, gapDegree, type, status, percent, successPercent } = changes;
        //状态变化
        if (status) {
            this.cachedStatus = this.status || this.cachedStatus;
        }
        //进度 已完成的分段百分比 变化
        if (percent || successPercent) {
            /** @type {?} */
            const fillAll = parseInt(this.percent.toString(), 10) >= 100;
            if (fillAll) {
                if ((this.isNotNil(this.successPercent) && (/** @type {?} */ (this.successPercent)) >= 100) || this.successPercent === undefined) {
                    this.inferredStatus = 'success';
                    // this.status = this.inferredStatus;
                }
            }
            else {
                this.inferredStatus = this.cachedStatus;
            }
            this.status = this.inferredStatus;
        }
        //边线颜色变化
        if (strokeColor) {
            this.setStrokeColor();
        }
        //圆环一些属性变化
        if (gapPosition || strokeLinecap || gapDegree || type || percent || strokeColor) {
            this.getCirclePaths();
        }
    }
    /**
     * @private
     * @return {?}
     */
    getCirclePaths() {
        if (!this.isCircleStyle) {
            return;
        }
        /** @type {?} */
        const values = this.isNotNil(this.successPercent) ? [(/** @type {?} */ (this.successPercent)), this.percent] : [this.percent];
        /** @type {?} */
        const radius = 50 - this.strokeW / 2;
        /** @type {?} */
        const gapPosition = this.gapPosition || (this.type === 'circle' ? 'top' : 'bottom');
        /** @type {?} */
        const len = Math.PI * 2 * radius;
        /** @type {?} */
        const gapDegree = this.gapDegree || (this.type === 'circle' ? 0 : 75);
        /** @type {?} */
        let beginPositionX = 0;
        /** @type {?} */
        let beginPositionY = -radius;
        /** @type {?} */
        let endPositionX = 0;
        /** @type {?} */
        let endPositionY = radius * -2;
        switch (gapPosition) {
            case 'left':
                beginPositionX = -radius;
                beginPositionY = 0;
                endPositionX = radius * 2;
                endPositionY = 0;
                break;
            case 'right':
                beginPositionX = radius;
                beginPositionY = 0;
                endPositionX = radius * -2;
                endPositionY = 0;
                break;
            case 'bottom':
                beginPositionY = radius;
                endPositionY = radius * 2;
                break;
            default:
        }
        this.pathString = `M 50,50 m ${beginPositionX},${beginPositionY}
       a ${radius},${radius} 0 1 1 ${endPositionX},${-endPositionY}
       a ${radius},${radius} 0 1 1 ${-endPositionX},${endPositionY}`;
        this.trailPathStyle = {
            strokeDasharray: `${len - gapDegree}px ${len}px`,
            strokeDashoffset: `-${gapDegree / 2}px`,
            transition: 'stroke-dashoffset .3s ease 0s, stroke-dasharray .3s ease 0s, stroke .3s'
        };
        // Calculate styles for each path.
        this.progressCirclePath = values
            .map((/**
         * @param {?} value
         * @param {?} index
         * @return {?}
         */
        (value, index) => {
            /** @type {?} */
            const isSuccessPercent = values.length === 2 && index === 0;
            return {
                stroke: this.isGradient && !isSuccessPercent ? `url(#gradient-${this.gradientId})` : null,
                strokePathStyle: {
                    stroke: !this.isGradient ? (isSuccessPercent ? statusColorMap.get('success') : ((/** @type {?} */ (this.strokeColor)))) : null,
                    transition: 'stroke-dashoffset .3s ease 0s, stroke-dasharray .3s ease 0s, stroke .3s, stroke-width .06s ease .3s',
                    strokeDasharray: `${((value || 0) / 100) * (len - gapDegree)}px ${len}px`,
                    strokeDashoffset: `-${gapDegree / 2}px`
                }
            };
        }))
            .reverse();
    }
    /**
     * @private
     * @return {?}
     */
    setStrokeColor() {
        /** @type {?} */
        const color = this.strokeColor;
        //判断是否为渐变
        /** @type {?} */
        const isGradient = (this.isGradient = !!color && typeof color !== 'string');
        //线性渐变
        if (isGradient && !this.isCircleStyle) {
            this.lineGradient = handleLinearGradient((/** @type {?} */ (color)));
        }
        //圆环渐变
        else if (isGradient && this.isCircleStyle) {
            this.circleGradient = handleCircleGradient((/** @type {?} */ (this.strokeColor)));
        }
        //不是渐变
        else {
            this.lineGradient = null;
            this.circleGradient = [];
        }
    }
    /**
     * @template T
     * @param {?} value
     * @return {?}
     */
    isNotNil(value) {
        return typeof value !== 'undefined' && value !== null;
    }
}
ProgressComponent.decorators = [
    { type: Component, args: [{
                selector: 'farris-progress',
                template: "<div\r\n[ngClass]=\"'f-progress f-progress-status-' + progressStatus\"\r\n[class.f-progress-line]=\"type == 'line'\"\r\n[class.ant-progress-small]=\"size == 'small'\"\r\n[class.f-progress-show-info]=\"showInfo\"\r\n[class.f-progress-circle]=\"isCircleStyle\"\r\n>\r\n  <div *ngIf=\"type === 'line'\">\r\n      <div class=\"f-progress-outer\">\r\n          <div class=\"f-progress-inner\">\r\n              <div class = \"f-progress-bg\"\r\n              [style.width.%] = \"percent\"\r\n              [style.border-radius]=\"strokeLinecap === 'round' ? '100px' : '0'\"\r\n              [style.background]=\"!isGradient ? strokeColor : null\"\r\n              [style.background-image]=\"isGradient ? lineGradient : null\"\r\n              [style.height.px]=\"strokeW\"\r\n              >\r\n              </div>\r\n              <div\r\n                *ngIf=\"successPercent || successPercent === 0\"\r\n                class=\"f-progress-success-bg\"\r\n                [style.width.%]=\"successPercent\"\r\n                [style.border-radius]=\"strokeLinecap === 'round' ? '100px' : '0'\"\r\n                [style.height.px]=\"strokeW\"\r\n              ></div>\r\n          </div>\r\n      </div>\r\n      <ng-template [ngTemplateOutlet]=\"progressInfoTemplate\"></ng-template>\r\n  </div>\r\n  <div \r\n  class=\"f-progress-inner\"\r\n  [style.width.px]=\"this.width\"\r\n  [style.height.px]=\"this.width\"\r\n  [style.fontSize.px]=\"this.width * 0.15 + 6\"\r\n  [class.f-progress-circle-gradient]=\"isGradient\"\r\n  *ngIf=\"isCircleStyle\">\r\n      <svg class=\"f-progress-circle\" viewBox=\"0 0 100 100\">\r\n        <defs *ngIf=\"isGradient\">\r\n          <linearGradient [id]=\"'gradient-' + gradientId\" x1=\"100%\" y1=\"0%\" x2=\"0%\" y2=\"0%\">\r\n            <stop\r\n              *ngFor=\"let i of circleGradient\"\r\n              [attr.offset]=\"i.offset\"\r\n              [attr.stop-color]=\"i.color\"\r\n            ></stop>\r\n          </linearGradient>\r\n        </defs>\r\n        <path\r\n          class=\"f-progress-circle-trail\"\r\n          stroke=\"#efefef\"\r\n          fill-opacity=\"0\"\r\n          [attr.stroke-width]=\"strokeW\"\r\n          [attr.d]=\"pathString\"\r\n          [ngStyle]=\"trailPathStyle\"\r\n        ></path>\r\n        <path\r\n          *ngFor=\"let p of progressCirclePath; trackBy: trackByFn\"\r\n          class=\"f-progress-circle-path\"\r\n          fill-opacity=\"0\"\r\n          [attr.d]=\"pathString\"\r\n          [attr.stroke-linecap]=\"strokeLinecap\"\r\n          [attr.stroke]=\"p.stroke\"\r\n          [attr.stroke-width]=\"percent ? strokeW : 0\"\r\n          [ngStyle]=\"p.strokePathStyle\"\r\n        ></path>\r\n      </svg>\r\n      <ng-template [ngTemplateOutlet]=\"progressInfoTemplate\"></ng-template>\r\n  </div>\r\n</div>\r\n\r\n\r\n<ng-template #progressInfoTemplate>\r\n  <span class=\"f-progress-text\" *ngIf=\"showInfo\">\r\n    <ng-container *ngIf=\"status === 'error' || (status === 'success' && !format); else formatTemplate\">\r\n        <ng-container\r\n        *ngIf=\"!isCircleStyle\"\r\n      >\r\n        <span [ngClass]=\"'f-progress-text-icon f-icon f-icon-'+ status\"></span>\r\n      </ng-container>\r\n      <ng-container *ngIf=\"isCircleStyle\">\r\n        <ng-container *ngIf=\"status === 'success'\">\r\n          <span class=\"f-progress-text-icon f-icon f-icon-checkmark\"></span>\r\n        </ng-container>\r\n        <ng-container *ngIf=\"status === 'error'\">\r\n          <span class=\"f-progress-text-icon f-icon f-icon-x\"></span>\r\n        </ng-container>\r\n      </ng-container>\r\n    </ng-container>\r\n    <ng-template #formatTemplate>\r\n      {{ progressFormatter(percent) }}\r\n    </ng-template>\r\n  </span>\r\n</ng-template>",
                styles: [".f-progress{display:inline-block;font-size:.875rem;color:rgba(0,0,0,.65)}.f-progress.f-progress-line{position:relative;width:100%}.f-progress.f-progress-line .f-progress-text .f-progress-text-icon{font-size:1.25rem}.f-progress .f-progress-outer{display:inline-block;width:100%}.f-progress .f-progress-inner{position:relative;display:inline-block;width:100%;overflow:hidden;vertical-align:middle;background-color:#efefef;border-radius:100px}.f-progress .f-progress-bg,.f-progress .f-progress-success-bg{position:relative;border-radius:100px;-webkit-transition:.4s cubic-bezier(.08,.82,.17,1);transition:.4s cubic-bezier(.08,.82,.17,1)}.f-progress .f-progress-success-bg{position:absolute;top:0;left:0}.f-progress .f-progress-text{display:inline-block;width:1.75rem;margin-left:.5rem;color:rgba(0,0,0,.65);font-size:1em;line-height:1;white-space:nowrap;text-align:left;vertical-align:middle;word-break:normal}.f-progress-status-active .f-progress-bg::before{position:absolute;top:0;right:0;bottom:0;left:0;background:#fff;border-radius:.625rem;opacity:0;-webkit-animation:2.4s ease-in-out infinite f-progress-active;animation:2.4s ease-in-out infinite f-progress-active;content:''}.f-progress-show-info .f-progress-outer{padding-right:48px;margin-right:-48px}.f-progress.f-progress-circle .f-progress-inner{position:relative;line-height:1;background-color:transparent}.f-progress.f-progress-circle .f-progress-text{position:absolute;top:50%;left:50%;width:100%;margin:0;padding:0;color:rgba(0,0,0,.65);line-height:1;white-space:normal;text-align:center;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%)}.f-progress.f-progress-circle .f-progress-text .f-progress-text-icon{font-size:1.3em}@-webkit-keyframes f-progress-active{0%{width:0;opacity:.1}20%{width:0;opacity:.5}100%{width:100%;opacity:0}}@keyframes f-progress-active{0%{width:0;opacity:.1}20%{width:0;opacity:.5}100%{width:100%;opacity:0}}"]
            }] }
];
/** @nocollapse */
ProgressComponent.ctorParameters = () => [];
ProgressComponent.propDecorators = {
    type: [{ type: Input }],
    strokeWidth: [{ type: Input }],
    size: [{ type: Input }],
    showInfo: [{ type: Input }],
    status: [{ type: Input }],
    format: [{ type: Input }],
    successPercent: [{ type: Input }],
    strokeColor: [{ type: Input }],
    width: [{ type: Input }],
    gapPosition: [{ type: Input }],
    gapDegree: [{ type: Input }],
    strokeLinecap: [{ type: Input }],
    percent: [{ type: Input }]
};
if (false) {
    /** @type {?} */
    ProgressComponent.prototype.type;
    /** @type {?} */
    ProgressComponent.prototype.strokeWidth;
    /** @type {?} */
    ProgressComponent.prototype.size;
    /** @type {?} */
    ProgressComponent.prototype.showInfo;
    /** @type {?} */
    ProgressComponent.prototype.status;
    /** @type {?} */
    ProgressComponent.prototype.format;
    /** @type {?} */
    ProgressComponent.prototype.successPercent;
    /** @type {?} */
    ProgressComponent.prototype.strokeColor;
    /** @type {?} */
    ProgressComponent.prototype.width;
    /** @type {?} */
    ProgressComponent.prototype.gapPosition;
    /** @type {?} */
    ProgressComponent.prototype.gapDegree;
    /** @type {?} */
    ProgressComponent.prototype.strokeLinecap;
    /** @type {?} */
    ProgressComponent.prototype._percent;
    /**
     * @type {?}
     * @private
     */
    ProgressComponent.prototype.cachedStatus;
    /**
     * @type {?}
     * @private
     */
    ProgressComponent.prototype.inferredStatus;
    /** @type {?} */
    ProgressComponent.prototype.pathString;
    /** @type {?} */
    ProgressComponent.prototype.trailPathStyle;
    /** @type {?} */
    ProgressComponent.prototype.progressCirclePath;
    /** @type {?} */
    ProgressComponent.prototype.isGradient;
    /** @type {?} */
    ProgressComponent.prototype.gradientId;
    /** @type {?} */
    ProgressComponent.prototype.lineGradient;
    /** @type {?} */
    ProgressComponent.prototype.circleGradient;
    /** @type {?} */
    ProgressComponent.prototype.trackByFn;
}
export { ɵ0 };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicHJvZ3Jlc3MuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGZhcnJpcy91aS1wcm9ncmVzcy8iLCJzb3VyY2VzIjpbImxpYi9wcm9ncmVzcy5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUFBLE9BQU8sRUFBRSxTQUFTLEVBQVUsS0FBSyxFQUE0QixNQUFNLGVBQWUsQ0FBQztBQUVuRixPQUFPLEVBQUUsb0JBQW9CLEVBQUUsb0JBQW9CLEVBQUUsTUFBTSxrQkFBa0IsQ0FBQzs7TUFFeEUsZ0JBQWdCOzs7O0FBQXVCLENBQUMsQ0FBUyxFQUFVLEVBQUUsQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFBOzs7SUFDdkUsY0FBYyxHQUFHLENBQUM7O01BQ2hCLGNBQWMsR0FBRyxJQUFJLEdBQUcsQ0FBQztJQUM3QixDQUFDLFFBQVEsRUFBRSxTQUFTLENBQUM7SUFDckIsQ0FBQyxXQUFXLEVBQUUsU0FBUyxDQUFDO0lBQ3hCLENBQUMsU0FBUyxFQUFFLFNBQVMsQ0FBQztDQUN2QixDQUFDO0FBU0YsTUFBTSxPQUFPLGlCQUFpQjtJQW1FNUI7O1FBakVTLFNBQUksR0FBaUIsTUFBTSxDQUFDOztRQUk1QixTQUFJLEdBQUcsU0FBUyxDQUFDOztRQUVqQixhQUFRLEdBQVcsSUFBSSxDQUFDOztRQVl4QixnQkFBVyxHQUE0QixLQUFLLENBQUM7OztRQUk3QyxrQkFBYSxHQUE4QixPQUFPLENBQUM7O1FBRTVELGFBQVEsR0FBVSxDQUFDLENBQUM7O1FBU1osaUJBQVksR0FBd0IsUUFBUSxDQUFDOztRQUU3QyxtQkFBYyxHQUF3QixRQUFRLENBQUM7O1FBS3ZELHVCQUFrQixHQUF5QixFQUFFLENBQUM7O1FBRTlDLGVBQVUsR0FBRyxLQUFLLENBQUM7UUFDbkIsZUFBVSxHQUFHLGNBQWMsRUFBRSxDQUFDO1FBQzlCLGlCQUFZLEdBQWtCLElBQUksQ0FBQztRQW9CbkMsY0FBUzs7OztRQUFHLENBQUMsS0FBYSxFQUFFLEVBQUUsQ0FB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QVEsRUFBRSxpQkFBaUI7Z0JBQzNCLHdySEFBdUM7O2FBSXhDOzs7OzttQkFHRSxLQUFLOzBCQUVMLEtBQUs7bUJBRUwsS0FBSzt1QkFFTCxLQUFLO3FCQUVMLEtBQUs7cUJBRUwsS0FBSzs2QkFFTCxLQUFLOzBCQUVMLEtBQUs7b0JBRUwsS0FBSzswQkFFTCxLQUFLO3dCQUVMLEtBQUs7NEJBRUwsS0FBSztzQkFHTCxLQUFLOzs7O0lBekJOLGlDQUFxQzs7SUFFckMsd0NBQTRCOztJQUU1QixpQ0FBMEI7O0lBRTFCLHFDQUFpQzs7SUFFakMsbUNBQW9DOztJQUVwQyxtQ0FBcUM7O0lBRXJDLDJDQUFnQzs7SUFFaEMsd0NBQThDOztJQUU5QyxrQ0FBc0I7O0lBRXRCLHdDQUFzRDs7SUFFdEQsc0NBQTBCOztJQUUxQiwwQ0FBNEQ7O0lBRTVELHFDQUFvQjs7Ozs7SUFTcEIseUNBQXFEOzs7OztJQUVyRCwyQ0FBdUQ7O0lBRXZELHVDQUFrQjs7SUFDbEIsMkNBQW9COztJQUVwQiwrQ0FBOEM7O0lBRTlDLHVDQUFtQjs7SUFDbkIsdUNBQThCOztJQUM5Qix5Q0FBbUM7O0lBQ25DLDJDQUF5RDs7SUFtQnpELHNDQUEwQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbXBvbmVudCwgT25Jbml0LCBJbnB1dCwgT25DaGFuZ2VzLCBTaW1wbGVDaGFuZ2VzIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IEZQcm9ncmVzc1R5cGUsIEZQcm9ncmVzc1N0YXR1c1R5cGUsIEZQcm9ncmVzc0Zvcm1hdHRlciwgRlByb2dyZXNzR2FwUG9zaXRpb25UeXBlLCBGUHJvZ3Jlc3NDaXJjbGVQYXRoLCBGUHJvZ3Jlc3NTdHJva2VDb2xvclR5cGUsIEZQcm9ncmVzc0NvbG9yR3JhZGllbnQsIEZQcm9ncmVzc0dyYWRpZW50UHJvZ3Jlc3MsIEZQcm9ncmVzc1N0cm9rZUxpbmVjYXBUeXBlIH0gZnJvbSAnLi9wcm9ncmVzcy1vcHRpb25zJztcclxuaW1wb3J0IHsgaGFuZGxlTGluZWFyR3JhZGllbnQsIGhhbmRsZUNpcmNsZUdyYWRpZW50IH0gZnJvbSAnLi9wcm9ncmVzcy11dGlscyc7XHJcblxyXG5jb25zdCBkZWZhdWx0Rm9ybWF0dGVyOiBGUHJvZ3Jlc3NGb3JtYXR0ZXIgPSAocDogbnVtYmVyKTogc3RyaW5nID0+IGAke3B9JWA7XHJcbmxldCBncmFkaWVudElkU2VlZCA9IDA7XHJcbmNvbnN0IHN0YXR1c0NvbG9yTWFwID0gbmV3IE1hcChbXHJcbiAgWydub3JtYWwnLCAnIzM4OGZmZiddLFxyXG4gIFsnZXhjZXB0aW9uJywgJyNmMjQ2NDUnXSxcclxuICBbJ3N1Y2Nlc3MnLCAnIzUxYmQ3OCddXHJcbl0pO1xyXG5cclxuQENvbXBvbmVudCh7XHJcbiAgc2VsZWN0b3I6ICdmYXJyaXMtcHJvZ3Jlc3MnLFxyXG4gIHRlbXBsYXRlVXJsOicuL3Byb2dyZXNzLmNvbXBvbmVudC5odG1sJyxcclxuICBzdHlsZVVybHM6W1xyXG4gICAgJy4vcHJvZ3Jlc3MuY29tcG9uZW50LnNjc3MnXHJcbiAgXVxyXG59KVxyXG5leHBvcnQgY2xhc3MgUHJvZ3Jlc3NDb21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQsIE9uQ2hhbmdlc3tcclxuICAvL+i/m+W6puadoeexu+Wei1xyXG4gIEBJbnB1dCgpIHR5cGU6RlByb2dyZXNzVHlwZSA9ICdsaW5lJztcclxuICAvL+i/m+W6puadoeWuveW6plxyXG4gIEBJbnB1dCgpIHN0cm9rZVdpZHRoOm51bWJlcjtcclxuICAvL+i/m+W6puadoeWwuuWvuCAnZGVmYXVsdCcgfCAnc21hbGwnXHJcbiAgQElucHV0KCkgc2l6ZSA9ICdkZWZhdWx0JztcclxuICAvL+aYr+WQpuaYvuekuui/m+W6puadoeS/oeaBr1xyXG4gIEBJbnB1dCgpIHNob3dJbmZvOmJvb2xlYW4gPSB0cnVlO1xyXG4gIC8v6L+b5bqm5p2h54q25oCBIOm7mOiupCdub3JtYWwnXHJcbiAgQElucHV0KCkgc3RhdHVzOkZQcm9ncmVzc1N0YXR1c1R5cGU7XHJcbiAgLy/ov5vluqbmnaHkv6Hmga/moLzlvI/ljJZcclxuICBASW5wdXQoKSBmb3JtYXQ/OiBGUHJvZ3Jlc3NGb3JtYXR0ZXI7XHJcbiAgLy/lt7LlrozmiJDnmoTliIbmrrXnmb7liIbmr5RcclxuICBASW5wdXQoKSBzdWNjZXNzUGVyY2VudDogbnVtYmVyO1xyXG4gIC8v6L+b5bqm5p2h6aKc6ImyXHJcbiAgQElucHV0KCkgc3Ryb2tlQ29sb3I6RlByb2dyZXNzU3Ryb2tlQ29sb3JUeXBlO1xyXG4gIC8v5ZyG5b2i6L+b5bqm5p2h5a695bqmXHJcbiAgQElucHV0KCkgd2lkdGg6bnVtYmVyO1xyXG4gIC8v5Luq6KGo55uY57y65Y+j5L2N572uXHJcbiAgQElucHV0KCkgZ2FwUG9zaXRpb246RlByb2dyZXNzR2FwUG9zaXRpb25UeXBlID0gJ3RvcCc7XHJcbiAgLy/ku6rooajnm5jnvLrlj6Pop5LluqYg6buY6K6k5pivNzVcclxuICBASW5wdXQoKSBnYXBEZWdyZWU6bnVtYmVyOy8v5Luq6KGo55uY5LiK6KeS5bqmIDAtMzYw5bqmXHJcbiAgLy/ov5vluqbmnaHnn63ngrnlvaLnirYg6buY6K6k5ZyG6KeSIOWPr+mAieebtOinknNxdWFyZVxyXG4gIEBJbnB1dCgpIHN0cm9rZUxpbmVjYXA6RlByb2dyZXNzU3Ryb2tlTGluZWNhcFR5cGUgPSAncm91bmQnO1xyXG4gIC8v6L+b5bqm5p2h55m+5YiG5q+UXHJcbiAgX3BlcmNlbnQ6bnVtYmVyID0gMDtcclxuICBASW5wdXQoKSBcclxuICBnZXQgcGVyY2VudCgpe1xyXG4gICAgcmV0dXJuIHRoaXMuX3BlcmNlbnQ7XHJcbiAgfVxyXG4gIHNldCBwZXJjZW50KHBlcmNlbnQpe1xyXG4gICAgdGhpcy5fcGVyY2VudCA9IHBlcmNlbnQ7XHJcbiAgfVxyXG4gIC8v5a2Y5YKo55qE54q25oCBXHJcbiAgcHJpdmF0ZSBjYWNoZWRTdGF0dXM6IEZQcm9ncmVzc1N0YXR1c1R5cGUgPSAnbm9ybWFsJztcclxuICAvL+iuoeeul+eahOeKtuaAgVxyXG4gIHByaXZhdGUgaW5mZXJyZWRTdGF0dXM6IEZQcm9ncmVzc1N0YXR1c1R5cGUgPSAnbm9ybWFsJztcclxuXHJcbiAgcGF0aFN0cmluZzpzdHJpbmc7XHJcbiAgdHJhaWxQYXRoU3R5bGU6IGFueTtcclxuICAvL+WchueOr+i3r+W+hFxyXG4gIHByb2dyZXNzQ2lyY2xlUGF0aDpGUHJvZ3Jlc3NDaXJjbGVQYXRoW10gPSBbXTtcclxuICAvL+aYr+WQpua4kOWPmFxyXG4gIGlzR3JhZGllbnQgPSBmYWxzZTtcclxuICBncmFkaWVudElkID0gZ3JhZGllbnRJZFNlZWQrKztcclxuICBsaW5lR3JhZGllbnQ6IHN0cmluZyB8IG51bGwgPSBudWxsO1xyXG4gIGNpcmNsZUdyYWRpZW50OiBBcnJheTx7IG9mZnNldDogc3RyaW5nOyBjb2xvcjogc3RyaW5nIH0+O1xyXG4gIC8v6I635b6X6L+b5bqm5p2h54q25oCBXHJcbiAgZ2V0IHByb2dyZXNzU3RhdHVzKCk6RlByb2dyZXNzU3RhdHVzVHlwZXtcclxuICAgIHJldHVybiB0aGlzLnN0YXR1cyB8fCB0aGlzLmluZmVycmVkU3RhdHVzO1xyXG4gIH1cclxuICAvL+i/m+W6puadoeS/oeaBr+agvOW8j+WMllxyXG4gIGdldCBwcm9ncmVzc0Zvcm1hdHRlcigpOiBGUHJvZ3Jlc3NGb3JtYXR0ZXIge1xyXG4gICAgcmV0dXJuIHRoaXMuZm9ybWF0IHx8IGRlZmF1bHRGb3JtYXR0ZXI7XHJcbiAgfVxyXG5cclxuICAvL+iuoeeul+i/m+W6puadoeWuveW6piDpu5jorqQ4cHggc21hbGzkuLo2cHhcclxuICBnZXQgc3Ryb2tlVygpOiBudW1iZXIge1xyXG4gICAgcmV0dXJuIHRoaXMuc3Ryb2tlV2lkdGggfHwgKHRoaXMudHlwZSA9PT0gJ2xpbmUnICYmIHRoaXMuc2l6ZSAhPT0gJ3NtYWxsJyA/IDggOiA2KTtcclxuICB9XHJcbiAgLy/liKTmlq3mmK/lkKbkuLrnjq/lvaLov5vluqbmnaFcclxuICBnZXQgaXNDaXJjbGVTdHlsZSgpOiBib29sZWFuIHtcclxuICAgIHJldHVybiB0aGlzLnR5cGUgPT09ICdjaXJjbGUnIHx8IHRoaXMudHlwZSA9PT0gJ2Rhc2hib2FyZCc7XHJcbiAgfVxyXG5cclxuICB0cmFja0J5Rm4gPSAoaW5kZXg6IG51bWJlcikgPT4gYCR7aW5kZXh9YDtcclxuICBjb25zdHJ1Y3RvcigpIHsgfVxyXG5cclxuICBuZ09uSW5pdCgpIHtcclxuICAgIC8v5ZyG546v5a695bqm5Yik5patXHJcbiAgICBpZih0aGlzLnR5cGUgPT09ICdjaXJjbGUnIHx8IHRoaXMudHlwZSA9PT0gJ2Rhc2hib2FyZCcpe1xyXG4gICAgICB0aGlzLndpZHRoID0gdGhpcy53aWR0aCB8fCAodGhpcy5zaXplICE9PSAnc21hbGwnID8gODAgOiA1MCk7XHJcbiAgICB9XHJcblxyXG4gICAgdGhpcy5zZXRTdHJva2VDb2xvcigpO1xyXG4gICAgdGhpcy5nZXRDaXJjbGVQYXRocygpO1xyXG4gIH1cclxuXHJcbiAgbmdPbkNoYW5nZXMoY2hhbmdlczogU2ltcGxlQ2hhbmdlcyk6IHZvaWQge1xyXG4gICAgY29uc3QgeyBnYXBQb3NpdGlvbiwgc3Ryb2tlTGluZWNhcCwgc3Ryb2tlQ29sb3IsIGdhcERlZ3JlZSwgdHlwZSwgc3RhdHVzLCBwZXJjZW50LCBzdWNjZXNzUGVyY2VudCB9ID0gY2hhbmdlcztcclxuICAgIC8v54q25oCB5Y+Y5YyWXHJcbiAgICBpZiAoc3RhdHVzKSB7XHJcbiAgICAgIHRoaXMuY2FjaGVkU3RhdHVzID0gdGhpcy5zdGF0dXMgfHwgdGhpcy5jYWNoZWRTdGF0dXM7XHJcbiAgICB9XHJcbiAgICAvL+i/m+W6piDlt7LlrozmiJDnmoTliIbmrrXnmb7liIbmr5Qg5Y+Y5YyWXHJcbiAgICBpZiAocGVyY2VudCB8fCBzdWNjZXNzUGVyY2VudCkge1xyXG4gICAgICBjb25zdCBmaWxsQWxsID0gcGFyc2VJbnQodGhpcy5wZXJjZW50LnRvU3RyaW5nKCksIDEwKSA+PSAxMDA7XHJcbiAgICAgIGlmIChmaWxsQWxsKSB7XHJcbiAgICAgICAgaWYgKCh0aGlzLmlzTm90TmlsKHRoaXMuc3VjY2Vzc1BlcmNlbnQpICYmIHRoaXMuc3VjY2Vzc1BlcmNlbnQhID49IDEwMCkgfHwgdGhpcy5zdWNjZXNzUGVyY2VudCA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICB0aGlzLmluZmVycmVkU3RhdHVzID0gJ3N1Y2Nlc3MnO1xyXG4gICAgICAgICAgLy8gdGhpcy5zdGF0dXMgPSB0aGlzLmluZmVycmVkU3RhdHVzO1xyXG4gICAgICAgIH1cclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICB0aGlzLmluZmVycmVkU3RhdHVzID0gdGhpcy5jYWNoZWRTdGF0dXM7XHJcbiAgICAgIH1cclxuICAgICAgdGhpcy5zdGF0dXMgPSB0aGlzLmluZmVycmVkU3RhdHVzO1xyXG4gICAgfVxyXG4gICAgLy/ovrnnur/popzoibLlj5jljJZcclxuICAgIGlmIChzdHJva2VDb2xvcikge1xyXG4gICAgICB0aGlzLnNldFN0cm9rZUNvbG9yKCk7XHJcbiAgICB9XHJcbiAgICAvL+WchueOr+S4gOS6m+WxnuaAp+WPmOWMllxyXG4gICAgaWYgKGdhcFBvc2l0aW9uIHx8IHN0cm9rZUxpbmVjYXAgfHwgZ2FwRGVncmVlIHx8IHR5cGUgfHwgcGVyY2VudCB8fCBzdHJva2VDb2xvcikge1xyXG4gICAgICB0aGlzLmdldENpcmNsZVBhdGhzKCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGdldENpcmNsZVBhdGhzKCk6IHZvaWQge1xyXG4gICAgaWYgKCF0aGlzLmlzQ2lyY2xlU3R5bGUpIHtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgY29uc3QgdmFsdWVzID0gdGhpcy5pc05vdE5pbCh0aGlzLnN1Y2Nlc3NQZXJjZW50KSA/IFt0aGlzLnN1Y2Nlc3NQZXJjZW50ISwgdGhpcy5wZXJjZW50XSA6IFt0aGlzLnBlcmNlbnRdO1xyXG4gICAgY29uc3QgcmFkaXVzID0gNTAgLSB0aGlzLnN0cm9rZVcgLyAyO1xyXG4gICAgY29uc3QgZ2FwUG9zaXRpb24gPSB0aGlzLmdhcFBvc2l0aW9uIHx8ICh0aGlzLnR5cGUgPT09ICdjaXJjbGUnID8gJ3RvcCcgOiAnYm90dG9tJyk7XHJcbiAgICBjb25zdCBsZW4gPSBNYXRoLlBJICogMiAqIHJhZGl1cztcclxuICAgIGNvbnN0IGdhcERlZ3JlZSA9IHRoaXMuZ2FwRGVncmVlIHx8ICh0aGlzLnR5cGUgPT09ICdjaXJjbGUnID8gMCA6IDc1KTtcclxuXHJcbiAgICBsZXQgYmVnaW5Qb3NpdGlvblggPSAwO1xyXG4gICAgbGV0IGJlZ2luUG9zaXRpb25ZID0gLXJhZGl1cztcclxuICAgIGxldCBlbmRQb3NpdGlvblggPSAwO1xyXG4gICAgbGV0IGVuZFBvc2l0aW9uWSA9IHJhZGl1cyAqIC0yO1xyXG5cclxuICAgIHN3aXRjaCAoZ2FwUG9zaXRpb24pIHtcclxuICAgICAgY2FzZSAnbGVmdCc6XHJcbiAgICAgICAgYmVnaW5Qb3NpdGlvblggPSAtcmFkaXVzO1xyXG4gICAgICAgIGJlZ2luUG9zaXRpb25ZID0gMDtcclxuICAgICAgICBlbmRQb3NpdGlvblggPSByYWRpdXMgKiAyO1xyXG4gICAgICAgIGVuZFBvc2l0aW9uWSA9IDA7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIGNhc2UgJ3JpZ2h0JzpcclxuICAgICAgICBiZWdpblBvc2l0aW9uWCA9IHJhZGl1cztcclxuICAgICAgICBiZWdpblBvc2l0aW9uWSA9IDA7XHJcbiAgICAgICAgZW5kUG9zaXRpb25YID0gcmFkaXVzICogLTI7XHJcbiAgICAgICAgZW5kUG9zaXRpb25ZID0gMDtcclxuICAgICAgICBicmVhaztcclxuICAgICAgY2FzZSAnYm90dG9tJzpcclxuICAgICAgICBiZWdpblBvc2l0aW9uWSA9IHJhZGl1cztcclxuICAgICAgICBlbmRQb3NpdGlvblkgPSByYWRpdXMgKiAyO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICBkZWZhdWx0OlxyXG4gICAgfVxyXG5cclxuICAgIHRoaXMucGF0aFN0cmluZyA9IGBNIDUwLDUwIG0gJHtiZWdpblBvc2l0aW9uWH0sJHtiZWdpblBvc2l0aW9uWX1cclxuICAgICAgIGEgJHtyYWRpdXN9LCR7cmFkaXVzfSAwIDEgMSAke2VuZFBvc2l0aW9uWH0sJHstZW5kUG9zaXRpb25ZfVxyXG4gICAgICAgYSAke3JhZGl1c30sJHtyYWRpdXN9IDAgMSAxICR7LWVuZFBvc2l0aW9uWH0sJHtlbmRQb3NpdGlvbll9YDtcclxuXHJcbiAgICB0aGlzLnRyYWlsUGF0aFN0eWxlID0ge1xyXG4gICAgICBzdHJva2VEYXNoYXJyYXk6IGAke2xlbiAtIGdhcERlZ3JlZX1weCAke2xlbn1weGAsXHJcbiAgICAgIHN0cm9rZURhc2hvZmZzZXQ6IGAtJHtnYXBEZWdyZWUgLyAyfXB4YCxcclxuICAgICAgdHJhbnNpdGlvbjogJ3N0cm9rZS1kYXNob2Zmc2V0IC4zcyBlYXNlIDBzLCBzdHJva2UtZGFzaGFycmF5IC4zcyBlYXNlIDBzLCBzdHJva2UgLjNzJ1xyXG4gICAgfTtcclxuXHJcbiAgICAvLyBDYWxjdWxhdGUgc3R5bGVzIGZvciBlYWNoIHBhdGguXHJcbiAgICB0aGlzLnByb2dyZXNzQ2lyY2xlUGF0aCA9IHZhbHVlc1xyXG4gICAgICAubWFwKCh2YWx1ZSwgaW5kZXgpID0+IHtcclxuICAgICAgICBjb25zdCBpc1N1Y2Nlc3NQZXJjZW50ID0gdmFsdWVzLmxlbmd0aCA9PT0gMiAmJiBpbmRleCA9PT0gMDtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgc3Ryb2tlOiB0aGlzLmlzR3JhZGllbnQgJiYgIWlzU3VjY2Vzc1BlcmNlbnQgPyBgdXJsKCNncmFkaWVudC0ke3RoaXMuZ3JhZGllbnRJZH0pYCA6IG51bGwsXHJcbiAgICAgICAgICBzdHJva2VQYXRoU3R5bGU6IHtcclxuICAgICAgICAgICAgc3Ryb2tlOiAhdGhpcy5pc0dyYWRpZW50ID8gKGlzU3VjY2Vzc1BlcmNlbnQgPyBzdGF0dXNDb2xvck1hcC5nZXQoJ3N1Y2Nlc3MnKSA6ICh0aGlzLnN0cm9rZUNvbG9yIGFzIHN0cmluZykpIDogbnVsbCxcclxuICAgICAgICAgICAgdHJhbnNpdGlvbjogJ3N0cm9rZS1kYXNob2Zmc2V0IC4zcyBlYXNlIDBzLCBzdHJva2UtZGFzaGFycmF5IC4zcyBlYXNlIDBzLCBzdHJva2UgLjNzLCBzdHJva2Utd2lkdGggLjA2cyBlYXNlIC4zcycsXHJcbiAgICAgICAgICAgIHN0cm9rZURhc2hhcnJheTogYCR7KCh2YWx1ZSB8fCAwKSAvIDEwMCkgKiAobGVuIC0gZ2FwRGVncmVlKX1weCAke2xlbn1weGAsXHJcbiAgICAgICAgICAgIHN0cm9rZURhc2hvZmZzZXQ6IGAtJHtnYXBEZWdyZWUgLyAyfXB4YFxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgIH0pXHJcbiAgICAgIC5yZXZlcnNlKCk7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIHNldFN0cm9rZUNvbG9yKCk6IHZvaWQge1xyXG4gICAgY29uc3QgY29sb3IgPSB0aGlzLnN0cm9rZUNvbG9yO1xyXG4gICAgLy/liKTmlq3mmK/lkKbkuLrmuJDlj5hcclxuICAgIGNvbnN0IGlzR3JhZGllbnQgPSAodGhpcy5pc0dyYWRpZW50ID0gISFjb2xvciAmJiB0eXBlb2YgY29sb3IgIT09ICdzdHJpbmcnKTtcclxuICAgIC8v57q/5oCn5riQ5Y+YXHJcbiAgICBpZiAoaXNHcmFkaWVudCAmJiAhdGhpcy5pc0NpcmNsZVN0eWxlKSB7XHJcbiAgICAgIHRoaXMubGluZUdyYWRpZW50ID0gaGFuZGxlTGluZWFyR3JhZGllbnQoY29sb3IgYXMgRlByb2dyZXNzQ29sb3JHcmFkaWVudCk7XHJcbiAgICB9XHJcbiAgICAvL+WchueOr+a4kOWPmFxyXG4gICAgZWxzZSBpZiAoaXNHcmFkaWVudCAmJiB0aGlzLmlzQ2lyY2xlU3R5bGUpIHtcclxuICAgICAgdGhpcy5jaXJjbGVHcmFkaWVudCA9IGhhbmRsZUNpcmNsZUdyYWRpZW50KHRoaXMuc3Ryb2tlQ29sb3IgYXMgRlByb2dyZXNzR3JhZGllbnRQcm9ncmVzcyk7XHJcbiAgICB9XHJcbiAgICAvL+S4jeaYr+a4kOWPmFxyXG4gICAgZWxzZSB7XHJcbiAgICAgIHRoaXMubGluZUdyYWRpZW50ID0gbnVsbDtcclxuICAgICAgdGhpcy5jaXJjbGVHcmFkaWVudCA9IFtdO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgaXNOb3ROaWw8VD4odmFsdWU6IFQpOiB2YWx1ZSBpcyBOb25OdWxsYWJsZTxUPiB7XHJcbiAgICByZXR1cm4gdHlwZW9mIHZhbHVlICE9PSAndW5kZWZpbmVkJyAmJiB2YWx1ZSAhPT0gbnVsbDtcclxuICB9XHJcblxyXG59XHJcbiJdfQ==