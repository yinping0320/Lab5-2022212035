/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
/*
* @Author: 疯狂秀才(Lucas Huang)
* @Date: 2018-12-14 14:40:48
 * @LastEditors: 疯狂秀才(Lucas Huang)
 * @LastEditTime: 2019-09-25 18:10:29
* @Company: Inspur
* @Version: v0.0.1
*/
import { Component, ViewChild, ViewContainerRef, EventEmitter, Output, ComponentFactoryResolver, ChangeDetectorRef } from '@angular/core';
import { of } from 'rxjs';
import { DataTableComponent } from '@farris/ui-datatable';
import { TreeTableComponent } from '@farris/ui-treetable';
import { filter, switchMap } from 'rxjs/operators';
var LookupLeftComponent = /** @class */ (function () {
    function LookupLeftComponent(cfr, cd) {
        this.cfr = cfr;
        this.cd = cd;
        this.navConditions = [];
        this.selected = new EventEmitter();
        this.unselected = new EventEmitter();
        this.search = new EventEmitter();
        this.pageChanged = new EventEmitter();
        this._searchState = null;
        this._sortState = null;
        this.allData = null;
    }
    /**
     * @return {?}
     */
    LookupLeftComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        if (this.lookupCmp && this.isTreeList()) {
            this.lookupCmp.includeSubordinates$$ = this.lookupCmp.includeSubordinates$.subscribe((/**
             * @param {?} val
             * @return {?}
             */
            function (val) {
                if (_this.cmpRef) {
                    /** @type {?} */
                    var tt = (/** @type {?} */ (_this.cmpRef.instance));
                    if (tt.selectedRow) {
                        _this.selected.emit({ data: tt.selectedRow.data, node: tt.selectedRow });
                    }
                }
            }));
        }
    };
    /**
     * @return {?}
     */
    LookupLeftComponent.prototype.ngOnDestroy = /**
     * @return {?}
     */
    function () {
        this._searchState = null;
        this._sortState = null;
    };
    /**
     * @return {?}
     */
    LookupLeftComponent.prototype.updateScrollPosition = /**
     * @return {?}
     */
    function () {
        if (this.isTreeList()) {
            /** @type {?} */
            var tt = (/** @type {?} */ (this.cmpRef.instance));
            if (tt && tt.state.scrollY != tt.psRef.directiveRef.elementRef.nativeElement.scrolltop) {
                tt.psRef.directiveRef.scrollToY(tt.state.scrollY);
            }
        }
    };
    /**
     * @return {?}
     */
    LookupLeftComponent.prototype.createComponent = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var dtFac = null;
        if (!this.isTreeList()) {
            dtFac = this.cfr.resolveComponentFactory(DataTableComponent);
        }
        else {
            this.navOptions['fitColumns'] = false;
            this.navOptions['autoFitColumns'] = true;
            dtFac = this.cfr.resolveComponentFactory(TreeTableComponent);
        }
        this.navOptions['keepSelect'] = false;
        // 左侧查询过滤条，隐藏掉；
        this.navOptions['showFilterBar'] = this.lookupCmp.enableMultiFieldSearch ? false : this.lookupCmp.showFilterBar;
        this.navOptions.width = this.lookupCmp.leftPanelWidth;
        this.cmpRef = this.cmpContainer.createComponent(dtFac);
        if (!this.isTreeList()) {
            this.navOptions.width -= 2;
            this.navOptions['fill'] = true;
            this.cmpRef.instance.maxSize = 5;
            this.cmpRef.instance.fill = true;
            this.cmpRef.instance.autoFitColumns = true;
        }
        else {
            this.navOptions['fit'] = true;
        }
        // this.cmpRef.instance.fit = true;
        if (this.navOptions.pageInfo) {
            if (this.navOptions.pageInfo.pageList) {
                this.navOptions.pageList = this.navOptions.pageInfo.pageList;
            }
            this.navOptions.pagination = this.navOptions.pageInfo.enablePager;
            this.navOptions.pageIndex = this.navOptions.pageInfo.pageIndex;
            this.navOptions.pageSize = this.navOptions.pageInfo.pageSize;
        }
        else {
            this.navOptions.pagination = false;
        }
        Object.assign(this.cmpRef.instance, this.navOptions);
        this.loadData();
        return of(this.cmpRef);
    };
    /**
     * @return {?}
     */
    LookupLeftComponent.prototype.update = /**
     * @return {?}
     */
    function () {
        this.cd.detectChanges();
    };
    /**
     * @param {?=} size
     * @return {?}
     */
    LookupLeftComponent.prototype.resize = /**
     * @param {?=} size
     * @return {?}
     */
    function (size) {
        if (size) {
            var width = size.width, height = size.height;
            /** @type {?} */
            var _width = width - 2;
            this.navOptions.width = _width;
            this.navOptions.height = height;
            /** @type {?} */
            var _height = height - this.lookupCmp.getFilterBarHeight();
            this.cmpRef.instance.resize({ width: _width, height: _height });
        }
    };
    /**
     * @return {?}
     */
    LookupLeftComponent.prototype.isTreeList = /**
     * @return {?}
     */
    function () {
        return this.navOptions.displayType.toLowerCase() === 'treelist' && !this.lookupCmp.navTreeToList;
    };
    /**
     * @private
     * @param {?} items
     * @param {?} dt
     * @return {?}
     */
    LookupLeftComponent.prototype.selectLeftDataTableRow = /**
     * @private
     * @param {?} items
     * @param {?} dt
     * @return {?}
     */
    function (items, dt) {
        var _this = this;
        if (items && items.length) {
            /** @type {?} */
            var item = null;
            if (this.lookupCmp.navSelectedIds) {
                item = items.find((/**
                 * @param {?} n
                 * @return {?}
                 */
                function (n) { return n[dt.idField] == _this.lookupCmp.navSelectedIds; }));
            }
            else {
                if (this.lookupCmp.selectFirstInNav) {
                    item = items[0];
                }
            }
            if (item) {
                dt.dtBody.selectedRowIndex = -1;
                dt.dtBody.selectedRow('', 0, item);
            }
        }
    };
    /**
     * @private
     * @return {?}
     */
    LookupLeftComponent.prototype.closeLoading = /**
     * @private
     * @return {?}
     */
    function () {
        this.lookupCmp.closeLoading();
    };
    /**
     * @private
     * @param {?} dt
     * @return {?}
     */
    LookupLeftComponent.prototype.initDataTable = /**
     * @private
     * @param {?} dt
     * @return {?}
     */
    function (dt) {
        var _this = this;
        dt.loadData({
            pageSize: this.navOptions.pageSize,
            pageIndex: this.navOptions.pageIndex,
            total: this.navOptions.total,
            data: this.navOptions.items,
        });
        var _a = this.navOptions, width = _a.width, height = _a.height;
        // dt.resize({ width: 320, height: this.navOptions.height});
        dt.resize({ width: width, height: height - this.lookupCmp.getFilterBarHeight() });
        // 行选中
        dt.selectedRow.subscribe((/**
         * @param {?} d
         * @return {?}
         */
        function (d) {
            _this.selected.emit({ data: d.data });
        }));
        dt.unSelectRow.subscribe((/**
         * @param {?} d
         * @return {?}
         */
        function (d) {
            _this.selected.emit(null);
        }));
        /** @type {?} */
        var loadTableData = {
            next: (/**
             * @param {?} data
             * @return {?}
             */
            function (data) {
                _this.closeLoading();
                dataTableReLoad(data);
                var _a = _this.navOptions, width = _a.width, height = _a.height;
                _this.cmpRef.instance.resize({ width: width, height: height - _this.lookupCmp.getFilterBarHeight() });
            }),
            error: (/**
             * @param {?} err
             * @return {?}
             */
            function (err) {
                _this.closeLoading();
            })
        };
        // 查询
        dt.search.subscribe((/**
         * @param {?} searchData
         * @return {?}
         */
        function (searchData) {
            /** @type {?} */
            var p = { pageInfo: { pageIndex: 1, pageSize: _this.navOptions.pageSize }, search: '', navConditions: _this.navConditions };
            _this._searchState = searchData;
            _this.search.emit(searchData);
            p.search = searchData;
            p.pageInfo.pageSize = dt.pageSize;
            _this.lookupCmp.navigationFilter = null;
            if (_this._sortState && _this._sortState.sortName) {
                p['sortName'] = _this._sortState.sortName;
                p['sortOrder'] = _this._sortState.sortOrder;
            }
            else {
                delete p['sortName'];
                delete p['sortOrder'];
            }
            _this.lookupCmp.httpMgr.getData(p, 'navsearch').pipe(filter((/**
             * @param {?} n
             * @return {?}
             */
            function (n) { return n; }))).subscribe(loadTableData);
        }));
        /** @type {?} */
        var dataTableReLoad = (/**
         * @param {?} data
         * @return {?}
         */
        function (data) {
            dt.loadData({
                pageSize: data.pageInfo.pageSize,
                pageIndex: data.pageInfo.pageIndex,
                total: data.total,
                data: data.items,
            });
            _this.selectLeftDataTableRow(data.items, dt);
            dt.cd.markForCheck();
        });
        // 分页
        dt.pageChanged.subscribe((/**
         * @param {?} d
         * @return {?}
         */
        function (d) {
            _this.pageChanged.emit(d);
            _this.lookupCmp.navigationFilter = null;
            d.navConditions = _this.navConditions || [];
            _this.lookupCmp.httpMgr.getData(d, 'navsearch').subscribe(loadTableData);
        }));
        dt.pageSizeChanged.subscribe((/**
         * @param {?} e
         * @return {?}
         */
        function (e) {
            _this.lookupCmp.navigationFilter = null;
            e.navConditions = _this.navConditions || [];
            _this.lookupCmp.httpMgr.getData(e, 'navsearch').subscribe(loadTableData);
        }));
        dt.columnSorted.subscribe((/**
         * @param {?} sort
         * @return {?}
         */
        function (sort) {
            var _a = tslib_1.__assign({}, sort), sortName = _a.sortName, sortOrder = _a.sortOrder;
            _this._sortState = sort;
            _this.lookupCmp.navigationFilter = null;
            /** @type {?} */
            var param = {
                sortName: sortName,
                sortOrder: sortOrder,
                search: _this._searchState,
                pageInfo: {
                    pageSize: dt.pageSize,
                    pageIndex: 1
                },
                navConditions: _this.navConditions || []
            };
            _this.lookupCmp.httpMgr.getData(param, 'navsearch').subscribe(loadTableData);
        }));
        dt.clearSearchValue.subscribe((/**
         * @return {?}
         */
        function () {
            _this._searchState = null;
            dt.search.emit(null);
        }));
        this.selectLeftDataTableRow(this.navOptions.items, dt);
    };
    /**
     * @private
     * @param {?} params
     * @return {?}
     */
    LookupLeftComponent.prototype.buildParams = /**
     * @private
     * @param {?} params
     * @return {?}
     */
    function (params) {
        /** @type {?} */
        var p = tslib_1.__assign({}, params, { treeToList: this.lookupCmp.treeToList, navTreeToList: this.lookupCmp.navTreeToList, navConditions: this.navConditions || [] });
        return p;
    };
    /**
     * @private
     * @param {?} tt
     * @return {?}
     */
    LookupLeftComponent.prototype.initTreeTable = /**
     * @private
     * @param {?} tt
     * @return {?}
     */
    function (tt) {
        var _this = this;
        tt.virtualized = true;
        tt.fast = true;
        tt.nodeSelected.subscribe((/**
         * @param {?} d
         * @return {?}
         */
        function (d) {
            _this.selected.emit({ data: d.node.data, node: d.node });
        }));
        tt.nodeUnSelect.subscribe((/**
         * @param {?} d
         * @return {?}
         */
        function (d) {
            _this.selected.emit(null);
        }));
        tt.fixedHeader = true;
        if (this.navOptions.treeInfo.loadDataType === 'all') { // 分层加载不支持取数时配置展开层级
            this.lookupCmp.treeNodeHelper.updateTreeNodeExpanded(this.navOptions.items, this.navOptions.treeInfo);
        }
        tt.loadDataType = this.navOptions.treeInfo.loadDataType;
        // 检查完整树过滤条件 By Lucas 20200302
        this.navOptions.items = this.lookupCmp.checkNodeCanBeSelect(this.navOptions.items, this.navOptions.treeInfo.loadDataType === 'all');
        tt.loadData(this.navOptions.items);
        if (this.lookupCmp.navSelectedIds) {
            tt.selectNode(this.lookupCmp.navSelectedIds);
        }
        else if (this.lookupCmp.selectFirstInNav) {
            tt.selectFirstNode();
        }
        this.allData = this.navOptions.items;
        /** @type {?} */
        var loadTreeData = {
            next: (/**
             * @param {?} resData
             * @return {?}
             */
            function (resData) {
                _this.closeLoading();
                tt.psRef.directiveRef.scrollToTop(0);
                tt.clearAll();
                /** @type {?} */
                var items = _this.lookupCmp.checkNodeCanBeSelect(resData.items, _this.navOptions.treeInfo.loadDataType === 'all' && (!_this._searchState || !_this._searchState.value));
                if (items && items.length && items[0].children && items[0].children.length) {
                    items[0].expanded = true;
                    items[0].children = _this.lookupCmp.expandFirstNode(items[0].children);
                }
                tt.loadData(items);
                tt.resize();
                _this.selected.emit(null);
            }),
            error: (/**
             * @param {?} err
             * @return {?}
             */
            function (err) {
                _this.closeLoading();
            })
        };
        tt.search.subscribe((/**
         * @param {?} search
         * @return {?}
         */
        function (search) {
            _this._searchState = search;
            _this.lookupCmp.navigationFilter = null;
            /** @type {?} */
            var p = _this.buildParams({ search: search });
            if (_this._sortState && _this._sortState.sortName) {
                p['sortName'] = _this._sortState.sortName;
                p['sortOrder'] = _this._sortState.sortOrder;
            }
            _this.lookupCmp.httpMgr.getData(p, 'navsearch').subscribe(loadTreeData);
        }));
        tt.columnSorted.subscribe((/**
         * @param {?} sort
         * @return {?}
         */
        function (sort) {
            _this.lookupCmp.navigationFilter = null;
            if (tt.loadDataType === 'all') {
                tt.clientSort();
            }
            else {
                var _a = tslib_1.__assign({}, sort), sortName_1 = _a.sortName, sortOrder = _a.sortOrder;
                /** @type {?} */
                var sortCol = _this.navOptions.columns.find((/**
                 * @param {?} n
                 * @return {?}
                 */
                function (n) { return n.field === sortName_1; }));
                if (sortCol) {
                    sortName_1 = sortCol['fieldPath'];
                }
                _this._sortState = { sortName: sortName_1, sortOrder: sortOrder };
                // const param = Object.assign({ sortName, sortOrder }, this._searchState);
                /** @type {?} */
                var param = _this.buildParams({ sortName: sortName_1, sortOrder: sortOrder, search: _this._searchState });
                /** @type {?} */
                var requestType = 'nav';
                if ((_this._searchState && _this._searchState.value) || (param && param.navConditions && param.navConditions.length)) {
                    requestType = 'navsearch';
                }
                _this.lookupCmp.httpMgr.getData(param, requestType).subscribe(loadTreeData);
            }
        }));
        tt.clearSearchValue.subscribe((/**
         * @return {?}
         */
        function () {
            _this._searchState = null;
            if (!_this._sortState || !_this._sortState.sortName) {
                tt.loadData(_this.allData);
                if (!tt.selectedRow) {
                    _this.selected.emit(null);
                }
            }
            else {
                /** @type {?} */
                var p = _this.buildParams({});
                _this.lookupCmp.navigationFilter = null;
                if (_this._sortState && _this._sortState.sortName) {
                    p['sortName'] = _this._sortState.sortName;
                    p['sortOrder'] = _this._sortState.sortOrder;
                }
                _this.lookupCmp.httpMgr.getData(p, 'nav').subscribe(loadTreeData);
            }
        }));
        tt.expand.subscribe((/**
         * @param {?} tn
         * @return {?}
         */
        function (tn) {
            _this.onNodeExpanded(tn, tt);
        }));
    };
    /**
     * @private
     * @param {?} tn
     * @param {?} tt
     * @return {?}
     */
    LookupLeftComponent.prototype.onNodeExpanded = /**
     * @private
     * @param {?} tn
     * @param {?} tt
     * @return {?}
     */
    function (tn, tt) {
        var _this = this;
        if (tn.leaf) {
            return;
        }
        if (!tn.children || !tn.children.length) {
            /** @type {?} */
            var treeInfo = this.navOptions.treeInfo;
            if (this.navOptions.treeInfo.loadDataType === 'async') {
                /** @type {?} */
                var parentPath_1 = '';
                /** @type {?} */
                var parentLayer_1 = -1;
                var _a = tslib_1.__assign({}, tt.searchData), _b = _a.field, field = _b === void 0 ? '*' : _b, _c = _a.value, value = _c === void 0 ? '' : _c;
                tn['showLoading'] = true;
                tt.detectChanges();
                if (treeInfo.layerType === 'parentId') {
                    // 父ID加载方式
                    parentPath_1 = tn['id'];
                }
                else {
                    /** @type {?} */
                    var treeInfoField = treeInfo.dataField;
                    if (treeInfoField) {
                        // parentPath = tn.data[treeInfoField][treeInfo.pathField];
                        // parentLayer = tn.data[treeInfoField][treeInfo.layerField];
                        parentPath_1 = this.lookupCmp.getPathCode(tn.data, treeInfo);
                        parentLayer_1 = this.lookupCmp.getLayerData(tn.data, treeInfo);
                    }
                    else {
                        console.log('未找到分级信息。');
                    }
                }
                if (!this.lookupCmp.uri) {
                    this.lookupCmp.expandTreeNode.emit({
                        instance: tt, node: tn,
                        parentIdOrPath: parentPath_1, parentLayer: parentLayer_1, search: { value: value, field: field }
                    });
                    return;
                }
                this.getChildren(parentPath_1, parentLayer_1, { searchField: field === '*' ? '*' : field, searchValue: value }, tt).pipe(switchMap((/**
                 * @param {?} data
                 * @return {?}
                 */
                function (data) {
                    if (data && data.items && data.items.length) {
                        return of(data);
                    }
                    else {
                        return _this.getChildren(parentPath_1, parentLayer_1, { searchField: '*', searchValue: '' }, tt, true);
                    }
                }))).subscribe((/**
                 * @param {?} data
                 * @return {?}
                 */
                function (data) {
                    if (tt) {
                        if (tn && data.items && data.items.length) {
                            tt.appendChildren(data.items, tn);
                        }
                        tn['showLoading'] = false;
                        tt.detectChanges();
                    }
                }));
            }
        }
    };
    /**
     * @private
     * @param {?} parentPath
     * @param {?} parentLayer
     * @param {?} searchData
     * @param {?} tt
     * @param {?=} all
     * @return {?}
     */
    LookupLeftComponent.prototype.getChildren = /**
     * @private
     * @param {?} parentPath
     * @param {?} parentLayer
     * @param {?} searchData
     * @param {?} tt
     * @param {?=} all
     * @return {?}
     */
    function (parentPath, parentLayer, searchData, tt, all) {
        if (all === void 0) { all = false; }
        /** @type {?} */
        var uri = this.lookupCmp.gridOptions.uri;
        /** @type {?} */
        var search = tslib_1.__assign({ parentLayer: parentLayer, category: 'navchildren' }, searchData);
        if (this.navOptions.treeInfo.layerType === 'parentId') {
            search['parentId'] = parentPath;
        }
        else {
            search['parentPath'] = parentPath;
        }
        /** @type {?} */
        var param = this.buildParams({
            searchValue: JSON.stringify(search),
            customData: this.lookupCmp.customData,
            enableFullTree: false,
            loadTreeDataType: 'layerload',
        });
        if (this.lookupCmp.helpId) {
            param['helpId'] = this.lookupCmp.helpId;
        }
        if (tt && tt.sortName) {
            /** @type {?} */
            var sortName = tt.sortName;
            /** @type {?} */
            var sortCol = this.navOptions.columns.find((/**
             * @param {?} n
             * @return {?}
             */
            function (n) { return n.field === tt.sortName; }));
            if (sortCol) {
                sortName = sortCol['fieldPath'];
            }
            search['sortName'] = sortName;
            search['sortOrder'] = tt.sortOrder;
            param.searchValue = JSON.stringify(search);
        }
        if (this.navConditions && this.navConditions.length && !all) {
            param.navSearchConditions = this.navConditions;
        }
        delete param.navConditions;
        return this.lookupCmp.http.getData(uri, param);
    };
    /**
     * @return {?}
     */
    LookupLeftComponent.prototype.loadData = /**
     * @return {?}
     */
    function () {
        this.cmpRef.instance.allColumnsTitle = this.lookupCmp.allColumnsTitle;
        if (!this.isTreeList()) {
            /** @type {?} */
            var dt = (/** @type {?} */ (this.cmpRef.instance));
            this.initDataTable(dt);
        }
        else {
            /** @type {?} */
            var tt = (/** @type {?} */ (this.cmpRef.instance));
            this.initTreeTable(tt);
        }
    };
    /**
     * @param {?} $event
     * @return {?}
     */
    LookupLeftComponent.prototype.onConditionsChange = /**
     * @param {?} $event
     * @return {?}
     */
    function ($event) {
        this.navConditions = $event;
        if (this.isTreeList()) {
            /** @type {?} */
            var tt = (/** @type {?} */ (this.cmpRef.instance));
            tt.search.emit();
        }
        else {
            /** @type {?} */
            var dt = (/** @type {?} */ (this.cmpRef.instance));
            dt.search.emit();
        }
    };
    LookupLeftComponent.decorators = [
        { type: Component, args: [{
                    selector: 'lookup-left',
                    template: "<div style=\"height: 100%;position: relative;width: calc(100% - 2px)\" class=\"d-flex flex-column\">\r\n    <div class=\"lookup-filter-bar\" [viewType]=\"'onlyinput'\"\r\n    lookup-filter-bar *ngIf=\"lookupCmp?.enableMultiFieldSearch && lookupCmp?.showFilterBar\"\r\n    [columns]=\"navOptions?.columns\" [searchFields]=\"navOptions?.searchFields\" [isNav]=\"true\"\r\n    (conditionsChange)=\"onConditionsChange($event)\"></div>\r\n    <div class=\"h-100 w-100 f-utils-fill\" style=\"position: relative;\">\r\n        <ng-container #container></ng-container>\r\n    </div>\r\n</div>"
                }] }
    ];
    /** @nocollapse */
    LookupLeftComponent.ctorParameters = function () { return [
        { type: ComponentFactoryResolver },
        { type: ChangeDetectorRef }
    ]; };
    LookupLeftComponent.propDecorators = {
        cmpContainer: [{ type: ViewChild, args: ['container', { read: ViewContainerRef },] }],
        selected: [{ type: Output }],
        unselected: [{ type: Output }],
        search: [{ type: Output }],
        pageChanged: [{ type: Output }]
    };
    return LookupLeftComponent;
}());
export { LookupLeftComponent };
if (false) {
    /** @type {?} */
    LookupLeftComponent.prototype.cmpRef;
    /** @type {?} */
    LookupLeftComponent.prototype.navOptions;
    /** @type {?} */
    LookupLeftComponent.prototype.lookupCmp;
    /** @type {?} */
    LookupLeftComponent.prototype.navConditions;
    /** @type {?} */
    LookupLeftComponent.prototype.cmpContainer;
    /** @type {?} */
    LookupLeftComponent.prototype.selected;
    /** @type {?} */
    LookupLeftComponent.prototype.unselected;
    /** @type {?} */
    LookupLeftComponent.prototype.search;
    /** @type {?} */
    LookupLeftComponent.prototype.pageChanged;
    /**
     * @type {?}
     * @private
     */
    LookupLeftComponent.prototype._searchState;
    /**
     * @type {?}
     * @private
     */
    LookupLeftComponent.prototype._sortState;
    /**
     * @type {?}
     * @private
     */
    LookupLeftComponent.prototype.allData;
    /**
     * @type {?}
     * @private
     */
    LookupLeftComponent.prototype.cfr;
    /**
     * @type {?}
     * @private
     */
    LookupLeftComponent.prototype.cd;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibG9va3VwLWxlZnQuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGZhcnJpcy91aS1sb29rdXAvIiwic291cmNlcyI6WyJsaWIvbG9va3VwLWxlZnQuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7QUFTQSxPQUFPLEVBQUUsU0FBUyxFQUFVLFNBQVMsRUFBRSxnQkFBZ0IsRUFBRSxZQUFZLEVBQUUsTUFBTSxFQUN6RSx3QkFBd0IsRUFBZ0IsaUJBQWlCLEVBQzVELE1BQU0sZUFBZSxDQUFDO0FBQ3ZCLE9BQU8sRUFBYyxFQUFFLEVBQWdCLE1BQU0sTUFBTSxDQUFDO0FBRXBELE9BQU8sRUFBRSxrQkFBa0IsRUFBRSxNQUFNLHNCQUFzQixDQUFDO0FBQzFELE9BQU8sRUFBWSxrQkFBa0IsRUFBRSxNQUFNLHNCQUFzQixDQUFDO0FBSXBFLE9BQU8sRUFBRSxNQUFNLEVBQUUsU0FBUyxFQUFFLE1BQU0sZ0JBQWdCLENBQUM7QUFHbkQ7SUF1QkksNkJBQW9CLEdBQTZCLEVBQVUsRUFBcUI7UUFBNUQsUUFBRyxHQUFILEdBQUcsQ0FBMEI7UUFBVSxPQUFFLEdBQUYsRUFBRSxDQUFtQjtRQVpoRixrQkFBYSxHQUEyQixFQUFFLENBQUM7UUFJakMsYUFBUSxHQUFHLElBQUksWUFBWSxFQUE0QixDQUFDO1FBQ3hELGVBQVUsR0FBRyxJQUFJLFlBQVksRUFBRSxDQUFDO1FBQ2hDLFdBQU0sR0FBRyxJQUFJLFlBQVksRUFBb0MsQ0FBQztRQUM5RCxnQkFBVyxHQUFHLElBQUksWUFBWSxFQUErRixDQUFDO1FBRWhJLGlCQUFZLEdBQUcsSUFBSSxDQUFDO1FBQ3BCLGVBQVUsR0FBRyxJQUFJLENBQUM7UUFDbEIsWUFBTyxHQUFHLElBQUksQ0FBQztJQUM2RCxDQUFDOzs7O0lBRXJGLHNDQUFROzs7SUFBUjtRQUFBLGlCQVdDO1FBVkcsSUFBSSxJQUFJLENBQUMsU0FBUyxJQUFJLElBQUksQ0FBQyxVQUFVLEVBQUUsRUFB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dUNBQWtFOztJQUNsRSx5Q0FBMEM7O0lBQzFDLHFDQUF3RTs7SUFDeEUsMENBQXdJOzs7OztJQUV4SSwyQ0FBNEI7Ozs7O0lBQzVCLHlDQUEwQjs7Ozs7SUFDMUIsc0NBQXVCOzs7OztJQUNYLGtDQUFxQzs7Ozs7SUFBRSxpQ0FBNkIiLCJzb3VyY2VzQ29udGVudCI6WyIvKlxyXG4qIEBBdXRob3I6IOeWr+eLguengOaJjShMdWNhcyBIdWFuZylcclxuKiBARGF0ZTogMjAxOC0xMi0xNCAxNDo0MDo0OFxyXG4gKiBATGFzdEVkaXRvcnM6IOeWr+eLguengOaJjShMdWNhcyBIdWFuZylcclxuICogQExhc3RFZGl0VGltZTogMjAxOS0wOS0yNSAxODoxMDoyOVxyXG4qIEBDb21wYW55OiBJbnNwdXJcclxuKiBAVmVyc2lvbjogdjAuMC4xXHJcbiovXHJcblxyXG5pbXBvcnQgeyBDb21wb25lbnQsIE9uSW5pdCwgVmlld0NoaWxkLCBWaWV3Q29udGFpbmVyUmVmLCBFdmVudEVtaXR0ZXIsIE91dHB1dCxcclxuICAgIENvbXBvbmVudEZhY3RvcnlSZXNvbHZlciwgQ29tcG9uZW50UmVmLCBDaGFuZ2VEZXRlY3RvclJlZiwgSW5qZWN0b3IsIFJlZmxlY3RpdmVJbmplY3RvciwgT25EZXN0cm95XHJcbn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IE9ic2VydmFibGUsIG9mLCBTdWJzY3JpcHRpb24gfSBmcm9tICdyeGpzJztcclxuXHJcbmltcG9ydCB7IERhdGFUYWJsZUNvbXBvbmVudCB9IGZyb20gJ0BmYXJyaXMvdWktZGF0YXRhYmxlJztcclxuaW1wb3J0IHsgVHJlZU5vZGUsIFRyZWVUYWJsZUNvbXBvbmVudCB9IGZyb20gJ0BmYXJyaXMvdWktdHJlZXRhYmxlJztcclxuXHJcbmltcG9ydCB7IExPQURfREFUQV9UWVBFLCBMb29rdXBHcmlkT3B0aW9ucywgTG9va3VwR3JpZFJlc3VsdCB9IGZyb20gJy4vbG9va3VwLWdyaWQtb3B0aW9ucyc7XHJcbmltcG9ydCB7IExvb2t1cEdyaWRDb21wb25lbnQgfSBmcm9tICcuL2xvb2t1cC1ncmlkLmNvbXBvbmVudCc7XHJcbmltcG9ydCB7IGZpbHRlciwgc3dpdGNoTWFwIH0gZnJvbSAncnhqcy9vcGVyYXRvcnMnO1xyXG5pbXBvcnQgeyBGaWx0ZXJDb25kaXRpb24gfSBmcm9tICdAZmFycmlzL3VpLWNvbW1vbi90eXBlcyc7XHJcblxyXG5AQ29tcG9uZW50KHtcclxuICAgIHNlbGVjdG9yOiAnbG9va3VwLWxlZnQnLFxyXG4gICAgdGVtcGxhdGVVcmw6ICcuL2xvb2t1cC1sZWZ0LmNvbXBvbmVudC5odG1sJ1xyXG59KVxyXG5cclxuZXhwb3J0IGNsYXNzIExvb2t1cExlZnRDb21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQsIE9uRGVzdHJveSB7XHJcblxyXG4gICAgY21wUmVmOiBDb21wb25lbnRSZWY8YW55PjtcclxuICAgIG5hdk9wdGlvbnM6IExvb2t1cEdyaWRPcHRpb25zO1xyXG4gICAgbG9va3VwQ21wOiBMb29rdXBHcmlkQ29tcG9uZW50O1xyXG5cclxuICAgIG5hdkNvbmRpdGlvbnM6IEFycmF5PEZpbHRlckNvbmRpdGlvbj4gPSBbXTtcclxuXHJcblxyXG4gICAgQFZpZXdDaGlsZCgnY29udGFpbmVyJywge3JlYWQ6IFZpZXdDb250YWluZXJSZWZ9KSBjbXBDb250YWluZXI6IFZpZXdDb250YWluZXJSZWY7XHJcbiAgICBAT3V0cHV0KCkgc2VsZWN0ZWQgPSBuZXcgRXZlbnRFbWl0dGVyPHsgZGF0YTogYW55LCBub2RlPzogYW55fT4oKTtcclxuICAgIEBPdXRwdXQoKSB1bnNlbGVjdGVkID0gbmV3IEV2ZW50RW1pdHRlcigpO1xyXG4gICAgQE91dHB1dCgpIHNlYXJjaCA9IG5ldyBFdmVudEVtaXR0ZXI8eyBmaWVsZDogc3RyaW5nLCB2YWx1ZTogc3RyaW5nIH0+KCk7XHJcbiAgICBAT3V0cHV0KCkgcGFnZUNoYW5nZWQgPSBuZXcgRXZlbnRFbWl0dGVyPHsgcGFnZUluZm86IHtwYWdlSW5kZXg6IG51bWJlciwgcGFnZVNpemU6IG51bWJlcn0sIHNlYXJjaDoge2ZpZWxkOiBzdHJpbmcsIHZhbHVlOiBzdHJpbmd9IH0+KCk7XHJcblxyXG4gICAgcHJpdmF0ZSBfc2VhcmNoU3RhdGUgPSBudWxsO1xyXG4gICAgcHJpdmF0ZSBfc29ydFN0YXRlID0gbnVsbDtcclxuICAgIHByaXZhdGUgYWxsRGF0YSA9IG51bGw7XHJcbiAgICBjb25zdHJ1Y3Rvcihwcml2YXRlIGNmcjogQ29tcG9uZW50RmFjdG9yeVJlc29sdmVyLCBwcml2YXRlIGNkOiBDaGFuZ2VEZXRlY3RvclJlZikgeyB9XHJcblxyXG4gICAgbmdPbkluaXQoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMubG9va3VwQ21wICYmIHRoaXMuaXNUcmVlTGlzdCgpKSB7XHJcbiAgICAgICAgICAgIHRoaXMubG9va3VwQ21wLmluY2x1ZGVTdWJvcmRpbmF0ZXMkJCA9IHRoaXMubG9va3VwQ21wLmluY2x1ZGVTdWJvcmRpbmF0ZXMkLnN1YnNjcmliZSgodmFsOiBib29sZWFuKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5jbXBSZWYpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCB0dCA9IHRoaXMuY21wUmVmLmluc3RhbmNlIGFzIFRyZWVUYWJsZUNvbXBvbmVudDtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodHQuc2VsZWN0ZWRSb3cpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RlZC5lbWl0KHsgZGF0YTogdHQuc2VsZWN0ZWRSb3cuZGF0YSwgbm9kZTogdHQuc2VsZWN0ZWRSb3cgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgbmdPbkRlc3Ryb3koKTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy5fc2VhcmNoU3RhdGUgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuX3NvcnRTdGF0ZSA9IG51bGw7XHJcbiAgICB9XHJcblxyXG4gICAgdXBkYXRlU2Nyb2xsUG9zaXRpb24oKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuaXNUcmVlTGlzdCgpKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHR0ID0gdGhpcy5jbXBSZWYuaW5zdGFuY2UgYXMgVHJlZVRhYmxlQ29tcG9uZW50O1xyXG4gICAgICAgICAgICBpZiAodHQgJiYgdHQuc3RhdGUuc2Nyb2xsWSAhPSB0dC5wc1JlZi5kaXJlY3RpdmVSZWYuZWxlbWVudFJlZi5uYXRpdmVFbGVtZW50LnNjcm9sbHRvcCkge1xyXG4gICAgICAgICAgICAgICAgdHQucHNSZWYuZGlyZWN0aXZlUmVmLnNjcm9sbFRvWSh0dC5zdGF0ZS5zY3JvbGxZKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBjcmVhdGVDb21wb25lbnQoKTogT2JzZXJ2YWJsZTxhbnk+IHtcclxuICAgICAgICBsZXQgZHRGYWMgPSBudWxsO1xyXG4gICAgICAgIGlmICghdGhpcy5pc1RyZWVMaXN0KCkpIHtcclxuICAgICAgICAgICAgZHRGYWMgPSB0aGlzLmNmci5yZXNvbHZlQ29tcG9uZW50RmFjdG9yeShEYXRhVGFibGVDb21wb25lbnQpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMubmF2T3B0aW9uc1snZml0Q29sdW1ucyddID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHRoaXMubmF2T3B0aW9uc1snYXV0b0ZpdENvbHVtbnMnXSA9IHRydWU7XHJcbiAgICAgICAgICAgIGR0RmFjID0gdGhpcy5jZnIucmVzb2x2ZUNvbXBvbmVudEZhY3RvcnkoVHJlZVRhYmxlQ29tcG9uZW50KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5uYXZPcHRpb25zWydrZWVwU2VsZWN0J10gPSBmYWxzZTtcclxuICAgICAgICAvLyDlt6bkvqfmn6Xor6Lov4fmu6TmnaHvvIzpmpDol4/mjonvvJtcclxuICAgICAgICB0aGlzLm5hdk9wdGlvbnNbJ3Nob3dGaWx0ZXJCYXInXSA9IHRoaXMubG9va3VwQ21wLmVuYWJsZU11bHRpRmllbGRTZWFyY2g/IGZhbHNlOiB0aGlzLmxvb2t1cENtcC5zaG93RmlsdGVyQmFyO1xyXG5cclxuICAgICAgICB0aGlzLm5hdk9wdGlvbnMud2lkdGggPSB0aGlzLmxvb2t1cENtcC5sZWZ0UGFuZWxXaWR0aDtcclxuXHJcbiAgICAgICAgdGhpcy5jbXBSZWYgPSB0aGlzLmNtcENvbnRhaW5lci5jcmVhdGVDb21wb25lbnQoZHRGYWMpO1xyXG5cclxuICAgICAgICBpZiAoIXRoaXMuaXNUcmVlTGlzdCgpKSB7XHJcbiAgICAgICAgICAgIHRoaXMubmF2T3B0aW9ucy53aWR0aCAtPSAyO1xyXG4gICAgICAgICAgICB0aGlzLm5hdk9wdGlvbnNbJ2ZpbGwnXSA9IHRydWU7XHJcbiAgICAgICAgICAgIHRoaXMuY21wUmVmLmluc3RhbmNlLm1heFNpemUgPSA1O1xyXG4gICAgICAgICAgICB0aGlzLmNtcFJlZi5pbnN0YW5jZS5maWxsID0gdHJ1ZTtcclxuICAgICAgICAgICAgdGhpcy5jbXBSZWYuaW5zdGFuY2UuYXV0b0ZpdENvbHVtbnMgPSB0cnVlO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMubmF2T3B0aW9uc1snZml0J10gPSB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyB0aGlzLmNtcFJlZi5pbnN0YW5jZS5maXQgPSB0cnVlO1xyXG5cclxuICAgICAgICBpZiAodGhpcy5uYXZPcHRpb25zLnBhZ2VJbmZvKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLm5hdk9wdGlvbnMucGFnZUluZm8ucGFnZUxpc3QpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMubmF2T3B0aW9ucy5wYWdlTGlzdCA9IHRoaXMubmF2T3B0aW9ucy5wYWdlSW5mby5wYWdlTGlzdDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLm5hdk9wdGlvbnMucGFnaW5hdGlvbiA9IHRoaXMubmF2T3B0aW9ucy5wYWdlSW5mby5lbmFibGVQYWdlcjtcclxuICAgICAgICAgICAgdGhpcy5uYXZPcHRpb25zLnBhZ2VJbmRleCA9IHRoaXMubmF2T3B0aW9ucy5wYWdlSW5mby5wYWdlSW5kZXg7XHJcbiAgICAgICAgICAgIHRoaXMubmF2T3B0aW9ucy5wYWdlU2l6ZSA9IHRoaXMubmF2T3B0aW9ucy5wYWdlSW5mby5wYWdlU2l6ZTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLm5hdk9wdGlvbnMucGFnaW5hdGlvbiA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgT2JqZWN0LmFzc2lnbih0aGlzLmNtcFJlZi5pbnN0YW5jZSwgdGhpcy5uYXZPcHRpb25zKTtcclxuXHJcbiAgICAgICAgdGhpcy5sb2FkRGF0YSgpO1xyXG4gICAgICAgIHJldHVybiBvZih0aGlzLmNtcFJlZik7XHJcbiAgICB9XHJcblxyXG4gICAgdXBkYXRlKCkge1xyXG4gICAgICAgIHRoaXMuY2QuZGV0ZWN0Q2hhbmdlcygpO1xyXG4gICAgfVxyXG5cclxuICAgIHJlc2l6ZShzaXplPzoge3dpZHRoOiBudW1iZXIsIGhlaWdodDogbnVtYmVyfSkge1xyXG4gICAgICAgIGlmIChzaXplKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHsgd2lkdGgsIGhlaWdodCB9ID0gc2l6ZTtcclxuICAgICAgICAgICAgY29uc3QgX3dpZHRoID0gd2lkdGggLSAyO1xyXG4gICAgICAgICAgICB0aGlzLm5hdk9wdGlvbnMud2lkdGggPSBfd2lkdGg7XHJcbiAgICAgICAgICAgIHRoaXMubmF2T3B0aW9ucy5oZWlnaHQgPSBoZWlnaHQ7XHJcblxyXG4gICAgICAgICAgICBjb25zdCBfaGVpZ2h0ID0gaGVpZ2h0IC0gIHRoaXMubG9va3VwQ21wLmdldEZpbHRlckJhckhlaWdodCgpO1xyXG4gICAgICAgICAgICB0aGlzLmNtcFJlZi5pbnN0YW5jZS5yZXNpemUoeyB3aWR0aDogX3dpZHRoLCBoZWlnaHQ6IF9oZWlnaHQgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGlzVHJlZUxpc3QoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMubmF2T3B0aW9ucy5kaXNwbGF5VHlwZS50b0xvd2VyQ2FzZSgpID09PSAndHJlZWxpc3QnICYmICF0aGlzLmxvb2t1cENtcC5uYXZUcmVlVG9MaXN0O1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgc2VsZWN0TGVmdERhdGFUYWJsZVJvdyhpdGVtczogYW55LCBkdDogRGF0YVRhYmxlQ29tcG9uZW50KSB7XHJcbiAgICAgICAgaWYgKGl0ZW1zICYmIGl0ZW1zLmxlbmd0aCkge1xyXG4gICAgICAgICAgICBsZXQgaXRlbSA9IG51bGw7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmxvb2t1cENtcC5uYXZTZWxlY3RlZElkcykge1xyXG4gICAgICAgICAgICAgICAgaXRlbSA9IGl0ZW1zLmZpbmQobiA9PiBuW2R0LmlkRmllbGRdID09IHRoaXMubG9va3VwQ21wLm5hdlNlbGVjdGVkSWRzKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmxvb2t1cENtcC5zZWxlY3RGaXJzdEluTmF2KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaXRlbSA9IGl0ZW1zWzBdO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAoaXRlbSkge1xyXG4gICAgICAgICAgICAgICAgZHQuZHRCb2R5LnNlbGVjdGVkUm93SW5kZXggPSAtMTtcclxuICAgICAgICAgICAgICAgIGR0LmR0Qm9keS5zZWxlY3RlZFJvdygnJywgMCwgaXRlbSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBjbG9zZUxvYWRpbmcoKSB7XHJcbiAgICAgICAgdGhpcy5sb29rdXBDbXAuY2xvc2VMb2FkaW5nKCk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBpbml0RGF0YVRhYmxlKGR0OiBEYXRhVGFibGVDb21wb25lbnQpIHtcclxuICAgICAgICBkdC5sb2FkRGF0YSh7XHJcbiAgICAgICAgICAgIHBhZ2VTaXplOiB0aGlzLm5hdk9wdGlvbnMucGFnZVNpemUsXHJcbiAgICAgICAgICAgIHBhZ2VJbmRleDogdGhpcy5uYXZPcHRpb25zLnBhZ2VJbmRleCxcclxuICAgICAgICAgICAgdG90YWw6IHRoaXMubmF2T3B0aW9ucy50b3RhbCxcclxuICAgICAgICAgICAgZGF0YTogdGhpcy5uYXZPcHRpb25zLml0ZW1zLFxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBjb25zdCB7d2lkdGgsIGhlaWdodH0gPSB0aGlzLm5hdk9wdGlvbnM7XHJcbiAgICAgICAgLy8gZHQucmVzaXplKHsgd2lkdGg6IDMyMCwgaGVpZ2h0OiB0aGlzLm5hdk9wdGlvbnMuaGVpZ2h0fSk7XHJcbiAgICAgICAgZHQucmVzaXplKHsgd2lkdGgsIGhlaWdodDogaGVpZ2h0IC0gIHRoaXMubG9va3VwQ21wLmdldEZpbHRlckJhckhlaWdodCgpIH0pO1xyXG4gICAgICAgIC8vIOihjOmAieS4rVxyXG4gICAgICAgIGR0LnNlbGVjdGVkUm93LnN1YnNjcmliZShkID0+IHtcclxuICAgICAgICAgICAgdGhpcy5zZWxlY3RlZC5lbWl0KHsgZGF0YTogZC5kYXRhIH0pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBkdC51blNlbGVjdFJvdy5zdWJzY3JpYmUoZCA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWQuZW1pdChudWxsKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgY29uc3QgbG9hZFRhYmxlRGF0YSA9IHtcclxuICAgICAgICAgICAgbmV4dDogKGRhdGE6IExvb2t1cEdyaWRSZXN1bHQpID0+IHtcclxuICAgICAgICAgICAgICAgIHRoaXMuY2xvc2VMb2FkaW5nKCk7XHJcbiAgICAgICAgICAgICAgICBkYXRhVGFibGVSZUxvYWQoZGF0YSk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB7d2lkdGgsIGhlaWdodH0gPSB0aGlzLm5hdk9wdGlvbnM7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNtcFJlZi5pbnN0YW5jZS5yZXNpemUoeyB3aWR0aCwgaGVpZ2h0OiBoZWlnaHQgLSAgdGhpcy5sb29rdXBDbXAuZ2V0RmlsdGVyQmFySGVpZ2h0KCkgfSk7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGVycm9yOiAoZXJyKSA9PiB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNsb3NlTG9hZGluZygpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgLy8g5p+l6K+iXHJcbiAgICAgICAgZHQuc2VhcmNoLnN1YnNjcmliZSggc2VhcmNoRGF0YSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHA6IGFueSA9IHsgcGFnZUluZm86IHsgcGFnZUluZGV4OiAxLCBwYWdlU2l6ZTogdGhpcy5uYXZPcHRpb25zLnBhZ2VTaXplIH0sIHNlYXJjaDogJycsbmF2Q29uZGl0aW9uczogdGhpcy5uYXZDb25kaXRpb25zIH07XHJcblxyXG4gICAgICAgICAgICB0aGlzLl9zZWFyY2hTdGF0ZSA9IHNlYXJjaERhdGE7XHJcbiAgICAgICAgICAgIHRoaXMuc2VhcmNoLmVtaXQoc2VhcmNoRGF0YSk7XHJcbiAgICAgICAgICAgIHAuc2VhcmNoID0gc2VhcmNoRGF0YTtcclxuICAgICAgICAgICAgcC5wYWdlSW5mby5wYWdlU2l6ZSA9IGR0LnBhZ2VTaXplO1xyXG4gICAgICAgICAgICB0aGlzLmxvb2t1cENtcC5uYXZpZ2F0aW9uRmlsdGVyID0gbnVsbDtcclxuXHJcbiAgICAgICAgICAgIGlmICh0aGlzLl9zb3J0U3RhdGUgJiYgdGhpcy5fc29ydFN0YXRlLnNvcnROYW1lKSB7XHJcbiAgICAgICAgICAgICAgICBwWydzb3J0TmFtZSddID0gdGhpcy5fc29ydFN0YXRlLnNvcnROYW1lO1xyXG4gICAgICAgICAgICAgICAgcFsnc29ydE9yZGVyJ10gPSB0aGlzLl9zb3J0U3RhdGUuc29ydE9yZGVyO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgZGVsZXRlIHBbJ3NvcnROYW1lJ107XHJcbiAgICAgICAgICAgICAgICBkZWxldGUgcFsnc29ydE9yZGVyJ107XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHRoaXMubG9va3VwQ21wLmh0dHBNZ3IuZ2V0RGF0YShwLCAnbmF2c2VhcmNoJykucGlwZShcclxuICAgICAgICAgICAgICAgIGZpbHRlcihuID0+IG4pXHJcbiAgICAgICAgICAgICkuc3Vic2NyaWJlKGxvYWRUYWJsZURhdGEpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBjb25zdCBkYXRhVGFibGVSZUxvYWQgPSAoZGF0YSkgPT4ge1xyXG4gICAgICAgICAgICBkdC5sb2FkRGF0YSh7XHJcbiAgICAgICAgICAgICAgICBwYWdlU2l6ZTogZGF0YS5wYWdlSW5mby5wYWdlU2l6ZSxcclxuICAgICAgICAgICAgICAgIHBhZ2VJbmRleDogZGF0YS5wYWdlSW5mby5wYWdlSW5kZXgsXHJcbiAgICAgICAgICAgICAgICB0b3RhbDogZGF0YS50b3RhbCxcclxuICAgICAgICAgICAgICAgIGRhdGE6IGRhdGEuaXRlbXMsXHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5zZWxlY3RMZWZ0RGF0YVRhYmxlUm93KGRhdGEuaXRlbXMsIGR0KTtcclxuICAgICAgICAgICAgZHQuY2QubWFya0ZvckNoZWNrKCk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgLy8g5YiG6aG1XHJcbiAgICAgICAgZHQucGFnZUNoYW5nZWQuc3Vic2NyaWJlKGQgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLnBhZ2VDaGFuZ2VkLmVtaXQoZCk7XHJcbiAgICAgICAgICAgIHRoaXMubG9va3VwQ21wLm5hdmlnYXRpb25GaWx0ZXIgPSBudWxsO1xyXG4gICAgICAgICAgICBkLm5hdkNvbmRpdGlvbnMgPSB0aGlzLm5hdkNvbmRpdGlvbnMgfHwgW107XHJcbiAgICAgICAgICAgIHRoaXMubG9va3VwQ21wLmh0dHBNZ3IuZ2V0RGF0YShkLCAnbmF2c2VhcmNoJykuc3Vic2NyaWJlKGxvYWRUYWJsZURhdGEpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBkdC5wYWdlU2l6ZUNoYW5nZWQuc3Vic2NyaWJlKChlKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMubG9va3VwQ21wLm5hdmlnYXRpb25GaWx0ZXIgPSBudWxsO1xyXG4gICAgICAgICAgICBlLm5hdkNvbmRpdGlvbnMgPSB0aGlzLm5hdkNvbmRpdGlvbnMgfHwgW107XHJcbiAgICAgICAgICAgIHRoaXMubG9va3VwQ21wLmh0dHBNZ3IuZ2V0RGF0YShlLCAnbmF2c2VhcmNoJykuc3Vic2NyaWJlKGxvYWRUYWJsZURhdGEpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBkdC5jb2x1bW5Tb3J0ZWQuc3Vic2NyaWJlKCAoc29ydDoge3NvcnROYW1lOiBzdHJpbmcsIHNvcnRPcmRlcjogYW55fSkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCB7IHNvcnROYW1lLCBzb3J0T3JkZXIgfSA9IHsuLi5zb3J0fTtcclxuICAgICAgICAgICAgdGhpcy5fc29ydFN0YXRlID0gc29ydDtcclxuICAgICAgICAgICAgdGhpcy5sb29rdXBDbXAubmF2aWdhdGlvbkZpbHRlciA9IG51bGw7XHJcbiAgICAgICAgICAgIGNvbnN0IHBhcmFtID0geyBcclxuICAgICAgICAgICAgICAgIHNvcnROYW1lLFxyXG4gICAgICAgICAgICAgICAgc29ydE9yZGVyLFxyXG4gICAgICAgICAgICAgICAgc2VhcmNoOiB0aGlzLl9zZWFyY2hTdGF0ZSwgIFxyXG4gICAgICAgICAgICAgICAgcGFnZUluZm86IHtcclxuICAgICAgICAgICAgICAgICAgICBwYWdlU2l6ZTogZHQucGFnZVNpemUsXHJcbiAgICAgICAgICAgICAgICAgICAgcGFnZUluZGV4OiAxXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgbmF2Q29uZGl0aW9uczogdGhpcy5uYXZDb25kaXRpb25zIHx8IFtdXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIHRoaXMubG9va3VwQ21wLmh0dHBNZ3IuZ2V0RGF0YShwYXJhbSwgJ25hdnNlYXJjaCcpLnN1YnNjcmliZShsb2FkVGFibGVEYXRhKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgZHQuY2xlYXJTZWFyY2hWYWx1ZS5zdWJzY3JpYmUoICgpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5fc2VhcmNoU3RhdGUgPSBudWxsO1xyXG4gICAgICAgICAgICBkdC5zZWFyY2guZW1pdChudWxsKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgdGhpcy5zZWxlY3RMZWZ0RGF0YVRhYmxlUm93KHRoaXMubmF2T3B0aW9ucy5pdGVtcywgZHQpO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgYnVpbGRQYXJhbXMocGFyYW1zOiB7fSk6IHtba2V5OiBzdHJpbmddOmFueX0ge1xyXG4gICAgICAgIGNvbnN0IHA6IGFueSA9IHsgXHJcbiAgICAgICAgICAgIC4uLnBhcmFtcywgXHJcbiAgICAgICAgICAgIHRyZWVUb0xpc3Q6IHRoaXMubG9va3VwQ21wLnRyZWVUb0xpc3QsIFxyXG4gICAgICAgICAgICBuYXZUcmVlVG9MaXN0OiB0aGlzLmxvb2t1cENtcC5uYXZUcmVlVG9MaXN0LFxyXG4gICAgICAgICAgICBuYXZDb25kaXRpb25zOiB0aGlzLm5hdkNvbmRpdGlvbnMgfHwgW11cclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICByZXR1cm4gcDtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGluaXRUcmVlVGFibGUodHQ6IFRyZWVUYWJsZUNvbXBvbmVudCkge1xyXG4gICAgICAgIHR0LnZpcnR1YWxpemVkID0gdHJ1ZTtcclxuICAgICAgICB0dC5mYXN0ID0gdHJ1ZTtcclxuICAgICAgICB0dC5ub2RlU2VsZWN0ZWQuc3Vic2NyaWJlKGQgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLnNlbGVjdGVkLmVtaXQoe2RhdGE6IGQubm9kZS5kYXRhLCBub2RlOiBkLm5vZGV9KTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgdHQubm9kZVVuU2VsZWN0LnN1YnNjcmliZShkID0+IHtcclxuICAgICAgICAgICAgdGhpcy5zZWxlY3RlZC5lbWl0KG51bGwpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICB0dC5maXhlZEhlYWRlciA9IHRydWU7XHJcblxyXG4gICAgICAgIGlmICh0aGlzLm5hdk9wdGlvbnMudHJlZUluZm8ubG9hZERhdGFUeXBlID09PSAnYWxsJykgeyAvLyDliIblsYLliqDovb3kuI3mlK/mjIHlj5bmlbDml7bphY3nva7lsZXlvIDlsYLnuqdcclxuICAgICAgICAgICAgdGhpcy5sb29rdXBDbXAudHJlZU5vZGVIZWxwZXIudXBkYXRlVHJlZU5vZGVFeHBhbmRlZCh0aGlzLm5hdk9wdGlvbnMuaXRlbXMsIHRoaXMubmF2T3B0aW9ucy50cmVlSW5mbyk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0dC5sb2FkRGF0YVR5cGUgPSB0aGlzLm5hdk9wdGlvbnMudHJlZUluZm8ubG9hZERhdGFUeXBlO1xyXG4gICAgICAgIC8vIOajgOafpeWujOaVtOagkei/h+a7pOadoeS7tiBCeSBMdWNhcyAyMDIwMDMwMlxyXG4gICAgICAgIHRoaXMubmF2T3B0aW9ucy5pdGVtcyA9IHRoaXMubG9va3VwQ21wLmNoZWNrTm9kZUNhbkJlU2VsZWN0KHRoaXMubmF2T3B0aW9ucy5pdGVtcywgdGhpcy5uYXZPcHRpb25zLnRyZWVJbmZvLmxvYWREYXRhVHlwZSA9PT0gJ2FsbCcpO1xyXG4gICAgICAgIHR0LmxvYWREYXRhKHRoaXMubmF2T3B0aW9ucy5pdGVtcyk7XHJcblxyXG4gICAgICAgIGlmICh0aGlzLmxvb2t1cENtcC5uYXZTZWxlY3RlZElkcykge1xyXG4gICAgICAgICAgICB0dC5zZWxlY3ROb2RlKHRoaXMubG9va3VwQ21wLm5hdlNlbGVjdGVkSWRzKTtcclxuICAgICAgICB9IGVsc2UgaWYgKHRoaXMubG9va3VwQ21wLnNlbGVjdEZpcnN0SW5OYXYpIHtcclxuICAgICAgICAgICAgdHQuc2VsZWN0Rmlyc3ROb2RlKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLmFsbERhdGEgPSB0aGlzLm5hdk9wdGlvbnMuaXRlbXM7XHJcblxyXG4gICAgICAgIGNvbnN0IGxvYWRUcmVlRGF0YSA9IHtcclxuICAgICAgICAgICAgbmV4dDogKHJlc0RhdGE6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jbG9zZUxvYWRpbmcoKTtcclxuICAgICAgICAgICAgICAgIHR0LnBzUmVmLmRpcmVjdGl2ZVJlZi5zY3JvbGxUb1RvcCgwKTtcclxuICAgICAgICAgICAgICAgIHR0LmNsZWFyQWxsKCk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpdGVtcyA9IHRoaXMubG9va3VwQ21wLmNoZWNrTm9kZUNhbkJlU2VsZWN0KHJlc0RhdGEuaXRlbXMsIHRoaXMubmF2T3B0aW9ucy50cmVlSW5mby5sb2FkRGF0YVR5cGUgPT09ICdhbGwnICYmICghdGhpcy5fc2VhcmNoU3RhdGUgfHwgIXRoaXMuX3NlYXJjaFN0YXRlLnZhbHVlKSk7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKGl0ZW1zICYmIGl0ZW1zLmxlbmd0aCAmJiBpdGVtc1swXS5jaGlsZHJlbiAmJiBpdGVtc1swXS5jaGlsZHJlbi5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICBpdGVtc1swXS5leHBhbmRlZCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgaXRlbXNbMF0uY2hpbGRyZW4gPSB0aGlzLmxvb2t1cENtcC5leHBhbmRGaXJzdE5vZGUoaXRlbXNbMF0uY2hpbGRyZW4pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIHR0LmxvYWREYXRhKGl0ZW1zKTtcclxuICAgICAgICAgICAgICAgIHR0LnJlc2l6ZSgpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RlZC5lbWl0KG51bGwpO1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBlcnJvcjogKGVycikgPT4ge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jbG9zZUxvYWRpbmcoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcblxyXG5cclxuICAgICAgICB0dC5zZWFyY2guc3Vic2NyaWJlKHNlYXJjaCA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuX3NlYXJjaFN0YXRlID0gc2VhcmNoO1xyXG4gICAgICAgICAgICB0aGlzLmxvb2t1cENtcC5uYXZpZ2F0aW9uRmlsdGVyID0gbnVsbDtcclxuICAgICAgICAgICAgY29uc3QgcCA9IHRoaXMuYnVpbGRQYXJhbXMoeyBzZWFyY2ggfSk7XHJcbiAgICAgICAgICBcclxuICAgICAgICAgICAgaWYgKHRoaXMuX3NvcnRTdGF0ZSAmJiB0aGlzLl9zb3J0U3RhdGUuc29ydE5hbWUpIHtcclxuICAgICAgICAgICAgICAgIHBbJ3NvcnROYW1lJ10gPSB0aGlzLl9zb3J0U3RhdGUuc29ydE5hbWU7XHJcbiAgICAgICAgICAgICAgICBwWydzb3J0T3JkZXInXSA9IHRoaXMuX3NvcnRTdGF0ZS5zb3J0T3JkZXI7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5sb29rdXBDbXAuaHR0cE1nci5nZXREYXRhKHAsICduYXZzZWFyY2gnKS5zdWJzY3JpYmUobG9hZFRyZWVEYXRhKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgdHQuY29sdW1uU29ydGVkLnN1YnNjcmliZSggKHNvcnQ6IHtzb3J0TmFtZTogc3RyaW5nLCBzb3J0T3JkZXI6IGFueX0pID0+IHtcclxuICAgICAgICAgICAgdGhpcy5sb29rdXBDbXAubmF2aWdhdGlvbkZpbHRlciA9IG51bGw7XHJcbiAgICAgICAgICAgIGlmICh0dC5sb2FkRGF0YVR5cGUgPT09ICdhbGwnKSB7XHJcbiAgICAgICAgICAgICAgICB0dC5jbGllbnRTb3J0KCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgeyBzb3J0TmFtZSwgc29ydE9yZGVyIH0gPSB7Li4uc29ydH07XHJcblxyXG4gICAgICAgICAgICAgICAgY29uc3Qgc29ydENvbDogYW55ID0gdGhpcy5uYXZPcHRpb25zLmNvbHVtbnMuZmluZChuID0+IG4uZmllbGQgPT09IHNvcnROYW1lKTtcclxuICAgICAgICAgICAgICAgIGlmIChzb3J0Q29sKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc29ydE5hbWUgPSBzb3J0Q29sWydmaWVsZFBhdGgnXTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICB0aGlzLl9zb3J0U3RhdGUgPSB7IHNvcnROYW1lLCBzb3J0T3JkZXIgfTtcclxuICAgICAgICAgICAgICAgIC8vIGNvbnN0IHBhcmFtID0gT2JqZWN0LmFzc2lnbih7IHNvcnROYW1lLCBzb3J0T3JkZXIgfSwgdGhpcy5fc2VhcmNoU3RhdGUpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgcGFyYW0gPSB0aGlzLmJ1aWxkUGFyYW1zKHsgc29ydE5hbWUsIHNvcnRPcmRlciwgc2VhcmNoOiB0aGlzLl9zZWFyY2hTdGF0ZSB9KTtcclxuICAgICAgICAgICAgICAgIGxldCByZXF1ZXN0VHlwZTogTE9BRF9EQVRBX1RZUEUgPSAnbmF2JztcclxuICAgICAgICAgICAgICAgIGlmICgodGhpcy5fc2VhcmNoU3RhdGUgJiYgdGhpcy5fc2VhcmNoU3RhdGUudmFsdWUpIHx8IChwYXJhbSAmJiBwYXJhbS5uYXZDb25kaXRpb25zICYmIHBhcmFtLm5hdkNvbmRpdGlvbnMubGVuZ3RoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJlcXVlc3RUeXBlID0gJ25hdnNlYXJjaCc7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG5cclxuICAgICAgICAgICAgICAgIHRoaXMubG9va3VwQ21wLmh0dHBNZ3IuZ2V0RGF0YShwYXJhbSwgcmVxdWVzdFR5cGUpLnN1YnNjcmliZShsb2FkVHJlZURhdGEpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHR0LmNsZWFyU2VhcmNoVmFsdWUuc3Vic2NyaWJlKCAoKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuX3NlYXJjaFN0YXRlID0gbnVsbDtcclxuICAgICAgICAgICAgaWYgKCF0aGlzLl9zb3J0U3RhdGUgfHwgIXRoaXMuX3NvcnRTdGF0ZS5zb3J0TmFtZSkge1xyXG4gICAgICAgICAgICAgICAgdHQubG9hZERhdGEodGhpcy5hbGxEYXRhKTtcclxuICAgICAgICAgICAgICAgIGlmICghdHQuc2VsZWN0ZWRSb3cpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGVkLmVtaXQobnVsbCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBwID0gdGhpcy5idWlsZFBhcmFtcyh7fSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmxvb2t1cENtcC5uYXZpZ2F0aW9uRmlsdGVyID0gbnVsbDtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9zb3J0U3RhdGUgJiYgdGhpcy5fc29ydFN0YXRlLnNvcnROYW1lKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcFsnc29ydE5hbWUnXSA9IHRoaXMuX3NvcnRTdGF0ZS5zb3J0TmFtZTtcclxuICAgICAgICAgICAgICAgICAgICBwWydzb3J0T3JkZXInXSA9IHRoaXMuX3NvcnRTdGF0ZS5zb3J0T3JkZXI7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0aGlzLmxvb2t1cENtcC5odHRwTWdyLmdldERhdGEocCwgJ25hdicpLnN1YnNjcmliZShsb2FkVHJlZURhdGEpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG5cclxuICAgICAgICB0dC5leHBhbmQuc3Vic2NyaWJlKCh0bjogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMub25Ob2RlRXhwYW5kZWQodG4sIHR0KTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcblxyXG4gICAgcHJpdmF0ZSBvbk5vZGVFeHBhbmRlZCh0bjogYW55LCB0dCkge1xyXG4gICAgICAgIGlmICh0bi5sZWFmKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKCF0bi5jaGlsZHJlbiB8fCAhdG4uY2hpbGRyZW4ubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHRyZWVJbmZvID0gdGhpcy5uYXZPcHRpb25zLnRyZWVJbmZvO1xyXG4gICAgICAgICAgICBpZiAodGhpcy5uYXZPcHRpb25zLnRyZWVJbmZvLmxvYWREYXRhVHlwZSA9PT0gJ2FzeW5jJykge1xyXG4gICAgICAgICAgICAgICAgbGV0IHBhcmVudFBhdGggPSAnJztcclxuICAgICAgICAgICAgICAgIGxldCBwYXJlbnRMYXllciA9IC0xO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgeyBmaWVsZCA9ICcqJywgdmFsdWUgPSAnJyB9ID0ge1xyXG4gICAgICAgICAgICAgICAgICAgIC4uLnR0LnNlYXJjaERhdGFcclxuICAgICAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICAgICAgdG5bJ3Nob3dMb2FkaW5nJ10gPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgdHQuZGV0ZWN0Q2hhbmdlcygpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHRyZWVJbmZvLmxheWVyVHlwZSA9PT0gJ3BhcmVudElkJykge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIOeItklE5Yqg6L295pa55byPXHJcbiAgICAgICAgICAgICAgICAgICAgcGFyZW50UGF0aCA9IHRuWydpZCddO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCB0cmVlSW5mb0ZpZWxkID0gdHJlZUluZm8uZGF0YUZpZWxkO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0cmVlSW5mb0ZpZWxkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHBhcmVudFBhdGggPSB0bi5kYXRhW3RyZWVJbmZvRmllbGRdW3RyZWVJbmZvLnBhdGhGaWVsZF07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHBhcmVudExheWVyID0gdG4uZGF0YVt0cmVlSW5mb0ZpZWxkXVt0cmVlSW5mby5sYXllckZpZWxkXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGFyZW50UGF0aCA9IHRoaXMubG9va3VwQ21wLmdldFBhdGhDb2RlKHRuLmRhdGEsIHRyZWVJbmZvKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGFyZW50TGF5ZXI9IHRoaXMubG9va3VwQ21wLmdldExheWVyRGF0YSh0bi5kYXRhLCB0cmVlSW5mbyk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ+acquaJvuWIsOWIhue6p+S/oeaBr+OAgicpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMubG9va3VwQ21wLnVyaSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMubG9va3VwQ21wLmV4cGFuZFRyZWVOb2RlLmVtaXQoe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpbnN0YW5jZTogdHQsIG5vZGU6IHRuLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwYXJlbnRJZE9yUGF0aDogcGFyZW50UGF0aCwgcGFyZW50TGF5ZXIsIHNlYXJjaDogeyB2YWx1ZSwgZmllbGQgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0aGlzLmdldENoaWxkcmVuKFxyXG4gICAgICAgICAgICAgICAgICAgIHBhcmVudFBhdGgsIHBhcmVudExheWVyLCB7c2VhcmNoRmllbGQ6IGZpZWxkID09PSAnKicgPyAnKicgOiBmaWVsZCwgc2VhcmNoVmFsdWU6IHZhbHVlfSwgdHRcclxuICAgICAgICAgICAgICAgICkucGlwZShcclxuICAgICAgICAgICAgICAgICAgICBzd2l0Y2hNYXAoKGRhdGE6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YSAmJiBkYXRhLml0ZW1zICYmIGRhdGEuaXRlbXMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gb2YoZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5nZXRDaGlsZHJlbihwYXJlbnRQYXRoLCBwYXJlbnRMYXllciwgeyBzZWFyY2hGaWVsZDogJyonLCBzZWFyY2hWYWx1ZTogJycgIH0sIHR0LCB0cnVlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICApLnN1YnNjcmliZShkYXRhID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodHQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRuICYmIGRhdGEuaXRlbXMgJiYgZGF0YS5pdGVtcy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR0LmFwcGVuZENoaWxkcmVuKGRhdGEuaXRlbXMsIHRuKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0blsnc2hvd0xvYWRpbmcnXSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0dC5kZXRlY3RDaGFuZ2VzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBnZXRDaGlsZHJlbiggcGFyZW50UGF0aCwgcGFyZW50TGF5ZXIsIHNlYXJjaERhdGE6IHsgc2VhcmNoRmllbGQ6IHN0cmluZzsgc2VhcmNoVmFsdWU6IHN0cmluZyB9LCB0dCwgYWxsID0gZmFsc2UgKTogT2JzZXJ2YWJsZTxhbnk+IHtcclxuICAgICAgICBjb25zdCB1cmkgPSB0aGlzLmxvb2t1cENtcC5ncmlkT3B0aW9ucy51cmk7XHJcbiAgICAgICAgY29uc3Qgc2VhcmNoID0geyBwYXJlbnRMYXllciwgY2F0ZWdvcnk6ICduYXZjaGlsZHJlbicsIC4uLnNlYXJjaERhdGEgfTtcclxuICAgICAgICBpZiAodGhpcy5uYXZPcHRpb25zLnRyZWVJbmZvLmxheWVyVHlwZSA9PT0gJ3BhcmVudElkJykge1xyXG4gICAgICAgICAgICBzZWFyY2hbJ3BhcmVudElkJ10gPSBwYXJlbnRQYXRoO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHNlYXJjaFsncGFyZW50UGF0aCddID0gcGFyZW50UGF0aDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IHBhcmFtOiBhbnkgPSB0aGlzLmJ1aWxkUGFyYW1zKHtcclxuICAgICAgICAgICAgc2VhcmNoVmFsdWU6IEpTT04uc3RyaW5naWZ5KHNlYXJjaCksXHJcbiAgICAgICAgICAgIGN1c3RvbURhdGE6IHRoaXMubG9va3VwQ21wLmN1c3RvbURhdGEsXHJcbiAgICAgICAgICAgIGVuYWJsZUZ1bGxUcmVlOiBmYWxzZSxcclxuICAgICAgICAgICAgbG9hZFRyZWVEYXRhVHlwZTogJ2xheWVybG9hZCcsXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGlmICh0aGlzLmxvb2t1cENtcC5oZWxwSWQpIHtcclxuICAgICAgICAgICAgcGFyYW1bJ2hlbHBJZCddID0gdGhpcy5sb29rdXBDbXAuaGVscElkO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHR0ICYmIHR0LnNvcnROYW1lKSB7XHJcbiAgICAgICAgICAgIGxldCBzb3J0TmFtZSA9IHR0LnNvcnROYW1lO1xyXG4gICAgICAgICAgICBjb25zdCBzb3J0Q29sOiBhbnkgPSB0aGlzLm5hdk9wdGlvbnMuY29sdW1ucy5maW5kKG4gPT4gbi5maWVsZCA9PT0gdHQuc29ydE5hbWUpO1xyXG4gICAgICAgICAgICBpZiAoc29ydENvbCkge1xyXG4gICAgICAgICAgICAgICAgc29ydE5hbWUgPSBzb3J0Q29sWydmaWVsZFBhdGgnXTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgc2VhcmNoWydzb3J0TmFtZSddID0gc29ydE5hbWU7XHJcbiAgICAgICAgICAgIHNlYXJjaFsnc29ydE9yZGVyJ10gPSB0dC5zb3J0T3JkZXI7XHJcbiAgICAgICAgICAgIHBhcmFtLnNlYXJjaFZhbHVlID0gSlNPTi5zdHJpbmdpZnkoc2VhcmNoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICh0aGlzLm5hdkNvbmRpdGlvbnMgJiYgdGhpcy5uYXZDb25kaXRpb25zLmxlbmd0aCAmJiAhYWxsKSB7XHJcbiAgICAgICAgICAgIHBhcmFtLm5hdlNlYXJjaENvbmRpdGlvbnMgPSB0aGlzLm5hdkNvbmRpdGlvbnM7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGRlbGV0ZSBwYXJhbS5uYXZDb25kaXRpb25zO1xyXG4gICAgICAgIHJldHVybiB0aGlzLmxvb2t1cENtcC5odHRwLmdldERhdGEodXJpICwgcGFyYW0pO1xyXG4gICAgfVxyXG5cclxuXHJcbiAgICBsb2FkRGF0YSgpIHtcclxuICAgICAgICB0aGlzLmNtcFJlZi5pbnN0YW5jZS5hbGxDb2x1bW5zVGl0bGUgPSB0aGlzLmxvb2t1cENtcC5hbGxDb2x1bW5zVGl0bGU7XHJcbiAgICAgICAgaWYgKCF0aGlzLmlzVHJlZUxpc3QoKSkge1xyXG4gICAgICAgICAgICBjb25zdCBkdCA9IHRoaXMuY21wUmVmLmluc3RhbmNlIGFzIERhdGFUYWJsZUNvbXBvbmVudDtcclxuICAgICAgICAgICAgdGhpcy5pbml0RGF0YVRhYmxlKGR0KTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBjb25zdCB0dCA9IHRoaXMuY21wUmVmLmluc3RhbmNlIGFzIFRyZWVUYWJsZUNvbXBvbmVudDtcclxuICAgICAgICAgICAgdGhpcy5pbml0VHJlZVRhYmxlKHR0KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgb25Db25kaXRpb25zQ2hhbmdlKCRldmVudCkge1xyXG4gICAgICAgIHRoaXMubmF2Q29uZGl0aW9ucyA9ICRldmVudDtcclxuICAgICAgICBpZiAodGhpcy5pc1RyZWVMaXN0KCkpIHtcclxuICAgICAgICAgICAgY29uc3QgdHQgPSB0aGlzLmNtcFJlZi5pbnN0YW5jZSBhcyBUcmVlVGFibGVDb21wb25lbnQ7XHJcbiAgICAgICAgICAgIHR0LnNlYXJjaC5lbWl0KCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgY29uc3QgZHQgPSB0aGlzLmNtcFJlZi5pbnN0YW5jZSBhcyBEYXRhVGFibGVDb21wb25lbnQ7XHJcbiAgICAgICAgICAgIGR0LnNlYXJjaC5lbWl0KCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcbiJdfQ==