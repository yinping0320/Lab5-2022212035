{"version":3,"file":"farris-ui-lookup.js.map","sources":["ng://@farris/ui-lookup/lib/lookup-displaytype.ts","ng://@farris/ui-lookup/lib/lookup.component.ts","ng://@farris/ui-lookup/lib/lookup-grid-options.ts","ng://@farris/ui-lookup/lib/http/ILookupHttpService.ts","ng://@farris/ui-lookup/lib/lookup-defaut-mapping.ts","ng://@farris/ui-lookup/lib/utils.ts","ng://@farris/ui-lookup/lib/lookup-presonalConfig.service.ts","ng://@farris/ui-lookup/lib/services/util.service.ts","ng://@farris/ui-lookup/lib/services/treenode.helper.ts","ng://@farris/ui-lookup/lib/services/favorite-helper.ts","ng://@farris/ui-lookup/lib/services/selection-manager.ts","ng://@farris/ui-lookup/lib/services/bind-datatable-event.ts","ng://@farris/ui-lookup/lib/services/on-text-change.ts","ng://@farris/ui-lookup/lib/services/bind-treetable-event.ts","ng://@farris/ui-lookup/lib/services/multi-selection.manager.ts","ng://@farris/ui-lookup/lib/services/http-manager.ts","ng://@farris/ui-lookup/lib/lookup-left.component.ts","ng://@farris/ui-lookup/lib/services/lookup-component.manager.ts","ng://@farris/ui-lookup/lib/services/dialog-mangager.ts","ng://@farris/ui-lookup/lib/services/lookup-selection.service.ts","ng://@farris/ui-lookup/lib/lookup-grid.component.ts","ng://@farris/ui-lookup/lib/lookup-tabs.component.ts","ng://@farris/ui-lookup/lib/lookup-tip.directive.ts","ng://@farris/ui-lookup/lib/quick-select/quick-select-panel.component.ts","ng://@farris/ui-lookup/lib/quick-select/lookup-quick-select.directive.ts","ng://@farris/ui-lookup/lib/advanced-layout/lookup-advanced-layout.component.ts","ng://@farris/ui-lookup/lib/advanced-layout/lookup-filter-bar.component.ts","ng://@farris/ui-lookup/lib/selected-list/lookup-selected.directive.ts","ng://@farris/ui-lookup/lib/lookup.module.ts"],"sourcesContent":["import { DataFormatter } from '@farris/ui-common/column';\r\n\r\n/** æ¶èåå­æ®µåç§° */\r\nexport const FAVORITE_FIELD_NAME = '__favorite__';\r\nexport const INPUT_GROUP_ICON = '<i class=\"f-icon f-icon-lookup\"></i>';\r\n\r\n// è·åç»ä»¶å®ä¾çç±»å\r\nexport type ComponentInstanceType = 'datatable'| 'treetable' | 'fav' | 'selected' | 'leftTree' | 'leftDataTable';\r\n\r\nexport enum LookupGridDisplayType {\r\n    List = 'LIST',\r\n    TreeList = 'TREELIST',\r\n    NavList = 'NAVLIST',\r\n    NavTreeList = 'NAVTREELIST',\r\n    NavListTree = 'NAVLISTTREE'\r\n}\r\n\r\n/** æ¶èç¸å³å¾æ  */\r\nexport enum FavoriteIcon {\r\n    /** å·²æ¶è */\r\n    yes = '<span class=\"f-icon f-icon-star f-lookup-favorite\" style=\"font-size:12px\" ></span>',\r\n    /** æªæ¶è */\r\n    no = '<span class=\"f-icon f-icon-star-outline f-lookup-favorite\" style=\"font-size:12px\"></span>',\r\n    /** ç§»é¤æ¶è */\r\n    delete = '<span class=\"f-icon f-icon-star f-lookup-unfavorite\" style=\"font-size:12px\"></span>',\r\n    /** ç§»é¤å·²éè®°å½ */\r\n    remove = '<span class=\"f-icon f-icon-minus-circle\" style=\"font-size:12px; color: #dd2438;cursor: pointer\"></span>'\r\n}\r\n\r\n/** æ¶èç¸å³å¨ä½ */\r\nexport enum FavoriteAction {\r\n    /** æ·»å æ¶è */\r\n    add = 'append item to favorite.',\r\n    /** ç§»é¤æ¶è */\r\n    delete = 'remove favorite.'\r\n}\r\n\r\nexport interface ExtInfoFormatterParam {\r\n    [key: string]: any;\r\n    bindingData?: any;\r\n    instance?: any;\r\n}\r\n\r\nexport type ExtInfoFormatterFn = (param: ExtInfoFormatterParam) => string;\r\nexport type ExtInfoFormatter = string | ExtInfoFormatterFn;\r\n\r\nexport interface CustomDataFormatter {\r\n    /** æ°æ®æ ¼å¼å */\r\n    [fieldName: string]: DataFormatter ;\r\n    /** è¡æ ·å¼ */\r\n    rowStyler?: (e: { data: any }) => {[key: string]: any};\r\n    /** ååæ ¼æ ·å¼ */\r\n    cellStyler?: (e: { data: any }, field: string) => {[key: string]: any};\r\n}\r\n\r\nexport interface QuickSelectOption {\r\n    /** æ¯å¦å¯ç¨ */\r\n    enable?: boolean;\r\n    /** æ¾ç¤ºtop è®°å½æ°ï¼é»è®¤ 10 */\r\n    showItemsCount?: number;\r\n    /** æ¾ç¤ºææ¬å­æ®µ */\r\n    textField?: string;\r\n    /** èªå®ä¹æ ¼å¼å */\r\n    formatter?: (data: any) => string;\r\n    \r\n    footerHeight?: number;\r\n    /** æ¾ç¤ºæç´¢æ´æ° æé® */\r\n    showMore?: boolean;\r\n    /** æå°å®½åº¦, é»è®¤ 200px */\r\n    minWidth?: number;\r\n    /** å¯ç¨åéé®ç§»é¤éä¸­é¡¹ï¼é»è®¤ä¸º false */\r\n    enableBackspace?: boolean;\r\n}\r\n\r\nexport const QuickSelectDefaultOptions: QuickSelectOption = {\r\n    enable: false,\r\n    showMore: true,\r\n    showItemsCount: 10,\r\n    footerHeight: 0,\r\n    minWidth: 200,\r\n    enableBackspace: false\r\n}\r\n\r\n/**\r\n * - both: å¨é¨æ¾ç¤º\r\n * - onlyfield: ä»æ¾ç¤ºå­æ®µ\r\n * - onlyinput: ä»æ¾ç¤ºæç´¢è¾å¥æ¡ */\r\nexport enum SearchBarMode {\r\n    /** æ¾ç¤ºå­æ®µæ¥è¯¢ä¸æç´¢è¾å¥æ¡ */\r\n    both = 'both',\r\n    /** ä»æ¾ç¤ºå­æ®µ */\r\n    onlyinput = 'onlyinput',\r\n    /** ä»æ¾ç¤ºæç´¢è¾å¥æ¡ */\r\n    onlyfield = 'onlyfield'\r\n}","/*\r\n * @Author: ç¯çç§æ(Lucas Huang)\r\n * @Date: 2019-08-15 15:24:24\r\n * @LastEditors: ç¯çç§æ(Lucas Huang)\r\n * @LastEditTime: 2019-11-30 14:01:34\r\n * @QQ: 1055818239\r\n * @Version: v0.0.1\r\n */\r\nimport { Subscription, Observable, of, Subject } from 'rxjs';\r\nimport {\r\n    Component, Input, Output, EventEmitter, TemplateRef,\r\n    ViewChild, Injector, forwardRef, OnInit, ElementRef, ChangeDetectorRef,\r\n    AfterViewChecked, HostBinding, NgZone, OnDestroy\r\n} from '@angular/core';\r\nimport {\r\n    NG_VALUE_ACCESSOR,\r\n    ControlValueAccessor,\r\n    NgControl\r\n} from '@angular/forms';\r\n\r\nimport { DialogComponent } from '@farris/ui-dialog';\r\nimport { IResizeEvent } from '@farris/ui-draggable';\r\n\r\nimport { PickingResult, PickedResult } from './lookup-grid-options';\r\n\r\nexport const LOOKUPINPUT_VALUE_ACCESSOR: any = {\r\n    provide: NG_VALUE_ACCESSOR,\r\n    useExisting: forwardRef(() => LookupComponent),\r\n    multi: true\r\n};\r\n\r\n@Component({\r\n    selector: 'farris-lookup',\r\n    template: `\r\n        <div\r\n            class=\"lookupbox input-group\"\r\n            [ngClass]=\"{\r\n                'f-state-disabled': disabled,\r\n                'f-state-readonly': readonly,\r\n                'f-state-editable': !editable\r\n            }\"\r\n        >\r\n            <input\r\n                class=\"form-control\"\r\n                [value]=\"displayText\"\r\n                [disabled]=\"disabled\"\r\n                [readonly]=\"!editable || readonly\"\r\n            />\r\n            <div class=\"input-group-append\">\r\n                <span class=\"f-select input-group-text\" (click)=\"showDialog()\">\r\n                    <i class=\"f-icon f-icon-lookup\"></i>\r\n                </span>\r\n            </div>\r\n        </div>\r\n        <farris-dialog\r\n            #dialog\r\n            *ngIf=\"isShow\"\r\n            [title]=\"title\"\r\n            [beforeOpen]=\"beforeOpen\"\r\n            [beforeClose]=\"beforeClose\"\r\n            [width]=\"dialogWidth\"\r\n            [height]=\"dialogHeight\"\r\n            [showButtons]=\"showButtons\"\r\n            [showMaxButton]=\"showMaxButton\"\r\n            [buttons]=\"buttonsRef || defaultButtonRef\"\r\n            [buttonAlign]=\"buttonAlign\"\r\n            (maxed)=\"onMaxDialog($event)\"\r\n            (resized)=\"onResized($event)\"\r\n            (resizing)=\"onResizing($event)\"\r\n        >\r\n            <ng-content></ng-content>\r\n\r\n            <ng-template #defaultButtonRef>\r\n                <div style=\"width: 100%;\">\r\n                    <button\r\n                        class=\"btn btn-secondary btn-lg\"\r\n                        (click)=\"closeDialog()\"\r\n                    >\r\n                        Cancel\r\n                    </button>\r\n                    <button class=\"btn btn-primary btn-lg\">Ok</button>\r\n                </div>\r\n            </ng-template>\r\n        </farris-dialog>\r\n    `,\r\n    styles: [\r\n        `\r\n            .input-group {\r\n                flex-wrap: nowrap;\r\n            }\r\n            :host-context(.ng-invalid) .form-control {\r\n                border-color: #ff0303;\r\n            }\r\n        `\r\n    ],\r\n    providers: [LOOKUPINPUT_VALUE_ACCESSOR]\r\n})\r\nexport class LookupComponent\r\n    implements OnInit, ControlValueAccessor, AfterViewChecked, OnDestroy {\r\n    @HostBinding('class') hostCls = 'f-cmp-inputgroup';\r\n\r\n    /** çªå£å®½åº¦ */\r\n    @Input() dialogWidth: number;\r\n    /** çªå£é«åº¦ */\r\n    @Input() dialogHeight: number;\r\n    /** çªå£æ é¢ãé»è®¤å¼ï¼æ­¤å¤æ¾ç¤ºå¸®å©æ é¢ */\r\n    @Input() title = '';\r\n    /** æé®å¯¹é½æ¹å¼ */\r\n    @Input() buttonAlign = 'right';\r\n    /** æé®æ¨¡æ¿ */\r\n    @Input() buttonsRef: TemplateRef<any>;\r\n    /** æ¯å¦æ¾ç¤ºæé® */\r\n    @Input() showButtons = true;\r\n    /** æ¾ç¤ºå³é­æé® */\r\n    @Input() showCloseButton = true;\r\n    /** æ¾ç¤ºæå¤§åæé® */\r\n    @Input() showMaxButton = true;\r\n    /** åè®¸ææ½å°ºå¯¸ */\r\n    @Input() resizable = true;\r\n    /** åè®¸æå¨çªå£ */\r\n    @Input() draggable = true;\r\n    /** ç¦ç¨ */\r\n    @Input() disabled = false;\r\n    /** åè®¸ç¼è¾ææ¬æ¡ */\r\n    @Input() editable = true;\r\n    /** åªè¯» */\r\n    @Input() readonly = false;\r\n    /** å­æ®µæ å°, { å¸®å©æ°æ®å­æ®µï¼è¡¨åå­æ®µ } */\r\n    @Input() mapFields: { [sourceField: string]: string };\r\n    /** å¼å­æ®µ */\r\n    @Input() valueField: string;\r\n    /** ææ¬å­æ®µ */\r\n    @Input() textField: string;\r\n    @Input() displayText = '';\r\n\r\n    /** è¿è¡æ¶ä¸ä¸æèªå®ä¹å¯¹è±¡ */\r\n    @Input() context: any;\r\n\r\n    /** çªå£æå¼åäºä»¶ */\r\n    @Input() beforeOpen: () => Observable<boolean>;\r\n    /** çªå£å³é­åäºä»¶ */\r\n    @Input() beforeClose: () => Observable<boolean>;\r\n    /** å¸®å©åäºä»¶ */\r\n    @Input() dictPicking: (emptyObj?: {}) => Observable<PickingResult>;\r\n    dictPickingSubscription: Subscription;\r\n    /** å¸®å©åäºä»¶ */\r\n    @Input() dictPicked: (rowData: any) => Observable<PickedResult>;\r\n    dictPickedSubscription: Subscription;\r\n\r\n    /** çªå£æå¼å */\r\n    @Output() dialogOpened = new EventEmitter();\r\n    /** çªå£å³é­å */\r\n    @Output() dialogClosed = new EventEmitter();\r\n    /** çªå£æå¤§å */\r\n    @Output() dialogMaxed = new EventEmitter();\r\n    /** ææ½æ¹åçªå£å°ºå¯¸è¿è¡æ¶ */\r\n    @Output() resizing = new EventEmitter();\r\n    /** ææ½æ¹åçªå£å°ºå¯¸ç»æ */\r\n    @Output() resized = new EventEmitter();\r\n    /** å¸®å©çªå£é»è®¤å°ºå¯¸ */\r\n    private defaultDialogSize = { width: 550, height: 570 };\r\n\r\n    dialogCreated = new Subject<DialogComponent>();\r\n    dialogCreatedSubscription: Subscription;\r\n    dialog: DialogComponent;\r\n    @ViewChild('dialog') set content(content: DialogComponent) {\r\n        if (this.dialog !== content) {\r\n            this.dialog = content;\r\n            if (content) {\r\n                this.dialogCreated.next(this.dialog);\r\n            }\r\n        }\r\n    }\r\n\r\n    private _isShow = false;\r\n    get isShow() {\r\n        return this._isShow;\r\n    }\r\n    set isShow(val) {\r\n        this._isShow = val;\r\n        if (!this.changeDetector['destroyed']) {\r\n            this.changeDetector.detectChanges();\r\n        }\r\n    }\r\n\r\n    ngControl: any;\r\n\r\n    displayValue = '';\r\n    originalText = '';\r\n\r\n    get invalid() {\r\n        return this.ngControl.valid;\r\n    }\r\n\r\n    private ngZone: NgZone;\r\n\r\n    onModelChange = (obj: any) => { };\r\n    onModelTouched = (val: any) => { };\r\n    constructor(\r\n        public injector: Injector,\r\n        public el: ElementRef,\r\n        public changeDetector?: ChangeDetectorRef\r\n    ) {\r\n        this.ngZone = this.injector.get(NgZone);\r\n        // if (!this.personalConfigService) {\r\n        //     const idServ = this.injector.get(IdService);\r\n        //     this.personalConfigService = new PersonalConfigService(idServ);\r\n        // }\r\n    }\r\n\r\n    ngOnInit(): void {\r\n        this.initEvents();\r\n        this.ngControl = this.injector.get(NgControl, null);\r\n    }\r\n\r\n    ngOnDestroy() {\r\n        this.lookupUnsubscribe();\r\n    }\r\n\r\n    ngAfterViewChecked() {\r\n        if (this.dialog) {\r\n            this.dialog.closed.subscribe(() => {\r\n                this.isShow = false;\r\n                this.dialog = null;\r\n            });\r\n        }\r\n    }\r\n\r\n    initEvents() {\r\n        if (!this.dictPicking) {\r\n            this.dictPicking = () => of({ showDialog: true });\r\n        }\r\n        if (!this.dictPicked) {\r\n            this.dictPicked = () => of({ closeDialog: true });\r\n        }\r\n        if (!this.beforeOpen) {\r\n            this.beforeOpen = () => of(true);\r\n        }\r\n        if (!this.beforeClose) {\r\n            this.beforeClose = () => of(true);\r\n        }\r\n\r\n        if (!this.dialogHeight) {\r\n            this.dialogHeight = this.defaultDialogSize.height;\r\n        }\r\n\r\n        if (!this.dialogWidth) {\r\n            this.dialogWidth = this.defaultDialogSize.width;\r\n        }\r\n    }\r\n\r\n    showDialog(): any {\r\n        if (this.disabled || this.readonly) {\r\n            return false;\r\n        }\r\n        this.dictPicking().subscribe((val: PickingResult) => {\r\n            if (val.showDialog === false) {\r\n                return;\r\n            }\r\n\r\n            this.isShow = true;\r\n            // this.changeDetector.detectChanges();\r\n            this.ngZone.runOutsideAngular(() => {\r\n                setTimeout(() => this.dialog.show());\r\n            });\r\n        });\r\n\r\n        return false;\r\n    }\r\n\r\n    closeDialog() {\r\n        this.isShow = false;\r\n        if (this.dialog) {\r\n            this.dialog.close();\r\n        }\r\n    }\r\n\r\n\r\n    private lookupUnsubscribe() {\r\n        if (this.dictPickedSubscription) {\r\n            this.dictPickedSubscription.unsubscribe();\r\n        }\r\n        if (this.dictPickingSubscription) {\r\n            this.dictPickingSubscription.unsubscribe();\r\n        }\r\n        if (this.dialogCreatedSubscription) {\r\n            this.dialogCreatedSubscription.unsubscribe();\r\n        }\r\n    }\r\n\r\n    onResizing(pos: IResizeEvent) {\r\n        this.resizing.emit(pos.size);\r\n    }\r\n    onResized(pos: IResizeEvent) {\r\n        this.resized.emit(pos.size);\r\n    }\r\n    onMaxDialog(pos: IResizeEvent) {\r\n        this.dialogMaxed.emit(pos.size);\r\n    }\r\n\r\n    writeValue(obj: any): void {\r\n        if (obj) {\r\n            this.displayText = obj;\r\n            this.displayValue = obj;\r\n            this.originalText = this.displayText;\r\n        } else {\r\n            this.displayText = '';\r\n            this.displayValue = '';\r\n            this.originalText = '';\r\n        }\r\n    }\r\n    registerOnChange(fn: any): void {\r\n        this.onModelChange = fn;\r\n    }\r\n    registerOnTouched(fn: any): void {\r\n        this.onModelTouched = fn;\r\n    }\r\n    setDisabledState?(isDisabled: boolean): void {\r\n        this.disabled = isDisabled;\r\n    }\r\n}\r\n","/*\r\n * @Author: ç¯çç§æ(Lucas Huang)\r\n * @Date: 2019-07-10 11:44:49\r\n * @LastEditors: ç¯çç§æ(Lucas Huang)\r\n * @LastEditTime: 2019-09-25 18:10:54\r\n * @QQ: 1055818239\r\n * @Version: v0.0.1\r\n */\r\nimport { DataColumn } from '@farris/ui-common/column';\r\n\r\nexport type ONLY_SELECT_LEAF = 'default' | 'yes' | 'no';\r\nexport type LOAD_DATA_TYPE = 'all' | 'fav' | 'list' | 'nav' | 'search' | 'children'\r\n                            | 'textchange' | 'sort' | 'navsearch' | 'selected' | 'allChildren' | 'navAllChildren';\r\n\r\nexport interface TreeInfo {\r\n    /** æ°æ®å è½½æ¹å¼ï¼ all, async */\r\n    loadDataType?: 'all' | 'async';\r\n    /** åå±æ¹å¼ï¼ pathcode, parentId */\r\n    layerType?: string;\r\n    /** æ°æ®ä¸­å¸¦æåçº§ä¿¡æ¯çå­æ®µ */\r\n    dataField?: string;\r\n    /** ç¶IDå­æ®µ */\r\n    parentField?: string;\r\n    /** åçº§ç å­æ®µ */\r\n    pathField?: string;\r\n    /** çº§æ°å­æ®µ */\r\n    layerField?: string;\r\n    /** æ¯å¦æç»å­æ®µ */\r\n    isDetailField?: string;\r\n    /**\r\n     * åªåè®¸éæ©å¶å­èç¹\r\n     * - default: åºç¨æå¡å¨ç«¯è®¾ç½®ï¼å¦æå¡å¨æªè®¾ç½®ï¼åè½å  `no`\r\n     * - `yes`: æå¡å¨ç«¯è®¾ç½®å¤±æãä»åè®¸éæ©å¶å­èç¹ã\r\n     * - `no`:  æå¡å¨ç«¯è®¾ç½®å¤±æãææèç¹åå¯éæ©ã\r\n     */\r\n    onlySelectLeaf?: boolean | ONLY_SELECT_LEAF;\r\n    /** æ ç»ææ°æ®æ¯å¦å·²åå§åå®æ */\r\n    treeDataIsInit?: boolean;\r\n}\r\n\r\nexport interface CustomStyleData {\r\n    field: string, \r\n    value: string, comparator?: string, \r\n    styles: { [key: string]: any }\r\n}\r\n\r\nexport interface LookupGridResult {\r\n    /** åä¿¡æ¯ */\r\n    columns?: DataColumn[];\r\n    /** æ°æ®åè¡¨ */\r\n    items?: any[];\r\n    /** æ¥è¯¢å­æ®µ */\r\n    searchFields?: { label: string, value: string }[];\r\n    /** åé¡µä¿¡æ¯ */\r\n    pageInfo?: { pageIndex: number, pageSize: number, pageList?: number[], enablePager: boolean };\r\n    /** æ»è®°å½æ° */\r\n    total?: number;\r\n    /** åºå¼ */\r\n    mapFields?: { desgine: string, runtime: string }[];\r\n    /** æ åçº§ä¿¡æ¯ */\r\n    treeInfo?: TreeInfo;\r\n    displayType?: string;\r\n    displayInfo?: DisplayInfo;\r\n    title?: string;\r\n    navigation?: NavigationOptions;\r\n    valueField?: string;\r\n    textField?: string;\r\n    idField?: string;\r\n    /** å·²éæ©æ°æ®åè¡¨ */\r\n    selectedItems?: any;\r\n    /** æ¶èæ°æ® */\r\n    favoriteItems?: any[];\r\n    /** èªå®ä¹è¡æ ·å¼ */\r\n    customStyles?: {\r\n        row?: Array<CustomStyleData>,\r\n        cell?:Array<CustomStyleData>\r\n    }\r\n}\r\n\r\n/** ä¸ªæ§åæ°æ® */\r\nexport interface PersonalConfig {\r\n    tabIndex?: string;\r\n    favorite?: {\r\n        [lang: string]: any[];\r\n    };\r\n    quickSelected?: {\r\n        [lang: string]: any[];\r\n    };\r\n    size?: any;\r\n    selections?: any;\r\n    cascadeStatus?: string;\r\n    colSizeInfo?: {data: { [field: string]: number }, nav: {[field: string]: number}, fav: {[field: string]: number}};\r\n    [key: string]: any;\r\n}\r\n\r\nexport interface NavigationOptions extends LookupGridResult {\r\n    [key: string]: any;\r\n    displayType: 'List' | 'TreeList';\r\n    width: number;\r\n    idField?: string;\r\n    relations?: { groupField: string, helpField: string }[];\r\n    hover?: boolean;\r\n}\r\n\r\nexport interface LookupGridOptions extends LookupGridResult {\r\n    singleSelect?: boolean;\r\n    idField?: string;\r\n    uri?: string; // å¯ä»¥ä¸ºåæ°æ®IDãwebapi å°å\r\n    showFilterBar?: boolean;\r\n    pagination?: boolean;\r\n    pageIndex?: number;\r\n    pageSize?: number;\r\n    pageList?: number[];\r\n    total?: number;\r\n    width?: number;\r\n    height?: number;\r\n    hover?: boolean;\r\n}\r\n\r\nexport class DisplayInfo {\r\n    title?: string;\r\n    favorites?: string;\r\n    okText?: string;\r\n    cancelText?: string;\r\n    allColumns?: string;\r\n}\r\n\r\nexport const lookupGridDefaults: LookupGridOptions = {\r\n    singleSelect: true,\r\n    showFilterBar: true,\r\n    pagination: true,\r\n    pageIndex: 1,\r\n    pageSize: 10,\r\n    pageList: [10, 20, 30, 50, 100]\r\n};\r\n\r\nexport const displayInfoDefault = {\r\n    title: 'æ­¤å¤æ¾ç¤ºæ é¢',\r\n    favorites: 'æ¶èå¤¹',\r\n    okText: 'ç¡®å®',\r\n    cancelText: 'åæ¶',\r\n    allColumns: 'ææå'\r\n};\r\n\r\n/** å¸®å©åäºä»¶è¿åç±»å */\r\nexport interface PickingResult {\r\n    /** true: ç»§ç»­æå¼å¸®å©ï¼false: ä¸æå¼å¸®å©çªå£ */\r\n    showDialog: boolean;\r\n    /** æºå¸¦çä¸äºèªå®ä¹æ°æ®ï¼ç±ä¸å¡å¨æå¡å¨ç«¯å¸®å©åäºä»¶ä¸­å¤ç */\r\n    data?: any;\r\n    message?: any;\r\n}\r\n\r\nexport interface PickedResult {\r\n    closeDialog: boolean;\r\n    message?: any;\r\n}\r\n","/*\r\n * @Author: ç¯çç§æ(Lucas Huang)\r\n * @Date: 2019-05-23 10:27:07\r\n * @LastEditors: ç¯çç§æ(Lucas Huang)\r\n * @LastEditTime: 2019-08-15 14:11:43\r\n * @QQ: 1055818239\r\n * @Version: v0.0.1\r\n */\r\nimport { InjectionToken } from '@angular/core';\r\nimport { Observable } from 'rxjs';\r\nimport { LOOKUP_HTTP_PARAMS } from './RemoteParams';\r\nimport { LookupGridResult } from '../lookup-grid-options';\r\n\r\nexport interface ILookupHttpService {\r\n    context?: any;\r\n    /**\r\n     * æ ¹æ®æå®çå¸®å©åæ°æ®IDåç¸å³åæ°è·åæ°æ®\r\n     * @param uri å¸®å©åæ°æ®ID or Rest API\r\n     * @param data æå¡å¨ç«¯æ¥æ¶åæ° key/value\r\n     */\r\n    getData(uri: string, params?: LOOKUP_HTTP_PARAMS): Observable<LookupGridResult>;\r\n}\r\nexport const ServerSideToken = new InjectionToken<ILookupHttpService>('Lookup Grid HTTP service');\r\n","import { Injectable } from '@angular/core';\r\nimport { trim } from 'lodash-es';\r\nimport { CommonUtils } from '@farris/ui-common';\r\n\r\n@Injectable()\r\nexport class LookupDefaultMapping {\r\n\r\n    constructor(private utils: CommonUtils) {}\r\n\r\n    lookupFieldMap = (helpData, mapFields, dataObj) => {\r\n        if (mapFields) {\r\n            const helpFields = Object.keys(mapFields);\r\n            helpFields.forEach( (f: any) => {\r\n                let val = '';\r\n                if (helpData) {\r\n                    if (helpData instanceof Array) {\r\n                        val = helpData.map( (h: any) => {\r\n                            return this.utils.getValue(f, h);\r\n                        }).join(',');\r\n                    } else {\r\n                        val = this.utils.getValue(f, helpData);\r\n                    }\r\n\r\n                }\r\n\r\n                mapFields[f].split(',').forEach( (ff: any) => {\r\n                    const field = trim(ff);\r\n                    this.utils.setValue(dataObj, field, val);\r\n                });\r\n            });\r\n        }\r\n    }\r\n\r\n\r\n}\r\n","import { Injectable, NgZone } from '@angular/core';\r\nimport { CommonUtils, RuntimeStateService } from '@farris/ui-common';\r\nimport { FilterRelation, FilterCondition, Compare, EntityFilter } from '@farris/ui-common/types';\r\nimport { cloneDeep } from 'lodash-es';\r\nimport { TreeInfo } from './lookup-grid-options';\r\n\r\n@Injectable()\r\nexport class LookupUtils {\r\n\r\n    constructor(private utils: CommonUtils, private rts: RuntimeStateService, private ngZone: NgZone) { }\r\n\r\n    setActiveLookupInstance(lookupIns: any) {\r\n        if (this.rts) {\r\n            this.rts.setLookupInstance(lookupIns);\r\n        }\r\n    }\r\n\r\n\r\n    destroy() {\r\n        this.rts.destroy();\r\n    }\r\n\r\n    pendingStart() {\r\n        if (this.rts) {\r\n            this.rts.updateFormState({\r\n                lookup: {\r\n                    pending: true\r\n                }\r\n            });\r\n\r\n            // ç¦ç¨é¡µé¢çææé¼ æ äºä»¶\r\n            document.body.style['pointer-events'] = 'none';\r\n        }\r\n    }\r\n\r\n    pendingEnd() {\r\n        if (this.rts) {\r\n            this.rts.updateFormState({\r\n                lookup: {\r\n                    pending: false\r\n                }\r\n            });\r\n\r\n            // æ¿æ´»é¼ æ äºä»¶\r\n            document.body.style['pointer-events'] = '';\r\n        }\r\n    }\r\n\r\n    getPathCode(data, treeInfo = null) {\r\n        const { dataField, pathField } =  treeInfo ;\r\n        if (dataField) {\r\n            return data[dataField][pathField];\r\n        } else {\r\n            return this.utils.getValue(pathField, data);\r\n        }\r\n    }\r\n    getLayerData(data, treeInfo = null ) {\r\n        const { dataField, layerField } = treeInfo;\r\n        if (dataField) {\r\n            return data[dataField][layerField];\r\n        } else {\r\n            return this.utils.getValue(layerField, data);\r\n        }\r\n    }\r\n\r\n\r\n    private createFilterCondition(field: string, value: string) {\r\n        return {\r\n            filterField: field,\r\n            value,\r\n            lbracket: '',\r\n            rbracket: '',\r\n            relation: FilterRelation.Or,\r\n            compare: Compare.Like\r\n        };\r\n    }\r\n\r\n    mergeCondition(condition: EntityFilter, fields: string[], searchData: { field: string, value: string }) {\r\n        if (!condition) {\r\n            condition = {\r\n                pagination: {\r\n                    pageIndex: 1,\r\n                    pageSize: 20\r\n                },\r\n                filterConditions: [],\r\n                sortConditions: []\r\n            };\r\n        } else {\r\n            condition = cloneDeep(condition);\r\n        }\r\n\r\n        const { field = '*', value = '' } = { ...searchData };\r\n\r\n        if (value) {\r\n            if (field === '*') {\r\n                if (fields && fields.length) {\r\n                    const searchConditions: FilterCondition[] = fields.map((f: string) => {\r\n                        return this.createFilterCondition(f, value);\r\n                    });\r\n\r\n                    if (searchConditions.length) {\r\n                        searchConditions[0].lbracket = '(';\r\n                        const lastSearchConditions = searchConditions[searchConditions.length - 1];\r\n                        lastSearchConditions.rbracket = ')';\r\n                        lastSearchConditions.relation = FilterRelation.Empty;\r\n                    }\r\n\r\n                    if (condition.filterConditions && condition.filterConditions.length) {\r\n                        condition.filterConditions[condition.filterConditions.length - 1].relation = FilterRelation.And;\r\n                        condition.filterConditions = condition.filterConditions.concat(searchConditions);\r\n                    } else {\r\n                        condition.filterConditions = searchConditions;\r\n                    }\r\n                }\r\n            } else {\r\n                const searchCondition = this.createFilterCondition(field, value);\r\n                searchCondition.relation = FilterRelation.Empty;\r\n                if (condition.filterConditions && condition.filterConditions.length) {\r\n                    condition.filterConditions[condition.filterConditions.length - 1].relation = FilterRelation.And;\r\n                    condition.filterConditions.push(searchCondition);\r\n                } else {\r\n                    condition.filterConditions = [searchCondition];\r\n                }\r\n            }\r\n        }\r\n\r\n        return condition;\r\n    }\r\n\r\n    private canSelectable(n: any) {\r\n        if (n.hasOwnProperty('farris_selectable')) {\r\n            return !!n['farris_selectable'];\r\n        }\r\n        return true;\r\n    }\r\n\r\n    /** å°æ°æ®è½¬æ å½¢ç»æ */\r\n    makeTreeWithParentID(data: any[], parentId, parentIdField = 'parentId', idField = 'id') {\r\n        const nodes = new Map<string, any>();\r\n        const result = [];\r\n        const unattached = [];\r\n        data.forEach(t => {\r\n            const node = {\r\n                data: t,\r\n                children: [],\r\n                selectable: this.canSelectable(t),\r\n                parent: null,\r\n                parents: []\r\n            };\r\n            const id = t[idField];\r\n            nodes.set(id, node);\r\n            const PID = this.utils.getValue(parentIdField, t);\r\n            if (PID === parentId) {\r\n                result.push(node);\r\n            } else {\r\n                const parent = nodes.get(PID);\r\n                if (parent) {\r\n                    node.parent = PID;\r\n                    node.parents = [...parent.parents, PID];\r\n                    parent.children.push(node);\r\n                } else {\r\n                    unattached.push(node);\r\n                }\r\n            }\r\n        });\r\n\r\n        unattached.forEach(n => {\r\n            const pid = this.utils.getValue(parentIdField, n.data);\r\n            const parent = nodes.get(pid);\r\n            if (parent) {\r\n                n.parent = pid;\r\n                n.parents = [...parent.parents, pid];\r\n                parent.children.push(n);\r\n            }\r\n        });\r\n\r\n        return result;\r\n    }\r\n\r\n    makeTree(data, treeInfo: TreeInfo) {\r\n        // const treeInfoField = treeInfo.dataField;\r\n        // const layerField = treeInfo.layerField;\r\n        // const pathField = treeInfo.pathField;\r\n\r\n        const nodes = new Map<string, any>();\r\n        const result = [];\r\n        const unattached = [];\r\n        data.forEach(t => {\r\n            const node = {\r\n                data: t,\r\n                children: [],\r\n                selectable: this.canSelectable(t)\r\n            };\r\n            const pathCode = this.getPathCode(t, treeInfo);\r\n            nodes.set(pathCode, node);\r\n\r\n            if (this.getLayerData(t, treeInfo) === 1) {\r\n                result.push(node);\r\n            } else {\r\n                const parentPathCode = pathCode.substr(0, pathCode.length - 4);\r\n                const parent = nodes.get(parentPathCode);\r\n                if (parent) {\r\n                    parent.children.push(node);\r\n                } else {\r\n                    unattached.push(node);\r\n                }\r\n            }\r\n        });\r\n\r\n\r\n        unattached.forEach(n => {\r\n            // const pathCode = n.data[treeInfoField][pathField];\r\n            const pathCode = this.getPathCode(n.data, treeInfo);\r\n            const parent = nodes.get(pathCode.substr(0, pathCode.length - 4));\r\n            if (parent) {\r\n                parent.children.push(n);\r\n            }\r\n        });\r\n\r\n        return result;\r\n    }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { IdService } from '@farris/ui-common';\r\nimport { Subject } from 'rxjs';\r\nimport { PersonalConfig } from './lookup-grid-options';\r\n\r\n\r\n@Injectable()\r\nexport class PersonalConfigService {\r\n    // ä¸ªæ§åéç½®\r\n    personalConf: PersonalConfig;\r\n\r\n    selectItemObser$ = new Subject();\r\n\r\n    displayType = 'LIST';\r\n\r\n    singleSelect = true;\r\n    idField: string;\r\n    textField: string;\r\n    mapFields: any;\r\n\r\n    // ä¸ªæ§åéç½®KEY\r\n    private _key = '';\r\n    _newKey = '';\r\n    get personalConfigKey() {\r\n        return this._key;\r\n    }\r\n    set personalConfigKey(val) {\r\n        if (val) {\r\n            this._key = this.buildKey(val);\r\n            if (this.controlID) {\r\n                this._newKey = this.buildKey(this.controlID + '_' + val);\r\n            } else {\r\n                this._newKey = this._key;\r\n            }\r\n        } else {\r\n            this._newKey = this.buildKey(this.controlID);\r\n        }\r\n    }\r\n\r\n    // ç»ä»¶ID\r\n    controlID = '';\r\n\r\n    constructor(private idService: IdService) {}\r\n\r\n    private buildKey(str) {\r\n        let prefix = '';\r\n        if (location.hash) {\r\n            const pathArr = location.hash.split('?');\r\n            prefix = pathArr ? pathArr[0] : '';\r\n        } else {\r\n            const pathArr  = location.pathname.split('/');\r\n            prefix = pathArr ? pathArr[pathArr.length - 1] : '';\r\n        }\r\n        return this.idService.encrypt(prefix + str);\r\n    }\r\n\r\n    initPersonalConf(obj) {\r\n        Object.assign(this, obj);\r\n    }\r\n\r\n    getPersonalData(key?: string): PersonalConfig {\r\n        if (key) {\r\n            this._key = key;\r\n        }\r\n\r\n        if (this.personalConfigKey) {\r\n            const conf = localStorage.getItem(this.personalConfigKey);\r\n\r\n            if (conf && conf !== 'undefined' && conf !== 'null') {\r\n                this.personalConf = conf ? JSON.parse(conf) : {};\r\n                this._updatePersonalConfig(this.personalConf);\r\n\r\n                if (this.controlID) {\r\n                    if (this._key !== this._newKey) {\r\n                        localStorage.removeItem(this._key);\r\n                    }\r\n                    this.savePersonalConfig(this.personalConf);\r\n                }\r\n\r\n                return this.personalConf;\r\n            } else {\r\n                return null;\r\n            }\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    getQuickSelected(localeId?: string): any {\r\n        const d = this.getPersonalData();\r\n        const qs =  d ? d.quickSelected : null;\r\n\r\n        if (localeId) {\r\n            if (qs) {\r\n                const items = qs[localeId];\r\n                if (items && items.length) {\r\n                    return items;\r\n                }\r\n            }\r\n            return null;\r\n        }\r\n        return qs;\r\n    }\r\n\r\n    getDialogSize() {\r\n        const d = this.getPersonalData();\r\n        return d ? d.size : null;\r\n    }\r\n\r\n    updatePersonalConfig(cfg: Partial<PersonalConfig>) {\r\n        const data = Object.assign(this.personalConf || {}, cfg);\r\n        this.savePersonalConfig(data);\r\n    }\r\n\r\n    savePersonalConfig(data: PersonalConfig) {\r\n        if (this._newKey) {\r\n            let _data = localStorage.getItem(this._newKey) as any;\r\n            if (_data) {\r\n                _data = JSON.parse(_data) as PersonalConfig;\r\n\r\n                if (_data.favorite) {\r\n                    if (!data.favorite) {\r\n                        data.favorite = _data.favorite;\r\n                    } else {\r\n                        Object.keys(_data.favorite).forEach((lang) => {\r\n                            data.favorite[lang] = data.favorite[lang] || [];\r\n                            if (_data.favorite[lang]) {\r\n                                const arr = Array.from(new Set([...data.favorite[lang], ..._data.favorite[lang]]));\r\n                                data.favorite[lang] = arr;\r\n                            }\r\n                        });\r\n                    }\r\n                }\r\n            }\r\n\r\n            localStorage.setItem(this._newKey, JSON.stringify(data));\r\n            this.personalConf = data;\r\n            return true;\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    getActiveTabIndex(tabName?: string) {\r\n        const d = this.getPersonalData();\r\n        if (!tabName) {\r\n            return d && d.tabIndex ? d.tabIndex  : 'datalist';\r\n        }\r\n        return tabName;\r\n    }\r\n\r\n    updateQueckSelected(selectedRow: any, localeId: string) {\r\n        const quickItems = this.getQuickSelected(localeId);\r\n\r\n        if (quickItems && quickItems.length) {\r\n            const selectedIndex = [];\r\n            quickItems.forEach((element, index) => {\r\n                if (this.singleSelect) {\r\n                    if (element && selectedRow && element[this.idField] === selectedRow[this.idField]) {\r\n                        selectedIndex.push(index);\r\n                    }\r\n                } else {\r\n                    if (selectedRow) {\r\n                        selectedRow.forEach(item => {\r\n                            if (element && element[this.idField] === item[this.idField]) {\r\n                                selectedIndex.push(index);\r\n                            }\r\n                        });\r\n                    }\r\n                }\r\n            });\r\n\r\n            selectedIndex.forEach(index => {\r\n                quickItems[index] = null;\r\n            });\r\n\r\n            this.personalConf.quickSelected[localeId] =\r\n                this.personalConf.quickSelected[localeId].filter(v => v !== null);\r\n            if (this.singleSelect) {\r\n                this.personalConf.quickSelected[localeId].unshift(selectedRow);\r\n            } else {\r\n                if (selectedRow) {\r\n                    selectedRow.forEach(element => {\r\n                        this.personalConf.quickSelected[localeId].unshift(element);\r\n                    });\r\n                }\r\n            }\r\n            this.personalConf.quickSelected[localeId].length =\r\n                this.personalConf.quickSelected[localeId].length > 5 ?\r\n                    5 : this.personalConf.quickSelected[localeId].length;\r\n        } else {\r\n            const _qs = this.personalConf.quickSelected || {};\r\n            let newData;\r\n            if (this.singleSelect) {\r\n                newData = Object.assign(_qs, { [localeId]: [selectedRow] });\r\n            } else {\r\n                selectedRow.length = selectedRow.length > 5 ? 5 : selectedRow.length;\r\n                newData = Object.assign(_qs, { [localeId]: selectedRow });\r\n            }\r\n            this.personalConf.quickSelected = newData;\r\n        }\r\n\r\n        this.savePersonalConfig(this.personalConf);\r\n    }\r\n\r\n    /**\r\n     *  æ´æ°æ°æ®ç»æï¼ç°æä¸ªæ§åæ°æ®åè½¬ä¸º ä¸­æç¯å¢ä¸æ°æ®ï¼\r\n     */\r\n    _updatePersonalConfig(per: PersonalConfig) {\r\n        if (per) {\r\n            let flag = false;\r\n            // æ´æ°æ¶èæ°æ®\r\n            if (per.favorite && Array.isArray(per.favorite)) {\r\n                per.favorite = { 'zh-CHS': [...per.favorite] };\r\n                delete per.favorite;\r\n\r\n                flag = true;\r\n            }\r\n            // æ´æ°å¿«æ·å½å¥æ°æ®\r\n            if (per.selected) {\r\n                if (Array.isArray(per.selected)) {\r\n                    per.quickSelected = { 'zh-CHS': [...per.selected] };\r\n                }\r\n                delete per.selected;\r\n                flag = true;\r\n            }\r\n\r\n            if (flag) {\r\n                this.savePersonalConfig(per);\r\n            }\r\n        }\r\n    }\r\n\r\n}\r\n","import { LookupGridComponent } from '../lookup-grid.component';\r\nimport { LookupGridDisplayType } from '../lookup-displaytype';\r\nimport { TreeTableComponent, TreeNode } from '@farris/ui-treetable';\r\n\r\nexport class UtilService {\r\n\r\n    constructor(public instance: LookupGridComponent) {}\r\n\r\n\r\n}\r\n","import { TreeNode } from '@farris/ui-treetable';\r\nimport { LookupGridComponent } from '../lookup-grid.component';\r\nimport { TreeInfo } from '../lookup-grid-options';\r\n\r\nexport class TreeNodeHelper {\r\n    treeInfo: TreeInfo;\r\n    flatAllNodes = [];\r\n    constructor(private instance: LookupGridComponent) { }\r\n\r\n    getTreeInfo(treeNode: TreeNode) {\r\n        if (treeNode.data[this.treeInfo.dataField]) {\r\n            return treeNode.data[this.treeInfo.dataField];\r\n        }\r\n\r\n        const data = treeNode.data;\r\n        if (data && this.treeInfo.dataField) {\r\n\r\n            const treeInfoDataField = this.treeInfo.dataField.toLowerCase();\r\n            const dataField = Object.keys(treeNode.data).find(n => {\r\n                return n.toLowerCase() === treeInfoDataField;\r\n            });\r\n            if (dataField) {\r\n                return data[dataField];\r\n            } else {\r\n                this.instance.writeConsole(`æªæ¾å°æ å½¢ä¿¡æ¯æ°æ®å­æ®µã${this.treeInfo.dataField}ã`, 'error');\r\n            }\r\n        } else {\r\n            this.instance.writeConsole(`æªæ¾å°æ å½¢ä¿¡æ¯æ°æ®å­æ®µã${this.treeInfo.dataField}ã`, 'error');\r\n        }\r\n    }\r\n\r\n    getTreeNodeLayer(treeNode: TreeNode) {\r\n        return this.getTreeInfo(treeNode)[this.treeInfo.layerField];\r\n    }\r\n    /** æ´æ°èç¹çå±å¼ç¶æã æ ¹æ®ç»ä»¶ä¸­ expandLevel çå¼å³å®\r\n     * -1ï¼ä¸å±å¼ï¼0ï¼å¨é¨å±å¼ï¼>0 å±å¼å°æå®çº§æ°\r\n     */\r\n    updateTreeNodeExpanded(treeNodes: TreeNode[], treeInfo: TreeInfo = null) {\r\n        if (treeInfo) {\r\n            this.treeInfo = treeInfo;\r\n        } else {\r\n            this.treeInfo = this.instance.treeInfo;\r\n        }\r\n        const expandLevel = this.instance.expandLevel;\r\n        if (expandLevel === -1) {\r\n            return;\r\n        }\r\n        if (!this.flatAllNodes.length) {\r\n            this.flatAllNodes = this.treeData2Flat(null, treeNodes, 0, []);\r\n        }\r\n\r\n        treeNodes.forEach((tn: TreeNode) => {\r\n            tn.expanded = this.shoudExpand(expandLevel, this.getTreeNodeLayer(tn));\r\n            if (this.isSelectNodeParent(tn)) {\r\n                tn.expanded = true;\r\n            }\r\n            if (tn.children && tn.children.length) {\r\n                this.updateTreeNodeExpanded(tn.children, treeInfo);\r\n            } else {\r\n                tn.leaf = true;\r\n            }\r\n        });\r\n    }\r\n\r\n    private treeData2Flat(parent, nodes, level, parentIds) {\r\n        const idField = this.instance.idField;\r\n        let arr = [];\r\n        if (nodes && nodes.length) {\r\n\r\n            nodes.forEach((node, index) => {\r\n                // node.parent = parent;\r\n\r\n                let parents = [];\r\n                if (parent) {\r\n                    const parentID = parent.data[idField];\r\n                    const _parents = parentIds || [];\r\n                    parents = parents.concat(_parents.map(n => n));\r\n                    parents.push(parentID);\r\n                }\r\n                const rowNode = {\r\n                    id: node.data[idField],\r\n                    node,\r\n                    level,\r\n                    parents,\r\n                };\r\n                arr.push(rowNode);\r\n                arr = arr.concat(this.treeData2Flat(node, node.children, level + 1, parents));\r\n            });\r\n        }\r\n        return arr;\r\n    }\r\n\r\n    private shoudExpand(expandLevel: number, nodeLayer: number) {\r\n        if (expandLevel === -1) {\r\n            // -1 ä¸ºä¸å±å¼\r\n            return false;\r\n        } else if (expandLevel === 0) {\r\n            // 0 ä¸ºå¨é¨å±å¼\r\n            return true;\r\n        } else {\r\n            // æ²¡æå¯ç¨åå±å è½½ï¼éè¿å±å¼å±çº§ç¡®å®æ¯å¦å±å¼è¯¥èç¹\r\n            return nodeLayer <= expandLevel;\r\n        }\r\n    }\r\n\r\n    private isSelectNodeParent(treeNode) {\r\n        if (this.instance.navSelectedIds) {\r\n            const allParentIds: string[] = this.flatAllNodes.find(f => f.id === this.instance.navSelectedIds).parents;\r\n            if (allParentIds && allParentIds.length) {\r\n                return allParentIds.includes(treeNode.id);\r\n            }\r\n            return false;\r\n        }\r\n        return false;\r\n    }\r\n\r\n    getLeafNode(treeNode: TreeNode) {\r\n        if (treeNode && (!treeNode.children || !treeNode.children.length)) {\r\n            return treeNode;\r\n        } else {\r\n            if (treeNode.children.length === 1) {\r\n                return this.getLeafNode(treeNode.children[0]);\r\n            } else {\r\n                return treeNode.children;\r\n            }\r\n        }\r\n    }\r\n\r\n    flatTreeNodes(items, result = []) {\r\n        items = items || [];\r\n        return  items.reduce((c, n) => {\r\n            c.push(n);\r\n            if (n.children && n.children.length) {\r\n                this.flatTreeNodes(n.children, c);\r\n            }\r\n            return c;\r\n        }, result);\r\n    }\r\n}\r\n","import { ComponentRef } from '@angular/core';\r\nimport { DataTableComponent } from '@farris/ui-datatable';\r\nimport { TreeNode, TreeTableComponent } from '@farris/ui-treetable';\r\nimport { UserFavoriteData } from '../http/RemoteParams';\r\nimport { FavoriteAction, FavoriteIcon, FAVORITE_FIELD_NAME, LookupGridDisplayType } from '../lookup-displaytype';\r\nimport { LookupGridResult } from '../lookup-grid-options';\r\nimport { LookupGridComponent } from '../lookup-grid.component';\r\nimport { LookupSelectionService } from './lookup-selection.service';\r\n\r\nexport class FavoriteHelper {\r\n\r\n    private lookupSelectionSer: LookupSelectionService;\r\n\r\n    constructor(private instance: LookupGridComponent) {\r\n        this.lookupSelectionSer = this.instance.lookupSelectionSer;\r\n    }\r\n\r\n    getFavoriteColumns(): any[] {\r\n        const columns = this.instance.gridOptions.columns.map(item => {\r\n            const rtn = Object.assign({}, item);\r\n            if (item.field === FAVORITE_FIELD_NAME) {\r\n                rtn.formatter = () => FavoriteIcon.delete;\r\n            }\r\n            return rtn;\r\n        });\r\n\r\n        this.instance.initColumnWidth(columns, 'fav');\r\n        return columns;\r\n    }\r\n\r\n    favoriteColumnFormatter = (v: any, data: any  ) => {\r\n        const f =  v ? FavoriteIcon.yes : FavoriteIcon.no;\r\n        if (this.instance.isTree()) {\r\n            const id = data[this.instance.idField];\r\n            if (id) {\r\n                const tt = this.instance.componentRef.instance as TreeTableComponent;\r\n                const rn = tt.findRowNode(id);\r\n                if (rn) {\r\n                    if (rn.node.selectable) {\r\n                        return f;\r\n                    } else {\r\n                        return '';\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return f;\r\n    }\r\n\r\n    initPersonalInfo() {\r\n        if (this.instance.personalConfigService) {\r\n            const controlID = this.instance.el.nativeElement.id || this.instance.controlId;\r\n            if (!controlID) {\r\n                this.instance.writeConsole('LookupGrid - æªè®¾ç½®ç»ä»¶id, æ¶èåè½å°ä¸è½æ­£å¸¸ï¼è¯·è®¾ç½®ç»ä»¶id.');\r\n            }\r\n            const pcstr = this.instance.getLookupBindingFields();\r\n            this.instance.personalConfigService.controlID = controlID;\r\n            this.instance.personalConfigService.personalConfigKey = pcstr;\r\n\r\n            const conf = {\r\n                displayType: this.instance.displayType,\r\n                singleSelect: this.instance.singleSelect,\r\n                idField: this.instance.idField,\r\n                textField: this.instance.textField,\r\n                mapFields: Object.assign({}, this.instance.mapFields || {})\r\n            };\r\n\r\n            this.instance.personalConfigService.initPersonalConf(conf);\r\n\r\n            // ä¸ªæ§åéç½®çè®¢éäºä»¶å¤ç\r\n            this.listenPersonalConfigHandler();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * çå¬æ¶èTABé¡µä¸­ç¸å³äºä»¶ï¼\r\n     * æ°æ®éä¸­ï¼åæ¶éä¸­ï¼ç§»é¤æ¶èï¼åå»äºä»¶\r\n     */\r\n    initFavoriteComponentEvent(cmpRef: ComponentRef<any>) {\r\n        switch (this.instance.displayType) {\r\n            case LookupGridDisplayType.NavList:\r\n            case LookupGridDisplayType.NavTreeList:\r\n            case LookupGridDisplayType.List: {\r\n                const fdt = cmpRef.instance as DataTableComponent;\r\n                fdt.remoteSort = false;\r\n                fdt.selectedRow.subscribe(e => {\r\n                    if (this.instance.singleSelect) {\r\n                        this.lookupSelectionSer.clearSelections();\r\n                    }\r\n                    this.lookupSelectionSer.updateSelections(e.data);\r\n                });\r\n                fdt.unSelectRow.subscribe(e => {\r\n                    this.lookupSelectionSer.unSelect(e.data[this.instance.idField]);\r\n                });\r\n\r\n                if (!fdt.singleSelect) {\r\n                    fdt.checkAll.subscribe(e => {\r\n                        this.lookupSelectionSer.updateSelections(fdt.data, e);\r\n                    });\r\n                }\r\n\r\n                fdt.cellClick.subscribe((e: any) => {\r\n                    if (e.col.field === FAVORITE_FIELD_NAME) {\r\n                        e.event.stopPropagation();\r\n                        // tslint:disable-next-line: no-string-literal\r\n                        const classList = e.event.target['classList'];\r\n                        if (classList.contains('f-lookup-unfavorite')) {\r\n                            if (this.instance.items) {\r\n                                this.instance.items.forEach(item => {\r\n                                    if (item[this.instance.idField] === e.row[this.instance.idField]) {\r\n                                        item[FAVORITE_FIELD_NAME] = false;\r\n                                    }\r\n                                });\r\n\r\n                                const dt = this.instance.componentRef.instance as DataTableComponent;\r\n                                if (dt) {\r\n                                    dt.loadData({\r\n                                        pageSize: this.instance.gridOptions.pageSize,\r\n                                        pageIndex: this.instance.gridOptions.pageIndex,\r\n                                        total: this.instance.gridOptions.total,\r\n                                        data: this.instance.gridOptions.items\r\n                                    });\r\n                                }\r\n                            }\r\n\r\n                            this.instance.favoriteItems =\r\n                                this.instance.favoriteItems.filter(n => n[this.instance.idField] !== e.row[this.instance.idField]);\r\n\r\n                            this.lookupSelectionSer.updateFavoriteData(e.row, FavoriteAction.delete);\r\n                        }\r\n                    }\r\n                });\r\n\r\n                // åå»äºä»¶\r\n                fdt.rowDblClick.subscribe((rowData: any) => {\r\n                    if (this.instance.gridOptions.singleSelect) {\r\n                        this.instance.selectItem(rowData);\r\n                    }\r\n                });\r\n                break;\r\n            }\r\n            case LookupGridDisplayType.TreeList: {\r\n                if (cmpRef) {\r\n                    const ftt = cmpRef.instance as TreeTableComponent;\r\n                    ftt.remoteSort = false;\r\n                    ftt.nodeSelected.subscribe(e => {\r\n                        if (this.instance.singleSelect) {\r\n                            this.lookupSelectionSer.clearSelections();\r\n                        }\r\n                        this.lookupSelectionSer.updateSelections(e.node.data);\r\n                    });\r\n                    ftt.nodeUnChecked.subscribe(e => {\r\n                        if (e.nodes && e.nodes.length) {\r\n                            this.instance.multiSelMgr.remove(e.nodes.map(n => n.id));\r\n                        } else if (e && e.node && e.node.data && e.node.data.id) {\r\n                            // const tt = this.instance.componentRef.instance as TreeTableComponent;\r\n                            // tt.unSelectNode(e.node.data.id);\r\n                            this.lookupSelectionSer.unSelect(e.node.data.id);\r\n                        }\r\n                    });\r\n\r\n                    ftt.nodeChecked.subscribe( e => {\r\n                        if (!this.instance.singleSelect) {\r\n                            if (e.nodes && e.nodes.length) {\r\n                                this.instance.multiSelMgr.updateSelections(e.nodes.map(n => n.data));\r\n                            } else {\r\n                                if (Array.isArray(e.node)) {\r\n                                    this.instance.multiSelMgr.updateSelections(e.node.map(n => n.data));\r\n                                } else {\r\n                                    this.instance.multiSelMgr.updateSelections([e.node.data]);\r\n                                }\r\n                            }\r\n                        }\r\n                    });\r\n\r\n                    ftt.cellClick.subscribe(row => {\r\n                        if (row.col.field === FAVORITE_FIELD_NAME) {\r\n                            row.event.stopPropagation();\r\n                            const classList = row.event.target['classList'];\r\n                            if (classList.contains('f-lookup-unfavorite')) {\r\n                                const _this = this.instance;\r\n                                (function every(items) {\r\n                                    if (!items) {\r\n                                        return;\r\n                                    }\r\n                                    let hasFinish = false;\r\n                                    items.forEach(item => {\r\n                                        if (hasFinish) {\r\n                                            return;\r\n                                        }\r\n                                        if (item.data[_this.idField] === row.node[_this.idField]) {\r\n                                            item.data[FAVORITE_FIELD_NAME] = false;\r\n                                            hasFinish = true;\r\n                                        } else if (item.children && item.children.length > 0) {\r\n                                            every(item.children);\r\n                                        }\r\n                                    });\r\n                                })(this.instance.items);\r\n                                const tt = this.instance.componentRef.instance as TreeTableComponent;\r\n                                tt.loadData(this.instance.items);\r\n\r\n                                this.lookupSelectionSer.updateFavoriteData(row.node.data, FavoriteAction.delete);\r\n                            }\r\n                        }\r\n                    });\r\n                    ftt.dblClick.subscribe((treeNode: TreeNode) => {\r\n                        if (this.instance.gridOptions.singleSelect && treeNode.selectable) {\r\n                            if (this.instance.okButton) {\r\n                                this.instance.okButton.nativeElement.click();\r\n                            }\r\n                        }\r\n                    });\r\n\r\n                    ftt.checkAll.subscribe( e => {\r\n                        const data = e.instance.checkeds.map(n => n.data);\r\n                        this.instance.multiSelMgr.updateSelections(data);\r\n                        this.instance.checkedChange.emit({ data, isCheck: true  });\r\n                    });\r\n                    ftt.unCheckAll.subscribe(() => {\r\n                        // this.instance.multiSelMgr.clear();\r\n                        const nodeItems = ftt.state.rowNodes.map(n => n.node.data);\r\n                        this.lookupSelectionSer.updateSelections(nodeItems, false);\r\n                        this.instance.checkedChange.emit({ data: [], isCheck: false  });\r\n                    });\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n    private getFavoritData() {\r\n        if (this.instance.personalConf) {\r\n            const favData = this.instance.personalConf.favorite;\r\n            const _data = (favData && favData[this.instance.localService.localeId]) ? favData[this.instance.localService.localeId] : [];\r\n            return _data;\r\n        }\r\n        return [];\r\n    }\r\n\r\n    getFavoritIds() {\r\n        return this.getFavoritData();\r\n    }\r\n\r\n    _loadFavoriteData(data = null) {\r\n        const fdt = this.instance.favoritesComponentRef.instance as DataTableComponent;\r\n        this.loadFavoriteDatatable(fdt, data);\r\n        fdt.cd.markForCheck();\r\n        this.instance.closeLoading();\r\n    }\r\n\r\n    // å è½½æ¶ègridæ°æ®\r\n    loadFavoritesData(res = null) {\r\n        const favIds = this.getFavoritIds();\r\n        switch (this.instance.displayType) {\r\n            case LookupGridDisplayType.NavList:\r\n            case LookupGridDisplayType.NavTreeList:\r\n            case LookupGridDisplayType.List: {\r\n                const fdt = this.instance.favoritesComponentRef.instance as DataTableComponent;\r\n                if (this.instance.favoriteDataFrom === 'locale') {\r\n                    if (res) {\r\n                        this._loadFavoriteData(res.items);\r\n                    } else {\r\n                        // this.instance.httpMgr.getFavoriteData(favIds).subscribe(resData => {\r\n                        //     if (resData) {\r\n                        //         this._loadFavoriteData(resData.items);\r\n                        //     }\r\n                        //     this.instance.closeLoading();\r\n                        // });\r\n                    }\r\n                } else {\r\n                    const favData = this.getFavoritData();\r\n                    this.loadFavoriteDatatable(fdt, res ? res.items : favData);\r\n                }\r\n                break;\r\n            }\r\n            case LookupGridDisplayType.TreeList: {\r\n                if (this.instance.favoritesComponentRef && this.instance.favoritesComponentRef.instance instanceof TreeTableComponent) {\r\n                    const ftt = this.instance.favoritesComponentRef.instance as TreeTableComponent;\r\n                    this.bindFavTreetable(ftt);\r\n\r\n                    if (this.instance.favoriteDataFrom === 'locale') {\r\n                        if (res) {\r\n                            this.loadFavoriteForTreeTable(res.items || [], ftt);\r\n                        } else {\r\n                            // this.instance.httpMgr.getFavoriteData(favIds).subscribe(resData => {\r\n                            //     if (resData) {\r\n                            //         const items = resData.items;\r\n                            //         this.loadFavoriteForTreeTable(items, ftt);\r\n                            //     }\r\n                            //     this.instance.closeLoading();\r\n                            // });\r\n                        }\r\n                    } else {\r\n                        if (res) {\r\n                            this.loadFavoriteForTreeTable(res.items, ftt);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    private loadFavoriteDatatable(fdt: DataTableComponent, data?: any) {\r\n        if (data !== undefined) {\r\n            this.instance.favoriteItems = data;\r\n        }\r\n\r\n        if (fdt.columns && !fdt.columns.length) {\r\n            fdt.columns = this.instance.favoriteColumns;\r\n        }\r\n\r\n        fdt.loadData({\r\n            total: 0,\r\n            pageSize: 20,\r\n            pageIndex: 1,\r\n            data: this.instance.favoriteItems\r\n        });\r\n\r\n\r\n        this.instance.selectionMgr.selectCurrentValue();\r\n        fdt.cd.detectChanges();\r\n    }\r\n\r\n\r\n    private bindFavTreetable(ftt: TreeTableComponent) {\r\n        ftt.allColumnsTitle = this.instance.allColumnsTitle;\r\n        ftt.idField = this.instance.idField;\r\n\r\n        const columns = this.instance.gridOptions.columns.map(item => {\r\n            const rtn: any = { ...item };\r\n            if (item.field === FAVORITE_FIELD_NAME) {\r\n                rtn.formatter = (v: any, data: any): any => {\r\n                    const favids = this.getFavoritIds();\r\n                    if (favids && favids.length) {\r\n                        const index = favids.findIndex(el => el === data[this.instance.idField]);\r\n                        if (index >= 0) {\r\n                            return FavoriteIcon.delete;\r\n                        }\r\n                    }\r\n                    return '';\r\n                };\r\n            }\r\n            return rtn;\r\n        });\r\n        this.instance.initColumnWidth(columns, 'fav');\r\n        this.instance.favoriteColumns = columns;\r\n        ftt.columns = columns;\r\n\r\n\r\n        if (this.instance.gridOptions.treeInfo) {\r\n            ftt.onlySelectLeaf = this.instance.gridOptions.treeInfo.onlySelectLeaf;\r\n        }\r\n\r\n        if (!ftt.singleSelect) {\r\n            ftt.checkOnSelect = true;\r\n            ftt.selectOnCheck = true;\r\n            ftt.showCheckbox = true;\r\n\r\n            // å¯ç¨å¤éåï¼åæ¶å¯ç¨çº§èéæ©\r\n            if (this.instance.enableCascade) {\r\n                this.instance.ttEventMgr.cascadeValueChanged(this.instance.cascadeStatus);\r\n            } else {\r\n                ftt.cascadeCheck = false;\r\n                ftt.cascadeDown = false;\r\n                ftt.cascadeUp = false;\r\n            }\r\n        }\r\n    }\r\n\r\n    private checkNodeIsLeaf(nodes: any ) {\r\n        if (nodes && nodes.length) {\r\n            return nodes.map((node: TreeNode) => {\r\n                if (node.hasOwnProperty(\"addtional\")) {\r\n                    node.selectable = !node[\"addtional\"];\r\n                }\r\n    \r\n                if (node.children && node.children.length) {\r\n                    this.checkNodeIsLeaf(node.children);\r\n                } else {\r\n                    node.leaf = true;\r\n                }\r\n    \r\n                return node;\r\n            });\r\n        }\r\n        return nodes;\r\n    }\r\n\r\n    initFavoriteTreeData(items) {\r\n        const treeInfo = this.instance.gridOptions.treeInfo;\r\n\r\n        if (treeInfo && !treeInfo['treeDataIsInit']) {\r\n            if (treeInfo.layerType.toLowerCase() === 'pathcode') {\r\n                items = this.instance.lookupUtils.makeTree(items, treeInfo);\r\n            } else {\r\n                items = this.instance.lookupUtils.makeTreeWithParentID(\r\n                    items,\r\n                    '',\r\n                    treeInfo.dataField ? `${treeInfo.dataField}.${treeInfo.parentField}`: treeInfo.parentField,\r\n                    this.instance.idField\r\n                );\r\n            }\r\n        }\r\n\r\n        // return this.instance.checkNodeCanBeSelect(items, true);\r\n        return this.checkNodeIsLeaf(items);\r\n    }\r\n\r\n    loadFavoriteForTreeTable(items, ftt: any) {\r\n        items = this.initFavoriteTreeData(items);\r\n        this.instance.favoriteItems = items;\r\n        ftt.loadData(items);\r\n        ftt.expandAll();\r\n        this.instance.selectionMgr.selectCurrentValue();\r\n\r\n        return items;\r\n    }\r\n\r\n    // æ´æ°åè¡¨ä¸­çæ¶èæ°æ®æ è¯\r\n    updateFavoritesStatus(data: any[]) {\r\n\r\n        if (!data || !this.instance.useFavorite) {\r\n            return;\r\n        }\r\n\r\n        const favIds = this.getFavoritIds();\r\n\r\n        if (favIds && favIds.length) {\r\n            // å¤çæ°æ®åè¡¨ä¸­çæ¶èæ°æ®æ è¯\r\n            if (this.instance.displayType !== LookupGridDisplayType.TreeList) {\r\n                data.map(item => {\r\n                    if (favIds && favIds.length && favIds.find(v => v === item[this.instance.idField])) {\r\n                        item[FAVORITE_FIELD_NAME] = true;\r\n                    }\r\n                });\r\n            } else {\r\n                const _this = this.instance;\r\n                (function each(_data) {\r\n                    _data.forEach(item => {\r\n                        if (favIds && favIds.length && favIds.find(v => v === item.data[_this.idField])) {\r\n                            item.data[FAVORITE_FIELD_NAME] = true;\r\n                        }\r\n                        if (item.children && item.children.length > 0) {\r\n                            each(item.children);\r\n                        }\r\n                    });\r\n                })(data);\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n    private _updateFavorites(value: any, action, data) {\r\n        const localeID = this.instance.localService.localeId;\r\n        this.instance.personalConf.favorite = this.instance.personalConf.favorite || {};\r\n        const items = value.filter(n => !n['_addtional_']);\r\n        const newVal = items.map(n => n[this.instance.idField]).filter(n => n !== null && n !== undefined);\r\n\r\n        const favItems = this.instance.personalConf.favorite[localeID] || [];\r\n        this.instance.personalConf.favorite[localeID] = Array.from(new Set([...favItems , ...newVal]));\r\n\r\n        if (action === FavoriteAction.delete && data) {\r\n            this.instance.personalConf.favorite[localeID] = this.instance.personalConf.favorite[localeID].filter(n => n !== data[this.instance.idField]);\r\n        }\r\n\r\n        return this.instance.personalConf.favorite[localeID];\r\n    }\r\n\r\n    // æ¶èæ°æ®ç®¡ç\r\n    private listenPersonalConfigHandler() {\r\n        this.lookupSelectionSer.favoriteItems$.subscribe(n => {\r\n            if (!this.instance.favoritesComponentRef) {\r\n                return;\r\n            }\r\n\r\n            const { items, action, data } = n;\r\n            const favids = this._updateFavorites(items, action, data);\r\n\r\n            this.instance.httpMgr.submitFavoriteData(action);\r\n\r\n            if (this.instance.displayType === LookupGridDisplayType.List || this.instance.displayType.includes('NAV')) {\r\n                const dt = this.instance.favoritesComponentRef.instance as DataTableComponent;\r\n                this.loadFavoriteDatatable(dt, items);\r\n            } else if (this.instance.displayType === LookupGridDisplayType.TreeList) {\r\n                const ftt = this.instance.favoritesComponentRef.instance as TreeTableComponent;\r\n                // const favids = items.map(d => d.id);\r\n                this.instance.showLoading();\r\n                this.instance.httpMgr.getData({ favoriteIds: favids }, 'fav').subscribe(resData => {\r\n                    if (resData) {\r\n                        const _items = resData.items;\r\n                        this.loadFavoriteForTreeTable(_items, ftt);\r\n                    } else {\r\n                        this.instance.favoriteItems = [];\r\n                        ftt.loadData([]);\r\n                    }\r\n                    this.instance.closeLoading();\r\n                });\r\n            }\r\n        });\r\n    }\r\n\r\n}\r\n","import { TreeTableComponent } from '@farris/ui-treetable';\r\nimport { LookupGridComponent } from '../lookup-grid.component';\r\n\r\n\r\nexport class SelectionManager {\r\n    constructor(private ins: LookupGridComponent) {\r\n\r\n    }\r\n\r\n    destroy() {\r\n    }\r\n\r\n    getBindingData() {\r\n        let jsonData = this.ins.bindingData;\r\n        if (\r\n            this.ins.ngControl &&\r\n            this.ins.ngControl.formDirective &&\r\n            this.ins.ngControl.formDirective.form &&\r\n            this.ins.ngControl.formDirective.form.bindingData\r\n        ) {\r\n            const bindingData = this.ins.ngControl.formDirective.form.bindingData;\r\n            jsonData = bindingData;\r\n\r\n            if (bindingData.getObject) {\r\n                jsonData = bindingData.getObject().toJSON();\r\n            }\r\n        }\r\n        return jsonData;\r\n    }\r\n\r\n    initDisplayValue() {\r\n        const jsonData = this.getBindingData();\r\n        if (jsonData && this.ins.mapFields) {\r\n            const idField = this.ins.idField;\r\n            let targetField = this.ins.mapFields[idField];\r\n\r\n            if (targetField) {\r\n                if (targetField.indexOf(',') > -1 ) {\r\n                    targetField = targetField.split(',')[0];\r\n                }\r\n\r\n                const val = this.ins.utils.getValue(targetField, jsonData);\r\n                if (val) {\r\n                    this.ins.displayValue = val;\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    private _clearSelections() {\r\n        const { cmpRefInstance: t } = this.getDataCmpInstance();\r\n        if (t) {\r\n            if (this.ins.isTree()) {\r\n                // æ è¡¨\r\n                t.clearAll(false);\r\n                if (!t.cdRef.destroyed) {\r\n                    t.cdRef.detectChanges();\r\n                }\r\n            } else {\r\n                // åè¡¨\r\n                t.dtBody.selectedRowIndex = -1;\r\n                t.dtBody.selections = undefined;\r\n                if (!t.cd.destroyed) {\r\n                    t.cd.detectChanges();\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * å¸®å©çªå£æå¼åï¼æ ¹æ® displayValue éä¸­æ°æ®\r\n     */\r\n    selectCurrentValue(selectedIds = []) {\r\n\r\n        if (!this.ins.enableToSelect) {\r\n            return;\r\n        }\r\n\r\n\r\n        const { cmpRefInstance: t, items } = this.getDataCmpInstance();\r\n        if (!t || !items || !items.length) {\r\n            return;\r\n        }\r\n\r\n        this._clearSelections();\r\n\r\n        if (!selectedIds || !selectedIds.length) {\r\n            const selectedRows = this.ins.lookupSelectionSer.getSelections();\r\n            if (selectedRows.length) {\r\n                selectedIds = selectedRows.map(n => n[this.ins.idField]);\r\n            }\r\n        }\r\n\r\n        // const _ids = this.getSelectedIds();\r\n        // selectedIds = selectedIds.concat(_ids);\r\n        // selectedIds = Array.from(new Set(selectedIds));\r\n\r\n        if (selectedIds && selectedIds.length) {\r\n            if (this.ins.isTree()) {\r\n                // æ è¡¨\r\n                this.selected4Treetable(t, selectedIds);\r\n                if (!t.cdRef.destroyed) {\r\n                    t.cdRef.detectChanges();\r\n                }\r\n            } else {\r\n                // åè¡¨\r\n                this.selected4Datatable(t, items, selectedIds);\r\n                if (!t.cd.destroyed) {\r\n                    t.cd.detectChanges();\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    private getDataCmpInstance() {\r\n        let ref = null;\r\n        let items = null;\r\n        if (this.ins.activeTab === 'datalist') {\r\n            if (this.ins.isTree()) {\r\n                ref = this.ins.lookupCmpMgr.getComponentInstance('treetable');\r\n                items = (ref as TreeTableComponent).serializedValue;\r\n            } else {\r\n                items = this.ins.items;\r\n                ref = this.ins.lookupCmpMgr.getComponentInstance();\r\n            }\r\n        } else if (this.ins.activeTab === 'favorite') {\r\n            ref = this.ins.lookupCmpMgr.getComponentInstance('fav');\r\n            items = this.ins.favoriteItems;\r\n        }\r\n        return { cmpRefInstance: ref, items };\r\n    }\r\n\r\n    private selected4Datatable(t: any, items: any, values: any) {\r\n        if (this.ins.singleSelect) {\r\n            items.forEach((item, index) => {\r\n                if (item[this.ins.idField] === values[0]) {\r\n                    if (!t.dtBody.isSelected(item)) {\r\n                        t.dtBody.selectedRowIndex = -1;\r\n                        t.dtBody.selectedRow('', index, item);\r\n                    }\r\n                }\r\n            });\r\n        } else {\r\n            // const values = this.getSelectedIds();\r\n            values.forEach(id => {\r\n                const r = items.find(n => n[this.ins.idField] == id);\r\n                if (r) {\r\n                    t.checkRow(id);\r\n                }\r\n            });\r\n        }\r\n    }\r\n\r\n    private selected4Treetable(t: any, valueArr: any) {\r\n        if (this.ins.singleSelect) {\r\n            t.selectNode(valueArr[0], false, false);\r\n        } else {\r\n            // const valueArr = this.getSelectedIds();\r\n            t.checkedNodes(valueArr, false, false, true);\r\n            t.selectNodes(valueArr);\r\n        }\r\n    }\r\n\r\n    getSelectedIds() {\r\n        let values = [];\r\n        const s = this.ins.multipleChoiceSeparator; // å¤éåéç¬¦\r\n        if (!this.ins.singleSelect && this.ins.displayValue && ('' + this.ins.displayValue).indexOf(s) > -1) {\r\n            values = this.ins.displayValue.split(s);\r\n        } else {\r\n            if (this.ins.displayValue !== null && this.ins.displayValue !== '' && this.ins.displayValue !== undefined) {\r\n                values = [this.ins.displayValue];\r\n            }\r\n        }\r\n\r\n        // // å¯ç¨æ¾ç¤ºå¤éåè¡¨\r\n        // if (this.ins.showSelected) {\r\n        //     const rows = this.ins.lookupSelectionSer.getSelections();\r\n        //     if (rows && rows.length) {\r\n        //         values = rows.map(n => n[this.ins.idField]);\r\n        //     }\r\n        // }\r\n\r\n        return values;\r\n    }\r\n}\r\n\r\n\r\n\r\n","import { DataTableComponent } from '@farris/ui-datatable';\r\nimport { of } from 'rxjs';\r\nimport { catchError, take, tap } from 'rxjs/operators';\r\nimport { FavoriteAction, FAVORITE_FIELD_NAME } from '../lookup-displaytype';\r\nimport { LookupGridResult } from '../lookup-grid-options';\r\nimport { LookupGridComponent } from '../lookup-grid.component';\r\nimport { LookupSelectionService } from './lookup-selection.service';\r\n\r\nexport class DataTableEventManager {\r\n\r\n    private lookupSelectionSer: LookupSelectionService;\r\n\r\n    private _sortState = null;\r\n\r\n    constructor(private ins: LookupGridComponent) {\r\n        this.lookupSelectionSer = this.ins.lookupSelectionSer;\r\n    }\r\n\r\n    conditionsChange(conditions) {\r\n        this.ins.conditions = conditions;\r\n        if (conditions && conditions.length === 1 && conditions[0].code == '*') {\r\n            this.ins.conditions = [];\r\n            this.onSearch({ field: '*', value: conditions[0].value });    \r\n        } else {\r\n            this.onSearch();\r\n        }\r\n    }\r\n\r\n    onSearch($event: { field: string; value: string } = { field: '*', value: '' }) {\r\n        if ($event && $event.field !== '*' && !$event.value) {\r\n            this.ins.messagerService.warning(this.ins.mustWriteSomething);\r\n            return;\r\n        }\r\n\r\n        const p = {\r\n            pageInfo: { pageIndex: 1, pageSize: this.ins.gridOptions.pageSize },\r\n            search: $event\r\n        };\r\n\r\n        if (this._sortState) {\r\n            const {sortName, sortOrder} = this._sortState;\r\n            if (sortName) {\r\n                p['sortName'] = sortName;\r\n                p['sortOrder'] = sortOrder;\r\n            }\r\n        }\r\n\r\n        if (this.ins.uri) {\r\n            if (!this.ins.searching) {\r\n                this.ins.searching = true;\r\n\r\n                if (this.ins['navNodePathCode']) {\r\n                    p['navNodePathCode'] = this.ins['navNodePathCode'];\r\n                }\r\n\r\n                this.ins.httpMgr.getData(p, 'list').pipe(\r\n                    catchError(err => {\r\n                        this.ins.searching = false;\r\n                        return of({ \"_ERROR_\": err });\r\n                    }),\r\n                    tap(() => {\r\n                        this.ins.searching = false;\r\n                    })\r\n                ).subscribe(\r\n                    data => {\r\n                        this.ins.searching = false;\r\n                        this.ins.closeLoading();\r\n                        if (!data['_ERROR_']) {\r\n                            this._loadData(data);\r\n                        } else {\r\n                            throw new Error(data['_ERROR_']);\r\n                        }\r\n                    }\r\n                );\r\n            }\r\n        } else {\r\n            if (this.ins.enableMultiFieldSearch) {\r\n                this.ins.query.emit({ conditions: this.ins.conditions, instance: this.ins })\r\n            } else {\r\n                this.ins.search.emit(p);\r\n            }\r\n        }\r\n    }\r\n\r\n    private _loadData(data: LookupGridResult) {\r\n        const self = this.ins;\r\n        self.closeLoading();\r\n        self.favHelper.updateFavoritesStatus(data.items);\r\n        self.loadDataTableData(data);\r\n        // éä¸­æ°æ®\r\n        this.ins.selectionMgr.selectCurrentValue();\r\n    }\r\n\r\n    bindDataTableEvent() {\r\n        const self = this.ins;\r\n        const dt = self.componentRef.instance as DataTableComponent;\r\n\r\n     \r\n        dt.selectedRow.subscribe((e: any) => {\r\n            if (this.ins.singleSelect) {\r\n                this.lookupSelectionSer.clearSelections();\r\n            }\r\n            this.ins.checkedChange.emit({ data: [e.data], isCheck: true });\r\n            this.lookupSelectionSer.updateSelections([e.data]);\r\n            dt.cd.detectChanges();\r\n        });\r\n    \r\n\r\n        dt.unSelectRow.subscribe(e => {\r\n            this.lookupSelectionSer.unSelect(e.data[self.idField]);\r\n            this.ins.checkedChange.emit({ data: [e.data], isCheck: false });\r\n        });\r\n\r\n        dt.checkAll.subscribe((e: boolean) => {\r\n            this.lookupSelectionSer.updateSelections(dt.data, e);\r\n            this.ins.checkedChange.emit({ data: dt.data, isCheck: e });\r\n        });\r\n\r\n        dt.pageChanged.subscribe((e: any) => {\r\n            if (self.uri) {\r\n                self.httpMgr.getData(e, 'list').subscribe((data: LookupGridResult) => {\r\n                    this._loadData(data);\r\n                });\r\n            } else {\r\n                self.pagerChanged.emit(self.httpMgr.buildQueryParams(e, 'list'));\r\n            }\r\n        });\r\n\r\n        dt.pageSizeChanged.subscribe(e => {\r\n            if (self.uri) {\r\n                self.httpMgr.getData(e, 'list').subscribe(\r\n                    data => {\r\n                        this._loadData(data);\r\n                    },\r\n                    err => {\r\n                        self.closeLoading();\r\n                    }\r\n                );\r\n            } else {\r\n                self.pagerChanged.emit(self.httpMgr.buildQueryParams(e, 'list'));\r\n            }\r\n        });\r\n\r\n        dt.search.subscribe((e: any) => {\r\n            // if (JSON.stringify(self._searchState || {}) !== JSON.stringify(e || {})) {\r\n            //     this.ins.searching = false;\r\n            // }\r\n            self._searchState = {...(e || {})};\r\n            this.onSearch(e);\r\n        });\r\n\r\n        dt.searchValueChange.subscribe((e: any) => {\r\n            if (e && e.value) {\r\n                self._searchState = {...e};\r\n            } else {\r\n                self._searchState = null;\r\n            }\r\n        });\r\n\r\n        // åå»äºä»¶\r\n        dt.rowDblClick.subscribe((rowData: any) => {\r\n            if (self.gridOptions.singleSelect) {\r\n                // this.lookupSelectionSer.updateSelections([rowData]);\r\n                self.selectItem(rowData);\r\n            }\r\n        });\r\n\r\n        // æ¶èäºä»¶\r\n        if(!dt.cellClick.observers.length) {\r\n            dt.cellClick.subscribe((e: any) => {\r\n                if (e.col.field === FAVORITE_FIELD_NAME) {\r\n                    const classList = e.event.target['classList'];\r\n                    if (classList.contains('f-lookup-favorite')) {\r\n                        e.event.stopPropagation();\r\n                        self.items.forEach(item => {\r\n                            const id = self.utils.getValue(self.idField, item);\r\n                            if (id === self.utils.getValue(self.idField, e.row)) {\r\n                                item[FAVORITE_FIELD_NAME] = !item[FAVORITE_FIELD_NAME];\r\n                            }\r\n                        });\r\n                        dt.loadData({\r\n                            pageSize: self.gridOptions.pageSize,\r\n                            pageIndex: self.gridOptions.pageIndex,\r\n                            total: self.gridOptions.total,\r\n                            data: self.gridOptions.items\r\n                        });\r\n\r\n                        // æ´æ°æ¶èæ°æ®\r\n                        const faction = e.row[FAVORITE_FIELD_NAME] ? FavoriteAction.add : FavoriteAction.delete;\r\n\r\n                        if (faction ===  FavoriteAction.add) {\r\n                            this.ins.favoriteItems = [...this.ins.favoriteItems, e.row];\r\n                        } else {\r\n                            this.ins.favoriteItems = this.ins.favoriteItems.filter(n => {\r\n                                return self.utils.getValue(self.idField, n) !== self.utils.getValue(self.idField, e.row);\r\n                            });\r\n                        }\r\n\r\n                        this.lookupSelectionSer.updateFavoriteData(e.row, faction);\r\n                    }\r\n                }\r\n            });\r\n        }\r\n\r\n        dt.columnSorted.subscribe((sort: { sortName: string; sortOrder: any }) => {\r\n\r\n            this._sortState = sort;\r\n\r\n            if (!this.ins.remoteSort) {\r\n                return;\r\n            }\r\n\r\n            const { sortName, sortOrder } = { ...sort };\r\n\r\n            const col = this.ins.columns.find(n => n.field === sortName);\r\n\r\n            const _sortName = col ? col.fieldPath ? col.fieldPath : col.field : sortName;\r\n\r\n            const param = {\r\n                sortName: _sortName,\r\n                sortOrder,\r\n                search: self._searchState,\r\n                pageInfo: {\r\n                    pageSize: self.pageSize,\r\n                    pageIndex: 1\r\n                }\r\n            };\r\n\r\n            self.httpMgr.getData(param, 'search').subscribe(d => {\r\n                self.loadDataTableData(d);\r\n                self.closeLoading();\r\n                // éä¸­æ°æ® TFS 615008\r\n                this.ins.selectionMgr.selectCurrentValue();\r\n            });\r\n        });\r\n\r\n        dt.clearSearchValue.subscribe(() => {\r\n            self._searchState = null;\r\n            this.onSearch();\r\n        });\r\n\r\n        dt.cellStyler = (val: any) => {\r\n            const { field } = val;\r\n            if (field === FAVORITE_FIELD_NAME) {\r\n                return {\r\n                    'text-overflow': 'unset'\r\n                };\r\n            }\r\n\r\n            return null;\r\n        }\r\n    }\r\n}\r\n\r\n","import { EMPTY, of } from 'rxjs';\r\nimport { switchMap } from 'rxjs/operators';\r\nimport { LookupGridResult, PickingResult } from '../lookup-grid-options';\r\n\r\n\r\n\r\n /** æ£æ¥å¸®å©è¾å¥æ¡å¼åååè¿åçæ¥è¯¢ç»æ */\r\nfunction checkSearchResult(data = null) {\r\n    if (this.searchOnServer) {\r\n        // this._searchResult = data;\r\n        // this.showDialog();\r\n        this.isShow = true;\r\n    } else {\r\n        if (data === false) {\r\n            this.cancelSelect();\r\n        } else {\r\n            this.setModelValue(this.displayText);\r\n            this.runDictPickedEvent(null);\r\n        }\r\n    }\r\n}\r\n\r\nexport function onTextChanged() {\r\n\r\n    const self = this;\r\n\r\n    const isPending = () => {\r\n        return this.lookupUtils.rts.getFormState('lookup.pending');\r\n    };\r\n\r\n    const searchData = (e) => {\r\n\r\n        if (this.isShow) {\r\n            return;\r\n        }\r\n\r\n        if (this.isTextChange && this.displayText && (!this.nosearch || e.originalEvent) && !isPending()) {\r\n            this.lookupUtils.pendingStart();\r\n\r\n            this.dictPickingSubscription = this.dictPicking({\r\n                instance: this\r\n            }).pipe(\r\n                switchMap((pr: PickingResult) => {\r\n                    let o = true;\r\n                    if (pr === undefined || pr === null) {\r\n                        o = true;\r\n                    }\r\n\r\n                    if (typeof pr === 'boolean') {\r\n                        o = pr;\r\n                    }\r\n\r\n                    if (typeof pr === 'object') {\r\n                        if (pr.showDialog === undefined) {\r\n                            o = true;\r\n                        } else {\r\n                            o = pr.showDialog;\r\n                        }\r\n\r\n                        if (pr.data) {\r\n                            /** ä¿å­å¸®å©åä¼ éçæ°æ® */\r\n                            this.customData = pr.data;\r\n                        }\r\n                    }\r\n\r\n                    if (o) {\r\n                        return this.httpMgr.getData(\r\n                            {\r\n                                search: {\r\n                                    field: '*',\r\n                                    value: this.displayText,\r\n                                    type: 'equal'\r\n                                }\r\n                            },\r\n                            'search'\r\n                        );\r\n                    } else {\r\n                        return of({ SHOWDIALOG: o, MESSAGE:  pr.message || '' });\r\n                    }\r\n                })\r\n            ).subscribe(\r\n                (data: any) => {\r\n                    this.closeLoading();\r\n                    this.lookupUtils.pendingEnd();\r\n                    if (data.hasOwnProperty('SHOWDIALOG')) {\r\n                        if (data.SHOWDIALOG && data.MESSAGE) {\r\n                            this.notifyService.warning(data.MESSAGE);\r\n                        }\r\n\r\n                        return;\r\n                    }\r\n\r\n                    if (data.items && data.items.length === 1 && (!data.items[0].children || !data.items[0].children.length)) {\r\n                        let rowdata = data.items[0];\r\n                        if (this.isTree()) {\r\n                            const leafNode = this.treeNodeHelper.getLeafNode(rowdata);\r\n\r\n                            let isOnlySelectLeaf = false;\r\n\r\n                            if (!this.treeInfo) {\r\n                                this.setTreeInfo(data);\r\n                            }\r\n\r\n                            if (typeof this.treeInfo.onlySelectLeaf === 'boolean' ) {\r\n                                isOnlySelectLeaf = this.treeInfo.onlySelectLeaf;\r\n                            } else if (typeof this.treeInfo.onlySelectLeaf === 'string') {\r\n                                if (this.treeInfo.onlySelectLeaf === 'yes') {\r\n                                    isOnlySelectLeaf = true;\r\n                                } else if (this.treeInfo.onlySelectLeaf === 'no') {\r\n                                    isOnlySelectLeaf = false;\r\n                                } else {\r\n                                    if (this.treeInfo.onlySelectLeaf === 'default') {\r\n                                        isOnlySelectLeaf = data.treeInfo.onlySelectLeaf;\r\n                                    }\r\n                                }\r\n                            }\r\n\r\n                            if (isOnlySelectLeaf && !leafNode.leaf) {\r\n                                // this.displayText = '';\r\n                                checkSearchResult.bind(self, data)();\r\n                                return;\r\n                            }\r\n                            \r\n\r\n                            if (Array.isArray(leafNode)) {\r\n                                checkSearchResult.bind(self, data)();\r\n                                return;\r\n                            } else {\r\n                                rowdata = leafNode.data;\r\n                            }\r\n                        }\r\n                        if (!this.singleSelect) {\r\n                            rowdata = [ rowdata ];\r\n                        }\r\n                        this.selectItem(rowdata);\r\n\r\n                        this.dialogClosed.emit();\r\n                    } else {\r\n                        checkSearchResult.bind(self, data)();\r\n                    }\r\n                }, (err: any) => {\r\n                    this.closeLoading();\r\n                    this.lookupUtils.pendingEnd();\r\n                    this.messagerService.error(err ? err.Message : err);\r\n                }\r\n            );\r\n        }\r\n    };\r\n\r\n    let inputBlurHandler = null;\r\n\r\n    if (this.inputGroup && this.inputGroup.textbox && !this.nosearch) {\r\n        this.lookupUtils.setActiveLookupInstance(this);\r\n        inputBlurHandler = this.render2.listen(this.inputGroup.textbox.nativeElement, 'blur', searchData );\r\n    }\r\n\r\n    if (this.inputGroup) {\r\n        this.inputGroup.enterHandle.subscribe( searchData);\r\n\r\n        this.inputGroup.keydownHandle.subscribe((e: any) => {\r\n            let canOpen = false;\r\n            if (e.code === 'ArrowRight') {\r\n\r\n                if (this.quickSelect && !this.quickSelect.enable) {\r\n                    this.writeConsole('å¯ç¨å¿«æ·éæ©åï¼å³æ¹åé®ç¦ç¨æå¼å¸®å©', 'warn');\r\n                    return;\r\n                }\r\n\r\n                if (this.editable) {\r\n                    canOpen = !e.target.value || e.target.selectionStart === e.target.value.length;\r\n                } else {\r\n                    canOpen = true;\r\n                }\r\n            } else {\r\n                canOpen = e.code === this.shortcutKey.open;\r\n            }\r\n            if (canOpen) {\r\n                e.stopPropagation();\r\n                e.preventDefault();\r\n                this.showDialog();\r\n            }\r\n        });\r\n    }\r\n\r\n    return inputBlurHandler;\r\n\r\n}\r\n","import { TreeTableComponent, TreeNode } from '@farris/ui-treetable';\r\nimport { FavoriteAction, FAVORITE_FIELD_NAME } from '../lookup-displaytype';\r\nimport { LOAD_DATA_TYPE, LookupGridResult } from '../lookup-grid-options';\r\nimport { cloneDeep } from 'lodash-es';\r\nimport { Observable, of, Subject } from 'rxjs';\r\nimport { LookupGridComponent } from '../lookup-grid.component';\r\nimport { take, tap, catchError } from 'rxjs/operators';\r\nimport { LookupSelectionService } from './lookup-selection.service';\r\nimport { FilterCondition } from '@farris/ui-common/types';\r\n\r\n\r\nexport class TreeTableEventManager {\r\n    private lookupSelectionSer: LookupSelectionService;\r\n    private _sortState = null;\r\n        /**\r\n     * æ è¯å½åæ°æ®æ¯å¦æ¥è¯¢ç»æ\r\n     */\r\n    private IS_SEARCH_RESULT = false;\r\n\r\n\r\n    constructor(private ins: LookupGridComponent) {\r\n        this.lookupSelectionSer = this.ins.lookupSelectionSer;\r\n    }\r\n\r\n    conditionsChange(conditions) {\r\n        this.ins.conditions = conditions;\r\n        if (this.ins.uri) {\r\n            if (conditions && conditions.length === 1 && conditions[0].code == '*') {\r\n                this.ins.conditions = [];\r\n                return this.searchTreeData({ field: '*', value: conditions[0].value });    \r\n            }\r\n            return this.searchTreeData({ field: '*', value: '' });\r\n        } else {\r\n            this.ins.query.emit({ conditions, instance: this.ins });\r\n        }\r\n    }\r\n\r\n    searchTreeData(search: { field: string; value: string }) {\r\n        const tt = this.ins.componentRef.instance as TreeTableComponent;\r\n        // å¤æ­uri ååºsearch.emit();\r\n        if (this.ins.searching) {\r\n            return;\r\n        } else {\r\n            this.ins.searching = true;\r\n        }\r\n\r\n        this.ins.showLoading();\r\n        if (tt&& tt.psRef && tt.psRef.directiveRef) {\r\n            tt.psRef.directiveRef.scrollToTop(0);\r\n        }\r\n        return this.ins.httpMgr.getData({ search, sortName: tt.sortName, sortOrder: tt.sortOrder }, 'search').pipe(\r\n            tap(() => {\r\n                this.ins.searching = false;\r\n            }),\r\n            catchError((err) => {\r\n                this.ins.searching = false;\r\n                return of(err);\r\n            })\r\n        ).subscribe(resData => {\r\n            this.ins.closeLoading();\r\n            if (resData) {\r\n                // this.ins.items = resData.items;\r\n                tt.clearAll();\r\n\r\n                const treeInfo = this.ins.gridOptions.treeInfo;\r\n                if (!treeInfo['treeDataIsInit']) {\r\n                    if (treeInfo.layerType.toLowerCase() === 'pathcode') {\r\n                        this.ins.items = this.ins.lookupUtils.makeTree(this.ins.items, treeInfo);\r\n                    } else {\r\n                        this.ins.items = this.ins.lookupUtils.makeTreeWithParentID(\r\n                            this.ins.items,\r\n                            '',\r\n                            treeInfo.dataField ? `${treeInfo.dataField}.${treeInfo.parentField}` : treeInfo.parentField,\r\n                            this.ins.idField\r\n                        );\r\n                    }\r\n                }\r\n\r\n\r\n                const checkNodes = (nodes): TreeNode[] => {\r\n                    if (nodes && nodes.length) {\r\n                        return nodes.map((node: TreeNode) => {\r\n                            if (node.hasOwnProperty('addtional')) {\r\n                                node.selectable = !node['addtional'];\r\n                            }\r\n\r\n                            if (node.children && node.children.length) {\r\n                                checkNodes(node.children);\r\n                            } else {\r\n                                if (this._isLoadAllTreeData(tt) && (!search || search.value === '' || search.value === undefined)) {\r\n                                    node.leaf = true;\r\n                                }\r\n                            }\r\n                            return node;\r\n                        });\r\n                    }\r\n                    return nodes;\r\n                };\r\n\r\n                const _nodes = checkNodes(resData.items);\r\n                if (_nodes && _nodes.length && _nodes[0].children && _nodes[0].children.length) {\r\n                    _nodes[0].expanded = true;\r\n                    _nodes[0].children = this.ins.expandFirstNode(_nodes[0].children);\r\n                }\r\n                this.ins.items = _nodes;\r\n\r\n\r\n                // å è½½æ¶èæ°æ®\r\n                if (this.ins.useFavorite) {\r\n                    // æ´æ°æ°æ®çæ¶èç¶æ\r\n                    this.ins.favHelper.updateFavoritesStatus(this.ins.items);\r\n                }\r\n\r\n                tt.loadData(this.ins.items);\r\n                // // å±å¼æ¥è¯¢ç»æã\r\n                // if (search.value && this.ins.items.length) {\r\n                //     tt.toggleExpand(this.ins.items[0], true);\r\n                // }\r\n                tt.resize();\r\n\r\n                this.IS_SEARCH_RESULT = true;\r\n\r\n                this.ins.selectionMgr.selectCurrentValue();\r\n            }\r\n\r\n            this.ins.search.emit(search);\r\n        });\r\n    }\r\n\r\n    private getChildren(\r\n        parentPath,\r\n        parentLayer,\r\n        searchData: { searchField: string; searchValue: string }\r\n    ): Observable<any> {\r\n        const uri = this.ins.gridOptions.uri;\r\n        const search = { parentLayer, category: 'children', ...searchData };\r\n        if (this.ins.treeInfo.layerType === 'parentId') {\r\n            search['parentId'] = parentPath;\r\n        } else {\r\n            search['parentPath'] = parentPath;\r\n        }\r\n        \r\n        const param: any = {\r\n            searchValue: '',\r\n            customData: this.ins.customData,\r\n            enableFullTree: this.ins.enableFullTree,\r\n            loadTreeDataType: this.ins.loadTreeDataType\r\n        };\r\n        \r\n        const tt = this.ins.componentRef.instance as TreeTableComponent;\r\n        if (tt && tt.sortName) {\r\n            Object.assign(search, {\r\n                sortName: tt.sortName,\r\n                sortOrder: tt.sortOrder\r\n            });\r\n           \r\n        }\r\n\r\n        if (this.IS_SEARCH_RESULT) {\r\n            param.enableFullTree = false;\r\n            param.loadTreeDataType = 'layerload';\r\n\r\n            if (this.ins.treeInfo.layerType === 'parentId') {\r\n                // æ å½¢å¸®å©æ¥è¯¢åï¼å±å¼èç¹æ¶å°ç¸å³æ¥è¯¢åæ°ä¼ éå°åç«¯ 2022-09-13\r\n                search.searchValue = '';\r\n                search.searchField = '*';\r\n            }\r\n            // param.searchValue = JSON.stringify(search);\r\n        }\r\n\r\n        param.searchValue = JSON.stringify(search);\r\n\r\n        if (this.ins.helpId) {\r\n            param['helpId'] = this.ins.helpId;\r\n        }\r\n       \r\n\r\n        if (this.ins.conditions && this.ins.conditions.length) {\r\n            param.searchConditions = cloneDeep(this.ins.conditions);\r\n        }\r\n       \r\n        return this.ins.http.getData(uri, param);\r\n    }\r\n\r\n\r\n    private _isLoadAllTreeData = (tt) => {\r\n        if (this.ins.loadTreeDataType === 'default') {\r\n            return tt.loadDataType === 'all';\r\n        } else {\r\n            return this.ins.loadTreeDataType === 'loadall';\r\n        }\r\n    };\r\n\r\n    private _isAsyncLoadTreeData = (tt) => {\r\n        if (this.ins.loadTreeDataType === 'default') {\r\n            return tt.loadDataType === 'async';\r\n        } else {\r\n            return this.ins.loadTreeDataType === 'layerload';\r\n        }\r\n    };\r\n\r\n\r\n    bindTreetableEvent() {\r\n        const tt = this.ins.componentRef.instance as TreeTableComponent;\r\n        const _searchTreeData = (searchparam: any) => {\r\n            if (this.ins.remoteSearch) {\r\n                this.ins._searchState = searchparam;\r\n                this.searchTreeData(searchparam);\r\n            } else {\r\n                if (this.ins.useInsideSearchHandler) {\r\n                    tt.searchHandle.search(searchparam.field, searchparam.value, 'client');\r\n                } else {\r\n                    this.ins.search.emit(searchparam);\r\n                }\r\n            }\r\n        };\r\n\r\n        const isLoadAllTreeData = () => {\r\n            return this._isLoadAllTreeData(tt);\r\n        };\r\n\r\n        const isAsyncLoadTreeData = () => {\r\n            return this._isAsyncLoadTreeData(tt);\r\n        };\r\n\r\n        tt.dblClickExpand = !this.ins.singleSelect; // ç¦ç¨åå»å±å¼èç¹\r\n        tt.allColumnsTitle = this.ins.allColumnsTitle; // this.displayInfo.allColumns;\r\n        tt.idField = this.ins.idField;\r\n        tt.columns = this.ins.columns;\r\n        tt.searchFields = this.ins.gridOptions.searchFields;\r\n        if (this.ins.treeInfo) {\r\n            tt.loadDataType = this.ins.treeInfo.loadDataType;\r\n            tt.virtualized = true;\r\n            if (!this.ins.isTextChange) {\r\n                this.ins.allData = cloneDeep(this.ins.items);\r\n            } else {\r\n                this.ins.allData = [];\r\n            }\r\n        }\r\n\r\n        if (this.ins.gridOptions.treeInfo) {\r\n            tt.onlySelectLeaf = this.ins.gridOptions.treeInfo.onlySelectLeaf;\r\n            tt.loadDataType = this.ins.gridOptions.treeInfo.loadDataType;\r\n        }\r\n\r\n        if (!tt.singleSelect) {\r\n            tt.checkOnSelect = true;\r\n            tt.selectOnCheck = true;\r\n            tt.showCheckbox = true;\r\n            tt.showCheckAll =  this.ins.showCheckAll;\r\n            // å¯ç¨å¤éåï¼åæ¶å¯ç¨çº§èéæ©\r\n            if (this.ins.enableCascade) {\r\n                this.cascadeValueChanged(this.ins.cascadeStatus);\r\n            } else {\r\n                tt.cascadeCheck = false;\r\n                tt.cascadeDown = false;\r\n                tt.cascadeUp = false;\r\n            }\r\n        }\r\n\r\n        tt.enableFindText = this.ins.enableFindText;\r\n        // tt.findField = this.textField;\r\n        tt.nodeSelected.subscribe((e: any) => {\r\n            // if (this.ins.favoritesComponentRef && this.ins.singleSelect) {\r\n            //     const ftt = this.ins.favoritesComponentRef.instance as TreeTableComponent;\r\n            //     ftt.clearSelections();\r\n            // }\r\n            if (this.ins.singleSelect) {\r\n                this.lookupSelectionSer.clearSelections();\r\n            }\r\n            this.lookupSelectionSer.updateSelections([e.node.data]);\r\n            this.ins.checkedChange.emit({ data: [e.node.data] , isCheck: true  });\r\n        });\r\n\r\n        tt.nodeChecked.subscribe( e => {\r\n            if (!this.ins.singleSelect) {\r\n                let data = null;\r\n                if (e.nodes && e.nodes.length) {\r\n                    data = e.nodes.map(n => n.data);\r\n                } else {\r\n                    if (Array.isArray(e.node)) {\r\n                        data = e.node.map(n => n.data);\r\n                    } else {\r\n                        data = [e.node.data];\r\n                    }\r\n                }\r\n                this.ins.multiSelMgr.updateSelections(data);\r\n                this.ins.checkedChange.emit({ data, isCheck: true  });\r\n            }\r\n        });\r\n\r\n        tt.nodeUnChecked.subscribe((e: any) => {\r\n            if (e && e.node) {\r\n                let nodeData = null;\r\n                if (e.node.data) {\r\n                    nodeData = e.node.data;\r\n                } else {\r\n                    if (e.node.node && e.node.node.data) {\r\n                        nodeData = e.node.node.data;\r\n                    }\r\n                }\r\n\r\n                if (!nodeData) {\r\n                    return;\r\n                }\r\n\r\n                if (!this.ins.singleSelect) {\r\n                    this.ins.multiSelMgr.remove(e.node.id);\r\n\r\n                    // åå±å è½½ï¼å¤éï¼åå«ä¸çº§æ¶ï¼åæ¶å¾é éè¦å°å½åèç¹çææå­çº§æ°æ®ä¹è¦åæ¶éæ©ï¼å³ä»å·²éè®°å½ä¸­ç§»é¤\r\n                    if (tt.loadDataType !== 'all' && this.ins.treeInfo.layerType === 'pathcode' && this.ins.enableCascade &&\r\n                        (this.ins.cascadeStatus === 'enable' || this.ins.cascadeStatus === 'down')) {\r\n                        if (e.node.children && e.node.children.length) {\r\n                            const nodes = e.node.children.map(n => n.data);\r\n                            this.ins.lookupSelectionSer.updateSelections(nodes, false);\r\n                        } else {\r\n                            const pathcode = this.ins.getPathCode(nodeData, this.ins.treeInfo)\r\n                            this.ins.lookupSelectionSer.unselectByPathcode(pathcode);\r\n                        }\r\n                    }\r\n\r\n                    if (e.nodes && e.nodes.length) {\r\n                        this.ins.multiSelMgr.remove(e.nodes.map(n => n.id));\r\n                        this.ins.checkedChange.emit({ data: e.nodes.map(n => n.data), isCheck: false });\r\n                    } else {\r\n                        this.ins.checkedChange.emit({ data: [nodeData], isCheck: false });\r\n                    }\r\n                } else {\r\n                    const ftt = this.ins.favoritesComponentRef && (this.ins.favoritesComponentRef.instance as TreeTableComponent);\r\n                    if (ftt && ftt.findRowNode(e.node.id)) {\r\n                        ftt.unSelectNode(e.node.id);\r\n                    }\r\n\r\n                    this.ins.checkedChange.emit({ data: [nodeData], isCheck: false });\r\n                }\r\n            }\r\n        });\r\n\r\n        tt.checkAll.subscribe( e => {\r\n            const data = e.instance.checkeds.map(n => n.data);\r\n            this.ins.multiSelMgr.updateSelections(data);\r\n            this.ins.checkedChange.emit({ data, isCheck: true  });\r\n        });\r\n        tt.unCheckAll.subscribe(() => {\r\n            this.ins.multiSelMgr.clear();\r\n            this.ins.checkedChange.emit({ data: [], isCheck: false  });\r\n        });\r\n\r\n        tt.search.subscribe(searchparam => {\r\n            if (searchparam.field !== '*' && !searchparam.value) {\r\n                this.ins.messagerService.warning(this.ins.mustWriteSomething);\r\n            } else {\r\n                searchparam.value = searchparam.value.trim();\r\n                _searchTreeData(searchparam);\r\n            }\r\n        });\r\n        if (!tt.cellClick.observers.length) {\r\n            tt.cellClick.subscribe((e: any) => {\r\n                if (e.col.field === FAVORITE_FIELD_NAME) {\r\n                    e.event.stopPropagation();\r\n                    // tslint:disable-next-line: no-string-literal\r\n                    const classList = e.event.target['classList'];\r\n                    if (classList.contains('f-lookup-favorite')) {\r\n                        // classList.toggle('f-icon-star');\r\n                        // classList.toggle('f-icon-star-outline');\r\n                        const _this = this.ins;\r\n\r\n                        (function each(arr) {\r\n                            if (arr) {\r\n                                arr.forEach(item => {\r\n                                    const id = _this.utils.getValue(_this.idField, item.data);\r\n                                    if (id === e.node.id) {\r\n                                        item.data[FAVORITE_FIELD_NAME] = !item.data[FAVORITE_FIELD_NAME];\r\n                                        return true;\r\n                                    } else if (item.children && item.children.length > 0) {\r\n                                        return each(item.children);\r\n                                    } else {\r\n                                        return false;\r\n                                    }\r\n                                });\r\n                            }\r\n                        })(this.ins.items);\r\n                        tt.loadData(this.ins.items);\r\n\r\n                        // æ´æ°æ¶èæ°æ®\r\n                        this.lookupSelectionSer.updateFavoriteData( e.node.data,\r\n                            e.node.data[FAVORITE_FIELD_NAME] ? FavoriteAction.add : FavoriteAction.delete);\r\n                    }\r\n                }\r\n            });\r\n        }\r\n        tt.dblClick.subscribe((treeNode: TreeNode) => {\r\n            if (this.ins.gridOptions.singleSelect && treeNode.selectable) {\r\n                if (this.ins.okButton) {\r\n                    // this.lookupSelectionSer.select(treeNode.data);\r\n                    // this.ins.okButton.nativeElement.click();\r\n                    this.ins.selectItem(treeNode.data);\r\n                }\r\n            }\r\n        });\r\n        const loadAllData = isLoadAllTreeData();\r\n        tt.columnSorted.subscribe((sort: { sortName: string; sortOrder: any; }) => {\r\n            this._sortState = sort;\r\n            if (isLoadAllTreeData()) {\r\n                tt.clientSort();\r\n            } else {\r\n                const { sortName, sortOrder } = { ...sort };\r\n\r\n                const col = this.ins.columns.find(n => n.field === sortName);\r\n                const _sortName = col ? col.fieldPath ? col.fieldPath : col.field : sortName;\r\n\r\n                const param = Object.assign({ sortName: _sortName, sortOrder }, { search: this.ins._searchState });\r\n\r\n                let reqTyp: LOAD_DATA_TYPE = 'all';\r\n                if (this.ins._searchState && this.ins._searchState.value) {\r\n                    reqTyp = 'search';\r\n                }\r\n\r\n                this.ins.httpMgr.getData(param, reqTyp).subscribe(d => {\r\n                    this.ins.closeLoading();\r\n                    tt.clearAll();\r\n                    const items = this.ins.checkNodeCanBeSelect(d.items, false);\r\n                    if (this.ins.useFavorite) {\r\n                        this.ins.favHelper.updateFavoritesStatus(items);\r\n                    }\r\n                    this.ins.items = items;\r\n                    tt.loadData(items);\r\n                    tt.resize();\r\n                    this.ins.selectionMgr.selectCurrentValue();\r\n                });\r\n            }\r\n        });\r\n\r\n        tt.clearSearchValue.subscribe(() => {\r\n            if (tt&& tt.psRef && tt.psRef.directiveRef) {\r\n                tt.psRef.directiveRef.scrollToTop(0);\r\n            }\r\n\r\n            this.ins._searchState = null;\r\n            this.IS_SEARCH_RESULT = false;\r\n            let _items = [];\r\n            if (this.ins.allData && this.ins.allData.length) {\r\n                _items = this.ins.checkNodeCanBeSelect(this.ins.allData, loadAllData);\r\n            }\r\n            if (!_items || !_items.length) {\r\n                _searchTreeData({ field: '*', value: '' });\r\n            } else {\r\n                this.ins.items = _items;\r\n                this.ins.favHelper.updateFavoritesStatus(this.ins.items);\r\n                tt.loadData(_items);\r\n                this.ins.selectionMgr.selectCurrentValue();\r\n            }\r\n        });\r\n\r\n        tt.expand.subscribe((tn: TreeNode) => {\r\n            if (tn.leaf ||  tn['showLoading']) {\r\n                return;\r\n            }\r\n            if (!tn.children || !tn.children.length) {\r\n                const treeInfo = this.ins.gridOptions.treeInfo;\r\n                if (isAsyncLoadTreeData() || this.IS_SEARCH_RESULT ) {\r\n                    let parentPath = '';\r\n                    let parentLayer = -1;\r\n                    const { field = '*', value = '' } = {\r\n                        ...tt.searchData\r\n                    };\r\n\r\n                    tn['showLoading'] = true;\r\n                    tt.detectChanges();\r\n                    if (treeInfo.layerType === 'parentId') {\r\n                        // ç¶IDå è½½æ¹å¼\r\n                        parentPath = tn['id'];\r\n                    } else {\r\n                        const treeInfoField = treeInfo.dataField;\r\n                        if (treeInfoField) {\r\n                            // parentPath = tn.data[treeInfoField][treeInfo.pathField];\r\n                            parentPath = this.ins.getPathCode(tn.data, treeInfo);\r\n                            // parentLayer = tn.data[treeInfoField][treeInfo.layerField];\r\n                            parentLayer = this.ins.getLayerData(tn.data, treeInfo);\r\n                        } else {\r\n                            this.ins.writeConsole('æªæ¾å°åçº§ä¿¡æ¯ã');\r\n                        }\r\n                    }\r\n\r\n                    if (!this.ins.uri) {\r\n                        tn['showLoading'] = false;\r\n                        this.ins.expandTreeNode.emit({\r\n                            instance: tt, node: tn,\r\n                            parentIdOrPath: parentPath, parentLayer, search: { value, field }\r\n                        });\r\n\r\n                        return;\r\n                    }\r\n\r\n                    this.ins.showLoading();\r\n\r\n                    this.getChildren(parentPath, parentLayer, {\r\n                        searchField: field === '*' ? '*' : field,\r\n                        searchValue: value\r\n                    }).subscribe(data => {\r\n                        this.ins.closeLoading();\r\n                        if (tt) {\r\n                            if (tn && data.items && data.items.length) {\r\n                                if (this.ins.useFavorite) {\r\n                                    // æ´æ°å­èç¹æ¶èç¶æ\r\n                                    this.ins.favHelper.updateFavoritesStatus(data.items);\r\n                                }\r\n\r\n                                const nodes = this.ins.checkNodeCanBeSelect(data.items, false);\r\n\r\n                                tt.appendChildren(nodes, tn);\r\n\r\n                                if (tt.loadDataType !== 'all' && !this.ins.singleSelect && this.ins.isGetAllChidlNodes &&\r\n                                    (this.ins.cascadeStatus === 'enable' || this.ins.cascadeStatus === 'down') ) {\r\n                                    const rn = tt.findRowNode(tn.id);\r\n                                    tt.propagateSelectionDown(rn, rn.isChecked);\r\n\r\n                                    // æ´æ°éä¸­è®°å½ç¼å­\r\n                                    const _items = data.items.filter(n => !n.addtional);\r\n                                    if (_items && _items.length) {\r\n                                        this.ins.lookupSelectionSer.updateSelections(_items.map(n => n.data), rn.isChecked);\r\n                                    }\r\n                                }\r\n                            }\r\n                            tn['showLoading'] = false;\r\n                            tt.detectChanges();\r\n                            tt.psRef.directiveRef.update();\r\n                            this.ins.selectionMgr.selectCurrentValue();\r\n                        }\r\n                    });\r\n                }\r\n            } else {\r\n                if (!this.ins.singleSelect && this.ins.enableCascade &&\r\n                        (this.ins.cascadeStatus === 'enable' || this.ins.cascadeStatus === 'down') && this.ins.isGetAllChidlNodes ) {\r\n                    const rn = tt.findRowNode(tn.id);\r\n                    tt.propagateSelectionDown(rn, rn.isChecked);\r\n                    const selectItems = tn.children.filter(n => n.selectable).map(n => n.data);\r\n                    this.ins.lookupSelectionSer.updateSelections(selectItems, rn.isChecked);\r\n                }\r\n                // this.ins.selectionMgr.selectCurrentValue();\r\n            }\r\n        });\r\n\r\n        if (loadAllData && this.ins.items) {\r\n            this.ins.treeNodeHelper.updateTreeNodeExpanded(this.ins.items);\r\n        }\r\n        return loadAllData;\r\n    }\r\n\r\n    cascadeValueChanged($event) {\r\n        const val = $event;\r\n        // const tt = this.ins.componentRef.instance as TreeTableComponent;\r\n        const instanceTyp = this.ins.activeTab === 'datalist' ? 'treetable' : 'fav';\r\n        const tt = this.ins.lookupCmpMgr.getComponentInstance(instanceTyp) as TreeTableComponent;\r\n\r\n        if (!tt) {\r\n            return;\r\n        }\r\n\r\n        switch (val) {\r\n            case 'enable':\r\n                tt.cascadeCheck = true;\r\n                tt.cascadeDown = true;\r\n                tt.cascadeUp = true;\r\n                break;\r\n            case 'disable':\r\n                tt.cascadeCheck = false;\r\n                tt.cascadeDown = false;\r\n                tt.cascadeUp = false;\r\n                break;\r\n            case 'up':\r\n                tt.cascadeCheck = true;\r\n                tt.cascadeUp = true;\r\n                tt.cascadeDown = false;\r\n                break;\r\n            case 'down':\r\n                tt.cascadeCheck = true;\r\n                tt.cascadeDown = true;\r\n                tt.cascadeUp = false;\r\n                break;\r\n            default:\r\n                tt.cascadeCheck = true;\r\n                tt.cascadeDown = true;\r\n                tt.cascadeUp = true;\r\n                break;\r\n        }\r\n\r\n        this.ins.cascadeStatus = val || 'enable';\r\n        this.ins.personalConf.cascadeStatus = val || 'enable';\r\n    }\r\n\r\n}\r\n","import { TreeTableComponent } from '@farris/ui-treetable';\r\nimport { FavoriteIcon, FAVORITE_FIELD_NAME } from '../lookup-displaytype';\r\nimport { LookupGridComponent } from '../lookup-grid.component';\r\nimport { cloneDeep } from 'lodash-es';\r\nimport { DataTableComponent } from '@farris/ui-datatable';\r\n\r\nexport class MultiSelectionManager {\r\n    constructor(private ins: LookupGridComponent) {}\r\n\r\n    onSelectedTableCellClick(e: any) {\r\n        if (e.col.field === FAVORITE_FIELD_NAME) {\r\n            e.event.stopPropagation();\r\n            const classList = e.event.target['classList'];\r\n            if (classList.contains('f-lookup-unfavorite') || classList.contains('f-icon-minus-circle')) {\r\n                const rid =  e.row[this.ins.idField];\r\n                this.ins.lookupSelectionSer.unSelect(rid);\r\n                // åæ¶éä¸­ ä¸»åè¡¨ æ¶èåè¡¨ ä¸­çæ°æ®\r\n                if (this.ins.isTree()) {\r\n                    const tt = this.ins.lookupCmpMgr.getComponentInstance('treetable') as TreeTableComponent;\r\n                    tt.unCheckedNode(rid);\r\n                    tt.unSelectNode(rid);\r\n\r\n                    if (this.ins.useFavorite) {\r\n                        const _tt = this.ins.lookupCmpMgr.getComponentInstance('fav') as TreeTableComponent;\r\n                        if (_tt && _tt.data && _tt.data.length && _tt.findRowNode(rid)) {\r\n                            _tt.unCheckedNode(rid);\r\n                            _tt.unSelectNode(rid);\r\n                        }\r\n                    }\r\n                } else {\r\n                    const dt = this.ins.lookupCmpMgr.getComponentInstance() as DataTableComponent;\r\n                    dt.unCheckRow(rid);\r\n                    if (this.ins.useFavorite) {\r\n                        const _dt = this.ins.lookupCmpMgr.getComponentInstance('fav') as DataTableComponent;\r\n                        if (_dt && _dt.data && _dt.data.length) {\r\n                            _dt.unCheckRow(rid);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    /** åå§åå·²éæ°æ®åä¿¡æ¯ */\r\n    initSelectedColumns() {\r\n        let selectedColumns = [];\r\n        if (this.ins.showSelected && !this.ins.singleSelect) {\r\n            selectedColumns = cloneDeep(this.ins.gridOptions.columns);\r\n            const favcol = selectedColumns.find(n => n.field === FAVORITE_FIELD_NAME);\r\n            if (favcol) {\r\n                favcol.formatter = () => {\r\n                    return FavoriteIcon.remove;\r\n                };\r\n            } else {\r\n                selectedColumns = selectedColumns.concat([\r\n                    { field: FAVORITE_FIELD_NAME, width: 80, formatter: () => {\r\n                            return FavoriteIcon.remove;\r\n                        }\r\n                    }\r\n                ]);\r\n            }\r\n            this.ins.initColumnWidth(selectedColumns, 'sel');\r\n        }\r\n\r\n        return selectedColumns;\r\n    }\r\n\r\n    updateSelections(data) {\r\n        if (Array.isArray(data)) {\r\n            this.ins.lookupSelectionSer.updateSelections(data, true);\r\n        } else {\r\n            this.ins.lookupSelectionSer.select(data);\r\n        }\r\n    }\r\n\r\n    remove(id: any) {\r\n        if (id) {\r\n            this.ins.lookupSelectionSer.unSelect(id);\r\n        }\r\n    }\r\n\r\n    deleteSelectedItems(data: any) {\r\n        if (!data || !data.length) {return;}\r\n        this.ins.lookupSelectionSer.updateSelections(data, false);\r\n\r\n        if (!this.ins.isShow) {return;}\r\n        const ids = data.map(n => n[this.ins.idField]);\r\n        if (this.ins.isTree()) {\r\n            const tt = this.ins.lookupCmpMgr.getComponentInstance('treetable') as TreeTableComponent;\r\n            tt&& tt.unCheckedAndSelected(ids);\r\n\r\n            if (this.ins.useFavorite) {\r\n                const _tt = this.ins.lookupCmpMgr.getComponentInstance('fav') as TreeTableComponent;\r\n                _tt && _tt.unCheckedNodes(ids, true, false);\r\n            }\r\n\r\n        } else {\r\n            const dt = this.ins.lookupCmpMgr.getComponentInstance() as DataTableComponent;\r\n            dt && dt.unCheckRows(ids);\r\n            if (this.ins.useFavorite) {\r\n                const _dt = this.ins.lookupCmpMgr.getComponentInstance('fav') as DataTableComponent;\r\n                _dt && _dt.unCheckRows(ids);\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n    clear() {\r\n        this.ins.lookupSelectionSer.clearSelections();\r\n\r\n        if (!this.ins.isShow) {return;}\r\n\r\n        if (this.ins.isTree()) {\r\n            const tt = this.ins.lookupCmpMgr.getComponentInstance('treetable') as TreeTableComponent;\r\n            tt&&tt.clearAll();\r\n\r\n            if (this.ins.useFavorite) {\r\n                const _tt = this.ins.lookupCmpMgr.getComponentInstance('fav') as TreeTableComponent;\r\n                _tt&&_tt.clearAll();\r\n            }\r\n\r\n        } else {\r\n            const dt = this.ins.lookupCmpMgr.getComponentInstance() as DataTableComponent;\r\n            dt&&dt.clearSelections();\r\n            if (this.ins.useFavorite) {\r\n                const _dt = this.ins.lookupCmpMgr.getComponentInstance('fav') as DataTableComponent;\r\n                _dt&&_dt.clearSelections();\r\n            }\r\n        }\r\n    }\r\n\r\n    save(rows: any) {\r\n        if (this.ins.showSelected) {\r\n            this.ins.personalConf.selections = rows;\r\n            this.ins.personalConfigService.savePersonalConfig(this.ins.personalConf);\r\n        }\r\n    }\r\n\r\n    loadData() {\r\n        let items = this.ins.personalConf ? (this.ins.personalConf.selections || []) : [];\r\n        if (!items.length) {\r\n            items = this.ins.lookupSelectionSer.getSelections();\r\n        }\r\n        this.ins.lookupSelectionSer.loadSelections(items);\r\n    }\r\n}\r\n","import { RemoteParams, SearchParam, UserFavoriteData } from '../http/RemoteParams';\r\nimport { LOAD_DATA_TYPE } from '../lookup-grid-options';\r\nimport { LookupGridComponent } from '../lookup-grid.component';\r\nimport { cloneDeep } from 'lodash-es';\r\nimport { FavoriteAction, FAVORITE_FIELD_NAME, LookupGridDisplayType } from '../lookup-displaytype';\r\nimport { Observable, of, forkJoin } from 'rxjs';\r\nimport { map, switchMap, tap, debounceTime } from 'rxjs/operators';\r\n\r\n// å¸®å©é»è®¤ä¸ªæ§åæ°æ®\r\nconst DefaultUserConfig = {\r\n    tabIndex: 'datalist',\r\n    favorite: null,\r\n    size: null\r\n};\r\nexport class LookupHttpManager {\r\n    // æ¯æ¬¡å¸®å©æå¼åï¼æ´æ°æ­¤å¼ï¼åä¸ºä¸ªæ§åæ°æ®çåå§å¼ï¼\r\n    // å³é­çªå£æ¶ï¼ä¸æ­¤è¿è¡å¯¹æ¯ãå¦æä¸æ ·ï¼åä¸ä¿å­ï¼\r\n    private _originalPersonalConfig = DefaultUserConfig;\r\n\r\n    constructor(private ins: LookupGridComponent) { }\r\n\r\n    private disablePagination() {\r\n        return {\r\n            pageIndex: 1,\r\n            pageSize: 500\r\n        };\r\n    }\r\n\r\n    /** æé æ¥è¯¢åæ° */\r\n    buildQueryParams(event?: any, type: LOAD_DATA_TYPE = 'all') {\r\n        const params: RemoteParams = {};\r\n\r\n        if (event.navConditions && event.navConditions.length) {\r\n            if (event.navConditions && event.navConditions.length === 1 && event.navConditions[0].code == '*') {\r\n                event.search = { field: '*', value: event.navConditions[0].value};\r\n            } else {\r\n                params.navSearchConditions = event.navConditions;\r\n            }\r\n        }\r\n\r\n        if (this.ins.conditions && this.ins.conditions.length && type !== 'fav') {\r\n            params.searchConditions = cloneDeep(this.ins.conditions);\r\n        }\r\n\r\n        const searchParam: SearchParam = { category: type };\r\n\r\n        if (type !== 'fav') {\r\n            if (this.ins.isDoublleList() && this.ins.navigationFilter && type !== 'all') {\r\n                if (this.ins.navigationFilter.idValue && type !== 'textchange') {\r\n                    params.relationFilter = [...this.ins.navigationFilter.idValue];\r\n                }\r\n            }\r\n        }\r\n\r\n        if (event) {\r\n            if (type === 'fav' || type === 'selected') {\r\n                event.pageInfo = this.disablePagination();\r\n            }\r\n\r\n            if (event.pageInfo) {\r\n                params.pageIndex = event.pageInfo.pageIndex;\r\n                params.pageSize = event.pageInfo.pageSize;\r\n            }\r\n\r\n            if (event.search) {\r\n                let sfield = event.search.field;\r\n                if (sfield && sfield === '*') {\r\n                    sfield = '*';\r\n                }\r\n\r\n                if (event.search.value) {\r\n                    event.search.value = event.search.value.trim();\r\n                }\r\n\r\n                searchParam.searchField = sfield;\r\n                searchParam.searchValue = event.search.value;\r\n                searchParam.searchType =  event.search.type || 'like';\r\n\r\n                if (event.search.value === '' && searchParam.category === 'search' && (!params.searchConditions && !params.navSearchConditions)) {\r\n                    searchParam.category = 'all';\r\n                }\r\n            }\r\n\r\n            if (event.sortName) {\r\n                searchParam.sortName = event.sortName;\r\n            }\r\n            if (event.sortOrder) {\r\n                searchParam.sortOrder = event.sortOrder;\r\n            }\r\n\r\n            // åå±å è½½æ¯æè®¾ç½®å±å¼å±çº§\r\n            if (!isNaN(Number(event.expandLevel)) && this.ins.isTree()) {\r\n                // åç«¯ -1 ä¸å±å¼   0 å¨å±å¼\r\n                // åç«¯  0 ä¸å±å¼  -1 å¨å±å¼\r\n                if (event.expandLevel) {\r\n                    if (event.expandLevel === -1) {\r\n                        event.expandLevel = 0;\r\n                    }\r\n                } else {\r\n                    event.expandLevel = -1;\r\n                }\r\n                searchParam['layerNum'] = event.expandLevel;\r\n            }\r\n        }\r\n\r\n        if (type === 'fav' && event.favoriteIds) {\r\n            searchParam.favoriteIds = event.favoriteIds;\r\n        }\r\n\r\n        if (this.ins.isTree() || this.ins.displayType === LookupGridDisplayType.NavTreeList) {\r\n            params.enableFullTree = this.ins.enableFullTree;\r\n        }\r\n\r\n        params.treeToList = this.ins.treeToList;\r\n        params.navTreeToList = this.ins.navTreeToList;\r\n\r\n        // æ¥è¯¢æ¶ä¸æé å®æ´æ \r\n        if (type === 'textchange') {\r\n            params.enableFullTree = false;\r\n        }\r\n\r\n        if (type === 'selected') {\r\n            searchParam.category = 'fav';\r\n            params.enableFullTree = false;\r\n            searchParam.favoriteIds = event.favoriteIds;\r\n        }\r\n\r\n        params.searchValue = JSON.stringify(searchParam);\r\n        params.loadTreeDataType = this.ins.loadTreeDataType;\r\n\r\n        params.customData = this.ins.customData;\r\n\r\n        if (this.ins.helpId) {\r\n            params.helpId = this.ins.helpId;\r\n        }\r\n\r\n        if (event.selectedInfo) {\r\n            params.selectedInfo = event.selectedInfo;\r\n        }\r\n\r\n        if (event.navNodePathCode !== undefined) {\r\n            params.navPathCode = event.navNodePathCode;\r\n        } else {\r\n            if (type === 'navAllChildren') {\r\n                if (this.ins.includeSubordinates && this.ins['navNodePathCode']) {\r\n                    params.navPathCode = this.ins['navNodePathCode'];\r\n                }\r\n            }\r\n        }\r\n\r\n        return params;\r\n    }\r\n\r\n\r\n    getData(event?: any, type: LOAD_DATA_TYPE = 'all'): Observable<any> {\r\n        const uri = this.ins.gridOptions.uri;\r\n\r\n        if (this.ins.isDoublleList() &&  this.ins.navigationFilter && this.ins.navigationFilter.idValue && type !== 'fav') {\r\n            if (this.ins.includeSubordinates && this.ins.navigationOptions.treeInfo.loadDataType === 'async') {\r\n                type = 'navAllChildren';\r\n            } else {\r\n                type = 'list';\r\n            }\r\n        }\r\n\r\n        const params = this.buildQueryParams(event, type);\r\n\r\n        if (uri || this.ins.beUri) {\r\n            if (this.ins.beUri && this.ins.columns && this.ins.columns.length) {\r\n                const allSearchFields = this.ins.columns.map(col => col.searchField).filter(f => f);\r\n                if (!params.condition) {\r\n                    params.condition = {};\r\n                }\r\n\r\n                if (!this.ins.isTree() && this.ins.pagination) {\r\n                    const { pageSize = this.ins.pageSize || 20, pageIndex } = { ...params };\r\n                    params.condition.pagination = { pageSize, pageIndex };\r\n                } else {\r\n                    params.condition.pagination = { isUsePagination: false };\r\n                }\r\n                const searchParam = JSON.parse(params.searchValue);\r\n                if (searchParam.searchValue) {\r\n                    params.condition = this.ins.lookupUtils.mergeCondition(params.condition, allSearchFields, {\r\n                        field: searchParam.searchField,\r\n                        value: searchParam.searchValue\r\n                    });\r\n                }\r\n            }\r\n\r\n            const _uri = this.ins.beUri || uri;\r\n\r\n            if (this.ins.http) {\r\n                this.ins.http.context = this.ins.context;\r\n            }\r\n            if (this.ins._searchResult) {\r\n                return of(this.ins._searchResult);\r\n            }\r\n\r\n            if (type !== 'allChildren') {\r\n                return this.ins.http.getData(_uri, params);\r\n            } else {\r\n                const params1 = {\r\n                    searchValue: JSON.stringify({ category: type }),\r\n                    parentsIds: event.parentsIds,\r\n                    customData: params.customData,\r\n                    helpId: params.helpId\r\n                };\r\n                return this.ins.http.getData(_uri, params1);\r\n            }\r\n        } else {\r\n            return of(false);\r\n        }\r\n    }\r\n\r\n    // getFavoriteData(params) {\r\n    //     return this.getData(params, 'fav');\r\n    // }\r\n\r\n    getSelecedItems(selIds: any[]) {\r\n        return this.getData({ favoriteIds: selIds }, 'selected');\r\n    }\r\n\r\n    getPersonalConfig() {\r\n        const defaultConf = cloneDeep(DefaultUserConfig);\r\n        \r\n        // if (this.ins.customData) {\r\n        //     const wrapKeyData = JSON.stringify({ key: this.ins.customData });\r\n        //     const configKeyString = this.ins.getLookupBindingFields() + wrapKeyData;\r\n        //     this.ins.personalConfigService.personalConfigKey = configKeyString;\r\n        // }\r\n        const key = this.ins.personalConfigService._newKey;\r\n\r\n        let _conf = this.ins.personalConfigService.getPersonalData(key);\r\n\r\n        if (!_conf || !Object.keys(_conf).length) {\r\n            _conf = defaultConf;\r\n        }\r\n        const req = of(_conf);\r\n\r\n        if (this.ins.favoriteDataFrom === 'locale' || this.ins.isTabChanged) {\r\n            return req;\r\n        }\r\n\r\n        if (this.ins.http && this.ins.http['getUserSettings']) {\r\n            return this.ins.http['getUserSettings'](key).pipe(\r\n                tap((r: any) => { // TFS 611953\r\n                    if (r && r.textValue) {\r\n                        localStorage.setItem(key, r.textValue);\r\n                    } else {\r\n                        localStorage.setItem(key, JSON.stringify(defaultConf));\r\n                    }\r\n                }),\r\n                map((ucs: any) => {\r\n                    if (ucs) {\r\n                        return ucs.textValue ? JSON.parse(ucs.textValue) : defaultConf;\r\n                    }\r\n                    return defaultConf;\r\n                })\r\n            );\r\n        } else {\r\n            return req;\r\n        }\r\n    }\r\n\r\n    lookupRequest(event?: any, type: LOAD_DATA_TYPE = 'all', isQuickSelect = false) {\r\n        if (!this.ins.usePersionalConf || isQuickSelect) {\r\n            return this.getData(event, type);\r\n        }\r\n\r\n        const req = this.getPersonalConfig();\r\n\r\n        return req.pipe(\r\n            tap((c: any) => {\r\n                this.ins.personalConf = c;\r\n                this.ins.personalConfigService.savePersonalConfig(c);\r\n                if (!this.ins.isTabChanged) {\r\n                    this._originalPersonalConfig = cloneDeep(c);\r\n                }\r\n            }),\r\n            switchMap((c: any) => {\r\n                const { tabIndex, favorite, size, cascadeStatus } = c;\r\n\r\n                if (!this.ins.isTabChanged) {\r\n                    this.ins.activeTab = tabIndex || 'datalist';\r\n                }\r\n\r\n                if (size) {\r\n                    this.ins.dialogWidth = size.width;\r\n                    this.ins.dialogHeight = size.height;\r\n\r\n                    if (!this.ins.isTabChanged) {\r\n                        this.ins.dialog.reSize({ width: size.width, height: size.height });\r\n                    }\r\n                }\r\n\r\n\r\n                if ( this.ins.cascadeStatus) {\r\n                    if (cascadeStatus && this.ins.enableCascade && this.ins.showCascadeControl) {\r\n                        this.ins.cascadeStatus = cascadeStatus;\r\n                    }\r\n\r\n                    if (this.ins.cascadeItems) {\r\n                        const keys = ['enable', 'up', 'down', 'disable'];\r\n                        keys.forEach(n => {\r\n                            if (this.ins.cascadeItems[n] === undefined) {\r\n                                this.ins.cascadeItems[n] = true;\r\n                            }\r\n                        });\r\n\r\n                        if (!this.ins.cascadeItems[this.ins.cascadeStatus] ) {\r\n                            const keys = Object.keys(this.ins.cascadeItems).map(n => {\r\n                                return this.ins.cascadeItems[n] ? n: '';\r\n                            }).filter(n => n);\r\n                            this.ins.cascadeStatus = keys[0] as any;\r\n                        }\r\n                    }\r\n                }\r\n\r\n                if (this.ins.activeTab === 'datalist') {\r\n                    return this.getData(event, type);\r\n                } else if (this.ins.activeTab === 'favorite') {\r\n                    const favIds = favorite ? favorite[this.ins.localService.localeId] : [];\r\n                    if ((!favIds || !favIds.length) && !this.ins.isTabChanged) {\r\n                        return this.getData(event, 'all').pipe(\r\n                            map(r => {\r\n                                if (r && !r.items) {\r\n                                    r.items = [];\r\n                                }\r\n                                r.activeTab = 'datalist';\r\n                                return r;\r\n                            })\r\n                        );\r\n                    }\r\n\r\n                    // const _fids = favIds.filter(n => n);\r\n                    event.favoriteIds = favIds;\r\n                    event.search = null;\r\n                    return this.getData(event, 'fav').pipe(\r\n                        switchMap(r => {\r\n                            const items = r ? r.items || [] : [];\r\n                            // å å¥æ°æ®æéåï¼æ²¡æè¿åæ°æ®ä¸ç¬¬1æ¬¡æå¼çªå£ï¼éæå¨ç¹å»æ¶èæ ç­¾æ¶\r\n                            if (!items.length && !this.ins.isTabChanged) {\r\n                                return this.getData(event, 'all').pipe(\r\n                                    map(a => {\r\n                                        if (a && !a.items) {\r\n                                            a.items = [];\r\n                                        }\r\n        \r\n                                        a.activeTab = 'datalist';\r\n                                        return a;\r\n                                    })\r\n                                );\r\n                            } else {\r\n                                return of(r);\r\n                            }\r\n                        })\r\n                    );\r\n                } else if (this.ins.activeTab === 'selected') {\r\n                    const selIds = this.ins.displayValue ? this.ins.displayValue.split(',') : [];\r\n                    const _sids = selIds.filter(n => n);\r\n                    return this.getSelecedItems(_sids);\r\n                }\r\n            })\r\n        );\r\n    }\r\n\r\n    // ä¿å­ä¸ªæ§åæ°æ®\r\n    submitFavoriteData(action: any | FavoriteAction) {\r\n\r\n        // ä¿å­åå®½åº¦\r\n        this.ins.personalConf.colSizeInfo = this.getColumnSizeInfo();\r\n\r\n        // å¦ææ°æ®ä¸é»è®¤çæ°æ®ä¸è³åä¸ä¿å­ã\r\n        if (JSON.stringify(this.ins.personalConf) === JSON.stringify(this._originalPersonalConfig)) {\r\n            return;\r\n        }\r\n\r\n        let msg = '';\r\n        if (action === FavoriteAction.add) {\r\n            msg = this.ins.addFavoriteSuccess;\r\n        } else if (action === FavoriteAction.delete) {\r\n            msg = this.ins.delFavoriteSuccess;\r\n        }\r\n        // æ´æ°æ¬å°ç¼å­\r\n        localStorage.setItem(this.ins.personalConfigService._newKey, JSON.stringify(this.ins.personalConf));\r\n        this.ins.personalConfigService.savePersonalConfig(this.ins.personalConf || {});\r\n\r\n        if (this.ins.favoriteDataFrom !== 'locale') {\r\n            this._originalPersonalConfig = cloneDeep(this.ins.personalConf);\r\n\r\n            const configData: UserFavoriteData = {\r\n                configkey1: this.ins.personalConfigService.personalConfigKey,\r\n                configkey2: '',\r\n                configkey3: '',\r\n                textvalue: JSON.stringify(this.ins.personalConf)\r\n            };\r\n\r\n            if (this.ins.http && this.ins.http['saveUserSettings']) {\r\n                this.ins.savingFaoriteData = true;\r\n                this.ins.showLoading();\r\n                return this.ins.http['saveUserSettings'](configData).subscribe((r) => {\r\n                    this.ins.savingFaoriteData = false;\r\n                    this.ins.closeLoading();\r\n                    if (msg) {\r\n                        this.ins.notifyService.success(msg);\r\n                    }\r\n                });\r\n            } else {\r\n                if (msg) {\r\n                    this.ins.notifyService.success(msg);\r\n                }\r\n            }\r\n        } else {\r\n            if (msg) {\r\n                this.ins.notifyService.success(msg);\r\n            }\r\n        }\r\n    }\r\n\r\n    private getColumnSizeInfo() {\r\n        const colSizeInfo = {data: {}, nav: {}, fav: {}, sel: {}};\r\n        colSizeInfo.data = this.ins.columns.filter((c) => c.field !== FAVORITE_FIELD_NAME).reduce((r, n) => {\r\n            r[n.field] = n.width;\r\n            return r;\r\n        }, {});\r\n\r\n        if (this.ins.favoriteColumns && this.ins.favoriteColumns.length) {\r\n            colSizeInfo.fav = this.ins.favoriteColumns.filter((c) => c.field !== FAVORITE_FIELD_NAME).reduce((r, n) => {\r\n                r[n.field] = n.width;\r\n                return r;\r\n            }, {});\r\n        }\r\n\r\n        if (this.ins.navigationOptions && this.ins.navigationOptions.columns && this.ins.navigationOptions.columns.length) {\r\n            colSizeInfo.nav = this.ins.navigationOptions.columns.filter((c) => c.field !== FAVORITE_FIELD_NAME).reduce((r, n) => {\r\n                r[n.field] = n.width;\r\n                return r;\r\n            }, {});\r\n        }\r\n\r\n        if (this.ins.selectedColumns && this.ins.selectedColumns.length && this.ins.showSelected) {\r\n            colSizeInfo.sel = this.ins.selectedColumns.filter((c) => c.field !== FAVORITE_FIELD_NAME).reduce((r, n) => {\r\n                r[n.field] = n.width;\r\n                return r;\r\n            }, {});\r\n        }\r\n        \r\n        return colSizeInfo;\r\n    }\r\n\r\n}\r\n","/*\r\n* @Author: ç¯çç§æ(Lucas Huang)\r\n* @Date: 2018-12-14 14:40:48\r\n * @LastEditors: ç¯çç§æ(Lucas Huang)\r\n * @LastEditTime: 2019-09-25 18:10:29\r\n* @Company: Inspur\r\n* @Version: v0.0.1\r\n*/\r\n\r\nimport { Component, OnInit, ViewChild, ViewContainerRef, EventEmitter, Output,\r\n    ComponentFactoryResolver, ComponentRef, ChangeDetectorRef, Injector, ReflectiveInjector, OnDestroy\r\n} from '@angular/core';\r\nimport { Observable, of, Subscription } from 'rxjs';\r\n\r\nimport { DataTableComponent } from '@farris/ui-datatable';\r\nimport { TreeNode, TreeTableComponent } from '@farris/ui-treetable';\r\n\r\nimport { LOAD_DATA_TYPE, LookupGridOptions, LookupGridResult } from './lookup-grid-options';\r\nimport { LookupGridComponent } from './lookup-grid.component';\r\nimport { filter, switchMap } from 'rxjs/operators';\r\nimport { FilterCondition } from '@farris/ui-common/types';\r\n\r\n@Component({\r\n    selector: 'lookup-left',\r\n    templateUrl: './lookup-left.component.html'\r\n})\r\n\r\nexport class LookupLeftComponent implements OnInit, OnDestroy {\r\n\r\n    cmpRef: ComponentRef<any>;\r\n    navOptions: LookupGridOptions;\r\n    lookupCmp: LookupGridComponent;\r\n\r\n    navConditions: Array<FilterCondition> = [];\r\n\r\n\r\n    @ViewChild('container', {read: ViewContainerRef}) cmpContainer: ViewContainerRef;\r\n    @Output() selected = new EventEmitter<{ data: any, node?: any}>();\r\n    @Output() unselected = new EventEmitter();\r\n    @Output() search = new EventEmitter<{ field: string, value: string }>();\r\n    @Output() pageChanged = new EventEmitter<{ pageInfo: {pageIndex: number, pageSize: number}, search: {field: string, value: string} }>();\r\n\r\n    private _searchState = null;\r\n    private _sortState = null;\r\n    private allData = null;\r\n    constructor(private cfr: ComponentFactoryResolver, private cd: ChangeDetectorRef) { }\r\n\r\n    ngOnInit() {\r\n        if (this.lookupCmp && this.isTreeList()) {\r\n            this.lookupCmp.includeSubordinates$$ = this.lookupCmp.includeSubordinates$.subscribe((val: boolean) => {\r\n                if (this.cmpRef) {\r\n                    const tt = this.cmpRef.instance as TreeTableComponent;\r\n                    if (tt.selectedRow) {\r\n                        this.selected.emit({ data: tt.selectedRow.data, node: tt.selectedRow });\r\n                    }\r\n                }\r\n            });\r\n        }\r\n    }\r\n\r\n    ngOnDestroy(): void {\r\n        this._searchState = null;\r\n        this._sortState = null;\r\n    }\r\n\r\n    updateScrollPosition() {\r\n        if (this.isTreeList()) {\r\n            const tt = this.cmpRef.instance as TreeTableComponent;\r\n            if (tt && tt.state.scrollY != tt.psRef.directiveRef.elementRef.nativeElement.scrolltop) {\r\n                tt.psRef.directiveRef.scrollToY(tt.state.scrollY);\r\n            }\r\n        }\r\n    }\r\n\r\n    createComponent(): Observable<any> {\r\n        let dtFac = null;\r\n        if (!this.isTreeList()) {\r\n            dtFac = this.cfr.resolveComponentFactory(DataTableComponent);\r\n        } else {\r\n            this.navOptions['fitColumns'] = false;\r\n            this.navOptions['autoFitColumns'] = true;\r\n            dtFac = this.cfr.resolveComponentFactory(TreeTableComponent);\r\n        }\r\n        this.navOptions['keepSelect'] = false;\r\n        // å·¦ä¾§æ¥è¯¢è¿æ»¤æ¡ï¼éèæï¼\r\n        this.navOptions['showFilterBar'] = this.lookupCmp.enableMultiFieldSearch? false: this.lookupCmp.showFilterBar;\r\n\r\n        this.navOptions.width = this.lookupCmp.leftPanelWidth;\r\n\r\n        this.cmpRef = this.cmpContainer.createComponent(dtFac);\r\n\r\n        if (!this.isTreeList()) {\r\n            this.navOptions.width -= 2;\r\n            this.navOptions['fill'] = true;\r\n            this.cmpRef.instance.maxSize = 5;\r\n            this.cmpRef.instance.fill = true;\r\n            this.cmpRef.instance.autoFitColumns = true;\r\n        } else {\r\n            this.navOptions['fit'] = true;\r\n        }\r\n        // this.cmpRef.instance.fit = true;\r\n\r\n        if (this.navOptions.pageInfo) {\r\n            if (this.navOptions.pageInfo.pageList) {\r\n                this.navOptions.pageList = this.navOptions.pageInfo.pageList;\r\n            }\r\n            this.navOptions.pagination = this.navOptions.pageInfo.enablePager;\r\n            this.navOptions.pageIndex = this.navOptions.pageInfo.pageIndex;\r\n            this.navOptions.pageSize = this.navOptions.pageInfo.pageSize;\r\n        } else {\r\n            this.navOptions.pagination = false;\r\n        }\r\n\r\n        Object.assign(this.cmpRef.instance, this.navOptions);\r\n\r\n        this.loadData();\r\n        return of(this.cmpRef);\r\n    }\r\n\r\n    update() {\r\n        this.cd.detectChanges();\r\n    }\r\n\r\n    resize(size?: {width: number, height: number}) {\r\n        if (size) {\r\n            const { width, height } = size;\r\n            const _width = width - 2;\r\n            this.navOptions.width = _width;\r\n            this.navOptions.height = height;\r\n\r\n            const _height = height -  this.lookupCmp.getFilterBarHeight();\r\n            this.cmpRef.instance.resize({ width: _width, height: _height });\r\n        }\r\n    }\r\n\r\n    isTreeList() {\r\n        return this.navOptions.displayType.toLowerCase() === 'treelist' && !this.lookupCmp.navTreeToList;\r\n    }\r\n\r\n    private selectLeftDataTableRow(items: any, dt: DataTableComponent) {\r\n        if (items && items.length) {\r\n            let item = null;\r\n            if (this.lookupCmp.navSelectedIds) {\r\n                item = items.find(n => n[dt.idField] == this.lookupCmp.navSelectedIds);\r\n            } else {\r\n                if (this.lookupCmp.selectFirstInNav) {\r\n                    item = items[0];\r\n                }\r\n            }\r\n\r\n            if (item) {\r\n                dt.dtBody.selectedRowIndex = -1;\r\n                dt.dtBody.selectedRow('', 0, item);\r\n            }\r\n        }\r\n    }\r\n\r\n    private closeLoading() {\r\n        this.lookupCmp.closeLoading();\r\n    }\r\n\r\n    private initDataTable(dt: DataTableComponent) {\r\n        dt.loadData({\r\n            pageSize: this.navOptions.pageSize,\r\n            pageIndex: this.navOptions.pageIndex,\r\n            total: this.navOptions.total,\r\n            data: this.navOptions.items,\r\n        });\r\n\r\n        const {width, height} = this.navOptions;\r\n        // dt.resize({ width: 320, height: this.navOptions.height});\r\n        dt.resize({ width, height: height -  this.lookupCmp.getFilterBarHeight() });\r\n        // è¡éä¸­\r\n        dt.selectedRow.subscribe(d => {\r\n            this.selected.emit({ data: d.data });\r\n        });\r\n\r\n        dt.unSelectRow.subscribe(d => {\r\n            this.selected.emit(null);\r\n        });\r\n\r\n        const loadTableData = {\r\n            next: (data: LookupGridResult) => {\r\n                this.closeLoading();\r\n                dataTableReLoad(data);\r\n                const {width, height} = this.navOptions;\r\n                this.cmpRef.instance.resize({ width, height: height -  this.lookupCmp.getFilterBarHeight() });\r\n            },\r\n            error: (err) => {\r\n                this.closeLoading();\r\n            }\r\n        };\r\n\r\n        // æ¥è¯¢\r\n        dt.search.subscribe( searchData => {\r\n            const p: any = { pageInfo: { pageIndex: 1, pageSize: this.navOptions.pageSize }, search: '',navConditions: this.navConditions };\r\n\r\n            this._searchState = searchData;\r\n            this.search.emit(searchData);\r\n            p.search = searchData;\r\n            p.pageInfo.pageSize = dt.pageSize;\r\n            this.lookupCmp.navigationFilter = null;\r\n\r\n            if (this._sortState && this._sortState.sortName) {\r\n                p['sortName'] = this._sortState.sortName;\r\n                p['sortOrder'] = this._sortState.sortOrder;\r\n            } else {\r\n                delete p['sortName'];\r\n                delete p['sortOrder'];\r\n            }\r\n\r\n            this.lookupCmp.httpMgr.getData(p, 'navsearch').pipe(\r\n                filter(n => n)\r\n            ).subscribe(loadTableData);\r\n        });\r\n\r\n        const dataTableReLoad = (data) => {\r\n            dt.loadData({\r\n                pageSize: data.pageInfo.pageSize,\r\n                pageIndex: data.pageInfo.pageIndex,\r\n                total: data.total,\r\n                data: data.items,\r\n            });\r\n\r\n            this.selectLeftDataTableRow(data.items, dt);\r\n            dt.cd.markForCheck();\r\n        };\r\n\r\n        // åé¡µ\r\n        dt.pageChanged.subscribe(d => {\r\n            this.pageChanged.emit(d);\r\n            this.lookupCmp.navigationFilter = null;\r\n            d.navConditions = this.navConditions || [];\r\n            this.lookupCmp.httpMgr.getData(d, 'navsearch').subscribe(loadTableData);\r\n        });\r\n\r\n        dt.pageSizeChanged.subscribe((e) => {\r\n            this.lookupCmp.navigationFilter = null;\r\n            e.navConditions = this.navConditions || [];\r\n            this.lookupCmp.httpMgr.getData(e, 'navsearch').subscribe(loadTableData);\r\n        });\r\n\r\n        dt.columnSorted.subscribe( (sort: {sortName: string, sortOrder: any}) => {\r\n            const { sortName, sortOrder } = {...sort};\r\n            this._sortState = sort;\r\n            this.lookupCmp.navigationFilter = null;\r\n            const param = { \r\n                sortName,\r\n                sortOrder,\r\n                search: this._searchState,  \r\n                pageInfo: {\r\n                    pageSize: dt.pageSize,\r\n                    pageIndex: 1\r\n                },\r\n                navConditions: this.navConditions || []\r\n            };\r\n            this.lookupCmp.httpMgr.getData(param, 'navsearch').subscribe(loadTableData);\r\n        });\r\n\r\n        dt.clearSearchValue.subscribe( () => {\r\n            this._searchState = null;\r\n            dt.search.emit(null);\r\n        });\r\n\r\n        this.selectLeftDataTableRow(this.navOptions.items, dt);\r\n    }\r\n\r\n    private buildParams(params: {}): {[key: string]:any} {\r\n        const p: any = { \r\n            ...params, \r\n            treeToList: this.lookupCmp.treeToList, \r\n            navTreeToList: this.lookupCmp.navTreeToList,\r\n            navConditions: this.navConditions || []\r\n        };\r\n\r\n        return p;\r\n    }\r\n\r\n    private initTreeTable(tt: TreeTableComponent) {\r\n        tt.virtualized = true;\r\n        tt.fast = true;\r\n        tt.nodeSelected.subscribe(d => {\r\n            this.selected.emit({data: d.node.data, node: d.node});\r\n        });\r\n\r\n        tt.nodeUnSelect.subscribe(d => {\r\n            this.selected.emit(null);\r\n        });\r\n\r\n        tt.fixedHeader = true;\r\n\r\n        if (this.navOptions.treeInfo.loadDataType === 'all') { // åå±å è½½ä¸æ¯æåæ°æ¶éç½®å±å¼å±çº§\r\n            this.lookupCmp.treeNodeHelper.updateTreeNodeExpanded(this.navOptions.items, this.navOptions.treeInfo);\r\n        }\r\n\r\n        tt.loadDataType = this.navOptions.treeInfo.loadDataType;\r\n        // æ£æ¥å®æ´æ è¿æ»¤æ¡ä»¶ By Lucas 20200302\r\n        this.navOptions.items = this.lookupCmp.checkNodeCanBeSelect(this.navOptions.items, this.navOptions.treeInfo.loadDataType === 'all');\r\n        tt.loadData(this.navOptions.items);\r\n\r\n        if (this.lookupCmp.navSelectedIds) {\r\n            tt.selectNode(this.lookupCmp.navSelectedIds);\r\n        } else if (this.lookupCmp.selectFirstInNav) {\r\n            tt.selectFirstNode();\r\n        }\r\n\r\n        this.allData = this.navOptions.items;\r\n\r\n        const loadTreeData = {\r\n            next: (resData: any) => {\r\n                this.closeLoading();\r\n                tt.psRef.directiveRef.scrollToTop(0);\r\n                tt.clearAll();\r\n                const items = this.lookupCmp.checkNodeCanBeSelect(resData.items, this.navOptions.treeInfo.loadDataType === 'all' && (!this._searchState || !this._searchState.value));\r\n\r\n                if (items && items.length && items[0].children && items[0].children.length) {\r\n                    items[0].expanded = true;\r\n                    items[0].children = this.lookupCmp.expandFirstNode(items[0].children);\r\n                }\r\n\r\n                tt.loadData(items);\r\n                tt.resize();\r\n                this.selected.emit(null);\r\n            },\r\n            error: (err) => {\r\n                this.closeLoading();\r\n            }\r\n        };\r\n\r\n\r\n        tt.search.subscribe(search => {\r\n            this._searchState = search;\r\n            this.lookupCmp.navigationFilter = null;\r\n            const p = this.buildParams({ search });\r\n          \r\n            if (this._sortState && this._sortState.sortName) {\r\n                p['sortName'] = this._sortState.sortName;\r\n                p['sortOrder'] = this._sortState.sortOrder;\r\n            }\r\n            this.lookupCmp.httpMgr.getData(p, 'navsearch').subscribe(loadTreeData);\r\n        });\r\n\r\n        tt.columnSorted.subscribe( (sort: {sortName: string, sortOrder: any}) => {\r\n            this.lookupCmp.navigationFilter = null;\r\n            if (tt.loadDataType === 'all') {\r\n                tt.clientSort();\r\n            } else {\r\n                let { sortName, sortOrder } = {...sort};\r\n\r\n                const sortCol: any = this.navOptions.columns.find(n => n.field === sortName);\r\n                if (sortCol) {\r\n                    sortName = sortCol['fieldPath'];\r\n                }\r\n\r\n                this._sortState = { sortName, sortOrder };\r\n                // const param = Object.assign({ sortName, sortOrder }, this._searchState);\r\n                const param = this.buildParams({ sortName, sortOrder, search: this._searchState });\r\n                let requestType: LOAD_DATA_TYPE = 'nav';\r\n                if ((this._searchState && this._searchState.value) || (param && param.navConditions && param.navConditions.length)) {\r\n                    requestType = 'navsearch';\r\n                }\r\n\r\n\r\n                this.lookupCmp.httpMgr.getData(param, requestType).subscribe(loadTreeData);\r\n            }\r\n        });\r\n\r\n        tt.clearSearchValue.subscribe( () => {\r\n            this._searchState = null;\r\n            if (!this._sortState || !this._sortState.sortName) {\r\n                tt.loadData(this.allData);\r\n                if (!tt.selectedRow) {\r\n                    this.selected.emit(null);\r\n                }\r\n            } else {\r\n                const p = this.buildParams({});\r\n                this.lookupCmp.navigationFilter = null;\r\n                if (this._sortState && this._sortState.sortName) {\r\n                    p['sortName'] = this._sortState.sortName;\r\n                    p['sortOrder'] = this._sortState.sortOrder;\r\n                }\r\n                this.lookupCmp.httpMgr.getData(p, 'nav').subscribe(loadTreeData);\r\n            }\r\n        });\r\n\r\n\r\n        tt.expand.subscribe((tn: any) => {\r\n            this.onNodeExpanded(tn, tt);\r\n        });\r\n    }\r\n\r\n\r\n    private onNodeExpanded(tn: any, tt) {\r\n        if (tn.leaf) {\r\n            return;\r\n        }\r\n        if (!tn.children || !tn.children.length) {\r\n            const treeInfo = this.navOptions.treeInfo;\r\n            if (this.navOptions.treeInfo.loadDataType === 'async') {\r\n                let parentPath = '';\r\n                let parentLayer = -1;\r\n                const { field = '*', value = '' } = {\r\n                    ...tt.searchData\r\n                };\r\n\r\n                tn['showLoading'] = true;\r\n                tt.detectChanges();\r\n                if (treeInfo.layerType === 'parentId') {\r\n                    // ç¶IDå è½½æ¹å¼\r\n                    parentPath = tn['id'];\r\n                } else {\r\n                    const treeInfoField = treeInfo.dataField;\r\n                    if (treeInfoField) {\r\n                        // parentPath = tn.data[treeInfoField][treeInfo.pathField];\r\n                        // parentLayer = tn.data[treeInfoField][treeInfo.layerField];\r\n                        parentPath = this.lookupCmp.getPathCode(tn.data, treeInfo);\r\n                        parentLayer= this.lookupCmp.getLayerData(tn.data, treeInfo);\r\n                    } else {\r\n                        console.log('æªæ¾å°åçº§ä¿¡æ¯ã');\r\n                    }\r\n                }\r\n\r\n                if (!this.lookupCmp.uri) {\r\n                    this.lookupCmp.expandTreeNode.emit({\r\n                        instance: tt, node: tn,\r\n                        parentIdOrPath: parentPath, parentLayer, search: { value, field }\r\n                    });\r\n\r\n                    return;\r\n                }\r\n                this.getChildren(\r\n                    parentPath, parentLayer, {searchField: field === '*' ? '*' : field, searchValue: value}, tt\r\n                ).pipe(\r\n                    switchMap((data: any) => {\r\n                        if (data && data.items && data.items.length) {\r\n                            return of(data);\r\n                        } else {\r\n                            return this.getChildren(parentPath, parentLayer, { searchField: '*', searchValue: ''  }, tt, true);\r\n                        }\r\n                    })\r\n                ).subscribe(data => {\r\n                    if (tt) {\r\n                        if (tn && data.items && data.items.length) {\r\n                            tt.appendChildren(data.items, tn);\r\n                        }\r\n                        tn['showLoading'] = false;\r\n                        tt.detectChanges();\r\n                    }\r\n                });\r\n            }\r\n        }\r\n    }\r\n\r\n    private getChildren( parentPath, parentLayer, searchData: { searchField: string; searchValue: string }, tt, all = false ): Observable<any> {\r\n        const uri = this.lookupCmp.gridOptions.uri;\r\n        const search = { parentLayer, category: 'navchildren', ...searchData };\r\n        if (this.navOptions.treeInfo.layerType === 'parentId') {\r\n            search['parentId'] = parentPath;\r\n        } else {\r\n            search['parentPath'] = parentPath;\r\n        }\r\n\r\n        const param: any = this.buildParams({\r\n            searchValue: JSON.stringify(search),\r\n            customData: this.lookupCmp.customData,\r\n            enableFullTree: false,\r\n            loadTreeDataType: 'layerload',\r\n        });\r\n\r\n        if (this.lookupCmp.helpId) {\r\n            param['helpId'] = this.lookupCmp.helpId;\r\n        }\r\n\r\n        if (tt && tt.sortName) {\r\n            let sortName = tt.sortName;\r\n            const sortCol: any = this.navOptions.columns.find(n => n.field === tt.sortName);\r\n            if (sortCol) {\r\n                sortName = sortCol['fieldPath'];\r\n            }\r\n\r\n            search['sortName'] = sortName;\r\n            search['sortOrder'] = tt.sortOrder;\r\n            param.searchValue = JSON.stringify(search);\r\n        }\r\n\r\n        if (this.navConditions && this.navConditions.length && !all) {\r\n            param.navSearchConditions = this.navConditions;\r\n        }\r\n        delete param.navConditions;\r\n        return this.lookupCmp.http.getData(uri , param);\r\n    }\r\n\r\n\r\n    loadData() {\r\n        this.cmpRef.instance.allColumnsTitle = this.lookupCmp.allColumnsTitle;\r\n        if (!this.isTreeList()) {\r\n            const dt = this.cmpRef.instance as DataTableComponent;\r\n            this.initDataTable(dt);\r\n        } else {\r\n            const tt = this.cmpRef.instance as TreeTableComponent;\r\n            this.initTreeTable(tt);\r\n        }\r\n    }\r\n\r\n    onConditionsChange($event) {\r\n        this.navConditions = $event;\r\n        if (this.isTreeList()) {\r\n            const tt = this.cmpRef.instance as TreeTableComponent;\r\n            tt.search.emit();\r\n        } else {\r\n            const dt = this.cmpRef.instance as DataTableComponent;\r\n            dt.search.emit();\r\n        }\r\n    }\r\n}\r\n","import { ComponentRef } from '@angular/core';\r\nimport { DataTableComponent } from '@farris/ui-datatable';\r\nimport { TreeNode, TreeTableComponent } from '@farris/ui-treetable';\r\nimport { of } from 'rxjs';\r\nimport { debounceTime, switchMap } from 'rxjs/operators';\r\nimport { ComponentInstanceType, LookupGridDisplayType } from '../lookup-displaytype';\r\nimport { LookupGridComponent } from '../lookup-grid.component';\r\nimport { LookupLeftComponent } from '../lookup-left.component';\r\n\r\n\r\nexport class LookupComponentManager {\r\n    constructor(private ins: LookupGridComponent) {}\r\n\r\n    getComponentInstance(type: ComponentInstanceType = 'datatable') {\r\n        if (!this.ins.componentRef || !this.ins.componentRef.instance) {\r\n            return null;\r\n        }\r\n\r\n        if (type === 'selected') {\r\n            return this.ins.selectedDtRef;\r\n        }\r\n\r\n        let ins = this.ins.componentRef.instance;\r\n\r\n        if (type === 'leftDataTable' || type === 'leftTree') {\r\n            const leftRef = this.ins.leftComponentRef;\r\n            if (!leftRef || !leftRef.instance || !leftRef.instance.cmpRef || !leftRef.instance.cmpRef.instance) {\r\n                return null;\r\n            }\r\n            ins = this.ins.leftComponentRef.instance.cmpRef.instance;\r\n        }\r\n\r\n        if (type === 'fav') {\r\n            ins = this.ins.favoritesComponentRef.instance;\r\n        }\r\n\r\n        switch (type) {\r\n            case 'leftDataTable':\r\n            case 'fav':\r\n            case 'datatable':\r\n                return ins as DataTableComponent;\r\n            case 'leftTree':\r\n            case 'treetable':\r\n                return ins as TreeTableComponent;\r\n            default:\r\n                if (this.ins.isTree()) {\r\n                    return ins as TreeTableComponent;\r\n                }\r\n                return ins as DataTableComponent;\r\n        }\r\n    }\r\n\r\n    createComponentWithServerData(data: any) {\r\n        if (this.ins.componentRef) {\r\n            return;\r\n        }\r\n        this.ins.idField = data.idField || this.ins.idField;\r\n        this.ins.textField = data.textField || this.ins.textField;\r\n        this.ins.valueField = data.valueField || this.ins.valueField;\r\n\r\n        this.ins.displayType = (data && data.displayType) || this.ins.displayType || 'LIST';\r\n\r\n        const dtyp = this.ins.displayType.toUpperCase();\r\n\r\n        if (this.ins.isDoublleList()) {\r\n            if (this.ins.navTreeToList && dtyp === LookupGridDisplayType.NavTreeList) {\r\n                this.ins.displayType = LookupGridDisplayType.NavList;\r\n            }\r\n\r\n            if (this.ins.treeToList) {\r\n                if (dtyp ===  LookupGridDisplayType.NavListTree) {\r\n                    this.ins.displayType = LookupGridDisplayType.NavList;\r\n                }\r\n            }\r\n\r\n        } else {\r\n            if (this.ins.treeToList) {\r\n                if (dtyp === LookupGridDisplayType.TreeList) {\r\n                    this.ins.displayType = 'LIST';\r\n                } else {\r\n                    if (dtyp ===  LookupGridDisplayType.NavListTree) {\r\n                        this.ins.displayType = LookupGridDisplayType.NavList;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n \r\n\r\n        \r\n\r\n        if (this.ins.isDoublleList() && this.ins.navTreeToList) {\r\n            if (dtyp === LookupGridDisplayType.NavTreeList) {\r\n                this.ins.displayType = LookupGridDisplayType.NavList;\r\n            }\r\n        }\r\n\r\n        this.ins.changeDetector.detectChanges();\r\n\r\n        this.ins.componentRef = this.createContent(this.ins.gridOptions);\r\n        this.createFavoriteComponent();\r\n\r\n        this.resizeComponent();\r\n    }\r\n\r\n\r\n    createFavoriteComponent() {\r\n        if (this.ins.useFavorite && !this.ins.favoritesComponentRef) {\r\n            this.ins.favoriteColumns = this.ins.favHelper.getFavoriteColumns();\r\n\r\n            const favoritesOptions = Object.assign({}, this.ins.gridOptions, {\r\n                showFilterBar: false,\r\n                pagination: false,\r\n                columns: this.ins.favoriteColumns || []\r\n            });\r\n            this.ins.favoritesComponentRef = this.createFavoritesContent(favoritesOptions);\r\n\r\n            this.resizeComponent('fav');\r\n        }\r\n    }\r\n\r\n\r\n    private reloadTreeDataForExpand(expandLevel) {\r\n        const uri = this.ins.gridOptions.uri;\r\n        const tt = this.ins.componentRef.instance as TreeTableComponent;\r\n        const { field = '*', value = '' } = {\r\n            ...tt.searchData\r\n        };\r\n        const search = { category: 'all', searchValue: value, searchField: field, layerNum: expandLevel };\r\n\r\n\r\n        const param = {\r\n            searchValue: JSON.stringify(search),\r\n            customData: this.ins.customData,\r\n            enableFullTree: this.ins.enableFullTree,\r\n            loadTreeDataType: this.ins.loadTreeDataType\r\n        };\r\n\r\n\r\n        if (this.ins.helpId) {\r\n            param['helpId'] = this.ins.helpId;\r\n        }\r\n\r\n        if (tt && tt.sortName) {\r\n            Object.assign(param, {\r\n                sortName: tt.sortName,\r\n                sortOrder: tt.sortOrder\r\n            });\r\n        }\r\n        this.ins.showLoading();\r\n        return this.ins.http.getData(uri, param).subscribe((data: any) => {\r\n            this.ins.closeLoading();\r\n            const nodes = this.ins.checkNodeCanBeSelect(data.items, expandLevel === -1);\r\n            this.ins.items = nodes;\r\n            tt.loadData(nodes);\r\n            tt.psRef.directiveRef.scrollToTop(0);\r\n        });\r\n    }\r\n\r\n    private setTreeNodeExpandBy(nodes: TreeNode[], level) {\r\n        if (!nodes || !nodes.length) {\r\n            return;\r\n        }\r\n        nodes.forEach((n: TreeNode) => {\r\n            const layer = n.data[this.ins.treeInfo.dataField].layer;\r\n\r\n            const expandLayer = layer + level - 1;\r\n\r\n            n.expanded = layer <= expandLayer ? true : n.expanded;\r\n            if (n.children && n.children.length && layer + 1 <= expandLayer) {\r\n                this.setTreeNodeExpandBy(n.children, level);\r\n            }\r\n        });\r\n    }\r\n\r\n    // å¯ç¨æ å¸®å©å³é®èååè½\r\n    private useContextMenuForTree(cmpRef: ComponentRef<any>) {\r\n        const { maxLevel, enableContextMenu, language } = this.ins.treeTableOptions;\r\n        if (enableContextMenu && maxLevel) {\r\n            const levelMenus = [];\r\n            for (let i = 1; i <= maxLevel; i++) {\r\n                const title = language['expand' + i];\r\n                levelMenus.push({ id: 30 + 1, code: i, title, handle: (t) => {\r\n                    // åéè¯·æ±è·åæ°æ®\r\n                    const level = t.menu.code;\r\n                    if (isLoadAllTreeData() ) {\r\n                        this.setTreeNodeExpandBy(this.ins.items, level);\r\n                        cmpRef.instance.updateSerializedValue();\r\n                    } else {\r\n                        const { dataField, layerField } = this.ins.treeInfo;\r\n                        const firstNodeData = (this.ins.items || [])[0];\r\n                        if (firstNodeData && firstNodeData.data) {\r\n                            const minLayer = this.ins.utils.getValue(`${dataField}.${layerField}`, firstNodeData.data);\r\n                            let _level = minLayer + level - 1;\r\n                            this.reloadTreeDataForExpand(_level);\r\n                        }\r\n                    }\r\n                } });\r\n            }\r\n\r\n            const isLoadAllTreeData = () => {\r\n                if (this.ins.loadTreeDataType === 'default') {\r\n                    return cmpRef.instance.loadDataType === 'all';\r\n                } else {\r\n                    return this.ins.loadTreeDataType === 'loadall';\r\n                }\r\n            };\r\n\r\n            const contextMenus = [\r\n                {\r\n                    id:6, code: 'checkchildnodes', title: 'å¾éä¸çº§æ°æ®',\r\n                    visible: (e) => {\r\n                        // console.log(e);\r\n                        return !e.data.node.selectable && !this.ins.singleSelect && e.data.node.children && e.data.node.children.length\r\n                    },\r\n                    handle: (t) => {\r\n                        if (cmpRef) {\r\n                            const nodeIds = cmpRef.instance.getChildNodes(t.data.id).filter(n => n.selectable).map(n => n[this.ins.idField]);\r\n                            // const nodeIds = t.data.node.children.map(n => n[this.ins.idField]);\r\n                            cmpRef.instance.checkedNodes(nodeIds);\r\n                            cmpRef.instance.selectNodes(nodeIds);\r\n                        }\r\n                    }\r\n                },\r\n                {\r\n                    id:5, code: 'uncheckchildnodes', title: 'åæ¶å¾éä¸çº§æ°æ®',\r\n                    visible: (e) => {\r\n                        // console.log(e);\r\n                        return !e.data.node.selectable && !this.ins.singleSelect && e.data.node.children && e.data.node.children.length\r\n                    },\r\n                    handle: (t) => {\r\n                        if (cmpRef) {\r\n                            // const nodeIds = t.data.node.children.map(n => n[this.ins.idField]);\r\n                            const nodeIds = cmpRef.instance.getChildNodes(t.data.id).filter(n => n.selectable).map(n => n[this.ins.idField]);\r\n                            cmpRef.instance.unCheckedNodes(nodeIds);\r\n                            cmpRef.instance.unSelectNodes(nodeIds);\r\n                        }\r\n                    }\r\n                },\r\n                '-',\r\n                {\r\n                    id: 1, code: 'expandall', title: language.expandall, handle: (t) => {\r\n                        if (cmpRef && isLoadAllTreeData()) {\r\n                            cmpRef.instance.expandAll();\r\n                        } else {\r\n                            // åéè¯·æ±è·åæ°æ®\r\n                            this.reloadTreeDataForExpand(-1);\r\n                        }\r\n                    }\r\n                },\r\n                { id: 2, code: 'collapseall', title: language.collapseall, handle: (t) => {\r\n                    if (cmpRef) {\r\n                        cmpRef.instance.collapseAll();\r\n                    }\r\n                } },\r\n                '-',\r\n                {\r\n                    id: 3, title: language.expandByLayer,\r\n                    children: levelMenus\r\n                }\r\n            ];\r\n            this.ins.treeTableOptions.contextMenuItems = contextMenus;\r\n\r\n            cmpRef.instance.beforeShowContextMenu = () => {\r\n                return of({show: !cmpRef.instance.state.searched});\r\n            };\r\n        }\r\n    }\r\n\r\n    getCmpHeight(isFav = false) {\r\n        return this.ins.dialogMgr.getHeight() - (isFav ? 10 :this.ins.getFilterBarHeight());\r\n    }\r\n\r\n    createContent(opts: any): ComponentRef<any> {\r\n\r\n        if (this.ins.componentRef) {\r\n            return;\r\n        }\r\n\r\n        const type = this.ins.getComponentType();\r\n\r\n        const cmpFac = this.ins.cfr.resolveComponentFactory(type);\r\n        let cmpRef: ComponentRef<any> = null;\r\n        if (this.ins.isDoublleList()) {\r\n            cmpRef = this.ins.centerContainer.createComponent(cmpFac);\r\n        } else {\r\n            cmpRef = this.ins.contentContainer.createComponent(cmpFac);\r\n        }\r\n\r\n        if (this.ins.isTree()) {\r\n            opts.fit = true;\r\n            opts.pagination = false;\r\n\r\n            opts.fast = true;\r\n            opts.fitColumns = false;\r\n            \r\n            this.useContextMenuForTree(cmpRef);\r\n        } else {\r\n            opts.fill = true;\r\n        }\r\n        opts.autoFitColumns = true;\r\n\r\n        const ttOpts = this.ins.treeTableOptions || {};\r\n        Object.assign(cmpRef.instance, opts, { allColumnsTitle: this.ins.allColumnsTitle, ...ttOpts });\r\n\r\n        this.ins.componentRef = cmpRef;\r\n        this.resizeComponent();\r\n        return cmpRef;\r\n    }\r\n\r\n    // åå»ºæ¶èCMP\r\n    createFavoritesContent(opts: any): ComponentRef<any> {\r\n        const type = this.ins.getComponentType();\r\n        \r\n        const cmpFac = this.ins.cfr.resolveComponentFactory(type);\r\n        let cmpRef = null;\r\n        cmpRef = this.ins.favoritesContainer.createComponent(cmpFac);\r\n        \r\n        if (this.ins.isTree()) {\r\n            opts.fit = true;\r\n            opts.pagination = false;\r\n        } else {\r\n            opts.fill = true;\r\n        }\r\n        opts.autoFitColumns = true;\r\n\r\n        Object.assign(cmpRef.instance, opts, {\r\n            width: this.ins.dialog.size.width - this.ins.getSpaceWidth(),\r\n            height: this.ins.dialogMgr.getHeight()\r\n        });\r\n\r\n\r\n        // è®¢éæ¶èå¤¹åè¡¨ä¸­ç»ä»¶çç¸å³äºä»¶\r\n        this.ins.favHelper.initFavoriteComponentEvent(cmpRef);\r\n\r\n        return cmpRef;\r\n    }\r\n\r\n    resizeComponent(type: ComponentInstanceType = 'datatable') {\r\n        const size = {\r\n            width: this.ins.dialog.size.width - this.ins.getSpaceWidth(),\r\n            height: this.getCmpHeight(type == 'fav') \r\n        };\r\n\r\n        if (this.ins.isDoublleList() && (type === 'datatable' || type === 'treetable')) {\r\n            size.width = this.ins.dialog.size.width - this.ins.leftPanelWidth - this.ins.getSpaceWidth(true);\r\n        }\r\n\r\n        this.getComponentInstance(type).resize(size);\r\n    }\r\n\r\n    private getChildNodes(node: TreeNode) {\r\n        const nodes: any = [];\r\n        if (node.selectable || node.selectable === undefined) {\r\n            nodes.push(node);\r\n        }\r\n        if (node.children && node.children.length) {\r\n            node.children.forEach(n => {\r\n                nodes.push(...this.getChildNodes(n));\r\n            })\r\n        }\r\n\r\n        return nodes;\r\n    }\r\n\r\n    /** åå»ºå·¦ä¾§ç»ä»¶ */\r\n    createLeftComponent(ops: any) {\r\n        let dtFac = null;\r\n        if (this.ins.isDoublleList()) {\r\n            dtFac = this.ins.cfr.resolveComponentFactory(LookupLeftComponent);\r\n        }\r\n        this.ins.leftComponentRef = this.ins.leftContainer.createComponent(dtFac);\r\n        ops.height = this.ins.dialogMgr.getHeight();\r\n\r\n        if (this.ins.dialogWidth < this.ins.navLookupDialogMinWidth) {\r\n            this.ins.dialogWidth = this.ins.navLookupDialogMinWidth;\r\n            this.ins.dialog.reSize({ width: this.ins.dialogWidth });\r\n            this.ins.resizeCmp({ width: this.ins.dialog.size.width });\r\n        }\r\n\r\n        if (ops.width !== this.ins.leftPanel.width) {\r\n            // é»è®¤ 1 : 2\r\n            this.ins.leftPanel.resize({\r\n                width: this.ins.leftPanel.width,\r\n                height: ops.height\r\n            });\r\n            this.ins.resizeCmp({ width: this.ins.dialog.size.width });\r\n        }\r\n\r\n        // this.resizeComponent();\r\n\r\n        this.ins.leftComponentRef.instance.lookupCmp = this.ins;\r\n        this.ins.leftComponentRef.instance.navOptions = ops;\r\n\r\n\r\n        this.ins.leftComponentRef.instance.selected\r\n            .pipe(\r\n                debounceTime(100),\r\n                switchMap((d: any) => {\r\n                    if (d && d.data) {\r\n                        this.ins.navigationFilter = {\r\n                            selected: d.data,\r\n                            idValue: this.getNavigationFilter(d.data),\r\n                            searchField: '',\r\n                            searchValue: ''\r\n                        };\r\n                    } else {\r\n                        this.ins.navigationFilter = undefined;\r\n                    }\r\n                    // å è½½å³ä¾§æ°æ®\r\n                    const p = {\r\n                        pageInfo: {\r\n                            pageIndex: 1, // tfs 638840\r\n                            pageSize: this.ins.gridOptions.pageSize\r\n                        }\r\n                    };\r\n\r\n                    if (this.ins.includeSubordinates && d && d.node && ops.treeInfo) {\r\n                        const {layerType, pathField, loadDataType, dataField} = ops.treeInfo\r\n                        if (loadDataType === 'all') {\r\n                            const rowDatas = this.getChildNodes(d.node).map(n => n.data);\r\n                            this.ins.navigationFilter.idValue = this.getNavigationFilter(rowDatas);\r\n                        } else {\r\n                            if (layerType == 'pathcode') {\r\n                                // p['navNodePathCode'] = d.data[dataField][pathField];\r\n                                p['navNodePathCode'] = this.ins.getPathCode(d.data, ops.treeInfo);\r\n                                this.ins['navNodePathCode'] = p['navNodePathCode'];\r\n                            }\r\n                        }\r\n                    } else  {\r\n                        this.ins['navNodePathCode'] = '';\r\n                    }\r\n\r\n                    const dataCmpRef = this.getComponentInstance();\r\n                    const { sortName, sortOrder } = dataCmpRef;\r\n                    Object.assign(p, { search: this.ins._searchState, sortName, sortOrder });\r\n                    return this.ins.httpMgr.getData(p, 'list');\r\n                })\r\n            )\r\n            .subscribe(res => {\r\n                this.ins.closeLoading();\r\n                this.ins.loadDataWhenOpen = true;\r\n\r\n                // if (this.ins.useFavorite && !this.ins.isTree()) {\r\n                //     this.ins.favHelper.updateFavoritesStatus(res.items);\r\n                // }\r\n                // this.ins.loadDataTableData(res);\r\n                \r\n                this.ins.loadData(res, false);\r\n\r\n                setTimeout(() => {\r\n                    // éä¸­æ°æ®\r\n                    this.ins.selectionMgr.selectCurrentValue();\r\n                    this.ins.changeDetector.detectChanges();\r\n                });\r\n            });\r\n\r\n        return this.ins.leftComponentRef.instance.createComponent();\r\n    }\r\n\r\n    // è·åå³èæ°æ®, å³ä¾§æ°æ®ä¸­ å³èåå­æ®µçå¼\r\n    private getNavigationFilter(navRow: any) {\r\n        if (this.ins.navigationOptions.relations && this.ins.navigationOptions.relations.length) {\r\n            const result = [];\r\n            this.ins.navigationOptions.relations.forEach(r => {\r\n                const k = r.groupField;\r\n                const dField = r.helpField;\r\n                const rf: any = { fieldName: dField, fieldValue: '' };\r\n\r\n                if (Array.isArray(navRow)) {\r\n                    const vals = navRow.map(n => {\r\n                        return k.split('.').reduce((o, c) => {\r\n                            return o[c];\r\n                        }, n);\r\n                    });\r\n                    rf.fieldValue = vals.join(',');\r\n                } else {\r\n                    rf.fieldValue = k.split('.').reduce((o, c) => {\r\n                        return o[c];\r\n                    }, navRow);\r\n                }\r\n\r\n                result.push(rf);\r\n            });\r\n            return result;\r\n        }\r\n\r\n        return '';\r\n    }\r\n}\r\n","import { RendererStyleFlags2 } from '@angular/core';\r\nimport { fromEvent, of, race, Subscription } from 'rxjs';\r\nimport { buffer, bufferCount, debounceTime, filter, first, map, repeat } from 'rxjs/operators';\r\nimport { PickingResult } from '../lookup-grid-options';\r\nimport { LookupGridComponent } from '../lookup-grid.component';\r\n\r\nexport class LookupDialogManager {\r\n\r\n    private lookupInit: Subscription = null;\r\n    private _loadDataWhenOpen = true;\r\n    private _navSelectedId = '';\r\n    private _selectFirstInNav = false;\r\n    private dialogClosedSubscription: Subscription = null;\r\n    private dialogOpenedSubscription: Subscription = null;\r\n    \r\n    private keyDownHandler = null;\r\n    private _okbtnclick$: Subscription = null;\r\n\r\n    constructor(private ins: LookupGridComponent) { }\r\n\r\n    private unsubscribes(){\r\n        if (this.lookupInit) {\r\n            this.lookupInit.unsubscribe();\r\n            this.lookupInit = null;\r\n        }\r\n\r\n        if (this.dialogClosedSubscription) {\r\n            this.dialogClosedSubscription.unsubscribe();\r\n            this.dialogClosedSubscription = null;\r\n        }\r\n\r\n        if (this.dialogOpenedSubscription) {\r\n            this.dialogOpenedSubscription.unsubscribe();\r\n            this.dialogOpenedSubscription = null;\r\n        }\r\n\r\n    }\r\n    // å¸®å©çªå£å³é­ååä¸äºæ¸çå·¥ä½\r\n    dialogClosed() {\r\n        if (this.ins.displayText !== this.ins.originalText && !this.ins.nosearch) {\r\n            this.ins.displayText = this.ins.originalText;\r\n            this.ins.setModelValue(this.ins.displayText);\r\n        }\r\n        if (this.ins.componentRef) {\r\n            this.ins.componentRef.destroy();\r\n            this.ins.componentRef = null;\r\n        }\r\n\r\n        if (this.ins.favoritesComponentRef) {\r\n            this.ins.favoritesComponentRef.destroy();\r\n            this.ins.favoritesComponentRef = null;\r\n        }\r\n\r\n        if (this.ins.contentContainer) {\r\n            this.ins.contentContainer.clear();\r\n        }\r\n\r\n        if (this.ins.centerContainer) {\r\n            this.ins.centerContainer.clear();\r\n        }\r\n\r\n        if (this.ins.leftComponentRef) {\r\n            this.ins.leftComponentRef.destroy();\r\n            this.ins.leftComponentRef = null;\r\n        }\r\n\r\n        if (this.ins.leftContainer) {\r\n            this.ins.leftContainer.clear();\r\n        }\r\n\r\n\r\n        this.ins.isShow = false;\r\n        this.ins.isTextChange = false;\r\n        if (this.ins.dialog) {\r\n            this.ins.content = null;\r\n        }\r\n\r\n        this.ins.navigationFilter = null;\r\n\r\n        this.ins.lookupUtils.pendingEnd();\r\n\r\n        if (this.ins.helpId) {\r\n            this.ins.displayType = '';\r\n        }\r\n\r\n\r\n        this.unsubscribes();\r\n\r\n        // this.ins.items = [];\r\n        this.ins.favoriteItems = [];\r\n        this.ins.lookupSelectionSer.initFavoriteItems([]);\r\n\r\n        this.ins.isTabChanged = false;\r\n\r\n        if (this.ins.uri) {\r\n            this.ins.items = [];\r\n        }\r\n        this.ins._searchState = null;\r\n\r\n\r\n        this.ins.pageIndex = 1;\r\n\r\n        this.ins.loadDataWhenOpen = this._loadDataWhenOpen;\r\n        this.ins.navSelectedIds = this._navSelectedId;\r\n        this.ins.selectFirstInNav = this._selectFirstInNav;\r\n\r\n        this.ins.isGetAllChidlNodes = false;\r\n\r\n        this.ins.enableGetAllChildNodes = true;\r\n\r\n        // ä¿å­ä¸ªæ§åæ°æ®\r\n        if (this.ins.usePersionalConf && this.ins.favoriteDataFrom !== 'locale') {\r\n            this.ins.httpMgr.submitFavoriteData('dialog closed event.');\r\n        }\r\n\r\n        if (this.keyDownHandler) {\r\n            this.keyDownHandler();\r\n            this.keyDownHandler = null;\r\n        }\r\n        if (this.ins.inputGroup) {\r\n            this.ins.inputGroup.focus();\r\n        }\r\n\r\n        this.ins.userInitialConfig.reset();\r\n\r\n        this.ins.treeInfo = this.ins._treeInfo_;\r\n\r\n        this.ins.lookupUtils.destroy();\r\n        this.ins.dialogClosed.emit();\r\n\r\n        if (this.ins.includeSubordinates$$) {\r\n            this.ins.includeSubordinates$$.unsubscribe();\r\n            this.ins.includeSubordinates$$ = null;\r\n        }\r\n\r\n        this.ins.conditions = [];\r\n        \r\n\r\n        this.ins.searching = false;\r\n\r\n        if (this.ins.dtEventMgr) {\r\n            this.ins.dtEventMgr['_sortState'] = null;\r\n        }\r\n\r\n        if (this.ins.ttEventMgr) {\r\n            this.ins.ttEventMgr['_sortState'] = null;\r\n        }\r\n\r\n        if (this._okbtnclick$) {\r\n            this._okbtnclick$.unsubscribe();\r\n            this._okbtnclick$ = null;\r\n        }\r\n    }\r\n\r\n    onDialogCreated() {\r\n        this._loadDataWhenOpen = this.ins.loadDataWhenOpen;\r\n        this._navSelectedId = this.ins.navSelectedIds;\r\n        this._selectFirstInNav = this.ins.selectFirstInNav;\r\n\r\n        this.ins.dialogCreatedSubscription = this.ins.dialogCreated.subscribe(dlg => {\r\n            if (dlg) {\r\n                this.ins.setContainerMargin();\r\n                if (this.ins.dialogOpenedSubscription) {\r\n                    this.ins.dialogOpenedSubscription.unsubscribe();\r\n                }\r\n                if (this.ins.dialogClosedSubscription) {\r\n                    this.ins.dialogClosedSubscription.unsubscribe();\r\n                }\r\n                this.registerDialogEvent();\r\n                if (this.ins.isRecordSize) {\r\n                    const dlgSize = this.ins.personalConfigService.getDialogSize();\r\n                    if (dlgSize) {\r\n                        const { width, height } = dlgSize;\r\n                        this.ins.dialogWidth = width ? width : this.ins.dialogWidth;\r\n                        this.ins.dialogHeight = height ? height : this.ins.dialogHeight;\r\n\r\n                        // 20200908 æ´æ°ç°çªå£çå°ºå¯¸ by Lucas\r\n                        dlg.width = this.ins.dialogWidth;\r\n                        dlg.height = this.ins.dialogHeight;\r\n                    }\r\n                }\r\n                dlg.show();\r\n            }\r\n        });\r\n\r\n        this.ins.subscriptions.push(this.ins.dialogCreatedSubscription);\r\n    }\r\n\r\n    checkDictPickingResult(pr: PickingResult | any) {\r\n        let o = true;\r\n        if (pr === undefined || pr === null || pr === '') {\r\n            o = true;\r\n        }\r\n\r\n        if (typeof pr === 'boolean') {\r\n            o = pr;\r\n        }\r\n\r\n        let customData, selectedIds, message;\r\n        customData = this.ins.customData;\r\n        selectedIds = this.ins.selectedIds;\r\n\r\n        if (typeof pr === 'object') {\r\n            if (pr.showDialog === undefined) {\r\n                o = true;\r\n            } else {\r\n                o = pr.showDialog;\r\n            }\r\n\r\n            if (pr.hasOwnProperty('data')) {\r\n                /** ä¿å­å¸®å©åä¼ éçæ°æ® */\r\n                customData = pr.data;\r\n            }\r\n            selectedIds = pr.selectedIds || null;\r\n\r\n            if (pr.message) {\r\n                message = pr.message;\r\n            }\r\n        }\r\n\r\n        return { show: o, customData, selectedIds, message };\r\n    }\r\n\r\n    canOpenDialog(pr: PickingResult | any) {\r\n        const {show, customData, selectedIds, message} = this.checkDictPickingResult(pr);\r\n        this.ins.customData = customData;\r\n        this.ins.selectedIds = selectedIds || null;\r\n        if (message) {\r\n            this.ins.notifyService.warning(message);\r\n        }\r\n\r\n        this.ins.isReady = false;\r\n        this.ins.isShow = show;\r\n    }\r\n\r\n    getHeight() {\r\n        return this.ins.dialog.size.contentHeight -\r\n                this.ins.containerMargin.bottom -\r\n                this.ins.containerMargin.top -\r\n                (!this.ins.useNewLayout ? (this.ins.useFavorite ? 40 :  0) : 56);\r\n            \r\n    }\r\n\r\n\r\n    private getMainGridSize() {\r\n        if (this.ins.isDoublleList()) {\r\n            return {\r\n                width: this.ins.dialog.size.width - this.ins.leftPanel.width - 27,\r\n                height: this.getHeight()\r\n            };\r\n        }\r\n\r\n        return {\r\n            width: this.ins.dialog.size.width - this.ins.containerMargin.left - this.ins.containerMargin.right,\r\n            height: this.getHeight()\r\n        };\r\n    }\r\n\r\n    resetDialogContentHeight() {\r\n        const { header: hHeight, footer: fHeight } = this.ins.dialog.size;\r\n        return this.ins.dialogHeight - hHeight - fHeight -  this.ins.containerMargin.bottom - this.ins.containerMargin.top;\r\n    }\r\n\r\n\r\n    private registerOkBtnEvent() {\r\n        if (this.ins.okButton) {\r\n            const doubleClickDuration = 250;\r\n            const leftClick$ = fromEvent(this.ins.okButton.nativeElement, 'click').pipe(filter((event: any) => event.button === 0));\r\n            const debounce$ = leftClick$.pipe(debounceTime(doubleClickDuration));\r\n            const clickLimit$ = leftClick$.pipe(bufferCount(2));\r\n            const bufferGate$ = race(debounce$, clickLimit$)\r\n            .pipe(\r\n              // We are only interested in the first event. After that\r\n              // we want to restart.\r\n              first(),\r\n              repeat(),\r\n            );\r\n\r\n            this._okbtnclick$ = leftClick$.pipe(\r\n                buffer(bufferGate$),\r\n                // Here we map the buffered events into the length of the buffer\r\n                // If the user clicked once, the buffer is 1. If he clicked twice it is 2\r\n                map(clicks => clicks.length)\r\n            ).subscribe(clicks => {\r\n                this.ins.selectItem();\r\n            });\r\n        }\r\n    }\r\n\r\n    /** æ³¨åå¼¹åºçªå£çäºä»¶ */\r\n    private registerDialogEvent() {\r\n        this.dialogOpenedSubscription = this.ins.dialog.opened.subscribe(() => {\r\n\r\n            this.ins.dialogContentHeight = this.resetDialogContentHeight();\r\n\r\n            this.ins.gridOptions = Object.assign(this.ins.gridOptions, this.getMainGridSize());\r\n            this.ins.dialog.el.nativeElement.querySelector('.ps-content').style.height = '100%';\r\n\r\n            if (this.ins.displayType && this.ins.customDisplayType) {\r\n                this.ins.componentRef = this.ins.lookupCmpMgr.createContent(this.ins.gridOptions);\r\n                this.ins.lookupCmpMgr.createFavoriteComponent();\r\n            }\r\n\r\n            this.ins.initData();\r\n\r\n            // ä¿®æ¹å¸®å©çªå£çç¶æ\r\n            this.ins.lookupUtils.pendingEnd();\r\n            this.ins.dialogOpened.emit();\r\n\r\n            // æ³¨åç¡®å®æé®ç¹å»äºä»¶\r\n            this.registerOkBtnEvent();\r\n\r\n        });\r\n\r\n        this.lookupInit = this.ins.lookupinitializationSubject.subscribe(() => {\r\n            this.ins.loadDataWhenOpen = true;\r\n            // æ³¨åå¿«æ·é®\r\n            this.registerShortcutKey();\r\n            // çå¬å·¦ä¾§å°ºå¯¸ååäºä»¶\r\n            if (this.ins.leftPanel) {\r\n                if (!this.ins.leftPanel.resizing.observers.length) {\r\n                    const leftPanelResize$ = this.ins.leftPanel.resizing.pipe(\r\n                        debounceTime(50)\r\n                    ).subscribe((s: any) => {\r\n                        const size = {\r\n                            width: this.ins.dialog.size.width - s.size.width - this.ins.getSpaceWidth(true),\r\n                            height: this.getHeight() - this.ins.getFilterBarHeight()\r\n                        }\r\n                        this.ins.componentRef.instance.resize(size);\r\n                        this.ins.leftComponentRef.instance.resize(s.size);\r\n                    });\r\n\r\n                    this.ins.subscriptions.push(leftPanelResize$);\r\n                }\r\n                if (this.ins.isDoublleList() && this.ins.leftComponentRef) {\r\n                    this.ins.leftComponentRef.instance.updateScrollPosition();\r\n                }\r\n            }\r\n\r\n            if (this.ins.cascadeSelect) {\r\n                const {selectEl, panelRef } = this.ins.cascadeSelect;\r\n                this.ins.cascadeSelect.beforeShow = () => {\r\n                    if (selectEl && panelRef) {\r\n                        panelRef.style.left = `${selectEl.offsetLeft}px`;\r\n                        if (this.ins.localService.localeId.toLocaleLowerCase() == 'en') {\r\n                            panelRef.style.width = 'auto';\r\n                            panelRef.style.maxWidth = '200px'\r\n                        }\r\n                        return of(true);\r\n                    }\r\n                }\r\n            }\r\n        });\r\n\r\n        this.dialogClosedSubscription = this.ins.dialog.closed.subscribe(() => {\r\n            // è¾å¥æ¡åååï¼å¼¹åºçªå£æªéæ©æ°æ®å³é­çªå£æ¶ï¼è¿ååå§å¼\r\n            this.ins.dialogMgr.dialogClosed();\r\n        });\r\n\r\n        // this.ins.subscriptions.push(this.ins.dialogClosedSubscription);\r\n    }\r\n\r\n    private registerShortcutKey() {\r\n        // åè½¦ï¼ä¸ç¡®å®æé®å¤çé»è¾ä¸è³ã\r\n        const dlgContainerDom = this.ins.dialog.el.nativeElement.querySelector('.farris-modal');\r\n\r\n        if (dlgContainerDom && this.ins.shortcutKey && !this.keyDownHandler) {\r\n            this.keyDownHandler = this.ins.eventManager.addEventListener(dlgContainerDom, 'keydown', (e: KeyboardEvent) => {\r\n                e.stopPropagation();\r\n                const { moveUp, moveDown, searchFocus, confirm, nextPager, prevPager, expand, collapse } = this.ins.shortcutKey;\r\n                const arrowKey = [moveUp, moveDown, expand, collapse];\r\n                if (arrowKey.includes(e.code)) {\r\n                    this.ins.componentRef.instance.onKeydownEvent(e);\r\n                } else if (e.key === confirm) {\r\n                    if (e.target['nodeName'] === 'INPUT' && !e.ctrlKey) {\r\n                        return;\r\n                    }\r\n                    this.ins.okButton.nativeElement.click();\r\n                } else if (e.code === searchFocus) { // å¸®å©çªå£æ¥è¯¢è¾å¥æ¡ç¦ç¹\r\n                    e.preventDefault();\r\n                    this.ins.componentRef.instance.inputGroup.focus();\r\n                } else if (!this.ins.isTree() && (e.code === nextPager || e.code === prevPager )) {  // åé¡µ\r\n                    const isNextPager = e.code === nextPager;\r\n                    this.paginationKeyDownHandler(isNextPager);\r\n                }\r\n            });\r\n        }\r\n    }\r\n\r\n    private paginationKeyDownHandler(next = true) {\r\n        const datatableRef = this.ins.componentRef.instance;\r\n        const {pageIndex, pageSize, total} = datatableRef;\r\n        const pagerCount = Math.ceil(total / pageSize);\r\n\r\n        let newPageNum = pageIndex;\r\n        if (next) {\r\n            newPageNum = newPageNum + 1;\r\n        } else {\r\n            newPageNum = newPageNum - 1;\r\n        }\r\n\r\n        if (newPageNum > pagerCount || newPageNum < 1) {\r\n            newPageNum = pageIndex;\r\n        }\r\n\r\n        this.ins.componentRef.instance.onPageChange({ pageSize, pageIndex: newPageNum });\r\n    }\r\n\r\n}\r\n\r\n","import { Observable, of, BehaviorSubject, Subject } from 'rxjs';\r\nimport { switchMap } from 'rxjs/operators';\r\nimport { FavoriteAction } from '../lookup-displaytype';\r\nimport { LookupGridComponent } from '../lookup-grid.component';\r\n\r\nexport interface SelectionState {\r\n    selecteditems: any[];\r\n    favoriteItems: any[];\r\n    quickItems: any[];\r\n}\r\n\r\nexport class LookupSelectionService {\r\n\r\n    private state: SelectionState = {\r\n        selecteditems: [],\r\n        favoriteItems: [],\r\n        quickItems: []\r\n    };\r\n\r\n    state$: BehaviorSubject<SelectionState> = new BehaviorSubject(this.state);\r\n\r\n    selected$: Observable<any[]> = this.state$.pipe(\r\n        switchMap(n => of(n.selecteditems))\r\n    );\r\n\r\n    favoriteItems$: BehaviorSubject<any> = new BehaviorSubject({items: this.state.favoriteItems, action: null });\r\n\r\n    quickItems$: Observable<any[]> = this.state$.pipe(\r\n        switchMap(n => of(n.quickItems))\r\n    );\r\n\r\n    selectionChanged$ = new Subject();\r\n\r\n    private get idField() {\r\n        return this.ins.idField;\r\n    }\r\n\r\n    constructor(private ins: LookupGridComponent) {\r\n    }\r\n\r\n    initFavoriteItems(items: any[]) {\r\n        this.state.favoriteItems = items || [];\r\n    }\r\n\r\n\r\n    //#region æ¶èæ°æ®\r\n\r\n    updateFavoriteData(data: any, action: FavoriteAction) {\r\n\r\n        if (this.ins.savingFaoriteData) {\r\n            return;\r\n        }\r\n\r\n        if (action === FavoriteAction.add) {\r\n            this.state.favoriteItems = this.state.favoriteItems.concat([data]);\r\n        } else {\r\n            this.state.favoriteItems = this.state.favoriteItems.filter(n => n[this.idField] !== data[this.idField]);\r\n        }\r\n\r\n        this.favoriteItems$.next({ items: this.state.favoriteItems, action, data });\r\n    }\r\n\r\n    //#endregion\r\n\r\n    //#region å¤éæ°æ®\r\n\r\n    loadSelections( data: []) {\r\n        this.state.selecteditems = [...data];\r\n        this.state$.next(this.state);\r\n    }\r\n\r\n    getSelections() {\r\n        return [...this.state.selecteditems];\r\n    }\r\n\r\n    select(item: any) {\r\n        if (item) {\r\n            this.state.selecteditems = [...this.state.selecteditems, item];\r\n            this.state$.next(this.state);\r\n\r\n            this.selectionChanged$.next({ data: [item[this.idField]], selected: true });\r\n        }\r\n    }\r\n\r\n    unselectByPathcode(pathcode: string) {\r\n        const ids = [];\r\n        this.state.selecteditems = this.state.selecteditems.filter(n => {\r\n            const _pathcode = this.ins.getPathCode(n, this.ins.treeInfo);\r\n            const r = _pathcode && _pathcode.indexOf(pathcode) !== 0;\r\n            if (!r) {\r\n                ids.push(n[this.idField]);\r\n            }\r\n            return r;\r\n        });\r\n\r\n        this.selectionChanged$.next({ data: ids, selected: false });\r\n\r\n    }\r\n\r\n    updateSelections(data: any, checked = true) {\r\n\r\n        if (!Array.isArray(data)) {\r\n            data = [data];\r\n        }\r\n\r\n        const items = [ ...data ];\r\n        const idField = this.idField;\r\n        const ids = items.map(n => n[idField]);\r\n        if (checked) {\r\n            if (this.state.selecteditems && !this.state.selecteditems.length) {\r\n                this.state.selecteditems = items;\r\n            } else {\r\n                ids.forEach((n, i) => {\r\n                    if (!this.state.selecteditems.find(r => r[idField] == n)) {\r\n                        this.state.selecteditems.push(items[i]);\r\n                    }\r\n                });\r\n            }\r\n        } else {\r\n            if (data) {\r\n                this.state.selecteditems = this.state.selecteditems.filter(n => {\r\n                    return ids.indexOf(n[idField]) === -1;\r\n                });\r\n            }\r\n        }\r\n\r\n        this.state$.next(this.state);\r\n        this.selectionChanged$.next({ data: ids, selected: checked });\r\n    }\r\n\r\n    unSelect(id: any) {\r\n        if (id) {\r\n            if (Array.isArray(id)) {\r\n                this.state.selecteditems = this.state.selecteditems.filter(n => {\r\n                    return id.indexOf(n[this.idField]) === -1;\r\n                });\r\n                this.selectionChanged$.next({ data: id, selected: false });\r\n            } else {\r\n                this.state.selecteditems = this.state.selecteditems.filter(n => n[this.idField] != id);\r\n                this.selectionChanged$.next({ data: [id], selected: false });\r\n            }\r\n\r\n            this.state$.next(this.state);\r\n        }\r\n    }\r\n\r\n    clearSelections() {\r\n        this.state.selecteditems = [];\r\n        this.state$.next(this.state);\r\n    }\r\n\r\n    //#endregion\r\n\r\n}\r\n","/*\r\n * @Author: ç¯çç§æ(lucas huang)\r\n * @Date: 2018-11-23 11:23:12\r\n * @LastEditors: ç¯çç§æ(Lucas Huang)\r\n * @LastEditTime: 2020-10-20 20:18:26\r\n * @Company: Inspur\r\n * @Version: v0.3.x\r\n */\r\n\r\nimport {Component, Input, ViewChild, OnChanges, SimpleChanges,\r\nEventEmitter,OnInit,Injector,ComponentFactoryResolver,\r\nOutput,ChangeDetectorRef,ViewEncapsulation,AfterViewInit,ViewContainerRef,\r\nforwardRef,ComponentRef,Type,ElementRef,NgZone,Renderer2,OnDestroy,HostListener,} from \"@angular/core\";\r\n\r\nimport { NG_VALUE_ACCESSOR } from \"@angular/forms\";\r\nimport { Observable, Subscription, of, Subject, BehaviorSubject } from \"rxjs\";\r\n\r\nimport { LocaleService } from \"@farris/ui-locale\";\r\nimport { IResizeEvent } from \"@farris/ui-draggable\";\r\nimport { MessagerService } from \"@farris/ui-messager\";\r\nimport { LoadingService, LoadingComponent } from \"@farris/ui-loading\";\r\nimport { DataTableComponent } from \"@farris/ui-datatable\";\r\nimport { TreeTableComponent, TreeNode } from \"@farris/ui-treetable\";\r\nimport { LayoutComponent, LayoutPanelComponent } from \"@farris/ui-layout\";\r\nimport { CommonUtils, DebugService, FarrisComponentInstanceService, OverLayHiddenService } from \"@farris/ui-common\";\r\nimport { EntityFilter, FilterCondition } from \"@farris/ui-common/types\";\r\nimport { ShortcutsService } from \"@farris/ui-shortcuts\";\r\nimport { InputGroupComponent } from \"@farris/ui-input-group\";\r\nimport { NotifyService } from \"@farris/ui-notify\";\r\n\r\nimport {\r\n    FAVORITE_FIELD_NAME,\r\n    INPUT_GROUP_ICON,\r\n    LookupGridDisplayType,\r\n    ExtInfoFormatter,\r\n    CustomDataFormatter,\r\n    QuickSelectOption,\r\n    QuickSelectDefaultOptions,\r\n    SearchBarMode,\r\n} from \"./lookup-displaytype\";\r\nimport { LookupComponent } from \"./lookup.component\";\r\nimport {\r\n    LookupGridOptions,\r\n    lookupGridDefaults,\r\n    LookupGridResult,\r\n    NavigationOptions,\r\n    DisplayInfo,\r\n    displayInfoDefault,\r\n    PickingResult,\r\n    TreeInfo,\r\n    LOAD_DATA_TYPE,\r\n    ONLY_SELECT_LEAF,\r\n    PersonalConfig} from \"./lookup-grid-options\";\r\nimport { ILookupHttpService, ServerSideToken } from \"./http/ILookupHttpService\";\r\nimport { NavigationFilter } from \"./http/RemoteParams\";\r\nimport { LookupLeftComponent } from \"./lookup-left.component\";\r\nimport { LookupDefaultMapping } from \"./lookup-defaut-mapping\";\r\nimport { LookupUtils } from \"./utils\";\r\nimport { PersonalConfigService } from \"./lookup-presonalConfig.service\";\r\nimport {\r\n    UtilService,\r\n    TreeNodeHelper,\r\n    FavoriteHelper,\r\n    SelectionManager,\r\n    DataTableEventManager,\r\n    TreeTableEventManager,\r\n    MultiSelectionManager,\r\n    LookupHttpManager,\r\n    LookupComponentManager,\r\n    LookupDialogManager,\r\n    onTextChanged,\r\n    LookupSelectionService,\r\n} from \"./services\";\r\nimport { catchError, map, switchMap } from \"rxjs/operators\";\r\n\r\nimport { EventManager } from \"@angular/platform-browser\";\r\nimport { cloneDeep } from \"lodash-es\";\r\nimport { SingleSelectDirective } from \"@farris/ui-forms\";\r\n\r\nexport const LOOKUPGRID_VALUE_ACCESSOR: any = {\r\n    provide: NG_VALUE_ACCESSOR,\r\n    useExisting: forwardRef(() => LookupGridComponent),\r\n    multi: true,\r\n};\r\n\r\n@Component({\r\n    selector: \"farris-lookup-grid\",\r\n    templateUrl: \"./lookup-grid.component.html\",\r\n    styleUrls: [\"./lookup-grid.component.scss\"],\r\n    providers: [\r\n        LOOKUPGRID_VALUE_ACCESSOR,\r\n        ShortcutsService,\r\n        LookupDefaultMapping,\r\n        LookupUtils,\r\n        PersonalConfigService,\r\n    ],\r\n    encapsulation: ViewEncapsulation.None,\r\n    exportAs: \"lookup\"\r\n})\r\nexport class LookupGridComponent\r\n    extends LookupComponent\r\n    implements OnInit, AfterViewInit, OnChanges, OnDestroy\r\n{\r\n    groupIcon = INPUT_GROUP_ICON;\r\n    _displayType = \"\";\r\n\r\n    /** ä½¿ç¨è¡¨åè®¾è®¡å¨ä¸­çæ¾ç¤ºç±»åãå¦åä½¿ç¨åæ°æ®è®¾ç½®çæ¾ç¤ºç±»åã é»è®¤ï¼false */\r\n    @Input() customDisplayType = false;\r\n    @Input() viewType: \"text\" | \"tag\" = \"text\";\r\n    @Input()\r\n    get displayType() {\r\n        return this._displayType;\r\n    }\r\n    set displayType(val: string) {\r\n        if (val) {\r\n            const types = Object.values(LookupGridDisplayType);\r\n            const i = types.findIndex((n) => n === val.toUpperCase());\r\n            if (i > -1) {\r\n                const keys = Object.keys(LookupGridDisplayType);\r\n                this._displayType = LookupGridDisplayType[keys[i]];\r\n            }\r\n        } else {\r\n            this._displayType = val;\r\n        }\r\n    }\r\n    /** å¯ç¨æ¸ç©ºæé® */\r\n    @Input() enableClear = true;\r\n    /** æå¡å¨ç«¯æåº */\r\n    @Input() remoteSort = true;\r\n\r\n    @Input() condition: EntityFilter;\r\n    @Input() conditions: Array<FilterCondition>;\r\n\r\n    /** æ è¡¨æ¾ç¤ºå¨éå¤éæ¡ã é»è®¤ä¸æ¾ç¤º */\r\n    @Input() showCheckAll = false;\r\n\r\n    /** æ¯å¦å¯ç¨å¤é */\r\n    @Input() singleSelect = true;\r\n    /** å¤éåéç¬¦, é»è®¤ä¸º , */\r\n    @Input() multipleChoiceSeparator = \",\";\r\n    /** ä¸»é®å­æ®µ */\r\n    @Input() idField?: string;\r\n    /** å¯ä»¥ä¸ºåæ°æ®IDãwebapiURL */\r\n    @Input() uri?: string = '';\r\n    /**\r\n     * BE REST RUI\r\n     * - æ­¤å¤è®¾ç½®å uri å¤±æ\r\n     */\r\n    @Input() beUri = \"\";\r\n    /**\r\n     * æ¾ç¤ºè¿æ»¤å·¥å·æ¡; é»è®¤ true\r\n     */\r\n    @Input() showFilterBar = true;\r\n    /** æ¯å¦å¯ç¨åé¡µ */\r\n    @Input() pagination = true;\r\n    /** å½åé¡µç´¢å¼ï¼ä» 1å¼å§ */\r\n    @Input() pageIndex = 1;\r\n    /** æ¯é¡µè®°å½æ° */\r\n    @Input() pageSize = 20;\r\n    /** å¯ç¨åé¡µè®°å½æ°åè¡¨ */\r\n    @Input() pageList = [10, 20, 30, 50, 100];\r\n    /** æ»è®°å½æ° */\r\n    @Input() total = 0;\r\n    /** å¯æå¨å */\r\n    // @Input() resizableColumns = true;\r\n    /** æ¾ç¤ºåä¿¡æ¯, é»è®¤ä¸º [] */\r\n    @Input() columns: any[] = [];\r\n\r\n    /** å¸®å©æ¥è¯¢æ¯å¦ä¸ºè¿ç«¯æ¥è¯¢ */\r\n    @Input() remoteSearch = true;\r\n\r\n    /** ææ¬åååï¼è¿è¡æå¡å¨ç«¯æ¥è¯¢ */\r\n    @Input() searchOnServer = true;\r\n    /** ä¸è¿è¡æå¡å¨æ¥è¯¢ï¼æå¥ç®å¥ */\r\n    @Input() nosearch = false;\r\n\r\n    /**\r\n     * å¯ç¨ä»»æè¾å¥åï¼å¼éè¿è¾å¥æ¶è§¦å\r\n     */\r\n    @Output() clearMappings = new EventEmitter();\r\n\r\n    /**\r\n     * åè®¸è¾å¥çå­ç¬¦æå¤§é¿åº¦ã\r\n     * ä»»æè¾å¥æ¶ï¼æ­¤å±æ§ææ\r\n     */\r\n    @Input() maxLength;\r\n\r\n    @Input() mappingFn: (rowData, mapFields, bindingData?: any) => void;\r\n    /** æ°æ®åè¡¨ */\r\n    @Input() items: any;\r\n    // æ¶èåè¡¨\r\n    @Input() favoriteItems: any[] = [];\r\n    /** èªå®ä¹æ°æ® */\r\n    @Input() customData: any;\r\n\r\n    /** ç»å®å¼æå¨çå¯¹è±¡ */\r\n    @Input() bindingData: {};\r\n\r\n    @Input() treeInfo: TreeInfo;\r\n    /** æ¯å¦å¯ç¨çº§èéæ©æ§å¶éé¡¹ */\r\n    @Input() enableCascade = false;\r\n    /** çº§èæ§å¶é»è®¤å¼ï¼ enable: åæ­¥éæ©, upï¼åå«ä¸çº§, downï¼åå«ä¸çº§, disableï¼ä»éæ©èªèº« */\r\n    @Input() cascadeStatus: \"enable\" | \"up\" | \"down\" | \"disable\" = \"enable\";\r\n    /** åå«çº§èéé¡¹çå¯ç¨ç¶æï¼é»è®¤å¨é¨å¯ç¨ */\r\n    @Input() cascadeItems = {\r\n        enable: true,\r\n        up: true, \r\n        down: true,\r\n        disable: true\r\n    }\r\n    /** æ¾ç¤ºçº§èæ§å¶ */\r\n    @Input() showCascadeControl = true;\r\n\r\n    @Input() placeholder = \"\";\r\n\r\n    /** æ¾ç¤ºå·²éè®°å½åè¡¨ã é»è®¤ä¸º false ä¸æ¾ç¤º */\r\n    @Input() showSelected = false;\r\n\r\n    /** åºç¨æ¶èå¤¹ */\r\n    @Input() useFavorite = false;\r\n    /** æ¶èæ°æ®æ¥èªäºï¼ locale: æ¬å°å­å¨ï¼ remote: æå¡å¨ç«¯å­å¨ */\r\n    @Input() favoriteDataFrom: \"locale\" | \"remote\" = \"remote\";\r\n    /** ä½¿ç¨æç¤º,å¿«æ·éæ© */\r\n    @Input() useTip = false;\r\n    /** è®°å½çªå£å¤§å° */\r\n    @Input() isRecordSize = false;\r\n\r\n    /** å¿«ééæ© */\r\n    @Input() userId: string;\r\n\r\n    /** æ¯å¦å¯ç¨éä¸­valueå¼å¯¹åºçè¡æ°æ®ï¼é»è®¤ true */\r\n    @Input() enableToSelect = true;\r\n\r\n    @Input() enableFindText = false;\r\n    /** -1: ä¸å±å¼ï¼ 0: å¨é¨å±å¼ï¼>0: å±å¼å°æå®çº§æ° */\r\n    @Input() expandLevel = -1;\r\n\r\n    @Input() navTreeTableOptions: any = {};\r\n    @Input() treeTableOptions: any = {};\r\n    @Input() dataTableOptions: any = {};\r\n\r\n\r\n    defaultTreeTableOptions = {\r\n        maxLevel: 9,\r\n        enableContextMenu: false,\r\n        contextMenuItems: [],\r\n    };\r\n\r\n    /** æ å½¢å¸®å©æ°æ®å è½½æ¹å¼ï¼ default: åç½®åæ°ï¼ loadall: å è½½ææ layerloadï¼åå±å è½½ */\r\n    @Input() loadTreeDataType: \"default\" | \"loadall\" | \"layerload\" = \"default\";\r\n\r\n    /** çªå£æå¼åç«å³å è½½æ°æ®ï¼é»è®¤ä¸º true */\r\n    @Input() loadDataWhenOpen = true;\r\n\r\n    /**\r\n     * å¯¼èªåè¡¨ï¼æ åè¡¨å¨å¸®å©æå¼åéä¸­çæ°æ®;\r\n     * è®¾ç½®åï¼`selectFirstInNav` å¤±æï¼\r\n     */\r\n    @Input() navSelectedIds = \"\";\r\n\r\n    /**\r\n     * å¯¼èªå¸®å©ï¼éä¸­ç¬¬1æ¡æ°æ®ï¼é»è®¤ä¸º false;\r\n     * æ³¨æï¼å½`navSelectedIds`ä¸ä¸ºç©ºæ¶ï¼æ­¤å±æ§å¤±æã\r\n     */\r\n    @Input() selectFirstInNav = false;\r\n\r\n    /** å¯ç¨æé å®æ´æ è¿æ»¤ */\r\n    @Input() enableFullTree = true;\r\n\r\n    /** æ¾ç¤ºææ¬èªå®ä¹å½æ° */\r\n    @Input() displayFormatter: (\r\n        value: string,\r\n        data: any,\r\n        instance: any\r\n    ) => string = undefined;\r\n    /** æ¾ç¤ºææ¬å­æ®µéåï¼ä»¥ è±æ éå·éå¼ */\r\n    @Input() displayFields = \"\";\r\n    @Input() displayTextSeparator = \"_\";\r\n\r\n    /**\r\n     * å¸®å©åæ°æ®IDï¼ä¸ä¸ºç©ºæ¶è°ç¨æå®çURI\r\n     * /api/runtime/bcc/v1.0/help/data/{helpId}\r\n     */\r\n    @Input() helpId = \"\";\r\n    /** ææ¬å¯¹é½æ¹å¼ï¼ left | center | right; é»è®¤ left */\r\n    @Input() textAlign = \"left\";\r\n\r\n    /** é¼ æ æ»è¿è¾å¥æ¡æ¶æ¾ç¤ºè¾å¥æ¡åçææ¬ä¿¡æ¯ */\r\n    @Input() enableTitle = true;\r\n    @Input() useExtendInfo = false;\r\n    @Input() extInfoFields = \"\";\r\n    @Input() extInfoFormatter: ExtInfoFormatter;\r\n    @Input() extendInfo = \"\";\r\n    /** IDE è®¾è®¡å¨èªå®ä¹æ ¼å¼å 2103 */\r\n    @Input() customFormatter: CustomDataFormatter = null;\r\n    @Input() customNavFormatter: CustomDataFormatter = null;\r\n\r\n    /** èªå®ä¹ç¡®å®äºä»¶ */\r\n    @Input() okHandler = null;\r\n    /** èªå®ä¹åæ¶äºä»¶ */\r\n    @Input() cancelHandler = null;\r\n\r\n    @Input() tagboxHeight = \"auto\";\r\n    @Input() maxTagboxHeight;\r\n\r\n    /** å¯ç¨è·åææå­çº§æ°æ®çåè½,ä»æ¯æåçº§ç  */\r\n    @Input() enableGetAllChildNodes = true;\r\n\r\n    @Input() shortcutKey = {\r\n        /** æå¼å¸®å©çªå£ */\r\n        open: \"ArrowRight\",\r\n        /** ç¡®è®¤éæ©æ°æ® */\r\n        confirm: \"Enter\",\r\n        /** æç´¢æ¡ç¦ç¹ */\r\n        searchFocus: \"F3\",\r\n        /** éä¸­ä¸ä¸æ¡ */\r\n        moveUp: \"ArrowUp\",\r\n        /** éä¸­ä¸ä¸æ¡ */\r\n        moveDown: \"ArrowDown\",\r\n        /** å±å¼èç¹ */\r\n        expand: \"ArrowRight\",\r\n        /** æå èç¹ */\r\n        collapse: \"ArrowLeft\",\r\n        /** ä¸ä¸é¡µ */\r\n        nextPager: \"PageDown\",\r\n        /** ä¸ä¸é¡µ */\r\n        prevPager: \"PageUp\",\r\n    };\r\n    /** å¿«æ·éæ©ç¸å³éç½®é¡¹ï¼é»è®¤ä¸º null, å³ä¸å¯ç¨æ­¤åè½ */\r\n    @Input() quickSelect: QuickSelectOption = null;\r\n\r\n    /** æ å½¢å¸®å© æ¯å¦ä½¿ç¨æ å½¢ç»ææ°æ®ãé»è®¤ä¸º true, å½ä¸º false æ¶ï¼æå¡å¨ç«¯æ é¡»æé æ å½¢ç»æï¼ææ®éåè¡¨è¾åº */\r\n    @Input() treeToList = false;\r\n    @Input() navTreeToList = false;\r\n\r\n    /** å¸¦å¯¼èªçå¸®å©ä¸­ï¼æ¯å¦æ¾ç¤ºå·¦ä¾§å¯¼èªé¨åãé»è®¤ true */\r\n    @Input() showNavigation = true;\r\n\r\n    /** æ°æ®éæ©åï¼å¼æ å°åè§¦å\r\n     * è¿å Observable\r\n     *      canSelect: <boolean>  æ¯å¦åè®¸éæ©\r\n     *      message: <string> ä¸åè®¸éæ©æ¶çæç¤ºä¿¡æ¯\r\n     */\r\n    @Input() beforeSelectData: (p: {\r\n        instance: any;\r\n        data: any;\r\n    }) => Observable<{ canSelect: boolean; message: string } | boolean>;\r\n\r\n    @Input() beforeLoadData: (p: { instance: any, res: LookupGridResult }) => Observable<LookupGridResult>;\r\n\r\n    /** æ¯å¦å¯ç¨æ°å¸å±\r\n     * - é»è®¤ false */\r\n    @Input() useNewLayout = false;\r\n\r\n    /** å¯ç¨å¤å­æ®µæ¥è¯¢ é»è®¤ä¸º false\r\n     * - å¯ç¨æ­¤ç¹æ§åï¼useNewLayout èªå¨å¯ç¨\r\n     */\r\n    @Input() enableMultiFieldSearch = false;\r\n    /** æç´¢å·¥å·æ¡æ¾ç¤ºæ¨¡å¼ï¼ both: å¨é¨æ¾ç¤ºï¼onlyfield: ä»æ¾ç¤ºå­æ®µï¼onlyinput: ä»æ¾ç¤ºæç´¢è¾å¥æ¡ãé»è®¤ both */\r\n    @Input() searchBarMode: SearchBarMode = SearchBarMode.both;\r\n    /** åè®¸æ¥è¯¢çå­æ®µï¼ä»å¯ç¨å¤å­æ®µæ¥è¯¢æ¶ææï¼å¤ä¸ªå­æ®µä»¥ â,â éå¼ï¼  \r\n     *  - nav å·¦ä¾§å¯¼èªå­æ®µï¼main ä¸»æ°æ®å­æ®µ;\r\n     *  - é»è®¤ä¸º null, å³ä»æææ¾ç¤ºåä¸­èªå¨æå\r\n     */\r\n    @Input() allowQueryFields:{ nav?: string, main: string } = null;\r\n\r\n    @Input() labels = {\r\n        /** æ°æ®åè¡¨*/\r\n        dataTab: '',\r\n        /** æ¶èå¤¹ */\r\n        favTab:'',\r\n        /** åæ¶å·²é */\r\n        clearAllSelected: '',\r\n        /** å·²éè®°å½é¢æ¿ä¸­ å é¤å·²é */\r\n        delSelected: ''\r\n    }\r\n\r\n    /** åè®¸ä»»æå­æ®µè¿è¡æ¥è¯¢ï¼ é»è®¤ true */\r\n    @Input() searchAnyField = true;\r\n\r\n    @Output() selectedData = new EventEmitter();\r\n    @Output() clear = new EventEmitter();\r\n    /** æªå¯ç¨å¤å­æ®µæ¥è¯¢æ¶è§¦å */\r\n    @Output() search = new EventEmitter();\r\n    /** å¯ç¨å¤å­æ®µæ¥è¯¢æ¶è§¦å */\r\n    @Output() query  = new EventEmitter();\r\n    // å¸®å©ææ¬æ¡ä¸­å¼ååäºä»¶\r\n    @Output() valueChanged = new EventEmitter();\r\n    @Output() loadSuccess = new EventEmitter();\r\n\r\n    @Output() pagerChanged = new EventEmitter();\r\n\r\n    @Output() expandTreeNode = new EventEmitter();\r\n    @Output() textChanged = new EventEmitter();\r\n\r\n    @Output() checkedChange = new EventEmitter<{\r\n        data: any;\r\n        isCheck: boolean;\r\n    }>();\r\n\r\n    @Output() tagRemoved = new EventEmitter();\r\n\r\n    /** åå®¹ä¸­çç½è¾¹è· */\r\n    containerMargin = { top: 0, bottom: 5, left:  14, right: 14 };\r\n    containerStyle = {\r\n    };\r\n\r\n    _gridOptions: LookupGridOptions = lookupGridDefaults;\r\n\r\n    get gridOptions() {\r\n        if (\r\n            this.useFavorite &&\r\n            this.columns &&\r\n            this.columns.length > 0 &&\r\n            !this.columns.find((item) => item.field === FAVORITE_FIELD_NAME)\r\n        ) {\r\n            this.columns.push({\r\n                field: FAVORITE_FIELD_NAME,\r\n                title: \"\",\r\n                width: 40,\r\n                align: \"center\",\r\n                fixed: 'right',\r\n                // fixedWidth: true,\r\n                formatter: this.favHelper.favoriteColumnFormatter,\r\n            });\r\n        }\r\n        this._gridOptions = Object.assign(this._gridOptions, {\r\n            singleSelect: this.singleSelect,\r\n            idField: this.idField,\r\n            uri: this.uri,\r\n            showFilterBar:  this.enableMultiFieldSearch? false: this.showFilterBar,\r\n            pagination: this.pagination,\r\n            pageIndex: this.pageIndex,\r\n            pageSize: this.pageSize,\r\n            pageList: this.pageList,\r\n            total: this.total,\r\n            items: this.items,\r\n            columns: this.columns,\r\n            resizableColumns: true,\r\n            fixedHeader: true,\r\n            hover: true,\r\n            treeInfo: this.treeInfo,\r\n            searchAnyField: this.searchAnyField\r\n        });\r\n\r\n        return this._gridOptions;\r\n    }\r\n    @Input() set gridOptions(opts) {\r\n        this._gridOptions = Object.assign({}, this._gridOptions, opts);\r\n        // this.selectedColumns = this.multiSelMgr.initSelectedColumns();\r\n    }\r\n\r\n    @ViewChild(\"contentContainer\", { read: ViewContainerRef })\r\n    contentContainer: ViewContainerRef;\r\n    @ViewChild(\"favoritesContainer\", { read: ViewContainerRef })\r\n    favoritesContainer: ViewContainerRef;\r\n    @ViewChild(\"leftContainer\", { read: ViewContainerRef })\r\n    leftContainer: ViewContainerRef;\r\n    @ViewChild(\"centerContainer\", { read: ViewContainerRef })\r\n    centerContainer: ViewContainerRef;\r\n    @ViewChild(\"multiSelectDT\") selectedDtRef: DataTableComponent;\r\n    @ViewChild(\"inputgroup\") inputGroup: InputGroupComponent;\r\n    @ViewChild(\"leftPanel\") leftPanel: LayoutPanelComponent;\r\n    @ViewChild(\"tagbox\") tagbox: ElementRef;\r\n\r\n    @ViewChild(\"okbtn\") okButton: ElementRef;\r\n    @ViewChild(\"tagInput\") tagInput: InputGroupComponent;\r\n\r\n    @ViewChild('selectedpanel') selectedpanel: ElementRef;\r\n    @ViewChild('cascadeSelect') cascadeSelect: SingleSelectDirective;\r\n    @ViewChild('layout') layoutRef: LayoutComponent;\r\n\r\n    componentRef: ComponentRef<any>;\r\n    leftComponentRef: ComponentRef<LookupLeftComponent>;\r\n    favoritesComponentRef: ComponentRef<any>;\r\n\r\n    public http: ILookupHttpService;\r\n    public messagerService: MessagerService;\r\n    public loadingService: LoadingService;\r\n    loading: LoadingComponent;\r\n    // dataFieldMaps: any;\r\n    navigationOptions: NavigationOptions;\r\n\r\n    // å¯¼èªå¸®å©å·¦åå®½åº¦\r\n    leftPanelWidth = 320;\r\n    // å¯¼èªå¸®å©çªå£æå°å®½åº¦\r\n    navLookupDialogMinWidth = 960;\r\n\r\n    navigationFilter: NavigationFilter = null;\r\n\r\n    subscriptions: Subscription[] = [];\r\n    dialogOpenedSubscription: Subscription;\r\n    dialogClosedSubscription: Subscription;\r\n\r\n    isTextChange = false;\r\n    isTabChanged = false;\r\n\r\n    displayInfo: DisplayInfo = Object.assign({}, displayInfoDefault);\r\n\r\n    tabChangeSubscription = null;\r\n    // æå­è¡ç¹å»æ°æ®  ç¨äºæ¶è\r\n    personalConf: PersonalConfig = {};\r\n    favoriteColumns: any[] = [];\r\n    /** ä¸´æ¶æ¥è¯¢åæ° */\r\n    _searchState = null;\r\n    allData: any = [];\r\n    get selections() {\r\n        const selectItems = this.lookupSelectionSer.getSelections();\r\n        if (this.singleSelect) {\r\n            return selectItems[0];\r\n        } else {\r\n            return selectItems;\r\n        }\r\n    }\r\n    get usePersionalConf() {\r\n        return this.useFavorite || this.useTip || this.isRecordSize;\r\n    }\r\n\r\n    get displayTextList() {\r\n        if (this.displayText) {\r\n            return this.displayText.split(this.multipleChoiceSeparator);\r\n        }\r\n        return [];\r\n    }\r\n\r\n    public personalConfigService: PersonalConfigService;\r\n    public utilService: UtilService;\r\n    public treeNodeHelper: TreeNodeHelper;\r\n    public localService: LocaleService;\r\n    public notifyService: NotifyService;\r\n    allColumnsTitle = \"ææå\";\r\n    mustWriteSomething = \"è¯·è¾å¥å³é®å­åæ¥è¯¢ã\";\r\n    mustChoosAdatarow = \"è¯·éæ©ä¸æ¡è®°å½ï¼\";\r\n    addFavoriteSuccess = \"æ¶èæåã\";\r\n    delFavoriteSuccess = \"ç§»é¤æ¶èæåã\";\r\n\r\n    /** ä½¿ç¨åç½®çæ¥è¯¢æ¹æ³, é»è®¤ false */\r\n    useInsideSearchHandler = false;\r\n    searching = false;\r\n    /** ä¸´æ¶å­å¨æ¥è¯¢ç»æé */\r\n    _searchResult = null;\r\n\r\n    lookupinitializationSubject = new Subject();\r\n\r\n    /** å¤éæ¶ï¼éä¸­çæ°æ® */\r\n    currentSelectedItems: Observable<any> = of([]);\r\n    /** å·²éæ°æ®åä¿¡æ¯ */\r\n    selectedColumns = [];\r\n    activeTab: string | \"datalist\" | \"favorite\" | \"selected\" = \"datalist\";\r\n\r\n    favHelper: FavoriteHelper = null;\r\n    ttEventMgr: TreeTableEventManager = null;\r\n    multiSelMgr: MultiSelectionManager = null;\r\n    httpMgr: LookupHttpManager = null;\r\n    lookupCmpMgr: LookupComponentManager = null;\r\n    dialogMgr: LookupDialogManager = null;\r\n    selectionMgr: SelectionManager = null;\r\n    dtEventMgr: DataTableEventManager = null;\r\n\r\n    lookupSelectionSer: LookupSelectionService = null;\r\n\r\n    controlId = \"\";\r\n    savingFaoriteData = false;\r\n    isReady = false;\r\n    showTagboxClearButton = false;\r\n    hasError = false;\r\n\r\n    cascadeStatusItems = [\r\n        { valeu: 'enable', label: '' },\r\n        { valeu: 'up', label: '' },\r\n        { valeu: 'down', label: '' },\r\n        { valeu: 'disable', label: '' }\r\n    ]\r\n\r\n    isGetAllChidlNodes = false;\r\n    eventManager: EventManager;\r\n    /** éä¸­è®°å½IDï¼èªå®ä¹å¸®å©åæ°æ¶ä½¿ç¨ */\r\n    selectedIds = [];\r\n    private lookupSearchInputEvent = null;\r\n    private farrisInstances: FarrisComponentInstanceService = null;\r\n    /** ç¨æ·åå§è®¾ç½® */\r\n    private _userSettings: any = {};\r\n\r\n    get userInitialConfig() {\r\n        return this._userSettings;\r\n    }\r\n\r\n    _treeInfo_ = null;\r\n\r\n    /** dialog åå®¹åºåé«åº¦ã å¼¹çªæ»é«åº¦ - å¤´é¨é«åº¦ - èé¨é«åº¦ - ï¼å¯ç¨æ¶è TABå¤´é«åº¦ï¼ */\r\n    dialogContentHeight = 0;\r\n    /** å·¦æ å³åè¡¨ï¼ å·¦æ ç¹å»èç¹æ¥è¯¢æ¶æ¯å¦åæ¬ä¸çº§èç¹çæ°æ®ï¼é»è®¤ false */\r\n    includeSubordinates = false;\r\n    includeSubordinates$ = new Subject();\r\n    includeSubordinates$$: Subscription = null;\r\n    overLayService: OverLayHiddenService;\r\n    private debugSer: DebugService = null;\r\n    constructor(\r\n        public injector: Injector,\r\n        public cfr: ComponentFactoryResolver,\r\n        public el: ElementRef,\r\n        public utils: CommonUtils,\r\n        private defaultMapping: LookupDefaultMapping,\r\n        public changeDetector: ChangeDetectorRef,\r\n        public shortcuts: ShortcutsService,\r\n        public lookupUtils: LookupUtils,\r\n        private zone: NgZone,\r\n        public render2: Renderer2\r\n    ) {\r\n        super(injector, el, changeDetector);\r\n        this.createInstance();\r\n        this.currentSelectedItems = this.lookupSelectionSer.selected$;\r\n        this.eventManager = this.injector.get(EventManager);\r\n        this.farrisInstances = this.injector.get(\r\n            FarrisComponentInstanceService,\r\n            null\r\n        );\r\n\r\n        this.overLayService = new OverLayHiddenService();\r\n\r\n        this.debugSer = this.injector.get(DebugService, null);\r\n        if (this.debugSer) {\r\n            this.debugSer.useDebugMode();\r\n        }\r\n\r\n        this.lookupSelectionSer.selectionChanged$.subscribe((e: {data: Array<any>, selected: boolean}) => {\r\n            if (this.selectedDtRef) {\r\n                if (!e.selected) {\r\n                    this.selectedDtRef.unCheckRows(e.data);\r\n                }\r\n            }\r\n        });\r\n\r\n        this.initLabels();\r\n    }\r\n\r\n    private initLabels() {\r\n        if (!this.labels) {\r\n            this.labels = {\r\n                /** æ°æ®åè¡¨*/\r\n                dataTab: '',\r\n                /** æ¶èå¤¹ */\r\n                favTab:'',\r\n                /** åæ¶å·²é */\r\n                clearAllSelected: '',\r\n                /** å·²éè®°å½é¢æ¿ä¸­ å é¤å·²é */\r\n                delSelected: ''\r\n            }\r\n        }\r\n        if (!this.labels.clearAllSelected) {\r\n            this.labels.clearAllSelected = this.localService.getValue('lookup.selectedInfo.clear');\r\n        }\r\n\r\n        if (!this.labels.favTab) {\r\n            this.labels.favTab = this.localService.getValue('lookup.favorites');\r\n        }\r\n\r\n        if (!this.labels.dataTab) {\r\n            this.labels.dataTab = this.localService.getValue('lookup.datalist');\r\n        }\r\n    }\r\n\r\n    writeConsole(msg, type: 'info'|'log'|'warn'|'error' = 'warn') {\r\n        if (this.debugSer) {\r\n            this.debugSer[type](msg);\r\n        }\r\n    }\r\n\r\n    getFilterBarHeight() {\r\n        return (this.showFilterBar && this.enableMultiFieldSearch ? 42 : 0);\r\n    }\r\n\r\n    getSpaceWidth(isDouble = false) {\r\n        return (!this.enableMultiFieldSearch ? 28 : 48) + (isDouble ? ( this.enableMultiFieldSearch? 5: 7) : 0);\r\n    }\r\n\r\n    private cacheUserConfig() {\r\n        this._userSettings._title = this.title;\r\n        this.displayInfo.title = this.title;\r\n        this._userSettings._columns = this.deepClone(this.columns || []);\r\n        this._userSettings.getColumns = () => {\r\n            return this._userSettings._columns;\r\n        };\r\n\r\n        this._userSettings.reset = () => {\r\n            this.title = this._userSettings._title;\r\n            this.displayInfo.title = this.title;\r\n            this.columns = this._userSettings.getColumns();\r\n        };\r\n    }\r\n\r\n    private deepClone(obj) {\r\n        if (obj === null) {\r\n            return null;\r\n        }\r\n        const clone = Object.assign({}, obj);\r\n        Object.keys(clone).forEach(\r\n            (key) =>\r\n                (clone[key] =\r\n                    typeof obj[key] === \"object\"\r\n                        ? this.deepClone(obj[key])\r\n                        : obj[key])\r\n        );\r\n        if (Array.isArray(obj)) {\r\n            clone.length = obj.length;\r\n            return Array.from(clone);\r\n        }\r\n        return clone;\r\n    }\r\n\r\n    ngOnInit() {\r\n        super.ngOnInit();\r\n        this.cacheUserConfig();\r\n        if (!this.loadTreeDataType) {\r\n            this.loadTreeDataType = \"default\";\r\n        }\r\n\r\n        this.checkGridOptions();\r\n        this.displayInfo.title = this.title;\r\n        /** ä¼ éä¸ä¸æ */\r\n        if (this.http) {\r\n            this.http.context = this.context;\r\n        }\r\n\r\n        this.allColumnsTitle = this.localService.getValue(\"lookup.allColumns\");\r\n        this.mustWriteSomething = this.localService.getValue(\r\n            \"lookup.mustWriteSomething\"\r\n        );\r\n        this.mustChoosAdatarow = this.localService.getValue(\r\n            \"lookup.mustChoosAdatarow\"\r\n        );\r\n        this.addFavoriteSuccess =\r\n            this.localService.getValue(\"lookup.favoriteInfo.addFav\") ||\r\n            this.addFavoriteSuccess;\r\n        this.delFavoriteSuccess =\r\n            this.localService.getValue(\"lookup.favoriteInfo.cancelFav\") ||\r\n            this.delFavoriteSuccess;\r\n\r\n        this.dialogMgr.onDialogCreated();\r\n\r\n        this._treeInfo_ = this.treeInfo ? cloneDeep(this.treeInfo) : null;\r\n\r\n        if (this.quickSelect) {\r\n            this.quickSelect = Object.assign({}, QuickSelectDefaultOptions, this.quickSelect || {});\r\n        }\r\n        this.setContainerMargin();\r\n    }\r\n    /** åå®¹ä¸­çç½è¾¹è· */\r\n    setContainerMargin() {\r\n        const mrn = !this.enableMultiFieldSearch ? 14 : 24;\r\n        const mb =  !this.enableMultiFieldSearch ? 5 : 0;\r\n        this.containerMargin = { top: 0, bottom: mb, left: mrn, right: mrn };\r\n        \r\n        if (this.enableMultiFieldSearch) {\r\n            this.useNewLayout = true;\r\n        }\r\n\r\n        this.containerStyle = {\r\n            marginLeft: this.containerMargin.left + \"px\",\r\n            marginRight: this.containerMargin.right + \"px\",\r\n            marginTop: this.containerMargin.top + \"px\",\r\n            marginBottom: this.containerMargin.bottom + \"px\",\r\n        };\r\n    }\r\n\r\n    ngOnDestroy() {\r\n        super.ngOnDestroy();\r\n        this.subscriptions.forEach((n) => {\r\n            if (n) {\r\n                n.unsubscribe();\r\n                n = null;\r\n            }\r\n        });\r\n\r\n        if (this.selectionMgr) {\r\n            this.selectionMgr.destroy();\r\n        }\r\n\r\n        this.subscriptions = [];\r\n\r\n        if (this.farrisInstances) {\r\n            this.farrisInstances.destroy(this.el.nativeElement);\r\n        }\r\n\r\n        if (this.lookupSearchInputEvent) {\r\n            this.lookupSearchInputEvent();\r\n        }\r\n        this.lookupUtils.destroy();\r\n\r\n        this.overLayService.destory(this.el.nativeElement);\r\n        this.overLayService = null;\r\n    }\r\n\r\n    ngOnChanges(changes: SimpleChanges) {\r\n        if (changes.columns && !changes.columns.isFirstChange()) {\r\n            this.cacheUserConfig();\r\n        }\r\n\r\n        if (changes.enableMultiFieldSearch && !changes.enableMultiFieldSearch.isFirstChange()) {\r\n            this.setContainerMargin();\r\n        }\r\n\r\n    }\r\n\r\n    ngAfterViewInit() {\r\n        if (!this.quickSelect || !this.quickSelect.enable) {\r\n            this.lookupSearchInputEvent = onTextChanged.bind(this)();\r\n        }\r\n\r\n        // åå§åä¸ªæ§åéç½®\r\n        if (this.usePersionalConf) {\r\n            this.favHelper.initPersonalInfo();\r\n        }\r\n\r\n        if (this.useExtendInfo) {\r\n            const jsonData = this.selectionMgr.getBindingData();\r\n            this.updateExtendInfo(jsonData, false);\r\n        }\r\n\r\n        if (this.viewType === \"text\") {\r\n            // this.shortcuts.add({\r\n            //     key: 'F2',\r\n            //     target: this.inputGroup.textbox.nativeElement,\r\n            //     command: () => {\r\n            //         this.showDialog();\r\n            //     }\r\n            // });\r\n            this.render2.listen(\r\n                this.inputGroup.textbox.nativeElement,\r\n                \"keydown.F2\",\r\n                this.showDialog.bind(this)\r\n            );\r\n        } else {\r\n            this.registerMouseEventForTagView();\r\n\r\n            if (this.tagboxHeight) {\r\n                const el =\r\n                    this.tagbox.nativeElement.querySelector(\".multi-more\");\r\n                let tbh = this.tagboxHeight;\r\n                if (tbh !== \"auto\") {\r\n                    tbh += \"px\";\r\n\r\n                    if (this.maxTagboxHeight) {\r\n                        this.render2.setStyle(\r\n                            el,\r\n                            \"maxHeight\",\r\n                            `${this.maxTagboxHeight}px`\r\n                        );\r\n                    }\r\n                }\r\n\r\n                this.render2.setStyle(el, \"height\", tbh);\r\n            }\r\n        }\r\n\r\n        if (this.el && this.farrisInstances) {\r\n            this.farrisInstances.add(this.el.nativeElement, this);\r\n        }\r\n    }\r\n\r\n    private createInstance() {\r\n        this.http = this.injector.get(ServerSideToken, null);\r\n        this.messagerService = this.injector.get(MessagerService);\r\n        this.loadingService = this.injector.get(LoadingService);\r\n        this.notifyService = this.injector.get(NotifyService, null);\r\n\r\n        this.personalConfigService = this.injector.get(\r\n            PersonalConfigService,\r\n            null\r\n        );\r\n\r\n        this.lookupSelectionSer = new LookupSelectionService(this);\r\n\r\n        this.utilService = new UtilService(this);\r\n        this.localService = this.injector.get(LocaleService);\r\n        this.treeNodeHelper = new TreeNodeHelper(this);\r\n\r\n        this.favHelper = new FavoriteHelper(this);\r\n        this.ttEventMgr = new TreeTableEventManager(this);\r\n        this.multiSelMgr = new MultiSelectionManager(this);\r\n        this.httpMgr = new LookupHttpManager(this);\r\n        this.lookupCmpMgr = new LookupComponentManager(this);\r\n        this.dialogMgr = new LookupDialogManager(this);\r\n        this.selectionMgr = new SelectionManager(this);\r\n        this.dtEventMgr = new DataTableEventManager(this);\r\n    }\r\n\r\n    showDialog(): any {\r\n        if (this.disabled || this.readonly) {\r\n            return false;\r\n        }\r\n\r\n        this.selectionMgr.initDisplayValue();\r\n        this.dictPickingSubscription = this.dictPicking({\r\n            instance: this,\r\n        }).subscribe((pr: PickingResult) => {\r\n            this.dialogMgr.canOpenDialog(pr);\r\n        });\r\n\r\n        return false;\r\n    }\r\n\r\n    /** å¤æ­æ¯å¦ä¸ºååè¡¨å¸®å© */\r\n    isDoublleList() {\r\n        return (\r\n           ( this.displayType === LookupGridDisplayType.NavList ||\r\n            this.displayType === LookupGridDisplayType.NavTreeList ||\r\n            this.displayType === LookupGridDisplayType.NavListTree) && this.showNavigation\r\n        );\r\n    }\r\n    /** å¤æ­æ¯å¦æ¾ç¤ºä¸ºæ å¸®å© */\r\n    isTree() {\r\n        const dtyp = this.displayType.toUpperCase()\r\n        return (\r\n            dtyp === LookupGridDisplayType.TreeList || dtyp === LookupGridDisplayType.NavListTree\r\n        );\r\n    }\r\n\r\n    onResized(e: any) {\r\n        this.resizeCmp(e.size);\r\n        this.resized.emit(e.size);\r\n    }\r\n\r\n    onResizing(pos: IResizeEvent) {\r\n        this.resizing.emit(pos.size);\r\n        this.resizeCmp(pos.size);\r\n        if (this.isDoublleList() && this.leftComponentRef) {\r\n            this.leftComponentRef.instance.resize({\r\n                width: this.leftPanel.width,\r\n                height: this.dialogMgr.getHeight(),\r\n            });\r\n        }\r\n    }\r\n\r\n    onMaxDialog(pos: IResizeEvent) {\r\n        this.resizeCmp(pos.size);\r\n        if (this.leftPanel) {\r\n            this.leftComponentRef.instance.resize({\r\n                width: this.leftPanel.width,\r\n                height: this.dialogMgr.getHeight(),\r\n            });\r\n        }\r\n        // tfs 543132 \r\n        // this.dialogHeight = pos.size.height;\r\n        this.dialogContentHeight = this.dialogMgr.resetDialogContentHeight();\r\n        this.dialogMaxed.emit(pos.size);\r\n    }\r\n\r\n    resizeCmp(size?: any) {\r\n        if (!this.componentRef || !this.componentRef.instance) {\r\n            return;\r\n        }\r\n\r\n        if (!size) {\r\n            size = this.dialog.size;\r\n        }\r\n        const _size = {\r\n            width:\r\n                size.width -\r\n                this.containerMargin.left -\r\n                this.containerMargin.right,\r\n            height: 0\r\n        };\r\n\r\n        if (this.useFavorite && this.favoritesComponentRef && this.activeTab == 'favorite') {\r\n            _size.height = this.lookupCmpMgr.getCmpHeight(true);\r\n            this.favoritesComponentRef.instance.resize(_size);\r\n        } else {\r\n            _size.height = this.lookupCmpMgr.getCmpHeight();\r\n            if (this.isDoublleList()) {\r\n                _size.width = size.width - this.leftPanel.width - this.getSpaceWidth(true);\r\n            }\r\n    \r\n            this.componentRef.instance.resize(_size);\r\n        }\r\n\r\n        if (this.isRecordSize) {\r\n            this.personalConf.size = this.dialog.size;\r\n            this.personalConfigService.updatePersonalConfig({\r\n                size: this.dialog.size,\r\n            });\r\n        }\r\n\r\n        if (this.isDoublleList() && this.layoutRef) {\r\n            this.layoutRef.setPanelMaxSize();\r\n        }\r\n    }\r\n\r\n    private checkGridOptions() {\r\n        if (!this.gridOptions.idField) {\r\n            this.writeConsole(\"æªè®¾ç½®ä¸»é®å­æ®µ idField\");\r\n        }\r\n\r\n        if (!this.beforeSelectData) {\r\n            this.beforeSelectData = () => {\r\n                return of(true);\r\n            };\r\n        }\r\n\r\n        const ctxMenuLanguages =\r\n            this.localService.getValue(\"lookup.contextMenu\");\r\n\r\n        this.treeTableOptions = Object.assign(\r\n            { language: ctxMenuLanguages },\r\n            this.defaultTreeTableOptions,\r\n            this.treeTableOptions || {}\r\n        );\r\n    }\r\n\r\n    getComponentType(): Type<any> {\r\n        if (!this.displayType) {\r\n            this.displayType = \"LIST\";\r\n        }\r\n        switch (this.displayType) {\r\n            case LookupGridDisplayType.List:\r\n            case LookupGridDisplayType.NavList:\r\n            case LookupGridDisplayType.NavTreeList:\r\n                return DataTableComponent;\r\n            case LookupGridDisplayType.TreeList:\r\n            case LookupGridDisplayType.NavListTree:\r\n                return TreeTableComponent;\r\n        }\r\n    }\r\n\r\n    showLoading(msg = \"\") {\r\n        if (this.dialog && this.dialog.modalContent && !this.loading) {\r\n            const opts = {\r\n                container: this.dialog.modalContent,\r\n                delay: 200,\r\n            };\r\n\r\n            if (msg) {\r\n                opts[\"message\"] = msg;\r\n            }\r\n\r\n            this.loading = this.loadingService.show(opts);\r\n        } else {\r\n            this.loading = this.loadingService.show();\r\n        }\r\n    }\r\n\r\n    closeLoading() {\r\n        if (this.loading) {\r\n            this.loading.close();\r\n            this.loading = null;\r\n        }\r\n\r\n        this.loadingService.clearAll();\r\n    }\r\n\r\n    getSearchColumns(resdata: any): {label: string, value: string}[] {\r\n        const cols = resdata.columns || this.columns;\r\n        if (resdata.searchFields) {\r\n            return resdata.searchFields.map((sf) => {\r\n                const c = cols.find(\r\n                    (col) => col.field.toLowerCase() === sf.value.toLowerCase()\r\n                );\r\n                if (c) {\r\n                    sf.label = c.title;\r\n                }\r\n                return sf;\r\n            });\r\n        } else if (cols) {\r\n            return cols\r\n                .filter((c) => c.searchField)\r\n                .map((col) => {\r\n                    return {\r\n                        label: col.title,\r\n                        value: col.field,\r\n                    };\r\n                });\r\n        }\r\n        return [];\r\n    }\r\n\r\n    private initOptions(resData: LookupGridResult) {\r\n        let obser = of(true);\r\n        this.gridOptions.searchFields = this.getSearchColumns(resData);\r\n        if (resData) {\r\n            // å¦æç»ä»¶ä¸­æªè®¾ç½®æ¾ç¤ºåï¼åä½¿ç¨æå¡å¨ç«¯è¿åçè®¾ç½®ï¼ å¦åå°ä½¿ç¨ç»ä»¶ä¸­éç½®çå±ç¤ºå\r\n            if (\r\n                (!this.columns || !this.columns.length) &&\r\n                resData.columns &&\r\n                resData.columns.length\r\n            ) {\r\n                this.columns = resData.columns;\r\n            }\r\n\r\n            this.initColumnWidth(this.columns);\r\n\r\n            this.setLookupTitleText(resData);\r\n\r\n            if (\r\n                this.isDoublleList() &&\r\n                this.dialogWidth < this.navLookupDialogMinWidth &&\r\n                !this.isRecordSize\r\n            ) {\r\n                this.dialogWidth = this.navLookupDialogMinWidth;\r\n                this.dialog.reSize({ width: this.dialogWidth });\r\n            }\r\n\r\n            if (!this.customDisplayType) {\r\n                // this.displayType = resData.displayType || this.displayType || 'LIST';\r\n                // if (this.treeToList) {\r\n                //     this.displayType = this.isDoublleList() ? ' NAVLIST ': 'LIST';\r\n                // }\r\n                this.changeDetector.detectChanges();\r\n                this.lookupCmpMgr.createComponentWithServerData(resData);\r\n            }\r\n\r\n            if ( this.isDoublleList() && resData.navigation && !this.leftComponentRef) {\r\n                this.navigationOptions = resData.navigation;\r\n                this.navigationOptions.hover = true;\r\n                this.navigationOptions.searchFields = this.getSearchColumns(this.navigationOptions);\r\n                this.initColumnWidth(this.navigationOptions.columns, 'nav');\r\n\r\n                // update columns formatter\r\n                if (this.customNavFormatter) {\r\n                    this.navigationOptions.columns.forEach((col) => {\r\n                        if (this.customNavFormatter[col.field]) {\r\n                            col.formatter = this.customNavFormatter[col.field];\r\n                        }\r\n                    });\r\n\r\n                    this.navigationOptions[\"rowStyler\"] =\r\n                        this.customNavFormatter.rowStyler;\r\n                    this.navigationOptions[\"cellStyler\"] =\r\n                        this.customNavFormatter.cellStyler;\r\n                }\r\n                // 20210926 æ å¯¼èªå¸®å©ä¸­ å·¦ä¾§æ æ¯æåå±å è½½\r\n                if (this.displayType === LookupGridDisplayType.NavTreeList) {\r\n                    let _nav_treeinfo_loadtype =\r\n                        this.navigationOptions.treeInfo.loadDataType;\r\n                    if (this.loadTreeDataType !== \"default\") {\r\n                        _nav_treeinfo_loadtype =\r\n                            this.loadTreeDataType === \"loadall\"\r\n                                ? \"all\"\r\n                                : \"async\";\r\n                    }\r\n                    this.navigationOptions.treeInfo.loadDataType =\r\n                        _nav_treeinfo_loadtype;\r\n                }\r\n\r\n                obser = this.lookupCmpMgr.createLeftComponent(this.navigationOptions);\r\n            }\r\n        } else {\r\n            this.lookupCmpMgr.createContent(this.gridOptions);\r\n            this.lookupCmpMgr.createFavoriteComponent();\r\n        }\r\n\r\n        if (this.isTextChange) {\r\n            this.componentRef.instance.searchData.value = this.displayText;\r\n        } else {\r\n            if (this._searchState && this._searchState.value) {\r\n                this.componentRef.instance.searchData.value = this._searchState.value;\r\n            }\r\n        }\r\n\r\n        // update columns formatter\r\n        if (this.customFormatter) {\r\n            this.columns.forEach((col) => {\r\n                if (this.customFormatter[col.field]) {\r\n                    col.formatter = this.customFormatter[col.field];\r\n                }\r\n            });\r\n\r\n            if (this.customFormatter.rowStyler) {\r\n                this.componentRef.instance.rowStyler = this.customFormatter.rowStyler;\r\n            }\r\n\r\n            if (this.customFormatter.cellStyler) {\r\n                this.componentRef.instance.cellStyler = this.customFormatter.cellStyler;\r\n            }\r\n        } else {\r\n            if (resData.customStyles) {\r\n                const { row: rowStylers, cell: cellStylers } = resData.customStyles;\r\n\r\n                const filterFn = (n, data) => {\r\n                    const d = this.utils.getValue(n.field, data);\r\n                    if (typeof d === 'boolean') {\r\n                        if (n.value == '0' || n.value == '1' || n.value == 'true' || n.value == 'false') {\r\n                            return d === (n.value == '0' || n.value == 'false') ? false : true;\r\n                        }\r\n                        return d === !!n.value;\r\n                    }\r\n                    return d === n.value;\r\n                }\r\n\r\n                if (rowStylers) {\r\n                    this.componentRef.instance.rowStyler = ({ data }) => {\r\n                        const styleItem = rowStylers.find(n => {\r\n                            return filterFn(n, data);\r\n                        });\r\n                        if (styleItem) {\r\n                            return styleItem.styles;\r\n                        }\r\n\r\n                        return null;\r\n                    }\r\n                }\r\n\r\n                if (cellStylers) {\r\n                    this.componentRef.instance.cellStyler = (e, field) => {\r\n                        const { data } = e;\r\n                        const styleItem = cellStylers.filter(n => n.field === field).find(t => {\r\n                            return filterFn(t, data);\r\n                        });\r\n\r\n                        if (styleItem) {\r\n                            return styleItem.styles;\r\n                        }\r\n\r\n                        return null;\r\n                    }\r\n                }\r\n\r\n            }\r\n        }\r\n\r\n        // this.changeDetector.detectChanges();\r\n        return obser;\r\n    }\r\n\r\n    /**\r\n     * è®¾ç½®å¸®å©çªå£æ é¢\r\n     */\r\n    private setLookupTitleText(resData: LookupGridResult) {\r\n        if (resData.displayInfo) {\r\n            this.displayInfo = resData.displayInfo;\r\n        }\r\n\r\n        // å¦æèªå®ä¹æ é¢ï¼å°ä»¥æ­¤æ é¢ä¸ºåãå¦åå è½½æå¡å¨ç«¯è¿åçæ°æ®\r\n        if (this.title && this.title !== \"æ­¤å¤æ¾ç¤ºå¸®å©æ é¢\") {\r\n            this.displayInfo.title = this.title;\r\n        }\r\n\r\n        if (this.displayInfo && resData.title) {\r\n            if (!this.displayInfo.title) {\r\n                this.displayInfo.title = resData.title;\r\n            }\r\n        }\r\n    }\r\n\r\n    private showGetAllChildrenCheckbox() {\r\n        if (this.isTree() && this.treeInfo) {\r\n            this.enableGetAllChildNodes =\r\n                this.treeInfo.loadDataType !== \"all\" && this.treeInfo.layerType === \"pathcode\";\r\n        } else {\r\n            this.enableGetAllChildNodes = false;\r\n        }\r\n    }\r\n\r\n    initData() {\r\n\r\n        const observer = {\r\n            next: (data: LookupGridResult) => {\r\n\r\n                if (data === false) {\r\n                    if (!this.columns || !this.columns.length) {\r\n                        this.closeLoading();\r\n                        this.closeDialog();\r\n                        if (!this.messagerService.modals || !this.messagerService.modals.length) {\r\n                            this.notifyService.error({msg: this.localService.getValue('lookup.configError') , timeout: 3000});\r\n                        }\r\n                        return;\r\n                    }\r\n                }\r\n\r\n                // æå¡å¨ç«¯åçéè¯¯ï¼è¿åNULL æ¶ï¼ç´æ¥å³é­çªå£\r\n                if (data === null) {\r\n                    this.isShow = false;\r\n                    if (this.dialog) {\r\n                        this.dialog.close();\r\n                    }\r\n                    return;\r\n                }\r\n                this.initOptions(data).subscribe(() => {\r\n                    this.selectedColumns = this.multiSelMgr.initSelectedColumns();\r\n                    // this.favoriteColumns = this.favHelper.getFavoriteColumns();\r\n\r\n                    if (this.usePersionalConf) {\r\n                        if (!this.personalConfigService.getPersonalData()) {\r\n                            this.personalConfigService.savePersonalConfig(\r\n                                this.personalConf\r\n                            );\r\n                        }\r\n                    }\r\n                    if (!this.isTabChanged) {\r\n                        this.lookupSelectionSer.loadSelections(\r\n                            data.selectedItems || []\r\n                        );\r\n                    }\r\n\r\n                    if (this.isDoublleList()) {\r\n                        // å¯¼èªå¸®å©æ¶ï¼è®¾ç½®å·¦ä¾§éä¸­æ°æ®æ¶ï¼ä¸å è½½ä¸»æ°æ®åè¡¨ã\r\n                        if (this.navSelectedIds || this.selectFirstInNav) {\r\n                            this.loadDataWhenOpen = false;\r\n                        }\r\n                    }\r\n\r\n                    if (data['activeTab'] && !this.isTabChanged) {\r\n                        this.activeTab = 'datalist';\r\n\r\n                        if (this.personalConf && this.personalConf.tabIndex !== this.activeTab) {\r\n                            this.personalConf.tabIndex = this.activeTab;\r\n                        }\r\n\r\n                    }\r\n\r\n                    this.loadData(data);\r\n\r\n                    if (this.isTree()) {\r\n                        if (this.activeTab === \"datalist\") {\r\n                            const tt = this.componentRef.instance as TreeTableComponent;\r\n                            if (tt.searchData.value && this.items && this.items.length) {\r\n                                if (this.items[0].children && this.items[0].children.length) {\r\n                                    tt.toggleExpand(this.items[0], true, false);\r\n                                }\r\n                            }\r\n                        }\r\n                        this.showGetAllChildrenCheckbox();\r\n\r\n                    }\r\n                    this.isTextChange = false;\r\n                    this._searchResult = null; // æ¸ç©ºä¸´æ¶æ¥è¯¢ ç»æ\r\n                    this.closeLoading();\r\n                    // this.isReady$.next(true);\r\n                    this.isReady = true;\r\n                    this.changeDetector.detectChanges();\r\n                    this.lookupinitializationSubject.next();\r\n\r\n                    if (this.layoutRef) {\r\n                        this.layoutRef.setPanelMaxSize();\r\n                    }\r\n                });\r\n            },\r\n            error: (err: any) => {\r\n                // this.isReady$.next(true);\r\n                this.closeLoading();\r\n                this._searchResult = null; // æ¸ç©ºä¸´æ¶æ¥è¯¢ ç»æ\r\n                this.isTextChange = false;\r\n\r\n                this.hasError = true;\r\n                this.changeDetector.detectChanges();\r\n                if (typeof err === \"string\") {\r\n                    this.messagerService.error(err);\r\n                } else {\r\n                    if (err) {\r\n                        if (err.Message) {\r\n                            this.messagerService.error(err.Message);\r\n                        } else {\r\n                            if (err.error) {\r\n                                this.messagerService.exception(err.error);\r\n                            } else {\r\n                                this.messagerService.error(\r\n                                    \"åºç¨æå¡å¨éè¯¯,è¯·èç³»ç³»ç»ç®¡çåï¼\"\r\n                                );\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            },\r\n        };\r\n\r\n        let p: any = {\r\n            pageInfo: {\r\n                pageSize: this.pageSize || 20,\r\n                pageIndex: 1,\r\n            },\r\n        };\r\n        let t: LOAD_DATA_TYPE = \"all\";\r\n        if (this.isTextChange) {\r\n            this._searchState = { \r\n                field: \"*\",\r\n                value: this.displayText\r\n            }\r\n        }\r\n\r\n        // åå±å è½½æ¯æè®¾ç½®å±å¼å±çº§\r\n        if (this.isTree() || this.displayType === LookupGridDisplayType.NavTreeList) {\r\n            if (this.expandLevel > -1) {\r\n                p['expandLevel'] = this.expandLevel;\r\n            }\r\n        }\r\n\r\n        if (this._searchState && this._searchState.value) {\r\n            p['search'] = this._searchState;\r\n            t = 'search';\r\n\r\n            // if (this.conditions && !this.conditions.length && this.enableMultiFieldSearch) {\r\n            //     this.conditions = [{\r\n            //         \"filterField\": this.textField,\r\n            //         \"value\": this._searchState.value,\r\n            //         \"lbracket\": \"\",\r\n            //         \"rbracket\": \"\",\r\n            //         \"relation\": 0,\r\n            //         \"compare\": 6\r\n            //     }];\r\n            // }\r\n        }\r\n\r\n\r\n        if (!this.isTabChanged && this.enableToSelect) {\r\n            const vals = this.selectionMgr.getSelectedIds();\r\n            if (vals && vals.length) {\r\n                p[\"selectedInfo\"] = {\r\n                    selected: true,\r\n                    selectedIds: vals,\r\n                };\r\n            } else {\r\n                if (this[\"selectedIds\"]) {\r\n                    p[\"selectedInfo\"] = {\r\n                        selected: true,\r\n                        selectedIds: this[\"selectedIds\"],\r\n                    };\r\n                }\r\n            }\r\n        }\r\n\r\n        this.showLoading();\r\n        this.hasError = false;\r\n       \r\n        this.httpMgr.lookupRequest(p, t).pipe(\r\n            map((restData: LookupGridResult) => {\r\n                if (restData) {\r\n                    restData.selectedItems = restData[\"selectedData\"] || [];\r\n                } else {\r\n                    if (restData && typeof restData === \"object\") {\r\n                        restData.selectedItems = [];\r\n                    }\r\n                }\r\n                return restData === null ? false : restData;\r\n            }),\r\n            switchMap((res: LookupGridResult) => {\r\n                if (this.beforeLoadData) {\r\n                    return this.beforeLoadData({instance: this, res});\r\n                }\r\n                return of(res);\r\n            })\r\n        ).subscribe(observer);\r\n    }\r\n\r\n    loadData(resData?: LookupGridResult, rebindEvent = true) {\r\n        if (this.activeTab === \"datalist\") {\r\n            if (this.useFavorite && !this.isTree()) {\r\n                this.favHelper.updateFavoritesStatus(resData.items);\r\n            }\r\n\r\n            switch (this.displayType) {\r\n                case LookupGridDisplayType.NavList:\r\n                case LookupGridDisplayType.NavTreeList:\r\n                case LookupGridDisplayType.List:\r\n                    this.loadDataTableData(resData);\r\n                    if (rebindEvent) {\r\n                        this.dtEventMgr.bindDataTableEvent();\r\n                    }\r\n                    break;\r\n                case LookupGridDisplayType.TreeList:\r\n                case LookupGridDisplayType.NavListTree:\r\n                    this.loadTreeTableData(resData, rebindEvent);\r\n                    break;\r\n            }\r\n        } else if (this.activeTab === \"favorite\") {\r\n            this.loadFavData(resData);\r\n        }\r\n\r\n        // éä¸­æ°æ®\r\n        this.selectionMgr.selectCurrentValue();\r\n    }\r\n\r\n    private loadFavData(result: LookupGridResult) {\r\n        // å è½½æ¶èæ°æ®\r\n        if (this.useFavorite) {\r\n            if (this.isTree()) {\r\n                this.setTreeInfo(result);\r\n                const treeNodes = this.favHelper.initFavoriteTreeData(\r\n                    result.items\r\n                );\r\n                const treeData = this.treeNodeHelper\r\n                    .flatTreeNodes(treeNodes)\r\n                    .map((n) => {\r\n                        n.data[\"_addtional_\"] = n[\"addtional\"];\r\n                        return n.data;\r\n                    });\r\n                this.lookupSelectionSer.initFavoriteItems(treeData);\r\n\r\n                setTimeout(() => {\r\n                    this.favoritesComponentRef.instance.scrollToY(1);\r\n                });\r\n            } else {\r\n                this.lookupSelectionSer.initFavoriteItems(result.items);\r\n            }\r\n\r\n            this.favHelper.loadFavoritesData(result);\r\n        }\r\n    }\r\n\r\n    loadDataTableData(resData?: LookupGridResult) {\r\n        if (resData) {\r\n            if (this.useFavorite && !this.isTree()) {\r\n                this.favHelper.updateFavoritesStatus(resData.items);\r\n            }\r\n            if (this.gridOptions) {\r\n                if (resData && resData.columns && resData.columns.length) {\r\n                    if (\r\n                        !this.gridOptions.columns ||\r\n                        !this.gridOptions.columns.length\r\n                    ) {\r\n                        this.columns = resData.columns;\r\n                    }\r\n                }\r\n\r\n                this.items = resData.items;\r\n                this.total = resData.total || resData.items.length;\r\n                if ( resData.searchFields ) {\r\n                    this.gridOptions.searchFields = this.getSearchColumns(resData);\r\n                }\r\n                if (resData.pageInfo) {\r\n                    if (\r\n                        resData.pageInfo.pageList &&\r\n                        (!this.pageList || !this.pageList.length)\r\n                    ) {\r\n                        this.pageList = resData.pageInfo.pageList;\r\n                    }\r\n                    this.pagination = resData.pageInfo.enablePager;\r\n                    this.pageIndex = resData.pageInfo.pageIndex;\r\n                    this.pageSize = resData.pageInfo.pageSize;\r\n                } else {\r\n                    this.pagination = false;\r\n                }\r\n            } else {\r\n                this.gridOptions = resData as LookupGridOptions;\r\n            }\r\n        }\r\n\r\n        this.updateDataTable(this.gridOptions);\r\n    }\r\n\r\n    private updateDataTable(opts: any) {\r\n        if (opts) {\r\n            const dt = this.componentRef.instance as DataTableComponent;\r\n\r\n            if (!dt.columns || dt.columns.length === 0) {\r\n                dt.columns = this.gridOptions.columns;\r\n            }\r\n            dt.allColumnsTitle = this.allColumnsTitle;\r\n            dt.searchFields = opts.searchFields;\r\n            dt.pagination = opts.pagination;\r\n            dt.pageList = this.pageList;\r\n            dt.remoteSort = this.remoteSort;\r\n            dt.striped = this.enableMultiFieldSearch;\r\n\r\n            if (this.loadDataWhenOpen) {\r\n                dt.loadData({\r\n                    pageSize: opts.pageSize,\r\n                    pageIndex: this.gridOptions.pageIndex,\r\n                    total: this.gridOptions.total,\r\n                    data: this.gridOptions.items,\r\n                });\r\n                dt.cd.markForCheck();\r\n            }\r\n            this.loadSuccess.emit();\r\n        }\r\n    }\r\n\r\n    private setTreeInfo(resData) {\r\n        if (!resData) {\r\n            return;\r\n        }\r\n\r\n        let _treeInfo = null;\r\n        if (resData.treeInfo) {\r\n            const onlySelectLeaf = resData.treeInfo.onlySelectLeaf;\r\n            let _osl: ONLY_SELECT_LEAF = \"no\";\r\n            if (onlySelectLeaf !== undefined) {\r\n                _osl = onlySelectLeaf ? \"yes\" : \"no\";\r\n            }\r\n            _treeInfo = { ...resData.treeInfo, onlySelectLeaf: _osl };\r\n        }\r\n\r\n        const treeInfo = this.gridOptions.treeInfo;\r\n        if (treeInfo) {\r\n            if (\r\n                treeInfo.onlySelectLeaf === undefined ||\r\n                treeInfo.onlySelectLeaf === null\r\n            ) {\r\n                treeInfo.onlySelectLeaf = \"no\";\r\n            }\r\n\r\n            if (typeof treeInfo.onlySelectLeaf === \"boolean\") {\r\n                treeInfo.onlySelectLeaf = treeInfo.onlySelectLeaf ? \"yes\" : \"no\";\r\n            }\r\n\r\n            // 20210902\r\n            if (this.loadTreeDataType === \"default\") {\r\n                treeInfo.loadDataType = _treeInfo.loadDataType;\r\n            } else {\r\n                treeInfo.loadDataType = this.loadTreeDataType === \"loadall\" ? \"all\" : \"async\";\r\n                _treeInfo.loadDataType = treeInfo.loadDataType\r\n            }\r\n\r\n            if (treeInfo.onlySelectLeaf !== \"default\") {\r\n                _treeInfo = Object.assign(_treeInfo, treeInfo);\r\n            }\r\n        } else {\r\n            if (this.loadTreeDataType !== \"default\") {\r\n                _treeInfo.loadDataType = this.loadTreeDataType === \"loadall\" ? \"all\" : \"async\";\r\n            }\r\n        }\r\n\r\n        this.treeInfo = _treeInfo;\r\n    }\r\n\r\n    private loadTreeTableData(resData?: LookupGridResult, rebindEvent = true) {\r\n        const items = resData ? resData.items : this.gridOptions.items;\r\n        this.items = items;\r\n\r\n        if (resData) {\r\n            this.setTreeInfo(resData);\r\n\r\n            const treeInfo = this.gridOptions.treeInfo;\r\n            if (!treeInfo[\"treeDataIsInit\"]) {\r\n                if (treeInfo.layerType.toLowerCase() === \"pathcode\") {\r\n                    this.items = this.lookupUtils.makeTree(\r\n                        this.items,\r\n                        treeInfo\r\n                    );\r\n                } else {\r\n                    this.items = this.lookupUtils.makeTreeWithParentID(\r\n                        this.items,\r\n                        \"\",\r\n                        treeInfo.dataField ? `${treeInfo.dataField}.${treeInfo.parentField}`: treeInfo.parentField,\r\n                        this.idField\r\n                    );\r\n                }\r\n            }\r\n        }\r\n\r\n        if (this.componentRef.instance instanceof TreeTableComponent) {\r\n            const tt = this.componentRef.instance as TreeTableComponent;\r\n            if (this.treeInfo) {\r\n                tt.loadDataType = this.treeInfo.loadDataType;\r\n            }\r\n\r\n            if (!this.columns || !this.columns.length) {\r\n                tt.columns = resData.columns || [];\r\n                this.gridOptions.columns = tt.columns;\r\n            }\r\n\r\n            const isLoadAllTreeData = () => {\r\n                if (this.loadTreeDataType === \"default\") {\r\n                    return tt.loadDataType === \"all\";\r\n                } else {\r\n                    return this.loadTreeDataType === \"loadall\";\r\n                }\r\n            };\r\n\r\n            if (rebindEvent) {\r\n                this.ttEventMgr.bindTreetableEvent();\r\n            }\r\n            const isLoadAll = isLoadAllTreeData();\r\n\r\n            /** å®æ´æ èç¹æ£æ¥ By Lucas 20200302 */\r\n            \r\n            this.items = this.checkNodeCanBeSelect(this.items, isLoadAll);\r\n            tt.keepSelect = true;\r\n\r\n            if (this.useFavorite) {\r\n                this.favHelper.updateFavoritesStatus(this.items);\r\n            }\r\n\r\n            if (this.loadDataWhenOpen) {\r\n                tt.loadData(this.items);\r\n            }\r\n            tt.resize();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * å¨æå®æ´æ ä¸­ï¼æé¨åèç¹å ä¸ºæ¡ä»¶è¢«è¿æ»¤ï¼ä¸ºæ¾ç¤ºå®æ´æ ï¼\r\n     * è¿äºèç¹å¨è¿è¡æ¶æ¯ä¸åè®¸è¢«éä¸­ç, è¿åæ°çèç¹æ°ç»\r\n     * By Lucas 20200302\r\n     */\r\n    checkNodeCanBeSelect(nodes, isAllTreeData = false): TreeNode[] {\r\n        if (nodes && nodes.length) {\r\n            return nodes.map((node: TreeNode) => {\r\n                if (node.hasOwnProperty(\"addtional\")) {\r\n                    node.selectable = !node[\"addtional\"];\r\n                }\r\n\r\n                if (node.children && node.children.length) {\r\n                    this.checkNodeCanBeSelect(node.children, isAllTreeData);\r\n                } else {\r\n                    if (isAllTreeData && (!this._searchState || !this._searchState.value)) {\r\n                        node.leaf = true;\r\n                    }\r\n                }\r\n\r\n                return node;\r\n            });\r\n        }\r\n        return nodes;\r\n    }\r\n\r\n    onChanges(val) {\r\n        if (!val) {\r\n            this.onClear();\r\n        } else {\r\n            this.displayText = val;\r\n            this.isTextChange = this.originalText !== this.displayText;\r\n            if (this.nosearch) {\r\n                this.setModelValue(val);\r\n                this.clearMappings.emit({ instance: this, value: val, });\r\n            }\r\n\r\n            this.onModelTouched(val);\r\n            this.valueChanged.emit(val);\r\n            this.textChanged.emit(val);\r\n        }\r\n    }\r\n\r\n\r\n    onClear(emit = true) {\r\n        this.isTextChange = false;\r\n        this.displayText = \"\";\r\n        this.displayValue = \"\";\r\n        this.originalText = \"\";\r\n        this.extendInfo = \"\";\r\n        this.setModelValue(\"\");\r\n        if (this.mappingFn) {\r\n            this.mappingFn(null, this.mapFields);\r\n        } else {\r\n            if (this.mapFields) {\r\n                const bindingData = this.selectionMgr.getBindingData();\r\n                if (bindingData) {\r\n                    this.defaultMapping.lookupFieldMap(\r\n                        null,\r\n                        this.mapFields,\r\n                        bindingData\r\n                    );\r\n                }\r\n            }\r\n        }\r\n        this.multiSelMgr.clear();\r\n        if (emit) {\r\n            this.clear.emit();\r\n        }\r\n    }\r\n\r\n    clearValue(emit = true) {\r\n        this.onClear(emit);\r\n    }\r\n\r\n    selectItem(rowData?: any) {\r\n        let selectedRow = null;\r\n        if (rowData) {\r\n            selectedRow = rowData;\r\n        } else {\r\n            selectedRow = this.selections;\r\n\r\n            if (!selectedRow) {\r\n                selectedRow = null;\r\n            } else {\r\n                if (Array.isArray(selectedRow) && !selectedRow.length) {\r\n                    selectedRow = null;\r\n                }\r\n            }\r\n        }\r\n\r\n        this._searchState = { \r\n            field: '*',\r\n            value: ''\r\n        }\r\n\r\n        // å¦æå®ä¹äºèªå®ä¹å¤çç¡®å®äºä»¶ï¼åç±èªå®ä¹äºä»¶å¤çåé¢çé»è¾\r\n        if (this.okHandler) {\r\n            this.okHandler({ data: selectedRow, instance: this });\r\n        } else {\r\n            if (this.beforeSelectData) {\r\n                const bsdResult = this.beforeSelectData({\r\n                    instance: this,\r\n                    data: selectedRow,\r\n                });\r\n                if (bsdResult && bsdResult.subscribe) {\r\n                    bsdResult.subscribe((e: any) => {\r\n                        this._beforeSelectDataCallBack(e, selectedRow);\r\n                    });\r\n                } else {\r\n                    this.writeConsole('å¸®å©æ°æ®éä¸­åäºä»¶æªè¿åå¼æè¿åç±»åéObservable, è¯·æ£æ¥', 'error');\r\n                }\r\n            } else {\r\n                this._beforeSelectDataCallBack(true, selectedRow);\r\n            }\r\n        }\r\n    }\r\n\r\n    getPathCode(data, treeInfo = null) {\r\n       return this.lookupUtils.getPathCode(data, treeInfo || this.treeInfo);\r\n    }\r\n    getLayerData(data, treeInfo = null) {\r\n        return this.lookupUtils.getLayerData(data, treeInfo || this.treeInfo);\r\n    }\r\n\r\n\r\n    private getParentPathCode(rows) {\r\n        const maxBy = (arr, fn) =>\r\n            Math.max(\r\n                ...arr.map(typeof fn === \"function\" ? fn : (val) => val[fn])\r\n            );\r\n\r\n        // const { dataField, pathField, layerField } = this.treeInfo;\r\n        const maxLayer = maxBy(rows, (x) => this.getLayerData(x));\r\n\r\n        for (let i = 1; i <= maxLayer; i++) {\r\n            const _rows = rows.filter((n) => this.getLayerData(n) === i);\r\n            if (_rows && _rows.length && _rows.length < rows.length) {\r\n                _rows.forEach((r) => {\r\n                    const patchCode = this.getPathCode(r);\r\n                    const _rows2 = rows.filter(\r\n                        (n) => {\r\n                            var _pc = this.getPathCode(n);\r\n                            return _pc !== patchCode && _pc.indexOf(patchCode) === 0;\r\n                        }\r\n                    );\r\n                    if (_rows2 && _rows2.length) {\r\n                        rows = rows.filter(\r\n                            (n) => this.getPathCode(n) !== patchCode\r\n                        );\r\n                    }\r\n                });\r\n            }\r\n        }\r\n\r\n        return rows;\r\n    }\r\n\r\n    private _beforeSelectDataCallBack(e, selectedRow) {\r\n        let canSelect = e;\r\n        let message = \"\";\r\n        if (typeof e === \"boolean\") {\r\n            canSelect = e;\r\n        } else {\r\n            if (typeof e === \"object\") {\r\n                canSelect = e.canSelect;\r\n                message = e.message;\r\n            } else {\r\n                canSelect = false;\r\n            }\r\n        }\r\n\r\n        if (!selectedRow) {\r\n            message = this.mustChoosAdatarow;\r\n            canSelect = false;\r\n        }\r\n\r\n        if (canSelect) {\r\n            let selectedRows$ = of(selectedRow);\r\n            // å¤é æ å¸®å© å¼æ­¥å è½½ åçº§ç  å¼å¯åæ­¥éæ© æåå«ä¸çº§\r\n            if (!this.singleSelect && this.enableCascade && this.isTree() ) {\r\n                if (this.treeInfo.loadDataType !== \"all\" && this.treeInfo.layerType === \"pathcode\" && this.isGetAllChidlNodes) {\r\n                    let parentsIds = this.getParentPathCode(selectedRow);\r\n                    if (parentsIds && parentsIds.length) {\r\n                        parentsIds = parentsIds.map(\r\n                            (n) => this.getPathCode(n)\r\n                        );\r\n                        this.showLoading();\r\n                        selectedRows$ = this.httpMgr\r\n                            .getData({ parentsIds }, \"allChildren\")\r\n                            .pipe(\r\n                                map((r: LookupGridResult) => {\r\n                                    const items = r.items\r\n                                        ? r.items.map((d) => d.data)\r\n                                        : [];\r\n                                    const allitems = [...selectedRow, ...items];\r\n                                    let ids = allitems.map((n) => n[this.idField]);\r\n                                    ids = Array.from(new Set(ids));\r\n                                    return ids.map((n) =>\r\n                                        allitems.find((a) => a[this.idField] === n)\r\n                                    );\r\n                                })\r\n                            );\r\n                    }\r\n                }\r\n            }\r\n\r\n            selectedRows$.subscribe((rows) => {\r\n                this.closeLoading();\r\n                if (this.isGetAllChidlNodes) {\r\n                    this.lookupSelectionSer.loadSelections(rows);\r\n                }\r\n                this.updateControlValue(rows);\r\n                if (!this.useTip || !rows) {\r\n                    return;\r\n                }\r\n                if (this.useTip) {\r\n                    this.personalConfigService.updateQueckSelected(\r\n                        rows,\r\n                        this.localService.localeId\r\n                    );\r\n                }\r\n            });\r\n        } else {\r\n            if (message) {\r\n                if (this.notifyService) {\r\n                    this.notifyService.warning(message);\r\n                } else {\r\n                    this.messagerService.warning(message, \"\", true, () => {\r\n                        this.dialog.el.nativeElement.click();\r\n                    });\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    private updateControlValue(selectedRow) {\r\n        if (selectedRow) {\r\n            this.setDisplayText(selectedRow);\r\n            if (this.mappingFn) {\r\n                this.mappingFn(selectedRow, this.mapFields, this.bindingData);\r\n            } else {\r\n                if (this.mapFields && this.bindingData) {\r\n                    this.defaultMapping.lookupFieldMap(\r\n                        selectedRow,\r\n                        this.mapFields,\r\n                        this.bindingData\r\n                    );\r\n                }\r\n            }\r\n            this.setModelValue(this.displayText);\r\n            if (this[\"inDatagrid\"] && selectedRow) {\r\n                const selectItems = Array.isArray(selectedRow)\r\n                    ? selectedRow\r\n                    : [selectedRow];\r\n                this.updateBindData(selectItems);\r\n            }\r\n            this.selectedData.emit(selectedRow);\r\n            this.runDictPickedEvent(selectedRow);\r\n            this.isTextChange = false;\r\n        } else {\r\n            if (document.activeElement) {\r\n                (document.activeElement as HTMLButtonElement).blur();\r\n            }\r\n            this.messagerService.warning(this.mustChoosAdatarow);\r\n        }\r\n    }\r\n\r\n    private updateBindData(selectedRow) {\r\n        if (!this.mapFields) {\r\n            return;\r\n        }\r\n\r\n        const helpFields = Object.keys(this.mapFields);\r\n        if (\r\n            this.ngControl &&\r\n            this.ngControl.formDirective &&\r\n            this.ngControl.formDirective.form &&\r\n            this.ngControl.formDirective.form.bindingData\r\n        ) {\r\n            const bindingData = this.ngControl.formDirective.form.bindingData;\r\n\r\n            if (bindingData) {\r\n                helpFields.forEach((helpField: any) => {\r\n                    this.mapFields[helpField]\r\n                        .split(\",\")\r\n                        .forEach((formField: any) => {\r\n                            const val = selectedRow\r\n                                .map((r) => {\r\n                                    return this.utils.getValue(helpField, r);\r\n                                })\r\n                                .join(this.multipleChoiceSeparator);\r\n                            this.utils.setValue(bindingData, formField, val);\r\n                        });\r\n                });\r\n            }\r\n\r\n            // if (bindingData.setValue) {\r\n            //     const bindingPath = this.ngControl.formDirective.form.bindingPath;\r\n            //     let pathArr: string[] = [];\r\n            //     if (bindingPath) {\r\n            //         pathArr = bindingPath.split('/').filter(n => n !== '');\r\n            //     }\r\n\r\n            //     helpFields.forEach((helpField: any) => {\r\n            //         this.mapFields[helpField].split(',').forEach((formField: any) => {\r\n            //             const fieldPaths = pathArr.concat(formField.split('.'));\r\n            //             const val = selectedRow.map(r => {\r\n            //                 return this.utils.getValue(formField, r);\r\n            //             }).join(this.multipleChoiceSeparator);\r\n            //             bindingData.setValue(pathArr.concat(fieldPaths), val, true, true);\r\n            //         });\r\n            //     });\r\n            // }\r\n        } else {\r\n            // if (this.bindingData) {\r\n            //     helpFields.forEach((helpField: any) => {\r\n            //         this.mapFields[helpField].split(',').forEach((formField: any) => {\r\n            //             const val = selectedRow.map(r => {\r\n            //                 return this.utils.getValue(formField, r);\r\n            //             }).join(this.multipleChoiceSeparator);\r\n            //             this.utils.setValue(this.bindingData, formField, val);\r\n            //         });\r\n            //     });\r\n            // }\r\n        }\r\n    }\r\n\r\n    private getExtendInfoFields(isHelpData = true) {\r\n        if (!this.extInfoFields) {\r\n            this.writeConsole(`æªè®¾ç½®æ©å±å­æ®µã`);\r\n            return [];\r\n        }\r\n        const tipFieldArr = this.extInfoFields.split(\",\");\r\n\r\n        if (isHelpData) {\r\n            let extendInfoFields = [];\r\n            extendInfoFields = tipFieldArr.map((tf) => {\r\n                const mapKey = Object.keys(this.mapFields).find((k) => {\r\n                    return this.mapFields[k] === tf;\r\n                });\r\n\r\n                if (mapKey) {\r\n                    return mapKey;\r\n                } else {\r\n                    this.writeConsole(`å¨å¸®å©æ å°å­æ®µä¸­æªæ¾å°${tf}`);\r\n                    return \"\";\r\n                }\r\n            });\r\n            return extendInfoFields;\r\n        }\r\n\r\n        return tipFieldArr;\r\n    }\r\n\r\n    onUpdateExtendInfo() {\r\n        const jsonData = this.selectionMgr.getBindingData();\r\n        this.updateExtendInfo(jsonData, false);\r\n    }\r\n\r\n    // éä¸­å¸®å©æ°æ®åï¼æ´æ°æ©å±ä¿¡æ¯\r\n    private updateExtendInfo(data: any, isHelpData = true) {\r\n        if (data) {\r\n            if (this.extInfoFormatter) {\r\n                if (Array.isArray(data)) {\r\n                    const tipString = data.map((n) => {\r\n                        return this.getExtendInfoText(n);\r\n                    });\r\n                    this.extendInfo = tipString.join(\"ï¼\");\r\n                } else {\r\n                    this.extendInfo = this.getExtendInfoText(data);\r\n                }\r\n            } else {\r\n                const extendInfoFields = this.getExtendInfoFields(isHelpData);\r\n                if (extendInfoFields && extendInfoFields.length) {\r\n                    if (Array.isArray(data)) {\r\n                        const tipString = data.map((n) => {\r\n                            return this.getExtendInfoText(n, extendInfoFields);\r\n                        });\r\n                        this.extendInfo = tipString.join(\"ï¼\");\r\n                    } else {\r\n                        this.extendInfo = this.getExtendInfoText(\r\n                            data,\r\n                            extendInfoFields\r\n                        );\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    private getExtendInfoText(itemData, fields = null) {\r\n        if (typeof this.extInfoFormatter === \"function\") {\r\n            return this.extInfoFormatter({\r\n                bindingData: itemData,\r\n                instance: this,\r\n            });\r\n        } else {\r\n            const tipString = [];\r\n            const tipValues = fields.map((t) => {\r\n                const tfv = this.utils.getValue(t, itemData);\r\n                tipString.push(tfv);\r\n                return { [t]: tfv };\r\n            });\r\n            return tipString.join(\" \");\r\n        }\r\n    }\r\n\r\n    private getDisplayText(rows: any) {\r\n        const df = this.displayFields\r\n            ? this.displayFields.split(\",\")\r\n            : [this.textField];\r\n        const txtArr = rows.map((r) => {\r\n            const t = [];\r\n            df.forEach((n) => {\r\n                t.push(this.utils.getValue(n, r));\r\n            });\r\n            return t.join(this.displayTextSeparator);\r\n        });\r\n\r\n        if (this.gridOptions.singleSelect) {\r\n            return txtArr.join(\"\");\r\n        } else {\r\n            if (this.displayFields) {\r\n                return txtArr.map((t) => \"[\" + t + \"]\").join(this.multipleChoiceSeparator);\r\n            } else {\r\n                return txtArr.join(this.multipleChoiceSeparator);\r\n            }\r\n        }\r\n    }\r\n\r\n    private setDisplayText(selectedRow: any) {\r\n        this.originalText = this.displayText;\r\n\r\n        if (this.gridOptions.singleSelect) {\r\n            if (this.displayFormatter) {\r\n                this.displayText = this.utils.getValue(\r\n                    this.textField,\r\n                    selectedRow\r\n                );\r\n                if (!this.isTree()) {\r\n                    this.displayText = this.displayFormatter(\r\n                        this.displayText,\r\n                        [selectedRow],\r\n                        {\r\n                            lookup: this,\r\n                            datatable: this.componentRef\r\n                                .instance as DataTableComponent,\r\n                        }\r\n                    );\r\n                } else {\r\n                    const tt = this.componentRef.instance as TreeTableComponent;\r\n                    this.displayText = this.displayFormatter(\r\n                        this.displayText,\r\n                        [selectedRow],\r\n                        { lookup: this, tree: tt }\r\n                    );\r\n                }\r\n            } else {\r\n                this.displayText = this.getDisplayText([selectedRow]);\r\n            }\r\n            this.displayValue = selectedRow[this.valueField || this.idField];\r\n        } else {\r\n            if (selectedRow.length) {\r\n                if (this.displayFormatter) {\r\n                    this.displayText = selectedRow\r\n                        .map((r) => {\r\n                            return this.utils.getValue(this.textField, r);\r\n                        })\r\n                        .join(this.multipleChoiceSeparator);\r\n                    if (!this.isTree()) {\r\n                        this.displayText = this.displayFormatter(\r\n                            this.displayText,\r\n                            selectedRow,\r\n                            {\r\n                                lookup: this,\r\n                                datatable: this.componentRef\r\n                                    .instance as DataTableComponent,\r\n                            }\r\n                        );\r\n                    } else {\r\n                        const tt = this.componentRef\r\n                            .instance as TreeTableComponent;\r\n                        this.displayText = this.displayFormatter(\r\n                            this.displayText,\r\n                            selectedRow,\r\n                            { lookup: this, tree: tt }\r\n                        );\r\n                    }\r\n                } else {\r\n                    this.displayText = this.getDisplayText(selectedRow);\r\n                }\r\n\r\n                this.displayValue = selectedRow\r\n                    .map((r) => {\r\n                        return this.utils.getValue(this.valueField || this.idField, r);\r\n                    })\r\n                    .join(this.multipleChoiceSeparator);\r\n            }\r\n        }\r\n        this.originalText = this.displayText;\r\n    }\r\n\r\n    runDictPickedEvent(rowData: any) {\r\n        if (this.dictPicked) {\r\n            if (this.okButton) {\r\n                this.okButton.nativeElement.disabled = true;\r\n            }\r\n            this.dictPickedSubscription = this.dictPicked(rowData).subscribe(\r\n                (v: any) => {\r\n                    if (this.okButton) {\r\n                        this.okButton.nativeElement.disabled = false;\r\n                    }\r\n                    if (typeof v === \"boolean\") {\r\n                        if (v) {\r\n                            this.closeDialog(rowData);\r\n                        }\r\n                    } else if (\r\n                        typeof v === \"object\" &&\r\n                        v.closeDialog !== undefined &&\r\n                        !v.closeDialog\r\n                    ) {\r\n                        if (v.message) {\r\n                            this.messagerService.warning(v.message);\r\n                        } else {\r\n                            this.closeDialog(rowData);\r\n                        }\r\n                    } else {\r\n                        this.closeDialog(rowData);\r\n                    }\r\n                }\r\n            );\r\n        } else {\r\n            this.closeDialog(rowData);\r\n        }\r\n    }\r\n\r\n    private focusToInput(): void {\r\n        this.zone.runOutsideAngular(() => {\r\n            setTimeout(() => {\r\n                if (this.inputGroup && this.inputGroup.textbox) {\r\n                    this.inputGroup.textbox.nativeElement.focus();\r\n                }\r\n            });\r\n        });\r\n    }\r\n\r\n    closeDialog(rowData = null) {\r\n        if (this.dialog) {\r\n            this.dialog.close();\r\n        }\r\n        \r\n        if (rowData) {\r\n            this.multiSelMgr.save(rowData);\r\n        }\r\n        \r\n        // this.isShow = false;\r\n        this.focusToInput();\r\n    }\r\n\r\n    cancelSelect() {\r\n        this.closeDialog();\r\n        this.isTextChange = false;\r\n        if (!this.nosearch) {\r\n            this.displayText = this.originalText;\r\n            this.setModelValue(this.displayText);\r\n        }\r\n\r\n        if (this.cancelHandler) {\r\n            this.cancelHandler(this);\r\n        }\r\n    }\r\n\r\n    setModelValue(v) {\r\n        if (this.onModelChange) {\r\n            this.onModelChange(v);\r\n            this.valueChanged.emit(v);\r\n        }\r\n    }\r\n\r\n    // æ°æ®åè¡¨ï¼æ¶èï¼ å·²éæ°æ® tab é¡µåæ¢\r\n    onTabChange(e: any) {\r\n        this.activeTab = e.tabIndex;\r\n        this.personalConf.tabIndex = this.activeTab;\r\n        const _firstChange = this.isTabChanged;\r\n        this.isTabChanged = true;\r\n        this.personalConfigService.updatePersonalConfig({\r\n            tabIndex: e.tabIndex,\r\n        });\r\n\r\n        if (this.activeTab === \"datalist\") {\r\n            if (this.isDoublleList() && !this.leftComponentRef) {\r\n                if (this.navigationOptions) {\r\n                    this.lookupCmpMgr.createLeftComponent(\r\n                        this.navigationOptions\r\n                    );\r\n                } else {\r\n                    this.initData();\r\n                    return;\r\n                }\r\n            }\r\n\r\n            if (!this.items || !this.items.length) {\r\n                this.initData();\r\n            } else {\r\n                if (!_firstChange) {\r\n                    if (this.isTree()) {\r\n                        this.loadTreeTableData();\r\n                    } else {\r\n                        this.loadDataTableData();\r\n                        this.dtEventMgr.bindDataTableEvent();\r\n                    }\r\n                }\r\n                // this.selectionMgr.selectCurrentValue();\r\n            }\r\n            this.showGetAllChildrenCheckbox();\r\n        } else {\r\n            if (this.activeTab === \"favorite\") {\r\n                if (this.isTree()) {\r\n                    this.initData();\r\n                } else {\r\n                    if (\r\n                        !this.favoriteItems ||\r\n                        !this.favoriteItems.length ||\r\n                        this.favoriteItems.length !== this.favHelper.getFavoritIds().length\r\n                    ) {\r\n                        this.initData();\r\n                    } else if (!_firstChange) {\r\n                        this.favHelper._loadFavoriteData(this.favoriteItems);\r\n                        // this.selectionMgr.selectCurrentValue();\r\n                    }\r\n                    //  else {\r\n                    //     this.selectionMgr.selectCurrentValue();\r\n                    // }\r\n                }\r\n            }\r\n        }\r\n\r\n        this.changeDetector.detectChanges();\r\n        setTimeout(() => {\r\n            this.resizeCmp();\r\n            if (this.isTree()) {\r\n                const y = this.componentRef.instance.state.scrollY;\r\n                this.componentRef.instance.scrollToY(y, 0);\r\n\r\n                if (this.enableCascade) {\r\n                    this.ttEventMgr.cascadeValueChanged(this.cascadeStatus);\r\n                }\r\n            }\r\n\r\n            if (this.isDoublleList() && this.displayType === LookupGridDisplayType.NavTreeList && !this.navTreeToList) {\r\n                this.leftComponentRef.instance.updateScrollPosition(); \r\n            }\r\n            this.selectionMgr.selectCurrentValue();\r\n        });\r\n    }\r\n\r\n    //#region  Tag View ----------------------------------------------------------------------\r\n    private registerMouseEventForTagView() {\r\n        if (this.enableClear) {\r\n            this.tagbox.nativeElement.addEventListener(\r\n                \"mouseenter\",\r\n                this.onTagboxMouseEnter.bind(this)\r\n            );\r\n            this.tagbox.nativeElement.addEventListener(\r\n                \"mouseleave\",\r\n                this.onTagboxMouseLeave.bind(this)\r\n            );\r\n        }\r\n    }\r\n\r\n    private toggleClearIcon(event: any, isShow = false) {\r\n        const str = isShow ? \"\" : \"none\";\r\n        const clearIcon = event.target.querySelector(\".input-group-clear\");\r\n        if (clearIcon) {\r\n            clearIcon.style.display = str;\r\n        }\r\n    }\r\n\r\n    private onTagboxMouseEnter(event) {\r\n        if (this.displayText && this.enableClear) {\r\n            if (!this.readonly && !this.disabled) {\r\n                this.showTagboxClearButton = true;\r\n            }\r\n        }\r\n        if (this.showTagboxClearButton) {\r\n            this.toggleClearIcon(event, true);\r\n        }\r\n    }\r\n\r\n    private onTagboxMouseLeave(event) {\r\n        this.toggleClearIcon(event);\r\n    }\r\n\r\n    onRemoveSelectItem($event, txt) {\r\n        $event.stopPropagation();\r\n        const textArray = Array.from(this.displayTextList);\r\n        const removedIndex = this.displayTextList.indexOf(txt);\r\n        textArray.splice(removedIndex, 1);\r\n        this.displayText = textArray.join(this.multipleChoiceSeparator);\r\n        this.originalText = this.displayText;\r\n        this.setModelValue(this.displayText);\r\n\r\n\r\n        if (this.displayValue) {\r\n            const vals = this.displayValue.split(this.multipleChoiceSeparator);\r\n            vals.splice(removedIndex, 1);\r\n            this.displayValue = vals.join(this.multipleChoiceSeparator);\r\n        }\r\n\r\n        if (this.mapFields) {\r\n            this.updateOtherFieldDataWhenTagremoved(removedIndex);\r\n        }\r\n\r\n        this.tagRemoved.emit({ removedIndex, instance: this });\r\n    }\r\n\r\n    private updateOtherFieldDataWhenTagremoved(removedIndex) {\r\n        const helpFields = Object.keys(this.mapFields);\r\n        const textFieldIndex = helpFields.indexOf(this.textField);\r\n\r\n        if (\r\n            this.ngControl &&\r\n            this.ngControl.formDirective &&\r\n            this.ngControl.formDirective.form &&\r\n            this.ngControl.formDirective.form.bindingData\r\n        ) {\r\n            const bindingData = this.ngControl.formDirective.form.bindingData;\r\n            if (bindingData.setValue) {\r\n                const bindingPath =\r\n                    this.ngControl.formDirective.form.bindingPath;\r\n                let pathArr: string[] = [];\r\n                if (bindingPath) {\r\n                    pathArr = bindingPath.split(\"/\").filter((n) => n !== \"\");\r\n                }\r\n\r\n                helpFields.forEach((helpField: any) => {\r\n                    this.mapFields[helpField]\r\n                        .split(\",\")\r\n                        .forEach((formField: any) => {\r\n                            const fieldPaths = pathArr.concat(\r\n                                formField.split(\".\")\r\n                            );\r\n                            const val = bindingData.getValue(fieldPaths);\r\n                            const valArr = val.split(\r\n                                this.multipleChoiceSeparator\r\n                            );\r\n                            valArr.splice(removedIndex, 1);\r\n                            const newVal = valArr.join(\r\n                                this.multipleChoiceSeparator\r\n                            );\r\n                            bindingData.setValue(\r\n                                pathArr.concat(fieldPaths),\r\n                                newVal,\r\n                                true,\r\n                                true\r\n                            );\r\n                        });\r\n                });\r\n            }\r\n        } else {\r\n            if (this.bindingData) {\r\n                if (textFieldIndex > -1) {\r\n                    helpFields.splice(textFieldIndex, 1);\r\n                }\r\n                helpFields.forEach((helpField: any) => {\r\n                    this.mapFields[helpField]\r\n                        .split(\",\")\r\n                        .forEach((formField: any) => {\r\n                            const val = this.utils.getValue(\r\n                                formField,\r\n                                this.bindingData\r\n                            );\r\n                            const valArr = val.split(\r\n                                this.multipleChoiceSeparator\r\n                            );\r\n                            valArr.splice(removedIndex, 1);\r\n                            const newVal = valArr.join(\r\n                                this.multipleChoiceSeparator\r\n                            );\r\n                            this.utils.setValue(\r\n                                this.bindingData,\r\n                                formField,\r\n                                newVal\r\n                            );\r\n                        });\r\n                });\r\n            }\r\n        }\r\n    }\r\n    //#endregion\r\n\r\n    onAllChildNodesClick($event: any) {\r\n        this.isGetAllChidlNodes = !this.isGetAllChidlNodes;\r\n    }\r\n\r\n    onIncludeSubordinatesChange(val) {\r\n        this.includeSubordinates = val;\r\n        this.includeSubordinates$.next(val);\r\n    }\r\n\r\n    onTagContainerClick($event: MouseEvent) {\r\n        $event.stopPropagation();\r\n        if (this.tagInput) {\r\n            this.tagInput.focus();\r\n            this.tagInput.textbox.nativeElement.click();\r\n        }\r\n    }\r\n\r\n    expandFirstNode(nodes): TreeNode[] {\r\n        if (nodes && nodes.length) {\r\n            return nodes.map((node: TreeNode) => {\r\n                if (node.children && node.children.length) {\r\n                    node.expanded = true;\r\n                    this.expandFirstNode(node.children);\r\n                }\r\n                return node;\r\n            });\r\n        }\r\n        return nodes;\r\n    };\r\n\r\n    // ç¨äºç»ç»ä¸ªæ§åæ°æ®key\r\n    getLookupBindingFields() {\r\n        if (this.ngControl) {\r\n            if (this.ngControl.name) {\r\n                return this.ngControl.name;\r\n            } else {\r\n                if (this.mapFields && this.mapFields.length) {\r\n                    return Object.keys(this.mapFields).map(k => {\r\n                        return this.mapFields[k];\r\n                    }).join('_');\r\n                } else {\r\n                    return this.textField;\r\n                }\r\n            }\r\n        } else {\r\n            return '';\r\n        }\r\n    }\r\n\r\n    onConditionsChange($event) {\r\n        if (this.isTree() ) {\r\n            this.ttEventMgr.conditionsChange($event);\r\n        } else {\r\n            this.dtEventMgr.conditionsChange($event);\r\n        }\r\n    }\r\n\r\n    clearSelected($event: MouseEvent) {\r\n        if($event) {\r\n            $event.stopPropagation();\r\n        }\r\n\r\n        const msg = this.localService.getValue('lookup.selectedInfo.confirm');\r\n\r\n        this.messagerService.confirm(msg || 'æ¨ç¡®è®¤è¦åæ¶ææå·²éä¸­çè®°å½åï¼').subscribe((e) => {\r\n            if (e) {\r\n                this.multiSelMgr.clear();\r\n                if (this.selectedDtRef) {\r\n                    this.selectedDtRef.clearSelections();\r\n                } \r\n            }\r\n        });\r\n    }\r\n\r\n    onDeleteSelectedItem($event: MouseEvent) {\r\n        if($event) {\r\n            $event.stopPropagation();\r\n        }\r\n\r\n        if (this.selectedDtRef.selections && this.selectedDtRef.selections.length) {\r\n            const unCheckeIds = this.selectedDtRef.selections.map(n => n[this.idField]);\r\n            this.multiSelMgr.deleteSelectedItems(this.selectedDtRef.selections);\r\n            this.selectedDtRef.unCheckRows(unCheckeIds);\r\n        } else {\r\n            this.notifyService.warning('è¯·å¾éè¦å é¤çè®°å½ï¼');\r\n        }\r\n    }\r\n\r\n    initColumnWidth(columns: any, typ: 'data'|'nav'|'fav'|'sel' = 'data') {\r\n        if (this.personalConf && this.personalConf.colSizeInfo && this.personalConf.colSizeInfo.data) {\r\n            const fieldsizeData = this.personalConf.colSizeInfo[typ];\r\n            if(fieldsizeData) {\r\n                const fields = Object.keys(fieldsizeData);\r\n                if (fields && fields.length) {\r\n                    columns.forEach(n => {\r\n                        if (fieldsizeData[n.field]) {\r\n                            n.width = fieldsizeData[n.field];\r\n                        }\r\n                    })\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n","import {\r\n    Component, OnInit, ElementRef, AfterViewInit, OnChanges,\r\n    Output, EventEmitter, ViewChild, Injector, Renderer2, Input, SimpleChanges, ViewEncapsulation\r\n} from '@angular/core';\r\nimport { trigger, state, style, transition, animate } from '@angular/animations';\r\nimport { PersonalConfigService } from './lookup-presonalConfig.service';\r\nimport { LookupGridComponent } from './lookup-grid.component';\r\n\r\n@Component({\r\n    selector: 'lookup-tabs',\r\n    templateUrl: './lookup-tabs.component.html',\r\n    styleUrls: ['./lookup-tabs.component.scss'],\r\n    animations: [\r\n        trigger('flyInOut', [\r\n            transition(':enter', [style({ opacity: 0 }), animate('.3s', style({ opacity: 1 }))]),\r\n            transition(':leave', [animate('.3s', style({ opacity: 0 }))])\r\n        ])\r\n    ]\r\n})\r\nexport class LookupTabsComponent implements OnInit, OnChanges, AfterViewInit {\r\n\r\n    @Input() enableFav = false;\r\n    @Input() activeTab = 'datalist';\r\n    @Input() visible = false;\r\n\r\n    @Input() layout = 'default';\r\n    @Input() dialogTitle = '';\r\n\r\n    @Output() tabChange = new EventEmitter<any>();\r\n\r\n    @ViewChild('inkBar') inkBarRef: ElementRef;\r\n    @ViewChild('dataListNav') dataListNavRef: ElementRef;\r\n    @ViewChild('favoriteNav') favoriteNavRef: ElementRef;\r\n    @ViewChild('selectedNav') selectedNavRef: ElementRef;\r\n    @ViewChild('advanceLayout') advanceLayoutRef: ElementRef;\r\n\r\n    public personalConfigService: PersonalConfigService;\r\n\r\n    private render: Renderer2 = null;\r\n    private el: ElementRef = null;\r\n    lookupIns = null;\r\n    constructor(public injector: Injector) {\r\n        this.personalConfigService = this.injector.get(PersonalConfigService, null);\r\n        this.render = this.injector.get(Renderer2);\r\n        this.el = this.injector.get(ElementRef);\r\n        this.lookupIns = this.injector.get(LookupGridComponent, null);\r\n        if (!this.lookupIns.labels) {\r\n            this.lookupIns.initLabels();\r\n        }\r\n    }\r\n\r\n    ngOnChanges(changes: SimpleChanges) {\r\n        if (changes.activeTab && !changes.activeTab.isFirstChange()) {\r\n            this.initInkBarPos(changes.activeTab.currentValue);\r\n            \r\n        }\r\n    }\r\n\r\n    ngAfterViewInit() {\r\n        setTimeout(() => {\r\n            this.initInkBarPos(this.activeTab);\r\n        }, 300);\r\n    }\r\n\r\n    navClickHandle(e: Event, v: string) {\r\n        e.stopPropagation();\r\n        if (this.activeTab !== v) {\r\n            this.activeTab = v;\r\n            this.tabChange.emit({ event: e, tabIndex: v });\r\n            this.initInkBarPos(v);\r\n            \r\n        }\r\n    }\r\n\r\n    initInkBarPos(which: string) {\r\n\r\n        if (this.layout !== 'default') {\r\n            return;\r\n        }\r\n\r\n        if (!this.enableFav) {\r\n            return;\r\n        }\r\n\r\n        let width = this.dataListNavRef.nativeElement.offsetWidth;\r\n        let left = 0;\r\n        if (which !== 'datalist') {\r\n            left = this.dataListNavRef.nativeElement.offsetWidth;\r\n        }\r\n        if (which === 'favorite') {\r\n            width = this.favoriteNavRef.nativeElement.offsetWidth;\r\n        } else if (which === 'selected') {\r\n            if (this.favoriteNavRef) {\r\n                left += this.favoriteNavRef.nativeElement.offsetWidth;\r\n            }\r\n\r\n            if (this.selectedNavRef) {\r\n                width = this.selectedNavRef.nativeElement.offsetWidth;\r\n            } else {\r\n                this.activeTab = 'datalist';\r\n            }\r\n        }\r\n\r\n        this.inkBarRef.nativeElement.style = `width: ${width}px; transform: translate3d(${left}px, 0px, 0px);`;\r\n    }\r\n    ngOnInit(): void {\r\n    }\r\n\r\n}\r\n","import { Directive, OnInit, AfterViewInit, Renderer2, Injector, Input} from '@angular/core';\r\nimport { InputGroupComponent } from '@farris/ui-input-group';\r\nimport { PersonalConfigService } from './lookup-presonalConfig.service';\r\nimport { delay } from 'rxjs/operators';\r\nimport { LocaleService } from '@farris/ui-locale';\r\n@Directive({\r\n    selector: '[lookup-tip]'\r\n})\r\nexport class LookupTipDirective implements OnInit, AfterViewInit {\r\n    @Input('lookup-tip') enableTip = false;\r\n    private tipPanel: Element;\r\n    private leaveEvent: any;\r\n    private enterEvent: any;\r\n    private clickEvent: any;\r\n    private isInTipPanel = false;\r\n    private selected: any[];\r\n    private personalConfigService: PersonalConfigService;\r\n    public localService: LocaleService;\r\n    private tipText = 'æ¨è¦æ¾çæ¯ä¸æ¯è¿äºï¼';\r\n    constructor(\r\n        private inputRef: InputGroupComponent,\r\n        private renderer: Renderer2,\r\n        public injector: Injector\r\n    ) {\r\n        this.personalConfigService = this.injector.get(PersonalConfigService, null);\r\n        this.localService = this.injector.get(LocaleService);\r\n    }\r\n\r\n    ngOnInit(): void {\r\n        this.tipText = this.localService.getValue('lookup.tipText');\r\n        this.enableTip = false; // å æ°æ®æéé®é¢ï¼æ­¤åè½æå±è½ tfs: 403924\r\n        if (this.enableTip) {\r\n            this.inputRef.iconMouseEnter.subscribe(e => {\r\n                this.creatPanel();\r\n            });\r\n            this.inputRef.iconMouseLeave.pipe(delay(200)).subscribe(e => {\r\n                if (!this.isInTipPanel) {\r\n                    this.removePanel();\r\n                }\r\n            });\r\n            this.inputRef.clickHandle.subscribe(e => {\r\n                this.removePanel();\r\n            });\r\n        }\r\n    }\r\n\r\n    ngAfterViewInit(): void { }\r\n\r\n    // è·åå¿«æ·è¾å¥æ°æ®\r\n    private getQuickSelectedByLocaleId() {\r\n        const localeid = this.localService.localeId;\r\n        const personalConf = this.personalConfigService.getPersonalData();\r\n        if (personalConf && personalConf.quickSelected) {\r\n            const items = personalConf.quickSelected[localeid];\r\n            if (items && items.length) {\r\n                return items;\r\n            }\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    creatPanel() {\r\n        this.selected = this.getQuickSelectedByLocaleId();\r\n        if (this.tipPanel || !this.selected || (this.selected && this.selected.length === 0)) {\r\n            return;\r\n        }\r\n        const pos = this.setPosition();\r\n        const ul = this.renderer.createElement('ul');\r\n        const path = this.personalConfigService.textField.split('.');\r\n        this.selected.forEach((item, index) => {\r\n            const li = this.renderer.createElement('li');\r\n            li.innerHTML = this.find(item, this.personalConfigService.textField);\r\n            this.renderer.setProperty(li, 'id', index);\r\n            this.renderer.appendChild(ul, li);\r\n        });\r\n        const header = this.renderer.createElement('div');\r\n        this.renderer.addClass(header, 'lookup-tip-header');\r\n        header.innerHTML = this.tipText;\r\n        this.tipPanel = this.renderer.createElement('div');\r\n        this.renderer.appendChild(this.tipPanel, header);\r\n        this.renderer.appendChild(this.tipPanel, ul);\r\n        this.renderer.addClass(this.tipPanel, 'lookup-tip');\r\n        this.renderer.setStyle(this.tipPanel, 'top', pos.top);\r\n        this.renderer.setStyle(this.tipPanel, 'left', pos.left);\r\n        this.renderer.setStyle(this.tipPanel, 'width', pos.width);\r\n        this.renderer.appendChild(document.body, this.tipPanel);\r\n        this.leaveEvent = this.renderer.listen(this.tipPanel, 'mouseleave', () => {\r\n            this.removePanel();\r\n        });\r\n        this.enterEvent = this.renderer.listen(this.tipPanel, 'mouseenter', () => {\r\n            this.isInTipPanel = true;\r\n        });\r\n        this.clickEvent = this.renderer.listen(this.tipPanel, 'click', (e) => {\r\n            if (e.target.nodeName === 'LI') {\r\n                this.selectItem(e.target.id);\r\n            }\r\n        });\r\n    }\r\n\r\n    removePanel() {\r\n        if (document.body.contains(this.tipPanel)) {\r\n            this.renderer.removeChild(document.body, this.tipPanel);\r\n            this.tipPanel = null;\r\n            this.isInTipPanel = false;\r\n            this.leaveEvent();\r\n            this.enterEvent();\r\n            this.clickEvent();\r\n        }\r\n    }\r\n\r\n    setPosition() {\r\n        const { left, top, width, height } = this.inputRef.inputGroup.nativeElement.getBoundingClientRect();\r\n        return {\r\n            left: left + 'px',\r\n            top: top + height + 'px',\r\n            width: width + 'px'\r\n        };\r\n    }\r\n\r\n    selectItem(val) {\r\n        const item = this.selected.find((el, index) => Number(val) === index);\r\n        this.removePanel();\r\n        if (this.personalConfigService.singleSelect) {\r\n            this.personalConfigService.selectItemObser$.next(item);\r\n        } else {\r\n            this.personalConfigService.selectItemObser$.next([item]);\r\n        }\r\n    }\r\n\r\n    find(obj, keys) {\r\n        const keyArr = keys.split('.');\r\n        const key = keyArr[0];\r\n        const target = obj[key];\r\n        if (target instanceof Object) {\r\n            keyArr.shift();\r\n            return this.find(target, keyArr.join('.'));\r\n        } else {\r\n            return target;\r\n        }\r\n    }\r\n}\r\n","import { ChangeDetectorRef, Component, ElementRef, EventEmitter, HostBinding, HostListener, Injector, Input, OnInit, Output, ViewChild } from '@angular/core';\r\n\r\n@Component({\r\n    selector: 'lookup-quick-select-panel',\r\n    templateUrl: './quick-select-panel.component.html'\r\n})\r\n\r\nexport class LookupQuickSelectPanelComponent implements OnInit {\r\n\r\n    @Input() showMore = true;\r\n    @Input() data: Array<any> = [];\r\n    @Input() textField: string = '';\r\n    @Input() formatter: (rowObj: any) => string;\r\n    @Input() maxItems = 10;\r\n\r\n    @Output() moreClcik = new EventEmitter();\r\n    @Output() itemClick = new EventEmitter();\r\n\r\n    @ViewChild('itemsContainer') itemsContainer: ElementRef<any>;\r\n\r\n    activeIndex = -1;\r\n\r\n    constructor(private injector: Injector, private cdr: ChangeDetectorRef) { }\r\n\r\n    @HostListener('mousedown', ['$event'])\r\n    onClick($event: MouseEvent) {\r\n        $event.stopPropagation();\r\n    }\r\n\r\n    ngOnInit() { }\r\n\r\n    loadData(items: any) {\r\n        this.data = items;\r\n\r\n        if (!this.cdr['destroyed']) {\r\n            this.cdr.detectChanges();\r\n        }\r\n    }\r\n\r\n    onMoreClick($event: MouseEvent) {\r\n        $event.stopPropagation();\r\n        this.moreClcik.emit($event);\r\n    }\r\n\r\n    formatData(rowObj: any) {\r\n        return this.formatter(rowObj);\r\n    }\r\n\r\n    onItemClick($event, item) {\r\n        this.itemClick.emit({data: item, evnet: $event});\r\n    }\r\n\r\n    setActiveItem(index: number) {\r\n        this.activeIndex = index;\r\n        if (!this.cdr['destroyed']) {\r\n            this.cdr.detectChanges();\r\n        }\r\n    }\r\n}","import { AfterViewInit, ComponentFactoryResolver, ComponentRef, Directive, ElementRef, HostListener, Injector, Input, NgZone, OnDestroy, OnInit, Optional, Renderer2 } from '@angular/core';\r\nimport { reqAnimFrame } from '@farris/ui-common';\r\nimport { InputGroupComponent } from '@farris/ui-input-group';\r\nimport { from, fromEvent, Observable } from 'rxjs';\r\nimport { debounceTime, filter, map } from 'rxjs/operators';\r\n\r\nimport { LookupGridDisplayType, QuickSelectOption } from '../lookup-displaytype';\r\nimport { DisplayInfo, LOAD_DATA_TYPE, LookupGridResult, PickingResult } from '../lookup-grid-options';\r\nimport { LookupGridComponent } from '../lookup-grid.component';\r\nimport { LookupQuickSelectPanelComponent } from './quick-select-panel.component';\r\n\r\n@Directive({ selector: '[quick-select]'})\r\nexport class LookupQuickSelectDirective implements OnInit, AfterViewInit, OnDestroy {\r\n    @Input('quick-select') options: QuickSelectOption;\r\n    private panelElement: HTMLElement;\r\n    private cmpRef: ComponentRef<LookupQuickSelectPanelComponent>;\r\n\r\n    private data = [];\r\n\r\n    constructor(private injector: Injector, private ngzone: NgZone, private render: Renderer2, private inputRef: InputGroupComponent, private lookupRef: LookupGridComponent,\r\n        private cfr: ComponentFactoryResolver) {\r\n    }\r\n\r\n    ngOnInit(): void {\r\n        \r\n    }\r\n\r\n    ngAfterViewInit(): void {\r\n        if (this.options && this.options.enable) {\r\n            this.inputRef.inputClick.subscribe((e: MouseEvent) => {\r\n                e.stopPropagation();\r\n                if (!this.panelElement) {\r\n                    // æ§è¡å¸®å©å\r\n                    this.lookupRef.dictPicking({\r\n                        instance: this,\r\n                    }).subscribe((pr: PickingResult) => {\r\n                        if (this.lookupRef.displayType === LookupGridDisplayType.TreeList || (!this.lookupRef.singleSelect && this.lookupRef.viewType === 'text')) {\r\n                            return;\r\n                        }\r\n                        const { show, customData, message } = this.lookupRef.dialogMgr.checkDictPickingResult(pr);\r\n                        this.lookupRef.customData = customData;\r\n                        if (show) {\r\n                            this.createDataPanel();\r\n                        } else {\r\n                            if (message) {\r\n                                this.lookupRef.notifyService.warning(message);\r\n                            }\r\n                        }\r\n                    })\r\n                }\r\n            });\r\n\r\n            this.inputRef.valueChange.pipe(\r\n                debounceTime(200)\r\n            ).subscribe((val: string) => {\r\n                this.lookupRef.dictPicking({instance: this}).subscribe((pr: PickingResult) => {\r\n                    if (this.lookupRef.displayType === LookupGridDisplayType.TreeList || (!this.lookupRef.singleSelect && this.lookupRef.viewType === 'text')) {\r\n                        return;\r\n                    }\r\n                    const { show, customData, message } = this.lookupRef.dialogMgr.checkDictPickingResult(pr);\r\n                    this.lookupRef.customData = customData;\r\n                    if (!this.panelElement) {\r\n                        this.createDataPanel();\r\n                    } else {\r\n                        this.panelElement.style.overflow = 'hidden';\r\n                        this.setPanelPosition(false);\r\n                        this.loadData();\r\n                    }\r\n                })\r\n            });\r\n\r\n            this.inputRef.keydownHandle.pipe(\r\n                filter((event: KeyboardEvent) => {\r\n                    return event.key === 'Escape' || event.key === 'Tab' ||  event.key === 'F2';\r\n                })\r\n            ).subscribe((e) => {\r\n                this.hide(e);\r\n            });\r\n        }\r\n    }\r\n\r\n    ngOnDestroy(): void {\r\n        this.lookupRef.overLayService.destory(this.lookupRef.el.nativeElement);\r\n    }\r\n\r\n    private removePanelElement() {\r\n        document.body.removeChild(this.panelElement);\r\n        this.panelElement = null;\r\n    }\r\n\r\n    private clearSearchValue() {\r\n        this.lookupRef._searchState = { \r\n            field: '*', //\"*\",\r\n            value: ''\r\n        }\r\n    }\r\n\r\n    hide(e?: any, isMoreClick = false) {\r\n        reqAnimFrame(() => {\r\n            if (this.panelElement) {\r\n                if (e && ( e.type === 'mousewheel' || e.type === 'wheel')) {\r\n                    this.removePanelElement();\r\n                } else {\r\n                    this.panelElement.classList.remove('f-area-show');\r\n                    setTimeout(() => {\r\n                        this.removePanelElement();\r\n                    },120);\r\n                }\r\n\r\n                if (!this.lookupRef) {\r\n                    return;\r\n                }\r\n\r\n                \r\n                // tfs 579056\r\n                if (this.lookupRef.overLayService) {\r\n                    this.lookupRef.overLayService.destory(this.lookupRef.el.nativeElement);\r\n                }\r\n\r\n                if (isMoreClick) {\r\n                    return;       \r\n                }\r\n\r\n                if (this.lookupRef.tagInput) {\r\n                    // this.lookupRef.tagInput.value = '';\r\n                    this.inputRef.value = '';\r\n                    this.clearSearchValue();\r\n                }\r\n\r\n                if (e && (e.key === 'F2' || this.lookupRef.el.nativeElement.contains(e.target))) {\r\n                    if (this.data && this.data.length) {\r\n                        return;\r\n                    } else {\r\n                        this.clearSearchValue();\r\n                    }\r\n                }\r\n\r\n                if (!this.lookupRef.nosearch && this.lookupRef.displayText !== this.lookupRef.originalText) {\r\n                    this.lookupRef.onChanges(this.lookupRef.originalText)\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n    private setPanelPosition(updateTopPosition = true) {\r\n        if (this.panelElement) {\r\n            const { width, left, top, height } = this.getPanelSize();\r\n            this.panelElement.style.width = `${width}px`;\r\n            this.panelElement.style.maxHeight = `${height}px`;\r\n            if (updateTopPosition) {\r\n                this.panelElement.style.top = `${top}px`;\r\n            }\r\n            this.panelElement.style.left = `${left}px`;\r\n            this.panelElement.style.zIndex = '10001';\r\n        }\r\n    }\r\n\r\n    private createDataPanel() {\r\n        \r\n        if (this.lookupRef.changeDetector['destroyed']) {\r\n            this.panelElement && this.removePanelElement();\r\n            return;\r\n        }\r\n\r\n        this.panelElement = document.createElement('div');\r\n        this.panelElement.classList.add('overlay-pane', 'f-lookup_quick-panel', 'f-area-hide');\r\n\r\n        document.body.appendChild(this.panelElement);\r\n        this.setPanelPosition();\r\n\r\n        this.panelElement.style.overflow = 'hidden';\r\n        // this.panelElement.style.height = 'auto';\r\n        \r\n        // åå»ºæ°æ®å±ç¤ºç»ä»¶\r\n        const cmpFact = this.cfr.resolveComponentFactory(LookupQuickSelectPanelComponent);\r\n        this.cmpRef = cmpFact.create(this.injector);\r\n        \r\n        this.cmpRef.instance.showMore = this.options.showMore;\r\n        this.cmpRef.instance.textField = this.lookupRef.textField;\r\n        this.cmpRef.instance.formatter = this.options.formatter;\r\n        this.cmpRef.instance.maxItems = this.options.showItemsCount;\r\n\r\n        // cmpRef.location.nativeElement.classList.add('farris-main-area');\r\n        this.panelElement.appendChild(this.cmpRef.location.nativeElement);\r\n\r\n        this.lookupRef.selectionMgr.initDisplayValue();\r\n        \r\n        this.cmpRef.changeDetectorRef.detectChanges();\r\n\r\n        // more clicked æå¼å¸®å©çªå£\r\n        this.cmpRef.instance.moreClcik.subscribe((e) => {\r\n            this.hide(e, true);\r\n            this.lookupRef.showDialog();\r\n        });\r\n\r\n        this.cmpRef.instance.itemClick.subscribe((e: any) => {\r\n            const { data } = e;\r\n            this.selectItem(data);\r\n        });\r\n\r\n\r\n        // æ³¨åé¼ æ æ»è½®ï¼ç¹å»äºä»¶ï¼ç¨äºéèPanel\r\n        this.lookupRef.overLayService.registerMouseEvent(this.lookupRef.el.nativeElement, (e: MouseEvent) => {\r\n            if (!this.panelElement || e.target['closest']('.f-lookup_quick-panel')) {\r\n                return;\r\n            }\r\n            \r\n            if(this.lookupRef.inputGroup && this.lookupRef.inputGroup.textbox.nativeElement === e.target) {\r\n                return false;\r\n            }\r\n\r\n            if(this.lookupRef.tagInput && this.lookupRef.tagInput.textbox.nativeElement === e.target) {\r\n                return false;\r\n            }\r\n\r\n            if (this.cmpRef) {\r\n                this.cmpRef.destroy();\r\n                this.cmpRef = null;\r\n            }\r\n\r\n            this.clearSearchValue();\r\n\r\n            this.hide(e);\r\n        });\r\n\r\n        this.panelElement.classList.add('f-area-show');\r\n\r\n        this.loadData();\r\n    }\r\n\r\n    private selectItem(data: any) {\r\n        if (!data) {\r\n            return;\r\n        }\r\n\r\n        if (this.lookupRef.viewType === 'tag') {\r\n            const isSelect = this.lookupRef.selections.find(n => n[this.lookupRef.idField] === data[this.lookupRef.idField]);\r\n            if (!isSelect) {\r\n                const selectItems: any = [...this.lookupRef.selections, data];\r\n                this.lookupRef.selectItem(selectItems);\r\n                this.lookupRef.lookupSelectionSer.loadSelections(selectItems);\r\n            }\r\n        } else {\r\n            this.lookupRef.selectItem(data);\r\n        }\r\n        this.hide();\r\n    }\r\n\r\n\r\n    private calculationPanelHeight() {\r\n        return this.options.showItemsCount * 30 + (this.options.showMore ? 50: 0) + (this.options.footerHeight||0) + 5;\r\n    }\r\n\r\n    private getInputSizeInfo() {\r\n        const el: any = this.lookupRef.viewType === 'text' ? this.inputRef.inputGroup : this.lookupRef.tagbox;\r\n        return el.nativeElement.getBoundingClientRect();\r\n    }\r\n\r\n    private getPanelSize() {\r\n        let { width, height, top, left } = this.getInputSizeInfo();\r\n        const bottom = window.innerHeight - height - top;\r\n        let panelHeight = this.calculationPanelHeight();\r\n\r\n        const h = top > bottom ? top : bottom;\r\n        if (bottom > panelHeight) {\r\n            top = top + height;\r\n            // é¢æ¿ç±ä¸åä¸å±å¼\r\n            this.panelElement.style.transformOrigin = '100% top';\r\n        } else {\r\n            if (top > bottom) {\r\n                if (h < panelHeight) {\r\n                    panelHeight = h - 10;\r\n                    top = 10;\r\n                } else {\r\n                    top = top - parseInt('' + panelHeight, 10) - 5;\r\n                }\r\n\r\n                // é¢æ¿ç±ä¸åä¸å±å¼\r\n                this.panelElement.style.transformOrigin = '100% bottom';\r\n\r\n            } else {\r\n                if (h < panelHeight) {\r\n                    panelHeight = h - 10;\r\n                }\r\n                top = top + height;\r\n            }\r\n        }\r\n\r\n        const minWidth = this.options.minWidth || 200;\r\n        let _width =  width < minWidth? minWidth: width;\r\n        if (window.innerWidth - left < _width) {\r\n            left = left + width - _width;\r\n        }\r\n\r\n        return { width: _width, top, height: panelHeight, left };\r\n    }\r\n\r\n    private getData(): Observable<Array<any>> {\r\n        let p: any = {\r\n            pageInfo: {\r\n                pageSize: this.options.showItemsCount,\r\n                pageIndex: 1,\r\n            },\r\n        };\r\n        let t: LOAD_DATA_TYPE = \"all\";\r\n        if (this.lookupRef.isTextChange) {\r\n            this.lookupRef._searchState = { \r\n                field: this.lookupRef.textField, //\"*\",\r\n                value: this.lookupRef.displayText\r\n            }\r\n            p['search'] = this.lookupRef._searchState;\r\n            t = 'search';\r\n        } else {\r\n            this.lookupRef._searchState = null;\r\n        }\r\n\r\n        if (this.lookupRef.viewType === 'tag') {\r\n            if (this.lookupRef.tagInput.value !== '') {\r\n                this.lookupRef._searchState = { \r\n                    field: this.lookupRef.textField, //\"*\",\r\n                    value: this.lookupRef.tagInput.value\r\n                }\r\n                p['search'] = this.lookupRef._searchState;\r\n                t = 'search';\r\n            } else {\r\n                this.lookupRef._searchState = null;\r\n            }\r\n\r\n            const vals = this.lookupRef.selectionMgr.getSelectedIds();\r\n            if (vals && vals.length) {\r\n                p[\"selectedInfo\"] = {\r\n                    selected: true,\r\n                    selectedIds: vals,\r\n                };\r\n            }\r\n        }\r\n\r\n\r\n        return this.lookupRef.httpMgr.lookupRequest(p, t, true).pipe(\r\n            map((restData: LookupGridResult) => {\r\n                let _items = this.lookupRef.items || [];\r\n                if (restData) {\r\n                    if (this.lookupRef.viewType === 'tag') {\r\n                        this.lookupRef.lookupSelectionSer.loadSelections(\r\n                            restData[\"selectedData\"] || []\r\n                        );\r\n                    }\r\n                    _items = restData.items || [];\r\n\r\n                    if (restData.displayType.toLowerCase().indexOf('treelist') > -1 && _items.length && _items[0].data) {\r\n                        _items = _items.map(n => n.data);\r\n                    }\r\n    \r\n                    // return _items.slice(0, this.options.showItemsCount);\r\n\r\n                } else {\r\n                    if (this.lookupRef.displayText && this.lookupRef.isTextChange) {\r\n                        if (restData.displayType.toLowerCase().indexOf('treelist') > -1 && _items.length && _items[0].data) {\r\n                            _items = _items.map(n => n.data);\r\n                        }\r\n\r\n                        const items = _items.filter(n => {\r\n                            return n[this.lookupRef.textField].indexOf(this.lookupRef.displayText) > -1;\r\n                        }).slice(0, this.options.showItemsCount);\r\n                        _items = items;\r\n\r\n                        // return _items.slice(0, this.options.showItemsCount);\r\n                    }\r\n                }\r\n\r\n                return _items.slice(0, this.options.showItemsCount);\r\n            })\r\n        );\r\n    }\r\n\r\n    private loadData() {\r\n        const loadingRef = this.lookupRef.loadingService.show({container: this.panelElement});\r\n        this.getData().subscribe((data: any) => {\r\n            loadingRef.close();\r\n            if (this.cmpRef && this.cmpRef.instance) {\r\n                this.cmpRef.instance.loadData(data);\r\n                if (data.length < this.options.showItemsCount) {\r\n                    // let newHeight = data.length * 30 + (this.options.showMore ? 50: 0) + (this.options.footerHeight||0) + 5;\r\n                    this.data = data;\r\n\r\n                    let newHeight = this.cmpRef.instance.itemsContainer.nativeElement.querySelector('ul').offsetHeight + 10;\r\n\r\n                    if (!data || !data.length) {\r\n                        newHeight = 55;\r\n                    }\r\n\r\n                    this.cmpRef.instance.itemsContainer.nativeElement.style.height = `${newHeight}px`;\r\n                    if (this.panelElement) {\r\n                        if (this.panelElement.style.transformOrigin.indexOf('bottom') > -1) {\r\n                            this.panelElement.style.top = `${this.getInputSizeInfo().top - newHeight - 5}px` ;\r\n                        }\r\n                        this.panelElement.style.height = 'auto';\r\n                    }\r\n                } else {\r\n                    this.setPanelPosition();\r\n                    this.cmpRef.instance.itemsContainer.nativeElement.style.height = '100%';\r\n                    if (this.panelElement) {\r\n                        this.render.removeStyle(this.panelElement, 'height');\r\n                    }\r\n                }\r\n\r\n                if ((this.lookupRef.isTextChange || (this.lookupRef.tagInput && this.lookupRef.tagInput.value !== '') ||  \r\n                    (this.lookupRef.inputGroup && this.lookupRef.inputGroup.value !== '' && this.lookupRef.isTextChange)) && data && data.length) {\r\n                    this.cmpRef.instance.setActiveItem(0);\r\n                }\r\n\r\n                this.panelElement.style.overflow = 'auto';\r\n            }\r\n        });\r\n    }\r\n\r\n\r\n    @HostListener('keydown', ['$event'])\r\n    registerKeyboardEvent($event: KeyboardEvent) {\r\n\r\n        if (!this.lookupRef.singleSelect && this.lookupRef.viewType !== 'tag')  {\r\n            return;\r\n        }\r\n\r\n        let rows= [];\r\n        if (this.cmpRef) {\r\n            rows = this.cmpRef.instance.data;\r\n        }\r\n\r\n        if (!rows || !rows.length) {\r\n            return;\r\n        }\r\n\r\n        if ($event.code === 'ArrowUp' || $event.code === 'ArrowDown') {\r\n            $event.preventDefault();\r\n            $event.stopPropagation();\r\n        }\r\n\r\n\r\n        if ($event.code === 'Backspace' && this.lookupRef.viewType === 'tag' &&\r\n            this.lookupRef.selections && this.lookupRef.selections.length &&\r\n            this.lookupRef.tagInput && !this.lookupRef.tagInput.value && this.lookupRef.quickSelect.enableBackspace) {\r\n            $event.preventDefault();\r\n            $event.stopPropagation();\r\n            const newdata = this.lookupRef.selections.slice(0, this.lookupRef.selections.length - 1);\r\n            if (!newdata || !newdata.length) {\r\n                this.lookupRef.clearValue(true);\r\n            } else {\r\n                this.lookupRef.selectItem(newdata);\r\n            }\r\n            this.lookupRef.lookupSelectionSer.loadSelections(newdata);\r\n            this.setPanelPosition();\r\n            return;\r\n        }\r\n\r\n\r\n        const idx = this.cmpRef.instance.activeIndex;\r\n        let activeIndex = idx;\r\n\r\n        const setActiveItem = (index) => {\r\n            activeIndex = index;\r\n            this.cmpRef.instance.setActiveItem(index);\r\n        };\r\n\r\n        if ($event.code === 'ArrowUp') {  // up\r\n            if (idx > -1) {\r\n                let prevIdx = idx - 1;\r\n                if (prevIdx < 0) {\r\n                    prevIdx = rows.length - 1;\r\n                }\r\n                setActiveItem(prevIdx);\r\n            } else {\r\n                setActiveItem(rows.length - 1);\r\n            }\r\n        }\r\n        if ($event.code === 'ArrowDown') { // down\r\n            let nextIdx = idx + 1;\r\n            if (nextIdx >= rows.length) {\r\n                nextIdx = 0;\r\n            }\r\n\r\n            setActiveItem(nextIdx);\r\n        }\r\n\r\n        if($event.key === 'Enter') {\r\n            if (rows && rows.length && this.panelElement) {\r\n                const data = rows[idx];\r\n                this.selectItem(data);\r\n            } else {\r\n                this.inputRef.inputClick.emit($event);\r\n            }\r\n        }\r\n    }\r\n}","import { EventEmitter, AfterViewInit, Component, ElementRef, Injector, Input, NgZone, OnChanges, OnDestroy, OnInit, Output, Renderer2, SimpleChanges, ViewChild, ViewEncapsulation } from '@angular/core';\r\nimport { DialogComponent } from '@farris/ui-dialog';\r\n\r\n@Component({\r\n    selector: 'lookup-advanced-layout',\r\n    templateUrl: 'lookup-advanced-layout.component.html',\r\n    // styleUrls: ['./advanced-layout.scss'],\r\n    encapsulation: ViewEncapsulation.None\r\n})\r\n\r\nexport class LookupAdvancedLayoutComponent implements OnInit, OnDestroy, OnChanges, AfterViewInit {\r\n\r\n    @Input() title = 'å¸®å©éæ©å¨'\r\n    @Input() activeTab = 'datalist';\r\n    @Input() enableFav: boolean;\r\n\r\n    @Input() dataTab = 'æ°æ®åè¡¨';\r\n    @Input() favTab = 'æ¶èå¤¹'\r\n\r\n    @Output() tabChanged = new EventEmitter();\r\n    @Output() close = new EventEmitter();\r\n\r\n    @ViewChild('header') headerRel: ElementRef;\r\n    @ViewChild('activetab') activetabRef:ElementRef;\r\n\r\n    dialogRef: DialogComponent;\r\n    constructor(public elRef: ElementRef, private injector: Injector, private zone: NgZone, private render2: Renderer2) {\r\n        this.dialogRef = this.injector.get(DialogComponent, null);\r\n    }\r\n\r\n    ngOnInit() {\r\n        \r\n    }\r\n\r\n    ngOnDestroy(): void {\r\n        \r\n    }\r\n\r\n    ngOnChanges(changes: SimpleChanges): void {\r\n        if (changes.activeTab && !changes.activeTab.isFirstChange()) {\r\n            this.setCurrentTab();\r\n        }\r\n    }\r\n\r\n    ngAfterViewInit(): void {\r\n        if (this.dialogRef) {\r\n            this.dialogRef.dragHandle = this.headerRel.nativeElement;\r\n        }\r\n\r\n        this.setCurrentTab();\r\n    }\r\n\r\n    private setCurrentTab() {\r\n        if (this.activetabRef) {\r\n            this.render2.setStyle(this.activetabRef.nativeElement, 'transform', `translate3d(${this.activeTab == 'datalist' ? 0: 84}px, 0px, 0px)`);\r\n        }\r\n    }\r\n\r\n    changeTabs($event, tabstr) {\r\n        this.activeTab = tabstr;\r\n        this.setCurrentTab();\r\n        this.tabChanged.emit({ tab: tabstr, $event });\r\n    }\r\n\r\n    closeDialog($event) {\r\n        if (this.dialogRef) {\r\n            $event.stopPropagation();\r\n            this.dialogRef.close();\r\n        }\r\n    }\r\n\r\n    changeDialogSize($event: MouseEvent) {\r\n        if (this.dialogRef) {\r\n            $event.stopPropagation();\r\n            this.dialogRef.changeDialogSize();\r\n        }\r\n    }\r\n}","import { AfterViewInit, ChangeDetectorRef, Component, ElementRef, EventEmitter, Injector, Input, OnChanges, OnInit, Output, SimpleChanges, ViewChild } from '@angular/core';\r\nimport { DialogComponent } from '@farris/ui-dialog';\r\nimport { SearchBoxComponent, SearchFieldsComponent } from '@farris/ui-search-box';\r\nimport { LookupGridComponent } from '../lookup-grid.component';\r\nimport { SearchBarMode } from '../lookup-displaytype';\r\n\r\n@Component({\r\n    selector: '[lookup-filter-bar]',\r\n    template: `\r\n    <div class=\"d-flex flex-row\">\r\n        <farris-search-fields #searchfields [fields]=\"filterFields\" class=\"mr-2 f-utils-fill\"  \r\n        *ngIf=\"filterFields && filterFields.length && (viewType == 'both' || viewType=== 'onlyfield')\" \r\n        (conditionChange)=\"onConditionChange($event, false)\"></farris-search-fields>\r\n\r\n        <div style=\"min-width:40%;\" class=\"d-flex flex-row\" [class.w-100]=\"!filterFields || !filterFields.length\" [style.maxWidth]=\"filterFields && filterFields.length?'70%': '100%'\">\r\n            <farris-search-box #searchbox [fields]=\"fields\" [useAnyField]=\"searchAnyField\"\r\n            (conditionChange)=\"onConditionChange($event, true)\" class=\"f-cmp-inputgroup f-utils-fill\" \r\n            *ngIf=\"(viewType == 'both' || viewType=== 'onlyinput')\" (escHandler)=\"onEsc($event)\"></farris-search-box>\r\n            <span class=\"f-icon f-icon-remove clear-search-fields\" \r\n                [ngStyle]=\"((textConditions && textConditions.length) || (fieldConditons && fieldConditons.length)) ? { }: {opacity: '0.3',pointerEvents: 'none'}\"\r\n                (click)=\"onClearConditions($event)\" title=\"{{ 'lookup.clearAllConditions' | locale }}\" style=\"min-width:28px;border: 0;\"></span>\r\n        </div>\r\n    </div>\r\n    `\r\n})\r\n\r\nexport class LookupFilterBarComponent implements OnInit, OnChanges, AfterViewInit {\r\n\r\n    fields = [];\r\n    filterFields = [];\r\n    @Input() searchAnyField = true;\r\n    @Input() columns = [];\r\n    @Input() viewType: SearchBarMode = SearchBarMode.both;\r\n    @Input() isNav = false;\r\n\r\n    @Input() searchFields = [];\r\n\r\n    @Output() conditionsChange = new EventEmitter();\r\n\r\n    @ViewChild('searchbox') searchboxRef: SearchBoxComponent;\r\n    @ViewChild('searchfields') searchfieldsRef: SearchFieldsComponent;\r\n\r\n    textConditions = [];\r\n    fieldConditons = [];\r\n    \r\n\r\n    dialogRef: DialogComponent;\r\n    private el: ElementRef;\r\n    constructor(private injector: Injector, private cd: ChangeDetectorRef, private lookIns: LookupGridComponent) {\r\n        this.dialogRef = this.injector.get(DialogComponent, null);\r\n        this.el = this.injector.get(ElementRef);\r\n    }\r\n\r\n    ngOnInit() {\r\n        this.searchFields = this.searchFields || [];\r\n        this.convertColumnsToSearchFields();\r\n\r\n        if(this.dialogRef && this.searchboxRef) {\r\n            this.dialogRef.moving.subscribe(() => {\r\n                this.searchboxRef.updateShadowBoxPosition();\r\n            })\r\n        }\r\n    }\r\n\r\n    ngOnChanges(changes: SimpleChanges): void {\r\n        if (changes.columns && !changes.columns.isFirstChange()) {\r\n            this.convertColumnsToSearchFields();\r\n            setTimeout(() => {\r\n                this.initSearchValue();\r\n            }, 100)\r\n        }\r\n    }\r\n\r\n    ngAfterViewInit() {\r\n    }\r\n\r\n    private initSearchValue() {\r\n        if (this.lookIns._searchState && !this.isNav && this.searchboxRef) {\r\n            const { field, value} = this.lookIns._searchState;\r\n            if (field === '*' && value != '' && value !== null && value!== undefined) {\r\n                const alltitle = this.lookIns.localService.getValue('lookup.anyFields')\r\n                const _conditions = [{ code: '*', name: alltitle, value }];\r\n                this.searchboxRef.setValue(_conditions, false);\r\n                this.textConditions = this.searchboxRef.expandStarFieldToAllFields();\r\n            }\r\n        }\r\n    }\r\n\r\n    private converColumnToFilterField(n: any) {\r\n        const t: any = {};\r\n        t.id = n.field;\r\n        t.labelCode = n.field;\r\n        t.code = n.fieldPath;\r\n        t.name = n.title;\r\n        const options = n.formatter ? n.formatter.options : null;\r\n        // æ°å­\r\n        if (n.fieldType === 'NumericType') {\r\n            const _options = {...(options || {})};\r\n            n.precision = n.precision || 0;\r\n            _options.precision = _options.precision || 0;\r\n            if (n.precision != _options.precision) {\r\n                _options.precision = n.precision;\r\n            }\r\n\r\n            t.control = Object.assign({ \r\n                \"controltype\": \"number\", \r\n                \"bigNumber\": false, \r\n                \"placeHolder\": 'è¯·è¾å¥æ°å­', \r\n                single: true \r\n            }, _options);\r\n            t.beginPlaceHolder = \"å¼å§æ°å¼\";\r\n            t.endPlaceHolder = \"ç»ææ°å¼\";\r\n        }\r\n        // æä¸¾\r\n        if (n.fieldType === 'EnumType') {\r\n            t.control = {\r\n                \"controltype\": \"enum\",\r\n                \"enumValues\": n.formatter.options.data,\r\n                single: true\r\n            };\r\n        }\r\n\r\n        // å¸å°\r\n        if (n.fieldType === 'BooleanType') {\r\n            let trueText = options ? options.trueText || 'True' : 'True';\r\n\r\n            let falseText = options ? options.falseText || 'False' : 'False';\r\n            t.control = {\r\n                controltype: 'dropdown',\r\n                enumValues: [\r\n                    { value: 1, name: trueText },\r\n                    { value: 0, name: falseText },\r\n                ],\r\n                single: true\r\n            };\r\n        }\r\n\r\n        // æ¥æ\r\n        if (n.fieldType === \"DateType\" || n.fieldType === 'DateTimeType') {\r\n\r\n            let dateFormat = 'yyyy-MM-dd';\r\n            let showTime = false;\r\n            let showType = '1';\r\n            if (options) {\r\n                if (options.format) {\r\n                    dateFormat = options.format;\r\n                }\r\n            }\r\n            if (n.fieldType === 'DateTimeType') {\r\n                showTime = true;\r\n            }\r\n            if (dateFormat === 'yyyy') {\r\n                showType = '2';\r\n            }\r\n            if (dateFormat === 'yyyy-MM') {\r\n                showType = '3';\r\n            }\r\n            t.control = {\r\n                \"controltype\": \"datetime\",\r\n                \"placeholder\": \"è¯·éæ©æ¥æ\",\r\n                single: true,\r\n                dateFormat,\r\n                showTime,\r\n                showType\r\n            };\r\n        }\r\n        return t;\r\n    }\r\n\r\n    private convertColumnsToSearchFields() {\r\n        if (this.columns && this.columns.length) {\r\n            this.fields = this.columns.filter(n => n.fieldType && (n.fieldType === 'StringType' || n.fieldType === 'TextType')).map(n => {\r\n                return {\r\n                    code: n.fieldPath,\r\n                    name: n.title\r\n                };\r\n            });\r\n\r\n            if (!this.fields.length && this.searchFields.length) {\r\n                this.fields = this.searchFields.map(n => {\r\n                    return {\r\n                        code: n.value,\r\n                        name: n.label\r\n                    }\r\n                });\r\n            }\r\n\r\n            if (this.viewType === 'both' || this.viewType === 'onlyfield') {\r\n                this.filterFields = this.columns.filter(n => n.fieldType && n.fieldType !== 'StringType' && n.fieldType !== 'TextType' && n.field).map(n => {\r\n                    return this.converColumnToFilterField(n);\r\n                });\r\n            }\r\n\r\n            if (this.lookIns && this.lookIns.allowQueryFields) {\r\n                const { nav, main } = this.lookIns.allowQueryFields;\r\n                let queryFields = main;\r\n                if (this.isNav) {\r\n                    queryFields = nav;\r\n                }\r\n\r\n                if (queryFields) {\r\n                    const _queryFields = queryFields.split(',');\r\n                    this.fields = this.fields.filter(n => _queryFields.findIndex(f => f === n.code) > -1);\r\n                    this.filterFields = this.filterFields.filter(n => _queryFields.findIndex((f: any) => f === n.code) > -1);\r\n                }\r\n            }\r\n\r\n            this.cd.markForCheck();\r\n        }\r\n    }\r\n\r\n    onConditionChange($event, isString = true) {\r\n        if (isString) {\r\n            this.textConditions = $event;\r\n        } else {\r\n            this.fieldConditons = $event;\r\n        }\r\n\r\n        this.textConditions = this.textConditions || [];\r\n        const _conditions$ =  this.fieldConditons.concat([]);\r\n        if (this.fieldConditons && this.fieldConditons.length && this.textConditions.length) {\r\n            _conditions$[0].lbracket =  this.fieldConditons[0].lbracket + '(';\r\n            _conditions$[_conditions$.length - 1].relation = 1;\r\n            _conditions$[_conditions$.length - 1].rbracket =  _conditions$[_conditions$.length - 1].rbracket + ')';\r\n        }\r\n        \r\n        const _conditions = _conditions$.concat(this.textConditions);\r\n        this.conditionsChange.emit(_conditions);\r\n    }\r\n\r\n    onClearConditions($event: MouseEvent) {\r\n        $event.stopPropagation();\r\n        this.textConditions = [];\r\n        this.fieldConditons = [];\r\n\r\n\r\n        if (this.searchboxRef) {\r\n            this.searchboxRef.clearConditions(false);\r\n        }\r\n\r\n        if (this.searchfieldsRef) {\r\n            this.filterFields.forEach(n => {\r\n                n.value = null;\r\n            });\r\n            this.searchfieldsRef.clearConditions(false);\r\n        }\r\n\r\n        this.cd.detectChanges();\r\n        this.conditionsChange.emit([]);\r\n    }\r\n\r\n    onEsc($event) {\r\n        this.lookIns.closeLoading();\r\n        this.lookIns.closeDialog();\r\n    }\r\n}","import { AfterViewInit, Directive, ElementRef, Injector, Input, NgZone, OnDestroy, OnInit, Renderer2 } from '@angular/core';\r\nimport { CommonUtils, OverLayHiddenService } from '@farris/ui-common';\r\nimport { DataTableComponent } from '@farris/ui-datatable';\r\nimport { NotifyService } from '@farris/ui-notify';\r\n\r\n@Directive({ selector: '[lookup-selected]' })\r\nexport class LookupSelectedDirective implements OnInit, AfterViewInit, OnDestroy{\r\n\r\n    @Input() selectedPanel: ElementRef;\r\n    @Input() dataTableRef: DataTableComponent;\r\n    @Input() count = 0;\r\n\r\n    private overlaySer: OverLayHiddenService;\r\n    private panelMouseEvent = null;\r\n    private notifySer: NotifyService = null;\r\n    private commonUtils = null;\r\n    private panelEscHandler = null;\r\n\r\n    constructor(private injector: Injector, private elRef: ElementRef, private render: Renderer2, private ngZone: NgZone) {\r\n        this.overlaySer = new OverLayHiddenService();\r\n        this.notifySer = this.injector.get(NotifyService, null);\r\n        this.commonUtils = this.injector.get(CommonUtils, new CommonUtils())\r\n    }\r\n\r\n    ngOnInit(): void {\r\n        \r\n    }\r\n\r\n    ngAfterViewInit(): void {\r\n        setTimeout(() => {\r\n            this.bindingEvents();\r\n        });\r\n\r\n        this.panelMouseEvent =  this.overlaySer.registerMouseEvent(this.elRef.nativeElement, (e: any) => {\r\n            if (this.selectedPanel.nativeElement.contains(e.target)  || this.elRef.nativeElement.contains(e.target) || \r\n            e.target.classList.contains('lookup-clear-selected-items') || e.target.closest('.farris-messager')) {\r\n                return;\r\n            }\r\n\r\n            this.showPanel(false);\r\n        });\r\n    }\r\n\r\n    ngOnDestroy(): void {\r\n        if (this.panelMouseEvent) {\r\n            this.panelMouseEvent();\r\n            this.panelMouseEvent = null;\r\n        }\r\n    }\r\n\r\n    private showPanel(show = true) {\r\n        const panel = this.selectedPanel.nativeElement;\r\n        if (!show) {\r\n            this.render.removeClass(panel, 'show');\r\n            this.render.addClass(panel, 'd-none');\r\n            if (this.panelEscHandler) {\r\n                this.panelEscHandler();\r\n                this.panelEscHandler = null;\r\n            }\r\n\r\n        } else {\r\n            this.render.addClass(panel, 'show');\r\n            this.render.removeClass(panel, 'd-none');\r\n            // æ³¨åESC\r\n            if (this.commonUtils) {\r\n                this.panelEscHandler = this.commonUtils.regBodyKeydownEvent(null, () => this.showPanel(false));\r\n            }\r\n        }\r\n    }\r\n\r\n    private bindingEvents() {\r\n        if (!this.selectedPanel) {\r\n            return;\r\n        }\r\n        this.ngZone.runOutsideAngular(() => {\r\n            const panel = this.selectedPanel.nativeElement;\r\n            \r\n            this.render.listen(this.elRef.nativeElement, 'click', () => {\r\n                if (this.selectedPanel && this.count) {\r\n                    if (panel.classList.contains('show')) {\r\n                        this.showPanel(false);\r\n                    } else {\r\n                        this.showPanel();\r\n                        const selectedTableContainer = panel.querySelector('.farris-datatable-container');\r\n                        const selectedTableBody = panel.querySelector('.farris-table-scorllable-body');\r\n                        this.render.removeStyle(selectedTableContainer, 'height');\r\n                        this.render.removeStyle(selectedTableBody, 'height');\r\n                      \r\n                        this.dataTableRef.resize({height: panel.offsetHeight - 28, width: panel.offsetWidth - 28});\r\n\r\n                        this.render.setStyle(selectedTableBody, 'height', this.dataTableRef.tableHeight + 'px');\r\n                        this.render.setStyle(selectedTableBody, 'height', this.dataTableRef.scorllableBodyHeight + 'px');\r\n                        \r\n                        this.dataTableRef.dtBody.checkBodyHeightWhenEmptyData();\r\n                    }\r\n                } else {\r\n                    if (this.notifySer) {\r\n                        this.notifySer.warning('å½åè¿æ²¡æéæ©æ°æ®ã');\r\n                    }\r\n                }\r\n            });\r\n        });\r\n    }\r\n\r\n\r\n}","/*\r\n * @Author: ç¯çç§æ(Lucas Huang)\r\n * @Date: 2018-12-04 10:43:42\r\n * @LastEditors: ç¯çç§æ(Lucas Huang)\r\n * @LastEditTime: 2019-09-26 13:33:30\r\n * @Company: Inspur\r\n * @Version: v0.0.1\r\n */\r\nimport { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FormsModule } from '@angular/forms';\r\n\r\nimport { FarrisCommonModule } from '@farris/ui-common';\r\nimport { InputGroupModule } from '@farris/ui-input-group';\r\nimport { LayoutModule } from '@farris/ui-layout';\r\nimport { LocaleModule} from '@farris/ui-locale';\r\nimport { FarrisDialogModule } from '@farris/ui-dialog';\r\nimport { MessagerModule } from '@farris/ui-messager';\r\nimport { DataTableModule, DataTableComponent } from '@farris/ui-datatable';\r\nimport { TreeTableModule, TreeTableComponent } from '@farris/ui-treetable';\r\nimport { LoadingModule } from '@farris/ui-loading';\r\nimport { NotifyModule } from '@farris/ui-notify';\r\nimport { FarrisContextMenuModule } from '@farris/ui-context-menu';\r\nimport { FarrisFormsModule } from '@farris/ui-forms';\r\n\r\nimport { LookupGridComponent } from './lookup-grid.component';\r\nimport { LookupComponent } from './lookup.component';\r\nimport { LookupLeftComponent } from './lookup-left.component';\r\nimport { LookupTabsComponent } from './lookup-tabs.component';\r\nimport { LookupTipDirective } from './lookup-tip.directive';\r\n\r\nimport { LookupQuickSelectPanelComponent } from './quick-select/quick-select-panel.component';\r\nimport { LookupQuickSelectDirective } from './quick-select/lookup-quick-select.directive';\r\nimport { LookupAdvancedLayoutComponent } from './advanced-layout/lookup-advanced-layout.component';\r\nimport { SearchBoxModule } from '@farris/ui-search-box';\r\nimport { LookupFilterBarComponent } from './advanced-layout/lookup-filter-bar.component';\r\nimport { LookupSelectedDirective } from './selected-list/lookup-selected.directive';\r\n@NgModule({\r\n    imports: [\r\n        CommonModule,\r\n        FormsModule,\r\n        FarrisCommonModule.forRoot(),\r\n        FarrisDialogModule.forRoot(),\r\n        MessagerModule.forRoot(),\r\n        NotifyModule.forRoot(),\r\n        LoadingModule.forRoot({delay: 1000}),\r\n        InputGroupModule,\r\n        LayoutModule,\r\n        DataTableModule,\r\n        TreeTableModule,\r\n        FarrisContextMenuModule,\r\n        LocaleModule.forRoot(),\r\n        SearchBoxModule,\r\n        FarrisFormsModule\r\n    ],\r\n    exports: [\r\n        LookupGridComponent, \r\n        LookupComponent,\r\n        LookupAdvancedLayoutComponent\r\n    ],\r\n    declarations: [\r\n        LookupGridComponent,\r\n        LookupComponent,\r\n        LookupLeftComponent,\r\n        LookupTabsComponent,\r\n        LookupTipDirective,\r\n        LookupQuickSelectPanelComponent,\r\n        LookupQuickSelectDirective,\r\n        LookupAdvancedLayoutComponent,\r\n        LookupFilterBarComponent,\r\n        LookupSelectedDirective\r\n    ],\r\n    providers: [],\r\n    entryComponents: [\r\n        DataTableComponent, \r\n        TreeTableComponent, \r\n        LookupLeftComponent,\r\n        LookupTabsComponent,\r\n        LookupQuickSelectPanelComponent,\r\n        LookupAdvancedLayoutComponent,\r\n        LookupFilterBarComponent\r\n    ]\r\n})\r\nexport class LookupModule {}\r\n"],"names":["tslib_1.__extends"],"mappings":"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"}
