/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
/*
 * @Author: 疯狂秀才(Lucas Huang)
 * @Date: 2019-08-15 15:24:24
 * @LastEditors: 疯狂秀才(Lucas Huang)
 * @LastEditTime: 2019-11-30 14:01:34
 * @QQ: 1055818239
 * @Version: v0.0.1
 */
import { of, Subject } from 'rxjs';
import { Component, Input, Output, EventEmitter, TemplateRef, ViewChild, Injector, forwardRef, ElementRef, ChangeDetectorRef, HostBinding, NgZone } from '@angular/core';
import { NG_VALUE_ACCESSOR, NgControl } from '@angular/forms';
import { DialogComponent } from '@farris/ui-dialog';
/** @type {?} */
export const LOOKUPINPUT_VALUE_ACCESSOR = {
    provide: NG_VALUE_ACCESSOR,
    useExisting: forwardRef((/**
     * @return {?}
     */
    () => LookupComponent)),
    multi: true
};
export class LookupComponent {
    /**
     * @param {?} injector
     * @param {?} el
     * @param {?=} changeDetector
     */
    constructor(injector, el, changeDetector) {
        this.injector = injector;
        this.el = el;
        this.changeDetector = changeDetector;
        this.hostCls = 'f-cmp-inputgroup';
        /**
         * 窗口标题。默认值：此处显示帮助标题
         */
        this.title = '';
        /**
         * 按钮对齐方式
         */
        this.buttonAlign = 'right';
        /**
         * 是否显示按钮
         */
        this.showButtons = true;
        /**
         * 显示关闭按钮
         */
        this.showCloseButton = true;
        /**
         * 显示最大化按钮
         */
        this.showMaxButton = true;
        /**
         * 允许拖拽尺寸
         */
        this.resizable = true;
        /**
         * 允许拖动窗口
         */
        this.draggable = true;
        /**
         * 禁用
         */
        this.disabled = false;
        /**
         * 允许编辑文本框
         */
        this.editable = true;
        /**
         * 只读
         */
        this.readonly = false;
        this.displayText = '';
        /**
         * 窗口打开后
         */
        this.dialogOpened = new EventEmitter();
        /**
         * 窗口关闭后
         */
        this.dialogClosed = new EventEmitter();
        /**
         * 窗口最大化
         */
        this.dialogMaxed = new EventEmitter();
        /**
         * 拖拽改变窗口尺寸进行时
         */
        this.resizing = new EventEmitter();
        /**
         * 拖拽改变窗口尺寸结束
         */
        this.resized = new EventEmitter();
        /**
         * 帮助窗口默认尺寸
         */
        this.defaultDialogSize = { width: 550, height: 570 };
        this.dialogCreated = new Subject();
        this._isShow = false;
        this.displayValue = '';
        this.originalText = '';
        this.onModelChange = (/**
         * @param {?} obj
         * @return {?}
         */
        (obj) => { });
        this.onModelTouched = (/**
         * @param {?} val
         * @return {?}
         */
        (val) => { });
        this.ngZone = this.injector.get(NgZone);
        // if (!this.personalConfigService) {
        //     const idServ = this.injector.get(IdService);
        //     this.personalConfigService = new PersonalConfigService(idServ);
        // }
    }
    /**
     * @param {?} content
     * @return {?}
     */
    set content(content) {
        if (this.dialog !== content) {
            this.dialog = content;
            if (content) {
                this.dialogCreated.next(this.dialog);
            }
        }
    }
    /**
     * @return {?}
     */
    get isShow() {
        return this._isShow;
    }
    /**
     * @param {?} val
     * @return {?}
     */
    set isShow(val) {
        this._isShow = val;
        if (!this.changeDetector['destroyed']) {
            this.changeDetector.detectChanges();
        }
    }
    /**
     * @return {?}
     */
    get invalid() {
        return this.ngControl.valid;
    }
    /**
     * @return {?}
     */
    ngOnInit() {
        this.initEvents();
        this.ngControl = this.injector.get(NgControl, null);
    }
    /**
     * @return {?}
     */
    ngOnDestroy() {
        this.lookupUnsubscribe();
    }
    /**
     * @return {?}
     */
    ngAfterViewChecked() {
        if (this.dialog) {
            this.dialog.closed.subscribe((/**
             * @return {?}
             */
            () => {
                this.isShow = false;
                this.dialog = null;
            }));
        }
    }
    /**
     * @return {?}
     */
    initEvents() {
        if (!this.dictPicking) {
            this.dictPicking = (/**
             * @return {?}
             */
            () => of({ showDialog: true }));
        }
        if (!this.dictPicked) {
            this.dictPicked = (/**
             * @return {?}
             */
            () => of({ closeDialog: true }));
        }
        if (!this.beforeOpen) {
            this.beforeOpen = (/**
             * @return {?}
             */
            () => of(true));
        }
        if (!this.beforeClose) {
            this.beforeClose = (/**
             * @return {?}
             */
            () => of(true));
        }
        if (!this.dialogHeight) {
            this.dialogHeight = this.defaultDialogSize.height;
        }
        if (!this.dialogWidth) {
            this.dialogWidth = this.defaultDialogSize.width;
        }
    }
    /**
     * @return {?}
     */
    showDialog() {
        if (this.disabled || this.readonly) {
            return false;
        }
        this.dictPicking().subscribe((/**
         * @param {?} val
         * @return {?}
         */
        (val) => {
            if (val.showDialog === false) {
                return;
            }
            this.isShow = true;
            // this.changeDetector.detectChanges();
            this.ngZone.runOutsideAngular((/**
             * @return {?}
             */
            () => {
                setTimeout((/**
                 * @return {?}
                 */
                () => this.dialog.show()));
            }));
        }));
        return false;
    }
    /**
     * @return {?}
     */
    closeDialog() {
        this.isShow = false;
        if (this.dialog) {
            this.dialog.close();
        }
    }
    /**
     * @private
     * @return {?}
     */
    lookupUnsubscribe() {
        if (this.dictPickedSubscription) {
            this.dictPickedSubscription.unsubscribe();
        }
        if (this.dictPickingSubscription) {
            this.dictPickingSubscription.unsubscribe();
        }
        if (this.dialogCreatedSubscription) {
            this.dialogCreatedSubscription.unsubscribe();
        }
    }
    /**
     * @param {?} pos
     * @return {?}
     */
    onResizing(pos) {
        this.resizing.emit(pos.size);
    }
    /**
     * @param {?} pos
     * @return {?}
     */
    onResized(pos) {
        this.resized.emit(pos.size);
    }
    /**
     * @param {?} pos
     * @return {?}
     */
    onMaxDialog(pos) {
        this.dialogMaxed.emit(pos.size);
    }
    /**
     * @param {?} obj
     * @return {?}
     */
    writeValue(obj) {
        if (obj) {
            this.displayText = obj;
            this.displayValue = obj;
            this.originalText = this.displayText;
        }
        else {
            this.displayText = '';
            this.displayValue = '';
            this.originalText = '';
        }
    }
    /**
     * @param {?} fn
     * @return {?}
     */
    registerOnChange(fn) {
        this.onModelChange = fn;
    }
    /**
     * @param {?} fn
     * @return {?}
     */
    registerOnTouched(fn) {
        this.onModelTouched = fn;
    }
    /**
     * @param {?} isDisabled
     * @return {?}
     */
    setDisabledState(isDisabled) {
        this.disabled = isDisabled;
    }
}
LookupComponent.decorators = [
    { type: Component, args: [{
                selector: 'farris-lookup',
                template: `
        <div
            class="lookupbox input-group"
            [ngClass]="{
                'f-state-disabled': disabled,
                'f-state-readonly': readonly,
                'f-state-editable': !editable
            }"
        >
            <input
                class="form-control"
                [value]="displayText"
                [disabled]="disabled"
                [readonly]="!editable || readonly"
            />
            <div class="input-group-append">
                <span class="f-select input-group-text" (click)="showDialog()">
                    <i class="f-icon f-icon-lookup"></i>
                </span>
            </div>
        </div>
        <farris-dialog
            #dialog
            *ngIf="isShow"
            [title]="title"
            [beforeOpen]="beforeOpen"
            [beforeClose]="beforeClose"
            [width]="dialogWidth"
            [height]="dialogHeight"
            [showButtons]="showButtons"
            [showMaxButton]="showMaxButton"
            [buttons]="buttonsRef || defaultButtonRef"
            [buttonAlign]="buttonAlign"
            (maxed)="onMaxDialog($event)"
            (resized)="onResized($event)"
            (resizing)="onResizing($event)"
        >
            <ng-content></ng-content>

            <ng-template #defaultButtonRef>
                <div style="width: 100%;">
                    <button
                        class="btn btn-secondary btn-lg"
                        (click)="closeDialog()"
                    >
                        Cancel
                    </button>
                    <button class="btn btn-primary btn-lg">Ok</button>
                </div>
            </ng-template>
        </farris-dialog>
    `,
                providers: [LOOKUPINPUT_VALUE_ACCESSOR],
                styles: [`
            .input-group {
                flex-wrap: nowrap;
            }
            :host-context(.ng-invalid) .form-control {
                border-color: #ff0303;
            }
        `]
            }] }
];
/** @nocollapse */
LookupComponent.ctorParameters = () => [
    { type: Injector },
    { type: ElementRef },
    { type: ChangeDetectorRef }
];
LookupComponent.propDecorators = {
    hostCls: [{ type: HostBinding, args: ['class',] }],
    dialogWidth: [{ type: Input }],
    dialogHeight: [{ type: Input }],
    title: [{ type: Input }],
    buttonAlign: [{ type: Input }],
    buttonsRef: [{ type: Input }],
    showButtons: [{ type: Input }],
    showCloseButton: [{ type: Input }],
    showMaxButton: [{ type: Input }],
    resizable: [{ type: Input }],
    draggable: [{ type: Input }],
    disabled: [{ type: Input }],
    editable: [{ type: Input }],
    readonly: [{ type: Input }],
    mapFields: [{ type: Input }],
    valueField: [{ type: Input }],
    textField: [{ type: Input }],
    displayText: [{ type: Input }],
    context: [{ type: Input }],
    beforeOpen: [{ type: Input }],
    beforeClose: [{ type: Input }],
    dictPicking: [{ type: Input }],
    dictPicked: [{ type: Input }],
    dialogOpened: [{ type: Output }],
    dialogClosed: [{ type: Output }],
    dialogMaxed: [{ type: Output }],
    resizing: [{ type: Output }],
    resized: [{ type: Output }],
    content: [{ type: ViewChild, args: ['dialog',] }]
};
if (false) {
    /** @type {?} */
    LookupComponent.prototype.hostCls;
    /**
     * 窗口宽度
     * @type {?}
     */
    LookupComponent.prototype.dialogWidth;
    /**
     * 窗口高度
     * @type {?}
     */
    LookupComponent.prototype.dialogHeight;
    /**
     * 窗口标题。默认值：此处显示帮助标题
     * @type {?}
     */
    LookupComponent.prototype.title;
    /**
     * 按钮对齐方式
     * @type {?}
     */
    LookupComponent.prototype.buttonAlign;
    /**
     * 按钮模板
     * @type {?}
     */
    LookupComponent.prototype.buttonsRef;
    /**
     * 是否显示按钮
     * @type {?}
     */
    LookupComponent.prototype.showButtons;
    /**
     * 显示关闭按钮
     * @type {?}
     */
    LookupComponent.prototype.showCloseButton;
    /**
     * 显示最大化按钮
     * @type {?}
     */
    LookupComponent.prototype.showMaxButton;
    /**
     * 允许拖拽尺寸
     * @type {?}
     */
    LookupComponent.prototype.resizable;
    /**
     * 允许拖动窗口
     * @type {?}
     */
    LookupComponent.prototype.draggable;
    /**
     * 禁用
     * @type {?}
     */
    LookupComponent.prototype.disabled;
    /**
     * 允许编辑文本框
     * @type {?}
     */
    LookupComponent.prototype.editable;
    /**
     * 只读
     * @type {?}
     */
    LookupComponent.prototype.readonly;
    /**
     * 字段映射, { 帮助数据字段：表单字段 }
     * @type {?}
     */
    LookupComponent.prototype.mapFields;
    /**
     * 值字段
     * @type {?}
     */
    LookupComponent.prototype.valueField;
    /**
     * 文本字段
     * @type {?}
     */
    LookupComponent.prototype.textField;
    /** @type {?} */
    LookupComponent.prototype.displayText;
    /**
     * 运行时上下文自定义对象
     * @type {?}
     */
    LookupComponent.prototype.context;
    /**
     * 窗口打开前事件
     * @type {?}
     */
    LookupComponent.prototype.beforeOpen;
    /**
     * 窗口关闭前事件
     * @type {?}
     */
    LookupComponent.prototype.beforeClose;
    /**
     * 帮助前事件
     * @type {?}
     */
    LookupComponent.prototype.dictPicking;
    /** @type {?} */
    LookupComponent.prototype.dictPickingSubscription;
    /**
     * 帮助后事件
     * @type {?}
     */
    LookupComponent.prototype.dictPicked;
    /** @type {?} */
    LookupComponent.prototype.dictPickedSubscription;
    /**
     * 窗口打开后
     * @type {?}
     */
    LookupComponent.prototype.dialogOpened;
    /**
     * 窗口关闭后
     * @type {?}
     */
    LookupComponent.prototype.dialogClosed;
    /**
     * 窗口最大化
     * @type {?}
     */
    LookupComponent.prototype.dialogMaxed;
    /**
     * 拖拽改变窗口尺寸进行时
     * @type {?}
     */
    LookupComponent.prototype.resizing;
    /**
     * 拖拽改变窗口尺寸结束
     * @type {?}
     */
    LookupComponent.prototype.resized;
    /**
     * 帮助窗口默认尺寸
     * @type {?}
     * @private
     */
    LookupComponent.prototype.defaultDialogSize;
    /** @type {?} */
    LookupComponent.prototype.dialogCreated;
    /** @type {?} */
    LookupComponent.prototype.dialogCreatedSubscription;
    /** @type {?} */
    LookupComponent.prototype.dialog;
    /**
     * @type {?}
     * @private
     */
    LookupComponent.prototype._isShow;
    /** @type {?} */
    LookupComponent.prototype.ngControl;
    /** @type {?} */
    LookupComponent.prototype.displayValue;
    /** @type {?} */
    LookupComponent.prototype.originalText;
    /**
     * @type {?}
     * @private
     */
    LookupComponent.prototype.ngZone;
    /** @type {?} */
    LookupComponent.prototype.onModelChange;
    /** @type {?} */
    LookupComponent.prototype.onModelTouched;
    /** @type {?} */
    LookupComponent.prototype.injector;
    /** @type {?} */
    LookupComponent.prototype.el;
    /** @type {?} */
    LookupComponent.prototype.changeDetector;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibG9va3VwLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BmYXJyaXMvdWktbG9va3VwLyIsInNvdXJjZXMiOlsibGliL2xvb2t1cC5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7O0FBUUEsT0FBTyxFQUE0QixFQUFFLEVBQUUsT0FBTyxFQUFFLE1BQU0sTUFBTSxDQUFDO0FBQzdELE9BQU8sRUFDSCxTQUFTLEVBQUUsS0FBSyxFQUFFLE1BQU0sRUFBRSxZQUFZLEVBQUUsV0FBVyxFQUNuRCxTQUFTLEVBQUUsUUFBUSxFQUFFLFVBQVUsRUFBVSxVQUFVLEVBQUUsaUJBQWlCLEVBQ3BELFdBQVcsRUFBRSxNQUFNLEVBQ3hDLE1BQU0sZUFBZSxDQUFDO0FBQ3ZCLE9BQU8sRUFDSCxpQkFBaUIsRUFFakIsU0FBUyxFQUNaLE1BQU0sZ0JBQWdCLENBQUM7QUFFeEIsT0FBTyxFQUFFLGVBQWUsRUFBRSxNQUFNLG1CQUFtQixDQUFDOztBQUtwRCxNQUFNLE9BQU8sMEJBQTBCLEdBQVE7SUFDM0MsT0FBTyxFQUFFLGlCQUFpQjtJQUMxQixXQUFXLEVBQUUsVUFBVTs7O0lBQUMsR0FBRyxFQUFFLENBQUMsZUFBZSxFQUFDO0lBQzlDLEtBQUssRUFBRSxJQUFJO0NBQ2Q7QUFvRUQsTUFBTSxPQUFPLGVBQWU7Ozs7OztJQXFHeEIsWUFDVyxRQUFrQixFQUNsQixFQUFjLEVBQ2QsY0FBa0M7UUFGbEMsYUFBUSxHQUFSLFFBQVEsQ0FBVTtRQUNsQixPQUFFLEdBQUYsRUFBRSxDQUFZO1FBQ2QsbUJBQWMsR0FBZCxjQUFjLENBQW9CO1FBdEd2QixZQUFPLEdBQUcsa0JBQWtCLENBQUM7Ozs7UUFPMUMsVUFBSyxHQUFHLEVBQUUsQ0FBQzs7OztRQUVYLGdCQUFXLEdBQUcsT0FBTyxDQUFDOzs7O1FBSXRCLGdCQUFXLEdBQUcsSUFBSSxDQUFDOzs7O1FBRW5CLG9CQUFlLEdBQUcsSUFBSSxDQUFDOzs7O1FBRXZCLGtCQUFhLEdB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dXRob3I6IOeWr+eLguengOaJjShMdWNhcyBIdWFuZylcclxuICogQERhdGU6IDIwMTktMDgtMTUgMTU6MjQ6MjRcclxuICogQExhc3RFZGl0b3JzOiDnlq/ni4Lnp4DmiY0oTHVjYXMgSHVhbmcpXHJcbiAqIEBMYXN0RWRpdFRpbWU6IDIwMTktMTEtMzAgMTQ6MDE6MzRcclxuICogQFFROiAxMDU1ODE4MjM5XHJcbiAqIEBWZXJzaW9uOiB2MC4wLjFcclxuICovXHJcbmltcG9ydCB7IFN1YnNjcmlwdGlvbiwgT2JzZXJ2YWJsZSwgb2YsIFN1YmplY3QgfSBmcm9tICdyeGpzJztcclxuaW1wb3J0IHtcclxuICAgIENvbXBvbmVudCwgSW5wdXQsIE91dHB1dCwgRXZlbnRFbWl0dGVyLCBUZW1wbGF0ZVJlZixcclxuICAgIFZpZXdDaGlsZCwgSW5qZWN0b3IsIGZvcndhcmRSZWYsIE9uSW5pdCwgRWxlbWVudFJlZiwgQ2hhbmdlRGV0ZWN0b3JSZWYsXHJcbiAgICBBZnRlclZpZXdDaGVja2VkLCBIb3N0QmluZGluZywgTmdab25lLCBPbkRlc3Ryb3lcclxufSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHtcclxuICAgIE5HX1ZBTFVFX0FDQ0VTU09SLFxyXG4gICAgQ29udHJvbFZhbHVlQWNjZXNzb3IsXHJcbiAgICBOZ0NvbnRyb2xcclxufSBmcm9tICdAYW5ndWxhci9mb3Jtcyc7XHJcblxyXG5pbXBvcnQgeyBEaWFsb2dDb21wb25lbnQgfSBmcm9tICdAZmFycmlzL3VpLWRpYWxvZyc7XHJcbmltcG9ydCB7IElSZXNpemVFdmVudCB9IGZyb20gJ0BmYXJyaXMvdWktZHJhZ2dhYmxlJztcclxuXHJcbmltcG9ydCB7IFBpY2tpbmdSZXN1bHQsIFBpY2tlZFJlc3VsdCB9IGZyb20gJy4vbG9va3VwLWdyaWQtb3B0aW9ucyc7XHJcblxyXG5leHBvcnQgY29uc3QgTE9PS1VQSU5QVVRfVkFMVUVfQUNDRVNTT1I6IGFueSA9IHtcclxuICAgIHByb3ZpZGU6IE5HX1ZBTFVFX0FDQ0VTU09SLFxyXG4gICAgdXNlRXhpc3Rpbmc6IGZvcndhcmRSZWYoKCkgPT4gTG9va3VwQ29tcG9uZW50KSxcclxuICAgIG11bHRpOiB0cnVlXHJcbn07XHJcblxyXG5AQ29tcG9uZW50KHtcclxuICAgIHNlbGVjdG9yOiAnZmFycmlzLWxvb2t1cCcsXHJcbiAgICB0ZW1wbGF0ZTogYFxyXG4gICAgICAgIDxkaXZcclxuICAgICAgICAgICAgY2xhc3M9XCJsb29rdXBib3ggaW5wdXQtZ3JvdXBcIlxyXG4gICAgICAgICAgICBbbmdDbGFzc109XCJ7XHJcbiAgICAgICAgICAgICAgICAnZi1zdGF0ZS1kaXNhYmxlZCc6IGRpc2FibGVkLFxyXG4gICAgICAgICAgICAgICAgJ2Ytc3RhdGUtcmVhZG9ubHknOiByZWFkb25seSxcclxuICAgICAgICAgICAgICAgICdmLXN0YXRlLWVkaXRhYmxlJzogIWVkaXRhYmxlXHJcbiAgICAgICAgICAgIH1cIlxyXG4gICAgICAgID5cclxuICAgICAgICAgICAgPGlucHV0XHJcbiAgICAgICAgICAgICAgICBjbGFzcz1cImZvcm0tY29udHJvbFwiXHJcbiAgICAgICAgICAgICAgICBbdmFsdWVdPVwiZGlzcGxheVRleHRcIlxyXG4gICAgICAgICAgICAgICAgW2Rpc2FibGVkXT1cImRpc2FibGVkXCJcclxuICAgICAgICAgICAgICAgIFtyZWFkb25seV09XCIhZWRpdGFibGUgfHwgcmVhZG9ubHlcIlxyXG4gICAgICAgICAgICAvPlxyXG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwiaW5wdXQtZ3JvdXAtYXBwZW5kXCI+XHJcbiAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz1cImYtc2VsZWN0IGlucHV0LWdyb3VwLXRleHRcIiAoY2xpY2spPVwic2hvd0RpYWxvZygpXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgPGkgY2xhc3M9XCJmLWljb24gZi1pY29uLWxvb2t1cFwiPjwvaT5cclxuICAgICAgICAgICAgICAgIDwvc3Bhbj5cclxuICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgPGZhcnJpcy1kaWFsb2dcclxuICAgICAgICAgICAgI2RpYWxvZ1xyXG4gICAgICAgICAgICAqbmdJZj1cImlzU2hvd1wiXHJcbiAgICAgICAgICAgIFt0aXRsZV09XCJ0aXRsZVwiXHJcbiAgICAgICAgICAgIFtiZWZvcmVPcGVuXT1cImJlZm9yZU9wZW5cIlxyXG4gICAgICAgICAgICBbYmVmb3JlQ2xvc2VdPVwiYmVmb3JlQ2xvc2VcIlxyXG4gICAgICAgICAgICBbd2lkdGhdPVwiZGlhbG9nV2lkdGhcIlxyXG4gICAgICAgICAgICBbaGVpZ2h0XT1cImRpYWxvZ0hlaWdodFwiXHJcbiAgICAgICAgICAgIFtzaG93QnV0dG9uc109XCJzaG93QnV0dG9uc1wiXHJcbiAgICAgICAgICAgIFtzaG93TWF4QnV0dG9uXT1cInNob3dNYXhCdXR0b25cIlxyXG4gICAgICAgICAgICBbYnV0dG9uc109XCJidXR0b25zUmVmIHx8IGRlZmF1bHRCdXR0b25SZWZcIlxyXG4gICAgICAgICAgICBbYnV0dG9uQWxpZ25dPVwiYnV0dG9uQWxpZ25cIlxyXG4gICAgICAgICAgICAobWF4ZWQpPVwib25NYXhEaWFsb2coJGV2ZW50KVwiXHJcbiAgICAgICAgICAgIChyZXNpemVkKT1cIm9uUmVzaXplZCgkZXZlbnQpXCJcclxuICAgICAgICAgICAgKHJlc2l6aW5nKT1cIm9uUmVzaXppbmcoJGV2ZW50KVwiXHJcbiAgICAgICAgPlxyXG4gICAgICAgICAgICA8bmctY29udGVudD48L25nLWNvbnRlbnQ+XHJcblxyXG4gICAgICAgICAgICA8bmctdGVtcGxhdGUgI2RlZmF1bHRCdXR0b25SZWY+XHJcbiAgICAgICAgICAgICAgICA8ZGl2IHN0eWxlPVwid2lkdGg6IDEwMCU7XCI+XHJcbiAgICAgICAgICAgICAgICAgICAgPGJ1dHRvblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjbGFzcz1cImJ0biBidG4tc2Vjb25kYXJ5IGJ0bi1sZ1wiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIChjbGljayk9XCJjbG9zZURpYWxvZygpXCJcclxuICAgICAgICAgICAgICAgICAgICA+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIENhbmNlbFxyXG4gICAgICAgICAgICAgICAgICAgIDwvYnV0dG9uPlxyXG4gICAgICAgICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9XCJidG4gYnRuLXByaW1hcnkgYnRuLWxnXCI+T2s8L2J1dHRvbj5cclxuICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICA8L25nLXRlbXBsYXRlPlxyXG4gICAgICAgIDwvZmFycmlzLWRpYWxvZz5cclxuICAgIGAsXHJcbiAgICBzdHlsZXM6IFtcclxuICAgICAgICBgXHJcbiAgICAgICAgICAgIC5pbnB1dC1ncm91cCB7XHJcbiAgICAgICAgICAgICAgICBmbGV4LXdyYXA6IG5vd3JhcDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICA6aG9zdC1jb250ZXh0KC5uZy1pbnZhbGlkKSAuZm9ybS1jb250cm9sIHtcclxuICAgICAgICAgICAgICAgIGJvcmRlci1jb2xvcjogI2ZmMDMwMztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIGBcclxuICAgIF0sXHJcbiAgICBwcm92aWRlcnM6IFtMT09LVVBJTlBVVF9WQUxVRV9BQ0NFU1NPUl1cclxufSlcclxuZXhwb3J0IGNsYXNzIExvb2t1cENvbXBvbmVudFxyXG4gICAgaW1wbGVtZW50cyBPbkluaXQsIENvbnRyb2xWYWx1ZUFjY2Vzc29yLCBBZnRlclZpZXdDaGVja2VkLCBPbkRlc3Ryb3kge1xyXG4gICAgQEhvc3RCaW5kaW5nKCdjbGFzcycpIGhvc3RDbHMgPSAnZi1jbXAtaW5wdXRncm91cCc7XHJcblxyXG4gICAgLyoqIOeql+WPo+WuveW6piAqL1xyXG4gICAgQElucHV0KCkgZGlhbG9nV2lkdGg6IG51bWJlcjtcclxuICAgIC8qKiDnqpflj6Ppq5jluqYgKi9cclxuICAgIEBJbnB1dCgpIGRpYWxvZ0hlaWdodDogbnVtYmVyO1xyXG4gICAgLyoqIOeql+WPo+agh+mimOOAgum7mOiupOWAvO+8muatpOWkhOaYvuekuuW4ruWKqeagh+mimCAqL1xyXG4gICAgQElucHV0KCkgdGl0bGUgPSAnJztcclxuICAgIC8qKiDmjInpkq7lr7npvZDmlrnlvI8gKi9cclxuICAgIEBJbnB1dCgpIGJ1dHRvbkFsaWduID0gJ3JpZ2h0JztcclxuICAgIC8qKiDmjInpkq7mqKHmnb8gKi9cclxuICAgIEBJbnB1dCgpIGJ1dHRvbnNSZWY6IFRlbXBsYXRlUmVmPGFueT47XHJcbiAgICAvKiog5piv5ZCm5pi+56S65oyJ6ZKuICovXHJcbiAgICBASW5wdXQoKSBzaG93QnV0dG9ucyA9IHRydWU7XHJcbiAgICAvKiog5pi+56S65YWz6Zet5oyJ6ZKuICovXHJcbiAgICBASW5wdXQoKSBzaG93Q2xvc2VCdXR0b24gPSB0cnVlO1xyXG4gICAgLyoqIOaYvuekuuacgOWkp+WMluaMiemSriAqL1xyXG4gICAgQElucHV0KCkgc2hvd01heEJ1dHRvbiA9IHRydWU7XHJcbiAgICAvKiog5YWB6K645ouW5ou95bC65a+4ICovXHJcbiAgICBASW5wdXQoKSByZXNpemFibGUgPSB0cnVlO1xyXG4gICAgLyoqIOWFgeiuuOaLluWKqOeql+WPoyAqL1xyXG4gICAgQElucHV0KCkgZHJhZ2dhYmxlID0gdHJ1ZTtcclxuICAgIC8qKiDnpoHnlKggKi9cclxuICAgIEBJbnB1dCgpIGRpc2FibGVkID0gZmFsc2U7XHJcbiAgICAvKiog5YWB6K6457yW6L6R5paH5pys5qGGICovXHJcbiAgICBASW5wdXQoKSBlZGl0YWJsZSA9IHRydWU7XHJcbiAgICAvKiog5Y+q6K+7ICovXHJcbiAgICBASW5wdXQoKSByZWFkb25seSA9IGZhbHNlO1xyXG4gICAgLyoqIOWtl+auteaYoOWwhCwgeyDluK7liqnmlbDmja7lrZfmrrXvvJrooajljZXlrZfmrrUgfSAqL1xyXG4gICAgQElucHV0KCkgbWFwRmllbGRzOiB7IFtzb3VyY2VGaWVsZDogc3RyaW5nXTogc3RyaW5nIH07XHJcbiAgICAvKiog5YC85a2X5q61ICovXHJcbiAgICBASW5wdXQoKSB2YWx1ZUZpZWxkOiBzdHJpbmc7XHJcbiAgICAvKiog5paH5pys5a2X5q61ICovXHJcbiAgICBASW5wdXQoKSB0ZXh0RmllbGQ6IHN0cmluZztcclxuICAgIEBJbnB1dCgpIGRpc3BsYXlUZXh0ID0gJyc7XHJcblxyXG4gICAgLyoqIOi/kOihjOaXtuS4iuS4i+aWh+iHquWumuS5ieWvueixoSAqL1xyXG4gICAgQElucHV0KCkgY29udGV4dDogYW55O1xyXG5cclxuICAgIC8qKiDnqpflj6PmiZPlvIDliY3kuovku7YgKi9cclxuICAgIEBJbnB1dCgpIGJlZm9yZU9wZW46ICgpID0+IE9ic2VydmFibGU8Ym9vbGVhbj47XHJcbiAgICAvKiog56qX5Y+j5YWz6Zet5YmN5LqL5Lu2ICovXHJcbiAgICBASW5wdXQoKSBiZWZvcmVDbG9zZTogKCkgPT4gT2JzZXJ2YWJsZTxib29sZWFuPjtcclxuICAgIC8qKiDluK7liqnliY3kuovku7YgKi9cclxuICAgIEBJbnB1dCgpIGRpY3RQaWNraW5nOiAoZW1wdHlPYmo/OiB7fSkgPT4gT2JzZXJ2YWJsZTxQaWNraW5nUmVzdWx0PjtcclxuICAgIGRpY3RQaWNraW5nU3Vic2NyaXB0aW9uOiBTdWJzY3JpcHRpb247XHJcbiAgICAvKiog5biu5Yqp5ZCO5LqL5Lu2ICovXHJcbiAgICBASW5wdXQoKSBkaWN0UGlja2VkOiAocm93RGF0YTogYW55KSA9PiBPYnNlcnZhYmxlPFBpY2tlZFJlc3VsdD47XHJcbiAgICBkaWN0UGlja2VkU3Vic2NyaXB0aW9uOiBTdWJzY3JpcHRpb247XHJcblxyXG4gICAgLyoqIOeql+WPo+aJk+W8gOWQjiAqL1xyXG4gICAgQE91dHB1dCgpIGRpYWxvZ09wZW5lZCA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcclxuICAgIC8qKiDnqpflj6PlhbPpl63lkI4gKi9cclxuICAgIEBPdXRwdXQoKSBkaWFsb2dDbG9zZWQgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XHJcbiAgICAvKiog56qX5Y+j5pyA5aSn5YyWICovXHJcbiAgICBAT3V0cHV0KCkgZGlhbG9nTWF4ZWQgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XHJcbiAgICAvKiog5ouW5ou95pS55Y+Y56qX5Y+j5bC65a+46L+b6KGM5pe2ICovXHJcbiAgICBAT3V0cHV0KCkgcmVzaXppbmcgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XHJcbiAgICAvKiog5ouW5ou95pS55Y+Y56qX5Y+j5bC65a+457uT5p2fICovXHJcbiAgICBAT3V0cHV0KCkgcmVzaXplZCA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcclxuICAgIC8qKiDluK7liqnnqpflj6Ppu5jorqTlsLrlr7ggKi9cclxuICAgIHByaXZhdGUgZGVmYXVsdERpYWxvZ1NpemUgPSB7IHdpZHRoOiA1NTAsIGhlaWdodDogNTcwIH07XHJcblxyXG4gICAgZGlhbG9nQ3JlYXRlZCA9IG5ldyBTdWJqZWN0PERpYWxvZ0NvbXBvbmVudD4oKTtcclxuICAgIGRpYWxvZ0NyZWF0ZWRTdWJzY3JpcHRpb246IFN1YnNjcmlwdGlvbjtcclxuICAgIGRpYWxvZzogRGlhbG9nQ29tcG9uZW50O1xyXG4gICAgQFZpZXdDaGlsZCgnZGlhbG9nJykgc2V0IGNvbnRlbnQoY29udGVudDogRGlhbG9nQ29tcG9uZW50KSB7XHJcbiAgICAgICAgaWYgKHRoaXMuZGlhbG9nICE9PSBjb250ZW50KSB7XHJcbiAgICAgICAgICAgIHRoaXMuZGlhbG9nID0gY29udGVudDtcclxuICAgICAgICAgICAgaWYgKGNvbnRlbnQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZGlhbG9nQ3JlYXRlZC5uZXh0KHRoaXMuZGlhbG9nKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIF9pc1Nob3cgPSBmYWxzZTtcclxuICAgIGdldCBpc1Nob3coKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2lzU2hvdztcclxuICAgIH1cclxuICAgIHNldCBpc1Nob3codmFsKSB7XHJcbiAgICAgICAgdGhpcy5faXNTaG93ID0gdmFsO1xyXG4gICAgICAgIGlmICghdGhpcy5jaGFuZ2VEZXRlY3RvclsnZGVzdHJveWVkJ10pIHtcclxuICAgICAgICAgICAgdGhpcy5jaGFuZ2VEZXRlY3Rvci5kZXRlY3RDaGFuZ2VzKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIG5nQ29udHJvbDogYW55O1xyXG5cclxuICAgIGRpc3BsYXlWYWx1ZSA9ICcnO1xyXG4gICAgb3JpZ2luYWxUZXh0ID0gJyc7XHJcblxyXG4gICAgZ2V0IGludmFsaWQoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMubmdDb250cm9sLnZhbGlkO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgbmdab25lOiBOZ1pvbmU7XHJcblxyXG4gICAgb25Nb2RlbENoYW5nZSA9IChvYmo6IGFueSkgPT4geyB9O1xyXG4gICAgb25Nb2RlbFRvdWNoZWQgPSAodmFsOiBhbnkpID0+IHsgfTtcclxuICAgIGNvbnN0cnVjdG9yKFxyXG4gICAgICAgIHB1YmxpYyBpbmplY3RvcjogSW5qZWN0b3IsXHJcbiAgICAgICAgcHVibGljIGVsOiBFbGVtZW50UmVmLFxyXG4gICAgICAgIHB1YmxpYyBjaGFuZ2VEZXRlY3Rvcj86IENoYW5nZURldGVjdG9yUmVmXHJcbiAgICApIHtcclxuICAgICAgICB0aGlzLm5nWm9uZSA9IHRoaXMuaW5qZWN0b3IuZ2V0KE5nWm9uZSk7XHJcbiAgICAgICAgLy8gaWYgKCF0aGlzLnBlcnNvbmFsQ29uZmlnU2VydmljZSkge1xyXG4gICAgICAgIC8vICAgICBjb25zdCBpZFNlcnYgPSB0aGlzLmluamVjdG9yLmdldChJZFNlcnZpY2UpO1xyXG4gICAgICAgIC8vICAgICB0aGlzLnBlcnNvbmFsQ29uZmlnU2VydmljZSA9IG5ldyBQZXJzb25hbENvbmZpZ1NlcnZpY2UoaWRTZXJ2KTtcclxuICAgICAgICAvLyB9XHJcbiAgICB9XHJcblxyXG4gICAgbmdPbkluaXQoKTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy5pbml0RXZlbnRzKCk7XHJcbiAgICAgICAgdGhpcy5uZ0NvbnRyb2wgPSB0aGlzLmluamVjdG9yLmdldChOZ0NvbnRyb2wsIG51bGwpO1xyXG4gICAgfVxyXG5cclxuICAgIG5nT25EZXN0cm95KCkge1xyXG4gICAgICAgIHRoaXMubG9va3VwVW5zdWJzY3JpYmUoKTtcclxuICAgIH1cclxuXHJcbiAgICBuZ0FmdGVyVmlld0NoZWNrZWQoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuZGlhbG9nKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZGlhbG9nLmNsb3NlZC5zdWJzY3JpYmUoKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5pc1Nob3cgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIHRoaXMuZGlhbG9nID0gbnVsbDtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGluaXRFdmVudHMoKSB7XHJcbiAgICAgICAgaWYgKCF0aGlzLmRpY3RQaWNraW5nKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZGljdFBpY2tpbmcgPSAoKSA9PiBvZih7IHNob3dEaWFsb2c6IHRydWUgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICghdGhpcy5kaWN0UGlja2VkKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZGljdFBpY2tlZCA9ICgpID0+IG9mKHsgY2xvc2VEaWFsb2c6IHRydWUgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICghdGhpcy5iZWZvcmVPcGVuKSB7XHJcbiAgICAgICAgICAgIHRoaXMuYmVmb3JlT3BlbiA9ICgpID0+IG9mKHRydWUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoIXRoaXMuYmVmb3JlQ2xvc2UpIHtcclxuICAgICAgICAgICAgdGhpcy5iZWZvcmVDbG9zZSA9ICgpID0+IG9mKHRydWUpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKCF0aGlzLmRpYWxvZ0hlaWdodCkge1xyXG4gICAgICAgICAgICB0aGlzLmRpYWxvZ0hlaWdodCA9IHRoaXMuZGVmYXVsdERpYWxvZ1NpemUuaGVpZ2h0O1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKCF0aGlzLmRpYWxvZ1dpZHRoKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZGlhbG9nV2lkdGggPSB0aGlzLmRlZmF1bHREaWFsb2dTaXplLndpZHRoO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBzaG93RGlhbG9nKCk6IGFueSB7XHJcbiAgICAgICAgaWYgKHRoaXMuZGlzYWJsZWQgfHwgdGhpcy5yZWFkb25seSkge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuZGljdFBpY2tpbmcoKS5zdWJzY3JpYmUoKHZhbDogUGlja2luZ1Jlc3VsdCkgPT4ge1xyXG4gICAgICAgICAgICBpZiAodmFsLnNob3dEaWFsb2cgPT09IGZhbHNlKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHRoaXMuaXNTaG93ID0gdHJ1ZTtcclxuICAgICAgICAgICAgLy8gdGhpcy5jaGFuZ2VEZXRlY3Rvci5kZXRlY3RDaGFuZ2VzKCk7XHJcbiAgICAgICAgICAgIHRoaXMubmdab25lLnJ1bk91dHNpZGVBbmd1bGFyKCgpID0+IHtcclxuICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gdGhpcy5kaWFsb2cuc2hvdygpKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuXHJcbiAgICBjbG9zZURpYWxvZygpIHtcclxuICAgICAgICB0aGlzLmlzU2hvdyA9IGZhbHNlO1xyXG4gICAgICAgIGlmICh0aGlzLmRpYWxvZykge1xyXG4gICAgICAgICAgICB0aGlzLmRpYWxvZy5jbG9zZSgpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcblxyXG4gICAgcHJpdmF0ZSBsb29rdXBVbnN1YnNjcmliZSgpIHtcclxuICAgICAgICBpZiAodGhpcy5kaWN0UGlja2VkU3Vic2NyaXB0aW9uKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZGljdFBpY2tlZFN1YnNjcmlwdGlvbi51bnN1YnNjcmliZSgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy5kaWN0UGlja2luZ1N1YnNjcmlwdGlvbikge1xyXG4gICAgICAgICAgICB0aGlzLmRpY3RQaWNraW5nU3Vic2NyaXB0aW9uLnVuc3Vic2NyaWJlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLmRpYWxvZ0NyZWF0ZWRTdWJzY3JpcHRpb24pIHtcclxuICAgICAgICAgICAgdGhpcy5kaWFsb2dDcmVhdGVkU3Vic2NyaXB0aW9uLnVuc3Vic2NyaWJlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIG9uUmVzaXppbmcocG9zOiBJUmVzaXplRXZlbnQpIHtcclxuICAgICAgICB0aGlzLnJlc2l6aW5nLmVtaXQocG9zLnNpemUpO1xyXG4gICAgfVxyXG4gICAgb25SZXNpemVkKHBvczogSVJlc2l6ZUV2ZW50KSB7XHJcbiAgICAgICAgdGhpcy5yZXNpemVkLmVtaXQocG9zLnNpemUpO1xyXG4gICAgfVxyXG4gICAgb25NYXhEaWFsb2cocG9zOiBJUmVzaXplRXZlbnQpIHtcclxuICAgICAgICB0aGlzLmRpYWxvZ01heGVkLmVtaXQocG9zLnNpemUpO1xyXG4gICAgfVxyXG5cclxuICAgIHdyaXRlVmFsdWUob2JqOiBhbnkpOiB2b2lkIHtcclxuICAgICAgICBpZiAob2JqKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZGlzcGxheVRleHQgPSBvYmo7XHJcbiAgICAgICAgICAgIHRoaXMuZGlzcGxheVZhbHVlID0gb2JqO1xyXG4gICAgICAgICAgICB0aGlzLm9yaWdpbmFsVGV4dCA9IHRoaXMuZGlzcGxheVRleHQ7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5kaXNwbGF5VGV4dCA9ICcnO1xyXG4gICAgICAgICAgICB0aGlzLmRpc3BsYXlWYWx1ZSA9ICcnO1xyXG4gICAgICAgICAgICB0aGlzLm9yaWdpbmFsVGV4dCA9ICcnO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJlZ2lzdGVyT25DaGFuZ2UoZm46IGFueSk6IHZvaWQge1xyXG4gICAgICAgIHRoaXMub25Nb2RlbENoYW5nZSA9IGZuO1xyXG4gICAgfVxyXG4gICAgcmVnaXN0ZXJPblRvdWNoZWQoZm46IGFueSk6IHZvaWQge1xyXG4gICAgICAgIHRoaXMub25Nb2RlbFRvdWNoZWQgPSBmbjtcclxuICAgIH1cclxuICAgIHNldERpc2FibGVkU3RhdGU/KGlzRGlzYWJsZWQ6IGJvb2xlYW4pOiB2b2lkIHtcclxuICAgICAgICB0aGlzLmRpc2FibGVkID0gaXNEaXNhYmxlZDtcclxuICAgIH1cclxufVxyXG4iXX0=