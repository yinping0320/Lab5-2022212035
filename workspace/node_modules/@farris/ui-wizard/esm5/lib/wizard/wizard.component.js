/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, Directive, TemplateRef, ContentChild, Input, ViewChild, HostBinding, Output, EventEmitter } from '@angular/core';
import { WizardService } from '../service/wizard.service';
// import { PagesetConfig } from './pageset.config';
import { WizardEventType } from '../model/wizard.model';
var WizardHeaderTemplateDirective = /** @class */ (function () {
    function WizardHeaderTemplateDirective(template) {
        this.template = template;
    }
    WizardHeaderTemplateDirective.decorators = [
        { type: Directive, args: [{
                    selector: '[wizardHeader]'
                },] }
    ];
    /** @nocollapse */
    WizardHeaderTemplateDirective.ctorParameters = function () { return [
        { type: TemplateRef }
    ]; };
    return WizardHeaderTemplateDirective;
}());
export { WizardHeaderTemplateDirective };
if (false) {
    /** @type {?} */
    WizardHeaderTemplateDirective.prototype.template;
}
var WizardStepTemplateDirective = /** @class */ (function () {
    function WizardStepTemplateDirective(template) {
        this.template = template;
    }
    WizardStepTemplateDirective.decorators = [
        { type: Directive, args: [{
                    selector: '[wizardStep]'
                },] }
    ];
    /** @nocollapse */
    WizardStepTemplateDirective.ctorParameters = function () { return [
        { type: TemplateRef }
    ]; };
    return WizardStepTemplateDirective;
}());
export { WizardStepTemplateDirective };
if (false) {
    /** @type {?} */
    WizardStepTemplateDirective.prototype.template;
}
var WizardComponent = /** @class */ (function () {
    function WizardComponent(wizardSer) {
        this.wizardSer = wizardSer;
        /**
         * 步骤条是否可以点击
         */
        this.stepClickable = false;
        // 向导容器自定义样式
        this.stepCls = '';
        /**
         * 步骤条排列方向
         */
        this.direction = 'vertical';
        /**
         * 步骤条摆放位置
         * Top 最顶部
         * HeaderRight 标题右侧
         * PageLeft 页面左侧
         *
         */
        this.stepPosition = 'None';
        this.basicClass = true;
        // @ViewChild('wizardContent') wizardContent: ElementRef;
        // @ViewChild('wizardHeader') wizardHeader: ElementRef;
        //@ViewChild('wizardStep') wizardStep:ElementRef;
        /**
         * 是否撑开
         */
        this.fill = true;
        this.storedIndex = false;
        this.storedIndexState = false;
        this._currentPageId = '';
        // 页面存储列表
        this.pages = [];
        //当前步骤条active状态的索引
        this.currentProgressIndex = 0;
        //默认步骤条
        this.defaultProgressData = {
            activeIndex: 0,
            stepMessages: []
        };
        // 结束向导；传递pageid
        this.stateChange = new EventEmitter();
        //------------------------------------------------问题：未有引用；不能这样写
        // Object.assign(this, { type: 'pages' });
        this.wizardState = this.wizardSer.getWizardState();
    }
    Object.defineProperty(WizardComponent.prototype, "wizardFill", {
        // /**步骤条宽度 */
        // @Input('step-width') stepWidth:number;
        get: 
        // /**步骤条宽度 */
        // @Input('step-width') stepWidth:number;
        /**
         * @return {?}
         */
        function () {
            return this.fill;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(WizardComponent.prototype, "currentPageId", {
        /**
         * 当前展示page的pageid名
         *  ---------------------------------问题： 可能出现问题currentProgressIndex与currentPageId不是一个
         * */
        get: /**
         * 当前展示page的pageid名
         *  ---------------------------------问题： 可能出现问题currentProgressIndex与currentPageId不是一个
         *
         * @return {?}
         */
        function () {
            return this._currentPageId;
        },
        set: /**
         * @param {?} pageid
         * @return {?}
         */
        function (pageid) {
            //console.log('当前页面ActiveID' + pageid);
            // 如果当前页与设置页是同一个页一样
            if (pageid && this._currentPageId == pageid) {
                return;
            }
            this.setActivePage(pageid);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(WizardComponent.prototype, "progressData", {
        get: /**
         * @return {?}
         */
        function () {
            return this.tProgressData;
        },
        set: /**
         * @param {?} progressData
         * @return {?}
         */
        function (progressData) {
            var _this = this;
            setTimeout((/**
             * @return {?}
             */
            function () {
                if (!progressData) {
                    return;
                }
                if (progressData && progressData.stepMessages && progressData.stepMessages.length) {
                    if (progressData.activeIndex && progressData.activeIndex >= 0) {
                        if (progressData.activeIndex > progressData.stepMessages.length) {
                            progressData.activeIndex = 0;
                        }
                        /** @type {?} */
                        var cachedStep = progressData.stepMessages[progressData.activeIndex];
                        if (cachedStep) {
                            _this.cachedPageId = cachedStep['id'];
                        }
                    }
                    else {
                        _this.cachedPageId = progressData.stepMessages[0]['id'];
                    }
                }
                // console.log(this.cachedPageId);
                _this.tProgressData = progressData;
                _this.doAfterProgressData();
            }));
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(WizardComponent.prototype, "subStepData", {
        get: /**
         * @return {?}
         */
        function () {
            return this._subStepData;
        },
        set: /**
         * @param {?} value
         * @return {?}
         */
        function (value) {
            this._subStepData = value;
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    WizardComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this.wizardState.subscribe((/**
         * @param {?} data
         * @return {?}
         */
        function (data) {
            _this.changeWizardState(data);
        }));
        this.wizardSer.updatePageFill(this.fill);
        //改变向导显示步骤
        this.wizardSer.changeActiveIndex.subscribe((/**
         * @param {?} num
         * @return {?}
         */
        function (num) {
            /** @type {?} */
            var activeNum = (num >= 0 && num < _this.progressData.stepMessages.length) ? num : 0;
            _this.progressData = Object.assign({}, _this.progressData, {
                activeIndex: activeNum
            });
        }));
    };
    /**
     * 子元素已经被加载
     */
    /**
     * 子元素已经被加载
     * @return {?}
     */
    WizardComponent.prototype.ngAfterContentInit = /**
     * 子元素已经被加载
     * @return {?}
     */
    function () {
        var _this = this;
        setTimeout((/**
         * @return {?}
         */
        function () {
            if (_this.stepPosition === 'None') {
                if (_this.pages.length) {
                    _this.pages.forEach((/**
                     * @param {?} page
                     * @return {?}
                     */
                    function (page) {
                        if (_this.defaultProgressData.stepMessages.find((/**
                         * @param {?} item
                         * @return {?}
                         */
                        function (item) {
                            return item.id === page.pageId;
                        }))) {
                            return false;
                        }
                        /** @type {?} */
                        var step = {
                            id: page.pageId
                        };
                        _this.defaultProgressData.stepMessages.push(step);
                    }));
                    if (_this.currentPageId) {
                        /** @type {?} */
                        var stepIndex = _this.defaultProgressData.stepMessages.findIndex((/**
                         * @param {?} item
                         * @return {?}
                         */
                        function (item) {
                            return item.id === _this.currentPageId;
                        }));
                        if (stepIndex >= 0) {
                            _this.defaultProgressData.activeIndex = stepIndex;
                        }
                    }
                }
                _this.tProgressData = _this.defaultProgressData;
                _this.doAfterProgressData();
            }
            else {
                // 执行初始化
                _this.setActivePage(_this.currentPageId);
                _this.setProgressDataDisable(_this.currentProgressIndex);
            }
        }));
    };
    /**
     *
     * @param state  WizardEvent Finish,Cancel,Prev,Next
     * @param fromPageId
     * @param toPageId
     */
    /**
     *
     * @param {?} data
     * @return {?}
     */
    WizardComponent.prototype.changeWizardState = /**
     *
     * @param {?} data
     * @return {?}
     */
    function (data) {
        switch (data.state) {
            case WizardEventType.Prev:
                // 向导向前
                this.progressStep.prevStep();
                this.currentPageId = data.toPageId;
                break;
            case WizardEventType.Next:
                // 向导向后
                this.progressStep.nextStep();
                this.currentPageId = data.toPageId;
                this.cachedPageId = data.toPageId;
                break;
            case WizardEventType.StepChange:
                this.progressStep.goStep(this.wizardSer.getIndexByPageId(data.toPageId));
                this.currentPageId = data.toPageId;
                break;
            //default:
            //this.wizardStateChange.emit(data);
        }
        this.currentProgressIndex = this.progressStep.getCurrentStepIndex();
        this.setProgressDataDisable(this.currentProgressIndex);
        this.stateChange.emit(data);
    };
    /**
     * 添加Page组件
     * @param page
     */
    /**
     * 添加Page组件
     * @param {?} page
     * @return {?}
     */
    WizardComponent.prototype.addPage = /**
     * 添加Page组件
     * @param {?} page
     * @return {?}
     */
    function (page) {
        this.pages.push(page);
        //----------------------------------------问题：此时pageid还没有值，设置当前active，统一在ngAfterViewInit
        // if (this.currentPageId) {
        //     page.active = this.currentPageId === page.pageid;
        // } else {
        //     page.active = this.pages.length === 1;
        // }
    };
    /**
     * 点击step步骤条事件
     */
    /**
     * 点击step步骤条事件
     * @param {?} event
     * @return {?}
     */
    WizardComponent.prototype.stepClick = /**
     * 点击step步骤条事件
     * @param {?} event
     * @return {?}
     */
    function (event) {
        if (event.step.clickDisable || this._currentPageId == event.step['id']) {
            return;
        }
        this.wizardSer.updateWizardState(WizardEventType.StepChange, this._currentPageId, event.step['id']);
        //this.currentProgressIndex = event.index;
        //this.progressStep.goStep(event.index);
    };
    /**设置步骤条不可点击状态 */
    /**
     * 设置步骤条不可点击状态
     * @param {?} currentPageIndex
     * @return {?}
     */
    WizardComponent.prototype.setProgressDataDisable = /**
     * 设置步骤条不可点击状态
     * @param {?} currentPageIndex
     * @return {?}
     */
    function (currentPageIndex) {
        var _this = this;
        if (this.tProgressData && this.tProgressData.stepMessages && this.tProgressData.stepMessages.length) {
            if (this.cachedPageId) {
                this.cachedCurrentPageIndex = this.tProgressData.stepMessages.findIndex((/**
                 * @param {?} step
                 * @return {?}
                 */
                function (step) {
                    return step.id === _this.cachedPageId;
                }));
            }
            if (this.storedIndex && this.cachedCurrentPageIndex >= 0) {
                this.tProgressData.stepMessages.forEach((/**
                 * @param {?} step
                 * @param {?} i
                 * @return {?}
                 */
                function (step, i) {
                    if (i <= _this.cachedCurrentPageIndex) {
                        step.clickDisable = false;
                    }
                    else {
                        step.clickDisable = true;
                    }
                }));
            }
            else {
                this.tProgressData.stepMessages.forEach((/**
                 * @param {?} step
                 * @param {?} i
                 * @return {?}
                 */
                function (step, i) {
                    if (i <= currentPageIndex) {
                        step.clickDisable = false;
                    }
                    else {
                        step.clickDisable = true;
                    }
                }));
            }
            this.wizardSer.updateProgressData(this.tProgressData);
        }
    };
    /**
     * 设置当前显示page
     */
    /**
     * 设置当前显示page
     * @private
     * @param {?=} pageid
     * @return {?}
     */
    WizardComponent.prototype.setActivePage = /**
     * 设置当前显示page
     * @private
     * @param {?=} pageid
     * @return {?}
     */
    function (pageid) {
        if (this.pages[0] && !this.pages[0].getPageId()) {
            this._currentPageId = pageid;
            // if(!this.cachedPageId){
            //     this.cachedPageId = this.pages[0].getPageId();
            // }
            return;
        }
        if (this.pages && this.pages.length) {
            if (!pageid) {
                this.pages.forEach((/**
                 * @param {?} page
                 * @return {?}
                 */
                function (page) {
                    page.setPageActive(false);
                }));
                this.pages[0].setPageActive(true);
                this._currentPageId = this.pages[0].getPageId();
            }
            else {
                this.pages.forEach((/**
                 * @param {?} page
                 * @return {?}
                 */
                function (page) {
                    if (page.getPageId() === pageid) {
                        page.setPageActive(true);
                    }
                    else {
                        page.setPageActive(false);
                    }
                }));
                this._currentPageId = pageid;
            }
        }
        this.wizardSer.updateCurrentPageId(this._currentPageId);
    };
    /**
     * 返回class
     */
    /**
     * 返回class
     * @return {?}
     */
    WizardComponent.prototype.getWizardPositionClass = /**
     * 返回class
     * @return {?}
     */
    function () {
        /** @type {?} */
        var className = '';
        switch (this.stepPosition) {
            case 'Top':
                className = 'f-component-wizard-step-top';
                break;
            case 'HeaderRight':
                className = 'f-component-wizard-step-headerright';
                break;
            case 'PageLeft':
                className = 'f-component-wizard-step-pageleft';
                break;
            case "None":
                className = 'f-component-wizard-step-none';
                break;
            default:
                className = '';
        }
        return className;
    };
    /**
     * 判断位置
     * @param value
     */
    /**
     * 判断位置
     * @param {?} value
     * @return {?}
     */
    WizardComponent.prototype.isWizardPosition = /**
     * 判断位置
     * @param {?} value
     * @return {?}
     */
    function (value) {
        return this.stepPosition == value;
    };
    /** 步骤条信息修改后，调整页面显示信息*/
    /**
     * 步骤条信息修改后，调整页面显示信息
     * @return {?}
     */
    WizardComponent.prototype.doAfterProgressData = /**
     * 步骤条信息修改后，调整页面显示信息
     * @return {?}
     */
    function () {
        this.wizardSer.updateProgressData(this.tProgressData);
        if (this.tProgressData) {
            /** @type {?} */
            var activeIndex = this.tProgressData.activeIndex ? this.tProgressData.activeIndex : 0;
            this.currentProgressIndex = (activeIndex >= 0 && activeIndex < this.tProgressData.stepMessages.length) ? activeIndex : 0;
            if (this.tProgressData.stepMessages && this.tProgressData.stepMessages.length) {
                this.setActivePage(this.tProgressData.stepMessages[this.currentProgressIndex].id);
            }
            this.setProgressDataDisable(this.currentProgressIndex);
        }
    };
    /**
     * @param {?} data
     * @return {?}
     */
    WizardComponent.prototype.setWizardData = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        this.wizardSer.setWizardData(data);
    };
    WizardComponent.decorators = [
        { type: Component, args: [{
                    selector: 'farris-wizard',
                    template: "<div class=\"f-wizard\" [ngClass]=\"getWizardPositionClass()\">\r\n    <ng-container *ngIf=\"isWizardPosition('Top')\">\r\n        <ng-container [ngTemplateOutlet]=\"wizardStepTemplate\"></ng-container>\r\n    </ng-container>\r\n    <ng-container *ngIf=\"isWizardPosition('None')\">\r\n        <div class=\"d-none\">\r\n            <ng-container [ngTemplateOutlet]=\"wizardStepTemplate\"></ng-container>\r\n        </div>\r\n    </ng-container>\r\n\r\n    <div class=\"f-wizard-header\" #wizardHeader *ngIf=\"HeaderTemplate || isWizardPosition('HeaderRight')\">\r\n        <ng-container [ngTemplateOutlet]=\"HeaderTemplate\"></ng-container>\r\n        <ng-container *ngIf=\"isWizardPosition('HeaderRight')\">\r\n            <ng-container\r\n                [ngTemplateOutlet]=\"wizardStepTemplate\"\r\n            ></ng-container>\r\n        </ng-container>\r\n    </div>\r\n\r\n    <div class=\"f-wizard-content\" #wizardContent>\r\n        <ng-container *ngIf=\"isWizardPosition('PageLeft')\">\r\n            <ng-container\r\n                [ngTemplateOutlet]=\"wizardStepTemplate\"\r\n            ></ng-container>\r\n        </ng-container>\r\n        <div class=\"f-wizard-pages\">\r\n            <ng-content select=\"wizard-page\"></ng-content>\r\n        </div>\r\n    </div>\r\n</div>\r\n<ng-template #wizardStepTemplate>\r\n    <div class=\"f-wizard-step\" [ngClass]=\"stepCls\">\r\n        <farris-progress-step\r\n            #progressStep\r\n            [stepData]=\"tProgressData\"\r\n            [direction]=\"direction\"\r\n            [subStepData]=\"subStepData\"\r\n            [storedIndexState]=\"storedIndexState\"\r\n            (stepClick)=\"stepClick($event)\"\r\n            [clickable]=\"stepClickable\"\r\n        >\r\n            <ng-container *ngIf=\"StepTemplate\">\r\n                <ng-template\r\n                    progressStepItem\r\n                    let-step=\"step\"\r\n                    let-i=\"index\"\r\n                    let-length=\"length\"\r\n                    let-activeIndex=\"activeIndex\"\r\n                    let-direction=\"direction\"\r\n                >\r\n                    <ng-container\r\n                        [ngTemplateOutlet]=\"StepTemplate\"\r\n                        [ngTemplateOutletContext]=\"{\r\n                            step: step,\r\n                            index: i,\r\n                            length: length,\r\n                            activeIndex: activeIndex,\r\n                            direction: direction\r\n                        }\"\r\n                    ></ng-container>\r\n                </ng-template>\r\n            </ng-container>\r\n        </farris-progress-step>\r\n    </div>\r\n</ng-template>\r\n",
                    styles: [":host.f-component-wizard{display:-webkit-box;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-direction:column;min-height:100px}:host.f-component-wizard.f-component-wizard-fill{-webkit-box-flex:1;flex-grow:1;flex-shrink:1;flex-basis:0;height:100%}:host.f-component-wizard.f-component-wizard-fill .f-wizard{-webkit-box-flex:1;flex-grow:1;flex-shrink:1;flex-basis:0;display:-webkit-box;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-direction:column;overflow-y:hidden}:host.f-component-wizard.f-component-wizard-fill .f-wizard .f-wizard-header{flex-shrink:0}:host.f-component-wizard.f-component-wizard-fill .f-wizard .f-wizard-content{-webkit-box-flex:1;flex-grow:1;flex-shrink:1;flex-basis:0;display:-webkit-box;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-direction:column;overflow:hidden}:host.f-component-wizard.f-component-wizard-fill .f-wizard .f-wizard-content .f-wizard-pages{-webkit-box-flex:1;flex-grow:1;flex-shrink:1;flex-basis:0;display:-webkit-box;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-direction:column;overflow:hidden}:host.f-component-wizard .f-wizard{position:relative}:host.f-component-wizard .f-wizard.f-component-wizard-step-pageleft .f-wizard-content{-webkit-box-orient:horizontal;-webkit-box-direction:normal;flex-direction:row}:host.f-component-wizard .f-wizard.f-component-wizard-step-pageleft .f-wizard-step{min-width:165px;padding:18px 24px;box-shadow:0 2px 4px 0 rgba(0,0,0,.1);overflow:auto}:host.f-component-wizard .f-wizard.f-component-wizard-step-headerright .f-wizard-header{display:-webkit-box;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;flex-direction:row;-webkit-box-align:center;align-items:center}:host.f-component-wizard .f-wizard.f-component-wizard-step-headerright .f-wizard-header .f-wizard-step{-webkit-box-flex:1;flex:1 1 auto;text-align:right}"]
                }] }
    ];
    /** @nocollapse */
    WizardComponent.ctorParameters = function () { return [
        { type: WizardService }
    ]; };
    WizardComponent.propDecorators = {
        stepClickable: [{ type: Input }],
        stepCls: [{ type: Input }],
        direction: [{ type: Input, args: ['stepDirection',] }],
        stepPosition: [{ type: Input, args: ['stepPosition',] }],
        wizardFill: [{ type: HostBinding, args: ['class.f-component-wizard-fill',] }],
        basicClass: [{ type: HostBinding, args: ['class.f-component-wizard',] }],
        HeaderTemplate: [{ type: ContentChild, args: [WizardHeaderTemplateDirective, { read: TemplateRef },] }],
        StepTemplate: [{ type: ContentChild, args: [WizardStepTemplateDirective, { read: TemplateRef },] }],
        progressStep: [{ type: ViewChild, args: ['progressStep',] }],
        fill: [{ type: Input }],
        storedIndex: [{ type: Input }],
        storedIndexState: [{ type: Input }],
        currentPageId: [{ type: Input }],
        progressData: [{ type: Input }],
        subStepData: [{ type: Input }],
        stateChange: [{ type: Output }]
    };
    return WizardComponent;
}());
export { WizardComponent };
if (false) {
    /**
     * 步骤条是否可以点击
     * @type {?}
     */
    WizardComponent.prototype.stepClickable;
    /** @type {?} */
    WizardComponent.prototype.stepCls;
    /**
     * 步骤条排列方向
     * @type {?}
     */
    WizardComponent.prototype.direction;
    /**
     * 步骤条摆放位置
     * Top 最顶部
     * HeaderRight 标题右侧
     * PageLeft 页面左侧
     *
     * @type {?}
     */
    WizardComponent.prototype.stepPosition;
    /** @type {?} */
    WizardComponent.prototype.basicClass;
    /** @type {?} */
    WizardComponent.prototype.HeaderTemplate;
    /** @type {?} */
    WizardComponent.prototype.StepTemplate;
    /** @type {?} */
    WizardComponent.prototype.progressStep;
    /**
     * 是否撑开
     * @type {?}
     */
    WizardComponent.prototype.fill;
    /** @type {?} */
    WizardComponent.prototype.storedIndex;
    /** @type {?} */
    WizardComponent.prototype.storedIndexState;
    /**
     * @type {?}
     * @private
     */
    WizardComponent.prototype._currentPageId;
    /**
     * @type {?}
     * @private
     */
    WizardComponent.prototype.cachedPageId;
    /**
     * @type {?}
     * @private
     */
    WizardComponent.prototype.cachedCurrentPageIndex;
    /**
     * 步骤条信息数据
     *
     *
     * @type {?}
     */
    WizardComponent.prototype.tProgressData;
    /** @type {?} */
    WizardComponent.prototype._subStepData;
    /** @type {?} */
    WizardComponent.prototype.pages;
    /** @type {?} */
    WizardComponent.prototype.currentProgressIndex;
    /** @type {?} */
    WizardComponent.prototype.defaultProgressData;
    /** @type {?} */
    WizardComponent.prototype.stateChange;
    /**
     * @type {?}
     * @private
     */
    WizardComponent.prototype.wizardState;
    /**
     * @type {?}
     * @private
     */
    WizardComponent.prototype.wizardSer;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoid2l6YXJkLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BmYXJyaXMvdWktd2l6YXJkLyIsInNvdXJjZXMiOlsibGliL3dpemFyZC93aXphcmQuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7QUFBQSxPQUFPLEVBQ0gsU0FBUyxFQUVULFNBQVMsRUFDVCxXQUFXLEVBQ1gsWUFBWSxFQUNaLEtBQUssRUFDTCxTQUFTLEVBQ1QsV0FBVyxFQUNYLE1BQU0sRUFDTixZQUFZLEVBRWYsTUFBTSxlQUFlLENBQUM7QUFDdkIsT0FBTyxFQUFFLGFBQWEsRUFBRSxNQUFNLDJCQUEyQixDQUFDOztBQUkxRCxPQUFPLEVBQWUsZUFBZSxFQUFFLE1BQU0sdUJBQXVCLENBQUM7QUFFckU7SUFJSSx1Q0FBbUIsUUFBMEI7UUFBMUIsYUFBUSxHQUFSLFFBQVEsQ0FBa0I7SUFBRyxDQUFDOztnQkFKcEQsU0FBUyxTQUFDO29CQUNQLFFBQVEsRUFBRSxnQkFBZ0I7aUJBQzdCOzs7O2dCQWpCRyxXQUFXOztJQW9CZixvQ0FBQztDQUFBLEFBTEQsSUFLQztTQUZZLDZCQUE2Qjs7O0lBQzFCLGlEQUFpQzs7QUFHakQ7SUFJSSxxQ0FBbUIsUUFBMEI7UUFBMUIsYUFBUSxHQUFSLFFBQVEsQ0FBa0I7SUFBRyxDQUFDOztnQkFKcEQsU0FBUyxTQUFDO29CQUNQLFFBQVEsRUFBRSxjQUFjO2lCQUMzQjs7OztnQkF4QkcsV0FBVzs7SUEyQmYsa0NBQUM7Q0FBQSxBQUxELElBS0M7U0FGWSwyQkFBMkI7OztJQUN4QiwrQ0FBaUM7O0FBR2pEO0lBdUhJLHlCQUFvQixTQUF3QjtRQUF4QixjQUFTLEdBQVQsU0FBUyxDQUFlOzs7O1FBaEhuQyxrQkFBYSxHQUFZLEtBQUssQ0FBQzs7UUFFL0IsWUFBTyxHQUFDLEVBQUUsQ0FBQzs7OztRQUVJLGNBQVMsR0FBRyxVQUFVLENBQUM7Ozs7Ozs7O1FBTXhCLGlCQUFZLEdBQUcsTUFBTSxDQUFDO1FBUUosZUFBVSxH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Qzs7SUFFeEMsa0NBQW9COzs7OztJQUVwQixvQ0FBK0M7Ozs7Ozs7OztJQU0vQyx1Q0FBNkM7O0lBUTdDLHFDQUEyRDs7SUFFM0QseUNBQ2lDOztJQUNqQyx1Q0FDK0I7O0lBRS9CLHVDQUF3Qzs7Ozs7SUFNeEMsK0JBQThCOztJQUM5QixzQ0FBcUM7O0lBQ3JDLDJDQUEwQzs7Ozs7SUFFMUMseUNBQTRCOzs7OztJQUM1Qix1Q0FBNEI7Ozs7O0lBRTVCLGlEQUFzQzs7Ozs7OztJQXVCdEMsd0NBQWM7O0lBMkJkLHVDQUFhOztJQVViLGdDQUF3Qzs7SUFFeEMsK0NBQWlDOztJQUVqQyw4Q0FHQzs7SUFHRCxzQ0FBd0Q7Ozs7O0lBRXhELHNDQUEwQzs7Ozs7SUFFOUIsb0NBQWdDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcclxuICAgIENvbXBvbmVudCxcclxuICAgIE9uSW5pdCxcclxuICAgIERpcmVjdGl2ZSxcclxuICAgIFRlbXBsYXRlUmVmLFxyXG4gICAgQ29udGVudENoaWxkLFxyXG4gICAgSW5wdXQsXHJcbiAgICBWaWV3Q2hpbGQsXHJcbiAgICBIb3N0QmluZGluZyxcclxuICAgIE91dHB1dCxcclxuICAgIEV2ZW50RW1pdHRlcixcclxuICAgIEFmdGVyQ29udGVudEluaXRcclxufSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgV2l6YXJkU2VydmljZSB9IGZyb20gJy4uL3NlcnZpY2Uvd2l6YXJkLnNlcnZpY2UnO1xyXG5pbXBvcnQgeyBGYXJyaXNXaXphcmRQYWdlQ29tcG9uZW50IH0gZnJvbSAnLi4vcGFnZS9wYWdlLmNvbXBvbmVudCc7XHJcbmltcG9ydCB7IFN1YmplY3QgfSBmcm9tICdyeGpzJztcclxuLy8gaW1wb3J0IHsgUGFnZXNldENvbmZpZyB9IGZyb20gJy4vcGFnZXNldC5jb25maWcnO1xyXG5pbXBvcnQgeyBXaXphcmRFdmVudCwgV2l6YXJkRXZlbnRUeXBlIH0gZnJvbSAnLi4vbW9kZWwvd2l6YXJkLm1vZGVsJztcclxuXHJcbkBEaXJlY3RpdmUoe1xyXG4gICAgc2VsZWN0b3I6ICdbd2l6YXJkSGVhZGVyXSdcclxufSlcclxuZXhwb3J0IGNsYXNzIFdpemFyZEhlYWRlclRlbXBsYXRlRGlyZWN0aXZlIHtcclxuICAgIGNvbnN0cnVjdG9yKHB1YmxpYyB0ZW1wbGF0ZTogVGVtcGxhdGVSZWY8YW55Pikge31cclxufVxyXG5cclxuQERpcmVjdGl2ZSh7XHJcbiAgICBzZWxlY3RvcjogJ1t3aXphcmRTdGVwXSdcclxufSlcclxuZXhwb3J0IGNsYXNzIFdpemFyZFN0ZXBUZW1wbGF0ZURpcmVjdGl2ZSB7XHJcbiAgICBjb25zdHJ1Y3RvcihwdWJsaWMgdGVtcGxhdGU6IFRlbXBsYXRlUmVmPGFueT4pIHt9XHJcbn1cclxuXHJcbkBDb21wb25lbnQoe1xyXG4gICAgc2VsZWN0b3I6ICdmYXJyaXMtd2l6YXJkJyxcclxuICAgIHRlbXBsYXRlVXJsOiAnLi93aXphcmQuY29tcG9uZW50Lmh0bWwnLFxyXG4gICAgc3R5bGVVcmxzOiBbJy4vd2l6YXJkLmNvbXBvbmVudC5zY3NzJ11cclxufSlcclxuZXhwb3J0IGNsYXNzIFdpemFyZENvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCwgQWZ0ZXJDb250ZW50SW5pdCB7XHJcbiAgICAvKirmraXpqqTmnaHmmK/lkKblj6/ku6Xngrnlh7sgKi9cclxuICAgIEBJbnB1dCgpIHN0ZXBDbGlja2FibGU6IGJvb2xlYW4gPSBmYWxzZTtcclxuICAgIC8vIOWQkeWvvOWuueWZqOiHquWumuS5ieagt+W8j1xyXG4gICAgQElucHV0KCkgc3RlcENscz0nJztcclxuICAgIC8qKuatpemqpOadoeaOkuWIl+aWueWQkSAqL1xyXG4gICAgQElucHV0KCdzdGVwRGlyZWN0aW9uJykgZGlyZWN0aW9uID0gJ3ZlcnRpY2FsJztcclxuICAgIC8qKuatpemqpOadoeaRhuaUvuS9jee9rlxyXG4gICAgICogVG9wIOacgOmhtumDqFxyXG4gICAgICogSGVhZGVyUmlnaHQg5qCH6aKY5Y+z5L6nXHJcbiAgICAgKiBQYWdlTGVmdCDpobXpnaLlt6bkvqdcclxuICAgICAqKi9cclxuICAgIEBJbnB1dCgnc3RlcFBvc2l0aW9uJykgc3RlcFBvc2l0aW9uID0gJ05vbmUnO1xyXG5cclxuICAgIC8vIC8qKuatpemqpOadoeWuveW6piAqL1xyXG4gICAgLy8gQElucHV0KCdzdGVwLXdpZHRoJykgc3RlcFdpZHRoOm51bWJlcjtcclxuXHJcbiAgICBASG9zdEJpbmRpbmcoJ2NsYXNzLmYtY29tcG9uZW50LXdpemFyZC1maWxsJykgZ2V0IHdpemFyZEZpbGwoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZmlsbDtcclxuICAgIH1cclxuICAgIEBIb3N0QmluZGluZygnY2xhc3MuZi1jb21wb25lbnQtd2l6YXJkJykgYmFzaWNDbGFzcyA9IHRydWU7XHJcblxyXG4gICAgQENvbnRlbnRDaGlsZChXaXphcmRIZWFkZXJUZW1wbGF0ZURpcmVjdGl2ZSwgeyByZWFkOiBUZW1wbGF0ZVJlZiB9KVxyXG4gICAgSGVhZGVyVGVtcGxhdGU6IFRlbXBsYXRlUmVmPGFueT47XHJcbiAgICBAQ29udGVudENoaWxkKFdpemFyZFN0ZXBUZW1wbGF0ZURpcmVjdGl2ZSwgeyByZWFkOiBUZW1wbGF0ZVJlZiB9KVxyXG4gICAgU3RlcFRlbXBsYXRlOiBUZW1wbGF0ZVJlZjxhbnk+O1xyXG5cclxuICAgIEBWaWV3Q2hpbGQoJ3Byb2dyZXNzU3RlcCcpIHByb2dyZXNzU3RlcDtcclxuICAgIC8vIEBWaWV3Q2hpbGQoJ3dpemFyZENvbnRlbnQnKSB3aXphcmRDb250ZW50OiBFbGVtZW50UmVmO1xyXG4gICAgLy8gQFZpZXdDaGlsZCgnd2l6YXJkSGVhZGVyJykgd2l6YXJkSGVhZGVyOiBFbGVtZW50UmVmO1xyXG4gICAgLy9AVmlld0NoaWxkKCd3aXphcmRTdGVwJykgd2l6YXJkU3RlcDpFbGVtZW50UmVmO1xyXG5cclxuICAgIC8qKuaYr+WQpuaSkeW8gCAqL1xyXG4gICAgQElucHV0KCkgZmlsbDogYm9vbGVhbiA9IHRydWU7XHJcbiAgICBASW5wdXQoKSBzdG9yZWRJbmRleDpib29sZWFuID0gZmFsc2U7XHJcbiAgICBASW5wdXQoKSBzdG9yZWRJbmRleFN0YXRlOmJvb2xlYW4gPSBmYWxzZTtcclxuXHJcbiAgICBwcml2YXRlIF9jdXJyZW50UGFnZUlkID0gJyc7XHJcbiAgICBwcml2YXRlIGNhY2hlZFBhZ2VJZDpzdHJpbmc7XHJcbiAgICAvL+aYr+WQpuS/neaMgeW9k+WJjei/m+W6pueKtuaAgVxyXG4gICAgcHJpdmF0ZSBjYWNoZWRDdXJyZW50UGFnZUluZGV4Om51bWJlcjtcclxuICAgIC8qKlxyXG4gICAgICog5b2T5YmN5bGV56S6cGFnZeeahHBhZ2VpZOWQjVxyXG4gICAgICogIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLemXrumimO+8miDlj6/og73lh7rnjrDpl67pophjdXJyZW50UHJvZ3Jlc3NJbmRleOS4jmN1cnJlbnRQYWdlSWTkuI3mmK/kuIDkuKpcclxuICAgICAqICovXHJcbiAgICBASW5wdXQoKVxyXG4gICAgZ2V0IGN1cnJlbnRQYWdlSWQoKTogc3RyaW5nIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fY3VycmVudFBhZ2VJZDtcclxuICAgIH1cclxuICAgIHNldCBjdXJyZW50UGFnZUlkKHBhZ2VpZDogc3RyaW5nKSB7XHJcbiAgICAgICAgLy9jb25zb2xlLmxvZygn5b2T5YmN6aG16Z2iQWN0aXZlSUQnICsgcGFnZWlkKTtcclxuICAgICAgICAvLyDlpoLmnpzlvZPliY3pobXkuI7orr7nva7pobXmmK/lkIzkuIDkuKrpobXkuIDmoLdcclxuICAgICAgICBpZiAocGFnZWlkICYmIHRoaXMuX2N1cnJlbnRQYWdlSWQgPT0gcGFnZWlkKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuc2V0QWN0aXZlUGFnZShwYWdlaWQpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog5q2l6aqk5p2h5L+h5oGv5pWw5o2uXHJcbiAgICAgKlxyXG4gICAgICogICovXHJcbiAgICB0UHJvZ3Jlc3NEYXRhO1xyXG4gICAgQElucHV0KClcclxuICAgIHNldCBwcm9ncmVzc0RhdGEocHJvZ3Jlc3NEYXRhKSB7XHJcbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICAgIGlmKCFwcm9ncmVzc0RhdGEpIHtyZXR1cm47fVxyXG4gICAgICAgICAgICBpZihwcm9ncmVzc0RhdGEgJiYgcHJvZ3Jlc3NEYXRhLnN0ZXBNZXNzYWdlcyAmJiBwcm9ncmVzc0RhdGEuc3RlcE1lc3NhZ2VzLmxlbmd0aCl7XHJcbiAgICAgICAgICAgICAgICBpZihwcm9ncmVzc0RhdGEuYWN0aXZlSW5kZXggJiYgcHJvZ3Jlc3NEYXRhLmFjdGl2ZUluZGV4ID49IDApe1xyXG4gICAgICAgICAgICAgICAgICAgIGlmKHByb2dyZXNzRGF0YS5hY3RpdmVJbmRleCA+IHByb2dyZXNzRGF0YS5zdGVwTWVzc2FnZXMubGVuZ3RoKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcHJvZ3Jlc3NEYXRhLmFjdGl2ZUluZGV4ID0gMDtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgY2FjaGVkU3RlcCA9IHByb2dyZXNzRGF0YS5zdGVwTWVzc2FnZXNbcHJvZ3Jlc3NEYXRhLmFjdGl2ZUluZGV4XTtcclxuICAgICAgICAgICAgICAgICAgICBpZihjYWNoZWRTdGVwKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jYWNoZWRQYWdlSWQgPSBjYWNoZWRTdGVwWydpZCddO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2V7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jYWNoZWRQYWdlSWQgPSBwcm9ncmVzc0RhdGEuc3RlcE1lc3NhZ2VzWzBdWydpZCddO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKHRoaXMuY2FjaGVkUGFnZUlkKTtcclxuICAgICAgICAgICAgdGhpcy50UHJvZ3Jlc3NEYXRhID0gcHJvZ3Jlc3NEYXRhO1xyXG4gICAgICAgICAgICB0aGlzLmRvQWZ0ZXJQcm9ncmVzc0RhdGEoKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIGdldCBwcm9ncmVzc0RhdGEoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMudFByb2dyZXNzRGF0YTtcclxuICAgIH1cclxuICAgIF9zdWJTdGVwRGF0YTtcclxuICAgIEBJbnB1dCgpXHJcbiAgICBzZXQgc3ViU3RlcERhdGEodmFsdWUpe1xyXG4gICAgICAgIHRoaXMuX3N1YlN0ZXBEYXRhID0gdmFsdWU7XHJcbiAgICB9XHJcbiAgICBnZXQgc3ViU3RlcERhdGEoKXtcclxuICAgICAgICByZXR1cm4gdGhpcy5fc3ViU3RlcERhdGE7XHJcbiAgICB9XHJcblxyXG4gICAgLy8g6aG16Z2i5a2Y5YKo5YiX6KGoXHJcbiAgICBwYWdlczogRmFycmlzV2l6YXJkUGFnZUNvbXBvbmVudFtdID0gW107XHJcbiAgICAvL+W9k+WJjeatpemqpOadoWFjdGl2ZeeKtuaAgeeahOe0ouW8lVxyXG4gICAgY3VycmVudFByb2dyZXNzSW5kZXg6IG51bWJlciA9IDA7XHJcbiAgICAvL+m7mOiupOatpemqpOadoVxyXG4gICAgZGVmYXVsdFByb2dyZXNzRGF0YSA9IHtcclxuICAgICAgICBhY3RpdmVJbmRleDogMCxcclxuICAgICAgICBzdGVwTWVzc2FnZXM6W11cclxuICAgIH1cclxuXHJcbiAgICAvLyDnu5PmnZ/lkJHlr7zvvJvkvKDpgJJwYWdlaWRcclxuICAgIEBPdXRwdXQoKSBzdGF0ZUNoYW5nZSA9IG5ldyBFdmVudEVtaXR0ZXI8V2l6YXJkRXZlbnQ+KCk7XHJcblxyXG4gICAgcHJpdmF0ZSB3aXphcmRTdGF0ZTogU3ViamVjdDxXaXphcmRFdmVudD47XHJcblxyXG4gICAgY29uc3RydWN0b3IocHJpdmF0ZSB3aXphcmRTZXI6IFdpemFyZFNlcnZpY2UpIHtcclxuICAgICAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLemXrumimO+8muacquacieW8leeUqO+8m+S4jeiDvei/meagt+WGmVxyXG4gICAgICAgIC8vIE9iamVjdC5hc3NpZ24odGhpcywgeyB0eXBlOiAncGFnZXMnIH0pO1xyXG4gICAgICAgIHRoaXMud2l6YXJkU3RhdGUgPSB0aGlzLndpemFyZFNlci5nZXRXaXphcmRTdGF0ZSgpO1xyXG4gICAgfVxyXG5cclxuICAgIG5nT25Jbml0KCkge1xyXG4gICAgICAgIHRoaXMud2l6YXJkU3RhdGUuc3Vic2NyaWJlKChkYXRhOiBXaXphcmRFdmVudCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLmNoYW5nZVdpemFyZFN0YXRlKGRhdGEpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMud2l6YXJkU2VyLnVwZGF0ZVBhZ2VGaWxsKHRoaXMuZmlsbCk7XHJcbiAgICAgICAgLy/mlLnlj5jlkJHlr7zmmL7npLrmraXpqqRcclxuICAgICAgICB0aGlzLndpemFyZFNlci5jaGFuZ2VBY3RpdmVJbmRleC5zdWJzY3JpYmUoKG51bTpudW1iZXIpPT57XHJcbiAgICAgICAgICAgIGxldCBhY3RpdmVOdW06bnVtYmVyICA9IChudW0+PSAwICYmIG51bSA8IHRoaXMucHJvZ3Jlc3NEYXRhLnN0ZXBNZXNzYWdlcy5sZW5ndGgpPyBudW06IDBcclxuICAgICAgICAgICAgdGhpcy5wcm9ncmVzc0RhdGEgPSBPYmplY3QuYXNzaWduKHt9LCB0aGlzLnByb2dyZXNzRGF0YSwge1xyXG4gICAgICAgICAgICAgICAgICAgIGFjdGl2ZUluZGV4OiBhY3RpdmVOdW1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSlcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICog5a2Q5YWD57Sg5bey57uP6KKr5Yqg6L29XHJcbiAgICAgKi9cclxuICAgIG5nQWZ0ZXJDb250ZW50SW5pdCAoKSB7XHJcbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICAgIGlmKHRoaXMuc3RlcFBvc2l0aW9uID09PSAnTm9uZScpe1xyXG4gICAgICAgICAgICAgICAgaWYodGhpcy5wYWdlcy5sZW5ndGgpe1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGFnZXMuZm9yRWFjaChwYWdlPT57XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZih0aGlzLmRlZmF1bHRQcm9ncmVzc0RhdGEuc3RlcE1lc3NhZ2VzLmZpbmQoKGl0ZW0pPT57XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gaXRlbS5pZCA9PT0gcGFnZS5wYWdlSWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3RlcCA9IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkOiBwYWdlLnBhZ2VJZFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZGVmYXVsdFByb2dyZXNzRGF0YS5zdGVwTWVzc2FnZXMucHVzaChzdGVwKTtcclxuICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgIGlmKHRoaXMuY3VycmVudFBhZ2VJZCl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBzdGVwSW5kZXggPSB0aGlzLmRlZmF1bHRQcm9ncmVzc0RhdGEuc3RlcE1lc3NhZ2VzLmZpbmRJbmRleCgoaXRlbSk9PntcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBpdGVtLmlkID09PSB0aGlzLmN1cnJlbnRQYWdlSWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKHN0ZXBJbmRleD49MCl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRlZmF1bHRQcm9ncmVzc0RhdGEuYWN0aXZlSW5kZXggPSBzdGVwSW5kZXg7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0aGlzLnRQcm9ncmVzc0RhdGEgPSB0aGlzLmRlZmF1bHRQcm9ncmVzc0RhdGE7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmRvQWZ0ZXJQcm9ncmVzc0RhdGEoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNle1xyXG4gICAgICAgICAgICAgICAgLy8g5omn6KGM5Yid5aeL5YyWXHJcbiAgICAgICAgICAgICAgICB0aGlzLnNldEFjdGl2ZVBhZ2UodGhpcy5jdXJyZW50UGFnZUlkKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0UHJvZ3Jlc3NEYXRhRGlzYWJsZSh0aGlzLmN1cnJlbnRQcm9ncmVzc0luZGV4KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHN0YXRlICBXaXphcmRFdmVudCBGaW5pc2gsQ2FuY2VsLFByZXYsTmV4dFxyXG4gICAgICogQHBhcmFtIGZyb21QYWdlSWRcclxuICAgICAqIEBwYXJhbSB0b1BhZ2VJZFxyXG4gICAgICovXHJcbiAgICBjaGFuZ2VXaXphcmRTdGF0ZShkYXRhOiBXaXphcmRFdmVudCkge1xyXG4gICAgICAgIHN3aXRjaCAoZGF0YS5zdGF0ZSkge1xyXG4gICAgICAgICAgICBjYXNlIFdpemFyZEV2ZW50VHlwZS5QcmV2OlxyXG4gICAgICAgICAgICAgICAgLy8g5ZCR5a+85ZCR5YmNXHJcbiAgICAgICAgICAgICAgICB0aGlzLnByb2dyZXNzU3RlcC5wcmV2U3RlcCgpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50UGFnZUlkID0gZGF0YS50b1BhZ2VJZDtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIFdpemFyZEV2ZW50VHlwZS5OZXh0OlxyXG4gICAgICAgICAgICAgICAgLy8g5ZCR5a+85ZCR5ZCOXHJcbiAgICAgICAgICAgICAgICB0aGlzLnByb2dyZXNzU3RlcC5uZXh0U3RlcCgpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50UGFnZUlkID0gZGF0YS50b1BhZ2VJZDtcclxuICAgICAgICAgICAgICAgIHRoaXMuY2FjaGVkUGFnZUlkID0gZGF0YS50b1BhZ2VJZDtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIFdpemFyZEV2ZW50VHlwZS5TdGVwQ2hhbmdlOlxyXG4gICAgICAgICAgICAgICAgdGhpcy5wcm9ncmVzc1N0ZXAuZ29TdGVwKHRoaXMud2l6YXJkU2VyLmdldEluZGV4QnlQYWdlSWQoZGF0YS50b1BhZ2VJZCkpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50UGFnZUlkID0gZGF0YS50b1BhZ2VJZDtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAvL2RlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICAvL3RoaXMud2l6YXJkU3RhdGVDaGFuZ2UuZW1pdChkYXRhKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5jdXJyZW50UHJvZ3Jlc3NJbmRleCA9IHRoaXMucHJvZ3Jlc3NTdGVwLmdldEN1cnJlbnRTdGVwSW5kZXgoKTtcclxuICAgICAgICB0aGlzLnNldFByb2dyZXNzRGF0YURpc2FibGUodGhpcy5jdXJyZW50UHJvZ3Jlc3NJbmRleCk7XHJcbiAgICAgICAgdGhpcy5zdGF0ZUNoYW5nZS5lbWl0KGRhdGEpO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiDmt7vliqBQYWdl57uE5Lu2XHJcbiAgICAgKiBAcGFyYW0gcGFnZVxyXG4gICAgICovXHJcbiAgICBhZGRQYWdlKHBhZ2U6IEZhcnJpc1dpemFyZFBhZ2VDb21wb25lbnQpOiB2b2lkIHtcclxuICAgICAgICB0aGlzLnBhZ2VzLnB1c2gocGFnZSk7XHJcbiAgICAgICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t6Zeu6aKY77ya5q2k5pe2cGFnZWlk6L+Y5rKh5pyJ5YC877yM6K6+572u5b2T5YmNYWN0aXZl77yM57uf5LiA5ZyobmdBZnRlclZpZXdJbml0XHJcbiAgICAgICAgLy8gaWYgKHRoaXMuY3VycmVudFBhZ2VJZCkge1xyXG4gICAgICAgIC8vICAgICBwYWdlLmFjdGl2ZSA9IHRoaXMuY3VycmVudFBhZ2VJZCA9PT0gcGFnZS5wYWdlaWQ7XHJcbiAgICAgICAgLy8gfSBlbHNlIHtcclxuICAgICAgICAvLyAgICAgcGFnZS5hY3RpdmUgPSB0aGlzLnBhZ2VzLmxlbmd0aCA9PT0gMTtcclxuICAgICAgICAvLyB9XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIOeCueWHu3N0ZXDmraXpqqTmnaHkuovku7ZcclxuICAgICAqL1xyXG4gICAgc3RlcENsaWNrKGV2ZW50KSB7XHJcbiAgICAgICAgaWYoZXZlbnQuc3RlcC5jbGlja0Rpc2FibGUgfHwgdGhpcy5fY3VycmVudFBhZ2VJZCA9PSBldmVudC5zdGVwWydpZCddKXtyZXR1cm47fVxyXG4gICAgICAgIHRoaXMud2l6YXJkU2VyLnVwZGF0ZVdpemFyZFN0YXRlKFdpemFyZEV2ZW50VHlwZS5TdGVwQ2hhbmdlLCB0aGlzLl9jdXJyZW50UGFnZUlkLCBldmVudC5zdGVwWydpZCddKTtcclxuICAgICAgICAvL3RoaXMuY3VycmVudFByb2dyZXNzSW5kZXggPSBldmVudC5pbmRleDtcclxuICAgICAgICAvL3RoaXMucHJvZ3Jlc3NTdGVwLmdvU3RlcChldmVudC5pbmRleCk7XHJcbiAgICB9XHJcbiAgICAvKirorr7nva7mraXpqqTmnaHkuI3lj6/ngrnlh7vnirbmgIEgKi9cclxuICAgIHNldFByb2dyZXNzRGF0YURpc2FibGUoY3VycmVudFBhZ2VJbmRleCl7XHJcbiAgICAgICAgaWYodGhpcy50UHJvZ3Jlc3NEYXRhICYmIHRoaXMudFByb2dyZXNzRGF0YS5zdGVwTWVzc2FnZXMgJiYgdGhpcy50UHJvZ3Jlc3NEYXRhLnN0ZXBNZXNzYWdlcy5sZW5ndGgpe1xyXG4gICAgICAgICAgICBpZih0aGlzLmNhY2hlZFBhZ2VJZCl7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNhY2hlZEN1cnJlbnRQYWdlSW5kZXggPSB0aGlzLnRQcm9ncmVzc0RhdGEuc3RlcE1lc3NhZ2VzLmZpbmRJbmRleCgoc3RlcCk9PntcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gc3RlcC5pZCA9PT0gdGhpcy5jYWNoZWRQYWdlSWQ7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZih0aGlzLnN0b3JlZEluZGV4ICYmIHRoaXMuY2FjaGVkQ3VycmVudFBhZ2VJbmRleCA+PSAwKXtcclxuICAgICAgICAgICAgICAgIHRoaXMudFByb2dyZXNzRGF0YS5zdGVwTWVzc2FnZXMuZm9yRWFjaCgoc3RlcCxpKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYoaSA8PSB0aGlzLmNhY2hlZEN1cnJlbnRQYWdlSW5kZXgpe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzdGVwLmNsaWNrRGlzYWJsZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlbHNle1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzdGVwLmNsaWNrRGlzYWJsZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZXtcclxuICAgICAgICAgICAgICAgIHRoaXMudFByb2dyZXNzRGF0YS5zdGVwTWVzc2FnZXMuZm9yRWFjaCgoc3RlcCxpKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYoaSA8PSBjdXJyZW50UGFnZUluZGV4KXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc3RlcC5jbGlja0Rpc2FibGUgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc3RlcC5jbGlja0Rpc2FibGUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB0aGlzLndpemFyZFNlci51cGRhdGVQcm9ncmVzc0RhdGEodGhpcy50UHJvZ3Jlc3NEYXRhKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDorr7nva7lvZPliY3mmL7npLpwYWdlXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgc2V0QWN0aXZlUGFnZShwYWdlaWQ/OiBzdHJpbmcpIHtcclxuICAgICAgICBpZiAodGhpcy5wYWdlc1swXSAmJiAhdGhpcy5wYWdlc1swXS5nZXRQYWdlSWQoKSkge1xyXG4gICAgICAgICAgICB0aGlzLl9jdXJyZW50UGFnZUlkID0gcGFnZWlkO1xyXG4gICAgICAgICAgICAvLyBpZighdGhpcy5jYWNoZWRQYWdlSWQpe1xyXG4gICAgICAgICAgICAvLyAgICAgdGhpcy5jYWNoZWRQYWdlSWQgPSB0aGlzLnBhZ2VzWzBdLmdldFBhZ2VJZCgpO1xyXG4gICAgICAgICAgICAvLyB9XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYodGhpcy5wYWdlcyAmJiB0aGlzLnBhZ2VzLmxlbmd0aCl7XHJcbiAgICAgICAgICAgIGlmICghcGFnZWlkKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnBhZ2VzLmZvckVhY2goKHBhZ2U6IEZhcnJpc1dpemFyZFBhZ2VDb21wb25lbnQpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBwYWdlLnNldFBhZ2VBY3RpdmUoZmFsc2UpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnBhZ2VzWzBdLnNldFBhZ2VBY3RpdmUodHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9jdXJyZW50UGFnZUlkID0gdGhpcy5wYWdlc1swXS5nZXRQYWdlSWQoKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHRoaXMucGFnZXMuZm9yRWFjaCgocGFnZTogRmFycmlzV2l6YXJkUGFnZUNvbXBvbmVudCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChwYWdlLmdldFBhZ2VJZCgpID09PSBwYWdlaWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGFnZS5zZXRQYWdlQWN0aXZlKHRydWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhZ2Uuc2V0UGFnZUFjdGl2ZShmYWxzZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9jdXJyZW50UGFnZUlkID0gcGFnZWlkO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMud2l6YXJkU2VyLnVwZGF0ZUN1cnJlbnRQYWdlSWQodGhpcy5fY3VycmVudFBhZ2VJZCk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDov5Tlm55jbGFzc1xyXG4gICAgICovXHJcbiAgICBnZXRXaXphcmRQb3NpdGlvbkNsYXNzKCk6IHN0cmluZyB7XHJcbiAgICAgICAgbGV0IGNsYXNzTmFtZSA9ICcnO1xyXG4gICAgICAgIHN3aXRjaCAodGhpcy5zdGVwUG9zaXRpb24pIHtcclxuICAgICAgICAgICAgY2FzZSAnVG9wJzpcclxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZSA9ICdmLWNvbXBvbmVudC13aXphcmQtc3RlcC10b3AnO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgJ0hlYWRlclJpZ2h0JzpcclxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZSA9ICdmLWNvbXBvbmVudC13aXphcmQtc3RlcC1oZWFkZXJyaWdodCc7XHJcblxyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgJ1BhZ2VMZWZ0JzpcclxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZSA9ICdmLWNvbXBvbmVudC13aXphcmQtc3RlcC1wYWdlbGVmdCc7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSBcIk5vbmVcIjpcclxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZSA9ICdmLWNvbXBvbmVudC13aXphcmQtc3RlcC1ub25lJztcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lID0gJyc7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBjbGFzc05hbWU7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIOWIpOaWreS9jee9rlxyXG4gICAgICogQHBhcmFtIHZhbHVlXHJcbiAgICAgKi9cclxuICAgIGlzV2l6YXJkUG9zaXRpb24odmFsdWUpOiBib29sZWFuIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5zdGVwUG9zaXRpb24gPT0gdmFsdWU7XHJcbiAgICB9XHJcbiAgICAvKiog5q2l6aqk5p2h5L+h5oGv5L+u5pS55ZCO77yM6LCD5pW06aG16Z2i5pi+56S65L+h5oGvKi9cclxuICAgIGRvQWZ0ZXJQcm9ncmVzc0RhdGEoKXtcclxuICAgICAgICB0aGlzLndpemFyZFNlci51cGRhdGVQcm9ncmVzc0RhdGEodGhpcy50UHJvZ3Jlc3NEYXRhKTtcclxuICAgICAgICBpZih0aGlzLnRQcm9ncmVzc0RhdGEpe1xyXG4gICAgICAgICAgICBjb25zdCBhY3RpdmVJbmRleCA9IHRoaXMudFByb2dyZXNzRGF0YS5hY3RpdmVJbmRleD8gdGhpcy50UHJvZ3Jlc3NEYXRhLmFjdGl2ZUluZGV4IDogMDtcclxuICAgICAgICAgICAgdGhpcy5jdXJyZW50UHJvZ3Jlc3NJbmRleCA9IChhY3RpdmVJbmRleCA+PSAwICYmIGFjdGl2ZUluZGV4IDwgdGhpcy50UHJvZ3Jlc3NEYXRhLnN0ZXBNZXNzYWdlcy5sZW5ndGgpID8gYWN0aXZlSW5kZXg6IDA7XHJcbiAgICAgICAgICAgIGlmKHRoaXMudFByb2dyZXNzRGF0YS5zdGVwTWVzc2FnZXMmJnRoaXMudFByb2dyZXNzRGF0YS5zdGVwTWVzc2FnZXMubGVuZ3RoKXtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0QWN0aXZlUGFnZSh0aGlzLnRQcm9ncmVzc0RhdGEuc3RlcE1lc3NhZ2VzW3RoaXMuY3VycmVudFByb2dyZXNzSW5kZXhdLmlkKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLnNldFByb2dyZXNzRGF0YURpc2FibGUodGhpcy5jdXJyZW50UHJvZ3Jlc3NJbmRleCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHNldFdpemFyZERhdGEoZGF0YSl7XHJcbiAgICAgICAgdGhpcy53aXphcmRTZXIuc2V0V2l6YXJkRGF0YShkYXRhKTtcclxuICAgIH1cclxuXHJcbn1cclxuIl19