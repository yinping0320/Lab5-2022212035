/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
import { Component, Input, Output, EventEmitter, Renderer2, ElementRef, ViewChild, ViewEncapsulation, HostListener } from '@angular/core';
import { QuerySolutionService } from '@farris/ui-filter-condition';
import { deepCopy } from './utils';
import { IdService } from '@farris/ui-common';
import { cloneDeep } from 'lodash-es';
// 用于显示点击 简单筛选 项的下拉面板
var FilterPanelComponent = /** @class */ (function () {
    function FilterPanelComponent(renderer, elementRef, filterConditionSer) {
        this.renderer = renderer;
        this.elementRef = elementRef;
        this.filterConditionSer = filterConditionSer;
        this._hide = false;
        this.hidePanel = new EventEmitter();
        this.submit = new EventEmitter();
        this.filterSubmit = new EventEmitter();
        this.clearFilter = new EventEmitter();
        this.dataChange = new EventEmitter();
        this.canSubmit = false;
        this.fiexedLeft = true;
        // 全局标识，初始化标识元素没有发生mousemove
        this.hasMove = false;
        this._documentMouseUpEvent = null;
        this.currentItem = null;
        this.zIndex = 1060;
        this.isNil = (/**
         * @param {?} val
         * @return {?}
         */
        function (val) { return val === null || val === undefined || val === ''; });
        this.el = this.elementRef.nativeElement;
    }
    Object.defineProperty(FilterPanelComponent.prototype, "hide", {
        get: /**
         * @return {?}
         */
        function () {
            return this._hide;
        },
        set: /**
         * @param {?} val
         * @return {?}
         */
        function (val) {
            this._hide = val;
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    FilterPanelComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        /** @type {?} */
        var self = this;
        this._documentMouseUpEvent = this.renderer.listen(this.filterPanel.nativeElement, 'mouseup', (/**
         * @param {?} event
         * @return {?}
         */
        function (event) {
            event.stopPropagation();
            /** @type {?} */
            var tar = event.target;
            if (tar.closest('#mainContainerTabset')) {
                // self.hidePanel.emit(event);
                _this.panelFilterCancel(event);
                return;
            }
            if (_this.hasMove) {
                return;
            }
            if (!tar.closest('.f-filter-panel')
                && !tar.closest('.modal')
                && !tar.closest('.overlay-container') && !tar.closest('.overlay-pane')) {
                // self.hidePanel.emit(event);
                _this.panelFilterCancel(event);
            }
            _this.hasMove = false;
        }));
        if (this.option.item && (this.option.item.control.controltype == 'dropdown' || this.option.item.control.controltype == 'radio')) {
            this.canSubmit = true;
        }
        if (this.injector) {
            this.idService = this.injector.get(IdService);
        }
        this.currentItem = cloneDeep({ value: tslib_1.__assign({}, this.option.item.value), type: this.option.item.control.controltype, id: this.option.item.id });
    };
    /**
     * @return {?}
     */
    FilterPanelComponent.prototype.ngAfterViewInit = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var _panel = this.el.querySelector('.f-filter-panel');
        if (_panel && this.option.target) {
            /** @type {?} */
            var h = _panel.offsetHeight;
            /** @type {?} */
            var rect = this.option.target.getBoundingClientRect();
            if (window['innerHeight'] - this.option.top < h) {
                if (rect.top > h) {
                    this.option.top = rect.top - h - 14;
                }
                else {
                    this.option.top = 32;
                }
                /** @type {?} */
                var arrow = this.el.querySelector('.f-filter-panel-arrow');
                if (arrow) {
                    arrow.style.display = 'none';
                }
            }
        }
        if (_panel && this.option.right) {
            if (this.option.left + _panel.offsetWidth > window['innerWidth']) {
                // 超出显示在做
                this.fiexedLeft = false;
                this.option.left = this.option.right - _panel.offsetWidth;
            }
            else {
                this.fiexedLeft = true;
            }
        }
    };
    /**
     * @return {?}
     */
    FilterPanelComponent.prototype.ngOnDestroy = /**
     * @return {?}
     */
    function () {
        if (this._documentMouseUpEvent) {
            this._documentMouseUpEvent();
            this._documentMouseUpEvent = null;
        }
    };
    /**
     * @param {?} $event
     * @return {?}
     */
    FilterPanelComponent.prototype.onMouseDown = /**
     * @param {?} $event
     * @return {?}
     */
    function ($event) {
        this.hasMove = false;
    };
    /**
     * @param {?} $event
     * @return {?}
     */
    FilterPanelComponent.prototype.onMouseMove = /**
     * @param {?} $event
     * @return {?}
     */
    function ($event) {
        this.hasMove = true;
    };
    /**
     * @param {?} event
     * @return {?}
     */
    FilterPanelComponent.prototype.onSearch = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        if (this.option.item.control.controltype == 'radio') {
            this.panelFilterSubmit();
        }
        else if (this.option.item.control.controltype == 'text' && event['type'] && event['type'] === 'enter') {
            this.panelFilterSubmit();
        }
        // this.filterItem = event;
    };
    /**
     * @param {?} $event
     * @return {?}
     */
    FilterPanelComponent.prototype.panelFilterCancel = /**
     * @param {?} $event
     * @return {?}
     */
    function ($event) {
        // $event._instanceId = this.id;
        this.hidePanel.emit($event);
    };
    /**
     * @param {?=} clear
     * @return {?}
     */
    FilterPanelComponent.prototype.panelFilterSubmit = /**
     * @param {?=} clear
     * @return {?}
     */
    function (clear) {
        if (clear === void 0) { clear = false; }
        if (!clear && !this.canSubmit) {
            return;
        }
        if (this.option.item.control.controltype === 'text') {
            /** @type {?} */
            var farrisSearchRecord = this.option.item.valueText;
            /** @type {?} */
            var farrisSearchRecordArray = [];
            /** @type {?} */
            var storagelabelCode = this.option.item.labelCode;
            /** @type {?} */
            var filterPanelArray = JSON.parse(localStorage.getItem(this.option.localStorageKey));
            if (Array.isArray(filterPanelArray)) {
                filterPanelArray = null;
            }
            if (!filterPanelArray || !filterPanelArray[storagelabelCode] || !filterPanelArray[storagelabelCode].length
                && farrisSearchRecord && farrisSearchRecord.length) {
                farrisSearchRecordArray.push(farrisSearchRecord);
            }
            else {
                farrisSearchRecordArray = filterPanelArray[storagelabelCode];
                /** @type {?} */
                var index = filterPanelArray[storagelabelCode].indexOf(farrisSearchRecord);
                if (index < 0 && farrisSearchRecord && farrisSearchRecord.length) {
                    farrisSearchRecordArray.unshift(farrisSearchRecord);
                }
                farrisSearchRecordArray = farrisSearchRecordArray.slice(0, 6);
            }
            if (filterPanelArray == null) {
                filterPanelArray = {};
            }
            filterPanelArray[storagelabelCode] = farrisSearchRecordArray;
            localStorage.setItem(this.option.localStorageKey, JSON.stringify(filterPanelArray));
        }
        /** @type {?} */
        var conditions = this.filterConditionSer.setFilterConditions(this.option.item);
        if (!clear) {
            this.filterSubmit.emit({
                item: this.option.item,
                filter: conditions
            });
        }
        this.submit.emit(this.option.item);
    };
    /**
     * @return {?}
     */
    FilterPanelComponent.prototype.panelFilterClear = /**
     * @return {?}
     */
    function () {
        this.panelFilterempty();
        this.panelFilterSubmit(true);
        this.clearFilter.emit(this.option.item);
    };
    /**
     * @return {?}
     */
    FilterPanelComponent.prototype.panelFilterempty = /**
     * @return {?}
     */
    function () {
        this.filterClearValue(this.option.item);
        this.option.item.valueText = '';
        this.option.item.filled = false;
        this.option.item = deepCopy(this.option.item);
        this.canSubmit = false;
    };
    /**
     * @param {?} item
     * @return {?}
     */
    FilterPanelComponent.prototype.filterClearValue = /**
     * @param {?} item
     * @return {?}
     */
    function (item) {
        switch (item.control.controltype) {
            case 'text':
            case 'search':
            case 'singleDate':
            case 'year':
            case 'month':
            case 'dropdown':
            case 'singlenumber':
            case 'radio':
                item.value.value = null;
                break;
            case 'date':
            case 'datetime':
            case 'monthRange':
            case 'yearRange':
                item.value.startTime = null;
                item.value.endTime = null;
                break;
            case 'number':
                item.value.startValue = null;
                item.value.endValue = null;
                break;
            case 'help':
                item.value.value = [];
                item.value.valueField = null;
                item.value.textValue = null;
                break;
            case 'checkboxgroup':
            case 'bool-check':
                item.value.value = [];
                break;
            case 'input-group':
                item.value.value = [];
                item.value.textValue = null;
                item.value.textField = null;
                item.value.isInputText = null;
                break;
            case 'flexibleNumber':
            case 'flexibleDate':
                item.value.startValue = null;
                item.value.endValue = null;
                item.value.value = null;
                break;
            default:
                item.value.value = null;
                break;
        }
    };
    /**
     * @param {?} event
     * @return {?}
     */
    FilterPanelComponent.prototype.onSubmitChange = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        this.canSubmit = event;
    };
    /**
     * @param {?} value
     * @return {?}
     */
    FilterPanelComponent.prototype.buildSmartHelpKey = /**
     * @param {?} value
     * @return {?}
     */
    function (value) {
        if (this.idService) {
            /** @type {?} */
            var prefix = '';
            if (location.hash) {
                /** @type {?} */
                var pathArr = location.hash.split('?');
                prefix = pathArr ? pathArr[0] : '';
            }
            else {
                /** @type {?} */
                var pathArr = location.pathname.split('/');
                prefix = pathArr ? pathArr[pathArr.length - 1] : '';
            }
            return this.idService.encrypt(prefix + '/list-filter/' + value);
        }
        else {
            return 'list-filter/' + value;
        }
    };
    /**
     * @param {?} $event
     * @return {?}
     */
    FilterPanelComponent.prototype.updateCurrentItem = /**
     * @param {?} $event
     * @return {?}
     */
    function ($event) {
        this.currentItem = cloneDeep({ value: tslib_1.__assign({}, $event.value), type: $event.control.controltype, id: $event.id });
        this.dataChange.emit(this.currentItem);
    };
    /**
     * @return {?}
     */
    FilterPanelComponent.prototype.canClearSearch = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var item = this.currentItem;
        if (!item) {
            return true;
        }
        switch (item.type) {
            case 'text':
            case 'search':
            case 'singleDate':
            case 'year':
            case 'month':
            case 'dropdown':
            case 'singlenumber':
            case 'radio':
                return !this.isNil(item.value.value);
            case 'date':
            case 'datetime':
            case 'monthRange':
            case 'yearRange':
                return !this.isNil(item.value.startTime) || !this.isNil(item.value.endTime);
            case 'help':
            case 'checkboxgroup':
            case 'bool-check':
                return item.value.value && item.value.value.length;
            case 'input-group':
                return (item.value.value && item.value.value.length) || item.value.textValue;
            case 'number':
            case 'flexibleNumber':
            case 'flexibleDate':
                if (item.value.single) {
                    return !this.isNil(item.value.value);
                }
                return !this.isNil(item.value.startValue) || !this.isNil(item.value.endValue);
            default:
                return !this.isNil(item.value.value);
        }
    };
    FilterPanelComponent.decorators = [
        { type: Component, args: [{
                    selector: 'farris-filter-panel',
                    template: "<div class=\"f-filter-panel-wrapper\" #filterPanel [ngClass]=\"{'d-none': hide}\" [style.zIndex]=\"zIndex\">\r\n    <div  [class]=\"'f-filter-panel f-filter-panel-'+(option.item && option.item.control.controltype)\"\r\n        [ngStyle]=\"{\r\n            'left': option.left > 0 ? option.left+'px' : '0px',\r\n            'top': option.top > 0 ? option.top+'px' : '0px',\r\n            'width': (option.width && option.width > 0) ? option.width+'px':'',\r\n            'height': (option.height && option.height > 0) ? option.height+'px':'',\r\n            'max-width': (option.maxWidth && option.maxWidth > 0) ? option.maxWidth+'px':'',\r\n            'max-height': (option.maxHeight && option.maxHeight > 0) ? option.maxHeight+'px':''\r\n        }\">\r\n        <div class=\"f-filter-panel-inner\" [ngClass]=\"{'f-filter-panel-inner-xs': option.item && option.item.control.controltype == 'radio','f-filter-panel-inner-auto': !option.item}\">\r\n            <div class=\"f-filter-panel-arrow\" [ngStyle]=\"{'left':fiexedLeft?'26px':'auto','right':fiexedLeft?'auto':'26px'}\"></div>\r\n            <div class=\"f-filter-panel-extend\" *ngIf=\"option.panelExtendTemplate\">\r\n                <ng-container [ngTemplateOutlet]=\"option.panelExtendTemplate\"></ng-container>\r\n            </div>\r\n            <div class=\"f-filter-panel-header\" *ngIf=\"option.showLable && option.item && option.item.control.controltype != 'radio'\">\r\n                <div class=\"panel-header-title\">\r\n                    {{ 'filterPanel.filter' | locale }}\r\n                </div>\r\n                <!-- <div class=\"panel-header-toolbar\"></div> -->\r\n            </div>\r\n            <div class=\"f-filter-panel-content\" *ngIf=\"option.item\">\r\n                <div class=\"f-filter-panel-form\">\r\n                    <ng-container [ngSwitch]=\"option.item.control.controltype\">\r\n                        <div class=\"filter-input-item filter-type-input position-relative\" *ngSwitchCase=\"'text'\">\r\n                            <panel-filter-input [item]=\"option.item\" [localStorageKey]=\"option.localStorageKey\"\r\n                                (searchHandle)=\"onSearch($event)\" (submitChange)=\"onSubmitChange($event)\" class=\"form-group farris-form-group\"></panel-filter-input>\r\n                        </div>\r\n                        <div class=\"filter-input-item filter-type-search\" *ngSwitchCase=\"'search'\">\r\n                            <panel-filter-search [item]=\"option.item\"\r\n                                (searchHandle)=\"onSearch($event)\" (submitChange)=\"onSubmitChange($event)\" class=\"form-group farris-form-group\"></panel-filter-search>\r\n                        </div>\r\n                        <div class=\"filter-input-item filter-type-date\" *ngSwitchCase=\"'singleDate'\">\r\n                            <panel-filter-date [item]=\"option.item\"\r\n                                (searchHandle)=\"onSearch($event)\" (submitChange)=\"onSubmitChange($event)\" class=\"form-group farris-form-group\"></panel-filter-date>\r\n                        </div>\r\n                        <div class=\"filter-input-item filter-type-date\" *ngSwitchCase=\"'year'\">\r\n                            <panel-filter-date [item]=\"option.item\"\r\n                                (searchHandle)=\"onSearch($event)\" class=\"form-group farris-form-group\" [showType]=\"'3'\" (submitChange)=\"onSubmitChange($event)\"></panel-filter-date>\r\n                        </div>\r\n                        <div class=\"filter-input-item filter-type-date\" *ngSwitchCase=\"'month'\">\r\n                            <panel-filter-date [item]=\"option.item\"\r\n                                (searchHandle)=\"onSearch($event)\" class=\"form-group farris-form-group\" [showType]=\"'2'\" (submitChange)=\"onSubmitChange($event)\"></panel-filter-date>\r\n                        </div>\r\n                        <div class=\"filter-input-item filter-type-date\" *ngSwitchCase=\"'date'\">\r\n                            <panel-filter-daterange [item]=\"option.item\"\r\n                                (searchHandle)=\"onSearch($event)\" class=\"form-group farris-form-group\" (submitChange)=\"onSubmitChange($event)\"></panel-filter-daterange>\r\n                        </div>\r\n                        <div class=\"filter-input-item filter-type-date\" *ngSwitchCase=\"'datetime'\">\r\n                            <panel-filter-daterange [item]=\"option.item\" [showTime]=\"true\"\r\n                                (searchHandle)=\"onSearch($event)\" class=\"form-group farris-form-group\" (submitChange)=\"onSubmitChange($event)\"></panel-filter-daterange>\r\n                        </div>\r\n                        <div class=\"filter-input-item filter-type-date\" *ngSwitchCase=\"'monthRange'\">\r\n                            <panel-filter-daterange [item]=\"option.item\"\r\n                                (searchHandle)=\"onSearch($event)\" class=\"form-group farris-form-group\" [showType]=\"'2'\" (submitChange)=\"onSubmitChange($event)\"></panel-filter-daterange>\r\n                        </div>\r\n                        <div class=\"filter-input-item filter-type-date\" *ngSwitchCase=\"'yearRange'\">\r\n                            <panel-filter-daterange [item]=\"option.item\"\r\n                                (searchHandle)=\"onSearch($event)\" class=\"form-group farris-form-group\" [showType]=\"'3'\" (submitChange)=\"onSubmitChange($event)\"></panel-filter-daterange>\r\n                        </div>\r\n                        <div class=\"filter-input-item filter-type-dropdown\" *ngSwitchCase=\"'dropdown'\">\r\n                            <panel-filter-dropdown [item]=\"option.item\"\r\n                                (searchHandle)=\"onSearch($event)\" class=\"form-group farris-form-group\"  (submitChange)=\"onSubmitChange($event)\"></panel-filter-dropdown>\r\n                        </div>\r\n                        <div class=\"filter-input-item filter-type-number\" *ngSwitchCase=\"'number'\">\r\n                            <panel-filter-number [item]=\"option.item\"\r\n                                (searchHandle)=\"onSearch($event)\" class=\"form-group farris-form-group\" (submitChange)=\"onSubmitChange($event)\"></panel-filter-number>\r\n                        </div>\r\n                        <div class=\"filter-input-item filter-type-single-number\" *ngSwitchCase=\"'singlenumber'\">\r\n                            <panel-filter-single-number [item]=\"option.item\"\r\n                                (searchHandle)=\"onSearch($event)\" class=\"form-group farris-form-group\" (submitChange)=\"onSubmitChange($event)\"></panel-filter-single-number>\r\n                        </div>\r\n                        <div class=\"filter-input-item filter-type-help\" *ngSwitchCase=\"'help'\">\r\n                            <panel-filter-help [item]=\"option.item\" [instanceId]=\"buildSmartHelpKey(option.item.fieldCode)\"\r\n                                (searchHandle)=\"onSearch($event)\" class=\"form-group farris-form-group\" (submitChange)=\"onSubmitChange($event)\"></panel-filter-help>\r\n                        </div>\r\n                        <div class=\"filter-input-item filter-type-checkboxgroup\" [class.checkboxgroup-has-search]=\"option.item.control.enableSearch\" *ngSwitchCase=\"'checkboxgroup'\">\r\n                            <panel-filter-checkbox [item]=\"option.item\"\r\n                                (searchHandle)=\"onSearch($event)\" class=\"form-group farris-form-group\"\r\n                                style=\"white-space: nowrap;\" (submitChange)=\"onSubmitChange($event)\"></panel-filter-checkbox>\r\n                        </div>\r\n                        <div class=\"filter-input-item filter-type-radio\" *ngSwitchCase=\"'radio'\">\r\n                            <panel-filter-radio [item]=\"option.item\"\r\n                                (searchHandle)=\"onSearch($event)\" class=\"form-group farris-form-group\"\r\n                                style=\"white-space: nowrap;\"></panel-filter-radio>\r\n                        </div>\r\n                        <div class=\"filter-input-item filter-type-radio\" *ngSwitchCase=\"'input-group'\">\r\n                            <panel-filter-inputgroup [item]=\"option.item\"\r\n                                (searchHandle)=\"onSearch($event)\" class=\"form-group farris-form-group\"\r\n                                style=\"white-space: nowrap;\"  (submitChange)=\"onSubmitChange($event)\"></panel-filter-inputgroup>\r\n                        </div>\r\n                        <div class=\"filter-input-item filter-type-flexiblenumber\" *ngSwitchCase=\"'flexibleNumber'\">\r\n                            <panel-filter-flexiblenumber [item]=\"option.item\" (itemChange)=\"updateCurrentItem($event)\"\r\n                                (searchHandle)=\"onSearch($event)\" class=\"form-group farris-form-group\"\r\n                                style=\"white-space: nowrap;\" (submitChange)=\"onSubmitChange($event)\"></panel-filter-flexiblenumber>\r\n                        </div>\r\n                        <div class=\"filter-input-item filter-type-flexibledate\" *ngSwitchCase=\"'flexibleDate'\">\r\n                            <panel-filter-flexibledate [item]=\"option.item\"  (itemChange)=\"updateCurrentItem($event)\"\r\n                                (searchHandle)=\"onSearch($event)\" class=\"form-group farris-form-group\"\r\n                                style=\"white-space: nowrap;\" (submitChange)=\"onSubmitChange($event)\"></panel-filter-flexibledate>\r\n                        </div>\r\n                        <div class=\"filter-input-item filter-type-boolcheck\" *ngSwitchCase=\"'bool-check'\">\r\n                            <panel-filter-checkbox [item]=\"option.item\" [boolcheck]=\"true\"\r\n                                (searchHandle)=\"onSearch($event)\" class=\"form-group farris-form-group\"\r\n                                style=\"white-space: nowrap;\" (submitChange)=\"onSubmitChange($event)\"></panel-filter-checkbox>\r\n                        </div>\r\n                        <div class=\"filter-input-item filter-type-default\" *ngSwitchDefault>\r\n                            <panel-filter-input [item]=\"option.item\" [localStorageKey]=\"option.localStorageKey\"\r\n                                (searchHandle)=\"onSearch($event)\" (submitChange)=\"onSubmitChange($event)\" class=\"form-group farris-form-group\"></panel-filter-input>\r\n                        </div>\r\n                    </ng-container>\r\n                </div>\r\n\r\n            </div>\r\n            <div class=\"f-filter-panel-footer\" *ngIf=\"option.item && option.item.control.controltype != 'radio'\">\r\n                <div class=\"filer-panel-clear\">\r\n                    <button class=\"btn btn-link\" (click)=\"panelFilterClear()\"  [disabled]=\"!canClearSearch()\">{{ 'filterPanel.reset' | locale }}</button>\r\n                    <!-- tfs 549371 2023-03-24 -->\r\n                    <!-- <button class=\"btn btn-link btn-empty\" (click)=\"panelFilterempty()\">{{ 'filterPanel.empty' | locale }}</button> -->\r\n                </div>\r\n                <div class=\"filter-panel-btns\">\r\n                    <button class=\"btn btn-secondary\" (click)=\"panelFilterCancel($event)\">{{ 'filterPanel.cancel' | locale }}</button>\r\n                    <button class=\"filter-panel-submit btn btn-primary\" (click)=\"panelFilterSubmit()\" [disabled]=\"!canSubmit\">{{ 'filterPanel.confirm' | locale }}</button>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>",
                    encapsulation: ViewEncapsulation.None,
                    styles: [".filter-type-checkboxgroup.checkboxgroup-has-search{padding-top:0;position:relative;}"]
                }] }
    ];
    /** @nocollapse */
    FilterPanelComponent.ctorParameters = function () { return [
        { type: Renderer2 },
        { type: ElementRef },
        { type: QuerySolutionService }
    ]; };
    FilterPanelComponent.propDecorators = {
        option: [{ type: Input }],
        hide: [{ type: Input }],
        hidePanel: [{ type: Output }],
        submit: [{ type: Output }],
        filterSubmit: [{ type: Output }],
        clearFilter: [{ type: Output }],
        dataChange: [{ type: Output }],
        filterPanel: [{ type: ViewChild, args: ['filterPanel',] }],
        onMouseDown: [{ type: HostListener, args: ['mousedown', ['$event'],] }],
        onMouseMove: [{ type: HostListener, args: ['mousemove', ['$event'],] }]
    };
    return FilterPanelComponent;
}());
export { FilterPanelComponent };
if (false) {
    /**
     * @type {?}
     * @private
     */
    FilterPanelComponent.prototype.el;
    /** @type {?} */
    FilterPanelComponent.prototype.option;
    /** @type {?} */
    FilterPanelComponent.prototype._hide;
    /** @type {?} */
    FilterPanelComponent.prototype.hidePanel;
    /** @type {?} */
    FilterPanelComponent.prototype.submit;
    /** @type {?} */
    FilterPanelComponent.prototype.filterSubmit;
    /** @type {?} */
    FilterPanelComponent.prototype.clearFilter;
    /** @type {?} */
    FilterPanelComponent.prototype.dataChange;
    /** @type {?} */
    FilterPanelComponent.prototype.filterPanel;
    /** @type {?} */
    FilterPanelComponent.prototype.canSubmit;
    /** @type {?} */
    FilterPanelComponent.prototype.fiexedLeft;
    /**
     * @type {?}
     * @private
     */
    FilterPanelComponent.prototype.hasMove;
    /**
     * @type {?}
     * @private
     */
    FilterPanelComponent.prototype._documentMouseUpEvent;
    /** @type {?} */
    FilterPanelComponent.prototype.injector;
    /**
     * @type {?}
     * @private
     */
    FilterPanelComponent.prototype.idService;
    /**
     * @type {?}
     * @private
     */
    FilterPanelComponent.prototype.currentItem;
    /** @type {?} */
    FilterPanelComponent.prototype.zIndex;
    /**
     * @type {?}
     * @private
     */
    FilterPanelComponent.prototype.isNil;
    /**
     * @type {?}
     * @private
     */
    FilterPanelComponent.prototype.renderer;
    /**
     * @type {?}
     * @private
     */
    FilterPanelComponent.prototype.elementRef;
    /**
     * @type {?}
     * @private
     */
    FilterPanelComponent.prototype.filterConditionSer;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZmlsdGVyLXBhbmVsLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BmYXJyaXMvdWktZmlsdGVyLXBhbmVsLyIsInNvdXJjZXMiOlsibGliL2ZpbHRlci1wYW5lbC5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQSxPQUFPLEVBQUUsU0FBUyxFQUFVLEtBQUssRUFBRSxNQUFNLEVBQUUsWUFBWSxFQUFFLFNBQVMsRUFDMUQsVUFBVSxFQUFFLFNBQVMsRUFBRSxpQkFBaUIsRUFBRSxZQUFZLEVBQTRCLE1BQU0sZUFBZSxDQUFDO0FBRWhILE9BQU8sRUFBRSxvQkFBb0IsRUFBRSxNQUFNLDZCQUE2QixDQUFDO0FBQ25FLE9BQU8sRUFBRSxRQUFRLEVBQUUsTUFBTSxTQUFTLENBQUM7QUFDbkMsT0FBTyxFQUFFLFNBQVMsRUFBRSxNQUFNLG1CQUFtQixDQUFDO0FBQzlDLE9BQU8sRUFBRSxTQUFTLEVBQUUsTUFBTSxXQUFXLENBQUM7O0FBRXRDO0lBa0NJLDhCQUFvQixRQUFtQixFQUFVLFVBQXNCLEVBQVUsa0JBQXdDO1FBQXJHLGFBQVEsR0FBUixRQUFRLENBQVc7UUFBVSxlQUFVLEdBQVYsVUFBVSxDQUFZO1FBQVUsdUJBQWtCLEdBQWxCLGtCQUFrQixDQUFzQjtRQXpCekgsVUFBSyxHQUFHLEtBQUssQ0FBQztRQVFKLGNBQVMsR0FBRyxJQUFJLFlBQVksRUFBRSxDQUFDO1FBQy9CLFdBQU0sR0FBRyxJQUFJLFlBQVksRUFBRSxDQUFDO1FBQzVCLGlCQUFZLEdBQUcsSUFBSSxZQUFZLEVBQUUsQ0FBQztRQUNsQyxnQkFBVyxHQUFHLElBQUksWUFBWSxFQUFFLENBQUM7UUFDakMsZUFBVSxHQUFHLElBQUksWUFBWSxFQUFFLENBQUM7UUFFMUMsY0FBUyxHQUFHLEtBQUssQ0FBQztRQUNsQixlQUFVLEdBQUMsSUFBSSxDQUFDOztRQUVSLFlBQU8sR0FBRyxLQUFLLENBQUM7UUFDaEIsMEJBQXFCLEdBQUcsSUFBSSxD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QUMxRCxVQUFVO2dCQUVULG9CQUFvQjs7O3lCQWF4QixLQUFLO3VCQUVMLEtBQUs7NEJBT0wsTUFBTTt5QkFDTixNQUFNOytCQUNOLE1BQU07OEJBQ04sTUFBTTs2QkFDTixNQUFNOzhCQUNOLFNBQVMsU0FBQyxhQUFhOzhCQXFGdkIsWUFBWSxTQUFDLFdBQVcsRUFBRSxDQUFDLFFBQVEsQ0FBQzs4QkFLcEMsWUFBWSxTQUFDLFdBQVcsRUFBRSxDQUFDLFFBQVEsQ0FBQzs7SUF3THpDLDJCQUFDO0NBQUEsQUF4U0QsSUF3U0M7U0FsU1ksb0JBQW9COzs7Ozs7SUFDN0Isa0NBQXdCOztJQUN4QixzQ0FBbUM7O0lBQ25DLHFDQUFjOztJQVFkLHlDQUF5Qzs7SUFDekMsc0NBQXNDOztJQUN0Qyw0Q0FBNEM7O0lBQzVDLDJDQUEyQzs7SUFDM0MsMENBQTBDOztJQUMxQywyQ0FBa0Q7O0lBQ2xELHlDQUFrQjs7SUFDbEIsMENBQWdCOzs7OztJQUVoQix1Q0FBd0I7Ozs7O0lBQ3hCLHFEQUFxQzs7SUFDckMsd0NBQVM7Ozs7O0lBQ1QseUNBQTZCOzs7OztJQUM3QiwyQ0FBMkI7O0lBRTNCLHNDQUFjOzs7OztJQWlPZCxxQ0FBK0U7Ozs7O0lBL05uRSx3Q0FBMkI7Ozs7O0lBQUUsMENBQThCOzs7OztJQUFFLGtEQUFnRCIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbXBvbmVudCwgT25Jbml0LCBJbnB1dCwgT3V0cHV0LCBFdmVudEVtaXR0ZXIsIFJlbmRlcmVyMixcclxuICAgICAgICBFbGVtZW50UmVmLCBWaWV3Q2hpbGQsIFZpZXdFbmNhcHN1bGF0aW9uLCBIb3N0TGlzdGVuZXIsIE9uRGVzdHJveSwgQWZ0ZXJWaWV3SW5pdCB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBGaWx0ZXJQYW5lbE9wdGlvbiB9IGZyb20gJy4vZmlsdGVyLXBhbmVsLmludGVyZmFjZSc7XHJcbmltcG9ydCB7IFF1ZXJ5U29sdXRpb25TZXJ2aWNlIH0gZnJvbSAnQGZhcnJpcy91aS1maWx0ZXItY29uZGl0aW9uJztcclxuaW1wb3J0IHsgZGVlcENvcHkgfSBmcm9tICcuL3V0aWxzJztcclxuaW1wb3J0IHsgSWRTZXJ2aWNlIH0gZnJvbSAnQGZhcnJpcy91aS1jb21tb24nO1xyXG5pbXBvcnQgeyBjbG9uZURlZXAgfSBmcm9tICdsb2Rhc2gtZXMnO1xyXG4vLyDnlKjkuo7mmL7npLrngrnlh7sg566A5Y2V562b6YCJIOmhueeahOS4i+aLiemdouadv1xyXG5AQ29tcG9uZW50KHtcclxuICAgIHNlbGVjdG9yOiAnZmFycmlzLWZpbHRlci1wYW5lbCcsXHJcbiAgICB0ZW1wbGF0ZVVybDogJy4vZmlsdGVyLXBhbmVsLmNvbXBvbmVudC5odG1sJyxcclxuICAgIGVuY2Fwc3VsYXRpb246IFZpZXdFbmNhcHN1bGF0aW9uLk5vbmUsXHJcbiAgICBzdHlsZXM6W1wiLmZpbHRlci10eXBlLWNoZWNrYm94Z3JvdXAuY2hlY2tib3hncm91cC1oYXMtc2VhcmNoe3BhZGRpbmctdG9wOjA7cG9zaXRpb246cmVsYXRpdmU7fVwiXVxyXG59KVxyXG5leHBvcnQgY2xhc3MgRmlsdGVyUGFuZWxDb21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQsIE9uRGVzdHJveSwgQWZ0ZXJWaWV3SW5pdCB7XHJcbiAgICBwcml2YXRlIGVsOiBIVE1MRWxlbWVudDtcclxuICAgIEBJbnB1dCgpIG9wdGlvbjogRmlsdGVyUGFuZWxPcHRpb247XHJcbiAgICBfaGlkZSA9IGZhbHNlO1xyXG4gICAgQElucHV0KClcclxuICAgIHNldCBoaWRlKHZhbCkge1xyXG4gICAgICAgIHRoaXMuX2hpZGUgPSB2YWw7XHJcbiAgICB9XHJcbiAgICBnZXQgaGlkZSgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5faGlkZTtcclxuICAgIH1cclxuICAgIEBPdXRwdXQoKSBoaWRlUGFuZWwgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XHJcbiAgICBAT3V0cHV0KCkgc3VibWl0ID0gbmV3IEV2ZW50RW1pdHRlcigpO1xyXG4gICAgQE91dHB1dCgpIGZpbHRlclN1Ym1pdCA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcclxuICAgIEBPdXRwdXQoKSBjbGVhckZpbHRlciA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcclxuICAgIEBPdXRwdXQoKSBkYXRhQ2hhbmdlID0gbmV3IEV2ZW50RW1pdHRlcigpO1xyXG4gICAgQFZpZXdDaGlsZCgnZmlsdGVyUGFuZWwnKSBmaWx0ZXJQYW5lbDogRWxlbWVudFJlZjtcclxuICAgIGNhblN1Ym1pdCA9IGZhbHNlO1xyXG4gICAgZmlleGVkTGVmdD10cnVlO1xyXG4gICAgLy8g5YWo5bGA5qCH6K+G77yM5Yid5aeL5YyW5qCH6K+G5YWD57Sg5rKh5pyJ5Y+R55SfbW91c2Vtb3ZlXHJcbiAgICBwcml2YXRlIGhhc01vdmUgPSBmYWxzZTtcclxuICAgIHByaXZhdGUgX2RvY3VtZW50TW91c2VVcEV2ZW50ID0gbnVsbDtcclxuICAgIGluamVjdG9yO1xyXG4gICAgcHJpdmF0ZSBpZFNlcnZpY2U6IElkU2VydmljZTtcclxuICAgIHByaXZhdGUgY3VycmVudEl0ZW0gPSBudWxsO1xyXG5cclxuICAgIHpJbmRleCA9IDEwNjA7XHJcbiAgICBcclxuICAgIGNvbnN0cnVjdG9yKHByaXZhdGUgcmVuZGVyZXI6IFJlbmRlcmVyMiwgcHJpdmF0ZSBlbGVtZW50UmVmOiBFbGVtZW50UmVmLCBwcml2YXRlIGZpbHRlckNvbmRpdGlvblNlcjogUXVlcnlTb2x1dGlvblNlcnZpY2UpIHtcclxuICAgICAgICB0aGlzLmVsID0gdGhpcy5lbGVtZW50UmVmLm5hdGl2ZUVsZW1lbnQ7XHJcbiAgICB9XHJcbiAgICBuZ09uSW5pdCgpIHtcclxuICAgICAgICBjb25zdCBzZWxmID0gdGhpcztcclxuICAgICAgICB0aGlzLl9kb2N1bWVudE1vdXNlVXBFdmVudCA9IHRoaXMucmVuZGVyZXIubGlzdGVuKHRoaXMuZmlsdGVyUGFuZWwubmF0aXZlRWxlbWVudCwgJ21vdXNldXAnLCAoZXZlbnQ6IE1vdXNlRXZlbnQpID0+IHtcclxuICAgICAgICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgICAgIGNvbnN0IHRhcjogYW55ID0gZXZlbnQudGFyZ2V0O1xyXG4gICAgICAgICAgICBpZiAodGFyLmNsb3Nlc3QoJyNtYWluQ29udGFpbmVyVGFic2V0JykpIHtcclxuICAgICAgICAgICAgICAgIC8vIHNlbGYuaGlkZVBhbmVsLmVtaXQoZXZlbnQpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5wYW5lbEZpbHRlckNhbmNlbChldmVudCk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmICh0aGlzLmhhc01vdmUpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKCF0YXIuY2xvc2VzdCgnLmYtZmlsdGVyLXBhbmVsJylcclxuICAgICAgICAgICAgICAgICYmICF0YXIuY2xvc2VzdCgnLm1vZGFsJylcclxuICAgICAgICAgICAgICAgICYmICF0YXIuY2xvc2VzdCgnLm92ZXJsYXktY29udGFpbmVyJykgJiYgIXRhci5jbG9zZXN0KCcub3ZlcmxheS1wYW5lJykpIHtcclxuICAgICAgICAgICAgICAgIC8vIHNlbGYuaGlkZVBhbmVsLmVtaXQoZXZlbnQpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5wYW5lbEZpbHRlckNhbmNlbChldmVudCk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHRoaXMuaGFzTW92ZSA9IGZhbHNlO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGlmICh0aGlzLm9wdGlvbi5pdGVtICYmICh0aGlzLm9wdGlvbi5pdGVtLmNvbnRyb2wuY29udHJvbHR5cGUgPT0gJ2Ryb3Bkb3duJyB8fCB0aGlzLm9wdGlvbi5pdGVtLmNvbnRyb2wuY29udHJvbHR5cGUgPT0gJ3JhZGlvJykpIHtcclxuICAgICAgICAgICAgdGhpcy5jYW5TdWJtaXQgPSB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZih0aGlzLmluamVjdG9yKSB7XHJcbiAgICAgICAgICAgIHRoaXMuaWRTZXJ2aWNlID0gdGhpcy5pbmplY3Rvci5nZXQoSWRTZXJ2aWNlKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuY3VycmVudEl0ZW0gPSBjbG9uZURlZXAoe3ZhbHVlOiB7Li4udGhpcy5vcHRpb24uaXRlbS52YWx1ZX0sIHR5cGU6IHRoaXMub3B0aW9uLml0ZW0uY29udHJvbC5jb250cm9sdHlwZSwgaWQ6IHRoaXMub3B0aW9uLml0ZW0uaWR9KTtcclxuICAgIH1cclxuXHJcbiAgICBuZ0FmdGVyVmlld0luaXQoKSB7XHJcbiAgICAgICAgY29uc3QgX3BhbmVsOiBhbnkgPSB0aGlzLmVsLnF1ZXJ5U2VsZWN0b3IoJy5mLWZpbHRlci1wYW5lbCcpO1xyXG4gICAgICAgIGlmIChfcGFuZWwgJiYgdGhpcy5vcHRpb24udGFyZ2V0KSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGggPSBfcGFuZWwub2Zmc2V0SGVpZ2h0O1xyXG4gICAgICAgICAgICBjb25zdCByZWN0ID0gdGhpcy5vcHRpb24udGFyZ2V0LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xyXG4gICAgICAgICAgICBpZiAod2luZG93Wydpbm5lckhlaWdodCddIC0gdGhpcy5vcHRpb24udG9wIDwgaCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHJlY3QudG9wID4gaCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMub3B0aW9uLnRvcCA9IHJlY3QudG9wIC0gaCAtIDE0O1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLm9wdGlvbi50b3AgPSAzMjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNvbnN0IGFycm93OiBhbnkgPSB0aGlzLmVsLnF1ZXJ5U2VsZWN0b3IoJy5mLWZpbHRlci1wYW5lbC1hcnJvdycpO1xyXG4gICAgICAgICAgICAgICAgaWYgKGFycm93KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYXJyb3cuc3R5bGUuZGlzcGxheSA9ICdub25lJztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBpZihfcGFuZWwmJnRoaXMub3B0aW9uLnJpZ2h0KXtcclxuICAgICAgICAgICAgaWYodGhpcy5vcHRpb24ubGVmdCtfcGFuZWwub2Zmc2V0V2lkdGg+d2luZG93Wydpbm5lcldpZHRoJ10pe1xyXG4gICAgICAgICAgICAgICAgLy8g6LaF5Ye65pi+56S65Zyo5YGaXHJcbiAgICAgICAgICAgICAgICB0aGlzLmZpZXhlZExlZnQ9ZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm9wdGlvbi5sZWZ0PXRoaXMub3B0aW9uLnJpZ2h0LV9wYW5lbC5vZmZzZXRXaWR0aDtcclxuICAgICAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmZpZXhlZExlZnQ9dHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBuZ09uRGVzdHJveSgpIHtcclxuICAgICAgICBpZiAodGhpcy5fZG9jdW1lbnRNb3VzZVVwRXZlbnQpIHtcclxuICAgICAgICAgICAgdGhpcy5fZG9jdW1lbnRNb3VzZVVwRXZlbnQoKTtcclxuICAgICAgICAgICAgdGhpcy5fZG9jdW1lbnRNb3VzZVVwRXZlbnQgPSBudWxsO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcblxyXG4gICAgQEhvc3RMaXN0ZW5lcignbW91c2Vkb3duJywgWyckZXZlbnQnXSlcclxuICAgIG9uTW91c2VEb3duKCRldmVudCkge1xyXG4gICAgICAgIHRoaXMuaGFzTW92ZSA9IGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIEBIb3N0TGlzdGVuZXIoJ21vdXNlbW92ZScsIFsnJGV2ZW50J10pXHJcbiAgICBvbk1vdXNlTW92ZSgkZXZlbnQpIHtcclxuICAgICAgICB0aGlzLmhhc01vdmUgPSB0cnVlO1xyXG4gICAgfVxyXG5cclxuXHJcbiAgICBvblNlYXJjaChldmVudCkge1xyXG4gICAgICAgIGlmICh0aGlzLm9wdGlvbi5pdGVtLmNvbnRyb2wuY29udHJvbHR5cGUgPT0gJ3JhZGlvJykge1xyXG4gICAgICAgICAgICB0aGlzLnBhbmVsRmlsdGVyU3VibWl0KCk7XHJcbiAgICAgICAgfWVsc2UgaWYodGhpcy5vcHRpb24uaXRlbS5jb250cm9sLmNvbnRyb2x0eXBlID09ICd0ZXh0JyAmJiAgZXZlbnRbJ3R5cGUnXSAmJiBldmVudFsndHlwZSddID09PSAnZW50ZXInKXtcclxuICAgICAgICAgICAgdGhpcy5wYW5lbEZpbHRlclN1Ym1pdCgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyB0aGlzLmZpbHRlckl0ZW0gPSBldmVudDtcclxuICAgIH1cclxuXHJcbiAgICBwYW5lbEZpbHRlckNhbmNlbCgkZXZlbnQpIHtcclxuICAgICAgICAvLyAkZXZlbnQuX2luc3RhbmNlSWQgPSB0aGlzLmlkO1xyXG4gICAgICAgIHRoaXMuaGlkZVBhbmVsLmVtaXQoJGV2ZW50KTtcclxuICAgIH1cclxuICAgIHBhbmVsRmlsdGVyU3VibWl0KGNsZWFyOiBib29sZWFuID0gZmFsc2UpIHtcclxuICAgICAgICBpZiAoIWNsZWFyICYmICF0aGlzLmNhblN1Ym1pdCkge3JldHVybjsgfVxyXG4gICAgICAgIGlmICh0aGlzLm9wdGlvbi5pdGVtLmNvbnRyb2wuY29udHJvbHR5cGUgPT09ICd0ZXh0Jykge1xyXG4gICAgICAgICAgICBjb25zdCBmYXJyaXNTZWFyY2hSZWNvcmQgPSB0aGlzLm9wdGlvbi5pdGVtLnZhbHVlVGV4dDtcclxuICAgICAgICAgICAgbGV0IGZhcnJpc1NlYXJjaFJlY29yZEFycmF5ID0gW107XHJcbiAgICAgICAgICAgIGNvbnN0IHN0b3JhZ2VsYWJlbENvZGUgPSB0aGlzLm9wdGlvbi5pdGVtLmxhYmVsQ29kZTtcclxuICAgICAgICAgICAgbGV0IGZpbHRlclBhbmVsQXJyYXkgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKHRoaXMub3B0aW9uLmxvY2FsU3RvcmFnZUtleSkpO1xyXG4gICAgICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShmaWx0ZXJQYW5lbEFycmF5KSkge1xyXG4gICAgICAgICAgICAgICAgZmlsdGVyUGFuZWxBcnJheSA9IG51bGw7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKCFmaWx0ZXJQYW5lbEFycmF5IHx8ICFmaWx0ZXJQYW5lbEFycmF5W3N0b3JhZ2VsYWJlbENvZGVdIHx8ICFmaWx0ZXJQYW5lbEFycmF5W3N0b3JhZ2VsYWJlbENvZGVdLmxlbmd0aFxyXG4gICAgICAgICAgICAgICAgICAgICYmIGZhcnJpc1NlYXJjaFJlY29yZCAmJiBmYXJyaXNTZWFyY2hSZWNvcmQubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICBmYXJyaXNTZWFyY2hSZWNvcmRBcnJheS5wdXNoKGZhcnJpc1NlYXJjaFJlY29yZCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBmYXJyaXNTZWFyY2hSZWNvcmRBcnJheSA9IGZpbHRlclBhbmVsQXJyYXlbc3RvcmFnZWxhYmVsQ29kZV07XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpbmRleCA9IGZpbHRlclBhbmVsQXJyYXlbc3RvcmFnZWxhYmVsQ29kZV0uaW5kZXhPZihmYXJyaXNTZWFyY2hSZWNvcmQpO1xyXG4gICAgICAgICAgICAgICAgaWYgKGluZGV4IDwgMCAmJiBmYXJyaXNTZWFyY2hSZWNvcmQgJiYgZmFycmlzU2VhcmNoUmVjb3JkLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGZhcnJpc1NlYXJjaFJlY29yZEFycmF5LnVuc2hpZnQoZmFycmlzU2VhcmNoUmVjb3JkKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGZhcnJpc1NlYXJjaFJlY29yZEFycmF5ID0gZmFycmlzU2VhcmNoUmVjb3JkQXJyYXkuc2xpY2UoMCwgNik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGZpbHRlclBhbmVsQXJyYXkgPT0gbnVsbCkgeyBmaWx0ZXJQYW5lbEFycmF5ID0ge307IH1cclxuICAgICAgICAgICAgZmlsdGVyUGFuZWxBcnJheVtzdG9yYWdlbGFiZWxDb2RlXSA9IGZhcnJpc1NlYXJjaFJlY29yZEFycmF5O1xyXG4gICAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSh0aGlzLm9wdGlvbi5sb2NhbFN0b3JhZ2VLZXksIEpTT04uc3RyaW5naWZ5KGZpbHRlclBhbmVsQXJyYXkpKTtcclxuXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zdCBjb25kaXRpb25zID0gdGhpcy5maWx0ZXJDb25kaXRpb25TZXIuc2V0RmlsdGVyQ29uZGl0aW9ucyh0aGlzLm9wdGlvbi5pdGVtKTtcclxuICAgICAgICBpZiAoIWNsZWFyKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZmlsdGVyU3VibWl0LmVtaXQoe1xyXG4gICAgICAgICAgICAgICAgaXRlbTogdGhpcy5vcHRpb24uaXRlbSxcclxuICAgICAgICAgICAgICAgIGZpbHRlcjogY29uZGl0aW9uc1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5zdWJtaXQuZW1pdCh0aGlzLm9wdGlvbi5pdGVtKTtcclxuICAgIH1cclxuXHJcbiAgICBwYW5lbEZpbHRlckNsZWFyKCkge1xyXG4gICAgICAgIHRoaXMucGFuZWxGaWx0ZXJlbXB0eSgpO1xyXG4gICAgICAgIHRoaXMucGFuZWxGaWx0ZXJTdWJtaXQodHJ1ZSk7XHJcbiAgICAgICAgdGhpcy5jbGVhckZpbHRlci5lbWl0KHRoaXMub3B0aW9uLml0ZW0pO1xyXG4gICAgfVxyXG4gICAgcGFuZWxGaWx0ZXJlbXB0eSgpIHtcclxuICAgICAgICB0aGlzLmZpbHRlckNsZWFyVmFsdWUodGhpcy5vcHRpb24uaXRlbSk7XHJcbiAgICAgICAgdGhpcy5vcHRpb24uaXRlbS52YWx1ZVRleHQgPSAnJztcclxuICAgICAgICB0aGlzLm9wdGlvbi5pdGVtLmZpbGxlZCA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMub3B0aW9uLml0ZW0gPSBkZWVwQ29weSh0aGlzLm9wdGlvbi5pdGVtKTtcclxuICAgICAgICB0aGlzLmNhblN1Ym1pdCA9IGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIGZpbHRlckNsZWFyVmFsdWUoaXRlbSkge1xyXG4gICAgICAgIHN3aXRjaCAoaXRlbS5jb250cm9sLmNvbnRyb2x0eXBlKSB7XHJcbiAgICAgICAgICAgIGNhc2UgJ3RleHQnOlxyXG4gICAgICAgICAgICBjYXNlICdzZWFyY2gnOlxyXG4gICAgICAgICAgICBjYXNlICdzaW5nbGVEYXRlJzpcclxuICAgICAgICAgICAgY2FzZSAneWVhcic6XHJcbiAgICAgICAgICAgIGNhc2UgJ21vbnRoJzpcclxuICAgICAgICAgICAgY2FzZSAnZHJvcGRvd24nOlxyXG4gICAgICAgICAgICBjYXNlICdzaW5nbGVudW1iZXInOlxyXG4gICAgICAgICAgICBjYXNlICdyYWRpbyc6XHJcbiAgICAgICAgICAgICAgICBpdGVtLnZhbHVlLnZhbHVlID0gbnVsbDtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlICdkYXRlJzpcclxuICAgICAgICAgICAgY2FzZSAnZGF0ZXRpbWUnOlxyXG4gICAgICAgICAgICBjYXNlICdtb250aFJhbmdlJzpcclxuICAgICAgICAgICAgY2FzZSAneWVhclJhbmdlJzpcclxuICAgICAgICAgICAgICAgIGl0ZW0udmFsdWUuc3RhcnRUaW1lID0gbnVsbDtcclxuICAgICAgICAgICAgICAgIGl0ZW0udmFsdWUuZW5kVGltZSA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAnbnVtYmVyJzpcclxuICAgICAgICAgICAgICAgIGl0ZW0udmFsdWUuc3RhcnRWYWx1ZSA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICBpdGVtLnZhbHVlLmVuZFZhbHVlID0gbnVsbDtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlICdoZWxwJzpcclxuICAgICAgICAgICAgICAgIGl0ZW0udmFsdWUudmFsdWUgPSBbXTtcclxuICAgICAgICAgICAgICAgIGl0ZW0udmFsdWUudmFsdWVGaWVsZCA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICBpdGVtLnZhbHVlLnRleHRWYWx1ZSA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAnY2hlY2tib3hncm91cCc6XHJcbiAgICAgICAgICAgIGNhc2UgJ2Jvb2wtY2hlY2snOlxyXG4gICAgICAgICAgICAgICAgaXRlbS52YWx1ZS52YWx1ZSA9IFtdO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgJ2lucHV0LWdyb3VwJzpcclxuICAgICAgICAgICAgICAgIGl0ZW0udmFsdWUudmFsdWUgPSBbXTtcclxuICAgICAgICAgICAgICAgIGl0ZW0udmFsdWUudGV4dFZhbHVlID0gbnVsbDtcclxuICAgICAgICAgICAgICAgIGl0ZW0udmFsdWUudGV4dEZpZWxkID0gbnVsbDtcclxuICAgICAgICAgICAgICAgIGl0ZW0udmFsdWUuaXNJbnB1dFRleHQgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgJ2ZsZXhpYmxlTnVtYmVyJzpcclxuICAgICAgICAgICAgY2FzZSAnZmxleGlibGVEYXRlJzpcclxuICAgICAgICAgICAgICAgIGl0ZW0udmFsdWUuc3RhcnRWYWx1ZSA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICBpdGVtLnZhbHVlLmVuZFZhbHVlID0gbnVsbDtcclxuICAgICAgICAgICAgICAgIGl0ZW0udmFsdWUudmFsdWUgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgaXRlbS52YWx1ZS52YWx1ZSA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgb25TdWJtaXRDaGFuZ2UoZXZlbnQpIHtcclxuICAgICAgICB0aGlzLmNhblN1Ym1pdCA9IGV2ZW50O1xyXG4gICAgfVxyXG5cclxuICAgIGJ1aWxkU21hcnRIZWxwS2V5KHZhbHVlOiBzdHJpbmcpIHtcclxuICAgICAgICBpZih0aGlzLmlkU2VydmljZSkge1xyXG4gICAgICAgICAgICBsZXQgcHJlZml4ID0gJyc7XHJcbiAgICAgICAgICAgIGlmIChsb2NhdGlvbi5oYXNoKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBwYXRoQXJyID0gbG9jYXRpb24uaGFzaC5zcGxpdCgnPycpO1xyXG4gICAgICAgICAgICAgICAgcHJlZml4ID0gcGF0aEFyciA/IHBhdGhBcnJbMF0gOiAnJztcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHBhdGhBcnIgID0gbG9jYXRpb24ucGF0aG5hbWUuc3BsaXQoJy8nKTtcclxuICAgICAgICAgICAgICAgIHByZWZpeCA9IHBhdGhBcnIgPyBwYXRoQXJyW3BhdGhBcnIubGVuZ3RoIC0gMV0gOiAnJztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5pZFNlcnZpY2UuZW5jcnlwdChwcmVmaXggKyAnL2xpc3QtZmlsdGVyLycgKyB2YWx1ZSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuICdsaXN0LWZpbHRlci8nICsgdmFsdWU7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHVwZGF0ZUN1cnJlbnRJdGVtKCRldmVudCkge1xyXG4gICAgICAgIHRoaXMuY3VycmVudEl0ZW0gPSBjbG9uZURlZXAoe3ZhbHVlOiB7Li4uJGV2ZW50LnZhbHVlfSwgdHlwZTogJGV2ZW50LmNvbnRyb2wuY29udHJvbHR5cGUsIGlkOiAkZXZlbnQuaWR9KTtcclxuICAgICAgICB0aGlzLmRhdGFDaGFuZ2UuZW1pdCh0aGlzLmN1cnJlbnRJdGVtKTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGlzTmlsID0gKHZhbDogYW55KSA9PiB2YWwgPT09IG51bGwgIHx8IHZhbCA9PT0gdW5kZWZpbmVkIHx8IHZhbCA9PT0gJyc7XHJcblxyXG4gICAgY2FuQ2xlYXJTZWFyY2goKSB7XHJcbiAgICAgICAgY29uc3QgaXRlbSA9IHRoaXMuY3VycmVudEl0ZW07XHJcbiAgICAgICAgaWYgKCFpdGVtKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBzd2l0Y2ggKGl0ZW0udHlwZSkge1xyXG4gICAgICAgICAgICBjYXNlICd0ZXh0JzpcclxuICAgICAgICAgICAgY2FzZSAnc2VhcmNoJzpcclxuICAgICAgICAgICAgY2FzZSAnc2luZ2xlRGF0ZSc6XHJcbiAgICAgICAgICAgIGNhc2UgJ3llYXInOlxyXG4gICAgICAgICAgICBjYXNlICdtb250aCc6XHJcbiAgICAgICAgICAgIGNhc2UgJ2Ryb3Bkb3duJzpcclxuICAgICAgICAgICAgY2FzZSAnc2luZ2xlbnVtYmVyJzpcclxuICAgICAgICAgICAgY2FzZSAncmFkaW8nOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuICF0aGlzLmlzTmlsKGl0ZW0udmFsdWUudmFsdWUpO1xyXG4gICAgICAgICAgICBjYXNlICdkYXRlJzpcclxuICAgICAgICAgICAgY2FzZSAnZGF0ZXRpbWUnOlxyXG4gICAgICAgICAgICBjYXNlICdtb250aFJhbmdlJzpcclxuICAgICAgICAgICAgY2FzZSAneWVhclJhbmdlJzpcclxuICAgICAgICAgICAgICAgIHJldHVybiAhdGhpcy5pc05pbChpdGVtLnZhbHVlLnN0YXJ0VGltZSkgfHwgIXRoaXMuaXNOaWwoaXRlbS52YWx1ZS5lbmRUaW1lKTtcclxuICAgICAgICAgICAgY2FzZSAnaGVscCc6XHJcbiAgICAgICAgICAgIGNhc2UgJ2NoZWNrYm94Z3JvdXAnOlxyXG4gICAgICAgICAgICBjYXNlICdib29sLWNoZWNrJzpcclxuICAgICAgICAgICAgICAgIHJldHVybiBpdGVtLnZhbHVlLnZhbHVlICYmIGl0ZW0udmFsdWUudmFsdWUubGVuZ3RoO1xyXG4gICAgICAgICAgICBjYXNlICdpbnB1dC1ncm91cCc6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gKGl0ZW0udmFsdWUudmFsdWUgJiYgaXRlbS52YWx1ZS52YWx1ZS5sZW5ndGgpIHx8IGl0ZW0udmFsdWUudGV4dFZhbHVlO1xyXG4gICAgICAgICAgICBjYXNlICdudW1iZXInOlxyXG4gICAgICAgICAgICBjYXNlICdmbGV4aWJsZU51bWJlcic6XHJcbiAgICAgICAgICAgIGNhc2UgJ2ZsZXhpYmxlRGF0ZSc6XHJcbiAgICAgICAgICAgICAgICBpZiAoaXRlbS52YWx1ZS5zaW5nbGUpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gIXRoaXMuaXNOaWwoaXRlbS52YWx1ZS52YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gIXRoaXMuaXNOaWwoaXRlbS52YWx1ZS5zdGFydFZhbHVlKSB8fCAhdGhpcy5pc05pbChpdGVtLnZhbHVlLmVuZFZhbHVlKTtcclxuICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgIHJldHVybiAhdGhpcy5pc05pbChpdGVtLnZhbHVlLnZhbHVlKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuIl19