/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, Input, EventEmitter, Output, ViewChild, ElementRef, Optional } from '@angular/core';
import { LocaleService } from '@farris/ui-locale';
/**
 * 含义说明
* this._item
  A、control属性的含义{
    enumValues:枚举项数组[{value:枚举项的值,name:枚举项的显示文本}],
    isExtend:是否显示在扩展面板
  B、value 属性
     value 对应当前多选组件的值
  C、valueText 属性 --对应文本
}
 */
export class PanelfilterCheckboxComponent {
    /**
     * @param {?} localeService
     */
    constructor(localeService) {
        this.localeService = localeService;
        this.checkedAll = false;
        this.enableSearch = false;
        this.boolcheck = false;
        this.searchHandle = new EventEmitter();
        this.submitChange = new EventEmitter();
        this.indeterminate = true;
        this.boolCheckState = 'indeterminate';
        // 数据源
        this.checkboxDataSource = new Array();
        // 当前查询结果
        this.allCols = new Array();
        // 在当前查询结果的选中值
        this.allColsCheckValue = [];
        //不在当前的查询结果中的选中值
        this.notInCurResult = [];
        // 是否设置查询时候的宽度
        this.hasSetWidthSearching = false;
        // 查询提示
        this.searchPlaceHolder = "请输入名称";
        this.checkallCheckboxDisabled = false;
    }
    /**
     * @return {?}
     */
    get item() {
        return this._item;
    }
    /**
     * @param {?} data
     * @return {?}
     */
    set item(data) {
        this._item = data;
        this.getDataSource();
        //this.checkValue = this._item.value.getOriginalValue();
        if (!this._item.hasOwnProperty('value'))
            this._item.value = { value: [] };
        if (this._item.hasOwnProperty('value')) {
            this.checkValue = this._item.value.value;
            //保存值
            this.allColsCheckValue = this.checkValue;
        }
        else {
            this._item.value.value = [];
        }
        if (this.boolcheck) {
            if (this.checkValue.length) {
                this.boolchecked = this.checkValue[0];
                if (this.boolchecked)
                    this.boolCheckState = 'checked';
                else
                    this.boolCheckState = 'unchecked';
            }
            else
                this.boolCheckState = 'indeterminate';
        }
        this.enableSearch = data.control.hasOwnProperty("enableSearch") ? data.control.enableSearch : false;
        if (this._item.value.value.length == 0)
            this.checkedAll = false;
        else if (this._item.control['enumValues'] && this._item.value.value.length == this._item.control['enumValues'].length)
            this.checkedAll = true;
        this.setSubmitChange();
    }
    /**
     * @return {?}
     */
    ngOnInit() {
        this.setLocaleData();
    }
    /**
     * @return {?}
     */
    getDataSource() {
        if (this.item && this._item.control) {
            /** @type {?} */
            let checkboxList = (this._item.control);
            this.checkboxDataSource = Array();
            if (checkboxList.enumValues && checkboxList.enumValues.length > 0) {
                checkboxList.enumValues.forEach((/**
                 * @param {?} element
                 * @return {?}
                 */
                element => {
                    this.checkboxDataSource.push(Object.assign({}, element));
                }));
                this.allCols = this.checkboxDataSource;
            }
        }
    }
    /**
     * @param {?} event
     * @return {?}
     */
    onSearch(event) {
        /** @type {?} */
        let checkboxValue = [];
        if (event) {
            /** @type {?} */
            let checkboxList = event;
            if (checkboxList && checkboxList.length) {
                checkboxValue = checkboxList;
            }
            this.allColsCheckValue = checkboxValue;
        }
        else {
            this.allColsCheckValue = [];
        }
        this.onlyUpdateCheckValue();
        this.searchResultIsCheckAll();
        this.getValueText();
        this.setSubmitChange();
        this.searchHandle.emit();
    }
    /**
     * @return {?}
     */
    getValueText() {
        /** @type {?} */
        const enumValue = (this._item.control).enumValues;
        /** @type {?} */
        const value = (this._item.value).value;
        if (enumValue && enumValue.length && value && value.length) {
            /** @type {?} */
            let texts = [];
            for (let i = 0; i <= value.length; i++) {
                /** @type {?} */
                const enums = enumValue.find((/**
                 * @param {?} val
                 * @return {?}
                 */
                val => {
                    return val['value'] == value[i];
                }));
                if (enums) {
                    texts.push(enums['name']);
                }
            }
            this._item.valueText = texts.join(',');
        }
        else {
            this._item.valueText = '';
        }
    }
    /**
     * 是否可以提交
     * @return {?}
     */
    setSubmitChange() {
        /** @type {?} */
        const val = this._item.value;
        if (Object.keys(val).length < 0 || Object.keys(val.value).length === 0) {
            this.submitChange.emit(false);
        }
        else {
            this.submitChange.emit(true);
        }
    }
    /**
     * 点击全选Checkbox
     * @param {?} event
     * @return {?}
     */
    handleClick(event) {
        if (this.checkallCheckboxDisabled) {
            // 全选checkbox是否禁用
            return;
        }
        this.checkedAll = !this.checkedAll;
        if (this.checkedAll) {
            // 全选
            this.setCheckedAll();
        }
        else {
            // 取消全选
            this.setUnCheckedAll();
        }
        this.getValueText();
        this.setSubmitChange();
        this.searchHandle.emit();
    }
    /**
     * 设置全选
     * 23年12月13日--增加过滤，改变此方法
     * @return {?}
     */
    setCheckedAll() {
        if (this.allCols && this.allCols.length) {
            /** @type {?} */
            let checkboxValue = [];
            checkboxValue = this.allCols.map((/**
             * @param {?} item
             * @return {?}
             */
            item => item.value));
            this.allColsCheckValue = [].concat(checkboxValue);
            this.onlyUpdateCheckValue();
        }
    }
    /**
     * 取消全选
     * @private
     * @return {?}
     */
    setUnCheckedAll() {
        if (this.allCols && this.allCols.length) {
            this.allColsCheckValue = [];
            this.onlyUpdateCheckValue();
        }
    }
    /**
     * @return {?}
     */
    handleCheckClick() {
        if (this.boolCheckState == 'indeterminate') {
            this.boolCheckState = 'checked';
            this.boolchecked = true;
            this._item.value.value = [true];
        }
        else if (this.boolCheckState == 'checked') {
            this.boolCheckState = 'unchecked';
            this.boolchecked = false;
            this._item.value.value = [false];
        }
        else if (this.boolCheckState == 'unchecked') {
            this.boolCheckState = 'indeterminate';
            this.boolchecked = null;
            this._item.value.value = [];
        }
        this.setSubmitChange();
        this.searchHandle.emit();
    }
    /**
     * 清空查询
     * @param {?} $event
     * @param {?} input
     * @return {?}
     */
    clearSearch($event, input) {
        if (input && input.value) {
            this.filterItems('');
            input.value = '';
        }
    }
    /**
     * 开始查询
     * @param {?} $event
     * @return {?}
     */
    searchItems($event) {
        /** @type {?} */
        const txt = $event.target.value;
        this.filterItems(txt);
    }
    /**
     * @param {?} ev
     * @return {?}
     */
    searchInputFocus(ev) {
        if (!this.hasSetWidthSearching) {
            /** @type {?} */
            let findParEl = this.searchInput.nativeElement.closest('.checkboxgroup-has-search');
            this.hasSetWidthSearching = true;
            findParEl.style.width = findParEl.offsetWidth + 'px';
        }
    }
    /**
     * 过滤项
     * @private
     * @param {?=} searchWords
     * @return {?}
     */
    filterItems(searchWords = '') {
        /** @type {?} */
        let cols = [];
        searchWords = searchWords.trim();
        if (searchWords) {
            /** @type {?} */
            let searchArray = searchWords.split(" ");
            /** @type {?} */
            let tallColsCheckValue = [];
            this.notInCurResult = [];
            cols = this.checkboxDataSource.filter((/**
             * @param {?} item
             * @return {?}
             */
            item => {
                /** @type {?} */
                let waitSearchStr = item.name.toLowerCase();
                /** @type {?} */
                let curResult = false;
                // 空格做为同一个匹配条件
                /** @type {?} */
                let findNotContain = searchArray.findIndex((/**
                 * @param {?} searchStr
                 * @return {?}
                 */
                searchStr => {
                    // A B 两个条件过滤
                    if (searchStr == '') {
                        return false;
                    }
                    return waitSearchStr.indexOf(searchStr.toLowerCase()) == -1;
                }));
                curResult = findNotContain == -1;
                if (curResult) {
                    //在查询结果内
                    if (this.checkValue.some((/**
                     * @param {?} checkItem
                     * @return {?}
                     */
                    (checkItem) => checkItem == item.value))) {
                        //且在选择的值范围内
                        tallColsCheckValue.push(item.value);
                    }
                }
                return curResult;
            }));
            this.allCols = cols;
            this.allColsCheckValue = tallColsCheckValue;
            // 不在当前选中的数据
            this.notInCurResult = this.checkValue.filter((/**
             * @param {?} x
             * @return {?}
             */
            x => tallColsCheckValue.indexOf(x) === -1));
        }
        else {
            this.allCols = this.checkboxDataSource;
            //如果是查询出全部数据
            this.allColsCheckValue = [].concat(this.checkValue);
            this.notInCurResult = [];
        }
        // 更改全选状态
        this.searchResultIsCheckAll();
    }
    /**
     * 查询结果全选的状态
     * @private
     * @return {?}
     */
    searchResultIsCheckAll() {
        // 如果无结果
        if (this.allCols.length == 0) {
            this.checkedAll = false;
            this.checkallCheckboxDisabled = true;
        }
        else {
            if (this.allCols.length > this.allColsCheckValue.length) {
                // 查询结果的长度比已选元素多
                this.checkedAll = false;
            }
            else {
                this.checkedAll = true;
            }
            this.checkallCheckboxDisabled = false;
        }
    }
    /**
     * 更新状态
     * @private
     * @return {?}
     */
    onlyUpdateCheckValue() {
        this.checkValue = [].concat(this.allColsCheckValue, this.notInCurResult);
        this._item.value.value = this.checkValue;
    }
    /**
     * @private
     * @return {?}
     */
    setLocaleData() {
        if (this.enableSearch && this.localeService) {
            this.searchPlaceHolder = this.localeService.getValue('filterPanel.searchPlaceHolder') || "请输入名称";
        }
    }
}
PanelfilterCheckboxComponent.decorators = [
    { type: Component, args: [{
                selector: 'panel-filter-checkbox',
                template: "<div class=\"f-cmp-inputgroup mb-2\"  *ngIf=\"!boolcheck&&enableSearch\" style=\"position: sticky;z-index: 1;top:0;\">\r\n    <div class=\"input-group\">\r\n        <input #searchInput class=\"form-control\" type=\"text\" [placeholder]=\"searchPlaceHolder\"  (input)=\"searchItems($event)\" (focus)=\"searchInputFocus($event)\"/>\r\n            <div class=\"input-group-append f-cursor-pointer\" (click)=\"clearSearch($event,searchInput)\">\r\n                <span class=\"input-group-text\">\r\n                    <i class=\"f-icon\"  [ngClass]=\"searchInput.value?'f-icon-close':'f-icon-search'\"></i>\r\n                </span>                \r\n            </div>\r\n    </div>\r\n</div>\r\n\r\n<div class=\"custom-control custom-checkbox custom-control-inline filter-panel-checkbox\" *ngIf=\"!boolcheck\">\r\n    <input type=\"checkbox\" class=\"custom-control-input\"  [checked]=\"checkedAll\" [disabled]=\"checkallCheckboxDisabled\">\r\n    <label class=\"custom-control-label\" (click)=\"handleClick($event)\">{{'filterPanel.checkall'| locale}}</label>\r\n</div>\r\n<ng-container *ngIf=\"!boolcheck; else elseTemplate\">\r\n    <farris-checkboxgroup [value]=\"allColsCheckValue\" [horizontal]=\"false\"\r\n        [data]=\"allCols\" [isStringValue]=\"false\" (changeValue)=\"onSearch($event)\">\r\n    </farris-checkboxgroup>\r\n</ng-container>\r\n<ng-template #elseTemplate>\r\n    <div class=\"custom-control custom-checkbox custom-control-inline filter-bool-checkbox\">\r\n        <input type=\"checkbox\" class=\"custom-control-input\" [checked]=\"boolchecked\" [indeterminate]=\"boolCheckState == 'indeterminate'\">\r\n        <label class=\"custom-control-label\" (click)=\"handleCheckClick()\">{{item.fieldName || item.name}}</label>\r\n    </div>\r\n</ng-template>\r\n\r\n"
            }] }
];
/** @nocollapse */
PanelfilterCheckboxComponent.ctorParameters = () => [
    { type: LocaleService, decorators: [{ type: Optional }] }
];
PanelfilterCheckboxComponent.propDecorators = {
    enableSearch: [{ type: Input }],
    boolcheck: [{ type: Input }],
    item: [{ type: Input }],
    searchInput: [{ type: ViewChild, args: ['searchInput',] }],
    searchHandle: [{ type: Output, args: ['searchHandle',] }],
    submitChange: [{ type: Output, args: ['submitChange',] }]
};
if (false) {
    /** @type {?} */
    PanelfilterCheckboxComponent.prototype.checkedAll;
    /** @type {?} */
    PanelfilterCheckboxComponent.prototype.enableSearch;
    /** @type {?} */
    PanelfilterCheckboxComponent.prototype.boolcheck;
    /** @type {?} */
    PanelfilterCheckboxComponent.prototype._item;
    /** @type {?} */
    PanelfilterCheckboxComponent.prototype.searchInput;
    /** @type {?} */
    PanelfilterCheckboxComponent.prototype.searchHandle;
    /** @type {?} */
    PanelfilterCheckboxComponent.prototype.submitChange;
    /** @type {?} */
    PanelfilterCheckboxComponent.prototype.checkValue;
    /** @type {?} */
    PanelfilterCheckboxComponent.prototype.indeterminate;
    /** @type {?} */
    PanelfilterCheckboxComponent.prototype.boolchecked;
    /** @type {?} */
    PanelfilterCheckboxComponent.prototype.boolCheckState;
    /** @type {?} */
    PanelfilterCheckboxComponent.prototype.checkboxDataSource;
    /** @type {?} */
    PanelfilterCheckboxComponent.prototype.allCols;
    /** @type {?} */
    PanelfilterCheckboxComponent.prototype.allColsCheckValue;
    /**
     * @type {?}
     * @private
     */
    PanelfilterCheckboxComponent.prototype.notInCurResult;
    /**
     * @type {?}
     * @private
     */
    PanelfilterCheckboxComponent.prototype.hasSetWidthSearching;
    /** @type {?} */
    PanelfilterCheckboxComponent.prototype.searchPlaceHolder;
    /** @type {?} */
    PanelfilterCheckboxComponent.prototype.checkallCheckboxDisabled;
    /** @type {?} */
    PanelfilterCheckboxComponent.prototype.localeService;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2hlY2tib3guY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGZhcnJpcy91aS1maWx0ZXItcGFuZWwvIiwic291cmNlcyI6WyJsaWIvY29tcG9uZW50cy9jaGVja2JveGNvbXBvbmVudC9jaGVja2JveC5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUFBLE9BQU8sRUFBRSxTQUFTLEVBQUUsS0FBSyxFQUFVLFlBQVksRUFBRSxNQUFNLEVBQUUsU0FBUyxFQUFFLFVBQVUsRUFBRSxRQUFRLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFDaEgsT0FBTyxFQUFFLGFBQWEsRUFBRSxNQUFNLG1CQUFtQixDQUFDO0FBS2xEOzs7Ozs7Ozs7O0dBVUc7QUFDSCxNQUFNLE9BQU8sNEJBQTRCOzs7O0lBMERyQyxZQUErQixhQUE0QjtRQUE1QixrQkFBYSxHQUFiLGFBQWEsQ0FBZTtRQXhEM0QsZUFBVSxHQUFZLEtBQUssQ0FBQztRQUNuQixpQkFBWSxHQUFHLEtBQUssQ0FBQztRQUNyQixjQUFTLEdBQVksS0FBSyxDQUFDO1FBa0NaLGlCQUFZLEdBQUcsSUFBSSxZQUFZLEVBQUUsQ0FBQztRQUNsQyxpQkFBWSxHQUFHLElBQUksWUFBWSxFQUFFLENBQUM7UUFHMUQsa0JBQWEsR0FBWSxJQUFJLENBQUM7UUFFOUIsbUJBQWMsR0FBVyxlQUFlLENBQUM7O1FBRXpDLHVCQUFrQixHQUFlLElBQUksS0FBSyxFQUFPLENBQUM7O1FBRWxELFlBQU8sR0FBZSxJQUFJLEtBQUssRUFBTyxDQUFDOztRQUV2QyxzQkFBaUIsR0FBTyxFQUFFLENBQUM7O1FBRW5CLG1CQUFjLEdBQU8sRUFBRSxDQUFDOztRQUV4Qix5QkFBb0IsR0FBQyxLQUFLLENBQUM7O1FBRW5DLHNCQUFpQixHQUFDLE9BQU8sQ0FBQztRQUMxQiw2QkFBd0IsR0FBQyxLQUFLLENBQUM7SUFDaUMsQ0FBQzs7OztJQXBEakUsSUFDSSxJQUFJO1FBQ0osT0FBTyxJQUFJLENBQUMsS0FB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LGFBQWEsRUFBQztZQUNyQyxJQUFJLENBQUMsaUJBQWlCLEdBQUUsSUFBSSxDQUFDLGFBQWEsQ0FBQyxRQUFRLENBQUMsK0JBQStCLENBQUMsSUFBRSxPQUFPLENBQUM7U0FDaEc7SUFDTixDQUFDOzs7WUFoVEosU0FBUyxTQUFDO2dCQUNQLFFBQVEsRUFBRSx1QkFBdUI7Z0JBQ2pDLDJ3REFBd0M7YUFDM0M7Ozs7WUFKUSxhQUFhLHVCQTBFTCxRQUFROzs7MkJBdkRwQixLQUFLO3dCQUNMLEtBQUs7bUJBRUwsS0FBSzswQkErQkwsU0FBUyxTQUFDLGFBQWE7MkJBQ3ZCLE1BQU0sU0FBQyxjQUFjOzJCQUNyQixNQUFNLFNBQUMsY0FBYzs7OztJQXJDdEIsa0RBQTRCOztJQUM1QixvREFBOEI7O0lBQzlCLGlEQUFvQzs7SUFDcEMsNkNBQVc7O0lBZ0NYLG1EQUFrRDs7SUFDbEQsb0RBQTBEOztJQUMxRCxvREFBMEQ7O0lBRTFELGtEQUFrQjs7SUFDbEIscURBQThCOztJQUM5QixtREFBcUI7O0lBQ3JCLHNEQUF5Qzs7SUFFekMsMERBQWtEOztJQUVsRCwrQ0FBdUM7O0lBRXZDLHlEQUEyQjs7Ozs7SUFFM0Isc0RBQWdDOzs7OztJQUVoQyw0REFBbUM7O0lBRW5DLHlEQUEwQjs7SUFDMUIsZ0VBQStCOztJQUNuQixxREFBK0MiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb21wb25lbnQsIElucHV0LCBPbkluaXQsIEV2ZW50RW1pdHRlciwgT3V0cHV0LCBWaWV3Q2hpbGQsIEVsZW1lbnRSZWYsIE9wdGlvbmFsIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IExvY2FsZVNlcnZpY2UgfSBmcm9tICdAZmFycmlzL3VpLWxvY2FsZSc7XHJcbkBDb21wb25lbnQoe1xyXG4gICAgc2VsZWN0b3I6ICdwYW5lbC1maWx0ZXItY2hlY2tib3gnLFxyXG4gICAgdGVtcGxhdGVVcmw6ICcuL2NoZWNrYm94LmNvbXBvbmVudC5odG1sJ1xyXG59KVxyXG4vKipcclxuICog5ZCr5LmJ6K+05piOXHJcbiogdGhpcy5faXRlbVxyXG4gIEHjgIFjb250cm9s5bGe5oCn55qE5ZCr5LmJe1xyXG4gICAgZW51bVZhbHVlczrmnprkuL7pobnmlbDnu4Rbe3ZhbHVlOuaemuS4vumhueeahOWAvCxuYW1lOuaemuS4vumhueeahOaYvuekuuaWh+acrH1dLFxyXG4gICAgaXNFeHRlbmQ65piv5ZCm5pi+56S65Zyo5omp5bGV6Z2i5p2/XHJcbiAgQuOAgXZhbHVlIOWxnuaAp1xyXG4gICAgIHZhbHVlIOWvueW6lOW9k+WJjeWkmumAiee7hOS7tueahOWAvFxyXG4gIEPjgIF2YWx1ZVRleHQg5bGe5oCnIC0t5a+55bqU5paH5pysXHJcbn1cclxuICovXHJcbmV4cG9ydCBjbGFzcyBQYW5lbGZpbHRlckNoZWNrYm94Q29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0IHtcclxuXHJcbiAgICBjaGVja2VkQWxsOiBib29sZWFuID0gZmFsc2U7XHJcbiAgICBASW5wdXQoKSBlbmFibGVTZWFyY2ggPSBmYWxzZTtcclxuICAgIEBJbnB1dCgpIGJvb2xjaGVjazogYm9vbGVhbiA9IGZhbHNlO1xyXG4gICAgX2l0ZW06IGFueTtcclxuICAgIEBJbnB1dCgpXHJcbiAgICBnZXQgaXRlbSgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5faXRlbTtcclxuICAgIH1cclxuICAgIHNldCBpdGVtKGRhdGEpIHtcclxuICAgICAgICB0aGlzLl9pdGVtID0gZGF0YTtcclxuICAgICAgICB0aGlzLmdldERhdGFTb3VyY2UoKTtcclxuICAgICAgICAvL3RoaXMuY2hlY2tWYWx1ZSA9IHRoaXMuX2l0ZW0udmFsdWUuZ2V0T3JpZ2luYWxWYWx1ZSgpO1xyXG4gICAgICAgIGlmICghdGhpcy5faXRlbS5oYXNPd25Qcm9wZXJ0eSgndmFsdWUnKSkgdGhpcy5faXRlbS52YWx1ZSA9IHsgdmFsdWU6IFtdIH07XHJcbiAgICAgICAgaWYgKHRoaXMuX2l0ZW0uaGFzT3duUHJvcGVydHkoJ3ZhbHVlJykpIHtcclxuICAgICAgICAgICAgdGhpcy5jaGVja1ZhbHVlID0gdGhpcy5faXRlbS52YWx1ZS52YWx1ZTtcclxuICAgICAgICAgICAgLy/kv53lrZjlgLxcclxuICAgICAgICAgICAgdGhpcy5hbGxDb2xzQ2hlY2tWYWx1ZT10aGlzLmNoZWNrVmFsdWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLl9pdGVtLnZhbHVlLnZhbHVlID0gW107XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLmJvb2xjaGVjaykge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5jaGVja1ZhbHVlLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5ib29sY2hlY2tlZCA9IHRoaXMuY2hlY2tWYWx1ZVswXTtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmJvb2xjaGVja2VkKSB0aGlzLmJvb2xDaGVja1N0YXRlID0gJ2NoZWNrZWQnO1xyXG4gICAgICAgICAgICAgICAgZWxzZSB0aGlzLmJvb2xDaGVja1N0YXRlID0gJ3VuY2hlY2tlZCc7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB0aGlzLmJvb2xDaGVja1N0YXRlID0gJ2luZGV0ZXJtaW5hdGUnO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmVuYWJsZVNlYXJjaD1kYXRhLmNvbnRyb2wuaGFzT3duUHJvcGVydHkoXCJlbmFibGVTZWFyY2hcIik/ZGF0YS5jb250cm9sLmVuYWJsZVNlYXJjaDpmYWxzZTtcclxuICAgICAgICBpZiAodGhpcy5faXRlbS52YWx1ZS52YWx1ZS5sZW5ndGggPT0gMCkgdGhpcy5jaGVja2VkQWxsID0gZmFsc2U7XHJcbiAgICAgICAgZWxzZSBpZiAodGhpcy5faXRlbS5jb250cm9sWydlbnVtVmFsdWVzJ10gJiYgdGhpcy5faXRlbS52YWx1ZS52YWx1ZS5sZW5ndGggPT0gdGhpcy5faXRlbS5jb250cm9sWydlbnVtVmFsdWVzJ10ubGVuZ3RoKSB0aGlzLmNoZWNrZWRBbGwgPSB0cnVlO1xyXG4gICAgICAgIHRoaXMuc2V0U3VibWl0Q2hhbmdlKCk7XHJcbiAgICB9XHJcblxyXG4gICAgQFZpZXdDaGlsZCgnc2VhcmNoSW5wdXQnKSBzZWFyY2hJbnB1dDogRWxlbWVudFJlZjtcclxuICAgIEBPdXRwdXQoJ3NlYXJjaEhhbmRsZScpIHNlYXJjaEhhbmRsZSA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcclxuICAgIEBPdXRwdXQoJ3N1Ym1pdENoYW5nZScpIHN1Ym1pdENoYW5nZSA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcclxuICAgIC8vIOiusOW9leWLvumAieeahOWAvFxyXG4gICAgY2hlY2tWYWx1ZTogYW55W107XHJcbiAgICBpbmRldGVybWluYXRlOiBib29sZWFuID0gdHJ1ZTtcclxuICAgIGJvb2xjaGVja2VkOiBib29sZWFuO1xyXG4gICAgYm9vbENoZWNrU3RhdGU6IHN0cmluZyA9ICdpbmRldGVybWluYXRlJztcclxuICAgIC8vIOaVsOaNrua6kFxyXG4gICAgY2hlY2tib3hEYXRhU291cmNlOiBBcnJheTxhbnk+ID0gbmV3IEFycmF5PGFueT4oKTtcclxuICAgIC8vIOW9k+WJjeafpeivoue7k+aenFxyXG4gICAgYWxsQ29sczogQXJyYXk8YW55PiA9IG5ldyBBcnJheTxhbnk+KCk7XHJcbiAgICAvLyDlnKjlvZPliY3mn6Xor6Lnu5PmnpznmoTpgInkuK3lgLxcclxuICAgIGFsbENvbHNDaGVja1ZhbHVlOmFueVtdPVtdO1xyXG4gICAgLy/kuI3lnKjlvZPliY3nmoTmn6Xor6Lnu5PmnpzkuK3nmoTpgInkuK3lgLxcclxuICAgIHByaXZhdGUgbm90SW5DdXJSZXN1bHQ6YW55W109W107XHJcbiAgICAvLyDmmK/lkKborr7nva7mn6Xor6Lml7blgJnnmoTlrr3luqZcclxuICAgIHByaXZhdGUgaGFzU2V0V2lkdGhTZWFyY2hpbmc9ZmFsc2U7XHJcbiAgICAvLyDmn6Xor6Lmj5DnpLpcclxuICAgIHNlYXJjaFBsYWNlSG9sZGVyPVwi6K+36L6T5YWl5ZCN56ewXCI7XHJcbiAgICBjaGVja2FsbENoZWNrYm94RGlzYWJsZWQ9ZmFsc2U7XHJcbiAgICBjb25zdHJ1Y3RvcihAT3B0aW9uYWwoKSBwdWJsaWMgbG9jYWxlU2VydmljZTogTG9jYWxlU2VydmljZSkgIHsgfVxyXG5cclxuICAgIG5nT25Jbml0KCk6IHZvaWQge1xyXG4gICAgICAgIHRoaXMuc2V0TG9jYWxlRGF0YSgpO1xyXG4gICAgfVxyXG5cclxuICAgIGdldERhdGFTb3VyY2UoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuaXRlbSAmJiB0aGlzLl9pdGVtLmNvbnRyb2wpIHtcclxuICAgICAgICAgICAgbGV0IGNoZWNrYm94TGlzdCA9ICh0aGlzLl9pdGVtLmNvbnRyb2wpO1xyXG4gICAgICAgICAgICB0aGlzLmNoZWNrYm94RGF0YVNvdXJjZSA9IEFycmF5PGFueT4oKTtcclxuICAgICAgICAgICAgaWYgKGNoZWNrYm94TGlzdC5lbnVtVmFsdWVzICYmIGNoZWNrYm94TGlzdC5lbnVtVmFsdWVzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgIGNoZWNrYm94TGlzdC5lbnVtVmFsdWVzLmZvckVhY2goZWxlbWVudCA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jaGVja2JveERhdGFTb3VyY2UucHVzaChPYmplY3QuYXNzaWduKHt9LCBlbGVtZW50KSk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIHRoaXMuYWxsQ29scyA9IHRoaXMuY2hlY2tib3hEYXRhU291cmNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIG9uU2VhcmNoKGV2ZW50KSB7XHJcbiAgICAgICAgbGV0IGNoZWNrYm94VmFsdWUgPSBbXTtcclxuICAgICAgICBpZiAoZXZlbnQpIHtcclxuICAgICAgICAgICAgbGV0IGNoZWNrYm94TGlzdCA9IGV2ZW50O1xyXG4gICAgICAgICAgICBpZiAoY2hlY2tib3hMaXN0ICYmIGNoZWNrYm94TGlzdC5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgIGNoZWNrYm94VmFsdWUgPSBjaGVja2JveExpc3Q7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5hbGxDb2xzQ2hlY2tWYWx1ZT1jaGVja2JveFZhbHVlOyAgICAgICAgICAgIFxyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICB0aGlzLmFsbENvbHNDaGVja1ZhbHVlPVtdO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLm9ubHlVcGRhdGVDaGVja1ZhbHVlKCk7XHJcbiAgICAgICAgdGhpcy5zZWFyY2hSZXN1bHRJc0NoZWNrQWxsKCk7XHJcbiAgICAgICAgdGhpcy5nZXRWYWx1ZVRleHQoKTtcclxuICAgICAgICB0aGlzLnNldFN1Ym1pdENoYW5nZSgpO1xyXG4gICAgICAgIHRoaXMuc2VhcmNoSGFuZGxlLmVtaXQoKTtcclxuICAgIH1cclxuXHJcbiAgICBnZXRWYWx1ZVRleHQoKSB7XHJcbiAgICAgICAgY29uc3QgZW51bVZhbHVlID0gKHRoaXMuX2l0ZW0uY29udHJvbCkuZW51bVZhbHVlcztcclxuICAgICAgICBjb25zdCB2YWx1ZSA9ICh0aGlzLl9pdGVtLnZhbHVlKS52YWx1ZTtcclxuICAgICAgICBpZiAoZW51bVZhbHVlICYmIGVudW1WYWx1ZS5sZW5ndGggJiYgdmFsdWUgJiYgdmFsdWUubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIGxldCB0ZXh0cyA9IFtdO1xyXG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8PSB2YWx1ZS5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZW51bXMgPSBlbnVtVmFsdWUuZmluZCh2YWwgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB2YWxbJ3ZhbHVlJ10gPT0gdmFsdWVbaV07XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIGlmIChlbnVtcykge1xyXG4gICAgICAgICAgICAgICAgICAgIHRleHRzLnB1c2goZW51bXNbJ25hbWUnXSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5faXRlbS52YWx1ZVRleHQgPSB0ZXh0cy5qb2luKCcsJyk7XHJcbiAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgIHRoaXMuX2l0ZW0udmFsdWVUZXh0PScnO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICog5piv5ZCm5Y+v5Lul5o+Q5LqkXHJcbiAgICAgKi9cclxuICAgIHNldFN1Ym1pdENoYW5nZSgpIHtcclxuICAgICAgICBjb25zdCB2YWwgPSB0aGlzLl9pdGVtLnZhbHVlO1xyXG4gICAgICAgIGlmIChPYmplY3Qua2V5cyh2YWwpLmxlbmd0aCA8IDAgfHwgT2JqZWN0LmtleXModmFsLnZhbHVlKS5sZW5ndGggPT09IDApIHtcclxuICAgICAgICAgICAgdGhpcy5zdWJtaXRDaGFuZ2UuZW1pdChmYWxzZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLnN1Ym1pdENoYW5nZS5lbWl0KHRydWUpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICog54K55Ye75YWo6YCJQ2hlY2tib3hcclxuICAgICAqIEBwYXJhbSBldmVudCBcclxuICAgICAqL1xyXG4gICAgaGFuZGxlQ2xpY2soZXZlbnQpIHtcclxuICAgICAgICBpZih0aGlzLmNoZWNrYWxsQ2hlY2tib3hEaXNhYmxlZCl7XHJcbiAgICAgICAgLy8g5YWo6YCJY2hlY2tib3jmmK/lkKbnpoHnlKhcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmNoZWNrZWRBbGwgPSAhdGhpcy5jaGVja2VkQWxsO1xyXG4gICAgICAgIGlmICh0aGlzLmNoZWNrZWRBbGwpIHtcclxuICAgICAgICAgICAgLy8g5YWo6YCJXHJcbiAgICAgICAgICAgIHRoaXMuc2V0Q2hlY2tlZEFsbCgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgLy8g5Y+W5raI5YWo6YCJXHJcbiAgICAgICAgICAgIHRoaXMuc2V0VW5DaGVja2VkQWxsKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuZ2V0VmFsdWVUZXh0KCk7XHJcbiAgICAgICAgdGhpcy5zZXRTdWJtaXRDaGFuZ2UoKTtcclxuICAgICAgICB0aGlzLnNlYXJjaEhhbmRsZS5lbWl0KCk7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIOiuvue9ruWFqOmAiSBcclxuICAgICAqIDIz5bm0MTLmnIgxM+aXpS0t5aKe5Yqg6L+H5ruk77yM5pS55Y+Y5q2k5pa55rOVXHJcbiAgICAgKi9cclxuICAgIHNldENoZWNrZWRBbGwoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuYWxsQ29scyAmJiB0aGlzLmFsbENvbHMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIGxldCBjaGVja2JveFZhbHVlID0gW107ICAgIFxyXG4gICAgICAgICAgICBjaGVja2JveFZhbHVlPSB0aGlzLmFsbENvbHMubWFwKGl0ZW09Pml0ZW0udmFsdWUpICAgIFxyXG4gICAgICAgICAgICB0aGlzLmFsbENvbHNDaGVja1ZhbHVlPVtdLmNvbmNhdChjaGVja2JveFZhbHVlKTtcclxuICAgICAgICAgICAgdGhpcy5vbmx5VXBkYXRlQ2hlY2tWYWx1ZSgpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICog5Y+W5raI5YWo6YCJXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgc2V0VW5DaGVja2VkQWxsKCl7XHJcbiAgICAgICAgaWYgKHRoaXMuYWxsQ29scyAmJiB0aGlzLmFsbENvbHMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICB0aGlzLmFsbENvbHNDaGVja1ZhbHVlPVtdO1xyXG4gICAgICAgICAgICAgdGhpcy5vbmx5VXBkYXRlQ2hlY2tWYWx1ZSgpOyAgIFxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBoYW5kbGVDaGVja0NsaWNrKCkge1xyXG4gICAgICAgIGlmICh0aGlzLmJvb2xDaGVja1N0YXRlID09ICdpbmRldGVybWluYXRlJykge1xyXG4gICAgICAgICAgICB0aGlzLmJvb2xDaGVja1N0YXRlID0gJ2NoZWNrZWQnO1xyXG4gICAgICAgICAgICB0aGlzLmJvb2xjaGVja2VkID0gdHJ1ZTtcclxuICAgICAgICAgICAgdGhpcy5faXRlbS52YWx1ZS52YWx1ZSA9IFt0cnVlXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAodGhpcy5ib29sQ2hlY2tTdGF0ZSA9PSAnY2hlY2tlZCcpIHtcclxuICAgICAgICAgICAgdGhpcy5ib29sQ2hlY2tTdGF0ZSA9ICd1bmNoZWNrZWQnO1xyXG4gICAgICAgICAgICB0aGlzLmJvb2xjaGVja2VkID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHRoaXMuX2l0ZW0udmFsdWUudmFsdWUgPSBbZmFsc2VdO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmICh0aGlzLmJvb2xDaGVja1N0YXRlID09ICd1bmNoZWNrZWQnKSB7XHJcbiAgICAgICAgICAgIHRoaXMuYm9vbENoZWNrU3RhdGUgPSAnaW5kZXRlcm1pbmF0ZSc7XHJcbiAgICAgICAgICAgIHRoaXMuYm9vbGNoZWNrZWQgPSBudWxsO1xyXG4gICAgICAgICAgICB0aGlzLl9pdGVtLnZhbHVlLnZhbHVlID0gW107XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuc2V0U3VibWl0Q2hhbmdlKCk7XHJcbiAgICAgICAgdGhpcy5zZWFyY2hIYW5kbGUuZW1pdCgpO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiDmuIXnqbrmn6Xor6JcclxuICAgICAqIEBwYXJhbSAkZXZlbnQgXHJcbiAgICAgKiBAcGFyYW0gaW5wdXQgXHJcbiAgICAgKi9cclxuICAgIGNsZWFyU2VhcmNoKCRldmVudCwgaW5wdXQpIHtcclxuICAgICAgICBpZiAoaW5wdXQgJiYgaW5wdXQudmFsdWUpIHtcclxuICAgICAgICAgICAgdGhpcy5maWx0ZXJJdGVtcygnJyk7XHJcbiAgICAgICAgICAgIGlucHV0LnZhbHVlID0gJyc7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiDlvIDlp4vmn6Xor6JcclxuICAgICAqIEBwYXJhbSAkZXZlbnQgXHJcbiAgICAgKi9cclxuICAgIHNlYXJjaEl0ZW1zKCRldmVudCkge1xyXG4gICAgICAgIGNvbnN0IHR4dCA9ICRldmVudC50YXJnZXQudmFsdWU7XHJcbiAgICAgICAgdGhpcy5maWx0ZXJJdGVtcyh0eHQpO1xyXG4gICAgfVxyXG4gICAgc2VhcmNoSW5wdXRGb2N1cyhldil7XHJcbiAgICAgICAgaWYoIXRoaXMuaGFzU2V0V2lkdGhTZWFyY2hpbmcpe1xyXG4gICAgICAgICAgICBsZXQgZmluZFBhckVsPXRoaXMuc2VhcmNoSW5wdXQubmF0aXZlRWxlbWVudC5jbG9zZXN0KCcuY2hlY2tib3hncm91cC1oYXMtc2VhcmNoJyk7XHJcbiAgICAgICAgICAgIHRoaXMuaGFzU2V0V2lkdGhTZWFyY2hpbmc9dHJ1ZTtcclxuICAgICAgICAgICAgZmluZFBhckVsLnN0eWxlLndpZHRoPWZpbmRQYXJFbC5vZmZzZXRXaWR0aCsncHgnO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICog6L+H5ruk6aG5XHJcbiAgICAgKiBAcGFyYW0gc2VhcmNoV29yZHMgXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgZmlsdGVySXRlbXMoc2VhcmNoV29yZHMgPSAnJykge1xyXG4gICAgICAgIGxldCBjb2xzID0gW107XHJcbiAgICAgICAgc2VhcmNoV29yZHM9c2VhcmNoV29yZHMudHJpbSgpO1xyXG4gICAgICAgIGlmIChzZWFyY2hXb3Jkcykge1xyXG4gICAgICAgICAgICBsZXQgc2VhcmNoQXJyYXkgPSBzZWFyY2hXb3Jkcy5zcGxpdChcIiBcIik7XHJcbiAgICAgICAgICAgIGxldCB0YWxsQ29sc0NoZWNrVmFsdWU9W107XHJcbiAgICAgICAgICAgIHRoaXMubm90SW5DdXJSZXN1bHQ9W107XHJcbiAgICAgICAgICAgIGNvbHMgPSB0aGlzLmNoZWNrYm94RGF0YVNvdXJjZS5maWx0ZXIoaXRlbSA9PiB7XHJcbiAgICAgICAgICAgICAgICBsZXQgd2FpdFNlYXJjaFN0ciA9IGl0ZW0ubmFtZS50b0xvd2VyQ2FzZSgpO1xyXG4gICAgICAgICAgICAgICAgbGV0IGN1clJlc3VsdD1mYWxzZTtcclxuICAgICAgICAgICAgICAgIC8vIOepuuagvOWBmuS4uuWQjOS4gOS4quWMuemFjeadoeS7tlxyXG4gICAgICAgICAgICAgICAgIGxldCBmaW5kTm90Q29udGFpbiA9IHNlYXJjaEFycmF5LmZpbmRJbmRleChzZWFyY2hTdHIgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBBIEIg5Lik5Liq5p2h5Lu26L+H5rukXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzZWFyY2hTdHIgPT0gJycpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gd2FpdFNlYXJjaFN0ci5pbmRleE9mKHNlYXJjaFN0ci50b0xvd2VyQ2FzZSgpKSA9PSAtMTtcclxuICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIGN1clJlc3VsdD0gZmluZE5vdENvbnRhaW4gPT0gLTE7XHJcbiAgICAgICAgICAgICAgICBpZihjdXJSZXN1bHQpe1xyXG4gICAgICAgICAgICAgICAgICAgIC8v5Zyo5p+l6K+i57uT5p6c5YaFXHJcbiAgICAgICAgICAgICAgICAgICAgaWYodGhpcy5jaGVja1ZhbHVlLnNvbWUoKGNoZWNrSXRlbSk9PmNoZWNrSXRlbT09aXRlbS52YWx1ZSkpe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvL+S4lOWcqOmAieaLqeeahOWAvOiMg+WbtOWGhVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0YWxsQ29sc0NoZWNrVmFsdWUucHVzaChpdGVtLnZhbHVlKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gY3VyUmVzdWx0O1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgdGhpcy5hbGxDb2xzID0gY29scztcclxuICAgICAgICAgICAgdGhpcy5hbGxDb2xzQ2hlY2tWYWx1ZT10YWxsQ29sc0NoZWNrVmFsdWU7XHJcbiAgICAgICAgICAgIC8vIOS4jeWcqOW9k+WJjemAieS4reeahOaVsOaNrlxyXG4gICAgICAgICAgICB0aGlzLm5vdEluQ3VyUmVzdWx0PXRoaXMuY2hlY2tWYWx1ZS5maWx0ZXIoeCA9PiB0YWxsQ29sc0NoZWNrVmFsdWUuaW5kZXhPZih4KSA9PT0gLTEpOyBcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLmFsbENvbHMgPSB0aGlzLmNoZWNrYm94RGF0YVNvdXJjZTtcclxuICAgICAgICAgICAgIC8v5aaC5p6c5piv5p+l6K+i5Ye65YWo6YOo5pWw5o2uXHJcbiAgICAgICAgICAgICB0aGlzLmFsbENvbHNDaGVja1ZhbHVlPVtdLmNvbmNhdCh0aGlzLmNoZWNrVmFsdWUpO1xyXG4gICAgICAgICAgICAgdGhpcy5ub3RJbkN1clJlc3VsdD1bXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8g5pu05pS55YWo6YCJ54q25oCBXHJcbiAgICAgICAgdGhpcy5zZWFyY2hSZXN1bHRJc0NoZWNrQWxsKCk7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIOafpeivoue7k+aenOWFqOmAieeahOeKtuaAgVxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIHNlYXJjaFJlc3VsdElzQ2hlY2tBbGwoKSB7XHJcbiAgICAgICAgLy8g5aaC5p6c5peg57uT5p6cXHJcbiAgICAgICAgaWYgKHRoaXMuYWxsQ29scy5sZW5ndGggPT0gMCkge1xyXG4gICAgICAgICAgICB0aGlzLmNoZWNrZWRBbGwgPSBmYWxzZTtcclxuICAgICAgICAgICAgdGhpcy5jaGVja2FsbENoZWNrYm94RGlzYWJsZWQ9dHJ1ZTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5hbGxDb2xzLmxlbmd0aCA+IHRoaXMuYWxsQ29sc0NoZWNrVmFsdWUubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAvLyDmn6Xor6Lnu5PmnpznmoTplb/luqbmr5Tlt7LpgInlhYPntKDlpJpcclxuICAgICAgICAgICAgICAgIHRoaXMuY2hlY2tlZEFsbCA9IGZhbHNlO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jaGVja2VkQWxsID0gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLmNoZWNrYWxsQ2hlY2tib3hEaXNhYmxlZD1mYWxzZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIOabtOaWsOeKtuaAgVxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIG9ubHlVcGRhdGVDaGVja1ZhbHVlKCl7ICAgICAgICBcclxuICAgICAgICB0aGlzLmNoZWNrVmFsdWU9W10uY29uY2F0KHRoaXMuYWxsQ29sc0NoZWNrVmFsdWUsdGhpcy5ub3RJbkN1clJlc3VsdCk7XHJcbiAgICAgICAgdGhpcy5faXRlbS52YWx1ZS52YWx1ZSA9IHRoaXMuY2hlY2tWYWx1ZTtcclxuICAgIH1cclxuICAgIHByaXZhdGUgIHNldExvY2FsZURhdGEoKXtcclxuICAgICAgICBpZih0aGlzLmVuYWJsZVNlYXJjaCYmdGhpcy5sb2NhbGVTZXJ2aWNlKXtcclxuICAgICAgICAgICAgdGhpcy5zZWFyY2hQbGFjZUhvbGRlcj0gdGhpcy5sb2NhbGVTZXJ2aWNlLmdldFZhbHVlKCdmaWx0ZXJQYW5lbC5zZWFyY2hQbGFjZUhvbGRlcicpfHxcIuivt+i+k+WFpeWQjeensFwiO1xyXG4gICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuIl19