/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, Input, Output, EventEmitter, ComponentFactoryResolver, Injector, ElementRef, TemplateRef, ViewChild, ViewContainerRef } from '@angular/core';
import { PropertyEntity } from '../../entity/property-entity';
import { BsModalService } from '@farris/ui-modal';
import { NotifyService } from '@farris/ui-notify';
var PropertyItemComponent = /** @class */ (function () {
    function PropertyItemComponent(resolver, modalService, injector, notifyServ, el) {
        this.resolver = resolver;
        this.modalService = modalService;
        this.injector = injector;
        this.notifyServ = notifyServ;
        this.el = el;
        this.valueChanged = new EventEmitter();
        this.submitModal = new EventEmitter();
        // 向上触发整体面板刷新
        this.triggerRefreshPanel = new EventEmitter();
        // 下拉框的枚举项
        this.selectOptions = [];
        // 控件类型
        this.itemType = 'string';
        // 数字控件精度
        this.precision = 2;
        // 已废弃
        this.showClearButton = false;
        // 默认值
        this.showDefaultValue = false;
    }
    /**
     * @param {?} changes
     * @return {?}
     */
    PropertyItemComponent.prototype.ngOnChanges = /**
     * @param {?} changes
     * @return {?}
     */
    function (changes) {
        this.refresh();
    };
    /**
     * @return {?}
     */
    PropertyItemComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        // this.refresh();
    };
    /**
     * @return {?}
     */
    PropertyItemComponent.prototype.refresh = /**
     * @return {?}
     */
    function () {
        this.showClearButton = this.elementConfig.showClearButton && !this.elementConfig.readonly;
        /** @type {?} */
        var tmpl;
        // 显示格式
        /** @type {?} */
        var propertyType = this.itemType = this.elementConfig.propertyType;
        switch (propertyType) {
            case 'boolean': {
                this.itemType = 'select';
                this.selectOptions = [{ key: true, value: 'true' }, { key: false, value: 'false' }];
                tmpl = this.selectTmpl;
                break;
            }
            case 'select': {
                this.selectOptions = this.elementConfig.iterator || [];
                tmpl = this.selectTmpl;
                break;
            }
            case 'multiSelect': {
                this.selectOptions = this.elementConfig.iterator || [];
                if (this.elementConfig.multiSelectDataType === 'array') {
                    this.elementValue = this.elementValue ? this.elementValue.toString() : '';
                }
                tmpl = this.multiSelectTmpl;
                break;
            }
            case 'modal': {
                this._convertModalShowValue(this.elementValue);
                tmpl = this.modalTmpl;
                break;
            }
            case 'number': {
                this.precision = this.elementConfig.decimals === undefined ? 2 : this.elementConfig.decimals;
                tmpl = this.numberTmpl;
                break;
            }
            case 'string': {
                if (this.elementConfig.readonly) {
                    this._convertModalShowValue(this.elementValue);
                }
                tmpl = this.stringTmpl;
                break;
            }
            /** 已废弃，请使用editableSelect */
            case 'boolOrExp': {
                this.selectOptions = [{ key: true, value: 'true' }, { key: false, value: 'false' }];
                tmpl = this.boolOrExpTmpl;
                break;
            }
            case 'date': {
                tmpl = this.dateTmpl;
                break;
            }
            case 'datetime': {
                tmpl = this.datetimeTmpl;
                break;
            }
            case 'editableSelect': {
                this.selectOptions = this.elementConfig.iterator || [];
                tmpl = this.editableSelectTmpl;
                break;
            }
        }
        // 默认值
        if (Object.keys(this.elementConfig).indexOf('defaultValue') > -1) {
            if (this.elementValue === undefined || this.elementValue === null) {
                this.elementValue = this.elementConfig.defaultValue;
            }
            this.showDefaultValue = true;
        }
        // 是否显示
        if (Object.keys(this.elementConfig).indexOf('visible') < 0) {
            this.elementConfig.visible = true;
        }
        // 创建模板
        if (tmpl && (this.propItem.length === 0 || this.propertyOldType !== this.itemType)) {
            this.propItem.clear();
            this.propItem.createEmbeddedView(tmpl);
            this.propertyOldType = this.itemType;
        }
    };
    /**
     * 鼠标移入 --已废弃
     */
    /**
     * 鼠标移入 --已废弃
     * @return {?}
     */
    PropertyItemComponent.prototype.onmouseover = /**
     * 鼠标移入 --已废弃
     * @return {?}
     */
    function () {
        if (!this.elementConfig.showClearButton) {
            return;
        }
        if (!this.showClearButton) {
            this.showClearButton = true;
        }
    };
    /**
     * 鼠标离开 --已废弃
     */
    /**
     * 鼠标离开 --已废弃
     * @return {?}
     */
    PropertyItemComponent.prototype.onmouseleave = /**
     * 鼠标离开 --已废弃
     * @return {?}
     */
    function () {
        if (!this.elementConfig.showClearButton) {
            return;
        }
        this.showClearButton = false;
    };
    /**
     * 清除模态框内容
     */
    /**
     * 清除模态框内容
     * @return {?}
     */
    PropertyItemComponent.prototype.modalClear = /**
     * 清除模态框内容
     * @return {?}
     */
    function () {
        // 数据转换
        this._convertModalShowValue(null);
        // 若有清除后事件，先执行方法
        if (Object.keys(this.elementConfig).indexOf('afterClickClearButton') > -1 &&
            typeof (this.elementConfig.afterClickClearButton) === 'function') {
            this.elementConfig.afterClickClearButton(this.elementValue);
        }
        /** @type {?} */
        var changeObject = {
            propertyID: this.elementConfig.propertyID,
            propertyValue: null
        };
        this.submitModal.emit({ changeObject: changeObject, parameters: null });
    };
    /**
     * 变更属性值
     */
    /**
     * 变更属性值
     * @param {?} e
     * @return {?}
     */
    PropertyItemComponent.prototype.changeValue = /**
     * 变更属性值
     * @param {?} e
     * @return {?}
     */
    function (e) {
        /** @type {?} */
        var value = this.elementValue;
        // 文本控件限制输入字符
        if (value && this.elementConfig.propertyType === 'string' && !this.elementConfig.readonly &&
            this.elementConfig.notAllowedChars && this.elementConfig.notAllowedChars.length) {
            this.elementConfig.notAllowedChars.forEach((/**
             * @param {?} c
             * @return {?}
             */
            function (c) {
                if (typeof (c) === 'object') {
                    value = value.replace(c, '');
                }
                else if (typeof (c) === 'string') {
                    value = value.replace(new RegExp(c, 'g'), '');
                }
            }));
            this.elementValue = value;
        }
        // 多选控件返回数组格式的数据
        if (this.itemType === 'multiSelect' && this.elementConfig.multiSelectDataType === 'array') {
            value = this.elementValue ? this.elementValue.split(',') : '';
        }
        /** @type {?} */
        var changeObject = {
            propertyID: this.elementConfig.propertyID,
            propertyValue: value
        };
        this.valueChanged.emit({ changeObject: changeObject });
        if (this.elementConfig.refreshPanelAfterChanged) {
            this.triggerRefreshPanel.emit();
        }
    };
    /**
     * farris 日期控件的变更事件
     * @param e e
     */
    /**
     * farris 日期控件的变更事件
     * @param {?} e e
     * @return {?}
     */
    PropertyItemComponent.prototype.changeDateValue = /**
     * farris 日期控件的变更事件
     * @param {?} e e
     * @return {?}
     */
    function (e) {
        /** @type {?} */
        var value = e.formatted;
        /** @type {?} */
        var changeObject = {
            propertyID: this.elementConfig.propertyID,
            propertyValue: value
        };
        this.valueChanged.emit({ changeObject: changeObject });
        if (this.elementConfig.refreshPanelAfterChanged) {
            this.triggerRefreshPanel.emit();
        }
    };
    /**
     * 自定义编辑器使用模态框打开
     */
    /**
     * 自定义编辑器使用模态框打开
     * @return {?}
     */
    PropertyItemComponent.prototype.openModal = /**
     * 自定义编辑器使用模态框打开
     * @return {?}
     */
    function () {
        if (this.elementConfig.readonly) {
            return;
        }
        if (Object.keys(this.elementConfig).indexOf('beforeOpenModal') > -1 && typeof (this.elementConfig.beforeOpenModal) === 'function') {
            /** @type {?} */
            var result = this.elementConfig.beforeOpenModal();
            if (result && !result.result) {
                this.notifyServ.warning((/** @type {?} */ ({
                    title: '系统提示', msg: result.message, timeout: 3000
                })));
                return;
            }
        }
        this.createEditorComponent();
    };
    /**
     * 创建自定义编辑器
     */
    /**
     * 创建自定义编辑器
     * @private
     * @return {?}
     */
    PropertyItemComponent.prototype.createEditorComponent = /**
     * 创建自定义编辑器
     * @private
     * @return {?}
     */
    function () {
        var _this = this;
        /** @type {?} */
        var editor = this.elementConfig.editor;
        if (!editor) {
            return;
        }
        // 创建模态框组件
        /** @type {?} */
        var compFactory = this.resolver.resolveComponentFactory(editor);
        /** @type {?} */
        var compRef = compFactory.create(this.injector);
        compRef.instance.value = this.elementValue;
        if (this.elementConfig.editorParams) { // 编辑器需要的额外参数
            compRef.instance.editorParams = this.elementConfig.editorParams;
        }
        /** @type {?} */
        var modalConfig = compRef.instance.modalConfig;
        if (!modalConfig) {
            modalConfig = {
                title: '属性配置',
                width: 800,
                height: 400,
                showButtons: false
            };
        }
        else if (modalConfig.showButtons) {
            modalConfig.buttons = compRef.instance.modalFooter;
        }
        /** @type {?} */
        var dialog = this.modalService.show(compRef, modalConfig);
        // 监听关闭模态框
        if (compRef.instance.closeModal && compRef.instance.closeModal instanceof EventEmitter) {
            compRef.instance.closeModal.subscribe((/**
             * @param {?} data
             * @return {?}
             */
            function (data) {
                // 数据转换
                if (data) {
                    _this._convertModalShowValue(data);
                    /** @type {?} */
                    var changeObject = {
                        propertyID: _this.elementConfig.propertyID,
                        propertyValue: data
                    };
                    _this.valueChanged.emit({ changeObject: changeObject });
                }
                dialog.close();
            }));
        }
        // 弹出框关闭事件，带参数，格式为{ value, parameters }
        if (compRef.instance.submitModal && compRef.instance.submitModal instanceof EventEmitter) {
            compRef.instance.submitModal.subscribe((/**
             * @param {?} data
             * @return {?}
             */
            function (data) {
                if (!data) {
                    dialog.close();
                    return;
                }
                var value = data.value, parameters = data.parameters;
                // 数据转换
                _this._convertModalShowValue(value);
                /** @type {?} */
                var changeObject = {
                    propertyID: _this.elementConfig.propertyID,
                    propertyValue: value
                };
                _this.submitModal.emit({ changeObject: changeObject, parameters: parameters });
                dialog.close();
            }));
        }
    };
    /**
     * 模态框场景下将属性值转换为输入框中显示的值
     * @param value
     */
    /**
     * 模态框场景下将属性值转换为输入框中显示的值
     * @private
     * @param {?} value
     * @return {?}
     */
    PropertyItemComponent.prototype._convertModalShowValue = /**
     * 模态框场景下将属性值转换为输入框中显示的值
     * @private
     * @param {?} value
     * @return {?}
     */
    function (value) {
        if (this.elementConfig.converter) {
            this.elementShowValue = this.elementConfig.converter.convertTo(value);
            return;
        }
        if (value && value instanceof Object) {
            this.elementShowValue = JSON.stringify(value);
            return;
        }
        this.elementShowValue = value;
    };
    PropertyItemComponent.decorators = [
        { type: Component, args: [{
                    selector: 'webide-property-item',
                    template: "<div class=\"farris-group-wrap property-item\" [hidden]=\"!elementConfig.visible\">\r\n  <div class=\"form-group farris-form-group\">\r\n   <label class=\"col-form-label\">\r\n      <span class=\"farris-label-text\" farrisPopover [popover]=\"popTemplate\" [popoverTitle]=\"elementConfig.propertyName\"\r\n        container=\"body\" placement=\"left\" triggers=\"hover\">{{elementConfig.propertyName}}</span>\r\n    </label> \r\n    <!-- <label class=\"col-form-label\">\r\n      <span class=\"farris-label-text\" farrisPopover [popover]=\"popTemplate\" container=\"body\"\r\n        triggers=\"hover\">{{elementConfig.propertyName}}</span>\r\n    </label> -->\r\n    <!-- <label class=\"col-form-label\">\r\n      <span class=\"farris-label-text\">{{elementConfig.propertyName}}</span>\r\n    </label> -->\r\n\r\n    <ng-container #propItem> </ng-container>\r\n\r\n    <!--\u6587\u672C-->\r\n    <ng-template #stringTmpl>\r\n      <div class=\"farris-input-wrap\">\r\n        <input type=\"input\" class=\"form-control form-control-sm\" [(ngModel)]=\"elementValue\" (blur)=\"changeValue($event)\"\r\n          *ngIf=\"!elementConfig.readonly\">\r\n        <input type=\"input\" class=\"form-control form-control-sm\" [(ngModel)]=\"elementShowValue\" [readonly]=\"'readonly'\"\r\n          *ngIf=\"elementConfig.readonly\">\r\n      </div>\r\n    </ng-template>\r\n\r\n    <ng-template #numberTmpl>\r\n      <!-- \u6570\u5B57-->\r\n      <div class=\"farris-input-wrap\">\r\n        <farris-number-spinner [(ngModel)]=\"elementValue\" [readonly]=\"elementConfig.readonly\" [precision]=\"precision\"\r\n          [autoDecimal]=\"true\" [min]=\"elementConfig.min\" [max]=\"elementConfig.max\" [canNull]=\"true\"\r\n          [bigNumber]=\"elementConfig.isBigNumber\" (ngModelChange)=\"changeValue($event)\">\r\n        </farris-number-spinner>\r\n      </div>\r\n    </ng-template>\r\n\r\n    <!--\u4E0B\u62C9\u5217\u8868-->\r\n    <ng-template #selectTmpl>\r\n      <div class=\"farris-input-wrap\">\r\n        <farris-combo-list [(ngModel)]=\"elementValue\" [idField]=\"'key'\" [textField]=\"'value'\" [data]=\"selectOptions\"\r\n          [readonly]=\"elementConfig.readonly\" [editable]=\"false\" [enableClear]=\"false\" [enableCancelSelected]=\"false\"\r\n          (valueChange)=\"changeValue($event)\">\r\n        </farris-combo-list>\r\n      </div>\r\n    </ng-template>\r\n\r\n    <!--\u53EF\u7F16\u8F91\u7684\u4E0B\u62C9\u5217\u8868\uFF08\u6B64\u5904\u662F\u6539\u52A8\u540E\u7684farris combolist\uFF0Cfarris combolist\uFF09-->\r\n    <ng-template #boolOrExpTmpl>\r\n      <div class=\"farris-input-wrap\">\r\n        <farris-editable-combo-list [data]=\"selectOptions\" textField=\"value\" idField=\"key\" [(ngModel)]=\"elementValue\"\r\n          (valueChange)=\"changeValue($event)\" [editable]=\"true\" [readonly]=\"elementConfig.readonly?true:false\">\r\n        </farris-editable-combo-list>\r\n      </div>\r\n    </ng-template>\r\n\r\n    <!-- \u53EF\u7F16\u8F91\u7684\u4E0B\u62C9\u6846-->\r\n    <ng-template #editableSelectTmpl>\r\n      <div class=\"farris-input-wrap\">\r\n        <farris-combo-list [(ngModel)]=\"elementValue\" [idField]=\"'key'\" [textField]=\"'value'\" [data]=\"selectOptions\"\r\n          [readonly]=\"elementConfig.readonly\" [enableClear]=\"false\" [enableCancelSelected]=\"false\" [nosearch]=\"true\"\r\n          (ngModelChange)=\"changeValue($event)\">\r\n        </farris-combo-list>\r\n      </div>\r\n    </ng-template>\r\n\r\n    <!--\u4E0B\u62C9\u591A\u9009-->\r\n    <ng-template #multiSelectTmpl>\r\n      <div class=\"farris-input-wrap\">\r\n        <farris-combo-list [(ngModel)]=\"elementValue\" [idField]=\"'key'\" [textField]=\"'value'\" [data]=\"selectOptions\"\r\n          [readonly]=\"elementConfig.readonly\" [editable]=\"false\" [multiSelect]=\"true\" [enableClear]=\"false\"\r\n          (ngModelChange)=\"changeValue($event)\">\r\n        </farris-combo-list>\r\n      </div>\r\n    </ng-template>\r\n\r\n    <!--\u65E5\u671F-->\r\n    <ng-template #dateTmpl>\r\n      <div class=\"farris-input-wrap\">\r\n        <farris-datepicker [(ngModel)]=\"elementValue\" [editable]=\"false\" [showTime]=\"false\" [dateFormat]=\"'yyyy-MM-dd'\"\r\n          [readonly]=\"elementConfig.readonly\" (valueChange)=\"changeDateValue($event)\" [returnType]=\"'string'\"\r\n          [maxDate]=\"elementConfig.max\" [minDate]=\"elementConfig.min\">\r\n        </farris-datepicker>\r\n      </div>\r\n    </ng-template>\r\n\r\n\r\n    <!-- \u65E5\u671F\u65F6\u95F4 -->\r\n    <ng-template #datetimeTmpl>\r\n      <div class=\"farris-input-wrap\">\r\n        <farris-datepicker [(ngModel)]=\"elementValue\" [editable]=\"false\" [showTime]=\"true\"\r\n          [dateFormat]=\"'yyyy-MM-dd HH:mm:ss'\" [readonly]=\"elementConfig.readonly\"\r\n          (valueChange)=\"changeDateValue($event)\" [returnType]=\"'string'\" [maxDate]=\"elementConfig.max\"\r\n          [minDate]=\"elementConfig.min\">\r\n        </farris-datepicker>\r\n      </div>\r\n    </ng-template>\r\n\r\n\r\n    <!-- \u6A21\u6001\u6846 -->\r\n    <ng-template #modalTmpl>\r\n      <div class=\"farris-input-wrap modalIcon\">\r\n        <input type=\"input\" class=\"form-control form-control-sm\" [(ngModel)]=\"elementShowValue\" readonly>\r\n        <span *ngIf=\"showClearButton\" class=\"showClearButton\" (click)=\"modalClear()\">\r\n          <i class=\"material-icons clearIcon\">close</i>\r\n        </span>\r\n        <i class=\"material-icons moreIcon\" (click)=\"openModal()\">filter_none</i>\r\n      </div>\r\n    </ng-template>\r\n\r\n  </div>\r\n</div>\r\n\r\n\r\n<ng-template #popTemplate>\r\n  <div *ngIf=\"elementConfig.propertyID\">\r\n    <span>\u7F16\u53F7\uFF1A </span> {{elementConfig.propertyID}}</div>\r\n  <div *ngIf=\"elementConfig.description\">\r\n    <span>\u63CF\u8FF0\uFF1A </span> {{elementConfig.description}}</div>\r\n</ng-template>",
                    styles: [".property-item .form-group{margin-bottom:2px}.property-item .modalIcon .showClearButton{display:none}.property-item .modalIcon:hover .showClearButton{display:block}.property-item .modalIcon input{padding-right:30px}.property-item .modalIcon .moreIcon{position:absolute;top:6px;right:6px;cursor:pointer;font-size:16px;color:#758a96}.property-item .modalIcon .clearIcon{position:absolute;top:5px;right:30px;cursor:pointer;font-size:19px;color:#758a96}.property-item .form-control[readonly]{background-color:#fff}.property-item .form-control:disabled,.property-item .form-control[readonly]{color:#4b4c4c}"]
                }] }
    ];
    /** @nocollapse */
    PropertyItemComponent.ctorParameters = function () { return [
        { type: ComponentFactoryResolver },
        { type: BsModalService },
        { type: Injector },
        { type: NotifyService },
        { type: ElementRef }
    ]; };
    PropertyItemComponent.propDecorators = {
        elementConfig: [{ type: Input }],
        elementValue: [{ type: Input }],
        valueChanged: [{ type: Output }],
        submitModal: [{ type: Output }],
        triggerRefreshPanel: [{ type: Output }],
        propItem: [{ type: ViewChild, args: ['propItem', { read: ViewContainerRef },] }],
        stringTmpl: [{ type: ViewChild, args: ['stringTmpl',] }],
        numberTmpl: [{ type: ViewChild, args: ['numberTmpl',] }],
        selectTmpl: [{ type: ViewChild, args: ['selectTmpl',] }],
        boolOrExpTmpl: [{ type: ViewChild, args: ['boolOrExpTmpl',] }],
        multiSelectTmpl: [{ type: ViewChild, args: ['multiSelectTmpl',] }],
        dateTmpl: [{ type: ViewChild, args: ['dateTmpl',] }],
        datetimeTmpl: [{ type: ViewChild, args: ['datetimeTmpl',] }],
        modalTmpl: [{ type: ViewChild, args: ['modalTmpl',] }],
        editableSelectTmpl: [{ type: ViewChild, args: ['editableSelectTmpl',] }]
    };
    return PropertyItemComponent;
}());
export { PropertyItemComponent };
if (false) {
    /** @type {?} */
    PropertyItemComponent.prototype.elementConfig;
    /** @type {?} */
    PropertyItemComponent.prototype.elementValue;
    /** @type {?} */
    PropertyItemComponent.prototype.valueChanged;
    /** @type {?} */
    PropertyItemComponent.prototype.submitModal;
    /** @type {?} */
    PropertyItemComponent.prototype.triggerRefreshPanel;
    /** @type {?} */
    PropertyItemComponent.prototype.propItem;
    /** @type {?} */
    PropertyItemComponent.prototype.stringTmpl;
    /** @type {?} */
    PropertyItemComponent.prototype.numberTmpl;
    /** @type {?} */
    PropertyItemComponent.prototype.selectTmpl;
    /** @type {?} */
    PropertyItemComponent.prototype.boolOrExpTmpl;
    /** @type {?} */
    PropertyItemComponent.prototype.multiSelectTmpl;
    /** @type {?} */
    PropertyItemComponent.prototype.dateTmpl;
    /** @type {?} */
    PropertyItemComponent.prototype.datetimeTmpl;
    /** @type {?} */
    PropertyItemComponent.prototype.modalTmpl;
    /** @type {?} */
    PropertyItemComponent.prototype.editableSelectTmpl;
    /** @type {?} */
    PropertyItemComponent.prototype.propertyOldType;
    /** @type {?} */
    PropertyItemComponent.prototype.elementShowValue;
    /** @type {?} */
    PropertyItemComponent.prototype.selectOptions;
    /** @type {?} */
    PropertyItemComponent.prototype.itemType;
    /** @type {?} */
    PropertyItemComponent.prototype.precision;
    /** @type {?} */
    PropertyItemComponent.prototype.showClearButton;
    /** @type {?} */
    PropertyItemComponent.prototype.showDefaultValue;
    /**
     * @type {?}
     * @private
     */
    PropertyItemComponent.prototype.resolver;
    /**
     * @type {?}
     * @private
     */
    PropertyItemComponent.prototype.modalService;
    /**
     * @type {?}
     * @private
     */
    PropertyItemComponent.prototype.injector;
    /**
     * @type {?}
     * @private
     */
    PropertyItemComponent.prototype.notifyServ;
    /** @type {?} */
    PropertyItemComponent.prototype.el;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicHJvcGVydHktaXRlbS5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZmFycmlzL2lkZS1wcm9wZXJ0eS1wYW5lbC8iLCJzb3VyY2VzIjpbImxpYi9wcm9wZXJ0eS1wYW5lbC9jb21wb25lbnRzL3Byb3BlcnR5LWl0ZW0vcHJvcGVydHktaXRlbS5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUFBLE9BQU8sRUFDTCxTQUFTLEVBQVUsS0FBSyxFQUFFLE1BQU0sRUFDaEMsWUFBWSxFQUFFLHdCQUF3QixFQUFFLFFBQVEsRUFBRSxVQUFVLEVBQWtCLFdBQVcsRUFBRSxTQUFTLEVBQUUsZ0JBQWdCLEVBQ3ZILE1BQU0sZUFBZSxDQUFDO0FBQ3ZCLE9BQU8sRUFBRSxjQUFjLEVBQUUsTUFBTSw4QkFBOEIsQ0FBQztBQUM5RCxPQUFPLEVBQUUsY0FBYyxFQUFFLE1BQU0sa0JBQWtCLENBQUM7QUFDbEQsT0FBTyxFQUFFLGFBQWEsRUFBaUIsTUFBTSxtQkFBbUIsQ0FBQztBQUVqRTtJQW1ERSwrQkFDVSxRQUFrQyxFQUFVLFlBQTRCLEVBQ3hFLFFBQWtCLEVBQVUsVUFBeUIsRUFBUyxFQUFjO1FBRDVFLGFBQVEsR0FBUixRQUFRLENBQTBCO1FBQVUsaUJBQVksR0FBWixZQUFZLENBQWdCO1FBQ3hFLGFBQVEsR0FBUixRQUFRLENBQVU7UUFBVSxlQUFVLEdBQVYsVUFBVSxDQUFlO1FBQVMsT0FBRSxHQUFGLEVBQUUsQ0FBWTtRQTdDNUUsaUJBQVksR0FBRyxJQUFJLFlBQVksRUFBTyxDQUFDO1FBQ3ZDLGdCQUFXLEdBQUcsSUFBSSxZQUFZLEVBQU8sQ0FBQzs7UUFHdEMsd0JBQW1CLEdBQUcsSUFBSSxZQUFZLEVBQU8sQ0FBQzs7UUF5QnhELGtCQUFhLEdBQUcsRUFBRSxDQUFDOztRQUduQixhQUFRLEdBQUcsUUFBUSxDQUFDOztRQUdwQixjQUFTLEdBQUcsQ0FBQyxDQUFDOztRQUdkLG9CQUFlLEdBQUcsS0FBSyxDQUFDOztR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QUFTLFNBQUMsaUJBQWlCOzJCQUMzQixTQUFTLFNBQUMsVUFBVTsrQkFDcEIsU0FBUyxTQUFDLGNBQWM7NEJBQ3hCLFNBQVMsU0FBQyxXQUFXO3FDQUNyQixTQUFTLFNBQUMsb0JBQW9COztJQTZVakMsNEJBQUM7Q0FBQSxBQXZXRCxJQXVXQztTQWxXWSxxQkFBcUI7OztJQUNoQyw4Q0FBdUM7O0lBQ3ZDLDZDQUEyQjs7SUFDM0IsNkNBQWlEOztJQUNqRCw0Q0FBZ0Q7O0lBR2hELG9EQUF3RDs7SUFHeEQseUNBQThFOztJQUc5RSwyQ0FBc0Q7O0lBQ3RELDJDQUFzRDs7SUFDdEQsMkNBQXNEOztJQUN0RCw4Q0FBNEQ7O0lBQzVELGdEQUFnRTs7SUFDaEUseUNBQWtEOztJQUNsRCw2Q0FBMEQ7O0lBQzFELDBDQUFvRDs7SUFDcEQsbURBQXNFOztJQUt0RSxnREFBd0I7O0lBR3hCLGlEQUFzQjs7SUFHdEIsOENBQW1COztJQUduQix5Q0FBb0I7O0lBR3BCLDBDQUFjOztJQUdkLGdEQUF3Qjs7SUFHeEIsaURBQXlCOzs7OztJQUd2Qix5Q0FBMEM7Ozs7O0lBQUUsNkNBQW9DOzs7OztJQUNoRix5Q0FBMEI7Ozs7O0lBQUUsMkNBQWlDOztJQUFFLG1DQUFxQiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XHJcbiAgQ29tcG9uZW50LCBPbkluaXQsIElucHV0LCBPdXRwdXQsIE9uQ2hhbmdlcywgU2ltcGxlQ2hhbmdlcyxcclxuICBFdmVudEVtaXR0ZXIsIENvbXBvbmVudEZhY3RvcnlSZXNvbHZlciwgSW5qZWN0b3IsIEVsZW1lbnRSZWYsIEFwcGxpY2F0aW9uUmVmLCBUZW1wbGF0ZVJlZiwgVmlld0NoaWxkLCBWaWV3Q29udGFpbmVyUmVmXHJcbn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IFByb3BlcnR5RW50aXR5IH0gZnJvbSAnLi4vLi4vZW50aXR5L3Byb3BlcnR5LWVudGl0eSc7XHJcbmltcG9ydCB7IEJzTW9kYWxTZXJ2aWNlIH0gZnJvbSAnQGZhcnJpcy91aS1tb2RhbCc7XHJcbmltcG9ydCB7IE5vdGlmeVNlcnZpY2UsIE5vdGlmeU9wdGlvbnMgfSBmcm9tICdAZmFycmlzL3VpLW5vdGlmeSc7XHJcblxyXG5AQ29tcG9uZW50KHtcclxuICBzZWxlY3RvcjogJ3dlYmlkZS1wcm9wZXJ0eS1pdGVtJyxcclxuICB0ZW1wbGF0ZVVybDogJy4vcHJvcGVydHktaXRlbS5jb21wb25lbnQuaHRtbCcsXHJcbiAgc3R5bGVVcmxzOiBbJy4vcHJvcGVydHktaXRlbS5jb21wb25lbnQuY3NzJ11cclxufSlcclxuZXhwb3J0IGNsYXNzIFByb3BlcnR5SXRlbUNvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCwgT25DaGFuZ2VzIHtcclxuICBASW5wdXQoKSBlbGVtZW50Q29uZmlnOiBQcm9wZXJ0eUVudGl0eTtcclxuICBASW5wdXQoKSBlbGVtZW50VmFsdWU6IGFueTtcclxuICBAT3V0cHV0KCkgdmFsdWVDaGFuZ2VkID0gbmV3IEV2ZW50RW1pdHRlcjxhbnk+KCk7XHJcbiAgQE91dHB1dCgpIHN1Ym1pdE1vZGFsID0gbmV3IEV2ZW50RW1pdHRlcjxhbnk+KCk7XHJcblxyXG4gIC8vIOWQkeS4iuinpuWPkeaVtOS9k+mdouadv+WIt+aWsFxyXG4gIEBPdXRwdXQoKSB0cmlnZ2VyUmVmcmVzaFBhbmVsID0gbmV3IEV2ZW50RW1pdHRlcjxhbnk+KCk7XHJcblxyXG4gIC8vIOaOp+S7tuWuueWZqFxyXG4gIEBWaWV3Q2hpbGQoJ3Byb3BJdGVtJywgeyByZWFkOiBWaWV3Q29udGFpbmVyUmVmIH0pIHByb3BJdGVtOiBWaWV3Q29udGFpbmVyUmVmO1xyXG5cclxuICAvLyDmjqfku7bmqKHmnb9cclxuICBAVmlld0NoaWxkKCdzdHJpbmdUbXBsJykgc3RyaW5nVG1wbDogVGVtcGxhdGVSZWY8YW55PjtcclxuICBAVmlld0NoaWxkKCdudW1iZXJUbXBsJykgbnVtYmVyVG1wbDogVGVtcGxhdGVSZWY8YW55PjtcclxuICBAVmlld0NoaWxkKCdzZWxlY3RUbXBsJykgc2VsZWN0VG1wbDogVGVtcGxhdGVSZWY8YW55PjtcclxuICBAVmlld0NoaWxkKCdib29sT3JFeHBUbXBsJykgYm9vbE9yRXhwVG1wbDogVGVtcGxhdGVSZWY8YW55PjtcclxuICBAVmlld0NoaWxkKCdtdWx0aVNlbGVjdFRtcGwnKSBtdWx0aVNlbGVjdFRtcGw6IFRlbXBsYXRlUmVmPGFueT47XHJcbiAgQFZpZXdDaGlsZCgnZGF0ZVRtcGwnKSBkYXRlVG1wbDogVGVtcGxhdGVSZWY8YW55PjtcclxuICBAVmlld0NoaWxkKCdkYXRldGltZVRtcGwnKSBkYXRldGltZVRtcGw6IFRlbXBsYXRlUmVmPGFueT47XHJcbiAgQFZpZXdDaGlsZCgnbW9kYWxUbXBsJykgbW9kYWxUbXBsOiBUZW1wbGF0ZVJlZjxhbnk+O1xyXG4gIEBWaWV3Q2hpbGQoJ2VkaXRhYmxlU2VsZWN0VG1wbCcpIGVkaXRhYmxlU2VsZWN0VG1wbDogVGVtcGxhdGVSZWY8YW55PjtcclxuXHJcblxyXG5cclxuICAvLyDmjqfku7bnsbvlnostLeeUqOS6juWMuuWIhuWKqOaAgeWPmOabtOaOp+S7tuexu+Wei+eahOWcuuaZr++8mumcgOimgemHjeaWsOa4suafk+aooeadv1xyXG4gIHByb3BlcnR5T2xkVHlwZTogc3RyaW5nO1xyXG5cclxuICAvLyDmqKHmgIHmoYbnsbvlnovnmoTlsZ7mgKc65bGe5oCn5qGG55qE5bGV56S65YC8XHJcbiAgZWxlbWVudFNob3dWYWx1ZTogYW55O1xyXG5cclxuICAvLyDkuIvmi4nmoYbnmoTmnprkuL7poblcclxuICBzZWxlY3RPcHRpb25zID0gW107XHJcblxyXG4gIC8vIOaOp+S7tuexu+Wei1xyXG4gIGl0ZW1UeXBlID0gJ3N0cmluZyc7XHJcblxyXG4gIC8vIOaVsOWtl+aOp+S7tueyvuW6plxyXG4gIHByZWNpc2lvbiA9IDI7XHJcblxyXG4gIC8vIOW3suW6n+W8g1xyXG4gIHNob3dDbGVhckJ1dHRvbiA9IGZhbHNlO1xyXG5cclxuICAvLyDpu5jorqTlgLxcclxuICBzaG93RGVmYXVsdFZhbHVlID0gZmFsc2U7XHJcblxyXG4gIGNvbnN0cnVjdG9yKFxyXG4gICAgcHJpdmF0ZSByZXNvbHZlcjogQ29tcG9uZW50RmFjdG9yeVJlc29sdmVyLCBwcml2YXRlIG1vZGFsU2VydmljZTogQnNNb2RhbFNlcnZpY2UsXHJcbiAgICBwcml2YXRlIGluamVjdG9yOiBJbmplY3RvciwgcHJpdmF0ZSBub3RpZnlTZXJ2OiBOb3RpZnlTZXJ2aWNlLCBwdWJsaWMgZWw6IEVsZW1lbnRSZWYpIHtcclxuICB9XHJcblxyXG4gIG5nT25DaGFuZ2VzKGNoYW5nZXM6IFNpbXBsZUNoYW5nZXMpIHtcclxuICAgIHRoaXMucmVmcmVzaCgpO1xyXG4gIH1cclxuXHJcbiAgbmdPbkluaXQoKSB7XHJcbiAgICAvLyB0aGlzLnJlZnJlc2goKTtcclxuICB9XHJcblxyXG4gIHJlZnJlc2goKSB7XHJcbiAgICB0aGlzLnNob3dDbGVhckJ1dHRvbiA9IHRoaXMuZWxlbWVudENvbmZpZy5zaG93Q2xlYXJCdXR0b24gJiYgIXRoaXMuZWxlbWVudENvbmZpZy5yZWFkb25seTtcclxuXHJcbiAgICBsZXQgdG1wbDogVGVtcGxhdGVSZWY8YW55PjtcclxuICAgIC8vIOaYvuekuuagvOW8j1xyXG4gICAgY29uc3QgcHJvcGVydHlUeXBlID0gdGhpcy5pdGVtVHlwZSA9IHRoaXMuZWxlbWVudENvbmZpZy5wcm9wZXJ0eVR5cGU7XHJcbiAgICBzd2l0Y2ggKHByb3BlcnR5VHlwZSkge1xyXG4gICAgICBjYXNlICdib29sZWFuJzoge1xyXG4gICAgICAgIHRoaXMuaXRlbVR5cGUgPSAnc2VsZWN0JztcclxuICAgICAgICB0aGlzLnNlbGVjdE9wdGlvbnMgPSBbeyBrZXk6IHRydWUsIHZhbHVlOiAndHJ1ZScgfSwgeyBrZXk6IGZhbHNlLCB2YWx1ZTogJ2ZhbHNlJyB9XTtcclxuXHJcbiAgICAgICAgdG1wbCA9IHRoaXMuc2VsZWN0VG1wbDtcclxuICAgICAgICBicmVhaztcclxuICAgICAgfVxyXG4gICAgICBjYXNlICdzZWxlY3QnOiB7XHJcbiAgICAgICAgdGhpcy5zZWxlY3RPcHRpb25zID0gdGhpcy5lbGVtZW50Q29uZmlnLml0ZXJhdG9yIHx8IFtdO1xyXG5cclxuICAgICAgICB0bXBsID0gdGhpcy5zZWxlY3RUbXBsO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICB9XHJcbiAgICAgIGNhc2UgJ211bHRpU2VsZWN0Jzoge1xyXG4gICAgICAgIHRoaXMuc2VsZWN0T3B0aW9ucyA9IHRoaXMuZWxlbWVudENvbmZpZy5pdGVyYXRvciB8fCBbXTtcclxuICAgICAgICBpZiAodGhpcy5lbGVtZW50Q29uZmlnLm11bHRpU2VsZWN0RGF0YVR5cGUgPT09ICdhcnJheScpIHtcclxuICAgICAgICAgIHRoaXMuZWxlbWVudFZhbHVlID0gdGhpcy5lbGVtZW50VmFsdWUgPyB0aGlzLmVsZW1lbnRWYWx1ZS50b1N0cmluZygpIDogJyc7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0bXBsID0gdGhpcy5tdWx0aVNlbGVjdFRtcGw7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIH1cclxuICAgICAgY2FzZSAnbW9kYWwnOiB7XHJcbiAgICAgICAgdGhpcy5fY29udmVydE1vZGFsU2hvd1ZhbHVlKHRoaXMuZWxlbWVudFZhbHVlKTtcclxuXHJcbiAgICAgICAgdG1wbCA9IHRoaXMubW9kYWxUbXBsO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICB9XHJcbiAgICAgIGNhc2UgJ251bWJlcic6IHtcclxuICAgICAgICB0aGlzLnByZWNpc2lvbiA9IHRoaXMuZWxlbWVudENvbmZpZy5kZWNpbWFscyA9PT0gdW5kZWZpbmVkID8gMiA6IHRoaXMuZWxlbWVudENvbmZpZy5kZWNpbWFscztcclxuXHJcbiAgICAgICAgdG1wbCA9IHRoaXMubnVtYmVyVG1wbDtcclxuICAgICAgICBicmVhaztcclxuICAgICAgfVxyXG4gICAgICBjYXNlICdzdHJpbmcnOiB7XHJcbiAgICAgICAgaWYgKHRoaXMuZWxlbWVudENvbmZpZy5yZWFkb25seSkge1xyXG4gICAgICAgICAgdGhpcy5fY29udmVydE1vZGFsU2hvd1ZhbHVlKHRoaXMuZWxlbWVudFZhbHVlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdG1wbCA9IHRoaXMuc3RyaW5nVG1wbDtcclxuICAgICAgICBicmVhaztcclxuICAgICAgfVxyXG4gICAgICAvKiog5bey5bqf5byD77yM6K+35L2/55SoZWRpdGFibGVTZWxlY3QgKi9cclxuICAgICAgY2FzZSAnYm9vbE9yRXhwJzoge1xyXG4gICAgICAgIHRoaXMuc2VsZWN0T3B0aW9ucyA9IFt7IGtleTogdHJ1ZSwgdmFsdWU6ICd0cnVlJyB9LCB7IGtleTogZmFsc2UsIHZhbHVlOiAnZmFsc2UnIH1dO1xyXG5cclxuICAgICAgICB0bXBsID0gdGhpcy5ib29sT3JFeHBUbXBsO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICB9XHJcbiAgICAgIGNhc2UgJ2RhdGUnOiB7XHJcbiAgICAgICAgdG1wbCA9IHRoaXMuZGF0ZVRtcGw7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIH1cclxuICAgICAgY2FzZSAnZGF0ZXRpbWUnOiB7XHJcbiAgICAgICAgdG1wbCA9IHRoaXMuZGF0ZXRpbWVUbXBsO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICB9XHJcbiAgICAgIGNhc2UgJ2VkaXRhYmxlU2VsZWN0Jzoge1xyXG4gICAgICAgIHRoaXMuc2VsZWN0T3B0aW9ucyA9IHRoaXMuZWxlbWVudENvbmZpZy5pdGVyYXRvciB8fCBbXTtcclxuXHJcbiAgICAgICAgdG1wbCA9IHRoaXMuZWRpdGFibGVTZWxlY3RUbXBsO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy8g6buY6K6k5YC8XHJcbiAgICBpZiAoT2JqZWN0LmtleXModGhpcy5lbGVtZW50Q29uZmlnKS5pbmRleE9mKCdkZWZhdWx0VmFsdWUnKSA+IC0xKSB7XHJcbiAgICAgIGlmICh0aGlzLmVsZW1lbnRWYWx1ZSA9PT0gdW5kZWZpbmVkIHx8IHRoaXMuZWxlbWVudFZhbHVlID09PSBudWxsKSB7XHJcbiAgICAgICAgdGhpcy5lbGVtZW50VmFsdWUgPSB0aGlzLmVsZW1lbnRDb25maWcuZGVmYXVsdFZhbHVlO1xyXG4gICAgICB9XHJcbiAgICAgIHRoaXMuc2hvd0RlZmF1bHRWYWx1ZSA9IHRydWU7XHJcbiAgICB9XHJcblxyXG4gICAgLy8g5piv5ZCm5pi+56S6XHJcbiAgICBpZiAoT2JqZWN0LmtleXModGhpcy5lbGVtZW50Q29uZmlnKS5pbmRleE9mKCd2aXNpYmxlJykgPCAwKSB7XHJcbiAgICAgIHRoaXMuZWxlbWVudENvbmZpZy52aXNpYmxlID0gdHJ1ZTtcclxuICAgIH1cclxuXHJcbiAgICAvLyDliJvlu7rmqKHmnb9cclxuICAgIGlmICh0bXBsICYmICh0aGlzLnByb3BJdGVtLmxlbmd0aCA9PT0gMCB8fCB0aGlzLnByb3BlcnR5T2xkVHlwZSAhPT0gdGhpcy5pdGVtVHlwZSkpIHtcclxuICAgICAgdGhpcy5wcm9wSXRlbS5jbGVhcigpO1xyXG4gICAgICB0aGlzLnByb3BJdGVtLmNyZWF0ZUVtYmVkZGVkVmlldyh0bXBsKTtcclxuICAgICAgdGhpcy5wcm9wZXJ0eU9sZFR5cGUgPSB0aGlzLml0ZW1UeXBlO1xyXG4gICAgfVxyXG5cclxuXHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDpvKDmoIfnp7vlhaUgLS3lt7Llup/lvINcclxuICAgKi9cclxuICBvbm1vdXNlb3ZlcigpIHtcclxuICAgIGlmICghdGhpcy5lbGVtZW50Q29uZmlnLnNob3dDbGVhckJ1dHRvbikge1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBpZiAoIXRoaXMuc2hvd0NsZWFyQnV0dG9uKSB7XHJcbiAgICAgIHRoaXMuc2hvd0NsZWFyQnV0dG9uID0gdHJ1ZTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOm8oOagh+emu+W8gCAtLeW3suW6n+W8g1xyXG4gICAqL1xyXG4gIG9ubW91c2VsZWF2ZSgpIHtcclxuICAgIGlmICghdGhpcy5lbGVtZW50Q29uZmlnLnNob3dDbGVhckJ1dHRvbikge1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICB0aGlzLnNob3dDbGVhckJ1dHRvbiA9IGZhbHNlO1xyXG4gIH1cclxuXHJcblxyXG4gIC8qKlxyXG4gICAqIOa4hemZpOaooeaAgeahhuWGheWuuVxyXG4gICAqL1xyXG4gIG1vZGFsQ2xlYXIoKSB7XHJcbiAgICAvLyDmlbDmja7ovazmjaJcclxuICAgIHRoaXMuX2NvbnZlcnRNb2RhbFNob3dWYWx1ZShudWxsKTtcclxuXHJcbiAgICAvLyDoi6XmnInmuIXpmaTlkI7kuovku7bvvIzlhYjmiafooYzmlrnms5VcclxuICAgIGlmIChPYmplY3Qua2V5cyh0aGlzLmVsZW1lbnRDb25maWcpLmluZGV4T2YoJ2FmdGVyQ2xpY2tDbGVhckJ1dHRvbicpID4gLTEgJiZcclxuICAgICAgdHlwZW9mICh0aGlzLmVsZW1lbnRDb25maWcuYWZ0ZXJDbGlja0NsZWFyQnV0dG9uKSA9PT0gJ2Z1bmN0aW9uJykge1xyXG4gICAgICB0aGlzLmVsZW1lbnRDb25maWcuYWZ0ZXJDbGlja0NsZWFyQnV0dG9uKHRoaXMuZWxlbWVudFZhbHVlKTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBjaGFuZ2VPYmplY3QgPSB7XHJcbiAgICAgIHByb3BlcnR5SUQ6IHRoaXMuZWxlbWVudENvbmZpZy5wcm9wZXJ0eUlELFxyXG4gICAgICBwcm9wZXJ0eVZhbHVlOiBudWxsXHJcbiAgICB9O1xyXG4gICAgdGhpcy5zdWJtaXRNb2RhbC5lbWl0KHsgY2hhbmdlT2JqZWN0LCBwYXJhbWV0ZXJzOiBudWxsIH0pO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog5Y+Y5pu05bGe5oCn5YC8XHJcbiAgICovXHJcbiAgY2hhbmdlVmFsdWUoZSkge1xyXG4gICAgbGV0IHZhbHVlID0gdGhpcy5lbGVtZW50VmFsdWU7XHJcblxyXG4gICAgLy8g5paH5pys5o6n5Lu26ZmQ5Yi26L6T5YWl5a2X56ymXHJcbiAgICBpZiAodmFsdWUgJiYgdGhpcy5lbGVtZW50Q29uZmlnLnByb3BlcnR5VHlwZSA9PT0gJ3N0cmluZycgJiYgIXRoaXMuZWxlbWVudENvbmZpZy5yZWFkb25seSAmJlxyXG4gICAgICB0aGlzLmVsZW1lbnRDb25maWcubm90QWxsb3dlZENoYXJzICYmIHRoaXMuZWxlbWVudENvbmZpZy5ub3RBbGxvd2VkQ2hhcnMubGVuZ3RoKSB7XHJcbiAgICAgIHRoaXMuZWxlbWVudENvbmZpZy5ub3RBbGxvd2VkQ2hhcnMuZm9yRWFjaCgoYzogYW55KSA9PiB7XHJcbiAgICAgICAgaWYgKHR5cGVvZiAoYykgPT09ICdvYmplY3QnKSB7XHJcbiAgICAgICAgICB2YWx1ZSA9IHZhbHVlLnJlcGxhY2UoYywgJycpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIChjKSA9PT0gJ3N0cmluZycpIHtcclxuICAgICAgICAgIHZhbHVlID0gdmFsdWUucmVwbGFjZShuZXcgUmVnRXhwKGMsICdnJyksICcnKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICB9KTtcclxuICAgICAgdGhpcy5lbGVtZW50VmFsdWUgPSB2YWx1ZTtcclxuICAgIH1cclxuXHJcbiAgICAvLyDlpJrpgInmjqfku7bov5Tlm57mlbDnu4TmoLzlvI/nmoTmlbDmja5cclxuICAgIGlmICh0aGlzLml0ZW1UeXBlID09PSAnbXVsdGlTZWxlY3QnICYmIHRoaXMuZWxlbWVudENvbmZpZy5tdWx0aVNlbGVjdERhdGFUeXBlID09PSAnYXJyYXknKSB7XHJcbiAgICAgIHZhbHVlID0gdGhpcy5lbGVtZW50VmFsdWUgPyB0aGlzLmVsZW1lbnRWYWx1ZS5zcGxpdCgnLCcpIDogJyc7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgY2hhbmdlT2JqZWN0ID0ge1xyXG4gICAgICBwcm9wZXJ0eUlEOiB0aGlzLmVsZW1lbnRDb25maWcucHJvcGVydHlJRCxcclxuICAgICAgcHJvcGVydHlWYWx1ZTogdmFsdWVcclxuICAgIH07XHJcbiAgICB0aGlzLnZhbHVlQ2hhbmdlZC5lbWl0KHsgY2hhbmdlT2JqZWN0IH0pO1xyXG4gICAgaWYgKHRoaXMuZWxlbWVudENvbmZpZy5yZWZyZXNoUGFuZWxBZnRlckNoYW5nZWQpIHtcclxuICAgICAgdGhpcy50cmlnZ2VyUmVmcmVzaFBhbmVsLmVtaXQoKTtcclxuICAgIH1cclxuICB9XHJcbiAgLyoqXHJcbiAgICogZmFycmlzIOaXpeacn+aOp+S7tueahOWPmOabtOS6i+S7tlxyXG4gICAqIEBwYXJhbSBlIGVcclxuICAgKi9cclxuICBjaGFuZ2VEYXRlVmFsdWUoZSkge1xyXG4gICAgY29uc3QgdmFsdWUgPSBlLmZvcm1hdHRlZDtcclxuXHJcbiAgICBjb25zdCBjaGFuZ2VPYmplY3QgPSB7XHJcbiAgICAgIHByb3BlcnR5SUQ6IHRoaXMuZWxlbWVudENvbmZpZy5wcm9wZXJ0eUlELFxyXG4gICAgICBwcm9wZXJ0eVZhbHVlOiB2YWx1ZVxyXG4gICAgfTtcclxuICAgIHRoaXMudmFsdWVDaGFuZ2VkLmVtaXQoeyBjaGFuZ2VPYmplY3QgfSk7XHJcbiAgICBpZiAodGhpcy5lbGVtZW50Q29uZmlnLnJlZnJlc2hQYW5lbEFmdGVyQ2hhbmdlZCkge1xyXG4gICAgICB0aGlzLnRyaWdnZXJSZWZyZXNoUGFuZWwuZW1pdCgpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog6Ieq5a6a5LmJ57yW6L6R5Zmo5L2/55So5qih5oCB5qGG5omT5byAXHJcbiAgICovXHJcbiAgb3Blbk1vZGFsKCkge1xyXG4gICAgaWYgKHRoaXMuZWxlbWVudENvbmZpZy5yZWFkb25seSkge1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBpZiAoT2JqZWN0LmtleXModGhpcy5lbGVtZW50Q29uZmlnKS5pbmRleE9mKCdiZWZvcmVPcGVuTW9kYWwnKSA+IC0xICYmIHR5cGVvZiAodGhpcy5lbGVtZW50Q29uZmlnLmJlZm9yZU9wZW5Nb2RhbCkgPT09ICdmdW5jdGlvbicpIHtcclxuICAgICAgY29uc3QgcmVzdWx0ID0gdGhpcy5lbGVtZW50Q29uZmlnLmJlZm9yZU9wZW5Nb2RhbCgpO1xyXG4gICAgICBpZiAocmVzdWx0ICYmICFyZXN1bHQucmVzdWx0KSB7XHJcbiAgICAgICAgdGhpcy5ub3RpZnlTZXJ2Lndhcm5pbmcoe1xyXG4gICAgICAgICAgdGl0bGU6ICfns7vnu5/mj5DnpLonLCBtc2c6IHJlc3VsdC5tZXNzYWdlLCB0aW1lb3V0OiAzMDAwXHJcbiAgICAgICAgfSBhcyBOb3RpZnlPcHRpb25zKTtcclxuICAgICAgICByZXR1cm47XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIHRoaXMuY3JlYXRlRWRpdG9yQ29tcG9uZW50KCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDliJvlu7roh6rlrprkuYnnvJbovpHlmahcclxuICAgKi9cclxuICBwcml2YXRlIGNyZWF0ZUVkaXRvckNvbXBvbmVudCgpIHtcclxuICAgIGNvbnN0IGVkaXRvciA9IHRoaXMuZWxlbWVudENvbmZpZy5lZGl0b3I7XHJcbiAgICBpZiAoIWVkaXRvcikge1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICAvLyDliJvlu7rmqKHmgIHmoYbnu4Tku7ZcclxuICAgIGNvbnN0IGNvbXBGYWN0b3J5ID0gdGhpcy5yZXNvbHZlci5yZXNvbHZlQ29tcG9uZW50RmFjdG9yeShlZGl0b3IpO1xyXG4gICAgY29uc3QgY29tcFJlZiA9IGNvbXBGYWN0b3J5LmNyZWF0ZSh0aGlzLmluamVjdG9yKTtcclxuICAgIGNvbXBSZWYuaW5zdGFuY2UudmFsdWUgPSB0aGlzLmVsZW1lbnRWYWx1ZTtcclxuICAgIGlmICh0aGlzLmVsZW1lbnRDb25maWcuZWRpdG9yUGFyYW1zKSB7ICAvLyDnvJbovpHlmajpnIDopoHnmoTpop3lpJblj4LmlbBcclxuICAgICAgY29tcFJlZi5pbnN0YW5jZS5lZGl0b3JQYXJhbXMgPSB0aGlzLmVsZW1lbnRDb25maWcuZWRpdG9yUGFyYW1zO1xyXG4gICAgfVxyXG4gICAgbGV0IG1vZGFsQ29uZmlnID0gY29tcFJlZi5pbnN0YW5jZS5tb2RhbENvbmZpZztcclxuICAgIGlmICghbW9kYWxDb25maWcpIHtcclxuICAgICAgbW9kYWxDb25maWcgPSB7XHJcbiAgICAgICAgdGl0bGU6ICflsZ7mgKfphY3nva4nLFxyXG4gICAgICAgIHdpZHRoOiA4MDAsXHJcbiAgICAgICAgaGVpZ2h0OiA0MDAsXHJcbiAgICAgICAgc2hvd0J1dHRvbnM6IGZhbHNlXHJcbiAgICAgIH07XHJcbiAgICB9IGVsc2UgaWYgKG1vZGFsQ29uZmlnLnNob3dCdXR0b25zKSB7XHJcbiAgICAgIG1vZGFsQ29uZmlnLmJ1dHRvbnMgPSBjb21wUmVmLmluc3RhbmNlLm1vZGFsRm9vdGVyO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IGRpYWxvZyA9IHRoaXMubW9kYWxTZXJ2aWNlLnNob3coY29tcFJlZiwgbW9kYWxDb25maWcpO1xyXG5cclxuICAgIC8vIOebkeWQrOWFs+mXreaooeaAgeahhlxyXG4gICAgaWYgKGNvbXBSZWYuaW5zdGFuY2UuY2xvc2VNb2RhbCAmJiBjb21wUmVmLmluc3RhbmNlLmNsb3NlTW9kYWwgaW5zdGFuY2VvZiBFdmVudEVtaXR0ZXIpIHtcclxuICAgICAgY29tcFJlZi5pbnN0YW5jZS5jbG9zZU1vZGFsLnN1YnNjcmliZSgoZGF0YSkgPT4ge1xyXG4gICAgICAgIC8vIOaVsOaNrui9rOaNolxyXG4gICAgICAgIGlmIChkYXRhKSB7XHJcbiAgICAgICAgICB0aGlzLl9jb252ZXJ0TW9kYWxTaG93VmFsdWUoZGF0YSk7XHJcblxyXG4gICAgICAgICAgY29uc3QgY2hhbmdlT2JqZWN0ID0ge1xyXG4gICAgICAgICAgICBwcm9wZXJ0eUlEOiB0aGlzLmVsZW1lbnRDb25maWcucHJvcGVydHlJRCxcclxuICAgICAgICAgICAgcHJvcGVydHlWYWx1ZTogZGF0YVxyXG4gICAgICAgICAgfTtcclxuICAgICAgICAgIHRoaXMudmFsdWVDaGFuZ2VkLmVtaXQoeyBjaGFuZ2VPYmplY3QgfSk7XHJcblxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZGlhbG9nLmNsb3NlKCk7XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuXHJcblxyXG4gICAgLy8g5by55Ye65qGG5YWz6Zet5LqL5Lu277yM5bim5Y+C5pWw77yM5qC85byP5Li6eyB2YWx1ZSwgcGFyYW1ldGVycyB9XHJcbiAgICBpZiAoY29tcFJlZi5pbnN0YW5jZS5zdWJtaXRNb2RhbCAmJiBjb21wUmVmLmluc3RhbmNlLnN1Ym1pdE1vZGFsIGluc3RhbmNlb2YgRXZlbnRFbWl0dGVyKSB7XHJcbiAgICAgIGNvbXBSZWYuaW5zdGFuY2Uuc3VibWl0TW9kYWwuc3Vic2NyaWJlKGRhdGEgPT4ge1xyXG4gICAgICAgIGlmICghZGF0YSkge1xyXG4gICAgICAgICAgZGlhbG9nLmNsb3NlKCk7XHJcbiAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IHsgdmFsdWUsIHBhcmFtZXRlcnMgfSA9IGRhdGE7XHJcbiAgICAgICAgLy8g5pWw5o2u6L2s5o2iXHJcbiAgICAgICAgdGhpcy5fY29udmVydE1vZGFsU2hvd1ZhbHVlKHZhbHVlKTtcclxuXHJcbiAgICAgICAgY29uc3QgY2hhbmdlT2JqZWN0ID0ge1xyXG4gICAgICAgICAgcHJvcGVydHlJRDogdGhpcy5lbGVtZW50Q29uZmlnLnByb3BlcnR5SUQsXHJcbiAgICAgICAgICBwcm9wZXJ0eVZhbHVlOiB2YWx1ZVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5zdWJtaXRNb2RhbC5lbWl0KHsgY2hhbmdlT2JqZWN0LCBwYXJhbWV0ZXJzIH0pO1xyXG5cclxuICAgICAgICBkaWFsb2cuY2xvc2UoKTtcclxuICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog5qih5oCB5qGG5Zy65pmv5LiL5bCG5bGe5oCn5YC86L2s5o2i5Li66L6T5YWl5qGG5Lit5pi+56S655qE5YC8XHJcbiAgICogQHBhcmFtIHZhbHVlXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBfY29udmVydE1vZGFsU2hvd1ZhbHVlKHZhbHVlKSB7XHJcbiAgICBpZiAodGhpcy5lbGVtZW50Q29uZmlnLmNvbnZlcnRlcikge1xyXG4gICAgICB0aGlzLmVsZW1lbnRTaG93VmFsdWUgPSB0aGlzLmVsZW1lbnRDb25maWcuY29udmVydGVyLmNvbnZlcnRUbyh2YWx1ZSk7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIGlmICh2YWx1ZSAmJiB2YWx1ZSBpbnN0YW5jZW9mIE9iamVjdCkge1xyXG4gICAgICB0aGlzLmVsZW1lbnRTaG93VmFsdWUgPSBKU09OLnN0cmluZ2lmeSh2YWx1ZSk7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIHRoaXMuZWxlbWVudFNob3dWYWx1ZSA9IHZhbHVlO1xyXG4gIH1cclxufVxyXG4iXX0=