/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, Input, Output, EventEmitter, ComponentFactoryResolver, ViewChild, ViewContainerRef } from '@angular/core';
import { PropertyEntity } from '../../entity/property-entity';
import { TextboxPropertyComponent } from '../../controls/textbox.component';
import { NumberPropertyComponent } from '../../controls/number.component';
import { CombolistPropertyComponent } from '../../controls/combolist.component';
import { DatePropertyComponent } from '../../controls/date.component';
import { ModalPropertyComponent } from '../../controls/modal.component';
import { UniformPropertyComponent } from '../../controls/unity.component';
var FPropertyItemComponent = /** @class */ (function () {
    function FPropertyItemComponent(resolver) {
        this.resolver = resolver;
        this.valueChanged = new EventEmitter();
        this.submitModal = new EventEmitter();
        // 向上触发整体面板刷新
        this.triggerRefreshPanel = new EventEmitter();
        // 控件类型
        this.itemType = 'string';
    }
    /**
     * @param {?} changes
     * @return {?}
     */
    FPropertyItemComponent.prototype.ngOnChanges = /**
     * @param {?} changes
     * @return {?}
     */
    function (changes) {
        this.refresh();
    };
    /**
     * @return {?}
     */
    FPropertyItemComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () { };
    /**
     * @return {?}
     */
    FPropertyItemComponent.prototype.refresh = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var controlComponent;
        // 显示格式
        /** @type {?} */
        var propertyType = this.itemType = this.elementConfig.propertyType;
        switch (propertyType) {
            case 'boolean': {
                this.itemType = 'select';
                controlComponent = CombolistPropertyComponent;
                break;
            }
            case 'select': {
                controlComponent = CombolistPropertyComponent;
                break;
            }
            case 'multiSelect': {
                controlComponent = CombolistPropertyComponent;
                break;
            }
            case 'modal': {
                controlComponent = ModalPropertyComponent;
                break;
            }
            case 'number': {
                controlComponent = NumberPropertyComponent;
                break;
            }
            case 'string': {
                controlComponent = TextboxPropertyComponent;
                break;
            }
            case 'date':
            case 'datetime': {
                controlComponent = DatePropertyComponent;
                break;
            }
            case 'editableSelect': {
                controlComponent = CombolistPropertyComponent;
                break;
            }
            case 'unity': {
                controlComponent = UniformPropertyComponent;
                break;
            }
            case 'custom': {
                controlComponent = this.elementConfig.editor;
                break;
            }
        }
        // 默认值
        if (Object.keys(this.elementConfig).indexOf('defaultValue') > -1) {
            if (this.elementValue === undefined || this.elementValue === null) {
                this.elementValue = this.elementConfig.defaultValue;
            }
            // this.showDefaultValue = true;
        }
        // 是否显示
        if (Object.keys(this.elementConfig).indexOf('visible') < 0) {
            this.elementConfig.visible = true;
        }
        this.createDynamicControl(controlComponent);
    };
    /**
     * 动态创建控件
     * @param controlComponent  组件类型
     */
    /**
     * 动态创建控件
     * @param {?} controlComponent  组件类型
     * @return {?}
     */
    FPropertyItemComponent.prototype.createDynamicControl = /**
     * 动态创建控件
     * @param {?} controlComponent  组件类型
     * @return {?}
     */
    function (controlComponent) {
        var _this = this;
        if (!controlComponent) {
            console.log('动态创建组件为空！');
            return;
        }
        if (this.propItem.length === 0 || this.propertyOldType !== this.itemType) {
            this.propItem.clear();
            /** @type {?} */
            var componentFactory = this.resolver.resolveComponentFactory(controlComponent);
            this.controlComponentRef = this.propItem.createComponent(componentFactory);
            this.controlComponentRef.instance.elementConfig = this.elementConfig;
            this.controlComponentRef.instance.elementValue = this.elementValue;
            if (this.controlComponentRef.instance.valueChanged) {
                this.controlComponentRef.instance.valueChanged.subscribe((/**
                 * @param {?} data
                 * @return {?}
                 */
                function (data) {
                    var elementValue = data.elementValue;
                    _this.elementValue = elementValue;
                    _this.changeValue(null);
                }));
            }
            if (this.controlComponentRef.instance.submitModal) {
                this.controlComponentRef.instance.submitModal.subscribe((/**
                 * @param {?} data
                 * @return {?}
                 */
                function (data) {
                    var elementValue = data.elementValue, parameters = data.parameters;
                    _this.elementValue = elementValue;
                    _this.changeModalValue(parameters);
                }));
            }
            this.propertyOldType = this.itemType;
        }
        else if (this.controlComponentRef) {
            this.controlComponentRef.instance.elementConfig = this.elementConfig;
            this.controlComponentRef.instance.elementValue = this.elementValue;
        }
    };
    /**
     * 变更属性值
     */
    /**
     * 变更属性值
     * @param {?} parameters
     * @return {?}
     */
    FPropertyItemComponent.prototype.changeValue = /**
     * 变更属性值
     * @param {?} parameters
     * @return {?}
     */
    function (parameters) {
        /** @type {?} */
        var changeObject = {
            propertyID: this.elementConfig.propertyID,
            propertyValue: this.elementValue
        };
        this.valueChanged.emit({ changeObject: changeObject, parameters: parameters });
        if (this.elementConfig.refreshPanelAfterChanged) {
            this.triggerRefreshPanel.emit();
        }
    };
    /**
     * 变更弹窗类属性值
     * @param parameters 参数值
     */
    /**
     * 变更弹窗类属性值
     * @private
     * @param {?} parameters 参数值
     * @return {?}
     */
    FPropertyItemComponent.prototype.changeModalValue = /**
     * 变更弹窗类属性值
     * @private
     * @param {?} parameters 参数值
     * @return {?}
     */
    function (parameters) {
        /** @type {?} */
        var changeObject = {
            propertyID: this.elementConfig.propertyID,
            propertyValue: this.elementValue
        };
        this.submitModal.emit({ changeObject: changeObject, parameters: parameters });
        if (this.elementConfig.refreshPanelAfterChanged) {
            this.triggerRefreshPanel.emit();
        }
    };
    FPropertyItemComponent.decorators = [
        { type: Component, args: [{
                    selector: 'dynamic-property-item',
                    template: "<div class=\"farris-group-wrap property-item\" [hidden]=\"!elementConfig.visible\">\r\n  <div class=\"form-group farris-form-group\">\r\n    <label class=\"col-form-label mb-0\">\r\n\r\n      <!-- <span class=\"farris-label-text\" [popover]=\"popTemplate\" [popoverTitle]=\"elementConfig.propertyName\"\r\n        container=\"body\" placement=\"left\" triggers=\"hover\">{{elementConfig.propertyName}}</span> -->\r\n         <ng-template #popTemplate>\r\n           <div>\r\n            <div *ngIf=\"elementConfig.propertyName\" style=\"color: black;  float:left; margin-bottom:6px \">{{elementConfig.propertyName}}&nbsp;</div>\r\n            <div *ngIf=\"elementConfig.propertyID\" style=\"color: black;  float:left; margin-bottom:6px\">\u2014&nbsp;{{elementConfig.propertyID}}</div>\r\n            <br/>\r\n            <div *ngIf=\"elementConfig.description\" style=\"color: gray; float:left; margin-bottom:8px; \"> &nbsp;&nbsp;{{elementConfig.description}}</div>\r\n            <div *ngIf=\"elementConfig.detail\" style=\"float:left \">\r\n              <a href=\"{{elementConfig.detail}}\" target=\"_blank\">{{\"&nbsp;&nbsp;\u66F4\u591A\"}}</a></div> \r\n            </div>                \r\n        </ng-template>\r\n\r\n        <div>\r\n          <span class=\"farris-label-text\" farrisPopover [container]=\"'body'\" \r\n          [placement]=\"'left'\" [triggers]=\"'hover'\" [popover]=\"popTemplate\" [isFixed]=\"true\">{{elementConfig.propertyName}}</span>\r\n        </div>  \r\n\r\n    </label>\r\n\r\n    <ng-container #propItem> </ng-container>\r\n\r\n  </div>\r\n</div>\r\n",
                    styles: [".property-item .form-group{margin-bottom:2px}.property-item .col-form-label{line-height:26px}"]
                }] }
    ];
    /** @nocollapse */
    FPropertyItemComponent.ctorParameters = function () { return [
        { type: ComponentFactoryResolver }
    ]; };
    FPropertyItemComponent.propDecorators = {
        elementConfig: [{ type: Input }],
        elementValue: [{ type: Input }],
        valueChanged: [{ type: Output }],
        submitModal: [{ type: Output }],
        triggerRefreshPanel: [{ type: Output }],
        propItem: [{ type: ViewChild, args: ['propItem', { read: ViewContainerRef },] }]
    };
    return FPropertyItemComponent;
}());
export { FPropertyItemComponent };
if (false) {
    /** @type {?} */
    FPropertyItemComponent.prototype.elementConfig;
    /** @type {?} */
    FPropertyItemComponent.prototype.elementValue;
    /** @type {?} */
    FPropertyItemComponent.prototype.valueChanged;
    /** @type {?} */
    FPropertyItemComponent.prototype.submitModal;
    /** @type {?} */
    FPropertyItemComponent.prototype.triggerRefreshPanel;
    /** @type {?} */
    FPropertyItemComponent.prototype.propItem;
    /** @type {?} */
    FPropertyItemComponent.prototype.propertyOldType;
    /** @type {?} */
    FPropertyItemComponent.prototype.itemType;
    /** @type {?} */
    FPropertyItemComponent.prototype.controlComponentRef;
    /**
     * @type {?}
     * @private
     */
    FPropertyItemComponent.prototype.resolver;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicHJvcGVydHktaXRlbS5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZmFycmlzL2lkZS1wcm9wZXJ0eS1wYW5lbC8iLCJzb3VyY2VzIjpbImxpYi9wcm9wZXJ0eS1wYW5lbC9jb21wb25lbnRzL2ZhcnJpcy1wcm9wZXJ0eS1pdGVtL3Byb3BlcnR5LWl0ZW0uY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7QUFBQSxPQUFPLEVBQ0wsU0FBUyxFQUFVLEtBQUssRUFBRSxNQUFNLEVBQ2hDLFlBQVksRUFBRSx3QkFBd0IsRUFBRSxTQUFTLEVBQUUsZ0JBQWdCLEVBQ3BFLE1BQU0sZUFBZSxDQUFDO0FBQ3ZCLE9BQU8sRUFBRSxjQUFjLEVBQUUsTUFBTSw4QkFBOEIsQ0FBQztBQUM5RCxPQUFPLEVBQUUsd0JBQXdCLEVBQUUsTUFBTSxrQ0FBa0MsQ0FBQztBQUM1RSxPQUFPLEVBQUUsdUJBQXVCLEVBQUUsTUFBTSxpQ0FBaUMsQ0FBQztBQUMxRSxPQUFPLEVBQUUsMEJBQTBCLEVBQUUsTUFBTSxvQ0FBb0MsQ0FBQztBQUNoRixPQUFPLEVBQUUscUJBQXFCLEVBQUUsTUFBTSwrQkFBK0IsQ0FBQztBQUN0RSxPQUFPLEVBQUUsc0JBQXNCLEVBQUUsTUFBTSxnQ0FBZ0MsQ0FBQztBQUN4RSxPQUFPLEVBQUUsd0JBQXdCLEVBQUUsTUFBTSxnQ0FBZ0MsQ0FBQztBQUUxRTtJQXlCRSxnQ0FDVSxRQUFrQztRQUFsQyxhQUFRLEdBQVIsUUFBUSxDQUEwQjtRQWxCbEMsaUJBQVksR0FBRyxJQUFJLFlBQVksRUFBTyxDQUFDO1FBQ3ZDLGdCQUFXLEdBQUcsSUFBSSxZQUFZLEVBQU8sQ0FBQzs7UUFHdEMsd0JBQW1CLEdBQUcsSUFBSSxZQUFZLEVBQU8sQ0FBQzs7UUFTeEQsYUFBUSxHQUFHLFFBQVEsQ0FBQztJQU1wQixDQUFDOzs7OztJQUVELDRDQUFXOzs7O0lBQVgsVUFBWSxPQUFzQjtRQUNoQyxJQUFJLENBQUMsT0FBTyxFQUFFLENB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NUtELElBNEtDO1NBdktZLHNCQUFzQjs7O0lBQ2pDLCtDQUF1Qzs7SUFDdkMsOENBQTJCOztJQUMzQiw4Q0FBaUQ7O0lBQ2pELDZDQUFnRDs7SUFHaEQscURBQXdEOztJQUd4RCwwQ0FBOEU7O0lBRzlFLGlEQUF3Qjs7SUFHeEIsMENBQW9COztJQUVwQixxREFBdUM7Ozs7O0lBR3JDLDBDQUEwQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XHJcbiAgQ29tcG9uZW50LCBPbkluaXQsIElucHV0LCBPdXRwdXQsIE9uQ2hhbmdlcywgU2ltcGxlQ2hhbmdlcyxcclxuICBFdmVudEVtaXR0ZXIsIENvbXBvbmVudEZhY3RvcnlSZXNvbHZlciwgVmlld0NoaWxkLCBWaWV3Q29udGFpbmVyUmVmLCBDb21wb25lbnRSZWZcclxufSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgUHJvcGVydHlFbnRpdHkgfSBmcm9tICcuLi8uLi9lbnRpdHkvcHJvcGVydHktZW50aXR5JztcclxuaW1wb3J0IHsgVGV4dGJveFByb3BlcnR5Q29tcG9uZW50IH0gZnJvbSAnLi4vLi4vY29udHJvbHMvdGV4dGJveC5jb21wb25lbnQnO1xyXG5pbXBvcnQgeyBOdW1iZXJQcm9wZXJ0eUNvbXBvbmVudCB9IGZyb20gJy4uLy4uL2NvbnRyb2xzL251bWJlci5jb21wb25lbnQnO1xyXG5pbXBvcnQgeyBDb21ib2xpc3RQcm9wZXJ0eUNvbXBvbmVudCB9IGZyb20gJy4uLy4uL2NvbnRyb2xzL2NvbWJvbGlzdC5jb21wb25lbnQnO1xyXG5pbXBvcnQgeyBEYXRlUHJvcGVydHlDb21wb25lbnQgfSBmcm9tICcuLi8uLi9jb250cm9scy9kYXRlLmNvbXBvbmVudCc7XHJcbmltcG9ydCB7IE1vZGFsUHJvcGVydHlDb21wb25lbnQgfSBmcm9tICcuLi8uLi9jb250cm9scy9tb2RhbC5jb21wb25lbnQnO1xyXG5pbXBvcnQgeyBVbmlmb3JtUHJvcGVydHlDb21wb25lbnQgfSBmcm9tICcuLi8uLi9jb250cm9scy91bml0eS5jb21wb25lbnQnO1xyXG5cclxuQENvbXBvbmVudCh7XHJcbiAgc2VsZWN0b3I6ICdkeW5hbWljLXByb3BlcnR5LWl0ZW0nLFxyXG4gIHRlbXBsYXRlVXJsOiAnLi9wcm9wZXJ0eS1pdGVtLmNvbXBvbmVudC5odG1sJyxcclxuICBzdHlsZVVybHM6IFsnLi9wcm9wZXJ0eS1pdGVtLmNvbXBvbmVudC5jc3MnXVxyXG59KVxyXG5leHBvcnQgY2xhc3MgRlByb3BlcnR5SXRlbUNvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCwgT25DaGFuZ2VzIHtcclxuICBASW5wdXQoKSBlbGVtZW50Q29uZmlnOiBQcm9wZXJ0eUVudGl0eTtcclxuICBASW5wdXQoKSBlbGVtZW50VmFsdWU6IGFueTtcclxuICBAT3V0cHV0KCkgdmFsdWVDaGFuZ2VkID0gbmV3IEV2ZW50RW1pdHRlcjxhbnk+KCk7XHJcbiAgQE91dHB1dCgpIHN1Ym1pdE1vZGFsID0gbmV3IEV2ZW50RW1pdHRlcjxhbnk+KCk7XHJcblxyXG4gIC8vIOWQkeS4iuinpuWPkeaVtOS9k+mdouadv+WIt+aWsFxyXG4gIEBPdXRwdXQoKSB0cmlnZ2VyUmVmcmVzaFBhbmVsID0gbmV3IEV2ZW50RW1pdHRlcjxhbnk+KCk7XHJcblxyXG4gIC8vIOaOp+S7tuWuueWZqFxyXG4gIEBWaWV3Q2hpbGQoJ3Byb3BJdGVtJywgeyByZWFkOiBWaWV3Q29udGFpbmVyUmVmIH0pIHByb3BJdGVtOiBWaWV3Q29udGFpbmVyUmVmO1xyXG5cclxuICAvLyDmjqfku7bnsbvlnostLeeUqOS6juWMuuWIhuWKqOaAgeWPmOabtOaOp+S7tuexu+Wei+eahOWcuuaZr++8mumcgOimgemHjeaWsOa4suafk+aooeadv1xyXG4gIHByb3BlcnR5T2xkVHlwZTogc3RyaW5nO1xyXG5cclxuICAvLyDmjqfku7bnsbvlnotcclxuICBpdGVtVHlwZSA9ICdzdHJpbmcnO1xyXG5cclxuICBjb250cm9sQ29tcG9uZW50UmVmOiBDb21wb25lbnRSZWY8YW55PjtcclxuXHJcbiAgY29uc3RydWN0b3IoXHJcbiAgICBwcml2YXRlIHJlc29sdmVyOiBDb21wb25lbnRGYWN0b3J5UmVzb2x2ZXIpIHtcclxuICB9XHJcblxyXG4gIG5nT25DaGFuZ2VzKGNoYW5nZXM6IFNpbXBsZUNoYW5nZXMpIHtcclxuICAgIHRoaXMucmVmcmVzaCgpO1xyXG4gIH1cclxuXHJcbiAgbmdPbkluaXQoKSB7IH1cclxuXHJcbiAgcmVmcmVzaCgpIHtcclxuICAgIGxldCBjb250cm9sQ29tcG9uZW50O1xyXG4gICAgLy8g5pi+56S65qC85byPXHJcbiAgICBjb25zdCBwcm9wZXJ0eVR5cGUgPSB0aGlzLml0ZW1UeXBlID0gdGhpcy5lbGVtZW50Q29uZmlnLnByb3BlcnR5VHlwZTtcclxuICAgIHN3aXRjaCAocHJvcGVydHlUeXBlKSB7XHJcbiAgICAgIGNhc2UgJ2Jvb2xlYW4nOiB7XHJcbiAgICAgICAgdGhpcy5pdGVtVHlwZSA9ICdzZWxlY3QnO1xyXG4gICAgICAgIGNvbnRyb2xDb21wb25lbnQgPSBDb21ib2xpc3RQcm9wZXJ0eUNvbXBvbmVudDtcclxuICAgICAgICBicmVhaztcclxuICAgICAgfVxyXG4gICAgICBjYXNlICdzZWxlY3QnOiB7XHJcbiAgICAgICAgY29udHJvbENvbXBvbmVudCA9IENvbWJvbGlzdFByb3BlcnR5Q29tcG9uZW50O1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICB9XHJcbiAgICAgIGNhc2UgJ211bHRpU2VsZWN0Jzoge1xyXG4gICAgICAgIGNvbnRyb2xDb21wb25lbnQgPSBDb21ib2xpc3RQcm9wZXJ0eUNvbXBvbmVudDtcclxuICAgICAgICBicmVhaztcclxuICAgICAgfVxyXG4gICAgICBjYXNlICdtb2RhbCc6IHtcclxuICAgICAgICBjb250cm9sQ29tcG9uZW50ID0gTW9kYWxQcm9wZXJ0eUNvbXBvbmVudDtcclxuICAgICAgICBicmVhaztcclxuICAgICAgfVxyXG4gICAgICBjYXNlICdudW1iZXInOiB7XHJcbiAgICAgICAgY29udHJvbENvbXBvbmVudCA9IE51bWJlclByb3BlcnR5Q29tcG9uZW50O1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICB9XHJcbiAgICAgIGNhc2UgJ3N0cmluZyc6IHtcclxuICAgICAgICBjb250cm9sQ29tcG9uZW50ID0gVGV4dGJveFByb3BlcnR5Q29tcG9uZW50O1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICB9XHJcbiAgICAgIGNhc2UgJ2RhdGUnOiBjYXNlICdkYXRldGltZSc6IHtcclxuICAgICAgICBjb250cm9sQ29tcG9uZW50ID0gRGF0ZVByb3BlcnR5Q29tcG9uZW50O1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICB9XHJcbiAgICAgIGNhc2UgJ2VkaXRhYmxlU2VsZWN0Jzoge1xyXG4gICAgICAgIGNvbnRyb2xDb21wb25lbnQgPSBDb21ib2xpc3RQcm9wZXJ0eUNvbXBvbmVudDtcclxuICAgICAgICBicmVhaztcclxuICAgICAgfVxyXG4gICAgICBjYXNlICd1bml0eSc6IHtcclxuICAgICAgICBjb250cm9sQ29tcG9uZW50ID0gVW5pZm9ybVByb3BlcnR5Q29tcG9uZW50O1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICB9XHJcbiAgICAgIGNhc2UgJ2N1c3RvbSc6IHtcclxuICAgICAgICBjb250cm9sQ29tcG9uZW50ID0gdGhpcy5lbGVtZW50Q29uZmlnLmVkaXRvcjtcclxuICAgICAgICBicmVhaztcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8vIOm7mOiupOWAvFxyXG4gICAgaWYgKE9iamVjdC5rZXlzKHRoaXMuZWxlbWVudENvbmZpZykuaW5kZXhPZignZGVmYXVsdFZhbHVlJykgPiAtMSkge1xyXG4gICAgICBpZiAodGhpcy5lbGVtZW50VmFsdWUgPT09IHVuZGVmaW5lZCB8fCB0aGlzLmVsZW1lbnRWYWx1ZSA9PT0gbnVsbCkge1xyXG4gICAgICAgIHRoaXMuZWxlbWVudFZhbHVlID0gdGhpcy5lbGVtZW50Q29uZmlnLmRlZmF1bHRWYWx1ZTtcclxuICAgICAgfVxyXG4gICAgICAvLyB0aGlzLnNob3dEZWZhdWx0VmFsdWUgPSB0cnVlO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIOaYr+WQpuaYvuekulxyXG4gICAgaWYgKE9iamVjdC5rZXlzKHRoaXMuZWxlbWVudENvbmZpZykuaW5kZXhPZigndmlzaWJsZScpIDwgMCkge1xyXG4gICAgICB0aGlzLmVsZW1lbnRDb25maWcudmlzaWJsZSA9IHRydWU7XHJcbiAgICB9XHJcblxyXG4gICAgdGhpcy5jcmVhdGVEeW5hbWljQ29udHJvbChjb250cm9sQ29tcG9uZW50KTtcclxuXHJcbiAgfVxyXG4gIC8qKlxyXG4gICAqIOWKqOaAgeWIm+W7uuaOp+S7tlxyXG4gICAqIEBwYXJhbSBjb250cm9sQ29tcG9uZW50ICDnu4Tku7bnsbvlnotcclxuICAgKi9cclxuICBjcmVhdGVEeW5hbWljQ29udHJvbChjb250cm9sQ29tcG9uZW50OiBhbnkpIHtcclxuICAgIGlmICghY29udHJvbENvbXBvbmVudCkge1xyXG4gICAgICBjb25zb2xlLmxvZygn5Yqo5oCB5Yib5bu657uE5Lu25Li656m677yBJyk7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIGlmICh0aGlzLnByb3BJdGVtLmxlbmd0aCA9PT0gMCB8fCB0aGlzLnByb3BlcnR5T2xkVHlwZSAhPT0gdGhpcy5pdGVtVHlwZSkge1xyXG4gICAgICB0aGlzLnByb3BJdGVtLmNsZWFyKCk7XHJcbiAgICAgIGNvbnN0IGNvbXBvbmVudEZhY3RvcnkgPSB0aGlzLnJlc29sdmVyLnJlc29sdmVDb21wb25lbnRGYWN0b3J5KGNvbnRyb2xDb21wb25lbnQpO1xyXG4gICAgICB0aGlzLmNvbnRyb2xDb21wb25lbnRSZWYgPSB0aGlzLnByb3BJdGVtLmNyZWF0ZUNvbXBvbmVudChjb21wb25lbnRGYWN0b3J5KTtcclxuXHJcbiAgICAgIHRoaXMuY29udHJvbENvbXBvbmVudFJlZi5pbnN0YW5jZS5lbGVtZW50Q29uZmlnID0gdGhpcy5lbGVtZW50Q29uZmlnO1xyXG4gICAgICB0aGlzLmNvbnRyb2xDb21wb25lbnRSZWYuaW5zdGFuY2UuZWxlbWVudFZhbHVlID0gdGhpcy5lbGVtZW50VmFsdWU7XHJcblxyXG4gICAgICBpZiAodGhpcy5jb250cm9sQ29tcG9uZW50UmVmLmluc3RhbmNlLnZhbHVlQ2hhbmdlZCkge1xyXG4gICAgICAgIHRoaXMuY29udHJvbENvbXBvbmVudFJlZi5pbnN0YW5jZS52YWx1ZUNoYW5nZWQuc3Vic2NyaWJlKGRhdGEgPT4ge1xyXG4gICAgICAgICAgY29uc3QgeyBlbGVtZW50VmFsdWUgfSA9IGRhdGE7XHJcbiAgICAgICAgICB0aGlzLmVsZW1lbnRWYWx1ZSA9IGVsZW1lbnRWYWx1ZTtcclxuICAgICAgICAgIHRoaXMuY2hhbmdlVmFsdWUobnVsbCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGlmICh0aGlzLmNvbnRyb2xDb21wb25lbnRSZWYuaW5zdGFuY2Uuc3VibWl0TW9kYWwpIHtcclxuICAgICAgICB0aGlzLmNvbnRyb2xDb21wb25lbnRSZWYuaW5zdGFuY2Uuc3VibWl0TW9kYWwuc3Vic2NyaWJlKGRhdGEgPT4ge1xyXG4gICAgICAgICAgY29uc3QgeyBlbGVtZW50VmFsdWUsIHBhcmFtZXRlcnMgfSA9IGRhdGE7XHJcbiAgICAgICAgICB0aGlzLmVsZW1lbnRWYWx1ZSA9IGVsZW1lbnRWYWx1ZTtcclxuXHJcbiAgICAgICAgICB0aGlzLmNoYW5nZU1vZGFsVmFsdWUocGFyYW1ldGVycyk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHRoaXMucHJvcGVydHlPbGRUeXBlID0gdGhpcy5pdGVtVHlwZTtcclxuICAgIH0gZWxzZSBpZiAodGhpcy5jb250cm9sQ29tcG9uZW50UmVmKSB7XHJcblxyXG4gICAgICB0aGlzLmNvbnRyb2xDb21wb25lbnRSZWYuaW5zdGFuY2UuZWxlbWVudENvbmZpZyA9IHRoaXMuZWxlbWVudENvbmZpZztcclxuICAgICAgdGhpcy5jb250cm9sQ29tcG9uZW50UmVmLmluc3RhbmNlLmVsZW1lbnRWYWx1ZSA9IHRoaXMuZWxlbWVudFZhbHVlO1xyXG5cclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOWPmOabtOWxnuaAp+WAvFxyXG4gICAqL1xyXG4gIGNoYW5nZVZhbHVlKHBhcmFtZXRlcnM6IGFueSkge1xyXG5cclxuICAgIGNvbnN0IGNoYW5nZU9iamVjdCA9IHtcclxuICAgICAgcHJvcGVydHlJRDogdGhpcy5lbGVtZW50Q29uZmlnLnByb3BlcnR5SUQsXHJcbiAgICAgIHByb3BlcnR5VmFsdWU6IHRoaXMuZWxlbWVudFZhbHVlXHJcbiAgICB9O1xyXG4gICAgdGhpcy52YWx1ZUNoYW5nZWQuZW1pdCh7IGNoYW5nZU9iamVjdCwgcGFyYW1ldGVycyB9KTtcclxuXHJcbiAgICBpZiAodGhpcy5lbGVtZW50Q29uZmlnLnJlZnJlc2hQYW5lbEFmdGVyQ2hhbmdlZCkge1xyXG4gICAgICB0aGlzLnRyaWdnZXJSZWZyZXNoUGFuZWwuZW1pdCgpO1xyXG4gICAgfVxyXG4gIH1cclxuICAvKipcclxuICAgKiDlj5jmm7TlvLnnqpfnsbvlsZ7mgKflgLxcclxuICAgKiBAcGFyYW0gcGFyYW1ldGVycyDlj4LmlbDlgLxcclxuICAgKi9cclxuICBwcml2YXRlIGNoYW5nZU1vZGFsVmFsdWUocGFyYW1ldGVyczogYW55KSB7XHJcbiAgICBjb25zdCBjaGFuZ2VPYmplY3QgPSB7XHJcbiAgICAgIHByb3BlcnR5SUQ6IHRoaXMuZWxlbWVudENvbmZpZy5wcm9wZXJ0eUlELFxyXG4gICAgICBwcm9wZXJ0eVZhbHVlOiB0aGlzLmVsZW1lbnRWYWx1ZVxyXG4gICAgfTtcclxuICAgIHRoaXMuc3VibWl0TW9kYWwuZW1pdCh7IGNoYW5nZU9iamVjdCwgcGFyYW1ldGVycyB9KTtcclxuXHJcbiAgICBpZiAodGhpcy5lbGVtZW50Q29uZmlnLnJlZnJlc2hQYW5lbEFmdGVyQ2hhbmdlZCkge1xyXG4gICAgICB0aGlzLnRyaWdnZXJSZWZyZXNoUGFuZWwuZW1pdCgpO1xyXG4gICAgfVxyXG4gIH1cclxufVxyXG4iXX0=