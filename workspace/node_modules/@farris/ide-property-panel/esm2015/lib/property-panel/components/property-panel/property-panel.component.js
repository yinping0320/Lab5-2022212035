/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, Input, ViewChild, ElementRef, Output, EventEmitter, ViewChildren } from '@angular/core';
import { PropertyItemListComponent } from '../property-item-list/property-item-list.component';
export class PropertyPanelComponent {
    constructor() {
        /**
         * 是否白色主题
         */
        this.isWhiteTheme = false;
        /**
         * 是否持有面板的隐藏显示状态
         */
        this.isPersitOpenState = false;
        /**
         * isPersitOpenState=true时，控制面板是否隐藏显示
         */
        this.isShowPanel = false;
        /**
         * isPersitOpenState=true时，抛出面板的关闭事件
         */
        this.closePropertyPanel = new EventEmitter();
        /**
         * 属性值
         */
        this.propertyData = {};
        this.dynamicControl = false;
        /**
         * 属性变更事件
         */
        this.propertyChanged = new EventEmitter();
        /**
         * 模态框属性变更事件
         */
        this.submitModal = new EventEmitter();
        /**
         * 是否展示关闭按钮
         */
        this.showCloseBtn = true;
        /**
         * 当前展示状态
         */
        this.isOpen = true;
        /**
         * 外层分类，以标签页形式展示
         */
        this.categoryTabs = [];
    }
    /**
     * @return {?}
     */
    ngOnInit() {
        if (this.width) {
            this.eastDiv.nativeElement.style.width = this.width + 'px';
        }
        else {
            this.eastDiv.nativeElement.style.width = 'inherit';
        }
        if (this.height) {
            this.eastDiv.nativeElement.style.height = this.height + 'px';
        }
        else {
            this.eastDiv.nativeElement.style.height = '100%';
        }
        if (this.isPersitOpenState) {
            this.isOpen = this.isShowPanel;
        }
        this.checkShowTabCategory();
    }
    /**
     *  更改面板的隐藏显示状态，只有在isPersitOpenState=true时生效
     * @param {?} simpleChanges
     * @return {?}
     */
    ngOnChanges(simpleChanges) {
        if (simpleChanges.isShowPanel && this.isPersitOpenState) {
            this.isOpen = this.isShowPanel;
        }
        this.checkShowTabCategory();
    }
    /**
     * @return {?}
     */
    refreshPanel() {
        this.checkShowTabCategory();
        this.itemLists.forEach((/**
         * @param {?} item
         * @return {?}
         */
        item => item.refresh()));
    }
    /**
     * @param {?} item
     * @return {?}
     */
    changeStatus(item) {
        if (this.propertyConfig.length < 2) {
            return;
        }
        if (!item.status || item.status === 'open') {
            item.status = 'closed';
        }
        else {
            item.status = 'open';
        }
    }
    /**
     *  隐藏面板
     * @return {?}
     */
    collapse() {
        // isPersitOpenState=true时,由外部确定状态
        if (!this.isPersitOpenState) {
            this.isOpen = false;
        }
        this.closePropertyPanel.emit();
    }
    /**
     * 抛出属性变更事件
     * @param {?} changeObject
     * @return {?}
     */
    _valueChanged(changeObject) {
        this.propertyChanged.emit(changeObject);
    }
    /**
     * @param {?} $event
     * @return {?}
     */
    _submitModal($event) {
        this.submitModal.emit($event);
    }
    /**
     * 将属性分类按照标签页进行归类
     * @private
     * @return {?}
     */
    checkShowTabCategory() {
        this.categoryTabs = [];
        if (!this.propertyConfig || this.propertyConfig.length === 0) {
            this.categoryTabs = [{
                    tabId: 'default',
                    tabName: '属性',
                    categoryList: []
                }];
            this.selectedTab = null;
            return;
        }
        this.propertyConfig.forEach((/**
         * @param {?} config
         * @return {?}
         */
        config => {
            if (config.tabId) {
                /** @type {?} */
                const propTab = this.categoryTabs.find((/**
                 * @param {?} t
                 * @return {?}
                 */
                t => t.tabId === config.tabId));
                if (!propTab) {
                    this.categoryTabs.push({
                        tabId: config.tabId,
                        tabName: config.tabName,
                        categoryList: [config],
                        hide: config.hide || config.properties.length === 0
                    });
                }
                else {
                    propTab.categoryList.push(config);
                    if (propTab.hide) {
                        propTab.hide = config.hide || config.properties.length === 0;
                    }
                }
            }
            else {
                /** @type {?} */
                const defaultTab = this.categoryTabs.find((/**
                 * @param {?} t
                 * @return {?}
                 */
                t => t.tabId === 'default'));
                if (!defaultTab) {
                    this.categoryTabs.push({
                        tabId: 'default',
                        tabName: '属性',
                        categoryList: [config]
                    });
                }
                else {
                    defaultTab.categoryList.push(config);
                }
            }
        }));
        // 记录已选的页签
        if (this.selectedTab) {
            /** @type {?} */
            const selectedTab = this.categoryTabs.find((/**
             * @param {?} tab
             * @return {?}
             */
            tab => tab.tabId === this.selectedTab.tabId));
            if (selectedTab) {
                this.selectedTab = selectedTab;
            }
        }
        else {
            this.selectedTab = this.categoryTabs[0];
        }
    }
}
PropertyPanelComponent.decorators = [
    { type: Component, args: [{
                selector: 'app-property-panel',
                template: "<div #east [style.display]=\"isOpen?'block':'none'\" [class.white-theme]=\"isWhiteTheme\">\r\n    <div class=\"propertyPanel panel d-flex flex-column\">\r\n\r\n\r\n        <div class=\"title d-flex\">\r\n            <div class=\"title-label\" *ngFor=\"let tab of categoryTabs\" (click)=\"selectedTab=tab\" [hidden]=\"tab.hide\"\r\n                [class.active]=\"selectedTab && selectedTab.tabId===tab.tabId && categoryTabs.length>1\">\r\n                <span>{{tab.tabName}}</span>\r\n            </div>\r\n            <div class=\"title-actions\">\r\n                <div class=\"monaco-toolbar\">\r\n                    <div class=\"monaco-action-bar animated\">\r\n                        <ul class=\"actions-container\" role=\"toolbar\">\r\n                            <li class=\"action-item\" (click)=\"collapse()\" *ngIf=\"showCloseBtn\">\r\n                                <a class=\"hide-panel\" title=\"\u5173\u95ED\"></a>\r\n                            </li>\r\n                        </ul>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n\r\n\r\n        <div #propertyPanel class=\"panel-body\" [style.height]=\"(height - 35) + 'px'\" *ngIf=\"selectedTab\">\r\n            <ul class=\"property-grid\">\r\n                <li *ngFor=\"let category of selectedTab.categoryList\">\r\n                    <ng-container *ngIf=\"!category.hide\">\r\n                        <span *ngIf=\"!category.hideTitle\" class=\"group-label\" (click)=\"changeStatus(category)\">\r\n                            <span *ngIf=\"isWhiteTheme\"\r\n                                class=\"f-icon f-icon-yxs_level mr-2\"></span>{{ category.categoryName }}</span>\r\n                        <div [hidden]=\"category.status === 'closed'\">\r\n                            <webide-property-item-list [category]=\"category\" [propertyData]=\"propertyData\"\r\n                                (valueChanged)=\"_valueChanged($event)\" (submitModal)=\"_submitModal($event)\"\r\n                                (triggerRefreshPanel)=\"refreshPanel()\" [dynamicControl]=\"dynamicControl\">\r\n                            </webide-property-item-list>\r\n                        </div>\r\n                    </ng-container>\r\n                </li>\r\n            </ul>\r\n        </div>\r\n    </div>\r\n\r\n</div>",
                styles: [":host{width:inherit;height:inherit}.propertyPanel{width:100%;height:100%;color:rgba(0,0,0,.75);background:#f3f8ff!important;border-color:#d8dbe2!important}.propertyPanel .title{position:relative;background:#d0d8e9!important;padding-right:40px;flex-wrap:wrap;border:0}.propertyPanel .title>.title-label{line-height:34px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;padding-left:12px;padding-right:12px;color:#333;font-size:14px;font-weight:600;cursor:pointer}.propertyPanel .title>.title-label.active{background:#8fb1df!important}.propertyPanel .title .title-actions{padding-left:35px;height:35px;flex:1;box-sizing:border-box;position:absolute;right:10px;top:0}.propertyPanel .property-grid .group-label{line-height:30px;display:block;padding-left:12px;cursor:pointer;background:#e2e9f6!important;color:#34495e!important;font-weight:600!important}.propertyPanel .panel-body{overflow:auto;height:100%}.propertyPanel .property-grid{list-style:none;margin:0;padding:0}.propertyPanel .panel-body .property-grid .group-label+div{padding-bottom:14px!important;padding-top:.25rem!important}.propertyPanel .action-item{cursor:pointer;display:inline-block;transition:transform 50ms;position:relative;padding:0}.propertyPanel .action-item .hide-panel{height:35px;display:block;line-height:35px;min-width:28px;color:rgba(66,66,66,.75);background-color:transparent!important;outline:0!important;background:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='16' height='16' viewBox='0 0 16 16' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M9.784 8L13 11.217 11.215 13 8.001 9.786 4.785 13 3 11.216l3.214-3.215L3 4.785 4.784 3 8 6.216 11.216 3 13 4.785 9.784 8.001z' fill='%23424242'/%3E%3C/svg%3E\") 50% 50% no-repeat}.white-theme .propertyPanel{border:1px solid #d8dce6!important;background:#fff!important}.white-theme .propertyPanel .title{justify-content:space-around;overflow:visible;background:#fff!important;flex-wrap:wrap;text-align:center}.white-theme .propertyPanel .title>.title-label{border-bottom:0;font-weight:400!important;background:#fff!important;flex:1}.white-theme .propertyPanel .title>.title-label.active{border-bottom:3px solid #705dcc}.white-theme .propertyPanel .property-grid .group-label{background:#fff!important;line-height:32px;font-weight:400!important;border-top:1px solid #d8dce6!important}"]
            }] }
];
/** @nocollapse */
PropertyPanelComponent.ctorParameters = () => [];
PropertyPanelComponent.propDecorators = {
    width: [{ type: Input }],
    height: [{ type: Input }],
    isWhiteTheme: [{ type: Input }],
    isPersitOpenState: [{ type: Input }],
    isShowPanel: [{ type: Input }],
    closePropertyPanel: [{ type: Output }],
    propertyConfig: [{ type: Input }],
    propertyData: [{ type: Input }],
    dynamicControl: [{ type: Input }],
    propertyChanged: [{ type: Output }],
    submitModal: [{ type: Output }],
    showCloseBtn: [{ type: Input }],
    eastDiv: [{ type: ViewChild, args: ['east',] }],
    itemLists: [{ type: ViewChildren, args: [PropertyItemListComponent,] }]
};
if (false) {
    /** @type {?} */
    PropertyPanelComponent.prototype.width;
    /** @type {?} */
    PropertyPanelComponent.prototype.height;
    /**
     * 是否白色主题
     * @type {?}
     */
    PropertyPanelComponent.prototype.isWhiteTheme;
    /**
     * 是否持有面板的隐藏显示状态
     * @type {?}
     */
    PropertyPanelComponent.prototype.isPersitOpenState;
    /**
     * isPersitOpenState=true时，控制面板是否隐藏显示
     * @type {?}
     */
    PropertyPanelComponent.prototype.isShowPanel;
    /**
     * isPersitOpenState=true时，抛出面板的关闭事件
     * @type {?}
     */
    PropertyPanelComponent.prototype.closePropertyPanel;
    /**
     * 属性类型
     * @type {?}
     */
    PropertyPanelComponent.prototype.propertyConfig;
    /**
     * 属性值
     * @type {?}
     */
    PropertyPanelComponent.prototype.propertyData;
    /** @type {?} */
    PropertyPanelComponent.prototype.dynamicControl;
    /**
     * 属性变更事件
     * @type {?}
     */
    PropertyPanelComponent.prototype.propertyChanged;
    /**
     * 模态框属性变更事件
     * @type {?}
     */
    PropertyPanelComponent.prototype.submitModal;
    /**
     * 是否展示关闭按钮
     * @type {?}
     */
    PropertyPanelComponent.prototype.showCloseBtn;
    /**
     * @type {?}
     * @private
     */
    PropertyPanelComponent.prototype.eastDiv;
    /** @type {?} */
    PropertyPanelComponent.prototype.itemLists;
    /**
     * 当前展示状态
     * @type {?}
     */
    PropertyPanelComponent.prototype.isOpen;
    /**
     * 外层分类，以标签页形式展示
     * @type {?}
     */
    PropertyPanelComponent.prototype.categoryTabs;
    /**
     * 当前选中的标签页
     * @type {?}
     */
    PropertyPanelComponent.prototype.selectedTab;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicHJvcGVydHktcGFuZWwuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGZhcnJpcy9pZGUtcHJvcGVydHktcGFuZWwvIiwic291cmNlcyI6WyJsaWIvcHJvcGVydHktcGFuZWwvY29tcG9uZW50cy9wcm9wZXJ0eS1wYW5lbC9wcm9wZXJ0eS1wYW5lbC5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUFBLE9BQU8sRUFDTCxTQUFTLEVBQVUsS0FBSyxFQUFFLFNBQVMsRUFBRSxVQUFVLEVBQUUsTUFBTSxFQUN2RCxZQUFZLEVBQTRCLFlBQVksRUFDckQsTUFBTSxlQUFlLENBQUM7QUFFdkIsT0FBTyxFQUFFLHlCQUF5QixFQUFFLE1BQU0sb0RBQW9ELENBQUM7QUFPL0YsTUFBTSxPQUFPLHNCQUFzQjtJQWlEakM7Ozs7UUE1Q1MsaUJBQVksR0FBRyxLQUFLLENBQUM7Ozs7UUFHckIsc0JBQWlCLEdBQUcsS0FBSyxDQUFDOzs7O1FBRzFCLGdCQUFXLEdBQUcsS0FBSyxDQUFDOzs7O1FBR25CLHVCQUFrQixHQUFHLElBQUksWUFBWSxFQUFPLENBQUM7Ozs7UUFNOUMsaUJBQVksR0FBRyxFQUFFLENBQUM7UUFHbEIsbUJBQWMsR0FBRyxLQUFLLENBQUM7Ozs7UUFJdEIsb0JBQWUsR0FBRyxJQUFJLFlBQVksRUFBTyxDQUFDOzs7O1FBRzFDLGdCQUFXLEdBQUcsSUFBSSxZQUFZLEVBQU8sQ0FBQzs7OztRQUd2QyxpQkFBWSxHQUFHLElBQUksQ0FBQzs7OztRQU83QixXQUFNLEdBQUcsSUFBSSxDQUFDOzs7O1FBR2QsaUJBQVksR0FBRyxFQUFFLENBQUM7SUFNRixDQUFDOzs7O0lBRWpCLFFBQVE7UUFFTixJQUFJLElBQUksQ0FBQyxLQUFLLEVBQUU7WUFDZCxJQUFJLENBQUMsT0FBTyxDQUFDLGFBQWEsQ0FBQyxLQUFLLENBQUMsS0FBSyxHQUFHLElBQUksQ0FBQyxLQUFLLEdBQUcsSUFBSSxDQUFDO1NBQzVEO2FBQU07WUFD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QyxHQUFHLENBQUMsS0FBSyxLQUFLLElBQUksQ0FBQyxXQUFXLENBQUMsS0FBSyxFQUFDO1lBQ3ZGLElBQUksV0FBVyxFQUFFO2dCQUNmLElBQUksQ0FBQyxXQUFXLEdBQUcsV0FBVyxDQUFDO2FBQ2hDO1NBQ0Y7YUFBTTtZQUNMLElBQUksQ0FBQyxXQUFXLEdBQUcsSUFBSSxDQUFDLFlBQVksQ0FBQyxDQUFDLENBQUMsQ0FBQztTQUN6QztJQUlILENBQUM7OztZQXBMRixTQUFTLFNBQUM7Z0JBQ1QsUUFBUSxFQUFFLG9CQUFvQjtnQkFDOUIsc3pFQUE4Qzs7YUFFL0M7Ozs7O29CQUVFLEtBQUs7cUJBQ0wsS0FBSzsyQkFHTCxLQUFLO2dDQUdMLEtBQUs7MEJBR0wsS0FBSztpQ0FHTCxNQUFNOzZCQUdOLEtBQUs7MkJBR0wsS0FBSzs2QkFHTCxLQUFLOzhCQUlMLE1BQU07MEJBR04sTUFBTTsyQkFHTixLQUFLO3NCQUdMLFNBQVMsU0FBQyxNQUFNO3dCQUNoQixZQUFZLFNBQUMseUJBQXlCOzs7O0lBcEN2Qyx1Q0FBdUI7O0lBQ3ZCLHdDQUF3Qjs7Ozs7SUFHeEIsOENBQThCOzs7OztJQUc5QixtREFBbUM7Ozs7O0lBR25DLDZDQUE2Qjs7Ozs7SUFHN0Isb0RBQXVEOzs7OztJQUd2RCxnREFBaUQ7Ozs7O0lBR2pELDhDQUEyQjs7SUFHM0IsZ0RBQWdDOzs7OztJQUloQyxpREFBb0Q7Ozs7O0lBR3BELDZDQUFnRDs7Ozs7SUFHaEQsOENBQTZCOzs7OztJQUc3Qix5Q0FBK0M7O0lBQy9DLDJDQUFxRjs7Ozs7SUFHckYsd0NBQWM7Ozs7O0lBR2QsOENBQWtCOzs7OztJQUdsQiw2Q0FBaUIiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xyXG4gIENvbXBvbmVudCwgT25Jbml0LCBJbnB1dCwgVmlld0NoaWxkLCBFbGVtZW50UmVmLCBPdXRwdXQsXHJcbiAgRXZlbnRFbWl0dGVyLCBPbkNoYW5nZXMsIFNpbXBsZUNoYW5nZXMsIFZpZXdDaGlsZHJlbiwgSG9zdEJpbmRpbmdcclxufSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgRWxlbWVudFByb3BlcnR5Q29uZmlnLCBQcm9wZXJ0eUNoYW5nZU9iamVjdCB9IGZyb20gJy4uLy4uL2VudGl0eS9wcm9wZXJ0eS1lbnRpdHknO1xyXG5pbXBvcnQgeyBQcm9wZXJ0eUl0ZW1MaXN0Q29tcG9uZW50IH0gZnJvbSAnLi4vcHJvcGVydHktaXRlbS1saXN0L3Byb3BlcnR5LWl0ZW0tbGlzdC5jb21wb25lbnQnO1xyXG5cclxuQENvbXBvbmVudCh7XHJcbiAgc2VsZWN0b3I6ICdhcHAtcHJvcGVydHktcGFuZWwnLFxyXG4gIHRlbXBsYXRlVXJsOiAnLi9wcm9wZXJ0eS1wYW5lbC5jb21wb25lbnQuaHRtbCcsXHJcbiAgc3R5bGVVcmxzOiBbJy4vcHJvcGVydHktcGFuZWwuY29tcG9uZW50LmNzcyddXHJcbn0pXHJcbmV4cG9ydCBjbGFzcyBQcm9wZXJ0eVBhbmVsQ29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0LCBPbkNoYW5nZXMge1xyXG4gIEBJbnB1dCgpIHdpZHRoOiBudW1iZXI7XHJcbiAgQElucHV0KCkgaGVpZ2h0OiBudW1iZXI7XHJcblxyXG4gIC8qKiDmmK/lkKbnmb3oibLkuLvpopggKi9cclxuICBASW5wdXQoKSBpc1doaXRlVGhlbWUgPSBmYWxzZTtcclxuXHJcbiAgLyoqIOaYr+WQpuaMgeaciemdouadv+eahOmakOiXj+aYvuekuueKtuaAgSAqL1xyXG4gIEBJbnB1dCgpIGlzUGVyc2l0T3BlblN0YXRlID0gZmFsc2U7XHJcblxyXG4gIC8qKiBpc1BlcnNpdE9wZW5TdGF0ZT10cnVl5pe277yM5o6n5Yi26Z2i5p2/5piv5ZCm6ZqQ6JeP5pi+56S6ICovXHJcbiAgQElucHV0KCkgaXNTaG93UGFuZWwgPSBmYWxzZTtcclxuXHJcbiAgLyoqIGlzUGVyc2l0T3BlblN0YXRlPXRydWXml7bvvIzmipvlh7rpnaLmnb/nmoTlhbPpl63kuovku7YgKi9cclxuICBAT3V0cHV0KCkgY2xvc2VQcm9wZXJ0eVBhbmVsID0gbmV3IEV2ZW50RW1pdHRlcjxhbnk+KCk7XHJcblxyXG4gIC8qKiDlsZ7mgKfnsbvlnosgKi9cclxuICBASW5wdXQoKSBwcm9wZXJ0eUNvbmZpZzogRWxlbWVudFByb3BlcnR5Q29uZmlnW107XHJcblxyXG4gIC8qKiAg5bGe5oCn5YC8ICovXHJcbiAgQElucHV0KCkgcHJvcGVydHlEYXRhID0ge307XHJcblxyXG5cclxuICBASW5wdXQoKSBkeW5hbWljQ29udHJvbCA9IGZhbHNlO1xyXG5cclxuXHJcbiAgLyoqIOWxnuaAp+WPmOabtOS6i+S7tiAqL1xyXG4gIEBPdXRwdXQoKSBwcm9wZXJ0eUNoYW5nZWQgPSBuZXcgRXZlbnRFbWl0dGVyPGFueT4oKTtcclxuXHJcbiAgLyoqIOaooeaAgeahhuWxnuaAp+WPmOabtOS6i+S7tiAgICovXHJcbiAgQE91dHB1dCgpIHN1Ym1pdE1vZGFsID0gbmV3IEV2ZW50RW1pdHRlcjxhbnk+KCk7XHJcblxyXG4gIC8qKiDmmK/lkKblsZXnpLrlhbPpl63mjInpkq4gKi9cclxuICBASW5wdXQoKSBzaG93Q2xvc2VCdG4gPSB0cnVlO1xyXG5cclxuXHJcbiAgQFZpZXdDaGlsZCgnZWFzdCcpIHByaXZhdGUgZWFzdERpdjogRWxlbWVudFJlZjtcclxuICBAVmlld0NoaWxkcmVuKFByb3BlcnR5SXRlbUxpc3RDb21wb25lbnQpIGl0ZW1MaXN0czogQXJyYXk8UHJvcGVydHlJdGVtTGlzdENvbXBvbmVudD47XHJcblxyXG4gIC8qKiDlvZPliY3lsZXnpLrnirbmgIEgKi9cclxuICBpc09wZW4gPSB0cnVlO1xyXG5cclxuICAvKiog5aSW5bGC5YiG57G777yM5Lul5qCH562+6aG15b2i5byP5bGV56S6ICovXHJcbiAgY2F0ZWdvcnlUYWJzID0gW107XHJcblxyXG4gIC8qKiDlvZPliY3pgInkuK3nmoTmoIfnrb7pobUgKi9cclxuICBzZWxlY3RlZFRhYjogYW55O1xyXG5cclxuXHJcbiAgY29uc3RydWN0b3IoKSB7IH1cclxuXHJcbiAgbmdPbkluaXQoKSB7XHJcblxyXG4gICAgaWYgKHRoaXMud2lkdGgpIHtcclxuICAgICAgdGhpcy5lYXN0RGl2Lm5hdGl2ZUVsZW1lbnQuc3R5bGUud2lkdGggPSB0aGlzLndpZHRoICsgJ3B4JztcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuZWFzdERpdi5uYXRpdmVFbGVtZW50LnN0eWxlLndpZHRoID0gJ2luaGVyaXQnO1xyXG4gICAgfVxyXG4gICAgaWYgKHRoaXMuaGVpZ2h0KSB7XHJcbiAgICAgIHRoaXMuZWFzdERpdi5uYXRpdmVFbGVtZW50LnN0eWxlLmhlaWdodCA9IHRoaXMuaGVpZ2h0ICsgJ3B4JztcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuZWFzdERpdi5uYXRpdmVFbGVtZW50LnN0eWxlLmhlaWdodCA9ICcxMDAlJztcclxuICAgIH1cclxuXHJcblxyXG4gICAgaWYgKHRoaXMuaXNQZXJzaXRPcGVuU3RhdGUpIHtcclxuICAgICAgdGhpcy5pc09wZW4gPSB0aGlzLmlzU2hvd1BhbmVsO1xyXG4gICAgfVxyXG5cclxuICAgIHRoaXMuY2hlY2tTaG93VGFiQ2F0ZWdvcnkoKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqICDmm7TmlLnpnaLmnb/nmoTpmpDol4/mmL7npLrnirbmgIHvvIzlj6rmnInlnKhpc1BlcnNpdE9wZW5TdGF0ZT10cnVl5pe255Sf5pWIXHJcbiAgICovXHJcbiAgbmdPbkNoYW5nZXMoc2ltcGxlQ2hhbmdlczogU2ltcGxlQ2hhbmdlcykge1xyXG4gICAgaWYgKHNpbXBsZUNoYW5nZXMuaXNTaG93UGFuZWwgJiYgdGhpcy5pc1BlcnNpdE9wZW5TdGF0ZSkge1xyXG4gICAgICB0aGlzLmlzT3BlbiA9IHRoaXMuaXNTaG93UGFuZWw7XHJcbiAgICB9XHJcbiAgICB0aGlzLmNoZWNrU2hvd1RhYkNhdGVnb3J5KCk7XHJcbiAgfVxyXG4gIHJlZnJlc2hQYW5lbCgpIHtcclxuICAgIHRoaXMuY2hlY2tTaG93VGFiQ2F0ZWdvcnkoKTtcclxuICAgIHRoaXMuaXRlbUxpc3RzLmZvckVhY2goaXRlbSA9PiBpdGVtLnJlZnJlc2goKSk7XHJcbiAgfVxyXG4gIGNoYW5nZVN0YXR1cyhpdGVtOiBhbnkpIHtcclxuICAgIGlmICh0aGlzLnByb3BlcnR5Q29uZmlnLmxlbmd0aCA8IDIpIHtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgaWYgKCFpdGVtLnN0YXR1cyB8fCBpdGVtLnN0YXR1cyA9PT0gJ29wZW4nKSB7XHJcbiAgICAgIGl0ZW0uc3RhdHVzID0gJ2Nsb3NlZCc7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBpdGVtLnN0YXR1cyA9ICdvcGVuJztcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqICDpmpDol4/pnaLmnb9cclxuICAgKi9cclxuICBjb2xsYXBzZSgpIHtcclxuICAgIC8vIGlzUGVyc2l0T3BlblN0YXRlPXRydWXml7Ys55Sx5aSW6YOo56Gu5a6a54q25oCBXHJcbiAgICBpZiAoIXRoaXMuaXNQZXJzaXRPcGVuU3RhdGUpIHtcclxuICAgICAgdGhpcy5pc09wZW4gPSBmYWxzZTtcclxuICAgIH1cclxuICAgIHRoaXMuY2xvc2VQcm9wZXJ0eVBhbmVsLmVtaXQoKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOaKm+WHuuWxnuaAp+WPmOabtOS6i+S7tlxyXG4gICAqL1xyXG4gIF92YWx1ZUNoYW5nZWQoY2hhbmdlT2JqZWN0OiBQcm9wZXJ0eUNoYW5nZU9iamVjdCkge1xyXG4gICAgdGhpcy5wcm9wZXJ0eUNoYW5nZWQuZW1pdChjaGFuZ2VPYmplY3QpO1xyXG4gIH1cclxuICBfc3VibWl0TW9kYWwoJGV2ZW50OiBQcm9wZXJ0eUNoYW5nZU9iamVjdCkge1xyXG4gICAgdGhpcy5zdWJtaXRNb2RhbC5lbWl0KCRldmVudCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDlsIblsZ7mgKfliIbnsbvmjInnhafmoIfnrb7pobXov5vooYzlvZLnsbtcclxuICAgKi9cclxuICBwcml2YXRlIGNoZWNrU2hvd1RhYkNhdGVnb3J5KCkge1xyXG4gICAgdGhpcy5jYXRlZ29yeVRhYnMgPSBbXTtcclxuICAgIGlmICghdGhpcy5wcm9wZXJ0eUNvbmZpZyB8fCB0aGlzLnByb3BlcnR5Q29uZmlnLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICB0aGlzLmNhdGVnb3J5VGFicyA9IFt7XHJcbiAgICAgICAgdGFiSWQ6ICdkZWZhdWx0JyxcclxuICAgICAgICB0YWJOYW1lOiAn5bGe5oCnJyxcclxuICAgICAgICBjYXRlZ29yeUxpc3Q6IFtdXHJcbiAgICAgIH1dO1xyXG4gICAgICB0aGlzLnNlbGVjdGVkVGFiID0gbnVsbDtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgdGhpcy5wcm9wZXJ0eUNvbmZpZy5mb3JFYWNoKGNvbmZpZyA9PiB7XHJcbiAgICAgIGlmIChjb25maWcudGFiSWQpIHtcclxuICAgICAgICBjb25zdCBwcm9wVGFiID0gdGhpcy5jYXRlZ29yeVRhYnMuZmluZCh0ID0+IHQudGFiSWQgPT09IGNvbmZpZy50YWJJZCk7XHJcbiAgICAgICAgaWYgKCFwcm9wVGFiKSB7XHJcbiAgICAgICAgICB0aGlzLmNhdGVnb3J5VGFicy5wdXNoKHtcclxuICAgICAgICAgICAgdGFiSWQ6IGNvbmZpZy50YWJJZCxcclxuICAgICAgICAgICAgdGFiTmFtZTogY29uZmlnLnRhYk5hbWUsXHJcbiAgICAgICAgICAgIGNhdGVnb3J5TGlzdDogW2NvbmZpZ10sXHJcbiAgICAgICAgICAgIGhpZGU6IGNvbmZpZy5oaWRlIHx8IGNvbmZpZy5wcm9wZXJ0aWVzLmxlbmd0aCA9PT0gMFxyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuXHJcbiAgICAgICAgICBwcm9wVGFiLmNhdGVnb3J5TGlzdC5wdXNoKGNvbmZpZyk7XHJcbiAgICAgICAgICBpZiAocHJvcFRhYi5oaWRlKSB7XHJcbiAgICAgICAgICAgIHByb3BUYWIuaGlkZSA9IGNvbmZpZy5oaWRlIHx8IGNvbmZpZy5wcm9wZXJ0aWVzLmxlbmd0aCA9PT0gMDtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgY29uc3QgZGVmYXVsdFRhYiA9IHRoaXMuY2F0ZWdvcnlUYWJzLmZpbmQodCA9PiB0LnRhYklkID09PSAnZGVmYXVsdCcpO1xyXG4gICAgICAgIGlmICghZGVmYXVsdFRhYikge1xyXG4gICAgICAgICAgdGhpcy5jYXRlZ29yeVRhYnMucHVzaCh7XHJcbiAgICAgICAgICAgIHRhYklkOiAnZGVmYXVsdCcsXHJcbiAgICAgICAgICAgIHRhYk5hbWU6ICflsZ7mgKcnLFxyXG4gICAgICAgICAgICBjYXRlZ29yeUxpc3Q6IFtjb25maWddXHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgZGVmYXVsdFRhYi5jYXRlZ29yeUxpc3QucHVzaChjb25maWcpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIC8vIOiusOW9leW3sumAieeahOmhteetvlxyXG4gICAgaWYgKHRoaXMuc2VsZWN0ZWRUYWIpIHtcclxuICAgICAgY29uc3Qgc2VsZWN0ZWRUYWIgPSB0aGlzLmNhdGVnb3J5VGFicy5maW5kKHRhYiA9PiB0YWIudGFiSWQgPT09IHRoaXMuc2VsZWN0ZWRUYWIudGFiSWQpO1xyXG4gICAgICBpZiAoc2VsZWN0ZWRUYWIpIHtcclxuICAgICAgICB0aGlzLnNlbGVjdGVkVGFiID0gc2VsZWN0ZWRUYWI7XHJcbiAgICAgIH1cclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuc2VsZWN0ZWRUYWIgPSB0aGlzLmNhdGVnb3J5VGFic1swXTtcclxuICAgIH1cclxuXHJcblxyXG5cclxuICB9XHJcbn1cclxuIl19