{"version":3,"file":"farris-oa-command-services.umd.js.map","sources":["ng://@farris/oa-command-services/lib/data-services/list-data.service.ts","ng://@farris/oa-command-services/lib/print-web-page/entity.ts","ng://@farris/oa-command-services/lib/print-web-page/print-web-page.service.ts","ng://@farris/oa-command-services/lib/utils/sync-task-shchdule.ts","ng://@farris/oa-command-services/lib/task-center-bridge/entity.ts","ng://@farris/oa-command-services/lib/task-center-bridge/task-center-bridge.service.ts","ng://@farris/oa-command-services/lib/transit-approval/transit-approval.service.ts","ng://@farris/oa-command-services/lib/oa-command-services-module.ts"],"sourcesContent":["import { Injectable } from \"@angular/core\";\r\nimport { BindingData, Repository } from '@farris/devkit';\r\nimport { MessagerService } from '@farris/ui-messager';\r\nimport { NotifyService } from '@farris/ui-notify';\r\nimport { empty, Observable, of } from \"rxjs\";\r\nimport { concatMap, switchMap, tap } from 'rxjs/operators';\r\n\r\nimport { FrameContext } from '@farris/devkit';\r\n@Injectable()\r\nexport class OAListDataService {\r\n\r\n  constructor(\r\n    private msgService: MessagerService,\r\n    private notifySer: NotifyService,\r\n  ) { }\r\n\r\n\r\n  public filterAndRemoveRows(ids: string[], ifSave?: boolean | string): Observable<any> {\r\n    if (!ids || ids.length === 0) {\r\n      this.notifySer.error('请选择要删除的数据！');\r\n      return empty();\r\n    }\r\n\r\n    let frameContext: FrameContext;\r\n    try {\r\n      frameContext = this['context'].frameContext\r\n    } catch (error) {\r\n      throw new Error('can not find frameContex');\r\n    }\r\n    const bindingData: BindingData = frameContext['bindingData'];\r\n    const removableIds = [];\r\n\r\n    ids.forEach((id) => {\r\n      const rowData = bindingData.list.findById(id);\r\n      if (rowData && rowData['billState'] && rowData['billState']['billState'] === 'Billing') {\r\n        removableIds.push(id);\r\n      }\r\n    })\r\n\r\n    if (!removableIds.length) {\r\n      this.notifySer.error('没有可删除的数据！');\r\n      return empty();\r\n    }\r\n\r\n    const action$ = this.msgService.confirm('确认删除？');\r\n    return action$.pipe(\r\n      concatMap(result => {\r\n        if (!result) {\r\n          return empty();\r\n        }\r\n        if (typeof ifSave === 'undefined') {\r\n          ifSave = true;\r\n        }\r\n        if (typeof ifSave === 'string') {\r\n          ifSave = ifSave.toLowerCase() === 'false' ? false : true;\r\n        }\r\n        ifSave = (ifSave === false) ? false : true;\r\n\r\n        let repository: Repository<any>;\r\n        try {\r\n          repository = frameContext['repository']\r\n        } catch (error) {\r\n          return empty();\r\n        }\r\n\r\n        const remove$ = repository.removeByIds(removableIds, ifSave);\r\n\r\n        if (!remove$) {\r\n          return empty();\r\n        }\r\n\r\n        return remove$.pipe(\r\n          tap(\r\n            () => {\r\n              this.notifySer.success('删除成功！');\r\n            },\r\n            error => {\r\n              this.msgService.error(error);\r\n            }\r\n          ),\r\n          switchMap(() => {\r\n            return of([]);\r\n          })\r\n        );\r\n      })\r\n    );\r\n  }\r\n\r\n}","\r\nexport enum templateType {\r\n  card = \"card\"\r\n}","import { Injectable } from \"@angular/core\";\r\nimport { MessagerService } from '@farris/ui-messager';\r\nimport { templateType } from \"./entity\";\r\n@Injectable()\r\nexport class PrintWebPageService {\r\n\r\n  private currentTemplate: templateType;\r\n\r\n  constructor(\r\n\r\n    private msgSer: MessagerService\r\n  ) {\r\n    window.onbeforeprint = () => {\r\n      if (this.currentTemplate == templateType.card) {\r\n        const rootLayout = document.getElementById('root-layout');\r\n        const mainContainer = document.getElementById('main-container');\r\n        if (rootLayout && mainContainer) {\r\n          rootLayout.style.display = 'block';\r\n          rootLayout.style.position = 'relative';\r\n          mainContainer.style.display = 'block';\r\n          rootLayout.parentElement.style.position = 'relative';\r\n          document.title = '';\r\n        } else {\r\n          this.msgSer.error('未找到模板中关键节点，请检查命令传参中模板类型是否正确。');\r\n        }\r\n      }\r\n    }\r\n    window.onafterprint = () => {\r\n      if (this.currentTemplate == templateType.card) {\r\n        const rootLayout = document.getElementById('root-layout');\r\n        const mainContainer = document.getElementById('main-container');\r\n        if (rootLayout && mainContainer) {\r\n          mainContainer.setAttribute('style', '');\r\n          rootLayout.setAttribute('style', '');\r\n          rootLayout.parentElement.setAttribute('style', '');\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  public printWebPage(tempType: templateType = templateType.card) {\r\n    this.currentTemplate = tempType;\r\n    if (!window.navigator.userAgent.includes('AppleWebKit/')) {\r\n      this.msgSer.prompt('提示', '为保证打印效果，推荐使用谷歌浏览器进行打印。是否继续打印？').subscribe((confirmed) => {\r\n        if (confirmed) {\r\n          window.print()\r\n        }\r\n      });\r\n    } else {\r\n      window.print()\r\n    }\r\n  }\r\n\r\n}","import { Subject } from \"rxjs\";\r\n\r\n\r\nexport enum ScheduleResultType {\r\n  Finally = \"finally\",\r\n  Progress = \"progress\",\r\n  Error = \"error\",\r\n}\r\n\r\nexport interface ScheduleResult {\r\n  type: ScheduleResultType,\r\n  recentResult: any,\r\n  progressIndex: Number,\r\n  resultStack: Array<any>\r\n}\r\n\r\n\r\nexport class SyncTaskSchdule {\r\n\r\n  constructor() { }\r\n\r\n  private actIndex = 0;\r\n\r\n  private resultStack = [];\r\n\r\n  private status = 0;// 0 停止中 1 运行中\r\n\r\n  private taskResult: Subject<ScheduleResult> = new Subject();\r\n\r\n  private taskStack: Array<{\r\n    funName: string,\r\n    fun: Function,\r\n    params?: Array<any>,\r\n    context?: any\r\n  }> = [];\r\n\r\n  public propTask(fun: Function, params = [], context, key: string) {\r\n    this.taskStack.push({\r\n      funName: key,\r\n      fun: fun,\r\n      params: params,\r\n      context: context\r\n    });\r\n    // 未开始执行 需要手动吊起一次\r\n    if (!this.status) {\r\n      this.actTask().subscribe((res: ScheduleResult) => {\r\n        this.taskResult.next(res);\r\n      });\r\n    }\r\n    return this.taskResult;\r\n  }\r\n\r\n  private actTask() {\r\n    this.status = 1;\r\n    const result: Subject<ScheduleResult> = new Subject()\r\n    const actOne = this.taskStack[this.actIndex];\r\n    try {\r\n      actOne.fun.apply(actOne.context || window, actOne.params || []).subscribe((res) => {\r\n        this.resultStack.push(res);\r\n        result.next({\r\n          type: this.actIndex == this.taskStack.length - 1 ? ScheduleResultType.Finally : ScheduleResultType.Progress,\r\n          recentResult: res,\r\n          progressIndex: this.actIndex,\r\n          resultStack: this.resultStack\r\n        })\r\n        if (this.actIndex < this.taskStack.length - 1) {\r\n          this.actIndex++;\r\n          this.actTask();\r\n        } else {\r\n          this.status = 0;\r\n        }\r\n      });\r\n    } catch (error) {\r\n      this.resultStack.push(error);\r\n      result.next({\r\n        type: ScheduleResultType.Error,\r\n        recentResult: error,\r\n        progressIndex: this.actIndex,\r\n        resultStack: this.resultStack\r\n      })\r\n      if (this.actIndex < this.taskStack.length - 1) {\r\n        this.actIndex++;\r\n        this.actTask();\r\n      } else {\r\n        this.status = 0;\r\n      }\r\n    }\r\n    return result;\r\n  }\r\n\r\n\r\n}\r\n","\r\nexport enum WFActionType {\r\n  /** \r\n   * 审批通过\r\n  */\r\n  Pass = 'Pass',\r\n  /** \r\n   * \r\n  */\r\n  Resubmit = 'Resubmit',\r\n  /** \r\n   * 驳回\r\n  */\r\n  Back = 'Back',\r\n  /** \r\n   * 移交\r\n  */\r\n  Transfer = 'Transfer',\r\n  /** \r\n   * 评论\r\n  */\r\n  Comment = 'Comment'\r\n}\r\n\r\n\r\nexport interface Parameter {\r\n  code: string;\r\n  value: string;\r\n}\r\n\r\nexport interface Action {\r\n  code: string;\r\n  parameters: Parameter[];\r\n}\r\n\r\nexport interface WFTask {\r\n  id: string;\r\n  sourceId: string;\r\n  name: string;\r\n  state: string;\r\n  owner: string;\r\n  priority: number;\r\n  categoryId: string;\r\n  submitter: string;\r\n  startTime: string;\r\n  endTime: string;\r\n  processInstanceId: string;\r\n  refBizId: string;\r\n  submitterName: string;\r\n  bizCategory: string;\r\n  activityType: string;\r\n  activityDefinitionId: string;\r\n  activityInstanceId: string;\r\n  fromType: number;\r\n  tenantId: number;\r\n  readTime: string;\r\n  createdTime: string;\r\n  creator: string;\r\n  lastModifiedTime: string;\r\n  lastModifier: string;\r\n  actions: Action[];\r\n}\r\n\r\n\r\n\r\nexport type WFAction = {\r\n  \"code\": WFActionType,\r\n  \"parameters\": [],\r\n  \"id\": \"\",\r\n  \"name\": \"\",\r\n  \"sortOrder\": 13,\r\n  \"typeId\": \"wf\",\r\n  \"isBatchAction\": false,\r\n  \"isPrimaryAction\": false,\r\n  \"isHyperlinkAction\": false,\r\n  \"isCustomizeAction\": false,\r\n  \"terminal\": \"web,app\",\r\n  \"scope\": \"running\",\r\n  \"groupId\": \"complete\",\r\n  \"nameLanguage\": null,\r\n  \"preEvents\": [],\r\n  \"postEvents\": []\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { FrameContext } from '@farris/devkit';\r\nimport { MessagerService } from '@farris/ui-messager';\r\nimport { SyncTaskSchdule } from '../utils/sync-task-shchdule';\r\nimport { WFAction, WFActionType, WFTask } from './entity';\r\n\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class TaskCenterBridgeService {\r\n\r\n\r\n  taskSchdule: SyncTaskSchdule\r\n\r\n  constructor(\r\n    private msgService: MessagerService,\r\n  ) {\r\n    this.taskSchdule = new SyncTaskSchdule();\r\n  }\r\n\r\n  public initTaskCenterBridge(customerCmds: {}) {\r\n    const bridgeWin = window.parent;\r\n    let frameContext: FrameContext;\r\n    try {\r\n      frameContext = this['context'].frameContext\r\n    } catch (error) {\r\n      throw new Error('can not find frameContex');\r\n    }\r\n\r\n    let slienceSaveTask;\r\n\r\n    try {\r\n      slienceSaveTask = this['context'].frameContext.viewModel.slienceSave1;\r\n    } catch (error) {\r\n      // 不存在静音保存命令\r\n    }\r\n    if (bridgeWin) {\r\n      bridgeWin['taskCenterBeforeLoad'] = (\r\n        actionObj: {\r\n          \"task\": WFTask,\r\n          \"action\": WFAction\r\n        }\r\n      ) => {\r\n        return new Promise((resolve, reject) => {\r\n          const { action } = actionObj;\r\n          if (frameContext.uiState['UIStateInProcess'] == 'Approving' && frameContext.uiState['formConfigId']) {\r\n            slienceSaveTask.call(this).subscribe(() => {\r\n              resolve({\r\n                result: true\r\n              });\r\n            }, () => {\r\n              window.document.body.click()\r\n              if (action.code === WFActionType.Pass) { // 除了审评通过外，其它的不需要保存 \r\n                resolve({\r\n                  result: false\r\n                });\r\n              } else if (action.code === WFActionType.Comment) {\r\n                resolve({\r\n                  result: true\r\n                });\r\n              } else {\r\n                this.msgService.confirm('检测到单据保存失败，是否继续？').subscribe((confirm) => {\r\n                  resolve({\r\n                    result: confirm\r\n                  });\r\n                });\r\n              }\r\n            })\r\n          } else if (action.code == WFActionType.Resubmit && slienceSaveTask) {\r\n            slienceSaveTask.call(this).subscribe(() => {\r\n              resolve({\r\n                result: true\r\n              });\r\n            })\r\n          } else {\r\n            resolve({\r\n              result: true\r\n            });\r\n          }\r\n        })\r\n      }\r\n    }\r\n  }\r\n\r\n  public executeSchedules(taskArray) {\r\n    // 这里根据 任务名称，从 viewmodel中找到，然后依次执行\r\n    taskArray = taskArray.split(',');\r\n    // 这里需要验证拿到 commandService \r\n    let frameContext: FrameContext;\r\n    try {\r\n      frameContext = this['context'].frameContext\r\n    } catch (error) {\r\n      throw new Error('can not find frameContex');\r\n    }\r\n    taskArray.forEach((item) => {\r\n      let targetTask;\r\n      try {\r\n        targetTask = frameContext.viewModel[item];\r\n        this.taskSchdule.propTask(targetTask, [], this, item).subscribe((res) => {\r\n          console.log(res);\r\n        });\r\n      } catch (error) {\r\n        // 未找到应该在children中继续查找 未找到\r\n        console.log(error);\r\n      }\r\n    })\r\n\r\n  }\r\n\r\n}\r\n","import { Injectable, Injector } from '@angular/core';\r\n// import { StateMachineService } from '@farris/command-services';\r\nimport { FrameContext } from '@farris/devkit';\r\nimport { BehaviorSubject } from 'rxjs';\r\n\r\n@Injectable()\r\nexport class TransitApprovalStatus {\r\n    constructor(\r\n        private injetor: Injector\r\n    ) {\r\n        // 因为注位置的问题，这样子拿不到\r\n        // this.stateMachineSer = this.injetor.get(StateMachineService);\r\n    }\r\n    public switchStatus() {\r\n        const result: BehaviorSubject<string> = new BehaviorSubject('Cancel');\r\n        //  判断流程传参  formConfigId\r\n        let frameContext: FrameContext;\r\n        try {\r\n            frameContext = this['context'].frameContext\r\n        } catch (error) {\r\n            throw new Error('can not find frameContex');\r\n        }\r\n        if (frameContext.uiState['UIStateInProcess'] == 'Approving' && frameContext.uiState['formConfigId']) {\r\n            result.next('Edit');\r\n        }\r\n        return result;\r\n    }\r\n}","import { NgModule } from '@angular/core';\r\nimport { OAListDataService } from './data-services/list-data.service';\r\nimport { PrintWebPageService } from './print-web-page/print-web-page.service';\r\nimport { TaskCenterBridgeService } from './task-center-bridge/task-center-bridge.service';\r\nimport { TransitApprovalStatus } from './transit-approval/transit-approval.service';\r\n\r\n\r\n\r\n@NgModule({\r\n    providers: [\r\n        TaskCenterBridgeService,\r\n        PrintWebPageService,\r\n        TransitApprovalStatus,\r\n        OAListDataService\r\n    ],\r\n    imports: [\r\n\r\n    ],\r\n    exports: [\r\n\r\n    ],\r\n    entryComponents: [\r\n    ]\r\n})\r\nclass OACommandServicesModule {\r\n    constructor() { }\r\n}\r\n\r\nexport { OACommandServicesModule };\r\n\r\n"],"names":["empty","concatMap","tap","switchMap","of","Injectable","MessagerService","NotifyService","Subject","BehaviorSubject","Injector","NgModule"],"mappings":"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"}
