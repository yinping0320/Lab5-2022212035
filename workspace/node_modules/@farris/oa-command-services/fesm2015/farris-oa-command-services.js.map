{"version":3,"file":"farris-oa-command-services.js.map","sources":["ng://@farris/oa-command-services/lib/data-services/list-data.service.ts","ng://@farris/oa-command-services/lib/print-web-page/entity.ts","ng://@farris/oa-command-services/lib/print-web-page/print-web-page.service.ts","ng://@farris/oa-command-services/lib/utils/sync-task-shchdule.ts","ng://@farris/oa-command-services/lib/task-center-bridge/entity.ts","ng://@farris/oa-command-services/lib/task-center-bridge/task-center-bridge.service.ts","ng://@farris/oa-command-services/lib/transit-approval/transit-approval.service.ts","ng://@farris/oa-command-services/lib/oa-command-services-module.ts"],"sourcesContent":["import { Injectable } from \"@angular/core\";\r\nimport { BindingData, Repository } from '@farris/devkit';\r\nimport { MessagerService } from '@farris/ui-messager';\r\nimport { NotifyService } from '@farris/ui-notify';\r\nimport { empty, Observable, of } from \"rxjs\";\r\nimport { concatMap, switchMap, tap } from 'rxjs/operators';\r\n\r\nimport { FrameContext } from '@farris/devkit';\r\n@Injectable()\r\nexport class OAListDataService {\r\n\r\n  constructor(\r\n    private msgService: MessagerService,\r\n    private notifySer: NotifyService,\r\n  ) { }\r\n\r\n\r\n  public filterAndRemoveRows(ids: string[], ifSave?: boolean | string): Observable<any> {\r\n    if (!ids || ids.length === 0) {\r\n      this.notifySer.error('请选择要删除的数据！');\r\n      return empty();\r\n    }\r\n\r\n    let frameContext: FrameContext;\r\n    try {\r\n      frameContext = this['context'].frameContext\r\n    } catch (error) {\r\n      throw new Error('can not find frameContex');\r\n    }\r\n    const bindingData: BindingData = frameContext['bindingData'];\r\n    const removableIds = [];\r\n\r\n    ids.forEach((id) => {\r\n      const rowData = bindingData.list.findById(id);\r\n      if (rowData && rowData['billState'] && rowData['billState']['billState'] === 'Billing') {\r\n        removableIds.push(id);\r\n      }\r\n    })\r\n\r\n    if (!removableIds.length) {\r\n      this.notifySer.error('没有可删除的数据！');\r\n      return empty();\r\n    }\r\n\r\n    const action$ = this.msgService.confirm('确认删除？');\r\n    return action$.pipe(\r\n      concatMap(result => {\r\n        if (!result) {\r\n          return empty();\r\n        }\r\n        if (typeof ifSave === 'undefined') {\r\n          ifSave = true;\r\n        }\r\n        if (typeof ifSave === 'string') {\r\n          ifSave = ifSave.toLowerCase() === 'false' ? false : true;\r\n        }\r\n        ifSave = (ifSave === false) ? false : true;\r\n\r\n        let repository: Repository<any>;\r\n        try {\r\n          repository = frameContext['repository']\r\n        } catch (error) {\r\n          return empty();\r\n        }\r\n\r\n        const remove$ = repository.removeByIds(removableIds, ifSave);\r\n\r\n        if (!remove$) {\r\n          return empty();\r\n        }\r\n\r\n        return remove$.pipe(\r\n          tap(\r\n            () => {\r\n              this.notifySer.success('删除成功！');\r\n            },\r\n            error => {\r\n              this.msgService.error(error);\r\n            }\r\n          ),\r\n          switchMap(() => {\r\n            return of([]);\r\n          })\r\n        );\r\n      })\r\n    );\r\n  }\r\n\r\n}","\r\nexport enum templateType {\r\n  card = \"card\"\r\n}","import { Injectable } from \"@angular/core\";\r\nimport { MessagerService } from '@farris/ui-messager';\r\nimport { templateType } from \"./entity\";\r\n@Injectable()\r\nexport class PrintWebPageService {\r\n\r\n  private currentTemplate: templateType;\r\n\r\n  constructor(\r\n\r\n    private msgSer: MessagerService\r\n  ) {\r\n    window.onbeforeprint = () => {\r\n      if (this.currentTemplate == templateType.card) {\r\n        const rootLayout = document.getElementById('root-layout');\r\n        const mainContainer = document.getElementById('main-container');\r\n        if (rootLayout && mainContainer) {\r\n          rootLayout.style.display = 'block';\r\n          rootLayout.style.position = 'relative';\r\n          mainContainer.style.display = 'block';\r\n          rootLayout.parentElement.style.position = 'relative';\r\n          document.title = '';\r\n        } else {\r\n          this.msgSer.error('未找到模板中关键节点，请检查命令传参中模板类型是否正确。');\r\n        }\r\n      }\r\n    }\r\n    window.onafterprint = () => {\r\n      if (this.currentTemplate == templateType.card) {\r\n        const rootLayout = document.getElementById('root-layout');\r\n        const mainContainer = document.getElementById('main-container');\r\n        if (rootLayout && mainContainer) {\r\n          mainContainer.setAttribute('style', '');\r\n          rootLayout.setAttribute('style', '');\r\n          rootLayout.parentElement.setAttribute('style', '');\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  public printWebPage(tempType: templateType = templateType.card) {\r\n    this.currentTemplate = tempType;\r\n    if (!window.navigator.userAgent.includes('AppleWebKit/')) {\r\n      this.msgSer.prompt('提示', '为保证打印效果，推荐使用谷歌浏览器进行打印。是否继续打印？').subscribe((confirmed) => {\r\n        if (confirmed) {\r\n          window.print()\r\n        }\r\n      });\r\n    } else {\r\n      window.print()\r\n    }\r\n  }\r\n\r\n}","import { Subject } from \"rxjs\";\r\n\r\n\r\nexport enum ScheduleResultType {\r\n  Finally = \"finally\",\r\n  Progress = \"progress\",\r\n  Error = \"error\",\r\n}\r\n\r\nexport interface ScheduleResult {\r\n  type: ScheduleResultType,\r\n  recentResult: any,\r\n  progressIndex: Number,\r\n  resultStack: Array<any>\r\n}\r\n\r\n\r\nexport class SyncTaskSchdule {\r\n\r\n  constructor() { }\r\n\r\n  private actIndex = 0;\r\n\r\n  private resultStack = [];\r\n\r\n  private status = 0;// 0 停止中 1 运行中\r\n\r\n  private taskResult: Subject<ScheduleResult> = new Subject();\r\n\r\n  private taskStack: Array<{\r\n    funName: string,\r\n    fun: Function,\r\n    params?: Array<any>,\r\n    context?: any\r\n  }> = [];\r\n\r\n  public propTask(fun: Function, params = [], context, key: string) {\r\n    this.taskStack.push({\r\n      funName: key,\r\n      fun: fun,\r\n      params: params,\r\n      context: context\r\n    });\r\n    // 未开始执行 需要手动吊起一次\r\n    if (!this.status) {\r\n      this.actTask().subscribe((res: ScheduleResult) => {\r\n        this.taskResult.next(res);\r\n      });\r\n    }\r\n    return this.taskResult;\r\n  }\r\n\r\n  private actTask() {\r\n    this.status = 1;\r\n    const result: Subject<ScheduleResult> = new Subject()\r\n    const actOne = this.taskStack[this.actIndex];\r\n    try {\r\n      actOne.fun.apply(actOne.context || window, actOne.params || []).subscribe((res) => {\r\n        this.resultStack.push(res);\r\n        result.next({\r\n          type: this.actIndex == this.taskStack.length - 1 ? ScheduleResultType.Finally : ScheduleResultType.Progress,\r\n          recentResult: res,\r\n          progressIndex: this.actIndex,\r\n          resultStack: this.resultStack\r\n        })\r\n        if (this.actIndex < this.taskStack.length - 1) {\r\n          this.actIndex++;\r\n          this.actTask();\r\n        } else {\r\n          this.status = 0;\r\n        }\r\n      });\r\n    } catch (error) {\r\n      this.resultStack.push(error);\r\n      result.next({\r\n        type: ScheduleResultType.Error,\r\n        recentResult: error,\r\n        progressIndex: this.actIndex,\r\n        resultStack: this.resultStack\r\n      })\r\n      if (this.actIndex < this.taskStack.length - 1) {\r\n        this.actIndex++;\r\n        this.actTask();\r\n      } else {\r\n        this.status = 0;\r\n      }\r\n    }\r\n    return result;\r\n  }\r\n\r\n\r\n}\r\n","\r\nexport enum WFActionType {\r\n  /** \r\n   * 审批通过\r\n  */\r\n  Pass = 'Pass',\r\n  /** \r\n   * \r\n  */\r\n  Resubmit = 'Resubmit',\r\n  /** \r\n   * 驳回\r\n  */\r\n  Back = 'Back',\r\n  /** \r\n   * 移交\r\n  */\r\n  Transfer = 'Transfer',\r\n  /** \r\n   * 评论\r\n  */\r\n  Comment = 'Comment'\r\n}\r\n\r\n\r\nexport interface Parameter {\r\n  code: string;\r\n  value: string;\r\n}\r\n\r\nexport interface Action {\r\n  code: string;\r\n  parameters: Parameter[];\r\n}\r\n\r\nexport interface WFTask {\r\n  id: string;\r\n  sourceId: string;\r\n  name: string;\r\n  state: string;\r\n  owner: string;\r\n  priority: number;\r\n  categoryId: string;\r\n  submitter: string;\r\n  startTime: string;\r\n  endTime: string;\r\n  processInstanceId: string;\r\n  refBizId: string;\r\n  submitterName: string;\r\n  bizCategory: string;\r\n  activityType: string;\r\n  activityDefinitionId: string;\r\n  activityInstanceId: string;\r\n  fromType: number;\r\n  tenantId: number;\r\n  readTime: string;\r\n  createdTime: string;\r\n  creator: string;\r\n  lastModifiedTime: string;\r\n  lastModifier: string;\r\n  actions: Action[];\r\n}\r\n\r\n\r\n\r\nexport type WFAction = {\r\n  \"code\": WFActionType,\r\n  \"parameters\": [],\r\n  \"id\": \"\",\r\n  \"name\": \"\",\r\n  \"sortOrder\": 13,\r\n  \"typeId\": \"wf\",\r\n  \"isBatchAction\": false,\r\n  \"isPrimaryAction\": false,\r\n  \"isHyperlinkAction\": false,\r\n  \"isCustomizeAction\": false,\r\n  \"terminal\": \"web,app\",\r\n  \"scope\": \"running\",\r\n  \"groupId\": \"complete\",\r\n  \"nameLanguage\": null,\r\n  \"preEvents\": [],\r\n  \"postEvents\": []\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { FrameContext } from '@farris/devkit';\r\nimport { MessagerService } from '@farris/ui-messager';\r\nimport { SyncTaskSchdule } from '../utils/sync-task-shchdule';\r\nimport { WFAction, WFActionType, WFTask } from './entity';\r\n\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class TaskCenterBridgeService {\r\n\r\n\r\n  taskSchdule: SyncTaskSchdule\r\n\r\n  constructor(\r\n    private msgService: MessagerService,\r\n  ) {\r\n    this.taskSchdule = new SyncTaskSchdule();\r\n  }\r\n\r\n  public initTaskCenterBridge(customerCmds: {}) {\r\n    const bridgeWin = window.parent;\r\n    let frameContext: FrameContext;\r\n    try {\r\n      frameContext = this['context'].frameContext\r\n    } catch (error) {\r\n      throw new Error('can not find frameContex');\r\n    }\r\n\r\n    let slienceSaveTask;\r\n\r\n    try {\r\n      slienceSaveTask = this['context'].frameContext.viewModel.slienceSave1;\r\n    } catch (error) {\r\n      // 不存在静音保存命令\r\n    }\r\n    if (bridgeWin) {\r\n      bridgeWin['taskCenterBeforeLoad'] = (\r\n        actionObj: {\r\n          \"task\": WFTask,\r\n          \"action\": WFAction\r\n        }\r\n      ) => {\r\n        return new Promise((resolve, reject) => {\r\n          const { action } = actionObj;\r\n          if (frameContext.uiState['UIStateInProcess'] == 'Approving' && frameContext.uiState['formConfigId']) {\r\n            slienceSaveTask.call(this).subscribe(() => {\r\n              resolve({\r\n                result: true\r\n              });\r\n            }, () => {\r\n              window.document.body.click()\r\n              if (action.code === WFActionType.Pass) { // 除了审评通过外，其它的不需要保存 \r\n                resolve({\r\n                  result: false\r\n                });\r\n              } else if (action.code === WFActionType.Comment) {\r\n                resolve({\r\n                  result: true\r\n                });\r\n              } else {\r\n                this.msgService.confirm('检测到单据保存失败，是否继续？').subscribe((confirm) => {\r\n                  resolve({\r\n                    result: confirm\r\n                  });\r\n                });\r\n              }\r\n            })\r\n          } else if (action.code == WFActionType.Resubmit && slienceSaveTask) {\r\n            slienceSaveTask.call(this).subscribe(() => {\r\n              resolve({\r\n                result: true\r\n              });\r\n            })\r\n          } else {\r\n            resolve({\r\n              result: true\r\n            });\r\n          }\r\n        })\r\n      }\r\n    }\r\n  }\r\n\r\n  public executeSchedules(taskArray) {\r\n    // 这里根据 任务名称，从 viewmodel中找到，然后依次执行\r\n    taskArray = taskArray.split(',');\r\n    // 这里需要验证拿到 commandService \r\n    let frameContext: FrameContext;\r\n    try {\r\n      frameContext = this['context'].frameContext\r\n    } catch (error) {\r\n      throw new Error('can not find frameContex');\r\n    }\r\n    taskArray.forEach((item) => {\r\n      let targetTask;\r\n      try {\r\n        targetTask = frameContext.viewModel[item];\r\n        this.taskSchdule.propTask(targetTask, [], this, item).subscribe((res) => {\r\n          console.log(res);\r\n        });\r\n      } catch (error) {\r\n        // 未找到应该在children中继续查找 未找到\r\n        console.log(error);\r\n      }\r\n    })\r\n\r\n  }\r\n\r\n}\r\n","import { Injectable, Injector } from '@angular/core';\r\n// import { StateMachineService } from '@farris/command-services';\r\nimport { FrameContext } from '@farris/devkit';\r\nimport { BehaviorSubject } from 'rxjs';\r\n\r\n@Injectable()\r\nexport class TransitApprovalStatus {\r\n    constructor(\r\n        private injetor: Injector\r\n    ) {\r\n        // 因为注位置的问题，这样子拿不到\r\n        // this.stateMachineSer = this.injetor.get(StateMachineService);\r\n    }\r\n    public switchStatus() {\r\n        const result: BehaviorSubject<string> = new BehaviorSubject('Cancel');\r\n        //  判断流程传参  formConfigId\r\n        let frameContext: FrameContext;\r\n        try {\r\n            frameContext = this['context'].frameContext\r\n        } catch (error) {\r\n            throw new Error('can not find frameContex');\r\n        }\r\n        if (frameContext.uiState['UIStateInProcess'] == 'Approving' && frameContext.uiState['formConfigId']) {\r\n            result.next('Edit');\r\n        }\r\n        return result;\r\n    }\r\n}","import { NgModule } from '@angular/core';\r\nimport { OAListDataService } from './data-services/list-data.service';\r\nimport { PrintWebPageService } from './print-web-page/print-web-page.service';\r\nimport { TaskCenterBridgeService } from './task-center-bridge/task-center-bridge.service';\r\nimport { TransitApprovalStatus } from './transit-approval/transit-approval.service';\r\n\r\n\r\n\r\n@NgModule({\r\n    providers: [\r\n        TaskCenterBridgeService,\r\n        PrintWebPageService,\r\n        TransitApprovalStatus,\r\n        OAListDataService\r\n    ],\r\n    imports: [\r\n\r\n    ],\r\n    exports: [\r\n\r\n    ],\r\n    entryComponents: [\r\n    ]\r\n})\r\nclass OACommandServicesModule {\r\n    constructor() { }\r\n}\r\n\r\nexport { OACommandServicesModule };\r\n\r\n"],"names":[],"mappings":"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"}
