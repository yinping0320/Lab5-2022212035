import * as tslib_1 from "tslib";
import * as ValidatorJS from 'validator';
import { ValidationTypes } from './validation_types';
import { ValidationExecutor } from './validation_executor';
import { ValidationUtils } from './validation_utils';
import { DateUtil } from '../../utils/date_util';
import { TranslateService } from '../../i18n/translate_service';
import { BigNumber } from 'bignumber.js';
/**
 * 校验实体实例对象数据
 */
var Validator = /** @class */ (function () {
    function Validator() {
        this.validatorJs = ValidatorJS.default;
    }
    /**
     * 验证实例对象中数据是否合法
     * @param object 待校验的实例对象
     * @param propertyName 待校验实例对象属性名称，为空则验证实例对象中所有带有验证规则的属性
     */
    // tslint:disable-next-line: max-line-length
    Validator.prototype.validate = function (object, propertyName, value, externalRules, index, frameContext) {
        var _this = this;
        var validationErrors = [];
        var executor = new ValidationExecutor(this);
        executor.execute(object, value, validationErrors, propertyName, index, externalRules, null, frameContext);
        return Promise.all(executor.awaitingPromises).then(function () {
            var errors = executor.stripEmptyErrors(validationErrors);
            _this.sortValidationErrors(errors);
            return _this.buildErrors(errors);
        });
    };
    /**
     * 校验信息排序（为了兼容树形表）
     * @param validationErrors 验证信息数组
     */
    Validator.prototype.sortValidationErrors = function (validationErrors) {
        var _this = this;
        // 如果存在无序号的信息则不排序
        var sortable = true;
        validationErrors.forEach(function (info) {
            if (info.children && info.children.length > 1) {
                _this.sortValidationErrors(info.children);
            }
            if (typeof info.index !== "number") {
                sortable = false;
            }
        });
        if (sortable) {
            validationErrors.sort(function (a, b) { return a.index - b.index; });
        }
    };
    /**
     * 执行校验
     * @param object
     * @param propertyName
     * @param value
     * @param externalRules
     * @param index
     * @param frameContext
     * @param ignoreAsyncValidateRules
     * @returns
     */
    Validator.prototype.verify = function (object, propertyName, value, externalRules, index, frameContext, ignoreAsyncValidateRules) {
        var _this = this;
        if (ignoreAsyncValidateRules === void 0) { ignoreAsyncValidateRules = false; }
        var validationErrors = [];
        var executor = new ValidationExecutor(this);
        executor.execute(object, value, validationErrors, propertyName, index, externalRules, null, frameContext);
        if (executor.awaitingPromises && executor.awaitingPromises.length > 0 && ignoreAsyncValidateRules === false) {
            return Promise.all(executor.awaitingPromises).then(function () {
                var errors = executor.stripEmptyErrors(validationErrors);
                var result = _this.buildErrors(errors);
                return result;
            });
        }
        else {
            var errors = executor.stripEmptyErrors(validationErrors);
            return this.buildErrors(errors);
        }
    };
    /**
     * 验证实体属性元数据中设置的校验规则是否合法
     * @param object 实例对象
     * @param value 待校验的值
     * @param validateRule 验证规则
     */
    Validator.prototype.validateValueByMetadata = function (object, value, validateRule, isMultLanguageField, currentRowId) {
        var _a;
        var validType = validateRule.type;
        var constraintsToValidate = [];
        if (validateRule.constraints) {
            constraintsToValidate = validateRule.constraints.map(function (param) {
                if (typeof param === 'function') {
                    return param(object, value);
                }
                return param;
            });
        }
        else {
            validateRule.constraints = [];
        }
        if (ValidationTypes.isValidType(validType)) {
            if (validType === ValidationTypes.MAXVALUE) {
                var rule = constraintsToValidate[0];
                if (this.isDateString(value) || this.isDate(value) || this.isDateString(rule) || this.isDate(rule)) {
                    // 如果日期值不存在，则不判断大小
                    if (!value) {
                        return true;
                    }
                    if (value.indexOf('~') !== -1) {
                        // 不对日期区间进行校验
                        return true;
                    }
                    return this[ValidationTypes.MAX_DATE](DateUtil.parse(value), isMultLanguageField, new Date(constraintsToValidate[0]));
                }
                else {
                    return this[ValidationTypes.MAXVALUE](value, isMultLanguageField, constraintsToValidate[0]);
                }
            }
            else if (validType === ValidationTypes.MINVALUE) {
                // 如果是null或undefined，直接返回true
                if (constraintsToValidate[0] === null || constraintsToValidate[0] === undefined) {
                    return true;
                }
                if (this.isDateString(value) || this.isDate(value)) {
                    if (constraintsToValidate[0] === 0) {
                        return true;
                    }
                    return this[ValidationTypes.MIN_DATE](DateUtil.parse(value), isMultLanguageField, DateUtil.parse(constraintsToValidate[0]));
                }
                else if (this.isNumber(value)) {
                    return this[ValidationTypes.MIN](value, isMultLanguageField, constraintsToValidate[0]);
                }
            }
            else {
                return this[validType].apply(this, tslib_1.__spread([value, isMultLanguageField], constraintsToValidate));
            }
        }
        else {
            if (typeof validateRule.eval === 'function') {
                var bindingPath = validateRule.bindingPath;
                var bindingPaths = bindingPath.split('/').filter(function (p) { return p; });
                var fieldName = validateRule.field;
                if (bindingPaths.length !== 0) {
                    var prefix = bindingPaths.join('/');
                    fieldName = prefix + "/" + fieldName.split('.').filter(function (p) { return p; }).join('/');
                }
                var options = { patch: (_a = {}, _a[fieldName] = value, _a) };
                options.currentRows = [];
                var parentEntityListPaths = object && typeof object['getEntityListPath'] === 'function' && object.getEntityListPath();
                if (parentEntityListPaths.length === 4) {
                    var childrenList = parentEntityListPaths.slice(1, 3).reverse();
                    options.currentRows.push({ bindingPath: childrenList[1], primaryValue: childrenList[0].split(':')[1] });
                }
                if (currentRowId) {
                    if (validateRule.bindingPath.split('/').filter(function (p) { return p; }).length !== 0) {
                        var primaryValue = object && typeof object['getMainEntityPrimaryValue'] === 'function' && object.getMainEntityPrimaryValue();
                        options.currentRows.push({ bindingPath: '/', primaryValue: primaryValue });
                    }
                    options.currentRow = { bindingPath: validateRule.bindingPath, primaryValue: currentRowId };
                }
                else {
                    var primaryValue = object && typeof object['getMainEntityPrimaryValue'] === 'function' && object.getMainEntityPrimaryValue();
                    options.currentRows.push({ bindingPath: '/', primaryValue: primaryValue });
                }
                var result = validateRule.eval(options);
                if (validateRule.type === "require" /* Require */) {
                    var isValid = this.required(value, isMultLanguageField);
                    if (result) {
                        return isValid;
                    }
                    else {
                        return true;
                    }
                }
                else {
                    return result;
                }
            }
        }
        return true;
    };
    Validator.prototype.buildErrors = function (errors) {
        var msg = new Set(ValidationUtils.createDetailedErrorMessage(errors));
        var newMsg = [];
        msg.forEach(function (v) {
            newMsg.push(v);
        });
        return {
            isValid: errors.length === 0,
            errors: errors,
            message: newMsg.join('')
        };
    };
    /** 自定义验证 */
    Validator.prototype.customValidation = function (value, comparison) {
        return comparison;
    };
    Validator.prototype.isEmptyValue = function (value) {
        var result = value === '' || value === null || value === undefined
            || value === '0001-01-01' || value === '0001-01-01 00:00:00' || value === '0001-01-01T00:00:00';
        return result;
    };
    /** 必填项 */
    Validator.prototype.required = function (value, isMultLanguageField) {
        if (isMultLanguageField) {
            var currentLanguage = TranslateService.getCurrentLanguage();
            if (Object.keys(value).length < 1) {
                return false;
            }
            // 如果能够获取到当前语言，那么当前语言对应的输入不能为空
            if (currentLanguage) {
                return !!value[currentLanguage];
            }
            // 如果当前语言为空，那么必填要求至少有一个输入
            // const allEmpty = Object.values(value).every((v: any) => !v || v.length < 1); // .filter((v: any) => !v || v.length < 1);
            // if (allEmpty) {
            //   return false;
            // }
            return true;
        }
        if (typeof value === 'object' && value !== null) {
            if (!Object.keys(value).length) {
                return false;
            }
            value = Object.values(value)[0];
        }
        // tslint:disable: max-line-length
        return value !== '' && value !== null && value !== undefined
            && value !== '0001-01-01' && value !== '0001-01-01 00:00:00' && value !== '0001-01-01T00:00:00';
    };
    /** 判断两个值是否相等 */
    Validator.prototype.equals = function (value, comparison) {
        return value === comparison;
    };
    /**
     * 检查 value 是否不等于参照值
     * @param value 要检查的值
     * @param comparison 对比参照值
     */
    Validator.prototype.notEquals = function (value, comparison) {
        return value !== comparison;
    };
    /**
     * 判断value 是否为数字
     * @param value 要检查的值
     * @param options 验证选项
     */
    Validator.prototype.isNumber = function (value, options) {
        if (options === void 0) { options = {}; }
        if (value === Infinity || value === -Infinity) {
            return options.allowInfinity;
        }
        if (Number.isNaN(value)) {
            return options.allowNaN;
        }
        return Number.isFinite(value);
    };
    /** 判断value是否为整数 */
    Validator.prototype.isInt = function (value) {
        return Number.isInteger(value);
    };
    /** 是否为浮点类型 */
    Validator.prototype.isFloat = function (value) {
        if (this.isNumber(value) || this.isNumberString(value)) {
            return this.validatorJs.isFloat(value);
        }
        return false;
    };
    /**
     * 检查给定的value 是否布尔值
     */
    Validator.prototype.isBoolean = function (value) {
        return value instanceof Boolean || typeof value === 'boolean';
    };
    /**
     * 检查给定的value 是否为字符串
     */
    Validator.prototype.isString = function (value) {
        return value instanceof String || typeof value === 'string';
    };
    /**
     * 检查给定的value 是否为日期
     */
    Validator.prototype.isDate = function (value) {
        return value instanceof Date && !isNaN(value.getTime());
    };
    /**
     * 检查给定的value 是否为日期字符串
     */
    Validator.prototype.isDateString = function (value) {
        var regex = /\d{4}-(0[1-9]|1[0-2])-(0[1-9]|[1-2][0-9]|3[0-1])(T|\s?)?(([0-2]\d:[0-5]\d)?(:[0-5]\d(?:\.\d+)))?(?:Z|\+[0-2]\d(?:\:[0-5]\d)?)?/g;
        return this.isString(value) && regex.test(value) && this.validatorJs.toDate(value);
    };
    /** 判断value 的长度是否在允许的最小值 和最大值之间 */
    Validator.prototype.length = function (value, min, max, isMultLanguageField) {
        return typeof value === 'string' && this.validatorJs.isLength(value, min, max);
    };
    /**
     * 检查给定的value的长度是否符合设定的最小值
     * @param value 待检查的字符串
     * @param min 最小长度
     */
    Validator.prototype.minLength = function (value, isMultLanguageField, min) {
        if (isMultLanguageField) {
            // const currentLanguage = TranslateService.getCurrentLanguage();
            if (typeof value === 'object') {
                var hasInvalidLangs = Object.values(value).filter(function (v) { return v && v.length < min; });
                if (hasInvalidLangs && hasInvalidLangs.length > 0) {
                    return false;
                }
            }
            // if (currentLanguage) {
            //   return value[currentLanguage] ? value[currentLanguage].length > min : true;
            // }
            // 如果无法获取当前语言，则只要有一种语言的输入长度大于最小长度即可。
            // const hasValidLangs = Object.values(value).filter((v: any) => v && v.length > min);
            // if (hasValidLangs.length > 0) {
            //   return true;
            // }
            // return false;
            return true;
        }
        if (value && typeof value !== 'string') {
            value = value.toString();
        }
        return !value || (typeof value === 'string' && this.length(value, min));
    };
    /**
     * 检查给定的value的长度是否符合设定的最大值
     * @param value 待检查的字符串
     * @param max 最大长度
     */
    Validator.prototype.maxLength = function (value, isMultLanguageField, max) {
        if (isMultLanguageField) {
            // const currentLanguage = TranslateService.getCurrentLanguage();
            // if (currentLanguage) {
            //   return value[currentLanguage] ? value[currentLanguage].length < max : true;
            // }
            if (typeof value === 'object') {
                var hasInvalidLangs = Object.values(value).filter(function (v) { return v && v.length > max; });
                if (hasInvalidLangs.length > 0) {
                    return false;
                }
            }
            return true;
        }
        if (typeof value === 'object') {
            for (var key in value) {
                if (value.hasOwnProperty(key)) {
                    var element = value[key];
                    if (typeof element === 'string' && !this.length(value[key], 0, max)) {
                        return false;
                    }
                }
            }
            return true;
        }
        if (value && typeof value !== 'string') {
            value = value.toString();
        }
        return !value || (typeof value === 'string' && this.length(value, 0, max));
    };
    /** 检查value的值是否在 最大值与最小值之间 */
    Validator.prototype.range = function (value, isMultLanguageField, min, max) {
        return typeof value === 'number' && this.isNumber(min) && this.isNumber(max) && value >= min && value <= max;
    };
    /**
     * 日期类型的值是否在某个区间
     * @param value value
     * @param min 最小值
     * @param max 最大值
     */
    Validator.prototype.dateRange = function (value, isMultLanguageField, rule, type) {
        // 2010~2020|04~05|03 11:00:00~05 12:00:00
        if (!value) {
            return true;
        }
        if (type === 'maxValue' || type === 'maxDate') {
            if (this.isYearRange(value) || this.isMonthOrDayRange(value)) {
                return this.maxValue(parseInt(this.getRangeValue(value, 1)), isMultLanguageField, parseInt(rule.split(' ')[0]));
            }
            else if (this.isDayTimeRange(value)) {
                return true;
            }
        }
        else if (type === 'minValue' || type === 'minDate') {
            if (this.isYearRange(value) || this.isMonthOrDayRange(value)) {
                return this.maxValue(parseInt(this.getRangeValue(value, 0)), isMultLanguageField, parseInt(rule.split(' ')[0]));
            }
            else if (this.isDayTimeRange(value)) {
                return true;
            }
        }
        return false;
    };
    Validator.prototype.getRangeValue = function (value, position, splitor) {
        if (splitor === void 0) { splitor = '~'; }
        return value.split(splitor)[position];
    };
    Validator.prototype.isDateRange = function (value) {
        if (typeof value !== 'string') {
            value = value.toString();
        }
        return /(\d{4}|\d{2})/.test(value);
    };
    /**
     * 是否年度区间
     * @param value value
     */
    Validator.prototype.isYearRange = function (value) {
        if (typeof value !== 'string') {
            value = value.toString();
        }
        return /^\d{4}~\d{4}$/.test(value);
    };
    /**
     * 是否为年月区间
     * @param value value
     */
    Validator.prototype.isYearMonthRange = function (value) {
        if (typeof value !== 'string') {
            value = value.toString();
        }
        return /^\d{4}-\d{2}~\d{4}-\d{2}$/.test(value);
    };
    /**
     * 是否为月或天的区间
     * @param value value
     */
    Validator.prototype.isMonthOrDayRange = function (value) {
        if (typeof value !== 'string') {
            value = value.toString();
        }
        return /^[0|1|2|3]\d{1}~[0|1|2|3]\d{1}$/.test(value);
    };
    /**
     * 是否为天+时间的区间
     * @param value value
     */
    Validator.prototype.isDayTimeRange = function (value) {
        if (typeof value !== 'string') {
            value = value.toString();
        }
        return /^[0|1|2|3]\d{1} \d{2}:\d{2}:\d{2}~[0|1|2|3]\d{1} \d{2}:\d{2}:\d{2}$/.test(value);
    };
    /**
     * Checks if the first number is greater than second.
     */
    Validator.prototype.min = function (num, isMultLanguageField, min) {
        return typeof num === 'number' && typeof min === 'number' && num >= min;
    };
    /**
     * 最小值验证
     */
    Validator.prototype.minValue = function (num, isMultLanguageField, min) {
        // 如果值不存在，则不进行最小值的判断
        if (num === null || num === undefined) {
            return true;
        }
        // 按照大数处理
        if ((typeof num === 'string' && num.match(/^(-?\d+)(\.\d+)?$/g)) || (typeof min === 'string' && min.match(/^(-?\d+)(\.\d+)?$/g))) {
            var value = new BigNumber(num);
            var maxValue = new BigNumber(min);
            return value.isGreaterThanOrEqualTo(maxValue);
        }
        return typeof num === 'number' && typeof min === 'number' && num >= min;
    };
    /**
     * Checks if the first number is less than second.
     */
    Validator.prototype.max = function (num, isMultLanguageField, max) {
        // 如果值不存在，则不进行最小值的判断
        if (num === null || num === undefined) {
            return true;
        }
        return typeof num === 'number' && typeof max === 'number' && num <= max;
    };
    /**
     * 最大值验证
     */
    Validator.prototype.maxValue = function (num, isMultLanguageField, max) {
        // 如果值不存在，则不进行最小值的判断
        if (num === null || num === undefined) {
            return true;
        }
        // 按照大数处理
        if ((typeof num === 'string' && num.match(/^(-?\d+)(\.\d+)?$/g)) || (typeof max === 'string' && max.match(/^(-?\d+)(\.\d+)?$/g))) {
            var value = new BigNumber(num);
            var maxValue = new BigNumber(max);
            return value.isLessThanOrEqualTo(maxValue);
        }
        return typeof num === 'number' && typeof max === 'number' && num <= max;
    };
    /**
     * Checks if the value is a date that's after the specified date.
     */
    Validator.prototype.minDate = function (date, isMultLanguageField, minDate) {
        if (!date) {
            return true;
        }
        return date && date.getTime() >= minDate.getTime();
    };
    /**
     * Checks if the value is a date that's before the specified date.
     */
    Validator.prototype.maxDate = function (date, isMultLanguageField, maxDate) {
        // 如果值不存在，则不进行最小值的判断
        if (date === null || date === undefined) {
            return true;
        }
        return date && date.getTime() <= maxDate.getTime();
    };
    /**
     * Checks if a string is a boolean.
     * If given value is not a string, then it returns false.
     */
    Validator.prototype.isBooleanString = function (value) {
        return typeof value === 'string' && this.validatorJs.isBoolean(value);
    };
    /**
     * Checks if the string is numeric.
     * If given value is not a string, then it returns false.
     */
    Validator.prototype.isNumberString = function (value) {
        return typeof value === 'string' && this.validatorJs.isNumeric(value);
    };
    /**
     * Checks if the string contains the seed.
     * If given value is not a string, then it returns false.
     */
    Validator.prototype.contains = function (value, isMultLanguageField, seed) {
        return typeof value === 'string' && this.validatorJs.contains(value, seed);
    };
    /**
     * Checks if the string does not contain the seed.
     * If given value is not a string, then it returns false.
     */
    Validator.prototype.notContains = function (value, isMultLanguageField, seed) {
        return typeof value === 'string' && !this.validatorJs.contains(value, seed);
    };
    /**
     * Checks if the string is an email.
     * If given value is not a string, then it returns false.
     */
    Validator.prototype.isEmail = function (value) {
        return typeof value === 'string' && this.validatorJs.isEmail(value);
    };
    /**
     * Checks if the string is valid JSON (note: uses JSON.parse).
     * If given value is not a string, then it returns false.
     */
    Validator.prototype.isJSON = function (value) {
        return typeof value === 'string' && this.validatorJs.isJSON(value);
    };
    /**
     * Checks if the string is lowercase.
     * If given value is not a string, then it returns false.
     */
    Validator.prototype.isLowercase = function (value) {
        return typeof value === 'string' && this.validatorJs.isLowercase(value);
    };
    /**
     * Checks if the string is uppercase.
     * If given value is not a string, then it returns false.
     */
    Validator.prototype.isUppercase = function (value) {
        return typeof value === 'string' && this.validatorJs.isUppercase(value);
    };
    /**
     * 验证字符串是否包含非法字符
     * @param value 验证的字符串
     * @param someChars 非法字符。如：#￥%@$
     */
    Validator.prototype.exclude = function (value, isMultLanguageField, someChars) {
        var _this = this;
        var arrChar = someChars.split('');
        var counter = 0;
        arrChar.forEach(function (val) {
            if (_this.contains(value, isMultLanguageField, val)) {
                counter++;
            }
        });
        return counter === 0;
    };
    /**
     * 自定义正则验证
     * @param value 待验证的字符串
     * @param pattern 正则表达式
     */
    Validator.prototype.matches = function (value, isMultLanguageField, pattern) {
        value = (value === null || value === undefined) ? '' : value.toString();
        if (value === '') {
            return true;
        }
        return this.validatorJs.matches(value, pattern);
    };
    return Validator;
}());
export { Validator };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidmFsaWRhdG9yLmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGZhcnJpcy9kZXZraXQvIiwic291cmNlcyI6WyJsaWIvZW50aXR5L3ZhbGlkYXRvci92YWxpZGF0b3IudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBLE9BQU8sS0FBSyxXQUFXLE1BQU0sV0FBVyxDQUFDO0FBRXpDLE9BQU8sRUFBRSxlQUFlLEVBQUUsTUFBTSxvQkFBb0IsQ0FBQztBQUdyRCxPQUFPLEVBQUUsa0JBQWtCLEVBQUUsTUFBTSx1QkFBdUIsQ0FBQztBQUMzRCxPQUFPLEVBQUUsZUFBZSxFQUFFLE1BQU0sb0JBQW9CLENBQUM7QUFDckQsT0FBTyxFQUFFLFFBQVEsRUFBRSxNQUFNLHVCQUF1QixDQUFDO0FBQ2pELE9BQU8sRUFBRSxnQkFBZ0IsRUFBRSxNQUFNLDhCQUE4QixDQUFDO0FBQ2hFLE9BQU8sRUFBRSxTQUFTLEVBQUUsTUFBTSxjQUFjLENBQUM7QUFJekM7O0dBRUc7QUFDSDtJQUNFO1FBRVEsZ0JBQVcsR0FBRyxXQUFXLENBQUMsT0FBTyxDQUFDO0lBRjFCLENBQUM7SUFHakI7Ozs7T0FJRztJQUNILDRDQUE0QztJQUM1Qyw0QkFBUSxHQUFSLFVBQVMsTUFBUyxFQUFFLFlBQXFCLEVBQUUsS0FBTSxFQUFFLGFBQTJDLEVBQUUsS0FBYyxFQUFFLFlBQTJCO1FBQTNJLGlCQVNDO1FBUkMsSUFBTSxnQkFBZ0IsR0FBc0IsRUFBRSxDQUFDO1FBQy9DLElBQU0sUUFBUSxHQUFHLElBQUksa0JBQWtCLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDOUMsUUFBUSxDQUFDLE9BQU8sQ0FBQyxNQUFNLEVBQUUsS0FBSyxFQUFFLGdCQUFnQixFQUFFLFlBQVksRUFBRSxLQUFLLEVBQUUsYUFBYSxFQUFFLElBQUksRUFBRSxZQUFZLENBQUMsQ0FBQztRQUMxRyxPQUFPLE9BQU8sQ0FBQyxHQUFHLENBQUMsUUFBUSxDQUFDLGdCQUFnQixDQUFDLENBQUMsSUFBSSxDQUFDO1lBQ2pELElB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QztRQVRDLElBQU0sT0FBTyxHQUFHLFNBQVMsQ0FBQyxLQUFLLENBQUMsRUFBRSxDQUFDLENBQUM7UUFDcEMsSUFBSSxPQUFPLEdBQUcsQ0FBQyxDQUFDO1FBQ2hCLE9BQU8sQ0FBQyxPQUFPLENBQUMsVUFBQSxHQUFHO1lBQ2pCLElBQUksS0FBSSxDQUFDLFFBQVEsQ0FBQyxLQUFLLEVBQUUsbUJBQW1CLEVBQUUsR0FBRyxDQUFDLEVBQUU7Z0JBQ2xELE9BQU8sRUFBRSxDQUFDO2FBQ1g7UUFDSCxDQUFDLENBQUMsQ0FBQztRQUVILE9BQU8sT0FBTyxLQUFLLENBQUMsQ0FBQztJQUN2QixDQUFDO0lBRUQ7Ozs7T0FJRztJQUNILDJCQUFPLEdBQVAsVUFBUSxLQUFhLEVBQUUsbUJBQTRCLEVBQUUsT0FBWTtRQUMvRCxLQUFLLEdBQUcsQ0FBQyxLQUFLLEtBQUssSUFBSSxJQUFJLEtBQUssS0FBSyxTQUFTLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsUUFBUSxFQUFFLENBQUM7UUFDeEUsSUFBSSxLQUFLLEtBQUssRUFBRSxFQUFFO1lBQ2hCLE9BQU8sSUFBSSxDQUFDO1NBQ2I7UUFDRCxPQUFPLElBQUksQ0FBQyxXQUFXLENBQUMsT0FBTyxDQUFDLEtBQUssRUFBRSxPQUFPLENBQUMsQ0FBQztJQUNsRCxDQUFDO0lBQ0gsZ0JBQUM7QUFBRCxDQUFDLEFBMWxCRCxJQTBsQkMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgKiBhcyBWYWxpZGF0b3JKUyBmcm9tICd2YWxpZGF0b3InO1xyXG5pbXBvcnQgeyBWYWxpZGF0ZVJ1bGUsIElzTnVtYmVyT3B0aW9ucywgVmFsaWRhdGlvblJlc3VsdCB9IGZyb20gJy4vdHlwZXMnO1xyXG5pbXBvcnQgeyBWYWxpZGF0aW9uVHlwZXMgfSBmcm9tICcuL3ZhbGlkYXRpb25fdHlwZXMnO1xyXG5pbXBvcnQgeyBWYWxpZGF0aW9uRXJyb3IgfSBmcm9tICcuL3ZhbGlkYXRpb25fZXJyb3InO1xyXG5pbXBvcnQgeyBFbnRpdHkgfSBmcm9tICcuLi9lbnRpdHknO1xyXG5pbXBvcnQgeyBWYWxpZGF0aW9uRXhlY3V0b3IgfSBmcm9tICcuL3ZhbGlkYXRpb25fZXhlY3V0b3InO1xyXG5pbXBvcnQgeyBWYWxpZGF0aW9uVXRpbHMgfSBmcm9tICcuL3ZhbGlkYXRpb25fdXRpbHMnO1xyXG5pbXBvcnQgeyBEYXRlVXRpbCB9IGZyb20gJy4uLy4uL3V0aWxzL2RhdGVfdXRpbCc7XHJcbmltcG9ydCB7IFRyYW5zbGF0ZVNlcnZpY2UgfSBmcm9tICcuLi8uLi9pMThuL3RyYW5zbGF0ZV9zZXJ2aWNlJztcclxuaW1wb3J0IHsgQmlnTnVtYmVyIH0gZnJvbSAnYmlnbnVtYmVyLmpzJztcclxuaW1wb3J0IHsgUnVsZVR5cGUgfSBmcm9tICcuLi8uLi9mb3JtL2luZGV4JztcclxuaW1wb3J0IHsgRnJhbWVDb250ZXh0IH0gZnJvbSAnLi4vLi4vZnJhbWUvaW5kZXgnO1xyXG5cclxuLyoqXHJcbiAqIOagoemqjOWunuS9k+WunuS+i+WvueixoeaVsOaNrlxyXG4gKi9cclxuZXhwb3J0IGNsYXNzIFZhbGlkYXRvcjxUIGV4dGVuZHMgRW50aXR5PiB7XHJcbiAgY29uc3RydWN0b3IoKSB7IH1cclxuXHJcbiAgcHJpdmF0ZSB2YWxpZGF0b3JKcyA9IFZhbGlkYXRvckpTLmRlZmF1bHQ7XHJcbiAgLyoqXHJcbiAgICog6aqM6K+B5a6e5L6L5a+56LGh5Lit5pWw5o2u5piv5ZCm5ZCI5rOVXHJcbiAgICogQHBhcmFtIG9iamVjdCDlvoXmoKHpqoznmoTlrp7kvovlr7nosaFcclxuICAgKiBAcGFyYW0gcHJvcGVydHlOYW1lIOW+heagoemqjOWunuS+i+WvueixoeWxnuaAp+WQjeensO+8jOS4uuepuuWImemqjOivgeWunuS+i+WvueixoeS4reaJgOacieW4puaciemqjOivgeinhOWImeeahOWxnuaAp1xyXG4gICAqL1xyXG4gIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTogbWF4LWxpbmUtbGVuZ3RoXHJcbiAgdmFsaWRhdGUob2JqZWN0OiBULCBwcm9wZXJ0eU5hbWU/OiBzdHJpbmcsIHZhbHVlPywgZXh0ZXJuYWxSdWxlcz86IE1hcDxzdHJpbmcsIFZhbGlkYXRlUnVsZVtdPiwgaW5kZXg/OiBudW1iZXIsIGZyYW1lQ29udGV4dD86IEZyYW1lQ29udGV4dCk6IFByb21pc2U8VmFsaWRhdGlvblJlc3VsdD4ge1xyXG4gICAgY29uc3QgdmFsaWRhdGlvbkVycm9yczogVmFsaWRhdGlvbkVycm9yW10gPSBbXTtcclxuICAgIGNvbnN0IGV4ZWN1dG9yID0gbmV3IFZhbGlkYXRpb25FeGVjdXRvcih0aGlzKTtcclxuICAgIGV4ZWN1dG9yLmV4ZWN1dGUob2JqZWN0LCB2YWx1ZSwgdmFsaWRhdGlvbkVycm9ycywgcHJvcGVydHlOYW1lLCBpbmRleCwgZXh0ZXJuYWxSdWxlcywgbnVsbCwgZnJhbWVDb250ZXh0KTtcclxuICAgIHJldHVybiBQcm9taXNlLmFsbChleGVjdXRvci5hd2FpdGluZ1Byb21pc2VzKS50aGVuKCgpID0+IHtcclxuICAgICAgY29uc3QgZXJyb3JzID0gZXhlY3V0b3Iuc3RyaXBFbXB0eUVycm9ycyh2YWxpZGF0aW9uRXJyb3JzKTtcclxuICAgICAgdGhpcy5zb3J0VmFsaWRhdGlvbkVycm9ycyhlcnJvcnMpO1xyXG4gICAgICByZXR1cm4gdGhpcy5idWlsZEVycm9ycyhlcnJvcnMpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG4gIC8qKlxyXG4gICAqIOagoemqjOS/oeaBr+aOkuW6j++8iOS4uuS6huWFvOWuueagkeW9ouihqO+8iVxyXG4gICAqIEBwYXJhbSB2YWxpZGF0aW9uRXJyb3JzIOmqjOivgeS/oeaBr+aVsOe7hFxyXG4gICAqL1xyXG4gIHByaXZhdGUgc29ydFZhbGlkYXRpb25FcnJvcnModmFsaWRhdGlvbkVycm9yczogVmFsaWRhdGlvbkVycm9yW10pIHtcclxuICAgIC8vIOWmguaenOWtmOWcqOaXoOW6j+WPt+eahOS/oeaBr+WImeS4jeaOkuW6j1xyXG4gICAgbGV0IHNvcnRhYmxlOiBib29sZWFuID0gdHJ1ZTtcclxuICAgIHZhbGlkYXRpb25FcnJvcnMuZm9yRWFjaChpbmZvID0+IHtcclxuICAgICAgaWYgKGluZm8uY2hpbGRyZW4gJiYgaW5mby5jaGlsZHJlbi5sZW5ndGggPiAxKSB7XHJcbiAgICAgICAgdGhpcy5zb3J0VmFsaWRhdGlvbkVycm9ycyhpbmZvLmNoaWxkcmVuKTtcclxuICAgICAgfVxyXG4gICAgICBpZiAodHlwZW9mIGluZm8uaW5kZXggIT09IFwibnVtYmVyXCIpIHtcclxuICAgICAgICBzb3J0YWJsZSA9IGZhbHNlO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICAgIGlmIChzb3J0YWJsZSkge1xyXG4gICAgICB2YWxpZGF0aW9uRXJyb3JzLnNvcnQoKGEsIGIpID0+IGEuaW5kZXggLSBiLmluZGV4KTtcclxuICAgIH1cclxuICB9XHJcbiAgLyoqXHJcbiAgICog5omn6KGM5qCh6aqMXHJcbiAgICogQHBhcmFtIG9iamVjdCBcclxuICAgKiBAcGFyYW0gcHJvcGVydHlOYW1lIFxyXG4gICAqIEBwYXJhbSB2YWx1ZSBcclxuICAgKiBAcGFyYW0gZXh0ZXJuYWxSdWxlcyBcclxuICAgKiBAcGFyYW0gaW5kZXggXHJcbiAgICogQHBhcmFtIGZyYW1lQ29udGV4dCBcclxuICAgKiBAcGFyYW0gaWdub3JlQXN5bmNWYWxpZGF0ZVJ1bGVzXHJcbiAgICogQHJldHVybnMgXHJcbiAgICovXHJcbiAgcHVibGljIHZlcmlmeShvYmplY3Q6IFQsIHByb3BlcnR5TmFtZT86IHN0cmluZywgdmFsdWU/LCBleHRlcm5hbFJ1bGVzPzogTWFwPHN0cmluZywgVmFsaWRhdGVSdWxlW10+LCBpbmRleD86IG51bWJlciwgZnJhbWVDb250ZXh0PzogRnJhbWVDb250ZXh0LCBpZ25vcmVBc3luY1ZhbGlkYXRlUnVsZXM6IGJvb2xlYW4gPSBmYWxzZSk6IFByb21pc2U8VmFsaWRhdGlvblJlc3VsdD4gfCB7IGlzVmFsaWQ6IGJvb2xlYW4sIGVycm9yczogYW55LCBtZXNzYWdlOiBzdHJpbmcgfSB7XHJcbiAgICBjb25zdCB2YWxpZGF0aW9uRXJyb3JzOiBWYWxpZGF0aW9uRXJyb3JbXSA9IFtdO1xyXG4gICAgY29uc3QgZXhlY3V0b3IgPSBuZXcgVmFsaWRhdGlvbkV4ZWN1dG9yKHRoaXMpO1xyXG4gICAgZXhlY3V0b3IuZXhlY3V0ZShvYmplY3QsIHZhbHVlLCB2YWxpZGF0aW9uRXJyb3JzLCBwcm9wZXJ0eU5hbWUsIGluZGV4LCBleHRlcm5hbFJ1bGVzLCBudWxsLCBmcmFtZUNvbnRleHQpO1xyXG4gICAgaWYgKGV4ZWN1dG9yLmF3YWl0aW5nUHJvbWlzZXMgJiYgZXhlY3V0b3IuYXdhaXRpbmdQcm9taXNlcy5sZW5ndGggPiAwICYmIGlnbm9yZUFzeW5jVmFsaWRhdGVSdWxlcyA9PT0gZmFsc2UpIHtcclxuICAgICAgcmV0dXJuIFByb21pc2UuYWxsKGV4ZWN1dG9yLmF3YWl0aW5nUHJvbWlzZXMpLnRoZW4oKCkgPT4ge1xyXG4gICAgICAgIGNvbnN0IGVycm9ycyA9IGV4ZWN1dG9yLnN0cmlwRW1wdHlFcnJvcnModmFsaWRhdGlvbkVycm9ycyk7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gdGhpcy5idWlsZEVycm9ycyhlcnJvcnMpO1xyXG4gICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICAgIH0pO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgY29uc3QgZXJyb3JzID0gZXhlY3V0b3Iuc3RyaXBFbXB0eUVycm9ycyh2YWxpZGF0aW9uRXJyb3JzKTtcclxuICAgICAgcmV0dXJuIHRoaXMuYnVpbGRFcnJvcnMoZXJyb3JzKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOmqjOivgeWunuS9k+WxnuaAp+WFg+aVsOaNruS4reiuvue9rueahOagoemqjOinhOWImeaYr+WQpuWQiOazlVxyXG4gICAqIEBwYXJhbSBvYmplY3Qg5a6e5L6L5a+56LGhXHJcbiAgICogQHBhcmFtIHZhbHVlIOW+heagoemqjOeahOWAvFxyXG4gICAqIEBwYXJhbSB2YWxpZGF0ZVJ1bGUg6aqM6K+B6KeE5YiZXHJcbiAgICovXHJcbiAgdmFsaWRhdGVWYWx1ZUJ5TWV0YWRhdGEob2JqZWN0OiBhbnksIHZhbHVlOiBhbnksIHZhbGlkYXRlUnVsZTogVmFsaWRhdGVSdWxlLCBpc011bHRMYW5ndWFnZUZpZWxkPzogYm9vbGVhbiwgY3VycmVudFJvd0lkPzogc3RyaW5nKTogYm9vbGVhbiB8IGFueSB7XHJcbiAgICBjb25zdCB2YWxpZFR5cGUgPSB2YWxpZGF0ZVJ1bGUudHlwZTtcclxuICAgIGxldCBjb25zdHJhaW50c1RvVmFsaWRhdGUgPSBbXTtcclxuICAgIGlmICh2YWxpZGF0ZVJ1bGUuY29uc3RyYWludHMpIHtcclxuICAgICAgY29uc3RyYWludHNUb1ZhbGlkYXRlID0gdmFsaWRhdGVSdWxlLmNvbnN0cmFpbnRzLm1hcChwYXJhbSA9PiB7XHJcbiAgICAgICAgaWYgKHR5cGVvZiBwYXJhbSA9PT0gJ2Z1bmN0aW9uJykge1xyXG4gICAgICAgICAgcmV0dXJuIHBhcmFtKG9iamVjdCwgdmFsdWUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcGFyYW07XHJcbiAgICAgIH0pO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdmFsaWRhdGVSdWxlLmNvbnN0cmFpbnRzID0gW107XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKFZhbGlkYXRpb25UeXBlcy5pc1ZhbGlkVHlwZSh2YWxpZFR5cGUpKSB7XHJcbiAgICAgIGlmICh2YWxpZFR5cGUgPT09IFZhbGlkYXRpb25UeXBlcy5NQVhWQUxVRSkge1xyXG4gICAgICAgIGNvbnN0IHJ1bGUgPSBjb25zdHJhaW50c1RvVmFsaWRhdGVbMF07XHJcbiAgICAgICAgaWYgKHRoaXMuaXNEYXRlU3RyaW5nKHZhbHVlKSB8fCB0aGlzLmlzRGF0ZSh2YWx1ZSkgfHwgdGhpcy5pc0RhdGVTdHJpbmcocnVsZSkgfHwgdGhpcy5pc0RhdGUocnVsZSkpIHtcclxuICAgICAgICAgIC8vIOWmguaenOaXpeacn+WAvOS4jeWtmOWcqO+8jOWImeS4jeWIpOaWreWkp+Wwj1xyXG4gICAgICAgICAgaWYgKCF2YWx1ZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIGlmICh2YWx1ZS5pbmRleE9mKCd+JykgIT09IC0xKSB7XHJcbiAgICAgICAgICAgIC8vIOS4jeWvueaXpeacn+WMuumXtOi/m+ihjOagoemqjFxyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIHJldHVybiB0aGlzW1ZhbGlkYXRpb25UeXBlcy5NQVhfREFURV0oRGF0ZVV0aWwucGFyc2UodmFsdWUpLCBpc011bHRMYW5ndWFnZUZpZWxkLCBuZXcgRGF0ZShjb25zdHJhaW50c1RvVmFsaWRhdGVbMF0pKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgcmV0dXJuIHRoaXNbVmFsaWRhdGlvblR5cGVzLk1BWFZBTFVFXSh2YWx1ZSwgaXNNdWx0TGFuZ3VhZ2VGaWVsZCwgY29uc3RyYWludHNUb1ZhbGlkYXRlWzBdKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0gZWxzZSBpZiAodmFsaWRUeXBlID09PSBWYWxpZGF0aW9uVHlwZXMuTUlOVkFMVUUpIHtcclxuICAgICAgICAvLyDlpoLmnpzmmK9udWxs5oiWdW5kZWZpbmVk77yM55u05o6l6L+U5ZuedHJ1ZVxyXG4gICAgICAgIGlmIChjb25zdHJhaW50c1RvVmFsaWRhdGVbMF0gPT09IG51bGwgfHwgY29uc3RyYWludHNUb1ZhbGlkYXRlWzBdID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy5pc0RhdGVTdHJpbmcodmFsdWUpIHx8IHRoaXMuaXNEYXRlKHZhbHVlKSkge1xyXG4gICAgICAgICAgaWYgKGNvbnN0cmFpbnRzVG9WYWxpZGF0ZVswXSA9PT0gMCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIHJldHVybiB0aGlzW1ZhbGlkYXRpb25UeXBlcy5NSU5fREFURV0oRGF0ZVV0aWwucGFyc2UodmFsdWUpLCBpc011bHRMYW5ndWFnZUZpZWxkLCBEYXRlVXRpbC5wYXJzZShjb25zdHJhaW50c1RvVmFsaWRhdGVbMF0pKTtcclxuICAgICAgICB9IGVsc2UgaWYgKHRoaXMuaXNOdW1iZXIodmFsdWUpKSB7XHJcbiAgICAgICAgICByZXR1cm4gdGhpc1tWYWxpZGF0aW9uVHlwZXMuTUlOXSh2YWx1ZSwgaXNNdWx0TGFuZ3VhZ2VGaWVsZCwgY29uc3RyYWludHNUb1ZhbGlkYXRlWzBdKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXNbdmFsaWRUeXBlXSh2YWx1ZSwgaXNNdWx0TGFuZ3VhZ2VGaWVsZCwgLi4uY29uc3RyYWludHNUb1ZhbGlkYXRlKTtcclxuICAgICAgfVxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgaWYgKHR5cGVvZiB2YWxpZGF0ZVJ1bGUuZXZhbCA9PT0gJ2Z1bmN0aW9uJykge1xyXG4gICAgICAgIGNvbnN0IGJpbmRpbmdQYXRoID0gdmFsaWRhdGVSdWxlLmJpbmRpbmdQYXRoO1xyXG4gICAgICAgIGNvbnN0IGJpbmRpbmdQYXRocyA9IGJpbmRpbmdQYXRoLnNwbGl0KCcvJykuZmlsdGVyKHAgPT4gcCk7XHJcbiAgICAgICAgbGV0IGZpZWxkTmFtZSA9IHZhbGlkYXRlUnVsZS5maWVsZDtcclxuICAgICAgICBpZiAoYmluZGluZ1BhdGhzLmxlbmd0aCAhPT0gMCkge1xyXG4gICAgICAgICAgY29uc3QgcHJlZml4ID0gYmluZGluZ1BhdGhzLmpvaW4oJy8nKTtcclxuICAgICAgICAgIGZpZWxkTmFtZSA9IGAke3ByZWZpeH0vJHtmaWVsZE5hbWUuc3BsaXQoJy4nKS5maWx0ZXIocCA9PiBwKS5qb2luKCcvJyl9YDtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3Qgb3B0aW9uczogYW55ID0geyBwYXRjaDogeyBbZmllbGROYW1lXTogdmFsdWUgfSB9O1xyXG4gICAgICAgIG9wdGlvbnMuY3VycmVudFJvd3MgPSBbXTtcclxuICAgICAgICBjb25zdCBwYXJlbnRFbnRpdHlMaXN0UGF0aHM6IHN0cmluZ1tdID0gb2JqZWN0ICYmIHR5cGVvZiBvYmplY3RbJ2dldEVudGl0eUxpc3RQYXRoJ10gPT09ICdmdW5jdGlvbicgJiYgb2JqZWN0LmdldEVudGl0eUxpc3RQYXRoKCk7XHJcbiAgICAgICAgaWYgKHBhcmVudEVudGl0eUxpc3RQYXRocy5sZW5ndGggPT09IDQpIHtcclxuICAgICAgICAgIGNvbnN0IGNoaWxkcmVuTGlzdCA9IHBhcmVudEVudGl0eUxpc3RQYXRocy5zbGljZSgxLCAzKS5yZXZlcnNlKCk7XHJcbiAgICAgICAgICBvcHRpb25zLmN1cnJlbnRSb3dzLnB1c2goeyBiaW5kaW5nUGF0aDogY2hpbGRyZW5MaXN0WzFdLCBwcmltYXJ5VmFsdWU6IGNoaWxkcmVuTGlzdFswXS5zcGxpdCgnOicpWzFdIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoY3VycmVudFJvd0lkKSB7XHJcbiAgICAgICAgICBpZiAodmFsaWRhdGVSdWxlLmJpbmRpbmdQYXRoLnNwbGl0KCcvJykuZmlsdGVyKHAgPT4gcCkubGVuZ3RoICE9PSAwKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHByaW1hcnlWYWx1ZSA9IG9iamVjdCAmJiB0eXBlb2Ygb2JqZWN0WydnZXRNYWluRW50aXR5UHJpbWFyeVZhbHVlJ10gPT09ICdmdW5jdGlvbicgJiYgb2JqZWN0LmdldE1haW5FbnRpdHlQcmltYXJ5VmFsdWUoKTtcclxuICAgICAgICAgICAgb3B0aW9ucy5jdXJyZW50Um93cy5wdXNoKHsgYmluZGluZ1BhdGg6ICcvJywgcHJpbWFyeVZhbHVlOiBwcmltYXJ5VmFsdWUgfSk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBvcHRpb25zLmN1cnJlbnRSb3cgPSB7IGJpbmRpbmdQYXRoOiB2YWxpZGF0ZVJ1bGUuYmluZGluZ1BhdGgsIHByaW1hcnlWYWx1ZTogY3VycmVudFJvd0lkIH07XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIGNvbnN0IHByaW1hcnlWYWx1ZSA9IG9iamVjdCAmJiB0eXBlb2Ygb2JqZWN0WydnZXRNYWluRW50aXR5UHJpbWFyeVZhbHVlJ10gPT09ICdmdW5jdGlvbicgJiYgb2JqZWN0LmdldE1haW5FbnRpdHlQcmltYXJ5VmFsdWUoKTtcclxuICAgICAgICAgIG9wdGlvbnMuY3VycmVudFJvd3MucHVzaCh7IGJpbmRpbmdQYXRoOiAnLycsIHByaW1hcnlWYWx1ZTogcHJpbWFyeVZhbHVlIH0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gdmFsaWRhdGVSdWxlLmV2YWwob3B0aW9ucyk7XHJcbiAgICAgICAgaWYgKHZhbGlkYXRlUnVsZS50eXBlID09PSBSdWxlVHlwZS5SZXF1aXJlKSB7XHJcbiAgICAgICAgICBjb25zdCBpc1ZhbGlkID0gdGhpcy5yZXF1aXJlZCh2YWx1ZSwgaXNNdWx0TGFuZ3VhZ2VGaWVsZCk7XHJcbiAgICAgICAgICBpZiAocmVzdWx0KSB7XHJcbiAgICAgICAgICAgIHJldHVybiBpc1ZhbGlkO1xyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHRydWU7XHJcbiAgfVxyXG4gIHByaXZhdGUgYnVpbGRFcnJvcnMoZXJyb3JzOiBWYWxpZGF0aW9uRXJyb3JbXSkge1xyXG4gICAgY29uc3QgbXNnID0gbmV3IFNldChWYWxpZGF0aW9uVXRpbHMuY3JlYXRlRGV0YWlsZWRFcnJvck1lc3NhZ2UoZXJyb3JzKSk7XHJcbiAgICBjb25zdCBuZXdNc2cgPSBbXTtcclxuICAgIG1zZy5mb3JFYWNoKHYgPT4ge1xyXG4gICAgICBuZXdNc2cucHVzaCh2KTtcclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgaXNWYWxpZDogZXJyb3JzLmxlbmd0aCA9PT0gMCxcclxuICAgICAgZXJyb3JzLFxyXG4gICAgICBtZXNzYWdlOiBuZXdNc2cuam9pbignJylcclxuICAgIH07XHJcbiAgfVxyXG4gIC8qKiDoh6rlrprkuYnpqozor4EgKi9cclxuICBjdXN0b21WYWxpZGF0aW9uKHZhbHVlLCBjb21wYXJpc29uOiBib29sZWFuKTogYm9vbGVhbiB7XHJcbiAgICByZXR1cm4gY29tcGFyaXNvbjtcclxuICB9XHJcbiAgcHJpdmF0ZSBpc0VtcHR5VmFsdWUodmFsdWU6IGFueSkge1xyXG4gICAgY29uc3QgcmVzdWx0ID0gdmFsdWUgPT09ICcnIHx8IHZhbHVlID09PSBudWxsIHx8IHZhbHVlID09PSB1bmRlZmluZWRcclxuICAgICAgfHwgdmFsdWUgPT09ICcwMDAxLTAxLTAxJyB8fCB2YWx1ZSA9PT0gJzAwMDEtMDEtMDEgMDA6MDA6MDAnIHx8IHZhbHVlID09PSAnMDAwMS0wMS0wMVQwMDowMDowMCc7XHJcbiAgICByZXR1cm4gcmVzdWx0O1xyXG4gIH1cclxuICAvKiog5b+F5aGr6aG5ICovXHJcbiAgcmVxdWlyZWQodmFsdWU6IGFueSwgaXNNdWx0TGFuZ3VhZ2VGaWVsZD86IGJvb2xlYW4pOiBib29sZWFuIHtcclxuICAgIGlmIChpc011bHRMYW5ndWFnZUZpZWxkKSB7XHJcbiAgICAgIGNvbnN0IGN1cnJlbnRMYW5ndWFnZSA9IFRyYW5zbGF0ZVNlcnZpY2UuZ2V0Q3VycmVudExhbmd1YWdlKCk7XHJcbiAgICAgIGlmIChPYmplY3Qua2V5cyh2YWx1ZSkubGVuZ3RoIDwgMSkge1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgfVxyXG4gICAgICAvLyDlpoLmnpzog73lpJ/ojrflj5bliLDlvZPliY3or63oqIDvvIzpgqPkuYjlvZPliY3or63oqIDlr7nlupTnmoTovpPlhaXkuI3og73kuLrnqbpcclxuICAgICAgaWYgKGN1cnJlbnRMYW5ndWFnZSkge1xyXG4gICAgICAgIHJldHVybiAhIXZhbHVlW2N1cnJlbnRMYW5ndWFnZV07XHJcbiAgICAgIH1cclxuICAgICAgLy8g5aaC5p6c5b2T5YmN6K+t6KiA5Li656m677yM6YKj5LmI5b+F5aGr6KaB5rGC6Iez5bCR5pyJ5LiA5Liq6L6T5YWlXHJcbiAgICAgIC8vIGNvbnN0IGFsbEVtcHR5ID0gT2JqZWN0LnZhbHVlcyh2YWx1ZSkuZXZlcnkoKHY6IGFueSkgPT4gIXYgfHwgdi5sZW5ndGggPCAxKTsgLy8gLmZpbHRlcigodjogYW55KSA9PiAhdiB8fCB2Lmxlbmd0aCA8IDEpO1xyXG4gICAgICAvLyBpZiAoYWxsRW1wdHkpIHtcclxuICAgICAgLy8gICByZXR1cm4gZmFsc2U7XHJcbiAgICAgIC8vIH1cclxuICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9XHJcbiAgICBpZiAodHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyAmJiB2YWx1ZSAhPT0gbnVsbCkge1xyXG4gICAgICBpZiAoIU9iamVjdC5rZXlzKHZhbHVlKS5sZW5ndGgpIHtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgIH1cclxuICAgICAgdmFsdWUgPSBPYmplY3QudmFsdWVzKHZhbHVlKVswXTtcclxuICAgIH1cclxuICAgIC8vIHRzbGludDpkaXNhYmxlOiBtYXgtbGluZS1sZW5ndGhcclxuICAgIHJldHVybiB2YWx1ZSAhPT0gJycgJiYgdmFsdWUgIT09IG51bGwgJiYgdmFsdWUgIT09IHVuZGVmaW5lZFxyXG4gICAgICAmJiB2YWx1ZSAhPT0gJzAwMDEtMDEtMDEnICYmIHZhbHVlICE9PSAnMDAwMS0wMS0wMSAwMDowMDowMCcgJiYgdmFsdWUgIT09ICcwMDAxLTAxLTAxVDAwOjAwOjAwJztcclxuICB9XHJcblxyXG4gIC8qKiDliKTmlq3kuKTkuKrlgLzmmK/lkKbnm7jnrYkgKi9cclxuICBlcXVhbHModmFsdWU6IGFueSwgY29tcGFyaXNvbjogYW55KTogYm9vbGVhbiB7XHJcbiAgICByZXR1cm4gdmFsdWUgPT09IGNvbXBhcmlzb247XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDmo4Dmn6UgdmFsdWUg5piv5ZCm5LiN562J5LqO5Y+C54Wn5YC8XHJcbiAgICogQHBhcmFtIHZhbHVlIOimgeajgOafpeeahOWAvFxyXG4gICAqIEBwYXJhbSBjb21wYXJpc29uIOWvueavlOWPgueFp+WAvFxyXG4gICAqL1xyXG4gIG5vdEVxdWFscyh2YWx1ZTogYW55LCBjb21wYXJpc29uOiBhbnkpOiBib29sZWFuIHtcclxuICAgIHJldHVybiB2YWx1ZSAhPT0gY29tcGFyaXNvbjtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOWIpOaWrXZhbHVlIOaYr+WQpuS4uuaVsOWtl1xyXG4gICAqIEBwYXJhbSB2YWx1ZSDopoHmo4Dmn6XnmoTlgLxcclxuICAgKiBAcGFyYW0gb3B0aW9ucyDpqozor4HpgInpoblcclxuICAgKi9cclxuICBpc051bWJlcih2YWx1ZTogYW55LCBvcHRpb25zOiBJc051bWJlck9wdGlvbnMgPSB7fSk6IGJvb2xlYW4ge1xyXG4gICAgaWYgKHZhbHVlID09PSBJbmZpbml0eSB8fCB2YWx1ZSA9PT0gLUluZmluaXR5KSB7XHJcbiAgICAgIHJldHVybiBvcHRpb25zLmFsbG93SW5maW5pdHk7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKE51bWJlci5pc05hTih2YWx1ZSkpIHtcclxuICAgICAgcmV0dXJuIG9wdGlvbnMuYWxsb3dOYU47XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIE51bWJlci5pc0Zpbml0ZSh2YWx1ZSk7XHJcbiAgfVxyXG5cclxuICAvKiog5Yik5patdmFsdWXmmK/lkKbkuLrmlbTmlbAgKi9cclxuICBpc0ludCh2YWx1ZTogbnVtYmVyKSB7XHJcbiAgICByZXR1cm4gTnVtYmVyLmlzSW50ZWdlcih2YWx1ZSk7XHJcbiAgfVxyXG5cclxuICAvKiog5piv5ZCm5Li65rWu54K557G75Z6LICovXHJcbiAgaXNGbG9hdCh2YWx1ZTogYW55KTogYm9vbGVhbiB7XHJcbiAgICBpZiAodGhpcy5pc051bWJlcih2YWx1ZSkgfHwgdGhpcy5pc051bWJlclN0cmluZyh2YWx1ZSkpIHtcclxuICAgICAgcmV0dXJuIHRoaXMudmFsaWRhdG9ySnMuaXNGbG9hdCh2YWx1ZSk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gZmFsc2U7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDmo4Dmn6Xnu5nlrprnmoR2YWx1ZSDmmK/lkKbluIPlsJTlgLxcclxuICAgKi9cclxuICBpc0Jvb2xlYW4odmFsdWU6IGFueSk6IGJvb2xlYW4ge1xyXG4gICAgcmV0dXJuIHZhbHVlIGluc3RhbmNlb2YgQm9vbGVhbiB8fCB0eXBlb2YgdmFsdWUgPT09ICdib29sZWFuJztcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOajgOafpee7meWumueahHZhbHVlIOaYr+WQpuS4uuWtl+espuS4slxyXG4gICAqL1xyXG4gIGlzU3RyaW5nKHZhbHVlOiBhbnkpOiBib29sZWFuIHtcclxuICAgIHJldHVybiB2YWx1ZSBpbnN0YW5jZW9mIFN0cmluZyB8fCB0eXBlb2YgdmFsdWUgPT09ICdzdHJpbmcnO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog5qOA5p+l57uZ5a6a55qEdmFsdWUg5piv5ZCm5Li65pel5pyfXHJcbiAgICovXHJcbiAgaXNEYXRlKHZhbHVlOiBhbnkpOiBib29sZWFuIHtcclxuICAgIHJldHVybiB2YWx1ZSBpbnN0YW5jZW9mIERhdGUgJiYgIWlzTmFOKHZhbHVlLmdldFRpbWUoKSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDmo4Dmn6Xnu5nlrprnmoR2YWx1ZSDmmK/lkKbkuLrml6XmnJ/lrZfnrKbkuLJcclxuICAgKi9cclxuICBpc0RhdGVTdHJpbmcodmFsdWU6IGFueSk6IGJvb2xlYW4ge1xyXG4gICAgY29uc3QgcmVnZXggPSAvXFxkezR9LSgwWzEtOV18MVswLTJdKS0oMFsxLTldfFsxLTJdWzAtOV18M1swLTFdKShUfFxccz8pPygoWzAtMl1cXGQ6WzAtNV1cXGQpPyg6WzAtNV1cXGQoPzpcXC5cXGQrKSkpPyg/Olp8XFwrWzAtMl1cXGQoPzpcXDpbMC01XVxcZCk/KT8vZztcclxuICAgIHJldHVybiB0aGlzLmlzU3RyaW5nKHZhbHVlKSAmJiByZWdleC50ZXN0KHZhbHVlKSAmJiB0aGlzLnZhbGlkYXRvckpzLnRvRGF0ZSh2YWx1ZSk7XHJcbiAgfVxyXG5cclxuICAvKiog5Yik5patdmFsdWUg55qE6ZW/5bqm5piv5ZCm5Zyo5YWB6K6455qE5pyA5bCP5YC8IOWSjOacgOWkp+WAvOS5i+mXtCAqL1xyXG4gIGxlbmd0aCh2YWx1ZTogYW55LCBtaW46IG51bWJlciwgbWF4PzogbnVtYmVyLCBpc011bHRMYW5ndWFnZUZpZWxkPzogYm9vbGVhbik6IGJvb2xlYW4ge1xyXG4gICAgcmV0dXJuIHR5cGVvZiB2YWx1ZSA9PT0gJ3N0cmluZycgJiYgdGhpcy52YWxpZGF0b3JKcy5pc0xlbmd0aCh2YWx1ZSwgbWluLCBtYXgpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog5qOA5p+l57uZ5a6a55qEdmFsdWXnmoTplb/luqbmmK/lkKbnrKblkIjorr7lrprnmoTmnIDlsI/lgLxcclxuICAgKiBAcGFyYW0gdmFsdWUg5b6F5qOA5p+l55qE5a2X56ym5LiyXHJcbiAgICogQHBhcmFtIG1pbiDmnIDlsI/plb/luqZcclxuICAgKi9cclxuICBtaW5MZW5ndGgodmFsdWU6IGFueSwgaXNNdWx0TGFuZ3VhZ2VGaWVsZDogYm9vbGVhbiwgbWluOiBudW1iZXIpOiBib29sZWFuIHtcclxuICAgIGlmIChpc011bHRMYW5ndWFnZUZpZWxkKSB7XHJcbiAgICAgIC8vIGNvbnN0IGN1cnJlbnRMYW5ndWFnZSA9IFRyYW5zbGF0ZVNlcnZpY2UuZ2V0Q3VycmVudExhbmd1YWdlKCk7XHJcbiAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnKSB7XHJcbiAgICAgICAgY29uc3QgaGFzSW52YWxpZExhbmdzID0gT2JqZWN0LnZhbHVlcyh2YWx1ZSkuZmlsdGVyKCh2OiBhbnkpID0+IHYgJiYgdi5sZW5ndGggPCBtaW4pO1xyXG4gICAgICAgIGlmIChoYXNJbnZhbGlkTGFuZ3MgJiYgaGFzSW52YWxpZExhbmdzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgLy8gaWYgKGN1cnJlbnRMYW5ndWFnZSkge1xyXG4gICAgICAvLyAgIHJldHVybiB2YWx1ZVtjdXJyZW50TGFuZ3VhZ2VdID8gdmFsdWVbY3VycmVudExhbmd1YWdlXS5sZW5ndGggPiBtaW4gOiB0cnVlO1xyXG4gICAgICAvLyB9XHJcbiAgICAgIC8vIOWmguaenOaXoOazleiOt+WPluW9k+WJjeivreiogO+8jOWImeWPquimgeacieS4gOenjeivreiogOeahOi+k+WFpemVv+W6puWkp+S6juacgOWwj+mVv+W6puWNs+WPr+OAglxyXG4gICAgICAvLyBjb25zdCBoYXNWYWxpZExhbmdzID0gT2JqZWN0LnZhbHVlcyh2YWx1ZSkuZmlsdGVyKCh2OiBhbnkpID0+IHYgJiYgdi5sZW5ndGggPiBtaW4pO1xyXG4gICAgICAvLyBpZiAoaGFzVmFsaWRMYW5ncy5sZW5ndGggPiAwKSB7XHJcbiAgICAgIC8vICAgcmV0dXJuIHRydWU7XHJcbiAgICAgIC8vIH1cclxuICAgICAgLy8gcmV0dXJuIGZhbHNlO1xyXG4gICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH1cclxuICAgIGlmICh2YWx1ZSAmJiB0eXBlb2YgdmFsdWUgIT09ICdzdHJpbmcnKSB7XHJcbiAgICAgIHZhbHVlID0gdmFsdWUudG9TdHJpbmcoKTtcclxuICAgIH1cclxuICAgIHJldHVybiAhdmFsdWUgfHwgKHR5cGVvZiB2YWx1ZSA9PT0gJ3N0cmluZycgJiYgdGhpcy5sZW5ndGgodmFsdWUsIG1pbikpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog5qOA5p+l57uZ5a6a55qEdmFsdWXnmoTplb/luqbmmK/lkKbnrKblkIjorr7lrprnmoTmnIDlpKflgLxcclxuICAgKiBAcGFyYW0gdmFsdWUg5b6F5qOA5p+l55qE5a2X56ym5LiyXHJcbiAgICogQHBhcmFtIG1heCDmnIDlpKfplb/luqZcclxuICAgKi9cclxuICBtYXhMZW5ndGgodmFsdWU6IGFueSwgaXNNdWx0TGFuZ3VhZ2VGaWVsZDogYm9vbGVhbiwgbWF4OiBudW1iZXIpOiBib29sZWFuIHtcclxuICAgIGlmIChpc011bHRMYW5ndWFnZUZpZWxkKSB7XHJcbiAgICAgIC8vIGNvbnN0IGN1cnJlbnRMYW5ndWFnZSA9IFRyYW5zbGF0ZVNlcnZpY2UuZ2V0Q3VycmVudExhbmd1YWdlKCk7XHJcbiAgICAgIC8vIGlmIChjdXJyZW50TGFuZ3VhZ2UpIHtcclxuICAgICAgLy8gICByZXR1cm4gdmFsdWVbY3VycmVudExhbmd1YWdlXSA/IHZhbHVlW2N1cnJlbnRMYW5ndWFnZV0ubGVuZ3RoIDwgbWF4IDogdHJ1ZTtcclxuICAgICAgLy8gfVxyXG4gICAgICBpZiAodHlwZW9mIHZhbHVlID09PSAnb2JqZWN0Jykge1xyXG4gICAgICAgIGNvbnN0IGhhc0ludmFsaWRMYW5ncyA9IE9iamVjdC52YWx1ZXModmFsdWUpLmZpbHRlcigodjogYW55KSA9PiB2ICYmIHYubGVuZ3RoID4gbWF4KTtcclxuICAgICAgICBpZiAoaGFzSW52YWxpZExhbmdzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9XHJcbiAgICBpZiAodHlwZW9mIHZhbHVlID09PSAnb2JqZWN0Jykge1xyXG4gICAgICBmb3IgKGNvbnN0IGtleSBpbiB2YWx1ZSkge1xyXG4gICAgICAgIGlmICh2YWx1ZS5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XHJcbiAgICAgICAgICBjb25zdCBlbGVtZW50ID0gdmFsdWVba2V5XTtcclxuICAgICAgICAgIGlmICh0eXBlb2YgZWxlbWVudCA9PT0gJ3N0cmluZycgJiYgIXRoaXMubGVuZ3RoKHZhbHVlW2tleV0sIDAsIG1heCkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH1cclxuICAgIGlmICh2YWx1ZSAmJiB0eXBlb2YgdmFsdWUgIT09ICdzdHJpbmcnKSB7XHJcbiAgICAgIHZhbHVlID0gdmFsdWUudG9TdHJpbmcoKTtcclxuICAgIH1cclxuICAgIHJldHVybiAhdmFsdWUgfHwgKHR5cGVvZiB2YWx1ZSA9PT0gJ3N0cmluZycgJiYgdGhpcy5sZW5ndGgodmFsdWUsIDAsIG1heCkpO1xyXG4gIH1cclxuXHJcbiAgLyoqIOajgOafpXZhbHVl55qE5YC85piv5ZCm5ZyoIOacgOWkp+WAvOS4juacgOWwj+WAvOS5i+mXtCAqL1xyXG4gIHJhbmdlKHZhbHVlOiBudW1iZXIsIGlzTXVsdExhbmd1YWdlRmllbGQ6IGJvb2xlYW4sIG1pbjogbnVtYmVyLCBtYXg6IG51bWJlcik6IGJvb2xlYW4ge1xyXG4gICAgcmV0dXJuIHR5cGVvZiB2YWx1ZSA9PT0gJ251bWJlcicgJiYgdGhpcy5pc051bWJlcihtaW4pICYmIHRoaXMuaXNOdW1iZXIobWF4KSAmJiB2YWx1ZSA+PSBtaW4gJiYgdmFsdWUgPD0gbWF4O1xyXG4gIH1cclxuICAvKipcclxuICAgKiDml6XmnJ/nsbvlnovnmoTlgLzmmK/lkKblnKjmn5DkuKrljLrpl7RcclxuICAgKiBAcGFyYW0gdmFsdWUgdmFsdWVcclxuICAgKiBAcGFyYW0gbWluIOacgOWwj+WAvFxyXG4gICAqIEBwYXJhbSBtYXgg5pyA5aSn5YC8XHJcbiAgICovXHJcbiAgZGF0ZVJhbmdlKHZhbHVlOiBhbnksIGlzTXVsdExhbmd1YWdlRmllbGQ6IGJvb2xlYW4sIHJ1bGU6IHN0cmluZywgdHlwZTogc3RyaW5nKSB7XHJcbiAgICAvLyAyMDEwfjIwMjB8MDR+MDV8MDMgMTE6MDA6MDB+MDUgMTI6MDA6MDBcclxuICAgIGlmICghdmFsdWUpIHtcclxuICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9XHJcbiAgICBpZiAodHlwZSA9PT0gJ21heFZhbHVlJyB8fCB0eXBlID09PSAnbWF4RGF0ZScpIHtcclxuICAgICAgaWYgKHRoaXMuaXNZZWFyUmFuZ2UodmFsdWUpIHx8IHRoaXMuaXNNb250aE9yRGF5UmFuZ2UodmFsdWUpKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMubWF4VmFsdWUocGFyc2VJbnQodGhpcy5nZXRSYW5nZVZhbHVlKHZhbHVlLCAxKSksIGlzTXVsdExhbmd1YWdlRmllbGQsIHBhcnNlSW50KHJ1bGUuc3BsaXQoJyAnKVswXSkpO1xyXG4gICAgICB9IGVsc2UgaWYgKHRoaXMuaXNEYXlUaW1lUmFuZ2UodmFsdWUpKSB7XHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgIH1cclxuICAgIH0gZWxzZSBpZiAodHlwZSA9PT0gJ21pblZhbHVlJyB8fCB0eXBlID09PSAnbWluRGF0ZScpIHtcclxuICAgICAgaWYgKHRoaXMuaXNZZWFyUmFuZ2UodmFsdWUpIHx8IHRoaXMuaXNNb250aE9yRGF5UmFuZ2UodmFsdWUpKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMubWF4VmFsdWUocGFyc2VJbnQodGhpcy5nZXRSYW5nZVZhbHVlKHZhbHVlLCAwKSksIGlzTXVsdExhbmd1YWdlRmllbGQsIHBhcnNlSW50KHJ1bGUuc3BsaXQoJyAnKVswXSkpO1xyXG4gICAgICB9IGVsc2UgaWYgKHRoaXMuaXNEYXlUaW1lUmFuZ2UodmFsdWUpKSB7XHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiBmYWxzZTtcclxuICB9XHJcbiAgcHJpdmF0ZSBnZXRSYW5nZVZhbHVlKHZhbHVlOiBzdHJpbmcsIHBvc2l0aW9uOiAwIHwgMSwgc3BsaXRvciA9ICd+Jykge1xyXG4gICAgcmV0dXJuIHZhbHVlLnNwbGl0KHNwbGl0b3IpW3Bvc2l0aW9uXTtcclxuICB9XHJcbiAgcHJpdmF0ZSBpc0RhdGVSYW5nZSh2YWx1ZTogYW55KSB7XHJcbiAgICBpZiAodHlwZW9mIHZhbHVlICE9PSAnc3RyaW5nJykge1xyXG4gICAgICB2YWx1ZSA9IHZhbHVlLnRvU3RyaW5nKCk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gLyhcXGR7NH18XFxkezJ9KS8udGVzdCh2YWx1ZSk7XHJcbiAgfVxyXG4gIC8qKlxyXG4gICAqIOaYr+WQpuW5tOW6puWMuumXtFxyXG4gICAqIEBwYXJhbSB2YWx1ZSB2YWx1ZVxyXG4gICAqL1xyXG4gIHByaXZhdGUgaXNZZWFyUmFuZ2UodmFsdWU6IGFueSkge1xyXG4gICAgaWYgKHR5cGVvZiB2YWx1ZSAhPT0gJ3N0cmluZycpIHtcclxuICAgICAgdmFsdWUgPSB2YWx1ZS50b1N0cmluZygpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIC9eXFxkezR9flxcZHs0fSQvLnRlc3QodmFsdWUpO1xyXG4gIH1cclxuICAvKipcclxuICAgKiDmmK/lkKbkuLrlubTmnIjljLrpl7RcclxuICAgKiBAcGFyYW0gdmFsdWUgdmFsdWVcclxuICAgKi9cclxuICBwcml2YXRlIGlzWWVhck1vbnRoUmFuZ2UodmFsdWU6IGFueSkge1xyXG4gICAgaWYgKHR5cGVvZiB2YWx1ZSAhPT0gJ3N0cmluZycpIHtcclxuICAgICAgdmFsdWUgPSB2YWx1ZS50b1N0cmluZygpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIC9eXFxkezR9LVxcZHsyfX5cXGR7NH0tXFxkezJ9JC8udGVzdCh2YWx1ZSk7XHJcbiAgfVxyXG4gIC8qKlxyXG4gICAqIOaYr+WQpuS4uuaciOaIluWkqeeahOWMuumXtFxyXG4gICAqIEBwYXJhbSB2YWx1ZSB2YWx1ZVxyXG4gICAqL1xyXG4gIHByaXZhdGUgaXNNb250aE9yRGF5UmFuZ2UodmFsdWU6IGFueSkge1xyXG4gICAgaWYgKHR5cGVvZiB2YWx1ZSAhPT0gJ3N0cmluZycpIHtcclxuICAgICAgdmFsdWUgPSB2YWx1ZS50b1N0cmluZygpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIC9eWzB8MXwyfDNdXFxkezF9flswfDF8MnwzXVxcZHsxfSQvLnRlc3QodmFsdWUpO1xyXG4gIH1cclxuICAvKipcclxuICAgKiDmmK/lkKbkuLrlpKkr5pe26Ze055qE5Yy66Ze0XHJcbiAgICogQHBhcmFtIHZhbHVlIHZhbHVlXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBpc0RheVRpbWVSYW5nZSh2YWx1ZTogYW55KSB7XHJcbiAgICBpZiAodHlwZW9mIHZhbHVlICE9PSAnc3RyaW5nJykge1xyXG4gICAgICB2YWx1ZSA9IHZhbHVlLnRvU3RyaW5nKCk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gL15bMHwxfDJ8M11cXGR7MX0gXFxkezJ9OlxcZHsyfTpcXGR7Mn1+WzB8MXwyfDNdXFxkezF9IFxcZHsyfTpcXGR7Mn06XFxkezJ9JC8udGVzdCh2YWx1ZSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBDaGVja3MgaWYgdGhlIGZpcnN0IG51bWJlciBpcyBncmVhdGVyIHRoYW4gc2Vjb25kLlxyXG4gICAqL1xyXG4gIG1pbihudW06IG51bWJlciwgaXNNdWx0TGFuZ3VhZ2VGaWVsZDogYm9vbGVhbiwgbWluOiBudW1iZXIpOiBib29sZWFuIHtcclxuICAgIHJldHVybiB0eXBlb2YgbnVtID09PSAnbnVtYmVyJyAmJiB0eXBlb2YgbWluID09PSAnbnVtYmVyJyAmJiBudW0gPj0gbWluO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog5pyA5bCP5YC86aqM6K+BXHJcbiAgICovXHJcbiAgbWluVmFsdWUobnVtOiBudW1iZXIgfCBzdHJpbmcsIGlzTXVsdExhbmd1YWdlRmllbGQ6IGJvb2xlYW4sIG1pbjogbnVtYmVyIHwgc3RyaW5nKTogYm9vbGVhbiB7XHJcbiAgICAvLyDlpoLmnpzlgLzkuI3lrZjlnKjvvIzliJnkuI3ov5vooYzmnIDlsI/lgLznmoTliKTmlq1cclxuICAgIGlmIChudW0gPT09IG51bGwgfHwgbnVtID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9XHJcbiAgICAvLyDmjInnhaflpKfmlbDlpITnkIZcclxuICAgIGlmICgodHlwZW9mIG51bSA9PT0gJ3N0cmluZycgJiYgbnVtLm1hdGNoKC9eKC0/XFxkKykoXFwuXFxkKyk/JC9nKSkgfHwgKHR5cGVvZiBtaW4gPT09ICdzdHJpbmcnICYmIG1pbi5tYXRjaCgvXigtP1xcZCspKFxcLlxcZCspPyQvZykpKSB7XHJcbiAgICAgIGNvbnN0IHZhbHVlID0gbmV3IEJpZ051bWJlcihudW0pO1xyXG4gICAgICBjb25zdCBtYXhWYWx1ZSA9IG5ldyBCaWdOdW1iZXIobWluKTtcclxuICAgICAgcmV0dXJuIHZhbHVlLmlzR3JlYXRlclRoYW5PckVxdWFsVG8obWF4VmFsdWUpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHR5cGVvZiBudW0gPT09ICdudW1iZXInICYmIHR5cGVvZiBtaW4gPT09ICdudW1iZXInICYmIG51bSA+PSBtaW47XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBDaGVja3MgaWYgdGhlIGZpcnN0IG51bWJlciBpcyBsZXNzIHRoYW4gc2Vjb25kLlxyXG4gICAqL1xyXG4gIG1heChudW06IG51bWJlciwgaXNNdWx0TGFuZ3VhZ2VGaWVsZDogYm9vbGVhbiwgbWF4OiBudW1iZXIpOiBib29sZWFuIHtcclxuICAgIC8vIOWmguaenOWAvOS4jeWtmOWcqO+8jOWImeS4jei/m+ihjOacgOWwj+WAvOeahOWIpOaWrVxyXG4gICAgaWYgKG51bSA9PT0gbnVsbCB8fCBudW0gPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH1cclxuICAgIHJldHVybiB0eXBlb2YgbnVtID09PSAnbnVtYmVyJyAmJiB0eXBlb2YgbWF4ID09PSAnbnVtYmVyJyAmJiBudW0gPD0gbWF4O1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog5pyA5aSn5YC86aqM6K+BXHJcbiAgICovXHJcbiAgbWF4VmFsdWUobnVtOiBudW1iZXIgfCBzdHJpbmcsIGlzTXVsdExhbmd1YWdlRmllbGQ6IGJvb2xlYW4sIG1heDogbnVtYmVyIHwgc3RyaW5nKTogYm9vbGVhbiB7XHJcbiAgICAvLyDlpoLmnpzlgLzkuI3lrZjlnKjvvIzliJnkuI3ov5vooYzmnIDlsI/lgLznmoTliKTmlq1cclxuICAgIGlmIChudW0gPT09IG51bGwgfHwgbnVtID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9XHJcbiAgICAvLyDmjInnhaflpKfmlbDlpITnkIZcclxuICAgIGlmICgodHlwZW9mIG51bSA9PT0gJ3N0cmluZycgJiYgbnVtLm1hdGNoKC9eKC0/XFxkKykoXFwuXFxkKyk/JC9nKSkgfHwgKHR5cGVvZiBtYXggPT09ICdzdHJpbmcnICYmIG1heC5tYXRjaCgvXigtP1xcZCspKFxcLlxcZCspPyQvZykpKSB7XHJcbiAgICAgIGNvbnN0IHZhbHVlID0gbmV3IEJpZ051bWJlcihudW0pO1xyXG4gICAgICBjb25zdCBtYXhWYWx1ZSA9IG5ldyBCaWdOdW1iZXIobWF4KTtcclxuICAgICAgcmV0dXJuIHZhbHVlLmlzTGVzc1RoYW5PckVxdWFsVG8obWF4VmFsdWUpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHR5cGVvZiBudW0gPT09ICdudW1iZXInICYmIHR5cGVvZiBtYXggPT09ICdudW1iZXInICYmIG51bSA8PSBtYXg7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBDaGVja3MgaWYgdGhlIHZhbHVlIGlzIGEgZGF0ZSB0aGF0J3MgYWZ0ZXIgdGhlIHNwZWNpZmllZCBkYXRlLlxyXG4gICAqL1xyXG4gIG1pbkRhdGUoZGF0ZTogRGF0ZSwgaXNNdWx0TGFuZ3VhZ2VGaWVsZDogYm9vbGVhbiwgbWluRGF0ZTogRGF0ZSk6IGJvb2xlYW4ge1xyXG4gICAgaWYgKCFkYXRlKSB7XHJcbiAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGRhdGUgJiYgZGF0ZS5nZXRUaW1lKCkgPj0gbWluRGF0ZS5nZXRUaW1lKCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBDaGVja3MgaWYgdGhlIHZhbHVlIGlzIGEgZGF0ZSB0aGF0J3MgYmVmb3JlIHRoZSBzcGVjaWZpZWQgZGF0ZS5cclxuICAgKi9cclxuICBtYXhEYXRlKGRhdGU6IERhdGUsIGlzTXVsdExhbmd1YWdlRmllbGQ6IGJvb2xlYW4sIG1heERhdGU6IERhdGUpOiBib29sZWFuIHtcclxuICAgIC8vIOWmguaenOWAvOS4jeWtmOWcqO+8jOWImeS4jei/m+ihjOacgOWwj+WAvOeahOWIpOaWrVxyXG4gICAgaWYgKGRhdGUgPT09IG51bGwgfHwgZGF0ZSA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGRhdGUgJiYgZGF0ZS5nZXRUaW1lKCkgPD0gbWF4RGF0ZS5nZXRUaW1lKCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBDaGVja3MgaWYgYSBzdHJpbmcgaXMgYSBib29sZWFuLlxyXG4gICAqIElmIGdpdmVuIHZhbHVlIGlzIG5vdCBhIHN0cmluZywgdGhlbiBpdCByZXR1cm5zIGZhbHNlLlxyXG4gICAqL1xyXG4gIGlzQm9vbGVhblN0cmluZyh2YWx1ZTogc3RyaW5nKTogYm9vbGVhbiB7XHJcbiAgICByZXR1cm4gdHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJyAmJiB0aGlzLnZhbGlkYXRvckpzLmlzQm9vbGVhbih2YWx1ZSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBDaGVja3MgaWYgdGhlIHN0cmluZyBpcyBudW1lcmljLlxyXG4gICAqIElmIGdpdmVuIHZhbHVlIGlzIG5vdCBhIHN0cmluZywgdGhlbiBpdCByZXR1cm5zIGZhbHNlLlxyXG4gICAqL1xyXG4gIGlzTnVtYmVyU3RyaW5nKHZhbHVlOiBzdHJpbmcpOiBib29sZWFuIHtcclxuICAgIHJldHVybiB0eXBlb2YgdmFsdWUgPT09ICdzdHJpbmcnICYmIHRoaXMudmFsaWRhdG9ySnMuaXNOdW1lcmljKHZhbHVlKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIENoZWNrcyBpZiB0aGUgc3RyaW5nIGNvbnRhaW5zIHRoZSBzZWVkLlxyXG4gICAqIElmIGdpdmVuIHZhbHVlIGlzIG5vdCBhIHN0cmluZywgdGhlbiBpdCByZXR1cm5zIGZhbHNlLlxyXG4gICAqL1xyXG4gIGNvbnRhaW5zKHZhbHVlOiBzdHJpbmcsIGlzTXVsdExhbmd1YWdlRmllbGQ6IGJvb2xlYW4sIHNlZWQ6IHN0cmluZyk6IGJvb2xlYW4ge1xyXG4gICAgcmV0dXJuIHR5cGVvZiB2YWx1ZSA9PT0gJ3N0cmluZycgJiYgdGhpcy52YWxpZGF0b3JKcy5jb250YWlucyh2YWx1ZSwgc2VlZCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBDaGVja3MgaWYgdGhlIHN0cmluZyBkb2VzIG5vdCBjb250YWluIHRoZSBzZWVkLlxyXG4gICAqIElmIGdpdmVuIHZhbHVlIGlzIG5vdCBhIHN0cmluZywgdGhlbiBpdCByZXR1cm5zIGZhbHNlLlxyXG4gICAqL1xyXG4gIG5vdENvbnRhaW5zKHZhbHVlOiBzdHJpbmcsIGlzTXVsdExhbmd1YWdlRmllbGQ6IGJvb2xlYW4sIHNlZWQ6IHN0cmluZyk6IGJvb2xlYW4ge1xyXG4gICAgcmV0dXJuIHR5cGVvZiB2YWx1ZSA9PT0gJ3N0cmluZycgJiYgIXRoaXMudmFsaWRhdG9ySnMuY29udGFpbnModmFsdWUsIHNlZWQpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQ2hlY2tzIGlmIHRoZSBzdHJpbmcgaXMgYW4gZW1haWwuXHJcbiAgICogSWYgZ2l2ZW4gdmFsdWUgaXMgbm90IGEgc3RyaW5nLCB0aGVuIGl0IHJldHVybnMgZmFsc2UuXHJcbiAgICovXHJcbiAgaXNFbWFpbCh2YWx1ZTogc3RyaW5nKTogYm9vbGVhbiB7XHJcbiAgICByZXR1cm4gdHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJyAmJiB0aGlzLnZhbGlkYXRvckpzLmlzRW1haWwodmFsdWUpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQ2hlY2tzIGlmIHRoZSBzdHJpbmcgaXMgdmFsaWQgSlNPTiAobm90ZTogdXNlcyBKU09OLnBhcnNlKS5cclxuICAgKiBJZiBnaXZlbiB2YWx1ZSBpcyBub3QgYSBzdHJpbmcsIHRoZW4gaXQgcmV0dXJucyBmYWxzZS5cclxuICAgKi9cclxuICBpc0pTT04odmFsdWU6IHN0cmluZyk6IGJvb2xlYW4ge1xyXG4gICAgcmV0dXJuIHR5cGVvZiB2YWx1ZSA9PT0gJ3N0cmluZycgJiYgdGhpcy52YWxpZGF0b3JKcy5pc0pTT04odmFsdWUpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQ2hlY2tzIGlmIHRoZSBzdHJpbmcgaXMgbG93ZXJjYXNlLlxyXG4gICAqIElmIGdpdmVuIHZhbHVlIGlzIG5vdCBhIHN0cmluZywgdGhlbiBpdCByZXR1cm5zIGZhbHNlLlxyXG4gICAqL1xyXG4gIGlzTG93ZXJjYXNlKHZhbHVlOiBzdHJpbmcpOiBib29sZWFuIHtcclxuICAgIHJldHVybiB0eXBlb2YgdmFsdWUgPT09ICdzdHJpbmcnICYmIHRoaXMudmFsaWRhdG9ySnMuaXNMb3dlcmNhc2UodmFsdWUpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQ2hlY2tzIGlmIHRoZSBzdHJpbmcgaXMgdXBwZXJjYXNlLlxyXG4gICAqIElmIGdpdmVuIHZhbHVlIGlzIG5vdCBhIHN0cmluZywgdGhlbiBpdCByZXR1cm5zIGZhbHNlLlxyXG4gICAqL1xyXG4gIGlzVXBwZXJjYXNlKHZhbHVlOiBzdHJpbmcpOiBib29sZWFuIHtcclxuICAgIHJldHVybiB0eXBlb2YgdmFsdWUgPT09ICdzdHJpbmcnICYmIHRoaXMudmFsaWRhdG9ySnMuaXNVcHBlcmNhc2UodmFsdWUpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog6aqM6K+B5a2X56ym5Liy5piv5ZCm5YyF5ZCr6Z2e5rOV5a2X56ymXHJcbiAgICogQHBhcmFtIHZhbHVlIOmqjOivgeeahOWtl+espuS4slxyXG4gICAqIEBwYXJhbSBzb21lQ2hhcnMg6Z2e5rOV5a2X56ym44CC5aaC77yaI++/pSVAJFxyXG4gICAqL1xyXG4gIGV4Y2x1ZGUodmFsdWU6IHN0cmluZywgaXNNdWx0TGFuZ3VhZ2VGaWVsZDogYm9vbGVhbiwgc29tZUNoYXJzOiBzdHJpbmcpOiBib29sZWFuIHtcclxuICAgIGNvbnN0IGFyckNoYXIgPSBzb21lQ2hhcnMuc3BsaXQoJycpO1xyXG4gICAgbGV0IGNvdW50ZXIgPSAwO1xyXG4gICAgYXJyQ2hhci5mb3JFYWNoKHZhbCA9PiB7XHJcbiAgICAgIGlmICh0aGlzLmNvbnRhaW5zKHZhbHVlLCBpc011bHRMYW5ndWFnZUZpZWxkLCB2YWwpKSB7XHJcbiAgICAgICAgY291bnRlcisrO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICByZXR1cm4gY291bnRlciA9PT0gMDtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOiHquWumuS5ieato+WImemqjOivgVxyXG4gICAqIEBwYXJhbSB2YWx1ZSDlvoXpqozor4HnmoTlrZfnrKbkuLJcclxuICAgKiBAcGFyYW0gcGF0dGVybiDmraPliJnooajovr7lvI9cclxuICAgKi9cclxuICBtYXRjaGVzKHZhbHVlOiBzdHJpbmcsIGlzTXVsdExhbmd1YWdlRmllbGQ6IGJvb2xlYW4sIHBhdHRlcm46IGFueSk6IGJvb2xlYW4ge1xyXG4gICAgdmFsdWUgPSAodmFsdWUgPT09IG51bGwgfHwgdmFsdWUgPT09IHVuZGVmaW5lZCkgPyAnJyA6IHZhbHVlLnRvU3RyaW5nKCk7XHJcbiAgICBpZiAodmFsdWUgPT09ICcnKSB7XHJcbiAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHRoaXMudmFsaWRhdG9ySnMubWF0Y2hlcyh2YWx1ZSwgcGF0dGVybik7XHJcbiAgfVxyXG59XHJcbiJdfQ==