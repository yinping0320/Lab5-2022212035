import { FieldMetadataUtil } from '../entity/index';
import { BindingPropertyType } from './binding_property';
/**
 * 属性工具类
 */
var PropertyUtil = /** @class */ (function () {
    function PropertyUtil() {
    }
    /**
     * 获取实体上的属性集合，并将他们转换成BindingProperty集合
     * @param  entityType 实体类型
     * @returns 绑定属性集合
     */
    PropertyUtil.getProperties = function (entityType) {
        var properties = [];
        // Plain
        var ngFieldProperties = FieldMetadataUtil.getNgFields(entityType);
        Object.keys(ngFieldProperties).forEach(function (propertyName) {
            var ngFieldProperty = ngFieldProperties[propertyName];
            properties.push({
                name: propertyName,
                type: BindingPropertyType.Plain,
                isPrimaryKey: ngFieldProperty.primary,
                isForeignKey: ngFieldProperty.foreign,
                enableMultiLangInput: ngFieldProperty.enableMultiLangInput
            });
        });
        // Object
        var ngObjectProperties = FieldMetadataUtil.getNgObjects(entityType);
        Object.keys(ngObjectProperties).forEach(function (propertyName) {
            var ngObjectProperty = ngObjectProperties[propertyName];
            properties.push({
                name: propertyName,
                type: BindingPropertyType.Object,
                entityType: ngObjectProperty.type
            });
        });
        // List
        var ngListProperties = FieldMetadataUtil.getNgList(entityType);
        Object.keys(ngListProperties).forEach(function (propertyName) {
            var ngListProperty = ngListProperties[propertyName];
            properties.push({
                name: propertyName,
                type: BindingPropertyType.List,
                entityType: ngListProperty.type
            });
        });
        // Dynamics
        var ngDynamicProperties = FieldMetadataUtil.getNgDynamic(entityType);
        Object.keys(ngDynamicProperties).forEach(function (propertyName) {
            var ngDynamicProperty = ngDynamicProperties[propertyName];
            properties.push({
                name: propertyName,
                type: BindingPropertyType.Dynamic,
                entityType: ngDynamicProperty.type
            });
        });
        return properties;
    };
    PropertyUtil.getDynamicProperties = function (dynamicData) {
        var properties = [];
        Object.keys(dynamicData).forEach(function (propertyName) {
            if (dynamicData.hasOwnProperty(propertyName)) {
                if (dynamicData[propertyName] instanceof Object) {
                    properties.push({
                        name: propertyName,
                        type: BindingPropertyType.Dynamic,
                        entityType: null
                    });
                }
                else {
                    properties.push({
                        name: propertyName,
                        type: BindingPropertyType.Plain,
                        isPrimaryKey: false,
                        isForeignKey: false
                    });
                }
            }
        });
        return properties;
    };
    /**
     * 根据属性名获取属性
     */
    PropertyUtil.getPropertyByName = function (properties, propertyName) {
        var targetProperty = properties.find(function (property) {
            return property.name === propertyName;
        });
        return targetProperty;
    };
    /**
     * 获取实体主键名
     * @param properties 属性集合
     * @returns 主键名
     */
    PropertyUtil.getPrimaryKey = function (properties) {
        // 实体必须有主键，如果没有主键在构造实体的时候就已经报错，这里不需要再进行检查
        var primaryProperty = properties.find(function (property) {
            return property.isPrimaryKey === true;
        });
        return primaryProperty ? primaryProperty.name : '';
    };
    return PropertyUtil;
}());
export { PropertyUtil };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicHJvcGVydHlfdXRpbC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BmYXJyaXMvZGV2a2l0LyIsInNvdXJjZXMiOlsibGliL2JpbmRpbmctZGF0YS9wcm9wZXJ0eV91dGlsLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUNBLE9BQU8sRUFBVSxpQkFBaUIsRUFBRSxNQUFNLGlCQUFpQixDQUFDO0FBQzVELE9BQU8sRUFBbUIsbUJBQW1CLEVBQUUsTUFBTSxvQkFBb0IsQ0FBQztBQUUxRTs7R0FFRztBQUNIO0lBQUE7SUF5R0EsQ0FBQztJQXZHQzs7OztPQUlHO0lBQ0ksMEJBQWEsR0FBcEIsVUFBcUIsVUFBd0I7UUFDM0MsSUFBTSxVQUFVLEdBQUcsRUFBRSxDQUFDO1FBRXRCLFFBQVE7UUFDUixJQUFNLGlCQUFpQixHQUFHLGlCQUFpQixDQUFDLFdBQVcsQ0FBQyxVQUFVLENBQUMsQ0FBQztRQUNwRSxNQUFNLENBQUMsSUFBSSxDQUFDLGlCQUFpQixDQUFDLENBQUMsT0FBTyxDQUFDLFVBQUMsWUFBb0I7WUFDMUQsSUFBTSxlQUFlLEdBQUcsaUJBQWlCLENBQUMsWUFBWSxDQUFDLENBQUM7WUFDeEQsVUFBVSxDQUFDLElBQUksQ0FBQztnQkFDZCxJQUFJLEVBQUUsWUFBWTtnQkFDbEIsSUFBSSxFQUFFLG1CQUFtQixDQUFDLEtBQUs7Z0JBQy9CLFlBQVksRUFBRSxlQUFlLENBQUMsT0FBTztnQkFDckMsWUFBWSxFQUFFLGVBQWUsQ0FBQyxPQUFPO2dCQUNyQyxvQkFBb0IsRUFBRSxlQUFlLENBQUMsb0JBQW9CO2FBQzNELENBQUMsQ0FBQztRQUNMLENBQUMsQ0FBQyxDQUFDO1FBRUgsU0FBUztRQUNULElBQU0sa0JBQWtCLEdBQUcsaUJBQWlCLENBQUMsWUFBWSxDQUFDLFVBQVUsQ0FBQyxDQUFDO1FBQ3RFLE1BQU0sQ0FBQyxJQUFJLENBQUMsa0JBQWtCLENBQUMsQ0FBQyxPQUFPLENBQUMsVUFBQyxZQUFvQjtZQUMzRCxJQUFNLGdCQUFnQixHQUFHLGtC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ZUFBZSxDQUFDLENBQUMsQ0FBQyxlQUFlLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUM7SUFDckQsQ0FBQztJQUVILG1CQUFDO0FBQUQsQ0FBQyxBQXpHRCxJQXlHQztBQUVELE9BQU8sRUFBRSxZQUFZLEVBQUUsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFR5cGUgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgRW50aXR5LCBGaWVsZE1ldGFkYXRhVXRpbCB9IGZyb20gJy4uL2VudGl0eS9pbmRleCc7XHJcbmltcG9ydCB7IEJpbmRpbmdQcm9wZXJ0eSwgQmluZGluZ1Byb3BlcnR5VHlwZSB9IGZyb20gJy4vYmluZGluZ19wcm9wZXJ0eSc7XHJcblxyXG4vKipcclxuICog5bGe5oCn5bel5YW357G7XHJcbiAqL1xyXG5jbGFzcyBQcm9wZXJ0eVV0aWwge1xyXG5cclxuICAvKipcclxuICAgKiDojrflj5blrp7kvZPkuIrnmoTlsZ7mgKfpm4blkIjvvIzlubblsIbku5bku6zovazmjaLmiJBCaW5kaW5nUHJvcGVydHnpm4blkIhcclxuICAgKiBAcGFyYW0gIGVudGl0eVR5cGUg5a6e5L2T57G75Z6LXHJcbiAgICogQHJldHVybnMg57uR5a6a5bGe5oCn6ZuG5ZCIXHJcbiAgICovXHJcbiAgc3RhdGljIGdldFByb3BlcnRpZXMoZW50aXR5VHlwZTogVHlwZTxFbnRpdHk+KTogQmluZGluZ1Byb3BlcnR5W10ge1xyXG4gICAgY29uc3QgcHJvcGVydGllcyA9IFtdO1xyXG5cclxuICAgIC8vIFBsYWluXHJcbiAgICBjb25zdCBuZ0ZpZWxkUHJvcGVydGllcyA9IEZpZWxkTWV0YWRhdGFVdGlsLmdldE5nRmllbGRzKGVudGl0eVR5cGUpO1xyXG4gICAgT2JqZWN0LmtleXMobmdGaWVsZFByb3BlcnRpZXMpLmZvckVhY2goKHByb3BlcnR5TmFtZTogc3RyaW5nKSA9PiB7XHJcbiAgICAgIGNvbnN0IG5nRmllbGRQcm9wZXJ0eSA9IG5nRmllbGRQcm9wZXJ0aWVzW3Byb3BlcnR5TmFtZV07XHJcbiAgICAgIHByb3BlcnRpZXMucHVzaCh7XHJcbiAgICAgICAgbmFtZTogcHJvcGVydHlOYW1lLFxyXG4gICAgICAgIHR5cGU6IEJpbmRpbmdQcm9wZXJ0eVR5cGUuUGxhaW4sXHJcbiAgICAgICAgaXNQcmltYXJ5S2V5OiBuZ0ZpZWxkUHJvcGVydHkucHJpbWFyeSxcclxuICAgICAgICBpc0ZvcmVpZ25LZXk6IG5nRmllbGRQcm9wZXJ0eS5mb3JlaWduLFxyXG4gICAgICAgIGVuYWJsZU11bHRpTGFuZ0lucHV0OiBuZ0ZpZWxkUHJvcGVydHkuZW5hYmxlTXVsdGlMYW5nSW5wdXRcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICAvLyBPYmplY3RcclxuICAgIGNvbnN0IG5nT2JqZWN0UHJvcGVydGllcyA9IEZpZWxkTWV0YWRhdGFVdGlsLmdldE5nT2JqZWN0cyhlbnRpdHlUeXBlKTtcclxuICAgIE9iamVjdC5rZXlzKG5nT2JqZWN0UHJvcGVydGllcykuZm9yRWFjaCgocHJvcGVydHlOYW1lOiBzdHJpbmcpID0+IHtcclxuICAgICAgY29uc3QgbmdPYmplY3RQcm9wZXJ0eSA9IG5nT2JqZWN0UHJvcGVydGllc1twcm9wZXJ0eU5hbWVdO1xyXG4gICAgICBwcm9wZXJ0aWVzLnB1c2goe1xyXG4gICAgICAgIG5hbWU6IHByb3BlcnR5TmFtZSxcclxuICAgICAgICB0eXBlOiBCaW5kaW5nUHJvcGVydHlUeXBlLk9iamVjdCxcclxuICAgICAgICBlbnRpdHlUeXBlOiBuZ09iamVjdFByb3BlcnR5LnR5cGVcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICAvLyBMaXN0XHJcbiAgICBjb25zdCBuZ0xpc3RQcm9wZXJ0aWVzID0gRmllbGRNZXRhZGF0YVV0aWwuZ2V0TmdMaXN0KGVudGl0eVR5cGUpO1xyXG4gICAgT2JqZWN0LmtleXMobmdMaXN0UHJvcGVydGllcykuZm9yRWFjaCgocHJvcGVydHlOYW1lOiBzdHJpbmcpID0+IHtcclxuICAgICAgY29uc3QgbmdMaXN0UHJvcGVydHkgPSBuZ0xpc3RQcm9wZXJ0aWVzW3Byb3BlcnR5TmFtZV07XHJcbiAgICAgIHByb3BlcnRpZXMucHVzaCh7XHJcbiAgICAgICAgbmFtZTogcHJvcGVydHlOYW1lLFxyXG4gICAgICAgIHR5cGU6IEJpbmRpbmdQcm9wZXJ0eVR5cGUuTGlzdCxcclxuICAgICAgICBlbnRpdHlUeXBlOiBuZ0xpc3RQcm9wZXJ0eS50eXBlXHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgLy8gRHluYW1pY3NcclxuICAgIGNvbnN0IG5nRHluYW1pY1Byb3BlcnRpZXMgPSBGaWVsZE1ldGFkYXRhVXRpbC5nZXROZ0R5bmFtaWMoZW50aXR5VHlwZSk7XHJcbiAgICBPYmplY3Qua2V5cyhuZ0R5bmFtaWNQcm9wZXJ0aWVzKS5mb3JFYWNoKChwcm9wZXJ0eU5hbWU6IHN0cmluZykgPT4ge1xyXG4gICAgICBjb25zdCBuZ0R5bmFtaWNQcm9wZXJ0eSA9IG5nRHluYW1pY1Byb3BlcnRpZXNbcHJvcGVydHlOYW1lXTtcclxuICAgICAgcHJvcGVydGllcy5wdXNoKHtcclxuICAgICAgICBuYW1lOiBwcm9wZXJ0eU5hbWUsXHJcbiAgICAgICAgdHlwZTogQmluZGluZ1Byb3BlcnR5VHlwZS5EeW5hbWljLFxyXG4gICAgICAgIGVudGl0eVR5cGU6IG5nRHluYW1pY1Byb3BlcnR5LnR5cGVcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICByZXR1cm4gcHJvcGVydGllcztcclxuICB9XHJcblxyXG4gIHN0YXRpYyBnZXREeW5hbWljUHJvcGVydGllcyhkeW5hbWljRGF0YTogYW55KTogQmluZGluZ1Byb3BlcnR5W10ge1xyXG4gICAgY29uc3QgcHJvcGVydGllcyA9IFtdO1xyXG4gICAgT2JqZWN0LmtleXMoZHluYW1pY0RhdGEpLmZvckVhY2goKHByb3BlcnR5TmFtZTogc3RyaW5nKSA9PiB7XHJcbiAgICAgIGlmIChkeW5hbWljRGF0YS5oYXNPd25Qcm9wZXJ0eShwcm9wZXJ0eU5hbWUpKSB7XHJcbiAgICAgICAgaWYgKGR5bmFtaWNEYXRhW3Byb3BlcnR5TmFtZV0gaW5zdGFuY2VvZiBPYmplY3QpIHtcclxuICAgICAgICAgIHByb3BlcnRpZXMucHVzaCh7XHJcbiAgICAgICAgICAgIG5hbWU6IHByb3BlcnR5TmFtZSxcclxuICAgICAgICAgICAgdHlwZTogQmluZGluZ1Byb3BlcnR5VHlwZS5EeW5hbWljLFxyXG4gICAgICAgICAgICBlbnRpdHlUeXBlOiBudWxsXHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgcHJvcGVydGllcy5wdXNoKHtcclxuICAgICAgICAgICAgbmFtZTogcHJvcGVydHlOYW1lLFxyXG4gICAgICAgICAgICB0eXBlOiBCaW5kaW5nUHJvcGVydHlUeXBlLlBsYWluLFxyXG4gICAgICAgICAgICBpc1ByaW1hcnlLZXk6IGZhbHNlLFxyXG4gICAgICAgICAgICBpc0ZvcmVpZ25LZXk6IGZhbHNlXHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIHByb3BlcnRpZXM7XHJcbiAgfVxyXG4gIC8qKlxyXG4gICAqIOagueaNruWxnuaAp+WQjeiOt+WPluWxnuaAp1xyXG4gICAqL1xyXG4gIHN0YXRpYyBnZXRQcm9wZXJ0eUJ5TmFtZShwcm9wZXJ0aWVzOiBCaW5kaW5nUHJvcGVydHlbXSwgcHJvcGVydHlOYW1lOiBzdHJpbmcpOiBCaW5kaW5nUHJvcGVydHkge1xyXG4gICAgY29uc3QgdGFyZ2V0UHJvcGVydHkgPSBwcm9wZXJ0aWVzLmZpbmQoKHByb3BlcnR5OiBCaW5kaW5nUHJvcGVydHkpID0+IHtcclxuICAgICAgcmV0dXJuIHByb3BlcnR5Lm5hbWUgPT09IHByb3BlcnR5TmFtZTtcclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIHRhcmdldFByb3BlcnR5O1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog6I635Y+W5a6e5L2T5Li76ZSu5ZCNXHJcbiAgICogQHBhcmFtIHByb3BlcnRpZXMg5bGe5oCn6ZuG5ZCIXHJcbiAgICogQHJldHVybnMg5Li76ZSu5ZCNXHJcbiAgICovXHJcbiAgc3RhdGljIGdldFByaW1hcnlLZXkocHJvcGVydGllczogQmluZGluZ1Byb3BlcnR5W10pOiBzdHJpbmcge1xyXG5cclxuICAgIC8vIOWunuS9k+W/hemhu+acieS4u+mUru+8jOWmguaenOayoeacieS4u+mUruWcqOaehOmAoOWunuS9k+eahOaXtuWAmeWwseW3sue7j+aKpemUme+8jOi/memHjOS4jemcgOimgeWGjei/m+ihjOajgOafpVxyXG4gICAgY29uc3QgcHJpbWFyeVByb3BlcnR5ID0gcHJvcGVydGllcy5maW5kKChwcm9wZXJ0eTogQmluZGluZ1Byb3BlcnR5KSA9PiB7XHJcbiAgICAgIHJldHVybiBwcm9wZXJ0eS5pc1ByaW1hcnlLZXkgPT09IHRydWU7XHJcbiAgICB9KTtcclxuICAgIHJldHVybiBwcmltYXJ5UHJvcGVydHkgPyBwcmltYXJ5UHJvcGVydHkubmFtZSA6ICcnO1xyXG4gIH1cclxuXHJcbn1cclxuXHJcbmV4cG9ydCB7IFByb3BlcnR5VXRpbCB9O1xyXG4iXX0=