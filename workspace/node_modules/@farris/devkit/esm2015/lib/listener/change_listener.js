import { Subject } from "rxjs";
import { DataPropGroup } from "../core";
/**
 * 变更监听器
 */
export class ChangeListener {
    constructor() {
        this.subject = new Subject();
    }
    get onEvent() {
        return this.subject;
    }
    /**
     * 找到元数据中所有实体路径
     * @param dataTypeInfo
     * @param results
     * @param paths
     */
    findEntityPaths(dataTypeInfo, results, paths = []) {
        const list = dataTypeInfo.getPropInfosByGroup(DataPropGroup.List);
        if (list && list.length > 0) {
            list.forEach((dataPropInfo) => {
                paths.push(dataPropInfo.name);
                const childrens = dataPropInfo.typeInfo.getPropInfosByGroup(DataPropGroup.List);
                if (childrens && childrens.length > 0) {
                    childrens.forEach((dataPropInfo) => {
                        this.findEntityPaths(dataPropInfo.typeInfo, results, paths);
                    });
                }
                else {
                    results.push(paths);
                }
            });
        }
        else if (paths && paths.length > 0) {
            results.push(paths);
        }
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2hhbmdlX2xpc3RlbmVyLmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGZhcnJpcy9kZXZraXQvIiwic291cmNlcyI6WyJsaWIvbGlzdGVuZXIvY2hhbmdlX2xpc3RlbmVyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBYyxPQUFPLEVBQUUsTUFBTSxNQUFNLENBQUM7QUFHM0MsT0FBTyxFQUFFLGFBQWEsRUFBOEIsTUFBTSxTQUFTLENBQUM7QUFPcEU7O0dBRUc7QUFDSCxNQUFNLE9BQWdCLGNBQWM7SUFBcEM7UUFDWSxZQUFPLEdBQXVCLElBQUksT0FBTyxFQUFhLENBQUM7SUE2Qm5FLENBQUM7SUE1QkMsSUFBVyxPQUFPO1FBQ2hCLE9BQU8sSUFBSSxDQUFDLE9BQU8sQ0FBQztJQUN0QixDQUFDO0lBRUQ7Ozs7O09BS0c7SUFDSSxlQUFlLENBQUMsWUFBMEIsRUFBRSxPQUFjLEVBQUUsUUFBa0IsRUFBRTtRQUNyRixNQUFNLElBQUksR0FBbUIsWUFBWSxDQUFDLG1CQUFtQixDQUFDLGFBQWEsQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUNsRixJQUFJLElBQUksSUFBSSxJQUFJLENBQUMsTUFBTSxHQUFHLENBQUMsRUFBRTtZQUMzQixJQUFJLENBQUMsT0FBTyxDQUFDLENBQUMsWUFBMEIsRUFBRSxFQUFFO2dCQUMxQyxLQUFLLENBQUMsSUFBSSxDQUFDLFlBQVksQ0FBQyxJQUFJLENBQUMsQ0FBQztnQkFDOUIsTUFBTSxTQUFTLEdBQW1CLFlBQVksQ0FBQyxRQUFRLENBQUMsbUJBQW1CLENBQUMsYUFBYSxDQUFDLElBQUksQ0FBQyxDQUFDO2dCQUNoRyxJQUFJLFNBQVMsSUFBSSxTQUFTLENBQUMsTUFBTSxHQUFHLENBQUMsRUFBRTtvQkFDckMsU0FBUyxDQUFDLE9BQU8sQ0FBQyxDQUFDLFlBQTBCLEVBQUUsRUFBRTt3QkFDL0MsSUFBSSxDQUFDLGVBQWUsQ0FBQyxZQUFZLENBQUMsUUFBUSxFQUFFLE9BQU8sRUFBRSxLQUFLLENBQUMsQ0FBQztvQkFDOUQsQ0FBQyxDQUFDLENBQUM7aUJBQ0o7cUJBQU07b0JBQ0wsT0FBTyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQztpQkFDckI7WUFDSCxDQUFDLENBQUMsQ0FBQztTQUNKO2FBQU0sSUFBSSxLQUFLLElBQUksS0FBSyxDQUFDLE1BQU0sR0FBRyxDQUFDLEVBQUU7WUFDcEMsT0FBTyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQztTQUNyQjtJQUNILENBQUM7Q0FDRiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE9ic2VydmFibGUsIFN1YmplY3QgfSBmcm9tIFwicnhqc1wiO1xyXG5pbXBvcnQgeyBDaGFuZ2UgfSBmcm9tIFwiLi4vYmluZGluZy1kYXRhL2luZGV4XCI7XHJcbmltcG9ydCB7IE1vZGlmaWNhdGlvbiB9IGZyb20gXCIuLi9jaGFuZ2VzZXQvaW5kZXhcIjtcclxuaW1wb3J0IHsgRGF0YVByb3BHcm91cCwgRGF0YVByb3BJbmZvLCBEYXRhVHlwZUluZm8gfSBmcm9tIFwiLi4vY29yZVwiO1xyXG5pbXBvcnQgeyBFeHByZXNzaW9uIH0gZnJvbSAnLi4vZXhwcmVzc2lvbi9pbmRleCc7XHJcbmltcG9ydCB7IFVJU3RhdGVPYnNlcnZhYmxlUGFyYW0gfSBmcm9tIFwiLi4vdWktc3RhdGUvaW5kZXhcIjtcclxuXHJcbnR5cGUgRXZlbnRBcmdzID0gRXhwcmVzc2lvbi5FdmVudEFyZ3M7XHJcbnR5cGUgTGlzdGVuZXIgPSBFeHByZXNzaW9uLkxpc3RlbmVyO1xyXG5cclxuLyoqXHJcbiAqIOWPmOabtOebkeWQrOWZqFxyXG4gKi9cclxuZXhwb3J0IGFic3RyYWN0IGNsYXNzIENoYW5nZUxpc3RlbmVyIGltcGxlbWVudHMgTGlzdGVuZXIge1xyXG4gIHByb3RlY3RlZCBzdWJqZWN0OiBTdWJqZWN0PEV2ZW50QXJncz4gPSBuZXcgU3ViamVjdDxFdmVudEFyZ3M+KCk7XHJcbiAgcHVibGljIGdldCBvbkV2ZW50KCk6IE9ic2VydmFibGU8RXZlbnRBcmdzPiB7XHJcbiAgICByZXR1cm4gdGhpcy5zdWJqZWN0O1xyXG4gIH1cclxuICBhYnN0cmFjdCBidWlsZEV2ZW50UGF0aChjaGFuZ2U6IENoYW5nZSB8IE1vZGlmaWNhdGlvbiB8VUlTdGF0ZU9ic2VydmFibGVQYXJhbSk6IHN0cmluZ1tdO1xyXG4gIC8qKlxyXG4gICAqIOaJvuWIsOWFg+aVsOaNruS4reaJgOacieWunuS9k+i3r+W+hFxyXG4gICAqIEBwYXJhbSBkYXRhVHlwZUluZm8gXHJcbiAgICogQHBhcmFtIHJlc3VsdHMgXHJcbiAgICogQHBhcmFtIHBhdGhzIFxyXG4gICAqL1xyXG4gIHB1YmxpYyBmaW5kRW50aXR5UGF0aHMoZGF0YVR5cGVJbmZvOiBEYXRhVHlwZUluZm8sIHJlc3VsdHM6IGFueVtdLCBwYXRoczogc3RyaW5nW10gPSBbXSkge1xyXG4gICAgY29uc3QgbGlzdDogRGF0YVByb3BJbmZvW10gPSBkYXRhVHlwZUluZm8uZ2V0UHJvcEluZm9zQnlHcm91cChEYXRhUHJvcEdyb3VwLkxpc3QpO1xyXG4gICAgaWYgKGxpc3QgJiYgbGlzdC5sZW5ndGggPiAwKSB7XHJcbiAgICAgIGxpc3QuZm9yRWFjaCgoZGF0YVByb3BJbmZvOiBEYXRhUHJvcEluZm8pID0+IHtcclxuICAgICAgICBwYXRocy5wdXNoKGRhdGFQcm9wSW5mby5uYW1lKTtcclxuICAgICAgICBjb25zdCBjaGlsZHJlbnM6IERhdGFQcm9wSW5mb1tdID0gZGF0YVByb3BJbmZvLnR5cGVJbmZvLmdldFByb3BJbmZvc0J5R3JvdXAoRGF0YVByb3BHcm91cC5MaXN0KTtcclxuICAgICAgICBpZiAoY2hpbGRyZW5zICYmIGNoaWxkcmVucy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICBjaGlsZHJlbnMuZm9yRWFjaCgoZGF0YVByb3BJbmZvOiBEYXRhUHJvcEluZm8pID0+IHtcclxuICAgICAgICAgICAgdGhpcy5maW5kRW50aXR5UGF0aHMoZGF0YVByb3BJbmZvLnR5cGVJbmZvLCByZXN1bHRzLCBwYXRocyk7XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgcmVzdWx0cy5wdXNoKHBhdGhzKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG4gICAgfSBlbHNlIGlmIChwYXRocyAmJiBwYXRocy5sZW5ndGggPiAwKSB7XHJcbiAgICAgIHJlc3VsdHMucHVzaChwYXRocyk7XHJcbiAgICB9XHJcbiAgfVxyXG59Il19