/**
 * 过滤条件管理器
 */
export class FilterConditionManager {
    constructor() {
        this.filters = new Map();
    }
    /**
     * 获取过滤条件
     * @param bindingPath 绑定路径
     */
    getFilters(bindingPath) {
        return this.filters.get(bindingPath) || [];
    }
    /**
     * 自定义合并
     * @param bindingPath 绑定路径
     * @param merge 合并函数
     */
    mergeCondition(bindingPath, merge) {
        const conditions = this.filters.get(bindingPath) || [];
        const result = merge(conditions);
        this.filters.set(bindingPath, result);
    }
    /**
     * 增加过滤条件
     * @param bindingPath 绑定路径
     * @param condition 过滤条件
     */
    addCondition(bindingPath, condition) {
        // 通过bindingPath获取对应的过滤条件
        const conditions = this.filters.get(bindingPath);
        const index = this.findConditionIndex(bindingPath, condition);
        if (index !== -1) {
            conditions[index] = condition;
        }
        else {
            conditions.push(condition);
        }
    }
    /**
     * 批量增加过滤条件
     * @param bindingPath 绑定路径
     * @param conditions 过滤条件数组
     */
    addConditions(bindingPath, conditions) {
        if (!conditions || !Array.isArray(conditions) || conditions.length < 1) {
            return;
        }
        conditions.forEach(condition => {
            this.addCondition(bindingPath, condition);
        });
    }
    /**
     * 删除过滤条件
     * @param bindingPath 绑定路径
     * @param predicate 条件表达式
     */
    removeCondition(bindingPath, predicate) {
        const conditions = this.filters.get(bindingPath);
        if (!conditions || conditions.length < 1) {
            return;
        }
        const removes = conditions.filter(predicate);
        if (removes) {
            removes.forEach(condition => {
                const index = this.findConditionIndex(bindingPath, condition);
                if (index >= 0) {
                    conditions.splice(index, 1);
                }
            });
        }
    }
    /**
     * 清空过滤条件
     */
    clear() {
        this.filters.clear();
    }
    /**
     * 设置过滤条件数组
     * @param bindingPath 绑定路径
     * @param conditions 过滤条件数组
     */
    setConditions(bindingPath, conditions) {
        this.filters.set(bindingPath, conditions);
    }
    /**
     * 查找过滤条件索引
     * @param bindingPath 绑定路径
     * @param condition 过滤条件
     */
    findConditionIndex(bindingPath, condition) {
        if (!condition || typeof (condition) !== 'object' || Object.keys(condition).length < 1) {
            return -1;
        }
        const conditions = this.filters.get(bindingPath);
        if (!conditions || conditions.length < 1) {
            return -1;
        }
        return conditions.findIndex((value, index) => {
            let isEqual = true;
            const props = Object.keys(condition);
            for (const prop of props) {
                if (!(value && value.hasOwnProperty(prop) && value[prop] === condition[prop])) {
                    isEqual = false;
                    break;
                }
            }
            return isEqual;
        });
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZmlsdGVyX2NvbmRpdGlvbl9tYW5hZ2VyLmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGZhcnJpcy9kZXZraXQvIiwic291cmNlcyI6WyJsaWIvcmVwb3NpdG9yeS9maWx0ZXJfY29uZGl0aW9uX21hbmFnZXIudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7O0dBRUc7QUFDSCxNQUFNLE9BQU8sc0JBQXNCO0lBQW5DO1FBQ1ksWUFBTyxHQUE0QixJQUFJLEdBQUcsRUFBc0IsQ0FBQztJQTBHN0UsQ0FBQztJQXpHRzs7O09BR0c7SUFDSSxVQUFVLENBQUMsV0FBbUI7UUFDakMsT0FBTyxJQUFJLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxXQUFXLENBQUMsSUFBSSxFQUFFLENBQUM7SUFDL0MsQ0FBQztJQUNEOzs7O09BSUc7SUFDSSxjQUFjLENBQUMsV0FBbUIsRUFBRSxLQUErQjtRQUN0RSxNQUFNLFVBQVUsR0FBRyxJQUFJLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxXQUFXLENBQUMsSUFBSSxFQUFFLENBQUM7UUFDdkQsTUFBTSxNQUFNLEdBQUcsS0FBSyxDQUFDLFVBQVUsQ0FBQyxDQUFDO1FBQ2pDLElBQUksQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLFdBQVcsRUFBRSxNQUFNLENBQUMsQ0FBQztJQUMxQyxDQUFDO0lBQ0Q7Ozs7T0FJRztJQUNJLFlBQVksQ0FBQyxXQUFtQixFQUFFLFNBQWM7UUFDbkQseUJBQXlCO1FBQ3pCLE1BQU0sVUFBVSxHQUFHLElBQUksQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLFdBQVcsQ0FBQyxDQUFDO1FBQ2pELE1BQU0sS0FBSyxHQUFHLElBQUksQ0FBQyxrQkFBa0IsQ0FBQyxXQUFXLEVBQUUsU0FBUyxDQUFDLENBQUM7UUFDOUQsSUFBSSxLQUFLLEtBQUssQ0FBQyxDQUFDLEVBQUU7WUFDZCxVQUFVLENBQUMsS0FBSyxDQUFDLEdBQUcsU0FBUyxDQUFDO1NBQ2pDO2FBQU07WUFDSCxVQUFVLENBQUMsSUFB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oeeQhuWZqFxyXG4gKi9cclxuZXhwb3J0IGNsYXNzIEZpbHRlckNvbmRpdGlvbk1hbmFnZXIge1xyXG4gICAgcHJpdmF0ZSBmaWx0ZXJzOiBNYXA8c3RyaW5nLCBBcnJheTxhbnk+PiA9IG5ldyBNYXA8c3RyaW5nLCBBcnJheTxhbnk+PigpO1xyXG4gICAgLyoqXHJcbiAgICAgKiDojrflj5bov4fmu6TmnaHku7ZcclxuICAgICAqIEBwYXJhbSBiaW5kaW5nUGF0aCDnu5Hlrprot6/lvoRcclxuICAgICAqL1xyXG4gICAgcHVibGljIGdldEZpbHRlcnMoYmluZGluZ1BhdGg6IHN0cmluZykge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmZpbHRlcnMuZ2V0KGJpbmRpbmdQYXRoKSB8fCBbXTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICog6Ieq5a6a5LmJ5ZCI5bm2XHJcbiAgICAgKiBAcGFyYW0gYmluZGluZ1BhdGgg57uR5a6a6Lev5b6EXHJcbiAgICAgKiBAcGFyYW0gbWVyZ2Ug5ZCI5bm25Ye95pWwXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBtZXJnZUNvbmRpdGlvbihiaW5kaW5nUGF0aDogc3RyaW5nLCBtZXJnZTogKGNvbmRpdGlvbnM6IGFueSkgPT4gYW55KSB7XHJcbiAgICAgICAgY29uc3QgY29uZGl0aW9ucyA9IHRoaXMuZmlsdGVycy5nZXQoYmluZGluZ1BhdGgpIHx8IFtdO1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IG1lcmdlKGNvbmRpdGlvbnMpO1xyXG4gICAgICAgIHRoaXMuZmlsdGVycy5zZXQoYmluZGluZ1BhdGgsIHJlc3VsdCk7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIOWinuWKoOi/h+a7pOadoeS7tlxyXG4gICAgICogQHBhcmFtIGJpbmRpbmdQYXRoIOe7keWumui3r+W+hFxyXG4gICAgICogQHBhcmFtIGNvbmRpdGlvbiDov4fmu6TmnaHku7ZcclxuICAgICAqL1xyXG4gICAgcHVibGljIGFkZENvbmRpdGlvbihiaW5kaW5nUGF0aDogc3RyaW5nLCBjb25kaXRpb246IGFueSkge1xyXG4gICAgICAgIC8vIOmAmui/h2JpbmRpbmdQYXRo6I635Y+W5a+55bqU55qE6L+H5ruk5p2h5Lu2XHJcbiAgICAgICAgY29uc3QgY29uZGl0aW9ucyA9IHRoaXMuZmlsdGVycy5nZXQoYmluZGluZ1BhdGgpO1xyXG4gICAgICAgIGNvbnN0IGluZGV4ID0gdGhpcy5maW5kQ29uZGl0aW9uSW5kZXgoYmluZGluZ1BhdGgsIGNvbmRpdGlvbik7XHJcbiAgICAgICAgaWYgKGluZGV4ICE9PSAtMSkge1xyXG4gICAgICAgICAgICBjb25kaXRpb25zW2luZGV4XSA9IGNvbmRpdGlvbjtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBjb25kaXRpb25zLnB1c2goY29uZGl0aW9uKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIOaJuemHj+WinuWKoOi/h+a7pOadoeS7tlxyXG4gICAgICogQHBhcmFtIGJpbmRpbmdQYXRoIOe7keWumui3r+W+hFxyXG4gICAgICogQHBhcmFtIGNvbmRpdGlvbnMg6L+H5ruk5p2h5Lu25pWw57uEXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBhZGRDb25kaXRpb25zKGJpbmRpbmdQYXRoOiBzdHJpbmcsIGNvbmRpdGlvbnM6IEFycmF5PGFueT4pIHtcclxuICAgICAgICBpZiAoIWNvbmRpdGlvbnMgfHwgIUFycmF5LmlzQXJyYXkoY29uZGl0aW9ucykgfHwgY29uZGl0aW9ucy5sZW5ndGggPCAxKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uZGl0aW9ucy5mb3JFYWNoKGNvbmRpdGlvbiA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuYWRkQ29uZGl0aW9uKGJpbmRpbmdQYXRoLCBjb25kaXRpb24pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiDliKDpmaTov4fmu6TmnaHku7ZcclxuICAgICAqIEBwYXJhbSBiaW5kaW5nUGF0aCDnu5Hlrprot6/lvoRcclxuICAgICAqIEBwYXJhbSBwcmVkaWNhdGUg5p2h5Lu26KGo6L6+5byPXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyByZW1vdmVDb25kaXRpb24oYmluZGluZ1BhdGg6IHN0cmluZywgcHJlZGljYXRlOiAodmFsdWU6IGFueSwgaW5kZXg6IG51bWJlciwgYXJyYXk6IGFueVtdKSA9PiBib29sZWFuKSB7XHJcbiAgICAgICAgY29uc3QgY29uZGl0aW9uczogQXJyYXk8eyBbcHJvcE5hbWU6IHN0cmluZ106IGFueSB9PiA9IHRoaXMuZmlsdGVycy5nZXQoYmluZGluZ1BhdGgpO1xyXG4gICAgICAgIGlmICghY29uZGl0aW9ucyB8fCBjb25kaXRpb25zLmxlbmd0aCA8IDEpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCByZW1vdmVzID0gY29uZGl0aW9ucy5maWx0ZXIocHJlZGljYXRlKTtcclxuICAgICAgICBpZiAocmVtb3Zlcykge1xyXG4gICAgICAgICAgICByZW1vdmVzLmZvckVhY2goY29uZGl0aW9uID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGluZGV4ID0gdGhpcy5maW5kQ29uZGl0aW9uSW5kZXgoYmluZGluZ1BhdGgsIGNvbmRpdGlvbik7XHJcbiAgICAgICAgICAgICAgICBpZiAoaW5kZXggPj0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbmRpdGlvbnMuc3BsaWNlKGluZGV4LCAxKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiDmuIXnqbrov4fmu6TmnaHku7ZcclxuICAgICAqL1xyXG4gICAgcHVibGljIGNsZWFyKCkge1xyXG4gICAgICAgIHRoaXMuZmlsdGVycy5jbGVhcigpO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiDorr7nva7ov4fmu6TmnaHku7bmlbDnu4RcclxuICAgICAqIEBwYXJhbSBiaW5kaW5nUGF0aCDnu5Hlrprot6/lvoRcclxuICAgICAqIEBwYXJhbSBjb25kaXRpb25zIOi/h+a7pOadoeS7tuaVsOe7hFxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgc2V0Q29uZGl0aW9ucyhiaW5kaW5nUGF0aDogc3RyaW5nLCBjb25kaXRpb25zOiBBcnJheTxhbnk+KSB7XHJcbiAgICAgICAgdGhpcy5maWx0ZXJzLnNldChiaW5kaW5nUGF0aCwgY29uZGl0aW9ucyk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDmn6Xmib7ov4fmu6TmnaHku7bntKLlvJVcclxuICAgICAqIEBwYXJhbSBiaW5kaW5nUGF0aCDnu5Hlrprot6/lvoRcclxuICAgICAqIEBwYXJhbSBjb25kaXRpb24g6L+H5ruk5p2h5Lu2XHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgZmluZENvbmRpdGlvbkluZGV4KGJpbmRpbmdQYXRoOiBzdHJpbmcsIGNvbmRpdGlvbjogYW55KSB7XHJcbiAgICAgICAgaWYgKCFjb25kaXRpb24gfHwgdHlwZW9mIChjb25kaXRpb24pICE9PSAnb2JqZWN0JyB8fCBPYmplY3Qua2V5cyhjb25kaXRpb24pLmxlbmd0aCA8IDEpIHtcclxuICAgICAgICAgICAgcmV0dXJuIC0xO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCBjb25kaXRpb25zOiBBcnJheTxhbnk+ID0gdGhpcy5maWx0ZXJzLmdldChiaW5kaW5nUGF0aCk7XHJcbiAgICAgICAgaWYgKCFjb25kaXRpb25zIHx8IGNvbmRpdGlvbnMubGVuZ3RoIDwgMSkge1xyXG4gICAgICAgICAgICByZXR1cm4gLTE7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBjb25kaXRpb25zLmZpbmRJbmRleCgodmFsdWUsIGluZGV4KSA9PiB7XHJcbiAgICAgICAgICAgIGxldCBpc0VxdWFsID0gdHJ1ZTtcclxuICAgICAgICAgICAgY29uc3QgcHJvcHMgPSBPYmplY3Qua2V5cyhjb25kaXRpb24pO1xyXG4gICAgICAgICAgICBmb3IgKGNvbnN0IHByb3Agb2YgcHJvcHMpIHtcclxuICAgICAgICAgICAgICAgIGlmICghKHZhbHVlICYmIHZhbHVlLmhhc093blByb3BlcnR5KHByb3ApICYmIHZhbHVlW3Byb3BdID09PSBjb25kaXRpb25bcHJvcF0pKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaXNFcXVhbCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBpc0VxdWFsO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG59XHJcbiJdfQ==