{"version":3,"sources":["ng://@farris/ui-search-box/lib/search-box.service.ts","node_modules/tslib/tslib.es6.js","ng://@farris/ui-search-box/lib/search-box.locale.ts","ng://@farris/ui-search-box/lib/search-box-base.ts","ng://@farris/ui-search-box/lib/search-box.component.ts","ng://@farris/ui-search-box/lib/search-fields/search-field-panel.component.ts","ng://@farris/ui-search-box/lib/search-fields/search-fields.component.ts","ng://@farris/ui-search-box/lib/search-fields/search-filed.directive.ts","ng://@farris/ui-search-box/lib/search-panel/search-panel.component.ts","ng://@farris/ui-search-box/lib/search-panel/search-panel.directive.ts","ng://@farris/ui-search-box/lib/search-panel/search-words.pipe.ts","ng://@farris/ui-search-box/lib/search-fields/editors/date/flexible-date.component.ts","ng://@farris/ui-search-box/lib/search-fields/editors/number/flexible-number.component.ts","ng://@farris/ui-search-box/lib/search-fields/editors/enum/search-editor-enum.component.ts","ng://@farris/ui-search-box/lib/search-fields/editors/boolean/search-editor-boolean.component.ts","ng://@farris/ui-search-box/lib/search-fields/can-clear-condition.pipe.ts","ng://@farris/ui-search-box/lib/search-box.module.ts"],"names":["SearchBoxService","Injectable","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__extends","__","this","constructor","prototype","create","__assign","assign","t","s","i","n","arguments","length","call","apply","SEARCH_BOX_LOCALE","en","searchbox","enterKeywords","tips","contain","clear","cancel","ok","removeFilter","anyFields","relation","and","or","zh-CHS","zh-CHT","SearchBoxBase","ElementRef","Injector","OverLayHiddenService","decorators","type","Optional","ChangeDetectorRef","el","injector","overLayService","cd","commonUtils","render","get","Renderer2","localeSer","LocaleService","CommonUtils","setLocaleData","_super","SEARCH_BOX_VALUE_ACCESSOR","provide","NG_VALUE_ACCESSOR","useExisting","forwardRef","SearchBoxComponent","multi","tslib_1.__extends","ngOnInit","ngAfterViewInit","_this","setTimeout","moveShadowToBody","ngOnChanges","changes","ngOnDestroy","destory","shadowBox","nativeElement","remove","clearTimeout","onBlur","$event","enableFloat","input2","value","toggleShadowBox","onInputClick","filterChanged","conditions","filterConditions","filter","code","map","trim","indexOf","searchKeys_1","from","Set","split","j","filterField","lbracket","rbracket","compare","_conditions","expandStarFieldToAllFields","concat","flatten","onModelChange","onModelTouched","conditionChange","emit","item","find","searchKeys","fields","FilterRelation","Or","Compare","Like","initDislayText","relationStr","getValue","displayTextList","values","dislayText","name","join","displayHtml","setHiddenCount","detectChanges","select","searchData","condition","push","input","field","_emitFilterChanged","onRemoveItem","stopPropagation","clearConditions","onSubmit","writeValue","obj","arr","isArray","registerOnChange","fn","registerOnTouched","setValue","updateShadowBoxPosition","_a","_b","top","left","width","e","getBoundingClientRect","setStyle","getFloatingLayerIndex","document","body","append","registerMouseEvent","target","className","textbox","contains","show","useAnyField","removeStyle","container","style","visibility","focus","onShadowBoxClick","onResized","len","items","querySelectorAll","offsetTop","hiddenItemsCount$","next","onEsc","escHandler","Component","args","selector","template","encapsulation","ViewEncapsulation","None","providers","Input","ViewChild","Output","maxSearchFields","EventEmitter","BehaviorSubject","SearchFieldPanelComponent","onSearchValueChange","onSubmitCondition","fieldOptions","single","begin","end","filterChange","onRemoveSearchField","injecotr","elRef","SearchFieldsComponent","defineProperty","hasFilter","showShadowBox","closest","hideShadowbox","undefined","control","controltype","And","GreaterOrEqual","dateHelp","formatTo","addDays","Date","dateFormat","Less","Equal","In","LessOrEqual","Empty","setConditions","val","enumValues","setMoreStatus","searchField","forEach","clientHeight","addClass","removeClass","r","tagContainerRef","moreStatus$","DateTimeHelperService","Subject","SearchFieldDirective","searchFieldsRef","subscribe","removeFieldPanel","winResizeHandle","listen","window","onMouseDown","onFieldClick","panelElement","createFieldPanel","docKeydownEventHandle","registerKeyboardEvent","enterFn","regBodyKeydownEvent","createElement","classList","add","zindex","zIndex","appendChild","setPanelPosition","_fieldPanelIns","cfr","resolveComponentFactory","_applicationRef","attachView","hostView","instance","location","pipe","debounceTime","changeDetectorRef","nodeName","btnok","btnSubmit","disabled","click","updateTopPosition","getPanelSize","top_1","height","getInputSizeInfo","bottom","innerHeight","panelHeight","h","transformOrigin","parseInt","innerWidth","Directive","NgZone","ComponentFactoryResolver","ApplicationRef","HostListener","ngzone","SearchPanelComponent","onClick","loadData","cdr","onFieldItemClick","preventDefault","itemClick","data","evnet","setActiveItem","index","activeIndex","searchKeyWord","onClosePanel","closepanel","mouseDown","maxItems","SearchPanelDirective","inputRef","inputClick","valueChange","createDataPanel","searchPanelRef","hide","searchBoxRef","removePanelElement","removeChild","destroy","reqAnimFrame","maxWidth","minWidth","minPanelWidth","maxHeight","overflow","cmpFact","anyfieldsName","splice","selectItem","maxPanelItems","newHeight","itemsContainer","querySelector","offsetHeight","calculationPanelHeight","_width","Math","floor","rows","idx","prevIdx","nextIdx","removeItem","key","InputGroupComponent","maxFields","SearchWordPipe","transform","_i","relationStr_1","arr_1","Pipe","SearchFieldFlexibleDateComponent","dateTags","id","text","localeService","dayTags","showTime","showType","beginValue","endValue","itemDateFormat","onDateChange","beginValueChange","endValueChange","onSingleChange","clickTag","tag","tagDate","activedDateTagId","getLastNumMonth","clickDayTag","activedDayTagId","dayTag","getToday","num","showtime","now","year","getFullYear","month","getMonth","day","getDate","dateObj","time","getHours","getMinutes","getSeconds","endMonth","endDay","dYear","dMouth","dDay","lastMonthDay","nowMonthDay","subDays","placeholder","endPlaceHolder","beginPlaceHolder","SearchFieldFlexibleNumberComponent","bigNumber","precision","min","max","onSingleValueChange","onValueChange","onBeginValueChange","onEndValueChange","SearchFieldEnumEditorComponent","_item","cloneDeep","getDataSource","checkValue","checkedAll","setSubmitChange","checkboxList","checkboxDataSource","element","onSearch","event","checkboxValue","getValueText","enumValue","texts","enums","valueText","keys","onCheckAll","setCheckedAll","boolcheck","SearchFieldEditorBooleanComponent","radioDataSource","selectedValue","_radioElements","radioEl","checked","onRadioClicked","radioInputRel","clearChecked","SearchFieldCanClearPipe","canClear","isNil","SearchBoxModule","NgModule","declarations","imports","CommonModule","FormsModule","FarrisCommonModule","forRoot","InputGroupModule","LocaleModule","FarrisDatePickerModule","SwitchModule","NumberSpinnerModule","FarrisFormsModule","DateHelperModule","entryComponents","exports"],"mappings":"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","sourcesContent":["import { Injectable } from '@angular/core';\r\n\r\n@Injectable()\r\nexport class SearchBoxService {\r\n\r\n  constructor() { }\r\n}\r\n","/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport function __exportStar(m, exports) {\r\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\n\r\nexport function __values(o) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator], i = 0;\r\n    if (m) return m.call(o);\r\n    return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n    result.default = mod;\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n","/**  */\r\nexport const SEARCH_BOX_LOCALE = {\r\n    en: {\r\n        'searchbox': {\r\n            enterKeywords: 'Please enter keywords',\r\n            tips: 'Space can be used to represent \"or\" in input, and enter to search.',\r\n            contain: 'contain',\r\n            clear: 'Clear all conditions.',\r\n            cancel: 'Cancel',\r\n            ok: 'Ok',\r\n            removeFilter: 'Delete Condition',\r\n            anyFields: 'All',\r\n            relation: {\r\n                and: 'AND',\r\n                or: 'OR'\r\n            }\r\n        }\r\n    },\r\n    'zh-CHS': {\r\n        'searchbox': {\r\n            enterKeywords: '',\r\n            tips: '',\r\n            contain: '',\r\n            clear: '',\r\n            cancel: '',\r\n            ok: '',\r\n            removeFilter: '',\r\n            anyFields: '',\r\n            relation: {\r\n                and: '',\r\n                or: ''\r\n            }\r\n        }\r\n    },\r\n    'zh-CHT': {\r\n        searchbox: {\r\n            enterKeywords: '',\r\n            tips: '',\r\n            contain: '',\r\n            clear: '',\r\n            cancel: '',\r\n            ok: '',\r\n            removeFilter: '',\r\n            anyFields: '',\r\n            relation: {\r\n                and: '',\r\n                or: ''\r\n            }\r\n        }\r\n    }\r\n}","import { ChangeDetectorRef, Directive, ElementRef, Injector, Optional, Renderer2 } from '@angular/core';\r\nimport { CommonUtils, OverLayHiddenService } from '@farris/ui-common';\r\nimport { LocaleService } from '@farris/ui-locale';\r\nimport { SEARCH_BOX_LOCALE } from './search-box.locale';\r\n\r\nexport class SearchBoxBase {\r\n\r\n    public commonUtils: CommonUtils = null;\r\n    public render: Renderer2;\r\n    public localeSer: LocaleService\r\n    constructor(public el: ElementRef, protected injector: Injector, @Optional() public overLayService: OverLayHiddenService, protected cd: ChangeDetectorRef) {\r\n        this.render = this.injector.get(Renderer2);\r\n\r\n        if (!overLayService) {\r\n            this.overLayService = new OverLayHiddenService();\r\n        }\r\n        this.localeSer = this.injector.get(LocaleService, null);\r\n        this.commonUtils = this.injector.get(CommonUtils, null);\r\n        \r\n        if (this.localeSer) {\r\n            this.localeSer.setLocaleData(SEARCH_BOX_LOCALE);\r\n        }\r\n    }\r\n\r\n    \r\n}","import { AfterViewInit, ChangeDetectorRef, Component, ElementRef, EventEmitter, forwardRef, HostBinding, HostListener, Injector, Input, OnChanges, OnDestroy, OnInit, Optional, Output, Renderer2, SimpleChanges, ViewChild, ViewEncapsulation } from \"@angular/core\";\r\nimport { CommonUtils, OverLayHiddenService } from \"@farris/ui-common\";\r\nimport { InputGroupComponent } from \"@farris/ui-input-group\";\r\nimport { Compare, FilterCondition, FilterRelation } from \"@farris/ui-common/types\";\r\nimport { DisplayText, SearchField, SearchFieldValue } from \"./search-box.types\";\r\nimport { flatten } from 'lodash-es';\r\nimport { ControlValueAccessor, NG_VALUE_ACCESSOR } from \"@angular/forms\";\r\nimport { BehaviorSubject, of } from \"rxjs\";\r\nimport { SearchBoxBase } from \"./search-box-base\";\r\n\r\n\r\nexport const SEARCH_BOX_VALUE_ACCESSOR: any = {\r\n    provide: NG_VALUE_ACCESSOR,\r\n    useExisting: forwardRef(() => SearchBoxComponent),\r\n    multi: true\r\n};\r\n@Component({\r\n    selector: \"farris-search-box\",\r\n    templateUrl: './search-box.component.html',\r\n    encapsulation: ViewEncapsulation.None,\r\n    providers: [\r\n        SEARCH_BOX_VALUE_ACCESSOR\r\n    ]\r\n})\r\nexport class SearchBoxComponent extends SearchBoxBase implements OnInit, OnChanges, ControlValueAccessor, AfterViewInit, OnDestroy {\r\n\r\n    @Input() fields: Array<SearchField> = [];\r\n    @Input() maxSearchFields = 5;\r\n    @Input() condition: Array<FilterCondition> = [];\r\n\r\n    /**   */\r\n    @Input() useAnyField = true;\r\n    \r\n\r\n    @ViewChild('searchbox') container: ElementRef;\r\n    @ViewChild('tagInput') input: InputGroupComponent;\r\n\r\n\r\n    @ViewChild('searchbox2') shadowBox: ElementRef;\r\n    @ViewChild('tagInput2') input2: InputGroupComponent;\r\n\r\n\r\n    @Output() conditionChange = new EventEmitter();\r\n    @Output() clear = new EventEmitter();\r\n    @Output() escHandler = new EventEmitter();\r\n    /** false:  true26px */\r\n    enableFloat = true;\r\n\r\n    displayTextList: Array<DisplayText> = [];\r\n    filterConditions: Array<SearchFieldValue> = [];\r\n\r\n    hiddenItemsCount$ = new BehaviorSubject(0);\r\n\r\n    constructor(el: ElementRef, injector: Injector, @Optional() overLayService: OverLayHiddenService, cd: ChangeDetectorRef) {\r\n       super(el, injector, overLayService, cd);\r\n    }\r\n\r\n    ngOnInit() {\r\n    }\r\n\r\n    ngAfterViewInit(): void {\r\n        setTimeout(() => {\r\n            this.moveShadowToBody();\r\n        });\r\n\r\n    }\r\n\r\n    ngOnChanges(changes: SimpleChanges) {\r\n    }\r\n\r\n    ngOnDestroy() {\r\n        if (this.overLayService) {\r\n            this.overLayService.destory(this.shadowBox.nativeElement);\r\n            this.overLayService = null;\r\n        }\r\n\r\n        if (this.shadowBox) {\r\n            this.shadowBox.nativeElement.remove();\r\n        }\r\n\r\n        if (this['REMOVE_ITEM_TIMER']) {\r\n            clearTimeout(this['REMOVE_ITEM_TIMER']);\r\n            this['REMOVE_ITEM_TIMER'] = null;\r\n        }\r\n    }\r\n\r\n    onBlur($event) {\r\n        if (this.enableFloat) {\r\n            if (!this.input2.value) {\r\n                this.toggleShadowBox(false);\r\n            }\r\n        }\r\n    }\r\n\r\n    onInputClick($event) {\r\n        if (this.enableFloat) {\r\n            this.toggleShadowBox();\r\n        }\r\n    }\r\n\r\n\r\n    onModelChange = (arr: any) => { };\r\n    onModelTouched = (arr: any) => { };\r\n\r\n    private filterChanged() {\r\n        const conditions = this.filterConditions.filter(n => n.code !== '*').map(\r\n            (n, i) => {\r\n                if (n.value.trim().indexOf(' ') > -1) {\r\n                    const searchKeys = Array.from(new Set(n.value.trim().split(' ').filter(n => n.trim())));\r\n                    return searchKeys.map((s, j) => {\r\n                        return {\r\n                            filterField: n.code,\r\n                            value: s,\r\n                            lbracket: j == 0? '(':  '',\r\n                            rbracket: j == searchKeys.length - 1 ? ')' : '',\r\n                            relation: j == searchKeys.length - 1 ? 1 : 2,\r\n                            compare: 6,\r\n                        }\r\n                    });\r\n                }\r\n                return {\r\n                    filterField: n.code,\r\n                    value: n.value,\r\n                    lbracket: '',\r\n                    rbracket: '',\r\n                    relation: i == this.filterConditions.length -1 ? 0 : 1,\r\n                    compare: 6,\r\n                }\r\n            }\r\n        );\r\n\r\n        let _conditions = [];\r\n        _conditions = this.expandStarFieldToAllFields().concat(flatten(conditions));\r\n        if (conditions && conditions.length) {\r\n            _conditions[_conditions.length - 1].relation = 0;\r\n        }\r\n        this.onModelChange(this.filterConditions);\r\n        this.onModelTouched(this.filterConditions);\r\n\r\n\r\n        if (!_conditions.length) {\r\n            this.conditionChange.emit(this.filterConditions);\r\n        } else {\r\n            this.conditionChange.emit(_conditions);\r\n        }\r\n    }\r\n\r\n    expandStarFieldToAllFields() {\r\n        const item = this.filterConditions.find(n => n.code === '*');\r\n        if (!item) {\r\n            return [];\r\n        }\r\n        const searchKeys = Array.from(new Set(item.value.trim().split(' ').filter(n => n.trim())));\r\n        const conditions = this.fields.filter(n => n.code !== '*').map((n: SearchField, i) => {\r\n            return searchKeys.map((s, j) => {\r\n                return {\r\n                    filterField: n.code,\r\n                    value: s,\r\n                    lbracket: '',\r\n                    rbracket: '',\r\n                    relation: FilterRelation.Or,\r\n                    compare: Compare.Like,\r\n                }\r\n            });\r\n        });\r\n\r\n        let _conditions = [];\r\n        if (conditions && conditions.length) {\r\n            _conditions = flatten(conditions)\r\n            _conditions[0].lbracket = '('\r\n            _conditions[_conditions.length - 1].rbracket = ')'\r\n            _conditions[_conditions.length - 1].relation = this.filterConditions.filter(n => n.code !=='*').length ? 1 : 0;\r\n        }\r\n\r\n        return _conditions;\r\n    }\r\n\r\n    private initDislayText(emit = true) {\r\n        const relationStr = this.localeSer.getValue('searchbox.relation.or');\r\n        this.displayTextList = this.filterConditions.map((t: any) => {\r\n            const n = {...t};\r\n            // .map(n => `${n}`)\r\n            const values =  n.value.trim().split(' ').filter(n => n.trim());\r\n            n.dislayText = n.name + '' + values.join(` ${ relationStr } `);\r\n            n.displayHtml = n.name + '' + values.join(`<span class=\"text-muted font-italic mx-1 or\">${relationStr}</span>`);\r\n            return n;\r\n        });\r\n\r\n        setTimeout(() => {\r\n            if (this.enableFloat) {\r\n                this.setHiddenCount();\r\n            }\r\n        });\r\n        this.cd.detectChanges();\r\n        if (emit) {\r\n            this.filterChanged();\r\n        }\r\n    }\r\n\r\n    select(searchData: any) {\r\n        const condition = this.filterConditions.find(n => n.code === searchData.code);\r\n        if (condition) {\r\n            condition.value = condition.value.trim() + ' ' + searchData.value;\r\n        } else {\r\n            this.filterConditions.push(searchData);\r\n        }\r\n        this.initDislayText();\r\n\r\n        this.input.value = '';\r\n    }\r\n\r\n    remove(field: string) {\r\n        this.filterConditions = this.filterConditions.filter(n => n.code !== field)\r\n        this.initDislayText(false);\r\n\r\n        this._emitFilterChanged();\r\n    }\r\n\r\n    private _emitFilterChanged() {\r\n        if (this['REMOVE_ITEM_TIMER']) {\r\n            clearTimeout(this['REMOVE_ITEM_TIMER']);\r\n        }\r\n\r\n        this['REMOVE_ITEM_TIMER'] = setTimeout(() => {\r\n            this.filterChanged();\r\n        }, 180);\r\n    }\r\n\r\n    onRemoveItem($event, item) {\r\n        $event.stopPropagation();\r\n        this.filterConditions = this.filterConditions.filter(n => n.code !== item.code);\r\n        this.initDislayText();\r\n        \r\n    }\r\n\r\n    clearConditions(emit = true) {\r\n        this.input.value = '';\r\n        this.displayTextList = [];\r\n        this.filterConditions = [];\r\n        this.setHiddenCount();\r\n        if (emit) {\r\n            this.conditionChange.emit([]);\r\n            this.clear.emit();\r\n        }\r\n    }\r\n\r\n    onSubmit($event) {\r\n        $event.stopPropagation();\r\n        this.input.value = '';\r\n        this.toggleShadowBox(false);\r\n        this._emitFilterChanged();\r\n    }\r\n\r\n    writeValue(obj: any): void {\r\n        let arr = obj;\r\n        if (!Array.isArray(obj)) {\r\n            arr = [];\r\n        }\r\n\r\n        this.filterConditions = arr;\r\n        this.initDislayText();\r\n    }\r\n\r\n    registerOnChange(fn: any): void {\r\n        this.onModelChange = fn;\r\n    }\r\n\r\n    registerOnTouched(fn: any): void {\r\n        this.onModelTouched = fn;\r\n    }\r\n\r\n    setValue(arr: Array<SearchFieldValue>, emit = true) {\r\n        this.filterConditions = arr;\r\n        this.initDislayText(emit);\r\n    }\r\n\r\n    updateShadowBoxPosition({top, left, width} = {top: null, left: null, width: null}) {\r\n        if (!top && !left && !width) {\r\n            const e = this.el.nativeElement.getBoundingClientRect();\r\n            top = e.top;\r\n            left = e.left;\r\n            width = e.width;\r\n        }\r\n        this.render.setStyle(this.shadowBox.nativeElement, 'left', left + 'px');\r\n        this.render.setStyle(this.shadowBox.nativeElement, 'top', top + 'px');\r\n        this.render.setStyle(this.shadowBox.nativeElement, 'width', width + 'px');\r\n\r\n        this.render.setStyle(this.shadowBox.nativeElement, 'zIndex', this.commonUtils.getFloatingLayerIndex());\r\n    }\r\n\r\n    private moveShadowToBody() {\r\n        if (!this.enableFloat) {\r\n            return;\r\n        }\r\n        this.updateShadowBoxPosition();\r\n        document.body.append(this.shadowBox.nativeElement);\r\n\r\n        this.overLayService.registerMouseEvent(this.shadowBox.nativeElement, (e) => {\r\n            if (e.target && e.target.className.indexOf('search-box_delete-keys') > -1) {\r\n                return;\r\n            }\r\n\r\n            if (e.target === this.input2.textbox.nativeElement || !this.shadowBox || this.shadowBox.nativeElement.contains(e.target) || \r\n            e.target['closest']('.f-search-box-panel')) {\r\n                return;\r\n            }\r\n\r\n            this.toggleShadowBox(false);\r\n        });\r\n\r\n    }\r\n\r\n    toggleShadowBox(show = true) {\r\n        if (!this.enableFloat || ((!this.fields || !this.fields.length) && !this.useAnyField)) {\r\n            return;\r\n        }\r\n        if (show) {\r\n            this.updateShadowBoxPosition();\r\n            this.render.removeStyle(this.shadowBox.nativeElement, 'display');\r\n            this.container.nativeElement.style.visibility = 'hidden';\r\n            this.input2.focus();\r\n        } else {\r\n            this.container.nativeElement.style.visibility = 'visible';\r\n            this.render.setStyle(this.shadowBox.nativeElement, 'display', 'none');\r\n        }\r\n    }\r\n\r\n    onShadowBoxClick($event: MouseEvent) {\r\n        $event.stopPropagation();\r\n        if (this.enableFloat) {\r\n            this.input2.focus();\r\n        }\r\n    }\r\n\r\n    onResized($event) {\r\n        if (this.enableFloat) {\r\n            this.updateShadowBoxPosition($event);\r\n            setTimeout(() => {\r\n                this.setHiddenCount();\r\n                this.cd.detectChanges();\r\n            });\r\n        }\r\n    }\r\n\r\n    private setHiddenCount() {\r\n        let len = 0;\r\n        if (!this.displayTextList || !this.displayTextList.length) {\r\n            this.hiddenItemsCount$.next(len);\r\n            return;\r\n        }\r\n        const items = Array.from(this.container.nativeElement.querySelectorAll('span.search-tag-item'));\r\n        if (items && items.length) {\r\n            len = items.map((n: any) => {\r\n                return n.offsetTop;\r\n            }).filter(n => n > 20).length\r\n        }\r\n        this.hiddenItemsCount$.next(len);\r\n    }\r\n\r\n    onEsc($event) {\r\n        this.escHandler.emit($event);\r\n    }\r\n}\r\n","import { ChangeDetectorRef, Component, ElementRef, EventEmitter, HostListener, Injector, Input, OnInit, Output, ViewChild } from '@angular/core';\r\n\r\n@Component({\r\n    selector: 'farris-search-field-panel',\r\n    templateUrl: './search-field-panel.component.html'\r\n})\r\n\r\nexport class SearchFieldPanelComponent implements OnInit {\r\n\r\n    @Input() fieldOptions;\r\n\r\n    @ViewChild('btnSubmit') btnSubmit: ElementRef;\r\n\r\n    @Output() filterChange = new EventEmitter();\r\n    @Output() remove = new EventEmitter();\r\n\r\n    conditions = null;\r\n    elRef: ElementRef;\r\n    constructor(private injecotr: Injector, private cd: ChangeDetectorRef) {\r\n        this.elRef = this.injecotr.get(ElementRef, null);\r\n    }\r\n\r\n    ngOnInit() { }\r\n\r\n    onSearchValueChange($event) {\r\n        this.conditions = $event;\r\n        this.cd.detectChanges();\r\n    }\r\n\r\n    onSubmitCondition($event) {\r\n        this.fieldOptions.value = this.conditions.value;\r\n        if (!this.fieldOptions.value.single) {\r\n            this.fieldOptions.value.value = null;\r\n        } else {\r\n            delete this.fieldOptions.value.begin;\r\n            delete this.fieldOptions.value.end;\r\n        }\r\n        this.filterChange.emit(this.conditions);\r\n    }\r\n\r\n    onRemoveSearchField($event: MouseEvent) {\r\n        this.remove.emit(this.fieldOptions);\r\n    }\r\n}","import { AfterViewInit, ChangeDetectorRef, Component, ElementRef, EventEmitter, forwardRef, HostBinding, HostListener, \r\n    Injector, Input, OnChanges, OnDestroy, OnInit, Optional, Output, Renderer2, SimpleChanges, ViewChild, ViewEncapsulation } from \"@angular/core\";\r\nimport { OverLayHiddenService } from \"@farris/ui-common\";\r\nimport { Compare, FilterCondition, FilterRelation } from \"@farris/ui-common/types\";\r\nimport { DisplayText, SearchField, SearchFieldValue } from \"../search-box.types\";\r\nimport { flatten } from 'lodash-es';\r\nimport { ControlValueAccessor, NG_VALUE_ACCESSOR } from \"@angular/forms\";\r\nimport { BehaviorSubject, of, Subject } from \"rxjs\";\r\nimport { SearchBoxBase } from \"../search-box-base\";\r\nimport { DateTimeHelperService } from \"@farris/ui-common/date\";\r\n\r\nexport const SEARCH_BOX_VALUE_ACCESSOR: any = {\r\n    provide: NG_VALUE_ACCESSOR,\r\n    useExisting: forwardRef(() => SearchFieldsComponent),\r\n    multi: true\r\n};\r\n\r\n@Component({\r\n    selector: 'farris-search-fields',\r\n    templateUrl: 'search-fields.component.html',\r\n    // styleUrls: [\r\n    //     `../searchbox-panel.scss`\r\n    // ],\r\n    encapsulation: ViewEncapsulation.None,\r\n    providers: [\r\n        SEARCH_BOX_VALUE_ACCESSOR\r\n    ]\r\n})\r\nexport class SearchFieldsComponent extends SearchBoxBase implements OnInit, OnChanges, ControlValueAccessor, AfterViewInit, OnDestroy {\r\n    @Input() fields: Array<SearchFieldValue> = [];\r\n    @Input() maxSearchFields = 5;\r\n    @Input() condition: Array<FilterCondition> = [];\r\n    /**  */\r\n    @Input() multi = true;\r\n    \r\n    @ViewChild('searchbox') container: ElementRef;\r\n    @ViewChild('searchbox2') shadowBox: ElementRef;\r\n    @ViewChild('tagContainer') tagContainerRef: ElementRef;\r\n\r\n    @Output() conditionChange = new EventEmitter();\r\n    @Output() clear = new EventEmitter();\r\n    /** false:  true26px */\r\n    enableFloat = true;\r\n\r\n    displayTextList: Array<DisplayText> = [];\r\n    // filterConditions: Array<SearchFieldValue> = [];\r\n\r\n    moreStatus$ = new BehaviorSubject(false);\r\n\r\n    hideShadowbox = new Subject();\r\n\r\n    get hasFilter() {\r\n        return this.displayTextList && this.displayTextList.length ? this.displayTextList.filter((n: any) => n.hasFilter).length : false;\r\n    }\r\n\r\n    private showShadowBox = false;\r\n\r\n    constructor(el: ElementRef, injector: Injector, @Optional() overLayService: OverLayHiddenService, cd: ChangeDetectorRef, private dateHelp: DateTimeHelperService) {\r\n        super(el, injector, overLayService, cd);\r\n    }\r\n\r\n    ngOnInit() {\r\n\r\n        this.initDislayText(!!this.fields.filter((n: any) => n.value).length);\r\n\r\n        this.overLayService.registerMouseEvent(this.el.nativeElement, (e: any) => {\r\n            if (this.shadowBox && this.showShadowBox) {\r\n                if (this.shadowBox.nativeElement.contains(e.target)) {\r\n                    return;\r\n                }\r\n                if (e.target.closest('.f-search-field-container')) {\r\n                    return;\r\n                }\r\n\r\n                if (e.target.closest('.date-overlay-container') || e.target.className.indexOf('date-overlay-container') > -1) {\r\n                    return;\r\n                }\r\n\r\n                this.toggleShadowBox(false);\r\n                this.hideShadowbox.next(e);\r\n            }\r\n        });\r\n    }\r\n\r\n    ngAfterViewInit(): void {\r\n        setTimeout(() => {\r\n            this.moveShadowToBody();\r\n        });\r\n\r\n    }\r\n\r\n    ngOnChanges(changes: SimpleChanges) {\r\n       \r\n    }\r\n\r\n    ngOnDestroy() {\r\n        if (this.overLayService) {\r\n            this.overLayService = null;\r\n        }\r\n\r\n        if (this.shadowBox) {\r\n            this.shadowBox.nativeElement.remove();\r\n        }\r\n    }\r\n\r\n\r\n    onModelChange = (arr: any) => { };\r\n    onModelTouched = (arr: any) => { };\r\n\r\n    private filterChanged() {\r\n        const conditions = this.fields.filter((n: any) => n.value).map((n: any) => {\r\n            const { value, begin, end } = n.value;\r\n\r\n            if (value != null && value !== undefined && n.control.single) {\r\n                if (n.control.controltype === 'datetime') {\r\n                    return [{\r\n                        filterField: n.code,\r\n                        value,\r\n                        lbracket: '(',\r\n                        rbracket:  '',\r\n                        relation: FilterRelation.And,\r\n                        compare: Compare.GreaterOrEqual\r\n                    },\r\n                    {\r\n                        filterField: n.code,\r\n                        value: this.dateHelp.formatTo(this.dateHelp.addDays(new Date(value), 1), n.control.dateFormat),\r\n                        lbracket: '',\r\n                        rbracket:  ')',\r\n                        relation: FilterRelation.And,\r\n                        compare: Compare.Less\r\n                    }]\r\n                } else if (n.control.controltype === 'enum' && Array.isArray(value)) {\r\n                    return value.map((e, i) => {\r\n                        return {\r\n                            filterField: n.code,\r\n                            value: e,\r\n                            lbracket: i?'': '(',\r\n                            rbracket:  i == value.length -1 ? ')' : '',\r\n                            relation: i == value.length -1 ? FilterRelation.And: FilterRelation.Or,\r\n                            compare: Compare.Equal\r\n                        }\r\n                    });\r\n                }\r\n                return {\r\n                    filterField: n.code,\r\n                    value: Array.isArray(value) ? value.join(',') : value,\r\n                    lbracket: '',\r\n                    rbracket:  '',\r\n                    relation: FilterRelation.And,\r\n                    compare: Array.isArray(value) ?  Compare.In: Compare.Equal\r\n                }\r\n            } else {\r\n                if (begin !== '' && begin!=null && begin != undefined && end !=='' && end !=null && end != undefined) {\r\n                    return [\r\n                        {\r\n                            filterField: n.code,\r\n                            value: begin,\r\n                            lbracket: '(',\r\n                            rbracket:  '',\r\n                            relation: FilterRelation.And,\r\n                            compare: Compare.GreaterOrEqual\r\n                        },\r\n                        {\r\n                            filterField: n.code,\r\n                            value: end,\r\n                            lbracket: '',\r\n                            rbracket:  ')',\r\n                            relation: FilterRelation.And,\r\n                            compare: Compare.LessOrEqual\r\n                        }\r\n                    ]\r\n                } else {\r\n                    if (begin !== '' && begin!=null && begin != undefined) {\r\n                        return {\r\n                            filterField: n.code,\r\n                            value: begin,\r\n                            lbracket: '',\r\n                            rbracket:  '',\r\n                            relation: FilterRelation.And,\r\n                            compare: Compare.GreaterOrEqual\r\n                        }\r\n                    }\r\n\r\n                    if (end !=='' && end !=null && end != undefined) {\r\n                        return {\r\n                            filterField: n.code,\r\n                            value: end,\r\n                            lbracket: '',\r\n                            rbracket:  '',\r\n                            relation: FilterRelation.And,\r\n                            compare: Compare.LessOrEqual\r\n                        }\r\n                    }\r\n                }\r\n\r\n                return null;\r\n            }\r\n        }).filter(n => n);\r\n\r\n        let _conditions: Array<FilterCondition> = [];\r\n        if (conditions && conditions.length) {\r\n            _conditions = flatten(conditions)\r\n            _conditions[_conditions.length - 1].relation = FilterRelation.Empty;\r\n        }\r\n        this.onModelChange(this.fields);\r\n        this.onModelTouched(this.fields);\r\n        this.conditionChange.emit(_conditions);\r\n    }\r\n\r\n    setConditions(condition: any) {\r\n        const field: any = this.fields.find(n => n.code === condition.field);\r\n        field.value = condition.value;\r\n        field.control.single = condition.value.single;\r\n\r\n        this.initDislayText();\r\n        this.cd.detectChanges();\r\n    }\r\n\r\n\r\n    private initDislayText(emit = true) {\r\n        this.displayTextList = this.fields.map((t: any) => {\r\n            const n = {...t};\r\n            n.dislayText = n.name;\r\n            n.hasFilter = false;\r\n            if (n.value) {\r\n                const {value, begin, end} =  n.value;\r\n                let val = value;\r\n\r\n                if (t.control && t.control.enumValues && t.control.enumValues.length) {\r\n                    if (!Array.isArray(val)) {\r\n                        val = [val];\r\n                    }\r\n                    val = val.map(n => {\r\n                        const d = t.control.enumValues.find(e => e.value === n);\r\n                        if (d) {\r\n                            return d.name;\r\n                        }\r\n                        return n;\r\n                    }).join(',');\r\n                } else {\r\n                    if (begin !== null && begin !== undefined) {\r\n                        val = begin;\r\n                    }\r\n                    if (end !== null && end !== undefined) {\r\n                        if (val != null) {\r\n                            val += '~' + end;\r\n                        } else {\r\n                            val = end;\r\n                        }\r\n                    }\r\n                }\r\n                n.dislayText += '' + val;\r\n                n.hasFilter = true;\r\n            }\r\n            return n;\r\n        });\r\n\r\n        this.setMoreStatus();\r\n        \r\n        if (emit) {\r\n            this.filterChanged();\r\n        }\r\n    }\r\n\r\n    remove(field: string) {\r\n        const searchField = this.fields.find(n => n.code === field);\r\n        if (searchField) {\r\n            searchField.value = null;\r\n            this.initDislayText();\r\n        }\r\n    }\r\n\r\n\r\n\r\n    onRemoveItem($event, item) {\r\n        if (item.value!== null && item.value != undefined && item.value !== '') {\r\n            $event.stopPropagation();\r\n            this.remove(item.code);\r\n        }\r\n    }\r\n\r\n    clearConditions(emit = true) {\r\n        this.fields.forEach(n => n.value = null);\r\n        this.initDislayText(emit);\r\n        if (emit) {\r\n            this.clear.emit();\r\n        }\r\n        this.cd.detectChanges();\r\n    }\r\n\r\n    writeValue(obj: any): void {\r\n        let arr = obj;\r\n        if (!Array.isArray(obj)) {\r\n            arr = [];\r\n        }\r\n\r\n        this.fields = arr;\r\n        this.initDislayText();\r\n    }\r\n\r\n    registerOnChange(fn: any): void {\r\n        this.onModelChange = fn;\r\n    }\r\n\r\n    registerOnTouched(fn: any): void {\r\n        this.onModelTouched = fn;\r\n    }\r\n\r\n    setValue(arr: Array<SearchFieldValue>) {\r\n        // this.filterConditions = arr;\r\n        // this.initDislayText();\r\n    }\r\n\r\n    updateShadowBoxPosition({top, left, width} = {top: null, left: null, width: null}) {\r\n        if (!top && !left && !width) {\r\n            const e = this.el.nativeElement.getBoundingClientRect();\r\n            top = e.top;\r\n            left = e.left;\r\n            width = e.width;\r\n        }\r\n        this.render.setStyle(this.shadowBox.nativeElement, 'left', left + 'px');\r\n        this.render.setStyle(this.shadowBox.nativeElement, 'top', top + 'px');\r\n        this.render.setStyle(this.shadowBox.nativeElement, 'width', width + 'px');\r\n\r\n        this.render.setStyle(this.shadowBox.nativeElement, 'zIndex', this.commonUtils.getFloatingLayerIndex());\r\n    }\r\n\r\n    private moveShadowToBody() {\r\n        if (!this.enableFloat) {\r\n            return;\r\n        }\r\n\r\n        this.updateShadowBoxPosition()\r\n        document.body.append(this.shadowBox.nativeElement);\r\n    }\r\n\r\n    toggleShadowBox(show = true, el = null) {\r\n        if (!this.enableFloat) {\r\n            return;\r\n        }\r\n\r\n        if (el && el.clientHeight <= 30) {\r\n            return;\r\n        }\r\n\r\n        this.showShadowBox = show;\r\n        if (show) {\r\n            this.updateShadowBoxPosition();\r\n            this.render.removeStyle(this.shadowBox.nativeElement, 'display');\r\n            this.container.nativeElement.style.visibility = 'hidden';\r\n            this.render.addClass(this.shadowBox.nativeElement, 'active');\r\n        } else {\r\n            this.container.nativeElement.style.visibility = 'visible';\r\n            this.render.setStyle(this.shadowBox.nativeElement, 'display', 'none');\r\n            this.render.removeClass(this.shadowBox.nativeElement, 'active');\r\n        }\r\n    }\r\n\r\n\r\n    onResized($event) {\r\n        if (this.enableFloat) {\r\n            this.updateShadowBoxPosition($event);\r\n            this.setMoreStatus();\r\n        }\r\n    }\r\n\r\n    private setMoreStatus() {\r\n        if (this.enableFloat) {\r\n            setTimeout(() => {\r\n                const r = this.tagContainerRef.nativeElement.clientHeight > 30;\r\n                this.moreStatus$.next(r);\r\n                this.cd.detectChanges();\r\n            });\r\n        }\r\n    }\r\n}","import { AfterViewInit, ApplicationRef, ComponentFactoryResolver, Directive, ElementRef, HostListener, Injector, Input, NgZone, OnDestroy, OnInit, Renderer2 } from '@angular/core';\r\nimport { debounceTime } from 'rxjs/operators';\r\nimport { SearchFieldValue } from '../search-box.types';\r\nimport { SearchFieldPanelComponent } from './search-field-panel.component';\r\nimport { SearchFieldsComponent } from './search-fields.component';\r\nimport { CommonUtils } from '@farris/ui-common';\r\n\r\n@Directive({ selector: '[search-field]' })\r\nexport class SearchFieldDirective implements OnInit, AfterViewInit, OnDestroy {\r\n\r\n    @Input('search-field') field: SearchFieldValue;\r\n\r\n\r\n    private panelElement: HTMLElement;\r\n    private winResizeHandle = null;\r\n    private docKeydownEventHandle = null;\r\n    private commonUtils = null;\r\n\r\n    constructor(private injector: Injector, private elRef: ElementRef,\r\n        private ngzone: NgZone, private render: Renderer2, \r\n        private cfr: ComponentFactoryResolver, private searchFieldsRef: SearchFieldsComponent, private _applicationRef: ApplicationRef) {\r\n            this.commonUtils = this.injector.get(CommonUtils, new CommonUtils())\r\n        }\r\n\r\n\r\n    ngOnInit(): void {\r\n        if (this.searchFieldsRef) {\r\n            this.searchFieldsRef.hideShadowbox.subscribe((e: any) => {\r\n                this.removeFieldPanel();\r\n            });\r\n        }\r\n\r\n        this.winResizeHandle = this.render.listen(window, 'resize', () => {\r\n            this.removeFieldPanel();            \r\n        })\r\n    }\r\n\r\n    ngAfterViewInit(): void {\r\n        \r\n    }\r\n\r\n    ngOnDestroy(): void {\r\n        this.removeFieldPanel();\r\n\r\n        if (this.winResizeHandle) {\r\n            this.winResizeHandle();\r\n        }\r\n    }\r\n\r\n    @HostListener('mousedown', ['$event'])\r\n    onMouseDown($event: MouseEvent) {\r\n        $event.stopPropagation();\r\n    }\r\n\r\n    @HostListener('click', ['$event'])\r\n    onFieldClick($event: MouseEvent) {\r\n        $event.stopPropagation();\r\n        if (!this.panelElement) {\r\n            this.createFieldPanel();\r\n        } else {\r\n            this.removeFieldPanel();\r\n        }\r\n    }\r\n\r\n    private removeFieldPanel() {\r\n        if (this.panelElement) {\r\n            this.panelElement.remove();\r\n            this.panelElement = null;\r\n\r\n            this.searchFieldsRef.overLayService.destory(this.elRef.nativeElement);\r\n\r\n            this.render.removeClass(this.elRef.nativeElement, 'selected');\r\n        }\r\n\r\n        if (this.docKeydownEventHandle) {\r\n            this.docKeydownEventHandle();\r\n            this.docKeydownEventHandle = null;\r\n        }\r\n    }\r\n\r\n    private registerKeyboardEvent(enterFn?: () => void) {\r\n        if (this.commonUtils) {\r\n            return this.commonUtils.regBodyKeydownEvent(enterFn, () => {this.removeFieldPanel();});\r\n        }\r\n        return null;\r\n    }\r\n\r\n    private createFieldPanel() {\r\n        this.panelElement = document.createElement('div');\r\n        this.panelElement.classList.add('overlay-pane','f-filter-panel', 'f-area-hide', 'f-search-field-container');\r\n        const zindex  = '' + this.searchFieldsRef.commonUtils.getFloatingLayerIndex();\r\n        this.panelElement.style.zIndex = zindex;\r\n        \r\n        document.body.appendChild(this.panelElement);\r\n        this.setPanelPosition();\r\n\r\n        const fieldPanelRef = this.cfr.resolveComponentFactory(SearchFieldPanelComponent);\r\n        const _fieldPanelIns = fieldPanelRef.create(this.injector);\r\n        this._applicationRef.attachView(_fieldPanelIns.hostView);\r\n        \r\n        _fieldPanelIns.instance.fieldOptions = this.field;\r\n        _fieldPanelIns.instance.conditions = { field: this.field.code, value: this.field.value }\r\n\r\n        this.panelElement.appendChild(_fieldPanelIns.location.nativeElement);\r\n        this.panelElement.classList.add('f-area-show');\r\n\r\n        _fieldPanelIns.instance.filterChange.pipe(\r\n            debounceTime(100)\r\n        ).subscribe((e: any) => {\r\n            // \r\n            // console.log(e);\r\n            this.searchFieldsRef.setConditions(e);\r\n        })\r\n\r\n        _fieldPanelIns.instance.remove.subscribe(e => {\r\n            this.searchFieldsRef.remove(e.code);\r\n        });\r\n\r\n        _fieldPanelIns.changeDetectorRef.detectChanges();\r\n\r\n        this.searchFieldsRef.overLayService.registerMouseEvent(this.elRef.nativeElement, (e: any) => {\r\n            if (this.elRef.nativeElement.contains(e.target)) {\r\n                return;\r\n            }\r\n\r\n            if (e.target.closest('.f-search-field-container')) {\r\n                if (e.target.nodeName === 'BUTTON' && e.target.className.indexOf('close-field-panel') > -1) {\r\n                    this.removeFieldPanel();\r\n                }\r\n                return;\r\n            }\r\n\r\n            if (e.target.closest('.date-overlay-container') || e.target.className.indexOf('date-overlay-container') > -1) {\r\n                return;\r\n            }\r\n\r\n            this.removeFieldPanel();\r\n        });\r\n\r\n\r\n        this.render.addClass(this.elRef.nativeElement, 'selected');\r\n\r\n        //  ESCENTER\r\n        this.docKeydownEventHandle = this.registerKeyboardEvent(() => \r\n        {\r\n            const btnok = _fieldPanelIns.instance.btnSubmit;\r\n            if (btnok && !btnok.nativeElement.disabled ) {\r\n                btnok.nativeElement.click();\r\n                this.removeFieldPanel();\r\n            }        \r\n        });\r\n    }\r\n\r\n    private setPanelPosition(updateTopPosition = true) {\r\n        if (this.panelElement) {\r\n            const { width, left, top, height } = this.getPanelSize();\r\n            this.panelElement.style.width = `${width}px`;\r\n            // this.panelElement.style.maxHeight = `${height}px`;\r\n            if (updateTopPosition) {\r\n                this.panelElement.style.top = `${top}px`;\r\n            }\r\n            this.panelElement.style.left = `${left}px`;\r\n        }\r\n    }\r\n\r\n    \r\n\r\n    private getInputSizeInfo() {\r\n        return this.elRef.nativeElement.getBoundingClientRect();\r\n    }\r\n\r\n    private getPanelSize() {\r\n        const width = 380;\r\n        let { top, left, height } = this.getInputSizeInfo();\r\n        const bottom = window.innerHeight - height - top;\r\n        let panelHeight = 190;\r\n        const h = top > bottom ? top : bottom;\r\n        if (bottom > panelHeight) {\r\n            top = top + height;\r\n            // \r\n            this.panelElement.style.transformOrigin = '100% top';\r\n        } else {\r\n            if (top > bottom) {\r\n                if (h < panelHeight) {\r\n                    panelHeight = h - 10;\r\n                    top = 10;\r\n                } else {\r\n                    top = top - parseInt('' + panelHeight, 10) - 5;\r\n                }\r\n\r\n                // \r\n                this.panelElement.style.transformOrigin = '100% bottom';\r\n\r\n            } else {\r\n                if (h < panelHeight) {\r\n                    panelHeight = h - 10;\r\n                }\r\n                top = top + height;\r\n            }\r\n        }\r\n\r\n        if (window.innerWidth - left < width) {\r\n            left = left + width - width;\r\n        }\r\n\r\n        return { width, top, height: panelHeight, left };\r\n    }\r\n}","import { ChangeDetectorRef, Component, ElementRef, EventEmitter, HostBinding, HostListener, Injector, Input, OnInit, Output, ViewChild, ViewEncapsulation } from '@angular/core';\r\nimport { SearchField } from '../search-box.types';\r\n\r\n@Component({\r\n    selector: 'search-panel',\r\n    templateUrl: './search-panel.component.html',\r\n    encapsulation: ViewEncapsulation.None\r\n})\r\n\r\nexport class SearchPanelComponent implements OnInit {\r\n\r\n    @Input() fields: Array<SearchField> = [];\r\n    @Input() maxItems = 5;\r\n    @Input() searchKeyWord = '';\r\n\r\n    @Output() itemClick = new EventEmitter();\r\n    @Output() closepanel = new EventEmitter();\r\n    @Output() mouseDown = new EventEmitter();\r\n\r\n    @ViewChild('itemsContainer') itemsContainer: ElementRef<any>;\r\n\r\n    activeIndex = -1;\r\n\r\n    constructor(private injector: Injector, private cdr: ChangeDetectorRef) { }\r\n\r\n    @HostListener('mousedown', ['$event'])\r\n    onClick($event: MouseEvent) {\r\n        $event.stopPropagation();\r\n    }\r\n\r\n    ngOnInit() { }\r\n\r\n    loadData(items: any) {\r\n        this.fields = items;\r\n\r\n        if (!this.cdr['destroyed']) {\r\n            this.cdr.detectChanges();\r\n        }\r\n    }\r\n\r\n    onFieldItemClick($event, item) {\r\n        $event.preventDefault();\r\n        this.itemClick.emit({data: item, evnet: $event});\r\n    }\r\n\r\n    setActiveItem(index: number) {\r\n        this.activeIndex = index;\r\n        if (!this.cdr['destroyed']) {\r\n            this.cdr.detectChanges();\r\n        }\r\n    }\r\n\r\n    setValue(val) {\r\n        this.searchKeyWord = val;\r\n        this.cdr.detectChanges();\r\n    }\r\n\r\n    onClosePanel($event: MouseEvent) {\r\n        $event.stopPropagation();\r\n        this.closepanel.emit();\r\n    }\r\n\r\n    onMouseDown($event: MouseEvent) {\r\n        $event.preventDefault();\r\n        $event.stopPropagation();\r\n\r\n        this.mouseDown.emit($event);\r\n    }\r\n}","import { AfterViewInit, ComponentFactoryResolver, ComponentRef, Directive, ElementRef, EventEmitter, forwardRef, \r\n    HostListener, Injector, Input, NgZone, OnDestroy, OnInit, Optional, Output, Renderer2 } from '@angular/core';\r\nimport { reqAnimFrame } from '@farris/ui-common';\r\nimport { InputGroupComponent } from '@farris/ui-input-group';\r\nimport { from, fromEvent, Observable } from 'rxjs';\r\nimport { debounceTime, filter, map } from 'rxjs/operators';\r\nimport { SearchBoxComponent } from '../search-box.component';\r\nimport { SearchField } from '../search-box.types';\r\nimport { trim } from 'lodash-es';\r\nimport { SearchPanelComponent } from './search-panel.component';\r\n\r\n@Directive({ selector: '[search-box-panel]'})\r\nexport class SearchPanelDirective implements OnInit, AfterViewInit, OnDestroy {\r\n    @Input('search-box-panel') fields: Array<SearchField>;\r\n    @Input() maxFields = 5;\r\n\r\n    /**   */\r\n    @Input() useAnyField = true;\r\n\r\n    @Output() escHandler = new EventEmitter();\r\n\r\n    private panelElement: HTMLElement;\r\n    private searchPanelRef: ComponentRef<SearchPanelComponent>;\r\n\r\n    private maxPanelItems = 10;\r\n    private minPanelWidth = 270;\r\n\r\n    constructor(private injector: Injector, \r\n        private ngzone: NgZone,\r\n        private render: Renderer2, \r\n        private inputRef: InputGroupComponent,\r\n        private searchBoxRef: SearchBoxComponent,\r\n        private cfr: ComponentFactoryResolver) {\r\n    }\r\n\r\n    ngOnInit(): void {\r\n        \r\n    }\r\n\r\n    ngAfterViewInit(): void {\r\n        if ((!this.fields || !this.fields.length) && !this.useAnyField) {\r\n            return;\r\n        }\r\n\r\n        this.inputRef.inputClick.subscribe((e: MouseEvent) => {\r\n            e.stopPropagation();\r\n        });\r\n\r\n        this.inputRef.valueChange.pipe(\r\n            debounceTime(50)\r\n        ).subscribe((val: string) => {\r\n           \r\n            if (trim(val)) {\r\n                // \r\n                if (!this.panelElement) {\r\n                    this.createDataPanel();\r\n                    this.searchPanelRef.instance.setActiveItem(0);\r\n                }\r\n\r\n                this.searchPanelRef.instance.setValue(val);\r\n            } else {\r\n                if (this.panelElement) {\r\n                    this.hide();\r\n                }\r\n            }\r\n            \r\n        });\r\n\r\n        this.searchBoxRef.clear.subscribe(() => {\r\n            this.hide();\r\n        });\r\n    }\r\n\r\n    ngOnDestroy(): void {\r\n        this.searchBoxRef.overLayService.destory(this.searchBoxRef.el.nativeElement);\r\n    }\r\n\r\n    private removePanelElement() {\r\n        document.body.removeChild(this.panelElement);\r\n        this.panelElement = null;\r\n\r\n        if (this.searchPanelRef) {\r\n            this.searchPanelRef.destroy();\r\n            this.searchPanelRef = null;\r\n        }\r\n    }\r\n\r\n\r\n    hide(e?: any) {\r\n        reqAnimFrame(() => {\r\n            this.inputRef.value = '';\r\n            if (this.panelElement) {\r\n                if (e && ( e.type === 'mousewheel' || e.type === 'wheel')) {\r\n                    this.removePanelElement();\r\n                } else {\r\n                    this.panelElement.classList.remove('f-area-show');\r\n                    setTimeout(() => {\r\n                        this.removePanelElement();\r\n                    },120);\r\n                }\r\n                \r\n                this.searchBoxRef.overLayService.destory(this.searchBoxRef.el.nativeElement);\r\n            }\r\n        });\r\n    }\r\n\r\n    private setPanelPosition(updateTopPosition = true) {\r\n        if (this.panelElement) {\r\n            const { maxWidth, left, top, height } = this.getPanelSize();\r\n            this.panelElement.style.minWidth = `${this.minPanelWidth}px`;\r\n            this.panelElement.style.maxWidth = `${maxWidth}px`;\r\n            this.panelElement.style.maxHeight = `${height}px`;\r\n            if (updateTopPosition) {\r\n                this.panelElement.style.top = `${top}px`;\r\n            }\r\n            this.panelElement.style.left = `${left}px`;\r\n        }\r\n    }\r\n\r\n    private createDataPanel() {\r\n        this.panelElement = document.createElement('div');\r\n        this.panelElement.classList.add('overlay-pane', 'f-search-box-panel', 'f-area-hide');\r\n        const zindex  = '' + this.searchBoxRef.commonUtils.getFloatingLayerIndex();\r\n        document.body.appendChild(this.panelElement);\r\n        this.setPanelPosition();\r\n        this.panelElement.style.zIndex = zindex;\r\n\r\n\r\n        this.panelElement.style.overflow = 'hidden';\r\n        \r\n        // \r\n        const cmpFact = this.cfr.resolveComponentFactory(SearchPanelComponent);\r\n        this.searchPanelRef = cmpFact.create(this.injector);\r\n\r\n        if (this.useAnyField && !this.fields.find(n => n.code === '*')) {\r\n            const anyfieldsName = this.searchBoxRef.localeSer.getValue('searchbox.anyFields')\r\n            this.fields.splice(0,0, { code: '*', name: anyfieldsName });\r\n        }\r\n\r\n        this.searchPanelRef.instance.fields = this.fields;\r\n\r\n        this.panelElement.appendChild(this.searchPanelRef.location.nativeElement);\r\n\r\n        this.searchPanelRef.changeDetectorRef.detectChanges();\r\n\r\n        this.searchPanelRef.instance.searchKeyWord = this.inputRef.value;\r\n        \r\n\r\n        this.searchPanelRef.instance.itemClick.subscribe((e: any) => {\r\n            const { data } = e;\r\n            this.selectItem(data);\r\n        });\r\n\r\n        this.searchPanelRef.instance.closepanel.subscribe(() => {\r\n            this.hide();\r\n        });\r\n\r\n        // Panel\r\n        this.searchBoxRef.overLayService.registerMouseEvent(this.searchBoxRef.el.nativeElement, (e: MouseEvent) => {\r\n            if (!this.panelElement || e.target['closest']('.f-search-box-panel')) {\r\n                return;\r\n            }\r\n\r\n            if(this.inputRef && this.inputRef.textbox.nativeElement === e.target) {\r\n                return false;\r\n            }\r\n\r\n            // \r\n            // if (this.inputRef.value) {\r\n            //     return;\r\n            // }\r\n\r\n            this.hide(e);\r\n        });\r\n\r\n\r\n        if ( this.searchPanelRef.instance.fields.length + 1 < this.maxPanelItems) {\r\n            let newHeight = this.searchPanelRef.instance.itemsContainer.nativeElement.querySelector('ul').offsetHeight + 40;\r\n\r\n            this.searchPanelRef.instance.itemsContainer.nativeElement.style.height = `${newHeight}px`;\r\n            if (this.panelElement) {\r\n                if (this.panelElement.style.transformOrigin.indexOf('bottom') > -1) {\r\n                    this.panelElement.style.top = `${this.getInputSizeInfo().top - newHeight - 5}px` ;\r\n                }\r\n                this.panelElement.style.height = 'auto';\r\n            }\r\n        } else {\r\n            this.searchPanelRef.instance.itemsContainer.nativeElement.style.height = '100%';\r\n            if (this.panelElement) {\r\n                this.render.removeStyle(this.panelElement, 'height');\r\n            }\r\n        }\r\n\r\n        this.panelElement.classList.add('f-area-show');\r\n    }\r\n\r\n    private selectItem(data: any) {\r\n        if (!data) {\r\n            return;\r\n        }\r\n\r\n        this.searchBoxRef.select({...data, value: this.inputRef.value});\r\n        this.hide();\r\n\r\n        this.inputRef.focus();\r\n    }\r\n\r\n\r\n    private calculationPanelHeight() {\r\n        return this.maxPanelItems * 30 + 15;\r\n    }\r\n\r\n    private getInputSizeInfo() {\r\n        const el = this.searchBoxRef.enableFloat ? this.searchBoxRef.shadowBox: this.searchBoxRef.container;\r\n        return el.nativeElement.getBoundingClientRect();\r\n    }\r\n\r\n    private getPanelSize() {\r\n        let { width, height, top, left } = this.getInputSizeInfo();\r\n        const bottom = window.innerHeight - height - top;\r\n        let panelHeight = this.calculationPanelHeight();\r\n\r\n        const h = top > bottom ? top : bottom;\r\n        if (bottom > panelHeight) {\r\n            top = top + height;\r\n            // \r\n            this.panelElement.style.transformOrigin = '100% top';\r\n        } else {\r\n            if (top > bottom) {\r\n                if (h < panelHeight) {\r\n                    panelHeight = h - 10;\r\n                    top = 10;\r\n                } else {\r\n                    top = top - parseInt('' + panelHeight, 10) - 5;\r\n                }\r\n\r\n                // \r\n                this.panelElement.style.transformOrigin = '100% bottom';\r\n\r\n            } else {\r\n                if (h < panelHeight) {\r\n                    panelHeight = h - 10;\r\n                }\r\n                top = top + height;\r\n            }\r\n        }\r\n\r\n        let _width =  width < this.minPanelWidth? this.minPanelWidth: width;\r\n        if (window.innerWidth - left < _width) {\r\n            left = left + width - _width;\r\n        }\r\n\r\n        return { width: _width, top, height: panelHeight, left, maxWidth: Math.floor(window.innerWidth - left - 10) };\r\n    }\r\n\r\n\r\n    @HostListener('keydown', ['$event'])\r\n    registerKeyboardEvent($event: KeyboardEvent) {\r\n        const rows = this.fields;\r\n        if ($event.code === 'ArrowUp' || $event.code === 'ArrowDown') {\r\n            $event.preventDefault();\r\n            $event.stopPropagation();\r\n\r\n            if (this.searchPanelRef) {\r\n                const idx = this.searchPanelRef.instance.activeIndex;\r\n                const setActiveItem = (index) => {\r\n                    this.searchPanelRef.instance.setActiveItem(index);\r\n                };\r\n\r\n                if ($event.code === 'ArrowUp') {  // up\r\n                    if (idx > -1) {\r\n                        let prevIdx = idx - 1;\r\n                        if (prevIdx < 0) {\r\n                            prevIdx = rows.length - 1;\r\n                        }\r\n                        setActiveItem(prevIdx);\r\n                    } else {\r\n                        setActiveItem(rows.length - 1);\r\n                    }\r\n                }\r\n                if ($event.code === 'ArrowDown') { // down\r\n                    let nextIdx = idx + 1;\r\n                    if (nextIdx >= rows.length) {\r\n                        nextIdx = 0;\r\n                    }\r\n\r\n                    setActiveItem(nextIdx);\r\n                }\r\n            }\r\n        }\r\n\r\n        if ($event.code === 'Backspace') {\r\n            if (!this.inputRef.value) {\r\n                if (this.searchBoxRef.displayTextList &&  this.searchBoxRef.displayTextList.length) {\r\n                    $event.preventDefault();\r\n                    $event.stopPropagation();\r\n                    const removeItem = this.searchBoxRef.displayTextList[this.searchBoxRef.displayTextList.length -1];\r\n                    if (removeItem) {\r\n                        this.searchBoxRef.remove(removeItem.code);\r\n                        if (this.searchPanelRef) {\r\n                            this.searchPanelRef.changeDetectorRef.detectChanges();\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n\r\n        if($event.key === 'Enter') {\r\n            if (rows && rows.length && this.panelElement) {\r\n                const idx = this.searchPanelRef.instance.activeIndex;\r\n                const data = rows[idx];\r\n                this.selectItem(data);\r\n            } else {\r\n                this.searchBoxRef.onSubmit($event);\r\n            }\r\n        }\r\n\r\n        if($event.key === 'Escape') {\r\n            if (this.panelElement) {\r\n                this.hide();\r\n            } else {\r\n                this.escHandler.emit();\r\n            }\r\n        }\r\n    }\r\n}","import { Injector, Pipe, PipeTransform } from '@angular/core';\r\nimport { SearchBoxComponent } from '../search-box.component';\r\n\r\n@Pipe({\r\n    name: 'searchwords'\r\n})\r\n\r\nexport class SearchWordPipe implements PipeTransform {\r\n\r\n    constructor(private injector: Injector,  private searchBoxRef: SearchBoxComponent,) {}\r\n\r\n    transform(value: any, ...args: any[]): any {\r\n        if (value !== undefined && value !== null) {\r\n            const relationStr = this.searchBoxRef.localeSer.getValue('searchbox.relation.or');\r\n            const arr = value.trim().split(' ').filter(n => n.trim());\r\n            return arr.map((n, i) => {\r\n                return n  +  (i === arr.length -1 ? '' : '<span class=\"text-muted\" style=\"margin: 0 5px;\"> '+ relationStr +' </span>');\r\n            }).join('');\r\n        }\r\n\r\n        return '';\r\n    }\r\n}","import { ChangeDetectorRef, Component, EventEmitter, Injector, Input, OnInit, Output } from '@angular/core';\r\nimport { DateTimeHelperService } from '@farris/ui-common/date';\r\nimport { LocaleService } from '@farris/ui-locale';\r\n\r\n@Component({\r\n    selector: 'search-filed-editor-date',\r\n    templateUrl: 'flexible-date.component.html'\r\n})\r\n\r\nexport class SearchFieldFlexibleDateComponent implements OnInit {\r\n\r\n    @Input() field;\r\n    @Output() valueChange = new EventEmitter();\r\n    // \r\n    single = true;\r\n    dateFormat = '';\r\n    showTime = false;\r\n    value = '';\r\n    beginValue = '';\r\n    endValue = '';\r\n    showType = '1';\r\n    placeholder = '';\r\n    endPlaceHolder = '';\r\n    beginPlaceHolder = '';\r\n\r\n    activedDateTagId = '';\r\n    activedDayTagId = '';\r\n\r\n    dateTags = [];\r\n    dayTags = [];\r\n\r\n    private dateHelp: DateTimeHelperService = null;\r\n    constructor(private localeService: LocaleService, private injector: Injector, private cd: ChangeDetectorRef) {\r\n        this.dateHelp = this.injector.get(DateTimeHelperService, new DateTimeHelperService());\r\n    }\r\n\r\n    ngOnInit(): void {\r\n        this.dateTags = [\r\n            {\r\n                id: 'tag1',\r\n                text: this.localeService.getValue('filterPanel.last1Month')\r\n            },\r\n            {\r\n                id: 'tag2',\r\n                text: this.localeService.getValue('filterPanel.last3Month')\r\n            },\r\n            {\r\n                id: 'tag3',\r\n                text: this.localeService.getValue('filterPanel.last6Month')\r\n            }\r\n        ];\r\n        this.dayTags = [\r\n            {\r\n                id: 'yesterday',\r\n                text: this.localeService.getValue('filterPanel.yesterday')\r\n            },\r\n            {\r\n                id: 'today',\r\n                text: this.localeService.getValue('filterPanel.today')\r\n            }\r\n        ];\r\n\r\n\r\n        if (this.field.control) {\r\n            const { showTime, showType, single } = this.field.control;\r\n            if (this.field.value) {\r\n                const { value, begin, end } = this.field.value;\r\n                this.value = value,\r\n                this.beginValue = begin;\r\n                this.endValue = end;\r\n            }\r\n    \r\n            this.showTime = showTime;\r\n            this.showType = showType;\r\n            this.single = single;\r\n\r\n            let itemDateFormat = this.field.control.dateFormat;\r\n            if (this.showTime && itemDateFormat) {\r\n                if (itemDateFormat.length > 0 && itemDateFormat.indexOf('HH:mm') == -1) {\r\n                    itemDateFormat = itemDateFormat + ' HH:mm:ss';\r\n                }\r\n            } else {\r\n                itemDateFormat = this.showTime ? 'yyyy-MM-dd HH:mm:ss' : (this.showType == '2' ? 'yyyy-MM' : (this.showType == '3' ? 'yyyy' : 'yyyy-MM-dd'));\r\n            }\r\n            this.dateFormat = itemDateFormat;\r\n        }\r\n    }\r\n\r\n    onDateChange($event) {\r\n        this.valueChange.emit({  field: this.field.code, value: {value: this.value, single: true}});\r\n    }\r\n\r\n    beginValueChange($event) {\r\n        this.valueChange.emit({  field: this.field.code,value: { begin: this.beginValue, end: this.endValue, single: false}});\r\n    }\r\n    endValueChange($event) {\r\n        this.valueChange.emit({  field: this.field.code, value: { begin: this.beginValue, end: this.endValue, single: false}});\r\n    }\r\n\r\n    onSingleChange($event) {\r\n        this.single = !$event;\r\n        this.valueChange.emit({  field: this.field.code,value: {value: this.value,  begin: this.beginValue, end: this.endValue, single: this.single}});\r\n        this.cd.detectChanges();\r\n    }\r\n\r\n    clickTag(tag) {\r\n        this.activedDateTagId = tag.id;\r\n        let tagDate;\r\n        if (tag.id == 'tag1') {\r\n            tagDate = this.getLastNumMonth(1, this.showTime, this.showType);\r\n        }\r\n        else if (tag.id == 'tag2') {\r\n            tagDate = this.getLastNumMonth(3, this.showTime, this.showType);\r\n        }\r\n        else if (tag.id == 'tag3') {\r\n            tagDate = this.getLastNumMonth(6, this.showTime, this.showType);\r\n        }\r\n        this.beginValue = tagDate['startTime'];\r\n        this.endValue = tagDate['endTime'];\r\n        this.valueChange.emit({  field: this.field.code,value: {value: this.value,  begin: this.beginValue, end: this.endValue, single: this.single}});\r\n        this.cd.detectChanges();\r\n    }\r\n\r\n    clickDayTag(tag) {\r\n        this.activedDayTagId = tag.id;\r\n        let dayTag = this.getToday(this.activedDayTagId, this.showTime);\r\n        this.value = dayTag;\r\n        this.valueChange.emit({  field: this.field.code, value: {value: this.value, single: true}});\r\n    }\r\n\r\n    private getLastNumMonth(num:number,showtime,type:string) {\r\n        let now = new Date();\r\n        let year = now.getFullYear();\r\n        let month = now.getMonth() + 1;//0-111-12\r\n        let day = now.getDate();\r\n        let hour = now.getHours();\r\n        let min = now.getMinutes() < 10 ? '0' + new Date().getMinutes()\r\n            :new Date().getMinutes();\r\n          let sec = new Date().getSeconds() < 10 ? '0' + new Date().getSeconds()\r\n            :new Date().getSeconds();\r\n        let dateObj = {};\r\n        const time = hour + ':' + min + ':' + sec;\r\n        // dateObj['endTime'] = year + '-' + month + '-' + day;\r\n        let endMonth = month < 10 ? '0' +month : month;\r\n        let endDay = day < 10 ? '0' +day : day;\r\n        if(type == '2'){\r\n            dateObj['endTime'] = year + '-' + endMonth;\r\n        }\r\n        else if(type == '3'){\r\n            dateObj['endTime'] = year;\r\n        }\r\n        else{\r\n            dateObj['endTime'] = year + '-' + endMonth + '-' + endDay;\r\n        }\r\n          let nowMonthDay = new Date(year, month, 0).getDate();    //\r\n        let dYear,dMouth,dDay;\r\n        if(month - num <= 0){ //123\r\n            let lastMonthDay = new Date((year - 1), (12 - (num - month)), 0).getDate();    //3\r\n            if(lastMonthDay < day){    //3\r\n                // dateObj['startTime'] = (year - 1) + '-' + (12 - (num - month)) + '-' + lastMonthDay;\r\n                dYear = year - 1;\r\n                dMouth = 12 - (num - month);\r\n                dDay = lastMonthDay;\r\n            }else{\r\n                dYear = year - 1;\r\n                dMouth = 12 - (num - month);\r\n                dDay = day;\r\n                // dateObj['startTime']= (year - 1) + '-' + (12 - (num - month)) + '-' + day;\r\n            }\r\n        }else{\r\n            let lastMonthDay = new Date(year, (month - num), 0).getDate();    //3\r\n            if(lastMonthDay < day){    //3\r\n                if(day < nowMonthDay){        //,2\r\n                    // dateObj['startTime'] = year + '-' + (month - num) + '-' + (lastMonthDay - (nowMonthDay - day));\r\n                    dYear = year;\r\n                    dMouth = month - num;\r\n                    dDay = lastMonthDay - (nowMonthDay - day);\r\n                }else{\r\n                    dYear = year;\r\n                    dMouth = month - num;\r\n                    dDay = lastMonthDay;\r\n                    // dateObj['startTime'] = year + '-' + (month - num) + '-' + lastMonthDay;\r\n                }\r\n            }else{\r\n                dYear = year;\r\n                dMouth = month - num;\r\n                dDay = day;\r\n                // dateObj['startTime'] = year + '-' + (month - num) + '-' + day;\r\n            }\r\n        }\r\n        dMouth = dMouth < 10 ? '0' +dMouth : dMouth;\r\n        dDay = dDay < 10 ? '0' +dDay : dDay;\r\n        if(type == '2'){\r\n            dateObj['startTime'] = dYear + '-' + dMouth;\r\n        }\r\n        else if(type == '3'){\r\n            dateObj['startTime'] = dYear;\r\n        }\r\n        else{\r\n            dateObj['startTime'] = dYear + '-' + dMouth + '-' + dDay;\r\n        }\r\n    \r\n        if(showtime){\r\n            dateObj['endTime'] = dateObj['endTime'] + ' ' + time;\r\n            dateObj['startTime'] = dateObj['startTime'] + ' ' + time;\r\n        }\r\n        return dateObj;\r\n    }\r\n    \r\n    private getToday(dayTags = 'today',showtime){\r\n        let now = new Date();\r\n\r\n        if(dayTags == 'today') {\r\n            return this.dateHelp.formatTo(now, this.dateFormat);\r\n        } else if (dayTags == 'yesterday') {\r\n            return this.dateHelp.formatTo(this.dateHelp.subDays(now, 1), this.dateFormat);\r\n        }\r\n\r\n        /*\r\n        let year = now.getFullYear();\r\n        let month = now.getMonth() + 1;//0-111-12\r\n        let day = now.getDate();\r\n        let hour = now.getHours();\r\n        let min = now.getMinutes() < 10 ? '0' + new Date().getMinutes()\r\n            :new Date().getMinutes();\r\n        let sec = new Date().getSeconds() < 10 ? '0' + new Date().getSeconds()\r\n            :new Date().getSeconds();\r\n        const time = hour + ':' + min + ':' + sec;\r\n        let yesterday = new Date();\r\n        yesterday.setTime(now.getTime()-24*60*60*1000);\r\n        let yesterdayObj = yesterday.getFullYear()+\"-\" + (yesterday.getMonth()+1) + \"-\" + yesterday.getDate();\r\n        let dateObj = year + '-' + month + '-' + day;\r\n        if(showtime){\r\n            dateObj = dateObj + ' ' + time;\r\n            yesterdayObj = yesterdayObj + ' ' + time;\r\n        }\r\n        if(dayTags == 'today') return dateObj;\r\n        else if (dayTags == 'yesterday') return yesterdayObj;\r\n\r\n        */\r\n        \r\n    }\r\n}","import { EventEmitter, Component, Input, OnInit, Injector, ChangeDetectorRef, Output} from '@angular/core';\r\n\r\n@Component({\r\n    selector: 'search-filed-editor-number',\r\n    templateUrl: './flexible-number.component.html'\r\n})\r\n\r\nexport class SearchFieldFlexibleNumberComponent implements OnInit {\r\n\r\n    @Input() field;\r\n    @Output() valueChange = new EventEmitter();\r\n    // \r\n    single = true;\r\n    value;\r\n    precision;\r\n    bigNumber;\r\n    placeholder;\r\n    beginValue;\r\n    endValue;\r\n    beginPlaceHolder;\r\n    endPlaceHolder;\r\n    max: number;\r\n    min: number;\r\n\r\n    constructor(private injecotr: Injector, private cd: ChangeDetectorRef) { }\r\n\r\n    ngOnInit() {\r\n        this.single = this.field.control.single;\r\n        if (this.field) {\r\n            if (this.field.value) {\r\n                const { value, begin, end } = this.field.value;\r\n                this.value = value;\r\n                this.beginValue = begin;\r\n                this.endValue = end;\r\n            }\r\n\r\n            this.bigNumber = this.field.control.bigNumber;\r\n\r\n            this.precision = this.field.control.precision || 0;\r\n\r\n            if (!this.bigNumber) {\r\n                this.min = -2147483648;\r\n                this.max = 2147483647;\r\n            }\r\n        }\r\n    }\r\n\r\n    onSingleValueChange($event) {\r\n        this.single = !$event;\r\n        this.valueChange.emit({  field: this.field.code,value: { value: this.value, end: this.endValue, begin: this.beginValue, single: this.single} });\r\n        this.cd.detectChanges();\r\n    }\r\n\r\n    onValueChange($event) {\r\n        this.valueChange.emit({  field: this.field.code,value: { value:$event, single: true} });\r\n    }\r\n\r\n    onBeginValueChange($event){\r\n        this.valueChange.emit({  field: this.field.code, value: { begin: $event, end: this.endValue, single: false } });\r\n    }\r\n\r\n    onEndValueChange($event) {\r\n        this.valueChange.emit({  field: this.field.code,value: { begin: this.beginValue, end: $event, single: false } });\r\n    }\r\n\r\n}","import { ChangeDetectorRef, Component, ElementRef, EventEmitter, Injector, Input, OnInit, Output, ViewChild } from \"@angular/core\";\r\nimport { cloneDeep } from 'lodash-es';\r\n@Component({\r\n    selector: \"search-filed-editor-enum\",\r\n    templateUrl: \"./search-editor-enum.component.html\",\r\n})\r\nexport class SearchFieldEnumEditorComponent implements OnInit {\r\n    checkedAll: boolean = false;\r\n    @Input() boolcheck: boolean = false;\r\n    _item: any;\r\n    @Input()\r\n    get field() {\r\n        return this._item;\r\n    }\r\n    set field(data) {\r\n        this._item = cloneDeep(data);\r\n        this.getDataSource();\r\n        //this.checkValue = this._item.value.getOriginalValue();\r\n        if (!this._item.hasOwnProperty(\"value\")) {\r\n            this._item.value = { value: [] };\r\n        }\r\n\r\n        if (this._item.hasOwnProperty(\"value\") && this._item.value) {\r\n            this.checkValue = this._item.value.value;\r\n        } else {\r\n            this._item.value = { value: [] };\r\n        }\r\n        // if (this.boolcheck) {\r\n        //     if (this.checkValue.length) {\r\n        //         this.boolchecked = this.checkValue[0];\r\n        //         if (this.boolchecked) this.boolCheckState = \"checked\";\r\n        //         else this.boolCheckState = \"unchecked\";\r\n        //     } else this.boolCheckState = \"indeterminate\";\r\n        // }\r\n        if (this._item.value.value.length == 0){\r\n            this.checkedAll = false;\r\n        }else if (this._item.control[\"enumValues\"] && this._item.value.value.length == this._item.control[\"enumValues\"].length) {\r\n            this.checkedAll = true;\r\n        }\r\n        this.setSubmitChange();\r\n    }\r\n\r\n    @Output() valueChange = new EventEmitter();\r\n\r\n\r\n    checkValue: any[];\r\n    // indeterminate: boolean = true;\r\n    // boolchecked: boolean;\r\n    // boolCheckState: string = \"indeterminate\";\r\n\r\n    checkboxDataSource: Array<any> = new Array<any>();\r\n\r\n    @ViewChild('checkAllEl') checkAllElRef: ElementRef;\r\n\r\n    constructor(private injector: Injector, private cd: ChangeDetectorRef) { }\r\n\r\n    ngOnInit(): void { }\r\n\r\n    getDataSource() {\r\n        if (this.field && this._item.control) {\r\n            let checkboxList = this._item.control;\r\n            this.checkboxDataSource = Array<any>();\r\n            if (checkboxList.enumValues && checkboxList.enumValues.length > 0) {\r\n                checkboxList.enumValues.forEach((element) => {\r\n                    this.checkboxDataSource.push(Object.assign({}, element));\r\n                });\r\n            }\r\n        }\r\n    }\r\n\r\n    onSearch(event) {\r\n        let checkboxValue = [];\r\n        if (event) {\r\n            // let checkboxList = event.split(',');\r\n            let checkboxList = event;\r\n            if (checkboxList && checkboxList.length) {\r\n                checkboxValue = checkboxList;\r\n            }\r\n            this._item.value.value = checkboxValue;\r\n        } else {\r\n            this._item.value.value = \"\";\r\n        }\r\n        if (checkboxValue.length < this._item.control[\"enumValues\"].length) {\r\n            this.checkedAll = false;\r\n            // this.checkAllElRef.nativeElement.indeterminate = !!checkboxValue.length;\r\n            // if (!checkboxValue.length) {\r\n            //     this.checkedAll = false;    \r\n            // }\r\n        } else if ( checkboxValue.length == this._item.control[\"enumValues\"].length){\r\n            this.checkedAll = true;\r\n            // this.checkAllElRef.nativeElement.indeterminate = false;\r\n        }\r\n        this.cd.detectChanges();\r\n        this.getValueText();\r\n        this.setSubmitChange();\r\n        this.valueChange.emit({  field: this.field.code,value: {value: checkboxValue, single: true} });\r\n    }\r\n\r\n    getValueText() {\r\n        const enumValue = this._item.control.enumValues;\r\n        const value = this._item.value.value;\r\n        if (enumValue && enumValue.length && value && value.length) {\r\n            let texts = [];\r\n            for (let i = 0; i <= value.length; i++) {\r\n                const enums = enumValue.find((val) => {\r\n                    return val[\"value\"] == value[i];\r\n                });\r\n                if (enums) {\r\n                    texts.push(enums[\"name\"]);\r\n                }\r\n            }\r\n            this._item.valueText = texts.join(\",\");\r\n        }\r\n    }\r\n\r\n    setSubmitChange() {\r\n        const val = this._item.value;\r\n        if (\r\n            Object.keys(val).length < 0 ||\r\n            Object.keys(val.value).length === 0\r\n        ) {\r\n            // this.submitChange.emit(false);\r\n        } else {\r\n            // this.submitChange.emit(true);\r\n        }\r\n    }\r\n\r\n    onCheckAll(event) {\r\n        // this.checkAllElRef.nativeElement.indeterminate = false;\r\n        this.checkedAll = !this.checkedAll;\r\n        if (this.checkedAll) {\r\n            this.setCheckedAll();\r\n        } else {\r\n            this._item.value.value = [];\r\n            this._item.valueText = \"\";\r\n            this.checkValue = [];\r\n        }\r\n\r\n        this.getValueText();\r\n        this.setSubmitChange();\r\n\r\n        this.cd.detectChanges();\r\n\r\n        this.valueChange.emit({ field: this.field.code, value: {value: this.checkValue, single: true} });\r\n    }\r\n\r\n    private setCheckedAll() {\r\n        const enumValue = this._item.control.enumValues;\r\n        if (enumValue && enumValue.length) {\r\n            let checkboxValue = [];\r\n            //checkboxTexts = [];\r\n            for (let i = 0; i < enumValue.length; i++) {\r\n                checkboxValue.push(enumValue[i][\"value\"]);\r\n                //checkboxTexts.push(enumValue[i]['name'])\r\n            }\r\n            this._item.value.value = checkboxValue;\r\n            this.checkValue = this._item.value.value;\r\n            //this._item.valueText = checkboxTexts.join(',');\r\n\r\n            this.cd.detectChanges();\r\n        }\r\n    }\r\n\r\n}\r\n","import { EventEmitter, ChangeDetectorRef, Component, ElementRef, Injector, Input, OnInit, Output, AfterViewInit } from '@angular/core';\r\n\r\n@Component({\r\n    selector: 'search-field-editor-bool',\r\n    templateUrl: './search-editor-boolean.component.html'\r\n})\r\nexport class SearchFieldEditorBooleanComponent implements OnInit, AfterViewInit {\r\n\r\n    @Input() field: any;\r\n\r\n    radioDataSource = [];\r\n    selectedValue = undefined;\r\n\r\n    @Output() valueChange = new EventEmitter();\r\n    private _radioElements = [];\r\n\r\n    constructor(private injector: Injector, private cd: ChangeDetectorRef, private el: ElementRef) { }\r\n\r\n    ngOnInit() {\r\n        if (this.field) {\r\n            if (this.field.control) {\r\n                this.radioDataSource = this.field.control.enumValues || [];\r\n            }\r\n\r\n            if (this.field.value) {\r\n                this.selectedValue = this.field.value.value;\r\n            }\r\n        }\r\n    }\r\n\r\n    ngAfterViewInit(): void {\r\n        if (this.selectedValue !== null && this.selectedValue !== undefined) {\r\n            this._radioElements = Array.from(this.el.nativeElement.querySelectorAll('input'));\r\n            const radioEl = this._radioElements.find(n => n.value == this.selectedValue);\r\n            if (radioEl) {\r\n                radioEl.checked = true;\r\n            }\r\n        }\r\n    }\r\n\r\n    onRadioClicked($event, value) {\r\n        this.selectedValue = value;\r\n        const radioInputRel = $event.target.querySelector('input');\r\n        // radioInputRel && radioInputRel.setAttribute('checked', true);\r\n        if (radioInputRel) {\r\n            this.clearChecked();\r\n            radioInputRel.checked = true;\r\n            this.cd.detectChanges();\r\n        }\r\n\r\n        this.valueChange.emit({ field: this.field.code,  value: {value: this.selectedValue, single: true} });\r\n    }\r\n\r\n    private clearChecked() {\r\n        if (!this._radioElements || !this._radioElements.length) {\r\n            this._radioElements = Array.from(this.el.nativeElement.querySelectorAll('input'));\r\n        }\r\n        this._radioElements.forEach((r: any) => {\r\n            // r.removeAttribute('checked');\r\n            r.checked = false;\r\n        });\r\n    }\r\n}","import { Pipe, PipeTransform } from '@angular/core';\r\n\r\n@Pipe({\r\n    name: 'canclear'\r\n})\r\nexport class SearchFieldCanClearPipe implements PipeTransform {\r\n\r\n    private isNil = (val: any) => val === null  || val === undefined || val === '' || (Array.isArray(val) && !val.length);\r\n\r\n    transform(val: any, ...args: any[]): any {\r\n        let canClear = false;\r\n        if (val) {\r\n            const { value, begin, end, single } = val;\r\n\r\n            if (!this.isNil(single)) {\r\n                if (!single) {\r\n                    canClear = !this.isNil(begin) || !this.isNil(end);\r\n                } else {\r\n                    canClear = !this.isNil(value);\r\n                }\r\n            } else {\r\n                canClear = !this.isNil(value);\r\n            }\r\n        }\r\n\r\n        return !canClear;\r\n    }\r\n}","import { CommonModule } from '@angular/common';\r\nimport { NgModule } from '@angular/core';\r\nimport { FormsModule } from '@angular/forms';\r\n\r\nimport { FarrisCommonModule }           from '@farris/ui-common';\r\nimport { InputGroupModule }             from '@farris/ui-input-group';\r\nimport { LocaleModule }                 from '@farris/ui-locale';\r\nimport { FarrisDatePickerModule }       from '@farris/ui-datepicker';\r\nimport { SwitchModule }                 from '@farris/ui-switch';\r\nimport { NumberSpinnerModule }          from '@farris/ui-number-spinner';\r\nimport { FarrisFormsModule }            from '@farris/ui-forms';\r\nimport { DateHelperModule }             from \"@farris/ui-common/date\";\r\n\r\nimport { SearchBoxComponent } from './search-box.component';\r\nimport { SearchFieldPanelComponent } from './search-fields/search-field-panel.component';\r\nimport { SearchFieldsComponent } from './search-fields/search-fields.component';\r\nimport { SearchFieldDirective } from './search-fields/search-filed.directive';\r\nimport { SearchPanelComponent } from './search-panel/search-panel.component';\r\nimport { SearchPanelDirective } from './search-panel/search-panel.directive';\r\nimport { SearchWordPipe } from './search-panel/search-words.pipe';\r\n\r\nimport { SearchFieldFlexibleDateComponent }     from './search-fields/editors/date/flexible-date.component';\r\nimport { SearchFieldFlexibleNumberComponent }   from './search-fields/editors/number/flexible-number.component';\r\nimport { SearchFieldEnumEditorComponent }       from './search-fields/editors/enum/search-editor-enum.component';\r\nimport { SearchFieldEditorBooleanComponent }    from './search-fields/editors/boolean/search-editor-boolean.component';\r\nimport { SearchFieldCanClearPipe } from './search-fields/can-clear-condition.pipe';\r\n@NgModule({\r\n    declarations: [\r\n        SearchBoxComponent,\r\n        SearchPanelComponent,\r\n        SearchPanelDirective,\r\n        SearchWordPipe,\r\n        SearchFieldsComponent,\r\n        SearchFieldDirective,\r\n        SearchFieldPanelComponent,\r\n        SearchFieldFlexibleDateComponent,\r\n        SearchFieldFlexibleNumberComponent,\r\n        SearchFieldEnumEditorComponent,\r\n        SearchFieldEditorBooleanComponent,\r\n        SearchFieldCanClearPipe\r\n    ],\r\n    imports: [\r\n        CommonModule,\r\n        FormsModule,\r\n        FarrisCommonModule.forRoot(),\r\n        InputGroupModule,\r\n        LocaleModule.forRoot(),\r\n        FarrisDatePickerModule,\r\n        SwitchModule,\r\n        NumberSpinnerModule,\r\n        FarrisFormsModule,\r\n        DateHelperModule.forRoot()\r\n    ],\r\n    entryComponents: [\r\n        SearchPanelComponent,\r\n        SearchFieldPanelComponent\r\n    ],\r\n    exports: [\r\n        SearchBoxComponent,\r\n        SearchPanelComponent,\r\n        SearchPanelDirective,\r\n        SearchWordPipe,\r\n        SearchFieldsComponent,\r\n        SearchFieldDirective,\r\n        SearchFieldPanelComponent,\r\n        SearchFieldFlexibleDateComponent,\r\n        SearchFieldFlexibleNumberComponent,\r\n        SearchFieldEnumEditorComponent,\r\n        SearchFieldEditorBooleanComponent\r\n    ]\r\n})\r\nexport class SearchBoxModule { }\r\n"]}