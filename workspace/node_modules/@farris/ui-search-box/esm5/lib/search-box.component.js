/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
import { ChangeDetectorRef, Component, ElementRef, EventEmitter, forwardRef, Injector, Input, Optional, Output, ViewChild, ViewEncapsulation } from "@angular/core";
import { OverLayHiddenService } from "@farris/ui-common";
import { InputGroupComponent } from "@farris/ui-input-group";
import { Compare, FilterRelation } from "@farris/ui-common/types";
import { flatten } from 'lodash-es';
import { NG_VALUE_ACCESSOR } from "@angular/forms";
import { BehaviorSubject } from "rxjs";
import { SearchBoxBase } from "./search-box-base";
/** @type {?} */
export var SEARCH_BOX_VALUE_ACCESSOR = {
    provide: NG_VALUE_ACCESSOR,
    useExisting: forwardRef((/**
     * @return {?}
     */
    function () { return SearchBoxComponent; })),
    multi: true
};
var SearchBoxComponent = /** @class */ (function (_super) {
    tslib_1.__extends(SearchBoxComponent, _super);
    function SearchBoxComponent(el, injector, overLayService, cd) {
        var _this = _super.call(this, el, injector, overLayService, cd) || this;
        _this.fields = [];
        _this.maxSearchFields = 5;
        _this.condition = [];
        /**
         * 启用 任意字段
         */
        _this.useAnyField = true;
        _this.conditionChange = new EventEmitter();
        _this.clear = new EventEmitter();
        _this.escHandler = new EventEmitter();
        /**
         * 启用漂浮，false: 内容会撑高容器； true：固定高度26px，点击或滑过时，显示完整内容，失去焦点后，返回固定状态
         */
        _this.enableFloat = true;
        _this.displayTextList = [];
        _this.filterConditions = [];
        _this.hiddenItemsCount$ = new BehaviorSubject(0);
        _this.onModelChange = (/**
         * @param {?} arr
         * @return {?}
         */
        function (arr) { });
        _this.onModelTouched = (/**
         * @param {?} arr
         * @return {?}
         */
        function (arr) { });
        return _this;
    }
    /**
     * @return {?}
     */
    SearchBoxComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
    };
    /**
     * @return {?}
     */
    SearchBoxComponent.prototype.ngAfterViewInit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        setTimeout((/**
         * @return {?}
         */
        function () {
            _this.moveShadowToBody();
        }));
    };
    /**
     * @param {?} changes
     * @return {?}
     */
    SearchBoxComponent.prototype.ngOnChanges = /**
     * @param {?} changes
     * @return {?}
     */
    function (changes) {
    };
    /**
     * @return {?}
     */
    SearchBoxComponent.prototype.ngOnDestroy = /**
     * @return {?}
     */
    function () {
        if (this.overLayService) {
            this.overLayService.destory(this.shadowBox.nativeElement);
            this.overLayService = null;
        }
        if (this.shadowBox) {
            this.shadowBox.nativeElement.remove();
        }
        if (this['REMOVE_ITEM_TIMER']) {
            clearTimeout(this['REMOVE_ITEM_TIMER']);
            this['REMOVE_ITEM_TIMER'] = null;
        }
    };
    /**
     * @param {?} $event
     * @return {?}
     */
    SearchBoxComponent.prototype.onBlur = /**
     * @param {?} $event
     * @return {?}
     */
    function ($event) {
        if (this.enableFloat) {
            if (!this.input2.value) {
                this.toggleShadowBox(false);
            }
        }
    };
    /**
     * @param {?} $event
     * @return {?}
     */
    SearchBoxComponent.prototype.onInputClick = /**
     * @param {?} $event
     * @return {?}
     */
    function ($event) {
        if (this.enableFloat) {
            this.toggleShadowBox();
        }
    };
    /**
     * @private
     * @return {?}
     */
    SearchBoxComponent.prototype.filterChanged = /**
     * @private
     * @return {?}
     */
    function () {
        var _this = this;
        /** @type {?} */
        var conditions = this.filterConditions.filter((/**
         * @param {?} n
         * @return {?}
         */
        function (n) { return n.code !== '*'; })).map((/**
         * @param {?} n
         * @param {?} i
         * @return {?}
         */
        function (n, i) {
            if (n.value.trim().indexOf(' ') > -1) {
                /** @type {?} */
                var searchKeys_1 = Array.from(new Set(n.value.trim().split(' ').filter((/**
                 * @param {?} n
                 * @return {?}
                 */
                function (n) { return n.trim(); }))));
                return searchKeys_1.map((/**
                 * @param {?} s
                 * @param {?} j
                 * @return {?}
                 */
                function (s, j) {
                    return {
                        filterField: n.code,
                        value: s,
                        lbracket: j == 0 ? '(' : '',
                        rbracket: j == searchKeys_1.length - 1 ? ')' : '',
                        relation: j == searchKeys_1.length - 1 ? 1 : 2,
                        compare: 6,
                    };
                }));
            }
            return {
                filterField: n.code,
                value: n.value,
                lbracket: '',
                rbracket: '',
                relation: i == _this.filterConditions.length - 1 ? 0 : 1,
                compare: 6,
            };
        }));
        /** @type {?} */
        var _conditions = [];
        _conditions = this.expandStarFieldToAllFields().concat(flatten(conditions));
        if (conditions && conditions.length) {
            _conditions[_conditions.length - 1].relation = 0;
        }
        this.onModelChange(this.filterConditions);
        this.onModelTouched(this.filterConditions);
        if (!_conditions.length) {
            this.conditionChange.emit(this.filterConditions);
        }
        else {
            this.conditionChange.emit(_conditions);
        }
    };
    /**
     * @return {?}
     */
    SearchBoxComponent.prototype.expandStarFieldToAllFields = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var item = this.filterConditions.find((/**
         * @param {?} n
         * @return {?}
         */
        function (n) { return n.code === '*'; }));
        if (!item) {
            return [];
        }
        /** @type {?} */
        var searchKeys = Array.from(new Set(item.value.trim().split(' ').filter((/**
         * @param {?} n
         * @return {?}
         */
        function (n) { return n.trim(); }))));
        /** @type {?} */
        var conditions = this.fields.filter((/**
         * @param {?} n
         * @return {?}
         */
        function (n) { return n.code !== '*'; })).map((/**
         * @param {?} n
         * @param {?} i
         * @return {?}
         */
        function (n, i) {
            return searchKeys.map((/**
             * @param {?} s
             * @param {?} j
             * @return {?}
             */
            function (s, j) {
                return {
                    filterField: n.code,
                    value: s,
                    lbracket: '',
                    rbracket: '',
                    relation: FilterRelation.Or,
                    compare: Compare.Like,
                };
            }));
        }));
        /** @type {?} */
        var _conditions = [];
        if (conditions && conditions.length) {
            _conditions = flatten(conditions);
            _conditions[0].lbracket = '(';
            _conditions[_conditions.length - 1].rbracket = ')';
            _conditions[_conditions.length - 1].relation = this.filterConditions.filter((/**
             * @param {?} n
             * @return {?}
             */
            function (n) { return n.code !== '*'; })).length ? 1 : 0;
        }
        return _conditions;
    };
    /**
     * @private
     * @param {?=} emit
     * @return {?}
     */
    SearchBoxComponent.prototype.initDislayText = /**
     * @private
     * @param {?=} emit
     * @return {?}
     */
    function (emit) {
        var _this = this;
        if (emit === void 0) { emit = true; }
        /** @type {?} */
        var relationStr = this.localeSer.getValue('searchbox.relation.or');
        this.displayTextList = this.filterConditions.map((/**
         * @param {?} t
         * @return {?}
         */
        function (t) {
            /** @type {?} */
            var n = tslib_1.__assign({}, t);
            // .map(n => `“${n}”`)
            /** @type {?} */
            var values = n.value.trim().split(' ').filter((/**
             * @param {?} n
             * @return {?}
             */
            function (n) { return n.trim(); }));
            n.dislayText = n.name + '：' + values.join(" " + relationStr + " ");
            n.displayHtml = n.name + '：' + values.join("<span class=\"text-muted font-italic mx-1 or\">" + relationStr + "</span>");
            return n;
        }));
        setTimeout((/**
         * @return {?}
         */
        function () {
            if (_this.enableFloat) {
                _this.setHiddenCount();
            }
        }));
        this.cd.detectChanges();
        if (emit) {
            this.filterChanged();
        }
    };
    /**
     * @param {?} searchData
     * @return {?}
     */
    SearchBoxComponent.prototype.select = /**
     * @param {?} searchData
     * @return {?}
     */
    function (searchData) {
        /** @type {?} */
        var condition = this.filterConditions.find((/**
         * @param {?} n
         * @return {?}
         */
        function (n) { return n.code === searchData.code; }));
        if (condition) {
            condition.value = condition.value.trim() + ' ' + searchData.value;
        }
        else {
            this.filterConditions.push(searchData);
        }
        this.initDislayText();
        this.input.value = '';
    };
    /**
     * @param {?} field
     * @return {?}
     */
    SearchBoxComponent.prototype.remove = /**
     * @param {?} field
     * @return {?}
     */
    function (field) {
        this.filterConditions = this.filterConditions.filter((/**
         * @param {?} n
         * @return {?}
         */
        function (n) { return n.code !== field; }));
        this.initDislayText(false);
        this._emitFilterChanged();
    };
    /**
     * @private
     * @return {?}
     */
    SearchBoxComponent.prototype._emitFilterChanged = /**
     * @private
     * @return {?}
     */
    function () {
        var _this = this;
        if (this['REMOVE_ITEM_TIMER']) {
            clearTimeout(this['REMOVE_ITEM_TIMER']);
        }
        this['REMOVE_ITEM_TIMER'] = setTimeout((/**
         * @return {?}
         */
        function () {
            _this.filterChanged();
        }), 180);
    };
    /**
     * @param {?} $event
     * @param {?} item
     * @return {?}
     */
    SearchBoxComponent.prototype.onRemoveItem = /**
     * @param {?} $event
     * @param {?} item
     * @return {?}
     */
    function ($event, item) {
        $event.stopPropagation();
        this.filterConditions = this.filterConditions.filter((/**
         * @param {?} n
         * @return {?}
         */
        function (n) { return n.code !== item.code; }));
        this.initDislayText();
    };
    /**
     * @param {?=} emit
     * @return {?}
     */
    SearchBoxComponent.prototype.clearConditions = /**
     * @param {?=} emit
     * @return {?}
     */
    function (emit) {
        if (emit === void 0) { emit = true; }
        this.input.value = '';
        this.displayTextList = [];
        this.filterConditions = [];
        this.setHiddenCount();
        if (emit) {
            this.conditionChange.emit([]);
            this.clear.emit();
        }
    };
    /**
     * @param {?} $event
     * @return {?}
     */
    SearchBoxComponent.prototype.onSubmit = /**
     * @param {?} $event
     * @return {?}
     */
    function ($event) {
        $event.stopPropagation();
        this.input.value = '';
        this.toggleShadowBox(false);
        this._emitFilterChanged();
    };
    /**
     * @param {?} obj
     * @return {?}
     */
    SearchBoxComponent.prototype.writeValue = /**
     * @param {?} obj
     * @return {?}
     */
    function (obj) {
        /** @type {?} */
        var arr = obj;
        if (!Array.isArray(obj)) {
            arr = [];
        }
        this.filterConditions = arr;
        this.initDislayText();
    };
    /**
     * @param {?} fn
     * @return {?}
     */
    SearchBoxComponent.prototype.registerOnChange = /**
     * @param {?} fn
     * @return {?}
     */
    function (fn) {
        this.onModelChange = fn;
    };
    /**
     * @param {?} fn
     * @return {?}
     */
    SearchBoxComponent.prototype.registerOnTouched = /**
     * @param {?} fn
     * @return {?}
     */
    function (fn) {
        this.onModelTouched = fn;
    };
    /**
     * @param {?} arr
     * @param {?=} emit
     * @return {?}
     */
    SearchBoxComponent.prototype.setValue = /**
     * @param {?} arr
     * @param {?=} emit
     * @return {?}
     */
    function (arr, emit) {
        if (emit === void 0) { emit = true; }
        this.filterConditions = arr;
        this.initDislayText(emit);
    };
    /**
     * @param {?=} __0
     * @return {?}
     */
    SearchBoxComponent.prototype.updateShadowBoxPosition = /**
     * @param {?=} __0
     * @return {?}
     */
    function (_a) {
        var _b = _a === void 0 ? { top: null, left: null, width: null } : _a, top = _b.top, left = _b.left, width = _b.width;
        if (!top && !left && !width) {
            /** @type {?} */
            var e = this.el.nativeElement.getBoundingClientRect();
            top = e.top;
            left = e.left;
            width = e.width;
        }
        this.render.setStyle(this.shadowBox.nativeElement, 'left', left + 'px');
        this.render.setStyle(this.shadowBox.nativeElement, 'top', top + 'px');
        this.render.setStyle(this.shadowBox.nativeElement, 'width', width + 'px');
        this.render.setStyle(this.shadowBox.nativeElement, 'zIndex', this.commonUtils.getFloatingLayerIndex());
    };
    /**
     * @private
     * @return {?}
     */
    SearchBoxComponent.prototype.moveShadowToBody = /**
     * @private
     * @return {?}
     */
    function () {
        var _this = this;
        if (!this.enableFloat) {
            return;
        }
        this.updateShadowBoxPosition();
        document.body.append(this.shadowBox.nativeElement);
        this.overLayService.registerMouseEvent(this.shadowBox.nativeElement, (/**
         * @param {?} e
         * @return {?}
         */
        function (e) {
            if (e.target && e.target.className.indexOf('search-box_delete-keys') > -1) {
                return;
            }
            if (e.target === _this.input2.textbox.nativeElement || !_this.shadowBox || _this.shadowBox.nativeElement.contains(e.target) ||
                e.target['closest']('.f-search-box-panel')) {
                return;
            }
            _this.toggleShadowBox(false);
        }));
    };
    /**
     * @param {?=} show
     * @return {?}
     */
    SearchBoxComponent.prototype.toggleShadowBox = /**
     * @param {?=} show
     * @return {?}
     */
    function (show) {
        if (show === void 0) { show = true; }
        if (!this.enableFloat || ((!this.fields || !this.fields.length) && !this.useAnyField)) {
            return;
        }
        if (show) {
            this.updateShadowBoxPosition();
            this.render.removeStyle(this.shadowBox.nativeElement, 'display');
            this.container.nativeElement.style.visibility = 'hidden';
            this.input2.focus();
        }
        else {
            this.container.nativeElement.style.visibility = 'visible';
            this.render.setStyle(this.shadowBox.nativeElement, 'display', 'none');
        }
    };
    /**
     * @param {?} $event
     * @return {?}
     */
    SearchBoxComponent.prototype.onShadowBoxClick = /**
     * @param {?} $event
     * @return {?}
     */
    function ($event) {
        $event.stopPropagation();
        if (this.enableFloat) {
            this.input2.focus();
        }
    };
    /**
     * @param {?} $event
     * @return {?}
     */
    SearchBoxComponent.prototype.onResized = /**
     * @param {?} $event
     * @return {?}
     */
    function ($event) {
        var _this = this;
        if (this.enableFloat) {
            this.updateShadowBoxPosition($event);
            setTimeout((/**
             * @return {?}
             */
            function () {
                _this.setHiddenCount();
                _this.cd.detectChanges();
            }));
        }
    };
    /**
     * @private
     * @return {?}
     */
    SearchBoxComponent.prototype.setHiddenCount = /**
     * @private
     * @return {?}
     */
    function () {
        /** @type {?} */
        var len = 0;
        if (!this.displayTextList || !this.displayTextList.length) {
            this.hiddenItemsCount$.next(len);
            return;
        }
        /** @type {?} */
        var items = Array.from(this.container.nativeElement.querySelectorAll('span.search-tag-item'));
        if (items && items.length) {
            len = items.map((/**
             * @param {?} n
             * @return {?}
             */
            function (n) {
                return n.offsetTop;
            })).filter((/**
             * @param {?} n
             * @return {?}
             */
            function (n) { return n > 20; })).length;
        }
        this.hiddenItemsCount$.next(len);
    };
    /**
     * @param {?} $event
     * @return {?}
     */
    SearchBoxComponent.prototype.onEsc = /**
     * @param {?} $event
     * @return {?}
     */
    function ($event) {
        this.escHandler.emit($event);
    };
    SearchBoxComponent.decorators = [
        { type: Component, args: [{
                    selector: "farris-search-box",
                    template: "\r\n\r\n<div #searchbox class=\"input-group f-search-box\" resizeObserver (resize)=\"onResized($event)\" >\r\n    <div class=\"form-control f-cmp-inputgroup--multi-wrapper multi-more\" style=\"min-height: 26px;padding: 0px 5px;\" [style.height]=\"enableFloat? '26px': 'auto'\">\r\n        <div class=\"multi--content d-flex flex-row\" style=\"width: 100%;flex-wrap: wrap;align-items: center;cursor: text;\" #tagContainer (click)=\"toggleShadowBox()\">\r\n            <span class=\"multi--item search-tag-item\" *ngFor=\"let txt of displayTextList; let index\" title=\"{{ txt.dislayText }}\">\r\n                <span class=\"search-tag\" [innerHTML]=\"txt.displayHtml | safe: 'html'\"></span>\r\n                <i class=\"f-icon f-icon-close search-box_delete-keys\" style=\"top:5px\" title=\"{{'searchbox.removeFilter'| locale}}\" (click)=\"onRemoveItem($event, txt)\"></i>\r\n            </span>\r\n\r\n            <span class=\"inputbox\">\r\n                <input-group #tagInput class=\"search-input\"\r\n                    [placeholder]=\"'searchbox.enterKeywords'| locale\" (escHandler)=\"onEsc($event)\"\r\n                    [enableClear]=\"false\" [noborder]=\"true\" (inputClick)=\"onInputClick($event)\"\r\n                    [search-box-panel]=\"fields\" [maxFields]=\"maxSearchFields\" [useAnyField]=\"useAnyField\"\r\n                ></input-group>\r\n            </span>\r\n        </div>\r\n\r\n        <div class=\"d-flex flex-row\" style=\"cursor: pointer;align-items: center;color: #2A87FF;font-weight: 600;\" *ngIf=\"hiddenItemsCount$ | async\" (click)=\"toggleShadowBox()\">\r\n            <span class=\"multi--more-text\">+{{hiddenItemsCount$ | async}}</span>\r\n        </div>\r\n    </div>\r\n    <div class=\"input-group-append\" style=\"position: relative;\" (mouseenter)=\"$event.stopPropagation()\">\r\n        <span class=\"input-group-text\" [ngStyle]=\"displayTextList && displayTextList.length? {} : {pointerEvents: 'none'}\" >\r\n            <span class=\"f-icon f-icon-search\" (click)=\"onSubmit($event)\"></span>\r\n        </span>\r\n    </div>\r\n</div>\r\n\r\n\r\n<div #searchbox2 class=\"input-group f-search-box f-cmp-inputgroup \" style=\"position:absolute;display: none; z-index: 2999;\" *ngIf=\"enableFloat\" \r\n(click)=\"onShadowBoxClick($event)\" (mousedown)=\"$event.preventDefault()\" >\r\n    <div class=\"form-control f-cmp-inputgroup--multi-wrapper multi-more  d-flex\" style=\"height: auto; min-height: 26px;padding: 0px 5px;\">\r\n        <div class=\"multi--content d-flex flex-row\" style=\"width: 100%;flex-wrap: wrap;align-items: center;\" #tagContainer>\r\n            <span class=\"multi--item search-tag-item\" *ngFor=\"let txt of displayTextList; let index\" title=\"{{ txt.dislayText }}\">\r\n                <span class=\"search-tag\" [innerHTML]=\"txt.displayHtml | safe: 'html'\"></span>\r\n                <i class=\"f-icon f-icon-close search-box_delete-keys\" style=\"top:5px\" title=\"{{'searchbox.removeFilter'| locale}}\"  (click)=\"onRemoveItem($event, txt)\"></i>\r\n            </span>\r\n\r\n            <span class=\"inputbox\">\r\n                <input-group #tagInput2 class=\"search-input\"\r\n                    [placeholder]=\"'searchbox.enterKeywords'| locale\"\r\n                    [enableClear]=\"false\" [noborder]=\"true\" (blurHandle)=\"onBlur($event)\" (escHandler)=\"onEsc($event)\"\r\n                    [search-box-panel]=\"fields\" [maxFields]=\"maxSearchFields\" [useAnyField]=\"useAnyField\"\r\n                ></input-group>\r\n            </span>\r\n        </div>\r\n    </div>\r\n    <div class=\"input-group-append\" style=\"position: relative;\" (mousedown)=\"$event.preventDefault()\">\r\n        <span class=\"input-group-text\" [ngStyle]=\"displayTextList && displayTextList.length? {} : {pointerEvents: 'none'}\">\r\n            <span class=\"f-icon f-icon-search\" (click)=\"onSubmit($event)\"></span>\r\n        </span>\r\n    </div>\r\n</div>\r\n",
                    encapsulation: ViewEncapsulation.None,
                    providers: [
                        SEARCH_BOX_VALUE_ACCESSOR
                    ]
                }] }
    ];
    /** @nocollapse */
    SearchBoxComponent.ctorParameters = function () { return [
        { type: ElementRef },
        { type: Injector },
        { type: OverLayHiddenService, decorators: [{ type: Optional }] },
        { type: ChangeDetectorRef }
    ]; };
    SearchBoxComponent.propDecorators = {
        fields: [{ type: Input }],
        maxSearchFields: [{ type: Input }],
        condition: [{ type: Input }],
        useAnyField: [{ type: Input }],
        container: [{ type: ViewChild, args: ['searchbox',] }],
        input: [{ type: ViewChild, args: ['tagInput',] }],
        shadowBox: [{ type: ViewChild, args: ['searchbox2',] }],
        input2: [{ type: ViewChild, args: ['tagInput2',] }],
        conditionChange: [{ type: Output }],
        clear: [{ type: Output }],
        escHandler: [{ type: Output }]
    };
    return SearchBoxComponent;
}(SearchBoxBase));
export { SearchBoxComponent };
if (false) {
    /** @type {?} */
    SearchBoxComponent.prototype.fields;
    /** @type {?} */
    SearchBoxComponent.prototype.maxSearchFields;
    /** @type {?} */
    SearchBoxComponent.prototype.condition;
    /**
     * 启用 任意字段
     * @type {?}
     */
    SearchBoxComponent.prototype.useAnyField;
    /** @type {?} */
    SearchBoxComponent.prototype.container;
    /** @type {?} */
    SearchBoxComponent.prototype.input;
    /** @type {?} */
    SearchBoxComponent.prototype.shadowBox;
    /** @type {?} */
    SearchBoxComponent.prototype.input2;
    /** @type {?} */
    SearchBoxComponent.prototype.conditionChange;
    /** @type {?} */
    SearchBoxComponent.prototype.clear;
    /** @type {?} */
    SearchBoxComponent.prototype.escHandler;
    /**
     * 启用漂浮，false: 内容会撑高容器； true：固定高度26px，点击或滑过时，显示完整内容，失去焦点后，返回固定状态
     * @type {?}
     */
    SearchBoxComponent.prototype.enableFloat;
    /** @type {?} */
    SearchBoxComponent.prototype.displayTextList;
    /** @type {?} */
    SearchBoxComponent.prototype.filterConditions;
    /** @type {?} */
    SearchBoxComponent.prototype.hiddenItemsCount$;
    /** @type {?} */
    SearchBoxComponent.prototype.onModelChange;
    /** @type {?} */
    SearchBoxComponent.prototype.onModelTouched;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2VhcmNoLWJveC5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZmFycmlzL3VpLXNlYXJjaC1ib3gvIiwic291cmNlcyI6WyJsaWIvc2VhcmNoLWJveC5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQSxPQUFPLEVBQWlCLGlCQUFpQixFQUFFLFNBQVMsRUFBRSxVQUFVLEVBQUUsWUFBWSxFQUFFLFVBQVUsRUFBNkIsUUFBUSxFQUFFLEtBQUssRUFBZ0MsUUFBUSxFQUFFLE1BQU0sRUFBNEIsU0FBUyxFQUFFLGlCQUFpQixFQUFFLE1BQU0sZUFBZSxDQUFDO0FBQ3RRLE9BQU8sRUFBZSxvQkFBb0IsRUFBRSxNQUFNLG1CQUFtQixDQUFDO0FBQ3RFLE9BQU8sRUFBRSxtQkFBbUIsRUFBRSxNQUFNLHdCQUF3QixDQUFDO0FBQzdELE9BQU8sRUFBRSxPQUFPLEVBQW1CLGNBQWMsRUFBRSxNQUFNLHlCQUF5QixDQUFDO0FBRW5GLE9BQU8sRUFBRSxPQUFPLEVBQUUsTUFBTSxXQUFXLENBQUM7QUFDcEMsT0FBTyxFQUF3QixpQkFBaUIsRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBQ3pFLE9BQU8sRUFBRSxlQUFlLEVBQU0sTUFBTSxNQUFNLENBQUM7QUFDM0MsT0FBTyxFQUFFLGFBQWEsRUFBRSxNQUFNLG1CQUFtQixDQUFDOztBQUdsRCxNQUFNLEtBQU8seUJBQXlCLEdBQVE7SUFDMUMsT0FBTyxFQUFFLGlCQUFpQjtJQUMxQixXQUFXLEVBQUUsVUFBVTs7O0lBQUMsY0FBTSxPQUFBLGtCQUFrQixFQUFsQixDQUFrQixFQUFDO0lBQ2pELEtBQUssRUFBRSxJQUFJO0NBQ2Q7QUFDRDtJQVF3Qyw4Q0FBYTtJQTZCakQsNEJBQVksRUFBYyxFQUFFLFFBQWtCLEVBQWMsY0FBb0MsRUFBRSxFQUFxQjtRQUF2SCxZQUNHLGtCQUFNLEVBQUUsRUFBRSxRQUFRLEVBQUUsY0FBYyxFQUFFLEVBQUUsQ0FBQyxTQUN6QztRQTdCUSxZ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Q0FHckIsTUFBTTt3QkFDTixNQUFNOzZCQUNOLE1BQU07O0lBOFRYLHlCQUFDO0NBQUEsQUExVkQsQ0FRd0MsYUFBYSxHQWtWcEQ7U0FsVlksa0JBQWtCOzs7SUFFM0Isb0NBQXlDOztJQUN6Qyw2Q0FBNkI7O0lBQzdCLHVDQUFnRDs7Ozs7SUFHaEQseUNBQTRCOztJQUc1Qix1Q0FBOEM7O0lBQzlDLG1DQUFrRDs7SUFHbEQsdUNBQStDOztJQUMvQyxvQ0FBb0Q7O0lBR3BELDZDQUErQzs7SUFDL0MsbUNBQXFDOztJQUNyQyx3Q0FBMEM7Ozs7O0lBRTFDLHlDQUFtQjs7SUFFbkIsNkNBQXlDOztJQUN6Qyw4Q0FBK0M7O0lBRS9DLCtDQUEyQzs7SUFrRDNDLDJDQUFrQzs7SUFDbEMsNENBQW1DIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQWZ0ZXJWaWV3SW5pdCwgQ2hhbmdlRGV0ZWN0b3JSZWYsIENvbXBvbmVudCwgRWxlbWVudFJlZiwgRXZlbnRFbWl0dGVyLCBmb3J3YXJkUmVmLCBIb3N0QmluZGluZywgSG9zdExpc3RlbmVyLCBJbmplY3RvciwgSW5wdXQsIE9uQ2hhbmdlcywgT25EZXN0cm95LCBPbkluaXQsIE9wdGlvbmFsLCBPdXRwdXQsIFJlbmRlcmVyMiwgU2ltcGxlQ2hhbmdlcywgVmlld0NoaWxkLCBWaWV3RW5jYXBzdWxhdGlvbiB9IGZyb20gXCJAYW5ndWxhci9jb3JlXCI7XHJcbmltcG9ydCB7IENvbW1vblV0aWxzLCBPdmVyTGF5SGlkZGVuU2VydmljZSB9IGZyb20gXCJAZmFycmlzL3VpLWNvbW1vblwiO1xyXG5pbXBvcnQgeyBJbnB1dEdyb3VwQ29tcG9uZW50IH0gZnJvbSBcIkBmYXJyaXMvdWktaW5wdXQtZ3JvdXBcIjtcclxuaW1wb3J0IHsgQ29tcGFyZSwgRmlsdGVyQ29uZGl0aW9uLCBGaWx0ZXJSZWxhdGlvbiB9IGZyb20gXCJAZmFycmlzL3VpLWNvbW1vbi90eXBlc1wiO1xyXG5pbXBvcnQgeyBEaXNwbGF5VGV4dCwgU2VhcmNoRmllbGQsIFNlYXJjaEZpZWxkVmFsdWUgfSBmcm9tIFwiLi9zZWFyY2gtYm94LnR5cGVzXCI7XHJcbmltcG9ydCB7IGZsYXR0ZW4gfSBmcm9tICdsb2Rhc2gtZXMnO1xyXG5pbXBvcnQgeyBDb250cm9sVmFsdWVBY2Nlc3NvciwgTkdfVkFMVUVfQUNDRVNTT1IgfSBmcm9tIFwiQGFuZ3VsYXIvZm9ybXNcIjtcclxuaW1wb3J0IHsgQmVoYXZpb3JTdWJqZWN0LCBvZiB9IGZyb20gXCJyeGpzXCI7XHJcbmltcG9ydCB7IFNlYXJjaEJveEJhc2UgfSBmcm9tIFwiLi9zZWFyY2gtYm94LWJhc2VcIjtcclxuXHJcblxyXG5leHBvcnQgY29uc3QgU0VBUkNIX0JPWF9WQUxVRV9BQ0NFU1NPUjogYW55ID0ge1xyXG4gICAgcHJvdmlkZTogTkdfVkFMVUVfQUNDRVNTT1IsXHJcbiAgICB1c2VFeGlzdGluZzogZm9yd2FyZFJlZigoKSA9PiBTZWFyY2hCb3hDb21wb25lbnQpLFxyXG4gICAgbXVsdGk6IHRydWVcclxufTtcclxuQENvbXBvbmVudCh7XHJcbiAgICBzZWxlY3RvcjogXCJmYXJyaXMtc2VhcmNoLWJveFwiLFxyXG4gICAgdGVtcGxhdGVVcmw6ICcuL3NlYXJjaC1ib3guY29tcG9uZW50Lmh0bWwnLFxyXG4gICAgZW5jYXBzdWxhdGlvbjogVmlld0VuY2Fwc3VsYXRpb24uTm9uZSxcclxuICAgIHByb3ZpZGVyczogW1xyXG4gICAgICAgIFNFQVJDSF9CT1hfVkFMVUVfQUNDRVNTT1JcclxuICAgIF1cclxufSlcclxuZXhwb3J0IGNsYXNzIFNlYXJjaEJveENvbXBvbmVudCBleHRlbmRzIFNlYXJjaEJveEJhc2UgaW1wbGVtZW50cyBPbkluaXQsIE9uQ2hhbmdlcywgQ29udHJvbFZhbHVlQWNjZXNzb3IsIEFmdGVyVmlld0luaXQsIE9uRGVzdHJveSB7XHJcblxyXG4gICAgQElucHV0KCkgZmllbGRzOiBBcnJheTxTZWFyY2hGaWVsZD4gPSBbXTtcclxuICAgIEBJbnB1dCgpIG1heFNlYXJjaEZpZWxkcyA9IDU7XHJcbiAgICBASW5wdXQoKSBjb25kaXRpb246IEFycmF5PEZpbHRlckNvbmRpdGlvbj4gPSBbXTtcclxuXHJcbiAgICAvKiog5ZCv55SoIOS7u+aEj+Wtl+autSAqL1xyXG4gICAgQElucHV0KCkgdXNlQW55RmllbGQgPSB0cnVlO1xyXG4gICAgXHJcblxyXG4gICAgQFZpZXdDaGlsZCgnc2VhcmNoYm94JykgY29udGFpbmVyOiBFbGVtZW50UmVmO1xyXG4gICAgQFZpZXdDaGlsZCgndGFnSW5wdXQnKSBpbnB1dDogSW5wdXRHcm91cENvbXBvbmVudDtcclxuXHJcblxyXG4gICAgQFZpZXdDaGlsZCgnc2VhcmNoYm94MicpIHNoYWRvd0JveDogRWxlbWVudFJlZjtcclxuICAgIEBWaWV3Q2hpbGQoJ3RhZ0lucHV0MicpIGlucHV0MjogSW5wdXRHcm91cENvbXBvbmVudDtcclxuXHJcblxyXG4gICAgQE91dHB1dCgpIGNvbmRpdGlvbkNoYW5nZSA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcclxuICAgIEBPdXRwdXQoKSBjbGVhciA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcclxuICAgIEBPdXRwdXQoKSBlc2NIYW5kbGVyID0gbmV3IEV2ZW50RW1pdHRlcigpO1xyXG4gICAgLyoqIOWQr+eUqOa8gua1ru+8jGZhbHNlOiDlhoXlrrnkvJrmkpHpq5jlrrnlmajvvJsgdHJ1Ze+8muWbuuWumumrmOW6pjI2cHjvvIzngrnlh7vmiJbmu5Hov4fml7bvvIzmmL7npLrlrozmlbTlhoXlrrnvvIzlpLHljrvnhKbngrnlkI7vvIzov5Tlm57lm7rlrprnirbmgIEgKi9cclxuICAgIGVuYWJsZUZsb2F0ID0gdHJ1ZTtcclxuXHJcbiAgICBkaXNwbGF5VGV4dExpc3Q6IEFycmF5PERpc3BsYXlUZXh0PiA9IFtdO1xyXG4gICAgZmlsdGVyQ29uZGl0aW9uczogQXJyYXk8U2VhcmNoRmllbGRWYWx1ZT4gPSBbXTtcclxuXHJcbiAgICBoaWRkZW5JdGVtc0NvdW50JCA9IG5ldyBCZWhhdmlvclN1YmplY3QoMCk7XHJcblxyXG4gICAgY29uc3RydWN0b3IoZWw6IEVsZW1lbnRSZWYsIGluamVjdG9yOiBJbmplY3RvciwgQE9wdGlvbmFsKCkgb3ZlckxheVNlcnZpY2U6IE92ZXJMYXlIaWRkZW5TZXJ2aWNlLCBjZDogQ2hhbmdlRGV0ZWN0b3JSZWYpIHtcclxuICAgICAgIHN1cGVyKGVsLCBpbmplY3Rvciwgb3ZlckxheVNlcnZpY2UsIGNkKTtcclxuICAgIH1cclxuXHJcbiAgICBuZ09uSW5pdCgpIHtcclxuICAgIH1cclxuXHJcbiAgICBuZ0FmdGVyVmlld0luaXQoKTogdm9pZCB7XHJcbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMubW92ZVNoYWRvd1RvQm9keSgpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBuZ09uQ2hhbmdlcyhjaGFuZ2VzOiBTaW1wbGVDaGFuZ2VzKSB7XHJcbiAgICB9XHJcblxyXG4gICAgbmdPbkRlc3Ryb3koKSB7XHJcbiAgICAgICAgaWYgKHRoaXMub3ZlckxheVNlcnZpY2UpIHtcclxuICAgICAgICAgICAgdGhpcy5vdmVyTGF5U2VydmljZS5kZXN0b3J5KHRoaXMuc2hhZG93Qm94Lm5hdGl2ZUVsZW1lbnQpO1xyXG4gICAgICAgICAgICB0aGlzLm92ZXJMYXlTZXJ2aWNlID0gbnVsbDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICh0aGlzLnNoYWRvd0JveCkge1xyXG4gICAgICAgICAgICB0aGlzLnNoYWRvd0JveC5uYXRpdmVFbGVtZW50LnJlbW92ZSgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHRoaXNbJ1JFTU9WRV9JVEVNX1RJTUVSJ10pIHtcclxuICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHRoaXNbJ1JFTU9WRV9JVEVNX1RJTUVSJ10pO1xyXG4gICAgICAgICAgICB0aGlzWydSRU1PVkVfSVRFTV9USU1FUiddID0gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgb25CbHVyKCRldmVudCkge1xyXG4gICAgICAgIGlmICh0aGlzLmVuYWJsZUZsb2F0KSB7XHJcbiAgICAgICAgICAgIGlmICghdGhpcy5pbnB1dDIudmFsdWUpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMudG9nZ2xlU2hhZG93Qm94KGZhbHNlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBvbklucHV0Q2xpY2soJGV2ZW50KSB7XHJcbiAgICAgICAgaWYgKHRoaXMuZW5hYmxlRmxvYXQpIHtcclxuICAgICAgICAgICAgdGhpcy50b2dnbGVTaGFkb3dCb3goKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG5cclxuICAgIG9uTW9kZWxDaGFuZ2UgPSAoYXJyOiBhbnkpID0+IHsgfTtcclxuICAgIG9uTW9kZWxUb3VjaGVkID0gKGFycjogYW55KSA9PiB7IH07XHJcblxyXG4gICAgcHJpdmF0ZSBmaWx0ZXJDaGFuZ2VkKCkge1xyXG4gICAgICAgIGNvbnN0IGNvbmRpdGlvbnMgPSB0aGlzLmZpbHRlckNvbmRpdGlvbnMuZmlsdGVyKG4gPT4gbi5jb2RlICE9PSAnKicpLm1hcChcclxuICAgICAgICAgICAgKG4sIGkpID0+IHtcclxuICAgICAgICAgICAgICAgIGlmIChuLnZhbHVlLnRyaW0oKS5pbmRleE9mKCcgJykgPiAtMSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHNlYXJjaEtleXMgPSBBcnJheS5mcm9tKG5ldyBTZXQobi52YWx1ZS50cmltKCkuc3BsaXQoJyAnKS5maWx0ZXIobiA9PiBuLnRyaW0oKSkpKTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gc2VhcmNoS2V5cy5tYXAoKHMsIGopID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbHRlckZpZWxkOiBuLmNvZGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogcyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxicmFja2V0OiBqID09IDA/ICcoJzogICcnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmJyYWNrZXQ6IGogPT0gc2VhcmNoS2V5cy5sZW5ndGggLSAxID8gJyknIDogJycsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWxhdGlvbjogaiA9PSBzZWFyY2hLZXlzLmxlbmd0aCAtIDEgPyAxIDogMixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbXBhcmU6IDYsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICAgICAgZmlsdGVyRmllbGQ6IG4uY29kZSxcclxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogbi52YWx1ZSxcclxuICAgICAgICAgICAgICAgICAgICBsYnJhY2tldDogJycsXHJcbiAgICAgICAgICAgICAgICAgICAgcmJyYWNrZXQ6ICcnLFxyXG4gICAgICAgICAgICAgICAgICAgIHJlbGF0aW9uOiBpID09IHRoaXMuZmlsdGVyQ29uZGl0aW9ucy5sZW5ndGggLTEgPyAwIDogMSxcclxuICAgICAgICAgICAgICAgICAgICBjb21wYXJlOiA2LFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgKTtcclxuXHJcbiAgICAgICAgbGV0IF9jb25kaXRpb25zID0gW107XHJcbiAgICAgICAgX2NvbmRpdGlvbnMgPSB0aGlzLmV4cGFuZFN0YXJGaWVsZFRvQWxsRmllbGRzKCkuY29uY2F0KGZsYXR0ZW4oY29uZGl0aW9ucykpO1xyXG4gICAgICAgIGlmIChjb25kaXRpb25zICYmIGNvbmRpdGlvbnMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIF9jb25kaXRpb25zW19jb25kaXRpb25zLmxlbmd0aCAtIDFdLnJlbGF0aW9uID0gMDtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5vbk1vZGVsQ2hhbmdlKHRoaXMuZmlsdGVyQ29uZGl0aW9ucyk7XHJcbiAgICAgICAgdGhpcy5vbk1vZGVsVG91Y2hlZCh0aGlzLmZpbHRlckNvbmRpdGlvbnMpO1xyXG5cclxuXHJcbiAgICAgICAgaWYgKCFfY29uZGl0aW9ucy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgdGhpcy5jb25kaXRpb25DaGFuZ2UuZW1pdCh0aGlzLmZpbHRlckNvbmRpdGlvbnMpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuY29uZGl0aW9uQ2hhbmdlLmVtaXQoX2NvbmRpdGlvbnMpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBleHBhbmRTdGFyRmllbGRUb0FsbEZpZWxkcygpIHtcclxuICAgICAgICBjb25zdCBpdGVtID0gdGhpcy5maWx0ZXJDb25kaXRpb25zLmZpbmQobiA9PiBuLmNvZGUgPT09ICcqJyk7XHJcbiAgICAgICAgaWYgKCFpdGVtKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBbXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3Qgc2VhcmNoS2V5cyA9IEFycmF5LmZyb20obmV3IFNldChpdGVtLnZhbHVlLnRyaW0oKS5zcGxpdCgnICcpLmZpbHRlcihuID0+IG4udHJpbSgpKSkpO1xyXG4gICAgICAgIGNvbnN0IGNvbmRpdGlvbnMgPSB0aGlzLmZpZWxkcy5maWx0ZXIobiA9PiBuLmNvZGUgIT09ICcqJykubWFwKChuOiBTZWFyY2hGaWVsZCwgaSkgPT4ge1xyXG4gICAgICAgICAgICByZXR1cm4gc2VhcmNoS2V5cy5tYXAoKHMsIGopID0+IHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICAgICAgZmlsdGVyRmllbGQ6IG4uY29kZSxcclxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogcyxcclxuICAgICAgICAgICAgICAgICAgICBsYnJhY2tldDogJycsXHJcbiAgICAgICAgICAgICAgICAgICAgcmJyYWNrZXQ6ICcnLFxyXG4gICAgICAgICAgICAgICAgICAgIHJlbGF0aW9uOiBGaWx0ZXJSZWxhdGlvbi5PcixcclxuICAgICAgICAgICAgICAgICAgICBjb21wYXJlOiBDb21wYXJlLkxpa2UsXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBsZXQgX2NvbmRpdGlvbnMgPSBbXTtcclxuICAgICAgICBpZiAoY29uZGl0aW9ucyAmJiBjb25kaXRpb25zLmxlbmd0aCkge1xyXG4gICAgICAgICAgICBfY29uZGl0aW9ucyA9IGZsYXR0ZW4oY29uZGl0aW9ucylcclxuICAgICAgICAgICAgX2NvbmRpdGlvbnNbMF0ubGJyYWNrZXQgPSAnKCdcclxuICAgICAgICAgICAgX2NvbmRpdGlvbnNbX2NvbmRpdGlvbnMubGVuZ3RoIC0gMV0ucmJyYWNrZXQgPSAnKSdcclxuICAgICAgICAgICAgX2NvbmRpdGlvbnNbX2NvbmRpdGlvbnMubGVuZ3RoIC0gMV0ucmVsYXRpb24gPSB0aGlzLmZpbHRlckNvbmRpdGlvbnMuZmlsdGVyKG4gPT4gbi5jb2RlICE9PScqJykubGVuZ3RoID8gMSA6IDA7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gX2NvbmRpdGlvbnM7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBpbml0RGlzbGF5VGV4dChlbWl0ID0gdHJ1ZSkge1xyXG4gICAgICAgIGNvbnN0IHJlbGF0aW9uU3RyID0gdGhpcy5sb2NhbGVTZXIuZ2V0VmFsdWUoJ3NlYXJjaGJveC5yZWxhdGlvbi5vcicpO1xyXG4gICAgICAgIHRoaXMuZGlzcGxheVRleHRMaXN0ID0gdGhpcy5maWx0ZXJDb25kaXRpb25zLm1hcCgodDogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IG4gPSB7Li4udH07XHJcbiAgICAgICAgICAgIC8vIC5tYXAobiA9PiBg4oCcJHtufeKAnWApXHJcbiAgICAgICAgICAgIGNvbnN0IHZhbHVlcyA9ICBuLnZhbHVlLnRyaW0oKS5zcGxpdCgnICcpLmZpbHRlcihuID0+IG4udHJpbSgpKTtcclxuICAgICAgICAgICAgbi5kaXNsYXlUZXh0ID0gbi5uYW1lICsgJ++8micgKyB2YWx1ZXMuam9pbihgICR7IHJlbGF0aW9uU3RyIH0gYCk7XHJcbiAgICAgICAgICAgIG4uZGlzcGxheUh0bWwgPSBuLm5hbWUgKyAn77yaJyArIHZhbHVlcy5qb2luKGA8c3BhbiBjbGFzcz1cInRleHQtbXV0ZWQgZm9udC1pdGFsaWMgbXgtMSBvclwiPiR7cmVsYXRpb25TdHJ9PC9zcGFuPmApO1xyXG4gICAgICAgICAgICByZXR1cm4gbjtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmVuYWJsZUZsb2F0KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNldEhpZGRlbkNvdW50KCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLmNkLmRldGVjdENoYW5nZXMoKTtcclxuICAgICAgICBpZiAoZW1pdCkge1xyXG4gICAgICAgICAgICB0aGlzLmZpbHRlckNoYW5nZWQoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgc2VsZWN0KHNlYXJjaERhdGE6IGFueSkge1xyXG4gICAgICAgIGNvbnN0IGNvbmRpdGlvbiA9IHRoaXMuZmlsdGVyQ29uZGl0aW9ucy5maW5kKG4gPT4gbi5jb2RlID09PSBzZWFyY2hEYXRhLmNvZGUpO1xyXG4gICAgICAgIGlmIChjb25kaXRpb24pIHtcclxuICAgICAgICAgICAgY29uZGl0aW9uLnZhbHVlID0gY29uZGl0aW9uLnZhbHVlLnRyaW0oKSArICcgJyArIHNlYXJjaERhdGEudmFsdWU7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5maWx0ZXJDb25kaXRpb25zLnB1c2goc2VhcmNoRGF0YSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuaW5pdERpc2xheVRleHQoKTtcclxuXHJcbiAgICAgICAgdGhpcy5pbnB1dC52YWx1ZSA9ICcnO1xyXG4gICAgfVxyXG5cclxuICAgIHJlbW92ZShmaWVsZDogc3RyaW5nKSB7XHJcbiAgICAgICAgdGhpcy5maWx0ZXJDb25kaXRpb25zID0gdGhpcy5maWx0ZXJDb25kaXRpb25zLmZpbHRlcihuID0+IG4uY29kZSAhPT0gZmllbGQpXHJcbiAgICAgICAgdGhpcy5pbml0RGlzbGF5VGV4dChmYWxzZSk7XHJcblxyXG4gICAgICAgIHRoaXMuX2VtaXRGaWx0ZXJDaGFuZ2VkKCk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBfZW1pdEZpbHRlckNoYW5nZWQoKSB7XHJcbiAgICAgICAgaWYgKHRoaXNbJ1JFTU9WRV9JVEVNX1RJTUVSJ10pIHtcclxuICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHRoaXNbJ1JFTU9WRV9JVEVNX1RJTUVSJ10pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpc1snUkVNT1ZFX0lURU1fVElNRVInXSA9IHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLmZpbHRlckNoYW5nZWQoKTtcclxuICAgICAgICB9LCAxODApO1xyXG4gICAgfVxyXG5cclxuICAgIG9uUmVtb3ZlSXRlbSgkZXZlbnQsIGl0ZW0pIHtcclxuICAgICAgICAkZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgdGhpcy5maWx0ZXJDb25kaXRpb25zID0gdGhpcy5maWx0ZXJDb25kaXRpb25zLmZpbHRlcihuID0+IG4uY29kZSAhPT0gaXRlbS5jb2RlKTtcclxuICAgICAgICB0aGlzLmluaXREaXNsYXlUZXh0KCk7XHJcbiAgICAgICAgXHJcbiAgICB9XHJcblxyXG4gICAgY2xlYXJDb25kaXRpb25zKGVtaXQgPSB0cnVlKSB7XHJcbiAgICAgICAgdGhpcy5pbnB1dC52YWx1ZSA9ICcnO1xyXG4gICAgICAgIHRoaXMuZGlzcGxheVRleHRMaXN0ID0gW107XHJcbiAgICAgICAgdGhpcy5maWx0ZXJDb25kaXRpb25zID0gW107XHJcbiAgICAgICAgdGhpcy5zZXRIaWRkZW5Db3VudCgpO1xyXG4gICAgICAgIGlmIChlbWl0KSB7XHJcbiAgICAgICAgICAgIHRoaXMuY29uZGl0aW9uQ2hhbmdlLmVtaXQoW10pO1xyXG4gICAgICAgICAgICB0aGlzLmNsZWFyLmVtaXQoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgb25TdWJtaXQoJGV2ZW50KSB7XHJcbiAgICAgICAgJGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgIHRoaXMuaW5wdXQudmFsdWUgPSAnJztcclxuICAgICAgICB0aGlzLnRvZ2dsZVNoYWRvd0JveChmYWxzZSk7XHJcbiAgICAgICAgdGhpcy5fZW1pdEZpbHRlckNoYW5nZWQoKTtcclxuICAgIH1cclxuXHJcbiAgICB3cml0ZVZhbHVlKG9iajogYW55KTogdm9pZCB7XHJcbiAgICAgICAgbGV0IGFyciA9IG9iajtcclxuICAgICAgICBpZiAoIUFycmF5LmlzQXJyYXkob2JqKSkge1xyXG4gICAgICAgICAgICBhcnIgPSBbXTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuZmlsdGVyQ29uZGl0aW9ucyA9IGFycjtcclxuICAgICAgICB0aGlzLmluaXREaXNsYXlUZXh0KCk7XHJcbiAgICB9XHJcblxyXG4gICAgcmVnaXN0ZXJPbkNoYW5nZShmbjogYW55KTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy5vbk1vZGVsQ2hhbmdlID0gZm47XHJcbiAgICB9XHJcblxyXG4gICAgcmVnaXN0ZXJPblRvdWNoZWQoZm46IGFueSk6IHZvaWQge1xyXG4gICAgICAgIHRoaXMub25Nb2RlbFRvdWNoZWQgPSBmbjtcclxuICAgIH1cclxuXHJcbiAgICBzZXRWYWx1ZShhcnI6IEFycmF5PFNlYXJjaEZpZWxkVmFsdWU+LCBlbWl0ID0gdHJ1ZSkge1xyXG4gICAgICAgIHRoaXMuZmlsdGVyQ29uZGl0aW9ucyA9IGFycjtcclxuICAgICAgICB0aGlzLmluaXREaXNsYXlUZXh0KGVtaXQpO1xyXG4gICAgfVxyXG5cclxuICAgIHVwZGF0ZVNoYWRvd0JveFBvc2l0aW9uKHt0b3AsIGxlZnQsIHdpZHRofSA9IHt0b3A6IG51bGwsIGxlZnQ6IG51bGwsIHdpZHRoOiBudWxsfSkge1xyXG4gICAgICAgIGlmICghdG9wICYmICFsZWZ0ICYmICF3aWR0aCkge1xyXG4gICAgICAgICAgICBjb25zdCBlID0gdGhpcy5lbC5uYXRpdmVFbGVtZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xyXG4gICAgICAgICAgICB0b3AgPSBlLnRvcDtcclxuICAgICAgICAgICAgbGVmdCA9IGUubGVmdDtcclxuICAgICAgICAgICAgd2lkdGggPSBlLndpZHRoO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnJlbmRlci5zZXRTdHlsZSh0aGlzLnNoYWRvd0JveC5uYXRpdmVFbGVtZW50LCAnbGVmdCcsIGxlZnQgKyAncHgnKTtcclxuICAgICAgICB0aGlzLnJlbmRlci5zZXRTdHlsZSh0aGlzLnNoYWRvd0JveC5uYXRpdmVFbGVtZW50LCAndG9wJywgdG9wICsgJ3B4Jyk7XHJcbiAgICAgICAgdGhpcy5yZW5kZXIuc2V0U3R5bGUodGhpcy5zaGFkb3dCb3gubmF0aXZlRWxlbWVudCwgJ3dpZHRoJywgd2lkdGggKyAncHgnKTtcclxuXHJcbiAgICAgICAgdGhpcy5yZW5kZXIuc2V0U3R5bGUodGhpcy5zaGFkb3dCb3gubmF0aXZlRWxlbWVudCwgJ3pJbmRleCcsIHRoaXMuY29tbW9uVXRpbHMuZ2V0RmxvYXRpbmdMYXllckluZGV4KCkpO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgbW92ZVNoYWRvd1RvQm9keSgpIHtcclxuICAgICAgICBpZiAoIXRoaXMuZW5hYmxlRmxvYXQpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnVwZGF0ZVNoYWRvd0JveFBvc2l0aW9uKCk7XHJcbiAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmQodGhpcy5zaGFkb3dCb3gubmF0aXZlRWxlbWVudCk7XHJcblxyXG4gICAgICAgIHRoaXMub3ZlckxheVNlcnZpY2UucmVnaXN0ZXJNb3VzZUV2ZW50KHRoaXMuc2hhZG93Qm94Lm5hdGl2ZUVsZW1lbnQsIChlKSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChlLnRhcmdldCAmJiBlLnRhcmdldC5jbGFzc05hbWUuaW5kZXhPZignc2VhcmNoLWJveF9kZWxldGUta2V5cycpID4gLTEpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKGUudGFyZ2V0ID09PSB0aGlzLmlucHV0Mi50ZXh0Ym94Lm5hdGl2ZUVsZW1lbnQgfHwgIXRoaXMuc2hhZG93Qm94IHx8IHRoaXMuc2hhZG93Qm94Lm5hdGl2ZUVsZW1lbnQuY29udGFpbnMoZS50YXJnZXQpIHx8IFxyXG4gICAgICAgICAgICBlLnRhcmdldFsnY2xvc2VzdCddKCcuZi1zZWFyY2gtYm94LXBhbmVsJykpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdGhpcy50b2dnbGVTaGFkb3dCb3goZmFsc2UpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICB0b2dnbGVTaGFkb3dCb3goc2hvdyA9IHRydWUpIHtcclxuICAgICAgICBpZiAoIXRoaXMuZW5hYmxlRmxvYXQgfHwgKCghdGhpcy5maWVsZHMgfHwgIXRoaXMuZmllbGRzLmxlbmd0aCkgJiYgIXRoaXMudXNlQW55RmllbGQpKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHNob3cpIHtcclxuICAgICAgICAgICAgdGhpcy51cGRhdGVTaGFkb3dCb3hQb3NpdGlvbigpO1xyXG4gICAgICAgICAgICB0aGlzLnJlbmRlci5yZW1vdmVTdHlsZSh0aGlzLnNoYWRvd0JveC5uYXRpdmVFbGVtZW50LCAnZGlzcGxheScpO1xyXG4gICAgICAgICAgICB0aGlzLmNvbnRhaW5lci5uYXRpdmVFbGVtZW50LnN0eWxlLnZpc2liaWxpdHkgPSAnaGlkZGVuJztcclxuICAgICAgICAgICAgdGhpcy5pbnB1dDIuZm9jdXMoKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLmNvbnRhaW5lci5uYXRpdmVFbGVtZW50LnN0eWxlLnZpc2liaWxpdHkgPSAndmlzaWJsZSc7XHJcbiAgICAgICAgICAgIHRoaXMucmVuZGVyLnNldFN0eWxlKHRoaXMuc2hhZG93Qm94Lm5hdGl2ZUVsZW1lbnQsICdkaXNwbGF5JywgJ25vbmUnKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgb25TaGFkb3dCb3hDbGljaygkZXZlbnQ6IE1vdXNlRXZlbnQpIHtcclxuICAgICAgICAkZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgaWYgKHRoaXMuZW5hYmxlRmxvYXQpIHtcclxuICAgICAgICAgICAgdGhpcy5pbnB1dDIuZm9jdXMoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgb25SZXNpemVkKCRldmVudCkge1xyXG4gICAgICAgIGlmICh0aGlzLmVuYWJsZUZsb2F0KSB7XHJcbiAgICAgICAgICAgIHRoaXMudXBkYXRlU2hhZG93Qm94UG9zaXRpb24oJGV2ZW50KTtcclxuICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNldEhpZGRlbkNvdW50KCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNkLmRldGVjdENoYW5nZXMoKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgc2V0SGlkZGVuQ291bnQoKSB7XHJcbiAgICAgICAgbGV0IGxlbiA9IDA7XHJcbiAgICAgICAgaWYgKCF0aGlzLmRpc3BsYXlUZXh0TGlzdCB8fCAhdGhpcy5kaXNwbGF5VGV4dExpc3QubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIHRoaXMuaGlkZGVuSXRlbXNDb3VudCQubmV4dChsZW4pO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IGl0ZW1zID0gQXJyYXkuZnJvbSh0aGlzLmNvbnRhaW5lci5uYXRpdmVFbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ3NwYW4uc2VhcmNoLXRhZy1pdGVtJykpO1xyXG4gICAgICAgIGlmIChpdGVtcyAmJiBpdGVtcy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgbGVuID0gaXRlbXMubWFwKChuOiBhbnkpID0+IHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBuLm9mZnNldFRvcDtcclxuICAgICAgICAgICAgfSkuZmlsdGVyKG4gPT4gbiA+IDIwKS5sZW5ndGhcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5oaWRkZW5JdGVtc0NvdW50JC5uZXh0KGxlbik7XHJcbiAgICB9XHJcblxyXG4gICAgb25Fc2MoJGV2ZW50KSB7XHJcbiAgICAgICAgdGhpcy5lc2NIYW5kbGVyLmVtaXQoJGV2ZW50KTtcclxuICAgIH1cclxufVxyXG4iXX0=