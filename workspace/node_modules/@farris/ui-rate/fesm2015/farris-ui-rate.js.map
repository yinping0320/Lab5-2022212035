{"version":3,"file":"farris-ui-rate.js.map","sources":["ng://@farris/ui-rate/lib/rate.component.ts","ng://@farris/ui-rate/lib/rate.module.ts"],"sourcesContent":["import { Component, OnInit, HostBinding, Input, HostListener, Output, EventEmitter } from '@angular/core';\r\n\r\n@Component({\r\n    selector: 'farris-rate',\r\n    templateUrl: './rate.component.html',\r\n    styleUrls: ['./rate.component.css']\r\n})\r\nexport class RateComponent implements OnInit {\r\n\r\n    @HostBinding('class.farris-star-rating') fsr = true;\r\n    @Input() set value(value: any) {\r\n        this.realScore = value;\r\n    }\r\n    // ææå¤§å°\r\n    @Input() size = 'large';\r\n    // å¯ç¨åé¢ææ¨¡å¼\r\n    @Input() enableHalf = false;\r\n    // å¯ç¨åæ¬¡ç¹å»åæ¸é¤\r\n    @Input() enableClear = false;\r\n    // åªè¯»\r\n    @Input() disabled = false;\r\n    // åå¶\r\n    @Input() pointSystem = 5;\r\n    // ææäº®è²\r\n    @Input() lightColor: string;\r\n    // æææè²ï¼åºè²ï¼\r\n    @Input() darkColor: string;\r\n    // å¾æ¡æ ·å¼\r\n    @Input() iconClass = 'f-icon-star';\r\n\r\n    // ç¦ç¨åä¸ªææçæå­æç¤º\r\n    @Input() toolTipDisabled = true;\r\n    // é»è®¤çæ»¡æåº¦ææ¡\r\n    @Input() toolTipContents = ['å¾ä¸æ»¡æ', 'ä¸æ»¡æ', 'ä¸è¬', 'æ»¡æ', 'éå¸¸æ»¡æ'];\r\n    // å¯ç¨è¯å\r\n    @Input() enableScore = true;\r\n    // å¯ç¨æ»¡æåº¦\r\n    @Input() enableSatisfaction = false;\r\n    @Output() valueChange = new EventEmitter();\r\n    pointInfo: string;\r\n    // ä¸é¢æå®½åº¦\r\n    oneStarWidth: number;\r\n    // äº®è²åºåèæå®½åº¦\r\n    lightStarAreaWidth: number;\r\n    // çé¢ä¸­äº®è²åºåçå®å®½åº¦\r\n    realWidth = 0;\r\n    // èæåæ°\r\n    score: any = 0;\r\n    // æç»åæ°\r\n    realScore = 0;\r\n    // æ¯ç\r\n    rate = 1;\r\n    // åæ¢çæ»¡æåº¦\r\n    satisfaction: any;\r\n    // æç»æ¾ç¤ºçæ»¡æåº¦\r\n    realSatisfaction: any;\r\n    // éç½®\r\n    config = [];\r\n    // ææä¹é´çé´è·,è®¾è®¡ç¨¿æ¯4\r\n    distance = 4;\r\n    constructor() { }\r\n\r\n    ngOnInit() {\r\n        let starId: any;\r\n        switch (this.size) {\r\n            case 'small':\r\n                this.oneStarWidth = 14;\r\n                break;\r\n            case 'middle':\r\n                this.oneStarWidth = 16;\r\n                break;\r\n            case 'large':\r\n                this.oneStarWidth = 18;\r\n                break;\r\n        }\r\n        this.config = [\r\n            {\r\n                id: 1\r\n            },\r\n            {\r\n                id: 2\r\n            },\r\n            {\r\n                id: 3\r\n            },\r\n            {\r\n                id: 4\r\n            },\r\n            {\r\n                id: 5\r\n            }\r\n        ];\r\n        if (this.config.length) {\r\n            this.rate = this.pointSystem / this.config.length;\r\n        }\r\n        if (this.realScore) {\r\n            if (this.enableHalf) {\r\n                starId = Math.ceil(this.realScore / this.rate);\r\n            } else {\r\n                starId = this.realScore;\r\n            }\r\n            this.realWidth = (this.oneStarWidth * this.realScore + Math.floor(this.realScore) * this.distance) / this.rate;\r\n            this.satisfaction = this.toolTipContents[starId - 1]\r\n        }\r\n    }\r\n\r\n    @HostListener('mouseover', ['$event'])\r\n    onMouseOver(event: any) {\r\n        if (!this.isTargetElement(event.target)) {\r\n            return;\r\n        }\r\n        const id = parseInt(event.target.id);\r\n        this.operateStar(event, id, false);\r\n    }\r\n\r\n    @HostListener('mousemove', ['$event'])\r\n    onMouseMove(event: any) {\r\n        if (!this.isTargetElement(event.target)) {\r\n            return;\r\n        }\r\n        const id = parseInt(event.target.id);\r\n        this.operateStar(event, id, false);\r\n    }\r\n\r\n    @HostListener('mouseout', ['$event'])\r\n    onMouseOut(event: any) {\r\n        if (!this.isTargetElement(event.target)) {\r\n            return;\r\n        }\r\n        this.lightStarAreaWidth = 0;\r\n        this.score = 0;\r\n        this.satisfaction = null;\r\n    }\r\n\r\n    @HostListener('click', ['$event'])\r\n    onClick(event: any) {\r\n        if (!this.isTargetElement(event.target)) {\r\n            return;\r\n        }\r\n        const id = parseInt(event.target.id);\r\n        this.operateStar(event, id, true);\r\n    }\r\n\r\n    /**\r\n     * æ¯å¦æ¯ç®æ åç´ \r\n     * @param element \r\n     */\r\n    private isTargetElement(element: any) {\r\n        if (element.className.indexOf('f-icon') !== -1) {\r\n            return true;\r\n        } else {\r\n            return false;\r\n        }\r\n    }\r\n\r\n    /**\r\n     *  åæ¬¡ç¹å»åæ¶éä¸­\r\n     */\r\n    private clear() {\r\n        if (this.lightStarAreaWidth === this.realWidth && this.enableClear && this.realWidth !== 0) {\r\n            this.realWidth = 0;\r\n            this.realScore = 0;\r\n            this.realSatisfaction = null;\r\n            this.valueChange.emit(this.realScore);\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n    /**\r\n     * \r\n     * @param event äºä»¶\r\n     * @param id å½åææçid\r\n     * @param token æ¯å¦ç¹å»äºä»¶è§¦å\r\n     */\r\n    private operateStar(event: any, id: any, token: boolean) {\r\n        // ç¦ç¨\r\n        if (this.disabled) {\r\n            return;\r\n        }\r\n        // æ»¡æåº¦ææ¡\r\n        if (this.enableSatisfaction) {\r\n            this.satisfaction = this.toolTipContents[id - 1];\r\n        }\r\n        // å¦ææ»å¨çè·ç¦»å°äºä¸é¢ææä¸åçè·ç¦»ï¼æèè¶è¿ï¼\r\n        if (event.offsetX < this.oneStarWidth / 2 && this.enableHalf === true) {\r\n            this.lightStarAreaWidth = (this.oneStarWidth * id) - this.oneStarWidth / 2 + this.distance * (id - 1);\r\n            this.score = (this.rate * id) - this.rate / 2;\r\n            if (token === true) {\r\n                if (this.clear()) {\r\n                    return;\r\n                }\r\n                this.realScore = this.score;\r\n                this.valueChange.emit(this.realScore);\r\n                this.realWidth = this.lightStarAreaWidth;\r\n                this.realSatisfaction = this.satisfaction;\r\n            }\r\n        } else {\r\n            this.lightStarAreaWidth = this.oneStarWidth * id + this.distance * (id - 1);\r\n            this.score = this.rate * id;\r\n            if (token === true) {\r\n                if (this.clear()) {\r\n                    return;\r\n                }\r\n                this.realScore = this.score;\r\n                this.valueChange.emit(this.realScore);\r\n                this.realWidth = this.lightStarAreaWidth;\r\n                this.realSatisfaction = this.satisfaction;\r\n            }\r\n        }\r\n    }\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FarrisTooltipModule } from '@farris/ui-tooltip';\r\nimport { LocaleModule } from '@farris/ui-locale';\r\nimport { RateComponent } from './rate.component';\r\n\r\n@NgModule({\r\n  declarations: [RateComponent],\r\n  imports: [\r\n    CommonModule,\r\n    FarrisTooltipModule,\r\n    LocaleModule\r\n  ],\r\n  exports: [RateComponent]\r\n})\r\nexport class RateModule { }\r\n"],"names":[],"mappings":"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"}
