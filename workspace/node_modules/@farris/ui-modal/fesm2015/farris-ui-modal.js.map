{"version":3,"file":"farris-ui-modal.js.map","sources":["ng://@farris/ui-modal/lib/bs-modal-ref.service.ts","ng://@farris/ui-modal/lib/modal-options.class.ts","ng://@farris/ui-modal/lib/modal-backdrop.component.ts","ng://@farris/ui-modal/lib/modal-button.directive.ts","ng://@farris/ui-modal/lib/modal-container.component.ts","ng://@farris/ui-modal/lib/bs-modal.service.ts","ng://@farris/ui-modal/lib/modal-backdrop.options.ts","ng://@farris/ui-modal/lib/modal.directive.ts","ng://@farris/ui-modal/lib/modal.module.ts"],"sourcesContent":["import { ModalButtonDirective } from './modal-button.directive';\r\nimport { Injectable, ComponentRef, QueryList } from '@angular/core';\r\nimport { ModalContainerComponent } from './modal-container.component';\r\n\r\n@Injectable()\r\nexport class BsModalRef {\r\n  /**\r\n   * Reference to a component inside the modal. Null if modal's been created with TemplateRef\r\n   */\r\n  content?: any | null;\r\n\r\n  /**\r\n   * Hides the modal\r\n   */\r\n  close: (e?: any) => void = Function;\r\n\r\n  dialog?: ComponentRef<ModalContainerComponent> | null;\r\n\r\n  buttons?: QueryList<ModalButtonDirective>;\r\n}\r\n","import { Injectable, TemplateRef, EventEmitter } from '@angular/core';\r\nimport { Observable, of } from 'rxjs';\r\n\r\n@Injectable()\r\nexport class ModalOptions {\r\n    /**\r\n     *  Includes a modal-backdrop element. Alternatively,\r\n     *  specify static for a backdrop which doesn't close the modal on click.\r\n     */\r\n    backdrop?: boolean | 'static';\r\n    /**\r\n     * Closes the modal when escape key is pressed.\r\n     */\r\n    keyboard?: boolean;\r\n\r\n    focus?: boolean;\r\n    /**\r\n     * Shows the modal when initialized.\r\n     */\r\n    show?: boolean;\r\n    /**\r\n     * Ignore the backdrop click\r\n     */\r\n    ignoreBackdropClick?: boolean;\r\n    /**\r\n     * Css class for opened modal\r\n     */\r\n    class?: string;\r\n    /**\r\n     * Toggle animation\r\n     */\r\n    animated?: boolean;\r\n    /**\r\n     * Modal data\r\n     */\r\n    initialState?: object;\r\n    /**\r\n     * çªå£æ é¢\r\n     */\r\n    title: string;\r\n    /** æ é¢åå¾æ  */\r\n    iconCls?: string;\r\n\r\n    /** æ¾ç¤ºå¤´é¨ */\r\n    showHeader?: boolean;\r\n\r\n    /**\r\n     * æ¾ç¤ºå³é­æé®\r\n     */\r\n    showCloseButton?: boolean;\r\n    /**\r\n     * æ¾ç¤ºæå¤§åæé®\r\n     */\r\n    showMaxButton?: boolean;\r\n    /**\r\n     * æ¾ç¤ºæå°åæé®\r\n     */\r\n    showMinButton?: boolean;\r\n\r\n    /**\r\n     * çªå£å®½åº¦\r\n     */\r\n    width?: number;\r\n    /**\r\n     * çªå£é«åº¦\r\n     */\r\n    height?: number;\r\n\r\n    minWidth?: number;\r\n    minHeight?: number;\r\n    maxWidth?: number;\r\n    maxHeight?: number;\r\n    /** çªå£æ é¢æ é«åº¦ */\r\n    dialogHeaderHeight?: number;\r\n    /** çªå£æé®åºé«åº¦ */\r\n    dialogFooterHeight?: number;\r\n\r\n    dialogFooterStyles?: any;\r\n\r\n    /**\r\n     * æ¾ç¤ºæé®åº\r\n     */\r\n    showButtons?: boolean;\r\n    /** æé®å¯¹é½æ¹å¼ */\r\n    buttonAlign?: string;\r\n\r\n    /** æé®åè¡¨æ¨¡æ¿ */\r\n    buttons?: TemplateRef<any> | DialogButton[];\r\n\r\n    /** å¯ç¨ææ½åè½ */\r\n    draggable?: boolean;\r\n\r\n    /** å¯ç¨è°æ´å°ºå¯¸å¤§å° */\r\n    resizable?: boolean;\r\n\r\n    /** æ¯å¦å¯ç¨æ»å¨æ¡ */\r\n    enableScroll?: boolean;\r\n\r\n    beforeOpen?: () => Observable<boolean>;\r\n    beforeClose?: (modalRef: any, args?: any) => Observable<boolean>;\r\n    opened?: ( p?: {[key: string]: any }) => void;\r\n    closed?: (isCloseButtonClick: boolean | any, args?: any) => void;\r\n    okText?: string;\r\n    cancelText?: string;\r\n    /** å¼¹çªç±»åï¼defaultï¼å¼¹åºç»ä»¶ãæ¨¡æ¿ç­ï¼iframe,å¼¹åºiframe; ngFactory, å¼¹åºngFactory; */\r\n    dialogType?: string;\r\n    // çªå£éåºåå®¹èªå¨\r\n    fitContent?: boolean;\r\n    // çªå£åå®¹åºåæ¯å¦èªå¨ååºå¼\r\n    areaResponse?: boolean;\r\n    // å¼å¸¸æç¤º\r\n    exception?: {\r\n        date: string,\r\n        message: string\r\n    };\r\n   // æ¯å¦éæ¨¡æ\r\n   modeless?:boolean\r\n}\r\n\r\nexport interface DialogButton {\r\n    text: string;\r\n    cls?: string;\r\n    iconCls?: string;\r\n    disable?: boolean;\r\n    defaultFocus?: boolean;\r\n    handle?: (e) => any;\r\n    display?: boolean;\r\n    tipsEnable?: boolean;\r\n    tipsText?: string | ((e?: any) => string);\r\n}\r\n\r\nexport const modalConfigDefaults: ModalOptions = {\r\n    backdrop: 'static',\r\n    keyboard: true,\r\n    focus: true,\r\n    show: false,\r\n    ignoreBackdropClick: true,\r\n    class: '',\r\n    animated: true,\r\n    initialState: {},\r\n    width: 400,\r\n    height: 350,\r\n    minHeight: null,\r\n    minWidth: null,\r\n    maxHeight: null,\r\n    maxWidth: null,\r\n    title: 'Title is here.',\r\n    showCloseButton: true,\r\n    showMaxButton: true,\r\n    showButtons: true,\r\n    buttonAlign: 'center',\r\n    draggable: true,\r\n    resizable: true,\r\n    enableScroll: true,\r\n    beforeOpen: () => of(true),\r\n    beforeClose: () => of(true),\r\n    okText: 'ç¡®å®',\r\n    cancelText: 'åæ¶',\r\n    dialogHeaderHeight: 38,\r\n    dialogFooterHeight: 50,\r\n    dialogType: 'default',\r\n    showHeader: true,\r\n    fitContent: false,\r\n    areaResponse: false\r\n};\r\n\r\nexport const CLASS_NAME: any = {\r\n    SCROLLBAR_MEASURER: 'modal-scrollbar-measure',\r\n    BACKDROP: 'modal-backdrop',\r\n    OPEN: 'modal-open',\r\n    FADE: 'fade',\r\n    IN: 'in', // bs3\r\n    SHOW: 'show' // bs4\r\n};\r\n\r\nexport const SELECTOR: any = {\r\n    DIALOG: '.modal-dialog',\r\n    DATA_TOGGLE: '[data-toggle=\"modal\"]',\r\n    DATA_DISMISS: '[data-dismiss=\"modal\"]',\r\n    FIXED_CONTENT: '.navbar-fixed-top, .navbar-fixed-bottom, .is-fixed'\r\n};\r\n\r\nexport const TRANSITION_DURATIONS: any = {\r\n    MODAL: 300,\r\n    BACKDROP: 150\r\n};\r\n\r\nexport const DISMISS_REASONS = {\r\n    BACKRDOP: 'backdrop-click',\r\n    ESC: 'esc'\r\n};\r\n","import { Component, ElementRef, OnInit, Renderer2 } from '@angular/core';\r\nimport { CLASS_NAME } from './modal-options.class';\r\nimport { Utils, isBs3 } from '@farris/ui-modal/utils';\r\n\r\n/** This component will be added as background layout for modals if enabled */\r\n@Component({\r\n    selector: 'bs-modal-backdrop',\r\n    template: ' ',\r\n    host: { class: CLASS_NAME.BACKDROP }\r\n})\r\nexport class ModalBackdropComponent implements OnInit {\r\n    get isAnimated(): boolean {\r\n        return this._isAnimated;\r\n    }\r\n\r\n    set isAnimated(value: boolean) {\r\n        this._isAnimated = value;\r\n        // this.renderer.setElementClass(this.element.nativeElement, `${ClassName.FADE}`, value);\r\n    }\r\n\r\n    get isShown(): boolean {\r\n        return this._isShown;\r\n    }\r\n\r\n    set isShown(value: boolean) {\r\n        this._isShown = value;\r\n        if (value) {\r\n            this.renderer.addClass(this.element.nativeElement, `${CLASS_NAME.IN}`);\r\n        } else {\r\n            this.renderer.removeClass(this.element.nativeElement, `${CLASS_NAME.IN}`);\r\n        }\r\n        if (!isBs3()) {\r\n            if (value) {\r\n                this.renderer.addClass(\r\n                    this.element.nativeElement,\r\n                    `${CLASS_NAME.SHOW}`\r\n                );\r\n            } else {\r\n                this.renderer.removeClass(\r\n                    this.element.nativeElement,\r\n                    `${CLASS_NAME.SHOW}`\r\n                );\r\n            }\r\n        }\r\n    }\r\n\r\n    element: ElementRef;\r\n    renderer: Renderer2;\r\n\r\n    protected _isAnimated: boolean;\r\n    protected _isShown = false;\r\n\r\n    constructor(element: ElementRef, renderer: Renderer2) {\r\n        this.element = element;\r\n        this.renderer = renderer;\r\n    }\r\n\r\n    ngOnInit(): void {\r\n        if (this.isAnimated) {\r\n            this.renderer.addClass(this.element.nativeElement, `${CLASS_NAME.FADE}`);\r\n            Utils.reflow(this.element.nativeElement);\r\n        }\r\n        this.isShown = true;\r\n    }\r\n}\r\n","import { Directive, Injector, ElementRef, Input } from '@angular/core';\r\n\r\n@Directive({ selector: '[modal-button]' })\r\nexport class ModalButtonDirective {\r\n    @Input() visable = true;\r\n    constructor(private injector: Injector, private el: ElementRef) { }\r\n\r\n    setDisabled(disable: boolean) {\r\n        this.el.nativeElement.disabled = disable;\r\n    }\r\n\r\n    show() {\r\n        this.visable = true;\r\n    }\r\n\r\n    hide() {\r\n        this.visable = false;\r\n    }\r\n}\r\n","import {\r\n    Component, ElementRef, HostListener, OnDestroy,\r\n    OnInit, Renderer2, ViewChild, Output,\r\n    EventEmitter, TemplateRef, AfterViewInit, Input,\r\n    NgZone,\r\n    ViewChildren,\r\n    QueryList,\r\n    HostBinding\r\n} from '@angular/core';\r\nimport { AngularDraggableDirective } from '@farris/ui-draggable';\r\nimport { DomSanitizer, SafeResourceUrl } from \"@angular/platform-browser\";\r\nimport {\r\n    CLASS_NAME, DISMISS_REASONS,\r\n    ModalOptions, TRANSITION_DURATIONS\r\n} from './modal-options.class';\r\nimport { BsModalService } from './bs-modal.service';\r\nimport { isBs3 } from '@farris/ui-modal/utils';\r\nimport { ModalButtonDirective } from './modal-button.directive';\r\nimport { fromEvent, Subscription } from 'rxjs';\r\nimport { debounceTime, delay } from 'rxjs/operators';\r\n\r\n@Component({\r\n    selector: 'modal-container',\r\n    template: `\r\n    <div [attr.id]=\"modalID\"\r\n\r\n        [ngDraggable]=\"config.draggable\"\r\n        [ngResizable]=\"config.resizable\"\r\n        [rzMinWidth]=\"config.minWidth\"\r\n        [rzMaxWidth]=\"config.maxWidth\"\r\n        [rzMinHeight]=\"config.minHeight\"\r\n        [rzMaxHeight]=\"config.maxHeight\"\r\n        rzHandles=\"all\" [handle]=\"config.showHeader ? header:dragEl\"\r\n        (stopped)=\"dropdown($event)\"\r\n        (rzStop)=\"resizeStop($event)\"\r\n        [inBounds]=\"true\" [bounds]=\"boundsElement\" [rzContainment]=\"boundsElement\" [isFixed]=\"isModeless\"\r\n        [class]=\"'modal-dialog' + (config.class ? ' ' + config.class : '')\" role=\"document\"\r\n        [style.width]=\"config.width + 'px'\" [style.height]=\"config.fitContent?'auto':(config.height + 'px')\"\r\n        style=\"position: absolute;top: 50%;left: 50%;\">\r\n        <div class=\"modal-content\" [ngClass]=\"{'modal-content--has-header':config.showHeader}\">\r\n            <div #header class=\"modal-header\" [style.display]=\"config.showHeader ? '': 'none'\">\r\n                <div class=\"modal-title\">\r\n                    <span *ngIf=\"config.iconCls\" [class]=\"config.iconCls\" style=\"margin-right: 8px\"></span>\r\n                    <span class=\"modal-title-label\">{{ config.title }}</span>\r\n                </div>\r\n                <div class=\"actions\">\r\n                    <ul>\r\n                        <li *ngIf=\"config.showMinButton\" class=\"f-btn-icon f-bare\">\r\n                            <span class=\"f-icon modal_minimize\"></span></li>\r\n                        <li *ngIf=\"config.showMaxButton\" (click)=\"changeDialogSize()\" class=\"f-btn-icon f-bare\">\r\n                            <span class=\"f-icon modal_maximize\" [class.modalrevert]=\"isMax\"></span>\r\n                        </li>\r\n                        <li *ngIf=\"config.showCloseButton\" (click)=\"close($event, true)\" class=\"f-btn-icon f-bare\">\r\n                             <span class=\"f-icon modal_close\"></span>\r\n                        </li>\r\n                    </ul>\r\n                </div>\r\n            </div>\r\n        <div #dragEl class=\"f-utils-absolute-all\" style=\"height:10px;z-index: 1;\" [style.display]=\"config.showHeader ? 'none': ''\"></div>\r\n            <div class=\"modal-body\" [class.f-utils-flex-column]=\"dialogType === 'iframe'\"   [f-area-response]=\"config.areaResponse\">\r\n                <perfect-scrollbar [config]=\"{}\" [disabled]=\"!config.enableScroll||config.fitContent\"  *ngIf=\"!dialogType || dialogType === 'default'\">\r\n                    <ng-content ></ng-content>\r\n                </perfect-scrollbar>\r\n                <iframe *ngIf=\"dialogType === 'iframe'\" class=\"f-utils-fill\" width=\"100%\" frameborder=\"0\" [src]=\"iframeSrc\"></iframe>\r\n            </div>\r\n\r\n            <div [style.textAlign]=\"config.buttonAlign\" class=\"modal-footer\" [ngStyle]=\"buildFooterStyles()\" *ngIf=\"config.showButtons && config.buttons\">\r\n                <ng-container [ngTemplateOutlet]=\"useButtonsTemplate() ? config.buttons : defaultButtonRef\"></ng-container>\r\n            </div>\r\n        </div>\r\n    </div>\r\n\r\n    <ng-template #defaultButtonRef>\r\n\r\n        <ng-container *ngFor=\"let btn of config.buttons; last as isLast\">\r\n            <button type=\"button\" modal-button  *ngIf=\"btn.display === undefined && btn.tipsEnable === undefined\"\r\n                [class]=\"btn.cls\"\r\n                (click)=\"btn.handle && btn.handle($event) \">\r\n                <span [class]=\"btn.iconCls\" *ngIf=\"btn.iconCls\"></span> {{ btn.text }}\r\n            </button>\r\n\r\n            <button type=\"button\" modal-button  *ngIf=\"btn.display !== undefined || btn.tipsEnable !== undefined\"\r\n                [class]=\"btn.cls\"\r\n                (click)=\"btn.handle && btn.handle($event) \" \r\n                [style.display]=\"(btn.display === true || btn.display === undefined) ? '' : 'none'\"\r\n                [farrisTooltip]=\"btn?.tipsEnable\" [placement]=\"'top'\" [delay]=\"500\" [content]=\"btn?.tipsText\">\r\n                <span [class]=\"btn.iconCls\" *ngIf=\"btn.iconCls\"></span> {{ btn.text }}\r\n            </button>\r\n\r\n        </ng-container>\r\n\r\n    </ng-template>\r\n  `,\r\n    host: {\r\n        class: 'modal farris-modal',\r\n        role: 'dialog',\r\n        tabindex: '-1',\r\n        '[attr.aria-modal]': 'true'\r\n    }\r\n})\r\nexport class ModalContainerComponent implements OnInit, OnDestroy, AfterViewInit {\r\n    config: ModalOptions;\r\n    isShown = false;\r\n    level: number;\r\n    isAnimated: boolean;\r\n    bsModalService: BsModalService;\r\n    dialogType: string;\r\n    iframeSrc: SafeResourceUrl;\r\n    // æ¯å¦éæ¨¡æçªå£\r\n    isModeless=false;\r\n    @Input()\r\n    public set iframe(value: string) {\r\n        if (this.sanitizer) {\r\n            this.iframeSrc = this.sanitizer.bypassSecurityTrustResourceUrl(value);\r\n        }\r\n    }\r\n    private isModalHiding = false;\r\n    private originalWidth: number;  // è®°å½åå§çå®½åº¦\r\n    private originalHeight: number; // è®°å½åå§çé«åº¦\r\n\r\n    private prevWidth: number; // è®°å½ä¸æ¬¡çå®½åº¦\r\n    private prevHeight: number; // è®°å½ä¸æ¬¡çé«åº¦\r\n    isMax = false;\r\n\r\n    @ViewChild(AngularDraggableDirective) draggbar: AngularDraggableDirective;\r\n    @ViewChild('header') modalHeader: ElementRef;\r\n    boundsElement: HTMLElement;\r\n\r\n    @Output() closed = new EventEmitter();\r\n    @Output() opened = new EventEmitter();\r\n    @Output() resized = new EventEmitter();\r\n\r\n    @HostBinding('id') modalID = `MODALID_${Date.now().toPrecision()}`;\r\n\r\n    @ViewChildren(ModalButtonDirective) buttons: QueryList<ModalButtonDirective>;\r\n\r\n    dlgHeaderLineHeight: any;\r\n    private _windowResizeToMax = false;\r\n    private windowResize$: Subscription = null;\r\n    constructor(\r\n        options: ModalOptions,\r\n        protected el: ElementRef,\r\n        private _renderer: Renderer2,\r\n        private sanitizer: DomSanitizer\r\n    ) {\r\n        this.config = Object.assign({}, options);\r\n        if (!this.config.buttons) {\r\n            this.config.buttons = [\r\n                {\r\n                    text: 'åæ¶',\r\n                    cls: 'btn btn-light',\r\n                    iconCls: 'k-icon k-i-close',\r\n                    handle: () => {\r\n                        this.close();\r\n                    }\r\n                },\r\n                {\r\n                    text: 'ç¡®å®',\r\n                    cls: 'btn btn-primary',\r\n                    iconCls: 'k-icon k-i-check',\r\n                    handle: () => { alert('å¥½(ï½¡ï½¥âï½¥)ï¾ï¾å¨å!!'); }\r\n                }\r\n            ];\r\n        }\r\n        this.setIsModeless();\r\n    }\r\n\r\n    ngOnInit(): void {\r\n        if(this.isModeless){\r\n            // å¦ææ¯éæ¨¡æçªå£\r\n            this.boundsElement=null;\r\n            this._renderer.addClass(this.el.nativeElement, 'f-modal-is-modeless');\r\n        }else{\r\n            this.boundsElement = this.el.nativeElement;\r\n        }       \r\n        if (this.config.fitContent) {\r\n            this._renderer.addClass(this.el.nativeElement, 'f-modal-fitContent');\r\n        }\r\n\r\n        if (this.isAnimated) {\r\n            this._renderer.addClass(this.el.nativeElement, CLASS_NAME.FADE);\r\n        }\r\n        // this.ngZone.runOutsideAngular(() => {\r\n        setTimeout(() => {\r\n            this.isShown = true;           \r\n            this._renderer.addClass(\r\n                this.el.nativeElement,\r\n                isBs3() ? CLASS_NAME.IN : CLASS_NAME.SHOW\r\n            );\r\n            if(this.isModeless){\r\n                this._renderer.setStyle(this.el.nativeElement, 'position', 'static');\r\n            }\r\n            this._renderer.setStyle(this.el.nativeElement, 'display', 'block');\r\n            if (this.config.fitContent && this.el.nativeElement.className.indexOf('f-modal-fitContent-scroll') > -1) {\r\n                this.el.nativeElement.scrollTop = 0;\r\n            }\r\n\r\n            if (document && document.body) {\r\n                const modalLen = this.bsModalService.getModalsCount();\r\n                if (modalLen === 1) {\r\n                    this.bsModalService.checkScrollbar();\r\n                    this.bsModalService.setScrollbar();\r\n                }\r\n                if (!document.body.classList.contains(CLASS_NAME.OPEN)) {\r\n                    this._renderer.addClass(document.body, CLASS_NAME.OPEN);\r\n                }\r\n            }\r\n            this.opened.emit({ modal: this });\r\n        }, this.isAnimated ? TRANSITION_DURATIONS.BACKDROP : 0);\r\n        // });\r\n\r\n        if (this.el.nativeElement) {\r\n            this.el.nativeElement.focus();\r\n        }\r\n\r\n        this.dlgHeaderLineHeight = this.getDialogHeaderLineHeight() + 'px';\r\n    }\r\n\r\n    ngAfterViewInit(): void {\r\n        // Called after ngAfterContentInit when the component's view has been initialized. Applies to components only.\r\n        // Add 'implements AfterViewInit' to the class.\r\n        this._renderer.setStyle(this.el.nativeElement, 'display', 'block');\r\n        // å¦æåå®¹éåºå®½åº¦\r\n        if (this.config.fitContent) {\r\n            let initElRect = this.el.nativeElement.getBoundingClientRect();\r\n            let initBodySize = this.getContainerSize();\r\n            if (initElRect.height < initBodySize.height + 30) {\r\n                this._renderer.addClass(this.el.nativeElement, 'f-modal-fitContent-scroll');\r\n            }\r\n        }\r\n\r\n        this.originalHeight = this.config.height;\r\n        this.originalWidth = this.config.width;\r\n\r\n        this.windowResize$ = fromEvent(window, 'resize').pipe(\r\n            debounceTime(50)\r\n        ).subscribe((e: any) => {\r\n            const winWidth =  window.innerWidth -20;\r\n            const winHeight = window.innerHeight - 20;\r\n\r\n            if (this.config.width <= winWidth && this.config.height <= winHeight) {\r\n                if (this._windowResizeToMax) {\r\n                    this.revertDialog();\r\n                    this._windowResizeToMax = false;\r\n                } else {\r\n                    if (this.isMax) {    \r\n                        this.maxDialog(false);\r\n                    }\r\n                }\r\n            } else {\r\n                if (!this.isMax) {\r\n                    this._windowResizeToMax = true;\r\n                    this.maxDialog();\r\n                } else {\r\n                    this.maxDialog(false);\r\n                }\r\n            }\r\n\r\n            this.toCenter();\r\n            this.moveTo(0, 0);\r\n        });\r\n\r\n    }\r\n\r\n    private getDlgElement() {\r\n        return this.el.nativeElement.querySelector('.modal-dialog');\r\n    }\r\n\r\n    private getDialogHeaderLineHeight() {\r\n        if (this.config.showHeader) {\r\n            const modalHeaderStyles = window.getComputedStyle(this.modalHeader.nativeElement);\r\n            const paddingTop = parseInt(modalHeaderStyles.paddingTop.replace('px', ''), 10);\r\n            const paddingBottom = parseInt(modalHeaderStyles.paddingBottom.replace('px', ''), 10);\r\n            return this.config.dialogHeaderHeight - paddingTop - paddingBottom;\r\n        } else {\r\n            return 0;\r\n        }\r\n    }\r\n\r\n    // è·ååå®¹åºåçå°ºå¯¸\r\n    getContainerSize() {\r\n        const bodyTarget = this.el.nativeElement.querySelector('.modal-body');\r\n        const height = bodyTarget.offsetHeight;\r\n        const width = bodyTarget.offsetWidth;\r\n        return { width, height };\r\n    }\r\n\r\n    buildFooterStyles() {\r\n        let styles = {};\r\n\r\n        if (this.config.dialogFooterStyles) {\r\n            styles = Object.assign({}, styles, this.config.dialogFooterStyles);\r\n        }\r\n\r\n        return styles;\r\n    }\r\n\r\n    useButtonsTemplate() {\r\n        return this.config.buttons instanceof TemplateRef;\r\n    }\r\n\r\n    @HostListener('click', ['$event'])\r\n    onClick(event: MouseEvent) {\r\n        const tag = event.target as any;\r\n\r\n        // if (tag.localName === 'label') {\r\n        //     if (tag.className) {\r\n        //         const clsList = tag.className.split(' ');\r\n        //         if (\r\n        //             clsList.indexOf('k-radio-label') > -1 ||\r\n        //             clsList.indexOf('k-checkbox-label') > -1 ||\r\n        //             clsList.indexOf('custom-control-label') > -1\r\n        //         ) {\r\n        //             return;\r\n        //         }\r\n        //     }\r\n        // }\r\n\r\n        // if (tag.localName === 'input' && (tag.type === 'checkbox' || tag.type === 'radio' || tag.type === 'file')) {\r\n        //     return;\r\n        // }\r\n\r\n        if (this.config.ignoreBackdropClick || this.config.backdrop === 'static' || event.target !== this.el.nativeElement ) {\r\n            event.stopPropagation();\r\n            return;\r\n        }\r\n\r\n        this.bsModalService.setDismissReason(DISMISS_REASONS.BACKRDOP);\r\n        this.close();\r\n    }\r\n\r\n    @HostListener('window:keydown.esc', ['$event'])\r\n    onEsc(event: any): void {\r\n        if (!this.isShown) {\r\n            return;\r\n        }\r\n\r\n        if (event.keyCode === 27) {\r\n            event.preventDefault();\r\n        }\r\n        /**ä»æåä¸ä¸ªçªå£å¼å§å³é­ */\r\n        if (\r\n            this.config.keyboard &&\r\n            this.level === this.bsModalService.getModalsCount()\r\n        ) {\r\n            this.bsModalService.setDismissReason(DISMISS_REASONS.ESC);\r\n            this.close(event);\r\n        }\r\n    }\r\n\r\n    ngOnDestroy(): void {\r\n        if (this.isShown) {\r\n            this.close();\r\n        }\r\n\r\n        if (this.windowResize$) {\r\n            this.windowResize$.unsubscribe();\r\n            this.windowResize$ = null;\r\n        }\r\n    }\r\n\r\n    close(e?: MouseEvent, isCloseButton = false): void {\r\n        if (e && e.stopPropagation) {\r\n            e.stopPropagation();\r\n        }\r\n\r\n        if (this.isModalHiding || !this.isShown) {\r\n            return;\r\n        }\r\n\r\n        this.config.beforeClose(this, { event: e }).subscribe(r => {\r\n            if (!r) {\r\n                return false;\r\n            }\r\n            // æ´æ°æå¡ä¸­éæ¨¡æçªå£çä¸ªæ°\r\n            this.bsModalService.closeUpdateModelessCountByModal(this.isModeless);\r\n            this.isModalHiding = true;\r\n            this._renderer.removeClass(\r\n                this.el.nativeElement,\r\n                isBs3() ? CLASS_NAME.IN : CLASS_NAME.SHOW\r\n            );\r\n            setTimeout(() => {\r\n                this.isShown = false;\r\n                this.bsModalService.hide(this.level);\r\n                this.isModalHiding = false;\r\n\r\n                if (document && document.body &&  !document.querySelectorAll('.farris-modal.show').length) {\r\n                    this._renderer.removeClass(document.body, CLASS_NAME.OPEN);\r\n                }\r\n\r\n                if (this.config.closed) {\r\n                    this.config.closed(isCloseButton, { modalRef: this, event: e });\r\n                }\r\n                this.closed.emit(this.level);\r\n            }, this.isAnimated ? TRANSITION_DURATIONS.MODAL : 0);\r\n            // });\r\n        });\r\n    }\r\n\r\n    toCenter() {\r\n        const marginLeft = Number.parseInt('' + -this.config.width / 2);\r\n        const marginTop = Number.parseInt('' + -this.config.height / 2);\r\n\r\n        const dialogEl = this.el.nativeElement.querySelector('.modal-dialog');\r\n        const contentEl = this.el.nativeElement.querySelector('.modal-body');\r\n\r\n        // this._renderer.setStyle(dialogEl, 'margin-left', marginLeft);\r\n        // this._renderer.setStyle(dialogEl, 'margin-top', marginTop);\r\n\r\n        this._renderer.setStyle(dialogEl, 'left', `${window.innerWidth / 2 + marginLeft}px`);\r\n        this._renderer.setStyle(dialogEl, 'top',  `${window.innerHeight / 2 + marginTop}px`);\r\n\r\n        let contentHeight = this.config.height - 38;\r\n        if (this.config.showButtons) {\r\n            contentHeight = contentHeight - 50;\r\n        }\r\n        if (!this.config.fitContent) {\r\n            this._renderer.setStyle(\r\n                contentEl,\r\n                'height',\r\n                contentHeight + 'px'\r\n            );\r\n        }\r\n        this._renderer.setStyle(contentEl, 'overflow', 'hidden');\r\n        this._renderer.setStyle(dialogEl, 'transform', `translate3d(0px, 0px, 0px)`);\r\n\r\n        setTimeout(() => {\r\n            const container = this.getContainerSize();\r\n            const { width: containerWidth, height: containerHeight } = container;\r\n            this.resized.emit({ width: this.config.width, height: this.config.height,  containerWidth,  containerHeight });\r\n        });\r\n    }\r\n\r\n    moveTo(x: number, y: number) {\r\n        const dialogEl = this.el.nativeElement.querySelector('.modal-dialog');\r\n        this._renderer.setStyle(dialogEl, 'transform', `translate3d(${x}px, ${y}px, 0px)`);\r\n        // this._renderer.setStyle(dialogEl, 'top', '50%');\r\n        // this._renderer.setStyle(dialogEl, 'left', '50%');\r\n\r\n        // const marginLeft = Number.parseInt('' + -this.config.width / 2);\r\n        // const marginTop = Number.parseInt('' + -this.config.height / 2);\r\n        // this._renderer.setStyle(dialogEl, 'left', `${window.innerWidth / 2 + marginLeft}px`);\r\n        // this._renderer.setStyle(dialogEl, 'top',  `${window.innerHeight / 2 + marginTop}px`);\r\n\r\n\r\n        this.draggbar.position = { x, y };\r\n        this.draggbar.resetPosition();\r\n    }\r\n\r\n    maxDialog(rememberPrevSize = true) {\r\n        if (rememberPrevSize) {\r\n            this.prevWidth = this.config.width;\r\n            this.prevHeight = this.config.height;\r\n        }\r\n        // this.config.width = (document.scrollingElement?document.scrollingElement:document.documentElement)['clientWidth'] - 20;\r\n        // this.config.height = (document.scrollingElement?document.scrollingElement:document.documentElement)['clientHeight'] - 20;\r\n\r\n        this.config.width = window.innerWidth - 20;\r\n        this.config.height = window.innerHeight - 20;\r\n\r\n        this.config.draggable = false;\r\n        this.config.resizable = false;\r\n        const dialogEl = this.el.nativeElement.querySelector('.modal-dialog');\r\n        this._renderer.addClass(dialogEl, 'model-dialog-maximize');\r\n        this._renderer.setStyle(dialogEl, 'top', '50%');\r\n        this._renderer.setStyle(dialogEl, 'left', '50%');\r\n        this.isMax = true;\r\n        this.toCenter();\r\n        this.moveTo(0, 0);\r\n    }\r\n\r\n    resize(width: number, height: number) {\r\n        if (width) {\r\n            this.config.width = width;\r\n        }\r\n\r\n        if (height) {\r\n            this.config.height = height;\r\n        }\r\n\r\n        const dialogEl = this.el.nativeElement.querySelector('.modal-dialog');\r\n        this._renderer.removeClass(dialogEl, 'model-dialog-maximize');\r\n        this.toCenter();\r\n        this.draggbar.resetPosition();\r\n    }\r\n\r\n    dropdown(el: any) {\r\n        // const rect = el.getBoundingClientRect();\r\n        // this._renderer.removeStyle(el, 'margin-top');\r\n        // this._renderer.removeStyle(el, 'margin-left');\r\n        // this._renderer.setStyle(el, 'top', `${rect.top}px`);\r\n        // this._renderer.setStyle(el, 'left', `${rect.left}px`);\r\n\r\n        // this._renderer.removeStyle(el, 'transform');\r\n        // this._renderer.removeStyle(el, '-webkit-transform');\r\n        // this._renderer.removeStyle(el, '-ms-transform');\r\n        // this._renderer.removeStyle(el, '-moz-transform');\r\n        // this._renderer.removeStyle(el, '-o-transform');\r\n    }\r\n\r\n    revertDialog() {\r\n        this.isMax = false;\r\n\r\n        const ww = window.innerWidth - 20;\r\n        const wh = window.innerHeight - 20\r\n\r\n        this.config.width = this.prevWidth == ww ? this.originalWidth : this.prevWidth;\r\n        this.config.height = this.prevHeight == wh ? this.originalHeight : this.prevHeight;\r\n       \r\n        if (this.config.width > ww) {\r\n            this.config.width = ww;\r\n        }\r\n\r\n        if (this.config.height > wh) {\r\n            this.config.height = wh;\r\n        }\r\n\r\n\r\n        this.config.draggable = true;\r\n        this.config.resizable = true;\r\n        const dialogEl = this.el.nativeElement.querySelector('.modal-dialog');\r\n        this._renderer.removeClass(dialogEl, 'model-dialog-maximize');\r\n        this.toCenter();\r\n        this.draggbar.resetPosition();\r\n    }\r\n\r\n    changeDialogSize() {\r\n        if (this.isMax) {\r\n            this.revertDialog();\r\n        } else {\r\n            this.maxDialog();\r\n        }\r\n        this._windowResizeToMax = false;\r\n    }\r\n\r\n    resizeStop(opts: any) {\r\n        // console.log('resizeStop');\r\n        this.config.width = opts.size.width;\r\n        this.config.height = opts.size.height;\r\n        const container = this.getContainerSize();\r\n        const { width: containerWidth, height: containerHeight } = container;\r\n        this.resized.emit({ ...opts.size, ...{ containerWidth, containerHeight } });\r\n    }\r\n    /**\r\n     * æ¯å¦éæ¨¡æ\r\n     * @returns \r\n     */\r\n    setIsModeless(){        \r\n        if(this.config.hasOwnProperty('modeless')){\r\n            this.isModeless= this.config['modeless'];\r\n        }else{\r\n            this.isModeless=false;\r\n        }\r\n    }\r\n    updateDialogZindex(zIndex){\r\n        if(this.isModeless){\r\n            let modalEl=this.el.nativeElement;\r\n            const dialogEl = modalEl.querySelector('.modal-dialog');\r\n            this._renderer.setStyle(dialogEl, 'position', 'fixed');\r\n            this._renderer.setStyle(dialogEl, 'zIndex', zIndex?zIndex:modalEl.style.zIndex );\r\n        }\r\n    }\r\n}\r\n","import {\r\n    ComponentRef, Injectable, TemplateRef,\r\n    EventEmitter, Renderer2, RendererFactory2, NgZone\r\n} from '@angular/core';\r\n\r\n\r\nimport { ModalBackdropComponent } from './modal-backdrop.component';\r\nimport { ModalContainerComponent } from './modal-container.component';\r\nimport {\r\n    CLASS_NAME,\r\n    modalConfigDefaults,\r\n    ModalOptions,\r\n    TRANSITION_DURATIONS\r\n} from './modal-options.class';\r\nimport { BsModalRef } from './bs-modal-ref.service';\r\nimport { Utils } from '@farris/ui-modal/utils';\r\nimport { ComponentLoaderFactory, ComponentLoader } from '@farris/ui-modal/component-loader';\r\nimport { CommonUtils } from '@farris/ui-common';\r\n\r\n@Injectable()\r\nexport class BsModalService {\r\n    version = '0.0.6';\r\n    config: ModalOptions = modalConfigDefaults;\r\n\r\n    onShow: EventEmitter<any> = new EventEmitter();\r\n    onShown: EventEmitter<any> = new EventEmitter();\r\n    onHide: EventEmitter<any> = new EventEmitter();\r\n    onHidden: EventEmitter<any> = new EventEmitter();\r\n\r\n    protected isBodyOverflowing = false;\r\n    protected originalBodyPadding = 0;\r\n\r\n    protected scrollbarWidth = 0;\r\n\r\n    protected backdropRef: ComponentRef<ModalBackdropComponent>;\r\n    private _backdropLoader: ComponentLoader<ModalBackdropComponent>;\r\n    // æ è®°æ¨¡æåéæ¨¡æçªå£çæ»ä¸ªæ°\r\n    private modalsCount = 0;\r\n    private lastDismissReason = '';\r\n\r\n    private loaders: ComponentLoader<ModalContainerComponent>[] = [];\r\n\r\n    private _renderer: Renderer2;\r\n\r\n    private _documentMouseDownHandler = null;\r\n    private commonUtils: CommonUtils = null;\r\n    // æ è®°éæ¨¡æçªå£ä¸ªæ°\r\n    private modellessCount=0;\r\n\r\n    constructor(rendererFactory: RendererFactory2, private clf: ComponentLoaderFactory, public ngZone: NgZone) {\r\n\r\n        this._renderer = rendererFactory.createRenderer(null, null);\r\n\r\n        this._backdropLoader = this.clf.createLoader<ModalBackdropComponent>(\r\n            null,\r\n            null,\r\n            this._renderer\r\n        );\r\n\r\n        this.commonUtils = new CommonUtils();\r\n    }\r\n\r\n    private clearDocumentEvents() {\r\n        if (this._documentMouseDownHandler) {\r\n            document.body.removeEventListener('mousedown', this._documentMouseDownHandler);\r\n        }\r\n        this._documentMouseDownHandler = null;\r\n    }\r\n\r\n    /** Shows a modal */\r\n    show(content: string | TemplateRef<any> | any, config?: ModalOptions): BsModalRef {\r\n        this.modalsCount++;\r\n        this._createLoaders();\r\n        this.config = Object.assign({}, modalConfigDefaults, config);\r\n\r\n        this.checkDialogSize();\r\n        if(this.isModeless()){            \r\n            this.modellessCount++;\r\n        } else{\r\n            this._showBackdrop();\r\n        }      \r\n        this.lastDismissReason = null;\r\n\r\n        const modal = this._showModal(content);\r\n        return modal;\r\n    }\r\n    private isModeless(){\r\n        if(this.config.hasOwnProperty('modeless')){\r\n            return this.config['modeless'];\r\n        }\r\n        return false;\r\n    }\r\n\r\n    hide(level: number) {\r\n        if (this.modalsCount-this.modellessCount === 1) {\r\n            this._hideBackdrop();\r\n            this.resetScrollbar();\r\n        }\r\n        this.modalsCount = this.modalsCount >= 1 ? this.modalsCount - 1 : 0;\r\n        // this.ngZone.runOutsideAngular(() => {\r\n        //     setTimeout(() => {\r\n            // this._hideModal(level);\r\n            // this.removeLoaders(level);\r\n\r\n        //     }, this.config.animated ? TRANSITION_DURATIONS.BACKDROP : 0);\r\n        // });\r\n        this._hideModal(level);\r\n        this.removeLoaders(level);\r\n\r\n        this.clearDocumentEvents();\r\n    }\r\n\r\n    _showBackdrop(): void {\r\n        const isBackdropEnabled =\r\n            this.config.backdrop || this.config.backdrop === 'static';\r\n        const isBackdropInDOM =\r\n            !this.backdropRef || !this.backdropRef.instance.isShown;\r\n        /**\r\n         * æ­¤å¤åéå®æ¯è§£å³ãå¼¹åºå¤ä¸ªæ¨¡æçªå£æ¶ï¼å ä¸ºé®ç½©å±çå å ï¼å¯¼è´èæ¯å¾é»ãçé®é¢\r\n         */\r\n        if (this.modalsCount-this.modellessCount === 1) {\r\n            this.removeBackdrop();\r\n\r\n            if (isBackdropEnabled && isBackdropInDOM) {\r\n                this._backdropLoader\r\n                    .attach(ModalBackdropComponent)\r\n                    .to('body')\r\n                    .show({ isAnimated: this.config.animated });\r\n                this.backdropRef = this._backdropLoader._componentRef;\r\n            }\r\n        }\r\n    }\r\n\r\n    _hideBackdrop(): void {\r\n        if (!this.backdropRef) {\r\n            return;\r\n        }\r\n        this.backdropRef.instance.isShown = false;\r\n        const duration = this.config.animated ? TRANSITION_DURATIONS.BACKDROP : 0;\r\n        this.ngZone.runOutsideAngular(() => {\r\n            setTimeout(() => this.removeBackdrop(), duration);\r\n        });\r\n    }\r\n\r\n    private updateZindex(_modal) {\r\n        const maxZindex = this.commonUtils.getFloatingLayerIndex();\r\n        // éæ¨¡æä¸zIndexçè®¾ç½®\r\n        _modal.dialog.instance.updateDialogZindex(maxZindex);\r\n        _modal.dialog.location.nativeElement.style.zIndex = maxZindex;\r\n    }\r\n\r\n    _showModal(content: any): BsModalRef {\r\n        const modalLoader = this.loaders[this.loaders.length - 1];\r\n        const bsModalRef = new BsModalRef();\r\n\r\n        const modalContainerRef = modalLoader\r\n            .provide({ provide: ModalOptions, useValue: this.config })\r\n            .provide({ provide: BsModalRef, useValue: bsModalRef })\r\n            .attach(ModalContainerComponent)\r\n            .to('body')\r\n            .show({ content, isAnimated: this.config.animated,\r\n                initialState: this.config.initialState,\r\n                bsModalService: this\r\n            });\r\n        modalContainerRef.instance.level = this.getModalsCount();\r\n        modalContainerRef.instance.dialogType = this.config.dialogType;\r\n        modalContainerRef.instance.iframe = '';\r\n        if (this.config.dialogType === 'iframe') {\r\n            modalContainerRef.instance.iframe = content;\r\n        }\r\n        bsModalRef.close = (e) => {\r\n            modalContainerRef.instance.close(e);\r\n            this.clearDocumentEvents();\r\n        };\r\n\r\n\r\n        // å¦ææ¯æ¶æ¯ç±»åçï¼åºç°æ»å¨æ¡å°±ä¸ååºå¨ç»äº\r\n        if (!this.config.fitContent) {\r\n            modalContainerRef.instance.toCenter();\r\n            this.ngZone.runOutsideAngular(() => {\r\n                document.body.addEventListener('mousedown', this._documentMouseDownHandler = (e) => {this._onMouseDown(e,modalContainerRef.instance.isModeless)});\r\n            });\r\n        }\r\n        bsModalRef.content = modalLoader.getInnerComponent() || null;\r\n\r\n        bsModalRef.dialog = modalContainerRef;\r\n        bsModalRef.buttons = modalContainerRef.instance.buttons;\r\n\r\n        modalContainerRef.instance['modalRef'] = bsModalRef;\r\n\r\n        if (this.config.opened) {\r\n            this.config.opened({ instance: bsModalRef });\r\n        }\r\n\r\n        this.updateZindex(bsModalRef);\r\n\r\n        return bsModalRef;\r\n    }\r\n    /**\r\n     * å¢å åæ°ï¼è§£å³ï¼å¨å½åæ¨¡æçªå£ååå¼¹åºéæ¨¡æåå¼¹åºDialogæ¶ï¼ç¹å»å¤å±\r\n     * @param e \r\n     * @param curModalisModeless \r\n     * @returns \r\n     */\r\n    _onMouseDown(e: any,curModalisModeless=null) {\r\n        if(curModalisModeless){\r\n            var modalDialogEl=e.target.classList.contains('modal-dialog')?e.target:null;\r\n            modalDialogEl=modalDialogEl?modalDialogEl:e.target.closest('.modal-dialog');\r\n            if(modalDialogEl){\r\n                const maxZindex = this.commonUtils.getFloatingLayerIndex();\r\n                modalDialogEl.style.zIndex = maxZindex;\r\n                modalDialogEl.parentElement.style.zIndex = maxZindex;\r\n            }\r\n            return false;\r\n        }else{\r\n            if (e.target.localName === 'modal-container' || e.target.classList.contains('farris-modal')) {\r\n          \r\n                this._renderer.addClass(e.target, 'animated');\r\n                this._renderer.addClass(e.target, 'shake');\r\n                this.ngZone.runOutsideAngular(() => {\r\n                    setTimeout(() => {\r\n                        this._renderer.removeClass(e.target, 'animated');\r\n                        this._renderer.removeClass(e.target, 'shake');\r\n                    }, 650);\r\n                });\r\n                return false;\r\n            }\r\n           \r\n        }        \r\n    }\r\n\r\n    _hideModal(level: number): void {\r\n        const modalLoader = this.loaders[level - 1];\r\n        if (modalLoader) {\r\n            modalLoader.hide();\r\n        }\r\n    }\r\n\r\n    getModalsCount(): number {\r\n        return this.modalsCount;\r\n    }\r\n\r\n    getCurrentModalContainer() {\r\n        return this.loaders[this.getModalsCount() - 1];\r\n    }\r\n\r\n    setDismissReason(reason: string) {\r\n        this.lastDismissReason = reason;\r\n    }\r\n\r\n    removeBackdrop(): void {\r\n        this._backdropLoader.hide();\r\n        this.backdropRef = null;\r\n    }\r\n\r\n    /** AFTER PR MERGE MODAL.COMPONENT WILL BE USING THIS CODE */\r\n    /** Scroll bar tricks */\r\n    /** @internal */\r\n    checkScrollbar(): void {\r\n        this.isBodyOverflowing = document.body.clientWidth < window.innerWidth;\r\n        this.scrollbarWidth = this.getScrollbarWidth();\r\n    }\r\n\r\n    setScrollbar(): void {\r\n        if (!document) {\r\n            return;\r\n        }\r\n\r\n        this.originalBodyPadding = parseInt(\r\n            window\r\n                .getComputedStyle(document.body)\r\n                .getPropertyValue('padding-right') || '0',\r\n            10\r\n        );\r\n\r\n        if (this.isBodyOverflowing) {\r\n            document.body.style.paddingRight = `${this.originalBodyPadding +\r\n                this.scrollbarWidth}px`;\r\n        }\r\n    }\r\n\r\n    private resetScrollbar(): void {\r\n        document.body.style.paddingRight = `${this.originalBodyPadding}px`;\r\n    }\r\n\r\n    // thx d.walsh\r\n    private getScrollbarWidth(): number {\r\n        const scrollDiv = this._renderer.createElement('div');\r\n        this._renderer.addClass(scrollDiv, CLASS_NAME.SCROLLBAR_MEASURER);\r\n        this._renderer.appendChild(document.body, scrollDiv);\r\n        const scrollbarWidth = scrollDiv.offsetWidth - scrollDiv.clientWidth;\r\n        this._renderer.removeChild(document.body, scrollDiv);\r\n\r\n        return scrollbarWidth;\r\n    }\r\n\r\n    private _createLoaders(): void {\r\n        const loader = this.clf.createLoader<ModalContainerComponent>(\r\n            null,\r\n            null,\r\n            this._renderer\r\n        );\r\n        this.copyEvent(loader.onBeforeShow, this.onShow);\r\n        this.copyEvent(loader.onShown, this.onShown);\r\n        this.copyEvent(loader.onBeforeHide, this.onHide);\r\n        this.copyEvent(loader.onHidden, this.onHidden);\r\n        this.loaders.push(loader);\r\n    }\r\n\r\n    private removeLoaders(level: number): void {\r\n        this.loaders.splice(level - 1, 1);\r\n        this.loaders.forEach(\r\n            (loader: ComponentLoader<ModalContainerComponent>, i: number) => {\r\n                loader.instance.level = i + 1;\r\n            }\r\n        );\r\n    }\r\n\r\n    private copyEvent(from: EventEmitter<any>, to: EventEmitter<any>) {\r\n        from.subscribe(() => {\r\n            to.emit(this.lastDismissReason);\r\n        });\r\n    }\r\n\r\n    private checkDialogSize() {\r\n        const newSize = Utils.checkDialogSize(this.config.width, this.config.height);\r\n        if (this.config.width !== newSize.width) {\r\n            this.config.width = newSize.width - 20;\r\n        }\r\n\r\n        if (this.config.height !== newSize.height) {\r\n            this.config.height = newSize.height - 20;\r\n        }\r\n    }\r\n    closeUpdateModelessCountByModal(curIsModeless){\r\n        if(curIsModeless){\r\n            this.modellessCount=this.modellessCount-1>0?this.modellessCount-1:0;\r\n        }\r\n    }\r\n}\r\n","export class ModalBackdropOptions {\r\n  animate = true;\r\n\r\n  constructor(options: ModalBackdropOptions) {\r\n    Object.assign(this, options);\r\n  }\r\n}\r\n","import { ChangeDetectorRef, Optional } from '@angular/core';\r\n/* tslint:disable:max-file-line-count */\r\n// todo: should we support enforce focus in?\r\n// todo: in original bs there are was a way to prevent modal from showing\r\n// todo: original modal had resize events\r\n\r\nimport {\r\n    ComponentRef, Directive, ElementRef, EventEmitter, HostListener, Input,\r\n    OnDestroy, OnInit, Output, Renderer2, ViewContainerRef, NgZone\r\n} from '@angular/core';\r\n\r\nimport { document, window, isBs3, Utils } from '@farris/ui-modal/utils';\r\n\r\nimport { ModalBackdropComponent } from './modal-backdrop.component';\r\nimport { CLASS_NAME, DISMISS_REASONS, modalConfigDefaults, ModalOptions } from './modal-options.class';\r\nimport { ComponentLoader, ComponentLoaderFactory } from '@farris/ui-modal/component-loader';\r\nimport { CommonUtils } from '@farris/ui-common';\r\n\r\nconst TRANSITION_DURATION = 300;\r\nconst BACKDROP_TRANSITION_DURATION = 150;\r\n\r\n/** Mark any code with directive to show it's content in modal */\r\n@Directive({\r\n    selector: '[bsModal]',\r\n    exportAs: 'bs-modal'\r\n})\r\nexport class ModalDirective implements OnDestroy, OnInit {\r\n    /** allows to set modal configuration via element property */\r\n    @Input()\r\n    set config(conf: ModalOptions) {\r\n        this._config = this.getConfig(conf);\r\n    }\r\n\r\n    get config(): ModalOptions {\r\n        return this._config;\r\n    }\r\n\r\n    /** This event fires immediately when the `show` instance method is called. */\r\n    @Output() onShow: EventEmitter<ModalDirective> = new EventEmitter<ModalDirective>();\r\n    /** This event is fired when the modal has been made visible to the user\r\n     * (will wait for CSS transitions to complete)\r\n     */\r\n    @Output()\r\n    onShown: EventEmitter<ModalDirective> = new EventEmitter<ModalDirective>();\r\n    /** This event is fired immediately when\r\n     * the hide instance method has been called.\r\n     */\r\n    @Output() onHide: EventEmitter<ModalDirective> = new EventEmitter<ModalDirective>();\r\n    /** This event is fired when the modal has finished being\r\n     * hidden from the user (will wait for CSS transitions to complete).\r\n     */\r\n    @Output() onHidden: EventEmitter<ModalDirective> = new EventEmitter<ModalDirective>();\r\n\r\n    /** This field contains last dismiss reason.\r\n     * Possible values: `backdrop-click`, `esc` and `null`\r\n     * (if modal was closed by direct call of `.hide()`).\r\n     */\r\n    dismissReason: string;\r\n\r\n    get isShown(): boolean {\r\n        return this._isShown;\r\n    }\r\n\r\n    protected _config: ModalOptions;\r\n    protected _isShown = false;\r\n\r\n    protected isBodyOverflowing = false;\r\n    protected originalBodyPadding = 0;\r\n    protected scrollbarWidth = 0;\r\n\r\n    protected timerHideModal: any = 0;\r\n    protected timerRmBackDrop: any = 0;\r\n\r\n    // reference to backdrop component\r\n    backdrop: ComponentRef<ModalBackdropComponent>;\r\n    private _backdrop: ComponentLoader<ModalBackdropComponent>;\r\n\r\n    private isNested = false;\r\n    private commonUtils: CommonUtils = null;\r\n    constructor(\r\n        private _element: ElementRef,\r\n        _viewContainerRef: ViewContainerRef,\r\n        private _renderer: Renderer2,\r\n        clf: ComponentLoaderFactory,\r\n        private ngZone: NgZone,\r\n        @Optional() public cd: ChangeDetectorRef) {\r\n        this._backdrop = clf.createLoader<ModalBackdropComponent>(\r\n            _element,\r\n            _viewContainerRef,\r\n            _renderer\r\n        );\r\n\r\n        this.commonUtils = new  CommonUtils();\r\n    }\r\n\r\n    @HostListener('click', ['$event'])\r\n    onClick(event: MouseEvent) {\r\n        const tag = event.target as any;\r\n\r\n        // if (tag.localName === 'label') {\r\n        //     if (tag.className) {\r\n        //         const clsList = tag.className.split(' ');\r\n        //         if (\r\n        //             clsList.indexOf('k-radio-label') > -1 ||\r\n        //             clsList.indexOf('k-checkbox-label') > -1 ||\r\n        //             clsList.indexOf('custom-control-label') > -1\r\n        //         ) {\r\n        //             return;\r\n        //         }\r\n        //     }\r\n        // }\r\n\r\n        // if (tag.localName === 'input' && (tag.type === 'checkbox' || tag.type === 'radio' || tag.type === 'file')) {\r\n        //     return;\r\n        // }\r\n\r\n        if (\r\n            this.config.ignoreBackdropClick ||\r\n            this.config.backdrop === 'static' ||\r\n            event.target !== this._element.nativeElement\r\n        ) {\r\n            event.stopPropagation();\r\n            return;\r\n        }\r\n        this.dismissReason = DISMISS_REASONS.BACKRDOP;\r\n        this.hide(event);\r\n    }\r\n\r\n    // todo: consider preventing default and stopping propagation\r\n    @HostListener('keydown.esc', ['$event'])\r\n    onEsc(event: any): void {\r\n        if (!this._isShown) {\r\n            return;\r\n        }\r\n\r\n        if (event.keyCode === 27) {\r\n            event.preventDefault();\r\n        }\r\n\r\n        if (this.config.keyboard) {\r\n            this.dismissReason = DISMISS_REASONS.ESC;\r\n            this.hide();\r\n        }\r\n    }\r\n\r\n    ngOnDestroy(): any {\r\n        this.config = void 0;\r\n        if (this._isShown) {\r\n            this._isShown = false;\r\n            this.hideModal();\r\n            this._backdrop.dispose();\r\n        }\r\n    }\r\n\r\n    ngOnInit(): any {\r\n        this._config = this._config || this.getConfig();\r\n        // this.ngZone.runOutsideAngular(() => {\r\n        setTimeout(() => {\r\n            if (this._config.show) {\r\n                this.show();\r\n            }\r\n        }, 0);\r\n        // });\r\n    }\r\n\r\n    /* Public methods */\r\n\r\n    /** Allows to manually toggle modal visibility */\r\n    toggle(): void {\r\n        return this._isShown ? this.hide() : this.show();\r\n    }\r\n\r\n    /** Allows to manually open modal */\r\n    show(): void {\r\n        this.dismissReason = null;\r\n        this.onShow.emit(this);\r\n        if (this._isShown) {\r\n            return;\r\n        }\r\n        clearTimeout(this.timerHideModal);\r\n        clearTimeout(this.timerRmBackDrop);\r\n\r\n        const maxZindex = this.commonUtils.getFloatingLayerIndex();\r\n        this._element.nativeElement.style.zIndex = maxZindex;\r\n\r\n\r\n        this._isShown = true;\r\n\r\n        this.checkScrollbar();\r\n        this.setScrollbar();\r\n\r\n        if (document && document.body) {\r\n            if (document.body.classList.contains(CLASS_NAME.OPEN)) {\r\n                this.isNested = true;\r\n            } else {\r\n                this._renderer.addClass(document.body, CLASS_NAME.OPEN);\r\n            }\r\n        }\r\n\r\n        this.showBackdrop(() => {\r\n            this.showElement();\r\n        });\r\n    }\r\n\r\n    /** Allows to manually close modal */\r\n    hide(event?: Event): void {\r\n        if (event) {\r\n            event.preventDefault();\r\n        }\r\n\r\n        this.onHide.emit(this);\r\n\r\n        // todo: add an option to prevent hiding\r\n        if (!this._isShown) {\r\n            return;\r\n        }\r\n\r\n        clearTimeout(this.timerHideModal);\r\n        clearTimeout(this.timerRmBackDrop);\r\n\r\n        this._isShown = false;\r\n        this._renderer.removeClass(this._element.nativeElement, CLASS_NAME.IN);\r\n        this._renderer.removeClass(this._element.nativeElement, CLASS_NAME.SHOW);\r\n        // if (!isBs3()) {\r\n        // }\r\n        // this._addClassIn = false;\r\n\r\n        if (this._config.animated) {\r\n            this.timerHideModal = setTimeout(\r\n                () => this.hideModal(),\r\n                TRANSITION_DURATION\r\n            );\r\n        } else {\r\n            this.hideModal();\r\n        }\r\n    }\r\n\r\n    /** Private methods @internal */\r\n    protected getConfig(config?: ModalOptions): ModalOptions {\r\n        return Object.assign({}, modalConfigDefaults, config);\r\n    }\r\n\r\n    /**\r\n     *  Show dialog\r\n     *  @internal\r\n     */\r\n    protected showElement(): void {\r\n        // todo: replace this with component loader usage\r\n        if (\r\n            !this._element.nativeElement.parentNode ||\r\n            this._element.nativeElement.parentNode.nodeType !== Node.ELEMENT_NODE\r\n        ) {\r\n            // don't move modals dom position\r\n            if (document && document.body) {\r\n                document.body.appendChild(this._element.nativeElement);\r\n            }\r\n        }\r\n\r\n        this._renderer.setAttribute(\r\n            this._element.nativeElement,\r\n            'aria-hidden',\r\n            'false'\r\n        );\r\n        this._renderer.setAttribute(\r\n            this._element.nativeElement,\r\n            'aria-modal',\r\n            'true'\r\n        );\r\n        this._renderer.setStyle(\r\n            this._element.nativeElement,\r\n            'display',\r\n            'block'\r\n        );\r\n        this._renderer.setProperty(\r\n            this._element.nativeElement,\r\n            'scrollTop',\r\n            0\r\n        );\r\n\r\n        if (this._config.animated) {\r\n            Utils.reflow(this._element.nativeElement);\r\n        }\r\n\r\n        // this._addClassIn = true;\r\n        this._renderer.addClass(this._element.nativeElement, CLASS_NAME.IN);\r\n        this._renderer.addClass(this._element.nativeElement, CLASS_NAME.SHOW);\r\n        // if (!isBs3()) {\r\n        // }\r\n\r\n        const transitionComplete = () => {\r\n            if (this._config.focus) {\r\n                this._element.nativeElement.focus();\r\n            }\r\n            this.onShown.emit(this);\r\n        };\r\n\r\n        if (this._config.animated) {\r\n            // this.ngZone.runOutsideAngular(() => {\r\n                setTimeout(transitionComplete, TRANSITION_DURATION);\r\n            // });\r\n        } else {\r\n            transitionComplete();\r\n        }\r\n    }\r\n\r\n    /** @internal */\r\n    protected hideModal(): void {\r\n        this._renderer.setAttribute(\r\n            this._element.nativeElement,\r\n            'aria-hidden',\r\n            'true'\r\n        );\r\n        this._renderer.setStyle(\r\n            this._element.nativeElement,\r\n            'display',\r\n            'none'\r\n        );\r\n        this.showBackdrop(() => {\r\n            if (!this.isNested) {\r\n                if (document && document.body && !document.querySelectorAll('.farris-modal.show').length) {\r\n                    this._renderer.removeClass(document.body, CLASS_NAME.OPEN);\r\n                }\r\n                this.resetScrollbar();\r\n            }\r\n            this.resetAdjustments();\r\n            this.focusOtherModal();\r\n            this.onHidden.emit(this);\r\n        });\r\n    }\r\n\r\n    // todo: original show was calling a callback when done, but we can use\r\n    // promise\r\n    /** @internal */\r\n    protected showBackdrop(callback?: Function): void {\r\n        if (\r\n            this._isShown &&\r\n            this.config.backdrop &&\r\n            (!this.backdrop || !this.backdrop.instance.isShown)\r\n        ) {\r\n            this.removeBackdrop();\r\n            this._backdrop\r\n                .attach(ModalBackdropComponent)\r\n                .to('body')\r\n                .show({ isAnimated: this._config.animated });\r\n            this.backdrop = this._backdrop._componentRef;\r\n\r\n            if (!callback) {\r\n                return;\r\n            }\r\n\r\n            if (!this._config.animated) {\r\n                callback();\r\n\r\n                return;\r\n            }\r\n            // this.ngZone.runOutsideAngular(() => {\r\n                setTimeout(callback, BACKDROP_TRANSITION_DURATION);\r\n            // })\r\n        } else if (!this._isShown && this.backdrop) {\r\n            this.backdrop.instance.isShown = false;\r\n\r\n            const callbackRemove = () => {\r\n                this.removeBackdrop();\r\n                if (callback) {\r\n                    callback();\r\n                }\r\n            };\r\n\r\n            if (this.backdrop.instance.isAnimated) {\r\n                // this.ngZone.runOutsideAngular(() => {\r\n                    this.timerRmBackDrop = setTimeout(\r\n                        callbackRemove,\r\n                        BACKDROP_TRANSITION_DURATION\r\n                    );\r\n                // });\r\n            } else {\r\n                callbackRemove();\r\n            }\r\n        } else if (callback) {\r\n            callback();\r\n        }\r\n    }\r\n\r\n    /** @internal */\r\n    protected removeBackdrop(): void {\r\n        this._backdrop.hide();\r\n    }\r\n\r\n    /** Events tricks */\r\n\r\n    // no need for it\r\n    // protected setEscapeEvent():void {\r\n    //   if (this._isShown && this._config.keyboard) {\r\n    //     $(this._element).on(Event.KEYDOWN_DISMISS, (event) => {\r\n    //       if (event.which === 27) {\r\n    //         this.hide()\r\n    //       }\r\n    //     })\r\n    //\r\n    //   } else if (!this._isShown) {\r\n    //     $(this._element).off(Event.KEYDOWN_DISMISS)\r\n    //   }\r\n    // }\r\n\r\n    // protected setResizeEvent():void {\r\n    // console.log(this.renderer.listenGlobal('', Event.RESIZE));\r\n    // if (this._isShown) {\r\n    //   $(window).on(Event.RESIZE, $.proxy(this._handleUpdate, this))\r\n    // } else {\r\n    //   $(window).off(Event.RESIZE)\r\n    // }\r\n    // }\r\n\r\n    protected focusOtherModal() {\r\n        if (this._element.nativeElement.parentElement == null) return;\r\n        const otherOpenedModals = this._element.nativeElement.parentElement.querySelectorAll('.in[bsModal]');\r\n        if (!otherOpenedModals.length) {\r\n            return;\r\n        }\r\n        otherOpenedModals[otherOpenedModals.length - 1].focus();\r\n    }\r\n\r\n    /** @internal */\r\n    protected resetAdjustments(): void {\r\n        this._renderer.setStyle(\r\n            this._element.nativeElement,\r\n            'paddingLeft',\r\n            ''\r\n        );\r\n        this._renderer.setStyle(\r\n            this._element.nativeElement,\r\n            'paddingRight',\r\n            ''\r\n        );\r\n    }\r\n\r\n    /** Scroll bar tricks */\r\n    /** @internal */\r\n    protected checkScrollbar(): void {\r\n        this.isBodyOverflowing = document.body.clientWidth < window.innerWidth;\r\n        this.scrollbarWidth = this.getScrollbarWidth();\r\n    }\r\n\r\n    protected setScrollbar(): void {\r\n        if (!document) {\r\n            return;\r\n        }\r\n\r\n        this.originalBodyPadding = parseInt(\r\n            window\r\n                .getComputedStyle(document.body)\r\n                .getPropertyValue('padding-right') || 0,\r\n            10\r\n        );\r\n\r\n        if (this.isBodyOverflowing) {\r\n            document.body.style.paddingRight = `${this.originalBodyPadding +\r\n                this.scrollbarWidth}px`;\r\n        }\r\n    }\r\n\r\n    protected resetScrollbar(): void {\r\n        document.body.style.paddingRight = this.originalBodyPadding + 'px';\r\n    }\r\n\r\n    // thx d.walsh\r\n    protected getScrollbarWidth(): number {\r\n        const scrollDiv = this._renderer.createElement('div');\r\n        this._renderer.addClass(scrollDiv, CLASS_NAME.SCROLLBAR_MEASURER);\r\n        this._renderer.appendChild(document.body, scrollDiv);\r\n        const scrollbarWidth = scrollDiv.offsetWidth - scrollDiv.clientWidth;\r\n        this._renderer.removeChild(document.body, scrollDiv);\r\n\r\n        return scrollbarWidth;\r\n    }\r\n}\r\n","import { NgModule, ModuleWithProviders } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { BrowserModule } from '@angular/platform-browser';\r\nimport { PerfectScrollbarModule } from '@farris/ui-perfect-scrollbar';\r\nimport { AngularDraggableModule } from '@farris/ui-draggable';\r\n\r\nimport { ModalBackdropComponent } from './modal-backdrop.component';\r\nimport { ModalDirective } from './modal.directive';\r\nimport { ModalContainerComponent } from './modal-container.component';\r\nimport { BsModalService } from './bs-modal.service';\r\nimport { PositioningService } from '@farris/ui-modal/positioning';\r\nimport { ComponentLoaderFactory } from '@farris/ui-modal/component-loader';\r\nimport { ModalButtonDirective } from './modal-button.directive';\r\nimport{FAreaResponseModule} from '@farris/ui-area-response';\r\nimport { FarrisTooltipModule } from '@farris/ui-tooltip';\r\n@NgModule({\r\n    imports: [\r\n        CommonModule,\r\n        PerfectScrollbarModule,\r\n        AngularDraggableModule,\r\n        FAreaResponseModule,\r\n        FarrisTooltipModule\r\n    ],\r\n    declarations: [\r\n        ModalDirective,\r\n        ModalBackdropComponent,\r\n        ModalContainerComponent,\r\n        ModalButtonDirective\r\n    ],\r\n    exports: [\r\n        ModalBackdropComponent, ModalDirective\r\n    ],\r\n    entryComponents: [ModalBackdropComponent, ModalContainerComponent]\r\n})\r\nexport class ModalModule {\r\n    static forRoot(): ModuleWithProviders {\r\n        return {\r\n            ngModule: ModalModule,\r\n            providers: [\r\n                ComponentLoaderFactory,\r\n                BsModalService,\r\n                PositioningService\r\n            ]\r\n        };\r\n    }\r\n}\r\n"],"names":["document","window"],"mappings":"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"}
