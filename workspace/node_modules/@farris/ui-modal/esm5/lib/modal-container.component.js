/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
import { Component, ElementRef, HostListener, Renderer2, ViewChild, Output, EventEmitter, TemplateRef, Input, ViewChildren, QueryList, HostBinding } from '@angular/core';
import { AngularDraggableDirective } from '@farris/ui-draggable';
import { DomSanitizer } from "@angular/platform-browser";
import { CLASS_NAME, DISMISS_REASONS, ModalOptions, TRANSITION_DURATIONS } from './modal-options.class';
import { isBs3 } from '@farris/ui-modal/utils';
import { ModalButtonDirective } from './modal-button.directive';
import { fromEvent } from 'rxjs';
import { debounceTime } from 'rxjs/operators';
var ModalContainerComponent = /** @class */ (function () {
    function ModalContainerComponent(options, el, _renderer, sanitizer) {
        var _this = this;
        this.el = el;
        this._renderer = _renderer;
        this.sanitizer = sanitizer;
        this.isShown = false;
        // 是否非模态窗口
        this.isModeless = false;
        this.isModalHiding = false;
        // 记录上次的高度
        this.isMax = false;
        this.closed = new EventEmitter();
        this.opened = new EventEmitter();
        this.resized = new EventEmitter();
        this.modalID = "MODALID_" + Date.now().toPrecision();
        this._windowResizeToMax = false;
        this.windowResize$ = null;
        this.config = Object.assign({}, options);
        if (!this.config.buttons) {
            this.config.buttons = [
                {
                    text: '取消',
                    cls: 'btn btn-light',
                    iconCls: 'k-icon k-i-close',
                    handle: (/**
                     * @return {?}
                     */
                    function () {
                        _this.close();
                    })
                },
                {
                    text: '确定',
                    cls: 'btn btn-primary',
                    iconCls: 'k-icon k-i-check',
                    handle: (/**
                     * @return {?}
                     */
                    function () { alert('好(｡･∀･)ﾉﾞ嗨哟!!'); })
                }
            ];
        }
        this.setIsModeless();
    }
    Object.defineProperty(ModalContainerComponent.prototype, "iframe", {
        set: /**
         * @param {?} value
         * @return {?}
         */
        function (value) {
            if (this.sanitizer) {
                this.iframeSrc = this.sanitizer.bypassSecurityTrustResourceUrl(value);
            }
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    ModalContainerComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        if (this.isModeless) {
            // 如果是非模态窗口
            this.boundsElement = null;
            this._renderer.addClass(this.el.nativeElement, 'f-modal-is-modeless');
        }
        else {
            this.boundsElement = this.el.nativeElement;
        }
        if (this.config.fitContent) {
            this._renderer.addClass(this.el.nativeElement, 'f-modal-fitContent');
        }
        if (this.isAnimated) {
            this._renderer.addClass(this.el.nativeElement, CLASS_NAME.FADE);
        }
        // this.ngZone.runOutsideAngular(() => {
        setTimeout((/**
         * @return {?}
         */
        function () {
            _this.isShown = true;
            _this._renderer.addClass(_this.el.nativeElement, isBs3() ? CLASS_NAME.IN : CLASS_NAME.SHOW);
            if (_this.isModeless) {
                _this._renderer.setStyle(_this.el.nativeElement, 'position', 'static');
            }
            _this._renderer.setStyle(_this.el.nativeElement, 'display', 'block');
            if (_this.config.fitContent && _this.el.nativeElement.className.indexOf('f-modal-fitContent-scroll') > -1) {
                _this.el.nativeElement.scrollTop = 0;
            }
            if (document && document.body) {
                /** @type {?} */
                var modalLen = _this.bsModalService.getModalsCount();
                if (modalLen === 1) {
                    _this.bsModalService.checkScrollbar();
                    _this.bsModalService.setScrollbar();
                }
                if (!document.body.classList.contains(CLASS_NAME.OPEN)) {
                    _this._renderer.addClass(document.body, CLASS_NAME.OPEN);
                }
            }
            _this.opened.emit({ modal: _this });
        }), this.isAnimated ? TRANSITION_DURATIONS.BACKDROP : 0);
        // });
        if (this.el.nativeElement) {
            this.el.nativeElement.focus();
        }
        this.dlgHeaderLineHeight = this.getDialogHeaderLineHeight() + 'px';
    };
    /**
     * @return {?}
     */
    ModalContainerComponent.prototype.ngAfterViewInit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        // Called after ngAfterContentInit when the component's view has been initialized. Applies to components only.
        // Add 'implements AfterViewInit' to the class.
        this._renderer.setStyle(this.el.nativeElement, 'display', 'block');
        // 如果内容适应宽度
        if (this.config.fitContent) {
            /** @type {?} */
            var initElRect = this.el.nativeElement.getBoundingClientRect();
            /** @type {?} */
            var initBodySize = this.getContainerSize();
            if (initElRect.height < initBodySize.height + 30) {
                this._renderer.addClass(this.el.nativeElement, 'f-modal-fitContent-scroll');
            }
        }
        this.originalHeight = this.config.height;
        this.originalWidth = this.config.width;
        this.windowResize$ = fromEvent(window, 'resize').pipe(debounceTime(50)).subscribe((/**
         * @param {?} e
         * @return {?}
         */
        function (e) {
            /** @type {?} */
            var winWidth = window.innerWidth - 20;
            /** @type {?} */
            var winHeight = window.innerHeight - 20;
            if (_this.config.width <= winWidth && _this.config.height <= winHeight) {
                if (_this._windowResizeToMax) {
                    _this.revertDialog();
                    _this._windowResizeToMax = false;
                }
                else {
                    if (_this.isMax) {
                        _this.maxDialog(false);
                    }
                }
            }
            else {
                if (!_this.isMax) {
                    _this._windowResizeToMax = true;
                    _this.maxDialog();
                }
                else {
                    _this.maxDialog(false);
                }
            }
            _this.toCenter();
            _this.moveTo(0, 0);
        }));
    };
    /**
     * @private
     * @return {?}
     */
    ModalContainerComponent.prototype.getDlgElement = /**
     * @private
     * @return {?}
     */
    function () {
        return this.el.nativeElement.querySelector('.modal-dialog');
    };
    /**
     * @private
     * @return {?}
     */
    ModalContainerComponent.prototype.getDialogHeaderLineHeight = /**
     * @private
     * @return {?}
     */
    function () {
        if (this.config.showHeader) {
            /** @type {?} */
            var modalHeaderStyles = window.getComputedStyle(this.modalHeader.nativeElement);
            /** @type {?} */
            var paddingTop = parseInt(modalHeaderStyles.paddingTop.replace('px', ''), 10);
            /** @type {?} */
            var paddingBottom = parseInt(modalHeaderStyles.paddingBottom.replace('px', ''), 10);
            return this.config.dialogHeaderHeight - paddingTop - paddingBottom;
        }
        else {
            return 0;
        }
    };
    // 获取内容区域的尺寸
    // 获取内容区域的尺寸
    /**
     * @return {?}
     */
    ModalContainerComponent.prototype.getContainerSize = 
    // 获取内容区域的尺寸
    /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var bodyTarget = this.el.nativeElement.querySelector('.modal-body');
        /** @type {?} */
        var height = bodyTarget.offsetHeight;
        /** @type {?} */
        var width = bodyTarget.offsetWidth;
        return { width: width, height: height };
    };
    /**
     * @return {?}
     */
    ModalContainerComponent.prototype.buildFooterStyles = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var styles = {};
        if (this.config.dialogFooterStyles) {
            styles = Object.assign({}, styles, this.config.dialogFooterStyles);
        }
        return styles;
    };
    /**
     * @return {?}
     */
    ModalContainerComponent.prototype.useButtonsTemplate = /**
     * @return {?}
     */
    function () {
        return this.config.buttons instanceof TemplateRef;
    };
    /**
     * @param {?} event
     * @return {?}
     */
    ModalContainerComponent.prototype.onClick = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        /** @type {?} */
        var tag = (/** @type {?} */ (event.target));
        // if (tag.localName === 'label') {
        //     if (tag.className) {
        //         const clsList = tag.className.split(' ');
        //         if (
        //             clsList.indexOf('k-radio-label') > -1 ||
        //             clsList.indexOf('k-checkbox-label') > -1 ||
        //             clsList.indexOf('custom-control-label') > -1
        //         ) {
        //             return;
        //         }
        //     }
        // }
        // if (tag.localName === 'input' && (tag.type === 'checkbox' || tag.type === 'radio' || tag.type === 'file')) {
        //     return;
        // }
        if (this.config.ignoreBackdropClick || this.config.backdrop === 'static' || event.target !== this.el.nativeElement) {
            event.stopPropagation();
            return;
        }
        this.bsModalService.setDismissReason(DISMISS_REASONS.BACKRDOP);
        this.close();
    };
    /**
     * @param {?} event
     * @return {?}
     */
    ModalContainerComponent.prototype.onEsc = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        if (!this.isShown) {
            return;
        }
        if (event.keyCode === 27) {
            event.preventDefault();
        }
        /**从最后一个窗口开始关闭 */
        if (this.config.keyboard &&
            this.level === this.bsModalService.getModalsCount()) {
            this.bsModalService.setDismissReason(DISMISS_REASONS.ESC);
            this.close(event);
        }
    };
    /**
     * @return {?}
     */
    ModalContainerComponent.prototype.ngOnDestroy = /**
     * @return {?}
     */
    function () {
        if (this.isShown) {
            this.close();
        }
        if (this.windowResize$) {
            this.windowResize$.unsubscribe();
            this.windowResize$ = null;
        }
    };
    /**
     * @param {?=} e
     * @param {?=} isCloseButton
     * @return {?}
     */
    ModalContainerComponent.prototype.close = /**
     * @param {?=} e
     * @param {?=} isCloseButton
     * @return {?}
     */
    function (e, isCloseButton) {
        var _this = this;
        if (isCloseButton === void 0) { isCloseButton = false; }
        if (e && e.stopPropagation) {
            e.stopPropagation();
        }
        if (this.isModalHiding || !this.isShown) {
            return;
        }
        this.config.beforeClose(this, { event: e }).subscribe((/**
         * @param {?} r
         * @return {?}
         */
        function (r) {
            if (!r) {
                return false;
            }
            // 更新服务中非模态窗口的个数
            _this.bsModalService.closeUpdateModelessCountByModal(_this.isModeless);
            _this.isModalHiding = true;
            _this._renderer.removeClass(_this.el.nativeElement, isBs3() ? CLASS_NAME.IN : CLASS_NAME.SHOW);
            setTimeout((/**
             * @return {?}
             */
            function () {
                _this.isShown = false;
                _this.bsModalService.hide(_this.level);
                _this.isModalHiding = false;
                if (document && document.body && !document.querySelectorAll('.farris-modal.show').length) {
                    _this._renderer.removeClass(document.body, CLASS_NAME.OPEN);
                }
                if (_this.config.closed) {
                    _this.config.closed(isCloseButton, { modalRef: _this, event: e });
                }
                _this.closed.emit(_this.level);
            }), _this.isAnimated ? TRANSITION_DURATIONS.MODAL : 0);
            // });
        }));
    };
    /**
     * @return {?}
     */
    ModalContainerComponent.prototype.toCenter = /**
     * @return {?}
     */
    function () {
        var _this = this;
        /** @type {?} */
        var marginLeft = Number.parseInt('' + -this.config.width / 2);
        /** @type {?} */
        var marginTop = Number.parseInt('' + -this.config.height / 2);
        /** @type {?} */
        var dialogEl = this.el.nativeElement.querySelector('.modal-dialog');
        /** @type {?} */
        var contentEl = this.el.nativeElement.querySelector('.modal-body');
        // this._renderer.setStyle(dialogEl, 'margin-left', marginLeft);
        // this._renderer.setStyle(dialogEl, 'margin-top', marginTop);
        this._renderer.setStyle(dialogEl, 'left', window.innerWidth / 2 + marginLeft + "px");
        this._renderer.setStyle(dialogEl, 'top', window.innerHeight / 2 + marginTop + "px");
        /** @type {?} */
        var contentHeight = this.config.height - 38;
        if (this.config.showButtons) {
            contentHeight = contentHeight - 50;
        }
        if (!this.config.fitContent) {
            this._renderer.setStyle(contentEl, 'height', contentHeight + 'px');
        }
        this._renderer.setStyle(contentEl, 'overflow', 'hidden');
        this._renderer.setStyle(dialogEl, 'transform', "translate3d(0px, 0px, 0px)");
        setTimeout((/**
         * @return {?}
         */
        function () {
            /** @type {?} */
            var container = _this.getContainerSize();
            var containerWidth = container.width, containerHeight = container.height;
            _this.resized.emit({ width: _this.config.width, height: _this.config.height, containerWidth: containerWidth, containerHeight: containerHeight });
        }));
    };
    /**
     * @param {?} x
     * @param {?} y
     * @return {?}
     */
    ModalContainerComponent.prototype.moveTo = /**
     * @param {?} x
     * @param {?} y
     * @return {?}
     */
    function (x, y) {
        /** @type {?} */
        var dialogEl = this.el.nativeElement.querySelector('.modal-dialog');
        this._renderer.setStyle(dialogEl, 'transform', "translate3d(" + x + "px, " + y + "px, 0px)");
        // this._renderer.setStyle(dialogEl, 'top', '50%');
        // this._renderer.setStyle(dialogEl, 'left', '50%');
        // const marginLeft = Number.parseInt('' + -this.config.width / 2);
        // const marginTop = Number.parseInt('' + -this.config.height / 2);
        // this._renderer.setStyle(dialogEl, 'left', `${window.innerWidth / 2 + marginLeft}px`);
        // this._renderer.setStyle(dialogEl, 'top',  `${window.innerHeight / 2 + marginTop}px`);
        this.draggbar.position = { x: x, y: y };
        this.draggbar.resetPosition();
    };
    /**
     * @param {?=} rememberPrevSize
     * @return {?}
     */
    ModalContainerComponent.prototype.maxDialog = /**
     * @param {?=} rememberPrevSize
     * @return {?}
     */
    function (rememberPrevSize) {
        if (rememberPrevSize === void 0) { rememberPrevSize = true; }
        if (rememberPrevSize) {
            this.prevWidth = this.config.width;
            this.prevHeight = this.config.height;
        }
        // this.config.width = (document.scrollingElement?document.scrollingElement:document.documentElement)['clientWidth'] - 20;
        // this.config.height = (document.scrollingElement?document.scrollingElement:document.documentElement)['clientHeight'] - 20;
        this.config.width = window.innerWidth - 20;
        this.config.height = window.innerHeight - 20;
        this.config.draggable = false;
        this.config.resizable = false;
        /** @type {?} */
        var dialogEl = this.el.nativeElement.querySelector('.modal-dialog');
        this._renderer.addClass(dialogEl, 'model-dialog-maximize');
        this._renderer.setStyle(dialogEl, 'top', '50%');
        this._renderer.setStyle(dialogEl, 'left', '50%');
        this.isMax = true;
        this.toCenter();
        this.moveTo(0, 0);
    };
    /**
     * @param {?} width
     * @param {?} height
     * @return {?}
     */
    ModalContainerComponent.prototype.resize = /**
     * @param {?} width
     * @param {?} height
     * @return {?}
     */
    function (width, height) {
        if (width) {
            this.config.width = width;
        }
        if (height) {
            this.config.height = height;
        }
        /** @type {?} */
        var dialogEl = this.el.nativeElement.querySelector('.modal-dialog');
        this._renderer.removeClass(dialogEl, 'model-dialog-maximize');
        this.toCenter();
        this.draggbar.resetPosition();
    };
    /**
     * @param {?} el
     * @return {?}
     */
    ModalContainerComponent.prototype.dropdown = /**
     * @param {?} el
     * @return {?}
     */
    function (el) {
        // const rect = el.getBoundingClientRect();
        // this._renderer.removeStyle(el, 'margin-top');
        // this._renderer.removeStyle(el, 'margin-left');
        // this._renderer.setStyle(el, 'top', `${rect.top}px`);
        // this._renderer.setStyle(el, 'left', `${rect.left}px`);
        // this._renderer.removeStyle(el, 'transform');
        // this._renderer.removeStyle(el, '-webkit-transform');
        // this._renderer.removeStyle(el, '-ms-transform');
        // this._renderer.removeStyle(el, '-moz-transform');
        // this._renderer.removeStyle(el, '-o-transform');
    };
    /**
     * @return {?}
     */
    ModalContainerComponent.prototype.revertDialog = /**
     * @return {?}
     */
    function () {
        this.isMax = false;
        /** @type {?} */
        var ww = window.innerWidth - 20;
        /** @type {?} */
        var wh = window.innerHeight - 20;
        this.config.width = this.prevWidth == ww ? this.originalWidth : this.prevWidth;
        this.config.height = this.prevHeight == wh ? this.originalHeight : this.prevHeight;
        if (this.config.width > ww) {
            this.config.width = ww;
        }
        if (this.config.height > wh) {
            this.config.height = wh;
        }
        this.config.draggable = true;
        this.config.resizable = true;
        /** @type {?} */
        var dialogEl = this.el.nativeElement.querySelector('.modal-dialog');
        this._renderer.removeClass(dialogEl, 'model-dialog-maximize');
        this.toCenter();
        this.draggbar.resetPosition();
    };
    /**
     * @return {?}
     */
    ModalContainerComponent.prototype.changeDialogSize = /**
     * @return {?}
     */
    function () {
        if (this.isMax) {
            this.revertDialog();
        }
        else {
            this.maxDialog();
        }
        this._windowResizeToMax = false;
    };
    /**
     * @param {?} opts
     * @return {?}
     */
    ModalContainerComponent.prototype.resizeStop = /**
     * @param {?} opts
     * @return {?}
     */
    function (opts) {
        // console.log('resizeStop');
        this.config.width = opts.size.width;
        this.config.height = opts.size.height;
        /** @type {?} */
        var container = this.getContainerSize();
        var containerWidth = container.width, containerHeight = container.height;
        this.resized.emit(tslib_1.__assign({}, opts.size, { containerWidth: containerWidth, containerHeight: containerHeight }));
    };
    /**
     * 是否非模态
     * @returns
     */
    /**
     * 是否非模态
     * @return {?}
     */
    ModalContainerComponent.prototype.setIsModeless = /**
     * 是否非模态
     * @return {?}
     */
    function () {
        if (this.config.hasOwnProperty('modeless')) {
            this.isModeless = this.config['modeless'];
        }
        else {
            this.isModeless = false;
        }
    };
    /**
     * @param {?} zIndex
     * @return {?}
     */
    ModalContainerComponent.prototype.updateDialogZindex = /**
     * @param {?} zIndex
     * @return {?}
     */
    function (zIndex) {
        if (this.isModeless) {
            /** @type {?} */
            var modalEl = this.el.nativeElement;
            /** @type {?} */
            var dialogEl = modalEl.querySelector('.modal-dialog');
            this._renderer.setStyle(dialogEl, 'position', 'fixed');
            this._renderer.setStyle(dialogEl, 'zIndex', zIndex ? zIndex : modalEl.style.zIndex);
        }
    };
    ModalContainerComponent.decorators = [
        { type: Component, args: [{
                    selector: 'modal-container',
                    template: "\n    <div [attr.id]=\"modalID\"\n\n        [ngDraggable]=\"config.draggable\"\n        [ngResizable]=\"config.resizable\"\n        [rzMinWidth]=\"config.minWidth\"\n        [rzMaxWidth]=\"config.maxWidth\"\n        [rzMinHeight]=\"config.minHeight\"\n        [rzMaxHeight]=\"config.maxHeight\"\n        rzHandles=\"all\" [handle]=\"config.showHeader ? header:dragEl\"\n        (stopped)=\"dropdown($event)\"\n        (rzStop)=\"resizeStop($event)\"\n        [inBounds]=\"true\" [bounds]=\"boundsElement\" [rzContainment]=\"boundsElement\" [isFixed]=\"isModeless\"\n        [class]=\"'modal-dialog' + (config.class ? ' ' + config.class : '')\" role=\"document\"\n        [style.width]=\"config.width + 'px'\" [style.height]=\"config.fitContent?'auto':(config.height + 'px')\"\n        style=\"position: absolute;top: 50%;left: 50%;\">\n        <div class=\"modal-content\" [ngClass]=\"{'modal-content--has-header':config.showHeader}\">\n            <div #header class=\"modal-header\" [style.display]=\"config.showHeader ? '': 'none'\">\n                <div class=\"modal-title\">\n                    <span *ngIf=\"config.iconCls\" [class]=\"config.iconCls\" style=\"margin-right: 8px\"></span>\n                    <span class=\"modal-title-label\">{{ config.title }}</span>\n                </div>\n                <div class=\"actions\">\n                    <ul>\n                        <li *ngIf=\"config.showMinButton\" class=\"f-btn-icon f-bare\">\n                            <span class=\"f-icon modal_minimize\"></span></li>\n                        <li *ngIf=\"config.showMaxButton\" (click)=\"changeDialogSize()\" class=\"f-btn-icon f-bare\">\n                            <span class=\"f-icon modal_maximize\" [class.modalrevert]=\"isMax\"></span>\n                        </li>\n                        <li *ngIf=\"config.showCloseButton\" (click)=\"close($event, true)\" class=\"f-btn-icon f-bare\">\n                             <span class=\"f-icon modal_close\"></span>\n                        </li>\n                    </ul>\n                </div>\n            </div>\n        <div #dragEl class=\"f-utils-absolute-all\" style=\"height:10px;z-index: 1;\" [style.display]=\"config.showHeader ? 'none': ''\"></div>\n            <div class=\"modal-body\" [class.f-utils-flex-column]=\"dialogType === 'iframe'\"   [f-area-response]=\"config.areaResponse\">\n                <perfect-scrollbar [config]=\"{}\" [disabled]=\"!config.enableScroll||config.fitContent\"  *ngIf=\"!dialogType || dialogType === 'default'\">\n                    <ng-content ></ng-content>\n                </perfect-scrollbar>\n                <iframe *ngIf=\"dialogType === 'iframe'\" class=\"f-utils-fill\" width=\"100%\" frameborder=\"0\" [src]=\"iframeSrc\"></iframe>\n            </div>\n\n            <div [style.textAlign]=\"config.buttonAlign\" class=\"modal-footer\" [ngStyle]=\"buildFooterStyles()\" *ngIf=\"config.showButtons && config.buttons\">\n                <ng-container [ngTemplateOutlet]=\"useButtonsTemplate() ? config.buttons : defaultButtonRef\"></ng-container>\n            </div>\n        </div>\n    </div>\n\n    <ng-template #defaultButtonRef>\n\n        <ng-container *ngFor=\"let btn of config.buttons; last as isLast\">\n            <button type=\"button\" modal-button  *ngIf=\"btn.display === undefined && btn.tipsEnable === undefined\"\n                [class]=\"btn.cls\"\n                (click)=\"btn.handle && btn.handle($event) \">\n                <span [class]=\"btn.iconCls\" *ngIf=\"btn.iconCls\"></span> {{ btn.text }}\n            </button>\n\n            <button type=\"button\" modal-button  *ngIf=\"btn.display !== undefined || btn.tipsEnable !== undefined\"\n                [class]=\"btn.cls\"\n                (click)=\"btn.handle && btn.handle($event) \" \n                [style.display]=\"(btn.display === true || btn.display === undefined) ? '' : 'none'\"\n                [farrisTooltip]=\"btn?.tipsEnable\" [placement]=\"'top'\" [delay]=\"500\" [content]=\"btn?.tipsText\">\n                <span [class]=\"btn.iconCls\" *ngIf=\"btn.iconCls\"></span> {{ btn.text }}\n            </button>\n\n        </ng-container>\n\n    </ng-template>\n  ",
                    host: {
                        class: 'modal farris-modal',
                        role: 'dialog',
                        tabindex: '-1',
                        '[attr.aria-modal]': 'true'
                    }
                }] }
    ];
    /** @nocollapse */
    ModalContainerComponent.ctorParameters = function () { return [
        { type: ModalOptions },
        { type: ElementRef },
        { type: Renderer2 },
        { type: DomSanitizer }
    ]; };
    ModalContainerComponent.propDecorators = {
        iframe: [{ type: Input }],
        draggbar: [{ type: ViewChild, args: [AngularDraggableDirective,] }],
        modalHeader: [{ type: ViewChild, args: ['header',] }],
        closed: [{ type: Output }],
        opened: [{ type: Output }],
        resized: [{ type: Output }],
        modalID: [{ type: HostBinding, args: ['id',] }],
        buttons: [{ type: ViewChildren, args: [ModalButtonDirective,] }],
        onClick: [{ type: HostListener, args: ['click', ['$event'],] }],
        onEsc: [{ type: HostListener, args: ['window:keydown.esc', ['$event'],] }]
    };
    return ModalContainerComponent;
}());
export { ModalContainerComponent };
if (false) {
    /** @type {?} */
    ModalContainerComponent.prototype.config;
    /** @type {?} */
    ModalContainerComponent.prototype.isShown;
    /** @type {?} */
    ModalContainerComponent.prototype.level;
    /** @type {?} */
    ModalContainerComponent.prototype.isAnimated;
    /** @type {?} */
    ModalContainerComponent.prototype.bsModalService;
    /** @type {?} */
    ModalContainerComponent.prototype.dialogType;
    /** @type {?} */
    ModalContainerComponent.prototype.iframeSrc;
    /** @type {?} */
    ModalContainerComponent.prototype.isModeless;
    /**
     * @type {?}
     * @private
     */
    ModalContainerComponent.prototype.isModalHiding;
    /**
     * @type {?}
     * @private
     */
    ModalContainerComponent.prototype.originalWidth;
    /**
     * @type {?}
     * @private
     */
    ModalContainerComponent.prototype.originalHeight;
    /**
     * @type {?}
     * @private
     */
    ModalContainerComponent.prototype.prevWidth;
    /**
     * @type {?}
     * @private
     */
    ModalContainerComponent.prototype.prevHeight;
    /** @type {?} */
    ModalContainerComponent.prototype.isMax;
    /** @type {?} */
    ModalContainerComponent.prototype.draggbar;
    /** @type {?} */
    ModalContainerComponent.prototype.modalHeader;
    /** @type {?} */
    ModalContainerComponent.prototype.boundsElement;
    /** @type {?} */
    ModalContainerComponent.prototype.closed;
    /** @type {?} */
    ModalContainerComponent.prototype.opened;
    /** @type {?} */
    ModalContainerComponent.prototype.resized;
    /** @type {?} */
    ModalContainerComponent.prototype.modalID;
    /** @type {?} */
    ModalContainerComponent.prototype.buttons;
    /** @type {?} */
    ModalContainerComponent.prototype.dlgHeaderLineHeight;
    /**
     * @type {?}
     * @private
     */
    ModalContainerComponent.prototype._windowResizeToMax;
    /**
     * @type {?}
     * @private
     */
    ModalContainerComponent.prototype.windowResize$;
    /**
     * @type {?}
     * @protected
     */
    ModalContainerComponent.prototype.el;
    /**
     * @type {?}
     * @private
     */
    ModalContainerComponent.prototype._renderer;
    /**
     * @type {?}
     * @private
     */
    ModalContainerComponent.prototype.sanitizer;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibW9kYWwtY29udGFpbmVyLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BmYXJyaXMvdWktbW9kYWwvIiwic291cmNlcyI6WyJsaWIvbW9kYWwtY29udGFpbmVyLmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7OztBQUFBLE9BQU8sRUFDSCxTQUFTLEVBQUUsVUFBVSxFQUFFLFlBQVksRUFDM0IsU0FBUyxFQUFFLFNBQVMsRUFBRSxNQUFNLEVBQ3BDLFlBQVksRUFBRSxXQUFXLEVBQWlCLEtBQUssRUFFL0MsWUFBWSxFQUNaLFNBQVMsRUFDVCxXQUFXLEVBQ2QsTUFBTSxlQUFlLENBQUM7QUFDdkIsT0FBTyxFQUFFLHlCQUF5QixFQUFFLE1BQU0sc0JBQXNCLENBQUM7QUFDakUsT0FBTyxFQUFFLFlBQVksRUFBbUIsTUFBTSwyQkFBMkIsQ0FBQztBQUMxRSxPQUFPLEVBQ0gsVUFBVSxFQUFFLGVBQWUsRUFDM0IsWUFBWSxFQUFFLG9CQUFvQixFQUNyQyxNQUFNLHVCQUF1QixDQUFDO0FBRS9CLE9BQU8sRUFBRSxLQUFLLEVBQUUsTUFBTSx3QkFBd0IsQ0FBQztBQUMvQyxPQUFPLEVBQUUsb0JBQW9CLEVBQUUsTUFBTSwwQkFBMEIsQ0FBQztBQUNoRSxPQUFPLEVBQUUsU0FBUyxFQUFnQixNQUFNLE1BQU0sQ0FBQztBQUMvQyxPQUFPLEVBQUUsWUFBWSxFQUFTLE1BQU0sZ0JBQWdCLENBQUM7QUFFckQ7SUFzSEksaUNBQ0ksT0FBcUIsRUFDWCxFQUFjLEVBQ2hCLFNBQW9CLEVBQ3BCLFNBQXVCO1FBSm5DLGlCQTBCQztRQXhCYSxPQUFFLEdBQUYsRUFBRSxDQUFZO1FBQ2hCLGNBQVMsR0FBVCxTQUFTLENBQVc7UUFDcEIsY0FBUyxHQUFULFNBQVMsQ0FBYztRQXpDbkMsWUFBTyxHQUFHLEtBQUssQ0FBQzs7UUFPaEIsZUFBVSxHQUFDLEtBQUssQ0FBQztRQU9ULGtCQUFhLEdBQUcsS0FBSyxDQUFDOztRQU05QixVQUFLLEdB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Ozs7SUFDMUIsNkNBQTJCOztJQUMzQix3Q0FBYzs7SUFFZCwyQ0FBMEU7O0lBQzFFLDhDQUE2Qzs7SUFDN0MsZ0RBQTJCOztJQUUzQix5Q0FBc0M7O0lBQ3RDLHlDQUFzQzs7SUFDdEMsMENBQXVDOztJQUV2QywwQ0FBbUU7O0lBRW5FLDBDQUE2RTs7SUFFN0Usc0RBQXlCOzs7OztJQUN6QixxREFBbUM7Ozs7O0lBQ25DLGdEQUEyQzs7Ozs7SUFHdkMscUNBQXdCOzs7OztJQUN4Qiw0Q0FBNEI7Ozs7O0lBQzVCLDRDQUErQiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XHJcbiAgICBDb21wb25lbnQsIEVsZW1lbnRSZWYsIEhvc3RMaXN0ZW5lciwgT25EZXN0cm95LFxyXG4gICAgT25Jbml0LCBSZW5kZXJlcjIsIFZpZXdDaGlsZCwgT3V0cHV0LFxyXG4gICAgRXZlbnRFbWl0dGVyLCBUZW1wbGF0ZVJlZiwgQWZ0ZXJWaWV3SW5pdCwgSW5wdXQsXHJcbiAgICBOZ1pvbmUsXHJcbiAgICBWaWV3Q2hpbGRyZW4sXHJcbiAgICBRdWVyeUxpc3QsXHJcbiAgICBIb3N0QmluZGluZ1xyXG59IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBBbmd1bGFyRHJhZ2dhYmxlRGlyZWN0aXZlIH0gZnJvbSAnQGZhcnJpcy91aS1kcmFnZ2FibGUnO1xyXG5pbXBvcnQgeyBEb21TYW5pdGl6ZXIsIFNhZmVSZXNvdXJjZVVybCB9IGZyb20gXCJAYW5ndWxhci9wbGF0Zm9ybS1icm93c2VyXCI7XHJcbmltcG9ydCB7XHJcbiAgICBDTEFTU19OQU1FLCBESVNNSVNTX1JFQVNPTlMsXHJcbiAgICBNb2RhbE9wdGlvbnMsIFRSQU5TSVRJT05fRFVSQVRJT05TXHJcbn0gZnJvbSAnLi9tb2RhbC1vcHRpb25zLmNsYXNzJztcclxuaW1wb3J0IHsgQnNNb2RhbFNlcnZpY2UgfSBmcm9tICcuL2JzLW1vZGFsLnNlcnZpY2UnO1xyXG5pbXBvcnQgeyBpc0JzMyB9IGZyb20gJ0BmYXJyaXMvdWktbW9kYWwvdXRpbHMnO1xyXG5pbXBvcnQgeyBNb2RhbEJ1dHRvbkRpcmVjdGl2ZSB9IGZyb20gJy4vbW9kYWwtYnV0dG9uLmRpcmVjdGl2ZSc7XHJcbmltcG9ydCB7IGZyb21FdmVudCwgU3Vic2NyaXB0aW9uIH0gZnJvbSAncnhqcyc7XHJcbmltcG9ydCB7IGRlYm91bmNlVGltZSwgZGVsYXkgfSBmcm9tICdyeGpzL29wZXJhdG9ycyc7XHJcblxyXG5AQ29tcG9uZW50KHtcclxuICAgIHNlbGVjdG9yOiAnbW9kYWwtY29udGFpbmVyJyxcclxuICAgIHRlbXBsYXRlOiBgXHJcbiAgICA8ZGl2IFthdHRyLmlkXT1cIm1vZGFsSURcIlxyXG5cclxuICAgICAgICBbbmdEcmFnZ2FibGVdPVwiY29uZmlnLmRyYWdnYWJsZVwiXHJcbiAgICAgICAgW25nUmVzaXphYmxlXT1cImNvbmZpZy5yZXNpemFibGVcIlxyXG4gICAgICAgIFtyek1pbldpZHRoXT1cImNvbmZpZy5taW5XaWR0aFwiXHJcbiAgICAgICAgW3J6TWF4V2lkdGhdPVwiY29uZmlnLm1heFdpZHRoXCJcclxuICAgICAgICBbcnpNaW5IZWlnaHRdPVwiY29uZmlnLm1pbkhlaWdodFwiXHJcbiAgICAgICAgW3J6TWF4SGVpZ2h0XT1cImNvbmZpZy5tYXhIZWlnaHRcIlxyXG4gICAgICAgIHJ6SGFuZGxlcz1cImFsbFwiIFtoYW5kbGVdPVwiY29uZmlnLnNob3dIZWFkZXIgPyBoZWFkZXI6ZHJhZ0VsXCJcclxuICAgICAgICAoc3RvcHBlZCk9XCJkcm9wZG93bigkZXZlbnQpXCJcclxuICAgICAgICAocnpTdG9wKT1cInJlc2l6ZVN0b3AoJGV2ZW50KVwiXHJcbiAgICAgICAgW2luQm91bmRzXT1cInRydWVcIiBbYm91bmRzXT1cImJvdW5kc0VsZW1lbnRcIiBbcnpDb250YWlubWVudF09XCJib3VuZHNFbGVtZW50XCIgW2lzRml4ZWRdPVwiaXNNb2RlbGVzc1wiXHJcbiAgICAgICAgW2NsYXNzXT1cIidtb2RhbC1kaWFsb2cnICsgKGNvbmZpZy5jbGFzcyA/ICcgJyArIGNvbmZpZy5jbGFzcyA6ICcnKVwiIHJvbGU9XCJkb2N1bWVudFwiXHJcbiAgICAgICAgW3N0eWxlLndpZHRoXT1cImNvbmZpZy53aWR0aCArICdweCdcIiBbc3R5bGUuaGVpZ2h0XT1cImNvbmZpZy5maXRDb250ZW50PydhdXRvJzooY29uZmlnLmhlaWdodCArICdweCcpXCJcclxuICAgICAgICBzdHlsZT1cInBvc2l0aW9uOiBhYnNvbHV0ZTt0b3A6IDUwJTtsZWZ0OiA1MCU7XCI+XHJcbiAgICAgICAgPGRpdiBjbGFzcz1cIm1vZGFsLWNvbnRlbnRcIiBbbmdDbGFzc109XCJ7J21vZGFsLWNvbnRlbnQtLWhhcy1oZWFkZXInOmNvbmZpZy5zaG93SGVhZGVyfVwiPlxyXG4gICAgICAgICAgICA8ZGl2ICNoZWFkZXIgY2xhc3M9XCJtb2RhbC1oZWFkZXJcIiBbc3R5bGUuZGlzcGxheV09XCJjb25maWcuc2hvd0hlYWRlciA/ICcnOiAnbm9uZSdcIj5cclxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJtb2RhbC10aXRsZVwiPlxyXG4gICAgICAgICAgICAgICAgICAgIDxzcGFuICpuZ0lmPVwiY29uZmlnLmljb25DbHNcIiBbY2xhc3NdPVwiY29uZmlnLmljb25DbHNcIiBzdHlsZT1cIm1hcmdpbi1yaWdodDogOHB4XCI+PC9zcGFuPlxyXG4gICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPVwibW9kYWwtdGl0bGUtbGFiZWxcIj57eyBjb25maWcudGl0bGUgfX08L3NwYW4+XHJcbiAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJhY3Rpb25zXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgPHVsPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8bGkgKm5nSWY9XCJjb25maWcuc2hvd01pbkJ1dHRvblwiIGNsYXNzPVwiZi1idG4taWNvbiBmLWJhcmVcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPVwiZi1pY29uIG1vZGFsX21pbmltaXplXCI+PC9zcGFuPjwvbGk+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxsaSAqbmdJZj1cImNvbmZpZy5zaG93TWF4QnV0dG9uXCIgKGNsaWNrKT1cImNoYW5nZURpYWxvZ1NpemUoKVwiIGNsYXNzPVwiZi1idG4taWNvbiBmLWJhcmVcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPVwiZi1pY29uIG1vZGFsX21heGltaXplXCIgW2NsYXNzLm1vZGFscmV2ZXJ0XT1cImlzTWF4XCI+PC9zcGFuPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8L2xpPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8bGkgKm5nSWY9XCJjb25maWcuc2hvd0Nsb3NlQnV0dG9uXCIgKGNsaWNrKT1cImNsb3NlKCRldmVudCwgdHJ1ZSlcIiBjbGFzcz1cImYtYnRuLWljb24gZi1iYXJlXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9XCJmLWljb24gbW9kYWxfY2xvc2VcIj48L3NwYW4+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDwvbGk+XHJcbiAgICAgICAgICAgICAgICAgICAgPC91bD5cclxuICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICA8ZGl2ICNkcmFnRWwgY2xhc3M9XCJmLXV0aWxzLWFic29sdXRlLWFsbFwiIHN0eWxlPVwiaGVpZ2h0OjEwcHg7ei1pbmRleDogMTtcIiBbc3R5bGUuZGlzcGxheV09XCJjb25maWcuc2hvd0hlYWRlciA/ICdub25lJzogJydcIj48L2Rpdj5cclxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cIm1vZGFsLWJvZHlcIiBbY2xhc3MuZi11dGlscy1mbGV4LWNvbHVtbl09XCJkaWFsb2dUeXBlID09PSAnaWZyYW1lJ1wiICAgW2YtYXJlYS1yZXNwb25zZV09XCJjb25maWcuYXJlYVJlc3BvbnNlXCI+XHJcbiAgICAgICAgICAgICAgICA8cGVyZmVjdC1zY3JvbGxiYXIgW2NvbmZpZ109XCJ7fVwiIFtkaXNhYmxlZF09XCIhY29uZmlnLmVuYWJsZVNjcm9sbHx8Y29uZmlnLmZpdENvbnRlbnRcIiAgKm5nSWY9XCIhZGlhbG9nVHlwZSB8fCBkaWFsb2dUeXBlID09PSAnZGVmYXVsdCdcIj5cclxuICAgICAgICAgICAgICAgICAgICA8bmctY29udGVudCA+PC9uZy1jb250ZW50PlxyXG4gICAgICAgICAgICAgICAgPC9wZXJmZWN0LXNjcm9sbGJhcj5cclxuICAgICAgICAgICAgICAgIDxpZnJhbWUgKm5nSWY9XCJkaWFsb2dUeXBlID09PSAnaWZyYW1lJ1wiIGNsYXNzPVwiZi11dGlscy1maWxsXCIgd2lkdGg9XCIxMDAlXCIgZnJhbWVib3JkZXI9XCIwXCIgW3NyY109XCJpZnJhbWVTcmNcIj48L2lmcmFtZT5cclxuICAgICAgICAgICAgPC9kaXY+XHJcblxyXG4gICAgICAgICAgICA8ZGl2IFtzdHlsZS50ZXh0QWxpZ25dPVwiY29uZmlnLmJ1dHRvbkFsaWduXCIgY2xhc3M9XCJtb2RhbC1mb290ZXJcIiBbbmdTdHlsZV09XCJidWlsZEZvb3RlclN0eWxlcygpXCIgKm5nSWY9XCJjb25maWcuc2hvd0J1dHRvbnMgJiYgY29uZmlnLmJ1dHRvbnNcIj5cclxuICAgICAgICAgICAgICAgIDxuZy1jb250YWluZXIgW25nVGVtcGxhdGVPdXRsZXRdPVwidXNlQnV0dG9uc1RlbXBsYXRlKCkgPyBjb25maWcuYnV0dG9ucyA6IGRlZmF1bHRCdXR0b25SZWZcIj48L25nLWNvbnRhaW5lcj5cclxuICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgPC9kaXY+XHJcbiAgICA8L2Rpdj5cclxuXHJcbiAgICA8bmctdGVtcGxhdGUgI2RlZmF1bHRCdXR0b25SZWY+XHJcblxyXG4gICAgICAgIDxuZy1jb250YWluZXIgKm5nRm9yPVwibGV0IGJ0biBvZiBjb25maWcuYnV0dG9uczsgbGFzdCBhcyBpc0xhc3RcIj5cclxuICAgICAgICAgICAgPGJ1dHRvbiB0eXBlPVwiYnV0dG9uXCIgbW9kYWwtYnV0dG9uICAqbmdJZj1cImJ0bi5kaXNwbGF5ID09PSB1bmRlZmluZWQgJiYgYnRuLnRpcHNFbmFibGUgPT09IHVuZGVmaW5lZFwiXHJcbiAgICAgICAgICAgICAgICBbY2xhc3NdPVwiYnRuLmNsc1wiXHJcbiAgICAgICAgICAgICAgICAoY2xpY2spPVwiYnRuLmhhbmRsZSAmJiBidG4uaGFuZGxlKCRldmVudCkgXCI+XHJcbiAgICAgICAgICAgICAgICA8c3BhbiBbY2xhc3NdPVwiYnRuLmljb25DbHNcIiAqbmdJZj1cImJ0bi5pY29uQ2xzXCI+PC9zcGFuPiB7eyBidG4udGV4dCB9fVxyXG4gICAgICAgICAgICA8L2J1dHRvbj5cclxuXHJcbiAgICAgICAgICAgIDxidXR0b24gdHlwZT1cImJ1dHRvblwiIG1vZGFsLWJ1dHRvbiAgKm5nSWY9XCJidG4uZGlzcGxheSAhPT0gdW5kZWZpbmVkIHx8IGJ0bi50aXBzRW5hYmxlICE9PSB1bmRlZmluZWRcIlxyXG4gICAgICAgICAgICAgICAgW2NsYXNzXT1cImJ0bi5jbHNcIlxyXG4gICAgICAgICAgICAgICAgKGNsaWNrKT1cImJ0bi5oYW5kbGUgJiYgYnRuLmhhbmRsZSgkZXZlbnQpIFwiIFxyXG4gICAgICAgICAgICAgICAgW3N0eWxlLmRpc3BsYXldPVwiKGJ0bi5kaXNwbGF5ID09PSB0cnVlIHx8IGJ0bi5kaXNwbGF5ID09PSB1bmRlZmluZWQpID8gJycgOiAnbm9uZSdcIlxyXG4gICAgICAgICAgICAgICAgW2ZhcnJpc1Rvb2x0aXBdPVwiYnRuPy50aXBzRW5hYmxlXCIgW3BsYWNlbWVudF09XCIndG9wJ1wiIFtkZWxheV09XCI1MDBcIiBbY29udGVudF09XCJidG4/LnRpcHNUZXh0XCI+XHJcbiAgICAgICAgICAgICAgICA8c3BhbiBbY2xhc3NdPVwiYnRuLmljb25DbHNcIiAqbmdJZj1cImJ0bi5pY29uQ2xzXCI+PC9zcGFuPiB7eyBidG4udGV4dCB9fVxyXG4gICAgICAgICAgICA8L2J1dHRvbj5cclxuXHJcbiAgICAgICAgPC9uZy1jb250YWluZXI+XHJcblxyXG4gICAgPC9uZy10ZW1wbGF0ZT5cclxuICBgLFxyXG4gICAgaG9zdDoge1xyXG4gICAgICAgIGNsYXNzOiAnbW9kYWwgZmFycmlzLW1vZGFsJyxcclxuICAgICAgICByb2xlOiAnZGlhbG9nJyxcclxuICAgICAgICB0YWJpbmRleDogJy0xJyxcclxuICAgICAgICAnW2F0dHIuYXJpYS1tb2RhbF0nOiAndHJ1ZSdcclxuICAgIH1cclxufSlcclxuZXhwb3J0IGNsYXNzIE1vZGFsQ29udGFpbmVyQ29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0LCBPbkRlc3Ryb3ksIEFmdGVyVmlld0luaXQge1xyXG4gICAgY29uZmlnOiBNb2RhbE9wdGlvbnM7XHJcbiAgICBpc1Nob3duID0gZmFsc2U7XHJcbiAgICBsZXZlbDogbnVtYmVyO1xyXG4gICAgaXNBbmltYXRlZDogYm9vbGVhbjtcclxuICAgIGJzTW9kYWxTZXJ2aWNlOiBCc01vZGFsU2VydmljZTtcclxuICAgIGRpYWxvZ1R5cGU6IHN0cmluZztcclxuICAgIGlmcmFtZVNyYzogU2FmZVJlc291cmNlVXJsO1xyXG4gICAgLy8g5piv5ZCm6Z2e5qih5oCB56qX5Y+jXHJcbiAgICBpc01vZGVsZXNzPWZhbHNlO1xyXG4gICAgQElucHV0KClcclxuICAgIHB1YmxpYyBzZXQgaWZyYW1lKHZhbHVlOiBzdHJpbmcpIHtcclxuICAgICAgICBpZiAodGhpcy5zYW5pdGl6ZXIpIHtcclxuICAgICAgICAgICAgdGhpcy5pZnJhbWVTcmMgPSB0aGlzLnNhbml0aXplci5ieXBhc3NTZWN1cml0eVRydXN0UmVzb3VyY2VVcmwodmFsdWUpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHByaXZhdGUgaXNNb2RhbEhpZGluZyA9IGZhbHNlO1xyXG4gICAgcHJpdmF0ZSBvcmlnaW5hbFdpZHRoOiBudW1iZXI7ICAvLyDorrDlvZXljp/lp4vnmoTlrr3luqZcclxuICAgIHByaXZhdGUgb3JpZ2luYWxIZWlnaHQ6IG51bWJlcjsgLy8g6K6w5b2V5Y6f5aeL55qE6auY5bqmXHJcblxyXG4gICAgcHJpdmF0ZSBwcmV2V2lkdGg6IG51bWJlcjsgLy8g6K6w5b2V5LiK5qyh55qE5a695bqmXHJcbiAgICBwcml2YXRlIHByZXZIZWlnaHQ6IG51bWJlcjsgLy8g6K6w5b2V5LiK5qyh55qE6auY5bqmXHJcbiAgICBpc01heCA9IGZhbHNlO1xyXG5cclxuICAgIEBWaWV3Q2hpbGQoQW5ndWxhckRyYWdnYWJsZURpcmVjdGl2ZSkgZHJhZ2diYXI6IEFuZ3VsYXJEcmFnZ2FibGVEaXJlY3RpdmU7XHJcbiAgICBAVmlld0NoaWxkKCdoZWFkZXInKSBtb2RhbEhlYWRlcjogRWxlbWVudFJlZjtcclxuICAgIGJvdW5kc0VsZW1lbnQ6IEhUTUxFbGVtZW50O1xyXG5cclxuICAgIEBPdXRwdXQoKSBjbG9zZWQgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XHJcbiAgICBAT3V0cHV0KCkgb3BlbmVkID0gbmV3IEV2ZW50RW1pdHRlcigpO1xyXG4gICAgQE91dHB1dCgpIHJlc2l6ZWQgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XHJcblxyXG4gICAgQEhvc3RCaW5kaW5nKCdpZCcpIG1vZGFsSUQgPSBgTU9EQUxJRF8ke0RhdGUubm93KCkudG9QcmVjaXNpb24oKX1gO1xyXG5cclxuICAgIEBWaWV3Q2hpbGRyZW4oTW9kYWxCdXR0b25EaXJlY3RpdmUpIGJ1dHRvbnM6IFF1ZXJ5TGlzdDxNb2RhbEJ1dHRvbkRpcmVjdGl2ZT47XHJcblxyXG4gICAgZGxnSGVhZGVyTGluZUhlaWdodDogYW55O1xyXG4gICAgcHJpdmF0ZSBfd2luZG93UmVzaXplVG9NYXggPSBmYWxzZTtcclxuICAgIHByaXZhdGUgd2luZG93UmVzaXplJDogU3Vic2NyaXB0aW9uID0gbnVsbDtcclxuICAgIGNvbnN0cnVjdG9yKFxyXG4gICAgICAgIG9wdGlvbnM6IE1vZGFsT3B0aW9ucyxcclxuICAgICAgICBwcm90ZWN0ZWQgZWw6IEVsZW1lbnRSZWYsXHJcbiAgICAgICAgcHJpdmF0ZSBfcmVuZGVyZXI6IFJlbmRlcmVyMixcclxuICAgICAgICBwcml2YXRlIHNhbml0aXplcjogRG9tU2FuaXRpemVyXHJcbiAgICApIHtcclxuICAgICAgICB0aGlzLmNvbmZpZyA9IE9iamVjdC5hc3NpZ24oe30sIG9wdGlvbnMpO1xyXG4gICAgICAgIGlmICghdGhpcy5jb25maWcuYnV0dG9ucykge1xyXG4gICAgICAgICAgICB0aGlzLmNvbmZpZy5idXR0b25zID0gW1xyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIHRleHQ6ICflj5bmtognLFxyXG4gICAgICAgICAgICAgICAgICAgIGNsczogJ2J0biBidG4tbGlnaHQnLFxyXG4gICAgICAgICAgICAgICAgICAgIGljb25DbHM6ICdrLWljb24gay1pLWNsb3NlJyxcclxuICAgICAgICAgICAgICAgICAgICBoYW5kbGU6ICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGV4dDogJ+ehruWumicsXHJcbiAgICAgICAgICAgICAgICAgICAgY2xzOiAnYnRuIGJ0bi1wcmltYXJ5JyxcclxuICAgICAgICAgICAgICAgICAgICBpY29uQ2xzOiAnay1pY29uIGstaS1jaGVjaycsXHJcbiAgICAgICAgICAgICAgICAgICAgaGFuZGxlOiAoKSA9PiB7IGFsZXJ0KCflpb0o772h772l4oiA772lKe++ie++nuWXqOWTnyEhJyk7IH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5zZXRJc01vZGVsZXNzKCk7XHJcbiAgICB9XHJcblxyXG4gICAgbmdPbkluaXQoKTogdm9pZCB7XHJcbiAgICAgICAgaWYodGhpcy5pc01vZGVsZXNzKXtcclxuICAgICAgICAgICAgLy8g5aaC5p6c5piv6Z2e5qih5oCB56qX5Y+jXHJcbiAgICAgICAgICAgIHRoaXMuYm91bmRzRWxlbWVudD1udWxsO1xyXG4gICAgICAgICAgICB0aGlzLl9yZW5kZXJlci5hZGRDbGFzcyh0aGlzLmVsLm5hdGl2ZUVsZW1lbnQsICdmLW1vZGFsLWlzLW1vZGVsZXNzJyk7XHJcbiAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgIHRoaXMuYm91bmRzRWxlbWVudCA9IHRoaXMuZWwubmF0aXZlRWxlbWVudDtcclxuICAgICAgICB9ICAgICAgIFxyXG4gICAgICAgIGlmICh0aGlzLmNvbmZpZy5maXRDb250ZW50KSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3JlbmRlcmVyLmFkZENsYXNzKHRoaXMuZWwubmF0aXZlRWxlbWVudCwgJ2YtbW9kYWwtZml0Q29udGVudCcpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHRoaXMuaXNBbmltYXRlZCkge1xyXG4gICAgICAgICAgICB0aGlzLl9yZW5kZXJlci5hZGRDbGFzcyh0aGlzLmVsLm5hdGl2ZUVsZW1lbnQsIENMQVNTX05BTUUuRkFERSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIHRoaXMubmdab25lLnJ1bk91dHNpZGVBbmd1bGFyKCgpID0+IHtcclxuICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5pc1Nob3duID0gdHJ1ZTsgICAgICAgICAgIFxyXG4gICAgICAgICAgICB0aGlzLl9yZW5kZXJlci5hZGRDbGFzcyhcclxuICAgICAgICAgICAgICAgIHRoaXMuZWwubmF0aXZlRWxlbWVudCxcclxuICAgICAgICAgICAgICAgIGlzQnMzKCkgPyBDTEFTU19OQU1FLklOIDogQ0xBU1NfTkFNRS5TSE9XXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIGlmKHRoaXMuaXNNb2RlbGVzcyl7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9yZW5kZXJlci5zZXRTdHlsZSh0aGlzLmVsLm5hdGl2ZUVsZW1lbnQsICdwb3NpdGlvbicsICdzdGF0aWMnKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLl9yZW5kZXJlci5zZXRTdHlsZSh0aGlzLmVsLm5hdGl2ZUVsZW1lbnQsICdkaXNwbGF5JywgJ2Jsb2NrJyk7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmNvbmZpZy5maXRDb250ZW50ICYmIHRoaXMuZWwubmF0aXZlRWxlbWVudC5jbGFzc05hbWUuaW5kZXhPZignZi1tb2RhbC1maXRDb250ZW50LXNjcm9sbCcpID4gLTEpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZWwubmF0aXZlRWxlbWVudC5zY3JvbGxUb3AgPSAwO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAoZG9jdW1lbnQgJiYgZG9jdW1lbnQuYm9keSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbW9kYWxMZW4gPSB0aGlzLmJzTW9kYWxTZXJ2aWNlLmdldE1vZGFsc0NvdW50KCk7XHJcbiAgICAgICAgICAgICAgICBpZiAobW9kYWxMZW4gPT09IDEpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmJzTW9kYWxTZXJ2aWNlLmNoZWNrU2Nyb2xsYmFyKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5ic01vZGFsU2VydmljZS5zZXRTY3JvbGxiYXIoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmICghZG9jdW1lbnQuYm9keS5jbGFzc0xpc3QuY29udGFpbnMoQ0xBU1NfTkFNRS5PUEVOKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3JlbmRlcmVyLmFkZENsYXNzKGRvY3VtZW50LmJvZHksIENMQVNTX05BTUUuT1BFTik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5vcGVuZWQuZW1pdCh7IG1vZGFsOiB0aGlzIH0pO1xyXG4gICAgICAgIH0sIHRoaXMuaXNBbmltYXRlZCA/IFRSQU5TSVRJT05fRFVSQVRJT05TLkJBQ0tEUk9QIDogMCk7XHJcbiAgICAgICAgLy8gfSk7XHJcblxyXG4gICAgICAgIGlmICh0aGlzLmVsLm5hdGl2ZUVsZW1lbnQpIHtcclxuICAgICAgICAgICAgdGhpcy5lbC5uYXRpdmVFbGVtZW50LmZvY3VzKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLmRsZ0hlYWRlckxpbmVIZWlnaHQgPSB0aGlzLmdldERpYWxvZ0hlYWRlckxpbmVIZWlnaHQoKSArICdweCc7XHJcbiAgICB9XHJcblxyXG4gICAgbmdBZnRlclZpZXdJbml0KCk6IHZvaWQge1xyXG4gICAgICAgIC8vIENhbGxlZCBhZnRlciBuZ0FmdGVyQ29udGVudEluaXQgd2hlbiB0aGUgY29tcG9uZW50J3MgdmlldyBoYXMgYmVlbiBpbml0aWFsaXplZC4gQXBwbGllcyB0byBjb21wb25lbnRzIG9ubHkuXHJcbiAgICAgICAgLy8gQWRkICdpbXBsZW1lbnRzIEFmdGVyVmlld0luaXQnIHRvIHRoZSBjbGFzcy5cclxuICAgICAgICB0aGlzLl9yZW5kZXJlci5zZXRTdHlsZSh0aGlzLmVsLm5hdGl2ZUVsZW1lbnQsICdkaXNwbGF5JywgJ2Jsb2NrJyk7XHJcbiAgICAgICAgLy8g5aaC5p6c5YaF5a656YCC5bqU5a695bqmXHJcbiAgICAgICAgaWYgKHRoaXMuY29uZmlnLmZpdENvbnRlbnQpIHtcclxuICAgICAgICAgICAgbGV0IGluaXRFbFJlY3QgPSB0aGlzLmVsLm5hdGl2ZUVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XHJcbiAgICAgICAgICAgIGxldCBpbml0Qm9keVNpemUgPSB0aGlzLmdldENvbnRhaW5lclNpemUoKTtcclxuICAgICAgICAgICAgaWYgKGluaXRFbFJlY3QuaGVpZ2h0IDwgaW5pdEJvZHlTaXplLmhlaWdodCArIDMwKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9yZW5kZXJlci5hZGRDbGFzcyh0aGlzLmVsLm5hdGl2ZUVsZW1lbnQsICdmLW1vZGFsLWZpdENvbnRlbnQtc2Nyb2xsJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMub3JpZ2luYWxIZWlnaHQgPSB0aGlzLmNvbmZpZy5oZWlnaHQ7XHJcbiAgICAgICAgdGhpcy5vcmlnaW5hbFdpZHRoID0gdGhpcy5jb25maWcud2lkdGg7XHJcblxyXG4gICAgICAgIHRoaXMud2luZG93UmVzaXplJCA9IGZyb21FdmVudCh3aW5kb3csICdyZXNpemUnKS5waXBlKFxyXG4gICAgICAgICAgICBkZWJvdW5jZVRpbWUoNTApXHJcbiAgICAgICAgKS5zdWJzY3JpYmUoKGU6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCB3aW5XaWR0aCA9ICB3aW5kb3cuaW5uZXJXaWR0aCAtMjA7XHJcbiAgICAgICAgICAgIGNvbnN0IHdpbkhlaWdodCA9IHdpbmRvdy5pbm5lckhlaWdodCAtIDIwO1xyXG5cclxuICAgICAgICAgICAgaWYgKHRoaXMuY29uZmlnLndpZHRoIDw9IHdpbldpZHRoICYmIHRoaXMuY29uZmlnLmhlaWdodCA8PSB3aW5IZWlnaHQpIHtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLl93aW5kb3dSZXNpemVUb01heCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmV2ZXJ0RGlhbG9nKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fd2luZG93UmVzaXplVG9NYXggPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuaXNNYXgpIHsgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubWF4RGlhbG9nKGZhbHNlKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMuaXNNYXgpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl93aW5kb3dSZXNpemVUb01heCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5tYXhEaWFsb2coKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5tYXhEaWFsb2coZmFsc2UpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB0aGlzLnRvQ2VudGVyKCk7XHJcbiAgICAgICAgICAgIHRoaXMubW92ZVRvKDAsIDApO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGdldERsZ0VsZW1lbnQoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZWwubmF0aXZlRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcubW9kYWwtZGlhbG9nJyk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBnZXREaWFsb2dIZWFkZXJMaW5lSGVpZ2h0KCkge1xyXG4gICAgICAgIGlmICh0aGlzLmNvbmZpZy5zaG93SGVhZGVyKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IG1vZGFsSGVhZGVyU3R5bGVzID0gd2luZG93LmdldENvbXB1dGVkU3R5bGUodGhpcy5tb2RhbEhlYWRlci5uYXRpdmVFbGVtZW50KTtcclxuICAgICAgICAgICAgY29uc3QgcGFkZGluZ1RvcCA9IHBhcnNlSW50KG1vZGFsSGVhZGVyU3R5bGVzLnBhZGRpbmdUb3AucmVwbGFjZSgncHgnLCAnJyksIDEwKTtcclxuICAgICAgICAgICAgY29uc3QgcGFkZGluZ0JvdHRvbSA9IHBhcnNlSW50KG1vZGFsSGVhZGVyU3R5bGVzLnBhZGRpbmdCb3R0b20ucmVwbGFjZSgncHgnLCAnJyksIDEwKTtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuY29uZmlnLmRpYWxvZ0hlYWRlckhlaWdodCAtIHBhZGRpbmdUb3AgLSBwYWRkaW5nQm90dG9tO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiAwO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyDojrflj5blhoXlrrnljLrln5/nmoTlsLrlr7hcclxuICAgIGdldENvbnRhaW5lclNpemUoKSB7XHJcbiAgICAgICAgY29uc3QgYm9keVRhcmdldCA9IHRoaXMuZWwubmF0aXZlRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcubW9kYWwtYm9keScpO1xyXG4gICAgICAgIGNvbnN0IGhlaWdodCA9IGJvZHlUYXJnZXQub2Zmc2V0SGVpZ2h0O1xyXG4gICAgICAgIGNvbnN0IHdpZHRoID0gYm9keVRhcmdldC5vZmZzZXRXaWR0aDtcclxuICAgICAgICByZXR1cm4geyB3aWR0aCwgaGVpZ2h0IH07XHJcbiAgICB9XHJcblxyXG4gICAgYnVpbGRGb290ZXJTdHlsZXMoKSB7XHJcbiAgICAgICAgbGV0IHN0eWxlcyA9IHt9O1xyXG5cclxuICAgICAgICBpZiAodGhpcy5jb25maWcuZGlhbG9nRm9vdGVyU3R5bGVzKSB7XHJcbiAgICAgICAgICAgIHN0eWxlcyA9IE9iamVjdC5hc3NpZ24oe30sIHN0eWxlcywgdGhpcy5jb25maWcuZGlhbG9nRm9vdGVyU3R5bGVzKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBzdHlsZXM7XHJcbiAgICB9XHJcblxyXG4gICAgdXNlQnV0dG9uc1RlbXBsYXRlKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmNvbmZpZy5idXR0b25zIGluc3RhbmNlb2YgVGVtcGxhdGVSZWY7XHJcbiAgICB9XHJcblxyXG4gICAgQEhvc3RMaXN0ZW5lcignY2xpY2snLCBbJyRldmVudCddKVxyXG4gICAgb25DbGljayhldmVudDogTW91c2VFdmVudCkge1xyXG4gICAgICAgIGNvbnN0IHRhZyA9IGV2ZW50LnRhcmdldCBhcyBhbnk7XHJcblxyXG4gICAgICAgIC8vIGlmICh0YWcubG9jYWxOYW1lID09PSAnbGFiZWwnKSB7XHJcbiAgICAgICAgLy8gICAgIGlmICh0YWcuY2xhc3NOYW1lKSB7XHJcbiAgICAgICAgLy8gICAgICAgICBjb25zdCBjbHNMaXN0ID0gdGFnLmNsYXNzTmFtZS5zcGxpdCgnICcpO1xyXG4gICAgICAgIC8vICAgICAgICAgaWYgKFxyXG4gICAgICAgIC8vICAgICAgICAgICAgIGNsc0xpc3QuaW5kZXhPZignay1yYWRpby1sYWJlbCcpID4gLTEgfHxcclxuICAgICAgICAvLyAgICAgICAgICAgICBjbHNMaXN0LmluZGV4T2YoJ2stY2hlY2tib3gtbGFiZWwnKSA+IC0xIHx8XHJcbiAgICAgICAgLy8gICAgICAgICAgICAgY2xzTGlzdC5pbmRleE9mKCdjdXN0b20tY29udHJvbC1sYWJlbCcpID4gLTFcclxuICAgICAgICAvLyAgICAgICAgICkge1xyXG4gICAgICAgIC8vICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAvLyAgICAgICAgIH1cclxuICAgICAgICAvLyAgICAgfVxyXG4gICAgICAgIC8vIH1cclxuXHJcbiAgICAgICAgLy8gaWYgKHRhZy5sb2NhbE5hbWUgPT09ICdpbnB1dCcgJiYgKHRhZy50eXBlID09PSAnY2hlY2tib3gnIHx8IHRhZy50eXBlID09PSAncmFkaW8nIHx8IHRhZy50eXBlID09PSAnZmlsZScpKSB7XHJcbiAgICAgICAgLy8gICAgIHJldHVybjtcclxuICAgICAgICAvLyB9XHJcblxyXG4gICAgICAgIGlmICh0aGlzLmNvbmZpZy5pZ25vcmVCYWNrZHJvcENsaWNrIHx8IHRoaXMuY29uZmlnLmJhY2tkcm9wID09PSAnc3RhdGljJyB8fCBldmVudC50YXJnZXQgIT09IHRoaXMuZWwubmF0aXZlRWxlbWVudCApIHtcclxuICAgICAgICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuYnNNb2RhbFNlcnZpY2Uuc2V0RGlzbWlzc1JlYXNvbihESVNNSVNTX1JFQVNPTlMuQkFDS1JET1ApO1xyXG4gICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgIH1cclxuXHJcbiAgICBASG9zdExpc3RlbmVyKCd3aW5kb3c6a2V5ZG93bi5lc2MnLCBbJyRldmVudCddKVxyXG4gICAgb25Fc2MoZXZlbnQ6IGFueSk6IHZvaWQge1xyXG4gICAgICAgIGlmICghdGhpcy5pc1Nob3duKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChldmVudC5rZXlDb2RlID09PSAyNykge1xyXG4gICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvKirku47mnIDlkI7kuIDkuKrnqpflj6PlvIDlp4vlhbPpl60gKi9cclxuICAgICAgICBpZiAoXHJcbiAgICAgICAgICAgIHRoaXMuY29uZmlnLmtleWJvYXJkICYmXHJcbiAgICAgICAgICAgIHRoaXMubGV2ZWwgPT09IHRoaXMuYnNNb2RhbFNlcnZpY2UuZ2V0TW9kYWxzQ291bnQoKVxyXG4gICAgICAgICkge1xyXG4gICAgICAgICAgICB0aGlzLmJzTW9kYWxTZXJ2aWNlLnNldERpc21pc3NSZWFzb24oRElTTUlTU19SRUFTT05TLkVTQyk7XHJcbiAgICAgICAgICAgIHRoaXMuY2xvc2UoZXZlbnQpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBuZ09uRGVzdHJveSgpOiB2b2lkIHtcclxuICAgICAgICBpZiAodGhpcy5pc1Nob3duKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICh0aGlzLndpbmRvd1Jlc2l6ZSQpIHtcclxuICAgICAgICAgICAgdGhpcy53aW5kb3dSZXNpemUkLnVuc3Vic2NyaWJlKCk7XHJcbiAgICAgICAgICAgIHRoaXMud2luZG93UmVzaXplJCA9IG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGNsb3NlKGU/OiBNb3VzZUV2ZW50LCBpc0Nsb3NlQnV0dG9uID0gZmFsc2UpOiB2b2lkIHtcclxuICAgICAgICBpZiAoZSAmJiBlLnN0b3BQcm9wYWdhdGlvbikge1xyXG4gICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHRoaXMuaXNNb2RhbEhpZGluZyB8fCAhdGhpcy5pc1Nob3duKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuY29uZmlnLmJlZm9yZUNsb3NlKHRoaXMsIHsgZXZlbnQ6IGUgfSkuc3Vic2NyaWJlKHIgPT4ge1xyXG4gICAgICAgICAgICBpZiAoIXIpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvLyDmm7TmlrDmnI3liqHkuK3pnZ7mqKHmgIHnqpflj6PnmoTkuKrmlbBcclxuICAgICAgICAgICAgdGhpcy5ic01vZGFsU2VydmljZS5jbG9zZVVwZGF0ZU1vZGVsZXNzQ291bnRCeU1vZGFsKHRoaXMuaXNNb2RlbGVzcyk7XHJcbiAgICAgICAgICAgIHRoaXMuaXNNb2RhbEhpZGluZyA9IHRydWU7XHJcbiAgICAgICAgICAgIHRoaXMuX3JlbmRlcmVyLnJlbW92ZUNsYXNzKFxyXG4gICAgICAgICAgICAgICAgdGhpcy5lbC5uYXRpdmVFbGVtZW50LFxyXG4gICAgICAgICAgICAgICAgaXNCczMoKSA/IENMQVNTX05BTUUuSU4gOiBDTEFTU19OQU1FLlNIT1dcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmlzU2hvd24gPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIHRoaXMuYnNNb2RhbFNlcnZpY2UuaGlkZSh0aGlzLmxldmVsKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuaXNNb2RhbEhpZGluZyA9IGZhbHNlO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmIChkb2N1bWVudCAmJiBkb2N1bWVudC5ib2R5ICYmICAhZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmZhcnJpcy1tb2RhbC5zaG93JykubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fcmVuZGVyZXIucmVtb3ZlQ2xhc3MoZG9jdW1lbnQuYm9keSwgQ0xBU1NfTkFNRS5PUEVOKTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5jb25maWcuY2xvc2VkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jb25maWcuY2xvc2VkKGlzQ2xvc2VCdXR0b24sIHsgbW9kYWxSZWY6IHRoaXMsIGV2ZW50OiBlIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdGhpcy5jbG9zZWQuZW1pdCh0aGlzLmxldmVsKTtcclxuICAgICAgICAgICAgfSwgdGhpcy5pc0FuaW1hdGVkID8gVFJBTlNJVElPTl9EVVJBVElPTlMuTU9EQUwgOiAwKTtcclxuICAgICAgICAgICAgLy8gfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgdG9DZW50ZXIoKSB7XHJcbiAgICAgICAgY29uc3QgbWFyZ2luTGVmdCA9IE51bWJlci5wYXJzZUludCgnJyArIC10aGlzLmNvbmZpZy53aWR0aCAvIDIpO1xyXG4gICAgICAgIGNvbnN0IG1hcmdpblRvcCA9IE51bWJlci5wYXJzZUludCgnJyArIC10aGlzLmNvbmZpZy5oZWlnaHQgLyAyKTtcclxuXHJcbiAgICAgICAgY29uc3QgZGlhbG9nRWwgPSB0aGlzLmVsLm5hdGl2ZUVsZW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsLWRpYWxvZycpO1xyXG4gICAgICAgIGNvbnN0IGNvbnRlbnRFbCA9IHRoaXMuZWwubmF0aXZlRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcubW9kYWwtYm9keScpO1xyXG5cclxuICAgICAgICAvLyB0aGlzLl9yZW5kZXJlci5zZXRTdHlsZShkaWFsb2dFbCwgJ21hcmdpbi1sZWZ0JywgbWFyZ2luTGVmdCk7XHJcbiAgICAgICAgLy8gdGhpcy5fcmVuZGVyZXIuc2V0U3R5bGUoZGlhbG9nRWwsICdtYXJnaW4tdG9wJywgbWFyZ2luVG9wKTtcclxuXHJcbiAgICAgICAgdGhpcy5fcmVuZGVyZXIuc2V0U3R5bGUoZGlhbG9nRWwsICdsZWZ0JywgYCR7d2luZG93LmlubmVyV2lkdGggLyAyICsgbWFyZ2luTGVmdH1weGApO1xyXG4gICAgICAgIHRoaXMuX3JlbmRlcmVyLnNldFN0eWxlKGRpYWxvZ0VsLCAndG9wJywgIGAke3dpbmRvdy5pbm5lckhlaWdodCAvIDIgKyBtYXJnaW5Ub3B9cHhgKTtcclxuXHJcbiAgICAgICAgbGV0IGNvbnRlbnRIZWlnaHQgPSB0aGlzLmNvbmZpZy5oZWlnaHQgLSAzODtcclxuICAgICAgICBpZiAodGhpcy5jb25maWcuc2hvd0J1dHRvbnMpIHtcclxuICAgICAgICAgICAgY29udGVudEhlaWdodCA9IGNvbnRlbnRIZWlnaHQgLSA1MDtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKCF0aGlzLmNvbmZpZy5maXRDb250ZW50KSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3JlbmRlcmVyLnNldFN0eWxlKFxyXG4gICAgICAgICAgICAgICAgY29udGVudEVsLFxyXG4gICAgICAgICAgICAgICAgJ2hlaWdodCcsXHJcbiAgICAgICAgICAgICAgICBjb250ZW50SGVpZ2h0ICsgJ3B4J1xyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLl9yZW5kZXJlci5zZXRTdHlsZShjb250ZW50RWwsICdvdmVyZmxvdycsICdoaWRkZW4nKTtcclxuICAgICAgICB0aGlzLl9yZW5kZXJlci5zZXRTdHlsZShkaWFsb2dFbCwgJ3RyYW5zZm9ybScsIGB0cmFuc2xhdGUzZCgwcHgsIDBweCwgMHB4KWApO1xyXG5cclxuICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgY29udGFpbmVyID0gdGhpcy5nZXRDb250YWluZXJTaXplKCk7XHJcbiAgICAgICAgICAgIGNvbnN0IHsgd2lkdGg6IGNvbnRhaW5lcldpZHRoLCBoZWlnaHQ6IGNvbnRhaW5lckhlaWdodCB9ID0gY29udGFpbmVyO1xyXG4gICAgICAgICAgICB0aGlzLnJlc2l6ZWQuZW1pdCh7IHdpZHRoOiB0aGlzLmNvbmZpZy53aWR0aCwgaGVpZ2h0OiB0aGlzLmNvbmZpZy5oZWlnaHQsICBjb250YWluZXJXaWR0aCwgIGNvbnRhaW5lckhlaWdodCB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBtb3ZlVG8oeDogbnVtYmVyLCB5OiBudW1iZXIpIHtcclxuICAgICAgICBjb25zdCBkaWFsb2dFbCA9IHRoaXMuZWwubmF0aXZlRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcubW9kYWwtZGlhbG9nJyk7XHJcbiAgICAgICAgdGhpcy5fcmVuZGVyZXIuc2V0U3R5bGUoZGlhbG9nRWwsICd0cmFuc2Zvcm0nLCBgdHJhbnNsYXRlM2QoJHt4fXB4LCAke3l9cHgsIDBweClgKTtcclxuICAgICAgICAvLyB0aGlzLl9yZW5kZXJlci5zZXRTdHlsZShkaWFsb2dFbCwgJ3RvcCcsICc1MCUnKTtcclxuICAgICAgICAvLyB0aGlzLl9yZW5kZXJlci5zZXRTdHlsZShkaWFsb2dFbCwgJ2xlZnQnLCAnNTAlJyk7XHJcblxyXG4gICAgICAgIC8vIGNvbnN0IG1hcmdpbkxlZnQgPSBOdW1iZXIucGFyc2VJbnQoJycgKyAtdGhpcy5jb25maWcud2lkdGggLyAyKTtcclxuICAgICAgICAvLyBjb25zdCBtYXJnaW5Ub3AgPSBOdW1iZXIucGFyc2VJbnQoJycgKyAtdGhpcy5jb25maWcuaGVpZ2h0IC8gMik7XHJcbiAgICAgICAgLy8gdGhpcy5fcmVuZGVyZXIuc2V0U3R5bGUoZGlhbG9nRWwsICdsZWZ0JywgYCR7d2luZG93LmlubmVyV2lkdGggLyAyICsgbWFyZ2luTGVmdH1weGApO1xyXG4gICAgICAgIC8vIHRoaXMuX3JlbmRlcmVyLnNldFN0eWxlKGRpYWxvZ0VsLCAndG9wJywgIGAke3dpbmRvdy5pbm5lckhlaWdodCAvIDIgKyBtYXJnaW5Ub3B9cHhgKTtcclxuXHJcblxyXG4gICAgICAgIHRoaXMuZHJhZ2diYXIucG9zaXRpb24gPSB7IHgsIHkgfTtcclxuICAgICAgICB0aGlzLmRyYWdnYmFyLnJlc2V0UG9zaXRpb24oKTtcclxuICAgIH1cclxuXHJcbiAgICBtYXhEaWFsb2cocmVtZW1iZXJQcmV2U2l6ZSA9IHRydWUpIHtcclxuICAgICAgICBpZiAocmVtZW1iZXJQcmV2U2l6ZSkge1xyXG4gICAgICAgICAgICB0aGlzLnByZXZXaWR0aCA9IHRoaXMuY29uZmlnLndpZHRoO1xyXG4gICAgICAgICAgICB0aGlzLnByZXZIZWlnaHQgPSB0aGlzLmNvbmZpZy5oZWlnaHQ7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIHRoaXMuY29uZmlnLndpZHRoID0gKGRvY3VtZW50LnNjcm9sbGluZ0VsZW1lbnQ/ZG9jdW1lbnQuc2Nyb2xsaW5nRWxlbWVudDpkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQpWydjbGllbnRXaWR0aCddIC0gMjA7XHJcbiAgICAgICAgLy8gdGhpcy5jb25maWcuaGVpZ2h0ID0gKGRvY3VtZW50LnNjcm9sbGluZ0VsZW1lbnQ/ZG9jdW1lbnQuc2Nyb2xsaW5nRWxlbWVudDpkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQpWydjbGllbnRIZWlnaHQnXSAtIDIwO1xyXG5cclxuICAgICAgICB0aGlzLmNvbmZpZy53aWR0aCA9IHdpbmRvdy5pbm5lcldpZHRoIC0gMjA7XHJcbiAgICAgICAgdGhpcy5jb25maWcuaGVpZ2h0ID0gd2luZG93LmlubmVySGVpZ2h0IC0gMjA7XHJcblxyXG4gICAgICAgIHRoaXMuY29uZmlnLmRyYWdnYWJsZSA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuY29uZmlnLnJlc2l6YWJsZSA9IGZhbHNlO1xyXG4gICAgICAgIGNvbnN0IGRpYWxvZ0VsID0gdGhpcy5lbC5uYXRpdmVFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbC1kaWFsb2cnKTtcclxuICAgICAgICB0aGlzLl9yZW5kZXJlci5hZGRDbGFzcyhkaWFsb2dFbCwgJ21vZGVsLWRpYWxvZy1tYXhpbWl6ZScpO1xyXG4gICAgICAgIHRoaXMuX3JlbmRlcmVyLnNldFN0eWxlKGRpYWxvZ0VsLCAndG9wJywgJzUwJScpO1xyXG4gICAgICAgIHRoaXMuX3JlbmRlcmVyLnNldFN0eWxlKGRpYWxvZ0VsLCAnbGVmdCcsICc1MCUnKTtcclxuICAgICAgICB0aGlzLmlzTWF4ID0gdHJ1ZTtcclxuICAgICAgICB0aGlzLnRvQ2VudGVyKCk7XHJcbiAgICAgICAgdGhpcy5tb3ZlVG8oMCwgMCk7XHJcbiAgICB9XHJcblxyXG4gICAgcmVzaXplKHdpZHRoOiBudW1iZXIsIGhlaWdodDogbnVtYmVyKSB7XHJcbiAgICAgICAgaWYgKHdpZHRoKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY29uZmlnLndpZHRoID0gd2lkdGg7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoaGVpZ2h0KSB7XHJcbiAgICAgICAgICAgIHRoaXMuY29uZmlnLmhlaWdodCA9IGhlaWdodDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IGRpYWxvZ0VsID0gdGhpcy5lbC5uYXRpdmVFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbC1kaWFsb2cnKTtcclxuICAgICAgICB0aGlzLl9yZW5kZXJlci5yZW1vdmVDbGFzcyhkaWFsb2dFbCwgJ21vZGVsLWRpYWxvZy1tYXhpbWl6ZScpO1xyXG4gICAgICAgIHRoaXMudG9DZW50ZXIoKTtcclxuICAgICAgICB0aGlzLmRyYWdnYmFyLnJlc2V0UG9zaXRpb24oKTtcclxuICAgIH1cclxuXHJcbiAgICBkcm9wZG93bihlbDogYW55KSB7XHJcbiAgICAgICAgLy8gY29uc3QgcmVjdCA9IGVsLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xyXG4gICAgICAgIC8vIHRoaXMuX3JlbmRlcmVyLnJlbW92ZVN0eWxlKGVsLCAnbWFyZ2luLXRvcCcpO1xyXG4gICAgICAgIC8vIHRoaXMuX3JlbmRlcmVyLnJlbW92ZVN0eWxlKGVsLCAnbWFyZ2luLWxlZnQnKTtcclxuICAgICAgICAvLyB0aGlzLl9yZW5kZXJlci5zZXRTdHlsZShlbCwgJ3RvcCcsIGAke3JlY3QudG9wfXB4YCk7XHJcbiAgICAgICAgLy8gdGhpcy5fcmVuZGVyZXIuc2V0U3R5bGUoZWwsICdsZWZ0JywgYCR7cmVjdC5sZWZ0fXB4YCk7XHJcblxyXG4gICAgICAgIC8vIHRoaXMuX3JlbmRlcmVyLnJlbW92ZVN0eWxlKGVsLCAndHJhbnNmb3JtJyk7XHJcbiAgICAgICAgLy8gdGhpcy5fcmVuZGVyZXIucmVtb3ZlU3R5bGUoZWwsICctd2Via2l0LXRyYW5zZm9ybScpO1xyXG4gICAgICAgIC8vIHRoaXMuX3JlbmRlcmVyLnJlbW92ZVN0eWxlKGVsLCAnLW1zLXRyYW5zZm9ybScpO1xyXG4gICAgICAgIC8vIHRoaXMuX3JlbmRlcmVyLnJlbW92ZVN0eWxlKGVsLCAnLW1vei10cmFuc2Zvcm0nKTtcclxuICAgICAgICAvLyB0aGlzLl9yZW5kZXJlci5yZW1vdmVTdHlsZShlbCwgJy1vLXRyYW5zZm9ybScpO1xyXG4gICAgfVxyXG5cclxuICAgIHJldmVydERpYWxvZygpIHtcclxuICAgICAgICB0aGlzLmlzTWF4ID0gZmFsc2U7XHJcblxyXG4gICAgICAgIGNvbnN0IHd3ID0gd2luZG93LmlubmVyV2lkdGggLSAyMDtcclxuICAgICAgICBjb25zdCB3aCA9IHdpbmRvdy5pbm5lckhlaWdodCAtIDIwXHJcblxyXG4gICAgICAgIHRoaXMuY29uZmlnLndpZHRoID0gdGhpcy5wcmV2V2lkdGggPT0gd3cgPyB0aGlzLm9yaWdpbmFsV2lkdGggOiB0aGlzLnByZXZXaWR0aDtcclxuICAgICAgICB0aGlzLmNvbmZpZy5oZWlnaHQgPSB0aGlzLnByZXZIZWlnaHQgPT0gd2ggPyB0aGlzLm9yaWdpbmFsSGVpZ2h0IDogdGhpcy5wcmV2SGVpZ2h0O1xyXG4gICAgICAgXHJcbiAgICAgICAgaWYgKHRoaXMuY29uZmlnLndpZHRoID4gd3cpIHtcclxuICAgICAgICAgICAgdGhpcy5jb25maWcud2lkdGggPSB3dztcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICh0aGlzLmNvbmZpZy5oZWlnaHQgPiB3aCkge1xyXG4gICAgICAgICAgICB0aGlzLmNvbmZpZy5oZWlnaHQgPSB3aDtcclxuICAgICAgICB9XHJcblxyXG5cclxuICAgICAgICB0aGlzLmNvbmZpZy5kcmFnZ2FibGUgPSB0cnVlO1xyXG4gICAgICAgIHRoaXMuY29uZmlnLnJlc2l6YWJsZSA9IHRydWU7XHJcbiAgICAgICAgY29uc3QgZGlhbG9nRWwgPSB0aGlzLmVsLm5hdGl2ZUVsZW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsLWRpYWxvZycpO1xyXG4gICAgICAgIHRoaXMuX3JlbmRlcmVyLnJlbW92ZUNsYXNzKGRpYWxvZ0VsLCAnbW9kZWwtZGlhbG9nLW1heGltaXplJyk7XHJcbiAgICAgICAgdGhpcy50b0NlbnRlcigpO1xyXG4gICAgICAgIHRoaXMuZHJhZ2diYXIucmVzZXRQb3NpdGlvbigpO1xyXG4gICAgfVxyXG5cclxuICAgIGNoYW5nZURpYWxvZ1NpemUoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuaXNNYXgpIHtcclxuICAgICAgICAgICAgdGhpcy5yZXZlcnREaWFsb2coKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLm1heERpYWxvZygpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLl93aW5kb3dSZXNpemVUb01heCA9IGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIHJlc2l6ZVN0b3Aob3B0czogYW55KSB7XHJcbiAgICAgICAgLy8gY29uc29sZS5sb2coJ3Jlc2l6ZVN0b3AnKTtcclxuICAgICAgICB0aGlzLmNvbmZpZy53aWR0aCA9IG9wdHMuc2l6ZS53aWR0aDtcclxuICAgICAgICB0aGlzLmNvbmZpZy5oZWlnaHQgPSBvcHRzLnNpemUuaGVpZ2h0O1xyXG4gICAgICAgIGNvbnN0IGNvbnRhaW5lciA9IHRoaXMuZ2V0Q29udGFpbmVyU2l6ZSgpO1xyXG4gICAgICAgIGNvbnN0IHsgd2lkdGg6IGNvbnRhaW5lcldpZHRoLCBoZWlnaHQ6IGNvbnRhaW5lckhlaWdodCB9ID0gY29udGFpbmVyO1xyXG4gICAgICAgIHRoaXMucmVzaXplZC5lbWl0KHsgLi4ub3B0cy5zaXplLCAuLi57IGNvbnRhaW5lcldpZHRoLCBjb250YWluZXJIZWlnaHQgfSB9KTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICog5piv5ZCm6Z2e5qih5oCBXHJcbiAgICAgKiBAcmV0dXJucyBcclxuICAgICAqL1xyXG4gICAgc2V0SXNNb2RlbGVzcygpeyAgICAgICAgXHJcbiAgICAgICAgaWYodGhpcy5jb25maWcuaGFzT3duUHJvcGVydHkoJ21vZGVsZXNzJykpe1xyXG4gICAgICAgICAgICB0aGlzLmlzTW9kZWxlc3M9IHRoaXMuY29uZmlnWydtb2RlbGVzcyddO1xyXG4gICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICB0aGlzLmlzTW9kZWxlc3M9ZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgdXBkYXRlRGlhbG9nWmluZGV4KHpJbmRleCl7XHJcbiAgICAgICAgaWYodGhpcy5pc01vZGVsZXNzKXtcclxuICAgICAgICAgICAgbGV0IG1vZGFsRWw9dGhpcy5lbC5uYXRpdmVFbGVtZW50O1xyXG4gICAgICAgICAgICBjb25zdCBkaWFsb2dFbCA9IG1vZGFsRWwucXVlcnlTZWxlY3RvcignLm1vZGFsLWRpYWxvZycpO1xyXG4gICAgICAgICAgICB0aGlzLl9yZW5kZXJlci5zZXRTdHlsZShkaWFsb2dFbCwgJ3Bvc2l0aW9uJywgJ2ZpeGVkJyk7XHJcbiAgICAgICAgICAgIHRoaXMuX3JlbmRlcmVyLnNldFN0eWxlKGRpYWxvZ0VsLCAnekluZGV4JywgekluZGV4P3pJbmRleDptb2RhbEVsLnN0eWxlLnpJbmRleCApO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG4iXX0=