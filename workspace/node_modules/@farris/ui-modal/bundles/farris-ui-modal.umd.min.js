!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/platform-browser"),require("rxjs"),require("rxjs/operators"),require("@farris/ui-modal/utils"),require("@farris/ui-common"),require("@angular/core"),require("@angular/common"),require("@farris/ui-perfect-scrollbar"),require("@farris/ui-draggable"),require("@farris/ui-modal/positioning"),require("@farris/ui-modal/component-loader"),require("@farris/ui-area-response"),require("@farris/ui-tooltip")):"function"==typeof define&&define.amd?define("@farris/ui-modal",["exports","@angular/platform-browser","rxjs","rxjs/operators","@farris/ui-modal/utils","@farris/ui-common","@angular/core","@angular/common","@farris/ui-perfect-scrollbar","@farris/ui-draggable","@farris/ui-modal/positioning","@farris/ui-modal/component-loader","@farris/ui-area-response","@farris/ui-tooltip"],t):t((e.farris=e.farris||{},e.farris["ui-modal"]={}),e.ng.platformBrowser,e.rxjs,e.rxjs.operators,e.farris["ui-modal"].utils,e.uiCommon,e.ng.core,e.ng.common,e.uiPerfectScrollbar,e.uiDraggable,e.farris["ui-modal"].positioning,e.farris["ui-modal"]["component-loader"],e.uiAreaResponse,e.uiTooltip)}(this,function(e,t,i,o,s,r,a,n,l,d,h,c,u,p){"use strict";var m=(g.decorators=[{type:a.Injectable}],g);function g(){this.close=Function}var f=(y.decorators=[{type:a.Injectable}],y);function y(){}var b={backdrop:"static",keyboard:!0,focus:!0,show:!1,ignoreBackdropClick:!0,"class":"",animated:!0,initialState:{},width:400,height:350,minHeight:null,minWidth:null,maxHeight:null,maxWidth:null,title:"Title is here.",showCloseButton:!0,showMaxButton:!0,showButtons:!0,buttonAlign:"center",draggable:!0,resizable:!0,enableScroll:!0,beforeOpen:function(){return i.of(!0)},beforeClose:function(){return i.of(!0)},okText:"确定",cancelText:"取消",dialogHeaderHeight:38,dialogFooterHeight:50,dialogType:"default",showHeader:!0,fitContent:!1,areaResponse:!1},v={SCROLLBAR_MEASURER:"modal-scrollbar-measure",BACKDROP:"modal-backdrop",OPEN:"modal-open",FADE:"fade",IN:"in",SHOW:"show"},w=300,_=150,S="backdrop-click",E="esc",C=(Object.defineProperty(M.prototype,"isAnimated",{get:function(){return this._isAnimated},set:function(e){this._isAnimated=e},enumerable:!0,configurable:!0}),Object.defineProperty(M.prototype,"isShown",{get:function(){return this._isShown},set:function(e){(this._isShown=e)?this.renderer.addClass(this.element.nativeElement,""+v.IN):this.renderer.removeClass(this.element.nativeElement,""+v.IN),s.isBs3()||(e?this.renderer.addClass(this.element.nativeElement,""+v.SHOW):this.renderer.removeClass(this.element.nativeElement,""+v.SHOW))},enumerable:!0,configurable:!0}),M.prototype.ngOnInit=function(){this.isAnimated&&(this.renderer.addClass(this.element.nativeElement,""+v.FADE),s.Utils.reflow(this.element.nativeElement)),this.isShown=!0},M.decorators=[{type:a.Component,args:[{selector:"bs-modal-backdrop",template:" ",host:{"class":v.BACKDROP}}]}],M.ctorParameters=function(){return[{type:a.ElementRef},{type:a.Renderer2}]},M);function M(e,t){this._isShown=!1,this.element=e,this.renderer=t}var k=function(){return(k=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},x=(R.prototype.setDisabled=function(e){this.el.nativeElement.disabled=e},R.prototype.show=function(){this.visable=!0},R.prototype.hide=function(){this.visable=!1},R.decorators=[{type:a.Directive,args:[{selector:"[modal-button]"}]}],R.ctorParameters=function(){return[{type:a.Injector},{type:a.ElementRef}]},R.propDecorators={visable:[{type:a.Input}]},R);function R(e,t){this.injector=e,this.el=t,this.visable=!0}var H=(Object.defineProperty(D.prototype,"iframe",{set:function(e){this.sanitizer&&(this.iframeSrc=this.sanitizer.bypassSecurityTrustResourceUrl(e))},enumerable:!0,configurable:!0}),D.prototype.ngOnInit=function(){var e=this;this.isModeless?(this.boundsElement=null,this._renderer.addClass(this.el.nativeElement,"f-modal-is-modeless")):this.boundsElement=this.el.nativeElement,this.config.fitContent&&this._renderer.addClass(this.el.nativeElement,"f-modal-fitContent"),this.isAnimated&&this._renderer.addClass(this.el.nativeElement,v.FADE),setTimeout(function(){e.isShown=!0,e._renderer.addClass(e.el.nativeElement,s.isBs3()?v.IN:v.SHOW),e.isModeless&&e._renderer.setStyle(e.el.nativeElement,"position","static"),e._renderer.setStyle(e.el.nativeElement,"display","block"),e.config.fitContent&&-1<e.el.nativeElement.className.indexOf("f-modal-fitContent-scroll")&&(e.el.nativeElement.scrollTop=0),document&&document.body&&(1===e.bsModalService.getModalsCount()&&(e.bsModalService.checkScrollbar(),e.bsModalService.setScrollbar()),document.body.classList.contains(v.OPEN)||e._renderer.addClass(document.body,v.OPEN)),e.opened.emit({modal:e})},this.isAnimated?_:0),this.el.nativeElement&&this.el.nativeElement.focus(),this.dlgHeaderLineHeight=this.getDialogHeaderLineHeight()+"px"},D.prototype.ngAfterViewInit=function(){var n=this;if(this._renderer.setStyle(this.el.nativeElement,"display","block"),this.config.fitContent){var e=this.el.nativeElement.getBoundingClientRect(),t=this.getContainerSize();e.height<t.height+30&&this._renderer.addClass(this.el.nativeElement,"f-modal-fitContent-scroll")}this.originalHeight=this.config.height,this.originalWidth=this.config.width,this.windowResize$=i.fromEvent(window,"resize").pipe(o.debounceTime(50)).subscribe(function(e){var t=window.innerWidth-20,i=window.innerHeight-20;n.config.width<=t&&n.config.height<=i?n._windowResizeToMax?(n.revertDialog(),n._windowResizeToMax=!1):n.isMax&&n.maxDialog(!1):n.isMax?n.maxDialog(!1):(n._windowResizeToMax=!0,n.maxDialog()),n.toCenter(),n.moveTo(0,0)})},D.prototype.getDlgElement=function(){return this.el.nativeElement.querySelector(".modal-dialog")},D.prototype.getDialogHeaderLineHeight=function(){if(this.config.showHeader){var e=window.getComputedStyle(this.modalHeader.nativeElement),t=parseInt(e.paddingTop.replace("px",""),10),i=parseInt(e.paddingBottom.replace("px",""),10);return this.config.dialogHeaderHeight-t-i}return 0},D.prototype.getContainerSize=function(){var e=this.el.nativeElement.querySelector(".modal-body"),t=e.offsetHeight;return{width:e.offsetWidth,height:t}},D.prototype.buildFooterStyles=function(){var e={};return this.config.dialogFooterStyles&&(e=Object.assign({},e,this.config.dialogFooterStyles)),e},D.prototype.useButtonsTemplate=function(){return this.config.buttons instanceof a.TemplateRef},D.prototype.onClick=function(e){e.target,this.config.ignoreBackdropClick||"static"===this.config.backdrop||e.target!==this.el.nativeElement?e.stopPropagation():(this.bsModalService.setDismissReason(S),this.close())},D.prototype.onEsc=function(e){this.isShown&&(27===e.keyCode&&e.preventDefault(),this.config.keyboard&&this.level===this.bsModalService.getModalsCount()&&(this.bsModalService.setDismissReason(E),this.close(e)))},D.prototype.ngOnDestroy=function(){this.isShown&&this.close(),this.windowResize$&&(this.windowResize$.unsubscribe(),this.windowResize$=null)},D.prototype.close=function(t,i){var n=this;void 0===i&&(i=!1),t&&t.stopPropagation&&t.stopPropagation(),!this.isModalHiding&&this.isShown&&this.config.beforeClose(this,{event:t}).subscribe(function(e){if(!e)return!1;n.bsModalService.closeUpdateModelessCountByModal(n.isModeless),n.isModalHiding=!0,n._renderer.removeClass(n.el.nativeElement,s.isBs3()?v.IN:v.SHOW),setTimeout(function(){n.isShown=!1,n.bsModalService.hide(n.level),n.isModalHiding=!1,document&&document.body&&!document.querySelectorAll(".farris-modal.show").length&&n._renderer.removeClass(document.body,v.OPEN),n.config.closed&&n.config.closed(i,{modalRef:n,event:t}),n.closed.emit(n.level)},n.isAnimated?w:0)})},D.prototype.toCenter=function(){var n=this,e=Number.parseInt(""+-this.config.width/2),t=Number.parseInt(""+-this.config.height/2),i=this.el.nativeElement.querySelector(".modal-dialog"),o=this.el.nativeElement.querySelector(".modal-body");this._renderer.setStyle(i,"left",window.innerWidth/2+e+"px"),this._renderer.setStyle(i,"top",window.innerHeight/2+t+"px");var s=this.config.height-38;this.config.showButtons&&(s-=50),this.config.fitContent||this._renderer.setStyle(o,"height",s+"px"),this._renderer.setStyle(o,"overflow","hidden"),this._renderer.setStyle(i,"transform","translate3d(0px, 0px, 0px)"),setTimeout(function(){var e=n.getContainerSize(),t=e.width,i=e.height;n.resized.emit({width:n.config.width,height:n.config.height,containerWidth:t,containerHeight:i})})},D.prototype.moveTo=function(e,t){var i=this.el.nativeElement.querySelector(".modal-dialog");this._renderer.setStyle(i,"transform","translate3d("+e+"px, "+t+"px, 0px)"),this.draggbar.position={x:e,y:t},this.draggbar.resetPosition()},D.prototype.maxDialog=function(e){void 0===e&&(e=!0),e&&(this.prevWidth=this.config.width,this.prevHeight=this.config.height),this.config.width=window.innerWidth-20,this.config.height=window.innerHeight-20,this.config.draggable=!1,this.config.resizable=!1;var t=this.el.nativeElement.querySelector(".modal-dialog");this._renderer.addClass(t,"model-dialog-maximize"),this._renderer.setStyle(t,"top","50%"),this._renderer.setStyle(t,"left","50%"),this.isMax=!0,this.toCenter(),this.moveTo(0,0)},D.prototype.resize=function(e,t){e&&(this.config.width=e),t&&(this.config.height=t);var i=this.el.nativeElement.querySelector(".modal-dialog");this._renderer.removeClass(i,"model-dialog-maximize"),this.toCenter(),this.draggbar.resetPosition()},D.prototype.dropdown=function(e){},D.prototype.revertDialog=function(){this.isMax=!1;var e=window.innerWidth-20,t=window.innerHeight-20;this.config.width=this.prevWidth==e?this.originalWidth:this.prevWidth,this.config.height=this.prevHeight==t?this.originalHeight:this.prevHeight,this.config.width>e&&(this.config.width=e),this.config.height>t&&(this.config.height=t),this.config.draggable=!0,this.config.resizable=!0;var i=this.el.nativeElement.querySelector(".modal-dialog");this._renderer.removeClass(i,"model-dialog-maximize"),this.toCenter(),this.draggbar.resetPosition()},D.prototype.changeDialogSize=function(){this.isMax?this.revertDialog():this.maxDialog(),this._windowResizeToMax=!1},D.prototype.resizeStop=function(e){this.config.width=e.size.width,this.config.height=e.size.height;var t=this.getContainerSize(),i=t.width,n=t.height;this.resized.emit(k({},e.size,{containerWidth:i,containerHeight:n}))},D.prototype.setIsModeless=function(){this.config.hasOwnProperty("modeless")?this.isModeless=this.config.modeless:this.isModeless=!1},D.prototype.updateDialogZindex=function(e){if(this.isModeless){var t=this.el.nativeElement,i=t.querySelector(".modal-dialog");this._renderer.setStyle(i,"position","fixed"),this._renderer.setStyle(i,"zIndex",e||t.style.zIndex)}},D.decorators=[{type:a.Component,args:[{selector:"modal-container",template:'\n    <div [attr.id]="modalID"\n\n        [ngDraggable]="config.draggable"\n        [ngResizable]="config.resizable"\n        [rzMinWidth]="config.minWidth"\n        [rzMaxWidth]="config.maxWidth"\n        [rzMinHeight]="config.minHeight"\n        [rzMaxHeight]="config.maxHeight"\n        rzHandles="all" [handle]="config.showHeader ? header:dragEl"\n        (stopped)="dropdown($event)"\n        (rzStop)="resizeStop($event)"\n        [inBounds]="true" [bounds]="boundsElement" [rzContainment]="boundsElement" [isFixed]="isModeless"\n        [class]="\'modal-dialog\' + (config.class ? \' \' + config.class : \'\')" role="document"\n        [style.width]="config.width + \'px\'" [style.height]="config.fitContent?\'auto\':(config.height + \'px\')"\n        style="position: absolute;top: 50%;left: 50%;">\n        <div class="modal-content" [ngClass]="{\'modal-content--has-header\':config.showHeader}">\n            <div #header class="modal-header" [style.display]="config.showHeader ? \'\': \'none\'">\n                <div class="modal-title">\n                    <span *ngIf="config.iconCls" [class]="config.iconCls" style="margin-right: 8px"></span>\n                    <span class="modal-title-label">{{ config.title }}</span>\n                </div>\n                <div class="actions">\n                    <ul>\n                        <li *ngIf="config.showMinButton" class="f-btn-icon f-bare">\n                            <span class="f-icon modal_minimize"></span></li>\n                        <li *ngIf="config.showMaxButton" (click)="changeDialogSize()" class="f-btn-icon f-bare">\n                            <span class="f-icon modal_maximize" [class.modalrevert]="isMax"></span>\n                        </li>\n                        <li *ngIf="config.showCloseButton" (click)="close($event, true)" class="f-btn-icon f-bare">\n                             <span class="f-icon modal_close"></span>\n                        </li>\n                    </ul>\n                </div>\n            </div>\n        <div #dragEl class="f-utils-absolute-all" style="height:10px;z-index: 1;" [style.display]="config.showHeader ? \'none\': \'\'"></div>\n            <div class="modal-body" [class.f-utils-flex-column]="dialogType === \'iframe\'"   [f-area-response]="config.areaResponse">\n                <perfect-scrollbar [config]="{}" [disabled]="!config.enableScroll||config.fitContent"  *ngIf="!dialogType || dialogType === \'default\'">\n                    <ng-content ></ng-content>\n                </perfect-scrollbar>\n                <iframe *ngIf="dialogType === \'iframe\'" class="f-utils-fill" width="100%" frameborder="0" [src]="iframeSrc"></iframe>\n            </div>\n\n            <div [style.textAlign]="config.buttonAlign" class="modal-footer" [ngStyle]="buildFooterStyles()" *ngIf="config.showButtons && config.buttons">\n                <ng-container [ngTemplateOutlet]="useButtonsTemplate() ? config.buttons : defaultButtonRef"></ng-container>\n            </div>\n        </div>\n    </div>\n\n    <ng-template #defaultButtonRef>\n\n        <ng-container *ngFor="let btn of config.buttons; last as isLast">\n            <button type="button" modal-button  *ngIf="btn.display === undefined && btn.tipsEnable === undefined"\n                [class]="btn.cls"\n                (click)="btn.handle && btn.handle($event) ">\n                <span [class]="btn.iconCls" *ngIf="btn.iconCls"></span> {{ btn.text }}\n            </button>\n\n            <button type="button" modal-button  *ngIf="btn.display !== undefined || btn.tipsEnable !== undefined"\n                [class]="btn.cls"\n                (click)="btn.handle && btn.handle($event) " \n                [style.display]="(btn.display === true || btn.display === undefined) ? \'\' : \'none\'"\n                [farrisTooltip]="btn?.tipsEnable" [placement]="\'top\'" [delay]="500" [content]="btn?.tipsText">\n                <span [class]="btn.iconCls" *ngIf="btn.iconCls"></span> {{ btn.text }}\n            </button>\n\n        </ng-container>\n\n    </ng-template>\n  ',host:{"class":"modal farris-modal",role:"dialog",tabindex:"-1","[attr.aria-modal]":"true"}}]}],D.ctorParameters=function(){return[{type:f},{type:a.ElementRef},{type:a.Renderer2},{type:t.DomSanitizer}]},D.propDecorators={iframe:[{type:a.Input}],draggbar:[{type:a.ViewChild,args:[d.AngularDraggableDirective]}],modalHeader:[{type:a.ViewChild,args:["header"]}],closed:[{type:a.Output}],opened:[{type:a.Output}],resized:[{type:a.Output}],modalID:[{type:a.HostBinding,args:["id"]}],buttons:[{type:a.ViewChildren,args:[x]}],onClick:[{type:a.HostListener,args:["click",["$event"]]}],onEsc:[{type:a.HostListener,args:["window:keydown.esc",["$event"]]}]},D);function D(e,t,i,n){var o=this;this.el=t,this._renderer=i,this.sanitizer=n,this.isShown=!1,this.isModeless=!1,this.isModalHiding=!1,this.isMax=!1,this.closed=new a.EventEmitter,this.opened=new a.EventEmitter,this.resized=new a.EventEmitter,this.modalID="MODALID_"+Date.now().toPrecision(),this._windowResizeToMax=!1,this.windowResize$=null,this.config=Object.assign({},e),this.config.buttons||(this.config.buttons=[{text:"取消",cls:"btn btn-light",iconCls:"k-icon k-i-close",handle:function(){o.close()}},{text:"确定",cls:"btn btn-primary",iconCls:"k-icon k-i-check",handle:function(){alert("好(｡･∀･)ﾉﾞ嗨哟!!")}}]),this.setIsModeless()}var B=(O.prototype.clearDocumentEvents=function(){this._documentMouseDownHandler&&document.body.removeEventListener("mousedown",this._documentMouseDownHandler),this._documentMouseDownHandler=null},O.prototype.show=function(e,t){return this.modalsCount++,this._createLoaders(),this.config=Object.assign({},b,t),this.checkDialogSize(),this.isModeless()?this.modellessCount++:this._showBackdrop(),this.lastDismissReason=null,this._showModal(e)},O.prototype.isModeless=function(){return!!this.config.hasOwnProperty("modeless")&&this.config.modeless},O.prototype.hide=function(e){this.modalsCount-this.modellessCount==1&&(this._hideBackdrop(),this.resetScrollbar()),this.modalsCount=1<=this.modalsCount?this.modalsCount-1:0,this._hideModal(e),this.removeLoaders(e),this.clearDocumentEvents()},O.prototype._showBackdrop=function(){var e=this.config.backdrop||"static"===this.config.backdrop,t=!this.backdropRef||!this.backdropRef.instance.isShown;this.modalsCount-this.modellessCount==1&&(this.removeBackdrop(),e&&t&&(this._backdropLoader.attach(C).to("body").show({isAnimated:this.config.animated}),this.backdropRef=this._backdropLoader._componentRef))},O.prototype._hideBackdrop=function(){var e=this;if(this.backdropRef){this.backdropRef.instance.isShown=!1;var t=this.config.animated?_:0;this.ngZone.runOutsideAngular(function(){setTimeout(function(){return e.removeBackdrop()},t)})}},O.prototype.updateZindex=function(e){var t=this.commonUtils.getFloatingLayerIndex();e.dialog.instance.updateDialogZindex(t),e.dialog.location.nativeElement.style.zIndex=t},O.prototype._showModal=function(e){var t=this,i=this.loaders[this.loaders.length-1],n=new m,o=i.provide({provide:f,useValue:this.config}).provide({provide:m,useValue:n}).attach(H).to("body").show({content:e,isAnimated:this.config.animated,initialState:this.config.initialState,bsModalService:this});return o.instance.level=this.getModalsCount(),o.instance.dialogType=this.config.dialogType,o.instance.iframe="","iframe"===this.config.dialogType&&(o.instance.iframe=e),n.close=function(e){o.instance.close(e),t.clearDocumentEvents()},this.config.fitContent||(o.instance.toCenter(),this.ngZone.runOutsideAngular(function(){document.body.addEventListener("mousedown",t._documentMouseDownHandler=function(e){t._onMouseDown(e,o.instance.isModeless)})})),n.content=i.getInnerComponent()||null,n.dialog=o,n.buttons=o.instance.buttons,o.instance.modalRef=n,this.config.opened&&this.config.opened({instance:n}),this.updateZindex(n),n},O.prototype._onMouseDown=function(e,t){var i=this;if(void 0===t&&(t=null),t){var n=e.target.classList.contains("modal-dialog")?e.target:null;if(n=n||e.target.closest(".modal-dialog")){var o=this.commonUtils.getFloatingLayerIndex();n.style.zIndex=o,n.parentElement.style.zIndex=o}return!1}if("modal-container"===e.target.localName||e.target.classList.contains("farris-modal"))return this._renderer.addClass(e.target,"animated"),this._renderer.addClass(e.target,"shake"),this.ngZone.runOutsideAngular(function(){setTimeout(function(){i._renderer.removeClass(e.target,"animated"),i._renderer.removeClass(e.target,"shake")},650)}),!1},O.prototype._hideModal=function(e){var t=this.loaders[e-1];t&&t.hide()},O.prototype.getModalsCount=function(){return this.modalsCount},O.prototype.getCurrentModalContainer=function(){return this.loaders[this.getModalsCount()-1]},O.prototype.setDismissReason=function(e){this.lastDismissReason=e},O.prototype.removeBackdrop=function(){this._backdropLoader.hide(),this.backdropRef=null},O.prototype.checkScrollbar=function(){this.isBodyOverflowing=document.body.clientWidth<window.innerWidth,this.scrollbarWidth=this.getScrollbarWidth()},O.prototype.setScrollbar=function(){document&&(this.originalBodyPadding=parseInt(window.getComputedStyle(document.body).getPropertyValue("padding-right")||"0",10),this.isBodyOverflowing&&(document.body.style.paddingRight=this.originalBodyPadding+this.scrollbarWidth+"px"))},O.prototype.resetScrollbar=function(){document.body.style.paddingRight=this.originalBodyPadding+"px"},O.prototype.getScrollbarWidth=function(){var e=this._renderer.createElement("div");this._renderer.addClass(e,v.SCROLLBAR_MEASURER),this._renderer.appendChild(document.body,e);var t=e.offsetWidth-e.clientWidth;return this._renderer.removeChild(document.body,e),t},O.prototype._createLoaders=function(){var e=this.clf.createLoader(null,null,this._renderer);this.copyEvent(e.onBeforeShow,this.onShow),this.copyEvent(e.onShown,this.onShown),this.copyEvent(e.onBeforeHide,this.onHide),this.copyEvent(e.onHidden,this.onHidden),this.loaders.push(e)},O.prototype.removeLoaders=function(e){this.loaders.splice(e-1,1),this.loaders.forEach(function(e,t){e.instance.level=t+1})},O.prototype.copyEvent=function(e,t){var i=this;e.subscribe(function(){t.emit(i.lastDismissReason)})},O.prototype.checkDialogSize=function(){var e=s.Utils.checkDialogSize(this.config.width,this.config.height);this.config.width!==e.width&&(this.config.width=e.width-20),this.config.height!==e.height&&(this.config.height=e.height-20)},O.prototype.closeUpdateModelessCountByModal=function(e){e&&(this.modellessCount=0<this.modellessCount-1?this.modellessCount-1:0)},O.decorators=[{type:a.Injectable}],O.ctorParameters=function(){return[{type:a.RendererFactory2},{type:c.ComponentLoaderFactory},{type:a.NgZone}]},O);function O(e,t,i){this.clf=t,this.ngZone=i,this.version="0.0.6",this.config=b,this.onShow=new a.EventEmitter,this.onShown=new a.EventEmitter,this.onHide=new a.EventEmitter,this.onHidden=new a.EventEmitter,this.isBodyOverflowing=!1,this.originalBodyPadding=0,this.scrollbarWidth=0,this.modalsCount=0,this.lastDismissReason="",this.loaders=[],this._documentMouseDownHandler=null,this.commonUtils=null,this.modellessCount=0,this._renderer=e.createRenderer(null,null),this._backdropLoader=this.clf.createLoader(null,null,this._renderer),this.commonUtils=new r.CommonUtils}var z=function W(e){this.animate=!0,Object.assign(this,e)},I=(Object.defineProperty(T.prototype,"config",{get:function(){return this._config},set:function(e){this._config=this.getConfig(e)},enumerable:!0,configurable:!0}),Object.defineProperty(T.prototype,"isShown",{get:function(){return this._isShown},enumerable:!0,configurable:!0}),T.prototype.onClick=function(e){e.target,this.config.ignoreBackdropClick||"static"===this.config.backdrop||e.target!==this._element.nativeElement?e.stopPropagation():(this.dismissReason=S,this.hide(e))},T.prototype.onEsc=function(e){this._isShown&&(27===e.keyCode&&e.preventDefault(),this.config.keyboard&&(this.dismissReason=E,this.hide()))},T.prototype.ngOnDestroy=function(){this.config=void 0,this._isShown&&(this._isShown=!1,this.hideModal(),this._backdrop.dispose())},T.prototype.ngOnInit=function(){var e=this;this._config=this._config||this.getConfig(),setTimeout(function(){e._config.show&&e.show()},0)},T.prototype.toggle=function(){return this._isShown?this.hide():this.show()},T.prototype.show=function(){var e=this;if(this.dismissReason=null,this.onShow.emit(this),!this._isShown){clearTimeout(this.timerHideModal),clearTimeout(this.timerRmBackDrop);var t=this.commonUtils.getFloatingLayerIndex();this._element.nativeElement.style.zIndex=t,this._isShown=!0,this.checkScrollbar(),this.setScrollbar(),s.document&&s.document.body&&(s.document.body.classList.contains(v.OPEN)?this.isNested=!0:this._renderer.addClass(s.document.body,v.OPEN)),this.showBackdrop(function(){e.showElement()})}},T.prototype.hide=function(e){var t=this;e&&e.preventDefault(),this.onHide.emit(this),this._isShown&&(clearTimeout(this.timerHideModal),clearTimeout(this.timerRmBackDrop),this._isShown=!1,this._renderer.removeClass(this._element.nativeElement,v.IN),this._renderer.removeClass(this._element.nativeElement,v.SHOW),this._config.animated?this.timerHideModal=setTimeout(function(){return t.hideModal()},300):this.hideModal())},T.prototype.getConfig=function(e){return Object.assign({},b,e)},T.prototype.showElement=function(){var e=this;this._element.nativeElement.parentNode&&this._element.nativeElement.parentNode.nodeType===Node.ELEMENT_NODE||s.document&&s.document.body&&s.document.body.appendChild(this._element.nativeElement),this._renderer.setAttribute(this._element.nativeElement,"aria-hidden","false"),this._renderer.setAttribute(this._element.nativeElement,"aria-modal","true"),this._renderer.setStyle(this._element.nativeElement,"display","block"),this._renderer.setProperty(this._element.nativeElement,"scrollTop",0),this._config.animated&&s.Utils.reflow(this._element.nativeElement),this._renderer.addClass(this._element.nativeElement,v.IN),this._renderer.addClass(this._element.nativeElement,v.SHOW);var t=function(){e._config.focus&&e._element.nativeElement.focus(),e.onShown.emit(e)};this._config.animated?setTimeout(t,300):t()},T.prototype.hideModal=function(){var e=this;this._renderer.setAttribute(this._element.nativeElement,"aria-hidden","true"),this._renderer.setStyle(this._element.nativeElement,"display","none"),this.showBackdrop(function(){e.isNested||(s.document&&s.document.body&&!s.document.querySelectorAll(".farris-modal.show").length&&e._renderer.removeClass(s.document.body,v.OPEN),e.resetScrollbar()),e.resetAdjustments(),e.focusOtherModal(),e.onHidden.emit(e)})},T.prototype.showBackdrop=function(e){var t=this;if(!this._isShown||!this.config.backdrop||this.backdrop&&this.backdrop.instance.isShown)if(!this._isShown&&this.backdrop){this.backdrop.instance.isShown=!1;var i=function(){t.removeBackdrop(),e&&e()};this.backdrop.instance.isAnimated?this.timerRmBackDrop=setTimeout(i,150):i()}else e&&e();else{if(this.removeBackdrop(),this._backdrop.attach(C).to("body").show({isAnimated:this._config.animated}),this.backdrop=this._backdrop._componentRef,!e)return;if(!this._config.animated)return void e();setTimeout(e,150)}},T.prototype.removeBackdrop=function(){this._backdrop.hide()},T.prototype.focusOtherModal=function(){if(null!=this._element.nativeElement.parentElement){var e=this._element.nativeElement.parentElement.querySelectorAll(".in[bsModal]");e.length&&e[e.length-1].focus()}},T.prototype.resetAdjustments=function(){this._renderer.setStyle(this._element.nativeElement,"paddingLeft",""),this._renderer.setStyle(this._element.nativeElement,"paddingRight","")},T.prototype.checkScrollbar=function(){this.isBodyOverflowing=s.document.body.clientWidth<s.window.innerWidth,this.scrollbarWidth=this.getScrollbarWidth()},T.prototype.setScrollbar=function(){s.document&&(this.originalBodyPadding=parseInt(s.window.getComputedStyle(s.document.body).getPropertyValue("padding-right")||0,10),this.isBodyOverflowing&&(s.document.body.style.paddingRight=this.originalBodyPadding+this.scrollbarWidth+"px"))},T.prototype.resetScrollbar=function(){s.document.body.style.paddingRight=this.originalBodyPadding+"px"},T.prototype.getScrollbarWidth=function(){var e=this._renderer.createElement("div");this._renderer.addClass(e,v.SCROLLBAR_MEASURER),this._renderer.appendChild(s.document.body,e);var t=e.offsetWidth-e.clientWidth;return this._renderer.removeChild(s.document.body,e),t},T.decorators=[{type:a.Directive,args:[{selector:"[bsModal]",exportAs:"bs-modal"}]}],T.ctorParameters=function(){return[{type:a.ElementRef},{type:a.ViewContainerRef},{type:a.Renderer2},{type:c.ComponentLoaderFactory},{type:a.NgZone},{type:a.ChangeDetectorRef,decorators:[{type:a.Optional}]}]},T.propDecorators={config:[{type:a.Input}],onShow:[{type:a.Output}],onShown:[{type:a.Output}],onHide:[{type:a.Output}],onHidden:[{type:a.Output}],onClick:[{type:a.HostListener,args:["click",["$event"]]}],onEsc:[{type:a.HostListener,args:["keydown.esc",["$event"]]}]},T);function T(e,t,i,n,o,s){this._element=e,this._renderer=i,this.ngZone=o,this.cd=s,this.onShow=new a.EventEmitter,this.onShown=new a.EventEmitter,this.onHide=new a.EventEmitter,this.onHidden=new a.EventEmitter,this._isShown=!1,this.isBodyOverflowing=!1,this.originalBodyPadding=0,this.scrollbarWidth=0,this.timerHideModal=0,this.timerRmBackDrop=0,this.isNested=!1,this.commonUtils=null,this._backdrop=n.createLoader(e,t,i),this.commonUtils=new r.CommonUtils}var A=(P.forRoot=function(){return{ngModule:P,providers:[c.ComponentLoaderFactory,B,h.PositioningService]}},P.decorators=[{type:a.NgModule,args:[{imports:[n.CommonModule,l.PerfectScrollbarModule,d.AngularDraggableModule,u.FAreaResponseModule,p.FarrisTooltipModule],declarations:[I,C,H,x],exports:[C,I],entryComponents:[C,H]}]}],P);function P(){}e.BsModalRef=m,e.BsModalService=B,e.ModalBackdropOptions=z,e.ModalContainerComponent=H,e.ModalBackdropComponent=C,e.ModalDirective=I,e.ModalModule=A,e.ModalButtonDirective=x,e.ModalOptions=f,e.CLASS_NAME=v,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=farris-ui-modal.umd.min.js.map