!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@farris/ui-modal/utils"),require("@angular/core"),require("@farris/ui-modal/positioning")):"function"==typeof define&&define.amd?define("@farris/ui-modal/component-loader",["exports","@farris/ui-modal/utils","@angular/core","@farris/ui-modal/positioning"],t):t((e.farris=e.farris||{},e.farris["ui-modal"]=e.farris["ui-modal"]||{},e.farris["ui-modal"]["component-loader"]={}),e.farris["ui-modal"].utils,e.ng.core,e.farris["ui-modal"].positioning)}(this,function(e,s,a,t){"use strict";var n=function h(){};function f(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var i,o,s=n.call(e),r=[];try{for(;(void 0===t||0<t--)&&!(i=s.next()).done;)r.push(i.value)}catch(c){o={error:c}}finally{try{i&&!i.done&&(n=s["return"])&&n.call(s)}finally{if(o)throw o.error}}return r}var p=function l(e,t,n){this.nodes=e,this.viewRef=t,this.componentRef=n},i=(Object.defineProperty(o.prototype,"isShown",{get:function(){return!this._isHiding&&!!this._componentRef},enumerable:!0,configurable:!0}),o.prototype.attach=function(e){return this._componentFactory=this._componentFactoryResolver.resolveComponentFactory(e),this},o.prototype.to=function(e){return this.container=e||this.container,this},o.prototype.position=function(e){return this.attachment=e.attachment||this.attachment,this._elementRef=e.target||this._elementRef,this},o.prototype.provide=function(e){return this._providers.push(e),this},o.prototype.show=function(e){if(void 0===e&&(e={}),this._subscribePositioning(),this._innerComponent=null,!this._componentRef){this.onBeforeShow.emit(),this._contentRef=this._getContentRef(e.content,e.context,e.initialState);var t=a.ReflectiveInjector.resolveAndCreate(this._providers,this._injector);this._componentRef=this._componentFactory.create(t,this._contentRef.nodes),this._applicationRef.attachView(this._componentRef.hostView),this.instance=this._componentRef.instance,Object.assign(this._componentRef.instance,e),this.container instanceof a.ElementRef&&this.container.nativeElement.appendChild(this._componentRef.location.nativeElement),"body"===this.container&&"undefined"!=typeof document&&document.querySelector(this.container).appendChild(this._componentRef.location.nativeElement),!this.container&&this._elementRef&&this._elementRef.nativeElement.parentElement&&this._elementRef.nativeElement.parentElement.appendChild(this._componentRef.location.nativeElement),this._contentRef.componentRef&&(this._innerComponent=this._contentRef.componentRef.instance,this._contentRef.componentRef.changeDetectorRef.markForCheck(),this._contentRef.componentRef.changeDetectorRef.detectChanges()),this._componentRef.changeDetectorRef.markForCheck(),this._componentRef.changeDetectorRef.detectChanges(),this.onShown.emit(this._componentRef.instance),e.hasOwnProperty("showType")&&"popover"==e.showType&&this._posService.position({element:this._componentRef.location,target:this._elementRef,attachment:this.attachment,appendToBody:"body"===this.container})}return this._registerOutsideClick(),this._componentRef},o.prototype.hide=function(){if(!this._componentRef)return this;this.onBeforeHide.emit(this._componentRef.instance);var e=this._componentRef.location.nativeElement;return e&&e.parentNode&&e.parentNode.removeChild(e),this._contentRef.componentRef&&this._contentRef.componentRef.destroy(),this._componentRef.destroy(),this._viewContainerRef&&this._contentRef.viewRef&&this._viewContainerRef.remove(this._viewContainerRef.indexOf(this._contentRef.viewRef)),this._contentRef.viewRef&&this._contentRef.viewRef.destroy(),this._contentRef=null,this._componentRef=null,this._removeGlobalListener(),this.onHidden.emit(),this},o.prototype.toggle=function(){this.isShown?this.hide():this.show()},o.prototype.dispose=function(){this.isShown&&this.hide(),this._unsubscribePositioning(),this._unregisterListenersFn&&this._unregisterListenersFn()},o.prototype.listen=function(t){var n=this;this.triggers=t.triggers||this.triggers,this._listenOpts.outsideClick=t.outsideClick,t.target=t.target||this._elementRef.nativeElement;var i=this._listenOpts.hide=function(){return t.hide?t.hide():void n.hide()},o=this._listenOpts.show=function(e){t.show?t.show(e):n.show(e),e()};return this._unregisterListenersFn=s.listenToTriggersV2(this._renderer,{target:t.target,triggers:t.triggers,show:o,hide:i,toggle:function(e){n.isShown?i():o(e)}}),this},o.prototype._removeGlobalListener=function(){this._globalListener&&(this._globalListener(),this._globalListener=null)},o.prototype.attachInline=function(e,t){return this._inlineViewRef=e.createEmbeddedView(t),this},o.prototype._registerOutsideClick=function(){var e=this;if(this._componentRef&&this._componentRef.location&&this._listenOpts.outsideClick){var t=this._componentRef.location.nativeElement;this._ngZone.runOutsideAngular(function(){setTimeout(function(){e._globalListener=s.registerOutsideClick(e._renderer,{targets:[t,e._elementRef.nativeElement],outsideClick:e._listenOpts.outsideClick,hide:function(){return e._listenOpts.hide()}})})})}},o.prototype.getInnerComponent=function(){return this._innerComponent},o.prototype._subscribePositioning=function(){if(!this._zoneSubscription&&this.attachment){var e=this;this._zoneSubscription=this._ngZone.onStable.subscribe(function(){e._componentRef&&e._posService.position({element:e._componentRef.location,target:e._elementRef,attachment:e.attachment,appendToBody:"body"===e.container})})}},o.prototype._unsubscribePositioning=function(){this._zoneSubscription&&(this._zoneSubscription.unsubscribe(),this._zoneSubscription=null)},o.prototype._getContentRef=function(e,t,n){if(!e)return new p([]);if(e instanceof a.TemplateRef){if(this._viewContainerRef){var i=this._viewContainerRef.createEmbeddedView(e,t);return i.markForCheck(),new p([i.rootNodes],i)}var o=e.createEmbeddedView({});return this._applicationRef.attachView(o),new p([o.rootNodes],o)}if(e instanceof a.ComponentRef)return Object.assign(e.instance,n),this._applicationRef.attachView(e.hostView),new p([[e.location.nativeElement]],e.hostView,e);if("function"!=typeof e)return new p([[this._renderer.createText(""+e)]]);var s=this._componentFactoryResolver.resolveComponentFactory(e),r=a.ReflectiveInjector.resolveAndCreate(function h(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(f(arguments[t]));return e}(this._providers),this._injector),c=s.create(r);return Object.assign(c.instance,n),this._applicationRef.attachView(c.hostView),new p([[c.location.nativeElement]],c.hostView,c)},o);function o(e,t,n,i,o,s,r,c){this._viewContainerRef=e,this._renderer=t,this._elementRef=n,this._injector=i,this._componentFactoryResolver=o,this._ngZone=s,this._applicationRef=r,this._posService=c,this.onBeforeShow=new a.EventEmitter,this.onShown=new a.EventEmitter,this.onBeforeHide=new a.EventEmitter,this.onHidden=new a.EventEmitter,this._providers=[],this._isHiding=!1,this._listenOpts={},this._globalListener=Function.prototype}var r=(c.prototype.createLoader=function(e,t,n){return new i(t,n,e,this._injector,this._componentFactoryResolver,this._ngZone,this._applicationRef,this._posService)},c.decorators=[{type:a.Injectable}],c.ctorParameters=function(){return[{type:a.ComponentFactoryResolver},{type:a.NgZone},{type:a.Injector},{type:t.PositioningService},{type:a.ApplicationRef}]},c);function c(e,t,n,i,o){this._componentFactoryResolver=e,this._ngZone=t,this._injector=n,this._posService=i,this._applicationRef=o}e.BsComponentRef=n,e.ComponentLoader=i,e.ComponentLoaderFactory=r,e.ContentRef=p,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=farris-ui-modal-component-loader.umd.min.js.map