{"version":3,"file":"farris-ui-modal-component-loader.js.map","sources":["ng://@farris/ui-modal/component-loader/bs-component-ref.class.ts","ng://@farris/ui-modal/component-loader/content-ref.class.ts","ng://@farris/ui-modal/component-loader/component-loader.class.ts","ng://@farris/ui-modal/component-loader/component-loader.factory.ts"],"sourcesContent":["import { TemplateRef, ViewContainerRef } from '@angular/core';\r\n\r\nexport class BsComponentRef<T> {\r\n  templateRef: TemplateRef<T>;\r\n  viewContainer: ViewContainerRef;\r\n}\r\n","/**\r\n * @copyright Valor Software\r\n * @copyright Angular ng-bootstrap team\r\n */\r\n\r\nimport { ComponentRef, ViewRef } from '@angular/core';\r\n\r\nexport class ContentRef {\r\n  nodes: any[];\r\n  viewRef?: ViewRef;\r\n  componentRef?: ComponentRef<any>;\r\n\r\n  constructor(\r\n    nodes: any[],\r\n    viewRef?: ViewRef,\r\n    componentRef?: ComponentRef<any>\r\n  ) {\r\n    this.nodes = nodes;\r\n    this.viewRef = viewRef;\r\n    this.componentRef = componentRef;\r\n  }\r\n}\r\n","// tslint:disable:max-file-line-count\r\n// todo: add delay support\r\n// todo: merge events onShow, onShown, etc...\r\n// todo: add global positioning configuration?\r\nimport {\r\n    ApplicationRef,\r\n    ComponentFactory,\r\n    ComponentFactoryResolver,\r\n    ComponentRef,\r\n    ElementRef,\r\n    EmbeddedViewRef,\r\n    EventEmitter,\r\n    Injector,\r\n    NgZone,\r\n    Provider,\r\n    ReflectiveInjector,\r\n    Renderer2,\r\n    TemplateRef,\r\n    Type,\r\n    ViewContainerRef\r\n} from '@angular/core';\r\nimport { PositioningOptions, PositioningService } from '@farris/ui-modal/positioning';\r\nimport { listenToTriggersV2, registerOutsideClick } from '@farris/ui-modal/utils';\r\nimport { ContentRef } from './content-ref.class';\r\nimport { ListenOptions } from './listen-options.model';\r\n\r\nexport class ComponentLoader<T> {\r\n    onBeforeShow: EventEmitter<any> = new EventEmitter();\r\n    onShown: EventEmitter<any> = new EventEmitter();\r\n    onBeforeHide: EventEmitter<any> = new EventEmitter();\r\n    onHidden: EventEmitter<any> = new EventEmitter();\r\n\r\n    instance: T;\r\n    _componentRef: ComponentRef<T>;\r\n    _inlineViewRef: EmbeddedViewRef<T>;\r\n\r\n    private _providers: Provider[] = [];\r\n    private _componentFactory: ComponentFactory<T>;\r\n    private _zoneSubscription: any;\r\n    private _contentRef: ContentRef;\r\n    private _innerComponent: ComponentRef<T>;\r\n\r\n    private _unregisterListenersFn: Function;\r\n\r\n    get isShown(): boolean {\r\n        if (this._isHiding) {\r\n            return false;\r\n        }\r\n\r\n        return !!this._componentRef;\r\n    }\r\n\r\n    private _isHiding = false;\r\n\r\n    /**\r\n     * Placement of a component. Accepts: \"top\", \"bottom\", \"left\", \"right\"\r\n     */\r\n    private attachment: string;\r\n\r\n    /**\r\n     * A selector specifying the element the popover should be appended to.\r\n     * Currently only supports \"body\".\r\n     */\r\n    private container: string | ElementRef | any;\r\n\r\n    /**\r\n     * Specifies events that should trigger. Supports a space separated list of\r\n     * event names.\r\n     */\r\n    private triggers: string;\r\n\r\n    private _listenOpts: ListenOptions = {};\r\n    private _globalListener = Function.prototype;\r\n\r\n    /**\r\n     * Do not use this directly, it should be instanced via\r\n     * `ComponentLoadFactory.attach`\r\n     * @internal\r\n     */\r\n    // tslint:disable-next-line\r\n    public constructor(\r\n        private _viewContainerRef: ViewContainerRef,\r\n        private _renderer: Renderer2,\r\n        private _elementRef: ElementRef,\r\n        private _injector: Injector,\r\n        private _componentFactoryResolver: ComponentFactoryResolver,\r\n        private _ngZone: NgZone,\r\n        private _applicationRef: ApplicationRef,\r\n        private _posService: PositioningService\r\n    ) { }\r\n\r\n    attach(compType: Type<T>): ComponentLoader<T> {\r\n        this._componentFactory = this._componentFactoryResolver\r\n            .resolveComponentFactory<T>(compType);\r\n\r\n        return this;\r\n    }\r\n\r\n    // todo: add behaviour: to target element, `body`, custom element\r\n    to(container?: string): ComponentLoader<T> {\r\n        this.container = container || this.container;\r\n\r\n        return this;\r\n    }\r\n\r\n    position(opts?: PositioningOptions): ComponentLoader<T> {\r\n        this.attachment = opts.attachment || this.attachment;\r\n        this._elementRef = (opts.target as ElementRef) || this._elementRef;\r\n\r\n        return this;\r\n    }\r\n\r\n    provide(provider: Provider): ComponentLoader<T> {\r\n        this._providers.push(provider);\r\n\r\n        return this;\r\n    }\r\n\r\n    // todo: appendChild to element or document.querySelector(this.container)\r\n\r\n    show(opts: {\r\n        content?: string | TemplateRef<any> | ComponentRef<any>;\r\n        context?: any;\r\n        initialState?: any;\r\n        [key: string]: any;\r\n    } = {}\r\n    ): ComponentRef<T> {\r\n\r\n        this._subscribePositioning();\r\n        this._innerComponent = null;\r\n\r\n        if (!this._componentRef) {\r\n            this.onBeforeShow.emit();\r\n            this._contentRef = this._getContentRef(opts.content, opts.context, opts.initialState);\r\n            const injector = ReflectiveInjector.resolveAndCreate(this._providers, this._injector);\r\n\r\n            this._componentRef = this._componentFactory.create(injector, this._contentRef.nodes);\r\n            this._applicationRef.attachView(this._componentRef.hostView);\r\n            // this._componentRef = this._viewContainerRef\r\n            //   .createComponent(this._componentFactory, 0, injector, this._contentRef.nodes);\r\n            this.instance = this._componentRef.instance;\r\n\r\n            Object.assign(this._componentRef.instance, opts);\r\n\r\n            if (this.container instanceof ElementRef) {\r\n                this.container.nativeElement.appendChild(\r\n                    this._componentRef.location.nativeElement\r\n                );\r\n            }\r\n\r\n            if (this.container === 'body' && typeof document !== 'undefined') {\r\n                document\r\n                    .querySelector(this.container as string)\r\n                    .appendChild(this._componentRef.location.nativeElement);\r\n            }\r\n\r\n            if (\r\n                !this.container &&\r\n                this._elementRef &&\r\n                this._elementRef.nativeElement.parentElement\r\n            ) {\r\n                this._elementRef.nativeElement.parentElement.appendChild(\r\n                    this._componentRef.location.nativeElement\r\n                );\r\n            }\r\n\r\n            // we need to manually invoke change detection since events registered\r\n            // via\r\n            // Renderer::listen() are not picked up by change detection with the\r\n            // OnPush strategy\r\n            if (this._contentRef.componentRef) {\r\n                this._innerComponent = this._contentRef.componentRef.instance;\r\n                this._contentRef.componentRef.changeDetectorRef.markForCheck();\r\n                this._contentRef.componentRef.changeDetectorRef.detectChanges();\r\n            }\r\n            this._componentRef.changeDetectorRef.markForCheck();\r\n            this._componentRef.changeDetectorRef.detectChanges();\r\n            this.onShown.emit(this._componentRef.instance);\r\n            if(opts.hasOwnProperty('showType')&&opts['showType']=='popover'){\r\n                this._posService.position({\r\n                    element: this._componentRef.location,\r\n                    target: this._elementRef,\r\n                    attachment: this.attachment,\r\n                    appendToBody: this.container === 'body'\r\n                });\r\n            }\r\n        }\r\n\r\n        this._registerOutsideClick();\r\n\r\n        return this._componentRef;\r\n    }\r\n\r\n    hide(): ComponentLoader<T> {\r\n        if (!this._componentRef) {\r\n            return this;\r\n        }\r\n\r\n        this.onBeforeHide.emit(this._componentRef.instance);\r\n\r\n        const componentEl = this._componentRef.location.nativeElement;\r\n        if (componentEl && componentEl.parentNode) {\r\n            componentEl.parentNode.removeChild(componentEl);\r\n        }\r\n        if (this._contentRef.componentRef) {\r\n            this._contentRef.componentRef.destroy();\r\n        }\r\n        this._componentRef.destroy();\r\n        if (this._viewContainerRef && this._contentRef.viewRef) {\r\n            this._viewContainerRef.remove(\r\n                this._viewContainerRef.indexOf(this._contentRef.viewRef)\r\n            );\r\n        }\r\n        if (this._contentRef.viewRef) {\r\n            this._contentRef.viewRef.destroy();\r\n        }\r\n        // this._viewContainerRef.remove(this._viewContainerRef.indexOf(this._componentRef.hostView));\r\n        //\r\n        // if (this._contentRef.viewRef && this._viewContainerRef.indexOf(this._contentRef.viewRef) !== -1) {\r\n        //   this._viewContainerRef.remove(this._viewContainerRef.indexOf(this._contentRef.viewRef));\r\n        // }\r\n\r\n        this._contentRef = null;\r\n        this._componentRef = null;\r\n        this._removeGlobalListener();\r\n\r\n        this.onHidden.emit();\r\n\r\n        return this;\r\n    }\r\n\r\n    toggle(): void {\r\n        if (this.isShown) {\r\n            this.hide();\r\n\r\n            return;\r\n        }\r\n\r\n        this.show();\r\n    }\r\n\r\n    dispose(): void {\r\n        if (this.isShown) {\r\n            this.hide();\r\n        }\r\n\r\n        this._unsubscribePositioning();\r\n\r\n        if (this._unregisterListenersFn) {\r\n            this._unregisterListenersFn();\r\n        }\r\n    }\r\n\r\n    listen(listenOpts: ListenOptions): ComponentLoader<T> {\r\n        this.triggers = listenOpts.triggers || this.triggers;\r\n        this._listenOpts.outsideClick = listenOpts.outsideClick;\r\n        listenOpts.target = listenOpts.target || this._elementRef.nativeElement;\r\n\r\n        const hide = (this._listenOpts.hide = () =>\r\n            listenOpts.hide ? listenOpts.hide() : void this.hide());\r\n        const show = (this._listenOpts.show = (registerHide: Function) => {\r\n            listenOpts.show ? listenOpts.show(registerHide) : this.show(registerHide);\r\n            registerHide();\r\n        });\r\n\r\n        const toggle = (registerHide: Function) => {\r\n            this.isShown ? hide() : show(registerHide);\r\n        };\r\n\r\n        this._unregisterListenersFn = listenToTriggersV2(this._renderer, {\r\n            target: listenOpts.target,\r\n            triggers: listenOpts.triggers,\r\n            show,\r\n            hide,\r\n            toggle\r\n        });\r\n\r\n        return this;\r\n    }\r\n\r\n    _removeGlobalListener() {\r\n        if (this._globalListener) {\r\n            this._globalListener();\r\n            this._globalListener = null;\r\n        }\r\n    }\r\n\r\n    attachInline(\r\n        vRef: ViewContainerRef,\r\n        template: TemplateRef<any>\r\n    ): ComponentLoader<T> {\r\n        this._inlineViewRef = vRef.createEmbeddedView(template);\r\n\r\n        return this;\r\n    }\r\n\r\n    _registerOutsideClick(): void {\r\n        if (!this._componentRef || !this._componentRef.location) {\r\n            return;\r\n        }\r\n        // why: should run after first event bubble\r\n        if (this._listenOpts.outsideClick) {\r\n            const target = this._componentRef.location.nativeElement;\r\n            this._ngZone.runOutsideAngular(() => {\r\n                setTimeout(() => {\r\n                    this._globalListener = registerOutsideClick(this._renderer, {\r\n                        targets: [target, this._elementRef.nativeElement],\r\n                        outsideClick: this._listenOpts.outsideClick,\r\n                        hide: () => this._listenOpts.hide()\r\n                    });\r\n                });\r\n            });\r\n        }\r\n    }\r\n\r\n    getInnerComponent(): ComponentRef<T> {\r\n        return this._innerComponent;\r\n    }\r\n\r\n    private _subscribePositioning(): void {\r\n        if (this._zoneSubscription || !this.attachment) {\r\n            return;\r\n        }\r\n        let self=this;\r\n        this._zoneSubscription = this._ngZone.onStable.subscribe(() => {\r\n            if (!self._componentRef) {\r\n                return;\r\n            }\r\n            self._posService.position({\r\n                element: self._componentRef.location,\r\n                target: self._elementRef,\r\n                attachment: self.attachment,\r\n                appendToBody: self.container === 'body'\r\n            });\r\n        });\r\n    }\r\n\r\n    private _unsubscribePositioning(): void {\r\n        if (!this._zoneSubscription) {\r\n            return;\r\n        }\r\n        this._zoneSubscription.unsubscribe();\r\n        this._zoneSubscription = null;\r\n    }\r\n\r\n    private _getContentRef(\r\n        content: string | TemplateRef<any> | any,\r\n        context?: any,\r\n        initialState?: any\r\n    ): ContentRef {\r\n        if (!content) {\r\n            return new ContentRef([]);\r\n        }\r\n\r\n        if (content instanceof TemplateRef) {\r\n            if (this._viewContainerRef) {\r\n                const _viewRef = this._viewContainerRef\r\n                    .createEmbeddedView<TemplateRef<T>>(content, context);\r\n                _viewRef.markForCheck();\r\n\r\n                return new ContentRef([_viewRef.rootNodes], _viewRef);\r\n            }\r\n            const viewRef = content.createEmbeddedView({});\r\n            this._applicationRef.attachView(viewRef);\r\n\r\n            return new ContentRef([viewRef.rootNodes], viewRef);\r\n        }\r\n\r\n        if (content instanceof ComponentRef) {\r\n            Object.assign(content.instance, initialState);\r\n            this._applicationRef.attachView(content.hostView);\r\n\r\n            return new ContentRef(\r\n                [[content.location.nativeElement]],\r\n                content.hostView,\r\n                content\r\n            );\r\n        }\r\n\r\n        if (typeof content === 'function') {\r\n            const contentCmptFactory = this._componentFactoryResolver.resolveComponentFactory(\r\n                content\r\n            );\r\n            const modalContentInjector = ReflectiveInjector.resolveAndCreate(\r\n                [...this._providers],\r\n                this._injector\r\n            );\r\n            const componentRef = contentCmptFactory.create(modalContentInjector);\r\n            Object.assign(componentRef.instance, initialState);\r\n            this._applicationRef.attachView(componentRef.hostView);\r\n\r\n            return new ContentRef(\r\n                [[componentRef.location.nativeElement]],\r\n                componentRef.hostView,\r\n                componentRef\r\n            );\r\n        }\r\n\r\n        return new ContentRef([[this._renderer.createText(`${content}`)]]);\r\n    }\r\n}\r\n","import {\r\n  ApplicationRef, ComponentFactoryResolver, ElementRef, Injectable, Injector,\r\n  NgZone, Renderer2, ViewContainerRef\r\n} from '@angular/core';\r\nimport { ComponentLoader } from './component-loader.class';\r\nimport { PositioningService } from '@farris/ui-modal/positioning';\r\n\r\n@Injectable()\r\nexport class ComponentLoaderFactory {\r\n  constructor(private _componentFactoryResolver: ComponentFactoryResolver,\r\n              private _ngZone: NgZone,\r\n              private _injector: Injector,\r\n              private _posService: PositioningService,\r\n              private _applicationRef: ApplicationRef) {}\r\n\r\n  /**\r\n   *\r\n   * @param _elementRef\r\n   * @param _viewContainerRef\r\n   * @param _renderer\r\n   */\r\n  createLoader<T>(_elementRef: ElementRef,\r\n                  _viewContainerRef: ViewContainerRef,\r\n                  _renderer: Renderer2): ComponentLoader<T> {\r\n    return new ComponentLoader<T>(\r\n      _viewContainerRef,\r\n      _renderer,\r\n      _elementRef,\r\n      this._injector,\r\n      this._componentFactoryResolver,\r\n      this._ngZone,\r\n      this._applicationRef,\r\n      this._posService\r\n    );\r\n  }\r\n}\r\n"],"names":[],"mappings":"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"}
