/**
 * @fileoverview added by tsickle
 * Generated from: lib/ffilepreview-adapt-unifile.directive.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Directive, HostListener, Input } from '@angular/core';
import { FfilepreviewAdaptUnifileService } from './ffilepreview-adapt-unifile.service';
export class FFilePreviewAdaptUnifileDirective {
    /**
     * @param {?} previewSer
     */
    constructor(previewSer) {
        this.previewSer = previewSer;
        /**
         * 处理扩展的服务器端配置
         */
        this._extendServeConfig = null;
    }
    /**
     * 捕获预览事件
     * @param {?} fileInfo
     * @return {?}
     */
    filePreviewEventHandler(fileInfo) {
        // 可以通过属性 extendServerConfig设置，也可以通过一体化组件的Input属性配置
        /** @type {?} */
        const previewOpts = Object.assign(this.extendServerConfig || {});
        previewOpts.options = Object.assign(previewOpts.options || {}, { showDownload: !!fileInfo.showDownload }, { showComments: !!fileInfo.showComments }, { modeless: !!fileInfo.modeless });
        if (previewOpts.options.showHeader === undefined) {
            previewOpts.options.showHeader = true;
        }
        if (previewOpts.options.showFileList === undefined) {
            previewOpts.options.showFileList = true;
        }
        if (previewOpts.options.showComments === undefined) {
            previewOpts.options.showComments = false;
        }
        if (previewOpts.options.modeless === undefined) {
            previewOpts.options.modeless = false;
        }
        // 支持修订模式
        // 文件扩展名
        /** @type {?} */
        const extendName = fileInfo.name.substr(fileInfo.name.lastIndexOf('.') + 1).toLowerCase();
        /** @type {?} */
        const enablePreviews = ['doc', 'docx', 'xls', 'xlsx', 'ppt', 'pptx', 'jpg', 'jpeg', 'png', 'gif', 'bmp', 'pdf', 'txt', 'wps', 'wpt', 'et', 'dps'];
        if (enablePreviews.includes(extendName)) {
            this.previewSer.previewFile(fileInfo, previewOpts);
        }
        else {
            /** @type {?} */
            const msg = this.previewSer.getLocalStr("previewAdapt.notSupport");
            if (this.previewSer.notifySer) {
                this.previewSer.notifySer.warning(msg);
            }
            else {
                alert(msg);
            }
        }
    }
    /**
     * 捕获下载事件
     * @param {?} downloadEv
     * @return {?}
     */
    fileDownloadEventHandler(downloadEv) {
        // 如果是批量下载, downloadEv={fileInfos:[],name:}
        if (downloadEv && downloadEv['fileInfos'].length > 0) {
            if (downloadEv['fileInfos'].length > 1) {
                this.previewSer.multiDownloadFilesWidthName(downloadEv['fileInfos'], downloadEv['name'], this.extendServerConfig);
            }
            else {
                this.previewSer.downloadFile(downloadEv['fileInfos'][0], this.extendServerConfig);
            }
        }
    }
    /**
     * @param {?} value
     * @return {?}
     */
    set extendServerConfig(value) {
        this._extendServeConfig = value;
        this.previewSer.setPreviwExtendServerConfig(value);
    }
    /**
     * @return {?}
     */
    get extendServerConfig() {
        return this._extendServeConfig;
    }
}
FFilePreviewAdaptUnifileDirective.decorators = [
    { type: Directive, args: [{
                selector: '[fFilePreviewAdaptUnifile]',
                providers: [FfilepreviewAdaptUnifileService]
            },] }
];
/** @nocollapse */
FFilePreviewAdaptUnifileDirective.ctorParameters = () => [
    { type: FfilepreviewAdaptUnifileService }
];
FFilePreviewAdaptUnifileDirective.propDecorators = {
    filePreviewEventHandler: [{ type: HostListener, args: ['filePreviewEvent', ['$event'],] }],
    fileDownloadEventHandler: [{ type: HostListener, args: ['fileDownloadEvent', ['$event'],] }],
    extendServerConfig: [{ type: Input }]
};
if (false) {
    /**
     * 处理扩展的服务器端配置
     * @type {?}
     * @private
     */
    FFilePreviewAdaptUnifileDirective.prototype._extendServeConfig;
    /**
     * @type {?}
     * @private
     */
    FFilePreviewAdaptUnifileDirective.prototype.previewSer;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZmZpbGVwcmV2aWV3LWFkYXB0LXVuaWZpbGUuZGlyZWN0aXZlLmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGZhcnJpcy9leHRlbmQtZmlsZXVwbG9hZC1hZGFwdC11bmlmaWxlLyIsInNvdXJjZXMiOlsibGliL2ZmaWxlcHJldmlldy1hZGFwdC11bmlmaWxlLmRpcmVjdGl2ZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7OztBQUFBLE9BQU8sRUFBRSxTQUFTLEVBQUUsWUFBWSxFQUFFLEtBQUssRUFBWSxNQUFNLGVBQWUsQ0FBQztBQUN6RSxPQUFPLEVBQUUsK0JBQStCLEVBQUUsTUFBTSxzQ0FBc0MsQ0FBQztBQU12RixNQUFNLE9BQU8saUNBQWlDOzs7O0lBcUUxQyxZQUFvQixVQUEyQztRQUEzQyxlQUFVLEdBQVYsVUFBVSxDQUFpQzs7OztRQVR2RCx1QkFBa0IsR0FBQyxJQUFJLENBQUM7SUFXaEMsQ0FBQzs7Ozs7O0lBakVELHVCQUF1QixDQUFDLFFBQVE7OztjQUV0QixXQUFXLEdBQUcsTUFBTSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsa0JBQWtCLElBQUksRUFBRSxDQUFDO1FBQ2hFLFdBQVcsQ0FBQyxPQUFPLEdBQUcsTUFBTSxDQUFDLE1BQU0sQ0FBQyxXQUFXLENBQUMsT0FBTyxJQUFJLEVBQUUsRUFBRSxFQUFDLFlBQVksRUFBRSxDQUFDLENBQUMsUUFBUSxDQUFDLFlBQVksRUFBQyxFQUFDLEVBQUMsWUFBWSxFQUFDLENBQUMsQ0FBQyxRQUFRLENBQUMsWUFBWSxFQUFDLEVBQUMsRUFBQyxRQUFRLEVBQUMsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxRQUFRLEVBQUMsQ0FBQyxDQUFDO1FBRTlLLElBQUksV0FBVyxDQUFDLE9BQU8sQ0FBQyxVQUFVLEtBQUssU0FBUyxFQUFFO1lBQzlDLFdBQVcsQ0FBQyxPQUFPLENBQUMsVUFBVSxHQUFHLElBQUksQ0FBQztTQUN6QztRQUVELElBQUksV0FBVyxDQUFDLE9BQU8sQ0FBQyxZQUFZLEtBQUss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dGl2ZSwgSG9zdExpc3RlbmVyLCBJbnB1dCwgT3B0aW9uYWwgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgRmZpbGVwcmV2aWV3QWRhcHRVbmlmaWxlU2VydmljZSB9IGZyb20gJy4vZmZpbGVwcmV2aWV3LWFkYXB0LXVuaWZpbGUuc2VydmljZSc7XHJcblxyXG5ARGlyZWN0aXZlKHtcclxuICAgIHNlbGVjdG9yOiAnW2ZGaWxlUHJldmlld0FkYXB0VW5pZmlsZV0nLFxyXG4gICAgcHJvdmlkZXJzOltGZmlsZXByZXZpZXdBZGFwdFVuaWZpbGVTZXJ2aWNlXVxyXG59KVxyXG5leHBvcnQgY2xhc3MgRkZpbGVQcmV2aWV3QWRhcHRVbmlmaWxlRGlyZWN0aXZlIHtcclxuICAgIC8qKlxyXG4gICAgICog5o2V6I636aKE6KeI5LqL5Lu2XHJcbiAgICAgKiBAcGFyYW0gZmlsZUluZm8gXHJcbiAgICAgKi9cclxuICAgIEBIb3N0TGlzdGVuZXIoJ2ZpbGVQcmV2aWV3RXZlbnQnLCBbJyRldmVudCddKVxyXG4gICAgZmlsZVByZXZpZXdFdmVudEhhbmRsZXIoZmlsZUluZm8pIHtcclxuICAgICAgICAvLyDlj6/ku6XpgJrov4flsZ7mgKcgZXh0ZW5kU2VydmVyQ29uZmln6K6+572u77yM5Lmf5Y+v5Lul6YCa6L+H5LiA5L2T5YyW57uE5Lu255qESW5wdXTlsZ7mgKfphY3nva5cclxuICAgICAgICBjb25zdCBwcmV2aWV3T3B0cyA9IE9iamVjdC5hc3NpZ24odGhpcy5leHRlbmRTZXJ2ZXJDb25maWcgfHwge30pO1xyXG4gICAgICAgIHByZXZpZXdPcHRzLm9wdGlvbnMgPSBPYmplY3QuYXNzaWduKHByZXZpZXdPcHRzLm9wdGlvbnMgfHwge30sIHtzaG93RG93bmxvYWQ6ICEhZmlsZUluZm8uc2hvd0Rvd25sb2FkfSx7c2hvd0NvbW1lbnRzOiEhZmlsZUluZm8uc2hvd0NvbW1lbnRzfSx7bW9kZWxlc3M6ISFmaWxlSW5mby5tb2RlbGVzc30pO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGlmIChwcmV2aWV3T3B0cy5vcHRpb25zLnNob3dIZWFkZXIgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICBwcmV2aWV3T3B0cy5vcHRpb25zLnNob3dIZWFkZXIgPSB0cnVlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHByZXZpZXdPcHRzLm9wdGlvbnMuc2hvd0ZpbGVMaXN0ID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgcHJldmlld09wdHMub3B0aW9ucy5zaG93RmlsZUxpc3QgPSB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAocHJldmlld09wdHMub3B0aW9ucy5zaG93Q29tbWVudHMgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICBwcmV2aWV3T3B0cy5vcHRpb25zLnNob3dDb21tZW50cyA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAocHJldmlld09wdHMub3B0aW9ucy5tb2RlbGVzcyA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIHByZXZpZXdPcHRzLm9wdGlvbnMubW9kZWxlc3MgPSBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8g5pSv5oyB5L+u6K6i5qih5byPXHJcblxyXG4gICAgICAgIC8vIOaWh+S7tuaJqeWxleWQjVxyXG4gICAgICAgIGNvbnN0IGV4dGVuZE5hbWUgPSBmaWxlSW5mby5uYW1lLnN1YnN0cihmaWxlSW5mby5uYW1lLmxhc3RJbmRleE9mKCcuJykgKyAxKS50b0xvd2VyQ2FzZSgpO1xyXG4gICAgICAgIGNvbnN0IGVuYWJsZVByZXZpZXdzID0gWyAnZG9jJywnZG9jeCcsJ3hscycsJ3hsc3gnLCdwcHQnLCdwcHR4JywnanBnJywnanBlZycsJ3BuZycsICdnaWYnLCAnYm1wJywgJ3BkZicsICd0eHQnLCAnd3BzJywgJ3dwdCcsICdldCcsJ2RwcyddO1xyXG5cclxuICAgICAgICBpZiAoZW5hYmxlUHJldmlld3MuaW5jbHVkZXMoZXh0ZW5kTmFtZSkpIHtcclxuICAgICAgICAgICAgdGhpcy5wcmV2aWV3U2VyLnByZXZpZXdGaWxlKGZpbGVJbmZvLCBwcmV2aWV3T3B0cyk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgY29uc3QgbXNnID0gdGhpcy5wcmV2aWV3U2VyLmdldExvY2FsU3RyKFwicHJldmlld0FkYXB0Lm5vdFN1cHBvcnRcIik7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLnByZXZpZXdTZXIubm90aWZ5U2VyKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnByZXZpZXdTZXIubm90aWZ5U2VyLndhcm5pbmcobXNnKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGFsZXJ0KG1zZyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIOaNleiOt+S4i+i9veS6i+S7tlxyXG4gICAgICogQHBhcmFtIGZpbGVJbmZvIFxyXG4gICAgICovXHJcbiAgICBASG9zdExpc3RlbmVyKCdmaWxlRG93bmxvYWRFdmVudCcsIFsnJGV2ZW50J10pXHJcbiAgICBmaWxlRG93bmxvYWRFdmVudEhhbmRsZXIoZG93bmxvYWRFdikge1xyXG4gICAgICAgIC8vIOWmguaenOaYr+aJuemHj+S4i+i9vSwgZG93bmxvYWRFdj17ZmlsZUluZm9zOltdLG5hbWU6fVxyXG4gICAgICAgIGlmIChkb3dubG9hZEV2JiZkb3dubG9hZEV2WydmaWxlSW5mb3MnXS5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIGlmIChkb3dubG9hZEV2WydmaWxlSW5mb3MnXS5sZW5ndGggPiAxKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnByZXZpZXdTZXIubXVsdGlEb3dubG9hZEZpbGVzV2lkdGhOYW1lKGRvd25sb2FkRXZbJ2ZpbGVJbmZvcyddLGRvd25sb2FkRXZbJ25hbWUnXSwgdGhpcy5leHRlbmRTZXJ2ZXJDb25maWcpO1xyXG4gICAgICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgICAgIHRoaXMucHJldmlld1Nlci5kb3dubG9hZEZpbGUoZG93bmxvYWRFdlsnZmlsZUluZm9zJ11bMF0sIHRoaXMuZXh0ZW5kU2VydmVyQ29uZmlnKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gICAgICAgIFxyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog5aSE55CG5omp5bGV55qE5pyN5Yqh5Zmo56uv6YWN572uXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgX2V4dGVuZFNlcnZlQ29uZmlnPW51bGw7XHJcbiAgICBASW5wdXQoKSBcclxuICAgIHNldCBleHRlbmRTZXJ2ZXJDb25maWcodmFsdWUpe1xyXG4gICAgICAgIHRoaXMuX2V4dGVuZFNlcnZlQ29uZmlnPXZhbHVlO1xyXG4gICAgICAgIHRoaXMucHJldmlld1Nlci5zZXRQcmV2aXdFeHRlbmRTZXJ2ZXJDb25maWcodmFsdWUpO1xyXG4gICAgfSBcclxuICAgIGdldCBleHRlbmRTZXJ2ZXJDb25maWcoKXtcclxuICAgICAgICByZXR1cm4gdGhpcy5fZXh0ZW5kU2VydmVDb25maWc7XHJcbiAgICB9XHJcbiAgICBjb25zdHJ1Y3Rvcihwcml2YXRlIHByZXZpZXdTZXI6IEZmaWxlcHJldmlld0FkYXB0VW5pZmlsZVNlcnZpY2UgKSB7XHJcbiAgICAgICAgXHJcbiAgICB9XHJcblxyXG59XHJcbiJdfQ==