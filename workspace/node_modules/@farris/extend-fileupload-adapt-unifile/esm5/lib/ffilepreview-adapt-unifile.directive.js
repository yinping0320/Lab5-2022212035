/**
 * @fileoverview added by tsickle
 * Generated from: lib/ffilepreview-adapt-unifile.directive.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Directive, HostListener, Input } from '@angular/core';
import { FfilepreviewAdaptUnifileService } from './ffilepreview-adapt-unifile.service';
var FFilePreviewAdaptUnifileDirective = /** @class */ (function () {
    function FFilePreviewAdaptUnifileDirective(previewSer) {
        this.previewSer = previewSer;
        /**
         * 处理扩展的服务器端配置
         */
        this._extendServeConfig = null;
    }
    /**
     * 捕获预览事件
     * @param fileInfo
     */
    /**
     * 捕获预览事件
     * @param {?} fileInfo
     * @return {?}
     */
    FFilePreviewAdaptUnifileDirective.prototype.filePreviewEventHandler = /**
     * 捕获预览事件
     * @param {?} fileInfo
     * @return {?}
     */
    function (fileInfo) {
        // 可以通过属性 extendServerConfig设置，也可以通过一体化组件的Input属性配置
        /** @type {?} */
        var previewOpts = Object.assign(this.extendServerConfig || {});
        previewOpts.options = Object.assign(previewOpts.options || {}, { showDownload: !!fileInfo.showDownload }, { showComments: !!fileInfo.showComments }, { modeless: !!fileInfo.modeless });
        if (previewOpts.options.showHeader === undefined) {
            previewOpts.options.showHeader = true;
        }
        if (previewOpts.options.showFileList === undefined) {
            previewOpts.options.showFileList = true;
        }
        if (previewOpts.options.showComments === undefined) {
            previewOpts.options.showComments = false;
        }
        if (previewOpts.options.modeless === undefined) {
            previewOpts.options.modeless = false;
        }
        // 支持修订模式
        // 文件扩展名
        /** @type {?} */
        var extendName = fileInfo.name.substr(fileInfo.name.lastIndexOf('.') + 1).toLowerCase();
        /** @type {?} */
        var enablePreviews = ['doc', 'docx', 'xls', 'xlsx', 'ppt', 'pptx', 'jpg', 'jpeg', 'png', 'gif', 'bmp', 'pdf', 'txt', 'wps', 'wpt', 'et', 'dps'];
        if (enablePreviews.includes(extendName)) {
            this.previewSer.previewFile(fileInfo, previewOpts);
        }
        else {
            /** @type {?} */
            var msg = this.previewSer.getLocalStr("previewAdapt.notSupport");
            if (this.previewSer.notifySer) {
                this.previewSer.notifySer.warning(msg);
            }
            else {
                alert(msg);
            }
        }
    };
    /**
     * 捕获下载事件
     * @param fileInfo
     */
    /**
     * 捕获下载事件
     * @param {?} downloadEv
     * @return {?}
     */
    FFilePreviewAdaptUnifileDirective.prototype.fileDownloadEventHandler = /**
     * 捕获下载事件
     * @param {?} downloadEv
     * @return {?}
     */
    function (downloadEv) {
        // 如果是批量下载, downloadEv={fileInfos:[],name:}
        if (downloadEv && downloadEv['fileInfos'].length > 0) {
            if (downloadEv['fileInfos'].length > 1) {
                this.previewSer.multiDownloadFilesWidthName(downloadEv['fileInfos'], downloadEv['name'], this.extendServerConfig);
            }
            else {
                this.previewSer.downloadFile(downloadEv['fileInfos'][0], this.extendServerConfig);
            }
        }
    };
    Object.defineProperty(FFilePreviewAdaptUnifileDirective.prototype, "extendServerConfig", {
        get: /**
         * @return {?}
         */
        function () {
            return this._extendServeConfig;
        },
        set: /**
         * @param {?} value
         * @return {?}
         */
        function (value) {
            this._extendServeConfig = value;
            this.previewSer.setPreviwExtendServerConfig(value);
        },
        enumerable: true,
        configurable: true
    });
    FFilePreviewAdaptUnifileDirective.decorators = [
        { type: Directive, args: [{
                    selector: '[fFilePreviewAdaptUnifile]',
                    providers: [FfilepreviewAdaptUnifileService]
                },] }
    ];
    /** @nocollapse */
    FFilePreviewAdaptUnifileDirective.ctorParameters = function () { return [
        { type: FfilepreviewAdaptUnifileService }
    ]; };
    FFilePreviewAdaptUnifileDirective.propDecorators = {
        filePreviewEventHandler: [{ type: HostListener, args: ['filePreviewEvent', ['$event'],] }],
        fileDownloadEventHandler: [{ type: HostListener, args: ['fileDownloadEvent', ['$event'],] }],
        extendServerConfig: [{ type: Input }]
    };
    return FFilePreviewAdaptUnifileDirective;
}());
export { FFilePreviewAdaptUnifileDirective };
if (false) {
    /**
     * 处理扩展的服务器端配置
     * @type {?}
     * @private
     */
    FFilePreviewAdaptUnifileDirective.prototype._extendServeConfig;
    /**
     * @type {?}
     * @private
     */
    FFilePreviewAdaptUnifileDirective.prototype.previewSer;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZmZpbGVwcmV2aWV3LWFkYXB0LXVuaWZpbGUuZGlyZWN0aXZlLmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGZhcnJpcy9leHRlbmQtZmlsZXVwbG9hZC1hZGFwdC11bmlmaWxlLyIsInNvdXJjZXMiOlsibGliL2ZmaWxlcHJldmlldy1hZGFwdC11bmlmaWxlLmRpcmVjdGl2ZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7OztBQUFBLE9BQU8sRUFBRSxTQUFTLEVBQUUsWUFBWSxFQUFFLEtBQUssRUFBWSxNQUFNLGVBQWUsQ0FBQztBQUN6RSxPQUFPLEVBQUUsK0JBQStCLEVBQUUsTUFBTSxzQ0FBc0MsQ0FBQztBQUV2RjtJQXlFSSwyQ0FBb0IsVUFBMkM7UUFBM0MsZUFBVSxHQUFWLFVBQVUsQ0FBaUM7Ozs7UUFUdkQsdUJBQWtCLEdBQUMsSUFBSSxDQUFDO0lBV2hDLENBQUM7SUF0RUQ7OztPQUdHOzs7Ozs7SUFFSCxtRUFBdUI7Ozs7O0lBRHZCLFVBQ3dCLFFBQVE7OztZQUV0QixXQUFXLEdBQUcsTUFBTSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsa0JBQWtCLElBQUksRUFBRSxDQUFDO1FBQ2hFLFdBQVcsQ0FBQyxPQUFPLEdBQUcsTUFBTSxDQUFDLE1BQU0sQ0FBQyxXQUFXLENBQUMsT0FBTyxJQUFJLEVBQUUsRUFBRSxFQUFDLFlBQVksRUFBRSxDQUFDLENBQUMsUUFBUSxDQUFDLFlBQVksRUFBQyxFQUFDLEVBQUMsWUFBWSxFQUFDLENBQUMsQ0FBQyxRQUFRLENBQUMsWUFBWSxFQUFDLEVBQUMsRUFBQyxRQUFRLEVBQUMsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxRQUFRLEVBQUMsQ0FBQyxDQUFDO1FBRTlLLElBQUksV0FBVyxDQUFDLE9BQU8sQ0FBQyxVQUFVLEtBQUssU0FBUyxFQUFFO1lBQzlDLFdBQVcsQ0FBQyxPQUFPLENBQUMsVUFBVSxHQUFHLElBQUksQ0FBQztTQUN6QztRQUVELElBQUksV0FBVyxDQUFDLE9BQU8sQ0FBQyxZQUFZLEtBQUssU0FBUyxFQUFFO1lBQ2hELFdBQVcsQ0FBQyxPQUFPLENBQUMsWUFBWSxHQUFHLElBQUksQ0FBQztTQUMzQztRQUNELElBQUksV0FBVyxDQUFDLE9BQU8sQ0FBQyxZQUFZLEtBQUssU0FBUyxFQUFFO1lBQ2hELFdBQVcsQ0FBQyxPQUFPLENBQUMsWUFBWSxHQUFHLEtBQUssQ0FBQztTQUM1QztRQUNELElBQUksV0FBVyxDQUFDLE9BQU8sQ0FBQyxRQUFRLEtBQUssU0FBUyxFQUFFO1lBQzVDLFdBQVcsQ0FBQyxPQUFPLENBQUMsUUFBUSxHQUFHLEtBQUssQ0FBQztTQUN4Qzs7OztZQUlLLFVBQVUsR0FBRyxRQUFRLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxXQUFXLEVBQUU7O1lBQ25GLGNBQWMsR0FBRyxDQUFFLEtBQUssRUFBQyxNQUFNLEVBQUMsS0FBSyxFQUFDLE1BQU0sRUFBQyxLQUFLLEVBQUMsTUFBTSxFQUFDLEtBQUssRUFBQyxNQUFNLEVBQUMsS0FBSyxFQUFFLEtBQUssRUFBRSxLQUFLLEVBQUUsS0FBSyxFQUFFLEtBQUssRUFBRSxLQUFLLEVBQUUsS0FBSyxFQUFFLElBQUksRUFBQyxLQUFLLENBQUM7UUFFekksSUFBSSxjQUFjLENBQUMsUUFBUSxDQUFDLFVBQVUsQ0FBQyxFQUFFO1lBQ3JDLElBQUksQ0FBQyxVQUFVLENBQUMsV0FBVyxDQUFDLFFBQVEsRUFBRSxXQUFXLENBQUMsQ0FBQztTQUN0RDthQUFNOztnQkFDRyxHQUFHLEdBQUcsSUFBSSxDQUFDLFVBQVUsQ0FBQyxXQUFXLENBQUMseUJBQXlCLENBQUM7WUFDbEUsSUFBSSxJQUFJLENBQUMsVUFBVSxDQUFDLFNBQVMsRUFBRTtnQkFDM0IsSUFBSSxDQUFDLFVBQVUsQ0FBQyxTQUFTLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxDQUFDO2FBQzFDO2lCQUFNO2dCQUNILEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQzthQUNkO1NBQ0o7SUFDTCxDQUFDO0lBQ0Q7OztPQUdHOzs7Ozs7SUFFSCxvRUFBd0I7Ozs7O0lBRHhCLFVBQ3lCLFVBQVU7UUFDL0IsMkNBQTJDO1FBQzNDLElBQUksVUFBVSxJQUFFLFVBQVUsQ0FBQyxXQUFXLENBQUMsQ0FBQyxNQUFNLEdBQUcsQ0FBQyxFQUFFO1lBQ2hELElBQUksVUFBVSxDQUFDLFdBQVcsQ0FBQyxDQUFDLE1BQU0sR0FBRyxDQUFDLEVBQUU7Z0JBQ3BDLElBQUksQ0FBQyxVQUFVLENBQUMsMkJBQTJCLENBQUMsVUFBVSxDQUFDLFdBQVcsQ0FBQyxFQUFDLFVBQVUsQ0FBQyxNQUFNLENBQUMsRUFBRSxJQUFJLENBQUMsa0JBQWtCLENBQUMsQ0FBQzthQUNwSDtpQkFBSTtnQkFDRCxJQUFJLENBQUMsVUFBVSxDQUFDLFlBQVksQ0FBQyxVQUFVLENBQUMsV0FBVyxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsSUFBSSxDQUFDLGtCQUFrQixDQUFDLENBQUM7YUFDckY7U0FDSjtJQUNMLENBQUM7SUFNRCxzQkFDSSxpRUFBa0I7Ozs7UUFJdEI7WUFDSSxPQUFPLElBQUksQ0FBQyxrQkFBa0IsQ0FBQztRQUNuQyxDQUFDOzs7OztRQVBELFVBQ3VCLEtBQUs7WUFDeEIsSUFBSSxDQUFDLGtCQUFrQixHQUFDLEtBQUssQ0FBQztZQUM5QixJQUFJLENBQUMsVUFBVSxDQUFDLDJCQUEyQixDQUFDLEtBQUssQ0FBQyxDQUFDO1FBQ3ZELENBQUM7OztPQUFBOztnQkFyRUosU0FBUyxTQUFDO29CQUNQLFFBQVEsRUFBRSw0QkFBNEI7b0JBQ3RDLFNBQVMsRUFBQyxDQUFDLCtCQUErQixDQUFDO2lCQUM5Qzs7OztnQkFMUSwrQkFBK0I7OzswQ0FXbkMsWUFBWSxTQUFDLGtCQUFrQixFQUFFLENBQUMsUUFBUSxDQUFDOzJDQXdDM0MsWUFBWSxTQUFDLG1CQUFtQixFQUFFLENBQUMsUUFBUSxDQUFDO3FDQWdCNUMsS0FBSzs7SUFZVix3Q0FBQztDQUFBLEFBN0VELElBNkVDO1NBekVZLGlDQUFpQzs7Ozs7OztJQTREMUMsK0RBQWdDOzs7OztJQVNwQix1REFBbUQiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBEaXJlY3RpdmUsIEhvc3RMaXN0ZW5lciwgSW5wdXQsIE9wdGlvbmFsIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IEZmaWxlcHJldmlld0FkYXB0VW5pZmlsZVNlcnZpY2UgfSBmcm9tICcuL2ZmaWxlcHJldmlldy1hZGFwdC11bmlmaWxlLnNlcnZpY2UnO1xyXG5cclxuQERpcmVjdGl2ZSh7XHJcbiAgICBzZWxlY3RvcjogJ1tmRmlsZVByZXZpZXdBZGFwdFVuaWZpbGVdJyxcclxuICAgIHByb3ZpZGVyczpbRmZpbGVwcmV2aWV3QWRhcHRVbmlmaWxlU2VydmljZV1cclxufSlcclxuZXhwb3J0IGNsYXNzIEZGaWxlUHJldmlld0FkYXB0VW5pZmlsZURpcmVjdGl2ZSB7XHJcbiAgICAvKipcclxuICAgICAqIOaNleiOt+mihOiniOS6i+S7tlxyXG4gICAgICogQHBhcmFtIGZpbGVJbmZvIFxyXG4gICAgICovXHJcbiAgICBASG9zdExpc3RlbmVyKCdmaWxlUHJldmlld0V2ZW50JywgWyckZXZlbnQnXSlcclxuICAgIGZpbGVQcmV2aWV3RXZlbnRIYW5kbGVyKGZpbGVJbmZvKSB7XHJcbiAgICAgICAgLy8g5Y+v5Lul6YCa6L+H5bGe5oCnIGV4dGVuZFNlcnZlckNvbmZpZ+iuvue9ru+8jOS5n+WPr+S7pemAmui/h+S4gOS9k+WMlue7hOS7tueahElucHV05bGe5oCn6YWN572uXHJcbiAgICAgICAgY29uc3QgcHJldmlld09wdHMgPSBPYmplY3QuYXNzaWduKHRoaXMuZXh0ZW5kU2VydmVyQ29uZmlnIHx8IHt9KTtcclxuICAgICAgICBwcmV2aWV3T3B0cy5vcHRpb25zID0gT2JqZWN0LmFzc2lnbihwcmV2aWV3T3B0cy5vcHRpb25zIHx8IHt9LCB7c2hvd0Rvd25sb2FkOiAhIWZpbGVJbmZvLnNob3dEb3dubG9hZH0se3Nob3dDb21tZW50czohIWZpbGVJbmZvLnNob3dDb21tZW50c30se21vZGVsZXNzOiEhZmlsZUluZm8ubW9kZWxlc3N9KTtcclxuICAgICAgICBcclxuICAgICAgICBpZiAocHJldmlld09wdHMub3B0aW9ucy5zaG93SGVhZGVyID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgcHJldmlld09wdHMub3B0aW9ucy5zaG93SGVhZGVyID0gdHJ1ZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChwcmV2aWV3T3B0cy5vcHRpb25zLnNob3dGaWxlTGlzdCA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIHByZXZpZXdPcHRzLm9wdGlvbnMuc2hvd0ZpbGVMaXN0ID0gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHByZXZpZXdPcHRzLm9wdGlvbnMuc2hvd0NvbW1lbnRzID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgcHJldmlld09wdHMub3B0aW9ucy5zaG93Q29tbWVudHMgPSBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHByZXZpZXdPcHRzLm9wdGlvbnMubW9kZWxlc3MgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICBwcmV2aWV3T3B0cy5vcHRpb25zLm1vZGVsZXNzID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIOaUr+aMgeS/ruiuouaooeW8j1xyXG5cclxuICAgICAgICAvLyDmlofku7bmianlsZXlkI1cclxuICAgICAgICBjb25zdCBleHRlbmROYW1lID0gZmlsZUluZm8ubmFtZS5zdWJzdHIoZmlsZUluZm8ubmFtZS5sYXN0SW5kZXhPZignLicpICsgMSkudG9Mb3dlckNhc2UoKTtcclxuICAgICAgICBjb25zdCBlbmFibGVQcmV2aWV3cyA9IFsgJ2RvYycsJ2RvY3gnLCd4bHMnLCd4bHN4JywncHB0JywncHB0eCcsJ2pwZycsJ2pwZWcnLCdwbmcnLCAnZ2lmJywgJ2JtcCcsICdwZGYnLCAndHh0JywgJ3dwcycsICd3cHQnLCAnZXQnLCdkcHMnXTtcclxuXHJcbiAgICAgICAgaWYgKGVuYWJsZVByZXZpZXdzLmluY2x1ZGVzKGV4dGVuZE5hbWUpKSB7XHJcbiAgICAgICAgICAgIHRoaXMucHJldmlld1Nlci5wcmV2aWV3RmlsZShmaWxlSW5mbywgcHJldmlld09wdHMpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGNvbnN0IG1zZyA9IHRoaXMucHJldmlld1Nlci5nZXRMb2NhbFN0cihcInByZXZpZXdBZGFwdC5ub3RTdXBwb3J0XCIpO1xyXG4gICAgICAgICAgICBpZiAodGhpcy5wcmV2aWV3U2VyLm5vdGlmeVNlcikge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5wcmV2aWV3U2VyLm5vdGlmeVNlci53YXJuaW5nKG1zZyk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBhbGVydChtc2cpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiDmjZXojrfkuIvovb3kuovku7ZcclxuICAgICAqIEBwYXJhbSBmaWxlSW5mbyBcclxuICAgICAqL1xyXG4gICAgQEhvc3RMaXN0ZW5lcignZmlsZURvd25sb2FkRXZlbnQnLCBbJyRldmVudCddKVxyXG4gICAgZmlsZURvd25sb2FkRXZlbnRIYW5kbGVyKGRvd25sb2FkRXYpIHtcclxuICAgICAgICAvLyDlpoLmnpzmmK/mibnph4/kuIvovb0sIGRvd25sb2FkRXY9e2ZpbGVJbmZvczpbXSxuYW1lOn1cclxuICAgICAgICBpZiAoZG93bmxvYWRFdiYmZG93bmxvYWRFdlsnZmlsZUluZm9zJ10ubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICBpZiAoZG93bmxvYWRFdlsnZmlsZUluZm9zJ10ubGVuZ3RoID4gMSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5wcmV2aWV3U2VyLm11bHRpRG93bmxvYWRGaWxlc1dpZHRoTmFtZShkb3dubG9hZEV2WydmaWxlSW5mb3MnXSxkb3dubG9hZEV2WyduYW1lJ10sIHRoaXMuZXh0ZW5kU2VydmVyQ29uZmlnKTtcclxuICAgICAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnByZXZpZXdTZXIuZG93bmxvYWRGaWxlKGRvd25sb2FkRXZbJ2ZpbGVJbmZvcyddWzBdLCB0aGlzLmV4dGVuZFNlcnZlckNvbmZpZyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9ICAgICAgICBcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOWkhOeQhuaJqeWxleeahOacjeWKoeWZqOerr+mFjee9rlxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIF9leHRlbmRTZXJ2ZUNvbmZpZz1udWxsO1xyXG4gICAgQElucHV0KCkgXHJcbiAgICBzZXQgZXh0ZW5kU2VydmVyQ29uZmlnKHZhbHVlKXtcclxuICAgICAgICB0aGlzLl9leHRlbmRTZXJ2ZUNvbmZpZz12YWx1ZTtcclxuICAgICAgICB0aGlzLnByZXZpZXdTZXIuc2V0UHJldml3RXh0ZW5kU2VydmVyQ29uZmlnKHZhbHVlKTtcclxuICAgIH0gXHJcbiAgICBnZXQgZXh0ZW5kU2VydmVyQ29uZmlnKCl7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2V4dGVuZFNlcnZlQ29uZmlnO1xyXG4gICAgfVxyXG4gICAgY29uc3RydWN0b3IocHJpdmF0ZSBwcmV2aWV3U2VyOiBGZmlsZXByZXZpZXdBZGFwdFVuaWZpbGVTZXJ2aWNlICkge1xyXG4gICAgICAgIFxyXG4gICAgfVxyXG5cclxufVxyXG4iXX0=