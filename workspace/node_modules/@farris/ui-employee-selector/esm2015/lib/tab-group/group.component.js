/**
 * @fileoverview added by tsickle
 * Generated from: lib/tab-group/group.component.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, EventEmitter, Inject, Input, Optional, Output, ViewChild } from '@angular/core';
import * as _ from 'lodash-es';
import { noDataImg } from '../../assets/resource';
import { GROUP_SERVICE } from '../../utils/app.token';
import { FavoritesTool } from '../../utils/favorites.tool';
import { OrgPersonnelComponent } from '../tab-org-personnel/op.component';
import { DataLoadingService } from '../../utils/loading-service';
export class GroupComponent {
    /**
     * @param {?} groupService
     * @param {?} favoritesTool
     */
    constructor(groupService, favoritesTool) {
        this.groupService = groupService;
        this.favoritesTool = favoritesTool;
        this.idField = 'userId';
        this.orgId = '';
        this.userIds = '';
        this.pageSize = 10;
        this.treeListData = [];
        this.selectionsChange = new EventEmitter();
        this.groupChange = new EventEmitter();
        this.groupIdField = 'id';
        this.userIdField = 'userId';
        this.selections = [];
        this.cloneUserIds = '';
        this.cloneSelections = [];
        this.noDataImg = noDataImg;
        this.allChecked = false;
        this.items = [];
        this.favoritesList = [];
        this.groupData = { public: [], personal: [] };
        this.personnelList = [];
        this.groupPersonnels = [];
        this.publicVisible = true;
        this.personalVisible = true;
        this.publicToken = 'public';
        this.personalToken = 'personal';
        this.showGroupPersonnelDialog = false;
        this.currentGroupType = 'public';
        // 是否显示用户编号
        this.showUserCode = true;
        this.allIndexId = Math.random().toString(16).substring(3, 10);
    }
    /**
     * @return {?}
     */
    ngOnInit() {
        // 兼容老表单
        if (this.favoritesTool) {
            this.favoritesTool.favoritesSubject.subscribe((/**
             * @param {?} data
             * @return {?}
             */
            data => {
                this.favoritesList = data;
                if (this.enableFavorites && !!this.selectedGroupId) {
                    this.getPersonnelsByGroup({ id: this.selectedGroupId }, this.currentGroupType);
                }
            }));
        }
    }
    /**
     * @return {?}
     */
    ngAfterViewInit() {
    }
    /**
     * @param {?} e
     * @param {?} item
     * @return {?}
     */
    editGroup(e, item) {
        this.groupChange.next(item);
        e.stopPropagation();
        e.cancelBubble = true;
    }
    //群组触发事件类型 1：add 2：delete 3：update(title和description) 4：update(追加群组成员)
    /**
     * @param {?} e
     * @param {?} item
     * @return {?}
     */
    deleteGroup(e, item) {
        /** @type {?} */
        const helpExtend = window && ((/** @type {?} */ (window))).helpExtend;
        if (item[this.groupIdField] === this.selectedGroupId) {
            this.selectedGroupId = null;
            this.currentGroupType = this.publicToken;
        }
        if (helpExtend) {
            helpExtend.curdGroupData({
                id: item[this.groupIdField],
                type: 2
            }).then((/**
             * @return {?}
             */
            () => {
                this.items = [];
                this.getGroupList();
            }));
        }
        else {
            throw new Error(this.groupExtendInfo);
        }
        e.stopPropagation();
        e.cancelBubble = true;
    }
    /**
     * 添加群组成员
     * @return {?}
     */
    appendGroupPersonnel() {
        /** @type {?} */
        const helpExtend = window && ((/** @type {?} */ (window))).helpExtend;
        /** @type {?} */
        const userIds = [];
        this.groupPersonnelComponent.selections.forEach((/**
         * @param {?} selection
         * @return {?}
         */
        selection => {
            userIds.push(selection[this.idField]);
        }));
        if (helpExtend) {
            helpExtend.curdGroupData({
                id: this.selectedGroupId,
                userIds,
                type: 4
            }).then((/**
             * @return {?}
             */
            () => {
                this.toggleGroupPersonnelDialog(false);
                this.getPersonnelsByGroup({ id: this.selectedGroupId }, this.currentGroupType);
            }));
        }
        else {
            throw new Error(this.groupExtendInfo);
        }
    }
    /**
     * @param {?} show
     * @param {?=} groupType
     * @return {?}
     */
    toggleGroupPersonnelDialog(show, groupType = this.personalToken) {
        if (groupType === this.personalToken) {
            this.showGroupPersonnelDialog = show;
        }
    }
    // 设置我的群组
    // setMyGroup() {
    //     const options = {
    //         // 打开菜单，funcId需要指定，appId、appEntrance可以为空
    //         funcId: '2cea1078-eefb-b716-37b5-480afcbede03',
    //         tabId: '个人群组',
    //         appId: '',
    //         appEntrance: '',
    //         // 指定当前打开的是菜单
    //         appType: 'menu'
    //     };
    //     (window as any).gspframeworkService.rtf.func.openMenu(options);
    // }
    /**
     * @return {?}
     */
    assembleData() {
        if (this.searchPage) {
            this.searchByCodeOrName();
        }
        else {
            this.getGroupList();
        }
    }
    /**
     * @param {?} item
     * @param {?=} groupType
     * @return {?}
     */
    getPersonnelsByGroup(item, groupType = this.publicToken) {
        if (this.dataLoadingService) {
            this.dataLoadingService.show(this.loadingServiceMessage);
        }
        this.currentGroupType = groupType;
        this.allChecked = false;
        this.selectedGroupId = item[this.groupIdField];
        /** @type {?} */
        const helpExtend = window && ((/** @type {?} */ (window))).helpExtend;
        if (helpExtend) {
            helpExtend.getDataByGroupId(item[this.groupIdField], this.absOrgType).then((/**
             * @param {?} data
             * @return {?}
             */
            data => {
                /** @type {?} */
                const res = data && data.items;
                this.items = res;
                this.groupData.personal.forEach((/**
                 * @param {?} item
                 * @return {?}
                 */
                item => {
                    if (item[this.groupIdField] === this.selectedGroupId && item.total !== this.items.length) {
                        item.total = this.items.length;
                    }
                }));
                this.items.forEach((/**
                 * @param {?} it
                 * @return {?}
                 */
                it => {
                    if (this._isInArray(it[this.idField], this.idField, this.favoritesList) !== -1) {
                        it.inFavorites = true;
                    }
                    else {
                        it.inFavorites = false;
                    }
                    it.indexId = Math.random().toString(16).substring(2);
                    it.displayName = !!this.showUserCode ? ('[' + it.code + ']' + it.name) : it.name;
                }));
                this.toggleChecked();
                if (this.dataLoadingService) {
                    this.dataLoadingService.hide();
                }
            }));
        }
        else {
            throw new Error(this.groupExtendInfo);
        }
    }
    /**
     * @return {?}
     */
    getGroupList() {
        /** @type {?} */
        const helpExtend = window && ((/** @type {?} */ (window))).helpExtend;
        if (helpExtend) {
            helpExtend.getGroupData().then((/**
             * @param {?} data
             * @return {?}
             */
            data => {
                /** @type {?} */
                const resPublic = data && data.items[0] && data.items[0].data;
                /** @type {?} */
                const resPersonal = data && data.items[1] && data.items[1].data;
                this.groupData.public = resPublic ? resPublic : [];
                this.groupData.personal = resPersonal ? resPersonal : [];
                /** @type {?} */
                const firstPublicGroup = resPublic[0] && resPublic[0][this.groupIdField];
                /** @type {?} */
                const firstPersonalGroup = resPersonal[0] && resPersonal[0][this.groupIdField];
                this.selectedGroupId = this.selectedGroupId ? this.selectedGroupId : firstPublicGroup;
                this.selectedGroupId = this.selectedGroupId ? this.selectedGroupId : firstPersonalGroup;
                if (!!this.selectedGroupId) {
                    this.getPersonnelsByGroup({ id: this.selectedGroupId }, this.currentGroupType);
                    if (this.groupData.public.findIndex((/**
                     * @param {?} item
                     * @return {?}
                     */
                    item => item[this.groupIdField] === this.selectedGroupId)) !== -1) {
                        this.currentGroupType = this.publicToken;
                    }
                    else if (this.groupData.personal.findIndex((/**
                     * @param {?} item
                     * @return {?}
                     */
                    item => item[this.groupIdField] === this.selectedGroupId)) !== -1) {
                        this.currentGroupType = this.personalToken;
                    }
                }
            }));
        }
        else {
            throw new Error(this.groupExtendInfo);
        }
    }
    /**
     * @return {?}
     */
    searchByCodeOrName() {
        this.items = this.items.filter((/**
         * @param {?} item
         * @return {?}
         */
        item => {
            return item.code.indexOf(this.searchText) !== -1 || item.name.indexOf(this.searchText) !== -1;
        }));
    }
    /**
     * @param {?} e
     * @param {?} item
     * @return {?}
     */
    toggleFavorites(e, item) {
        this.favoritesTool.toggleFavorites(e, item);
    }
    /**
     * @param {?} e
     * @param {?} type
     * @return {?}
     */
    toggleVisible(e, type) {
        if (type === this.publicToken) {
            this.publicVisible = !this.publicVisible;
        }
        else if (type === this.personalToken) {
            this.personalVisible = !this.personalVisible;
        }
        e.stopPropagation();
        e.cancelBubble = true;
    }
    /**
     * @return {?}
     */
    restoreSelections() {
        this.selections = _.cloneDeep(this.cloneSelections);
        // this.emitSelections();
        this.toggleChecked();
        if (this.isAllChecked()) {
            this.allChecked = true;
        }
        else {
            this.allChecked = false;
        }
    }
    /**
     * @return {?}
     */
    toggleAll() {
        if (!this.allChecked) {
            this.checkAll();
        }
        else {
            this.unCheckAll();
        }
        this.emitSelections();
    }
    /**
     * @param {?} data
     * @return {?}
     */
    toggleOne(data) {
        if (data.checked) {
            this.unSelectLine(data);
        }
        else {
            this.selectLine(data);
        }
        this.emitSelections();
    }
    /**
     * datagrid用于数据展示
     * @return {?}
     */
    loadGroupList() {
        this.items = [];
        // this.unSelectedList.forEach(res => {
        //     const indexId = Math.random().toString(16).substring(3, 10);
        //     const item = {
        //         abbreviation: res.abbreviation,
        //         code: res.code,
        //         defaultOrgId: res.defaultOrgId,
        //         defaultOrgPath: res.defaultOrgPath,
        //         ext1: res.ext1,
        //         ext2: res.ext2,
        //         fullPathName: res.fullPathName,
        //         name: res.name,
        //         orgTypeId: res.orgTypeId,
        //         secLevel: res.secLevel,
        //         sortOrder: res.sortOrder,
        //         state: res.state,
        //         su: res.su,
        //         userId: res.userId,
        //         orgAllPath: res.orgAllPath,
        //         type: 'people',
        //         checked: false,
        //         inFavorites: false,
        //         indexId
        //     };
        //     if (this._isInArray(res[this.idField], this.idField, this.selections) !== -1) {
        //         item.checked = true;
        //     }
        //     if (this._isInArray(res[this.idField], this.idField, this.favoritesList) !== -1) {
        //         item.inFavorites = true;
        //     }
        //     this.items.push(item);
        //     this.itemsBackup.push(item);
        // });
        /** @type {?} */
        const tempSelections = _.cloneDeep(this.selections);
        this.toggleChecked();
        this.selections = _.cloneDeep(tempSelections);
    }
    /**
     * 全选后处理
     * @return {?}
     */
    checkAll() {
        this.items.forEach((/**
         * @param {?} item
         * @return {?}
         */
        item => {
            this._insertOneIntoSelections(item);
            item.checked = true;
        }));
    }
    /**
     * 全部取消
     * @return {?} void
     */
    unCheckAll() {
        this.items.forEach((/**
         * @param {?} item
         * @return {?}
         */
        item => {
            this.selections.forEach((/**
             * @param {?} selection
             * @param {?} index
             * @return {?}
             */
            (selection, index) => {
                if (item[this.idField] === selection[this.idField]) {
                    this.selections.splice(index, 1);
                }
            }));
            item.checked = false;
        }));
    }
    /**
     * 当前行选中
     * @param {?} data 当前行的数据（）
     * @return {?}
     */
    selectLine(data) {
        if (this.multiSelect) {
            this._insertOneIntoSelections(data);
        }
        else {
            this.userIds = '';
            this.selections = [];
            this.items.forEach((/**
             * @param {?} item
             * @return {?}
             */
            item => {
                if (item.checked) {
                    item.checked = false;
                }
            }));
            this._insertOneIntoSelections(data);
        }
        if (this.isAllChecked()) {
            this.allChecked = true;
        }
    }
    /**
     * 单选取消选中
     * @param {?} data 取消选中行
     * @return {?}
     */
    unSelectLine(data) {
        /** @type {?} */
        const index = this._isInArray(data[this.idField], this.idField, this.selections);
        if (index > -1) {
            this.selections.splice(index, 1);
        }
        if (this.allChecked) {
            this.allChecked = false;
        }
    }
    /**
     * @private
     * @return {?}
     */
    emitSelections() {
        /** @type {?} */
        const emitObj = {
            selections: this.selections,
            token: 'candidate'
        };
        this.selectionsChange.emit(emitObj);
    }
    /**
     *  取消选中
     * @param {?} $event 取消勾选的数据
     * @return {?}
     */
    cancelSelections($event) {
        if (this.items.findIndex((/**
         * @param {?} item
         * @return {?}
         */
        item => item[this.idField] === $event.id)) === -1) {
            return;
        }
        this.items.forEach((/**
         * @param {?} item
         * @return {?}
         */
        item => {
            if (item[this.idField] === $event.id) {
                item.checked = false;
            }
        }));
        this.selections.forEach((/**
         * @param {?} selection
         * @param {?} index
         * @return {?}
         */
        (selection, index) => {
            if ($event.id === selection[this.idField]) {
                this.selections.splice(index, 1);
            }
        }));
        this.allChecked = false;
    }
    /**
     * 全部取消勾选
     * @return {?}
     */
    clearCheckeds() {
        this.items.forEach((/**
         * @param {?} item
         * @return {?}
         */
        item => {
            item.checked = false;
        }));
        this.allChecked = false;
        this.selections = [];
    }
    /**
     * @return {?}
     */
    clearUserIds() {
        this.userIds = '';
    }
    /**
     * 选中并插入当前行数据到右侧
     * @param {?} data 当前行的数据
     * @return {?}
     */
    _insertOneIntoSelections(data) {
        // 如果当前数据已经移入右侧数据，则返回。
        if (this._isInArray(data[this.idField], this.idField, this.selections) > -1) {
            return;
        }
        this.selections.push(data);
        this.selections = this.selections.slice();
    }
    /**
     * 判断是否在内
     * @param {?} value value
     * @param {?} field field
     * @param {?} array array
     * @return {?} 位置索引
     */
    _isInArray(value, field, array) {
        if (!field || !value) {
            throw new Error(this.validElementsInfo);
        }
        return array.findIndex((/**
         * @param {?} item
         * @return {?}
         */
        item => value === item[field]));
    }
    /**
     * 翻页检查：人员展示区的勾选状态与已选人员区是否对应
     * @return {?}
     */
    toggleChecked() {
        this.items.forEach((/**
         * @param {?} item
         * @return {?}
         */
        item => {
            if (this._isInArray(item[this.idField], this.idField, this.selections) > -1) {
                item.checked = true;
            }
            else {
                item.checked = false;
            }
        }));
        if (this.isAllChecked()) {
            this.allChecked = true;
        }
        else {
            this.allChecked = false;
        }
    }
    /**
     * @private
     * @return {?}
     */
    isAllChecked() {
        /** @type {?} */
        let count = 0;
        /** @type {?} */
        let allChecked = false;
        this.items.forEach((/**
         * @param {?} item
         * @return {?}
         */
        item => {
            this.selections.forEach((/**
             * @param {?} selection
             * @return {?}
             */
            selection => {
                if (item[this.idField] === selection[this.idField]) {
                    count += 1;
                }
            }));
        }));
        if (this.items.length === count && count > 0) {
            allChecked = true;
        }
        return allChecked;
    }
    /**
     * @param {?} index
     * @param {?} item
     * @return {?}
     */
    trackByFn(index, item) {
        return index;
    }
}
GroupComponent.decorators = [
    { type: Component, args: [{
                selector: 'lib-group',
                template: "<div class=\"candidate flex-left\" style=\"position:relative; border-right: 1px solid #DEE1EA; overflow: hidden;\">\r\n    <perfect-scrollbar *ngIf=\"groupData.personal.length || groupData.public.length\">\r\n        <div class=\"h-100\">\r\n            <div class=\"group_blank_15\"></div>\r\n            <div class=\"group-top-tree\">\r\n                <span class=\"f-icon\" [class.f-icon-minus-outline]=\"publicVisible\"\r\n                    [class.f-icon-plus-outline]=\"!publicVisible\" (click)=\"toggleVisible($event, publicToken)\"></span>\r\n                    {{'personnelSelector.group.publicGroup' | locale}}\r\n            </div>\r\n            <ng-template [ngIf]=\"publicVisible\">\r\n                <div class=\"s-opCell-f\" [class.active]=\"selectedGroupId === item[groupIdField]\" title=\"\"\r\n                    *ngFor=\"let item of groupData.public\" (click)=\"getPersonnelsByGroup(item, publicToken)\">\r\n                    <div class=\"s-opCell-f-group\">\r\n                        <farris-avatar [avatarWidth]=\"32\" [avatarHeight]=\"32\" [cover]=\"item['avatar']\" [readonly]=\"true\"\r\n                            class=\"s-opCell-a\">\r\n                        </farris-avatar>\r\n                        <div class=\"s-opCell-d\">\r\n                            <p class=\"s-opCell-d1\">{{item.title}} {{item.total}}\u4EBA</p>\r\n                            <p class=\"s-opCell-d2\" title=\"{{item.description}}\">{{item.description}}</p>\r\n                        </div>\r\n                    </div>\r\n                    <!-- <span class=\"span-find-details\">\u67E5\u770B\u8BE6\u60C5</span> -->\r\n                </div>\r\n            </ng-template>\r\n            <div class=\"group_blank_15\"></div>\r\n            <div class=\"group-top-tree\">\r\n                <span class=\"f-icon\" [class.f-icon-minus-outline]=\"personalVisible\"\r\n                    [class.f-icon-plus-outline]=\"!personalVisible\"\r\n                    (click)=\"toggleVisible($event, personalToken)\"></span>\r\n                    {{'personnelSelector.group.privateGroup' | locale}}\r\n            </div>\r\n            <ng-template [ngIf]=\"personalVisible\">\r\n                <div class=\"s-opCell-f\" [class.active]=\"selectedGroupId === item[groupIdField]\"\r\n                    *ngFor=\"let item of groupData.personal\" (click)=\"getPersonnelsByGroup(item, personalToken)\">\r\n                    <div class=\"s-opCell-f-group\">\r\n                        <farris-avatar [avatarWidth]=\"32\" [avatarHeight]=\"32\" [cover]=\"item['avatar']\" [readonly]=\"true\"\r\n                            class=\"s-opCell-a\">\r\n                        </farris-avatar>\r\n                        <div class=\"s-opCell-d\">\r\n                            <p class=\"s-opCell-d1\">{{item.title}} {{item.total}} {{'personnelSelector.group.items' | locale}}</p>\r\n                            <p class=\"s-opCell-d2\" title=\"{{item.description}}\">{{item.description}}</p>\r\n                        </div>\r\n                    </div>\r\n                    <div class=\"s-opCell-edit\">\r\n                        <span class=\"f-icon f-icon-new-edit\" (click)=\"editGroup($event, item)\"></span>\r\n                        <span class=\"f-icon f-icon-minus-circle default-light-color\"\r\n                            (click)=\"deleteGroup($event, item)\"></span>\r\n                    </div>\r\n                    <!-- <span class=\"span-find-details\">\u67E5\u770B\u8BE6\u60C5</span> -->\r\n                </div>\r\n            </ng-template>\r\n        </div>\r\n    </perfect-scrollbar>\r\n    <!-- <div class=\"saved-group\" (click)=\"setMyGroup()\"><span class=\"f-icon f-icon-home-setup\"></span>\u8BBE\u7F6E\u6211\u7684\u7FA4\u7EC4\r\n    </div> -->\r\n    <div *ngIf=\"groupData.personal.length === 0 && groupData.public.length === 0\"\r\n        [ngStyle]=\"{'background-image': noDataImg}\" class=\"fp-candidate-nodata\">\r\n        {{'personnelSelector.tabCommon.noUserData' | locale}}</div>\r\n</div>\r\n<div class=\"candidate flex-right\">\r\n    <div class=\"candidate-title\" *ngIf=\"groupData?.public.length > 0 || groupData?.personal.length > 0\">\r\n        <div class=\"custom-control custom-checkbox mb-2\" *ngIf=\"multiSelect\">\r\n            <input class=\"custom-control-input\" [id]=\"allIndexId\" type=\"checkbox\" [(ngModel)]=\"allChecked\">\r\n            <label class=\"custom-control-label\" [for]=\"allIndexId\" (click)=\"toggleAll()\">{{'personnelSelector.tabCommon.checkAll' | locale}}</label>\r\n        </div>\r\n        <div *ngIf=\"!multiSelect\"></div>\r\n        <div (click)=\"toggleGroupPersonnelDialog(true, currentGroupType)\"\r\n            [ngStyle]=\"{'color': currentGroupType === publicToken ? '#d8d8d8' : '#2a87ff', 'cursor': currentGroupType === publicToken ? 'not-allowed' : 'pointer'}\">\r\n            <span class=\"f-icon f-icon-user\"></span>\r\n            {{'personnelSelector.group.appendMembers' | locale}}\r\n        </div>\r\n    </div>\r\n    <perfect-scrollbar *ngIf=\"items.length!==0\">\r\n        <div class=\"candidate-content\">\r\n            <div *ngFor=\"let data of items; let i = index;trackBy: trackByFn\" class=\"s-selectedPerson\">\r\n                <div class=\"custom-control custom-checkbox mb-2\">\r\n                    <input class=\"custom-control-input\" [(ngModel)]=\"data.checked\" [id]=\"data.indexId\" type=\"checkbox\">\r\n                    <label class=\"custom-control-label\" [for]=\"data.indexId\" (click)=\"toggleOne(data)\">\r\n                        <div style=\"display: flex; height: 32px; margin: -21px 0 0 24px;\">\r\n                            <farris-avatar [avatarWidth]=\"32\" [avatarHeight]=\"32\" [cover]=\"data.ext1\" [readonly]=\"true\">\r\n                            </farris-avatar>\r\n                            <div style=\"margin-left: 11px; margin-top: -2px;  padding-right: 10px; overflow: hidden;\">\r\n                                <p class=\"candidate-content-title\" title=\"{{data.displayName}}\">\r\n                                    {{data.displayName}}</p>\r\n                                <p class=\"candidate-content-orgpath\" title=\"{{data.orgAllPath}}\">\r\n                                    {{data.orgAllPath}}</p>\r\n                            </div>\r\n                        </div>\r\n                    </label>\r\n                </div>\r\n                <span class=\"f-icon f-icon-star\" *ngIf=\"enableFavorites\" [class.default-light-color]=\"data.inFavorites\"\r\n                    [class.default-dark-color]=\"!data.inFavorites\" (click)=\"toggleFavorites($event, data)\"></span>\r\n            </div>\r\n\r\n        </div>\r\n    </perfect-scrollbar>\r\n    <div *ngIf=\"items.length===0\" [ngStyle]=\"{'background-image': noDataImg}\" class=\"fp-candidate-nodata\">\r\n        {{'personnelSelector.tabCommon.noUserData' | locale}}</div>\r\n</div>\r\n\r\n<!--\u7FA4\u7EC4\u5F39\u7A97\u9009\u4EBA--->\r\n<div class=\"s-group-dialog-container\" *ngIf=\"showGroupPersonnelDialog\">\r\n    <div class=\"s-personnel-group-title\">\r\n        <span class=\"f-icon f-sidebar-close\" (click)=\"toggleGroupPersonnelDialog(false)\"></span>{{'personnelSelector.group.appendMembers' | locale}}\r\n    </div>\r\n    <lib-org-personnel #groupPersonnels style=\"margin-top: 15px;\" [multiSelect]=\"true\" [idField]=\"idField\"\r\n        [pageSize]=\"pageSize\" [userTypeMode]=\"userTypeMode\" [personnelOrderField]=\"personnelOrderField\"\r\n        [includeStopUser]=\"includeStopUser\" [orgId]=\"orgId\" [enablePagination]=\"enablePagination\"\r\n        [absUserOrgUrl]=\"absUserOrgUrl\" [absOrgType]=\"absOrgType\" [includeStopOrg]=\"includeStopOrg\"\r\n        [originalTreeData]=\"originalTreeData\" [filterId]=\"filterId\" [enableFavorites]=\"enableFavorites\"\r\n        [treeListData]=\"treeListData\" [orgIdField]=\"orgIdField\" [enableHierarchicalLoading]=\"enableHierarchicalLoading\"\r\n        [showUserCode]=\"showUserCode\" [withPermission]=\"withPermission\" [onlyCurrentOrg]=\"onlyCurrentOrg\">\r\n    </lib-org-personnel>\r\n    <div class=\"s-personnel-group-footer\">\r\n        <input type=\"button\" class=\"btn btn-primary fr\" style=\"width: 100px;\" value=\"{{'personnelSelector.selection.confirm' | locale}}\"\r\n            (click)=\"appendGroupPersonnel()\" />\r\n        <input type=\"button\" class=\"btn btn-secondary fr mr-3\" value=\"{{'personnelSelector.selection.cancel' | locale}}\" (click)=\"toggleGroupPersonnelDialog(false)\" />\r\n    </div>\r\n</div>\r\n<div class=\"s-help-bg\" *ngIf=\"showGroupPersonnelDialog\"></div>",
                styles: [":host{display:-webkit-box;display:flex;height:100%;-webkit-box-flex:1;flex:1;overflow:hidden;position:static}.candidate{display:-webkit-box;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-direction:column;overflow:hidden}.candidate.flex-left{-webkit-box-flex:0;flex:0 0 49%}.candidate.flex-right{-webkit-box-flex:0;flex:0 0 51%}.candidate .s-opCell-f{display:-webkit-box;display:flex;height:40px;border-radius:6px;padding-left:10px;-webkit-box-pack:justify;justify-content:space-between;margin:1px 5px 0;cursor:pointer}.candidate .s-opCell-f .s-opCell-f-group{display:-webkit-box;display:flex;-webkit-box-flex:1;flex:1}.candidate .s-opCell-f.active,.candidate .s-opCell-f:hover{background-color:#eef5ff}.candidate .s-opCell-f:hover .s-opCell-edit{visibility:visible}.candidate .s-opCell-a{margin-top:4px;margin-left:6px}.candidate .s-opCell-d{-webkit-box-flex:1;flex:1;overflow:hidden;margin:1.5px 10px 0}.candidate .s-opCell-d1{line-height:20px;font-size:13px;height:20px;color:#2d2f33;white-space:nowrap;text-overflow:ellipsis;overflow:hidden;margin:0;padding:0;max-width:210px}.candidate .s-opCell-d2{color:#a8adb8;font-size:12px;line-height:14px;height:14px;white-space:nowrap;text-overflow:ellipsis;overflow:hidden;margin:0;padding:0;max-width:210px}.candidate .s-opCell-f .f-avatar .f-avatar-image{display:block!important}.candidate .fp-candidate-nodata{width:100px;height:100px;text-align:center;background-repeat:no-repeat;background-size:contain;margin:80px auto 0;color:#b4bccc;padding-top:110px}.candidate .s-opCell-f:hover .span-find-details{display:block}.candidate .s-opCell-f .span-find-details{margin-right:5px;line-height:40px;color:#2a87ff;width:60px;display:none}.candidate .s-opCell-f .s-opCell-edit{line-height:40px;width:60px;text-align:center;visibility:hidden}.candidate .s-opCell-f .s-opCell-edit .f-icon-new-edit{margin-right:10px;color:#949aa6}.candidate .s-opCell-f .s-opCell-edit .f-icon-minus-circle{color:#f46160}.candidate .group-top-tree{margin:0 15px 10px;font-size:13px}.candidate .group_blank_15{width:100%;height:15px}.candidate .group-top-tree .f-icon{color:#d5d4d7;margin-right:8px}.candidate .group-top-tree .k-checkbox-label::after,.candidate .group-top-tree .k-checkbox-label::before{top:1px}.candidate .candidate-content{clear:both}.candidate .s-selectedPerson:first-child{margin-top:0}.candidate .s-selectedPerson{min-width:240px;float:left;width:calc(100% - 6px);position:relative;height:40px;padding:5px 12px;margin:0 3px 1px}.candidate .s-selectedPerson:hover{background:#eef5ff;border-radius:5px}.candidate .f-icon{font-size:14px}.candidate .s-selectedPerson .f-icon-star{position:absolute;top:13px;right:15px;font-size:14px}.candidate .s-selectedPerson .default-light-color{color:#f7b500}.candidate .s-selectedPerson .default-dark-color{color:#d8dce6}.candidate .k-checkbox-label::before{top:10px;font-size:16px;width:14px;height:14px}.candidate .k-checkbox-label::after{top:10px;font-size:16px;width:15px;height:14px}.candidate .candidate-content-title{margin:0;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;font-size:13px}.candidate .candidate-content-orgpath{margin:0;font-size:12px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;color:#c7ccd7}.candidate .candidate-title{display:-webkit-box;display:flex;-webkit-box-pack:justify;justify-content:space-between}.candidate .candidate-title .custom-control{margin:10px 0 0 15px;line-height:35px}.candidate .s-selectedPerson .custom-control-label::before{top:8px}.candidate .candidate-title .title-clearall{margin:5px 15px 0 0;color:#2a87ff;cursor:pointer;line-height:35px}.candidate .candidate-title div{line-height:35px;margin:9px 10px 0 0;color:#2a87ff;cursor:pointer}.candidate .saved-group{position:absolute;width:111px;height:26px;line-height:26px;background:#eaedf2;border-radius:5px;text-align:center;font-size:13px;bottom:10px;left:13px;z-index:999;color:#909ba2;cursor:pointer}.candidate .saved-group:hover{color:#2a87ff;background:#eaf4ff}.candidate .saved-group:hover .f-icon{color:#2a87ff}.candidate .saved-group .f-icon{color:#909ba2;margin-right:5px;cursor:pointer;font-size:14px}.s-group-dialog-container{height:520px;width:700px;position:fixed;left:50%;top:50%;margin:-260px 0 0 -350px;background:#fff;padding:15px 20px;border-radius:10px;display:-webkit-box;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-direction:column;z-index:9999}.s-group-dialog-container .s-personnel-group-footer{margin-top:15px}.s-help-bg{background:rgb(0 0 0 / 15%);position:fixed;left:0;top:0;right:0;bottom:0;z-index:9997}.s-group-dialog-container .s-personnel-group-title{font-size:17px;line-height:24px;color:#2d2f33;font-weight:600}.s-group-dialog-container .s-personnel-group-title .f-icon{float:right;font-size:20px;color:#878d99;margin-top:3px;cursor:pointer}.s-group-dialog-container .s-personnel-group-footer .fr{float:right;height:32px}"]
            }] }
];
/** @nocollapse */
GroupComponent.ctorParameters = () => [
    { type: undefined, decorators: [{ type: Optional }, { type: Inject, args: [GROUP_SERVICE,] }] },
    { type: FavoritesTool, decorators: [{ type: Optional }] }
];
GroupComponent.propDecorators = {
    groupPersonnelComponent: [{ type: ViewChild, args: ['groupPersonnels',] }],
    idField: [{ type: Input }],
    multiSelect: [{ type: Input }],
    absOrgType: [{ type: Input }],
    searchText: [{ type: Input }],
    orgId: [{ type: Input }],
    userIds: [{ type: Input }],
    includeStopUser: [{ type: Input }],
    searchPage: [{ type: Input }],
    includeCurrentUser: [{ type: Input }],
    busNum: [{ type: Input }],
    enableFavorites: [{ type: Input }],
    pageSize: [{ type: Input }],
    userTypeMode: [{ type: Input }],
    orderField: [{ type: Input }],
    enablePagination: [{ type: Input }],
    absUserOrgUrl: [{ type: Input }],
    treeListData: [{ type: Input }],
    orgIdField: [{ type: Input }],
    enableHierarchicalLoading: [{ type: Input }],
    includeStopOrg: [{ type: Input }],
    originalTreeData: [{ type: Input }],
    personnelOrderField: [{ type: Input }],
    filterId: [{ type: Input }],
    dataLoadingService: [{ type: Input }],
    validElementsInfo: [{ type: Input }],
    groupExtendInfo: [{ type: Input }],
    onlyCurrentOrg: [{ type: Input }],
    withPermission: [{ type: Input }],
    selectionsChange: [{ type: Output }],
    groupChange: [{ type: Output }]
};
if (false) {
    /** @type {?} */
    GroupComponent.prototype.groupPersonnelComponent;
    /** @type {?} */
    GroupComponent.prototype.idField;
    /** @type {?} */
    GroupComponent.prototype.multiSelect;
    /** @type {?} */
    GroupComponent.prototype.absOrgType;
    /** @type {?} */
    GroupComponent.prototype.searchText;
    /** @type {?} */
    GroupComponent.prototype.orgId;
    /** @type {?} */
    GroupComponent.prototype.userIds;
    /** @type {?} */
    GroupComponent.prototype.includeStopUser;
    /** @type {?} */
    GroupComponent.prototype.searchPage;
    /** @type {?} */
    GroupComponent.prototype.includeCurrentUser;
    /** @type {?} */
    GroupComponent.prototype.busNum;
    /** @type {?} */
    GroupComponent.prototype.enableFavorites;
    /** @type {?} */
    GroupComponent.prototype.pageSize;
    /** @type {?} */
    GroupComponent.prototype.userTypeMode;
    /** @type {?} */
    GroupComponent.prototype.orderField;
    /** @type {?} */
    GroupComponent.prototype.enablePagination;
    /** @type {?} */
    GroupComponent.prototype.absUserOrgUrl;
    /** @type {?} */
    GroupComponent.prototype.treeListData;
    /** @type {?} */
    GroupComponent.prototype.orgIdField;
    /** @type {?} */
    GroupComponent.prototype.enableHierarchicalLoading;
    /** @type {?} */
    GroupComponent.prototype.includeStopOrg;
    /** @type {?} */
    GroupComponent.prototype.originalTreeData;
    /** @type {?} */
    GroupComponent.prototype.personnelOrderField;
    /** @type {?} */
    GroupComponent.prototype.filterId;
    /** @type {?} */
    GroupComponent.prototype.dataLoadingService;
    /** @type {?} */
    GroupComponent.prototype.validElementsInfo;
    /** @type {?} */
    GroupComponent.prototype.groupExtendInfo;
    /** @type {?} */
    GroupComponent.prototype.onlyCurrentOrg;
    /** @type {?} */
    GroupComponent.prototype.withPermission;
    /** @type {?} */
    GroupComponent.prototype.selectionsChange;
    /** @type {?} */
    GroupComponent.prototype.groupChange;
    /** @type {?} */
    GroupComponent.prototype.groupIdField;
    /** @type {?} */
    GroupComponent.prototype.userIdField;
    /** @type {?} */
    GroupComponent.prototype.selections;
    /** @type {?} */
    GroupComponent.prototype.cloneUserIds;
    /** @type {?} */
    GroupComponent.prototype.cloneSelections;
    /** @type {?} */
    GroupComponent.prototype.noDataImg;
    /** @type {?} */
    GroupComponent.prototype.allChecked;
    /** @type {?} */
    GroupComponent.prototype.items;
    /** @type {?} */
    GroupComponent.prototype.favoritesList;
    /** @type {?} */
    GroupComponent.prototype.groupData;
    /** @type {?} */
    GroupComponent.prototype.personnelList;
    /** @type {?} */
    GroupComponent.prototype.groupPersonnels;
    /** @type {?} */
    GroupComponent.prototype.publicVisible;
    /** @type {?} */
    GroupComponent.prototype.personalVisible;
    /** @type {?} */
    GroupComponent.prototype.publicToken;
    /** @type {?} */
    GroupComponent.prototype.personalToken;
    /** @type {?} */
    GroupComponent.prototype.selectedGroupId;
    /** @type {?} */
    GroupComponent.prototype.allIndexId;
    /** @type {?} */
    GroupComponent.prototype.showGroupPersonnelDialog;
    /** @type {?} */
    GroupComponent.prototype.currentGroupType;
    /** @type {?} */
    GroupComponent.prototype.showUserCode;
    /** @type {?} */
    GroupComponent.prototype.loadingServiceMessage;
    /**
     * @type {?}
     * @private
     */
    GroupComponent.prototype.groupService;
    /**
     * @type {?}
     * @private
     */
    GroupComponent.prototype.favoritesTool;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZ3JvdXAuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGZhcnJpcy91aS1lbXBsb3llZS1zZWxlY3Rvci8iLCJzb3VyY2VzIjpbImxpYi90YWItZ3JvdXAvZ3JvdXAuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7O0FBQUEsT0FBTyxFQUFpQixTQUFTLEVBQUUsWUFBWSxFQUFFLE1BQU0sRUFBRSxLQUFLLEVBQVUsUUFBUSxFQUFFLE1BQU0sRUFBRSxTQUFTLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFDM0gsT0FBTyxLQUFLLENBQUMsTUFBTSxXQUFXLENBQUM7QUFDL0IsT0FBTyxFQUFFLFNBQVMsRUFBRSxNQUFNLHVCQUF1QixDQUFDO0FBQ2xELE9BQU8sRUFBRSxhQUFhLEVBQUUsTUFBTSx1QkFBdUIsQ0FBQztBQUN0RCxPQUFPLEVBQUUsYUFBYSxFQUFFLE1BQU0sNEJBQTRCLENBQUM7QUFFM0QsT0FBTyxFQUFFLHFCQUFxQixFQUFFLE1BQU0sbUNBQW1DLENBQUM7QUFDMUUsT0FBTyxFQUFFLGtCQUFrQixFQUFFLE1BQU0sNkJBQTZCLENBQUM7QUFZakUsTUFBTSxPQUFPLGNBQWM7Ozs7O0lBNER2QixZQUMrQyxZQUFZLEVBQ25DLGFBQTRCO1FBREwsaUJBQVksR0FBWixZQUFZLENBQUE7UUFDbkMsa0JBQWEsR0FBYixhQUFhLENBQWU7UUExRDNDLFlBQU8sR0FBRyxRQUFRLENBQUM7UUFJbkIsVUFBSyxHQUFHLEVBQUUsQ0FBQztRQUNYLFlBQU8sR0FBRyxFQUFFLENBQUM7UUFPYixhQUFRLEdBQUcsRUFBRSxDQUFDO1FBS2QsaUJBQVksR0FBRyxFQUFFLENBQUM7UUFZakIscUJBQWdCLEdBQUcsSUFBSSxZQUFZLEVBQU8sQ0FBQztRQUMzQyxnQkFBVyxHQUFHLElBQUksWUFBWSxFQUFPLENBQUM7UUFFaEQsaUJBQVksR0FBRyxJQUFJLENBQUM7UUFDcEIsZ0JBQVcsR0FBRyxRQUFRLENBQUM7UUFDdkIsZUFBVSxH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Iiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQWZ0ZXJWaWV3SW5pdCwgQ29tcG9uZW50LCBFdmVudEVtaXR0ZXIsIEluamVjdCwgSW5wdXQsIE9uSW5pdCwgT3B0aW9uYWwsIE91dHB1dCwgVmlld0NoaWxkIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCAqIGFzIF8gZnJvbSAnbG9kYXNoLWVzJztcclxuaW1wb3J0IHsgbm9EYXRhSW1nIH0gZnJvbSAnLi4vLi4vYXNzZXRzL3Jlc291cmNlJztcclxuaW1wb3J0IHsgR1JPVVBfU0VSVklDRSB9IGZyb20gJy4uLy4uL3V0aWxzL2FwcC50b2tlbic7XHJcbmltcG9ydCB7IEZhdm9yaXRlc1Rvb2wgfSBmcm9tICcuLi8uLi91dGlscy9mYXZvcml0ZXMudG9vbCc7XHJcbmltcG9ydCB7IEdyb3VwLCBHcm91cEl0ZW0gfSBmcm9tICcuLi8uLi91dGlscy9ncm91cC50b29sJztcclxuaW1wb3J0IHsgT3JnUGVyc29ubmVsQ29tcG9uZW50IH0gZnJvbSAnLi4vdGFiLW9yZy1wZXJzb25uZWwvb3AuY29tcG9uZW50JztcclxuaW1wb3J0IHsgRGF0YUxvYWRpbmdTZXJ2aWNlIH0gZnJvbSAnLi4vLi4vdXRpbHMvbG9hZGluZy1zZXJ2aWNlJztcclxuXHJcbmRlY2xhcmUgY29uc3QgbWV0aG9kOiBhbnk7XHJcbkBDb21wb25lbnQoe1xyXG4gICAgc2VsZWN0b3I6ICdsaWItZ3JvdXAnLFxyXG4gICAgdGVtcGxhdGVVcmw6ICcuL2dyb3VwLmNvbXBvbmVudC5odG1sJyxcclxuICAgIHN0eWxlVXJsczogWycuL2dyb3VwLmNvbXBvbmVudC5jc3MnXSxcclxuICAgIC8vIHByb3ZpZGVyczogW3tcclxuICAgIC8vICAgICBwcm92aWRlOiBHUk9VUF9TRVJWSUNFLFxyXG4gICAgLy8gICAgIHVzZUNsYXNzOiBHcm91cFRvb2xcclxuICAgIC8vIH1dXHJcbn0pXHJcbmV4cG9ydCBjbGFzcyBHcm91cENvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCwgQWZ0ZXJWaWV3SW5pdCB7XHJcblxyXG4gICAgQFZpZXdDaGlsZCgnZ3JvdXBQZXJzb25uZWxzJykgZ3JvdXBQZXJzb25uZWxDb21wb25lbnQ6IE9yZ1BlcnNvbm5lbENvbXBvbmVudDtcclxuXHJcbiAgICBASW5wdXQoKSBpZEZpZWxkID0gJ3VzZXJJZCc7XHJcbiAgICBASW5wdXQoKSBtdWx0aVNlbGVjdDogYW55O1xyXG4gICAgQElucHV0KCkgYWJzT3JnVHlwZTogc3RyaW5nO1xyXG4gICAgQElucHV0KCkgc2VhcmNoVGV4dDogYW55O1xyXG4gICAgQElucHV0KCkgb3JnSWQgPSAnJztcclxuICAgIEBJbnB1dCgpIHVzZXJJZHMgPSAnJztcclxuICAgIEBJbnB1dCgpIGluY2x1ZGVTdG9wVXNlcjogYm9vbGVhbjtcclxuICAgIEBJbnB1dCgpIHNlYXJjaFBhZ2U6IGJvb2xlYW47XHJcbiAgICBASW5wdXQoKSBpbmNsdWRlQ3VycmVudFVzZXI6IGJvb2xlYW47XHJcbiAgICBASW5wdXQoKSBidXNOdW06IHN0cmluZztcclxuICAgIEBJbnB1dCgpIGVuYWJsZUZhdm9yaXRlczogYm9vbGVhbjtcclxuXHJcbiAgICBASW5wdXQoKSBwYWdlU2l6ZSA9IDEwO1xyXG4gICAgQElucHV0KCkgdXNlclR5cGVNb2RlOiBzdHJpbmc7XHJcbiAgICBASW5wdXQoKSBvcmRlckZpZWxkOiBzdHJpbmc7XHJcbiAgICBASW5wdXQoKSBlbmFibGVQYWdpbmF0aW9uOiBib29sZWFuO1xyXG4gICAgQElucHV0KCkgYWJzVXNlck9yZ1VybDogc3RyaW5nO1xyXG4gICAgQElucHV0KCkgdHJlZUxpc3REYXRhID0gW107XHJcbiAgICBASW5wdXQoKSBvcmdJZEZpZWxkOiBzdHJpbmc7XHJcbiAgICBASW5wdXQoKSBlbmFibGVIaWVyYXJjaGljYWxMb2FkaW5nOiBib29sZWFuO1xyXG4gICAgQElucHV0KCkgaW5jbHVkZVN0b3BPcmc6IGJvb2xlYW47XHJcbiAgICBASW5wdXQoKSBvcmlnaW5hbFRyZWVEYXRhOiBhbnk7XHJcbiAgICBASW5wdXQoKSBwZXJzb25uZWxPcmRlckZpZWxkOiBzdHJpbmc7XHJcbiAgICBASW5wdXQoKSBmaWx0ZXJJZDogc3RyaW5nO1xyXG4gICAgQElucHV0KCkgZGF0YUxvYWRpbmdTZXJ2aWNlOiBEYXRhTG9hZGluZ1NlcnZpY2U7XHJcbiAgICBASW5wdXQoKSB2YWxpZEVsZW1lbnRzSW5mbzogc3RyaW5nO1xyXG4gICAgQElucHV0KCkgZ3JvdXBFeHRlbmRJbmZvOiBzdHJpbmc7XHJcbiAgICBASW5wdXQoKSBvbmx5Q3VycmVudE9yZzogYm9vbGVhbjtcclxuICAgIEBJbnB1dCgpIHdpdGhQZXJtaXNzaW9uOiBib29sZWFuO1xyXG4gICAgQE91dHB1dCgpIHNlbGVjdGlvbnNDaGFuZ2UgPSBuZXcgRXZlbnRFbWl0dGVyPGFueT4oKTtcclxuICAgIEBPdXRwdXQoKSBncm91cENoYW5nZSA9IG5ldyBFdmVudEVtaXR0ZXI8YW55PigpO1xyXG5cclxuICAgIGdyb3VwSWRGaWVsZCA9ICdpZCc7XHJcbiAgICB1c2VySWRGaWVsZCA9ICd1c2VySWQnO1xyXG4gICAgc2VsZWN0aW9uczogYW55W10gPSBbXTtcclxuICAgIGNsb25lVXNlcklkcyA9ICcnO1xyXG4gICAgY2xvbmVTZWxlY3Rpb25zID0gW107XHJcbiAgICBub0RhdGFJbWcgPSBub0RhdGFJbWc7XHJcbiAgICBhbGxDaGVja2VkID0gZmFsc2U7XHJcbiAgICBpdGVtcyA9IFtdO1xyXG4gICAgZmF2b3JpdGVzTGlzdCA9IFtdO1xyXG4gICAgZ3JvdXBEYXRhOiBHcm91cCA9IHsgcHVibGljOiBbXSwgcGVyc29uYWw6IFtdIH07XHJcbiAgICBwZXJzb25uZWxMaXN0ID0gW107XHJcbiAgICBncm91cFBlcnNvbm5lbHMgPSBbXTtcclxuICAgIHB1YmxpY1Zpc2libGUgPSB0cnVlO1xyXG4gICAgcGVyc29uYWxWaXNpYmxlID0gdHJ1ZTtcclxuICAgIHB1YmxpY1Rva2VuID0gJ3B1YmxpYyc7XHJcbiAgICBwZXJzb25hbFRva2VuID0gJ3BlcnNvbmFsJztcclxuICAgIHNlbGVjdGVkR3JvdXBJZDogc3RyaW5nO1xyXG4gICAgYWxsSW5kZXhJZDogc3RyaW5nO1xyXG4gICAgc2hvd0dyb3VwUGVyc29ubmVsRGlhbG9nID0gZmFsc2U7XHJcbiAgICBjdXJyZW50R3JvdXBUeXBlID0gJ3B1YmxpYyc7XHJcbiAgICAvLyDmmK/lkKbmmL7npLrnlKjmiLfnvJblj7dcclxuICAgIHNob3dVc2VyQ29kZSA9IHRydWU7XHJcbiAgICBsb2FkaW5nU2VydmljZU1lc3NhZ2U6IHN0cmluZztcclxuXHJcbiAgICBjb25zdHJ1Y3RvcihcclxuICAgICAgICBAT3B0aW9uYWwoKSBASW5qZWN0KEdST1VQX1NFUlZJQ0UpIHByaXZhdGUgZ3JvdXBTZXJ2aWNlLFxyXG4gICAgICAgIEBPcHRpb25hbCgpIHByaXZhdGUgZmF2b3JpdGVzVG9vbDogRmF2b3JpdGVzVG9vbFxyXG4gICAgKSB7XHJcbiAgICAgICAgdGhpcy5hbGxJbmRleElkID0gTWF0aC5yYW5kb20oKS50b1N0cmluZygxNikuc3Vic3RyaW5nKDMsIDEwKVxyXG4gICAgfVxyXG5cclxuICAgIG5nT25Jbml0KCk6IHZvaWQge1xyXG4gICAgICAgIC8vIOWFvOWuueiAgeihqOWNlVxyXG4gICAgICAgIGlmICh0aGlzLmZhdm9yaXRlc1Rvb2wpIHtcclxuICAgICAgICAgICAgdGhpcy5mYXZvcml0ZXNUb29sLmZhdm9yaXRlc1N1YmplY3Quc3Vic2NyaWJlKGRhdGEgPT4ge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5mYXZvcml0ZXNMaXN0ID0gZGF0YTtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmVuYWJsZUZhdm9yaXRlcyAmJiAhIXRoaXMuc2VsZWN0ZWRHcm91cElkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5nZXRQZXJzb25uZWxzQnlHcm91cCh7IGlkOiB0aGlzLnNlbGVjdGVkR3JvdXBJZCB9LCB0aGlzLmN1cnJlbnRHcm91cFR5cGUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgbmdBZnRlclZpZXdJbml0KCk6IHZvaWQge1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBlZGl0R3JvdXAoZTogTW91c2VFdmVudCwgaXRlbTogR3JvdXBJdGVtKSB7XHJcbiAgICAgICAgdGhpcy5ncm91cENoYW5nZS5uZXh0KGl0ZW0pO1xyXG4gICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgZS5jYW5jZWxCdWJibGUgPSB0cnVlO1xyXG4gICAgfVxyXG5cclxuICAgIC8v576k57uE6Kem5Y+R5LqL5Lu257G75Z6LIDHvvJphZGQgMu+8mmRlbGV0ZSAz77yadXBkYXRlKHRpdGxl5ZKMZGVzY3JpcHRpb24pIDTvvJp1cGRhdGUo6L+95Yqg576k57uE5oiQ5ZGYKVxyXG4gICAgZGVsZXRlR3JvdXAoZTogTW91c2VFdmVudCwgaXRlbTogR3JvdXBJdGVtKSB7XHJcbiAgICAgICAgY29uc3QgaGVscEV4dGVuZCA9IHdpbmRvdyAmJiAod2luZG93IGFzIGFueSkuaGVscEV4dGVuZDtcclxuICAgICAgICBpZiAoaXRlbVt0aGlzLmdyb3VwSWRGaWVsZF0gPT09IHRoaXMuc2VsZWN0ZWRHcm91cElkKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRHcm91cElkID0gbnVsbDtcclxuICAgICAgICAgICAgdGhpcy5jdXJyZW50R3JvdXBUeXBlID0gdGhpcy5wdWJsaWNUb2tlbjtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGhlbHBFeHRlbmQpIHtcclxuICAgICAgICAgICAgaGVscEV4dGVuZC5jdXJkR3JvdXBEYXRhKHtcclxuICAgICAgICAgICAgICAgIGlkOiBpdGVtW3RoaXMuZ3JvdXBJZEZpZWxkXSxcclxuICAgICAgICAgICAgICAgIHR5cGU6IDJcclxuICAgICAgICAgICAgfSkudGhlbigoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLml0ZW1zID0gW107XHJcbiAgICAgICAgICAgICAgICB0aGlzLmdldEdyb3VwTGlzdCgpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IodGhpcy5ncm91cEV4dGVuZEluZm8pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgIGUuY2FuY2VsQnViYmxlID0gdHJ1ZTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOa3u+WKoOe+pOe7hOaIkOWRmFxyXG4gICAgICovXHJcbiAgICBhcHBlbmRHcm91cFBlcnNvbm5lbCgpIHtcclxuICAgICAgICBjb25zdCBoZWxwRXh0ZW5kID0gd2luZG93ICYmICh3aW5kb3cgYXMgYW55KS5oZWxwRXh0ZW5kO1xyXG4gICAgICAgIGNvbnN0IHVzZXJJZHMgPSBbXTtcclxuICAgICAgICB0aGlzLmdyb3VwUGVyc29ubmVsQ29tcG9uZW50LnNlbGVjdGlvbnMuZm9yRWFjaChzZWxlY3Rpb24gPT4ge1xyXG4gICAgICAgICAgICB1c2VySWRzLnB1c2goc2VsZWN0aW9uW3RoaXMuaWRGaWVsZF0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGlmIChoZWxwRXh0ZW5kKSB7XHJcbiAgICAgICAgICAgIGhlbHBFeHRlbmQuY3VyZEdyb3VwRGF0YSh7XHJcbiAgICAgICAgICAgICAgICBpZDogdGhpcy5zZWxlY3RlZEdyb3VwSWQsXHJcbiAgICAgICAgICAgICAgICB1c2VySWRzLFxyXG4gICAgICAgICAgICAgICAgdHlwZTogNFxyXG4gICAgICAgICAgICB9KS50aGVuKCgpID0+IHtcclxuICAgICAgICAgICAgICAgIHRoaXMudG9nZ2xlR3JvdXBQZXJzb25uZWxEaWFsb2coZmFsc2UpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5nZXRQZXJzb25uZWxzQnlHcm91cCh7IGlkOiB0aGlzLnNlbGVjdGVkR3JvdXBJZCB9LCB0aGlzLmN1cnJlbnRHcm91cFR5cGUpO1xyXG5cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKHRoaXMuZ3JvdXBFeHRlbmRJbmZvKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgdG9nZ2xlR3JvdXBQZXJzb25uZWxEaWFsb2coc2hvdzogYm9vbGVhbiwgZ3JvdXBUeXBlID0gdGhpcy5wZXJzb25hbFRva2VuKSB7XHJcbiAgICAgICAgaWYgKGdyb3VwVHlwZSA9PT0gdGhpcy5wZXJzb25hbFRva2VuKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2hvd0dyb3VwUGVyc29ubmVsRGlhbG9nID0gc2hvdztcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy8g6K6+572u5oiR55qE576k57uEXHJcbiAgICAvLyBzZXRNeUdyb3VwKCkge1xyXG4gICAgLy8gICAgIGNvbnN0IG9wdGlvbnMgPSB7XHJcbiAgICAvLyAgICAgICAgIC8vIOaJk+W8gOiPnOWNle+8jGZ1bmNJZOmcgOimgeaMh+Wumu+8jGFwcElk44CBYXBwRW50cmFuY2Xlj6/ku6XkuLrnqbpcclxuICAgIC8vICAgICAgICAgZnVuY0lkOiAnMmNlYTEwNzgtZWVmYi1iNzE2LTM3YjUtNDgwYWZjYmVkZTAzJyxcclxuICAgIC8vICAgICAgICAgdGFiSWQ6ICfkuKrkurrnvqTnu4QnLFxyXG4gICAgLy8gICAgICAgICBhcHBJZDogJycsXHJcbiAgICAvLyAgICAgICAgIGFwcEVudHJhbmNlOiAnJyxcclxuICAgIC8vICAgICAgICAgLy8g5oyH5a6a5b2T5YmN5omT5byA55qE5piv6I+c5Y2VXHJcbiAgICAvLyAgICAgICAgIGFwcFR5cGU6ICdtZW51J1xyXG4gICAgLy8gICAgIH07XHJcbiAgICAvLyAgICAgKHdpbmRvdyBhcyBhbnkpLmdzcGZyYW1ld29ya1NlcnZpY2UucnRmLmZ1bmMub3Blbk1lbnUob3B0aW9ucyk7XHJcbiAgICAvLyB9XHJcblxyXG4gICAgYXNzZW1ibGVEYXRhKCkge1xyXG4gICAgICAgIGlmICh0aGlzLnNlYXJjaFBhZ2UpIHtcclxuICAgICAgICAgICAgdGhpcy5zZWFyY2hCeUNvZGVPck5hbWUoKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLmdldEdyb3VwTGlzdCgpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBnZXRQZXJzb25uZWxzQnlHcm91cChpdGVtOiBhbnksIGdyb3VwVHlwZSA9IHRoaXMucHVibGljVG9rZW4pIHtcclxuICAgICAgICBpZih0aGlzLmRhdGFMb2FkaW5nU2VydmljZSkge1xyXG4gICAgICAgICAgICB0aGlzLmRhdGFMb2FkaW5nU2VydmljZS5zaG93KHRoaXMubG9hZGluZ1NlcnZpY2VNZXNzYWdlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5jdXJyZW50R3JvdXBUeXBlID0gZ3JvdXBUeXBlO1xyXG4gICAgICAgIHRoaXMuYWxsQ2hlY2tlZCA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuc2VsZWN0ZWRHcm91cElkID0gaXRlbVt0aGlzLmdyb3VwSWRGaWVsZF07XHJcbiAgICAgICAgY29uc3QgaGVscEV4dGVuZCA9IHdpbmRvdyAmJiAod2luZG93IGFzIGFueSkuaGVscEV4dGVuZDtcclxuICAgICAgICBpZiAoaGVscEV4dGVuZCkge1xyXG4gICAgICAgICAgICBoZWxwRXh0ZW5kLmdldERhdGFCeUdyb3VwSWQoaXRlbVt0aGlzLmdyb3VwSWRGaWVsZF0sIHRoaXMuYWJzT3JnVHlwZSkudGhlbihkYXRhID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHJlcyA9IGRhdGEgJiYgZGF0YS5pdGVtcztcclxuICAgICAgICAgICAgICAgIHRoaXMuaXRlbXMgPSByZXM7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmdyb3VwRGF0YS5wZXJzb25hbC5mb3JFYWNoKGl0ZW0gPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChpdGVtW3RoaXMuZ3JvdXBJZEZpZWxkXSA9PT0gdGhpcy5zZWxlY3RlZEdyb3VwSWQgJiYgaXRlbS50b3RhbCAhPT0gdGhpcy5pdGVtcy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaXRlbS50b3RhbCA9IHRoaXMuaXRlbXMubGVuZ3RoO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5pdGVtcy5mb3JFYWNoKGl0ID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5faXNJbkFycmF5KGl0W3RoaXMuaWRGaWVsZF0sIHRoaXMuaWRGaWVsZCwgdGhpcy5mYXZvcml0ZXNMaXN0KSAhPT0gLTEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaXQuaW5GYXZvcml0ZXMgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGl0LmluRmF2b3JpdGVzID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGl0LmluZGV4SWQgPSBNYXRoLnJhbmRvbSgpLnRvU3RyaW5nKDE2KS5zdWJzdHJpbmcoMik7XHJcbiAgICAgICAgICAgICAgICAgICAgaXQuZGlzcGxheU5hbWUgPSAhIXRoaXMuc2hvd1VzZXJDb2RlID8gKCdbJyArIGl0LmNvZGUgKyAnXScgKyBpdC5uYW1lKSA6IGl0Lm5hbWU7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIHRoaXMudG9nZ2xlQ2hlY2tlZCgpO1xyXG4gICAgICAgICAgICAgICAgaWYodGhpcy5kYXRhTG9hZGluZ1NlcnZpY2UpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmRhdGFMb2FkaW5nU2VydmljZS5oaWRlKCk7ICAgIFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IodGhpcy5ncm91cEV4dGVuZEluZm8pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBnZXRHcm91cExpc3QoKSB7XHJcbiAgICAgICAgY29uc3QgaGVscEV4dGVuZCA9IHdpbmRvdyAmJiAod2luZG93IGFzIGFueSkuaGVscEV4dGVuZDtcclxuICAgICAgICBpZiAoaGVscEV4dGVuZCkge1xyXG4gICAgICAgICAgICBoZWxwRXh0ZW5kLmdldEdyb3VwRGF0YSgpLnRoZW4oZGF0YSA9PiB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCByZXNQdWJsaWMgPSBkYXRhICYmIGRhdGEuaXRlbXNbMF0gJiYgZGF0YS5pdGVtc1swXS5kYXRhO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgcmVzUGVyc29uYWwgPSBkYXRhICYmIGRhdGEuaXRlbXNbMV0gJiYgZGF0YS5pdGVtc1sxXS5kYXRhO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5ncm91cERhdGEucHVibGljID0gcmVzUHVibGljID8gcmVzUHVibGljIDogW107XHJcbiAgICAgICAgICAgICAgICB0aGlzLmdyb3VwRGF0YS5wZXJzb25hbCA9IHJlc1BlcnNvbmFsID8gcmVzUGVyc29uYWwgOiBbXTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGZpcnN0UHVibGljR3JvdXAgPSByZXNQdWJsaWNbMF0gJiYgcmVzUHVibGljWzBdW3RoaXMuZ3JvdXBJZEZpZWxkXTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGZpcnN0UGVyc29uYWxHcm91cCA9IHJlc1BlcnNvbmFsWzBdICYmIHJlc1BlcnNvbmFsWzBdW3RoaXMuZ3JvdXBJZEZpZWxkXTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRHcm91cElkID0gdGhpcy5zZWxlY3RlZEdyb3VwSWQgPyB0aGlzLnNlbGVjdGVkR3JvdXBJZCA6IGZpcnN0UHVibGljR3JvdXA7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGVkR3JvdXBJZCA9IHRoaXMuc2VsZWN0ZWRHcm91cElkID8gdGhpcy5zZWxlY3RlZEdyb3VwSWQgOiBmaXJzdFBlcnNvbmFsR3JvdXA7XHJcbiAgICAgICAgICAgICAgICBpZiAoISF0aGlzLnNlbGVjdGVkR3JvdXBJZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZ2V0UGVyc29ubmVsc0J5R3JvdXAoeyBpZDogdGhpcy5zZWxlY3RlZEdyb3VwSWQgfSwgdGhpcy5jdXJyZW50R3JvdXBUeXBlKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5ncm91cERhdGEucHVibGljLmZpbmRJbmRleChpdGVtID0+IGl0ZW1bdGhpcy5ncm91cElkRmllbGRdID09PSB0aGlzLnNlbGVjdGVkR3JvdXBJZCkgIT09IC0xKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudEdyb3VwVHlwZSA9IHRoaXMucHVibGljVG9rZW47XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLmdyb3VwRGF0YS5wZXJzb25hbC5maW5kSW5kZXgoaXRlbSA9PiBpdGVtW3RoaXMuZ3JvdXBJZEZpZWxkXSA9PT0gdGhpcy5zZWxlY3RlZEdyb3VwSWQpICE9PSAtMSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRHcm91cFR5cGUgPSB0aGlzLnBlcnNvbmFsVG9rZW47XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IodGhpcy5ncm91cEV4dGVuZEluZm8pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBzZWFyY2hCeUNvZGVPck5hbWUoKSB7XHJcbiAgICAgICAgdGhpcy5pdGVtcyA9IHRoaXMuaXRlbXMuZmlsdGVyKGl0ZW0gPT4ge1xyXG4gICAgICAgICAgICByZXR1cm4gaXRlbS5jb2RlLmluZGV4T2YodGhpcy5zZWFyY2hUZXh0KSAhPT0gLTEgfHwgaXRlbS5uYW1lLmluZGV4T2YodGhpcy5zZWFyY2hUZXh0KSAhPT0gLTE7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgdG9nZ2xlRmF2b3JpdGVzKGU6IGFueSwgaXRlbTogYW55KSB7XHJcbiAgICAgICAgdGhpcy5mYXZvcml0ZXNUb29sLnRvZ2dsZUZhdm9yaXRlcyhlLCBpdGVtKTtcclxuICAgIH1cclxuXHJcbiAgICB0b2dnbGVWaXNpYmxlKGUsIHR5cGU6IHN0cmluZykge1xyXG4gICAgICAgIGlmICh0eXBlID09PSB0aGlzLnB1YmxpY1Rva2VuKSB7XHJcbiAgICAgICAgICAgIHRoaXMucHVibGljVmlzaWJsZSA9ICF0aGlzLnB1YmxpY1Zpc2libGU7XHJcbiAgICAgICAgfSBlbHNlIGlmICh0eXBlID09PSB0aGlzLnBlcnNvbmFsVG9rZW4pIHtcclxuICAgICAgICAgICAgdGhpcy5wZXJzb25hbFZpc2libGUgPSAhdGhpcy5wZXJzb25hbFZpc2libGU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgZS5jYW5jZWxCdWJibGUgPSB0cnVlO1xyXG4gICAgfVxyXG5cclxuICAgIHJlc3RvcmVTZWxlY3Rpb25zKCkge1xyXG4gICAgICAgIHRoaXMuc2VsZWN0aW9ucyA9IF8uY2xvbmVEZWVwKHRoaXMuY2xvbmVTZWxlY3Rpb25zKTtcclxuICAgICAgICAvLyB0aGlzLmVtaXRTZWxlY3Rpb25zKCk7XHJcbiAgICAgICAgdGhpcy50b2dnbGVDaGVja2VkKCk7XHJcbiAgICAgICAgaWYgKHRoaXMuaXNBbGxDaGVja2VkKCkpIHtcclxuICAgICAgICAgICAgdGhpcy5hbGxDaGVja2VkID0gdHJ1ZTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLmFsbENoZWNrZWQgPSBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgdG9nZ2xlQWxsKCkge1xyXG4gICAgICAgIGlmICghdGhpcy5hbGxDaGVja2VkKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2hlY2tBbGwoKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLnVuQ2hlY2tBbGwoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5lbWl0U2VsZWN0aW9ucygpO1xyXG4gICAgfVxyXG5cclxuICAgIHRvZ2dsZU9uZShkYXRhKSB7XHJcbiAgICAgICAgaWYgKGRhdGEuY2hlY2tlZCkge1xyXG4gICAgICAgICAgICB0aGlzLnVuU2VsZWN0TGluZShkYXRhKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLnNlbGVjdExpbmUoZGF0YSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuZW1pdFNlbGVjdGlvbnMoKTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogZGF0YWdyaWTnlKjkuo7mlbDmja7lsZXnpLpcclxuICAgICAqL1xyXG4gICAgbG9hZEdyb3VwTGlzdCgpIHtcclxuICAgICAgICB0aGlzLml0ZW1zID0gW107XHJcbiAgICAgICAgLy8gdGhpcy51blNlbGVjdGVkTGlzdC5mb3JFYWNoKHJlcyA9PiB7XHJcbiAgICAgICAgLy8gICAgIGNvbnN0IGluZGV4SWQgPSBNYXRoLnJhbmRvbSgpLnRvU3RyaW5nKDE2KS5zdWJzdHJpbmcoMywgMTApO1xyXG4gICAgICAgIC8vICAgICBjb25zdCBpdGVtID0ge1xyXG4gICAgICAgIC8vICAgICAgICAgYWJicmV2aWF0aW9uOiByZXMuYWJicmV2aWF0aW9uLFxyXG4gICAgICAgIC8vICAgICAgICAgY29kZTogcmVzLmNvZGUsXHJcbiAgICAgICAgLy8gICAgICAgICBkZWZhdWx0T3JnSWQ6IHJlcy5kZWZhdWx0T3JnSWQsXHJcbiAgICAgICAgLy8gICAgICAgICBkZWZhdWx0T3JnUGF0aDogcmVzLmRlZmF1bHRPcmdQYXRoLFxyXG4gICAgICAgIC8vICAgICAgICAgZXh0MTogcmVzLmV4dDEsXHJcbiAgICAgICAgLy8gICAgICAgICBleHQyOiByZXMuZXh0MixcclxuICAgICAgICAvLyAgICAgICAgIGZ1bGxQYXRoTmFtZTogcmVzLmZ1bGxQYXRoTmFtZSxcclxuICAgICAgICAvLyAgICAgICAgIG5hbWU6IHJlcy5uYW1lLFxyXG4gICAgICAgIC8vICAgICAgICAgb3JnVHlwZUlkOiByZXMub3JnVHlwZUlkLFxyXG4gICAgICAgIC8vICAgICAgICAgc2VjTGV2ZWw6IHJlcy5zZWNMZXZlbCxcclxuICAgICAgICAvLyAgICAgICAgIHNvcnRPcmRlcjogcmVzLnNvcnRPcmRlcixcclxuICAgICAgICAvLyAgICAgICAgIHN0YXRlOiByZXMuc3RhdGUsXHJcbiAgICAgICAgLy8gICAgICAgICBzdTogcmVzLnN1LFxyXG4gICAgICAgIC8vICAgICAgICAgdXNlcklkOiByZXMudXNlcklkLFxyXG4gICAgICAgIC8vICAgICAgICAgb3JnQWxsUGF0aDogcmVzLm9yZ0FsbFBhdGgsXHJcbiAgICAgICAgLy8gICAgICAgICB0eXBlOiAncGVvcGxlJyxcclxuICAgICAgICAvLyAgICAgICAgIGNoZWNrZWQ6IGZhbHNlLFxyXG4gICAgICAgIC8vICAgICAgICAgaW5GYXZvcml0ZXM6IGZhbHNlLFxyXG4gICAgICAgIC8vICAgICAgICAgaW5kZXhJZFxyXG4gICAgICAgIC8vICAgICB9O1xyXG4gICAgICAgIC8vICAgICBpZiAodGhpcy5faXNJbkFycmF5KHJlc1t0aGlzLmlkRmllbGRdLCB0aGlzLmlkRmllbGQsIHRoaXMuc2VsZWN0aW9ucykgIT09IC0xKSB7XHJcbiAgICAgICAgLy8gICAgICAgICBpdGVtLmNoZWNrZWQgPSB0cnVlO1xyXG4gICAgICAgIC8vICAgICB9XHJcbiAgICAgICAgLy8gICAgIGlmICh0aGlzLl9pc0luQXJyYXkocmVzW3RoaXMuaWRGaWVsZF0sIHRoaXMuaWRGaWVsZCwgdGhpcy5mYXZvcml0ZXNMaXN0KSAhPT0gLTEpIHtcclxuICAgICAgICAvLyAgICAgICAgIGl0ZW0uaW5GYXZvcml0ZXMgPSB0cnVlO1xyXG4gICAgICAgIC8vICAgICB9XHJcbiAgICAgICAgLy8gICAgIHRoaXMuaXRlbXMucHVzaChpdGVtKTtcclxuICAgICAgICAvLyAgICAgdGhpcy5pdGVtc0JhY2t1cC5wdXNoKGl0ZW0pO1xyXG4gICAgICAgIC8vIH0pO1xyXG4gICAgICAgIGNvbnN0IHRlbXBTZWxlY3Rpb25zID0gXy5jbG9uZURlZXAodGhpcy5zZWxlY3Rpb25zKTtcclxuICAgICAgICB0aGlzLnRvZ2dsZUNoZWNrZWQoKTtcclxuICAgICAgICB0aGlzLnNlbGVjdGlvbnMgPSBfLmNsb25lRGVlcCh0ZW1wU2VsZWN0aW9ucyk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDlhajpgInlkI7lpITnkIZcclxuICAgICAqIEBwYXJhbSBkYXRhQXJyIOWFqOmAieeahOWAvFxyXG4gICAgICovXHJcbiAgICBjaGVja0FsbCgpIHtcclxuICAgICAgICB0aGlzLml0ZW1zLmZvckVhY2goaXRlbSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuX2luc2VydE9uZUludG9TZWxlY3Rpb25zKGl0ZW0pO1xyXG4gICAgICAgICAgICBpdGVtLmNoZWNrZWQgPSB0cnVlO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog5YWo6YOo5Y+W5raIXHJcbiAgICAgKiBAcGFyYW0gZGF0YUFyciDlj5bmtojnmoTmlbDmja5cclxuICAgICAqIEByZXR1cm5zIHZvaWRcclxuICAgICAqL1xyXG4gICAgdW5DaGVja0FsbCgpIHtcclxuICAgICAgICB0aGlzLml0ZW1zLmZvckVhY2goaXRlbSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0aW9ucy5mb3JFYWNoKChzZWxlY3Rpb24sIGluZGV4KSA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAoaXRlbVt0aGlzLmlkRmllbGRdID09PSBzZWxlY3Rpb25bdGhpcy5pZEZpZWxkXSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0aW9ucy5zcGxpY2UoaW5kZXgsIDEpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgaXRlbS5jaGVja2VkID0gZmFsc2U7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDlvZPliY3ooYzpgInkuK1cclxuICAgICAqIEBwYXJhbSBkYXRhIOW9k+WJjeihjOeahOaVsOaNru+8iO+8iVxyXG4gICAgICovXHJcbiAgICBzZWxlY3RMaW5lKGRhdGE6IGFueSkge1xyXG4gICAgICAgIGlmICh0aGlzLm11bHRpU2VsZWN0KSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2luc2VydE9uZUludG9TZWxlY3Rpb25zKGRhdGEpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMudXNlcklkcyA9ICcnO1xyXG4gICAgICAgICAgICB0aGlzLnNlbGVjdGlvbnMgPSBbXTtcclxuICAgICAgICAgICAgdGhpcy5pdGVtcy5mb3JFYWNoKGl0ZW0gPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKGl0ZW0uY2hlY2tlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGl0ZW0uY2hlY2tlZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgdGhpcy5faW5zZXJ0T25lSW50b1NlbGVjdGlvbnMoZGF0YSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLmlzQWxsQ2hlY2tlZCgpKSB7XHJcbiAgICAgICAgICAgIHRoaXMuYWxsQ2hlY2tlZCA9IHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog5Y2V6YCJ5Y+W5raI6YCJ5LitXHJcbiAgICAgKiBAcGFyYW0gZGF0YSDlj5bmtojpgInkuK3ooYxcclxuICAgICAqL1xyXG4gICAgdW5TZWxlY3RMaW5lKGRhdGE6IGFueSkge1xyXG4gICAgICAgIGNvbnN0IGluZGV4ID0gdGhpcy5faXNJbkFycmF5KGRhdGFbdGhpcy5pZEZpZWxkXSwgdGhpcy5pZEZpZWxkLCB0aGlzLnNlbGVjdGlvbnMpO1xyXG4gICAgICAgIGlmIChpbmRleCA+IC0xKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0aW9ucy5zcGxpY2UoaW5kZXgsIDEpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy5hbGxDaGVja2VkKSB7XHJcbiAgICAgICAgICAgIHRoaXMuYWxsQ2hlY2tlZCA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGVtaXRTZWxlY3Rpb25zKCkge1xyXG4gICAgICAgIGNvbnN0IGVtaXRPYmogPSB7XHJcbiAgICAgICAgICAgIHNlbGVjdGlvbnM6IHRoaXMuc2VsZWN0aW9ucyxcclxuICAgICAgICAgICAgdG9rZW46ICdjYW5kaWRhdGUnXHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLnNlbGVjdGlvbnNDaGFuZ2UuZW1pdChlbWl0T2JqKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqICDlj5bmtojpgInkuK1cclxuICAgICAqIEBwYXJhbSAkZXZlbnQg5Y+W5raI5Yu+6YCJ55qE5pWw5o2uXHJcbiAgICAgKi9cclxuICAgIGNhbmNlbFNlbGVjdGlvbnMoJGV2ZW50KSB7XHJcbiAgICAgICAgaWYgKHRoaXMuaXRlbXMuZmluZEluZGV4KGl0ZW0gPT4gaXRlbVt0aGlzLmlkRmllbGRdID09PSAkZXZlbnQuaWQpID09PSAtMSkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuaXRlbXMuZm9yRWFjaChpdGVtID0+IHtcclxuICAgICAgICAgICAgaWYgKGl0ZW1bdGhpcy5pZEZpZWxkXSA9PT0gJGV2ZW50LmlkKSB7XHJcbiAgICAgICAgICAgICAgICBpdGVtLmNoZWNrZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMuc2VsZWN0aW9ucy5mb3JFYWNoKChzZWxlY3Rpb24sIGluZGV4KSA9PiB7XHJcbiAgICAgICAgICAgIGlmICgkZXZlbnQuaWQgPT09IHNlbGVjdGlvblt0aGlzLmlkRmllbGRdKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGlvbnMuc3BsaWNlKGluZGV4LCAxKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMuYWxsQ2hlY2tlZCA9IGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog5YWo6YOo5Y+W5raI5Yu+6YCJXHJcbiAgICAgKi9cclxuICAgIGNsZWFyQ2hlY2tlZHMoKSB7XHJcbiAgICAgICAgdGhpcy5pdGVtcy5mb3JFYWNoKGl0ZW0gPT4ge1xyXG4gICAgICAgICAgICBpdGVtLmNoZWNrZWQgPSBmYWxzZTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLmFsbENoZWNrZWQgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLnNlbGVjdGlvbnMgPSBbXTtcclxuICAgIH1cclxuXHJcbiAgICBjbGVhclVzZXJJZHMoKSB7XHJcbiAgICAgICAgdGhpcy51c2VySWRzID0gJyc7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIOmAieS4reW5tuaPkuWFpeW9k+WJjeihjOaVsOaNruWIsOWPs+S+p1xyXG4gICAgICogQHBhcmFtIGRhdGEg5b2T5YmN6KGM55qE5pWw5o2uXHJcbiAgICAgKiBAcGFyYW0gY29sbGVjdGlvbiDmmoLlrZjlvZPliY3mlbDmja7nmoTpm4blkIhcclxuICAgICAqL1xyXG4gICAgX2luc2VydE9uZUludG9TZWxlY3Rpb25zKGRhdGE6IGFueSkge1xyXG4gICAgICAgIC8vIOWmguaenOW9k+WJjeaVsOaNruW3sue7j+enu+WFpeWPs+S+p+aVsOaNru+8jOWImei/lOWbnuOAglxyXG4gICAgICAgIGlmICh0aGlzLl9pc0luQXJyYXkoZGF0YVt0aGlzLmlkRmllbGRdLCB0aGlzLmlkRmllbGQsIHRoaXMuc2VsZWN0aW9ucykgPiAtMSkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuc2VsZWN0aW9ucy5wdXNoKGRhdGEpO1xyXG4gICAgICAgIHRoaXMuc2VsZWN0aW9ucyA9IHRoaXMuc2VsZWN0aW9ucy5zbGljZSgpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog5Yik5pat5piv5ZCm5Zyo5YaFXHJcbiAgICAgKiBAcGFyYW0gdmFsdWUgdmFsdWVcclxuICAgICAqIEBwYXJhbSBmaWVsZCBmaWVsZFxyXG4gICAgICogQHBhcmFtIGFycmF5IGFycmF5XHJcbiAgICAgKiBAcmV0dXJucyDkvY3nva7ntKLlvJVcclxuICAgICAqL1xyXG4gICAgX2lzSW5BcnJheSh2YWx1ZTogc3RyaW5nLCBmaWVsZDogc3RyaW5nLCBhcnJheTogYW55W10pOiBudW1iZXIge1xyXG4gICAgICAgIGlmICghZmllbGQgfHwgIXZhbHVlKSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcih0aGlzLnZhbGlkRWxlbWVudHNJbmZvKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGFycmF5LmZpbmRJbmRleChpdGVtID0+IHZhbHVlID09PSBpdGVtW2ZpZWxkXSk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDnv7vpobXmo4Dmn6XvvJrkurrlkZjlsZXnpLrljLrnmoTli77pgInnirbmgIHkuI7lt7LpgInkurrlkZjljLrmmK/lkKblr7nlupRcclxuICAgICAqL1xyXG4gICAgdG9nZ2xlQ2hlY2tlZCgpIHtcclxuICAgICAgICB0aGlzLml0ZW1zLmZvckVhY2goaXRlbSA9PiB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLl9pc0luQXJyYXkoaXRlbVt0aGlzLmlkRmllbGRdLCB0aGlzLmlkRmllbGQsIHRoaXMuc2VsZWN0aW9ucykgPiAtMSkge1xyXG4gICAgICAgICAgICAgICAgaXRlbS5jaGVja2VkID0gdHJ1ZTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGl0ZW0uY2hlY2tlZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgaWYgKHRoaXMuaXNBbGxDaGVja2VkKCkpIHtcclxuICAgICAgICAgICAgdGhpcy5hbGxDaGVja2VkID0gdHJ1ZTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLmFsbENoZWNrZWQgPSBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBpc0FsbENoZWNrZWQoKTogYm9vbGVhbiB7XHJcbiAgICAgICAgbGV0IGNvdW50ID0gMDtcclxuICAgICAgICBsZXQgYWxsQ2hlY2tlZCA9IGZhbHNlO1xyXG5cclxuICAgICAgICB0aGlzLml0ZW1zLmZvckVhY2goaXRlbSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0aW9ucy5mb3JFYWNoKHNlbGVjdGlvbiA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAoaXRlbVt0aGlzLmlkRmllbGRdID09PSBzZWxlY3Rpb25bdGhpcy5pZEZpZWxkXSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvdW50ICs9IDE7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGlmICh0aGlzLml0ZW1zLmxlbmd0aCA9PT0gY291bnQgJiYgY291bnQgPiAwKSB7XHJcbiAgICAgICAgICAgIGFsbENoZWNrZWQgPSB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gYWxsQ2hlY2tlZDtcclxuICAgIH1cclxuXHJcbiAgICB0cmFja0J5Rm4oaW5kZXgsIGl0ZW0pIHtcclxuICAgICAgICByZXR1cm4gaW5kZXg7XHJcbiAgICB9XHJcblxyXG59XHJcbiJdfQ==