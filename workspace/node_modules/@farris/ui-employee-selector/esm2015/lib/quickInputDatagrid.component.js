/**
 * @fileoverview added by tsickle
 * Generated from: lib/quickInputDatagrid.component.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, Input, EventEmitter, Output, ViewChild } from "@angular/core";
import { ApiLocalService } from "../utils/api-service";
import { DatagridComponent } from "@farris/ui-datagrid";
import { of } from 'rxjs';
// 兼容保留，该组件无用
export class quickInputDatagridComponent {
    /**
     * @param {?} ApiLocalService
     */
    constructor(ApiLocalService) {
        this.ApiLocalService = ApiLocalService;
        this.isAllSelect = new EventEmitter();
        /**
         * 人员展示区的复选框取消勾选时触发逻辑
         * @param $event
         * @return
         */
        this.onBeforeUncheck = (/**
         * @param {?} $event
         * @return {?}
         */
        ($event) => {
            this.selections.forEach((/**
             * @param {?} selection
             * @param {?} index
             * @return {?}
             */
            (selection, index) => {
                if ($event.rowData["id"] === selection["id"]) {
                    this.selections.splice(index, 1);
                }
            }));
            /** @type {?} */
            let emitojb = {
                items: this.itemsQuick,
                pageIndex: this.pageIndexQuick,
                pageSize: this.pageSizeQuick,
                pageTotal: this.pageTotalQuick,
                pageTotalAll: this.pageTotalAllQuick,
                unSelectedList: this.unSelectedListQuick
            };
            this.isAllSelect.emit(emitojb);
            return of(true);
        });
    }
    /**
     * @return {?}
     */
    ngOnInit() {
        this.quickInputDatagrid.loadData(this.itemsQuick);
    }
    /**
     * @return {?}
     */
    ngAfterViewInit() {
        this.pageChangeCheck();
    }
    /**
     * 人员展示区datagrid用于数据加载
     * @return {?}
     */
    unSelectedListLoad() {
        this.itemsQuick = [];
        this.unSelectedListQuick.forEach((/**
         * @param {?} res
         * @return {?}
         */
        res => {
            this.itemsQuick.push({ "displayname": res.displayname, "nameChs": res.nameChs, "id": res.id, "organization": res.organization, "organizationName": res.userOrganize, "userInFo": res.userInfo });
        }));
        this.quickInputDatagrid.loadData(this.itemsQuick);
        this.pageChangeCheck();
        /** @type {?} */
        let emitojb = {
            items: this.itemsQuick,
            pageIndex: this.pageIndexQuick,
            pageSize: this.pageSizeQuick,
            pageTotal: this.pageTotalQuick,
            pageTotalAll: this.pageTotalAllQuick,
            unSelectedList: this.unSelectedListQuick
        };
        this.isAllSelect.emit(emitojb);
    }
    /**
     * 当前行选中
     * @param {?} data 当前行的数据（）
     * @return {?}
     */
    selectLine(data) {
        if (this.isSingleCheck) {
            if (this.selections.length == 0 || this._isInArray(data.id, "id", this.selections)) {
                this._insertOneIntoSelections(data.data);
            }
            else {
                alert(this.noSelectToRight);
            }
        }
        else {
            this._insertOneIntoSelections(data.data);
        }
        /** @type {?} */
        let emitojb = {
            items: this.itemsQuick,
            pageIndex: this.pageIndexQuick,
            pageSize: this.pageSizeQuick,
            pageTotal: this.pageTotalQuick,
            pageTotalAll: this.pageTotalAllQuick,
            unSelectedList: this.unSelectedListQuick
        };
        this.isAllSelect.emit(emitojb);
    }
    //人员展示翻页触发查询（！）
    /**
     * @param {?} size
     * @return {?}
     */
    switchPage(size) {
        this.pageIndexQuick = size.pageIndex;
        /** @type {?} */
        let isChinese;
        //中文
        if (/^[\u4e00-\u9fa5]+$/i.test(this.quickInput)) {
            isChinese = 0;
        }
        else if (!(/^[\u4e00-\u9fa5]+$/i.test(this.quickInput)) && !(escape(this.quickInput).indexOf("%u") < 0)) {
            alert("输入框禁止同时输入汉字和拼音或汉字和数字！");
            //英文
        }
        else if (/^[a-zA-Z]+$/.test(this.quickInput)) {
            if (this.quickInput.length > 3) {
                isChinese = 2;
            }
            else
                (isChinese = 3);
        }
        else {
            isChinese = 1;
        }
    }
    /**
     * 选中并插入当前行数据到右侧
     * @param {?} data 当前行的数据
     * @return {?}
     */
    _insertOneIntoSelections(data) {
        /** @type {?} */
        let collection = [];
        // 如果当前数据已经移入右侧数据，则返回。
        if (this._isInArray(data["id"], "id", this.selections)) {
            return;
        }
        collection.push(data);
        this._insertSomeIntoSelections(collection);
    }
    /**
     * 判断是否在内
     * @param {?} value
     * @param {?} field
     * @param {?} array
     * @return {?}
     */
    _isInArray(value, field, array) {
        if (!field || !value) {
            throw new Error('前2个参数必填');
        }
        return array.find((/**
         * @param {?} item
         * @return {?}
         */
        item => value === item[field])) ? true : false;
    }
    /**
     * @param {?} userArray
     * @return {?}
     */
    _insertSomeIntoSelections(userArray) {
        userArray.forEach((/**
         * @param {?} user
         * @return {?}
         */
        user => {
            if (!this._isInArray(user["id"], "id", this.selections)) {
                this.selections.push(user);
            }
        }));
    }
    /**
     * 翻页检查：人员展示区的勾选状态与已选人员区是否对应
     * @return {?}
     */
    pageChangeCheck() {
        if (this.unSelectedListQuick) {
            this.unSelectedListQuick.forEach((/**
             * @param {?} item
             * @return {?}
             */
            item => {
                if (this._isInArray(item.id, "id", this.selections)) {
                    this.quickInputDatagrid.checkRow(item.id);
                }
                else {
                    this.quickInputDatagrid.unCheckRow(item.id);
                }
            }));
        }
    }
}
quickInputDatagridComponent.decorators = [
    { type: Component, args: [{
                template: `<farris-datagrid #quickInputDatagrid class="s-unSelectDatagrid-query" [pagerViewMode]="'simple'" [checkOnSelect]="true"
    [selectOnCheck]="true" [multiSelect]="true" [columns]="columnsQuick" [data]="itemsQuick"
    [enableSelectRow]="true" [showHeader]="false" [fitColumns]="true" [height]="200"
    [showBorder]="false" [striped]="false" [fit]="true" [showPageNumber]="false"
    [pageIndex]="pageIndexQuick" [pageSize]="pageSizeQuick" [total]="pageTotalAllQuick"
    (checked)="selectLine($event)" (pageChanged)="switchPage($event)"
    [beforeUncheck]="onBeforeUncheck">
  </farris-datagrid>`
            }] }
];
/** @nocollapse */
quickInputDatagridComponent.ctorParameters = () => [
    { type: ApiLocalService }
];
quickInputDatagridComponent.propDecorators = {
    quickInputDatagrid: [{ type: ViewChild, args: ['quickInputDatagrid',] }],
    columnsQuick: [{ type: Input }],
    url2: [{ type: Input }],
    itemsQuick: [{ type: Input }],
    pageIndexQuick: [{ type: Input }],
    pageSizeQuick: [{ type: Input }],
    pageTotalAllQuick: [{ type: Input }],
    pathQuick: [{ type: Input }],
    orgIdQuick: [{ type: Input }],
    isContainQuick: [{ type: Input }],
    pageTotalQuick: [{ type: Input }],
    isSingleCheck: [{ type: Input }],
    selections: [{ type: Input }],
    noSelectToRight: [{ type: Input }],
    quickInput: [{ type: Input }],
    isLoadOutData: [{ type: Input }],
    unSelectedQuickLists: [{ type: Input }],
    unSelectedListQuick: [{ type: Input }],
    organizationList: [{ type: Input }],
    listIdField: [{ type: Input }],
    searchPage: [{ type: Input }],
    isenabled: [{ type: Input }],
    isExcludeMe: [{ type: Input }],
    isAllSelect: [{ type: Output }]
};
if (false) {
    /** @type {?} */
    quickInputDatagridComponent.prototype.quickInputDatagrid;
    /** @type {?} */
    quickInputDatagridComponent.prototype.columnsQuick;
    /** @type {?} */
    quickInputDatagridComponent.prototype.url2;
    /** @type {?} */
    quickInputDatagridComponent.prototype.itemsQuick;
    /** @type {?} */
    quickInputDatagridComponent.prototype.pageIndexQuick;
    /** @type {?} */
    quickInputDatagridComponent.prototype.pageSizeQuick;
    /** @type {?} */
    quickInputDatagridComponent.prototype.pageTotalAllQuick;
    /** @type {?} */
    quickInputDatagridComponent.prototype.pathQuick;
    /** @type {?} */
    quickInputDatagridComponent.prototype.orgIdQuick;
    /** @type {?} */
    quickInputDatagridComponent.prototype.isContainQuick;
    /** @type {?} */
    quickInputDatagridComponent.prototype.pageTotalQuick;
    /** @type {?} */
    quickInputDatagridComponent.prototype.isSingleCheck;
    /** @type {?} */
    quickInputDatagridComponent.prototype.selections;
    /** @type {?} */
    quickInputDatagridComponent.prototype.noSelectToRight;
    /** @type {?} */
    quickInputDatagridComponent.prototype.quickInput;
    /** @type {?} */
    quickInputDatagridComponent.prototype.isLoadOutData;
    /** @type {?} */
    quickInputDatagridComponent.prototype.unSelectedQuickLists;
    /** @type {?} */
    quickInputDatagridComponent.prototype.unSelectedListQuick;
    /** @type {?} */
    quickInputDatagridComponent.prototype.organizationList;
    /** @type {?} */
    quickInputDatagridComponent.prototype.listIdField;
    /** @type {?} */
    quickInputDatagridComponent.prototype.searchPage;
    /** @type {?} */
    quickInputDatagridComponent.prototype.isenabled;
    /** @type {?} */
    quickInputDatagridComponent.prototype.isExcludeMe;
    /** @type {?} */
    quickInputDatagridComponent.prototype.isAllSelect;
    /**
     * 人员展示区的复选框取消勾选时触发逻辑
     * \@param $event
     * \@return
     * @type {?}
     */
    quickInputDatagridComponent.prototype.onBeforeUncheck;
    /**
     * @type {?}
     * @private
     */
    quickInputDatagridComponent.prototype.ApiLocalService;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicXVpY2tJbnB1dERhdGFncmlkLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BmYXJyaXMvdWktZW1wbG95ZWUtc2VsZWN0b3IvIiwic291cmNlcyI6WyJsaWIvcXVpY2tJbnB1dERhdGFncmlkLmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7OztBQUFBLE9BQU8sRUFBRSxTQUFTLEVBQUUsS0FBSyxFQUFFLFlBQVksRUFBRSxNQUFNLEVBQUUsU0FBUyxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBQ2xGLE9BQU8sRUFBRSxlQUFlLEVBQUUsTUFBTSxzQkFBc0IsQ0FBQztBQUN2RCxPQUFPLEVBQUUsaUJBQWlCLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQztBQUN4RCxPQUFPLEVBQUUsRUFBRSxFQUFFLE1BQU0sTUFBTSxDQUFDOztBQWMxQixNQUFNLE9BQU8sMkJBQTJCOzs7O0lBNEJwQyxZQUNZLGVBQWdDO1FBQWhDLG9CQUFlLEdBQWYsZUFBZSxDQUFpQjtRQUhsQyxnQkFBVyxHQUFHLElBQUksWUFBWSxFQUFPLENBQUM7Ozs7OztRQXdGaEQsb0JBQWU7Ozs7UUFBRyxDQUFDLE1BQU0sRUFBRSxFQUFFO1lBQ3pCLElBQUksQ0FBQyxVQUFVLENBQUMsT0FBTzs7Ozs7WUFBQyxDQUFDLFNBQVMsRUFBRSxLQUFLLEVBQUUsRUFBRTtnQkFDekMsSUFBSSxNQUFNLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxLQUFLLFNBQVMsQ0FBQyxJQUFJLENBQUMsRUFBRTtvQkFDMUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxNQUFNLENBQUMsS0FBSyxFQUFFLENBQUMsQ0FBQyxDQUFDO2lCQUNwQztZQUNMLENBQUMsRUFBQyxDQUFBOztnQkFDRSxPQUFPLEdBQUc7Z0JBQ1YsS0FBSyxFQUFFLElBQUksQ0FBQyxVQUFVO2dCQUN0QixTQUFTLEVBQUUsSUFBSSxDQUFDLGNBQWM7Z0JBQzlCLFFBQVEsRUFBRSxJQUFJLENBQUMsYUFBYTtnQkFDNUIsU0FB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O21CQUNMLEtBQUs7eUJBQ0wsS0FBSzs2QkFDTCxLQUFLOzRCQUNMLEtBQUs7Z0NBQ0wsS0FBSzt3QkFDTCxLQUFLO3lCQUNMLEtBQUs7NkJBQ0wsS0FBSzs2QkFDTCxLQUFLOzRCQUNMLEtBQUs7eUJBQ0wsS0FBSzs4QkFDTCxLQUFLO3lCQUNMLEtBQUs7NEJBQ0wsS0FBSzttQ0FDTCxLQUFLO2tDQUNMLEtBQUs7K0JBQ0wsS0FBSzswQkFDTCxLQUFLO3lCQUNMLEtBQUs7d0JBQ0wsS0FBSzswQkFDTCxLQUFLOzBCQUNMLE1BQU07Ozs7SUF4QlAseURBQXVFOztJQUV2RSxtREFBMEI7O0lBQzFCLDJDQUFrQjs7SUFDbEIsaURBQXdCOztJQUN4QixxREFBNEI7O0lBQzVCLG9EQUEyQjs7SUFDM0Isd0RBQStCOztJQUMvQixnREFBdUI7O0lBQ3ZCLGlEQUF3Qjs7SUFDeEIscURBQTRCOztJQUM1QixxREFBNEI7O0lBQzVCLG9EQUEyQjs7SUFDM0IsaURBQXdCOztJQUN4QixzREFBNkI7O0lBQzdCLGlEQUF3Qjs7SUFDeEIsb0RBQTJCOztJQUMzQiwyREFBa0M7O0lBQ2xDLDBEQUFpQzs7SUFDakMsdURBQThCOztJQUM5QixrREFBNEI7O0lBQzVCLGlEQUE2Qjs7SUFDN0IsZ0RBQTJCOztJQUMzQixrREFBNkI7O0lBQzdCLGtEQUFnRDs7Ozs7OztJQXdGaEQsc0RBZ0JDOzs7OztJQXJHRyxzREFBd0MiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb21wb25lbnQsIElucHV0LCBFdmVudEVtaXR0ZXIsIE91dHB1dCwgVmlld0NoaWxkIH0gZnJvbSBcIkBhbmd1bGFyL2NvcmVcIjtcclxuaW1wb3J0IHsgQXBpTG9jYWxTZXJ2aWNlIH0gZnJvbSBcIi4uL3V0aWxzL2FwaS1zZXJ2aWNlXCI7XHJcbmltcG9ydCB7IERhdGFncmlkQ29tcG9uZW50IH0gZnJvbSBcIkBmYXJyaXMvdWktZGF0YWdyaWRcIjtcclxuaW1wb3J0IHsgb2YgfSBmcm9tICdyeGpzJztcclxuXHJcbi8vIOWFvOWuueS/neeVme+8jOivpee7hOS7tuaXoOeUqFxyXG5AQ29tcG9uZW50KHtcclxuICAgIHRlbXBsYXRlOiBgPGZhcnJpcy1kYXRhZ3JpZCAjcXVpY2tJbnB1dERhdGFncmlkIGNsYXNzPVwicy11blNlbGVjdERhdGFncmlkLXF1ZXJ5XCIgW3BhZ2VyVmlld01vZGVdPVwiJ3NpbXBsZSdcIiBbY2hlY2tPblNlbGVjdF09XCJ0cnVlXCJcclxuICAgIFtzZWxlY3RPbkNoZWNrXT1cInRydWVcIiBbbXVsdGlTZWxlY3RdPVwidHJ1ZVwiIFtjb2x1bW5zXT1cImNvbHVtbnNRdWlja1wiIFtkYXRhXT1cIml0ZW1zUXVpY2tcIlxyXG4gICAgW2VuYWJsZVNlbGVjdFJvd109XCJ0cnVlXCIgW3Nob3dIZWFkZXJdPVwiZmFsc2VcIiBbZml0Q29sdW1uc109XCJ0cnVlXCIgW2hlaWdodF09XCIyMDBcIlxyXG4gICAgW3Nob3dCb3JkZXJdPVwiZmFsc2VcIiBbc3RyaXBlZF09XCJmYWxzZVwiIFtmaXRdPVwidHJ1ZVwiIFtzaG93UGFnZU51bWJlcl09XCJmYWxzZVwiXHJcbiAgICBbcGFnZUluZGV4XT1cInBhZ2VJbmRleFF1aWNrXCIgW3BhZ2VTaXplXT1cInBhZ2VTaXplUXVpY2tcIiBbdG90YWxdPVwicGFnZVRvdGFsQWxsUXVpY2tcIlxyXG4gICAgKGNoZWNrZWQpPVwic2VsZWN0TGluZSgkZXZlbnQpXCIgKHBhZ2VDaGFuZ2VkKT1cInN3aXRjaFBhZ2UoJGV2ZW50KVwiXHJcbiAgICBbYmVmb3JlVW5jaGVja109XCJvbkJlZm9yZVVuY2hlY2tcIj5cclxuICA8L2ZhcnJpcy1kYXRhZ3JpZD5gXHJcbn0pXHJcblxyXG5leHBvcnQgY2xhc3MgcXVpY2tJbnB1dERhdGFncmlkQ29tcG9uZW50IHtcclxuXHJcbiAgICBAVmlld0NoaWxkKCdxdWlja0lucHV0RGF0YWdyaWQnKSBxdWlja0lucHV0RGF0YWdyaWQ6IERhdGFncmlkQ29tcG9uZW50O1xyXG5cclxuICAgIEBJbnB1dCgpIGNvbHVtbnNRdWljazogYW55XHJcbiAgICBASW5wdXQoKSB1cmwyOiBhbnlcclxuICAgIEBJbnB1dCgpIGl0ZW1zUXVpY2s6IGFueVxyXG4gICAgQElucHV0KCkgcGFnZUluZGV4UXVpY2s6IGFueVxyXG4gICAgQElucHV0KCkgcGFnZVNpemVRdWljazogYW55XHJcbiAgICBASW5wdXQoKSBwYWdlVG90YWxBbGxRdWljazogYW55XHJcbiAgICBASW5wdXQoKSBwYXRoUXVpY2s6IGFueVxyXG4gICAgQElucHV0KCkgb3JnSWRRdWljazogYW55XHJcbiAgICBASW5wdXQoKSBpc0NvbnRhaW5RdWljazogYW55XHJcbiAgICBASW5wdXQoKSBwYWdlVG90YWxRdWljazogYW55XHJcbiAgICBASW5wdXQoKSBpc1NpbmdsZUNoZWNrOiBhbnlcclxuICAgIEBJbnB1dCgpIHNlbGVjdGlvbnM6IGFueVxyXG4gICAgQElucHV0KCkgbm9TZWxlY3RUb1JpZ2h0OiBhbnlcclxuICAgIEBJbnB1dCgpIHF1aWNrSW5wdXQ6IGFueVxyXG4gICAgQElucHV0KCkgaXNMb2FkT3V0RGF0YTogYW55XHJcbiAgICBASW5wdXQoKSB1blNlbGVjdGVkUXVpY2tMaXN0czogYW55XHJcbiAgICBASW5wdXQoKSB1blNlbGVjdGVkTGlzdFF1aWNrOiBhbnlcclxuICAgIEBJbnB1dCgpIG9yZ2FuaXphdGlvbkxpc3Q6IGFueVxyXG4gICAgQElucHV0KCkgbGlzdElkRmllbGQ6IHN0cmluZ1xyXG4gICAgQElucHV0KCkgc2VhcmNoUGFnZTogYm9vbGVhbjtcclxuICAgIEBJbnB1dCgpIGlzZW5hYmxlZDogbnVtYmVyO1xyXG4gICAgQElucHV0KCkgaXNFeGNsdWRlTWU6IG51bWJlcjtcclxuICAgIEBPdXRwdXQoKSBpc0FsbFNlbGVjdCA9IG5ldyBFdmVudEVtaXR0ZXI8YW55PigpO1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKFxyXG4gICAgICAgIHByaXZhdGUgQXBpTG9jYWxTZXJ2aWNlOiBBcGlMb2NhbFNlcnZpY2UsXHJcbiAgICApIHsgfVxyXG5cclxuICAgIG5nT25Jbml0KCk6IHZvaWQge1xyXG4gICAgICAgIHRoaXMucXVpY2tJbnB1dERhdGFncmlkLmxvYWREYXRhKHRoaXMuaXRlbXNRdWljayk7XHJcbiAgICB9XHJcblxyXG4gICAgbmdBZnRlclZpZXdJbml0KCk6IHZvaWQge1xyXG4gICAgICAgIHRoaXMucGFnZUNoYW5nZUNoZWNrKCk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgICAqIOS6uuWRmOWxleekuuWMumRhdGFncmlk55So5LqO5pWw5o2u5Yqg6L29XHJcbiAgICAgICAqL1xyXG4gICAgdW5TZWxlY3RlZExpc3RMb2FkKCkge1xyXG4gICAgICAgIHRoaXMuaXRlbXNRdWljayA9IFtdO1xyXG4gICAgICAgIHRoaXMudW5TZWxlY3RlZExpc3RRdWljay5mb3JFYWNoKHJlcyA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuaXRlbXNRdWljay5wdXNoKHsgXCJkaXNwbGF5bmFtZVwiOiByZXMuZGlzcGxheW5hbWUsIFwibmFtZUNoc1wiOiByZXMubmFtZUNocywgXCJpZFwiOiByZXMuaWQsIFwib3JnYW5pemF0aW9uXCI6IHJlcy5vcmdhbml6YXRpb24sIFwib3JnYW5pemF0aW9uTmFtZVwiOiByZXMudXNlck9yZ2FuaXplLCBcInVzZXJJbkZvXCI6IHJlcy51c2VySW5mbyB9KVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMucXVpY2tJbnB1dERhdGFncmlkLmxvYWREYXRhKHRoaXMuaXRlbXNRdWljayk7XHJcbiAgICAgICAgdGhpcy5wYWdlQ2hhbmdlQ2hlY2soKTtcclxuICAgICAgICBsZXQgZW1pdG9qYiA9IHtcclxuICAgICAgICAgICAgaXRlbXM6IHRoaXMuaXRlbXNRdWljayxcclxuICAgICAgICAgICAgcGFnZUluZGV4OiB0aGlzLnBhZ2VJbmRleFF1aWNrLFxyXG4gICAgICAgICAgICBwYWdlU2l6ZTogdGhpcy5wYWdlU2l6ZVF1aWNrLFxyXG4gICAgICAgICAgICBwYWdlVG90YWw6IHRoaXMucGFnZVRvdGFsUXVpY2ssXHJcbiAgICAgICAgICAgIHBhZ2VUb3RhbEFsbDogdGhpcy5wYWdlVG90YWxBbGxRdWljayxcclxuICAgICAgICAgICAgdW5TZWxlY3RlZExpc3Q6IHRoaXMudW5TZWxlY3RlZExpc3RRdWlja1xyXG5cclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5pc0FsbFNlbGVjdC5lbWl0KGVtaXRvamIpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICAgKiDlvZPliY3ooYzpgInkuK1cclxuICAgICAgICogQHBhcmFtIGRhdGEg5b2T5YmN6KGM55qE5pWw5o2u77yI77yJXHJcbiAgICAgICAqL1xyXG4gICAgc2VsZWN0TGluZShkYXRhOiBhbnkpIHtcclxuICAgICAgICBpZiAodGhpcy5pc1NpbmdsZUNoZWNrKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLnNlbGVjdGlvbnMubGVuZ3RoID09IDAgfHwgdGhpcy5faXNJbkFycmF5KGRhdGEuaWQsIFwiaWRcIiwgdGhpcy5zZWxlY3Rpb25zKSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5faW5zZXJ0T25lSW50b1NlbGVjdGlvbnMoZGF0YS5kYXRhKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGFsZXJ0KHRoaXMubm9TZWxlY3RUb1JpZ2h0KTtcclxuXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLl9pbnNlcnRPbmVJbnRvU2VsZWN0aW9ucyhkYXRhLmRhdGEpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBsZXQgZW1pdG9qYiA9IHtcclxuICAgICAgICAgICAgaXRlbXM6IHRoaXMuaXRlbXNRdWljayxcclxuICAgICAgICAgICAgcGFnZUluZGV4OiB0aGlzLnBhZ2VJbmRleFF1aWNrLFxyXG4gICAgICAgICAgICBwYWdlU2l6ZTogdGhpcy5wYWdlU2l6ZVF1aWNrLFxyXG4gICAgICAgICAgICBwYWdlVG90YWw6IHRoaXMucGFnZVRvdGFsUXVpY2ssXHJcbiAgICAgICAgICAgIHBhZ2VUb3RhbEFsbDogdGhpcy5wYWdlVG90YWxBbGxRdWljayxcclxuICAgICAgICAgICAgdW5TZWxlY3RlZExpc3Q6IHRoaXMudW5TZWxlY3RlZExpc3RRdWlja1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmlzQWxsU2VsZWN0LmVtaXQoZW1pdG9qYik7XHJcbiAgICB9XHJcblxyXG4gICAgLy/kurrlkZjlsZXnpLrnv7vpobXop6blj5Hmn6Xor6LvvIjvvIHvvIlcclxuICAgIHN3aXRjaFBhZ2Uoc2l6ZSkge1xyXG4gICAgICAgIHRoaXMucGFnZUluZGV4UXVpY2sgPSBzaXplLnBhZ2VJbmRleDtcclxuICAgICAgICBsZXQgaXNDaGluZXNlOiBudW1iZXI7XHJcbiAgICAgICAgLy/kuK3mlodcclxuICAgICAgICBpZiAoL15bXFx1NGUwMC1cXHU5ZmE1XSskL2kudGVzdCh0aGlzLnF1aWNrSW5wdXQpKSB7XHJcbiAgICAgICAgICAgIGlzQ2hpbmVzZSA9IDA7XHJcbiAgICAgICAgfSBlbHNlIGlmICghKC9eW1xcdTRlMDAtXFx1OWZhNV0rJC9pLnRlc3QodGhpcy5xdWlja0lucHV0KSkgJiYgIShlc2NhcGUodGhpcy5xdWlja0lucHV0KS5pbmRleE9mKFwiJXVcIikgPCAwKSkge1xyXG4gICAgICAgICAgICBhbGVydChcIui+k+WFpeahhuemgeatouWQjOaXtui+k+WFpeaxieWtl+WSjOaLvOmfs+aIluaxieWtl+WSjOaVsOWtl++8gVwiKVxyXG4gICAgICAgICAgICAvL+iLseaWh1xyXG4gICAgICAgIH0gZWxzZSBpZiAoL15bYS16QS1aXSskLy50ZXN0KHRoaXMucXVpY2tJbnB1dCkpIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMucXVpY2tJbnB1dC5sZW5ndGggPiAzKSB7XHJcbiAgICAgICAgICAgICAgICBpc0NoaW5lc2UgPSAyXHJcbiAgICAgICAgICAgIH0gZWxzZSAoXHJcbiAgICAgICAgICAgICAgICBpc0NoaW5lc2UgPSAzXHJcbiAgICAgICAgICAgIClcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBpc0NoaW5lc2UgPSAxO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAgICog5Lq65ZGY5bGV56S65Yy655qE5aSN6YCJ5qGG5Y+W5raI5Yu+6YCJ5pe26Kem5Y+R6YC76L6RXHJcbiAgICAgICAqIEBwYXJhbSAkZXZlbnRcclxuICAgICAgICogQHJldHVybnNcclxuICAgICAgICovXHJcbiAgICBvbkJlZm9yZVVuY2hlY2sgPSAoJGV2ZW50KSA9PiB7XHJcbiAgICAgICAgdGhpcy5zZWxlY3Rpb25zLmZvckVhY2goKHNlbGVjdGlvbiwgaW5kZXgpID0+IHtcclxuICAgICAgICAgICAgaWYgKCRldmVudC5yb3dEYXRhW1wiaWRcIl0gPT09IHNlbGVjdGlvbltcImlkXCJdKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGlvbnMuc3BsaWNlKGluZGV4LCAxKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgbGV0IGVtaXRvamIgPSB7XHJcbiAgICAgICAgICAgIGl0ZW1zOiB0aGlzLml0ZW1zUXVpY2ssXHJcbiAgICAgICAgICAgIHBhZ2VJbmRleDogdGhpcy5wYWdlSW5kZXhRdWljayxcclxuICAgICAgICAgICAgcGFnZVNpemU6IHRoaXMucGFnZVNpemVRdWljayxcclxuICAgICAgICAgICAgcGFnZVRvdGFsOiB0aGlzLnBhZ2VUb3RhbFF1aWNrLFxyXG4gICAgICAgICAgICBwYWdlVG90YWxBbGw6IHRoaXMucGFnZVRvdGFsQWxsUXVpY2ssXHJcbiAgICAgICAgICAgIHVuU2VsZWN0ZWRMaXN0OiB0aGlzLnVuU2VsZWN0ZWRMaXN0UXVpY2tcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5pc0FsbFNlbGVjdC5lbWl0KGVtaXRvamIpO1xyXG4gICAgICAgIHJldHVybiBvZih0cnVlKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAgICog6YCJ5Lit5bm25o+S5YWl5b2T5YmN6KGM5pWw5o2u5Yiw5Y+z5L6nXHJcbiAgICAgICAqIEBwYXJhbSBkYXRhIOW9k+WJjeihjOeahOaVsOaNrlxyXG4gICAgICAgKiBAcGFyYW0gY29sbGVjdGlvbiDmmoLlrZjlvZPliY3mlbDmja7nmoTpm4blkIhcclxuICAgICAgICovXHJcbiAgICBfaW5zZXJ0T25lSW50b1NlbGVjdGlvbnMoZGF0YTogYW55KSB7XHJcbiAgICAgICAgbGV0IGNvbGxlY3Rpb246IGFueVtdID0gW107XHJcbiAgICAgICAgLy8g5aaC5p6c5b2T5YmN5pWw5o2u5bey57uP56e75YWl5Y+z5L6n5pWw5o2u77yM5YiZ6L+U5Zue44CCXHJcbiAgICAgICAgaWYgKHRoaXMuX2lzSW5BcnJheShkYXRhW1wiaWRcIl0sIFwiaWRcIiwgdGhpcy5zZWxlY3Rpb25zKSkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbGxlY3Rpb24ucHVzaChkYXRhKVxyXG4gICAgICAgIHRoaXMuX2luc2VydFNvbWVJbnRvU2VsZWN0aW9ucyhjb2xsZWN0aW9uKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAgICAgKiDliKTmlq3mmK/lkKblnKjlhoVcclxuICAgICAgICAgKiBAcGFyYW0gdmFsdWVcclxuICAgICAgICAgKiBAcGFyYW0gZmllbGRcclxuICAgICAgICAgKiBAcGFyYW0gYXJyYXlcclxuICAgICAgICAgKiBAcmV0dXJuc1xyXG4gICAgICAgICAqL1xyXG4gICAgX2lzSW5BcnJheSh2YWx1ZTogc3RyaW5nLCBmaWVsZDogc3RyaW5nLCBhcnJheTogYW55W10pIHtcclxuICAgICAgICBpZiAoIWZpZWxkIHx8ICF2YWx1ZSkge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ+WJjTLkuKrlj4LmlbDlv4XloasnKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGFycmF5LmZpbmQoaXRlbSA9PiB2YWx1ZSA9PT0gaXRlbVtmaWVsZF0pID8gdHJ1ZSA6IGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIF9pbnNlcnRTb21lSW50b1NlbGVjdGlvbnModXNlckFycmF5OiBhbnlbXSkge1xyXG4gICAgICAgIHVzZXJBcnJheS5mb3JFYWNoKHVzZXIgPT4ge1xyXG4gICAgICAgICAgICBpZiAoIXRoaXMuX2lzSW5BcnJheSh1c2VyW1wiaWRcIl0sIFwiaWRcIiwgdGhpcy5zZWxlY3Rpb25zKSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3Rpb25zLnB1c2godXNlcik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KVxyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICAgICAqIOe/u+mhteajgOafpe+8muS6uuWRmOWxleekuuWMuueahOWLvumAieeKtuaAgeS4juW3sumAieS6uuWRmOWMuuaYr+WQpuWvueW6lFxyXG4gICAgICAgICAqL1xyXG4gICAgcGFnZUNoYW5nZUNoZWNrKCkge1xyXG4gICAgICAgIGlmICh0aGlzLnVuU2VsZWN0ZWRMaXN0UXVpY2spIHtcclxuICAgICAgICAgICAgdGhpcy51blNlbGVjdGVkTGlzdFF1aWNrLmZvckVhY2goaXRlbSA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5faXNJbkFycmF5KGl0ZW0uaWQsIFwiaWRcIiwgdGhpcy5zZWxlY3Rpb25zKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucXVpY2tJbnB1dERhdGFncmlkLmNoZWNrUm93KGl0ZW0uaWQpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnF1aWNrSW5wdXREYXRhZ3JpZC51bkNoZWNrUm93KGl0ZW0uaWQpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG5cclxufVxyXG4iXX0=