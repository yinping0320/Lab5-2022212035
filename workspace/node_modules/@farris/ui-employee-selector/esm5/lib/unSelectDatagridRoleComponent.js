/**
 * @fileoverview added by tsickle
 * Generated from: lib/unSelectDatagridRoleComponent.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, Input, EventEmitter, Output, ViewChild } from "@angular/core";
import { ApiLocalService } from "../utils/api-service";
import { DatagridComponent } from "@farris/ui-datagrid";
import { of } from 'rxjs';
// 兼容保留，该组件无用
var unSelectDatagridRoleComponent = /** @class */ (function () {
    function unSelectDatagridRoleComponent(ApiLocalService) {
        var _this = this;
        this.ApiLocalService = ApiLocalService;
        this.isAllSelect = new EventEmitter();
        /**
         * 人员展示区的复选框取消勾选时触发逻辑
         * @param $event
         * @return
         */
        this.onBeforeUncheck = (/**
         * @param {?} $event
         * @return {?}
         */
        function ($event) {
            _this.selections.forEach((/**
             * @param {?} selection
             * @param {?} index
             * @return {?}
             */
            function (selection, index) {
                if ($event.rowData["id"] === selection["id"]) {
                    _this.selections.splice(index, 1);
                }
            }));
            /** @type {?} */
            var emitojb = {
                itemsRole: _this.itemsRole,
                pageIndexRole: _this.pageIndexRole,
                pageSizeRole: _this.pageSizeRole,
                pageTotalRole: _this.pageTotalRole,
                pageTotalAllRole: _this.pageTotalAllRole,
                unSelectedListRole: _this.unSelectedListRole
            };
            _this.isAllSelect.emit(emitojb);
            return of(true);
        });
    }
    /**
     * @return {?}
     */
    unSelectDatagridRoleComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        this.unSelectDatagridRole.loadData(this.itemsRole);
    };
    /**
     * @return {?}
     */
    unSelectDatagridRoleComponent.prototype.ngAfterViewInit = /**
     * @return {?}
     */
    function () {
        this.pageChangeCheck();
    };
    /**
     * 下级组织展示区datagrid用于数据加载
     */
    /**
     * 下级组织展示区datagrid用于数据加载
     * @return {?}
     */
    unSelectDatagridRoleComponent.prototype.unSelectedListRoleLoad = /**
     * 下级组织展示区datagrid用于数据加载
     * @return {?}
     */
    function () {
        var _this = this;
        this.itemsRole = [];
        this.unSelectedListRole.forEach((/**
         * @param {?} res
         * @return {?}
         */
        function (res) {
            /** @type {?} */
            var name = res.nameChs;
            _this.itemsRole.push({ "displayname": name, "id": res.id, "organizationName": res.remark, "userTotal": res.userTotal, "userInFo": res.userInfo, "userList": res.userList });
        }));
        this.unSelectDatagridRole.loadData(this.itemsRole);
        this.pageChangeCheck();
        /** @type {?} */
        var emitojb = {
            itemsRole: this.itemsRole,
            pageIndexRole: this.pageIndexRole,
            pageSizeRole: this.pageSizeRole,
            pageTotalRole: this.pageTotalRole,
            pageTotalAllRole: this.pageTotalAllRole,
            unSelectedListRole: this.unSelectedListRole
        };
        this.isAllSelect.emit(emitojb);
    };
    /**
       * 当前行选中
       * @param data 当前行的数据（）
       */
    /**
     * 当前行选中
     * @param {?} data 当前行的数据（）
     * @return {?}
     */
    unSelectDatagridRoleComponent.prototype.selectLine = /**
     * 当前行选中
     * @param {?} data 当前行的数据（）
     * @return {?}
     */
    function (data) {
        if (this.isSingleCheck) {
            if (this.selections.length == 0) {
                this._insertOneIntoSelections(data.data);
            }
            else if (this.selections.length >= 1) {
                alert(this.noSelectToRight);
            }
        }
        else {
            this._insertOneIntoSelections(data.data);
        }
        /** @type {?} */
        var emitojb = {
            itemsRole: this.itemsRole,
            pageIndexRole: this.pageIndexRole,
            pageSizeRole: this.pageSizeRole,
            pageTotalRole: this.pageTotalRole,
            pageTotalAllRole: this.pageTotalAllRole,
            unSelectedListRole: this.unSelectedListRole
        };
        this.isAllSelect.emit(emitojb);
    };
    //人员展示翻页触发查询（！）
    //人员展示翻页触发查询（！）
    /**
     * @param {?} size
     * @return {?}
     */
    unSelectDatagridRoleComponent.prototype.switchPage = 
    //人员展示翻页触发查询（！）
    /**
     * @param {?} size
     * @return {?}
     */
    function (size) {
        this.pageIndexRole = size.pageIndex;
        // if (this.searchPage) {
        //     let isChinese: number;
        //     if (/^[\u4e00-\u9fa5]+$/i.test(this.searchText)) {
        //         isChinese = 0;
        //     } else if (!(/^[\u4e00-\u9fa5]+$/i.test(this.searchText)) && !(escape(this.searchText).indexOf("%u") < 0)) {
        //         alert("输入框禁止同时输入汉字和拼音！")
        //     } else {
        //         isChinese = 1;
        //     }
        //     this.ApiLocalService.getPersonnelForUserName(this.pageSize, this.pageIndex, this.searchText, isChinese, this.isContain, this.path, this.isenabled).subscribe((res: any) => {
        //       this.unSelectedLists = res;
        //       var linshi: any = this.unSelectedLists;
        //       this.unSelectedList = linshi.data;
        //       this.pageTotalAll = linshi.total;
        //       this.pageTotal = Math.ceil(this.pageTotalAll / this.pageSize);
        //       if (this.pageTotal == 0) {
        //         this.pageTotal = 1;
        //       }
        //       this.unSelectedListLoad();
        //     });
        // } else {
        if (this.isLoadOutData) {
            //console.log("暂未开启")
        }
        else {
        }
        // }
    };
    /**
       * 选中并插入当前行数据到右侧
       * @param data 当前行的数据
       * @param collection 暂存当前数据的集合
       */
    /**
     * 选中并插入当前行数据到右侧
     * @param {?} data 当前行的数据
     * @return {?}
     */
    unSelectDatagridRoleComponent.prototype._insertOneIntoSelections = /**
     * 选中并插入当前行数据到右侧
     * @param {?} data 当前行的数据
     * @return {?}
     */
    function (data) {
        /** @type {?} */
        var collection = [];
        // 如果当前数据已经移入右侧数据，则返回。
        if (this._isInArray(data["id"], "id", this.selections)) {
            return;
        }
        collection.push(data);
        this._insertSomeIntoSelections(collection);
    };
    /**
         * 判断是否在内
         * @param value
         * @param field
         * @param array
         * @returns
         */
    /**
     * 判断是否在内
     * @param {?} value
     * @param {?} field
     * @param {?} array
     * @return {?}
     */
    unSelectDatagridRoleComponent.prototype._isInArray = /**
     * 判断是否在内
     * @param {?} value
     * @param {?} field
     * @param {?} array
     * @return {?}
     */
    function (value, field, array) {
        if (!field || !value) {
            throw new Error('前2个参数必填');
        }
        return array.find((/**
         * @param {?} item
         * @return {?}
         */
        function (item) { return value === item[field]; })) ? true : false;
    };
    /**
     * @param {?} userArray
     * @return {?}
     */
    unSelectDatagridRoleComponent.prototype._insertSomeIntoSelections = /**
     * @param {?} userArray
     * @return {?}
     */
    function (userArray) {
        var _this = this;
        userArray.forEach((/**
         * @param {?} user
         * @return {?}
         */
        function (user) {
            if (!_this._isInArray(user["id"], "id", _this.selections)) {
                _this.selections.push(user);
            }
        }));
    };
    /**
         * 翻页检查：人员展示区的勾选状态与已选人员区是否对应
         */
    /**
     * 翻页检查：人员展示区的勾选状态与已选人员区是否对应
     * @return {?}
     */
    unSelectDatagridRoleComponent.prototype.pageChangeCheck = /**
     * 翻页检查：人员展示区的勾选状态与已选人员区是否对应
     * @return {?}
     */
    function () {
        var _this = this;
        if (this.unSelectedListRole) {
            this.unSelectedListRole.forEach((/**
             * @param {?} item
             * @return {?}
             */
            function (item) {
                if (_this._isInArray(item.id, "id", _this.selections)) {
                    _this.unSelectDatagridRole.checkRow(item.id);
                }
                else {
                    _this.unSelectDatagridRole.unCheckRow(item.id);
                }
            }));
        }
    };
    unSelectDatagridRoleComponent.decorators = [
        { type: Component, args: [{
                    template: "<farris-datagrid #unSelectDatagridRole class=\"s-unSelectDatagrid\" [pagerViewMode]=\"'simple'\" [showCheckbox]=\"true\" [checkOnSelect]=\"true\"\n[selectOnCheck]=\"true\" [multiSelect]=\"true\" [columns]=\"columnsRole\" [data]=\"itemsRole\"\n[enableSelectRow]=\"true\" [showHeader]=\"false\" [fitColumns]=\"true\" [height]=\"370\"\n[showBorder]=\"false\" [striped]=\"false\" [fit]=\"true\" [showPageNumber]=\"false\"\n[pageIndex]=\"pageIndexRole\" [pageSize]=\"pageSizeRole\" [total]=\"pageTotalAllRole\"\n(checked)=\"selectLine($event)\" (pageChanged)=\"switchPage($event)\"\n[beforeUncheck]=\"onBeforeUncheck\">\n</farris-datagrid>"
                }] }
    ];
    /** @nocollapse */
    unSelectDatagridRoleComponent.ctorParameters = function () { return [
        { type: ApiLocalService }
    ]; };
    unSelectDatagridRoleComponent.propDecorators = {
        unSelectDatagridRole: [{ type: ViewChild, args: ['unSelectDatagridRole',] }],
        columnsRole: [{ type: Input }],
        itemsRole: [{ type: Input }],
        pageIndexRole: [{ type: Input }],
        pageSizeRole: [{ type: Input }],
        pageTotalAllRole: [{ type: Input }],
        pathRole: [{ type: Input }],
        orgIdRole: [{ type: Input }],
        isContainRole: [{ type: Input }],
        pageTotalRole: [{ type: Input }],
        isSingleCheck: [{ type: Input }],
        selections: [{ type: Input }],
        noSelectToRight: [{ type: Input }],
        searchText: [{ type: Input }],
        isLoadOutData: [{ type: Input }],
        unSelectedRoleLists: [{ type: Input }],
        unSelectedListRole: [{ type: Input }],
        organizationList: [{ type: Input }],
        type: [{ type: Input }],
        listIdField: [{ type: Input }],
        searchPage: [{ type: Input }],
        isenabled: [{ type: Input }],
        isExcludeMe: [{ type: Input }],
        isAllSelect: [{ type: Output }]
    };
    return unSelectDatagridRoleComponent;
}());
export { unSelectDatagridRoleComponent };
if (false) {
    /** @type {?} */
    unSelectDatagridRoleComponent.prototype.unSelectDatagridRole;
    /** @type {?} */
    unSelectDatagridRoleComponent.prototype.columnsRole;
    /** @type {?} */
    unSelectDatagridRoleComponent.prototype.itemsRole;
    /** @type {?} */
    unSelectDatagridRoleComponent.prototype.pageIndexRole;
    /** @type {?} */
    unSelectDatagridRoleComponent.prototype.pageSizeRole;
    /** @type {?} */
    unSelectDatagridRoleComponent.prototype.pageTotalAllRole;
    /** @type {?} */
    unSelectDatagridRoleComponent.prototype.pathRole;
    /** @type {?} */
    unSelectDatagridRoleComponent.prototype.orgIdRole;
    /** @type {?} */
    unSelectDatagridRoleComponent.prototype.isContainRole;
    /** @type {?} */
    unSelectDatagridRoleComponent.prototype.pageTotalRole;
    /** @type {?} */
    unSelectDatagridRoleComponent.prototype.isSingleCheck;
    /** @type {?} */
    unSelectDatagridRoleComponent.prototype.selections;
    /** @type {?} */
    unSelectDatagridRoleComponent.prototype.noSelectToRight;
    /** @type {?} */
    unSelectDatagridRoleComponent.prototype.searchText;
    /** @type {?} */
    unSelectDatagridRoleComponent.prototype.isLoadOutData;
    /** @type {?} */
    unSelectDatagridRoleComponent.prototype.unSelectedRoleLists;
    /** @type {?} */
    unSelectDatagridRoleComponent.prototype.unSelectedListRole;
    /** @type {?} */
    unSelectDatagridRoleComponent.prototype.organizationList;
    /** @type {?} */
    unSelectDatagridRoleComponent.prototype.type;
    /** @type {?} */
    unSelectDatagridRoleComponent.prototype.listIdField;
    /** @type {?} */
    unSelectDatagridRoleComponent.prototype.searchPage;
    /** @type {?} */
    unSelectDatagridRoleComponent.prototype.isenabled;
    /** @type {?} */
    unSelectDatagridRoleComponent.prototype.isExcludeMe;
    /** @type {?} */
    unSelectDatagridRoleComponent.prototype.isAllSelect;
    /**
     * 人员展示区的复选框取消勾选时触发逻辑
     * \@param $event
     * \@return
     * @type {?}
     */
    unSelectDatagridRoleComponent.prototype.onBeforeUncheck;
    /**
     * @type {?}
     * @private
     */
    unSelectDatagridRoleComponent.prototype.ApiLocalService;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidW5TZWxlY3REYXRhZ3JpZFJvbGVDb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZmFycmlzL3VpLWVtcGxveWVlLXNlbGVjdG9yLyIsInNvdXJjZXMiOlsibGliL3VuU2VsZWN0RGF0YWdyaWRSb2xlQ29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7O0FBQUEsT0FBTyxFQUFFLFNBQVMsRUFBRSxLQUFLLEVBQUUsWUFBWSxFQUFFLE1BQU0sRUFBRSxTQUFTLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFDbEYsT0FBTyxFQUFFLGVBQWUsRUFBRSxNQUFNLHNCQUFzQixDQUFDO0FBQ3ZELE9BQU8sRUFBRSxpQkFBaUIsRUFBRSxNQUFNLHFCQUFxQixDQUFDO0FBQ3hELE9BQU8sRUFBRSxFQUFFLEVBQUUsTUFBTSxNQUFNLENBQUM7O0FBRzFCO0lBd0NJLHVDQUNZLGVBQWdDO1FBRDVDLGlCQUVLO1FBRE8sb0JBQWUsR0FBZixlQUFlLENBQWlCO1FBSmxDLGdCQUFXLEdBQUcsSUFBSSxZQUFZLEVBQU8sQ0FBQzs7Ozs7O1FBbUdoRCxvQkFBZTs7OztRQUFHLFVBQUMsTUFBTTtZQUNyQixLQUFJLENBQUMsVUFBVSxDQUFDLE9BQU87Ozs7O1lBQUMsVUFBQyxTQUFTLEVBQUUsS0FBSztnQkFDckMsSUFBSSxNQUFNLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxLQUFLLFNBQVMsQ0FBQyxJQUFJLENBQUMsRUFBRTtvQkFDMUMsS0FBSSxDQUFDLFVBQVUsQ0FBQyxNQUFNLENBQUMsS0FBSyxFQUFFLENBQUMsQ0FBQyxDQUFDO2lCQUNwQztZQUNMLENBQUMsRUFBQyxDQUFBOztnQkFDRSxPQUFPLEdBQUc7Z0JBQ1YsU0FBUyxFQUFFLEtBQUksQ0FBQyxTQUFTO2dCQUN6QixhQUFhLEVBQUUsS0FBSSxDQUFDLGFBQWE7Z0JBQ2pDLFlBQVksRUFBRSxLQUFJLENBQUMsWUFBWTtnQkFDL0IsYUFBYSxFQUFFLEtBQUksQ0FBQyxhQUFhO2dCQUNq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QUFLOzJCQUNMLEtBQUs7NEJBQ0wsS0FBSztnQ0FDTCxLQUFLO2dDQUNMLEtBQUs7Z0NBQ0wsS0FBSzs2QkFDTCxLQUFLO2tDQUNMLEtBQUs7NkJBQ0wsS0FBSztnQ0FDTCxLQUFLO3NDQUNMLEtBQUs7cUNBQ0wsS0FBSzttQ0FDTCxLQUFLO3VCQUNMLEtBQUs7OEJBQ0wsS0FBSzs2QkFDTCxLQUFLOzRCQUNMLEtBQUs7OEJBQ0wsS0FBSzs4QkFDTCxNQUFNOztJQTBLWCxvQ0FBQztDQUFBLEFBL01ELElBK01DO1NBcE1ZLDZCQUE2Qjs7O0lBRXRDLDZEQUEyRTs7SUFFM0Usb0RBQXlCOztJQUN6QixrREFBdUI7O0lBQ3ZCLHNEQUEyQjs7SUFDM0IscURBQTBCOztJQUMxQix5REFBOEI7O0lBQzlCLGlEQUFzQjs7SUFDdEIsa0RBQXVCOztJQUN2QixzREFBMkI7O0lBQzNCLHNEQUEyQjs7SUFDM0Isc0RBQTJCOztJQUMzQixtREFBd0I7O0lBQ3hCLHdEQUE2Qjs7SUFDN0IsbURBQXdCOztJQUN4QixzREFBMkI7O0lBQzNCLDREQUFpQzs7SUFDakMsMkRBQWdDOztJQUNoQyx5REFBOEI7O0lBQzlCLDZDQUFrQjs7SUFDbEIsb0RBQTRCOztJQUM1QixtREFBNkI7O0lBQzdCLGtEQUEyQjs7SUFDM0Isb0RBQTZCOztJQUM3QixvREFBZ0Q7Ozs7Ozs7SUFtR2hELHdEQWdCQzs7Ozs7SUEvR0csd0RBQXdDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ29tcG9uZW50LCBJbnB1dCwgRXZlbnRFbWl0dGVyLCBPdXRwdXQsIFZpZXdDaGlsZCB9IGZyb20gXCJAYW5ndWxhci9jb3JlXCI7XHJcbmltcG9ydCB7IEFwaUxvY2FsU2VydmljZSB9IGZyb20gXCIuLi91dGlscy9hcGktc2VydmljZVwiO1xyXG5pbXBvcnQgeyBEYXRhZ3JpZENvbXBvbmVudCB9IGZyb20gXCJAZmFycmlzL3VpLWRhdGFncmlkXCI7XHJcbmltcG9ydCB7IG9mIH0gZnJvbSAncnhqcyc7XHJcblxyXG4vLyDlhbzlrrnkv53nlZnvvIzor6Xnu4Tku7bml6DnlKhcclxuQENvbXBvbmVudCh7XHJcbiAgICB0ZW1wbGF0ZTogYDxmYXJyaXMtZGF0YWdyaWQgI3VuU2VsZWN0RGF0YWdyaWRSb2xlIGNsYXNzPVwicy11blNlbGVjdERhdGFncmlkXCIgW3BhZ2VyVmlld01vZGVdPVwiJ3NpbXBsZSdcIiBbc2hvd0NoZWNrYm94XT1cInRydWVcIiBbY2hlY2tPblNlbGVjdF09XCJ0cnVlXCJcclxuW3NlbGVjdE9uQ2hlY2tdPVwidHJ1ZVwiIFttdWx0aVNlbGVjdF09XCJ0cnVlXCIgW2NvbHVtbnNdPVwiY29sdW1uc1JvbGVcIiBbZGF0YV09XCJpdGVtc1JvbGVcIlxyXG5bZW5hYmxlU2VsZWN0Um93XT1cInRydWVcIiBbc2hvd0hlYWRlcl09XCJmYWxzZVwiIFtmaXRDb2x1bW5zXT1cInRydWVcIiBbaGVpZ2h0XT1cIjM3MFwiXHJcbltzaG93Qm9yZGVyXT1cImZhbHNlXCIgW3N0cmlwZWRdPVwiZmFsc2VcIiBbZml0XT1cInRydWVcIiBbc2hvd1BhZ2VOdW1iZXJdPVwiZmFsc2VcIlxyXG5bcGFnZUluZGV4XT1cInBhZ2VJbmRleFJvbGVcIiBbcGFnZVNpemVdPVwicGFnZVNpemVSb2xlXCIgW3RvdGFsXT1cInBhZ2VUb3RhbEFsbFJvbGVcIlxyXG4oY2hlY2tlZCk9XCJzZWxlY3RMaW5lKCRldmVudClcIiAocGFnZUNoYW5nZWQpPVwic3dpdGNoUGFnZSgkZXZlbnQpXCJcclxuW2JlZm9yZVVuY2hlY2tdPVwib25CZWZvcmVVbmNoZWNrXCI+XHJcbjwvZmFycmlzLWRhdGFncmlkPmBcclxufSlcclxuXHJcbmV4cG9ydCBjbGFzcyB1blNlbGVjdERhdGFncmlkUm9sZUNvbXBvbmVudCB7XHJcblxyXG4gICAgQFZpZXdDaGlsZCgndW5TZWxlY3REYXRhZ3JpZFJvbGUnKSB1blNlbGVjdERhdGFncmlkUm9sZTogRGF0YWdyaWRDb21wb25lbnQ7XHJcblxyXG4gICAgQElucHV0KCkgY29sdW1uc1JvbGU6IGFueVxyXG4gICAgQElucHV0KCkgaXRlbXNSb2xlOiBhbnlcclxuICAgIEBJbnB1dCgpIHBhZ2VJbmRleFJvbGU6IGFueVxyXG4gICAgQElucHV0KCkgcGFnZVNpemVSb2xlOiBhbnlcclxuICAgIEBJbnB1dCgpIHBhZ2VUb3RhbEFsbFJvbGU6IGFueVxyXG4gICAgQElucHV0KCkgcGF0aFJvbGU6IGFueVxyXG4gICAgQElucHV0KCkgb3JnSWRSb2xlOiBhbnlcclxuICAgIEBJbnB1dCgpIGlzQ29udGFpblJvbGU6IGFueVxyXG4gICAgQElucHV0KCkgcGFnZVRvdGFsUm9sZTogYW55XHJcbiAgICBASW5wdXQoKSBpc1NpbmdsZUNoZWNrOiBhbnlcclxuICAgIEBJbnB1dCgpIHNlbGVjdGlvbnM6IGFueVxyXG4gICAgQElucHV0KCkgbm9TZWxlY3RUb1JpZ2h0OiBhbnlcclxuICAgIEBJbnB1dCgpIHNlYXJjaFRleHQ6IGFueVxyXG4gICAgQElucHV0KCkgaXNMb2FkT3V0RGF0YTogYW55XHJcbiAgICBASW5wdXQoKSB1blNlbGVjdGVkUm9sZUxpc3RzOiBhbnlcclxuICAgIEBJbnB1dCgpIHVuU2VsZWN0ZWRMaXN0Um9sZTogYW55XHJcbiAgICBASW5wdXQoKSBvcmdhbml6YXRpb25MaXN0OiBhbnlcclxuICAgIEBJbnB1dCgpIHR5cGU6IGFueVxyXG4gICAgQElucHV0KCkgbGlzdElkRmllbGQ6IHN0cmluZ1xyXG4gICAgQElucHV0KCkgc2VhcmNoUGFnZTogYm9vbGVhbjtcclxuICAgIEBJbnB1dCgpIGlzZW5hYmxlZDogbnVtYmVyO1xyXG4gICAgQElucHV0KCkgaXNFeGNsdWRlTWU6IG51bWJlcjtcclxuICAgIEBPdXRwdXQoKSBpc0FsbFNlbGVjdCA9IG5ldyBFdmVudEVtaXR0ZXI8YW55PigpO1xyXG5cclxuXHJcbiAgICBjb25zdHJ1Y3RvcihcclxuICAgICAgICBwcml2YXRlIEFwaUxvY2FsU2VydmljZTogQXBpTG9jYWxTZXJ2aWNlLFxyXG4gICAgKSB7IH1cclxuXHJcbiAgICBuZ09uSW5pdCgpOiB2b2lkIHtcclxuICAgICAgICB0aGlzLnVuU2VsZWN0RGF0YWdyaWRSb2xlLmxvYWREYXRhKHRoaXMuaXRlbXNSb2xlKTtcclxuICAgIH1cclxuXHJcbiAgICBuZ0FmdGVyVmlld0luaXQoKTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy5wYWdlQ2hhbmdlQ2hlY2soKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOS4i+e6p+e7hOe7h+WxleekuuWMumRhdGFncmlk55So5LqO5pWw5o2u5Yqg6L29XHJcbiAgICAgKi9cclxuICAgIHVuU2VsZWN0ZWRMaXN0Um9sZUxvYWQoKSB7XHJcbiAgICAgICAgdGhpcy5pdGVtc1JvbGUgPSBbXTtcclxuICAgICAgICB0aGlzLnVuU2VsZWN0ZWRMaXN0Um9sZS5mb3JFYWNoKHJlcyA9PiB7XHJcbiAgICAgICAgICAgIGxldCBuYW1lID0gcmVzLm5hbWVDaHM7XHJcbiAgICAgICAgICAgIHRoaXMuaXRlbXNSb2xlLnB1c2goeyBcImRpc3BsYXluYW1lXCI6IG5hbWUsIFwiaWRcIjogcmVzLmlkLCBcIm9yZ2FuaXphdGlvbk5hbWVcIjogcmVzLnJlbWFyaywgXCJ1c2VyVG90YWxcIjogcmVzLnVzZXJUb3RhbCwgXCJ1c2VySW5Gb1wiOiByZXMudXNlckluZm8sIFwidXNlckxpc3RcIjogcmVzLnVzZXJMaXN0IH0pXHJcbiAgICAgICAgfSlcclxuICAgICAgICB0aGlzLnVuU2VsZWN0RGF0YWdyaWRSb2xlLmxvYWREYXRhKHRoaXMuaXRlbXNSb2xlKTtcclxuICAgICAgICB0aGlzLnBhZ2VDaGFuZ2VDaGVjaygpO1xyXG4gICAgICAgIGxldCBlbWl0b2piID0ge1xyXG4gICAgICAgICAgICBpdGVtc1JvbGU6IHRoaXMuaXRlbXNSb2xlLFxyXG4gICAgICAgICAgICBwYWdlSW5kZXhSb2xlOiB0aGlzLnBhZ2VJbmRleFJvbGUsXHJcbiAgICAgICAgICAgIHBhZ2VTaXplUm9sZTogdGhpcy5wYWdlU2l6ZVJvbGUsXHJcbiAgICAgICAgICAgIHBhZ2VUb3RhbFJvbGU6IHRoaXMucGFnZVRvdGFsUm9sZSxcclxuICAgICAgICAgICAgcGFnZVRvdGFsQWxsUm9sZTogdGhpcy5wYWdlVG90YWxBbGxSb2xlLFxyXG4gICAgICAgICAgICB1blNlbGVjdGVkTGlzdFJvbGU6IHRoaXMudW5TZWxlY3RlZExpc3RSb2xlXHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuaXNBbGxTZWxlY3QuZW1pdChlbWl0b2piKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAgICog5b2T5YmN6KGM6YCJ5LitXHJcbiAgICAgICAqIEBwYXJhbSBkYXRhIOW9k+WJjeihjOeahOaVsOaNru+8iO+8iVxyXG4gICAgICAgKi9cclxuICAgIHNlbGVjdExpbmUoZGF0YTogYW55KSB7XHJcbiAgICAgICAgaWYgKHRoaXMuaXNTaW5nbGVDaGVjaykge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5zZWxlY3Rpb25zLmxlbmd0aCA9PSAwKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9pbnNlcnRPbmVJbnRvU2VsZWN0aW9ucyhkYXRhLmRhdGEpO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMuc2VsZWN0aW9ucy5sZW5ndGggPj0gMSkge1xyXG4gICAgICAgICAgICAgICAgYWxlcnQodGhpcy5ub1NlbGVjdFRvUmlnaHQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5faW5zZXJ0T25lSW50b1NlbGVjdGlvbnMoZGF0YS5kYXRhKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgbGV0IGVtaXRvamIgPSB7XHJcbiAgICAgICAgICAgIGl0ZW1zUm9sZTogdGhpcy5pdGVtc1JvbGUsXHJcbiAgICAgICAgICAgIHBhZ2VJbmRleFJvbGU6IHRoaXMucGFnZUluZGV4Um9sZSxcclxuICAgICAgICAgICAgcGFnZVNpemVSb2xlOiB0aGlzLnBhZ2VTaXplUm9sZSxcclxuICAgICAgICAgICAgcGFnZVRvdGFsUm9sZTogdGhpcy5wYWdlVG90YWxSb2xlLFxyXG4gICAgICAgICAgICBwYWdlVG90YWxBbGxSb2xlOiB0aGlzLnBhZ2VUb3RhbEFsbFJvbGUsXHJcbiAgICAgICAgICAgIHVuU2VsZWN0ZWRMaXN0Um9sZTogdGhpcy51blNlbGVjdGVkTGlzdFJvbGVcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5pc0FsbFNlbGVjdC5lbWl0KGVtaXRvamIpO1xyXG4gICAgfVxyXG5cclxuICAgIC8v5Lq65ZGY5bGV56S657+76aG16Kem5Y+R5p+l6K+i77yI77yB77yJXHJcbiAgICBzd2l0Y2hQYWdlKHNpemUpIHtcclxuICAgICAgICB0aGlzLnBhZ2VJbmRleFJvbGUgPSBzaXplLnBhZ2VJbmRleDtcclxuICAgICAgICAvLyBpZiAodGhpcy5zZWFyY2hQYWdlKSB7XHJcbiAgICAgICAgLy8gICAgIGxldCBpc0NoaW5lc2U6IG51bWJlcjtcclxuICAgICAgICAvLyAgICAgaWYgKC9eW1xcdTRlMDAtXFx1OWZhNV0rJC9pLnRlc3QodGhpcy5zZWFyY2hUZXh0KSkge1xyXG4gICAgICAgIC8vICAgICAgICAgaXNDaGluZXNlID0gMDtcclxuICAgICAgICAvLyAgICAgfSBlbHNlIGlmICghKC9eW1xcdTRlMDAtXFx1OWZhNV0rJC9pLnRlc3QodGhpcy5zZWFyY2hUZXh0KSkgJiYgIShlc2NhcGUodGhpcy5zZWFyY2hUZXh0KS5pbmRleE9mKFwiJXVcIikgPCAwKSkge1xyXG4gICAgICAgIC8vICAgICAgICAgYWxlcnQoXCLovpPlhaXmoYbnpoHmraLlkIzml7bovpPlhaXmsYnlrZflkozmi7zpn7PvvIFcIilcclxuICAgICAgICAvLyAgICAgfSBlbHNlIHtcclxuICAgICAgICAvLyAgICAgICAgIGlzQ2hpbmVzZSA9IDE7XHJcbiAgICAgICAgLy8gICAgIH1cclxuICAgICAgICAvLyAgICAgdGhpcy5BcGlMb2NhbFNlcnZpY2UuZ2V0UGVyc29ubmVsRm9yVXNlck5hbWUodGhpcy5wYWdlU2l6ZSwgdGhpcy5wYWdlSW5kZXgsIHRoaXMuc2VhcmNoVGV4dCwgaXNDaGluZXNlLCB0aGlzLmlzQ29udGFpbiwgdGhpcy5wYXRoLCB0aGlzLmlzZW5hYmxlZCkuc3Vic2NyaWJlKChyZXM6IGFueSkgPT4ge1xyXG4gICAgICAgIC8vICAgICAgIHRoaXMudW5TZWxlY3RlZExpc3RzID0gcmVzO1xyXG4gICAgICAgIC8vICAgICAgIHZhciBsaW5zaGk6IGFueSA9IHRoaXMudW5TZWxlY3RlZExpc3RzO1xyXG4gICAgICAgIC8vICAgICAgIHRoaXMudW5TZWxlY3RlZExpc3QgPSBsaW5zaGkuZGF0YTtcclxuICAgICAgICAvLyAgICAgICB0aGlzLnBhZ2VUb3RhbEFsbCA9IGxpbnNoaS50b3RhbDtcclxuICAgICAgICAvLyAgICAgICB0aGlzLnBhZ2VUb3RhbCA9IE1hdGguY2VpbCh0aGlzLnBhZ2VUb3RhbEFsbCAvIHRoaXMucGFnZVNpemUpO1xyXG4gICAgICAgIC8vICAgICAgIGlmICh0aGlzLnBhZ2VUb3RhbCA9PSAwKSB7XHJcbiAgICAgICAgLy8gICAgICAgICB0aGlzLnBhZ2VUb3RhbCA9IDE7XHJcbiAgICAgICAgLy8gICAgICAgfVxyXG4gICAgICAgIC8vICAgICAgIHRoaXMudW5TZWxlY3RlZExpc3RMb2FkKCk7XHJcbiAgICAgICAgLy8gICAgIH0pO1xyXG4gICAgICAgIC8vIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmlzTG9hZE91dERhdGEpIHtcclxuICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coXCLmmoLmnKrlvIDlkK9cIilcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAvLyB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgICAqIOS6uuWRmOWxleekuuWMuueahOWkjemAieahhuWPlua2iOWLvumAieaXtuinpuWPkemAu+i+kVxyXG4gICAgICAgKiBAcGFyYW0gJGV2ZW50XHJcbiAgICAgICAqIEByZXR1cm5zXHJcbiAgICAgICAqL1xyXG4gICAgb25CZWZvcmVVbmNoZWNrID0gKCRldmVudCkgPT4ge1xyXG4gICAgICAgIHRoaXMuc2VsZWN0aW9ucy5mb3JFYWNoKChzZWxlY3Rpb24sIGluZGV4KSA9PiB7XHJcbiAgICAgICAgICAgIGlmICgkZXZlbnQucm93RGF0YVtcImlkXCJdID09PSBzZWxlY3Rpb25bXCJpZFwiXSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3Rpb25zLnNwbGljZShpbmRleCwgMSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KVxyXG4gICAgICAgIGxldCBlbWl0b2piID0ge1xyXG4gICAgICAgICAgICBpdGVtc1JvbGU6IHRoaXMuaXRlbXNSb2xlLFxyXG4gICAgICAgICAgICBwYWdlSW5kZXhSb2xlOiB0aGlzLnBhZ2VJbmRleFJvbGUsXHJcbiAgICAgICAgICAgIHBhZ2VTaXplUm9sZTogdGhpcy5wYWdlU2l6ZVJvbGUsXHJcbiAgICAgICAgICAgIHBhZ2VUb3RhbFJvbGU6IHRoaXMucGFnZVRvdGFsUm9sZSxcclxuICAgICAgICAgICAgcGFnZVRvdGFsQWxsUm9sZTogdGhpcy5wYWdlVG90YWxBbGxSb2xlLFxyXG4gICAgICAgICAgICB1blNlbGVjdGVkTGlzdFJvbGU6IHRoaXMudW5TZWxlY3RlZExpc3RSb2xlXHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuaXNBbGxTZWxlY3QuZW1pdChlbWl0b2piKTtcclxuICAgICAgICByZXR1cm4gb2YodHJ1ZSk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgICAqIOmAieS4reW5tuaPkuWFpeW9k+WJjeihjOaVsOaNruWIsOWPs+S+p1xyXG4gICAgICAgKiBAcGFyYW0gZGF0YSDlvZPliY3ooYznmoTmlbDmja5cclxuICAgICAgICogQHBhcmFtIGNvbGxlY3Rpb24g5pqC5a2Y5b2T5YmN5pWw5o2u55qE6ZuG5ZCIXHJcbiAgICAgICAqL1xyXG4gICAgX2luc2VydE9uZUludG9TZWxlY3Rpb25zKGRhdGE6IGFueSkge1xyXG4gICAgICAgIGxldCBjb2xsZWN0aW9uOiBhbnlbXSA9IFtdO1xyXG4gICAgICAgIC8vIOWmguaenOW9k+WJjeaVsOaNruW3sue7j+enu+WFpeWPs+S+p+aVsOaNru+8jOWImei/lOWbnuOAglxyXG4gICAgICAgIGlmICh0aGlzLl9pc0luQXJyYXkoZGF0YVtcImlkXCJdLCBcImlkXCIsIHRoaXMuc2VsZWN0aW9ucykpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb2xsZWN0aW9uLnB1c2goZGF0YSlcclxuICAgICAgICB0aGlzLl9pbnNlcnRTb21lSW50b1NlbGVjdGlvbnMoY29sbGVjdGlvbik7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgICAgICog5Yik5pat5piv5ZCm5Zyo5YaFXHJcbiAgICAgICAgICogQHBhcmFtIHZhbHVlXHJcbiAgICAgICAgICogQHBhcmFtIGZpZWxkXHJcbiAgICAgICAgICogQHBhcmFtIGFycmF5XHJcbiAgICAgICAgICogQHJldHVybnNcclxuICAgICAgICAgKi9cclxuICAgIF9pc0luQXJyYXkodmFsdWU6IHN0cmluZywgZmllbGQ6IHN0cmluZywgYXJyYXk6IGFueVtdKSB7XHJcbiAgICAgICAgaWYgKCFmaWVsZCB8fCAhdmFsdWUpIHtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCfliY0y5Liq5Y+C5pWw5b+F5aGrJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBhcnJheS5maW5kKGl0ZW0gPT4gdmFsdWUgPT09IGl0ZW1bZmllbGRdKSA/IHRydWUgOiBmYWxzZTtcclxuICAgIH1cclxuXHJcbiAgICBfaW5zZXJ0U29tZUludG9TZWxlY3Rpb25zKHVzZXJBcnJheTogYW55W10pIHtcclxuICAgICAgICB1c2VyQXJyYXkuZm9yRWFjaCh1c2VyID0+IHtcclxuICAgICAgICAgICAgaWYgKCF0aGlzLl9pc0luQXJyYXkodXNlcltcImlkXCJdLCBcImlkXCIsIHRoaXMuc2VsZWN0aW9ucykpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0aW9ucy5wdXNoKHVzZXIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSlcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAgICAgKiDnv7vpobXmo4Dmn6XvvJrkurrlkZjlsZXnpLrljLrnmoTli77pgInnirbmgIHkuI7lt7LpgInkurrlkZjljLrmmK/lkKblr7nlupRcclxuICAgICAgICAgKi9cclxuICAgIHBhZ2VDaGFuZ2VDaGVjaygpIHtcclxuICAgICAgICBpZiAodGhpcy51blNlbGVjdGVkTGlzdFJvbGUpIHtcclxuICAgICAgICAgICAgdGhpcy51blNlbGVjdGVkTGlzdFJvbGUuZm9yRWFjaChpdGVtID0+IHtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9pc0luQXJyYXkoaXRlbS5pZCwgXCJpZFwiLCB0aGlzLnNlbGVjdGlvbnMpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy51blNlbGVjdERhdGFncmlkUm9sZS5jaGVja1JvdyhpdGVtLmlkKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy51blNlbGVjdERhdGFncmlkUm9sZS51bkNoZWNrUm93KGl0ZW0uaWQpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG5cclxufVxyXG4iXX0=