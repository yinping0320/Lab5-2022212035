/**
 * @fileoverview added by tsickle
 * Generated from: lib/tab-group/group.component.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { ChangeDetectorRef, Component, EventEmitter, Injector, Input, Optional, Output, ViewChild } from '@angular/core';
import * as _ from 'lodash-es';
import { EMPTY, of } from 'rxjs';
import { noDataImg } from '../../assets/resource';
import { ApiService } from '../../utils/api.service';
import { CommonUtil } from '../../utils/common.tool';
import { FavoritesTool } from '../../utils/favorites.tool';
import { ChangeType } from '../../utils/index.type';
import { StateMgrTool } from '../../utils/state.mgr.tool';
import { tap, switchMap } from 'rxjs/operators';
import { AppendGroupOrgComponent } from '../append-group-org/appendorg.component';
import { LoadingService } from '@farris/ui-loading';
import { MessagerService } from '@farris/ui-messager';
import { NotifyService } from '@farris/ui-notify';
import { LocaleService } from '@farris/ui-locale';
import { ORGANIZATION_SELECTOR_LOCALE } from '../../utils/locale';
var GroupComponent = /** @class */ (function () {
    function GroupComponent(apiService, favoritesTool, stateMgr, cdr, injector) {
        this.apiService = apiService;
        this.favoritesTool = favoritesTool;
        this.stateMgr = stateMgr;
        this.cdr = cdr;
        this.injector = injector;
        this.primaryField = 'orgId';
        this.disableOrgList = [];
        this.groupChange = new EventEmitter();
        this.groupIdField = 'id';
        this.userIdField = 'userId';
        this.selections = [];
        this.noDataImg = noDataImg;
        this.allChecked = false;
        this.items = [];
        this.favoritesList = [];
        this.groupData = { public: [], personal: [] };
        this.personnelList = [];
        this.groupPersonnels = [];
        this.publicVisible = true;
        this.personalVisible = true;
        this.publicToken = 'public';
        this.personalToken = 'personal';
        this.showGroupOrgDialog = false;
        this.currentGroupType = 'public';
        this.showCheckAllIcon = true;
        this.messageService = null;
        this.loadingService = null;
        this.notifyService = null;
        this.localeService = null;
        this.allIndexId = CommonUtil.newGuid();
        this.messageService = this.injector.get(MessagerService, null);
        this.loadingService = this.injector.get(LoadingService, null);
        this.notifyService = this.injector.get(NotifyService, null);
        this.localeService = this.injector.get(LocaleService);
        if (!this.localeService.langData['organizationSelector']) {
            this.localeService.setLocaleData(ORGANIZATION_SELECTOR_LOCALE);
        }
    }
    /**
     * @return {?}
     */
    GroupComponent.prototype.ngOnDestroy = /**
     * @return {?}
     */
    function () {
        if (this.enableFavorites) {
            this.favoritesSub.unsubscribe();
        }
        this.selectionsSub.unsubscribe();
    };
    /**
     * @return {?}
     */
    GroupComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        if (this.enableFavorites) {
            this.favoritesSub = this.favoritesTool.favoritesSubject.subscribe((/**
             * @param {?} data
             * @return {?}
             */
            function (data) {
                _this.favoritesList = data;
                _this.setFavorites();
            }));
        }
        this.selectionsSub = this.stateMgr.selectionsSubject.subscribe((/**
         * @param {?} data
         * @return {?}
         */
        function (data) {
            if (data.changeType === ChangeType.ValueChanged) {
                _this.selections = _.cloneDeep(data.value);
            }
            else if (data.changeType === ChangeType.Remove) {
                _this.unSelectLine(data.value);
            }
            else if (data.changeType === ChangeType.Append) {
                _this.selectLine(data.value);
            }
            _this.toggleChecked();
            _this.cdr.detectChanges();
        }));
        if (this.isActiveTab) {
            this.getGroupList();
        }
    };
    /**
     * @return {?}
     */
    GroupComponent.prototype.ngAfterViewInit = /**
     * @return {?}
     */
    function () {
    };
    /**
     * @param {?=} reload
     * @return {?}
     */
    GroupComponent.prototype.assembleData = /**
     * @param {?=} reload
     * @return {?}
     */
    function (reload) {
        if (reload === void 0) { reload = false; }
        if (reload) {
            this.getGroupList();
        }
    };
    // 变更群组内的组织
    // 变更群组内的组织
    /**
     * @return {?}
     */
    GroupComponent.prototype.updateGroup = 
    // 变更群组内的组织
    /**
     * @return {?}
     */
    function () {
        var _this = this;
        /** @type {?} */
        var addList = [];
        /** @type {?} */
        var primaryIds = this.items.map((/**
         * @param {?} item
         * @return {?}
         */
        function (item) { return item[_this.primaryField]; })).join();
        this.appendOrg.currentOrgs.forEach((/**
         * @param {?} org
         * @return {?}
         */
        function (org) {
            if (primaryIds.indexOf(org[_this.primaryField]) === -1) {
                addList.push(org[_this.primaryField]);
            }
        }));
        if ((this.selectedGroupTotal + addList.length) > 1000) {
            this.messageService.show('warning', this.localeService.getValue("organizationSelector.errorMessage.limit"), true);
            this.toggleGroupOrgDialog(false);
            return;
        }
        /** @type {?} */
        var addOrgsInCurrentGroup$ = this.apiService.saveGroup({
            groupId: this.selectedGroupId,
            addIds: addList,
            deleteIds: [],
            changeType: Number(3)
        });
        addOrgsInCurrentGroup$.pipe(tap((/**
         * @param {?} data
         * @return {?}
         */
        function (data) {
            if (data) {
                _this.getOrgsByGroup({ id: _this.selectedGroupId }, _this.currentGroupType, { updateGroup: true });
                _this.toggleGroupOrgDialog(false);
            }
        }), (/**
         * @param {?} error
         * @return {?}
         */
        function (error) {
            _this.messageService.show('error', _this.localeService.getValue("organizationSelector.errorMessage.appendOrganization"), true);
        }))).subscribe();
    };
    // 删除群组
    // 删除群组
    /**
     * @param {?} e
     * @param {?} item
     * @return {?}
     */
    GroupComponent.prototype.deleteGroup = 
    // 删除群组
    /**
     * @param {?} e
     * @param {?} item
     * @return {?}
     */
    function (e, item) {
        var _this = this;
        e.stopPropagation();
        e.cancelBubble = true;
        // 暂时以此方式处理国际化未适配之处（TFS：486401）
        item['title'] = item['title'] ? item['title'] : '';
        this.messageService.confirm(this.localeService.getValue("organizationSelector.confirmMessage.deleteGroup") +
            item['title'] + this.localeService.getValue("organizationSelector.confirmMessage.mark")).pipe(switchMap((/**
         * @param {?} result
         * @return {?}
         */
        function (result) {
            if (!!result) {
                if (item[_this.groupIdField] === _this.selectedGroupId) {
                    _this.selectedGroupId = null;
                    _this.selectedGroupTotal = 0;
                    _this.currentGroupType = _this.publicToken;
                }
                /** @type {?} */
                var deleteGroup$ = _this.apiService.saveGroup({
                    groupId: item[_this.groupIdField],
                    changeType: Number(4)
                });
                return deleteGroup$.pipe(tap((/**
                 * @param {?} data
                 * @return {?}
                 */
                function (data) {
                    if (data) {
                        _this.getGroupList({ deleteGroup: true });
                    }
                }), (/**
                 * @param {?} error
                 * @return {?}
                 */
                function (error) {
                    _this.messageService.show('error', _this.localeService.getValue("organizationSelector.errorMessage.deleteGroup"), true);
                })));
            }
            else {
                return EMPTY;
            }
        }))).subscribe();
    };
    // 变更群组基本信息（名称、描述）
    // 变更群组基本信息（名称、描述）
    /**
     * @param {?} e
     * @param {?} item
     * @return {?}
     */
    GroupComponent.prototype.editGroup = 
    // 变更群组基本信息（名称、描述）
    /**
     * @param {?} e
     * @param {?} item
     * @return {?}
     */
    function (e, item) {
        this.selectedGroupId = item[this.groupIdField];
        this.selectedGroupTotal = item['total'];
        this.groupChange.next(item);
        e.stopPropagation();
        e.cancelBubble = true;
    };
    // 删除群组内的组织
    // 删除群组内的组织
    /**
     * @param {?} e
     * @param {?} data
     * @return {?}
     */
    GroupComponent.prototype.removeOrg = 
    // 删除群组内的组织
    /**
     * @param {?} e
     * @param {?} data
     * @return {?}
     */
    function (e, data) {
        var _this = this;
        this.messageService.confirm(this.localeService.getValue("organizationSelector.confirmMessage.deleteOrganization") +
            data['name'] + this.localeService.getValue("organizationSelector.confirmMessage.mark")).pipe(switchMap((/**
         * @param {?} result
         * @return {?}
         */
        function (result) {
            if (!!result) {
                /** @type {?} */
                var deleteOrg$ = _this.apiService.saveGroup({
                    groupId: _this.selectedGroupId,
                    addIds: [],
                    deleteIds: [data[_this.primaryField]],
                    changeType: Number(3)
                });
                return deleteOrg$.pipe(tap((/**
                 * @param {?} data
                 * @return {?}
                 */
                function (data) {
                    if (data) {
                        _this.getOrgsByGroup({ id: _this.selectedGroupId }, _this.currentGroupType, { removeOrg: true });
                        e.stopPropagation();
                        e.cancelBubble = true;
                    }
                }), (/**
                 * @param {?} error
                 * @return {?}
                 */
                function (error) {
                    _this.messageService.show('error', _this.localeService.getValue("organizationSelector.errorMessage.deleteOrganization"), true);
                })));
            }
            else {
                return EMPTY;
            }
        }))).subscribe();
    };
    // 设置群组内组织的勾选状态
    // 设置群组内组织的勾选状态
    /**
     * @private
     * @param {?} data
     * @param {?} checked
     * @return {?}
     */
    GroupComponent.prototype.setChecked = 
    // 设置群组内组织的勾选状态
    /**
     * @private
     * @param {?} data
     * @param {?} checked
     * @return {?}
     */
    function (data, checked) {
        /** @type {?} */
        var itemIndex = CommonUtil.findIndex(data[this.primaryField], this.primaryField, this.items);
        if (itemIndex > -1) {
            this.items[itemIndex].checked = checked;
        }
    };
    // 设置群组内组织的收藏状态
    // 设置群组内组织的收藏状态
    /**
     * @private
     * @return {?}
     */
    GroupComponent.prototype.setFavorites = 
    // 设置群组内组织的收藏状态
    /**
     * @private
     * @return {?}
     */
    function () {
        var _this = this;
        this.items.forEach((/**
         * @param {?} item
         * @return {?}
         */
        function (item) {
            if (CommonUtil.findIndex(item[_this.primaryField], _this.primaryField, _this.favoritesList) !== -1) {
                item.inFavorites = true;
            }
            else {
                item.inFavorites = false;
            }
        }));
    };
    // 通过弹窗增加群组内的组织
    // 通过弹窗增加群组内的组织
    /**
     * @param {?} show
     * @param {?=} groupType
     * @return {?}
     */
    GroupComponent.prototype.toggleGroupOrgDialog = 
    // 通过弹窗增加群组内的组织
    /**
     * @param {?} show
     * @param {?=} groupType
     * @return {?}
     */
    function (show, groupType) {
        if (groupType === void 0) { groupType = this.personalToken; }
        if (groupType === this.personalToken) {
            this.showGroupOrgDialog = show;
        }
    };
    // 获取某个群组内的所有组织
    // 获取某个群组内的所有组织
    /**
     * @param {?} item
     * @param {?=} groupType
     * @param {?=} changeType
     * @return {?}
     */
    GroupComponent.prototype.getOrgsByGroup = 
    // 获取某个群组内的所有组织
    /**
     * @param {?} item
     * @param {?=} groupType
     * @param {?=} changeType
     * @return {?}
     */
    function (item, groupType, changeType) {
        var _this = this;
        if (groupType === void 0) { groupType = this.publicToken; }
        if (changeType === void 0) { changeType = null; }
        if (this.loadingService) {
            this.loadingService.show();
        }
        this.currentGroupType = groupType;
        this.allChecked = false;
        this.selectedGroupId = item[this.groupIdField];
        //this.selectedGroupTotal = item['total'];
        /** @type {?} */
        var getOrgGroupMembers$ = this.apiService.getGroupMembers(this.selectedGroupId, this.absOrgType);
        getOrgGroupMembers$.pipe(tap((/**
         * @param {?} data
         * @return {?}
         */
        function (data) {
            _this.items = data ? data : [];
            _this.groupData.personal.forEach((/**
             * @param {?} item
             * @return {?}
             */
            function (item) {
                if (item[_this.groupIdField] === _this.selectedGroupId) {
                    _this.selectedGroupTotal = _this.items.length;
                    if (item.total !== _this.items.length) {
                        item.total = _this.items.length;
                    }
                }
            }));
            _this.items.forEach((/**
             * @param {?} it
             * @return {?}
             */
            function (it) {
                it.indexId = Math.random().toString(16).substring(2);
                it.enable = _this.filterType == 'disable' ? !_this.disableOrgList.includes(it.orgId) : true;
            }));
            _this.items = _this.items.slice();
            _this.showCheckAllIcon = _this.items.length ? true : false;
            _this.toggleChecked();
            _this.setFavorites();
            _this.cdr.detectChanges();
            if (_this.loadingService) {
                _this.loadingService.close();
            }
            if (changeType && changeType['updateGroup']) {
                _this.notifyService.success(_this.localeService.getValue("organizationSelector.successMessage.appendOrganization"));
            }
            else if (changeType && changeType['removeOrg']) {
                _this.notifyService.success(_this.localeService.getValue("organizationSelector.successMessage.deleteOrganization"));
            }
        }), (/**
         * @param {?} error
         * @return {?}
         */
        function (error) {
            if (_this.loadingService) {
                _this.loadingService.close();
            }
            throw new Error(_this.localeService.getValue("organizationSelector.errorMessage.getOrganization"));
        }))).subscribe();
    };
    // 获取组织群组数据
    // 获取组织群组数据
    /**
     * @param {?=} changeType
     * @return {?}
     */
    GroupComponent.prototype.getGroupList = 
    // 获取组织群组数据
    /**
     * @param {?=} changeType
     * @return {?}
     */
    function (changeType) {
        var _this = this;
        if (changeType === void 0) { changeType = null; }
        if (this.loadingService) {
            this.loadingService.show();
        }
        /** @type {?} */
        var getOrgGroups$ = this.apiService.getOrgGroups(this.absOrgType);
        getOrgGroups$.pipe(switchMap((/**
         * @param {?} data
         * @return {?}
         */
        function (data) {
            _this.groupData.public = data && data.publicGroup ? data.publicGroup : [];
            _this.groupData.personal = data && data.privateGroup ? data.privateGroup : [];
            if (_this.groupData.public.length == 0 && _this.groupData.personal.length == 0) {
                _this.items = [];
            }
            if (!_this.selectedGroupId) {
                /** @type {?} */
                var firstPublicGroupId = _this.groupData.public[0] && _this.groupData.public[0][_this.groupIdField];
                /** @type {?} */
                var firstPersonalGroupId = _this.groupData.personal[0] && _this.groupData.personal[0][_this.groupIdField];
                _this.selectedGroupId = firstPublicGroupId ? firstPublicGroupId : firstPersonalGroupId;
            }
            if (!!_this.selectedGroupId) {
                if (_this.groupData.public.findIndex((/**
                 * @param {?} item
                 * @return {?}
                 */
                function (item) { return item[_this.groupIdField] === _this.selectedGroupId; })) !== -1) {
                    _this.currentGroupType = _this.publicToken;
                }
                else if (_this.groupData.personal.findIndex((/**
                 * @param {?} item
                 * @return {?}
                 */
                function (item) { return item[_this.groupIdField] === _this.selectedGroupId; })) !== -1) {
                    _this.currentGroupType = _this.personalToken;
                }
                /** @type {?} */
                var getOrgGroupMembers$ = _this.apiService.getGroupMembers(_this.selectedGroupId, _this.absOrgType);
                return getOrgGroupMembers$.pipe(tap((/**
                 * @param {?} resData
                 * @return {?}
                 */
                function (resData) {
                    _this.items = resData ? resData : [];
                    _this.groupData.personal.forEach((/**
                     * @param {?} item
                     * @return {?}
                     */
                    function (item) {
                        if (item[_this.groupIdField] === _this.selectedGroupId) {
                            _this.selectedGroupTotal = _this.items.length;
                            if (item.total !== _this.items.length) {
                                item.total = _this.items.length;
                            }
                        }
                    }));
                    _this.items.forEach((/**
                     * @param {?} it
                     * @return {?}
                     */
                    function (it) {
                        it.indexId = Math.random().toString(16).substring(2);
                        it.enable = _this.filterType == 'disable' ? !_this.disableOrgList.includes(it.orgId) : true;
                    }));
                    _this.items = _this.items.slice();
                    _this.toggleChecked();
                    _this.setFavorites();
                    _this.cdr.detectChanges();
                }), (/**
                 * @param {?} error
                 * @return {?}
                 */
                function (error) {
                    if (_this.loadingService) {
                        _this.loadingService.close();
                    }
                    throw new Error(_this.localeService.getValue("organizationSelector.errorMessage.getOrganization"));
                })));
            }
            else {
                return of(true);
            }
        })), tap((/**
         * @return {?}
         */
        function () {
            if (_this.loadingService) {
                _this.loadingService.close();
            }
            if (changeType && changeType['saveGroup']) {
                _this.notifyService.success(_this.localeService.getValue("organizationSelector.successMessage.saveGroup"));
            }
            else if (changeType && changeType['updateNameOrNote']) {
                _this.notifyService.success(_this.localeService.getValue("organizationSelector.successMessage.editGroup"));
            }
            else if (changeType && changeType['deleteGroup']) {
                _this.notifyService.success(_this.localeService.getValue("organizationSelector.successMessage.deleteGroup"));
            }
        }), (/**
         * @param {?} error
         * @return {?}
         */
        function (error) {
            if (_this.loadingService) {
                _this.loadingService.close();
            }
            throw new Error(_this.localeService.getValue("organizationSelector.errorMessage.getGroup"));
        }))).subscribe();
    };
    // 收藏或者取消收藏组织
    // 收藏或者取消收藏组织
    /**
     * @param {?} e
     * @param {?} item
     * @return {?}
     */
    GroupComponent.prototype.toggleFavorites = 
    // 收藏或者取消收藏组织
    /**
     * @param {?} e
     * @param {?} item
     * @return {?}
     */
    function (e, item) {
        this.favoritesTool.toggleFavorites(e, item);
        this.setFavorites();
    };
    // 切换公共群组或者个人群组的收折状态
    // 切换公共群组或者个人群组的收折状态
    /**
     * @param {?} e
     * @param {?} type
     * @return {?}
     */
    GroupComponent.prototype.toggleVisible = 
    // 切换公共群组或者个人群组的收折状态
    /**
     * @param {?} e
     * @param {?} type
     * @return {?}
     */
    function (e, type) {
        if (type === this.publicToken) {
            this.publicVisible = !this.publicVisible;
        }
        else if (type === this.personalToken) {
            this.personalVisible = !this.personalVisible;
        }
        e.stopPropagation();
        e.cancelBubble = true;
    };
    /**
     * @param {?} e
     * @return {?}
     */
    GroupComponent.prototype.toggleAll = /**
     * @param {?} e
     * @return {?}
     */
    function (e) {
        if (!this.allChecked) {
            this.checkAll();
        }
        else {
            this.unCheckAll();
        }
        e.preventDefault();
    };
    /**
     * @param {?} data
     * @param {?} e
     * @return {?}
     */
    GroupComponent.prototype.toggleOne = /**
     * @param {?} data
     * @param {?} e
     * @return {?}
     */
    function (data, e) {
        if (!data.enable) {
            e.stopPropagation();
            e.cancelBubble = true;
            return;
        }
        if (data.checked) {
            if (this.multiSelect) {
                this.emitSelections(data, ChangeType.Remove);
            }
            else {
                this.emitSelections([]);
            }
        }
        else {
            if (this.multiSelect) {
                this.emitSelections(data, ChangeType.Append);
            }
            else {
                this.emitSelections(new Array(data));
            }
        }
        e.preventDefault();
    };
    /**
     * 全选后处理
     * @param dataArr 全选的值
     */
    /**
     * 全选后处理
     * @return {?}
     */
    GroupComponent.prototype.checkAll = /**
     * 全选后处理
     * @return {?}
     */
    function () {
        var _this = this;
        this.items.forEach((/**
         * @param {?} item
         * @return {?}
         */
        function (item) {
            if (CommonUtil.findIndex(item[_this.primaryField], _this.primaryField, _this.selections) === -1 && item.enable) {
                _this.emitSelections(item, ChangeType.Append);
            }
        }));
    };
    /**
     * 全部取消
     * @param dataArr 取消的数据
     * @returns void
     */
    /**
     * 全部取消
     * @return {?} void
     */
    GroupComponent.prototype.unCheckAll = /**
     * 全部取消
     * @return {?} void
     */
    function () {
        var _this = this;
        /** @type {?} */
        var checkeds = this.items.filter((/**
         * @param {?} item
         * @return {?}
         */
        function (item) { return item.checked; }));
        checkeds.forEach((/**
         * @param {?} item
         * @return {?}
         */
        function (item) {
            _this.emitSelections(item, ChangeType.Remove);
        }));
    };
    /**
     * 当前行选中
     * @param data 当前行的数据（）
     */
    /**
     * 当前行选中
     * @param {?} data 当前行的数据（）
     * @return {?}
     */
    GroupComponent.prototype.selectLine = /**
     * 当前行选中
     * @param {?} data 当前行的数据（）
     * @return {?}
     */
    function (data) {
        if (this.multiSelect) {
            this._insertOneIntoSelections(data);
        }
        else {
            this.selections = [];
            this.items.forEach((/**
             * @param {?} item
             * @return {?}
             */
            function (item) {
                if (item.checked) {
                    item.checked = false;
                }
            }));
            this._insertOneIntoSelections(data);
        }
        if (this.isAllChecked()) {
            this.allChecked = true;
        }
    };
    /**
     * 单选取消选中
     * @param data 取消选中行
     */
    /**
     * 单选取消选中
     * @param {?} data 取消选中行
     * @return {?}
     */
    GroupComponent.prototype.unSelectLine = /**
     * 单选取消选中
     * @param {?} data 取消选中行
     * @return {?}
     */
    function (data) {
        /** @type {?} */
        var index = CommonUtil.findIndex(data[this.primaryField], this.primaryField, this.selections);
        if (index > -1) {
            this.selections.splice(index, 1);
        }
        this.setChecked(data, false);
        if (this.allChecked) {
            this.allChecked = false;
        }
    };
    /**
     * @private
     * @param {?} selections
     * @param {?=} changeType
     * @param {?=} from
     * @return {?}
     */
    GroupComponent.prototype.emitSelections = /**
     * @private
     * @param {?} selections
     * @param {?=} changeType
     * @param {?=} from
     * @return {?}
     */
    function (selections, changeType, from) {
        if (changeType === void 0) { changeType = ChangeType.ValueChanged; }
        if (from === void 0) { from = 'group'; }
        this.stateMgr.emitSelections(selections, changeType, from);
    };
    /**
     * 选中并插入当前行数据到右侧
     * @param data 当前行的数据
     * @param collection 暂存当前数据的集合
     */
    /**
     * 选中并插入当前行数据到右侧
     * @param {?} data 当前行的数据
     * @return {?}
     */
    GroupComponent.prototype._insertOneIntoSelections = /**
     * 选中并插入当前行数据到右侧
     * @param {?} data 当前行的数据
     * @return {?}
     */
    function (data) {
        // 如果当前数据已经移入右侧数据，则返回。
        if (CommonUtil.findIndex(data[this.primaryField], this.primaryField, this.selections) > -1) {
            return;
        }
        this.setChecked(data, true);
        this.selections.push(data);
        this.selections = this.selections.slice();
    };
    /**
     * 翻页检查：人员展示区的勾选状态与已选人员区是否对应
     */
    /**
     * 翻页检查：人员展示区的勾选状态与已选人员区是否对应
     * @return {?}
     */
    GroupComponent.prototype.toggleChecked = /**
     * 翻页检查：人员展示区的勾选状态与已选人员区是否对应
     * @return {?}
     */
    function () {
        var _this = this;
        this.items.forEach((/**
         * @param {?} item
         * @return {?}
         */
        function (item) {
            if (CommonUtil.findIndex(item[_this.primaryField], _this.primaryField, _this.selections) > -1 && item.enable) {
                item.checked = true;
            }
            else {
                item.checked = false;
            }
        }));
        if (this.isAllChecked()) {
            this.allChecked = true;
        }
        else {
            this.allChecked = false;
        }
    };
    /**
     * @private
     * @return {?}
     */
    GroupComponent.prototype.isAllChecked = /**
     * @private
     * @return {?}
     */
    function () {
        var _this = this;
        /** @type {?} */
        var count = 0;
        /** @type {?} */
        var allChecked = false;
        this.items.forEach((/**
         * @param {?} item
         * @return {?}
         */
        function (item) {
            _this.selections.forEach((/**
             * @param {?} selection
             * @return {?}
             */
            function (selection) {
                if (item[_this.primaryField] === selection[_this.primaryField]) {
                    count += 1;
                }
            }));
        }));
        if (this.items.filter((/**
         * @param {?} item
         * @return {?}
         */
        function (item) { return item.enable; })).length === count && count > 0) {
            allChecked = true;
        }
        return allChecked;
    };
    /**
     * @param {?} index
     * @param {?} item
     * @return {?}
     */
    GroupComponent.prototype.trackByFn = /**
     * @param {?} index
     * @param {?} item
     * @return {?}
     */
    function (index, item) {
        return index;
    };
    GroupComponent.decorators = [
        { type: Component, args: [{
                    selector: 'lib-group',
                    template: "<div class=\"candidate flex-left\">\r\n    <perfect-scrollbar *ngIf=\"groupData.personal.length || groupData.public.length\">\r\n        <div class=\"h-100\">\r\n            <div class=\"group_blank_15\"></div>\r\n            <div class=\"group-top-tree\">\r\n                <span class=\"f-icon\" [class.f-icon-minus-outline]=\"publicVisible\"\r\n                    [class.f-icon-plus-outline]=\"!publicVisible\" (click)=\"toggleVisible($event, publicToken)\"></span>\r\n                    {{'organizationSelector.group.publicGroup' | locale}}\r\n            </div>\r\n            <ng-template [ngIf]=\"publicVisible\">\r\n                <div class=\"s-opCell-f\" [class.active]=\"selectedGroupId === item[groupIdField]\" title=\"\"\r\n                    *ngFor=\"let item of groupData.public\" (click)=\"getOrgsByGroup(item, publicToken)\">\r\n                    <div class=\"s-opCell-f-group\">\r\n                        <!--\r\n                        <farris-avatar [avatarWidth]=\"32\" [avatarHeight]=\"32\" [cover]=\"item['avatar']\" [readonly]=\"true\"\r\n                            class=\"s-opCell-a\">\r\n                        </farris-avatar>\r\n                        -->\r\n                        <div class=\"s-opCell-d\">\r\n                            <p class=\"s-opCell-d1\">{{item.title}} {{item.total}}{{'organizationSelector.group.items' | locale}}</p>\r\n                            <p class=\"s-opCell-d2\" title=\"{{item.description}}\">{{item.description}}</p>\r\n                        </div>\r\n                    </div>\r\n                    <!-- <span class=\"span-find-details\">\u67E5\u770B\u8BE6\u60C5</span> -->\r\n                </div>\r\n            </ng-template>\r\n            <div class=\"group_blank_15\"></div>\r\n            <div class=\"group-top-tree\">\r\n                <span class=\"f-icon\" [class.f-icon-minus-outline]=\"personalVisible\"\r\n                    [class.f-icon-plus-outline]=\"!personalVisible\"\r\n                    (click)=\"toggleVisible($event, personalToken)\"></span>\r\n                    {{'organizationSelector.group.privateGroup' | locale}}\r\n            </div>\r\n            <ng-template [ngIf]=\"personalVisible\">\r\n                <div class=\"s-opCell-f\" [class.active]=\"selectedGroupId === item[groupIdField]\"\r\n                    *ngFor=\"let item of groupData.personal\" (click)=\"getOrgsByGroup(item, personalToken)\">\r\n                    <div class=\"s-opCell-f-group\">\r\n                        <!--\r\n                        <farris-avatar [avatarWidth]=\"32\" [avatarHeight]=\"32\" [cover]=\"item['avatar']\" [readonly]=\"true\"\r\n                            class=\"s-opCell-a\">\r\n                        </farris-avatar>\r\n                        -->\r\n                        <div class=\"s-opCell-d\">\r\n                            <p class=\"s-opCell-d1\">{{item.title}} {{item.total}}{{'organizationSelector.group.items' | locale}}</p>\r\n                            <p class=\"s-opCell-d2\" title=\"{{item.description}}\">{{item.description}}</p>\r\n                        </div>\r\n                    </div>\r\n                    <div class=\"s-opCell-edit\">\r\n                        <span class=\"f-icon f-icon-new-edit\" (click)=\"editGroup($event, item)\"></span>\r\n                        <span class=\"f-icon f-icon-minus-circle default-light-color\"\r\n                            (click)=\"deleteGroup($event, item)\"></span>\r\n                    </div>\r\n                </div>\r\n            </ng-template>\r\n        </div>\r\n    </perfect-scrollbar>\r\n    <div *ngIf=\"groupData.personal.length === 0 && groupData.public.length === 0\"\r\n        [ngStyle]=\"{'background-image': noDataImg}\" class=\"fp-candidate-nodata\">\r\n        {{'organizationSelector.tabCommon.noOrgData' | locale}}</div>\r\n</div>\r\n<div class=\"candidate flex-right\">\r\n    <div class=\"candidate-title\" *ngIf=\"groupData?.public.length > 0 || groupData?.personal.length > 0\">\r\n        <div class=\"custom-control custom-checkbox mb-2\" *ngIf=\"multiSelect && showCheckAllIcon\">\r\n            <input class=\"custom-control-input\" [id]=\"allIndexId\" type=\"checkbox\" [(ngModel)]=\"allChecked\">\r\n            <label class=\"custom-control-label\" [for]=\"allIndexId\" (click)=\"toggleAll($event)\">{{'organizationSelector.group.checkAll' | locale}}</label>\r\n        </div>\r\n        <div *ngIf=\"!multiSelect\"></div>\r\n        <div (click)=\"toggleGroupOrgDialog(true, currentGroupType)\"\r\n            [ngStyle]=\"{'color': currentGroupType === publicToken ? '#d8d8d8' : '#2a87ff', 'cursor': currentGroupType === publicToken ? 'not-allowed' : 'pointer'}\">\r\n            <span class=\"f-icon f-icon-department\"></span>\r\n            {{'organizationSelector.group.appendMembers' | locale}}\r\n        </div>\r\n    </div>\r\n    <perfect-scrollbar *ngIf=\"items.length!==0\">\r\n        <div class=\"candidate-content\">\r\n            <div *ngFor=\"let data of items; let i = index;trackBy: trackByFn\" class=\"s-selectedPerson\" [ngClass]=\"{'disabledPerson': !data.enable}\">\r\n                <div class=\"custom-control custom-checkbox mb-2\">\r\n                    <input class=\"custom-control-input\" [ngModel]=\"data.checked\" [id]=\"data.indexId\" type=\"checkbox\" [disabled]=\"!data.enable\">\r\n                    <label class=\"custom-control-label\" [for]=\"data.indexId\" (click)=\"toggleOne(data, $event)\">\r\n                        <div style=\"display: flex; height: 32px; margin: -21px 0 0 24px;\">\r\n                            <!-- <farris-avatar [avatarWidth]=\"32\" [avatarHeight]=\"32\" [cover]=\"data.ext1\" [readonly]=\"true\">\r\n                            </farris-avatar> -->\r\n                            <div style=\"margin-left: 11px; margin-top: -2px;  padding-right: 10px; overflow: hidden;\">\r\n                                <p class=\"candidate-content-title\" title=\"{{data.name}}\">\r\n                                    {{data.name}}</p>\r\n                                <p class=\"candidate-content-orgpath\" title=\"{{data.orgAllPath}}\">\r\n                                    {{data.orgAllPath}}</p>\r\n                            </div>\r\n                        </div>\r\n                    </label>\r\n                </div>\r\n                <span class=\"f-icon f-icon-minus-circle deleteBtn\" *ngIf=\"currentGroupType===personalToken\" (click)=\"removeOrg($event, data)\"></span>\r\n                <span class=\"f-icon f-icon-star\" *ngIf=\"enableFavorites\" [class.default-light-color]=\"data.inFavorites\"\r\n                    [class.default-dark-color]=\"!data.inFavorites\" (click)=\"toggleFavorites($event, data)\"></span>\r\n            </div>\r\n\r\n        </div>\r\n    </perfect-scrollbar>\r\n    <div *ngIf=\"items.length===0\" [ngStyle]=\"{'background-image': noDataImg}\" class=\"fp-candidate-nodata\">\r\n        {{'organizationSelector.tabCommon.noOrgData' | locale}}</div>\r\n</div>\r\n\r\n<!--\u7FA4\u7EC4\u5F39\u7A97\u9009\u7EC4\u7EC7--->\r\n<div class=\"s-group-dialog-container\" *ngIf=\"showGroupOrgDialog\">\r\n    <div class=\"s-org-group-title\">\r\n        <span class=\"f-icon f-sidebar-close\" (click)=\"toggleGroupOrgDialog(false)\"></span>{{'organizationSelector.group.appendMembers' | locale}}\r\n    </div>\r\n    <append-group-org #appendOrg style=\"margin-top: 15px;\"\r\n        [primaryField]=\"primaryField\" [enableHierarchicalLoading]=\"enableHierarchicalLoading\"\r\n        [notGetStopOrg]=\"notGetStopOrg\" [layer]=\"layer\" [multiSelect]=\"multiSelect\" [absOrgType]=\"absOrgType\"\r\n        [cascadeCheck]=\"cascadeCheck\" [cascadeDown]=\"cascadeDown\" [cascadeUp]=\"cascadeUp\" [keepSelect]=\"keepSelect\"\r\n        [showCheckAll]=\"showCheckAll\" [selectedLimit]=\"selectedLimit\" [virtualizedLoad]=\"virtualizedLoad\">\r\n    </append-group-org>\r\n    <div class=\"s-org-group-footer\">\r\n        <input type=\"button\" class=\"btn btn-primary fr\" style=\"width: 100px;\" value=\"{{'organizationSelector.selection.confirm' | locale}}\"\r\n            (click)=\"updateGroup()\" />\r\n        <input type=\"button\" class=\"btn btn-secondary fr mr-3\" value=\"{{'organizationSelector.selection.cancel' | locale}}\" (click)=\"toggleGroupOrgDialog(false)\" />\r\n    </div>\r\n</div>\r\n<div class=\"s-help-bg\" *ngIf=\"showGroupOrgDialog\"></div>",
                    styles: [":host{display:-webkit-box;display:flex;height:100%;-webkit-box-flex:1;flex:1;overflow:hidden;position:static}.candidate{display:-webkit-box;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-direction:column;position:relative;border-right:1px solid #dee1ea;overflow:hidden}.candidate.flex-left{-webkit-box-flex:0;flex:0 0 42%}.candidate.flex-right{-webkit-box-flex:0;flex:0 0 58%}.candidate .s-opCell-f{display:-webkit-box;display:flex;height:40px;border-radius:6px;padding-left:10px;-webkit-box-pack:justify;justify-content:space-between;margin:1px 5px 0;cursor:pointer}.candidate .s-opCell-f .s-opCell-f-group{display:-webkit-box;display:flex;-webkit-box-flex:1;flex:1}.candidate .s-opCell-f.active,.candidate .s-opCell-f:hover{background-color:#eef5ff}.candidate .s-opCell-f:hover .s-opCell-edit{visibility:visible}.candidate .s-opCell-a{margin-top:4px;margin-left:6px}.candidate .s-opCell-d{-webkit-box-flex:1;flex:1;overflow:hidden;margin:1.5px 10px 0}.candidate .s-opCell-d1{line-height:20px;font-size:13px;height:20px;color:#2d2f33;white-space:nowrap;text-overflow:ellipsis;overflow:hidden;margin:0;padding:0;max-width:210px}.candidate .s-opCell-d2{color:#a8adb8;font-size:12px;line-height:14px;height:14px;white-space:nowrap;text-overflow:ellipsis;overflow:hidden;margin:0;padding:0;max-width:210px}.candidate .s-opCell-f .f-avatar .f-avatar-image{display:block!important}.candidate .fp-candidate-nodata{width:100px;height:100px;text-align:center;background-repeat:no-repeat;background-size:contain;color:#b4bccc;padding-top:110px;position:absolute;left:50%;top:50%;margin:-70px 0 0 -50px}.candidate .s-opCell-f:hover .span-find-details{display:block}.candidate .s-opCell-f .span-find-details{margin-right:5px;line-height:40px;color:#2a87ff;width:60px;display:none}.candidate .s-opCell-f .s-opCell-edit{line-height:40px;width:60px;text-align:center;visibility:hidden}.candidate .s-opCell-f .s-opCell-edit .f-icon-new-edit{margin-right:10px;color:#949aa6}.candidate .s-opCell-f .s-opCell-edit .f-icon-minus-circle{color:#f46160}.candidate .group-top-tree{margin:0 15px 10px;font-size:13px}.candidate .group_blank_15{width:100%;height:15px}.candidate .group-top-tree .f-icon{color:#d5d4d7;margin-right:8px}.candidate .group-top-tree .k-checkbox-label::after,.candidate .group-top-tree .k-checkbox-label::before{top:1px}.candidate .candidate-content{clear:both}.candidate .s-selectedPerson:first-child{margin-top:0}.candidate .s-selectedPerson{min-width:240px;float:left;width:calc(100% - 6px);position:relative;height:40px;padding:5px 12px;margin:0 3px 1px}.candidate .s-selectedPerson:hover{background:#eef5ff;border-radius:5px}.candidate .disabledPerson{color:#a8adb8;background-color:#fafafc}.candidate .disabledPerson:hover{background:#fafafc!important}.candidate .f-icon{font-size:14px}.candidate .s-selectedPerson .deleteBtn{font-size:14px;color:#f46160;cursor:pointer;position:absolute;right:60px;top:13px;visibility:hidden}.candidate .s-selectedPerson:hover .deleteBtn{visibility:visible}.candidate .s-selectedPerson .f-icon-star{position:absolute;top:13px;right:15px;font-size:14px}.candidate .s-selectedPerson .default-light-color{color:#f7b500}.candidate .s-selectedPerson .default-dark-color{color:#d8dce6}.candidate .k-checkbox-label::before{top:10px;font-size:16px;width:14px;height:14px}.candidate .k-checkbox-label::after{top:10px;font-size:16px;width:15px;height:14px}.candidate .candidate-content-title{margin:0;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;font-size:13px}.candidate .candidate-content-orgpath{margin:0;font-size:12px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;color:#c7ccd7}.candidate .candidate-title{display:-webkit-box;display:flex;-webkit-box-pack:justify;justify-content:space-between}.candidate .candidate-title .custom-control{margin:10px 0 0 15px;line-height:35px}.candidate .s-selectedPerson .custom-control-label::before{top:8px}.candidate .candidate-title .title-clearall{margin:5px 15px 0 0;color:#2a87ff;cursor:pointer;line-height:35px}.candidate .candidate-title div{line-height:35px;margin:9px 10px 0 0;color:#2a87ff;cursor:pointer}.candidate .saved-group{position:absolute;width:111px;height:26px;line-height:26px;background:#eaedf2;border-radius:5px;text-align:center;font-size:13px;bottom:10px;left:13px;z-index:999;color:#909ba2;cursor:pointer}.candidate .saved-group:hover{color:#2a87ff;background:#eaf4ff}.candidate .saved-group:hover .f-icon{color:#2a87ff}.candidate .saved-group .f-icon{color:#909ba2;margin-right:5px;cursor:pointer;font-size:14px}.s-group-dialog-container{height:520px;width:700px;position:fixed;left:50%;top:50%;margin:-260px 0 0 -350px;background:#fff;padding:15px 20px;border-radius:10px;display:-webkit-box;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-direction:column;z-index:9999}.s-group-dialog-container .s-org-group-footer{margin-top:15px}.s-help-bg{background:rgb(0 0 0 / 15%);position:fixed;left:0;top:0;right:0;bottom:0;z-index:9997}.s-group-dialog-container .s-org-group-title{font-size:17px;line-height:24px;color:#2d2f33;font-weight:600}.s-group-dialog-container .s-org-group-title .f-icon{float:right;font-size:20px;color:#878d99;margin-top:3px;cursor:pointer}.s-group-dialog-container .s-org-group-footer .fr{float:right;height:32px}"]
                }] }
    ];
    /** @nocollapse */
    GroupComponent.ctorParameters = function () { return [
        { type: ApiService },
        { type: FavoritesTool },
        { type: StateMgrTool },
        { type: ChangeDetectorRef },
        { type: Injector, decorators: [{ type: Optional }] }
    ]; };
    GroupComponent.propDecorators = {
        appendOrg: [{ type: ViewChild, args: ['appendOrg',] }],
        primaryField: [{ type: Input }],
        multiSelect: [{ type: Input }],
        absOrgType: [{ type: Input }],
        busNum: [{ type: Input }],
        enableFavorites: [{ type: Input }],
        notGetStopOrg: [{ type: Input }],
        groupApiUrl: [{ type: Input }],
        enableHierarchicalLoading: [{ type: Input }],
        cascadeCheck: [{ type: Input }],
        cascadeDown: [{ type: Input }],
        cascadeUp: [{ type: Input }],
        keepSelect: [{ type: Input }],
        layer: [{ type: Input }],
        selectedLimit: [{ type: Input }],
        showCheckAll: [{ type: Input }],
        virtualizedLoad: [{ type: Input }],
        isActiveTab: [{ type: Input }],
        filterType: [{ type: Input }],
        disableOrgList: [{ type: Input }],
        groupChange: [{ type: Output }]
    };
    return GroupComponent;
}());
export { GroupComponent };
if (false) {
    /** @type {?} */
    GroupComponent.prototype.appendOrg;
    /** @type {?} */
    GroupComponent.prototype.primaryField;
    /** @type {?} */
    GroupComponent.prototype.multiSelect;
    /** @type {?} */
    GroupComponent.prototype.absOrgType;
    /** @type {?} */
    GroupComponent.prototype.busNum;
    /** @type {?} */
    GroupComponent.prototype.enableFavorites;
    /** @type {?} */
    GroupComponent.prototype.notGetStopOrg;
    /** @type {?} */
    GroupComponent.prototype.groupApiUrl;
    /** @type {?} */
    GroupComponent.prototype.enableHierarchicalLoading;
    /** @type {?} */
    GroupComponent.prototype.cascadeCheck;
    /** @type {?} */
    GroupComponent.prototype.cascadeDown;
    /** @type {?} */
    GroupComponent.prototype.cascadeUp;
    /** @type {?} */
    GroupComponent.prototype.keepSelect;
    /** @type {?} */
    GroupComponent.prototype.layer;
    /** @type {?} */
    GroupComponent.prototype.selectedLimit;
    /** @type {?} */
    GroupComponent.prototype.showCheckAll;
    /** @type {?} */
    GroupComponent.prototype.virtualizedLoad;
    /** @type {?} */
    GroupComponent.prototype.isActiveTab;
    /** @type {?} */
    GroupComponent.prototype.filterType;
    /** @type {?} */
    GroupComponent.prototype.disableOrgList;
    /** @type {?} */
    GroupComponent.prototype.groupChange;
    /** @type {?} */
    GroupComponent.prototype.groupIdField;
    /** @type {?} */
    GroupComponent.prototype.userIdField;
    /** @type {?} */
    GroupComponent.prototype.selections;
    /** @type {?} */
    GroupComponent.prototype.noDataImg;
    /** @type {?} */
    GroupComponent.prototype.allChecked;
    /** @type {?} */
    GroupComponent.prototype.items;
    /** @type {?} */
    GroupComponent.prototype.favoritesList;
    /** @type {?} */
    GroupComponent.prototype.groupData;
    /** @type {?} */
    GroupComponent.prototype.personnelList;
    /** @type {?} */
    GroupComponent.prototype.groupPersonnels;
    /** @type {?} */
    GroupComponent.prototype.publicVisible;
    /** @type {?} */
    GroupComponent.prototype.personalVisible;
    /** @type {?} */
    GroupComponent.prototype.publicToken;
    /** @type {?} */
    GroupComponent.prototype.personalToken;
    /** @type {?} */
    GroupComponent.prototype.selectedGroupId;
    /** @type {?} */
    GroupComponent.prototype.selectedGroupTotal;
    /** @type {?} */
    GroupComponent.prototype.allIndexId;
    /** @type {?} */
    GroupComponent.prototype.showGroupOrgDialog;
    /** @type {?} */
    GroupComponent.prototype.currentGroupType;
    /** @type {?} */
    GroupComponent.prototype.showCheckAllIcon;
    /**
     * @type {?}
     * @private
     */
    GroupComponent.prototype.selectionsSub;
    /**
     * @type {?}
     * @private
     */
    GroupComponent.prototype.favoritesSub;
    /**
     * @type {?}
     * @private
     */
    GroupComponent.prototype.messageService;
    /**
     * @type {?}
     * @private
     */
    GroupComponent.prototype.loadingService;
    /**
     * @type {?}
     * @private
     */
    GroupComponent.prototype.notifyService;
    /**
     * @type {?}
     * @private
     */
    GroupComponent.prototype.localeService;
    /**
     * @type {?}
     * @private
     */
    GroupComponent.prototype.apiService;
    /**
     * @type {?}
     * @private
     */
    GroupComponent.prototype.favoritesTool;
    /**
     * @type {?}
     * @private
     */
    GroupComponent.prototype.stateMgr;
    /**
     * @type {?}
     * @private
     */
    GroupComponent.prototype.cdr;
    /**
     * @type {?}
     * @private
     */
    GroupComponent.prototype.injector;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZ3JvdXAuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGZhcnJpcy91aS1vcmdhbml6YXRpb24tc2VsZWN0b3IvIiwic291cmNlcyI6WyJsaWIvdGFiLWdyb3VwL2dyb3VwLmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7OztBQUFBLE9BQU8sRUFBaUIsaUJBQWlCLEVBQUUsU0FBUyxFQUFFLFlBQVksRUFBVSxRQUFRLEVBQUUsS0FBSyxFQUFxQixRQUFRLEVBQUUsTUFBTSxFQUFFLFNBQVMsRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUNuSyxPQUFPLEtBQUssQ0FBQyxNQUFNLFdBQVcsQ0FBQztBQUMvQixPQUFPLEVBQUUsS0FBSyxFQUFFLEVBQUUsRUFBZ0IsTUFBTSxNQUFNLENBQUM7QUFDL0MsT0FBTyxFQUFFLFNBQVMsRUFBRSxNQUFNLHVCQUF1QixDQUFDO0FBQ2xELE9BQU8sRUFBRSxVQUFVLEVBQUUsTUFBTSx5QkFBeUIsQ0FBQztBQUNyRCxPQUFPLEVBQUUsVUFBVSxFQUFFLE1BQU0seUJBQXlCLENBQUM7QUFDckQsT0FBTyxFQUFFLGFBQWEsRUFBRSxNQUFNLDRCQUE0QixDQUFDO0FBQzNELE9BQU8sRUFBRSxVQUFVLEVBQW9CLE1BQU0sd0JBQXdCLENBQUM7QUFDdEUsT0FBTyxFQUFFLFlBQVksRUFBRSxNQUFNLDRCQUE0QixDQUFDO0FBQzFELE9BQU8sRUFBRSxHQUFHLEVBQUUsU0FBUyxFQUFFLE1BQU0sZ0JBQWdCLENBQUM7QUFDaEQsT0FBTyxFQUFFLHVCQUF1QixFQUFFLE1BQU0seUNBQXlDLENBQUM7QUFDbEYsT0FBTyxFQUFFLGNBQWMsRUFBRSxNQUFNLG9CQUFvQixDQUFDO0FBQ3BELE9BQU8sRUFBRSxlQUFlLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQztBQUN0RCxPQUFPLEVBQUUsYUFBYSxFQUFFLE1BQU0sbUJBQW1CLENBQUM7QUFDbEQsT0FBTyxFQUFFLGFBQWEsRUFBRSxNQUFNLG1CQUFtQixDQUFD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Q2xDLHFDQUE4Qjs7SUFDOUIsb0NBQTRCOztJQUM1Qix3Q0FBdUM7O0lBQ3ZDLHFDQUFnRDs7SUFFaEQsc0NBQW9COztJQUNwQixxQ0FBdUI7O0lBQ3ZCLG9DQUF1Qjs7SUFDdkIsbUNBQXNCOztJQUN0QixvQ0FBbUI7O0lBQ25CLCtCQUFXOztJQUNYLHVDQUFtQjs7SUFDbkIsbUNBQWdEOztJQUNoRCx1Q0FBbUI7O0lBQ25CLHlDQUFxQjs7SUFDckIsdUNBQXFCOztJQUNyQix5Q0FBdUI7O0lBQ3ZCLHFDQUF1Qjs7SUFDdkIsdUNBQTJCOztJQUMzQix5Q0FBd0I7O0lBQ3hCLDRDQUEyQjs7SUFDM0Isb0NBQW1COztJQUNuQiw0Q0FBMkI7O0lBQzNCLDBDQUE0Qjs7SUFDNUIsMENBQWlDOzs7OztJQUNqQyx1Q0FBb0M7Ozs7O0lBQ3BDLHNDQUFtQzs7Ozs7SUFDbkMsd0NBQStDOzs7OztJQUMvQyx3Q0FBOEM7Ozs7O0lBQzlDLHVDQUE0Qzs7Ozs7SUFDNUMsdUNBQTRDOzs7OztJQUd4QyxvQ0FBOEI7Ozs7O0lBQzlCLHVDQUFvQzs7Ozs7SUFDcEMsa0NBQThCOzs7OztJQUM5Qiw2QkFBOEI7Ozs7O0lBQzlCLGtDQUFzQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFmdGVyVmlld0luaXQsIENoYW5nZURldGVjdG9yUmVmLCBDb21wb25lbnQsIEV2ZW50RW1pdHRlciwgSW5qZWN0LCBJbmplY3RvciwgSW5wdXQsIE9uRGVzdHJveSwgT25Jbml0LCBPcHRpb25hbCwgT3V0cHV0LCBWaWV3Q2hpbGQgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0ICogYXMgXyBmcm9tICdsb2Rhc2gtZXMnO1xyXG5pbXBvcnQgeyBFTVBUWSwgb2YsIFN1YnNjcmlwdGlvbiB9IGZyb20gJ3J4anMnO1xyXG5pbXBvcnQgeyBub0RhdGFJbWcgfSBmcm9tICcuLi8uLi9hc3NldHMvcmVzb3VyY2UnO1xyXG5pbXBvcnQgeyBBcGlTZXJ2aWNlIH0gZnJvbSAnLi4vLi4vdXRpbHMvYXBpLnNlcnZpY2UnO1xyXG5pbXBvcnQgeyBDb21tb25VdGlsIH0gZnJvbSAnLi4vLi4vdXRpbHMvY29tbW9uLnRvb2wnO1xyXG5pbXBvcnQgeyBGYXZvcml0ZXNUb29sIH0gZnJvbSAnLi4vLi4vdXRpbHMvZmF2b3JpdGVzLnRvb2wnO1xyXG5pbXBvcnQgeyBDaGFuZ2VUeXBlLCBHcm91cCwgR3JvdXBJdGVtIH0gZnJvbSAnLi4vLi4vdXRpbHMvaW5kZXgudHlwZSc7XHJcbmltcG9ydCB7IFN0YXRlTWdyVG9vbCB9IGZyb20gJy4uLy4uL3V0aWxzL3N0YXRlLm1nci50b29sJztcclxuaW1wb3J0IHsgdGFwLCBzd2l0Y2hNYXAgfSBmcm9tICdyeGpzL29wZXJhdG9ycyc7XHJcbmltcG9ydCB7IEFwcGVuZEdyb3VwT3JnQ29tcG9uZW50IH0gZnJvbSAnLi4vYXBwZW5kLWdyb3VwLW9yZy9hcHBlbmRvcmcuY29tcG9uZW50JztcclxuaW1wb3J0IHsgTG9hZGluZ1NlcnZpY2UgfSBmcm9tICdAZmFycmlzL3VpLWxvYWRpbmcnO1xyXG5pbXBvcnQgeyBNZXNzYWdlclNlcnZpY2UgfSBmcm9tICdAZmFycmlzL3VpLW1lc3NhZ2VyJztcclxuaW1wb3J0IHsgTm90aWZ5U2VydmljZSB9IGZyb20gJ0BmYXJyaXMvdWktbm90aWZ5JztcclxuaW1wb3J0IHsgTG9jYWxlU2VydmljZSB9IGZyb20gJ0BmYXJyaXMvdWktbG9jYWxlJztcclxuaW1wb3J0IHsgT1JHQU5JWkFUSU9OX1NFTEVDVE9SX0xPQ0FMRSB9IGZyb20gJy4uLy4uL3V0aWxzL2xvY2FsZSc7XHJcblxyXG5AQ29tcG9uZW50KHtcclxuICAgIHNlbGVjdG9yOiAnbGliLWdyb3VwJyxcclxuICAgIHRlbXBsYXRlVXJsOiAnLi9ncm91cC5jb21wb25lbnQuaHRtbCcsXHJcbiAgICBzdHlsZVVybHM6IFsnLi9ncm91cC5jb21wb25lbnQuY3NzJ11cclxufSlcclxuZXhwb3J0IGNsYXNzIEdyb3VwQ29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0LCBBZnRlclZpZXdJbml0LCBPbkRlc3Ryb3kge1xyXG5cclxuICAgIEBWaWV3Q2hpbGQoJ2FwcGVuZE9yZycpIGFwcGVuZE9yZzogQXBwZW5kR3JvdXBPcmdDb21wb25lbnQ7XHJcbiAgICBASW5wdXQoKSBwcmltYXJ5RmllbGQgPSAnb3JnSWQnO1xyXG4gICAgQElucHV0KCkgbXVsdGlTZWxlY3Q6IGFueTtcclxuICAgIEBJbnB1dCgpIGFic09yZ1R5cGU6IHN0cmluZztcclxuICAgIEBJbnB1dCgpIGJ1c051bTogc3RyaW5nO1xyXG4gICAgQElucHV0KCkgZW5hYmxlRmF2b3JpdGVzOiBib29sZWFuO1xyXG4gICAgQElucHV0KCkgbm90R2V0U3RvcE9yZzogYm9vbGVhbjtcclxuICAgIEBJbnB1dCgpIGdyb3VwQXBpVXJsOiBzdHJpbmc7XHJcbiAgICBASW5wdXQoKSBlbmFibGVIaWVyYXJjaGljYWxMb2FkaW5nOiBib29sZWFuO1xyXG4gICAgQElucHV0KCkgY2FzY2FkZUNoZWNrOiBib29sZWFuO1xyXG4gICAgQElucHV0KCkgY2FzY2FkZURvd246IGJvb2xlYW47XHJcbiAgICBASW5wdXQoKSBjYXNjYWRlVXA6IGJvb2xlYW47XHJcbiAgICBASW5wdXQoKSBrZWVwU2VsZWN0OiBib29sZWFuO1xyXG4gICAgQElucHV0KCkgbGF5ZXI6IG51bWJlcjtcclxuICAgIEBJbnB1dCgpIHNlbGVjdGVkTGltaXQ6IG51bWJlcjtcclxuICAgIEBJbnB1dCgpIHNob3dDaGVja0FsbDogYm9vbGVhbjsgXHJcbiAgICBASW5wdXQoKSB2aXJ0dWFsaXplZExvYWQ6IGJvb2xlYW47XHJcbiAgICBASW5wdXQoKSBpc0FjdGl2ZVRhYjogYm9vbGVhbjtcclxuICAgIEBJbnB1dCgpIGZpbHRlclR5cGU6IHN0cmluZztcclxuICAgIEBJbnB1dCgpIGRpc2FibGVPcmdMaXN0OiBzdHJpbmdbXSA9IFtdO1xyXG4gICAgQE91dHB1dCgpIGdyb3VwQ2hhbmdlID0gbmV3IEV2ZW50RW1pdHRlcjxhbnk+KCk7XHJcblxyXG4gICAgZ3JvdXBJZEZpZWxkID0gJ2lkJztcclxuICAgIHVzZXJJZEZpZWxkID0gJ3VzZXJJZCc7XHJcbiAgICBzZWxlY3Rpb25zOiBhbnlbXSA9IFtdO1xyXG4gICAgbm9EYXRhSW1nID0gbm9EYXRhSW1nO1xyXG4gICAgYWxsQ2hlY2tlZCA9IGZhbHNlO1xyXG4gICAgaXRlbXMgPSBbXTtcclxuICAgIGZhdm9yaXRlc0xpc3QgPSBbXTtcclxuICAgIGdyb3VwRGF0YTogR3JvdXAgPSB7IHB1YmxpYzogW10sIHBlcnNvbmFsOiBbXSB9O1xyXG4gICAgcGVyc29ubmVsTGlzdCA9IFtdO1xyXG4gICAgZ3JvdXBQZXJzb25uZWxzID0gW107XHJcbiAgICBwdWJsaWNWaXNpYmxlID0gdHJ1ZTtcclxuICAgIHBlcnNvbmFsVmlzaWJsZSA9IHRydWU7XHJcbiAgICBwdWJsaWNUb2tlbiA9ICdwdWJsaWMnO1xyXG4gICAgcGVyc29uYWxUb2tlbiA9ICdwZXJzb25hbCc7XHJcbiAgICBzZWxlY3RlZEdyb3VwSWQ6IHN0cmluZztcclxuICAgIHNlbGVjdGVkR3JvdXBUb3RhbDogbnVtYmVyO1xyXG4gICAgYWxsSW5kZXhJZDogc3RyaW5nO1xyXG4gICAgc2hvd0dyb3VwT3JnRGlhbG9nID0gZmFsc2U7XHJcbiAgICBjdXJyZW50R3JvdXBUeXBlID0gJ3B1YmxpYyc7XHJcbiAgICBzaG93Q2hlY2tBbGxJY29uOiBib29sZWFuID0gdHJ1ZTtcclxuICAgIHByaXZhdGUgc2VsZWN0aW9uc1N1YjogU3Vic2NyaXB0aW9uO1xyXG4gICAgcHJpdmF0ZSBmYXZvcml0ZXNTdWI6IFN1YnNjcmlwdGlvbjtcclxuICAgIHByaXZhdGUgbWVzc2FnZVNlcnZpY2U6IE1lc3NhZ2VyU2VydmljZSA9IG51bGw7XHJcbiAgICBwcml2YXRlIGxvYWRpbmdTZXJ2aWNlOiBMb2FkaW5nU2VydmljZSA9IG51bGw7XHJcbiAgICBwcml2YXRlIG5vdGlmeVNlcnZpY2U6IE5vdGlmeVNlcnZpY2UgPSBudWxsO1xyXG4gICAgcHJpdmF0ZSBsb2NhbGVTZXJ2aWNlOiBMb2NhbGVTZXJ2aWNlID0gbnVsbDtcclxuXHJcbiAgICBjb25zdHJ1Y3RvcihcclxuICAgICAgICBwcml2YXRlIGFwaVNlcnZpY2U6IEFwaVNlcnZpY2UsXHJcbiAgICAgICAgcHJpdmF0ZSBmYXZvcml0ZXNUb29sOiBGYXZvcml0ZXNUb29sLFxyXG4gICAgICAgIHByaXZhdGUgc3RhdGVNZ3I6IFN0YXRlTWdyVG9vbCxcclxuICAgICAgICBwcml2YXRlIGNkcjogQ2hhbmdlRGV0ZWN0b3JSZWYsXHJcbiAgICAgICAgQE9wdGlvbmFsKCkgcHJpdmF0ZSBpbmplY3RvcjogSW5qZWN0b3JcclxuICAgICkge1xyXG4gICAgICAgIHRoaXMuYWxsSW5kZXhJZCA9IENvbW1vblV0aWwubmV3R3VpZCgpO1xyXG4gICAgICAgIHRoaXMubWVzc2FnZVNlcnZpY2UgPSB0aGlzLmluamVjdG9yLmdldChNZXNzYWdlclNlcnZpY2UsIG51bGwpO1xyXG4gICAgICAgIHRoaXMubG9hZGluZ1NlcnZpY2UgPSB0aGlzLmluamVjdG9yLmdldChMb2FkaW5nU2VydmljZSwgbnVsbCk7XHJcbiAgICAgICAgdGhpcy5ub3RpZnlTZXJ2aWNlID0gdGhpcy5pbmplY3Rvci5nZXQoTm90aWZ5U2VydmljZSwgbnVsbCk7XHJcbiAgICAgICAgdGhpcy5sb2NhbGVTZXJ2aWNlID0gdGhpcy5pbmplY3Rvci5nZXQoTG9jYWxlU2VydmljZSk7XHJcbiAgICAgICAgaWYoIXRoaXMubG9jYWxlU2VydmljZS5sYW5nRGF0YVsnb3JnYW5pemF0aW9uU2VsZWN0b3InXSkge1xyXG4gICAgICAgICAgICB0aGlzLmxvY2FsZVNlcnZpY2Uuc2V0TG9jYWxlRGF0YShPUkdBTklaQVRJT05fU0VMRUNUT1JfTE9DQUxFKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgbmdPbkRlc3Ryb3koKTogdm9pZCB7XHJcbiAgICAgICAgaWYgKHRoaXMuZW5hYmxlRmF2b3JpdGVzKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZmF2b3JpdGVzU3ViLnVuc3Vic2NyaWJlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuc2VsZWN0aW9uc1N1Yi51bnN1YnNjcmliZSgpO1xyXG4gICAgfVxyXG5cclxuICAgIG5nT25Jbml0KCk6IHZvaWQge1xyXG4gICAgICAgIGlmICh0aGlzLmVuYWJsZUZhdm9yaXRlcykge1xyXG4gICAgICAgICAgICB0aGlzLmZhdm9yaXRlc1N1YiA9IHRoaXMuZmF2b3JpdGVzVG9vbC5mYXZvcml0ZXNTdWJqZWN0LnN1YnNjcmliZShkYXRhID0+IHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZmF2b3JpdGVzTGlzdCA9IGRhdGE7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNldEZhdm9yaXRlcygpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5zZWxlY3Rpb25zU3ViID0gdGhpcy5zdGF0ZU1nci5zZWxlY3Rpb25zU3ViamVjdC5zdWJzY3JpYmUoZGF0YSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChkYXRhLmNoYW5nZVR5cGUgPT09IENoYW5nZVR5cGUuVmFsdWVDaGFuZ2VkKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGlvbnMgPSBfLmNsb25lRGVlcChkYXRhLnZhbHVlKTsgXHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoZGF0YS5jaGFuZ2VUeXBlID09PSBDaGFuZ2VUeXBlLlJlbW92ZSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy51blNlbGVjdExpbmUoZGF0YS52YWx1ZSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoZGF0YS5jaGFuZ2VUeXBlID09PSBDaGFuZ2VUeXBlLkFwcGVuZCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RMaW5lKGRhdGEudmFsdWUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMudG9nZ2xlQ2hlY2tlZCgpO1xyXG4gICAgICAgICAgICB0aGlzLmNkci5kZXRlY3RDaGFuZ2VzKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgaWYodGhpcy5pc0FjdGl2ZVRhYikge1xyXG4gICAgICAgICAgICB0aGlzLmdldEdyb3VwTGlzdCgpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBuZ0FmdGVyVmlld0luaXQoKTogdm9pZCB7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIGFzc2VtYmxlRGF0YShyZWxvYWQ6IGJvb2xlYW4gPSBmYWxzZSkge1xyXG4gICAgICAgIGlmKHJlbG9hZCkge1xyXG4gICAgICAgICAgICB0aGlzLmdldEdyb3VwTGlzdCgpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyDlj5jmm7TnvqTnu4TlhoXnmoTnu4Tnu4dcclxuICAgIHVwZGF0ZUdyb3VwKCkge1xyXG4gICAgICAgIGNvbnN0IGFkZExpc3Q6IGFueVtdID0gW107XHJcbiAgICAgICAgY29uc3QgcHJpbWFyeUlkcyA9IHRoaXMuaXRlbXMubWFwKGl0ZW0gPT4geyByZXR1cm4gaXRlbVt0aGlzLnByaW1hcnlGaWVsZF19KS5qb2luKCk7XHJcbiAgICAgICAgdGhpcy5hcHBlbmRPcmcuY3VycmVudE9yZ3MuZm9yRWFjaChvcmcgPT4ge1xyXG4gICAgICAgICAgICBpZihwcmltYXJ5SWRzLmluZGV4T2Yob3JnW3RoaXMucHJpbWFyeUZpZWxkXSkgPT09IC0xKSB7XHJcbiAgICAgICAgICAgICAgICBhZGRMaXN0LnB1c2gob3JnW3RoaXMucHJpbWFyeUZpZWxkXSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICBpZigodGhpcy5zZWxlY3RlZEdyb3VwVG90YWwgKyBhZGRMaXN0Lmxlbmd0aCkgPiAxMDAwKSB7XHJcbiAgICAgICAgICAgIHRoaXMubWVzc2FnZVNlcnZpY2Uuc2hvdygnd2FybmluZycsIHRoaXMubG9jYWxlU2VydmljZS5nZXRWYWx1ZShcIm9yZ2FuaXphdGlvblNlbGVjdG9yLmVycm9yTWVzc2FnZS5saW1pdFwiKSwgdHJ1ZSk7XHJcbiAgICAgICAgICAgIHRoaXMudG9nZ2xlR3JvdXBPcmdEaWFsb2coZmFsc2UpO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IGFkZE9yZ3NJbkN1cnJlbnRHcm91cCQgPSB0aGlzLmFwaVNlcnZpY2Uuc2F2ZUdyb3VwKHtcclxuICAgICAgICAgICAgZ3JvdXBJZDogdGhpcy5zZWxlY3RlZEdyb3VwSWQsXHJcbiAgICAgICAgICAgIGFkZElkczogYWRkTGlzdCxcclxuICAgICAgICAgICAgZGVsZXRlSWRzOiBbXSxcclxuICAgICAgICAgICAgY2hhbmdlVHlwZTogTnVtYmVyKDMpXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgYWRkT3Jnc0luQ3VycmVudEdyb3VwJC5waXBlKFxyXG4gICAgICAgICAgICB0YXAoXHJcbiAgICAgICAgICAgICAgICAoZGF0YSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5nZXRPcmdzQnlHcm91cCh7IGlkOiB0aGlzLnNlbGVjdGVkR3JvdXBJZCB9LCB0aGlzLmN1cnJlbnRHcm91cFR5cGUsIHt1cGRhdGVHcm91cDogdHJ1ZX0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnRvZ2dsZUdyb3VwT3JnRGlhbG9nKGZhbHNlKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgKGVycm9yKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5tZXNzYWdlU2VydmljZS5zaG93KCdlcnJvcicsIHRoaXMubG9jYWxlU2VydmljZS5nZXRWYWx1ZShcIm9yZ2FuaXphdGlvblNlbGVjdG9yLmVycm9yTWVzc2FnZS5hcHBlbmRPcmdhbml6YXRpb25cIiksIHRydWUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICApXHJcbiAgICAgICAgKS5zdWJzY3JpYmUoKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyDliKDpmaTnvqTnu4RcclxuICAgIGRlbGV0ZUdyb3VwKGU6IE1vdXNlRXZlbnQsIGl0ZW06IEdyb3VwSXRlbSkge1xyXG4gICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgZS5jYW5jZWxCdWJibGUgPSB0cnVlO1xyXG4gICAgICAgIC8vIOaaguaXtuS7peatpOaWueW8j+WkhOeQhuWbvemZheWMluacqumAgumFjeS5i+WkhO+8iFRGU++8mjQ4NjQwMe+8iVxyXG4gICAgICAgIGl0ZW1bJ3RpdGxlJ10gPSBpdGVtWyd0aXRsZSddID8gaXRlbVsndGl0bGUnXSA6ICcnO1xyXG4gICAgICAgIHRoaXMubWVzc2FnZVNlcnZpY2UuY29uZmlybSh0aGlzLmxvY2FsZVNlcnZpY2UuZ2V0VmFsdWUoXCJvcmdhbml6YXRpb25TZWxlY3Rvci5jb25maXJtTWVzc2FnZS5kZWxldGVHcm91cFwiKSArXHJcbiAgICAgICAgICAgIGl0ZW1bJ3RpdGxlJ10gKyB0aGlzLmxvY2FsZVNlcnZpY2UuZ2V0VmFsdWUoXCJvcmdhbml6YXRpb25TZWxlY3Rvci5jb25maXJtTWVzc2FnZS5tYXJrXCIpKS5waXBlKFxyXG4gICAgICAgICAgICBzd2l0Y2hNYXAoKHJlc3VsdDogYm9vbGVhbikgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYoISFyZXN1bHQpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoaXRlbVt0aGlzLmdyb3VwSWRGaWVsZF0gPT09IHRoaXMuc2VsZWN0ZWRHcm91cElkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRHcm91cElkID0gbnVsbDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RlZEdyb3VwVG90YWwgPSAwO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRHcm91cFR5cGUgPSB0aGlzLnB1YmxpY1Rva2VuO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBkZWxldGVHcm91cCQgPSB0aGlzLmFwaVNlcnZpY2Uuc2F2ZUdyb3VwKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZ3JvdXBJZDogaXRlbVt0aGlzLmdyb3VwSWRGaWVsZF0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNoYW5nZVR5cGU6IE51bWJlcig0KVxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkZWxldGVHcm91cCQucGlwZShcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGFwKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKGRhdGEpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZ2V0R3JvdXBMaXN0KHtkZWxldGVHcm91cDogdHJ1ZX0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKGVycm9yKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5tZXNzYWdlU2VydmljZS5zaG93KCdlcnJvcicsIHRoaXMubG9jYWxlU2VydmljZS5nZXRWYWx1ZShcIm9yZ2FuaXphdGlvblNlbGVjdG9yLmVycm9yTWVzc2FnZS5kZWxldGVHcm91cFwiKSwgdHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIClcclxuICAgICAgICAgICAgICAgICAgICApXHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBFTVBUWTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSlcclxuICAgICAgICApLnN1YnNjcmliZSgpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIOWPmOabtOe+pOe7hOWfuuacrOS/oeaBr++8iOWQjeensOOAgeaPj+i/sO+8iVxyXG4gICAgZWRpdEdyb3VwKGU6IE1vdXNlRXZlbnQsIGl0ZW06IEdyb3VwSXRlbSkge1xyXG4gICAgICAgIHRoaXMuc2VsZWN0ZWRHcm91cElkID0gaXRlbVt0aGlzLmdyb3VwSWRGaWVsZF07XHJcbiAgICAgICAgdGhpcy5zZWxlY3RlZEdyb3VwVG90YWwgPSBpdGVtWyd0b3RhbCddO1xyXG4gICAgICAgIHRoaXMuZ3JvdXBDaGFuZ2UubmV4dChpdGVtKTtcclxuICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgIGUuY2FuY2VsQnViYmxlID0gdHJ1ZTtcclxuICAgIH1cclxuXHJcbiAgICAvLyDliKDpmaTnvqTnu4TlhoXnmoTnu4Tnu4dcclxuICAgIHJlbW92ZU9yZyhlOiBhbnksIGRhdGE6IGFueSkge1xyXG4gICAgICAgIHRoaXMubWVzc2FnZVNlcnZpY2UuY29uZmlybSh0aGlzLmxvY2FsZVNlcnZpY2UuZ2V0VmFsdWUoXCJvcmdhbml6YXRpb25TZWxlY3Rvci5jb25maXJtTWVzc2FnZS5kZWxldGVPcmdhbml6YXRpb25cIikgK1xyXG4gICAgICAgICAgICBkYXRhWyduYW1lJ10gKyB0aGlzLmxvY2FsZVNlcnZpY2UuZ2V0VmFsdWUoXCJvcmdhbml6YXRpb25TZWxlY3Rvci5jb25maXJtTWVzc2FnZS5tYXJrXCIpKS5waXBlKFxyXG4gICAgICAgICAgICBzd2l0Y2hNYXAoKHJlc3VsdDogYm9vbGVhbikgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYoISFyZXN1bHQpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBkZWxldGVPcmckID0gdGhpcy5hcGlTZXJ2aWNlLnNhdmVHcm91cCh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGdyb3VwSWQ6IHRoaXMuc2VsZWN0ZWRHcm91cElkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhZGRJZHM6IFtdLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZWxldGVJZHM6IFtkYXRhW3RoaXMucHJpbWFyeUZpZWxkXV0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNoYW5nZVR5cGU6IE51bWJlcigzKVxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkZWxldGVPcmckLnBpcGUoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhcChcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIChkYXRhKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmdldE9yZ3NCeUdyb3VwKHsgaWQ6IHRoaXMuc2VsZWN0ZWRHcm91cElkIH0sIHRoaXMuY3VycmVudEdyb3VwVHlwZSwge3JlbW92ZU9yZzogdHJ1ZX0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlLmNhbmNlbEJ1YmJsZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIChlcnJvcikgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubWVzc2FnZVNlcnZpY2Uuc2hvdygnZXJyb3InLCB0aGlzLmxvY2FsZVNlcnZpY2UuZ2V0VmFsdWUoXCJvcmdhbml6YXRpb25TZWxlY3Rvci5lcnJvck1lc3NhZ2UuZGVsZXRlT3JnYW5pemF0aW9uXCIpLCB0cnVlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgKVxyXG4gICAgICAgICAgICAgICAgICAgIClcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIEVNUFRZO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICkuc3Vic2NyaWJlKCk7ICAgXHJcbiAgICB9XHJcblxyXG4gICAgLy8g6K6+572u576k57uE5YaF57uE57uH55qE5Yu+6YCJ54q25oCBXHJcbiAgICBwcml2YXRlIHNldENoZWNrZWQoZGF0YTogYW55LCBjaGVja2VkOiBib29sZWFuKSB7XHJcbiAgICAgICAgY29uc3QgaXRlbUluZGV4ID0gQ29tbW9uVXRpbC5maW5kSW5kZXgoZGF0YVt0aGlzLnByaW1hcnlGaWVsZF0sIHRoaXMucHJpbWFyeUZpZWxkLCB0aGlzLml0ZW1zKTtcclxuICAgICAgICBpZiAoaXRlbUluZGV4ID4gLTEpIHtcclxuICAgICAgICAgICAgdGhpcy5pdGVtc1tpdGVtSW5kZXhdLmNoZWNrZWQgPSBjaGVja2VkO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyDorr7nva7nvqTnu4TlhoXnu4Tnu4fnmoTmlLbol4/nirbmgIFcclxuICAgIHByaXZhdGUgc2V0RmF2b3JpdGVzKCkge1xyXG4gICAgICAgIHRoaXMuaXRlbXMuZm9yRWFjaChpdGVtID0+IHtcclxuICAgICAgICAgICAgaWYgKENvbW1vblV0aWwuZmluZEluZGV4KGl0ZW1bdGhpcy5wcmltYXJ5RmllbGRdLCB0aGlzLnByaW1hcnlGaWVsZCwgdGhpcy5mYXZvcml0ZXNMaXN0KSAhPT0gLTEpIHtcclxuICAgICAgICAgICAgICAgIGl0ZW0uaW5GYXZvcml0ZXMgPSB0cnVlO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgaXRlbS5pbkZhdm9yaXRlcyA9IGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSlcclxuICAgIH1cclxuXHJcbiAgICAvLyDpgJrov4flvLnnqpflop7liqDnvqTnu4TlhoXnmoTnu4Tnu4dcclxuICAgIHRvZ2dsZUdyb3VwT3JnRGlhbG9nKHNob3c6IGJvb2xlYW4sIGdyb3VwVHlwZSA9IHRoaXMucGVyc29uYWxUb2tlbikge1xyXG4gICAgICAgIGlmIChncm91cFR5cGUgPT09IHRoaXMucGVyc29uYWxUb2tlbikge1xyXG4gICAgICAgICAgICB0aGlzLnNob3dHcm91cE9yZ0RpYWxvZyA9IHNob3c7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8vIOiOt+WPluafkOS4que+pOe7hOWGheeahOaJgOaciee7hOe7h1xyXG4gICAgZ2V0T3Jnc0J5R3JvdXAoaXRlbTogYW55LCBncm91cFR5cGUgPSB0aGlzLnB1YmxpY1Rva2VuLCBjaGFuZ2VUeXBlOiBhbnkgPSBudWxsKSB7XHJcbiAgICAgICAgaWYodGhpcy5sb2FkaW5nU2VydmljZSkge1xyXG4gICAgICAgICAgICB0aGlzLmxvYWRpbmdTZXJ2aWNlLnNob3coKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5jdXJyZW50R3JvdXBUeXBlID0gZ3JvdXBUeXBlO1xyXG4gICAgICAgIHRoaXMuYWxsQ2hlY2tlZCA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuc2VsZWN0ZWRHcm91cElkID0gaXRlbVt0aGlzLmdyb3VwSWRGaWVsZF07XHJcbiAgICAgICAgLy90aGlzLnNlbGVjdGVkR3JvdXBUb3RhbCA9IGl0ZW1bJ3RvdGFsJ107XHJcbiAgICAgICAgY29uc3QgZ2V0T3JnR3JvdXBNZW1iZXJzJCA9IHRoaXMuYXBpU2VydmljZS5nZXRHcm91cE1lbWJlcnModGhpcy5zZWxlY3RlZEdyb3VwSWQsIHRoaXMuYWJzT3JnVHlwZSk7XHJcbiAgICAgICAgZ2V0T3JnR3JvdXBNZW1iZXJzJC5waXBlKFxyXG4gICAgICAgICAgICB0YXAoXHJcbiAgICAgICAgICAgICAgICAoZGF0YTogYW55KSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5pdGVtcyA9IGRhdGEgPyBkYXRhIDogW107XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5ncm91cERhdGEucGVyc29uYWwuZm9yRWFjaChpdGVtID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGl0ZW1bdGhpcy5ncm91cElkRmllbGRdID09PSB0aGlzLnNlbGVjdGVkR3JvdXBJZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RlZEdyb3VwVG90YWwgPSB0aGlzLml0ZW1zLmxlbmd0aDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKGl0ZW0udG90YWwgIT09IHRoaXMuaXRlbXMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlbS50b3RhbCA9IHRoaXMuaXRlbXMubGVuZ3RoO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5pdGVtcy5mb3JFYWNoKGl0ID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaXQuaW5kZXhJZCA9IE1hdGgucmFuZG9tKCkudG9TdHJpbmcoMTYpLnN1YnN0cmluZygyKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaXQuZW5hYmxlID0gdGhpcy5maWx0ZXJUeXBlID09ICdkaXNhYmxlJyA/ICF0aGlzLmRpc2FibGVPcmdMaXN0LmluY2x1ZGVzKGl0Lm9yZ0lkKSA6IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5pdGVtcyA9IHRoaXMuaXRlbXMuc2xpY2UoKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNob3dDaGVja0FsbEljb24gPSB0aGlzLml0ZW1zLmxlbmd0aCA/IHRydWUgOiBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnRvZ2dsZUNoZWNrZWQoKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNldEZhdm9yaXRlcygpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY2RyLmRldGVjdENoYW5nZXMoKTtcclxuICAgICAgICAgICAgICAgICAgICBpZih0aGlzLmxvYWRpbmdTZXJ2aWNlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubG9hZGluZ1NlcnZpY2UuY2xvc2UoKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYoY2hhbmdlVHlwZSAmJiBjaGFuZ2VUeXBlWyd1cGRhdGVHcm91cCddKSB7IFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm5vdGlmeVNlcnZpY2Uuc3VjY2Vzcyh0aGlzLmxvY2FsZVNlcnZpY2UuZ2V0VmFsdWUoXCJvcmdhbml6YXRpb25TZWxlY3Rvci5zdWNjZXNzTWVzc2FnZS5hcHBlbmRPcmdhbml6YXRpb25cIikpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZihjaGFuZ2VUeXBlICYmIGNoYW5nZVR5cGVbJ3JlbW92ZU9yZyddKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubm90aWZ5U2VydmljZS5zdWNjZXNzKHRoaXMubG9jYWxlU2VydmljZS5nZXRWYWx1ZShcIm9yZ2FuaXphdGlvblNlbGVjdG9yLnN1Y2Nlc3NNZXNzYWdlLmRlbGV0ZU9yZ2FuaXphdGlvblwiKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIChlcnJvcikgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmKHRoaXMubG9hZGluZ1NlcnZpY2UpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2FkaW5nU2VydmljZS5jbG9zZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IodGhpcy5sb2NhbGVTZXJ2aWNlLmdldFZhbHVlKFwib3JnYW5pemF0aW9uU2VsZWN0b3IuZXJyb3JNZXNzYWdlLmdldE9yZ2FuaXphdGlvblwiKSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIClcclxuICAgICAgICApLnN1YnNjcmliZSgpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIOiOt+WPlue7hOe7h+e+pOe7hOaVsOaNrlxyXG4gICAgZ2V0R3JvdXBMaXN0KGNoYW5nZVR5cGU6IGFueSA9IG51bGwpIHtcclxuICAgICAgICBpZih0aGlzLmxvYWRpbmdTZXJ2aWNlKSB7XHJcbiAgICAgICAgICAgIHRoaXMubG9hZGluZ1NlcnZpY2Uuc2hvdygpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCBnZXRPcmdHcm91cHMkID0gdGhpcy5hcGlTZXJ2aWNlLmdldE9yZ0dyb3Vwcyh0aGlzLmFic09yZ1R5cGUpO1xyXG4gICAgICAgIGdldE9yZ0dyb3VwcyQucGlwZShcclxuICAgICAgICAgICAgc3dpdGNoTWFwKFxyXG4gICAgICAgICAgICAgICAgKGRhdGE6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZ3JvdXBEYXRhLnB1YmxpYyA9IGRhdGEgJiYgZGF0YS5wdWJsaWNHcm91cCA/IGRhdGEucHVibGljR3JvdXAgOiBbXTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmdyb3VwRGF0YS5wZXJzb25hbCA9IGRhdGEgJiYgZGF0YS5wcml2YXRlR3JvdXAgPyBkYXRhLnByaXZhdGVHcm91cCA6IFtdO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmKHRoaXMuZ3JvdXBEYXRhLnB1YmxpYy5sZW5ndGggPT0gMCAmJiB0aGlzLmdyb3VwRGF0YS5wZXJzb25hbC5sZW5ndGggPT0gMCApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5pdGVtcyA9IFtdO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpZighdGhpcy5zZWxlY3RlZEdyb3VwSWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZmlyc3RQdWJsaWNHcm91cElkID0gdGhpcy5ncm91cERhdGEucHVibGljWzBdICYmIHRoaXMuZ3JvdXBEYXRhLnB1YmxpY1swXVt0aGlzLmdyb3VwSWRGaWVsZF07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGZpcnN0UGVyc29uYWxHcm91cElkID0gdGhpcy5ncm91cERhdGEucGVyc29uYWxbMF0gJiYgdGhpcy5ncm91cERhdGEucGVyc29uYWxbMF1bdGhpcy5ncm91cElkRmllbGRdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGVkR3JvdXBJZCA9IGZpcnN0UHVibGljR3JvdXBJZCA/IGZpcnN0UHVibGljR3JvdXBJZCA6IGZpcnN0UGVyc29uYWxHcm91cElkO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAoISF0aGlzLnNlbGVjdGVkR3JvdXBJZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5ncm91cERhdGEucHVibGljLmZpbmRJbmRleChpdGVtID0+IGl0ZW1bdGhpcy5ncm91cElkRmllbGRdID09PSB0aGlzLnNlbGVjdGVkR3JvdXBJZCkgIT09IC0xKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRHcm91cFR5cGUgPSB0aGlzLnB1YmxpY1Rva2VuO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMuZ3JvdXBEYXRhLnBlcnNvbmFsLmZpbmRJbmRleChpdGVtID0+IGl0ZW1bdGhpcy5ncm91cElkRmllbGRdID09PSB0aGlzLnNlbGVjdGVkR3JvdXBJZCkgIT09IC0xKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRHcm91cFR5cGUgPSB0aGlzLnBlcnNvbmFsVG9rZW47XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZ2V0T3JnR3JvdXBNZW1iZXJzJCA9IHRoaXMuYXBpU2VydmljZS5nZXRHcm91cE1lbWJlcnModGhpcy5zZWxlY3RlZEdyb3VwSWQsIHRoaXMuYWJzT3JnVHlwZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBnZXRPcmdHcm91cE1lbWJlcnMkLnBpcGUoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXAoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKHJlc0RhdGE6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLml0ZW1zID0gcmVzRGF0YSA/IHJlc0RhdGEgOiBbXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5ncm91cERhdGEucGVyc29uYWwuZm9yRWFjaChpdGVtID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpdGVtW3RoaXMuZ3JvdXBJZEZpZWxkXSA9PT0gdGhpcy5zZWxlY3RlZEdyb3VwSWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGVkR3JvdXBUb3RhbCA9IHRoaXMuaXRlbXMubGVuZ3RoO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKGl0ZW0udG90YWwgIT09IHRoaXMuaXRlbXMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW0udG90YWwgPSB0aGlzLml0ZW1zLmxlbmd0aDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLml0ZW1zLmZvckVhY2goaXQgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXQuaW5kZXhJZCA9IE1hdGgucmFuZG9tKCkudG9TdHJpbmcoMTYpLnN1YnN0cmluZygyKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0LmVuYWJsZSA9IHRoaXMuZmlsdGVyVHlwZSA9PSAnZGlzYWJsZScgPyAhdGhpcy5kaXNhYmxlT3JnTGlzdC5pbmNsdWRlcyhpdC5vcmdJZCkgOiB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5pdGVtcyA9IHRoaXMuaXRlbXMuc2xpY2UoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy50b2dnbGVDaGVja2VkKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0RmF2b3JpdGVzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY2RyLmRldGVjdENoYW5nZXMoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIChlcnJvcikgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZih0aGlzLmxvYWRpbmdTZXJ2aWNlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmxvYWRpbmdTZXJ2aWNlLmNsb3NlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKHRoaXMubG9jYWxlU2VydmljZS5nZXRWYWx1ZShcIm9yZ2FuaXphdGlvblNlbGVjdG9yLmVycm9yTWVzc2FnZS5nZXRPcmdhbml6YXRpb25cIikpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIClcclxuICAgICAgICAgICAgICAgICAgICAgICAgKVxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBvZih0cnVlKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICApLFxyXG4gICAgICAgICAgICB0YXAoXHJcbiAgICAgICAgICAgICAgICAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYodGhpcy5sb2FkaW5nU2VydmljZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmxvYWRpbmdTZXJ2aWNlLmNsb3NlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmKGNoYW5nZVR5cGUgJiYgY2hhbmdlVHlwZVsnc2F2ZUdyb3VwJ10pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5ub3RpZnlTZXJ2aWNlLnN1Y2Nlc3ModGhpcy5sb2NhbGVTZXJ2aWNlLmdldFZhbHVlKFwib3JnYW5pemF0aW9uU2VsZWN0b3Iuc3VjY2Vzc01lc3NhZ2Uuc2F2ZUdyb3VwXCIpKTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYoY2hhbmdlVHlwZSAmJiBjaGFuZ2VUeXBlWyd1cGRhdGVOYW1lT3JOb3RlJ10pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5ub3RpZnlTZXJ2aWNlLnN1Y2Nlc3ModGhpcy5sb2NhbGVTZXJ2aWNlLmdldFZhbHVlKFwib3JnYW5pemF0aW9uU2VsZWN0b3Iuc3VjY2Vzc01lc3NhZ2UuZWRpdEdyb3VwXCIpKTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYoY2hhbmdlVHlwZSAmJiBjaGFuZ2VUeXBlWydkZWxldGVHcm91cCddKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubm90aWZ5U2VydmljZS5zdWNjZXNzKHRoaXMubG9jYWxlU2VydmljZS5nZXRWYWx1ZShcIm9yZ2FuaXphdGlvblNlbGVjdG9yLnN1Y2Nlc3NNZXNzYWdlLmRlbGV0ZUdyb3VwXCIpKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgKGVycm9yKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYodGhpcy5sb2FkaW5nU2VydmljZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmxvYWRpbmdTZXJ2aWNlLmNsb3NlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcih0aGlzLmxvY2FsZVNlcnZpY2UuZ2V0VmFsdWUoXCJvcmdhbml6YXRpb25TZWxlY3Rvci5lcnJvck1lc3NhZ2UuZ2V0R3JvdXBcIikpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICApXHJcbiAgICAgICAgKS5zdWJzY3JpYmUoKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyDmlLbol4/miJbogIXlj5bmtojmlLbol4/nu4Tnu4dcclxuICAgIHRvZ2dsZUZhdm9yaXRlcyhlOiBhbnksIGl0ZW06IGFueSkge1xyXG4gICAgICAgIHRoaXMuZmF2b3JpdGVzVG9vbC50b2dnbGVGYXZvcml0ZXMoZSwgaXRlbSk7XHJcbiAgICAgICAgdGhpcy5zZXRGYXZvcml0ZXMoKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyDliIfmjaLlhazlhbHnvqTnu4TmiJbogIXkuKrkurrnvqTnu4TnmoTmlLbmipjnirbmgIFcclxuICAgIHRvZ2dsZVZpc2libGUoZSwgdHlwZTogc3RyaW5nKSB7XHJcbiAgICAgICAgaWYgKHR5cGUgPT09IHRoaXMucHVibGljVG9rZW4pIHtcclxuICAgICAgICAgICAgdGhpcy5wdWJsaWNWaXNpYmxlID0gIXRoaXMucHVibGljVmlzaWJsZTtcclxuICAgICAgICB9IGVsc2UgaWYgKHR5cGUgPT09IHRoaXMucGVyc29uYWxUb2tlbikge1xyXG4gICAgICAgICAgICB0aGlzLnBlcnNvbmFsVmlzaWJsZSA9ICF0aGlzLnBlcnNvbmFsVmlzaWJsZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICBlLmNhbmNlbEJ1YmJsZSA9IHRydWU7XHJcbiAgICB9XHJcblxyXG4gICAgdG9nZ2xlQWxsKGU6IGFueSkge1xyXG4gICAgICAgIGlmICghdGhpcy5hbGxDaGVja2VkKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2hlY2tBbGwoKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLnVuQ2hlY2tBbGwoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgfVxyXG5cclxuICAgIHRvZ2dsZU9uZShkYXRhLCBlKSB7XHJcbiAgICAgICAgaWYoIWRhdGEuZW5hYmxlKSB7XHJcbiAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgICAgIGUuY2FuY2VsQnViYmxlID0gdHJ1ZTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoZGF0YS5jaGVja2VkKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLm11bHRpU2VsZWN0KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmVtaXRTZWxlY3Rpb25zKGRhdGEsIENoYW5nZVR5cGUuUmVtb3ZlKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZW1pdFNlbGVjdGlvbnMoW10pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMubXVsdGlTZWxlY3QpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZW1pdFNlbGVjdGlvbnMoZGF0YSwgQ2hhbmdlVHlwZS5BcHBlbmQpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5lbWl0U2VsZWN0aW9ucyhuZXcgQXJyYXkoZGF0YSkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOWFqOmAieWQjuWkhOeQhlxyXG4gICAgICogQHBhcmFtIGRhdGFBcnIg5YWo6YCJ55qE5YC8XHJcbiAgICAgKi9cclxuICAgIGNoZWNrQWxsKCkge1xyXG4gICAgICAgIHRoaXMuaXRlbXMuZm9yRWFjaChpdGVtID0+IHtcclxuICAgICAgICAgICAgaWYgKENvbW1vblV0aWwuZmluZEluZGV4KGl0ZW1bdGhpcy5wcmltYXJ5RmllbGRdLCB0aGlzLnByaW1hcnlGaWVsZCwgdGhpcy5zZWxlY3Rpb25zKSA9PT0gLTEgJiYgaXRlbS5lbmFibGUpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZW1pdFNlbGVjdGlvbnMoaXRlbSwgQ2hhbmdlVHlwZS5BcHBlbmQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDlhajpg6jlj5bmtohcclxuICAgICAqIEBwYXJhbSBkYXRhQXJyIOWPlua2iOeahOaVsOaNrlxyXG4gICAgICogQHJldHVybnMgdm9pZFxyXG4gICAgICovXHJcbiAgICB1bkNoZWNrQWxsKCkge1xyXG4gICAgICAgIGNvbnN0IGNoZWNrZWRzID0gdGhpcy5pdGVtcy5maWx0ZXIoaXRlbSA9PiBpdGVtLmNoZWNrZWQpO1xyXG4gICAgICAgIGNoZWNrZWRzLmZvckVhY2goaXRlbSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuZW1pdFNlbGVjdGlvbnMoaXRlbSwgQ2hhbmdlVHlwZS5SZW1vdmUpO1xyXG4gICAgICAgIH0pXHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDlvZPliY3ooYzpgInkuK1cclxuICAgICAqIEBwYXJhbSBkYXRhIOW9k+WJjeihjOeahOaVsOaNru+8iO+8iVxyXG4gICAgICovXHJcbiAgICBzZWxlY3RMaW5lKGRhdGE6IGFueSkge1xyXG4gICAgICAgIGlmICh0aGlzLm11bHRpU2VsZWN0KSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2luc2VydE9uZUludG9TZWxlY3Rpb25zKGRhdGEpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0aW9ucyA9IFtdO1xyXG4gICAgICAgICAgICB0aGlzLml0ZW1zLmZvckVhY2goaXRlbSA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAoaXRlbS5jaGVja2VkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaXRlbS5jaGVja2VkID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB0aGlzLl9pbnNlcnRPbmVJbnRvU2VsZWN0aW9ucyhkYXRhKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMuaXNBbGxDaGVja2VkKCkpIHtcclxuICAgICAgICAgICAgdGhpcy5hbGxDaGVja2VkID0gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDljZXpgInlj5bmtojpgInkuK1cclxuICAgICAqIEBwYXJhbSBkYXRhIOWPlua2iOmAieS4reihjFxyXG4gICAgICovXHJcbiAgICB1blNlbGVjdExpbmUoZGF0YTogYW55KSB7XHJcbiAgICAgICAgY29uc3QgaW5kZXggPSBDb21tb25VdGlsLmZpbmRJbmRleChkYXRhW3RoaXMucHJpbWFyeUZpZWxkXSwgdGhpcy5wcmltYXJ5RmllbGQsIHRoaXMuc2VsZWN0aW9ucyk7XHJcbiAgICAgICAgaWYgKGluZGV4ID4gLTEpIHtcclxuICAgICAgICAgICAgdGhpcy5zZWxlY3Rpb25zLnNwbGljZShpbmRleCwgMSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuc2V0Q2hlY2tlZChkYXRhLCBmYWxzZSk7XHJcbiAgICAgICAgaWYgKHRoaXMuYWxsQ2hlY2tlZCkge1xyXG4gICAgICAgICAgICB0aGlzLmFsbENoZWNrZWQgPSBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBlbWl0U2VsZWN0aW9ucyhzZWxlY3Rpb25zOiBhbnksIGNoYW5nZVR5cGUgPSBDaGFuZ2VUeXBlLlZhbHVlQ2hhbmdlZCwgZnJvbSA9ICdncm91cCcpIHtcclxuICAgICAgICB0aGlzLnN0YXRlTWdyLmVtaXRTZWxlY3Rpb25zKHNlbGVjdGlvbnMsIGNoYW5nZVR5cGUsIGZyb20pO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog6YCJ5Lit5bm25o+S5YWl5b2T5YmN6KGM5pWw5o2u5Yiw5Y+z5L6nXHJcbiAgICAgKiBAcGFyYW0gZGF0YSDlvZPliY3ooYznmoTmlbDmja5cclxuICAgICAqIEBwYXJhbSBjb2xsZWN0aW9uIOaaguWtmOW9k+WJjeaVsOaNrueahOmbhuWQiFxyXG4gICAgICovXHJcbiAgICBfaW5zZXJ0T25lSW50b1NlbGVjdGlvbnMoZGF0YTogYW55KSB7XHJcbiAgICAgICAgLy8g5aaC5p6c5b2T5YmN5pWw5o2u5bey57uP56e75YWl5Y+z5L6n5pWw5o2u77yM5YiZ6L+U5Zue44CCXHJcbiAgICAgICAgaWYgKENvbW1vblV0aWwuZmluZEluZGV4KGRhdGFbdGhpcy5wcmltYXJ5RmllbGRdLCB0aGlzLnByaW1hcnlGaWVsZCwgdGhpcy5zZWxlY3Rpb25zKSA+IC0xKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5zZXRDaGVja2VkKGRhdGEsIHRydWUpO1xyXG4gICAgICAgIHRoaXMuc2VsZWN0aW9ucy5wdXNoKGRhdGEpO1xyXG4gICAgICAgIHRoaXMuc2VsZWN0aW9ucyA9IHRoaXMuc2VsZWN0aW9ucy5zbGljZSgpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog57+76aG15qOA5p+l77ya5Lq65ZGY5bGV56S65Yy655qE5Yu+6YCJ54q25oCB5LiO5bey6YCJ5Lq65ZGY5Yy65piv5ZCm5a+55bqUXHJcbiAgICAgKi9cclxuICAgIHRvZ2dsZUNoZWNrZWQoKSB7XHJcbiAgICAgICAgdGhpcy5pdGVtcy5mb3JFYWNoKGl0ZW0gPT4ge1xyXG4gICAgICAgICAgICBpZiAoQ29tbW9uVXRpbC5maW5kSW5kZXgoaXRlbVt0aGlzLnByaW1hcnlGaWVsZF0sIHRoaXMucHJpbWFyeUZpZWxkLCB0aGlzLnNlbGVjdGlvbnMpID4gLTEgJiYgaXRlbS5lbmFibGUpIHtcclxuICAgICAgICAgICAgICAgIGl0ZW0uY2hlY2tlZCA9IHRydWU7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBpdGVtLmNoZWNrZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGlmICh0aGlzLmlzQWxsQ2hlY2tlZCgpKSB7XHJcbiAgICAgICAgICAgIHRoaXMuYWxsQ2hlY2tlZCA9IHRydWU7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5hbGxDaGVja2VkID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgaXNBbGxDaGVja2VkKCk6IGJvb2xlYW4ge1xyXG4gICAgICAgIGxldCBjb3VudCA9IDA7XHJcbiAgICAgICAgbGV0IGFsbENoZWNrZWQgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgdGhpcy5pdGVtcy5mb3JFYWNoKGl0ZW0gPT4ge1xyXG4gICAgICAgICAgICB0aGlzLnNlbGVjdGlvbnMuZm9yRWFjaChzZWxlY3Rpb24gPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKGl0ZW1bdGhpcy5wcmltYXJ5RmllbGRdID09PSBzZWxlY3Rpb25bdGhpcy5wcmltYXJ5RmllbGRdKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY291bnQgKz0gMTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgaWYgKHRoaXMuaXRlbXMuZmlsdGVyKGl0ZW0gPT4gaXRlbS5lbmFibGUpLmxlbmd0aCA9PT0gY291bnQgJiYgY291bnQgPiAwKSB7XHJcbiAgICAgICAgICAgIGFsbENoZWNrZWQgPSB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gYWxsQ2hlY2tlZDtcclxuICAgIH1cclxuXHJcbiAgICB0cmFja0J5Rm4oaW5kZXgsIGl0ZW0pIHtcclxuICAgICAgICByZXR1cm4gaW5kZXg7XHJcbiAgICB9XHJcblxyXG59XHJcbiJdfQ==