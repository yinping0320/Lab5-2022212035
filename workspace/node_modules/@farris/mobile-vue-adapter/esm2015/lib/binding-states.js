/**
 * @fileoverview added by tsickle
 * Generated from: lib/binding-states.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { recompute } from './recompute';
/**
 * 绑定状态
 */
class BindingStates {
    /**
     * 构造函数
     * @param {?} vueInstance
     */
    constructor(vueInstance) {
        this.vueInstance = vueInstance;
        /** @type {?} */
        const viewModel = (/** @type {?} */ (this.vueInstance.$getViewModel()));
        this.viewModelContext = viewModel.context;
        this.subscriptionsMap = new Map();
    }
    /**
     * 映射实体列表数据
     * @return {?}
     */
    getEntityListData() {
        /** @type {?} */
        const stateName = 'entityListData';
        if (this.subscriptionsMap.has(stateName) === false) {
            /** @type {?} */
            const subscription = this.viewModelContext.bindingData.changes.subscribe((/**
             * @param {?} change
             * @return {?}
             */
            (change) => {
                recompute(this.vueInstance, stateName);
            }));
            this.subscriptionsMap.set(stateName, subscription);
        }
        return this.viewModelContext.bindingData.getList().toJSON();
    }
    /**
     * 映射当前实体数据
     * @return {?}
     */
    getCurrentEntityData() {
        /** @type {?} */
        const stateName = 'currentEntityData';
        if (this.subscriptionsMap.has(stateName) === false) {
            /** @type {?} */
            const subscription = this.viewModelContext.bindingData.changes.subscribe((/**
             * @param {?} change
             * @return {?}
             */
            (change) => {
                recompute(this.vueInstance, stateName);
            }));
            this.subscriptionsMap.set(stateName, subscription);
        }
        return this.viewModelContext.bindingData.getObject().toJSON();
    }
    /**
     * 映射UIState数据
     * @return {?}
     */
    getUIState() {
        /** @type {?} */
        const stateName = 'uiState';
        if (this.subscriptionsMap.has(stateName) === false) {
            /** @type {?} */
            const subscription = this.viewModelContext.uiState.changes.subscribe((/**
             * @return {?}
             */
            () => {
                recompute(this.vueInstance, stateName);
            }));
            this.subscriptionsMap.set(stateName, subscription);
        }
        return this.viewModelContext.uiState;
    }
    /**
     * 映射表单
     * @return {?}
     */
    getForm() {
        /** @type {?} */
        const stateName = 'form';
        if (this.subscriptionsMap.has(stateName) === false) {
            /** @type {?} */
            const subscription = this.viewModelContext.bindingData.changes.subscribe((/**
             * @param {?} change
             * @return {?}
             */
            (change) => {
                if (change && change.type === "ValueChanged") {
                    this.viewModelContext.form.getFieldErrorByPath(change.path);
                }
                recompute(this.vueInstance, stateName);
            }));
            /** @type {?} */
            const subscriptionV = this.viewModelContext.form.changes.subscribe((/**
             * @param {?} data
             * @return {?}
             */
            (data) => {
                if (data && data.type === 'validateFieldsFinished') {
                    recompute(this.vueInstance, stateName);
                }
                else if (data && data.type === 'singleHanded') {
                    /** @type {?} */
                    const index = this.vueInstance.$children.findIndex((/**
                     * @param {?} item
                     * @return {?}
                     */
                    (item) => { return item.$attrs.id === `form_${data.value}`; }));
                    this.vueInstance.$children[index].$forceUpdate();
                }
            }));
            this.subscriptionsMap.set(stateName, subscription);
            this.subscriptionsMap.set(stateName + 'V', subscriptionV);
        }
        return this.vueInstance.$getViewModel().form;
    }
    /**
     * 映射状态机
     * @return {?}
     */
    getStateMachine() {
        /** @type {?} */
        const stateName = 'stateMachine';
        if (this.subscriptionsMap.has(stateName) === false) {
            /** @type {?} */
            const subscription = this.viewModelContext.stateMachine.stateChange.subscribe((/**
             * @param {?} change
             * @return {?}
             */
            (change) => {
                recompute(this.vueInstance, stateName);
            }));
            this.subscriptionsMap.set(stateName, subscription);
        }
        return this.viewModelContext.stateMachine.renderStates;
    }
}
if (false) {
    /**
     * Vue实例
     * @type {?}
     * @private
     */
    BindingStates.prototype.vueInstance;
    /**
     * Vue实例的ViewModelContext
     * @type {?}
     * @private
     */
    BindingStates.prototype.viewModelContext;
    /**
     * 订阅集合
     * @type {?}
     * @private
     */
    BindingStates.prototype.subscriptionsMap;
}
export { BindingStates };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYmluZGluZy1zdGF0ZXMuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZmFycmlzL21vYmlsZS12dWUtYWRhcHRlci8iLCJzb3VyY2VzIjpbImxpYi9iaW5kaW5nLXN0YXRlcy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7OztBQUVBLE9BQU8sRUFBRSxTQUFTLEVBQUUsTUFBTSxhQUFhLENBQUM7Ozs7QUFLeEMsTUFBTSxhQUFhOzs7OztJQXFCakIsWUFBWSxXQUFnQjtRQUMxQixJQUFJLENBQUMsV0FBVyxHQUFHLFdBQVcsQ0FBQzs7Y0FDekIsU0FBUyxHQUFHLG1CQUFBLElBQUksQ0FBQyxXQUFXLENBQUMsYUFBYSxFQUFFLEVBQWE7UUFDL0QsSUFBSSxDQUFDLGdCQUFnQixHQUFHLFNBQVMsQ0FBQyxPQUFPLENBQUM7UUFDMUMsSUFBSSxDQUFDLGdCQUFnQixHQUFHLElBQUksR0FBRyxFQUF3QixDQUFDO0lBQzFELENBQUM7Ozs7O0lBS00saUJBQWlCOztjQUNoQixTQUFTLEdBQUcsZ0JBQWdCO1FBQ2xDLElBQUksSUFBSSxDQUFDLGdCQUFnQixDQUFDLEdBQUcsQ0FBQyxTQUFTLENBQUMsS0FBSyxLQUFLLEVBQUU7O2tCQUM1QyxZQUFZLEdBQUcsSUFBSSxDQUFDLGdCQUFnQixDQUFDLFdBQVcsQ0FBQyxPQUFPLENBQUMsU0FBUzs7OztZQUFDLENBQUMsTUFBYyxFQUFFLEVBQUU7Z0JBQzFGLFNBQVMsQ0FBQyxJQUFJLENBQUMsV0FBVyxFQUFFLFNBQVMsQ0FBQyxDQUFDO1lBQ3pDLENBQUMsRUFBQztZQUNGLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxHQUFHLENBQUMsU0FBUyxFQUFFLFlBQVksQ0FBQyxDQUFDO1NBQ3BEO1FBQ0QsT0FBTyxJQUFJLENBQUMsZ0JBQWdCLENBQUMsV0FBVyxDQUFDLE9BQU8sRUFBRSxDQUFDLE1BQU0sRUFBRSxDQUFDO0lBQzlELENBQUM7Ozs7O0lBS00sb0JBQW9COztjQUNuQixTQUFTLEdBQUcsbUJBQW1CO1FBQ3JD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UUFDRCxPQUFPLElBQUksQ0FBQyxXQUFXLENBQUMsYUFBYSxFQUFFLENBQUMsSUFBSSxDQUFDO0lBQy9DLENBQUM7Ozs7O0lBS00sZUFBZTs7Y0FDZCxTQUFTLEdBQUcsY0FBYztRQUNoQyxJQUFJLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxHQUFHLENBQUMsU0FBUyxDQUFDLEtBQUssS0FBSyxFQUFFOztrQkFDNUMsWUFBWSxHQUFHLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxZQUFZLENBQUMsV0FBVyxDQUFDLFNBQVM7Ozs7WUFBQyxDQUFDLE1BQVcsRUFBRSxFQUFFO2dCQUM1RixTQUFTLENBQUMsSUFBSSxDQUFDLFdBQVcsRUFBRSxTQUFTLENBQUMsQ0FBQztZQUN6QyxDQUFDLEVBQUM7WUFDRixJQUFJLENBQUMsZ0JBQWdCLENBQUMsR0FBRyxDQUFDLFNBQVMsRUFBRSxZQUFZLENBQUMsQ0FBQztTQUNwRDtRQUVELE9BQU8sSUFBSSxDQUFDLGdCQUFnQixDQUFDLFlBQVksQ0FBQyxZQUFZLENBQUM7SUFDekQsQ0FBQztDQUNGOzs7Ozs7O0lBekdDLG9DQUF5Qjs7Ozs7O0lBS3pCLHlDQUEyQzs7Ozs7O0lBSzNDLHlDQUFvRDs7QUFpR3RELE9BQU8sRUFBRSxhQUFhLEVBQUUsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFN1YnNjcmlwdGlvbiB9IGZyb20gJ3J4anMnO1xyXG5pbXBvcnQgeyBWaWV3TW9kZWwsIFZpZXdNb2RlbENvbnRleHQsIENoYW5nZSB9IGZyb20gJ0BmYXJyaXMvbW9iaWxlLWRldmtpdCc7XHJcbmltcG9ydCB7IHJlY29tcHV0ZSB9IGZyb20gJy4vcmVjb21wdXRlJztcclxuXHJcbi8qKlxyXG4gKiDnu5HlrprnirbmgIFcclxuICovXHJcbmNsYXNzIEJpbmRpbmdTdGF0ZXMge1xyXG5cclxuICAvKipcclxuICAgKiBWdWXlrp7kvotcclxuICAgKi9cclxuICBwcml2YXRlIHZ1ZUluc3RhbmNlOiBhbnk7XHJcblxyXG4gIC8qKlxyXG4gICAqIFZ1ZeWunuS+i+eahFZpZXdNb2RlbENvbnRleHRcclxuICAgKi9cclxuICBwcml2YXRlIHZpZXdNb2RlbENvbnRleHQ6IFZpZXdNb2RlbENvbnRleHQ7XHJcblxyXG4gIC8qKlxyXG4gICAqIOiuoumYhembhuWQiFxyXG4gICAqL1xyXG4gIHByaXZhdGUgc3Vic2NyaXB0aW9uc01hcDogTWFwPHN0cmluZywgU3Vic2NyaXB0aW9uPjtcclxuXHJcbiAgLyoqXHJcbiAgICog5p6E6YCg5Ye95pWwXHJcbiAgICogQHBhcmFtIHZpZXdNb2RlbENvbnRleHQgVmlld01vZGVs5LiK5LiL5paHXHJcbiAgICovXHJcbiAgY29uc3RydWN0b3IodnVlSW5zdGFuY2U6IGFueSkge1xyXG4gICAgdGhpcy52dWVJbnN0YW5jZSA9IHZ1ZUluc3RhbmNlO1xyXG4gICAgY29uc3Qgdmlld01vZGVsID0gdGhpcy52dWVJbnN0YW5jZS4kZ2V0Vmlld01vZGVsKCkgYXMgVmlld01vZGVsO1xyXG4gICAgdGhpcy52aWV3TW9kZWxDb250ZXh0ID0gdmlld01vZGVsLmNvbnRleHQ7XHJcbiAgICB0aGlzLnN1YnNjcmlwdGlvbnNNYXAgPSBuZXcgTWFwPHN0cmluZywgU3Vic2NyaXB0aW9uPigpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog5pig5bCE5a6e5L2T5YiX6KGo5pWw5o2uXHJcbiAgICovXHJcbiAgcHVibGljIGdldEVudGl0eUxpc3REYXRhKCkge1xyXG4gICAgY29uc3Qgc3RhdGVOYW1lID0gJ2VudGl0eUxpc3REYXRhJztcclxuICAgIGlmICh0aGlzLnN1YnNjcmlwdGlvbnNNYXAuaGFzKHN0YXRlTmFtZSkgPT09IGZhbHNlKSB7XHJcbiAgICAgIGNvbnN0IHN1YnNjcmlwdGlvbiA9IHRoaXMudmlld01vZGVsQ29udGV4dC5iaW5kaW5nRGF0YS5jaGFuZ2VzLnN1YnNjcmliZSgoY2hhbmdlOiBDaGFuZ2UpID0+IHtcclxuICAgICAgICByZWNvbXB1dGUodGhpcy52dWVJbnN0YW5jZSwgc3RhdGVOYW1lKTtcclxuICAgICAgfSk7XHJcbiAgICAgIHRoaXMuc3Vic2NyaXB0aW9uc01hcC5zZXQoc3RhdGVOYW1lLCBzdWJzY3JpcHRpb24pO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHRoaXMudmlld01vZGVsQ29udGV4dC5iaW5kaW5nRGF0YS5nZXRMaXN0KCkudG9KU09OKCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDmmKDlsITlvZPliY3lrp7kvZPmlbDmja5cclxuICAgKi9cclxuICBwdWJsaWMgZ2V0Q3VycmVudEVudGl0eURhdGEoKSB7XHJcbiAgICBjb25zdCBzdGF0ZU5hbWUgPSAnY3VycmVudEVudGl0eURhdGEnO1xyXG4gICAgaWYgKHRoaXMuc3Vic2NyaXB0aW9uc01hcC5oYXMoc3RhdGVOYW1lKSA9PT0gZmFsc2UpIHtcclxuICAgICAgY29uc3Qgc3Vic2NyaXB0aW9uID0gdGhpcy52aWV3TW9kZWxDb250ZXh0LmJpbmRpbmdEYXRhLmNoYW5nZXMuc3Vic2NyaWJlKChjaGFuZ2U6IENoYW5nZSkgPT4ge1xyXG4gICAgICAgIHJlY29tcHV0ZSh0aGlzLnZ1ZUluc3RhbmNlLCBzdGF0ZU5hbWUpO1xyXG4gICAgICB9KTtcclxuICAgICAgdGhpcy5zdWJzY3JpcHRpb25zTWFwLnNldChzdGF0ZU5hbWUsIHN1YnNjcmlwdGlvbik7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gdGhpcy52aWV3TW9kZWxDb250ZXh0LmJpbmRpbmdEYXRhLmdldE9iamVjdCgpLnRvSlNPTigpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog5pig5bCEVUlTdGF0ZeaVsOaNrlxyXG4gICAqL1xyXG4gIHB1YmxpYyBnZXRVSVN0YXRlKCkge1xyXG4gICAgY29uc3Qgc3RhdGVOYW1lID0gJ3VpU3RhdGUnO1xyXG4gICAgaWYgKHRoaXMuc3Vic2NyaXB0aW9uc01hcC5oYXMoc3RhdGVOYW1lKSA9PT0gZmFsc2UpIHtcclxuICAgICAgY29uc3Qgc3Vic2NyaXB0aW9uID0gdGhpcy52aWV3TW9kZWxDb250ZXh0LnVpU3RhdGUuY2hhbmdlcy5zdWJzY3JpYmUoKCkgPT4ge1xyXG4gICAgICAgIHJlY29tcHV0ZSh0aGlzLnZ1ZUluc3RhbmNlLCBzdGF0ZU5hbWUpO1xyXG4gICAgICB9KTtcclxuICAgICAgdGhpcy5zdWJzY3JpcHRpb25zTWFwLnNldChzdGF0ZU5hbWUsIHN1YnNjcmlwdGlvbik7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gdGhpcy52aWV3TW9kZWxDb250ZXh0LnVpU3RhdGU7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDmmKDlsITooajljZVcclxuICAgKi9cclxuICBwdWJsaWMgZ2V0Rm9ybSgpIHtcclxuICAgIGNvbnN0IHN0YXRlTmFtZSA9ICdmb3JtJztcclxuICAgIGlmICh0aGlzLnN1YnNjcmlwdGlvbnNNYXAuaGFzKHN0YXRlTmFtZSkgPT09IGZhbHNlKSB7XHJcbiAgICAgIGNvbnN0IHN1YnNjcmlwdGlvbiA9IHRoaXMudmlld01vZGVsQ29udGV4dC5iaW5kaW5nRGF0YS5jaGFuZ2VzLnN1YnNjcmliZSgoY2hhbmdlOiBDaGFuZ2UpID0+IHtcclxuICAgICAgICBpZiAoY2hhbmdlICYmIGNoYW5nZS50eXBlID09PSBcIlZhbHVlQ2hhbmdlZFwiKSB7XHJcbiAgICAgICAgICB0aGlzLnZpZXdNb2RlbENvbnRleHQuZm9ybS5nZXRGaWVsZEVycm9yQnlQYXRoKGNoYW5nZS5wYXRoKVxyXG4gICAgICAgIH1cclxuICAgICAgICByZWNvbXB1dGUodGhpcy52dWVJbnN0YW5jZSwgc3RhdGVOYW1lKTtcclxuICAgICAgfSk7XHJcbiAgICAgIGNvbnN0IHN1YnNjcmlwdGlvblYgPSB0aGlzLnZpZXdNb2RlbENvbnRleHQuZm9ybS5jaGFuZ2VzLnN1YnNjcmliZSgoZGF0YSkgPT4ge1xyXG4gICAgICAgIGlmIChkYXRhICYmIGRhdGEudHlwZSA9PT0gJ3ZhbGlkYXRlRmllbGRzRmluaXNoZWQnKSB7XHJcbiAgICAgICAgICByZWNvbXB1dGUodGhpcy52dWVJbnN0YW5jZSwgc3RhdGVOYW1lKTtcclxuICAgICAgICB9IGVsc2UgaWYgKGRhdGEgJiYgZGF0YS50eXBlID09PSAnc2luZ2xlSGFuZGVkJykge1xyXG4gICAgICAgICAgY29uc3QgaW5kZXggPSB0aGlzLnZ1ZUluc3RhbmNlLiRjaGlsZHJlbi5maW5kSW5kZXgoKGl0ZW0pID0+IHsgcmV0dXJuIGl0ZW0uJGF0dHJzLmlkID09PSBgZm9ybV8ke2RhdGEudmFsdWV9YCB9KVxyXG4gICAgICAgICAgdGhpcy52dWVJbnN0YW5jZS4kY2hpbGRyZW5baW5kZXhdLiRmb3JjZVVwZGF0ZSgpO1xyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcbiAgICAgIHRoaXMuc3Vic2NyaXB0aW9uc01hcC5zZXQoc3RhdGVOYW1lLCBzdWJzY3JpcHRpb24pO1xyXG4gICAgICB0aGlzLnN1YnNjcmlwdGlvbnNNYXAuc2V0KHN0YXRlTmFtZSArICdWJywgc3Vic2NyaXB0aW9uVik7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gdGhpcy52dWVJbnN0YW5jZS4kZ2V0Vmlld01vZGVsKCkuZm9ybTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOaYoOWwhOeKtuaAgeaculxyXG4gICAqL1xyXG4gIHB1YmxpYyBnZXRTdGF0ZU1hY2hpbmUoKSB7XHJcbiAgICBjb25zdCBzdGF0ZU5hbWUgPSAnc3RhdGVNYWNoaW5lJztcclxuICAgIGlmICh0aGlzLnN1YnNjcmlwdGlvbnNNYXAuaGFzKHN0YXRlTmFtZSkgPT09IGZhbHNlKSB7XHJcbiAgICAgIGNvbnN0IHN1YnNjcmlwdGlvbiA9IHRoaXMudmlld01vZGVsQ29udGV4dC5zdGF0ZU1hY2hpbmUuc3RhdGVDaGFuZ2Uuc3Vic2NyaWJlKChjaGFuZ2U6IGFueSkgPT4ge1xyXG4gICAgICAgIHJlY29tcHV0ZSh0aGlzLnZ1ZUluc3RhbmNlLCBzdGF0ZU5hbWUpO1xyXG4gICAgICB9KTtcclxuICAgICAgdGhpcy5zdWJzY3JpcHRpb25zTWFwLnNldChzdGF0ZU5hbWUsIHN1YnNjcmlwdGlvbik7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHRoaXMudmlld01vZGVsQ29udGV4dC5zdGF0ZU1hY2hpbmUucmVuZGVyU3RhdGVzO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IHsgQmluZGluZ1N0YXRlcyB9O1xyXG4iXX0=