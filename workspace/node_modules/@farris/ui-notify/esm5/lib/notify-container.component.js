/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, Input, ViewChildren, QueryList, Output, EventEmitter, NgZone } from '@angular/core';
import { isFunction } from 'lodash-es';
import { NotifyComponent } from './notify.component';
var NotifyContainerComponent = /** @class */ (function () {
    function NotifyContainerComponent(ngZone) {
        this.ngZone = ngZone;
        this._position = '';
        this.style = {
            'left': '',
            'right': '',
            'top': '',
            'bottom': ''
        };
        this.notifyDistance = {
            'left': 12,
            'right': 12,
            'top': 136,
            'bottom': 12
        };
        this.animateCls = 'fadeIn';
        this.id = '';
        this.empty = new EventEmitter();
        this.toasts = [];
    }
    Object.defineProperty(NotifyContainerComponent.prototype, "position", {
        get: /**
         * @return {?}
         */
        function () {
            if (this._position) {
                return this._position;
            }
            else {
                return 'toasty-position-top-center';
            }
        },
        set: /**
         * @param {?} value
         * @return {?}
         */
        function (value) {
            if (value) {
                /** @type {?} */
                var notFound = true;
                for (var i_1 = 0; i_1 < NotifyContainerComponent.POSITIONS.length; i_1++) {
                    if (NotifyContainerComponent.POSITIONS[i_1] === value) {
                        notFound = false;
                        break;
                    }
                }
                if (notFound) {
                    value = this.config.position;
                }
            }
            else {
                value = this.config.position;
            }
            // console.log(this.config);
            // if (value === 'center-center') {
            //     this.animateCls = 'bounceIn';
            // } else {
            /** @type {?} */
            var i = NotifyContainerComponent.POSITIONS.indexOf(value);
            //this.animateCls = NotifyContainerComponent.ANIMATES[i];
            this.animateCls = 'fadeIn';
            //}
            this._position = 'toasty-position-' + value;
            if (this.config.left) {
                this.notifyDistance.left = this.config.left;
            }
            if (this.config.right) {
                this.notifyDistance.right = this.config.right;
            }
            if (this.config.top) {
                this.notifyDistance.top = this.config.top;
            }
            if (this.config.bottom) {
                this.notifyDistance.bottom = this.config.bottom;
            }
            this.initstyle();
            if (value === 'top-left') {
                this.style.left = this.notifyDistance.left + "px";
                this.style.top = this.notifyDistance.top + "px";
            }
            else if (value === 'top-center') {
                this.style.top = this.notifyDistance.top + "px";
            }
            else if (value === 'top-right') {
                this.style.right = this.notifyDistance.right + "px";
                this.style.top = this.notifyDistance.top + "px";
            }
            else if (value === 'bottom-left') {
                this.style.left = this.notifyDistance.left + "px";
                this.style.bottom = this.notifyDistance.bottom + "px";
            }
            else if (value === 'bottom-center') {
                this.style.bottom = this.notifyDistance.bottom + "px";
            }
            else if (value === 'bottom-right') {
                this.style.right = this.notifyDistance.right + "px";
                this.style.bottom = this.notifyDistance.bottom + "px";
            }
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    NotifyContainerComponent.prototype.initstyle = /**
     * @return {?}
     */
    function () {
        this.style = {
            'left': '',
            'right': '',
            'top': '',
            'bottom': ''
        };
    };
    /**
     * @return {?}
     */
    NotifyContainerComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
    };
    /**
     * @return {?}
     */
    NotifyContainerComponent.prototype.ngAfterContentChecked = /**
     * @return {?}
     */
    function () {
        var _this = this;
        if (this.notifyCmpList && this.notifyCmpList.length) {
            this.notifyCmpList.forEach((/**
             * @param {?} cmp
             * @return {?}
             */
            function (cmp) {
                cmp.close.subscribe((/**
                 * @return {?}
                 */
                function () {
                    _this.clear(cmp.toast.id);
                }));
            }));
        }
    };
    /**
     * @param {?} toast
     * @return {?}
     */
    NotifyContainerComponent.prototype.closeToast = /**
     * @param {?} toast
     * @return {?}
     */
    function (toast) {
        this.clear(toast.id);
    };
    /**
     * @param {?} notify
     * @return {?}
     */
    NotifyContainerComponent.prototype.add = /**
     * @param {?} notify
     * @return {?}
     */
    function (notify) {
        if (this.toasts.length >= this.config.limit) {
            this.toasts.shift();
        }
        this.toasts.push(notify);
        if (notify.timeout) {
            this._setTimeout(notify);
        }
    };
    /**
     * @param {?} id
     * @return {?}
     */
    NotifyContainerComponent.prototype.clear = /**
     * @param {?} id
     * @return {?}
     */
    function (id) {
        var _this = this;
        if (id) {
            this.toasts.forEach((/**
             * @param {?} value
             * @param {?} key
             * @return {?}
             */
            function (value, key) {
                if (value.id === id) {
                    if (value.onRemove && isFunction(value.onRemove)) {
                        value.onRemove.call(_this, value);
                    }
                    _this.toasts.splice(key, 1);
                }
            }));
            if (this.toasts.length === 0) {
                this.empty.emit();
            }
        }
        else {
            throw new Error('Please provide id of Toast to close');
        }
    };
    /**
     * @return {?}
     */
    NotifyContainerComponent.prototype.clearAll = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this.toasts.forEach((/**
         * @param {?} value
         * @param {?} key
         * @return {?}
         */
        function (value, key) {
            if (value.onRemove && isFunction(value.onRemove)) {
                value.onRemove.call(_this, value);
            }
        }));
        this.toasts = [];
        this.empty.emit();
    };
    /**
     * @private
     * @param {?} id
     * @return {?}
     */
    NotifyContainerComponent.prototype.findNotifyComponent = /**
     * @private
     * @param {?} id
     * @return {?}
     */
    function (id) {
        return this.notifyCmpList.find((/**
         * @param {?} item
         * @return {?}
         */
        function (item) { return item.toast.id === id; }));
    };
    /**
     * @private
     * @param {?} notify
     * @return {?}
     */
    NotifyContainerComponent.prototype._setTimeout = /**
     * @private
     * @param {?} notify
     * @return {?}
     */
    function (notify) {
        var _this = this;
        // this.ngZone.runOutsideAngular(() => {
        window.setTimeout((/**
         * @return {?}
         */
        function () {
            // this.clear(notify.id);
            /** @type {?} */
            var cmp = _this.findNotifyComponent(notify.id);
            if (cmp) {
                cmp.state = true;
                cmp.inCls[cmp.animateCls] = false;
            }
        }), notify.timeout);
        // });
    };
    NotifyContainerComponent.POSITIONS = ['bottom-right', 'bottom-left',
        'top-right', 'top-left', 'top-center', 'bottom-center', 'center-center'];
    NotifyContainerComponent.ANIMATES = ['bounceInRight', 'bounceInLeft',
        'bounceInRight', 'bounceInLeft', 'bounceInDown', 'bounceInUp', 'bounceIn'];
    NotifyContainerComponent.decorators = [
        { type: Component, args: [{
                    selector: 'farris-notify-container',
                    template: "\n    <div [id]=\"id\" class=\"farris-notify\" [ngClass]=\"[position]\" [ngStyle]=\"style\">\n        <farris-notify *ngFor=\"let toast of toasts\" [toast]=\"toast\" [animateCls]=\"animateCls\" (close)=\"closeToast(toast)\"></farris-notify>\n    </div>\n    "
                }] }
    ];
    /** @nocollapse */
    NotifyContainerComponent.ctorParameters = function () { return [
        { type: NgZone }
    ]; };
    NotifyContainerComponent.propDecorators = {
        notifyCmpList: [{ type: ViewChildren, args: [NotifyComponent,] }],
        empty: [{ type: Output }],
        position: [{ type: Input }]
    };
    return NotifyContainerComponent;
}());
export { NotifyContainerComponent };
if (false) {
    /** @type {?} */
    NotifyContainerComponent.POSITIONS;
    /** @type {?} */
    NotifyContainerComponent.ANIMATES;
    /**
     * @type {?}
     * @private
     */
    NotifyContainerComponent.prototype._position;
    /** @type {?} */
    NotifyContainerComponent.prototype.style;
    /** @type {?} */
    NotifyContainerComponent.prototype.notifyDistance;
    /** @type {?} */
    NotifyContainerComponent.prototype.animateCls;
    /** @type {?} */
    NotifyContainerComponent.prototype.config;
    /** @type {?} */
    NotifyContainerComponent.prototype.id;
    /** @type {?} */
    NotifyContainerComponent.prototype.notifyCmpList;
    /** @type {?} */
    NotifyContainerComponent.prototype.empty;
    /** @type {?} */
    NotifyContainerComponent.prototype.toasts;
    /**
     * @type {?}
     * @private
     */
    NotifyContainerComponent.prototype.ngZone;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibm90aWZ5LWNvbnRhaW5lci5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZmFycmlzL3VpLW5vdGlmeS8iLCJzb3VyY2VzIjpbImxpYi9ub3RpZnktY29udGFpbmVyLmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7O0FBQUEsT0FBTyxFQUFFLFNBQVMsRUFBRSxLQUFLLEVBQUUsWUFBWSxFQUFFLFNBQVMsRUFBK0IsTUFBTSxFQUFFLFlBQVksRUFBRSxNQUFNLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFFckksT0FBTyxFQUFFLFVBQVUsRUFBRSxNQUFNLFdBQVcsQ0FBQztBQUN2QyxPQUFPLEVBQUUsZUFBZSxFQUFFLE1BQU0sb0JBQW9CLENBQUM7QUFFckQ7SUFpSUksa0NBQW9CLE1BQWM7UUFBZCxXQUFNLEdBQU4sTUFBTSxDQUFRO1FBakgxQixjQUFTLEdBQUcsRUFBRSxDQUFDO1FBQ3ZCLFVBQUssR0FBRztZQUNKLE1BQU0sRUFBQyxFQUFFO1lBQ1QsT0FBTyxFQUFDLEVBQUU7WUFDVixLQUFLLEVBQUMsRUFBRTtZQUNSLFFBQVEsRUFBQyxFQUFFO1NBQ2QsQ0FBQztRQUNGLG1CQUFjLEdBQUc7WUFDYixNQUFNLEVBQUMsRUFBRTtZQUNULE9BQU8sRUFBQyxFQUFFO1lBQ1YsS0FBSyxFQUFDLEdBQUc7WUFDVCxRQUFRLEVBQUMsRUFBRTtTQUNkLENBQUM7UUFFRixlQUFVLEdBQUcsUUFBUSxDQUFDO1FBSXRCLE9BQUUsR0FBRyxFQUFFLENBQUM7UUFLRSxVQUFLLEdBQUcsSUFBSSxZQUFZLEVBQUUsQ0FBQztRQXdGckMsV0FBTSxHQUFzQixFQUFFLENBQUM7SUFFTyxDQUFDO0lBeEZ2QyxzQkFBYSw4Q0FBUTs7OztRQW9FckI7WUFDSSxJQUFJLElBQUksQ0FBQyxTQUFTLEVBQUU7Z0JBQ2hCLE9BQU8sSUFBSSxDQUFDLFNBQVMsQ0FBQzthQUN6QjtpQkFBTTtnQkFDSCxPQUFPLDRCQUE0QixDQUFDO2FBQ3ZDO1FBQ0ws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QUNQLFFBQVEsRUFBRSx5QkFBeUI7b0JBQ25DLFFBQVEsRUFBRSxvUUFJVDtpQkFDSjs7OztnQkFac0csTUFBTTs7O2dDQXlDeEcsWUFBWSxTQUFDLGVBQWU7d0JBRzVCLE1BQU07MkJBRU4sS0FBSzs7SUF1S1YsK0JBQUM7Q0FBQSxBQWhORCxJQWdOQztTQXhNWSx3QkFBd0I7OztJQUVqQyxtQ0FDNkU7O0lBRTdFLGtDQUMrRTs7Ozs7SUFFL0UsNkNBQXVCOztJQUN2Qix5Q0FLRTs7SUFDRixrREFLRTs7SUFFRiw4Q0FBc0I7O0lBRXRCLDBDQUFxQjs7SUFFckIsc0NBQVE7O0lBRVIsaURBQXlFOztJQUd6RSx5Q0FBcUM7O0lBd0ZyQywwQ0FBK0I7Ozs7O0lBRW5CLDBDQUFzQiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbXBvbmVudCwgSW5wdXQsIFZpZXdDaGlsZHJlbiwgUXVlcnlMaXN0LCBBZnRlckNvbnRlbnRDaGVja2VkLCBPbkluaXQsIE91dHB1dCwgRXZlbnRFbWl0dGVyLCBOZ1pvbmUgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgTm90aWZ5Q29uZmlnLCBOb3RpZnlEYXRhIH0gZnJvbSAnLi9ub3RpZml5Lm9wdGlvbnMnO1xyXG5pbXBvcnQgeyBpc0Z1bmN0aW9uIH0gZnJvbSAnbG9kYXNoLWVzJztcclxuaW1wb3J0IHsgTm90aWZ5Q29tcG9uZW50IH0gZnJvbSAnLi9ub3RpZnkuY29tcG9uZW50JztcclxuXHJcbkBDb21wb25lbnQoe1xyXG4gICAgc2VsZWN0b3I6ICdmYXJyaXMtbm90aWZ5LWNvbnRhaW5lcicsXHJcbiAgICB0ZW1wbGF0ZTogYFxyXG4gICAgPGRpdiBbaWRdPVwiaWRcIiBjbGFzcz1cImZhcnJpcy1ub3RpZnlcIiBbbmdDbGFzc109XCJbcG9zaXRpb25dXCIgW25nU3R5bGVdPVwic3R5bGVcIj5cclxuICAgICAgICA8ZmFycmlzLW5vdGlmeSAqbmdGb3I9XCJsZXQgdG9hc3Qgb2YgdG9hc3RzXCIgW3RvYXN0XT1cInRvYXN0XCIgW2FuaW1hdGVDbHNdPVwiYW5pbWF0ZUNsc1wiIChjbG9zZSk9XCJjbG9zZVRvYXN0KHRvYXN0KVwiPjwvZmFycmlzLW5vdGlmeT5cclxuICAgIDwvZGl2PlxyXG4gICAgYFxyXG59KVxyXG5leHBvcnQgY2xhc3MgTm90aWZ5Q29udGFpbmVyQ29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0LCBBZnRlckNvbnRlbnRDaGVja2VkIHtcclxuXHJcbiAgICBzdGF0aWMgUE9TSVRJT05TOiBBcnJheTxTdHJpbmc+ID0gWydib3R0b20tcmlnaHQnLCAnYm90dG9tLWxlZnQnLFxyXG4gICAgICAgICd0b3AtcmlnaHQnLCAndG9wLWxlZnQnLCAndG9wLWNlbnRlcicsICdib3R0b20tY2VudGVyJywgJ2NlbnRlci1jZW50ZXInXTtcclxuXHJcbiAgICBzdGF0aWMgQU5JTUFURVM6IEFycmF5PHN0cmluZz4gPSBbJ2JvdW5jZUluUmlnaHQnLCAnYm91bmNlSW5MZWZ0JyxcclxuICAgICAgICAnYm91bmNlSW5SaWdodCcsICdib3VuY2VJbkxlZnQnLCAnYm91bmNlSW5Eb3duJywgJ2JvdW5jZUluVXAnLCAnYm91bmNlSW4nXTtcclxuXHJcbiAgICBwcml2YXRlIF9wb3NpdGlvbiA9ICcnO1xyXG4gICAgc3R5bGUgPSB7XHJcbiAgICAgICAgJ2xlZnQnOicnLFxyXG4gICAgICAgICdyaWdodCc6JycsXHJcbiAgICAgICAgJ3RvcCc6JycsXHJcbiAgICAgICAgJ2JvdHRvbSc6JydcclxuICAgIH07XHJcbiAgICBub3RpZnlEaXN0YW5jZSA9IHtcclxuICAgICAgICAnbGVmdCc6MTIsXHJcbiAgICAgICAgJ3JpZ2h0JzoxMixcclxuICAgICAgICAndG9wJzoxMzYsXHJcbiAgICAgICAgJ2JvdHRvbSc6MTJcclxuICAgIH07XHJcblxyXG4gICAgYW5pbWF0ZUNscyA9ICdmYWRlSW4nO1xyXG5cclxuICAgIGNvbmZpZzogTm90aWZ5Q29uZmlnO1xyXG5cclxuICAgIGlkID0gJyc7XHJcblxyXG4gICAgQFZpZXdDaGlsZHJlbihOb3RpZnlDb21wb25lbnQpIG5vdGlmeUNtcExpc3Q6IFF1ZXJ5TGlzdDxOb3RpZnlDb21wb25lbnQ+O1xyXG5cclxuXHJcbiAgICBAT3V0cHV0KCkgZW1wdHkgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XHJcblxyXG4gICAgQElucHV0KCkgc2V0IHBvc2l0aW9uKHZhbHVlOiBzdHJpbmcpIHtcclxuICAgICAgICBpZiAodmFsdWUpIHtcclxuICAgICAgICAgICAgbGV0IG5vdEZvdW5kID0gdHJ1ZTtcclxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBOb3RpZnlDb250YWluZXJDb21wb25lbnQuUE9TSVRJT05TLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoTm90aWZ5Q29udGFpbmVyQ29tcG9uZW50LlBPU0lUSU9OU1tpXSA9PT0gdmFsdWUpIHtcclxuICAgICAgICAgICAgICAgICAgICBub3RGb3VuZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAobm90Rm91bmQpIHtcclxuICAgICAgICAgICAgICAgIHZhbHVlID0gdGhpcy5jb25maWcucG9zaXRpb247XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB2YWx1ZSA9IHRoaXMuY29uZmlnLnBvc2l0aW9uO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gY29uc29sZS5sb2codGhpcy5jb25maWcpO1xyXG5cclxuXHJcbiAgICAgICAgLy8gaWYgKHZhbHVlID09PSAnY2VudGVyLWNlbnRlcicpIHtcclxuICAgICAgICAvLyAgICAgdGhpcy5hbmltYXRlQ2xzID0gJ2JvdW5jZUluJztcclxuICAgICAgICAvLyB9IGVsc2Uge1xyXG4gICAgICAgICAgICBjb25zdCBpID0gTm90aWZ5Q29udGFpbmVyQ29tcG9uZW50LlBPU0lUSU9OUy5pbmRleE9mKHZhbHVlKTtcclxuICAgICAgICAgICAgLy90aGlzLmFuaW1hdGVDbHMgPSBOb3RpZnlDb250YWluZXJDb21wb25lbnQuQU5JTUFURVNbaV07XHJcbiAgICAgICAgICAgIHRoaXMuYW5pbWF0ZUNscyA9ICdmYWRlSW4nO1xyXG4gICAgICAgIC8vfVxyXG5cclxuICAgICAgICB0aGlzLl9wb3NpdGlvbiA9ICd0b2FzdHktcG9zaXRpb24tJyArIHZhbHVlO1xyXG5cclxuICAgICAgICBpZih0aGlzLmNvbmZpZy5sZWZ0KXtcclxuICAgICAgICAgICAgdGhpcy5ub3RpZnlEaXN0YW5jZS5sZWZ0ID0gdGhpcy5jb25maWcubGVmdDtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYodGhpcy5jb25maWcucmlnaHQpe1xyXG4gICAgICAgICAgICB0aGlzLm5vdGlmeURpc3RhbmNlLnJpZ2h0ID0gdGhpcy5jb25maWcucmlnaHQ7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmKHRoaXMuY29uZmlnLnRvcCl7XHJcbiAgICAgICAgICAgIHRoaXMubm90aWZ5RGlzdGFuY2UudG9wID0gdGhpcy5jb25maWcudG9wO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZih0aGlzLmNvbmZpZy5ib3R0b20pe1xyXG4gICAgICAgICAgICB0aGlzLm5vdGlmeURpc3RhbmNlLmJvdHRvbSA9IHRoaXMuY29uZmlnLmJvdHRvbTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5pbml0c3R5bGUoKTtcclxuICAgICAgICBpZiggdmFsdWUgPT09ICd0b3AtbGVmdCcgKXtcclxuICAgICAgICAgICAgdGhpcy5zdHlsZS5sZWZ0ID0gYCR7dGhpcy5ub3RpZnlEaXN0YW5jZS5sZWZ0fXB4YDtcclxuICAgICAgICAgICAgdGhpcy5zdHlsZS50b3AgPSBgJHt0aGlzLm5vdGlmeURpc3RhbmNlLnRvcH1weGA7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYoIHZhbHVlID09PSAndG9wLWNlbnRlcicgKXtcclxuICAgICAgICAgICAgdGhpcy5zdHlsZS50b3AgPSBgJHt0aGlzLm5vdGlmeURpc3RhbmNlLnRvcH1weGA7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYoIHZhbHVlID09PSAndG9wLXJpZ2h0JyApe1xyXG4gICAgICAgICAgICB0aGlzLnN0eWxlLnJpZ2h0ID0gYCR7dGhpcy5ub3RpZnlEaXN0YW5jZS5yaWdodH1weGA7XHJcbiAgICAgICAgICAgIHRoaXMuc3R5bGUudG9wID0gYCR7dGhpcy5ub3RpZnlEaXN0YW5jZS50b3B9cHhgO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmKCB2YWx1ZSA9PT0gJ2JvdHRvbS1sZWZ0JyApe1xyXG4gICAgICAgICAgICB0aGlzLnN0eWxlLmxlZnQgPSBgJHt0aGlzLm5vdGlmeURpc3RhbmNlLmxlZnR9cHhgO1xyXG4gICAgICAgICAgICB0aGlzLnN0eWxlLmJvdHRvbSA9IGAke3RoaXMubm90aWZ5RGlzdGFuY2UuYm90dG9tfXB4YDtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiggdmFsdWUgPT09ICdib3R0b20tY2VudGVyJyApe1xyXG4gICAgICAgICAgICB0aGlzLnN0eWxlLmJvdHRvbSA9IGAke3RoaXMubm90aWZ5RGlzdGFuY2UuYm90dG9tfXB4YDtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiggdmFsdWUgPT09ICdib3R0b20tcmlnaHQnICl7XHJcbiAgICAgICAgICAgIHRoaXMuc3R5bGUucmlnaHQgPSBgJHt0aGlzLm5vdGlmeURpc3RhbmNlLnJpZ2h0fXB4YDtcclxuICAgICAgICAgICAgdGhpcy5zdHlsZS5ib3R0b20gPSBgJHt0aGlzLm5vdGlmeURpc3RhbmNlLmJvdHRvbX1weGA7XHJcbiAgICAgICAgfVxyXG5cclxuICAgIH1cclxuXHJcbiAgICBnZXQgcG9zaXRpb24oKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuX3Bvc2l0aW9uKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9wb3NpdGlvbjtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gJ3RvYXN0eS1wb3NpdGlvbi10b3AtY2VudGVyJztcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgaW5pdHN0eWxlKCkge1xyXG4gICAgICAgIHRoaXMuc3R5bGUgPSB7XHJcbiAgICAgICAgICAgICdsZWZ0JzonJyxcclxuICAgICAgICAgICAgJ3JpZ2h0JzonJyxcclxuICAgICAgICAgICAgJ3RvcCc6JycsXHJcbiAgICAgICAgICAgICdib3R0b20nOicnXHJcbiAgICAgICAgfTtcclxuICAgIH1cclxuXHJcblxyXG4gICAgdG9hc3RzOiBBcnJheTxOb3RpZnlEYXRhPiA9IFtdO1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKHByaXZhdGUgbmdab25lOiBOZ1pvbmUpIHsgfVxyXG5cclxuICAgIG5nT25Jbml0KCkgeyBcclxuICAgICAgICBcclxuICAgIH1cclxuXHJcbiAgICBuZ0FmdGVyQ29udGVudENoZWNrZWQoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMubm90aWZ5Q21wTGlzdCAmJiB0aGlzLm5vdGlmeUNtcExpc3QubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIHRoaXMubm90aWZ5Q21wTGlzdC5mb3JFYWNoKGNtcCA9PiB7XHJcbiAgICAgICAgICAgICAgICBjbXAuY2xvc2Uuc3Vic2NyaWJlKCgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmNsZWFyKGNtcC50b2FzdC5pZCk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGNsb3NlVG9hc3QodG9hc3Q6IE5vdGlmeURhdGEpIHtcclxuICAgICAgICB0aGlzLmNsZWFyKHRvYXN0LmlkKTtcclxuICAgIH1cclxuXHJcbiAgICBhZGQobm90aWZ5OiBOb3RpZnlEYXRhKSB7XHJcbiAgICAgICAgaWYgKHRoaXMudG9hc3RzLmxlbmd0aCA+PSB0aGlzLmNvbmZpZy5saW1pdCkge1xyXG4gICAgICAgICAgICB0aGlzLnRvYXN0cy5zaGlmdCgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy50b2FzdHMucHVzaChub3RpZnkpO1xyXG5cclxuICAgICAgICBpZiAobm90aWZ5LnRpbWVvdXQpIHtcclxuICAgICAgICAgICAgdGhpcy5fc2V0VGltZW91dChub3RpZnkpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBjbGVhcihpZDogbnVtYmVyKSB7XHJcbiAgICAgICAgaWYgKGlkKSB7XHJcbiAgICAgICAgICAgIHRoaXMudG9hc3RzLmZvckVhY2goKHZhbHVlOiBhbnksIGtleTogbnVtYmVyKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAodmFsdWUuaWQgPT09IGlkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHZhbHVlLm9uUmVtb3ZlICYmIGlzRnVuY3Rpb24odmFsdWUub25SZW1vdmUpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlLm9uUmVtb3ZlLmNhbGwodGhpcywgdmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy50b2FzdHMuc3BsaWNlKGtleSwgMSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgaWYgKHRoaXMudG9hc3RzLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5lbXB0eS5lbWl0KCk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdQbGVhc2UgcHJvdmlkZSBpZCBvZiBUb2FzdCB0byBjbG9zZScpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBjbGVhckFsbCgpIHtcclxuICAgICAgICB0aGlzLnRvYXN0cy5mb3JFYWNoKCh2YWx1ZTogYW55LCBrZXk6IG51bWJlcikgPT4ge1xyXG4gICAgICAgICAgICBpZiAodmFsdWUub25SZW1vdmUgJiYgaXNGdW5jdGlvbih2YWx1ZS5vblJlbW92ZSkpIHtcclxuICAgICAgICAgICAgICAgIHZhbHVlLm9uUmVtb3ZlLmNhbGwodGhpcywgdmFsdWUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy50b2FzdHMgPSBbXTtcclxuICAgICAgICB0aGlzLmVtcHR5LmVtaXQoKTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGZpbmROb3RpZnlDb21wb25lbnQoaWQ6IG51bWJlcikge1xyXG4gICAgICAgIHJldHVybiB0aGlzLm5vdGlmeUNtcExpc3QuZmluZChpdGVtID0+IGl0ZW0udG9hc3QuaWQgPT09IGlkKTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIF9zZXRUaW1lb3V0KG5vdGlmeTogTm90aWZ5RGF0YSkge1xyXG4gICAgICAgIC8vIHRoaXMubmdab25lLnJ1bk91dHNpZGVBbmd1bGFyKCgpID0+IHtcclxuICAgICAgICAgICAgd2luZG93LnNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgLy8gdGhpcy5jbGVhcihub3RpZnkuaWQpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgY21wID0gdGhpcy5maW5kTm90aWZ5Q29tcG9uZW50KG5vdGlmeS5pZCk7XHJcbiAgICAgICAgICAgICAgICBpZiAoY21wKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY21wLnN0YXRlID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICBjbXAuaW5DbHNbY21wLmFuaW1hdGVDbHNdID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sIG5vdGlmeS50aW1lb3V0KTtcclxuICAgICAgICAvLyB9KTtcclxuICAgIH1cclxufVxyXG4iXX0=