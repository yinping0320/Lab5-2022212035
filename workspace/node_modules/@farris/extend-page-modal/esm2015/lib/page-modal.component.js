/**
 * @fileoverview added by tsickle
 * Generated from: lib/page-modal.component.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingRequire,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, ElementRef, HostListener, Renderer2, ViewChild, Output, EventEmitter, Input, HostBinding } from '@angular/core';
import { AngularDraggableDirective } from '@farris/ui-draggable';
import { DomSanitizer } from "@angular/platform-browser";
import { FEPageModalCLASS_NAME, FPageModalDISMISS_REASONS, FEPageModalOptions, FPageModalTRANSITION_DURATIONS } from './page-modal-options.class';
export class FEPageModalComponent {
    /**
     * @param {?} options
     * @param {?} el
     * @param {?} _renderer
     * @param {?} sanitizer
     */
    constructor(options, el, _renderer, sanitizer) {
        this.el = el;
        this._renderer = _renderer;
        this.sanitizer = sanitizer;
        this.isShown = false;
        this.isModalHiding = false;
        this.isMax = false;
        this.closed = new EventEmitter();
        this.opened = new EventEmitter();
        this.resized = new EventEmitter();
        this.modalID = `MODALID_${Date.now().toPrecision()}`;
        this.config = Object.assign({}, options);
    }
    /**
     * @param {?} value
     * @return {?}
     */
    set iframe(value) {
        if (this.sanitizer) {
            this.iframeSrc = this.sanitizer.bypassSecurityTrustResourceUrl(value);
        }
    }
    /**
     * @return {?}
     */
    ngOnInit() {
        this.boundsElement = this.el.nativeElement;
        if (this.config.fitContent) {
            this._renderer.addClass(this.el.nativeElement, 'f-modal-fitContent');
        }
        if (this.isAnimated) {
            this._renderer.addClass(this.el.nativeElement, FEPageModalCLASS_NAME.FADE);
        }
        // this.ngZone.runOutsideAngular(() => {
        setTimeout((/**
         * @return {?}
         */
        () => {
            this.isShown = true;
            this._renderer.addClass(this.el.nativeElement, FEPageModalCLASS_NAME.SHOW);
            this._renderer.setStyle(this.el.nativeElement, 'display', 'block');
            if (this.config.fitContent && this.el.nativeElement.className.indexOf('f-modal-fitContent-scroll') > -1) {
                this.el.nativeElement.scrollTop = 0;
            }
            if (document && document.body) {
                /** @type {?} */
                const modalLen = this.bsModalService.getModalsCount();
                if (modalLen === 1) {
                    this.bsModalService.checkScrollbar();
                    this.bsModalService.setScrollbar();
                }
                if (!document.body.classList.contains(FEPageModalCLASS_NAME.OPEN)) {
                    this._renderer.addClass(document.body, FEPageModalCLASS_NAME.OPEN);
                }
            }
            this.opened.emit({ modal: this });
        }), this.isAnimated ? FPageModalTRANSITION_DURATIONS.BACKDROP : 0);
        // });
        if (this.el.nativeElement) {
            this.el.nativeElement.focus();
        }
    }
    /**
     * @return {?}
     */
    ngAfterViewInit() {
        this._renderer.setStyle(this.el.nativeElement, 'display', 'block');
        // 如果内容适应宽度
        if (this.config.fitContent) {
            /** @type {?} */
            let initElRect = this.el.nativeElement.getBoundingClientRect();
            /** @type {?} */
            let initBodySize = this.getContainerSize();
            if (initElRect.height < initBodySize.height + 30) {
                this._renderer.addClass(this.el.nativeElement, 'f-modal-fitContent-scroll');
            }
        }
    }
    // 获取内容区域的尺寸
    /**
     * @return {?}
     */
    getContainerSize() {
        /** @type {?} */
        const bodyTarget = this.el.nativeElement.querySelector('.modal-body');
        /** @type {?} */
        const height = bodyTarget.offsetHeight;
        /** @type {?} */
        const width = bodyTarget.offsetWidth;
        return { width, height };
    }
    /**
     * @param {?} event
     * @return {?}
     */
    onClick(event) {
        /** @type {?} */
        const tag = (/** @type {?} */ (event.target));
        if (this.config.ignoreBackdropClick || this.config.backdrop === 'static' || event.target !== this.el.nativeElement) {
            event.stopPropagation();
            return;
        }
        this.bsModalService.setDismissReason(FPageModalDISMISS_REASONS.BACKRDOP);
        this.close();
    }
    /**
     * @param {?} event
     * @return {?}
     */
    onEsc(event) {
        if (!this.isShown) {
            return;
        }
        if (event.keyCode === 27) {
            event.preventDefault();
        }
        if (this.config.keyboard &&
            this.level === this.bsModalService.getModalsCount()) {
            this.bsModalService.setDismissReason(FPageModalDISMISS_REASONS.ESC);
            this.close(event);
        }
    }
    /**
     * @return {?}
     */
    ngOnDestroy() {
        if (this.isShown) {
            this.close();
        }
    }
    /**
     * @param {?=} e
     * @param {?=} isCloseButton
     * @return {?}
     */
    close(e, isCloseButton = false) {
        if (e) {
            e.stopPropagation();
        }
        if (this.isModalHiding || !this.isShown) {
            return;
        }
        this.config.beforeClose(this).subscribe((/**
         * @param {?} r
         * @return {?}
         */
        r => {
            if (!r) {
                return false;
            }
            this.isModalHiding = true;
            this._renderer.removeClass(this.el.nativeElement, FEPageModalCLASS_NAME.SHOW);
            // this.ngZone.runOutsideAngular(() => {
            setTimeout((/**
             * @return {?}
             */
            () => {
                this.isShown = false;
                if (document &&
                    document.body) {
                    if (this.bsModalService.getModalsCount() === 1) {
                        this._renderer.removeClass(document.body, FEPageModalCLASS_NAME.OPEN);
                    }
                }
                this.bsModalService.hide(this.level);
                this.isModalHiding = false;
                if (this.config.closed) {
                    this.config.closed(isCloseButton);
                }
                this.closed.emit(this.level);
            }), this.isAnimated ? FPageModalTRANSITION_DURATIONS.MODAL : 0);
            // });
        }));
    }
    /**
     * @return {?}
     */
    toCenter() {
        /** @type {?} */
        const marginLeft = parseInt('' + -this.config.width / 2, 10) + 'px';
        /** @type {?} */
        const marginTop = parseInt('' + -this.config.height / 2, 10) + 'px';
        /** @type {?} */
        const dialogEl = this.el.nativeElement.querySelector('.modal-dialog');
        /** @type {?} */
        const contentEl = this.el.nativeElement.querySelector('.modal-body');
        this._renderer.setStyle(dialogEl, 'margin-left', marginLeft);
        this._renderer.setStyle(dialogEl, 'margin-top', marginTop);
        /** @type {?} */
        let contentHeight = parseInt('' + this.config.height, 10) - 38;
        if (!this.config.fitContent) {
            this._renderer.setStyle(contentEl, 'height', contentHeight + 'px');
        }
        this._renderer.setStyle(contentEl, 'overflow', 'hidden');
        this._renderer.setStyle(dialogEl, 'transform', `translate3d(0px, 0px, 0px)`);
        setTimeout((/**
         * @return {?}
         */
        () => {
            /** @type {?} */
            const container = this.getContainerSize();
            const { width: containerWidth, height: containerHeight } = container;
            this.resized.emit({ width: this.config.width, height: this.config.height, containerWidth, containerHeight });
        }));
    }
    /**
     * @param {?} x
     * @param {?} y
     * @return {?}
     */
    moveTo(x, y) {
        /** @type {?} */
        const dialogEl = this.el.nativeElement.querySelector('.modal-dialog');
        this._renderer.setStyle(dialogEl, 'transform', `translate3d(${x}px, ${y}px, 0px)`);
        this.draggbar.position = { x, y };
        this.draggbar.resetPosition();
    }
    /**
     * @return {?}
     */
    maxDialog() {
        this.originalWidth = this.config.width;
        this.originalHeight = this.config.height;
        this.config.width = document.scrollingElement.clientWidth - 20;
        this.config.height = document.scrollingElement.clientHeight - 20;
        this.config.draggable = false;
        this.config.resizable = false;
        /** @type {?} */
        const dialogEl = this.el.nativeElement.querySelector('.modal-dialog');
        this._renderer.addClass(dialogEl, 'model-dialog-maximize');
        this._renderer.setStyle(dialogEl, 'top', '50%');
        this._renderer.setStyle(dialogEl, 'left', '50%');
        this.isMax = true;
        this.toCenter();
    }
    /**
     * @param {?} el
     * @return {?}
     */
    dropdown(el) {
    }
    /**
     * @return {?}
     */
    revertDialog() {
        this.isMax = false;
        this.config.width = this.originalWidth;
        this.config.height = this.originalHeight;
        this.config.draggable = true;
        this.config.resizable = true;
        /** @type {?} */
        const dialogEl = this.el.nativeElement.querySelector('.modal-dialog');
        this._renderer.removeClass(dialogEl, 'model-dialog-maximize');
        this.toCenter();
        this.draggbar.resetPosition();
    }
    /**
     * @return {?}
     */
    changeDialogSize() {
        if (this.isMax) {
            this.revertDialog();
        }
        else {
            this.maxDialog();
        }
    }
    /**
     * @param {?} opts
     * @return {?}
     */
    resizeStop(opts) {
        this.config.width = opts.size.width;
        this.config.height = opts.size.height;
        /** @type {?} */
        const container = this.getContainerSize();
        const { width: containerWidth, height: containerHeight } = container;
        this.resized.emit(Object.assign({}, opts.size, { containerWidth, containerHeight }));
    }
}
FEPageModalComponent.decorators = [
    { type: Component, args: [{
                selector: 'fe-page-modal',
                template: `
  <div [attr.id]="modalID"
  [ngDraggable]="config.draggable"
  [ngResizable]="config.resizable"
  [rzMinWidth]="config.minWidth"
  [rzMaxWidth]="config.maxWidth"
  [rzMinHeight]="config.minHeight"
  [rzMaxHeight]="config.maxHeight"
  rzHandles="all" [handle]="dragEl"
  (stopped)="dropdown($event)"
  (rzStop)="resizeStop($event)"
  [inBounds]="true" [bounds]="boundsElement"
  [class]="'modal-dialog' + (config.class ? ' ' + config.class : '')" role="document"
  [style.width]="config.width + 'px'" [style.height]="config.fitContent?'auto':(config.height + 'px')"
  style="position: absolute;top: 50%;left: 50%;">
  <div class="modal-content">   
      <ng-container *ngIf="config.showCloseButton&&!config.showMaxButton">
        <div class="action-wrapper">
          <span class="close-icon" (click)="close($event, true)">
            <i class="f-icon f-icon-close"></i>
          </span>
          </div>
      </ng-container> 
      <ng-container *ngIf="config.showMaxButton">
        <ul class="action-list" [ngDraggable]="true" [handle]="actionListDrag" [inBounds]="true" [bounds]="boundsElement">
            <li class="action-list--item" *ngIf="config.showCloseButton">
                <span class="action-list--icon close-icon"  (click)="close($event, true)">
                  <i class="f-icon f-icon-close"></i>
                </span>
            </li>
            <li *ngIf="config.showMaxButton" class="action-list--item">
                  <span class="action-list--icon max-icon"  (click)="changeDialogSize()" >                
                    <i class="f-icon modal_maximize" [class.modalrevert]="isMax"></i>
                  </span>
            </li>
            <div #actionListDrag class="action-list--drag"></div>
        </ul>     
    </ng-container>   
 
    <div #dragEl class="f-utils-absolute-all" style="height:10px;z-index: 1;"></div>
        <div class="modal-body" [class.f-utils-flex-column]="dialogType === 'iframe'" [f-area-response]="config.areaResponse">
            <perfect-scrollbar [config]="{}" [disabled]="!config.enableScroll||config.fitContent"  *ngIf="dialogType!=='iframe'">
                <ng-content ></ng-content>
            </perfect-scrollbar>
            <iframe *ngIf="dialogType === 'iframe'" class="f-utils-fill" width="100%" frameborder="0" [src]="iframeSrc"></iframe>
        </div>
    </div>
</div>
  `,
                host: {
                    class: 'modal farris-modal fe-cmp-page-modal',
                    role: 'dialog',
                    tabindex: '-1',
                    '[attr.aria-modal]': 'true'
                }
            }] }
];
/** @nocollapse */
FEPageModalComponent.ctorParameters = () => [
    { type: FEPageModalOptions },
    { type: ElementRef },
    { type: Renderer2 },
    { type: DomSanitizer }
];
FEPageModalComponent.propDecorators = {
    iframe: [{ type: Input }],
    draggbar: [{ type: ViewChild, args: [AngularDraggableDirective,] }],
    modalHeader: [{ type: ViewChild, args: ['header',] }],
    closed: [{ type: Output }],
    opened: [{ type: Output }],
    resized: [{ type: Output }],
    modalID: [{ type: HostBinding, args: ['id',] }],
    onClick: [{ type: HostListener, args: ['click', ['$event'],] }],
    onEsc: [{ type: HostListener, args: ['window:keydown.esc', ['$event'],] }]
};
if (false) {
    /** @type {?} */
    FEPageModalComponent.prototype.config;
    /** @type {?} */
    FEPageModalComponent.prototype.isShown;
    /** @type {?} */
    FEPageModalComponent.prototype.level;
    /** @type {?} */
    FEPageModalComponent.prototype.isAnimated;
    /** @type {?} */
    FEPageModalComponent.prototype.bsModalService;
    /** @type {?} */
    FEPageModalComponent.prototype.dialogType;
    /** @type {?} */
    FEPageModalComponent.prototype.iframeSrc;
    /**
     * @type {?}
     * @private
     */
    FEPageModalComponent.prototype.isModalHiding;
    /**
     * @type {?}
     * @private
     */
    FEPageModalComponent.prototype.originalWidth;
    /**
     * @type {?}
     * @private
     */
    FEPageModalComponent.prototype.originalHeight;
    /** @type {?} */
    FEPageModalComponent.prototype.isMax;
    /** @type {?} */
    FEPageModalComponent.prototype.draggbar;
    /** @type {?} */
    FEPageModalComponent.prototype.modalHeader;
    /** @type {?} */
    FEPageModalComponent.prototype.boundsElement;
    /** @type {?} */
    FEPageModalComponent.prototype.closed;
    /** @type {?} */
    FEPageModalComponent.prototype.opened;
    /** @type {?} */
    FEPageModalComponent.prototype.resized;
    /** @type {?} */
    FEPageModalComponent.prototype.modalID;
    /** @type {?} */
    FEPageModalComponent.prototype.dlgHeaderLineHeight;
    /**
     * @type {?}
     * @protected
     */
    FEPageModalComponent.prototype.el;
    /**
     * @type {?}
     * @private
     */
    FEPageModalComponent.prototype._renderer;
    /**
     * @type {?}
     * @private
     */
    FEPageModalComponent.prototype.sanitizer;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicGFnZS1tb2RhbC5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZmFycmlzL2V4dGVuZC1wYWdlLW1vZGFsLyIsInNvdXJjZXMiOlsibGliL3BhZ2UtbW9kYWwuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7O0FBQUEsT0FBTyxFQUNMLFNBQVMsRUFBRSxVQUFVLEVBQUUsWUFBWSxFQUMzQixTQUFTLEVBQUUsU0FBUyxFQUFFLE1BQU0sRUFDcEMsWUFBWSxFQUE4QixLQUFLLEVBSS9DLFdBQVcsRUFDWixNQUFNLGVBQWUsQ0FBQztBQUN2QixPQUFPLEVBQUUseUJBQXlCLEVBQUUsTUFBTSxzQkFBc0IsQ0FBQztBQUNqRSxPQUFPLEVBQUUsWUFBWSxFQUFtQixNQUFNLDJCQUEyQixDQUFDO0FBQzFFLE9BQU8sRUFDTCxxQkFBcUIsRUFBRSx5QkFBeUIsRUFDaEQsa0JBQWtCLEVBQUUsOEJBQThCLEVBQ25ELE1BQU0sNEJBQTRCLENBQUM7QUE2RHBDLE1BQU0sT0FBTyxvQkFBb0I7Ozs7Ozs7SUE4Qi9CLFlBQ0UsT0FBMkIsRUFDakIsRUFBYyxFQUNoQixTQUFvQixFQUNwQixTQUF1QjtRQUZyQixPQUFFLEdBQUYsRUFBRSxDQUFZO1FBQ2hCLGNBQVMsR0FBVCxTQUFTLENBQVc7UUFDcEIsY0FBUyxHQUFULFNBQVMsQ0FBYztRQWhDakMsWUFBTyxHQUFHLEtBQUssQ0FBQztRQWFSLGtCQUFhLEdBQUcsS0FBSyxDQUFDO1FBRzlCLFVBQUssR0FBRyxLQUFLLENBQUM7UUFLSixXQUFNLEdBQUcsSUFBSSxZQUFZLEVBQUUsQ0FBQztRQUM1QixXQUFNLEdBQUcsSUFBSSxZQUFZLEVBQUUsQ0FBQztRQUM1QixZQUFPLEdBQUcsSUFBSSxZQUFZLEVBQUUsQ0FBQztRQUVwQixZQUFPLEdBQUcsV0FBVyxJQUFJLENBQUMsR0FBRyxFQUFFLENBQUMsV0FBVyxFQUFFLEVBQUUsQ0FBQztRQVFqRSxJQUFJLENBQUMsTUFBTSxHQUFHLE1B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QW1FOztJQUVuRSxtREFBeUI7Ozs7O0lBR3ZCLGtDQUF3Qjs7Ozs7SUFDeEIseUNBQTRCOzs7OztJQUM1Qix5Q0FBK0IiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xyXG4gIENvbXBvbmVudCwgRWxlbWVudFJlZiwgSG9zdExpc3RlbmVyLCBPbkRlc3Ryb3ksXHJcbiAgT25Jbml0LCBSZW5kZXJlcjIsIFZpZXdDaGlsZCwgT3V0cHV0LFxyXG4gIEV2ZW50RW1pdHRlciwgVGVtcGxhdGVSZWYsIEFmdGVyVmlld0luaXQsIElucHV0LFxyXG4gIE5nWm9uZSxcclxuICBWaWV3Q2hpbGRyZW4sXHJcbiAgUXVlcnlMaXN0LFxyXG4gIEhvc3RCaW5kaW5nXHJcbn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IEFuZ3VsYXJEcmFnZ2FibGVEaXJlY3RpdmUgfSBmcm9tICdAZmFycmlzL3VpLWRyYWdnYWJsZSc7XHJcbmltcG9ydCB7IERvbVNhbml0aXplciwgU2FmZVJlc291cmNlVXJsIH0gZnJvbSBcIkBhbmd1bGFyL3BsYXRmb3JtLWJyb3dzZXJcIjtcclxuaW1wb3J0IHtcclxuICBGRVBhZ2VNb2RhbENMQVNTX05BTUUsIEZQYWdlTW9kYWxESVNNSVNTX1JFQVNPTlMsXHJcbiAgRkVQYWdlTW9kYWxPcHRpb25zLCBGUGFnZU1vZGFsVFJBTlNJVElPTl9EVVJBVElPTlNcclxufSBmcm9tICcuL3BhZ2UtbW9kYWwtb3B0aW9ucy5jbGFzcyc7XHJcbmltcG9ydCB7IEZFUGFnZU1vZGFsU2VydmljZSB9IGZyb20gJy4vcGFnZS1tb2RhbC5zZXJ2aWNlJztcclxuQENvbXBvbmVudCh7XHJcbiAgc2VsZWN0b3I6ICdmZS1wYWdlLW1vZGFsJyxcclxuICB0ZW1wbGF0ZTogYFxyXG4gIDxkaXYgW2F0dHIuaWRdPVwibW9kYWxJRFwiXHJcbiAgW25nRHJhZ2dhYmxlXT1cImNvbmZpZy5kcmFnZ2FibGVcIlxyXG4gIFtuZ1Jlc2l6YWJsZV09XCJjb25maWcucmVzaXphYmxlXCJcclxuICBbcnpNaW5XaWR0aF09XCJjb25maWcubWluV2lkdGhcIlxyXG4gIFtyek1heFdpZHRoXT1cImNvbmZpZy5tYXhXaWR0aFwiXHJcbiAgW3J6TWluSGVpZ2h0XT1cImNvbmZpZy5taW5IZWlnaHRcIlxyXG4gIFtyek1heEhlaWdodF09XCJjb25maWcubWF4SGVpZ2h0XCJcclxuICByekhhbmRsZXM9XCJhbGxcIiBbaGFuZGxlXT1cImRyYWdFbFwiXHJcbiAgKHN0b3BwZWQpPVwiZHJvcGRvd24oJGV2ZW50KVwiXHJcbiAgKHJ6U3RvcCk9XCJyZXNpemVTdG9wKCRldmVudClcIlxyXG4gIFtpbkJvdW5kc109XCJ0cnVlXCIgW2JvdW5kc109XCJib3VuZHNFbGVtZW50XCJcclxuICBbY2xhc3NdPVwiJ21vZGFsLWRpYWxvZycgKyAoY29uZmlnLmNsYXNzID8gJyAnICsgY29uZmlnLmNsYXNzIDogJycpXCIgcm9sZT1cImRvY3VtZW50XCJcclxuICBbc3R5bGUud2lkdGhdPVwiY29uZmlnLndpZHRoICsgJ3B4J1wiIFtzdHlsZS5oZWlnaHRdPVwiY29uZmlnLmZpdENvbnRlbnQ/J2F1dG8nOihjb25maWcuaGVpZ2h0ICsgJ3B4JylcIlxyXG4gIHN0eWxlPVwicG9zaXRpb246IGFic29sdXRlO3RvcDogNTAlO2xlZnQ6IDUwJTtcIj5cclxuICA8ZGl2IGNsYXNzPVwibW9kYWwtY29udGVudFwiPiAgIFxyXG4gICAgICA8bmctY29udGFpbmVyICpuZ0lmPVwiY29uZmlnLnNob3dDbG9zZUJ1dHRvbiYmIWNvbmZpZy5zaG93TWF4QnV0dG9uXCI+XHJcbiAgICAgICAgPGRpdiBjbGFzcz1cImFjdGlvbi13cmFwcGVyXCI+XHJcbiAgICAgICAgICA8c3BhbiBjbGFzcz1cImNsb3NlLWljb25cIiAoY2xpY2spPVwiY2xvc2UoJGV2ZW50LCB0cnVlKVwiPlxyXG4gICAgICAgICAgICA8aSBjbGFzcz1cImYtaWNvbiBmLWljb24tY2xvc2VcIj48L2k+XHJcbiAgICAgICAgICA8L3NwYW4+XHJcbiAgICAgICAgICA8L2Rpdj5cclxuICAgICAgPC9uZy1jb250YWluZXI+IFxyXG4gICAgICA8bmctY29udGFpbmVyICpuZ0lmPVwiY29uZmlnLnNob3dNYXhCdXR0b25cIj5cclxuICAgICAgICA8dWwgY2xhc3M9XCJhY3Rpb24tbGlzdFwiIFtuZ0RyYWdnYWJsZV09XCJ0cnVlXCIgW2hhbmRsZV09XCJhY3Rpb25MaXN0RHJhZ1wiIFtpbkJvdW5kc109XCJ0cnVlXCIgW2JvdW5kc109XCJib3VuZHNFbGVtZW50XCI+XHJcbiAgICAgICAgICAgIDxsaSBjbGFzcz1cImFjdGlvbi1saXN0LS1pdGVtXCIgKm5nSWY9XCJjb25maWcuc2hvd0Nsb3NlQnV0dG9uXCI+XHJcbiAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz1cImFjdGlvbi1saXN0LS1pY29uIGNsb3NlLWljb25cIiAgKGNsaWNrKT1cImNsb3NlKCRldmVudCwgdHJ1ZSlcIj5cclxuICAgICAgICAgICAgICAgICAgPGkgY2xhc3M9XCJmLWljb24gZi1pY29uLWNsb3NlXCI+PC9pPlxyXG4gICAgICAgICAgICAgICAgPC9zcGFuPlxyXG4gICAgICAgICAgICA8L2xpPlxyXG4gICAgICAgICAgICA8bGkgKm5nSWY9XCJjb25maWcuc2hvd01heEJ1dHRvblwiIGNsYXNzPVwiYWN0aW9uLWxpc3QtLWl0ZW1cIj5cclxuICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9XCJhY3Rpb24tbGlzdC0taWNvbiBtYXgtaWNvblwiICAoY2xpY2spPVwiY2hhbmdlRGlhbG9nU2l6ZSgpXCIgPiAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgICAgICA8aSBjbGFzcz1cImYtaWNvbiBtb2RhbF9tYXhpbWl6ZVwiIFtjbGFzcy5tb2RhbHJldmVydF09XCJpc01heFwiPjwvaT5cclxuICAgICAgICAgICAgICAgICAgPC9zcGFuPlxyXG4gICAgICAgICAgICA8L2xpPlxyXG4gICAgICAgICAgICA8ZGl2ICNhY3Rpb25MaXN0RHJhZyBjbGFzcz1cImFjdGlvbi1saXN0LS1kcmFnXCI+PC9kaXY+XHJcbiAgICAgICAgPC91bD4gICAgIFxyXG4gICAgPC9uZy1jb250YWluZXI+ICAgXHJcbiBcclxuICAgIDxkaXYgI2RyYWdFbCBjbGFzcz1cImYtdXRpbHMtYWJzb2x1dGUtYWxsXCIgc3R5bGU9XCJoZWlnaHQ6MTBweDt6LWluZGV4OiAxO1wiPjwvZGl2PlxyXG4gICAgICAgIDxkaXYgY2xhc3M9XCJtb2RhbC1ib2R5XCIgW2NsYXNzLmYtdXRpbHMtZmxleC1jb2x1bW5dPVwiZGlhbG9nVHlwZSA9PT0gJ2lmcmFtZSdcIiBbZi1hcmVhLXJlc3BvbnNlXT1cImNvbmZpZy5hcmVhUmVzcG9uc2VcIj5cclxuICAgICAgICAgICAgPHBlcmZlY3Qtc2Nyb2xsYmFyIFtjb25maWddPVwie31cIiBbZGlzYWJsZWRdPVwiIWNvbmZpZy5lbmFibGVTY3JvbGx8fGNvbmZpZy5maXRDb250ZW50XCIgICpuZ0lmPVwiZGlhbG9nVHlwZSE9PSdpZnJhbWUnXCI+XHJcbiAgICAgICAgICAgICAgICA8bmctY29udGVudCA+PC9uZy1jb250ZW50PlxyXG4gICAgICAgICAgICA8L3BlcmZlY3Qtc2Nyb2xsYmFyPlxyXG4gICAgICAgICAgICA8aWZyYW1lICpuZ0lmPVwiZGlhbG9nVHlwZSA9PT0gJ2lmcmFtZSdcIiBjbGFzcz1cImYtdXRpbHMtZmlsbFwiIHdpZHRoPVwiMTAwJVwiIGZyYW1lYm9yZGVyPVwiMFwiIFtzcmNdPVwiaWZyYW1lU3JjXCI+PC9pZnJhbWU+XHJcbiAgICAgICAgPC9kaXY+XHJcbiAgICA8L2Rpdj5cclxuPC9kaXY+XHJcbiAgYCxcclxuICBzdHlsZXM6IFtdLFxyXG4gIGhvc3Q6IHtcclxuICAgIGNsYXNzOiAnbW9kYWwgZmFycmlzLW1vZGFsIGZlLWNtcC1wYWdlLW1vZGFsJyxcclxuICAgIHJvbGU6ICdkaWFsb2cnLFxyXG4gICAgdGFiaW5kZXg6ICctMScsXHJcbiAgICAnW2F0dHIuYXJpYS1tb2RhbF0nOiAndHJ1ZSdcclxuICB9XHJcbn0pXHJcbmV4cG9ydCBjbGFzcyBGRVBhZ2VNb2RhbENvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCwgT25EZXN0cm95LCBBZnRlclZpZXdJbml0IHtcclxuICBjb25maWc6IEZFUGFnZU1vZGFsT3B0aW9ucztcclxuICBpc1Nob3duID0gZmFsc2U7XHJcbiAgbGV2ZWw6IG51bWJlcjtcclxuICBpc0FuaW1hdGVkOiBib29sZWFuO1xyXG4gIGJzTW9kYWxTZXJ2aWNlOiBGRVBhZ2VNb2RhbFNlcnZpY2U7XHJcbiAgZGlhbG9nVHlwZTogc3RyaW5nO1xyXG4gIGlmcmFtZVNyYzogU2FmZVJlc291cmNlVXJsO1xyXG4gIEBJbnB1dCgpXHJcbiAgcHVibGljIHNldCBpZnJhbWUodmFsdWU6IHN0cmluZykge1xyXG4gICAgaWYgKHRoaXMuc2FuaXRpemVyKSB7XHJcbiAgICAgIHRoaXMuaWZyYW1lU3JjID0gdGhpcy5zYW5pdGl6ZXIuYnlwYXNzU2VjdXJpdHlUcnVzdFJlc291cmNlVXJsKHZhbHVlKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHByaXZhdGUgaXNNb2RhbEhpZGluZyA9IGZhbHNlO1xyXG4gIHByaXZhdGUgb3JpZ2luYWxXaWR0aDogbnVtYmVyfHN0cmluZztcclxuICBwcml2YXRlIG9yaWdpbmFsSGVpZ2h0OiBudW1iZXJ8c3RyaW5nO1xyXG4gIGlzTWF4ID0gZmFsc2U7XHJcbiAgQFZpZXdDaGlsZChBbmd1bGFyRHJhZ2dhYmxlRGlyZWN0aXZlKSBkcmFnZ2JhcjogQW5ndWxhckRyYWdnYWJsZURpcmVjdGl2ZTtcclxuICBAVmlld0NoaWxkKCdoZWFkZXInKSBtb2RhbEhlYWRlcjogRWxlbWVudFJlZjtcclxuICBib3VuZHNFbGVtZW50OiBIVE1MRWxlbWVudDtcclxuXHJcbiAgQE91dHB1dCgpIGNsb3NlZCA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcclxuICBAT3V0cHV0KCkgb3BlbmVkID0gbmV3IEV2ZW50RW1pdHRlcigpO1xyXG4gIEBPdXRwdXQoKSByZXNpemVkID0gbmV3IEV2ZW50RW1pdHRlcigpO1xyXG5cclxuICBASG9zdEJpbmRpbmcoJ2lkJykgbW9kYWxJRCA9IGBNT0RBTElEXyR7RGF0ZS5ub3coKS50b1ByZWNpc2lvbigpfWA7XHJcblxyXG4gIGRsZ0hlYWRlckxpbmVIZWlnaHQ6IGFueTtcclxuICBjb25zdHJ1Y3RvcihcclxuICAgIG9wdGlvbnM6IEZFUGFnZU1vZGFsT3B0aW9ucyxcclxuICAgIHByb3RlY3RlZCBlbDogRWxlbWVudFJlZixcclxuICAgIHByaXZhdGUgX3JlbmRlcmVyOiBSZW5kZXJlcjIsXHJcbiAgICBwcml2YXRlIHNhbml0aXplcjogRG9tU2FuaXRpemVyKSB7XHJcbiAgICB0aGlzLmNvbmZpZyA9IE9iamVjdC5hc3NpZ24oe30sIG9wdGlvbnMpO1xyXG4gIH1cclxuXHJcbiAgbmdPbkluaXQoKTogdm9pZCB7XHJcbiAgICB0aGlzLmJvdW5kc0VsZW1lbnQgPSB0aGlzLmVsLm5hdGl2ZUVsZW1lbnQ7XHJcbiAgICBpZiAodGhpcy5jb25maWcuZml0Q29udGVudCkge1xyXG4gICAgICB0aGlzLl9yZW5kZXJlci5hZGRDbGFzcyh0aGlzLmVsLm5hdGl2ZUVsZW1lbnQsICdmLW1vZGFsLWZpdENvbnRlbnQnKTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAodGhpcy5pc0FuaW1hdGVkKSB7XHJcbiAgICAgIHRoaXMuX3JlbmRlcmVyLmFkZENsYXNzKHRoaXMuZWwubmF0aXZlRWxlbWVudCwgRkVQYWdlTW9kYWxDTEFTU19OQU1FLkZBREUpO1xyXG4gICAgfVxyXG4gICAgLy8gdGhpcy5uZ1pvbmUucnVuT3V0c2lkZUFuZ3VsYXIoKCkgPT4ge1xyXG4gICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgIHRoaXMuaXNTaG93biA9IHRydWU7XHJcbiAgICAgIHRoaXMuX3JlbmRlcmVyLmFkZENsYXNzKFxyXG4gICAgICAgIHRoaXMuZWwubmF0aXZlRWxlbWVudCwgRkVQYWdlTW9kYWxDTEFTU19OQU1FLlNIT1dcclxuICAgICAgKTtcclxuICAgICAgdGhpcy5fcmVuZGVyZXIuc2V0U3R5bGUodGhpcy5lbC5uYXRpdmVFbGVtZW50LCAnZGlzcGxheScsICdibG9jaycpO1xyXG4gICAgICBpZiAodGhpcy5jb25maWcuZml0Q29udGVudCAmJiB0aGlzLmVsLm5hdGl2ZUVsZW1lbnQuY2xhc3NOYW1lLmluZGV4T2YoJ2YtbW9kYWwtZml0Q29udGVudC1zY3JvbGwnKSA+IC0xKSB7XHJcbiAgICAgICAgdGhpcy5lbC5uYXRpdmVFbGVtZW50LnNjcm9sbFRvcCA9IDA7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGlmIChkb2N1bWVudCAmJiBkb2N1bWVudC5ib2R5KSB7XHJcbiAgICAgICAgY29uc3QgbW9kYWxMZW4gPSB0aGlzLmJzTW9kYWxTZXJ2aWNlLmdldE1vZGFsc0NvdW50KCk7XHJcbiAgICAgICAgaWYgKG1vZGFsTGVuID09PSAxKSB7XHJcbiAgICAgICAgICB0aGlzLmJzTW9kYWxTZXJ2aWNlLmNoZWNrU2Nyb2xsYmFyKCk7XHJcbiAgICAgICAgICB0aGlzLmJzTW9kYWxTZXJ2aWNlLnNldFNjcm9sbGJhcigpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoIWRvY3VtZW50LmJvZHkuY2xhc3NMaXN0LmNvbnRhaW5zKEZFUGFnZU1vZGFsQ0xBU1NfTkFNRS5PUEVOKSkge1xyXG4gICAgICAgICAgdGhpcy5fcmVuZGVyZXIuYWRkQ2xhc3MoZG9jdW1lbnQuYm9keSwgRkVQYWdlTW9kYWxDTEFTU19OQU1FLk9QRU4pO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICB0aGlzLm9wZW5lZC5lbWl0KHsgbW9kYWw6IHRoaXMgfSk7XHJcbiAgICB9LCB0aGlzLmlzQW5pbWF0ZWQgPyBGUGFnZU1vZGFsVFJBTlNJVElPTl9EVVJBVElPTlMuQkFDS0RST1AgOiAwKTtcclxuICAgIC8vIH0pO1xyXG5cclxuICAgIGlmICh0aGlzLmVsLm5hdGl2ZUVsZW1lbnQpIHtcclxuICAgICAgdGhpcy5lbC5uYXRpdmVFbGVtZW50LmZvY3VzKCk7XHJcbiAgICB9XHJcblxyXG4gIH1cclxuXHJcbiAgbmdBZnRlclZpZXdJbml0KCk6IHZvaWQge1xyXG4gICAgdGhpcy5fcmVuZGVyZXIuc2V0U3R5bGUodGhpcy5lbC5uYXRpdmVFbGVtZW50LCAnZGlzcGxheScsICdibG9jaycpO1xyXG4gICAgLy8g5aaC5p6c5YaF5a656YCC5bqU5a695bqmXHJcbiAgICBpZiAodGhpcy5jb25maWcuZml0Q29udGVudCkge1xyXG4gICAgICBsZXQgaW5pdEVsUmVjdCA9IHRoaXMuZWwubmF0aXZlRWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcclxuICAgICAgbGV0IGluaXRCb2R5U2l6ZSA9IHRoaXMuZ2V0Q29udGFpbmVyU2l6ZSgpO1xyXG4gICAgICBpZiAoaW5pdEVsUmVjdC5oZWlnaHQgPCBpbml0Qm9keVNpemUuaGVpZ2h0ICsgMzApIHtcclxuICAgICAgICB0aGlzLl9yZW5kZXJlci5hZGRDbGFzcyh0aGlzLmVsLm5hdGl2ZUVsZW1lbnQsICdmLW1vZGFsLWZpdENvbnRlbnQtc2Nyb2xsJyk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgfVxyXG5cclxuICAvLyDojrflj5blhoXlrrnljLrln5/nmoTlsLrlr7hcclxuICBnZXRDb250YWluZXJTaXplKCkge1xyXG4gICAgY29uc3QgYm9keVRhcmdldCA9IHRoaXMuZWwubmF0aXZlRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcubW9kYWwtYm9keScpO1xyXG4gICAgY29uc3QgaGVpZ2h0ID0gYm9keVRhcmdldC5vZmZzZXRIZWlnaHQ7XHJcbiAgICBjb25zdCB3aWR0aCA9IGJvZHlUYXJnZXQub2Zmc2V0V2lkdGg7XHJcbiAgICByZXR1cm4geyB3aWR0aCwgaGVpZ2h0IH07XHJcbiAgfVxyXG5cclxuICBASG9zdExpc3RlbmVyKCdjbGljaycsIFsnJGV2ZW50J10pXHJcbiAgb25DbGljayhldmVudDogTW91c2VFdmVudCkge1xyXG4gICAgY29uc3QgdGFnID0gZXZlbnQudGFyZ2V0IGFzIGFueTtcclxuXHJcbiAgICBpZiAodGhpcy5jb25maWcuaWdub3JlQmFja2Ryb3BDbGljayB8fCB0aGlzLmNvbmZpZy5iYWNrZHJvcCA9PT0gJ3N0YXRpYycgfHwgZXZlbnQudGFyZ2V0ICE9PSB0aGlzLmVsLm5hdGl2ZUVsZW1lbnQpIHtcclxuICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuXHJcbiAgICB0aGlzLmJzTW9kYWxTZXJ2aWNlLnNldERpc21pc3NSZWFzb24oRlBhZ2VNb2RhbERJU01JU1NfUkVBU09OUy5CQUNLUkRPUCk7XHJcbiAgICB0aGlzLmNsb3NlKCk7XHJcbiAgfVxyXG5cclxuICBASG9zdExpc3RlbmVyKCd3aW5kb3c6a2V5ZG93bi5lc2MnLCBbJyRldmVudCddKVxyXG4gIG9uRXNjKGV2ZW50OiBhbnkpOiB2b2lkIHtcclxuICAgIGlmICghdGhpcy5pc1Nob3duKSB7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuXHJcbiAgICBpZiAoZXZlbnQua2V5Q29kZSA9PT0gMjcpIHtcclxuICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAoXHJcbiAgICAgIHRoaXMuY29uZmlnLmtleWJvYXJkICYmXHJcbiAgICAgIHRoaXMubGV2ZWwgPT09IHRoaXMuYnNNb2RhbFNlcnZpY2UuZ2V0TW9kYWxzQ291bnQoKVxyXG4gICAgKSB7XHJcbiAgICAgIHRoaXMuYnNNb2RhbFNlcnZpY2Uuc2V0RGlzbWlzc1JlYXNvbihGUGFnZU1vZGFsRElTTUlTU19SRUFTT05TLkVTQyk7XHJcbiAgICAgIHRoaXMuY2xvc2UoZXZlbnQpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgbmdPbkRlc3Ryb3koKTogdm9pZCB7XHJcbiAgICBpZiAodGhpcy5pc1Nob3duKSB7XHJcbiAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGNsb3NlKGU/OiBNb3VzZUV2ZW50LCBpc0Nsb3NlQnV0dG9uID0gZmFsc2UpOiB2b2lkIHtcclxuICAgIGlmIChlKSB7XHJcbiAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICB9XHJcbiAgICBpZiAodGhpcy5pc01vZGFsSGlkaW5nIHx8ICF0aGlzLmlzU2hvd24pIHtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG5cclxuICAgIHRoaXMuY29uZmlnLmJlZm9yZUNsb3NlKHRoaXMpLnN1YnNjcmliZShyID0+IHtcclxuICAgICAgaWYgKCFyKSB7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICB9XHJcblxyXG4gICAgICB0aGlzLmlzTW9kYWxIaWRpbmcgPSB0cnVlO1xyXG4gICAgICB0aGlzLl9yZW5kZXJlci5yZW1vdmVDbGFzcyhcclxuICAgICAgICB0aGlzLmVsLm5hdGl2ZUVsZW1lbnQsXHJcbiAgICAgICAgRkVQYWdlTW9kYWxDTEFTU19OQU1FLlNIT1dcclxuICAgICAgKTtcclxuICAgICAgLy8gdGhpcy5uZ1pvbmUucnVuT3V0c2lkZUFuZ3VsYXIoKCkgPT4ge1xyXG4gICAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICB0aGlzLmlzU2hvd24gPSBmYWxzZTtcclxuICAgICAgICBpZiAoZG9jdW1lbnQgJiZcclxuICAgICAgICAgIGRvY3VtZW50LmJvZHlcclxuICAgICAgICApIHtcclxuICAgICAgICAgIGlmICh0aGlzLmJzTW9kYWxTZXJ2aWNlLmdldE1vZGFsc0NvdW50KCkgPT09IDEpIHtcclxuICAgICAgICAgICAgdGhpcy5fcmVuZGVyZXIucmVtb3ZlQ2xhc3MoZG9jdW1lbnQuYm9keSwgRkVQYWdlTW9kYWxDTEFTU19OQU1FLk9QRU4pO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmJzTW9kYWxTZXJ2aWNlLmhpZGUodGhpcy5sZXZlbCk7XHJcbiAgICAgICAgdGhpcy5pc01vZGFsSGlkaW5nID0gZmFsc2U7XHJcbiAgICAgICAgaWYgKHRoaXMuY29uZmlnLmNsb3NlZCkge1xyXG4gICAgICAgICAgdGhpcy5jb25maWcuY2xvc2VkKGlzQ2xvc2VCdXR0b24pO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmNsb3NlZC5lbWl0KHRoaXMubGV2ZWwpO1xyXG4gICAgICB9LCB0aGlzLmlzQW5pbWF0ZWQgPyBGUGFnZU1vZGFsVFJBTlNJVElPTl9EVVJBVElPTlMuTU9EQUwgOiAwKTtcclxuICAgICAgLy8gfSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIHRvQ2VudGVyKCkge1xyXG4gICAgY29uc3QgbWFyZ2luTGVmdCA9IHBhcnNlSW50KCcnICsgLXRoaXMuY29uZmlnLndpZHRoIC8gMiwxMCkgKyAncHgnO1xyXG4gICAgY29uc3QgbWFyZ2luVG9wID0gcGFyc2VJbnQoJycgKyAtdGhpcy5jb25maWcuaGVpZ2h0IC8gMiwxMCkgKyAncHgnO1xyXG5cclxuICAgIGNvbnN0IGRpYWxvZ0VsID0gdGhpcy5lbC5uYXRpdmVFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbC1kaWFsb2cnKTtcclxuICAgIGNvbnN0IGNvbnRlbnRFbCA9IHRoaXMuZWwubmF0aXZlRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcubW9kYWwtYm9keScpO1xyXG5cclxuICAgIHRoaXMuX3JlbmRlcmVyLnNldFN0eWxlKGRpYWxvZ0VsLCAnbWFyZ2luLWxlZnQnLCBtYXJnaW5MZWZ0KTtcclxuICAgIHRoaXMuX3JlbmRlcmVyLnNldFN0eWxlKGRpYWxvZ0VsLCAnbWFyZ2luLXRvcCcsIG1hcmdpblRvcCk7XHJcblxyXG4gICAgbGV0IGNvbnRlbnRIZWlnaHQgPXBhcnNlSW50KCcnKyB0aGlzLmNvbmZpZy5oZWlnaHQsMTApIC0gMzg7XHJcblxyXG4gICAgaWYgKCF0aGlzLmNvbmZpZy5maXRDb250ZW50KSB7XHJcbiAgICAgIHRoaXMuX3JlbmRlcmVyLnNldFN0eWxlKFxyXG4gICAgICAgIGNvbnRlbnRFbCxcclxuICAgICAgICAnaGVpZ2h0JyxcclxuICAgICAgICBjb250ZW50SGVpZ2h0ICsgJ3B4J1xyXG4gICAgICApO1xyXG4gICAgfVxyXG4gICAgdGhpcy5fcmVuZGVyZXIuc2V0U3R5bGUoY29udGVudEVsLCAnb3ZlcmZsb3cnLCAnaGlkZGVuJyk7XHJcblxyXG4gICAgdGhpcy5fcmVuZGVyZXIuc2V0U3R5bGUoZGlhbG9nRWwsICd0cmFuc2Zvcm0nLCBgdHJhbnNsYXRlM2QoMHB4LCAwcHgsIDBweClgKTtcclxuXHJcblxyXG5cclxuICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICBjb25zdCBjb250YWluZXIgPSB0aGlzLmdldENvbnRhaW5lclNpemUoKTtcclxuICAgICAgY29uc3QgeyB3aWR0aDogY29udGFpbmVyV2lkdGgsIGhlaWdodDogY29udGFpbmVySGVpZ2h0IH0gPSBjb250YWluZXI7XHJcbiAgICAgIHRoaXMucmVzaXplZC5lbWl0KHsgd2lkdGg6IHRoaXMuY29uZmlnLndpZHRoLCBoZWlnaHQ6IHRoaXMuY29uZmlnLmhlaWdodCwgY29udGFpbmVyV2lkdGgsIGNvbnRhaW5lckhlaWdodCB9KTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgbW92ZVRvKHg6IG51bWJlciwgeTogbnVtYmVyKSB7XHJcbiAgICBjb25zdCBkaWFsb2dFbCA9IHRoaXMuZWwubmF0aXZlRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcubW9kYWwtZGlhbG9nJyk7XHJcbiAgICB0aGlzLl9yZW5kZXJlci5zZXRTdHlsZShkaWFsb2dFbCwgJ3RyYW5zZm9ybScsIGB0cmFuc2xhdGUzZCgke3h9cHgsICR7eX1weCwgMHB4KWApO1xyXG4gICAgdGhpcy5kcmFnZ2Jhci5wb3NpdGlvbiA9IHsgeCwgeSB9O1xyXG4gICAgdGhpcy5kcmFnZ2Jhci5yZXNldFBvc2l0aW9uKCk7XHJcbiAgfVxyXG5cclxuICBtYXhEaWFsb2coKSB7XHJcbiAgICB0aGlzLm9yaWdpbmFsV2lkdGggPSB0aGlzLmNvbmZpZy53aWR0aDtcclxuICAgIHRoaXMub3JpZ2luYWxIZWlnaHQgPSB0aGlzLmNvbmZpZy5oZWlnaHQ7XHJcbiAgICB0aGlzLmNvbmZpZy53aWR0aCA9IGRvY3VtZW50LnNjcm9sbGluZ0VsZW1lbnQuY2xpZW50V2lkdGggLSAyMDtcclxuICAgIHRoaXMuY29uZmlnLmhlaWdodCA9IGRvY3VtZW50LnNjcm9sbGluZ0VsZW1lbnQuY2xpZW50SGVpZ2h0IC0gMjA7XHJcblxyXG4gICAgdGhpcy5jb25maWcuZHJhZ2dhYmxlID0gZmFsc2U7XHJcbiAgICB0aGlzLmNvbmZpZy5yZXNpemFibGUgPSBmYWxzZTtcclxuICAgIGNvbnN0IGRpYWxvZ0VsID0gdGhpcy5lbC5uYXRpdmVFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbC1kaWFsb2cnKTtcclxuICAgIHRoaXMuX3JlbmRlcmVyLmFkZENsYXNzKGRpYWxvZ0VsLCAnbW9kZWwtZGlhbG9nLW1heGltaXplJyk7XHJcbiAgICB0aGlzLl9yZW5kZXJlci5zZXRTdHlsZShkaWFsb2dFbCwgJ3RvcCcsICc1MCUnKTtcclxuICAgIHRoaXMuX3JlbmRlcmVyLnNldFN0eWxlKGRpYWxvZ0VsLCAnbGVmdCcsICc1MCUnKTtcclxuICAgIHRoaXMuaXNNYXggPSB0cnVlO1xyXG4gICAgdGhpcy50b0NlbnRlcigpO1xyXG4gIH1cclxuXHJcbiAgZHJvcGRvd24oZWw6IGFueSkge1xyXG4gIH1cclxuXHJcbiAgcmV2ZXJ0RGlhbG9nKCkge1xyXG4gICAgdGhpcy5pc01heCA9IGZhbHNlO1xyXG4gICAgdGhpcy5jb25maWcud2lkdGggPSB0aGlzLm9yaWdpbmFsV2lkdGg7XHJcbiAgICB0aGlzLmNvbmZpZy5oZWlnaHQgPSB0aGlzLm9yaWdpbmFsSGVpZ2h0O1xyXG4gICAgdGhpcy5jb25maWcuZHJhZ2dhYmxlID0gdHJ1ZTtcclxuICAgIHRoaXMuY29uZmlnLnJlc2l6YWJsZSA9IHRydWU7XHJcbiAgICBjb25zdCBkaWFsb2dFbCA9IHRoaXMuZWwubmF0aXZlRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcubW9kYWwtZGlhbG9nJyk7XHJcbiAgICB0aGlzLl9yZW5kZXJlci5yZW1vdmVDbGFzcyhkaWFsb2dFbCwgJ21vZGVsLWRpYWxvZy1tYXhpbWl6ZScpO1xyXG4gICAgdGhpcy50b0NlbnRlcigpO1xyXG4gICAgdGhpcy5kcmFnZ2Jhci5yZXNldFBvc2l0aW9uKCk7XHJcbiAgfVxyXG5cclxuICBjaGFuZ2VEaWFsb2dTaXplKCkge1xyXG4gICAgaWYgKHRoaXMuaXNNYXgpIHtcclxuICAgICAgdGhpcy5yZXZlcnREaWFsb2coKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMubWF4RGlhbG9nKCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICByZXNpemVTdG9wKG9wdHM6IGFueSkge1xyXG4gICAgdGhpcy5jb25maWcud2lkdGggPSBvcHRzLnNpemUud2lkdGg7XHJcbiAgICB0aGlzLmNvbmZpZy5oZWlnaHQgPSBvcHRzLnNpemUuaGVpZ2h0O1xyXG4gICAgY29uc3QgY29udGFpbmVyID0gdGhpcy5nZXRDb250YWluZXJTaXplKCk7XHJcbiAgICBjb25zdCB7IHdpZHRoOiBjb250YWluZXJXaWR0aCwgaGVpZ2h0OiBjb250YWluZXJIZWlnaHQgfSA9IGNvbnRhaW5lcjtcclxuICAgIHRoaXMucmVzaXplZC5lbWl0KHsgLi4ub3B0cy5zaXplLCAuLi57IGNvbnRhaW5lcldpZHRoLCBjb250YWluZXJIZWlnaHQgfSB9KTtcclxuICB9XHJcbn1cclxuIl19