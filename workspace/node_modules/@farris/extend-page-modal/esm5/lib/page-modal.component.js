/**
 * @fileoverview added by tsickle
 * Generated from: lib/page-modal.component.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingRequire,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
import { Component, ElementRef, HostListener, Renderer2, ViewChild, Output, EventEmitter, Input, HostBinding } from '@angular/core';
import { AngularDraggableDirective } from '@farris/ui-draggable';
import { DomSanitizer } from "@angular/platform-browser";
import { FEPageModalCLASS_NAME, FPageModalDISMISS_REASONS, FEPageModalOptions, FPageModalTRANSITION_DURATIONS } from './page-modal-options.class';
var FEPageModalComponent = /** @class */ (function () {
    function FEPageModalComponent(options, el, _renderer, sanitizer) {
        this.el = el;
        this._renderer = _renderer;
        this.sanitizer = sanitizer;
        this.isShown = false;
        this.isModalHiding = false;
        this.isMax = false;
        this.closed = new EventEmitter();
        this.opened = new EventEmitter();
        this.resized = new EventEmitter();
        this.modalID = "MODALID_" + Date.now().toPrecision();
        this.config = Object.assign({}, options);
    }
    Object.defineProperty(FEPageModalComponent.prototype, "iframe", {
        set: /**
         * @param {?} value
         * @return {?}
         */
        function (value) {
            if (this.sanitizer) {
                this.iframeSrc = this.sanitizer.bypassSecurityTrustResourceUrl(value);
            }
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    FEPageModalComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this.boundsElement = this.el.nativeElement;
        if (this.config.fitContent) {
            this._renderer.addClass(this.el.nativeElement, 'f-modal-fitContent');
        }
        if (this.isAnimated) {
            this._renderer.addClass(this.el.nativeElement, FEPageModalCLASS_NAME.FADE);
        }
        // this.ngZone.runOutsideAngular(() => {
        setTimeout((/**
         * @return {?}
         */
        function () {
            _this.isShown = true;
            _this._renderer.addClass(_this.el.nativeElement, FEPageModalCLASS_NAME.SHOW);
            _this._renderer.setStyle(_this.el.nativeElement, 'display', 'block');
            if (_this.config.fitContent && _this.el.nativeElement.className.indexOf('f-modal-fitContent-scroll') > -1) {
                _this.el.nativeElement.scrollTop = 0;
            }
            if (document && document.body) {
                /** @type {?} */
                var modalLen = _this.bsModalService.getModalsCount();
                if (modalLen === 1) {
                    _this.bsModalService.checkScrollbar();
                    _this.bsModalService.setScrollbar();
                }
                if (!document.body.classList.contains(FEPageModalCLASS_NAME.OPEN)) {
                    _this._renderer.addClass(document.body, FEPageModalCLASS_NAME.OPEN);
                }
            }
            _this.opened.emit({ modal: _this });
        }), this.isAnimated ? FPageModalTRANSITION_DURATIONS.BACKDROP : 0);
        // });
        if (this.el.nativeElement) {
            this.el.nativeElement.focus();
        }
    };
    /**
     * @return {?}
     */
    FEPageModalComponent.prototype.ngAfterViewInit = /**
     * @return {?}
     */
    function () {
        this._renderer.setStyle(this.el.nativeElement, 'display', 'block');
        // 如果内容适应宽度
        if (this.config.fitContent) {
            /** @type {?} */
            var initElRect = this.el.nativeElement.getBoundingClientRect();
            /** @type {?} */
            var initBodySize = this.getContainerSize();
            if (initElRect.height < initBodySize.height + 30) {
                this._renderer.addClass(this.el.nativeElement, 'f-modal-fitContent-scroll');
            }
        }
    };
    // 获取内容区域的尺寸
    // 获取内容区域的尺寸
    /**
     * @return {?}
     */
    FEPageModalComponent.prototype.getContainerSize = 
    // 获取内容区域的尺寸
    /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var bodyTarget = this.el.nativeElement.querySelector('.modal-body');
        /** @type {?} */
        var height = bodyTarget.offsetHeight;
        /** @type {?} */
        var width = bodyTarget.offsetWidth;
        return { width: width, height: height };
    };
    /**
     * @param {?} event
     * @return {?}
     */
    FEPageModalComponent.prototype.onClick = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        /** @type {?} */
        var tag = (/** @type {?} */ (event.target));
        if (this.config.ignoreBackdropClick || this.config.backdrop === 'static' || event.target !== this.el.nativeElement) {
            event.stopPropagation();
            return;
        }
        this.bsModalService.setDismissReason(FPageModalDISMISS_REASONS.BACKRDOP);
        this.close();
    };
    /**
     * @param {?} event
     * @return {?}
     */
    FEPageModalComponent.prototype.onEsc = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        if (!this.isShown) {
            return;
        }
        if (event.keyCode === 27) {
            event.preventDefault();
        }
        if (this.config.keyboard &&
            this.level === this.bsModalService.getModalsCount()) {
            this.bsModalService.setDismissReason(FPageModalDISMISS_REASONS.ESC);
            this.close(event);
        }
    };
    /**
     * @return {?}
     */
    FEPageModalComponent.prototype.ngOnDestroy = /**
     * @return {?}
     */
    function () {
        if (this.isShown) {
            this.close();
        }
    };
    /**
     * @param {?=} e
     * @param {?=} isCloseButton
     * @return {?}
     */
    FEPageModalComponent.prototype.close = /**
     * @param {?=} e
     * @param {?=} isCloseButton
     * @return {?}
     */
    function (e, isCloseButton) {
        var _this = this;
        if (isCloseButton === void 0) { isCloseButton = false; }
        if (e) {
            e.stopPropagation();
        }
        if (this.isModalHiding || !this.isShown) {
            return;
        }
        this.config.beforeClose(this).subscribe((/**
         * @param {?} r
         * @return {?}
         */
        function (r) {
            if (!r) {
                return false;
            }
            _this.isModalHiding = true;
            _this._renderer.removeClass(_this.el.nativeElement, FEPageModalCLASS_NAME.SHOW);
            // this.ngZone.runOutsideAngular(() => {
            setTimeout((/**
             * @return {?}
             */
            function () {
                _this.isShown = false;
                if (document &&
                    document.body) {
                    if (_this.bsModalService.getModalsCount() === 1) {
                        _this._renderer.removeClass(document.body, FEPageModalCLASS_NAME.OPEN);
                    }
                }
                _this.bsModalService.hide(_this.level);
                _this.isModalHiding = false;
                if (_this.config.closed) {
                    _this.config.closed(isCloseButton);
                }
                _this.closed.emit(_this.level);
            }), _this.isAnimated ? FPageModalTRANSITION_DURATIONS.MODAL : 0);
            // });
        }));
    };
    /**
     * @return {?}
     */
    FEPageModalComponent.prototype.toCenter = /**
     * @return {?}
     */
    function () {
        var _this = this;
        /** @type {?} */
        var marginLeft = parseInt('' + -this.config.width / 2, 10) + 'px';
        /** @type {?} */
        var marginTop = parseInt('' + -this.config.height / 2, 10) + 'px';
        /** @type {?} */
        var dialogEl = this.el.nativeElement.querySelector('.modal-dialog');
        /** @type {?} */
        var contentEl = this.el.nativeElement.querySelector('.modal-body');
        this._renderer.setStyle(dialogEl, 'margin-left', marginLeft);
        this._renderer.setStyle(dialogEl, 'margin-top', marginTop);
        /** @type {?} */
        var contentHeight = parseInt('' + this.config.height, 10) - 38;
        if (!this.config.fitContent) {
            this._renderer.setStyle(contentEl, 'height', contentHeight + 'px');
        }
        this._renderer.setStyle(contentEl, 'overflow', 'hidden');
        this._renderer.setStyle(dialogEl, 'transform', "translate3d(0px, 0px, 0px)");
        setTimeout((/**
         * @return {?}
         */
        function () {
            /** @type {?} */
            var container = _this.getContainerSize();
            var containerWidth = container.width, containerHeight = container.height;
            _this.resized.emit({ width: _this.config.width, height: _this.config.height, containerWidth: containerWidth, containerHeight: containerHeight });
        }));
    };
    /**
     * @param {?} x
     * @param {?} y
     * @return {?}
     */
    FEPageModalComponent.prototype.moveTo = /**
     * @param {?} x
     * @param {?} y
     * @return {?}
     */
    function (x, y) {
        /** @type {?} */
        var dialogEl = this.el.nativeElement.querySelector('.modal-dialog');
        this._renderer.setStyle(dialogEl, 'transform', "translate3d(" + x + "px, " + y + "px, 0px)");
        this.draggbar.position = { x: x, y: y };
        this.draggbar.resetPosition();
    };
    /**
     * @return {?}
     */
    FEPageModalComponent.prototype.maxDialog = /**
     * @return {?}
     */
    function () {
        this.originalWidth = this.config.width;
        this.originalHeight = this.config.height;
        this.config.width = document.scrollingElement.clientWidth - 20;
        this.config.height = document.scrollingElement.clientHeight - 20;
        this.config.draggable = false;
        this.config.resizable = false;
        /** @type {?} */
        var dialogEl = this.el.nativeElement.querySelector('.modal-dialog');
        this._renderer.addClass(dialogEl, 'model-dialog-maximize');
        this._renderer.setStyle(dialogEl, 'top', '50%');
        this._renderer.setStyle(dialogEl, 'left', '50%');
        this.isMax = true;
        this.toCenter();
    };
    /**
     * @param {?} el
     * @return {?}
     */
    FEPageModalComponent.prototype.dropdown = /**
     * @param {?} el
     * @return {?}
     */
    function (el) {
    };
    /**
     * @return {?}
     */
    FEPageModalComponent.prototype.revertDialog = /**
     * @return {?}
     */
    function () {
        this.isMax = false;
        this.config.width = this.originalWidth;
        this.config.height = this.originalHeight;
        this.config.draggable = true;
        this.config.resizable = true;
        /** @type {?} */
        var dialogEl = this.el.nativeElement.querySelector('.modal-dialog');
        this._renderer.removeClass(dialogEl, 'model-dialog-maximize');
        this.toCenter();
        this.draggbar.resetPosition();
    };
    /**
     * @return {?}
     */
    FEPageModalComponent.prototype.changeDialogSize = /**
     * @return {?}
     */
    function () {
        if (this.isMax) {
            this.revertDialog();
        }
        else {
            this.maxDialog();
        }
    };
    /**
     * @param {?} opts
     * @return {?}
     */
    FEPageModalComponent.prototype.resizeStop = /**
     * @param {?} opts
     * @return {?}
     */
    function (opts) {
        this.config.width = opts.size.width;
        this.config.height = opts.size.height;
        /** @type {?} */
        var container = this.getContainerSize();
        var containerWidth = container.width, containerHeight = container.height;
        this.resized.emit(tslib_1.__assign({}, opts.size, { containerWidth: containerWidth, containerHeight: containerHeight }));
    };
    FEPageModalComponent.decorators = [
        { type: Component, args: [{
                    selector: 'fe-page-modal',
                    template: "\n  <div [attr.id]=\"modalID\"\n  [ngDraggable]=\"config.draggable\"\n  [ngResizable]=\"config.resizable\"\n  [rzMinWidth]=\"config.minWidth\"\n  [rzMaxWidth]=\"config.maxWidth\"\n  [rzMinHeight]=\"config.minHeight\"\n  [rzMaxHeight]=\"config.maxHeight\"\n  rzHandles=\"all\" [handle]=\"dragEl\"\n  (stopped)=\"dropdown($event)\"\n  (rzStop)=\"resizeStop($event)\"\n  [inBounds]=\"true\" [bounds]=\"boundsElement\"\n  [class]=\"'modal-dialog' + (config.class ? ' ' + config.class : '')\" role=\"document\"\n  [style.width]=\"config.width + 'px'\" [style.height]=\"config.fitContent?'auto':(config.height + 'px')\"\n  style=\"position: absolute;top: 50%;left: 50%;\">\n  <div class=\"modal-content\">   \n      <ng-container *ngIf=\"config.showCloseButton&&!config.showMaxButton\">\n        <div class=\"action-wrapper\">\n          <span class=\"close-icon\" (click)=\"close($event, true)\">\n            <i class=\"f-icon f-icon-close\"></i>\n          </span>\n          </div>\n      </ng-container> \n      <ng-container *ngIf=\"config.showMaxButton\">\n        <ul class=\"action-list\" [ngDraggable]=\"true\" [handle]=\"actionListDrag\" [inBounds]=\"true\" [bounds]=\"boundsElement\">\n            <li class=\"action-list--item\" *ngIf=\"config.showCloseButton\">\n                <span class=\"action-list--icon close-icon\"  (click)=\"close($event, true)\">\n                  <i class=\"f-icon f-icon-close\"></i>\n                </span>\n            </li>\n            <li *ngIf=\"config.showMaxButton\" class=\"action-list--item\">\n                  <span class=\"action-list--icon max-icon\"  (click)=\"changeDialogSize()\" >                \n                    <i class=\"f-icon modal_maximize\" [class.modalrevert]=\"isMax\"></i>\n                  </span>\n            </li>\n            <div #actionListDrag class=\"action-list--drag\"></div>\n        </ul>     \n    </ng-container>   \n \n    <div #dragEl class=\"f-utils-absolute-all\" style=\"height:10px;z-index: 1;\"></div>\n        <div class=\"modal-body\" [class.f-utils-flex-column]=\"dialogType === 'iframe'\" [f-area-response]=\"config.areaResponse\">\n            <perfect-scrollbar [config]=\"{}\" [disabled]=\"!config.enableScroll||config.fitContent\"  *ngIf=\"dialogType!=='iframe'\">\n                <ng-content ></ng-content>\n            </perfect-scrollbar>\n            <iframe *ngIf=\"dialogType === 'iframe'\" class=\"f-utils-fill\" width=\"100%\" frameborder=\"0\" [src]=\"iframeSrc\"></iframe>\n        </div>\n    </div>\n</div>\n  ",
                    host: {
                        class: 'modal farris-modal fe-cmp-page-modal',
                        role: 'dialog',
                        tabindex: '-1',
                        '[attr.aria-modal]': 'true'
                    }
                }] }
    ];
    /** @nocollapse */
    FEPageModalComponent.ctorParameters = function () { return [
        { type: FEPageModalOptions },
        { type: ElementRef },
        { type: Renderer2 },
        { type: DomSanitizer }
    ]; };
    FEPageModalComponent.propDecorators = {
        iframe: [{ type: Input }],
        draggbar: [{ type: ViewChild, args: [AngularDraggableDirective,] }],
        modalHeader: [{ type: ViewChild, args: ['header',] }],
        closed: [{ type: Output }],
        opened: [{ type: Output }],
        resized: [{ type: Output }],
        modalID: [{ type: HostBinding, args: ['id',] }],
        onClick: [{ type: HostListener, args: ['click', ['$event'],] }],
        onEsc: [{ type: HostListener, args: ['window:keydown.esc', ['$event'],] }]
    };
    return FEPageModalComponent;
}());
export { FEPageModalComponent };
if (false) {
    /** @type {?} */
    FEPageModalComponent.prototype.config;
    /** @type {?} */
    FEPageModalComponent.prototype.isShown;
    /** @type {?} */
    FEPageModalComponent.prototype.level;
    /** @type {?} */
    FEPageModalComponent.prototype.isAnimated;
    /** @type {?} */
    FEPageModalComponent.prototype.bsModalService;
    /** @type {?} */
    FEPageModalComponent.prototype.dialogType;
    /** @type {?} */
    FEPageModalComponent.prototype.iframeSrc;
    /**
     * @type {?}
     * @private
     */
    FEPageModalComponent.prototype.isModalHiding;
    /**
     * @type {?}
     * @private
     */
    FEPageModalComponent.prototype.originalWidth;
    /**
     * @type {?}
     * @private
     */
    FEPageModalComponent.prototype.originalHeight;
    /** @type {?} */
    FEPageModalComponent.prototype.isMax;
    /** @type {?} */
    FEPageModalComponent.prototype.draggbar;
    /** @type {?} */
    FEPageModalComponent.prototype.modalHeader;
    /** @type {?} */
    FEPageModalComponent.prototype.boundsElement;
    /** @type {?} */
    FEPageModalComponent.prototype.closed;
    /** @type {?} */
    FEPageModalComponent.prototype.opened;
    /** @type {?} */
    FEPageModalComponent.prototype.resized;
    /** @type {?} */
    FEPageModalComponent.prototype.modalID;
    /** @type {?} */
    FEPageModalComponent.prototype.dlgHeaderLineHeight;
    /**
     * @type {?}
     * @protected
     */
    FEPageModalComponent.prototype.el;
    /**
     * @type {?}
     * @private
     */
    FEPageModalComponent.prototype._renderer;
    /**
     * @type {?}
     * @private
     */
    FEPageModalComponent.prototype.sanitizer;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicGFnZS1tb2RhbC5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZmFycmlzL2V4dGVuZC1wYWdlLW1vZGFsLyIsInNvdXJjZXMiOlsibGliL3BhZ2UtbW9kYWwuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBLE9BQU8sRUFDTCxTQUFTLEVBQUUsVUFBVSxFQUFFLFlBQVksRUFDM0IsU0FBUyxFQUFFLFNBQVMsRUFBRSxNQUFNLEVBQ3BDLFlBQVksRUFBOEIsS0FBSyxFQUkvQyxXQUFXLEVBQ1osTUFBTSxlQUFlLENBQUM7QUFDdkIsT0FBTyxFQUFFLHlCQUF5QixFQUFFLE1BQU0sc0JBQXNCLENBQUM7QUFDakUsT0FBTyxFQUFFLFlBQVksRUFBbUIsTUFBTSwyQkFBMkIsQ0FBQztBQUMxRSxPQUFPLEVBQ0wscUJBQXFCLEVBQUUseUJBQXlCLEVBQ2hELGtCQUFrQixFQUFFLDhCQUE4QixFQUNuRCxNQUFNLDRCQUE0QixDQUFDO0FBRXBDO0lBeUZFLDhCQUNFLE9BQTJCLEVBQ2pCLEVBQWMsRUFDaEIsU0FBb0IsRUFDcEIsU0FBdUI7UUFGckIsT0FBRSxHQUFGLEVBQUUsQ0FBWTtRQUNoQixjQUFTLEdBQVQsU0FBUyxDQUFXO1FBQ3BCLGNBQVMsR0FBVCxTQUFTLENBQWM7UUFoQ2pDLFlBQU8sR0FBRyxLQUFLLENBQUM7UUFhUixrQkFBYSxHQUFHLEtBQUssQ0FBQztRQUc5QixVQUFLLEdBQUcsS0FBSyxDQUFDO1FBS0osV0FBTSxHQUFHLElBQUksWUFBWSxFQUFFLENBQUM7UUFDNUIsV0FBTSxHQUFHLElBQUksWUFBWSxFQUFFLENBQUM7UUFDNUIsWUFBTyxHQUFHLElBQUksWUFBWSxFQUFFLENBQUM7UUFFcEIsWUFBTyxHQUFHLGFBQVcsSUFBSSxDQUFDLEdBQUcsRUFBRSxDQUFDLFdBQVcsRUFBSSxDQUFDO1FBUWpFLElBQUksQ0FBQyxNQUFNLEdBQUcsTUFBTSxDQUFDLE1BQU0sQ0FBQyxFQUFFLEVBQUUs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Qzs7Ozs7SUFDckMsOENBQXNDOztJQUN0QyxxQ0FBYzs7SUFDZCx3Q0FBMEU7O0lBQzFFLDJDQUE2Qzs7SUFDN0MsNkNBQTJCOztJQUUzQixzQ0FBc0M7O0lBQ3RDLHNDQUFzQzs7SUFDdEMsdUNBQXVDOztJQUV2Qyx1Q0FBbUU7O0lBRW5FLG1EQUF5Qjs7Ozs7SUFHdkIsa0NBQXdCOzs7OztJQUN4Qix5Q0FBNEI7Ozs7O0lBQzVCLHlDQUErQiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XHJcbiAgQ29tcG9uZW50LCBFbGVtZW50UmVmLCBIb3N0TGlzdGVuZXIsIE9uRGVzdHJveSxcclxuICBPbkluaXQsIFJlbmRlcmVyMiwgVmlld0NoaWxkLCBPdXRwdXQsXHJcbiAgRXZlbnRFbWl0dGVyLCBUZW1wbGF0ZVJlZiwgQWZ0ZXJWaWV3SW5pdCwgSW5wdXQsXHJcbiAgTmdab25lLFxyXG4gIFZpZXdDaGlsZHJlbixcclxuICBRdWVyeUxpc3QsXHJcbiAgSG9zdEJpbmRpbmdcclxufSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgQW5ndWxhckRyYWdnYWJsZURpcmVjdGl2ZSB9IGZyb20gJ0BmYXJyaXMvdWktZHJhZ2dhYmxlJztcclxuaW1wb3J0IHsgRG9tU2FuaXRpemVyLCBTYWZlUmVzb3VyY2VVcmwgfSBmcm9tIFwiQGFuZ3VsYXIvcGxhdGZvcm0tYnJvd3NlclwiO1xyXG5pbXBvcnQge1xyXG4gIEZFUGFnZU1vZGFsQ0xBU1NfTkFNRSwgRlBhZ2VNb2RhbERJU01JU1NfUkVBU09OUyxcclxuICBGRVBhZ2VNb2RhbE9wdGlvbnMsIEZQYWdlTW9kYWxUUkFOU0lUSU9OX0RVUkFUSU9OU1xyXG59IGZyb20gJy4vcGFnZS1tb2RhbC1vcHRpb25zLmNsYXNzJztcclxuaW1wb3J0IHsgRkVQYWdlTW9kYWxTZXJ2aWNlIH0gZnJvbSAnLi9wYWdlLW1vZGFsLnNlcnZpY2UnO1xyXG5AQ29tcG9uZW50KHtcclxuICBzZWxlY3RvcjogJ2ZlLXBhZ2UtbW9kYWwnLFxyXG4gIHRlbXBsYXRlOiBgXHJcbiAgPGRpdiBbYXR0ci5pZF09XCJtb2RhbElEXCJcclxuICBbbmdEcmFnZ2FibGVdPVwiY29uZmlnLmRyYWdnYWJsZVwiXHJcbiAgW25nUmVzaXphYmxlXT1cImNvbmZpZy5yZXNpemFibGVcIlxyXG4gIFtyek1pbldpZHRoXT1cImNvbmZpZy5taW5XaWR0aFwiXHJcbiAgW3J6TWF4V2lkdGhdPVwiY29uZmlnLm1heFdpZHRoXCJcclxuICBbcnpNaW5IZWlnaHRdPVwiY29uZmlnLm1pbkhlaWdodFwiXHJcbiAgW3J6TWF4SGVpZ2h0XT1cImNvbmZpZy5tYXhIZWlnaHRcIlxyXG4gIHJ6SGFuZGxlcz1cImFsbFwiIFtoYW5kbGVdPVwiZHJhZ0VsXCJcclxuICAoc3RvcHBlZCk9XCJkcm9wZG93bigkZXZlbnQpXCJcclxuICAocnpTdG9wKT1cInJlc2l6ZVN0b3AoJGV2ZW50KVwiXHJcbiAgW2luQm91bmRzXT1cInRydWVcIiBbYm91bmRzXT1cImJvdW5kc0VsZW1lbnRcIlxyXG4gIFtjbGFzc109XCInbW9kYWwtZGlhbG9nJyArIChjb25maWcuY2xhc3MgPyAnICcgKyBjb25maWcuY2xhc3MgOiAnJylcIiByb2xlPVwiZG9jdW1lbnRcIlxyXG4gIFtzdHlsZS53aWR0aF09XCJjb25maWcud2lkdGggKyAncHgnXCIgW3N0eWxlLmhlaWdodF09XCJjb25maWcuZml0Q29udGVudD8nYXV0byc6KGNvbmZpZy5oZWlnaHQgKyAncHgnKVwiXHJcbiAgc3R5bGU9XCJwb3NpdGlvbjogYWJzb2x1dGU7dG9wOiA1MCU7bGVmdDogNTAlO1wiPlxyXG4gIDxkaXYgY2xhc3M9XCJtb2RhbC1jb250ZW50XCI+ICAgXHJcbiAgICAgIDxuZy1jb250YWluZXIgKm5nSWY9XCJjb25maWcuc2hvd0Nsb3NlQnV0dG9uJiYhY29uZmlnLnNob3dNYXhCdXR0b25cIj5cclxuICAgICAgICA8ZGl2IGNsYXNzPVwiYWN0aW9uLXdyYXBwZXJcIj5cclxuICAgICAgICAgIDxzcGFuIGNsYXNzPVwiY2xvc2UtaWNvblwiIChjbGljayk9XCJjbG9zZSgkZXZlbnQsIHRydWUpXCI+XHJcbiAgICAgICAgICAgIDxpIGNsYXNzPVwiZi1pY29uIGYtaWNvbi1jbG9zZVwiPjwvaT5cclxuICAgICAgICAgIDwvc3Bhbj5cclxuICAgICAgICAgIDwvZGl2PlxyXG4gICAgICA8L25nLWNvbnRhaW5lcj4gXHJcbiAgICAgIDxuZy1jb250YWluZXIgKm5nSWY9XCJjb25maWcuc2hvd01heEJ1dHRvblwiPlxyXG4gICAgICAgIDx1bCBjbGFzcz1cImFjdGlvbi1saXN0XCIgW25nRHJhZ2dhYmxlXT1cInRydWVcIiBbaGFuZGxlXT1cImFjdGlvbkxpc3REcmFnXCIgW2luQm91bmRzXT1cInRydWVcIiBbYm91bmRzXT1cImJvdW5kc0VsZW1lbnRcIj5cclxuICAgICAgICAgICAgPGxpIGNsYXNzPVwiYWN0aW9uLWxpc3QtLWl0ZW1cIiAqbmdJZj1cImNvbmZpZy5zaG93Q2xvc2VCdXR0b25cIj5cclxuICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPVwiYWN0aW9uLWxpc3QtLWljb24gY2xvc2UtaWNvblwiICAoY2xpY2spPVwiY2xvc2UoJGV2ZW50LCB0cnVlKVwiPlxyXG4gICAgICAgICAgICAgICAgICA8aSBjbGFzcz1cImYtaWNvbiBmLWljb24tY2xvc2VcIj48L2k+XHJcbiAgICAgICAgICAgICAgICA8L3NwYW4+XHJcbiAgICAgICAgICAgIDwvbGk+XHJcbiAgICAgICAgICAgIDxsaSAqbmdJZj1cImNvbmZpZy5zaG93TWF4QnV0dG9uXCIgY2xhc3M9XCJhY3Rpb24tbGlzdC0taXRlbVwiPlxyXG4gICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz1cImFjdGlvbi1saXN0LS1pY29uIG1heC1pY29uXCIgIChjbGljayk9XCJjaGFuZ2VEaWFsb2dTaXplKClcIiA+ICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICAgIDxpIGNsYXNzPVwiZi1pY29uIG1vZGFsX21heGltaXplXCIgW2NsYXNzLm1vZGFscmV2ZXJ0XT1cImlzTWF4XCI+PC9pPlxyXG4gICAgICAgICAgICAgICAgICA8L3NwYW4+XHJcbiAgICAgICAgICAgIDwvbGk+XHJcbiAgICAgICAgICAgIDxkaXYgI2FjdGlvbkxpc3REcmFnIGNsYXNzPVwiYWN0aW9uLWxpc3QtLWRyYWdcIj48L2Rpdj5cclxuICAgICAgICA8L3VsPiAgICAgXHJcbiAgICA8L25nLWNvbnRhaW5lcj4gICBcclxuIFxyXG4gICAgPGRpdiAjZHJhZ0VsIGNsYXNzPVwiZi11dGlscy1hYnNvbHV0ZS1hbGxcIiBzdHlsZT1cImhlaWdodDoxMHB4O3otaW5kZXg6IDE7XCI+PC9kaXY+XHJcbiAgICAgICAgPGRpdiBjbGFzcz1cIm1vZGFsLWJvZHlcIiBbY2xhc3MuZi11dGlscy1mbGV4LWNvbHVtbl09XCJkaWFsb2dUeXBlID09PSAnaWZyYW1lJ1wiIFtmLWFyZWEtcmVzcG9uc2VdPVwiY29uZmlnLmFyZWFSZXNwb25zZVwiPlxyXG4gICAgICAgICAgICA8cGVyZmVjdC1zY3JvbGxiYXIgW2NvbmZpZ109XCJ7fVwiIFtkaXNhYmxlZF09XCIhY29uZmlnLmVuYWJsZVNjcm9sbHx8Y29uZmlnLmZpdENvbnRlbnRcIiAgKm5nSWY9XCJkaWFsb2dUeXBlIT09J2lmcmFtZSdcIj5cclxuICAgICAgICAgICAgICAgIDxuZy1jb250ZW50ID48L25nLWNvbnRlbnQ+XHJcbiAgICAgICAgICAgIDwvcGVyZmVjdC1zY3JvbGxiYXI+XHJcbiAgICAgICAgICAgIDxpZnJhbWUgKm5nSWY9XCJkaWFsb2dUeXBlID09PSAnaWZyYW1lJ1wiIGNsYXNzPVwiZi11dGlscy1maWxsXCIgd2lkdGg9XCIxMDAlXCIgZnJhbWVib3JkZXI9XCIwXCIgW3NyY109XCJpZnJhbWVTcmNcIj48L2lmcmFtZT5cclxuICAgICAgICA8L2Rpdj5cclxuICAgIDwvZGl2PlxyXG48L2Rpdj5cclxuICBgLFxyXG4gIHN0eWxlczogW10sXHJcbiAgaG9zdDoge1xyXG4gICAgY2xhc3M6ICdtb2RhbCBmYXJyaXMtbW9kYWwgZmUtY21wLXBhZ2UtbW9kYWwnLFxyXG4gICAgcm9sZTogJ2RpYWxvZycsXHJcbiAgICB0YWJpbmRleDogJy0xJyxcclxuICAgICdbYXR0ci5hcmlhLW1vZGFsXSc6ICd0cnVlJ1xyXG4gIH1cclxufSlcclxuZXhwb3J0IGNsYXNzIEZFUGFnZU1vZGFsQ29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0LCBPbkRlc3Ryb3ksIEFmdGVyVmlld0luaXQge1xyXG4gIGNvbmZpZzogRkVQYWdlTW9kYWxPcHRpb25zO1xyXG4gIGlzU2hvd24gPSBmYWxzZTtcclxuICBsZXZlbDogbnVtYmVyO1xyXG4gIGlzQW5pbWF0ZWQ6IGJvb2xlYW47XHJcbiAgYnNNb2RhbFNlcnZpY2U6IEZFUGFnZU1vZGFsU2VydmljZTtcclxuICBkaWFsb2dUeXBlOiBzdHJpbmc7XHJcbiAgaWZyYW1lU3JjOiBTYWZlUmVzb3VyY2VVcmw7XHJcbiAgQElucHV0KClcclxuICBwdWJsaWMgc2V0IGlmcmFtZSh2YWx1ZTogc3RyaW5nKSB7XHJcbiAgICBpZiAodGhpcy5zYW5pdGl6ZXIpIHtcclxuICAgICAgdGhpcy5pZnJhbWVTcmMgPSB0aGlzLnNhbml0aXplci5ieXBhc3NTZWN1cml0eVRydXN0UmVzb3VyY2VVcmwodmFsdWUpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBpc01vZGFsSGlkaW5nID0gZmFsc2U7XHJcbiAgcHJpdmF0ZSBvcmlnaW5hbFdpZHRoOiBudW1iZXJ8c3RyaW5nO1xyXG4gIHByaXZhdGUgb3JpZ2luYWxIZWlnaHQ6IG51bWJlcnxzdHJpbmc7XHJcbiAgaXNNYXggPSBmYWxzZTtcclxuICBAVmlld0NoaWxkKEFuZ3VsYXJEcmFnZ2FibGVEaXJlY3RpdmUpIGRyYWdnYmFyOiBBbmd1bGFyRHJhZ2dhYmxlRGlyZWN0aXZlO1xyXG4gIEBWaWV3Q2hpbGQoJ2hlYWRlcicpIG1vZGFsSGVhZGVyOiBFbGVtZW50UmVmO1xyXG4gIGJvdW5kc0VsZW1lbnQ6IEhUTUxFbGVtZW50O1xyXG5cclxuICBAT3V0cHV0KCkgY2xvc2VkID0gbmV3IEV2ZW50RW1pdHRlcigpO1xyXG4gIEBPdXRwdXQoKSBvcGVuZWQgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XHJcbiAgQE91dHB1dCgpIHJlc2l6ZWQgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XHJcblxyXG4gIEBIb3N0QmluZGluZygnaWQnKSBtb2RhbElEID0gYE1PREFMSURfJHtEYXRlLm5vdygpLnRvUHJlY2lzaW9uKCl9YDtcclxuXHJcbiAgZGxnSGVhZGVyTGluZUhlaWdodDogYW55O1xyXG4gIGNvbnN0cnVjdG9yKFxyXG4gICAgb3B0aW9uczogRkVQYWdlTW9kYWxPcHRpb25zLFxyXG4gICAgcHJvdGVjdGVkIGVsOiBFbGVtZW50UmVmLFxyXG4gICAgcHJpdmF0ZSBfcmVuZGVyZXI6IFJlbmRlcmVyMixcclxuICAgIHByaXZhdGUgc2FuaXRpemVyOiBEb21TYW5pdGl6ZXIpIHtcclxuICAgIHRoaXMuY29uZmlnID0gT2JqZWN0LmFzc2lnbih7fSwgb3B0aW9ucyk7XHJcbiAgfVxyXG5cclxuICBuZ09uSW5pdCgpOiB2b2lkIHtcclxuICAgIHRoaXMuYm91bmRzRWxlbWVudCA9IHRoaXMuZWwubmF0aXZlRWxlbWVudDtcclxuICAgIGlmICh0aGlzLmNvbmZpZy5maXRDb250ZW50KSB7XHJcbiAgICAgIHRoaXMuX3JlbmRlcmVyLmFkZENsYXNzKHRoaXMuZWwubmF0aXZlRWxlbWVudCwgJ2YtbW9kYWwtZml0Q29udGVudCcpO1xyXG4gICAgfVxyXG5cclxuICAgIGlmICh0aGlzLmlzQW5pbWF0ZWQpIHtcclxuICAgICAgdGhpcy5fcmVuZGVyZXIuYWRkQ2xhc3ModGhpcy5lbC5uYXRpdmVFbGVtZW50LCBGRVBhZ2VNb2RhbENMQVNTX05BTUUuRkFERSk7XHJcbiAgICB9XHJcbiAgICAvLyB0aGlzLm5nWm9uZS5ydW5PdXRzaWRlQW5ndWxhcigoKSA9PiB7XHJcbiAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgdGhpcy5pc1Nob3duID0gdHJ1ZTtcclxuICAgICAgdGhpcy5fcmVuZGVyZXIuYWRkQ2xhc3MoXHJcbiAgICAgICAgdGhpcy5lbC5uYXRpdmVFbGVtZW50LCBGRVBhZ2VNb2RhbENMQVNTX05BTUUuU0hPV1xyXG4gICAgICApO1xyXG4gICAgICB0aGlzLl9yZW5kZXJlci5zZXRTdHlsZSh0aGlzLmVsLm5hdGl2ZUVsZW1lbnQsICdkaXNwbGF5JywgJ2Jsb2NrJyk7XHJcbiAgICAgIGlmICh0aGlzLmNvbmZpZy5maXRDb250ZW50ICYmIHRoaXMuZWwubmF0aXZlRWxlbWVudC5jbGFzc05hbWUuaW5kZXhPZignZi1tb2RhbC1maXRDb250ZW50LXNjcm9sbCcpID4gLTEpIHtcclxuICAgICAgICB0aGlzLmVsLm5hdGl2ZUVsZW1lbnQuc2Nyb2xsVG9wID0gMDtcclxuICAgICAgfVxyXG5cclxuICAgICAgaWYgKGRvY3VtZW50ICYmIGRvY3VtZW50LmJvZHkpIHtcclxuICAgICAgICBjb25zdCBtb2RhbExlbiA9IHRoaXMuYnNNb2RhbFNlcnZpY2UuZ2V0TW9kYWxzQ291bnQoKTtcclxuICAgICAgICBpZiAobW9kYWxMZW4gPT09IDEpIHtcclxuICAgICAgICAgIHRoaXMuYnNNb2RhbFNlcnZpY2UuY2hlY2tTY3JvbGxiYXIoKTtcclxuICAgICAgICAgIHRoaXMuYnNNb2RhbFNlcnZpY2Uuc2V0U2Nyb2xsYmFyKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICghZG9jdW1lbnQuYm9keS5jbGFzc0xpc3QuY29udGFpbnMoRkVQYWdlTW9kYWxDTEFTU19OQU1FLk9QRU4pKSB7XHJcbiAgICAgICAgICB0aGlzLl9yZW5kZXJlci5hZGRDbGFzcyhkb2N1bWVudC5ib2R5LCBGRVBhZ2VNb2RhbENMQVNTX05BTUUuT1BFTik7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIHRoaXMub3BlbmVkLmVtaXQoeyBtb2RhbDogdGhpcyB9KTtcclxuICAgIH0sIHRoaXMuaXNBbmltYXRlZCA/IEZQYWdlTW9kYWxUUkFOU0lUSU9OX0RVUkFUSU9OUy5CQUNLRFJPUCA6IDApO1xyXG4gICAgLy8gfSk7XHJcblxyXG4gICAgaWYgKHRoaXMuZWwubmF0aXZlRWxlbWVudCkge1xyXG4gICAgICB0aGlzLmVsLm5hdGl2ZUVsZW1lbnQuZm9jdXMoKTtcclxuICAgIH1cclxuXHJcbiAgfVxyXG5cclxuICBuZ0FmdGVyVmlld0luaXQoKTogdm9pZCB7XHJcbiAgICB0aGlzLl9yZW5kZXJlci5zZXRTdHlsZSh0aGlzLmVsLm5hdGl2ZUVsZW1lbnQsICdkaXNwbGF5JywgJ2Jsb2NrJyk7XHJcbiAgICAvLyDlpoLmnpzlhoXlrrnpgILlupTlrr3luqZcclxuICAgIGlmICh0aGlzLmNvbmZpZy5maXRDb250ZW50KSB7XHJcbiAgICAgIGxldCBpbml0RWxSZWN0ID0gdGhpcy5lbC5uYXRpdmVFbGVtZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xyXG4gICAgICBsZXQgaW5pdEJvZHlTaXplID0gdGhpcy5nZXRDb250YWluZXJTaXplKCk7XHJcbiAgICAgIGlmIChpbml0RWxSZWN0LmhlaWdodCA8IGluaXRCb2R5U2l6ZS5oZWlnaHQgKyAzMCkge1xyXG4gICAgICAgIHRoaXMuX3JlbmRlcmVyLmFkZENsYXNzKHRoaXMuZWwubmF0aXZlRWxlbWVudCwgJ2YtbW9kYWwtZml0Q29udGVudC1zY3JvbGwnKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICB9XHJcblxyXG4gIC8vIOiOt+WPluWGheWuueWMuuWfn+eahOWwuuWvuFxyXG4gIGdldENvbnRhaW5lclNpemUoKSB7XHJcbiAgICBjb25zdCBib2R5VGFyZ2V0ID0gdGhpcy5lbC5uYXRpdmVFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbC1ib2R5Jyk7XHJcbiAgICBjb25zdCBoZWlnaHQgPSBib2R5VGFyZ2V0Lm9mZnNldEhlaWdodDtcclxuICAgIGNvbnN0IHdpZHRoID0gYm9keVRhcmdldC5vZmZzZXRXaWR0aDtcclxuICAgIHJldHVybiB7IHdpZHRoLCBoZWlnaHQgfTtcclxuICB9XHJcblxyXG4gIEBIb3N0TGlzdGVuZXIoJ2NsaWNrJywgWyckZXZlbnQnXSlcclxuICBvbkNsaWNrKGV2ZW50OiBNb3VzZUV2ZW50KSB7XHJcbiAgICBjb25zdCB0YWcgPSBldmVudC50YXJnZXQgYXMgYW55O1xyXG5cclxuICAgIGlmICh0aGlzLmNvbmZpZy5pZ25vcmVCYWNrZHJvcENsaWNrIHx8IHRoaXMuY29uZmlnLmJhY2tkcm9wID09PSAnc3RhdGljJyB8fCBldmVudC50YXJnZXQgIT09IHRoaXMuZWwubmF0aXZlRWxlbWVudCkge1xyXG4gICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG5cclxuICAgIHRoaXMuYnNNb2RhbFNlcnZpY2Uuc2V0RGlzbWlzc1JlYXNvbihGUGFnZU1vZGFsRElTTUlTU19SRUFTT05TLkJBQ0tSRE9QKTtcclxuICAgIHRoaXMuY2xvc2UoKTtcclxuICB9XHJcblxyXG4gIEBIb3N0TGlzdGVuZXIoJ3dpbmRvdzprZXlkb3duLmVzYycsIFsnJGV2ZW50J10pXHJcbiAgb25Fc2MoZXZlbnQ6IGFueSk6IHZvaWQge1xyXG4gICAgaWYgKCF0aGlzLmlzU2hvd24pIHtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG5cclxuICAgIGlmIChldmVudC5rZXlDb2RlID09PSAyNykge1xyXG4gICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgfVxyXG5cclxuICAgIGlmIChcclxuICAgICAgdGhpcy5jb25maWcua2V5Ym9hcmQgJiZcclxuICAgICAgdGhpcy5sZXZlbCA9PT0gdGhpcy5ic01vZGFsU2VydmljZS5nZXRNb2RhbHNDb3VudCgpXHJcbiAgICApIHtcclxuICAgICAgdGhpcy5ic01vZGFsU2VydmljZS5zZXREaXNtaXNzUmVhc29uKEZQYWdlTW9kYWxESVNNSVNTX1JFQVNPTlMuRVNDKTtcclxuICAgICAgdGhpcy5jbG9zZShldmVudCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBuZ09uRGVzdHJveSgpOiB2b2lkIHtcclxuICAgIGlmICh0aGlzLmlzU2hvd24pIHtcclxuICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgY2xvc2UoZT86IE1vdXNlRXZlbnQsIGlzQ2xvc2VCdXR0b24gPSBmYWxzZSk6IHZvaWQge1xyXG4gICAgaWYgKGUpIHtcclxuICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgIH1cclxuICAgIGlmICh0aGlzLmlzTW9kYWxIaWRpbmcgfHwgIXRoaXMuaXNTaG93bikge1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcblxyXG4gICAgdGhpcy5jb25maWcuYmVmb3JlQ2xvc2UodGhpcykuc3Vic2NyaWJlKHIgPT4ge1xyXG4gICAgICBpZiAoIXIpIHtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHRoaXMuaXNNb2RhbEhpZGluZyA9IHRydWU7XHJcbiAgICAgIHRoaXMuX3JlbmRlcmVyLnJlbW92ZUNsYXNzKFxyXG4gICAgICAgIHRoaXMuZWwubmF0aXZlRWxlbWVudCxcclxuICAgICAgICBGRVBhZ2VNb2RhbENMQVNTX05BTUUuU0hPV1xyXG4gICAgICApO1xyXG4gICAgICAvLyB0aGlzLm5nWm9uZS5ydW5PdXRzaWRlQW5ndWxhcigoKSA9PiB7XHJcbiAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgIHRoaXMuaXNTaG93biA9IGZhbHNlO1xyXG4gICAgICAgIGlmIChkb2N1bWVudCAmJlxyXG4gICAgICAgICAgZG9jdW1lbnQuYm9keVxyXG4gICAgICAgICkge1xyXG4gICAgICAgICAgaWYgKHRoaXMuYnNNb2RhbFNlcnZpY2UuZ2V0TW9kYWxzQ291bnQoKSA9PT0gMSkge1xyXG4gICAgICAgICAgICB0aGlzLl9yZW5kZXJlci5yZW1vdmVDbGFzcyhkb2N1bWVudC5ib2R5LCBGRVBhZ2VNb2RhbENMQVNTX05BTUUuT1BFTik7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuYnNNb2RhbFNlcnZpY2UuaGlkZSh0aGlzLmxldmVsKTtcclxuICAgICAgICB0aGlzLmlzTW9kYWxIaWRpbmcgPSBmYWxzZTtcclxuICAgICAgICBpZiAodGhpcy5jb25maWcuY2xvc2VkKSB7XHJcbiAgICAgICAgICB0aGlzLmNvbmZpZy5jbG9zZWQoaXNDbG9zZUJ1dHRvbik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuY2xvc2VkLmVtaXQodGhpcy5sZXZlbCk7XHJcbiAgICAgIH0sIHRoaXMuaXNBbmltYXRlZCA/IEZQYWdlTW9kYWxUUkFOU0lUSU9OX0RVUkFUSU9OUy5NT0RBTCA6IDApO1xyXG4gICAgICAvLyB9KTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgdG9DZW50ZXIoKSB7XHJcbiAgICBjb25zdCBtYXJnaW5MZWZ0ID0gcGFyc2VJbnQoJycgKyAtdGhpcy5jb25maWcud2lkdGggLyAyLDEwKSArICdweCc7XHJcbiAgICBjb25zdCBtYXJnaW5Ub3AgPSBwYXJzZUludCgnJyArIC10aGlzLmNvbmZpZy5oZWlnaHQgLyAyLDEwKSArICdweCc7XHJcblxyXG4gICAgY29uc3QgZGlhbG9nRWwgPSB0aGlzLmVsLm5hdGl2ZUVsZW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsLWRpYWxvZycpO1xyXG4gICAgY29uc3QgY29udGVudEVsID0gdGhpcy5lbC5uYXRpdmVFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbC1ib2R5Jyk7XHJcblxyXG4gICAgdGhpcy5fcmVuZGVyZXIuc2V0U3R5bGUoZGlhbG9nRWwsICdtYXJnaW4tbGVmdCcsIG1hcmdpbkxlZnQpO1xyXG4gICAgdGhpcy5fcmVuZGVyZXIuc2V0U3R5bGUoZGlhbG9nRWwsICdtYXJnaW4tdG9wJywgbWFyZ2luVG9wKTtcclxuXHJcbiAgICBsZXQgY29udGVudEhlaWdodCA9cGFyc2VJbnQoJycrIHRoaXMuY29uZmlnLmhlaWdodCwxMCkgLSAzODtcclxuXHJcbiAgICBpZiAoIXRoaXMuY29uZmlnLmZpdENvbnRlbnQpIHtcclxuICAgICAgdGhpcy5fcmVuZGVyZXIuc2V0U3R5bGUoXHJcbiAgICAgICAgY29udGVudEVsLFxyXG4gICAgICAgICdoZWlnaHQnLFxyXG4gICAgICAgIGNvbnRlbnRIZWlnaHQgKyAncHgnXHJcbiAgICAgICk7XHJcbiAgICB9XHJcbiAgICB0aGlzLl9yZW5kZXJlci5zZXRTdHlsZShjb250ZW50RWwsICdvdmVyZmxvdycsICdoaWRkZW4nKTtcclxuXHJcbiAgICB0aGlzLl9yZW5kZXJlci5zZXRTdHlsZShkaWFsb2dFbCwgJ3RyYW5zZm9ybScsIGB0cmFuc2xhdGUzZCgwcHgsIDBweCwgMHB4KWApO1xyXG5cclxuXHJcblxyXG4gICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgIGNvbnN0IGNvbnRhaW5lciA9IHRoaXMuZ2V0Q29udGFpbmVyU2l6ZSgpO1xyXG4gICAgICBjb25zdCB7IHdpZHRoOiBjb250YWluZXJXaWR0aCwgaGVpZ2h0OiBjb250YWluZXJIZWlnaHQgfSA9IGNvbnRhaW5lcjtcclxuICAgICAgdGhpcy5yZXNpemVkLmVtaXQoeyB3aWR0aDogdGhpcy5jb25maWcud2lkdGgsIGhlaWdodDogdGhpcy5jb25maWcuaGVpZ2h0LCBjb250YWluZXJXaWR0aCwgY29udGFpbmVySGVpZ2h0IH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBtb3ZlVG8oeDogbnVtYmVyLCB5OiBudW1iZXIpIHtcclxuICAgIGNvbnN0IGRpYWxvZ0VsID0gdGhpcy5lbC5uYXRpdmVFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbC1kaWFsb2cnKTtcclxuICAgIHRoaXMuX3JlbmRlcmVyLnNldFN0eWxlKGRpYWxvZ0VsLCAndHJhbnNmb3JtJywgYHRyYW5zbGF0ZTNkKCR7eH1weCwgJHt5fXB4LCAwcHgpYCk7XHJcbiAgICB0aGlzLmRyYWdnYmFyLnBvc2l0aW9uID0geyB4LCB5IH07XHJcbiAgICB0aGlzLmRyYWdnYmFyLnJlc2V0UG9zaXRpb24oKTtcclxuICB9XHJcblxyXG4gIG1heERpYWxvZygpIHtcclxuICAgIHRoaXMub3JpZ2luYWxXaWR0aCA9IHRoaXMuY29uZmlnLndpZHRoO1xyXG4gICAgdGhpcy5vcmlnaW5hbEhlaWdodCA9IHRoaXMuY29uZmlnLmhlaWdodDtcclxuICAgIHRoaXMuY29uZmlnLndpZHRoID0gZG9jdW1lbnQuc2Nyb2xsaW5nRWxlbWVudC5jbGllbnRXaWR0aCAtIDIwO1xyXG4gICAgdGhpcy5jb25maWcuaGVpZ2h0ID0gZG9jdW1lbnQuc2Nyb2xsaW5nRWxlbWVudC5jbGllbnRIZWlnaHQgLSAyMDtcclxuXHJcbiAgICB0aGlzLmNvbmZpZy5kcmFnZ2FibGUgPSBmYWxzZTtcclxuICAgIHRoaXMuY29uZmlnLnJlc2l6YWJsZSA9IGZhbHNlO1xyXG4gICAgY29uc3QgZGlhbG9nRWwgPSB0aGlzLmVsLm5hdGl2ZUVsZW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsLWRpYWxvZycpO1xyXG4gICAgdGhpcy5fcmVuZGVyZXIuYWRkQ2xhc3MoZGlhbG9nRWwsICdtb2RlbC1kaWFsb2ctbWF4aW1pemUnKTtcclxuICAgIHRoaXMuX3JlbmRlcmVyLnNldFN0eWxlKGRpYWxvZ0VsLCAndG9wJywgJzUwJScpO1xyXG4gICAgdGhpcy5fcmVuZGVyZXIuc2V0U3R5bGUoZGlhbG9nRWwsICdsZWZ0JywgJzUwJScpO1xyXG4gICAgdGhpcy5pc01heCA9IHRydWU7XHJcbiAgICB0aGlzLnRvQ2VudGVyKCk7XHJcbiAgfVxyXG5cclxuICBkcm9wZG93bihlbDogYW55KSB7XHJcbiAgfVxyXG5cclxuICByZXZlcnREaWFsb2coKSB7XHJcbiAgICB0aGlzLmlzTWF4ID0gZmFsc2U7XHJcbiAgICB0aGlzLmNvbmZpZy53aWR0aCA9IHRoaXMub3JpZ2luYWxXaWR0aDtcclxuICAgIHRoaXMuY29uZmlnLmhlaWdodCA9IHRoaXMub3JpZ2luYWxIZWlnaHQ7XHJcbiAgICB0aGlzLmNvbmZpZy5kcmFnZ2FibGUgPSB0cnVlO1xyXG4gICAgdGhpcy5jb25maWcucmVzaXphYmxlID0gdHJ1ZTtcclxuICAgIGNvbnN0IGRpYWxvZ0VsID0gdGhpcy5lbC5uYXRpdmVFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbC1kaWFsb2cnKTtcclxuICAgIHRoaXMuX3JlbmRlcmVyLnJlbW92ZUNsYXNzKGRpYWxvZ0VsLCAnbW9kZWwtZGlhbG9nLW1heGltaXplJyk7XHJcbiAgICB0aGlzLnRvQ2VudGVyKCk7XHJcbiAgICB0aGlzLmRyYWdnYmFyLnJlc2V0UG9zaXRpb24oKTtcclxuICB9XHJcblxyXG4gIGNoYW5nZURpYWxvZ1NpemUoKSB7XHJcbiAgICBpZiAodGhpcy5pc01heCkge1xyXG4gICAgICB0aGlzLnJldmVydERpYWxvZygpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5tYXhEaWFsb2coKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHJlc2l6ZVN0b3Aob3B0czogYW55KSB7XHJcbiAgICB0aGlzLmNvbmZpZy53aWR0aCA9IG9wdHMuc2l6ZS53aWR0aDtcclxuICAgIHRoaXMuY29uZmlnLmhlaWdodCA9IG9wdHMuc2l6ZS5oZWlnaHQ7XHJcbiAgICBjb25zdCBjb250YWluZXIgPSB0aGlzLmdldENvbnRhaW5lclNpemUoKTtcclxuICAgIGNvbnN0IHsgd2lkdGg6IGNvbnRhaW5lcldpZHRoLCBoZWlnaHQ6IGNvbnRhaW5lckhlaWdodCB9ID0gY29udGFpbmVyO1xyXG4gICAgdGhpcy5yZXNpemVkLmVtaXQoeyAuLi5vcHRzLnNpemUsIC4uLnsgY29udGFpbmVyV2lkdGgsIGNvbnRhaW5lckhlaWdodCB9IH0pO1xyXG4gIH1cclxufVxyXG4iXX0=