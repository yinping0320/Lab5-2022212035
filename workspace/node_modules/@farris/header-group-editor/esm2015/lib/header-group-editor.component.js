/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { SelectColumnsComponent } from './group-header-select-columns.component';
import { Component, Input, ViewChild, Injector, Output, EventEmitter, ViewEncapsulation } from '@angular/core';
import { TreeTableComponent } from '@farris/ui-treetable';
import { BsModalService } from '@farris/ui-modal';
import { GroupHeaderFormComponent } from './group-header-form.component';
export class HeaderGroupEditorComponent {
    /**
     * @param {?} injector
     * @param {?} modalService
     */
    constructor(injector, modalService) {
        this.injector = injector;
        this.modalService = modalService;
        this.idField = 'id';
        this.treeData = [];
        this.selectedNode = new EventEmitter();
        // preview group columns
        this.groupCols = [];
        this.HOU_XUN_LIE_ID = '__HOU_XUN_LIE_ID__';
    }
    /**
     * @return {?}
     */
    ngOnInit() {
        if (!this.treeData || !this.treeData.length) {
            this.initTreeData();
        }
        else {
            // 多表头中现存的字段ID集合
            /** @type {?} */
            const currentFieldIds = this.treeData.filter((/**
             * @param {?} n
             * @return {?}
             */
            n => n.fieldRef)).map((/**
             * @param {?} n
             * @return {?}
             */
            n => n.fieldRef));
            // 新增的字段
            /** @type {?} */
            const newFields = this.fields.filter((/**
             * @param {?} n
             * @return {?}
             */
            n => !currentFieldIds.includes(n.id)));
            // 新增候选字段
            if (newFields && newFields.length) {
                this.treeData = this.treeData.concat(newFields.map((/**
                 * @param {?} n
                 * @return {?}
                 */
                n => {
                    return {
                        fieldRef: n.id,
                        parent: '__HOU_XUN_LIE_ID__',
                        level: 1
                    };
                })));
            }
            this.treeData = this.treeData.map((/**
             * @param {?} n
             * @return {?}
             */
            n => {
                if (n.fieldRef) {
                    /** @type {?} */
                    const f = this.fields.find((/**
                     * @param {?} m
                     * @return {?}
                     */
                    m => m.id === n.fieldRef));
                    if (f) {
                        return Object.assign({}, f, { parent: n.parent });
                    }
                }
                else {
                    return n;
                }
            })).filter((/**
             * @param {?} n
             * @return {?}
             */
            n => n));
            this.treeData = this.convert2TreeNodes(this.treeData);
        }
        this.tt.removed.subscribe((/**
         * @param {?} rowNode
         * @return {?}
         */
        rowNode => {
            if (!rowNode.node.data.groupHeader) {
                /** @type {?} */
                const hxl = this.getHxl();
                if (!rowNode.parent) {
                    this.treeData = this.treeData.filter((/**
                     * @param {?} n
                     * @return {?}
                     */
                    n => n.data.id !== rowNode.id));
                }
                this.tt.append(rowNode.node.data, hxl.node);
            }
        }));
    }
    /**
     * @return {?}
     */
    initTreeData() {
        this.treeData = [{
                data: { id: 'groupHeader_1', caption: '分组表头1', halign: 'left', groupHeader: true },
                children: this.fields.map((/**
                 * @param {?} n
                 * @param {?} i
                 * @return {?}
                 */
                (n, i) => {
                    n['index'] = i;
                    return {
                        data: n,
                        children: [],
                        visible: true
                    };
                })),
                expanded: true, visible: true
            }, {
                data: { id: this.HOU_XUN_LIE_ID, caption: '(候选列)', houxunquNode: true },
                children: [],
                expanded: true
            }];
    }
    /**
     * @return {?}
     */
    getHxl() {
        return this.tt.findRowNode(this.HOU_XUN_LIE_ID);
    }
    /**
     * @param {?} $event
     * @return {?}
     */
    onMouseEnter($event) {
        ((/** @type {?} */ ($event.target))).querySelector('.rbtn').style.display = 'inline-block';
    }
    /**
     * @param {?} $event
     * @return {?}
     */
    onMouseLeave($event) {
        ((/** @type {?} */ ($event.target))).querySelector('.rbtn').style.display = 'none';
    }
    // 移除列
    /**
     * @param {?} event
     * @param {?} rowData
     * @return {?}
     */
    removeColumn(event, rowData) {
        this.tt.remove(rowData.id);
    }
    // 编辑分组列
    /**
     * @param {?} rowData
     * @return {?}
     */
    editGroupName(rowData) {
        /** @type {?} */
        const modalRef = this.showDialog((/**
         * @return {?}
         */
        () => {
            /** @type {?} */
            const ghfRef = (/** @type {?} */ (modalRef.content));
            if (ghfRef.title) {
                rowData.caption = ghfRef.title;
                modalRef.close();
            }
            else {
                alert('请输入名称！否则点取消。');
            }
        }));
        modalRef.content.title = rowData.caption;
    }
    /**
     * @private
     * @return {?}
     */
    generateGroupHeaderId() {
        return `groupHeader_${new Date().getTime()}`;
    }
    // 新增分组
    /**
     * @param {?} event
     * @param {?} rn
     * @param {?=} child
     * @return {?}
     */
    addNewGroup(event, rn, child = false) {
        /** @type {?} */
        const modalRef = this.showDialog((/**
         * @return {?}
         */
        () => {
            /** @type {?} */
            const ghfRef = (/** @type {?} */ (modalRef.content));
            if (ghfRef.title) {
                if (!rn) {
                    this.treeData.splice(0, 0, {
                        data: {
                            id: this.generateGroupHeaderId(), halign: 'left',
                            caption: ghfRef.title, groupHeader: true
                        },
                        icon: 'f-icon f-icon-aggregate-fields',
                        children: []
                    });
                    this.tt.updateSerializedValue();
                }
                else {
                    this.createNewGroupHeader(rn, ghfRef.title, child);
                }
                modalRef.close();
            }
            else {
                alert('请输入名称！否则点取消。');
            }
        }));
    }
    /**
     * @param {?} event
     * @param {?} col
     * @return {?}
     */
    setColumn2Group(event, col) {
        /** @type {?} */
        const i = this.treeData.length - 1;
        this.treeData.splice(i, 0, { data: col, children: [] });
        /** @type {?} */
        const hxl = this.treeData.find((/**
         * @param {?} n
         * @return {?}
         */
        n => n.data.houxunquNode));
        hxl.children = hxl.children.filter((/**
         * @param {?} n
         * @return {?}
         */
        n => n.data.id !== col.id));
        this.tt.updateSerializedValue();
    }
    // 删除分组
    /**
     * @param {?} event
     * @param {?} rowNode
     * @return {?}
     */
    removeGroup(event, rowNode) {
        /** @type {?} */
        const childs = this.tt.serializedValue.filter((/**
         * @param {?} n
         * @return {?}
         */
        n => n.parents.indexOf(rowNode.id) > -1 && !n.node.data.groupHeader)).map((/**
         * @param {?} n
         * @return {?}
         */
        n => n.node));
        this.treeData = this.treeData.filter((/**
         * @param {?} n
         * @return {?}
         */
        n => n.data.id !== rowNode.id));
        this.tt.remove(rowNode.id);
        this.tt.appendChildren(childs, this.getHxl().node);
    }
    /**
     * @param {?} event
     * @param {?} rowNode
     * @return {?}
     */
    setColumns(event, rowNode) {
        /** @type {?} */
        const childs = rowNode.node.children ? rowNode.node.children.map((/**
         * @param {?} n
         * @return {?}
         */
        n => n.data)) : [];
        /** @type {?} */
        const modalRef = this.showSelectColumnsDialog((/**
         * @return {?}
         */
        () => {
            /** @type {?} */
            const scRef = (/** @type {?} */ (modalRef.content));
            /** @type {?} */
            let needAppendNodes = scRef.checkeds;
            /** @type {?} */
            const hxl = this.tt.findRowNode(this.HOU_XUN_LIE_ID);
            hxl.node.children = (hxl.node.children || []).filter((/**
             * @param {?} n
             * @return {?}
             */
            n => needAppendNodes.findIndex((/**
             * @param {?} c
             * @return {?}
             */
            c => c.id === n.id)) === -1));
            rowNode.node.children = rowNode.node.children || [];
            needAppendNodes = needAppendNodes.filter((/**
             * @param {?} n
             * @return {?}
             */
            n => rowNode.node.children.findIndex((/**
             * @param {?} c
             * @return {?}
             */
            c => c.id === n.id)) === -1));
            if (needAppendNodes && needAppendNodes.length) {
                this.tt.appendChildren(needAppendNodes.map((/**
                 * @param {?} n
                 * @return {?}
                 */
                n => {
                    return {
                        data: n,
                        children: [],
                        expanded: true
                    };
                })), rowNode.node);
                this.tt.expandNode(rowNode.id);
            }
            if (scRef.uncheckeds && scRef.uncheckeds.length) {
                // hxl.node.children =  [];
                /** @type {?} */
                const hxlCols = scRef.uncheckeds.map((/**
                 * @param {?} n
                 * @return {?}
                 */
                n => {
                    return {
                        data: n,
                        children: []
                    };
                }));
                hxl.node.children = hxl.node.children.filter((/**
                 * @param {?} n
                 * @return {?}
                 */
                n => scRef.uncheckeds.findIndex((/**
                 * @param {?} c
                 * @return {?}
                 */
                c => c.id === n.id)) === -1));
                this.tt.appendChildren(hxlCols, hxl.node);
            }
            modalRef.close();
        }), childs);
    }
    /**
     * @param {?=} rowNode
     * @return {?}
     */
    hasGroupHeader(rowNode = null) {
        if (!rowNode) {
            return this.treeData.filter((/**
             * @param {?} n
             * @return {?}
             */
            n => n.groupHeader)).length;
        }
        else {
            return rowNode.node.children.filter((/**
             * @param {?} n
             * @return {?}
             */
            n => n.data.groupHeader)).length;
        }
    }
    /**
     * @param {?} event
     * @param {?} rowNode
     * @return {?}
     */
    moveUp(event, rowNode) {
        /** @type {?} */
        let data = this.treeData;
        if (rowNode.parent) {
            data = rowNode.parent.children;
        }
        /** @type {?} */
        const index = data.findIndex((/**
         * @param {?} n
         * @return {?}
         */
        n => n.data.id === rowNode.id));
        if (index !== 0) {
            /** @type {?} */
            const tempArr = data.splice(index, 1);
            data.splice(index - 1, 0, ...tempArr);
            this.tt.updateSerializedValue();
        }
    }
    /**
     * @param {?} event
     * @param {?} rowNode
     * @return {?}
     */
    moveDown(event, rowNode) {
        /** @type {?} */
        let data = this.treeData;
        if (rowNode.parent) {
            data = rowNode.parent.children;
        }
        /** @type {?} */
        const index = data.findIndex((/**
         * @param {?} n
         * @return {?}
         */
        n => n.data.id === rowNode.id));
        /** @type {?} */
        const len = data.length;
        if (index !== len - 2) {
            /** @type {?} */
            const tempArr = data.splice(index, 1);
            data.splice(index + 1, 0, ...tempArr);
            this.tt.updateSerializedValue();
        }
        else {
            this.moveBottom(event, rowNode);
        }
    }
    /**
     * @param {?} event
     * @param {?} rowNode
     * @return {?}
     */
    moveTop(event, rowNode) {
        /** @type {?} */
        let data = this.treeData;
        if (rowNode.parent) {
            data = rowNode.parent.children;
        }
        /** @type {?} */
        const index = data.findIndex((/**
         * @param {?} n
         * @return {?}
         */
        n => n.data.id === rowNode.id));
        data.unshift(rowNode.node);
        data.splice(index + 1, 1);
        this.tt.updateSerializedValue();
    }
    /**
     * @param {?} event
     * @param {?} rowNode
     * @return {?}
     */
    moveBottom(event, rowNode) {
        /** @type {?} */
        let data = this.treeData;
        if (rowNode.parent) {
            data = rowNode.parent.children;
        }
        /** @type {?} */
        const index = data.findIndex((/**
         * @param {?} n
         * @return {?}
         */
        n => n.data.id === rowNode.id));
        data.push(rowNode.node);
        data.splice(index, 1);
        if (!rowNode.parent) {
            this.moveUp(event, rowNode);
        }
        else {
            this.tt.updateSerializedValue();
        }
    }
    /**
     * 获取候选列
     * @return {?}
     */
    getHouXuanLie() {
        return this.treeData.find((/**
         * @param {?} n
         * @return {?}
         */
        n => n.data.houxunquNode)).children;
    }
    /**
     * @return {?}
     */
    getAllNodes() {
        /** @type {?} */
        const hxl = this.getHouXuanLie();
        return this.tt.serializedValue.filter((/**
         * @param {?} n
         * @return {?}
         */
        n => {
            return !n.node.data.houxunquNode && hxl.findIndex((/**
             * @param {?} k
             * @return {?}
             */
            k => k.data.id === n.id)) === -1;
        }));
    }
    /**
     * @private
     * @param {?} data
     * @param {?=} parentId
     * @return {?}
     */
    convert2TreeNodes(data, parentId = null) {
        if (data.length) {
            /** @type {?} */
            const nodes = data.filter((/**
             * @param {?} v
             * @return {?}
             */
            (v) => v.parent === parentId)).filter((/**
             * @param {?} n
             * @return {?}
             */
            n => n));
            return nodes.map((/**
             * @param {?} item
             * @return {?}
             */
            item => {
                /** @type {?} */
                const node = {
                    data: item,
                    children: [],
                    expanded: true
                };
                node.children = this.convert2TreeNodes(data, item.id);
                if (node.data.groupHeader && node.children.length === 0) {
                    node.icon = 'f-icon f-icon-aggregate-fields';
                }
                return node;
            }));
        }
        return [];
    }
    /**
     * @private
     * @param {?} nodes
     * @return {?}
     */
    flatNodes(nodes) {
        /** @type {?} */
        let r = {};
        nodes.forEach((/**
         * @param {?} e
         * @return {?}
         */
        e => {
            r[e.data['id']] = e.data;
            if (e.children && e.children.length) {
                r = Object.assign(r, this.flatNodes(e.children));
            }
        }));
        return r;
    }
    /**
     * @param {?} treeNodes
     * @return {?}
     */
    convert2Array(treeNodes) {
        /** @type {?} */
        const r = [];
        /** @type {?} */
        const maxBy = (/**
         * @param {?} arr
         * @param {?} fn
         * @return {?}
         */
        (arr, fn) => Math.max(...arr.map(typeof fn === 'function' ? fn : (/**
         * @param {?} val
         * @return {?}
         */
        val => val[fn]))));
        /** @type {?} */
        const maxlevel = maxBy(treeNodes, (/**
         * @param {?} n
         * @return {?}
         */
        (n) => n.level));
        for (let i = 0; i <= maxlevel; i++) {
            r.push(treeNodes.filter((/**
             * @param {?} n
             * @return {?}
             */
            n => n.level === i)).map((/**
             * @param {?} n
             * @return {?}
             */
            n => {
                /** @type {?} */
                const data = n.node.data;
                return {
                    colspan: (n.node.children ? treeNodes.filter((/**
                     * @param {?} k
                     * @return {?}
                     */
                    k => k.parents.indexOf(n.id) > -1 && k.id.indexOf('groupHeader_') == -1)).length : 1) || 1,
                    rowspan: (n.node.children && n.node.children.length > 0) ? 1 : (maxlevel - n.level + 1),
                    title: data.caption,
                    field: data.dataField,
                    width: (data.size ? data.size.width : 100),
                    halign: data.halign,
                    align: data.align,
                    id: n.id
                };
            })));
        }
        return r;
    }
    /**
     * @param {?} $event
     * @return {?}
     */
    onTreeSelected($event) {
        this.selectedNode.emit($event.node);
    }
    /**
     * @private
     * @param {?} rn
     * @param {?} title
     * @param {?=} child
     * @return {?}
     */
    createNewGroupHeader(rn, title, child = false) {
        /** @type {?} */
        const ghid = this.generateGroupHeaderId();
        /** @type {?} */
        const data = { id: ghid, caption: title, groupHeader: true, halign: 'left' };
        /** @type {?} */
        const gh = {
            data,
            children: [],
            expanded: true,
            visible: true,
            icon: 'f-icon f-icon-aggregate-fields',
        };
        if (!child) {
            if (!rn.parent) {
                /** @type {?} */
                const i = this.treeData.findIndex((/**
                 * @param {?} n
                 * @return {?}
                 */
                n => n.data.id === rn.id)) + 1;
                this.treeData.splice(i, 0, gh);
                this.treeData = this.treeData.slice();
            }
            else {
                this.tt.appendChildren([gh], rn.parent);
            }
        }
        else {
            this.tt.appendChildren([gh], rn.node);
        }
    }
    /**
     * @private
     * @param {?} okCallback
     * @param {?} childs
     * @return {?}
     */
    showSelectColumnsDialog(okCallback, childs) {
        /** @type {?} */
        const modalRef = this.modalService.show(SelectColumnsComponent, {
            title: '设置分组列',
            width: 500,
            height: 300,
            showMaxButton: false,
            resizable: false,
            initialState: {
                fields: this.fields,
                checkeds: childs,
                groupEditorRef: this
            },
            buttons: [
                {
                    text: '确定',
                    cls: 'btn btn-primary',
                    handle: okCallback
                },
                {
                    text: '取消',
                    cls: 'btn btn-secondary',
                    handle: (/**
                     * @return {?}
                     */
                    () => {
                        modalRef.close();
                    })
                }
            ]
        });
        return modalRef;
    }
    /**
     * @private
     * @param {?} okCallback
     * @return {?}
     */
    showDialog(okCallback) {
        /** @type {?} */
        const modalRef = this.modalService.show(GroupHeaderFormComponent, {
            title: '分组列名称',
            width: 300,
            height: 200,
            showMaxButton: false,
            resizable: false,
            initialState: {
                title: '分组表头'
            },
            buttons: [
                {
                    text: '确定',
                    cls: 'btn btn-primary',
                    handle: okCallback
                },
                {
                    text: '取消',
                    cls: 'btn btn-secondary',
                    handle: (/**
                     * @return {?}
                     */
                    () => {
                        modalRef.close();
                    })
                }
            ]
        });
        return modalRef;
    }
}
HeaderGroupEditorComponent.decorators = [
    { type: Component, args: [{
                selector: 'header-group-editor',
                template: "\r\n\r\n\r\n<farris-treetable #tt [data]=\"treeData\" [idField]=\"idField\" [striped]=\"false\"\r\n(nodeSelected)=\"onTreeSelected($event)\"\r\n[singleSelect]=\"true\" [showIcon]=\"true\" [showFilterBar]=\"false\" [selectOnCheck]=\"true\" [checkOnSelect]=\"true\"\r\n[collapseIcon]=\"'f-icon f-icon-file-folder-close'\" [expandIcon]=\"'f-icon f-icon-file-folder-open'\"\r\n>\r\n    <ng-template farrisTemplate=\"body\" let-rowNode let-treeNode=\"node\" let-rowData=\"rowData\" >\r\n        <tr #row=\"row\" [selectRow]=\"rowNode\" [dblclick]=\"true\" (mouseenter)=\"onMouseEnter($event)\"\r\n                [selectRowDisabled]=\"rowData['houxunquNode']\"\r\n             (mouseleave)=\"onMouseLeave($event)\">\r\n            <td style=\"border: 0;\" [style.color]=\"row.selectRowDisabled? '#a6a6a6': '#333'\" [style.height.px]=\"34\" [style.lingHeight.px]=\"34\">\r\n                <farris-treeTableToggler [rowNode]=\"rowNode\"></farris-treeTableToggler>\r\n                <span style=\"vertical-align: middle;\">{{ rowData['caption'] }}</span>\r\n                <div class=\"rbtn\" style=\" float: right;  display:none; cursor: pointer\" >\r\n                    <!-- \u81EA\u5B9A\u4E49\u8868\u5934 -->\r\n                    <ng-container  *ngIf=\"rowData['groupHeader']\">\r\n                        <move-buttons [rowNode]=\"rowNode\"></move-buttons>\r\n                        <button  class=\"btn btn-light mr-1\" style=\"padding: 2px 5px\" title=\"\u589E\u52A0\u540C\u7EA7\" (click)=\"addNewGroup($event, rowNode)\">\r\n                            <span class=\"f-icon f-icon-plus\"></span>\r\n                        </button>\r\n                        <button class=\"btn btn-light mr-1\" style=\"padding: 2px 5px\" title=\"\u589E\u52A0\u4E0B\u7EA7\" (click)=\"addNewGroup($event, rowNode, true)\">\r\n                            <span class=\"f-icon f-icon-plus-outline\"></span>\r\n                        </button>\r\n                        \r\n                        <!-- <button  class=\"btn btn-light mr-1\" style=\"padding: 2px 5px\"  (click)=\"editGroupName(rowData)\" title=\"\u4FEE\u6539\">\r\n                            <span class=\"f-icon f-icon-edit\"></span>\r\n                        </button> -->\r\n\r\n                        <button  class=\"btn btn-light mr-1\" style=\"padding: 2px 5px\" (click)=\"setColumns($event, rowNode)\" title=\"\u5217\u8BBE\u7F6E\">\r\n                            <span class=\"f-icon f-icon-table-insert\"></span>\r\n                        </button>\r\n\r\n                        <button class=\"btn btn-light\" style=\"padding: 2px 5px\" title=\"\u5220\u9664\u5206\u7EC4\" (click)=\"removeGroup($event, rowNode)\">\r\n                            <span class=\"f-icon f-icon-x\"></span>\r\n                        </button>\r\n                        \r\n                    </ng-container>\r\n\r\n                    <!-- \u6570\u636E\u5B57\u6BB5\u8868\u5934 -->\r\n                    <ng-container *ngIf=\"!rowNode.parent && !rowData['houxunquNode'] && !rowData['groupHeader']\">\r\n                        <move-buttons  [rowNode]=\"rowNode\"></move-buttons>\r\n                        <button class=\"btn btn-light\"  style=\"padding: 2px 5px\" title=\"\u5C06\u6B64\u5B57\u6BB5\u5728\u6B64\u5206\u7EC4\u4E2D\u79FB\u9664\" (click)=\"removeColumn($event, rowData)\">\r\n                            <span class=\"f-icon f-icon-x\"></span>\r\n                        </button>\r\n                    </ng-container>\r\n                    \r\n                    <!-- \u5019\u9009\u5217\u4E2D\u6309\u94AE -->\r\n                    <button title=\"\u589E\u52A0\u8868\u5934\" class=\"btn btn-light\"  style=\"padding: 2px 5px\" *ngIf=\"rowData['houxunquNode']\" (click)=\"addNewGroup($event, null)\">\r\n                        <span class=\"f-icon f-icon-plus\"></span>\r\n                    </button>\r\n\r\n                    <button class=\"btn btn-light\" title=\"\u8BBE\u4E3A\u8868\u5934\" style=\"padding: 2px 5px\" *ngIf=\"rowNode.parent && rowNode.parent.data['houxunquNode']\" (click)=\"setColumn2Group($event, rowData)\">\r\n                        <span class=\"f-icon f-icon-table-row-insert-above\"></span>\r\n                    </button>\r\n\r\n                    <!-- \u8868\u5934\u4E2D\u5B57\u6BB5\u6309\u94AE -->\r\n                    <ng-container *ngIf=\"!rowData['groupHeader'] && rowNode.parent && !rowNode.parent.data['houxunquNode']\">\r\n                        <move-buttons  [rowNode]=\"rowNode\"></move-buttons>\r\n                        <button class=\"btn btn-light\"  style=\"padding: 2px 5px\" title=\"\u5C06\u6B64\u5B57\u6BB5\u5728\u6B64\u5206\u7EC4\u4E2D\u79FB\u9664\" (click)=\"removeColumn($event, rowData)\">\r\n                            <span class=\"f-icon f-icon-x\"></span>\r\n                        </button>\r\n                    </ng-container>\r\n                </div>\r\n\r\n            </td>\r\n        </tr>\r\n    </ng-template>\r\n</farris-treetable>\r\n",
                encapsulation: ViewEncapsulation.None,
                styles: [`
    .farris-treetable .farris-treetable-tbody td .treetable-toggler {
        vertical-align: middle;
    }
    .farris-treetable .farris-treetable-tbody td .treenode-icon {
        margin-right: 2px
    }
    `]
            }] }
];
/** @nocollapse */
HeaderGroupEditorComponent.ctorParameters = () => [
    { type: Injector },
    { type: BsModalService }
];
HeaderGroupEditorComponent.propDecorators = {
    fields: [{ type: Input }],
    idField: [{ type: Input }],
    treeData: [{ type: Input }],
    tt: [{ type: ViewChild, args: ['tt',] }],
    selectedNode: [{ type: Output }]
};
if (false) {
    /** @type {?} */
    HeaderGroupEditorComponent.prototype.fields;
    /** @type {?} */
    HeaderGroupEditorComponent.prototype.idField;
    /** @type {?} */
    HeaderGroupEditorComponent.prototype.treeData;
    /** @type {?} */
    HeaderGroupEditorComponent.prototype.tt;
    /** @type {?} */
    HeaderGroupEditorComponent.prototype.selectedNode;
    /** @type {?} */
    HeaderGroupEditorComponent.prototype.groupCols;
    /** @type {?} */
    HeaderGroupEditorComponent.prototype.HOU_XUN_LIE_ID;
    /** @type {?} */
    HeaderGroupEditorComponent.prototype.injector;
    /**
     * @type {?}
     * @private
     */
    HeaderGroupEditorComponent.prototype.modalService;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaGVhZGVyLWdyb3VwLWVkaXRvci5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZmFycmlzL2hlYWRlci1ncm91cC1lZGl0b3IvIiwic291cmNlcyI6WyJsaWIvaGVhZGVyLWdyb3VwLWVkaXRvci5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUFBLE9BQU8sRUFBRSxzQkFBc0IsRUFBRSxNQUFNLHlDQUF5QyxDQUFDO0FBQ2pGLE9BQU8sRUFBRSxTQUFTLEVBQVUsS0FBSyxFQUFFLFNBQVMsRUFBRSxRQUFRLEVBQUUsTUFBTSxFQUFFLFlBQVksRUFBYSxpQkFBaUIsRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUNsSSxPQUFPLEVBQUUsa0JBQWtCLEVBQXFCLE1BQU0sc0JBQXNCLENBQUM7QUFDN0UsT0FBTyxFQUFFLGNBQWMsRUFBRSxNQUFNLGtCQUFrQixDQUFDO0FBQ2xELE9BQU8sRUFBRSx3QkFBd0IsRUFBRSxNQUFNLCtCQUErQixDQUFDO0FBZ0J6RSxNQUFNLE9BQU8sMEJBQTBCOzs7OztJQWVuQyxZQUFtQixRQUFrQixFQUFVLFlBQTRCO1FBQXhELGFBQVEsR0FBUixRQUFRLENBQVU7UUFBVSxpQkFBWSxHQUFaLFlBQVksQ0FBZ0I7UUFabEUsWUFBTyxHQUFHLElBQUksQ0FBQztRQUNmLGFBQVEsR0FBRyxFQUFFLENBQUM7UUFJYixpQkFBWSxHQUFHLElBQUksWUFBWSxFQUFFLENBQUM7O1FBRzVDLGNBQVMsR0FBRyxFQUFFLENBQUM7UUFFZixtQkFBYyxHQUFHLG9CQUFvQixDQUFDO0lBR3RDLENBQUM7Ozs7SUFFRCxRQUFRO1FBQ0osSUFBSSxDQUFDLElBQUksQ0FBQyxRQUFRLElBQUksQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLE1BQU0sRUFBRTtZQUN6QyxJQUFJLENBQUMsWUFBWSxFQUFFLENBQUM7U0FDdkI7YUFBTTs7O2tCQUVHLGVBQWUsR0FBRyxJQUFJLENBQUMsUUFBUSxDQUFDLE1BQU07Ozs7WUFBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxRQUFRLEVBQUMsQ0FBQyxHQUFHOzs7O1lBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsUUFBUSxFQUFDOzs7a0JBRTVFLFNBQVMsR0FBRyxJQUFJLENBQUMsTUFBTSxDQUFDLE1BQU07Ozs7WUFBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsZUFBZSxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUM7WUFDMUUsU0FBUztZQUNULElBQUksU0FBUyxJQUFJLFNBQVMsQ0FBQyxNQUFNLEVBQUU7Z0JBQy9CLElBQUksQ0FBQyxRQUFRLEdBQUcsSUFBSSxDQUFDLFFBQVEsQ0FBQyxNQUFNLENBQUMsU0FBUyxDQUFDLEdBQUc7Ozs7Z0JBQUMsQ0FBQyxDQUFDLEVBQUU7b0JBQ25ELE9BQU87d0JBQ0gsUUFBUSxFQUFFLENBQUMsQ0FBQyxFQUFFO3dCQUNkLE1BQU0sRUFBRSxvQkFBb0I7d0JBQzVCLEtBQUssRUFBRSxDQUFDO3FCQUNYLENBQUM7Z0JBQ04sQ0FBQyxFQUFDLENBQUMsQ0FBQzthQUNQO1lBQ0QsSUFBSSxDQUFDLFFBQVEsR0FBRyxJQUFJLENBQUMsUUFBUSxDQUFDLEdBQUc7Ozs7WUFBQyxDQUFDLENBQUMsRUFBRTtnQkFDbEMsSUFBSSxDQUFDLENBQUMsUUFBUSxFQUFFOzswQkFDTixDQUFDLEdBQUcsSUFBSSxDQUFDLE1BQU0sQ0FBQyxJQUFJOzs7O29CQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLEVBQUUsS0FBSyxDQUFDLENBQUMsUUFBUSxFQUFDO29CQUNwRCxJQUFJLENBQUMsRUFBRTt3QkFDSCx5QkFDTyxDQUFDLElBQ0osTUFBTSxFQUFFLENBQUMsQ0FBQyxNQUFNLElBQ2xCO3FCQUNMO2lCQUNKO3FCQUFNO29CQUNILE9BQU8sQ0FBQyxDQUFDO2lCQUNaO1lBQ0wsQ0FBQyxFQUFDLENBQUMsTUFBTTs7OztZQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxFQUFDLENBQUM7WUFFbEIsSUFBSSxDQUFDLFFBQVEsR0FBRyxJQUFJLENBQUMsaUJBQWlCLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxDQUFDO1NBQ3pEO1FBR0QsSUFBSSxDQUFDLEVBQUUsQ0FBQyxPQUFPLENBQUMsU0FBUzs7OztRQUFDLE9BQU8sQ0FBQyxFQUFFO1lBQ2hDLElBQUksQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxXQUFXLEVBQUU7O3NCQUMxQixHQUFHLEdBQUcsSUFBSSxDQUFDLE1BQU0sRUFBRTtnQkFFekIsSUFBSSxDQUFDLE9BQU8sQ0FBQyxNQUFNLEVBQUU7b0JBQ2pCLElBQUksQ0FBQyxRQUFRLEdBQUcsSUFBSSxDQUFDLFFBQVEsQ0FBQyxNQUFNOzs7O29CQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxFQUFFLEtBQUssT0FBTyxDQUFDLEVBQUUsRUFBQyxDQUFDO2lCQUN2RTtnQkFFRCxJQUFJLENBQUMsRUFBRSxDQUFDLE1BQU0sQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLElBQUksRUFBRSxHQUFHLENBQUMsSUFBSSxDQUFDLENBQUM7YUFDL0M7UUFDTCxDQUFDLEVBQUMsQ0FBQztJQUNQLENBQUM7Ozs7SUFFRCxZQUFZO1FBQ1IsSUFBSSxDQUFDLFFBQVEsR0FBRyxDQUFDO2dCQUNiLElBQUksRUFBRSxFQUFFLEVBQUUsRUFBRSxlQUFlLEVBQUUsT0FBTyxFQUFFLE9BQU8sRUFBRSxNQUFNLEVBQUUsTUFBTSxFQUFFLFdBQVcsRUFBRSxJQUFJLEVBQUU7Z0JBQ2xGLFFBQVEsRUFBRSxJQUFJLENBQUMsTUFBTSxDQUFDLEdBQUc7Ozs7O2dCQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxFQUFFO29CQUMvQixDQUFDLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxDQUFDO29CQUNmLE9BQU87d0JBQ0gsSUFBSSxFQUFFLENBQUM7d0JBQ1AsUUFBUSxFQUFFLEVBQUU7d0JBQ1osT0FBTyxFQUFFLElBQUk7cUJBQ2hCLENBQUM7Z0JBQ04sQ0FBQyxFQUFDO2dCQUNGLFFBQVEsRUFBRSxJQUFJLEVBQUUsT0FBTyxFQUFFLElBQUk7YUFDaEMsRUFBRTtnQkFDQyxJQUFJLEVBQUUsRUFBRSxFQUFFLEVBQUUsSUFBSSxDQUFDLGNBQWMsRUFBRSxPQUFPLEVBQUUsT0FBTyxFQUFFLFlBQVksRUFBRSxJQUFJLEVBQUU7Z0JBQ3ZFLFFBQVEsRUFBRSxFQUFFO2dCQUNaLFFBQVEsRUFBRSxJQUFJO2FBQ2pCLENBQUMsQ0FBQztJQUNQLENBQUM7Ozs7SUFFRCxNQUFNO1FBQ0YsT0FBTyxJQUFJLENBQUMsRUFBRSxDQUFDLFdBQVcsQ0FBQyxJQUFJLENBQUMsY0FBYyxDQUFDLENBQUM7SUFDcEQsQ0FBQzs7Ozs7SUFFRCxZQUFZLENBQUMsTUFBa0I7UUFDM0IsQ0FBQyxtQkFBQSxNQUFNLENBQUMsTUFBTSxFQUFPLENBQUMsQ0FBQyxhQUFhLENBQUMsT0FBTyxDQUFDLENBQUMsS0FBSyxDQUFDLE9BQU8sR0FBRyxjQUFjLENBQUM7SUFDakYsQ0FBQzs7Ozs7SUFFRCxZQUFZLENBQUMsTUFBa0I7UUFDM0IsQ0FBQyxtQkFBQSxNQUFNLENBQUMsTUFBTSxFQUFPLENBQUMsQ0FBQyxhQUFhLENBQUMsT0FBTyxDQUFDLENBQUMsS0FBSyxDQUFDLE9BQU8sR0FBRyxNQUFNLENBQUM7SUFDekUsQ0FBQzs7Ozs7OztJQUlELFlBQVksQ0FBQyxLQUFpQixFQUFFLE9BQVk7UUFDeEMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLEVBQUUsQ0FBQyxDQUFDO0lBQy9CLENBQUM7Ozs7OztJQUdELGFBQWEsQ0FBQyxPQUFZOztjQUNqQixRQUFRLEdBQUcsSUFBSSxDQUFDLFVBQVU7OztRQUFDLEdBQUcsRUFBRTs7a0JBQzNCLE1BQU0sR0FBRyxtQkFBQSxRQUFRLENBQUMsT0FBTyxFQUE0QjtZQUMzRCxJQUFJLE1BQU0sQ0FBQyxLQUFLLEVBQUU7Z0JBQ2QsT0FBTyxDQUFDLE9BQU8sR0FBRyxNQUFNLENBQUMsS0FBSyxDQUFDO2dCQUMvQixRQUFRLENBQUMsS0FBSyxFQUFFLENBQUM7YUFDcEI7aUJBQU07Z0JBQ0gsS0FBSyxDQUFDLGNBQWMsQ0FBQyxDQUFDO2FBQ3pCO1FBQ04sQ0FBQyxFQUFDO1FBRUYsUUFBUSxDQUFDLE9BQU8sQ0FBQyxLQUFLLEdBQUcsT0FBTyxDQUFDLE9BQU8sQ0FBQztJQUM1QyxDQUFDOzs7OztJQUdPLHFCQUFxQjtRQUN6QixPQUFPLGVBQWUsSUFBSSxJQUFJLEVBQUUsQ0FBQyxPQUFPLEVBQUUsRUFBRSxDQUFDO0lBQ2pELENBQUM7Ozs7Ozs7O0lBR0QsV0FBVyxDQUFDLEtBQWlCLEVBQUUsRUFBVyxFQUFFLEtBQUssR0FBRyxLQUFLOztjQUMvQyxRQUFRLEdBQUcsSUFBSSxDQUFDLFVBQVU7OztRQUFDLEdBQUcsRUFBRTs7a0JBQzVCLE1BQU0sR0FBRyxtQkFBQSxRQUFRLENBQUMsT0FBTyxFQUE0QjtZQUMzRCxJQUFJLE1BQU0sQ0FBQyxLQUFLLEVBQUU7Z0JBQ2QsSUFBSSxDQUFDLEVBQUUsRUFBRTtvQkFDTCxJQUFJLENBQUMsUUFBUSxDQUFDLE1BQU0sQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFO3dCQUN2QixJQUFJLEVBQUU7NEJBQ0YsRUFBRSxFQUFFLElBQUksQ0FBQyxxQkFBcUIsRUFBRSxFQUFFLE1BQU0sRUFBRSxNQUFNOzRCQUNoRCxPQUFPLEVBQUUsTUFBTSxDQUFDLEtBQUssRUFBRSxXQUFXLEVBQUUsSUFBSTt5QkFDM0M7d0JBQ0QsSUFBSSxFQUFFLGdDQUFnQzt3QkFDdEMsUUFBUSxFQUFFLEVBQUU7cUJBQ2YsQ0FBQyxDQUFDO29CQUNILElBQUksQ0FBQyxFQUFFLENBQUMscUJBQXFCLEVBQUUsQ0FBQztpQkFDbkM7cUJBQU07b0JBQ0gsSUFBSSxDQUFDLG9CQUFvQixDQUFDLEVBQUUsRUFBRSxNQUFNLENBQUMsS0FBSyxFQUFFLEtBQUssQ0FBQyxDQUFDO2lCQUN0RDtnQkFFRCxRQUFRLENBQUMsS0FBSyxFQUFFLENBQUM7YUFDcEI7aUJBQU07Z0JBQ0gsS0FBSyxDQUFDLGNBQWMsQ0FBQyxDQUFDO2FBQ3pCO1FBQ04sQ0FBQyxFQUFDO0lBQ0wsQ0FBQzs7Ozs7O0lBRUQsZUFBZSxDQUFDLEtBQWlCLEVBQUUsR0FBRzs7Y0FDNUIsQ0FBQyxHQUFHLElBQUksQ0FBQyxRQUFRLENBQUMsTUFBTSxHQUFHLENBQUM7UUFDbEMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxNQUFNLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxFQUFFLElBQUksRUFBRSxHQUFHLEVBQUUsUUFBUSxFQUFFLEVBQUUsRUFBRSxDQUFDLENBQUM7O2NBRWxELEdBQUcsR0FBRyxJQUFJLENBQUMsUUFBUSxDQUFDLElBQUk7Ozs7UUFBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsWUFBWSxFQUFDO1FBQ3hELEdBQUcsQ0FBQyxRQUFRLEdBQUcsR0FBRyxDQUFDLFFBQVEsQ0FBQyxNQUFNOzs7O1FBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLEVBQUUsS0FBSyxHQUFHLENBQUMsRUFBRSxFQUFDLENBQUM7UUFFOUQsSUFBSSxDQUFDLEVBQUUsQ0FBQyxxQkFBcUIsRUFBRSxDQUFDO0lBQ3BDLENBQUM7Ozs7Ozs7SUFHRCxXQUFXLENBQUMsS0FBaUIsRUFBRSxPQUFPOztjQUM1QixNQUFNLEdBQUcsSUFBSSxDQUFDLEVBQUUsQ0FBQyxlQUFlLENBQUMsTUFBTTs7OztRQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLEVBQUUsQ0FBQyxHQUFHLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsV0FBVyxFQUFDLENBQUMsR0FBRzs7OztRQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLElBQUksRUFBQztRQUNuSSxJQUFJLENBQUMsUUFBUSxHQUFHLElBQUksQ0FBQyxRQUFRLENBQUMsTUFBTTs7OztRQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxFQUFFLEtBQUssT0FBTyxDQUFDLEVBQUUsRUFBQyxDQUFDO1FBQ3BFLElBQUksQ0FBQyxFQUFFLENBQUMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxFQUFFLENBQUMsQ0FBQztRQUMzQixJQUFJLENBQUMsRUFBRSxDQUFDLGNBQWMsQ0FBQyxNQUFNLEVBQUUsSUFBSSxDQUFDLE1BQU0sRUFBRSxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQ3ZELENBQUM7Ozs7OztJQUVELFVBQVUsQ0FBQyxLQUFpQixFQUFFLE9BQU87O2NBRTNCLE1BQU0sR0FBSSxPQUFPLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsR0FBRzs7OztRQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLElBQUksRUFBQyxDQUFDLENBQUMsQ0FBQyxFQUFFOztjQUU3RSxRQUFRLEdBQUcsSUFBSSxDQUFDLHVCQUF1Qjs7O1FBQUMsR0FBRyxFQUFFOztrQkFDekMsS0FBSyxHQUFHLG1CQUFBLFFBQVEsQ0FBQyxPQUFPLEVBQTBCOztnQkFDcEQsZUFBZSxHQUFHLEtBQUssQ0FBQyxRQUFROztrQkFFOUIsR0FBRyxHQUFHLElBQUksQ0FBQyxFQUFFLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBQyxjQUFjLENBQUM7WUFDcEQsR0FBRyxDQUFDLElBQUksQ0FBQyxRQUFRLEdBQUcsQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLFFBQVEsSUFBSSxFQUFFLENBQUMsQ0FBQyxNQUFNOzs7O1lBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxlQUFlLENBQUMsU0FBUzs7OztZQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLEVBQUUsS0FBSyxDQUFDLENBQUMsRUFBRSxFQUFDLEtBQUssQ0FBQyxDQUFDLEVBQUMsQ0FBQztZQUVoSCxPQUFPLENBQUMsSUFBSSxDQUFDLFFBQVEsR0FBRyxPQUFPLENBQUMsSUFBSSxDQUFDLFFBQVEsSUFBSSxFQUFFLENBQUM7WUFDcEQsZUFBZSxHQUFHLGVBQWUsQ0FBQyxNQUFNOzs7O1lBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxTQUFTOzs7O1lBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsRUFBRSxLQUFLLENBQUMsQ0FBQyxFQUFFLEVBQUMsS0FBSyxDQUFDLENBQUMsRUFBQyxDQUFDO1lBQzFHLElBQUksZUFBZSxJQUFJLGVBQWUsQ0FBQyxNQUFNLEVBQUU7Z0JBQzNDLElBQUksQ0FBQyxFQUFFLENBQUMsY0FBYyxDQUFDLGVBQWUsQ0FBQyxHQUFHOzs7O2dCQUFDLENBQUMsQ0FBQyxFQUFFO29CQUMzQyxPQUFPO3dCQUNILElBQUksRUFBRSxDQUFDO3dCQUNQLFFBQVEsRUFBRSxFQUFFO3dCQUNaLFFBQVEsRUFBRSxJQUFJO3FCQUNqQixDQUFDO2dCQUNOLENBQUMsRUFBQyxFQUFFLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQztnQkFFbEIsSUFBSSxDQUFDLEVBQUUsQ0FBQyxVQUFVLENBQUMsT0FBTyxDQUFDLEVBQUUsQ0FBQyxDQUFDO2FBQ2xDO1lBR0QsSUFBSSxLQUFLLENBQUMsVUFBVSxJQUFJLEtBQUssQ0FBQyxVQUFVLENBQUMsTUFBTSxFQUFFOzs7c0JBR3ZDLE9BQU8sR0FBRyxLQUFLLENBQUMsVUFBVSxDQUFDLEdBQUc7Ozs7Z0JBQUMsQ0FBQyxDQUFDLEVBQUU7b0JBQ3JDLE9BQU87d0JBQ0gsSUFBSSxFQUFFLENBQUM7d0JBQ1AsUUFBUSxFQUFFLEVBQUU7cUJBQ2YsQ0FBQztnQkFDTixDQUFDLEVBQUM7Z0JBRUYsR0FBRyxDQUFDLElBQUksQ0FBQyxRQUFRLEdBQUcsR0FBRyxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsTUFBTTs7OztnQkFBQyxDQUFDLENBQUMsRUFBRSxDQUFDLEtBQUssQ0FBQyxVQUFVLENBQUMsU0FBUzs7OztnQkFBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxFQUFFLEtBQUssQ0FBQyxDQUFDLEVBQUUsRUFBQyxLQUFLLENBQUMsQ0FBQyxFQUFDLENBQUM7Z0JBQ3pHLElBQUksQ0FBQyxFQUFFLENBQUMsY0FBYyxDQUFDLE9BQU8sRUFBRSxHQUFHLENBQUMsSUFBSSxDQUFDLENBQUM7YUFDN0M7WUFFRCxRQUFRLENBQUMsS0FBSyxFQUFFLENBQUM7UUFFckIsQ0FBQyxHQUFFLE1BQU0sQ0FBQztJQUNkLENBQUM7Ozs7O0lBRUQsY0FBYyxDQUFDLFVBQW1CLElBQUk7UUFDbEMsSUFBSSxDQUFDLE9BQU8sRUFBRTtZQUNWLE9BQU8sSUFBSSxDQUFDLFFBQVEsQ0FBQyxNQUFNOzs7O1lBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsV0FBVyxFQUFDLENBQUMsTUFBTSxDQUFDO1NBQzFEO2FBQU07WUFDSCxPQUFPLE9BQU8sQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLE1BQU07Ozs7WUFBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsV0FBVyxFQUFDLENBQUMsTUFBTSxDQUFDO1NBQ3ZFO0lBQ0wsQ0FBQzs7Ozs7O0lBRUQsTUFBTSxDQUFDLEtBQWlCLEVBQUUsT0FBTzs7WUFDekIsSUFBSSxHQUFHLElBQUksQ0FBQyxRQUFRO1FBQ3hCLElBQUksT0FBTyxDQUFDLE1BQU0sRUFBRTtZQUNoQixJQUFJLEdBQUcsT0FBTyxDQUFDLE1BQU0sQ0FBQyxRQUFRLENBQUM7U0FDbEM7O2NBRUssS0FBSyxHQUFHLElBQUksQ0FBQyxTQUFTOzs7O1FBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLEVBQUUsS0FBSyxPQUFPLENBQUMsRUFBRSxFQUFDO1FBQzNELElBQUksS0FBSyxLQUFLLENBQUMsRUFBRTs7a0JBQ1AsT0FBTyxHQUFHLElBQUksQ0FBQyxNQUFNLENBQUMsS0FBSyxFQUFFLENBQUMsQ0FBQztZQUNyQyxJQUFJLENBQUMsTUFBTSxDQUFDLEtBQUssR0FBRyxDQUFDLEVBQUUsQ0FBQyxFQUFFLEdBQUcsT0FBTyxDQUFDLENBQUM7WUFFdEMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxxQkFBcUIsRUFBRSxDQUFDO1NBQ25DO0lBQ0wsQ0FBQzs7Ozs7O0lBRUQsUUFBUSxDQUFDLEtBQWlCLEVBQUUsT0FBTzs7WUFDM0IsSUFBSSxHQUFHLElBQUksQ0FBQyxRQUFRO1FBQ3hCLElBQUksT0FBTyxDQUFDLE1BQU0sRUFBRTtZQUNoQixJQUFJLEdBQUcsT0FBTyxDQUFDLE1BQU0sQ0FBQyxRQUFRLENBQUM7U0FDbEM7O2NBQ0ssS0FBSyxHQUFHLElBQUksQ0FBQyxTQUFTOzs7O1FBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLEVBQUUsS0FBSyxPQUFPLENBQUMsRUFBRSxFQUFDOztjQUNyRCxHQUFHLEdBQUcsSUFBSSxDQUFDLE1BQU07UUFFdkIsSUFBSSxLQUFLLEtBQUssR0FBRyxHQUFHLENBQUMsRUFBRTs7a0JBQ2IsT0FBTyxHQUFHLElBQUksQ0FBQyxNQUFNLENBQUMsS0FBSyxFQUFFLENBQUMsQ0FBQztZQUNyQyxJQUFJLENBQUMsTUFBTSxDQUFDLEtBQUssR0FBRyxDQUFDLEVBQUUsQ0FBQyxFQUFFLEdBQUcsT0FBTyxDQUFDLENBQUM7WUFDdEMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxxQkFBcUIsRUFBRSxDQUFDO1NBQ25DO2FBQU07WUFDSCxJQUFJLENBQUMsVUFBVSxDQUFDLEtBQUssRUFBRSxPQUFPLENBQUMsQ0FBQztTQUNuQztJQUNMLENBQUM7Ozs7OztJQUVELE9BQU8sQ0FBQyxLQUFpQixFQUFFLE9BQU87O1lBQzFCLElBQUksR0FBRyxJQUFJLENBQUMsUUFBUTtRQUN4QixJQUFJLE9BQU8sQ0FBQyxNQUFNLEVBQUU7WUFDaEIsSUFBSSxHQUFHLE9BQU8sQ0FBQyxNQUFNLENBQUMsUUFBUSxDQUFDO1NBQ2xDOztjQUNLLEtBQUssR0FBRyxJQUFJLENBQUMsU0FBUzs7OztRQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxFQUFFLEtBQUssT0FBTyxDQUFDLEVBQUUsRUFBQztRQUMzRCxJQUFJLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUMzQixJQUFJLENBQUMsTUFBTSxDQUFDLEtBQUssR0FBRyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUM7UUFDMUIsSUFBSSxDQUFDLEVBQUUsQ0FBQyxxQkFBcUIsRUFBRSxDQUFDO0lBQ3BDLENBQUM7Ozs7OztJQUVELFVBQVUsQ0FBQyxLQUFpQixFQUFFLE9BQU87O1lBQzdCLElBQUksR0FBRyxJQUFJLENBQUMsUUFBUTtRQUN4QixJQUFJLE9BQU8sQ0FBQyxNQUFNLEVBQUU7WUFDaEIsSUFBSSxHQUFHLE9BQU8sQ0FBQyxNQUFNLENBQUMsUUFBUSxDQUFDO1NBQ2xDOztjQUVLLEtBQUssR0FBRyxJQUFJLENBQUMsU0FBUzs7OztRQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxFQUFFLEtBQUssT0FBTyxDQUFDLEVBQUUsRUFBQztRQUMzRCxJQUFJLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUN4QixJQUFJLENBQUMsTUFBTSxDQUFDLEtBQUssRUFBRSxDQUFDLENBQUMsQ0FBQztRQUV0QixJQUFJLENBQUMsT0FBTyxDQUFDLE1BQU0sRUFBRTtZQUNqQixJQUFJLENBQUMsTUFBTSxDQUFDLEtBQUssRUFBRSxPQUFPLENBQUMsQ0FBQztTQUMvQjthQUFNO1lBQ0gsSUFBSSxDQUFDLEVBQUUsQ0FBQyxxQkFBcUIsRUFBRSxDQUFDO1NBQ25DO0lBQ0wsQ0FBQzs7Ozs7SUFHRCxhQUFhO1FBQ1QsT0FBTyxJQUFJLENBQUMsUUFBUSxDQUFDLElBQUk7Ozs7UUFBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsWUFBWSxFQUFDLENBQUMsUUFBUSxDQUFDO0lBQ2pFLENBQUM7Ozs7SUFFRCxXQUFXOztjQUNELEdBQUcsR0FBRyxJQUFJLENBQUMsYUFBYSxFQUFFO1FBQ2hDLE9BQU8sSUFBSSxDQUFDLEVBQUUsQ0FBQyxlQUFlLENBQUMsTUFBTTs7OztRQUFDLENBQUMsQ0FBQyxFQUFFO1lBQ3RDLE9BQU8sQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxZQUFZLElBQUksR0FBRyxDQUFDLFNBQVM7Ozs7WUFBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsRUFBRSxLQUFLLENBQUMsQ0FBQyxFQUFFLEVBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQztRQUN0RixDQUFDLEVBQUMsQ0FBQztJQUNQLENBQUM7Ozs7Ozs7SUFHTyxpQkFBaUIsQ0FBQyxJQUFXLEVBQUUsUUFBUSxHQUFHLElBQUk7UUFDbEQsSUFBSSxJQUFJLENBQUMsTUFBTSxFQUFFOztrQkFDUCxLQUFLLEdBQUcsSUFBSSxDQUFDLE1BQU07Ozs7WUFBQyxDQUFDLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQyxDQUFDLE1BQU0sS0FBSyxRQUFRLEVBQUMsQ0FBQyxNQUFNOzs7O1lBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLEVBQUM7WUFDdEUsT0FBTyxLQUFLLENBQUMsR0FBRzs7OztZQUFDLElBQUksQ0FBQyxFQUFFOztzQkFDZCxJQUFJLEdBQVE7b0JBQ2QsSUFBSSxFQUFFLElBQUk7b0JBQ1YsUUFBUSxFQUFFLEVBQUU7b0JBQ1osUUFBUSxFQUFFLElBQUk7aUJBQ2pCO2dCQUVELElBQUksQ0FBQyxRQUFRLEdBQUcsSUFBSSxDQUFDLGlCQUFpQixDQUFDLElBQUksRUFBRSxJQUFJLENBQUMsRUFBRSxDQUFDLENBQUM7Z0JBQ3RELElBQUksSUFBSSxDQUFDLElBQUksQ0FBQyxXQUFXLElBQUksSUFBSSxDQUFDLFFBQVEsQ0FBQyxNQUFNLEtBQUssQ0FBQyxFQUFFO29CQUNyRCxJQUFJLENBQUMsSUFBSSxHQUFHLGdDQUFnQyxDQUFDO2lCQUNoRDtnQkFDRCxPQUFPLElBQUksQ0FBQztZQUNoQixDQUFDLEVBQUMsQ0FBQztTQUNOO1FBQ0QsT0FBTyxFQUFFLENBQUM7SUFDZCxDQUFDOzs7Ozs7SUFFTyxTQUFTLENBQUMsS0FBSzs7WUFDZixDQUFDLEdBQUcsRUFBRTtRQUNWLEtBQUssQ0FBQyxPQUFPOzs7O1FBQUMsQ0FBQyxDQUFDLEVBQUU7WUFDZCxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxJQUFJLENBQUM7WUFDekIsSUFBSSxDQUFDLENBQUMsUUFBUSxJQUFJLENBQUMsQ0FBQyxRQUFRLENBQUMsTUFBTSxFQUFFO2dCQUNqQyxDQUFDLEdBQUcsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLEVBQUUsSUFBSSxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQzthQUNwRDtRQUNMLENBQUMsRUFBQyxDQUFDO1FBQ0gsT0FBTyxDQUFDLENBQUM7SUFDYixDQUFDOzs7OztJQUVELGFBQWEsQ0FBQyxTQUFnQjs7Y0FDcEIsQ0FBQyxHQUFHLEVBQUU7O2NBQ04sS0FBSzs7Ozs7UUFBRyxDQUFDLEdBQUcsRUFBRSxFQUFFLEVBQUUsRUFBRSxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsR0FBRyxHQUFHLENBQUMsR0FBRyxDQUFDLE9BQU8sRUFBRSxLQUFLLFVBQVUsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUM7Ozs7UUFBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsQ0FBQSxDQUFDLENBQUMsQ0FBQTs7Y0FDekYsUUFBUSxHQUFHLEtBQUssQ0FBQyxTQUFTOzs7O1FBQUUsQ0FBQyxDQUFDLEVBQUUsRUFBRSxDQUFDLENBQUMsQ0FBQyxLQUFLLEVBQUM7UUFDakQsS0FBSyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxJQUFJLFFBQVEsRUFBRSxDQUFDLEVBQUUsRUFBRztZQUNqQyxDQUFDLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxNQUFNOzs7O1lBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsS0FBSyxLQUFLLENBQUMsRUFBQyxDQUFDLEdBQUc7Ozs7WUFBQyxDQUFDLENBQUMsRUFBRTs7c0JBQzFDLElBQUksR0FBRyxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUk7Z0JBQ3hCLE9BQU87b0JBQ0gsT0FBTyxFQUFFLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxNQUFNOzs7O29CQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxHQUFHLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxFQUFFLENBQUMsT0FBTyxDQUFDLGNBQWMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxFQUFDLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDO29CQUN0SSxPQUFPLEVBQUUsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLFFBQVEsSUFBSSxDQUFDLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxNQUFNLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxRQUFRLEdBQUcsQ0FBQyxDQUFDLEtBQUssR0FBRyxDQUFDLENBQUM7b0JBQ3ZGLEtBQUssRUFBRSxJQUFJLENBQUMsT0FBTztvQkFDbkIsS0FBSyxFQUFFLElBQUksQ0FBQyxTQUFTO29CQUNyQixLQUFLLEVBQUUsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDO29CQUMxQyxNQUFNLEVBQUUsSUFBSSxDQUFDLE1BQU07b0JBQ25CLEtBQUssRUFBRSxJQUFJLENBQUMsS0FBSztvQkFDakIsRUFBRSxFQUFFLENBQUMsQ0FBQyxFQUFFO2lCQUNYLENBQUM7WUFDTixDQUFDLEVBQUMsQ0FBQyxDQUFDO1NBQ1A7UUFFRCxPQUFPLENBQUMsQ0FBQztJQUNiLENBQUM7Ozs7O0lBRUQsY0FBYyxDQUFDLE1BQU07UUFDakIsSUFBSSxDQUFDLFlBQVksQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQ3hDLENBQUM7Ozs7Ozs7O0lBR08sb0JBQW9CLENBQUMsRUFBVyxFQUFFLEtBQWEsRUFBRSxLQUFLLEdBQUcsS0FBSzs7Y0FDNUQsSUFBSSxHQUFHLElBQUksQ0FBQyxxQkFBcUIsRUFBRTs7Y0FDbkMsSUFBSSxHQUFHLEVBQUUsRUFBRSxFQUFFLElBQUksRUFBRSxPQUFPLEVBQUUsS0FBSyxFQUFFLFdBQVcsRUFBRSxJQUFJLEVBQUUsTUFBTSxFQUFFLE1BQU0sRUFBRTs7Y0FDdEUsRUFBRSxHQUFHO1lBQ1AsSUFBSTtZQUNKLFFBQVEsRUFBRSxFQUFFO1lBQ1osUUFBUSxFQUFFLElBQUk7WUFDZCxPQUFPLEVBQUUsSUFBSTtZQUNiLElBQUksRUFBRSxnQ0FBZ0M7U0FDekM7UUFDRCxJQUFJLENBQUMsS0FBSyxFQUFFO1lBQ1IsSUFBSSxDQUFDLEVBQUUsQ0FBQyxNQUFNLEVBQUU7O3NCQUNOLENBQUMsR0FBRyxJQUFJLENBQUMsUUFBUSxDQUFDLFNBQVM7Ozs7Z0JBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLEVBQUUsS0FBSyxFQUFFLENBQUMsRUFBRSxFQUFDLEdBQUcsQ0FBQztnQkFDL0QsSUFBSSxDQUFDLFFBQVEsQ0FBQyxNQUFNLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQztnQkFDL0IsSUFBSSxDQUFDLFFBQVEsR0FBRyxJQUFJLENBQUMsUUFBUSxDQUFDLEtBQUssRUFBRSxDQUFDO2FBQ3pDO2lCQUFNO2dCQUNILElBQUksQ0FBQyxFQUFFLENBQUMsY0FBYyxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUUsRUFBRSxDQUFDLE1BQU0sQ0FBQyxDQUFDO2FBQzNDO1NBQ0o7YUFBTTtZQUNILElBQUksQ0FBQyxFQUFFLENBQUMsY0FBYyxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUUsRUFBRSxDQUFDLElBQUksQ0FBQyxDQUFDO1NBQ3pDO0lBQ0wsQ0FBQzs7Ozs7OztJQUVPLHVCQUF1QixDQUFDLFVBQVUsRUFBRSxNQUFNOztjQUN4QyxRQUFRLEdBQUcsSUFBSSxDQUFDLFlBQVksQ0FBQyxJQUFJLENBQUMsc0JBQXNCLEVBQUU7WUFDNUQsS0FBSyxFQUFFLE9BQU87WUFDZCxLQUFLLEVBQUUsR0FBRztZQUNWLE1BQU0sRUFBRSxHQUFHO1lBQ1gsYUFBYSxFQUFFLEtBQUs7WUFDcEIsU0FBUyxFQUFFLEtBQUs7WUFDaEIsWUFBWSxFQUFFO2dCQUNWLE1BQU0sRUFBRSxJQUFJLENBQUMsTUFBTTtnQkFDbkIsUUFBUSxFQUFFLE1BQU07Z0JBQ2hCLGNBQWMsRUFBRSxJQUFJO2FBQ3ZCO1lBQ0QsT0FBTyxFQUFFO2dCQUNMO29CQUNJLElBQUksRUFBRSxJQUFJO29CQUNWLEdBQUcsRUFBRSxpQkFBaUI7b0JBQ3RCLE1BQU0sRUFBRSxVQUFVO2lCQUNyQjtnQkFDRDtvQkFDSSxJQUFJLEVBQUUsSUFBSTtvQkFDVixHQUFHLEVBQUUsbUJBQW1CO29CQUN4QixNQUFNOzs7b0JBQUUsR0FBRyxFQUFFO3dCQUNULFFBQVEsQ0FBQyxLQUFLLEVBQUUsQ0FBQztvQkFDckIsQ0FBQyxDQUFBO2lCQUNKO2FBQ0o7U0FDSixDQUFDO1FBRUYsT0FBTyxRQUFRLENBQUM7SUFDcEIsQ0FBQzs7Ozs7O0lBRU8sVUFBVSxDQUFDLFVBQVU7O2NBQ25CLFFBQVEsR0FBRyxJQUFJLENBQUMsWUFBWSxDQUFDLElBQUksQ0FBQyx3QkFBd0IsRUFBRTtZQUM5RCxLQUFLLEVBQUUsT0FBTztZQUNkLEtBQUssRUFBRSxHQUFHO1lBQ1YsTUFBTSxFQUFFLEdBQUc7WUFDWCxhQUFhLEVBQUUsS0FBSztZQUNwQixTQUFTLEVBQUUsS0FBSztZQUNoQixZQUFZLEVBQUU7Z0JBQ1YsS0FBSyxFQUFFLE1BQU07YUFDaEI7WUFDRCxPQUFPLEVBQUU7Z0JBQ0w7b0JBQ0ksSUFBSSxFQUFFLElBQUk7b0JBQ1YsR0FBRyxFQUFFLGlCQUFpQjtvQkFDdEIsTUFBTSxFQUFFLFVBQVU7aUJBQ3JCO2dCQUNEO29CQUNJLElBQUksRUFBRSxJQUFJO29CQUNWLEdBQUcsRUFBRSxtQkFBbUI7b0JBQ3hCLE1BQU07OztvQkFBRSxHQUFHLEVBQUU7d0JBQ1QsUUFBUSxDQUFDLEtBQUssRUFBRSxDQUFDO29CQUNyQixDQUFDLENBQUE7aUJBQ0o7YUFDSjtTQUNKLENBQUM7UUFFRixPQUFPLFFBQVEsQ0FBQztJQUNwQixDQUFDOzs7WUEvYkosU0FBUyxTQUFDO2dCQUNQLFFBQVEsRUFBRSxxQkFBcUI7Z0JBQy9CLG80SkFBaUQ7Z0JBU2pELGFBQWEsRUFBRSxpQkFBaUIsQ0FBQyxJQUFJO3lCQVI1Qjs7Ozs7OztLQU9SO2FBRUo7Ozs7WUFsQjZDLFFBQVE7WUFFN0MsY0FBYzs7O3FCQW1CbEIsS0FBSztzQkFDTCxLQUFLO3VCQUNMLEtBQUs7aUJBRUwsU0FBUyxTQUFDLElBQUk7MkJBRWQsTUFBTTs7OztJQU5QLDRDQUF1Qjs7SUFDdkIsNkNBQXdCOztJQUN4Qiw4Q0FBdUI7O0lBRXZCLHdDQUF3Qzs7SUFFeEMsa0RBQTRDOztJQUc1QywrQ0FBZTs7SUFFZixvREFBc0M7O0lBRTFCLDhDQUF5Qjs7Ozs7SUFBRSxrREFBb0MiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBTZWxlY3RDb2x1bW5zQ29tcG9uZW50IH0gZnJvbSAnLi9ncm91cC1oZWFkZXItc2VsZWN0LWNvbHVtbnMuY29tcG9uZW50JztcclxuaW1wb3J0IHsgQ29tcG9uZW50LCBPbkluaXQsIElucHV0LCBWaWV3Q2hpbGQsIEluamVjdG9yLCBPdXRwdXQsIEV2ZW50RW1pdHRlciwgT25DaGFuZ2VzLCBWaWV3RW5jYXBzdWxhdGlvbiB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBUcmVlVGFibGVDb21wb25lbnQsIFJvd05vZGUsIFRyZWVOb2RlIH0gZnJvbSAnQGZhcnJpcy91aS10cmVldGFibGUnO1xyXG5pbXBvcnQgeyBCc01vZGFsU2VydmljZSB9IGZyb20gJ0BmYXJyaXMvdWktbW9kYWwnO1xyXG5pbXBvcnQgeyBHcm91cEhlYWRlckZvcm1Db21wb25lbnQgfSBmcm9tICcuL2dyb3VwLWhlYWRlci1mb3JtLmNvbXBvbmVudCc7XHJcbmltcG9ydCB7IGNsb25lRGVlcCB9IGZyb20gJ2xvZGFzaC1lcyc7XHJcblxyXG5AQ29tcG9uZW50KHtcclxuICAgIHNlbGVjdG9yOiAnaGVhZGVyLWdyb3VwLWVkaXRvcicsXHJcbiAgICB0ZW1wbGF0ZVVybDogJ2hlYWRlci1ncm91cC1lZGl0b3IuY29tcG9uZW50Lmh0bWwnLFxyXG4gICAgc3R5bGVzOiBbYFxyXG4gICAgLmZhcnJpcy10cmVldGFibGUgLmZhcnJpcy10cmVldGFibGUtdGJvZHkgdGQgLnRyZWV0YWJsZS10b2dnbGVyIHtcclxuICAgICAgICB2ZXJ0aWNhbC1hbGlnbjogbWlkZGxlO1xyXG4gICAgfVxyXG4gICAgLmZhcnJpcy10cmVldGFibGUgLmZhcnJpcy10cmVldGFibGUtdGJvZHkgdGQgLnRyZWVub2RlLWljb24ge1xyXG4gICAgICAgIG1hcmdpbi1yaWdodDogMnB4XHJcbiAgICB9XHJcbiAgICBgXSxcclxuICAgIGVuY2Fwc3VsYXRpb246IFZpZXdFbmNhcHN1bGF0aW9uLk5vbmVcclxufSlcclxuZXhwb3J0IGNsYXNzIEhlYWRlckdyb3VwRWRpdG9yQ29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0IHtcclxuXHJcbiAgICBASW5wdXQoKSBmaWVsZHM6IGFueVtdO1xyXG4gICAgQElucHV0KCkgaWRGaWVsZCA9ICdpZCc7XHJcbiAgICBASW5wdXQoKSB0cmVlRGF0YSA9IFtdO1xyXG5cclxuICAgIEBWaWV3Q2hpbGQoJ3R0JykgdHQ6IFRyZWVUYWJsZUNvbXBvbmVudDtcclxuXHJcbiAgICBAT3V0cHV0KCkgc2VsZWN0ZWROb2RlID0gbmV3IEV2ZW50RW1pdHRlcigpO1xyXG5cclxuICAgIC8vIHByZXZpZXcgZ3JvdXAgY29sdW1uc1xyXG4gICAgZ3JvdXBDb2xzID0gW107XHJcblxyXG4gICAgSE9VX1hVTl9MSUVfSUQgPSAnX19IT1VfWFVOX0xJRV9JRF9fJztcclxuXHJcbiAgICBjb25zdHJ1Y3RvcihwdWJsaWMgaW5qZWN0b3I6IEluamVjdG9yLCBwcml2YXRlIG1vZGFsU2VydmljZTogQnNNb2RhbFNlcnZpY2UpIHtcclxuICAgIH1cclxuXHJcbiAgICBuZ09uSW5pdCgpIHtcclxuICAgICAgICBpZiAoIXRoaXMudHJlZURhdGEgfHwgIXRoaXMudHJlZURhdGEubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIHRoaXMuaW5pdFRyZWVEYXRhKCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgLy8g5aSa6KGo5aS05Lit546w5a2Y55qE5a2X5q61SUTpm4blkIhcclxuICAgICAgICAgICAgY29uc3QgY3VycmVudEZpZWxkSWRzID0gdGhpcy50cmVlRGF0YS5maWx0ZXIobiA9PiBuLmZpZWxkUmVmKS5tYXAobiA9PiBuLmZpZWxkUmVmKTtcclxuICAgICAgICAgICAgLy8g5paw5aKe55qE5a2X5q61XHJcbiAgICAgICAgICAgIGNvbnN0IG5ld0ZpZWxkcyA9IHRoaXMuZmllbGRzLmZpbHRlcihuID0+ICFjdXJyZW50RmllbGRJZHMuaW5jbHVkZXMobi5pZCkpO1xyXG4gICAgICAgICAgICAvLyDmlrDlop7lgJnpgInlrZfmrrVcclxuICAgICAgICAgICAgaWYgKG5ld0ZpZWxkcyAmJiBuZXdGaWVsZHMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnRyZWVEYXRhID0gdGhpcy50cmVlRGF0YS5jb25jYXQobmV3RmllbGRzLm1hcChuID0+IHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmaWVsZFJlZjogbi5pZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGFyZW50OiAnX19IT1VfWFVOX0xJRV9JRF9fJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGV2ZWw6IDFcclxuICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgfSkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMudHJlZURhdGEgPSB0aGlzLnRyZWVEYXRhLm1hcChuID0+IHtcclxuICAgICAgICAgICAgICAgIGlmIChuLmZpZWxkUmVmKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZiA9IHRoaXMuZmllbGRzLmZpbmQobSA9PiBtLmlkID09PSBuLmZpZWxkUmVmKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoZikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLi4uZixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmVudDogbi5wYXJlbnRcclxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBuO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KS5maWx0ZXIobiA9PiBuKTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMudHJlZURhdGEgPSB0aGlzLmNvbnZlcnQyVHJlZU5vZGVzKHRoaXMudHJlZURhdGEpO1xyXG4gICAgICAgIH1cclxuXHJcblxyXG4gICAgICAgIHRoaXMudHQucmVtb3ZlZC5zdWJzY3JpYmUocm93Tm9kZSA9PiB7XHJcbiAgICAgICAgICAgIGlmICghcm93Tm9kZS5ub2RlLmRhdGEuZ3JvdXBIZWFkZXIpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGh4bCA9IHRoaXMuZ2V0SHhsKCk7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKCFyb3dOb2RlLnBhcmVudCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMudHJlZURhdGEgPSB0aGlzLnRyZWVEYXRhLmZpbHRlcihuID0+IG4uZGF0YS5pZCAhPT0gcm93Tm9kZS5pZCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgdGhpcy50dC5hcHBlbmQocm93Tm9kZS5ub2RlLmRhdGEsIGh4bC5ub2RlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIGluaXRUcmVlRGF0YSgpIHtcclxuICAgICAgICB0aGlzLnRyZWVEYXRhID0gW3tcclxuICAgICAgICAgICAgZGF0YTogeyBpZDogJ2dyb3VwSGVhZGVyXzEnLCBjYXB0aW9uOiAn5YiG57uE6KGo5aS0MScsIGhhbGlnbjogJ2xlZnQnLCBncm91cEhlYWRlcjogdHJ1ZSB9LFxyXG4gICAgICAgICAgICBjaGlsZHJlbjogdGhpcy5maWVsZHMubWFwKChuLCBpKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBuWydpbmRleCddID0gaTtcclxuICAgICAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YTogbixcclxuICAgICAgICAgICAgICAgICAgICBjaGlsZHJlbjogW10sXHJcbiAgICAgICAgICAgICAgICAgICAgdmlzaWJsZTogdHJ1ZVxyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgfSksXHJcbiAgICAgICAgICAgIGV4cGFuZGVkOiB0cnVlLCB2aXNpYmxlOiB0cnVlXHJcbiAgICAgICAgfSwge1xyXG4gICAgICAgICAgICBkYXRhOiB7IGlkOiB0aGlzLkhPVV9YVU5fTElFX0lELCBjYXB0aW9uOiAnKOWAmemAieWIlyknLCBob3V4dW5xdU5vZGU6IHRydWUgfSxcclxuICAgICAgICAgICAgY2hpbGRyZW46IFtdLFxyXG4gICAgICAgICAgICBleHBhbmRlZDogdHJ1ZVxyXG4gICAgICAgIH1dO1xyXG4gICAgfVxyXG5cclxuICAgIGdldEh4bCgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy50dC5maW5kUm93Tm9kZSh0aGlzLkhPVV9YVU5fTElFX0lEKTtcclxuICAgIH1cclxuXHJcbiAgICBvbk1vdXNlRW50ZXIoJGV2ZW50OiBNb3VzZUV2ZW50KSB7XHJcbiAgICAgICAgKCRldmVudC50YXJnZXQgYXMgYW55KS5xdWVyeVNlbGVjdG9yKCcucmJ0bicpLnN0eWxlLmRpc3BsYXkgPSAnaW5saW5lLWJsb2NrJztcclxuICAgIH1cclxuXHJcbiAgICBvbk1vdXNlTGVhdmUoJGV2ZW50OiBNb3VzZUV2ZW50KSB7XHJcbiAgICAgICAgKCRldmVudC50YXJnZXQgYXMgYW55KS5xdWVyeVNlbGVjdG9yKCcucmJ0bicpLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XHJcbiAgICB9XHJcblxyXG5cclxuICAgIC8vIOenu+mZpOWIl1xyXG4gICAgcmVtb3ZlQ29sdW1uKGV2ZW50OiBNb3VzZUV2ZW50LCByb3dEYXRhOiBhbnkpIHtcclxuICAgICAgICB0aGlzLnR0LnJlbW92ZShyb3dEYXRhLmlkKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyDnvJbovpHliIbnu4TliJdcclxuICAgIGVkaXRHcm91cE5hbWUocm93RGF0YTogYW55KSB7XHJcbiAgICAgICBjb25zdCBtb2RhbFJlZiA9IHRoaXMuc2hvd0RpYWxvZygoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGdoZlJlZiA9IG1vZGFsUmVmLmNvbnRlbnQgYXMgR3JvdXBIZWFkZXJGb3JtQ29tcG9uZW50O1xyXG4gICAgICAgICAgICBpZiAoZ2hmUmVmLnRpdGxlKSB7XHJcbiAgICAgICAgICAgICAgICByb3dEYXRhLmNhcHRpb24gPSBnaGZSZWYudGl0bGU7XHJcbiAgICAgICAgICAgICAgICBtb2RhbFJlZi5jbG9zZSgpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgYWxlcnQoJ+ivt+i+k+WFpeWQjeensO+8geWQpuWImeeCueWPlua2iOOAgicpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICB9KTtcclxuXHJcbiAgICAgICBtb2RhbFJlZi5jb250ZW50LnRpdGxlID0gcm93RGF0YS5jYXB0aW9uO1xyXG4gICAgfVxyXG5cclxuXHJcbiAgICBwcml2YXRlIGdlbmVyYXRlR3JvdXBIZWFkZXJJZCgpIHtcclxuICAgICAgICByZXR1cm4gYGdyb3VwSGVhZGVyXyR7bmV3IERhdGUoKS5nZXRUaW1lKCl9YDtcclxuICAgIH1cclxuXHJcbiAgICAvLyDmlrDlop7liIbnu4RcclxuICAgIGFkZE5ld0dyb3VwKGV2ZW50OiBNb3VzZUV2ZW50LCBybjogUm93Tm9kZSwgY2hpbGQgPSBmYWxzZSkge1xyXG4gICAgICAgIGNvbnN0IG1vZGFsUmVmID0gdGhpcy5zaG93RGlhbG9nKCgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgZ2hmUmVmID0gbW9kYWxSZWYuY29udGVudCBhcyBHcm91cEhlYWRlckZvcm1Db21wb25lbnQ7XHJcbiAgICAgICAgICAgIGlmIChnaGZSZWYudGl0bGUpIHtcclxuICAgICAgICAgICAgICAgIGlmICghcm4pIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnRyZWVEYXRhLnNwbGljZSgwLCAwLCB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkOiB0aGlzLmdlbmVyYXRlR3JvdXBIZWFkZXJJZCgpLCBoYWxpZ246ICdsZWZ0JyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhcHRpb246IGdoZlJlZi50aXRsZSwgZ3JvdXBIZWFkZXI6IHRydWVcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWNvbjogJ2YtaWNvbiBmLWljb24tYWdncmVnYXRlLWZpZWxkcycsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNoaWxkcmVuOiBbXVxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMudHQudXBkYXRlU2VyaWFsaXplZFZhbHVlKCk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY3JlYXRlTmV3R3JvdXBIZWFkZXIocm4sIGdoZlJlZi50aXRsZSwgY2hpbGQpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIG1vZGFsUmVmLmNsb3NlKCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBhbGVydCgn6K+36L6T5YWl5ZCN56ew77yB5ZCm5YiZ54K55Y+W5raI44CCJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIHNldENvbHVtbjJHcm91cChldmVudDogTW91c2VFdmVudCwgY29sKSB7XHJcbiAgICAgICAgY29uc3QgaSA9IHRoaXMudHJlZURhdGEubGVuZ3RoIC0gMTtcclxuICAgICAgICB0aGlzLnRyZWVEYXRhLnNwbGljZShpLCAwLCB7IGRhdGE6IGNvbCwgY2hpbGRyZW46IFtdIH0pO1xyXG5cclxuICAgICAgICBjb25zdCBoeGwgPSB0aGlzLnRyZWVEYXRhLmZpbmQobiA9PiBuLmRhdGEuaG91eHVucXVOb2RlKTtcclxuICAgICAgICBoeGwuY2hpbGRyZW4gPSBoeGwuY2hpbGRyZW4uZmlsdGVyKG4gPT4gbi5kYXRhLmlkICE9PSBjb2wuaWQpO1xyXG5cclxuICAgICAgICB0aGlzLnR0LnVwZGF0ZVNlcmlhbGl6ZWRWYWx1ZSgpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIOWIoOmZpOWIhue7hFxyXG4gICAgcmVtb3ZlR3JvdXAoZXZlbnQ6IE1vdXNlRXZlbnQsIHJvd05vZGUpIHtcclxuICAgICAgICBjb25zdCBjaGlsZHMgPSB0aGlzLnR0LnNlcmlhbGl6ZWRWYWx1ZS5maWx0ZXIobiA9PiBuLnBhcmVudHMuaW5kZXhPZihyb3dOb2RlLmlkKSA+IC0xICYmICFuLm5vZGUuZGF0YS5ncm91cEhlYWRlcikubWFwKG4gPT4gbi5ub2RlKTtcclxuICAgICAgICB0aGlzLnRyZWVEYXRhID0gdGhpcy50cmVlRGF0YS5maWx0ZXIobiA9PiBuLmRhdGEuaWQgIT09IHJvd05vZGUuaWQpO1xyXG4gICAgICAgIHRoaXMudHQucmVtb3ZlKHJvd05vZGUuaWQpO1xyXG4gICAgICAgIHRoaXMudHQuYXBwZW5kQ2hpbGRyZW4oY2hpbGRzLCB0aGlzLmdldEh4bCgpLm5vZGUpO1xyXG4gICAgfVxyXG5cclxuICAgIHNldENvbHVtbnMoZXZlbnQ6IE1vdXNlRXZlbnQsIHJvd05vZGUpIHtcclxuXHJcbiAgICAgICAgY29uc3QgY2hpbGRzID0gIHJvd05vZGUubm9kZS5jaGlsZHJlbiA/IHJvd05vZGUubm9kZS5jaGlsZHJlbi5tYXAobiA9PiBuLmRhdGEpIDogW107XHJcblxyXG4gICAgICAgIGNvbnN0IG1vZGFsUmVmID0gdGhpcy5zaG93U2VsZWN0Q29sdW1uc0RpYWxvZygoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHNjUmVmID0gbW9kYWxSZWYuY29udGVudCBhcyBTZWxlY3RDb2x1bW5zQ29tcG9uZW50O1xyXG4gICAgICAgICAgICBsZXQgbmVlZEFwcGVuZE5vZGVzID0gc2NSZWYuY2hlY2tlZHM7XHJcblxyXG4gICAgICAgICAgICBjb25zdCBoeGwgPSB0aGlzLnR0LmZpbmRSb3dOb2RlKHRoaXMuSE9VX1hVTl9MSUVfSUQpO1xyXG4gICAgICAgICAgICBoeGwubm9kZS5jaGlsZHJlbiA9IChoeGwubm9kZS5jaGlsZHJlbiB8fCBbXSkuZmlsdGVyKG4gPT4gbmVlZEFwcGVuZE5vZGVzLmZpbmRJbmRleChjID0+IGMuaWQgPT09IG4uaWQpID09PSAtMSk7XHJcblxyXG4gICAgICAgICAgICByb3dOb2RlLm5vZGUuY2hpbGRyZW4gPSByb3dOb2RlLm5vZGUuY2hpbGRyZW4gfHwgW107XHJcbiAgICAgICAgICAgIG5lZWRBcHBlbmROb2RlcyA9IG5lZWRBcHBlbmROb2Rlcy5maWx0ZXIobiA9PiByb3dOb2RlLm5vZGUuY2hpbGRyZW4uZmluZEluZGV4KGMgPT4gYy5pZCA9PT0gbi5pZCkgPT09IC0xKTtcclxuICAgICAgICAgICAgaWYgKG5lZWRBcHBlbmROb2RlcyAmJiBuZWVkQXBwZW5kTm9kZXMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnR0LmFwcGVuZENoaWxkcmVuKG5lZWRBcHBlbmROb2Rlcy5tYXAobiA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YTogbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2hpbGRyZW46IFtdLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBleHBhbmRlZDogdHJ1ZVxyXG4gICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICB9KSwgcm93Tm9kZS5ub2RlKTtcclxuXHJcbiAgICAgICAgICAgICAgICB0aGlzLnR0LmV4cGFuZE5vZGUocm93Tm9kZS5pZCk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcblxyXG4gICAgICAgICAgICBpZiAoc2NSZWYudW5jaGVja2VkcyAmJiBzY1JlZi51bmNoZWNrZWRzLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgLy8gaHhsLm5vZGUuY2hpbGRyZW4gPSAgW107XHJcblxyXG4gICAgICAgICAgICAgICAgY29uc3QgaHhsQ29scyA9IHNjUmVmLnVuY2hlY2tlZHMubWFwKG4gPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IG4sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNoaWxkcmVuOiBbXVxyXG4gICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICBoeGwubm9kZS5jaGlsZHJlbiA9IGh4bC5ub2RlLmNoaWxkcmVuLmZpbHRlcihuID0+IHNjUmVmLnVuY2hlY2tlZHMuZmluZEluZGV4KGMgPT4gYy5pZCA9PT0gbi5pZCkgPT09IC0xKTtcclxuICAgICAgICAgICAgICAgIHRoaXMudHQuYXBwZW5kQ2hpbGRyZW4oaHhsQ29scywgaHhsLm5vZGUpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBtb2RhbFJlZi5jbG9zZSgpO1xyXG5cclxuICAgICAgICB9LCBjaGlsZHMpO1xyXG4gICAgfVxyXG5cclxuICAgIGhhc0dyb3VwSGVhZGVyKHJvd05vZGU6IFJvd05vZGUgPSBudWxsKSB7XHJcbiAgICAgICAgaWYgKCFyb3dOb2RlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnRyZWVEYXRhLmZpbHRlcihuID0+IG4uZ3JvdXBIZWFkZXIpLmxlbmd0aDtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gcm93Tm9kZS5ub2RlLmNoaWxkcmVuLmZpbHRlcihuID0+IG4uZGF0YS5ncm91cEhlYWRlcikubGVuZ3RoO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBtb3ZlVXAoZXZlbnQ6IE1vdXNlRXZlbnQsIHJvd05vZGUpIHtcclxuICAgICAgICBsZXQgZGF0YSA9IHRoaXMudHJlZURhdGE7XHJcbiAgICAgICAgaWYgKHJvd05vZGUucGFyZW50KSB7XHJcbiAgICAgICAgICAgIGRhdGEgPSByb3dOb2RlLnBhcmVudC5jaGlsZHJlbjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IGluZGV4ID0gZGF0YS5maW5kSW5kZXgobiA9PiBuLmRhdGEuaWQgPT09IHJvd05vZGUuaWQpO1xyXG4gICAgICAgIGlmIChpbmRleCAhPT0gMCkge1xyXG4gICAgICAgICAgICBjb25zdCB0ZW1wQXJyID0gZGF0YS5zcGxpY2UoaW5kZXgsIDEpO1xyXG4gICAgICAgICAgICBkYXRhLnNwbGljZShpbmRleCAtIDEsIDAsIC4uLnRlbXBBcnIpO1xyXG5cclxuICAgICAgICAgICAgdGhpcy50dC51cGRhdGVTZXJpYWxpemVkVmFsdWUoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgbW92ZURvd24oZXZlbnQ6IE1vdXNlRXZlbnQsIHJvd05vZGUpIHtcclxuICAgICAgICBsZXQgZGF0YSA9IHRoaXMudHJlZURhdGE7XHJcbiAgICAgICAgaWYgKHJvd05vZGUucGFyZW50KSB7XHJcbiAgICAgICAgICAgIGRhdGEgPSByb3dOb2RlLnBhcmVudC5jaGlsZHJlbjtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgaW5kZXggPSBkYXRhLmZpbmRJbmRleChuID0+IG4uZGF0YS5pZCA9PT0gcm93Tm9kZS5pZCk7XHJcbiAgICAgICAgY29uc3QgbGVuID0gZGF0YS5sZW5ndGg7XHJcblxyXG4gICAgICAgIGlmIChpbmRleCAhPT0gbGVuIC0gMikge1xyXG4gICAgICAgICAgICBjb25zdCB0ZW1wQXJyID0gZGF0YS5zcGxpY2UoaW5kZXgsIDEpO1xyXG4gICAgICAgICAgICBkYXRhLnNwbGljZShpbmRleCArIDEsIDAsIC4uLnRlbXBBcnIpO1xyXG4gICAgICAgICAgICB0aGlzLnR0LnVwZGF0ZVNlcmlhbGl6ZWRWYWx1ZSgpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMubW92ZUJvdHRvbShldmVudCwgcm93Tm9kZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIG1vdmVUb3AoZXZlbnQ6IE1vdXNlRXZlbnQsIHJvd05vZGUpIHtcclxuICAgICAgICBsZXQgZGF0YSA9IHRoaXMudHJlZURhdGE7XHJcbiAgICAgICAgaWYgKHJvd05vZGUucGFyZW50KSB7XHJcbiAgICAgICAgICAgIGRhdGEgPSByb3dOb2RlLnBhcmVudC5jaGlsZHJlbjtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgaW5kZXggPSBkYXRhLmZpbmRJbmRleChuID0+IG4uZGF0YS5pZCA9PT0gcm93Tm9kZS5pZCk7XHJcbiAgICAgICAgZGF0YS51bnNoaWZ0KHJvd05vZGUubm9kZSk7XHJcbiAgICAgICAgZGF0YS5zcGxpY2UoaW5kZXggKyAxLCAxKTtcclxuICAgICAgICB0aGlzLnR0LnVwZGF0ZVNlcmlhbGl6ZWRWYWx1ZSgpO1xyXG4gICAgfVxyXG5cclxuICAgIG1vdmVCb3R0b20oZXZlbnQ6IE1vdXNlRXZlbnQsIHJvd05vZGUpIHtcclxuICAgICAgICBsZXQgZGF0YSA9IHRoaXMudHJlZURhdGE7XHJcbiAgICAgICAgaWYgKHJvd05vZGUucGFyZW50KSB7XHJcbiAgICAgICAgICAgIGRhdGEgPSByb3dOb2RlLnBhcmVudC5jaGlsZHJlbjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IGluZGV4ID0gZGF0YS5maW5kSW5kZXgobiA9PiBuLmRhdGEuaWQgPT09IHJvd05vZGUuaWQpO1xyXG4gICAgICAgIGRhdGEucHVzaChyb3dOb2RlLm5vZGUpO1xyXG4gICAgICAgIGRhdGEuc3BsaWNlKGluZGV4LCAxKTtcclxuXHJcbiAgICAgICAgaWYgKCFyb3dOb2RlLnBhcmVudCkge1xyXG4gICAgICAgICAgICB0aGlzLm1vdmVVcChldmVudCwgcm93Tm9kZSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy50dC51cGRhdGVTZXJpYWxpemVkVmFsdWUoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqIOiOt+WPluWAmemAieWIlyAqL1xyXG4gICAgZ2V0SG91WHVhbkxpZSgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy50cmVlRGF0YS5maW5kKG4gPT4gbi5kYXRhLmhvdXh1bnF1Tm9kZSkuY2hpbGRyZW47XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0QWxsTm9kZXMoKSB7XHJcbiAgICAgICAgY29uc3QgaHhsID0gdGhpcy5nZXRIb3VYdWFuTGllKCk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMudHQuc2VyaWFsaXplZFZhbHVlLmZpbHRlcihuID0+IHtcclxuICAgICAgICAgICAgcmV0dXJuICFuLm5vZGUuZGF0YS5ob3V4dW5xdU5vZGUgJiYgaHhsLmZpbmRJbmRleChrID0+IGsuZGF0YS5pZCA9PT0gbi5pZCkgPT09IC0xO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuXHJcbiAgICBwcml2YXRlIGNvbnZlcnQyVHJlZU5vZGVzKGRhdGE6IGFueVtdLCBwYXJlbnRJZCA9IG51bGwpOiBUcmVlTm9kZVtdIHtcclxuICAgICAgICBpZiAoZGF0YS5sZW5ndGgpIHtcclxuICAgICAgICAgICAgY29uc3Qgbm9kZXMgPSBkYXRhLmZpbHRlcigodikgPT4gdi5wYXJlbnQgPT09IHBhcmVudElkKS5maWx0ZXIobiA9PiBuKTtcclxuICAgICAgICAgICAgcmV0dXJuIG5vZGVzLm1hcChpdGVtID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG5vZGU6IGFueSA9IHtcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiBpdGVtLFxyXG4gICAgICAgICAgICAgICAgICAgIGNoaWxkcmVuOiBbXSxcclxuICAgICAgICAgICAgICAgICAgICBleHBhbmRlZDogdHJ1ZVxyXG4gICAgICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgICAgICBub2RlLmNoaWxkcmVuID0gdGhpcy5jb252ZXJ0MlRyZWVOb2RlcyhkYXRhLCBpdGVtLmlkKTtcclxuICAgICAgICAgICAgICAgIGlmIChub2RlLmRhdGEuZ3JvdXBIZWFkZXIgJiYgbm9kZS5jaGlsZHJlbi5sZW5ndGggPT09IDApIHtcclxuICAgICAgICAgICAgICAgICAgICBub2RlLmljb24gPSAnZi1pY29uIGYtaWNvbi1hZ2dyZWdhdGUtZmllbGRzJztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBub2RlO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIFtdO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgZmxhdE5vZGVzKG5vZGVzKSB7XHJcbiAgICAgICAgbGV0IHIgPSB7fTtcclxuICAgICAgICBub2Rlcy5mb3JFYWNoKGUgPT4ge1xyXG4gICAgICAgICAgICByW2UuZGF0YVsnaWQnXV0gPSBlLmRhdGE7XHJcbiAgICAgICAgICAgIGlmIChlLmNoaWxkcmVuICYmIGUuY2hpbGRyZW4ubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICByID0gT2JqZWN0LmFzc2lnbihyLCB0aGlzLmZsYXROb2RlcyhlLmNoaWxkcmVuKSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4gcjtcclxuICAgIH1cclxuXHJcbiAgICBjb252ZXJ0MkFycmF5KHRyZWVOb2RlczogYW55W10pIHtcclxuICAgICAgICBjb25zdCByID0gW107XHJcbiAgICAgICAgY29uc3QgbWF4QnkgPSAoYXJyLCBmbikgPT4gTWF0aC5tYXgoLi4uYXJyLm1hcCh0eXBlb2YgZm4gPT09ICdmdW5jdGlvbicgPyBmbiA6IHZhbCA9PiB2YWxbZm5dKSk7XHJcbiAgICAgICAgY29uc3QgbWF4bGV2ZWwgPSBtYXhCeSh0cmVlTm9kZXMsIChuKSA9PiBuLmxldmVsKSA7XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPD0gbWF4bGV2ZWw7IGkrKyApIHtcclxuICAgICAgICAgICAgci5wdXNoKHRyZWVOb2Rlcy5maWx0ZXIobiA9PiBuLmxldmVsID09PSBpKS5tYXAobiA9PiB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBkYXRhID0gbi5ub2RlLmRhdGE7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbHNwYW46IChuLm5vZGUuY2hpbGRyZW4gPyB0cmVlTm9kZXMuZmlsdGVyKGsgPT4gay5wYXJlbnRzLmluZGV4T2Yobi5pZCkgPiAtMSAmJiBrLmlkLmluZGV4T2YoJ2dyb3VwSGVhZGVyXycpID09IC0xKS5sZW5ndGggOiAxKSB8fCAxLFxyXG4gICAgICAgICAgICAgICAgICAgIHJvd3NwYW46IChuLm5vZGUuY2hpbGRyZW4gJiYgbi5ub2RlLmNoaWxkcmVuLmxlbmd0aCA+IDApID8gMSA6IChtYXhsZXZlbCAtIG4ubGV2ZWwgKyAxKSxcclxuICAgICAgICAgICAgICAgICAgICB0aXRsZTogZGF0YS5jYXB0aW9uLFxyXG4gICAgICAgICAgICAgICAgICAgIGZpZWxkOiBkYXRhLmRhdGFGaWVsZCxcclxuICAgICAgICAgICAgICAgICAgICB3aWR0aDogKGRhdGEuc2l6ZSA/IGRhdGEuc2l6ZS53aWR0aCA6IDEwMCksXHJcbiAgICAgICAgICAgICAgICAgICAgaGFsaWduOiBkYXRhLmhhbGlnbixcclxuICAgICAgICAgICAgICAgICAgICBhbGlnbjogZGF0YS5hbGlnbixcclxuICAgICAgICAgICAgICAgICAgICBpZDogbi5pZFxyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgfSkpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHI7XHJcbiAgICB9XHJcblxyXG4gICAgb25UcmVlU2VsZWN0ZWQoJGV2ZW50KSB7XHJcbiAgICAgICAgdGhpcy5zZWxlY3RlZE5vZGUuZW1pdCgkZXZlbnQubm9kZSk7XHJcbiAgICB9XHJcblxyXG5cclxuICAgIHByaXZhdGUgY3JlYXRlTmV3R3JvdXBIZWFkZXIocm46IFJvd05vZGUsIHRpdGxlOiBzdHJpbmcsIGNoaWxkID0gZmFsc2UpIHtcclxuICAgICAgICBjb25zdCBnaGlkID0gdGhpcy5nZW5lcmF0ZUdyb3VwSGVhZGVySWQoKTtcclxuICAgICAgICBjb25zdCBkYXRhID0geyBpZDogZ2hpZCwgY2FwdGlvbjogdGl0bGUsIGdyb3VwSGVhZGVyOiB0cnVlLCBoYWxpZ246ICdsZWZ0JyB9O1xyXG4gICAgICAgIGNvbnN0IGdoID0ge1xyXG4gICAgICAgICAgICBkYXRhLFxyXG4gICAgICAgICAgICBjaGlsZHJlbjogW10sXHJcbiAgICAgICAgICAgIGV4cGFuZGVkOiB0cnVlLFxyXG4gICAgICAgICAgICB2aXNpYmxlOiB0cnVlLFxyXG4gICAgICAgICAgICBpY29uOiAnZi1pY29uIGYtaWNvbi1hZ2dyZWdhdGUtZmllbGRzJyxcclxuICAgICAgICB9O1xyXG4gICAgICAgIGlmICghY2hpbGQpIHtcclxuICAgICAgICAgICAgaWYgKCFybi5wYXJlbnQpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSB0aGlzLnRyZWVEYXRhLmZpbmRJbmRleChuID0+IG4uZGF0YS5pZCA9PT0gcm4uaWQpICsgMTtcclxuICAgICAgICAgICAgICAgIHRoaXMudHJlZURhdGEuc3BsaWNlKGksIDAsIGdoKTtcclxuICAgICAgICAgICAgICAgIHRoaXMudHJlZURhdGEgPSB0aGlzLnRyZWVEYXRhLnNsaWNlKCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnR0LmFwcGVuZENoaWxkcmVuKFtnaF0sIHJuLnBhcmVudCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLnR0LmFwcGVuZENoaWxkcmVuKFtnaF0sIHJuLm5vZGUpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIHNob3dTZWxlY3RDb2x1bW5zRGlhbG9nKG9rQ2FsbGJhY2ssIGNoaWxkcykge1xyXG4gICAgICAgIGNvbnN0IG1vZGFsUmVmID0gdGhpcy5tb2RhbFNlcnZpY2Uuc2hvdyhTZWxlY3RDb2x1bW5zQ29tcG9uZW50LCB7XHJcbiAgICAgICAgICAgIHRpdGxlOiAn6K6+572u5YiG57uE5YiXJyxcclxuICAgICAgICAgICAgd2lkdGg6IDUwMCxcclxuICAgICAgICAgICAgaGVpZ2h0OiAzMDAsXHJcbiAgICAgICAgICAgIHNob3dNYXhCdXR0b246IGZhbHNlLFxyXG4gICAgICAgICAgICByZXNpemFibGU6IGZhbHNlLFxyXG4gICAgICAgICAgICBpbml0aWFsU3RhdGU6IHtcclxuICAgICAgICAgICAgICAgIGZpZWxkczogdGhpcy5maWVsZHMsXHJcbiAgICAgICAgICAgICAgICBjaGVja2VkczogY2hpbGRzLFxyXG4gICAgICAgICAgICAgICAgZ3JvdXBFZGl0b3JSZWY6IHRoaXNcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgYnV0dG9uczogW1xyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIHRleHQ6ICfnoa7lrponLFxyXG4gICAgICAgICAgICAgICAgICAgIGNsczogJ2J0biBidG4tcHJpbWFyeScsXHJcbiAgICAgICAgICAgICAgICAgICAgaGFuZGxlOiBva0NhbGxiYWNrXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIHRleHQ6ICflj5bmtognLFxyXG4gICAgICAgICAgICAgICAgICAgIGNsczogJ2J0biBidG4tc2Vjb25kYXJ5JyxcclxuICAgICAgICAgICAgICAgICAgICBoYW5kbGU6ICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbW9kYWxSZWYuY2xvc2UoKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIF1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIG1vZGFsUmVmO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgc2hvd0RpYWxvZyhva0NhbGxiYWNrKSB7XHJcbiAgICAgICAgY29uc3QgbW9kYWxSZWYgPSB0aGlzLm1vZGFsU2VydmljZS5zaG93KEdyb3VwSGVhZGVyRm9ybUNvbXBvbmVudCwge1xyXG4gICAgICAgICAgICB0aXRsZTogJ+WIhue7hOWIl+WQjeensCcsXHJcbiAgICAgICAgICAgIHdpZHRoOiAzMDAsXHJcbiAgICAgICAgICAgIGhlaWdodDogMjAwLFxyXG4gICAgICAgICAgICBzaG93TWF4QnV0dG9uOiBmYWxzZSxcclxuICAgICAgICAgICAgcmVzaXphYmxlOiBmYWxzZSxcclxuICAgICAgICAgICAgaW5pdGlhbFN0YXRlOiB7XHJcbiAgICAgICAgICAgICAgICB0aXRsZTogJ+WIhue7hOihqOWktCdcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgYnV0dG9uczogW1xyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIHRleHQ6ICfnoa7lrponLFxyXG4gICAgICAgICAgICAgICAgICAgIGNsczogJ2J0biBidG4tcHJpbWFyeScsXHJcbiAgICAgICAgICAgICAgICAgICAgaGFuZGxlOiBva0NhbGxiYWNrXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIHRleHQ6ICflj5bmtognLFxyXG4gICAgICAgICAgICAgICAgICAgIGNsczogJ2J0biBidG4tc2Vjb25kYXJ5JyxcclxuICAgICAgICAgICAgICAgICAgICBoYW5kbGU6ICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbW9kYWxSZWYuY2xvc2UoKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIF1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIG1vZGFsUmVmO1xyXG4gICAgfVxyXG59XHJcbiJdfQ==