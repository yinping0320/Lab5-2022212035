/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
import { SelectColumnsComponent } from './group-header-select-columns.component';
import { Component, Input, ViewChild, Injector, Output, EventEmitter, ViewEncapsulation } from '@angular/core';
import { TreeTableComponent } from '@farris/ui-treetable';
import { BsModalService } from '@farris/ui-modal';
import { GroupHeaderFormComponent } from './group-header-form.component';
var HeaderGroupEditorComponent = /** @class */ (function () {
    function HeaderGroupEditorComponent(injector, modalService) {
        this.injector = injector;
        this.modalService = modalService;
        this.idField = 'id';
        this.treeData = [];
        this.selectedNode = new EventEmitter();
        // preview group columns
        this.groupCols = [];
        this.HOU_XUN_LIE_ID = '__HOU_XUN_LIE_ID__';
    }
    /**
     * @return {?}
     */
    HeaderGroupEditorComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        if (!this.treeData || !this.treeData.length) {
            this.initTreeData();
        }
        else {
            // 多表头中现存的字段ID集合
            /** @type {?} */
            var currentFieldIds_1 = this.treeData.filter((/**
             * @param {?} n
             * @return {?}
             */
            function (n) { return n.fieldRef; })).map((/**
             * @param {?} n
             * @return {?}
             */
            function (n) { return n.fieldRef; }));
            // 新增的字段
            /** @type {?} */
            var newFields = this.fields.filter((/**
             * @param {?} n
             * @return {?}
             */
            function (n) { return !currentFieldIds_1.includes(n.id); }));
            // 新增候选字段
            if (newFields && newFields.length) {
                this.treeData = this.treeData.concat(newFields.map((/**
                 * @param {?} n
                 * @return {?}
                 */
                function (n) {
                    return {
                        fieldRef: n.id,
                        parent: '__HOU_XUN_LIE_ID__',
                        level: 1
                    };
                })));
            }
            this.treeData = this.treeData.map((/**
             * @param {?} n
             * @return {?}
             */
            function (n) {
                if (n.fieldRef) {
                    /** @type {?} */
                    var f = _this.fields.find((/**
                     * @param {?} m
                     * @return {?}
                     */
                    function (m) { return m.id === n.fieldRef; }));
                    if (f) {
                        return tslib_1.__assign({}, f, { parent: n.parent });
                    }
                }
                else {
                    return n;
                }
            })).filter((/**
             * @param {?} n
             * @return {?}
             */
            function (n) { return n; }));
            this.treeData = this.convert2TreeNodes(this.treeData);
        }
        this.tt.removed.subscribe((/**
         * @param {?} rowNode
         * @return {?}
         */
        function (rowNode) {
            if (!rowNode.node.data.groupHeader) {
                /** @type {?} */
                var hxl = _this.getHxl();
                if (!rowNode.parent) {
                    _this.treeData = _this.treeData.filter((/**
                     * @param {?} n
                     * @return {?}
                     */
                    function (n) { return n.data.id !== rowNode.id; }));
                }
                _this.tt.append(rowNode.node.data, hxl.node);
            }
        }));
    };
    /**
     * @return {?}
     */
    HeaderGroupEditorComponent.prototype.initTreeData = /**
     * @return {?}
     */
    function () {
        this.treeData = [{
                data: { id: 'groupHeader_1', caption: '分组表头1', halign: 'left', groupHeader: true },
                children: this.fields.map((/**
                 * @param {?} n
                 * @param {?} i
                 * @return {?}
                 */
                function (n, i) {
                    n['index'] = i;
                    return {
                        data: n,
                        children: [],
                        visible: true
                    };
                })),
                expanded: true, visible: true
            }, {
                data: { id: this.HOU_XUN_LIE_ID, caption: '(候选列)', houxunquNode: true },
                children: [],
                expanded: true
            }];
    };
    /**
     * @return {?}
     */
    HeaderGroupEditorComponent.prototype.getHxl = /**
     * @return {?}
     */
    function () {
        return this.tt.findRowNode(this.HOU_XUN_LIE_ID);
    };
    /**
     * @param {?} $event
     * @return {?}
     */
    HeaderGroupEditorComponent.prototype.onMouseEnter = /**
     * @param {?} $event
     * @return {?}
     */
    function ($event) {
        ((/** @type {?} */ ($event.target))).querySelector('.rbtn').style.display = 'inline-block';
    };
    /**
     * @param {?} $event
     * @return {?}
     */
    HeaderGroupEditorComponent.prototype.onMouseLeave = /**
     * @param {?} $event
     * @return {?}
     */
    function ($event) {
        ((/** @type {?} */ ($event.target))).querySelector('.rbtn').style.display = 'none';
    };
    // 移除列
    // 移除列
    /**
     * @param {?} event
     * @param {?} rowData
     * @return {?}
     */
    HeaderGroupEditorComponent.prototype.removeColumn = 
    // 移除列
    /**
     * @param {?} event
     * @param {?} rowData
     * @return {?}
     */
    function (event, rowData) {
        this.tt.remove(rowData.id);
    };
    // 编辑分组列
    // 编辑分组列
    /**
     * @param {?} rowData
     * @return {?}
     */
    HeaderGroupEditorComponent.prototype.editGroupName = 
    // 编辑分组列
    /**
     * @param {?} rowData
     * @return {?}
     */
    function (rowData) {
        /** @type {?} */
        var modalRef = this.showDialog((/**
         * @return {?}
         */
        function () {
            /** @type {?} */
            var ghfRef = (/** @type {?} */ (modalRef.content));
            if (ghfRef.title) {
                rowData.caption = ghfRef.title;
                modalRef.close();
            }
            else {
                alert('请输入名称！否则点取消。');
            }
        }));
        modalRef.content.title = rowData.caption;
    };
    /**
     * @private
     * @return {?}
     */
    HeaderGroupEditorComponent.prototype.generateGroupHeaderId = /**
     * @private
     * @return {?}
     */
    function () {
        return "groupHeader_" + new Date().getTime();
    };
    // 新增分组
    // 新增分组
    /**
     * @param {?} event
     * @param {?} rn
     * @param {?=} child
     * @return {?}
     */
    HeaderGroupEditorComponent.prototype.addNewGroup = 
    // 新增分组
    /**
     * @param {?} event
     * @param {?} rn
     * @param {?=} child
     * @return {?}
     */
    function (event, rn, child) {
        var _this = this;
        if (child === void 0) { child = false; }
        /** @type {?} */
        var modalRef = this.showDialog((/**
         * @return {?}
         */
        function () {
            /** @type {?} */
            var ghfRef = (/** @type {?} */ (modalRef.content));
            if (ghfRef.title) {
                if (!rn) {
                    _this.treeData.splice(0, 0, {
                        data: {
                            id: _this.generateGroupHeaderId(), halign: 'left',
                            caption: ghfRef.title, groupHeader: true
                        },
                        icon: 'f-icon f-icon-aggregate-fields',
                        children: []
                    });
                    _this.tt.updateSerializedValue();
                }
                else {
                    _this.createNewGroupHeader(rn, ghfRef.title, child);
                }
                modalRef.close();
            }
            else {
                alert('请输入名称！否则点取消。');
            }
        }));
    };
    /**
     * @param {?} event
     * @param {?} col
     * @return {?}
     */
    HeaderGroupEditorComponent.prototype.setColumn2Group = /**
     * @param {?} event
     * @param {?} col
     * @return {?}
     */
    function (event, col) {
        /** @type {?} */
        var i = this.treeData.length - 1;
        this.treeData.splice(i, 0, { data: col, children: [] });
        /** @type {?} */
        var hxl = this.treeData.find((/**
         * @param {?} n
         * @return {?}
         */
        function (n) { return n.data.houxunquNode; }));
        hxl.children = hxl.children.filter((/**
         * @param {?} n
         * @return {?}
         */
        function (n) { return n.data.id !== col.id; }));
        this.tt.updateSerializedValue();
    };
    // 删除分组
    // 删除分组
    /**
     * @param {?} event
     * @param {?} rowNode
     * @return {?}
     */
    HeaderGroupEditorComponent.prototype.removeGroup = 
    // 删除分组
    /**
     * @param {?} event
     * @param {?} rowNode
     * @return {?}
     */
    function (event, rowNode) {
        /** @type {?} */
        var childs = this.tt.serializedValue.filter((/**
         * @param {?} n
         * @return {?}
         */
        function (n) { return n.parents.indexOf(rowNode.id) > -1 && !n.node.data.groupHeader; })).map((/**
         * @param {?} n
         * @return {?}
         */
        function (n) { return n.node; }));
        this.treeData = this.treeData.filter((/**
         * @param {?} n
         * @return {?}
         */
        function (n) { return n.data.id !== rowNode.id; }));
        this.tt.remove(rowNode.id);
        this.tt.appendChildren(childs, this.getHxl().node);
    };
    /**
     * @param {?} event
     * @param {?} rowNode
     * @return {?}
     */
    HeaderGroupEditorComponent.prototype.setColumns = /**
     * @param {?} event
     * @param {?} rowNode
     * @return {?}
     */
    function (event, rowNode) {
        var _this = this;
        /** @type {?} */
        var childs = rowNode.node.children ? rowNode.node.children.map((/**
         * @param {?} n
         * @return {?}
         */
        function (n) { return n.data; })) : [];
        /** @type {?} */
        var modalRef = this.showSelectColumnsDialog((/**
         * @return {?}
         */
        function () {
            /** @type {?} */
            var scRef = (/** @type {?} */ (modalRef.content));
            /** @type {?} */
            var needAppendNodes = scRef.checkeds;
            /** @type {?} */
            var hxl = _this.tt.findRowNode(_this.HOU_XUN_LIE_ID);
            hxl.node.children = (hxl.node.children || []).filter((/**
             * @param {?} n
             * @return {?}
             */
            function (n) { return needAppendNodes.findIndex((/**
             * @param {?} c
             * @return {?}
             */
            function (c) { return c.id === n.id; })) === -1; }));
            rowNode.node.children = rowNode.node.children || [];
            needAppendNodes = needAppendNodes.filter((/**
             * @param {?} n
             * @return {?}
             */
            function (n) { return rowNode.node.children.findIndex((/**
             * @param {?} c
             * @return {?}
             */
            function (c) { return c.id === n.id; })) === -1; }));
            if (needAppendNodes && needAppendNodes.length) {
                _this.tt.appendChildren(needAppendNodes.map((/**
                 * @param {?} n
                 * @return {?}
                 */
                function (n) {
                    return {
                        data: n,
                        children: [],
                        expanded: true
                    };
                })), rowNode.node);
                _this.tt.expandNode(rowNode.id);
            }
            if (scRef.uncheckeds && scRef.uncheckeds.length) {
                // hxl.node.children =  [];
                /** @type {?} */
                var hxlCols = scRef.uncheckeds.map((/**
                 * @param {?} n
                 * @return {?}
                 */
                function (n) {
                    return {
                        data: n,
                        children: []
                    };
                }));
                hxl.node.children = hxl.node.children.filter((/**
                 * @param {?} n
                 * @return {?}
                 */
                function (n) { return scRef.uncheckeds.findIndex((/**
                 * @param {?} c
                 * @return {?}
                 */
                function (c) { return c.id === n.id; })) === -1; }));
                _this.tt.appendChildren(hxlCols, hxl.node);
            }
            modalRef.close();
        }), childs);
    };
    /**
     * @param {?=} rowNode
     * @return {?}
     */
    HeaderGroupEditorComponent.prototype.hasGroupHeader = /**
     * @param {?=} rowNode
     * @return {?}
     */
    function (rowNode) {
        if (rowNode === void 0) { rowNode = null; }
        if (!rowNode) {
            return this.treeData.filter((/**
             * @param {?} n
             * @return {?}
             */
            function (n) { return n.groupHeader; })).length;
        }
        else {
            return rowNode.node.children.filter((/**
             * @param {?} n
             * @return {?}
             */
            function (n) { return n.data.groupHeader; })).length;
        }
    };
    /**
     * @param {?} event
     * @param {?} rowNode
     * @return {?}
     */
    HeaderGroupEditorComponent.prototype.moveUp = /**
     * @param {?} event
     * @param {?} rowNode
     * @return {?}
     */
    function (event, rowNode) {
        /** @type {?} */
        var data = this.treeData;
        if (rowNode.parent) {
            data = rowNode.parent.children;
        }
        /** @type {?} */
        var index = data.findIndex((/**
         * @param {?} n
         * @return {?}
         */
        function (n) { return n.data.id === rowNode.id; }));
        if (index !== 0) {
            /** @type {?} */
            var tempArr = data.splice(index, 1);
            data.splice.apply(data, tslib_1.__spread([index - 1, 0], tempArr));
            this.tt.updateSerializedValue();
        }
    };
    /**
     * @param {?} event
     * @param {?} rowNode
     * @return {?}
     */
    HeaderGroupEditorComponent.prototype.moveDown = /**
     * @param {?} event
     * @param {?} rowNode
     * @return {?}
     */
    function (event, rowNode) {
        /** @type {?} */
        var data = this.treeData;
        if (rowNode.parent) {
            data = rowNode.parent.children;
        }
        /** @type {?} */
        var index = data.findIndex((/**
         * @param {?} n
         * @return {?}
         */
        function (n) { return n.data.id === rowNode.id; }));
        /** @type {?} */
        var len = data.length;
        if (index !== len - 2) {
            /** @type {?} */
            var tempArr = data.splice(index, 1);
            data.splice.apply(data, tslib_1.__spread([index + 1, 0], tempArr));
            this.tt.updateSerializedValue();
        }
        else {
            this.moveBottom(event, rowNode);
        }
    };
    /**
     * @param {?} event
     * @param {?} rowNode
     * @return {?}
     */
    HeaderGroupEditorComponent.prototype.moveTop = /**
     * @param {?} event
     * @param {?} rowNode
     * @return {?}
     */
    function (event, rowNode) {
        /** @type {?} */
        var data = this.treeData;
        if (rowNode.parent) {
            data = rowNode.parent.children;
        }
        /** @type {?} */
        var index = data.findIndex((/**
         * @param {?} n
         * @return {?}
         */
        function (n) { return n.data.id === rowNode.id; }));
        data.unshift(rowNode.node);
        data.splice(index + 1, 1);
        this.tt.updateSerializedValue();
    };
    /**
     * @param {?} event
     * @param {?} rowNode
     * @return {?}
     */
    HeaderGroupEditorComponent.prototype.moveBottom = /**
     * @param {?} event
     * @param {?} rowNode
     * @return {?}
     */
    function (event, rowNode) {
        /** @type {?} */
        var data = this.treeData;
        if (rowNode.parent) {
            data = rowNode.parent.children;
        }
        /** @type {?} */
        var index = data.findIndex((/**
         * @param {?} n
         * @return {?}
         */
        function (n) { return n.data.id === rowNode.id; }));
        data.push(rowNode.node);
        data.splice(index, 1);
        if (!rowNode.parent) {
            this.moveUp(event, rowNode);
        }
        else {
            this.tt.updateSerializedValue();
        }
    };
    /** 获取候选列 */
    /**
     * 获取候选列
     * @return {?}
     */
    HeaderGroupEditorComponent.prototype.getHouXuanLie = /**
     * 获取候选列
     * @return {?}
     */
    function () {
        return this.treeData.find((/**
         * @param {?} n
         * @return {?}
         */
        function (n) { return n.data.houxunquNode; })).children;
    };
    /**
     * @return {?}
     */
    HeaderGroupEditorComponent.prototype.getAllNodes = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var hxl = this.getHouXuanLie();
        return this.tt.serializedValue.filter((/**
         * @param {?} n
         * @return {?}
         */
        function (n) {
            return !n.node.data.houxunquNode && hxl.findIndex((/**
             * @param {?} k
             * @return {?}
             */
            function (k) { return k.data.id === n.id; })) === -1;
        }));
    };
    /**
     * @private
     * @param {?} data
     * @param {?=} parentId
     * @return {?}
     */
    HeaderGroupEditorComponent.prototype.convert2TreeNodes = /**
     * @private
     * @param {?} data
     * @param {?=} parentId
     * @return {?}
     */
    function (data, parentId) {
        var _this = this;
        if (parentId === void 0) { parentId = null; }
        if (data.length) {
            /** @type {?} */
            var nodes = data.filter((/**
             * @param {?} v
             * @return {?}
             */
            function (v) { return v.parent === parentId; })).filter((/**
             * @param {?} n
             * @return {?}
             */
            function (n) { return n; }));
            return nodes.map((/**
             * @param {?} item
             * @return {?}
             */
            function (item) {
                /** @type {?} */
                var node = {
                    data: item,
                    children: [],
                    expanded: true
                };
                node.children = _this.convert2TreeNodes(data, item.id);
                if (node.data.groupHeader && node.children.length === 0) {
                    node.icon = 'f-icon f-icon-aggregate-fields';
                }
                return node;
            }));
        }
        return [];
    };
    /**
     * @private
     * @param {?} nodes
     * @return {?}
     */
    HeaderGroupEditorComponent.prototype.flatNodes = /**
     * @private
     * @param {?} nodes
     * @return {?}
     */
    function (nodes) {
        var _this = this;
        /** @type {?} */
        var r = {};
        nodes.forEach((/**
         * @param {?} e
         * @return {?}
         */
        function (e) {
            r[e.data['id']] = e.data;
            if (e.children && e.children.length) {
                r = Object.assign(r, _this.flatNodes(e.children));
            }
        }));
        return r;
    };
    /**
     * @param {?} treeNodes
     * @return {?}
     */
    HeaderGroupEditorComponent.prototype.convert2Array = /**
     * @param {?} treeNodes
     * @return {?}
     */
    function (treeNodes) {
        /** @type {?} */
        var r = [];
        /** @type {?} */
        var maxBy = (/**
         * @param {?} arr
         * @param {?} fn
         * @return {?}
         */
        function (arr, fn) { return Math.max.apply(Math, tslib_1.__spread(arr.map(typeof fn === 'function' ? fn : (/**
         * @param {?} val
         * @return {?}
         */
        function (val) { return val[fn]; })))); });
        /** @type {?} */
        var maxlevel = maxBy(treeNodes, (/**
         * @param {?} n
         * @return {?}
         */
        function (n) { return n.level; }));
        var _loop_1 = function (i) {
            r.push(treeNodes.filter((/**
             * @param {?} n
             * @return {?}
             */
            function (n) { return n.level === i; })).map((/**
             * @param {?} n
             * @return {?}
             */
            function (n) {
                /** @type {?} */
                var data = n.node.data;
                return {
                    colspan: (n.node.children ? treeNodes.filter((/**
                     * @param {?} k
                     * @return {?}
                     */
                    function (k) { return k.parents.indexOf(n.id) > -1 && k.id.indexOf('groupHeader_') == -1; })).length : 1) || 1,
                    rowspan: (n.node.children && n.node.children.length > 0) ? 1 : (maxlevel - n.level + 1),
                    title: data.caption,
                    field: data.dataField,
                    width: (data.size ? data.size.width : 100),
                    halign: data.halign,
                    align: data.align,
                    id: n.id
                };
            })));
        };
        for (var i = 0; i <= maxlevel; i++) {
            _loop_1(i);
        }
        return r;
    };
    /**
     * @param {?} $event
     * @return {?}
     */
    HeaderGroupEditorComponent.prototype.onTreeSelected = /**
     * @param {?} $event
     * @return {?}
     */
    function ($event) {
        this.selectedNode.emit($event.node);
    };
    /**
     * @private
     * @param {?} rn
     * @param {?} title
     * @param {?=} child
     * @return {?}
     */
    HeaderGroupEditorComponent.prototype.createNewGroupHeader = /**
     * @private
     * @param {?} rn
     * @param {?} title
     * @param {?=} child
     * @return {?}
     */
    function (rn, title, child) {
        if (child === void 0) { child = false; }
        /** @type {?} */
        var ghid = this.generateGroupHeaderId();
        /** @type {?} */
        var data = { id: ghid, caption: title, groupHeader: true, halign: 'left' };
        /** @type {?} */
        var gh = {
            data: data,
            children: [],
            expanded: true,
            visible: true,
            icon: 'f-icon f-icon-aggregate-fields',
        };
        if (!child) {
            if (!rn.parent) {
                /** @type {?} */
                var i = this.treeData.findIndex((/**
                 * @param {?} n
                 * @return {?}
                 */
                function (n) { return n.data.id === rn.id; })) + 1;
                this.treeData.splice(i, 0, gh);
                this.treeData = this.treeData.slice();
            }
            else {
                this.tt.appendChildren([gh], rn.parent);
            }
        }
        else {
            this.tt.appendChildren([gh], rn.node);
        }
    };
    /**
     * @private
     * @param {?} okCallback
     * @param {?} childs
     * @return {?}
     */
    HeaderGroupEditorComponent.prototype.showSelectColumnsDialog = /**
     * @private
     * @param {?} okCallback
     * @param {?} childs
     * @return {?}
     */
    function (okCallback, childs) {
        /** @type {?} */
        var modalRef = this.modalService.show(SelectColumnsComponent, {
            title: '设置分组列',
            width: 500,
            height: 300,
            showMaxButton: false,
            resizable: false,
            initialState: {
                fields: this.fields,
                checkeds: childs,
                groupEditorRef: this
            },
            buttons: [
                {
                    text: '确定',
                    cls: 'btn btn-primary',
                    handle: okCallback
                },
                {
                    text: '取消',
                    cls: 'btn btn-secondary',
                    handle: (/**
                     * @return {?}
                     */
                    function () {
                        modalRef.close();
                    })
                }
            ]
        });
        return modalRef;
    };
    /**
     * @private
     * @param {?} okCallback
     * @return {?}
     */
    HeaderGroupEditorComponent.prototype.showDialog = /**
     * @private
     * @param {?} okCallback
     * @return {?}
     */
    function (okCallback) {
        /** @type {?} */
        var modalRef = this.modalService.show(GroupHeaderFormComponent, {
            title: '分组列名称',
            width: 300,
            height: 200,
            showMaxButton: false,
            resizable: false,
            initialState: {
                title: '分组表头'
            },
            buttons: [
                {
                    text: '确定',
                    cls: 'btn btn-primary',
                    handle: okCallback
                },
                {
                    text: '取消',
                    cls: 'btn btn-secondary',
                    handle: (/**
                     * @return {?}
                     */
                    function () {
                        modalRef.close();
                    })
                }
            ]
        });
        return modalRef;
    };
    HeaderGroupEditorComponent.decorators = [
        { type: Component, args: [{
                    selector: 'header-group-editor',
                    template: "\r\n\r\n\r\n<farris-treetable #tt [data]=\"treeData\" [idField]=\"idField\" [striped]=\"false\"\r\n(nodeSelected)=\"onTreeSelected($event)\"\r\n[singleSelect]=\"true\" [showIcon]=\"true\" [showFilterBar]=\"false\" [selectOnCheck]=\"true\" [checkOnSelect]=\"true\"\r\n[collapseIcon]=\"'f-icon f-icon-file-folder-close'\" [expandIcon]=\"'f-icon f-icon-file-folder-open'\"\r\n>\r\n    <ng-template farrisTemplate=\"body\" let-rowNode let-treeNode=\"node\" let-rowData=\"rowData\" >\r\n        <tr #row=\"row\" [selectRow]=\"rowNode\" [dblclick]=\"true\" (mouseenter)=\"onMouseEnter($event)\"\r\n                [selectRowDisabled]=\"rowData['houxunquNode']\"\r\n             (mouseleave)=\"onMouseLeave($event)\">\r\n            <td style=\"border: 0;\" [style.color]=\"row.selectRowDisabled? '#a6a6a6': '#333'\" [style.height.px]=\"34\" [style.lingHeight.px]=\"34\">\r\n                <farris-treeTableToggler [rowNode]=\"rowNode\"></farris-treeTableToggler>\r\n                <span style=\"vertical-align: middle;\">{{ rowData['caption'] }}</span>\r\n                <div class=\"rbtn\" style=\" float: right;  display:none; cursor: pointer\" >\r\n                    <!-- \u81EA\u5B9A\u4E49\u8868\u5934 -->\r\n                    <ng-container  *ngIf=\"rowData['groupHeader']\">\r\n                        <move-buttons [rowNode]=\"rowNode\"></move-buttons>\r\n                        <button  class=\"btn btn-light mr-1\" style=\"padding: 2px 5px\" title=\"\u589E\u52A0\u540C\u7EA7\" (click)=\"addNewGroup($event, rowNode)\">\r\n                            <span class=\"f-icon f-icon-plus\"></span>\r\n                        </button>\r\n                        <button class=\"btn btn-light mr-1\" style=\"padding: 2px 5px\" title=\"\u589E\u52A0\u4E0B\u7EA7\" (click)=\"addNewGroup($event, rowNode, true)\">\r\n                            <span class=\"f-icon f-icon-plus-outline\"></span>\r\n                        </button>\r\n                        \r\n                        <!-- <button  class=\"btn btn-light mr-1\" style=\"padding: 2px 5px\"  (click)=\"editGroupName(rowData)\" title=\"\u4FEE\u6539\">\r\n                            <span class=\"f-icon f-icon-edit\"></span>\r\n                        </button> -->\r\n\r\n                        <button  class=\"btn btn-light mr-1\" style=\"padding: 2px 5px\" (click)=\"setColumns($event, rowNode)\" title=\"\u5217\u8BBE\u7F6E\">\r\n                            <span class=\"f-icon f-icon-table-insert\"></span>\r\n                        </button>\r\n\r\n                        <button class=\"btn btn-light\" style=\"padding: 2px 5px\" title=\"\u5220\u9664\u5206\u7EC4\" (click)=\"removeGroup($event, rowNode)\">\r\n                            <span class=\"f-icon f-icon-x\"></span>\r\n                        </button>\r\n                        \r\n                    </ng-container>\r\n\r\n                    <!-- \u6570\u636E\u5B57\u6BB5\u8868\u5934 -->\r\n                    <ng-container *ngIf=\"!rowNode.parent && !rowData['houxunquNode'] && !rowData['groupHeader']\">\r\n                        <move-buttons  [rowNode]=\"rowNode\"></move-buttons>\r\n                        <button class=\"btn btn-light\"  style=\"padding: 2px 5px\" title=\"\u5C06\u6B64\u5B57\u6BB5\u5728\u6B64\u5206\u7EC4\u4E2D\u79FB\u9664\" (click)=\"removeColumn($event, rowData)\">\r\n                            <span class=\"f-icon f-icon-x\"></span>\r\n                        </button>\r\n                    </ng-container>\r\n                    \r\n                    <!-- \u5019\u9009\u5217\u4E2D\u6309\u94AE -->\r\n                    <button title=\"\u589E\u52A0\u8868\u5934\" class=\"btn btn-light\"  style=\"padding: 2px 5px\" *ngIf=\"rowData['houxunquNode']\" (click)=\"addNewGroup($event, null)\">\r\n                        <span class=\"f-icon f-icon-plus\"></span>\r\n                    </button>\r\n\r\n                    <button class=\"btn btn-light\" title=\"\u8BBE\u4E3A\u8868\u5934\" style=\"padding: 2px 5px\" *ngIf=\"rowNode.parent && rowNode.parent.data['houxunquNode']\" (click)=\"setColumn2Group($event, rowData)\">\r\n                        <span class=\"f-icon f-icon-table-row-insert-above\"></span>\r\n                    </button>\r\n\r\n                    <!-- \u8868\u5934\u4E2D\u5B57\u6BB5\u6309\u94AE -->\r\n                    <ng-container *ngIf=\"!rowData['groupHeader'] && rowNode.parent && !rowNode.parent.data['houxunquNode']\">\r\n                        <move-buttons  [rowNode]=\"rowNode\"></move-buttons>\r\n                        <button class=\"btn btn-light\"  style=\"padding: 2px 5px\" title=\"\u5C06\u6B64\u5B57\u6BB5\u5728\u6B64\u5206\u7EC4\u4E2D\u79FB\u9664\" (click)=\"removeColumn($event, rowData)\">\r\n                            <span class=\"f-icon f-icon-x\"></span>\r\n                        </button>\r\n                    </ng-container>\r\n                </div>\r\n\r\n            </td>\r\n        </tr>\r\n    </ng-template>\r\n</farris-treetable>\r\n",
                    encapsulation: ViewEncapsulation.None,
                    styles: ["\n    .farris-treetable .farris-treetable-tbody td .treetable-toggler {\n        vertical-align: middle;\n    }\n    .farris-treetable .farris-treetable-tbody td .treenode-icon {\n        margin-right: 2px\n    }\n    "]
                }] }
    ];
    /** @nocollapse */
    HeaderGroupEditorComponent.ctorParameters = function () { return [
        { type: Injector },
        { type: BsModalService }
    ]; };
    HeaderGroupEditorComponent.propDecorators = {
        fields: [{ type: Input }],
        idField: [{ type: Input }],
        treeData: [{ type: Input }],
        tt: [{ type: ViewChild, args: ['tt',] }],
        selectedNode: [{ type: Output }]
    };
    return HeaderGroupEditorComponent;
}());
export { HeaderGroupEditorComponent };
if (false) {
    /** @type {?} */
    HeaderGroupEditorComponent.prototype.fields;
    /** @type {?} */
    HeaderGroupEditorComponent.prototype.idField;
    /** @type {?} */
    HeaderGroupEditorComponent.prototype.treeData;
    /** @type {?} */
    HeaderGroupEditorComponent.prototype.tt;
    /** @type {?} */
    HeaderGroupEditorComponent.prototype.selectedNode;
    /** @type {?} */
    HeaderGroupEditorComponent.prototype.groupCols;
    /** @type {?} */
    HeaderGroupEditorComponent.prototype.HOU_XUN_LIE_ID;
    /** @type {?} */
    HeaderGroupEditorComponent.prototype.injector;
    /**
     * @type {?}
     * @private
     */
    HeaderGroupEditorComponent.prototype.modalService;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaGVhZGVyLWdyb3VwLWVkaXRvci5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZmFycmlzL2hlYWRlci1ncm91cC1lZGl0b3IvIiwic291cmNlcyI6WyJsaWIvaGVhZGVyLWdyb3VwLWVkaXRvci5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQSxPQUFPLEVBQUUsc0JBQXNCLEVBQUUsTUFBTSx5Q0FBeUMsQ0FBQztBQUNqRixPQUFPLEVBQUUsU0FBUyxFQUFVLEtBQUssRUFBRSxTQUFTLEVBQUUsUUFBUSxFQUFFLE1BQU0sRUFBRSxZQUFZLEVBQWEsaUJBQWlCLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFDbEksT0FBTyxFQUFFLGtCQUFrQixFQUFxQixNQUFNLHNCQUFzQixDQUFDO0FBQzdFLE9BQU8sRUFBRSxjQUFjLEVBQUUsTUFBTSxrQkFBa0IsQ0FBQztBQUNsRCxPQUFPLEVBQUUsd0JBQXdCLEVBQUUsTUFBTSwrQkFBK0IsQ0FBQztBQUd6RTtJQTRCSSxvQ0FBbUIsUUFBa0IsRUFBVSxZQUE0QjtRQUF4RCxhQUFRLEdBQVIsUUFBUSxDQUFVO1FBQVUsaUJBQVksR0FBWixZQUFZLENBQWdCO1FBWmxFLFlBQU8sR0FBRyxJQUFJLENBQUM7UUFDZixhQUFRLEdBQUcsRUFBRSxDQUFDO1FBSWIsaUJBQVksR0FBRyxJQUFJLFlBQVksRUFBRSxDQUFDOztRQUc1QyxjQUFTLEdBQUcsRUFBRSxDQUFDO1FBRWYsbUJBQWMsR0FBRyxvQkFBb0IsQ0FBQztJQUd0QyxDQUFDOzs7O0lBRUQsNkNBQVE7OztJQUFSO1FBQUEsaUJBK0NDO1FBOUNHLElBQUksQ0FBQyxJQUFJLENBQUMsUUFBUSxJQUFJLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxNQUFNLEVBQUU7WUFDekMsSUFBSSxDQUFDLFlBQVksRUFBRSxDQUFDO1NBQ3ZCO2FBQU07OztnQkFFRyxpQkFBZSxHQUFHLElBQUksQ0FBQyxRQUFRLENBQUMsTUFBTTs7OztZ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UyxTQUFDO29CQUNQLFFBQVEsRUFBRSxxQkFBcUI7b0JBQy9CLG80SkFBaUQ7b0JBU2pELGFBQWEsRUFBRSxpQkFBaUIsQ0FBQyxJQUFJOzZCQVI1Qiw0TkFPUjtpQkFFSjs7OztnQkFsQjZDLFFBQVE7Z0JBRTdDLGNBQWM7Ozt5QkFtQmxCLEtBQUs7MEJBQ0wsS0FBSzsyQkFDTCxLQUFLO3FCQUVMLFNBQVMsU0FBQyxJQUFJOytCQUVkLE1BQU07O0lBMmFYLGlDQUFDO0NBQUEsQUFoY0QsSUFnY0M7U0FuYlksMEJBQTBCOzs7SUFFbkMsNENBQXVCOztJQUN2Qiw2Q0FBd0I7O0lBQ3hCLDhDQUF1Qjs7SUFFdkIsd0NBQXdDOztJQUV4QyxrREFBNEM7O0lBRzVDLCtDQUFlOztJQUVmLG9EQUFzQzs7SUFFMUIsOENBQXlCOzs7OztJQUFFLGtEQUFvQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFNlbGVjdENvbHVtbnNDb21wb25lbnQgfSBmcm9tICcuL2dyb3VwLWhlYWRlci1zZWxlY3QtY29sdW1ucy5jb21wb25lbnQnO1xyXG5pbXBvcnQgeyBDb21wb25lbnQsIE9uSW5pdCwgSW5wdXQsIFZpZXdDaGlsZCwgSW5qZWN0b3IsIE91dHB1dCwgRXZlbnRFbWl0dGVyLCBPbkNoYW5nZXMsIFZpZXdFbmNhcHN1bGF0aW9uIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IFRyZWVUYWJsZUNvbXBvbmVudCwgUm93Tm9kZSwgVHJlZU5vZGUgfSBmcm9tICdAZmFycmlzL3VpLXRyZWV0YWJsZSc7XHJcbmltcG9ydCB7IEJzTW9kYWxTZXJ2aWNlIH0gZnJvbSAnQGZhcnJpcy91aS1tb2RhbCc7XHJcbmltcG9ydCB7IEdyb3VwSGVhZGVyRm9ybUNvbXBvbmVudCB9IGZyb20gJy4vZ3JvdXAtaGVhZGVyLWZvcm0uY29tcG9uZW50JztcclxuaW1wb3J0IHsgY2xvbmVEZWVwIH0gZnJvbSAnbG9kYXNoLWVzJztcclxuXHJcbkBDb21wb25lbnQoe1xyXG4gICAgc2VsZWN0b3I6ICdoZWFkZXItZ3JvdXAtZWRpdG9yJyxcclxuICAgIHRlbXBsYXRlVXJsOiAnaGVhZGVyLWdyb3VwLWVkaXRvci5jb21wb25lbnQuaHRtbCcsXHJcbiAgICBzdHlsZXM6IFtgXHJcbiAgICAuZmFycmlzLXRyZWV0YWJsZSAuZmFycmlzLXRyZWV0YWJsZS10Ym9keSB0ZCAudHJlZXRhYmxlLXRvZ2dsZXIge1xyXG4gICAgICAgIHZlcnRpY2FsLWFsaWduOiBtaWRkbGU7XHJcbiAgICB9XHJcbiAgICAuZmFycmlzLXRyZWV0YWJsZSAuZmFycmlzLXRyZWV0YWJsZS10Ym9keSB0ZCAudHJlZW5vZGUtaWNvbiB7XHJcbiAgICAgICAgbWFyZ2luLXJpZ2h0OiAycHhcclxuICAgIH1cclxuICAgIGBdLFxyXG4gICAgZW5jYXBzdWxhdGlvbjogVmlld0VuY2Fwc3VsYXRpb24uTm9uZVxyXG59KVxyXG5leHBvcnQgY2xhc3MgSGVhZGVyR3JvdXBFZGl0b3JDb21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQge1xyXG5cclxuICAgIEBJbnB1dCgpIGZpZWxkczogYW55W107XHJcbiAgICBASW5wdXQoKSBpZEZpZWxkID0gJ2lkJztcclxuICAgIEBJbnB1dCgpIHRyZWVEYXRhID0gW107XHJcblxyXG4gICAgQFZpZXdDaGlsZCgndHQnKSB0dDogVHJlZVRhYmxlQ29tcG9uZW50O1xyXG5cclxuICAgIEBPdXRwdXQoKSBzZWxlY3RlZE5vZGUgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XHJcblxyXG4gICAgLy8gcHJldmlldyBncm91cCBjb2x1bW5zXHJcbiAgICBncm91cENvbHMgPSBbXTtcclxuXHJcbiAgICBIT1VfWFVOX0xJRV9JRCA9ICdfX0hPVV9YVU5fTElFX0lEX18nO1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKHB1YmxpYyBpbmplY3RvcjogSW5qZWN0b3IsIHByaXZhdGUgbW9kYWxTZXJ2aWNlOiBCc01vZGFsU2VydmljZSkge1xyXG4gICAgfVxyXG5cclxuICAgIG5nT25Jbml0KCkge1xyXG4gICAgICAgIGlmICghdGhpcy50cmVlRGF0YSB8fCAhdGhpcy50cmVlRGF0YS5sZW5ndGgpIHtcclxuICAgICAgICAgICAgdGhpcy5pbml0VHJlZURhdGEoKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAvLyDlpJrooajlpLTkuK3njrDlrZjnmoTlrZfmrrVJROmbhuWQiFxyXG4gICAgICAgICAgICBjb25zdCBjdXJyZW50RmllbGRJZHMgPSB0aGlzLnRyZWVEYXRhLmZpbHRlcihuID0+IG4uZmllbGRSZWYpLm1hcChuID0+IG4uZmllbGRSZWYpO1xyXG4gICAgICAgICAgICAvLyDmlrDlop7nmoTlrZfmrrVcclxuICAgICAgICAgICAgY29uc3QgbmV3RmllbGRzID0gdGhpcy5maWVsZHMuZmlsdGVyKG4gPT4gIWN1cnJlbnRGaWVsZElkcy5pbmNsdWRlcyhuLmlkKSk7XHJcbiAgICAgICAgICAgIC8vIOaWsOWinuWAmemAieWtl+autVxyXG4gICAgICAgICAgICBpZiAobmV3RmllbGRzICYmIG5ld0ZpZWxkcy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMudHJlZURhdGEgPSB0aGlzLnRyZWVEYXRhLmNvbmNhdChuZXdGaWVsZHMubWFwKG4gPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZpZWxkUmVmOiBuLmlkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwYXJlbnQ6ICdfX0hPVV9YVU5fTElFX0lEX18nLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBsZXZlbDogMVxyXG4gICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICB9KSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy50cmVlRGF0YSA9IHRoaXMudHJlZURhdGEubWFwKG4gPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKG4uZmllbGRSZWYpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBmID0gdGhpcy5maWVsZHMuZmluZChtID0+IG0uaWQgPT09IG4uZmllbGRSZWYpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChmKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuLi5mLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyZW50OiBuLnBhcmVudFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG47XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pLmZpbHRlcihuID0+IG4pO1xyXG5cclxuICAgICAgICAgICAgdGhpcy50cmVlRGF0YSA9IHRoaXMuY29udmVydDJUcmVlTm9kZXModGhpcy50cmVlRGF0YSk7XHJcbiAgICAgICAgfVxyXG5cclxuXHJcbiAgICAgICAgdGhpcy50dC5yZW1vdmVkLnN1YnNjcmliZShyb3dOb2RlID0+IHtcclxuICAgICAgICAgICAgaWYgKCFyb3dOb2RlLm5vZGUuZGF0YS5ncm91cEhlYWRlcikge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaHhsID0gdGhpcy5nZXRIeGwoKTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoIXJvd05vZGUucGFyZW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy50cmVlRGF0YSA9IHRoaXMudHJlZURhdGEuZmlsdGVyKG4gPT4gbi5kYXRhLmlkICE9PSByb3dOb2RlLmlkKTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICB0aGlzLnR0LmFwcGVuZChyb3dOb2RlLm5vZGUuZGF0YSwgaHhsLm5vZGUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgaW5pdFRyZWVEYXRhKCkge1xyXG4gICAgICAgIHRoaXMudHJlZURhdGEgPSBbe1xyXG4gICAgICAgICAgICBkYXRhOiB7IGlkOiAnZ3JvdXBIZWFkZXJfMScsIGNhcHRpb246ICfliIbnu4TooajlpLQxJywgaGFsaWduOiAnbGVmdCcsIGdyb3VwSGVhZGVyOiB0cnVlIH0sXHJcbiAgICAgICAgICAgIGNoaWxkcmVuOiB0aGlzLmZpZWxkcy5tYXAoKG4sIGkpID0+IHtcclxuICAgICAgICAgICAgICAgIG5bJ2luZGV4J10gPSBpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiBuLFxyXG4gICAgICAgICAgICAgICAgICAgIGNoaWxkcmVuOiBbXSxcclxuICAgICAgICAgICAgICAgICAgICB2aXNpYmxlOiB0cnVlXHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB9KSxcclxuICAgICAgICAgICAgZXhwYW5kZWQ6IHRydWUsIHZpc2libGU6IHRydWVcclxuICAgICAgICB9LCB7XHJcbiAgICAgICAgICAgIGRhdGE6IHsgaWQ6IHRoaXMuSE9VX1hVTl9MSUVfSUQsIGNhcHRpb246ICco5YCZ6YCJ5YiXKScsIGhvdXh1bnF1Tm9kZTogdHJ1ZSB9LFxyXG4gICAgICAgICAgICBjaGlsZHJlbjogW10sXHJcbiAgICAgICAgICAgIGV4cGFuZGVkOiB0cnVlXHJcbiAgICAgICAgfV07XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0SHhsKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnR0LmZpbmRSb3dOb2RlKHRoaXMuSE9VX1hVTl9MSUVfSUQpO1xyXG4gICAgfVxyXG5cclxuICAgIG9uTW91c2VFbnRlcigkZXZlbnQ6IE1vdXNlRXZlbnQpIHtcclxuICAgICAgICAoJGV2ZW50LnRhcmdldCBhcyBhbnkpLnF1ZXJ5U2VsZWN0b3IoJy5yYnRuJykuc3R5bGUuZGlzcGxheSA9ICdpbmxpbmUtYmxvY2snO1xyXG4gICAgfVxyXG5cclxuICAgIG9uTW91c2VMZWF2ZSgkZXZlbnQ6IE1vdXNlRXZlbnQpIHtcclxuICAgICAgICAoJGV2ZW50LnRhcmdldCBhcyBhbnkpLnF1ZXJ5U2VsZWN0b3IoJy5yYnRuJykuc3R5bGUuZGlzcGxheSA9ICdub25lJztcclxuICAgIH1cclxuXHJcblxyXG4gICAgLy8g56e76Zmk5YiXXHJcbiAgICByZW1vdmVDb2x1bW4oZXZlbnQ6IE1vdXNlRXZlbnQsIHJvd0RhdGE6IGFueSkge1xyXG4gICAgICAgIHRoaXMudHQucmVtb3ZlKHJvd0RhdGEuaWQpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIOe8lui+keWIhue7hOWIl1xyXG4gICAgZWRpdEdyb3VwTmFtZShyb3dEYXRhOiBhbnkpIHtcclxuICAgICAgIGNvbnN0IG1vZGFsUmVmID0gdGhpcy5zaG93RGlhbG9nKCgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgZ2hmUmVmID0gbW9kYWxSZWYuY29udGVudCBhcyBHcm91cEhlYWRlckZvcm1Db21wb25lbnQ7XHJcbiAgICAgICAgICAgIGlmIChnaGZSZWYudGl0bGUpIHtcclxuICAgICAgICAgICAgICAgIHJvd0RhdGEuY2FwdGlvbiA9IGdoZlJlZi50aXRsZTtcclxuICAgICAgICAgICAgICAgIG1vZGFsUmVmLmNsb3NlKCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBhbGVydCgn6K+36L6T5YWl5ZCN56ew77yB5ZCm5YiZ54K55Y+W5raI44CCJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgIH0pO1xyXG5cclxuICAgICAgIG1vZGFsUmVmLmNvbnRlbnQudGl0bGUgPSByb3dEYXRhLmNhcHRpb247XHJcbiAgICB9XHJcblxyXG5cclxuICAgIHByaXZhdGUgZ2VuZXJhdGVHcm91cEhlYWRlcklkKCkge1xyXG4gICAgICAgIHJldHVybiBgZ3JvdXBIZWFkZXJfJHtuZXcgRGF0ZSgpLmdldFRpbWUoKX1gO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIOaWsOWinuWIhue7hFxyXG4gICAgYWRkTmV3R3JvdXAoZXZlbnQ6IE1vdXNlRXZlbnQsIHJuOiBSb3dOb2RlLCBjaGlsZCA9IGZhbHNlKSB7XHJcbiAgICAgICAgY29uc3QgbW9kYWxSZWYgPSB0aGlzLnNob3dEaWFsb2coKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBnaGZSZWYgPSBtb2RhbFJlZi5jb250ZW50IGFzIEdyb3VwSGVhZGVyRm9ybUNvbXBvbmVudDtcclxuICAgICAgICAgICAgaWYgKGdoZlJlZi50aXRsZSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCFybikge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMudHJlZURhdGEuc3BsaWNlKDAsIDAsIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IHRoaXMuZ2VuZXJhdGVHcm91cEhlYWRlcklkKCksIGhhbGlnbjogJ2xlZnQnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FwdGlvbjogZ2hmUmVmLnRpdGxlLCBncm91cEhlYWRlcjogdHJ1ZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpY29uOiAnZi1pY29uIGYtaWNvbi1hZ2dyZWdhdGUtZmllbGRzJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2hpbGRyZW46IFtdXHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy50dC51cGRhdGVTZXJpYWxpemVkVmFsdWUoKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jcmVhdGVOZXdHcm91cEhlYWRlcihybiwgZ2hmUmVmLnRpdGxlLCBjaGlsZCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgbW9kYWxSZWYuY2xvc2UoKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGFsZXJ0KCfor7fovpPlhaXlkI3np7DvvIHlkKbliJnngrnlj5bmtojjgIInKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgc2V0Q29sdW1uMkdyb3VwKGV2ZW50OiBNb3VzZUV2ZW50LCBjb2wpIHtcclxuICAgICAgICBjb25zdCBpID0gdGhpcy50cmVlRGF0YS5sZW5ndGggLSAxO1xyXG4gICAgICAgIHRoaXMudHJlZURhdGEuc3BsaWNlKGksIDAsIHsgZGF0YTogY29sLCBjaGlsZHJlbjogW10gfSk7XHJcblxyXG4gICAgICAgIGNvbnN0IGh4bCA9IHRoaXMudHJlZURhdGEuZmluZChuID0+IG4uZGF0YS5ob3V4dW5xdU5vZGUpO1xyXG4gICAgICAgIGh4bC5jaGlsZHJlbiA9IGh4bC5jaGlsZHJlbi5maWx0ZXIobiA9PiBuLmRhdGEuaWQgIT09IGNvbC5pZCk7XHJcblxyXG4gICAgICAgIHRoaXMudHQudXBkYXRlU2VyaWFsaXplZFZhbHVlKCk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8g5Yig6Zmk5YiG57uEXHJcbiAgICByZW1vdmVHcm91cChldmVudDogTW91c2VFdmVudCwgcm93Tm9kZSkge1xyXG4gICAgICAgIGNvbnN0IGNoaWxkcyA9IHRoaXMudHQuc2VyaWFsaXplZFZhbHVlLmZpbHRlcihuID0+IG4ucGFyZW50cy5pbmRleE9mKHJvd05vZGUuaWQpID4gLTEgJiYgIW4ubm9kZS5kYXRhLmdyb3VwSGVhZGVyKS5tYXAobiA9PiBuLm5vZGUpO1xyXG4gICAgICAgIHRoaXMudHJlZURhdGEgPSB0aGlzLnRyZWVEYXRhLmZpbHRlcihuID0+IG4uZGF0YS5pZCAhPT0gcm93Tm9kZS5pZCk7XHJcbiAgICAgICAgdGhpcy50dC5yZW1vdmUocm93Tm9kZS5pZCk7XHJcbiAgICAgICAgdGhpcy50dC5hcHBlbmRDaGlsZHJlbihjaGlsZHMsIHRoaXMuZ2V0SHhsKCkubm9kZSk7XHJcbiAgICB9XHJcblxyXG4gICAgc2V0Q29sdW1ucyhldmVudDogTW91c2VFdmVudCwgcm93Tm9kZSkge1xyXG5cclxuICAgICAgICBjb25zdCBjaGlsZHMgPSAgcm93Tm9kZS5ub2RlLmNoaWxkcmVuID8gcm93Tm9kZS5ub2RlLmNoaWxkcmVuLm1hcChuID0+IG4uZGF0YSkgOiBbXTtcclxuXHJcbiAgICAgICAgY29uc3QgbW9kYWxSZWYgPSB0aGlzLnNob3dTZWxlY3RDb2x1bW5zRGlhbG9nKCgpID0+IHtcclxuICAgICAgICAgICAgY29uc3Qgc2NSZWYgPSBtb2RhbFJlZi5jb250ZW50IGFzIFNlbGVjdENvbHVtbnNDb21wb25lbnQ7XHJcbiAgICAgICAgICAgIGxldCBuZWVkQXBwZW5kTm9kZXMgPSBzY1JlZi5jaGVja2VkcztcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IGh4bCA9IHRoaXMudHQuZmluZFJvd05vZGUodGhpcy5IT1VfWFVOX0xJRV9JRCk7XHJcbiAgICAgICAgICAgIGh4bC5ub2RlLmNoaWxkcmVuID0gKGh4bC5ub2RlLmNoaWxkcmVuIHx8IFtdKS5maWx0ZXIobiA9PiBuZWVkQXBwZW5kTm9kZXMuZmluZEluZGV4KGMgPT4gYy5pZCA9PT0gbi5pZCkgPT09IC0xKTtcclxuXHJcbiAgICAgICAgICAgIHJvd05vZGUubm9kZS5jaGlsZHJlbiA9IHJvd05vZGUubm9kZS5jaGlsZHJlbiB8fCBbXTtcclxuICAgICAgICAgICAgbmVlZEFwcGVuZE5vZGVzID0gbmVlZEFwcGVuZE5vZGVzLmZpbHRlcihuID0+IHJvd05vZGUubm9kZS5jaGlsZHJlbi5maW5kSW5kZXgoYyA9PiBjLmlkID09PSBuLmlkKSA9PT0gLTEpO1xyXG4gICAgICAgICAgICBpZiAobmVlZEFwcGVuZE5vZGVzICYmIG5lZWRBcHBlbmROb2Rlcy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMudHQuYXBwZW5kQ2hpbGRyZW4obmVlZEFwcGVuZE5vZGVzLm1hcChuID0+IHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiBuLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjaGlsZHJlbjogW10sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGV4cGFuZGVkOiB0cnVlXHJcbiAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIH0pLCByb3dOb2RlLm5vZGUpO1xyXG5cclxuICAgICAgICAgICAgICAgIHRoaXMudHQuZXhwYW5kTm9kZShyb3dOb2RlLmlkKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuXHJcbiAgICAgICAgICAgIGlmIChzY1JlZi51bmNoZWNrZWRzICYmIHNjUmVmLnVuY2hlY2tlZHMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBoeGwubm9kZS5jaGlsZHJlbiA9ICBbXTtcclxuXHJcbiAgICAgICAgICAgICAgICBjb25zdCBoeGxDb2xzID0gc2NSZWYudW5jaGVja2Vkcy5tYXAobiA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YTogbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2hpbGRyZW46IFtdXHJcbiAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgIGh4bC5ub2RlLmNoaWxkcmVuID0gaHhsLm5vZGUuY2hpbGRyZW4uZmlsdGVyKG4gPT4gc2NSZWYudW5jaGVja2Vkcy5maW5kSW5kZXgoYyA9PiBjLmlkID09PSBuLmlkKSA9PT0gLTEpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy50dC5hcHBlbmRDaGlsZHJlbihoeGxDb2xzLCBoeGwubm9kZSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIG1vZGFsUmVmLmNsb3NlKCk7XHJcblxyXG4gICAgICAgIH0sIGNoaWxkcyk7XHJcbiAgICB9XHJcblxyXG4gICAgaGFzR3JvdXBIZWFkZXIocm93Tm9kZTogUm93Tm9kZSA9IG51bGwpIHtcclxuICAgICAgICBpZiAoIXJvd05vZGUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMudHJlZURhdGEuZmlsdGVyKG4gPT4gbi5ncm91cEhlYWRlcikubGVuZ3RoO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiByb3dOb2RlLm5vZGUuY2hpbGRyZW4uZmlsdGVyKG4gPT4gbi5kYXRhLmdyb3VwSGVhZGVyKS5sZW5ndGg7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIG1vdmVVcChldmVudDogTW91c2VFdmVudCwgcm93Tm9kZSkge1xyXG4gICAgICAgIGxldCBkYXRhID0gdGhpcy50cmVlRGF0YTtcclxuICAgICAgICBpZiAocm93Tm9kZS5wYXJlbnQpIHtcclxuICAgICAgICAgICAgZGF0YSA9IHJvd05vZGUucGFyZW50LmNoaWxkcmVuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3QgaW5kZXggPSBkYXRhLmZpbmRJbmRleChuID0+IG4uZGF0YS5pZCA9PT0gcm93Tm9kZS5pZCk7XHJcbiAgICAgICAgaWYgKGluZGV4ICE9PSAwKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHRlbXBBcnIgPSBkYXRhLnNwbGljZShpbmRleCwgMSk7XHJcbiAgICAgICAgICAgIGRhdGEuc3BsaWNlKGluZGV4IC0gMSwgMCwgLi4udGVtcEFycik7XHJcblxyXG4gICAgICAgICAgICB0aGlzLnR0LnVwZGF0ZVNlcmlhbGl6ZWRWYWx1ZSgpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBtb3ZlRG93bihldmVudDogTW91c2VFdmVudCwgcm93Tm9kZSkge1xyXG4gICAgICAgIGxldCBkYXRhID0gdGhpcy50cmVlRGF0YTtcclxuICAgICAgICBpZiAocm93Tm9kZS5wYXJlbnQpIHtcclxuICAgICAgICAgICAgZGF0YSA9IHJvd05vZGUucGFyZW50LmNoaWxkcmVuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCBpbmRleCA9IGRhdGEuZmluZEluZGV4KG4gPT4gbi5kYXRhLmlkID09PSByb3dOb2RlLmlkKTtcclxuICAgICAgICBjb25zdCBsZW4gPSBkYXRhLmxlbmd0aDtcclxuXHJcbiAgICAgICAgaWYgKGluZGV4ICE9PSBsZW4gLSAyKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHRlbXBBcnIgPSBkYXRhLnNwbGljZShpbmRleCwgMSk7XHJcbiAgICAgICAgICAgIGRhdGEuc3BsaWNlKGluZGV4ICsgMSwgMCwgLi4udGVtcEFycik7XHJcbiAgICAgICAgICAgIHRoaXMudHQudXBkYXRlU2VyaWFsaXplZFZhbHVlKCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5tb3ZlQm90dG9tKGV2ZW50LCByb3dOb2RlKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgbW92ZVRvcChldmVudDogTW91c2VFdmVudCwgcm93Tm9kZSkge1xyXG4gICAgICAgIGxldCBkYXRhID0gdGhpcy50cmVlRGF0YTtcclxuICAgICAgICBpZiAocm93Tm9kZS5wYXJlbnQpIHtcclxuICAgICAgICAgICAgZGF0YSA9IHJvd05vZGUucGFyZW50LmNoaWxkcmVuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCBpbmRleCA9IGRhdGEuZmluZEluZGV4KG4gPT4gbi5kYXRhLmlkID09PSByb3dOb2RlLmlkKTtcclxuICAgICAgICBkYXRhLnVuc2hpZnQocm93Tm9kZS5ub2RlKTtcclxuICAgICAgICBkYXRhLnNwbGljZShpbmRleCArIDEsIDEpO1xyXG4gICAgICAgIHRoaXMudHQudXBkYXRlU2VyaWFsaXplZFZhbHVlKCk7XHJcbiAgICB9XHJcblxyXG4gICAgbW92ZUJvdHRvbShldmVudDogTW91c2VFdmVudCwgcm93Tm9kZSkge1xyXG4gICAgICAgIGxldCBkYXRhID0gdGhpcy50cmVlRGF0YTtcclxuICAgICAgICBpZiAocm93Tm9kZS5wYXJlbnQpIHtcclxuICAgICAgICAgICAgZGF0YSA9IHJvd05vZGUucGFyZW50LmNoaWxkcmVuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3QgaW5kZXggPSBkYXRhLmZpbmRJbmRleChuID0+IG4uZGF0YS5pZCA9PT0gcm93Tm9kZS5pZCk7XHJcbiAgICAgICAgZGF0YS5wdXNoKHJvd05vZGUubm9kZSk7XHJcbiAgICAgICAgZGF0YS5zcGxpY2UoaW5kZXgsIDEpO1xyXG5cclxuICAgICAgICBpZiAoIXJvd05vZGUucGFyZW50KSB7XHJcbiAgICAgICAgICAgIHRoaXMubW92ZVVwKGV2ZW50LCByb3dOb2RlKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLnR0LnVwZGF0ZVNlcmlhbGl6ZWRWYWx1ZSgpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvKiog6I635Y+W5YCZ6YCJ5YiXICovXHJcbiAgICBnZXRIb3VYdWFuTGllKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnRyZWVEYXRhLmZpbmQobiA9PiBuLmRhdGEuaG91eHVucXVOb2RlKS5jaGlsZHJlbjtcclxuICAgIH1cclxuXHJcbiAgICBnZXRBbGxOb2RlcygpIHtcclxuICAgICAgICBjb25zdCBoeGwgPSB0aGlzLmdldEhvdVh1YW5MaWUoKTtcclxuICAgICAgICByZXR1cm4gdGhpcy50dC5zZXJpYWxpemVkVmFsdWUuZmlsdGVyKG4gPT4ge1xyXG4gICAgICAgICAgICByZXR1cm4gIW4ubm9kZS5kYXRhLmhvdXh1bnF1Tm9kZSAmJiBoeGwuZmluZEluZGV4KGsgPT4gay5kYXRhLmlkID09PSBuLmlkKSA9PT0gLTE7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG5cclxuICAgIHByaXZhdGUgY29udmVydDJUcmVlTm9kZXMoZGF0YTogYW55W10sIHBhcmVudElkID0gbnVsbCk6IFRyZWVOb2RlW10ge1xyXG4gICAgICAgIGlmIChkYXRhLmxlbmd0aCkge1xyXG4gICAgICAgICAgICBjb25zdCBub2RlcyA9IGRhdGEuZmlsdGVyKCh2KSA9PiB2LnBhcmVudCA9PT0gcGFyZW50SWQpLmZpbHRlcihuID0+IG4pO1xyXG4gICAgICAgICAgICByZXR1cm4gbm9kZXMubWFwKGl0ZW0gPT4ge1xyXG4gICAgICAgICAgICAgICAgY29uc3Qgbm9kZTogYW55ID0ge1xyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IGl0ZW0sXHJcbiAgICAgICAgICAgICAgICAgICAgY2hpbGRyZW46IFtdLFxyXG4gICAgICAgICAgICAgICAgICAgIGV4cGFuZGVkOiB0cnVlXHJcbiAgICAgICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgICAgIG5vZGUuY2hpbGRyZW4gPSB0aGlzLmNvbnZlcnQyVHJlZU5vZGVzKGRhdGEsIGl0ZW0uaWQpO1xyXG4gICAgICAgICAgICAgICAgaWYgKG5vZGUuZGF0YS5ncm91cEhlYWRlciAmJiBub2RlLmNoaWxkcmVuLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIG5vZGUuaWNvbiA9ICdmLWljb24gZi1pY29uLWFnZ3JlZ2F0ZS1maWVsZHMnO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5vZGU7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gW107XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBmbGF0Tm9kZXMobm9kZXMpIHtcclxuICAgICAgICBsZXQgciA9IHt9O1xyXG4gICAgICAgIG5vZGVzLmZvckVhY2goZSA9PiB7XHJcbiAgICAgICAgICAgIHJbZS5kYXRhWydpZCddXSA9IGUuZGF0YTtcclxuICAgICAgICAgICAgaWYgKGUuY2hpbGRyZW4gJiYgZS5jaGlsZHJlbi5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgIHIgPSBPYmplY3QuYXNzaWduKHIsIHRoaXMuZmxhdE5vZGVzKGUuY2hpbGRyZW4pKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiByO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnZlcnQyQXJyYXkodHJlZU5vZGVzOiBhbnlbXSkge1xyXG4gICAgICAgIGNvbnN0IHIgPSBbXTtcclxuICAgICAgICBjb25zdCBtYXhCeSA9IChhcnIsIGZuKSA9PiBNYXRoLm1heCguLi5hcnIubWFwKHR5cGVvZiBmbiA9PT0gJ2Z1bmN0aW9uJyA/IGZuIDogdmFsID0+IHZhbFtmbl0pKTtcclxuICAgICAgICBjb25zdCBtYXhsZXZlbCA9IG1heEJ5KHRyZWVOb2RlcywgKG4pID0+IG4ubGV2ZWwpIDtcclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8PSBtYXhsZXZlbDsgaSsrICkge1xyXG4gICAgICAgICAgICByLnB1c2godHJlZU5vZGVzLmZpbHRlcihuID0+IG4ubGV2ZWwgPT09IGkpLm1hcChuID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGRhdGEgPSBuLm5vZGUuZGF0YTtcclxuICAgICAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29sc3BhbjogKG4ubm9kZS5jaGlsZHJlbiA/IHRyZWVOb2Rlcy5maWx0ZXIoayA9PiBrLnBhcmVudHMuaW5kZXhPZihuLmlkKSA+IC0xICYmIGsuaWQuaW5kZXhPZignZ3JvdXBIZWFkZXJfJykgPT0gLTEpLmxlbmd0aCA6IDEpIHx8IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgcm93c3BhbjogKG4ubm9kZS5jaGlsZHJlbiAmJiBuLm5vZGUuY2hpbGRyZW4ubGVuZ3RoID4gMCkgPyAxIDogKG1heGxldmVsIC0gbi5sZXZlbCArIDEpLFxyXG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiBkYXRhLmNhcHRpb24sXHJcbiAgICAgICAgICAgICAgICAgICAgZmllbGQ6IGRhdGEuZGF0YUZpZWxkLFxyXG4gICAgICAgICAgICAgICAgICAgIHdpZHRoOiAoZGF0YS5zaXplID8gZGF0YS5zaXplLndpZHRoIDogMTAwKSxcclxuICAgICAgICAgICAgICAgICAgICBoYWxpZ246IGRhdGEuaGFsaWduLFxyXG4gICAgICAgICAgICAgICAgICAgIGFsaWduOiBkYXRhLmFsaWduLFxyXG4gICAgICAgICAgICAgICAgICAgIGlkOiBuLmlkXHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB9KSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gcjtcclxuICAgIH1cclxuXHJcbiAgICBvblRyZWVTZWxlY3RlZCgkZXZlbnQpIHtcclxuICAgICAgICB0aGlzLnNlbGVjdGVkTm9kZS5lbWl0KCRldmVudC5ub2RlKTtcclxuICAgIH1cclxuXHJcblxyXG4gICAgcHJpdmF0ZSBjcmVhdGVOZXdHcm91cEhlYWRlcihybjogUm93Tm9kZSwgdGl0bGU6IHN0cmluZywgY2hpbGQgPSBmYWxzZSkge1xyXG4gICAgICAgIGNvbnN0IGdoaWQgPSB0aGlzLmdlbmVyYXRlR3JvdXBIZWFkZXJJZCgpO1xyXG4gICAgICAgIGNvbnN0IGRhdGEgPSB7IGlkOiBnaGlkLCBjYXB0aW9uOiB0aXRsZSwgZ3JvdXBIZWFkZXI6IHRydWUsIGhhbGlnbjogJ2xlZnQnIH07XHJcbiAgICAgICAgY29uc3QgZ2ggPSB7XHJcbiAgICAgICAgICAgIGRhdGEsXHJcbiAgICAgICAgICAgIGNoaWxkcmVuOiBbXSxcclxuICAgICAgICAgICAgZXhwYW5kZWQ6IHRydWUsXHJcbiAgICAgICAgICAgIHZpc2libGU6IHRydWUsXHJcbiAgICAgICAgICAgIGljb246ICdmLWljb24gZi1pY29uLWFnZ3JlZ2F0ZS1maWVsZHMnLFxyXG4gICAgICAgIH07XHJcbiAgICAgICAgaWYgKCFjaGlsZCkge1xyXG4gICAgICAgICAgICBpZiAoIXJuLnBhcmVudCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IHRoaXMudHJlZURhdGEuZmluZEluZGV4KG4gPT4gbi5kYXRhLmlkID09PSBybi5pZCkgKyAxO1xyXG4gICAgICAgICAgICAgICAgdGhpcy50cmVlRGF0YS5zcGxpY2UoaSwgMCwgZ2gpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy50cmVlRGF0YSA9IHRoaXMudHJlZURhdGEuc2xpY2UoKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHRoaXMudHQuYXBwZW5kQ2hpbGRyZW4oW2doXSwgcm4ucGFyZW50KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMudHQuYXBwZW5kQ2hpbGRyZW4oW2doXSwgcm4ubm9kZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgc2hvd1NlbGVjdENvbHVtbnNEaWFsb2cob2tDYWxsYmFjaywgY2hpbGRzKSB7XHJcbiAgICAgICAgY29uc3QgbW9kYWxSZWYgPSB0aGlzLm1vZGFsU2VydmljZS5zaG93KFNlbGVjdENvbHVtbnNDb21wb25lbnQsIHtcclxuICAgICAgICAgICAgdGl0bGU6ICforr7nva7liIbnu4TliJcnLFxyXG4gICAgICAgICAgICB3aWR0aDogNTAwLFxyXG4gICAgICAgICAgICBoZWlnaHQ6IDMwMCxcclxuICAgICAgICAgICAgc2hvd01heEJ1dHRvbjogZmFsc2UsXHJcbiAgICAgICAgICAgIHJlc2l6YWJsZTogZmFsc2UsXHJcbiAgICAgICAgICAgIGluaXRpYWxTdGF0ZToge1xyXG4gICAgICAgICAgICAgICAgZmllbGRzOiB0aGlzLmZpZWxkcyxcclxuICAgICAgICAgICAgICAgIGNoZWNrZWRzOiBjaGlsZHMsXHJcbiAgICAgICAgICAgICAgICBncm91cEVkaXRvclJlZjogdGhpc1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBidXR0b25zOiBbXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGV4dDogJ+ehruWumicsXHJcbiAgICAgICAgICAgICAgICAgICAgY2xzOiAnYnRuIGJ0bi1wcmltYXJ5JyxcclxuICAgICAgICAgICAgICAgICAgICBoYW5kbGU6IG9rQ2FsbGJhY2tcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGV4dDogJ+WPlua2iCcsXHJcbiAgICAgICAgICAgICAgICAgICAgY2xzOiAnYnRuIGJ0bi1zZWNvbmRhcnknLFxyXG4gICAgICAgICAgICAgICAgICAgIGhhbmRsZTogKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBtb2RhbFJlZi5jbG9zZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgXVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXR1cm4gbW9kYWxSZWY7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBzaG93RGlhbG9nKG9rQ2FsbGJhY2spIHtcclxuICAgICAgICBjb25zdCBtb2RhbFJlZiA9IHRoaXMubW9kYWxTZXJ2aWNlLnNob3coR3JvdXBIZWFkZXJGb3JtQ29tcG9uZW50LCB7XHJcbiAgICAgICAgICAgIHRpdGxlOiAn5YiG57uE5YiX5ZCN56ewJyxcclxuICAgICAgICAgICAgd2lkdGg6IDMwMCxcclxuICAgICAgICAgICAgaGVpZ2h0OiAyMDAsXHJcbiAgICAgICAgICAgIHNob3dNYXhCdXR0b246IGZhbHNlLFxyXG4gICAgICAgICAgICByZXNpemFibGU6IGZhbHNlLFxyXG4gICAgICAgICAgICBpbml0aWFsU3RhdGU6IHtcclxuICAgICAgICAgICAgICAgIHRpdGxlOiAn5YiG57uE6KGo5aS0J1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBidXR0b25zOiBbXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGV4dDogJ+ehruWumicsXHJcbiAgICAgICAgICAgICAgICAgICAgY2xzOiAnYnRuIGJ0bi1wcmltYXJ5JyxcclxuICAgICAgICAgICAgICAgICAgICBoYW5kbGU6IG9rQ2FsbGJhY2tcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGV4dDogJ+WPlua2iCcsXHJcbiAgICAgICAgICAgICAgICAgICAgY2xzOiAnYnRuIGJ0bi1zZWNvbmRhcnknLFxyXG4gICAgICAgICAgICAgICAgICAgIGhhbmRsZTogKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBtb2RhbFJlZi5jbG9zZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgXVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXR1cm4gbW9kYWxSZWY7XHJcbiAgICB9XHJcbn1cclxuIl19