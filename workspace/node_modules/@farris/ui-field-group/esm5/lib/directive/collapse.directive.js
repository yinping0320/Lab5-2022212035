/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Directive, ElementRef, Renderer2, Input } from '@angular/core';
import { LocaleService } from '@farris/ui-locale';
var CollapseDirective = /** @class */ (function () {
    // fold
    /*  */
    function CollapseDirective(el, render, localeService) {
        this.el = el;
        this.render = render;
        this.localeService = localeService;
        /* 收折文本 */
        this.collapseText = '';
        /* 展开文本 */
        this.expandText = '';
        // this.collapseTemplate = collapseTemplate.templa;
    }
    /**
     * @return {?}
     */
    CollapseDirective.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        // if (!this.el.nativeElement.classList.contains('f-state-visible')) {
        //     this.render.addClass(this.el.nativeElement, 'f-state-visible');
        // }
    };
    /**
     * 当标题  收折文本变化时，视图随之变化
     * @param changeOption 变更变量集合
     */
    /**
     * 当标题  收折文本变化时，视图随之变化
     * @param {?} changeOption 变更变量集合
     * @return {?}
     */
    CollapseDirective.prototype.ngOnChanges = /**
     * 当标题  收折文本变化时，视图随之变化
     * @param {?} changeOption 变更变量集合
     * @return {?}
     */
    function (changeOption) {
        if (changeOption['title'] && this.titleDiv && this.titleText) {
            // 移除当前结构  重现渲染
            this.render.removeChild(this.titleDiv, this.titleText);
            this.titleText = this.render.createText(this.title);
            this.render.appendChild(this.titleDiv, this.titleText);
        }
        if ((changeOption['collapseText'] || changeOption['expandText']) && this.span) {
            if (this.collapse) {
                this.span.innerHTML = this.expandText;
            }
            else {
                this.span.innerHTML = this.collapseText;
            }
        }
    };
    /**
     * @return {?}
     */
    CollapseDirective.prototype.ngAfterViewInit = /**
     * @return {?}
     */
    function () {
        this.parent = this.render.parentNode(this.el.nativeElement);
        // if (this.localeService) {
        //     this.collapseText = this.localeService.getValue('collapseDirective.fold');
        //     this.expandText = this.localeService.getValue('collapseDirective.expand');
        // }
        if (!this.parent.classList.contains('f-section-formgroup')) {
            this.render.addClass(parent, 'f-section-formgroup');
        }
        this.generateLegendChildren();
        this.changeState();
        // 绑定收折事件
        this.clickEvent = this.click.bind(this);
        this.titleDiv.addEventListener('click', this.clickEvent);
        this.button.addEventListener('click', this.clickEvent);
    };
    /**
     * @param {?} e
     * @return {?}
     */
    CollapseDirective.prototype.click = /**
     * @param {?} e
     * @return {?}
     */
    function (e) {
        this.collapse = !this.collapse;
        this.changeState();
    };
    /**
     * @return {?}
     */
    CollapseDirective.prototype.changeState = /**
     * @return {?}
     */
    function () {
        if (this.collapse) {
            this.render.addClass(this.parent, 'f-state-collapse');
            // 按钮添加类
            this.render.removeClass(this.button, 'f-state-expand');
            if (this.expandText) {
                this.span.innerHTML = this.expandText;
            }
        }
        else {
            this.render.removeClass(this.parent, 'f-state-collapse');
            this.render.addClass(this.button, 'f-state-expand');
            if (this.collapseText) {
                this.span.innerHTML = this.collapseText;
            }
        }
    };
    // 生成fieldset内部元素
    // 生成fieldset内部元素
    /**
     * @return {?}
     */
    CollapseDirective.prototype.generateLegendChildren = 
    // 生成fieldset内部元素
    /**
     * @return {?}
     */
    function () {
        // 生成标题div
        this.titleDiv = this.render.createElement('div');
        this.titleText = this.render.createText(this.title);
        this.render.addClass(this.titleDiv, 'f-title');
        this.render.appendChild(this.titleDiv, this.titleText);
        // 生成header
        /** @type {?} */
        var header = this.render.createElement('div');
        this.render.addClass(header, 'f-header');
        // 生成toolbar div
        /** @type {?} */
        var toolbarDiv = this.render.createElement('div');
        this.render.addClass(toolbarDiv, 'f-toolbar');
        // 生成收折button
        this.button = this.render.createElement('button');
        this.render.addClass(this.button, 'btn');
        this.render.addClass(this.button, 'f-btn-collapse-expand');
        this.render.addClass(this.button, 'f-btn-mx');
        // 生成收折文本
        this.span = this.render.createElement('span');
        // 组合结构
        this.render.appendChild(this.button, this.span);
        this.render.appendChild(toolbarDiv, this.button);
        this.render.appendChild(header, this.titleDiv);
        this.render.appendChild(header, toolbarDiv);
        this.render.appendChild(this.el.nativeElement, header);
    };
    /**
     * @return {?}
     */
    CollapseDirective.prototype.ngOnDestroy = /**
     * @return {?}
     */
    function () {
        if (this.clickEvent) {
            this.titleDiv.removeEventListener('click', this.clickEvent);
            this.button.removeEventListener('click', this.clickEvent);
        }
    };
    CollapseDirective.decorators = [
        { type: Directive, args: [{
                    selector: '[farrisCollapse]'
                },] }
    ];
    /** @nocollapse */
    CollapseDirective.ctorParameters = function () { return [
        { type: ElementRef },
        { type: Renderer2 },
        { type: LocaleService }
    ]; };
    CollapseDirective.propDecorators = {
        title: [{ type: Input }],
        collapse: [{ type: Input }],
        collapseText: [{ type: Input }],
        expandText: [{ type: Input }]
    };
    return CollapseDirective;
}());
export { CollapseDirective };
if (false) {
    /** @type {?} */
    CollapseDirective.prototype.title;
    /** @type {?} */
    CollapseDirective.prototype.collapse;
    /** @type {?} */
    CollapseDirective.prototype.collapseText;
    /** @type {?} */
    CollapseDirective.prototype.expandText;
    /** @type {?} */
    CollapseDirective.prototype.button;
    /** @type {?} */
    CollapseDirective.prototype.span;
    /** @type {?} */
    CollapseDirective.prototype.parent;
    /** @type {?} */
    CollapseDirective.prototype.titleDiv;
    /** @type {?} */
    CollapseDirective.prototype.clickEvent;
    /** @type {?} */
    CollapseDirective.prototype.titleText;
    /**
     * @type {?}
     * @private
     */
    CollapseDirective.prototype.el;
    /**
     * @type {?}
     * @private
     */
    CollapseDirective.prototype.render;
    /**
     * @type {?}
     * @private
     */
    CollapseDirective.prototype.localeService;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29sbGFwc2UuZGlyZWN0aXZlLmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGZhcnJpcy91aS1maWVsZC1ncm91cC8iLCJzb3VyY2VzIjpbImxpYi9kaXJlY3RpdmUvY29sbGFwc2UuZGlyZWN0aXZlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7QUFBQSxPQUFPLEVBQ0gsU0FBUyxFQUFFLFVBQVUsRUFBRSxTQUFTLEVBQUUsS0FBSyxFQUUxQyxNQUFNLGVBQWUsQ0FBQztBQUN2QixPQUFPLEVBQUUsYUFBYSxFQUFFLE1BQU0sbUJBQW1CLENBQUM7QUFDbEQ7SUErQkksT0FBTztJQUNQLE1BQU07SUFDTiwyQkFDWSxFQUFjLEVBQ2QsTUFBaUIsRUFDakIsYUFBNEI7UUFGNUIsT0FBRSxHQUFGLEVBQUUsQ0FBWTtRQUNkLFdBQU0sR0FBTixNQUFNLENBQVc7UUFDakIsa0JBQWEsR0FBYixhQUFhLENBQWU7O1FBekIvQixpQkFBWSxHQUFHLEVBQUUsQ0FBQzs7UUFHbEIsZUFBVSxHQUFHLEVBQUUsQ0FBQztRQXVCckIsbURBQW1EO0lBQ3ZELENBQUM7Ozs7SUFFRCxvQ0FBUTs7O0lBQVI7UUFFSSxzRUFBc0U7UUFDdEUsc0VBQXNFO1FBRXRFLElBQUk7SUFFUixDQUFDO0lBRUQ7OztPQUdHOzs7Ozs7SUFDSCx1Q0FBVzs7Ozs7SUFBWCxVQUFZLFlBQTJCO1FBQ25DLElBQUksWUFBWSxDQUFDLE9BQU8sQ0FBQyxJQUFJLElBQUksQ0FBQyxRQUFRLElBQUksSUFBSSxDQUFDLFNBQVMsRUFBRTtZQUMxRCxlQUFlO1lBQ2YsSUFBSSxDQUFDLE1BQU0sQ0FBQyxXQUFXLENBQUMsSUFBSSxDQUFDLFFBQVEsRUFBRSxJQUFJLENBQUMsU0FBUyxDQUFDLENBQUM7WUFDdkQsSUFBSSxDQUFDLFNBQVMsR0FBRyxJQUFJLENBQUMsTUFBTSxDQUFDLFVBQVUsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUM7WUFDcEQsSUFBSSxDQUFDLE1BQU0sQ0FBQyxXQUFXLENB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ZW5kZXJlcjIsIElucHV0LCBPbkluaXQsIE9uRGVzdHJveSxcclxuICAgIEFmdGVyVmlld0luaXQsIFZpZXdDb250YWluZXJSZWYsIFZpZXdDaGlsZCwgT25DaGFuZ2VzLCBTaW1wbGVDaGFuZ2UsIFNpbXBsZUNoYW5nZXNcclxufSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgTG9jYWxlU2VydmljZSB9IGZyb20gJ0BmYXJyaXMvdWktbG9jYWxlJztcclxuQERpcmVjdGl2ZSh7XHJcbiAgICBzZWxlY3RvcjogJ1tmYXJyaXNDb2xsYXBzZV0nXHJcbn0pXHJcbmV4cG9ydCBjbGFzcyBDb2xsYXBzZURpcmVjdGl2ZSBpbXBsZW1lbnRzIE9uSW5pdCwgQWZ0ZXJWaWV3SW5pdCwgT25DaGFuZ2VzLCBPbkRlc3Ryb3kge1xyXG5cclxuICAgIC8vIEBDXHJcbiAgICBASW5wdXQoKSB0aXRsZTogc3RyaW5nO1xyXG4gICAgLyog5Yid5aeL5YyW54q25oCBICBmYWxzZeaYr+S4jeaUtuaKmCAgdHJ1ZeaYr+aUtuaKmCovXHJcbiAgICBASW5wdXQoKSBjb2xsYXBzZTogYm9vbGVhbjtcclxuXHJcbiAgICAvKiDmlLbmipjmlofmnKwgKi9cclxuICAgIEBJbnB1dCgpIGNvbGxhcHNlVGV4dCA9ICcnO1xyXG5cclxuICAgIC8qIOWxleW8gOaWh+acrCAqL1xyXG4gICAgQElucHV0KCkgZXhwYW5kVGV4dCA9ICcnO1xyXG5cclxuXHJcbiAgICAvLyBjb2xsYXBzZVRlbXBsYXRlOiBUZW1wbGF0ZVJlZjxhbnk+O1xyXG4gICAgLyogYnV0dG9uICovXHJcbiAgICBidXR0b246IEhUTUxCdXR0b25FbGVtZW50O1xyXG4gICAgLyogc3BhbiAqL1xyXG4gICAgc3BhbjogSFRNTFNwYW5FbGVtZW50O1xyXG5cclxuICAgIC8qIOaJvuWIsGNvbGxhcHNl54i25YWD57SgICovXHJcbiAgICBwYXJlbnQ6IEhUTUxFbGVtZW50O1xyXG5cclxuXHJcbiAgICB0aXRsZURpdjogYW55O1xyXG5cclxuICAgIGNsaWNrRXZlbnQ6IGFueTtcclxuICAgIHRpdGxlVGV4dDogYW55O1xyXG4gICAgLy8gZm9sZFxyXG4gICAgLyogICovXHJcbiAgICBjb25zdHJ1Y3RvcihcclxuICAgICAgICBwcml2YXRlIGVsOiBFbGVtZW50UmVmLFxyXG4gICAgICAgIHByaXZhdGUgcmVuZGVyOiBSZW5kZXJlcjIsXHJcbiAgICAgICAgcHJpdmF0ZSBsb2NhbGVTZXJ2aWNlOiBMb2NhbGVTZXJ2aWNlKSB7XHJcbiAgICAgICAgLy8gdGhpcy5jb2xsYXBzZVRlbXBsYXRlID0gY29sbGFwc2VUZW1wbGF0ZS50ZW1wbGE7XHJcbiAgICB9XHJcblxyXG4gICAgbmdPbkluaXQoKSB7XHJcblxyXG4gICAgICAgIC8vIGlmICghdGhpcy5lbC5uYXRpdmVFbGVtZW50LmNsYXNzTGlzdC5jb250YWlucygnZi1zdGF0ZS12aXNpYmxlJykpIHtcclxuICAgICAgICAvLyAgICAgdGhpcy5yZW5kZXIuYWRkQ2xhc3ModGhpcy5lbC5uYXRpdmVFbGVtZW50LCAnZi1zdGF0ZS12aXNpYmxlJyk7XHJcblxyXG4gICAgICAgIC8vIH1cclxuXHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDlvZPmoIfpopggIOaUtuaKmOaWh+acrOWPmOWMluaXtu+8jOinhuWbvumaj+S5i+WPmOWMllxyXG4gICAgICogQHBhcmFtIGNoYW5nZU9wdGlvbiDlj5jmm7Tlj5jph4/pm4blkIhcclxuICAgICAqL1xyXG4gICAgbmdPbkNoYW5nZXMoY2hhbmdlT3B0aW9uOiBTaW1wbGVDaGFuZ2VzKSB7XHJcbiAgICAgICAgaWYgKGNoYW5nZU9wdGlvblsndGl0bGUnXSAmJiB0aGlzLnRpdGxlRGl2ICYmIHRoaXMudGl0bGVUZXh0KSB7XHJcbiAgICAgICAgICAgIC8vIOenu+mZpOW9k+WJjee7k+aehCAg6YeN546w5riy5p+TXHJcbiAgICAgICAgICAgIHRoaXMucmVuZGVyLnJlbW92ZUNoaWxkKHRoaXMudGl0bGVEaXYsIHRoaXMudGl0bGVUZXh0KTtcclxuICAgICAgICAgICAgdGhpcy50aXRsZVRleHQgPSB0aGlzLnJlbmRlci5jcmVhdGVUZXh0KHRoaXMudGl0bGUpO1xyXG4gICAgICAgICAgICB0aGlzLnJlbmRlci5hcHBlbmRDaGlsZCh0aGlzLnRpdGxlRGl2LCB0aGlzLnRpdGxlVGV4dCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoKGNoYW5nZU9wdGlvblsnY29sbGFwc2VUZXh0J10gfHwgY2hhbmdlT3B0aW9uWydleHBhbmRUZXh0J10pICYmIHRoaXMuc3Bhbikge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5jb2xsYXBzZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc3Bhbi5pbm5lckhUTUwgPSB0aGlzLmV4cGFuZFRleHQ7ICAgIFxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc3Bhbi5pbm5lckhUTUwgPSB0aGlzLmNvbGxhcHNlVGV4dDsgICBcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBuZ0FmdGVyVmlld0luaXQoKSB7XHJcbiAgICAgICAgdGhpcy5wYXJlbnQgPSB0aGlzLnJlbmRlci5wYXJlbnROb2RlKHRoaXMuZWwubmF0aXZlRWxlbWVudCk7XHJcblxyXG4gICAgICAgIC8vIGlmICh0aGlzLmxvY2FsZVNlcnZpY2UpIHtcclxuICAgICAgICAvLyAgICAgdGhpcy5jb2xsYXBzZVRleHQgPSB0aGlzLmxvY2FsZVNlcnZpY2UuZ2V0VmFsdWUoJ2NvbGxhcHNlRGlyZWN0aXZlLmZvbGQnKTtcclxuICAgICAgICAvLyAgICAgdGhpcy5leHBhbmRUZXh0ID0gdGhpcy5sb2NhbGVTZXJ2aWNlLmdldFZhbHVlKCdjb2xsYXBzZURpcmVjdGl2ZS5leHBhbmQnKTtcclxuICAgICAgICAvLyB9XHJcblxyXG4gICAgICAgIGlmICghdGhpcy5wYXJlbnQuY2xhc3NMaXN0LmNvbnRhaW5zKCdmLXNlY3Rpb24tZm9ybWdyb3VwJykpIHtcclxuICAgICAgICAgICAgdGhpcy5yZW5kZXIuYWRkQ2xhc3MocGFyZW50LCAnZi1zZWN0aW9uLWZvcm1ncm91cCcpO1xyXG5cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuZ2VuZXJhdGVMZWdlbmRDaGlsZHJlbigpO1xyXG4gICAgICAgIHRoaXMuY2hhbmdlU3RhdGUoKTtcclxuICAgICAgICAvLyDnu5HlrprmlLbmipjkuovku7ZcclxuICAgICAgICB0aGlzLmNsaWNrRXZlbnQgPSB0aGlzLmNsaWNrLmJpbmQodGhpcyk7XHJcbiAgICAgICAgdGhpcy50aXRsZURpdi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuY2xpY2tFdmVudCk7XHJcbiAgICAgICAgdGhpcy5idXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLmNsaWNrRXZlbnQpO1xyXG4gICAgfVxyXG5cclxuICAgIGNsaWNrKGU6IGFueSkge1xyXG4gICAgICAgIHRoaXMuY29sbGFwc2UgPSAhdGhpcy5jb2xsYXBzZTtcclxuICAgICAgICB0aGlzLmNoYW5nZVN0YXRlKCk7XHJcbiAgICB9XHJcblxyXG5cclxuICAgIGNoYW5nZVN0YXRlKCkge1xyXG4gICAgICAgIGlmICh0aGlzLmNvbGxhcHNlKSB7XHJcbiAgICAgICAgICAgIHRoaXMucmVuZGVyLmFkZENsYXNzKHRoaXMucGFyZW50LCAnZi1zdGF0ZS1jb2xsYXBzZScpO1xyXG4gICAgICAgICAgICAvLyDmjInpkq7mt7vliqDnsbtcclxuICAgICAgICAgICAgdGhpcy5yZW5kZXIucmVtb3ZlQ2xhc3ModGhpcy5idXR0b24sICdmLXN0YXRlLWV4cGFuZCcpO1xyXG4gICAgICAgICAgICBpZih0aGlzLmV4cGFuZFRleHQpe1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zcGFuLmlubmVySFRNTCA9IHRoaXMuZXhwYW5kVGV4dDtcclxuICAgICAgICAgICAgfSAgICAgICAgICAgIFxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMucmVuZGVyLnJlbW92ZUNsYXNzKHRoaXMucGFyZW50LCAnZi1zdGF0ZS1jb2xsYXBzZScpO1xyXG4gICAgICAgICAgICB0aGlzLnJlbmRlci5hZGRDbGFzcyh0aGlzLmJ1dHRvbiwgJ2Ytc3RhdGUtZXhwYW5kJyk7XHJcbiAgICAgICAgICAgIGlmKHRoaXMuY29sbGFwc2VUZXh0KXtcclxuICAgICAgICAgICAgICAgIHRoaXMuc3Bhbi5pbm5lckhUTUwgPSB0aGlzLmNvbGxhcHNlVGV4dDtcclxuICAgICAgICAgICAgfSAgICAgICAgICAgXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuXHJcbiAgICAvLyDnlJ/miJBmaWVsZHNldOWGhemDqOWFg+e0oFxyXG4gICAgZ2VuZXJhdGVMZWdlbmRDaGlsZHJlbigpIHtcclxuICAgICAgICAvLyDnlJ/miJDmoIfpophkaXZcclxuICAgICAgICB0aGlzLnRpdGxlRGl2ID0gdGhpcy5yZW5kZXIuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICAgICAgdGhpcy50aXRsZVRleHQgPSB0aGlzLnJlbmRlci5jcmVhdGVUZXh0KHRoaXMudGl0bGUpO1xyXG4gICAgICAgIHRoaXMucmVuZGVyLmFkZENsYXNzKHRoaXMudGl0bGVEaXYsICdmLXRpdGxlJyk7XHJcbiAgICAgICAgdGhpcy5yZW5kZXIuYXBwZW5kQ2hpbGQodGhpcy50aXRsZURpdiwgdGhpcy50aXRsZVRleHQpO1xyXG5cclxuICAgICAgICAvLyDnlJ/miJBoZWFkZXJcclxuICAgICAgICBjb25zdCBoZWFkZXIgPSB0aGlzLnJlbmRlci5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgICAgICB0aGlzLnJlbmRlci5hZGRDbGFzcyhoZWFkZXIsICdmLWhlYWRlcicpO1xyXG5cclxuICAgICAgICAvLyDnlJ/miJB0b29sYmFyIGRpdlxyXG4gICAgICAgIGNvbnN0IHRvb2xiYXJEaXYgPSB0aGlzLnJlbmRlci5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgICAgICB0aGlzLnJlbmRlci5hZGRDbGFzcyh0b29sYmFyRGl2LCAnZi10b29sYmFyJyk7XHJcblxyXG4gICAgICAgIC8vIOeUn+aIkOaUtuaKmGJ1dHRvblxyXG4gICAgICAgIHRoaXMuYnV0dG9uID0gdGhpcy5yZW5kZXIuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7XHJcbiAgICAgICAgdGhpcy5yZW5kZXIuYWRkQ2xhc3ModGhpcy5idXR0b24sICdidG4nKTtcclxuICAgICAgICB0aGlzLnJlbmRlci5hZGRDbGFzcyh0aGlzLmJ1dHRvbiwgJ2YtYnRuLWNvbGxhcHNlLWV4cGFuZCcpO1xyXG4gICAgICAgIHRoaXMucmVuZGVyLmFkZENsYXNzKHRoaXMuYnV0dG9uLCAnZi1idG4tbXgnKTtcclxuICAgICAgICAvLyDnlJ/miJDmlLbmipjmlofmnKxcclxuICAgICAgICB0aGlzLnNwYW4gPSB0aGlzLnJlbmRlci5jcmVhdGVFbGVtZW50KCdzcGFuJyk7XHJcbiAgICAgICAgLy8g57uE5ZCI57uT5p6EXHJcbiAgICAgICAgdGhpcy5yZW5kZXIuYXBwZW5kQ2hpbGQodGhpcy5idXR0b24sIHRoaXMuc3Bhbik7XHJcbiAgICAgICAgdGhpcy5yZW5kZXIuYXBwZW5kQ2hpbGQodG9vbGJhckRpdiwgdGhpcy5idXR0b24pO1xyXG5cclxuICAgICAgICB0aGlzLnJlbmRlci5hcHBlbmRDaGlsZChoZWFkZXIsIHRoaXMudGl0bGVEaXYpO1xyXG4gICAgICAgIHRoaXMucmVuZGVyLmFwcGVuZENoaWxkKGhlYWRlciwgdG9vbGJhckRpdik7XHJcblxyXG4gICAgICAgIHRoaXMucmVuZGVyLmFwcGVuZENoaWxkKHRoaXMuZWwubmF0aXZlRWxlbWVudCwgaGVhZGVyKTtcclxuXHJcbiAgICB9XHJcblxyXG5cclxuICAgIG5nT25EZXN0cm95KCkge1xyXG4gICAgICAgIGlmICh0aGlzLmNsaWNrRXZlbnQpIHtcclxuICAgICAgICAgICAgdGhpcy50aXRsZURpdi5yZW1vdmVFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuY2xpY2tFdmVudCk7XHJcbiAgICAgICAgICAgIHRoaXMuYnV0dG9uLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5jbGlja0V2ZW50KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuIl19