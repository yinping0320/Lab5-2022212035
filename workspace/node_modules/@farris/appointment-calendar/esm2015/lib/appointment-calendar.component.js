/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { ChangeDetectorRef, Component, ElementRef, EventEmitter, Injector, Input, NgZone, Output, Renderer2, TemplateRef, ViewChild, ViewEncapsulation } from "@angular/core";
import { DateTimeHelperService } from "@farris/ui-common/date";
import { differenceInMinutes, isSameDay } from "date-fns";
import { AppointmentCalendarService } from "./appointment-calendar.service";
import { CommonUtils } from "@farris/ui-common";
import { ReserveDetailComponent } from "./views/detail-view.component";
import { LocaleService } from "@farris/ui-locale";
import { APPOINTMENT_CALENDAR_LOCALES } from "./appointment-locales";
import { flatten } from "lodash-es";
export class AppointmentCalendarComponent {
    /**
     * @param {?} injector
     * @param {?} cd
     * @param {?} ngZone
     * @param {?} render
     * @param {?} roomSer
     * @param {?} dateHlp
     * @param {?} elRef
     * @param {?} utils
     * @param {?} localeSer
     */
    constructor(injector, cd, ngZone, render, roomSer, dateHlp, elRef, utils, localeSer) {
        this.injector = injector;
        this.cd = cd;
        this.ngZone = ngZone;
        this.render = render;
        this.roomSer = roomSer;
        this.dateHlp = dateHlp;
        this.elRef = elRef;
        this.utils = utils;
        this.localeSer = localeSer;
        /**
         * 预定数据
         */
        this.reserveData = [];
        /**
         * 房间列表数据
         */
        this.placeItems = [];
        /**
         * 房间标识字段 默认 id
         */
        this.placeIdField = 'id';
        /**
         * 房间名称字段
         */
        this.placeNameField = 'name';
        /**
         * 预定地点全名称
         */
        this.placeFullNameField = '';
        /**
         * 预定时间字段
         */
        this.reserveInfoFields = {
            /**
             * 预订标识字段
             */
            idField: 'id',
            /**
             * 开始时间字段
             */
            startDate: 'start',
            /**
             * 结束时间字段
             */
            endDate: 'end',
            /**
             * 对应房间ID 字段
             */
            placeid: 'roomid',
            /**
             * 预订主题名称字段
             */
            title: 'title'
        };
        this.placeTitle = '名称';
        /**
         * 天视图行高， 默认 62px
         */
        this.rowHeight = 62;
        /**
         * 周视图行高，默认 85px
         */
        this.weekRowHeight = 85;
        /**
         * 周视图单元格宽度，默认 150px
         */
        this.weekCellWidth = 150;
        /**
         * 房间列宽度，默认 300px
         */
        this.placeNameWidth = 300;
        /**
         * 默认视图 day 日， week 周。 默认 day
         */
        this.viewType = 'day';
        /**
         * 日视图下开始时间
         */
        this.startTime = 7;
        /**
         * 选中预订信息ID
         */
        this.selectedId = '';
        /**
         * 详情卡片显示编辑按钮
         */
        this.showEditButton = true;
        /**
         * 详情卡片显示删除按钮
         */
        this.showDeleteButton = true;
        this.showCloseButton = true;
        /**
         * 详情卡片标题列宽度，默认 56px 显示为4个字
         */
        this.detailColumnWidth = 56;
        /**
         * 双击事件
         */
        this.itemDblClick = new EventEmitter();
        /**
         * 日视图，鼠标滑过空白单元格显示文本
         */
        this.reservationTitle = '预订';
        /**
         * 过滤事件
         */
        this.filterChange = new EventEmitter();
        /**
         * 选中事件
         */
        this.selectChange = new EventEmitter();
        /**
         * 卡片详情编辑事件
         */
        this.editHandler = new EventEmitter();
        /**
         * 卡片详情删除事件
         */
        this.removeHandler = new EventEmitter();
        /**
         * 清除选中项
         */
        this.clearSelected = new EventEmitter();
        /**
         * 日视图单元格点击事件
         */
        this.reservation = new EventEmitter();
        this.weekDays = [];
        this.groupData = [];
        this.currentDateRangeStr = '';
        this.currentDateStr = '';
        this.currentSelectItem = null;
        this.position = null;
        this.showDetail = false;
        this.detailCustomCls = null;
        this._CLICK_DELAY_ = 180;
        // 框架头高高度；
        this._frameHeaderHeight = 0;
        this.minWeekViewWidth = 0;
        this._currentScrollPos = { 'day': { x: null, y: 0 }, 'week': { x: null, y: 0 } };
        this.rowWidth = 2450;
        this.cardBtnClickSub = this.roomSer.cardBtnClick$.subscribe((/**
         * @param {?} e
         * @return {?}
         */
        (e) => {
            this.detailEventHandlers(e);
        }));
        this.localeSer.setLocaleData(APPOINTMENT_CALENDAR_LOCALES);
    }
    /**
     * @return {?}
     */
    ngOnInit() {
        this.groupData = this.mergeDate();
        this.showEditButton = !!this.editHandler.observers.length;
        this.showDeleteButton = !!this.removeHandler.observers.length;
        this.minWeekViewWidth = (this.weekCellWidth || 150) * 7 + this.placeNameWidth;
        this.rowWidth += this.placeNameWidth;
    }
    /**
     * @param {?} changes
     * @return {?}
     */
    ngOnChanges(changes) {
        if (changes.reserveData && !changes.reserveData.isFirstChange()) {
            this.dataChanged();
        }
        if (changes.placeItems && !changes.placeItems.isFirstChange()) {
            this.dataChanged();
        }
    }
    /**
     * @return {?}
     */
    ngOnDestroy() {
        if (this.cardBtnClickSub) {
            this.cardBtnClickSub.unsubscribe();
            this.cardBtnClickSub = null;
        }
    }
    /**
     * @return {?}
     */
    ngAfterViewInit() {
    }
    /**
     * @param {?} data
     * @return {?}
     */
    loadReserveData(data) {
        this.reserveData = data;
        this.dataChanged();
        this.cd.detectChanges();
    }
    /**
     * @param {?} data
     * @return {?}
     */
    loadPlaceData(data) {
        this.placeItems = data;
        this.dataChanged();
        this.cd.detectChanges();
    }
    /**
     * @private
     * @return {?}
     */
    dataChanged() {
        this.groupData = this.mergeDate();
        if (this['CALENDAR_SCROLL_POSITION']) {
            clearTimeout(this['CALENDAR_SCROLL_POSITION']);
        }
        this['CALENDAR_SCROLL_POSITION'] = setTimeout((/**
         * @return {?}
         */
        () => {
            /** @type {?} */
            const roomBodyEl = this.elRef.nativeElement.querySelector('.body');
            const { x, y } = this._currentScrollPos[this.viewType] || { x: null, y: null };
            if (roomBodyEl) {
                /** @type {?} */
                let left = x;
                if (this.viewType === 'day' && x === null) {
                    left = this.startTime * 100;
                }
                roomBodyEl.scrollLeft = left;
                roomBodyEl.scrollTop = y || 0;
                roomBodyEl.scrollTo(left, y || 0);
            }
        }), 100);
    }
    /**
     * @param {?} $event
     * @return {?}
     */
    onViewTypeChanged($event) {
        const { viewType, weekDays, dateValue, place } = $event;
        this.viewType = viewType;
        this.weekDays = weekDays;
        if (this.viewType === 'day') {
            this.currentDateStr = dateValue;
        }
        else {
            this.currentDateRangeStr = dateValue;
        }
        this.dataChanged();
        this.filterChange.emit({ viewType, dateValue, place });
        this.cd.detectChanges();
    }
    /**
     * @param {?} $event
     * @return {?}
     */
    onPlaceSelected($event) {
        // TODO: 房间切换后，客户端过滤房间列表
    }
    /**
     * @private
     * @param {?} reserves
     * @return {?}
     */
    getUsedCells(reserves) {
        if (reserves && reserves.length) {
            /** @type {?} */
            const startField = this.reserveInfoFields.startDate;
            /** @type {?} */
            const endField = this.reserveInfoFields.endDate;
            /** @type {?} */
            const cells = reserves.map((/**
             * @param {?} n
             * @return {?}
             */
            n => {
                /** @type {?} */
                const startValue = this.utils.getValue(startField, n.data);
                /** @type {?} */
                const _startTimes = this.getTimes(startValue);
                /** @type {?} */
                const endValue = this.utils.getValue(endField, n.data);
                /** @type {?} */
                const _endTimes = this.getTimes(endValue);
                /** @type {?} */
                const beginIndex = _startTimes.hour;
                /** @type {?} */
                let endIndex = _endTimes.hour - 1;
                // if (_endTimes.minute > 0) {
                //     endIndex++;
                // } else {
                //     endIndex--;
                // }
                /** @type {?} */
                var c = [];
                for (let i = beginIndex - 1; i < endIndex; i++) {
                    c.push(i + 1);
                }
                return c;
            }));
            return flatten(cells);
        }
    }
    /**
     * @private
     * @return {?}
     */
    mergeDate() {
        if (this.placeItems && this.placeItems.length) {
            if (this.viewType === 'day') {
                return this.placeItems.map((/**
                 * @param {?} n
                 * @return {?}
                 */
                n => {
                    /** @type {?} */
                    const reserves = this.reserveData.filter((/**
                     * @param {?} d
                     * @return {?}
                     */
                    d => this.utils.getValue(this.reserveInfoFields.placeid, d) === this.utils.getValue(this.placeIdField, n) &&
                        isSameDay(new Date(this.utils.getValue(this.reserveInfoFields.startDate, d)), new Date(this.currentDateStr)))).map((/**
                     * @param {?} r
                     * @return {?}
                     */
                    r => {
                        return {
                            data: r,
                            id: r[this.reserveInfoFields.idField],
                            position: this.getReservePositionInfo(r),
                        };
                    }));
                    return {
                        id: n[this.placeIdField],
                        data: n,
                        reserves,
                        disableCells: this.getUsedCells(reserves)
                    };
                }));
            }
            else {
                return this.placeItems.map((/**
                 * @param {?} n
                 * @return {?}
                 */
                n => {
                    return {
                        id: n[this.placeIdField],
                        data: n,
                        reserves: this.weekDays.map((/**
                         * @param {?} weekday
                         * @return {?}
                         */
                        (weekday) => {
                            return {
                                date: weekday,
                                items: this.reserveData.filter((/**
                                 * @param {?} d
                                 * @return {?}
                                 */
                                d => this.utils.getValue(this.reserveInfoFields.placeid, d) === this.utils.getValue(this.placeIdField, n) &&
                                    isSameDay(new Date(this.utils.getValue(this.reserveInfoFields.startDate, d)), weekday.date))).map((/**
                                 * @param {?} r
                                 * @return {?}
                                 */
                                r => {
                                    return {
                                        data: r,
                                        id: r[this.reserveInfoFields.idField],
                                    };
                                })).sort((/**
                                 * @param {?} a
                                 * @param {?} b
                                 * @return {?}
                                 */
                                (a, b) => {
                                    /** @type {?} */
                                    const r = this.dateHlp.differenceInMinutes(new Date(this.utils.getValue(this.reserveInfoFields.startDate, a.data)), new Date(this.utils.getValue(this.reserveInfoFields.endDate, b.data)));
                                    return r > 0 ? 1 : r < 0 ? -1 : 0;
                                }))
                            };
                        }))
                    };
                }));
            }
        }
        return [];
    }
    /**
     * @param {?} dateStr
     * @return {?}
     */
    getTimes(dateStr) {
        if (dateStr) {
            /** @type {?} */
            const _startDate = this.dateHlp.formatTo(dateStr, 'yyyy-MM-dd HH:mm:ss');
            if (_startDate) {
                /** @type {?} */
                const startDate = new Date(_startDate);
                /** @type {?} */
                const hour = startDate.getHours();
                /** @type {?} */
                const minute = startDate.getMinutes();
                return {
                    hour, minute, date: new Date(_startDate.split(' ')[0])
                };
            }
        }
        return null;
    }
    /**
     * @private
     * @param {?} reserveItem
     * @return {?}
     */
    getReservePositionInfo(reserveItem) {
        /** @type {?} */
        const startField = this.reserveInfoFields.startDate;
        /** @type {?} */
        const endField = this.reserveInfoFields.endDate;
        /** @type {?} */
        let left = 0;
        /** @type {?} */
        let width = 0;
        /** @type {?} */
        const startDateStr = reserveItem[startField];
        /** @type {?} */
        const endDateStr = reserveItem[endField];
        if (startDateStr) {
            /** @type {?} */
            const _startTimes = this.getTimes(startDateStr);
            if (_startTimes) {
                const { hour, minute } = _startTimes;
                left = (hour) * 100;
                if (minute) {
                    left += minute / 60 * 100;
                }
                if (endDateStr) {
                    /** @type {?} */
                    const minutes = differenceInMinutes(new Date(endDateStr), new Date(startDateStr));
                    width = minutes / 60 * 100;
                }
            }
        }
        return { left, width };
    }
    /**
     * @param {?} $event
     * @return {?}
     */
    onSelectChange($event) {
        this.selectedId = $event.item.id;
        this.currentSelectItem = { room: $event.room, data: $event.item.data };
        /** @type {?} */
        let tar = null;
        if (this.viewType === 'week') {
            tar = $event.$event.target.closest('li');
        }
        else {
            tar = $event.$event.target.closest('.item-content');
        }
        this.getPositionForDetailPanel(tar);
        if (this.detailCls) {
            this.detailCustomCls = this.detailCls($event.item);
        }
        this.showDetail = true;
        this.selectChange.emit($event);
    }
    /**
     * @param {?} $event
     * @return {?}
     */
    onItemDblClick($event) {
        this.selectedId = $event.item.id;
        this.currentSelectItem = { room: $event.room, data: $event.item.data };
        this.itemDblClick.emit($event);
    }
    /**
     * @param {?} reserveId
     * @return {?}
     */
    selectItem(reserveId) {
        this.selectedId = reserveId;
        this.cd.detectChanges();
        if (this.selectedId === null || this.selectedId === undefined || this.selectedId === '') {
            this.clearSelect();
        }
    }
    /**
     * @return {?}
     */
    clearSelect() {
        this.selectedId = null;
        this.clearSelected.emit({ ins: this });
    }
    /**
     * @private
     * @return {?}
     */
    getFrameheaderHeight() {
        if (this._frameHeaderHeight) {
            return this._frameHeaderHeight;
        }
        /** @type {?} */
        const tabset = document.querySelector('.framework-tab-origin.gw-container-tabset.tab-container');
        /** @type {?} */
        let h = 0;
        if (tabset) {
            h += tabset.offsetHeight;
        }
        /** @type {?} */
        const frameHeader = document.querySelector('.gw-header--wrapper.framework-tool-origin');
        if (frameHeader) {
            h += frameHeader.offsetHeight;
        }
        this._frameHeaderHeight = h;
        return this._frameHeaderHeight;
    }
    /**
     * @private
     * @param {?} target
     * @return {?}
     */
    getPositionForDetailPanel(target) {
        const { left, top, right, bottom, width, height } = target.getBoundingClientRect();
        /** @type {?} */
        const panelSize = { width: 368, height: 436 };
        /** @type {?} */
        let _left = left;
        /** @type {?} */
        let _top = top;
        /** @type {?} */
        const _right = window.innerWidth - right;
        /** @type {?} */
        const _bottom = window.innerHeight - bottom;
        if (_left > _right) {
            if (_left > panelSize.width) {
                _left = _left - panelSize.width;
            }
            else {
                if (window.innerWidth - left > panelSize.width) {
                    _left = left;
                }
                else {
                    if (right > panelSize.width) {
                        _left = right - panelSize.width;
                    }
                    else {
                        _left = (window.innerWidth - panelSize.width) / 2;
                    }
                }
            }
        }
        else {
            if (_right > panelSize.width) {
                _left = right;
            }
            else {
                if (right > panelSize.width) {
                    _left = left;
                }
                else {
                    _left = (window.innerWidth - panelSize.width) / 2;
                }
            }
        }
        if (_top > _bottom) {
            if (_top > panelSize.height) {
                if (left > panelSize.width || _right > panelSize.width) {
                    if (window.innerHeight - _top < height + 40) {
                        _top = window.innerHeight - panelSize.height - 20;
                    }
                    else {
                        _top = top - panelSize.height + height + 40;
                        if (_top < this.getFrameheaderHeight()) {
                            _top = this.getFrameheaderHeight() + 10;
                        }
                    }
                }
                else {
                    _top = top - panelSize.height;
                }
            }
            else {
                _top = 10 + this.getFrameheaderHeight();
            }
        }
        else {
            if (_bottom > panelSize.height) {
                if (_right > panelSize.width || left > panelSize.width) {
                    _top = bottom - height - 40;
                }
                else {
                    _top = bottom;
                }
            }
            else {
                _top = 10 + this.getFrameheaderHeight();
            }
        }
        this.position = { left: _left, top: _top };
    }
    /**
     * @return {?}
     */
    closeDetailPanel() {
        this.roomSer.cardBtnClick$.next({ action: 'close' });
    }
    /**
     * @param {?} $event
     * @return {?}
     */
    onAddNew($event) {
        this.reservation.emit($event);
    }
    /**
     * @param {?} $event
     * @param {?} typ
     * @return {?}
     */
    onScrollChange($event, typ) {
        this._currentScrollPos[this.viewType] = Object.assign({}, $event, { type: typ });
    }
    /**
     * @private
     * @param {?} e
     * @return {?}
     */
    detailEventHandlers(e) {
        const { action, item, $event } = e;
        /** @type {?} */
        let p = null;
        if (item) {
            p = { item: { data: item, id: this.utils.getValue(this.reserveInfoFields.idField, item) } };
        }
        switch (action) {
            case 'edit':
                this.editHandler.emit(p);
                break;
            case 'del':
                this.removeHandler.emit(p);
                break;
            case 'close':
                this.showDetail = false;
                break;
        }
    }
}
AppointmentCalendarComponent.decorators = [
    { type: Component, args: [{
                selector: "farris-appointment-calendar",
                template: "<div class=\"rtv-container\" resizeObserver (resize)=\"closeDetailPanel()\" [class.rtv-container-week]=\"viewType === 'week'\">\r\n    <toolbar (placeChanged)=\"onPlaceSelected($event)\" (dateChanged)=\"onViewTypeChanged($event)\" [currentViewType]=\"viewType\" [places]=\"placeItems\"></toolbar>\r\n    <div class=\"main\" style=\"position:relative\" #viewContainer>\r\n        <!-- <div style=\"border-right: 0.5px solid #0e6ded;height: 100%;position: absolute;left: 230px;width: 1px;z-index: 99;\"></div> -->\r\n\r\n        <day-view [data]=\"groupData\" class=\"h-100 d-flex flex-column\" *ngIf=\"viewType === 'day'\" [customCls]=\"dayViewCls\" [reservationTitle]=\"reservationTitle\"\r\n         (itemClick)=\"onSelectChange($event)\" (itemDblClick)=\"onItemDblClick($event)\" [selectId]=\"selectedId\" (cellClick)=\"onAddNew($event)\" (scrollChange)=\"onScrollChange($event, 'day')\"></day-view>\r\n        <week-view [data]=\"groupData\" class=\"h-100 d-flex flex-column\" *ngIf=\"viewType === 'week'\" [weekDays]=\"weekDays\" (scrollChange)=\"onScrollChange($event, 'week')\"\r\n         (itemClick)=\"onSelectChange($event)\" (itemDblClick)=\"onItemDblClick($event)\" [width]=\"viewContainer.offsetWidth < minWeekViewWidth ? minWeekViewWidth: viewContainer.offsetWidth\" [selectId]=\"selectedId\"></week-view>\r\n    </div>\r\n</div>\r\n\r\n<reserve-detail *ngIf=\"showDetail\" #detailRef\r\n    [data]=\"currentSelectItem?.data\"\r\n    [position]=\"position\"\r\n    [detailTemplate]=\"detailTemplate\"\r\n    [columns]=\"detailColumns\"\r\n    [placeInfo]=\"currentSelectItem?.room\"\r\n    [placeFieldConfigs]=\"{ name: placeNameField, fullName: placeFullNameField, id: placeIdField }\"\r\n    [fieldConfigs]=\"reserveInfoFields\"\r\n    [badgeTemplate]=\"detailBadgeTemplate\"\r\n    [customCls]=\"detailCustomCls\"\r\n    [showCloseButton]=\"showCloseButton\"\r\n    [showDeleteButton]=\"showDeleteButton\"\r\n    [showEditButton]=\"showEditButton\"\r\n    [toolbarButtons]=\"detailToolbars\"\r\n    [detailColumnWidth]=\"detailColumnWidth\"></reserve-detail>",
                // styleUrls: ['./appointment-calendar.component.css'],
                providers: [
                    AppointmentCalendarService
                ],
                encapsulation: ViewEncapsulation.None
            }] }
];
/** @nocollapse */
AppointmentCalendarComponent.ctorParameters = () => [
    { type: Injector },
    { type: ChangeDetectorRef },
    { type: NgZone },
    { type: Renderer2 },
    { type: AppointmentCalendarService },
    { type: DateTimeHelperService },
    { type: ElementRef },
    { type: CommonUtils },
    { type: LocaleService }
];
AppointmentCalendarComponent.propDecorators = {
    reserveData: [{ type: Input }],
    placeItems: [{ type: Input }],
    placeIdField: [{ type: Input }],
    placeNameField: [{ type: Input }],
    placeFullNameField: [{ type: Input }],
    reserveInfoFields: [{ type: Input }],
    roomNameFormatter: [{ type: Input }],
    placeNameTemplate: [{ type: Input }],
    contentTemplate: [{ type: Input }],
    detailTemplate: [{ type: Input }],
    detailBadgeTemplate: [{ type: Input }],
    detailCls: [{ type: Input }],
    dayViewCls: [{ type: Input }],
    placeTitle: [{ type: Input }],
    rowHeight: [{ type: Input }],
    weekRowHeight: [{ type: Input }],
    weekCellWidth: [{ type: Input }],
    placeNameWidth: [{ type: Input }],
    viewType: [{ type: Input }],
    startTime: [{ type: Input }],
    selectedId: [{ type: Input }],
    detailColumns: [{ type: Input }],
    showEditButton: [{ type: Input }],
    showDeleteButton: [{ type: Input }],
    showCloseButton: [{ type: Input }],
    detailToolbars: [{ type: Input }],
    detailColumnWidth: [{ type: Input }],
    itemDblClick: [{ type: Output }],
    reservationTitle: [{ type: Input }],
    filterChange: [{ type: Output }],
    selectChange: [{ type: Output }],
    editHandler: [{ type: Output }],
    removeHandler: [{ type: Output }],
    clearSelected: [{ type: Output }],
    reservation: [{ type: Output }],
    detailRef: [{ type: ViewChild, args: ['detailRef',] }]
};
if (false) {
    /**
     * 预定数据
     * @type {?}
     */
    AppointmentCalendarComponent.prototype.reserveData;
    /**
     * 房间列表数据
     * @type {?}
     */
    AppointmentCalendarComponent.prototype.placeItems;
    /**
     * 房间标识字段 默认 id
     * @type {?}
     */
    AppointmentCalendarComponent.prototype.placeIdField;
    /**
     * 房间名称字段
     * @type {?}
     */
    AppointmentCalendarComponent.prototype.placeNameField;
    /**
     * 预定地点全名称
     * @type {?}
     */
    AppointmentCalendarComponent.prototype.placeFullNameField;
    /**
     * 预定时间字段
     * @type {?}
     */
    AppointmentCalendarComponent.prototype.reserveInfoFields;
    /**
     * 房间名称格式化
     * @type {?}
     */
    AppointmentCalendarComponent.prototype.roomNameFormatter;
    /**
     * 房间名称自定义模板
     * @type {?}
     */
    AppointmentCalendarComponent.prototype.placeNameTemplate;
    /**
     * 预定内容模板
     * @type {?}
     */
    AppointmentCalendarComponent.prototype.contentTemplate;
    /**
     * 详情卡片模板
     * @type {?}
     */
    AppointmentCalendarComponent.prototype.detailTemplate;
    /**
     * 详情卡片徽章模板
     * @type {?}
     */
    AppointmentCalendarComponent.prototype.detailBadgeTemplate;
    /**
     * 详情卡片自定义css 类
     * @type {?}
     */
    AppointmentCalendarComponent.prototype.detailCls;
    /**
     * 日视图自定义样式类
     * @type {?}
     */
    AppointmentCalendarComponent.prototype.dayViewCls;
    /** @type {?} */
    AppointmentCalendarComponent.prototype.placeTitle;
    /**
     * 天视图行高， 默认 62px
     * @type {?}
     */
    AppointmentCalendarComponent.prototype.rowHeight;
    /**
     * 周视图行高，默认 85px
     * @type {?}
     */
    AppointmentCalendarComponent.prototype.weekRowHeight;
    /**
     * 周视图单元格宽度，默认 150px
     * @type {?}
     */
    AppointmentCalendarComponent.prototype.weekCellWidth;
    /**
     * 房间列宽度，默认 300px
     * @type {?}
     */
    AppointmentCalendarComponent.prototype.placeNameWidth;
    /**
     * 默认视图 day 日， week 周。 默认 day
     * @type {?}
     */
    AppointmentCalendarComponent.prototype.viewType;
    /**
     * 日视图下开始时间
     * @type {?}
     */
    AppointmentCalendarComponent.prototype.startTime;
    /**
     * 选中预订信息ID
     * @type {?}
     */
    AppointmentCalendarComponent.prototype.selectedId;
    /**
     * 详情卡片列信息
     * @type {?}
     */
    AppointmentCalendarComponent.prototype.detailColumns;
    /**
     * 详情卡片显示编辑按钮
     * @type {?}
     */
    AppointmentCalendarComponent.prototype.showEditButton;
    /**
     * 详情卡片显示删除按钮
     * @type {?}
     */
    AppointmentCalendarComponent.prototype.showDeleteButton;
    /** @type {?} */
    AppointmentCalendarComponent.prototype.showCloseButton;
    /**
     * 详情卡片按钮配置
     * @type {?}
     */
    AppointmentCalendarComponent.prototype.detailToolbars;
    /**
     * 详情卡片标题列宽度，默认 56px 显示为4个字
     * @type {?}
     */
    AppointmentCalendarComponent.prototype.detailColumnWidth;
    /**
     * 双击事件
     * @type {?}
     */
    AppointmentCalendarComponent.prototype.itemDblClick;
    /**
     * 日视图，鼠标滑过空白单元格显示文本
     * @type {?}
     */
    AppointmentCalendarComponent.prototype.reservationTitle;
    /**
     * 过滤事件
     * @type {?}
     */
    AppointmentCalendarComponent.prototype.filterChange;
    /**
     * 选中事件
     * @type {?}
     */
    AppointmentCalendarComponent.prototype.selectChange;
    /**
     * 卡片详情编辑事件
     * @type {?}
     */
    AppointmentCalendarComponent.prototype.editHandler;
    /**
     * 卡片详情删除事件
     * @type {?}
     */
    AppointmentCalendarComponent.prototype.removeHandler;
    /**
     * 清除选中项
     * @type {?}
     */
    AppointmentCalendarComponent.prototype.clearSelected;
    /**
     * 日视图单元格点击事件
     * @type {?}
     */
    AppointmentCalendarComponent.prototype.reservation;
    /** @type {?} */
    AppointmentCalendarComponent.prototype.detailRef;
    /** @type {?} */
    AppointmentCalendarComponent.prototype.weekDays;
    /** @type {?} */
    AppointmentCalendarComponent.prototype.groupData;
    /**
     * @type {?}
     * @private
     */
    AppointmentCalendarComponent.prototype.currentDateRangeStr;
    /**
     * @type {?}
     * @private
     */
    AppointmentCalendarComponent.prototype.currentDateStr;
    /** @type {?} */
    AppointmentCalendarComponent.prototype.currentSelectItem;
    /** @type {?} */
    AppointmentCalendarComponent.prototype.position;
    /** @type {?} */
    AppointmentCalendarComponent.prototype.showDetail;
    /** @type {?} */
    AppointmentCalendarComponent.prototype.detailCustomCls;
    /** @type {?} */
    AppointmentCalendarComponent.prototype._CLICK_DELAY_;
    /** @type {?} */
    AppointmentCalendarComponent.prototype._frameHeaderHeight;
    /** @type {?} */
    AppointmentCalendarComponent.prototype.minWeekViewWidth;
    /**
     * @type {?}
     * @private
     */
    AppointmentCalendarComponent.prototype._currentScrollPos;
    /** @type {?} */
    AppointmentCalendarComponent.prototype.rowWidth;
    /**
     * @type {?}
     * @private
     */
    AppointmentCalendarComponent.prototype.cardBtnClickSub;
    /**
     * @type {?}
     * @private
     */
    AppointmentCalendarComponent.prototype.injector;
    /**
     * @type {?}
     * @private
     */
    AppointmentCalendarComponent.prototype.cd;
    /**
     * @type {?}
     * @private
     */
    AppointmentCalendarComponent.prototype.ngZone;
    /**
     * @type {?}
     * @private
     */
    AppointmentCalendarComponent.prototype.render;
    /** @type {?} */
    AppointmentCalendarComponent.prototype.roomSer;
    /**
     * @type {?}
     * @private
     */
    AppointmentCalendarComponent.prototype.dateHlp;
    /**
     * @type {?}
     * @private
     */
    AppointmentCalendarComponent.prototype.elRef;
    /** @type {?} */
    AppointmentCalendarComponent.prototype.utils;
    /**
     * @type {?}
     * @private
     */
    AppointmentCalendarComponent.prototype.localeSer;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXBwb2ludG1lbnQtY2FsZW5kYXIuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGZhcnJpcy9hcHBvaW50bWVudC1jYWxlbmRhci8iLCJzb3VyY2VzIjpbImxpYi9hcHBvaW50bWVudC1jYWxlbmRhci5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUFBLE9BQU8sRUFBaUIsaUJBQWlCLEVBQUUsU0FBUyxFQUFFLFVBQVUsRUFBRSxZQUFZLEVBQUUsUUFBUSxFQUFFLEtBQUssRUFBRSxNQUFNLEVBQWdDLE1BQU0sRUFBRSxTQUFTLEVBQStCLFdBQVcsRUFBRSxTQUFTLEVBQUUsaUJBQWlCLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFDeFAsT0FBTyxFQUFFLHFCQUFxQixFQUFFLE1BQU0sd0JBQXdCLENBQUM7QUFDL0QsT0FBTyxFQUFFLG1CQUFtQixFQUFFLFNBQVMsRUFBRSxNQUFNLFVBQVUsQ0FBQztBQUUxRCxPQUFPLEVBQUUsMEJBQTBCLEVBQUUsTUFBTSxnQ0FBZ0MsQ0FBQztBQUM1RSxPQUFPLEVBQUUsV0FBVyxFQUFFLE1BQU0sbUJBQW1CLENBQUM7QUFFaEQsT0FBTyxFQUFFLHNCQUFzQixFQUFFLE1BQU0sK0JBQStCLENBQUM7QUFDdkUsT0FBTyxFQUFFLGFBQWEsRUFBRSxNQUFNLG1CQUFtQixDQUFDO0FBQ2xELE9BQU8sRUFBRSw0QkFBNEIsRUFBRSxNQUFNLHVCQUF1QixDQUFDO0FBQ3JFLE9BQU8sRUFBRSxPQUFPLEVBQUUsTUFBTSxXQUFXLENBQUM7QUFZcEMsTUFBTSxPQUFPLDRCQUE0Qjs7Ozs7Ozs7Ozs7O0lBbUhyQyxZQUFvQixRQUFrQixFQUFVLEVBQXFCLEVBQVUsTUFBYyxFQUFVLE1BQWlCLEVBQVMsT0FBbUMsRUFDcEosT0FBOEIsRUFBVSxLQUFpQixFQUFTLEtBQWtCLEVBQVUsU0FBd0I7UUFEbEgsYUFBUSxHQUFSLFFBQVEsQ0FBVTtRQUFVLE9BQUUsR0FBRixFQUFFLENBQW1CO1FBQVUs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QUUsNkNBQXlCOztJQUFFLDZDQUF5Qjs7Ozs7SUFBRSxpREFBZ0MiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBZnRlclZpZXdJbml0LCBDaGFuZ2VEZXRlY3RvclJlZiwgQ29tcG9uZW50LCBFbGVtZW50UmVmLCBFdmVudEVtaXR0ZXIsIEluamVjdG9yLCBJbnB1dCwgTmdab25lLCBPbkNoYW5nZXMsIE9uRGVzdHJveSwgT25Jbml0LCBPdXRwdXQsIFJlbmRlcmVyMiwgU2ltcGxlQ2hhbmdlLCBTaW1wbGVDaGFuZ2VzLCBUZW1wbGF0ZVJlZiwgVmlld0NoaWxkLCBWaWV3RW5jYXBzdWxhdGlvbiB9IGZyb20gXCJAYW5ndWxhci9jb3JlXCI7XHJcbmltcG9ydCB7IERhdGVUaW1lSGVscGVyU2VydmljZSB9IGZyb20gXCJAZmFycmlzL3VpLWNvbW1vbi9kYXRlXCI7XHJcbmltcG9ydCB7IGRpZmZlcmVuY2VJbk1pbnV0ZXMsIGlzU2FtZURheSB9IGZyb20gXCJkYXRlLWZuc1wiO1xyXG5pbXBvcnQgeyBDYWxlbmRhclZpZXdUeXBlLCBBcHBvaW50bWVudERhdGEsIFZpZXdUeXBlQ2hhbmdlZFBhcmFtLCBXZWVrRGF5SXRlbSwgRGV0YWlsQ29sdW1uLCBEZXRhaWxUb29sYmFyQnV0dG9uIH0gZnJvbSBcIi4vbW9kZWxzL2NhbGVuZGF5LnR5cGVzXCI7XHJcbmltcG9ydCB7IEFwcG9pbnRtZW50Q2FsZW5kYXJTZXJ2aWNlIH0gZnJvbSBcIi4vYXBwb2ludG1lbnQtY2FsZW5kYXIuc2VydmljZVwiO1xyXG5pbXBvcnQgeyBDb21tb25VdGlscyB9IGZyb20gXCJAZmFycmlzL3VpLWNvbW1vblwiO1xyXG5pbXBvcnQgeyBTdWJzY3JpcHRpb24gfSBmcm9tIFwicnhqc1wiO1xyXG5pbXBvcnQgeyBSZXNlcnZlRGV0YWlsQ29tcG9uZW50IH0gZnJvbSBcIi4vdmlld3MvZGV0YWlsLXZpZXcuY29tcG9uZW50XCI7XHJcbmltcG9ydCB7IExvY2FsZVNlcnZpY2UgfSBmcm9tIFwiQGZhcnJpcy91aS1sb2NhbGVcIjtcclxuaW1wb3J0IHsgQVBQT0lOVE1FTlRfQ0FMRU5EQVJfTE9DQUxFUyB9IGZyb20gXCIuL2FwcG9pbnRtZW50LWxvY2FsZXNcIjtcclxuaW1wb3J0IHsgZmxhdHRlbiB9IGZyb20gXCJsb2Rhc2gtZXNcIjtcclxuXHJcblxyXG5AQ29tcG9uZW50KHtcclxuICAgIHNlbGVjdG9yOiBcImZhcnJpcy1hcHBvaW50bWVudC1jYWxlbmRhclwiLFxyXG4gICAgdGVtcGxhdGVVcmw6ICcuL2FwcG9pbnRtZW50LWNhbGVuZGFyLmNvbXBvbmVudC5odG1sJyxcclxuICAgIC8vIHN0eWxlVXJsczogWycuL2FwcG9pbnRtZW50LWNhbGVuZGFyLmNvbXBvbmVudC5jc3MnXSxcclxuICAgIHByb3ZpZGVyczogW1xyXG4gICAgICAgIEFwcG9pbnRtZW50Q2FsZW5kYXJTZXJ2aWNlXHJcbiAgICBdLFxyXG4gICAgZW5jYXBzdWxhdGlvbjogVmlld0VuY2Fwc3VsYXRpb24uTm9uZVxyXG59KVxyXG5leHBvcnQgY2xhc3MgQXBwb2ludG1lbnRDYWxlbmRhckNvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCwgQWZ0ZXJWaWV3SW5pdCwgT25EZXN0cm95LCBPbkNoYW5nZXMge1xyXG5cclxuICAgIC8qKiDpooTlrprmlbDmja4gKi9cclxuICAgIEBJbnB1dCgpIHJlc2VydmVEYXRhID0gW107XHJcbiAgICAvKiog5oi/6Ze05YiX6KGo5pWw5o2uICovXHJcbiAgICBASW5wdXQoKSBwbGFjZUl0ZW1zID0gW107XHJcblxyXG4gICAgLyoqIOaIv+mXtOagh+ivhuWtl+autSDpu5jorqQgaWQgKi9cclxuICAgIEBJbnB1dCgpIHBsYWNlSWRGaWVsZCA9ICdpZCc7XHJcbiAgICAvKiog5oi/6Ze05ZCN56ew5a2X5q61ICovXHJcbiAgICBASW5wdXQoKSBwbGFjZU5hbWVGaWVsZCA9ICduYW1lJztcclxuICAgIC8qKiDpooTlrprlnLDngrnlhajlkI3np7AgKi9cclxuICAgIEBJbnB1dCgpIHBsYWNlRnVsbE5hbWVGaWVsZCA9ICcnO1xyXG5cclxuICAgIC8qKiDpooTlrprml7bpl7TlrZfmrrUgKi9cclxuICAgIEBJbnB1dCgpIHJlc2VydmVJbmZvRmllbGRzID0ge1xyXG4gICAgICAgIC8qKiDpooTorqLmoIfor4blrZfmrrUgKi9cclxuICAgICAgICBpZEZpZWxkOiAnaWQnLFxyXG4gICAgICAgIC8qKiDlvIDlp4vml7bpl7TlrZfmrrUgKi9cclxuICAgICAgICBzdGFydERhdGU6ICdzdGFydCcsXHJcbiAgICAgICAgLyoqIOe7k+adn+aXtumXtOWtl+autSAqL1xyXG4gICAgICAgIGVuZERhdGU6ICdlbmQnLFxyXG4gICAgICAgIC8qKiDlr7nlupTmiL/pl7RJRCDlrZfmrrUgKi9cclxuICAgICAgICBwbGFjZWlkOiAncm9vbWlkJyxcclxuICAgICAgICAvKiog6aKE6K6i5Li76aKY5ZCN56ew5a2X5q61ICovXHJcbiAgICAgICAgdGl0bGU6ICd0aXRsZSdcclxuICAgIH1cclxuXHJcbiAgICAvKiog5oi/6Ze05ZCN56ew5qC85byP5YyWICovXHJcbiAgICBASW5wdXQoKSByb29tTmFtZUZvcm1hdHRlcjogKGl0ZW0pID0+IHN0cmluZztcclxuICAgIC8qKiDmiL/pl7TlkI3np7Doh6rlrprkuYnmqKHmnb8gKi9cclxuICAgIEBJbnB1dCgpIHBsYWNlTmFtZVRlbXBsYXRlOiBUZW1wbGF0ZVJlZjxhbnk+O1xyXG4gICAgLyoqIOmihOWumuWGheWuueaooeadvyAqL1xyXG4gICAgQElucHV0KCkgY29udGVudFRlbXBsYXRlOiBUZW1wbGF0ZVJlZjxhbnk+O1xyXG4gICAgLyoqIOivpuaDheWNoeeJh+aooeadvyAqL1xyXG4gICAgQElucHV0KCkgZGV0YWlsVGVtcGxhdGU6IFRlbXBsYXRlUmVmPGFueT47XHJcbiAgICAvKiog6K+m5oOF5Y2h54mH5b6956ug5qih5p2/ICovXHJcbiAgICBASW5wdXQoKSBkZXRhaWxCYWRnZVRlbXBsYXRlOiBUZW1wbGF0ZVJlZjxhbnk+O1xyXG4gICAgLyoqIOivpuaDheWNoeeJh+iHquWumuS5iWNzcyDnsbsgKi9cclxuICAgIEBJbnB1dCgpIGRldGFpbENsczogICh7aXRlbX0pID0+IHsgY2xzOiB7IFtjbGFzc05hbWU6IHN0cmluZ106IGJvb2xlYW59LCBzdHlsZXM6IHsgW2tleTogc3RyaW5nXTogYW55IH19O1xyXG4gICAgLyoqIOaXpeinhuWbvuiHquWumuS5ieagt+W8j+exuyAqL1xyXG4gICAgQElucHV0KCkgZGF5Vmlld0NsczogKHtpdGVtfSkgPT4geyBjbHM6IHsgW2NsYXNzTmFtZTogc3RyaW5nXTogYm9vbGVhbn0sIHN0eWxlczogeyBba2V5OiBzdHJpbmddOiBhbnkgfX07XHJcblxyXG4gICAgQElucHV0KCkgcGxhY2VUaXRsZSA9ICflkI3np7AnO1xyXG5cclxuICAgIC8qKiDlpKnop4blm77ooYzpq5jvvIwg6buY6K6kIDYycHggKi9cclxuICAgIEBJbnB1dCgpIHJvd0hlaWdodCA9IDYyO1xyXG4gICAgLyoqIOWRqOinhuWbvuihjOmrmO+8jOm7mOiupCA4NXB4ICovXHJcbiAgICBASW5wdXQoKSB3ZWVrUm93SGVpZ2h0ID0gODU7XHJcbiAgICAvKiog5ZGo6KeG5Zu+5Y2V5YWD5qC85a695bqm77yM6buY6K6kIDE1MHB4ICovXHJcbiAgICBASW5wdXQoKSB3ZWVrQ2VsbFdpZHRoID0gMTUwO1xyXG4gICAgLyoqIOaIv+mXtOWIl+WuveW6pu+8jOm7mOiupCAzMDBweCAqL1xyXG4gICAgQElucHV0KCkgcGxhY2VOYW1lV2lkdGggPSAzMDA7XHJcbiAgICAvKiog6buY6K6k6KeG5Zu+IGRheSDml6XvvIwgd2VlayDlkajjgIIg6buY6K6kIGRheSAqL1xyXG4gICAgQElucHV0KCkgdmlld1R5cGU6IENhbGVuZGFyVmlld1R5cGUgPSAnZGF5JztcclxuICAgIC8qKiDml6Xop4blm77kuIvlvIDlp4vml7bpl7QgKi9cclxuICAgIEBJbnB1dCgpIHN0YXJ0VGltZSA9IDc7XHJcblxyXG4gICAgLyoqIOmAieS4remihOiuouS/oeaBr0lEICovXHJcbiAgICBASW5wdXQoKSBzZWxlY3RlZElkID0gJyc7XHJcbiAgICAvKiog6K+m5oOF5Y2h54mH5YiX5L+h5oGvICovXHJcbiAgICBASW5wdXQoKSBkZXRhaWxDb2x1bW5zOiBBcnJheTxEZXRhaWxDb2x1bW4+O1xyXG4gICAgLyoqIOivpuaDheWNoeeJh+aYvuekuue8lui+keaMiemSriAqL1xyXG4gICAgQElucHV0KCkgc2hvd0VkaXRCdXR0b24gPSB0cnVlO1xyXG4gICAgLyoqIOivpuaDheWNoeeJh+aYvuekuuWIoOmZpOaMiemSriAqL1xyXG4gICAgQElucHV0KCkgc2hvd0RlbGV0ZUJ1dHRvbiA9IHRydWU7XHJcbiAgICBASW5wdXQoKSBzaG93Q2xvc2VCdXR0b24gPSB0cnVlO1xyXG4gICAgLyoqIOivpuaDheWNoeeJh+aMiemSrumFjee9riAqL1xyXG4gICAgQElucHV0KCkgZGV0YWlsVG9vbGJhcnM6QXJyYXk8RGV0YWlsVG9vbGJhckJ1dHRvbj47XHJcbiAgICAvKiog6K+m5oOF5Y2h54mH5qCH6aKY5YiX5a695bqm77yM6buY6K6kIDU2cHgg5pi+56S65Li6NOS4quWtlyAqL1xyXG4gICAgQElucHV0KCkgZGV0YWlsQ29sdW1uV2lkdGggPSA1NjtcclxuXHJcbiAgICAvKiog5Y+M5Ye75LqL5Lu2ICovXHJcbiAgICBAT3V0cHV0KCkgaXRlbURibENsaWNrID0gbmV3IEV2ZW50RW1pdHRlcigpO1xyXG5cclxuICAgIC8qKiDml6Xop4blm77vvIzpvKDmoIfmu5Hov4fnqbrnmb3ljZXlhYPmoLzmmL7npLrmlofmnKwgKi9cclxuICAgIEBJbnB1dCgpIHJlc2VydmF0aW9uVGl0bGUgPSAn6aKE6K6iJztcclxuXHJcbiAgICAvKiog6L+H5ruk5LqL5Lu2ICovXHJcbiAgICBAT3V0cHV0KCkgZmlsdGVyQ2hhbmdlID0gbmV3IEV2ZW50RW1pdHRlcigpO1xyXG4gICAgLyoqIOmAieS4reS6i+S7tiAqL1xyXG4gICAgQE91dHB1dCgpIHNlbGVjdENoYW5nZSA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcclxuICAgIC8qKiDljaHniYfor6bmg4XnvJbovpHkuovku7YgKi9cclxuICAgIEBPdXRwdXQoKSBlZGl0SGFuZGxlciA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcclxuICAgIC8qKiDljaHniYfor6bmg4XliKDpmaTkuovku7YgKi9cclxuICAgIEBPdXRwdXQoKSByZW1vdmVIYW5kbGVyID0gbmV3IEV2ZW50RW1pdHRlcigpO1xyXG4gICAgLyoqIOa4hemZpOmAieS4remhuSAqL1xyXG4gICAgQE91dHB1dCgpIGNsZWFyU2VsZWN0ZWQgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XHJcbiAgICAvKiog5pel6KeG5Zu+5Y2V5YWD5qC854K55Ye75LqL5Lu2ICovXHJcbiAgICBAT3V0cHV0KCkgcmVzZXJ2YXRpb24gPSBuZXcgRXZlbnRFbWl0dGVyKCk7XHJcbiAgICBcclxuICAgIEBWaWV3Q2hpbGQoJ2RldGFpbFJlZicpIGRldGFpbFJlZjogUmVzZXJ2ZURldGFpbENvbXBvbmVudDtcclxuICAgIFxyXG4gICAgd2Vla0RheXM6IEFycmF5PFdlZWtEYXlJdGVtPiA9IFtdO1xyXG4gICAgZ3JvdXBEYXRhOiBBcHBvaW50bWVudERhdGFbXSA9IFtdO1xyXG5cclxuICAgIHByaXZhdGUgY3VycmVudERhdGVSYW5nZVN0ciA9ICcnO1xyXG4gICAgcHJpdmF0ZSBjdXJyZW50RGF0ZVN0ciA9ICcnO1xyXG5cclxuICAgIGN1cnJlbnRTZWxlY3RJdGVtOiB7IHJvb206IGFueSwgZGF0YTogYW55IH0gPSBudWxsO1xyXG4gICAgcG9zaXRpb24gPSBudWxsO1xyXG4gICAgc2hvd0RldGFpbCA9IGZhbHNlO1xyXG4gICAgZGV0YWlsQ3VzdG9tQ2xzOiB7W2Nsc05hbWU6IHN0cmluZ106IGFueX0gPSBudWxsO1xyXG5cclxuICAgIF9DTElDS19ERUxBWV8gPSAxODA7XHJcbiAgICAvLyDmoYbmnrblpLTpq5jpq5jluqbvvJtcclxuICAgIF9mcmFtZUhlYWRlckhlaWdodCA9IDA7XHJcblxyXG4gICAgbWluV2Vla1ZpZXdXaWR0aCA9IDA7XHJcblxyXG4gICAgcHJpdmF0ZSBfY3VycmVudFNjcm9sbFBvczogeyBbdmlld1R5cGU6IHN0cmluZ106IHsgeDogbnVtYmVyLCB5OiBudW1iZXIgfSB9ID0geyAnZGF5Jzoge3g6IG51bGwseTogMH0sICd3ZWVrJzoge3g6IG51bGwseTogMH19O1xyXG4gICAgXHJcbiAgICByb3dXaWR0aCA9IDI0NTA7XHJcblxyXG4gICAgcHJpdmF0ZSBjYXJkQnRuQ2xpY2tTdWI6IFN1YnNjcmlwdGlvbjtcclxuICAgIGNvbnN0cnVjdG9yKHByaXZhdGUgaW5qZWN0b3I6IEluamVjdG9yLCBwcml2YXRlIGNkOiBDaGFuZ2VEZXRlY3RvclJlZiwgcHJpdmF0ZSBuZ1pvbmU6IE5nWm9uZSwgcHJpdmF0ZSByZW5kZXI6IFJlbmRlcmVyMiwgcHVibGljIHJvb21TZXI6IEFwcG9pbnRtZW50Q2FsZW5kYXJTZXJ2aWNlLFxyXG4gICAgICAgICAgICBwcml2YXRlIGRhdGVIbHA6IERhdGVUaW1lSGVscGVyU2VydmljZSwgcHJpdmF0ZSBlbFJlZjogRWxlbWVudFJlZiwgcHVibGljIHV0aWxzOiBDb21tb25VdGlscywgcHJpdmF0ZSBsb2NhbGVTZXI6IExvY2FsZVNlcnZpY2UpIHtcclxuICAgICAgICB0aGlzLmNhcmRCdG5DbGlja1N1YiA9IHRoaXMucm9vbVNlci5jYXJkQnRuQ2xpY2skLnN1YnNjcmliZSgoZTogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuZGV0YWlsRXZlbnRIYW5kbGVycyhlKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgdGhpcy5sb2NhbGVTZXIuc2V0TG9jYWxlRGF0YShBUFBPSU5UTUVOVF9DQUxFTkRBUl9MT0NBTEVTKTtcclxuICAgIH1cclxuXHJcbiAgICBuZ09uSW5pdCgpIHtcclxuICAgICAgICB0aGlzLmdyb3VwRGF0YSA9IHRoaXMubWVyZ2VEYXRlKCk7XHJcblxyXG4gICAgICAgIHRoaXMuc2hvd0VkaXRCdXR0b24gPSAhIXRoaXMuZWRpdEhhbmRsZXIub2JzZXJ2ZXJzLmxlbmd0aDtcclxuICAgICAgICB0aGlzLnNob3dEZWxldGVCdXR0b24gPSAhIXRoaXMucmVtb3ZlSGFuZGxlci5vYnNlcnZlcnMubGVuZ3RoO1xyXG5cclxuICAgICAgICB0aGlzLm1pbldlZWtWaWV3V2lkdGggPSAodGhpcy53ZWVrQ2VsbFdpZHRoIHx8IDE1MCkgKiA3ICsgdGhpcy5wbGFjZU5hbWVXaWR0aDtcclxuXHJcbiAgICAgICAgdGhpcy5yb3dXaWR0aCArPSB0aGlzLnBsYWNlTmFtZVdpZHRoO1xyXG4gICAgfVxyXG5cclxuICAgIG5nT25DaGFuZ2VzKGNoYW5nZXM6IFNpbXBsZUNoYW5nZXMpIHtcclxuICAgICAgICBpZiAoY2hhbmdlcy5yZXNlcnZlRGF0YSAmJiAhY2hhbmdlcy5yZXNlcnZlRGF0YS5pc0ZpcnN0Q2hhbmdlKCkpIHtcclxuICAgICAgICAgICAgdGhpcy5kYXRhQ2hhbmdlZCgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKGNoYW5nZXMucGxhY2VJdGVtcyAmJiAhY2hhbmdlcy5wbGFjZUl0ZW1zLmlzRmlyc3RDaGFuZ2UoKSkge1xyXG4gICAgICAgICAgICB0aGlzLmRhdGFDaGFuZ2VkKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIG5nT25EZXN0cm95KCk6IHZvaWQge1xyXG4gICAgICAgIGlmICggdGhpcy5jYXJkQnRuQ2xpY2tTdWIgKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2FyZEJ0bkNsaWNrU3ViLnVuc3Vic2NyaWJlKCk7XHJcbiAgICAgICAgICAgIHRoaXMuY2FyZEJ0bkNsaWNrU3ViID0gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgbmdBZnRlclZpZXdJbml0KCkge1xyXG4gICAgfVxyXG5cclxuICAgIGxvYWRSZXNlcnZlRGF0YShkYXRhOiBbXSkge1xyXG4gICAgICAgIHRoaXMucmVzZXJ2ZURhdGEgPSBkYXRhO1xyXG4gICAgICAgIHRoaXMuZGF0YUNoYW5nZWQoKTtcclxuICAgICAgICB0aGlzLmNkLmRldGVjdENoYW5nZXMoKTtcclxuICAgIH1cclxuXHJcbiAgICBsb2FkUGxhY2VEYXRhKGRhdGE6IFtdKSB7XHJcbiAgICAgICAgdGhpcy5wbGFjZUl0ZW1zID0gZGF0YTtcclxuICAgICAgICB0aGlzLmRhdGFDaGFuZ2VkKCk7XHJcbiAgICAgICAgdGhpcy5jZC5kZXRlY3RDaGFuZ2VzKCk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBkYXRhQ2hhbmdlZCgpIHtcclxuICAgICAgICB0aGlzLmdyb3VwRGF0YSA9IHRoaXMubWVyZ2VEYXRlKCk7XHJcbiAgICAgICAgaWYgKHRoaXNbJ0NBTEVOREFSX1NDUk9MTF9QT1NJVElPTiddKSB7XHJcbiAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aGlzWydDQUxFTkRBUl9TQ1JPTExfUE9TSVRJT04nXSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXNbJ0NBTEVOREFSX1NDUk9MTF9QT1NJVElPTiddID0gc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHJvb21Cb2R5RWwgPSB0aGlzLmVsUmVmLm5hdGl2ZUVsZW1lbnQucXVlcnlTZWxlY3RvcignLmJvZHknKTtcclxuICAgICAgICAgICAgY29uc3QgeyB4LCB5IH0gPSB0aGlzLl9jdXJyZW50U2Nyb2xsUG9zW3RoaXMudmlld1R5cGVdIHx8IHsgeDogbnVsbCwgeTogbnVsbH07XHJcbiAgICAgICAgICAgIGlmIChyb29tQm9keUVsKSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgbGVmdCA9IHg7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy52aWV3VHlwZSA9PT0gJ2RheScgJiYgeCA9PT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGxlZnQgPSB0aGlzLnN0YXJ0VGltZSAqIDEwMDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgcm9vbUJvZHlFbC5zY3JvbGxMZWZ0ID0gbGVmdDtcclxuICAgICAgICAgICAgICAgIHJvb21Cb2R5RWwuc2Nyb2xsVG9wID0geSB8fCAwO1xyXG4gICAgICAgICAgICAgICAgcm9vbUJvZHlFbC5zY3JvbGxUbyhsZWZ0LCB5IHx8IDApXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LCAxMDApO1xyXG4gICAgfVxyXG5cclxuICAgIG9uVmlld1R5cGVDaGFuZ2VkKCRldmVudDogVmlld1R5cGVDaGFuZ2VkUGFyYW0pIHtcclxuICAgICAgICBjb25zdCB7IHZpZXdUeXBlLCB3ZWVrRGF5cywgZGF0ZVZhbHVlLCBwbGFjZSB9ID0gJGV2ZW50O1xyXG4gICAgICAgIHRoaXMudmlld1R5cGUgPSB2aWV3VHlwZTtcclxuICAgICAgICB0aGlzLndlZWtEYXlzID0gd2Vla0RheXM7XHJcblxyXG4gICAgICAgIGlmICh0aGlzLnZpZXdUeXBlID09PSAnZGF5Jykge1xyXG4gICAgICAgICAgICB0aGlzLmN1cnJlbnREYXRlU3RyID0gZGF0ZVZhbHVlO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuY3VycmVudERhdGVSYW5nZVN0ciA9IGRhdGVWYWx1ZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuZGF0YUNoYW5nZWQoKTtcclxuXHJcbiAgICAgICAgdGhpcy5maWx0ZXJDaGFuZ2UuZW1pdCggeyB2aWV3VHlwZSwgZGF0ZVZhbHVlLCBwbGFjZSB9KTtcclxuICAgICAgICB0aGlzLmNkLmRldGVjdENoYW5nZXMoKTtcclxuICAgIH1cclxuXHJcbiAgICBvblBsYWNlU2VsZWN0ZWQoJGV2ZW50OiBWaWV3VHlwZUNoYW5nZWRQYXJhbSkge1xyXG4gICAgICAgIC8vIFRPRE86IOaIv+mXtOWIh+aNouWQju+8jOWuouaIt+err+i/h+a7pOaIv+mXtOWIl+ihqFxyXG5cclxuICAgIH1cclxuXHJcblxyXG4gICAgcHJpdmF0ZSBnZXRVc2VkQ2VsbHMocmVzZXJ2ZXMpIHtcclxuICAgICAgICBpZiAocmVzZXJ2ZXMgJiYgcmVzZXJ2ZXMubGVuZ3RoKSB7XHJcblxyXG4gICAgICAgICAgICBjb25zdCBzdGFydEZpZWxkID0gdGhpcy5yZXNlcnZlSW5mb0ZpZWxkcy5zdGFydERhdGU7XHJcbiAgICAgICAgICAgIGNvbnN0IGVuZEZpZWxkID0gdGhpcy5yZXNlcnZlSW5mb0ZpZWxkcy5lbmREYXRlO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgY2VsbHMgPSByZXNlcnZlcy5tYXAobiA9PiB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBzdGFydFZhbHVlID0gdGhpcy51dGlscy5nZXRWYWx1ZShzdGFydEZpZWxkLCBuLmRhdGEpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgX3N0YXJ0VGltZXMgPSB0aGlzLmdldFRpbWVzKHN0YXJ0VmFsdWUpO1xyXG5cclxuICAgICAgICAgICAgICAgIGNvbnN0IGVuZFZhbHVlID0gdGhpcy51dGlscy5nZXRWYWx1ZShlbmRGaWVsZCwgbi5kYXRhKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IF9lbmRUaW1lcyA9IHRoaXMuZ2V0VGltZXMoZW5kVmFsdWUpO1xyXG5cclxuICAgICAgICAgICAgICAgIGNvbnN0IGJlZ2luSW5kZXggPSBfc3RhcnRUaW1lcy5ob3VyO1xyXG4gICAgICAgICAgICAgICAgbGV0IGVuZEluZGV4ID0gX2VuZFRpbWVzLmhvdXIgLSAxO1xyXG4gICAgICAgICAgICAgICAgLy8gaWYgKF9lbmRUaW1lcy5taW51dGUgPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgZW5kSW5kZXgrKztcclxuICAgICAgICAgICAgICAgIC8vIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgZW5kSW5kZXgtLTtcclxuICAgICAgICAgICAgICAgIC8vIH1cclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgYyA9IFtdO1xyXG4gICAgICAgICAgICAgICAgZm9yKGxldCBpPWJlZ2luSW5kZXggLSAxOyBpPCBlbmRJbmRleDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYy5wdXNoKGkrMSlcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gYztcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gZmxhdHRlbihjZWxscyk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgIH1cclxuXHJcblxyXG4gICAgcHJpdmF0ZSBtZXJnZURhdGUoKTogQXBwb2ludG1lbnREYXRhW10ge1xyXG4gICAgICAgIGlmICh0aGlzLnBsYWNlSXRlbXMgJiYgdGhpcy5wbGFjZUl0ZW1zLmxlbmd0aCkge1xyXG4gICAgICAgICAgICBpZiAodGhpcy52aWV3VHlwZSA9PT0gJ2RheScpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnBsYWNlSXRlbXMubWFwKG4gPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHJlc2VydmVzID0gIHRoaXMucmVzZXJ2ZURhdGEuZmlsdGVyKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkID0+IHRoaXMudXRpbHMuZ2V0VmFsdWUodGhpcy5yZXNlcnZlSW5mb0ZpZWxkcy5wbGFjZWlkLGQpID09PSB0aGlzLnV0aWxzLmdldFZhbHVlKHRoaXMucGxhY2VJZEZpZWxkLCBuKSAmJiBcclxuICAgICAgICAgICAgICAgICAgICAgICAgaXNTYW1lRGF5KG5ldyBEYXRlKHRoaXMudXRpbHMuZ2V0VmFsdWUodGhpcy5yZXNlcnZlSW5mb0ZpZWxkcy5zdGFydERhdGUsIGQpKSwgbmV3IERhdGUodGhpcy5jdXJyZW50RGF0ZVN0cikpXHJcbiAgICAgICAgICAgICAgICAgICAgKS5tYXAociA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiByLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IHJbdGhpcy5yZXNlcnZlSW5mb0ZpZWxkcy5pZEZpZWxkXSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiB0aGlzLmdldFJlc2VydmVQb3NpdGlvbkluZm8ociksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZDogblt0aGlzLnBsYWNlSWRGaWVsZF0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IG4sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc2VydmVzLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkaXNhYmxlQ2VsbHM6IHRoaXMuZ2V0VXNlZENlbGxzKHJlc2VydmVzKVxyXG4gICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnBsYWNlSXRlbXMubWFwKG4gPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlkOiBuW3RoaXMucGxhY2VJZEZpZWxkXSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YTogbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzZXJ2ZXM6IHRoaXMud2Vla0RheXMubWFwKCh3ZWVrZGF5OiBXZWVrRGF5SXRlbSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRlOiB3ZWVrZGF5LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW1zOiB0aGlzLnJlc2VydmVEYXRhLmZpbHRlcihkID0+IHRoaXMudXRpbHMuZ2V0VmFsdWUoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVzZXJ2ZUluZm9GaWVsZHMucGxhY2VpZCxkKSA9PT0gdGhpcy51dGlscy5nZXRWYWx1ZSh0aGlzLnBsYWNlSWRGaWVsZCwgbikgICYmIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc1NhbWVEYXkobmV3IERhdGUodGhpcy51dGlscy5nZXRWYWx1ZSh0aGlzLnJlc2VydmVJbmZvRmllbGRzLnN0YXJ0RGF0ZSwgZCkpLCB3ZWVrZGF5LmRhdGUpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKS5tYXAociA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiByLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IHJbdGhpcy5yZXNlcnZlSW5mb0ZpZWxkcy5pZEZpZWxkXSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLnNvcnQoKGEsIGIpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgciA9IHRoaXMuZGF0ZUhscC5kaWZmZXJlbmNlSW5NaW51dGVzKG5ldyBEYXRlKHRoaXMudXRpbHMuZ2V0VmFsdWUodGhpcy5yZXNlcnZlSW5mb0ZpZWxkcy5zdGFydERhdGUsIGEuZGF0YSkpLCBuZXcgRGF0ZSh0aGlzLnV0aWxzLmdldFZhbHVlKHRoaXMucmVzZXJ2ZUluZm9GaWVsZHMuZW5kRGF0ZSwgYi5kYXRhKSkpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByID4gMCA/IDE6IHI8IDA/IC0xOiAwO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gW107XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0VGltZXMoZGF0ZVN0cjogc3RyaW5nKSB7XHJcbiAgICAgICAgaWYgKGRhdGVTdHIpIHtcclxuICAgICAgICAgICAgY29uc3QgX3N0YXJ0RGF0ZSA9IHRoaXMuZGF0ZUhscC5mb3JtYXRUbyhkYXRlU3RyLCAneXl5eS1NTS1kZCBISDptbTpzcycpO1xyXG4gICAgICAgICAgICBpZiAoX3N0YXJ0RGF0ZSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3Qgc3RhcnREYXRlID0gbmV3IERhdGUoX3N0YXJ0RGF0ZSk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBob3VyID0gc3RhcnREYXRlLmdldEhvdXJzKCk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBtaW51dGUgPSBzdGFydERhdGUuZ2V0TWludXRlcygpO1xyXG5cclxuICAgICAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICAgICAgaG91ciwgbWludXRlLCBkYXRlOiBuZXcgRGF0ZShfc3RhcnREYXRlLnNwbGl0KCcgJylbMF0pXHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGdldFJlc2VydmVQb3NpdGlvbkluZm8ocmVzZXJ2ZUl0ZW06IGFueSkge1xyXG4gICAgICAgIGNvbnN0IHN0YXJ0RmllbGQgPSB0aGlzLnJlc2VydmVJbmZvRmllbGRzLnN0YXJ0RGF0ZTtcclxuICAgICAgICBjb25zdCBlbmRGaWVsZCA9IHRoaXMucmVzZXJ2ZUluZm9GaWVsZHMuZW5kRGF0ZTtcclxuICAgICAgICBsZXQgbGVmdCA9IDA7XHJcbiAgICAgICAgbGV0IHdpZHRoID0gMDtcclxuXHJcbiAgICAgICAgY29uc3Qgc3RhcnREYXRlU3RyID0gcmVzZXJ2ZUl0ZW1bc3RhcnRGaWVsZF07XHJcbiAgICAgICAgY29uc3QgZW5kRGF0ZVN0ciA9ICByZXNlcnZlSXRlbVtlbmRGaWVsZF07XHJcblxyXG4gICAgICAgIGlmIChzdGFydERhdGVTdHIpIHtcclxuICAgICAgICAgICAgY29uc3QgX3N0YXJ0VGltZXMgPSB0aGlzLmdldFRpbWVzKHN0YXJ0RGF0ZVN0cik7XHJcbiAgICAgICAgICAgIGlmIChfc3RhcnRUaW1lcykge1xyXG4gICAgICAgICAgICAgICAgY29uc3Qge2hvdXIsIG1pbnV0ZX0gPSBfc3RhcnRUaW1lcztcclxuXHJcbiAgICAgICAgICAgICAgICBsZWZ0ID0gKGhvdXIpICogMTAwO1xyXG4gICAgICAgICAgICAgICAgaWYgKG1pbnV0ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGxlZnQgKz0gbWludXRlIC8gNjAgKiAxMDA7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKGVuZERhdGVTdHIpIHtcclxuICAgICAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBtaW51dGVzID0gZGlmZmVyZW5jZUluTWludXRlcyhuZXcgRGF0ZShlbmREYXRlU3RyKSwgbmV3IERhdGUoc3RhcnREYXRlU3RyKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgd2lkdGggPSBtaW51dGVzIC8gNjAgKiAxMDA7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiB7bGVmdCwgd2lkdGh9O1xyXG4gICAgfVxyXG5cclxuICAgIG9uU2VsZWN0Q2hhbmdlKCRldmVudCkge1xyXG4gICAgICAgIHRoaXMuc2VsZWN0ZWRJZCA9ICRldmVudC5pdGVtLmlkO1xyXG4gICAgICAgIHRoaXMuY3VycmVudFNlbGVjdEl0ZW0gPSB7cm9vbTogJGV2ZW50LnJvb20sIGRhdGE6ICRldmVudC5pdGVtLmRhdGF9O1xyXG5cclxuICAgICAgICBsZXQgdGFyID0gbnVsbDtcclxuICAgICAgICBpZiAodGhpcy52aWV3VHlwZSA9PT0gJ3dlZWsnKSB7XHJcbiAgICAgICAgICAgIHRhciA9ICRldmVudC4kZXZlbnQudGFyZ2V0LmNsb3Nlc3QoJ2xpJylcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0YXIgPSAkZXZlbnQuJGV2ZW50LnRhcmdldC5jbG9zZXN0KCcuaXRlbS1jb250ZW50JylcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5nZXRQb3NpdGlvbkZvckRldGFpbFBhbmVsKHRhcik7XHJcblxyXG4gICAgICAgIGlmICh0aGlzLmRldGFpbENscykge1xyXG4gICAgICAgICAgICB0aGlzLmRldGFpbEN1c3RvbUNscyA9IHRoaXMuZGV0YWlsQ2xzKCRldmVudC5pdGVtKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuc2hvd0RldGFpbCA9IHRydWU7XHJcblxyXG4gICAgICAgIHRoaXMuc2VsZWN0Q2hhbmdlLmVtaXQoJGV2ZW50KTtcclxuICAgIH1cclxuXHJcbiAgICBvbkl0ZW1EYmxDbGljaygkZXZlbnQpIHtcclxuICAgICAgICB0aGlzLnNlbGVjdGVkSWQgPSAkZXZlbnQuaXRlbS5pZDtcclxuICAgICAgICB0aGlzLmN1cnJlbnRTZWxlY3RJdGVtID0ge3Jvb206ICRldmVudC5yb29tLCBkYXRhOiAkZXZlbnQuaXRlbS5kYXRhfTtcclxuICAgICAgICB0aGlzLml0ZW1EYmxDbGljay5lbWl0KCRldmVudCk7XHJcbiAgICB9XHJcblxyXG4gICAgc2VsZWN0SXRlbShyZXNlcnZlSWQ6IGFueSkge1xyXG4gICAgICAgIHRoaXMuc2VsZWN0ZWRJZCA9IHJlc2VydmVJZDtcclxuICAgICAgICB0aGlzLmNkLmRldGVjdENoYW5nZXMoKTtcclxuICAgICAgICBpZiAodGhpcy5zZWxlY3RlZElkID09PSBudWxsIHx8IHRoaXMuc2VsZWN0ZWRJZCA9PT0gdW5kZWZpbmVkIHx8IHRoaXMuc2VsZWN0ZWRJZCA9PT0gJycpIHtcclxuICAgICAgICAgICAgdGhpcy5jbGVhclNlbGVjdCgpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBjbGVhclNlbGVjdCgpIHtcclxuICAgICAgICB0aGlzLnNlbGVjdGVkSWQgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuY2xlYXJTZWxlY3RlZC5lbWl0KHtpbnM6IHRoaXN9KTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGdldEZyYW1laGVhZGVySGVpZ2h0KCkge1xyXG5cclxuICAgICAgICBpZih0aGlzLl9mcmFtZUhlYWRlckhlaWdodCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fZnJhbWVIZWFkZXJIZWlnaHQ7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zdCB0YWJzZXQ6IGFueSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5mcmFtZXdvcmstdGFiLW9yaWdpbi5ndy1jb250YWluZXItdGFic2V0LnRhYi1jb250YWluZXInKTtcclxuICAgICAgICBsZXQgaCA9IDA7XHJcbiAgICAgICAgaWYgKHRhYnNldCkge1xyXG4gICAgICAgICAgICBoICs9IHRhYnNldC5vZmZzZXRIZWlnaHQ7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zdCBmcmFtZUhlYWRlcjogYW55ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmd3LWhlYWRlci0td3JhcHBlci5mcmFtZXdvcmstdG9vbC1vcmlnaW4nKTtcclxuICAgICAgICBpZiAoZnJhbWVIZWFkZXIpIHtcclxuICAgICAgICAgICAgaCArPSBmcmFtZUhlYWRlci5vZmZzZXRIZWlnaHQ7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLl9mcmFtZUhlYWRlckhlaWdodCA9IGg7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2ZyYW1lSGVhZGVySGVpZ2h0O1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgZ2V0UG9zaXRpb25Gb3JEZXRhaWxQYW5lbCh0YXJnZXQ6IEhUTUxFbGVtZW50KSB7XHJcbiAgICAgICAgY29uc3QgeyBsZWZ0LCB0b3AsIHJpZ2h0LCBib3R0b20sIHdpZHRoLCBoZWlnaHQgfSA9IHRhcmdldC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcclxuICAgICAgICBjb25zdCBwYW5lbFNpemUgPSB7IHdpZHRoOiAzNjgsIGhlaWdodDogNDM2IH07XHJcblxyXG4gICAgICAgIGxldCBfbGVmdCA9IGxlZnQ7XHJcbiAgICAgICAgbGV0IF90b3AgPSB0b3A7XHJcblxyXG4gICAgICAgIGNvbnN0IF9yaWdodCA9IHdpbmRvdy5pbm5lcldpZHRoIC0gcmlnaHQ7XHJcbiAgICAgICAgY29uc3QgX2JvdHRvbSA9IHdpbmRvdy5pbm5lckhlaWdodCAtIGJvdHRvbTtcclxuXHJcblxyXG4gICAgICAgIGlmIChfbGVmdCA+IF9yaWdodCkge1xyXG4gICAgICAgICAgICBpZiAoIF9sZWZ0ID4gcGFuZWxTaXplLndpZHRoKSB7XHJcbiAgICAgICAgICAgICAgICBfbGVmdCA9IF9sZWZ0IC0gcGFuZWxTaXplLndpZHRoO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgaWYgKHdpbmRvdy5pbm5lcldpZHRoIC0gbGVmdCA+IHBhbmVsU2l6ZS53aWR0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgIF9sZWZ0ID0gbGVmdDtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJpZ2h0ID4gcGFuZWxTaXplLndpZHRoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9sZWZ0ID0gcmlnaHQgLSBwYW5lbFNpemUud2lkdGg7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2xlZnQgPSAod2luZG93LmlubmVyV2lkdGggLSBwYW5lbFNpemUud2lkdGgpIC8gMjtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBpZiAoX3JpZ2h0ID4gcGFuZWxTaXplLndpZHRoKSB7XHJcbiAgICAgICAgICAgICAgICBfbGVmdCA9IHJpZ2h0O1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgaWYocmlnaHQgPiBwYW5lbFNpemUud2lkdGgpIHtcclxuICAgICAgICAgICAgICAgICAgICBfbGVmdCA9IGxlZnQ7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIF9sZWZ0ID0gKHdpbmRvdy5pbm5lcldpZHRoIC0gcGFuZWxTaXplLndpZHRoKSAvIDI7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChfdG9wID4gX2JvdHRvbSkge1xyXG4gICAgICAgICAgICBpZiAoX3RvcCA+IHBhbmVsU2l6ZS5oZWlnaHQpIHtcclxuICAgICAgICAgICAgICAgIGlmIChsZWZ0ID4gcGFuZWxTaXplLndpZHRoIHx8IF9yaWdodCA+IHBhbmVsU2l6ZS53aWR0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh3aW5kb3cuaW5uZXJIZWlnaHQgLSBfdG9wIDwgaGVpZ2h0ICsgNDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX3RvcCA9IHdpbmRvdy5pbm5lckhlaWdodCAtIHBhbmVsU2l6ZS5oZWlnaHQgLSAyMDtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfdG9wID0gdG9wIC0gcGFuZWxTaXplLmhlaWdodCArIGhlaWdodCArIDQwO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoX3RvcCA8IHRoaXMuZ2V0RnJhbWVoZWFkZXJIZWlnaHQoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RvcCA9IHRoaXMuZ2V0RnJhbWVoZWFkZXJIZWlnaHQoKSArIDEwO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBfdG9wID0gdG9wIC0gcGFuZWxTaXplLmhlaWdodDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIF90b3AgPSAxMCArIHRoaXMuZ2V0RnJhbWVoZWFkZXJIZWlnaHQoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGlmIChfYm90dG9tID4gcGFuZWxTaXplLmhlaWdodCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCBfcmlnaHQgPiBwYW5lbFNpemUud2lkdGggfHwgbGVmdCA+IHBhbmVsU2l6ZS53aWR0aCApIHtcclxuICAgICAgICAgICAgICAgICAgICBfdG9wID0gYm90dG9tIC0gaGVpZ2h0IC0gNDA7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIF90b3AgPSBib3R0b207XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBfdG9wID0gMTAgKyB0aGlzLmdldEZyYW1laGVhZGVySGVpZ2h0KCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMucG9zaXRpb24gPSB7IGxlZnQ6IF9sZWZ0LCB0b3A6IF90b3B9O1xyXG4gICAgfVxyXG5cclxuICAgIGNsb3NlRGV0YWlsUGFuZWwoKSB7XHJcbiAgICAgICAgdGhpcy5yb29tU2VyLmNhcmRCdG5DbGljayQubmV4dCh7YWN0aW9uOiAnY2xvc2UnfSk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIG9uQWRkTmV3KCRldmVudCkge1xyXG4gICAgICAgIHRoaXMucmVzZXJ2YXRpb24uZW1pdCgkZXZlbnQpO1xyXG4gICAgfVxyXG5cclxuICAgIG9uU2Nyb2xsQ2hhbmdlKCRldmVudCwgdHlwKSB7XHJcbiAgICAgICAgdGhpcy5fY3VycmVudFNjcm9sbFBvc1t0aGlzLnZpZXdUeXBlXSA9IHsuLi4kZXZlbnQsIHR5cGU6IHR5cH07XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBkZXRhaWxFdmVudEhhbmRsZXJzKGU6IGFueSkge1xyXG4gICAgICAgIGNvbnN0IHsgYWN0aW9uLCBpdGVtLCAkZXZlbnQgfSA9IGU7XHJcbiAgICAgICAgbGV0IHAgPSBudWxsO1xyXG4gICAgICAgIGlmIChpdGVtKSB7XHJcbiAgICAgICAgICAgIHAgPSB7IGl0ZW06IHsgZGF0YTogaXRlbSAsIGlkOiB0aGlzLnV0aWxzLmdldFZhbHVlKHRoaXMucmVzZXJ2ZUluZm9GaWVsZHMuaWRGaWVsZCwgaXRlbSkgfX07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHN3aXRjaChhY3Rpb24pIHtcclxuICAgICAgICAgICAgY2FzZSAnZWRpdCc6XHJcbiAgICAgICAgICAgICAgICB0aGlzLmVkaXRIYW5kbGVyLmVtaXQocCk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAnZGVsJzpcclxuICAgICAgICAgICAgICAgIHRoaXMucmVtb3ZlSGFuZGxlci5lbWl0KHApO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgJ2Nsb3NlJzpcclxuICAgICAgICAgICAgICAgIHRoaXMuc2hvd0RldGFpbCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcbiJdfQ==