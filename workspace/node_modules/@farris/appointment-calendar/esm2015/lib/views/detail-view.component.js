/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, ElementRef, Injector, Input, TemplateRef } from '@angular/core';
import { AppointmentCalendarService } from '../appointment-calendar.service';
export class ReserveDetailComponent {
    /**
     * @param {?} injector
     * @param {?} ser
     * @param {?} el
     */
    constructor(injector, ser, el) {
        this.injector = injector;
        this.ser = ser;
        this.el = el;
        /**
         * 弹出面板位置
         */
        this.position = null;
        /**
         * 预定信息字段配置
         */
        this.fieldConfigs = null;
        /**
         * 预定地点字段配置
         */
        this.placeFieldConfigs = null;
        this.customCls = null;
        this.showEditButton = true;
        this.showDeleteButton = true;
        this.showCloseButton = true;
        this.detailColumnWidth = 56;
        this.titleLength = 52;
        this.rooNameField = 'name';
    }
    /**
     * @return {?}
     */
    ngOnInit() {
        this.rooNameField = this.placeFieldConfigs.fullName || this.placeFieldConfigs.name;
    }
    /**
     * @param {?} $event
     * @param {?} t
     * @return {?}
     */
    toolbarBtnClick($event, t) {
        $event.stopPropagation();
        this.ser.cardBtnClick$.next({ $event, action: t, item: this.data });
    }
    /**
     * @param {?=} typ
     * @return {?}
     */
    getCustomCls(typ = 'cls') {
        /** @type {?} */
        let result = null;
        if (this.customCls) {
            if (!this.customCls['cls'] && !this.customCls['cls'] && typ == 'cls') {
                result = this.customCls;
            }
            else {
                result = this.customCls[typ] || {};
            }
        }
        // if (typ === 'styles' || typ === 'detail') {
        //     Object.keys(result).forEach((n: any) => {
        //         if (result[n].indexOf('important') === -1) {
        //             result[n] = result[n] +' !important' ;
        //         }
        //     });
        // }
        return result;
    }
    /**
     * @param {?} str
     * @return {?}
     */
    getLength(str) {
        /** @type {?} */
        let strLength = 0;
        // 记录str的总长度
        /** @type {?} */
        const Len = str.length;
        for (let i = 0; i < Len; i++) {
            /** @type {?} */
            var charCode = str.charCodeAt(i);
            if (charCode >= 0 && charCode <= 128) {
                strLength++; //英文字符加1
            }
            else {
                strLength = strLength + 2; //中文字符加2
            }
        }
        return strLength;
    }
    /**
     * @param {?} str
     * @param {?} len
     * @return {?}
     */
    subStrNum(str, len) {
        /** @type {?} */
        const strLen = str.length;
        /** @type {?} */
        let strCut = '';
        /** @type {?} */
        let strLength = 0;
        for (let i = 0; i < strLen; i++) {
            /** @type {?} */
            var charStr = str.charAt(i);
            strLength++;
            if (encodeURI(charStr).length > 4) { //使用encodeURI获取编码长度
                strLength++;
            }
            strCut = strCut.concat(charStr); //单个字符进行合并
            if (strLength >= len) {
                strCut = strCut.concat('...'); //大于指定长度后合并'...'并返回此字符串
                return strCut;
            }
        }
        if (strLength < len) {
            return str;
        }
    }
}
ReserveDetailComponent.decorators = [
    { type: Component, args: [{
                selector: 'reserve-detail',
                template: `
      <div class="reserve-detail-container" style="position: fixed; z-index: 99" [style.left.px]="position?.left" [style.top.px]="position?.top">
        <div class="detail-header" [ngClass]="getCustomCls()" [ngStyle]="getCustomCls('styles')">
            <div class="detail-toolbar" *ngIf="!toolbarButtons || !toolbarButtons.length">
                <span *ngIf="showEditButton" class="f-icon f-icon f-icon-new-edit" title="{{ 'appointment.detail.edit' | locale }}" (click)="toolbarBtnClick($event, 'edit')"></span>
                <span *ngIf="showDeleteButton" class="f-icon f-icon-trash" title="{{ 'appointment.detail.del' | locale }}" (click)="toolbarBtnClick($event, 'del')"></span>
                <span *ngIf="showCloseButton" class="f-icon f-icon-close" title="{{ 'appointment.detail.close' | locale }}" (click)="toolbarBtnClick($event, 'close')"></span>
            </div>

            <div class="detail-toolbar" *ngIf="toolbarButtons && toolbarButtons.length">
                <span *ngFor="let btn of toolbarButtons" class="{{ btn.icon }}" title="{{ btn.title }}" [style.display]="btn.visible ? '': 'none'"
                    (click)="!btn.disable && btn.handler && btn.handler({ item: data, $event: $event })"></span>
                <span *ngIf="showCloseButton" class="f-icon f-icon-close" title="{{ 'appointment.detail.close' | locale }}" (click)="toolbarBtnClick($event, 'close')"></span>
            </div>

            <div class="detail-title">
 
                <span class="detail-place">
                    {{rooNameField | getvalue: placeInfo}}
                </span>
                <div class="title-content" style='word-break:break-all; font-family:-apple-system,BlinkMacSystemFont,"Segoe UI","PingFang SC","Hiragino Sans GB","Microsoft YaHei","Helvetica Neue",Helvetica,Arial,sans-serif' title="{{fieldConfigs.title}}">
                    {{subStrNum(fieldConfigs.title | getvalue: data, titleLength)}}
                    <!-- <span class="detail-label">专项会议</span> -->
                    <ng-container [ngTemplateOutlet]="badgeTemplate" [ngTemplateOutletContext]="{ $implicit: {data: data}, item: data }"></ng-container>
                </div>
                <div class="detail-timer">
                    {{ fieldConfigs.startDate| getvalue: data | dateformat: ('appointment.detail.dateFormat'|locale) }} {{ fieldConfigs.startDate| getvalue: data | dateformat: 'HH:mm' }} 
                    &nbsp;-&nbsp;
                    {{ fieldConfigs.endDate | getvalue: data | dateformat: ('appointment.detail.dateFormat'|locale) }} {{ fieldConfigs.endDate | getvalue: data | dateformat: 'HH:mm' }} 
                    <!-- 9月4日（今天）08:00 — 9月7日（周三）17:30 -->
                </div>
            </div>
        </div>
        <div class="detail-info-content  win11Scroll nobtn" [ngStyle]="getCustomCls('detail')">
            <ng-container [ngTemplateOutlet]="detailTemplate" [ngTemplateOutletContext]="{ $implicit: {data: data}, item: data }"></ng-container>
            <ul *ngIf="!detailTemplate">
                <li *ngFor="let col of columns">
                    <ng-container *ngIf="!col.template">
                        <span class="detail-subtitle" [style.width.px]="detailColumnWidth" [style.minWidth.px]="detailColumnWidth" [title]="col.title">{{col.title}}</span> 
                        <span class="detail-content  d-flex flex-row" *ngIf="!col.formatter">
                            <span class="colon"></span>    
                            <span class="text">{{ col.field | getvalue: data: true}}</span>
                        </span>
                        <span class="detail-content  d-flex flex-row" *ngIf="col.formatter">
                            <span class="colon"></span>
                            <span class="text" [innerHtml]=" col.field | getvalue: data | columnformatter: col : data | safe: 'html'"></span>
                        </span>
                    </ng-container>
                    <ng-container *ngIf="col.template"  [ngTemplateOutlet]="col.template" [ngTemplateOutletContext]="{ $implicit: {data: data, field: col.field, label: col.title}, item: data }">
                    </ng-container>
                </li>
                
            </ul>
        </div>
    </div>

    `,
                styles: [`
            .detail-subtitle {
               text-align: justify;text-align-last: justify;white-space: nowrap;overflow: hidden;text-overflow: ellipsis;
            }
            .detail-content>.colon:before {
                content: '：'
            }

            .detail-content>.text {
                word-break: break-all;
            }
        `]
            }] }
];
/** @nocollapse */
ReserveDetailComponent.ctorParameters = () => [
    { type: Injector },
    { type: AppointmentCalendarService },
    { type: ElementRef }
];
ReserveDetailComponent.propDecorators = {
    data: [{ type: Input }],
    position: [{ type: Input }],
    columns: [{ type: Input }],
    detailTemplate: [{ type: Input }],
    badgeTemplate: [{ type: Input }],
    fieldConfigs: [{ type: Input }],
    placeInfo: [{ type: Input }],
    placeFieldConfigs: [{ type: Input }],
    customCls: [{ type: Input }],
    showEditButton: [{ type: Input }],
    showDeleteButton: [{ type: Input }],
    showCloseButton: [{ type: Input }],
    toolbarButtons: [{ type: Input }],
    detailColumnWidth: [{ type: Input }],
    titleLength: [{ type: Input }]
};
if (false) {
    /**
     * 预定数据
     * @type {?}
     */
    ReserveDetailComponent.prototype.data;
    /**
     * 弹出面板位置
     * @type {?}
     */
    ReserveDetailComponent.prototype.position;
    /**
     * 预定详情字段
     * @type {?}
     */
    ReserveDetailComponent.prototype.columns;
    /**
     * 预定详情模板
     * @type {?}
     */
    ReserveDetailComponent.prototype.detailTemplate;
    /**
     * 徽章械板
     * @type {?}
     */
    ReserveDetailComponent.prototype.badgeTemplate;
    /**
     * 预定信息字段配置
     * @type {?}
     */
    ReserveDetailComponent.prototype.fieldConfigs;
    /**
     * 预定地点信息
     * @type {?}
     */
    ReserveDetailComponent.prototype.placeInfo;
    /**
     * 预定地点字段配置
     * @type {?}
     */
    ReserveDetailComponent.prototype.placeFieldConfigs;
    /** @type {?} */
    ReserveDetailComponent.prototype.customCls;
    /** @type {?} */
    ReserveDetailComponent.prototype.showEditButton;
    /** @type {?} */
    ReserveDetailComponent.prototype.showDeleteButton;
    /** @type {?} */
    ReserveDetailComponent.prototype.showCloseButton;
    /** @type {?} */
    ReserveDetailComponent.prototype.toolbarButtons;
    /** @type {?} */
    ReserveDetailComponent.prototype.detailColumnWidth;
    /** @type {?} */
    ReserveDetailComponent.prototype.titleLength;
    /** @type {?} */
    ReserveDetailComponent.prototype.rooNameField;
    /**
     * @type {?}
     * @private
     */
    ReserveDetailComponent.prototype.injector;
    /**
     * @type {?}
     * @private
     */
    ReserveDetailComponent.prototype.ser;
    /** @type {?} */
    ReserveDetailComponent.prototype.el;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGV0YWlsLXZpZXcuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGZhcnJpcy9hcHBvaW50bWVudC1jYWxlbmRhci8iLCJzb3VyY2VzIjpbImxpYi92aWV3cy9kZXRhaWwtdmlldy5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUNBLE9BQU8sRUFBRSxTQUFTLEVBQUUsVUFBVSxFQUFFLFFBQVEsRUFBRSxLQUFLLEVBQVUsV0FBVyxFQUFnQixNQUFNLGVBQWUsQ0FBQztBQUMxRyxPQUFPLEVBQUUsMEJBQTBCLEVBQUUsTUFBTSxpQ0FBaUMsQ0FBQztBQThFN0UsTUFBTSxPQUFPLHNCQUFzQjs7Ozs7O0lBK0IvQixZQUFvQixRQUFrQixFQUFVLEdBQStCLEVBQVMsRUFBYztRQUFsRixhQUFRLEdBQVIsUUFBUSxDQUFVO1FBQVUsUUFBRyxHQUFILEdBQUcsQ0FBNEI7UUFBUyxPQUFFLEdBQUYsRUFBRSxDQUFZOzs7O1FBM0I3RixhQUFRLEdBQWtDLElBQUksQ0FBQzs7OztRQVEvQyxpQkFBWSxHQUFHLElBQUksQ0FBQzs7OztRQUlwQixzQkFBaUIsR0FBRyxJQUFJLENBQUM7UUFFekIsY0FBUyxHQUFnQyxJQUFJLENBQUM7UUFFOUMsbUJBQWMsR0FBRyxJQUFJLENBQUM7UUFDdEIscUJBQWdCLEdBQUcsSUFBSSxDQUFDO1FBQ3hCLG9CQUFlLEdBQUcsSUFBSSxDQUFDO1FBR3ZCLHNCQUFpQixHQUFHLEVBQUUsQ0FBQztRQUV2QixnQkFBVyxHQUFHLEVBQUUsQ0FBQztRQUUxQixpQkFBWSxHQUFHLE1BQU0sQ0FBQztJQUVvRixDQUFDOzs7O0lBRTNHLFFBQVE7UUFDSixJQUFJLENBQUMsWUFBWSxHQUFHLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxRQUFRLElBQUksSUFBSSxDQUFDLGlCQUFpQixDQUFDLElBQUksQ0FBQztJQUN2RixDQUFDOzs7Ozs7SUFHRCxlQUFlLENBQUMsTUFBa0IsRUFBRSxDQUFDO1FBQ2pDLE1BQU0s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TCxLQUFLO3dCQUVMLEtBQUs7Z0NBRUwsS0FBSzt3QkFFTCxLQUFLOzZCQUVMLEtBQUs7K0JBQ0wsS0FBSzs4QkFDTCxLQUFLOzZCQUNMLEtBQUs7Z0NBRUwsS0FBSzswQkFFTCxLQUFLOzs7Ozs7O0lBekJOLHNDQUFtQjs7Ozs7SUFFbkIsMENBQXdEOzs7OztJQUV4RCx5Q0FBcUM7Ozs7O0lBRXJDLGdEQUEwQzs7Ozs7SUFFMUMsK0NBQXlDOzs7OztJQUV6Qyw4Q0FBNkI7Ozs7O0lBRTdCLDJDQUF3Qjs7Ozs7SUFFeEIsbURBQWtDOztJQUVsQywyQ0FBdUQ7O0lBRXZELGdEQUErQjs7SUFDL0Isa0RBQWlDOztJQUNqQyxpREFBZ0M7O0lBQ2hDLGdEQUFvRDs7SUFFcEQsbURBQWdDOztJQUVoQyw2Q0FBMEI7O0lBRTFCLDhDQUFzQjs7Ozs7SUFFViwwQ0FBMEI7Ozs7O0lBQUUscUNBQXVDOztJQUFFLG9DQUFxQiIsInNvdXJjZXNDb250ZW50IjpbIlxyXG5pbXBvcnQgeyBDb21wb25lbnQsIEVsZW1lbnRSZWYsIEluamVjdG9yLCBJbnB1dCwgT25Jbml0LCBUZW1wbGF0ZVJlZiwgRXZlbnRFbWl0dGVyIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IEFwcG9pbnRtZW50Q2FsZW5kYXJTZXJ2aWNlIH0gZnJvbSAnLi4vYXBwb2ludG1lbnQtY2FsZW5kYXIuc2VydmljZSc7XHJcbmltcG9ydCB7IERldGFpbENvbHVtbiwgRGV0YWlsVG9vbGJhckJ1dHRvbiB9IGZyb20gJy4uL21vZGVscy9jYWxlbmRheS50eXBlcyc7XHJcblxyXG5AQ29tcG9uZW50KHtcclxuICAgIHNlbGVjdG9yOiAncmVzZXJ2ZS1kZXRhaWwnLFxyXG4gICAgdGVtcGxhdGU6IGBcclxuICAgICAgPGRpdiBjbGFzcz1cInJlc2VydmUtZGV0YWlsLWNvbnRhaW5lclwiIHN0eWxlPVwicG9zaXRpb246IGZpeGVkOyB6LWluZGV4OiA5OVwiIFtzdHlsZS5sZWZ0LnB4XT1cInBvc2l0aW9uPy5sZWZ0XCIgW3N0eWxlLnRvcC5weF09XCJwb3NpdGlvbj8udG9wXCI+XHJcbiAgICAgICAgPGRpdiBjbGFzcz1cImRldGFpbC1oZWFkZXJcIiBbbmdDbGFzc109XCJnZXRDdXN0b21DbHMoKVwiIFtuZ1N0eWxlXT1cImdldEN1c3RvbUNscygnc3R5bGVzJylcIj5cclxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cImRldGFpbC10b29sYmFyXCIgKm5nSWY9XCIhdG9vbGJhckJ1dHRvbnMgfHwgIXRvb2xiYXJCdXR0b25zLmxlbmd0aFwiPlxyXG4gICAgICAgICAgICAgICAgPHNwYW4gKm5nSWY9XCJzaG93RWRpdEJ1dHRvblwiIGNsYXNzPVwiZi1pY29uIGYtaWNvbiBmLWljb24tbmV3LWVkaXRcIiB0aXRsZT1cInt7ICdhcHBvaW50bWVudC5kZXRhaWwuZWRpdCcgfCBsb2NhbGUgfX1cIiAoY2xpY2spPVwidG9vbGJhckJ0bkNsaWNrKCRldmVudCwgJ2VkaXQnKVwiPjwvc3Bhbj5cclxuICAgICAgICAgICAgICAgIDxzcGFuICpuZ0lmPVwic2hvd0RlbGV0ZUJ1dHRvblwiIGNsYXNzPVwiZi1pY29uIGYtaWNvbi10cmFzaFwiIHRpdGxlPVwie3sgJ2FwcG9pbnRtZW50LmRldGFpbC5kZWwnIHwgbG9jYWxlIH19XCIgKGNsaWNrKT1cInRvb2xiYXJCdG5DbGljaygkZXZlbnQsICdkZWwnKVwiPjwvc3Bhbj5cclxuICAgICAgICAgICAgICAgIDxzcGFuICpuZ0lmPVwic2hvd0Nsb3NlQnV0dG9uXCIgY2xhc3M9XCJmLWljb24gZi1pY29uLWNsb3NlXCIgdGl0bGU9XCJ7eyAnYXBwb2ludG1lbnQuZGV0YWlsLmNsb3NlJyB8IGxvY2FsZSB9fVwiIChjbGljayk9XCJ0b29sYmFyQnRuQ2xpY2soJGV2ZW50LCAnY2xvc2UnKVwiPjwvc3Bhbj5cclxuICAgICAgICAgICAgPC9kaXY+XHJcblxyXG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwiZGV0YWlsLXRvb2xiYXJcIiAqbmdJZj1cInRvb2xiYXJCdXR0b25zICYmIHRvb2xiYXJCdXR0b25zLmxlbmd0aFwiPlxyXG4gICAgICAgICAgICAgICAgPHNwYW4gKm5nRm9yPVwibGV0IGJ0biBvZiB0b29sYmFyQnV0dG9uc1wiIGNsYXNzPVwie3sgYnRuLmljb24gfX1cIiB0aXRsZT1cInt7IGJ0bi50aXRsZSB9fVwiIFtzdHlsZS5kaXNwbGF5XT1cImJ0bi52aXNpYmxlID8gJyc6ICdub25lJ1wiXHJcbiAgICAgICAgICAgICAgICAgICAgKGNsaWNrKT1cIiFidG4uZGlzYWJsZSAmJiBidG4uaGFuZGxlciAmJiBidG4uaGFuZGxlcih7IGl0ZW06IGRhdGEsICRldmVudDogJGV2ZW50IH0pXCI+PC9zcGFuPlxyXG4gICAgICAgICAgICAgICAgPHNwYW4gKm5nSWY9XCJzaG93Q2xvc2VCdXR0b25cIiBjbGFzcz1cImYtaWNvbiBmLWljb24tY2xvc2VcIiB0aXRsZT1cInt7ICdhcHBvaW50bWVudC5kZXRhaWwuY2xvc2UnIHwgbG9jYWxlIH19XCIgKGNsaWNrKT1cInRvb2xiYXJCdG5DbGljaygkZXZlbnQsICdjbG9zZScpXCI+PC9zcGFuPlxyXG4gICAgICAgICAgICA8L2Rpdj5cclxuXHJcbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJkZXRhaWwtdGl0bGVcIj5cclxuIFxyXG4gICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9XCJkZXRhaWwtcGxhY2VcIj5cclxuICAgICAgICAgICAgICAgICAgICB7e3Jvb05hbWVGaWVsZCB8IGdldHZhbHVlOiBwbGFjZUluZm99fVxyXG4gICAgICAgICAgICAgICAgPC9zcGFuPlxyXG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cInRpdGxlLWNvbnRlbnRcIiBzdHlsZT0nd29yZC1icmVhazpicmVhay1hbGw7IGZvbnQtZmFtaWx5Oi1hcHBsZS1zeXN0ZW0sQmxpbmtNYWNTeXN0ZW1Gb250LFwiU2Vnb2UgVUlcIixcIlBpbmdGYW5nIFNDXCIsXCJIaXJhZ2lubyBTYW5zIEdCXCIsXCJNaWNyb3NvZnQgWWFIZWlcIixcIkhlbHZldGljYSBOZXVlXCIsSGVsdmV0aWNhLEFyaWFsLHNhbnMtc2VyaWYnIHRpdGxlPVwie3tmaWVsZENvbmZpZ3MudGl0bGV9fVwiPlxyXG4gICAgICAgICAgICAgICAgICAgIHt7c3ViU3RyTnVtKGZpZWxkQ29uZmlncy50aXRsZSB8IGdldHZhbHVlOiBkYXRhLCB0aXRsZUxlbmd0aCl9fVxyXG4gICAgICAgICAgICAgICAgICAgIDwhLS0gPHNwYW4gY2xhc3M9XCJkZXRhaWwtbGFiZWxcIj7kuJPpobnkvJrorq48L3NwYW4+IC0tPlxyXG4gICAgICAgICAgICAgICAgICAgIDxuZy1jb250YWluZXIgW25nVGVtcGxhdGVPdXRsZXRdPVwiYmFkZ2VUZW1wbGF0ZVwiIFtuZ1RlbXBsYXRlT3V0bGV0Q29udGV4dF09XCJ7ICRpbXBsaWNpdDoge2RhdGE6IGRhdGF9LCBpdGVtOiBkYXRhIH1cIj48L25nLWNvbnRhaW5lcj5cclxuICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cImRldGFpbC10aW1lclwiPlxyXG4gICAgICAgICAgICAgICAgICAgIHt7IGZpZWxkQ29uZmlncy5zdGFydERhdGV8IGdldHZhbHVlOiBkYXRhIHwgZGF0ZWZvcm1hdDogKCdhcHBvaW50bWVudC5kZXRhaWwuZGF0ZUZvcm1hdCd8bG9jYWxlKSB9fSB7eyBmaWVsZENvbmZpZ3Muc3RhcnREYXRlfCBnZXR2YWx1ZTogZGF0YSB8IGRhdGVmb3JtYXQ6ICdISDptbScgfX0gXHJcbiAgICAgICAgICAgICAgICAgICAgJm5ic3A7LSZuYnNwO1xyXG4gICAgICAgICAgICAgICAgICAgIHt7IGZpZWxkQ29uZmlncy5lbmREYXRlIHwgZ2V0dmFsdWU6IGRhdGEgfCBkYXRlZm9ybWF0OiAoJ2FwcG9pbnRtZW50LmRldGFpbC5kYXRlRm9ybWF0J3xsb2NhbGUpIH19IHt7IGZpZWxkQ29uZmlncy5lbmREYXRlIHwgZ2V0dmFsdWU6IGRhdGEgfCBkYXRlZm9ybWF0OiAnSEg6bW0nIH19IFxyXG4gICAgICAgICAgICAgICAgICAgIDwhLS0gOeaciDTml6XvvIjku4rlpKnvvIkwODowMCDigJQgOeaciDfml6XvvIjlkajkuInvvIkxNzozMCAtLT5cclxuICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICA8L2Rpdj5cclxuICAgICAgICA8ZGl2IGNsYXNzPVwiZGV0YWlsLWluZm8tY29udGVudCAgd2luMTFTY3JvbGwgbm9idG5cIiBbbmdTdHlsZV09XCJnZXRDdXN0b21DbHMoJ2RldGFpbCcpXCI+XHJcbiAgICAgICAgICAgIDxuZy1jb250YWluZXIgW25nVGVtcGxhdGVPdXRsZXRdPVwiZGV0YWlsVGVtcGxhdGVcIiBbbmdUZW1wbGF0ZU91dGxldENvbnRleHRdPVwieyAkaW1wbGljaXQ6IHtkYXRhOiBkYXRhfSwgaXRlbTogZGF0YSB9XCI+PC9uZy1jb250YWluZXI+XHJcbiAgICAgICAgICAgIDx1bCAqbmdJZj1cIiFkZXRhaWxUZW1wbGF0ZVwiPlxyXG4gICAgICAgICAgICAgICAgPGxpICpuZ0Zvcj1cImxldCBjb2wgb2YgY29sdW1uc1wiPlxyXG4gICAgICAgICAgICAgICAgICAgIDxuZy1jb250YWluZXIgKm5nSWY9XCIhY29sLnRlbXBsYXRlXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPVwiZGV0YWlsLXN1YnRpdGxlXCIgW3N0eWxlLndpZHRoLnB4XT1cImRldGFpbENvbHVtbldpZHRoXCIgW3N0eWxlLm1pbldpZHRoLnB4XT1cImRldGFpbENvbHVtbldpZHRoXCIgW3RpdGxlXT1cImNvbC50aXRsZVwiPnt7Y29sLnRpdGxlfX08L3NwYW4+IFxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz1cImRldGFpbC1jb250ZW50ICBkLWZsZXggZmxleC1yb3dcIiAqbmdJZj1cIiFjb2wuZm9ybWF0dGVyXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz1cImNvbG9uXCI+PC9zcGFuPiAgICBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPVwidGV4dFwiPnt7IGNvbC5maWVsZCB8IGdldHZhbHVlOiBkYXRhOiB0cnVlfX08L3NwYW4+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDwvc3Bhbj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9XCJkZXRhaWwtY29udGVudCAgZC1mbGV4IGZsZXgtcm93XCIgKm5nSWY9XCJjb2wuZm9ybWF0dGVyXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz1cImNvbG9uXCI+PC9zcGFuPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9XCJ0ZXh0XCIgW2lubmVySHRtbF09XCIgY29sLmZpZWxkIHwgZ2V0dmFsdWU6IGRhdGEgfCBjb2x1bW5mb3JtYXR0ZXI6IGNvbCA6IGRhdGEgfCBzYWZlOiAnaHRtbCdcIj48L3NwYW4+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDwvc3Bhbj5cclxuICAgICAgICAgICAgICAgICAgICA8L25nLWNvbnRhaW5lcj5cclxuICAgICAgICAgICAgICAgICAgICA8bmctY29udGFpbmVyICpuZ0lmPVwiY29sLnRlbXBsYXRlXCIgIFtuZ1RlbXBsYXRlT3V0bGV0XT1cImNvbC50ZW1wbGF0ZVwiIFtuZ1RlbXBsYXRlT3V0bGV0Q29udGV4dF09XCJ7ICRpbXBsaWNpdDoge2RhdGE6IGRhdGEsIGZpZWxkOiBjb2wuZmllbGQsIGxhYmVsOiBjb2wudGl0bGV9LCBpdGVtOiBkYXRhIH1cIj5cclxuICAgICAgICAgICAgICAgICAgICA8L25nLWNvbnRhaW5lcj5cclxuICAgICAgICAgICAgICAgIDwvbGk+XHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgPC91bD5cclxuICAgICAgICA8L2Rpdj5cclxuICAgIDwvZGl2PlxyXG5cclxuICAgIGAsXHJcbiAgICBzdHlsZXM6IFtcclxuICAgICAgICBgXHJcbiAgICAgICAgICAgIC5kZXRhaWwtc3VidGl0bGUge1xyXG4gICAgICAgICAgICAgICB0ZXh0LWFsaWduOiBqdXN0aWZ5O3RleHQtYWxpZ24tbGFzdDoganVzdGlmeTt3aGl0ZS1zcGFjZTogbm93cmFwO292ZXJmbG93OiBoaWRkZW47dGV4dC1vdmVyZmxvdzogZWxsaXBzaXM7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLmRldGFpbC1jb250ZW50Pi5jb2xvbjpiZWZvcmUge1xyXG4gICAgICAgICAgICAgICAgY29udGVudDogJ++8midcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgLmRldGFpbC1jb250ZW50Pi50ZXh0IHtcclxuICAgICAgICAgICAgICAgIHdvcmQtYnJlYWs6IGJyZWFrLWFsbDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIGBcclxuICAgIF1cclxufSlcclxuXHJcbmV4cG9ydCBjbGFzcyBSZXNlcnZlRGV0YWlsQ29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0IHtcclxuICAgIC8qKiDpooTlrprmlbDmja4gKi9cclxuICAgIEBJbnB1dCgpIGRhdGE6IGFueTtcclxuICAgIC8qKiDlvLnlh7rpnaLmnb/kvY3nva4gKi9cclxuICAgIEBJbnB1dCgpIHBvc2l0aW9uOiB7IGxlZnQ6IG51bWJlciwgdG9wOiBudW1iZXIgfSA9IG51bGw7XHJcbiAgICAvKiog6aKE5a6a6K+m5oOF5a2X5q61ICovXHJcbiAgICBASW5wdXQoKSBjb2x1bW5zOiBBcnJheTxEZXRhaWxDb2x1bW4+XHJcbiAgICAvKiog6aKE5a6a6K+m5oOF5qih5p2/ICovXHJcbiAgICBASW5wdXQoKSBkZXRhaWxUZW1wbGF0ZTogVGVtcGxhdGVSZWY8YW55PjtcclxuICAgIC8qKiDlvr3nq6DmorDmnb8gKi9cclxuICAgIEBJbnB1dCgpIGJhZGdlVGVtcGxhdGU6IFRlbXBsYXRlUmVmPGFueT47XHJcbiAgICAvKiog6aKE5a6a5L+h5oGv5a2X5q616YWN572uICovXHJcbiAgICBASW5wdXQoKSBmaWVsZENvbmZpZ3MgPSBudWxsO1xyXG4gICAgLyoqIOmihOWumuWcsOeCueS/oeaBryAqL1xyXG4gICAgQElucHV0KCkgcGxhY2VJbmZvOiBhbnk7XHJcbiAgICAvKiog6aKE5a6a5Zyw54K55a2X5q616YWN572uICovXHJcbiAgICBASW5wdXQoKSBwbGFjZUZpZWxkQ29uZmlncyA9IG51bGw7XHJcblxyXG4gICAgQElucHV0KCkgY3VzdG9tQ2xzOiB7IFtjbGFzc05hbWU6c3RyaW5nXTogYW55IH0gPSBudWxsO1xyXG5cclxuICAgIEBJbnB1dCgpIHNob3dFZGl0QnV0dG9uID0gdHJ1ZTtcclxuICAgIEBJbnB1dCgpIHNob3dEZWxldGVCdXR0b24gPSB0cnVlO1xyXG4gICAgQElucHV0KCkgc2hvd0Nsb3NlQnV0dG9uID0gdHJ1ZTtcclxuICAgIEBJbnB1dCgpIHRvb2xiYXJCdXR0b25zOiBBcnJheTxEZXRhaWxUb29sYmFyQnV0dG9uPjtcclxuXHJcbiAgICBASW5wdXQoKSBkZXRhaWxDb2x1bW5XaWR0aCA9IDU2O1xyXG5cclxuICAgIEBJbnB1dCgpIHRpdGxlTGVuZ3RoID0gNTI7XHJcblxyXG4gICAgcm9vTmFtZUZpZWxkID0gJ25hbWUnO1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKHByaXZhdGUgaW5qZWN0b3I6IEluamVjdG9yLCBwcml2YXRlIHNlcjogQXBwb2ludG1lbnRDYWxlbmRhclNlcnZpY2UsIHB1YmxpYyBlbDogRWxlbWVudFJlZikgeyB9XHJcblxyXG4gICAgbmdPbkluaXQoKSB7XHJcbiAgICAgICAgdGhpcy5yb29OYW1lRmllbGQgPSB0aGlzLnBsYWNlRmllbGRDb25maWdzLmZ1bGxOYW1lIHx8IHRoaXMucGxhY2VGaWVsZENvbmZpZ3MubmFtZTtcclxuICAgIH1cclxuXHJcblxyXG4gICAgdG9vbGJhckJ0bkNsaWNrKCRldmVudDogTW91c2VFdmVudCwgdCkge1xyXG4gICAgICAgICRldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICB0aGlzLnNlci5jYXJkQnRuQ2xpY2skLm5leHQoeyAkZXZlbnQsIGFjdGlvbjogdCwgaXRlbTogdGhpcy5kYXRhIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIGdldEN1c3RvbUNscyh0eXA6ICdjbHMnIHwgJ3N0eWxlcycgfCAnZGV0YWlsJyA9ICdjbHMnKSB7XHJcbiAgICAgICAgbGV0IHJlc3VsdCA9IG51bGw7XHJcbiAgICAgICAgaWYgKHRoaXMuY3VzdG9tQ2xzKSB7XHJcbiAgICAgICAgICAgIGlmICghdGhpcy5jdXN0b21DbHNbJ2NscyddICYmICF0aGlzLmN1c3RvbUNsc1snY2xzJ10gJiYgdHlwID09ICdjbHMnKSB7XHJcbiAgICAgICAgICAgICAgICByZXN1bHQgPSB0aGlzLmN1c3RvbUNscztcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHJlc3VsdCA9IHRoaXMuY3VzdG9tQ2xzW3R5cF0gfHwge307XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIGlmICh0eXAgPT09ICdzdHlsZXMnIHx8IHR5cCA9PT0gJ2RldGFpbCcpIHtcclxuICAgICAgICAvLyAgICAgT2JqZWN0LmtleXMocmVzdWx0KS5mb3JFYWNoKChuOiBhbnkpID0+IHtcclxuICAgICAgICAvLyAgICAgICAgIGlmIChyZXN1bHRbbl0uaW5kZXhPZignaW1wb3J0YW50JykgPT09IC0xKSB7XHJcbiAgICAgICAgLy8gICAgICAgICAgICAgcmVzdWx0W25dID0gcmVzdWx0W25dICsnICFpbXBvcnRhbnQnIDtcclxuICAgICAgICAvLyAgICAgICAgIH1cclxuICAgICAgICAvLyAgICAgfSk7XHJcbiAgICAgICAgLy8gfVxyXG5cclxuICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgfVxyXG4gICAgZ2V0TGVuZ3RoKHN0cil7XHJcbiAgICAgICAgbGV0IHN0ckxlbmd0aD0wOyAvLyDorrDlvZVzdHLnmoTmgLvplb/luqZcclxuICAgICAgICBjb25zdCBMZW4gPSBzdHIubGVuZ3RoO1xyXG4gICAgICAgIGZvcihsZXQgaT0wO2k8TGVuO2krKyl7XHJcbiAgICAgICAgICAgIHZhciBjaGFyQ29kZSA9IHN0ci5jaGFyQ29kZUF0KGkpOy8vIOS9v+eUqGNoYXJDb2RlQXTov5Tlm57ljZXkuKrlrZfnrKbnmoRVbmljb2Rl57yW56CBXHJcbiAgICAgICAgICAgIGlmKGNoYXJDb2RlPj0wICYmIGNoYXJDb2RlPD0xMjgpe1xyXG4gICAgICAgICAgICAgICAgc3RyTGVuZ3RoKys7IC8v6Iux5paH5a2X56ym5YqgMVxyXG4gICAgICAgICAgICB9ZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBzdHJMZW5ndGg9IHN0ckxlbmd0aCsyOy8v5Lit5paH5a2X56ym5YqgMlxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBzdHJMZW5ndGg7XHJcbiAgICB9XHJcblxyXG4gICAgc3ViU3RyTnVtKHN0cixsZW4pIHtcclxuICAgICAgICBjb25zdCBzdHJMZW4gPSBzdHIubGVuZ3RoO1xyXG4gICAgICAgIGxldCBzdHJDdXQgPSAnJztcclxuICAgICAgICBsZXQgc3RyTGVuZ3RoID0wO1xyXG4gICAgICAgIGZvcihsZXQgaT0wO2k8c3RyTGVuO2krKyl7XHJcbiAgICAgICAgICAgIHZhciBjaGFyU3RyID0gc3RyLmNoYXJBdChpKTsgLy/kvb/nlKhjaGFyQXTojrflj5bljZXkuKrlrZfnrKbvvJtcclxuICAgICAgICAgICAgc3RyTGVuZ3RoKytcclxuICAgICAgICAgICAgaWYoZW5jb2RlVVJJKGNoYXJTdHIpLmxlbmd0aD40KXsgLy/kvb/nlKhlbmNvZGVVUknojrflj5bnvJbnoIHplb/luqZcclxuICAgICAgICAgICAgICAgIHN0ckxlbmd0aCsrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHN0ckN1dCA9IHN0ckN1dC5jb25jYXQoY2hhclN0cik7Ly/ljZXkuKrlrZfnrKbov5vooYzlkIjlubZcclxuICAgICAgICAgICAgaWYoc3RyTGVuZ3RoID49IGxlbil7XHJcbiAgICAgICAgICAgICAgICBzdHJDdXQgPSBzdHJDdXQuY29uY2F0KCcuLi4nKSAvL+Wkp+S6juaMh+WumumVv+W6puWQjuWQiOW5ticuLi4n5bm26L+U5Zue5q2k5a2X56ym5LiyXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gc3RyQ3V0O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmKHN0ckxlbmd0aDxsZW4pe1xyXG4gICAgICAgICAgICByZXR1cm4gc3RyO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufSJdfQ==