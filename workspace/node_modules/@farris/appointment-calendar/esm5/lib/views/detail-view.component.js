/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, ElementRef, Injector, Input, TemplateRef } from '@angular/core';
import { AppointmentCalendarService } from '../appointment-calendar.service';
var ReserveDetailComponent = /** @class */ (function () {
    function ReserveDetailComponent(injector, ser, el) {
        this.injector = injector;
        this.ser = ser;
        this.el = el;
        /**
         * 弹出面板位置
         */
        this.position = null;
        /**
         * 预定信息字段配置
         */
        this.fieldConfigs = null;
        /**
         * 预定地点字段配置
         */
        this.placeFieldConfigs = null;
        this.customCls = null;
        this.showEditButton = true;
        this.showDeleteButton = true;
        this.showCloseButton = true;
        this.detailColumnWidth = 56;
        this.titleLength = 52;
        this.rooNameField = 'name';
    }
    /**
     * @return {?}
     */
    ReserveDetailComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        this.rooNameField = this.placeFieldConfigs.fullName || this.placeFieldConfigs.name;
    };
    /**
     * @param {?} $event
     * @param {?} t
     * @return {?}
     */
    ReserveDetailComponent.prototype.toolbarBtnClick = /**
     * @param {?} $event
     * @param {?} t
     * @return {?}
     */
    function ($event, t) {
        $event.stopPropagation();
        this.ser.cardBtnClick$.next({ $event: $event, action: t, item: this.data });
    };
    /**
     * @param {?=} typ
     * @return {?}
     */
    ReserveDetailComponent.prototype.getCustomCls = /**
     * @param {?=} typ
     * @return {?}
     */
    function (typ) {
        if (typ === void 0) { typ = 'cls'; }
        /** @type {?} */
        var result = null;
        if (this.customCls) {
            if (!this.customCls['cls'] && !this.customCls['cls'] && typ == 'cls') {
                result = this.customCls;
            }
            else {
                result = this.customCls[typ] || {};
            }
        }
        // if (typ === 'styles' || typ === 'detail') {
        //     Object.keys(result).forEach((n: any) => {
        //         if (result[n].indexOf('important') === -1) {
        //             result[n] = result[n] +' !important' ;
        //         }
        //     });
        // }
        return result;
    };
    /**
     * @param {?} str
     * @return {?}
     */
    ReserveDetailComponent.prototype.getLength = /**
     * @param {?} str
     * @return {?}
     */
    function (str) {
        /** @type {?} */
        var strLength = 0;
        // 记录str的总长度
        /** @type {?} */
        var Len = str.length;
        for (var i = 0; i < Len; i++) {
            /** @type {?} */
            var charCode = str.charCodeAt(i);
            if (charCode >= 0 && charCode <= 128) {
                strLength++; //英文字符加1
            }
            else {
                strLength = strLength + 2; //中文字符加2
            }
        }
        return strLength;
    };
    /**
     * @param {?} str
     * @param {?} len
     * @return {?}
     */
    ReserveDetailComponent.prototype.subStrNum = /**
     * @param {?} str
     * @param {?} len
     * @return {?}
     */
    function (str, len) {
        /** @type {?} */
        var strLen = str.length;
        /** @type {?} */
        var strCut = '';
        /** @type {?} */
        var strLength = 0;
        for (var i = 0; i < strLen; i++) {
            /** @type {?} */
            var charStr = str.charAt(i);
            strLength++;
            if (encodeURI(charStr).length > 4) { //使用encodeURI获取编码长度
                strLength++;
            }
            strCut = strCut.concat(charStr); //单个字符进行合并
            if (strLength >= len) {
                strCut = strCut.concat('...'); //大于指定长度后合并'...'并返回此字符串
                return strCut;
            }
        }
        if (strLength < len) {
            return str;
        }
    };
    ReserveDetailComponent.decorators = [
        { type: Component, args: [{
                    selector: 'reserve-detail',
                    template: "\n      <div class=\"reserve-detail-container\" style=\"position: fixed; z-index: 99\" [style.left.px]=\"position?.left\" [style.top.px]=\"position?.top\">\n        <div class=\"detail-header\" [ngClass]=\"getCustomCls()\" [ngStyle]=\"getCustomCls('styles')\">\n            <div class=\"detail-toolbar\" *ngIf=\"!toolbarButtons || !toolbarButtons.length\">\n                <span *ngIf=\"showEditButton\" class=\"f-icon f-icon f-icon-new-edit\" title=\"{{ 'appointment.detail.edit' | locale }}\" (click)=\"toolbarBtnClick($event, 'edit')\"></span>\n                <span *ngIf=\"showDeleteButton\" class=\"f-icon f-icon-trash\" title=\"{{ 'appointment.detail.del' | locale }}\" (click)=\"toolbarBtnClick($event, 'del')\"></span>\n                <span *ngIf=\"showCloseButton\" class=\"f-icon f-icon-close\" title=\"{{ 'appointment.detail.close' | locale }}\" (click)=\"toolbarBtnClick($event, 'close')\"></span>\n            </div>\n\n            <div class=\"detail-toolbar\" *ngIf=\"toolbarButtons && toolbarButtons.length\">\n                <span *ngFor=\"let btn of toolbarButtons\" class=\"{{ btn.icon }}\" title=\"{{ btn.title }}\" [style.display]=\"btn.visible ? '': 'none'\"\n                    (click)=\"!btn.disable && btn.handler && btn.handler({ item: data, $event: $event })\"></span>\n                <span *ngIf=\"showCloseButton\" class=\"f-icon f-icon-close\" title=\"{{ 'appointment.detail.close' | locale }}\" (click)=\"toolbarBtnClick($event, 'close')\"></span>\n            </div>\n\n            <div class=\"detail-title\">\n \n                <span class=\"detail-place\">\n                    {{rooNameField | getvalue: placeInfo}}\n                </span>\n                <div class=\"title-content\" style='word-break:break-all; font-family:-apple-system,BlinkMacSystemFont,\"Segoe UI\",\"PingFang SC\",\"Hiragino Sans GB\",\"Microsoft YaHei\",\"Helvetica Neue\",Helvetica,Arial,sans-serif' title=\"{{fieldConfigs.title}}\">\n                    {{subStrNum(fieldConfigs.title | getvalue: data, titleLength)}}\n                    <!-- <span class=\"detail-label\">\u4E13\u9879\u4F1A\u8BAE</span> -->\n                    <ng-container [ngTemplateOutlet]=\"badgeTemplate\" [ngTemplateOutletContext]=\"{ $implicit: {data: data}, item: data }\"></ng-container>\n                </div>\n                <div class=\"detail-timer\">\n                    {{ fieldConfigs.startDate| getvalue: data | dateformat: ('appointment.detail.dateFormat'|locale) }} {{ fieldConfigs.startDate| getvalue: data | dateformat: 'HH:mm' }} \n                    &nbsp;-&nbsp;\n                    {{ fieldConfigs.endDate | getvalue: data | dateformat: ('appointment.detail.dateFormat'|locale) }} {{ fieldConfigs.endDate | getvalue: data | dateformat: 'HH:mm' }} \n                    <!-- 9\u67084\u65E5\uFF08\u4ECA\u5929\uFF0908:00 \u2014 9\u67087\u65E5\uFF08\u5468\u4E09\uFF0917:30 -->\n                </div>\n            </div>\n        </div>\n        <div class=\"detail-info-content  win11Scroll nobtn\" [ngStyle]=\"getCustomCls('detail')\">\n            <ng-container [ngTemplateOutlet]=\"detailTemplate\" [ngTemplateOutletContext]=\"{ $implicit: {data: data}, item: data }\"></ng-container>\n            <ul *ngIf=\"!detailTemplate\">\n                <li *ngFor=\"let col of columns\">\n                    <ng-container *ngIf=\"!col.template\">\n                        <span class=\"detail-subtitle\" [style.width.px]=\"detailColumnWidth\" [style.minWidth.px]=\"detailColumnWidth\" [title]=\"col.title\">{{col.title}}</span> \n                        <span class=\"detail-content  d-flex flex-row\" *ngIf=\"!col.formatter\">\n                            <span class=\"colon\"></span>    \n                            <span class=\"text\">{{ col.field | getvalue: data: true}}</span>\n                        </span>\n                        <span class=\"detail-content  d-flex flex-row\" *ngIf=\"col.formatter\">\n                            <span class=\"colon\"></span>\n                            <span class=\"text\" [innerHtml]=\" col.field | getvalue: data | columnformatter: col : data | safe: 'html'\"></span>\n                        </span>\n                    </ng-container>\n                    <ng-container *ngIf=\"col.template\"  [ngTemplateOutlet]=\"col.template\" [ngTemplateOutletContext]=\"{ $implicit: {data: data, field: col.field, label: col.title}, item: data }\">\n                    </ng-container>\n                </li>\n                \n            </ul>\n        </div>\n    </div>\n\n    ",
                    styles: ["\n            .detail-subtitle {\n               text-align: justify;text-align-last: justify;white-space: nowrap;overflow: hidden;text-overflow: ellipsis;\n            }\n            .detail-content>.colon:before {\n                content: '\uFF1A'\n            }\n\n            .detail-content>.text {\n                word-break: break-all;\n            }\n        "]
                }] }
    ];
    /** @nocollapse */
    ReserveDetailComponent.ctorParameters = function () { return [
        { type: Injector },
        { type: AppointmentCalendarService },
        { type: ElementRef }
    ]; };
    ReserveDetailComponent.propDecorators = {
        data: [{ type: Input }],
        position: [{ type: Input }],
        columns: [{ type: Input }],
        detailTemplate: [{ type: Input }],
        badgeTemplate: [{ type: Input }],
        fieldConfigs: [{ type: Input }],
        placeInfo: [{ type: Input }],
        placeFieldConfigs: [{ type: Input }],
        customCls: [{ type: Input }],
        showEditButton: [{ type: Input }],
        showDeleteButton: [{ type: Input }],
        showCloseButton: [{ type: Input }],
        toolbarButtons: [{ type: Input }],
        detailColumnWidth: [{ type: Input }],
        titleLength: [{ type: Input }]
    };
    return ReserveDetailComponent;
}());
export { ReserveDetailComponent };
if (false) {
    /**
     * 预定数据
     * @type {?}
     */
    ReserveDetailComponent.prototype.data;
    /**
     * 弹出面板位置
     * @type {?}
     */
    ReserveDetailComponent.prototype.position;
    /**
     * 预定详情字段
     * @type {?}
     */
    ReserveDetailComponent.prototype.columns;
    /**
     * 预定详情模板
     * @type {?}
     */
    ReserveDetailComponent.prototype.detailTemplate;
    /**
     * 徽章械板
     * @type {?}
     */
    ReserveDetailComponent.prototype.badgeTemplate;
    /**
     * 预定信息字段配置
     * @type {?}
     */
    ReserveDetailComponent.prototype.fieldConfigs;
    /**
     * 预定地点信息
     * @type {?}
     */
    ReserveDetailComponent.prototype.placeInfo;
    /**
     * 预定地点字段配置
     * @type {?}
     */
    ReserveDetailComponent.prototype.placeFieldConfigs;
    /** @type {?} */
    ReserveDetailComponent.prototype.customCls;
    /** @type {?} */
    ReserveDetailComponent.prototype.showEditButton;
    /** @type {?} */
    ReserveDetailComponent.prototype.showDeleteButton;
    /** @type {?} */
    ReserveDetailComponent.prototype.showCloseButton;
    /** @type {?} */
    ReserveDetailComponent.prototype.toolbarButtons;
    /** @type {?} */
    ReserveDetailComponent.prototype.detailColumnWidth;
    /** @type {?} */
    ReserveDetailComponent.prototype.titleLength;
    /** @type {?} */
    ReserveDetailComponent.prototype.rooNameField;
    /**
     * @type {?}
     * @private
     */
    ReserveDetailComponent.prototype.injector;
    /**
     * @type {?}
     * @private
     */
    ReserveDetailComponent.prototype.ser;
    /** @type {?} */
    ReserveDetailComponent.prototype.el;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGV0YWlsLXZpZXcuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGZhcnJpcy9hcHBvaW50bWVudC1jYWxlbmRhci8iLCJzb3VyY2VzIjpbImxpYi92aWV3cy9kZXRhaWwtdmlldy5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUNBLE9BQU8sRUFBRSxTQUFTLEVBQUUsVUFBVSxFQUFFLFFBQVEsRUFBRSxLQUFLLEVBQVUsV0FBVyxFQUFnQixNQUFNLGVBQWUsQ0FBQztBQUMxRyxPQUFPLEVBQUUsMEJBQTBCLEVBQUUsTUFBTSxpQ0FBaUMsQ0FBQztBQUc3RTtJQTBHSSxnQ0FBb0IsUUFBa0IsRUFBVSxHQUErQixFQUFTLEVBQWM7UUFBbEYsYUFBUSxHQUFSLFFBQVEsQ0FBVTtRQUFVLFFBQUcsR0FBSCxHQUFHLENBQTRCO1FBQVMsT0FBRSxHQUFGLEVBQUUsQ0FBWTs7OztRQTNCN0YsYUFBUSxHQUFrQyxJQUFJLENBQUM7Ozs7UUFRL0MsaUJBQVksR0FBRyxJQUFJLENBQUM7Ozs7UUFJcEIsc0JBQWlCLEdBQUcsSUFBSSxDQUFDO1FBRXpCLGNBQVMsR0FBZ0MsSUFBSSxDQUFDO1FBRTlDLG1CQUFjLEdBQUcsSUFBSSxDQUFDO1FBQ3RCLHFCQUFnQixHQUFHLElBQUksQ0FBQztRQUN4QixvQkFBZSxHQUFHLElBQUksQ0FBQztRQUd2QixzQkFBaUIsR0FBRyxFQUFFLENBQUM7UUFFdkIsZ0JBQVcsR0FBRyxFQUFFLENBQUM7UUFFMUIsaUJBQVksR0FBRyxNQUFNLENBQUM7SUFFb0YsQ0FBQzs7OztJQUUzRyx5Q0FBUTs7O0lBQVI7UUFDSSxJQUFJLENBQUMsWUFBWSxHQUFHLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxRQUFRLElBQUksSUFBSSxDQUFDLGlCQUFpQixDQUFDLElBQUksQ0FBQztJQUN2RixDQUFDOzs7Ozs7SUFHRCxnREFBZTs7Ozs7SUFBZixVQUFnQixNQUFrQixFQUFFLENBQUM7UUFDakMsTUFBTSxDQUFDLGVBQWUsRUFBRSxDQUFDO1FBQ3pCLElBQUksQ0FBQyxHQUFHLENBQUMsYUFBYSxDQUFDLElBQUksQ0FBQyxFQUFFLE1BQU0sUUFBQSxFQUFFLE1BQU0sRUFBRSxDQUFDLEVBQUUsSUFBSSxFQUFFLElBQUksQ0FBQyxJQUFJLEVBQUUsQ0FBQyxDQUFDO0lBQ3hFLENBQUM7Ozs7O0lBRUQsNkNBQVk7Ozs7SUFBWixVQUFhLEdBQXdDO1FBQXhDLG9CQUFBLEVBQUEsV0FBd0M7O1lBQzdDLE1BQU0sR0FBRyxJQUFJO1FBQ2pCLElBQUksSUFBSSxDQUFDLFNBQVMsRUFBRTtZQUNoQixJQUFJLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUMsS0FBSyxDQUFDLElBQUksR0FBRyxJQUFJLEtBQUssRUFBRTtnQkFDbEUsTUFBTSxHQUFHLElBQUksQ0FBQyxTQUFTLENBQUM7YUFDM0I7aUJBQU07Z0JBQ0gsTUFBTSxHQUFHLElBQUksQ0FBQyxTQUFTLENBQUMsR0FBRyxDQUFDLElBQUksRUFBRSxDQUFDO2FBQ3RDO1NBQ0o7UUFFRCw4Q0FBOEM7UUFDOUMsZ0RBQWdEO1FBQ2hELHVEQUF1RDtRQUN2RCxxREFBcUQ7UUFDckQsWUFBWTtRQUNaLFVBQVU7UUFDVixJQUFJO1FBRUosT0FBTyxNQUFNLENBQUM7SUFDbEIsQ0FBQzs7Ozs7SUFDRCwwQ0FBUzs7OztJQUFULFVBQVUsR0FBRzs7WUFDTCxTQUFTLEdBQUMsQ0FBQzs7O1lBQ1QsR0FBRyxHQUFHLEdBQUcsQ0FBQyxNQUFNO1FBQ3RCLEtBQUksSUFBSSxDQUFDLEdBQUMsQ0FBQyxFQUFDLENBQUMsR0FBQyxHQUFHLEVBQUMsQ0FBQyxFQUFFLEVBQUM7O2dCQUNkLFFBQVEsR0FBRyxHQUFHLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQztZQUNoQyxJQUFHLFFBQVEsSUFBRSxDQUFDLElBQUksUUFBUSxJQUFFLEdBQUcsRUFBQztnQkFDNUIsU0FBUyxFQUFFLENBQUMsQ0FBQyxRQUFRO2FBQ3hCO2lCQUFLO2dCQUNGLFNBQVMsR0FBRSxTQUFTLEdBQUMsQ0FBQyxDQUFDLENBQUEsUUFBUTthQUNsQztTQUNKO1FBQ0QsT0FBTyxTQUFTLENBQUM7SUFDckIsQ0FBQzs7Ozs7O0lBRUQsMENBQVM7Ozs7O0lBQVQsVUFBVSxHQUFHLEVBQUMsR0FBRzs7WUFDUCxNQUFNLEdBQUcsR0FBRyxDQUFDLE1BQU07O1lBQ3JCLE1BQU0sR0FBRyxFQUFFOztZQUNYLFNBQVMsR0FBRSxDQUFDO1FBQ2hCLEtBQUksSUFBSSxDQUFDLEdBQUMsQ0FBQyxFQUFDLENBQUMsR0FBQyxNQUFNLEVBQUMsQ0FBQyxFQUFFLEVBQUM7O2dCQUNqQixPQUFPLEdBQUcsR0FBRyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUM7WUFDM0IsU0FBUyxFQUFFLENBQUE7WUFDWCxJQUFHLFNBQVMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxNQUFNLEdBQUMsQ0FBQyxFQUFDLEVBQUUsbUJBQW1CO2dCQUNoRCxTQUFTLEVBQUUsQ0FBQzthQUNmO1lBQ0QsTUFBTSxHQUFHLE1BQU0sQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQSxVQUFVO1lBQzFDLElBQUcsU0FBUyxJQUFJLEdBQUcsRUFBQztnQkFDaEIsTUFBTSxHQUFHLE1BQU0sQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLENBQUEsQ0FBQyx1QkFBdUI7Z0JBQ3JELE9BQU8sTUFBTSxDQUFDO2FBQ2pCO1NBQ0o7UUFDRCxJQUFHLFNBQVMsR0FBQyxHQUFHLEVBQUM7WUFDYixPQUFPLEdBQUcsQ0FBQztTQUNkO0lBQ0wsQ0FBQzs7Z0JBM0tKLFNBQVMsU0FBQztvQkFDUCxRQUFRLEVBQUUsZ0JBQWdCO29CQUMxQixRQUFRLEVBQUUsaThJQXdEVDs2QkFFRyxtWEFXQztpQkFFUjs7OztnQkE3RStCLFFBQVE7Z0JBQy9CLDBCQUEwQjtnQkFEZixVQUFVOzs7dUJBaUZ6QixLQUFLOzJCQUVMLEtBQUs7MEJBRUwsS0FBSztpQ0FFTCxLQUFLO2dDQUVMLEtBQUs7K0JBRUwsS0FBSzs0QkFFTCxLQUFLO29DQUVMLEtBQUs7NEJBRUwsS0FBSztpQ0FFTCxLQUFLO21DQUNMLEtBQUs7a0NBQ0wsS0FBSztpQ0FDTCxLQUFLO29DQUVMLEtBQUs7OEJBRUwsS0FBSzs7SUFzRVYsNkJBQUM7Q0FBQSxBQTVLRCxJQTRLQztTQWpHWSxzQkFBc0I7Ozs7OztJQUUvQixzQ0FBbUI7Ozs7O0lBRW5CLDBDQUF3RDs7Ozs7SUFFeEQseUNBQXFDOzs7OztJQUVyQyxnREFBMEM7Ozs7O0lBRTFDLCtDQUF5Qzs7Ozs7SUFFekMsOENBQTZCOzs7OztJQUU3QiwyQ0FBd0I7Ozs7O0lBRXhCLG1EQUFrQzs7SUFFbEMsMkNBQXVEOztJQUV2RCxnREFBK0I7O0lBQy9CLGtEQUFpQzs7SUFDakMsaURBQWdDOztJQUNoQyxnREFBb0Q7O0lBRXBELG1EQUFnQzs7SUFFaEMsNkNBQTBCOztJQUUxQiw4Q0FBc0I7Ozs7O0lBRVYsMENBQTBCOzs7OztJQUFFLHFDQUF1Qzs7SUFBRSxvQ0FBcUIiLCJzb3VyY2VzQ29udGVudCI6WyJcclxuaW1wb3J0IHsgQ29tcG9uZW50LCBFbGVtZW50UmVmLCBJbmplY3RvciwgSW5wdXQsIE9uSW5pdCwgVGVtcGxhdGVSZWYsIEV2ZW50RW1pdHRlciB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBBcHBvaW50bWVudENhbGVuZGFyU2VydmljZSB9IGZyb20gJy4uL2FwcG9pbnRtZW50LWNhbGVuZGFyLnNlcnZpY2UnO1xyXG5pbXBvcnQgeyBEZXRhaWxDb2x1bW4sIERldGFpbFRvb2xiYXJCdXR0b24gfSBmcm9tICcuLi9tb2RlbHMvY2FsZW5kYXkudHlwZXMnO1xyXG5cclxuQENvbXBvbmVudCh7XHJcbiAgICBzZWxlY3RvcjogJ3Jlc2VydmUtZGV0YWlsJyxcclxuICAgIHRlbXBsYXRlOiBgXHJcbiAgICAgIDxkaXYgY2xhc3M9XCJyZXNlcnZlLWRldGFpbC1jb250YWluZXJcIiBzdHlsZT1cInBvc2l0aW9uOiBmaXhlZDsgei1pbmRleDogOTlcIiBbc3R5bGUubGVmdC5weF09XCJwb3NpdGlvbj8ubGVmdFwiIFtzdHlsZS50b3AucHhdPVwicG9zaXRpb24/LnRvcFwiPlxyXG4gICAgICAgIDxkaXYgY2xhc3M9XCJkZXRhaWwtaGVhZGVyXCIgW25nQ2xhc3NdPVwiZ2V0Q3VzdG9tQ2xzKClcIiBbbmdTdHlsZV09XCJnZXRDdXN0b21DbHMoJ3N0eWxlcycpXCI+XHJcbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJkZXRhaWwtdG9vbGJhclwiICpuZ0lmPVwiIXRvb2xiYXJCdXR0b25zIHx8ICF0b29sYmFyQnV0dG9ucy5sZW5ndGhcIj5cclxuICAgICAgICAgICAgICAgIDxzcGFuICpuZ0lmPVwic2hvd0VkaXRCdXR0b25cIiBjbGFzcz1cImYtaWNvbiBmLWljb24gZi1pY29uLW5ldy1lZGl0XCIgdGl0bGU9XCJ7eyAnYXBwb2ludG1lbnQuZGV0YWlsLmVkaXQnIHwgbG9jYWxlIH19XCIgKGNsaWNrKT1cInRvb2xiYXJCdG5DbGljaygkZXZlbnQsICdlZGl0JylcIj48L3NwYW4+XHJcbiAgICAgICAgICAgICAgICA8c3BhbiAqbmdJZj1cInNob3dEZWxldGVCdXR0b25cIiBjbGFzcz1cImYtaWNvbiBmLWljb24tdHJhc2hcIiB0aXRsZT1cInt7ICdhcHBvaW50bWVudC5kZXRhaWwuZGVsJyB8IGxvY2FsZSB9fVwiIChjbGljayk9XCJ0b29sYmFyQnRuQ2xpY2soJGV2ZW50LCAnZGVsJylcIj48L3NwYW4+XHJcbiAgICAgICAgICAgICAgICA8c3BhbiAqbmdJZj1cInNob3dDbG9zZUJ1dHRvblwiIGNsYXNzPVwiZi1pY29uIGYtaWNvbi1jbG9zZVwiIHRpdGxlPVwie3sgJ2FwcG9pbnRtZW50LmRldGFpbC5jbG9zZScgfCBsb2NhbGUgfX1cIiAoY2xpY2spPVwidG9vbGJhckJ0bkNsaWNrKCRldmVudCwgJ2Nsb3NlJylcIj48L3NwYW4+XHJcbiAgICAgICAgICAgIDwvZGl2PlxyXG5cclxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cImRldGFpbC10b29sYmFyXCIgKm5nSWY9XCJ0b29sYmFyQnV0dG9ucyAmJiB0b29sYmFyQnV0dG9ucy5sZW5ndGhcIj5cclxuICAgICAgICAgICAgICAgIDxzcGFuICpuZ0Zvcj1cImxldCBidG4gb2YgdG9vbGJhckJ1dHRvbnNcIiBjbGFzcz1cInt7IGJ0bi5pY29uIH19XCIgdGl0bGU9XCJ7eyBidG4udGl0bGUgfX1cIiBbc3R5bGUuZGlzcGxheV09XCJidG4udmlzaWJsZSA/ICcnOiAnbm9uZSdcIlxyXG4gICAgICAgICAgICAgICAgICAgIChjbGljayk9XCIhYnRuLmRpc2FibGUgJiYgYnRuLmhhbmRsZXIgJiYgYnRuLmhhbmRsZXIoeyBpdGVtOiBkYXRhLCAkZXZlbnQ6ICRldmVudCB9KVwiPjwvc3Bhbj5cclxuICAgICAgICAgICAgICAgIDxzcGFuICpuZ0lmPVwic2hvd0Nsb3NlQnV0dG9uXCIgY2xhc3M9XCJmLWljb24gZi1pY29uLWNsb3NlXCIgdGl0bGU9XCJ7eyAnYXBwb2ludG1lbnQuZGV0YWlsLmNsb3NlJyB8IGxvY2FsZSB9fVwiIChjbGljayk9XCJ0b29sYmFyQnRuQ2xpY2soJGV2ZW50LCAnY2xvc2UnKVwiPjwvc3Bhbj5cclxuICAgICAgICAgICAgPC9kaXY+XHJcblxyXG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwiZGV0YWlsLXRpdGxlXCI+XHJcbiBcclxuICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPVwiZGV0YWlsLXBsYWNlXCI+XHJcbiAgICAgICAgICAgICAgICAgICAge3tyb29OYW1lRmllbGQgfCBnZXR2YWx1ZTogcGxhY2VJbmZvfX1cclxuICAgICAgICAgICAgICAgIDwvc3Bhbj5cclxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJ0aXRsZS1jb250ZW50XCIgc3R5bGU9J3dvcmQtYnJlYWs6YnJlYWstYWxsOyBmb250LWZhbWlseTotYXBwbGUtc3lzdGVtLEJsaW5rTWFjU3lzdGVtRm9udCxcIlNlZ29lIFVJXCIsXCJQaW5nRmFuZyBTQ1wiLFwiSGlyYWdpbm8gU2FucyBHQlwiLFwiTWljcm9zb2Z0IFlhSGVpXCIsXCJIZWx2ZXRpY2EgTmV1ZVwiLEhlbHZldGljYSxBcmlhbCxzYW5zLXNlcmlmJyB0aXRsZT1cInt7ZmllbGRDb25maWdzLnRpdGxlfX1cIj5cclxuICAgICAgICAgICAgICAgICAgICB7e3N1YlN0ck51bShmaWVsZENvbmZpZ3MudGl0bGUgfCBnZXR2YWx1ZTogZGF0YSwgdGl0bGVMZW5ndGgpfX1cclxuICAgICAgICAgICAgICAgICAgICA8IS0tIDxzcGFuIGNsYXNzPVwiZGV0YWlsLWxhYmVsXCI+5LiT6aG55Lya6K6uPC9zcGFuPiAtLT5cclxuICAgICAgICAgICAgICAgICAgICA8bmctY29udGFpbmVyIFtuZ1RlbXBsYXRlT3V0bGV0XT1cImJhZGdlVGVtcGxhdGVcIiBbbmdUZW1wbGF0ZU91dGxldENvbnRleHRdPVwieyAkaW1wbGljaXQ6IHtkYXRhOiBkYXRhfSwgaXRlbTogZGF0YSB9XCI+PC9uZy1jb250YWluZXI+XHJcbiAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJkZXRhaWwtdGltZXJcIj5cclxuICAgICAgICAgICAgICAgICAgICB7eyBmaWVsZENvbmZpZ3Muc3RhcnREYXRlfCBnZXR2YWx1ZTogZGF0YSB8IGRhdGVmb3JtYXQ6ICgnYXBwb2ludG1lbnQuZGV0YWlsLmRhdGVGb3JtYXQnfGxvY2FsZSkgfX0ge3sgZmllbGRDb25maWdzLnN0YXJ0RGF0ZXwgZ2V0dmFsdWU6IGRhdGEgfCBkYXRlZm9ybWF0OiAnSEg6bW0nIH19IFxyXG4gICAgICAgICAgICAgICAgICAgICZuYnNwOy0mbmJzcDtcclxuICAgICAgICAgICAgICAgICAgICB7eyBmaWVsZENvbmZpZ3MuZW5kRGF0ZSB8IGdldHZhbHVlOiBkYXRhIHwgZGF0ZWZvcm1hdDogKCdhcHBvaW50bWVudC5kZXRhaWwuZGF0ZUZvcm1hdCd8bG9jYWxlKSB9fSB7eyBmaWVsZENvbmZpZ3MuZW5kRGF0ZSB8IGdldHZhbHVlOiBkYXRhIHwgZGF0ZWZvcm1hdDogJ0hIOm1tJyB9fSBcclxuICAgICAgICAgICAgICAgICAgICA8IS0tIDnmnIg05pel77yI5LuK5aSp77yJMDg6MDAg4oCUIDnmnIg35pel77yI5ZGo5LiJ77yJMTc6MzAgLS0+XHJcbiAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgPGRpdiBjbGFzcz1cImRldGFpbC1pbmZvLWNvbnRlbnQgIHdpbjExU2Nyb2xsIG5vYnRuXCIgW25nU3R5bGVdPVwiZ2V0Q3VzdG9tQ2xzKCdkZXRhaWwnKVwiPlxyXG4gICAgICAgICAgICA8bmctY29udGFpbmVyIFtuZ1RlbXBsYXRlT3V0bGV0XT1cImRldGFpbFRlbXBsYXRlXCIgW25nVGVtcGxhdGVPdXRsZXRDb250ZXh0XT1cInsgJGltcGxpY2l0OiB7ZGF0YTogZGF0YX0sIGl0ZW06IGRhdGEgfVwiPjwvbmctY29udGFpbmVyPlxyXG4gICAgICAgICAgICA8dWwgKm5nSWY9XCIhZGV0YWlsVGVtcGxhdGVcIj5cclxuICAgICAgICAgICAgICAgIDxsaSAqbmdGb3I9XCJsZXQgY29sIG9mIGNvbHVtbnNcIj5cclxuICAgICAgICAgICAgICAgICAgICA8bmctY29udGFpbmVyICpuZ0lmPVwiIWNvbC50ZW1wbGF0ZVwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz1cImRldGFpbC1zdWJ0aXRsZVwiIFtzdHlsZS53aWR0aC5weF09XCJkZXRhaWxDb2x1bW5XaWR0aFwiIFtzdHlsZS5taW5XaWR0aC5weF09XCJkZXRhaWxDb2x1bW5XaWR0aFwiIFt0aXRsZV09XCJjb2wudGl0bGVcIj57e2NvbC50aXRsZX19PC9zcGFuPiBcclxuICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9XCJkZXRhaWwtY29udGVudCAgZC1mbGV4IGZsZXgtcm93XCIgKm5nSWY9XCIhY29sLmZvcm1hdHRlclwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9XCJjb2xvblwiPjwvc3Bhbj4gICAgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz1cInRleHRcIj57eyBjb2wuZmllbGQgfCBnZXR2YWx1ZTogZGF0YTogdHJ1ZX19PC9zcGFuPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8L3NwYW4+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPVwiZGV0YWlsLWNvbnRlbnQgIGQtZmxleCBmbGV4LXJvd1wiICpuZ0lmPVwiY29sLmZvcm1hdHRlclwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9XCJjb2xvblwiPjwvc3Bhbj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPVwidGV4dFwiIFtpbm5lckh0bWxdPVwiIGNvbC5maWVsZCB8IGdldHZhbHVlOiBkYXRhIHwgY29sdW1uZm9ybWF0dGVyOiBjb2wgOiBkYXRhIHwgc2FmZTogJ2h0bWwnXCI+PC9zcGFuPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8L3NwYW4+XHJcbiAgICAgICAgICAgICAgICAgICAgPC9uZy1jb250YWluZXI+XHJcbiAgICAgICAgICAgICAgICAgICAgPG5nLWNvbnRhaW5lciAqbmdJZj1cImNvbC50ZW1wbGF0ZVwiICBbbmdUZW1wbGF0ZU91dGxldF09XCJjb2wudGVtcGxhdGVcIiBbbmdUZW1wbGF0ZU91dGxldENvbnRleHRdPVwieyAkaW1wbGljaXQ6IHtkYXRhOiBkYXRhLCBmaWVsZDogY29sLmZpZWxkLCBsYWJlbDogY29sLnRpdGxlfSwgaXRlbTogZGF0YSB9XCI+XHJcbiAgICAgICAgICAgICAgICAgICAgPC9uZy1jb250YWluZXI+XHJcbiAgICAgICAgICAgICAgICA8L2xpPlxyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIDwvdWw+XHJcbiAgICAgICAgPC9kaXY+XHJcbiAgICA8L2Rpdj5cclxuXHJcbiAgICBgLFxyXG4gICAgc3R5bGVzOiBbXHJcbiAgICAgICAgYFxyXG4gICAgICAgICAgICAuZGV0YWlsLXN1YnRpdGxlIHtcclxuICAgICAgICAgICAgICAgdGV4dC1hbGlnbjoganVzdGlmeTt0ZXh0LWFsaWduLWxhc3Q6IGp1c3RpZnk7d2hpdGUtc3BhY2U6IG5vd3JhcDtvdmVyZmxvdzogaGlkZGVuO3RleHQtb3ZlcmZsb3c6IGVsbGlwc2lzO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC5kZXRhaWwtY29udGVudD4uY29sb246YmVmb3JlIHtcclxuICAgICAgICAgICAgICAgIGNvbnRlbnQ6ICfvvJonXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC5kZXRhaWwtY29udGVudD4udGV4dCB7XHJcbiAgICAgICAgICAgICAgICB3b3JkLWJyZWFrOiBicmVhay1hbGw7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICBgXHJcbiAgICBdXHJcbn0pXHJcblxyXG5leHBvcnQgY2xhc3MgUmVzZXJ2ZURldGFpbENvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCB7XHJcbiAgICAvKiog6aKE5a6a5pWw5o2uICovXHJcbiAgICBASW5wdXQoKSBkYXRhOiBhbnk7XHJcbiAgICAvKiog5by55Ye66Z2i5p2/5L2N572uICovXHJcbiAgICBASW5wdXQoKSBwb3NpdGlvbjogeyBsZWZ0OiBudW1iZXIsIHRvcDogbnVtYmVyIH0gPSBudWxsO1xyXG4gICAgLyoqIOmihOWumuivpuaDheWtl+autSAqL1xyXG4gICAgQElucHV0KCkgY29sdW1uczogQXJyYXk8RGV0YWlsQ29sdW1uPlxyXG4gICAgLyoqIOmihOWumuivpuaDheaooeadvyAqL1xyXG4gICAgQElucHV0KCkgZGV0YWlsVGVtcGxhdGU6IFRlbXBsYXRlUmVmPGFueT47XHJcbiAgICAvKiog5b6956ug5qKw5p2/ICovXHJcbiAgICBASW5wdXQoKSBiYWRnZVRlbXBsYXRlOiBUZW1wbGF0ZVJlZjxhbnk+O1xyXG4gICAgLyoqIOmihOWumuS/oeaBr+Wtl+autemFjee9riAqL1xyXG4gICAgQElucHV0KCkgZmllbGRDb25maWdzID0gbnVsbDtcclxuICAgIC8qKiDpooTlrprlnLDngrnkv6Hmga8gKi9cclxuICAgIEBJbnB1dCgpIHBsYWNlSW5mbzogYW55O1xyXG4gICAgLyoqIOmihOWumuWcsOeCueWtl+autemFjee9riAqL1xyXG4gICAgQElucHV0KCkgcGxhY2VGaWVsZENvbmZpZ3MgPSBudWxsO1xyXG5cclxuICAgIEBJbnB1dCgpIGN1c3RvbUNsczogeyBbY2xhc3NOYW1lOnN0cmluZ106IGFueSB9ID0gbnVsbDtcclxuXHJcbiAgICBASW5wdXQoKSBzaG93RWRpdEJ1dHRvbiA9IHRydWU7XHJcbiAgICBASW5wdXQoKSBzaG93RGVsZXRlQnV0dG9uID0gdHJ1ZTtcclxuICAgIEBJbnB1dCgpIHNob3dDbG9zZUJ1dHRvbiA9IHRydWU7XHJcbiAgICBASW5wdXQoKSB0b29sYmFyQnV0dG9uczogQXJyYXk8RGV0YWlsVG9vbGJhckJ1dHRvbj47XHJcblxyXG4gICAgQElucHV0KCkgZGV0YWlsQ29sdW1uV2lkdGggPSA1NjtcclxuXHJcbiAgICBASW5wdXQoKSB0aXRsZUxlbmd0aCA9IDUyO1xyXG5cclxuICAgIHJvb05hbWVGaWVsZCA9ICduYW1lJztcclxuXHJcbiAgICBjb25zdHJ1Y3Rvcihwcml2YXRlIGluamVjdG9yOiBJbmplY3RvciwgcHJpdmF0ZSBzZXI6IEFwcG9pbnRtZW50Q2FsZW5kYXJTZXJ2aWNlLCBwdWJsaWMgZWw6IEVsZW1lbnRSZWYpIHsgfVxyXG5cclxuICAgIG5nT25Jbml0KCkge1xyXG4gICAgICAgIHRoaXMucm9vTmFtZUZpZWxkID0gdGhpcy5wbGFjZUZpZWxkQ29uZmlncy5mdWxsTmFtZSB8fCB0aGlzLnBsYWNlRmllbGRDb25maWdzLm5hbWU7XHJcbiAgICB9XHJcblxyXG5cclxuICAgIHRvb2xiYXJCdG5DbGljaygkZXZlbnQ6IE1vdXNlRXZlbnQsIHQpIHtcclxuICAgICAgICAkZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgdGhpcy5zZXIuY2FyZEJ0bkNsaWNrJC5uZXh0KHsgJGV2ZW50LCBhY3Rpb246IHQsIGl0ZW06IHRoaXMuZGF0YSB9KTtcclxuICAgIH1cclxuXHJcbiAgICBnZXRDdXN0b21DbHModHlwOiAnY2xzJyB8ICdzdHlsZXMnIHwgJ2RldGFpbCcgPSAnY2xzJykge1xyXG4gICAgICAgIGxldCByZXN1bHQgPSBudWxsO1xyXG4gICAgICAgIGlmICh0aGlzLmN1c3RvbUNscykge1xyXG4gICAgICAgICAgICBpZiAoIXRoaXMuY3VzdG9tQ2xzWydjbHMnXSAmJiAhdGhpcy5jdXN0b21DbHNbJ2NscyddICYmIHR5cCA9PSAnY2xzJykge1xyXG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gdGhpcy5jdXN0b21DbHM7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByZXN1bHQgPSB0aGlzLmN1c3RvbUNsc1t0eXBdIHx8IHt9O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBpZiAodHlwID09PSAnc3R5bGVzJyB8fCB0eXAgPT09ICdkZXRhaWwnKSB7XHJcbiAgICAgICAgLy8gICAgIE9iamVjdC5rZXlzKHJlc3VsdCkuZm9yRWFjaCgobjogYW55KSA9PiB7XHJcbiAgICAgICAgLy8gICAgICAgICBpZiAocmVzdWx0W25dLmluZGV4T2YoJ2ltcG9ydGFudCcpID09PSAtMSkge1xyXG4gICAgICAgIC8vICAgICAgICAgICAgIHJlc3VsdFtuXSA9IHJlc3VsdFtuXSArJyAhaW1wb3J0YW50JyA7XHJcbiAgICAgICAgLy8gICAgICAgICB9XHJcbiAgICAgICAgLy8gICAgIH0pO1xyXG4gICAgICAgIC8vIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgIH1cclxuICAgIGdldExlbmd0aChzdHIpe1xyXG4gICAgICAgIGxldCBzdHJMZW5ndGg9MDsgLy8g6K6w5b2Vc3Ry55qE5oC76ZW/5bqmXHJcbiAgICAgICAgY29uc3QgTGVuID0gc3RyLmxlbmd0aDtcclxuICAgICAgICBmb3IobGV0IGk9MDtpPExlbjtpKyspe1xyXG4gICAgICAgICAgICB2YXIgY2hhckNvZGUgPSBzdHIuY2hhckNvZGVBdChpKTsvLyDkvb/nlKhjaGFyQ29kZUF06L+U5Zue5Y2V5Liq5a2X56ym55qEVW5pY29kZee8lueggVxyXG4gICAgICAgICAgICBpZihjaGFyQ29kZT49MCAmJiBjaGFyQ29kZTw9MTI4KXtcclxuICAgICAgICAgICAgICAgIHN0ckxlbmd0aCsrOyAvL+iLseaWh+Wtl+espuWKoDFcclxuICAgICAgICAgICAgfWVsc2Uge1xyXG4gICAgICAgICAgICAgICAgc3RyTGVuZ3RoPSBzdHJMZW5ndGgrMjsvL+S4reaWh+Wtl+espuWKoDJcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gc3RyTGVuZ3RoO1xyXG4gICAgfVxyXG5cclxuICAgIHN1YlN0ck51bShzdHIsbGVuKSB7XHJcbiAgICAgICAgY29uc3Qgc3RyTGVuID0gc3RyLmxlbmd0aDtcclxuICAgICAgICBsZXQgc3RyQ3V0ID0gJyc7XHJcbiAgICAgICAgbGV0IHN0ckxlbmd0aCA9MDtcclxuICAgICAgICBmb3IobGV0IGk9MDtpPHN0ckxlbjtpKyspe1xyXG4gICAgICAgICAgICB2YXIgY2hhclN0ciA9IHN0ci5jaGFyQXQoaSk7IC8v5L2/55SoY2hhckF06I635Y+W5Y2V5Liq5a2X56ym77ybXHJcbiAgICAgICAgICAgIHN0ckxlbmd0aCsrXHJcbiAgICAgICAgICAgIGlmKGVuY29kZVVSSShjaGFyU3RyKS5sZW5ndGg+NCl7IC8v5L2/55SoZW5jb2RlVVJJ6I635Y+W57yW56CB6ZW/5bqmXHJcbiAgICAgICAgICAgICAgICBzdHJMZW5ndGgrKztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBzdHJDdXQgPSBzdHJDdXQuY29uY2F0KGNoYXJTdHIpOy8v5Y2V5Liq5a2X56ym6L+b6KGM5ZCI5bm2XHJcbiAgICAgICAgICAgIGlmKHN0ckxlbmd0aCA+PSBsZW4pe1xyXG4gICAgICAgICAgICAgICAgc3RyQ3V0ID0gc3RyQ3V0LmNvbmNhdCgnLi4uJykgLy/lpKfkuo7mjIflrprplb/luqblkI7lkIjlubYnLi4uJ+W5tui/lOWbnuatpOWtl+espuS4slxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHN0ckN1dDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBpZihzdHJMZW5ndGg8bGVuKXtcclxuICAgICAgICAgICAgcmV0dXJuIHN0cjtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn0iXX0=