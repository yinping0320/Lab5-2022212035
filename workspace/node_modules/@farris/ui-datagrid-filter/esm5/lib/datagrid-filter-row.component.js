/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { DatagridFilterRowService } from './datagrid-filter-row.service';
import { Component, Input, ElementRef, Renderer2, NgZone, Output, EventEmitter, Injector, ViewEncapsulation, ViewChildren, QueryList, ChangeDetectorRef } from '@angular/core';
import { FormGroup, FormBuilder } from '@angular/forms';
import { DatagridComponent } from '@farris/ui-datagrid';
import { FilterCellEditorDirective } from './datagrid-filter-cell-editor.directive';
var FilterRowComponent = /** @class */ (function () {
    function FilterRowComponent(fb, el, ngzone, cd, dfrs, render, inject) {
        var _this = this;
        this.fb = fb;
        this.el = el;
        this.ngzone = ngzone;
        this.cd = cd;
        this.dfrs = dfrs;
        this.render = render;
        this.inject = inject;
        this.fixedLeft = false;
        this.fixedRight = false;
        this.delay = 300;
        this.conditionChange = new EventEmitter();
        this.form = new FormGroup({});
        this.filterRowConditionsScribe = this.dfrs.filterRowConditions$.subscribe((/**
         * @param {?} ccs
         * @return {?}
         */
        function (ccs) {
            _this.conditionChange.emit(ccs);
        }));
    }
    /**
     * @return {?}
     */
    FilterRowComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this.form = this.createControl();
        this.ngzone.runOutsideAngular((/**
         * @return {?}
         */
        function () {
            _this.render.listen('document', 'click', (/**
             * @return {?}
             */
            function () {
                _this.dfrs.closeFilterPanel();
            }));
        }));
    };
    /**
     * @return {?}
     */
    FilterRowComponent.prototype.ngAfterViewInit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        /** @type {?} */
        var nativeEl = this.el.nativeElement;
        this.tr = nativeEl.parentElement;
        nativeEl.querySelectorAll('td').forEach((/**
         * @param {?} n
         * @return {?}
         */
        function (n) {
            _this.tr.append(n);
        }));
        nativeEl.style.display = 'none';
        this.dfrs.gridInstance = this.gridInstance;
    };
    /**
     * @return {?}
     */
    FilterRowComponent.prototype.ngOnDestroy = /**
     * @return {?}
     */
    function () {
        var _this = this;
        if (this.filterRowConditionsScribe) {
            this.filterRowConditionsScribe.unsubscribe();
            this.filterRowConditionsScribe = null;
        }
        if (this.tr) {
            /** @type {?} */
            var tds = this.tr.querySelectorAll('td');
            if (tds && tds.length) {
                tds.forEach((/**
                 * @param {?} a
                 * @return {?}
                 */
                function (a) {
                    if (!a.classList.contains('f-datagrid-header-checkbox') && !a.classList.contains('f-datagrid-cell-rownumber')) {
                        _this.tr.removeChild(a);
                    }
                }));
            }
        }
    };
    /**
     * @return {?}
     */
    FilterRowComponent.prototype.createControl = /**
     * @return {?}
     */
    function () {
        var _this = this;
        /** @type {?} */
        var group = this.fb.group({});
        this.columns.forEach((/**
         * @param {?} col
         * @return {?}
         */
        function (col) {
            if (col.colspan) {
                return;
            }
            /** @type {?} */
            var control = _this.fb.control('');
            group.addControl(col.field, control);
        }));
        return group;
    };
    /**
     * @param {?=} emitEvent
     * @return {?}
     */
    FilterRowComponent.prototype.clearFilterValue = /**
     * @param {?=} emitEvent
     * @return {?}
     */
    function (emitEvent) {
        if (emitEvent === void 0) { emitEvent = true; }
        // this.form.reset();
        this.editors.forEach((/**
         * @param {?} c
         * @return {?}
         */
        function (c) {
            c.clearValue();
        }));
        this.dfrs.clear(emitEvent);
    };
    /**
     * @param {?} field
     * @param {?=} opts
     * @return {?}
     */
    FilterRowComponent.prototype.removeField = /**
     * @param {?} field
     * @param {?=} opts
     * @return {?}
     */
    function (field, opts) {
        this.dfrs.removeFilterField(field, opts);
    };
    FilterRowComponent.decorators = [
        { type: Component, args: [{
                    selector: '[filter-row]',
                    template: "\r\n<!-- <td *ngIf=\"gridInstance.showCheckbox  && fixedLeft && gridInstance.enableDragColumn\"></td>\r\n<td *ngIf=\"gridInstance.showLineNumber && fixedLeft && gridInstance.enableDragColumn\"></td> -->\r\n<td *ngFor=\"let col of columns\" class=\"f-datagrid-header-cell f-datagrid-filter-td\" \r\n    style=\"text-align: center;\" [attr.id]=\"'filter-row_' + col.field \">\r\n    <ng-container filter-cell-editor [delay]=\"delay\" [gridInstance]=\"gridInstance\" [column]=\"col\" [group]=\"form\"></ng-container>\r\n</td>\r\n\r\n",
                    providers: [
                        DatagridFilterRowService
                    ],
                    encapsulation: ViewEncapsulation.None,
                    styles: [".filter-condition .list-group-item{padding:10px;background:#f8f8f8}.filter-condition .datalist{min-height:100px;max-height:200px;overflow:auto}.filter-condition .datalist::-webkit-scrollbar{width:15px;height:15px}.filter-condition .datalist::-webkit-scrollbar-thumb{background-color:#c2c2c2;border-radius:10px;background-clip:content-box}.filter-condition .datalist::-webkit-scrollbar-thumb:hover{background-color:#7d7d7d;border-radius:10px;background-clip:content-box}.filter-condition .datalist::-webkit-scrollbar-thumb:vertical,.filter-condition .datalist::-webkit-scrollbar-thumb:vertical:hover{border:3px solid transparent;border-left-width:4px}.filter-condition .datalist::-webkit-scrollbar-thumb:horizontal,.filter-condition .datalist::-webkit-scrollbar-thumb:horizontal:hover{border:3px solid transparent;border-top:4px solid transparent}.filter-condition .datalist::-webkit-scrollbar-track{background-color:#fafafa}.filter-condition .datalist::-webkit-scrollbar-track:vertical{border-left:1px solid #e8e8e8}.filter-condition .datalist::-webkit-scrollbar-track:horizontal{border-top:1px solid #e8e8e8}.filter-condition .datalist::-webkit-scrollbar-corner{background-color:#fafafa}.filter-condition farris-datalist .card{border:0}.filter-condition .card .list-group-item{padding-left:0;padding-right:0}.filter-condition .list-group-item.border-b1{border-bottom:1px solid #dde2eb!important;margin-bottom:0}.f-datagrid-filter-panel{background:#f8f8f8;position:absolute;z-index:999;box-shadow:0 1px 4px 1px rgba(186,191,199,.4);top:140px;left:1257px;width:200px;border-radius:3px;border:1px solid #babfc7}.f-datagrid-filter-panel .panel-header{height:36px;min-height:36px;border-bottom:1px solid #2196f3;text-align:center;line-height:36px;color:#2196f3}.f-datagrid-filter-td .filter-editor-disabled{color:rgba(24,29,31,.5);background-color:#f1f2f4;border-color:rgba(186,191,199,.3)}.f-datagrid-filter-td .filter-editor-disabled:hover{background-color:#f1f2f4}.f-datagrid-filter-td:hover{background-color:transparent}"]
                }] }
    ];
    /** @nocollapse */
    FilterRowComponent.ctorParameters = function () { return [
        { type: FormBuilder },
        { type: ElementRef },
        { type: NgZone },
        { type: ChangeDetectorRef },
        { type: DatagridFilterRowService },
        { type: Renderer2 },
        { type: Injector }
    ]; };
    FilterRowComponent.propDecorators = {
        fixedLeft: [{ type: Input }],
        fixedRight: [{ type: Input }],
        columns: [{ type: Input }],
        gridInstance: [{ type: Input }],
        delay: [{ type: Input }],
        conditionChange: [{ type: Output }],
        editors: [{ type: ViewChildren, args: [FilterCellEditorDirective,] }]
    };
    return FilterRowComponent;
}());
export { FilterRowComponent };
if (false) {
    /** @type {?} */
    FilterRowComponent.prototype.fixedLeft;
    /** @type {?} */
    FilterRowComponent.prototype.fixedRight;
    /** @type {?} */
    FilterRowComponent.prototype.columns;
    /**
     * datagrid Instance
     * @type {?}
     */
    FilterRowComponent.prototype.gridInstance;
    /** @type {?} */
    FilterRowComponent.prototype.delay;
    /** @type {?} */
    FilterRowComponent.prototype.conditionChange;
    /** @type {?} */
    FilterRowComponent.prototype.editors;
    /** @type {?} */
    FilterRowComponent.prototype.filterRowConditionsScribe;
    /** @type {?} */
    FilterRowComponent.prototype.form;
    /** @type {?} */
    FilterRowComponent.prototype.tr;
    /**
     * @type {?}
     * @private
     */
    FilterRowComponent.prototype.fb;
    /**
     * @type {?}
     * @private
     */
    FilterRowComponent.prototype.el;
    /**
     * @type {?}
     * @private
     */
    FilterRowComponent.prototype.ngzone;
    /**
     * @type {?}
     * @private
     */
    FilterRowComponent.prototype.cd;
    /** @type {?} */
    FilterRowComponent.prototype.dfrs;
    /**
     * @type {?}
     * @private
     */
    FilterRowComponent.prototype.render;
    /**
     * @type {?}
     * @private
     */
    FilterRowComponent.prototype.inject;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGF0YWdyaWQtZmlsdGVyLXJvdy5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZmFycmlzL3VpLWRhdGFncmlkLWZpbHRlci8iLCJzb3VyY2VzIjpbImxpYi9kYXRhZ3JpZC1maWx0ZXItcm93LmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7O0FBQ0EsT0FBTyxFQUFFLHdCQUF3QixFQUFFLE1BQU0sK0JBQStCLENBQUM7QUFDekUsT0FBTyxFQUFFLFNBQVMsRUFBVSxLQUFLLEVBQWlCLFVBQVUsRUFBRSxTQUFTLEVBQ25FLE1BQU0sRUFBRSxNQUFNLEVBQUUsWUFBWSxFQUFhLFFBQVEsRUFBRSxpQkFBaUIsRUFBRSxZQUFZLEVBQUUsU0FBUyxFQUFFLGlCQUFpQixFQUFFLE1BQU0sZUFBZSxDQUFDO0FBQzVJLE9BQU8sRUFBRSxTQUFTLEVBQUUsV0FBVyxFQUFFLE1BQU0sZ0JBQWdCLENBQUM7QUFDeEQsT0FBTyxFQUFjLGlCQUFpQixFQUFFLE1BQU0scUJBQXFCLENBQUM7QUFFcEUsT0FBTyxFQUFFLHlCQUF5QixFQUFFLE1BQU0seUNBQXlDLENBQUM7QUFFcEY7SUEyQkksNEJBQ1ksRUFBZSxFQUNmLEVBQWMsRUFDZCxNQUFjLEVBQ2QsRUFBcUIsRUFDdEIsSUFBOEIsRUFDN0IsTUFBaUIsRUFDakIsTUFBZ0I7UUFQNUIsaUJBV0s7UUFWTyxPQUFFLEdBQUYsRUFBRSxDQUFhO1FBQ2YsT0FBRSxHQUFGLEVBQUUsQ0FBWTtRQUNkLFdBQU0sR0FBTixNQUFNLENBQVE7UUFDZCxPQUFFLEdBQUYsRUFBRSxDQUFtQjtRQUN0QixTQUFJLEdBQUosSUFBSSxDQUEwQjtRQUM3QixXQUFNLEdBQU4sTUFBTSxDQUFXO1FBQ2pCLFdBQU0sR0FBTixNQUFNLENBQVU7UUF0Qm5CLGNBQVMsR0FBRyxLQUFLLENBQUM7UUFDbEIsZUFBVSxHQUFHLEtBQUssQ0FBQztRQUtuQixVQUFLLEdBQUcsR0FBRyxDQUFDO1FBRVgsb0JBQWUsR0FB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QzdCLGtDQUFxQzs7Ozs7SUFDckMsb0NBQXlCOzs7OztJQUN6QixvQ0FBd0IiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBTdWJzY3JpcHRpb24gfSBmcm9tICdyeGpzJztcclxuaW1wb3J0IHsgRGF0YWdyaWRGaWx0ZXJSb3dTZXJ2aWNlIH0gZnJvbSAnLi9kYXRhZ3JpZC1maWx0ZXItcm93LnNlcnZpY2UnO1xyXG5pbXBvcnQgeyBDb21wb25lbnQsIE9uSW5pdCwgSW5wdXQsIEFmdGVyVmlld0luaXQsIEVsZW1lbnRSZWYsIFJlbmRlcmVyMixcclxuICAgIE5nWm9uZSwgT3V0cHV0LCBFdmVudEVtaXR0ZXIsIE9uRGVzdHJveSwgSW5qZWN0b3IsIFZpZXdFbmNhcHN1bGF0aW9uLCBWaWV3Q2hpbGRyZW4sIFF1ZXJ5TGlzdCwgQ2hhbmdlRGV0ZWN0b3JSZWYgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgRm9ybUdyb3VwLCBGb3JtQnVpbGRlciB9IGZyb20gJ0Bhbmd1bGFyL2Zvcm1zJztcclxuaW1wb3J0IHsgRGF0YUNvbHVtbiwgRGF0YWdyaWRDb21wb25lbnQgfSBmcm9tICdAZmFycmlzL3VpLWRhdGFncmlkJztcclxuaW1wb3J0IHsgZGVib3VuY2UsIGRlYm91bmNlVGltZSwgZGlzdGluY3RVbnRpbENoYW5nZWQsIG1hcCB9IGZyb20gJ3J4anMvb3BlcmF0b3JzJztcclxuaW1wb3J0IHsgRmlsdGVyQ2VsbEVkaXRvckRpcmVjdGl2ZSB9IGZyb20gJy4vZGF0YWdyaWQtZmlsdGVyLWNlbGwtZWRpdG9yLmRpcmVjdGl2ZSc7XHJcblxyXG5AQ29tcG9uZW50KHtcclxuICAgIHNlbGVjdG9yOiAnW2ZpbHRlci1yb3ddJyxcclxuICAgIHRlbXBsYXRlVXJsOiAnLi9kYXRhZ3JpZC1maWx0ZXItcm93LmNvbXBvbmVudC5odG1sJyxcclxuICAgIHN0eWxlVXJsczogW1xyXG4gICAgICAgICcuL2RhdGFncmlkLWZpbHRlci1yb3cuc2NzcydcclxuICAgIF0sXHJcbiAgICBwcm92aWRlcnM6IFtcclxuICAgICAgICBEYXRhZ3JpZEZpbHRlclJvd1NlcnZpY2VcclxuICAgIF0sXHJcbiAgICBlbmNhcHN1bGF0aW9uOiBWaWV3RW5jYXBzdWxhdGlvbi5Ob25lXHJcbn0pXHJcbmV4cG9ydCBjbGFzcyBGaWx0ZXJSb3dDb21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQsIEFmdGVyVmlld0luaXQsIE9uRGVzdHJveSB7XHJcbiAgICBASW5wdXQoKSBmaXhlZExlZnQgPSBmYWxzZTtcclxuICAgIEBJbnB1dCgpIGZpeGVkUmlnaHQgPSBmYWxzZTtcclxuICAgIEBJbnB1dCgpIGNvbHVtbnM6IERhdGFDb2x1bW5bXTtcclxuICAgIC8qKiBkYXRhZ3JpZCBJbnN0YW5jZSAqL1xyXG4gICAgQElucHV0KCkgZ3JpZEluc3RhbmNlOiBEYXRhZ3JpZENvbXBvbmVudDtcclxuXHJcbiAgICBASW5wdXQoKSBkZWxheSA9IDMwMDtcclxuXHJcbiAgICBAT3V0cHV0KCkgY29uZGl0aW9uQ2hhbmdlID0gbmV3IEV2ZW50RW1pdHRlcigpO1xyXG5cclxuICAgIEBWaWV3Q2hpbGRyZW4oRmlsdGVyQ2VsbEVkaXRvckRpcmVjdGl2ZSkgZWRpdG9yczogUXVlcnlMaXN0PEZpbHRlckNlbGxFZGl0b3JEaXJlY3RpdmU+O1xyXG5cclxuICAgIGZpbHRlclJvd0NvbmRpdGlvbnNTY3JpYmU6IFN1YnNjcmlwdGlvbjtcclxuICAgIGZvcm0gPSBuZXcgRm9ybUdyb3VwKHt9KTtcclxuICAgIHRyOiBIVE1MVGFibGVSb3dFbGVtZW50O1xyXG4gICAgY29uc3RydWN0b3IoXHJcbiAgICAgICAgcHJpdmF0ZSBmYjogRm9ybUJ1aWxkZXIsXHJcbiAgICAgICAgcHJpdmF0ZSBlbDogRWxlbWVudFJlZixcclxuICAgICAgICBwcml2YXRlIG5nem9uZTogTmdab25lLFxyXG4gICAgICAgIHByaXZhdGUgY2Q6IENoYW5nZURldGVjdG9yUmVmLFxyXG4gICAgICAgIHB1YmxpYyBkZnJzOiBEYXRhZ3JpZEZpbHRlclJvd1NlcnZpY2UsXHJcbiAgICAgICAgcHJpdmF0ZSByZW5kZXI6IFJlbmRlcmVyMixcclxuICAgICAgICBwcml2YXRlIGluamVjdDogSW5qZWN0b3IpIHtcclxuICAgICAgICAgICAgdGhpcy5maWx0ZXJSb3dDb25kaXRpb25zU2NyaWJlID0gdGhpcy5kZnJzLmZpbHRlclJvd0NvbmRpdGlvbnMkLnN1YnNjcmliZShjY3MgPT4ge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jb25kaXRpb25DaGFuZ2UuZW1pdChjY3MpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgbmdPbkluaXQoKTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy5mb3JtID0gdGhpcy5jcmVhdGVDb250cm9sKCk7XHJcbiAgICAgICAgdGhpcy5uZ3pvbmUucnVuT3V0c2lkZUFuZ3VsYXIoKCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLnJlbmRlci5saXN0ZW4oJ2RvY3VtZW50JywgJ2NsaWNrJywgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5kZnJzLmNsb3NlRmlsdGVyUGFuZWwoKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgbmdBZnRlclZpZXdJbml0KCkge1xyXG4gICAgICAgIGNvbnN0IG5hdGl2ZUVsID0gdGhpcy5lbC5uYXRpdmVFbGVtZW50O1xyXG4gICAgICAgIHRoaXMudHIgPSBuYXRpdmVFbC5wYXJlbnRFbGVtZW50O1xyXG4gICAgICAgIG5hdGl2ZUVsLnF1ZXJ5U2VsZWN0b3JBbGwoJ3RkJykuZm9yRWFjaChuID0+IHtcclxuICAgICAgICAgICAgdGhpcy50ci5hcHBlbmQobik7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgbmF0aXZlRWwuc3R5bGUuZGlzcGxheSA9ICdub25lJztcclxuXHJcbiAgICAgICAgdGhpcy5kZnJzLmdyaWRJbnN0YW5jZSA9IHRoaXMuZ3JpZEluc3RhbmNlO1xyXG4gICAgfVxyXG5cclxuICAgIG5nT25EZXN0cm95KCkge1xyXG4gICAgICAgIGlmICh0aGlzLmZpbHRlclJvd0NvbmRpdGlvbnNTY3JpYmUpIHtcclxuICAgICAgICAgICAgdGhpcy5maWx0ZXJSb3dDb25kaXRpb25zU2NyaWJlLnVuc3Vic2NyaWJlKCk7XHJcbiAgICAgICAgICAgIHRoaXMuZmlsdGVyUm93Q29uZGl0aW9uc1NjcmliZSA9IG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLnRyKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHRkcyA9IHRoaXMudHIucXVlcnlTZWxlY3RvckFsbCgndGQnKTtcclxuICAgICAgICAgICAgaWYgKHRkcyAmJiB0ZHMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICB0ZHMuZm9yRWFjaChhID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIWEuY2xhc3NMaXN0LmNvbnRhaW5zKCdmLWRhdGFncmlkLWhlYWRlci1jaGVja2JveCcpICYmICFhLmNsYXNzTGlzdC5jb250YWlucygnZi1kYXRhZ3JpZC1jZWxsLXJvd251bWJlcicpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudHIucmVtb3ZlQ2hpbGQoYSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgY3JlYXRlQ29udHJvbCgpIHtcclxuICAgICAgICBjb25zdCBncm91cCA9IHRoaXMuZmIuZ3JvdXAoe30pO1xyXG4gICAgICAgIHRoaXMuY29sdW1ucy5mb3JFYWNoKGNvbCA9PiB7XHJcbiAgICAgICAgICAgIGlmIChjb2wuY29sc3Bhbikge3JldHVybjsgfVxyXG4gICAgICAgICAgICBjb25zdCBjb250cm9sID0gdGhpcy5mYi5jb250cm9sKCcnKTtcclxuICAgICAgICAgICAgZ3JvdXAuYWRkQ29udHJvbChjb2wuZmllbGQsIGNvbnRyb2wpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiBncm91cDtcclxuICAgIH1cclxuXHJcbiAgICBjbGVhckZpbHRlclZhbHVlKGVtaXRFdmVudCA9IHRydWUpIHtcclxuICAgICAgICAvLyB0aGlzLmZvcm0ucmVzZXQoKTtcclxuICAgICAgICB0aGlzLmVkaXRvcnMuZm9yRWFjaChjID0+IHtcclxuICAgICAgICAgICAgYy5jbGVhclZhbHVlKCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHRoaXMuZGZycy5jbGVhcihlbWl0RXZlbnQpO1xyXG4gICAgfVxyXG5cclxuICAgIHJlbW92ZUZpZWxkKGZpZWxkOiBzdHJpbmcsIG9wdHM/OiB7IGVtaXRFdmVudDogYm9vbGVhbiB9KSB7XHJcbiAgICAgICAgdGhpcy5kZnJzLnJlbW92ZUZpbHRlckZpZWxkKGZpZWxkLCBvcHRzKTtcclxuICAgIH1cclxufVxyXG4iXX0=