/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
/*
 * @Author: 疯狂秀才(Lucas Huang)
 * @Date: 2019-08-06 08:31:57
 * @LastEditors: 疯狂秀才(Lucas Huang)
 * @LastEditTime: 2019-08-15 16:06:58
 * @QQ: 1055818239
 * @Version: v0.0.1
 */
import { Component, Input, ViewChild, Renderer2, ElementRef, Output, EventEmitter, TemplateRef } from '@angular/core';
import { fromEvent, Observable } from 'rxjs';
import { AngularDraggableDirective } from '@farris/ui-draggable';
import { ModalDirective } from '@farris/ui-modal';
import { ContentChild } from '@angular/core';
import { debounceTime } from 'rxjs/operators';
var DialogComponent = /** @class */ (function () {
    function DialogComponent(render2, el) {
        this.render2 = render2;
        this.el = el;
        /**
         * 窗口标题
         */
        this.title = '我是标题';
        /**
         * 标题图标
         */
        this.iconCls = undefined;
        /**
         * 宽度
         */
        this.width = 300;
        /**
         * 高度
         */
        this.height = 200;
        this.minWidth = 100;
        this.minHeight = 100;
        this.maxWidth = null;
        this.maxHeight = null;
        /**
         * 显示底部按钮区域，默认显示
         */
        this.showButtons = true;
        /**
         * 显示右上角关闭按钮，默认显示
         */
        this.showCloseButton = true;
        /**
         * 显示最大化按钮，默认显示
         */
        this.showMaxButton = true;
        /**
         * 显示最小化按钮，默认不显示, 显示出来也没有用
         */
        this.showMinButton = false;
        /**
         * 启用拖拽改变尺寸大小
         */
        this.resizable = true;
        /**
         * 启用拖动窗口
         */
        this.draggable = true;
        /**
         * 按钮对齐方式
         */
        this.buttonAlign = 'center';
        this.scrollConfig = {};
        this.opened = new EventEmitter();
        this.closed = new EventEmitter();
        this.resized = new EventEmitter();
        this.resizing = new EventEmitter();
        this.maxed = new EventEmitter();
        this.widthChange = new EventEmitter();
        this.heightChange = new EventEmitter();
        this.moving = new EventEmitter();
        this.enableScroll = true;
        /**
         * 标题栏高度
         */
        this.dialogHeaderHeight = 0;
        /**
         * 按钮区高度
         */
        this.dialogFooterHeight = 0;
        this.parentElement = null;
        /**
         * 显示头部
         */
        this.showHeader = true;
        this.isMax = false; // 是否最大窗口
        // 记录上次的高度
        this.hostId = '';
        /**
         * 窗口最大化时，是否与浏览器之间有间距，当为true时与浏览器边距为 0
         */
        this.maxPadding = true;
        this.windowResize$ = null;
        this.postitionStyles = {};
        this._windowResizeToMax = false;
        this._mutationObserver = null;
        this._dialogEl = null;
        this.footerEl = null;
    }
    Object.defineProperty(DialogComponent.prototype, "size", {
        get: /**
         * @return {?}
         */
        function () {
            /** @type {?} */
            var headerHeight = this.getDialogHeaderLineHeight();
            /** @type {?} */
            var footerHeight = this.getDialogFooterHeight();
            /** @type {?} */
            var contentHeight = this.height - headerHeight;
            if (this.showButtons) {
                contentHeight = contentHeight - footerHeight;
            }
            return {
                width: this.width,
                height: this.height,
                contentHeight: contentHeight,
                contentWidth: this.width,
                header: headerHeight,
                footer: footerHeight
            };
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    DialogComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this.hostId = "farris-dialog_" + new Date().getTime();
        this.render2.setProperty(this.el.nativeElement, 'id', this.hostId);
        if (!this.beforeOpen) {
            this.beforeOpen = (/**
             * @return {?}
             */
            function () { return true; });
        }
        if (!this.beforeClose) {
            this.beforeClose = (/**
             * @return {?}
             */
            function () { return true; });
        }
        this.modal.onShown.subscribe((/**
         * @return {?}
         */
        function () {
            _this.opened.emit();
        }));
        this.modal.onHidden.subscribe((/**
         * @return {?}
         */
        function () { return _this.closed.emit(); }));
        this.checkDialogSize();
        setTimeout((/**
         * @return {?}
         */
        function () {
            if (_this.parentElement) {
                _this.parentElement.appendChild(_this.el.nativeElement);
            }
            else {
                document.body.appendChild(_this.el.nativeElement);
            }
            if (_this.showHeader && _this.modalHeader) {
                _this.dragHandle = _this.modalHeader.nativeElement;
            }
        }), 100);
    };
    /**
     * @param {?} changes
     * @return {?}
     */
    DialogComponent.prototype.ngOnChanges = /**
     * @param {?} changes
     * @return {?}
     */
    function (changes) {
    };
    /**
     * @return {?}
     */
    DialogComponent.prototype.ngOnDestroy = /**
     * @return {?}
     */
    function () {
        var _this = this;
        setTimeout((/**
         * @return {?}
         */
        function () {
            _this.destroy();
            _this.el = null;
            if (_this.parentElement) {
                _this.parentElement = null;
            }
            if (_this._mutationObserver) {
                // 停止观察属性变化
                _this._mutationObserver.disconnect();
                _this._mutationObserver = null;
            }
        }), 150);
    };
    /**
     * @private
     * @return {?}
     */
    DialogComponent.prototype.getScreenSize = /**
     * @private
     * @return {?}
     */
    function () {
        /** @type {?} */
        var margin = (this.maxPadding ? 20 : 0);
        return {
            width: window.innerWidth - margin,
            height: window.innerHeight - margin,
            padding: margin ? 10 : 0
        };
    };
    /**
     * @return {?}
     */
    DialogComponent.prototype.ngAfterViewInit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        if (!this.dialogEl) {
            this._dialogEl = this.el.nativeElement.querySelector('.modal-dialog');
        }
        else {
            this._dialogEl = this.dialogEl.nativeElement;
        }
        this.dlgHeaderLineHeight = this.getDialogHeaderLineHeight();
        if (this.dialogHeaderHeight && this.modalHeader) {
            this.modalHeader.nativeElement.style.height = this.dialogHeaderHeight + "px";
        }
        if (this.dialogFooterHeight) {
            /** @type {?} */
            var footer = this.modalContent.nativeElement.querySelector('.modal-footer');
            if (footer) {
                footer.style.height = this.dialogFooterHeight + "px";
            }
        }
        this.originalHeight = this.height;
        this.originalWidth = this.width;
        this.resetPosition();
        this.windowResize$ = fromEvent(window, 'resize').pipe(debounceTime(50)).subscribe((/**
         * @param {?} e
         * @return {?}
         */
        function (e) {
            var _a = _this.getScreenSize(), winWidth = _a.width, winHeight = _a.height;
            if (_this.width <= winWidth && _this.height <= winHeight) {
                if (_this._windowResizeToMax) {
                    _this.revertDialog();
                    _this._windowResizeToMax = false;
                }
                else {
                    if (_this.isMax) {
                        _this.maxDialog(false);
                    }
                }
            }
            else {
                if (!_this.isMax) {
                    _this._windowResizeToMax = true;
                    _this.maxDialog();
                }
                else {
                    _this.maxDialog(false);
                }
            }
            _this.toCenter(0, 0);
        }));
        // this.listenattributesChanged();
    };
    // private listenattributesChanged() {
    //      // 观察器的配置（需要观察什么变动）
    //      const config = { attributes: true, subtree: false,characterData:true, attributeFilter: ['style'], attributeOldValue: true} ;
    //      // 当观察到变动时执行的回调函数
    //      const callback = (mutationsList, observer) => {
    //         // Use traditional 'for loops' for IE 11
    //         for(let mutation of mutationsList) {
    //             // console.log(mutation);
    //         }
    //      };
    //      // 创建一个观察器实例并传入回调函数
    //      this._mutationObserver = new MutationObserver(callback);
    //      // 以上述配置开始观察目标节点
    //      this._mutationObserver.observe(this.dialogEl.nativeElement, config);
    // }
    // private listenattributesChanged() {
    //      // 观察器的配置（需要观察什么变动）
    //      const config = { attributes: true, subtree: false,characterData:true, attributeFilter: ['style'], attributeOldValue: true} ;
    //      // 当观察到变动时执行的回调函数
    //      const callback = (mutationsList, observer) => {
    //         // Use traditional 'for loops' for IE 11
    //         for(let mutation of mutationsList) {
    //             // console.log(mutation);
    //         }
    //      };
    //      // 创建一个观察器实例并传入回调函数
    //      this._mutationObserver = new MutationObserver(callback);
    //      // 以上述配置开始观察目标节点
    //      this._mutationObserver.observe(this.dialogEl.nativeElement, config);
    // }
    /**
     * @param {?} x
     * @param {?} y
     * @return {?}
     */
    DialogComponent.prototype.toCenter = 
    // private listenattributesChanged() {
    //      // 观察器的配置（需要观察什么变动）
    //      const config = { attributes: true, subtree: false,characterData:true, attributeFilter: ['style'], attributeOldValue: true} ;
    //      // 当观察到变动时执行的回调函数
    //      const callback = (mutationsList, observer) => {
    //         // Use traditional 'for loops' for IE 11
    //         for(let mutation of mutationsList) {
    //             // console.log(mutation);
    //         }
    //      };
    //      // 创建一个观察器实例并传入回调函数
    //      this._mutationObserver = new MutationObserver(callback);
    //      // 以上述配置开始观察目标节点
    //      this._mutationObserver.observe(this.dialogEl.nativeElement, config);
    // }
    /**
     * @param {?} x
     * @param {?} y
     * @return {?}
     */
    function (x, y) {
        this.resetPosition();
        this.draggbar.position = { x: x, y: y };
        this.draggbar.resetPosition();
    };
    /**
     * @return {?}
     */
    DialogComponent.prototype.destroy = /**
     * @return {?}
     */
    function () {
        if (!this.parentElement) {
            if (document.body.querySelector("#" + this.hostId)) {
                document.body.removeChild(this.el.nativeElement);
            }
        }
        else {
            if (this.parentElement.querySelector("#" + this.hostId)) {
                this.parentElement.removeChild(this.el.nativeElement);
            }
        }
        if (this.windowResize$) {
            this.windowResize$.unsubscribe();
            this.windowResize$ = null;
        }
    };
    /**
     * @private
     * @return {?}
     */
    DialogComponent.prototype.getDialogHeaderLineHeight = /**
     * @private
     * @return {?}
     */
    function () {
        if (this.modalHeader) {
            if (!this.dlgHeaderLineHeight) {
                this.dlgHeaderLineHeight = 0;
            }
            /** @type {?} */
            var hh = Math.ceil(this.modalHeader.nativeElement.getBoundingClientRect().height);
            this.dlgHeaderLineHeight = hh;
            return this.dlgHeaderLineHeight;
        }
        return 0;
    };
    /**
     * @private
     * @return {?}
     */
    DialogComponent.prototype.getDialogFooterHeight = /**
     * @private
     * @return {?}
     */
    function () {
        if (!this.footerEl) {
            /** @type {?} */
            var _footerEl = this.modalContent.nativeElement.querySelector('.modal-footer');
            this.footerEl = _footerEl;
        }
        if (!this.dlgFooterLineHeight) {
            this.dlgFooterLineHeight = 0;
        }
        if (this.footerEl) {
            this.footerEl.style.height = 'auto';
            /** @type {?} */
            var _fh = Math.ceil(this.footerEl.getBoundingClientRect().height);
            this.dlgFooterLineHeight = _fh;
        }
        return this.dlgFooterLineHeight;
        // const footerEl =  this.modalContent.nativeElement.querySelector('.modal-footer');
        // if (footerEl) {
        //     if (!this.dlgFooterLineHeight) {
        //         this.dlgFooterLineHeight = Math.ceil(footerEl.getBoundingClientRect().height);
        //     }
        //     return this.dlgFooterLineHeight;
        // }
        // return  0;
    };
    /**
     * @private
     * @param {?} width
     * @param {?} height
     * @return {?}
     */
    DialogComponent.prototype._checkDialogSize = /**
     * @private
     * @param {?} width
     * @param {?} height
     * @return {?}
     */
    function (width, height) {
        // 可视区域尺寸
        /** @type {?} */
        var winSize = {
            width: document.body.offsetWidth,
            height: window.innerHeight
        };
        if (this.parentElement) {
            winSize.width = this.parentElement.offsetWidth;
            winSize.height = this.parentElement.offsetHeight;
        }
        if (winSize.width && winSize.width < width) {
            width = winSize.width;
        }
        if (winSize.height && winSize.height < height) {
            height = winSize.height;
        }
        return {
            width: width,
            height: height
        };
    };
    /**
     * @private
     * @return {?}
     */
    DialogComponent.prototype.checkDialogSize = /**
     * @private
     * @return {?}
     */
    function () {
        /** @type {?} */
        var newSize = this._checkDialogSize(this.width, this.height);
        if (this.width !== newSize.width) {
            this.width = newSize.width - 20;
            this.widthChange.emit(this.width);
        }
        if (this.height !== newSize.height) {
            this.height = newSize.height - 20;
            this.heightChange.emit(this.height);
        }
    };
    /**
     * @return {?}
     */
    DialogComponent.prototype.updateModalBodyHeight = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var contentEl = this.el.nativeElement.querySelector('.modal-body');
        /** @type {?} */
        var contentHeight = this.size.contentHeight;
        this.render2.setStyle(contentEl, 'height', contentHeight + 'px');
    };
    /**
     * @private
     * @return {?}
     */
    DialogComponent.prototype.updatePosition = /**
     * @private
     * @return {?}
     */
    function () {
        /** @type {?} */
        var marginLeft = Number.parseInt('' + -this.width / 2);
        /** @type {?} */
        var marginTop = Number.parseInt('' + -this.height / 2);
        this.postitionStyles = {
            marginLeft: marginLeft + 'px',
            marginTop: marginTop + 'px',
            transform: 'translate3d(0px, 0px, 0px)',
            top: window.innerHeight / 2 + marginTop + "px",
            left: window.innerWidth / 2 + marginLeft + "px",
            top1: this.isMax ? '10px' : '50%',
            left1: this.isMax ? '10px' : '50%'
        };
    };
    /**
     * @return {?}
     */
    DialogComponent.prototype.resetPosition = /**
     * @return {?}
     */
    function () {
        this.updatePosition();
        if (this._dialogEl) {
            /** @type {?} */
            var dialogEl = this._dialogEl;
            this.render2.setStyle(dialogEl, 'top', this.postitionStyles.top);
            this.render2.setStyle(dialogEl, 'left', this.postitionStyles.left);
            this.render2.setStyle(dialogEl, 'transform', this.postitionStyles.transform);
        }
    };
    /**
     * @private
     * @param {?} flag
     * @return {?}
     */
    DialogComponent.prototype.openDialog = /**
     * @private
     * @param {?} flag
     * @return {?}
     */
    function (flag) {
        if (flag) {
            this.resetPosition();
            this.draggbar.resetPosition();
            this.modal.show();
            // setTimeout(() => {
            //     const backdropEl = this.el.nativeElement.querySelector('.farris-modal');
            //     const modals = Array.from(document.body.querySelectorAll('.farris-modal.show')).filter((n: any) => (n.style.display !== 'none' && n !== backdropEl));
            //     if (modals && modals.length > 0) {
            //         const zIndexArr = modals.map(n => {
            //             return parseInt(window.getComputedStyle(n).getPropertyValue('z-index'), 10);
            //         }).filter(n => n);
            //         const maxZIndex = Math.max(...zIndexArr);
            //         backdropEl.style.zIndex = maxZIndex + 1;
            //     }
            // });
        }
    };
    /**
     * @private
     * @param {?} canClose
     * @return {?}
     */
    DialogComponent.prototype.closeDialog = /**
     * @private
     * @param {?} canClose
     * @return {?}
     */
    function (canClose) {
        if (canClose) {
            this.modal.hide();
            // this.closed.emit();
        }
    };
    /**
     * @return {?}
     */
    DialogComponent.prototype.show = /**
     * @return {?}
     */
    function () {
        var _this = this;
        /** @type {?} */
        var result = this.beforeOpen();
        if (typeof result === 'boolean') {
            this.openDialog(result);
        }
        else {
            if (result instanceof Observable) {
                result.subscribe((/**
                 * @param {?} flag
                 * @return {?}
                 */
                function (flag) {
                    _this.openDialog(flag);
                }));
            }
            else {
                if (result instanceof Promise) {
                    result.then((/**
                     * @param {?} flag
                     * @return {?}
                     */
                    function (flag) {
                        _this.openDialog(flag);
                    }));
                }
            }
        }
    };
    /**
     * @param {?=} $event
     * @return {?}
     */
    DialogComponent.prototype.close = /**
     * @param {?=} $event
     * @return {?}
     */
    function ($event) {
        var _this = this;
        if ($event) {
            $event.stopPropagation();
        }
        /** @type {?} */
        var result = this.beforeClose();
        if (typeof result === 'boolean') {
            this.closeDialog(result);
        }
        else {
            if (result instanceof Observable) {
                result.subscribe((/**
                 * @param {?} flag
                 * @return {?}
                 */
                function (flag) {
                    _this.closeDialog(flag);
                }));
            }
            else {
                if (result instanceof Promise) {
                    result.then((/**
                     * @param {?} flag
                     * @return {?}
                     */
                    function (flag) {
                        _this.closeDialog(flag);
                    }));
                }
            }
        }
    };
    /**
     * @param {?} size
     * @return {?}
     */
    DialogComponent.prototype.reSize = /**
     * @param {?} size
     * @return {?}
     */
    function (size) {
        if (size.width) {
            this.width = size.width;
        }
        if (size.height) {
            this.height = size.height;
        }
        this.resetPosition();
        this.draggbar.resetPosition();
        this.widthChange.emit(this.width);
        this.heightChange.emit(this.height);
        this.resized.emit({ size: { width: this.width, height: this.height } });
    };
    /**
     * @param {?} opts
     * @return {?}
     */
    DialogComponent.prototype.onResizing = /**
     * @param {?} opts
     * @return {?}
     */
    function (opts) {
        opts.size.width = opts.size.width < 100 ? 100 : opts.size.width;
        opts.size.height = opts.size.height < 100 ? 100 : opts.size.height;
        this.width = opts.size.width;
        this.height = opts.size.height;
        this.resizing.emit(opts);
    };
    /**
     * @param {?} opts
     * @return {?}
     */
    DialogComponent.prototype.resizeStop = /**
     * @param {?} opts
     * @return {?}
     */
    function (opts) {
        opts.size.width = opts.size.width < 100 ? 100 : opts.size.width;
        opts.size.height = opts.size.height < 100 ? 100 : opts.size.height;
        this.width = opts.size.width;
        this.height = opts.size.height;
        this.updateModalBodyHeight();
        this.widthChange.emit(this.width);
        this.heightChange.emit(this.height);
        this.resized.emit(opts);
    };
    /**
     * @param {?} el
     * @return {?}
     */
    DialogComponent.prototype.dropdown = /**
     * @param {?} el
     * @return {?}
     */
    function (el) {
        // const rect = el.getBoundingClientRect();
        // this.render2.removeStyle(el, 'margin-top');
        // this.render2.removeStyle(el, 'margin-left');
        // this.render2.setStyle(el, 'top', `${rect.top}px`);
        // this.render2.setStyle(el, 'left', `${rect.left}px`);
        // this.render2.removeStyle(el, 'transform');
        // this.render2.removeStyle(el, '-webkit-transform');
        // this.render2.removeStyle(el, '-ms-transform');
        // this.render2.removeStyle(el, '-moz-transform');
        // this.render2.removeStyle(el, '-o-transform');
    };
    /**
     * @param {?=} rememberPrevSize
     * @return {?}
     */
    DialogComponent.prototype.maxDialog = /**
     * @param {?=} rememberPrevSize
     * @return {?}
     */
    function (rememberPrevSize) {
        if (rememberPrevSize === void 0) { rememberPrevSize = true; }
        if (!this.el) {
            return;
        }
        if (rememberPrevSize) {
            this.prevWidth = this.width;
            this.prevHeight = this.height;
        }
        var _a = this.getScreenSize(), winWidth = _a.width, winHeight = _a.height, padding = _a.padding;
        this.width = winWidth;
        this.height = winHeight;
        this.draggable = false;
        this.resizable = false;
        this.isMax = true;
        this.toCenter(0, 0);
        /** @type {?} */
        var dialogEl = this.el.nativeElement.querySelector('.modal-dialog');
        this.render2.setStyle(dialogEl, 'top', padding);
        this.render2.setStyle(dialogEl, 'left', padding);
        this.resized.emit({ size: { width: this.width, height: this.height } });
        this.maxed.emit({ size: { width: this.width, height: this.height } });
    };
    /**
     * @return {?}
     */
    DialogComponent.prototype.revertDialog = /**
     * @return {?}
     */
    function () {
        this.isMax = false;
        var _a = this.getScreenSize(), ww = _a.width, wh = _a.height;
        this.width = this.prevWidth == ww ? this.originalWidth : this.prevWidth;
        this.height = this.prevHeight == wh ? this.originalHeight : this.prevHeight;
        if (this.width > ww) {
            this.width = ww;
        }
        if (this.height > wh) {
            this.height = wh;
        }
        this.draggable = true;
        this.resizable = true;
        this.resetPosition();
        this.draggbar.resetPosition();
        this.resized.emit({ size: { width: this.width, height: this.height } });
        this.maxed.emit({ size: { width: this.width, height: this.height } });
    };
    /**
     * @return {?}
     */
    DialogComponent.prototype.changeDialogSize = /**
     * @return {?}
     */
    function () {
        if (this.isMax) {
            this.revertDialog();
        }
        else {
            this.maxDialog();
        }
        this._windowResizeToMax = false;
    };
    /**
     * @param {?} $event
     * @return {?}
     */
    DialogComponent.prototype.onMoving = /**
     * @param {?} $event
     * @return {?}
     */
    function ($event) {
        this.moving.emit(tslib_1.__assign({ target: this.dialogEl.nativeElement }, $event));
    };
    DialogComponent.decorators = [
        { type: Component, args: [{
                    selector: 'farris-dialog',
                    template: "<div #backdropEl class=\"modal farris-modal fade\" bsModal #staticModal=\"bs-modal\" [config]=\"{backdrop: 'static'}\"\r\n    tabindex=\"-1\" role=\"dialog\" aria-labelledby=\"dialog-static-name\">\r\n    <div [ngDraggable]=\"draggable\" [ngResizable]=\"resizable\" rzHandles=\"all\" [handle]=\"dragHandle\"\r\n        (rzStop)=\"resizeStop($event)\" (rzResizing)=\"onResizing($event)\" (stopped)=\"dropdown($event)\" (movingOffset)=\"onMoving($event)\"\r\n        [rzMinWidth]=\"minWidth\" [rzMaxWidth]=\"maxWidth\" [rzMinHeight]=\"minHeight\" [rzMaxHeight]=\"maxHeight\"\r\n        [inBounds]=\"true\" [bounds]=\"backdropEl\" [rzContainment]=\"backdropEl\" class=\"modal-dialog m-0\" [style.width.px]=\"width\"\r\n        [style.height]=\"height + 'px'\" #dialogEl style=\"margin-left: 0!important; margin-top: 0!important\">\r\n        <div #modalContent class=\"modal-content\" style=\"overflow: hidden;\">\r\n            <div #header class=\"modal-header\" *ngIf=\"showHeader\">\r\n                <div class=\"modal-title\">\r\n                    <span *ngIf=\"iconCls\" [class]=\"iconCls\"></span>\r\n                    <span class=\"modal-title-label\">{{ title }}</span>\r\n                </div>\r\n                <div class=\"actions\">\r\n\r\n                    <ul>\r\n                        <li *ngIf=\"toolTemplate\">\r\n                            <ng-template [ngTemplateOutlet]=\"toolTemplate\">\r\n\r\n                            </ng-template>\r\n                        </li>\r\n                        <li *ngIf=\"showMinButton\" class=\"f-btn-icon f-bare\"><span class=\"f-icon modal_minimize\"></span>\r\n                        </li>\r\n                        <li *ngIf=\"showMaxButton\" (click)=\"changeDialogSize()\" class=\"f-btn-icon f-bare\"><span\r\n                                class=\"f-icon modal_maximize\" [class.modalrevert]=\"isMax\"></span></li>\r\n                        <li *ngIf=\"showCloseButton\" (click)=\"close($event)\" class=\"f-btn-icon f-bare\"><span\r\n                                class=\"f-icon modal_close\"></span></li>\r\n                    </ul>\r\n                </div>\r\n            </div>\r\n            <div class=\"modal-body\" [style.height.px]=\"size?.contentHeight\" style=\" cursor:default;\">\r\n                <perfect-scrollbar [disabled]=\"!enableScroll\" [config]=\"scrollConfig\">\r\n                    <ng-content></ng-content>\r\n                </perfect-scrollbar>\r\n            </div>\r\n            <div class=\"modal-footer\" *ngIf=\"showButtons\" [style.textAlign]=\"buttonAlign\" style=\" cursor:default;\">\r\n                <ng-container [ngTemplateOutlet]=\"buttons\"></ng-container>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>",
                    styles: [""]
                }] }
    ];
    /** @nocollapse */
    DialogComponent.ctorParameters = function () { return [
        { type: Renderer2 },
        { type: ElementRef }
    ]; };
    DialogComponent.propDecorators = {
        title: [{ type: Input }],
        iconCls: [{ type: Input }],
        width: [{ type: Input }],
        height: [{ type: Input }],
        minWidth: [{ type: Input }],
        minHeight: [{ type: Input }],
        maxWidth: [{ type: Input }],
        maxHeight: [{ type: Input }],
        showButtons: [{ type: Input }],
        showCloseButton: [{ type: Input }],
        showMaxButton: [{ type: Input }],
        showMinButton: [{ type: Input }],
        resizable: [{ type: Input }],
        draggable: [{ type: Input }],
        buttonAlign: [{ type: Input }],
        scrollConfig: [{ type: Input }],
        beforeOpen: [{ type: Input }],
        beforeClose: [{ type: Input }],
        modal: [{ type: ViewChild, args: [ModalDirective,] }],
        draggbar: [{ type: ViewChild, args: [AngularDraggableDirective,] }],
        opened: [{ type: Output }],
        closed: [{ type: Output }],
        resized: [{ type: Output }],
        resizing: [{ type: Output }],
        maxed: [{ type: Output }],
        widthChange: [{ type: Output }],
        heightChange: [{ type: Output }],
        moving: [{ type: Output }],
        enableScroll: [{ type: Input }],
        buttons: [{ type: Input }],
        dialogHeaderHeight: [{ type: Input }],
        dialogFooterHeight: [{ type: Input }],
        parentElement: [{ type: Input }],
        showHeader: [{ type: Input }],
        dragHandle: [{ type: Input }],
        toolTemplate: [{ type: ContentChild, args: ['toolTemplate',] }],
        modalContent: [{ type: ViewChild, args: ['modalContent',] }],
        modalHeader: [{ type: ViewChild, args: ['header',] }],
        dialogEl: [{ type: ViewChild, args: ['dialogEl',] }],
        maxPadding: [{ type: Input }]
    };
    return DialogComponent;
}());
export { DialogComponent };
if (false) {
    /**
     * 窗口标题
     * @type {?}
     */
    DialogComponent.prototype.title;
    /**
     * 标题图标
     * @type {?}
     */
    DialogComponent.prototype.iconCls;
    /**
     * 宽度
     * @type {?}
     */
    DialogComponent.prototype.width;
    /**
     * 高度
     * @type {?}
     */
    DialogComponent.prototype.height;
    /** @type {?} */
    DialogComponent.prototype.minWidth;
    /** @type {?} */
    DialogComponent.prototype.minHeight;
    /** @type {?} */
    DialogComponent.prototype.maxWidth;
    /** @type {?} */
    DialogComponent.prototype.maxHeight;
    /**
     * 显示底部按钮区域，默认显示
     * @type {?}
     */
    DialogComponent.prototype.showButtons;
    /**
     * 显示右上角关闭按钮，默认显示
     * @type {?}
     */
    DialogComponent.prototype.showCloseButton;
    /**
     * 显示最大化按钮，默认显示
     * @type {?}
     */
    DialogComponent.prototype.showMaxButton;
    /**
     * 显示最小化按钮，默认不显示, 显示出来也没有用
     * @type {?}
     */
    DialogComponent.prototype.showMinButton;
    /**
     * 启用拖拽改变尺寸大小
     * @type {?}
     */
    DialogComponent.prototype.resizable;
    /**
     * 启用拖动窗口
     * @type {?}
     */
    DialogComponent.prototype.draggable;
    /**
     * 按钮对齐方式
     * @type {?}
     */
    DialogComponent.prototype.buttonAlign;
    /** @type {?} */
    DialogComponent.prototype.scrollConfig;
    /** @type {?} */
    DialogComponent.prototype.beforeOpen;
    /** @type {?} */
    DialogComponent.prototype.beforeClose;
    /** @type {?} */
    DialogComponent.prototype.modal;
    /** @type {?} */
    DialogComponent.prototype.draggbar;
    /** @type {?} */
    DialogComponent.prototype.opened;
    /** @type {?} */
    DialogComponent.prototype.closed;
    /** @type {?} */
    DialogComponent.prototype.resized;
    /** @type {?} */
    DialogComponent.prototype.resizing;
    /** @type {?} */
    DialogComponent.prototype.maxed;
    /** @type {?} */
    DialogComponent.prototype.widthChange;
    /** @type {?} */
    DialogComponent.prototype.heightChange;
    /** @type {?} */
    DialogComponent.prototype.moving;
    /** @type {?} */
    DialogComponent.prototype.enableScroll;
    /** @type {?} */
    DialogComponent.prototype.buttons;
    /**
     * 标题栏高度
     * @type {?}
     */
    DialogComponent.prototype.dialogHeaderHeight;
    /**
     * 按钮区高度
     * @type {?}
     */
    DialogComponent.prototype.dialogFooterHeight;
    /** @type {?} */
    DialogComponent.prototype.parentElement;
    /**
     * 显示头部
     * @type {?}
     */
    DialogComponent.prototype.showHeader;
    /**
     * Html Element
     * @type {?}
     */
    DialogComponent.prototype.dragHandle;
    /** @type {?} */
    DialogComponent.prototype.toolTemplate;
    /** @type {?} */
    DialogComponent.prototype.isMax;
    /** @type {?} */
    DialogComponent.prototype.dlgHeaderLineHeight;
    /** @type {?} */
    DialogComponent.prototype.dlgFooterLineHeight;
    /**
     * @type {?}
     * @private
     */
    DialogComponent.prototype.originalWidth;
    /**
     * @type {?}
     * @private
     */
    DialogComponent.prototype.originalHeight;
    /**
     * @type {?}
     * @private
     */
    DialogComponent.prototype.prevWidth;
    /**
     * @type {?}
     * @private
     */
    DialogComponent.prototype.prevHeight;
    /**
     * @type {?}
     * @private
     */
    DialogComponent.prototype.hostId;
    /** @type {?} */
    DialogComponent.prototype.modalContent;
    /** @type {?} */
    DialogComponent.prototype.modalHeader;
    /** @type {?} */
    DialogComponent.prototype.dialogEl;
    /**
     * 窗口最大化时，是否与浏览器之间有间距，当为true时与浏览器边距为 0
     * @type {?}
     */
    DialogComponent.prototype.maxPadding;
    /**
     * @type {?}
     * @private
     */
    DialogComponent.prototype.windowResize$;
    /** @type {?} */
    DialogComponent.prototype.postitionStyles;
    /**
     * @type {?}
     * @private
     */
    DialogComponent.prototype._windowResizeToMax;
    /**
     * @type {?}
     * @private
     */
    DialogComponent.prototype._mutationObserver;
    /**
     * @type {?}
     * @private
     */
    DialogComponent.prototype._dialogEl;
    /**
     * @type {?}
     * @private
     */
    DialogComponent.prototype.footerEl;
    /**
     * @type {?}
     * @private
     */
    DialogComponent.prototype.render2;
    /** @type {?} */
    DialogComponent.prototype.el;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGlhbG9nLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BmYXJyaXMvdWktZGlhbG9nLyIsInNvdXJjZXMiOlsibGliL2RpYWxvZy9kaWFsb2cuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7QUFRQSxPQUFPLEVBQ0gsU0FBUyxFQUFVLEtBQUssRUFBRSxTQUFTLEVBQUUsU0FBUyxFQUM5QyxVQUFVLEVBQUUsTUFBTSxFQUFFLFlBQVksRUFBRSxXQUFXLEVBRWhELE1BQU0sZUFBZSxDQUFDO0FBRXZCLE9BQU8sRUFBRSxTQUFTLEVBQUUsVUFBVSxFQUFnQixNQUFNLE1BQU0sQ0FBQztBQUUzRCxPQUFPLEVBQUUseUJBQXlCLEVBQUUsTUFBTSxzQkFBc0IsQ0FBQztBQUNqRSxPQUFPLEVBQUUsY0FBYyxFQUFFLE1BQU0sa0JBQWtCLENBQUM7QUFDbEQsT0FBTyxFQUFFLFlBQVksRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUM3QyxPQUFPLEVBQUUsWUFBWSxFQUFDLE1BQU0sZ0JBQWdCLENBQUM7QUFFN0M7SUE0SEkseUJBQW9CLE9BQWtCLEVBQVMsRUFBYztRQUF6QyxZQUFPLEdBQVAsT0FBTyxDQUFXO1FBQVMsT0FBRSxHQUFGLEVBQUUsQ0FBWTs7OztRQXBIcEQsVUFBSyxHQUFHLE1BQU0sQ0FBQzs7OztRQUdmLFlBQU8sR0FBVyxTQUFTLENBQUM7Ozs7UUFHNUIsVUFBSyxHQUFHLEdBQUcsQ0FBQzs7OztRQUVaLFdBQU0sR0FBRyxHQUFHLENBQUM7UUFFYixhQUFRLEdBQUcsR0FBRyxDQUFDO1FBRWYsY0FBUyxHQUFHLEdBQUcsQ0FBQztRQUVoQixhQUFRLEdBQVcsSUFBSSxDQUFDO1FBQ3hCLGNBQVMsR0FBVyxJQUFJLENBQUM7Ozs7UUFHekIsZ0JBQVcsR0FBRyxJQUFJLENBQUM7Ozs7UUFFbkIsb0JBQWUsR0FBRyxJQUFJLENBQUM7Ozs7UUFFdkIsa0JBQWEsR0FBRyxJQUFJLENBQUM7Ozs7UUFFckIsa0JBQWEsR0FBRyxLQUFLLENBQUM7Ozs7UUFHdEIsY0FBUyxHQUFHLElBQUksQ0FBQzs7OztRQUVqQixjQUFTLEdBQUcsSUFBSSxDQUFDOzs7O1FBR2pCLGdCQUFXLEdBQUcsUUFBUSxDQUFDO1FBQ3ZCLGlCQUFZLEdBQUcsRUFBRSxDQUFDO1FBU2pCLFdBQU0sR0FBRyxJQUFJLFlBQVksRUFBRSxDQUFDO1FBQzVCLFdBQU0sR0FBRyxJQUFJLFlBQVksRUFBRSxDQUFDO1FBQzVCLFlBQU8sR0FBRyxJQUFJLFlBQVksRUFBRSxDQUFDO1FBQzdCLGFBQVEsR0FBRyxJQUFJLFlBQVksRUFBRSxDQUFDO1FBQzlCLFVBQUssR0FBRyxJQUFJLFlBQVksRUFBRSxDQUFDO1FBQzNCLGdCQUFXLEdBQUcsSUFBSSxZQUFZLEVBQUUsQ0FBQztRQUNqQyxpQkFBWSxHQUFHLElBQUksWUFBWSxFQUFFLENBQUM7UUFDbEMsV0FBTSxHQUFFLElBQUksWUFBWSxFQUFFLENBQUM7UUFFNUIsaUJBQVksR0FBRyxJQUFJLENBQUM7Ozs7UUFLcEIsdUJBQWtCLEdBQUcsQ0FBQyxDQUFDOzs7O1FBR3ZCLHVCQUFrQixHQUFHLENBQUMsQ0FBQztRQUd2QixrQkFBYSxHQUFHLElBQUksQ0FBQzs7OztRQUVyQixlQUFVLEdBQUcsSUFBSSxDQUFDO1FBTTNCLFVBQUssR0FBRyxLQUFLLENBQUMsQ0FBQyxTQUFTOztRQVVoQixXQUFNLEdBQUcsRUFBRSxDQUFDOzs7O1FBS1gsZUFBVSxHQUFHLElBQUksQ0FBQztRQUVuQixrQkFBYSxHQUFpQixJQUFJLENBQUM7UUFFM0Msb0JBQWUsR0FBUSxFQUFFLENBQUM7UUFvQmxCLHVCQUFrQixHQUFHLEtBQUssQ0FBQztRQUczQixzQkFBaUIsR0FBRyxJQUFJLENBQUM7UUFDekIsY0FBUyxHQUFHLElBQUksQ0FBQztRQUNqQixhQUFRLEdBQUcsSUFBSSxDQUFDO0lBSXhCLENBQUM7SUEzQkQsc0JBQUksaUNBQUk7Ozs7UUFBUjs7Z0JBQ1UsWUFBWSxHQUFHLElBQUksQ0FBQyx5QkFBeUIsRUFBRTs7Z0JBQy9DLFlBQVksR0FBRyxJQUFJLENBQUMscUJBQXFCLEVBQUU7O2dCQUU3QyxhQUFhLEdBQUcsSUFBSSxDQUFDLE1BQU0sR0FBRyxZQUFZO1lBQzlDLElBQUksSUFBSSxDQUFDLFdBQVcsRUFBRTtnQkFDbEIsYUFBYSxHQUFHLGFBQWEsR0FBRyxZQUFZLENBQUM7YUFDaEQ7WUFDRCxPQUFPO2dCQUNILEtBQUssRUFBRSxJQUFJLENBQUMsS0FBSztnQkFDakIsTUFBTSxFQUFFLElBQUksQ0FBQyxNQUFNO2dCQUNuQixhQUFhLGVBQUE7Z0JBQ2IsWUFBWSxFQUFFLElBQUksQ0FBQyxLQUFLO2dCQUN4QixNQUFNLEVBQUUsWUFBWTtnQkFDcEIsTUFBTSxFQUFFLFlBQVk7YUFDdkIsQ0FBQztRQUNOLENBQUM7OztPQUFBOzs7O0lBYUQsa0NBQVE7OztJQUFSO1FBQUEsaUJBOEJDO1FBN0JHLElBQUksQ0FBQyxNQUFNLEdBQUcsbUJBQWlCLElBQUksSUFBSSxFQUFFLENBQUMsT0FBTyxFQUFJLENBQUM7UUFDdEQsSUFBSSxDQUFDLE9BQU8sQ0FBQyxXQUFXLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxhQUFhLEVBQUUsSUFBSSxFQUFFLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQztRQUNuRSxJQUFJLENBQUMsSUFBSSxDQUFDLFVBQVUsRUFBRTtZQUNsQixJQUFJLENBQUMsVUFBVTs7O1lBQUcsY0FBTSxPQUFBLElBQUksRUFBSixDQUFJLENBQUEsQ0FBQztTQUNoQztRQUVELElBQUksQ0FBQyxJQUFJLENBQUMsV0FBVyxFQUFFO1lBQ25CLElBQUksQ0FBQyxXQUFXOzs7WUFBRyxjQUFNLE9BQUEsSUFBSSxFQUFKLENBQUksQ0FBQSxDQUFDO1NBQ2pDO1FBRUQsSUFBSSxDQUFDLEtBQUssQ0FBQyxPQUFPLENBQUMsU0FBUzs7O1FBQUM7WUFDekIsS0FBSSxDQUFDLE1BQU0sQ0FBQyxJQUFJLEVBQUUsQ0FBQztRQUN2QixDQUFDLEVBQUMsQ0FBQztRQUVILElBQUksQ0FBQyxLQUFLLENBQUMsUUFBUSxDQUFDLFNBQVM7OztRQUFDLGNBQU0sT0FBQSxLQUFJLENBQUMsTUFBTSxDQUFDLElBQUksRUFBRSxFQUFsQixDQUFrQixFQUFDLENBQUM7UUFFeEQsSUFBSSxDQUFDLGVBQWUsRUFBRSxDQUFDO1FBQ3ZCLFVBQVU7OztRQUFDO1lBQ1AsSUFBSSxLQUFJLENBQUMsYUFBYSxFQUFFO2dCQUNwQixLQUFJLENBQUMsYUFBYSxDQUFDLFdBQVcsQ0FBQyxLQUFJLENBQUMsRUFBRSxDQUFDLGFBQWEsQ0FBQyxDQUFDO2FBQ3pEO2lCQUFNO2dCQUNILFFBQVEsQ0FBQyxJQUFJLENBQUMsV0FBVyxDQUFDLEtBQUksQ0FBQyxFQUFFLENBQUMsYUFBYSxDQUFDLENBQUM7YUFDcEQ7WUFFRCxJQUFJLEtBQUksQ0FBQyxVQUFVLElBQUksS0FBSSxDQUFDLFdBQVcsRUFBRTtnQkFDckMsS0FBSSxDQUFDLFVBQVUsR0FBRyxLQUFJLENBQUMsV0FBVyxDQUFDLGFBQWEsQ0FBQzthQUNwRDtRQUVMLENBQUMsR0FBRSxHQUFHLENBQUMsQ0FBQztJQUNaLENBQUM7Ozs7O0lBRUQscUNBQVc7Ozs7SUFBWCxVQUFZLE9BQXNCO0lBQ2xDLENBQUM7Ozs7SUFFRCxxQ0FBVzs7O0lBQVg7UUFBQSxpQkFjQztRQWJHLFVBQVU7OztRQUFDO1lBQ1AsS0FBSSxDQUFDLE9BQU8sRUFBRSxDQUFDO1lBQ2YsS0FBSSxDQUFDLEVBQUUsR0FBRyxJQUFJLENBQUM7WUFDZixJQUFJLEtBQUksQ0FBQyxhQUFhLEVBQUU7Z0JBQ3BCLEtBQUksQ0FBQyxhQUFhLEdBQUcsSUFBSSxDQUFDO2FBQzdCO1lBRUQsSUFBSSxLQUFJLENBQUMsaUJBQWlCLEVBQUU7Z0JBQ3hCLFdBQVc7Z0JBQ1gsS0FBSSxDQUFDLGlCQUFpQixDQUFDLFVBQVUsRUFBRSxDQUFDO2dCQUNwQyxLQUFJLENBQUMsaUJBQWlCLEdBQUcsSUFBSSxDQUFDO2FBQ2pDO1FBQ0wsQ0FBQyxHQUFFLEdBQUcsQ0FBQyxDQUFDO0lBQ1osQ0FBQzs7Ozs7SUFFTyx1Q0FBYTs7OztJQUFyQjs7WUFDVSxNQUFNLEdBQUksQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUEsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUN6QyxPQUFPO1lBQ0gsS0FBSyxFQUFFLE1BQU0sQ0FBQyxVQUFVLEdBQUcsTUFBTTtZQUNqQyxNQUFNLEVBQUUsTUFBTSxDQUFDLFdBQVcsR0FBRyxNQUFNO1lBQ25DLE9BQU8sRUFBRSxNQUFNLENBQUEsQ0FBQyxDQUFDLEVBQUUsQ0FBQSxDQUFDLENBQUMsQ0FBQztTQUN6QixDQUFBO0lBQ0wsQ0FBQzs7OztJQUVELHlDQUFlOzs7SUFBZjtRQUFBLGlCQXNEQztRQXJERyxJQUFJLENBQUMsSUFBSSxDQUFDLFFBQVEsRUFBRTtZQUNoQixJQUFJLENBQUMsU0FBUyxHQUFHLElBQUksQ0FBQyxFQUFFLENBQUMsYUFBYSxDQUFDLGFBQWEsQ0FBQyxlQUFlLENBQUMsQ0FBQztTQUN6RTthQUFNO1lBQ0gsSUFBSSxDQUFDLFNBQVMsR0FBRyxJQUFJLENBQUMsUUFBUSxDQUFDLGFBQWEsQ0FBQztTQUNoRDtRQUVELElBQUksQ0FBQyxtQkFBbUIsR0FBRyxJQUFJLENBQUMseUJBQXlCLEVBQUUsQ0FBQztRQUU1RCxJQUFJLElBQUksQ0FBQyxrQkFBa0IsSUFBSSxJQUFJLENBQUMsV0FBVyxFQUFFO1lBQzdDLElBQUksQ0FBQyxXQUFXLENBQUMsYUFBYSxDQUFDLEtBQUssQ0FBQyxNQUFNLEdBQU0sSUFBSSxDQUFDLGtCQUFrQixPQUFJLENBQUM7U0FDaEY7UUFFRCxJQUFJLElBQUksQ0FBQyxrQkFBa0IsRUFBRTs7Z0JBQ25CLE1BQU0sR0FBRyxJQUFJLENBQUMsWUFBWSxDQUFDLGFBQWEsQ0FBQyxhQUFhLENBQUMsZUFBZSxDQUFDO1lBQzdFLElBQUksTUFBTSxFQUFFO2dCQUNSLE1BQU0sQ0FBQyxLQUFLLENBQUMsTUFBTSxHQUFNLElBQUksQ0FBQyxrQkFBa0IsT0FBSSxDQUFDO2FBQ3hEO1NBQ0o7UUFFRCxJQUFJLENBQUMsY0FBYyxHQUFHLElBQUksQ0FBQyxNQUFNLENBQUM7UUFDbEMsSUFBSSxDQUFDLGFBQWEsR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDO1FBRWhDLElBQUksQ0FBQyxhQUFhLEVBQUUsQ0FBQztRQUVyQixJQUFJLENBQUMsYUFBYSxHQUFHLFNBQVMsQ0FBQyxNQUFNLEVBQUUsUUFBUSxDQUFDLENBQUMsSUFBSSxDQUNqRCxZQUFZLENBQUMsRUFBRSxDQUFDLENBQ25CLENBQUMsU0FBUzs7OztRQUFDLFVBQUMsQ0FBTTtZQUVULElBQUEsMEJBQTZELEVBQTNELG1CQUFlLEVBQUUscUJBQTBDO1lBRW5FLElBQUksS0FBSSxDQUFDLEtBQUssSUFBSSxRQUFRLElBQUksS0FBSSxDQUFDLE1BQU0sSUFBSSxTQUFTLEVBQUU7Z0JBQ3BELElBQUksS0FBSSxDQUFDLGtCQUFrQixFQUFFO29CQUN6QixLQUFJLENBQUMsWUFBWSxFQUFFLENBQUM7b0JBQ3BCLEtBQUksQ0FBQyxrQkFBa0IsR0FBRyxLQUFLLENBQUM7aUJBQ25DO3FCQUFNO29CQUNILElBQUcsS0FBSSxDQUFDLEtBQUssRUFBRTt3QkFDWCxLQUFJLENBQUMsU0FBUyxDQUFDLEtBQUssQ0FBQyxDQUFDO3FCQUN6QjtpQkFDSjthQUNKO2lCQUFNO2dCQUNILElBQUksQ0FBQyxLQUFJLENBQUMsS0FBSyxFQUFFO29CQUNiLEtBQUksQ0FBQyxrQkFBa0IsR0FBRyxJQUFJLENBQUM7b0JBQy9CLEtBQUksQ0FBQyxTQUFTLEVBQUUsQ0FBQztpQkFDcEI7cUJBQU07b0JBQ0gsS0FBSSxDQUFDLFNBQVMsQ0FBQyxLQUFLLENBQUMsQ0FBQztpQkFDekI7YUFDSjtZQUVELEtBQUksQ0FBQyxRQUFRLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDO1FBQ3hCLENBQUMsRUFBQyxDQUFDO1FBR0gsa0NBQWtDO0lBQ3RDLENBQUM7SUFFRCxzQ0FBc0M7SUFDdEMsMkJBQTJCO0lBQzNCLG9JQUFvSTtJQUVwSSx5QkFBeUI7SUFDekIsdURBQXVEO0lBQ3ZELG1EQUFtRDtJQUNuRCwrQ0FBK0M7SUFDL0Msd0NBQXdDO0lBRXhDLFlBQVk7SUFDWixVQUFVO0lBRVYsMkJBQTJCO0lBQzNCLGdFQUFnRTtJQUVoRSx3QkFBd0I7SUFDeEIsNEVBQTRFO0lBQzVFLElBQUk7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztJQUVKLGtDQUFROzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7SUFBUixVQUFTLENBQVMsRUFBRSxDQUFTO1FBQ3pCLElBQUksQ0FBQyxhQUFhLEVBQUUsQ0FBQztRQUNyQixJQUFJLENBQUMsUUFBUSxDQUFDLFFBQVEsR0FBRyxFQUFFLENBQUMsR0FBQSxFQUFFLENBQUMsR0FBQSxFQUFFLENBQUM7UUFDbEMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxhQUFhLEVBQUUsQ0FBQztJQUNsQyxDQUFDOzs7O0lBRUQsaUNBQU87OztJQUFQO1FBQ0ksSUFBSSxDQUFDLElBQUksQ0FBQyxhQUFhLEVBQUU7WUFDckIsSUFBSSxRQUFRLENBQUMsSUFBSSxDQUFDLGFBQWEsQ0FBQyxNQUFJLElBQUksQ0FBQyxNQUFRLENBQUMsRUFBRTtnQkFDaEQsUUFBUSxDQUFDLElBQUksQ0FBQyxXQUFXLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxhQUFhLENBQUMsQ0FBQzthQUNwRDtTQUNKO2FBQU07WUFDSCxJQUFJLElBQUksQ0FBQyxhQUFhLENBQUMsYUFBYSxDQUFDLE1BQUksSUFBSSxDQUFDLE1BQVEsQ0FBQyxFQUFFO2dCQUNyRCxJQUFJLENBQUMsYUFBYSxDQUFDLFdBQVcsQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLGFBQWEsQ0FBQyxDQUFDO2FBQ3pEO1NBQ0o7UUFFRCxJQUFJLElBQUksQ0FBQyxhQUFhLEVBQUU7WUFDcEIsSUFBSSxDQUFDLGFBQWEsQ0FBQyxXQUFXLEVBQUUsQ0FBQztZQUNqQyxJQUFJLENBQUMsYUFBYSxHQUFHLElBQUksQ0FBQztTQUM3QjtJQUNMLENBQUM7Ozs7O0lBRU8sbURBQXlCOzs7O0lBQWpDO1FBQ0ksSUFBSSxJQUFJLENBQUMsV0FBVyxFQUFFO1lBQ2xCLElBQUksQ0FBQyxJQUFJLENBQUMsbUJBQW1CLEVBQUU7Z0JBQzNCLElBQUksQ0FBQyxtQkFBbUIsR0FBRyxDQUFDLENBQUM7YUFDaEM7O2dCQUVLLEVBQUUsR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxXQUFXLENBQUMsYUFBYSxDQUFDLHFCQUFxQixFQUFFLENBQUMsTUFBTSxDQUFDO1lBQ25GLElBQUksQ0FBQyxtQkFBbUIsR0FBRyxFQUFFLENBQUM7WUFDOUIsT0FBTyxJQUFJLENBQUMsbUJBQW1CLENBQUM7U0FDbkM7UUFFRCxPQUFPLENBQUMsQ0FBQztJQUNiLENBQUM7Ozs7O0lBRU8sK0NBQXFCOzs7O0lBQTdCO1FBQ0ksSUFBSSxDQUFDLElBQUksQ0FBQyxRQUFRLEVBQUU7O2dCQUNWLFNBQVMsR0FBSSxJQUFJLENBQUMsWUFBWSxDQUFDLGFBQWEsQ0FBQyxhQUFhLENBQUMsZUFBZSxDQUFDO1lBQ2pGLElBQUksQ0FBQyxRQUFRLEdBQUcsU0FBUyxDQUFDO1NBQzdCO1FBQ0QsSUFBSSxDQUFDLElBQUksQ0FBQyxtQkFBbUIsRUFBRTtZQUMzQixJQUFJLENBQUMsbUJBQW1CLEdBQUcsQ0FBQyxDQUFDO1NBQ2hDO1FBRUQsSUFBSSxJQUFJLENBQUMsUUFBUSxFQUFFO1lBQ2YsSUFBSSxDQUFDLFFBQVEsQ0FBQyxLQUFLLENBQUMsTUFBTSxHQUFHLE1BQU0sQ0FBQzs7Z0JBQzlCLEdBQUcsR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMscUJBQXFCLEVBQUUsQ0FBQyxNQUFNLENBQUM7WUFDbkUsSUFBSSxDQUFDLG1CQUFtQixHQUFHLEdBQUcsQ0FBQztTQUNsQztRQUVELE9BQU8sSUFBSSxDQUFDLG1CQUFtQixDQUFDO1FBRWhDLG9GQUFvRjtRQUNwRixrQkFBa0I7UUFDbEIsdUNBQXVDO1FBQ3ZDLHlGQUF5RjtRQUN6RixRQUFRO1FBRVIsdUNBQXVDO1FBQ3ZDLElBQUk7UUFFSixhQUFhO0lBQ2pCLENBQUM7Ozs7Ozs7SUFFTywwQ0FBZ0I7Ozs7OztJQUF4QixVQUF5QixLQUFhLEVBQUUsTUFBYzs7O1lBRzVDLE9BQU8sR0FBRztZQUNaLEtBQUssRUFBRSxRQUFRLENBQUMsSUFBSSxDQUFDLFdBQVc7WUFDaEMsTUFBTSxFQUFFLE1BQU0sQ0FBQyxXQUFXO1NBQzdCO1FBRUQsSUFBSSxJQUFJLENBQUMsYUFBYSxFQUFFO1lBQ3BCLE9BQU8sQ0FBQyxLQUFLLEdBQUcsSUFBSSxDQUFDLGFBQWEsQ0FBQyxXQUFXLENBQUM7WUFDL0MsT0FBTyxDQUFDLE1BQU0sR0FBRyxJQUFJLENBQUMsYUFBYSxDQUFDLFlBQVksQ0FBQztTQUNwRDtRQUVELElBQUksT0FBTyxDQUFDLEtBQUssSUFBSSxPQUFPLENBQUMsS0FBSyxHQUFHLEtBQUssRUFBRTtZQUN4QyxLQUFLLEdBQUcsT0FBTyxDQUFDLEtBQUssQ0FBQztTQUN6QjtRQUVELElBQUksT0FBTyxDQUFDLE1BQU0sSUFBSSxPQUFPLENBQUMsTUFBTSxHQUFHLE1BQU0sRUFBRTtZQUMzQyxNQUFNLEdBQUcsT0FBTyxDQUFDLE1BQU0sQ0FBQztTQUMzQjtRQUVELE9BQU87WUFDSCxLQUFLLE9BQUE7WUFDTCxNQUFNLFFBQUE7U0FDVCxDQUFDO0lBQ04sQ0FBQzs7Ozs7SUFFTyx5Q0FBZTs7OztJQUF2Qjs7WUFDVSxPQUFPLEdBQUcsSUFBSSxDQUFDLGdCQUFnQixDQUFDLElBQUksQ0FBQyxLQUFLLEVBQUUsSUFBSSxDQUFDLE1BQU0sQ0FBQztRQUM5RCxJQUFJLElBQUksQ0FBQyxLQUFLLEtBQUssT0FBTyxDQUFDLEtBQUssRUFBRTtZQUM5QixJQUFJLENBQUMsS0FBSyxHQUFHLE9BQU8sQ0FBQyxLQUFLLEdBQUcsRUFBRSxDQUFDO1lBQ2hDLElBQUksQ0FBQyxXQUFXLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQztTQUNyQztRQUVELElBQUksSUFBSSxDQUFDLE1BQU0sS0FBSyxPQUFPLENBQUMsTUFBTSxFQUFFO1lBQ2hDLElBQUksQ0FBQyxNQUFNLEdBQUcsT0FBTyxDQUFDLE1BQU0sR0FBRyxFQUFFLENBQUM7WUFDbEMsSUFBSSxDQUFDLFlBQVksQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFDO1NBQ3ZDO0lBQ0wsQ0FBQzs7OztJQUVELCtDQUFxQjs7O0lBQXJCOztZQUNVLFNBQVMsR0FBRyxJQUFJLENBQUMsRUFBRSxDQUFDLGFBQWEsQ0FBQyxhQUFhLENBQUMsYUFBYSxDQUFDOztZQUM5RCxhQUFhLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQyxhQUFhO1FBQzdDLElBQUksQ0FBQyxPQUFPLENBQUMsUUFBUSxDQUFDLFNBQVMsRUFBRSxRQUFRLEVBQUUsYUFBYSxHQUFHLElBQUksQ0FBQyxDQUFDO0lBQ3JFLENBQUM7Ozs7O0lBRU8sd0NBQWM7Ozs7SUFBdEI7O1lBQ1UsVUFBVSxHQUFHLE1BQU0sQ0FBQyxRQUFRLENBQUMsRUFBRSxHQUFHLENBQUMsSUFBSSxDQUFDLEtBQUssR0FBRyxDQUFDLENBQUM7O1lBQ2xELFNBQVMsR0FBRyxNQUFNLENBQUMsUUFBUSxDQUFDLEVBQUUsR0FBRyxDQUFDLElBQUksQ0FBQyxNQUFNLEdBQUcsQ0FBQyxDQUFDO1FBRXhELElBQUksQ0FBQyxlQUFlLEdBQUc7WUFDbkIsVUFBVSxFQUFFLFVBQVUsR0FBRSxJQUFJO1lBQzVCLFNBQVMsRUFBRSxTQUFTLEdBQUUsSUFBSTtZQUMxQixTQUFTLEVBQUUsNEJBQTRCO1lBQ3ZDLEdBQUcsRUFBSyxNQUFNLENBQUMsV0FBVyxHQUFHLENBQUMsR0FBRyxTQUFTLE9BQUk7WUFDOUMsSUFBSSxFQUFLLE1BQU0sQ0FBQyxVQUFVLEdBQUUsQ0FBQyxHQUFHLFVBQVUsT0FBSTtZQUM5QyxJQUFJLEVBQUUsSUFBSSxDQUFDLEtBQUssQ0FBQSxDQUFDLENBQUMsTUFBTSxDQUFBLENBQUMsQ0FBQyxLQUFLO1lBQy9CLEtBQUssRUFBRSxJQUFJLENBQUMsS0FBSyxDQUFBLENBQUMsQ0FBQyxNQUFNLENBQUEsQ0FBQyxDQUFDLEtBQUs7U0FDbkMsQ0FBQztJQUdOLENBQUM7Ozs7SUFFRCx1Q0FBYTs7O0lBQWI7UUFDSSxJQUFJLENBQUMsY0FBYyxFQUFFLENBQUM7UUFDdEIsSUFBSSxJQUFJLENBQUMsU0FBUyxFQUFFOztnQkFDVixRQUFRLEdBQUcsSUFBSSxDQUFDLFNBQVM7WUFDL0IsSUFBSSxDQUFDLE9BQU8sQ0FBQyxRQUFRLENBQUMsUUFBUSxFQUFFLEtBQUssRUFBRSxJQUFJLENBQUMsZUFBZSxDQUFDLEdBQUcsQ0FBQyxDQUFDO1lBQ2pFLElBQUksQ0FBQyxPQUFPLENBQUMsUUFBUSxDQUFDLFFBQVEsRUFBRSxNQUFNLEVBQUUsSUFBSSxDQUFDLGVBQWUsQ0FBQyxJQUFJLENBQUMsQ0FBQztZQUNuRSxJQUFJLENBQUMsT0FBTyxDQUFDLFFBQVEsQ0FBQyxRQUFRLEVBQUUsV0FBVyxFQUFFLElBQUksQ0FBQyxlQUFlLENBQUMsU0FBUyxDQUFDLENBQUM7U0FDaEY7SUFDTCxDQUFDOzs7Ozs7SUFFTyxvQ0FBVTs7Ozs7SUFBbEIsVUFBbUIsSUFBYTtRQUM1QixJQUFJLElBQUksRUFBRTtZQUNOLElBQUksQ0FBQyxhQUFhLEVBQUUsQ0FBQztZQUNyQixJQUFJLENBQUMsUUFBUSxDQUFDLGFBQWEsRUFBRSxDQUFDO1lBQzlCLElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxFQUFFLENBQUM7WUFFbEIscUJBQXFCO1lBQ3JCLCtFQUErRTtZQUMvRSw0SkFBNEo7WUFDNUoseUNBQXlDO1lBQ3pDLDhDQUE4QztZQUM5QywyRkFBMkY7WUFDM0YsNkJBQTZCO1lBQzdCLG9EQUFvRDtZQUNwRCxtREFBbUQ7WUFDbkQsUUFBUTtZQUNSLE1BQU07U0FDVDtJQUNMLENBQUM7Ozs7OztJQUVPLHFDQUFXOzs7OztJQUFuQixVQUFvQixRQUFpQjtRQUNqQyxJQUFJLFFBQVEsRUFBRTtZQUNWLElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxFQUFFLENBQUM7WUFFbEIsc0JBQXNCO1NBQ3pCO0lBQ0wsQ0FBQzs7OztJQUVELDhCQUFJOzs7SUFBSjtRQUFBLGlCQWlCQzs7WUFoQlMsTUFBTSxHQUFHLElBQUksQ0FBQyxVQUFVLEVBQUU7UUFDaEMsSUFBSSxPQUFPLE1BQU0sS0FBSyxTQUFTLEVBQUU7WUFDN0IsSUFBSSxDQUFDLFVBQVUsQ0FBQyxNQUFNLENBQUMsQ0FBQztTQUMzQjthQUFNO1lBQ0gsSUFBSSxNQUFNLFlBQVksVUFBVSxFQUFFO2dCQUM5QixNQUFNLENBQUMsU0FBUzs7OztnQkFBQyxVQUFDLElBQWE7b0JBQzNCLEtBQUksQ0FBQyxVQUFVLENBQUMsSUFBSSxDQUFDLENBQUM7Z0JBQzFCLENBQUMsRUFBQyxDQUFDO2FBQ047aUJBQU07Z0JBQ0gsSUFBSSxNQUFNLFlBQVksT0FBTyxFQUFFO29CQUMzQixNQUFNLENBQUMsSUFBSTs7OztvQkFBQyxVQUFDLElBQWE7d0JBQ3RCLEtBQUksQ0FBQyxVQUFVLENBQUMsSUFBSSxDQUFDLENBQUM7b0JBQzFCLENBQUMsRUFBQyxDQUFDO2lCQUNOO2FBQ0o7U0FDSjtJQUNMLENBQUM7Ozs7O0lBRUQsK0JBQUs7Ozs7SUFBTCxVQUFNLE1BQW1CO1FBQXpCLGlCQW9CQztRQW5CRyxJQUFJLE1BQU0sRUFBRTtZQUNSLE1BQU0sQ0FBQyxlQUFlLEVBQUUsQ0FBQztTQUM1Qjs7WUFDSyxNQUFNLEdBQUcsSUFBSSxDQUFDLFdBQVcsRUFBRTtRQUNqQyxJQUFJLE9BQU8sTUFBTSxLQUFLLFNBQVMsRUFBRTtZQUM3QixJQUFJLENBQUMsV0FBVyxDQUFDLE1BQU0sQ0FBQyxDQUFDO1NBQzVCO2FBQU07WUFDSCxJQUFJLE1BQU0sWUFBWSxVQUFVLEVBQUU7Z0JBQzlCLE1BQU0sQ0FBQyxTQUFTOzs7O2dCQUFDLFVBQUMsSUFBYTtvQkFDM0IsS0FBSSxDQUFDLFdBQVcsQ0FBQyxJQUFJLENBQUMsQ0FBQztnQkFDM0IsQ0FBQyxFQUFDLENBQUM7YUFDTjtpQkFBTTtnQkFDSCxJQUFJLE1BQU0sWUFBWSxPQUFPLEVBQUU7b0JBQzNCLE1BQU0sQ0FBQyxJQUFJOzs7O29CQUFDLFVBQUMsSUFBYTt3QkFDdEIsS0FBSSxDQUFDLFdBQVcsQ0FBQyxJQUFJLENBQUMsQ0FBQztvQkFDM0IsQ0FBQyxFQUFDLENBQUM7aUJBQ047YUFDSjtTQUNKO0lBQ0wsQ0FBQzs7Ozs7SUFFRCxnQ0FBTTs7OztJQUFOLFVBQU8sSUFBeUM7UUFDNUMsSUFBSSxJQUFJLENBQUMsS0FBSyxFQUFFO1lBQ1osSUFBSSxDQUFDLEtBQUssR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDO1NBQzNCO1FBQ0QsSUFBSSxJQUFJLENBQUMsTUFBTSxFQUFFO1lBQ2IsSUFBSSxDQUFDLE1BQU0sR0FBRyxJQUFJLENBQUMsTUFBTSxDQUFDO1NBQzdCO1FBRUQsSUFBSSxDQUFDLGFBQWEsRUFBRSxDQUFDO1FBQ3JCLElBQUksQ0FBQyxRQUFRLENBQUMsYUFBYSxFQUFFLENBQUM7UUFDOUIsSUFBSSxDQUFDLFdBQVcsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO1FBQ2xDLElBQUksQ0FBQyxZQUFZLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQztRQUNwQyxJQUFJLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxFQUFFLElBQUksRUFBRSxFQUFFLEtBQUssRUFBRSxJQUFJLENBQUMsS0FBSyxFQUFFLE1BQU0sRUFBRSxJQUFJLENBQUMsTUFBTSxFQUFFLEVBQUUsQ0FBQyxDQUFDO0lBQzVFLENBQUM7Ozs7O0lBRUQsb0NBQVU7Ozs7SUFBVixVQUFXLElBQVM7UUFFaEIsSUFBSSxDQUFDLElBQUksQ0FBQyxLQUFLLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQyxLQUFLLEdBQUcsR0FBRyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDO1FBQ2hFLElBQUksQ0FBQyxJQUFJLENBQUMsTUFBTSxHQUFHLElBQUksQ0FBQyxJQUFJLENBQUMsTUFBTSxHQUFHLEdBQUcsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQztRQUVuRSxJQUFJLENBQUMsS0FBSyxHQUFHLElBQUksQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDO1FBQzdCLElBQUksQ0FBQyxNQUFNLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUM7UUFDL0IsSUFBSSxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7SUFDN0IsQ0FBQzs7Ozs7SUFFRCxvQ0FBVTs7OztJQUFWLFVBQVcsSUFBUztRQUNoQixJQUFJLENBQUMsSUFBSSxDQUFDLEtBQUssR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDLEtBQUssR0FBRyxHQUFHLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUM7UUFDaEUsSUFBSSxDQUFDLElBQUksQ0FBQyxNQUFNLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQyxNQUFNLEdBQUcsR0FBRyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDO1FBRW5FLElBQUksQ0FBQyxLQUFLLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUM7UUFDN0IsSUFBSSxDQUFDLE1BQU0sR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQztRQUMvQixJQUFJLENBQUMscUJBQXFCLEVBQUUsQ0FBQztRQUU3QixJQUFJLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUM7UUFDbEMsSUFBSSxDQUFDLFlBQVksQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFDO1FBRXBDLElBQUksQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQzVCLENBQUM7Ozs7O0lBRUQsa0NBQVE7Ozs7SUFBUixVQUFTLEVBQU87UUFDWiwyQ0FBMkM7UUFDM0MsOENBQThDO1FBQzlDLCtDQUErQztRQUMvQyxxREFBcUQ7UUFDckQsdURBQXVEO1FBRXZELDZDQUE2QztRQUM3QyxxREFBcUQ7UUFDckQsaURBQWlEO1FBQ2pELGtEQUFrRDtRQUNsRCxnREFBZ0Q7SUFDcEQsQ0FBQzs7Ozs7SUFFRCxtQ0FBUzs7OztJQUFULFVBQVUsZ0JBQXVCO1FBQXZCLGlDQUFBLEVBQUEsdUJBQXVCO1FBQzdCLElBQUksQ0FBQyxJQUFJLENBQUMsRUFBRSxFQUFFO1lBQ1YsT0FBTztTQUNWO1FBQ0QsSUFBSSxnQkFBZ0IsRUFBRTtZQUNsQixJQUFJLENBQUMsU0FBUyxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUM7WUFDNUIsSUFBSSxDQUFDLFVBQVUsR0FBRyxJQUFJLENBQUMsTUFBTSxDQUFDO1NBQ2pDO1FBRUssSUFBQSx5QkFBc0UsRUFBcEUsbUJBQWUsRUFBRSxxQkFBaUIsRUFBRSxvQkFBZ0M7UUFDNUUsSUFBSSxDQUFDLEtBQUssR0FBRyxRQUFRLENBQUM7UUFDdEIsSUFBSSxDQUFDLE1BQU0sR0FBRyxTQUFTLENBQUM7UUFHeEIsSUFBSSxDQUFDLFNBQVMsR0FBRyxLQUFLLENBQUM7UUFDdkIsSUFBSSxDQUFDLFNBQVMsR0FBRyxLQUFLLENBQUM7UUFHdkIsSUFBSSxDQUFDLEtBQUssR0FBRyxJQUFJLENBQUM7UUFDbEIsSUFBSSxDQUFDLFFBQVEsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUM7O1lBRWQsUUFBUSxHQUFHLElBQUksQ0FBQyxFQUFFLENBQUMsYUFBYSxDQUFDLGFBQWEsQ0FBQyxlQUFlLENBQUM7UUFFckUsSUFBSSxDQUFDLE9BQU8sQ0FBQyxRQUFRLENBQUMsUUFBUSxFQUFFLEtBQUssRUFBRSxPQUFPLENBQUMsQ0FBQztRQUNoRCxJQUFJLENBQUMsT0FBTyxDQUFDLFFBQVEsQ0FBQyxRQUFRLEVBQUUsTUFBTSxFQUFFLE9BQU8sQ0FBQyxDQUFDO1FBR2pELElBQUksQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLEVBQUUsSUFBSSxFQUFFLEVBQUUsS0FBSyxFQUFFLElBQUksQ0FBQyxLQUFLLEVBQUUsTUFBTSxFQUFFLElBQUksQ0FBQyxNQUFNLEVBQUUsRUFBRSxDQUFDLENBQUM7UUFDeEUsSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsRUFBRSxJQUFJLEVBQUUsRUFBRSxLQUFLLEVBQUUsSUFBSSxDQUFDLEtBQUssRUFBRSxNQUFNLEVBQUUsSUFBSSxDQUFDLE1BQU0sRUFBRSxFQUFFLENBQUMsQ0FBQztJQUMxRSxDQUFDOzs7O0lBRUQsc0NBQVk7OztJQUFaO1FBQ0ksSUFBSSxDQUFDLEtBQUssR0FBRyxLQUFLLENBQUM7UUFFYixJQUFBLHlCQUFnRCxFQUE5QyxhQUFTLEVBQUUsY0FBbUM7UUFFdEQsSUFBSSxDQUFDLEtBQUssR0FBRyxJQUFJLENBQUMsU0FBUyxJQUFJLEVBQUUsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLGFBQWEsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQztRQUN4RSxJQUFJLENBQUMsTUFBTSxHQUFHLElBQUksQ0FBQyxVQUFVLElBQUksRUFBRSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsY0FBYyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDO1FBRTVFLElBQUksSUFBSSxDQUFDLEtBQUssR0FBRyxFQUFFLEVBQUU7WUFDakIsSUFBSSxDQUFDLEtBQUssR0FBRyxFQUFFLENBQUM7U0FDbkI7UUFFRCxJQUFJLElBQUksQ0FBQyxNQUFNLEdBQUcsRUFBRSxFQUFFO1lBQ2xCLElBQUksQ0FBQyxNQUFNLEdBQUcsRUFBRSxDQUFDO1NBQ3BCO1FBRUQsSUFBSSxDQUFDLFNBQVMsR0FBRyxJQUFJLENBQUM7UUFDdEIsSUFBSSxDQUFDLFNBQVMsR0FBRyxJQUFJLENBQUM7UUFDdEIsSUFBSSxDQUFDLGFBQWEsRUFBRSxDQUFDO1FBQ3JCLElBQUksQ0FBQyxRQUFRLENBQUMsYUFBYSxFQUFFLENBQUM7UUFDOUIsSUFBSSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsRUFBRSxJQUFJLEVBQUUsRUFBRSxLQUFLLEVBQUUsSUFBSSxDQUFDLEtBQUssRUFBRSxNQUFNLEVBQUUsSUFBSSxDQUFDLE1BQU0sRUFBRSxFQUFFLENBQUMsQ0FBQztRQUN4RSxJQUFJLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxFQUFFLElBQUksRUFBRSxFQUFFLEtBQUssRUFBRSxJQUFJLENBQUMsS0FBSyxFQUFFLE1BQU0sRUFBRSxJQUFJLENBQUMsTUFBTSxFQUFFLEVBQUUsQ0FBQyxDQUFDO0lBQzFFLENBQUM7Ozs7SUFFRCwwQ0FBZ0I7OztJQUFoQjtRQUNJLElBQUksSUFBSSxDQUFDLEtBQUssRUFBRTtZQUNaLElBQUksQ0FBQyxZQUFZLEVBQUUsQ0FBQztTQUN2QjthQUFNO1lBQ0gsSUFBSSxDQUFDLFNBQVMsRUFBRSxDQUFDO1NBQ3BCO1FBQ0QsSUFBSSxDQUFDLGtCQUFrQixHQUFHLEtBQUssQ0FBQztJQUNwQyxDQUFDOzs7OztJQUVELGtDQUFROzs7O0lBQVIsVUFBUyxNQUFNO1FBQ1gsSUFBSSxDQUFDLE1BQU0sQ0FBQyxJQUFJLG9CQUFHLE1BQU0sRUFBRSxJQUFJLENBQUMsUUFBUSxDQUFDLGFBQWEsSUFBTSxNQUFNLEVBQUcsQ0FBQztJQUMxRSxDQUFDOztnQkEva0JKLFNBQVMsU0FBQztvQkFDUCxRQUFRLEVBQUUsZUFBZTtvQkFDekIsMnNGQUFzQzs7aUJBRXpDOzs7O2dCQWhCd0MsU0FBUztnQkFDOUMsVUFBVTs7O3dCQW1CVCxLQUFLOzBCQUdMLEtBQUs7d0JBR0wsS0FBSzt5QkFFTCxLQUFLOzJCQUVMLEtBQUs7NEJBRUwsS0FBSzsyQkFFTCxLQUFLOzRCQUNMLEtBQUs7OEJBR0wsS0FBSztrQ0FFTCxLQUFLO2dDQUVMLEtBQUs7Z0NBRUwsS0FBSzs0QkFHTCxLQUFLOzRCQUVMLEtBQUs7OEJBR0wsS0FBSzsrQkFDTCxLQUFLOzZCQUVMLEtBQUs7OEJBQ0wsS0FBSzt3QkFFTCxTQUFTLFNBQUMsY0FBYzsyQkFDeEIsU0FBUyxTQUFDLHlCQUF5Qjt5QkFHbkMsTUFBTTt5QkFDTixNQUFNOzBCQUNOLE1BQU07MkJBQ04sTUFBTTt3QkFDTixNQUFNOzhCQUNOLE1BQU07K0JBQ04sTUFBTTt5QkFDTixNQUFNOytCQUVOLEtBQUs7MEJBRUwsS0FBSztxQ0FHTCxLQUFLO3FDQUdMLEtBQUs7Z0NBR0wsS0FBSzs2QkFFTCxLQUFLOzZCQUVMLEtBQUs7K0JBR0wsWUFBWSxTQUFDLGNBQWM7K0JBWTNCLFNBQVMsU0FBQyxjQUFjOzhCQUN4QixTQUFTLFNBQUMsUUFBUTsyQkFDbEIsU0FBUyxTQUFDLFVBQVU7NkJBRXBCLEtBQUs7O0lBbWZWLHNCQUFDO0NBQUEsQUFobEJELElBZ2xCQztTQTNrQlksZUFBZTs7Ozs7O0lBR3hCLGdDQUF3Qjs7Ozs7SUFHeEIsa0NBQXFDOzs7OztJQUdyQyxnQ0FBcUI7Ozs7O0lBRXJCLGlDQUFzQjs7SUFFdEIsbUNBQXdCOztJQUV4QixvQ0FBeUI7O0lBRXpCLG1DQUFpQzs7SUFDakMsb0NBQWtDOzs7OztJQUdsQyxzQ0FBNEI7Ozs7O0lBRTVCLDBDQUFnQzs7Ozs7SUFFaEMsd0NBQThCOzs7OztJQUU5Qix3Q0FBK0I7Ozs7O0lBRy9CLG9DQUEwQjs7Ozs7SUFFMUIsb0NBQTBCOzs7OztJQUcxQixzQ0FBZ0M7O0lBQ2hDLHVDQUEyQjs7SUFFM0IscUNBQW9FOztJQUNwRSxzQ0FBcUU7O0lBRXJFLGdDQUFpRDs7SUFDakQsbUNBQTBFOztJQUcxRSxpQ0FBc0M7O0lBQ3RDLGlDQUFzQzs7SUFDdEMsa0NBQXVDOztJQUN2QyxtQ0FBd0M7O0lBQ3hDLGdDQUFxQzs7SUFDckMsc0NBQTJDOztJQUMzQyx1Q0FBNEM7O0lBQzVDLGlDQUFxQzs7SUFFckMsdUNBQTZCOztJQUU3QixrQ0FBbUM7Ozs7O0lBR25DLDZDQUFnQzs7Ozs7SUFHaEMsNkNBQWdDOztJQUdoQyx3Q0FBOEI7Ozs7O0lBRTlCLHFDQUEyQjs7Ozs7SUFFM0IscUNBQW9COztJQUdwQix1Q0FBNkQ7O0lBQzdELGdDQUFjOztJQUNkLDhDQUF5Qjs7SUFDekIsOENBQXlCOzs7OztJQUV6Qix3Q0FBOEI7Ozs7O0lBQzlCLHlDQUErQjs7Ozs7SUFFL0Isb0NBQTBCOzs7OztJQUMxQixxQ0FBMkI7Ozs7O0lBRTNCLGlDQUFvQjs7SUFDcEIsdUNBQW9EOztJQUNwRCxzQ0FBNkM7O0lBQzdDLG1DQUE0Qzs7Ozs7SUFFNUMscUNBQTJCOzs7OztJQUUzQix3Q0FBMkM7O0lBRTNDLDBDQUEwQjs7Ozs7SUFvQjFCLDZDQUFtQzs7Ozs7SUFHbkMsNENBQWlDOzs7OztJQUNqQyxvQ0FBeUI7Ozs7O0lBQ3pCLG1DQUF3Qjs7Ozs7SUFFWixrQ0FBMEI7O0lBQUUsNkJBQXFCIiwic291cmNlc0NvbnRlbnQiOlsiLypcclxuICogQEF1dGhvcjog55av54uC56eA5omNKEx1Y2FzIEh1YW5nKVxyXG4gKiBARGF0ZTogMjAxOS0wOC0wNiAwODozMTo1N1xyXG4gKiBATGFzdEVkaXRvcnM6IOeWr+eLguengOaJjShMdWNhcyBIdWFuZylcclxuICogQExhc3RFZGl0VGltZTogMjAxOS0wOC0xNSAxNjowNjo1OFxyXG4gKiBAUVE6IDEwNTU4MTgyMzlcclxuICogQFZlcnNpb246IHYwLjAuMVxyXG4gKi9cclxuaW1wb3J0IHtcclxuICAgIENvbXBvbmVudCwgT25Jbml0LCBJbnB1dCwgVmlld0NoaWxkLCBSZW5kZXJlcjIsXHJcbiAgICBFbGVtZW50UmVmLCBPdXRwdXQsIEV2ZW50RW1pdHRlciwgVGVtcGxhdGVSZWYsXHJcbiAgICBBZnRlclZpZXdJbml0LCBTaW1wbGVDaGFuZ2VzLCBPbkNoYW5nZXMsIE9uRGVzdHJveSwgUmVuZGVyZXJTdHlsZUZsYWdzMlxyXG59IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5cclxuaW1wb3J0IHsgZnJvbUV2ZW50LCBPYnNlcnZhYmxlLCBTdWJzY3JpcHRpb24gfSBmcm9tICdyeGpzJztcclxuXHJcbmltcG9ydCB7IEFuZ3VsYXJEcmFnZ2FibGVEaXJlY3RpdmUgfSBmcm9tICdAZmFycmlzL3VpLWRyYWdnYWJsZSc7XHJcbmltcG9ydCB7IE1vZGFsRGlyZWN0aXZlIH0gZnJvbSAnQGZhcnJpcy91aS1tb2RhbCc7XHJcbmltcG9ydCB7IENvbnRlbnRDaGlsZCB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBkZWJvdW5jZVRpbWV9IGZyb20gJ3J4anMvb3BlcmF0b3JzJztcclxuXHJcbkBDb21wb25lbnQoe1xyXG4gICAgc2VsZWN0b3I6ICdmYXJyaXMtZGlhbG9nJyxcclxuICAgIHRlbXBsYXRlVXJsOiAnLi9kaWFsb2cuY29tcG9uZW50Lmh0bWwnLFxyXG4gICAgc3R5bGVVcmxzOiBbJy4vZGlhbG9nLmNvbXBvbmVudC5jc3MnXVxyXG59KVxyXG5leHBvcnQgY2xhc3MgRGlhbG9nQ29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0LCBBZnRlclZpZXdJbml0LCBPbkNoYW5nZXMsIE9uRGVzdHJveSB7XHJcblxyXG4gICAgLyoqIOeql+WPo+agh+mimCAqL1xyXG4gICAgQElucHV0KCkgdGl0bGUgPSAn5oiR5piv5qCH6aKYJztcclxuXHJcbiAgICAvKiog5qCH6aKY5Zu+5qCHICovXHJcbiAgICBASW5wdXQoKSBpY29uQ2xzOiBzdHJpbmcgPSB1bmRlZmluZWQ7XHJcblxyXG4gICAgLyoqIOWuveW6piAqL1xyXG4gICAgQElucHV0KCkgd2lkdGggPSAzMDA7XHJcbiAgICAvKiog6auY5bqmICovXHJcbiAgICBASW5wdXQoKSBoZWlnaHQgPSAyMDA7XHJcblxyXG4gICAgQElucHV0KCkgbWluV2lkdGggPSAxMDA7XHJcblxyXG4gICAgQElucHV0KCkgbWluSGVpZ2h0ID0gMTAwO1xyXG5cclxuICAgIEBJbnB1dCgpIG1heFdpZHRoOiBudW1iZXIgPSBudWxsO1xyXG4gICAgQElucHV0KCkgbWF4SGVpZ2h0OiBudW1iZXIgPSBudWxsO1xyXG5cclxuICAgIC8qKiDmmL7npLrlupXpg6jmjInpkq7ljLrln5/vvIzpu5jorqTmmL7npLogKi9cclxuICAgIEBJbnB1dCgpIHNob3dCdXR0b25zID0gdHJ1ZTtcclxuICAgIC8qKiDmmL7npLrlj7PkuIrop5LlhbPpl63mjInpkq7vvIzpu5jorqTmmL7npLogKi9cclxuICAgIEBJbnB1dCgpIHNob3dDbG9zZUJ1dHRvbiA9IHRydWU7XHJcbiAgICAvKiog5pi+56S65pyA5aSn5YyW5oyJ6ZKu77yM6buY6K6k5pi+56S6ICovXHJcbiAgICBASW5wdXQoKSBzaG93TWF4QnV0dG9uID0gdHJ1ZTtcclxuICAgIC8qKiDmmL7npLrmnIDlsI/ljJbmjInpkq7vvIzpu5jorqTkuI3mmL7npLosIOaYvuekuuWHuuadpeS5n+ayoeacieeUqCAqL1xyXG4gICAgQElucHV0KCkgc2hvd01pbkJ1dHRvbiA9IGZhbHNlO1xyXG5cclxuICAgIC8qKiDlkK/nlKjmi5bmi73mlLnlj5jlsLrlr7jlpKflsI8gKi9cclxuICAgIEBJbnB1dCgpIHJlc2l6YWJsZSA9IHRydWU7XHJcbiAgICAvKiog5ZCv55So5ouW5Yqo56qX5Y+jICovXHJcbiAgICBASW5wdXQoKSBkcmFnZ2FibGUgPSB0cnVlO1xyXG5cclxuICAgIC8qKiDmjInpkq7lr7npvZDmlrnlvI8gKi9cclxuICAgIEBJbnB1dCgpIGJ1dHRvbkFsaWduID0gJ2NlbnRlcic7XHJcbiAgICBASW5wdXQoKSBzY3JvbGxDb25maWcgPSB7fTtcclxuXHJcbiAgICBASW5wdXQoKSBiZWZvcmVPcGVuOiAoKSA9PiBPYnNlcnZhYmxlPGFueT4gfCBQcm9taXNlPGFueT4gfCBib29sZWFuO1xyXG4gICAgQElucHV0KCkgYmVmb3JlQ2xvc2U6ICgpID0+IE9ic2VydmFibGU8YW55PiB8IFByb21pc2U8YW55PiB8IGJvb2xlYW47XHJcblxyXG4gICAgQFZpZXdDaGlsZChNb2RhbERpcmVjdGl2ZSkgbW9kYWw6IE1vZGFsRGlyZWN0aXZlO1xyXG4gICAgQFZpZXdDaGlsZChBbmd1bGFyRHJhZ2dhYmxlRGlyZWN0aXZlKSBkcmFnZ2JhcjogQW5ndWxhckRyYWdnYWJsZURpcmVjdGl2ZTtcclxuICAgIFxyXG5cclxuICAgIEBPdXRwdXQoKSBvcGVuZWQgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XHJcbiAgICBAT3V0cHV0KCkgY2xvc2VkID0gbmV3IEV2ZW50RW1pdHRlcigpO1xyXG4gICAgQE91dHB1dCgpIHJlc2l6ZWQgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XHJcbiAgICBAT3V0cHV0KCkgcmVzaXppbmcgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XHJcbiAgICBAT3V0cHV0KCkgbWF4ZWQgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XHJcbiAgICBAT3V0cHV0KCkgd2lkdGhDaGFuZ2UgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XHJcbiAgICBAT3V0cHV0KCkgaGVpZ2h0Q2hhbmdlID0gbmV3IEV2ZW50RW1pdHRlcigpO1xyXG4gICAgQE91dHB1dCgpIG1vdmluZyA9bmV3IEV2ZW50RW1pdHRlcigpO1xyXG5cclxuICAgIEBJbnB1dCgpIGVuYWJsZVNjcm9sbCA9IHRydWU7XHJcblxyXG4gICAgQElucHV0KCkgYnV0dG9uczogVGVtcGxhdGVSZWY8YW55PjtcclxuXHJcbiAgICAvKiog5qCH6aKY5qCP6auY5bqmICovXHJcbiAgICBASW5wdXQoKSBkaWFsb2dIZWFkZXJIZWlnaHQgPSAwO1xyXG5cclxuICAgIC8qKiDmjInpkq7ljLrpq5jluqYgKi9cclxuICAgIEBJbnB1dCgpIGRpYWxvZ0Zvb3RlckhlaWdodCA9IDA7XHJcblxyXG5cclxuICAgIEBJbnB1dCgpIHBhcmVudEVsZW1lbnQgPSBudWxsO1xyXG4gICAgLyoqIOaYvuekuuWktOmDqCAqL1xyXG4gICAgQElucHV0KCkgc2hvd0hlYWRlciA9IHRydWU7XHJcbiAgICAvKiogSHRtbCBFbGVtZW50ICovXHJcbiAgICBASW5wdXQoKSBkcmFnSGFuZGxlO1xyXG5cclxuICAgIC8qIHRlbXBsYXRlICovXHJcbiAgICBAQ29udGVudENoaWxkKCd0b29sVGVtcGxhdGUnKSB0b29sVGVtcGxhdGU6IFRlbXBsYXRlUmVmPGFueT47XHJcbiAgICBpc01heCA9IGZhbHNlOyAvLyDmmK/lkKbmnIDlpKfnqpflj6NcclxuICAgIGRsZ0hlYWRlckxpbmVIZWlnaHQ6IGFueTtcclxuICAgIGRsZ0Zvb3RlckxpbmVIZWlnaHQ6IGFueTtcclxuXHJcbiAgICBwcml2YXRlIG9yaWdpbmFsV2lkdGg6IG51bWJlcjsgIC8vIOiusOW9leWOn+Wni+eahOWuveW6plxyXG4gICAgcHJpdmF0ZSBvcmlnaW5hbEhlaWdodDogbnVtYmVyOyAvLyDorrDlvZXljp/lp4vnmoTpq5jluqZcclxuXHJcbiAgICBwcml2YXRlIHByZXZXaWR0aDogbnVtYmVyOyAvLyDorrDlvZXkuIrmrKHnmoTlrr3luqZcclxuICAgIHByaXZhdGUgcHJldkhlaWdodDogbnVtYmVyOyAvLyDorrDlvZXkuIrmrKHnmoTpq5jluqZcclxuXHJcbiAgICBwcml2YXRlIGhvc3RJZCA9ICcnO1xyXG4gICAgQFZpZXdDaGlsZCgnbW9kYWxDb250ZW50JykgbW9kYWxDb250ZW50OiBFbGVtZW50UmVmO1xyXG4gICAgQFZpZXdDaGlsZCgnaGVhZGVyJykgbW9kYWxIZWFkZXI6IEVsZW1lbnRSZWY7XHJcbiAgICBAVmlld0NoaWxkKCdkaWFsb2dFbCcpIGRpYWxvZ0VsOiBFbGVtZW50UmVmO1xyXG4gICAgLyoqIOeql+WPo+acgOWkp+WMluaXtu+8jOaYr+WQpuS4jua1j+iniOWZqOS5i+mXtOaciemXtOi3ne+8jOW9k+S4unRydWXml7bkuI7mtY/op4jlmajovrnot53kuLogMCAqL1xyXG4gICAgQElucHV0KCkgbWF4UGFkZGluZyA9IHRydWU7XHJcblxyXG4gICAgcHJpdmF0ZSB3aW5kb3dSZXNpemUkOiBTdWJzY3JpcHRpb24gPSBudWxsO1xyXG5cclxuICAgIHBvc3RpdGlvblN0eWxlczogYW55ID0ge307XHJcblxyXG4gICAgZ2V0IHNpemUoKSB7XHJcbiAgICAgICAgY29uc3QgaGVhZGVySGVpZ2h0ID0gdGhpcy5nZXREaWFsb2dIZWFkZXJMaW5lSGVpZ2h0KCk7XHJcbiAgICAgICAgY29uc3QgZm9vdGVySGVpZ2h0ID0gdGhpcy5nZXREaWFsb2dGb290ZXJIZWlnaHQoKTtcclxuXHJcbiAgICAgICAgbGV0IGNvbnRlbnRIZWlnaHQgPSB0aGlzLmhlaWdodCAtIGhlYWRlckhlaWdodDtcclxuICAgICAgICBpZiAodGhpcy5zaG93QnV0dG9ucykge1xyXG4gICAgICAgICAgICBjb250ZW50SGVpZ2h0ID0gY29udGVudEhlaWdodCAtIGZvb3RlckhlaWdodDtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgd2lkdGg6IHRoaXMud2lkdGgsXHJcbiAgICAgICAgICAgIGhlaWdodDogdGhpcy5oZWlnaHQsXHJcbiAgICAgICAgICAgIGNvbnRlbnRIZWlnaHQsXHJcbiAgICAgICAgICAgIGNvbnRlbnRXaWR0aDogdGhpcy53aWR0aCxcclxuICAgICAgICAgICAgaGVhZGVyOiBoZWFkZXJIZWlnaHQsXHJcbiAgICAgICAgICAgIGZvb3RlcjogZm9vdGVySGVpZ2h0XHJcbiAgICAgICAgfTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIF93aW5kb3dSZXNpemVUb01heCA9IGZhbHNlO1xyXG5cclxuXHJcbiAgICBwcml2YXRlIF9tdXRhdGlvbk9ic2VydmVyID0gbnVsbDtcclxuICAgIHByaXZhdGUgX2RpYWxvZ0VsID0gbnVsbDtcclxuICAgIHByaXZhdGUgZm9vdGVyRWwgPSBudWxsO1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKHByaXZhdGUgcmVuZGVyMjogUmVuZGVyZXIyLCBwdWJsaWMgZWw6IEVsZW1lbnRSZWYpIHsgXHJcblxyXG4gICAgfVxyXG5cclxuICAgIG5nT25Jbml0KCkge1xyXG4gICAgICAgIHRoaXMuaG9zdElkID0gYGZhcnJpcy1kaWFsb2dfJHtuZXcgRGF0ZSgpLmdldFRpbWUoKX1gO1xyXG4gICAgICAgIHRoaXMucmVuZGVyMi5zZXRQcm9wZXJ0eSh0aGlzLmVsLm5hdGl2ZUVsZW1lbnQsICdpZCcsIHRoaXMuaG9zdElkKTtcclxuICAgICAgICBpZiAoIXRoaXMuYmVmb3JlT3Blbikge1xyXG4gICAgICAgICAgICB0aGlzLmJlZm9yZU9wZW4gPSAoKSA9PiB0cnVlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKCF0aGlzLmJlZm9yZUNsb3NlKSB7XHJcbiAgICAgICAgICAgIHRoaXMuYmVmb3JlQ2xvc2UgPSAoKSA9PiB0cnVlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5tb2RhbC5vblNob3duLnN1YnNjcmliZSgoKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMub3BlbmVkLmVtaXQoKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgdGhpcy5tb2RhbC5vbkhpZGRlbi5zdWJzY3JpYmUoKCkgPT4gdGhpcy5jbG9zZWQuZW1pdCgpKTtcclxuXHJcbiAgICAgICAgdGhpcy5jaGVja0RpYWxvZ1NpemUoKTtcclxuICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICAgICAgaWYgKHRoaXMucGFyZW50RWxlbWVudCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5wYXJlbnRFbGVtZW50LmFwcGVuZENoaWxkKHRoaXMuZWwubmF0aXZlRWxlbWVudCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHRoaXMuZWwubmF0aXZlRWxlbWVudCk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmICh0aGlzLnNob3dIZWFkZXIgJiYgdGhpcy5tb2RhbEhlYWRlcikge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5kcmFnSGFuZGxlID0gdGhpcy5tb2RhbEhlYWRlci5uYXRpdmVFbGVtZW50O1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgIH0sIDEwMCk7XHJcbiAgICB9XHJcblxyXG4gICAgbmdPbkNoYW5nZXMoY2hhbmdlczogU2ltcGxlQ2hhbmdlcykge1xyXG4gICAgfVxyXG5cclxuICAgIG5nT25EZXN0cm95KCkge1xyXG4gICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLmRlc3Ryb3koKTtcclxuICAgICAgICAgICAgdGhpcy5lbCA9IG51bGw7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLnBhcmVudEVsZW1lbnQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMucGFyZW50RWxlbWVudCA9IG51bGw7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmICh0aGlzLl9tdXRhdGlvbk9ic2VydmVyKSB7XHJcbiAgICAgICAgICAgICAgICAvLyDlgZzmraLop4Llr5/lsZ7mgKflj5jljJZcclxuICAgICAgICAgICAgICAgIHRoaXMuX211dGF0aW9uT2JzZXJ2ZXIuZGlzY29ubmVjdCgpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fbXV0YXRpb25PYnNlcnZlciA9IG51bGw7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LCAxNTApO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgZ2V0U2NyZWVuU2l6ZSgpIHtcclxuICAgICAgICBjb25zdCBtYXJnaW4gPSAgKHRoaXMubWF4UGFkZGluZyA/IDIwOiAwKTtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICB3aWR0aDogd2luZG93LmlubmVyV2lkdGggLSBtYXJnaW4sXHJcbiAgICAgICAgICAgIGhlaWdodDogd2luZG93LmlubmVySGVpZ2h0IC0gbWFyZ2luLFxyXG4gICAgICAgICAgICBwYWRkaW5nOiBtYXJnaW4/IDEwOiAwXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIG5nQWZ0ZXJWaWV3SW5pdCgpIHtcclxuICAgICAgICBpZiAoIXRoaXMuZGlhbG9nRWwpIHtcclxuICAgICAgICAgICAgdGhpcy5fZGlhbG9nRWwgPSB0aGlzLmVsLm5hdGl2ZUVsZW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsLWRpYWxvZycpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2RpYWxvZ0VsID0gdGhpcy5kaWFsb2dFbC5uYXRpdmVFbGVtZW50O1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5kbGdIZWFkZXJMaW5lSGVpZ2h0ID0gdGhpcy5nZXREaWFsb2dIZWFkZXJMaW5lSGVpZ2h0KCk7XHJcblxyXG4gICAgICAgIGlmICh0aGlzLmRpYWxvZ0hlYWRlckhlaWdodCAmJiB0aGlzLm1vZGFsSGVhZGVyKSB7XHJcbiAgICAgICAgICAgIHRoaXMubW9kYWxIZWFkZXIubmF0aXZlRWxlbWVudC5zdHlsZS5oZWlnaHQgPSBgJHt0aGlzLmRpYWxvZ0hlYWRlckhlaWdodH1weGA7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAodGhpcy5kaWFsb2dGb290ZXJIZWlnaHQpIHtcclxuICAgICAgICAgICAgY29uc3QgZm9vdGVyID0gdGhpcy5tb2RhbENvbnRlbnQubmF0aXZlRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcubW9kYWwtZm9vdGVyJyk7XHJcbiAgICAgICAgICAgIGlmIChmb290ZXIpIHtcclxuICAgICAgICAgICAgICAgIGZvb3Rlci5zdHlsZS5oZWlnaHQgPSBgJHt0aGlzLmRpYWxvZ0Zvb3RlckhlaWdodH1weGA7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMub3JpZ2luYWxIZWlnaHQgPSB0aGlzLmhlaWdodDtcclxuICAgICAgICB0aGlzLm9yaWdpbmFsV2lkdGggPSB0aGlzLndpZHRoO1xyXG5cclxuICAgICAgICB0aGlzLnJlc2V0UG9zaXRpb24oKTtcclxuXHJcbiAgICAgICAgdGhpcy53aW5kb3dSZXNpemUkID0gZnJvbUV2ZW50KHdpbmRvdywgJ3Jlc2l6ZScpLnBpcGUoXHJcbiAgICAgICAgICAgIGRlYm91bmNlVGltZSg1MClcclxuICAgICAgICApLnN1YnNjcmliZSgoZTogYW55KSA9PiB7XHJcblxyXG4gICAgICAgICAgICBjb25zdCB7IHdpZHRoOiB3aW5XaWR0aCwgaGVpZ2h0OiB3aW5IZWlnaHQgfSA9IHRoaXMuZ2V0U2NyZWVuU2l6ZSgpO1xyXG5cclxuICAgICAgICAgICAgaWYgKHRoaXMud2lkdGggPD0gd2luV2lkdGggJiYgdGhpcy5oZWlnaHQgPD0gd2luSGVpZ2h0KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fd2luZG93UmVzaXplVG9NYXgpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnJldmVydERpYWxvZygpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3dpbmRvd1Jlc2l6ZVRvTWF4ID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmKHRoaXMuaXNNYXgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5tYXhEaWFsb2coZmFsc2UpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGlmICghdGhpcy5pc01heCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3dpbmRvd1Jlc2l6ZVRvTWF4ID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLm1heERpYWxvZygpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLm1heERpYWxvZyhmYWxzZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHRoaXMudG9DZW50ZXIoMCwgMCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgXHJcbiAgICAgICAgLy8gdGhpcy5saXN0ZW5hdHRyaWJ1dGVzQ2hhbmdlZCgpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIHByaXZhdGUgbGlzdGVuYXR0cmlidXRlc0NoYW5nZWQoKSB7XHJcbiAgICAvLyAgICAgIC8vIOinguWvn+WZqOeahOmFjee9ru+8iOmcgOimgeinguWvn+S7gOS5iOWPmOWKqO+8iVxyXG4gICAgLy8gICAgICBjb25zdCBjb25maWcgPSB7IGF0dHJpYnV0ZXM6IHRydWUsIHN1YnRyZWU6IGZhbHNlLGNoYXJhY3RlckRhdGE6dHJ1ZSwgYXR0cmlidXRlRmlsdGVyOiBbJ3N0eWxlJ10sIGF0dHJpYnV0ZU9sZFZhbHVlOiB0cnVlfSA7XHJcblxyXG4gICAgLy8gICAgICAvLyDlvZPop4Llr5/liLDlj5jliqjml7bmiafooYznmoTlm57osIPlh73mlbBcclxuICAgIC8vICAgICAgY29uc3QgY2FsbGJhY2sgPSAobXV0YXRpb25zTGlzdCwgb2JzZXJ2ZXIpID0+IHtcclxuICAgIC8vICAgICAgICAgLy8gVXNlIHRyYWRpdGlvbmFsICdmb3IgbG9vcHMnIGZvciBJRSAxMVxyXG4gICAgLy8gICAgICAgICBmb3IobGV0IG11dGF0aW9uIG9mIG11dGF0aW9uc0xpc3QpIHtcclxuICAgIC8vICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKG11dGF0aW9uKTtcclxuXHJcbiAgICAvLyAgICAgICAgIH1cclxuICAgIC8vICAgICAgfTtcclxuIFxyXG4gICAgLy8gICAgICAvLyDliJvlu7rkuIDkuKrop4Llr5/lmajlrp7kvovlubbkvKDlhaXlm57osIPlh73mlbBcclxuICAgIC8vICAgICAgdGhpcy5fbXV0YXRpb25PYnNlcnZlciA9IG5ldyBNdXRhdGlvbk9ic2VydmVyKGNhbGxiYWNrKTtcclxuIFxyXG4gICAgLy8gICAgICAvLyDku6XkuIrov7DphY3nva7lvIDlp4vop4Llr5/nm67moIfoioLngrlcclxuICAgIC8vICAgICAgdGhpcy5fbXV0YXRpb25PYnNlcnZlci5vYnNlcnZlKHRoaXMuZGlhbG9nRWwubmF0aXZlRWxlbWVudCwgY29uZmlnKTtcclxuICAgIC8vIH1cclxuXHJcbiAgICB0b0NlbnRlcih4OiBudW1iZXIsIHk6IG51bWJlcikge1xyXG4gICAgICAgIHRoaXMucmVzZXRQb3NpdGlvbigpO1xyXG4gICAgICAgIHRoaXMuZHJhZ2diYXIucG9zaXRpb24gPSB7IHgsIHkgfTtcclxuICAgICAgICB0aGlzLmRyYWdnYmFyLnJlc2V0UG9zaXRpb24oKTtcclxuICAgIH1cclxuXHJcbiAgICBkZXN0cm95KCkge1xyXG4gICAgICAgIGlmICghdGhpcy5wYXJlbnRFbGVtZW50KSB7XHJcbiAgICAgICAgICAgIGlmIChkb2N1bWVudC5ib2R5LnF1ZXJ5U2VsZWN0b3IoYCMke3RoaXMuaG9zdElkfWApKSB7XHJcbiAgICAgICAgICAgICAgICBkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKHRoaXMuZWwubmF0aXZlRWxlbWVudCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5wYXJlbnRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoYCMke3RoaXMuaG9zdElkfWApKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnBhcmVudEVsZW1lbnQucmVtb3ZlQ2hpbGQodGhpcy5lbC5uYXRpdmVFbGVtZW50KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHRoaXMud2luZG93UmVzaXplJCkge1xyXG4gICAgICAgICAgICB0aGlzLndpbmRvd1Jlc2l6ZSQudW5zdWJzY3JpYmUoKTtcclxuICAgICAgICAgICAgdGhpcy53aW5kb3dSZXNpemUkID0gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBnZXREaWFsb2dIZWFkZXJMaW5lSGVpZ2h0KCkge1xyXG4gICAgICAgIGlmICh0aGlzLm1vZGFsSGVhZGVyKSB7XHJcbiAgICAgICAgICAgIGlmICghdGhpcy5kbGdIZWFkZXJMaW5lSGVpZ2h0KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmRsZ0hlYWRlckxpbmVIZWlnaHQgPSAwO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjb25zdCBoaCA9IE1hdGguY2VpbCh0aGlzLm1vZGFsSGVhZGVyLm5hdGl2ZUVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkuaGVpZ2h0KTtcclxuICAgICAgICAgICAgdGhpcy5kbGdIZWFkZXJMaW5lSGVpZ2h0ID0gaGg7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmRsZ0hlYWRlckxpbmVIZWlnaHQ7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gMDtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGdldERpYWxvZ0Zvb3RlckhlaWdodCgpIHtcclxuICAgICAgICBpZiAoIXRoaXMuZm9vdGVyRWwpIHtcclxuICAgICAgICAgICAgY29uc3QgX2Zvb3RlckVsID0gIHRoaXMubW9kYWxDb250ZW50Lm5hdGl2ZUVsZW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsLWZvb3RlcicpO1xyXG4gICAgICAgICAgICB0aGlzLmZvb3RlckVsID0gX2Zvb3RlckVsOyBcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKCF0aGlzLmRsZ0Zvb3RlckxpbmVIZWlnaHQpIHtcclxuICAgICAgICAgICAgdGhpcy5kbGdGb290ZXJMaW5lSGVpZ2h0ID0gMDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICh0aGlzLmZvb3RlckVsKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZm9vdGVyRWwuc3R5bGUuaGVpZ2h0ID0gJ2F1dG8nO1xyXG4gICAgICAgICAgICBjb25zdCBfZmggPSBNYXRoLmNlaWwodGhpcy5mb290ZXJFbC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5oZWlnaHQpO1xyXG4gICAgICAgICAgICB0aGlzLmRsZ0Zvb3RlckxpbmVIZWlnaHQgPSBfZmg7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gdGhpcy5kbGdGb290ZXJMaW5lSGVpZ2h0O1xyXG5cclxuICAgICAgICAvLyBjb25zdCBmb290ZXJFbCA9ICB0aGlzLm1vZGFsQ29udGVudC5uYXRpdmVFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbC1mb290ZXInKTtcclxuICAgICAgICAvLyBpZiAoZm9vdGVyRWwpIHtcclxuICAgICAgICAvLyAgICAgaWYgKCF0aGlzLmRsZ0Zvb3RlckxpbmVIZWlnaHQpIHtcclxuICAgICAgICAvLyAgICAgICAgIHRoaXMuZGxnRm9vdGVyTGluZUhlaWdodCA9IE1hdGguY2VpbChmb290ZXJFbC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5oZWlnaHQpO1xyXG4gICAgICAgIC8vICAgICB9XHJcblxyXG4gICAgICAgIC8vICAgICByZXR1cm4gdGhpcy5kbGdGb290ZXJMaW5lSGVpZ2h0O1xyXG4gICAgICAgIC8vIH1cclxuXHJcbiAgICAgICAgLy8gcmV0dXJuICAwO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgX2NoZWNrRGlhbG9nU2l6ZSh3aWR0aDogbnVtYmVyLCBoZWlnaHQ6IG51bWJlcikge1xyXG5cclxuICAgICAgICAvLyDlj6/op4bljLrln5/lsLrlr7hcclxuICAgICAgICBjb25zdCB3aW5TaXplID0ge1xyXG4gICAgICAgICAgICB3aWR0aDogZG9jdW1lbnQuYm9keS5vZmZzZXRXaWR0aCxcclxuICAgICAgICAgICAgaGVpZ2h0OiB3aW5kb3cuaW5uZXJIZWlnaHRcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICBpZiAodGhpcy5wYXJlbnRFbGVtZW50KSB7XHJcbiAgICAgICAgICAgIHdpblNpemUud2lkdGggPSB0aGlzLnBhcmVudEVsZW1lbnQub2Zmc2V0V2lkdGg7XHJcbiAgICAgICAgICAgIHdpblNpemUuaGVpZ2h0ID0gdGhpcy5wYXJlbnRFbGVtZW50Lm9mZnNldEhlaWdodDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICh3aW5TaXplLndpZHRoICYmIHdpblNpemUud2lkdGggPCB3aWR0aCkge1xyXG4gICAgICAgICAgICB3aWR0aCA9IHdpblNpemUud2lkdGg7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAod2luU2l6ZS5oZWlnaHQgJiYgd2luU2l6ZS5oZWlnaHQgPCBoZWlnaHQpIHtcclxuICAgICAgICAgICAgaGVpZ2h0ID0gd2luU2l6ZS5oZWlnaHQ7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICB3aWR0aCxcclxuICAgICAgICAgICAgaGVpZ2h0XHJcbiAgICAgICAgfTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGNoZWNrRGlhbG9nU2l6ZSgpIHtcclxuICAgICAgICBjb25zdCBuZXdTaXplID0gdGhpcy5fY2hlY2tEaWFsb2dTaXplKHRoaXMud2lkdGgsIHRoaXMuaGVpZ2h0KTtcclxuICAgICAgICBpZiAodGhpcy53aWR0aCAhPT0gbmV3U2l6ZS53aWR0aCkge1xyXG4gICAgICAgICAgICB0aGlzLndpZHRoID0gbmV3U2l6ZS53aWR0aCAtIDIwO1xyXG4gICAgICAgICAgICB0aGlzLndpZHRoQ2hhbmdlLmVtaXQodGhpcy53aWR0aCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAodGhpcy5oZWlnaHQgIT09IG5ld1NpemUuaGVpZ2h0KSB7XHJcbiAgICAgICAgICAgIHRoaXMuaGVpZ2h0ID0gbmV3U2l6ZS5oZWlnaHQgLSAyMDtcclxuICAgICAgICAgICAgdGhpcy5oZWlnaHRDaGFuZ2UuZW1pdCh0aGlzLmhlaWdodCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHVwZGF0ZU1vZGFsQm9keUhlaWdodCgpIHtcclxuICAgICAgICBjb25zdCBjb250ZW50RWwgPSB0aGlzLmVsLm5hdGl2ZUVsZW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsLWJvZHknKTtcclxuICAgICAgICBjb25zdCBjb250ZW50SGVpZ2h0ID0gdGhpcy5zaXplLmNvbnRlbnRIZWlnaHQ7XHJcbiAgICAgICAgdGhpcy5yZW5kZXIyLnNldFN0eWxlKGNvbnRlbnRFbCwgJ2hlaWdodCcsIGNvbnRlbnRIZWlnaHQgKyAncHgnKTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIHVwZGF0ZVBvc2l0aW9uKCkge1xyXG4gICAgICAgIGNvbnN0IG1hcmdpbkxlZnQgPSBOdW1iZXIucGFyc2VJbnQoJycgKyAtdGhpcy53aWR0aCAvIDIpO1xyXG4gICAgICAgIGNvbnN0IG1hcmdpblRvcCA9IE51bWJlci5wYXJzZUludCgnJyArIC10aGlzLmhlaWdodCAvIDIpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIHRoaXMucG9zdGl0aW9uU3R5bGVzID0ge1xyXG4gICAgICAgICAgICBtYXJnaW5MZWZ0OiBtYXJnaW5MZWZ0KyAncHgnLFxyXG4gICAgICAgICAgICBtYXJnaW5Ub3A6IG1hcmdpblRvcCsgJ3B4JyxcclxuICAgICAgICAgICAgdHJhbnNmb3JtOiAndHJhbnNsYXRlM2QoMHB4LCAwcHgsIDBweCknLFxyXG4gICAgICAgICAgICB0b3A6IGAke3dpbmRvdy5pbm5lckhlaWdodCAvIDIgKyBtYXJnaW5Ub3B9cHhgLFxyXG4gICAgICAgICAgICBsZWZ0OiBgJHt3aW5kb3cuaW5uZXJXaWR0aCAvMiArIG1hcmdpbkxlZnR9cHhgLFxyXG4gICAgICAgICAgICB0b3AxOiB0aGlzLmlzTWF4PyAnMTBweCc6ICc1MCUnLFxyXG4gICAgICAgICAgICBsZWZ0MTogdGhpcy5pc01heD8gJzEwcHgnOiAnNTAlJ1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIFxyXG4gICAgfVxyXG5cclxuICAgIHJlc2V0UG9zaXRpb24oKSB7XHJcbiAgICAgICAgdGhpcy51cGRhdGVQb3NpdGlvbigpO1xyXG4gICAgICAgIGlmICh0aGlzLl9kaWFsb2dFbCkge1xyXG4gICAgICAgICAgICBjb25zdCBkaWFsb2dFbCA9IHRoaXMuX2RpYWxvZ0VsO1xyXG4gICAgICAgICAgICB0aGlzLnJlbmRlcjIuc2V0U3R5bGUoZGlhbG9nRWwsICd0b3AnLCB0aGlzLnBvc3RpdGlvblN0eWxlcy50b3ApO1xyXG4gICAgICAgICAgICB0aGlzLnJlbmRlcjIuc2V0U3R5bGUoZGlhbG9nRWwsICdsZWZ0JywgdGhpcy5wb3N0aXRpb25TdHlsZXMubGVmdCk7XHJcbiAgICAgICAgICAgIHRoaXMucmVuZGVyMi5zZXRTdHlsZShkaWFsb2dFbCwgJ3RyYW5zZm9ybScsIHRoaXMucG9zdGl0aW9uU3R5bGVzLnRyYW5zZm9ybSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgb3BlbkRpYWxvZyhmbGFnOiBib29sZWFuKSB7XHJcbiAgICAgICAgaWYgKGZsYWcpIHtcclxuICAgICAgICAgICAgdGhpcy5yZXNldFBvc2l0aW9uKCk7XHJcbiAgICAgICAgICAgIHRoaXMuZHJhZ2diYXIucmVzZXRQb3NpdGlvbigpO1xyXG4gICAgICAgICAgICB0aGlzLm1vZGFsLnNob3coKTtcclxuXHJcbiAgICAgICAgICAgIC8vIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgICAvLyAgICAgY29uc3QgYmFja2Ryb3BFbCA9IHRoaXMuZWwubmF0aXZlRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuZmFycmlzLW1vZGFsJyk7XHJcbiAgICAgICAgICAgIC8vICAgICBjb25zdCBtb2RhbHMgPSBBcnJheS5mcm9tKGRvY3VtZW50LmJvZHkucXVlcnlTZWxlY3RvckFsbCgnLmZhcnJpcy1tb2RhbC5zaG93JykpLmZpbHRlcigobjogYW55KSA9PiAobi5zdHlsZS5kaXNwbGF5ICE9PSAnbm9uZScgJiYgbiAhPT0gYmFja2Ryb3BFbCkpO1xyXG4gICAgICAgICAgICAvLyAgICAgaWYgKG1vZGFscyAmJiBtb2RhbHMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAvLyAgICAgICAgIGNvbnN0IHpJbmRleEFyciA9IG1vZGFscy5tYXAobiA9PiB7XHJcbiAgICAgICAgICAgIC8vICAgICAgICAgICAgIHJldHVybiBwYXJzZUludCh3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZShuKS5nZXRQcm9wZXJ0eVZhbHVlKCd6LWluZGV4JyksIDEwKTtcclxuICAgICAgICAgICAgLy8gICAgICAgICB9KS5maWx0ZXIobiA9PiBuKTtcclxuICAgICAgICAgICAgLy8gICAgICAgICBjb25zdCBtYXhaSW5kZXggPSBNYXRoLm1heCguLi56SW5kZXhBcnIpO1xyXG4gICAgICAgICAgICAvLyAgICAgICAgIGJhY2tkcm9wRWwuc3R5bGUuekluZGV4ID0gbWF4WkluZGV4ICsgMTtcclxuICAgICAgICAgICAgLy8gICAgIH1cclxuICAgICAgICAgICAgLy8gfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgY2xvc2VEaWFsb2coY2FuQ2xvc2U6IGJvb2xlYW4pIHtcclxuICAgICAgICBpZiAoY2FuQ2xvc2UpIHtcclxuICAgICAgICAgICAgdGhpcy5tb2RhbC5oaWRlKCk7XHJcblxyXG4gICAgICAgICAgICAvLyB0aGlzLmNsb3NlZC5lbWl0KCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHNob3coKSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gdGhpcy5iZWZvcmVPcGVuKCk7XHJcbiAgICAgICAgaWYgKHR5cGVvZiByZXN1bHQgPT09ICdib29sZWFuJykge1xyXG4gICAgICAgICAgICB0aGlzLm9wZW5EaWFsb2cocmVzdWx0KTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBpZiAocmVzdWx0IGluc3RhbmNlb2YgT2JzZXJ2YWJsZSkge1xyXG4gICAgICAgICAgICAgICAgcmVzdWx0LnN1YnNjcmliZSgoZmxhZzogYm9vbGVhbikgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMub3BlbkRpYWxvZyhmbGFnKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgaWYgKHJlc3VsdCBpbnN0YW5jZW9mIFByb21pc2UpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXN1bHQudGhlbigoZmxhZzogYm9vbGVhbikgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9wZW5EaWFsb2coZmxhZyk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgY2xvc2UoJGV2ZW50PzogTW91c2VFdmVudCkge1xyXG4gICAgICAgIGlmICgkZXZlbnQpIHtcclxuICAgICAgICAgICAgJGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCByZXN1bHQgPSB0aGlzLmJlZm9yZUNsb3NlKCk7XHJcbiAgICAgICAgaWYgKHR5cGVvZiByZXN1bHQgPT09ICdib29sZWFuJykge1xyXG4gICAgICAgICAgICB0aGlzLmNsb3NlRGlhbG9nKHJlc3VsdCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgaWYgKHJlc3VsdCBpbnN0YW5jZW9mIE9ic2VydmFibGUpIHtcclxuICAgICAgICAgICAgICAgIHJlc3VsdC5zdWJzY3JpYmUoKGZsYWc6IGJvb2xlYW4pID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmNsb3NlRGlhbG9nKGZsYWcpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBpZiAocmVzdWx0IGluc3RhbmNlb2YgUHJvbWlzZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdC50aGVuKChmbGFnOiBib29sZWFuKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY2xvc2VEaWFsb2coZmxhZyk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcmVTaXplKHNpemU6IHsgd2lkdGg/OiBudW1iZXIsIGhlaWdodD86IG51bWJlciB9KSB7XHJcbiAgICAgICAgaWYgKHNpemUud2lkdGgpIHtcclxuICAgICAgICAgICAgdGhpcy53aWR0aCA9IHNpemUud2lkdGg7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChzaXplLmhlaWdodCkge1xyXG4gICAgICAgICAgICB0aGlzLmhlaWdodCA9IHNpemUuaGVpZ2h0O1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5yZXNldFBvc2l0aW9uKCk7XHJcbiAgICAgICAgdGhpcy5kcmFnZ2Jhci5yZXNldFBvc2l0aW9uKCk7XHJcbiAgICAgICAgdGhpcy53aWR0aENoYW5nZS5lbWl0KHRoaXMud2lkdGgpO1xyXG4gICAgICAgIHRoaXMuaGVpZ2h0Q2hhbmdlLmVtaXQodGhpcy5oZWlnaHQpO1xyXG4gICAgICAgIHRoaXMucmVzaXplZC5lbWl0KHsgc2l6ZTogeyB3aWR0aDogdGhpcy53aWR0aCwgaGVpZ2h0OiB0aGlzLmhlaWdodCB9IH0pO1xyXG4gICAgfVxyXG5cclxuICAgIG9uUmVzaXppbmcob3B0czogYW55KSB7XHJcblxyXG4gICAgICAgIG9wdHMuc2l6ZS53aWR0aCA9IG9wdHMuc2l6ZS53aWR0aCA8IDEwMCA/IDEwMCA6IG9wdHMuc2l6ZS53aWR0aDtcclxuICAgICAgICBvcHRzLnNpemUuaGVpZ2h0ID0gb3B0cy5zaXplLmhlaWdodCA8IDEwMCA/IDEwMCA6IG9wdHMuc2l6ZS5oZWlnaHQ7XHJcblxyXG4gICAgICAgIHRoaXMud2lkdGggPSBvcHRzLnNpemUud2lkdGg7XHJcbiAgICAgICAgdGhpcy5oZWlnaHQgPSBvcHRzLnNpemUuaGVpZ2h0O1xyXG4gICAgICAgIHRoaXMucmVzaXppbmcuZW1pdChvcHRzKTtcclxuICAgIH1cclxuXHJcbiAgICByZXNpemVTdG9wKG9wdHM6IGFueSkge1xyXG4gICAgICAgIG9wdHMuc2l6ZS53aWR0aCA9IG9wdHMuc2l6ZS53aWR0aCA8IDEwMCA/IDEwMCA6IG9wdHMuc2l6ZS53aWR0aDtcclxuICAgICAgICBvcHRzLnNpemUuaGVpZ2h0ID0gb3B0cy5zaXplLmhlaWdodCA8IDEwMCA/IDEwMCA6IG9wdHMuc2l6ZS5oZWlnaHQ7XHJcblxyXG4gICAgICAgIHRoaXMud2lkdGggPSBvcHRzLnNpemUud2lkdGg7XHJcbiAgICAgICAgdGhpcy5oZWlnaHQgPSBvcHRzLnNpemUuaGVpZ2h0O1xyXG4gICAgICAgIHRoaXMudXBkYXRlTW9kYWxCb2R5SGVpZ2h0KCk7XHJcblxyXG4gICAgICAgIHRoaXMud2lkdGhDaGFuZ2UuZW1pdCh0aGlzLndpZHRoKTtcclxuICAgICAgICB0aGlzLmhlaWdodENoYW5nZS5lbWl0KHRoaXMuaGVpZ2h0KTtcclxuXHJcbiAgICAgICAgdGhpcy5yZXNpemVkLmVtaXQob3B0cyk7XHJcbiAgICB9XHJcblxyXG4gICAgZHJvcGRvd24oZWw6IGFueSkge1xyXG4gICAgICAgIC8vIGNvbnN0IHJlY3QgPSBlbC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcclxuICAgICAgICAvLyB0aGlzLnJlbmRlcjIucmVtb3ZlU3R5bGUoZWwsICdtYXJnaW4tdG9wJyk7XHJcbiAgICAgICAgLy8gdGhpcy5yZW5kZXIyLnJlbW92ZVN0eWxlKGVsLCAnbWFyZ2luLWxlZnQnKTtcclxuICAgICAgICAvLyB0aGlzLnJlbmRlcjIuc2V0U3R5bGUoZWwsICd0b3AnLCBgJHtyZWN0LnRvcH1weGApO1xyXG4gICAgICAgIC8vIHRoaXMucmVuZGVyMi5zZXRTdHlsZShlbCwgJ2xlZnQnLCBgJHtyZWN0LmxlZnR9cHhgKTtcclxuXHJcbiAgICAgICAgLy8gdGhpcy5yZW5kZXIyLnJlbW92ZVN0eWxlKGVsLCAndHJhbnNmb3JtJyk7XHJcbiAgICAgICAgLy8gdGhpcy5yZW5kZXIyLnJlbW92ZVN0eWxlKGVsLCAnLXdlYmtpdC10cmFuc2Zvcm0nKTtcclxuICAgICAgICAvLyB0aGlzLnJlbmRlcjIucmVtb3ZlU3R5bGUoZWwsICctbXMtdHJhbnNmb3JtJyk7XHJcbiAgICAgICAgLy8gdGhpcy5yZW5kZXIyLnJlbW92ZVN0eWxlKGVsLCAnLW1vei10cmFuc2Zvcm0nKTtcclxuICAgICAgICAvLyB0aGlzLnJlbmRlcjIucmVtb3ZlU3R5bGUoZWwsICctby10cmFuc2Zvcm0nKTtcclxuICAgIH1cclxuXHJcbiAgICBtYXhEaWFsb2cocmVtZW1iZXJQcmV2U2l6ZSA9IHRydWUpIHtcclxuICAgICAgICBpZiAoIXRoaXMuZWwpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAocmVtZW1iZXJQcmV2U2l6ZSkge1xyXG4gICAgICAgICAgICB0aGlzLnByZXZXaWR0aCA9IHRoaXMud2lkdGg7XHJcbiAgICAgICAgICAgIHRoaXMucHJldkhlaWdodCA9IHRoaXMuaGVpZ2h0O1xyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICBjb25zdCB7IHdpZHRoOiB3aW5XaWR0aCwgaGVpZ2h0OiB3aW5IZWlnaHQsIHBhZGRpbmcgfSA9IHRoaXMuZ2V0U2NyZWVuU2l6ZSgpO1xyXG4gICAgICAgIHRoaXMud2lkdGggPSB3aW5XaWR0aDtcclxuICAgICAgICB0aGlzLmhlaWdodCA9IHdpbkhlaWdodDtcclxuXHJcblxyXG4gICAgICAgIHRoaXMuZHJhZ2dhYmxlID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5yZXNpemFibGUgPSBmYWxzZTtcclxuICAgICAgICBcclxuXHJcbiAgICAgICAgdGhpcy5pc01heCA9IHRydWU7XHJcbiAgICAgICAgdGhpcy50b0NlbnRlcigwLCAwKTtcclxuXHJcbiAgICAgICAgY29uc3QgZGlhbG9nRWwgPSB0aGlzLmVsLm5hdGl2ZUVsZW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsLWRpYWxvZycpO1xyXG5cclxuICAgICAgICB0aGlzLnJlbmRlcjIuc2V0U3R5bGUoZGlhbG9nRWwsICd0b3AnLCBwYWRkaW5nKTtcclxuICAgICAgICB0aGlzLnJlbmRlcjIuc2V0U3R5bGUoZGlhbG9nRWwsICdsZWZ0JywgcGFkZGluZyk7XHJcblxyXG5cclxuICAgICAgICB0aGlzLnJlc2l6ZWQuZW1pdCh7IHNpemU6IHsgd2lkdGg6IHRoaXMud2lkdGgsIGhlaWdodDogdGhpcy5oZWlnaHQgfSB9KTtcclxuICAgICAgICB0aGlzLm1heGVkLmVtaXQoeyBzaXplOiB7IHdpZHRoOiB0aGlzLndpZHRoLCBoZWlnaHQ6IHRoaXMuaGVpZ2h0IH0gfSk7XHJcbiAgICB9XHJcblxyXG4gICAgcmV2ZXJ0RGlhbG9nKCkge1xyXG4gICAgICAgIHRoaXMuaXNNYXggPSBmYWxzZTtcclxuXHJcbiAgICAgICAgY29uc3QgeyB3aWR0aDogd3csIGhlaWdodDogd2ggfSA9IHRoaXMuZ2V0U2NyZWVuU2l6ZSgpO1xyXG5cclxuICAgICAgICB0aGlzLndpZHRoID0gdGhpcy5wcmV2V2lkdGggPT0gd3cgPyB0aGlzLm9yaWdpbmFsV2lkdGggOiB0aGlzLnByZXZXaWR0aDtcclxuICAgICAgICB0aGlzLmhlaWdodCA9IHRoaXMucHJldkhlaWdodCA9PSB3aCA/IHRoaXMub3JpZ2luYWxIZWlnaHQgOiB0aGlzLnByZXZIZWlnaHQ7XHJcbiAgICAgICBcclxuICAgICAgICBpZiAodGhpcy53aWR0aCA+IHd3KSB7XHJcbiAgICAgICAgICAgIHRoaXMud2lkdGggPSB3dztcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICh0aGlzLmhlaWdodCA+IHdoKSB7XHJcbiAgICAgICAgICAgIHRoaXMuaGVpZ2h0ID0gd2g7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLmRyYWdnYWJsZSA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5yZXNpemFibGUgPSB0cnVlO1xyXG4gICAgICAgIHRoaXMucmVzZXRQb3NpdGlvbigpO1xyXG4gICAgICAgIHRoaXMuZHJhZ2diYXIucmVzZXRQb3NpdGlvbigpO1xyXG4gICAgICAgIHRoaXMucmVzaXplZC5lbWl0KHsgc2l6ZTogeyB3aWR0aDogdGhpcy53aWR0aCwgaGVpZ2h0OiB0aGlzLmhlaWdodCB9IH0pO1xyXG4gICAgICAgIHRoaXMubWF4ZWQuZW1pdCh7IHNpemU6IHsgd2lkdGg6IHRoaXMud2lkdGgsIGhlaWdodDogdGhpcy5oZWlnaHQgfSB9KTtcclxuICAgIH1cclxuXHJcbiAgICBjaGFuZ2VEaWFsb2dTaXplKCkge1xyXG4gICAgICAgIGlmICh0aGlzLmlzTWF4KSB7XHJcbiAgICAgICAgICAgIHRoaXMucmV2ZXJ0RGlhbG9nKCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5tYXhEaWFsb2coKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5fd2luZG93UmVzaXplVG9NYXggPSBmYWxzZTtcclxuICAgIH1cclxuXHJcbiAgICBvbk1vdmluZygkZXZlbnQpIHtcclxuICAgICAgICB0aGlzLm1vdmluZy5lbWl0KHsgdGFyZ2V0OiB0aGlzLmRpYWxvZ0VsLm5hdGl2ZUVsZW1lbnQgLCAuLi4kZXZlbnQgfSk7XHJcbiAgICB9XHJcbn1cclxuIl19