!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core"),require("@farris/ui-datagrid"),require("@farris/ui-notify"),require("@angular/forms"),require("@angular/common")):"function"==typeof define&&define.amd?define("@farris/ide-enum-editor",["exports","@angular/core","@farris/ui-datagrid","@farris/ui-notify","@angular/forms","@angular/common"],e):e(((t=t||self).farris=t.farris||{},t.farris["ide-enum-editor"]={}),t.ng.core,t.uiDatagrid,t.uiNotify,t.ng.forms,t.ng.common)}(this,function(t,e,n,i,r,a){"use strict";var o=function(){return(o=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)};function l(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var i,r,a=n.call(t),o=[];try{for(;(void 0===e||e-- >0)&&!(i=a.next()).done;)o.push(i.value)}catch(l){r={error:l}}finally{try{i&&!i.done&&(n=a["return"])&&n.call(a)}finally{if(r)throw r.error}}return o}function u(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(l(arguments[e]));return t}var s=function(){function t(t,n,i,r,a){this.notifyService=t,this.injector=n,this.render=i,this.el=r,this.cd=a,this.closeModal=new e.EventEmitter,this.submitModal=new e.EventEmitter,this.editorParams={},this.valueChange=new e.EventEmitter,this.modalConfig={title:"枚举编辑器",width:900,height:500,showButtons:!0},this.columns=[]}return t.prototype.ngOnInit=function(){this.columns=[{field:"name",title:"名称",width:100,template:this.nameTemp},{field:"value",title:"值",width:100,template:this.valueTemp},{title:"操作",width:100,template:this.activeTemp,halign:"center",align:"center"}],this.value&&0!==this.value.length?this.value=this.value.map(function(t,e){return o({id:e+1},t)}):this.value=[],this.render.addClass(this.el.nativeElement,"f-utils-absolute-all"),this.render.addClass(this.el.nativeElement,"f-utils-flex-column")},t.prototype.ngOnChanges=function(t){},t.prototype.map2EnumData=function(){return this.value.map(function(t){return{name:t.name,value:t.value}})},t.prototype.changeEmit=function(){this.cd.detectChanges(),this.valueChange.emit(this.value)},t.prototype.clickCancel=function(){this.closeModal.emit()},t.prototype.clickConfirm=function(){if(this.checkBeforeSave()){var t=this.map2EnumData();this.submitModal.emit({value:t})}},t.prototype.checkBeforeSave=function(){var t,e,n={type:"warning",title:"系统提示",msg:"请添加枚举值。",timeout:3e3};if(!this.value||0===this.value.length)return this.notifyService.warning(n),!1;try{for(var i=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}}(this.value),r=i.next();!r.done;r=i.next()){var a=r.value;if(!a.name||!a.value)return n.msg="枚举值和枚举名称均不允许为空。",this.notifyService.warning(n),!1}}catch(d){t={error:d}}finally{try{r&&!r.done&&(e=i["return"])&&e.call(i)}finally{if(t)throw t.error}}var o=this.value.map(function(t){return t.value}),l=new Set(o),u=Array.from(l);if(o.length!==u.length)return n.msg="枚举值不允许重复。",!1;var s=this.value.map(function(t){return t.name}),c=new Set(s),p=Array.from(c);return s.length===p.length||(n.msg="枚举名称不允许重复。",this.notifyService.warning(n),!1)},t.prototype.add=function(){this.value=u(this.value,[{id:this.value.length+1,name:"",value:""}]),this.changeEmit()},t.prototype.remove=function(){var t=this.dg.checkeds;t&&t.length?(this.value=this.value.filter(function(e){return-1===t.findIndex(function(t){return t.id===e.id})}),this.changeEmit()):this.notifyService.warning("请钩选要删除的数据！")},t.prototype.deleteItem=function(t){this.value=this.value.filter(function(e){return e.id!==t}),this.changeEmit()},t.prototype.moveTop=function(t,e,n){t.stopPropagation();var i=this.value.findIndex(function(t){return t.id===e});return this.value.unshift(this.value[i]),this.value.splice(i+1,1),this.value=u(this.value),this.changeEmit(),!1},t.prototype.moveBottom=function(t,e,n){t.stopPropagation();var i=this.value.findIndex(function(t){return t.id===e});return this.value.push(this.value[i]),this.value.splice(i,1),this.value=u(this.value),this.changeEmit(),!1},t.prototype.moveUp=function(t,e,n){var i;t.stopPropagation();var r=this.value.findIndex(function(t){return t.id===e});if(0!==r){var a=this.value.splice(r,1);(i=this.value).splice.apply(i,u([r-1,0],a)),this.value=u(this.value),this.changeEmit()}return!1},t.prototype.moveDown=function(t,e,n){var i;t.stopPropagation();var r=this.value.length,a=this.value.findIndex(function(t){return t.id===e});if(a!==r-1){var o=this.value.splice(a,1);(i=this.value).splice.apply(i,u([a+1,0],o)),this.value=u(this.value),this.changeEmit()}return!1},t.decorators=[{type:e.Component,args:[{selector:"ide-enum-editor",template:'\n    <div class="border-bottom mb-1 py-1">\n        <button class="btn btn-primary mr-1 ml-2" (click)="add()"> 新增</button>\n        <button class="btn btn-default mr-1" (click)="remove()">删除</button>\n    </div>\n    <div class="d-flex flex-column flex-fill">\n        <farris-datagrid #dg [idField]="\'id\'"\n            [columns]="columns" [sizeType]="\'md\'" [showAllCheckbox]="true"\n            [striped]="false" [showCheckbox]="true" [multiSelect]="true"\n            [data]="value" [fit]="true" [fitColumns]="true"\n            [showBorder]="true" [pagination]="false"\n            [selectOnCheck]="false" [checkOnSelect]="false"\n        ></farris-datagrid>\n\n        <ng-template #nameTemp let-ctx>\n            <div class="f-datagrid-cell-formgroup farris-group-auto">\n                <input type="text" class="form-control" name="name" [(ngModel)]="ctx.rowData[\'name\']">\n            </div>\n        </ng-template>\n        <ng-template #valueTemp let-ctx>\n            <div class="f-datagrid-cell-formgroup farris-group-auto">\n                <input type="text" class="form-control" [(ngModel)]="ctx.rowData[\'value\']" name="value">\n            </div>\n        </ng-template>\n\n        <ng-template #activeTemp let-ctx>\n            <button type="button" class="btn btn-warning  mr-1" (click)="deleteItem(ctx.rowData.id)">删除</button>\n            <button class="btn btn-info mr-1" style="padding: 2px 5px" (click)="moveTop($event, ctx.rowData.id, ctx.rowIndex)" title="置顶">\n                <span class="f-icon f-icon-roofing"></span>\n            </button>\n            <button class="btn btn-info mr-1" style="padding: 2px 5px" (click)="moveUp($event, ctx.rowData.id, ctx.rowIndex)" title="上移">\n                <span class="f-icon f-icon-arrow-chevron-up"></span>\n            </button>\n            <button class="btn btn-info mr-1"  style="padding: 2px 5px" (click)="moveDown($event, ctx.rowData.id, ctx.rowIndex)" title="下移">\n                <span class="f-icon f-icon-arrow-chevron-down"></span>\n            </button>\n            <button class="btn btn-info mr-1" style="padding: 2px 5px" (click)="moveBottom($event, ctx.rowData.id, ctx.rowIndex)" title="置底">\n                <span class="f-icon f-icon-bottomsetting"></span>\n            </button>\n        </ng-template>\n\n    </div>\n    <ng-template #enumFooter>\n        <div class="btns">\n            <button type="button" class="btn btn-outline-secondary btn-sm px-3" (click)="clickCancel()" > 取消 </button>\n            &nbsp;&nbsp;\n            <button  type="button"  class="btn btn-outline-primary btn-sm px-3" (click)="clickConfirm()" > 确定 </button>\n        </div>\n    </ng-template>\n    '}]}],t.ctorParameters=function(){return[{type:i.NotifyService},{type:e.Injector},{type:e.Renderer2},{type:e.ElementRef},{type:e.ChangeDetectorRef}]},t.propDecorators={closeModal:[{type:e.Output}],submitModal:[{type:e.Output}],value:[{type:e.Input}],editorParams:[{type:e.Input}],modalFooter:[{type:e.ViewChild,args:["enumFooter"]}],dg:[{type:e.ViewChild,args:["dg"]}],nameTemp:[{type:e.ViewChild,args:["nameTemp"]}],valueTemp:[{type:e.ViewChild,args:["valueTemp"]}],activeTemp:[{type:e.ViewChild,args:["activeTemp"]}],valueChange:[{type:e.Output}]},t}(),c=function(){function t(){}return t.decorators=[{type:e.NgModule,args:[{declarations:[s],imports:[a.CommonModule,r.FormsModule,n.DatagridModule,i.NotifyModule.forRoot()],exports:[s]}]}],t}();t.IdeEnumEditorComponent=s,t.IdeEnumEditorModule=c,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=farris-ide-enum-editor.umd.min.js.map