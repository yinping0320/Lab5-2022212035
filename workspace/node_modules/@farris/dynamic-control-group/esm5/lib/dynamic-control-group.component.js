/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, Input, HostBinding, ChangeDetectorRef } from '@angular/core';
import { FormGroup } from '@angular/forms';
import { DynamicControlGroupService } from './services/dynamic-control-group.service';
var DynamicControlGroupComponent = /** @class */ (function () {
    function DynamicControlGroupComponent(controlGroupService, cdRef) {
        this.controlGroupService = controlGroupService;
        this.cdRef = cdRef;
        this.form = null;
        this.isControlInline = true;
        this.isEmbedded = false;
    }
    /**
     * @param {?} changes
     * @return {?}
     */
    DynamicControlGroupComponent.prototype.ngOnChanges = /**
     * @param {?} changes
     * @return {?}
     */
    function (changes) {
        this.className = this.initStyles();
        if (this.isGrouped && this.contents) {
            this.controlEntries = Array.from(this.groupControls(this.contents).entries());
        }
    };
    /**
     * @return {?}
     */
    DynamicControlGroupComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        //使用模态框动态加载本组件时，拿到了本组件的实例，同时初始赋值，会在此第一次拿到@input初始值
        this.className = this.initStyles();
        if (this.contents && this.contents.length) {
            this.initFormAndControlEntries();
        }
        else {
            this.uri && this.controlGroupService.getFormControlsByUri(this.uri).subscribe((/**
             * @param {?} data
             * @return {?}
             */
            function (data) {
                _this.contents = data;
                _this.initFormAndControlEntries();
            }));
        }
    };
    /**
     * @return {?}
     */
    DynamicControlGroupComponent.prototype.initFormAndControlEntries = /**
     * @return {?}
     */
    function () {
        // this.form = this.controlGroupService.toFormGroup(this.contents, this.form);
        if (this.isGrouped) {
            this.controlEntries = Array.from(this.groupControls(this.contents).entries());
        }
        this.form.setValue(this.controlGroupService.toFormValue(this.contents, this.formData));
    };
    /**
     * @param {?} contents
     * @return {?}
     */
    DynamicControlGroupComponent.prototype.groupControls = /**
     * @param {?} contents
     * @return {?}
     */
    function (contents) {
        /** @type {?} */
        var groupedControls = new Map();
        contents.forEach((/**
         * @param {?} control
         * @return {?}
         */
        function (control) {
            if (groupedControls.has(control.groupName)) {
                groupedControls.get(control.groupName).push(control);
            }
            else {
                groupedControls.set(control.groupName, [control]);
            }
        }));
        return groupedControls;
    };
    /**
     * @return {?}
     */
    DynamicControlGroupComponent.prototype.initStyles = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var styleClass;
        styleClass = this.isGrouped ? "f-form-layout" : "f-utils-flex-row-wrap";
        styleClass = this.extraClassNames ? styleClass.concat(" " + this.extraClassNames) : styleClass;
        styleClass = this.isEmbedded ? styleClass : styleClass.concat(" farris-form");
        styleClass = this.isControlInline ? styleClass.concat(" farris-form-controls-inline") : styleClass;
        return styleClass;
    };
    /**
     * @return {?}
     */
    DynamicControlGroupComponent.prototype.ngAfterViewChecked = /**
     * @return {?}
     */
    function () {
        // this.cdRef.detectChanges();
    };
    DynamicControlGroupComponent.decorators = [
        { type: Component, args: [{
                    selector: 'farris-dynamic-control-group',
                    template: "\n    <ng-container *ngIf=\"!isGrouped && form\">\n        <ng-container *ngFor=\"let control of contents\" dynamicFormControl [data]=\"control\" [formGroup]=\"form\"></ng-container>\n    </ng-container>\n\n    <ng-container *ngIf=\"isGrouped && form\">\n        <ng-container *ngFor=\"let groupData of controlEntries\">\n            <fieldset class=\"f-section-formgroup\">\n                <legend class=\"f-section-formgroup-legend\" farrisCollapse [title]=\"groupData[0]\"></legend>\n                <div class=\"f-section-formgroup-inputs\">\n                    <ng-container *ngFor=\"let entry of groupData[1]\" dynamicFormControl [data]=\"entry\" [formGroup]=\"form\"></ng-container>\n                </div>\n            </fieldset>\n        </ng-container>\n    </ng-container>\n  ",
                    providers: [
                        DynamicControlGroupService
                    ]
                }] }
    ];
    /** @nocollapse */
    DynamicControlGroupComponent.ctorParameters = function () { return [
        { type: DynamicControlGroupService },
        { type: ChangeDetectorRef }
    ]; };
    DynamicControlGroupComponent.propDecorators = {
        className: [{ type: HostBinding, args: ['class',] }],
        contents: [{ type: Input }],
        form: [{ type: Input }],
        extraClassNames: [{ type: Input }],
        isControlInline: [{ type: Input }],
        isEmbedded: [{ type: Input }],
        formData: [{ type: Input }],
        uri: [{ type: Input }],
        isGrouped: [{ type: Input }]
    };
    return DynamicControlGroupComponent;
}());
export { DynamicControlGroupComponent };
if (false) {
    /** @type {?} */
    DynamicControlGroupComponent.prototype.className;
    /** @type {?} */
    DynamicControlGroupComponent.prototype.contents;
    /** @type {?} */
    DynamicControlGroupComponent.prototype.form;
    /** @type {?} */
    DynamicControlGroupComponent.prototype.extraClassNames;
    /** @type {?} */
    DynamicControlGroupComponent.prototype.isControlInline;
    /** @type {?} */
    DynamicControlGroupComponent.prototype.isEmbedded;
    /** @type {?} */
    DynamicControlGroupComponent.prototype.formData;
    /** @type {?} */
    DynamicControlGroupComponent.prototype.uri;
    /** @type {?} */
    DynamicControlGroupComponent.prototype.isGrouped;
    /** @type {?} */
    DynamicControlGroupComponent.prototype.controlEntries;
    /**
     * @type {?}
     * @private
     */
    DynamicControlGroupComponent.prototype.controlGroupService;
    /**
     * @type {?}
     * @private
     */
    DynamicControlGroupComponent.prototype.cdRef;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZHluYW1pYy1jb250cm9sLWdyb3VwLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BmYXJyaXMvZHluYW1pYy1jb250cm9sLWdyb3VwLyIsInNvdXJjZXMiOlsibGliL2R5bmFtaWMtY29udHJvbC1ncm91cC5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUFBLE9BQU8sRUFBRSxTQUFTLEVBQVUsS0FBSyxFQUFFLFdBQVcsRUFBMEMsaUJBQWlCLEVBQXFDLE1BQU0sZUFBZSxDQUFDO0FBRXBLLE9BQU8sRUFBRSxTQUFTLEVBQWUsTUFBTSxnQkFBZ0IsQ0FBQztBQUN4RCxPQUFPLEVBQUUsMEJBQTBCLEVBQUUsTUFBTSwwQ0FBMEMsQ0FBQztBQUV0RjtJQXFESSxzQ0FBb0IsbUJBQStDLEVBQVUsS0FBd0I7UUFBakYsd0JBQW1CLEdBQW5CLG1CQUFtQixDQUE0QjtRQUFVLFVBQUssR0FBTCxLQUFLLENBQW1CO1FBdkJyRyxTQUFJLEdBQWMsSUFBSSxDQUFDO1FBTXZCLG9CQUFlLEdBQVksSUFBSSxDQUFDO1FBR2hDLGVBQVUsR0FBWSxLQUFLLENBQUM7SUFjNkUsQ0FBQzs7Ozs7SUFFMUcsa0RBQVc7Ozs7SUFBWCxVQUFZLE9BQXNCO1FBQzlCLElBQUksQ0FBQyxTQUFTLEdBQUcsSUFBSSxDQUFDLFVBQVUsRUFBRSxDQUFDO1FBQ25DLElBQUcsSUFBSSxDQUFDLFNBQVMsSUFBSSxJQUFJLENBQUMsUUFBUSxFQUFDO1lBQy9CLElBQUksQ0FBQyxjQUFjLEdBQUcsS0FBSyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsYUFBYSxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsQ0FBQyxPQUFPLEVBQUUsQ0FBQyxDQUFDO1NBQ2pGO0lBQ0wsQ0FBQzs7OztJQUVELCtDQUFROzs7SUFBUjtRQUFBLGlCQVdDO1FBVkcsa0RBQWtEO1FBQ2xELElBQUksQ0FBQyxTQUFTLEdBQUcsSUFBSSxDQUFDLFVBQVUsRUFBRSxDQUFDO1FBQ25D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LDRCQUE0Qjs7O0lBRXJDLGlEQUF3Qzs7SUFFeEMsZ0RBQ3FDOztJQUVyQyw0Q0FDdUI7O0lBRXZCLHVEQUN3Qjs7SUFFeEIsdURBQ2dDOztJQUVoQyxrREFDNEI7O0lBRTVCLGdEQUNjOztJQUVkLDJDQUNZOztJQUVaLGlEQUNtQjs7SUFFbkIsc0RBQWtDOzs7OztJQUd0QiwyREFBdUQ7Ozs7O0lBQUUsNkNBQWdDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ29tcG9uZW50LCBPbkluaXQsIElucHV0LCBIb3N0QmluZGluZywgT3V0cHV0LCBFdmVudEVtaXR0ZXIsIEFmdGVyVmlld0NoZWNrZWQsIENoYW5nZURldGVjdG9yUmVmLCBPbkNoYW5nZXMsIFNpbXBsZUNoYW5nZXMsIERvQ2hlY2sgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgSUR5bmFtaWNCYXNlQ29udHJvbCB9IGZyb20gJy4vaW50ZXJmYWNlcy9keW5hbWljLWNvbnRyb2wuaW50ZXJmYWNlJztcclxuaW1wb3J0IHsgRm9ybUdyb3VwLCBGb3JtQnVpbGRlciB9IGZyb20gJ0Bhbmd1bGFyL2Zvcm1zJztcclxuaW1wb3J0IHsgRHluYW1pY0NvbnRyb2xHcm91cFNlcnZpY2UgfSBmcm9tICcuL3NlcnZpY2VzL2R5bmFtaWMtY29udHJvbC1ncm91cC5zZXJ2aWNlJztcclxuXHJcbkBDb21wb25lbnQoe1xyXG4gICAgc2VsZWN0b3I6ICdmYXJyaXMtZHluYW1pYy1jb250cm9sLWdyb3VwJyxcclxuICAgIHRlbXBsYXRlOiBgXHJcbiAgICA8bmctY29udGFpbmVyICpuZ0lmPVwiIWlzR3JvdXBlZCAmJiBmb3JtXCI+XHJcbiAgICAgICAgPG5nLWNvbnRhaW5lciAqbmdGb3I9XCJsZXQgY29udHJvbCBvZiBjb250ZW50c1wiIGR5bmFtaWNGb3JtQ29udHJvbCBbZGF0YV09XCJjb250cm9sXCIgW2Zvcm1Hcm91cF09XCJmb3JtXCI+PC9uZy1jb250YWluZXI+XHJcbiAgICA8L25nLWNvbnRhaW5lcj5cclxuXHJcbiAgICA8bmctY29udGFpbmVyICpuZ0lmPVwiaXNHcm91cGVkICYmIGZvcm1cIj5cclxuICAgICAgICA8bmctY29udGFpbmVyICpuZ0Zvcj1cImxldCBncm91cERhdGEgb2YgY29udHJvbEVudHJpZXNcIj5cclxuICAgICAgICAgICAgPGZpZWxkc2V0IGNsYXNzPVwiZi1zZWN0aW9uLWZvcm1ncm91cFwiPlxyXG4gICAgICAgICAgICAgICAgPGxlZ2VuZCBjbGFzcz1cImYtc2VjdGlvbi1mb3JtZ3JvdXAtbGVnZW5kXCIgZmFycmlzQ29sbGFwc2UgW3RpdGxlXT1cImdyb3VwRGF0YVswXVwiPjwvbGVnZW5kPlxyXG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cImYtc2VjdGlvbi1mb3JtZ3JvdXAtaW5wdXRzXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgPG5nLWNvbnRhaW5lciAqbmdGb3I9XCJsZXQgZW50cnkgb2YgZ3JvdXBEYXRhWzFdXCIgZHluYW1pY0Zvcm1Db250cm9sIFtkYXRhXT1cImVudHJ5XCIgW2Zvcm1Hcm91cF09XCJmb3JtXCI+PC9uZy1jb250YWluZXI+XHJcbiAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgPC9maWVsZHNldD5cclxuICAgICAgICA8L25nLWNvbnRhaW5lcj5cclxuICAgIDwvbmctY29udGFpbmVyPlxyXG4gIGAsXHJcbiAgICBwcm92aWRlcnM6IFtcclxuICAgICAgICBEeW5hbWljQ29udHJvbEdyb3VwU2VydmljZVxyXG4gICAgXVxyXG59KVxyXG5leHBvcnQgY2xhc3MgRHluYW1pY0NvbnRyb2xHcm91cENvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCwgT25DaGFuZ2VzLCBBZnRlclZpZXdDaGVja2VkICB7XHJcblxyXG4gICAgQEhvc3RCaW5kaW5nKCdjbGFzcycpIGNsYXNzTmFtZTogc3RyaW5nO1xyXG5cclxuICAgIEBJbnB1dCgpXHJcbiAgICBjb250ZW50czogQXJyYXk8SUR5bmFtaWNCYXNlQ29udHJvbD47XHJcblxyXG4gICAgQElucHV0KClcclxuICAgIGZvcm06IEZvcm1Hcm91cCA9IG51bGw7XHJcblxyXG4gICAgQElucHV0KClcclxuICAgIGV4dHJhQ2xhc3NOYW1lczogc3RyaW5nO1xyXG5cclxuICAgIEBJbnB1dCgpXHJcbiAgICBpc0NvbnRyb2xJbmxpbmU6IGJvb2xlYW4gPSB0cnVlO1xyXG5cclxuICAgIEBJbnB1dCgpXHJcbiAgICBpc0VtYmVkZGVkOiBib29sZWFuID0gZmFsc2U7XHJcblxyXG4gICAgQElucHV0KClcclxuICAgIGZvcm1EYXRhOiBhbnk7XHJcblxyXG4gICAgQElucHV0KClcclxuICAgIHVyaTogc3RyaW5nO1xyXG5cclxuICAgIEBJbnB1dCgpXHJcbiAgICBpc0dyb3VwZWQ6IGJvb2xlYW47XHJcblxyXG4gICAgY29udHJvbEVudHJpZXM6IEFycmF5PEFycmF5PGFueT4+O1xyXG5cclxuXHJcbiAgICBjb25zdHJ1Y3Rvcihwcml2YXRlIGNvbnRyb2xHcm91cFNlcnZpY2U6IER5bmFtaWNDb250cm9sR3JvdXBTZXJ2aWNlLCBwcml2YXRlIGNkUmVmOiBDaGFuZ2VEZXRlY3RvclJlZikgeyB9XHJcblxyXG4gICAgbmdPbkNoYW5nZXMoY2hhbmdlczogU2ltcGxlQ2hhbmdlcyk6IHZvaWQge1xyXG4gICAgICAgIHRoaXMuY2xhc3NOYW1lID0gdGhpcy5pbml0U3R5bGVzKCk7XHJcbiAgICAgICAgaWYodGhpcy5pc0dyb3VwZWQgJiYgdGhpcy5jb250ZW50cyl7XHJcbiAgICAgICAgICAgIHRoaXMuY29udHJvbEVudHJpZXMgPSBBcnJheS5mcm9tKHRoaXMuZ3JvdXBDb250cm9scyh0aGlzLmNvbnRlbnRzKS5lbnRyaWVzKCkpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBuZ09uSW5pdCgpIHtcclxuICAgICAgICAvL+S9v+eUqOaooeaAgeahhuWKqOaAgeWKoOi9veacrOe7hOS7tuaXtu+8jOaLv+WIsOS6huacrOe7hOS7tueahOWunuS+i++8jOWQjOaXtuWIneWni+i1i+WAvO+8jOS8muWcqOatpOesrOS4gOasoeaLv+WIsEBpbnB1dOWIneWni+WAvFxyXG4gICAgICAgIHRoaXMuY2xhc3NOYW1lID0gdGhpcy5pbml0U3R5bGVzKCk7XHJcbiAgICAgICAgaWYodGhpcy5jb250ZW50cyAmJiB0aGlzLmNvbnRlbnRzLmxlbmd0aCl7XHJcbiAgICAgICAgICAgIHRoaXMuaW5pdEZvcm1BbmRDb250cm9sRW50cmllcygpO1xyXG4gICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICB0aGlzLnVyaSAmJiB0aGlzLmNvbnRyb2xHcm91cFNlcnZpY2UuZ2V0Rm9ybUNvbnRyb2xzQnlVcmkodGhpcy51cmkpLnN1YnNjcmliZShkYXRhID0+IHtcclxuICAgICAgICAgICAgICAgIHRoaXMuY29udGVudHMgPSBkYXRhO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5pbml0Rm9ybUFuZENvbnRyb2xFbnRyaWVzKCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBpbml0Rm9ybUFuZENvbnRyb2xFbnRyaWVzKCl7XHJcbiAgICAgICAgLy8gdGhpcy5mb3JtID0gdGhpcy5jb250cm9sR3JvdXBTZXJ2aWNlLnRvRm9ybUdyb3VwKHRoaXMuY29udGVudHMsIHRoaXMuZm9ybSk7XHJcbiAgICAgICAgaWYodGhpcy5pc0dyb3VwZWQpe1xyXG4gICAgICAgICAgICB0aGlzLmNvbnRyb2xFbnRyaWVzID0gQXJyYXkuZnJvbSh0aGlzLmdyb3VwQ29udHJvbHModGhpcy5jb250ZW50cykuZW50cmllcygpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5mb3JtLnNldFZhbHVlKHRoaXMuY29udHJvbEdyb3VwU2VydmljZS50b0Zvcm1WYWx1ZSh0aGlzLmNvbnRlbnRzLCB0aGlzLmZvcm1EYXRhKSk7XHJcbiAgICB9XHJcblxyXG4gICAgZ3JvdXBDb250cm9scyhjb250ZW50czogQXJyYXk8SUR5bmFtaWNCYXNlQ29udHJvbD4pOiBNYXA8c3RyaW5nLCBBcnJheTxJRHluYW1pY0Jhc2VDb250cm9sPj4ge1xyXG4gICAgICAgIGNvbnN0IGdyb3VwZWRDb250cm9scyA9IG5ldyBNYXA8c3RyaW5nLCBBcnJheTxJRHluYW1pY0Jhc2VDb250cm9sPj4oKTtcclxuICAgICAgICBjb250ZW50cy5mb3JFYWNoKGNvbnRyb2wgPT4ge1xyXG4gICAgICAgICAgICBpZihncm91cGVkQ29udHJvbHMuaGFzKGNvbnRyb2wuZ3JvdXBOYW1lKSl7XHJcbiAgICAgICAgICAgICAgICBncm91cGVkQ29udHJvbHMuZ2V0KGNvbnRyb2wuZ3JvdXBOYW1lKS5wdXNoKGNvbnRyb2wpO1xyXG4gICAgICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgICAgIGdyb3VwZWRDb250cm9scy5zZXQoY29udHJvbC5ncm91cE5hbWUsIFtjb250cm9sXSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4gZ3JvdXBlZENvbnRyb2xzO1xyXG4gICAgfVxyXG5cclxuICAgIGluaXRTdHlsZXMoKTogc3RyaW5ne1xyXG4gICAgICAgIGxldCBzdHlsZUNsYXNzOiBzdHJpbmc7XHJcbiAgICAgICAgc3R5bGVDbGFzcyA9IHRoaXMuaXNHcm91cGVkID8gXCJmLWZvcm0tbGF5b3V0XCIgOiBcImYtdXRpbHMtZmxleC1yb3ctd3JhcFwiO1xyXG4gICAgICAgIHN0eWxlQ2xhc3MgPSB0aGlzLmV4dHJhQ2xhc3NOYW1lcyA/IHN0eWxlQ2xhc3MuY29uY2F0KGAgJHt0aGlzLmV4dHJhQ2xhc3NOYW1lc31gKSA6IHN0eWxlQ2xhc3M7XHJcbiAgICAgICAgc3R5bGVDbGFzcyA9IHRoaXMuaXNFbWJlZGRlZCA/IHN0eWxlQ2xhc3MgOiBzdHlsZUNsYXNzLmNvbmNhdChcIiBmYXJyaXMtZm9ybVwiKTtcclxuICAgICAgICBzdHlsZUNsYXNzID0gdGhpcy5pc0NvbnRyb2xJbmxpbmUgPyBzdHlsZUNsYXNzLmNvbmNhdChcIiBmYXJyaXMtZm9ybS1jb250cm9scy1pbmxpbmVcIikgOiBzdHlsZUNsYXNzO1xyXG4gICAgICAgIHJldHVybiBzdHlsZUNsYXNzO1xyXG4gICAgfVxyXG5cclxuICAgIG5nQWZ0ZXJWaWV3Q2hlY2tlZCgpIHtcclxuICAgICAgICAvLyB0aGlzLmNkUmVmLmRldGVjdENoYW5nZXMoKTtcclxuICAgIH1cclxuXHJcbn1cclxuIl19