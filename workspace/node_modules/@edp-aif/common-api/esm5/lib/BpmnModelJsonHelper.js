/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
var BpmnModelJsonHelper = /** @class */ (function () {
    function BpmnModelJsonHelper() {
    }
    /**
     * @param {?} obj
     * @param {?} attributeName
     * @return {?}
     */
    BpmnModelJsonHelper.GetAttributeValue = /**
     * @param {?} obj
     * @param {?} attributeName
     * @return {?}
     */
    function (obj, attributeName) {
        if (obj == null) {
            return null;
        }
        if (obj.hasOwnProperty(attributeName)) {
            return obj[attributeName];
        }
        else {
            return null;
        }
    };
    /**
     * @template T
     * @param {?} obj
     * @param {?} attributeName
     * @param {?} value
     * @return {?}
     */
    BpmnModelJsonHelper.SetAttributeValue = /**
     * @template T
     * @param {?} obj
     * @param {?} attributeName
     * @param {?} value
     * @return {?}
     */
    function (obj, attributeName, value) {
        var e_1, _a;
        if (obj == null || value == null)
            return;
        /** @type {?} */
        var jsonArray = [];
        if (value instanceof Array) {
            try {
                //判断是否为IJsonSerializable实现类的数组，是则全部调用ConvertToJsonObject序列化，否则直接赋值
                for (var value_1 = tslib_1.__values(value), value_1_1 = value_1.next(); !value_1_1.done; value_1_1 = value_1.next()) {
                    var item = value_1_1.value;
                    if (item["ConvertToJsonObject"] != null && item["LoadFromJsonObject"] != null) {
                        jsonArray.push(item.ConvertToJsonObject());
                    }
                    else {
                        break;
                    }
                }
            }
            catch (e_1_1) { e_1 = { error: e_1_1 }; }
            finally {
                try {
                    if (value_1_1 && !value_1_1.done && (_a = value_1.return)) _a.call(value_1);
                }
                finally { if (e_1) throw e_1.error; }
            }
            if (jsonArray.length == value.length) {
                obj[attributeName] = jsonArray;
            }
            else {
                obj[attributeName] = value;
            }
        }
        else if (value["ConvertToJsonObject"] != null && value["LoadFromJsonObject"] != null) {
            //判断是否为IJsonSerializable实现类的对象，是则调用ConvertToJsonObject序列化
            obj[attributeName] = ((/** @type {?} */ (value))).ConvertToJsonObject();
        }
        else if (value instanceof Date) {
            //判断是否为日期类型，是日期类型则转为字符串UTC的yyyyMMDDhhmmssSSS格式字符串
            /** @type {?} */
            var str = BpmnModelJsonHelper.DateTimeToString(value);
            BpmnModelJsonHelper.SetAttributeValue(obj, attributeName, str);
        }
        else {
            obj[attributeName] = value;
        }
    };
    /**
     * @param {?} obj
     * @param {?} attributeName
     * @return {?}
     */
    BpmnModelJsonHelper.GetAttributeValueAsString = /**
     * @param {?} obj
     * @param {?} attributeName
     * @return {?}
     */
    function (obj, attributeName) {
        if (obj == null) {
            return null;
        }
        if (obj.hasOwnProperty(attributeName) == true && typeof (obj[attributeName]) == "string") {
            return obj[attributeName];
        }
        return null;
    };
    /**
     * @param {?} obj
     * @param {?} attributeName
     * @return {?}
     */
    BpmnModelJsonHelper.GetAttributeValueAsBoolean = /**
     * @param {?} obj
     * @param {?} attributeName
     * @return {?}
     */
    function (obj, attributeName) {
        if (obj == null) {
            return null;
        }
        if (obj.hasOwnProperty(attributeName) == true && typeof (obj[attributeName]) == "boolean") {
            return obj[attributeName];
        }
        return null;
    };
    /**
     * @param {?} obj
     * @param {?} attributeName
     * @return {?}
     */
    BpmnModelJsonHelper.GetAttributeValueAsNumber = /**
     * @param {?} obj
     * @param {?} attributeName
     * @return {?}
     */
    function (obj, attributeName) {
        if (obj == null) {
            return null;
        }
        if (obj.hasOwnProperty(attributeName) == true && typeof (obj[attributeName]) == "number") {
            return obj[attributeName];
        }
        return null;
    };
    /**
     * @template ReturnT, ClassOfT
     * @param {?} obj
     * @param {?} attributeName
     * @param {?} classOfT
     * @return {?}
     */
    BpmnModelJsonHelper.GetAttributeValueAsList = /**
     * @template ReturnT, ClassOfT
     * @param {?} obj
     * @param {?} attributeName
     * @param {?} classOfT
     * @return {?}
     */
    function (obj, attributeName, classOfT) {
        var e_2, _a;
        /** @type {?} */
        var jsonArray = BpmnModelJsonHelper.GetAttributeValue(obj, attributeName);
        if (jsonArray == null) {
            return null;
        }
        /** @type {?} */
        var list = [];
        try {
            for (var jsonArray_1 = tslib_1.__values(jsonArray), jsonArray_1_1 = jsonArray_1.next(); !jsonArray_1_1.done; jsonArray_1_1 = jsonArray_1.next()) {
                var item = jsonArray_1_1.value;
                /** @type {?} */
                var instance = null;
                try {
                    instance = (/** @type {?} */ (new classOfT()));
                }
                catch (e) {
                    throw e;
                }
                instance.LoadFromJsonObject(item);
                list.push(instance);
            }
        }
        catch (e_2_1) { e_2 = { error: e_2_1 }; }
        finally {
            try {
                if (jsonArray_1_1 && !jsonArray_1_1.done && (_a = jsonArray_1.return)) _a.call(jsonArray_1);
            }
            finally { if (e_2) throw e_2.error; }
        }
        return list;
    };
    /**
     * @param {?} obj
     * @param {?} attributeName
     * @return {?}
     */
    BpmnModelJsonHelper.GetAttributeValueAsDateTime = /**
     * @param {?} obj
     * @param {?} attributeName
     * @return {?}
     */
    function (obj, attributeName) {
        return BpmnModelJsonHelper.DateTimeFromString(BpmnModelJsonHelper.GetAttributeValueAsString(obj, attributeName));
    };
    /**
     * @template ReturnT, ClassOfT
     * @param {?} obj
     * @param {?} attributeName
     * @param {?} classOfT
     * @return {?}
     */
    BpmnModelJsonHelper.GetAttributeValueAsJsonSerializable = /**
     * @template ReturnT, ClassOfT
     * @param {?} obj
     * @param {?} attributeName
     * @param {?} classOfT
     * @return {?}
     */
    function (obj, attributeName, classOfT) {
        /** @type {?} */
        var jsonObject = BpmnModelJsonHelper.GetAttributeValue(obj, attributeName);
        if (jsonObject == null) {
            return null;
        }
        /** @type {?} */
        var instance = null;
        try {
            instance = (/** @type {?} */ (new classOfT()));
        }
        catch (e) {
            throw e;
        }
        instance.LoadFromJsonObject(jsonObject);
        return instance;
    };
    /**
     * @param {?} dt
     * @return {?}
     */
    BpmnModelJsonHelper.DateTimeToString = /**
     * @param {?} dt
     * @return {?}
     */
    function (dt) {
        if (dt == null)
            return null;
        /** @type {?} */
        var time = dt.getTime();
        if (time < BpmnModelJsonHelper.MIN_OFFSETDATETIME.getTime() || time > BpmnModelJsonHelper.MAX_OFFSETDATETIME.getTime()) {
            throw "\u7ED9\u5B9A\u7684\u65E5\u671F\u65F6\u95F4\u503C " + dt.toISOString() + " \u8D85\u51FA\u652F\u6301\u8303\u56F4(0001-01-01T12:00:00.000Z - 9999-12-31T23:59:59.000Z):";
        }
        return BpmnModelJsonHelper.dateFormat(dt, "yyyyMMddHHmmssSSS");
    };
    /**
     *
     * @param str 格式为：yyyyMMddHHmmssSSS
     */
    /**
     *
     * @param {?} str 格式为：yyyyMMddHHmmssSSS
     * @return {?}
     */
    BpmnModelJsonHelper.DateTimeFromString = /**
     *
     * @param {?} str 格式为：yyyyMMddHHmmssSSS
     * @return {?}
     */
    function (str) {
        if (str == null)
            return null;
        // const s = `${str.substring(0, 4)}/${str.substring(4, 6)}/${str.substring(6, 8)} ${str.substring(8, 10)}:${str.substring(10, 12)}:${str.substring(12, 14)}.${str.substring(14)}`;
        /** @type {?} */
        var date = new Date();
        date.setUTCFullYear(parseInt(str.substring(0, 4)));
        date.setUTCMonth(parseInt(str.substring(4, 6)) - 1);
        date.setUTCDate(parseInt(str.substring(6, 8)));
        date.setUTCHours(parseInt(str.substring(8, 10)));
        date.setUTCMinutes(parseInt(str.substring(10, 12)));
        date.setUTCSeconds(parseInt(str.substring(12, 14)));
        date.setUTCMilliseconds(parseInt(str.substring(14)));
        return date;
    };
    /**
     * @template T
     * @param {?} value
     * @return {?}
     */
    BpmnModelJsonHelper.ToJson = /**
     * @template T
     * @param {?} value
     * @return {?}
     */
    function (value) {
        var e_3, _a;
        if (value === undefined || value === null) {
            return null;
        }
        /** @type {?} */
        var list = [];
        try {
            for (var value_2 = tslib_1.__values(value), value_2_1 = value_2.next(); !value_2_1.done; value_2_1 = value_2.next()) {
                var item = value_2_1.value;
                list.push(item.ConvertToJsonObject());
            }
        }
        catch (e_3_1) { e_3 = { error: e_3_1 }; }
        finally {
            try {
                if (value_2_1 && !value_2_1.done && (_a = value_2.return)) _a.call(value_2);
            }
            finally { if (e_3) throw e_3.error; }
        }
        return JSON.stringify(list);
    };
    /**
     * @template ReturnT, ClassOfT
     * @param {?} json
     * @param {?} classOfT
     * @return {?}
     */
    BpmnModelJsonHelper.FromJson = /**
     * @template ReturnT, ClassOfT
     * @param {?} json
     * @param {?} classOfT
     * @return {?}
     */
    function (json, classOfT) {
        if (BpmnModelJsonHelper.IsNullOrWhiteSpace(json)) {
            return null;
        }
        /** @type {?} */
        var list = new Array();
        /** @type {?} */
        var jsonArr = JSON.parse(json);
        if (jsonArr == null || Array.isArray(jsonArr) === false) {
            return list;
        }
        jsonArr.forEach((/**
         * @param {?} elt
         * @return {?}
         */
        function (elt) {
            /** @type {?} */
            var newInstance = (/** @type {?} */ (new classOfT()));
            newInstance.LoadFromJsonObject(elt);
            list.push(newInstance);
        }));
        return list;
    };
    /**
     * @param {?} value
     * @return {?}
     */
    BpmnModelJsonHelper.StringListToJsonArray = /**
     * @param {?} value
     * @return {?}
     */
    function (value) {
        var e_4, _a;
        if (value == null)
            return null;
        /** @type {?} */
        var jsonArray = new Array();
        try {
            for (var value_3 = tslib_1.__values(value), value_3_1 = value_3.next(); !value_3_1.done; value_3_1 = value_3.next()) {
                var item = value_3_1.value;
                jsonArray.push(item);
            }
        }
        catch (e_4_1) { e_4 = { error: e_4_1 }; }
        finally {
            try {
                if (value_3_1 && !value_3_1.done && (_a = value_3.return)) _a.call(value_3);
            }
            finally { if (e_4) throw e_4.error; }
        }
        return jsonArray;
    };
    /**
     * @param {?} jsonArray
     * @return {?}
     */
    BpmnModelJsonHelper.StringListFromJsonArray = /**
     * @param {?} jsonArray
     * @return {?}
     */
    function (jsonArray) {
        var e_5, _a;
        if (jsonArray == null) {
            return null;
        }
        /** @type {?} */
        var list = new Array();
        try {
            for (var jsonArray_2 = tslib_1.__values(jsonArray), jsonArray_2_1 = jsonArray_2.next(); !jsonArray_2_1.done; jsonArray_2_1 = jsonArray_2.next()) {
                var item = jsonArray_2_1.value;
                if (typeof item == "object") {
                    list.push(JSON.stringify(item));
                }
                else {
                    list.push(String(item));
                }
            }
        }
        catch (e_5_1) { e_5 = { error: e_5_1 }; }
        finally {
            try {
                if (jsonArray_2_1 && !jsonArray_2_1.done && (_a = jsonArray_2.return)) _a.call(jsonArray_2);
            }
            finally { if (e_5) throw e_5.error; }
        }
        return list;
    };
    /**
     * @param {?} value
     * @return {?}
     */
    BpmnModelJsonHelper.StringListToJson = /**
     * @param {?} value
     * @return {?}
     */
    function (value) {
        /** @type {?} */
        var jsonArray = BpmnModelJsonHelper.StringListToJsonArray(value);
        if (jsonArray == null)
            return null;
        return JSON.stringify(jsonArray);
    };
    /**
     * @param {?} json
     * @return {?}
     */
    BpmnModelJsonHelper.StringListFromJson = /**
     * @param {?} json
     * @return {?}
     */
    function (json) {
        if (BpmnModelJsonHelper.IsNullOrWhiteSpace(json)) {
            return null;
        }
        /** @type {?} */
        var jsonArray = (/** @type {?} */ (JSON.parse(json)));
        if (jsonArray == null) {
            return null;
        }
        return BpmnModelJsonHelper.StringListFromJsonArray(jsonArray);
    };
    /**
     * @param {?} string
     * @return {?}
     */
    BpmnModelJsonHelper.IsNullOrWhiteSpace = /**
     * @param {?} string
     * @return {?}
     */
    function (string) {
        if (string == null) {
            return true;
        }
        else {
            return string.replace(/(^s*)|(s*$)/g, "").length == 0;
        }
    };
    /**
     * @private
     * @param {?} value
     * @return {?}
     */
    BpmnModelJsonHelper.GetDateFromISO = /**
     * @private
     * @param {?} value
     * @return {?}
     */
    function (value) {
        /** @type {?} */
        var a = /^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2}(?:\.\d*)?)Z$/.exec(value);
        if (a) {
            return new Date(Date.UTC(+a[1], +a[2] - 1, +a[3], +a[4], +a[5], +a[6]));
        }
        else {
            return null;
        }
    };
    /**
     * @private
     * @param {?} date
     * @param {?} fmt
     * @return {?}
     */
    BpmnModelJsonHelper.dateFormat = /**
     * @private
     * @param {?} date
     * @param {?} fmt
     * @return {?}
     */
    function (date, fmt) {
        /** @type {?} */
        var ret;
        /** @type {?} */
        var opt = {
            "y+": date.getUTCFullYear().toString(),
            // 年
            "M+": (date.getUTCMonth() + 1).toString(),
            // 月
            "d+": date.getUTCDate().toString(),
            // 日
            "H+": date.getUTCHours().toString(),
            // 时
            "m+": date.getUTCMinutes().toString(),
            // 分
            "s+": date.getUTCSeconds().toString(),
            // 秒
            "S+": date.getUTCMilliseconds().toString(),
        };
        for (var k in opt) {
            ret = new RegExp("(" + k + ")").exec(fmt);
            if (ret) {
                if (!String.prototype.padStart) {
                    fmt = fmt.replace(ret[1], (ret[1].length == 1) ? (opt[k]) : (BpmnModelJsonHelper.myPadStart(opt[k], ret[1].length, "0")));
                }
                else {
                    fmt = fmt.replace(ret[1], (ret[1].length == 1) ? (opt[k]) : (opt[k].padStart(ret[1].length, "0")));
                }
            }
        }
        return fmt;
    };
    /**
     * @private
     * @param {?} src
     * @param {?} targetLength
     * @param {?} padString
     * @return {?}
     */
    BpmnModelJsonHelper.myPadStart = /**
     * @private
     * @param {?} src
     * @param {?} targetLength
     * @param {?} padString
     * @return {?}
     */
    function (src, targetLength, padString) {
        targetLength = targetLength >> 0; //floor if number or convert non-number to 0;
        padString = String(typeof padString !== 'undefined' ? padString : ' ');
        if (src.length > targetLength) {
            return String(src);
        }
        else {
            targetLength = targetLength - src.length;
            if (targetLength > padString.length) {
                padString += padString.repeat(targetLength / padString.length); //append to original to ensure we are longer than needed
            }
            return padString.slice(0, targetLength) + String(src);
        }
    };
    BpmnModelJsonHelper.MIN_OFFSETDATETIME = BpmnModelJsonHelper.GetDateFromISO("0001-01-01T12:00:00.000Z");
    BpmnModelJsonHelper.MAX_OFFSETDATETIME = BpmnModelJsonHelper.GetDateFromISO("9999-12-31T23:59:59.000Z");
    return BpmnModelJsonHelper;
}());
export { BpmnModelJsonHelper };
if (false) {
    /** @type {?} */
    BpmnModelJsonHelper.MIN_OFFSETDATETIME;
    /** @type {?} */
    BpmnModelJsonHelper.MAX_OFFSETDATETIME;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQnBtbk1vZGVsSnNvbkhlbHBlci5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BlZHAtYWlmL2NvbW1vbi1hcGkvIiwic291cmNlcyI6WyJsaWIvQnBtbk1vZGVsSnNvbkhlbHBlci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7OztBQUVBO0lBQUE7SUE0U0EsQ0FBQzs7Ozs7O0lBeFNpQixxQ0FBaUI7Ozs7O0lBQS9CLFVBQWdDLEdBQU8sRUFBRSxhQUFxQjtRQUMxRCxJQUFJLEdBQUcsSUFBSSxJQUFJLEVBQUU7WUFDYixPQUFPLElBQUksQ0FBQztTQUNmO1FBQ0QsSUFBSSxHQUFHLENBQUMsY0FBYyxDQUFDLGFBQWEsQ0FBQyxFQUFFO1lBQ25DLE9BQU8sR0FBRyxDQUFDLGFBQWEsQ0FBQyxDQUFDO1NBQzdCO2FBQU07WUFDSCxPQUFPLElBQUksQ0FBQztTQUNmO0lBQ0wsQ0FBQzs7Ozs7Ozs7SUFFYSxxQ0FBaUI7Ozs7Ozs7SUFBL0IsVUFBNkQsR0FBTyxFQUFFLGFBQXFCLEVBQUUsS0FBK0Q7O1FBQ3hKLElBQUksR0FBRyxJQUFJLElBQUksSUFBSSxLQUFLLElBQUksSUFBSTtZQUM1QixPQUFPOztZQUVQLFNBQVMsR0FBYSxFQUFFO1FBQzVCLElBQUksS0FBSyxZQUFZLEtBQUssRUFBRTs7Z0JBQ3hCLGtFQUFrRTtnQkFDbEUsS0FBaUIsSUFBQSxVQUFBLGlCQUFBLEtBQUssQ0FBQSw0QkFBQSwrQ0FBRTtvQkFBbkIsSUFBSSxJQUFJLGtCQUFBO29CQUNULElBQUksSUFBSSxDQUFDLHFCQUFxQixDQUFDLElBQUksSUFBSSxJQUFJLElBQUksQ0FBQyxvQkFBb0IsQ0FBQyxJQUFJLElBQUksRUFBRTt3QkFDM0UsU0FBUyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsbUJBQW1CLEVBQUUsQ0FBQyxDQUFDO3FCQUM5Qzt5QkFBTTt3QkFDSCxNQUFNO3FCQUNUO2lCQUNKOzs7Ozs7Ozs7WUFDRCxJQUFJLFNBQVMsQ0FBQyxNQUFNLElBQUksS0FBSyxDQUFD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QywwQkFBMEIsQ0FBQyxDQUFDO0lBQzFGLHNDQUFrQixHQUFTLG1CQUFtQixDQUFDLGNBQWMsQ0FBQywwQkFBMEIsQ0FBQyxDQUFDO0lBMFNySCwwQkFBQztDQUFBLEFBNVNELElBNFNDO1NBNVNZLG1CQUFtQjs7O0lBQzVCLHVDQUFpSDs7SUFDakgsdUNBQWlIIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgSUpzb25TZXJpYWxpemFibGUgfSBmcm9tICcuL0lKc29uU2VyaWFsaXphYmxlJztcclxuXHJcbmV4cG9ydCBjbGFzcyBCcG1uTW9kZWxKc29uSGVscGVyIHtcclxuICAgIHB1YmxpYyBzdGF0aWMgcmVhZG9ubHkgTUlOX09GRlNFVERBVEVUSU1FOiBEYXRlID0gQnBtbk1vZGVsSnNvbkhlbHBlci5HZXREYXRlRnJvbUlTTyhcIjAwMDEtMDEtMDFUMTI6MDA6MDAuMDAwWlwiKTtcclxuICAgIHB1YmxpYyBzdGF0aWMgcmVhZG9ubHkgTUFYX09GRlNFVERBVEVUSU1FOiBEYXRlID0gQnBtbk1vZGVsSnNvbkhlbHBlci5HZXREYXRlRnJvbUlTTyhcIjk5OTktMTItMzFUMjM6NTk6NTkuMDAwWlwiKTtcclxuXHJcbiAgICBwdWJsaWMgc3RhdGljIEdldEF0dHJpYnV0ZVZhbHVlKG9iajoge30sIGF0dHJpYnV0ZU5hbWU6IHN0cmluZyk6IGFueSB7XHJcbiAgICAgICAgaWYgKG9iaiA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAob2JqLmhhc093blByb3BlcnR5KGF0dHJpYnV0ZU5hbWUpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBvYmpbYXR0cmlidXRlTmFtZV07XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBzdGF0aWMgU2V0QXR0cmlidXRlVmFsdWU8VCBleHRlbmRzIElKc29uU2VyaWFsaXphYmxlPihvYmo6IHt9LCBhdHRyaWJ1dGVOYW1lOiBzdHJpbmcsIHZhbHVlOiBzdHJpbmcgfCBib29sZWFuIHwgbnVtYmVyIHwgRGF0ZSB8IEFycmF5PFQ+IHwgVCB8IG9iamVjdCk6IHZvaWQge1xyXG4gICAgICAgIGlmIChvYmogPT0gbnVsbCB8fCB2YWx1ZSA9PSBudWxsKVxyXG4gICAgICAgICAgICByZXR1cm47XHJcblxyXG4gICAgICAgIGxldCBqc29uQXJyYXk6IE9iamVjdFtdID0gW107XHJcbiAgICAgICAgaWYgKHZhbHVlIGluc3RhbmNlb2YgQXJyYXkpIHtcclxuICAgICAgICAgICAgLy/liKTmlq3mmK/lkKbkuLpJSnNvblNlcmlhbGl6YWJsZeWunueOsOexu+eahOaVsOe7hO+8jOaYr+WImeWFqOmDqOiwg+eUqENvbnZlcnRUb0pzb25PYmplY3Tluo/liJfljJbvvIzlkKbliJnnm7TmjqXotYvlgLxcclxuICAgICAgICAgICAgZm9yIChsZXQgaXRlbSBvZiB2YWx1ZSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGl0ZW1bXCJDb252ZXJ0VG9Kc29uT2JqZWN0XCJdICE9IG51bGwgJiYgaXRlbVtcIkxvYWRGcm9tSnNvbk9iamVjdFwiXSAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAganNvbkFycmF5LnB1c2goaXRlbS5Db252ZXJ0VG9Kc29uT2JqZWN0KCkpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoanNvbkFycmF5Lmxlbmd0aCA9PSB2YWx1ZS5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgIG9ialthdHRyaWJ1dGVOYW1lXSA9IGpzb25BcnJheTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIG9ialthdHRyaWJ1dGVOYW1lXSA9IHZhbHVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIGlmICh2YWx1ZVtcIkNvbnZlcnRUb0pzb25PYmplY3RcIl0gIT0gbnVsbCAmJiB2YWx1ZVtcIkxvYWRGcm9tSnNvbk9iamVjdFwiXSAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgIC8v5Yik5pat5piv5ZCm5Li6SUpzb25TZXJpYWxpemFibGXlrp7njrDnsbvnmoTlr7nosaHvvIzmmK/liJnosIPnlKhDb252ZXJ0VG9Kc29uT2JqZWN05bqP5YiX5YyWXHJcbiAgICAgICAgICAgIG9ialthdHRyaWJ1dGVOYW1lXSA9ICh2YWx1ZSBhcyBUKS5Db252ZXJ0VG9Kc29uT2JqZWN0KCk7XHJcbiAgICAgICAgfSBlbHNlIGlmICh2YWx1ZSBpbnN0YW5jZW9mIERhdGUpIHtcclxuICAgICAgICAgICAgLy/liKTmlq3mmK/lkKbkuLrml6XmnJ/nsbvlnovvvIzmmK/ml6XmnJ/nsbvlnovliJnovazkuLrlrZfnrKbkuLJVVEPnmoR5eXl5TU1ERGhobW1zc1NTU+agvOW8j+Wtl+espuS4slxyXG4gICAgICAgICAgICBjb25zdCBzdHIgPSBCcG1uTW9kZWxKc29uSGVscGVyLkRhdGVUaW1lVG9TdHJpbmcodmFsdWUpO1xyXG4gICAgICAgICAgICBCcG1uTW9kZWxKc29uSGVscGVyLlNldEF0dHJpYnV0ZVZhbHVlKG9iaiwgYXR0cmlidXRlTmFtZSwgc3RyKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBvYmpbYXR0cmlidXRlTmFtZV0gPSB2YWx1ZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIHN0YXRpYyBHZXRBdHRyaWJ1dGVWYWx1ZUFzU3RyaW5nKG9iajoge30sIGF0dHJpYnV0ZU5hbWU6IHN0cmluZyk6IHN0cmluZyB7XHJcbiAgICAgICAgaWYgKG9iaiA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKG9iai5oYXNPd25Qcm9wZXJ0eShhdHRyaWJ1dGVOYW1lKSA9PSB0cnVlICYmIHR5cGVvZiAob2JqW2F0dHJpYnV0ZU5hbWVdKSA9PSBcInN0cmluZ1wiKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBvYmpbYXR0cmlidXRlTmFtZV07XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgc3RhdGljIEdldEF0dHJpYnV0ZVZhbHVlQXNCb29sZWFuKG9iajoge30sIGF0dHJpYnV0ZU5hbWU6IHN0cmluZyk6IGJvb2xlYW4ge1xyXG4gICAgICAgIGlmIChvYmogPT0gbnVsbCkge1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChvYmouaGFzT3duUHJvcGVydHkoYXR0cmlidXRlTmFtZSkgPT0gdHJ1ZSAmJiB0eXBlb2YgKG9ialthdHRyaWJ1dGVOYW1lXSkgPT0gXCJib29sZWFuXCIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG9ialthdHRyaWJ1dGVOYW1lXTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBzdGF0aWMgR2V0QXR0cmlidXRlVmFsdWVBc051bWJlcihvYmo6IHt9LCBhdHRyaWJ1dGVOYW1lOiBzdHJpbmcpOiBudW1iZXIge1xyXG4gICAgICAgIGlmIChvYmogPT0gbnVsbCkge1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChvYmouaGFzT3duUHJvcGVydHkoYXR0cmlidXRlTmFtZSkgPT0gdHJ1ZSAmJiB0eXBlb2YgKG9ialthdHRyaWJ1dGVOYW1lXSkgPT0gXCJudW1iZXJcIikge1xyXG4gICAgICAgICAgICByZXR1cm4gb2JqW2F0dHJpYnV0ZU5hbWVdO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIHN0YXRpYyBHZXRBdHRyaWJ1dGVWYWx1ZUFzTGlzdDxSZXR1cm5UIGV4dGVuZHMgSUpzb25TZXJpYWxpemFibGUsIENsYXNzT2ZUIGV4dGVuZHMgUmV0dXJuVD4ob2JqOiBPYmplY3QsIGF0dHJpYnV0ZU5hbWU6IHN0cmluZywgY2xhc3NPZlQ6IG5ldyAoKSA9PiBDbGFzc09mVCk6IEFycmF5PFJldHVyblQ+IHtcclxuICAgICAgICBsZXQganNvbkFycmF5OiBBcnJheTxhbnk+ID0gQnBtbk1vZGVsSnNvbkhlbHBlci5HZXRBdHRyaWJ1dGVWYWx1ZShvYmosIGF0dHJpYnV0ZU5hbWUpO1xyXG5cclxuICAgICAgICBpZiAoanNvbkFycmF5ID09IG51bGwpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBsZXQgbGlzdDogQXJyYXk8UmV0dXJuVD4gPSBbXTtcclxuICAgICAgICBmb3IgKGxldCBpdGVtIG9mIGpzb25BcnJheSkge1xyXG4gICAgICAgICAgICBsZXQgaW5zdGFuY2U6IFJldHVyblQgPSBudWxsO1xyXG4gICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgaW5zdGFuY2UgPSBuZXcgY2xhc3NPZlQoKSBhcyBDbGFzc09mVDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjYXRjaCAoZSkge1xyXG4gICAgICAgICAgICAgICAgdGhyb3cgZTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaW5zdGFuY2UuTG9hZEZyb21Kc29uT2JqZWN0KGl0ZW0pO1xyXG4gICAgICAgICAgICBsaXN0LnB1c2goaW5zdGFuY2UpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIGxpc3Q7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIHN0YXRpYyBHZXRBdHRyaWJ1dGVWYWx1ZUFzRGF0ZVRpbWUob2JqOiBPYmplY3QsIGF0dHJpYnV0ZU5hbWU6IHN0cmluZyk6IERhdGUge1xyXG4gICAgICAgIHJldHVybiBCcG1uTW9kZWxKc29uSGVscGVyLkRhdGVUaW1lRnJvbVN0cmluZyhCcG1uTW9kZWxKc29uSGVscGVyLkdldEF0dHJpYnV0ZVZhbHVlQXNTdHJpbmcob2JqLCBhdHRyaWJ1dGVOYW1lKSk7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIHN0YXRpYyBHZXRBdHRyaWJ1dGVWYWx1ZUFzSnNvblNlcmlhbGl6YWJsZTxSZXR1cm5UIGV4dGVuZHMgSUpzb25TZXJpYWxpemFibGUsIENsYXNzT2ZUIGV4dGVuZHMgUmV0dXJuVD4ob2JqOiBPYmplY3QsIGF0dHJpYnV0ZU5hbWU6IHN0cmluZywgY2xhc3NPZlQ6IG5ldyAoKSA9PiBDbGFzc09mVCk6IFJldHVyblQge1xyXG4gICAgICAgIGxldCBqc29uT2JqZWN0OiBPYmplY3QgPSBCcG1uTW9kZWxKc29uSGVscGVyLkdldEF0dHJpYnV0ZVZhbHVlKG9iaiwgYXR0cmlidXRlTmFtZSk7XHJcblxyXG4gICAgICAgIGlmIChqc29uT2JqZWN0ID09IG51bGwpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBsZXQgaW5zdGFuY2U6IFJldHVyblQgPSBudWxsO1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGluc3RhbmNlID0gbmV3IGNsYXNzT2ZUKCkgYXMgUmV0dXJuVDtcclxuICAgICAgICB9XHJcbiAgICAgICAgY2F0Y2ggKGUpIHtcclxuICAgICAgICAgICAgdGhyb3cgZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGluc3RhbmNlLkxvYWRGcm9tSnNvbk9iamVjdChqc29uT2JqZWN0KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIGluc3RhbmNlO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBzdGF0aWMgRGF0ZVRpbWVUb1N0cmluZyhkdDogRGF0ZSk6IHN0cmluZyB7XHJcbiAgICAgICAgaWYgKGR0ID09IG51bGwpXHJcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG5cclxuICAgICAgICBjb25zdCB0aW1lID0gZHQuZ2V0VGltZSgpO1xyXG4gICAgICAgIGlmICh0aW1lIDwgQnBtbk1vZGVsSnNvbkhlbHBlci5NSU5fT0ZGU0VUREFURVRJTUUuZ2V0VGltZSgpIHx8IHRpbWUgPiBCcG1uTW9kZWxKc29uSGVscGVyLk1BWF9PRkZTRVREQVRFVElNRS5nZXRUaW1lKCkpIHtcclxuICAgICAgICAgICAgdGhyb3cgYOe7meWumueahOaXpeacn+aXtumXtOWAvCAke2R0LnRvSVNPU3RyaW5nKCl9IOi2heWHuuaUr+aMgeiMg+WbtCgwMDAxLTAxLTAxVDEyOjAwOjAwLjAwMFogLSA5OTk5LTEyLTMxVDIzOjU5OjU5LjAwMFopOmA7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gQnBtbk1vZGVsSnNvbkhlbHBlci5kYXRlRm9ybWF0KGR0LCBcInl5eXlNTWRkSEhtbXNzU1NTXCIpXHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBcclxuICAgICAqIEBwYXJhbSBzdHIg5qC85byP5Li677yaeXl5eU1NZGRISG1tc3NTU1NcclxuICAgICAqL1xyXG4gICAgcHVibGljIHN0YXRpYyBEYXRlVGltZUZyb21TdHJpbmcoc3RyOiBzdHJpbmcpOiBEYXRlIHtcclxuICAgICAgICBpZiAoc3RyID09IG51bGwpXHJcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG5cclxuICAgICAgICAvLyBjb25zdCBzID0gYCR7c3RyLnN1YnN0cmluZygwLCA0KX0vJHtzdHIuc3Vic3RyaW5nKDQsIDYpfS8ke3N0ci5zdWJzdHJpbmcoNiwgOCl9ICR7c3RyLnN1YnN0cmluZyg4LCAxMCl9OiR7c3RyLnN1YnN0cmluZygxMCwgMTIpfToke3N0ci5zdWJzdHJpbmcoMTIsIDE0KX0uJHtzdHIuc3Vic3RyaW5nKDE0KX1gO1xyXG4gICAgICAgIGNvbnN0IGRhdGUgPSBuZXcgRGF0ZSgpO1xyXG4gICAgICAgIGRhdGUuc2V0VVRDRnVsbFllYXIocGFyc2VJbnQoc3RyLnN1YnN0cmluZygwLCA0KSkpO1xyXG4gICAgICAgIGRhdGUuc2V0VVRDTW9udGgocGFyc2VJbnQoc3RyLnN1YnN0cmluZyg0LCA2KSkgLSAxKTtcclxuICAgICAgICBkYXRlLnNldFVUQ0RhdGUocGFyc2VJbnQoc3RyLnN1YnN0cmluZyg2LCA4KSkpO1xyXG4gICAgICAgIGRhdGUuc2V0VVRDSG91cnMocGFyc2VJbnQoc3RyLnN1YnN0cmluZyg4LCAxMCkpKTtcclxuICAgICAgICBkYXRlLnNldFVUQ01pbnV0ZXMocGFyc2VJbnQoc3RyLnN1YnN0cmluZygxMCwgMTIpKSk7XHJcbiAgICAgICAgZGF0ZS5zZXRVVENTZWNvbmRzKHBhcnNlSW50KHN0ci5zdWJzdHJpbmcoMTIsIDE0KSkpO1xyXG4gICAgICAgIGRhdGUuc2V0VVRDTWlsbGlzZWNvbmRzKHBhcnNlSW50KHN0ci5zdWJzdHJpbmcoMTQpKSk7XHJcbiAgICAgICAgcmV0dXJuIGRhdGU7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIHN0YXRpYyBUb0pzb248VCBleHRlbmRzIElKc29uU2VyaWFsaXphYmxlPih2YWx1ZTogQXJyYXk8VD4pOiBzdHJpbmcge1xyXG4gICAgICAgIGlmICh2YWx1ZSA9PT0gdW5kZWZpbmVkIHx8IHZhbHVlID09PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgIH1cclxuICAgICAgICBsZXQgbGlzdDogT2JqZWN0W10gPSBbXTtcclxuICAgICAgICBmb3IgKGxldCBpdGVtIG9mIHZhbHVlKSB7XHJcbiAgICAgICAgICAgIGxpc3QucHVzaChpdGVtLkNvbnZlcnRUb0pzb25PYmplY3QoKSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkobGlzdCk7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIHN0YXRpYyBGcm9tSnNvbjxSZXR1cm5UIGV4dGVuZHMgSUpzb25TZXJpYWxpemFibGUsIENsYXNzT2ZUIGV4dGVuZHMgUmV0dXJuVD4oanNvbjogc3RyaW5nLCBjbGFzc09mVDogbmV3ICgpID0+IENsYXNzT2ZUKTogQXJyYXk8UmV0dXJuVD4ge1xyXG4gICAgICAgIGlmIChCcG1uTW9kZWxKc29uSGVscGVyLklzTnVsbE9yV2hpdGVTcGFjZShqc29uKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGxldCBsaXN0ID0gbmV3IEFycmF5PFJldHVyblQ+KCk7XHJcbiAgICAgICAgbGV0IGpzb25BcnI6IEFycmF5PHt9PiA9IEpTT04ucGFyc2UoanNvbik7XHJcblxyXG4gICAgICAgIGlmIChqc29uQXJyID09IG51bGwgfHwgQXJyYXkuaXNBcnJheShqc29uQXJyKSA9PT0gZmFsc2UpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGxpc3Q7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBqc29uQXJyLmZvckVhY2goZWx0ID0+IHtcclxuICAgICAgICAgICAgbGV0IG5ld0luc3RhbmNlID0gbmV3IGNsYXNzT2ZUKCkgYXMgQ2xhc3NPZlQ7XHJcbiAgICAgICAgICAgIG5ld0luc3RhbmNlLkxvYWRGcm9tSnNvbk9iamVjdChlbHQpO1xyXG4gICAgICAgICAgICBsaXN0LnB1c2gobmV3SW5zdGFuY2UpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXR1cm4gbGlzdDtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgc3RhdGljIFN0cmluZ0xpc3RUb0pzb25BcnJheSh2YWx1ZTogQXJyYXk8c3RyaW5nPik6IEFycmF5PHN0cmluZz4ge1xyXG4gICAgICAgIGlmICh2YWx1ZSA9PSBudWxsKVxyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuXHJcbiAgICAgICAgbGV0IGpzb25BcnJheTogQXJyYXk8c3RyaW5nPiA9IG5ldyBBcnJheSgpO1xyXG4gICAgICAgIGZvciAobGV0IGl0ZW0gb2YgdmFsdWUpIHtcclxuICAgICAgICAgICAganNvbkFycmF5LnB1c2goaXRlbSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4ganNvbkFycmF5O1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBzdGF0aWMgU3RyaW5nTGlzdEZyb21Kc29uQXJyYXkoanNvbkFycmF5OiBBcnJheTxPYmplY3Q+KTogQXJyYXk8c3RyaW5nPiB7XHJcbiAgICAgICAgaWYgKGpzb25BcnJheSA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgbGV0IGxpc3Q6IEFycmF5PHN0cmluZz4gPSBuZXcgQXJyYXkoKTtcclxuICAgICAgICBmb3IgKGxldCBpdGVtIG9mIGpzb25BcnJheSkge1xyXG4gICAgICAgICAgICBpZiAodHlwZW9mIGl0ZW0gPT0gXCJvYmplY3RcIikge1xyXG4gICAgICAgICAgICAgICAgbGlzdC5wdXNoKEpTT04uc3RyaW5naWZ5KGl0ZW0pKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGxpc3QucHVzaChTdHJpbmcoaXRlbSkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gbGlzdDtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgc3RhdGljIFN0cmluZ0xpc3RUb0pzb24odmFsdWU6IEFycmF5PHN0cmluZz4pOiBzdHJpbmcge1xyXG4gICAgICAgIGxldCBqc29uQXJyYXkgPSBCcG1uTW9kZWxKc29uSGVscGVyLlN0cmluZ0xpc3RUb0pzb25BcnJheSh2YWx1ZSk7XHJcbiAgICAgICAgaWYgKGpzb25BcnJheSA9PSBudWxsKVxyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuXHJcbiAgICAgICAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KGpzb25BcnJheSk7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIHN0YXRpYyBTdHJpbmdMaXN0RnJvbUpzb24oanNvbjogc3RyaW5nKTogQXJyYXk8c3RyaW5nPiB7XHJcbiAgICAgICAgaWYgKEJwbW5Nb2RlbEpzb25IZWxwZXIuSXNOdWxsT3JXaGl0ZVNwYWNlKGpzb24pKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgbGV0IGpzb25BcnJheSA9IEpTT04ucGFyc2UoanNvbikgYXMgQXJyYXk8T2JqZWN0PjtcclxuICAgICAgICBpZiAoanNvbkFycmF5ID09IG51bGwpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gQnBtbk1vZGVsSnNvbkhlbHBlci5TdHJpbmdMaXN0RnJvbUpzb25BcnJheShqc29uQXJyYXkpO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBzdGF0aWMgSXNOdWxsT3JXaGl0ZVNwYWNlKHN0cmluZzogc3RyaW5nKTogYm9vbGVhbiB7XHJcbiAgICAgICAgaWYgKHN0cmluZyA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiBzdHJpbmcucmVwbGFjZSgvKF5zKil8KHMqJCkvZywgXCJcIikubGVuZ3RoID09IDA7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgc3RhdGljIEdldERhdGVGcm9tSVNPKHZhbHVlOiBzdHJpbmcpIHtcclxuICAgICAgICBsZXQgYSA9IC9eKFxcZHs0fSktKFxcZHsyfSktKFxcZHsyfSlUKFxcZHsyfSk6KFxcZHsyfSk6KFxcZHsyfSg/OlxcLlxcZCopPylaJC8uZXhlYyh2YWx1ZSk7XHJcbiAgICAgICAgaWYgKGEpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBEYXRlKERhdGUuVVRDKCthWzFdLCArYVsyXSAtIDEsICthWzNdLCArYVs0XSwgK2FbNV0sICthWzZdKSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgc3RhdGljIGRhdGVGb3JtYXQoZGF0ZTogRGF0ZSwgZm10OiBzdHJpbmcpOiBzdHJpbmcge1xyXG4gICAgICAgIGxldCByZXQ7XHJcbiAgICAgICAgY29uc3Qgb3B0ID0ge1xyXG4gICAgICAgICAgICBcInkrXCI6IGRhdGUuZ2V0VVRDRnVsbFllYXIoKS50b1N0cmluZygpLCAgICAgICAgLy8g5bm0XHJcbiAgICAgICAgICAgIFwiTStcIjogKGRhdGUuZ2V0VVRDTW9udGgoKSArIDEpLnRvU3RyaW5nKCksICAgICAvLyDmnIhcclxuICAgICAgICAgICAgXCJkK1wiOiBkYXRlLmdldFVUQ0RhdGUoKS50b1N0cmluZygpLCAgICAgICAgICAgIC8vIOaXpVxyXG4gICAgICAgICAgICBcIkgrXCI6IGRhdGUuZ2V0VVRDSG91cnMoKS50b1N0cmluZygpLCAgICAgICAgICAgLy8g5pe2XHJcbiAgICAgICAgICAgIFwibStcIjogZGF0ZS5nZXRVVENNaW51dGVzKCkudG9TdHJpbmcoKSwgICAgICAgICAvLyDliIZcclxuICAgICAgICAgICAgXCJzK1wiOiBkYXRlLmdldFVUQ1NlY29uZHMoKS50b1N0cmluZygpLCAgICAgICAgIC8vIOenklxyXG4gICAgICAgICAgICBcIlMrXCI6IGRhdGUuZ2V0VVRDTWlsbGlzZWNvbmRzKCkudG9TdHJpbmcoKSwgICAgLy8g56eSXHJcbiAgICAgICAgICAgIC8vIOacieWFtuS7luagvOW8j+WMluWtl+espumcgOaxguWPr+S7pee7p+e7rea3u+WKoO+8jOW/hemhu+i9rOWMluaIkOWtl+espuS4slxyXG4gICAgICAgIH07XHJcbiAgICAgICAgZm9yIChsZXQgayBpbiBvcHQpIHtcclxuICAgICAgICAgICAgcmV0ID0gbmV3IFJlZ0V4cChcIihcIiArIGsgKyBcIilcIikuZXhlYyhmbXQpO1xyXG4gICAgICAgICAgICBpZiAocmV0KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIVN0cmluZy5wcm90b3R5cGUucGFkU3RhcnQpIHtcclxuICAgICAgICAgICAgICAgICAgICBmbXQgPSBmbXQucmVwbGFjZShyZXRbMV0sIChyZXRbMV0ubGVuZ3RoID09IDEpID8gKG9wdFtrXSkgOiAoQnBtbk1vZGVsSnNvbkhlbHBlci5teVBhZFN0YXJ0KG9wdFtrXSwgcmV0WzFdLmxlbmd0aCwgXCIwXCIpKSk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGZtdCA9IGZtdC5yZXBsYWNlKHJldFsxXSwgKHJldFsxXS5sZW5ndGggPT0gMSkgPyAob3B0W2tdKSA6IChvcHRba10ucGFkU3RhcnQocmV0WzFdLmxlbmd0aCwgXCIwXCIpKSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGZtdDtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIHN0YXRpYyBteVBhZFN0YXJ0KHNyYzogc3RyaW5nLCB0YXJnZXRMZW5ndGg6IG51bWJlciwgcGFkU3RyaW5nOiBzdHJpbmcpIHtcclxuICAgICAgICB0YXJnZXRMZW5ndGggPSB0YXJnZXRMZW5ndGggPj4gMDsgLy9mbG9vciBpZiBudW1iZXIgb3IgY29udmVydCBub24tbnVtYmVyIHRvIDA7XHJcbiAgICAgICAgcGFkU3RyaW5nID0gU3RyaW5nKHR5cGVvZiBwYWRTdHJpbmcgIT09ICd1bmRlZmluZWQnID8gcGFkU3RyaW5nIDogJyAnKTtcclxuICAgICAgICBpZiAoc3JjLmxlbmd0aCA+IHRhcmdldExlbmd0aCkge1xyXG4gICAgICAgICAgICByZXR1cm4gU3RyaW5nKHNyYyk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGFyZ2V0TGVuZ3RoID0gdGFyZ2V0TGVuZ3RoIC0gc3JjLmxlbmd0aDtcclxuICAgICAgICAgICAgaWYgKHRhcmdldExlbmd0aCA+IHBhZFN0cmluZy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgIHBhZFN0cmluZyArPSBwYWRTdHJpbmcucmVwZWF0KHRhcmdldExlbmd0aCAvIHBhZFN0cmluZy5sZW5ndGgpOyAvL2FwcGVuZCB0byBvcmlnaW5hbCB0byBlbnN1cmUgd2UgYXJlIGxvbmdlciB0aGFuIG5lZWRlZFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBwYWRTdHJpbmcuc2xpY2UoMCwgdGFyZ2V0TGVuZ3RoKSArIFN0cmluZyhzcmMpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufSJdfQ==