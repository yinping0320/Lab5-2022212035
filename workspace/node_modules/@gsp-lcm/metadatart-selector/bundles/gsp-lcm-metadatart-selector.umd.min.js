!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/common"),require("rxjs/Observable"),require("@farris/ui-modal"),require("@progress/kendo-data-query"),require("@angular/forms"),require("@progress/kendo-angular-treeview"),require("@progress/kendo-angular-grid"),require("@farris/ui-notify"),require("@angular/core"),require("@angular/common/http")):"function"==typeof define&&define.amd?define("@gsp-lcm/metadatart-selector",["exports","@angular/common","rxjs/Observable","@farris/ui-modal","@progress/kendo-data-query","@angular/forms","@progress/kendo-angular-treeview","@progress/kendo-angular-grid","@farris/ui-notify","@angular/core","@angular/common/http"],e):e((t["gsp-lcm"]=t["gsp-lcm"]||{},t["gsp-lcm"]["metadatart-selector"]={}),t.ng.common,t.rxjs.Observable,t.uiModal,t.kendoDataQuery,t.ng.forms,t.kendoAngularTreeview,t.kendoAngularGrid,t.uiNotify,t.ng.core,t.ng.common.http)}(this,function(t,e,a,i,r,o,n,s,d,p,l){"use strict";var c=(u.prototype.GetMetadataRT=function(t){var e=this.Server_IP+this.MetadataRT_Base_Path+"/"+t;return this.httpClient.get(e)},u.prototype.GetMetadataRTList=function(t){var e=this.Server_IP+this.MetadataRT_Base_Path+"?metadataTypes="+t;return this.httpClient.get(e)},u.prototype.GetMetadataRTListForHelp=function(t){var e=this.Server_IP+this.MetadataRT_Base_Path+"/helper?metadataTypes="+t;return this.httpClient.get(e)},u.prototype.getMetadataListByBizTypeId=function(t,e){var a=this.Server_IP+this.MetadataBizType_Base_Path+"?bizTypeId="+t+"&metadataTypes="+e;return this.httpClient.get(a)},u.prototype.getMetadataListByBizTypeIdForHelp=function(t,e,a){var i=this.Server_IP+this.MetadataBizType_Base_Path+"/helper?boList="+t+"&bizTypeId="+e+"&metadataTypes="+a;return this.httpClient.get(i)},u.prototype.GetMetadataTypeList=function(){var t=this.Server_IP+this.MetadataRT_Base_Path+"/typeList";return this.httpClient.get(t)},u.prototype.GetPostfix=function(e){return this.GetMetadataTypeList().subscribe(function(t){t.forEach(function(t){if(e.toLowerCase()===t.typeCode.toLowerCase())return t.postfix})}),new a.Observable},u.decorators=[{type:p.Injectable}],u.ctorParameters=function(){return[{type:l.HttpClient},{type:String,decorators:[{type:p.Inject,args:["url"]}]}]},u);function u(t,e){this.httpClient=t,this.url=e,this.MetadataRT_Base_Path="/api/runtime/lcm/v1.0/rt-metadatas",this.MetadataBizType_Base_Path="/api/runtime/lcm/v1.0/metadata-biztypes",this.Server_IP=null===e||e===undefined?"http://10.24.19.140:5000":e}var h=(m.prototype.addMetadataRT=function(t){this.metadatas.push(t)},m.prototype.clearMetadataRT=function(){this.metadatas=[]},m.prototype.GetMetadataRTList=function(t){return this.gspMetadataService.GetMetadataRTList(t)},m.prototype.GetMetadataRTListForHelp=function(t){return this.gspMetadataService.GetMetadataRTListForHelp(t)},m.prototype.getMetadataListByBizTypeId=function(t,e){return this.gspMetadataService.getMetadataListByBizTypeId(t,e)},m.prototype.getMetadataListByBizTypeIdForHelp=function(t,e,a){return t===undefined&&(t=""),e===undefined&&(e=""),this.gspMetadataService.getMetadataListByBizTypeIdForHelp(t,e,a)},m.prototype.GetMetadataRT=function(t){return this.gspMetadataService.GetMetadataRT(t)},m.decorators=[{type:p.Injectable}],m.ctorParameters=function(){return[{type:c}]},m);function m(t){this.gspMetadataService=t,this.metadatas=[]}var f=function B(){},y=function C(){},g=(v.prototype.ngOnChanges=function(t){},v.prototype.LoadMetadata=function(){var a=this;if(null==this.metadataService.metadatas||this.metadataService.metadatas.length<=0)return this.notifyService?void this.notifyService.warning("请先选中元数据。"):void console.log("请先选中元数据。");var t=this.metadataService.metadatas[0].ID;this.metadataService.GetMetadataRT(t).subscribe(function(t){var e=new f;e.metadata=t,e.packageHeader=new y,a.selectedMetadata.emit(e),a.hideModal()}),this.metadataService.clearMetadataRT()},v.prototype.hideModal=function(){this.closeModalEmitter.emit()},v.prototype.onSelectedChange=function(t){this.classifier=t},v.decorators=[{type:p.Component,args:[{selector:"app-select-metadatart",template:'<div class="farris-main-area flex-column farris-overflow-hidden">\r\n    <div class="d-flex flex-fill flex-row farris-overflow-hidden">\r\n        <app-metadatalist class="d-flex flex-fill" style="width: 100%;" [typeList]="typeList" [boId]="boId" [bizTypeId]="bizTypeId"></app-metadatalist>\r\n    </div>\r\n\r\n    <div class="modal-footer">\r\n        <button type="button" class="btn btn-primary" (click)="LoadMetadata()">{{confirm}}</button>\r\n        <button type="button" class="btn btn-default" (click)="hideModal()">{{cancel}}</button>\r\n    </div>\r\n</div>',styles:[".templateBlock{display:flex}.infoBlock{width:100%;min-width:400px}.infoBlock label{width:50px}"]}]}],v.ctorParameters=function(){return[{type:h},{type:i.BsModalService},{type:p.ComponentFactoryResolver},{type:p.Injector}]},v.propDecorators={typeList:[{type:p.Input}],boId:[{type:p.Input}],bizTypeId:[{type:p.Input}],closeModalEmitter:[{type:p.Output}],selectedMetadata:[{type:p.Output}]},v);function v(t,e,a,i){this.metadataService=t,this.modalService=e,this.resolver=a,this.injector=i,this.selectedMetadata=new p.EventEmitter,this.confirm="确定",this.cancel="取消",this.closeModalEmitter=new p.EventEmitter,this.notifyService=this.injector.get(d.NotifyService,null),"en"===localStorage.getItem("languageCode")&&(this.confirm="OK",this.cancel="Cancel")}var b=(M.prototype.clear=function(){this.data=[]},M.prototype.dataStateChange=function(t){this.state=t,this.gridData=r.process(this.data,this.state)},M.prototype.ngOnInit=function(){var e=this;"en"===localStorage.getItem("languageCode")&&(this.nameSpace="NameSpace",this.name="Name",this.fileName="FileName",this.type="Type",this.businessObject="BusinessObject");var a=[];this.boId||this.bizTypeId?this.metadataService.getMetadataListByBizTypeIdForHelp(this.boId,this.bizTypeId,this.typeList).subscribe(function(t){t&&t.forEach(function(t){a.push(t.metadata)}),e.data=a,e.gridData=r.process(e.data,e.state)}):this.metadataService.GetMetadataRTListForHelp(this.typeList).subscribe(function(t){t&&t.forEach(function(t){a.push(t.metadata)}),e.data=a,e.gridData=r.process(e.data,e.state)})},M.prototype.onSelectionChange=function(t){if(0<t.selectedRows.length){this.metadataService.clearMetadataRT();var e={ID:t.selectedRows[0].dataItem.id,RelativePath:t.selectedRows[0].dataItem.relativePath,FileName:t.selectedRows[0].dataItem.fileName};this.metadataService.addMetadataRT(e)}},M.decorators=[{type:p.Component,args:[{selector:"app-metadatalist",template:'<kendo-grid [data]="gridData" \r\n[selectable]="selectableSetting" \r\n(selectionChange)=onSelectionChange($event)    \r\n[pageSize]="state.take"\r\n[skip]="state.skip"\r\n[sort]="state.sort"\r\n[filter]="state.filter"\r\n[sortable]="false"\r\n[pageable]="true"\r\n[filterable]="true"\r\n[resizable]="true"\r\n(dataStateChange)=dataStateChange($event)>\r\n<kendo-grid-column [headerStyle]="{\'border-right\': \'1px solid #d9d9d9\'}" field="nameSpace" title={{nameSpace}} width="210">\r\n</kendo-grid-column>\r\n<kendo-grid-column [headerStyle]="{\'border-right\': \'1px solid #d9d9d9\'}" field="name" title={{name}} width="200">\r\n</kendo-grid-column>\r\n<kendo-grid-column [headerStyle]="{\'border-right\': \'1px solid #d9d9d9\'}" field="fileName" title={{fileName}} width="200">\r\n</kendo-grid-column>\r\n<kendo-grid-column [headerStyle]="{\'border-right\': \'1px solid #d9d9d9\'}" field="type" title={{type}} width="150">\r\n</kendo-grid-column>\r\n<kendo-grid-column field="bizobjectID" title={{businessObject}} width="150">\r\n</kendo-grid-column>\r\n</kendo-grid>',styles:[".templateSelector{width:100%;height:475px;border:.5px solid #ddd}.templateDescription{width:200px;height:475px;border:.5px solid #ddd}.templateInfo{display:flex}"]}]}],M.ctorParameters=function(){return[{type:h}]},M.propDecorators={typeList:[{type:p.Input}],boId:[{type:p.Input}],bizTypeId:[{type:p.Input}]},M);function M(t){this.metadataService=t,this.nameSpace="命名空间",this.name="名称",this.fileName="文件名",this.type="类型",this.businessObject="业务对象",this.state={skip:0,take:50,filter:{logic:"and",filters:[]}},this.selectableSetting={mode:"single",checkboxOnly:!1}}var S=(T.decorators=[{type:p.NgModule,args:[{imports:[e.CommonModule,o.FormsModule,n.TreeViewModule,s.GridModule,d.NotifyModule.forRoot()],exports:[g,d.NotifyModule],providers:[h],declarations:[g,b],entryComponents:[g]}]}],T.ctorParameters=function(){return[]},T);function T(){}function I(t,e){return new c(t,e)}var k=(P.forRoot=function(t){return{ngModule:P,providers:[{provide:"url",useValue:t},{provide:c,useFactory:I,deps:[l.HttpClient,"url"]}]}},P.decorators=[{type:p.NgModule,args:[{imports:[l.HttpClientModule],exports:[],providers:[]}]}],P);function P(){}var R=function L(t,e,a,i,r,o,n,s,d,p){this.id=t,this.nameSpace=e,this.code=a,this.name=i,this.fileName=r,this.type=o,this.bizobjectID=n,this.relativePath=s,this.extendProperty=d,this.content=p},w=function _(t,e,a,i){this.packageName=t,this.projectPath=i,this.packageVersion=e,this.packageLocation=a},x=function z(t,e,a,i,r,o,n){this.packageName=t,this.projectName=a,this.projectPath=e,this.projectNameSpace=i,this.depPackageName=r,this.depPackageVersion=o,this.depPackageLocation=n};t.MetadataRTSelectModule=S,t.SelectMetadataRTComponent=g,t.GSPMetadataRTServiceModule=k,t.GSPMetadataRTService=c,t.MetadataDto=R,t.Metadata4RefDto=f,t.MetadataPackageDto=w,t.MetadataProjectDto=x,t.ɵa=I,t.ɵc=b,t.ɵb=h,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=gsp-lcm-metadatart-selector.umd.min.js.map