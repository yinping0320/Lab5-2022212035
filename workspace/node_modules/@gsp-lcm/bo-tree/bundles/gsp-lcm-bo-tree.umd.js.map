{"version":3,"file":"gsp-lcm-bo-tree.umd.js.map","sources":["ng://@gsp-lcm/bo-tree/lib/views/bo-tree-panel/bo-tree-panel.state.ts","ng://@gsp-lcm/bo-tree/lib/views/bo-tree-panel/bo-tree-panel.component.ts","ng://@gsp-lcm/bo-tree/lib/directives/tree-node-content.directive.ts","ng://@gsp-lcm/bo-tree/lib/bo-tree.module.ts"],"sourcesContent":["import { Injectable, EventEmitter } from '@angular/core';\r\n\r\n@Injectable()\r\nexport class BOTreePanelState {\r\n  boTreeNodeActived = new EventEmitter<any>();\r\n  boTreeNodeDoubleClick = new EventEmitter<any>();\r\n  boTreeNodeAdding = new EventEmitter<any>();\r\n  boTreeNodeClick = new EventEmitter<any>();\r\n}\r\n","import { Component, OnInit, ViewChild, EventEmitter, Output, Input} from '@angular/core';\r\nimport { BOTreePanelState} from './bo-tree-panel.state';\r\nimport { BusinessObjectRtService } from '@gsp-lcm/bo-rt-service';\r\nimport { TreeTableComponent } from '@farris/ui-treetable'; \r\n// è®¾ç½®éè¦æ¾ç¤ºçå¼\r\nconst CUSTOM_TEMPLATE_STRING = '{{ node.name }} ({{ node.subTitle }})';\r\n\r\n@Component({\r\n  selector: 'app-bo-tree-panel',\r\n  templateUrl: './bo-tree-panel.component.html',\r\n  styleUrls: ['./bo-tree-panel.component.css'],\r\n})\r\n\r\nexport class BOTreePanelComponent implements OnInit {\r\n  @Input() showIcon : boolean;\r\n  @Output() selectionChanged = new EventEmitter<any>();\r\n  @ViewChild('treetable') treetable : TreeTableComponent;\r\n  cols = [\r\n    { field: 'name', title: 'Name', width: 200}\r\n  ];\r\n  // è·åæ°æ®\r\n  treeNodes: any[];\r\n  selctedBO: any;\r\n  customTemplateStringOptions = { treeNodeTemplate: CUSTOM_TEMPLATE_STRING };\r\n  \r\n  // æ³¨å¥æä»¶æ æ°æ®è·åæå¡ï¼ä»¥è·åæ°æ®\r\n  constructor(public boRtService: BusinessObjectRtService, private boTreePanelState: BOTreePanelState) {\r\n    this.getInitBOTreeData();\r\n  }\r\n\r\n  /**\r\n   * è·åæ ¹ç®å½æ \r\n   */\r\n  getInitBOTreeData() {\r\n    this.boRtService.getBusinessObjects().subscribe((res: any) => {\r\n      if (res instanceof Array) {\r\n        res.forEach((item) => {// kendoUi treeview parentId ä¸ºç¬¬ä¸çº§çæ¶å å¿é¡»undefinedï¼å¿é¡»åwebapiå¾å°å®ä½å¤§å°åä¸è´\r\n          if (item.parentID===undefined || item.parentID === null || item.parentID === '') {\r\n            item.parentID = undefined;\r\n          }\r\n          if (item.sysInit === '1') {\r\n            item.isSysInit = true;\r\n          } else {\r\n            item.isSysInit = false;\r\n          }\r\n        });\r\n      } else {\r\n        if (res.parentID===undefined || res.parentID === null || res.parentID === '') {\r\n          res.parentID = undefined;\r\n          if (res.sysInit === '1') {\r\n            res.isSysInit = true;\r\n          } else {\r\n            res.isSysInit = false;\r\n          }\r\n        }\r\n      }\r\n      this.treeNodes =this.makeTree(res);\r\n    });\r\n  }\r\n\r\n  selectNode(id: string, detectChanges?: boolean){\r\n    this.treetable.selectNode(id,detectChanges);\r\n  }\r\n  \r\n\r\n\r\n  doubleClickEventHandler($event) {\r\n        this.boTreePanelState.boTreeNodeDoubleClick.emit($event.node);\r\n  }\r\n\r\n\r\n  ngOnInit() {\r\n  }\r\n  selectionChange($event) {\r\n    this.selctedBO = $event.node.data;\r\n    this.selectionChanged.emit($event.node);\r\n  }\r\n\r\n  refresh() {\r\n    this.getInitBOTreeData();\r\n  }\r\n  private makeTree(data) {\r\n    const r = data.filter(t => t.layer === 1).map(t => {\r\n        return {\r\n            id:t.id,\r\n            data: t,\r\n            children: [],\r\n            expanded: true\r\n        };\r\n    });\r\n\r\n    r.forEach(e => {\r\n        e.children = this.makeTreeChildren(data, e.data);\r\n    });\r\n\r\n    return r;\r\n  }   \r\n  private makeTreeChildren(data, treeInfo) {\r\n    const pLayer = treeInfo.layer + 1;      \r\n\r\n    return data.filter( c => c.layer === pLayer && c.parentID===treeInfo.id).map( d => {\r\n      return {\r\n          data: d,\r\n          children: this.makeTreeChildren(data, d),\r\n          expanded: false\r\n      };\r\n    });\r\n  }\r\n}\r\n","import { Directive, ViewContainerRef } from '@angular/core';\r\n\r\n// å®ä¹è¾å©æä»¤TreeNodeContentï¼ç¨æ¥å¨æ¨¡æ¿ä¸­æ è®°æå¥ç¹\r\n@Directive({\r\n  selector: '[treeNodeContent-host]'\r\n})\r\n\r\nexport class TreeNodeContentDirective {\r\n\r\n  // ä¾èµæ³¨å¥ViewContainerRefï¼è·åå¯¹å®¹å¨è§å¾çè®¿é®æé\r\n  constructor(public viewContainerRef: ViewContainerRef) {\r\n\r\n  }\r\n}","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { TreeNodeContentDirective } from './directives/tree-node-content.directive';\r\nimport { BOTreePanelComponent } from './views/bo-tree-panel/bo-tree-panel.component';\r\nimport { BOTreePanelState} from './views/bo-tree-panel/bo-tree-panel.state';\r\nimport { HttpService } from '@ecp-caf/caf-common';\r\nimport { BusinessObjectRtService } from \"@gsp-lcm/bo-rt-service\";\r\nimport { TreeTableModule } from '@farris/ui-treetable';\r\n\r\n@NgModule({\r\n  declarations: [\r\n    TreeNodeContentDirective,\r\n    BOTreePanelComponent\r\n  ],\r\n  imports: [\r\n    CommonModule,\r\n    TreeTableModule\r\n  ],\r\n  exports: [BOTreePanelComponent],\r\n  providers: [BOTreePanelState,  HttpService, BusinessObjectRtService],\r\n  entryComponents: [BOTreePanelComponent]\r\n})\r\nexport class BOTreePanelPackageModule {\r\n}\r\n"],"names":["EventEmitter","Injectable","boRtService","Component","BusinessObjectRtService","Input","Output","ViewChild","Directive","ViewContainerRef","NgModule","CommonModule","TreeTableModule","HttpService"],"mappings":"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"}
