{"version":3,"file":"gsp-lcm-bo-tree.js.map","sources":["ng://@gsp-lcm/bo-tree/lib/views/bo-tree-panel/bo-tree-panel.state.ts","ng://@gsp-lcm/bo-tree/lib/views/bo-tree-panel/bo-tree-panel.component.ts","ng://@gsp-lcm/bo-tree/lib/directives/tree-node-content.directive.ts","ng://@gsp-lcm/bo-tree/lib/bo-tree.module.ts"],"sourcesContent":["import { Injectable, EventEmitter } from '@angular/core';\r\n\r\n@Injectable()\r\nexport class BOTreePanelState {\r\n  boTreeNodeActived = new EventEmitter<any>();\r\n  boTreeNodeDoubleClick = new EventEmitter<any>();\r\n  boTreeNodeAdding = new EventEmitter<any>();\r\n  boTreeNodeClick = new EventEmitter<any>();\r\n}\r\n","import { Component, OnInit, ViewChild, EventEmitter, Output, Input} from '@angular/core';\r\nimport { BOTreePanelState} from './bo-tree-panel.state';\r\nimport { BusinessObjectRtService } from '@gsp-lcm/bo-rt-service';\r\nimport { TreeTableComponent } from '@farris/ui-treetable'; \r\n// è®¾ç½®éè¦æ¾ç¤ºçå¼\r\nconst CUSTOM_TEMPLATE_STRING = '{{ node.name }} ({{ node.subTitle }})';\r\n\r\n@Component({\r\n  selector: 'app-bo-tree-panel',\r\n  templateUrl: './bo-tree-panel.component.html',\r\n  styleUrls: ['./bo-tree-panel.component.css'],\r\n})\r\n\r\nexport class BOTreePanelComponent implements OnInit {\r\n  @Input() showIcon : boolean;\r\n  @Output() selectionChanged = new EventEmitter<any>();\r\n  @ViewChild('treetable') treetable : TreeTableComponent;\r\n  cols = [\r\n    { field: 'name', title: 'Name', width: 200}\r\n  ];\r\n  // è·åæ°æ®\r\n  treeNodes: any[];\r\n  selctedBO: any;\r\n  customTemplateStringOptions = { treeNodeTemplate: CUSTOM_TEMPLATE_STRING };\r\n  \r\n  // æ³¨å¥æä»¶æ æ°æ®è·åæå¡ï¼ä»¥è·åæ°æ®\r\n  constructor(public boRtService: BusinessObjectRtService, private boTreePanelState: BOTreePanelState) {\r\n    this.getInitBOTreeData();\r\n  }\r\n\r\n  /**\r\n   * è·åæ ¹ç®å½æ \r\n   */\r\n  getInitBOTreeData() {\r\n    this.boRtService.getBusinessObjects().subscribe((res: any) => {\r\n      if (res instanceof Array) {\r\n        res.forEach((item) => {// kendoUi treeview parentId ä¸ºç¬¬ä¸çº§çæ¶å å¿é¡»undefinedï¼å¿é¡»åwebapiå¾å°å®ä½å¤§å°åä¸è´\r\n          if (item.parentID===undefined || item.parentID === null || item.parentID === '') {\r\n            item.parentID = undefined;\r\n          }\r\n          if (item.sysInit === '1') {\r\n            item.isSysInit = true;\r\n          } else {\r\n            item.isSysInit = false;\r\n          }\r\n        });\r\n      } else {\r\n        if (res.parentID===undefined || res.parentID === null || res.parentID === '') {\r\n          res.parentID = undefined;\r\n          if (res.sysInit === '1') {\r\n            res.isSysInit = true;\r\n          } else {\r\n            res.isSysInit = false;\r\n          }\r\n        }\r\n      }\r\n      this.treeNodes =this.makeTree(res);\r\n    });\r\n  }\r\n\r\n  selectNode(id: string, detectChanges?: boolean){\r\n    this.treetable.selectNode(id,detectChanges);\r\n  }\r\n  \r\n\r\n\r\n  doubleClickEventHandler($event) {\r\n        this.boTreePanelState.boTreeNodeDoubleClick.emit($event.node);\r\n  }\r\n\r\n\r\n  ngOnInit() {\r\n  }\r\n  selectionChange($event) {\r\n    this.selctedBO = $event.node.data;\r\n    this.selectionChanged.emit($event.node);\r\n  }\r\n\r\n  refresh() {\r\n    this.getInitBOTreeData();\r\n  }\r\n  private makeTree(data) {\r\n    const r = data.filter(t => t.layer === 1).map(t => {\r\n        return {\r\n            id:t.id,\r\n            data: t,\r\n            children: [],\r\n            expanded: true\r\n        };\r\n    });\r\n\r\n    r.forEach(e => {\r\n        e.children = this.makeTreeChildren(data, e.data);\r\n    });\r\n\r\n    return r;\r\n  }   \r\n  private makeTreeChildren(data, treeInfo) {\r\n    const pLayer = treeInfo.layer + 1;      \r\n\r\n    return data.filter( c => c.layer === pLayer && c.parentID===treeInfo.id).map( d => {\r\n      return {\r\n          data: d,\r\n          children: this.makeTreeChildren(data, d),\r\n          expanded: false\r\n      };\r\n    });\r\n  }\r\n}\r\n","import { Directive, ViewContainerRef } from '@angular/core';\r\n\r\n// å®ä¹è¾å©æä»¤TreeNodeContentï¼ç¨æ¥å¨æ¨¡æ¿ä¸­æ è®°æå¥ç¹\r\n@Directive({\r\n  selector: '[treeNodeContent-host]'\r\n})\r\n\r\nexport class TreeNodeContentDirective {\r\n\r\n  // ä¾èµæ³¨å¥ViewContainerRefï¼è·åå¯¹å®¹å¨è§å¾çè®¿é®æé\r\n  constructor(public viewContainerRef: ViewContainerRef) {\r\n\r\n  }\r\n}","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { TreeNodeContentDirective } from './directives/tree-node-content.directive';\r\nimport { BOTreePanelComponent } from './views/bo-tree-panel/bo-tree-panel.component';\r\nimport { BOTreePanelState} from './views/bo-tree-panel/bo-tree-panel.state';\r\nimport { HttpService } from '@ecp-caf/caf-common';\r\nimport { BusinessObjectRtService } from \"@gsp-lcm/bo-rt-service\";\r\nimport { TreeTableModule } from '@farris/ui-treetable';\r\n\r\n@NgModule({\r\n  declarations: [\r\n    TreeNodeContentDirective,\r\n    BOTreePanelComponent\r\n  ],\r\n  imports: [\r\n    CommonModule,\r\n    TreeTableModule\r\n  ],\r\n  exports: [BOTreePanelComponent],\r\n  providers: [BOTreePanelState,  HttpService, BusinessObjectRtService],\r\n  entryComponents: [BOTreePanelComponent]\r\n})\r\nexport class BOTreePanelPackageModule {\r\n}\r\n"],"names":[],"mappings":"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"}
