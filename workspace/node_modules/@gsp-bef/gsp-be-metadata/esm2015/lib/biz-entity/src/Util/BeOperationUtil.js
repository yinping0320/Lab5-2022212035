/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
export class BeOperationUtil {
    /**
     * @param {?} be
     * @return {?}
     */
    getAllMgrActions(be) {
        return be.BizMgrActions;
    }
    /**
     * bizActions
     * @param {?} be
     * @return {?}
     */
    getAllBizEntityActions(be) {
        return this.getChidrenObjectsActions(be.MainObject);
    }
    /**
     * @param {?} bizObject
     * @return {?}
     */
    getChidrenObjectsActions(bizObject) {
        /** @type {?} */
        const result = new Array();
        if (!(bizObject)) {
            return result;
        }
        if (bizObject.BizActions && bizObject.BizActions.length > 0) {
            result.push(...bizObject.BizActions);
        }
        if (bizObject.ContainChildObjects && bizObject.ContainChildObjects.length > 0) {
            for (let i = 0; i < bizObject.ContainChildObjects.length; i++) {
                result.push(...this.getChidrenObjectsActions((/** @type {?} */ (bizObject.ContainChildObjects[i]))));
            }
        }
        return result;
    }
    /**
     * determination
     * @param {?} be
     * @return {?}
     */
    getAllDeterminations(be) {
        return this.getChidrenObjectsDeterminations(be.MainObject);
    }
    /**
     * @param {?} bizObject
     * @return {?}
     */
    getChidrenObjectsDeterminations(bizObject) {
        /** @type {?} */
        const result = new Array();
        if (!(bizObject)) {
            return result;
        }
        if (bizObject.Determinations && bizObject.Determinations.length > 0) {
            result.push(...bizObject.Determinations);
        }
        if (bizObject.ContainChildObjects && bizObject.ContainChildObjects.length > 0) {
            for (let i = 0; i < bizObject.ContainChildObjects.length; i++) {
                result.push(...this.getChidrenObjectsDeterminations((/** @type {?} */ (bizObject.ContainChildObjects[i]))));
            }
        }
        return result;
    }
    /**
     * validation
     * @param {?} be
     * @return {?}
     */
    getAllValidations(be) {
        return this.getChidrenObjectsValidations(be.MainObject);
    }
    /**
     * @param {?} bizObject
     * @return {?}
     */
    getChidrenObjectsValidations(bizObject) {
        /** @type {?} */
        const result = new Array();
        if (!(bizObject)) {
            return result;
        }
        if (bizObject.Validations && bizObject.Validations.length > 0) {
            result.push(...bizObject.Validations);
        }
        if (bizObject.ContainChildObjects && bizObject.ContainChildObjects.length > 0) {
            for (let i = 0; i < bizObject.ContainChildObjects.length; i++) {
                result.push(...this.getChidrenObjectsValidations((/** @type {?} */ (bizObject.ContainChildObjects[i]))));
            }
        }
        return result;
    }
    /**
     * 获取所有操作
     * @param {?} be
     * @return {?}
     */
    getAllOperations(be) {
        /** @type {?} */
        const result = new Array();
        result.push(...this.getAllBizEntityActions(be));
        result.push(...this.getAllMgrActions(be));
        result.push(...this.getAllDeterminations(be));
        result.push(...this.getAllValidations(be));
        return result;
    }
    /**
     * validation触发字段中是否包含某字段
     * @param {?} be
     * @param {?} eleId 字段ID
     * @return {?}
     */
    countainValidationRequestElement(be, eleId) {
        /** @type {?} */
        const validations = this.getAllValidations(be);
        if (!!(validations) && validations.length > 0) {
            for (let i = 0; i < validations.length; i++) {
                /** @type {?} */
                const b = this.validationCountainRequestElement(validations[i], eleId);
                if (b) {
                    /** @type {?} */
                    const result = validations[i].Name;
                    return result;
                }
            }
        }
        return null;
    }
    /**
     * determination触发字段中是否包含某字段
     * @param {?} be
     * @param {?} eleId 字段ID
     * @return {?}
     */
    countainDeterminationRequestElement(be, eleId) {
        /** @type {?} */
        const dtms = this.getAllDeterminations(be);
        if (!!(dtms) && dtms.length > 0) {
            for (let i = 0; i < dtms.length; i++) {
                /** @type {?} */
                const b = this.determinationCountainRequestElement(dtms[i], eleId);
                if (b) {
                    /** @type {?} */
                    const result = dtms[i].Name;
                    return result;
                }
            }
        }
        return null;
    }
    /**
     * @private
     * @param {?} id
     * @param {?} requestEles
     * @return {?}
     */
    countainEle(id, requestEles) {
        if (!!(id) && !!(requestEles) && requestEles.length > 0) {
            return requestEles.indexOf(id) >= 0;
        }
        return false;
    }
    /**
     * 触发字段中是否包含某字段
     * @param {?} dtm
     * @param {?} id
     * @return {?}
     */
    determinationCountainRequestElement(dtm, id) {
        if (this.countainEle(id, dtm.RequestElements)) {
            return true;
        }
        if (!!(dtm.RequestChildElements) && dtm.RequestChildElements.length > 0) {
            return this.countainEle(id, dtm.RequestChildElements[0].RequestChildElementValue);
        }
        return false;
    }
    /**
     * 触发字段中是否包含某字段
     * @param {?} validation
     * @param {?} id
     * @return {?}
     */
    validationCountainRequestElement(validation, id) {
        if (this.countainEle(id, validation.RequestElements)) {
            return true;
        }
        if (!!(validation.RequestChildElements) && validation.RequestChildElements.length > 0) {
            return this.countainEle(id, validation.RequestChildElements[0].RequestChildElementValue);
        }
        return false;
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQmVPcGVyYXRpb25VdGlsLmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGdzcC1iZWYvZ3NwLWJlLW1ldGFkYXRhLyIsInNvdXJjZXMiOlsibGliL2Jpei1lbnRpdHkvc3JjL1V0aWwvQmVPcGVyYXRpb25VdGlsLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7QUFTQSxNQUFNLE9BQU8sZUFBZTs7Ozs7SUFDMUIsZ0JBQWdCLENBQUMsRUFBcUI7UUFDcEMsT0FBTyxFQUFFLENBQUMsYUFBYSxDQUFDO0lBQzFCLENBQUM7Ozs7OztJQUtELHNCQUFzQixDQUFDLEVBQXFCO1FBQzFDLE9BQU8sSUFBSSxDQUFDLHdCQUF3QixDQUFDLEVBQUUsQ0FBQyxVQUFVLENBQUMsQ0FBQztJQUN0RCxDQUFDOzs7OztJQUVELHdCQUF3QixDQUFDLFNBQTZCOztjQUM5QyxNQUFNLEdBQUcsSUFBSSxLQUFLLEVBQWE7UUFDckMsSUFBSSxDQUFDLENBQUMsU0FBUyxDQUFDLEVBQUU7WUFDaEIsT0FBTyxNQUFNLENBQUM7U0FDZjtRQUNELElBQUksU0FBUyxDQUFDLFVBQVUsSUFBSSxTQUFTLENBQUMsVUFBVSxDQUFDLE1BQU0sR0FBRyxDQUFDLEVBQUU7WUFDM0QsTUFBTSxDQUFDLElBQUksQ0FBQyxHQUFHLFNBQVMsQ0FBQyxVQUFVLENBQUMsQ0FBQztTQUN0QztRQUNELElBQUksU0FBUyxDQUFDLG1CQUFtQixJQUFJLFNBQVMsQ0FBQyxtQkFBbUIsQ0FBQyxNQUFNLEdBQUcsQ0FBQyxFQUFFO1lBQzdFLEtBQUssSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsR0FBRyxTQUFTLENBQUMsbUJBQW1CLENBQUMsTUFBTSxFQUFFLENBQUMsRUFBRSxFQUFFO2dCQUM3RCxNQUFNLENBQUMsSUFBSSxDQUFDLEdBQUcsSUFBSSxDQUFDLHdCQUF3QixDQUFDLG1CQUFBLFNBQVMsQ0FBQyxtQkFBbUIsQ0FBQyxDQUFDLENBQUMsRUFBc0IsQ0FBQyxDQUFDLENBQUM7YUFDdkc7U0FDRjtRQUNELE9BQU8sTUFBTSxDQUFDO0lBQ2hCLENBQUM7Ozs7OztJQUtELG9CQUFvQixDQUFDLEVBQXFCO1FBQ3hDLE9BQU8sSUFBSSxDQUFDLCtCQUErQixDQUFDLEVBQUUsQ0FBQyxVQUFVLENBQUMsQ0FBQztJQUM3RCxDQUFDOzs7OztJQUVELCtCQUErQixDQUFDLFNBQTZCOztjQUNyRCxNQUFNLEdBQUcsSUFBSSxLQUFLLEVBQWlCO1FBQ3pDLElBQUksQ0FBQyxDQUFDLFNBQVMsQ0FBQyxFQUFFO1lBQ2hCLE9BQU8sTUFBTSxDQUFDO1NBQ2Y7UUFDRCxJQUFJLFNBQVMsQ0FBQyxjQUFjLElBQUksU0FBUyxDQUFDLGNBQWMsQ0FBQyxNQUFNLEdBQUcsQ0FBQyxFQUFFO1lBQ25FLE1BQU0sQ0FBQyxJQUFJLENBQUMsR0FBRyxTQUFTLENBQUMsY0FBYyxDQUFDLENBQUM7U0FDMUM7UUFDRCxJQUFJLFNBQVMsQ0FBQyxtQkFBbUIsSUFBSSxTQUFTLENBQUMsbUJBQW1CLENBQUMsTUFBTSxHQUFHLENBQUMsRUFBRTtZQUM3RSxLQUFLLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsU0FBUyxDQUFDLG1CQUFtQixDQUFDLE1BQU0sRUFBRSxDQUFDLEVBQUUsRUFBRTtnQkFDN0QsTUFBTSxDQUFDLElBQUksQ0FBQyxHQUFHLElBQUksQ0FBQywrQkFBK0IsQ0FBQyxtQkFBQSxTQUFTLENBQUMsbUJBQW1CLENBQUMsQ0FBQyxDQUFDLEVBQXNCLENBQUMsQ0FBQyxDQUFDO2FBQzlHO1NBQ0Y7UUFDRCxPQUFPLE1BQU0sQ0FBQztJQUNoQixDQUFDOzs7Ozs7SUFLRCxpQkFBaUIsQ0FBQyxFQUFxQjtRQUNyQyxPQUFPLElBQUksQ0FBQyw0QkFBNEIsQ0FBQyxFQUFFLENBQUMsVUFBVSxDQUFDLENBQUM7SUFDMUQsQ0FBQzs7Ozs7SUFFRCw0QkFBNEIsQ0FBQyxTQUE2Qjs7Y0FDbEQsTUFBTSxHQUFHLElBQUksS0FBSyxFQUFjO1FBQ3RDLElBQUksQ0FBQyxDQUFDLFNBQVMsQ0FBQyxFQUFFO1lBQ2hCLE9BQU8sTUFBTSxDQUFDO1NBQ2Y7UUFDRCxJQUFJLFNBQVMsQ0FBQyxXQUFXLElBQUksU0FBUyxDQUFDLFdBQVcsQ0FBQyxNQUFNLEdBQUcsQ0FBQyxFQUFFO1lBQzdELE1BQU0sQ0FBQyxJQUFJLENBQUMsR0FBRyxTQUFTLENBQUMsV0FBVyxDQUFDLENBQUM7U0FDdkM7UUFDRCxJQUFJLFNBQVMsQ0FBQyxtQkFBbUIsSUFBSSxTQUFTLENBQUMsbUJBQW1CLENBQUMsTUFBTSxHQUFHLENBQUMsRUFBRTtZQUM3RSxLQUFLLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsU0FBUyxDQUFDLG1CQUFtQixDQUFDLE1BQU0sRUFBRSxDQUFDLEVBQUUsRUFBRTtnQkFDN0QsTUFBTSxDQUFDLElBQUksQ0FBQyxHQUFHLElBQUksQ0FBQyw0QkFBNEIsQ0FBQyxtQkFBQSxTQUFTLENBQUMsbUJBQW1CLENBQUMsQ0FBQyxDQUFDLEVBQXNCLENBQUMsQ0FBQyxDQUFDO2FBQzNHO1NBQ0Y7UUFDRCxPQUFPLE1BQU0sQ0FBQztJQUNoQixDQUFDOzs7Ozs7SUFLRCxnQkFBZ0IsQ0FBQyxFQUFxQjs7Y0FDOUIsTUFBTSxHQUFHLElBQUksS0FBSyxFQUFnQjtRQUN4QyxNQUFNLENBQUMsSUFBSSxDQUFDLEdBQUcsSUFBSSxDQUFDLHNCQUFzQixDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUM7UUFDaEQsTUFBTSxDQUFDLElBQUksQ0FBQyxHQUFHLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDO1FBQzFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsR0FBRyxJQUFJLENBQUMsb0JBQW9CLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQztRQUM5QyxNQUFNLENBQUMsSUFBSSxDQUFDLEdBQUcsSUFBSSxDQUFDLGlCQUFpQixDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUM7UUFDM0MsT0FBTyxNQUFNLENBQUM7SUFDaEIsQ0FBQzs7Ozs7OztJQU1ELGdDQUFnQyxDQUFDLEVBQXFCLEVBQUUsS0FBYTs7Y0FDN0QsV0FBVyxHQUFHLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxFQUFFLENBQUM7UUFDOUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxXQUFXLENBQUMsSUFBSSxXQUFXLENBQUMsTUFBTSxHQUFHLENBQUMsRUFBRTtZQUM3QyxLQUFLLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsV0FBVyxDQUFDLE1BQU0sRUFBRSxDQUFDLEVBQUUsRUFBRTs7c0JBQ3JDLENBQUMsR0FBRyxJQUFJLENBQUMsZ0NBQWdDLENBQUMsV0FBVyxDQUFDLENBQUMsQ0FBQyxFQUFFLEtBQUssQ0FBQztnQkFDdEUsSUFBSSxDQUFDLEVBQUU7OzBCQUNDLE1BQU0sR0FBRyxXQUFXLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSTtvQkFDbEMsT0FBTyxNQUFNLENBQUM7aUJBQ2Y7YUFDRjtTQUNGO1FBQ0QsT0FBTyxJQUFJLENBQUM7SUFDZCxDQUFDOzs7Ozs7O0lBTUQsbUNBQW1DLENBQUMsRUFBcUIsRUFBRSxLQUFhOztjQUNoRSxJQUFJLEdBQUcsSUFBSSxDQUFDLG9CQUFvQixDQUFDLEVBQUUsQ0FBQztRQUMxQyxJQUFJLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLElBQUksQ0FBQyxNQUFNLEdBQUcsQ0FBQyxFQUFFO1lBQy9CLEtBQUssSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsR0FBRyxJQUFJLENBQUMsTUFBTSxFQUFFLENBQUMsRUFBRSxFQUFFOztzQkFDOUIsQ0FBQyxHQUFHLElBQUksQ0FBQyxtQ0FBbUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLEVBQUUsS0FBSyxDQUFDO2dCQUNsRSxJQUFJLENBQUMsRUFBRTs7MEJBQ0MsTUFBTSxHQUFHLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJO29CQUMzQixPQUFPLE1BQU0sQ0FBQztpQkFDZjthQUNGO1NBQ0Y7UUFDRCxPQUFPLElBQUksQ0FBQztJQUNkLENBQUM7Ozs7Ozs7SUFFTyxXQUFXLENBQUMsRUFBVSxFQUFFLFdBQXFCO1FBQ25ELElBQUksQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsV0FBVyxDQUFDLElBQUksV0FBVyxDQUFDLE1BQU0sR0FBRyxDQUFDLEVBQUU7WUFDdkQsT0FBTyxXQUFXLENBQUMsT0FBTyxDQUFDLEVBQUUsQ0FBQyxJQUFJLENBQUMsQ0FBQztTQUNyQztRQUNELE9BQU8sS0FBSyxDQUFDO0lBQ2YsQ0FBQzs7Ozs7OztJQUtELG1DQUFtQyxDQUFDLEdBQWtCLEVBQUUsRUFBVTtRQUNoRSxJQUFJLElBQUksQ0FBQyxXQUFXLENBQUMsRUFBRSxFQUFFLEdBQUcsQ0FBQyxlQUFlLENBQUMsRUFBRTtZQUM3QyxPQUFPLElBQUksQ0FBQztTQUNiO1FBQ0QsSUFBSSxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsb0JBQW9CLENBQUMsSUFBSSxHQUFHLENBQUMsb0JBQW9CLENBQUMsTUFBTSxHQUFHLENBQUMsRUFBRTtZQUN2RSxPQUFPLElBQUksQ0FBQyxXQUFXLENBQUMsRUFBRSxFQUFFLEdBQUcsQ0FBQyxvQkFBb0IsQ0FBQyxDQUFDLENBQUMsQ0FBQyx3QkFBd0IsQ0FBQyxDQUFDO1NBQ25GO1FBQ0QsT0FBTyxLQUFLLENBQUM7SUFDZixDQUFDOzs7Ozs7O0lBS0QsZ0NBQWdDLENBQUMsVUFBc0IsRUFBRSxFQUFVO1FBQ2pFLElBQUksSUFBSSxDQUFDLFdBQVcsQ0FBQyxFQUFFLEVBQUUsVUFBVSxDQUFDLGVBQWUsQ0FBQyxFQUFFO1lBQ3BELE9BQU8sSUFBSSxDQUFDO1NBQ2I7UUFDRCxJQUFJLENBQUMsQ0FBQyxDQUFDLFVBQVUsQ0FBQyxvQkFBb0IsQ0FBQyxJQUFJLFVBQVUsQ0FBQyxvQkFBb0IsQ0FBQyxNQUFNLEdBQUcsQ0FBQyxFQUFFO1lBQ3JGLE9BQU8sSUFBSSxDQUFDLFdBQVcsQ0FBQyxFQUFFLEVBQUUsVUFBVSxDQUFDLG9CQUFvQixDQUFDLENBQUMsQ0FBQyxDQUFDLHdCQUF3QixDQUFDLENBQUM7U0FDMUY7UUFDRCxPQUFPLEtBQUssQ0FBQztJQUNmLENBQUM7Q0FDRiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEdTUEJ1c2luZXNzRW50aXR5IH0gZnJvbSAnLi4vR1NQQnVzaW5lc3NFbnRpdHknO1xyXG5pbXBvcnQgeyBCaXpBY3Rpb24gfSBmcm9tICcuLi9PcGVyYXRpb24vQml6QWN0aW9uJztcclxuaW1wb3J0IHsgR1NQQml6RW50aXR5T2JqZWN0IH0gZnJvbSAnLi4vR1NQQml6RW50aXR5T2JqZWN0JztcclxuXHJcbmltcG9ydCB7IERldGVybWluYXRpb24gfSBmcm9tICcuLi9PcGVyYXRpb24vRGV0ZXJtaW5hdGlvbic7XHJcbmltcG9ydCB7IFZhbGlkYXRpb24gfSBmcm9tICcuLi9PcGVyYXRpb24vVmFsaWRhdGlvbic7XHJcbmltcG9ydCB7IEJpek9wZXJhdGlvbiB9IGZyb20gJy4uL09wZXJhdGlvbi9CaXpPcGVyYXRpb24nO1xyXG5pbXBvcnQgeyBCaXpNZ3JBY3Rpb24gfSBmcm9tICcuLi9PcGVyYXRpb24vQml6TWdyQWN0aW9uJztcclxuXHJcbmV4cG9ydCBjbGFzcyBCZU9wZXJhdGlvblV0aWwge1xyXG4gIGdldEFsbE1nckFjdGlvbnMoYmU6IEdTUEJ1c2luZXNzRW50aXR5KTogQml6TWdyQWN0aW9uW10ge1xyXG4gICAgcmV0dXJuIGJlLkJpek1nckFjdGlvbnM7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBiaXpBY3Rpb25zXHJcbiAgICovXHJcbiAgZ2V0QWxsQml6RW50aXR5QWN0aW9ucyhiZTogR1NQQnVzaW5lc3NFbnRpdHkpOiBCaXpBY3Rpb25bXSB7XHJcbiAgICByZXR1cm4gdGhpcy5nZXRDaGlkcmVuT2JqZWN0c0FjdGlvbnMoYmUuTWFpbk9iamVjdCk7XHJcbiAgfVxyXG5cclxuICBnZXRDaGlkcmVuT2JqZWN0c0FjdGlvbnMoYml6T2JqZWN0OiBHU1BCaXpFbnRpdHlPYmplY3QpOiBCaXpBY3Rpb25bXSB7XHJcbiAgICBjb25zdCByZXN1bHQgPSBuZXcgQXJyYXk8Qml6QWN0aW9uPigpO1xyXG4gICAgaWYgKCEoYml6T2JqZWN0KSkge1xyXG4gICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgfVxyXG4gICAgaWYgKGJpek9iamVjdC5CaXpBY3Rpb25zICYmIGJpek9iamVjdC5CaXpBY3Rpb25zLmxlbmd0aCA+IDApIHtcclxuICAgICAgcmVzdWx0LnB1c2goLi4uYml6T2JqZWN0LkJpekFjdGlvbnMpO1xyXG4gICAgfVxyXG4gICAgaWYgKGJpek9iamVjdC5Db250YWluQ2hpbGRPYmplY3RzICYmIGJpek9iamVjdC5Db250YWluQ2hpbGRPYmplY3RzLmxlbmd0aCA+IDApIHtcclxuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBiaXpPYmplY3QuQ29udGFpbkNoaWxkT2JqZWN0cy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgIHJlc3VsdC5wdXNoKC4uLnRoaXMuZ2V0Q2hpZHJlbk9iamVjdHNBY3Rpb25zKGJpek9iamVjdC5Db250YWluQ2hpbGRPYmplY3RzW2ldIGFzIEdTUEJpekVudGl0eU9iamVjdCkpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gcmVzdWx0O1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogZGV0ZXJtaW5hdGlvblxyXG4gICAqL1xyXG4gIGdldEFsbERldGVybWluYXRpb25zKGJlOiBHU1BCdXNpbmVzc0VudGl0eSk6IERldGVybWluYXRpb25bXSB7XHJcbiAgICByZXR1cm4gdGhpcy5nZXRDaGlkcmVuT2JqZWN0c0RldGVybWluYXRpb25zKGJlLk1haW5PYmplY3QpO1xyXG4gIH1cclxuXHJcbiAgZ2V0Q2hpZHJlbk9iamVjdHNEZXRlcm1pbmF0aW9ucyhiaXpPYmplY3Q6IEdTUEJpekVudGl0eU9iamVjdCk6IERldGVybWluYXRpb25bXSB7XHJcbiAgICBjb25zdCByZXN1bHQgPSBuZXcgQXJyYXk8RGV0ZXJtaW5hdGlvbj4oKTtcclxuICAgIGlmICghKGJpek9iamVjdCkpIHtcclxuICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgIH1cclxuICAgIGlmIChiaXpPYmplY3QuRGV0ZXJtaW5hdGlvbnMgJiYgYml6T2JqZWN0LkRldGVybWluYXRpb25zLmxlbmd0aCA+IDApIHtcclxuICAgICAgcmVzdWx0LnB1c2goLi4uYml6T2JqZWN0LkRldGVybWluYXRpb25zKTtcclxuICAgIH1cclxuICAgIGlmIChiaXpPYmplY3QuQ29udGFpbkNoaWxkT2JqZWN0cyAmJiBiaXpPYmplY3QuQ29udGFpbkNoaWxkT2JqZWN0cy5sZW5ndGggPiAwKSB7XHJcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYml6T2JqZWN0LkNvbnRhaW5DaGlsZE9iamVjdHMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICByZXN1bHQucHVzaCguLi50aGlzLmdldENoaWRyZW5PYmplY3RzRGV0ZXJtaW5hdGlvbnMoYml6T2JqZWN0LkNvbnRhaW5DaGlsZE9iamVjdHNbaV0gYXMgR1NQQml6RW50aXR5T2JqZWN0KSk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiByZXN1bHQ7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiB2YWxpZGF0aW9uXHJcbiAgICovXHJcbiAgZ2V0QWxsVmFsaWRhdGlvbnMoYmU6IEdTUEJ1c2luZXNzRW50aXR5KTogVmFsaWRhdGlvbltdIHtcclxuICAgIHJldHVybiB0aGlzLmdldENoaWRyZW5PYmplY3RzVmFsaWRhdGlvbnMoYmUuTWFpbk9iamVjdCk7XHJcbiAgfVxyXG5cclxuICBnZXRDaGlkcmVuT2JqZWN0c1ZhbGlkYXRpb25zKGJpek9iamVjdDogR1NQQml6RW50aXR5T2JqZWN0KTogVmFsaWRhdGlvbltdIHtcclxuICAgIGNvbnN0IHJlc3VsdCA9IG5ldyBBcnJheTxWYWxpZGF0aW9uPigpO1xyXG4gICAgaWYgKCEoYml6T2JqZWN0KSkge1xyXG4gICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgfVxyXG4gICAgaWYgKGJpek9iamVjdC5WYWxpZGF0aW9ucyAmJiBiaXpPYmplY3QuVmFsaWRhdGlvbnMubGVuZ3RoID4gMCkge1xyXG4gICAgICByZXN1bHQucHVzaCguLi5iaXpPYmplY3QuVmFsaWRhdGlvbnMpO1xyXG4gICAgfVxyXG4gICAgaWYgKGJpek9iamVjdC5Db250YWluQ2hpbGRPYmplY3RzICYmIGJpek9iamVjdC5Db250YWluQ2hpbGRPYmplY3RzLmxlbmd0aCA+IDApIHtcclxuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBiaXpPYmplY3QuQ29udGFpbkNoaWxkT2JqZWN0cy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgIHJlc3VsdC5wdXNoKC4uLnRoaXMuZ2V0Q2hpZHJlbk9iamVjdHNWYWxpZGF0aW9ucyhiaXpPYmplY3QuQ29udGFpbkNoaWxkT2JqZWN0c1tpXSBhcyBHU1BCaXpFbnRpdHlPYmplY3QpKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIHJlc3VsdDtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOiOt+WPluaJgOacieaTjeS9nFxyXG4gICAqL1xyXG4gIGdldEFsbE9wZXJhdGlvbnMoYmU6IEdTUEJ1c2luZXNzRW50aXR5KTogQml6T3BlcmF0aW9uW10ge1xyXG4gICAgY29uc3QgcmVzdWx0ID0gbmV3IEFycmF5PEJpek9wZXJhdGlvbj4oKTtcclxuICAgIHJlc3VsdC5wdXNoKC4uLnRoaXMuZ2V0QWxsQml6RW50aXR5QWN0aW9ucyhiZSkpO1xyXG4gICAgcmVzdWx0LnB1c2goLi4udGhpcy5nZXRBbGxNZ3JBY3Rpb25zKGJlKSk7XHJcbiAgICByZXN1bHQucHVzaCguLi50aGlzLmdldEFsbERldGVybWluYXRpb25zKGJlKSk7XHJcbiAgICByZXN1bHQucHVzaCguLi50aGlzLmdldEFsbFZhbGlkYXRpb25zKGJlKSk7XHJcbiAgICByZXR1cm4gcmVzdWx0O1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogdmFsaWRhdGlvbuinpuWPkeWtl+auteS4reaYr+WQpuWMheWQq+afkOWtl+autVxyXG4gICAqIEBwYXJhbSBlbGVJZCDlrZfmrrVJRFxyXG4gICAqL1xyXG4gIGNvdW50YWluVmFsaWRhdGlvblJlcXVlc3RFbGVtZW50KGJlOiBHU1BCdXNpbmVzc0VudGl0eSwgZWxlSWQ6IHN0cmluZyk6IHN0cmluZyB7XHJcbiAgICBjb25zdCB2YWxpZGF0aW9ucyA9IHRoaXMuZ2V0QWxsVmFsaWRhdGlvbnMoYmUpO1xyXG4gICAgaWYgKCEhKHZhbGlkYXRpb25zKSAmJiB2YWxpZGF0aW9ucy5sZW5ndGggPiAwKSB7XHJcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdmFsaWRhdGlvbnMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICBjb25zdCBiID0gdGhpcy52YWxpZGF0aW9uQ291bnRhaW5SZXF1ZXN0RWxlbWVudCh2YWxpZGF0aW9uc1tpXSwgZWxlSWQpO1xyXG4gICAgICAgIGlmIChiKSB7XHJcbiAgICAgICAgICBjb25zdCByZXN1bHQgPSB2YWxpZGF0aW9uc1tpXS5OYW1lO1xyXG4gICAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiBudWxsO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogZGV0ZXJtaW5hdGlvbuinpuWPkeWtl+auteS4reaYr+WQpuWMheWQq+afkOWtl+autVxyXG4gICAqIEBwYXJhbSBlbGVJZCDlrZfmrrVJRFxyXG4gICAqL1xyXG4gIGNvdW50YWluRGV0ZXJtaW5hdGlvblJlcXVlc3RFbGVtZW50KGJlOiBHU1BCdXNpbmVzc0VudGl0eSwgZWxlSWQ6IHN0cmluZyk6IHN0cmluZyB7XHJcbiAgICBjb25zdCBkdG1zID0gdGhpcy5nZXRBbGxEZXRlcm1pbmF0aW9ucyhiZSk7XHJcbiAgICBpZiAoISEoZHRtcykgJiYgZHRtcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZHRtcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgIGNvbnN0IGIgPSB0aGlzLmRldGVybWluYXRpb25Db3VudGFpblJlcXVlc3RFbGVtZW50KGR0bXNbaV0sIGVsZUlkKTtcclxuICAgICAgICBpZiAoYikge1xyXG4gICAgICAgICAgY29uc3QgcmVzdWx0ID0gZHRtc1tpXS5OYW1lO1xyXG4gICAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiBudWxsO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBjb3VudGFpbkVsZShpZDogc3RyaW5nLCByZXF1ZXN0RWxlczogc3RyaW5nW10pOiBib29sZWFuIHtcclxuICAgIGlmICghIShpZCkgJiYgISEocmVxdWVzdEVsZXMpICYmIHJlcXVlc3RFbGVzLmxlbmd0aCA+IDApIHtcclxuICAgICAgcmV0dXJuIHJlcXVlc3RFbGVzLmluZGV4T2YoaWQpID49IDA7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gZmFsc2U7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDop6blj5HlrZfmrrXkuK3mmK/lkKbljIXlkKvmn5DlrZfmrrVcclxuICAgKi9cclxuICBkZXRlcm1pbmF0aW9uQ291bnRhaW5SZXF1ZXN0RWxlbWVudChkdG06IERldGVybWluYXRpb24sIGlkOiBzdHJpbmcpOiBib29sZWFuIHtcclxuICAgIGlmICh0aGlzLmNvdW50YWluRWxlKGlkLCBkdG0uUmVxdWVzdEVsZW1lbnRzKSkge1xyXG4gICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH1cclxuICAgIGlmICghIShkdG0uUmVxdWVzdENoaWxkRWxlbWVudHMpICYmIGR0bS5SZXF1ZXN0Q2hpbGRFbGVtZW50cy5sZW5ndGggPiAwKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLmNvdW50YWluRWxlKGlkLCBkdG0uUmVxdWVzdENoaWxkRWxlbWVudHNbMF0uUmVxdWVzdENoaWxkRWxlbWVudFZhbHVlKTtcclxuICAgIH1cclxuICAgIHJldHVybiBmYWxzZTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOinpuWPkeWtl+auteS4reaYr+WQpuWMheWQq+afkOWtl+autVxyXG4gICAqL1xyXG4gIHZhbGlkYXRpb25Db3VudGFpblJlcXVlc3RFbGVtZW50KHZhbGlkYXRpb246IFZhbGlkYXRpb24sIGlkOiBzdHJpbmcpOiBib29sZWFuIHtcclxuICAgIGlmICh0aGlzLmNvdW50YWluRWxlKGlkLCB2YWxpZGF0aW9uLlJlcXVlc3RFbGVtZW50cykpIHtcclxuICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9XHJcbiAgICBpZiAoISEodmFsaWRhdGlvbi5SZXF1ZXN0Q2hpbGRFbGVtZW50cykgJiYgdmFsaWRhdGlvbi5SZXF1ZXN0Q2hpbGRFbGVtZW50cy5sZW5ndGggPiAwKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLmNvdW50YWluRWxlKGlkLCB2YWxpZGF0aW9uLlJlcXVlc3RDaGlsZEVsZW1lbnRzWzBdLlJlcXVlc3RDaGlsZEVsZW1lbnRWYWx1ZSk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gZmFsc2U7XHJcbiAgfVxyXG59XHJcbiJdfQ==