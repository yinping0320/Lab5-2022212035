/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, EventEmitter, Output, TemplateRef, ViewChild } from '@angular/core';
import { HttpClient } from "@angular/common/http";
import { NotifyService } from "@farris/ui-notify";
import { DataIEUtils, isNullOrEmpty, isNullOrBlank } from "../../service/Utils/DataIEUtils";
import { DatagridComponent } from "@farris/ui-datagrid";
/**
 * 预留扩展组件1
 * 此组件目前被用于作为规则选择扩展模板配置界面
 */
export class ExtendComponent1Component {
    /**
     * @param {?} http
     * @param {?} notify
     */
    constructor(http, notify) {
        this.http = http;
        this.notify = notify;
        this.closeModal = new EventEmitter();
        this.okModal = new EventEmitter();
        this.ObjInfoColumns = [];
        this.ObjInfoData = [];
        this.FieldsColumns = [];
        this.FieldsData = [];
        this.canNotCheckedRow = (/**
         * @param {?} row
         * @param {?} index
         * @return {?}
         */
        (row, index) => {
            return row.require;
        });
        DataIEUtils.getTranslateValue(http).subscribe((/**
         * @param {?} res
         * @return {?}
         */
        res => {
            this.i18nResouce = res;
            this.ie_cancel = res['ie_cancel'];
            this.ie_ok = res['ie_ok'];
        }));
    }
    /**
     * @return {?}
     */
    ngOnInit() {
        this.ObjInfoColumns = [
            { field: 'fileObjectName', width: 100, title: '对象名称', sortable: false, showTips: true }
        ];
        this.dataIeRuleExtend = JSON.parse(JSON.stringify(this.dataIeRuleExtendOriginal));
        this.extendRuleInfo = JSON.parse(this.dataIeRuleExtend.extendRuleInfo);
        this.ObjInfoData = this.extendRuleInfo.objInfos;
        this.FieldsColumns = [
            { field: 'fileElementName', width: 100, title: '列名', sortable: false, showTips: true, filter: true }
        ];
    }
    /**
     * @return {?}
     */
    ngAfterViewInit() {
        // this.objSelectChanged({data:this.ObjInfoData[0]});
        this.ObjsGrid.selectRow(this.ObjInfoData[0].id);
    }
    /**
     * @param {?} e
     * @return {?}
     */
    moveUp(e) {
        /** @type {?} */
        const selectedRow = this.FieldsGrid.selectedRow;
        if (!selectedRow || !selectedRow.data) {
            return;
        }
        /** @type {?} */
        const id = selectedRow.data.id;
        /** @type {?} */
        const idx = this.FieldsData.findIndex((/**
         * @param {?} e
         * @return {?}
         */
        e => e.id === id));
        if (idx <= 0) {
            return;
        }
        /** @type {?} */
        const temp = this.FieldsData.splice(idx, 1);
        this.FieldsData.splice(idx - 1, 0, ...temp);
        this.FieldsData = JSON.parse(JSON.stringify(this.FieldsData));
        this.FieldsGrid.selectRow(id);
    }
    /**
     * @param {?} e
     * @return {?}
     */
    moveDown(e) {
        /** @type {?} */
        const selectedRow = this.FieldsGrid.selectedRow;
        if (!selectedRow || !selectedRow.data) {
            return;
        }
        /** @type {?} */
        const id = selectedRow.data.id;
        /** @type {?} */
        const idx = this.FieldsData.findIndex((/**
         * @param {?} e
         * @return {?}
         */
        e => e.id === id));
        if (idx >= this.FieldsData.length - 1) {
            return;
        }
        /** @type {?} */
        const temp = this.FieldsData.splice(idx, 1);
        this.FieldsData.splice(idx + 1, 0, ...temp);
        this.FieldsData = JSON.parse(JSON.stringify(this.FieldsData));
        this.FieldsGrid.selectRow(id);
    }
    /**
     * @param {?} e
     * @return {?}
     */
    onFilterChanged(e) {
        if (!e.fileElementName) {
            /** @type {?} */
            const selectedRow = this.ObjsGrid.selectedRow;
            if (!selectedRow || !selectedRow.data) {
                return;
            }
            this.objSelectChanged(selectedRow);
        }
    }
    /**
     * @param {?} e
     * @return {?}
     */
    objSelectChanged(e) {
        /** @type {?} */
        const rowDataId = e.data.id;
        /** @type {?} */
        const idx = this.ObjInfoData.findIndex((/**
         * @param {?} e
         * @return {?}
         */
        e => e.id === rowDataId));
        if (idx >= 0) {
            this.FieldsData = this.ObjInfoData[idx].fieldsInfo;
            this.FieldsGrid.loadData(this.FieldsData);
            // this.FieldsGrid = JSON.parse(JSON.stringify(fieldsData));
            this.FieldsData.forEach((/**
             * @param {?} d
             * @return {?}
             */
            d => {
                if (d.checked) {
                    this.FieldsGrid.checkRow(d.id, false);
                }
            }));
            /** @type {?} */
            const selectedRow = this.FieldsGrid.selectedRow;
            if (selectedRow) {
                this.FieldsGrid.clearSelections();
            }
        }
    }
    /**
     * @param {?} e
     * @return {?}
     */
    ElementCheckedRow(e) {
        /** @type {?} */
        const rowData = e.data;
        /** @type {?} */
        const idx = this.FieldsData.findIndex((/**
         * @param {?} e
         * @return {?}
         */
        e => e.id === rowData.id));
        if (idx >= 0) {
            this.FieldsData[idx].checked = true;
        }
    }
    /**
     * @param {?} e
     * @return {?}
     */
    ElementUnCheckedRow(e) {
        /** @type {?} */
        const rowData = e.data;
        /** @type {?} */
        const idx = this.FieldsData.findIndex((/**
         * @param {?} e
         * @return {?}
         */
        e => e.id === rowData.id));
        if (idx >= 0) {
            this.FieldsData[idx].checked = false;
        }
    }
    /**
     * @param {?} e
     * @return {?}
     */
    ElementCheckedAll(e) {
        this.FieldsData.forEach((/**
         * @param {?} d
         * @return {?}
         */
        d => {
            d.checked = true;
        }));
    }
    /**
     * @param {?} e
     * @return {?}
     */
    ElementUnCheckedAll(e) {
        if (isNullOrEmpty(e)) {
            return;
        }
        this.FieldsData.forEach((/**
         * @param {?} d
         * @return {?}
         */
        d => {
            d.checked = false;
        }));
    }
    /**
     * @return {?}
     */
    okHandler() {
        if (isNullOrBlank(this.dataIeRuleExtend.code)) {
            this.notify.warning('模板编号不能为空');
            return;
        }
        if (isNullOrBlank(this.dataIeRuleExtend.name)) {
            this.notify.warning('模板名称不能为空');
            return;
        }
        this.extendRuleInfo.objInfos = this.ObjInfoData;
        this.dataIeRuleExtend.extendRuleInfo = JSON.stringify(this.extendRuleInfo);
        /** @type {?} */
        const url = '/api/runtime/dip/v1.0/dataIeRuleManage/checkUpdateRuleExtend';
        this.http.post(url, this.dataIeRuleExtend).subscribe((/**
         * @param {?} e
         * @return {?}
         */
        (e) => {
            if (e.success) {
                this.okModal.emit(this.dataIeRuleExtend);
            }
        }), (/**
         * @param {?} error
         * @return {?}
         */
        error => {
            this.notify.error(error.error.Message);
            console.log(error.error.Message);
        }));
    }
    /**
     * @return {?}
     */
    cancelHandler() {
        this.closeModal.emit();
    }
}
ExtendComponent1Component.decorators = [
    { type: Component, args: [{
                selector: 'hlo-extend-component1',
                template: "<form class=\"px-3 px-md-4 farris-form d-flex flex-wrap\" style=\"margin-top: 13px;\">\n\n  <div class=\"farris-group-wrap form-inline farris-form-inline item-label\">\n    <div class=\"form-group farris-form-group\">\n      <label class=\" col-form-label\">\n        <span class=\"farris-label-info text-danger\">*</span>\n        <span class=\"farris-label-text\">\u6A21\u677F\u7F16\u53F7</span>\n      </label>\n      <div class=\"farris-input-wrap\" style=\"width:240px;\">\n        <input-group name=\"templateCode\" [(ngModel)]=\"dataIeRuleExtend.code\"></input-group>\n        <div class=\"farris-feedback valid-feedback\"></div>\n      </div>\n    </div>\n  </div>\n  <div class=\"farris-group-wrap form-inline farris-form-inline item-label\">\n    <div class=\"form-group farris-form-group\">\n      <label class=\" col-form-label\">\n        <span class=\"farris-label-info text-danger\">*</span>\n        <span class=\"farris-label-text\">\u6A21\u677F\u540D\u79F0</span>\n      </label>\n      <div class=\"farris-input-wrap\" style=\"width:240px;\">\n        <input-group name=\"templateName\" [(ngModel)]=\"dataIeRuleExtend.name\"></input-group>\n        <div class=\"farris-feedback valid-feedback\"></div>\n      </div>\n    </div>\n  </div>\n\n\n</form>\n<farris-section style=\"height: 500px;\">\n  <div class=\"f-page f-page-is-wizard\">\n    <div class=\"position-relative flex-fill farris-split-section m-2 farris-overflow-hidden\">\n\n      <layout id=\"manage-layout\" direction=\"h\" fill=\"true\" class=\"d-flex flex-row layout-fill\">\n        <layout-panel id=\"adptor-layout-panel-left\" class=\"col-2 d-flex flex-column farris-lsection p-0\" region=\"west\"\n                      minWidth=\"150\"\n                      showBorder=\"false\"\n                      style=\"flex: 0 0 auto; max-width: none; width: 260px;margin-top: 14px;overflow-y: auto;overflow-x: hidden\">\n          <div class=\"flex-fill farris-overflow-y-auto\" style=\"background-color: white;height: 468px;\">\n            <farris-datagrid #ObjsGrid id=\"objs-grid\" [idField]=\"'id'\" [fit]=\"true\" [fitColumns]=\"true\"\n                             [columns]=\"ObjInfoColumns\"\n                             [pagination]=\"false\" [showBorder]=\"true\" [striped]=\"true\" [showLineNumber]=\"true\"\n                             [sizeType]=\"'sm'\"\n                             [data]=\"ObjInfoData\" [editable]=\"false\" (selectChanged)=\"objSelectChanged($event)\">\n            </farris-datagrid>\n          </div>\n        </layout-panel>\n\n        <layout-panel id=\"adptor-layout-panel-right\" class=\"farris-rsection f-overflow-y-auto d-flex flex-fill\"\n                      region=\"center\" minWidth=\"280\"\n                      showBorder=\"false\">\n          <div class=\"f-struct-wrapper f-utils-fill-flex-column\" style=\"width: 445px;height: 460px;\">\n            <div class=\"row\" style=\"margin-left:5px;\">\n              <farris-button [type]=\"'link'\" (click)=\"moveUp($event)\">\u4E0A\u79FB</farris-button>\n              <farris-button [type]=\"'link'\" (click)=\"moveDown($event)\">\u4E0B\u79FB</farris-button>\n            </div>\n            <farris-datagrid #FieldsGrid id=\"fields-grid\" [idField]=\"'id'\" [fit]=\"true\" [fitColumns]=\"true\"\n                             [columns]=\"FieldsColumns\"\n                             [showAllCheckbox]=\"false\" [selectOnCheck]=\"true\" [onlySelectSelf]=\"true\"\n                             [showCheckbox]=\"true\"\n                             [multiSelect]=\"true\" [keepSelect]=\"true\" [pagination]=\"false\" [showBorder]=\"true\"\n                             [showLineNumber]=\"true\"\n                             [striped]=\"true\" [sizeType]=\"'sm'\" [data]=\"FieldsData\" [enableFilterRow]=\"true\"\n                             (filterChanged)=\"onFilterChanged($event)\" [disableRow]=\"canNotCheckedRow\"\n                             (checked)=\"ElementCheckedRow($event)\" (unChecked)=\"ElementUnCheckedRow($event)\"\n                             >\n            </farris-datagrid>\n          </div>\n        </layout-panel>\n      </layout>\n\n    </div>\n  </div>\n</farris-section>\n\n\n<ng-template #selectFooter>\n  <button type=\"button\" class=\"btn btn-outline-secondary\" (click)=\"cancelHandler()\">{{ie_cancel}}</button>\n  <button type=\"button\" class=\"btn btn-primary\" (click)=\"okHandler()\">{{ie_ok}}</button>\n</ng-template>\n",
                styles: [""]
            }] }
];
/** @nocollapse */
ExtendComponent1Component.ctorParameters = () => [
    { type: HttpClient },
    { type: NotifyService }
];
ExtendComponent1Component.propDecorators = {
    ObjsGrid: [{ type: ViewChild, args: ['ObjsGrid',] }],
    FieldsGrid: [{ type: ViewChild, args: ['FieldsGrid',] }],
    modalFooter: [{ type: ViewChild, args: ['selectFooter',] }],
    closeModal: [{ type: Output }],
    okModal: [{ type: Output }]
};
if (false) {
    /** @type {?} */
    ExtendComponent1Component.prototype.ObjsGrid;
    /** @type {?} */
    ExtendComponent1Component.prototype.FieldsGrid;
    /** @type {?} */
    ExtendComponent1Component.prototype.modalFooter;
    /** @type {?} */
    ExtendComponent1Component.prototype.closeModal;
    /** @type {?} */
    ExtendComponent1Component.prototype.okModal;
    /** @type {?} */
    ExtendComponent1Component.prototype.dataIeRuleExtendOriginal;
    /** @type {?} */
    ExtendComponent1Component.prototype.dataIeRuleExtend;
    /** @type {?} */
    ExtendComponent1Component.prototype.extendRuleInfo;
    /** @type {?} */
    ExtendComponent1Component.prototype.ObjInfoColumns;
    /** @type {?} */
    ExtendComponent1Component.prototype.ObjInfoData;
    /** @type {?} */
    ExtendComponent1Component.prototype.FieldsColumns;
    /** @type {?} */
    ExtendComponent1Component.prototype.FieldsData;
    /** @type {?} */
    ExtendComponent1Component.prototype.i18nResouce;
    /** @type {?} */
    ExtendComponent1Component.prototype.ie_cancel;
    /** @type {?} */
    ExtendComponent1Component.prototype.ie_ok;
    /** @type {?} */
    ExtendComponent1Component.prototype.canNotCheckedRow;
    /**
     * @type {?}
     * @private
     */
    ExtendComponent1Component.prototype.http;
    /**
     * @type {?}
     * @private
     */
    ExtendComponent1Component.prototype.notify;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZXh0ZW5kLWNvbXBvbmVudDEuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGdzcC1kaXAvZGF0YS1pbXAtZXhwLyIsInNvdXJjZXMiOlsibGliL2Jha2NvbXBvbmVudHMvZXh0ZW5kLWNvbXBvbmVudDEvZXh0ZW5kLWNvbXBvbmVudDEuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7QUFBQSxPQUFPLEVBQUMsU0FBUyxFQUFFLFlBQVksRUFBVSxNQUFNLEVBQUUsV0FBVyxFQUFFLFNBQVMsRUFBQyxNQUFNLGVBQWUsQ0FBQztBQUM5RixPQUFPLEVBQUMsVUFBVSxFQUFDLE1BQU0sc0JBQXNCLENBQUM7QUFDaEQsT0FBTyxFQUFDLGFBQWEsRUFBQyxNQUFNLG1CQUFtQixDQUFDO0FBQ2hELE9BQU8sRUFBQyxXQUFXLEVBQUUsYUFBYSxFQUFFLGFBQWEsRUFBQyxNQUFNLGlDQUFpQyxDQUFDO0FBQzFGLE9BQU8sRUFBQyxpQkFBaUIsRUFBQyxNQUFNLHFCQUFxQixDQUFDO0FBT3REOzs7R0FHRztBQUNILE1BQU0sT0FBTyx5QkFBeUI7Ozs7O0lBcUJwQyxZQUNVLElBQWdCLEVBQ2hCLE1BQXFCO1FBRHJCLFNBQUksR0FBSixJQUFJLENBQVk7UUFDaEIsV0FBTSxHQUFOLE1BQU0sQ0FBZTtRQWxCckIsZUFBVSxHQUFHLElBQUksWUFBWSxFQUFPLENBQUM7UUFDckMsWUFBTyxHQUFHLElBQUksWUFBWSxFQUFPLENBQUM7UUFNNUMsbUJBQWMsR0FBRyxFQUFFLENBQUM7UUFDcEIsZ0JBQVcsR0FBRyxFQUFFLENBQUM7UUFDakIsa0JBQWEsR0FBRyxFQUFFLENBQUM7UUFDbkIsZUFBVSxHQUFHLEVBQUUsQ0FBQztRQW1DaEIscUJBQWdCOzs7OztRQUFHLENBQUMsR0FBRyxFQUFFLEtBQUssRUFBRSxFQUFFO1lBQ2hDLE9BQU8sR0FBRyxDQUFDLE9BQU8sQ0FBQztRQUNyQixDQUFDLEVBQUM7UUEzQkEsV0FBVyxDQUFDLGlCQUFp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LEVBQUUsRUFBRTtZQUM5RCxJQUFJLENBQUMsQ0FBQyxPQUFPLEVBQUU7Z0JBQ2IsSUFBSSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLGdCQUFnQixDQUFDLENBQUM7YUFDMUM7UUFDSCxDQUFDOzs7O1FBQUUsS0FBSyxDQUFDLEVBQUU7WUFDVCxJQUFJLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxDQUFDO1lBQ3ZDLE9BQU8sQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDLEtBQUssQ0FBQyxPQUFPLENBQUMsQ0FBQztRQUNuQyxDQUFDLEVBQUMsQ0FBQztJQUNMLENBQUM7Ozs7SUFFRCxhQUFhO1FBQ1gsSUFBSSxDQUFDLFVBQVUsQ0FBQyxJQUFJLEVBQUUsQ0FBQztJQUN6QixDQUFDOzs7WUFyTEYsU0FBUyxTQUFDO2dCQUNULFFBQVEsRUFBRSx1QkFBdUI7Z0JBQ2pDLDYySUFBaUQ7O2FBRWxEOzs7O1lBVE8sVUFBVTtZQUNWLGFBQWE7Ozt1QkFjbEIsU0FBUyxTQUFDLFVBQVU7eUJBQ3BCLFNBQVMsU0FBQyxZQUFZOzBCQUV0QixTQUFTLFNBQUMsY0FBYzt5QkFDeEIsTUFBTTtzQkFDTixNQUFNOzs7O0lBTFAsNkNBQW1EOztJQUNuRCwrQ0FBdUQ7O0lBRXZELGdEQUF5RDs7SUFDekQsK0NBQStDOztJQUMvQyw0Q0FBNEM7O0lBRTVDLDZEQUE4Qjs7SUFDOUIscURBQXNCOztJQUN0QixtREFBb0I7O0lBRXBCLG1EQUFvQjs7SUFDcEIsZ0RBQWlCOztJQUNqQixrREFBbUI7O0lBQ25CLCtDQUFnQjs7SUFFaEIsZ0RBQWlCOztJQUNqQiw4Q0FBa0I7O0lBQ2xCLDBDQUFjOztJQStCZCxxREFFRTs7Ozs7SUE5QkEseUNBQXdCOzs7OztJQUN4QiwyQ0FBNkIiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge0NvbXBvbmVudCwgRXZlbnRFbWl0dGVyLCBPbkluaXQsIE91dHB1dCwgVGVtcGxhdGVSZWYsIFZpZXdDaGlsZH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQge0h0dHBDbGllbnR9IGZyb20gXCJAYW5ndWxhci9jb21tb24vaHR0cFwiO1xuaW1wb3J0IHtOb3RpZnlTZXJ2aWNlfSBmcm9tIFwiQGZhcnJpcy91aS1ub3RpZnlcIjtcbmltcG9ydCB7RGF0YUlFVXRpbHMsIGlzTnVsbE9yRW1wdHksIGlzTnVsbE9yQmxhbmt9IGZyb20gXCIuLi8uLi9zZXJ2aWNlL1V0aWxzL0RhdGFJRVV0aWxzXCI7XG5pbXBvcnQge0RhdGFncmlkQ29tcG9uZW50fSBmcm9tIFwiQGZhcnJpcy91aS1kYXRhZ3JpZFwiO1xuXG5AQ29tcG9uZW50KHtcbiAgc2VsZWN0b3I6ICdobG8tZXh0ZW5kLWNvbXBvbmVudDEnLFxuICB0ZW1wbGF0ZVVybDogJy4vZXh0ZW5kLWNvbXBvbmVudDEuY29tcG9uZW50Lmh0bWwnLFxuICBzdHlsZVVybHM6IFsnLi9leHRlbmQtY29tcG9uZW50MS5jb21wb25lbnQuc2NzcyddXG59KVxuLyoqXG4gKiDpooTnlZnmianlsZXnu4Tku7YxXG4gKiDmraTnu4Tku7bnm67liY3ooqvnlKjkuo7kvZzkuLrop4TliJnpgInmi6nmianlsZXmqKHmnb/phY3nva7nlYzpnaJcbiAqL1xuZXhwb3J0IGNsYXNzIEV4dGVuZENvbXBvbmVudDFDb21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQge1xuICBAVmlld0NoaWxkKCdPYmpzR3JpZCcpIE9ianNHcmlkOiBEYXRhZ3JpZENvbXBvbmVudDtcbiAgQFZpZXdDaGlsZCgnRmllbGRzR3JpZCcpIEZpZWxkc0dyaWQ6IERhdGFncmlkQ29tcG9uZW50O1xuXG4gIEBWaWV3Q2hpbGQoJ3NlbGVjdEZvb3RlcicpIG1vZGFsRm9vdGVyOiBUZW1wbGF0ZVJlZjxhbnk+O1xuICBAT3V0cHV0KCkgY2xvc2VNb2RhbCA9IG5ldyBFdmVudEVtaXR0ZXI8YW55PigpO1xuICBAT3V0cHV0KCkgb2tNb2RhbCA9IG5ldyBFdmVudEVtaXR0ZXI8YW55PigpO1xuXG4gIGRhdGFJZVJ1bGVFeHRlbmRPcmlnaW5hbDogYW55O1xuICBkYXRhSWVSdWxlRXh0ZW5kOiBhbnk7XG4gIGV4dGVuZFJ1bGVJbmZvOiBhbnk7XG5cbiAgT2JqSW5mb0NvbHVtbnMgPSBbXTtcbiAgT2JqSW5mb0RhdGEgPSBbXTtcbiAgRmllbGRzQ29sdW1ucyA9IFtdO1xuICBGaWVsZHNEYXRhID0gW107XG5cbiAgaTE4blJlc291Y2U6IGFueTtcbiAgaWVfY2FuY2VsOiBzdHJpbmc7XG4gIGllX29rOiBzdHJpbmc7XG5cbiAgY29uc3RydWN0b3IoXG4gICAgcHJpdmF0ZSBodHRwOiBIdHRwQ2xpZW50LFxuICAgIHByaXZhdGUgbm90aWZ5OiBOb3RpZnlTZXJ2aWNlLFxuICApIHtcbiAgICBEYXRhSUVVdGlscy5nZXRUcmFuc2xhdGVWYWx1ZShodHRwKS5zdWJzY3JpYmUocmVzID0+IHtcbiAgICAgIHRoaXMuaTE4blJlc291Y2UgPSByZXM7XG4gICAgICB0aGlzLmllX2NhbmNlbCA9IHJlc1snaWVfY2FuY2VsJ107XG4gICAgICB0aGlzLmllX29rID0gcmVzWydpZV9vayddO1xuICAgIH0pO1xuICB9XG5cbiAgbmdPbkluaXQoKSB7XG4gICAgdGhpcy5PYmpJbmZvQ29sdW1ucyA9IFtcbiAgICAgIHtmaWVsZDogJ2ZpbGVPYmplY3ROYW1lJywgd2lkdGg6IDEwMCwgdGl0bGU6ICflr7nosaHlkI3np7AnLCBzb3J0YWJsZTogZmFsc2UsIHNob3dUaXBzOiB0cnVlfVxuICAgIF07XG4gICAgdGhpcy5kYXRhSWVSdWxlRXh0ZW5kID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeSh0aGlzLmRhdGFJZVJ1bGVFeHRlbmRPcmlnaW5hbCkpO1xuICAgIHRoaXMuZXh0ZW5kUnVsZUluZm8gPSBKU09OLnBhcnNlKHRoaXMuZGF0YUllUnVsZUV4dGVuZC5leHRlbmRSdWxlSW5mbyk7XG4gICAgdGhpcy5PYmpJbmZvRGF0YSA9IHRoaXMuZXh0ZW5kUnVsZUluZm8ub2JqSW5mb3M7XG4gICAgdGhpcy5GaWVsZHNDb2x1bW5zID0gW1xuICAgICAge2ZpZWxkOiAnZmlsZUVsZW1lbnROYW1lJywgd2lkdGg6IDEwMCwgdGl0bGU6ICfliJflkI0nLCBzb3J0YWJsZTogZmFsc2UsIHNob3dUaXBzOiB0cnVlLCBmaWx0ZXI6IHRydWV9XG4gICAgXTtcblxuICB9XG5cbiAgbmdBZnRlclZpZXdJbml0KCkge1xuICAgIC8vIHRoaXMub2JqU2VsZWN0Q2hhbmdlZCh7ZGF0YTp0aGlzLk9iakluZm9EYXRhWzBdfSk7XG4gICAgdGhpcy5PYmpzR3JpZC5zZWxlY3RSb3codGhpcy5PYmpJbmZvRGF0YVswXS5pZCk7XG4gIH1cblxuICBjYW5Ob3RDaGVja2VkUm93ID0gKHJvdywgaW5kZXgpID0+IHtcbiAgICByZXR1cm4gcm93LnJlcXVpcmU7XG4gIH07XG5cbiAgbW92ZVVwKGUpIHtcbiAgICBjb25zdCBzZWxlY3RlZFJvdyA9IHRoaXMuRmllbGRzR3JpZC5zZWxlY3RlZFJvdztcbiAgICBpZiAoIXNlbGVjdGVkUm93IHx8ICFzZWxlY3RlZFJvdy5kYXRhKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGNvbnN0IGlkID0gc2VsZWN0ZWRSb3cuZGF0YS5pZDtcbiAgICBjb25zdCBpZHggPSB0aGlzLkZpZWxkc0RhdGEuZmluZEluZGV4KGUgPT4gZS5pZCA9PT0gaWQpO1xuICAgIGlmIChpZHggPD0gMCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBjb25zdCB0ZW1wID0gdGhpcy5GaWVsZHNEYXRhLnNwbGljZShpZHgsIDEpO1xuICAgIHRoaXMuRmllbGRzRGF0YS5zcGxpY2UoaWR4IC0gMSwgMCwgLi4udGVtcCk7XG4gICAgdGhpcy5GaWVsZHNEYXRhID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeSh0aGlzLkZpZWxkc0RhdGEpKTtcbiAgICB0aGlzLkZpZWxkc0dyaWQuc2VsZWN0Um93KGlkKTtcbiAgfVxuXG4gIG1vdmVEb3duKGUpIHtcbiAgICBjb25zdCBzZWxlY3RlZFJvdyA9IHRoaXMuRmllbGRzR3JpZC5zZWxlY3RlZFJvdztcbiAgICBpZiAoIXNlbGVjdGVkUm93IHx8ICFzZWxlY3RlZFJvdy5kYXRhKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGNvbnN0IGlkID0gc2VsZWN0ZWRSb3cuZGF0YS5pZDtcbiAgICBjb25zdCBpZHggPSB0aGlzLkZpZWxkc0RhdGEuZmluZEluZGV4KGUgPT4gZS5pZCA9PT0gaWQpO1xuICAgIGlmIChpZHggPj0gdGhpcy5GaWVsZHNEYXRhLmxlbmd0aCAtIDEpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgY29uc3QgdGVtcCA9IHRoaXMuRmllbGRzRGF0YS5zcGxpY2UoaWR4LCAxKTtcbiAgICB0aGlzLkZpZWxkc0RhdGEuc3BsaWNlKGlkeCArIDEsIDAsIC4uLnRlbXApO1xuICAgIHRoaXMuRmllbGRzRGF0YSA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkodGhpcy5GaWVsZHNEYXRhKSk7XG4gICAgdGhpcy5GaWVsZHNHcmlkLnNlbGVjdFJvdyhpZCk7XG4gIH1cblxuICBvbkZpbHRlckNoYW5nZWQoZSkge1xuICAgIGlmICghZS5maWxlRWxlbWVudE5hbWUpIHtcbiAgICAgIGNvbnN0IHNlbGVjdGVkUm93ID0gdGhpcy5PYmpzR3JpZC5zZWxlY3RlZFJvdztcbiAgICAgIGlmICghc2VsZWN0ZWRSb3cgfHwgIXNlbGVjdGVkUm93LmRhdGEpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgdGhpcy5vYmpTZWxlY3RDaGFuZ2VkKHNlbGVjdGVkUm93KTtcbiAgICB9XG4gIH1cblxuICBvYmpTZWxlY3RDaGFuZ2VkKGUpIHtcbiAgICBjb25zdCByb3dEYXRhSWQgPSBlLmRhdGEuaWQ7XG4gICAgY29uc3QgaWR4ID0gdGhpcy5PYmpJbmZvRGF0YS5maW5kSW5kZXgoZSA9PiBlLmlkID09PSByb3dEYXRhSWQpO1xuICAgIGlmIChpZHggPj0gMCkge1xuICAgICAgdGhpcy5GaWVsZHNEYXRhID0gdGhpcy5PYmpJbmZvRGF0YVtpZHhdLmZpZWxkc0luZm87XG4gICAgICB0aGlzLkZpZWxkc0dyaWQubG9hZERhdGEodGhpcy5GaWVsZHNEYXRhKTtcbiAgICAgIC8vIHRoaXMuRmllbGRzR3JpZCA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoZmllbGRzRGF0YSkpO1xuICAgICAgdGhpcy5GaWVsZHNEYXRhLmZvckVhY2goZCA9PiB7XG4gICAgICAgIGlmIChkLmNoZWNrZWQpIHtcbiAgICAgICAgICB0aGlzLkZpZWxkc0dyaWQuY2hlY2tSb3coZC5pZCwgZmFsc2UpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIGNvbnN0IHNlbGVjdGVkUm93ID0gdGhpcy5GaWVsZHNHcmlkLnNlbGVjdGVkUm93O1xuICAgICAgaWYgKHNlbGVjdGVkUm93KSB7XG4gICAgICAgIHRoaXMuRmllbGRzR3JpZC5jbGVhclNlbGVjdGlvbnMoKTtcbiAgICAgIH1cblxuICAgIH1cbiAgfVxuXG4gIEVsZW1lbnRDaGVja2VkUm93KGUpIHtcbiAgICBjb25zdCByb3dEYXRhID0gZS5kYXRhO1xuICAgIGNvbnN0IGlkeCA9IHRoaXMuRmllbGRzRGF0YS5maW5kSW5kZXgoZSA9PiBlLmlkID09PSByb3dEYXRhLmlkKTtcbiAgICBpZiAoaWR4ID49IDApIHtcbiAgICAgIHRoaXMuRmllbGRzRGF0YVtpZHhdLmNoZWNrZWQgPSB0cnVlO1xuICAgIH1cbiAgfVxuXG4gIEVsZW1lbnRVbkNoZWNrZWRSb3coZSkge1xuICAgIGNvbnN0IHJvd0RhdGEgPSBlLmRhdGE7XG4gICAgY29uc3QgaWR4ID0gdGhpcy5GaWVsZHNEYXRhLmZpbmRJbmRleChlID0+IGUuaWQgPT09IHJvd0RhdGEuaWQpO1xuICAgIGlmIChpZHggPj0gMCkge1xuICAgICAgdGhpcy5GaWVsZHNEYXRhW2lkeF0uY2hlY2tlZCA9IGZhbHNlO1xuICAgIH1cbiAgfVxuXG4gIEVsZW1lbnRDaGVja2VkQWxsKGUpIHtcbiAgICB0aGlzLkZpZWxkc0RhdGEuZm9yRWFjaChkID0+IHtcbiAgICAgIGQuY2hlY2tlZCA9IHRydWU7XG4gICAgfSlcbiAgfVxuXG4gIEVsZW1lbnRVbkNoZWNrZWRBbGwoZSkge1xuICAgIGlmIChpc051bGxPckVtcHR5KGUpKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHRoaXMuRmllbGRzRGF0YS5mb3JFYWNoKGQgPT4ge1xuICAgICAgZC5jaGVja2VkID0gZmFsc2U7XG4gICAgfSlcbiAgfVxuXG4gIG9rSGFuZGxlcigpIHtcbiAgICBpZiAoaXNOdWxsT3JCbGFuayh0aGlzLmRhdGFJZVJ1bGVFeHRlbmQuY29kZSkpIHtcbiAgICAgIHRoaXMubm90aWZ5Lndhcm5pbmcoJ+aooeadv+e8luWPt+S4jeiDveS4uuepuicpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpZiAoaXNOdWxsT3JCbGFuayh0aGlzLmRhdGFJZVJ1bGVFeHRlbmQubmFtZSkpIHtcbiAgICAgIHRoaXMubm90aWZ5Lndhcm5pbmcoJ+aooeadv+WQjeensOS4jeiDveS4uuepuicpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHRoaXMuZXh0ZW5kUnVsZUluZm8ub2JqSW5mb3MgPSB0aGlzLk9iakluZm9EYXRhO1xuICAgIHRoaXMuZGF0YUllUnVsZUV4dGVuZC5leHRlbmRSdWxlSW5mbyA9IEpTT04uc3RyaW5naWZ5KHRoaXMuZXh0ZW5kUnVsZUluZm8pO1xuICAgIGNvbnN0IHVybCA9ICcvYXBpL3J1bnRpbWUvZGlwL3YxLjAvZGF0YUllUnVsZU1hbmFnZS9jaGVja1VwZGF0ZVJ1bGVFeHRlbmQnO1xuICAgIHRoaXMuaHR0cC5wb3N0KHVybCwgdGhpcy5kYXRhSWVSdWxlRXh0ZW5kKS5zdWJzY3JpYmUoKGU6IGFueSkgPT4ge1xuICAgICAgaWYgKGUuc3VjY2Vzcykge1xuICAgICAgICB0aGlzLm9rTW9kYWwuZW1pdCh0aGlzLmRhdGFJZVJ1bGVFeHRlbmQpO1xuICAgICAgfVxuICAgIH0sIGVycm9yID0+IHtcbiAgICAgIHRoaXMubm90aWZ5LmVycm9yKGVycm9yLmVycm9yLk1lc3NhZ2UpO1xuICAgICAgY29uc29sZS5sb2coZXJyb3IuZXJyb3IuTWVzc2FnZSk7XG4gICAgfSk7XG4gIH1cblxuICBjYW5jZWxIYW5kbGVyKCkge1xuICAgIHRoaXMuY2xvc2VNb2RhbC5lbWl0KCk7XG4gIH1cblxufVxuIl19