/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Injectable, ComponentFactoryResolver, Injector } from '@angular/core';
import { DataExportService } from './data-export.service';
import { NotifyService } from '@farris/ui-notify';
import { Subject } from 'rxjs';
import { MethodType } from '../../model/DataIEType/MethodType';
import { BsModalService } from '@farris/ui-modal';
import { DataIEUtils, isNullOrEmpty, isNullOrUndefined } from '../Utils/DataIEUtils';
import { HttpClient } from '@angular/common/http';
import { CustomDataIEService } from './custom-data-ie.service';
import { ImportDialogHandcraftComponent } from '../../import-dialog-handcraft/import-dialog-handcraft.component';
import { LoadingService } from "@farris/ui-loading";
import { ExportCustomSelectHandcraftComponent } from "../../export-custom-select-handcraft/export-custom-select-handcraft.component";
import * as i0 from "@angular/core";
import * as i1 from "@farris/ui-modal";
import * as i2 from "./data-export.service";
import * as i3 from "@farris/ui-notify";
import * as i4 from "./custom-data-ie.service";
import * as i5 from "@angular/common/http";
import * as i6 from "@farris/ui-loading";
export class DataieHandcraftService {
    /**
     * @param {?} resolver
     * @param {?} modalService
     * @param {?} injector
     * @param {?} dataExportService
     * @param {?} notify
     * @param {?} customIEService
     * @param {?} http
     * @param {?} loadingService
     */
    constructor(resolver, modalService, injector, dataExportService, notify, customIEService, http, loadingService) {
        this.resolver = resolver;
        this.modalService = modalService;
        this.injector = injector;
        this.dataExportService = dataExportService;
        this.notify = notify;
        this.customIEService = customIEService;
        this.http = http;
        this.loadingService = loadingService;
        DataIEUtils.getTranslateValue(http).subscribe((/**
         * @param {?} res
         * @return {?}
         */
        res => {
            this.data_import = res['data_import'];
            this.data_export = res['data_export'];
            this.export_success = res['export_success'];
            this.export_fail = res['export_fail'];
            this.data_export_customfile = res['data_export_customfile'];
            this.i18nResource = res;
        }));
    }
    /**
     * 通用导出方法
     * @param {?} type
     * @param {?} ruleID
     * @param {?} option
     * @return {?}
     */
    CommonDataExport(type, ruleID, option) {
        if (type === 1) {
            console.log('执行方法：ExportCurrentListData');
            throw new Error('不支持配置该类型:1');
        }
        else if (type === 2) {
            console.log('执行方法：ExportByModel');
            throw new Error('不支持配置该类型:2');
        }
        else if (type === 3) {
            console.log('执行方法：ExportCurrentChildData');
            // return this.ExportCurrentChildData(ruleID, option);
            throw new Error('不支持配置该类型:3');
        }
        else if (type === 0) {
            console.log('执行方法：ExportByRule');
            return this.ExportByRule(ruleID, option);
        }
        else {
            console.log('执行方法：ExportByRule');
            return this.ExportByRule(ruleID, option);
        }
    }
    /**
     * @param {?} ruleID
     * @param {?} option
     * @return {?}
     */
    ExportByRule(ruleID, option) {
        /** @type {?} */
        const subject = new Subject();
        this.ExportCommonEntry(ruleID, option, MethodType.CommonExport).subscribe((/**
         * @param {?} s
         * @return {?}
         */
        s => {
            subject.next(s);
            subject.complete();
        }));
        return subject;
    }
    /**
     * @param {?} ruleID
     * @param {?} option
     * @return {?}
     */
    ExportCurrentChildData(ruleID, option) {
        /** @type {?} */
        const subject = new Subject();
        this.ExportCommonEntry(ruleID, option, MethodType.ExportCurrentChildData).subscribe((/**
         * @param {?} s
         * @return {?}
         */
        s => {
            subject.next(s);
            subject.complete();
        }));
        return subject;
    }
    /**
     * @private
     * @param {?} ruleID
     * @param {?} option
     * @param {?} methodType
     * @return {?}
     */
    ExportCommonEntry(ruleID, option, methodType) {
        /** @type {?} */
        const subject = new Subject();
        /** @type {?} */
        const optionJson = this.ParseExportJson(option);
        console.log(optionJson);
        if (isNullOrEmpty(ruleID) && isNullOrEmpty(optionJson.voId)) {
            this.notify.warning("未配置规则id，且无法获取到表单对应的voId，请检查");
            /** @type {?} */
            const res = {
                type: 'close',
                data: null,
                other: null
            };
            subject.next(res);
            return subject;
        }
        if (methodType === MethodType.ExportCurrentChildData) {
            if (isNullOrEmpty(ruleID) && isNullOrEmpty(optionJson.exportChildNodeCode)) {
                //导出子表当规则id为空时，根据vo找规则，必须要求有配置子表节点
                this.notify.warning("规则id为空时，根据Vo查找规则，导出子表必须配置子表节点");
                /** @type {?} */
                const res = {
                    type: 'close',
                    data: null,
                    other: null
                };
                subject.next(res);
                return subject;
            }
        }
        if (isNullOrEmpty(ruleID) || optionJson.enableRuntimeCustom === true) {
            this.StartLoading();
            /** @type {?} */
            const url = '/api/runtime/dip/v1.0/dataIeRuleManage/getRecordRuleInfo';
            /** @type {?} */
            const postBody = {
                body: {
                    ruleId: ruleID,
                    ruleType: 1,
                    voId: optionJson.voId,
                    needModelConvert: optionJson.needModelConvert === true,
                    methodType: methodType,
                    exportChildNodeCode: optionJson.exportChildNodeCode,
                    enableRuntimeCustom: optionJson.enableRuntimeCustom === true
                }
            };
            this.http.post(url, postBody.body).subscribe((/**
             * @param {?} recordRule
             * @return {?}
             */
            (recordRule) => {
                this.CloseLoading();
                optionJson.voId = recordRule.voId;
                this.ExportByRuleImpl(ruleID, optionJson, methodType, recordRule).subscribe((/**
                 * @param {?} s
                 * @return {?}
                 */
                s => {
                    subject.next(s);
                    subject.complete();
                }));
            }), (/**
             * @param {?} error
             * @return {?}
             */
            error => {
                this.CloseLoading();
                this.notify.error(error.error.Message);
                console.log(error.error.Message);
                /** @type {?} */
                const res = {
                    type: 'close',
                    data: null,
                    other: error.error.Message
                };
                subject.next(res);
            }));
        }
        else {
            this.ExportByRuleImpl(ruleID, optionJson, methodType).subscribe((/**
             * @param {?} s
             * @return {?}
             */
            s => {
                subject.next(s);
                subject.complete();
            }));
        }
        return subject;
    }
    /**
     * @private
     * @param {?} ruleID
     * @param {?} optionJson
     * @param {?} mType
     * @param {?=} recordRule
     * @return {?}
     */
    ExportByRuleImpl(ruleID, optionJson, mType, recordRule) {
        /** @type {?} */
        const subject = new Subject();
        if (optionJson.customExportTitle !== undefined && optionJson.customExportTitle !== null) {
            if (optionJson.customExportTitle.length > 20) {
                this.notify.warning('自定义标题名称的长度太长');
                /** @type {?} */
                const res = {
                    type: 'close',
                    data: null,
                    other: null
                };
                subject.next(res);
                return subject;
            }
            if (DataIEUtils.JudgeIllegalChar(optionJson.customExportTitle)) {
                this.notify.warning('自定义标题名称存在不合法字符');
                /** @type {?} */
                const res = {
                    type: 'close',
                    data: null,
                    other: null
                };
                subject.next(res);
                return subject;
            }
        }
        if (optionJson.enableRuntimeCustom === true || optionJson.selectfiletype === true) {
            /** @type {?} */
            const compFactory = this.resolver.resolveComponentFactory(ExportCustomSelectHandcraftComponent);
            /** @type {?} */
            const cmpRef = compFactory.create(this.injector);
            cmpRef.instance.ruleId = ruleID;
            cmpRef.instance.exportOption = optionJson;
            cmpRef.instance.recordRule = recordRule;
            cmpRef.instance.subject = subject;
            cmpRef.instance.methodType = MethodType.CommonExport;
            /** @type {?} */
            let title = this.data_export;
            if (optionJson.customExportTitle !== undefined && optionJson.customExportTitle !== null) {
                title = optionJson.customExportTitle;
            }
            /** @type {?} */
            const exportModalConfig = {
                title: title,
                width: 530,
                height: 342,
                buttons: cmpRef.instance.modalFooter,
                showCloseButton: true,
                showMaxButton: false,
                showMinButton: false,
                showButtons: true,
                resizable: false
            };
            /** @type {?} */
            const dialog = this.modalService.show(cmpRef, exportModalConfig);
            dialog.dialog.instance.closed.subscribe((/**
             * @return {?}
             */
            () => {
                /** @type {?} */
                const res = {
                    type: 'close',
                    data: null,
                    other: null
                };
                subject.next(res);
            }));
            cmpRef.instance.needDestroy.subscribe((/**
             * @param {?} $event
             * @return {?}
             */
            $event => {
                dialog.close();
            }));
        }
        else {
            if (!isNullOrUndefined(recordRule) && !isNullOrEmpty(recordRule.ruleId)) {
                ruleID = recordRule.ruleId;
            }
            if (mType == MethodType.CommonExport) {
                this.dataExportService.ExportById4HandCraft(ruleID, optionJson);
            }
            else if (mType == MethodType.ExportCurrentTableData) {
                throw new Error('不支持该类型:ExportCurrentTableData');
            }
            else {
                throw new Error('不支持该类型:ExportCurrentChildData');
            }
            /** @type {?} */
            const unscriber = this.dataExportService.export.subscribe((/**
             * @param {?} data
             * @return {?}
             */
            data => {
                if (data === '') {
                    /** @type {?} */
                    const res = {
                        type: 'success',
                        data: null,
                        other: null
                    };
                    subject.next(res);
                    subject.complete();
                }
                else {
                    /** @type {?} */
                    const errorlevel = this.dataExportService.errorlevel;
                    if (errorlevel === 'Info') {
                        this.notify.info(data);
                    }
                    else if (errorlevel === 'Warning') {
                        this.notify.warning(data);
                    }
                    else {
                        this.notify.error(this.export_fail + data);
                    }
                    /** @type {?} */
                    const res = {
                        type: 'fail',
                        data: null,
                        other: data
                    };
                    subject.next(res);
                    subject.complete();
                }
                unscriber.unsubscribe();
            }), (/**
             * @param {?} error
             * @return {?}
             */
            error => {
                this.notify.error(error.error.Message);
                /** @type {?} */
                const res = {
                    type: 'fail',
                    data: null,
                    other: error.error.Message
                };
                subject.next(res);
                subject.complete();
            }));
        }
        return subject;
    }
    /**
     * 通用导入方法
     * @param {?} type
     * @param {?} ruleID
     * @param {?} option
     * @return {?}
     */
    CommonDataImport(type, ruleID, option) {
        if (type === 1) {
            console.log('执行方法：ImportSublistData');
            return this.ImportSublistData(ruleID, option);
        }
        else if (type === 2) {
            console.log('执行方法：ImportByModel');
            throw new Error('不支持配置该类型:2');
        }
        else if (type === 0) {
            console.log('执行方法：ImportByRule');
            return this.ImportByRule(ruleID, option);
        }
        else {
            console.log('执行方法：ImportByRule');
            return this.ImportByRule(ruleID, option);
        }
    }
    // 普通导入
    /**
     * @param {?} ruleID
     * @param {?} option
     * @return {?}
     */
    ImportByRule(ruleID, option) {
        /** @type {?} */
        const subject = new Subject();
        this.ImportCommonEntry(ruleID, option, MethodType.CommonImport).subscribe((/**
         * @param {?} s
         * @return {?}
         */
        s => {
            subject.next(s);
            subject.complete();
        }));
        return subject;
    }
    // 子表导入
    /**
     * @param {?} ruleID
     * @param {?} option
     * @return {?}
     */
    ImportSublistData(ruleID, option) {
        /** @type {?} */
        const subject = new Subject();
        this.ImportCommonEntry(ruleID, option, MethodType.ImportSubTableDetail).subscribe((/**
         * @param {?} s
         * @return {?}
         */
        s => {
            subject.next(s);
            subject.complete();
        }));
        return subject;
    }
    /**
     * @private
     * @param {?} ruleID
     * @param {?} option
     * @param {?} methodType
     * @return {?}
     */
    ImportCommonEntry(ruleID, option, methodType) {
        console.log(option);
        /** @type {?} */
        const subject = new Subject();
        /** @type {?} */
        const optionJson = this.ParseImportJson(option);
        /** @type {?} */
        const su = optionJson.su;
        if (methodType === MethodType.ImportSubTableDetail) {
            if (isNullOrEmpty(ruleID) && isNullOrEmpty(optionJson.importChildNodeCode)) {
                //导入子表当规则id为空时，根据vo找规则，必须要求有配置子表节点
                this.notify.warning("规则id为空时，根据模型查找规则，导入子表必须配置子表节点");
                /** @type {?} */
                const res = {
                    type: 'close',
                    data: null,
                    other: null
                };
                subject.next(res);
                return subject;
            }
        }
        this.StartLoading();
        /** @type {?} */
        const url = '/api/runtime/dip/v1.0/dataIeRuleManage/getRecordRuleInfo';
        /** @type {?} */
        const postBody = {
            body: {
                ruleId: ruleID,
                su: su,
                ruleType: 0,
                voId: optionJson.voId,
                needModelConvert: optionJson.needModelConvert === true,
                methodType: methodType,
                importChildNodeCode: optionJson.importChildNodeCode,
                enableRuntimeCustom: optionJson.enableRuntimeCustom === true
            }
        };
        this.http.post(url, postBody.body).subscribe((/**
         * @param {?} recordRule
         * @return {?}
         */
        (recordRule) => {
            this.CloseLoading();
            optionJson.voId = recordRule.voId;
            this.ImportByRuleImpl(ruleID, optionJson, methodType, recordRule).subscribe((/**
             * @param {?} s
             * @return {?}
             */
            s => {
                subject.next(s);
                subject.complete();
            }));
        }), (/**
         * @param {?} error
         * @return {?}
         */
        error => {
            this.CloseLoading();
            this.notify.error(error.error.Message);
            console.log(error.error.Message);
            /** @type {?} */
            const res = {
                type: 'close',
                data: null,
                other: error.error.Message
            };
            subject.next(res);
        }));
        return subject;
    }
    /**
     * @private
     * @param {?} ruleID
     * @param {?} optionJson
     * @param {?} methodType
     * @param {?=} recordRule
     * @return {?}
     */
    ImportByRuleImpl(ruleID, optionJson, methodType, recordRule) {
        /** @type {?} */
        const subject = new Subject();
        if (optionJson.customImportTitle !== undefined && optionJson.customImportTitle !== null) {
            if (optionJson.customImportTitle.length > 20) {
                this.notify.warning('自定义标题名称的长度太长');
                /** @type {?} */
                const res = {
                    type: 'close',
                    data: null,
                    other: null
                };
                subject.next(res);
                return subject;
            }
            if (DataIEUtils.JudgeIllegalChar(optionJson.customImportTitle)) {
                this.notify.warning('自定义标题名称存在不合法字符');
                /** @type {?} */
                const res = {
                    type: 'close',
                    data: null,
                    other: null
                };
                subject.next(res);
                return subject;
            }
        }
        /** @type {?} */
        const compFactory = this.resolver.resolveComponentFactory(ImportDialogHandcraftComponent);
        /** @type {?} */
        const cmpRef = compFactory.create(this.injector);
        cmpRef.instance.ruleId = ruleID;
        cmpRef.instance.recordRule = recordRule;
        cmpRef.instance.importOption = optionJson;
        if (methodType == MethodType.CommonImport) {
            cmpRef.instance.methodType = MethodType.CommonImport;
        }
        else {
            cmpRef.instance.methodType = MethodType.ImportSubTableDetail;
        }
        cmpRef.instance.subject = subject;
        /** @type {?} */
        let title = this.data_import;
        if (!isNullOrUndefined(optionJson.customImportTitle)) {
            title = optionJson.customImportTitle;
        }
        /** @type {?} */
        const importModalConfig = {
            title: title,
            width: 530,
            height: 342,
            buttons: cmpRef.instance.modalFooter,
            showCloseButton: true,
            showMaxButton: false,
            showMinButton: false,
            showButtons: true,
            resizable: false
        };
        /** @type {?} */
        const dialog = this.modalService.show(cmpRef, importModalConfig);
        dialog.dialog.instance.closed.subscribe((/**
         * @return {?}
         */
        () => {
            /** @type {?} */
            const res = {
                type: 'close',
                data: null,
                other: null
            };
            subject.next(res);
        }));
        cmpRef.instance.needDestroy.subscribe((/**
         * @param {?} data
         * @return {?}
         */
        data => {
            dialog.close();
            /** @type {?} */
            const importResult = (/** @type {?} */ (data));
            if (!isNullOrUndefined(importResult)) {
                /** @type {?} */
                let res;
                if (importResult.succeed) {
                    res = {
                        type: 'success',
                        data: importResult,
                        other: null
                    };
                }
                else {
                    res = {
                        type: 'fail',
                        data: importResult,
                        other: null
                    };
                }
                subject.next(res);
                subject.complete();
            }
        }));
        return subject;
    }
    /**
     * @private
     * @param {?} option
     * @return {?}
     */
    ParseExportJson(option) {
        if (typeof (option) === 'object') {
            return option;
        }
        if (isNullOrUndefined(option) || isNullOrEmpty(option)) {
            return {};
        }
        /** @type {?} */
        let optionJson = null;
        try {
            optionJson = JSON.parse(option);
        }
        catch (_a) {
            this.notify.warning('传入的参数转换JSON对象异常，已使用默认参数');
            return {};
        }
        if (typeof (optionJson) !== 'object') {
            optionJson = {};
        }
        return optionJson;
    }
    /**
     * @private
     * @param {?} option
     * @return {?}
     */
    ParseImportJson(option) {
        if (typeof (option) === 'object') {
            return option;
        }
        if (isNullOrUndefined(option) || isNullOrEmpty(option)) {
            return {};
        }
        /** @type {?} */
        let optionJson = null;
        try {
            optionJson = JSON.parse(option);
        }
        catch (_a) {
            this.notify.warning('传入的参数转换JSON对象异常，已使用默认参数');
            return {};
        }
        if (typeof (optionJson) !== 'object') {
            optionJson = {};
        }
        /** @type {?} */
        let globalParam = optionJson['globalParam'];
        if (globalParam !== undefined && globalParam !== null) {
            optionJson['GlobalParam'] = globalParam;
        }
        return optionJson;
    }
    /**
     * @return {?}
     */
    StartLoading() {
        if (this.loadingService !== undefined && this.loadingService !== null) {
            this.loadingService.show();
        }
    }
    /**
     * @return {?}
     */
    CloseLoading() {
        if (this.loadingService !== undefined && this.loadingService !== null) {
            this.loadingService.clearAll();
        }
    }
}
DataieHandcraftService.decorators = [
    { type: Injectable, args: [{
                providedIn: 'root'
            },] }
];
/** @nocollapse */
DataieHandcraftService.ctorParameters = () => [
    { type: ComponentFactoryResolver },
    { type: BsModalService },
    { type: Injector },
    { type: DataExportService },
    { type: NotifyService },
    { type: CustomDataIEService },
    { type: HttpClient },
    { type: LoadingService }
];
/** @nocollapse */ DataieHandcraftService.ngInjectableDef = i0.defineInjectable({ factory: function DataieHandcraftService_Factory() { return new DataieHandcraftService(i0.inject(i0.ComponentFactoryResolver), i0.inject(i1.BsModalService), i0.inject(i0.INJECTOR), i0.inject(i2.DataExportService), i0.inject(i3.NotifyService), i0.inject(i4.CustomDataIEService), i0.inject(i5.HttpClient), i0.inject(i6.LoadingService)); }, token: DataieHandcraftService, providedIn: "root" });
if (false) {
    /** @type {?} */
    DataieHandcraftService.prototype.data_import;
    /** @type {?} */
    DataieHandcraftService.prototype.data_export;
    /** @type {?} */
    DataieHandcraftService.prototype.data_export_customfile;
    /** @type {?} */
    DataieHandcraftService.prototype.export_success;
    /** @type {?} */
    DataieHandcraftService.prototype.export_fail;
    /** @type {?} */
    DataieHandcraftService.prototype.i18nResource;
    /**
     * @type {?}
     * @private
     */
    DataieHandcraftService.prototype.resolver;
    /**
     * @type {?}
     * @private
     */
    DataieHandcraftService.prototype.modalService;
    /**
     * @type {?}
     * @private
     */
    DataieHandcraftService.prototype.injector;
    /**
     * @type {?}
     * @private
     */
    DataieHandcraftService.prototype.dataExportService;
    /**
     * @type {?}
     * @private
     */
    DataieHandcraftService.prototype.notify;
    /**
     * @type {?}
     * @private
     */
    DataieHandcraftService.prototype.customIEService;
    /**
     * @type {?}
     * @private
     */
    DataieHandcraftService.prototype.http;
    /**
     * @type {?}
     * @private
     */
    DataieHandcraftService.prototype.loadingService;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGF0YWllLWhhbmRjcmFmdC5zZXJ2aWNlLmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGdzcC1kaXAvZGF0YS1pbXAtZXhwLyIsInNvdXJjZXMiOlsibGliL3NlcnZpY2UvRGF0YUlFU2VydmljZS9kYXRhaWUtaGFuZGNyYWZ0LnNlcnZpY2UudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUFBLE9BQU8sRUFBRSxVQUFVLEVBQUUsd0JBQXdCLEVBQUUsUUFBUSxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBRS9FLE9BQU8sRUFBRSxpQkFBaUIsRUFBRSxNQUFNLHVCQUF1QixDQUFDO0FBQzFELE9BQU8sRUFBRSxhQUFhLEVBQUUsTUFBTSxtQkFBbUIsQ0FBQztBQUNsRCxPQUFPLEVBQUUsT0FBTyxFQUFrQixNQUFNLE1BQU0sQ0FBQztBQUUvQyxPQUFPLEVBQUUsVUFBVSxFQUFFLE1BQU0sbUNBQW1DLENBQUM7QUFDL0QsT0FBTyxFQUFFLGNBQWMsRUFBRSxNQUFNLGtCQUFrQixDQUFDO0FBSWxELE9BQU8sRUFBQyxXQUFXLEVBQUUsYUFBYSxFQUFFLGlCQUFpQixFQUFDLE1BQU0sc0JBQXNCLENBQUM7QUFDbkYsT0FBTyxFQUFFLFVBQVUsRUFBRSxNQUFNLHNCQUFzQixDQUFDO0FBR2xELE9BQU8sRUFBRSxtQkFBbUIsRUFBRSxNQUFNLDBCQUEwQixDQUFDO0FBRy9ELE9BQU8sRUFBRSw4QkFBOEIsRUFBRSxNQUFNLGlFQUFpRSxDQUFDO0FBQ2pILE9BQU8sRUFBQyxjQUFjLEVBQUMsTUFBTSxvQkFBb0IsQ0FBQztBQUNsRCxPQUFPLEVBQUMsb0NBQW9DLEVBQUMsTUFBTSwrRUFBK0UsQ0FBQzs7Ozs7Ozs7QUFLbkksTUFBTSxPQUFPLHNCQUFzQjs7Ozs7Ozs7Ozs7SUFRakMsWUFDVSxRQUFrQyxFQUNsQyxZQUE0QixFQUM1QixRQUFrQixFQUNsQixpQkFBb0MsRUFDcEMsTUFBcUIsRUFDckIsZUFBb0MsRUFDcEMsSUFBZ0IsRUFDaEIsY0FBOEI7UUFQOUIs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cG9ydCB7IEluamVjdGFibGUsIENvbXBvbmVudEZhY3RvcnlSZXNvbHZlciwgSW5qZWN0b3IgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IEV4cG9ydERpYWxvZ0NvbXBvbmVudCB9IGZyb20gJy4uLy4uL2N1c3RvbS1leHBvcnQtZGlhbG9nL2V4cG9ydC1kaWFsb2cuY29tcG9uZW50JztcbmltcG9ydCB7IERhdGFFeHBvcnRTZXJ2aWNlIH0gZnJvbSAnLi9kYXRhLWV4cG9ydC5zZXJ2aWNlJztcbmltcG9ydCB7IE5vdGlmeVNlcnZpY2UgfSBmcm9tICdAZmFycmlzL3VpLW5vdGlmeSc7XG5pbXBvcnQgeyBTdWJqZWN0LCBPYnNlcnZhYmxlLCBvZiB9IGZyb20gJ3J4anMnO1xuaW1wb3J0IHsgSW1wb3J0RGlhbG9nQ29tcG9uZW50IH0gZnJvbSAnLi4vLi4vaW1wb3J0LWRpYWxvZy9pbXBvcnQtZGlhbG9nLmNvbXBvbmVudCc7XG5pbXBvcnQgeyBNZXRob2RUeXBlIH0gZnJvbSAnLi4vLi4vbW9kZWwvRGF0YUlFVHlwZS9NZXRob2RUeXBlJztcbmltcG9ydCB7IEJzTW9kYWxTZXJ2aWNlIH0gZnJvbSAnQGZhcnJpcy91aS1tb2RhbCc7XG5pbXBvcnQgeyBEYXRhSUVSZXN1bHQgfSBmcm9tICcuLi9FbnRpdHkvRGF0YUlFUmVzdWx0JztcbmltcG9ydCB7IEV4cG9ydEN1c3RvbVNlbGVjdENvbXBvbmVudCB9IGZyb20gJy4uLy4uL2V4cG9ydC1jdXN0b20tc2VsZWN0L2V4cG9ydC1jdXN0b20tc2VsZWN0LmNvbXBvbmVudCc7XG5pbXBvcnQgeyBFeHBvcnRNZXRob2RUeXBlIH0gZnJvbSAnLi4vLi4vbW9kZWwvRGF0YUlFVHlwZS9FeHBvcnRNZXRob2RUeXBlJztcbmltcG9ydCB7RGF0YUlFVXRpbHMsIGlzTnVsbE9yRW1wdHksIGlzTnVsbE9yVW5kZWZpbmVkfSBmcm9tICcuLi9VdGlscy9EYXRhSUVVdGlscyc7XG5pbXBvcnQgeyBIdHRwQ2xpZW50IH0gZnJvbSAnQGFuZ3VsYXIvY29tbW9uL2h0dHAnO1xuaW1wb3J0IHsgRnJhbWVDb250ZXh0IH0gZnJvbSAnQGZhcnJpcy9kZXZraXQnO1xuaW1wb3J0IHsgRW50aXR5TGlzdFNlcnZpY2UgfSBmcm9tICdAZmFycmlzL2NvbW1hbmQtc2VydmljZXMnO1xuaW1wb3J0IHsgQ3VzdG9tRGF0YUlFU2VydmljZSB9IGZyb20gJy4vY3VzdG9tLWRhdGEtaWUuc2VydmljZSc7XG5pbXBvcnQgeyBDdXN0b21JbXBvcnREaWFsb2dDb21wb25lbnQgfSBmcm9tICcuLi8uLi9jdXN0b20taW1wb3J0LWRpYWxvZy9jdXN0b20taW1wb3J0LWRpYWxvZy5jb21wb25lbnQnO1xuaW1wb3J0IHsgUGFnZUluZm8gfSBmcm9tICcuLi9FbnRpdHkvUGFnZUluZm8nO1xuaW1wb3J0IHsgSW1wb3J0RGlhbG9nSGFuZGNyYWZ0Q29tcG9uZW50IH0gZnJvbSAnLi4vLi4vaW1wb3J0LWRpYWxvZy1oYW5kY3JhZnQvaW1wb3J0LWRpYWxvZy1oYW5kY3JhZnQuY29tcG9uZW50JztcbmltcG9ydCB7TG9hZGluZ1NlcnZpY2V9IGZyb20gXCJAZmFycmlzL3VpLWxvYWRpbmdcIjtcbmltcG9ydCB7RXhwb3J0Q3VzdG9tU2VsZWN0SGFuZGNyYWZ0Q29tcG9uZW50fSBmcm9tIFwiLi4vLi4vZXhwb3J0LWN1c3RvbS1zZWxlY3QtaGFuZGNyYWZ0L2V4cG9ydC1jdXN0b20tc2VsZWN0LWhhbmRjcmFmdC5jb21wb25lbnRcIjtcblxuQEluamVjdGFibGUoe1xuICBwcm92aWRlZEluOiAncm9vdCdcbn0pXG5leHBvcnQgY2xhc3MgRGF0YWllSGFuZGNyYWZ0U2VydmljZSB7XG5cbiAgZGF0YV9pbXBvcnQ6IHN0cmluZztcbiAgZGF0YV9leHBvcnQ6IHN0cmluZztcbiAgZGF0YV9leHBvcnRfY3VzdG9tZmlsZTogc3RyaW5nO1xuICBleHBvcnRfc3VjY2Vzczogc3RyaW5nO1xuICBleHBvcnRfZmFpbDogc3RyaW5nO1xuICBpMThuUmVzb3VyY2U6IGFueTtcbiAgY29uc3RydWN0b3IoXG4gICAgcHJpdmF0ZSByZXNvbHZlcjogQ29tcG9uZW50RmFjdG9yeVJlc29sdmVyLFxuICAgIHByaXZhdGUgbW9kYWxTZXJ2aWNlOiBCc01vZGFsU2VydmljZSxcbiAgICBwcml2YXRlIGluamVjdG9yOiBJbmplY3RvcixcbiAgICBwcml2YXRlIGRhdGFFeHBvcnRTZXJ2aWNlOiBEYXRhRXhwb3J0U2VydmljZSxcbiAgICBwcml2YXRlIG5vdGlmeTogTm90aWZ5U2VydmljZSxcbiAgICBwcml2YXRlIGN1c3RvbUlFU2VydmljZTogQ3VzdG9tRGF0YUlFU2VydmljZSxcbiAgICBwcml2YXRlIGh0dHA6IEh0dHBDbGllbnQsXG4gICAgcHJpdmF0ZSBsb2FkaW5nU2VydmljZTogTG9hZGluZ1NlcnZpY2VcbiAgKSB7XG4gICAgRGF0YUlFVXRpbHMuZ2V0VHJhbnNsYXRlVmFsdWUoaHR0cCkuc3Vic2NyaWJlKHJlcyA9PiB7XG4gICAgICB0aGlzLmRhdGFfaW1wb3J0ID0gcmVzWydkYXRhX2ltcG9ydCddO1xuICAgICAgdGhpcy5kYXRhX2V4cG9ydCA9IHJlc1snZGF0YV9leHBvcnQnXTtcbiAgICAgIHRoaXMuZXhwb3J0X3N1Y2Nlc3MgPSByZXNbJ2V4cG9ydF9zdWNjZXNzJ107XG4gICAgICB0aGlzLmV4cG9ydF9mYWlsID0gcmVzWydleHBvcnRfZmFpbCddO1xuICAgICAgdGhpcy5kYXRhX2V4cG9ydF9jdXN0b21maWxlID0gcmVzWydkYXRhX2V4cG9ydF9jdXN0b21maWxlJ107XG4gICAgICB0aGlzLmkxOG5SZXNvdXJjZSA9IHJlcztcbiAgICB9KVxuICB9XG5cbiAgLyoqXG4gICAqIOmAmueUqOWvvOWHuuaWueazlVxuICAgKiBAcGFyYW0gdHlwZVxuICAgKiBAcGFyYW0gcnVsZUlEXG4gICAqIEBwYXJhbSBvcHRpb25cbiAgICovXG4gIHB1YmxpYyBDb21tb25EYXRhRXhwb3J0KHR5cGU6IGFueSwgcnVsZUlEOiBzdHJpbmcsIG9wdGlvbjogc3RyaW5nKTogT2JzZXJ2YWJsZTxhbnk+IHtcbiAgICBpZiAodHlwZSA9PT0gMSkge1xuICAgICAgY29uc29sZS5sb2coJ+aJp+ihjOaWueazle+8mkV4cG9ydEN1cnJlbnRMaXN0RGF0YScpO1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCfkuI3mlK/mjIHphY3nva7or6Xnsbvlnos6MScpO1xuICAgIH0gZWxzZSBpZiAodHlwZSA9PT0gMikge1xuICAgICAgY29uc29sZS5sb2coJ+aJp+ihjOaWueazle+8mkV4cG9ydEJ5TW9kZWwnKTtcbiAgICAgIHRocm93IG5ldyBFcnJvcign5LiN5pSv5oyB6YWN572u6K+l57G75Z6LOjInKTtcbiAgICB9IGVsc2UgaWYgKHR5cGUgPT09IDMpIHtcbiAgICAgIGNvbnNvbGUubG9nKCfmiafooYzmlrnms5XvvJpFeHBvcnRDdXJyZW50Q2hpbGREYXRhJyk7XG4gICAgICAvLyByZXR1cm4gdGhpcy5FeHBvcnRDdXJyZW50Q2hpbGREYXRhKHJ1bGVJRCwgb3B0aW9uKTtcbiAgICAgIHRocm93IG5ldyBFcnJvcign5LiN5pSv5oyB6YWN572u6K+l57G75Z6LOjMnKTtcbiAgICB9IGVsc2UgaWYgKHR5cGUgPT09IDApIHtcbiAgICAgIGNvbnNvbGUubG9nKCfmiafooYzmlrnms5XvvJpFeHBvcnRCeVJ1bGUnKTtcbiAgICAgIHJldHVybiB0aGlzLkV4cG9ydEJ5UnVsZShydWxlSUQsIG9wdGlvbik7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnNvbGUubG9nKCfmiafooYzmlrnms5XvvJpFeHBvcnRCeVJ1bGUnKTtcbiAgICAgIHJldHVybiB0aGlzLkV4cG9ydEJ5UnVsZShydWxlSUQsIG9wdGlvbik7XG4gICAgfVxuICB9XG5cbiAgcHVibGljIEV4cG9ydEJ5UnVsZShydWxlSUQ6IHN0cmluZywgb3B0aW9uOiBhbnkpIHtcbiAgICBjb25zdCBzdWJqZWN0ID0gbmV3IFN1YmplY3Q8YW55PigpO1xuICAgIHRoaXMuRXhwb3J0Q29tbW9uRW50cnkocnVsZUlELCBvcHRpb24sIE1ldGhvZFR5cGUuQ29tbW9uRXhwb3J0KS5zdWJzY3JpYmUocyA9PiB7XG4gICAgICBzdWJqZWN0Lm5leHQocyk7XG4gICAgICBzdWJqZWN0LmNvbXBsZXRlKCk7XG4gICAgfSk7XG4gICAgcmV0dXJuIHN1YmplY3Q7XG4gIH1cbiAgcHVibGljIEV4cG9ydEN1cnJlbnRDaGlsZERhdGEocnVsZUlEOiBzdHJpbmcsIG9wdGlvbjogc3RyaW5nKTogT2JzZXJ2YWJsZTxhbnk+IHtcbiAgICBjb25zdCBzdWJqZWN0ID0gbmV3IFN1YmplY3Q8YW55PigpO1xuICAgIHRoaXMuRXhwb3J0Q29tbW9uRW50cnkocnVsZUlELCBvcHRpb24sIE1ldGhvZFR5cGUuRXhwb3J0Q3VycmVudENoaWxkRGF0YSkuc3Vic2NyaWJlKHMgPT4ge1xuICAgICAgc3ViamVjdC5uZXh0KHMpO1xuICAgICAgc3ViamVjdC5jb21wbGV0ZSgpO1xuICAgIH0pO1xuICAgIHJldHVybiBzdWJqZWN0O1xuICB9XG4gIHByaXZhdGUgRXhwb3J0Q29tbW9uRW50cnkocnVsZUlEOiBzdHJpbmcsIG9wdGlvbjogc3RyaW5nLCBtZXRob2RUeXBlOiBNZXRob2RUeXBlKTogT2JzZXJ2YWJsZTxhbnk+IHtcbiAgICBjb25zdCBzdWJqZWN0ID0gbmV3IFN1YmplY3Q8YW55PigpO1xuICAgIGNvbnN0IG9wdGlvbkpzb24gPSB0aGlzLlBhcnNlRXhwb3J0SnNvbihvcHRpb24pO1xuICAgIGNvbnNvbGUubG9nKG9wdGlvbkpzb24pO1xuICAgIGlmIChpc051bGxPckVtcHR5KHJ1bGVJRCkgJiYgaXNOdWxsT3JFbXB0eShvcHRpb25Kc29uLnZvSWQpKSB7XG4gICAgICB0aGlzLm5vdGlmeS53YXJuaW5nKFwi5pyq6YWN572u6KeE5YiZaWTvvIzkuJTml6Dms5Xojrflj5bliLDooajljZXlr7nlupTnmoR2b0lk77yM6K+35qOA5p+lXCIpO1xuICAgICAgY29uc3QgcmVzID0ge1xuICAgICAgICB0eXBlOiAnY2xvc2UnLFxuICAgICAgICBkYXRhOiBudWxsLFxuICAgICAgICBvdGhlcjogbnVsbFxuICAgICAgfTtcbiAgICAgIHN1YmplY3QubmV4dChyZXMpO1xuICAgICAgcmV0dXJuIHN1YmplY3Q7XG4gICAgfVxuICAgIGlmIChtZXRob2RUeXBlID09PSBNZXRob2RUeXBlLkV4cG9ydEN1cnJlbnRDaGlsZERhdGEpIHtcbiAgICAgIGlmIChpc051bGxPckVtcHR5KHJ1bGVJRCkgJiYgaXNOdWxsT3JFbXB0eShvcHRpb25Kc29uLmV4cG9ydENoaWxkTm9kZUNvZGUpKSB7XG4gICAgICAgIC8v5a+85Ye65a2Q6KGo5b2T6KeE5YiZaWTkuLrnqbrml7bvvIzmoLnmja52b+aJvuinhOWIme+8jOW/hemhu+imgeaxguaciemFjee9ruWtkOihqOiKgueCuVxuICAgICAgICB0aGlzLm5vdGlmeS53YXJuaW5nKFwi6KeE5YiZaWTkuLrnqbrml7bvvIzmoLnmja5Wb+afpeaJvuinhOWIme+8jOWvvOWHuuWtkOihqOW/hemhu+mFjee9ruWtkOihqOiKgueCuVwiKTtcbiAgICAgICAgY29uc3QgcmVzID0ge1xuICAgICAgICAgIHR5cGU6ICdjbG9zZScsXG4gICAgICAgICAgZGF0YTogbnVsbCxcbiAgICAgICAgICBvdGhlcjogbnVsbFxuICAgICAgICB9O1xuICAgICAgICBzdWJqZWN0Lm5leHQocmVzKTtcbiAgICAgICAgcmV0dXJuIHN1YmplY3Q7XG4gICAgICB9XG4gICAgfVxuICAgIGlmIChpc051bGxPckVtcHR5KHJ1bGVJRCkgfHwgb3B0aW9uSnNvbi5lbmFibGVSdW50aW1lQ3VzdG9tID09PSB0cnVlKSB7XG4gICAgICB0aGlzLlN0YXJ0TG9hZGluZygpO1xuICAgICAgY29uc3QgdXJsID0gJy9hcGkvcnVudGltZS9kaXAvdjEuMC9kYXRhSWVSdWxlTWFuYWdlL2dldFJlY29yZFJ1bGVJbmZvJztcbiAgICAgIGNvbnN0IHBvc3RCb2R5ID0ge1xuICAgICAgICBib2R5OiB7XG4gICAgICAgICAgcnVsZUlkOiBydWxlSUQsXG4gICAgICAgICAgcnVsZVR5cGU6IDEsXG4gICAgICAgICAgdm9JZDogb3B0aW9uSnNvbi52b0lkLFxuICAgICAgICAgIG5lZWRNb2RlbENvbnZlcnQ6IG9wdGlvbkpzb24ubmVlZE1vZGVsQ29udmVydCA9PT0gdHJ1ZSxcbiAgICAgICAgICBtZXRob2RUeXBlOiBtZXRob2RUeXBlLFxuICAgICAgICAgIGV4cG9ydENoaWxkTm9kZUNvZGU6IG9wdGlvbkpzb24uZXhwb3J0Q2hpbGROb2RlQ29kZSxcbiAgICAgICAgICBlbmFibGVSdW50aW1lQ3VzdG9tOiBvcHRpb25Kc29uLmVuYWJsZVJ1bnRpbWVDdXN0b20gPT09IHRydWVcbiAgICAgICAgfVxuICAgICAgfTtcblxuICAgICAgdGhpcy5odHRwLnBvc3QodXJsLCBwb3N0Qm9keS5ib2R5KS5zdWJzY3JpYmUoKHJlY29yZFJ1bGU6YW55KSA9PiB7XG4gICAgICAgIHRoaXMuQ2xvc2VMb2FkaW5nKCk7XG4gICAgICAgIG9wdGlvbkpzb24udm9JZCA9IHJlY29yZFJ1bGUudm9JZDtcbiAgICAgICAgdGhpcy5FeHBvcnRCeVJ1bGVJbXBsKHJ1bGVJRCwgb3B0aW9uSnNvbiwgbWV0aG9kVHlwZSwgcmVjb3JkUnVsZSkuc3Vic2NyaWJlKHMgPT4ge1xuICAgICAgICAgIHN1YmplY3QubmV4dChzKTtcbiAgICAgICAgICBzdWJqZWN0LmNvbXBsZXRlKCk7XG4gICAgICAgIH0pO1xuICAgICAgfSwgZXJyb3IgPT4ge1xuICAgICAgICB0aGlzLkNsb3NlTG9hZGluZygpO1xuICAgICAgICB0aGlzLm5vdGlmeS5lcnJvcihlcnJvci5lcnJvci5NZXNzYWdlKTtcbiAgICAgICAgY29uc29sZS5sb2coZXJyb3IuZXJyb3IuTWVzc2FnZSk7XG4gICAgICAgIGNvbnN0IHJlcyA9IHtcbiAgICAgICAgICB0eXBlOiAnY2xvc2UnLFxuICAgICAgICAgIGRhdGE6IG51bGwsXG4gICAgICAgICAgb3RoZXI6IGVycm9yLmVycm9yLk1lc3NhZ2VcbiAgICAgICAgfTtcbiAgICAgICAgc3ViamVjdC5uZXh0KHJlcyk7XG4gICAgICB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5FeHBvcnRCeVJ1bGVJbXBsKHJ1bGVJRCwgb3B0aW9uSnNvbiwgbWV0aG9kVHlwZSkuc3Vic2NyaWJlKHMgPT4ge1xuICAgICAgICBzdWJqZWN0Lm5leHQocyk7XG4gICAgICAgIHN1YmplY3QuY29tcGxldGUoKTtcbiAgICAgIH0pO1xuICAgIH1cbiAgICByZXR1cm4gc3ViamVjdDtcbiAgfVxuXG4gIHByaXZhdGUgRXhwb3J0QnlSdWxlSW1wbChydWxlSUQ6IHN0cmluZywgb3B0aW9uSnNvbjogYW55LCBtVHlwZTogTWV0aG9kVHlwZSwgcmVjb3JkUnVsZT86IGFueSkge1xuICAgIGNvbnN0IHN1YmplY3QgPSBuZXcgU3ViamVjdDxhbnk+KCk7XG4gICAgaWYgKG9wdGlvbkpzb24uY3VzdG9tRXhwb3J0VGl0bGUgIT09IHVuZGVmaW5lZCAmJiBvcHRpb25Kc29uLmN1c3RvbUV4cG9ydFRpdGxlICE9PSBudWxsKSB7XG4gICAgICBpZiAob3B0aW9uSnNvbi5jdXN0b21FeHBvcnRUaXRsZS5sZW5ndGggPiAyMCkge1xuICAgICAgICB0aGlzLm5vdGlmeS53YXJuaW5nKCfoh6rlrprkuYnmoIfpopjlkI3np7DnmoTplb/luqblpKrplb8nKTtcbiAgICAgICAgY29uc3QgcmVzID0ge1xuICAgICAgICAgIHR5cGU6ICdjbG9zZScsXG4gICAgICAgICAgZGF0YTogbnVsbCxcbiAgICAgICAgICBvdGhlcjogbnVsbFxuICAgICAgICB9O1xuICAgICAgICBzdWJqZWN0Lm5leHQocmVzKTtcbiAgICAgICAgcmV0dXJuIHN1YmplY3Q7XG4gICAgICB9XG4gICAgICBpZiAoRGF0YUlFVXRpbHMuSnVkZ2VJbGxlZ2FsQ2hhcihvcHRpb25Kc29uLmN1c3RvbUV4cG9ydFRpdGxlKSkge1xuICAgICAgICB0aGlzLm5vdGlmeS53YXJuaW5nKCfoh6rlrprkuYnmoIfpopjlkI3np7DlrZjlnKjkuI3lkIjms5XlrZfnrKYnKTtcbiAgICAgICAgY29uc3QgcmVzID0ge1xuICAgICAgICAgIHR5cGU6ICdjbG9zZScsXG4gICAgICAgICAgZGF0YTogbnVsbCxcbiAgICAgICAgICBvdGhlcjogbnVsbFxuICAgICAgICB9O1xuICAgICAgICBzdWJqZWN0Lm5leHQocmVzKTtcbiAgICAgICAgcmV0dXJuIHN1YmplY3Q7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKG9wdGlvbkpzb24uZW5hYmxlUnVudGltZUN1c3RvbSA9PT0gdHJ1ZSB8fCBvcHRpb25Kc29uLnNlbGVjdGZpbGV0eXBlID09PSB0cnVlKSB7XG4gICAgICBjb25zdCBjb21wRmFjdG9yeSA9IHRoaXMucmVzb2x2ZXIucmVzb2x2ZUNvbXBvbmVudEZhY3RvcnkoRXhwb3J0Q3VzdG9tU2VsZWN0SGFuZGNyYWZ0Q29tcG9uZW50KTtcbiAgICAgIGNvbnN0IGNtcFJlZiA9IGNvbXBGYWN0b3J5LmNyZWF0ZSh0aGlzLmluamVjdG9yKTtcbiAgICAgIGNtcFJlZi5pbnN0YW5jZS5ydWxlSWQgPSBydWxlSUQ7XG4gICAgICBjbXBSZWYuaW5zdGFuY2UuZXhwb3J0T3B0aW9uID0gb3B0aW9uSnNvbjtcbiAgICAgIGNtcFJlZi5pbnN0YW5jZS5yZWNvcmRSdWxlID0gcmVjb3JkUnVsZTtcbiAgICAgIGNtcFJlZi5pbnN0YW5jZS5zdWJqZWN0ID0gc3ViamVjdDtcbiAgICAgIGNtcFJlZi5pbnN0YW5jZS5tZXRob2RUeXBlID0gTWV0aG9kVHlwZS5Db21tb25FeHBvcnQ7XG4gICAgICBsZXQgdGl0bGUgPSB0aGlzLmRhdGFfZXhwb3J0O1xuICAgICAgaWYgKG9wdGlvbkpzb24uY3VzdG9tRXhwb3J0VGl0bGUgIT09IHVuZGVmaW5lZCAmJiBvcHRpb25Kc29uLmN1c3RvbUV4cG9ydFRpdGxlICE9PSBudWxsKSB7XG4gICAgICAgIHRpdGxlID0gb3B0aW9uSnNvbi5jdXN0b21FeHBvcnRUaXRsZTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IGV4cG9ydE1vZGFsQ29uZmlnID0ge1xuICAgICAgICB0aXRsZTogdGl0bGUsXG4gICAgICAgIHdpZHRoOiA1MzAsXG4gICAgICAgIGhlaWdodDogMzQyLFxuICAgICAgICBidXR0b25zOiBjbXBSZWYuaW5zdGFuY2UubW9kYWxGb290ZXIsXG4gICAgICAgIHNob3dDbG9zZUJ1dHRvbjogdHJ1ZSxcbiAgICAgICAgc2hvd01heEJ1dHRvbjogZmFsc2UsXG4gICAgICAgIHNob3dNaW5CdXR0b246IGZhbHNlLFxuICAgICAgICBzaG93QnV0dG9uczogdHJ1ZSxcbiAgICAgICAgcmVzaXphYmxlOiBmYWxzZVxuICAgICAgfTtcbiAgICAgIGNvbnN0IGRpYWxvZyA9IHRoaXMubW9kYWxTZXJ2aWNlLnNob3coY21wUmVmLCBleHBvcnRNb2RhbENvbmZpZyk7XG4gICAgICBkaWFsb2cuZGlhbG9nLmluc3RhbmNlLmNsb3NlZC5zdWJzY3JpYmUoKCkgPT4ge1xuICAgICAgICBjb25zdCByZXMgPSB7XG4gICAgICAgICAgdHlwZTogJ2Nsb3NlJyxcbiAgICAgICAgICBkYXRhOiBudWxsLFxuICAgICAgICAgIG90aGVyOiBudWxsXG4gICAgICAgIH07XG4gICAgICAgIHN1YmplY3QubmV4dChyZXMpO1xuICAgICAgfSk7XG4gICAgICBjbXBSZWYuaW5zdGFuY2UubmVlZERlc3Ryb3kuc3Vic2NyaWJlKCRldmVudCA9PiB7XG4gICAgICAgIGRpYWxvZy5jbG9zZSgpO1xuICAgICAgfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGlmICghaXNOdWxsT3JVbmRlZmluZWQocmVjb3JkUnVsZSkgJiYgIWlzTnVsbE9yRW1wdHkocmVjb3JkUnVsZS5ydWxlSWQpKSB7XG4gICAgICAgIHJ1bGVJRCA9IHJlY29yZFJ1bGUucnVsZUlkO1xuICAgICAgfVxuICAgICAgaWYgKG1UeXBlID09IE1ldGhvZFR5cGUuQ29tbW9uRXhwb3J0KSB7XG4gICAgICAgIHRoaXMuZGF0YUV4cG9ydFNlcnZpY2UuRXhwb3J0QnlJZDRIYW5kQ3JhZnQocnVsZUlELCAgb3B0aW9uSnNvbik7XG4gICAgICB9IGVsc2UgaWYgKG1UeXBlID09IE1ldGhvZFR5cGUuRXhwb3J0Q3VycmVudFRhYmxlRGF0YSl7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcign5LiN5pSv5oyB6K+l57G75Z6LOkV4cG9ydEN1cnJlbnRUYWJsZURhdGEnKTtcbiAgICAgIH1lbHNle1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ+S4jeaUr+aMgeivpeexu+WeizpFeHBvcnRDdXJyZW50Q2hpbGREYXRhJyk7XG4gICAgICB9XG4gICAgICBjb25zdCB1bnNjcmliZXIgPSB0aGlzLmRhdGFFeHBvcnRTZXJ2aWNlLmV4cG9ydC5zdWJzY3JpYmUoZGF0YSA9PiB7XG4gICAgICAgIGlmIChkYXRhID09PSAnJykge1xuICAgICAgICAgIGNvbnN0IHJlcyA9IHtcbiAgICAgICAgICAgIHR5cGU6ICdzdWNjZXNzJyxcbiAgICAgICAgICAgIGRhdGE6IG51bGwsXG4gICAgICAgICAgICBvdGhlcjogbnVsbFxuICAgICAgICAgIH07XG4gICAgICAgICAgc3ViamVjdC5uZXh0KHJlcyk7XG4gICAgICAgICAgc3ViamVjdC5jb21wbGV0ZSgpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGNvbnN0IGVycm9ybGV2ZWwgPSB0aGlzLmRhdGFFeHBvcnRTZXJ2aWNlLmVycm9ybGV2ZWw7XG4gICAgICAgICAgaWYgKGVycm9ybGV2ZWwgPT09ICdJbmZvJykge1xuICAgICAgICAgICAgdGhpcy5ub3RpZnkuaW5mbyhkYXRhKTtcbiAgICAgICAgICB9IGVsc2UgaWYgKGVycm9ybGV2ZWwgPT09ICdXYXJuaW5nJykge1xuICAgICAgICAgICAgdGhpcy5ub3RpZnkud2FybmluZyhkYXRhKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5ub3RpZnkuZXJyb3IodGhpcy5leHBvcnRfZmFpbCArIGRhdGEpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjb25zdCByZXMgPSB7XG4gICAgICAgICAgICB0eXBlOiAnZmFpbCcsXG4gICAgICAgICAgICBkYXRhOiBudWxsLFxuICAgICAgICAgICAgb3RoZXI6IGRhdGFcbiAgICAgICAgICB9O1xuICAgICAgICAgIHN1YmplY3QubmV4dChyZXMpO1xuICAgICAgICAgIHN1YmplY3QuY29tcGxldGUoKTtcbiAgICAgICAgfVxuICAgICAgICB1bnNjcmliZXIudW5zdWJzY3JpYmUoKTtcbiAgICAgIH0sIGVycm9yID0+IHtcbiAgICAgICAgdGhpcy5ub3RpZnkuZXJyb3IoZXJyb3IuZXJyb3IuTWVzc2FnZSk7XG4gICAgICAgIGNvbnN0IHJlcyA9IHtcbiAgICAgICAgICB0eXBlOiAnZmFpbCcsXG4gICAgICAgICAgZGF0YTogbnVsbCxcbiAgICAgICAgICBvdGhlcjogZXJyb3IuZXJyb3IuTWVzc2FnZVxuICAgICAgICB9O1xuICAgICAgICBzdWJqZWN0Lm5leHQocmVzKTtcbiAgICAgICAgc3ViamVjdC5jb21wbGV0ZSgpO1xuICAgICAgfSk7XG4gICAgfVxuICAgIHJldHVybiBzdWJqZWN0O1xuICB9XG5cblxuXG5cblxuXG4gIC8qKlxuICAgKiDpgJrnlKjlr7zlhaXmlrnms5VcbiAgICogQHBhcmFtIHR5cGVcbiAgICogQHBhcmFtIHJ1bGVJRFxuICAgKiBAcGFyYW0gb3B0aW9uXG4gICAqL1xuICBwdWJsaWMgQ29tbW9uRGF0YUltcG9ydCh0eXBlOiBhbnksIHJ1bGVJRDogc3RyaW5nLCBvcHRpb246IHN0cmluZyk6IE9ic2VydmFibGU8YW55PiB7XG4gICAgaWYgKHR5cGUgPT09IDEpIHtcbiAgICAgIGNvbnNvbGUubG9nKCfmiafooYzmlrnms5XvvJpJbXBvcnRTdWJsaXN0RGF0YScpO1xuICAgICAgcmV0dXJuIHRoaXMuSW1wb3J0U3VibGlzdERhdGEocnVsZUlELCBvcHRpb24pO1xuICAgIH0gZWxzZSBpZiAodHlwZSA9PT0gMikge1xuICAgICAgY29uc29sZS5sb2coJ+aJp+ihjOaWueazle+8mkltcG9ydEJ5TW9kZWwnKTtcbiAgICAgIHRocm93IG5ldyBFcnJvcign5LiN5pSv5oyB6YWN572u6K+l57G75Z6LOjInKTtcbiAgICB9IGVsc2UgaWYgKHR5cGUgPT09IDApIHtcbiAgICAgIGNvbnNvbGUubG9nKCfmiafooYzmlrnms5XvvJpJbXBvcnRCeVJ1bGUnKTtcbiAgICAgIHJldHVybiB0aGlzLkltcG9ydEJ5UnVsZShydWxlSUQsIG9wdGlvbik7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnNvbGUubG9nKCfmiafooYzmlrnms5XvvJpJbXBvcnRCeVJ1bGUnKTtcbiAgICAgIHJldHVybiB0aGlzLkltcG9ydEJ5UnVsZShydWxlSUQsIG9wdGlvbik7XG4gICAgfVxuICB9XG4gIC8vIOaZrumAmuWvvOWFpVxuICBwdWJsaWMgSW1wb3J0QnlSdWxlKHJ1bGVJRDogc3RyaW5nLCBvcHRpb246IGFueSk6IE9ic2VydmFibGU8YW55PiB7XG4gICAgY29uc3Qgc3ViamVjdCA9IG5ldyBTdWJqZWN0PGFueT4oKTtcbiAgICB0aGlzLkltcG9ydENvbW1vbkVudHJ5KHJ1bGVJRCwgb3B0aW9uLCBNZXRob2RUeXBlLkNvbW1vbkltcG9ydCkuc3Vic2NyaWJlKHMgPT4ge1xuICAgICAgc3ViamVjdC5uZXh0KHMpO1xuICAgICAgc3ViamVjdC5jb21wbGV0ZSgpO1xuICAgIH0pO1xuICAgIHJldHVybiBzdWJqZWN0O1xuICB9XG4gIC8vIOWtkOihqOWvvOWFpVxuICBwdWJsaWMgSW1wb3J0U3VibGlzdERhdGEocnVsZUlEOiBzdHJpbmcsIG9wdGlvbjogYW55KTogT2JzZXJ2YWJsZTxhbnk+IHtcbiAgICBjb25zdCBzdWJqZWN0ID0gbmV3IFN1YmplY3Q8YW55PigpO1xuICAgIHRoaXMuSW1wb3J0Q29tbW9uRW50cnkocnVsZUlELCBvcHRpb24sIE1ldGhvZFR5cGUuSW1wb3J0U3ViVGFibGVEZXRhaWwpLnN1YnNjcmliZShzID0+IHtcbiAgICAgIHN1YmplY3QubmV4dChzKTtcbiAgICAgIHN1YmplY3QuY29tcGxldGUoKTtcbiAgICB9KTtcbiAgICByZXR1cm4gc3ViamVjdDtcbiAgfVxuICBwcml2YXRlIEltcG9ydENvbW1vbkVudHJ5KHJ1bGVJRDogc3RyaW5nLCBvcHRpb246IHN0cmluZywgbWV0aG9kVHlwZTogTWV0aG9kVHlwZSkge1xuICAgIGNvbnNvbGUubG9nKG9wdGlvbik7XG4gICAgY29uc3Qgc3ViamVjdCA9IG5ldyBTdWJqZWN0PGFueT4oKTtcbiAgICBjb25zdCBvcHRpb25Kc29uID0gdGhpcy5QYXJzZUltcG9ydEpzb24ob3B0aW9uKTtcbiAgICBjb25zdCBzdSA9IG9wdGlvbkpzb24uc3U7XG4gICAgaWYgKG1ldGhvZFR5cGUgPT09IE1ldGhvZFR5cGUuSW1wb3J0U3ViVGFibGVEZXRhaWwpIHtcbiAgICAgIGlmIChpc051bGxPckVtcHR5KHJ1bGVJRCkgJiYgaXNOdWxsT3JFbXB0eShvcHRpb25Kc29uLmltcG9ydENoaWxkTm9kZUNvZGUpKSB7XG4gICAgICAgIC8v5a+85YWl5a2Q6KGo5b2T6KeE5YiZaWTkuLrnqbrml7bvvIzmoLnmja52b+aJvuinhOWIme+8jOW/hemhu+imgeaxguaciemFjee9ruWtkOihqOiKgueCuVxuICAgICAgICB0aGlzLm5vdGlmeS53YXJuaW5nKFwi6KeE5YiZaWTkuLrnqbrml7bvvIzmoLnmja7mqKHlnovmn6Xmib7op4TliJnvvIzlr7zlhaXlrZDooajlv4XpobvphY3nva7lrZDooajoioLngrlcIik7XG4gICAgICAgIGNvbnN0IHJlcyA9IHtcbiAgICAgICAgICB0eXBlOiAnY2xvc2UnLFxuICAgICAgICAgIGRhdGE6IG51bGwsXG4gICAgICAgICAgb3RoZXI6IG51bGxcbiAgICAgICAgfTtcbiAgICAgICAgc3ViamVjdC5uZXh0KHJlcyk7XG4gICAgICAgIHJldHVybiBzdWJqZWN0O1xuICAgICAgfVxuICAgIH1cbiAgICB0aGlzLlN0YXJ0TG9hZGluZygpO1xuICAgIGNvbnN0IHVybCA9ICcvYXBpL3J1bnRpbWUvZGlwL3YxLjAvZGF0YUllUnVsZU1hbmFnZS9nZXRSZWNvcmRSdWxlSW5mbyc7XG4gICAgY29uc3QgcG9zdEJvZHkgPSB7XG4gICAgICBib2R5OiB7XG4gICAgICAgIHJ1bGVJZDogcnVsZUlELFxuICAgICAgICBzdTogc3UsXG4gICAgICAgIHJ1bGVUeXBlOiAwLFxuICAgICAgICB2b0lkOiBvcHRpb25Kc29uLnZvSWQsXG4gICAgICAgIG5lZWRNb2RlbENvbnZlcnQ6IG9wdGlvbkpzb24ubmVlZE1vZGVsQ29udmVydCA9PT0gdHJ1ZSxcbiAgICAgICAgbWV0aG9kVHlwZTogbWV0aG9kVHlwZSxcbiAgICAgICAgaW1wb3J0Q2hpbGROb2RlQ29kZTogb3B0aW9uSnNvbi5pbXBvcnRDaGlsZE5vZGVDb2RlLFxuICAgICAgICBlbmFibGVSdW50aW1lQ3VzdG9tOiBvcHRpb25Kc29uLmVuYWJsZVJ1bnRpbWVDdXN0b20gPT09IHRydWVcbiAgICAgIH1cbiAgICB9O1xuICAgIHRoaXMuaHR0cC5wb3N0KHVybCwgcG9zdEJvZHkuYm9keSkuc3Vic2NyaWJlKChyZWNvcmRSdWxlOmFueSkgPT4ge1xuICAgICAgdGhpcy5DbG9zZUxvYWRpbmcoKTtcbiAgICAgIG9wdGlvbkpzb24udm9JZCA9IHJlY29yZFJ1bGUudm9JZDtcbiAgICAgIHRoaXMuSW1wb3J0QnlSdWxlSW1wbChydWxlSUQsIG9wdGlvbkpzb24sIG1ldGhvZFR5cGUsIHJlY29yZFJ1bGUpLnN1YnNjcmliZShzID0+IHtcbiAgICAgICAgc3ViamVjdC5uZXh0KHMpO1xuICAgICAgICBzdWJqZWN0LmNvbXBsZXRlKCk7XG4gICAgICB9KTtcbiAgICB9LCBlcnJvciA9PiB7XG4gICAgICB0aGlzLkNsb3NlTG9hZGluZygpO1xuICAgICAgdGhpcy5ub3RpZnkuZXJyb3IoZXJyb3IuZXJyb3IuTWVzc2FnZSk7XG4gICAgICBjb25zb2xlLmxvZyhlcnJvci5lcnJvci5NZXNzYWdlKTtcbiAgICAgIGNvbnN0IHJlcyA9IHtcbiAgICAgICAgdHlwZTogJ2Nsb3NlJyxcbiAgICAgICAgZGF0YTogbnVsbCxcbiAgICAgICAgb3RoZXI6IGVycm9yLmVycm9yLk1lc3NhZ2VcbiAgICAgIH07XG4gICAgICBzdWJqZWN0Lm5leHQocmVzKTtcbiAgICB9KTtcbiAgICByZXR1cm4gc3ViamVjdDtcbiAgfVxuICBwcml2YXRlIEltcG9ydEJ5UnVsZUltcGwocnVsZUlEOiBzdHJpbmcsIG9wdGlvbkpzb246IGFueSwgbWV0aG9kVHlwZTogTWV0aG9kVHlwZSwgcmVjb3JkUnVsZT86IGFueSkge1xuICAgIGNvbnN0IHN1YmplY3QgPSBuZXcgU3ViamVjdDxhbnk+KCk7XG4gICAgaWYgKG9wdGlvbkpzb24uY3VzdG9tSW1wb3J0VGl0bGUgIT09IHVuZGVmaW5lZCAmJiBvcHRpb25Kc29uLmN1c3RvbUltcG9ydFRpdGxlICE9PSBudWxsKSB7XG4gICAgICBpZiAob3B0aW9uSnNvbi5jdXN0b21JbXBvcnRUaXRsZS5sZW5ndGggPiAyMCkge1xuICAgICAgICB0aGlzLm5vdGlmeS53YXJuaW5nKCfoh6rlrprkuYnmoIfpopjlkI3np7DnmoTplb/luqblpKrplb8nKTtcbiAgICAgICAgY29uc3QgcmVzID0ge1xuICAgICAgICAgIHR5cGU6ICdjbG9zZScsXG4gICAgICAgICAgZGF0YTogbnVsbCxcbiAgICAgICAgICBvdGhlcjogbnVsbFxuICAgICAgICB9O1xuICAgICAgICBzdWJqZWN0Lm5leHQocmVzKTtcbiAgICAgICAgcmV0dXJuIHN1YmplY3Q7XG4gICAgICB9XG4gICAgICBpZiAoRGF0YUlFVXRpbHMuSnVkZ2VJbGxlZ2FsQ2hhcihvcHRpb25Kc29uLmN1c3RvbUltcG9ydFRpdGxlKSkge1xuICAgICAgICB0aGlzLm5vdGlmeS53YXJuaW5nKCfoh6rlrprkuYnmoIfpopjlkI3np7DlrZjlnKjkuI3lkIjms5XlrZfnrKYnKTtcbiAgICAgICAgY29uc3QgcmVzID0ge1xuICAgICAgICAgIHR5cGU6ICdjbG9zZScsXG4gICAgICAgICAgZGF0YTogbnVsbCxcbiAgICAgICAgICBvdGhlcjogbnVsbFxuICAgICAgICB9O1xuICAgICAgICBzdWJqZWN0Lm5leHQocmVzKTtcbiAgICAgICAgcmV0dXJuIHN1YmplY3Q7XG4gICAgICB9XG4gICAgfVxuICAgIGNvbnN0IGNvbXBGYWN0b3J5ID0gdGhpcy5yZXNvbHZlci5yZXNvbHZlQ29tcG9uZW50RmFjdG9yeShJbXBvcnREaWFsb2dIYW5kY3JhZnRDb21wb25lbnQpO1xuICAgIGNvbnN0IGNtcFJlZiA9IGNvbXBGYWN0b3J5LmNyZWF0ZSh0aGlzLmluamVjdG9yKTtcbiAgICBjbXBSZWYuaW5zdGFuY2UucnVsZUlkID0gcnVsZUlEO1xuICAgIGNtcFJlZi5pbnN0YW5jZS5yZWNvcmRSdWxlID0gcmVjb3JkUnVsZTtcbiAgICBjbXBSZWYuaW5zdGFuY2UuaW1wb3J0T3B0aW9uID0gb3B0aW9uSnNvbjtcbiAgICBpZiAobWV0aG9kVHlwZSA9PSBNZXRob2RUeXBlLkNvbW1vbkltcG9ydCkge1xuICAgICAgY21wUmVmLmluc3RhbmNlLm1ldGhvZFR5cGUgPSBNZXRob2RUeXBlLkNvbW1vbkltcG9ydDtcbiAgICB9IGVsc2Uge1xuICAgICAgY21wUmVmLmluc3RhbmNlLm1ldGhvZFR5cGUgPSBNZXRob2RUeXBlLkltcG9ydFN1YlRhYmxlRGV0YWlsO1xuICAgIH1cbiAgICBjbXBSZWYuaW5zdGFuY2Uuc3ViamVjdCA9IHN1YmplY3Q7XG4gICAgbGV0IHRpdGxlID0gdGhpcy5kYXRhX2ltcG9ydDtcbiAgICBpZiAoIWlzTnVsbE9yVW5kZWZpbmVkKG9wdGlvbkpzb24uY3VzdG9tSW1wb3J0VGl0bGUpKSB7XG4gICAgICB0aXRsZSA9IG9wdGlvbkpzb24uY3VzdG9tSW1wb3J0VGl0bGU7XG4gICAgfVxuICAgIGNvbnN0IGltcG9ydE1vZGFsQ29uZmlnID0ge1xuICAgICAgdGl0bGU6IHRpdGxlLFxuICAgICAgd2lkdGg6IDUzMCxcbiAgICAgIGhlaWdodDogMzQyLFxuICAgICAgYnV0dG9uczogY21wUmVmLmluc3RhbmNlLm1vZGFsRm9vdGVyLFxuICAgICAgc2hvd0Nsb3NlQnV0dG9uOiB0cnVlLFxuICAgICAgc2hvd01heEJ1dHRvbjogZmFsc2UsXG4gICAgICBzaG93TWluQnV0dG9uOiBmYWxzZSxcbiAgICAgIHNob3dCdXR0b25zOiB0cnVlLFxuICAgICAgcmVzaXphYmxlOiBmYWxzZVxuICAgIH07XG4gICAgY29uc3QgZGlhbG9nID0gdGhpcy5tb2RhbFNlcnZpY2Uuc2hvdyhjbXBSZWYsIGltcG9ydE1vZGFsQ29uZmlnKTtcbiAgICBkaWFsb2cuZGlhbG9nLmluc3RhbmNlLmNsb3NlZC5zdWJzY3JpYmUoKCkgPT4ge1xuICAgICAgY29uc3QgcmVzID0ge1xuICAgICAgICB0eXBlOiAnY2xvc2UnLFxuICAgICAgICBkYXRhOiBudWxsLFxuICAgICAgICBvdGhlcjogbnVsbFxuICAgICAgfTtcbiAgICAgIHN1YmplY3QubmV4dChyZXMpO1xuICAgIH0pO1xuICAgIGNtcFJlZi5pbnN0YW5jZS5uZWVkRGVzdHJveS5zdWJzY3JpYmUoZGF0YSA9PiB7XG4gICAgICBkaWFsb2cuY2xvc2UoKTtcbiAgICAgIGNvbnN0IGltcG9ydFJlc3VsdCA9IGRhdGEgYXMgRGF0YUlFUmVzdWx0O1xuICAgICAgaWYgKCFpc051bGxPclVuZGVmaW5lZChpbXBvcnRSZXN1bHQpKSB7XG4gICAgICAgIGxldCByZXM7XG4gICAgICAgIGlmKGltcG9ydFJlc3VsdC5zdWNjZWVkKXtcbiAgICAgICAgICByZXMgPSB7XG4gICAgICAgICAgICB0eXBlOiAnc3VjY2VzcycsXG4gICAgICAgICAgICBkYXRhOiBpbXBvcnRSZXN1bHQsXG4gICAgICAgICAgICBvdGhlcjogbnVsbFxuICAgICAgICAgIH07XG4gICAgICAgIH1lbHNlIHtcbiAgICAgICAgICByZXMgPSB7XG4gICAgICAgICAgICB0eXBlOiAnZmFpbCcsXG4gICAgICAgICAgICBkYXRhOiBpbXBvcnRSZXN1bHQsXG4gICAgICAgICAgICBvdGhlcjogbnVsbFxuICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgc3ViamVjdC5uZXh0KHJlcyk7XG4gICAgICAgIHN1YmplY3QuY29tcGxldGUoKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICByZXR1cm4gc3ViamVjdDtcbiAgfVxuXG5cblxuXG5cblxuICBwcml2YXRlIFBhcnNlRXhwb3J0SnNvbihvcHRpb246IGFueSk6IGFueSB7XG4gICAgaWYgKHR5cGVvZiAob3B0aW9uKSA9PT0gJ29iamVjdCcpe1xuICAgICAgcmV0dXJuIG9wdGlvbjtcbiAgICB9XG4gICAgaWYgKGlzTnVsbE9yVW5kZWZpbmVkKG9wdGlvbikgfHwgaXNOdWxsT3JFbXB0eShvcHRpb24pKSB7XG4gICAgICByZXR1cm4ge307XG4gICAgfVxuICAgIGxldCBvcHRpb25Kc29uID0gbnVsbDtcbiAgICB0cnkge1xuICAgICAgb3B0aW9uSnNvbiA9IEpTT04ucGFyc2Uob3B0aW9uKTtcbiAgICB9IGNhdGNoIHtcbiAgICAgIHRoaXMubm90aWZ5Lndhcm5pbmcoJ+S8oOWFpeeahOWPguaVsOi9rOaNokpTT07lr7nosaHlvILluLjvvIzlt7Lkvb/nlKjpu5jorqTlj4LmlbAnKTtcbiAgICAgIHJldHVybiB7fTtcbiAgICB9XG4gICAgaWYgKHR5cGVvZiAob3B0aW9uSnNvbikgIT09ICdvYmplY3QnKXtcbiAgICAgIG9wdGlvbkpzb24gPSB7fTtcbiAgICB9XG4gICAgcmV0dXJuIG9wdGlvbkpzb247XG4gIH1cbiAgcHJpdmF0ZSBQYXJzZUltcG9ydEpzb24ob3B0aW9uOiBhbnkpOiBhbnkge1xuICAgIGlmICh0eXBlb2YgKG9wdGlvbikgPT09ICdvYmplY3QnKXtcbiAgICAgIHJldHVybiBvcHRpb247XG4gICAgfVxuICAgIGlmIChpc051bGxPclVuZGVmaW5lZChvcHRpb24pIHx8IGlzTnVsbE9yRW1wdHkob3B0aW9uKSkge1xuICAgICAgcmV0dXJuIHt9O1xuICAgIH1cbiAgICBsZXQgb3B0aW9uSnNvbiA9IG51bGw7XG4gICAgdHJ5IHtcbiAgICAgIG9wdGlvbkpzb24gPSBKU09OLnBhcnNlKG9wdGlvbik7XG4gICAgfSBjYXRjaCB7XG4gICAgICB0aGlzLm5vdGlmeS53YXJuaW5nKCfkvKDlhaXnmoTlj4LmlbDovazmjaJKU09O5a+56LGh5byC5bi477yM5bey5L2/55So6buY6K6k5Y+C5pWwJyk7XG4gICAgICByZXR1cm4ge307XG4gICAgfVxuICAgIGlmICh0eXBlb2YgKG9wdGlvbkpzb24pICE9PSAnb2JqZWN0Jyl7XG4gICAgICBvcHRpb25Kc29uID0ge307XG4gICAgfVxuICAgIGxldCBnbG9iYWxQYXJhbSA9IG9wdGlvbkpzb25bJ2dsb2JhbFBhcmFtJ107XG4gICAgaWYgKGdsb2JhbFBhcmFtICE9PSB1bmRlZmluZWQgJiYgZ2xvYmFsUGFyYW0gIT09IG51bGwpIHtcbiAgICAgIG9wdGlvbkpzb25bJ0dsb2JhbFBhcmFtJ10gPSBnbG9iYWxQYXJhbTtcbiAgICB9XG4gICAgcmV0dXJuIG9wdGlvbkpzb247XG4gIH1cblxuICBTdGFydExvYWRpbmcoKSB7XG4gICAgaWYgKHRoaXMubG9hZGluZ1NlcnZpY2UgIT09IHVuZGVmaW5lZCAmJiB0aGlzLmxvYWRpbmdTZXJ2aWNlICE9PSBudWxsKSB7XG4gICAgICB0aGlzLmxvYWRpbmdTZXJ2aWNlLnNob3coKTtcbiAgICB9XG4gIH1cblxuICBDbG9zZUxvYWRpbmcoKSB7XG4gICAgaWYgKHRoaXMubG9hZGluZ1NlcnZpY2UgIT09IHVuZGVmaW5lZCAmJiB0aGlzLmxvYWRpbmdTZXJ2aWNlICE9PSBudWxsKSB7XG4gICAgICB0aGlzLmxvYWRpbmdTZXJ2aWNlLmNsZWFyQWxsKCk7XG4gICAgfVxuICB9XG5cbn1cbiJdfQ==