/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { ComponentFactoryResolver, EventEmitter, Injectable, Injector } from '@angular/core';
import { BsModalService } from '@farris/ui-modal';
import { ValidateFormComponent } from '../../validate-form/validate-form.component';
import { FileOperateService } from './file-operate.service';
import { NotifyService } from '@farris/ui-notify';
import { DataIEUtils, getQueryString, isNullOrEmpty, isNullOrUndefined } from '../Utils/DataIEUtils';
import { HttpClient } from '@angular/common/http';
import { MethodType } from "../../model/DataIEType/MethodType";
var DataImportService = /** @class */ (function () {
    function DataImportService(modalService, resolver, operateService, notify, http, injector) {
        var _this = this;
        this.modalService = modalService;
        this.resolver = resolver;
        this.operateService = operateService;
        this.notify = notify;
        this.http = http;
        this.injector = injector;
        this.origin = window.location.origin;
        this.url = this.origin + '/api/runtime/rtcommon/v1.0/import';
        this.DataIeProgressParams = {
            "ImportProgressValue": 13
        };
        this.complete = new EventEmitter();
        DataIEUtils.getTranslateValue(http).subscribe((/**
         * @param {?} res
         * @return {?}
         */
        function (res) {
            _this.master_table_noid = res['master_table_noid'];
            _this.bind_form_error = res['bind_form_error'];
            _this.validate_result_show = res['validate_result_show'];
        }));
    }
    /**
     * @param {?} commonParams
     * @return {?}
     */
    DataImportService.prototype.ImportSubTable = /**
     * @param {?} commonParams
     * @return {?}
     */
    function (commonParams) {
        /** @type {?} */
        var ruleId = commonParams.ruleId;
        /** @type {?} */
        var option = commonParams.option;
        /** @type {?} */
        var frameContext = commonParams.frameContext;
        /** @type {?} */
        var methodType = commonParams.methodType;
        /** @type {?} */
        var suffix = commonParams.suffix;
        /** @type {?} */
        var fileName = commonParams.fileName;
        /** @type {?} */
        var befRestService = this.getBefRestService(frameContext.repository);
        commonParams.befRestService = befRestService;
        commonParams.repository = frameContext.repository;
        /** @type {?} */
        var globalVar = '';
        if (option['GlobalParam'] !== null && option['GlobalParam'] !== undefined) {
            if (typeof (option['GlobalParam']) === 'object') {
                globalVar = JSON.stringify(option['GlobalParam']);
            }
            else {
                globalVar = option['GlobalParam'];
            }
        }
        /** @type {?} */
        var model = '';
        if (option.Models !== undefined && option.Models !== null && option.Models.length > 0) {
            model = JSON.stringify(option.Models[0]);
        }
        /** @type {?} */
        var mainObjId = frameContext.bindingData.list.currentId;
        if (isNullOrEmpty(mainObjId)) {
            this.notify.info(this.master_table_noid);
            return false;
            // this.errorlevel = 'Info';
            // this.complete.emit('未获取到主表ID值，请确认主表是否有数据');
        }
        else {
            /** @type {?} */
            var funcId = getQueryString('funcId');
            /** @type {?} */
            var importParam = {
                body: {
                    dataImportContext: {
                        RuleId: ruleId,
                        FileName: fileName,
                        MainObjId: mainObjId,
                        GlobalParam: globalVar,
                        Suffix: suffix,
                        Model: model,
                        funcId: funcId,
                        securityLevelName: commonParams.securityLevelName,
                        methodType: methodType
                    },
                    requestInfo: befRestService.buildRequestInfo()
                }
            };
            commonParams.importParam = importParam;
            commonParams.mainObjId = mainObjId;
            this.Import(commonParams);
        }
    };
    /**
     * @param {?} commonParams
     * @return {?}
     */
    DataImportService.prototype.ImportSubTable4HandCraft = /**
     * @param {?} commonParams
     * @return {?}
     */
    function (commonParams) {
        /** @type {?} */
        var ruleId = commonParams.ruleId;
        /** @type {?} */
        var option = commonParams.option;
        /** @type {?} */
        var frameContext = commonParams.frameContext;
        /** @type {?} */
        var suffix = commonParams.suffix;
        /** @type {?} */
        var fileName = commonParams.fileName;
        /** @type {?} */
        var globalVar = '';
        if (option['GlobalParam'] !== null && option['GlobalParam'] !== undefined) {
            if (typeof (option['GlobalParam']) === 'object') {
                globalVar = JSON.stringify(option['GlobalParam']);
            }
            else {
                globalVar = option['GlobalParam'];
            }
        }
        /** @type {?} */
        var repository = frameContext === null ? null : frameContext.repository;
        /** @type {?} */
        var mainObjId = '';
        //手工表单仓库为null
        if (repository === null) {
            if (option['mainId'] === undefined || option['mainId'] === null || option['mainId'] === '') {
                this.notify.info(this.master_table_noid);
                return false;
            }
            else {
                mainObjId = option['mainId'];
            }
        }
        else { //通用导入
            if (frameContext.bindingData.list.currentId === '' || frameContext.bindingData.list.currentId === null) {
                this.notify.info(this.master_table_noid);
                return false;
            }
            else {
                mainObjId = frameContext.bindingData.list.currentId;
            }
        }
        /** @type {?} */
        var funcId = getQueryString('funcId');
        /** @type {?} */
        var importParam = {
            ruleId: ruleId,
            fileName: fileName,
            mainObjId: mainObjId,
            globalParam: globalVar,
            suffix: suffix,
            funcId: funcId,
            securityLevelName: commonParams.securityLevelName
        };
        commonParams.importParam = importParam;
        commonParams.mainObjId = mainObjId;
        // this.Import4HandCraft(commonParams);
    };
    /**
     * @param {?} commonParams
     * @return {?}
     */
    DataImportService.prototype.ImportByRuleId = /**
     * @param {?} commonParams
     * @return {?}
     */
    function (commonParams) {
        /** @type {?} */
        var ruleId = commonParams.ruleId;
        /** @type {?} */
        var option = commonParams.option;
        /** @type {?} */
        var repository = commonParams.repository;
        /** @type {?} */
        var suffix = commonParams.suffix;
        /** @type {?} */
        var fileName = commonParams.fileName;
        /** @type {?} */
        var methodType = commonParams.methodType;
        /** @type {?} */
        var befRestService = this.getBefRestService(repository);
        commonParams.befRestService = befRestService;
        /** @type {?} */
        var globalVar = '';
        if (option['GlobalParam'] !== null && option['GlobalParam'] !== undefined) {
            if (typeof (option['GlobalParam']) === 'object') {
                globalVar = JSON.stringify(option['GlobalParam']);
            }
            else {
                globalVar = option['GlobalParam'];
            }
        }
        /** @type {?} */
        var model = '';
        if (option.Models !== undefined && option.Models !== null && option.Models.length > 0) {
            model = JSON.stringify(option.Models[0]);
        }
        console.log('baseUri: ' + befRestService.baseUri);
        /** @type {?} */
        var funcId = getQueryString('funcId');
        if (methodType === MethodType.CardFormDataImport) {
            commonParams.mainObjId = option.mainObjId;
        }
        else {
            commonParams.mainObjId = '';
        }
        /** @type {?} */
        var importParam = {
            body: {
                dataImportContext: {
                    RuleId: ruleId,
                    FileName: fileName,
                    GlobalParam: globalVar,
                    Suffix: suffix,
                    Model: model,
                    funcId: funcId,
                    securityLevelName: commonParams.securityLevelName,
                    mainObjId: commonParams.mainObjId,
                    methodType: methodType
                }
            }
        };
        commonParams.importParam = importParam;
        this.Import(commonParams);
    };
    /**
     * @param {?} commonParams
     * @return {?}
     */
    DataImportService.prototype.Import = /**
     * @param {?} commonParams
     * @return {?}
     */
    function (commonParams) {
        var _this = this;
        /** @type {?} */
        var repository = commonParams.repository;
        /** @type {?} */
        var importParam = commonParams.importParam;
        /** @type {?} */
        var befRestService = commonParams.befRestService;
        /** @type {?} */
        var methodType = commonParams.methodType;
        /** @type {?} */
        var subscriber = befRestService.request(befRestService.baseUri + "/service/dataimportvmaction", 'put', null, importParam);
        subscriber.subscribe((/**
         * @param {?} data
         * @return {?}
         */
        function (data) {
            /** @type {?} */
            var su = DataIEUtils.getSu(befRestService.baseUri);
            /** @type {?} */
            var importResult = (/** @type {?} */ (data.returnValue));
            if (isNullOrUndefined(importResult)) {
                importResult = (/** @type {?} */ (data));
            }
            commonParams.su = su;
            commonParams.importResult = importResult;
            if (importResult.succeed === true) {
                try {
                    if (importResult.formData && importResult.formData.length > 0) {
                        importResult.isform = true;
                        if (methodType === MethodType.ImportSubTableDetail) {
                            //子表导入表单
                            /** @type {?} */
                            var newData = importResult.formData[0];
                            /** @type {?} */
                            var curEntity = repository.entityCollection.getEntityById(commonParams.mainObjId);
                            curEntity.load(newData);
                        }
                        else if (methodType === MethodType.CardFormDataImport) {
                            //卡片导入不走数据加载，导入命令完成后有更新命令
                        }
                        else {
                            //主从表导入表单
                            /** @type {?} */
                            var entities_1 = [];
                            importResult.formData.forEach((/**
                             * @param {?} rdata
                             * @return {?}
                             */
                            function (rdata) {
                                /** @type {?} */
                                var entity = repository.buildEntity(rdata);
                                entities_1.push(entity);
                            }));
                            repository.entityCollection.addEntities(entities_1);
                        }
                    }
                    if (importResult.validatedResults && importResult.validatedResults.length > 0) {
                        _this.complete.emit('部分数据导入完成');
                    }
                    else {
                        if (importResult.isform == true) {
                            //此处为传递，无需国际化
                            _this.complete.emit('导入表单成功');
                        }
                        else {
                            _this.complete.emit('');
                        }
                    }
                    // this.complete.emit(true);
                    //this.complete.emit('');
                    //导入成功如果展示校验结果，只能是校验策略是忽略，所有校验结果都是error
                    _this.ShowValidatedResult(commonParams);
                    // this.notify.info('数据导入成功');
                    // this.needDestroy.emit();
                }
                catch (_a) {
                    // this.complete.emit(false);
                    _this.complete.emit(importResult.message);
                    _this.notify.error(_this.bind_form_error);
                }
            }
            else {
                console.log(importResult.exceptionSource);
                _this.errorlevel = importResult.errorLevel;
                _this.ShowValidatedResult(commonParams);
                // this.complete.emit(importResult.message);
            }
        }), (/**
         * @param {?} error
         * @return {?}
         */
        function (error) {
            console.log(error);
            _this.errorlevel = 'error';
            _this.complete.emit(error.error.Message);
        }));
    };
    // 显示校验结果
    // 显示校验结果
    /**
     * @private
     * @param {?} commonParams
     * @return {?}
     */
    DataImportService.prototype.ShowValidatedResult = 
    // 显示校验结果
    /**
     * @private
     * @param {?} commonParams
     * @return {?}
     */
    function (commonParams) {
        var _this = this;
        /** @type {?} */
        var importResult = commonParams.importResult;
        /** @type {?} */
        var loadingParam = commonParams.loadingParam;
        /** @type {?} */
        var befRestService = commonParams.befRestService;
        if (importResult.validatedResults && importResult.validatedResults.length > 0) {
            loadingParam.loadingService.clearAll();
            /** @type {?} */
            var cmpRef = this.CreateValidatedComponent();
            cmpRef.instance.validateResult = importResult.validatedResults;
            cmpRef.instance.su = commonParams.su;
            cmpRef.instance.i18nResource = commonParams.i18nResource;
            cmpRef.instance.loadingParam = loadingParam;
            /** @type {?} */
            var validateModalConfig = {
                title: this.validate_result_show,
                width: 950,
                height: 550,
                buttons: cmpRef.instance.modalFooter,
                showHeader: true,
                showMaxButton: false,
                showButtons: true
            };
            /** @type {?} */
            var dialog_1 = this.modalService.show(cmpRef, validateModalConfig);
            //0代表按钮中止或X点击；1代表按钮继续
            /** @type {?} */
            var closed_1 = 0;
            dialog_1.dialog.instance.closed.subscribe((/**
             * @return {?}
             */
            function () {
                if (closed_1 === 0) {
                    _this.complete.emit('校验中止');
                }
            }));
            cmpRef.instance.closeModal.subscribe((/**
             * @return {?}
             */
            function () {
                closed_1 = 0;
                dialog_1.close();
            }));
            cmpRef.instance.okModal.subscribe((/**
             * @param {?} validatedInfoList
             * @return {?}
             */
            function (validatedInfoList) {
                closed_1 = 1;
                dialog_1.close();
                loadingParam.loadingService.show(loadingParam.loadingConfig);
                commonParams.importParam.body.dataImportContext['validatedInfoList'] = validatedInfoList;
                _this.Import(commonParams);
            }));
        }
        else {
            this.complete.emit(importResult.message);
        }
    };
    /**
     * @private
     * @param {?} repository
     * @return {?}
     */
    DataImportService.prototype.getBefRestService = /**
     * @private
     * @param {?} repository
     * @return {?}
     */
    function (repository) {
        /** @type {?} */
        var befRepository = (/** @type {?} */ (repository));
        return befRepository.restService;
    };
    // 生成校验窗口组件
    // 生成校验窗口组件
    /**
     * @private
     * @return {?}
     */
    DataImportService.prototype.CreateValidatedComponent = 
    // 生成校验窗口组件
    /**
     * @private
     * @return {?}
     */
    function () {
        /** @type {?} */
        var compFactory = this.resolver.resolveComponentFactory(ValidateFormComponent);
        /** @type {?} */
        var comRef = compFactory.create(this.injector);
        return comRef;
    };
    /**
     * @param {?} str
     * @return {?}
     */
    DataImportService.prototype.JudgeIllegalChar = /**
     * @param {?} str
     * @return {?}
     */
    function (str) {
        /** @type {?} */
        var illegalChar = ['?', '、', '\\', '/', '*', '\'', '"', '“', '”', '<', '>', '|', ','];
        illegalChar.forEach((/**
         * @param {?} item
         * @return {?}
         */
        function (item) {
            if (str.indexOf(item) !== -1) {
                return true;
            }
        }));
        return false;
    };
    // 下载模板
    // 下载模板
    /**
     * @param {?} ruleId
     * @param {?} repository
     * @param {?} importOption
     * @param {?} suffix
     * @return {?}
     */
    DataImportService.prototype.DowmloadTemplate = 
    // 下载模板
    /**
     * @param {?} ruleId
     * @param {?} repository
     * @param {?} importOption
     * @param {?} suffix
     * @return {?}
     */
    function (ruleId, repository, importOption, suffix) {
        var _this = this;
        /** @type {?} */
        var befRestService = this.getBefRestService(repository);
        /** @type {?} */
        var preUrl = DataIEUtils.GetPreUrl(befRestService.baseUri);
        /** @type {?} */
        var tempUrl = preUrl + "/import";
        /** @type {?} */
        var su = DataIEUtils.getSu(tempUrl);
        if (importOption['su'] !== undefined && importOption['su'] !== null) {
            su = importOption['su'];
        }
        /** @type {?} */
        var securityLevelName = '';
        if (!isNullOrUndefined(importOption.securityLevelName)) {
            securityLevelName = importOption.securityLevelName;
        }
        /** @type {?} */
        var model = '';
        if (importOption.Models !== undefined && importOption.Models !== null && importOption.Models.length > 0) {
            model = JSON.stringify(importOption.Models[0]);
        }
        /** @type {?} */
        var globalVar = '';
        if (!isNullOrUndefined(importOption['GlobalParam'])) {
            if (typeof (importOption['GlobalParam']) === 'object') {
                globalVar = JSON.stringify(importOption['GlobalParam']);
            }
            else {
                globalVar = importOption['GlobalParam'];
            }
        }
        /** @type {?} */
        var templateParam = {
            body: {
                ruleId: ruleId,
                suffix: suffix,
                su: su,
                model: model,
                globalParam: globalVar,
                securityLevelName: securityLevelName
            }
        };
        /** @type {?} */
        var fixedUrl = this.origin + '/api/runtime/dip/v1.0/rpcimport';
        /** @type {?} */
        var subscriber = befRestService.request(fixedUrl + "/TemplateDownload", 'post', { su: su }, templateParam);
        subscriber.subscribe((/**
         * @param {?} data
         * @return {?}
         */
        function (data) {
            if (data['result'] === true) {
                /** @type {?} */
                var filename = '';
                if (importOption['templatefilename'] === '' || importOption['templatefilename'] === undefined) {
                    filename = data['fileName'];
                }
                else {
                    /** @type {?} */
                    var suffixIndex = data['fileName'].lastIndexOf('.');
                    /** @type {?} */
                    var tempsuffix = data['fileName'].substring(suffixIndex);
                    /** @type {?} */
                    var customName = importOption['templatefilename'];
                    if (!_this.JudgeIllegalChar(customName)) {
                        if (customName.indexOf('.') !== -1) {
                            filename = customName;
                        }
                        else {
                            filename = customName + tempsuffix;
                        }
                    }
                    else {
                        filename = data['fileName'];
                    }
                }
                _this.operateService.DownloadFile(data['docRelativePath'], filename, preUrl, importOption);
                /** @type {?} */
                var subscription_1 = _this.operateService.downloadComplete.subscribe((/**
                 * @param {?} result
                 * @return {?}
                 */
                function (result) {
                    if (result === '') {
                        _this.complete.emit('');
                        subscription_1.unsubscribe();
                    }
                    else {
                        _this.complete.emit(result);
                        subscription_1.unsubscribe();
                    }
                }));
            }
            else {
                // this.notify.error('下载模板失败，失败信息：' + data['message']);
                _this.complete.emit(data['message']);
            }
        }), (/**
         * @param {?} error
         * @return {?}
         */
        function (error) {
            console.log(error);
            _this.complete.emit('下载模板失败');
        }));
    };
    // 下载模板
    // 下载模板
    /**
     * @param {?} ruleId
     * @param {?} importOption
     * @param {?} suffix
     * @return {?}
     */
    DataImportService.prototype.DowmloadTemplate4HandCraft = 
    // 下载模板
    /**
     * @param {?} ruleId
     * @param {?} importOption
     * @param {?} suffix
     * @return {?}
     */
    function (ruleId, importOption, suffix) {
        var _this = this;
        /** @type {?} */
        var su = importOption.su;
        /** @type {?} */
        var globalVar = '';
        if (importOption['GlobalParam'] !== null && importOption['GlobalParam'] !== undefined) {
            if (typeof (importOption['GlobalParam']) === 'object') {
                globalVar = JSON.stringify(importOption['GlobalParam']);
            }
            else {
                globalVar = importOption['GlobalParam'];
            }
        }
        /** @type {?} */
        var securityLevelName = '';
        if (!isNullOrUndefined(importOption.securityLevelName)) {
            securityLevelName = importOption.securityLevelName;
        }
        /** @type {?} */
        var templateParam = {
            ruleId: ruleId,
            suffix: suffix,
            su: su,
            globalParam: globalVar,
            securityLevelName: securityLevelName
        };
        /** @type {?} */
        var fixedUrl = this.origin + '/api/runtime/dip/v1.0/AllSteps/TemplateDownload';
        this.http.post(fixedUrl, templateParam, {
            headers: {
                'Content-Type': 'application/json',
                'Access-Control-Allow-Origin': '*'
            },
            responseType: 'blob',
            observe: 'response',
            params: { su: su }
        }).subscribe((/**
         * @param {?} res
         * @return {?}
         */
        function (res) {
            console.log(res);
            /** @type {?} */
            var data = res.body;
            if (data.type == 'application/json') {
                /** @type {?} */
                var reader_1 = new FileReader();
                reader_1.onload = (/**
                 * @param {?} e
                 * @return {?}
                 */
                function (e) {
                    /** @type {?} */
                    var responseParam = JSON.parse((/** @type {?} */ (reader_1.result)));
                    if (!responseParam.result) {
                        _this.complete.emit(responseParam.message);
                    }
                });
                reader_1.readAsText(data, 'utf-8');
            }
            else {
                /** @type {?} */
                var fileName = '';
                /** @type {?} */
                var contentDisposition = res.headers.get("content-disposition");
                if (contentDisposition) {
                    // 正则获取filename的值
                    /** @type {?} */
                    var filenameRegex = /filename[^;=\n]*=((['"]).*?\2|[^;\n]*)/;
                    /** @type {?} */
                    var matches = filenameRegex.exec(contentDisposition);
                    if (matches != null && matches[1]) {
                        fileName = matches[1].replace(/['"]/g, '');
                    }
                    // 通过 URLEncoder.encode(pFileName, StandardCharsets.UTF_8.name()) 加密编码的, 使用decodeURI(fileName) 解密
                    fileName = decodeURI(fileName);
                    // 通过 new String(pFileName.getBytes(), StandardCharsets.ISO_8859_1) 加密编码的, 使用decodeURI(escape(fileName)) 解密
                    // fileName = decodeURI(escape(fileName))
                }
                if (!isNullOrUndefined(importOption.templatefilename)) {
                    /** @type {?} */
                    var suffixIndex = fileName.lastIndexOf('.');
                    /** @type {?} */
                    var suffix_1 = fileName.substring(suffixIndex);
                    fileName = importOption.templatefilename + suffix_1;
                }
                /** @type {?} */
                var blob = new Blob([data]);
                if (!data || data.size == 0) {
                    _this.complete.emit('返回的数据为空');
                }
                else {
                    if (navigator.msSaveOrOpenBlob) {
                        navigator.msSaveOrOpenBlob(blob, fileName);
                    }
                    else {
                        /** @type {?} */
                        var link = document.createElement('a');
                        link.setAttribute('href', window.URL.createObjectURL(blob));
                        // 设置下载的文件名
                        link.setAttribute('download', fileName);
                        link.style.visibility = 'hidden';
                        document.body.appendChild(link);
                        link.click();
                        document.body.removeChild(link);
                    }
                    _this.complete.emit('');
                }
            }
        }), (/**
         * @param {?} error
         * @return {?}
         */
        function (error) {
            _this.complete.error(error.error.Message);
        }));
    };
    DataImportService.decorators = [
        { type: Injectable }
    ];
    /** @nocollapse */
    DataImportService.ctorParameters = function () { return [
        { type: BsModalService },
        { type: ComponentFactoryResolver },
        { type: FileOperateService },
        { type: NotifyService },
        { type: HttpClient },
        { type: Injector }
    ]; };
    return DataImportService;
}());
export { DataImportService };
if (false) {
    /**
     * @type {?}
     * @private
     */
    DataImportService.prototype.origin;
    /**
     * @type {?}
     * @private
     */
    DataImportService.prototype.url;
    /** @type {?} */
    DataImportService.prototype.DataIeProgressParams;
    /** @type {?} */
    DataImportService.prototype.complete;
    /** @type {?} */
    DataImportService.prototype.errorlevel;
    /** @type {?} */
    DataImportService.prototype.master_table_noid;
    /** @type {?} */
    DataImportService.prototype.bind_form_error;
    /** @type {?} */
    DataImportService.prototype.validate_result_show;
    /**
     * @type {?}
     * @private
     */
    DataImportService.prototype.modalService;
    /**
     * @type {?}
     * @private
     */
    DataImportService.prototype.resolver;
    /**
     * @type {?}
     * @private
     */
    DataImportService.prototype.operateService;
    /**
     * @type {?}
     * @private
     */
    DataImportService.prototype.notify;
    /**
     * @type {?}
     * @private
     */
    DataImportService.prototype.http;
    /**
     * @type {?}
     * @private
     */
    DataImportService.prototype.injector;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGF0YS1pbXBvcnQuc2VydmljZS5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0Bnc3AtZGlwL2RhdGEtaW1wLWV4cC8iLCJzb3VyY2VzIjpbImxpYi9zZXJ2aWNlL0RhdGFJRVNlcnZpY2UvZGF0YS1pbXBvcnQuc2VydmljZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7O0FBQUEsT0FBTyxFQUFDLHdCQUF3QixFQUFFLFlBQVksRUFBRSxVQUFVLEVBQUUsUUFBUSxFQUFDLE1BQU0sZUFBZSxDQUFDO0FBQzNGLE9BQU8sRUFBQyxjQUFjLEVBQUMsTUFBTSxrQkFBa0IsQ0FBQztBQUloRCxPQUFPLEVBQUMscUJBQXFCLEVBQUMsTUFBTSw2Q0FBNkMsQ0FBQztBQUVsRixPQUFPLEVBQUMsa0JBQWtCLEVBQUMsTUFBTSx3QkFBd0IsQ0FBQztBQUMxRCxPQUFPLEVBQUMsYUFBYSxFQUFDLE1BQU0sbUJBQW1CLENBQUM7QUFDaEQsT0FBTyxFQUFDLFdBQVcsRUFBRSxjQUFjLEVBQUUsYUFBYSxFQUFFLGlCQUFpQixFQUFDLE1BQU0sc0JBQXNCLENBQUM7QUFDbkcsT0FBTyxFQUFDLFVBQVUsRUFBZSxNQUFNLHNCQUFzQixDQUFDO0FBRTlELE9BQU8sRUFBQyxVQUFVLEVBQUMsTUFBTSxtQ0FBbUMsQ0FBQztBQUU3RDtJQWVFLDJCQUNVLFlBQTRCLEVBQzVCLFFBQWtDLEVBQ2xDLGNBQWtDLEVBQ2xDLE1BQXFCLEVBQ3JCLElBQWdCLEVBQ2hCLFFBQWtCO1FBTjVCLGlCQWFDO1FBWlMsaUJBQVksR0FBWixZQUFZLENBQWdCO1FBQzVCLGFBQVEsR0FBUixRQUFRLENBQTBCO1FBQ2xDLG1CQUFjLEdBQWQsY0FBYyxDQUFvQjtRQUNsQyxXQUFNLEdBQU4sTUFBTSxDQUFlO1FBQ3JCLFNBQUksR0FBSixJQUFJLENBQVk7UUFDaEIsYUFBUSxHQUFSLFFBQVEsQ0FBVTtRQW5CcEIsV0FBTSxHQUFHLE1BQU0sQ0FBQyxRQUFRLENBQUMsTUFBTSxDQUFDO1FBQ2hDLFFBQUcs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LGVBQWUsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDO3dCQUM1RCxXQUFXO3dCQUNYLElBQUksQ0FBQyxZQUFZLENBQUMsVUFBVSxFQUFFLFFBQVEsQ0FBQyxDQUFDO3dCQUN4QyxJQUFJLENBQUMsS0FBSyxDQUFDLFVBQVUsR0FBRyxRQUFRLENBQUM7d0JBQ2pDLFFBQVEsQ0FBQyxJQUFJLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBQyxDQUFDO3dCQUNoQyxJQUFJLENBQUMsS0FBSyxFQUFFLENBQUM7d0JBQ2IsUUFBUSxDQUFDLElBQUksQ0FBQyxXQUFXLENBQUMsSUFBSSxDQUFDLENBQUM7cUJBQ2pDO29CQUNELEtBQUksQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDO2lCQUN4QjthQUNGO1FBQ0gsQ0FBQzs7OztRQUFFLFVBQUEsS0FBSztZQUNOLEtBQUksQ0FBQyxRQUFRLENBQUMsS0FBSyxDQUFDLEtBQUssQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLENBQUM7UUFDM0MsQ0FBQyxFQUFDLENBQUM7SUFDTCxDQUFDOztnQkFyZUYsVUFBVTs7OztnQkFiSCxjQUFjO2dCQURkLHdCQUF3QjtnQkFPeEIsa0JBQWtCO2dCQUNsQixhQUFhO2dCQUViLFVBQVU7Z0JBVjBDLFFBQVE7O0lBb2ZwRSx3QkFBQztDQUFBLEFBdGVELElBc2VDO1NBcmVZLGlCQUFpQjs7Ozs7O0lBQzVCLG1DQUF3Qzs7Ozs7SUFDeEMsZ0NBQWdFOztJQUNoRSxpREFFRTs7SUFDRixxQ0FBcUI7O0lBQ3JCLHVDQUF1Qjs7SUFHdkIsOENBQTBCOztJQUMxQiw0Q0FBd0I7O0lBQ3hCLGlEQUE2Qjs7Ozs7SUFHM0IseUNBQW9DOzs7OztJQUNwQyxxQ0FBMEM7Ozs7O0lBQzFDLDJDQUEwQzs7Ozs7SUFDMUMsbUNBQTZCOzs7OztJQUM3QixpQ0FBd0I7Ozs7O0lBQ3hCLHFDQUEwQiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7Q29tcG9uZW50RmFjdG9yeVJlc29sdmVyLCBFdmVudEVtaXR0ZXIsIEluamVjdGFibGUsIEluamVjdG9yfSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHtCc01vZGFsU2VydmljZX0gZnJvbSAnQGZhcnJpcy91aS1tb2RhbCc7XHJcbmltcG9ydCB7UmVwb3NpdG9yeX0gZnJvbSAnQGZhcnJpcy9kZXZraXQnO1xyXG5pbXBvcnQge0JlZlJlcG9zaXRvcnksIEJlZlJlc3RTZXJ2aWNlfSBmcm9tICdAZmFycmlzL2JlZic7XHJcblxyXG5pbXBvcnQge1ZhbGlkYXRlRm9ybUNvbXBvbmVudH0gZnJvbSAnLi4vLi4vdmFsaWRhdGUtZm9ybS92YWxpZGF0ZS1mb3JtLmNvbXBvbmVudCc7XHJcbmltcG9ydCB7RGF0YUlFUmVzdWx0fSBmcm9tICcuLi9FbnRpdHkvRGF0YUlFUmVzdWx0JztcclxuaW1wb3J0IHtGaWxlT3BlcmF0ZVNlcnZpY2V9IGZyb20gJy4vZmlsZS1vcGVyYXRlLnNlcnZpY2UnO1xyXG5pbXBvcnQge05vdGlmeVNlcnZpY2V9IGZyb20gJ0BmYXJyaXMvdWktbm90aWZ5JztcclxuaW1wb3J0IHtEYXRhSUVVdGlscywgZ2V0UXVlcnlTdHJpbmcsIGlzTnVsbE9yRW1wdHksIGlzTnVsbE9yVW5kZWZpbmVkfSBmcm9tICcuLi9VdGlscy9EYXRhSUVVdGlscyc7XHJcbmltcG9ydCB7SHR0cENsaWVudCwgSHR0cFJlc3BvbnNlfSBmcm9tICdAYW5ndWxhci9jb21tb24vaHR0cCc7XHJcbmltcG9ydCB7Q29tbW9uUGFyYW1zfSBmcm9tIFwiLi4vRW50aXR5L0NvbW1vblBhcmFtc1wiO1xyXG5pbXBvcnQge01ldGhvZFR5cGV9IGZyb20gXCIuLi8uLi9tb2RlbC9EYXRhSUVUeXBlL01ldGhvZFR5cGVcIjtcclxuXHJcbkBJbmplY3RhYmxlKClcclxuZXhwb3J0IGNsYXNzIERhdGFJbXBvcnRTZXJ2aWNlIHtcclxuICBwcml2YXRlIG9yaWdpbiA9IHdpbmRvdy5sb2NhdGlvbi5vcmlnaW47XHJcbiAgcHJpdmF0ZSB1cmwgPSB0aGlzLm9yaWdpbiArICcvYXBpL3J1bnRpbWUvcnRjb21tb24vdjEuMC9pbXBvcnQnO1xyXG4gIERhdGFJZVByb2dyZXNzUGFyYW1zID0ge1xyXG4gICAgXCJJbXBvcnRQcm9ncmVzc1ZhbHVlXCI6IDEzXHJcbiAgfTtcclxuICBwdWJsaWMgY29tcGxldGU6IGFueTtcclxuICBwdWJsaWMgZXJyb3JsZXZlbDogYW55O1xyXG4gIC8vIEBPdXRwdXQoKVxyXG4gIC8vIG5lZWREZXN0cm95ID0gbmV3IEV2ZW50RW1pdHRlcigpO1xyXG4gIG1hc3Rlcl90YWJsZV9ub2lkOiBzdHJpbmc7XHJcbiAgYmluZF9mb3JtX2Vycm9yOiBzdHJpbmc7XHJcbiAgdmFsaWRhdGVfcmVzdWx0X3Nob3c6IHN0cmluZztcclxuXHJcbiAgY29uc3RydWN0b3IoXHJcbiAgICBwcml2YXRlIG1vZGFsU2VydmljZTogQnNNb2RhbFNlcnZpY2UsXHJcbiAgICBwcml2YXRlIHJlc29sdmVyOiBDb21wb25lbnRGYWN0b3J5UmVzb2x2ZXIsXHJcbiAgICBwcml2YXRlIG9wZXJhdGVTZXJ2aWNlOiBGaWxlT3BlcmF0ZVNlcnZpY2UsXHJcbiAgICBwcml2YXRlIG5vdGlmeTogTm90aWZ5U2VydmljZSxcclxuICAgIHByaXZhdGUgaHR0cDogSHR0cENsaWVudCxcclxuICAgIHByaXZhdGUgaW5qZWN0b3I6IEluamVjdG9yKSB7XHJcbiAgICB0aGlzLmNvbXBsZXRlID0gbmV3IEV2ZW50RW1pdHRlcigpO1xyXG4gICAgRGF0YUlFVXRpbHMuZ2V0VHJhbnNsYXRlVmFsdWUoaHR0cCkuc3Vic2NyaWJlKHJlcyA9PiB7XHJcbiAgICAgIHRoaXMubWFzdGVyX3RhYmxlX25vaWQgPSByZXNbJ21hc3Rlcl90YWJsZV9ub2lkJ107XHJcbiAgICAgIHRoaXMuYmluZF9mb3JtX2Vycm9yID0gcmVzWydiaW5kX2Zvcm1fZXJyb3InXTtcclxuICAgICAgdGhpcy52YWxpZGF0ZV9yZXN1bHRfc2hvdyA9IHJlc1sndmFsaWRhdGVfcmVzdWx0X3Nob3cnXTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgSW1wb3J0U3ViVGFibGUoY29tbW9uUGFyYW1zOiBDb21tb25QYXJhbXMpIHtcclxuICAgIGNvbnN0IHJ1bGVJZCA9IGNvbW1vblBhcmFtcy5ydWxlSWQ7XHJcbiAgICBjb25zdCBvcHRpb24gPSBjb21tb25QYXJhbXMub3B0aW9uO1xyXG4gICAgY29uc3QgZnJhbWVDb250ZXh0ID0gY29tbW9uUGFyYW1zLmZyYW1lQ29udGV4dDtcclxuICAgIGNvbnN0IG1ldGhvZFR5cGUgPSBjb21tb25QYXJhbXMubWV0aG9kVHlwZTtcclxuICAgIGNvbnN0IHN1ZmZpeCA9IGNvbW1vblBhcmFtcy5zdWZmaXg7XHJcbiAgICBjb25zdCBmaWxlTmFtZSA9IGNvbW1vblBhcmFtcy5maWxlTmFtZTtcclxuICAgIGNvbnN0IGJlZlJlc3RTZXJ2aWNlID0gdGhpcy5nZXRCZWZSZXN0U2VydmljZShmcmFtZUNvbnRleHQucmVwb3NpdG9yeSk7XHJcbiAgICBjb21tb25QYXJhbXMuYmVmUmVzdFNlcnZpY2UgPSBiZWZSZXN0U2VydmljZTtcclxuICAgIGNvbW1vblBhcmFtcy5yZXBvc2l0b3J5ID0gZnJhbWVDb250ZXh0LnJlcG9zaXRvcnk7XHJcbiAgICBsZXQgZ2xvYmFsVmFyID0gJyc7XHJcbiAgICBpZiAob3B0aW9uWydHbG9iYWxQYXJhbSddICE9PSBudWxsICYmIG9wdGlvblsnR2xvYmFsUGFyYW0nXSAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgIGlmICh0eXBlb2YgKG9wdGlvblsnR2xvYmFsUGFyYW0nXSkgPT09ICdvYmplY3QnKSB7XHJcbiAgICAgICAgZ2xvYmFsVmFyID0gSlNPTi5zdHJpbmdpZnkob3B0aW9uWydHbG9iYWxQYXJhbSddKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBnbG9iYWxWYXIgPSBvcHRpb25bJ0dsb2JhbFBhcmFtJ107XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIGxldCBtb2RlbCA9ICcnO1xyXG4gICAgaWYgKG9wdGlvbi5Nb2RlbHMgIT09IHVuZGVmaW5lZCAmJiBvcHRpb24uTW9kZWxzICE9PSBudWxsICYmIG9wdGlvbi5Nb2RlbHMubGVuZ3RoID4gMCkge1xyXG4gICAgICBtb2RlbCA9IEpTT04uc3RyaW5naWZ5KG9wdGlvbi5Nb2RlbHNbMF0pO1xyXG4gICAgfVxyXG4gICAgY29uc3QgbWFpbk9iaklkID0gZnJhbWVDb250ZXh0LmJpbmRpbmdEYXRhLmxpc3QuY3VycmVudElkO1xyXG4gICAgaWYgKGlzTnVsbE9yRW1wdHkobWFpbk9iaklkKSkge1xyXG4gICAgICB0aGlzLm5vdGlmeS5pbmZvKHRoaXMubWFzdGVyX3RhYmxlX25vaWQpO1xyXG4gICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgIC8vIHRoaXMuZXJyb3JsZXZlbCA9ICdJbmZvJztcclxuICAgICAgLy8gdGhpcy5jb21wbGV0ZS5lbWl0KCfmnKrojrflj5bliLDkuLvooahJROWAvO+8jOivt+ehruiupOS4u+ihqOaYr+WQpuacieaVsOaNricpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgY29uc3QgZnVuY0lkID0gZ2V0UXVlcnlTdHJpbmcoJ2Z1bmNJZCcpO1xyXG4gICAgICBjb25zdCBpbXBvcnRQYXJhbSA9IHtcclxuICAgICAgICBib2R5OiB7XHJcbiAgICAgICAgICBkYXRhSW1wb3J0Q29udGV4dDoge1xyXG4gICAgICAgICAgICBSdWxlSWQ6IHJ1bGVJZCxcclxuICAgICAgICAgICAgRmlsZU5hbWU6IGZpbGVOYW1lLFxyXG4gICAgICAgICAgICBNYWluT2JqSWQ6IG1haW5PYmpJZCxcclxuICAgICAgICAgICAgR2xvYmFsUGFyYW06IGdsb2JhbFZhcixcclxuICAgICAgICAgICAgU3VmZml4OiBzdWZmaXgsXHJcbiAgICAgICAgICAgIE1vZGVsOiBtb2RlbCxcclxuICAgICAgICAgICAgZnVuY0lkOiBmdW5jSWQsXHJcbiAgICAgICAgICAgIHNlY3VyaXR5TGV2ZWxOYW1lOiBjb21tb25QYXJhbXMuc2VjdXJpdHlMZXZlbE5hbWUsXHJcbiAgICAgICAgICAgIG1ldGhvZFR5cGU6IG1ldGhvZFR5cGVcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICByZXF1ZXN0SW5mbzogYmVmUmVzdFNlcnZpY2UuYnVpbGRSZXF1ZXN0SW5mbygpXHJcbiAgICAgICAgfVxyXG4gICAgICB9O1xyXG5cclxuICAgICAgY29tbW9uUGFyYW1zLmltcG9ydFBhcmFtID0gaW1wb3J0UGFyYW07XHJcbiAgICAgIGNvbW1vblBhcmFtcy5tYWluT2JqSWQgPSBtYWluT2JqSWQ7XHJcbiAgICAgIHRoaXMuSW1wb3J0KGNvbW1vblBhcmFtcyk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBJbXBvcnRTdWJUYWJsZTRIYW5kQ3JhZnQoY29tbW9uUGFyYW1zOiBDb21tb25QYXJhbXMpIHtcclxuICAgIGNvbnN0IHJ1bGVJZCA9IGNvbW1vblBhcmFtcy5ydWxlSWQ7XHJcbiAgICBjb25zdCBvcHRpb24gPSBjb21tb25QYXJhbXMub3B0aW9uO1xyXG4gICAgY29uc3QgZnJhbWVDb250ZXh0ID0gY29tbW9uUGFyYW1zLmZyYW1lQ29udGV4dDtcclxuICAgIGNvbnN0IHN1ZmZpeCA9IGNvbW1vblBhcmFtcy5zdWZmaXg7XHJcbiAgICBjb25zdCBmaWxlTmFtZSA9IGNvbW1vblBhcmFtcy5maWxlTmFtZTtcclxuICAgIGxldCBnbG9iYWxWYXIgPSAnJztcclxuICAgIGlmIChvcHRpb25bJ0dsb2JhbFBhcmFtJ10gIT09IG51bGwgJiYgb3B0aW9uWydHbG9iYWxQYXJhbSddICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgaWYgKHR5cGVvZiAob3B0aW9uWydHbG9iYWxQYXJhbSddKSA9PT0gJ29iamVjdCcpIHtcclxuICAgICAgICBnbG9iYWxWYXIgPSBKU09OLnN0cmluZ2lmeShvcHRpb25bJ0dsb2JhbFBhcmFtJ10pO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGdsb2JhbFZhciA9IG9wdGlvblsnR2xvYmFsUGFyYW0nXTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgY29uc3QgcmVwb3NpdG9yeSA9IGZyYW1lQ29udGV4dCA9PT0gbnVsbCA/IG51bGwgOiBmcmFtZUNvbnRleHQucmVwb3NpdG9yeTtcclxuICAgIGxldCBtYWluT2JqSWQgPSAnJztcclxuICAgIC8v5omL5bel6KGo5Y2V5LuT5bqT5Li6bnVsbFxyXG4gICAgaWYgKHJlcG9zaXRvcnkgPT09IG51bGwpIHtcclxuICAgICAgaWYgKG9wdGlvblsnbWFpbklkJ10gPT09IHVuZGVmaW5lZCB8fCBvcHRpb25bJ21haW5JZCddID09PSBudWxsIHx8IG9wdGlvblsnbWFpbklkJ10gPT09ICcnKSB7XHJcbiAgICAgICAgdGhpcy5ub3RpZnkuaW5mbyh0aGlzLm1hc3Rlcl90YWJsZV9ub2lkKTtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgbWFpbk9iaklkID0gb3B0aW9uWydtYWluSWQnXTtcclxuICAgICAgfVxyXG4gICAgfSBlbHNlIHsvL+mAmueUqOWvvOWFpVxyXG4gICAgICBpZiAoZnJhbWVDb250ZXh0LmJpbmRpbmdEYXRhLmxpc3QuY3VycmVudElkID09PSAnJyB8fCBmcmFtZUNvbnRleHQuYmluZGluZ0RhdGEubGlzdC5jdXJyZW50SWQgPT09IG51bGwpIHtcclxuICAgICAgICB0aGlzLm5vdGlmeS5pbmZvKHRoaXMubWFzdGVyX3RhYmxlX25vaWQpO1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBtYWluT2JqSWQgPSBmcmFtZUNvbnRleHQuYmluZGluZ0RhdGEubGlzdC5jdXJyZW50SWQ7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIGNvbnN0IGZ1bmNJZCA9IGdldFF1ZXJ5U3RyaW5nKCdmdW5jSWQnKTtcclxuICAgIGNvbnN0IGltcG9ydFBhcmFtID0ge1xyXG4gICAgICBydWxlSWQ6IHJ1bGVJZCxcclxuICAgICAgZmlsZU5hbWU6IGZpbGVOYW1lLFxyXG4gICAgICBtYWluT2JqSWQ6IG1haW5PYmpJZCxcclxuICAgICAgZ2xvYmFsUGFyYW06IGdsb2JhbFZhcixcclxuICAgICAgc3VmZml4OiBzdWZmaXgsXHJcbiAgICAgIGZ1bmNJZDogZnVuY0lkLFxyXG4gICAgICBzZWN1cml0eUxldmVsTmFtZTogY29tbW9uUGFyYW1zLnNlY3VyaXR5TGV2ZWxOYW1lXHJcbiAgICB9O1xyXG5cclxuICAgIGNvbW1vblBhcmFtcy5pbXBvcnRQYXJhbSA9IGltcG9ydFBhcmFtO1xyXG4gICAgY29tbW9uUGFyYW1zLm1haW5PYmpJZCA9IG1haW5PYmpJZDtcclxuICAgIC8vIHRoaXMuSW1wb3J0NEhhbmRDcmFmdChjb21tb25QYXJhbXMpO1xyXG4gIH1cclxuXHJcbiAgSW1wb3J0QnlSdWxlSWQoY29tbW9uUGFyYW1zOiBDb21tb25QYXJhbXMpIHtcclxuICAgIGNvbnN0IHJ1bGVJZCA9IGNvbW1vblBhcmFtcy5ydWxlSWQ7XHJcbiAgICBjb25zdCBvcHRpb24gPSBjb21tb25QYXJhbXMub3B0aW9uO1xyXG4gICAgY29uc3QgcmVwb3NpdG9yeSA9IGNvbW1vblBhcmFtcy5yZXBvc2l0b3J5O1xyXG4gICAgY29uc3Qgc3VmZml4ID0gY29tbW9uUGFyYW1zLnN1ZmZpeDtcclxuICAgIGNvbnN0IGZpbGVOYW1lID0gY29tbW9uUGFyYW1zLmZpbGVOYW1lO1xyXG4gICAgY29uc3QgbWV0aG9kVHlwZSA9IGNvbW1vblBhcmFtcy5tZXRob2RUeXBlO1xyXG4gICAgY29uc3QgYmVmUmVzdFNlcnZpY2UgPSB0aGlzLmdldEJlZlJlc3RTZXJ2aWNlKHJlcG9zaXRvcnkpO1xyXG4gICAgY29tbW9uUGFyYW1zLmJlZlJlc3RTZXJ2aWNlID0gYmVmUmVzdFNlcnZpY2U7XHJcbiAgICBsZXQgZ2xvYmFsVmFyID0gJyc7XHJcbiAgICBpZiAob3B0aW9uWydHbG9iYWxQYXJhbSddICE9PSBudWxsICYmIG9wdGlvblsnR2xvYmFsUGFyYW0nXSAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgIGlmICh0eXBlb2YgKG9wdGlvblsnR2xvYmFsUGFyYW0nXSkgPT09ICdvYmplY3QnKSB7XHJcbiAgICAgICAgZ2xvYmFsVmFyID0gSlNPTi5zdHJpbmdpZnkob3B0aW9uWydHbG9iYWxQYXJhbSddKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBnbG9iYWxWYXIgPSBvcHRpb25bJ0dsb2JhbFBhcmFtJ107XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIGxldCBtb2RlbCA9ICcnO1xyXG4gICAgaWYgKG9wdGlvbi5Nb2RlbHMgIT09IHVuZGVmaW5lZCAmJiBvcHRpb24uTW9kZWxzICE9PSBudWxsICYmIG9wdGlvbi5Nb2RlbHMubGVuZ3RoID4gMCkge1xyXG4gICAgICBtb2RlbCA9IEpTT04uc3RyaW5naWZ5KG9wdGlvbi5Nb2RlbHNbMF0pO1xyXG4gICAgfVxyXG4gICAgY29uc29sZS5sb2coJ2Jhc2VVcmk6ICcgKyBiZWZSZXN0U2VydmljZS5iYXNlVXJpKTtcclxuICAgIGNvbnN0IGZ1bmNJZCA9IGdldFF1ZXJ5U3RyaW5nKCdmdW5jSWQnKTtcclxuXHJcbiAgICBpZiAobWV0aG9kVHlwZSA9PT0gTWV0aG9kVHlwZS5DYXJkRm9ybURhdGFJbXBvcnQpIHtcclxuICAgICAgY29tbW9uUGFyYW1zLm1haW5PYmpJZCA9IG9wdGlvbi5tYWluT2JqSWQ7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBjb21tb25QYXJhbXMubWFpbk9iaklkID0gJyc7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgaW1wb3J0UGFyYW0gPSB7XHJcbiAgICAgIGJvZHk6IHtcclxuICAgICAgICBkYXRhSW1wb3J0Q29udGV4dDoge1xyXG4gICAgICAgICAgUnVsZUlkOiBydWxlSWQsXHJcbiAgICAgICAgICBGaWxlTmFtZTogZmlsZU5hbWUsXHJcbiAgICAgICAgICBHbG9iYWxQYXJhbTogZ2xvYmFsVmFyLFxyXG4gICAgICAgICAgU3VmZml4OiBzdWZmaXgsXHJcbiAgICAgICAgICBNb2RlbDogbW9kZWwsXHJcbiAgICAgICAgICBmdW5jSWQ6IGZ1bmNJZCxcclxuICAgICAgICAgIHNlY3VyaXR5TGV2ZWxOYW1lOiBjb21tb25QYXJhbXMuc2VjdXJpdHlMZXZlbE5hbWUsXHJcbiAgICAgICAgICBtYWluT2JqSWQ6IGNvbW1vblBhcmFtcy5tYWluT2JqSWQsXHJcbiAgICAgICAgICBtZXRob2RUeXBlOiBtZXRob2RUeXBlXHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIGNvbW1vblBhcmFtcy5pbXBvcnRQYXJhbSA9IGltcG9ydFBhcmFtO1xyXG4gICAgdGhpcy5JbXBvcnQoY29tbW9uUGFyYW1zKTtcclxuICB9XHJcblxyXG4gIHB1YmxpYyBJbXBvcnQoY29tbW9uUGFyYW1zOiBDb21tb25QYXJhbXMpIHtcclxuICAgIGNvbnN0IHJlcG9zaXRvcnkgPSBjb21tb25QYXJhbXMucmVwb3NpdG9yeTtcclxuICAgIGNvbnN0IGltcG9ydFBhcmFtID0gY29tbW9uUGFyYW1zLmltcG9ydFBhcmFtO1xyXG4gICAgY29uc3QgYmVmUmVzdFNlcnZpY2UgPSBjb21tb25QYXJhbXMuYmVmUmVzdFNlcnZpY2U7XHJcbiAgICBjb25zdCBtZXRob2RUeXBlID0gY29tbW9uUGFyYW1zLm1ldGhvZFR5cGU7XHJcbiAgICBjb25zdCBzdWJzY3JpYmVyID0gYmVmUmVzdFNlcnZpY2UucmVxdWVzdChgJHtiZWZSZXN0U2VydmljZS5iYXNlVXJpfS9zZXJ2aWNlL2RhdGFpbXBvcnR2bWFjdGlvbmAsICdwdXQnLCBudWxsLCBpbXBvcnRQYXJhbSk7XHJcbiAgICBzdWJzY3JpYmVyLnN1YnNjcmliZShkYXRhID0+IHtcclxuICAgICAgICBjb25zdCBzdSA9IERhdGFJRVV0aWxzLmdldFN1KGJlZlJlc3RTZXJ2aWNlLmJhc2VVcmkpO1xyXG4gICAgICAgIGxldCBpbXBvcnRSZXN1bHQgPSBkYXRhLnJldHVyblZhbHVlIGFzIERhdGFJRVJlc3VsdDtcclxuICAgICAgICBpZiAoaXNOdWxsT3JVbmRlZmluZWQoaW1wb3J0UmVzdWx0KSkge1xyXG4gICAgICAgICAgaW1wb3J0UmVzdWx0ID0gZGF0YSBhcyBEYXRhSUVSZXN1bHQ7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbW1vblBhcmFtcy5zdSA9IHN1O1xyXG4gICAgICAgIGNvbW1vblBhcmFtcy5pbXBvcnRSZXN1bHQgPSBpbXBvcnRSZXN1bHQ7XHJcbiAgICAgICAgaWYgKGltcG9ydFJlc3VsdC5zdWNjZWVkID09PSB0cnVlKSB7XHJcbiAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBpZiAoaW1wb3J0UmVzdWx0LmZvcm1EYXRhICYmIGltcG9ydFJlc3VsdC5mb3JtRGF0YS5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgaW1wb3J0UmVzdWx0LmlzZm9ybSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgaWYobWV0aG9kVHlwZSA9PT0gTWV0aG9kVHlwZS5JbXBvcnRTdWJUYWJsZURldGFpbCl7XHJcbiAgICAgICAgICAgICAgICAvL+WtkOihqOWvvOWFpeihqOWNlVxyXG4gICAgICAgICAgICAgICAgY29uc3QgbmV3RGF0YSA9IGltcG9ydFJlc3VsdC5mb3JtRGF0YVswXTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGN1ckVudGl0eSA9IHJlcG9zaXRvcnkuZW50aXR5Q29sbGVjdGlvbi5nZXRFbnRpdHlCeUlkKGNvbW1vblBhcmFtcy5tYWluT2JqSWQpO1xyXG4gICAgICAgICAgICAgICAgY3VyRW50aXR5LmxvYWQobmV3RGF0YSk7XHJcbiAgICAgICAgICAgICAgfWVsc2UgaWYobWV0aG9kVHlwZSA9PT0gTWV0aG9kVHlwZS5DYXJkRm9ybURhdGFJbXBvcnQpe1xyXG4gICAgICAgICAgICAgICAgLy/ljaHniYflr7zlhaXkuI3otbDmlbDmja7liqDovb3vvIzlr7zlhaXlkb3ku6TlrozmiJDlkI7mnInmm7TmlrDlkb3ku6RcclxuICAgICAgICAgICAgICB9ZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAvL+S4u+S7juihqOWvvOWFpeihqOWNlVxyXG4gICAgICAgICAgICAgICAgY29uc3QgZW50aXRpZXMgPSBbXTtcclxuICAgICAgICAgICAgICAgIGltcG9ydFJlc3VsdC5mb3JtRGF0YS5mb3JFYWNoKChyZGF0YTogYW55KSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgIGNvbnN0IGVudGl0eSA9IHJlcG9zaXRvcnkuYnVpbGRFbnRpdHkocmRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICBlbnRpdGllcy5wdXNoKGVudGl0eSk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIHJlcG9zaXRvcnkuZW50aXR5Q29sbGVjdGlvbi5hZGRFbnRpdGllcyhlbnRpdGllcyk7XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChpbXBvcnRSZXN1bHQudmFsaWRhdGVkUmVzdWx0cyAmJiBpbXBvcnRSZXN1bHQudmFsaWRhdGVkUmVzdWx0cy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgdGhpcy5jb21wbGV0ZS5lbWl0KCfpg6jliIbmlbDmja7lr7zlhaXlrozmiJAnKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICBpZiAoaW1wb3J0UmVzdWx0LmlzZm9ybSA9PSB0cnVlKSB7XHJcbiAgICAgICAgICAgICAgICAvL+atpOWkhOS4uuS8oOmAku+8jOaXoOmcgOWbvemZheWMllxyXG4gICAgICAgICAgICAgICAgdGhpcy5jb21wbGV0ZS5lbWl0KCflr7zlhaXooajljZXmiJDlip8nKTtcclxuICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jb21wbGV0ZS5lbWl0KCcnKTtcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC8vIHRoaXMuY29tcGxldGUuZW1pdCh0cnVlKTtcclxuICAgICAgICAgICAgLy90aGlzLmNvbXBsZXRlLmVtaXQoJycpO1xyXG4gICAgICAgICAgICAvL+WvvOWFpeaIkOWKn+WmguaenOWxleekuuagoemqjOe7k+aenO+8jOWPquiDveaYr+agoemqjOetlueVpeaYr+W/veeVpe+8jOaJgOacieagoemqjOe7k+aenOmDveaYr2Vycm9yXHJcbiAgICAgICAgICAgIHRoaXMuU2hvd1ZhbGlkYXRlZFJlc3VsdChjb21tb25QYXJhbXMpO1xyXG4gICAgICAgICAgICAvLyB0aGlzLm5vdGlmeS5pbmZvKCfmlbDmja7lr7zlhaXmiJDlip8nKTtcclxuICAgICAgICAgICAgLy8gdGhpcy5uZWVkRGVzdHJveS5lbWl0KCk7XHJcbiAgICAgICAgICB9IGNhdGNoIHtcclxuICAgICAgICAgICAgLy8gdGhpcy5jb21wbGV0ZS5lbWl0KGZhbHNlKTtcclxuICAgICAgICAgICAgdGhpcy5jb21wbGV0ZS5lbWl0KGltcG9ydFJlc3VsdC5tZXNzYWdlKTtcclxuICAgICAgICAgICAgdGhpcy5ub3RpZnkuZXJyb3IodGhpcy5iaW5kX2Zvcm1fZXJyb3IpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBjb25zb2xlLmxvZyhpbXBvcnRSZXN1bHQuZXhjZXB0aW9uU291cmNlKTtcclxuICAgICAgICAgIHRoaXMuZXJyb3JsZXZlbCA9IGltcG9ydFJlc3VsdC5lcnJvckxldmVsO1xyXG4gICAgICAgICAgdGhpcy5TaG93VmFsaWRhdGVkUmVzdWx0KGNvbW1vblBhcmFtcyk7XHJcbiAgICAgICAgICAvLyB0aGlzLmNvbXBsZXRlLmVtaXQoaW1wb3J0UmVzdWx0Lm1lc3NhZ2UpO1xyXG4gICAgICAgIH1cclxuICAgICAgfSwgZXJyb3IgPT4ge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGVycm9yKTtcclxuICAgICAgICB0aGlzLmVycm9ybGV2ZWwgPSAnZXJyb3InO1xyXG4gICAgICAgIHRoaXMuY29tcGxldGUuZW1pdChlcnJvci5lcnJvci5NZXNzYWdlKTtcclxuICAgICAgfVxyXG4gICAgKTtcclxuICB9XHJcblxyXG4gIC8vIOaYvuekuuagoemqjOe7k+aenFxyXG4gIHByaXZhdGUgU2hvd1ZhbGlkYXRlZFJlc3VsdChjb21tb25QYXJhbXM6IENvbW1vblBhcmFtcykge1xyXG4gICAgY29uc3QgaW1wb3J0UmVzdWx0ID0gY29tbW9uUGFyYW1zLmltcG9ydFJlc3VsdDtcclxuICAgIGNvbnN0IGxvYWRpbmdQYXJhbSA9IGNvbW1vblBhcmFtcy5sb2FkaW5nUGFyYW07XHJcbiAgICBjb25zdCBiZWZSZXN0U2VydmljZSA9IGNvbW1vblBhcmFtcy5iZWZSZXN0U2VydmljZTtcclxuICAgIGlmIChpbXBvcnRSZXN1bHQudmFsaWRhdGVkUmVzdWx0cyAmJiBpbXBvcnRSZXN1bHQudmFsaWRhdGVkUmVzdWx0cy5sZW5ndGggPiAwKSB7XHJcbiAgICAgIGxvYWRpbmdQYXJhbS5sb2FkaW5nU2VydmljZS5jbGVhckFsbCgpO1xyXG4gICAgICBjb25zdCBjbXBSZWYgPSB0aGlzLkNyZWF0ZVZhbGlkYXRlZENvbXBvbmVudCgpO1xyXG4gICAgICBjbXBSZWYuaW5zdGFuY2UudmFsaWRhdGVSZXN1bHQgPSBpbXBvcnRSZXN1bHQudmFsaWRhdGVkUmVzdWx0cztcclxuICAgICAgY21wUmVmLmluc3RhbmNlLnN1ID0gY29tbW9uUGFyYW1zLnN1O1xyXG4gICAgICBjbXBSZWYuaW5zdGFuY2UuaTE4blJlc291cmNlID0gY29tbW9uUGFyYW1zLmkxOG5SZXNvdXJjZTtcclxuICAgICAgY21wUmVmLmluc3RhbmNlLmxvYWRpbmdQYXJhbSA9IGxvYWRpbmdQYXJhbTtcclxuICAgICAgY29uc3QgdmFsaWRhdGVNb2RhbENvbmZpZyA9IHtcclxuICAgICAgICB0aXRsZTogdGhpcy52YWxpZGF0ZV9yZXN1bHRfc2hvdyxcclxuICAgICAgICB3aWR0aDogOTUwLFxyXG4gICAgICAgIGhlaWdodDogNTUwLFxyXG4gICAgICAgIGJ1dHRvbnM6IGNtcFJlZi5pbnN0YW5jZS5tb2RhbEZvb3RlcixcclxuICAgICAgICBzaG93SGVhZGVyOiB0cnVlLFxyXG4gICAgICAgIHNob3dNYXhCdXR0b246IGZhbHNlLFxyXG4gICAgICAgIHNob3dCdXR0b25zOiB0cnVlXHJcbiAgICAgIH07XHJcblxyXG4gICAgICBjb25zdCBkaWFsb2cgPSB0aGlzLm1vZGFsU2VydmljZS5zaG93KGNtcFJlZiwgdmFsaWRhdGVNb2RhbENvbmZpZyk7XHJcbiAgICAgIC8vMOS7o+ihqOaMiemSruS4reatouaIlljngrnlh7vvvJsx5Luj6KGo5oyJ6ZKu57un57utXHJcbiAgICAgIGxldCBjbG9zZWQgPSAwO1xyXG4gICAgICBkaWFsb2cuZGlhbG9nLmluc3RhbmNlLmNsb3NlZC5zdWJzY3JpYmUoKCkgPT4ge1xyXG4gICAgICAgIGlmIChjbG9zZWQgPT09IDApIHtcclxuICAgICAgICAgIHRoaXMuY29tcGxldGUuZW1pdCgn5qCh6aqM5Lit5q2iJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICAgICAgY21wUmVmLmluc3RhbmNlLmNsb3NlTW9kYWwuc3Vic2NyaWJlKCgpID0+IHtcclxuICAgICAgICBjbG9zZWQgPSAwO1xyXG4gICAgICAgIGRpYWxvZy5jbG9zZSgpO1xyXG4gICAgICB9KTtcclxuICAgICAgY21wUmVmLmluc3RhbmNlLm9rTW9kYWwuc3Vic2NyaWJlKCh2YWxpZGF0ZWRJbmZvTGlzdCkgPT4ge1xyXG4gICAgICAgIGNsb3NlZCA9IDE7XHJcbiAgICAgICAgZGlhbG9nLmNsb3NlKCk7XHJcbiAgICAgICAgbG9hZGluZ1BhcmFtLmxvYWRpbmdTZXJ2aWNlLnNob3cobG9hZGluZ1BhcmFtLmxvYWRpbmdDb25maWcpO1xyXG4gICAgICAgIGNvbW1vblBhcmFtcy5pbXBvcnRQYXJhbS5ib2R5LmRhdGFJbXBvcnRDb250ZXh0Wyd2YWxpZGF0ZWRJbmZvTGlzdCddID0gdmFsaWRhdGVkSW5mb0xpc3Q7XHJcbiAgICAgICAgdGhpcy5JbXBvcnQoY29tbW9uUGFyYW1zKTtcclxuICAgICAgfSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLmNvbXBsZXRlLmVtaXQoaW1wb3J0UmVzdWx0Lm1lc3NhZ2UpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBnZXRCZWZSZXN0U2VydmljZShyZXBvc2l0b3J5OiBSZXBvc2l0b3J5PGFueT4pOiBCZWZSZXN0U2VydmljZSB7XHJcbiAgICBjb25zdCBiZWZSZXBvc2l0b3J5ID0gPEJlZlJlcG9zaXRvcnk8YW55Pj5yZXBvc2l0b3J5O1xyXG4gICAgcmV0dXJuIGJlZlJlcG9zaXRvcnkucmVzdFNlcnZpY2U7XHJcbiAgfVxyXG5cclxuICAvLyDnlJ/miJDmoKHpqoznqpflj6Pnu4Tku7ZcclxuICBwcml2YXRlIENyZWF0ZVZhbGlkYXRlZENvbXBvbmVudCgpIHtcclxuICAgIGNvbnN0IGNvbXBGYWN0b3J5ID0gdGhpcy5yZXNvbHZlci5yZXNvbHZlQ29tcG9uZW50RmFjdG9yeShWYWxpZGF0ZUZvcm1Db21wb25lbnQpO1xyXG4gICAgY29uc3QgY29tUmVmID0gY29tcEZhY3RvcnkuY3JlYXRlKHRoaXMuaW5qZWN0b3IpO1xyXG4gICAgcmV0dXJuIGNvbVJlZjtcclxuICB9XHJcblxyXG4gIEp1ZGdlSWxsZWdhbENoYXIoc3RyOiBzdHJpbmcpOiBib29sZWFuIHtcclxuICAgIGNvbnN0IGlsbGVnYWxDaGFyID0gWyc/JywgJ+OAgScsICdcXFxcJywgJy8nLCAnKicsICdcXCcnLCAnXCInLCAn4oCcJywgJ+KAnScsICc8JywgJz4nLCAnfCcsICcsJ107XHJcbiAgICBpbGxlZ2FsQ2hhci5mb3JFYWNoKGl0ZW0gPT4ge1xyXG4gICAgICBpZiAoc3RyLmluZGV4T2YoaXRlbSkgIT09IC0xKSB7XHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIGZhbHNlO1xyXG4gIH1cclxuXHJcbiAgLy8g5LiL6L295qih5p2/XHJcbiAgRG93bWxvYWRUZW1wbGF0ZShydWxlSWQ6IHN0cmluZywgcmVwb3NpdG9yeTogUmVwb3NpdG9yeTxhbnk+LCBpbXBvcnRPcHRpb246IGFueSwgc3VmZml4OiBhbnkpIHtcclxuICAgIGNvbnN0IGJlZlJlc3RTZXJ2aWNlID0gdGhpcy5nZXRCZWZSZXN0U2VydmljZShyZXBvc2l0b3J5KTtcclxuICAgIGNvbnN0IHByZVVybCA9IERhdGFJRVV0aWxzLkdldFByZVVybChiZWZSZXN0U2VydmljZS5iYXNlVXJpKTtcclxuICAgIGNvbnN0IHRlbXBVcmwgPSBgJHtwcmVVcmx9L2ltcG9ydGA7XHJcbiAgICBsZXQgc3UgPSBEYXRhSUVVdGlscy5nZXRTdSh0ZW1wVXJsKTtcclxuICAgIGlmIChpbXBvcnRPcHRpb25bJ3N1J10gIT09IHVuZGVmaW5lZCAmJiBpbXBvcnRPcHRpb25bJ3N1J10gIT09IG51bGwpIHtcclxuICAgICAgc3UgPSBpbXBvcnRPcHRpb25bJ3N1J107XHJcbiAgICB9XHJcbiAgICBsZXQgc2VjdXJpdHlMZXZlbE5hbWUgPSAnJztcclxuICAgIGlmICghaXNOdWxsT3JVbmRlZmluZWQoaW1wb3J0T3B0aW9uLnNlY3VyaXR5TGV2ZWxOYW1lKSkge1xyXG4gICAgICBzZWN1cml0eUxldmVsTmFtZSA9IGltcG9ydE9wdGlvbi5zZWN1cml0eUxldmVsTmFtZTtcclxuICAgIH1cclxuICAgIGxldCBtb2RlbCA9ICcnO1xyXG4gICAgaWYgKGltcG9ydE9wdGlvbi5Nb2RlbHMgIT09IHVuZGVmaW5lZCAmJiBpbXBvcnRPcHRpb24uTW9kZWxzICE9PSBudWxsICYmIGltcG9ydE9wdGlvbi5Nb2RlbHMubGVuZ3RoID4gMCkge1xyXG4gICAgICBtb2RlbCA9IEpTT04uc3RyaW5naWZ5KGltcG9ydE9wdGlvbi5Nb2RlbHNbMF0pO1xyXG4gICAgfVxyXG4gICAgbGV0IGdsb2JhbFZhciA9ICcnO1xyXG4gICAgaWYgKCFpc051bGxPclVuZGVmaW5lZChpbXBvcnRPcHRpb25bJ0dsb2JhbFBhcmFtJ10pKSB7XHJcbiAgICAgIGlmICh0eXBlb2YgKGltcG9ydE9wdGlvblsnR2xvYmFsUGFyYW0nXSkgPT09ICdvYmplY3QnKSB7XHJcbiAgICAgICAgZ2xvYmFsVmFyID0gSlNPTi5zdHJpbmdpZnkoaW1wb3J0T3B0aW9uWydHbG9iYWxQYXJhbSddKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBnbG9iYWxWYXIgPSBpbXBvcnRPcHRpb25bJ0dsb2JhbFBhcmFtJ107XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIGNvbnN0IHRlbXBsYXRlUGFyYW0gPSB7XHJcbiAgICAgIGJvZHk6IHtcclxuICAgICAgICBydWxlSWQ6IHJ1bGVJZCxcclxuICAgICAgICBzdWZmaXg6IHN1ZmZpeCxcclxuICAgICAgICBzdTogc3UsXHJcbiAgICAgICAgbW9kZWw6IG1vZGVsLFxyXG4gICAgICAgIGdsb2JhbFBhcmFtOiBnbG9iYWxWYXIsXHJcbiAgICAgICAgc2VjdXJpdHlMZXZlbE5hbWU6IHNlY3VyaXR5TGV2ZWxOYW1lXHJcbiAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgY29uc3QgZml4ZWRVcmwgPSB0aGlzLm9yaWdpbiArICcvYXBpL3J1bnRpbWUvZGlwL3YxLjAvcnBjaW1wb3J0JztcclxuICAgIGNvbnN0IHN1YnNjcmliZXIgPSBiZWZSZXN0U2VydmljZS5yZXF1ZXN0KGAke2ZpeGVkVXJsfS9UZW1wbGF0ZURvd25sb2FkYCwgJ3Bvc3QnLCB7c3U6IHN1fSwgdGVtcGxhdGVQYXJhbSk7XHJcbiAgICBzdWJzY3JpYmVyLnN1YnNjcmliZShkYXRhID0+IHtcclxuICAgICAgaWYgKGRhdGFbJ3Jlc3VsdCddID09PSB0cnVlKSB7XHJcbiAgICAgICAgbGV0IGZpbGVuYW1lID0gJyc7XHJcbiAgICAgICAgaWYgKGltcG9ydE9wdGlvblsndGVtcGxhdGVmaWxlbmFtZSddID09PSAnJyB8fCBpbXBvcnRPcHRpb25bJ3RlbXBsYXRlZmlsZW5hbWUnXSA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICBmaWxlbmFtZSA9IGRhdGFbJ2ZpbGVOYW1lJ107XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIGNvbnN0IHN1ZmZpeEluZGV4ID0gZGF0YVsnZmlsZU5hbWUnXS5sYXN0SW5kZXhPZignLicpO1xyXG4gICAgICAgICAgY29uc3QgdGVtcHN1ZmZpeCA9IGRhdGFbJ2ZpbGVOYW1lJ10uc3Vic3RyaW5nKHN1ZmZpeEluZGV4KTtcclxuICAgICAgICAgIGxldCBjdXN0b21OYW1lOiBzdHJpbmcgPSBpbXBvcnRPcHRpb25bJ3RlbXBsYXRlZmlsZW5hbWUnXTtcclxuICAgICAgICAgIGlmICghdGhpcy5KdWRnZUlsbGVnYWxDaGFyKGN1c3RvbU5hbWUpKSB7XHJcbiAgICAgICAgICAgIGlmIChjdXN0b21OYW1lLmluZGV4T2YoJy4nKSAhPT0gLTEpIHtcclxuICAgICAgICAgICAgICBmaWxlbmFtZSA9IGN1c3RvbU5hbWU7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgZmlsZW5hbWUgPSBjdXN0b21OYW1lICsgdGVtcHN1ZmZpeDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgZmlsZW5hbWUgPSBkYXRhWydmaWxlTmFtZSddO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLm9wZXJhdGVTZXJ2aWNlLkRvd25sb2FkRmlsZShkYXRhWydkb2NSZWxhdGl2ZVBhdGgnXSwgZmlsZW5hbWUsIHByZVVybCwgaW1wb3J0T3B0aW9uKTtcclxuICAgICAgICBjb25zdCBzdWJzY3JpcHRpb24gPSB0aGlzLm9wZXJhdGVTZXJ2aWNlLmRvd25sb2FkQ29tcGxldGUuc3Vic2NyaWJlKHJlc3VsdCA9PiB7XHJcbiAgICAgICAgICBpZiAocmVzdWx0ID09PSAnJykge1xyXG4gICAgICAgICAgICB0aGlzLmNvbXBsZXRlLmVtaXQoJycpO1xyXG4gICAgICAgICAgICBzdWJzY3JpcHRpb24udW5zdWJzY3JpYmUoKTtcclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuY29tcGxldGUuZW1pdChyZXN1bHQpO1xyXG4gICAgICAgICAgICBzdWJzY3JpcHRpb24udW5zdWJzY3JpYmUoKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICAvLyB0aGlzLm5vdGlmeS5lcnJvcign5LiL6L295qih5p2/5aSx6LSl77yM5aSx6LSl5L+h5oGv77yaJyArIGRhdGFbJ21lc3NhZ2UnXSk7XHJcbiAgICAgICAgdGhpcy5jb21wbGV0ZS5lbWl0KGRhdGFbJ21lc3NhZ2UnXSk7XHJcbiAgICAgIH1cclxuICAgIH0sIGVycm9yID0+IHtcclxuICAgICAgY29uc29sZS5sb2coZXJyb3IpO1xyXG4gICAgICB0aGlzLmNvbXBsZXRlLmVtaXQoJ+S4i+i9veaooeadv+Wksei0pScpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvLyDkuIvovb3mqKHmnb9cclxuICBEb3dtbG9hZFRlbXBsYXRlNEhhbmRDcmFmdChydWxlSWQ6IHN0cmluZywgaW1wb3J0T3B0aW9uOiBhbnksIHN1ZmZpeDogYW55KSB7XHJcbiAgICBjb25zdCBzdSA9IGltcG9ydE9wdGlvbi5zdTtcclxuICAgIGxldCBnbG9iYWxWYXIgPSAnJztcclxuICAgIGlmIChpbXBvcnRPcHRpb25bJ0dsb2JhbFBhcmFtJ10gIT09IG51bGwgJiYgaW1wb3J0T3B0aW9uWydHbG9iYWxQYXJhbSddICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgaWYgKHR5cGVvZiAoaW1wb3J0T3B0aW9uWydHbG9iYWxQYXJhbSddKSA9PT0gJ29iamVjdCcpIHtcclxuICAgICAgICBnbG9iYWxWYXIgPSBKU09OLnN0cmluZ2lmeShpbXBvcnRPcHRpb25bJ0dsb2JhbFBhcmFtJ10pO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGdsb2JhbFZhciA9IGltcG9ydE9wdGlvblsnR2xvYmFsUGFyYW0nXTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgbGV0IHNlY3VyaXR5TGV2ZWxOYW1lID0gJyc7XHJcbiAgICBpZiAoIWlzTnVsbE9yVW5kZWZpbmVkKGltcG9ydE9wdGlvbi5zZWN1cml0eUxldmVsTmFtZSkpIHtcclxuICAgICAgc2VjdXJpdHlMZXZlbE5hbWUgPSBpbXBvcnRPcHRpb24uc2VjdXJpdHlMZXZlbE5hbWU7XHJcbiAgICB9XHJcbiAgICBjb25zdCB0ZW1wbGF0ZVBhcmFtID0ge1xyXG4gICAgICBydWxlSWQ6IHJ1bGVJZCxcclxuICAgICAgc3VmZml4OiBzdWZmaXgsXHJcbiAgICAgIHN1OiBzdSxcclxuICAgICAgZ2xvYmFsUGFyYW06IGdsb2JhbFZhcixcclxuICAgICAgc2VjdXJpdHlMZXZlbE5hbWU6IHNlY3VyaXR5TGV2ZWxOYW1lXHJcbiAgICB9O1xyXG5cclxuICAgIGNvbnN0IGZpeGVkVXJsID0gdGhpcy5vcmlnaW4gKyAnL2FwaS9ydW50aW1lL2RpcC92MS4wL0FsbFN0ZXBzL1RlbXBsYXRlRG93bmxvYWQnO1xyXG4gICAgdGhpcy5odHRwLnBvc3QoZml4ZWRVcmwsIHRlbXBsYXRlUGFyYW0sXHJcbiAgICAgIHtcclxuICAgICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxyXG4gICAgICAgICAgJ0FjY2Vzcy1Db250cm9sLUFsbG93LU9yaWdpbic6ICcqJ1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgcmVzcG9uc2VUeXBlOiAnYmxvYicsXHJcbiAgICAgICAgb2JzZXJ2ZTogJ3Jlc3BvbnNlJyxcclxuICAgICAgICBwYXJhbXM6IHtzdTogc3V9XHJcbiAgICAgIH0pLnN1YnNjcmliZSgocmVzOiBIdHRwUmVzcG9uc2U8QmxvYj4pID0+IHtcclxuICAgICAgY29uc29sZS5sb2cocmVzKTtcclxuICAgICAgY29uc3QgZGF0YSA9IHJlcy5ib2R5O1xyXG4gICAgICBpZiAoZGF0YS50eXBlID09ICdhcHBsaWNhdGlvbi9qc29uJykge1xyXG4gICAgICAgIGNvbnN0IHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7XHJcbiAgICAgICAgcmVhZGVyLm9ubG9hZCA9IChlKSA9PiB7XHJcbiAgICAgICAgICBjb25zdCByZXNwb25zZVBhcmFtID0gSlNPTi5wYXJzZShyZWFkZXIucmVzdWx0IGFzIHN0cmluZyk7XHJcbiAgICAgICAgICBpZiAoIXJlc3BvbnNlUGFyYW0ucmVzdWx0KSB7XHJcbiAgICAgICAgICAgIHRoaXMuY29tcGxldGUuZW1pdChyZXNwb25zZVBhcmFtLm1lc3NhZ2UpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgcmVhZGVyLnJlYWRBc1RleHQoZGF0YSwgJ3V0Zi04Jyk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgbGV0IGZpbGVOYW1lID0gJyc7XHJcbiAgICAgICAgbGV0IGNvbnRlbnREaXNwb3NpdGlvbiA9IHJlcy5oZWFkZXJzLmdldChcImNvbnRlbnQtZGlzcG9zaXRpb25cIik7XHJcbiAgICAgICAgaWYgKGNvbnRlbnREaXNwb3NpdGlvbikge1xyXG4gICAgICAgICAgLy8g5q2j5YiZ6I635Y+WZmlsZW5hbWXnmoTlgLxcclxuICAgICAgICAgIGxldCBmaWxlbmFtZVJlZ2V4ID0gL2ZpbGVuYW1lW147PVxcbl0qPSgoWydcIl0pLio/XFwyfFteO1xcbl0qKS87XHJcbiAgICAgICAgICBsZXQgbWF0Y2hlcyA9IGZpbGVuYW1lUmVnZXguZXhlYyhjb250ZW50RGlzcG9zaXRpb24pO1xyXG4gICAgICAgICAgaWYgKG1hdGNoZXMgIT0gbnVsbCAmJiBtYXRjaGVzWzFdKSB7XHJcbiAgICAgICAgICAgIGZpbGVOYW1lID0gbWF0Y2hlc1sxXS5yZXBsYWNlKC9bJ1wiXS9nLCAnJyk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICAvLyDpgJrov4cgVVJMRW5jb2Rlci5lbmNvZGUocEZpbGVOYW1lLCBTdGFuZGFyZENoYXJzZXRzLlVURl84Lm5hbWUoKSkg5Yqg5a+G57yW56CB55qELCDkvb/nlKhkZWNvZGVVUkkoZmlsZU5hbWUpIOino+WvhlxyXG4gICAgICAgICAgZmlsZU5hbWUgPSBkZWNvZGVVUkkoZmlsZU5hbWUpO1xyXG4gICAgICAgICAgLy8g6YCa6L+HIG5ldyBTdHJpbmcocEZpbGVOYW1lLmdldEJ5dGVzKCksIFN0YW5kYXJkQ2hhcnNldHMuSVNPXzg4NTlfMSkg5Yqg5a+G57yW56CB55qELCDkvb/nlKhkZWNvZGVVUkkoZXNjYXBlKGZpbGVOYW1lKSkg6Kej5a+GXHJcbiAgICAgICAgICAvLyBmaWxlTmFtZSA9IGRlY29kZVVSSShlc2NhcGUoZmlsZU5hbWUpKVxyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoIWlzTnVsbE9yVW5kZWZpbmVkKGltcG9ydE9wdGlvbi50ZW1wbGF0ZWZpbGVuYW1lKSkge1xyXG4gICAgICAgICAgY29uc3Qgc3VmZml4SW5kZXggPSBmaWxlTmFtZS5sYXN0SW5kZXhPZignLicpO1xyXG4gICAgICAgICAgY29uc3Qgc3VmZml4ID0gZmlsZU5hbWUuc3Vic3RyaW5nKHN1ZmZpeEluZGV4KTtcclxuICAgICAgICAgIGZpbGVOYW1lID0gaW1wb3J0T3B0aW9uLnRlbXBsYXRlZmlsZW5hbWUgKyBzdWZmaXg7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zdCBibG9iID0gbmV3IEJsb2IoW2RhdGFdKTtcclxuICAgICAgICBpZiAoIWRhdGEgfHwgZGF0YS5zaXplID09IDApIHtcclxuICAgICAgICAgIHRoaXMuY29tcGxldGUuZW1pdCgn6L+U5Zue55qE5pWw5o2u5Li656m6Jyk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIGlmIChuYXZpZ2F0b3IubXNTYXZlT3JPcGVuQmxvYikge1xyXG4gICAgICAgICAgICBuYXZpZ2F0b3IubXNTYXZlT3JPcGVuQmxvYihibG9iLCBmaWxlTmFtZSk7XHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBjb25zdCBsaW5rID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpO1xyXG4gICAgICAgICAgICBsaW5rLnNldEF0dHJpYnV0ZSgnaHJlZicsIHdpbmRvdy5VUkwuY3JlYXRlT2JqZWN0VVJMKGJsb2IpKTtcclxuICAgICAgICAgICAgLy8g6K6+572u5LiL6L2955qE5paH5Lu25ZCNXHJcbiAgICAgICAgICAgIGxpbmsuc2V0QXR0cmlidXRlKCdkb3dubG9hZCcsIGZpbGVOYW1lKTtcclxuICAgICAgICAgICAgbGluay5zdHlsZS52aXNpYmlsaXR5ID0gJ2hpZGRlbic7XHJcbiAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQobGluayk7XHJcbiAgICAgICAgICAgIGxpbmsuY2xpY2soKTtcclxuICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZChsaW5rKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIHRoaXMuY29tcGxldGUuZW1pdCgnJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9LCBlcnJvciA9PiB7XHJcbiAgICAgIHRoaXMuY29tcGxldGUuZXJyb3IoZXJyb3IuZXJyb3IuTWVzc2FnZSk7XHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuIl19