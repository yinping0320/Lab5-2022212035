/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Injectable, ComponentFactoryResolver, Injector } from '@angular/core';
import { DataExportService } from './data-export.service';
import { NotifyService } from '@farris/ui-notify';
import { Subject } from 'rxjs';
import { MethodType } from '../../model/DataIEType/MethodType';
import { BsModalService } from '@farris/ui-modal';
import { DataIEUtils, isNullOrEmpty, isNullOrUndefined } from '../Utils/DataIEUtils';
import { HttpClient } from '@angular/common/http';
import { CustomDataIEService } from './custom-data-ie.service';
import { ImportDialogHandcraftComponent } from '../../import-dialog-handcraft/import-dialog-handcraft.component';
import { LoadingService } from "@farris/ui-loading";
import { ExportCustomSelectHandcraftComponent } from "../../export-custom-select-handcraft/export-custom-select-handcraft.component";
import * as i0 from "@angular/core";
import * as i1 from "@farris/ui-modal";
import * as i2 from "./data-export.service";
import * as i3 from "@farris/ui-notify";
import * as i4 from "./custom-data-ie.service";
import * as i5 from "@angular/common/http";
import * as i6 from "@farris/ui-loading";
var DataieHandcraftService = /** @class */ (function () {
    function DataieHandcraftService(resolver, modalService, injector, dataExportService, notify, customIEService, http, loadingService) {
        var _this = this;
        this.resolver = resolver;
        this.modalService = modalService;
        this.injector = injector;
        this.dataExportService = dataExportService;
        this.notify = notify;
        this.customIEService = customIEService;
        this.http = http;
        this.loadingService = loadingService;
        DataIEUtils.getTranslateValue(http).subscribe((/**
         * @param {?} res
         * @return {?}
         */
        function (res) {
            _this.data_import = res['data_import'];
            _this.data_export = res['data_export'];
            _this.export_success = res['export_success'];
            _this.export_fail = res['export_fail'];
            _this.data_export_customfile = res['data_export_customfile'];
            _this.i18nResource = res;
        }));
    }
    /**
     * 通用导出方法
     * @param type
     * @param ruleID
     * @param option
     */
    /**
     * 通用导出方法
     * @param {?} type
     * @param {?} ruleID
     * @param {?} option
     * @return {?}
     */
    DataieHandcraftService.prototype.CommonDataExport = /**
     * 通用导出方法
     * @param {?} type
     * @param {?} ruleID
     * @param {?} option
     * @return {?}
     */
    function (type, ruleID, option) {
        if (type === 1) {
            console.log('执行方法：ExportCurrentListData');
            throw new Error('不支持配置该类型:1');
        }
        else if (type === 2) {
            console.log('执行方法：ExportByModel');
            throw new Error('不支持配置该类型:2');
        }
        else if (type === 3) {
            console.log('执行方法：ExportCurrentChildData');
            // return this.ExportCurrentChildData(ruleID, option);
            throw new Error('不支持配置该类型:3');
        }
        else if (type === 0) {
            console.log('执行方法：ExportByRule');
            return this.ExportByRule(ruleID, option);
        }
        else {
            console.log('执行方法：ExportByRule');
            return this.ExportByRule(ruleID, option);
        }
    };
    /**
     * @param {?} ruleID
     * @param {?} option
     * @return {?}
     */
    DataieHandcraftService.prototype.ExportByRule = /**
     * @param {?} ruleID
     * @param {?} option
     * @return {?}
     */
    function (ruleID, option) {
        /** @type {?} */
        var subject = new Subject();
        this.ExportCommonEntry(ruleID, option, MethodType.CommonExport).subscribe((/**
         * @param {?} s
         * @return {?}
         */
        function (s) {
            subject.next(s);
            subject.complete();
        }));
        return subject;
    };
    /**
     * @param {?} ruleID
     * @param {?} option
     * @return {?}
     */
    DataieHandcraftService.prototype.ExportCurrentChildData = /**
     * @param {?} ruleID
     * @param {?} option
     * @return {?}
     */
    function (ruleID, option) {
        /** @type {?} */
        var subject = new Subject();
        this.ExportCommonEntry(ruleID, option, MethodType.ExportCurrentChildData).subscribe((/**
         * @param {?} s
         * @return {?}
         */
        function (s) {
            subject.next(s);
            subject.complete();
        }));
        return subject;
    };
    /**
     * @private
     * @param {?} ruleID
     * @param {?} option
     * @param {?} methodType
     * @return {?}
     */
    DataieHandcraftService.prototype.ExportCommonEntry = /**
     * @private
     * @param {?} ruleID
     * @param {?} option
     * @param {?} methodType
     * @return {?}
     */
    function (ruleID, option, methodType) {
        var _this = this;
        /** @type {?} */
        var subject = new Subject();
        /** @type {?} */
        var optionJson = this.ParseExportJson(option);
        console.log(optionJson);
        if (isNullOrEmpty(ruleID) && isNullOrEmpty(optionJson.voId)) {
            this.notify.warning("未配置规则id，且无法获取到表单对应的voId，请检查");
            /** @type {?} */
            var res = {
                type: 'close',
                data: null,
                other: null
            };
            subject.next(res);
            return subject;
        }
        if (methodType === MethodType.ExportCurrentChildData) {
            if (isNullOrEmpty(ruleID) && isNullOrEmpty(optionJson.exportChildNodeCode)) {
                //导出子表当规则id为空时，根据vo找规则，必须要求有配置子表节点
                this.notify.warning("规则id为空时，根据Vo查找规则，导出子表必须配置子表节点");
                /** @type {?} */
                var res = {
                    type: 'close',
                    data: null,
                    other: null
                };
                subject.next(res);
                return subject;
            }
        }
        if (isNullOrEmpty(ruleID) || optionJson.enableRuntimeCustom === true) {
            this.StartLoading();
            /** @type {?} */
            var url = '/api/runtime/dip/v1.0/dataIeRuleManage/getRecordRuleInfo';
            /** @type {?} */
            var postBody = {
                body: {
                    ruleId: ruleID,
                    ruleType: 1,
                    voId: optionJson.voId,
                    needModelConvert: optionJson.needModelConvert === true,
                    methodType: methodType,
                    exportChildNodeCode: optionJson.exportChildNodeCode,
                    enableRuntimeCustom: optionJson.enableRuntimeCustom === true
                }
            };
            this.http.post(url, postBody.body).subscribe((/**
             * @param {?} recordRule
             * @return {?}
             */
            function (recordRule) {
                _this.CloseLoading();
                optionJson.voId = recordRule.voId;
                _this.ExportByRuleImpl(ruleID, optionJson, methodType, recordRule).subscribe((/**
                 * @param {?} s
                 * @return {?}
                 */
                function (s) {
                    subject.next(s);
                    subject.complete();
                }));
            }), (/**
             * @param {?} error
             * @return {?}
             */
            function (error) {
                _this.CloseLoading();
                _this.notify.error(error.error.Message);
                console.log(error.error.Message);
                /** @type {?} */
                var res = {
                    type: 'close',
                    data: null,
                    other: error.error.Message
                };
                subject.next(res);
            }));
        }
        else {
            this.ExportByRuleImpl(ruleID, optionJson, methodType).subscribe((/**
             * @param {?} s
             * @return {?}
             */
            function (s) {
                subject.next(s);
                subject.complete();
            }));
        }
        return subject;
    };
    /**
     * @private
     * @param {?} ruleID
     * @param {?} optionJson
     * @param {?} mType
     * @param {?=} recordRule
     * @return {?}
     */
    DataieHandcraftService.prototype.ExportByRuleImpl = /**
     * @private
     * @param {?} ruleID
     * @param {?} optionJson
     * @param {?} mType
     * @param {?=} recordRule
     * @return {?}
     */
    function (ruleID, optionJson, mType, recordRule) {
        var _this = this;
        /** @type {?} */
        var subject = new Subject();
        if (optionJson.customExportTitle !== undefined && optionJson.customExportTitle !== null) {
            if (optionJson.customExportTitle.length > 20) {
                this.notify.warning('自定义标题名称的长度太长');
                /** @type {?} */
                var res = {
                    type: 'close',
                    data: null,
                    other: null
                };
                subject.next(res);
                return subject;
            }
            if (DataIEUtils.JudgeIllegalChar(optionJson.customExportTitle)) {
                this.notify.warning('自定义标题名称存在不合法字符');
                /** @type {?} */
                var res = {
                    type: 'close',
                    data: null,
                    other: null
                };
                subject.next(res);
                return subject;
            }
        }
        if (optionJson.enableRuntimeCustom === true || optionJson.selectfiletype === true) {
            /** @type {?} */
            var compFactory = this.resolver.resolveComponentFactory(ExportCustomSelectHandcraftComponent);
            /** @type {?} */
            var cmpRef = compFactory.create(this.injector);
            cmpRef.instance.ruleId = ruleID;
            cmpRef.instance.exportOption = optionJson;
            cmpRef.instance.recordRule = recordRule;
            cmpRef.instance.subject = subject;
            cmpRef.instance.methodType = MethodType.CommonExport;
            /** @type {?} */
            var title = this.data_export;
            if (optionJson.customExportTitle !== undefined && optionJson.customExportTitle !== null) {
                title = optionJson.customExportTitle;
            }
            /** @type {?} */
            var exportModalConfig = {
                title: title,
                width: 530,
                height: 342,
                buttons: cmpRef.instance.modalFooter,
                showCloseButton: true,
                showMaxButton: false,
                showMinButton: false,
                showButtons: true,
                resizable: false
            };
            /** @type {?} */
            var dialog_1 = this.modalService.show(cmpRef, exportModalConfig);
            dialog_1.dialog.instance.closed.subscribe((/**
             * @return {?}
             */
            function () {
                /** @type {?} */
                var res = {
                    type: 'close',
                    data: null,
                    other: null
                };
                subject.next(res);
            }));
            cmpRef.instance.needDestroy.subscribe((/**
             * @param {?} $event
             * @return {?}
             */
            function ($event) {
                dialog_1.close();
            }));
        }
        else {
            if (!isNullOrUndefined(recordRule) && !isNullOrEmpty(recordRule.ruleId)) {
                ruleID = recordRule.ruleId;
            }
            if (mType == MethodType.CommonExport) {
                this.dataExportService.ExportById4HandCraft(ruleID, optionJson);
            }
            else if (mType == MethodType.ExportCurrentTableData) {
                throw new Error('不支持该类型:ExportCurrentTableData');
            }
            else {
                throw new Error('不支持该类型:ExportCurrentChildData');
            }
            /** @type {?} */
            var unscriber_1 = this.dataExportService.export.subscribe((/**
             * @param {?} data
             * @return {?}
             */
            function (data) {
                if (data === '') {
                    /** @type {?} */
                    var res = {
                        type: 'success',
                        data: null,
                        other: null
                    };
                    subject.next(res);
                    subject.complete();
                }
                else {
                    /** @type {?} */
                    var errorlevel = _this.dataExportService.errorlevel;
                    if (errorlevel === 'Info') {
                        _this.notify.info(data);
                    }
                    else if (errorlevel === 'Warning') {
                        _this.notify.warning(data);
                    }
                    else {
                        _this.notify.error(_this.export_fail + data);
                    }
                    /** @type {?} */
                    var res = {
                        type: 'fail',
                        data: null,
                        other: data
                    };
                    subject.next(res);
                    subject.complete();
                }
                unscriber_1.unsubscribe();
            }), (/**
             * @param {?} error
             * @return {?}
             */
            function (error) {
                _this.notify.error(error.error.Message);
                /** @type {?} */
                var res = {
                    type: 'fail',
                    data: null,
                    other: error.error.Message
                };
                subject.next(res);
                subject.complete();
            }));
        }
        return subject;
    };
    /**
     * 通用导入方法
     * @param type
     * @param ruleID
     * @param option
     */
    /**
     * 通用导入方法
     * @param {?} type
     * @param {?} ruleID
     * @param {?} option
     * @return {?}
     */
    DataieHandcraftService.prototype.CommonDataImport = /**
     * 通用导入方法
     * @param {?} type
     * @param {?} ruleID
     * @param {?} option
     * @return {?}
     */
    function (type, ruleID, option) {
        if (type === 1) {
            console.log('执行方法：ImportSublistData');
            return this.ImportSublistData(ruleID, option);
        }
        else if (type === 2) {
            console.log('执行方法：ImportByModel');
            throw new Error('不支持配置该类型:2');
        }
        else if (type === 0) {
            console.log('执行方法：ImportByRule');
            return this.ImportByRule(ruleID, option);
        }
        else {
            console.log('执行方法：ImportByRule');
            return this.ImportByRule(ruleID, option);
        }
    };
    // 普通导入
    // 普通导入
    /**
     * @param {?} ruleID
     * @param {?} option
     * @return {?}
     */
    DataieHandcraftService.prototype.ImportByRule = 
    // 普通导入
    /**
     * @param {?} ruleID
     * @param {?} option
     * @return {?}
     */
    function (ruleID, option) {
        /** @type {?} */
        var subject = new Subject();
        this.ImportCommonEntry(ruleID, option, MethodType.CommonImport).subscribe((/**
         * @param {?} s
         * @return {?}
         */
        function (s) {
            subject.next(s);
            subject.complete();
        }));
        return subject;
    };
    // 子表导入
    // 子表导入
    /**
     * @param {?} ruleID
     * @param {?} option
     * @return {?}
     */
    DataieHandcraftService.prototype.ImportSublistData = 
    // 子表导入
    /**
     * @param {?} ruleID
     * @param {?} option
     * @return {?}
     */
    function (ruleID, option) {
        /** @type {?} */
        var subject = new Subject();
        this.ImportCommonEntry(ruleID, option, MethodType.ImportSubTableDetail).subscribe((/**
         * @param {?} s
         * @return {?}
         */
        function (s) {
            subject.next(s);
            subject.complete();
        }));
        return subject;
    };
    /**
     * @private
     * @param {?} ruleID
     * @param {?} option
     * @param {?} methodType
     * @return {?}
     */
    DataieHandcraftService.prototype.ImportCommonEntry = /**
     * @private
     * @param {?} ruleID
     * @param {?} option
     * @param {?} methodType
     * @return {?}
     */
    function (ruleID, option, methodType) {
        var _this = this;
        console.log(option);
        /** @type {?} */
        var subject = new Subject();
        /** @type {?} */
        var optionJson = this.ParseImportJson(option);
        /** @type {?} */
        var su = optionJson.su;
        if (methodType === MethodType.ImportSubTableDetail) {
            if (isNullOrEmpty(ruleID) && isNullOrEmpty(optionJson.importChildNodeCode)) {
                //导入子表当规则id为空时，根据vo找规则，必须要求有配置子表节点
                this.notify.warning("规则id为空时，根据模型查找规则，导入子表必须配置子表节点");
                /** @type {?} */
                var res = {
                    type: 'close',
                    data: null,
                    other: null
                };
                subject.next(res);
                return subject;
            }
        }
        this.StartLoading();
        /** @type {?} */
        var url = '/api/runtime/dip/v1.0/dataIeRuleManage/getRecordRuleInfo';
        /** @type {?} */
        var postBody = {
            body: {
                ruleId: ruleID,
                su: su,
                ruleType: 0,
                voId: optionJson.voId,
                needModelConvert: optionJson.needModelConvert === true,
                methodType: methodType,
                importChildNodeCode: optionJson.importChildNodeCode,
                enableRuntimeCustom: optionJson.enableRuntimeCustom === true
            }
        };
        this.http.post(url, postBody.body).subscribe((/**
         * @param {?} recordRule
         * @return {?}
         */
        function (recordRule) {
            _this.CloseLoading();
            optionJson.voId = recordRule.voId;
            _this.ImportByRuleImpl(ruleID, optionJson, methodType, recordRule).subscribe((/**
             * @param {?} s
             * @return {?}
             */
            function (s) {
                subject.next(s);
                subject.complete();
            }));
        }), (/**
         * @param {?} error
         * @return {?}
         */
        function (error) {
            _this.CloseLoading();
            _this.notify.error(error.error.Message);
            console.log(error.error.Message);
            /** @type {?} */
            var res = {
                type: 'close',
                data: null,
                other: error.error.Message
            };
            subject.next(res);
        }));
        return subject;
    };
    /**
     * @private
     * @param {?} ruleID
     * @param {?} optionJson
     * @param {?} methodType
     * @param {?=} recordRule
     * @return {?}
     */
    DataieHandcraftService.prototype.ImportByRuleImpl = /**
     * @private
     * @param {?} ruleID
     * @param {?} optionJson
     * @param {?} methodType
     * @param {?=} recordRule
     * @return {?}
     */
    function (ruleID, optionJson, methodType, recordRule) {
        /** @type {?} */
        var subject = new Subject();
        if (optionJson.customImportTitle !== undefined && optionJson.customImportTitle !== null) {
            if (optionJson.customImportTitle.length > 20) {
                this.notify.warning('自定义标题名称的长度太长');
                /** @type {?} */
                var res = {
                    type: 'close',
                    data: null,
                    other: null
                };
                subject.next(res);
                return subject;
            }
            if (DataIEUtils.JudgeIllegalChar(optionJson.customImportTitle)) {
                this.notify.warning('自定义标题名称存在不合法字符');
                /** @type {?} */
                var res = {
                    type: 'close',
                    data: null,
                    other: null
                };
                subject.next(res);
                return subject;
            }
        }
        /** @type {?} */
        var compFactory = this.resolver.resolveComponentFactory(ImportDialogHandcraftComponent);
        /** @type {?} */
        var cmpRef = compFactory.create(this.injector);
        cmpRef.instance.ruleId = ruleID;
        cmpRef.instance.recordRule = recordRule;
        cmpRef.instance.importOption = optionJson;
        if (methodType == MethodType.CommonImport) {
            cmpRef.instance.methodType = MethodType.CommonImport;
        }
        else {
            cmpRef.instance.methodType = MethodType.ImportSubTableDetail;
        }
        cmpRef.instance.subject = subject;
        /** @type {?} */
        var title = this.data_import;
        if (!isNullOrUndefined(optionJson.customImportTitle)) {
            title = optionJson.customImportTitle;
        }
        /** @type {?} */
        var importModalConfig = {
            title: title,
            width: 530,
            height: 342,
            buttons: cmpRef.instance.modalFooter,
            showCloseButton: true,
            showMaxButton: false,
            showMinButton: false,
            showButtons: true,
            resizable: false
        };
        /** @type {?} */
        var dialog = this.modalService.show(cmpRef, importModalConfig);
        dialog.dialog.instance.closed.subscribe((/**
         * @return {?}
         */
        function () {
            /** @type {?} */
            var res = {
                type: 'close',
                data: null,
                other: null
            };
            subject.next(res);
        }));
        cmpRef.instance.needDestroy.subscribe((/**
         * @param {?} data
         * @return {?}
         */
        function (data) {
            dialog.close();
            /** @type {?} */
            var importResult = (/** @type {?} */ (data));
            if (!isNullOrUndefined(importResult)) {
                /** @type {?} */
                var res = void 0;
                if (importResult.succeed) {
                    res = {
                        type: 'success',
                        data: importResult,
                        other: null
                    };
                }
                else {
                    res = {
                        type: 'fail',
                        data: importResult,
                        other: null
                    };
                }
                subject.next(res);
                subject.complete();
            }
        }));
        return subject;
    };
    /**
     * @private
     * @param {?} option
     * @return {?}
     */
    DataieHandcraftService.prototype.ParseExportJson = /**
     * @private
     * @param {?} option
     * @return {?}
     */
    function (option) {
        if (typeof (option) === 'object') {
            return option;
        }
        if (isNullOrUndefined(option) || isNullOrEmpty(option)) {
            return {};
        }
        /** @type {?} */
        var optionJson = null;
        try {
            optionJson = JSON.parse(option);
        }
        catch (_a) {
            this.notify.warning('传入的参数转换JSON对象异常，已使用默认参数');
            return {};
        }
        if (typeof (optionJson) !== 'object') {
            optionJson = {};
        }
        return optionJson;
    };
    /**
     * @private
     * @param {?} option
     * @return {?}
     */
    DataieHandcraftService.prototype.ParseImportJson = /**
     * @private
     * @param {?} option
     * @return {?}
     */
    function (option) {
        if (typeof (option) === 'object') {
            return option;
        }
        if (isNullOrUndefined(option) || isNullOrEmpty(option)) {
            return {};
        }
        /** @type {?} */
        var optionJson = null;
        try {
            optionJson = JSON.parse(option);
        }
        catch (_a) {
            this.notify.warning('传入的参数转换JSON对象异常，已使用默认参数');
            return {};
        }
        if (typeof (optionJson) !== 'object') {
            optionJson = {};
        }
        /** @type {?} */
        var globalParam = optionJson['globalParam'];
        if (globalParam !== undefined && globalParam !== null) {
            optionJson['GlobalParam'] = globalParam;
        }
        return optionJson;
    };
    /**
     * @return {?}
     */
    DataieHandcraftService.prototype.StartLoading = /**
     * @return {?}
     */
    function () {
        if (this.loadingService !== undefined && this.loadingService !== null) {
            this.loadingService.show();
        }
    };
    /**
     * @return {?}
     */
    DataieHandcraftService.prototype.CloseLoading = /**
     * @return {?}
     */
    function () {
        if (this.loadingService !== undefined && this.loadingService !== null) {
            this.loadingService.clearAll();
        }
    };
    DataieHandcraftService.decorators = [
        { type: Injectable, args: [{
                    providedIn: 'root'
                },] }
    ];
    /** @nocollapse */
    DataieHandcraftService.ctorParameters = function () { return [
        { type: ComponentFactoryResolver },
        { type: BsModalService },
        { type: Injector },
        { type: DataExportService },
        { type: NotifyService },
        { type: CustomDataIEService },
        { type: HttpClient },
        { type: LoadingService }
    ]; };
    /** @nocollapse */ DataieHandcraftService.ngInjectableDef = i0.defineInjectable({ factory: function DataieHandcraftService_Factory() { return new DataieHandcraftService(i0.inject(i0.ComponentFactoryResolver), i0.inject(i1.BsModalService), i0.inject(i0.INJECTOR), i0.inject(i2.DataExportService), i0.inject(i3.NotifyService), i0.inject(i4.CustomDataIEService), i0.inject(i5.HttpClient), i0.inject(i6.LoadingService)); }, token: DataieHandcraftService, providedIn: "root" });
    return DataieHandcraftService;
}());
export { DataieHandcraftService };
if (false) {
    /** @type {?} */
    DataieHandcraftService.prototype.data_import;
    /** @type {?} */
    DataieHandcraftService.prototype.data_export;
    /** @type {?} */
    DataieHandcraftService.prototype.data_export_customfile;
    /** @type {?} */
    DataieHandcraftService.prototype.export_success;
    /** @type {?} */
    DataieHandcraftService.prototype.export_fail;
    /** @type {?} */
    DataieHandcraftService.prototype.i18nResource;
    /**
     * @type {?}
     * @private
     */
    DataieHandcraftService.prototype.resolver;
    /**
     * @type {?}
     * @private
     */
    DataieHandcraftService.prototype.modalService;
    /**
     * @type {?}
     * @private
     */
    DataieHandcraftService.prototype.injector;
    /**
     * @type {?}
     * @private
     */
    DataieHandcraftService.prototype.dataExportService;
    /**
     * @type {?}
     * @private
     */
    DataieHandcraftService.prototype.notify;
    /**
     * @type {?}
     * @private
     */
    DataieHandcraftService.prototype.customIEService;
    /**
     * @type {?}
     * @private
     */
    DataieHandcraftService.prototype.http;
    /**
     * @type {?}
     * @private
     */
    DataieHandcraftService.prototype.loadingService;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGF0YWllLWhhbmRjcmFmdC5zZXJ2aWNlLmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGdzcC1kaXAvZGF0YS1pbXAtZXhwLyIsInNvdXJjZXMiOlsibGliL3NlcnZpY2UvRGF0YUlFU2VydmljZS9kYXRhaWUtaGFuZGNyYWZ0LnNlcnZpY2UudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUFBLE9BQU8sRUFBRSxVQUFVLEVBQUUsd0JBQXdCLEVBQUUsUUFBUSxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBRS9FLE9BQU8sRUFBRSxpQkFBaUIsRUFBRSxNQUFNLHVCQUF1QixDQUFDO0FBQzFELE9BQU8sRUFBRSxhQUFhLEVBQUUsTUFBTSxtQkFBbUIsQ0FBQztBQUNsRCxPQUFPLEVBQUUsT0FBTyxFQUFrQixNQUFNLE1BQU0sQ0FBQztBQUUvQyxPQUFPLEVBQUUsVUFBVSxFQUFFLE1BQU0sbUNBQW1DLENBQUM7QUFDL0QsT0FBTyxFQUFFLGNBQWMsRUFBRSxNQUFNLGtCQUFrQixDQUFDO0FBSWxELE9BQU8sRUFBQyxXQUFXLEVBQUUsYUFBYSxFQUFFLGlCQUFpQixFQUFDLE1BQU0sc0JBQXNCLENBQUM7QUFDbkYsT0FBTyxFQUFFLFVBQVUsRUFBRSxNQUFNLHNCQUFzQixDQUFDO0FBR2xELE9BQU8sRUFBRSxtQkFBbUIsRUFBRSxNQUFNLDBCQUEwQixDQUFDO0FBRy9ELE9BQU8sRUFBRSw4QkFBOEIsRUFBRSxNQUFNLGlFQUFpRSxDQUFDO0FBQ2pILE9BQU8sRUFBQyxjQUFjLEVBQUMsTUFBTSxvQkFBb0IsQ0FBQztBQUNsRCxPQUFPLEVBQUMsb0NBQW9DLEVBQUMsTUFBTSwrRUFBK0UsQ0FBQzs7Ozs7Ozs7QUFFbkk7SUFXRSxnQ0FDVSxRQUFrQyxFQUNsQyxZQUE0QixFQUM1QixRQUFrQixFQUNsQixpQkFBb0MsRUFDcEMsTUFBcUIsRUFDckIsZUFBb0MsRUFDcEMsSUFBZ0IsRUFDaEIsY0FBOEI7UUFSeEMsaUJBa0JDO1FBakJTLGFBQVEsR0FBUixRQUFRLENBQTBCO1FBQ2xDLGlCQUFZLEdBQVosWUFBWSxDQUFnQjtRQUM1QixhQUFRLEdBQVIsUUFBUSxDQUFVO1FBQ2xCLHNCQUFpQixHQUFqQixpQkFBaUIsQ0FBbUI7UUFDcEMsV0FBTSxHQUFOLE1BQU0sQ0FBZTtRQUNyQixvQkFBZSxHQUFmLGVBQWUsQ0FBcUI7UUFDcEMsU0FBSSxHQUFKLElBQUksQ0FBWTtRQUNoQixtQkFBYyxHQUFkLGNBQWMsQ0FBZ0I7UUFFdEMsV0FBVyxDQUFDLGlCQUFpQixDQUFDLElBQUksQ0FBQyxDQUFDLFNBQVM7Ozs7UUFBQyxVQUFBLEdBQUc7WUFDL0MsS0FBSSxDQUFDLFdBQVcsR0FBRyxHQUFHLENBQUMsYUFBYSxDQUFDLENBQUM7WUFDdEMsS0FBSSxDQUFDLFdBQVcsR0FBRyxHQUFHLENBQUMsYUFBYSxDQUFDLENBQUM7WUFDdEMsS0FBSSxDQUFDLGNBQWMsR0FBRyxHQUFHLENBQUMsZ0JBQWdCLENBQUMsQ0FBQztZQUM1QyxLQUFJLENBQUMsV0FBVyxHQUFHLEdBQUcsQ0FBQyxhQUFhLENBQUMsQ0FBQztZQUN0QyxLQUFJLENBQUMsc0JBQXNCLEdBQUcsR0FBRyxDQUFDLHdCQUF3QixDQUFDLENBQUM7WUFDNUQsS0FBSSxDQUFDLFlBQVksR0FBRyxHQUFHLENBQUM7UUFDMUIsQ0FBQyxFQUFDLENBQUE7SUFDSixDQUFDO0lBRUQ7Ozs7O09BS0c7Ozs7Ozs7O0lBQ0ksaURBQWdCOzs7Ozs7O0lBQXZCLFVBQXdCLElBQVMsRUFBRSxNQUFjLEVBQUUsTUFBYztRQUMvRCxJQUFJLElBQUksS0FBSyxDQUFDLEVBQUU7WUFDZCxPQUFPLENBQUMsR0FBRyxDQUFDLDRCQUE0QixDQUFDLENBQUM7WUFDMUMsTUFBTSxJQUFJLEtBQUssQ0FBQyxZQUFZLENBQUMsQ0FBQztTQUMvQjthQUFNLElBQUksSUFBSSxLQUFLLENBQUMsRUFBRTtZQUNyQixPQUFPLENBQUMsR0FBRyxDQUFDLG9CQUFvQixDQUFDLENBQUM7WUFDbEMsTUFBTSxJQUFJLEtBQUssQ0FBQyxZQUFZLENBQUMsQ0FBQztTQUMvQjthQUFNLElBQUksSUFBSSxLQUFLLENBQUMsRUFBRTtZQUNyQixPQUFPLENBQUMsR0FBRyxDQUFDLDZCQUE2QixDQUFDLENBQUM7WUFDM0Msc0RBQXNEO1lBQ3RELE1BQU0sSUFBSSxLQUFLLENBQUMsWUFBWSxDQUFDLENBQUM7U0FDL0I7YUFBTSxJQUFJLElBQUksS0FBSyxDQUFDLEVBQUU7WUFDckIsT0FBTyxDQUFDLEdBQUcsQ0FBQyxtQkFBbUIsQ0FBQyxDQUFDO1lBQ2pDLE9BQU8sSUFBSSxDQUFDLFlBQVksQ0FBQyxNQUFNLEVBQUUsTUFBTSxDQUFDLENBQUM7U0FDMUM7YUFBTTtZQUNMLE9BQU8sQ0FBQyxHQUFHLENBQUMsbUJBQW1CLENBQUMsQ0FBQztZQUNqQyxPQUFPLElBQUksQ0FBQyxZQUFZLENBQUMsTUFBTSxFQUFFLE1BQU0sQ0FBQyxDQUFDO1NBQzFDO0lBQ0gsQ0FBQzs7Ozs7O0lBRU0sNkNBQVk7Ozs7O0lBQW5CLFVBQW9CLE1BQWMsRUFBRSxNQUFXOztZQUN2QyxPQUFPLEdBQUcsSUFBSSxPQUFPLEVBQU87UUFDbEMsSUFBSSxDQUFDLGlCQUFpQixDQUFDLE1BQU0sRUFBRSxNQUFNLEVBQUUsVUFBVSxDQUFDLFlBQVksQ0FBQyxDQUFDLFNBQVM7Ozs7UUFBQyxVQUFBLENBQUM7WUFDekUsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUNoQixPQUFPLENBQUMsUUFBUSxFQUFFLENBQUM7UUFDckIsQ0FBQyxFQUFDLENBQUM7UUFDSCxPQUFPLE9BQU8sQ0FBQztJQUNqQixDQUFDOzs7Ozs7SUFDTSx1REFBc0I7Ozs7O0lBQTdCLFVBQThCLE1BQWMsRUFBRSxNQUFjOztZQUNwRCxPQUFPLEdBQUcsSUFBSSxPQUFPLEVBQU87UUFDbEMsSUFBSSxDQUFDLGlCQUFpQixDQUFDLE1BQU0sRUFBRSxNQUFNLEVBQUUsVUFBVSxDQUFDLHNCQUFzQixDQUFDLENBQUMsU0FBUzs7OztRQUFDLFVBQUEsQ0FBQztZQUNuRixPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBQ2hCLE9BQU8sQ0FBQyxRQUFRLEVBQUUsQ0FBQztRQUNyQixDQUFDLEVBQUMsQ0FBQztRQUNILE9BQU8sT0FBTyxDQUFDO0lBQ2pCLENBQUM7Ozs7Ozs7O0lBQ08sa0RBQWlCOzs7Ozs7O0lBQXpCLFVBQTBCLE1BQWMsRUFBRSxNQUFjLEVBQUUsVUFBc0I7UUFBaEYsaUJBbUVDOztZQWxFTyxPQUFPLEdBQUcsSUFBSSxPQUFPLEVBQU87O1lBQzVCLFVBQVUsR0FBRyxJQUFJLENBQUMsZUFBZSxDQUFDLE1BQU0sQ0FBQztRQUMvQyxPQUFPLENBQUMsR0FBRyxDQUFDLFVBQVUsQ0FBQyxDQUFDO1FBQ3hCLElBQUksYUFBYSxDQUFDLE1BQU0sQ0FBQyxJQUFJLGFBQWEsQ0FBQyxVQUFVLENBQUMsSUFBSSxDQUFDLEVBQUU7WUFDM0QsSUFBSSxDQUFDLE1BQU0sQ0FBQyxPQUFPLENBQUMsNkJBQTZCLENBQUMsQ0FBQzs7Z0JBQzdDLEdBQUcsR0FBRztnQkFDVixJQUFJLEVBQUUsT0FBTztnQkFDYixJQUFJLEVBQUUsSUFBSTtnQkFDVixLQUFLLEVBQUUsSUFBSTthQUNaO1lBQ0QsT0FBTyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQztZQUNsQixPQUFPLE9BQU8sQ0FBQztTQUNoQjtRQUNELElBQUksVUFBVSxLQUFLLFVBQVUsQ0FBQyxzQkFBc0IsRUFBRTtZQUNwRCxJQUFJLGFBQWEsQ0FBQyxNQUFNLENBQUMsSUFBSSxhQUFhLENBQUMsVUFBVSxDQUFDLG1CQUFtQixDQUFDLEVBQUU7Z0JBQzFFLGtDQUFrQztnQkFDbEMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxPQUFPLENBQUMsK0JBQStCLENBQUMsQ0FBQzs7b0JBQy9DLEdBQUcsR0FBRztvQkFDVixJQUFJLEVBQUUsT0FBTztvQkFDYixJQUFJLEVBQUUsSUFBSTtvQkFDVixLQUFLLEVBQUUsSUFBSTtpQkFDWjtnQkFDRCxPQUFPLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDO2dCQUNsQixPQUFPLE9BQU8sQ0FBQzthQUNoQjtTQUNGO1FBQ0QsSUFBSSxhQUFhLENBQUMsTUFBTSxDQUFDLElBQUksVUFBVSxDQUFDLG1CQUFtQixLQUFLLElBQUksRUFBRTtZQUNwRSxJQUFJLENBQUMsWUFBWSxFQUFFLENBQUM7O2dCQUNkLEdBQUcsR0FBRywwREFBMEQ7O2dCQUNoRSxRQUFRLEdBQUc7Z0JBQ2YsSUFBSSxFQUFFO29CQUNKLE1BQU0sRUFBRSxNQUFNO29CQUNkLFFBQVEsRUFBRSxDQUFDO29CQUNYLElBQUksRUFBRSxVQUFVLENBQUMsSUFBSTtvQkFDckIsZ0JBQWdCLEVBQUUsVUFBVSxDQUFDLGdCQUFnQixLQUFLLElBQUk7b0JBQ3RELFVBQVUsRUFBRSxVQUFVO29CQUN0QixtQkFBbUIsRUFBRSxVQUFVLENBQUMsbUJBQW1CO29CQUNuRCxtQkFBbUIsRUFBRSxVQUFVLENBQUMsbUJBQW1CLEtBQUssSUFBSTtpQkFDN0Q7YUFDRjtZQUVELElBQUksQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLEdBQUcsRUFBRSxRQUFRLENBQUMsSUFBSSxDQUFDLENBQUMsU0FBUzs7OztZQUFDLFVBQUMsVUFBYztnQkFDMUQsS0FBSSxDQUFDLFlBQVksRUFBRSxDQUFDO2dCQUNwQixVQUFVLENBQUMsSUFBSSxHQUFHLFVBQVUsQ0FBQyxJQUFJLENBQUM7Z0JBQ2xDLEtBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxNQUFNLEVBQUUsVUFBVSxFQUFFLFVBQVUsRUFBRSxVQUFVLENBQUMsQ0FBQyxTQUFTOzs7O2dCQUFDLFVBQUEsQ0FBQztvQkFDM0UsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQztvQkFDaEIsT0FBTyxDQUFDLFFBQVEsRUFBRSxDQUFDO2dCQUNyQixDQUFDLEVBQUMsQ0FBQztZQUNMLENBQUM7Ozs7WUFBRSxVQUFBLEtBQUs7Z0JBQ04sS0FBSSxDQUFDLFlBQVksRUFBRSxDQUFDO2dCQUNwQixLQUFJLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxDQUFDO2dCQUN2QyxPQUFPLENBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLENBQUM7O29CQUMzQixHQUFHLEdBQUc7b0JBQ1YsSUFBSSxFQUFFLE9BQU87b0JBQ2IsSUFBSSxFQUFFLElBQUk7b0JBQ1YsS0FBSyxFQUFFLEtBQUssQ0FBQyxLQUFLLENBQUMsT0FBTztpQkFDM0I7Z0JBQ0QsT0FBTyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQztZQUNwQixDQUFDLEVBQUMsQ0FBQztTQUNKO2FBQU07WUFDTCxJQUFJLENBQUMsZ0JBQWdCLENBQUMsTUFBTSxFQUFFLFVBQVUsRUFBRSxVQUFVLENBQUMsQ0FBQyxTQUFTOzs7O1lBQUMsVUFBQSxDQUFDO2dCQUMvRCxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDO2dCQUNoQixPQUFPLENBQUMsUUFBUSxFQUFFLENBQUM7WUFDckIsQ0FBQyxFQUFDLENBQUM7U0FDSjtRQUNELE9BQU8sT0FBTyxDQUFDO0lBQ2pCLENBQUM7Ozs7Ozs7OztJQUVPLGlEQUFnQjs7Ozs7Ozs7SUFBeEIsVUFBeUIsTUFBYyxFQUFFLFVBQWUsRUFBRSxLQUFpQixFQUFFLFVBQWdCO1FBQTdGLGlCQThHQzs7WUE3R08sT0FBTyxHQUFHLElBQUksT0FBTyxFQUFPO1FBQ2xDLElBQUksVUFBVSxDQUFDLGlCQUFpQixLQUFLLFNBQVMsSUFBSSxVQUFVLENBQUMsaUJBQWlCLEtBQUssSUFBSSxFQUFFO1lBQ3ZGLElBQUksVUFBVSxDQUFDLGlCQUFpQixDQUFDLE1BQU0sR0FBRyxFQUFFLEVBQUU7Z0JBQzVDLElBQUksQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLGNBQWMsQ0FBQyxDQUFDOztvQkFDOUIsR0FBRyxHQUFHO29CQUNWLElBQUksRUFBRSxPQUFPO29CQUNiLElBQUksRUFBRSxJQUFJO29CQUNWLEtBQUssRUFBRSxJQUFJO2lCQUNaO2dCQUNELE9BQU8sQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUM7Z0JBQ2xCLE9BQU8sT0FBTyxDQUFDO2FBQ2hCO1lBQ0QsSUFBSSxXQUFXLENBQUMsZ0JBQWdCLENBQUMsVUFBVSxDQUFDLGlCQUFpQixDQUFDLEVBQUU7Z0JBQzlELElBQUksQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLGdCQUFnQixDQUFDLENBQUM7O29CQUNoQyxHQUFHLEdBQUc7b0JBQ1YsSUFBSSxFQUFFLE9BQU87b0JBQ2IsSUFBSSxFQUFFLElBQUk7b0JBQ1YsS0FBSyxFQUFFLElBQUk7aUJBQ1o7Z0JBQ0QsT0FBTyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQztnQkFDbEIsT0FBTyxPQUFPLENBQUM7YUFDaEI7U0FDRjtRQUVELElBQUksVUFBVSxDQUFDLG1CQUFtQixLQUFLLElBQUksSUFBSSxVQUFVLENBQUMsY0FBYyxLQUFLLElBQUksRUFBRTs7Z0JBQzNFLFdBQVcsR0FBRyxJQUFJLENBQUMsUUFBUSxDQUFDLHVCQUF1QixDQUFDLG9DQUFvQyxDQUFDOztnQkFDekYsTUFBTSxHQUFHLFdBQVcsQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQztZQUNoRCxNQUFNLENBQUMsUUFBUSxDQUFDLE1BQU0sR0FBRyxNQUFNLENBQUM7WUFDaEMsTUFBTSxDQUFDLFFBQVEsQ0FBQyxZQUFZLEdBQUcsVUFBVSxDQUFDO1lBQzFDLE1BQU0sQ0FBQyxRQUFRLENBQUMsVUFBVSxHQUFHLFVBQVUsQ0FBQztZQUN4QyxNQUFNLENBQUMsUUFBUSxDQUFDLE9BQU8sR0FBRyxPQUFPLENBQUM7WUFDbEMsTUFBTSxDQUFDLFFBQVEsQ0FBQyxVQUFVLEdBQUcsVUFBVSxDQUFDLFlBQVksQ0FBQzs7Z0JBQ2pELEtBQUssR0FBRyxJQUFJLENBQUMsV0FBVztZQUM1QixJQUFJLFVBQVUsQ0FBQyxpQkFBaUIsS0FBSyxTQUFTLElBQUksVUFBVSxDQUFDLGlCQUFpQixLQUFLLElBQUksRUFBRTtnQkFDdkYsS0FBSyxHQUFHLFVBQVUsQ0FBQyxpQkFBaUIsQ0FBQzthQUN0Qzs7Z0JBQ0ssaUJBQWlCLEdBQUc7Z0JBQ3hCLEtBQUssRUFBRSxLQUFLO2dCQUNaLEtBQUssRUFBRSxHQUFHO2dCQUNWLE1BQU0sRUFBRSxHQUFHO2dCQUNYLE9BQU8sRUFBRSxNQUFNLENBQUMsUUFBUSxDQUFDLFdBQVc7Z0JBQ3BDLGVBQWUsRUFBRSxJQUFJO2dCQUNyQixhQUFhLEVBQUUsS0FBSztnQkFDcEIsYUFBYSxFQUFFLEtBQUs7Z0JBQ3BCLFdBQVcsRUFBRSxJQUFJO2dCQUNqQixTQUFTLEVBQUUsS0FBSzthQUNqQjs7Z0JBQ0ssUUFBTSxHQUFHLElBQUksQ0FBQyxZQUFZLENBQUMsSUFBSSxDQUFDLE1BQU0sRUFBRSxpQkFBaUIsQ0FBQztZQUNoRSxRQUFNLENBQUMsTUFBTSxDQUFDLFFBQVEsQ0FBQyxNQUFNLENBQUMsU0FBUzs7O1lBQUM7O29CQUNoQyxHQUFHLEdBQUc7b0JBQ1YsSUFBSSxFQUFFLE9BQU87b0JBQ2IsSUFBSSxFQUFFLElBQUk7b0JBQ1YsS0FBSyxFQUFFLElBQUk7aUJBQ1o7Z0JBQ0QsT0FBTyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQztZQUNwQixDQUFDLEVBQUMsQ0FBQztZQUNILE1BQU0sQ0FBQyxRQUFRLENBQUMsV0FBVyxDQUFDLFNBQVM7Ozs7WUFBQyxVQUFBLE1BQU07Z0JBQzFDLFFBQU0sQ0FBQyxLQUFLLEVBQUUsQ0FBQztZQUNqQixDQUFDLEVBQUMsQ0FBQztTQUNKO2FBQU07WUFDTCxJQUFJLENBQUMsaUJBQWlCLENBQUMsVUFBVSxDQUFDLElBQUksQ0FBQyxhQUFhLENBQUMsVUFBVSxDQUFDLE1BQU0sQ0FBQyxFQUFFO2dCQUN2RSxNQUFNLEdBQUcsVUFBVSxDQUFDLE1BQU0sQ0FBQzthQUM1QjtZQUNELElBQUksS0FBSyxJQUFJLFVBQVUsQ0FBQyxZQUFZLEVBQUU7Z0JBQ3BDLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxvQkFBb0IsQ0FBQyxNQUFNLEVBQUcsVUFBVSxDQUFDLENBQUM7YUFDbEU7aUJBQU0sSUFBSSxLQUFLLElBQUksVUFBVSxDQUFDLHNCQUFzQixFQUFDO2dCQUNwRCxNQUFNLElBQUksS0FBSyxDQUFDLCtCQUErQixDQUFDLENBQUM7YUFDbEQ7aUJBQUk7Z0JBQ0gsTUFBTSxJQUFJLEtBQUssQ0FBQywrQkFBK0IsQ0FBQyxDQUFDO2FBQ2xEOztnQkFDSyxXQUFTLEdBQUcsSUFBSSxDQUFDLGlCQUFpQixDQUFDLE1BQU0sQ0FBQyxTQUFTOzs7O1lBQUMsVUFBQSxJQUFJO2dCQUM1RCxJQUFJLElBQUksS0FBSyxFQUFFLEVBQUU7O3dCQUNULEdBQUcsR0FBRzt3QkFDVixJQUFJLEVBQUUsU0FBUzt3QkFDZixJQUFJLEVBQUUsSUFBSTt3QkFDVixLQUFLLEVBQUUsSUFBSTtxQkFDWjtvQkFDRCxPQUFPLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDO29CQUNsQixPQUFPLENBQUMsUUFBUSxFQUFFLENBQUM7aUJBQ3BCO3FCQUFNOzt3QkFDQyxVQUFVLEdBQUcsS0FBSSxDQUFDLGlCQUFpQixDQUFDLFVBQVU7b0JBQ3BELElBQUksVUFBVSxLQUFLLE1BQU0sRUFBRTt3QkFDekIsS0FBSSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7cUJBQ3hCO3lCQUFNLElBQUksVUFBVSxLQUFLLFNBQVMsRUFBRTt3QkFDbkMsS0FBSSxDQUFDLE1BQU0sQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUM7cUJBQzNCO3lCQUFNO3dCQUNMLEtBQUksQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLEtBQUksQ0FBQyxXQUFXLEdBQUcsSUFBSSxDQUFDLENBQUM7cUJBQzVDOzt3QkFDSyxHQUFHLEdBQUc7d0JBQ1YsSUFBSSxFQUFFLE1BQU07d0JBQ1osSUFBSSxFQUFFLElBQUk7d0JBQ1YsS0FBSyxFQUFFLElBQUk7cUJBQ1o7b0JBQ0QsT0FBTyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQztvQkFDbEIsT0FBTyxDQUFDLFFBQVEsRUFBRSxDQUFDO2lCQUNwQjtnQkFDRCxXQUFTLENBQUMsV0FBVyxFQUFFLENBQUM7WUFDMUIsQ0FBQzs7OztZQUFFLFVBQUEsS0FBSztnQkFDTixLQUFJLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxDQUFDOztvQkFDakMsR0FBRyxHQUFHO29CQUNWLElBQUksRUFBRSxNQUFNO29CQUNaLElBQUksRUFBRSxJQUFJO29CQUNWLEtBQUssRUFBRSxLQUFLLENBQUMsS0FBSyxDQUFDLE9BQU87aUJBQzNCO2dCQUNELE9BQU8sQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUM7Z0JBQ2xCLE9BQU8sQ0FBQyxRQUFRLEVBQUUsQ0FBQztZQUNyQixDQUFDLEVBQUM7U0FDSDtRQUNELE9BQU8sT0FBTyxDQUFDO0lBQ2pCLENBQUM7SUFPRDs7Ozs7T0FLRzs7Ozs7Ozs7SUFDSSxpREFBZ0I7Ozs7Ozs7SUFBdkIsVUFBd0IsSUFBUyxFQUFFLE1BQWMsRUFBRSxNQUFjO1FBQy9ELElBQUksSUFBSSxLQUFLLENBQUMsRUFBRTtZQUNkLE9BQU8sQ0FBQyxHQUFHLENBQUMsd0JBQXdCLENBQUMsQ0FBQztZQUN0QyxPQUFPLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxNQUFNLEVBQUUsTUFBTSxDQUFDLENBQUM7U0FDL0M7YUFBTSxJQUFJLElBQUksS0FBSyxDQUFDLEVBQUU7WUFDckIsT0FBTyxDQUFDLEdBQUcsQ0FBQyxvQkFBb0IsQ0FBQyxDQUFDO1lBQ2xDLE1BQU0sSUFBSSxLQUFLLENBQUMsWUFBWSxDQUFDLENBQUM7U0FDL0I7YUFBTSxJQUFJLElBQUksS0FBSyxDQUFDLEVBQUU7WUFDckIsT0FBTyxDQUFDLEdBQUcsQ0FBQyxtQkFBbUIsQ0FBQyxDQUFDO1lBQ2pDLE9BQU8sSUFBSSxDQUFDLFlBQVksQ0FBQyxNQUFNLEVBQUUsTUFBTSxDQUFDLENBQUM7U0FDMUM7YUFBTTtZQUNMLE9BQU8sQ0FBQyxHQUFHLENBQUMsbUJBQW1CLENBQUMsQ0FBQztZQUNqQyxPQUFPLElBQUksQ0FBQyxZQUFZLENBQUMsTUFBTSxFQUFFLE1BQU0sQ0FBQyxDQUFDO1NBQzFDO0lBQ0gsQ0FBQztJQUNELE9BQU87Ozs7Ozs7SUFDQSw2Q0FBWTs7Ozs7OztJQUFuQixVQUFvQixNQUFjLEVBQUUsTUFBVzs7WUFDdkMsT0FBTyxHQUFHLElBQUksT0FBTyxFQUFPO1FBQ2xDLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxNQUFNLEVBQUUsTUFBTSxFQUFFLFVBQVUsQ0FBQyxZQUFZLENBQUMsQ0FBQyxTQUFTOzs7O1FBQUMsVUFBQSxDQUFDO1lBQ3pFLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDaEIsT0FBTyxDQUFDLFFBQVEsRUFBRSxDQUFDO1FBQ3JCLENBQUMsRUFBQyxDQUFDO1FBQ0gsT0FBTyxPQUFPLENBQUM7SUFDakIsQ0FBQztJQUNELE9BQU87Ozs7Ozs7SUFDQSxrREFBaUI7Ozs7Ozs7SUFBeEIsVUFBeUIsTUFBYyxFQUFFLE1BQVc7O1lBQzVDLE9BQU8sR0FBRyxJQUFJLE9BQU8sRUFBTztRQUNsQyxJQUFJLENBQUMsaUJBQWlCLENBQUMsTUFBTSxFQUFFLE1BQU0sRUFBRSxVQUFVLENBQUMsb0JBQW9CLENBQUMsQ0FBQyxTQUFTOzs7O1FBQUMsVUFBQSxDQUFDO1lBQ2pGLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDaEIsT0FBTyxDQUFDLFFBQVEsRUFBRSxDQUFDO1FBQ3JCLENBQUMsRUFBQyxDQUFDO1FBQ0gsT0FBTyxPQUFPLENBQUM7SUFDakIsQ0FBQzs7Ozs7Ozs7SUFDTyxrREFBaUI7Ozs7Ozs7SUFBekIsVUFBMEIsTUFBYyxFQUFFLE1BQWMsRUFBRSxVQUFzQjtRQUFoRixpQkFtREM7UUFsREMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxNQUFNLENBQUMsQ0FBQzs7WUFDZCxPQUFPLEdBQUcsSUFBSSxPQUFPLEVBQU87O1lBQzVCLFVBQVUsR0FBRyxJQUFJLENBQUMsZUFBZSxDQUFDLE1BQU0sQ0FBQzs7WUFDekMsRUFBRSxHQUFHLFVBQVUsQ0FBQyxFQUFFO1FBQ3hCLElBQUksVUFBVSxLQUFLLFVBQVUsQ0FBQyxvQkFBb0IsRUFBRTtZQUNsRCxJQUFJLGFBQWEsQ0FBQyxNQUFNLENBQUMsSUFBSSxhQUFhLENBQUMsVUFBVSxDQUFDLG1CQUFtQixDQUFDLEVBQUU7Z0JBQzFFLGtDQUFrQztnQkFDbEMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxPQUFPLENBQUMsK0JBQStCLENBQUMsQ0FBQzs7b0JBQy9DLEdBQUcsR0FBRztvQkFDVixJQUFJLEVBQUUsT0FBTztvQkFDYixJQUFJLEVBQUUsSUFBSTtvQkFDVixLQUFLLEVBQUUsSUFBSTtpQkFDWjtnQkFDRCxPQUFPLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDO2dCQUNsQixPQUFPLE9BQU8sQ0FBQzthQUNoQjtTQUNGO1FBQ0QsSUFBSSxDQUFDLFlBQVksRUFBRSxDQUFDOztZQUNkLEdBQUcsR0FBRywwREFBMEQ7O1lBQ2hFLFFBQVEsR0FBRztZQUNmLElBQUksRUFBRTtnQkFDSixNQUFNLEVBQUUsTUFBTTtnQkFDZCxFQUFFLEVBQUUsRUFBRTtnQkFDTixRQUFRLEVBQUUsQ0FBQztnQkFDWCxJQUFJLEVBQUUsVUFBVSxDQUFDLElBQUk7Z0JBQ3JCLGdCQUFnQixFQUFFLFVBQVUsQ0FBQyxnQkFBZ0IsS0FBSyxJQUFJO2dCQUN0RCxVQUFVLEVBQUUsVUFBVTtnQkFDdEIsbUJBQW1CLEVBQUUsVUFBVSxDQUFDLG1CQUFtQjtnQkFDbkQsbUJBQW1CLEVBQUUsVUFBVSxDQUFDLG1CQUFtQixLQUFLLElBQUk7YUFDN0Q7U0FDRjtRQUNELElBQUksQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLEdBQUcsRUFBRSxRQUFRLENBQUMsSUFBSSxDQUFDLENBQUMsU0FBUzs7OztRQUFDLFVBQUMsVUFBYztZQUMxRCxLQUFJLENBQUMsWUFBWSxFQUFFLENBQUM7WUFDcEIsVUFBVSxDQUFDLElBQUksR0FBRyxVQUFVLENBQUMsSUFBSSxDQUFDO1lBQ2xDLEtBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxNQUFNLEVBQUUsVUFBVSxFQUFFLFVBQVUsRUFBRSxVQUFVLENBQUMsQ0FBQyxTQUFTOzs7O1lBQUMsVUFBQSxDQUFDO2dCQUMzRSxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDO2dCQUNoQixPQUFPLENBQUMsUUFBUSxFQUFFLENBQUM7WUFDckIsQ0FBQyxFQUFDLENBQUM7UUFDTCxDQUFDOzs7O1FBQUUsVUFBQSxLQUFLO1lBQ04sS0FBSSxDQUFDLFlBQVksRUFBRSxDQUFDO1lBQ3BCLEtBQUksQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLEtBQUssQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLENBQUM7WUFDdkMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxDQUFDOztnQkFDM0IsR0FBRyxHQUFHO2dCQUNWLElBQUksRUFBRSxPQUFPO2dCQUNiLElBQUksRUFBRSxJQUFJO2dCQUNWLEtBQUssRUFBRSxLQUFLLENBQUMsS0FBSyxDQUFDLE9BQU87YUFDM0I7WUFDRCxPQUFPLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDO1FBQ3BCLENBQUMsRUFBQyxDQUFDO1FBQ0gsT0FBTyxPQUFPLENBQUM7SUFDakIsQ0FBQzs7Ozs7Ozs7O0lBQ08saURBQWdCOzs7Ozs7OztJQUF4QixVQUF5QixNQUFjLEVBQUUsVUFBZSxFQUFFLFVBQXNCLEVBQUUsVUFBZ0I7O1lBQzFGLE9BQU8sR0FBRyxJQUFJLE9BQU8sRUFBTztRQUNsQyxJQUFJLFVBQVUsQ0FBQyxpQkFBaUIsS0FBSyxTQUFTLElBQUksVUFBVSxDQUFDLGlCQUFpQixLQUFLLElBQUksRUFBRTtZQUN2RixJQUFJLFVBQVUsQ0FBQyxpQkFBaUIsQ0FBQyxNQUFNLEdBQUcsRUFBRSxFQUFFO2dCQUM1QyxJQUFJLENBQUMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxjQUFjLENBQUMsQ0FBQzs7b0JBQzlCLEdBQUcsR0FBRztvQkFDVixJQUFJLEVBQUUsT0FBTztvQkFDYixJQUFJLEVBQUUsSUFBSTtvQkFDVixLQUFLLEVBQUUsSUFBSTtpQkFDWjtnQkFDRCxPQUFPLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDO2dCQUNsQixPQUFPLE9BQU8sQ0FBQzthQUNoQjtZQUNELElBQUksV0FBVyxDQUFDLGdCQUFnQixDQUFDLFVBQVUsQ0FBQyxpQkFBaUIsQ0FBQyxFQUFFO2dCQUM5RCxJQUFJLENBQUMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDOztvQkFDaEMsR0FBRyxHQUFHO29CQUNWLElBQUksRUFBRSxPQUFPO29CQUNiLElBQUksRUFBRSxJQUFJO29CQUNWLEtBQUssRUFBRSxJQUFJO2lCQUNaO2dCQUNELE9BQU8sQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUM7Z0JBQ2xCLE9BQU8sT0FBTyxDQUFDO2FBQ2hCO1NBQ0Y7O1lBQ0ssV0FBVyxHQUFHLElBQUksQ0FBQyxRQUFRLENBQUMsdUJBQXVCLENBQUMsOEJBQThCLENBQUM7O1lBQ25GLE1BQU0sR0FBRyxXQUFXLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUM7UUFDaEQsTUFBTSxDQUFDLFFBQVEsQ0FBQyxNQUFNLEdBQUcsTUFBTSxDQUFDO1FBQ2hDLE1BQU0sQ0FBQyxRQUFRLENBQUMsVUFBVSxHQUFHLFVBQVUsQ0FBQztRQUN4QyxNQUFNLENBQUMsUUFBUSxDQUFDLFlBQVksR0FBRyxVQUFVLENBQUM7UUFDMUMsSUFBSSxVQUFVLElBQUksVUFBVSxDQUFDLFlBQVksRUFBRTtZQUN6QyxNQUFNLENBQUMsUUFBUSxDQUFDLFVBQVUsR0FBRyxVQUFVLENBQUMsWUFBWSxDQUFDO1NBQ3REO2FBQU07WUFDTCxNQUFNLENBQUMsUUFBUSxDQUFDLFVBQVUsR0FBRyxVQUFVLENBQUMsb0JBQW9CLENBQUM7U0FDOUQ7UUFDRCxNQUFNLENBQUMsUUFBUSxDQUFDLE9BQU8sR0FBRyxPQUFPLENBQUM7O1lBQzlCLEtBQUssR0FBRyxJQUFJLENBQUMsV0FBVztRQUM1QixJQUFJLENBQUMsaUJBQWlCLENBQUMsVUFBVSxDQUFDLGlCQUFpQixDQUFDLEVBQUU7WUFDcEQsS0FBSyxHQUFHLFVBQVUsQ0FBQyxpQkFBaUIsQ0FBQztTQUN0Qzs7WUFDSyxpQkFBaUIsR0FBRztZQUN4QixLQUFLLEVBQUUsS0FBSztZQUNaLEtBQUssRUFBRSxHQUFHO1lBQ1YsTUFBTSxFQUFFLEdBQUc7WUFDWCxPQUFPLEVBQUUsTUFBTSxDQUFDLFFBQVEsQ0FBQyxXQUFXO1lBQ3BDLGVBQWUsRUFBRSxJQUFJO1lBQ3JCLGFBQWEsRUFBRSxLQUFLO1lBQ3BCLGFBQWEsRUFBRSxLQUFLO1lBQ3BCLFdBQVcsRUFBRSxJQUFJO1lBQ2pCLFNBQVMsRUFBRSxLQUFLO1NBQ2pCOztZQUNLLE1BQU0sR0FBRyxJQUFJLENBQUMsWUFBWSxDQUFDLElBQUksQ0FBQyxNQUFNLEVBQUUsaUJBQWlCLENBQUM7UUFDaEUsTUFBTSxDQUFDLE1BQU0sQ0FBQyxRQUFRLENBQUMsTUFBTSxDQUFDLFNBQVM7OztRQUFDOztnQkFDaEMsR0FBRyxHQUFHO2dCQUNWLElBQUksRUFBRSxPQUFPO2dCQUNiLElBQUksRUFBRSxJQUFJO2dCQUNWLEtBQUssRUFBRSxJQUFJO2FBQ1o7WUFDRCxPQUFPLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDO1FBQ3BCLENBQUMsRUFBQyxDQUFDO1FBQ0gsTUFBTSxDQUFDLFFBQVEsQ0FBQyxXQUFXLENBQUMsU0FBUzs7OztRQUFDLFVBQUEsSUFBSTtZQUN4QyxNQUFNLENBQUMsS0FBSyxFQUFFLENBQUM7O2dCQUNULFlBQVksR0FBRyxtQkFBQSxJQUFJLEVBQWdCO1lBQ3pDLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxZQUFZLENBQUMsRUFBRTs7b0JBQ2hDLEdBQUcsU0FBQTtnQkFDUCxJQUFHLFlBQVksQ0FBQyxPQUFPLEVBQUM7b0JBQ3RCLEdBQUcsR0FBRzt3QkFDSixJQUFJLEVBQUUsU0FBUzt3QkFDZixJQUFJLEVBQUUsWUFBWTt3QkFDbEIsS0FBSyxFQUFFLElBQUk7cUJBQ1osQ0FBQztpQkFDSDtxQkFBSztvQkFDSixHQUFHLEdBQUc7d0JBQ0osSUFBSSxFQUFFLE1BQU07d0JBQ1osSUFBSSxFQUFFLFlBQVk7d0JBQ2xCLEtBQUssRUFBRSxJQUFJO3FCQUNaLENBQUM7aUJBQ0g7Z0JBQ0QsT0FBTyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQztnQkFDbEIsT0FBTyxDQUFDLFFBQVEsRUFBRSxDQUFDO2FBQ3BCO1FBQ0gsQ0FBQyxFQUFDLENBQUM7UUFDSCxPQUFPLE9BQU8sQ0FBQztJQUNqQixDQUFDOzs7Ozs7SUFPTyxnREFBZTs7Ozs7SUFBdkIsVUFBd0IsTUFBVztRQUNqQyxJQUFJLE9BQU8sQ0FBQyxNQUFNLENBQUMsS0FBSyxRQUFRLEVBQUM7WUFDL0IsT0FBTyxNQUFNLENBQUM7U0FDZjtRQUNELElBQUksaUJBQWlCLENBQUMsTUFBTSxDQUFDLElBQUksYUFBYSxDQUFDLE1BQU0sQ0FBQyxFQUFFO1lBQ3RELE9BQU8sRUFBRSxDQUFDO1NBQ1g7O1lBQ0csVUFBVSxHQUFHLElBQUk7UUFDckIsSUFBSTtZQUNGLFVBQVUsR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLE1BQU0sQ0FBQyxDQUFDO1NBQ2pDO1FBQUMsV0FBTTtZQUNOLElBQUksQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLHlCQUF5QixDQUFDLENBQUM7WUFDL0MsT0FBTyxFQUFFLENBQUM7U0FDWDtRQUNELElBQUksT0FBTyxDQUFDLFVBQVUsQ0FBQyxLQUFLLFFBQVEsRUFBQztZQUNuQyxVQUFVLEdBQUcsRUFBRSxDQUFDO1NBQ2pCO1FBQ0QsT0FBTyxVQUFVLENBQUM7SUFDcEIsQ0FBQzs7Ozs7O0lBQ08sZ0RBQWU7Ozs7O0lBQXZCLFVBQXdCLE1BQVc7UUFDakMsSUFBSSxPQUFPLENBQUMsTUFBTSxDQUFDLEtBQUssUUFBUSxFQUFDO1lBQy9CLE9BQU8sTUFBTSxDQUFDO1NBQ2Y7UUFDRCxJQUFJLGlCQUFpQixDQUFDLE1BQU0sQ0FBQyxJQUFJLGFBQWEsQ0FBQyxNQUFNLENBQUMsRUFBRTtZQUN0RCxPQUFPLEVBQUUsQ0FBQztTQUNYOztZQUNHLFVBQVUsR0FBRyxJQUFJO1FBQ3JCLElBQUk7WUFDRixVQUFVLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUMsQ0FBQztTQUNqQztRQUFDLFdBQU07WUFDTixJQUFJLENBQUMsTUFBTSxDQUFDLE9BQU8sQ0FBQyx5QkFBeUIsQ0FBQyxDQUFDO1lBQy9DLE9BQU8sRUFBRSxDQUFDO1NBQ1g7UUFDRCxJQUFJLE9BQU8sQ0FBQyxVQUFVLENBQUMsS0FBSyxRQUFRLEVBQUM7WUFDbkMsVUFBVSxHQUFHLEVBQUUsQ0FBQztTQUNqQjs7WUFDRyxXQUFXLEdBQUcsVUFBVSxDQUFDLGFBQWEsQ0FBQztRQUMzQyxJQUFJLFdBQVcsS0FBSyxTQUFTLElBQUksV0FBVyxLQUFLLElBQUksRUFBRTtZQUNyRCxVQUFVLENBQUMsYUFBYSxDQUFDLEdBQUcsV0FBVyxDQUFDO1NBQ3pDO1FBQ0QsT0FBTyxVQUFVLENBQUM7SUFDcEIsQ0FBQzs7OztJQUVELDZDQUFZOzs7SUFBWjtRQUNFLElBQUksSUFBSSxDQUFDLGNBQWMsS0FBSyxTQUFTLElBQUksSUFBSSxDQUFDLGNBQWMsS0FBSyxJQUFJLEVBQUU7WUFDckUsSUFBSSxDQUFDLGNBQWMsQ0FBQyxJQUFJLEVBQUUsQ0FBQztTQUM1QjtJQUNILENBQUM7Ozs7SUFFRCw2Q0FBWTs7O0lBQVo7UUFDRSxJQUFJLElBQUksQ0FBQyxjQUFjLEtBQUssU0FBUyxJQUFJLElBQUksQ0FBQyxjQUFjLEtBQUssSUFBSSxFQUFFO1lBQ3JFLElBQUksQ0FBQyxjQUFjLENBQUMsUUFBUSxFQUFFLENBQUM7U0FDaEM7SUFDSCxDQUFDOztnQkE1ZUYsVUFBVSxTQUFDO29CQUNWLFVBQVUsRUFBRSxNQUFNO2lCQUNuQjs7OztnQkF4Qm9CLHdCQUF3QjtnQkFPcEMsY0FBYztnQkFQd0IsUUFBUTtnQkFFOUMsaUJBQWlCO2dCQUNqQixhQUFhO2dCQVliLG1CQUFtQjtnQkFIbkIsVUFBVTtnQkFPWCxjQUFjOzs7aUNBbkJ0QjtDQW9nQkMsQUE5ZUQsSUE4ZUM7U0EzZVksc0JBQXNCOzs7SUFFakMsNkNBQW9COztJQUNwQiw2Q0FBb0I7O0lBQ3BCLHdEQUErQjs7SUFDL0IsZ0RBQXVCOztJQUN2Qiw2Q0FBb0I7O0lBQ3BCLDhDQUFrQjs7Ozs7SUFFaEIsMENBQTBDOzs7OztJQUMxQyw4Q0FBb0M7Ozs7O0lBQ3BDLDBDQUEwQjs7Ozs7SUFDMUIsbURBQTRDOzs7OztJQUM1Qyx3Q0FBNkI7Ozs7O0lBQzdCLGlEQUE0Qzs7Ozs7SUFDNUMsc0NBQXdCOzs7OztJQUN4QixnREFBc0MiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBJbmplY3RhYmxlLCBDb21wb25lbnRGYWN0b3J5UmVzb2x2ZXIsIEluamVjdG9yIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBFeHBvcnREaWFsb2dDb21wb25lbnQgfSBmcm9tICcuLi8uLi9jdXN0b20tZXhwb3J0LWRpYWxvZy9leHBvcnQtZGlhbG9nLmNvbXBvbmVudCc7XG5pbXBvcnQgeyBEYXRhRXhwb3J0U2VydmljZSB9IGZyb20gJy4vZGF0YS1leHBvcnQuc2VydmljZSc7XG5pbXBvcnQgeyBOb3RpZnlTZXJ2aWNlIH0gZnJvbSAnQGZhcnJpcy91aS1ub3RpZnknO1xuaW1wb3J0IHsgU3ViamVjdCwgT2JzZXJ2YWJsZSwgb2YgfSBmcm9tICdyeGpzJztcbmltcG9ydCB7IEltcG9ydERpYWxvZ0NvbXBvbmVudCB9IGZyb20gJy4uLy4uL2ltcG9ydC1kaWFsb2cvaW1wb3J0LWRpYWxvZy5jb21wb25lbnQnO1xuaW1wb3J0IHsgTWV0aG9kVHlwZSB9IGZyb20gJy4uLy4uL21vZGVsL0RhdGFJRVR5cGUvTWV0aG9kVHlwZSc7XG5pbXBvcnQgeyBCc01vZGFsU2VydmljZSB9IGZyb20gJ0BmYXJyaXMvdWktbW9kYWwnO1xuaW1wb3J0IHsgRGF0YUlFUmVzdWx0IH0gZnJvbSAnLi4vRW50aXR5L0RhdGFJRVJlc3VsdCc7XG5pbXBvcnQgeyBFeHBvcnRDdXN0b21TZWxlY3RDb21wb25lbnQgfSBmcm9tICcuLi8uLi9leHBvcnQtY3VzdG9tLXNlbGVjdC9leHBvcnQtY3VzdG9tLXNlbGVjdC5jb21wb25lbnQnO1xuaW1wb3J0IHsgRXhwb3J0TWV0aG9kVHlwZSB9IGZyb20gJy4uLy4uL21vZGVsL0RhdGFJRVR5cGUvRXhwb3J0TWV0aG9kVHlwZSc7XG5pbXBvcnQge0RhdGFJRVV0aWxzLCBpc051bGxPckVtcHR5LCBpc051bGxPclVuZGVmaW5lZH0gZnJvbSAnLi4vVXRpbHMvRGF0YUlFVXRpbHMnO1xuaW1wb3J0IHsgSHR0cENsaWVudCB9IGZyb20gJ0Bhbmd1bGFyL2NvbW1vbi9odHRwJztcbmltcG9ydCB7IEZyYW1lQ29udGV4dCB9IGZyb20gJ0BmYXJyaXMvZGV2a2l0JztcbmltcG9ydCB7IEVudGl0eUxpc3RTZXJ2aWNlIH0gZnJvbSAnQGZhcnJpcy9jb21tYW5kLXNlcnZpY2VzJztcbmltcG9ydCB7IEN1c3RvbURhdGFJRVNlcnZpY2UgfSBmcm9tICcuL2N1c3RvbS1kYXRhLWllLnNlcnZpY2UnO1xuaW1wb3J0IHsgQ3VzdG9tSW1wb3J0RGlhbG9nQ29tcG9uZW50IH0gZnJvbSAnLi4vLi4vY3VzdG9tLWltcG9ydC1kaWFsb2cvY3VzdG9tLWltcG9ydC1kaWFsb2cuY29tcG9uZW50JztcbmltcG9ydCB7IFBhZ2VJbmZvIH0gZnJvbSAnLi4vRW50aXR5L1BhZ2VJbmZvJztcbmltcG9ydCB7IEltcG9ydERpYWxvZ0hhbmRjcmFmdENvbXBvbmVudCB9IGZyb20gJy4uLy4uL2ltcG9ydC1kaWFsb2ctaGFuZGNyYWZ0L2ltcG9ydC1kaWFsb2ctaGFuZGNyYWZ0LmNvbXBvbmVudCc7XG5pbXBvcnQge0xvYWRpbmdTZXJ2aWNlfSBmcm9tIFwiQGZhcnJpcy91aS1sb2FkaW5nXCI7XG5pbXBvcnQge0V4cG9ydEN1c3RvbVNlbGVjdEhhbmRjcmFmdENvbXBvbmVudH0gZnJvbSBcIi4uLy4uL2V4cG9ydC1jdXN0b20tc2VsZWN0LWhhbmRjcmFmdC9leHBvcnQtY3VzdG9tLXNlbGVjdC1oYW5kY3JhZnQuY29tcG9uZW50XCI7XG5cbkBJbmplY3RhYmxlKHtcbiAgcHJvdmlkZWRJbjogJ3Jvb3QnXG59KVxuZXhwb3J0IGNsYXNzIERhdGFpZUhhbmRjcmFmdFNlcnZpY2Uge1xuXG4gIGRhdGFfaW1wb3J0OiBzdHJpbmc7XG4gIGRhdGFfZXhwb3J0OiBzdHJpbmc7XG4gIGRhdGFfZXhwb3J0X2N1c3RvbWZpbGU6IHN0cmluZztcbiAgZXhwb3J0X3N1Y2Nlc3M6IHN0cmluZztcbiAgZXhwb3J0X2ZhaWw6IHN0cmluZztcbiAgaTE4blJlc291cmNlOiBhbnk7XG4gIGNvbnN0cnVjdG9yKFxuICAgIHByaXZhdGUgcmVzb2x2ZXI6IENvbXBvbmVudEZhY3RvcnlSZXNvbHZlcixcbiAgICBwcml2YXRlIG1vZGFsU2VydmljZTogQnNNb2RhbFNlcnZpY2UsXG4gICAgcHJpdmF0ZSBpbmplY3RvcjogSW5qZWN0b3IsXG4gICAgcHJpdmF0ZSBkYXRhRXhwb3J0U2VydmljZTogRGF0YUV4cG9ydFNlcnZpY2UsXG4gICAgcHJpdmF0ZSBub3RpZnk6IE5vdGlmeVNlcnZpY2UsXG4gICAgcHJpdmF0ZSBjdXN0b21JRVNlcnZpY2U6IEN1c3RvbURhdGFJRVNlcnZpY2UsXG4gICAgcHJpdmF0ZSBodHRwOiBIdHRwQ2xpZW50LFxuICAgIHByaXZhdGUgbG9hZGluZ1NlcnZpY2U6IExvYWRpbmdTZXJ2aWNlXG4gICkge1xuICAgIERhdGFJRVV0aWxzLmdldFRyYW5zbGF0ZVZhbHVlKGh0dHApLnN1YnNjcmliZShyZXMgPT4ge1xuICAgICAgdGhpcy5kYXRhX2ltcG9ydCA9IHJlc1snZGF0YV9pbXBvcnQnXTtcbiAgICAgIHRoaXMuZGF0YV9leHBvcnQgPSByZXNbJ2RhdGFfZXhwb3J0J107XG4gICAgICB0aGlzLmV4cG9ydF9zdWNjZXNzID0gcmVzWydleHBvcnRfc3VjY2VzcyddO1xuICAgICAgdGhpcy5leHBvcnRfZmFpbCA9IHJlc1snZXhwb3J0X2ZhaWwnXTtcbiAgICAgIHRoaXMuZGF0YV9leHBvcnRfY3VzdG9tZmlsZSA9IHJlc1snZGF0YV9leHBvcnRfY3VzdG9tZmlsZSddO1xuICAgICAgdGhpcy5pMThuUmVzb3VyY2UgPSByZXM7XG4gICAgfSlcbiAgfVxuXG4gIC8qKlxuICAgKiDpgJrnlKjlr7zlh7rmlrnms5VcbiAgICogQHBhcmFtIHR5cGVcbiAgICogQHBhcmFtIHJ1bGVJRFxuICAgKiBAcGFyYW0gb3B0aW9uXG4gICAqL1xuICBwdWJsaWMgQ29tbW9uRGF0YUV4cG9ydCh0eXBlOiBhbnksIHJ1bGVJRDogc3RyaW5nLCBvcHRpb246IHN0cmluZyk6IE9ic2VydmFibGU8YW55PiB7XG4gICAgaWYgKHR5cGUgPT09IDEpIHtcbiAgICAgIGNvbnNvbGUubG9nKCfmiafooYzmlrnms5XvvJpFeHBvcnRDdXJyZW50TGlzdERhdGEnKTtcbiAgICAgIHRocm93IG5ldyBFcnJvcign5LiN5pSv5oyB6YWN572u6K+l57G75Z6LOjEnKTtcbiAgICB9IGVsc2UgaWYgKHR5cGUgPT09IDIpIHtcbiAgICAgIGNvbnNvbGUubG9nKCfmiafooYzmlrnms5XvvJpFeHBvcnRCeU1vZGVsJyk7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ+S4jeaUr+aMgemFjee9ruivpeexu+WeizoyJyk7XG4gICAgfSBlbHNlIGlmICh0eXBlID09PSAzKSB7XG4gICAgICBjb25zb2xlLmxvZygn5omn6KGM5pa55rOV77yaRXhwb3J0Q3VycmVudENoaWxkRGF0YScpO1xuICAgICAgLy8gcmV0dXJuIHRoaXMuRXhwb3J0Q3VycmVudENoaWxkRGF0YShydWxlSUQsIG9wdGlvbik7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ+S4jeaUr+aMgemFjee9ruivpeexu+WeizozJyk7XG4gICAgfSBlbHNlIGlmICh0eXBlID09PSAwKSB7XG4gICAgICBjb25zb2xlLmxvZygn5omn6KGM5pa55rOV77yaRXhwb3J0QnlSdWxlJyk7XG4gICAgICByZXR1cm4gdGhpcy5FeHBvcnRCeVJ1bGUocnVsZUlELCBvcHRpb24pO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb25zb2xlLmxvZygn5omn6KGM5pa55rOV77yaRXhwb3J0QnlSdWxlJyk7XG4gICAgICByZXR1cm4gdGhpcy5FeHBvcnRCeVJ1bGUocnVsZUlELCBvcHRpb24pO1xuICAgIH1cbiAgfVxuXG4gIHB1YmxpYyBFeHBvcnRCeVJ1bGUocnVsZUlEOiBzdHJpbmcsIG9wdGlvbjogYW55KSB7XG4gICAgY29uc3Qgc3ViamVjdCA9IG5ldyBTdWJqZWN0PGFueT4oKTtcbiAgICB0aGlzLkV4cG9ydENvbW1vbkVudHJ5KHJ1bGVJRCwgb3B0aW9uLCBNZXRob2RUeXBlLkNvbW1vbkV4cG9ydCkuc3Vic2NyaWJlKHMgPT4ge1xuICAgICAgc3ViamVjdC5uZXh0KHMpO1xuICAgICAgc3ViamVjdC5jb21wbGV0ZSgpO1xuICAgIH0pO1xuICAgIHJldHVybiBzdWJqZWN0O1xuICB9XG4gIHB1YmxpYyBFeHBvcnRDdXJyZW50Q2hpbGREYXRhKHJ1bGVJRDogc3RyaW5nLCBvcHRpb246IHN0cmluZyk6IE9ic2VydmFibGU8YW55PiB7XG4gICAgY29uc3Qgc3ViamVjdCA9IG5ldyBTdWJqZWN0PGFueT4oKTtcbiAgICB0aGlzLkV4cG9ydENvbW1vbkVudHJ5KHJ1bGVJRCwgb3B0aW9uLCBNZXRob2RUeXBlLkV4cG9ydEN1cnJlbnRDaGlsZERhdGEpLnN1YnNjcmliZShzID0+IHtcbiAgICAgIHN1YmplY3QubmV4dChzKTtcbiAgICAgIHN1YmplY3QuY29tcGxldGUoKTtcbiAgICB9KTtcbiAgICByZXR1cm4gc3ViamVjdDtcbiAgfVxuICBwcml2YXRlIEV4cG9ydENvbW1vbkVudHJ5KHJ1bGVJRDogc3RyaW5nLCBvcHRpb246IHN0cmluZywgbWV0aG9kVHlwZTogTWV0aG9kVHlwZSk6IE9ic2VydmFibGU8YW55PiB7XG4gICAgY29uc3Qgc3ViamVjdCA9IG5ldyBTdWJqZWN0PGFueT4oKTtcbiAgICBjb25zdCBvcHRpb25Kc29uID0gdGhpcy5QYXJzZUV4cG9ydEpzb24ob3B0aW9uKTtcbiAgICBjb25zb2xlLmxvZyhvcHRpb25Kc29uKTtcbiAgICBpZiAoaXNOdWxsT3JFbXB0eShydWxlSUQpICYmIGlzTnVsbE9yRW1wdHkob3B0aW9uSnNvbi52b0lkKSkge1xuICAgICAgdGhpcy5ub3RpZnkud2FybmluZyhcIuacqumFjee9ruinhOWImWlk77yM5LiU5peg5rOV6I635Y+W5Yiw6KGo5Y2V5a+55bqU55qEdm9JZO+8jOivt+ajgOafpVwiKTtcbiAgICAgIGNvbnN0IHJlcyA9IHtcbiAgICAgICAgdHlwZTogJ2Nsb3NlJyxcbiAgICAgICAgZGF0YTogbnVsbCxcbiAgICAgICAgb3RoZXI6IG51bGxcbiAgICAgIH07XG4gICAgICBzdWJqZWN0Lm5leHQocmVzKTtcbiAgICAgIHJldHVybiBzdWJqZWN0O1xuICAgIH1cbiAgICBpZiAobWV0aG9kVHlwZSA9PT0gTWV0aG9kVHlwZS5FeHBvcnRDdXJyZW50Q2hpbGREYXRhKSB7XG4gICAgICBpZiAoaXNOdWxsT3JFbXB0eShydWxlSUQpICYmIGlzTnVsbE9yRW1wdHkob3B0aW9uSnNvbi5leHBvcnRDaGlsZE5vZGVDb2RlKSkge1xuICAgICAgICAvL+WvvOWHuuWtkOihqOW9k+inhOWImWlk5Li656m65pe277yM5qC55o2udm/mib7op4TliJnvvIzlv4XpobvopoHmsYLmnInphY3nva7lrZDooajoioLngrlcbiAgICAgICAgdGhpcy5ub3RpZnkud2FybmluZyhcIuinhOWImWlk5Li656m65pe277yM5qC55o2uVm/mn6Xmib7op4TliJnvvIzlr7zlh7rlrZDooajlv4XpobvphY3nva7lrZDooajoioLngrlcIik7XG4gICAgICAgIGNvbnN0IHJlcyA9IHtcbiAgICAgICAgICB0eXBlOiAnY2xvc2UnLFxuICAgICAgICAgIGRhdGE6IG51bGwsXG4gICAgICAgICAgb3RoZXI6IG51bGxcbiAgICAgICAgfTtcbiAgICAgICAgc3ViamVjdC5uZXh0KHJlcyk7XG4gICAgICAgIHJldHVybiBzdWJqZWN0O1xuICAgICAgfVxuICAgIH1cbiAgICBpZiAoaXNOdWxsT3JFbXB0eShydWxlSUQpIHx8IG9wdGlvbkpzb24uZW5hYmxlUnVudGltZUN1c3RvbSA9PT0gdHJ1ZSkge1xuICAgICAgdGhpcy5TdGFydExvYWRpbmcoKTtcbiAgICAgIGNvbnN0IHVybCA9ICcvYXBpL3J1bnRpbWUvZGlwL3YxLjAvZGF0YUllUnVsZU1hbmFnZS9nZXRSZWNvcmRSdWxlSW5mbyc7XG4gICAgICBjb25zdCBwb3N0Qm9keSA9IHtcbiAgICAgICAgYm9keToge1xuICAgICAgICAgIHJ1bGVJZDogcnVsZUlELFxuICAgICAgICAgIHJ1bGVUeXBlOiAxLFxuICAgICAgICAgIHZvSWQ6IG9wdGlvbkpzb24udm9JZCxcbiAgICAgICAgICBuZWVkTW9kZWxDb252ZXJ0OiBvcHRpb25Kc29uLm5lZWRNb2RlbENvbnZlcnQgPT09IHRydWUsXG4gICAgICAgICAgbWV0aG9kVHlwZTogbWV0aG9kVHlwZSxcbiAgICAgICAgICBleHBvcnRDaGlsZE5vZGVDb2RlOiBvcHRpb25Kc29uLmV4cG9ydENoaWxkTm9kZUNvZGUsXG4gICAgICAgICAgZW5hYmxlUnVudGltZUN1c3RvbTogb3B0aW9uSnNvbi5lbmFibGVSdW50aW1lQ3VzdG9tID09PSB0cnVlXG4gICAgICAgIH1cbiAgICAgIH07XG5cbiAgICAgIHRoaXMuaHR0cC5wb3N0KHVybCwgcG9zdEJvZHkuYm9keSkuc3Vic2NyaWJlKChyZWNvcmRSdWxlOmFueSkgPT4ge1xuICAgICAgICB0aGlzLkNsb3NlTG9hZGluZygpO1xuICAgICAgICBvcHRpb25Kc29uLnZvSWQgPSByZWNvcmRSdWxlLnZvSWQ7XG4gICAgICAgIHRoaXMuRXhwb3J0QnlSdWxlSW1wbChydWxlSUQsIG9wdGlvbkpzb24sIG1ldGhvZFR5cGUsIHJlY29yZFJ1bGUpLnN1YnNjcmliZShzID0+IHtcbiAgICAgICAgICBzdWJqZWN0Lm5leHQocyk7XG4gICAgICAgICAgc3ViamVjdC5jb21wbGV0ZSgpO1xuICAgICAgICB9KTtcbiAgICAgIH0sIGVycm9yID0+IHtcbiAgICAgICAgdGhpcy5DbG9zZUxvYWRpbmcoKTtcbiAgICAgICAgdGhpcy5ub3RpZnkuZXJyb3IoZXJyb3IuZXJyb3IuTWVzc2FnZSk7XG4gICAgICAgIGNvbnNvbGUubG9nKGVycm9yLmVycm9yLk1lc3NhZ2UpO1xuICAgICAgICBjb25zdCByZXMgPSB7XG4gICAgICAgICAgdHlwZTogJ2Nsb3NlJyxcbiAgICAgICAgICBkYXRhOiBudWxsLFxuICAgICAgICAgIG90aGVyOiBlcnJvci5lcnJvci5NZXNzYWdlXG4gICAgICAgIH07XG4gICAgICAgIHN1YmplY3QubmV4dChyZXMpO1xuICAgICAgfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuRXhwb3J0QnlSdWxlSW1wbChydWxlSUQsIG9wdGlvbkpzb24sIG1ldGhvZFR5cGUpLnN1YnNjcmliZShzID0+IHtcbiAgICAgICAgc3ViamVjdC5uZXh0KHMpO1xuICAgICAgICBzdWJqZWN0LmNvbXBsZXRlKCk7XG4gICAgICB9KTtcbiAgICB9XG4gICAgcmV0dXJuIHN1YmplY3Q7XG4gIH1cblxuICBwcml2YXRlIEV4cG9ydEJ5UnVsZUltcGwocnVsZUlEOiBzdHJpbmcsIG9wdGlvbkpzb246IGFueSwgbVR5cGU6IE1ldGhvZFR5cGUsIHJlY29yZFJ1bGU/OiBhbnkpIHtcbiAgICBjb25zdCBzdWJqZWN0ID0gbmV3IFN1YmplY3Q8YW55PigpO1xuICAgIGlmIChvcHRpb25Kc29uLmN1c3RvbUV4cG9ydFRpdGxlICE9PSB1bmRlZmluZWQgJiYgb3B0aW9uSnNvbi5jdXN0b21FeHBvcnRUaXRsZSAhPT0gbnVsbCkge1xuICAgICAgaWYgKG9wdGlvbkpzb24uY3VzdG9tRXhwb3J0VGl0bGUubGVuZ3RoID4gMjApIHtcbiAgICAgICAgdGhpcy5ub3RpZnkud2FybmluZygn6Ieq5a6a5LmJ5qCH6aKY5ZCN56ew55qE6ZW/5bqm5aSq6ZW/Jyk7XG4gICAgICAgIGNvbnN0IHJlcyA9IHtcbiAgICAgICAgICB0eXBlOiAnY2xvc2UnLFxuICAgICAgICAgIGRhdGE6IG51bGwsXG4gICAgICAgICAgb3RoZXI6IG51bGxcbiAgICAgICAgfTtcbiAgICAgICAgc3ViamVjdC5uZXh0KHJlcyk7XG4gICAgICAgIHJldHVybiBzdWJqZWN0O1xuICAgICAgfVxuICAgICAgaWYgKERhdGFJRVV0aWxzLkp1ZGdlSWxsZWdhbENoYXIob3B0aW9uSnNvbi5jdXN0b21FeHBvcnRUaXRsZSkpIHtcbiAgICAgICAgdGhpcy5ub3RpZnkud2FybmluZygn6Ieq5a6a5LmJ5qCH6aKY5ZCN56ew5a2Y5Zyo5LiN5ZCI5rOV5a2X56ymJyk7XG4gICAgICAgIGNvbnN0IHJlcyA9IHtcbiAgICAgICAgICB0eXBlOiAnY2xvc2UnLFxuICAgICAgICAgIGRhdGE6IG51bGwsXG4gICAgICAgICAgb3RoZXI6IG51bGxcbiAgICAgICAgfTtcbiAgICAgICAgc3ViamVjdC5uZXh0KHJlcyk7XG4gICAgICAgIHJldHVybiBzdWJqZWN0O1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChvcHRpb25Kc29uLmVuYWJsZVJ1bnRpbWVDdXN0b20gPT09IHRydWUgfHwgb3B0aW9uSnNvbi5zZWxlY3RmaWxldHlwZSA9PT0gdHJ1ZSkge1xuICAgICAgY29uc3QgY29tcEZhY3RvcnkgPSB0aGlzLnJlc29sdmVyLnJlc29sdmVDb21wb25lbnRGYWN0b3J5KEV4cG9ydEN1c3RvbVNlbGVjdEhhbmRjcmFmdENvbXBvbmVudCk7XG4gICAgICBjb25zdCBjbXBSZWYgPSBjb21wRmFjdG9yeS5jcmVhdGUodGhpcy5pbmplY3Rvcik7XG4gICAgICBjbXBSZWYuaW5zdGFuY2UucnVsZUlkID0gcnVsZUlEO1xuICAgICAgY21wUmVmLmluc3RhbmNlLmV4cG9ydE9wdGlvbiA9IG9wdGlvbkpzb247XG4gICAgICBjbXBSZWYuaW5zdGFuY2UucmVjb3JkUnVsZSA9IHJlY29yZFJ1bGU7XG4gICAgICBjbXBSZWYuaW5zdGFuY2Uuc3ViamVjdCA9IHN1YmplY3Q7XG4gICAgICBjbXBSZWYuaW5zdGFuY2UubWV0aG9kVHlwZSA9IE1ldGhvZFR5cGUuQ29tbW9uRXhwb3J0O1xuICAgICAgbGV0IHRpdGxlID0gdGhpcy5kYXRhX2V4cG9ydDtcbiAgICAgIGlmIChvcHRpb25Kc29uLmN1c3RvbUV4cG9ydFRpdGxlICE9PSB1bmRlZmluZWQgJiYgb3B0aW9uSnNvbi5jdXN0b21FeHBvcnRUaXRsZSAhPT0gbnVsbCkge1xuICAgICAgICB0aXRsZSA9IG9wdGlvbkpzb24uY3VzdG9tRXhwb3J0VGl0bGU7XG4gICAgICB9XG4gICAgICBjb25zdCBleHBvcnRNb2RhbENvbmZpZyA9IHtcbiAgICAgICAgdGl0bGU6IHRpdGxlLFxuICAgICAgICB3aWR0aDogNTMwLFxuICAgICAgICBoZWlnaHQ6IDM0MixcbiAgICAgICAgYnV0dG9uczogY21wUmVmLmluc3RhbmNlLm1vZGFsRm9vdGVyLFxuICAgICAgICBzaG93Q2xvc2VCdXR0b246IHRydWUsXG4gICAgICAgIHNob3dNYXhCdXR0b246IGZhbHNlLFxuICAgICAgICBzaG93TWluQnV0dG9uOiBmYWxzZSxcbiAgICAgICAgc2hvd0J1dHRvbnM6IHRydWUsXG4gICAgICAgIHJlc2l6YWJsZTogZmFsc2VcbiAgICAgIH07XG4gICAgICBjb25zdCBkaWFsb2cgPSB0aGlzLm1vZGFsU2VydmljZS5zaG93KGNtcFJlZiwgZXhwb3J0TW9kYWxDb25maWcpO1xuICAgICAgZGlhbG9nLmRpYWxvZy5pbnN0YW5jZS5jbG9zZWQuc3Vic2NyaWJlKCgpID0+IHtcbiAgICAgICAgY29uc3QgcmVzID0ge1xuICAgICAgICAgIHR5cGU6ICdjbG9zZScsXG4gICAgICAgICAgZGF0YTogbnVsbCxcbiAgICAgICAgICBvdGhlcjogbnVsbFxuICAgICAgICB9O1xuICAgICAgICBzdWJqZWN0Lm5leHQocmVzKTtcbiAgICAgIH0pO1xuICAgICAgY21wUmVmLmluc3RhbmNlLm5lZWREZXN0cm95LnN1YnNjcmliZSgkZXZlbnQgPT4ge1xuICAgICAgICBkaWFsb2cuY2xvc2UoKTtcbiAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICBpZiAoIWlzTnVsbE9yVW5kZWZpbmVkKHJlY29yZFJ1bGUpICYmICFpc051bGxPckVtcHR5KHJlY29yZFJ1bGUucnVsZUlkKSkge1xuICAgICAgICBydWxlSUQgPSByZWNvcmRSdWxlLnJ1bGVJZDtcbiAgICAgIH1cbiAgICAgIGlmIChtVHlwZSA9PSBNZXRob2RUeXBlLkNvbW1vbkV4cG9ydCkge1xuICAgICAgICB0aGlzLmRhdGFFeHBvcnRTZXJ2aWNlLkV4cG9ydEJ5SWQ0SGFuZENyYWZ0KHJ1bGVJRCwgIG9wdGlvbkpzb24pO1xuICAgICAgfSBlbHNlIGlmIChtVHlwZSA9PSBNZXRob2RUeXBlLkV4cG9ydEN1cnJlbnRUYWJsZURhdGEpe1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ+S4jeaUr+aMgeivpeexu+WeizpFeHBvcnRDdXJyZW50VGFibGVEYXRhJyk7XG4gICAgICB9ZWxzZXtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCfkuI3mlK/mjIHor6Xnsbvlnos6RXhwb3J0Q3VycmVudENoaWxkRGF0YScpO1xuICAgICAgfVxuICAgICAgY29uc3QgdW5zY3JpYmVyID0gdGhpcy5kYXRhRXhwb3J0U2VydmljZS5leHBvcnQuc3Vic2NyaWJlKGRhdGEgPT4ge1xuICAgICAgICBpZiAoZGF0YSA9PT0gJycpIHtcbiAgICAgICAgICBjb25zdCByZXMgPSB7XG4gICAgICAgICAgICB0eXBlOiAnc3VjY2VzcycsXG4gICAgICAgICAgICBkYXRhOiBudWxsLFxuICAgICAgICAgICAgb3RoZXI6IG51bGxcbiAgICAgICAgICB9O1xuICAgICAgICAgIHN1YmplY3QubmV4dChyZXMpO1xuICAgICAgICAgIHN1YmplY3QuY29tcGxldGUoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBjb25zdCBlcnJvcmxldmVsID0gdGhpcy5kYXRhRXhwb3J0U2VydmljZS5lcnJvcmxldmVsO1xuICAgICAgICAgIGlmIChlcnJvcmxldmVsID09PSAnSW5mbycpIHtcbiAgICAgICAgICAgIHRoaXMubm90aWZ5LmluZm8oZGF0YSk7XG4gICAgICAgICAgfSBlbHNlIGlmIChlcnJvcmxldmVsID09PSAnV2FybmluZycpIHtcbiAgICAgICAgICAgIHRoaXMubm90aWZ5Lndhcm5pbmcoZGF0YSk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMubm90aWZ5LmVycm9yKHRoaXMuZXhwb3J0X2ZhaWwgKyBkYXRhKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgY29uc3QgcmVzID0ge1xuICAgICAgICAgICAgdHlwZTogJ2ZhaWwnLFxuICAgICAgICAgICAgZGF0YTogbnVsbCxcbiAgICAgICAgICAgIG90aGVyOiBkYXRhXG4gICAgICAgICAgfTtcbiAgICAgICAgICBzdWJqZWN0Lm5leHQocmVzKTtcbiAgICAgICAgICBzdWJqZWN0LmNvbXBsZXRlKCk7XG4gICAgICAgIH1cbiAgICAgICAgdW5zY3JpYmVyLnVuc3Vic2NyaWJlKCk7XG4gICAgICB9LCBlcnJvciA9PiB7XG4gICAgICAgIHRoaXMubm90aWZ5LmVycm9yKGVycm9yLmVycm9yLk1lc3NhZ2UpO1xuICAgICAgICBjb25zdCByZXMgPSB7XG4gICAgICAgICAgdHlwZTogJ2ZhaWwnLFxuICAgICAgICAgIGRhdGE6IG51bGwsXG4gICAgICAgICAgb3RoZXI6IGVycm9yLmVycm9yLk1lc3NhZ2VcbiAgICAgICAgfTtcbiAgICAgICAgc3ViamVjdC5uZXh0KHJlcyk7XG4gICAgICAgIHN1YmplY3QuY29tcGxldGUoKTtcbiAgICAgIH0pO1xuICAgIH1cbiAgICByZXR1cm4gc3ViamVjdDtcbiAgfVxuXG5cblxuXG5cblxuICAvKipcbiAgICog6YCa55So5a+85YWl5pa55rOVXG4gICAqIEBwYXJhbSB0eXBlXG4gICAqIEBwYXJhbSBydWxlSURcbiAgICogQHBhcmFtIG9wdGlvblxuICAgKi9cbiAgcHVibGljIENvbW1vbkRhdGFJbXBvcnQodHlwZTogYW55LCBydWxlSUQ6IHN0cmluZywgb3B0aW9uOiBzdHJpbmcpOiBPYnNlcnZhYmxlPGFueT4ge1xuICAgIGlmICh0eXBlID09PSAxKSB7XG4gICAgICBjb25zb2xlLmxvZygn5omn6KGM5pa55rOV77yaSW1wb3J0U3VibGlzdERhdGEnKTtcbiAgICAgIHJldHVybiB0aGlzLkltcG9ydFN1Ymxpc3REYXRhKHJ1bGVJRCwgb3B0aW9uKTtcbiAgICB9IGVsc2UgaWYgKHR5cGUgPT09IDIpIHtcbiAgICAgIGNvbnNvbGUubG9nKCfmiafooYzmlrnms5XvvJpJbXBvcnRCeU1vZGVsJyk7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ+S4jeaUr+aMgemFjee9ruivpeexu+WeizoyJyk7XG4gICAgfSBlbHNlIGlmICh0eXBlID09PSAwKSB7XG4gICAgICBjb25zb2xlLmxvZygn5omn6KGM5pa55rOV77yaSW1wb3J0QnlSdWxlJyk7XG4gICAgICByZXR1cm4gdGhpcy5JbXBvcnRCeVJ1bGUocnVsZUlELCBvcHRpb24pO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb25zb2xlLmxvZygn5omn6KGM5pa55rOV77yaSW1wb3J0QnlSdWxlJyk7XG4gICAgICByZXR1cm4gdGhpcy5JbXBvcnRCeVJ1bGUocnVsZUlELCBvcHRpb24pO1xuICAgIH1cbiAgfVxuICAvLyDmma7pgJrlr7zlhaVcbiAgcHVibGljIEltcG9ydEJ5UnVsZShydWxlSUQ6IHN0cmluZywgb3B0aW9uOiBhbnkpOiBPYnNlcnZhYmxlPGFueT4ge1xuICAgIGNvbnN0IHN1YmplY3QgPSBuZXcgU3ViamVjdDxhbnk+KCk7XG4gICAgdGhpcy5JbXBvcnRDb21tb25FbnRyeShydWxlSUQsIG9wdGlvbiwgTWV0aG9kVHlwZS5Db21tb25JbXBvcnQpLnN1YnNjcmliZShzID0+IHtcbiAgICAgIHN1YmplY3QubmV4dChzKTtcbiAgICAgIHN1YmplY3QuY29tcGxldGUoKTtcbiAgICB9KTtcbiAgICByZXR1cm4gc3ViamVjdDtcbiAgfVxuICAvLyDlrZDooajlr7zlhaVcbiAgcHVibGljIEltcG9ydFN1Ymxpc3REYXRhKHJ1bGVJRDogc3RyaW5nLCBvcHRpb246IGFueSk6IE9ic2VydmFibGU8YW55PiB7XG4gICAgY29uc3Qgc3ViamVjdCA9IG5ldyBTdWJqZWN0PGFueT4oKTtcbiAgICB0aGlzLkltcG9ydENvbW1vbkVudHJ5KHJ1bGVJRCwgb3B0aW9uLCBNZXRob2RUeXBlLkltcG9ydFN1YlRhYmxlRGV0YWlsKS5zdWJzY3JpYmUocyA9PiB7XG4gICAgICBzdWJqZWN0Lm5leHQocyk7XG4gICAgICBzdWJqZWN0LmNvbXBsZXRlKCk7XG4gICAgfSk7XG4gICAgcmV0dXJuIHN1YmplY3Q7XG4gIH1cbiAgcHJpdmF0ZSBJbXBvcnRDb21tb25FbnRyeShydWxlSUQ6IHN0cmluZywgb3B0aW9uOiBzdHJpbmcsIG1ldGhvZFR5cGU6IE1ldGhvZFR5cGUpIHtcbiAgICBjb25zb2xlLmxvZyhvcHRpb24pO1xuICAgIGNvbnN0IHN1YmplY3QgPSBuZXcgU3ViamVjdDxhbnk+KCk7XG4gICAgY29uc3Qgb3B0aW9uSnNvbiA9IHRoaXMuUGFyc2VJbXBvcnRKc29uKG9wdGlvbik7XG4gICAgY29uc3Qgc3UgPSBvcHRpb25Kc29uLnN1O1xuICAgIGlmIChtZXRob2RUeXBlID09PSBNZXRob2RUeXBlLkltcG9ydFN1YlRhYmxlRGV0YWlsKSB7XG4gICAgICBpZiAoaXNOdWxsT3JFbXB0eShydWxlSUQpICYmIGlzTnVsbE9yRW1wdHkob3B0aW9uSnNvbi5pbXBvcnRDaGlsZE5vZGVDb2RlKSkge1xuICAgICAgICAvL+WvvOWFpeWtkOihqOW9k+inhOWImWlk5Li656m65pe277yM5qC55o2udm/mib7op4TliJnvvIzlv4XpobvopoHmsYLmnInphY3nva7lrZDooajoioLngrlcbiAgICAgICAgdGhpcy5ub3RpZnkud2FybmluZyhcIuinhOWImWlk5Li656m65pe277yM5qC55o2u5qih5Z6L5p+l5om+6KeE5YiZ77yM5a+85YWl5a2Q6KGo5b+F6aG76YWN572u5a2Q6KGo6IqC54K5XCIpO1xuICAgICAgICBjb25zdCByZXMgPSB7XG4gICAgICAgICAgdHlwZTogJ2Nsb3NlJyxcbiAgICAgICAgICBkYXRhOiBudWxsLFxuICAgICAgICAgIG90aGVyOiBudWxsXG4gICAgICAgIH07XG4gICAgICAgIHN1YmplY3QubmV4dChyZXMpO1xuICAgICAgICByZXR1cm4gc3ViamVjdDtcbiAgICAgIH1cbiAgICB9XG4gICAgdGhpcy5TdGFydExvYWRpbmcoKTtcbiAgICBjb25zdCB1cmwgPSAnL2FwaS9ydW50aW1lL2RpcC92MS4wL2RhdGFJZVJ1bGVNYW5hZ2UvZ2V0UmVjb3JkUnVsZUluZm8nO1xuICAgIGNvbnN0IHBvc3RCb2R5ID0ge1xuICAgICAgYm9keToge1xuICAgICAgICBydWxlSWQ6IHJ1bGVJRCxcbiAgICAgICAgc3U6IHN1LFxuICAgICAgICBydWxlVHlwZTogMCxcbiAgICAgICAgdm9JZDogb3B0aW9uSnNvbi52b0lkLFxuICAgICAgICBuZWVkTW9kZWxDb252ZXJ0OiBvcHRpb25Kc29uLm5lZWRNb2RlbENvbnZlcnQgPT09IHRydWUsXG4gICAgICAgIG1ldGhvZFR5cGU6IG1ldGhvZFR5cGUsXG4gICAgICAgIGltcG9ydENoaWxkTm9kZUNvZGU6IG9wdGlvbkpzb24uaW1wb3J0Q2hpbGROb2RlQ29kZSxcbiAgICAgICAgZW5hYmxlUnVudGltZUN1c3RvbTogb3B0aW9uSnNvbi5lbmFibGVSdW50aW1lQ3VzdG9tID09PSB0cnVlXG4gICAgICB9XG4gICAgfTtcbiAgICB0aGlzLmh0dHAucG9zdCh1cmwsIHBvc3RCb2R5LmJvZHkpLnN1YnNjcmliZSgocmVjb3JkUnVsZTphbnkpID0+IHtcbiAgICAgIHRoaXMuQ2xvc2VMb2FkaW5nKCk7XG4gICAgICBvcHRpb25Kc29uLnZvSWQgPSByZWNvcmRSdWxlLnZvSWQ7XG4gICAgICB0aGlzLkltcG9ydEJ5UnVsZUltcGwocnVsZUlELCBvcHRpb25Kc29uLCBtZXRob2RUeXBlLCByZWNvcmRSdWxlKS5zdWJzY3JpYmUocyA9PiB7XG4gICAgICAgIHN1YmplY3QubmV4dChzKTtcbiAgICAgICAgc3ViamVjdC5jb21wbGV0ZSgpO1xuICAgICAgfSk7XG4gICAgfSwgZXJyb3IgPT4ge1xuICAgICAgdGhpcy5DbG9zZUxvYWRpbmcoKTtcbiAgICAgIHRoaXMubm90aWZ5LmVycm9yKGVycm9yLmVycm9yLk1lc3NhZ2UpO1xuICAgICAgY29uc29sZS5sb2coZXJyb3IuZXJyb3IuTWVzc2FnZSk7XG4gICAgICBjb25zdCByZXMgPSB7XG4gICAgICAgIHR5cGU6ICdjbG9zZScsXG4gICAgICAgIGRhdGE6IG51bGwsXG4gICAgICAgIG90aGVyOiBlcnJvci5lcnJvci5NZXNzYWdlXG4gICAgICB9O1xuICAgICAgc3ViamVjdC5uZXh0KHJlcyk7XG4gICAgfSk7XG4gICAgcmV0dXJuIHN1YmplY3Q7XG4gIH1cbiAgcHJpdmF0ZSBJbXBvcnRCeVJ1bGVJbXBsKHJ1bGVJRDogc3RyaW5nLCBvcHRpb25Kc29uOiBhbnksIG1ldGhvZFR5cGU6IE1ldGhvZFR5cGUsIHJlY29yZFJ1bGU/OiBhbnkpIHtcbiAgICBjb25zdCBzdWJqZWN0ID0gbmV3IFN1YmplY3Q8YW55PigpO1xuICAgIGlmIChvcHRpb25Kc29uLmN1c3RvbUltcG9ydFRpdGxlICE9PSB1bmRlZmluZWQgJiYgb3B0aW9uSnNvbi5jdXN0b21JbXBvcnRUaXRsZSAhPT0gbnVsbCkge1xuICAgICAgaWYgKG9wdGlvbkpzb24uY3VzdG9tSW1wb3J0VGl0bGUubGVuZ3RoID4gMjApIHtcbiAgICAgICAgdGhpcy5ub3RpZnkud2FybmluZygn6Ieq5a6a5LmJ5qCH6aKY5ZCN56ew55qE6ZW/5bqm5aSq6ZW/Jyk7XG4gICAgICAgIGNvbnN0IHJlcyA9IHtcbiAgICAgICAgICB0eXBlOiAnY2xvc2UnLFxuICAgICAgICAgIGRhdGE6IG51bGwsXG4gICAgICAgICAgb3RoZXI6IG51bGxcbiAgICAgICAgfTtcbiAgICAgICAgc3ViamVjdC5uZXh0KHJlcyk7XG4gICAgICAgIHJldHVybiBzdWJqZWN0O1xuICAgICAgfVxuICAgICAgaWYgKERhdGFJRVV0aWxzLkp1ZGdlSWxsZWdhbENoYXIob3B0aW9uSnNvbi5jdXN0b21JbXBvcnRUaXRsZSkpIHtcbiAgICAgICAgdGhpcy5ub3RpZnkud2FybmluZygn6Ieq5a6a5LmJ5qCH6aKY5ZCN56ew5a2Y5Zyo5LiN5ZCI5rOV5a2X56ymJyk7XG4gICAgICAgIGNvbnN0IHJlcyA9IHtcbiAgICAgICAgICB0eXBlOiAnY2xvc2UnLFxuICAgICAgICAgIGRhdGE6IG51bGwsXG4gICAgICAgICAgb3RoZXI6IG51bGxcbiAgICAgICAgfTtcbiAgICAgICAgc3ViamVjdC5uZXh0KHJlcyk7XG4gICAgICAgIHJldHVybiBzdWJqZWN0O1xuICAgICAgfVxuICAgIH1cbiAgICBjb25zdCBjb21wRmFjdG9yeSA9IHRoaXMucmVzb2x2ZXIucmVzb2x2ZUNvbXBvbmVudEZhY3RvcnkoSW1wb3J0RGlhbG9nSGFuZGNyYWZ0Q29tcG9uZW50KTtcbiAgICBjb25zdCBjbXBSZWYgPSBjb21wRmFjdG9yeS5jcmVhdGUodGhpcy5pbmplY3Rvcik7XG4gICAgY21wUmVmLmluc3RhbmNlLnJ1bGVJZCA9IHJ1bGVJRDtcbiAgICBjbXBSZWYuaW5zdGFuY2UucmVjb3JkUnVsZSA9IHJlY29yZFJ1bGU7XG4gICAgY21wUmVmLmluc3RhbmNlLmltcG9ydE9wdGlvbiA9IG9wdGlvbkpzb247XG4gICAgaWYgKG1ldGhvZFR5cGUgPT0gTWV0aG9kVHlwZS5Db21tb25JbXBvcnQpIHtcbiAgICAgIGNtcFJlZi5pbnN0YW5jZS5tZXRob2RUeXBlID0gTWV0aG9kVHlwZS5Db21tb25JbXBvcnQ7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNtcFJlZi5pbnN0YW5jZS5tZXRob2RUeXBlID0gTWV0aG9kVHlwZS5JbXBvcnRTdWJUYWJsZURldGFpbDtcbiAgICB9XG4gICAgY21wUmVmLmluc3RhbmNlLnN1YmplY3QgPSBzdWJqZWN0O1xuICAgIGxldCB0aXRsZSA9IHRoaXMuZGF0YV9pbXBvcnQ7XG4gICAgaWYgKCFpc051bGxPclVuZGVmaW5lZChvcHRpb25Kc29uLmN1c3RvbUltcG9ydFRpdGxlKSkge1xuICAgICAgdGl0bGUgPSBvcHRpb25Kc29uLmN1c3RvbUltcG9ydFRpdGxlO1xuICAgIH1cbiAgICBjb25zdCBpbXBvcnRNb2RhbENvbmZpZyA9IHtcbiAgICAgIHRpdGxlOiB0aXRsZSxcbiAgICAgIHdpZHRoOiA1MzAsXG4gICAgICBoZWlnaHQ6IDM0MixcbiAgICAgIGJ1dHRvbnM6IGNtcFJlZi5pbnN0YW5jZS5tb2RhbEZvb3RlcixcbiAgICAgIHNob3dDbG9zZUJ1dHRvbjogdHJ1ZSxcbiAgICAgIHNob3dNYXhCdXR0b246IGZhbHNlLFxuICAgICAgc2hvd01pbkJ1dHRvbjogZmFsc2UsXG4gICAgICBzaG93QnV0dG9uczogdHJ1ZSxcbiAgICAgIHJlc2l6YWJsZTogZmFsc2VcbiAgICB9O1xuICAgIGNvbnN0IGRpYWxvZyA9IHRoaXMubW9kYWxTZXJ2aWNlLnNob3coY21wUmVmLCBpbXBvcnRNb2RhbENvbmZpZyk7XG4gICAgZGlhbG9nLmRpYWxvZy5pbnN0YW5jZS5jbG9zZWQuc3Vic2NyaWJlKCgpID0+IHtcbiAgICAgIGNvbnN0IHJlcyA9IHtcbiAgICAgICAgdHlwZTogJ2Nsb3NlJyxcbiAgICAgICAgZGF0YTogbnVsbCxcbiAgICAgICAgb3RoZXI6IG51bGxcbiAgICAgIH07XG4gICAgICBzdWJqZWN0Lm5leHQocmVzKTtcbiAgICB9KTtcbiAgICBjbXBSZWYuaW5zdGFuY2UubmVlZERlc3Ryb3kuc3Vic2NyaWJlKGRhdGEgPT4ge1xuICAgICAgZGlhbG9nLmNsb3NlKCk7XG4gICAgICBjb25zdCBpbXBvcnRSZXN1bHQgPSBkYXRhIGFzIERhdGFJRVJlc3VsdDtcbiAgICAgIGlmICghaXNOdWxsT3JVbmRlZmluZWQoaW1wb3J0UmVzdWx0KSkge1xuICAgICAgICBsZXQgcmVzO1xuICAgICAgICBpZihpbXBvcnRSZXN1bHQuc3VjY2VlZCl7XG4gICAgICAgICAgcmVzID0ge1xuICAgICAgICAgICAgdHlwZTogJ3N1Y2Nlc3MnLFxuICAgICAgICAgICAgZGF0YTogaW1wb3J0UmVzdWx0LFxuICAgICAgICAgICAgb3RoZXI6IG51bGxcbiAgICAgICAgICB9O1xuICAgICAgICB9ZWxzZSB7XG4gICAgICAgICAgcmVzID0ge1xuICAgICAgICAgICAgdHlwZTogJ2ZhaWwnLFxuICAgICAgICAgICAgZGF0YTogaW1wb3J0UmVzdWx0LFxuICAgICAgICAgICAgb3RoZXI6IG51bGxcbiAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIHN1YmplY3QubmV4dChyZXMpO1xuICAgICAgICBzdWJqZWN0LmNvbXBsZXRlKCk7XG4gICAgICB9XG4gICAgfSk7XG4gICAgcmV0dXJuIHN1YmplY3Q7XG4gIH1cblxuXG5cblxuXG5cbiAgcHJpdmF0ZSBQYXJzZUV4cG9ydEpzb24ob3B0aW9uOiBhbnkpOiBhbnkge1xuICAgIGlmICh0eXBlb2YgKG9wdGlvbikgPT09ICdvYmplY3QnKXtcbiAgICAgIHJldHVybiBvcHRpb247XG4gICAgfVxuICAgIGlmIChpc051bGxPclVuZGVmaW5lZChvcHRpb24pIHx8IGlzTnVsbE9yRW1wdHkob3B0aW9uKSkge1xuICAgICAgcmV0dXJuIHt9O1xuICAgIH1cbiAgICBsZXQgb3B0aW9uSnNvbiA9IG51bGw7XG4gICAgdHJ5IHtcbiAgICAgIG9wdGlvbkpzb24gPSBKU09OLnBhcnNlKG9wdGlvbik7XG4gICAgfSBjYXRjaCB7XG4gICAgICB0aGlzLm5vdGlmeS53YXJuaW5nKCfkvKDlhaXnmoTlj4LmlbDovazmjaJKU09O5a+56LGh5byC5bi477yM5bey5L2/55So6buY6K6k5Y+C5pWwJyk7XG4gICAgICByZXR1cm4ge307XG4gICAgfVxuICAgIGlmICh0eXBlb2YgKG9wdGlvbkpzb24pICE9PSAnb2JqZWN0Jyl7XG4gICAgICBvcHRpb25Kc29uID0ge307XG4gICAgfVxuICAgIHJldHVybiBvcHRpb25Kc29uO1xuICB9XG4gIHByaXZhdGUgUGFyc2VJbXBvcnRKc29uKG9wdGlvbjogYW55KTogYW55IHtcbiAgICBpZiAodHlwZW9mIChvcHRpb24pID09PSAnb2JqZWN0Jyl7XG4gICAgICByZXR1cm4gb3B0aW9uO1xuICAgIH1cbiAgICBpZiAoaXNOdWxsT3JVbmRlZmluZWQob3B0aW9uKSB8fCBpc051bGxPckVtcHR5KG9wdGlvbikpIHtcbiAgICAgIHJldHVybiB7fTtcbiAgICB9XG4gICAgbGV0IG9wdGlvbkpzb24gPSBudWxsO1xuICAgIHRyeSB7XG4gICAgICBvcHRpb25Kc29uID0gSlNPTi5wYXJzZShvcHRpb24pO1xuICAgIH0gY2F0Y2gge1xuICAgICAgdGhpcy5ub3RpZnkud2FybmluZygn5Lyg5YWl55qE5Y+C5pWw6L2s5o2iSlNPTuWvueixoeW8guW4uO+8jOW3suS9v+eUqOm7mOiupOWPguaVsCcpO1xuICAgICAgcmV0dXJuIHt9O1xuICAgIH1cbiAgICBpZiAodHlwZW9mIChvcHRpb25Kc29uKSAhPT0gJ29iamVjdCcpe1xuICAgICAgb3B0aW9uSnNvbiA9IHt9O1xuICAgIH1cbiAgICBsZXQgZ2xvYmFsUGFyYW0gPSBvcHRpb25Kc29uWydnbG9iYWxQYXJhbSddO1xuICAgIGlmIChnbG9iYWxQYXJhbSAhPT0gdW5kZWZpbmVkICYmIGdsb2JhbFBhcmFtICE9PSBudWxsKSB7XG4gICAgICBvcHRpb25Kc29uWydHbG9iYWxQYXJhbSddID0gZ2xvYmFsUGFyYW07XG4gICAgfVxuICAgIHJldHVybiBvcHRpb25Kc29uO1xuICB9XG5cbiAgU3RhcnRMb2FkaW5nKCkge1xuICAgIGlmICh0aGlzLmxvYWRpbmdTZXJ2aWNlICE9PSB1bmRlZmluZWQgJiYgdGhpcy5sb2FkaW5nU2VydmljZSAhPT0gbnVsbCkge1xuICAgICAgdGhpcy5sb2FkaW5nU2VydmljZS5zaG93KCk7XG4gICAgfVxuICB9XG5cbiAgQ2xvc2VMb2FkaW5nKCkge1xuICAgIGlmICh0aGlzLmxvYWRpbmdTZXJ2aWNlICE9PSB1bmRlZmluZWQgJiYgdGhpcy5sb2FkaW5nU2VydmljZSAhPT0gbnVsbCkge1xuICAgICAgdGhpcy5sb2FkaW5nU2VydmljZS5jbGVhckFsbCgpO1xuICAgIH1cbiAgfVxuXG59XG4iXX0=