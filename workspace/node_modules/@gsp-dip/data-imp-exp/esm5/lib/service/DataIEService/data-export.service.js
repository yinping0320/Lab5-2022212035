/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { EventEmitter, Injectable, Output } from '@angular/core';
import { DataIEUtils, getQueryString, isNullOrEmpty, isNullOrUndefined } from '../Utils/DataIEUtils';
import { FileOperateService } from './file-operate.service';
import { NotifyService } from '@farris/ui-notify';
import { LoadingService } from '@farris/ui-loading';
import { HttpClient } from '@angular/common/http';
var DataExportService = /** @class */ (function () {
    function DataExportService(operateService, notify, http, loadingService) {
        var _this = this;
        this.operateService = operateService;
        this.notify = notify;
        this.http = http;
        this.loadingService = loadingService;
        this.origin = window.location.origin;
        this.export = new EventEmitter();
        DataIEUtils.getTranslateValue(http).subscribe((/**
         * @param {?} res
         * @return {?}
         */
        function (res) {
            _this.i18nResource = res;
        }));
    }
    /**
     * 数据导出服务
     */
    /**
     * 数据导出服务
     * @param {?} repository
     * @param {?} exportParam
     * @param {?} option
     * @return {?}
     */
    DataExportService.prototype.Export = /**
     * 数据导出服务
     * @param {?} repository
     * @param {?} exportParam
     * @param {?} option
     * @return {?}
     */
    function (repository, exportParam, option) {
        var _this = this;
        this.StartLoading();
        /** @type {?} */
        var befRestService = DataIEUtils.GetBefRestService(repository);
        /** @type {?} */
        var subject = befRestService.request(befRestService.baseUri + "/service/dataexportvmaction", 'put', null, exportParam);
        subject.subscribe((/**
         * @param {?} data
         * @return {?}
         */
        function (data) {
            /** @type {?} */
            var exportResult = (/** @type {?} */ (data.returnValue));
            if (isNullOrUndefined(exportResult)) {
                exportResult = (/** @type {?} */ (data));
            }
            if (exportResult.succeed === true) {
                /** @type {?} */
                var fileName = '';
                if (option === '' || option['customfilename'] === '' || option['customfilename'] === undefined) {
                    fileName = exportResult.fileName;
                }
                else {
                    /** @type {?} */
                    var suffixIndex = exportResult.fileName.lastIndexOf('.');
                    /** @type {?} */
                    var suffix = exportResult.fileName.substring(suffixIndex);
                    if (!DataIEUtils.JudgeIllegalChar(option['customfilename'])) {
                        fileName = option['customfilename'] + suffix;
                    }
                    else {
                        fileName = exportResult.fileName;
                    }
                }
                /** @type {?} */
                var preurl = DataIEUtils.GetPreUrl(befRestService.baseUri);
                _this.operateService.DownloadFile(exportResult.docRelativePath, fileName, preurl, option);
                /** @type {?} */
                var subscriber_1 = _this.operateService.downloadComplete.subscribe((/**
                 * @param {?} result
                 * @return {?}
                 */
                function (result) {
                    _this.CloseLoading();
                    if (result === '') {
                        _this.export.emit('');
                        subscriber_1.unsubscribe();
                    }
                    else {
                        _this.export.emit(result);
                        subscriber_1.unsubscribe();
                    }
                }), (/**
                 * @param {?} error
                 * @return {?}
                 */
                function (error) {
                    _this.CloseLoading();
                    _this.notify.error(error.message);
                }));
            }
            else {
                _this.CloseLoading();
                _this.errorlevel = exportResult.errorLevel;
                _this.export.emit(exportResult.message);
                // this.notify.error('数据导出失败！\n 失败原因：' + exportResult.message);
            }
        }), (/**
         * @param {?} error
         * @return {?}
         */
        function (error) {
            _this.CloseLoading();
            _this.notify.error(error.error.Message);
        }));
    };
    /**
     * 打包导出
     * @param repository
     * @param optionJson
     */
    /**
     * 打包导出
     * @param {?} repository
     * @param {?} optionJson
     * @return {?}
     */
    DataExportService.prototype.ExportByPackage = /**
     * 打包导出
     * @param {?} repository
     * @param {?} optionJson
     * @return {?}
     */
    function (repository, optionJson) {
        /** @type {?} */
        var packitems = optionJson.package.packitems;
        if (packitems === undefined || packitems === null || packitems.length === 0) {
            this.notify.error('请传入需要打包导出的规则信息');
            return;
        }
        this.StartLoading();
        /** @type {?} */
        var befRestService = DataIEUtils.GetBefRestService(repository);
        /** @type {?} */
        var relativePaths = [];
        /** @type {?} */
        var itemsFileName = [];
        this.ExecuteMutiRequest(packitems, befRestService, relativePaths, itemsFileName, optionJson);
    };
    /**
     * @param {?} packitems
     * @param {?} befRestService
     * @param {?} relativePaths
     * @param {?} itemsFileName
     * @param {?} optionJson
     * @return {?}
     */
    DataExportService.prototype.ExecuteMutiRequest = /**
     * @param {?} packitems
     * @param {?} befRestService
     * @param {?} relativePaths
     * @param {?} itemsFileName
     * @param {?} optionJson
     * @return {?}
     */
    function (packitems, befRestService, relativePaths, itemsFileName, optionJson) {
        var _this = this;
        if (packitems.length <= 0) {
            return;
        }
        /** @type {?} */
        var item = packitems.pop();
        /** @type {?} */
        var customfilename = '';
        /** @type {?} */
        var ruleId = item['ruleid'];
        if (ruleId === undefined || ruleId === '') {
            this.notify.error('请传入需要打包导出的规则id');
            this.CloseLoading();
            return;
        }
        /** @type {?} */
        var globalVar = '';
        if (item['globalParam'] !== null && item['globalParam'] !== undefined) {
            if (typeof (item['globalParam']) === 'object') {
                globalVar = JSON.stringify(item['globalParam']);
            }
            else {
                globalVar = item['globalParam'];
            }
        }
        /** @type {?} */
        var itemfilename = item['itemfilename'];
        if (itemfilename !== null && itemfilename !== undefined) {
            itemsFileName.push(itemfilename);
        }
        /** @type {?} */
        var funcId = getQueryString('funcId');
        /** @type {?} */
        var exportParam = null;
        /** @type {?} */
        var filter = item['filter'];
        if (filter !== undefined && filter !== null && JSON.stringify(filter) !== '{}') {
            exportParam = {
                body: {
                    exportContext: {
                        RuleId: ruleId,
                        Filter: filter,
                        GlobalParam: globalVar,
                        funcId: funcId
                    }
                }
            };
        }
        else {
            exportParam = {
                body: {
                    exportContext: {
                        RuleId: ruleId,
                        GlobalParam: globalVar,
                        funcId: funcId
                    }
                }
            };
        }
        /** @type {?} */
        var subject = befRestService.request(befRestService.baseUri + "/service/dataexportvmaction", 'put', null, exportParam);
        subject.subscribe((/**
         * @param {?} data
         * @return {?}
         */
        function (data) {
            /** @type {?} */
            var exportResult;
            if (isNullOrUndefined(data.returnValue)) {
                exportResult = (/** @type {?} */ (data));
            }
            else {
                exportResult = (/** @type {?} */ (data.returnValue));
            }
            if (exportResult.succeed === true) {
                relativePaths.push(exportResult.docRelativePath);
                customfilename = exportResult.fileName.split('.')[0];
                console.log('导出执行完毕，relativePath：' + JSON.stringify(exportResult.relativePath));
                if (packitems.length === 0) {
                    /** @type {?} */
                    var preurl = DataIEUtils.GetPreUrl(befRestService.baseUri);
                    if (optionJson.package.customfilename !== undefined && optionJson.package.customfilename !== '') {
                        customfilename = optionJson.package.customfilename;
                    }
                    /** @type {?} */
                    var packtype = 'zip';
                    if (optionJson.package.packtype !== undefined) {
                        packtype = optionJson.package.packtype;
                    }
                    if (itemsFileName.length === 0) {
                        itemsFileName = null;
                    }
                    _this.operateService.DownloadPackageFile(relativePaths, itemsFileName, customfilename, preurl, packtype);
                    /** @type {?} */
                    var subscriber_2 = _this.operateService.downloadComplete.subscribe((/**
                     * @param {?} result
                     * @return {?}
                     */
                    function (result) {
                        _this.CloseLoading();
                        if (result === '') {
                            _this.export.emit('');
                            subscriber_2.unsubscribe();
                        }
                        else {
                            _this.export.emit(result);
                            subscriber_2.unsubscribe();
                        }
                    }));
                }
                else {
                    _this.ExecuteMutiRequest(packitems, befRestService, relativePaths, itemsFileName, optionJson);
                }
            }
            else {
                _this.CloseLoading();
                _this.errorlevel = exportResult.errorLevel;
                _this.export.emit(exportResult.message);
            }
        }), (/**
         * @param {?} error
         * @return {?}
         */
        function (error) {
            _this.CloseLoading();
            _this.notify.error(error.error.Message);
        }));
    };
    /**
     * 手工表单导出
     * @param exportParam
     * @param option
     */
    /**
     * 手工表单导出
     * @param {?} exportParam
     * @param {?} option
     * @return {?}
     */
    DataExportService.prototype.Export4HandCraft = /**
     * 手工表单导出
     * @param {?} exportParam
     * @param {?} option
     * @return {?}
     */
    function (exportParam, option) {
        var _this = this;
        this.StartLoading();
        /** @type {?} */
        var su = option.su;
        /** @type {?} */
        var fixedUrl = this.origin + '/api/runtime/dip/v1.0/AllSteps/dataexportvmaction';
        this.http.put(fixedUrl, exportParam, {
            headers: {
                'Content-Type': 'application/json',
                'Access-Control-Allow-Origin': '*'
            },
            responseType: 'blob',
            observe: 'response',
            params: { su: su }
        }).subscribe((/**
         * @param {?} res
         * @return {?}
         */
        function (res) {
            _this.CloseLoading();
            console.log(res);
            /** @type {?} */
            var data = res.body;
            if (data.type == 'application/json') {
                /** @type {?} */
                var reader_1 = new FileReader();
                reader_1.onload = (/**
                 * @param {?} e
                 * @return {?}
                 */
                function (e) {
                    /** @type {?} */
                    var dataIeResult = (/** @type {?} */ (JSON.parse((/** @type {?} */ (reader_1.result)))));
                    if (!dataIeResult.succeed) {
                        _this.errorlevel = dataIeResult.errorLevel;
                        _this.export.emit(dataIeResult.message);
                    }
                });
                reader_1.readAsText(data, 'utf-8');
            }
            else {
                /** @type {?} */
                var fileName = '';
                /** @type {?} */
                var contentDisposition = res.headers.get("content-disposition");
                if (contentDisposition) {
                    // 正则获取filename的值
                    /** @type {?} */
                    var filenameRegex = /filename[^;=\n]*=((['"]).*?\2|[^;\n]*)/;
                    /** @type {?} */
                    var matches = filenameRegex.exec(contentDisposition);
                    if (matches != null && matches[1]) {
                        fileName = matches[1].replace(/['"]/g, '');
                    }
                    // 通过 URLEncoder.encode(pFileName, StandardCharsets.UTF_8.name()) 加密编码的, 使用decodeURI(fileName) 解密
                    fileName = decodeURI(fileName);
                    // 通过 new String(pFileName.getBytes(), StandardCharsets.ISO_8859_1) 加密编码的, 使用decodeURI(escape(fileName)) 解密
                    // fileName = decodeURI(escape(fileName))
                }
                if (!isNullOrUndefined(option.customfilename)) {
                    /** @type {?} */
                    var suffixIndex = fileName.lastIndexOf('.');
                    /** @type {?} */
                    var suffix = fileName.substring(suffixIndex);
                    fileName = option.customfilename + suffix;
                }
                /** @type {?} */
                var blob = new Blob([data]);
                if (!data || data.size == 0) {
                    _this.export.emit('返回的数据为空');
                }
                else {
                    if (navigator.msSaveOrOpenBlob) {
                        navigator.msSaveOrOpenBlob(blob, fileName);
                    }
                    else {
                        /** @type {?} */
                        var link = document.createElement('a');
                        link.setAttribute('href', window.URL.createObjectURL(blob));
                        // 设置下载的文件名
                        link.setAttribute('download', fileName);
                        link.style.visibility = 'hidden';
                        document.body.appendChild(link);
                        link.click();
                        document.body.removeChild(link);
                    }
                    _this.export.emit('');
                }
            }
        }), (/**
         * @param {?} error
         * @return {?}
         */
        function (error) {
            _this.CloseLoading();
            _this.notify.error(error.error.Message);
        }));
    };
    /**
     * @return {?}
     */
    DataExportService.prototype.StartLoading = /**
     * @return {?}
     */
    function () {
        if (this.loadingService !== undefined && this.loadingService !== null) {
            this.loadingService.show();
        }
    };
    /**
     * @return {?}
     */
    DataExportService.prototype.CloseLoading = /**
     * @return {?}
     */
    function () {
        if (this.loadingService !== undefined && this.loadingService !== null) {
            this.loadingService.clearAll();
        }
    };
    /**
     * @param {?} ruleId
     * @param {?} frameContext
     * @param {?} pageIndex
     * @param {?} pageSize
     * @param {?} option
     * @param {?=} suffix
     * @return {?}
     */
    DataExportService.prototype.ExportCurrentData = /**
     * @param {?} ruleId
     * @param {?} frameContext
     * @param {?} pageIndex
     * @param {?} pageSize
     * @param {?} option
     * @param {?=} suffix
     * @return {?}
     */
    function (ruleId, frameContext, pageIndex, pageSize, option, suffix) {
        /** @type {?} */
        var exportParam = null;
        /** @type {?} */
        var model = '';
        if (option.Models !== undefined && option.Models !== null && option.Models.length > 0) {
            model = JSON.stringify(option.Models[0]);
        }
        /** @type {?} */
        var globalVar = '';
        if (option['globalParam'] !== null && option['globalParam'] !== undefined) {
            if (typeof (option['globalParam']) === 'object') {
                globalVar = JSON.stringify(option['globalParam']);
            }
            else {
                globalVar = option['globalParam'];
            }
        }
        if (suffix === null || suffix === undefined) {
            suffix = '';
        }
        /** @type {?} */
        var funcId = getQueryString('funcId');
        /** @type {?} */
        var filterParem = option['filter'];
        /** @type {?} */
        var newFilters = [];
        /** @type {?} */
        var selectFilterGridComponent = option['selectFilterGridComponent'];
        if (!isNullOrUndefined(selectFilterGridComponent) && !isNullOrEmpty(selectFilterGridComponent)) {
            /** @type {?} */
            var ids = frameContext.appContext.frameContextManager.getFrameContextById(selectFilterGridComponent).uiState['ids'];
            if (!isNullOrUndefined(ids) && ids.length > 0) {
                /** @type {?} */
                var idsStr = '';
                for (var i = 0; i < ids.length; i++) {
                    /** @type {?} */
                    var id = ids[i];
                    if (i === ids.length - 1) {
                        idsStr += id;
                    }
                    else {
                        idsStr += id + '\r\n';
                    }
                }
                /** @type {?} */
                var selectIdFilterCondition = {
                    FilterField: "ID",
                    Compare: 14,
                    Value: idsStr,
                    Relation: 1,
                    Expresstype: 0
                };
                newFilters.push(selectIdFilterCondition);
            }
            else {
                this.notify.info(this.i18nResource['select_data_export']);
                return;
            }
        }
        /** @type {?} */
        var filterConditionList = frameContext.uiState['filterConditionList'];
        if (filterConditionList !== undefined && filterConditionList !== null && filterConditionList !== '' && filterConditionList !== '[]') {
            /** @type {?} */
            var filterConditionListJson = void 0;
            if (typeof (filterConditionList) === 'string') {
                filterConditionListJson = JSON.parse(filterConditionList);
            }
            else {
                filterConditionListJson = filterConditionList;
            }
            for (var index = 0; index < filterConditionListJson.length; index++) {
                /** @type {?} */
                var element = filterConditionListJson[index];
                /** @type {?} */
                var value = decodeURIComponent(element.Value);
                element.Value = value;
                newFilters.push(element);
            }
        }
        if (newFilters.length > 0) {
            if (!isNullOrUndefined(filterParem) && filterParem.FilterConditions !== null) {
                filterParem.FilterConditions = newFilters.concat(filterParem.FilterConditions);
            }
            else {
                if (isNullOrUndefined(filterParem)) {
                    filterParem = {};
                }
                filterParem['FilterConditions'] = newFilters;
            }
        }
        if (isNullOrUndefined(filterParem)) {
            exportParam = {
                body: {
                    exportContext: {
                        RuleId: ruleId,
                        Suffix: suffix,
                        PaginationInfo: {
                            PageIndex: pageIndex,
                            PageSize: pageSize
                        },
                        Model: model,
                        GlobalParam: globalVar,
                        funcId: funcId
                    }
                }
            };
        }
        else {
            //确保最后一个关系为空
            if (!isNullOrUndefined(filterParem.FilterConditions) && filterParem.FilterConditions.length > 0) {
                filterParem.FilterConditions[filterParem.FilterConditions.length - 1].Relation = 0;
            }
            exportParam = {
                body: {
                    exportContext: {
                        RuleId: ruleId,
                        Filter: filterParem,
                        Suffix: suffix,
                        PaginationInfo: {
                            PageIndex: pageIndex,
                            PageSize: pageSize
                        },
                        Model: model,
                        GlobalParam: globalVar,
                        funcId: funcId
                    }
                }
            };
        }
        this.Export(frameContext.repository, exportParam, option);
    };
    /**
     * @param {?} ruleId
     * @param {?} frameContext
     * @param {?} option
     * @param {?=} suffix
     * @return {?}
     */
    DataExportService.prototype.ExportById = /**
     * @param {?} ruleId
     * @param {?} frameContext
     * @param {?} option
     * @param {?=} suffix
     * @return {?}
     */
    function (ruleId, frameContext, option, suffix) {
        /** @type {?} */
        var exportParam = null;
        /** @type {?} */
        var model = '';
        if (option.Models !== undefined && option.Models !== null && option.Models.length > 0) {
            model = JSON.stringify(option.Models[0]);
        }
        /** @type {?} */
        var globalVar = '';
        if (option['globalParam'] !== null && option['globalParam'] !== undefined) {
            if (typeof (option['globalParam']) === 'object') {
                globalVar = JSON.stringify(option['globalParam']);
            }
            else {
                globalVar = option['globalParam'];
            }
        }
        if (suffix === null || suffix === undefined) {
            suffix = '';
        }
        /** @type {?} */
        var funcId = getQueryString('funcId');
        /** @type {?} */
        var filterParam = option['filter'];
        /** @type {?} */
        var newFilters = [];
        /** @type {?} */
        var selectFilterGridComponent = option['selectFilterGridComponent'];
        if (!isNullOrUndefined(selectFilterGridComponent) && !isNullOrEmpty(selectFilterGridComponent)) {
            /** @type {?} */
            var ids = frameContext.appContext.frameContextManager.getFrameContextById(selectFilterGridComponent).uiState['ids'];
            if (!isNullOrUndefined(ids) && ids.length > 0) {
                /** @type {?} */
                var idsStr = '';
                for (var i = 0; i < ids.length; i++) {
                    /** @type {?} */
                    var id = ids[i];
                    if (i === ids.length - 1) {
                        idsStr += id;
                    }
                    else {
                        idsStr += id + '\r\n';
                    }
                }
                /** @type {?} */
                var selectIdFilterCondition = {
                    FilterField: "ID",
                    Compare: 14,
                    Value: idsStr,
                    Relation: 1,
                    Expresstype: 0
                };
                newFilters.push(selectIdFilterCondition);
            }
            else {
                this.notify.info(this.i18nResource['select_data_export']);
                return;
            }
        }
        if (option['enableScreeningScheme'] === true) {
            /** @type {?} */
            var filterConditionList = frameContext.uiState['filterConditionList'];
            if (filterConditionList !== undefined && filterConditionList !== null && filterConditionList !== '' && filterConditionList !== '[]') {
                /** @type {?} */
                var filterConditionListJson = void 0;
                if (typeof (filterConditionList) === 'string') {
                    filterConditionListJson = JSON.parse(filterConditionList);
                }
                else {
                    filterConditionListJson = filterConditionList;
                }
                for (var index = 0; index < filterConditionListJson.length; index++) {
                    /** @type {?} */
                    var element = filterConditionListJson[index];
                    /** @type {?} */
                    var value = decodeURIComponent(element.Value);
                    // if (typeof (value) === 'string' && value.includes('\r\n')) {
                    //     element.Value = value.replace('\r\n', '\\r\\n');
                    // } else {
                    // }
                    element.Value = value;
                    newFilters.push(element);
                }
            }
        }
        if (newFilters.length > 0) {
            if (!isNullOrUndefined(filterParam) && filterParam.FilterConditions !== null) {
                filterParam.FilterConditions = newFilters.concat(filterParam.FilterConditions);
            }
            else {
                if (isNullOrUndefined(filterParam)) {
                    filterParam = {};
                }
                filterParam['FilterConditions'] = newFilters;
            }
        }
        if (isNullOrUndefined(filterParam)) {
            exportParam = {
                body: {
                    exportContext: {
                        RuleId: ruleId,
                        Suffix: suffix,
                        Model: model,
                        GlobalParam: globalVar,
                        funcId: funcId
                    }
                }
            };
        }
        else {
            //确保最后一个关系为空
            if (!isNullOrUndefined(filterParam.FilterConditions) && filterParam.FilterConditions.length > 0) {
                filterParam.FilterConditions[filterParam.FilterConditions.length - 1].Relation = 0;
            }
            exportParam = {
                body: {
                    exportContext: {
                        RuleId: ruleId,
                        Filter: filterParam,
                        Suffix: suffix,
                        Model: model,
                        GlobalParam: globalVar,
                        funcId: funcId
                    }
                }
            };
        }
        this.Export(frameContext.repository, exportParam, option);
    };
    /**
     * @param {?} ruleId
     * @param {?} option
     * @param {?=} suffix
     * @return {?}
     */
    DataExportService.prototype.ExportById4HandCraft = /**
     * @param {?} ruleId
     * @param {?} option
     * @param {?=} suffix
     * @return {?}
     */
    function (ruleId, option, suffix) {
        /** @type {?} */
        var globalVar = '';
        if (!isNullOrUndefined(option['globalParam'])) {
            if (typeof (option['globalParam']) === 'object') {
                globalVar = JSON.stringify(option['globalParam']);
            }
            else {
                globalVar = option['globalParam'];
            }
        }
        if (isNullOrUndefined(suffix)) {
            suffix = '';
        }
        /** @type {?} */
        var funcId = '';
        if (!isNullOrUndefined(option.funcId)) {
            funcId = option.funcId;
        }
        /** @type {?} */
        var exportParam = {
            ruleId: ruleId,
            filter: option['filter'],
            suffix: suffix,
            globalParam: globalVar,
            funcId: funcId
        };
        this.Export4HandCraft(exportParam, option);
    };
    /**
     * @param {?} ruleId
     * @param {?} frameContext
     * @param {?} option
     * @param {?=} suffix
     * @return {?}
     */
    DataExportService.prototype.ExportCurrentChildData = /**
     * @param {?} ruleId
     * @param {?} frameContext
     * @param {?} option
     * @param {?=} suffix
     * @return {?}
     */
    function (ruleId, frameContext, option, suffix) {
        /** @type {?} */
        var exportParam = null;
        /** @type {?} */
        var globalVar = '';
        if (option['globalParam'] !== null && option['globalParam'] !== undefined) {
            if (typeof (option['globalParam']) === 'object') {
                globalVar = JSON.stringify(option['globalParam']);
            }
            else {
                globalVar = option['globalParam'];
            }
        }
        if (suffix === null || suffix === undefined) {
            suffix = '';
        }
        /** @type {?} */
        var funcId = getQueryString('funcId');
        exportParam = {
            body: {
                exportContext: {
                    RuleId: ruleId,
                    Suffix: suffix,
                    MainObjId: frameContext.bindingData.list.currentId,
                    GlobalParam: globalVar,
                    funcId: funcId
                }
            }
        };
        this.Export(frameContext.repository, exportParam, option);
    };
    DataExportService.decorators = [
        { type: Injectable }
    ];
    /** @nocollapse */
    DataExportService.ctorParameters = function () { return [
        { type: FileOperateService },
        { type: NotifyService },
        { type: HttpClient },
        { type: LoadingService }
    ]; };
    DataExportService.propDecorators = {
        export: [{ type: Output }]
    };
    return DataExportService;
}());
export { DataExportService };
if (false) {
    /**
     * @type {?}
     * @private
     */
    DataExportService.prototype.origin;
    /** @type {?} */
    DataExportService.prototype.export;
    /** @type {?} */
    DataExportService.prototype.errorlevel;
    /** @type {?} */
    DataExportService.prototype.i18nResource;
    /**
     * @type {?}
     * @private
     */
    DataExportService.prototype.operateService;
    /**
     * @type {?}
     * @private
     */
    DataExportService.prototype.notify;
    /**
     * @type {?}
     * @private
     */
    DataExportService.prototype.http;
    /**
     * @type {?}
     * @private
     */
    DataExportService.prototype.loadingService;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGF0YS1leHBvcnQuc2VydmljZS5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0Bnc3AtZGlwL2RhdGEtaW1wLWV4cC8iLCJzb3VyY2VzIjpbImxpYi9zZXJ2aWNlL0RhdGFJRVNlcnZpY2UvZGF0YS1leHBvcnQuc2VydmljZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7O0FBQUEsT0FBTyxFQUFDLFlBQVksRUFBRSxVQUFVLEVBQUUsTUFBTSxFQUFDLE1BQU0sZUFBZSxDQUFDO0FBRS9ELE9BQU8sRUFBQyxXQUFXLEVBQUUsY0FBYyxFQUFFLGFBQWEsRUFBRSxpQkFBaUIsRUFBQyxNQUFNLHNCQUFzQixDQUFDO0FBRW5HLE9BQU8sRUFBQyxrQkFBa0IsRUFBQyxNQUFNLHdCQUF3QixDQUFDO0FBQzFELE9BQU8sRUFBQyxhQUFhLEVBQUMsTUFBTSxtQkFBbUIsQ0FBQztBQUNoRCxPQUFPLEVBQUMsY0FBYyxFQUFDLE1BQU0sb0JBQW9CLENBQUM7QUFDbEQsT0FBTyxFQUFDLFVBQVUsRUFBZSxNQUFNLHNCQUFzQixDQUFDO0FBRTlEO0lBVUUsMkJBQ1UsY0FBa0MsRUFDbEMsTUFBcUIsRUFDckIsSUFBZ0IsRUFDaEIsY0FBOEI7UUFKeEMsaUJBU0M7UUFSUyxtQkFBYyxHQUFkLGNBQWMsQ0FBb0I7UUFDbEMsV0FBTSxHQUFOLE1BQU0sQ0FBZTtRQUNyQixTQUFJLEdBQUosSUFBSSxDQUFZO1FBQ2hCLG1CQUFjLEdBQWQsY0FBYyxDQUFnQjtRQVhoQyxXQUFNLEdBQUcsTUFBTSxDQUFDLFFBQVEsQ0FBQyxNQUFNLENBQUM7UUFFeEMsV0FBTSxHQUFHLElBQUksWUFBWSxFQUFFLENBQUM7UUFXMUIsV0FBVyxDQUFDLGlCQUFpQixDQUFDLElBQUksQ0FBQyxDQUFDLFNBQVM7Ozs7UUFBQyxVQUFBLEdBQUc7WUFDL0MsS0FBSSxDQUFDLFlBQVksR0FBRyxHQUFHLENBQUM7UUFDMUIsQ0FBQyxFQUFDLENBQUM7SUFDTCxDQUFDO0lBRUQ7O09BRUc7Ozs7Ozs7O0lB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LEtBQUssSUFBSSxJQUFJLE1BQU0sS0FBSyxTQUFTLEVBQUU7WUFDM0MsTUFBTSxHQUFHLEVBQUUsQ0FBQztTQUNiOztZQUVLLE1BQU0sR0FBRyxjQUFjLENBQUMsUUFBUSxDQUFDO1FBR3ZDLFdBQVcsR0FBRztZQUNaLElBQUksRUFBRTtnQkFDSixhQUFhLEVBQUU7b0JBQ2IsTUFBTSxFQUFFLE1BQU07b0JBQ2QsTUFBTSxFQUFFLE1BQU07b0JBQ2QsU0FBUyxFQUFFLFlBQVksQ0FBQyxXQUFXLENBQUMsSUFBSSxDQUFDLFNBQVM7b0JBQ2xELFdBQVcsRUFBRSxTQUFTO29CQUN0QixNQUFNLEVBQUUsTUFBTTtpQkFDZjthQUNGO1NBQ0YsQ0FBQztRQUVGLElBQUksQ0FBQyxNQUFNLENBQUMsWUFBWSxDQUFDLFVBQVUsRUFBRSxXQUFXLEVBQUUsTUFBTSxDQUFDLENBQUM7SUFDNUQsQ0FBQzs7Z0JBOWpCRixVQUFVOzs7O2dCQUxILGtCQUFrQjtnQkFDbEIsYUFBYTtnQkFFYixVQUFVO2dCQURWLGNBQWM7Ozt5QkFPbkIsTUFBTTs7SUEyakJULHdCQUFDO0NBQUEsQUEvakJELElBK2pCQztTQTlqQlksaUJBQWlCOzs7Ozs7SUFFNUIsbUNBQXdDOztJQUN4QyxtQ0FDNEI7O0lBQzVCLHVDQUF1Qjs7SUFFdkIseUNBQWtCOzs7OztJQUdoQiwyQ0FBMEM7Ozs7O0lBQzFDLG1DQUE2Qjs7Ozs7SUFDN0IsaUNBQXdCOzs7OztJQUN4QiwyQ0FBc0MiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge0V2ZW50RW1pdHRlciwgSW5qZWN0YWJsZSwgT3V0cHV0fSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHtGcmFtZUNvbnRleHQsIFJlcG9zaXRvcnl9IGZyb20gJ0BmYXJyaXMvZGV2a2l0JztcclxuaW1wb3J0IHtEYXRhSUVVdGlscywgZ2V0UXVlcnlTdHJpbmcsIGlzTnVsbE9yRW1wdHksIGlzTnVsbE9yVW5kZWZpbmVkfSBmcm9tICcuLi9VdGlscy9EYXRhSUVVdGlscyc7XHJcbmltcG9ydCB7RGF0YUlFUmVzdWx0fSBmcm9tICcuLi9FbnRpdHkvRGF0YUlFUmVzdWx0JztcclxuaW1wb3J0IHtGaWxlT3BlcmF0ZVNlcnZpY2V9IGZyb20gJy4vZmlsZS1vcGVyYXRlLnNlcnZpY2UnO1xyXG5pbXBvcnQge05vdGlmeVNlcnZpY2V9IGZyb20gJ0BmYXJyaXMvdWktbm90aWZ5JztcclxuaW1wb3J0IHtMb2FkaW5nU2VydmljZX0gZnJvbSAnQGZhcnJpcy91aS1sb2FkaW5nJztcclxuaW1wb3J0IHtIdHRwQ2xpZW50LCBIdHRwUmVzcG9uc2V9IGZyb20gJ0Bhbmd1bGFyL2NvbW1vbi9odHRwJztcclxuXHJcbkBJbmplY3RhYmxlKClcclxuZXhwb3J0IGNsYXNzIERhdGFFeHBvcnRTZXJ2aWNlIHtcclxuXHJcbiAgcHJpdmF0ZSBvcmlnaW4gPSB3aW5kb3cubG9jYXRpb24ub3JpZ2luO1xyXG4gIEBPdXRwdXQoKVxyXG4gIGV4cG9ydCA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcclxuICBwdWJsaWMgZXJyb3JsZXZlbDogYW55O1xyXG4gIC8vIGxvYWRpbmdDb21wOiBMb2FkaW5nQ29tcG9uZW50ID0gbnVsbDtcclxuICBpMThuUmVzb3VyY2U6IGFueTtcclxuXHJcbiAgY29uc3RydWN0b3IoXHJcbiAgICBwcml2YXRlIG9wZXJhdGVTZXJ2aWNlOiBGaWxlT3BlcmF0ZVNlcnZpY2UsXHJcbiAgICBwcml2YXRlIG5vdGlmeTogTm90aWZ5U2VydmljZSxcclxuICAgIHByaXZhdGUgaHR0cDogSHR0cENsaWVudCxcclxuICAgIHByaXZhdGUgbG9hZGluZ1NlcnZpY2U6IExvYWRpbmdTZXJ2aWNlLFxyXG4gICkge1xyXG4gICAgRGF0YUlFVXRpbHMuZ2V0VHJhbnNsYXRlVmFsdWUoaHR0cCkuc3Vic2NyaWJlKHJlcyA9PiB7XHJcbiAgICAgIHRoaXMuaTE4blJlc291cmNlID0gcmVzO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDmlbDmja7lr7zlh7rmnI3liqFcclxuICAgKi9cclxuICBFeHBvcnQocmVwb3NpdG9yeTogUmVwb3NpdG9yeTxhbnk+LCBleHBvcnRQYXJhbTogYW55LCBvcHRpb246IGFueSkge1xyXG4gICAgdGhpcy5TdGFydExvYWRpbmcoKTtcclxuICAgIGNvbnN0IGJlZlJlc3RTZXJ2aWNlID0gRGF0YUlFVXRpbHMuR2V0QmVmUmVzdFNlcnZpY2UocmVwb3NpdG9yeSk7XHJcbiAgICBjb25zdCBzdWJqZWN0ID0gYmVmUmVzdFNlcnZpY2UucmVxdWVzdChgJHtiZWZSZXN0U2VydmljZS5iYXNlVXJpfS9zZXJ2aWNlL2RhdGFleHBvcnR2bWFjdGlvbmAsICdwdXQnLCBudWxsLCBleHBvcnRQYXJhbSk7XHJcbiAgICBzdWJqZWN0LnN1YnNjcmliZShkYXRhID0+IHtcclxuICAgICAgbGV0IGV4cG9ydFJlc3VsdCA9IGRhdGEucmV0dXJuVmFsdWUgYXMgRGF0YUlFUmVzdWx0O1xyXG4gICAgICBpZiAoaXNOdWxsT3JVbmRlZmluZWQoZXhwb3J0UmVzdWx0KSkge1xyXG4gICAgICAgIGV4cG9ydFJlc3VsdCA9IGRhdGEgYXMgRGF0YUlFUmVzdWx0O1xyXG4gICAgICB9XHJcbiAgICAgIGlmIChleHBvcnRSZXN1bHQuc3VjY2VlZCA9PT0gdHJ1ZSkge1xyXG4gICAgICAgIGxldCBmaWxlTmFtZSA9ICcnO1xyXG4gICAgICAgIGlmIChvcHRpb24gPT09ICcnIHx8IG9wdGlvblsnY3VzdG9tZmlsZW5hbWUnXSA9PT0gJycgfHwgb3B0aW9uWydjdXN0b21maWxlbmFtZSddID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgIGZpbGVOYW1lID0gZXhwb3J0UmVzdWx0LmZpbGVOYW1lO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBjb25zdCBzdWZmaXhJbmRleCA9IGV4cG9ydFJlc3VsdC5maWxlTmFtZS5sYXN0SW5kZXhPZignLicpO1xyXG4gICAgICAgICAgY29uc3Qgc3VmZml4ID0gZXhwb3J0UmVzdWx0LmZpbGVOYW1lLnN1YnN0cmluZyhzdWZmaXhJbmRleCk7XHJcbiAgICAgICAgICBpZiAoIURhdGFJRVV0aWxzLkp1ZGdlSWxsZWdhbENoYXIob3B0aW9uWydjdXN0b21maWxlbmFtZSddKSkge1xyXG4gICAgICAgICAgICBmaWxlTmFtZSA9IG9wdGlvblsnY3VzdG9tZmlsZW5hbWUnXSArIHN1ZmZpeDtcclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGZpbGVOYW1lID0gZXhwb3J0UmVzdWx0LmZpbGVOYW1lO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCBwcmV1cmwgPSBEYXRhSUVVdGlscy5HZXRQcmVVcmwoYmVmUmVzdFNlcnZpY2UuYmFzZVVyaSk7XHJcbiAgICAgICAgdGhpcy5vcGVyYXRlU2VydmljZS5Eb3dubG9hZEZpbGUoZXhwb3J0UmVzdWx0LmRvY1JlbGF0aXZlUGF0aCwgZmlsZU5hbWUsIHByZXVybCwgb3B0aW9uKTtcclxuICAgICAgICBjb25zdCBzdWJzY3JpYmVyID0gdGhpcy5vcGVyYXRlU2VydmljZS5kb3dubG9hZENvbXBsZXRlLnN1YnNjcmliZShyZXN1bHQgPT4ge1xyXG4gICAgICAgICAgdGhpcy5DbG9zZUxvYWRpbmcoKTtcclxuICAgICAgICAgIGlmIChyZXN1bHQgPT09ICcnKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZXhwb3J0LmVtaXQoJycpO1xyXG4gICAgICAgICAgICBzdWJzY3JpYmVyLnVuc3Vic2NyaWJlKCk7XHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLmV4cG9ydC5lbWl0KHJlc3VsdCk7XHJcbiAgICAgICAgICAgIHN1YnNjcmliZXIudW5zdWJzY3JpYmUoKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9LCBlcnJvciA9PiB7XHJcbiAgICAgICAgICB0aGlzLkNsb3NlTG9hZGluZygpO1xyXG4gICAgICAgICAgdGhpcy5ub3RpZnkuZXJyb3IoZXJyb3IubWVzc2FnZSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgdGhpcy5DbG9zZUxvYWRpbmcoKTtcclxuICAgICAgICB0aGlzLmVycm9ybGV2ZWwgPSBleHBvcnRSZXN1bHQuZXJyb3JMZXZlbDtcclxuICAgICAgICB0aGlzLmV4cG9ydC5lbWl0KGV4cG9ydFJlc3VsdC5tZXNzYWdlKTtcclxuICAgICAgICAvLyB0aGlzLm5vdGlmeS5lcnJvcign5pWw5o2u5a+85Ye65aSx6LSl77yBXFxuIOWksei0peWOn+WboO+8micgKyBleHBvcnRSZXN1bHQubWVzc2FnZSk7XHJcbiAgICAgIH1cclxuICAgIH0sIGVycm9yID0+IHtcclxuICAgICAgdGhpcy5DbG9zZUxvYWRpbmcoKTtcclxuICAgICAgdGhpcy5ub3RpZnkuZXJyb3IoZXJyb3IuZXJyb3IuTWVzc2FnZSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOaJk+WMheWvvOWHulxyXG4gICAqIEBwYXJhbSByZXBvc2l0b3J5XHJcbiAgICogQHBhcmFtIG9wdGlvbkpzb25cclxuICAgKi9cclxuICBFeHBvcnRCeVBhY2thZ2UocmVwb3NpdG9yeTogUmVwb3NpdG9yeTxhbnk+LCBvcHRpb25Kc29uOiBhbnkpIHtcclxuXHJcbiAgICBsZXQgcGFja2l0ZW1zOiBBcnJheTxvYmplY3Q+ID0gb3B0aW9uSnNvbi5wYWNrYWdlLnBhY2tpdGVtcztcclxuICAgIGlmIChwYWNraXRlbXMgPT09IHVuZGVmaW5lZCB8fCBwYWNraXRlbXMgPT09IG51bGwgfHwgcGFja2l0ZW1zLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICB0aGlzLm5vdGlmeS5lcnJvcign6K+35Lyg5YWl6ZyA6KaB5omT5YyF5a+85Ye655qE6KeE5YiZ5L+h5oGvJyk7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIHRoaXMuU3RhcnRMb2FkaW5nKCk7XHJcbiAgICBjb25zdCBiZWZSZXN0U2VydmljZSA9IERhdGFJRVV0aWxzLkdldEJlZlJlc3RTZXJ2aWNlKHJlcG9zaXRvcnkpO1xyXG4gICAgbGV0IHJlbGF0aXZlUGF0aHMgPSBbXTtcclxuICAgIGxldCBpdGVtc0ZpbGVOYW1lID0gW107XHJcbiAgICB0aGlzLkV4ZWN1dGVNdXRpUmVxdWVzdChwYWNraXRlbXMsIGJlZlJlc3RTZXJ2aWNlLCByZWxhdGl2ZVBhdGhzLCBpdGVtc0ZpbGVOYW1lLCBvcHRpb25Kc29uKTtcclxuXHJcbiAgfVxyXG5cclxuICBFeGVjdXRlTXV0aVJlcXVlc3QocGFja2l0ZW1zOiBBcnJheTxvYmplY3Q+LCBiZWZSZXN0U2VydmljZTogYW55LCByZWxhdGl2ZVBhdGhzOiBhbnksIGl0ZW1zRmlsZU5hbWU6IGFueSwgb3B0aW9uSnNvbjogYW55KSB7XHJcbiAgICBpZiAocGFja2l0ZW1zLmxlbmd0aCA8PSAwKSB7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIGNvbnN0IGl0ZW0gPSBwYWNraXRlbXMucG9wKCk7XHJcblxyXG4gICAgbGV0IGN1c3RvbWZpbGVuYW1lID0gJyc7XHJcbiAgICBjb25zdCBydWxlSWQgPSBpdGVtWydydWxlaWQnXTtcclxuICAgIGlmIChydWxlSWQgPT09IHVuZGVmaW5lZCB8fCBydWxlSWQgPT09ICcnKSB7XHJcbiAgICAgIHRoaXMubm90aWZ5LmVycm9yKCfor7fkvKDlhaXpnIDopoHmiZPljIXlr7zlh7rnmoTop4TliJlpZCcpO1xyXG4gICAgICB0aGlzLkNsb3NlTG9hZGluZygpO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBsZXQgZ2xvYmFsVmFyID0gJyc7XHJcbiAgICBpZiAoaXRlbVsnZ2xvYmFsUGFyYW0nXSAhPT0gbnVsbCAmJiBpdGVtWydnbG9iYWxQYXJhbSddICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgaWYgKHR5cGVvZiAoaXRlbVsnZ2xvYmFsUGFyYW0nXSkgPT09ICdvYmplY3QnKSB7XHJcbiAgICAgICAgZ2xvYmFsVmFyID0gSlNPTi5zdHJpbmdpZnkoaXRlbVsnZ2xvYmFsUGFyYW0nXSk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgZ2xvYmFsVmFyID0gaXRlbVsnZ2xvYmFsUGFyYW0nXTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgbGV0IGl0ZW1maWxlbmFtZSA9IGl0ZW1bJ2l0ZW1maWxlbmFtZSddO1xyXG4gICAgaWYgKGl0ZW1maWxlbmFtZSAhPT0gbnVsbCAmJiBpdGVtZmlsZW5hbWUgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICBpdGVtc0ZpbGVOYW1lLnB1c2goaXRlbWZpbGVuYW1lKTtcclxuICAgIH1cclxuICAgIGNvbnN0IGZ1bmNJZCA9IGdldFF1ZXJ5U3RyaW5nKCdmdW5jSWQnKTtcclxuICAgIGxldCBleHBvcnRQYXJhbSA9IG51bGw7XHJcbiAgICBjb25zdCBmaWx0ZXIgPSBpdGVtWydmaWx0ZXInXTtcclxuICAgIGlmIChmaWx0ZXIgIT09IHVuZGVmaW5lZCAmJiBmaWx0ZXIgIT09IG51bGwgJiYgSlNPTi5zdHJpbmdpZnkoZmlsdGVyKSAhPT0gJ3t9Jykge1xyXG4gICAgICBleHBvcnRQYXJhbSA9IHtcclxuICAgICAgICBib2R5OiB7XHJcbiAgICAgICAgICBleHBvcnRDb250ZXh0OiB7XHJcbiAgICAgICAgICAgIFJ1bGVJZDogcnVsZUlkLFxyXG4gICAgICAgICAgICBGaWx0ZXI6IGZpbHRlcixcclxuICAgICAgICAgICAgR2xvYmFsUGFyYW06IGdsb2JhbFZhcixcclxuICAgICAgICAgICAgZnVuY0lkOiBmdW5jSWRcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH07XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBleHBvcnRQYXJhbSA9IHtcclxuICAgICAgICBib2R5OiB7XHJcbiAgICAgICAgICBleHBvcnRDb250ZXh0OiB7XHJcbiAgICAgICAgICAgIFJ1bGVJZDogcnVsZUlkLFxyXG4gICAgICAgICAgICBHbG9iYWxQYXJhbTogZ2xvYmFsVmFyLFxyXG4gICAgICAgICAgICBmdW5jSWQ6IGZ1bmNJZFxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfTtcclxuICAgIH1cclxuICAgIGNvbnN0IHN1YmplY3QgPSBiZWZSZXN0U2VydmljZS5yZXF1ZXN0KGAke2JlZlJlc3RTZXJ2aWNlLmJhc2VVcml9L3NlcnZpY2UvZGF0YWV4cG9ydHZtYWN0aW9uYCwgJ3B1dCcsIG51bGwsIGV4cG9ydFBhcmFtKTtcclxuICAgIHN1YmplY3Quc3Vic2NyaWJlKGRhdGEgPT4ge1xyXG4gICAgICBsZXQgZXhwb3J0UmVzdWx0O1xyXG4gICAgICBpZiAoaXNOdWxsT3JVbmRlZmluZWQoZGF0YS5yZXR1cm5WYWx1ZSkpIHtcclxuICAgICAgICBleHBvcnRSZXN1bHQgPSBkYXRhIGFzIERhdGFJRVJlc3VsdDtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBleHBvcnRSZXN1bHQgPSBkYXRhLnJldHVyblZhbHVlIGFzIERhdGFJRVJlc3VsdDtcclxuICAgICAgfVxyXG4gICAgICBpZiAoZXhwb3J0UmVzdWx0LnN1Y2NlZWQgPT09IHRydWUpIHtcclxuICAgICAgICByZWxhdGl2ZVBhdGhzLnB1c2goZXhwb3J0UmVzdWx0LmRvY1JlbGF0aXZlUGF0aCk7XHJcbiAgICAgICAgY3VzdG9tZmlsZW5hbWUgPSBleHBvcnRSZXN1bHQuZmlsZU5hbWUuc3BsaXQoJy4nKVswXTtcclxuICAgICAgICBjb25zb2xlLmxvZygn5a+85Ye65omn6KGM5a6M5q+V77yMcmVsYXRpdmVQYXRo77yaJyArIEpTT04uc3RyaW5naWZ5KGV4cG9ydFJlc3VsdC5yZWxhdGl2ZVBhdGgpKTtcclxuXHJcbiAgICAgICAgaWYgKHBhY2tpdGVtcy5sZW5ndGggPT09IDApIHtcclxuICAgICAgICAgIGNvbnN0IHByZXVybCA9IERhdGFJRVV0aWxzLkdldFByZVVybChiZWZSZXN0U2VydmljZS5iYXNlVXJpKTtcclxuICAgICAgICAgIGlmIChvcHRpb25Kc29uLnBhY2thZ2UuY3VzdG9tZmlsZW5hbWUgIT09IHVuZGVmaW5lZCAmJiBvcHRpb25Kc29uLnBhY2thZ2UuY3VzdG9tZmlsZW5hbWUgIT09ICcnKSB7XHJcbiAgICAgICAgICAgIGN1c3RvbWZpbGVuYW1lID0gb3B0aW9uSnNvbi5wYWNrYWdlLmN1c3RvbWZpbGVuYW1lO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgbGV0IHBhY2t0eXBlID0gJ3ppcCc7XHJcbiAgICAgICAgICBpZiAob3B0aW9uSnNvbi5wYWNrYWdlLnBhY2t0eXBlICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgcGFja3R5cGUgPSBvcHRpb25Kc29uLnBhY2thZ2UucGFja3R5cGU7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBpZiAoaXRlbXNGaWxlTmFtZS5sZW5ndGggPT09IDApIHtcclxuICAgICAgICAgICAgaXRlbXNGaWxlTmFtZSA9IG51bGw7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICB0aGlzLm9wZXJhdGVTZXJ2aWNlLkRvd25sb2FkUGFja2FnZUZpbGUocmVsYXRpdmVQYXRocywgaXRlbXNGaWxlTmFtZSwgY3VzdG9tZmlsZW5hbWUsIHByZXVybCwgcGFja3R5cGUpO1xyXG4gICAgICAgICAgY29uc3Qgc3Vic2NyaWJlciA9IHRoaXMub3BlcmF0ZVNlcnZpY2UuZG93bmxvYWRDb21wbGV0ZS5zdWJzY3JpYmUocmVzdWx0ID0+IHtcclxuICAgICAgICAgICAgdGhpcy5DbG9zZUxvYWRpbmcoKTtcclxuICAgICAgICAgICAgaWYgKHJlc3VsdCA9PT0gJycpIHtcclxuICAgICAgICAgICAgICB0aGlzLmV4cG9ydC5lbWl0KCcnKTtcclxuICAgICAgICAgICAgICBzdWJzY3JpYmVyLnVuc3Vic2NyaWJlKCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgdGhpcy5leHBvcnQuZW1pdChyZXN1bHQpO1xyXG4gICAgICAgICAgICAgIHN1YnNjcmliZXIudW5zdWJzY3JpYmUoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIHRoaXMuRXhlY3V0ZU11dGlSZXF1ZXN0KHBhY2tpdGVtcywgYmVmUmVzdFNlcnZpY2UsIHJlbGF0aXZlUGF0aHMsIGl0ZW1zRmlsZU5hbWUsIG9wdGlvbkpzb24pO1xyXG4gICAgICAgIH1cclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICB0aGlzLkNsb3NlTG9hZGluZygpO1xyXG4gICAgICAgIHRoaXMuZXJyb3JsZXZlbCA9IGV4cG9ydFJlc3VsdC5lcnJvckxldmVsO1xyXG4gICAgICAgIHRoaXMuZXhwb3J0LmVtaXQoZXhwb3J0UmVzdWx0Lm1lc3NhZ2UpO1xyXG4gICAgICB9XHJcbiAgICB9LCBlcnJvciA9PiB7XHJcbiAgICAgIHRoaXMuQ2xvc2VMb2FkaW5nKCk7XHJcbiAgICAgIHRoaXMubm90aWZ5LmVycm9yKGVycm9yLmVycm9yLk1lc3NhZ2UpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDmiYvlt6XooajljZXlr7zlh7pcclxuICAgKiBAcGFyYW0gZXhwb3J0UGFyYW1cclxuICAgKiBAcGFyYW0gb3B0aW9uXHJcbiAgICovXHJcbiAgRXhwb3J0NEhhbmRDcmFmdChleHBvcnRQYXJhbTogYW55LCBvcHRpb246IGFueSkge1xyXG4gICAgdGhpcy5TdGFydExvYWRpbmcoKTtcclxuICAgIGNvbnN0IHN1ID0gb3B0aW9uLnN1O1xyXG4gICAgY29uc3QgZml4ZWRVcmwgPSB0aGlzLm9yaWdpbiArICcvYXBpL3J1bnRpbWUvZGlwL3YxLjAvQWxsU3RlcHMvZGF0YWV4cG9ydHZtYWN0aW9uJztcclxuICAgIHRoaXMuaHR0cC5wdXQoZml4ZWRVcmwsIGV4cG9ydFBhcmFtLFxyXG4gICAgICB7XHJcbiAgICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcclxuICAgICAgICAgICdBY2Nlc3MtQ29udHJvbC1BbGxvdy1PcmlnaW4nOiAnKidcclxuICAgICAgICB9LFxyXG4gICAgICAgIHJlc3BvbnNlVHlwZTogJ2Jsb2InLFxyXG4gICAgICAgIG9ic2VydmU6ICdyZXNwb25zZScsXHJcbiAgICAgICAgcGFyYW1zOiB7c3U6IHN1fVxyXG4gICAgICB9KS5zdWJzY3JpYmUoKHJlczogSHR0cFJlc3BvbnNlPEJsb2I+KSA9PiB7XHJcbiAgICAgIHRoaXMuQ2xvc2VMb2FkaW5nKCk7XHJcbiAgICAgIGNvbnNvbGUubG9nKHJlcyk7XHJcbiAgICAgIGNvbnN0IGRhdGEgPSByZXMuYm9keTtcclxuICAgICAgaWYgKGRhdGEudHlwZSA9PSAnYXBwbGljYXRpb24vanNvbicpIHtcclxuICAgICAgICBjb25zdCByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpO1xyXG4gICAgICAgIHJlYWRlci5vbmxvYWQgPSAoZSkgPT4ge1xyXG4gICAgICAgICAgY29uc3QgZGF0YUllUmVzdWx0ID0gSlNPTi5wYXJzZShyZWFkZXIucmVzdWx0IGFzIHN0cmluZykgYXMgRGF0YUlFUmVzdWx0O1xyXG4gICAgICAgICAgaWYoIWRhdGFJZVJlc3VsdC5zdWNjZWVkKXtcclxuICAgICAgICAgICAgICB0aGlzLmVycm9ybGV2ZWwgPSBkYXRhSWVSZXN1bHQuZXJyb3JMZXZlbDtcclxuICAgICAgICAgICAgICB0aGlzLmV4cG9ydC5lbWl0KGRhdGFJZVJlc3VsdC5tZXNzYWdlKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICAgIHJlYWRlci5yZWFkQXNUZXh0KGRhdGEsICd1dGYtOCcpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGxldCBmaWxlTmFtZSA9ICcnO1xyXG4gICAgICAgIGxldCBjb250ZW50RGlzcG9zaXRpb24gPSByZXMuaGVhZGVycy5nZXQoXCJjb250ZW50LWRpc3Bvc2l0aW9uXCIpO1xyXG4gICAgICAgIGlmIChjb250ZW50RGlzcG9zaXRpb24pIHtcclxuICAgICAgICAgIC8vIOato+WImeiOt+WPlmZpbGVuYW1l55qE5YC8XHJcbiAgICAgICAgICBsZXQgZmlsZW5hbWVSZWdleCA9IC9maWxlbmFtZVteOz1cXG5dKj0oKFsnXCJdKS4qP1xcMnxbXjtcXG5dKikvO1xyXG4gICAgICAgICAgbGV0IG1hdGNoZXMgPSBmaWxlbmFtZVJlZ2V4LmV4ZWMoY29udGVudERpc3Bvc2l0aW9uKTtcclxuICAgICAgICAgIGlmIChtYXRjaGVzICE9IG51bGwgJiYgbWF0Y2hlc1sxXSkge1xyXG4gICAgICAgICAgICBmaWxlTmFtZSA9IG1hdGNoZXNbMV0ucmVwbGFjZSgvWydcIl0vZywgJycpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgLy8g6YCa6L+HIFVSTEVuY29kZXIuZW5jb2RlKHBGaWxlTmFtZSwgU3RhbmRhcmRDaGFyc2V0cy5VVEZfOC5uYW1lKCkpIOWKoOWvhue8lueggeeahCwg5L2/55SoZGVjb2RlVVJJKGZpbGVOYW1lKSDop6Plr4ZcclxuICAgICAgICAgIGZpbGVOYW1lID0gZGVjb2RlVVJJKGZpbGVOYW1lKTtcclxuICAgICAgICAgIC8vIOmAmui/hyBuZXcgU3RyaW5nKHBGaWxlTmFtZS5nZXRCeXRlcygpLCBTdGFuZGFyZENoYXJzZXRzLklTT184ODU5XzEpIOWKoOWvhue8lueggeeahCwg5L2/55SoZGVjb2RlVVJJKGVzY2FwZShmaWxlTmFtZSkpIOino+WvhlxyXG4gICAgICAgICAgLy8gZmlsZU5hbWUgPSBkZWNvZGVVUkkoZXNjYXBlKGZpbGVOYW1lKSlcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYoIWlzTnVsbE9yVW5kZWZpbmVkKG9wdGlvbi5jdXN0b21maWxlbmFtZSkpe1xyXG4gICAgICAgICAgY29uc3Qgc3VmZml4SW5kZXggPSBmaWxlTmFtZS5sYXN0SW5kZXhPZignLicpO1xyXG4gICAgICAgICAgY29uc3Qgc3VmZml4ID0gZmlsZU5hbWUuc3Vic3RyaW5nKHN1ZmZpeEluZGV4KTtcclxuICAgICAgICAgIGZpbGVOYW1lID0gb3B0aW9uLmN1c3RvbWZpbGVuYW1lICsgc3VmZml4O1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3QgYmxvYiA9IG5ldyBCbG9iKFtkYXRhXSk7XHJcbiAgICAgICAgaWYgKCFkYXRhIHx8IGRhdGEuc2l6ZSA9PSAwKSB7XHJcbiAgICAgICAgICB0aGlzLmV4cG9ydC5lbWl0KCfov5Tlm57nmoTmlbDmja7kuLrnqbonKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgaWYgKG5hdmlnYXRvci5tc1NhdmVPck9wZW5CbG9iKSB7XHJcbiAgICAgICAgICAgIG5hdmlnYXRvci5tc1NhdmVPck9wZW5CbG9iKGJsb2IsIGZpbGVOYW1lKTtcclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGxpbmsgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7XHJcbiAgICAgICAgICAgIGxpbmsuc2V0QXR0cmlidXRlKCdocmVmJywgd2luZG93LlVSTC5jcmVhdGVPYmplY3RVUkwoYmxvYikpO1xyXG4gICAgICAgICAgICAvLyDorr7nva7kuIvovb3nmoTmlofku7blkI1cclxuICAgICAgICAgICAgbGluay5zZXRBdHRyaWJ1dGUoJ2Rvd25sb2FkJywgZmlsZU5hbWUpO1xyXG4gICAgICAgICAgICBsaW5rLnN0eWxlLnZpc2liaWxpdHkgPSAnaGlkZGVuJztcclxuICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChsaW5rKTtcclxuICAgICAgICAgICAgbGluay5jbGljaygpO1xyXG4gICAgICAgICAgICBkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKGxpbmspO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgdGhpcy5leHBvcnQuZW1pdCgnJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9LCBlcnJvciA9PiB7XHJcbiAgICAgIHRoaXMuQ2xvc2VMb2FkaW5nKCk7XHJcbiAgICAgIHRoaXMubm90aWZ5LmVycm9yKGVycm9yLmVycm9yLk1lc3NhZ2UpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBTdGFydExvYWRpbmcoKSB7XHJcbiAgICBpZiAodGhpcy5sb2FkaW5nU2VydmljZSAhPT0gdW5kZWZpbmVkICYmIHRoaXMubG9hZGluZ1NlcnZpY2UgIT09IG51bGwpIHtcclxuICAgICAgdGhpcy5sb2FkaW5nU2VydmljZS5zaG93KCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBDbG9zZUxvYWRpbmcoKSB7XHJcbiAgICBpZiAodGhpcy5sb2FkaW5nU2VydmljZSAhPT0gdW5kZWZpbmVkICYmIHRoaXMubG9hZGluZ1NlcnZpY2UgIT09IG51bGwpIHtcclxuICAgICAgdGhpcy5sb2FkaW5nU2VydmljZS5jbGVhckFsbCgpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcblxyXG4gIEV4cG9ydEN1cnJlbnREYXRhKHJ1bGVJZDogc3RyaW5nLCBmcmFtZUNvbnRleHQ6IEZyYW1lQ29udGV4dCwgcGFnZUluZGV4OiBudW1iZXIsIHBhZ2VTaXplOiBudW1iZXIsIG9wdGlvbjogYW55LCBzdWZmaXg/OiBzdHJpbmcpIHtcclxuICAgIGxldCBleHBvcnRQYXJhbSA9IG51bGw7XHJcbiAgICBsZXQgbW9kZWwgPSAnJztcclxuICAgIGlmIChvcHRpb24uTW9kZWxzICE9PSB1bmRlZmluZWQgJiYgb3B0aW9uLk1vZGVscyAhPT0gbnVsbCAmJiBvcHRpb24uTW9kZWxzLmxlbmd0aCA+IDApIHtcclxuICAgICAgbW9kZWwgPSBKU09OLnN0cmluZ2lmeShvcHRpb24uTW9kZWxzWzBdKTtcclxuICAgIH1cclxuICAgIGxldCBnbG9iYWxWYXIgPSAnJztcclxuICAgIGlmIChvcHRpb25bJ2dsb2JhbFBhcmFtJ10gIT09IG51bGwgJiYgb3B0aW9uWydnbG9iYWxQYXJhbSddICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgaWYgKHR5cGVvZiAob3B0aW9uWydnbG9iYWxQYXJhbSddKSA9PT0gJ29iamVjdCcpIHtcclxuICAgICAgICBnbG9iYWxWYXIgPSBKU09OLnN0cmluZ2lmeShvcHRpb25bJ2dsb2JhbFBhcmFtJ10pO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGdsb2JhbFZhciA9IG9wdGlvblsnZ2xvYmFsUGFyYW0nXTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgaWYgKHN1ZmZpeCA9PT0gbnVsbCB8fCBzdWZmaXggPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICBzdWZmaXggPSAnJztcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBmdW5jSWQgPSBnZXRRdWVyeVN0cmluZygnZnVuY0lkJyk7XHJcbiAgICBsZXQgZmlsdGVyUGFyZW0gPSBvcHRpb25bJ2ZpbHRlciddO1xyXG4gICAgY29uc3QgbmV3RmlsdGVycyA9IFtdO1xyXG5cclxuICAgIGNvbnN0IHNlbGVjdEZpbHRlckdyaWRDb21wb25lbnQgPSBvcHRpb25bJ3NlbGVjdEZpbHRlckdyaWRDb21wb25lbnQnXTtcclxuICAgIGlmICghaXNOdWxsT3JVbmRlZmluZWQoc2VsZWN0RmlsdGVyR3JpZENvbXBvbmVudCkgJiYgIWlzTnVsbE9yRW1wdHkoc2VsZWN0RmlsdGVyR3JpZENvbXBvbmVudCkpIHtcclxuICAgICAgY29uc3QgaWRzID0gZnJhbWVDb250ZXh0LmFwcENvbnRleHQuZnJhbWVDb250ZXh0TWFuYWdlci5nZXRGcmFtZUNvbnRleHRCeUlkKHNlbGVjdEZpbHRlckdyaWRDb21wb25lbnQpLnVpU3RhdGVbJ2lkcyddO1xyXG4gICAgICBpZiAoIWlzTnVsbE9yVW5kZWZpbmVkKGlkcykgJiYgaWRzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICBsZXQgaWRzU3RyID0gJyc7XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBpZHMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgIGNvbnN0IGlkID0gaWRzW2ldO1xyXG4gICAgICAgICAgaWYgKGkgPT09IGlkcy5sZW5ndGggLSAxKSB7XHJcbiAgICAgICAgICAgIGlkc1N0ciArPSBpZDtcclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGlkc1N0ciArPSBpZCArICdcXHJcXG4nO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCBzZWxlY3RJZEZpbHRlckNvbmRpdGlvbiA9IHtcclxuICAgICAgICAgIEZpbHRlckZpZWxkOiBcIklEXCIsXHJcbiAgICAgICAgICBDb21wYXJlOiAxNCxcclxuICAgICAgICAgIFZhbHVlOiBpZHNTdHIsXHJcbiAgICAgICAgICBSZWxhdGlvbjogMSxcclxuICAgICAgICAgIEV4cHJlc3N0eXBlOiAwXHJcbiAgICAgICAgfVxyXG4gICAgICAgIG5ld0ZpbHRlcnMucHVzaChzZWxlY3RJZEZpbHRlckNvbmRpdGlvbik7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgdGhpcy5ub3RpZnkuaW5mbyh0aGlzLmkxOG5SZXNvdXJjZVsnc2VsZWN0X2RhdGFfZXhwb3J0J10pO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IGZpbHRlckNvbmRpdGlvbkxpc3QgPSBmcmFtZUNvbnRleHQudWlTdGF0ZVsnZmlsdGVyQ29uZGl0aW9uTGlzdCddO1xyXG4gICAgaWYgKGZpbHRlckNvbmRpdGlvbkxpc3QgIT09IHVuZGVmaW5lZCAmJiBmaWx0ZXJDb25kaXRpb25MaXN0ICE9PSBudWxsICYmIGZpbHRlckNvbmRpdGlvbkxpc3QgIT09ICcnICYmIGZpbHRlckNvbmRpdGlvbkxpc3QgIT09ICdbXScpIHtcclxuICAgICAgbGV0IGZpbHRlckNvbmRpdGlvbkxpc3RKc29uO1xyXG4gICAgICBpZiAodHlwZW9mIChmaWx0ZXJDb25kaXRpb25MaXN0KSA9PT0gJ3N0cmluZycpIHtcclxuICAgICAgICBmaWx0ZXJDb25kaXRpb25MaXN0SnNvbiA9IEpTT04ucGFyc2UoZmlsdGVyQ29uZGl0aW9uTGlzdCk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgZmlsdGVyQ29uZGl0aW9uTGlzdEpzb24gPSBmaWx0ZXJDb25kaXRpb25MaXN0O1xyXG4gICAgICB9XHJcbiAgICAgIGZvciAobGV0IGluZGV4ID0gMDsgaW5kZXggPCBmaWx0ZXJDb25kaXRpb25MaXN0SnNvbi5sZW5ndGg7IGluZGV4KyspIHtcclxuICAgICAgICBjb25zdCBlbGVtZW50ID0gZmlsdGVyQ29uZGl0aW9uTGlzdEpzb25baW5kZXhdO1xyXG4gICAgICAgIGNvbnN0IHZhbHVlID0gZGVjb2RlVVJJQ29tcG9uZW50KGVsZW1lbnQuVmFsdWUpO1xyXG4gICAgICAgIGVsZW1lbnQuVmFsdWUgPSB2YWx1ZTtcclxuICAgICAgICBuZXdGaWx0ZXJzLnB1c2goZWxlbWVudCk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIGlmIChuZXdGaWx0ZXJzLmxlbmd0aCA+IDApIHtcclxuICAgICAgaWYgKCFpc051bGxPclVuZGVmaW5lZChmaWx0ZXJQYXJlbSkgJiYgZmlsdGVyUGFyZW0uRmlsdGVyQ29uZGl0aW9ucyAhPT0gbnVsbCkge1xyXG4gICAgICAgIGZpbHRlclBhcmVtLkZpbHRlckNvbmRpdGlvbnMgPSBuZXdGaWx0ZXJzLmNvbmNhdChmaWx0ZXJQYXJlbS5GaWx0ZXJDb25kaXRpb25zKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBpZiAoaXNOdWxsT3JVbmRlZmluZWQoZmlsdGVyUGFyZW0pKSB7XHJcbiAgICAgICAgICBmaWx0ZXJQYXJlbSA9IHt9O1xyXG4gICAgICAgIH1cclxuICAgICAgICBmaWx0ZXJQYXJlbVsnRmlsdGVyQ29uZGl0aW9ucyddID0gbmV3RmlsdGVycztcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgaWYgKGlzTnVsbE9yVW5kZWZpbmVkKGZpbHRlclBhcmVtKSkge1xyXG4gICAgICBleHBvcnRQYXJhbSA9IHtcclxuICAgICAgICBib2R5OiB7XHJcbiAgICAgICAgICBleHBvcnRDb250ZXh0OiB7XHJcbiAgICAgICAgICAgIFJ1bGVJZDogcnVsZUlkLFxyXG4gICAgICAgICAgICBTdWZmaXg6IHN1ZmZpeCxcclxuICAgICAgICAgICAgUGFnaW5hdGlvbkluZm86IHtcclxuICAgICAgICAgICAgICBQYWdlSW5kZXg6IHBhZ2VJbmRleCxcclxuICAgICAgICAgICAgICBQYWdlU2l6ZTogcGFnZVNpemVcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgTW9kZWw6IG1vZGVsLFxyXG4gICAgICAgICAgICBHbG9iYWxQYXJhbTogZ2xvYmFsVmFyLFxyXG4gICAgICAgICAgICBmdW5jSWQ6IGZ1bmNJZFxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIC8v56Gu5L+d5pyA5ZCO5LiA5Liq5YWz57O75Li656m6XHJcbiAgICAgIGlmICghaXNOdWxsT3JVbmRlZmluZWQoZmlsdGVyUGFyZW0uRmlsdGVyQ29uZGl0aW9ucykgJiYgZmlsdGVyUGFyZW0uRmlsdGVyQ29uZGl0aW9ucy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgZmlsdGVyUGFyZW0uRmlsdGVyQ29uZGl0aW9uc1tmaWx0ZXJQYXJlbS5GaWx0ZXJDb25kaXRpb25zLmxlbmd0aCAtIDFdLlJlbGF0aW9uID0gMDtcclxuICAgICAgfVxyXG4gICAgICBleHBvcnRQYXJhbSA9IHtcclxuICAgICAgICBib2R5OiB7XHJcbiAgICAgICAgICBleHBvcnRDb250ZXh0OiB7XHJcbiAgICAgICAgICAgIFJ1bGVJZDogcnVsZUlkLFxyXG4gICAgICAgICAgICBGaWx0ZXI6IGZpbHRlclBhcmVtLFxyXG4gICAgICAgICAgICBTdWZmaXg6IHN1ZmZpeCxcclxuICAgICAgICAgICAgUGFnaW5hdGlvbkluZm86IHtcclxuICAgICAgICAgICAgICBQYWdlSW5kZXg6IHBhZ2VJbmRleCxcclxuICAgICAgICAgICAgICBQYWdlU2l6ZTogcGFnZVNpemVcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgTW9kZWw6IG1vZGVsLFxyXG4gICAgICAgICAgICBHbG9iYWxQYXJhbTogZ2xvYmFsVmFyLFxyXG4gICAgICAgICAgICBmdW5jSWQ6IGZ1bmNJZFxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfTtcclxuICAgIH1cclxuXHJcblxyXG4gICAgdGhpcy5FeHBvcnQoZnJhbWVDb250ZXh0LnJlcG9zaXRvcnksIGV4cG9ydFBhcmFtLCBvcHRpb24pO1xyXG4gIH1cclxuXHJcbiAgRXhwb3J0QnlJZChydWxlSWQ6IHN0cmluZywgZnJhbWVDb250ZXh0OiBGcmFtZUNvbnRleHQsIG9wdGlvbjogYW55LCBzdWZmaXg/OiBzdHJpbmcpIHtcclxuICAgIGxldCBleHBvcnRQYXJhbSA9IG51bGw7XHJcbiAgICBsZXQgbW9kZWwgPSAnJztcclxuICAgIGlmIChvcHRpb24uTW9kZWxzICE9PSB1bmRlZmluZWQgJiYgb3B0aW9uLk1vZGVscyAhPT0gbnVsbCAmJiBvcHRpb24uTW9kZWxzLmxlbmd0aCA+IDApIHtcclxuICAgICAgbW9kZWwgPSBKU09OLnN0cmluZ2lmeShvcHRpb24uTW9kZWxzWzBdKTtcclxuICAgIH1cclxuICAgIGxldCBnbG9iYWxWYXIgPSAnJztcclxuICAgIGlmIChvcHRpb25bJ2dsb2JhbFBhcmFtJ10gIT09IG51bGwgJiYgb3B0aW9uWydnbG9iYWxQYXJhbSddICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgaWYgKHR5cGVvZiAob3B0aW9uWydnbG9iYWxQYXJhbSddKSA9PT0gJ29iamVjdCcpIHtcclxuICAgICAgICBnbG9iYWxWYXIgPSBKU09OLnN0cmluZ2lmeShvcHRpb25bJ2dsb2JhbFBhcmFtJ10pO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGdsb2JhbFZhciA9IG9wdGlvblsnZ2xvYmFsUGFyYW0nXTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgaWYgKHN1ZmZpeCA9PT0gbnVsbCB8fCBzdWZmaXggPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICBzdWZmaXggPSAnJztcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBmdW5jSWQgPSBnZXRRdWVyeVN0cmluZygnZnVuY0lkJyk7XHJcbiAgICBsZXQgZmlsdGVyUGFyYW0gPSBvcHRpb25bJ2ZpbHRlciddO1xyXG4gICAgY29uc3QgbmV3RmlsdGVycyA9IFtdO1xyXG5cclxuICAgIGNvbnN0IHNlbGVjdEZpbHRlckdyaWRDb21wb25lbnQgPSBvcHRpb25bJ3NlbGVjdEZpbHRlckdyaWRDb21wb25lbnQnXTtcclxuICAgIGlmICghaXNOdWxsT3JVbmRlZmluZWQoc2VsZWN0RmlsdGVyR3JpZENvbXBvbmVudCkgJiYgIWlzTnVsbE9yRW1wdHkoc2VsZWN0RmlsdGVyR3JpZENvbXBvbmVudCkpIHtcclxuICAgICAgY29uc3QgaWRzID0gZnJhbWVDb250ZXh0LmFwcENvbnRleHQuZnJhbWVDb250ZXh0TWFuYWdlci5nZXRGcmFtZUNvbnRleHRCeUlkKHNlbGVjdEZpbHRlckdyaWRDb21wb25lbnQpLnVpU3RhdGVbJ2lkcyddO1xyXG4gICAgICBpZiAoIWlzTnVsbE9yVW5kZWZpbmVkKGlkcykgJiYgaWRzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICBsZXQgaWRzU3RyID0gJyc7XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBpZHMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgIGNvbnN0IGlkID0gaWRzW2ldO1xyXG4gICAgICAgICAgaWYgKGkgPT09IGlkcy5sZW5ndGggLSAxKSB7XHJcbiAgICAgICAgICAgIGlkc1N0ciArPSBpZDtcclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGlkc1N0ciArPSBpZCArICdcXHJcXG4nO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCBzZWxlY3RJZEZpbHRlckNvbmRpdGlvbiA9IHtcclxuICAgICAgICAgIEZpbHRlckZpZWxkOiBcIklEXCIsXHJcbiAgICAgICAgICBDb21wYXJlOiAxNCxcclxuICAgICAgICAgIFZhbHVlOiBpZHNTdHIsXHJcbiAgICAgICAgICBSZWxhdGlvbjogMSxcclxuICAgICAgICAgIEV4cHJlc3N0eXBlOiAwXHJcbiAgICAgICAgfVxyXG4gICAgICAgIG5ld0ZpbHRlcnMucHVzaChzZWxlY3RJZEZpbHRlckNvbmRpdGlvbik7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgdGhpcy5ub3RpZnkuaW5mbyh0aGlzLmkxOG5SZXNvdXJjZVsnc2VsZWN0X2RhdGFfZXhwb3J0J10pO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGlmIChvcHRpb25bJ2VuYWJsZVNjcmVlbmluZ1NjaGVtZSddID09PSB0cnVlKSB7XHJcbiAgICAgIGNvbnN0IGZpbHRlckNvbmRpdGlvbkxpc3QgPSBmcmFtZUNvbnRleHQudWlTdGF0ZVsnZmlsdGVyQ29uZGl0aW9uTGlzdCddO1xyXG4gICAgICBpZiAoZmlsdGVyQ29uZGl0aW9uTGlzdCAhPT0gdW5kZWZpbmVkICYmIGZpbHRlckNvbmRpdGlvbkxpc3QgIT09IG51bGwgJiYgZmlsdGVyQ29uZGl0aW9uTGlzdCAhPT0gJycgJiYgZmlsdGVyQ29uZGl0aW9uTGlzdCAhPT0gJ1tdJykge1xyXG4gICAgICAgIGxldCBmaWx0ZXJDb25kaXRpb25MaXN0SnNvbjtcclxuICAgICAgICBpZiAodHlwZW9mIChmaWx0ZXJDb25kaXRpb25MaXN0KSA9PT0gJ3N0cmluZycpIHtcclxuICAgICAgICAgIGZpbHRlckNvbmRpdGlvbkxpc3RKc29uID0gSlNPTi5wYXJzZShmaWx0ZXJDb25kaXRpb25MaXN0KTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgZmlsdGVyQ29uZGl0aW9uTGlzdEpzb24gPSBmaWx0ZXJDb25kaXRpb25MaXN0O1xyXG4gICAgICAgIH1cclxuICAgICAgICBmb3IgKGxldCBpbmRleCA9IDA7IGluZGV4IDwgZmlsdGVyQ29uZGl0aW9uTGlzdEpzb24ubGVuZ3RoOyBpbmRleCsrKSB7XHJcbiAgICAgICAgICBjb25zdCBlbGVtZW50ID0gZmlsdGVyQ29uZGl0aW9uTGlzdEpzb25baW5kZXhdO1xyXG4gICAgICAgICAgY29uc3QgdmFsdWUgPSBkZWNvZGVVUklDb21wb25lbnQoZWxlbWVudC5WYWx1ZSk7XHJcbiAgICAgICAgICAvLyBpZiAodHlwZW9mICh2YWx1ZSkgPT09ICdzdHJpbmcnICYmIHZhbHVlLmluY2x1ZGVzKCdcXHJcXG4nKSkge1xyXG4gICAgICAgICAgLy8gICAgIGVsZW1lbnQuVmFsdWUgPSB2YWx1ZS5yZXBsYWNlKCdcXHJcXG4nLCAnXFxcXHJcXFxcbicpO1xyXG4gICAgICAgICAgLy8gfSBlbHNlIHtcclxuICAgICAgICAgIC8vIH1cclxuICAgICAgICAgIGVsZW1lbnQuVmFsdWUgPSB2YWx1ZTtcclxuICAgICAgICAgIG5ld0ZpbHRlcnMucHVzaChlbGVtZW50KTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIGlmIChuZXdGaWx0ZXJzLmxlbmd0aCA+IDApIHtcclxuICAgICAgaWYgKCFpc051bGxPclVuZGVmaW5lZChmaWx0ZXJQYXJhbSkgJiYgZmlsdGVyUGFyYW0uRmlsdGVyQ29uZGl0aW9ucyAhPT0gbnVsbCkge1xyXG4gICAgICAgIGZpbHRlclBhcmFtLkZpbHRlckNvbmRpdGlvbnMgPSBuZXdGaWx0ZXJzLmNvbmNhdChmaWx0ZXJQYXJhbS5GaWx0ZXJDb25kaXRpb25zKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBpZiAoaXNOdWxsT3JVbmRlZmluZWQoZmlsdGVyUGFyYW0pKSB7XHJcbiAgICAgICAgICBmaWx0ZXJQYXJhbSA9IHt9O1xyXG4gICAgICAgIH1cclxuICAgICAgICBmaWx0ZXJQYXJhbVsnRmlsdGVyQ29uZGl0aW9ucyddID0gbmV3RmlsdGVycztcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGlmIChpc051bGxPclVuZGVmaW5lZChmaWx0ZXJQYXJhbSkpIHtcclxuICAgICAgZXhwb3J0UGFyYW0gPSB7XHJcbiAgICAgICAgYm9keToge1xyXG4gICAgICAgICAgZXhwb3J0Q29udGV4dDoge1xyXG4gICAgICAgICAgICBSdWxlSWQ6IHJ1bGVJZCxcclxuICAgICAgICAgICAgU3VmZml4OiBzdWZmaXgsXHJcbiAgICAgICAgICAgIE1vZGVsOiBtb2RlbCxcclxuICAgICAgICAgICAgR2xvYmFsUGFyYW06IGdsb2JhbFZhcixcclxuICAgICAgICAgICAgZnVuY0lkOiBmdW5jSWRcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH07XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAvL+ehruS/neacgOWQjuS4gOS4quWFs+ezu+S4uuepulxyXG4gICAgICBpZiAoIWlzTnVsbE9yVW5kZWZpbmVkKGZpbHRlclBhcmFtLkZpbHRlckNvbmRpdGlvbnMpICYmIGZpbHRlclBhcmFtLkZpbHRlckNvbmRpdGlvbnMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgIGZpbHRlclBhcmFtLkZpbHRlckNvbmRpdGlvbnNbZmlsdGVyUGFyYW0uRmlsdGVyQ29uZGl0aW9ucy5sZW5ndGggLSAxXS5SZWxhdGlvbiA9IDA7XHJcbiAgICAgIH1cclxuICAgICAgZXhwb3J0UGFyYW0gPSB7XHJcbiAgICAgICAgYm9keToge1xyXG4gICAgICAgICAgZXhwb3J0Q29udGV4dDoge1xyXG4gICAgICAgICAgICBSdWxlSWQ6IHJ1bGVJZCxcclxuICAgICAgICAgICAgRmlsdGVyOiBmaWx0ZXJQYXJhbSxcclxuICAgICAgICAgICAgU3VmZml4OiBzdWZmaXgsXHJcbiAgICAgICAgICAgIE1vZGVsOiBtb2RlbCxcclxuICAgICAgICAgICAgR2xvYmFsUGFyYW06IGdsb2JhbFZhcixcclxuICAgICAgICAgICAgZnVuY0lkOiBmdW5jSWRcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH07XHJcbiAgICB9XHJcblxyXG4gICAgdGhpcy5FeHBvcnQoZnJhbWVDb250ZXh0LnJlcG9zaXRvcnksIGV4cG9ydFBhcmFtLCBvcHRpb24pO1xyXG4gIH1cclxuXHJcbiAgRXhwb3J0QnlJZDRIYW5kQ3JhZnQocnVsZUlkOiBzdHJpbmcsIG9wdGlvbjogYW55LCBzdWZmaXg/OiBzdHJpbmcpIHtcclxuICAgIGxldCBnbG9iYWxWYXIgPSAnJztcclxuICAgIGlmICghaXNOdWxsT3JVbmRlZmluZWQob3B0aW9uWydnbG9iYWxQYXJhbSddKSkge1xyXG4gICAgICBpZiAodHlwZW9mIChvcHRpb25bJ2dsb2JhbFBhcmFtJ10pID09PSAnb2JqZWN0Jykge1xyXG4gICAgICAgIGdsb2JhbFZhciA9IEpTT04uc3RyaW5naWZ5KG9wdGlvblsnZ2xvYmFsUGFyYW0nXSk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgZ2xvYmFsVmFyID0gb3B0aW9uWydnbG9iYWxQYXJhbSddO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBpZiAoaXNOdWxsT3JVbmRlZmluZWQoc3VmZml4KSkge1xyXG4gICAgICBzdWZmaXggPSAnJztcclxuICAgIH1cclxuICAgIGxldCBmdW5jSWQgPSAnJztcclxuICAgIGlmKCFpc051bGxPclVuZGVmaW5lZChvcHRpb24uZnVuY0lkKSl7XHJcbiAgICAgIGZ1bmNJZCA9IG9wdGlvbi5mdW5jSWQ7XHJcbiAgICB9XHJcbiAgICBjb25zdCBleHBvcnRQYXJhbSA9IHtcclxuICAgICAgcnVsZUlkOiBydWxlSWQsXHJcbiAgICAgIGZpbHRlcjogb3B0aW9uWydmaWx0ZXInXSxcclxuICAgICAgc3VmZml4OiBzdWZmaXgsXHJcbiAgICAgIGdsb2JhbFBhcmFtOiBnbG9iYWxWYXIsXHJcbiAgICAgIGZ1bmNJZDogZnVuY0lkXHJcbiAgICB9O1xyXG5cclxuICAgIHRoaXMuRXhwb3J0NEhhbmRDcmFmdChleHBvcnRQYXJhbSwgb3B0aW9uKTtcclxuICB9XHJcblxyXG4gIEV4cG9ydEN1cnJlbnRDaGlsZERhdGEocnVsZUlkOiBzdHJpbmcsIGZyYW1lQ29udGV4dDogRnJhbWVDb250ZXh0LCBvcHRpb246IGFueSwgc3VmZml4Pzogc3RyaW5nKSB7XHJcbiAgICBsZXQgZXhwb3J0UGFyYW0gPSBudWxsO1xyXG5cclxuICAgIGxldCBnbG9iYWxWYXIgPSAnJztcclxuICAgIGlmIChvcHRpb25bJ2dsb2JhbFBhcmFtJ10gIT09IG51bGwgJiYgb3B0aW9uWydnbG9iYWxQYXJhbSddICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgaWYgKHR5cGVvZiAob3B0aW9uWydnbG9iYWxQYXJhbSddKSA9PT0gJ29iamVjdCcpIHtcclxuICAgICAgICBnbG9iYWxWYXIgPSBKU09OLnN0cmluZ2lmeShvcHRpb25bJ2dsb2JhbFBhcmFtJ10pO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGdsb2JhbFZhciA9IG9wdGlvblsnZ2xvYmFsUGFyYW0nXTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgaWYgKHN1ZmZpeCA9PT0gbnVsbCB8fCBzdWZmaXggPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICBzdWZmaXggPSAnJztcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBmdW5jSWQgPSBnZXRRdWVyeVN0cmluZygnZnVuY0lkJyk7XHJcblxyXG5cclxuICAgIGV4cG9ydFBhcmFtID0ge1xyXG4gICAgICBib2R5OiB7XHJcbiAgICAgICAgZXhwb3J0Q29udGV4dDoge1xyXG4gICAgICAgICAgUnVsZUlkOiBydWxlSWQsXHJcbiAgICAgICAgICBTdWZmaXg6IHN1ZmZpeCxcclxuICAgICAgICAgIE1haW5PYmpJZDogZnJhbWVDb250ZXh0LmJpbmRpbmdEYXRhLmxpc3QuY3VycmVudElkLFxyXG4gICAgICAgICAgR2xvYmFsUGFyYW06IGdsb2JhbFZhcixcclxuICAgICAgICAgIGZ1bmNJZDogZnVuY0lkXHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIHRoaXMuRXhwb3J0KGZyYW1lQ29udGV4dC5yZXBvc2l0b3J5LCBleHBvcnRQYXJhbSwgb3B0aW9uKTtcclxuICB9XHJcbn1cclxuIl19