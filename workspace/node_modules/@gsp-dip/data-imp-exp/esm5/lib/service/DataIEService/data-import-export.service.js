/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { ComponentFactoryResolver, Injectable, Injector } from '@angular/core';
import { ImportDialogComponent } from '../../import-dialog/import-dialog.component';
import { ExportDialogComponent } from '../../custom-export-dialog/export-dialog.component';
import { BsModalService } from '@farris/ui-modal';
import { FrameContext } from '@farris/devkit';
import { MethodType } from '../../model/DataIEType/MethodType';
import { EntityListService } from '@farris/command-services';
import { NotifyService } from '@farris/ui-notify';
import { DataExportService } from './data-export.service';
import { Subject } from 'rxjs';
import { CustomDataIEService } from './custom-data-ie.service';
import { CustomImportDialogComponent } from '../../custom-import-dialog/custom-import-dialog.component';
import { ExportCustomSelectComponent } from '../../export-custom-select/export-custom-select.component';
import { HttpClient } from '@angular/common/http';
import { DataIEUtils, isNullOrEmpty, isNullOrUndefined } from '../Utils/DataIEUtils';
import { DataieHandcraftService } from './dataie-handcraft.service';
import { LoadingService } from '@farris/ui-loading';
import { DataImportService } from "./data-import.service";
var DataImportExportService = /** @class */ (function () {
    function DataImportExportService(modalService, resolver, injector, frameContext, dataExportService, notify, entityService, customIEService, handcraftSer, http, loadingService, dataImportService) {
        var _this = this;
        this.modalService = modalService;
        this.resolver = resolver;
        this.injector = injector;
        this.frameContext = frameContext;
        this.dataExportService = dataExportService;
        this.notify = notify;
        this.entityService = entityService;
        this.customIEService = customIEService;
        this.handcraftSer = handcraftSer;
        this.http = http;
        this.loadingService = loadingService;
        this.dataImportService = dataImportService;
        DataIEUtils.getTranslateValue(http).subscribe((/**
         * @param {?} res
         * @return {?}
         */
        function (res) {
            _this.i18nResource = res;
            _this.data_import = res['data_import'];
            _this.data_export = res['data_export'];
            _this.export_success = res['export_success'];
            _this.export_fail = res['export_fail'];
            _this.data_export_customfile = res['data_export_customfile'];
            _this.rule_list = res['rule_list'];
        }));
    }
    /**
     * 根据规则导出
     * @param ruleID
     * @param option
     */
    /**
     * 根据规则导出
     * @param {?} ruleID
     * @param {?} option
     * @return {?}
     */
    DataImportExportService.prototype.ExportByRule = /**
     * 根据规则导出
     * @param {?} ruleID
     * @param {?} option
     * @return {?}
     */
    function (ruleID, option) {
        /** @type {?} */
        var subject = new Subject();
        /** @type {?} */
        var optionJson = this.ParseExportJson(option);
        if (optionJson.packSize) {
            //获取总共有多少条数据
            /** @type {?} */
            var totalData = this.frameContext.bindingData.pagingInfo.total;
            if (isNullOrUndefined(totalData) || totalData <= 0) {
                this.notify.warning('未获取到总数据量或数据量为0，无法进行分批打包导出，请检查');
                subject.next(false);
                subject.complete();
            }
            else {
                /** @type {?} */
                var filterConditions = [];
                if (optionJson.enableScreeningScheme === true) {
                    /** @type {?} */
                    var filterConditionList = this.frameContext.uiState['filterConditionList'];
                    if (!isNullOrUndefined(filterConditionList) && filterConditionList !== '' && filterConditionList !== '[]') {
                        /** @type {?} */
                        var filterConditionListJson = [];
                        if (typeof (filterConditionList) === 'string') {
                            filterConditionListJson = JSON.parse(filterConditionList);
                        }
                        else {
                            filterConditionListJson = filterConditionList;
                        }
                        for (var index = 0; index < filterConditionListJson.length; index++) {
                            /** @type {?} */
                            var element = filterConditionListJson[index];
                            element.Value = decodeURIComponent(element.Value);
                            if (index === filterConditionListJson.length - 1) {
                                element.Relation = 0;
                            }
                            filterConditions.push(element);
                        }
                    }
                }
                //分页大小，对应的每个Excel文件的数据量
                /** @type {?} */
                var pageSize = Number.parseInt(optionJson.packSize);
                /** @type {?} */
                var num = Math.ceil(totalData / pageSize);
                /** @type {?} */
                var packitems = [];
                for (var i = 0; i < num; i++) {
                    /** @type {?} */
                    var packitem = {
                        ruleid: ruleID,
                        globalParam: optionJson.globalParam,
                        filter: {
                            filterConditions: filterConditions,
                            isUsePagination: true,
                            pagination: {
                                pageIndex: i + 1,
                                pageSize: pageSize
                            }
                        }
                    };
                    packitems.push(packitem);
                }
                /** @type {?} */
                var customfilename = '打包导出' + new Date();
                if (!isNullOrEmpty(optionJson.customfilename)) {
                    customfilename = optionJson.customfilename;
                }
                /** @type {?} */
                var option_1 = {
                    package: {
                        customfilename: customfilename,
                        packitems: packitems
                    }
                };
                this.ExportByPackage(JSON.stringify(option_1)).subscribe((/**
                 * @param {?} s
                 * @return {?}
                 */
                function (s) {
                    subject.next(s);
                    subject.complete();
                }));
            }
        }
        else {
            this.ExportCommonEntry(ruleID, option, MethodType.CommonExport).subscribe((/**
             * @param {?} s
             * @return {?}
             */
            function (s) {
                subject.next(s);
                subject.complete();
            }));
        }
        return subject;
    };
    /**
     * 根据规则导出
     * @param ruleID
     * @param option
     */
    /**
     * 根据规则导出
     * @param {?} ruleID
     * @param {?} option
     * @return {?}
     */
    DataImportExportService.prototype.ExportCurrentChildData = /**
     * 根据规则导出
     * @param {?} ruleID
     * @param {?} option
     * @return {?}
     */
    function (ruleID, option) {
        /** @type {?} */
        var subject = new Subject();
        this.ExportCommonEntry(ruleID, option, MethodType.ExportCurrentChildData).subscribe((/**
         * @param {?} s
         * @return {?}
         */
        function (s) {
            subject.next(s);
            subject.complete();
        }));
        return subject;
    };
    /**
     * 导出当前列表数据（分页）
     * @param ruleID
     * @param option
     */
    /**
     * 导出当前列表数据（分页）
     * @param {?} ruleID
     * @param {?} option
     * @return {?}
     */
    DataImportExportService.prototype.ExportCurrentListData = /**
     * 导出当前列表数据（分页）
     * @param {?} ruleID
     * @param {?} option
     * @return {?}
     */
    function (ruleID, option) {
        /** @type {?} */
        var subject = new Subject();
        this.ExportCommonEntry(ruleID, option, MethodType.ExportCurrentTableData).subscribe((/**
         * @param {?} s
         * @return {?}
         */
        function (s) {
            subject.next(s);
            subject.complete();
        }));
        return subject;
    };
    /**
     * 批量打包导出
     * @param option 配置打包信息
     */
    /**
     * 批量打包导出
     * @param {?} option 配置打包信息
     * @return {?}
     */
    DataImportExportService.prototype.ExportByPackage = /**
     * 批量打包导出
     * @param {?} option 配置打包信息
     * @return {?}
     */
    function (option) {
        var _this = this;
        console.log(option);
        /** @type {?} */
        var subject = new Subject();
        /** @type {?} */
        var optionJson = this.ParseExportJson(option);
        this.dataExportService.ExportByPackage(this.frameContext.repository, optionJson);
        /** @type {?} */
        var unscriber = this.dataExportService.export.subscribe((/**
         * @param {?} data
         * @return {?}
         */
        function (data) {
            if (data === '') {
                _this.notify.success(_this.export_success);
                unscriber.unsubscribe();
                subject.next(true);
                subject.complete();
            }
            else {
                /** @type {?} */
                var errorlevel = _this.dataExportService.errorlevel;
                if (errorlevel === 'Info') {
                    _this.notify.info(data);
                }
                else if (errorlevel === 'Warning') {
                    _this.notify.warning(data);
                }
                else {
                    _this.notify.error(_this.export_fail + data);
                }
                unscriber.unsubscribe();
                subject.next(false);
                subject.complete();
            }
        }));
        return subject;
    };
    /**
     * @private
     * @param {?} ruleID
     * @param {?} option
     * @param {?} methodType
     * @return {?}
     */
    DataImportExportService.prototype.ExportCommonEntry = /**
     * @private
     * @param {?} ruleID
     * @param {?} option
     * @param {?} methodType
     * @return {?}
     */
    function (ruleID, option, methodType) {
        var _this = this;
        /** @type {?} */
        var subject = new Subject();
        console.log(option);
        /** @type {?} */
        var optionJson = this.ParseExportJson(option);
        if (isNullOrEmpty(ruleID) && isNullOrEmpty(optionJson.voId)) {
            this.notify.warning("未配置规则id，且无法获取到表单对应的voId，请检查");
            return subject;
        }
        if (methodType === MethodType.ExportCurrentChildData) {
            if (isNullOrEmpty(ruleID) && isNullOrEmpty(optionJson.exportChildNodeCode)) {
                //导出子表当规则id为空时，根据vo找规则，必须要求有配置子表节点
                this.notify.warning("规则id为空时，根据Vo查找规则，导出子表必须配置子表节点");
                return subject;
            }
        }
        if (isNullOrEmpty(ruleID) || optionJson.enableRuntimeCustom === true || optionJson.selectfiletype === true) {
            /** @type {?} */
            var befRestService = DataIEUtils.GetBefRestService(this.frameContext.repository);
            this.StartLoading();
            /** @type {?} */
            var url = '/api/runtime/dip/v1.0/dataIeRuleManage/getRecordRuleInfo';
            /** @type {?} */
            var postBody = {
                body: {
                    ruleId: ruleID,
                    ruleType: 1,
                    voId: optionJson.voId,
                    methodType: methodType,
                    exportChildNodeCode: optionJson.exportChildNodeCode,
                    enableRuntimeCustom: optionJson.enableRuntimeCustom === true
                }
            };
            /** @type {?} */
            var subscriber = void 0;
            if (!isNullOrUndefined(this.http)) {
                subscriber = this.http.post(url, postBody.body);
            }
            else {
                subscriber = befRestService.request(url, 'post', null, postBody);
            }
            subscriber.subscribe((/**
             * @param {?} recordRule
             * @return {?}
             */
            function (recordRule) {
                _this.CloseLoading();
                _this.ExportByRuleImpl(ruleID, optionJson, methodType, recordRule).subscribe((/**
                 * @param {?} s
                 * @return {?}
                 */
                function (s) {
                    subject.next(s);
                    subject.complete();
                }));
            }), (/**
             * @param {?} error
             * @return {?}
             */
            function (error) {
                _this.CloseLoading();
                _this.notify.error(error.error.Message);
                console.log(error.error.Message);
            }));
        }
        else {
            this.ExportByRuleImpl(ruleID, optionJson, methodType).subscribe((/**
             * @param {?} s
             * @return {?}
             */
            function (s) {
                subject.next(s);
                subject.complete();
            }));
        }
        return subject;
    };
    /**
     * @private
     * @param {?} ruleID
     * @param {?} optionJson
     * @param {?} mType
     * @param {?=} recordRule
     * @return {?}
     */
    DataImportExportService.prototype.ExportByRuleImpl = /**
     * @private
     * @param {?} ruleID
     * @param {?} optionJson
     * @param {?} mType
     * @param {?=} recordRule
     * @return {?}
     */
    function (ruleID, optionJson, mType, recordRule) {
        var _this = this;
        /** @type {?} */
        var subject = new Subject();
        if (optionJson.customExportTitle !== undefined && optionJson.customExportTitle !== null) {
            if (optionJson.customExportTitle.length > 20) {
                this.notify.warning('自定义标题名称的长度太长');
                return subject;
            }
            if (DataIEUtils.JudgeIllegalChar(optionJson.customExportTitle)) {
                this.notify.warning('自定义标题名称存在不合法字符');
                return subject;
            }
        }
        if (optionJson.applyui === true) {
            /** @type {?} */
            var cmpRef = this.CreateExportComponent();
            cmpRef.instance.ruleId = ruleID;
            cmpRef.instance.exportOption = optionJson;
            cmpRef.instance.frameContext = this.frameContext;
            cmpRef.instance.methodType = mType;
            cmpRef.instance.subject = subject;
            cmpRef.instance.show = optionJson.vsto;
            cmpRef.instance.isCustomExport = false;
            /** @type {?} */
            var exportModalConfig = this.GetExportDialogConfig(cmpRef, optionJson);
            /** @type {?} */
            var dialog_1 = this.modalService.show(cmpRef, exportModalConfig);
            cmpRef.instance.needDestroy.subscribe((/**
             * @param {?} $event
             * @return {?}
             */
            function ($event) {
                dialog_1.close();
            }));
        }
        else if (optionJson.enableRuntimeCustom === true || optionJson.selectfiletype === true) {
            /** @type {?} */
            var cmpRef = this.CreateSelectExportComponent();
            cmpRef.instance.ruleId = ruleID;
            cmpRef.instance.exportOption = optionJson;
            cmpRef.instance.recordRule = recordRule;
            cmpRef.instance.frameContext = this.frameContext;
            cmpRef.instance.methodType = mType;
            cmpRef.instance.subject = subject;
            /** @type {?} */
            var exportModalConfig = this.GetSelectExportDialogConfig(cmpRef, optionJson);
            /** @type {?} */
            var dialog_2 = this.modalService.show(cmpRef, exportModalConfig);
            cmpRef.instance.needDestroy.subscribe((/**
             * @param {?} $event
             * @return {?}
             */
            function ($event) {
                dialog_2.close();
            }));
        }
        else {
            if (!isNullOrUndefined(recordRule) && !isNullOrEmpty(recordRule.ruleId)) {
                ruleID = recordRule.ruleId;
            }
            if (mType == MethodType.CommonExport) {
                this.dataExportService.ExportById(ruleID, this.frameContext, optionJson);
            }
            else if (mType == MethodType.ExportCurrentTableData) {
                this.dataExportService.ExportCurrentData(ruleID, this.frameContext, this.entityService.pageIndex, this.entityService.pageSize, optionJson);
            }
            else {
                this.dataExportService.ExportCurrentChildData(ruleID, this.frameContext, optionJson);
            }
            /** @type {?} */
            var unscriber_1 = this.dataExportService.export.subscribe((/**
             * @param {?} data
             * @return {?}
             */
            function (data) {
                if (data === '') {
                    // 有人需求导出去掉成功提示，因为文件还没下载下来提示提前了
                    if (optionJson.cancelnotify === undefined || optionJson.cancelnotify === null || optionJson.cancelnotify === false) {
                        _this.notify.success(_this.export_success);
                    }
                    subject.next(true);
                    subject.complete();
                }
                else {
                    /** @type {?} */
                    var errorlevel = _this.dataExportService.errorlevel;
                    if (errorlevel === 'Info') {
                        _this.notify.info(data);
                    }
                    else if (errorlevel === 'Warning') {
                        _this.notify.warning(data);
                    }
                    else {
                        _this.notify.error(_this.export_fail + data);
                    }
                    subject.next(false);
                    subject.complete();
                }
                unscriber_1.unsubscribe();
            }), (/**
             * @param {?} error
             * @return {?}
             */
            function (error) {
                _this.notify.error(error.error.Message);
                subject.next(false);
                subject.complete();
            }));
        }
        return subject;
    };
    /**
     * 通用导入方法
     * @param type
     * @param ruleID
     * @param option
     */
    /**
     * 通用导入方法
     * @param {?} type
     * @param {?} ruleID
     * @param {?} option
     * @return {?}
     */
    DataImportExportService.prototype.CommonDataImport = /**
     * 通用导入方法
     * @param {?} type
     * @param {?} ruleID
     * @param {?} option
     * @return {?}
     */
    function (type, ruleID, option) {
        // if (type !== 2 && (ruleID === undefined || ruleID === null || ruleID === '')) {
        //     this.notify.error('请在表单导入命令动作处配置导入规则ID');
        //     return;
        // }
        if (type === 1) {
            console.log('执行方法：ImportSublistData');
            return this.ImportSublistData(ruleID, option);
        }
        else if (type === 2) {
            console.log('执行方法：ImportByModel');
            return this.ImportByModel(option);
        }
        else if (type === 0) {
            console.log('执行方法：ImportByRule');
            return this.ImportByRule(ruleID, option);
        }
        else {
            console.log('执行方法：ImportByRule');
            return this.ImportByRule(ruleID, option);
        }
    };
    /**
     * 卡片表单数据导入（主从表，子表，统一只导入到表单）
     * @param dataId
     * @param ruleID
     * @param option
     */
    /**
     * 卡片表单数据导入（主从表，子表，统一只导入到表单）
     * @param {?} dataId
     * @param {?} ruleID
     * @param {?} option
     * @return {?}
     */
    DataImportExportService.prototype.CardDataImport = /**
     * 卡片表单数据导入（主从表，子表，统一只导入到表单）
     * @param {?} dataId
     * @param {?} ruleID
     * @param {?} option
     * @return {?}
     */
    function (dataId, ruleID, option) {
        var _this = this;
        /** @type {?} */
        var subject = new Subject();
        console.log(dataId);
        if (!dataId) {
            this.notify.warning('未读取到主表数据id，不允许导入');
            subject.next(false);
            return subject;
        }
        /** @type {?} */
        var optionJson = this.ParseImportJson(option);
        optionJson['mainObjId'] = dataId;
        this.frameContext.repository.updateAllChanges().subscribe((/**
         * @param {?} e
         * @return {?}
         */
        function (e) {
            _this.ImportCommonEntry(ruleID, JSON.stringify(optionJson), MethodType.CardFormDataImport).subscribe((/**
             * @param {?} s
             * @return {?}
             */
            function (s) {
                subject.next(s);
                subject.complete();
            }));
        }));
        return subject;
    };
    /**
     * 通用导出方法
     * @param type
     * @param ruleID
     * @param option
     */
    /**
     * 通用导出方法
     * @param {?} type
     * @param {?} ruleID
     * @param {?} option
     * @return {?}
     */
    DataImportExportService.prototype.CommonDataExport = /**
     * 通用导出方法
     * @param {?} type
     * @param {?} ruleID
     * @param {?} option
     * @return {?}
     */
    function (type, ruleID, option) {
        // if (type !== 2 && (ruleID === undefined || ruleID === null || ruleID === '')) {
        //     this.notify.error('请在表单导出命令动作处配置导出规则ID');
        //     return;
        // }
        if (type === 1) {
            console.log('执行方法：ExportCurrentListData');
            // const pageInfo = new PageInfo();
            // pageInfo.pageIndex = this.entityService.pageIndex;
            // pageInfo.pageSize = this.entityService.pageSize;
            return this.ExportCurrentListData(ruleID, option);
        }
        else if (type === 2) {
            console.log('执行方法：ExportByModel');
            return this.ExportByModel(option);
        }
        else if (type === 3) {
            console.log('执行方法：ExportCurrentChildData');
            return this.ExportCurrentChildData(ruleID, option);
        }
        else if (type === 0) {
            console.log('执行方法：ExportByRule');
            return this.ExportByRule(ruleID, option);
        }
        else {
            console.log('执行方法：ExportByRule');
            return this.ExportByRule(ruleID, option);
        }
    };
    /**
     * @private
     * @param {?} option
     * @return {?}
     */
    DataImportExportService.prototype.ParseExportJson = /**
     * @private
     * @param {?} option
     * @return {?}
     */
    function (option) {
        /** @type {?} */
        var voId = this.frameContext.appContext.formId;
        if (isNullOrUndefined(option) || isNullOrEmpty(option)) {
            return { filter: null, voId: voId, customfilename: '', applyui: false, vsto: false };
        }
        /** @type {?} */
        var optionJson = null;
        try {
            optionJson = JSON.parse(option);
        }
        catch (_a) {
            this.notify.warning('传入的参数转换JSON对象异常，已使用默认参数');
            return { filter: null, voId: voId, customfilename: '', applyui: false, vsto: false };
        }
        if (typeof (optionJson) !== 'object') {
            optionJson = {};
        }
        optionJson['voId'] = voId;
        return optionJson;
    };
    /**
     * @private
     * @param {?} option
     * @return {?}
     */
    DataImportExportService.prototype.ParseImportJson = /**
     * @private
     * @param {?} option
     * @return {?}
     */
    function (option) {
        /** @type {?} */
        var voId = this.frameContext.appContext.formId;
        if (isNullOrUndefined(option) || isNullOrEmpty(option)) {
            return { templatefilename: '', GlobalParam: '', voId: voId };
        }
        /** @type {?} */
        var optionJson = null;
        try {
            optionJson = JSON.parse(option);
        }
        catch (_a) {
            this.notify.warning('传入的参数转换JSON对象异常，已使用默认参数');
            return { templatefilename: '', GlobalParam: '', voId: voId };
        }
        if (typeof (optionJson) !== 'object') {
            optionJson = {};
        }
        /** @type {?} */
        var globalParam = optionJson['globalParam'];
        if (globalParam !== undefined && globalParam !== null) {
            optionJson['GlobalParam'] = globalParam;
        }
        optionJson['voId'] = voId;
        return optionJson;
    };
    /**
     * @param {?} option
     * @return {?}
     */
    DataImportExportService.prototype.ExportByModel = /**
     * @param {?} option
     * @return {?}
     */
    function (option) {
        var _this = this;
        /** @type {?} */
        var subject = new Subject();
        /** @type {?} */
        var optionJson = JSON.parse(option);
        /** @type {?} */
        var model = optionJson.dataExchangeModel;
        /** @type {?} */
        var components = [];
        if (optionJson.components !== undefined && optionJson.components !== null && optionJson.components.length > 0) {
            optionJson.components.forEach((/**
             * @param {?} c
             * @return {?}
             */
            function (c) {
                return components.push(JSON.stringify(c));
            }));
        }
        /** @type {?} */
        var i18nId = '';
        if (optionJson.I18nMetadataID !== undefined && optionJson.I18nMetadataID !== null) {
            i18nId = optionJson.I18nMetadataID;
        }
        /** @type {?} */
        var filter = null;
        if (optionJson.filter !== undefined && optionJson.filter !== null) {
            filter = optionJson.filter;
        }
        /** @type {?} */
        var cmpRef = this.CreateExportComponent();
        cmpRef.instance.frameContext = this.frameContext;
        cmpRef.instance.methodType = MethodType.CommonExport;
        cmpRef.instance.isCustomExport = true;
        cmpRef.instance.Model = model;
        cmpRef.instance.subject = subject;
        cmpRef.instance.components = components;
        cmpRef.instance.i18nId = i18nId;
        cmpRef.instance.filter = filter;
        cmpRef.instance.exportOption = optionJson;
        /** @type {?} */
        var modelStr = JSON.stringify(model);
        cmpRef.instance.InnerModel = JSON.parse(modelStr);
        /** @type {?} */
        var exportModalConfig = this.GetExportDialogConfig(cmpRef, optionJson);
        /** @type {?} */
        var keys = ['DataExport', model['MainObject']['Source']['SourceMetadataID'], optionJson.dimension];
        this.customIEService.GetExportRuleModel(keys, this.frameContext.repository, i18nId, model).subscribe((/**
         * @param {?} data
         * @return {?}
         */
        function (data) {
            if (data['success'] === true) {
                cmpRef.instance.CustomModel = JSON.parse(data['modelStr']);
            }
            if (i18nId !== '' && data['i18nModel'] !== undefined && data['i18nModel'] !== null) {
                /** @type {?} */
                var i18nModel = JSON.parse(data['i18nModel']);
                cmpRef.instance.Model = i18nModel;
                /** @type {?} */
                var modelStr_1 = JSON.stringify(i18nModel);
                cmpRef.instance.InnerModel = JSON.parse(modelStr_1);
            }
            /** @type {?} */
            var dialog = _this.modalService.show(cmpRef, exportModalConfig);
            cmpRef.instance.needDestroy.subscribe((/**
             * @param {?} $event
             * @return {?}
             */
            function ($event) {
                dialog.close();
            }));
        }));
        return subject;
        // const dialog = this.modalService.show(cmpRef, exportModalConfig);
        // cmpRef.instance.needDestroy.subscribe($event => { dialog.close(); });
    };
    /**
     * @param {?} option
     * @return {?}
     */
    DataImportExportService.prototype.ImportByModel = /**
     * @param {?} option
     * @return {?}
     */
    function (option) {
        var _this = this;
        /** @type {?} */
        var optionJson = JSON.parse(option);
        /** @type {?} */
        var model = optionJson.dataExchangeModel;
        /** @type {?} */
        var subject = new Subject();
        /** @type {?} */
        var components = [];
        if (optionJson.components !== undefined && optionJson.components !== null && optionJson.components.length > 0) {
            optionJson.components.forEach((/**
             * @param {?} c
             * @return {?}
             */
            function (c) {
                return components.push(JSON.stringify(c));
            }));
        }
        /** @type {?} */
        var i18nId = '';
        if (optionJson.I18nMetadataID !== undefined && optionJson.I18nMetadataID !== null) {
            i18nId = optionJson.I18nMetadataID;
        }
        if (optionJson.customImportTitle !== undefined && optionJson.customImportTitle !== null) {
            if (optionJson.customImportTitle.length > 20) {
                this.notify.warning('自定义标题名称的长度太长');
                return subject;
            }
            if (DataIEUtils.JudgeIllegalChar(optionJson.customImportTitle)) {
                this.notify.warning('自定义标题名称存在不合法字符');
                return subject;
            }
        }
        /** @type {?} */
        var cmpRef = this.CreateCustomImportComponent();
        cmpRef.instance.frameContext = this.frameContext;
        cmpRef.instance.importOption = optionJson;
        // cmpRef.instance.methodType = MethodType.ImportSubTableDetail;
        cmpRef.instance.subject = subject;
        cmpRef.instance.i18nId = i18nId;
        cmpRef.instance.Model = model;
        /** @type {?} */
        var modelStr = JSON.stringify(model);
        cmpRef.instance.InnerModel = JSON.parse(modelStr);
        cmpRef.instance.components = components;
        /** @type {?} */
        var importModalConfig = this.GetCustomImportDialogConfig(cmpRef, optionJson);
        /** @type {?} */
        var keys = ['DataImport', model['MainObject']['Source']['SourceMetadataID'], optionJson.dimension];
        this.customIEService.GetImportRuleModel(keys, this.frameContext.repository, i18nId, model).subscribe((/**
         * @param {?} data
         * @return {?}
         */
        function (data) {
            if (data['success'] === true) {
                cmpRef.instance.CustomModel = JSON.parse(data['modelStr']);
            }
            if (i18nId !== '' && data['i18nModel'] !== undefined && data['i18nModel'] !== null) {
                /** @type {?} */
                var i18nModel = JSON.parse(data['i18nModel']);
                cmpRef.instance.Model = i18nModel;
                /** @type {?} */
                var modelStr_2 = JSON.stringify(i18nModel);
                cmpRef.instance.InnerModel = JSON.parse(modelStr_2);
            }
            /** @type {?} */
            var dialog = _this.modalService.show(cmpRef, importModalConfig);
            cmpRef.instance.needDestroy.subscribe((/**
             * @param {?} $event
             * @return {?}
             */
            function ($event) {
                dialog.close();
            }));
        }));
        return subject;
    };
    /**
     * 下载导入模板
     * @param ruleID
     * @param option
     */
    /**
     * 下载导入模板
     * @param {?} ruleID
     * @param {?} option
     * @return {?}
     */
    DataImportExportService.prototype.DownloadTemplate = /**
     * 下载导入模板
     * @param {?} ruleID
     * @param {?} option
     * @return {?}
     */
    function (ruleID, option) {
        /** @type {?} */
        var subject = new Subject();
        this.ImportCommonEntry(ruleID, option, MethodType.DownloadImportTemplate).subscribe((/**
         * @param {?} s
         * @return {?}
         */
        function (s) {
            subject.next(s);
            subject.complete();
        }));
        return subject;
    };
    /**
     * 根据规则导入
     * @param ruleID
     * @param option
     */
    /**
     * 根据规则导入
     * @param {?} ruleID
     * @param {?} option
     * @return {?}
     */
    DataImportExportService.prototype.ImportByRule = /**
     * 根据规则导入
     * @param {?} ruleID
     * @param {?} option
     * @return {?}
     */
    function (ruleID, option) {
        /** @type {?} */
        var subject = new Subject();
        this.ImportCommonEntry(ruleID, option, MethodType.CommonImport).subscribe((/**
         * @param {?} s
         * @return {?}
         */
        function (s) {
            subject.next(s);
            subject.complete();
        }));
        return subject;
    };
    /**
     * 导入子表数据
     * @param ruleID
     * @param option
     */
    /**
     * 导入子表数据
     * @param {?} ruleID
     * @param {?} option
     * @return {?}
     */
    DataImportExportService.prototype.ImportSublistData = /**
     * 导入子表数据
     * @param {?} ruleID
     * @param {?} option
     * @return {?}
     */
    function (ruleID, option) {
        /** @type {?} */
        var subject = new Subject();
        this.ImportCommonEntry(ruleID, option, MethodType.ImportSubTableDetail).subscribe((/**
         * @param {?} s
         * @return {?}
         */
        function (s) {
            subject.next(s);
            subject.complete();
        }));
        return subject;
    };
    /**
     * @private
     * @param {?} ruleID
     * @param {?} option
     * @param {?} methodType
     * @return {?}
     */
    DataImportExportService.prototype.ImportCommonEntry = /**
     * @private
     * @param {?} ruleID
     * @param {?} option
     * @param {?} methodType
     * @return {?}
     */
    function (ruleID, option, methodType) {
        var _this = this;
        console.log(option);
        /** @type {?} */
        var subject = new Subject();
        /** @type {?} */
        var befRestService = DataIEUtils.GetBefRestService(this.frameContext.repository);
        /** @type {?} */
        var su = DataIEUtils.getSu(befRestService.baseUri);
        /** @type {?} */
        var optionJson = this.ParseImportJson(option);
        if (methodType === MethodType.ImportSubTableDetail) {
            if (isNullOrEmpty(ruleID) && isNullOrEmpty(optionJson.importChildNodeCode)) {
                //导入子表当规则id为空时，根据vo找规则，必须要求有配置子表节点
                this.notify.warning("规则id为空时，根据Vo查找规则，导入子表必须配置子表节点");
                return subject;
            }
        }
        this.StartLoading();
        /** @type {?} */
        var url = '/api/runtime/dip/v1.0/dataIeRuleManage/getRecordRuleInfo';
        /** @type {?} */
        var postBody = {
            body: {
                ruleId: ruleID,
                su: su,
                ruleType: 0,
                voId: optionJson.voId,
                methodType: methodType,
                importChildNodeCode: optionJson.importChildNodeCode,
                enableRuntimeCustom: optionJson.enableRuntimeCustom === true
            }
        };
        /** @type {?} */
        var subscriber;
        if (!isNullOrUndefined(this.http)) {
            subscriber = this.http.post(url, postBody.body);
        }
        else {
            subscriber = befRestService.request(url, 'post', null, postBody);
        }
        subscriber.subscribe((/**
         * @param {?} recordRule
         * @return {?}
         */
        function (recordRule) {
            _this.CloseLoading();
            _this.ImportByRuleImpl(ruleID, optionJson, methodType, recordRule).subscribe((/**
             * @param {?} s
             * @return {?}
             */
            function (s) {
                subject.next(s);
                subject.complete();
            }));
        }), (/**
         * @param {?} error
         * @return {?}
         */
        function (error) {
            _this.CloseLoading();
            _this.notify.error(error.error.Message);
            console.log(error.error.Message);
        }));
        return subject;
    };
    /**
     * @private
     * @param {?} ruleID
     * @param {?} optionJson
     * @param {?} methodType
     * @param {?=} recordRule
     * @return {?}
     */
    DataImportExportService.prototype.ImportByRuleImpl = /**
     * @private
     * @param {?} ruleID
     * @param {?} optionJson
     * @param {?} methodType
     * @param {?=} recordRule
     * @return {?}
     */
    function (ruleID, optionJson, methodType, recordRule) {
        var _this = this;
        /** @type {?} */
        var subject = new Subject();
        if (methodType === MethodType.DownloadImportTemplate) {
            this.loadingService.show();
            /** @type {?} */
            var ruleId = recordRule.ruleId ? recordRule.ruleId : ruleID;
            this.dataImportService.DowmloadTemplate(ruleId, this.frameContext.repository, optionJson, null);
            this.dataImportService.complete.subscribe((/**
             * @param {?} data
             * @return {?}
             */
            function (data) {
                _this.loadingService.clearAll();
                if (data === '') {
                    _this.notify.success(_this.i18nResource.download_template_ok);
                    subject.next(true);
                    subject.complete();
                }
                else {
                    _this.notify.error(_this.i18nResource.download_template_fail + data);
                    subject.next(false);
                    subject.complete();
                }
            }));
        }
        else {
            if (optionJson.customImportTitle !== undefined && optionJson.customImportTitle !== null) {
                if (optionJson.customImportTitle.length > 20) {
                    this.notify.warning('自定义标题名称的长度太长');
                    return subject;
                }
                if (DataIEUtils.JudgeIllegalChar(optionJson.customImportTitle)) {
                    this.notify.warning('自定义标题名称存在不合法字符');
                    return subject;
                }
            }
            /** @type {?} */
            var cmpRef = this.CreateImportComponent();
            cmpRef.instance.ruleId = ruleID;
            cmpRef.instance.importOption = optionJson;
            cmpRef.instance.recordRule = recordRule;
            cmpRef.instance.frameContext = this.frameContext;
            cmpRef.instance.methodType = methodType;
            cmpRef.instance.subject = subject;
            /** @type {?} */
            var importModalConfig = this.GetImportDialogConfig(cmpRef, optionJson);
            /** @type {?} */
            var dialog_3 = this.modalService.show(cmpRef, importModalConfig);
            cmpRef.instance.needDestroy.subscribe((/**
             * @param {?} $event
             * @return {?}
             */
            function ($event) {
                dialog_3.close();
            }));
        }
        return subject;
    };
    /**
     * @return {?}
     */
    DataImportExportService.prototype.StartLoading = /**
     * @return {?}
     */
    function () {
        if (this.loadingService !== undefined && this.loadingService !== null) {
            this.loadingService.show();
        }
    };
    /**
     * @return {?}
     */
    DataImportExportService.prototype.CloseLoading = /**
     * @return {?}
     */
    function () {
        if (this.loadingService !== undefined && this.loadingService !== null) {
            this.loadingService.clearAll();
        }
    };
    /**
     * @private
     * @param {?} cmpRef
     * @param {?} optionJson
     * @return {?}
     */
    DataImportExportService.prototype.GetImportDialogConfig = /**
     * @private
     * @param {?} cmpRef
     * @param {?} optionJson
     * @return {?}
     */
    function (cmpRef, optionJson) {
        /** @type {?} */
        var title = this.data_import;
        if (optionJson.customImportTitle !== undefined && optionJson.customImportTitle !== null) {
            title = optionJson.customImportTitle;
        }
        /** @type {?} */
        var importModalConfig = {
            title: title,
            width: 530,
            height: 342,
            buttons: cmpRef.instance.modalFooter,
            showCloseButton: true,
            showMaxButton: false,
            showMinButton: false,
            showButtons: true,
            resizable: false
        };
        return importModalConfig;
    };
    /**
     * @private
     * @param {?} cmpRef
     * @param {?} optionJson
     * @return {?}
     */
    DataImportExportService.prototype.GetCustomImportDialogConfig = /**
     * @private
     * @param {?} cmpRef
     * @param {?} optionJson
     * @return {?}
     */
    function (cmpRef, optionJson) {
        /** @type {?} */
        var title = this.data_import;
        if (optionJson.customImportTitle !== undefined && optionJson.customImportTitle !== null) {
            title = optionJson.customImportTitle;
        }
        /** @type {?} */
        var importModalConfig = {
            title: title,
            width: 950,
            height: 570,
            buttons: cmpRef.instance.modalFooter,
            showCloseButton: true,
            showMaxButton: false,
            showMinButton: false,
            showButtons: true,
            resizable: false
        };
        return importModalConfig;
    };
    /**
     * @private
     * @param {?} cmpRef
     * @param {?} optionJson
     * @return {?}
     */
    DataImportExportService.prototype.GetExportDialogConfig = /**
     * @private
     * @param {?} cmpRef
     * @param {?} optionJson
     * @return {?}
     */
    function (cmpRef, optionJson) {
        /** @type {?} */
        var title = this.data_export;
        if (optionJson.customExportTitle !== undefined && optionJson.customExportTitle !== null) {
            title = optionJson.customExportTitle;
        }
        /** @type {?} */
        var exportModalConfig = {
            title: title,
            width: 922,
            height: 530,
            buttons: cmpRef.instance.modalFooter,
            showCloseButton: true,
            showMaxButton: false,
            showMinButton: false,
            showButtons: true,
            resizable: false
        };
        return exportModalConfig;
    };
    /**
     * @private
     * @param {?} cmpRef
     * @param {?} optionJson
     * @return {?}
     */
    DataImportExportService.prototype.GetSelectExportDialogConfig = /**
     * @private
     * @param {?} cmpRef
     * @param {?} optionJson
     * @return {?}
     */
    function (cmpRef, optionJson) {
        /** @type {?} */
        var title = this.data_export;
        if (optionJson.customExportTitle !== undefined && optionJson.customExportTitle !== null) {
            title = optionJson.customExportTitle;
        }
        /** @type {?} */
        var exportModalConfig = {
            title: title,
            width: 530,
            height: 342,
            buttons: cmpRef.instance.modalFooter,
            showCloseButton: true,
            showMaxButton: false,
            showMinButton: false,
            showButtons: true,
            resizable: false
        };
        return exportModalConfig;
    };
    // 创建输入组件实例
    // 创建输入组件实例
    /**
     * @private
     * @return {?}
     */
    DataImportExportService.prototype.CreateImportComponent = 
    // 创建输入组件实例
    /**
     * @private
     * @return {?}
     */
    function () {
        /** @type {?} */
        var compFactory = this.resolver.resolveComponentFactory(ImportDialogComponent);
        /** @type {?} */
        var cmpRef = compFactory.create(this.injector);
        return cmpRef;
    };
    // 创建输出组件实例
    // 创建输出组件实例
    /**
     * @private
     * @return {?}
     */
    DataImportExportService.prototype.CreateExportComponent = 
    // 创建输出组件实例
    /**
     * @private
     * @return {?}
     */
    function () {
        /** @type {?} */
        var compFactory = this.resolver.resolveComponentFactory(ExportDialogComponent);
        /** @type {?} */
        var cmpRef = compFactory.create(this.injector);
        return cmpRef;
    };
    /**
     * @private
     * @return {?}
     */
    DataImportExportService.prototype.CreateSelectExportComponent = /**
     * @private
     * @return {?}
     */
    function () {
        /** @type {?} */
        var compFactory = this.resolver.resolveComponentFactory(ExportCustomSelectComponent);
        /** @type {?} */
        var cmpRef = compFactory.create(this.injector);
        return cmpRef;
    };
    /**
     * @private
     * @return {?}
     */
    DataImportExportService.prototype.CreateCustomImportComponent = /**
     * @private
     * @return {?}
     */
    function () {
        /** @type {?} */
        var compFactory = this.resolver.resolveComponentFactory(CustomImportDialogComponent);
        /** @type {?} */
        var cmpRef = compFactory.create(this.injector);
        return cmpRef;
    };
    DataImportExportService.decorators = [
        { type: Injectable }
    ];
    /** @nocollapse */
    DataImportExportService.ctorParameters = function () { return [
        { type: BsModalService },
        { type: ComponentFactoryResolver },
        { type: Injector },
        { type: FrameContext },
        { type: DataExportService },
        { type: NotifyService },
        { type: EntityListService },
        { type: CustomDataIEService },
        { type: DataieHandcraftService },
        { type: HttpClient },
        { type: LoadingService },
        { type: DataImportService }
    ]; };
    return DataImportExportService;
}());
export { DataImportExportService };
if (false) {
    /** @type {?} */
    DataImportExportService.prototype.data_import;
    /** @type {?} */
    DataImportExportService.prototype.data_export;
    /** @type {?} */
    DataImportExportService.prototype.data_export_customfile;
    /** @type {?} */
    DataImportExportService.prototype.export_success;
    /** @type {?} */
    DataImportExportService.prototype.export_fail;
    /** @type {?} */
    DataImportExportService.prototype.rule_list;
    /** @type {?} */
    DataImportExportService.prototype.i18nResource;
    /**
     * @type {?}
     * @private
     */
    DataImportExportService.prototype.modalService;
    /**
     * @type {?}
     * @private
     */
    DataImportExportService.prototype.resolver;
    /**
     * @type {?}
     * @private
     */
    DataImportExportService.prototype.injector;
    /**
     * @type {?}
     * @private
     */
    DataImportExportService.prototype.frameContext;
    /**
     * @type {?}
     * @private
     */
    DataImportExportService.prototype.dataExportService;
    /**
     * @type {?}
     * @private
     */
    DataImportExportService.prototype.notify;
    /**
     * @type {?}
     * @private
     */
    DataImportExportService.prototype.entityService;
    /**
     * @type {?}
     * @private
     */
    DataImportExportService.prototype.customIEService;
    /**
     * @type {?}
     * @private
     */
    DataImportExportService.prototype.handcraftSer;
    /**
     * @type {?}
     * @private
     */
    DataImportExportService.prototype.http;
    /**
     * @type {?}
     * @private
     */
    DataImportExportService.prototype.loadingService;
    /**
     * @type {?}
     * @private
     */
    DataImportExportService.prototype.dataImportService;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGF0YS1pbXBvcnQtZXhwb3J0LnNlcnZpY2UuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZ3NwLWRpcC9kYXRhLWltcC1leHAvIiwic291cmNlcyI6WyJsaWIvc2VydmljZS9EYXRhSUVTZXJ2aWNlL2RhdGEtaW1wb3J0LWV4cG9ydC5zZXJ2aWNlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7QUFBQSxPQUFPLEVBQUMsd0JBQXdCLEVBQUUsVUFBVSxFQUFFLFFBQVEsRUFBQyxNQUFNLGVBQWUsQ0FBQztBQUM3RSxPQUFPLEVBQUMscUJBQXFCLEVBQUMsTUFBTSw2Q0FBNkMsQ0FBQztBQUNsRixPQUFPLEVBQUMscUJBQXFCLEVBQUMsTUFBTSxvREFBb0QsQ0FBQztBQUN6RixPQUFPLEVBQUMsY0FBYyxFQUFDLE1BQU0sa0JBQWtCLENBQUM7QUFDaEQsT0FBTyxFQUFDLFlBQVksRUFBQyxNQUFNLGdCQUFnQixDQUFDO0FBQzVDLE9BQU8sRUFBQyxVQUFVLEVBQUMsTUFBTSxtQ0FBbUMsQ0FBQztBQUM3RCxPQUFPLEVBQUMsaUJBQWlCLEVBQUMsTUFBTSwwQkFBMEIsQ0FBQztBQUMzRCxPQUFPLEVBQUMsYUFBYSxFQUFDLE1BQU0sbUJBQW1CLENBQUM7QUFDaEQsT0FBTyxFQUFDLGlCQUFpQixFQUFDLE1BQU0sdUJBQXVCLENBQUM7QUFDeEQsT0FBTyxFQUFhLE9BQU8sRUFBQyxNQUFNLE1BQU0sQ0FBQztBQUN6QyxPQUFPLEVBQUMsbUJBQW1CLEVBQUMsTUFBTSwwQkFBMEIsQ0FBQztBQUM3RCxPQUFPLEVBQUMsMkJBQTJCLEVBQUMsTUFBTSwyREFBMkQsQ0FBQztBQUN0RyxPQUFPLEVBQUMsMkJBQTJCLEVBQUMsTUFBTSwyREFBMkQsQ0FBQztBQUN0RyxPQUFPLEVBQUMsVUFBVSxFQUFDLE1BQU0sc0JBQXNCLENBQUM7QUFDaEQsT0FBTyxFQUFDLFdBQVcsRUFBZ0IsYUFBYSxFQUFFLGlCQUFpQixFQUFDLE1BQU0sc0JBQXNCLENBQUM7QUFDakcsT0FB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QUFzQjtnQkFGdEIsVUFBVTtnQkFHVixjQUFjO2dCQUNkLGlCQUFpQjs7SUFpeUJ6Qiw4QkFBQztDQUFBLEFBL3hCRCxJQSt4QkM7U0E5eEJZLHVCQUF1Qjs7O0lBQ2xDLDhDQUFvQjs7SUFDcEIsOENBQW9COztJQUNwQix5REFBK0I7O0lBQy9CLGlEQUF1Qjs7SUFDdkIsOENBQW9COztJQUNwQiw0Q0FBa0I7O0lBRWxCLCtDQUFrQjs7Ozs7SUFHaEIsK0NBQW9DOzs7OztJQUNwQywyQ0FBMEM7Ozs7O0lBQzFDLDJDQUEwQjs7Ozs7SUFDMUIsK0NBQWtDOzs7OztJQUNsQyxvREFBNEM7Ozs7O0lBQzVDLHlDQUE2Qjs7Ozs7SUFDN0IsZ0RBQXdDOzs7OztJQUN4QyxrREFBNEM7Ozs7O0lBQzVDLCtDQUE0Qzs7Ozs7SUFDNUMsdUNBQXdCOzs7OztJQUN4QixpREFBc0M7Ozs7O0lBQ3RDLG9EQUE0QyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7Q29tcG9uZW50RmFjdG9yeVJlc29sdmVyLCBJbmplY3RhYmxlLCBJbmplY3Rvcn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7SW1wb3J0RGlhbG9nQ29tcG9uZW50fSBmcm9tICcuLi8uLi9pbXBvcnQtZGlhbG9nL2ltcG9ydC1kaWFsb2cuY29tcG9uZW50JztcclxuaW1wb3J0IHtFeHBvcnREaWFsb2dDb21wb25lbnR9IGZyb20gJy4uLy4uL2N1c3RvbS1leHBvcnQtZGlhbG9nL2V4cG9ydC1kaWFsb2cuY29tcG9uZW50JztcclxuaW1wb3J0IHtCc01vZGFsU2VydmljZX0gZnJvbSAnQGZhcnJpcy91aS1tb2RhbCc7XHJcbmltcG9ydCB7RnJhbWVDb250ZXh0fSBmcm9tICdAZmFycmlzL2RldmtpdCc7XHJcbmltcG9ydCB7TWV0aG9kVHlwZX0gZnJvbSAnLi4vLi4vbW9kZWwvRGF0YUlFVHlwZS9NZXRob2RUeXBlJztcclxuaW1wb3J0IHtFbnRpdHlMaXN0U2VydmljZX0gZnJvbSAnQGZhcnJpcy9jb21tYW5kLXNlcnZpY2VzJztcclxuaW1wb3J0IHtOb3RpZnlTZXJ2aWNlfSBmcm9tICdAZmFycmlzL3VpLW5vdGlmeSc7XHJcbmltcG9ydCB7RGF0YUV4cG9ydFNlcnZpY2V9IGZyb20gJy4vZGF0YS1leHBvcnQuc2VydmljZSc7XHJcbmltcG9ydCB7T2JzZXJ2YWJsZSwgU3ViamVjdH0gZnJvbSAncnhqcyc7XHJcbmltcG9ydCB7Q3VzdG9tRGF0YUlFU2VydmljZX0gZnJvbSAnLi9jdXN0b20tZGF0YS1pZS5zZXJ2aWNlJztcclxuaW1wb3J0IHtDdXN0b21JbXBvcnREaWFsb2dDb21wb25lbnR9IGZyb20gJy4uLy4uL2N1c3RvbS1pbXBvcnQtZGlhbG9nL2N1c3RvbS1pbXBvcnQtZGlhbG9nLmNvbXBvbmVudCc7XHJcbmltcG9ydCB7RXhwb3J0Q3VzdG9tU2VsZWN0Q29tcG9uZW50fSBmcm9tICcuLi8uLi9leHBvcnQtY3VzdG9tLXNlbGVjdC9leHBvcnQtY3VzdG9tLXNlbGVjdC5jb21wb25lbnQnO1xyXG5pbXBvcnQge0h0dHBDbGllbnR9IGZyb20gJ0Bhbmd1bGFyL2NvbW1vbi9odHRwJztcclxuaW1wb3J0IHtEYXRhSUVVdGlscywgRmlsZVR5cGVVdGlsLCBpc051bGxPckVtcHR5LCBpc051bGxPclVuZGVmaW5lZH0gZnJvbSAnLi4vVXRpbHMvRGF0YUlFVXRpbHMnO1xyXG5pbXBvcnQge0RhdGFpZUhhbmRjcmFmdFNlcnZpY2V9IGZyb20gJy4vZGF0YWllLWhhbmRjcmFmdC5zZXJ2aWNlJztcclxuaW1wb3J0IHtMb2FkaW5nU2VydmljZX0gZnJvbSAnQGZhcnJpcy91aS1sb2FkaW5nJztcclxuaW1wb3J0IHtEYXRhSW1wb3J0U2VydmljZX0gZnJvbSBcIi4vZGF0YS1pbXBvcnQuc2VydmljZVwiO1xyXG5cclxuQEluamVjdGFibGUoKVxyXG5leHBvcnQgY2xhc3MgRGF0YUltcG9ydEV4cG9ydFNlcnZpY2Uge1xyXG4gIGRhdGFfaW1wb3J0OiBzdHJpbmc7XHJcbiAgZGF0YV9leHBvcnQ6IHN0cmluZztcclxuICBkYXRhX2V4cG9ydF9jdXN0b21maWxlOiBzdHJpbmc7XHJcbiAgZXhwb3J0X3N1Y2Nlc3M6IHN0cmluZztcclxuICBleHBvcnRfZmFpbDogc3RyaW5nO1xyXG4gIHJ1bGVfbGlzdDogc3RyaW5nO1xyXG4gIC8vMjAyMS4xMi4xN+WPt+WKoOeahFxyXG4gIGkxOG5SZXNvdXJjZTogYW55O1xyXG5cclxuICBjb25zdHJ1Y3RvcihcclxuICAgIHByaXZhdGUgbW9kYWxTZXJ2aWNlOiBCc01vZGFsU2VydmljZSxcclxuICAgIHByaXZhdGUgcmVzb2x2ZXI6IENvbXBvbmVudEZhY3RvcnlSZXNvbHZlcixcclxuICAgIHByaXZhdGUgaW5qZWN0b3I6IEluamVjdG9yLFxyXG4gICAgcHJpdmF0ZSBmcmFtZUNvbnRleHQ6IEZyYW1lQ29udGV4dCxcclxuICAgIHByaXZhdGUgZGF0YUV4cG9ydFNlcnZpY2U6IERhdGFFeHBvcnRTZXJ2aWNlLFxyXG4gICAgcHJpdmF0ZSBub3RpZnk6IE5vdGlmeVNlcnZpY2UsXHJcbiAgICBwcml2YXRlIGVudGl0eVNlcnZpY2U6IEVudGl0eUxpc3RTZXJ2aWNlLFxyXG4gICAgcHJpdmF0ZSBjdXN0b21JRVNlcnZpY2U6IEN1c3RvbURhdGFJRVNlcnZpY2UsXHJcbiAgICBwcml2YXRlIGhhbmRjcmFmdFNlcjogRGF0YWllSGFuZGNyYWZ0U2VydmljZSxcclxuICAgIHByaXZhdGUgaHR0cDogSHR0cENsaWVudCxcclxuICAgIHByaXZhdGUgbG9hZGluZ1NlcnZpY2U6IExvYWRpbmdTZXJ2aWNlLFxyXG4gICAgcHJpdmF0ZSBkYXRhSW1wb3J0U2VydmljZTogRGF0YUltcG9ydFNlcnZpY2VcclxuICApIHtcclxuICAgIERhdGFJRVV0aWxzLmdldFRyYW5zbGF0ZVZhbHVlKGh0dHApLnN1YnNjcmliZShyZXMgPT4ge1xyXG4gICAgICB0aGlzLmkxOG5SZXNvdXJjZSA9IHJlcztcclxuICAgICAgdGhpcy5kYXRhX2ltcG9ydCA9IHJlc1snZGF0YV9pbXBvcnQnXTtcclxuICAgICAgdGhpcy5kYXRhX2V4cG9ydCA9IHJlc1snZGF0YV9leHBvcnQnXTtcclxuICAgICAgdGhpcy5leHBvcnRfc3VjY2VzcyA9IHJlc1snZXhwb3J0X3N1Y2Nlc3MnXTtcclxuICAgICAgdGhpcy5leHBvcnRfZmFpbCA9IHJlc1snZXhwb3J0X2ZhaWwnXTtcclxuICAgICAgdGhpcy5kYXRhX2V4cG9ydF9jdXN0b21maWxlID0gcmVzWydkYXRhX2V4cG9ydF9jdXN0b21maWxlJ107XHJcbiAgICAgIHRoaXMucnVsZV9saXN0ID0gcmVzWydydWxlX2xpc3QnXTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog5qC55o2u6KeE5YiZ5a+85Ye6XHJcbiAgICogQHBhcmFtIHJ1bGVJRFxyXG4gICAqIEBwYXJhbSBvcHRpb25cclxuICAgKi9cclxuICBwdWJsaWMgRXhwb3J0QnlSdWxlKHJ1bGVJRDogc3RyaW5nLCBvcHRpb246IHN0cmluZyk6IE9ic2VydmFibGU8YW55PiB7XHJcbiAgICBjb25zdCBzdWJqZWN0ID0gbmV3IFN1YmplY3Q8YW55PigpO1xyXG5cclxuICAgIGNvbnN0IG9wdGlvbkpzb24gPSB0aGlzLlBhcnNlRXhwb3J0SnNvbihvcHRpb24pO1xyXG4gICAgaWYgKG9wdGlvbkpzb24ucGFja1NpemUpIHtcclxuICAgICAgLy/ojrflj5bmgLvlhbHmnInlpJrlsJHmnaHmlbDmja5cclxuICAgICAgY29uc3QgdG90YWxEYXRhID0gdGhpcy5mcmFtZUNvbnRleHQuYmluZGluZ0RhdGEucGFnaW5nSW5mby50b3RhbDtcclxuICAgICAgaWYgKGlzTnVsbE9yVW5kZWZpbmVkKHRvdGFsRGF0YSkgfHwgdG90YWxEYXRhIDw9IDApIHtcclxuICAgICAgICB0aGlzLm5vdGlmeS53YXJuaW5nKCfmnKrojrflj5bliLDmgLvmlbDmja7ph4/miJbmlbDmja7ph4/kuLow77yM5peg5rOV6L+b6KGM5YiG5om55omT5YyF5a+85Ye677yM6K+35qOA5p+lJyk7XHJcbiAgICAgICAgc3ViamVjdC5uZXh0KGZhbHNlKTtcclxuICAgICAgICBzdWJqZWN0LmNvbXBsZXRlKCk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgbGV0IGZpbHRlckNvbmRpdGlvbnMgPSBbXTtcclxuICAgICAgICBpZiAob3B0aW9uSnNvbi5lbmFibGVTY3JlZW5pbmdTY2hlbWUgPT09IHRydWUpIHtcclxuICAgICAgICAgIGNvbnN0IGZpbHRlckNvbmRpdGlvbkxpc3QgPSB0aGlzLmZyYW1lQ29udGV4dC51aVN0YXRlWydmaWx0ZXJDb25kaXRpb25MaXN0J107XHJcbiAgICAgICAgICBpZiAoIWlzTnVsbE9yVW5kZWZpbmVkKGZpbHRlckNvbmRpdGlvbkxpc3QpICYmIGZpbHRlckNvbmRpdGlvbkxpc3QgIT09ICcnICYmIGZpbHRlckNvbmRpdGlvbkxpc3QgIT09ICdbXScpIHtcclxuICAgICAgICAgICAgbGV0IGZpbHRlckNvbmRpdGlvbkxpc3RKc29uID0gW107XHJcbiAgICAgICAgICAgIGlmICh0eXBlb2YgKGZpbHRlckNvbmRpdGlvbkxpc3QpID09PSAnc3RyaW5nJykge1xyXG4gICAgICAgICAgICAgIGZpbHRlckNvbmRpdGlvbkxpc3RKc29uID0gSlNPTi5wYXJzZShmaWx0ZXJDb25kaXRpb25MaXN0KTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICBmaWx0ZXJDb25kaXRpb25MaXN0SnNvbiA9IGZpbHRlckNvbmRpdGlvbkxpc3Q7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZm9yIChsZXQgaW5kZXggPSAwOyBpbmRleCA8IGZpbHRlckNvbmRpdGlvbkxpc3RKc29uLmxlbmd0aDsgaW5kZXgrKykge1xyXG4gICAgICAgICAgICAgIGNvbnN0IGVsZW1lbnQgPSBmaWx0ZXJDb25kaXRpb25MaXN0SnNvbltpbmRleF07XHJcbiAgICAgICAgICAgICAgZWxlbWVudC5WYWx1ZSA9IGRlY29kZVVSSUNvbXBvbmVudChlbGVtZW50LlZhbHVlKTtcclxuICAgICAgICAgICAgICBpZiAoaW5kZXggPT09IGZpbHRlckNvbmRpdGlvbkxpc3RKc29uLmxlbmd0aCAtIDEpIHtcclxuICAgICAgICAgICAgICAgIGVsZW1lbnQuUmVsYXRpb24gPSAwO1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICBmaWx0ZXJDb25kaXRpb25zLnB1c2goZWxlbWVudCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgLy/liIbpobXlpKflsI/vvIzlr7nlupTnmoTmr4/kuKpFeGNlbOaWh+S7tueahOaVsOaNrumHj1xyXG4gICAgICAgIGNvbnN0IHBhZ2VTaXplID0gTnVtYmVyLnBhcnNlSW50KG9wdGlvbkpzb24ucGFja1NpemUpO1xyXG4gICAgICAgIGNvbnN0IG51bSA9IE1hdGguY2VpbCh0b3RhbERhdGEgLyBwYWdlU2l6ZSk7XHJcbiAgICAgICAgY29uc3QgcGFja2l0ZW1zID0gW107XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBudW07IGkrKykge1xyXG4gICAgICAgICAgY29uc3QgcGFja2l0ZW0gPSB7XHJcbiAgICAgICAgICAgIHJ1bGVpZDogcnVsZUlELFxyXG4gICAgICAgICAgICBnbG9iYWxQYXJhbTogb3B0aW9uSnNvbi5nbG9iYWxQYXJhbSxcclxuICAgICAgICAgICAgZmlsdGVyOiB7XHJcbiAgICAgICAgICAgICAgZmlsdGVyQ29uZGl0aW9uczogZmlsdGVyQ29uZGl0aW9ucyxcclxuICAgICAgICAgICAgICBpc1VzZVBhZ2luYXRpb246IHRydWUsXHJcbiAgICAgICAgICAgICAgcGFnaW5hdGlvbjoge1xyXG4gICAgICAgICAgICAgICAgcGFnZUluZGV4OiBpICsgMSxcclxuICAgICAgICAgICAgICAgIHBhZ2VTaXplOiBwYWdlU2l6ZVxyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfTtcclxuICAgICAgICAgIHBhY2tpdGVtcy5wdXNoKHBhY2tpdGVtKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgbGV0IGN1c3RvbWZpbGVuYW1lID0gJ+aJk+WMheWvvOWHuicgKyBuZXcgRGF0ZSgpO1xyXG4gICAgICAgIGlmICghaXNOdWxsT3JFbXB0eShvcHRpb25Kc29uLmN1c3RvbWZpbGVuYW1lKSkge1xyXG4gICAgICAgICAgY3VzdG9tZmlsZW5hbWUgPSBvcHRpb25Kc29uLmN1c3RvbWZpbGVuYW1lO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCBvcHRpb24gPSB7XHJcbiAgICAgICAgICBwYWNrYWdlOlxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgY3VzdG9tZmlsZW5hbWU6IGN1c3RvbWZpbGVuYW1lLFxyXG4gICAgICAgICAgICAgIHBhY2tpdGVtczogcGFja2l0ZW1zXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5FeHBvcnRCeVBhY2thZ2UoSlNPTi5zdHJpbmdpZnkob3B0aW9uKSkuc3Vic2NyaWJlKHMgPT4ge1xyXG4gICAgICAgICAgc3ViamVjdC5uZXh0KHMpO1xyXG4gICAgICAgICAgc3ViamVjdC5jb21wbGV0ZSgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcblxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5FeHBvcnRDb21tb25FbnRyeShydWxlSUQsIG9wdGlvbiwgTWV0aG9kVHlwZS5Db21tb25FeHBvcnQpLnN1YnNjcmliZShzID0+IHtcclxuICAgICAgICBzdWJqZWN0Lm5leHQocyk7XHJcbiAgICAgICAgc3ViamVjdC5jb21wbGV0ZSgpO1xyXG4gICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gc3ViamVjdDtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOagueaNruinhOWImeWvvOWHulxyXG4gICAqIEBwYXJhbSBydWxlSURcclxuICAgKiBAcGFyYW0gb3B0aW9uXHJcbiAgICovXHJcbiAgcHVibGljIEV4cG9ydEN1cnJlbnRDaGlsZERhdGEocnVsZUlEOiBzdHJpbmcsIG9wdGlvbjogc3RyaW5nKTogT2JzZXJ2YWJsZTxhbnk+IHtcclxuICAgIGNvbnN0IHN1YmplY3QgPSBuZXcgU3ViamVjdDxhbnk+KCk7XHJcbiAgICB0aGlzLkV4cG9ydENvbW1vbkVudHJ5KHJ1bGVJRCwgb3B0aW9uLCBNZXRob2RUeXBlLkV4cG9ydEN1cnJlbnRDaGlsZERhdGEpLnN1YnNjcmliZShzID0+IHtcclxuICAgICAgc3ViamVjdC5uZXh0KHMpO1xyXG4gICAgICBzdWJqZWN0LmNvbXBsZXRlKCk7XHJcbiAgICB9KTtcclxuICAgIHJldHVybiBzdWJqZWN0O1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog5a+85Ye65b2T5YmN5YiX6KGo5pWw5o2u77yI5YiG6aG177yJXHJcbiAgICogQHBhcmFtIHJ1bGVJRFxyXG4gICAqIEBwYXJhbSBvcHRpb25cclxuICAgKi9cclxuICBwdWJsaWMgRXhwb3J0Q3VycmVudExpc3REYXRhKHJ1bGVJRDogc3RyaW5nLCBvcHRpb246IHN0cmluZyk6IE9ic2VydmFibGU8YW55PiB7XHJcbiAgICBjb25zdCBzdWJqZWN0ID0gbmV3IFN1YmplY3Q8YW55PigpO1xyXG4gICAgdGhpcy5FeHBvcnRDb21tb25FbnRyeShydWxlSUQsIG9wdGlvbiwgTWV0aG9kVHlwZS5FeHBvcnRDdXJyZW50VGFibGVEYXRhKS5zdWJzY3JpYmUocyA9PiB7XHJcbiAgICAgIHN1YmplY3QubmV4dChzKTtcclxuICAgICAgc3ViamVjdC5jb21wbGV0ZSgpO1xyXG4gICAgfSk7XHJcbiAgICByZXR1cm4gc3ViamVjdDtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOaJuemHj+aJk+WMheWvvOWHulxyXG4gICAqIEBwYXJhbSBvcHRpb24g6YWN572u5omT5YyF5L+h5oGvXHJcbiAgICovXHJcbiAgcHVibGljIEV4cG9ydEJ5UGFja2FnZShvcHRpb246IHN0cmluZyk6IE9ic2VydmFibGU8YW55PiB7XHJcbiAgICBjb25zb2xlLmxvZyhvcHRpb24pO1xyXG4gICAgY29uc3Qgc3ViamVjdCA9IG5ldyBTdWJqZWN0PEJvb2xlYW4+KCk7XHJcbiAgICBjb25zdCBvcHRpb25Kc29uID0gdGhpcy5QYXJzZUV4cG9ydEpzb24ob3B0aW9uKTtcclxuICAgIHRoaXMuZGF0YUV4cG9ydFNlcnZpY2UuRXhwb3J0QnlQYWNrYWdlKHRoaXMuZnJhbWVDb250ZXh0LnJlcG9zaXRvcnksIG9wdGlvbkpzb24pO1xyXG4gICAgY29uc3QgdW5zY3JpYmVyID0gdGhpcy5kYXRhRXhwb3J0U2VydmljZS5leHBvcnQuc3Vic2NyaWJlKGRhdGEgPT4ge1xyXG4gICAgICBpZiAoZGF0YSA9PT0gJycpIHtcclxuICAgICAgICB0aGlzLm5vdGlmeS5zdWNjZXNzKHRoaXMuZXhwb3J0X3N1Y2Nlc3MpO1xyXG4gICAgICAgIHVuc2NyaWJlci51bnN1YnNjcmliZSgpO1xyXG4gICAgICAgIHN1YmplY3QubmV4dCh0cnVlKTtcclxuICAgICAgICBzdWJqZWN0LmNvbXBsZXRlKCk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgY29uc3QgZXJyb3JsZXZlbCA9IHRoaXMuZGF0YUV4cG9ydFNlcnZpY2UuZXJyb3JsZXZlbDtcclxuICAgICAgICBpZiAoZXJyb3JsZXZlbCA9PT0gJ0luZm8nKSB7XHJcbiAgICAgICAgICB0aGlzLm5vdGlmeS5pbmZvKGRhdGEpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoZXJyb3JsZXZlbCA9PT0gJ1dhcm5pbmcnKSB7XHJcbiAgICAgICAgICB0aGlzLm5vdGlmeS53YXJuaW5nKGRhdGEpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICB0aGlzLm5vdGlmeS5lcnJvcih0aGlzLmV4cG9ydF9mYWlsICsgZGF0YSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHVuc2NyaWJlci51bnN1YnNjcmliZSgpO1xyXG4gICAgICAgIHN1YmplY3QubmV4dChmYWxzZSk7XHJcbiAgICAgICAgc3ViamVjdC5jb21wbGV0ZSgpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICAgIHJldHVybiBzdWJqZWN0O1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBFeHBvcnRDb21tb25FbnRyeShydWxlSUQ6IHN0cmluZywgb3B0aW9uOiBzdHJpbmcsIG1ldGhvZFR5cGU6IE1ldGhvZFR5cGUpOiBPYnNlcnZhYmxlPGFueT4ge1xyXG4gICAgY29uc3Qgc3ViamVjdCA9IG5ldyBTdWJqZWN0PGFueT4oKTtcclxuICAgIGNvbnNvbGUubG9nKG9wdGlvbik7XHJcbiAgICBjb25zdCBvcHRpb25Kc29uID0gdGhpcy5QYXJzZUV4cG9ydEpzb24ob3B0aW9uKTtcclxuICAgIGlmIChpc051bGxPckVtcHR5KHJ1bGVJRCkgJiYgaXNOdWxsT3JFbXB0eShvcHRpb25Kc29uLnZvSWQpKSB7XHJcbiAgICAgIHRoaXMubm90aWZ5Lndhcm5pbmcoXCLmnKrphY3nva7op4TliJlpZO+8jOS4lOaXoOazleiOt+WPluWIsOihqOWNleWvueW6lOeahHZvSWTvvIzor7fmo4Dmn6VcIik7XHJcbiAgICAgIHJldHVybiBzdWJqZWN0O1xyXG4gICAgfVxyXG4gICAgaWYgKG1ldGhvZFR5cGUgPT09IE1ldGhvZFR5cGUuRXhwb3J0Q3VycmVudENoaWxkRGF0YSkge1xyXG4gICAgICBpZiAoaXNOdWxsT3JFbXB0eShydWxlSUQpICYmIGlzTnVsbE9yRW1wdHkob3B0aW9uSnNvbi5leHBvcnRDaGlsZE5vZGVDb2RlKSkge1xyXG4gICAgICAgIC8v5a+85Ye65a2Q6KGo5b2T6KeE5YiZaWTkuLrnqbrml7bvvIzmoLnmja52b+aJvuinhOWIme+8jOW/hemhu+imgeaxguaciemFjee9ruWtkOihqOiKgueCuVxyXG4gICAgICAgIHRoaXMubm90aWZ5Lndhcm5pbmcoXCLop4TliJlpZOS4uuepuuaXtu+8jOagueaNrlZv5p+l5om+6KeE5YiZ77yM5a+85Ye65a2Q6KGo5b+F6aG76YWN572u5a2Q6KGo6IqC54K5XCIpO1xyXG4gICAgICAgIHJldHVybiBzdWJqZWN0O1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBpZiAoaXNOdWxsT3JFbXB0eShydWxlSUQpIHx8IG9wdGlvbkpzb24uZW5hYmxlUnVudGltZUN1c3RvbSA9PT0gdHJ1ZSB8fCBvcHRpb25Kc29uLnNlbGVjdGZpbGV0eXBlID09PSB0cnVlKSB7XHJcbiAgICAgIGNvbnN0IGJlZlJlc3RTZXJ2aWNlID0gRGF0YUlFVXRpbHMuR2V0QmVmUmVzdFNlcnZpY2UodGhpcy5mcmFtZUNvbnRleHQucmVwb3NpdG9yeSk7XHJcbiAgICAgIHRoaXMuU3RhcnRMb2FkaW5nKCk7XHJcbiAgICAgIGNvbnN0IHVybCA9ICcvYXBpL3J1bnRpbWUvZGlwL3YxLjAvZGF0YUllUnVsZU1hbmFnZS9nZXRSZWNvcmRSdWxlSW5mbyc7XHJcbiAgICAgIGNvbnN0IHBvc3RCb2R5ID0ge1xyXG4gICAgICAgIGJvZHk6IHtcclxuICAgICAgICAgIHJ1bGVJZDogcnVsZUlELFxyXG4gICAgICAgICAgcnVsZVR5cGU6IDEsXHJcbiAgICAgICAgICB2b0lkOiBvcHRpb25Kc29uLnZvSWQsXHJcbiAgICAgICAgICBtZXRob2RUeXBlOiBtZXRob2RUeXBlLFxyXG4gICAgICAgICAgZXhwb3J0Q2hpbGROb2RlQ29kZTogb3B0aW9uSnNvbi5leHBvcnRDaGlsZE5vZGVDb2RlLFxyXG4gICAgICAgICAgZW5hYmxlUnVudGltZUN1c3RvbTogb3B0aW9uSnNvbi5lbmFibGVSdW50aW1lQ3VzdG9tID09PSB0cnVlXHJcbiAgICAgICAgfVxyXG4gICAgICB9O1xyXG4gICAgICBsZXQgc3Vic2NyaWJlcjogT2JzZXJ2YWJsZTxhbnk+O1xyXG4gICAgICBpZiAoIWlzTnVsbE9yVW5kZWZpbmVkKHRoaXMuaHR0cCkpIHtcclxuICAgICAgICBzdWJzY3JpYmVyID0gdGhpcy5odHRwLnBvc3QodXJsLCBwb3N0Qm9keS5ib2R5KTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBzdWJzY3JpYmVyID0gYmVmUmVzdFNlcnZpY2UucmVxdWVzdCh1cmwsICdwb3N0JywgbnVsbCwgcG9zdEJvZHkpO1xyXG4gICAgICB9XHJcbiAgICAgIHN1YnNjcmliZXIuc3Vic2NyaWJlKHJlY29yZFJ1bGUgPT4ge1xyXG4gICAgICAgIHRoaXMuQ2xvc2VMb2FkaW5nKCk7XHJcbiAgICAgICAgdGhpcy5FeHBvcnRCeVJ1bGVJbXBsKHJ1bGVJRCwgb3B0aW9uSnNvbiwgbWV0aG9kVHlwZSwgcmVjb3JkUnVsZSkuc3Vic2NyaWJlKHMgPT4ge1xyXG4gICAgICAgICAgc3ViamVjdC5uZXh0KHMpO1xyXG4gICAgICAgICAgc3ViamVjdC5jb21wbGV0ZSgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9LCBlcnJvciA9PiB7XHJcbiAgICAgICAgdGhpcy5DbG9zZUxvYWRpbmcoKTtcclxuICAgICAgICB0aGlzLm5vdGlmeS5lcnJvcihlcnJvci5lcnJvci5NZXNzYWdlKTtcclxuICAgICAgICBjb25zb2xlLmxvZyhlcnJvci5lcnJvci5NZXNzYWdlKTtcclxuICAgICAgfSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLkV4cG9ydEJ5UnVsZUltcGwocnVsZUlELCBvcHRpb25Kc29uLCBtZXRob2RUeXBlKS5zdWJzY3JpYmUocyA9PiB7XHJcbiAgICAgICAgc3ViamVjdC5uZXh0KHMpO1xyXG4gICAgICAgIHN1YmplY3QuY29tcGxldGUoKTtcclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gc3ViamVjdDtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgRXhwb3J0QnlSdWxlSW1wbChydWxlSUQ6IHN0cmluZywgb3B0aW9uSnNvbjogYW55LCBtVHlwZTogTWV0aG9kVHlwZSwgcmVjb3JkUnVsZT86IGFueSkge1xyXG4gICAgY29uc3Qgc3ViamVjdCA9IG5ldyBTdWJqZWN0PEJvb2xlYW4+KCk7XHJcbiAgICBpZiAob3B0aW9uSnNvbi5jdXN0b21FeHBvcnRUaXRsZSAhPT0gdW5kZWZpbmVkICYmIG9wdGlvbkpzb24uY3VzdG9tRXhwb3J0VGl0bGUgIT09IG51bGwpIHtcclxuICAgICAgaWYgKG9wdGlvbkpzb24uY3VzdG9tRXhwb3J0VGl0bGUubGVuZ3RoID4gMjApIHtcclxuICAgICAgICB0aGlzLm5vdGlmeS53YXJuaW5nKCfoh6rlrprkuYnmoIfpopjlkI3np7DnmoTplb/luqblpKrplb8nKTtcclxuICAgICAgICByZXR1cm4gc3ViamVjdDtcclxuICAgICAgfVxyXG4gICAgICBpZiAoRGF0YUlFVXRpbHMuSnVkZ2VJbGxlZ2FsQ2hhcihvcHRpb25Kc29uLmN1c3RvbUV4cG9ydFRpdGxlKSkge1xyXG4gICAgICAgIHRoaXMubm90aWZ5Lndhcm5pbmcoJ+iHquWumuS5ieagh+mimOWQjeensOWtmOWcqOS4jeWQiOazleWtl+espicpO1xyXG4gICAgICAgIHJldHVybiBzdWJqZWN0O1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKG9wdGlvbkpzb24uYXBwbHl1aSA9PT0gdHJ1ZSkge1xyXG4gICAgICBjb25zdCBjbXBSZWYgPSB0aGlzLkNyZWF0ZUV4cG9ydENvbXBvbmVudCgpO1xyXG4gICAgICBjbXBSZWYuaW5zdGFuY2UucnVsZUlkID0gcnVsZUlEO1xyXG4gICAgICBjbXBSZWYuaW5zdGFuY2UuZXhwb3J0T3B0aW9uID0gb3B0aW9uSnNvbjtcclxuICAgICAgY21wUmVmLmluc3RhbmNlLmZyYW1lQ29udGV4dCA9IHRoaXMuZnJhbWVDb250ZXh0O1xyXG4gICAgICBjbXBSZWYuaW5zdGFuY2UubWV0aG9kVHlwZSA9IG1UeXBlO1xyXG4gICAgICBjbXBSZWYuaW5zdGFuY2Uuc3ViamVjdCA9IHN1YmplY3Q7XHJcbiAgICAgIGNtcFJlZi5pbnN0YW5jZS5zaG93ID0gb3B0aW9uSnNvbi52c3RvO1xyXG4gICAgICBjbXBSZWYuaW5zdGFuY2UuaXNDdXN0b21FeHBvcnQgPSBmYWxzZTtcclxuICAgICAgY29uc3QgZXhwb3J0TW9kYWxDb25maWcgPSB0aGlzLkdldEV4cG9ydERpYWxvZ0NvbmZpZyhjbXBSZWYsIG9wdGlvbkpzb24pO1xyXG4gICAgICBjb25zdCBkaWFsb2cgPSB0aGlzLm1vZGFsU2VydmljZS5zaG93KGNtcFJlZiwgZXhwb3J0TW9kYWxDb25maWcpO1xyXG4gICAgICBjbXBSZWYuaW5zdGFuY2UubmVlZERlc3Ryb3kuc3Vic2NyaWJlKCRldmVudCA9PiB7XHJcbiAgICAgICAgZGlhbG9nLmNsb3NlKCk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSBlbHNlIGlmIChvcHRpb25Kc29uLmVuYWJsZVJ1bnRpbWVDdXN0b20gPT09IHRydWUgfHwgb3B0aW9uSnNvbi5zZWxlY3RmaWxldHlwZSA9PT0gdHJ1ZSkge1xyXG4gICAgICBjb25zdCBjbXBSZWYgPSB0aGlzLkNyZWF0ZVNlbGVjdEV4cG9ydENvbXBvbmVudCgpO1xyXG4gICAgICBjbXBSZWYuaW5zdGFuY2UucnVsZUlkID0gcnVsZUlEO1xyXG4gICAgICBjbXBSZWYuaW5zdGFuY2UuZXhwb3J0T3B0aW9uID0gb3B0aW9uSnNvbjtcclxuICAgICAgY21wUmVmLmluc3RhbmNlLnJlY29yZFJ1bGUgPSByZWNvcmRSdWxlO1xyXG4gICAgICBjbXBSZWYuaW5zdGFuY2UuZnJhbWVDb250ZXh0ID0gdGhpcy5mcmFtZUNvbnRleHQ7XHJcbiAgICAgIGNtcFJlZi5pbnN0YW5jZS5tZXRob2RUeXBlID0gbVR5cGU7XHJcbiAgICAgIGNtcFJlZi5pbnN0YW5jZS5zdWJqZWN0ID0gc3ViamVjdDtcclxuICAgICAgY29uc3QgZXhwb3J0TW9kYWxDb25maWcgPSB0aGlzLkdldFNlbGVjdEV4cG9ydERpYWxvZ0NvbmZpZyhjbXBSZWYsIG9wdGlvbkpzb24pO1xyXG4gICAgICBjb25zdCBkaWFsb2cgPSB0aGlzLm1vZGFsU2VydmljZS5zaG93KGNtcFJlZiwgZXhwb3J0TW9kYWxDb25maWcpO1xyXG4gICAgICBjbXBSZWYuaW5zdGFuY2UubmVlZERlc3Ryb3kuc3Vic2NyaWJlKCRldmVudCA9PiB7XHJcbiAgICAgICAgZGlhbG9nLmNsb3NlKCk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgaWYgKCFpc051bGxPclVuZGVmaW5lZChyZWNvcmRSdWxlKSAmJiAhaXNOdWxsT3JFbXB0eShyZWNvcmRSdWxlLnJ1bGVJZCkpIHtcclxuICAgICAgICBydWxlSUQgPSByZWNvcmRSdWxlLnJ1bGVJZDtcclxuICAgICAgfVxyXG4gICAgICBpZiAobVR5cGUgPT0gTWV0aG9kVHlwZS5Db21tb25FeHBvcnQpIHtcclxuICAgICAgICB0aGlzLmRhdGFFeHBvcnRTZXJ2aWNlLkV4cG9ydEJ5SWQocnVsZUlELCB0aGlzLmZyYW1lQ29udGV4dCwgb3B0aW9uSnNvbik7XHJcbiAgICAgIH0gZWxzZSBpZiAobVR5cGUgPT0gTWV0aG9kVHlwZS5FeHBvcnRDdXJyZW50VGFibGVEYXRhKSB7XHJcbiAgICAgICAgdGhpcy5kYXRhRXhwb3J0U2VydmljZS5FeHBvcnRDdXJyZW50RGF0YShydWxlSUQsIHRoaXMuZnJhbWVDb250ZXh0LCB0aGlzLmVudGl0eVNlcnZpY2UucGFnZUluZGV4LFxyXG4gICAgICAgICAgdGhpcy5lbnRpdHlTZXJ2aWNlLnBhZ2VTaXplLCBvcHRpb25Kc29uKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICB0aGlzLmRhdGFFeHBvcnRTZXJ2aWNlLkV4cG9ydEN1cnJlbnRDaGlsZERhdGEocnVsZUlELCB0aGlzLmZyYW1lQ29udGV4dCwgb3B0aW9uSnNvbik7XHJcbiAgICAgIH1cclxuICAgICAgY29uc3QgdW5zY3JpYmVyID0gdGhpcy5kYXRhRXhwb3J0U2VydmljZS5leHBvcnQuc3Vic2NyaWJlKGRhdGEgPT4ge1xyXG4gICAgICAgIGlmIChkYXRhID09PSAnJykge1xyXG4gICAgICAgICAgLy8g5pyJ5Lq66ZyA5rGC5a+85Ye65Y675o6J5oiQ5Yqf5o+Q56S677yM5Zug5Li65paH5Lu26L+Y5rKh5LiL6L295LiL5p2l5o+Q56S65o+Q5YmN5LqGXHJcbiAgICAgICAgICBpZiAob3B0aW9uSnNvbi5jYW5jZWxub3RpZnkgPT09IHVuZGVmaW5lZCB8fCBvcHRpb25Kc29uLmNhbmNlbG5vdGlmeSA9PT0gbnVsbCB8fCBvcHRpb25Kc29uLmNhbmNlbG5vdGlmeSA9PT0gZmFsc2UpIHtcclxuICAgICAgICAgICAgdGhpcy5ub3RpZnkuc3VjY2Vzcyh0aGlzLmV4cG9ydF9zdWNjZXNzKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIHN1YmplY3QubmV4dCh0cnVlKTtcclxuICAgICAgICAgIHN1YmplY3QuY29tcGxldGUoKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgY29uc3QgZXJyb3JsZXZlbCA9IHRoaXMuZGF0YUV4cG9ydFNlcnZpY2UuZXJyb3JsZXZlbDtcclxuICAgICAgICAgIGlmIChlcnJvcmxldmVsID09PSAnSW5mbycpIHtcclxuICAgICAgICAgICAgdGhpcy5ub3RpZnkuaW5mbyhkYXRhKTtcclxuICAgICAgICAgIH0gZWxzZSBpZiAoZXJyb3JsZXZlbCA9PT0gJ1dhcm5pbmcnKSB7XHJcbiAgICAgICAgICAgIHRoaXMubm90aWZ5Lndhcm5pbmcoZGF0YSk7XHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLm5vdGlmeS5lcnJvcih0aGlzLmV4cG9ydF9mYWlsICsgZGF0YSk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBzdWJqZWN0Lm5leHQoZmFsc2UpO1xyXG4gICAgICAgICAgc3ViamVjdC5jb21wbGV0ZSgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB1bnNjcmliZXIudW5zdWJzY3JpYmUoKTtcclxuICAgICAgfSwgZXJyb3IgPT4ge1xyXG4gICAgICAgIHRoaXMubm90aWZ5LmVycm9yKGVycm9yLmVycm9yLk1lc3NhZ2UpO1xyXG4gICAgICAgIHN1YmplY3QubmV4dChmYWxzZSk7XHJcbiAgICAgICAgc3ViamVjdC5jb21wbGV0ZSgpO1xyXG4gICAgICB9KTtcclxuICAgIH1cclxuICAgIHJldHVybiBzdWJqZWN0O1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog6YCa55So5a+85YWl5pa55rOVXHJcbiAgICogQHBhcmFtIHR5cGVcclxuICAgKiBAcGFyYW0gcnVsZUlEXHJcbiAgICogQHBhcmFtIG9wdGlvblxyXG4gICAqL1xyXG4gIHB1YmxpYyBDb21tb25EYXRhSW1wb3J0KHR5cGU6IGFueSwgcnVsZUlEOiBzdHJpbmcsIG9wdGlvbjogc3RyaW5nKTogT2JzZXJ2YWJsZTxhbnk+IHtcclxuICAgIC8vIGlmICh0eXBlICE9PSAyICYmIChydWxlSUQgPT09IHVuZGVmaW5lZCB8fCBydWxlSUQgPT09IG51bGwgfHwgcnVsZUlEID09PSAnJykpIHtcclxuICAgIC8vICAgICB0aGlzLm5vdGlmeS5lcnJvcign6K+35Zyo6KGo5Y2V5a+85YWl5ZG95Luk5Yqo5L2c5aSE6YWN572u5a+85YWl6KeE5YiZSUQnKTtcclxuICAgIC8vICAgICByZXR1cm47XHJcbiAgICAvLyB9XHJcbiAgICBpZiAodHlwZSA9PT0gMSkge1xyXG4gICAgICBjb25zb2xlLmxvZygn5omn6KGM5pa55rOV77yaSW1wb3J0U3VibGlzdERhdGEnKTtcclxuICAgICAgcmV0dXJuIHRoaXMuSW1wb3J0U3VibGlzdERhdGEocnVsZUlELCBvcHRpb24pO1xyXG4gICAgfSBlbHNlIGlmICh0eXBlID09PSAyKSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKCfmiafooYzmlrnms5XvvJpJbXBvcnRCeU1vZGVsJyk7XHJcbiAgICAgIHJldHVybiB0aGlzLkltcG9ydEJ5TW9kZWwob3B0aW9uKTtcclxuICAgIH0gZWxzZSBpZiAodHlwZSA9PT0gMCkge1xyXG4gICAgICBjb25zb2xlLmxvZygn5omn6KGM5pa55rOV77yaSW1wb3J0QnlSdWxlJyk7XHJcbiAgICAgIHJldHVybiB0aGlzLkltcG9ydEJ5UnVsZShydWxlSUQsIG9wdGlvbik7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBjb25zb2xlLmxvZygn5omn6KGM5pa55rOV77yaSW1wb3J0QnlSdWxlJyk7XHJcbiAgICAgIHJldHVybiB0aGlzLkltcG9ydEJ5UnVsZShydWxlSUQsIG9wdGlvbik7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDljaHniYfooajljZXmlbDmja7lr7zlhaXvvIjkuLvku47ooajvvIzlrZDooajvvIznu5/kuIDlj6rlr7zlhaXliLDooajljZXvvIlcclxuICAgKiBAcGFyYW0gZGF0YUlkXHJcbiAgICogQHBhcmFtIHJ1bGVJRFxyXG4gICAqIEBwYXJhbSBvcHRpb25cclxuICAgKi9cclxuICBwdWJsaWMgQ2FyZERhdGFJbXBvcnQoZGF0YUlkOiBzdHJpbmcsIHJ1bGVJRDogc3RyaW5nLCBvcHRpb246IHN0cmluZyk6IE9ic2VydmFibGU8YW55PiB7XHJcbiAgICBjb25zdCBzdWJqZWN0ID0gbmV3IFN1YmplY3Q8YW55PigpO1xyXG4gICAgY29uc29sZS5sb2coZGF0YUlkKTtcclxuICAgIGlmKCFkYXRhSWQpe1xyXG4gICAgICB0aGlzLm5vdGlmeS53YXJuaW5nKCfmnKror7vlj5bliLDkuLvooajmlbDmja5pZO+8jOS4jeWFgeiuuOWvvOWFpScpO1xyXG4gICAgICBzdWJqZWN0Lm5leHQoZmFsc2UpO1xyXG4gICAgICByZXR1cm4gc3ViamVjdDtcclxuICAgIH1cclxuICAgIGNvbnN0IG9wdGlvbkpzb24gPSB0aGlzLlBhcnNlSW1wb3J0SnNvbihvcHRpb24pO1xyXG4gICAgb3B0aW9uSnNvblsnbWFpbk9iaklkJ10gPSBkYXRhSWQ7XHJcbiAgICB0aGlzLmZyYW1lQ29udGV4dC5yZXBvc2l0b3J5LnVwZGF0ZUFsbENoYW5nZXMoKS5zdWJzY3JpYmUoZT0+e1xyXG4gICAgICB0aGlzLkltcG9ydENvbW1vbkVudHJ5KHJ1bGVJRCwgSlNPTi5zdHJpbmdpZnkob3B0aW9uSnNvbiksIE1ldGhvZFR5cGUuQ2FyZEZvcm1EYXRhSW1wb3J0KS5zdWJzY3JpYmUocyA9PiB7XHJcbiAgICAgICAgc3ViamVjdC5uZXh0KHMpO1xyXG4gICAgICAgIHN1YmplY3QuY29tcGxldGUoKTtcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICByZXR1cm4gc3ViamVjdDtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOmAmueUqOWvvOWHuuaWueazlVxyXG4gICAqIEBwYXJhbSB0eXBlXHJcbiAgICogQHBhcmFtIHJ1bGVJRFxyXG4gICAqIEBwYXJhbSBvcHRpb25cclxuICAgKi9cclxuICBwdWJsaWMgQ29tbW9uRGF0YUV4cG9ydCh0eXBlOiBhbnksIHJ1bGVJRDogc3RyaW5nLCBvcHRpb246IHN0cmluZyk6IE9ic2VydmFibGU8YW55PiB7XHJcbiAgICAvLyBpZiAodHlwZSAhPT0gMiAmJiAocnVsZUlEID09PSB1bmRlZmluZWQgfHwgcnVsZUlEID09PSBudWxsIHx8IHJ1bGVJRCA9PT0gJycpKSB7XHJcbiAgICAvLyAgICAgdGhpcy5ub3RpZnkuZXJyb3IoJ+ivt+WcqOihqOWNleWvvOWHuuWRveS7pOWKqOS9nOWkhOmFjee9ruWvvOWHuuinhOWImUlEJyk7XHJcbiAgICAvLyAgICAgcmV0dXJuO1xyXG4gICAgLy8gfVxyXG4gICAgaWYgKHR5cGUgPT09IDEpIHtcclxuICAgICAgY29uc29sZS5sb2coJ+aJp+ihjOaWueazle+8mkV4cG9ydEN1cnJlbnRMaXN0RGF0YScpO1xyXG4gICAgICAvLyBjb25zdCBwYWdlSW5mbyA9IG5ldyBQYWdlSW5mbygpO1xyXG4gICAgICAvLyBwYWdlSW5mby5wYWdlSW5kZXggPSB0aGlzLmVudGl0eVNlcnZpY2UucGFnZUluZGV4O1xyXG4gICAgICAvLyBwYWdlSW5mby5wYWdlU2l6ZSA9IHRoaXMuZW50aXR5U2VydmljZS5wYWdlU2l6ZTtcclxuICAgICAgcmV0dXJuIHRoaXMuRXhwb3J0Q3VycmVudExpc3REYXRhKHJ1bGVJRCwgb3B0aW9uKTtcclxuICAgIH0gZWxzZSBpZiAodHlwZSA9PT0gMikge1xyXG4gICAgICBjb25zb2xlLmxvZygn5omn6KGM5pa55rOV77yaRXhwb3J0QnlNb2RlbCcpO1xyXG4gICAgICByZXR1cm4gdGhpcy5FeHBvcnRCeU1vZGVsKG9wdGlvbik7XHJcbiAgICB9IGVsc2UgaWYgKHR5cGUgPT09IDMpIHtcclxuICAgICAgY29uc29sZS5sb2coJ+aJp+ihjOaWueazle+8mkV4cG9ydEN1cnJlbnRDaGlsZERhdGEnKTtcclxuICAgICAgcmV0dXJuIHRoaXMuRXhwb3J0Q3VycmVudENoaWxkRGF0YShydWxlSUQsIG9wdGlvbik7XHJcbiAgICB9IGVsc2UgaWYgKHR5cGUgPT09IDApIHtcclxuICAgICAgY29uc29sZS5sb2coJ+aJp+ihjOaWueazle+8mkV4cG9ydEJ5UnVsZScpO1xyXG4gICAgICByZXR1cm4gdGhpcy5FeHBvcnRCeVJ1bGUocnVsZUlELCBvcHRpb24pO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgY29uc29sZS5sb2coJ+aJp+ihjOaWueazle+8mkV4cG9ydEJ5UnVsZScpO1xyXG4gICAgICByZXR1cm4gdGhpcy5FeHBvcnRCeVJ1bGUocnVsZUlELCBvcHRpb24pO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBQYXJzZUV4cG9ydEpzb24ob3B0aW9uOiBzdHJpbmcpOiBhbnkge1xyXG4gICAgY29uc3Qgdm9JZCA9IHRoaXMuZnJhbWVDb250ZXh0LmFwcENvbnRleHQuZm9ybUlkO1xyXG4gICAgaWYgKGlzTnVsbE9yVW5kZWZpbmVkKG9wdGlvbikgfHwgaXNOdWxsT3JFbXB0eShvcHRpb24pKSB7XHJcbiAgICAgIHJldHVybiB7ZmlsdGVyOiBudWxsLCB2b0lkOiB2b0lkLCBjdXN0b21maWxlbmFtZTogJycsIGFwcGx5dWk6IGZhbHNlLCB2c3RvOiBmYWxzZX07XHJcbiAgICB9XHJcbiAgICBsZXQgb3B0aW9uSnNvbiA9IG51bGw7XHJcbiAgICB0cnkge1xyXG4gICAgICBvcHRpb25Kc29uID0gSlNPTi5wYXJzZShvcHRpb24pO1xyXG4gICAgfSBjYXRjaCB7XHJcbiAgICAgIHRoaXMubm90aWZ5Lndhcm5pbmcoJ+S8oOWFpeeahOWPguaVsOi9rOaNokpTT07lr7nosaHlvILluLjvvIzlt7Lkvb/nlKjpu5jorqTlj4LmlbAnKTtcclxuICAgICAgcmV0dXJuIHtmaWx0ZXI6IG51bGwsIHZvSWQ6IHZvSWQsIGN1c3RvbWZpbGVuYW1lOiAnJywgYXBwbHl1aTogZmFsc2UsIHZzdG86IGZhbHNlfTtcclxuICAgIH1cclxuICAgIGlmICh0eXBlb2YgKG9wdGlvbkpzb24pICE9PSAnb2JqZWN0Jykge1xyXG4gICAgICBvcHRpb25Kc29uID0ge307XHJcbiAgICB9XHJcbiAgICBvcHRpb25Kc29uWyd2b0lkJ10gPSB2b0lkO1xyXG4gICAgcmV0dXJuIG9wdGlvbkpzb247XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIFBhcnNlSW1wb3J0SnNvbihvcHRpb246IHN0cmluZyk6IGFueSB7XHJcbiAgICBjb25zdCB2b0lkID0gdGhpcy5mcmFtZUNvbnRleHQuYXBwQ29udGV4dC5mb3JtSWQ7XHJcbiAgICBpZiAoaXNOdWxsT3JVbmRlZmluZWQob3B0aW9uKSB8fCBpc051bGxPckVtcHR5KG9wdGlvbikpIHtcclxuICAgICAgcmV0dXJuIHt0ZW1wbGF0ZWZpbGVuYW1lOiAnJywgR2xvYmFsUGFyYW06ICcnLCB2b0lkOiB2b0lkfTtcclxuICAgIH1cclxuICAgIGxldCBvcHRpb25Kc29uID0gbnVsbDtcclxuICAgIHRyeSB7XHJcbiAgICAgIG9wdGlvbkpzb24gPSBKU09OLnBhcnNlKG9wdGlvbik7XHJcbiAgICB9IGNhdGNoIHtcclxuICAgICAgdGhpcy5ub3RpZnkud2FybmluZygn5Lyg5YWl55qE5Y+C5pWw6L2s5o2iSlNPTuWvueixoeW8guW4uO+8jOW3suS9v+eUqOm7mOiupOWPguaVsCcpO1xyXG4gICAgICByZXR1cm4ge3RlbXBsYXRlZmlsZW5hbWU6ICcnLCBHbG9iYWxQYXJhbTogJycsIHZvSWQ6IHZvSWR9O1xyXG4gICAgfVxyXG4gICAgaWYgKHR5cGVvZiAob3B0aW9uSnNvbikgIT09ICdvYmplY3QnKSB7XHJcbiAgICAgIG9wdGlvbkpzb24gPSB7fTtcclxuICAgIH1cclxuICAgIGxldCBnbG9iYWxQYXJhbSA9IG9wdGlvbkpzb25bJ2dsb2JhbFBhcmFtJ107XHJcbiAgICBpZiAoZ2xvYmFsUGFyYW0gIT09IHVuZGVmaW5lZCAmJiBnbG9iYWxQYXJhbSAhPT0gbnVsbCkge1xyXG4gICAgICBvcHRpb25Kc29uWydHbG9iYWxQYXJhbSddID0gZ2xvYmFsUGFyYW07XHJcbiAgICB9XHJcbiAgICBvcHRpb25Kc29uWyd2b0lkJ10gPSB2b0lkO1xyXG4gICAgcmV0dXJuIG9wdGlvbkpzb247XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgRXhwb3J0QnlNb2RlbChvcHRpb246IHN0cmluZykge1xyXG4gICAgY29uc3Qgc3ViamVjdCA9IG5ldyBTdWJqZWN0PEJvb2xlYW4+KCk7XHJcbiAgICBjb25zdCBvcHRpb25Kc29uID0gSlNPTi5wYXJzZShvcHRpb24pO1xyXG4gICAgY29uc3QgbW9kZWwgPSBvcHRpb25Kc29uLmRhdGFFeGNoYW5nZU1vZGVsO1xyXG4gICAgY29uc3QgY29tcG9uZW50cyA9IFtdO1xyXG4gICAgaWYgKG9wdGlvbkpzb24uY29tcG9uZW50cyAhPT0gdW5kZWZpbmVkICYmIG9wdGlvbkpzb24uY29tcG9uZW50cyAhPT0gbnVsbCAmJiBvcHRpb25Kc29uLmNvbXBvbmVudHMubGVuZ3RoID4gMCkge1xyXG4gICAgICBvcHRpb25Kc29uLmNvbXBvbmVudHMuZm9yRWFjaChjID0+XHJcbiAgICAgICAgY29tcG9uZW50cy5wdXNoKEpTT04uc3RyaW5naWZ5KGMpKSk7XHJcbiAgICB9XHJcbiAgICBsZXQgaTE4bklkID0gJyc7XHJcbiAgICBpZiAob3B0aW9uSnNvbi5JMThuTWV0YWRhdGFJRCAhPT0gdW5kZWZpbmVkICYmIG9wdGlvbkpzb24uSTE4bk1ldGFkYXRhSUQgIT09IG51bGwpIHtcclxuICAgICAgaTE4bklkID0gb3B0aW9uSnNvbi5JMThuTWV0YWRhdGFJRDtcclxuICAgIH1cclxuICAgIGxldCBmaWx0ZXIgPSBudWxsO1xyXG4gICAgaWYgKG9wdGlvbkpzb24uZmlsdGVyICE9PSB1bmRlZmluZWQgJiYgb3B0aW9uSnNvbi5maWx0ZXIgIT09IG51bGwpIHtcclxuICAgICAgZmlsdGVyID0gb3B0aW9uSnNvbi5maWx0ZXI7XHJcbiAgICB9XHJcbiAgICBjb25zdCBjbXBSZWYgPSB0aGlzLkNyZWF0ZUV4cG9ydENvbXBvbmVudCgpO1xyXG4gICAgY21wUmVmLmluc3RhbmNlLmZyYW1lQ29udGV4dCA9IHRoaXMuZnJhbWVDb250ZXh0O1xyXG4gICAgY21wUmVmLmluc3RhbmNlLm1ldGhvZFR5cGUgPSBNZXRob2RUeXBlLkNvbW1vbkV4cG9ydDtcclxuICAgIGNtcFJlZi5pbnN0YW5jZS5pc0N1c3RvbUV4cG9ydCA9IHRydWU7XHJcbiAgICBjbXBSZWYuaW5zdGFuY2UuTW9kZWwgPSBtb2RlbDtcclxuICAgIGNtcFJlZi5pbnN0YW5jZS5zdWJqZWN0ID0gc3ViamVjdDtcclxuICAgIGNtcFJlZi5pbnN0YW5jZS5jb21wb25lbnRzID0gY29tcG9uZW50cztcclxuICAgIGNtcFJlZi5pbnN0YW5jZS5pMThuSWQgPSBpMThuSWQ7XHJcbiAgICBjbXBSZWYuaW5zdGFuY2UuZmlsdGVyID0gZmlsdGVyO1xyXG4gICAgY21wUmVmLmluc3RhbmNlLmV4cG9ydE9wdGlvbiA9IG9wdGlvbkpzb247XHJcbiAgICBjb25zdCBtb2RlbFN0ciA9IEpTT04uc3RyaW5naWZ5KG1vZGVsKTtcclxuICAgIGNtcFJlZi5pbnN0YW5jZS5Jbm5lck1vZGVsID0gSlNPTi5wYXJzZShtb2RlbFN0cik7XHJcbiAgICBjb25zdCBleHBvcnRNb2RhbENvbmZpZyA9IHRoaXMuR2V0RXhwb3J0RGlhbG9nQ29uZmlnKGNtcFJlZiwgb3B0aW9uSnNvbik7XHJcbiAgICBjb25zdCBrZXlzID0gWydEYXRhRXhwb3J0JywgbW9kZWxbJ01haW5PYmplY3QnXVsnU291cmNlJ11bJ1NvdXJjZU1ldGFkYXRhSUQnXSwgb3B0aW9uSnNvbi5kaW1lbnNpb25dO1xyXG4gICAgdGhpcy5jdXN0b21JRVNlcnZpY2UuR2V0RXhwb3J0UnVsZU1vZGVsKGtleXMsIHRoaXMuZnJhbWVDb250ZXh0LnJlcG9zaXRvcnksIGkxOG5JZCwgbW9kZWwpLnN1YnNjcmliZShcclxuICAgICAgZGF0YSA9PiB7XHJcbiAgICAgICAgaWYgKGRhdGFbJ3N1Y2Nlc3MnXSA9PT0gdHJ1ZSkge1xyXG4gICAgICAgICAgY21wUmVmLmluc3RhbmNlLkN1c3RvbU1vZGVsID0gSlNPTi5wYXJzZShkYXRhWydtb2RlbFN0ciddKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGkxOG5JZCAhPT0gJycgJiYgZGF0YVsnaTE4bk1vZGVsJ10gIT09IHVuZGVmaW5lZCAmJiBkYXRhWydpMThuTW9kZWwnXSAhPT0gbnVsbCkge1xyXG4gICAgICAgICAgY29uc3QgaTE4bk1vZGVsID0gSlNPTi5wYXJzZShkYXRhWydpMThuTW9kZWwnXSk7XHJcbiAgICAgICAgICBjbXBSZWYuaW5zdGFuY2UuTW9kZWwgPSBpMThuTW9kZWw7XHJcbiAgICAgICAgICBjb25zdCBtb2RlbFN0ciA9IEpTT04uc3RyaW5naWZ5KGkxOG5Nb2RlbCk7XHJcbiAgICAgICAgICBjbXBSZWYuaW5zdGFuY2UuSW5uZXJNb2RlbCA9IEpTT04ucGFyc2UobW9kZWxTdHIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCBkaWFsb2cgPSB0aGlzLm1vZGFsU2VydmljZS5zaG93KGNtcFJlZiwgZXhwb3J0TW9kYWxDb25maWcpO1xyXG4gICAgICAgIGNtcFJlZi5pbnN0YW5jZS5uZWVkRGVzdHJveS5zdWJzY3JpYmUoJGV2ZW50ID0+IHtcclxuICAgICAgICAgIGRpYWxvZy5jbG9zZSgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcbiAgICApO1xyXG4gICAgcmV0dXJuIHN1YmplY3Q7XHJcbiAgICAvLyBjb25zdCBkaWFsb2cgPSB0aGlzLm1vZGFsU2VydmljZS5zaG93KGNtcFJlZiwgZXhwb3J0TW9kYWxDb25maWcpO1xyXG4gICAgLy8gY21wUmVmLmluc3RhbmNlLm5lZWREZXN0cm95LnN1YnNjcmliZSgkZXZlbnQgPT4geyBkaWFsb2cuY2xvc2UoKTsgfSk7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgSW1wb3J0QnlNb2RlbChvcHRpb246IHN0cmluZykge1xyXG4gICAgY29uc3Qgb3B0aW9uSnNvbiA9IEpTT04ucGFyc2Uob3B0aW9uKTtcclxuICAgIGNvbnN0IG1vZGVsID0gb3B0aW9uSnNvbi5kYXRhRXhjaGFuZ2VNb2RlbDtcclxuICAgIGNvbnN0IHN1YmplY3QgPSBuZXcgU3ViamVjdDxCb29sZWFuPigpO1xyXG4gICAgY29uc3QgY29tcG9uZW50cyA9IFtdO1xyXG4gICAgaWYgKG9wdGlvbkpzb24uY29tcG9uZW50cyAhPT0gdW5kZWZpbmVkICYmIG9wdGlvbkpzb24uY29tcG9uZW50cyAhPT0gbnVsbCAmJiBvcHRpb25Kc29uLmNvbXBvbmVudHMubGVuZ3RoID4gMCkge1xyXG4gICAgICBvcHRpb25Kc29uLmNvbXBvbmVudHMuZm9yRWFjaChjID0+XHJcbiAgICAgICAgY29tcG9uZW50cy5wdXNoKEpTT04uc3RyaW5naWZ5KGMpKSk7XHJcbiAgICB9XHJcbiAgICBsZXQgaTE4bklkID0gJyc7XHJcbiAgICBpZiAob3B0aW9uSnNvbi5JMThuTWV0YWRhdGFJRCAhPT0gdW5kZWZpbmVkICYmIG9wdGlvbkpzb24uSTE4bk1ldGFkYXRhSUQgIT09IG51bGwpIHtcclxuICAgICAgaTE4bklkID0gb3B0aW9uSnNvbi5JMThuTWV0YWRhdGFJRDtcclxuICAgIH1cclxuICAgIGlmIChvcHRpb25Kc29uLmN1c3RvbUltcG9ydFRpdGxlICE9PSB1bmRlZmluZWQgJiYgb3B0aW9uSnNvbi5jdXN0b21JbXBvcnRUaXRsZSAhPT0gbnVsbCkge1xyXG4gICAgICBpZiAob3B0aW9uSnNvbi5jdXN0b21JbXBvcnRUaXRsZS5sZW5ndGggPiAyMCkge1xyXG4gICAgICAgIHRoaXMubm90aWZ5Lndhcm5pbmcoJ+iHquWumuS5ieagh+mimOWQjeensOeahOmVv+W6puWkqumVvycpO1xyXG4gICAgICAgIHJldHVybiBzdWJqZWN0O1xyXG4gICAgICB9XHJcbiAgICAgIGlmIChEYXRhSUVVdGlscy5KdWRnZUlsbGVnYWxDaGFyKG9wdGlvbkpzb24uY3VzdG9tSW1wb3J0VGl0bGUpKSB7XHJcbiAgICAgICAgdGhpcy5ub3RpZnkud2FybmluZygn6Ieq5a6a5LmJ5qCH6aKY5ZCN56ew5a2Y5Zyo5LiN5ZCI5rOV5a2X56ymJyk7XHJcbiAgICAgICAgcmV0dXJuIHN1YmplY3Q7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIGNvbnN0IGNtcFJlZiA9IHRoaXMuQ3JlYXRlQ3VzdG9tSW1wb3J0Q29tcG9uZW50KCk7XHJcbiAgICBjbXBSZWYuaW5zdGFuY2UuZnJhbWVDb250ZXh0ID0gdGhpcy5mcmFtZUNvbnRleHQ7XHJcbiAgICBjbXBSZWYuaW5zdGFuY2UuaW1wb3J0T3B0aW9uID0gb3B0aW9uSnNvbjtcclxuICAgIC8vIGNtcFJlZi5pbnN0YW5jZS5tZXRob2RUeXBlID0gTWV0aG9kVHlwZS5JbXBvcnRTdWJUYWJsZURldGFpbDtcclxuICAgIGNtcFJlZi5pbnN0YW5jZS5zdWJqZWN0ID0gc3ViamVjdDtcclxuICAgIGNtcFJlZi5pbnN0YW5jZS5pMThuSWQgPSBpMThuSWQ7XHJcbiAgICBjbXBSZWYuaW5zdGFuY2UuTW9kZWwgPSBtb2RlbDtcclxuICAgIGNvbnN0IG1vZGVsU3RyID0gSlNPTi5zdHJpbmdpZnkobW9kZWwpO1xyXG4gICAgY21wUmVmLmluc3RhbmNlLklubmVyTW9kZWwgPSBKU09OLnBhcnNlKG1vZGVsU3RyKTtcclxuICAgIGNtcFJlZi5pbnN0YW5jZS5jb21wb25lbnRzID0gY29tcG9uZW50cztcclxuICAgIGNvbnN0IGltcG9ydE1vZGFsQ29uZmlnID0gdGhpcy5HZXRDdXN0b21JbXBvcnREaWFsb2dDb25maWcoY21wUmVmLCBvcHRpb25Kc29uKTtcclxuICAgIGNvbnN0IGtleXMgPSBbJ0RhdGFJbXBvcnQnLCBtb2RlbFsnTWFpbk9iamVjdCddWydTb3VyY2UnXVsnU291cmNlTWV0YWRhdGFJRCddLCBvcHRpb25Kc29uLmRpbWVuc2lvbl07XHJcbiAgICB0aGlzLmN1c3RvbUlFU2VydmljZS5HZXRJbXBvcnRSdWxlTW9kZWwoa2V5cywgdGhpcy5mcmFtZUNvbnRleHQucmVwb3NpdG9yeSwgaTE4bklkLCBtb2RlbCkuc3Vic2NyaWJlKFxyXG4gICAgICBkYXRhID0+IHtcclxuICAgICAgICBpZiAoZGF0YVsnc3VjY2VzcyddID09PSB0cnVlKSB7XHJcbiAgICAgICAgICBjbXBSZWYuaW5zdGFuY2UuQ3VzdG9tTW9kZWwgPSBKU09OLnBhcnNlKGRhdGFbJ21vZGVsU3RyJ10pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoaTE4bklkICE9PSAnJyAmJiBkYXRhWydpMThuTW9kZWwnXSAhPT0gdW5kZWZpbmVkICYmIGRhdGFbJ2kxOG5Nb2RlbCddICE9PSBudWxsKSB7XHJcbiAgICAgICAgICBjb25zdCBpMThuTW9kZWwgPSBKU09OLnBhcnNlKGRhdGFbJ2kxOG5Nb2RlbCddKTtcclxuICAgICAgICAgIGNtcFJlZi5pbnN0YW5jZS5Nb2RlbCA9IGkxOG5Nb2RlbDtcclxuICAgICAgICAgIGNvbnN0IG1vZGVsU3RyID0gSlNPTi5zdHJpbmdpZnkoaTE4bk1vZGVsKTtcclxuICAgICAgICAgIGNtcFJlZi5pbnN0YW5jZS5Jbm5lck1vZGVsID0gSlNPTi5wYXJzZShtb2RlbFN0cik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IGRpYWxvZyA9IHRoaXMubW9kYWxTZXJ2aWNlLnNob3coY21wUmVmLCBpbXBvcnRNb2RhbENvbmZpZyk7XHJcbiAgICAgICAgY21wUmVmLmluc3RhbmNlLm5lZWREZXN0cm95LnN1YnNjcmliZSgkZXZlbnQgPT4ge1xyXG4gICAgICAgICAgZGlhbG9nLmNsb3NlKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuICAgIClcclxuICAgIHJldHVybiBzdWJqZWN0O1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog5LiL6L295a+85YWl5qih5p2/XHJcbiAgICogQHBhcmFtIHJ1bGVJRFxyXG4gICAqIEBwYXJhbSBvcHRpb25cclxuICAgKi9cclxuICBwdWJsaWMgRG93bmxvYWRUZW1wbGF0ZShydWxlSUQ6IHN0cmluZywgb3B0aW9uOiBzdHJpbmcpOiBPYnNlcnZhYmxlPGFueT4ge1xyXG4gICAgY29uc3Qgc3ViamVjdCA9IG5ldyBTdWJqZWN0PGFueT4oKTtcclxuICAgIHRoaXMuSW1wb3J0Q29tbW9uRW50cnkocnVsZUlELCBvcHRpb24sIE1ldGhvZFR5cGUuRG93bmxvYWRJbXBvcnRUZW1wbGF0ZSkuc3Vic2NyaWJlKHMgPT4ge1xyXG4gICAgICBzdWJqZWN0Lm5leHQocyk7XHJcbiAgICAgIHN1YmplY3QuY29tcGxldGUoKTtcclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIHN1YmplY3Q7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDmoLnmja7op4TliJnlr7zlhaVcclxuICAgKiBAcGFyYW0gcnVsZUlEXHJcbiAgICogQHBhcmFtIG9wdGlvblxyXG4gICAqL1xyXG4gIHB1YmxpYyBJbXBvcnRCeVJ1bGUocnVsZUlEOiBzdHJpbmcsIG9wdGlvbjogc3RyaW5nKTogT2JzZXJ2YWJsZTxhbnk+IHtcclxuICAgIGNvbnN0IHN1YmplY3QgPSBuZXcgU3ViamVjdDxhbnk+KCk7XHJcbiAgICB0aGlzLkltcG9ydENvbW1vbkVudHJ5KHJ1bGVJRCwgb3B0aW9uLCBNZXRob2RUeXBlLkNvbW1vbkltcG9ydCkuc3Vic2NyaWJlKHMgPT4ge1xyXG4gICAgICBzdWJqZWN0Lm5leHQocyk7XHJcbiAgICAgIHN1YmplY3QuY29tcGxldGUoKTtcclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIHN1YmplY3Q7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDlr7zlhaXlrZDooajmlbDmja5cclxuICAgKiBAcGFyYW0gcnVsZUlEXHJcbiAgICogQHBhcmFtIG9wdGlvblxyXG4gICAqL1xyXG4gIHB1YmxpYyBJbXBvcnRTdWJsaXN0RGF0YShydWxlSUQ6IHN0cmluZywgb3B0aW9uOiBzdHJpbmcpOiBPYnNlcnZhYmxlPGFueT4ge1xyXG4gICAgY29uc3Qgc3ViamVjdCA9IG5ldyBTdWJqZWN0PGFueT4oKTtcclxuICAgIHRoaXMuSW1wb3J0Q29tbW9uRW50cnkocnVsZUlELCBvcHRpb24sIE1ldGhvZFR5cGUuSW1wb3J0U3ViVGFibGVEZXRhaWwpLnN1YnNjcmliZShzID0+IHtcclxuICAgICAgc3ViamVjdC5uZXh0KHMpO1xyXG4gICAgICBzdWJqZWN0LmNvbXBsZXRlKCk7XHJcbiAgICB9KTtcclxuICAgIHJldHVybiBzdWJqZWN0O1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBJbXBvcnRDb21tb25FbnRyeShydWxlSUQ6IHN0cmluZywgb3B0aW9uOiBzdHJpbmcsIG1ldGhvZFR5cGU6IE1ldGhvZFR5cGUpIHtcclxuICAgIGNvbnNvbGUubG9nKG9wdGlvbik7XHJcbiAgICBjb25zdCBzdWJqZWN0ID0gbmV3IFN1YmplY3Q8YW55PigpO1xyXG4gICAgY29uc3QgYmVmUmVzdFNlcnZpY2UgPSBEYXRhSUVVdGlscy5HZXRCZWZSZXN0U2VydmljZSh0aGlzLmZyYW1lQ29udGV4dC5yZXBvc2l0b3J5KTtcclxuICAgIGNvbnN0IHN1ID0gRGF0YUlFVXRpbHMuZ2V0U3UoYmVmUmVzdFNlcnZpY2UuYmFzZVVyaSk7XHJcbiAgICBjb25zdCBvcHRpb25Kc29uID0gdGhpcy5QYXJzZUltcG9ydEpzb24ob3B0aW9uKTtcclxuICAgIGlmIChtZXRob2RUeXBlID09PSBNZXRob2RUeXBlLkltcG9ydFN1YlRhYmxlRGV0YWlsKSB7XHJcbiAgICAgIGlmIChpc051bGxPckVtcHR5KHJ1bGVJRCkgJiYgaXNOdWxsT3JFbXB0eShvcHRpb25Kc29uLmltcG9ydENoaWxkTm9kZUNvZGUpKSB7XHJcbiAgICAgICAgLy/lr7zlhaXlrZDooajlvZPop4TliJlpZOS4uuepuuaXtu+8jOagueaNrnZv5om+6KeE5YiZ77yM5b+F6aG76KaB5rGC5pyJ6YWN572u5a2Q6KGo6IqC54K5XHJcbiAgICAgICAgdGhpcy5ub3RpZnkud2FybmluZyhcIuinhOWImWlk5Li656m65pe277yM5qC55o2uVm/mn6Xmib7op4TliJnvvIzlr7zlhaXlrZDooajlv4XpobvphY3nva7lrZDooajoioLngrlcIik7XHJcbiAgICAgICAgcmV0dXJuIHN1YmplY3Q7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIHRoaXMuU3RhcnRMb2FkaW5nKCk7XHJcbiAgICBjb25zdCB1cmwgPSAnL2FwaS9ydW50aW1lL2RpcC92MS4wL2RhdGFJZVJ1bGVNYW5hZ2UvZ2V0UmVjb3JkUnVsZUluZm8nO1xyXG4gICAgY29uc3QgcG9zdEJvZHkgPSB7XHJcbiAgICAgIGJvZHk6IHtcclxuICAgICAgICBydWxlSWQ6IHJ1bGVJRCxcclxuICAgICAgICBzdTogc3UsXHJcbiAgICAgICAgcnVsZVR5cGU6IDAsXHJcbiAgICAgICAgdm9JZDogb3B0aW9uSnNvbi52b0lkLFxyXG4gICAgICAgIG1ldGhvZFR5cGU6IG1ldGhvZFR5cGUsXHJcbiAgICAgICAgaW1wb3J0Q2hpbGROb2RlQ29kZTogb3B0aW9uSnNvbi5pbXBvcnRDaGlsZE5vZGVDb2RlLFxyXG4gICAgICAgIGVuYWJsZVJ1bnRpbWVDdXN0b206IG9wdGlvbkpzb24uZW5hYmxlUnVudGltZUN1c3RvbSA9PT0gdHJ1ZVxyXG4gICAgICB9XHJcbiAgICB9O1xyXG4gICAgbGV0IHN1YnNjcmliZXI6IE9ic2VydmFibGU8YW55PjtcclxuICAgIGlmICghaXNOdWxsT3JVbmRlZmluZWQodGhpcy5odHRwKSkge1xyXG4gICAgICBzdWJzY3JpYmVyID0gdGhpcy5odHRwLnBvc3QodXJsLCBwb3N0Qm9keS5ib2R5KTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHN1YnNjcmliZXIgPSBiZWZSZXN0U2VydmljZS5yZXF1ZXN0KHVybCwgJ3Bvc3QnLCBudWxsLCBwb3N0Qm9keSk7XHJcbiAgICB9XHJcbiAgICBzdWJzY3JpYmVyLnN1YnNjcmliZShyZWNvcmRSdWxlID0+IHtcclxuICAgICAgdGhpcy5DbG9zZUxvYWRpbmcoKTtcclxuICAgICAgdGhpcy5JbXBvcnRCeVJ1bGVJbXBsKHJ1bGVJRCwgb3B0aW9uSnNvbiwgbWV0aG9kVHlwZSwgcmVjb3JkUnVsZSkuc3Vic2NyaWJlKHMgPT4ge1xyXG4gICAgICAgIHN1YmplY3QubmV4dChzKTtcclxuICAgICAgICBzdWJqZWN0LmNvbXBsZXRlKCk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSwgZXJyb3IgPT4ge1xyXG4gICAgICB0aGlzLkNsb3NlTG9hZGluZygpO1xyXG4gICAgICB0aGlzLm5vdGlmeS5lcnJvcihlcnJvci5lcnJvci5NZXNzYWdlKTtcclxuICAgICAgY29uc29sZS5sb2coZXJyb3IuZXJyb3IuTWVzc2FnZSk7XHJcbiAgICB9KTtcclxuICAgIHJldHVybiBzdWJqZWN0O1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBJbXBvcnRCeVJ1bGVJbXBsKHJ1bGVJRDogc3RyaW5nLCBvcHRpb25Kc29uOiBhbnksIG1ldGhvZFR5cGU6IE1ldGhvZFR5cGUsIHJlY29yZFJ1bGU/OiBhbnkpIHtcclxuICAgIGNvbnN0IHN1YmplY3QgPSBuZXcgU3ViamVjdDxCb29sZWFuPigpO1xyXG4gICAgaWYobWV0aG9kVHlwZSA9PT0gTWV0aG9kVHlwZS5Eb3dubG9hZEltcG9ydFRlbXBsYXRlKXtcclxuICAgICAgdGhpcy5sb2FkaW5nU2VydmljZS5zaG93KCk7XHJcbiAgICAgIGNvbnN0IHJ1bGVJZCA9IHJlY29yZFJ1bGUucnVsZUlkID8gcmVjb3JkUnVsZS5ydWxlSWQgOiBydWxlSUQ7XHJcbiAgICAgIHRoaXMuZGF0YUltcG9ydFNlcnZpY2UuRG93bWxvYWRUZW1wbGF0ZShydWxlSWQsIHRoaXMuZnJhbWVDb250ZXh0LnJlcG9zaXRvcnksIG9wdGlvbkpzb24sIG51bGwpO1xyXG4gICAgICB0aGlzLmRhdGFJbXBvcnRTZXJ2aWNlLmNvbXBsZXRlLnN1YnNjcmliZShkYXRhID0+IHtcclxuICAgICAgICB0aGlzLmxvYWRpbmdTZXJ2aWNlLmNsZWFyQWxsKCk7XHJcbiAgICAgICAgaWYgKGRhdGEgPT09ICcnKSB7XHJcbiAgICAgICAgICB0aGlzLm5vdGlmeS5zdWNjZXNzKHRoaXMuaTE4blJlc291cmNlLmRvd25sb2FkX3RlbXBsYXRlX29rKTtcclxuICAgICAgICAgIHN1YmplY3QubmV4dCh0cnVlKTtcclxuICAgICAgICAgIHN1YmplY3QuY29tcGxldGUoKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgdGhpcy5ub3RpZnkuZXJyb3IodGhpcy5pMThuUmVzb3VyY2UuZG93bmxvYWRfdGVtcGxhdGVfZmFpbCArIGRhdGEpO1xyXG4gICAgICAgICAgc3ViamVjdC5uZXh0KGZhbHNlKTtcclxuICAgICAgICAgIHN1YmplY3QuY29tcGxldGUoKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG4gICAgfWVsc2Uge1xyXG4gICAgICBpZiAob3B0aW9uSnNvbi5jdXN0b21JbXBvcnRUaXRsZSAhPT0gdW5kZWZpbmVkICYmIG9wdGlvbkpzb24uY3VzdG9tSW1wb3J0VGl0bGUgIT09IG51bGwpIHtcclxuICAgICAgICBpZiAob3B0aW9uSnNvbi5jdXN0b21JbXBvcnRUaXRsZS5sZW5ndGggPiAyMCkge1xyXG4gICAgICAgICAgdGhpcy5ub3RpZnkud2FybmluZygn6Ieq5a6a5LmJ5qCH6aKY5ZCN56ew55qE6ZW/5bqm5aSq6ZW/Jyk7XHJcbiAgICAgICAgICByZXR1cm4gc3ViamVjdDtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKERhdGFJRVV0aWxzLkp1ZGdlSWxsZWdhbENoYXIob3B0aW9uSnNvbi5jdXN0b21JbXBvcnRUaXRsZSkpIHtcclxuICAgICAgICAgIHRoaXMubm90aWZ5Lndhcm5pbmcoJ+iHquWumuS5ieagh+mimOWQjeensOWtmOWcqOS4jeWQiOazleWtl+espicpO1xyXG4gICAgICAgICAgcmV0dXJuIHN1YmplY3Q7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIGNvbnN0IGNtcFJlZiA9IHRoaXMuQ3JlYXRlSW1wb3J0Q29tcG9uZW50KCk7XHJcbiAgICAgIGNtcFJlZi5pbnN0YW5jZS5ydWxlSWQgPSBydWxlSUQ7XHJcbiAgICAgIGNtcFJlZi5pbnN0YW5jZS5pbXBvcnRPcHRpb24gPSBvcHRpb25Kc29uO1xyXG4gICAgICBjbXBSZWYuaW5zdGFuY2UucmVjb3JkUnVsZSA9IHJlY29yZFJ1bGU7XHJcbiAgICAgIGNtcFJlZi5pbnN0YW5jZS5mcmFtZUNvbnRleHQgPSB0aGlzLmZyYW1lQ29udGV4dDtcclxuICAgICAgY21wUmVmLmluc3RhbmNlLm1ldGhvZFR5cGUgPSBtZXRob2RUeXBlO1xyXG4gICAgICBjbXBSZWYuaW5zdGFuY2Uuc3ViamVjdCA9IHN1YmplY3Q7XHJcbiAgICAgIGNvbnN0IGltcG9ydE1vZGFsQ29uZmlnID0gdGhpcy5HZXRJbXBvcnREaWFsb2dDb25maWcoY21wUmVmLCBvcHRpb25Kc29uKTtcclxuICAgICAgY29uc3QgZGlhbG9nID0gdGhpcy5tb2RhbFNlcnZpY2Uuc2hvdyhjbXBSZWYsIGltcG9ydE1vZGFsQ29uZmlnKTtcclxuICAgICAgY21wUmVmLmluc3RhbmNlLm5lZWREZXN0cm95LnN1YnNjcmliZSgkZXZlbnQgPT4ge1xyXG4gICAgICAgIGRpYWxvZy5jbG9zZSgpO1xyXG4gICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gc3ViamVjdDtcclxuICB9XHJcblxyXG4gIFN0YXJ0TG9hZGluZygpIHtcclxuICAgIGlmICh0aGlzLmxvYWRpbmdTZXJ2aWNlICE9PSB1bmRlZmluZWQgJiYgdGhpcy5sb2FkaW5nU2VydmljZSAhPT0gbnVsbCkge1xyXG4gICAgICB0aGlzLmxvYWRpbmdTZXJ2aWNlLnNob3coKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIENsb3NlTG9hZGluZygpIHtcclxuICAgIGlmICh0aGlzLmxvYWRpbmdTZXJ2aWNlICE9PSB1bmRlZmluZWQgJiYgdGhpcy5sb2FkaW5nU2VydmljZSAhPT0gbnVsbCkge1xyXG4gICAgICB0aGlzLmxvYWRpbmdTZXJ2aWNlLmNsZWFyQWxsKCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIEdldEltcG9ydERpYWxvZ0NvbmZpZyhjbXBSZWYsIG9wdGlvbkpzb24pIHtcclxuICAgIGxldCB0aXRsZSA9IHRoaXMuZGF0YV9pbXBvcnQ7XHJcbiAgICBpZiAob3B0aW9uSnNvbi5jdXN0b21JbXBvcnRUaXRsZSAhPT0gdW5kZWZpbmVkICYmIG9wdGlvbkpzb24uY3VzdG9tSW1wb3J0VGl0bGUgIT09IG51bGwpIHtcclxuICAgICAgdGl0bGUgPSBvcHRpb25Kc29uLmN1c3RvbUltcG9ydFRpdGxlO1xyXG4gICAgfVxyXG4gICAgY29uc3QgaW1wb3J0TW9kYWxDb25maWcgPSB7XHJcbiAgICAgIHRpdGxlOiB0aXRsZSxcclxuICAgICAgd2lkdGg6IDUzMCxcclxuICAgICAgaGVpZ2h0OiAzNDIsXHJcbiAgICAgIGJ1dHRvbnM6IGNtcFJlZi5pbnN0YW5jZS5tb2RhbEZvb3RlcixcclxuICAgICAgc2hvd0Nsb3NlQnV0dG9uOiB0cnVlLFxyXG4gICAgICBzaG93TWF4QnV0dG9uOiBmYWxzZSxcclxuICAgICAgc2hvd01pbkJ1dHRvbjogZmFsc2UsXHJcbiAgICAgIHNob3dCdXR0b25zOiB0cnVlLFxyXG4gICAgICByZXNpemFibGU6IGZhbHNlXHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIGltcG9ydE1vZGFsQ29uZmlnO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBHZXRDdXN0b21JbXBvcnREaWFsb2dDb25maWcoY21wUmVmLCBvcHRpb25Kc29uKSB7XHJcbiAgICBsZXQgdGl0bGUgPSB0aGlzLmRhdGFfaW1wb3J0O1xyXG4gICAgaWYgKG9wdGlvbkpzb24uY3VzdG9tSW1wb3J0VGl0bGUgIT09IHVuZGVmaW5lZCAmJiBvcHRpb25Kc29uLmN1c3RvbUltcG9ydFRpdGxlICE9PSBudWxsKSB7XHJcbiAgICAgIHRpdGxlID0gb3B0aW9uSnNvbi5jdXN0b21JbXBvcnRUaXRsZTtcclxuICAgIH1cclxuICAgIGNvbnN0IGltcG9ydE1vZGFsQ29uZmlnID0ge1xyXG4gICAgICB0aXRsZTogdGl0bGUsXHJcbiAgICAgIHdpZHRoOiA5NTAsXHJcbiAgICAgIGhlaWdodDogNTcwLFxyXG4gICAgICBidXR0b25zOiBjbXBSZWYuaW5zdGFuY2UubW9kYWxGb290ZXIsXHJcbiAgICAgIHNob3dDbG9zZUJ1dHRvbjogdHJ1ZSxcclxuICAgICAgc2hvd01heEJ1dHRvbjogZmFsc2UsXHJcbiAgICAgIHNob3dNaW5CdXR0b246IGZhbHNlLFxyXG4gICAgICBzaG93QnV0dG9uczogdHJ1ZSxcclxuICAgICAgcmVzaXphYmxlOiBmYWxzZVxyXG4gICAgfTtcclxuICAgIHJldHVybiBpbXBvcnRNb2RhbENvbmZpZztcclxuICB9XHJcblxyXG4gIHByaXZhdGUgR2V0RXhwb3J0RGlhbG9nQ29uZmlnKGNtcFJlZiwgb3B0aW9uSnNvbikge1xyXG4gICAgbGV0IHRpdGxlID0gdGhpcy5kYXRhX2V4cG9ydDtcclxuICAgIGlmIChvcHRpb25Kc29uLmN1c3RvbUV4cG9ydFRpdGxlICE9PSB1bmRlZmluZWQgJiYgb3B0aW9uSnNvbi5jdXN0b21FeHBvcnRUaXRsZSAhPT0gbnVsbCkge1xyXG4gICAgICB0aXRsZSA9IG9wdGlvbkpzb24uY3VzdG9tRXhwb3J0VGl0bGU7XHJcbiAgICB9XHJcbiAgICBjb25zdCBleHBvcnRNb2RhbENvbmZpZyA9IHtcclxuICAgICAgdGl0bGU6IHRpdGxlLFxyXG4gICAgICB3aWR0aDogOTIyLFxyXG4gICAgICBoZWlnaHQ6IDUzMCxcclxuICAgICAgYnV0dG9uczogY21wUmVmLmluc3RhbmNlLm1vZGFsRm9vdGVyLFxyXG4gICAgICBzaG93Q2xvc2VCdXR0b246IHRydWUsXHJcbiAgICAgIHNob3dNYXhCdXR0b246IGZhbHNlLFxyXG4gICAgICBzaG93TWluQnV0dG9uOiBmYWxzZSxcclxuICAgICAgc2hvd0J1dHRvbnM6IHRydWUsXHJcbiAgICAgIHJlc2l6YWJsZTogZmFsc2VcclxuICAgIH07XHJcbiAgICByZXR1cm4gZXhwb3J0TW9kYWxDb25maWc7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIEdldFNlbGVjdEV4cG9ydERpYWxvZ0NvbmZpZyhjbXBSZWYsIG9wdGlvbkpzb24pIHtcclxuICAgIGxldCB0aXRsZSA9IHRoaXMuZGF0YV9leHBvcnQ7XHJcbiAgICBpZiAob3B0aW9uSnNvbi5jdXN0b21FeHBvcnRUaXRsZSAhPT0gdW5kZWZpbmVkICYmIG9wdGlvbkpzb24uY3VzdG9tRXhwb3J0VGl0bGUgIT09IG51bGwpIHtcclxuICAgICAgdGl0bGUgPSBvcHRpb25Kc29uLmN1c3RvbUV4cG9ydFRpdGxlO1xyXG4gICAgfVxyXG4gICAgY29uc3QgZXhwb3J0TW9kYWxDb25maWcgPSB7XHJcbiAgICAgIHRpdGxlOiB0aXRsZSxcclxuICAgICAgd2lkdGg6IDUzMCxcclxuICAgICAgaGVpZ2h0OiAzNDIsXHJcbiAgICAgIGJ1dHRvbnM6IGNtcFJlZi5pbnN0YW5jZS5tb2RhbEZvb3RlcixcclxuICAgICAgc2hvd0Nsb3NlQnV0dG9uOiB0cnVlLFxyXG4gICAgICBzaG93TWF4QnV0dG9uOiBmYWxzZSxcclxuICAgICAgc2hvd01pbkJ1dHRvbjogZmFsc2UsXHJcbiAgICAgIHNob3dCdXR0b25zOiB0cnVlLFxyXG4gICAgICByZXNpemFibGU6IGZhbHNlXHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIGV4cG9ydE1vZGFsQ29uZmlnO1xyXG4gIH1cclxuXHJcbiAgLy8g5Yib5bu66L6T5YWl57uE5Lu25a6e5L6LXHJcbiAgcHJpdmF0ZSBDcmVhdGVJbXBvcnRDb21wb25lbnQoKSB7XHJcbiAgICBjb25zdCBjb21wRmFjdG9yeSA9IHRoaXMucmVzb2x2ZXIucmVzb2x2ZUNvbXBvbmVudEZhY3RvcnkoSW1wb3J0RGlhbG9nQ29tcG9uZW50KTtcclxuICAgIGNvbnN0IGNtcFJlZiA9IGNvbXBGYWN0b3J5LmNyZWF0ZSh0aGlzLmluamVjdG9yKTtcclxuICAgIHJldHVybiBjbXBSZWY7XHJcbiAgfVxyXG5cclxuICAvLyDliJvlu7rovpPlh7rnu4Tku7blrp7kvotcclxuICBwcml2YXRlIENyZWF0ZUV4cG9ydENvbXBvbmVudCgpIHtcclxuICAgIGNvbnN0IGNvbXBGYWN0b3J5ID0gdGhpcy5yZXNvbHZlci5yZXNvbHZlQ29tcG9uZW50RmFjdG9yeShFeHBvcnREaWFsb2dDb21wb25lbnQpO1xyXG4gICAgY29uc3QgY21wUmVmID0gY29tcEZhY3RvcnkuY3JlYXRlKHRoaXMuaW5qZWN0b3IpO1xyXG4gICAgcmV0dXJuIGNtcFJlZjtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgQ3JlYXRlU2VsZWN0RXhwb3J0Q29tcG9uZW50KCkge1xyXG4gICAgY29uc3QgY29tcEZhY3RvcnkgPSB0aGlzLnJlc29sdmVyLnJlc29sdmVDb21wb25lbnRGYWN0b3J5KEV4cG9ydEN1c3RvbVNlbGVjdENvbXBvbmVudCk7XHJcbiAgICBjb25zdCBjbXBSZWYgPSBjb21wRmFjdG9yeS5jcmVhdGUodGhpcy5pbmplY3Rvcik7XHJcbiAgICByZXR1cm4gY21wUmVmO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBDcmVhdGVDdXN0b21JbXBvcnRDb21wb25lbnQoKSB7XHJcbiAgICBjb25zdCBjb21wRmFjdG9yeSA9IHRoaXMucmVzb2x2ZXIucmVzb2x2ZUNvbXBvbmVudEZhY3RvcnkoQ3VzdG9tSW1wb3J0RGlhbG9nQ29tcG9uZW50KTtcclxuICAgIGNvbnN0IGNtcFJlZiA9IGNvbXBGYWN0b3J5LmNyZWF0ZSh0aGlzLmluamVjdG9yKTtcclxuICAgIHJldHVybiBjbXBSZWY7XHJcbiAgfVxyXG5cclxuXHJcbn1cclxuIl19