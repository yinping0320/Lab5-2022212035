/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, Input } from '@angular/core';
import { HttpClient } from '@angular/common/http';
import { DataIEUtils } from '../service/Utils/DataIEUtils';
var ElementSelectComponent = /** @class */ (function () {
    function ElementSelectComponent(http) {
        var _this = this;
        this.http = http;
        this.cols = [];
        this.selectedKeys = [];
        this.newSelectedKeys = [];
        // public isNewExpanded = true;
        this.keys = [];
        this.newKeys = [];
        this.Model = null;
        this.CustomModel = null;
        this.InnerModel = null;
        this.TreeData = null;
        this.NewData = null;
        this.isExpanded = (/**
         * @param {?} dataItem
         * @param {?} index
         * @return {?}
         */
        function (dataItem, index) {
            return _this.keys.indexOf(index) > -1;
        });
        this.isNewExpanded = (/**
         * @param {?} dataItem
         * @param {?} index
         * @return {?}
         */
        function (dataItem, index) {
            return _this.newKeys.indexOf(index) > -1;
        });
        DataIEUtils.getTranslateValue(http).subscribe((/**
         * @param {?} res
         * @return {?}
         */
        function (res) {
            _this.data_entity = res['data_entity'];
            _this.selected_item = res['selected_item'];
        }));
    }
    /**
     * @return {?}
     */
    ElementSelectComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        //暂时屏蔽
        // this.checkRightData();
        this.TreeData = this.OrganizeLeftTreeOriginal();
        this.NewData = this.OrganizeRightTreeOriginal();
    };
    /**
     * @return {?}
     */
    ElementSelectComponent.prototype.checkRightData = /**
     * @return {?}
     */
    function () {
        if (this.CustomModel !== null) {
            /** @type {?} */
            var mainObj = this.Model['MainObject'];
            /** @type {?} */
            var elements = mainObj['Elements'];
            /** @type {?} */
            var customMainObj = this.CustomModel['MainObject'];
            /** @type {?} */
            var customElements_1 = customMainObj['Elements'];
            var _loop_1 = function (i) {
                /** @type {?} */
                var ele = customElements_1[i];
                /** @type {?} */
                var idx = elements.findIndex((/**
                 * @param {?} e
                 * @return {?}
                 */
                function (e) { return e['ID'] === ele['ID']; }));
                if (idx < 0) {
                    customElements_1.splice(i, 1);
                    i--;
                }
                out_i_1 = i;
            };
            var out_i_1;
            for (var i = 0; i < customElements_1.length; i++) {
                _loop_1(i);
                i = out_i_1;
            }
        }
    };
    // 组织右侧树，将模型转换为可以展示的Json结构。
    // 组织右侧树，将模型转换为可以展示的Json结构。
    /**
     * @private
     * @return {?}
     */
    ElementSelectComponent.prototype.OrganizeRightTreeOriginal = 
    // 组织右侧树，将模型转换为可以展示的Json结构。
    /**
     * @private
     * @return {?}
     */
    function () {
        /** @type {?} */
        var tree = [];
        if (this.CustomModel !== null) {
            /** @type {?} */
            var mainObj = this.CustomModel['MainObject'];
            tree.push({ id: mainObj['ID'], code: mainObj['Code'], text: mainObj['FileObjectName'], items: this.OrganizeObjJson(mainObj, true) });
        }
        else {
            /** @type {?} */
            var mainObj = this.Model['MainObject'];
            tree.push({ id: mainObj['ID'], code: mainObj['Code'], text: mainObj['FileObjectName'], items: this.OrganizeObjJson(mainObj, false) });
        }
        return tree;
    };
    // 组织左侧树
    // 组织左侧树
    /**
     * @private
     * @return {?}
     */
    ElementSelectComponent.prototype.OrganizeLeftTreeOriginal = 
    // 组织左侧树
    /**
     * @private
     * @return {?}
     */
    function () {
        /** @type {?} */
        var tree = [];
        if (this.CustomModel !== null) {
            /** @type {?} */
            var mainObj = this.Model['MainObject'];
            /** @type {?} */
            var customMainObj = this.CustomModel['MainObject'];
            tree.push({ id: mainObj['ID'], code: mainObj['Code'], text: mainObj['FileObjectName'], items: this.OraganizeMinusObj(mainObj, customMainObj) });
        }
        else {
            /** @type {?} */
            var mainObj = this.Model['MainObject'];
            tree.push({ id: mainObj['ID'], code: mainObj['Code'], text: mainObj['FileObjectName'], items: this.OrganizeObjJson(mainObj, true) });
        }
        return tree;
    };
    // 组织列，customObj：从数据库中获取的对象，obj：外面传入的对象。
    // 组织列，customObj：从数据库中获取的对象，obj：外面传入的对象。
    /**
     * @private
     * @param {?} obj
     * @param {?} customObj
     * @return {?}
     */
    ElementSelectComponent.prototype.OraganizeMinusObj = 
    // 组织列，customObj：从数据库中获取的对象，obj：外面传入的对象。
    /**
     * @private
     * @param {?} obj
     * @param {?} customObj
     * @return {?}
     */
    function (obj, customObj) {
        var _this = this;
        // const items = [];
        // obj['Elements'].forEach(ele => {
        //   const customEle = customObj['Elements'].find(t => t['ID'] === ele['ID']);
        //   if (customEle === null || customEle === undefined) {
        //     if (ele['UdtElements'] !== null && ele['UdtElements'] !== undefined && ele['UdtElements'].length > 0) {
        //       const udtItems = this.OrganizeUdtElements(ele['UdtElements'], customEle['UdtElements']);
        //     } else {
        //       items.push({id: ele['ID'], text: ele['Name'], code: ele['Code'], order: ele['Order']});
        //     }
        //   }
        // });
        /** @type {?} */
        var items = this.OrganizeElementsWithUdtMinus(obj['Elements'], customObj['Elements']);
        if (obj['ChildrenDeo'].length > 0) {
            obj['ChildrenDeo'].forEach((/**
             * @param {?} deo
             * @return {?}
             */
            function (deo) {
                /** @type {?} */
                var customChildDeo = customObj['ChildrenDeo'].find((/**
                 * @param {?} t
                 * @return {?}
                 */
                function (t) { return t['ID'] === deo['ID']; }));
                items.push({ id: deo['ID'], code: deo['Code'], text: deo['FileObjectName'], items: _this.OraganizeMinusObj(deo, customChildDeo) });
            }));
        }
        return items;
    };
    // 获取左右树udt字段的差
    // 获取左右树udt字段的差
    /**
     * @private
     * @param {?} newUdtEles
     * @param {?} udtEles
     * @return {?}
     */
    ElementSelectComponent.prototype.OrganizeElementsWithUdtMinus = 
    // 获取左右树udt字段的差
    /**
     * @private
     * @param {?} newUdtEles
     * @param {?} udtEles
     * @return {?}
     */
    function (newUdtEles, udtEles) {
        var _this = this;
        /** @type {?} */
        var items = [];
        newUdtEles.forEach((/**
         * @param {?} ele
         * @return {?}
         */
        function (ele) {
            /** @type {?} */
            var customEle = udtEles.find((/**
             * @param {?} t
             * @return {?}
             */
            function (t) { return t['ID'] === ele['ID']; }));
            if (customEle === null || customEle === undefined) {
                if (ele['UdtElements'] !== null && ele['UdtElements'] !== undefined && ele['UdtElements'].length > 0) {
                    /** @type {?} */
                    var udtItems = _this.OrganizeElementsWithUdt(ele['UdtElements']);
                    if (udtItems.length > 0) {
                        items.push({ id: ele['ID'], text: ele['FileElementName'], code: ele['Code'], order: ele['Order'], items: udtItems });
                    }
                }
                else {
                    items.push({ id: ele['ID'], text: ele['FileElementName'], code: ele['Code'], order: ele['Order'] });
                }
            }
            else {
                if (ele['UdtElements'] !== null && ele['UdtElements'] !== undefined && ele['UdtElements'].length > 0) {
                    /** @type {?} */
                    var udtItems = _this.OrganizeElementsWithUdtMinus(ele['UdtElements'], customEle['UdtElements']);
                    if (udtItems.length > 0) {
                        items.push({ id: ele['ID'], text: ele['FileElementName'], code: ele['Code'], order: ele['Order'], items: udtItems });
                    }
                }
            }
        }));
        return items;
    };
    // 添加子对象Json串
    // private OrganizeChildObjJson(obj): any[] {
    //   const items = [];
    //   if (obj['ChildrenDeo'].length > 0) {
    //     obj['ChildrenDeo'].forEach(deo => items.push({id: deo['ID'], code: deo['Code'], text: deo['Name'],
    //     items: this.OrganizeChildObjJson(deo)}));
    //   }
    //   return items;
    // }
    // 添加对象Json串
    // 添加子对象Json串
    // private OrganizeChildObjJson(obj): any[] {
    //   const items = [];
    //   if (obj['ChildrenDeo'].length > 0) {
    //     obj['ChildrenDeo'].forEach(deo => items.push({id: deo['ID'], code: deo['Code'], text: deo['Name'],
    //     items: this.OrganizeChildObjJson(deo)}));
    //   }
    //   return items;
    // }
    // 添加对象Json串
    /**
     * @private
     * @param {?} obj
     * @param {?} addEle
     * @return {?}
     */
    ElementSelectComponent.prototype.OrganizeObjJson = 
    // 添加子对象Json串
    // private OrganizeChildObjJson(obj): any[] {
    //   const items = [];
    //   if (obj['ChildrenDeo'].length > 0) {
    //     obj['ChildrenDeo'].forEach(deo => items.push({id: deo['ID'], code: deo['Code'], text: deo['Name'],
    //     items: this.OrganizeChildObjJson(deo)}));
    //   }
    //   return items;
    // }
    // 添加对象Json串
    /**
     * @private
     * @param {?} obj
     * @param {?} addEle
     * @return {?}
     */
    function (obj, addEle) {
        var _this = this;
        /** @type {?} */
        var items = [];
        if (addEle) {
            items = this.OrganizeElementsWithUdt(obj['Elements']);
            // obj['Elements'].forEach(ele => items.push({id: ele['ID'], text: ele['Name'], code: ele['Code'], order: ele['Order']}));
        }
        if (obj['ChildrenDeo'].length > 0) {
            obj['ChildrenDeo'].forEach((/**
             * @param {?} deo
             * @return {?}
             */
            function (deo) { return items.push({
                id: deo['ID'], code: deo['Code'], text: deo['FileObjectName'],
                items: _this.OrganizeObjJson(deo, addEle)
            }); }));
        }
        return items;
    };
    /**
     * @private
     * @param {?} eles
     * @return {?}
     */
    ElementSelectComponent.prototype.OrganizeElementsWithUdt = /**
     * @private
     * @param {?} eles
     * @return {?}
     */
    function (eles) {
        var _this = this;
        /** @type {?} */
        var items = [];
        eles.forEach((/**
         * @param {?} ele
         * @return {?}
         */
        function (ele) {
            if (ele['UdtElements'].length > 0) {
                /** @type {?} */
                var udtItems = _this.OrganizeElementsWithUdt(ele['UdtElements']);
                if (udtItems.length > 0) {
                    items.push({ id: ele['ID'], text: ele['FileElementName'], code: ele['Code'], order: ele['Order'], items: udtItems });
                }
                else {
                    items.push({ id: ele['ID'], text: ele['FileElementName'], code: ele['Code'], order: ele['Order'] });
                }
            }
            else {
                items.push({ id: ele['ID'], text: ele['FileElementName'], code: ele['Code'], order: ele['Order'] });
            }
        }));
        return items;
    };
    // 右移
    // 右移
    /**
     * @return {?}
     */
    ElementSelectComponent.prototype.RightMove = 
    // 右移
    /**
     * @return {?}
     */
    function () {
        if (this.selectedKeys.length === 0) {
            return;
        }
        /** @type {?} */
        var indexes = this.GetIndexes(this.selectedKeys[0]);
        this.MoveData(indexes, this.TreeData, '', this.NewData);
    };
    // 左移
    // 左移
    /**
     * @return {?}
     */
    ElementSelectComponent.prototype.LeftMove = 
    // 左移
    /**
     * @return {?}
     */
    function () {
        if (this.newSelectedKeys.length === 0) {
            return;
        }
        /** @type {?} */
        var indexes = this.GetIndexes(this.newSelectedKeys[0]);
        this.MoveData(indexes, this.NewData, '', this.TreeData);
    };
    /**
     * @private
     * @param {?} sKeys
     * @return {?}
     */
    ElementSelectComponent.prototype.GetIndexes = /**
     * @private
     * @param {?} sKeys
     * @return {?}
     */
    function (sKeys) {
        /** @type {?} */
        var arr = sKeys.split('_');
        /** @type {?} */
        var indexes = [];
        arr.forEach((/**
         * @param {?} element
         * @return {?}
         */
        function (element) {
            indexes.push(Number(element));
        }));
        return arr;
    };
    /**
     * @private
     * @param {?} indexes
     * @param {?} data
     * @param {?} objId
     * @param {?} newData
     * @return {?}
     */
    ElementSelectComponent.prototype.MoveData = /**
     * @private
     * @param {?} indexes
     * @param {?} data
     * @param {?} objId
     * @param {?} newData
     * @return {?}
     */
    function (indexes, data, objId, newData) {
        /** @type {?} */
        var index = indexes.shift();
        if (indexes.length > 0) {
            this.MoveData(indexes, data[index].items, data[index].id, newData);
        }
        else {
            if (data[index].order !== undefined) {
                /** @type {?} */
                var result = this.AddData(objId, newData, data[index]);
                if (!result) {
                    return;
                }
                data.splice(index, 1);
            }
        }
    };
    /**
     * @private
     * @param {?} mainId
     * @param {?} newData
     * @param {?} data
     * @return {?}
     */
    ElementSelectComponent.prototype.AddData = /**
     * @private
     * @param {?} mainId
     * @param {?} newData
     * @param {?} data
     * @return {?}
     */
    function (mainId, newData, data) {
        // 先找到所属对象
        /** @type {?} */
        var obj = this.FindObjAndIndex(mainId, newData, '');
        if (obj === null) {
            return false;
        }
        // 找到要插入的位置
        /** @type {?} */
        var index = this.FindColIndex(obj.dataItem.items, data.order);
        obj.dataItem.items.splice(index, 0, data);
        this.handleNewExpand(obj);
        return true;
    };
    /**
     * @private
     * @param {?} mainId
     * @param {?} data
     * @param {?} parentIndex
     * @return {?}
     */
    ElementSelectComponent.prototype.FindObjAndIndex = /**
     * @private
     * @param {?} mainId
     * @param {?} data
     * @param {?} parentIndex
     * @return {?}
     */
    function (mainId, data, parentIndex) {
        /** @type {?} */
        var result = null;
        // tslint:disable-next-line:prefer-for-of
        for (var i = 0; i < data.length; i++) {
            if (data[i].id === mainId) {
                if (parentIndex !== '') {
                    result = { index: parentIndex + '_' + i.toString(), dataItem: data[i] };
                }
                else {
                    result = { index: i.toString(), dataItem: data[i] };
                }
            }
            else if (data[i].items !== undefined && data[i].items.length > 0) {
                result = this.FindObjAndIndex(mainId, data[i].items, i.toString());
            }
            if (result == null) {
                continue;
            }
            else {
                return result;
            }
        }
        return result;
    };
    /**
     * @private
     * @param {?} items
     * @param {?} order
     * @return {?}
     */
    ElementSelectComponent.prototype.FindColIndex = /**
     * @private
     * @param {?} items
     * @param {?} order
     * @return {?}
     */
    function (items, order) {
        /** @type {?} */
        var index = -1;
        if (items.length === 0) {
            return 0;
        }
        for (var i = 0; i < items.length; i++) {
            if (items[i].order < order) {
                index = i;
            }
            else {
                break;
            }
        }
        return index + 1;
    };
    /**
     * @param {?} node
     * @return {?}
     */
    ElementSelectComponent.prototype.handleCollapse = /**
     * @param {?} node
     * @return {?}
     */
    function (node) {
        this.keys = this.keys.filter((/**
         * @param {?} k
         * @return {?}
         */
        function (k) { return k !== node.index; }));
    };
    /**
     * @param {?} node
     * @return {?}
     */
    ElementSelectComponent.prototype.handleExpand = /**
     * @param {?} node
     * @return {?}
     */
    function (node) {
        console.log(node);
        this.keys = this.keys.concat(node.index);
    };
    /**
     * @param {?} node
     * @return {?}
     */
    ElementSelectComponent.prototype.handleNewCollapse = /**
     * @param {?} node
     * @return {?}
     */
    function (node) {
        this.newKeys = this.newKeys.filter((/**
         * @param {?} k
         * @return {?}
         */
        function (k) { return k !== node.index; }));
    };
    /**
     * @param {?} node
     * @return {?}
     */
    ElementSelectComponent.prototype.handleNewExpand = /**
     * @param {?} node
     * @return {?}
     */
    function (node) {
        console.log(node);
        this.newKeys = this.newKeys.concat(node.index);
    };
    /**
     * @return {?}
     */
    ElementSelectComponent.prototype.RightMoveAll = /**
     * @return {?}
     */
    function () {
        // this.ClearTree(this.TreeData);
        // this.FillTree(this.NewData);
        this.TreeData = [];
        /** @type {?} */
        var mainObj = this.Model['MainObject'];
        this.TreeData.push({ id: mainObj['ID'], code: mainObj['Code'], text: mainObj['FileObjectName'], items: this.OrganizeObjJson(mainObj, false) });
        // this.FillTree(this.TreeData);
        this.NewData = [];
        this.NewData.push({ id: mainObj['ID'], code: mainObj['Code'], text: mainObj['FileObjectName'], items: this.OrganizeObjJson(mainObj, true) });
    };
    /**
     * @param {?} t
     * @return {?}
     */
    ElementSelectComponent.prototype.FillTree = /**
     * @param {?} t
     * @return {?}
     */
    function (t) {
        t = [];
        /** @type {?} */
        var mainObj = this.Model['MainObject'];
        t.push({ id: mainObj['ID'], code: mainObj['Code'], text: mainObj['FileObjectName'], items: this.OrganizeObjJson(mainObj, true) });
    };
    /**
     * @param {?} t
     * @return {?}
     */
    ElementSelectComponent.prototype.ClearTree = /**
     * @param {?} t
     * @return {?}
     */
    function (t) {
        // t = [];
        // const mainObj = this.Model['MainObject'];
        // t.push({id: mainObj['ID'], code: mainObj['Code'], text: mainObj['Name'], items: this.OrganizeObjJson(mainObj, false)});
        t = [];
    };
    /**
     * @return {?}
     */
    ElementSelectComponent.prototype.LeftMoveAll = /**
     * @return {?}
     */
    function () {
        // this.ClearTree(this.NewData);
        this.NewData = [];
        /** @type {?} */
        var mainObj = this.Model['MainObject'];
        this.NewData.push({ id: mainObj['ID'], code: mainObj['Code'], text: mainObj['FileObjectName'], items: this.OrganizeObjJson(mainObj, false) });
        // this.FillTree(this.TreeData);
        this.TreeData = [];
        this.TreeData.push({ id: mainObj['ID'], code: mainObj['Code'], text: mainObj['FileObjectName'], items: this.OrganizeObjJson(mainObj, true) });
    };
    /**
     * @return {?}
     */
    ElementSelectComponent.prototype.MoveUp = /**
     * @return {?}
     */
    function () {
        if (this.newSelectedKeys.length === 0) {
            return;
        }
        /** @type {?} */
        var indexes = this.GetIndexes(this.newSelectedKeys[0]);
        /** @type {?} */
        var lastIndex = indexes.pop();
        /** @type {?} */
        var items = this.GetItems(indexes, this.NewData);
        if (items[lastIndex].order === undefined || items[lastIndex].order === 0) {
            return;
        }
        /** @type {?} */
        var temp = items[lastIndex].order;
        items[lastIndex].order = items[lastIndex - 1].order;
        items[lastIndex - 1].order = temp;
        items.splice(lastIndex - 1, 0, items[lastIndex]);
        items.splice(Number(lastIndex) + 1, 1);
        /** @type {?} */
        var parentIndex = this.newSelectedKeys[0];
        this.newSelectedKeys[0] = parentIndex.substring(0, parentIndex.lastIndexOf('_') + 1) + (lastIndex - 1);
    };
    /**
     * @private
     * @param {?} indexes
     * @param {?} data
     * @return {?}
     */
    ElementSelectComponent.prototype.GetItems = /**
     * @private
     * @param {?} indexes
     * @param {?} data
     * @return {?}
     */
    function (indexes, data) {
        if (indexes.length === 0) {
            return data;
        }
        /** @type {?} */
        var index = indexes.shift();
        return this.GetItems(indexes, data[index].items);
    };
    /**
     * @return {?}
     */
    ElementSelectComponent.prototype.MoveDown = /**
     * @return {?}
     */
    function () {
        if (this.newSelectedKeys.length === 0) {
            return;
        }
        /** @type {?} */
        var indexes = this.GetIndexes(this.newSelectedKeys[0]);
        /** @type {?} */
        var lastIndex = indexes.pop();
        /** @type {?} */
        var items = this.GetItems(indexes, this.NewData);
        if (items.length === lastIndex || items[Number(lastIndex) + 1] === undefined || items[Number(lastIndex) + 1].order === undefined
            || items[lastIndex].order === undefined) {
            return;
        }
        /** @type {?} */
        var temp = items[lastIndex].order;
        items[lastIndex].order = items[Number(lastIndex) + 1].order;
        items[Number(lastIndex) + 1].order = temp;
        items.splice(Number(lastIndex) + 2, 0, items[lastIndex]);
        items.splice(lastIndex, 1);
        /** @type {?} */
        var parentIndex = this.newSelectedKeys[0];
        this.newSelectedKeys[0] = parentIndex.substring(0, parentIndex.lastIndexOf('_') + 1) + (Number(lastIndex) + 1);
    };
    /**
     * @return {?}
     */
    ElementSelectComponent.prototype.Save = /**
     * @return {?}
     */
    function () {
        // 传入的模型的主对象
        if (this.InnerModel == null) {
            this.InnerModel = this.Model;
        }
        /** @type {?} */
        var mainObj = this.InnerModel['MainObject'];
        /** @type {?} */
        var newMainObj = this.NewData[0];
        /** @type {?} */
        var preMainObj = this.Model['MainObject'];
        mainObj['Elements'] = this.OrganizeElements(preMainObj['Elements'], newMainObj);
        this.OrganizeChildrenDeo(mainObj, newMainObj, preMainObj);
    };
    /**
     * @private
     * @param {?} obj
     * @param {?} newObj
     * @param {?} preMainObj
     * @return {?}
     */
    ElementSelectComponent.prototype.OrganizeChildrenDeo = /**
     * @private
     * @param {?} obj
     * @param {?} newObj
     * @param {?} preMainObj
     * @return {?}
     */
    function (obj, newObj, preMainObj) {
        var _this = this;
        if (obj['ChildrenDeo'] !== undefined && obj['ChildrenDeo'].length > 0) {
            /** @type {?} */
            var newChildrenDeo_1 = [];
            obj['ChildrenDeo'].forEach((/**
             * @param {?} t
             * @return {?}
             */
            function (t) {
                /** @type {?} */
                var childDeo = newObj['items'].find((/**
                 * @param {?} item
                 * @return {?}
                 */
                function (item) { return item['id'] === t['ID']; }));
                /** @type {?} */
                var preChildObj = preMainObj['ChildrenDeo'].find((/**
                 * @param {?} item
                 * @return {?}
                 */
                function (item) { return item['ID'] === t['ID']; }));
                if (childDeo !== null && childDeo !== undefined) {
                    t['Elements'] = _this.OrganizeElements(preChildObj['Elements'], childDeo);
                    if (t['Elements'] !== undefined && t['Elements'] !== null) {
                        newChildrenDeo_1.push(t);
                    }
                }
                _this.OrganizeChildrenDeo(t, childDeo, preChildObj);
            }));
            obj['ChildrenDeo'] = newChildrenDeo_1;
        }
    };
    // 保存时组织列, obj: 外部传入的列，newObj: 编辑后新的列
    // 保存时组织列, obj: 外部传入的列，newObj: 编辑后新的列
    /**
     * @private
     * @param {?} obj
     * @param {?} newObj
     * @return {?}
     */
    ElementSelectComponent.prototype.OrganizeElements = 
    // 保存时组织列, obj: 外部传入的列，newObj: 编辑后新的列
    /**
     * @private
     * @param {?} obj
     * @param {?} newObj
     * @return {?}
     */
    function (obj, newObj) {
        /** @type {?} */
        var newEles = newObj['items'];
        /** @type {?} */
        var eles = [];
        newEles.forEach((/**
         * @param {?} t
         * @return {?}
         */
        function (t) {
            /** @type {?} */
            var ele = obj.find((/**
             * @param {?} e
             * @return {?}
             */
            function (e) { return e['ID'] === t['id']; }));
            if (ele !== undefined && ele !== null) {
                eles.push(ele);
            }
        }));
        return eles;
    };
    ElementSelectComponent.decorators = [
        { type: Component, args: [{
                    selector: 'app-element-select',
                    template: "<div *ngIf=\"Model\" class=\"row inner\">\r\n  <div class=\"col-lg-5 col-md-5\">\r\n    <div>\r\n      <div>\r\n        {{data_entity}}\r\n      </div>\r\n      \r\n      <div class=\"hasborder\" style=\"height:330px;overflow-y:auto\">\r\n        <kendo-treeview\r\n          [nodes]=\"TreeData\"\r\n          textField=\"text\"\r\n          kendoTreeViewExpandable\r\n          kendoTreeViewSelectable\r\n          kendoTreeViewHierarchyBinding\r\n          childrenField=\"items\"\r\n          [(selectedKeys)]=\"selectedKeys\"\r\n          [isExpanded]=\"isExpanded\"\r\n          (collapse)=\"handleCollapse($event)\"\r\n          (expand)=\"handleExpand($event)\"\r\n        >\r\n        \r\n        </kendo-treeview>\r\n      </div>\r\n    </div>\r\n  </div>\r\n  \r\n  <div class=\"col-lg-2 col-md-2 btn-group-vertical\" role=\"group\" aria-label=\"...\">\r\n    <button type=\"button\" class=\"btn btn-outline-secondary\" (click)=\"RightMove()\">></button>\r\n    <button type=\"button\" class=\"btn btn-outline-secondary\" (click)=\"LeftMove()\"><</button>\r\n    <button type=\"button\" class=\"btn btn-outline-secondary\" (click)=\"RightMoveAll()\">>></button>\r\n    <button type=\"button\" class=\"btn btn-outline-secondary\" (click)=\"LeftMoveAll()\"><<</button>\r\n    <button type=\"button\" class=\"btn btn-outline-secondary\" (click)=\"MoveUp()\">^</button>\r\n    <button type=\"button\" class=\"btn btn-outline-secondary\" (click)=\"MoveDown()\">v</button>\r\n  </div>\r\n  <div class=\"col-lg-5 col-md-5\">\r\n    <div>\r\n      <div>\r\n        {{selected_item}}\r\n      </div>\r\n      <div class=\"hasborder\" style=\"height:330px;overflow-y:auto\">\r\n        <kendo-treeview\r\n          [nodes]=\"NewData\"\r\n          textField=\"text\"\r\n          kendoTreeViewExpandable\r\n          kendoTreeViewSelectable\r\n          kendoTreeViewHierarchyBinding\r\n          childrenField=\"items\"\r\n          [(selectedKeys)]=\"newSelectedKeys\"\r\n          [isExpanded]=\"isNewExpanded\"\r\n          (collapse)=\"handleNewCollapse($event)\"\r\n          (expand)=\"handleNewExpand($event)\"\r\n        >\r\n          <ng-template kendoTreeViewNodeTemplate let-dataItem>\r\n            {{dataItem.text}}\r\n            <span></span>\r\n          </ng-template>\r\n        </kendo-treeview>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n<!-- <div *ngIf=\"Model\" class=\"row inner\">\r\n\r\n  <multi-select [dataSource]=\"leftTreeData\" [idField]=\"'name'\" [valueField]=\"'type'\" [textField]=\"'name'\" [displayType]=\"'Tree'\"\r\n    [(selectedId)]=\"treeSelectedId\">\r\n    <ng-template farrisTemplate=\"text\" let-data>\r\n      {{ data['name'] }} [ {{ data['type'] }}]\r\n    </ng-template>\r\n  </multi-select>\r\n</div> -->",
                    providers: [],
                    styles: ["kendo-grid-column{line-height:30px}.inner{margin:5px}.btn{width:80px;margin-bottom:5px}.hasborder{border:.5px solid #a9a9a9;height:330px}"]
                }] }
    ];
    /** @nocollapse */
    ElementSelectComponent.ctorParameters = function () { return [
        { type: HttpClient }
    ]; };
    ElementSelectComponent.propDecorators = {
        Model: [{ type: Input }],
        CustomModel: [{ type: Input }],
        InnerModel: [{ type: Input }]
    };
    return ElementSelectComponent;
}());
export { ElementSelectComponent };
if (false) {
    /** @type {?} */
    ElementSelectComponent.prototype.cols;
    /** @type {?} */
    ElementSelectComponent.prototype.selectedKeys;
    /** @type {?} */
    ElementSelectComponent.prototype.newSelectedKeys;
    /** @type {?} */
    ElementSelectComponent.prototype.keys;
    /** @type {?} */
    ElementSelectComponent.prototype.newKeys;
    /** @type {?} */
    ElementSelectComponent.prototype.Model;
    /** @type {?} */
    ElementSelectComponent.prototype.CustomModel;
    /** @type {?} */
    ElementSelectComponent.prototype.InnerModel;
    /** @type {?} */
    ElementSelectComponent.prototype.TreeData;
    /** @type {?} */
    ElementSelectComponent.prototype.NewData;
    /** @type {?} */
    ElementSelectComponent.prototype.data_entity;
    /** @type {?} */
    ElementSelectComponent.prototype.selected_item;
    /** @type {?} */
    ElementSelectComponent.prototype.isExpanded;
    /** @type {?} */
    ElementSelectComponent.prototype.isNewExpanded;
    /**
     * @type {?}
     * @private
     */
    ElementSelectComponent.prototype.http;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZWxlbWVudC1zZWxlY3QuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGdzcC1kaXAvZGF0YS1pbXAtZXhwLyIsInNvdXJjZXMiOlsibGliL2VsZW1lbnQtc2VsZWN0L2VsZW1lbnQtc2VsZWN0LmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7O0FBQUEsT0FBTyxFQUFFLFNBQVMsRUFBRSxLQUFLLEVBQVUsTUFBTSxlQUFlLENBQUM7QUFDekQsT0FBTyxFQUFFLFVBQVUsRUFBRSxNQUFNLHNCQUFzQixDQUFDO0FBQ2xELE9BQU8sRUFBRSxXQUFXLEVBQUUsTUFBTSw4QkFBOEIsQ0FBQztBQUUzRDtJQXlCRSxnQ0FDVSxJQUFnQjtRQUQxQixpQkFPQztRQU5TLFNBQUksR0FBSixJQUFJLENBQVk7UUFsQjFCLFNBQUksR0FBRyxFQUFFLENBQUM7UUFDSCxpQkFBWSxHQUFVLEVBQUUsQ0FBQztRQUN6QixvQkFBZSxHQUFVLEVBQUUsQ0FBQzs7UUFFNUIsU0FBSSxHQUFhLEVBQUUsQ0FBQztRQUNwQixZQUFPLEdBQWEsRUFBRSxDQUFDO1FBRXZCLFVBQUssR0FBUSxJQUFJLENBQUM7UUFFbEIsZ0JBQVcsR0FBUSxJQUFJLENBQUM7UUFFeEIsZUFBVSxHQUFRLElBQUksQ0FBQztRQUN2QixhQUFRLEdBQVUsSUFBSSxDQUFDO1FBQ3ZCLFlBQU8sR0FBVSxJQUFJLENBQUM7UUFtSnRCLGVBQVU7Ozs7O1FBQUcsVUFBQyxRQUFhLEVBQUUsS0FBYTtZQUMvQyxPQUFPLEtBQUksQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDO1FBQ3ZDLENBQUMsRUFBQTtRQUNNLGtCQUFhOzs7OztRQUFHLFVBQUMsUUFBYSxFQUFFLEtBQWE7WUFDbEQsT0FBTyxLQUFJLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQztRQUMxQyxDQUFDLEVBQUE7UUFq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LENBQUM7O2dCQUNULEdBQUcsR0FBRyxHQUFHLENBQUMsSUFBSTs7OztZQUFDLFVBQUEsQ0FBQyxJQUFJLE9BQUEsQ0FBQyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQyxJQUFJLENBQUMsRUFBbkIsQ0FBbUIsRUFBQztZQUM5QyxJQUFJLEdBQUcsS0FBSyxTQUFTLElBQUksR0FBRyxLQUFLLElBQUksRUFBRTtnQkFDckMsSUFBSSxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQzthQUNoQjtRQUNILENBQUMsRUFBQyxDQUFDO1FBQ0gsT0FBTyxJQUFJLENBQUM7SUFDZCxDQUFDOztnQkFyWUYsU0FBUyxTQUFDO29CQUNULFFBQVEsRUFBRSxvQkFBb0I7b0JBQzlCLCt0RkFBOEM7b0JBRTlDLFNBQVMsRUFBRSxFQUFFOztpQkFDZDs7OztnQkFSUSxVQUFVOzs7d0JBaUJoQixLQUFLOzhCQUVMLEtBQUs7NkJBRUwsS0FBSzs7SUEyWFIsNkJBQUM7Q0FBQSxBQTdZRCxJQTZZQztTQXZZWSxzQkFBc0I7OztJQUVqQyxzQ0FBVTs7SUFDViw4Q0FBZ0M7O0lBQ2hDLGlEQUFtQzs7SUFFbkMsc0NBQTJCOztJQUMzQix5Q0FBOEI7O0lBQzlCLHVDQUN5Qjs7SUFDekIsNkNBQytCOztJQUMvQiw0Q0FDOEI7O0lBQzlCLDBDQUE4Qjs7SUFDOUIseUNBQTZCOztJQUU3Qiw2Q0FBb0I7O0lBQ3BCLCtDQUFzQjs7SUFnSnRCLDRDQUVDOztJQUNELCtDQUVDOzs7OztJQW5KQyxzQ0FBd0IiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb21wb25lbnQsIElucHV0LCBPbkluaXQgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgSHR0cENsaWVudCB9IGZyb20gJ0Bhbmd1bGFyL2NvbW1vbi9odHRwJztcclxuaW1wb3J0IHsgRGF0YUlFVXRpbHMgfSBmcm9tICcuLi9zZXJ2aWNlL1V0aWxzL0RhdGFJRVV0aWxzJztcclxuXHJcbkBDb21wb25lbnQoe1xyXG4gIHNlbGVjdG9yOiAnYXBwLWVsZW1lbnQtc2VsZWN0JyxcclxuICB0ZW1wbGF0ZVVybDogJy4vZWxlbWVudC1zZWxlY3QuY29tcG9uZW50Lmh0bWwnLFxyXG4gIHN0eWxlVXJsczogWycuL2VsZW1lbnQtc2VsZWN0LmNvbXBvbmVudC5jc3MnXSxcclxuICBwcm92aWRlcnM6IFtdXHJcbn0pXHJcbmV4cG9ydCBjbGFzcyBFbGVtZW50U2VsZWN0Q29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0IHtcclxuXHJcbiAgY29scyA9IFtdO1xyXG4gIHB1YmxpYyBzZWxlY3RlZEtleXM6IGFueVtdID0gW107XHJcbiAgcHVibGljIG5ld1NlbGVjdGVkS2V5czogYW55W10gPSBbXTtcclxuICAvLyBwdWJsaWMgaXNOZXdFeHBhbmRlZCA9IHRydWU7XHJcbiAgcHVibGljIGtleXM6IHN0cmluZ1tdID0gW107XHJcbiAgcHVibGljIG5ld0tleXM6IHN0cmluZ1tdID0gW107XHJcbiAgQElucHV0KClcclxuICBwdWJsaWMgTW9kZWw6IGFueSA9IG51bGw7XHJcbiAgQElucHV0KClcclxuICBwdWJsaWMgQ3VzdG9tTW9kZWw6IGFueSA9IG51bGw7XHJcbiAgQElucHV0KClcclxuICBwdWJsaWMgSW5uZXJNb2RlbDogYW55ID0gbnVsbDtcclxuICBwdWJsaWMgVHJlZURhdGE6IGFueVtdID0gbnVsbDtcclxuICBwdWJsaWMgTmV3RGF0YTogYW55W10gPSBudWxsO1xyXG5cclxuICBkYXRhX2VudGl0eTogc3RyaW5nO1xyXG4gIHNlbGVjdGVkX2l0ZW06IHN0cmluZztcclxuICBjb25zdHJ1Y3RvcihcclxuICAgIHByaXZhdGUgaHR0cDogSHR0cENsaWVudFxyXG4gICkge1xyXG4gICAgRGF0YUlFVXRpbHMuZ2V0VHJhbnNsYXRlVmFsdWUoaHR0cCkuc3Vic2NyaWJlKHJlcyA9PiB7XHJcbiAgICAgIHRoaXMuZGF0YV9lbnRpdHkgPSByZXNbJ2RhdGFfZW50aXR5J107XHJcbiAgICAgIHRoaXMuc2VsZWN0ZWRfaXRlbSA9IHJlc1snc2VsZWN0ZWRfaXRlbSddO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBuZ09uSW5pdCgpIHtcclxuICAgIC8v5pqC5pe25bGP6JS9XHJcbiAgICAvLyB0aGlzLmNoZWNrUmlnaHREYXRhKCk7XHJcbiAgICB0aGlzLlRyZWVEYXRhID0gdGhpcy5Pcmdhbml6ZUxlZnRUcmVlT3JpZ2luYWwoKTtcclxuICAgIHRoaXMuTmV3RGF0YSA9IHRoaXMuT3JnYW5pemVSaWdodFRyZWVPcmlnaW5hbCgpO1xyXG4gIH1cclxuICBjaGVja1JpZ2h0RGF0YSgpIHtcclxuICAgIGlmICh0aGlzLkN1c3RvbU1vZGVsICE9PSBudWxsKSB7XHJcbiAgICAgIGNvbnN0IG1haW5PYmogPSB0aGlzLk1vZGVsWydNYWluT2JqZWN0J107XHJcbiAgICAgIGNvbnN0IGVsZW1lbnRzOiBBcnJheTxzdHJpbmc+ID0gbWFpbk9ialsnRWxlbWVudHMnXTtcclxuICAgICAgY29uc3QgY3VzdG9tTWFpbk9iaiA9IHRoaXMuQ3VzdG9tTW9kZWxbJ01haW5PYmplY3QnXTtcclxuICAgICAgY29uc3QgY3VzdG9tRWxlbWVudHMgPSBjdXN0b21NYWluT2JqWydFbGVtZW50cyddO1xyXG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGN1c3RvbUVsZW1lbnRzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgY29uc3QgZWxlID0gY3VzdG9tRWxlbWVudHNbaV07XHJcbiAgICAgICAgY29uc3QgaWR4ID0gZWxlbWVudHMuZmluZEluZGV4KGUgPT4gZVsnSUQnXSA9PT0gZWxlWydJRCddKTtcclxuICAgICAgICBpZiAoaWR4IDwgMCkge1xyXG4gICAgICAgICAgY3VzdG9tRWxlbWVudHMuc3BsaWNlKGksIDEpO1xyXG4gICAgICAgICAgaS0tO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuICAvLyDnu4Tnu4flj7PkvqfmoJHvvIzlsIbmqKHlnovovazmjaLkuLrlj6/ku6XlsZXnpLrnmoRKc29u57uT5p6E44CCXHJcbiAgcHJpdmF0ZSBPcmdhbml6ZVJpZ2h0VHJlZU9yaWdpbmFsKCk6IGFueVtdIHtcclxuICAgIGNvbnN0IHRyZWUgPSBbXTtcclxuICAgIGlmICh0aGlzLkN1c3RvbU1vZGVsICE9PSBudWxsKSB7XHJcbiAgICAgIGNvbnN0IG1haW5PYmogPSB0aGlzLkN1c3RvbU1vZGVsWydNYWluT2JqZWN0J107XHJcbiAgICAgIHRyZWUucHVzaCh7IGlkOiBtYWluT2JqWydJRCddLCBjb2RlOiBtYWluT2JqWydDb2RlJ10sIHRleHQ6IG1haW5PYmpbJ0ZpbGVPYmplY3ROYW1lJ10sIGl0ZW1zOiB0aGlzLk9yZ2FuaXplT2JqSnNvbihtYWluT2JqLCB0cnVlKSB9KTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGNvbnN0IG1haW5PYmogPSB0aGlzLk1vZGVsWydNYWluT2JqZWN0J107XHJcbiAgICAgIHRyZWUucHVzaCh7IGlkOiBtYWluT2JqWydJRCddLCBjb2RlOiBtYWluT2JqWydDb2RlJ10sIHRleHQ6IG1haW5PYmpbJ0ZpbGVPYmplY3ROYW1lJ10sIGl0ZW1zOiB0aGlzLk9yZ2FuaXplT2JqSnNvbihtYWluT2JqLCBmYWxzZSkgfSk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gdHJlZTtcclxuICB9XHJcbiAgLy8g57uE57uH5bem5L6n5qCRXHJcbiAgcHJpdmF0ZSBPcmdhbml6ZUxlZnRUcmVlT3JpZ2luYWwoKTogYW55W10ge1xyXG4gICAgY29uc3QgdHJlZSA9IFtdO1xyXG4gICAgaWYgKHRoaXMuQ3VzdG9tTW9kZWwgIT09IG51bGwpIHtcclxuICAgICAgY29uc3QgbWFpbk9iaiA9IHRoaXMuTW9kZWxbJ01haW5PYmplY3QnXTtcclxuICAgICAgY29uc3QgY3VzdG9tTWFpbk9iaiA9IHRoaXMuQ3VzdG9tTW9kZWxbJ01haW5PYmplY3QnXTtcclxuICAgICAgdHJlZS5wdXNoKHsgaWQ6IG1haW5PYmpbJ0lEJ10sIGNvZGU6IG1haW5PYmpbJ0NvZGUnXSwgdGV4dDogbWFpbk9ialsnRmlsZU9iamVjdE5hbWUnXSwgaXRlbXM6IHRoaXMuT3JhZ2FuaXplTWludXNPYmoobWFpbk9iaiwgY3VzdG9tTWFpbk9iaikgfSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBjb25zdCBtYWluT2JqID0gdGhpcy5Nb2RlbFsnTWFpbk9iamVjdCddO1xyXG4gICAgICB0cmVlLnB1c2goeyBpZDogbWFpbk9ialsnSUQnXSwgY29kZTogbWFpbk9ialsnQ29kZSddLCB0ZXh0OiBtYWluT2JqWydGaWxlT2JqZWN0TmFtZSddLCBpdGVtczogdGhpcy5Pcmdhbml6ZU9iakpzb24obWFpbk9iaiwgdHJ1ZSkgfSk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gdHJlZTtcclxuICB9XHJcbiAgLy8g57uE57uH5YiX77yMY3VzdG9tT2Jq77ya5LuO5pWw5o2u5bqT5Lit6I635Y+W55qE5a+56LGh77yMb2Jq77ya5aSW6Z2i5Lyg5YWl55qE5a+56LGh44CCXHJcbiAgcHJpdmF0ZSBPcmFnYW5pemVNaW51c09iaihvYmo6IGFueSwgY3VzdG9tT2JqOiBhbnkpIHtcclxuICAgIC8vIGNvbnN0IGl0ZW1zID0gW107XHJcbiAgICAvLyBvYmpbJ0VsZW1lbnRzJ10uZm9yRWFjaChlbGUgPT4ge1xyXG4gICAgLy8gICBjb25zdCBjdXN0b21FbGUgPSBjdXN0b21PYmpbJ0VsZW1lbnRzJ10uZmluZCh0ID0+IHRbJ0lEJ10gPT09IGVsZVsnSUQnXSk7XHJcbiAgICAvLyAgIGlmIChjdXN0b21FbGUgPT09IG51bGwgfHwgY3VzdG9tRWxlID09PSB1bmRlZmluZWQpIHtcclxuICAgIC8vICAgICBpZiAoZWxlWydVZHRFbGVtZW50cyddICE9PSBudWxsICYmIGVsZVsnVWR0RWxlbWVudHMnXSAhPT0gdW5kZWZpbmVkICYmIGVsZVsnVWR0RWxlbWVudHMnXS5sZW5ndGggPiAwKSB7XHJcbiAgICAvLyAgICAgICBjb25zdCB1ZHRJdGVtcyA9IHRoaXMuT3JnYW5pemVVZHRFbGVtZW50cyhlbGVbJ1VkdEVsZW1lbnRzJ10sIGN1c3RvbUVsZVsnVWR0RWxlbWVudHMnXSk7XHJcbiAgICAvLyAgICAgfSBlbHNlIHtcclxuICAgIC8vICAgICAgIGl0ZW1zLnB1c2goe2lkOiBlbGVbJ0lEJ10sIHRleHQ6IGVsZVsnTmFtZSddLCBjb2RlOiBlbGVbJ0NvZGUnXSwgb3JkZXI6IGVsZVsnT3JkZXInXX0pO1xyXG4gICAgLy8gICAgIH1cclxuICAgIC8vICAgfVxyXG4gICAgLy8gfSk7XHJcbiAgICBjb25zdCBpdGVtcyA9IHRoaXMuT3JnYW5pemVFbGVtZW50c1dpdGhVZHRNaW51cyhvYmpbJ0VsZW1lbnRzJ10sIGN1c3RvbU9ialsnRWxlbWVudHMnXSk7XHJcbiAgICBpZiAob2JqWydDaGlsZHJlbkRlbyddLmxlbmd0aCA+IDApIHtcclxuICAgICAgb2JqWydDaGlsZHJlbkRlbyddLmZvckVhY2goZGVvID0+IHtcclxuICAgICAgICBjb25zdCBjdXN0b21DaGlsZERlbyA9IGN1c3RvbU9ialsnQ2hpbGRyZW5EZW8nXS5maW5kKHQgPT4gdFsnSUQnXSA9PT0gZGVvWydJRCddKTtcclxuICAgICAgICBpdGVtcy5wdXNoKHsgaWQ6IGRlb1snSUQnXSwgY29kZTogZGVvWydDb2RlJ10sIHRleHQ6IGRlb1snRmlsZU9iamVjdE5hbWUnXSwgaXRlbXM6IHRoaXMuT3JhZ2FuaXplTWludXNPYmooZGVvLCBjdXN0b21DaGlsZERlbykgfSk7XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGl0ZW1zO1xyXG4gIH1cclxuICAvLyDojrflj5blt6blj7PmoJF1ZHTlrZfmrrXnmoTlt65cclxuICBwcml2YXRlIE9yZ2FuaXplRWxlbWVudHNXaXRoVWR0TWludXMobmV3VWR0RWxlczogYW55W10sIHVkdEVsZXM6IGFueVtdKTogYW55W10ge1xyXG4gICAgY29uc3QgaXRlbXMgPSBbXTtcclxuICAgIG5ld1VkdEVsZXMuZm9yRWFjaChlbGUgPT4ge1xyXG4gICAgICBjb25zdCBjdXN0b21FbGUgPSB1ZHRFbGVzLmZpbmQodCA9PiB0WydJRCddID09PSBlbGVbJ0lEJ10pO1xyXG4gICAgICBpZiAoY3VzdG9tRWxlID09PSBudWxsIHx8IGN1c3RvbUVsZSA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgaWYgKGVsZVsnVWR0RWxlbWVudHMnXSAhPT0gbnVsbCAmJiBlbGVbJ1VkdEVsZW1lbnRzJ10gIT09IHVuZGVmaW5lZCAmJiBlbGVbJ1VkdEVsZW1lbnRzJ10ubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgY29uc3QgdWR0SXRlbXMgPSB0aGlzLk9yZ2FuaXplRWxlbWVudHNXaXRoVWR0KGVsZVsnVWR0RWxlbWVudHMnXSk7XHJcbiAgICAgICAgICBpZiAodWR0SXRlbXMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICBpdGVtcy5wdXNoKHsgaWQ6IGVsZVsnSUQnXSwgdGV4dDogZWxlWydGaWxlRWxlbWVudE5hbWUnXSwgY29kZTogZWxlWydDb2RlJ10sIG9yZGVyOiBlbGVbJ09yZGVyJ10sIGl0ZW1zOiB1ZHRJdGVtcyB9KTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgaXRlbXMucHVzaCh7IGlkOiBlbGVbJ0lEJ10sIHRleHQ6IGVsZVsnRmlsZUVsZW1lbnROYW1lJ10sIGNvZGU6IGVsZVsnQ29kZSddLCBvcmRlcjogZWxlWydPcmRlciddIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBpZiAoZWxlWydVZHRFbGVtZW50cyddICE9PSBudWxsICYmIGVsZVsnVWR0RWxlbWVudHMnXSAhPT0gdW5kZWZpbmVkICYmIGVsZVsnVWR0RWxlbWVudHMnXS5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICBjb25zdCB1ZHRJdGVtcyA9IHRoaXMuT3JnYW5pemVFbGVtZW50c1dpdGhVZHRNaW51cyhlbGVbJ1VkdEVsZW1lbnRzJ10sIGN1c3RvbUVsZVsnVWR0RWxlbWVudHMnXSk7XHJcbiAgICAgICAgICBpZiAodWR0SXRlbXMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICBpdGVtcy5wdXNoKHsgaWQ6IGVsZVsnSUQnXSwgdGV4dDogZWxlWydGaWxlRWxlbWVudE5hbWUnXSwgY29kZTogZWxlWydDb2RlJ10sIG9yZGVyOiBlbGVbJ09yZGVyJ10sIGl0ZW1zOiB1ZHRJdGVtcyB9KTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIGl0ZW1zO1xyXG4gIH1cclxuICAvLyDmt7vliqDlrZDlr7nosaFKc29u5LiyXHJcbiAgLy8gcHJpdmF0ZSBPcmdhbml6ZUNoaWxkT2JqSnNvbihvYmopOiBhbnlbXSB7XHJcbiAgLy8gICBjb25zdCBpdGVtcyA9IFtdO1xyXG4gIC8vICAgaWYgKG9ialsnQ2hpbGRyZW5EZW8nXS5sZW5ndGggPiAwKSB7XHJcbiAgLy8gICAgIG9ialsnQ2hpbGRyZW5EZW8nXS5mb3JFYWNoKGRlbyA9PiBpdGVtcy5wdXNoKHtpZDogZGVvWydJRCddLCBjb2RlOiBkZW9bJ0NvZGUnXSwgdGV4dDogZGVvWydOYW1lJ10sXHJcbiAgLy8gICAgIGl0ZW1zOiB0aGlzLk9yZ2FuaXplQ2hpbGRPYmpKc29uKGRlbyl9KSk7XHJcbiAgLy8gICB9XHJcbiAgLy8gICByZXR1cm4gaXRlbXM7XHJcbiAgLy8gfVxyXG4gIC8vIOa3u+WKoOWvueixoUpzb27kuLJcclxuICBwcml2YXRlIE9yZ2FuaXplT2JqSnNvbihvYmo6IGFueSwgYWRkRWxlOiBib29sZWFuKTogYW55W10ge1xyXG4gICAgbGV0IGl0ZW1zID0gW107XHJcbiAgICBpZiAoYWRkRWxlKSB7XHJcbiAgICAgIGl0ZW1zID0gdGhpcy5Pcmdhbml6ZUVsZW1lbnRzV2l0aFVkdChvYmpbJ0VsZW1lbnRzJ10pO1xyXG4gICAgICAvLyBvYmpbJ0VsZW1lbnRzJ10uZm9yRWFjaChlbGUgPT4gaXRlbXMucHVzaCh7aWQ6IGVsZVsnSUQnXSwgdGV4dDogZWxlWydOYW1lJ10sIGNvZGU6IGVsZVsnQ29kZSddLCBvcmRlcjogZWxlWydPcmRlciddfSkpO1xyXG4gICAgfVxyXG4gICAgaWYgKG9ialsnQ2hpbGRyZW5EZW8nXS5sZW5ndGggPiAwKSB7XHJcbiAgICAgIG9ialsnQ2hpbGRyZW5EZW8nXS5mb3JFYWNoKGRlbyA9PiBpdGVtcy5wdXNoKHtcclxuICAgICAgICBpZDogZGVvWydJRCddLCBjb2RlOiBkZW9bJ0NvZGUnXSwgdGV4dDogZGVvWydGaWxlT2JqZWN0TmFtZSddLFxyXG4gICAgICAgIGl0ZW1zOiB0aGlzLk9yZ2FuaXplT2JqSnNvbihkZW8sIGFkZEVsZSlcclxuICAgICAgfSkpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGl0ZW1zO1xyXG4gIH1cclxuICBwcml2YXRlIE9yZ2FuaXplRWxlbWVudHNXaXRoVWR0KGVsZXM6IGFueVtdKTogYW55W10ge1xyXG4gICAgY29uc3QgaXRlbXMgPSBbXTtcclxuICAgIGVsZXMuZm9yRWFjaChlbGUgPT4ge1xyXG4gICAgICBpZiAoZWxlWydVZHRFbGVtZW50cyddLmxlbmd0aCA+IDApIHtcclxuICAgICAgICBjb25zdCB1ZHRJdGVtcyA9IHRoaXMuT3JnYW5pemVFbGVtZW50c1dpdGhVZHQoZWxlWydVZHRFbGVtZW50cyddKTtcclxuICAgICAgICBpZiAodWR0SXRlbXMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgaXRlbXMucHVzaCh7IGlkOiBlbGVbJ0lEJ10sIHRleHQ6IGVsZVsnRmlsZUVsZW1lbnROYW1lJ10sIGNvZGU6IGVsZVsnQ29kZSddLCBvcmRlcjogZWxlWydPcmRlciddLCBpdGVtczogdWR0SXRlbXMgfSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIGl0ZW1zLnB1c2goeyBpZDogZWxlWydJRCddLCB0ZXh0OiBlbGVbJ0ZpbGVFbGVtZW50TmFtZSddLCBjb2RlOiBlbGVbJ0NvZGUnXSwgb3JkZXI6IGVsZVsnT3JkZXInXSB9KTtcclxuICAgICAgICB9XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgaXRlbXMucHVzaCh7IGlkOiBlbGVbJ0lEJ10sIHRleHQ6IGVsZVsnRmlsZUVsZW1lbnROYW1lJ10sIGNvZGU6IGVsZVsnQ29kZSddLCBvcmRlcjogZWxlWydPcmRlciddIH0pO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICAgIHJldHVybiBpdGVtcztcclxuICB9XHJcbiAgcHVibGljIGlzRXhwYW5kZWQgPSAoZGF0YUl0ZW06IGFueSwgaW5kZXg6IHN0cmluZykgPT4ge1xyXG4gICAgcmV0dXJuIHRoaXMua2V5cy5pbmRleE9mKGluZGV4KSA+IC0xO1xyXG4gIH1cclxuICBwdWJsaWMgaXNOZXdFeHBhbmRlZCA9IChkYXRhSXRlbTogYW55LCBpbmRleDogc3RyaW5nKSA9PiB7XHJcbiAgICByZXR1cm4gdGhpcy5uZXdLZXlzLmluZGV4T2YoaW5kZXgpID4gLTE7XHJcbiAgfVxyXG4gIC8vIOWPs+enu1xyXG4gIHB1YmxpYyBSaWdodE1vdmUoKSB7XHJcbiAgICBpZiAodGhpcy5zZWxlY3RlZEtleXMubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIGNvbnN0IGluZGV4ZXM6IG51bWJlcltdID0gdGhpcy5HZXRJbmRleGVzKHRoaXMuc2VsZWN0ZWRLZXlzWzBdKTtcclxuICAgIHRoaXMuTW92ZURhdGEoaW5kZXhlcywgdGhpcy5UcmVlRGF0YSwgJycsIHRoaXMuTmV3RGF0YSk7XHJcbiAgfVxyXG4gIC8vIOW3puenu1xyXG4gIHB1YmxpYyBMZWZ0TW92ZSgpIHtcclxuICAgIGlmICh0aGlzLm5ld1NlbGVjdGVkS2V5cy5sZW5ndGggPT09IDApIHtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgY29uc3QgaW5kZXhlczogbnVtYmVyW10gPSB0aGlzLkdldEluZGV4ZXModGhpcy5uZXdTZWxlY3RlZEtleXNbMF0pO1xyXG4gICAgdGhpcy5Nb3ZlRGF0YShpbmRleGVzLCB0aGlzLk5ld0RhdGEsICcnLCB0aGlzLlRyZWVEYXRhKTtcclxuICB9XHJcbiAgcHJpdmF0ZSBHZXRJbmRleGVzKHNLZXlzKTogbnVtYmVyW10ge1xyXG4gICAgY29uc3QgYXJyOiBhbnlbXSA9IHNLZXlzLnNwbGl0KCdfJyk7XHJcbiAgICBjb25zdCBpbmRleGVzOiBudW1iZXJbXSA9IFtdO1xyXG4gICAgYXJyLmZvckVhY2goZWxlbWVudCA9PiB7XHJcbiAgICAgIGluZGV4ZXMucHVzaChOdW1iZXIoZWxlbWVudCkpO1xyXG4gICAgfSk7XHJcbiAgICByZXR1cm4gYXJyO1xyXG4gIH1cclxuICBwcml2YXRlIE1vdmVEYXRhKGluZGV4ZXM6IG51bWJlcltdLCBkYXRhLCBvYmpJZCwgbmV3RGF0YSkge1xyXG4gICAgY29uc3QgaW5kZXggPSBpbmRleGVzLnNoaWZ0KCk7XHJcbiAgICBpZiAoaW5kZXhlcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgIHRoaXMuTW92ZURhdGEoaW5kZXhlcywgZGF0YVtpbmRleF0uaXRlbXMsIGRhdGFbaW5kZXhdLmlkLCBuZXdEYXRhKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGlmIChkYXRhW2luZGV4XS5vcmRlciAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gdGhpcy5BZGREYXRhKG9iaklkLCBuZXdEYXRhLCBkYXRhW2luZGV4XSk7XHJcbiAgICAgICAgaWYgKCFyZXN1bHQpIHtcclxuICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgZGF0YS5zcGxpY2UoaW5kZXgsIDEpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG4gIHByaXZhdGUgQWRkRGF0YShtYWluSWQsIG5ld0RhdGEsIGRhdGEpOiBib29sZWFuIHtcclxuICAgIC8vIOWFiOaJvuWIsOaJgOWxnuWvueixoVxyXG4gICAgY29uc3Qgb2JqID0gdGhpcy5GaW5kT2JqQW5kSW5kZXgobWFpbklkLCBuZXdEYXRhLCAnJyk7XHJcbiAgICBpZiAob2JqID09PSBudWxsKSB7XHJcbiAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuICAgIC8vIOaJvuWIsOimgeaPkuWFpeeahOS9jee9rlxyXG4gICAgY29uc3QgaW5kZXggPSB0aGlzLkZpbmRDb2xJbmRleChvYmouZGF0YUl0ZW0uaXRlbXMsIGRhdGEub3JkZXIpO1xyXG4gICAgb2JqLmRhdGFJdGVtLml0ZW1zLnNwbGljZShpbmRleCwgMCwgZGF0YSk7XHJcbiAgICB0aGlzLmhhbmRsZU5ld0V4cGFuZChvYmopO1xyXG4gICAgcmV0dXJuIHRydWU7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIEZpbmRPYmpBbmRJbmRleChtYWluSWQsIGRhdGE6IGFueVtdLCBwYXJlbnRJbmRleDogc3RyaW5nKTogYW55IHtcclxuICAgIGxldCByZXN1bHQgPSBudWxsO1xyXG4gICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOnByZWZlci1mb3Itb2ZcclxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZGF0YS5sZW5ndGg7IGkrKykge1xyXG4gICAgICBpZiAoZGF0YVtpXS5pZCA9PT0gbWFpbklkKSB7XHJcbiAgICAgICAgaWYgKHBhcmVudEluZGV4ICE9PSAnJykge1xyXG4gICAgICAgICAgcmVzdWx0ID0geyBpbmRleDogcGFyZW50SW5kZXggKyAnXycgKyBpLnRvU3RyaW5nKCksIGRhdGFJdGVtOiBkYXRhW2ldIH07XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIHJlc3VsdCA9IHsgaW5kZXg6IGkudG9TdHJpbmcoKSwgZGF0YUl0ZW06IGRhdGFbaV0gfTtcclxuICAgICAgICB9XHJcbiAgICAgIH0gZWxzZSBpZiAoZGF0YVtpXS5pdGVtcyAhPT0gdW5kZWZpbmVkICYmIGRhdGFbaV0uaXRlbXMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgIHJlc3VsdCA9IHRoaXMuRmluZE9iakFuZEluZGV4KG1haW5JZCwgZGF0YVtpXS5pdGVtcywgaS50b1N0cmluZygpKTtcclxuICAgICAgfVxyXG4gICAgICBpZiAocmVzdWx0ID09IG51bGwpIHtcclxuICAgICAgICBjb250aW51ZTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gcmVzdWx0O1xyXG4gIH1cclxuICBwcml2YXRlIEZpbmRDb2xJbmRleChpdGVtczogYW55W10sIG9yZGVyOiBudW1iZXIpIHtcclxuICAgIGxldCBpbmRleCA9IC0xO1xyXG4gICAgaWYgKGl0ZW1zLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICByZXR1cm4gMDtcclxuICAgIH1cclxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgaXRlbXMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgaWYgKGl0ZW1zW2ldLm9yZGVyIDwgb3JkZXIpIHtcclxuICAgICAgICBpbmRleCA9IGk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiBpbmRleCArIDE7XHJcbiAgfVxyXG4gIHB1YmxpYyBoYW5kbGVDb2xsYXBzZShub2RlKSB7XHJcbiAgICB0aGlzLmtleXMgPSB0aGlzLmtleXMuZmlsdGVyKGsgPT4gayAhPT0gbm9kZS5pbmRleCk7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgaGFuZGxlRXhwYW5kKG5vZGUpIHtcclxuICAgIGNvbnNvbGUubG9nKG5vZGUpO1xyXG4gICAgdGhpcy5rZXlzID0gdGhpcy5rZXlzLmNvbmNhdChub2RlLmluZGV4KTtcclxuICB9XHJcbiAgcHVibGljIGhhbmRsZU5ld0NvbGxhcHNlKG5vZGUpIHtcclxuICAgIHRoaXMubmV3S2V5cyA9IHRoaXMubmV3S2V5cy5maWx0ZXIoayA9PiBrICE9PSBub2RlLmluZGV4KTtcclxuICB9XHJcblxyXG4gIHB1YmxpYyBoYW5kbGVOZXdFeHBhbmQobm9kZSkge1xyXG4gICAgY29uc29sZS5sb2cobm9kZSk7XHJcbiAgICB0aGlzLm5ld0tleXMgPSB0aGlzLm5ld0tleXMuY29uY2F0KG5vZGUuaW5kZXgpO1xyXG4gIH1cclxuICBwdWJsaWMgUmlnaHRNb3ZlQWxsKCkge1xyXG4gICAgLy8gdGhpcy5DbGVhclRyZWUodGhpcy5UcmVlRGF0YSk7XHJcbiAgICAvLyB0aGlzLkZpbGxUcmVlKHRoaXMuTmV3RGF0YSk7XHJcbiAgICB0aGlzLlRyZWVEYXRhID0gW107XHJcbiAgICBjb25zdCBtYWluT2JqID0gdGhpcy5Nb2RlbFsnTWFpbk9iamVjdCddO1xyXG4gICAgdGhpcy5UcmVlRGF0YS5wdXNoKHsgaWQ6IG1haW5PYmpbJ0lEJ10sIGNvZGU6IG1haW5PYmpbJ0NvZGUnXSwgdGV4dDogbWFpbk9ialsnRmlsZU9iamVjdE5hbWUnXSwgaXRlbXM6IHRoaXMuT3JnYW5pemVPYmpKc29uKG1haW5PYmosIGZhbHNlKSB9KTtcclxuICAgIC8vIHRoaXMuRmlsbFRyZWUodGhpcy5UcmVlRGF0YSk7XHJcbiAgICB0aGlzLk5ld0RhdGEgPSBbXTtcclxuICAgIHRoaXMuTmV3RGF0YS5wdXNoKHsgaWQ6IG1haW5PYmpbJ0lEJ10sIGNvZGU6IG1haW5PYmpbJ0NvZGUnXSwgdGV4dDogbWFpbk9ialsnRmlsZU9iamVjdE5hbWUnXSwgaXRlbXM6IHRoaXMuT3JnYW5pemVPYmpKc29uKG1haW5PYmosIHRydWUpIH0pO1xyXG4gIH1cclxuICBwdWJsaWMgRmlsbFRyZWUodDogYW55W10pIHtcclxuICAgIHQgPSBbXTtcclxuICAgIGNvbnN0IG1haW5PYmogPSB0aGlzLk1vZGVsWydNYWluT2JqZWN0J107XHJcbiAgICB0LnB1c2goeyBpZDogbWFpbk9ialsnSUQnXSwgY29kZTogbWFpbk9ialsnQ29kZSddLCB0ZXh0OiBtYWluT2JqWydGaWxlT2JqZWN0TmFtZSddLCBpdGVtczogdGhpcy5Pcmdhbml6ZU9iakpzb24obWFpbk9iaiwgdHJ1ZSkgfSk7XHJcbiAgfVxyXG4gIHB1YmxpYyBDbGVhclRyZWUodDogYW55W10pIHtcclxuICAgIC8vIHQgPSBbXTtcclxuICAgIC8vIGNvbnN0IG1haW5PYmogPSB0aGlzLk1vZGVsWydNYWluT2JqZWN0J107XHJcbiAgICAvLyB0LnB1c2goe2lkOiBtYWluT2JqWydJRCddLCBjb2RlOiBtYWluT2JqWydDb2RlJ10sIHRleHQ6IG1haW5PYmpbJ05hbWUnXSwgaXRlbXM6IHRoaXMuT3JnYW5pemVPYmpKc29uKG1haW5PYmosIGZhbHNlKX0pO1xyXG4gICAgdCA9IFtdO1xyXG4gIH1cclxuICBwdWJsaWMgTGVmdE1vdmVBbGwoKSB7XHJcbiAgICAvLyB0aGlzLkNsZWFyVHJlZSh0aGlzLk5ld0RhdGEpO1xyXG4gICAgdGhpcy5OZXdEYXRhID0gW107XHJcbiAgICBjb25zdCBtYWluT2JqID0gdGhpcy5Nb2RlbFsnTWFpbk9iamVjdCddO1xyXG4gICAgdGhpcy5OZXdEYXRhLnB1c2goeyBpZDogbWFpbk9ialsnSUQnXSwgY29kZTogbWFpbk9ialsnQ29kZSddLCB0ZXh0OiBtYWluT2JqWydGaWxlT2JqZWN0TmFtZSddLCBpdGVtczogdGhpcy5Pcmdhbml6ZU9iakpzb24obWFpbk9iaiwgZmFsc2UpIH0pO1xyXG4gICAgLy8gdGhpcy5GaWxsVHJlZSh0aGlzLlRyZWVEYXRhKTtcclxuICAgIHRoaXMuVHJlZURhdGEgPSBbXTtcclxuICAgIHRoaXMuVHJlZURhdGEucHVzaCh7IGlkOiBtYWluT2JqWydJRCddLCBjb2RlOiBtYWluT2JqWydDb2RlJ10sIHRleHQ6IG1haW5PYmpbJ0ZpbGVPYmplY3ROYW1lJ10sIGl0ZW1zOiB0aGlzLk9yZ2FuaXplT2JqSnNvbihtYWluT2JqLCB0cnVlKSB9KTtcclxuICB9XHJcbiAgcHVibGljIE1vdmVVcCgpIHtcclxuICAgIGlmICh0aGlzLm5ld1NlbGVjdGVkS2V5cy5sZW5ndGggPT09IDApIHtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgY29uc3QgaW5kZXhlcyA9IHRoaXMuR2V0SW5kZXhlcyh0aGlzLm5ld1NlbGVjdGVkS2V5c1swXSk7XHJcbiAgICBjb25zdCBsYXN0SW5kZXggPSBpbmRleGVzLnBvcCgpO1xyXG4gICAgY29uc3QgaXRlbXMgPSB0aGlzLkdldEl0ZW1zKGluZGV4ZXMsIHRoaXMuTmV3RGF0YSk7XHJcbiAgICBpZiAoaXRlbXNbbGFzdEluZGV4XS5vcmRlciA9PT0gdW5kZWZpbmVkIHx8IGl0ZW1zW2xhc3RJbmRleF0ub3JkZXIgPT09IDApIHtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgY29uc3QgdGVtcCA9IGl0ZW1zW2xhc3RJbmRleF0ub3JkZXI7XHJcbiAgICBpdGVtc1tsYXN0SW5kZXhdLm9yZGVyID0gaXRlbXNbbGFzdEluZGV4IC0gMV0ub3JkZXI7XHJcbiAgICBpdGVtc1tsYXN0SW5kZXggLSAxXS5vcmRlciA9IHRlbXA7XHJcbiAgICBpdGVtcy5zcGxpY2UobGFzdEluZGV4IC0gMSwgMCwgaXRlbXNbbGFzdEluZGV4XSk7XHJcbiAgICBpdGVtcy5zcGxpY2UoTnVtYmVyKGxhc3RJbmRleCkgKyAxLCAxKTtcclxuICAgIGNvbnN0IHBhcmVudEluZGV4OiBzdHJpbmcgPSB0aGlzLm5ld1NlbGVjdGVkS2V5c1swXTtcclxuICAgIHRoaXMubmV3U2VsZWN0ZWRLZXlzWzBdID0gcGFyZW50SW5kZXguc3Vic3RyaW5nKDAsIHBhcmVudEluZGV4Lmxhc3RJbmRleE9mKCdfJykgKyAxKSArIChsYXN0SW5kZXggLSAxKTtcclxuICB9XHJcbiAgcHJpdmF0ZSBHZXRJdGVtcyhpbmRleGVzLCBkYXRhKTogYW55W10ge1xyXG4gICAgaWYgKGluZGV4ZXMubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgIHJldHVybiBkYXRhO1xyXG4gICAgfVxyXG4gICAgY29uc3QgaW5kZXggPSBpbmRleGVzLnNoaWZ0KCk7XHJcbiAgICByZXR1cm4gdGhpcy5HZXRJdGVtcyhpbmRleGVzLCBkYXRhW2luZGV4XS5pdGVtcyk7XHJcbiAgfVxyXG4gIHB1YmxpYyBNb3ZlRG93bigpIHtcclxuICAgIGlmICh0aGlzLm5ld1NlbGVjdGVkS2V5cy5sZW5ndGggPT09IDApIHtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgY29uc3QgaW5kZXhlcyA9IHRoaXMuR2V0SW5kZXhlcyh0aGlzLm5ld1NlbGVjdGVkS2V5c1swXSk7XHJcbiAgICBjb25zdCBsYXN0SW5kZXggPSBpbmRleGVzLnBvcCgpO1xyXG4gICAgY29uc3QgaXRlbXMgPSB0aGlzLkdldEl0ZW1zKGluZGV4ZXMsIHRoaXMuTmV3RGF0YSk7XHJcbiAgICBpZiAoaXRlbXMubGVuZ3RoID09PSBsYXN0SW5kZXggfHwgaXRlbXNbTnVtYmVyKGxhc3RJbmRleCkgKyAxXSA9PT0gdW5kZWZpbmVkIHx8IGl0ZW1zW051bWJlcihsYXN0SW5kZXgpICsgMV0ub3JkZXIgPT09IHVuZGVmaW5lZFxyXG4gICAgICB8fCBpdGVtc1tsYXN0SW5kZXhdLm9yZGVyID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgY29uc3QgdGVtcCA9IGl0ZW1zW2xhc3RJbmRleF0ub3JkZXI7XHJcbiAgICBpdGVtc1tsYXN0SW5kZXhdLm9yZGVyID0gaXRlbXNbTnVtYmVyKGxhc3RJbmRleCkgKyAxXS5vcmRlcjtcclxuICAgIGl0ZW1zW051bWJlcihsYXN0SW5kZXgpICsgMV0ub3JkZXIgPSB0ZW1wO1xyXG4gICAgaXRlbXMuc3BsaWNlKE51bWJlcihsYXN0SW5kZXgpICsgMiwgMCwgaXRlbXNbbGFzdEluZGV4XSk7XHJcbiAgICBpdGVtcy5zcGxpY2UobGFzdEluZGV4LCAxKTtcclxuICAgIGNvbnN0IHBhcmVudEluZGV4OiBzdHJpbmcgPSB0aGlzLm5ld1NlbGVjdGVkS2V5c1swXTtcclxuICAgIHRoaXMubmV3U2VsZWN0ZWRLZXlzWzBdID0gcGFyZW50SW5kZXguc3Vic3RyaW5nKDAsIHBhcmVudEluZGV4Lmxhc3RJbmRleE9mKCdfJykgKyAxKSArIChOdW1iZXIobGFzdEluZGV4KSArIDEpO1xyXG4gIH1cclxuICBwdWJsaWMgU2F2ZSgpIHtcclxuICAgIC8vIOS8oOWFpeeahOaooeWei+eahOS4u+WvueixoVxyXG4gICAgaWYgKHRoaXMuSW5uZXJNb2RlbCA9PSBudWxsKSB7XHJcbiAgICAgIHRoaXMuSW5uZXJNb2RlbCA9IHRoaXMuTW9kZWw7XHJcbiAgICB9XHJcbiAgICBjb25zdCBtYWluT2JqID0gdGhpcy5Jbm5lck1vZGVsWydNYWluT2JqZWN0J107XHJcbiAgICBjb25zdCBuZXdNYWluT2JqID0gdGhpcy5OZXdEYXRhWzBdO1xyXG4gICAgY29uc3QgcHJlTWFpbk9iaiA9IHRoaXMuTW9kZWxbJ01haW5PYmplY3QnXTtcclxuICAgIG1haW5PYmpbJ0VsZW1lbnRzJ10gPSB0aGlzLk9yZ2FuaXplRWxlbWVudHMocHJlTWFpbk9ialsnRWxlbWVudHMnXSwgbmV3TWFpbk9iaik7XHJcbiAgICB0aGlzLk9yZ2FuaXplQ2hpbGRyZW5EZW8obWFpbk9iaiwgbmV3TWFpbk9iaiwgcHJlTWFpbk9iaik7XHJcbiAgfVxyXG4gIHByaXZhdGUgT3JnYW5pemVDaGlsZHJlbkRlbyhvYmo6IGFueSwgbmV3T2JqOiBhbnksIHByZU1haW5PYmo6IGFueSkge1xyXG4gICAgaWYgKG9ialsnQ2hpbGRyZW5EZW8nXSAhPT0gdW5kZWZpbmVkICYmIG9ialsnQ2hpbGRyZW5EZW8nXS5sZW5ndGggPiAwKSB7XHJcbiAgICAgIGNvbnN0IG5ld0NoaWxkcmVuRGVvID0gW107XHJcbiAgICAgIG9ialsnQ2hpbGRyZW5EZW8nXS5mb3JFYWNoKHQgPT4ge1xyXG4gICAgICAgIGNvbnN0IGNoaWxkRGVvID0gbmV3T2JqWydpdGVtcyddLmZpbmQoaXRlbSA9PiBpdGVtWydpZCddID09PSB0WydJRCddKTtcclxuICAgICAgICBjb25zdCBwcmVDaGlsZE9iaiA9IHByZU1haW5PYmpbJ0NoaWxkcmVuRGVvJ10uZmluZChpdGVtID0+IGl0ZW1bJ0lEJ10gPT09IHRbJ0lEJ10pO1xyXG4gICAgICAgIGlmIChjaGlsZERlbyAhPT0gbnVsbCAmJiBjaGlsZERlbyAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICB0WydFbGVtZW50cyddID0gdGhpcy5Pcmdhbml6ZUVsZW1lbnRzKHByZUNoaWxkT2JqWydFbGVtZW50cyddLCBjaGlsZERlbyk7XHJcbiAgICAgICAgICBpZiAodFsnRWxlbWVudHMnXSAhPT0gdW5kZWZpbmVkICYmIHRbJ0VsZW1lbnRzJ10gIT09IG51bGwpIHtcclxuICAgICAgICAgICAgbmV3Q2hpbGRyZW5EZW8ucHVzaCh0KTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5Pcmdhbml6ZUNoaWxkcmVuRGVvKHQsIGNoaWxkRGVvLCBwcmVDaGlsZE9iaik7XHJcbiAgICAgIH0pO1xyXG4gICAgICBvYmpbJ0NoaWxkcmVuRGVvJ10gPSBuZXdDaGlsZHJlbkRlbztcclxuICAgIH1cclxuICB9XHJcbiAgLy8g5L+d5a2Y5pe257uE57uH5YiXLCBvYmo6IOWklumDqOS8oOWFpeeahOWIl++8jG5ld09iajog57yW6L6R5ZCO5paw55qE5YiXXHJcbiAgcHJpdmF0ZSBPcmdhbml6ZUVsZW1lbnRzKG9iajogYW55W10sIG5ld09iajogYW55KTogYW55W10ge1xyXG4gICAgY29uc3QgbmV3RWxlcyA9IG5ld09ialsnaXRlbXMnXTtcclxuICAgIGNvbnN0IGVsZXMgPSBbXTtcclxuICAgIG5ld0VsZXMuZm9yRWFjaCh0ID0+IHtcclxuICAgICAgY29uc3QgZWxlID0gb2JqLmZpbmQoZSA9PiBlWydJRCddID09PSB0WydpZCddKTtcclxuICAgICAgaWYgKGVsZSAhPT0gdW5kZWZpbmVkICYmIGVsZSAhPT0gbnVsbCkge1xyXG4gICAgICAgIGVsZXMucHVzaChlbGUpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICAgIHJldHVybiBlbGVzO1xyXG4gIH1cclxuICAvLyBwcml2YXRlIE9yZ2FuaXplRGVvKG9iaik6IGFueSB7XHJcbiAgLy8gICBvYmpbJ0VsZW1lbnRzJ10gPSB0aGlzLk9yZ2FuaXplRWxlbWVudHMob2JqWydFbGVtZW50cyddKTtcclxuICAvLyAgIGlmIChvYmpbJ0NoaWxkcmVuRGVvJ10ubGVuZ3RoID4gMCkge1xyXG4gIC8vICAgICBvYmpbJ0NoaWxkcmVuRGVvJ10gPSB0aGlzLk9yZ2FuaXplQ2hpbGREZW8ob2JqKVxyXG4gIC8vICAgfVxyXG4gIC8vIH1cclxuXHJcbn1cclxuIl19