/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, TemplateRef, ViewChild, Output, EventEmitter, Injector, ComponentFactoryResolver } from '@angular/core';
import { DatagridComponent } from '@farris/ui-datagrid';
import { RuleFileType } from './RuleFileType';
import { HttpClient } from '@angular/common/http';
import { DataIEUtils } from '../service/Utils/DataIEUtils';
import { NotifyService } from '@farris/ui-notify';
import { BsModalService } from "@farris/ui-modal";
import { MessagerService } from "@farris/ui-messager";
import { ExtendComponent1Component } from '../bakcomponents/extend-component1/extend-component1.component';
var RuleSelectComponent = /** @class */ (function () {
    function RuleSelectComponent(http, notify, injector, modalService, msgService, resolver) {
        var _this = this;
        this.http = http;
        this.notify = notify;
        this.injector = injector;
        this.modalService = modalService;
        this.msgService = msgService;
        this.resolver = resolver;
        this.closeModal = new EventEmitter();
        this.okModal = new EventEmitter();
        // 规则ID 该id为表单上配置的规则id
        this.ruleId = '';
        this.voId = '';
        this.RuleMgrsData = [];
        this.fileTypes = [
            { label: 'Office Excel97-2003(*.xls)', value: RuleFileType[0] },
            { label: 'Office Excel Macro(*.xlsm)', value: RuleFileType[1] },
            { label: 'Office Excel(*.xlsx)', value: RuleFileType[2] },
            { label: 'WPS Table(*.et)', value: RuleFileType[3] },
            { label: 'WPS Table(Template File)(*.ett)', value: RuleFileType[4] },
            { label: 'XML Table(*.xml)', value: RuleFileType[5] },
            { label: 'PDF File(*.pdf)', value: RuleFileType[6] },
            { label: 'CSV File(*.csv)', value: RuleFileType[7] }
        ];
        this.RuleMgrsColumns = [];
        DataIEUtils.getTranslateValue(http).subscribe((/**
         * @param {?} res
         * @return {?}
         */
        function (res) {
            _this.i18nResouce = res;
            _this.ie_cancel = res['ie_cancel'];
            _this.ie_ok = res['ie_ok'];
            _this.ruleselect_code = res['ruleselect_code'];
            _this.ruleselect_name = res['ruleselect_name'];
            _this.ruleselect_rulesource = res['ruleselect_rulesource'];
            _this.ruleselect_custom = res['ruleselect_custom'];
            _this.ruleselect_syspreset = res['ruleselect_syspreset'];
            _this.ruleselect_billcategory = res['ruleselect_billcategory'];
            _this.ruleselect_creator = res['ruleselect_creator'];
            _this.ruleselect_filetype = res['ruleselect_filetype'];
            _this.ruleselect_selectrulenotify = res['ruleselect_selectrulenotify'];
            _this.ruleselect_updatetime = res['ruleselect_updatetime'];
        }));
    }
    /**
     * @return {?}
     */
    RuleSelectComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var ruleSourceType = [
            { label: this.i18nResouce['product_preset'], value: 'ProductPreset' },
            { label: this.i18nResouce['project_define'], value: 'ProjectDefine' },
            { label: this.i18nResouce['user_custom'], value: 'UserCustom' }
        ];
        this.RuleMgrsColumns = [
            { field: 'code', width: 180, title: this.ruleselect_code, showTips: true, halign: 'center', align: 'center', sortable: true },
            { field: 'name', width: 180, title: this.ruleselect_name, showTips: true, halign: 'center', align: 'center', sortable: true },
            // {
            //   field: 'ruleSourceType', width: 100, title: this.ruleselect_rulesource, showTips: true, halign: 'center', align: 'center', sortable: true,
            //   formatter: { type: 'enum', options: { valueField: 'value', textField: 'label', data: ruleSourceType } }
            // },
            {
                field: 'sysPreset', width: 100, title: this.ruleselect_rulesource, halign: 'center', align: 'center', sortable: true,
                formatter: { type: 'boolean', options: { trueText: this.ruleselect_syspreset, falseText: this.ruleselect_custom } }
            },
            // { field: 'bizEntityName', width: 150, title: '数据实体', halign: 'center', align: 'center', sortable: true },
            {
                field: 'fileType', width: 180, title: this.ruleselect_filetype, showTips: true, halign: 'center', align: 'center', sortable: true,
                formatter: { type: 'enum', options: { valueField: 'value', textField: 'label', data: this.fileTypes } }
            },
            { field: 'lastModifiedTime', width: 150, title: this.ruleselect_updatetime, showTips: true, halign: 'center', align: 'center', sortable: true }
            // {
            //   field: 'operation',
            //   width: 130,
            //   halign: 'center',
            //   align: 'center',
            //   title: this.i18nResouce['operation'],
            //   template: this.columnOperation
            // }
            // { field: 'creator', width: 150, title: this.ruleselect_creator, halign: 'center', align: 'center', sortable: true }
        ];
    };
    /**
     * @param {?} ctx
     * @return {?}
     */
    RuleSelectComponent.prototype.createRuleExtend = /**
     * @param {?} ctx
     * @return {?}
     */
    function (ctx) {
        var _this = this;
        /** @type {?} */
        var url = '/api/runtime/dip/v1.0/dataIeRuleManage/createRuleExtendInfo/' + ctx.rowData.id;
        this.http.get(url).subscribe((/**
         * @param {?} res
         * @return {?}
         */
        function (res) {
            /** @type {?} */
            var compFactory = _this.resolver.resolveComponentFactory(ExtendComponent1Component);
            /** @type {?} */
            var compRef = compFactory.create(_this.injector);
            compRef.instance.dataIeRuleExtendOriginal = res;
            /** @type {?} */
            var modalConfig = {
                title: '导入模板配置',
                width: 750,
                height: 650,
                buttons: compRef.instance.modalFooter,
                showHeader: true,
                showMaxButton: false,
                showButtons: true
            };
            /** @type {?} */
            var dialog = _this.modalService.show(compRef, modalConfig);
            compRef.instance.closeModal.subscribe((/**
             * @return {?}
             */
            function () {
                dialog.close();
            }));
            compRef.instance.okModal.subscribe((/**
             * @param {?} dataIeRuleExtend
             * @return {?}
             */
            function (dataIeRuleExtend) {
                /** @type {?} */
                var idx = _this.RuleMgrsData.findIndex((/**
                 * @param {?} e
                 * @return {?}
                 */
                function (e) { return e.id === dataIeRuleExtend.id; }));
                if (idx >= 0) {
                    _this.RuleMgrsData[idx] = dataIeRuleExtend;
                    _this.RuleMgrsGrid.refresh();
                }
                else {
                    _this.RuleMgrsData.push(dataIeRuleExtend);
                }
                dialog.close();
            }));
        }), (/**
         * @param {?} error
         * @return {?}
         */
        function (error) {
            _this.notify.error(error.error.Message);
            console.log(error.error.Message);
        }));
    };
    /**
     * @param {?} ctx
     * @return {?}
     */
    RuleSelectComponent.prototype.updateRule = /**
     * @param {?} ctx
     * @return {?}
     */
    function (ctx) {
    };
    /**
     * @param {?} ctx
     * @return {?}
     */
    RuleSelectComponent.prototype.deleteRule = /**
     * @param {?} ctx
     * @return {?}
     */
    function (ctx) {
    };
    /**
     * @return {?}
     */
    RuleSelectComponent.prototype.okHandler = /**
     * @return {?}
     */
    function () {
        var _this = this;
        /** @type {?} */
        var selectedRow = this.RuleMgrsGrid.selectedRow;
        if (selectedRow === null) {
            this.notify.info(this.ruleselect_selectrulenotify);
            return;
        }
        /** @type {?} */
        var url = '/api/runtime/dip/v1.0/dataIeRuleManage/updateConfigRule';
        /** @type {?} */
        var body = {
            ruleId: this.ruleId,
            voId: this.voId,
            ruleType: this.ruleType,
            currentRuleId: selectedRow.id
        };
        this.http.post(url, body).subscribe((/**
         * @param {?} res
         * @return {?}
         */
        function (res) {
            console.log(res.message);
            _this.okModal.emit(selectedRow.data);
        }), (/**
         * @param {?} error
         * @return {?}
         */
        function (error) {
            _this.notify.error(error.error.Message);
            console.log(error.error.Message);
        }));
    };
    /**
     * @return {?}
     */
    RuleSelectComponent.prototype.cancelHandler = /**
     * @return {?}
     */
    function () {
        this.closeModal.emit();
    };
    RuleSelectComponent.decorators = [
        { type: Component, args: [{
                    selector: 'thd-rule-select',
                    template: "<div class=\"d-flex flex-fill\" style=\"height:100%;\">\n  <farris-datagrid #RuleMgrsGrid id=\"rule-mgrs-data\" [fit]=\"true\" [fitColumns]=\"true\" [columns]=\"RuleMgrsColumns\"\n                   [pagination]=\"false\"\n                   [showLineNumber]=\"true\" [keepSelect]=\"true\" [sizeType]=\"'sm'\" [data]=\"RuleMgrsData\">\n  </farris-datagrid>\n  <ng-template #columnOperation let-ctx>\n    <a *ngIf=\"ctx.rowData.ruleSourceType !== 'UserCustom'\" href=\"javascript: void(0);\" (click)=\"createRuleExtend(ctx)\">\u521B\u5EFA\u6269\u5C55</a>\n    <div *ngIf=\"ctx.rowData.ruleSourceType === 'UserCustom'\">\n      <a href=\"javascript: void(0);\" (click)=\"updateRule(ctx)\">\u4FEE\u6539</a>\n      &nbsp;&nbsp;\n      <a href=\"javascript: void(0);\" (click)=\"deleteRule(ctx)\">\u5220\u9664</a>\n    </div>\n\n  </ng-template>\n</div>\n\n<ng-template #selectFooter>\n  <button type=\"button\" class=\"btn btn-outline-secondary\" (click)=\"cancelHandler()\">{{ie_cancel}}</button>\n  <button type=\"button\" class=\"btn btn-primary\" (click)=\"okHandler()\">{{ie_ok}}</button>\n</ng-template>\n",
                    styles: [""]
                }] }
    ];
    /** @nocollapse */
    RuleSelectComponent.ctorParameters = function () { return [
        { type: HttpClient },
        { type: NotifyService },
        { type: Injector },
        { type: BsModalService },
        { type: MessagerService },
        { type: ComponentFactoryResolver }
    ]; };
    RuleSelectComponent.propDecorators = {
        RuleMgrsGrid: [{ type: ViewChild, args: ['RuleMgrsGrid',] }],
        modalFooter: [{ type: ViewChild, args: ['selectFooter',] }],
        columnOperation: [{ type: ViewChild, args: ['columnOperation',] }],
        closeModal: [{ type: Output }],
        okModal: [{ type: Output }]
    };
    return RuleSelectComponent;
}());
export { RuleSelectComponent };
if (false) {
    /** @type {?} */
    RuleSelectComponent.prototype.RuleMgrsGrid;
    /** @type {?} */
    RuleSelectComponent.prototype.modalFooter;
    /** @type {?} */
    RuleSelectComponent.prototype.columnOperation;
    /** @type {?} */
    RuleSelectComponent.prototype.closeModal;
    /** @type {?} */
    RuleSelectComponent.prototype.okModal;
    /** @type {?} */
    RuleSelectComponent.prototype.ruleId;
    /** @type {?} */
    RuleSelectComponent.prototype.voId;
    /** @type {?} */
    RuleSelectComponent.prototype.ruleType;
    /** @type {?} */
    RuleSelectComponent.prototype.RuleMgrsData;
    /** @type {?} */
    RuleSelectComponent.prototype.fileTypes;
    /** @type {?} */
    RuleSelectComponent.prototype.RuleMgrsColumns;
    /** @type {?} */
    RuleSelectComponent.prototype.i18nResouce;
    /** @type {?} */
    RuleSelectComponent.prototype.ie_cancel;
    /** @type {?} */
    RuleSelectComponent.prototype.ie_ok;
    /** @type {?} */
    RuleSelectComponent.prototype.ruleselect_code;
    /** @type {?} */
    RuleSelectComponent.prototype.ruleselect_name;
    /** @type {?} */
    RuleSelectComponent.prototype.ruleselect_rulesource;
    /** @type {?} */
    RuleSelectComponent.prototype.ruleselect_syspreset;
    /** @type {?} */
    RuleSelectComponent.prototype.ruleselect_custom;
    /** @type {?} */
    RuleSelectComponent.prototype.ruleselect_billcategory;
    /** @type {?} */
    RuleSelectComponent.prototype.ruleselect_creator;
    /** @type {?} */
    RuleSelectComponent.prototype.ruleselect_filetype;
    /** @type {?} */
    RuleSelectComponent.prototype.ruleselect_selectrulenotify;
    /** @type {?} */
    RuleSelectComponent.prototype.ruleselect_updatetime;
    /**
     * @type {?}
     * @private
     */
    RuleSelectComponent.prototype.http;
    /**
     * @type {?}
     * @private
     */
    RuleSelectComponent.prototype.notify;
    /**
     * @type {?}
     * @private
     */
    RuleSelectComponent.prototype.injector;
    /**
     * @type {?}
     * @private
     */
    RuleSelectComponent.prototype.modalService;
    /**
     * @type {?}
     * @private
     */
    RuleSelectComponent.prototype.msgService;
    /**
     * @type {?}
     * @private
     */
    RuleSelectComponent.prototype.resolver;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicnVsZS1zZWxlY3QuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGdzcC1kaXAvZGF0YS1pbXAtZXhwLyIsInNvdXJjZXMiOlsibGliL3J1bGUtc2VsZWN0L3J1bGUtc2VsZWN0LmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7O0FBQUEsT0FBTyxFQUNMLFNBQVMsRUFFVCxXQUFXLEVBQ1gsU0FBUyxFQUNULE1BQU0sRUFDTixZQUFZLEVBQ1osUUFBUSxFQUNSLHdCQUF3QixFQUN6QixNQUFNLGVBQWUsQ0FBQztBQUN2QixPQUFPLEVBQUUsaUJBQWlCLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQztBQUN4RCxPQUFPLEVBQUUsWUFBWSxFQUFFLE1BQU0sZ0JBQWdCLENBQUM7QUFDOUMsT0FBTyxFQUFFLFVBQVUsRUFBRSxNQUFNLHNCQUFzQixDQUFDO0FBQ2xELE9BQU8sRUFBQyxXQUFXLEVBQWUsTUFBTSw4QkFBOEIsQ0FBQztBQUN2RSxPQUFPLEVBQUUsYUFBYSxFQUFFLE1BQU0sbUJBQW1CLENBQUM7QUFDbEQsT0FBTyxFQUFDLGNBQWMsRUFBQyxNQUFNLGtCQUFrQixDQUFDO0FBRWhELE9BQU8sRUFBQyxlQUFlLEVBQUMsTUFBTSxxQkFBcUIsQ0FBQztBQUNwRCxPQUFPLEVBQUMseUJBQXlCLEVBQUMsTUFBTSxnRUFBZ0UsQ0FBQztBQUV6RztJQTBDRSw2QkFDVSxJQUFnQixFQUNoQixNQUFxQixFQUNyQixRQUFrQixFQUNsQixZQUE0QixFQUM1QixVQUEyQixFQUMzQixRQUFrQztRQU41QyxpQkF3QkM7UUF2QlMsU0FBSSxHQUFKLElBQUksQ0FBWTtRQUNoQixXQUFNLEdBQU4sTUFBTSxDQUFlO1FBQ3JCLGFBQVEsR0FBUixRQUFRLENBQVU7UUFDbEIsaUJBQVksR0FBWixZQUFZLENBQWdCO1FBQzVCLGVBQVUsR0FBVixVQUFVLENBQWlCO1FBQzNCLGFBQVEsR0FBUixRQUFRLENBQTBCO1FBdkNsQyxlQUFVLEdBQUcsSUFB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QUVkLGVBQWU7Z0JBVHJCLHdCQUF3Qjs7OytCQWtCdkIsU0FBUyxTQUFDLGNBQWM7OEJBQ3hCLFNBQVMsU0FBQyxjQUFjO2tDQUN4QixTQUFTLFNBQUMsaUJBQWlCOzZCQUMzQixNQUFNOzBCQUNOLE1BQU07O0lBa0tULDBCQUFDO0NBQUEsQUE1S0QsSUE0S0M7U0F2S1ksbUJBQW1COzs7SUFDOUIsMkNBQTJEOztJQUMzRCwwQ0FBeUQ7O0lBQ3pELDhDQUFnRTs7SUFDaEUseUNBQStDOztJQUMvQyxzQ0FBNEM7O0lBRTVDLHFDQUFZOztJQUNaLG1DQUFVOztJQUNWLHVDQUFjOztJQUVkLDJDQUFrQjs7SUFDbEIsd0NBU0U7O0lBQ0YsOENBQXFCOztJQUVyQiwwQ0FBZ0I7O0lBQ2hCLHdDQUFrQjs7SUFDbEIsb0NBQWM7O0lBQ2QsOENBQXdCOztJQUN4Qiw4Q0FBd0I7O0lBQ3hCLG9EQUE4Qjs7SUFDOUIsbURBQTZCOztJQUM3QixnREFBMEI7O0lBQzFCLHNEQUFnQzs7SUFDaEMsaURBQTJCOztJQUMzQixrREFBNEI7O0lBQzVCLDBEQUFvQzs7SUFDcEMsb0RBQTZCOzs7OztJQUUzQixtQ0FBd0I7Ozs7O0lBQ3hCLHFDQUE2Qjs7Ozs7SUFDN0IsdUNBQTBCOzs7OztJQUMxQiwyQ0FBb0M7Ozs7O0lBQ3BDLHlDQUFtQzs7Ozs7SUFDbkMsdUNBQTBDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcclxuICBDb21wb25lbnQsXHJcbiAgT25Jbml0LFxyXG4gIFRlbXBsYXRlUmVmLFxyXG4gIFZpZXdDaGlsZCxcclxuICBPdXRwdXQsXHJcbiAgRXZlbnRFbWl0dGVyLFxyXG4gIEluamVjdG9yLFxyXG4gIENvbXBvbmVudEZhY3RvcnlSZXNvbHZlclxyXG59IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBEYXRhZ3JpZENvbXBvbmVudCB9IGZyb20gJ0BmYXJyaXMvdWktZGF0YWdyaWQnO1xyXG5pbXBvcnQgeyBSdWxlRmlsZVR5cGUgfSBmcm9tICcuL1J1bGVGaWxlVHlwZSc7XHJcbmltcG9ydCB7IEh0dHBDbGllbnQgfSBmcm9tICdAYW5ndWxhci9jb21tb24vaHR0cCc7XHJcbmltcG9ydCB7RGF0YUlFVXRpbHMsIEZpbGVUeXBlVXRpbH0gZnJvbSAnLi4vc2VydmljZS9VdGlscy9EYXRhSUVVdGlscyc7XHJcbmltcG9ydCB7IE5vdGlmeVNlcnZpY2UgfSBmcm9tICdAZmFycmlzL3VpLW5vdGlmeSc7XHJcbmltcG9ydCB7QnNNb2RhbFNlcnZpY2V9IGZyb20gXCJAZmFycmlzL3VpLW1vZGFsXCI7XHJcbmltcG9ydCB7TGlzdERhdGFTZXJ2aWNlfSBmcm9tIFwiQGZhcnJpcy9jb21tYW5kLXNlcnZpY2VzXCI7XHJcbmltcG9ydCB7TWVzc2FnZXJTZXJ2aWNlfSBmcm9tIFwiQGZhcnJpcy91aS1tZXNzYWdlclwiO1xyXG5pbXBvcnQge0V4dGVuZENvbXBvbmVudDFDb21wb25lbnR9IGZyb20gJy4uL2Jha2NvbXBvbmVudHMvZXh0ZW5kLWNvbXBvbmVudDEvZXh0ZW5kLWNvbXBvbmVudDEuY29tcG9uZW50JztcclxuXHJcbkBDb21wb25lbnQoe1xyXG4gIHNlbGVjdG9yOiAndGhkLXJ1bGUtc2VsZWN0JyxcclxuICB0ZW1wbGF0ZVVybDogJy4vcnVsZS1zZWxlY3QuY29tcG9uZW50Lmh0bWwnLFxyXG4gIHN0eWxlVXJsczogWycuL3J1bGUtc2VsZWN0LmNvbXBvbmVudC5jc3MnXVxyXG59KVxyXG5leHBvcnQgY2xhc3MgUnVsZVNlbGVjdENvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCB7XHJcbiAgQFZpZXdDaGlsZCgnUnVsZU1ncnNHcmlkJykgUnVsZU1ncnNHcmlkOiBEYXRhZ3JpZENvbXBvbmVudDtcclxuICBAVmlld0NoaWxkKCdzZWxlY3RGb290ZXInKSBtb2RhbEZvb3RlcjogVGVtcGxhdGVSZWY8YW55PjtcclxuICBAVmlld0NoaWxkKCdjb2x1bW5PcGVyYXRpb24nKSBjb2x1bW5PcGVyYXRpb246IFRlbXBsYXRlUmVmPGFueT47XHJcbiAgQE91dHB1dCgpIGNsb3NlTW9kYWwgPSBuZXcgRXZlbnRFbWl0dGVyPGFueT4oKTtcclxuICBAT3V0cHV0KCkgb2tNb2RhbCA9IG5ldyBFdmVudEVtaXR0ZXI8YW55PigpO1xyXG4gIC8vIOinhOWImUlEIOivpWlk5Li66KGo5Y2V5LiK6YWN572u55qE6KeE5YiZaWRcclxuICBydWxlSWQgPSAnJztcclxuICB2b0lkID0gJyc7XHJcbiAgcnVsZVR5cGU6IGFueTtcclxuXHJcbiAgUnVsZU1ncnNEYXRhID0gW107XHJcbiAgZmlsZVR5cGVzID0gW1xyXG4gICAgeyBsYWJlbDogJ09mZmljZSBFeGNlbDk3LTIwMDMoKi54bHMpJywgdmFsdWU6IFJ1bGVGaWxlVHlwZVswXSB9LFxyXG4gICAgeyBsYWJlbDogJ09mZmljZSBFeGNlbCBNYWNybygqLnhsc20pJywgdmFsdWU6IFJ1bGVGaWxlVHlwZVsxXSB9LFxyXG4gICAgeyBsYWJlbDogJ09mZmljZSBFeGNlbCgqLnhsc3gpJywgdmFsdWU6IFJ1bGVGaWxlVHlwZVsyXSB9LFxyXG4gICAgeyBsYWJlbDogJ1dQUyBUYWJsZSgqLmV0KScsIHZhbHVlOiBSdWxlRmlsZVR5cGVbM10gfSxcclxuICAgIHsgbGFiZWw6ICdXUFMgVGFibGUoVGVtcGxhdGUgRmlsZSkoKi5ldHQpJywgdmFsdWU6IFJ1bGVGaWxlVHlwZVs0XSB9LFxyXG4gICAgeyBsYWJlbDogJ1hNTCBUYWJsZSgqLnhtbCknLCB2YWx1ZTogUnVsZUZpbGVUeXBlWzVdIH0sXHJcbiAgICB7IGxhYmVsOiAnUERGIEZpbGUoKi5wZGYpJywgdmFsdWU6IFJ1bGVGaWxlVHlwZVs2XSB9LFxyXG4gICAgeyBsYWJlbDogJ0NTViBGaWxlKCouY3N2KScsIHZhbHVlOiBSdWxlRmlsZVR5cGVbN10gfVxyXG4gIF07XHJcbiAgUnVsZU1ncnNDb2x1bW5zID0gW107XHJcblxyXG4gIGkxOG5SZXNvdWNlOmFueTtcclxuICBpZV9jYW5jZWw6IHN0cmluZztcclxuICBpZV9vazogc3RyaW5nO1xyXG4gIHJ1bGVzZWxlY3RfY29kZTogc3RyaW5nO1xyXG4gIHJ1bGVzZWxlY3RfbmFtZTogc3RyaW5nO1xyXG4gIHJ1bGVzZWxlY3RfcnVsZXNvdXJjZTogc3RyaW5nO1xyXG4gIHJ1bGVzZWxlY3Rfc3lzcHJlc2V0OiBzdHJpbmc7XHJcbiAgcnVsZXNlbGVjdF9jdXN0b206IHN0cmluZztcclxuICBydWxlc2VsZWN0X2JpbGxjYXRlZ29yeTogc3RyaW5nO1xyXG4gIHJ1bGVzZWxlY3RfY3JlYXRvcjogc3RyaW5nO1xyXG4gIHJ1bGVzZWxlY3RfZmlsZXR5cGU6IHN0cmluZztcclxuICBydWxlc2VsZWN0X3NlbGVjdHJ1bGVub3RpZnk6IHN0cmluZztcclxuICBydWxlc2VsZWN0X3VwZGF0ZXRpbWU6c3RyaW5nO1xyXG4gIGNvbnN0cnVjdG9yKFxyXG4gICAgcHJpdmF0ZSBodHRwOiBIdHRwQ2xpZW50LFxyXG4gICAgcHJpdmF0ZSBub3RpZnk6IE5vdGlmeVNlcnZpY2UsXHJcbiAgICBwcml2YXRlIGluamVjdG9yOiBJbmplY3RvcixcclxuICAgIHByaXZhdGUgbW9kYWxTZXJ2aWNlOiBCc01vZGFsU2VydmljZSxcclxuICAgIHByaXZhdGUgbXNnU2VydmljZTogTWVzc2FnZXJTZXJ2aWNlLFxyXG4gICAgcHJpdmF0ZSByZXNvbHZlcjogQ29tcG9uZW50RmFjdG9yeVJlc29sdmVyXHJcbiAgKSB7XHJcbiAgICBEYXRhSUVVdGlscy5nZXRUcmFuc2xhdGVWYWx1ZShodHRwKS5zdWJzY3JpYmUocmVzID0+IHtcclxuICAgICAgdGhpcy5pMThuUmVzb3VjZSA9IHJlcztcclxuICAgICAgdGhpcy5pZV9jYW5jZWwgPSByZXNbJ2llX2NhbmNlbCddO1xyXG4gICAgICB0aGlzLmllX29rID0gcmVzWydpZV9vayddO1xyXG4gICAgICB0aGlzLnJ1bGVzZWxlY3RfY29kZSA9IHJlc1sncnVsZXNlbGVjdF9jb2RlJ107XHJcbiAgICAgIHRoaXMucnVsZXNlbGVjdF9uYW1lID0gcmVzWydydWxlc2VsZWN0X25hbWUnXTtcclxuICAgICAgdGhpcy5ydWxlc2VsZWN0X3J1bGVzb3VyY2UgPSByZXNbJ3J1bGVzZWxlY3RfcnVsZXNvdXJjZSddO1xyXG4gICAgICB0aGlzLnJ1bGVzZWxlY3RfY3VzdG9tID0gcmVzWydydWxlc2VsZWN0X2N1c3RvbSddO1xyXG4gICAgICB0aGlzLnJ1bGVzZWxlY3Rfc3lzcHJlc2V0ID0gcmVzWydydWxlc2VsZWN0X3N5c3ByZXNldCddO1xyXG4gICAgICB0aGlzLnJ1bGVzZWxlY3RfYmlsbGNhdGVnb3J5ID0gcmVzWydydWxlc2VsZWN0X2JpbGxjYXRlZ29yeSddO1xyXG4gICAgICB0aGlzLnJ1bGVzZWxlY3RfY3JlYXRvciA9IHJlc1sncnVsZXNlbGVjdF9jcmVhdG9yJ107XHJcbiAgICAgIHRoaXMucnVsZXNlbGVjdF9maWxldHlwZSA9IHJlc1sncnVsZXNlbGVjdF9maWxldHlwZSddO1xyXG4gICAgICB0aGlzLnJ1bGVzZWxlY3Rfc2VsZWN0cnVsZW5vdGlmeSA9IHJlc1sncnVsZXNlbGVjdF9zZWxlY3RydWxlbm90aWZ5J107XHJcbiAgICAgIHRoaXMucnVsZXNlbGVjdF91cGRhdGV0aW1lID0gcmVzWydydWxlc2VsZWN0X3VwZGF0ZXRpbWUnXTtcclxuXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIG5nT25Jbml0KCkge1xyXG4gICAgY29uc3QgcnVsZVNvdXJjZVR5cGUgPSBbXHJcbiAgICAgIHtsYWJlbDp0aGlzLmkxOG5SZXNvdWNlWydwcm9kdWN0X3ByZXNldCddLHZhbHVlOidQcm9kdWN0UHJlc2V0J30sXHJcbiAgICAgIHtsYWJlbDp0aGlzLmkxOG5SZXNvdWNlWydwcm9qZWN0X2RlZmluZSddLHZhbHVlOidQcm9qZWN0RGVmaW5lJ30sXHJcbiAgICAgIHtsYWJlbDp0aGlzLmkxOG5SZXNvdWNlWyd1c2VyX2N1c3RvbSddLHZhbHVlOidVc2VyQ3VzdG9tJ31cclxuICAgIF07XHJcbiAgICB0aGlzLlJ1bGVNZ3JzQ29sdW1ucyA9IFtcclxuICAgICAgeyBmaWVsZDogJ2NvZGUnLCB3aWR0aDogMTgwLCB0aXRsZTogdGhpcy5ydWxlc2VsZWN0X2NvZGUsIHNob3dUaXBzOiB0cnVlLCBoYWxpZ246ICdjZW50ZXInLCBhbGlnbjogJ2NlbnRlcicsIHNvcnRhYmxlOiB0cnVlIH0sXHJcbiAgICAgIHsgZmllbGQ6ICduYW1lJywgd2lkdGg6IDE4MCwgdGl0bGU6IHRoaXMucnVsZXNlbGVjdF9uYW1lLCBzaG93VGlwczogdHJ1ZSwgaGFsaWduOiAnY2VudGVyJywgYWxpZ246ICdjZW50ZXInLCBzb3J0YWJsZTogdHJ1ZSB9LFxyXG4gICAgICAvLyB7XHJcbiAgICAgIC8vICAgZmllbGQ6ICdydWxlU291cmNlVHlwZScsIHdpZHRoOiAxMDAsIHRpdGxlOiB0aGlzLnJ1bGVzZWxlY3RfcnVsZXNvdXJjZSwgc2hvd1RpcHM6IHRydWUsIGhhbGlnbjogJ2NlbnRlcicsIGFsaWduOiAnY2VudGVyJywgc29ydGFibGU6IHRydWUsXHJcbiAgICAgIC8vICAgZm9ybWF0dGVyOiB7IHR5cGU6ICdlbnVtJywgb3B0aW9uczogeyB2YWx1ZUZpZWxkOiAndmFsdWUnLCB0ZXh0RmllbGQ6ICdsYWJlbCcsIGRhdGE6IHJ1bGVTb3VyY2VUeXBlIH0gfVxyXG4gICAgICAvLyB9LFxyXG4gICAgICB7XHJcbiAgICAgICAgZmllbGQ6ICdzeXNQcmVzZXQnLCB3aWR0aDogMTAwLCB0aXRsZTogdGhpcy5ydWxlc2VsZWN0X3J1bGVzb3VyY2UsIGhhbGlnbjogJ2NlbnRlcicsIGFsaWduOiAnY2VudGVyJywgc29ydGFibGU6IHRydWUsXHJcbiAgICAgICAgZm9ybWF0dGVyOiB7IHR5cGU6ICdib29sZWFuJywgb3B0aW9uczogeyB0cnVlVGV4dDogdGhpcy5ydWxlc2VsZWN0X3N5c3ByZXNldCwgZmFsc2VUZXh0OiB0aGlzLnJ1bGVzZWxlY3RfY3VzdG9tIH0gfVxyXG4gICAgICB9LFxyXG5cclxuICAgICAgLy8geyBmaWVsZDogJ2JpekVudGl0eU5hbWUnLCB3aWR0aDogMTUwLCB0aXRsZTogJ+aVsOaNruWunuS9kycsIGhhbGlnbjogJ2NlbnRlcicsIGFsaWduOiAnY2VudGVyJywgc29ydGFibGU6IHRydWUgfSxcclxuICAgICAge1xyXG4gICAgICAgIGZpZWxkOiAnZmlsZVR5cGUnLCB3aWR0aDogMTgwLCB0aXRsZTogdGhpcy5ydWxlc2VsZWN0X2ZpbGV0eXBlLCBzaG93VGlwczogdHJ1ZSwgaGFsaWduOiAnY2VudGVyJywgYWxpZ246ICdjZW50ZXInLCBzb3J0YWJsZTogdHJ1ZSxcclxuICAgICAgICBmb3JtYXR0ZXI6IHsgdHlwZTogJ2VudW0nLCBvcHRpb25zOiB7IHZhbHVlRmllbGQ6ICd2YWx1ZScsIHRleHRGaWVsZDogJ2xhYmVsJywgZGF0YTogdGhpcy5maWxlVHlwZXMgfSB9XHJcbiAgICAgIH0sXHJcbiAgICAgIHsgZmllbGQ6ICdsYXN0TW9kaWZpZWRUaW1lJywgd2lkdGg6IDE1MCwgdGl0bGU6IHRoaXMucnVsZXNlbGVjdF91cGRhdGV0aW1lLCBzaG93VGlwczogdHJ1ZSwgaGFsaWduOiAnY2VudGVyJywgYWxpZ246ICdjZW50ZXInLCBzb3J0YWJsZTogdHJ1ZSB9XHJcblxyXG4gICAgICAvLyB7XHJcbiAgICAgIC8vICAgZmllbGQ6ICdvcGVyYXRpb24nLFxyXG4gICAgICAvLyAgIHdpZHRoOiAxMzAsXHJcbiAgICAgIC8vICAgaGFsaWduOiAnY2VudGVyJyxcclxuICAgICAgLy8gICBhbGlnbjogJ2NlbnRlcicsXHJcbiAgICAgIC8vICAgdGl0bGU6IHRoaXMuaTE4blJlc291Y2VbJ29wZXJhdGlvbiddLFxyXG4gICAgICAvLyAgIHRlbXBsYXRlOiB0aGlzLmNvbHVtbk9wZXJhdGlvblxyXG4gICAgICAvLyB9XHJcbiAgICAgIC8vIHsgZmllbGQ6ICdjcmVhdG9yJywgd2lkdGg6IDE1MCwgdGl0bGU6IHRoaXMucnVsZXNlbGVjdF9jcmVhdG9yLCBoYWxpZ246ICdjZW50ZXInLCBhbGlnbjogJ2NlbnRlcicsIHNvcnRhYmxlOiB0cnVlIH1cclxuICAgIF07XHJcbiAgfVxyXG5cclxuICBjcmVhdGVSdWxlRXh0ZW5kKGN0eCl7XHJcbiAgICBjb25zdCB1cmwgPSAnL2FwaS9ydW50aW1lL2RpcC92MS4wL2RhdGFJZVJ1bGVNYW5hZ2UvY3JlYXRlUnVsZUV4dGVuZEluZm8vJyArIGN0eC5yb3dEYXRhLmlkO1xyXG4gICAgdGhpcy5odHRwLmdldCh1cmwpLnN1YnNjcmliZShyZXM9PntcclxuICAgICAgY29uc3QgY29tcEZhY3RvcnkgPSB0aGlzLnJlc29sdmVyLnJlc29sdmVDb21wb25lbnRGYWN0b3J5KEV4dGVuZENvbXBvbmVudDFDb21wb25lbnQpO1xyXG4gICAgICBjb25zdCBjb21wUmVmID0gY29tcEZhY3RvcnkuY3JlYXRlKHRoaXMuaW5qZWN0b3IpO1xyXG4gICAgICBjb21wUmVmLmluc3RhbmNlLmRhdGFJZVJ1bGVFeHRlbmRPcmlnaW5hbCA9IHJlcztcclxuICAgICAgY29uc3QgbW9kYWxDb25maWcgPSB7XHJcbiAgICAgICAgdGl0bGU6ICflr7zlhaXmqKHmnb/phY3nva4nLFxyXG4gICAgICAgIHdpZHRoOiA3NTAsXHJcbiAgICAgICAgaGVpZ2h0OiA2NTAsXHJcbiAgICAgICAgYnV0dG9uczogY29tcFJlZi5pbnN0YW5jZS5tb2RhbEZvb3RlcixcclxuICAgICAgICBzaG93SGVhZGVyOiB0cnVlLFxyXG4gICAgICAgIHNob3dNYXhCdXR0b246IGZhbHNlLFxyXG4gICAgICAgIHNob3dCdXR0b25zOiB0cnVlXHJcbiAgICAgIH07XHJcbiAgICAgIGNvbnN0IGRpYWxvZyA9IHRoaXMubW9kYWxTZXJ2aWNlLnNob3coY29tcFJlZiwgbW9kYWxDb25maWcpO1xyXG4gICAgICBjb21wUmVmLmluc3RhbmNlLmNsb3NlTW9kYWwuc3Vic2NyaWJlKCgpID0+IHtcclxuICAgICAgICBkaWFsb2cuY2xvc2UoKTtcclxuICAgICAgfSlcclxuICAgICAgY29tcFJlZi5pbnN0YW5jZS5va01vZGFsLnN1YnNjcmliZShkYXRhSWVSdWxlRXh0ZW5kID0+IHtcclxuICAgICAgICBjb25zdCBpZHggPSB0aGlzLlJ1bGVNZ3JzRGF0YS5maW5kSW5kZXgoZT0+IGUuaWQgPT09IGRhdGFJZVJ1bGVFeHRlbmQuaWQpO1xyXG4gICAgICAgIGlmKGlkeCA+PSAwKXtcclxuICAgICAgICAgIHRoaXMuUnVsZU1ncnNEYXRhW2lkeF0gPSBkYXRhSWVSdWxlRXh0ZW5kO1xyXG4gICAgICAgICAgdGhpcy5SdWxlTWdyc0dyaWQucmVmcmVzaCgpO1xyXG4gICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgdGhpcy5SdWxlTWdyc0RhdGEucHVzaChkYXRhSWVSdWxlRXh0ZW5kKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZGlhbG9nLmNsb3NlKCk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSwgZXJyb3IgPT4ge1xyXG4gICAgICB0aGlzLm5vdGlmeS5lcnJvcihlcnJvci5lcnJvci5NZXNzYWdlKTtcclxuICAgICAgY29uc29sZS5sb2coZXJyb3IuZXJyb3IuTWVzc2FnZSk7XHJcbiAgICB9KTtcclxuICB9XHJcbiAgdXBkYXRlUnVsZShjdHgpe1xyXG5cclxuICB9XHJcbiAgZGVsZXRlUnVsZShjdHgpe1xyXG5cclxuICB9XHJcblxyXG5cclxuICBva0hhbmRsZXIoKSB7XHJcbiAgICBjb25zdCBzZWxlY3RlZFJvdyA9IHRoaXMuUnVsZU1ncnNHcmlkLnNlbGVjdGVkUm93O1xyXG4gICAgaWYgKHNlbGVjdGVkUm93ID09PSBudWxsKSB7XHJcbiAgICAgIHRoaXMubm90aWZ5LmluZm8odGhpcy5ydWxlc2VsZWN0X3NlbGVjdHJ1bGVub3RpZnkpO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBjb25zdCB1cmwgPSAnL2FwaS9ydW50aW1lL2RpcC92MS4wL2RhdGFJZVJ1bGVNYW5hZ2UvdXBkYXRlQ29uZmlnUnVsZSc7XHJcbiAgICBjb25zdCBib2R5ID0ge1xyXG4gICAgICBydWxlSWQ6IHRoaXMucnVsZUlkLFxyXG4gICAgICB2b0lkOiB0aGlzLnZvSWQsXHJcbiAgICAgIHJ1bGVUeXBlOiB0aGlzLnJ1bGVUeXBlLFxyXG4gICAgICBjdXJyZW50UnVsZUlkOiBzZWxlY3RlZFJvdy5pZFxyXG4gICAgfVxyXG4gICAgdGhpcy5odHRwLnBvc3QodXJsLCBib2R5KS5zdWJzY3JpYmUoKHJlczphbnkpID0+IHtcclxuICAgICAgY29uc29sZS5sb2cocmVzLm1lc3NhZ2UpO1xyXG4gICAgICB0aGlzLm9rTW9kYWwuZW1pdChzZWxlY3RlZFJvdy5kYXRhKTtcclxuICAgIH0sIGVycm9yID0+IHtcclxuICAgICAgdGhpcy5ub3RpZnkuZXJyb3IoZXJyb3IuZXJyb3IuTWVzc2FnZSk7XHJcbiAgICAgIGNvbnNvbGUubG9nKGVycm9yLmVycm9yLk1lc3NhZ2UpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG4gIGNhbmNlbEhhbmRsZXIoKSB7XHJcbiAgICB0aGlzLmNsb3NlTW9kYWwuZW1pdCgpO1xyXG4gIH1cclxuXHJcbn1cclxuIl19