{"version":3,"file":"DataObject.js","sourceRoot":"","sources":["../../../../src/lib/model/DataObject.ts"],"names":[],"mappings":"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","sourcesContent":["import { BpmnModel } from \"./BpmnModel\";\r\nimport { BpmnModelHelper } from \"./BpmnModelHelper\";\r\nimport { ExtensionElement } from \"./ExtensionElement\";\r\nimport { FlowElement } from \"./FlowElement\";\r\nimport { IVariableElement } from \"./IVariableElement\";\r\nimport { DataType } from \"./mex/DataType\";\r\nimport { ValidationError } from \"./ValidationError\";\r\nimport { ValidationLevel } from \"./ValidationLevel\";\r\n\r\nexport class DataObject extends FlowElement implements IVariableElement {\r\n    clone(): DataObject {\r\n        const clone = super.clone() as DataObject;\r\n        clone.DataType = this.DataType;\r\n        clone.IsAllowNull = this.IsAllowNull;\r\n        clone.IsCollection = this.IsCollection;\r\n\r\n        return clone;\r\n    }\r\n\r\n    constructor(model: BpmnModel) {\r\n        super(model);\r\n\r\n        this.IsAllowNull = true;\r\n        this.IsCollection = false;\r\n    }\r\n\r\n    readonly ClrTypeID: string = \"bpmn.DataObject\";\r\n\r\n    NewInstance(): DataObject {\r\n        return new DataObject(this.Model);\r\n    }\r\n\r\n    DataType: DataType;\r\n    IsAllowNull: boolean;\r\n    IsCollection: boolean;\r\n\r\n    protected ResetBeforeLoadFrom(): void {\r\n        super.ResetBeforeLoadFrom();\r\n\r\n        this.DataType = null;\r\n        this.IsAllowNull = true;\r\n        this.IsCollection = false;\r\n    }\r\n\r\n    ConvertToJsonObject(): any {\r\n        let obj = super.ConvertToJsonObject();\r\n\r\n        BpmnModelHelper.SetAttributeValue(obj, \"IsAllowNull\", this.IsAllowNull);\r\n        BpmnModelHelper.SetAttributeValue(obj, \"IsCollection\", this.IsCollection);\r\n\r\n        return obj;\r\n    }\r\n\r\n    LoadFromJsonObject(obj: any): void {\r\n        super.LoadFromJsonObject(obj);\r\n\r\n        this.IsAllowNull = obj.IsAllowNull;\r\n        this.IsCollection = obj.IsCollection;\r\n    }\r\n\r\n    private readonly MEXTAG: string = \"bpmn.DataObject\";\r\n\r\n    protected GetExtensionElements4ConvertTo(): Array<ExtensionElement> {\r\n        let list: Array<ExtensionElement> = super.GetExtensionElements4ConvertTo();\r\n\r\n        if (this.DataType != null) {\r\n            this.DataType.MexTag = this.MEXTAG;\r\n            list.push(this.DataType);\r\n        }\r\n\r\n        return list;\r\n    }\r\n\r\n    protected SetExtensionElements4LoadFrom(extensionElements: Array<ExtensionElement>): void {\r\n        super.SetExtensionElements4LoadFrom(extensionElements);\r\n\r\n        for (let extensionElement of extensionElements) {\r\n            if (extensionElement instanceof DataType && extensionElement.MexTag == this.MEXTAG) {\r\n                this.DataType = extensionElement as DataType;\r\n            }\r\n        }\r\n    }\r\n\r\n    Validate(errors: Array<ValidationError>): void {\r\n        super.Validate(errors);\r\n\r\n        if (this.DataType != null) {\r\n            this.DataType.Validate(errors);\r\n        }\r\n        else {\r\n            let error = new ValidationError()\r\n            error.Element = this;\r\n            error.ErrorLevel = ValidationLevel.$_Error;\r\n            error.ErrorCode = \"\";\r\n            error.ErrorMessage = \"没有设定变量类型\";\r\n\r\n            errors.push(error);\r\n        }\r\n    }\r\n}"]}