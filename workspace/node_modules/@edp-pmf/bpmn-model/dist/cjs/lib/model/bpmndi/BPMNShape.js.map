{"version":3,"file":"BPMNShape.js","sourceRoot":"","sources":["../../../../../src/lib/model/bpmndi/BPMNShape.ts"],"names":[],"mappings":"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","sourcesContent":["import { BpmnModel } from \"../BpmnModel\";\r\nimport { BpmnModelHelper } from \"../BpmnModelHelper\";\r\nimport { ExtensionMethod } from \"../ExtensionMethod\";\r\nimport { PalUserTaskAttribute } from \"../mex/PalUserTaskAttribute\";\r\nimport { LabeledShape } from \"../omgdi/LabeledShape\";\r\nimport { ValidationError } from \"../ValidationError\";\r\nimport { ValidationLevel } from \"../ValidationLevel\";\r\nimport { BPMNLabel } from \"./BPMNLabel\";\r\n\r\nexport class BPMNShape extends LabeledShape {\r\n    constructor(model: BpmnModel) {\r\n        super(model);\r\n    }\r\n\r\n    ClrTypeID: string = \"bpmn.bpmndi.BPMNShape\";\r\n\r\n    NewInstance(): BPMNShape {\r\n        return new BPMNShape(this.Model);\r\n    }\r\n\r\n    BpmnElementId: string;\r\n    BpmnLabel: BPMNLabel;\r\n\r\n    static readonly MEXTAG = \"shape.bpa\"\r\n    // bpaAttribute: string;\r\n    palUserTaskAttribute: PalUserTaskAttribute;\r\n\r\n    protected ResetBeforeLoadFrom(): void {\r\n        super.ResetBeforeLoadFrom();\r\n\r\n        this.BpmnElementId = null;\r\n        this.BpmnLabel = null;\r\n    }\r\n\r\n    ConvertToJsonObject(): any {\r\n        let obj = super.ConvertToJsonObject();\r\n\r\n        BpmnModelHelper.SetAttributeValue(obj, \"BpmnElementId\", this.BpmnElementId);\r\n        if (this.BpmnLabel != null) {\r\n            BpmnModelHelper.SetAttributeValue(obj, \"BpmnLabel\", this.BpmnLabel.ConvertToJsonObject());\r\n        }\r\n\r\n        return obj;\r\n    }\r\n\r\n    LoadFromJsonObject(obj: any): void {\r\n        super.LoadFromJsonObject(obj);\r\n\r\n        this.BpmnElementId = obj.BpmnElementId;\r\n\r\n        if (obj.hasOwnProperty(\"BpmnLabel\")) {\r\n            this.BpmnLabel = new BPMNLabel(this.Model);\r\n            this.BpmnLabel.LoadFromJsonObject(obj.BpmnLabel);\r\n        }\r\n\r\n    }\r\n\r\n    LoadExtensionElements(extensionElementsObj: {}): void {\r\n        super.LoadExtensionElements(extensionElementsObj);\r\n\r\n        const palUserTaskAttributeObj = ExtensionMethod.GetAttributeValue(extensionElementsObj, \"palUserTaskAttribute\");\r\n        if (palUserTaskAttributeObj != null) {\r\n            this.palUserTaskAttribute = new PalUserTaskAttribute(this.Model);\r\n            this.palUserTaskAttribute.LoadFromJsonObject(palUserTaskAttributeObj);\r\n        }\r\n    }\r\n\r\n    WriteExtensionElements(extensionElementsObj: {}): void {\r\n        super.WriteExtensionElements(extensionElementsObj);\r\n\r\n        if (this.palUserTaskAttribute != null) {\r\n            ExtensionMethod.SetAttributeValue(extensionElementsObj, \"palUserTaskAttribute\", this.palUserTaskAttribute.ConvertToJsonObject());\r\n        }\r\n    }\r\n\r\n    Validate(errors: Array<ValidationError>): void {\r\n        super.Validate(errors);\r\n\r\n        if (this.Model.GetHasIdElement(this.BpmnElementId) == null) {\r\n            let error: ValidationError = new ValidationError();\r\n            error.Element = this;\r\n            error.ErrorLevel = ValidationLevel.$_Error;\r\n            error.ErrorCode = \"\";\r\n            error.ErrorMessage = `找不到 id 为 ${this.BpmnElementId} 的元素`;\r\n\r\n            errors.push(error);\r\n        }\r\n    }\r\n}"]}