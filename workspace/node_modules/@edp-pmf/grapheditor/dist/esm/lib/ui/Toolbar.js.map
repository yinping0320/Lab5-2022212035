{"version":3,"file":"Toolbar.js","sourceRoot":"","sources":["../../../../src/lib/ui/Toolbar.ts"],"names":[],"mappings":"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","sourcesContent":["import { Action } from \"../action/Action\";\r\nimport { mxClient, mxResources, mxEvent, mxUtils, mxPopupMenu, MxGraphNS } from \"@edp-pmf/mxgraph-ts\";\r\nimport { ToolbarButton } from \"../toolbar/ToolbarButton\";\r\nimport { ToolbarDropDownButton } from \"../toolbar/ToolbarDropDownButton\";\r\nimport { ToolbarDropDownMenuItem } from \"../toolbar/ToolbarDropDownMenuItem\";\r\nimport { ToolbarItemDisplayStyle } from \"../toolbar/ToolbarItemDisplayStyle\";\r\nimport { ToolbarItems } from \"../toolbar/ToolbarItems\";\r\nimport { ToolbarMenuItem } from \"../toolbar/ToolbarMenuItem\";\r\nimport { ToolbarSeparator } from \"../toolbar/ToolbarSeparator\";\r\nimport { Constant } from \"../util/Constant\";\r\nimport { PmfEvents } from \"../util/PmfEvents\";\r\nimport { ResourceKeys } from \"../util/ResourceKeys\";\r\nimport { IEditorUi } from \"./IEditorUi\";\r\n\r\n/**\r\n * 工具栏\r\n */\r\nexport class Toolbar {\r\n    dropdownImage = (!mxClient.IS_SVG) ? Constant.IMAGE_PATH + '/dropdown.gif' : 'data:image/gif;base64,R0lGODlhDQANAIABAHt7e////yH/C1hNUCBEYXRhWE1QPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS4wLWMwNjAgNjEuMTM0Nzc3LCAyMDEwLzAyLzEyLTE3OjMyOjAwICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpCREM1NkJFMjE0NEMxMUU1ODk1Q0M5MjQ0MTA4QjNDMSIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDpCREM1NkJFMzE0NEMxMUU1ODk1Q0M5MjQ0MTA4QjNDMSI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkQzOUMzMjZCMTQ0QjExRTU4OTVDQzkyNDQxMDhCM0MxIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkQzOUMzMjZDMTQ0QjExRTU4OTVDQzkyNDQxMDhCM0MxIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+Af/+/fz7+vn49/b19PPy8fDv7u3s6+rp6Ofm5eTj4uHg397d3Nva2djX1tXU09LR0M/OzczLysnIx8bFxMPCwcC/vr28u7q5uLe2tbSzsrGwr66trKuqqainpqWko6KhoJ+enZybmpmYl5aVlJOSkZCPjo2Mi4qJiIeGhYSDgoGAf359fHt6eXh3dnV0c3JxcG9ubWxramloZ2ZlZGNiYWBfXl1cW1pZWFdWVVRTUlFQT05NTEtKSUhHRkVEQ0JBQD8+PTw7Ojk4NzY1NDMyMTAvLi0sKyopKCcmJSQjIiEgHx4dHBsaGRgXFhUUExIREA8ODQwLCgkIBwYFBAMCAQAAIfkEAQAAAQAsAAAAAA0ADQAAAhGMj6nL3QAjVHIu6azbvPtWAAA7';\r\n\r\n    editorUi: IEditorUi;\r\n    container: HTMLDivElement;\r\n    currentElt: HTMLAnchorElement;\r\n\r\n    constructor(editorUi: IEditorUi, container: HTMLDivElement) {\r\n        this.container = container;\r\n        this.editorUi = editorUi;\r\n    }\r\n\r\n    public edgeShapeMenu: HTMLElement;\r\n    public edgeStyleMenu: HTMLElement;\r\n\r\n    /**\r\n     * 重置工具栏\r\n     * @param items \r\n     * @returns \r\n     */\r\n    reset(items: ToolbarItems) {\r\n        while (this.container.hasChildNodes()) {\r\n            this.container.removeChild(this.container.firstChild);\r\n        }\r\n        if (items == null) {\r\n            return;\r\n        }\r\n\r\n        items.itemList.forEach(item => {\r\n            if (item instanceof ToolbarButton) {\r\n                const elt = this.buildToolbarButton(item);\r\n                this.container.appendChild(elt);\r\n                item.elt = elt;\r\n            }\r\n\r\n            if (item instanceof ToolbarDropDownButton) {\r\n                const elt = this.buildToolbarButton(item);\r\n                this.container.appendChild(elt);\r\n                item.elt = elt;\r\n            }\r\n\r\n            if (item instanceof ToolbarSeparator) {\r\n                const elt = this.addToolbarSeparator();\r\n                item.elt = elt;\r\n            }\r\n        });\r\n    }\r\n\r\n    destroy(): void {\r\n    }\r\n\r\n    /**\r\n     * 添加按钮\r\n     * @param item \r\n     * @returns \r\n     */\r\n    buildToolbarButton(item: ToolbarButton | ToolbarDropDownButton): HTMLAnchorElement {\r\n        let tooltip = item.toolTipText || mxResources.get(item.resourceKey) || \"\";\r\n        if (item instanceof ToolbarButton) {\r\n            let action = this.editorUi.actions.getAction(item.actionKey);\r\n            if (action != null && action.getShortcut() != null) {\r\n                tooltip += \" (\" + action.getShortcut() + \")\";\r\n            }\r\n        }\r\n\r\n        let btn = this.createToolbarButton(tooltip);\r\n\r\n        if (item.displayStyle == ToolbarItemDisplayStyle.ImageAndText || item.displayStyle == ToolbarItemDisplayStyle.Image) {\r\n            let btnImage = this.createToolbarButtonImage(item.imageSrc, item.imageClassName);\r\n            btn.appendChild(btnImage);\r\n        }\r\n\r\n        if (item.displayStyle == ToolbarItemDisplayStyle.ImageAndText || item.displayStyle == ToolbarItemDisplayStyle.Text) {\r\n            let btnText = this.createToolbarButtonText(item.text || mxResources.get(item.resourceKey));\r\n            btn.appendChild(btnText);\r\n\r\n            // 特殊情况处理\r\n            // 缩放按钮显示文本随实际比例变化\r\n            if (item.resourceKey == ResourceKeys.pmf_zoom) {\r\n                this.editorUi.graph.view.addListener(mxEvent.EVENT_SCALE, () => {\r\n                    btnText.innerText = Math.round(this.editorUi.graph.view.scale * 100) + '%';\r\n                });\r\n            }\r\n        }\r\n\r\n        if (item instanceof ToolbarButton) {\r\n            this.addToolbarButtonHandler(btn, item);\r\n        }\r\n\r\n        if (item instanceof ToolbarDropDownButton) {\r\n            let btnDropdownImage = this.createToolbarButtonDropdownImage();\r\n            btn.appendChild(btnDropdownImage);\r\n            this.addToolbarDropDownButtonHandler(btn, item);\r\n        }\r\n\r\n        return btn;\r\n    }\r\n\r\n    /**\r\n     * 添加分割线\r\n     * @param c \r\n     * @returns \r\n     */\r\n    addToolbarSeparator(c?: HTMLDivElement): HTMLDivElement {\r\n        c = (c != null) ? c : this.container;\r\n        let elt = document.createElement('div');\r\n        elt.className = 'geSeparator';\r\n        c.appendChild(elt);\r\n\r\n        return elt;\r\n    }\r\n\r\n    /**\r\n     * 创建按钮\r\n     * @param tooltip \r\n     * @returns \r\n     */\r\n    createToolbarButton(tooltip?: string): HTMLAnchorElement {\r\n        let elt = document.createElement('a');\r\n        elt.setAttribute('href', 'javascript:void(0);');\r\n        elt.className = 'geLabel';\r\n        elt.style.color = \"#000000\";\r\n\r\n        if (tooltip != null)\r\n            elt.title = tooltip;\r\n\r\n        return elt;\r\n    }\r\n\r\n    /**\r\n     * 创建按钮图片\r\n     * @param src \r\n     * @param className \r\n     * @returns \r\n     */\r\n    createToolbarButtonImage(src: string, className?: string): HTMLImageElement {\r\n        let elt = document.createElement('img');\r\n        elt.src = src;\r\n\r\n        if (className != null)\r\n            elt.className = className;\r\n\r\n        elt.style.display = \"inline-block\";\r\n        elt.style.verticalAlign = \"middle\";\r\n        return elt;\r\n    }\r\n\r\n    /**\r\n     * 创建按钮文字\r\n     * @param text \r\n     * @param className \r\n     * @returns \r\n     */\r\n    createToolbarButtonText(text: string, className?: string): HTMLDivElement {\r\n        let elt = document.createElement('div');\r\n        mxUtils.write(elt, text);\r\n\r\n        if (className != null)\r\n            elt.className = className;\r\n\r\n        elt.style.display = \"inline-block\";\r\n        elt.style.verticalAlign = \"middle\";\r\n        elt.style.paddingLeft = \"2px\";\r\n\r\n        return elt;\r\n    }\r\n\r\n    /**\r\n     * 创建下拉按钮图标\r\n     * @returns \r\n     */\r\n    createToolbarButtonDropdownImage(): HTMLImageElement {\r\n        let elt = document.createElement('img');\r\n        elt.src = this.dropdownImage;\r\n\r\n        elt.style.display = \"inline-block\";\r\n        elt.style.verticalAlign = \"middle\";\r\n        elt.style.paddingLeft = \"2px\";\r\n\r\n        return elt;\r\n    }\r\n\r\n    /**\r\n     * 添加按钮处理器\r\n     * @param elt \r\n     * @param item \r\n     * @returns \r\n     */\r\n    addToolbarButtonHandler(elt: HTMLAnchorElement, item: ToolbarButton): void {\r\n        const action = this.editorUi.actions.getAction(item.actionKey);\r\n        if (action == null) {\r\n            return;\r\n        }\r\n\r\n        mxEvent.addListener(elt, 'click', (evt: PointerEvent) => {\r\n            if (action != null && action.isEnabled()) {\r\n                action.execute(evt);\r\n            }\r\n\r\n            mxEvent.consume(evt);\r\n        });\r\n\r\n        if (document.documentMode != null && document.documentMode >= 9) {\r\n            mxEvent.addListener(elt, 'mousedown', (evt: PointerEvent) => {\r\n                evt.preventDefault();\r\n            });\r\n        }\r\n\r\n        const classname = elt.className;\r\n\r\n        elt.setEnabled = (value: boolean) => {\r\n            if (value) {\r\n                elt.className = classname;\r\n            }\r\n            else {\r\n                elt.className = classname + ' mxDisabled';\r\n            }\r\n        };\r\n\r\n        elt.setEnabled(action.isEnabled());\r\n\r\n        action.addListener(PmfEvents.StateChanged, () => {\r\n            elt.setEnabled(action.isEnabled());\r\n        });\r\n    }\r\n\r\n    /**\r\n     * 添加下拉按钮处理器\r\n     * @param elt \r\n     * @param item \r\n     * @param showLabels \r\n     * @param showDisabled \r\n     */\r\n    addToolbarDropDownButtonHandler(elt: HTMLAnchorElement, item: ToolbarDropDownButton, showLabels: boolean = true, showDisabled: boolean = true) {\r\n        let show: boolean = true;\r\n\r\n        const funct = (popupMenu: MxGraphNS.mxPopupMenu, cell: MxGraphNS.mxCell, evt: PointerEvent | MouseEvent) => {\r\n            this.addPopupMenuItems(popupMenu, item.items, popupMenu);\r\n        }\r\n\r\n        mxEvent.addListener(elt, 'click', (evt: PointerEvent) => {\r\n            if (show && (elt.enabled == null || elt.enabled)) {\r\n                this.editorUi.graph.popupMenuHandler.hideMenu();\r\n\r\n                let popupMenu: MxGraphNS.mxPopupMenu = new mxPopupMenu(funct);\r\n                popupMenu.div.className += ' geToolbarMenu';\r\n                popupMenu.showDisabled = showDisabled;\r\n                popupMenu.labels = showLabels;\r\n                popupMenu.autoExpand = true;\r\n\r\n                let offset = mxUtils.getOffset(elt);\r\n                popupMenu.popup(offset.x, offset.y + elt.offsetHeight, null, evt);\r\n                this.editorUi.setCurrentMenu(popupMenu, elt);\r\n\r\n                if (!showLabels && popupMenu.div.scrollHeight > popupMenu.div.clientHeight) {\r\n                    popupMenu.div.style.width = '40px';\r\n                }\r\n\r\n                popupMenu.hideMenu = () => {\r\n                    mxPopupMenu.prototype.hideMenu.apply(popupMenu);\r\n                    this.editorUi.resetCurrentMenu();\r\n                    popupMenu.destroy();\r\n                };\r\n            }\r\n\r\n            show = true;\r\n            mxEvent.consume(evt);\r\n        });\r\n\r\n        mxEvent.addListener(elt, 'mousedown', (evt: any) => {\r\n            show = this.currentElt != elt;\r\n\r\n            if (document.documentMode != null && document.documentMode >= 9) {\r\n                evt.preventDefault();\r\n            }\r\n        });\r\n    }\r\n\r\n    /**\r\n     * 添加弹出菜单项\r\n     * @param popupMenu \r\n     * @param items \r\n     * @param parent \r\n     */\r\n    addPopupMenuItems(popupMenu: MxGraphNS.mxPopupMenu,\r\n        items: Array<ToolbarMenuItem | ToolbarDropDownMenuItem | ToolbarSeparator>,\r\n        parent: MxGraphNS.mxPopupMenu | HTMLTableRowElement) {\r\n\r\n        items.forEach((item) => {\r\n            if (item instanceof ToolbarMenuItem) {\r\n                let action: Action = this.editorUi.actions.getAction(item.actionKey);\r\n                let row: HTMLTableRowElement = popupMenu.addItem(item.text || mxResources.get(item.resourceKey), null, (evt: PointerEvent) => {\r\n                    if (action != null && action.isEnabled()) {\r\n                        action.execute(evt);\r\n                    }\r\n                }, parent, null, action == null ? false : action.isEnabled());\r\n\r\n                if (action != null && action.isToggleAction() && action.isSelected()) {\r\n                    popupMenu.addCheckmark(row, Constant.CHECK_MARK_IMAGE);\r\n                }\r\n\r\n                this.addShortcut(row, action);\r\n                item.elt = row;\r\n            }\r\n\r\n            if (item instanceof ToolbarSeparator) {\r\n                popupMenu.addSeparator(parent);\r\n            }\r\n\r\n            if (item instanceof ToolbarDropDownMenuItem) {\r\n                let row: HTMLTableRowElement = popupMenu.addItem(item.text || mxResources.get(item.resourceKey), null, null, parent);\r\n                this.addPopupMenuItems(popupMenu, item.items, row);\r\n                item.elt = row;\r\n            }\r\n        });\r\n    }\r\n\r\n    /**\r\n     * 添加快捷键提示\r\n     * @param item \r\n     * @param action \r\n     */\r\n    addShortcut(item: HTMLTableRowElement, action: Action): void {\r\n        if (action != null && action.getShortcut() != null) {\r\n            let td = item.firstChild.nextSibling.nextSibling;\r\n            let span = document.createElement('span');\r\n            span.style.color = 'gray';\r\n            mxUtils.write(span, action.getShortcut());\r\n            td.appendChild(span);\r\n        }\r\n    }\r\n}"]}