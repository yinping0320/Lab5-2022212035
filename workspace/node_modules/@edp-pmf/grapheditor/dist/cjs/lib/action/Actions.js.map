{"version":3,"file":"Actions.js","sourceRoot":"","sources":["../../../../src/lib/action/Actions.ts"],"names":[],"mappings":"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","sourcesContent":["import { IEditorUi } from \"../ui/IEditorUi\";\r\nimport { Graph } from \"../ui/Graph\";\r\nimport { Action } from \"./Action\";\r\nimport { AboutAction } from \"./impl/AboutAction\";\r\nimport { AlignBottomAction } from \"./impl/AlignBottomAction\";\r\nimport { AlignCenterAction } from \"./impl/AlignCenterAction\";\r\nimport { AlignLeftAction } from \"./impl/AlignLeftAction\";\r\nimport { AlignMiddleAction } from \"./impl/AlignMiddleAction\";\r\nimport { AlignRightAction } from \"./impl/AlignRightAction\";\r\nimport { AlignTopAction } from \"./impl/AlignTopAction\";\r\nimport { AutosizeAction } from \"./impl/AutosizeAction\";\r\nimport { ClearWaypointsAction } from \"./impl/ClearWaypointsAction\";\r\nimport { CopyAction } from \"./impl/CopyAction\";\r\nimport { CutAction } from \"./impl/CutAction\";\r\nimport { DeleteAction } from \"./impl/DeleteAction\";\r\nimport { DistributeHorizontalAction } from \"./impl/DistributeHorizontalAction\";\r\nimport { DistributeVerticalAction } from \"./impl/DistributeVerticalAction\";\r\nimport { DuplicateAction } from \"./impl/DuplicateAction\";\r\nimport { FitWindowAction } from \"./impl/FitWindowAction\";\r\nimport { FormatPanelAction } from \"./impl/FormatPanelAction\";\r\nimport { HelpAction } from \"./impl/HelpAction\";\r\nimport { LockUnlockAction } from \"./impl/LockUnlockAction\";\r\nimport { OutlineAction } from \"./impl/OutlineAction\";\r\nimport { PasteAction } from \"./impl/PasteAction\";\r\nimport { RedoAction } from \"./impl/RedoAction\";\r\nimport { ResetViewAction } from \"./impl/ResetViewAction\";\r\nimport { SelectAllAction } from \"./impl/SelectAllAction\";\r\nimport { SelectEdgesAction } from \"./impl/SelectEdgesAction\";\r\nimport { SelectNoneAction } from \"./impl/SelectNoneAction\";\r\nimport { SelectVerticesAction } from \"./impl/SelectVerticesAction\";\r\nimport { ToBackAction } from \"./impl/ToBackAction\";\r\nimport { ToFrontAction } from \"./impl/ToFrontAction\";\r\nimport { UndoAction } from \"./impl/UndoAction\";\r\nimport { ViewGridAction } from \"./impl/ViewGridAction\";\r\nimport { View_100_Action } from \"./impl/View_100_Action\";\r\nimport { View_125_Action } from \"./impl/View_125_Action\";\r\nimport { View_150_Action } from \"./impl/View_150_Action\";\r\nimport { View_200_Action } from \"./impl/View_200_Action\";\r\nimport { View_25_Action } from \"./impl/View_25_Action\";\r\nimport { View_300_Action } from \"./impl/View_300_Action\";\r\nimport { View_400_Action } from \"./impl/View_400_Action\";\r\nimport { View_50_Action } from \"./impl/View_50_Action\";\r\nimport { View_75_Action } from \"./impl/View_75_Action\";\r\nimport { ZoomInAction } from \"./impl/ZoomInAction\";\r\nimport { ZoomOutAction } from \"./impl/ZoomOutAction\";\r\n\r\n/**\r\n * 动作列表类\r\n */\r\nexport class Actions {\r\n    editorUi: IEditorUi;\r\n    /**\r\n     * 动作字典\r\n     */\r\n    actionDic: { [key: string]: Action };\r\n\r\n    constructor(editorUi: IEditorUi) {\r\n        this.editorUi = editorUi;\r\n        this.actionDic = {};\r\n        this.init();\r\n    }\r\n\r\n    /**\r\n     * 添加动作\r\n     * @param action \r\n     */\r\n    addAction(action: Action): void {\r\n        this.actionDic[action.key] = action;\r\n\r\n        if (action.shortcutKeyCode != null) {\r\n            this.addShortcut(action.key, action.shortcutKeyCode, action.shortcutControlKey, action.shortcutShiftKey, action.shortcutAltKey);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 添加动作\r\n     */\r\n    addActions(...actions: Action[]): void {\r\n        actions && actions.forEach(action => {\r\n            this.addAction(action);\r\n        });\r\n    }\r\n\r\n    /**\r\n     * 根据key查找动作\r\n     * @param key \r\n     * @returns \r\n     */\r\n    getAction(key: string): Action {\r\n        return this.actionDic[key];\r\n    }\r\n\r\n    /**\r\n     * 删除动作\r\n     * @param key \r\n     * @returns \r\n     */\r\n    removeAction(key: string): Action {\r\n        const action = this.getAction(key);\r\n        if (action) {\r\n            delete this.actionDic[key];\r\n        }\r\n        return action;\r\n    }\r\n\r\n    /**\r\n     * 添加快捷键\r\n     * @param actionKey \r\n     * @param keyCode \r\n     * @param control \r\n     * @param shift \r\n     * @param alt \r\n     * @returns \r\n     */\r\n    addShortcut(actionKey: string, keyCode: number, control?: boolean, shift?: boolean, alt?: boolean): void {\r\n        const action = this.getAction(actionKey);\r\n\r\n        if (action == null) {\r\n            return;\r\n        }\r\n\r\n        const funct = (evt: KeyboardEvent) => {\r\n            if (action.isEnabled()) {\r\n                action.execute(evt);\r\n            }\r\n        };\r\n\r\n        this.editorUi.keyHandler && this.editorUi.keyHandler.bindAction(funct, keyCode, control, shift, alt);\r\n    }\r\n\r\n    /**\r\n     * 初始化\r\n     */\r\n    init(): void {\r\n        //Edit\r\n        this.addActions(\r\n            new UndoAction(this.editorUi),\r\n            new RedoAction(this.editorUi),\r\n            new CutAction(this.editorUi),\r\n            new CopyAction(this.editorUi),\r\n            new PasteAction(this.editorUi),\r\n            new DeleteAction(this.editorUi),\r\n            new DuplicateAction(this.editorUi),\r\n            new SelectVerticesAction(this.editorUi),\r\n            new SelectEdgesAction(this.editorUi),\r\n            new SelectAllAction(this.editorUi),\r\n            new SelectNoneAction(this.editorUi),\r\n            new LockUnlockAction(this.editorUi),\r\n        );\r\n\r\n        //View\r\n        this.addActions(\r\n            new FormatPanelAction(this.editorUi),\r\n            new OutlineAction(this.editorUi),\r\n\r\n            new ZoomInAction(this.editorUi),\r\n            new ZoomOutAction(this.editorUi),\r\n            new ResetViewAction(this.editorUi),\r\n            new View_25_Action(this.editorUi),\r\n            new View_50_Action(this.editorUi),\r\n            new View_75_Action(this.editorUi),\r\n            new View_100_Action(this.editorUi),\r\n            new View_125_Action(this.editorUi),\r\n            new View_150_Action(this.editorUi),\r\n            new View_200_Action(this.editorUi),\r\n            new View_300_Action(this.editorUi),\r\n            new View_400_Action(this.editorUi),\r\n            new FitWindowAction(this.editorUi),\r\n\r\n            new ViewGridAction(this.editorUi),\r\n        );\r\n\r\n        //Arrange\r\n        this.addActions(\r\n            new ToFrontAction(this.editorUi),\r\n            new ToBackAction(this.editorUi),\r\n            new AlignLeftAction(this.editorUi),\r\n            new AlignCenterAction(this.editorUi),\r\n            new AlignRightAction(this.editorUi),\r\n            new AlignTopAction(this.editorUi),\r\n            new AlignMiddleAction(this.editorUi),\r\n            new AlignBottomAction(this.editorUi),\r\n\r\n            new DistributeHorizontalAction(this.editorUi),\r\n            new DistributeVerticalAction(this.editorUi),\r\n\r\n            new ClearWaypointsAction(this.editorUi),\r\n            new AutosizeAction(this.editorUi),\r\n        );\r\n\r\n        //Help\r\n        this.addActions(\r\n            new HelpAction(this.editorUi),\r\n            new AboutAction(this.editorUi),\r\n        );\r\n    }\r\n\r\n    private isUnlocked(graph: Graph): boolean {\r\n        let unlocked = graph.isEnabled() && !graph.isCellLocked(graph.getDefaultParent());\r\n        return unlocked;\r\n    }\r\n\r\n    private isVertexSelected(graph: Graph): boolean {\r\n        let vertexSelected = false;\r\n\r\n        let cells = graph.getSelectionCells();\r\n\r\n        if (cells != null) {\r\n            for (let i = 0; i < cells.length; i++) {\r\n                let cell = cells[i];\r\n\r\n                if (graph.getModel().isVertex(cell)) {\r\n                    vertexSelected = true;\r\n                }\r\n\r\n                if (vertexSelected) {\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n\r\n        return vertexSelected;\r\n    }\r\n\r\n    private isEdgeSelected(graph: Graph): boolean {\r\n        let edgeSelected = false;\r\n\r\n        let cells = graph.getSelectionCells();\r\n\r\n        if (cells != null) {\r\n            for (let i = 0; i < cells.length; i++) {\r\n                let cell = cells[i];\r\n\r\n                if (graph.getModel().isEdge(cell)) {\r\n                    edgeSelected = true;\r\n                }\r\n\r\n                if (edgeSelected) {\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n\r\n        return edgeSelected;\r\n    }\r\n\r\n    private isAlignActionEnabled(graph: Graph): boolean {\r\n        return this.isUnlocked(graph) && this.isVertexSelected(graph) && graph.getSelectionCount() > 1;\r\n    }\r\n}"]}