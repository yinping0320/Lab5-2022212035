System.register(["@edp-pmf/mxgraph-ts","@edp-pmf/bpmn-model"],(function(e){"use strict";var t,i,n,o,r,l,a,s,d,u,h,c,p,f,g,m,y,C,w,v,E,b,S,_,I,T,A,x,L,M,P,U,D,N,O,B,k,G,R,H,F,K,z,V,W,Y,X,Z;return{setters:[function(e){t=e.mxEventObject,i=e.mxClient,n=e.mxEventSource,o=e.mxConstants,r=e.mxClipboard,l=e.mxWindow,a=e.mxResources,s=e.mxEvent,d=e.mxOutline,u=e.mxUtils,h=e.mxCell,c=e.mxGraphView,p=e.mxPoint,f=e.mxCodec,g=e.mxGeometry,m=e.mxRectangle,y=e.mxConstraintHandler,C=e.mxImage,w=e.mxShape,v=e.mxImageShape,E=e.mxConnectionConstraint,b=e.mxEdgeHandler,S=e.mxConnectionHandler,_=e.mxGraph,I=e.mxKeyHandler,T=e.mxPopupMenu,A=e.mxGuide,x=e.mxPolyline,L=e.mxRubberband},function(e){M=e.BpmnModelHelper,P=e.ExclusiveGateway,U=e.Activity,D=e.BPMNEdge,N=e.SequenceFlowLineType,O=e.RectangularLine,B=e.RectangularLineType,k=e.Point,G=e.BPMNLabel,R=e.Bounds,H=e.BPMNShape,F=e.FlowNodeState,K=e.InclusiveGateway,z=e.SequenceFlowState,V=e.BpmnModel,W=e.Process,Y=e.BPMNDiagram,X=e.Node,Z=e.Edge}],execute:function(){
/*! *****************************************************************************
            Copyright (c) Microsoft Corporation.

            Permission to use, copy, modify, and/or distribute this software for any
            purpose with or without fee is hereby granted.

            THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
            REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
            AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
            INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
            LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
            OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
            PERFORMANCE OF THIS SOFTWARE.
            ***************************************************************************** */
var j=function(e,t){return j=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},j(e,t)};function J(e,t){function i(){this.constructor=e}j(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}var Q,q=function(){return q=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},q.apply(this,arguments)};e("PmfEvents",Q),function(e){e.ResetGraphView="ResetGraphView",e.ResizeGraphView="ResizeGraphView",e.SelectionModelChanged="SelectionModelChanged",e.LockedChanged="LockedChanged",e.StateChanged="StateChanged",e.GridEnabledChanged="GridEnabledChanged",e.CellsInserted="CellsInserted",e.ShowProperty="ShowProperty",e.NameChanged="NameChanged"}(Q||e("PmfEvents",Q={}));var $,ee=["","","","CANCEL","","","HELP","","BACK_SPACE","TAB","","","CLEAR","Enter","ENTER_SPECIAL","","SHIFT","CONTROL","ALT","PAUSE","CAPS_LOCK","KANA","EISU","JUNJA","FINAL","HANJA","","Esc","CONVERT","NONCONVERT","ACCEPT","MODECHANGE","SPACE","PAGE_UP","PAGE_DOWN","END","HOME","Left","Up","Right","Down","SELECT","PRINT","EXECUTE","PRINTSCREEN","INSERT","Del","","0","1","2","3","4","5","6","7","8","9","COLON","SEMICOLON","LESS_THAN","EQUALS","GREATER_THAN","QUESTION_MARK","AT","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","OS_KEY","","CONTEXT_MENU","","SLEEP","NUMPAD0","NUMPAD1","NUMPAD2","NUMPAD3","NUMPAD4","NUMPAD5","NUMPAD6","NUMPAD7","NUMPAD8","NUMPAD9","MULTIPLY","ADD","SEPARATOR","SUBTRACT","DECIMAL","DIVIDE","F1","F2","F3","F4","F5","F6","F7","F8","F9","F10","F11","F12","F13","F14","F15","F16","F17","F18","F19","F20","F21","F22","F23","F24","","","","","","","","","NUM_LOCK","SCROLL_LOCK","WIN_OEM_FJ_JISHO","WIN_OEM_FJ_MASSHOU","WIN_OEM_FJ_TOUROKU","WIN_OEM_FJ_LOYA","WIN_OEM_FJ_ROYA","","","","","","","","","","CIRCUMFLEX","EXCLAMATION","DOUBLE_QUOTE","HASH","DOLLAR","PERCENT","AMPERSAND","UNDERSCORE","OPEN_PAREN","CLOSE_PAREN","ASTERISK","PLUS","PIPE","HYPHEN_MINUS","OPEN_CURLY_BRACKET","CLOSE_CURLY_BRACKET","TILDE","","","","","VOLUME_MUTE","VOLUME_DOWN","VOLUME_UP","","","SEMICOLON","=","COMMA","-","PERIOD","SLASH","BACK_QUOTE","","","","","","","","","","","","","","","","","","","","","","","","","","","OPEN_BRACKET","BACK_SLASH","CLOSE_BRACKET","QUOTE","","META","ALTGR","","WIN_ICO_HELP","WIN_ICO_00","","WIN_ICO_CLEAR","","","WIN_OEM_RESET","WIN_OEM_JUMP","WIN_OEM_PA1","WIN_OEM_PA2","WIN_OEM_PA3","WIN_OEM_WSCTRL","WIN_OEM_CUSEL","WIN_OEM_ATTN","WIN_OEM_FINISH","WIN_OEM_COPY","WIN_OEM_AUTO","WIN_OEM_ENLW","WIN_OEM_BACKTAB","ATTN","CRSEL","EXSEL","EREOF","PLAY","ZOOM","","PA1","WIN_OEM_CLEAR",""],te=e("Action",function(e){function n(t,i,n){var o=e.call(this)||this;return o.enabled=!0,o.toggleAction=!1,o.key=t,o.editorUi=i,o.enabled=null==n||n,o}return J(n,e),n.prototype.isEnabled=function(){return this.enabled},n.prototype.isToggleAction=function(){return this.toggleAction},n.prototype.isSelected=function(){return!1},n.prototype.setEnabled=function(e){var i=this.enabled;this.enabled=e,i!=e&&this.fireEvent(new t(Q.StateChanged))},n.prototype.getShortcut=function(){if(null==this.shortcutKeyCode)return null;var e=ee[this.shortcutKeyCode];return this.shortcutAltKey&&(e="Alt+"+e),this.shortcutShiftKey&&(e="Shift+"+e),this.shortcutControlKey&&(e=n.ctrlKey+"+"+e),e},n.prototype.setToggleAction=function(e){this.toggleAction=e},n.prototype.execute=function(e){},n.ctrlKey=i.IS_MAC?"Cmd":"Ctrl",n}(n));e("ActionKeys",$),function(e){e.pmf_save="pmf_save",e.pmf_saveAs="pmf_saveAs",e.wf_sync="wf_sync",e.wf_note="wf_note",e.wf_edit="wf_edit",e.pmf_export="pmf_export",e.pmf_undo="pmf_undo",e.pmf_redo="pmf_redo",e.pmf_cut="pmf_cut",e.pmf_copy="pmf_copy",e.pmf_paste="pmf_paste",e.pmf_pasteHere="pmf_pasteHere",e.pmf_delete="pmf_delete",e.pmf_deleteAll="pmf_deleteAll",e.pmf_duplicate="pmf_duplicate",e.pmf_selectVertices="pmf_selectVertices",e.pmf_selectEdges="pmf_selectEdges",e.pmf_selectAll="pmf_selectAll",e.pmf_selectNone="pmf_selectNone",e.pmf_lockUnlock="pmf_lockUnlock",e.pmf_formatPanel="pmf_formatPanel",e.pmf_outline="pmf_outline",e.pmf_layers="pmf_layers",e.pmf_pageView="pmf_pageView",e.pmf_grid="pmf_grid",e.pmf_connectionArrows="pmf_connectionArrows",e.pmf_connectionPoints="pmf_connectionPoints",e.pmf_resetView="pmf_resetView",e.pmf_zoomIn="pmf_zoomIn",e.pmf_zoomOut="pmf_zoomOut",e.pmf_view_25="pmf_view_25",e.pmf_view_50="pmf_view_50",e.pmf_view_75="pmf_view_75",e.pmf_view_100="pmf_view_100",e.pmf_view_125="pmf_view_125",e.pmf_view_150="pmf_view_150",e.pmf_view_200="pmf_view_200",e.pmf_view_300="pmf_view_300",e.pmf_view_400="pmf_view_400",e.pmf_fitWindow="pmf_fitWindow",e.pmf_fitPage="pmf_fitPage",e.pmf_fitTwoPages="pmf_fitTwoPages",e.pmf_fitPageWidth="pmf_fitPageWidth",e.pmf_customZoom="pmf_customZoom",e.pmf_toFront="pmf_toFront",e.pmf_toBack="pmf_toBack",e.pmf_leftAlign="pmf_leftAlign",e.pmf_center="pmf_center",e.pmf_rightAlign="pmf_rightAlign",e.pmf_topAlign="pmf_topAlign",e.pmf_middle="pmf_middle",e.pmf_bottomAlign="pmf_bottomAlign",e.pmf_horizontal="pmf_horizontal",e.pmf_vertical="pmf_vertical",e.pmf_clearWaypoints="pmf_clearWaypoints",e.pmf_autosize="pmf_autosize",e.pmf_help="pmf_help",e.pmf_about="pmf_about",e.pmf_viewModelXml="pmf_viewModelXml",e.pmf_release="pmf_release",e.pmf_closeDesigner="pmf_closeDesigner"}($||e("ActionKeys",$={}));var ie,ne=e("AboutAction",function(e){function t(t){return e.call(this,$.pmf_about,t,!0)||this}return J(t,e),t.prototype.execute=function(e){alert(this.key)},t}(te)),oe=e("AlignBottomAction",function(e){function t(t){var i=e.call(this,$.pmf_bottomAlign,t,!1)||this;return i.editorUi.addListener(Q.LockedChanged,(function(){i.setEnabled(i.isAlignActionEnabled(i.editorUi.graph))})),i.editorUi.addListener(Q.SelectionModelChanged,(function(){i.setEnabled(i.isAlignActionEnabled(i.editorUi.graph))})),i}return J(t,e),t.prototype.execute=function(e){this.editorUi.graph.alignCells(o.ALIGN_BOTTOM)},t.prototype.isAlignActionEnabled=function(e){return this.isUnlocked(e)&&this.isVertexSelected(e)&&e.getSelectionCount()>1},t.prototype.isUnlocked=function(e){return e.isEnabled()&&!e.isCellLocked(e.getDefaultParent())},t.prototype.isVertexSelected=function(e){var t=!1,i=e.getSelectionCells();if(null!=i)for(var n=0;n<i.length;n++){var o=i[n];if(e.getModel().isVertex(o)&&(t=!0),t)break}return t},t}(te)),re=e("AlignCenterAction",function(e){function t(t){var i=e.call(this,$.pmf_center,t,!1)||this;return i.editorUi.addListener(Q.LockedChanged,(function(){i.setEnabled(i.isAlignActionEnabled(i.editorUi.graph))})),i.editorUi.addListener(Q.SelectionModelChanged,(function(){i.setEnabled(i.isAlignActionEnabled(i.editorUi.graph))})),i}return J(t,e),t.prototype.execute=function(e){this.editorUi.graph.alignCells(o.ALIGN_CENTER)},t.prototype.isAlignActionEnabled=function(e){return this.isUnlocked(e)&&this.isVertexSelected(e)&&e.getSelectionCount()>1},t.prototype.isUnlocked=function(e){return e.isEnabled()&&!e.isCellLocked(e.getDefaultParent())},t.prototype.isVertexSelected=function(e){var t=!1,i=e.getSelectionCells();if(null!=i)for(var n=0;n<i.length;n++){var o=i[n];if(e.getModel().isVertex(o)&&(t=!0),t)break}return t},t}(te)),le=e("AlignLeftAction",function(e){function t(t){var i=e.call(this,$.pmf_leftAlign,t,!1)||this;return i.editorUi.addListener(Q.LockedChanged,(function(){i.setEnabled(i.isAlignActionEnabled(i.editorUi.graph))})),i.editorUi.addListener(Q.SelectionModelChanged,(function(){i.setEnabled(i.isAlignActionEnabled(i.editorUi.graph))})),i}return J(t,e),t.prototype.execute=function(e){this.editorUi.graph.alignCells(o.ALIGN_LEFT)},t.prototype.isAlignActionEnabled=function(e){return this.isUnlocked(e)&&this.isVertexSelected(e)&&e.getSelectionCount()>1},t.prototype.isUnlocked=function(e){return e.isEnabled()&&!e.isCellLocked(e.getDefaultParent())},t.prototype.isVertexSelected=function(e){var t=!1,i=e.getSelectionCells();if(null!=i)for(var n=0;n<i.length;n++){var o=i[n];if(e.getModel().isVertex(o)&&(t=!0),t)break}return t},t}(te)),ae=e("AlignMiddleAction",function(e){function t(t){var i=e.call(this,$.pmf_middle,t,!1)||this;return i.editorUi.addListener(Q.LockedChanged,(function(){i.setEnabled(i.isAlignActionEnabled(i.editorUi.graph))})),i.editorUi.addListener(Q.SelectionModelChanged,(function(){i.setEnabled(i.isAlignActionEnabled(i.editorUi.graph))})),i}return J(t,e),t.prototype.execute=function(e){this.editorUi.graph.alignCells(o.ALIGN_MIDDLE)},t.prototype.isAlignActionEnabled=function(e){return this.isUnlocked(e)&&this.isVertexSelected(e)&&e.getSelectionCount()>1},t.prototype.isUnlocked=function(e){return e.isEnabled()&&!e.isCellLocked(e.getDefaultParent())},t.prototype.isVertexSelected=function(e){var t=!1,i=e.getSelectionCells();if(null!=i)for(var n=0;n<i.length;n++){var o=i[n];if(e.getModel().isVertex(o)&&(t=!0),t)break}return t},t}(te)),se=e("AlignRightAction",function(e){function t(t){var i=e.call(this,$.pmf_rightAlign,t,!1)||this;return i.editorUi.addListener(Q.LockedChanged,(function(){i.setEnabled(i.isAlignActionEnabled(i.editorUi.graph))})),i.editorUi.addListener(Q.SelectionModelChanged,(function(){i.setEnabled(i.isAlignActionEnabled(i.editorUi.graph))})),i}return J(t,e),t.prototype.execute=function(e){this.editorUi.graph.alignCells(o.ALIGN_RIGHT)},t.prototype.isAlignActionEnabled=function(e){return this.isUnlocked(e)&&this.isVertexSelected(e)&&e.getSelectionCount()>1},t.prototype.isUnlocked=function(e){return e.isEnabled()&&!e.isCellLocked(e.getDefaultParent())},t.prototype.isVertexSelected=function(e){var t=!1,i=e.getSelectionCells();if(null!=i)for(var n=0;n<i.length;n++){var o=i[n];if(e.getModel().isVertex(o)&&(t=!0),t)break}return t},t}(te)),de=e("AlignTopAction",function(e){function t(t){var i=e.call(this,$.pmf_topAlign,t,!1)||this;return i.editorUi.addListener(Q.LockedChanged,(function(){i.setEnabled(i.isAlignActionEnabled(i.editorUi.graph))})),i.editorUi.addListener(Q.SelectionModelChanged,(function(){i.setEnabled(i.isAlignActionEnabled(i.editorUi.graph))})),i}return J(t,e),t.prototype.execute=function(e){this.editorUi.graph.alignCells(o.ALIGN_TOP)},t.prototype.isAlignActionEnabled=function(e){return this.isUnlocked(e)&&this.isVertexSelected(e)&&e.getSelectionCount()>1},t.prototype.isUnlocked=function(e){return e.isEnabled()&&!e.isCellLocked(e.getDefaultParent())},t.prototype.isVertexSelected=function(e){var t=!1,i=e.getSelectionCells();if(null!=i)for(var n=0;n<i.length;n++){var o=i[n];if(e.getModel().isVertex(o)&&(t=!0),t)break}return t},t}(te));e("KeyCodes",ie),function(e){e[e.Enter=13]="Enter",e[e.Esc=27]="Esc",e[e.Left=37]="Left",e[e.Up=38]="Up",e[e.Right=39]="Right",e[e.Down=40]="Down",e[e.Del=46]="Del",e[e._0=48]="_0",e[e._1=49]="_1",e[e._2=50]="_2",e[e._3=51]="_3",e[e._4=52]="_4",e[e._5=53]="_5",e[e._6=54]="_6",e[e._7=55]="_7",e[e._8=56]="_8",e[e._9=57]="_9",e[e.A=65]="A",e[e.B=66]="B",e[e.C=67]="C",e[e.D=68]="D",e[e.E=69]="E",e[e.F=70]="F",e[e.G=71]="G",e[e.H=72]="H",e[e.I=73]="I",e[e.J=74]="J",e[e.K=75]="K",e[e.L=76]="L",e[e.M=77]="M",e[e.N=78]="N",e[e.O=79]="O",e[e.P=80]="P",e[e.Q=81]="Q",e[e.R=82]="R",e[e.S=83]="S",e[e.T=84]="T",e[e.U=85]="U",e[e.V=86]="V",e[e.W=87]="W",e[e.X=88]="X",e[e.Y=89]="Y",e[e.Z=90]="Z",e[e.F1=112]="F1",e[e.F2=113]="F2",e[e.F3=114]="F3",e[e.F4=115]="F4",e[e.F5=116]="F5",e[e.F6=117]="F6",e[e.F7=118]="F7",e[e.F8=119]="F8",e[e.F9=120]="F9",e[e.F10=121]="F10",e[e.F11=122]="F11",e[e.F12=123]="F12",e[e.Plus=187]="Plus",e[e.Minus=189]="Minus"}(ie||e("KeyCodes",ie={}));var ue=e("AutosizeAction",function(e){function t(t){var i=e.call(this,$.pmf_autosize,t,!1)||this;return i.shortcutControlKey=!0,i.shortcutShiftKey=!0,i.shortcutKeyCode=ie.Y,i.editorUi.addListener(Q.SelectionModelChanged,(function(){i.setEnabled(i.isVertexSelected(i.editorUi.graph))})),i}return J(t,e),t.prototype.execute=function(e){var t=this.editorUi.graph,i=t.getSelectionCells();if(null!=i){t.getModel().beginUpdate();try{for(var n=0;n<i.length;n++){var o=i[n];if(t.getModel().getChildCount(o))t.updateGroupBounds([o],20);else{var r=t.view.getState(o),l=t.getCellGeometry(o);t.getModel().isVertex(o)&&null!=r&&null!=r.text&&null!=l&&t.isWrapping(o)?((l=l.clone()).height=r.text.boundingBox.height/t.view.scale,t.getModel().setGeometry(o,l)):t.updateCellSize(o)}}}finally{t.getModel().endUpdate()}}},t.prototype.isVertexSelected=function(e){var t=!1,i=e.getSelectionCells();if(null!=i)for(var n=0;n<i.length;n++){var o=i[n];if(e.getModel().isVertex(o)&&(t=!0),t)break}return t},t}(te)),he=e("ClearWaypointsAction",function(e){function t(t){var i=e.call(this,$.pmf_clearWaypoints,t,!1)||this;return i.shortcutControlKey=!1,i.shortcutShiftKey=!0,i.shortcutAltKey=!0,i.shortcutKeyCode=ie.C,i.editorUi.addListener(Q.SelectionModelChanged,(function(){var e=!i.editorUi.graph.isSelectionEmpty();i.setEnabled(e)})),i}return J(t,e),t.prototype.execute=function(e){var t=this.editorUi.graph,i=t.getSelectionCells();if(null!=i){i=t.addAllEdges(i),t.getModel().beginUpdate();try{for(var n=0;n<i.length;n++){var o=i[n];if(t.getModel().isEdge(o)){var r=t.getCellGeometry(o);null!=r&&((r=r.clone()).points=null,t.getModel().setGeometry(o,r))}}}finally{t.getModel().endUpdate()}}},t}(te)),ce=e("CopyAction",function(e){function t(t){var i=e.call(this,$.pmf_copy,t,!0)||this;return i.shortcutControlKey=!0,i.shortcutShiftKey=!1,i.shortcutKeyCode=ie.C,i.editorUi.addListener(Q.SelectionModelChanged,(function(){var e=!i.editorUi.graph.isSelectionEmpty();i.setEnabled(e)})),i}return J(t,e),t.prototype.execute=function(e){var t=this.editorUi.graph;r.copy(t)},t}(te)),pe=e("CutAction",function(e){function t(t){var i=e.call(this,$.pmf_cut,t,!1)||this;return i.shortcutControlKey=!0,i.shortcutShiftKey=!1,i.shortcutKeyCode=ie.X,i.editorUi.addListener(Q.SelectionModelChanged,(function(){var e=!i.editorUi.graph.isSelectionEmpty();i.setEnabled(e)})),i}return J(t,e),t.prototype.execute=function(e){this.editorUi.graph},t}(te)),fe=e("DeleteAction",function(e){function t(t){var i=e.call(this,$.pmf_delete,t,!0)||this;return i.shortcutControlKey=!1,i.shortcutShiftKey=!1,i.shortcutKeyCode=ie.Del,i.editorUi.addListener(Q.SelectionModelChanged,(function(){var e=!i.editorUi.graph.isSelectionEmpty();i.setEnabled(e)})),i}return J(t,e),t.prototype.execute=function(e){var t=this.editorUi.graph;t.escape();var i=t.getDeletableCells(t.getSelectionCells());if(null!=i&&i.length>0){var n=t.model.getParents(i);if(t.removeCells(i,!0),null!=n){for(var o=[],r=0;r<n.length;r++)t.model.contains(n[r])&&(t.model.isVertex(n[r])||t.model.isEdge(n[r]))&&o.push(n[r]);t.setSelectionCells(o)}}},t}(te)),ge=e("DistributeHorizontalAction",function(e){function t(t){var i=e.call(this,$.pmf_horizontal,t,!1)||this;return i.editorUi.addListener(Q.LockedChanged,(function(){i.setEnabled(i.isAlignActionEnabled(i.editorUi.graph))})),i.editorUi.addListener(Q.SelectionModelChanged,(function(){i.setEnabled(i.isAlignActionEnabled(i.editorUi.graph))})),i}return J(t,e),t.prototype.execute=function(e){this.editorUi.graph.distributeCells(!0)},t.prototype.isAlignActionEnabled=function(e){return this.isUnlocked(e)&&this.isVertexSelected(e)&&e.getSelectionCount()>1},t.prototype.isUnlocked=function(e){return e.isEnabled()&&!e.isCellLocked(e.getDefaultParent())},t.prototype.isVertexSelected=function(e){var t=!1,i=e.getSelectionCells();if(null!=i)for(var n=0;n<i.length;n++){var o=i[n];if(e.getModel().isVertex(o)&&(t=!0),t)break}return t},t}(te)),me=e("DistributeVerticalAction",function(e){function t(t){var i=e.call(this,$.pmf_vertical,t,!1)||this;return i.editorUi.addListener(Q.LockedChanged,(function(){i.setEnabled(i.isAlignActionEnabled(i.editorUi.graph))})),i.editorUi.addListener(Q.SelectionModelChanged,(function(){i.setEnabled(i.isAlignActionEnabled(i.editorUi.graph))})),i}return J(t,e),t.prototype.execute=function(e){this.editorUi.graph.distributeCells(!1)},t.prototype.isAlignActionEnabled=function(e){return this.isUnlocked(e)&&this.isVertexSelected(e)&&e.getSelectionCount()>1},t.prototype.isUnlocked=function(e){return e.isEnabled()&&!e.isCellLocked(e.getDefaultParent())},t.prototype.isVertexSelected=function(e){var t=!1,i=e.getSelectionCells();if(null!=i)for(var n=0;n<i.length;n++){var o=i[n];if(e.getModel().isVertex(o)&&(t=!0),t)break}return t},t}(te)),ye=e("DuplicateAction",function(e){function t(t){var i=e.call(this,$.pmf_duplicate,t,!1)||this;return i.shortcutControlKey=!0,i.shortcutShiftKey=!1,i.shortcutKeyCode=ie.D,i.editorUi.addListener(Q.SelectionModelChanged,(function(){var e=!i.editorUi.graph.isSelectionEmpty();i.setEnabled(e)})),i}return J(t,e),t.prototype.execute=function(e){var t=this.editorUi.graph,i=t.getSelectionCells();i=t.model.getTopmostCells(i);var n=t.getModel(),o=t.gridSize,r=[];n.beginUpdate();try{for(var l=t.cloneCells(i,!1),a=0;a<i.length;a++){var s=n.getParent(i[a]),d=t.moveCells([l[a]],o,o,!1,s)[0];r.push(d),n.add(s,l[a])}}finally{n.endUpdate()}t.setSelectionCells(r)},t}(te)),Ce=e("FitWindowAction",function(e){function t(t){var i=e.call(this,$.pmf_fitWindow,t,!0)||this;return i.shortcutControlKey=!0,i.shortcutShiftKey=!0,i.shortcutKeyCode=ie.H,i}return J(t,e),t.prototype.execute=function(e){this.editorUi.graph.fit(16)},t}(te)),we=e("FormatPanelAction",function(e){function t(t){var i=e.call(this,$.pmf_formatPanel,t,!0)||this;return i.shortcutControlKey=!0,i.shortcutShiftKey=!0,i.shortcutKeyCode=ie.P,i.setToggleAction(!0),i}return J(t,e),t.prototype.isSelected=function(){return this.editorUi.showFormat},t.prototype.execute=function(e){this.editorUi.showFormat=!this.editorUi.showFormat,this.editorUi.refresh()},t}(te)),ve=e("HelpAction",function(e){function t(t){return e.call(this,$.pmf_help,t,!0)||this}return J(t,e),t.prototype.execute=function(e){alert(this.key)},t}(te)),Ee=e("LockUnlockAction",function(e){function i(t){var i=e.call(this,$.pmf_lockUnlock,t,!1)||this;return i.shortcutControlKey=!0,i.shortcutShiftKey=!1,i.shortcutKeyCode=ie.L,i.editorUi.addListener(Q.SelectionModelChanged,(function(){var e=!i.editorUi.graph.isSelectionEmpty();i.setEnabled(e)})),i}return J(i,e),i.prototype.execute=function(e){var i=this.editorUi.graph;if(!i.isSelectionEmpty()){i.getModel().beginUpdate();try{var n=i.isCellMovable(i.getSelectionCell())?1:0;i.toggleCellStyles(o.STYLE_MOVABLE,n),i.toggleCellStyles(o.STYLE_RESIZABLE,n),i.toggleCellStyles(o.STYLE_ROTATABLE,n),i.toggleCellStyles(o.STYLE_DELETABLE,n),i.toggleCellStyles(o.STYLE_EDITABLE,n),i.toggleCellStyles("connectable",n)}finally{i.getModel().endUpdate(),this.editorUi.fireEvent(new t(Q.LockedChanged))}}},i}(te)),be=e("OutlineWindow",(function(e,t,i,n,r){var h=this,c=e.graph,p=document.createElement("div");p.style.position="absolute",p.style.width="100%",p.style.height="100%",p.style.border="1px solid whiteSmoke",p.style.overflow="hidden",this.window=new l(a.get("outline"),p,t,i,n,r,!0,!0),this.window.destroyOnClose=!1,this.window.setMaximizable(!1),this.window.setResizable(!0),this.window.setClosable(!0),this.window.setVisible(!0),this.window.setLocation=function(e,t){var i=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,n=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;e=Math.max(0,Math.min(e,i-h.window.table.clientWidth)),t=Math.max(0,Math.min(t,n-h.window.table.clientHeight-48)),h.window.getX()==e&&h.window.getY()==t||l.prototype.setLocation.apply(h.window,[e,t])},s.addListener(window,"resize",(function(){var e=h.window.getX(),t=h.window.getY();h.window.setLocation(e,t)}));var f=new d(e.graph);f.border=20,s.addListener(window,"resize",(function(){f.update()})),e.addListener("pageFormatChanged",(function(){f.update()})),e.addListener(Q.ResizeGraphView,(function(){f.update()})),this.window.addListener(s.RESIZE,(function(){f.update(!1),f.outline.sizeDidChange()})),this.window.addListener(s.SHOW,(function(){f.suspended=!1,f.outline.refresh(),f.update()})),this.window.addListener(s.HIDE,(function(){f.suspended=!0})),this.window.addListener(s.NORMALIZE,(function(){f.suspended=!1,f.update()})),this.window.addListener(s.MINIMIZE,(function(){f.suspended=!0}));var g=f.createGraph;f.createGraph=function(e){var t=g.apply(f,[e]);t.gridEnabled=!1,t.pageScale=c.pageScale,t.pageFormat=c.pageFormat,t.background=c.background,t.pageVisible=c.pageVisible;var i=u.getCurrentStyle(c.container);return p.style.backgroundColor=i.backgroundColor,t};var m=function(){f.outline.pageScale=c.pageScale,f.outline.pageFormat=c.pageFormat,f.outline.pageVisible=c.pageVisible,f.outline.background=c.background;var e=u.getCurrentStyle(c.container);p.style.backgroundColor=e.backgroundColor,null!=c.view.backgroundPageShape&&null!=f.outline.view.backgroundPageShape&&(f.outline.view.backgroundPageShape.fill=c.view.backgroundPageShape.fill),f.outline.refresh()};if(f.init(p),e.addListener("resetGraphView",m),e.addListener("pageFormatChanged",m),e.addListener("backgroundColorChanged",m),e.addListener("backgroundImageChanged",m),e.addListener("pageViewChanged",(function(){m(),f.update(!0)})),f.outline.dialect==o.DIALECT_SVG){var y=e.actions.getAction($.pmf_zoomIn),C=e.actions.getAction($.pmf_zoomOut);s.addMouseWheelListener((function(e,t){for(var i=!1,n=s.getSource(e);null!=n;){if(n==f.outline.view.canvas.ownerSVGElement){i=!0;break}n=n.parentNode}i&&(t?y.execute():C.execute(),s.consume(e))}))}})),Se=e("OutlineAction",function(e){function i(t){var i=e.call(this,$.pmf_outline,t,!0)||this;return i.shortcutControlKey=!0,i.shortcutShiftKey=!0,i.shortcutKeyCode=ie.O,i.setToggleAction(!0),i}return J(i,e),i.prototype.isSelected=function(){return null!=this.outlineWindow&&this.outlineWindow.window.isVisible()},i.prototype.execute=function(e){var i=this;null==this.outlineWindow?(this.outlineWindow=new be(this.editorUi,document.body.offsetWidth-260,100,180,180),this.outlineWindow.window.addListener("show",(function(){i.editorUi.fireEvent(new t("outline"))})),this.outlineWindow.window.addListener("hide",(function(){i.editorUi.fireEvent(new t("outline"))})),this.outlineWindow.window.setVisible(!0),this.editorUi.fireEvent(new t("outline"))):this.outlineWindow.window.setVisible(!this.outlineWindow.window.isVisible())},i}(te)),_e=e("PasteAction",function(e){function t(t){var i=e.call(this,$.pmf_paste,t,!0)||this;return i.shortcutControlKey=!0,i.shortcutShiftKey=!1,i.shortcutKeyCode=ie.V,i}return J(t,e),t.prototype.execute=function(e){var t=this.editorUi.graph;t.isEnabled()&&!t.isCellLocked(t.getDefaultParent())&&r.paste(t)},t}(te)),Ie=e("RedoAction",function(e){function t(t){var i=e.call(this,$.pmf_redo,t,!1)||this;return i.shortcutControlKey=!0,i.shortcutShiftKey=!1,i.shortcutKeyCode=ie.Y,i}return J(t,e),t.prototype.execute=function(e){alert(this.key)},t}(te)),Te=e("ResetViewAction",function(e){function t(t){var i=e.call(this,$.pmf_resetView,t,!0)||this;return i.shortcutControlKey=!0,i.shortcutShiftKey=!1,i.shortcutKeyCode=ie.H,i}return J(t,e),t.prototype.execute=function(e){this.editorUi.graph.zoomTo(1),this.editorUi.resetScrollbars()},t}(te)),Ae=e("SelectAllAction",function(e){function t(t){var i=e.call(this,$.pmf_selectAll,t,!0)||this;return i.shortcutControlKey=!0,i.shortcutShiftKey=!1,i.shortcutKeyCode=ie.A,i.editorUi.addListener(Q.LockedChanged,(function(){var e=i.editorUi.graph,t=e.isEnabled()&&!e.isCellLocked(e.getDefaultParent());i.setEnabled(t)})),i}return J(t,e),t.prototype.execute=function(e){this.editorUi.graph.selectAll(null,!0)},t}(te)),xe=e("SelectEdgesAction",function(e){function t(t){var i=e.call(this,$.pmf_selectEdges,t,!0)||this;return i.shortcutControlKey=!0,i.shortcutShiftKey=!0,i.shortcutKeyCode=ie.E,i.editorUi.addListener(Q.LockedChanged,(function(){var e=i.editorUi.graph,t=e.isEnabled()&&!e.isCellLocked(e.getDefaultParent());i.setEnabled(t)})),i}return J(t,e),t.prototype.execute=function(e){this.editorUi.graph.selectEdges()},t}(te)),Le=e("SelectNoneAction",function(e){function t(t){var i=e.call(this,$.pmf_selectNone,t,!0)||this;return i.shortcutControlKey=!0,i.shortcutShiftKey=!0,i.shortcutKeyCode=ie.A,i.editorUi.addListener(Q.LockedChanged,(function(){var e=i.editorUi.graph,t=e.isEnabled()&&!e.isCellLocked(e.getDefaultParent());i.setEnabled(t)})),i}return J(t,e),t.prototype.execute=function(e){this.editorUi.graph.clearSelection()},t}(te)),Me=e("SelectVerticesAction",function(e){function t(t){var i=e.call(this,$.pmf_selectVertices,t,!0)||this;return i.shortcutControlKey=!0,i.shortcutShiftKey=!0,i.shortcutKeyCode=ie.I,i.editorUi.addListener(Q.LockedChanged,(function(){var e=i.editorUi.graph,t=e.isEnabled()&&!e.isCellLocked(e.getDefaultParent());i.setEnabled(t)})),i}return J(t,e),t.prototype.execute=function(e){this.editorUi.graph.selectVertices()},t}(te)),Pe=e("ToBackAction",function(e){function t(t){var i=e.call(this,$.pmf_toBack,t,!1)||this;return i.shortcutControlKey=!0,i.shortcutShiftKey=!0,i.shortcutKeyCode=ie.B,i.editorUi.addListener(Q.SelectionModelChanged,(function(){var e=!i.editorUi.graph.isSelectionEmpty();i.setEnabled(e)})),i}return J(t,e),t.prototype.execute=function(e){this.editorUi.graph.orderCells(!0)},t}(te)),Ue=e("ToFrontAction",function(e){function t(t){var i=e.call(this,$.pmf_toFront,t,!1)||this;return i.shortcutControlKey=!0,i.shortcutShiftKey=!0,i.shortcutKeyCode=ie.F,i.editorUi.addListener(Q.SelectionModelChanged,(function(){var e=!i.editorUi.graph.isSelectionEmpty();i.setEnabled(e)})),i}return J(t,e),t.prototype.execute=function(e){this.editorUi.graph.orderCells(!1)},t}(te)),De=e("UndoAction",function(e){function t(t){var i=e.call(this,$.pmf_undo,t,!1)||this;return i.shortcutControlKey=!0,i.shortcutShiftKey=!1,i.shortcutKeyCode=ie.Z,i}return J(t,e),t.prototype.execute=function(e){alert(this.key)},t}(te)),Ne=e("ViewGridAction",function(e){function t(t){var i=e.call(this,$.pmf_grid,t,!0)||this;return i.shortcutControlKey=!0,i.shortcutShiftKey=!0,i.shortcutKeyCode=ie.G,i.setToggleAction(!0),i}return J(t,e),t.prototype.isSelected=function(){return this.editorUi.graph.isGridEnabled()},t.prototype.execute=function(e){var t=this.editorUi.graph;t.setGridEnabled(!t.isGridEnabled()),t.refresh()},t}(te)),Oe=e("View_100_Action",function(e){function t(t){var i=e.call(this,$.pmf_view_100,t,!0)||this;return i.shortcutControlKey=!0,i.shortcutShiftKey=!1,i.shortcutAltKey=!0,i.shortcutKeyCode=ie._0,i}return J(t,e),t.prototype.execute=function(e){this.editorUi.graph.zoomTo(1)},t}(te)),Be=e("View_125_Action",function(e){function t(t){return e.call(this,$.pmf_view_125,t,!0)||this}return J(t,e),t.prototype.execute=function(e){this.editorUi.graph.zoomTo(1.25)},t}(te)),ke=e("View_150_Action",function(e){function t(t){return e.call(this,$.pmf_view_150,t,!0)||this}return J(t,e),t.prototype.execute=function(e){this.editorUi.graph.zoomTo(1.5)},t}(te)),Ge=e("View_200_Action",function(e){function t(t){return e.call(this,$.pmf_view_200,t,!0)||this}return J(t,e),t.prototype.execute=function(e){this.editorUi.graph.zoomTo(2)},t}(te)),Re=e("View_25_Action",function(e){function t(t){return e.call(this,$.pmf_view_25,t,!0)||this}return J(t,e),t.prototype.execute=function(e){this.editorUi.graph.zoomTo(.25)},t}(te)),He=e("View_300_Action",function(e){function t(t){return e.call(this,$.pmf_view_300,t,!0)||this}return J(t,e),t.prototype.execute=function(e){this.editorUi.graph.zoomTo(3)},t}(te)),Fe=e("View_400_Action",function(e){function t(t){return e.call(this,$.pmf_view_400,t,!0)||this}return J(t,e),t.prototype.execute=function(e){this.editorUi.graph.zoomTo(4)},t}(te)),Ke=e("View_50_Action",function(e){function t(t){return e.call(this,$.pmf_view_50,t,!0)||this}return J(t,e),t.prototype.execute=function(e){this.editorUi.graph.zoomTo(.5)},t}(te)),ze=e("View_75_Action",function(e){function t(t){return e.call(this,$.pmf_view_75,t,!0)||this}return J(t,e),t.prototype.execute=function(e){this.editorUi.graph.zoomTo(.75)},t}(te)),Ve=e("ZoomInAction",function(e){function t(t){var i=e.call(this,$.pmf_zoomIn,t,!0)||this;return i.shortcutControlKey=!0,i.shortcutShiftKey=!1,i.shortcutAltKey=!0,i.shortcutKeyCode=ie.Plus,i}return J(t,e),t.prototype.execute=function(e){this.editorUi.graph.zoomIn()},t}(te)),We=e("ZoomOutAction",function(e){function t(t){var i=e.call(this,$.pmf_zoomOut,t,!0)||this;return i.shortcutControlKey=!0,i.shortcutShiftKey=!1,i.shortcutAltKey=!0,i.shortcutKeyCode=ie.Minus,i}return J(t,e),t.prototype.execute=function(e){this.editorUi.graph.zoomOut()},t}(te)),Ye=e("Actions",function(){function e(e){this.editorUi=e,this.actionDic={},this.init()}return e.prototype.addAction=function(e){this.actionDic[e.key]=e,null!=e.shortcutKeyCode&&this.addShortcut(e.key,e.shortcutKeyCode,e.shortcutControlKey,e.shortcutShiftKey,e.shortcutAltKey)},e.prototype.addActions=function(){for(var e=this,t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];t&&t.forEach((function(t){e.addAction(t)}))},e.prototype.getAction=function(e){return this.actionDic[e]},e.prototype.removeAction=function(e){var t=this.getAction(e);return t&&delete this.actionDic[e],t},e.prototype.addShortcut=function(e,t,i,n,o){var r=this.getAction(e);if(null!=r){this.editorUi.keyHandler&&this.editorUi.keyHandler.bindAction((function(e){r.isEnabled()&&r.execute(e)}),t,i,n,o)}},e.prototype.init=function(){this.addActions(new De(this.editorUi),new Ie(this.editorUi),new pe(this.editorUi),new ce(this.editorUi),new _e(this.editorUi),new fe(this.editorUi),new ye(this.editorUi),new Me(this.editorUi),new xe(this.editorUi),new Ae(this.editorUi),new Le(this.editorUi),new Ee(this.editorUi)),this.addActions(new we(this.editorUi),new Se(this.editorUi),new Ve(this.editorUi),new We(this.editorUi),new Te(this.editorUi),new Re(this.editorUi),new Ke(this.editorUi),new ze(this.editorUi),new Oe(this.editorUi),new Be(this.editorUi),new ke(this.editorUi),new Ge(this.editorUi),new He(this.editorUi),new Fe(this.editorUi),new Ce(this.editorUi),new Ne(this.editorUi)),this.addActions(new Ue(this.editorUi),new Pe(this.editorUi),new le(this.editorUi),new re(this.editorUi),new se(this.editorUi),new de(this.editorUi),new ae(this.editorUi),new oe(this.editorUi),new ge(this.editorUi),new me(this.editorUi),new he(this.editorUi),new ue(this.editorUi)),this.addActions(new ve(this.editorUi),new ne(this.editorUi))},e.prototype.isUnlocked=function(e){return e.isEnabled()&&!e.isCellLocked(e.getDefaultParent())},e.prototype.isVertexSelected=function(e){var t=!1,i=e.getSelectionCells();if(null!=i)for(var n=0;n<i.length;n++){var o=i[n];if(e.getModel().isVertex(o)&&(t=!0),t)break}return t},e.prototype.isEdgeSelected=function(e){var t=!1,i=e.getSelectionCells();if(null!=i)for(var n=0;n<i.length;n++){var o=i[n];if(e.getModel().isEdge(o)&&(t=!0),t)break}return t},e.prototype.isAlignActionEnabled=function(e){return this.isUnlocked(e)&&this.isVertexSelected(e)&&e.getSelectionCount()>1},e}()),Xe=(e("PropertyConfig",(function(){this.tabs=[]})),e("PropertyConfigTab",(function(e,t){this.groups=[],this.tabId=e,this.tabName=t})),e("PropertyConfigGroup",(function(e,t){this.items=[],this.groupId=e,this.groupName=t})),e("PropertyConfigItem",(function(e,t,i,n){this.propertyType="string",this.readonly=!1,this.visible=!0,this.propertyId=e,this.propertyName=t,this.propertyType=i,this.propertyValue=n})),e("ElementPropertyConfig",(function(){}))),Ze=e("FarrisPropConfigWithData",(function(){this.propertyConfig=[],this.propertyData={}})),je=(e("PropertyEntity",(function(){this.propertyType="string",this.readonly=!1,this.visible=!0})),e("Cell",function(e){function i(t,i,n){return e.call(this,t,i,n)||this}return J(i,e),i.prototype.bindBpmnModel=function(e,t){var i=this.editorUi.graph.bpmnModel;this.flowElement=this.createFlowElement(e),this.diagramElement=this.createDiagramElement(t),this.diagramElement.BpmnElementId=this.flowElement.Id,i.DefaultProcess.AddFlowElement(this.flowElement),i.DefaultDiagram.BpmnPlane.AddDiagramElement(this.diagramElement)},i.prototype.unbindBpmnModel=function(){null!=this.flowElement&&(this.flowElement.Model.DefaultProcess.RemoveFlowElement(this.flowElement.Id),this.flowElement.Model.DefaultDiagram.BpmnPlane.RemoveDiagramElement(this.diagramElement.Id))},i.prototype.clone=function(){var t=this.flowElement,i=this.diagramElement,n=this.editorUi;delete this.flowElement,delete this.diagramElement,delete this.editorUi;var o=e.prototype.clone.call(this);if(this.flowElement=t,this.diagramElement=i,this.editorUi=n,t){var r=this.cloneFlowElement(t);o.flowElement=r}if(i){var l=this.cloneDiagramElement(i);l.BpmnElementId=o.flowElement.Id,o.diagramElement=l}return n&&(o.editorUi=n),o},i.prototype.cloneFlowElement=function(e){return e.clone()},i.prototype.cloneDiagramElement=function(e){var t=e.NewInstance();return t.LoadFromJsonObject(e.ConvertToJsonObject()),t.Id=M.GenerateElementId(),t},i.prototype.getPropConfig=function(){return{}},i.prototype.getFarrisPropConfig=function(){var e,t=new Ze,i=new Xe;return t.propertyConfig.push(i),i.categoryId="general",i.categoryName=a.get("Basic Info")||"基本信息",i.tabId="basic",i.tabName=a.get("Basic Property")||"基础属性",i.properties=[{propertyID:"Name",propertyName:a.get("Property Name")||"名称",propertyType:"string",visible:!this.editorUi.multiLangEnabled},{propertyID:"NameLanguage",propertyName:a.get("Property Name")||"名称",propertyType:"multiLanguage",visible:this.editorUi.multiLangEnabled},{propertyID:"Id",propertyName:a.get("Property Id")||"标识",propertyType:"string",readonly:!0}],t.propertyData={Id:this.flowElement.Id,Name:this.flowElement.Name,ClrTypeId:this.flowElement.ClrTypeID,ClrTypeID:this.flowElement.ClrTypeID,NameLanguage:this.flowElement.NameLanguage||(e={},e[this.editorUi.langCode||"zh-CHS"]=this.flowElement.Name,e)},t},i.prototype.updateProps=function(e){this.flowElement[e.propertyID]=e.propertyValue,"NameLanguage"==e.propertyID&&(this.flowElement.Name=this.flowElement.NameLanguage&&this.flowElement.NameLanguage["zh-CHS"]||""),"NameLanguage"!=e.propertyID&&"Name"!=e.propertyID||this.editorUi.fireEvent(new t(Q.NameChanged,"cell",this))},i}(h))),Je=e("EdgeCell",function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.edge=!0,t.vertex=!1,t}return J(t,e),t.prototype.unbindBpmnModel=function(){if(null!=this.flowElement){var t=this.flowElement,i=this.source&&this.source.flowElement,n=this.target&&this.target.flowElement;return null!=i&&(i.Outgoings=i.Outgoings?i.Outgoings.filter((function(e){return e!=t.Id})):[],i instanceof P&&i.Default===t.Id&&(i.Default=null),i instanceof U&&i.Default===t.Id&&(i.Default=null)),null!=n&&(n.Incomings=n.Incomings?n.Incomings.filter((function(e){return e!=t.Id})):[]),e.prototype.unbindBpmnModel.call(this)}},t.prototype.createFlowElement=function(e){var t=this.editorUi.graph.bpmnModel,i=null;if(e)i=e.clone();else{var n=M.GetElementType(this.clrTypeId);n.Model=t,i=n.NewInstance()}var o=this.source&&this.source.flowElement,r=this.target&&this.target.flowElement;return i.SourceRef=o&&o.Id,i.TargetRef=r&&r.Id,i.Id=i.SourceRef+"_"+i.TargetRef,i.Name="",o&&!this.existOutging(t,o,r)&&o.Outgoings.push(i.Id),r&&!this.existIncoming(t,r,o)&&r.Incomings.push(i.Id),i},t.prototype.createDiagramElement=function(e){var t=this.editorUi.graph.bpmnModel,i=this.source&&this.source.diagramElement,n=this.target&&this.target.diagramElement,o=new D(t);o.SourceShapeElementId=i&&i.Id,o.TargetShapeElementId=n&&n.Id,o.LineType=N.RectangularLineType;var r=new O(t);return r.LineType=B.H2V,o.RectangularLine=r,o},t.prototype.existOutging=function(e,t,i){for(var n=!1,o=0,r=t.Outgoings;o<r.length;o++){var l=r[o];if(e.DefaultProcess.GetFlowElement(l).TargetRef==i.Id){n=!0;break}}return n},t.prototype.existIncoming=function(e,t,i){for(var n=!1,o=0,r=t.Incomings;o<r.length;o++){var l=r[o];if(e.DefaultProcess.GetFlowElement(l).SourceRef==i.Id){n=!0;break}}return n},t.prototype.setPoints=function(e){var t=this,i=[];e&&e.forEach((function(e){var n=new k(t.diagramElement.Model);n.X=e.x,n.Y=e.y,i.push(n)})),this.diagramElement&&(this.diagramElement.Points=i)},t.prototype.setBpmnLabel=function(e){if(null!=this.diagramElement){var t=this.diagramElement,i=this.diagramElement.Model;if(null!=e){var n=new G(i),o=new R(i);o.X=e.x,o.Y=e.y,o.Width=e.width,o.Height=e.height,n.Bounds=o,n.LabelStyle="testLabelStyle",t.BpmnLabel=n}else t.BpmnLabel=null}},t}(je)),Qe=(e("DefaultEdgeCell",function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return J(t,e),t}(Je)),e("NodeCell",function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.edge=!1,t.vertex=!0,t}return J(t,e),t.prototype.unbindBpmnModel=function(){return e.prototype.unbindBpmnModel.call(this)},t.prototype.createFlowElement=function(e){var t=this.editorUi.graph.bpmnModel,i=null;if(e)(i=e.clone()).Name=e.Name,i.NameLanguage=e.NameLanguage&&q({},e.NameLanguage);else{var n=M.GetElementType(this.clrTypeId);n.Model=t,(i=n.NewInstance()).Name=this.name,i.NameLanguage=this.nameLanguage&&q({},this.nameLanguage)}return i},t.prototype.createDiagramElement=function(e){var t=this.editorUi.graph.bpmnModel,i=new H(t),n=new R(t);return n.X=this.geometry.x,n.Y=this.geometry.y,n.Width=this.geometry.width,n.Height=this.geometry.height,i.Bounds=n,i},t}(je))),qe=e("DefaultNodeCell",function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return J(t,e),t}(Qe)),$e=e("ProcessCell",function(){function e(){}return e.prototype.getFarrisPropConfig=function(){var e,t={},i=new Xe;return i.categoryId="usual",i.categoryName=a.get("Basic Info")||"基本信息",i.tabId="basic",i.tabName=a.get("Basic Property")||"基础属性",i.properties=[{propertyID:"Name",propertyName:a.get("Property Name")||"名称",propertyType:"string",visible:!this.editorUi.multiLangEnabled},{propertyID:"NameLanguage",propertyName:a.get("Property Name")||"名称",propertyType:"multiLanguage",visible:this.editorUi.multiLangEnabled},{propertyID:"Key",propertyName:a.get("Property Id")||"标识",propertyType:"string",readonly:!0}],t.Name=this.process.Name,t.NameLanguage=this.process.NameLanguage||((e={})[this.editorUi.langCode||"zh-CHS"]=this.process.Name,e),t.Key=this.process.Key,t.Id=this.process.Id,t.ClrTypeId=this.process.ClrTypeID,t.ClrTypeID=this.process.ClrTypeID,{propertyConfig:[i],propertyData:t}},e.prototype.updateProps=function(e){this.process[e.propertyID]=e.propertyValue,"NameLanguage"==e.propertyID&&(this.process.Name=this.process.NameLanguage&&this.process.NameLanguage["zh-CHS"]||"")},e}()),et=e("Constant",function(){function e(){}return e.IMAGE_PATH=(window.mxiGIXBasePath?window.mxiGIXBasePath:"")+"/platform/runtime/common/web/@edp-pmf/grapheditor/images",e.STYLE_PATH=(window.mxiGIXBasePath?window.mxiGIXBasePath:"")+"/platform/runtime/common/web/@edp-pmf/grapheditor/styles",e.CHECK_MARK_IMAGE=e.IMAGE_PATH+"/checkmark.gif",e.TRANSPARENT_IMAGE=e.IMAGE_PATH+"/transparent.gif",e.ORIGINAL_NO_FO=i.NO_FO,e}()),tt=e("EndEventCell",function(e){function t(i,n,o){var r,l=e.call(this,i,n,o)||this;return l.clrTypeId=t.CLR_TYPE_ID,l.name="结束",l.nameLanguage={"zh-CHS":"结束","zh-CHT":"結束",en:"End"},l.imgUrls=((r={})[F.Default]=et.IMAGE_PATH+"/end.png",r),l}return J(t,e),t.CLR_TYPE_ID="bpmn.EndEvent",t}(Qe)),it=e("ExclusiveGatewayCell",function(e){function t(i,n,o){var r,l=e.call(this,i,n,o)||this;return l.clrTypeId=t.CLR_TYPE_ID,l.name="排他网关",l.nameLanguage={"zh-CHS":"排他网关","zh-CHT":"排他網關",en:"ExclusiveGateway"},l.imgUrls=((r={})[F.Default]=et.IMAGE_PATH+"/ExclusiveGateway.png",r),l}return J(t,e),t.CLR_TYPE_ID="bpmn.ExclusiveGateway",t}(Qe)),nt=e("InclusiveGatewayCell",function(e){function t(i,n,o){var r,l=e.call(this,i,n,o)||this;return l.clrTypeId=t.CLR_TYPE_ID,l.name="包容网关",l.nameLanguage={"zh-CHS":"包容网关","zh-CHT":"包容網關",en:"InclusiveGateway"},l.imgUrls=((r={})[F.Default]=et.IMAGE_PATH+"/InclusiveGateway.png",r),l}return J(t,e),t.CLR_TYPE_ID="bpmn.InclusiveGateway",t}(Qe)),ot=e("ParallelGatewayCell",function(e){function t(i,n,o){var r,l=e.call(this,i,n,o)||this;return l.clrTypeId=t.CLR_TYPE_ID,l.name="并行网关",l.nameLanguage={"zh-CHS":"并行网关","zh-CHT":"並行網關",en:"ParallelGateway"},l.imgUrls=((r={})[F.Default]=et.IMAGE_PATH+"/ParallelGateway.png",r),l}return J(t,e),t.CLR_TYPE_ID="bpmn.ParallelGateway",t}(Qe)),rt=e("SequenceFlowEdge",function(e){function t(i,n,o){var r,l=e.call(this,i,n,o)||this;return l.clrTypeId=t.CLR_TYPE_ID,l.name="事件流",l.nameLanguage={"zh-CHS":"事件流","zh-CHT":"事件流",en:"SequenceFlow"},l.strokeColors=((r={})[z.Default]="#6482b9",r),l}return J(t,e),t.prototype.getFarrisPropConfig=function(){var t=e.prototype.getFarrisPropConfig.call(this),i=t.propertyData,n=this.flowElement.Model.DefaultProcess.GetFlowElement(this.flowElement.SourceRef),o=new Xe;(t.propertyConfig.push(o),o.categoryId="condition",o.categoryName=a.get("ConditionOption"),o.tabId="basic",o.tabName=a.get("basic"),o.properties=[],n instanceof U||n instanceof P||n instanceof K)&&(o.properties.push({propertyID:"Default",propertyName:a.get("Default Transform"),propertyType:"select"}),n.Default===this.flowElement.Id?i.Default=!0:i.Default=!1);return t},t.prototype.updateProps=function(t){var i=this.flowElement;if("Default"===t.propertyID)this.modifyDefaultSequenceFlow(i,t.propertyValue);else e.prototype.updateProps.call(this,t)},t.prototype.modifyDefaultSequenceFlow=function(e,t){var i=e.Model.DefaultProcess.GetFlowElement(e.SourceRef);(i instanceof U||i instanceof P||i instanceof K)&&(!0===t?i.Default=e.Id:!1===t&&i.Default===e.Id&&(i.Default=null))},t.CLR_TYPE_ID="bpmn.SequenceFlow",t}(Je)),lt=e("StartEventCell",function(e){function t(i,n,o){var r,l=e.call(this,i,n,o)||this;return l.clrTypeId=t.CLR_TYPE_ID,l.name="开始",l.nameLanguage={"zh-CHS":"开始","zh-CHT":"開始",en:"Start"},l.imgUrl=et.IMAGE_PATH+"/start.png",l.imgUrls=((r={})[F.Default]=et.IMAGE_PATH+"/start.png",r),l}return J(t,e),t.CLR_TYPE_ID="bpmn.StartEvent",t}(Qe)),at=e("BpmnCellHelper",function(){function e(){}return e.register=function(t,i){e.ctors[t]=i},e.remove=function(t){delete e.ctors[t]},e.generate=function(t,i,n,o){var r,l=e.ctors[t];if(l)return(r=new l(i,n,o))instanceof Qe&&null==o&&r.imgUrls&&r.imgUrls[F.Default]&&(r.style="image="+r.imgUrls[F.Default]+";"),r;(r=new qe(i,n,o)).clrTypeId=t},e.ctors={},e}());at.register(tt.CLR_TYPE_ID,tt),at.register(it.CLR_TYPE_ID,it),at.register(nt.CLR_TYPE_ID,nt),at.register(ot.CLR_TYPE_ID,ot),at.register(rt.CLR_TYPE_ID,rt),at.register(lt.CLR_TYPE_ID,lt);var st,dt=e("ToolbarItem",(function(){})),ut=e("ToolbarActionItem",function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return J(t,e),t}(dt));e("ToolbarItemDisplayStyle",st),function(e){e.Text="Text",e.Image="Image",e.ImageAndText="ImageAndText"}(st||e("ToolbarItemDisplayStyle",st={}));var ht,ct=e("ToolbarButton",function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.displayStyle=st.ImageAndText,t}return J(t,e),t}(ut)),pt=e("ToolbarDropDownItem",function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.items=[],t}return J(t,e),t}(dt)),ft=e("ToolbarDropDownButton",function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.displayStyle=st.ImageAndText,t}return J(t,e),t}(pt)),gt=e("ToolbarDropDownMenuItem",function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return J(t,e),t}(pt)),mt=e("ToolbarItems",(function(){this.itemDict={},this.itemList=[]})),yt=e("ToolbarMenuItem",function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return J(t,e),t}(ut)),Ct=e("ToolbarSeparator",function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return J(t,e),t}(dt));e("ResourceKeys",ht),function(e){e.pmf_file="file",e.pmf_save="save",e.pmf_saveAs="saveAs",e.pmf_export="export",e.pmf_edit="edit",e.pmf_undo="undo",e.pmf_redo="redo",e.pmf_cut="cut",e.pmf_copy="copy",e.pmf_paste="paste",e.pmf_pasteHere="pasteHere",e.pmf_delete="delete",e.pmf_deleteAll="deleteAll",e.pmf_duplicate="duplicate",e.pmf_selectVertices="selectVertices",e.pmf_selectEdges="selectEdges",e.pmf_selectAll="selectAll",e.pmf_selectNone="selectNone",e.pmf_lockUnlock="lockUnlock",e.pmf_view="view",e.pmf_formatPanel="formatPanel",e.pmf_outline="outline",e.pmf_layers="layers",e.pmf_pageView="pageView",e.pmf_grid="grid",e.pmf_connectionArrows="connectionArrows",e.pmf_connectionPoints="connectionPoints",e.pmf_resetView="resetView",e.pmf_zoom="zoom",e.pmf_zoomIn="zoomIn",e.pmf_zoomOut="zoomOut",e.pmf_fitWindow="fitWindow",e.pmf_fitPage="fitPage",e.pmf_fitTwoPages="fitTwoPages",e.pmf_fitPageWidth="fitPageWidth",e.pmf_customZoom="custom",e.pmf_arrange="arrange",e.pmf_toFront="toFront",e.pmf_toBack="toBack",e.pmf_align="align",e.pmf_leftAlign="leftAlign",e.pmf_center="center",e.pmf_rightAlign="rightAlign",e.pmf_topAlign="topAlign",e.pmf_middle="middle",e.pmf_bottomAlign="bottomAlign",e.pmf_distribute="distribute",e.pmf_horizontal="horizontal",e.pmf_vertical="vertical",e.pmf_clearWaypoints="clearWaypoints",e.pmf_autosize="autosize",e.pmf_help="help",e.pmf_about="about",e.pmf_mainMenu="pmf_mainMenu",e.pmf_viewModelXml="pmf_viewModelXml"}(ht||e("ResourceKeys",ht={}));var wt,vt=e("DefaultToolbarItems",function(e){function t(){var t=e.call(this)||this;return t.init(),t}return J(t,e),t.prototype.init=function(){var e=new ft;e.resourceKey=ht.pmf_mainMenu,e.displayStyle=st.Image,e.imageSrc=et.IMAGE_PATH+"/iconic/svg/menu.svg",e.imageClassName="pmf_iconic_svg",e.toolTipText=a.get(ht.pmf_mainMenu),this.itemDict[ht.pmf_mainMenu]=e,this.itemList.push(e),this.itemList.push(new Ct);var t=new ft;t.displayStyle=st.Text,t.text="100%",t.resourceKey=ht.pmf_zoom,t.toolTipText=a.get(ht.pmf_zoom),this.itemDict[ht.pmf_zoom]=t,this.itemList.push(t)},t}(mt)),Et=e("Toolbox",(function(){this.groups=[]})),bt=e("ToolboxGroup",(function(){this.items=[]})),St=e("ToolboxItem",(function(e,t,i){this.clrTypeId=e,this.name=t,this.imgUrl=i})),_t=e("DefaultToolbox",function(e){function t(){var t=e.call(this)||this;return t.init(),t}return J(t,e),t.prototype.init=function(){var e=new bt;e.name=a.get("Basic Element")||"基本元素",e.items.push(new St("bpmn.StartEvent"),new St("bpmn.ExclusiveGateway"),new St("bpmn.InclusiveGateway"),new St("bpmn.ParallelGateway"),new St("bpmn.EndEvent")),this.groups.push(e)},t}(Et)),It=e("Footer",(function(e,t){this.editorUi=e,this.container=t})),Tt=e("Format",(function(e,t){this.editorUi=e,this.container=t})),At=e("Base64",{_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(e,t){var i,n,o,r,l,a,s,d="",u=0;for((t=null!=t&&t)||(e=At._utf8_encode(e));u<e.length;)r=(i=e.charCodeAt(u++))>>2,l=(3&i)<<4|(n=e.charCodeAt(u++))>>4,a=(15&n)<<2|(o=e.charCodeAt(u++))>>6,s=63&o,isNaN(n)?a=s=64:isNaN(o)&&(s=64),d=d+this._keyStr.charAt(r)+this._keyStr.charAt(l)+this._keyStr.charAt(a)+this._keyStr.charAt(s);return d},decode:function(e,t){t=null!=t&&t;var i,n,o,r,l,a,s="",d=0;for(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");d<e.length;)i=this._keyStr.indexOf(e.charAt(d++))<<2|(r=this._keyStr.indexOf(e.charAt(d++)))>>4,n=(15&r)<<4|(l=this._keyStr.indexOf(e.charAt(d++)))>>2,o=(3&l)<<6|(a=this._keyStr.indexOf(e.charAt(d++))),s+=String.fromCharCode(i),64!=l&&(s+=String.fromCharCode(n)),64!=a&&(s+=String.fromCharCode(o));return t||(s=At._utf8_decode(s)),s},_utf8_encode:function(e){e=e.replace(/\r\n/g,"\n");for(var t="",i=0;i<e.length;i++){var n=e.charCodeAt(i);n<128?t+=String.fromCharCode(n):n>127&&n<2048?(t+=String.fromCharCode(n>>6|192),t+=String.fromCharCode(63&n|128)):(t+=String.fromCharCode(n>>12|224),t+=String.fromCharCode(n>>6&63|128),t+=String.fromCharCode(63&n|128))}return t},_utf8_decode:function(e){for(var t,i="",n=0,o=0,r=0;n<e.length;)(o=e.charCodeAt(n))<128?(i+=String.fromCharCode(o),n++):o>191&&o<224?(r=e.charCodeAt(n+1),i+=String.fromCharCode((31&o)<<6|63&r),n+=2):(r=e.charCodeAt(n+1),t=e.charCodeAt(n+2),i+=String.fromCharCode((15&o)<<12|(63&r)<<6|63&t),n+=3);return i}}),xt=e("GraphView",function(e){function t(t){var i=e.call(this,t)||this;return i.gridImage=et.IMAGE_PATH+"/grid.gif",i.gridColor="#e0e0e0",i.gridSteps=4,i.minGridSize=4,i}return J(t,e),t.prototype.validateBackgroundPage=function(){e.prototype.validateBackgroundPage.call(this),null!=this.graph.container&&this.validateBackgroundStyles()},t.prototype.validateBackgroundStyles=function(){var e=this.graph,t=null==e.background||e.background==o.NONE?Mt.defaultPageBackgroundColor:e.background,n=null!=t&&this.gridColor!=t.toLowerCase()?this.gridColor:"#ffffff",r="none",l="";if(e.isGridEnabled()){var a=10;i.IS_SVG?(r=unescape(encodeURIComponent(this.createSvgGrid(n))),r="url(data:image/svg+xml;base64,"+(r=window.btoa?btoa(r):At.encode(r,!0))+")",a=e.gridSize*this.scale*this.gridSteps):r="url("+this.gridImage+")";var s=0,d=0;if(null!=e.view.backgroundPageShape){var h=this.getBackgroundPageBounds();s=1+h.x,d=1+h.y}l=-Math.round(a-u.mod(this.translate.x*this.scale-s,a))+"px "+-Math.round(a-u.mod(this.translate.y*this.scale-d,a))+"px"}var c=e.view.canvas;null!=c.ownerSVGElement&&(c=c.ownerSVGElement),null!=e.view.backgroundPageShape?(e.view.backgroundPageShape.node.style.backgroundPosition=l,e.view.backgroundPageShape.node.style.backgroundImage=r,e.view.backgroundPageShape.node.style.backgroundColor=t,e.container.className="geDiagramContainer geDiagramBackdrop",c.style.backgroundImage="none",c.style.backgroundColor=""):(e.container.className="geDiagramContainer",c.style.backgroundPosition=l,c.style.backgroundColor=t,c.style.backgroundImage=r)},t.prototype.createSvgGrid=function(e){for(var t=this.graph.gridSize*this.scale;t<this.minGridSize;)t*=2;for(var i=this.gridSteps*t,n=[],r=1;r<this.gridSteps;r++){var l=r*t;n.push("M 0 "+l+" L "+i+" "+l+" M "+l+" 0 L "+l+" "+i)}return'<svg width="'+i+'" height="'+i+'" xmlns="'+o.NS_SVG+'"><defs><pattern id="grid" width="'+i+'" height="'+i+'" patternUnits="userSpaceOnUse"><path d="'+n.join(" ")+'" fill="none" stroke="'+e+'" opacity="0.2" stroke-width="1"/><path d="M '+i+" 0 L 0 0 0 "+i+'" fill="none" stroke="'+e+'" stroke-width="1"/></pattern></defs><rect width="100%" height="100%" fill="url(#grid)"/></svg>'},t}(c)),Lt=e("MxGraphHelper",function(){function e(){}return e.getRelativePositon=function(e,t,i){return new p(e.x/t-i.x,e.y/t-i.y)},e}()),Mt=e("Graph",function(e){function i(t,i,n,o,r,l){var a=e.call(this,i,n,o,r)||this;return a.bpmnModelLoaded=!1,a.scrollTileSize=new m(0,0,400,400),a.editorUi=t,a.themes=l,null==r&&a.loadStylesheet(),a.setConnectable(!0),a.setMultigraph(!1),a.setAllowDanglingEdges(!1),a.setAllowLoops(!1),a.setCellsEditable(!1),a.setCellsResizable(!1),a.setEdgeLabelsMovable(!0),a.setCellsCloneable(!1),a.graphHandler.guidesEnabled=!0,a.addListener(Q.GridEnabledChanged,(function(){a.view.validateBackground()})),a.setGridEnabled(!0),a.autoScroll=!1,a.autoExtend=!0,a.pageVisible=!1,a.setSplitEnabled(!1),a.setDefaultStyles(),a.setMultiConstraints(),a.setDefaultBpmnModel(),a}return J(i,e),i.prototype.setDefaultStyles=function(){var e=this.getStylesheet(),t=e.getDefaultVertexStyle();t[o.STYLE_SHAPE]=o.SHAPE_IMAGE,t[o.STYLE_VERTICAL_LABEL_POSITION]=o.ALIGN_BOTTOM,t[o.STYLE_FONTSIZE]=12;var i=e.getDefaultEdgeStyle();i[o.STYLE_EDGE]=o.EDGESTYLE_ORTHOGONAL,i[o.STYLE_STROKECOLOR]="#6482B9",i[o.STYLE_ENDARROW]=o.ARROW_BLOCK,i[o.STYLE_ROUNDED]=1,i[o.STYLE_ENDFILL]=1,i[o.STYLE_ENDSIZE]=6},i.prototype.loadStylesheet=function(){var e=this.themes||u.load(et.STYLE_PATH+"/default.xml").getDocumentElement();null!=e&&new f(e.ownerDocument).decode(e,this.getStylesheet())},i.prototype.bpmnCellsSelectionChanged=function(e,i,n){focus(),this.editorUi.fireEvent(new t(Q.ShowProperty,"cells",e))},i.prototype.bpmnCellsRemoved=function(e,t,i){e&&e.forEach((function(e){e instanceof Je&&e.unbindBpmnModel()})),e&&e.forEach((function(e){e instanceof Qe&&e.unbindBpmnModel()}))},i.prototype.bpmnCellsConnected=function(e,t,i){var n=this;this.bindBpmnElements([e]),setTimeout((function(){n.updateEdgeState(e)}),0)},i.prototype.bpmnEdgeTerminalChanged=function(e,t,i,n,o,r,l){if(this.updateEdgeState(e),t!=n&&e instanceof Je&&null!=e.flowElement){var a=e.flowElement,s=e.diagramElement,d=e.source&&e.source.flowElement,u=e.source&&e.source.diagramElement,h=e.target&&e.target.flowElement,c=e.target&&e.target.diagramElement,p=a.Id;if(this.bpmnModel.DefaultProcess.RemoveFlowElement(a.Id),this.bpmnModel.DefaultDiagram.BpmnPlane.RemoveDiagramElement(s.Id),a.SourceRef=d&&d.Id,a.TargetRef=h&&h.Id,a.Id=a.SourceRef+"_"+a.TargetRef,s.BpmnElementId=a.Id,s.SourceShapeElementId=u.Id,s.TargetShapeElementId=c.Id,this.bpmnModel.DefaultProcess.AddFlowElement(a),this.bpmnModel.DefaultDiagram.BpmnPlane.AddDiagramElement(s),i){var f=n&&n.flowElement;f.Default&&f.Default==p&&(f.Default=null),null!=f&&f!=d&&(f.Outgoings=f.Outgoings?f.Outgoings.filter((function(e){return e!=p})):[]),null==d||e.existOutging(this.bpmnModel,d,h)||d.Outgoings.push(a.Id),null!=h&&(h.Incomings=h.Incomings?h.Incomings.filter((function(e){return e!=p})):[]),null==h||e.existIncoming(this.bpmnModel,d,h)||h.Incomings.push(a.Id)}else{var g=n&&n.flowElement;null!=g&&g!=h&&(g.Incomings=g.Incomings?g.Incomings.filter((function(e){return e!=p})):[]),null==h||e.existIncoming(this.bpmnModel,h,d)||h.Incomings.push(a.Id),null!=d&&(d.Outgoings=d.Outgoings?d.Outgoings.filter((function(e){return e!=p})):[]),null==d||e.existOutging(this.bpmnModel,d,h)||d.Outgoings.push(a.Id)}}},i.prototype.bpmnCellGeometryChanged=function(e,t,i,n){var o=this;if(0!=this.bpmnModelLoaded&&null!=e.flowElement)if(e instanceof Qe){var r=e.diagramElement;r.Bounds.X=e.geometry.x,r.Bounds.Y=e.geometry.y,r.Bounds.Height=e.geometry.height,r.Bounds.Width=e.geometry.width,e.edges&&e.edges.forEach((function(e){o.updateEdgeState(e)}))}else e instanceof Je&&this.updateEdgeState(e)},i.prototype.bpmnCellNameChanged=function(e,t,i){this.getModel().beginUpdate();try{this.labelChanged(e,e.flowElement&&e.flowElement.Name,void 0)}finally{this.getModel().endUpdate()}e instanceof Je&&this.updateEdgeState(e)},i.prototype.setDefaultBpmnModel=function(){this.bpmnModel=this.createBpmnModel(),this.processCell=this.createProcessCell(this.bpmnModel),this.bpmnModelLoaded=!0},i.prototype.createBpmnModel=function(){var e=new V;return e.TargetNamespace="Default_Namespace",e.DefaultProcess=new W(e),e.DefaultDiagram=new Y(e),e.DefaultDiagram.BpmnPlane.BpmnElementId=e.DefaultProcess.Id,e},i.prototype.loadBpmnModel=function(e){this.bpmnModelLoaded=!1;var t=this.createBpmnModel();t.LoadFromJson(e),this.drawBpmnGraph(t),this.bpmnModel=t,this.processCell=this.createProcessCell(this.bpmnModel),this.bpmnModelLoaded=!0},i.prototype.createProcessCell=function(e){var t=new $e;return t.process=e.DefaultProcess,t.plane=e.DefaultDiagram.BpmnPlane,t.editorUi=this.editorUi,t},i.prototype.drawBpmnGraph=function(e){var t=this.buildFlowDiagDict(e),i=t.nodeDict,n=t.edgeDict,o=this.buildFlowDict(e);this.drawNodeCells(o,i),this.drawEdgeCells(o,n)},i.prototype.drawNodeCells=function(e,t){var i=this;Object.keys(t).forEach((function(n){var o=e[n],r=t[n];null!=o&&i.drawNodeCell(o,r)}))},i.prototype.drawNodeCell=function(e,t){var i=at.generate(e.ClrTypeID,void 0,new g(t.Bounds.X,t.Bounds.Y,t.Bounds.Width,t.Bounds.Height));i.flowElement=e,i.diagramElement=t,i.editorUi=this.editorUi,this.moveCells([i],void 0,void 0,void 0,this.getDefaultParent())},i.prototype.drawEdgeCells=function(e,t){var i=this;Object.keys(t).forEach((function(n){var o=e[n],r=t[n];null!=o&&i.drawEdgeCell(o,r)}))},i.prototype.drawEdgeCell=function(e,t){var i=this.getChildCells(this.getDefaultParent(),!0)||[],n=i.find((function(t){return t.flowElement&&t.flowElement.Id===e.SourceRef})),r=i.find((function(t){return t.flowElement&&t.flowElement.Id===e.TargetRef})),l=at.generate(e.ClrTypeID,void 0,new g);if(l.geometry.relative=!0,l.flowElement=e,l.diagramElement=t,l.editorUi=this.editorUi,l.source=n,l.target=r,l.geometry.points=l.geometry.points||[],this.isOldBpmnEdge(t)){for(var a=2;a<t.Points.length;a++){var s=t.Points[a];l.geometry.points.push(new p(s.X,s.Y))}this.moveCells([l],void 0,void 0,void 0,this.getDefaultParent());var d=this.view.getState(l);if(t.BpmnLabel&&d){if(0===t.BpmnLabel.Bounds.X&&0===t.BpmnLabel.Bounds.Y)return;var u=t.BpmnLabel.Bounds.X+(d.x-d.paintBounds.x),h=t.BpmnLabel.Bounds.Y+(d.y-d.paintBounds.y);(v=this.createEdgeHandler(d,void 0)).moveLabel(d,u,h),v.destroy()}}else{var c=(t.Points[0].X-n.geometry.x)/n.geometry.width,f=(t.Points[0].Y-n.geometry.y)/n.geometry.height,m=(t.Points[t.Points.length-1].X-r.geometry.x)/n.geometry.width,y=(t.Points[t.Points.length-1].Y-r.geometry.y)/n.geometry.height;l.style=o.STYLE_EXIT_X+"="+c+";"+o.STYLE_EXIT_Y+"="+f+";"+o.STYLE_ENTRY_X+"="+m+";"+o.STYLE_ENTRY_Y+"="+y+";";for(a=1;a<t.Points.length-1;a++){s=t.Points[a];l.geometry.points.push(new p(s.X,s.Y))}this.moveCells([l],void 0,void 0,void 0,this.getDefaultParent());d=this.view.getState(l);var C=this.view.getScale(),w=this.view.getTranslate();if(t.BpmnLabel&&d){if(0===t.BpmnLabel.Bounds.X&&0===t.BpmnLabel.Bounds.Y)return;var v;u=t.BpmnLabel.Bounds.X*C+w.x,h=t.BpmnLabel.Bounds.Y*C+w.y;(v=this.createEdgeHandler(d,void 0)).moveLabel(d,u,h),v.destroy()}}l.geometry.points=[]},i.prototype.buildFlowDict=function(e){return e.DefaultProcess.GetFlowElements()},i.prototype.buildFlowDiagDict=function(e){var t={},i={},n=e.DefaultDiagram.BpmnPlane.GetDiagramElements();return n&&n.forEach((function(e){e instanceof X?t[e.BpmnElementId]=e:e instanceof Z&&(i[e.BpmnElementId]=e)})),{nodeDict:t,edgeDict:i}},i.prototype.bindBpmnElements=function(e,t){var i=this;e&&e.forEach((function(e){e instanceof je&&(e.editorUi=i.editorUi,e.bindBpmnModel())}))},i.prototype.getCellByFlowElementId=function(e,t){return null==e?null:(t=t||this.getDefaultParent(),this.getChildCells(t).find((function(t){return t instanceof je&&(t.flowElement&&t.flowElement.Id==e)})))},i.prototype.updateEdgeState=function(e){this.updateEdgeWaypoints(e),this.updateEdgeLabel(e)},i.prototype.updateEdgeWaypoints=function(e){if(null!=e){var t=this.view.getState(e),i=this.view.getScale(),n=this.view.getTranslate(),o=[];t&&t.absolutePoints&&t.absolutePoints.forEach((function(e,t){o.push(Lt.getRelativePositon(e,i,n))})),e.setPoints(o)}},i.prototype.updateEdgeLabel=function(e){var t=this.view.getState(e),i=this.view.getScale(),n=this.view.getTranslate(),o=Lt.getRelativePositon(t.absoluteOffset,i,n),r=t.text&&t.text.boundingBox?t.text.boundingBox.width/i:0,l=t.text&&t.text.boundingBox?t.text.boundingBox.height/i:0,a=t.text&&t.text.boundingBox?new m(o.x,o.y,r,l):null;e.setBpmnLabel(a)},i.prototype.createInfiniteCanvas=function(){var e=this;this.getPagePadding=function(){return new p(Math.max(0,Math.round(e.container.offsetWidth-34)),Math.max(0,Math.round(e.container.offsetHeight-34)))},this.getScrollTileSize=function(){return null==e.scrollTileSize&&(e.scrollTileSize=new m(0,0,400,600)),e.scrollTileSize},this.getPageSize=function(){return e.pageVisible?new m(0,0,e.pageFormat.width*e.pageScale,e.pageFormat.height*e.pageScale):e.getScrollTileSize()},this.getPageLayout=function(){var t=e.pageVisible?e.getPageSize():e.getScrollTileSize(),i=e.getGraphBounds();if(0==i.width||0==i.height)return new m(0,0,1,1);var n=Math.ceil(i.x/e.view.scale-e.view.translate.x),o=Math.ceil(i.y/e.view.scale-e.view.translate.y),r=Math.floor(i.width/e.view.scale),l=Math.floor(i.height/e.view.scale),a=Math.floor(n/t.width),s=Math.floor(o/t.height),d=Math.ceil((n+r)/t.width)-a,u=Math.ceil((o+l)/t.height)-s;return new m(a,s,d,u)},this.getPreferredPageSize=function(t,i,n){var o=e.getPageLayout(),r=e.getPageSize();return new m(0,0,o.width*r.width,o.height*r.height)};var t=this.sizeDidChange;this.sizeDidChange=function(){if(null!=e.container&&u.hasScrollbars(e.container)){var i=e.getPageLayout(),n=e.getPagePadding(),o=e.getPageSize(),r=Math.ceil(2*n.x/e.view.scale+i.width*o.width),l=Math.ceil(2*n.y/e.view.scale+i.height*o.height),a=e.minimumGraphSize;null!=a&&a.width==r&&a.height==l||(e.minimumGraphSize=new m(0,0,r,l));var s=n.x/e.view.scale-i.x*o.width,d=n.y/e.view.scale-i.y*o.height;if(!e.autoTranslate&&(e.view.translate.x!=s||e.view.translate.y!=d)){e.autoTranslate=!0,e.view.x0=i.x,e.view.y0=i.y;var h=e.view.translate.x,c=e.view.translate.y;return e.view.setTranslate(s,d),e.container.scrollLeft+=(s-h)*e.view.scale,e.container.scrollTop+=(d-c)*e.view.scale,void(e.autoTranslate=!1)}t.apply(e,[])}},this.view.getBackgroundPageBounds=function(){var t=e.getPageLayout(),i=e.getPageSize();return new m(e.view.scale*(e.view.translate.x+t.x*i.width),e.view.scale*(e.view.translate.y+t.y*i.height),e.view.scale*t.width*i.width,e.view.scale*t.height*i.height)};var i=this.view.validate;this.view.validate=function(t){if(null!=e.container&&u.hasScrollbars(e.container)){var n=e.getPagePadding(),o=e.getPageSize();e.view.translate.x,e.view.translate.y,e.view.translate.x=n.x/e.view.scale-(e.view.x0||0)*o.width,e.view.translate.y=n.y/e.view.scale-(e.view.y0||0)*o.height}i.apply(e.view,[t])}},i.prototype.setMultiConstraints=function(){var e=this;y.prototype.pointImage=new C(et.IMAGE_PATH+"/round-drop.png",8,8),w.prototype.getConstraints=function(e,t,i){return null},v.prototype.constraints=[new E(new p(.5,0),!0),new E(new p(0,.5),!0),new E(new p(1,.5),!0),new E(new p(.5,1),!0)],this.setPortsEnabled(!1),this.connectionHandler.isConnectableCell=function(e){return!1},b.prototype.isConnectableCell=function(t){return e.connectionHandler.isConnectableCell(t)},this.view.getTerminalPort=function(e,t,i){return t},this.getAllConnectionConstraints=function(e,t){if(null!=e){var i=u.getValue(e.style,"points",null);if(null!=i){var n=[];try{for(var r=JSON.parse(i),l=0;l<r.length;l++){var a=r[l];n.push(new E(new p(a[0],a[1]),!(a.length>2)||"0"!=a[2],null,a.length>3?a[3]:0,a.length>4?a[4]:0))}}catch(e){}return n}if(null!=e.shape&&null!=e.shape.bounds){var s=e.shape.direction,d=e.shape.bounds,h=e.shape.scale,c=d.width/h,f=d.height/h;if(s==o.DIRECTION_NORTH||s==o.DIRECTION_SOUTH){a=c;c=f,f=a}if(null!=(i=e.shape.getConstraints(e.style,c,f)))return i;if(null!=e.shape.stencil&&null!=e.shape.stencil.constraints)return e.shape.stencil.constraints;if(null!=e.shape.constraints)return e.shape.constraints}}return null},this.setConnectionConstraint=function(t,i,n,r){null!=r&&null!=r.point&&(n?(e.setCellStyles(o.STYLE_EXIT_X,r.point.x,[t]),e.setCellStyles(o.STYLE_EXIT_Y,r.point.y,[t])):(e.setCellStyles(o.STYLE_ENTRY_X,r.point.x,[t]),e.setCellStyles(o.STYLE_ENTRY_Y,r.point.y,[t])))},this.getConnectionConstraint=function(e,t,i){var n=new p;return i?(n.x=e.style[o.STYLE_EXIT_X],n.y=e.style[o.STYLE_EXIT_Y]):(n.x=e.style[o.STYLE_ENTRY_X],n.y=e.style[o.STYLE_ENTRY_Y]),v.prototype.constraints?v.prototype.constraints.find((function(e){return e.point.x==n.x&&e.point.y==n.y})):null}},i.prototype.distributeCells=function(e,t){if(null==t&&(t=this.getSelectionCells()),null!=t&&t.length>1){for(var i=[],n=null,o=null,r=0;r<t.length;r++)if(this.getModel().isVertex(t[r])){var l=this.view.getState(t[r]);if(null!=l){var a=e?l.getCenterX():l.getCenterY();n=null!=n?Math.max(n,a):a,o=null!=o?Math.min(o,a):a,i.push(l)}}if(i.length>2){i.sort((function(t,i){return e?t.x-i.x:t.y-i.y}));var s=this.view.translate,d=this.view.scale;o=o/d-(e?s.x:s.y),n=n/d-(e?s.x:s.y),this.getModel().beginUpdate();try{var u=(n-o)/(i.length-1),h=o;for(r=1;r<i.length-1;r++){var c=this.view.getState(this.model.getParent(i[r].cell)),p=this.getCellGeometry(i[r].cell);h+=u,null!=p&&null!=c&&(p=p.clone(),e?p.x=Math.round(h-p.width/2)-c.origin.x:p.y=Math.round(h-p.height/2)-c.origin.y,this.getModel().setGeometry(i[r].cell,p))}}finally{this.getModel().endUpdate()}}}return t},i.prototype.createGraphView=function(){return new xt(this)},i.prototype.createConnectionHandler=function(){return new S(this,(function(e,t,i){var n=at.generate(rt.CLR_TYPE_ID,void 0,new g,i);return n.geometry.relative=!0,n.source=e,n.target=t,n}))},i.prototype.getLabel=function(t){if(t instanceof je){if(this.editorUi.multiLangEnabled){var i=e.prototype.getLabel.call(this,t);return null!=t.flowElement&&(i=t.flowElement.Name,t.flowElement.NameLanguage&&null!=t.flowElement.NameLanguage[this.editorUi.langCode]&&""!=t.flowElement.NameLanguage[this.editorUi.langCode]&&(i=t.flowElement.NameLanguage[this.editorUi.langCode])),i}return t.flowElement&&t.flowElement.Name||e.prototype.getLabel.call(this,t)}return e.prototype.getLabel.call(this,t)},i.prototype.setGridEnabled=function(i){e.prototype.setGridEnabled.call(this,i),this.fireEvent(new t(Q.GridEnabledChanged))},i.prototype.isSwimlane=function(e){return"string"==typeof this.model.getValue(e)&&this.model.getValue(e).toString().indexOf("Container")>-1},i.prototype.isOldBpmnEdge=function(e){if(e.Points.length>=2){var t=e.Points[0],i=e.Points[1];if(0==t.X&&0==t.Y&&0==i.X&&0==i.Y)return!0}return!1},i.defaultPageBackgroundColor="#ffffff",i.defaultPageBorderColor="#ffffff",i}(_)),Pt=e("KeyHandler",function(e){function t(t){var i=e.call(this,t)||this;return i.altKeys={},i.ctrlAltKeys={},i.shiftAltKeys={},i.ctrlShiftAltKeys={},i}return J(t,e),t.prototype.isControlDown=function(e){return s.isControlDown(e)||i.IS_MAC&&e.metaKey},t.prototype.getFunction=function(t){return null!=t&&s.isAltDown(t)?this.isControlDown(t)?s.isShiftDown(t)?this.ctrlShiftAltKeys[t.keyCode]:this.ctrlAltKeys[t.keyCode]:s.isShiftDown(t)?this.shiftAltKeys[t.keyCode]:this.altKeys[t.keyCode]:e.prototype.getFunction.call(this,t)},t.prototype.bindAction=function(e,t,i,n,o){void 0===i&&(i=!1),void 0===n&&(n=!1),void 0===o&&(o=!1),i?n?o?this.bindCtrlShiftAltKey(t,e):this.bindControlShiftKey(t,e):o?this.bindCtrlAltKey(t,e):this.bindControlKey(t,e):n?o?this.bindShiftAltKey(t,e):this.bindShiftKey(t,e):this.bindKey(t,e)},t.prototype.bindAltKey=function(e,t){this.altKeys[e]=t},t.prototype.bindCtrlAltKey=function(e,t){this.ctrlAltKeys[e]=t},t.prototype.bindShiftAltKey=function(e,t){this.shiftAltKeys[e]=t},t.prototype.bindCtrlShiftAltKey=function(e,t){this.ctrlShiftAltKeys[e]=t},t}(I)),Ut=e("Menubar",(function(e,t){this.editorUi=e,this.container=t})),Dt=e("Sidebar",function(){function e(e,t){this.thumbWidth=36,this.thumbHeight=36,this.thumbPadding=document.documentMode>=5?0:1,this.thumbBorder=2,this.sidebarTitleSize=12,this.sidebarTitles=!0,this.tooltipTitles=!0,this.enableTooltips=!0,this.showTooltips=!0,this.tooltipImageSrc=et.IMAGE_PATH+"/tooltip.png",this.tooltipDelay=300,this.tooltipBorder=16,this.maxTooltipWidth=400,this.maxTooltipHeight=400,this.collapsedImage=et.IMAGE_PATH+"/collapsed.gif",this.expandedImage=et.IMAGE_PATH+"/expanded.gif",this.defaultImageHeight=36,this.defaultImageWidth=36,this.dragPreviewBorder="1px dashed black",this.palettes={},this.editorUi=e,this.container=t,this.graph=this.createTemporaryGraph(this.editorUi.graph.getStylesheet()),this.graph.cellRenderer.antiAlias=!1,this.graph.foldingEnabled=!1,i.IS_IE||i.IS_IE11||(this.graph.container.style.display="none")}return e.prototype.createTemporaryGraph=function(e){var t=new _(document.createElement("div"),null,null,e);return t.resetViewOnRootChange=!1,t.setConnectable(!1),t.gridEnabled=!1,t.autoScroll=!1,t.setTooltips(!1),t.setEnabled(!1),t.container.style.visibility="hidden",t.container.style.position="absolute",t.container.style.overflow="hidden",t.container.style.height="1px",t.container.style.width="1px",t},e.prototype.reset=function(e){var t=this;e&&e.groups&&e.groups.forEach((function(e){var i=[];e.items&&e.items.forEach((function(e){var n=at.generate(e.clrTypeId,void 0,new g(0,0,t.defaultImageWidth,t.defaultImageHeight));n.edge&&(n.geometry.setTerminalPoint(new p(0,t.defaultImageHeight),!0),n.geometry.setTerminalPoint(new p(t.defaultImageWidth,0),!1),n.geometry.relative=!0),i.push(t.createItemFactory([n],n.nameLanguage&&n.nameLanguage[t.editorUi.langCode]||n.name,t.defaultImageWidth,t.defaultImageHeight))})),t.addPaletteFunctions(e.name,e.name,!0,i)}))},e.prototype.addPaletteFunctions=function(e,t,i,n){this.addPalette(e,t,i,(function(e){for(var t=0;t<n.length;t++)e.appendChild(n[t]())}))},e.prototype.addPalette=function(e,t,n,o){var r=this.createPaletteTitle(t);this.container.appendChild(r);var l=document.createElement("div");l.className="geSidebar",i.IS_POINTER&&(l.style.touchAction="none"),n?(o(l),o=null):l.style.display="none",this.addFoldingHandler(r,l,o);var a=document.createElement("div");a.appendChild(l),this.container.appendChild(a),null!=e&&(this.palettes[e]=[r,a])},e.prototype.createPaletteTitle=function(e){var t=document.createElement("a");return t.setAttribute("href","javascript:void(0);"),t.setAttribute("title",a.get("sidebarTooltip")),t.className="geTitle",u.write(t,e),t},e.prototype.addFoldingHandler=function(e,t,n){var o=this,r=!1;(!i.IS_IE||document.documentMode>=8)&&(e.style.backgroundImage="none"==t.style.display?"url('"+this.collapsedImage+"')":"url('"+this.expandedImage+"')"),e.style.backgroundRepeat="no-repeat",e.style.backgroundPosition="0% 50%",s.addListener(e,"click",(function(l){if("none"==t.style.display){if(r)t.style.display="block";else if(r=!0,null!=n){e.style.cursor="wait";var d=e.innerHTML;e.innerHTML=a.get("loading")+"...",window.setTimeout((function(){var o=i.NO_FO;i.NO_FO=et.ORIGINAL_NO_FO,n(t),i.NO_FO=o,t.style.display="block",e.style.cursor="",e.innerHTML=d}),0)}else t.style.display="block";e.style.backgroundImage="url('"+o.expandedImage+"')"}else e.style.backgroundImage="url('"+o.collapsedImage+"')",t.style.display="none";s.consume(l)}))},e.prototype.createItemFactory=function(e,t,i,n,o,r,l){var a=this;void 0===o&&(o=!0),void 0===r&&(r=!0),void 0===l&&(l=!0);return function(){return a.createItem(e,t,o,r,i,n,l)}},e.prototype.createItem=function(e,t,n,o,r,l,a){var d=this,u=document.createElement("a");u.setAttribute("href","javascript:void(0);"),u.className="geItem",u.style.overflow="hidden",i.IS_QUIRKS?this.thumbPadding:this.thumbBorder,u.style.width="70px",u.style.height="70px",i.IS_IE6&&(u.style.border="none"),s.addListener(u,"click",(function(e){s.consume(e)})),this.createThumb(e,this.thumbWidth,this.thumbHeight,u,t,n,o,r,l);var h=new m(0,0,r,l);if(e.length>0){var c=this.createDropHandler(e,!1,a,h),p=this.createDragPreview(r,l);this.createDragSource(u,c,p,e,h)}return i.IS_IOS||(s.addGestureListeners(u,null,(function(i){s.isMouseEvent(i)&&d.showTooltip(u,e,h.width,h.height,t,n)})),s.addListener(u,i.IS_POINTER?"pointerdown":"mousedown",(function(){d.hideTooltip(),d.showTooltips=!1})),s.addListener(u,i.IS_POINTER?"pointerup":"mouseup",(function(){d.showTooltips=!0})),s.addListener(u,i.IS_POINTER?"pointerleave":"mouseleave",(function(e){d.hideTooltip(),d.showTooltips=!0}))),u},e.prototype.createThumb=function(e,t,n,r,l,a,s,d,h){this.graph.labelsVisible=null==a||a;var c=i.NO_FO;i.NO_FO=et.ORIGINAL_NO_FO,this.graph.view.scaleAndTranslate(1,0,0),this.graph.addCells(e);var p=this.graph.getGraphBounds(),f=Math.floor(100*Math.min((t-2*this.thumbBorder)/p.width,(n-2*this.thumbBorder)/p.height))/100;this.graph.view.scaleAndTranslate(f,Math.floor((t-p.width*f)/2/f-p.x),Math.floor((n-p.height*f)/2/f-p.y));var g=null;if(this.graph.dialect!=o.DIALECT_SVG||i.NO_FO?(g=this.graph.container.cloneNode(!1)).innerHTML=this.graph.container.innerHTML:g=this.graph.view.getCanvas().ownerSVGElement.cloneNode(!0),this.graph.getModel().clear(),i.NO_FO=c,i.IS_IE6&&(r.style.backgroundImage="url("+et.TRANSPARENT_IMAGE+")"),g.style.position="relative",g.style.overflow="hidden",g.style.cursor="move",g.style.left=this.thumbBorder+"px",g.style.top=this.thumbBorder+"px",g.style.width=t+"px",g.style.height=n+"px",g.style.visibility="",g.style.minWidth="",g.style.minHeight="",g.style.display="block",g.style.margin="0 auto",g.style.paddingTop="4px",r.appendChild(g),this.sidebarTitles&&null!=l&&0!=s){i.IS_QUIRKS&&this.thumbPadding;var m=document.createElement("div");m.style.fontSize=i.IS_FF?this.sidebarTitleSize+2+"px":this.sidebarTitleSize+"px",m.style.color="#303030",m.style.textAlign="center",m.style.whiteSpace="nowrap",i.IS_IE&&(m.style.height=this.sidebarTitleSize+12+"px"),m.style.paddingTop="5px",u.write(m,l),r.appendChild(m)}},e.prototype.showTooltip=function(e,t,n,o,r,l){var a=this;if(this.enableTooltips&&this.showTooltips&&this.currentElt!=e){null!=this.thread&&(window.clearTimeout(this.thread),this.thread=null);var s=function(){null==a.tooltip&&(a.tooltip=document.createElement("div"),a.tooltip.className="geSidebarTooltip",a.tooltip.style.zIndex=(T.prototype.zIndex-1).toString(),document.body.appendChild(a.tooltip),a.graph2=new _(a.tooltip,null,null,a.editorUi.graph.getStylesheet()),a.graph2.resetViewOnRootChange=!1,a.graph2.foldingEnabled=!1,a.graph2.gridEnabled=!1,a.graph2.autoScroll=!1,a.graph2.setTooltips(!1),a.graph2.setConnectable(!1),a.graph2.setEnabled(!1),i.IS_SVG||(a.graph2.view.canvas.style.position="relative"),a.tooltipImage=u.createImage(a.tooltipImageSrc),a.tooltipImage.className="geSidebarTooltipImage",a.tooltipImage.style.zIndex=(T.prototype.zIndex-1).toString(),a.tooltipImage.style.position="absolute",a.tooltipImage.style.width="14px",a.tooltipImage.style.height="27px",document.body.appendChild(a.tooltipImage)),a.graph2.model.clear(),a.graph2.view.setTranslate(a.tooltipBorder,a.tooltipBorder),n>a.maxTooltipWidth||o>a.maxTooltipHeight?a.graph2.view.scale=Math.round(100*Math.min(a.maxTooltipWidth/n,a.maxTooltipHeight/o))/100:a.graph2.view.scale=1,a.tooltip.style.display="block",a.graph2.labelsVisible=null==l||l;var s=i.NO_FO;i.NO_FO=et.ORIGINAL_NO_FO,a.graph2.addCells(t),i.NO_FO=s;var d=a.graph2.getGraphBounds(),h=d.width+2*a.tooltipBorder+4,c=d.height+2*a.tooltipBorder;if(i.IS_QUIRKS?(c+=4,a.tooltip.style.overflow="hidden"):a.tooltip.style.overflow="visible",a.tooltipImage.style.visibility="visible",a.tooltip.style.width=h+"px",a.tooltipTitles&&null!=r&&r.length>0){null==a.tooltipTitle?(a.tooltipTitle=document.createElement("div"),a.tooltipTitle.style.borderTop="1px solid gray",a.tooltipTitle.style.textAlign="center",a.tooltipTitle.style.width="100%",a.tooltipTitle.style.overflow="hidden",i.IS_SVG||(a.tooltipTitle.style.position="absolute"),a.tooltipTitle.style.paddingTop="6px",a.tooltip.appendChild(a.tooltipTitle)):a.tooltipTitle.innerHTML="",a.tooltipTitle.style.display="",u.write(a.tooltipTitle,r);var f=a.tooltipTitle.offsetHeight+10;c+=f,i.IS_SVG?a.tooltipTitle.style.marginTop=2-f+"px":(c-=6,a.tooltipTitle.style.top=c-f+"px")}else null!=a.tooltipTitle&&null!=a.tooltipTitle.parentNode&&(a.tooltipTitle.style.display="none");a.tooltip.style.height=c+"px";var g=-Math.round(d.x-a.tooltipBorder),m=-Math.round(d.y-a.tooltipBorder),y=document.body,C=document.documentElement,w=new p(0,0),v=Math.max(y.clientHeight||0,C.clientHeight),E=a.container.clientWidth+a.editorUi.sidebarSplitSize+3+a.editorUi.container.offsetLeft+w.x,b=Math.min(v-c-20,Math.max(0,a.editorUi.container.offsetTop+a.container.offsetTop+e.offsetTop-a.container.scrollTop-c/2+16))+w.y;i.IS_SVG?0!=g||0!=m?a.graph2.view.canvas.setAttribute("transform","translate("+g+","+m+")"):a.graph2.view.canvas.removeAttribute("transform"):(a.graph2.view.drawPane.style.left=g+"px",a.graph2.view.drawPane.style.top=m+"px"),a.tooltip.style.position="absolute",a.tooltip.style.left=E+"px",a.tooltip.style.top=b+"px",a.tooltipImage.style.left=E-13+"px",a.tooltipImage.style.top=b+c/2-13+"px"};null!=this.tooltip&&"none"!=this.tooltip.style.display?s():this.thread=window.setTimeout(s,this.tooltipDelay),this.currentElt=e}},e.prototype.hideTooltip=function(){null!=this.thread&&(window.clearTimeout(this.thread),this.thread=null),null!=this.tooltip&&(this.tooltip.style.display="none",this.tooltipImage.style.visibility="hidden",this.currentElt=null)},e.prototype.createDragSource=function(e,t,i,n,o){var r=u.makeDraggable(e,this.editorUi.graph,(function(e,i,n,o,r){t(e,i,n,o,r)}),i,0,0,null,!0,!0);return r.isGuidesEnabled=function(){return!0},r},e.prototype.createDropHandler=function(e,i,n,o){var r=this;void 0===n&&(n=!0);return function(l,a,d,u,h,c){for(var p=c?null:s.isTouchEvent(a)||s.isPenEvent(a)?document.elementFromPoint(s.getClientX(a),s.getClientY(a)):s.getSource(a);null!=p&&p!=r.container;)p=p.parentNode;if(null==p&&l.isEnabled()){if((e=l.getImportableCells(e)).length>0){l.stopEditing();var f=null!=d&&!s.isAltDown(a)&&l.isValidDropTarget(d,e,a),g=null;if(null==d||f||(d=null),!l.isCellLocked(d||l.getDefaultParent())){l.model.beginUpdate();try{if(u=Math.round(u),h=Math.round(h),i&&l.isSplitTarget(d,e,a)){var m=l.view.scale,y=(u+(E=l.view.translate).x)*m,C=(h+E.y)*m,w=l.cloneCells(e);l.splitEdge(d,w,null,u-o.width/2,h-o.height/2,y,C),g=w}else e.length>0&&(g=l.importCells(e,u,h,d));if(null!=l.layoutManager){var v=l.layoutManager.getLayout(d);if(null!=v){m=l.view.scale,y=(u+(E=l.view.translate).x)*m,C=(h+E.y)*m;for(var E,b=0;b<g.length;b++)v.moveCell(g[b],y,C)}}l.bindBpmnElements(g),!n||null!=a&&s.isShiftDown(a)||l.fireEvent(new t(Q.CellsInserted,"cells",g))}finally{l.model.endUpdate()}null!=g&&g.length>0&&(l.scrollCellToVisible(g[0]),l.setSelectionCells(g))}}s.consume(a)}}},e.prototype.createDragPreview=function(e,t){var i=document.createElement("div");return i.style.border=this.dragPreviewBorder,i.style.width=e+"px",i.style.height=t+"px",i},e.prototype.destroy=function(){null!=this.graph&&(null!=this.graph.container&&null!=this.graph.container.parentNode&&this.graph.container.parentNode.removeChild(this.graph.container),this.graph.destroy(),this.graph=null)},e}()),Nt=e("Toolbar",function(){function e(e,t){this.dropdownImage=i.IS_SVG?"data:image/gif;base64,R0lGODlhDQANAIABAHt7e////yH/C1hNUCBEYXRhWE1QPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS4wLWMwNjAgNjEuMTM0Nzc3LCAyMDEwLzAyLzEyLTE3OjMyOjAwICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpCREM1NkJFMjE0NEMxMUU1ODk1Q0M5MjQ0MTA4QjNDMSIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDpCREM1NkJFMzE0NEMxMUU1ODk1Q0M5MjQ0MTA4QjNDMSI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkQzOUMzMjZCMTQ0QjExRTU4OTVDQzkyNDQxMDhCM0MxIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkQzOUMzMjZDMTQ0QjExRTU4OTVDQzkyNDQxMDhCM0MxIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+Af/+/fz7+vn49/b19PPy8fDv7u3s6+rp6Ofm5eTj4uHg397d3Nva2djX1tXU09LR0M/OzczLysnIx8bFxMPCwcC/vr28u7q5uLe2tbSzsrGwr66trKuqqainpqWko6KhoJ+enZybmpmYl5aVlJOSkZCPjo2Mi4qJiIeGhYSDgoGAf359fHt6eXh3dnV0c3JxcG9ubWxramloZ2ZlZGNiYWBfXl1cW1pZWFdWVVRTUlFQT05NTEtKSUhHRkVEQ0JBQD8+PTw7Ojk4NzY1NDMyMTAvLi0sKyopKCcmJSQjIiEgHx4dHBsaGRgXFhUUExIREA8ODQwLCgkIBwYFBAMCAQAAIfkEAQAAAQAsAAAAAA0ADQAAAhGMj6nL3QAjVHIu6azbvPtWAAA7":et.IMAGE_PATH+"/dropdown.gif",this.container=t,this.editorUi=e}return e.prototype.reset=function(e){for(var t=this;this.container.hasChildNodes();)this.container.removeChild(this.container.firstChild);null!=e&&e.itemList.forEach((function(e){if(e instanceof ct){var i=t.buildToolbarButton(e);t.container.appendChild(i),e.elt=i}if(e instanceof ft){i=t.buildToolbarButton(e);t.container.appendChild(i),e.elt=i}if(e instanceof Ct){i=t.addToolbarSeparator();e.elt=i}}))},e.prototype.destroy=function(){},e.prototype.buildToolbarButton=function(e){var t=this,i=e.toolTipText||a.get(e.resourceKey)||"";if(e instanceof ct){var n=this.editorUi.actions.getAction(e.actionKey);null!=n&&null!=n.getShortcut()&&(i+=" ("+n.getShortcut()+")")}var o=this.createToolbarButton(i);if(e.displayStyle==st.ImageAndText||e.displayStyle==st.Image){var r=this.createToolbarButtonImage(e.imageSrc,e.imageClassName);o.appendChild(r)}if(e.displayStyle==st.ImageAndText||e.displayStyle==st.Text){var l=this.createToolbarButtonText(e.text||a.get(e.resourceKey));o.appendChild(l),e.resourceKey==ht.pmf_zoom&&this.editorUi.graph.view.addListener(s.EVENT_SCALE,(function(){l.innerText=Math.round(100*t.editorUi.graph.view.scale)+"%"}))}if(e instanceof ct&&this.addToolbarButtonHandler(o,e),e instanceof ft){var d=this.createToolbarButtonDropdownImage();o.appendChild(d),this.addToolbarDropDownButtonHandler(o,e)}return o},e.prototype.addToolbarSeparator=function(e){e=null!=e?e:this.container;var t=document.createElement("div");return t.className="geSeparator",e.appendChild(t),t},e.prototype.createToolbarButton=function(e){var t=document.createElement("a");return t.setAttribute("href","javascript:void(0);"),t.className="geLabel",t.style.color="#000000",null!=e&&(t.title=e),t},e.prototype.createToolbarButtonImage=function(e,t){var i=document.createElement("img");return i.src=e,null!=t&&(i.className=t),i.style.display="inline-block",i.style.verticalAlign="middle",i},e.prototype.createToolbarButtonText=function(e,t){var i=document.createElement("div");return u.write(i,e),null!=t&&(i.className=t),i.style.display="inline-block",i.style.verticalAlign="middle",i.style.paddingLeft="2px",i},e.prototype.createToolbarButtonDropdownImage=function(){var e=document.createElement("img");return e.src=this.dropdownImage,e.style.display="inline-block",e.style.verticalAlign="middle",e.style.paddingLeft="2px",e},e.prototype.addToolbarButtonHandler=function(e,t){var i=this.editorUi.actions.getAction(t.actionKey);if(null!=i){s.addListener(e,"click",(function(e){null!=i&&i.isEnabled()&&i.execute(e),s.consume(e)})),null!=document.documentMode&&document.documentMode>=9&&s.addListener(e,"mousedown",(function(e){e.preventDefault()}));var n=e.className;e.setEnabled=function(t){e.className=t?n:n+" mxDisabled"},e.setEnabled(i.isEnabled()),i.addListener(Q.StateChanged,(function(){e.setEnabled(i.isEnabled())}))}},e.prototype.addToolbarDropDownButtonHandler=function(e,t,i,n){var o=this;void 0===i&&(i=!0),void 0===n&&(n=!0);var r=!0,l=function(e,i,n){o.addPopupMenuItems(e,t.items,e)};s.addListener(e,"click",(function(t){if(r&&(null==e.enabled||e.enabled)){o.editorUi.graph.popupMenuHandler.hideMenu();var a=new T(l);a.div.className+=" geToolbarMenu",a.showDisabled=n,a.labels=i,a.autoExpand=!0;var d=u.getOffset(e);a.popup(d.x,d.y+e.offsetHeight,null,t),o.editorUi.setCurrentMenu(a,e),!i&&a.div.scrollHeight>a.div.clientHeight&&(a.div.style.width="40px"),a.hideMenu=function(){T.prototype.hideMenu.apply(a),o.editorUi.resetCurrentMenu(),a.destroy()}}r=!0,s.consume(t)})),s.addListener(e,"mousedown",(function(t){r=o.currentElt!=e,null!=document.documentMode&&document.documentMode>=9&&t.preventDefault()}))},e.prototype.addPopupMenuItems=function(e,t,i){var n=this;t.forEach((function(t){if(t instanceof yt){var o=n.editorUi.actions.getAction(t.actionKey),r=e.addItem(t.text||a.get(t.resourceKey),null,(function(e){null!=o&&o.isEnabled()&&o.execute(e)}),i,null,null!=o&&o.isEnabled());null!=o&&o.isToggleAction()&&o.isSelected()&&e.addCheckmark(r,et.CHECK_MARK_IMAGE),n.addShortcut(r,o),t.elt=r}if(t instanceof Ct&&e.addSeparator(i),t instanceof gt){r=e.addItem(t.text||a.get(t.resourceKey),null,null,i);n.addPopupMenuItems(e,t.items,r),t.elt=r}}))},e.prototype.addShortcut=function(e,t){if(null!=t&&null!=t.getShortcut()){var i=e.firstChild.nextSibling.nextSibling,n=document.createElement("span");n.style.color="gray",u.write(n,t.getShortcut()),i.appendChild(n)}},e}());e("MxGraphInnerClass",wt),function(e){e.mxCellCodec="mxCellCodec",e.mxChildChangeCodec="mxChildChangeCodec",e.mxDefaultKeyHandlerCodec="mxDefaultKeyHandlerCodec",e.mxDefaultPopupMenuCodec="mxDefaultPopupMenuCodec",e.mxEditorCodec="mxEditorCodec",e.mxGraphCodec="mxGraphCodec",e.mxGraphViewCodec="mxGraphViewCodec",e.mxModelCodec="mxModelCodec",e.mxRootChangeCodec="mxRootChangeCodec",e.mxTerminalChangeCodec="mxTerminalChangeCodec",e.mxRootChange="mxRootChange",e.mxChildChange="mxChildChange",e.mxTerminalChange="mxTerminalChange",e.mxValueChange="mxValueChange",e.mxStyleChange="mxStyleChange",e.mxGeometryChange="mxGeometryChange",e.mxCollapseChange="mxCollapseChange",e.mxVisibleChange="mxVisibleChange",e.mxCellAttributeChange="mxCellAttributeChange",e.renderingHint="renderingHint",e.mxSelectionChange="mxSelectionChange",e.mxCurrentRootChange="mxCurrentRootChange"}(wt||e("MxGraphInnerClass",wt={}));e("EditorUi",function(e){function n(t,n,o){void 0===o&&(o=!0);var r=e.call(this,n)||this;return r.menubarHeight=30,r.toolbarHeight=34,r.formatWidth=240,r.footerHeight=28,r.sidebarSplitPosition=screen.width<=640?118:243,r.sidebarSplitSize=i.IS_TOUCH||i.IS_POINTER?12:8,r.diagramMinWidth=50,r.sidebarFooterHeight=34,r.zeroOffset=new p(0,0),r.showMenubar=!1,r.showToolbar=!1,r.showSidebar=!0,r.showFormat=!1,r.showFooter=!1,r.destroyFunctions=[],r.multiLangEnabled=!1,r.langCode=window.gspframeworkService&&window.gspframeworkService.rtf&&window.gspframeworkService.rtf.language&&window.gspframeworkService.rtf.language.getLanguageCode&&window.gspframeworkService.rtf.language.getLanguageCode()||localStorage.getItem("languageCode")||"zh-CHS",r.container=t||document.body,o&&r.importStyles(),r}return J(n,e),n.prototype.importStyles=function(){var e=document.createElement("link");e.rel="stylesheet",e.href=(window.mxiGIXBasePath?window.mxiGIXBasePath:"")+"/platform/runtime/common/web/@edp-pmf/grapheditor/styles/grapheditor.css?v="+(new Date).getTime(),document.head.appendChild(e);var t=document.createElement("link");t.rel="stylesheet",t.href=(window.mxiGIXBasePath?window.mxiGIXBasePath:"")+"/platform/runtime/common/web/@edp-pmf/grapheditor/styles/pmf.css?v="+(new Date).getTime(),document.head.appendChild(t)},n.prototype.updateProperty=function(e){var t=this.graph.getCellByFlowElementId(e.Id);t?t.updateProps(e):this.graph.processCell.updateProps(e)},n.prototype.getFarrisPropConfig=function(e){if(e&&e.length>0&&null!=e[0]){var t=e[0];return this.getCellFarrisPropConfig(t)}return this.getProcessFarrisPropConfig()},n.prototype.getProcessFarrisPropConfig=function(){return this.graph.processCell.getFarrisPropConfig()},n.prototype.getCellFarrisPropConfig=function(e){return e.getFarrisPropConfig()},n.prototype.show=function(){var e=this;this.createDivs(),this.refresh(!1),this.graph=this.createGraph(),this.keyHandler=this.createKeyHandler(this.graph),this.actions=this.createActions(),this.toolbarItems=this.createToolbarItems(),this.showMenubar&&(this.menubar=this.createMenubar()),this.showToolbar&&(this.toolbar=this.createToolbar()),this.showSidebar&&(this.sidebar=this.createSidebar()),this.showFormat&&(this.format=this.createFormat()),this.showFooter&&(this.footer=this.createFooter()),this.resetToolbar(this.toolbarItems),this.resetToolbox(),s.disableContextMenu(this.container),this.gestureHandler=function(t){null!=e.currentMenu&&s.getSource(t)!=e.currentMenu.div&&e.hideCurrentMenu()},s.addGestureListeners(document,this.gestureHandler),this.resizeHandler=function(){window.setTimeout((function(){null!=e.graph&&e.refresh()}),0)},s.addListener(window,"resize",this.resizeHandler),this.addListener(Q.ResetGraphView,(function(){e.resetScrollbars()})),this.fireEvent(new t(Q.ResetGraphView)),this.addBpmnListeners()},n.prototype.refresh=function(e){void 0===e&&(e=!0);var n=i.IS_QUIRKS,o=this.container.clientWidth,r=this.container.clientHeight;this.container==document.body&&(o=document.body.clientWidth||document.documentElement.clientWidth,r=n&&document.body.clientHeight||document.documentElement.clientHeight);var l=0;i.IS_IOS&&!window.navigator.standalone&&window.innerHeight!=document.documentElement.clientHeight&&(l=document.documentElement.clientHeight-window.innerHeight,window.scrollTo(0,0));var a=this.showMenubar?this.menubarHeight:0,s=this.showToolbar?this.toolbarHeight:0,d=this.showFooter?this.formatWidth:0,u=this.showFooter?this.footerHeight:0,h=0;this.menubarContainer.style.height=a+"px",h+=a,this.toolbarContainer.style.top=a+"px",this.toolbarContainer.style.height=s+"px",(h+=s)>0&&!i.IS_QUIRKS&&(h+=1);var c=Math.max(0,Math.min(this.sidebarSplitPosition,o-this.sidebarSplitSize-20));if(this.showSidebar&&(this.sidebarContainer.style.top=h+"px",this.sidebarContainer.style.width=c+"px",this.sidebarSplit.style.top=this.sidebarContainer.style.top,this.sidebarSplit.style.bottom=u+l+"px",this.sidebarSplit.style.left=c+"px"),this.diagramContainer.style.left=null!=this.sidebarSplit.parentNode&&this.showSidebar?c+this.sidebarSplitSize+"px":"0px",this.diagramContainer.style.top=h+"px",this.formatContainer.style.top=h+"px",this.formatContainer.style.width=d+"px",this.footerContainer.style.height=u+"px",n){this.menubarContainer.style.width=o+"px",this.toolbarContainer.style.width=this.menubarContainer.style.width;var p=Math.max(0,r-u-a-this.toolbarHeight);this.sidebarContainer.style.height=p+"px",this.formatContainer.style.height=p+"px",this.diagramContainer.style.width=null!=this.sidebarSplit.parentNode?Math.max(0,o-c-this.sidebarSplitSize-d)+"px":o+"px",this.footerContainer.style.width=this.menubarContainer.style.width;var f=Math.max(0,r-u-a-this.toolbarHeight);this.diagramContainer.style.height=f+"px",this.sidebarSplit.style.height=f+"px"}else u>0&&(this.footerContainer.style.bottom=l+"px"),this.diagramContainer.style.right=d+"px",this.sidebarContainer.style.bottom=u+l+"px",this.formatContainer.style.bottom=u+l+"px",this.diagramContainer.style.bottom=u+l+"px";e&&null!=this.graph&&(this.graph.sizeDidChange(),this.fireEvent(new t(Q.ResizeGraphView)))},n.prototype.createDivs=function(){var e=this;this.menubarContainer=this.createDiv("geMenubarContainer"),this.menubarContainer.style.top="0px",this.menubarContainer.style.left="0px",this.menubarContainer.style.right="0px",this.container.appendChild(this.menubarContainer),this.toolbarContainer=this.createDiv("geToolbarContainer"),this.toolbarContainer.style.left="0px",this.toolbarContainer.style.right="0px",this.container.appendChild(this.toolbarContainer),this.sidebarContainer=this.createDiv("geSidebarContainer"),this.sidebarContainer.style.left="0px",this.container.appendChild(this.sidebarContainer),this.sidebarSplit=this.createDiv("geHsplit"),this.sidebarSplit.setAttribute("title",a.get("collapseExpand")),this.sidebarSplit.style.width=this.sidebarSplitSize+"px",this.addSplitHandler(this.sidebarSplit,!0,0,(function(t){e.sidebarSplitOnChange(t)})),this.container.appendChild(this.sidebarSplit),this.diagramContainer=this.createDiv("geDiagramContainer"),this.diagramContainer.style.right=(this.showFormat?this.formatWidth:0)+"px",this.diagramContainer.style.overflow="auto",this.container.appendChild(this.diagramContainer),this.formatContainer=this.createDiv("geSidebarContainer"),this.formatContainer.style.right="0px",this.formatContainer.style.zIndex="1",this.formatContainer.style.backgroundColor="whiteSmoke",this.formatContainer.style.overflowX="hidden",this.formatContainer.style.overflowY="auto",this.formatContainer.style.fontSize="12px",this.container.appendChild(this.formatContainer),this.footerContainer=this.createDiv("geFooterContainer"),this.footerContainer.style.left="0px",this.footerContainer.style.right="0px",this.footerContainer.style.bottom="0px",this.footerContainer.style.zIndex=(T.prototype.zIndex-2).toString(),this.container.appendChild(this.footerContainer)},n.prototype.createDiv=function(e){var t=document.createElement("div");return t.className=e,t},n.prototype.addSplitHandler=function(e,t,n,o){var r,l,a=this;o=u.bind(this,o);var d,h=!0;i.IS_POINTER&&(e.style.touchAction="none");var c=function(){var i=parseInt(t?e.style.left:e.style.bottom);return t||(i=i+n-a.footerHeight),i},f=function(e){if(null!=r){var i=new p(s.getClientX(e),s.getClientY(e));o(Math.max(0,(null==l?0:l)+(t?i.x-r.x:r.y-i.y)-n)),s.consume(e),l!=c()&&(h=!0,d=null)}};s.addListener(e,"click",(function(e){if(!h){var t=null!=d?d-n:0;d=c(),o(t),s.consume(e)}})),s.addGestureListeners(e,(function(e){r=new p(s.getClientX(e),s.getClientY(e)),l=c(),h=!1,s.consume(e)}),null,null),s.addGestureListeners(document,null,f,(function(e){f(e),l=null,r=null}))},n.prototype.sidebarSplitOnChange=function(e){this.container.clientWidth-e<=this.formatWidth+this.sidebarSplitSize+this.diagramMinWidth||(this.sidebarSplitPosition=e,this.refresh())},n.prototype.getDiagramContainerOffset=function(){return this.zeroOffset},n.prototype.createGraph=function(){this.beforeCreateGraph();var e=this.createGraphInstance();return this.afterCreateGraph(e),e},n.prototype.beforeCreateGraph=function(){o.DEFAULT_VALID_COLOR="#FFFFFF",o.VALID_COLOR="#00CD66",o.GUIDE_COLOR="#0088cf",o.HIGHLIGHT_STROKEWIDTH=1,o.VERTEX_SELECTION_STROKEWIDTH=1,o.VERTEX_SELECTION_COLOR="#0000CD",o.VERTEX_SELECTION_DASHED=!0,A.prototype.createGuideShape=function(e){return new x([],o.GUIDE_COLOR,o.GUIDE_STROKEWIDTH)}},n.prototype.createGraphInstance=function(){return new Mt(this,this.diagramContainer)},n.prototype.afterCreateGraph=function(e){var i=this;new L(e),e.setDropEnabled(!0),e.setConnectable(!0),e.container.setAttribute("tabindex","0"),e.getSelectionModel().addListener(s.CHANGE,(function(e,n){i.fireEvent(new t(Q.SelectionModelChanged))}));var n=e.fireMouseEvent;e.fireMouseEvent=function(t,i,o){t==s.MOUSE_DOWN&&e.container.focus(),n.apply(e,[t,i,o])},e.createInfiniteCanvas(),e.sizeDidChange(),r.copy=function(e,t){t=(t=t||e.getSelectionCells()).filter((function(e){return e.vertex}));var i=e.getExportableCells(e.model.getTopmostCells(t));return r.insertCount=1,r.setCells(e.cloneCells(i)),i},r.paste=function(e){var t=null;if(!r.isEmpty()){t=(t=e.getImportableCells(r.getCells())).filter((function(e){return e.vertex}));var i=r.insertCount*r.STEPSIZE,n=e.getDefaultParent();e.clearSelection();var o=[];e.model.beginUpdate();try{t.forEach((function(t){var r=e.importCells([t],i,i,n)[0];r.bindBpmnModel(r.flowElement,r.diagramElement),o.push(r)})),r.insertCount++}finally{e.model.endUpdate()}e.setSelectionCells(o)}return t}},n.prototype.createActions=function(){return new Ye(this)},n.prototype.createToolbarItems=function(){return new vt},n.prototype.createKeyHandler=function(e){return new Pt(e)},n.prototype.createMenubar=function(){return new Ut(this,this.menubarContainer)},n.prototype.createToolbar=function(){return new Nt(this,this.toolbarContainer)},n.prototype.createSidebar=function(){return new Dt(this,this.sidebarContainer)},n.prototype.createFormat=function(){return new Tt(this,this.formatContainer)},n.prototype.createFooter=function(){return new It(this,this.footerContainer)},n.prototype.resetToolbar=function(e){this.toolbar&&this.toolbar.reset(e)},n.prototype.resetToolbox=function(){this.toolbox=this.createToolbox(),this.sidebar&&this.sidebar.reset(this.toolbox)},n.prototype.createToolbox=function(){return new _t},n.prototype.loadBpmnModel=function(e){this.graph&&this.graph.loadBpmnModel(e)},n.prototype.resetScrollbars=function(){var e=this.graph,t=e.getGraphBounds(),i=t.width,n=t.height;e.getScrollTileSize&&(i=Math.max(t.width,e.getScrollTileSize().width*e.view.scale),n=Math.max(t.height,e.getScrollTileSize().height*e.view.scale)),e.container.scrollTop=Math.floor(Math.max(0,t.y-Math.max(20,(e.container.clientHeight-n)/4))),e.container.scrollLeft=Math.floor(Math.max(0,t.x-Math.max(0,(e.container.clientWidth-i)/2)))},n.prototype.setCurrentMenu=function(e,t){this.currentMenuElt=t,this.currentMenu=e},n.prototype.resetCurrentMenu=function(){this.currentMenuElt=null,this.currentMenu=null},n.prototype.hideCurrentMenu=function(){null!=this.currentMenu&&(this.currentMenu.hideMenu(),this.resetCurrentMenu())},n.prototype.addBpmnListeners=function(){var e=this;this.graph.getModel().addListener(s.CHANGE,(function(i,n){if(null!=e.graph.bpmnModel){var o=n.getProperty("changes");n.getProperty("edit");var r=!0;o&&o.forEach((function(o){if(o.constructor.name==wt.mxTerminalChange){var l=(u=o).cell,a=u.terminal,s=u.source,d=u.previous;e.graph.bpmnEdgeTerminalChanged(l,a,s,d,i,n,u),r&&null!=l&&(e.fireEvent(new t(Q.ShowProperty,"cells",[l])),r=!1),e.graph.setSelectionCells([l])}else if(o.constructor.name==wt.mxGeometryChange){var u,h=(u=o).cell;e.graph.bpmnCellGeometryChanged(h,i,n,u),r&&null!=h&&(e.fireEvent(new t(Q.ShowProperty,"cells",[h])),r=!1)}}))}})),this.graph.addListener(s.CELLS_REMOVED,(function(t,i){var n=i.getProperty("cells");e.graph.bpmnCellsRemoved(n,t,i)})),this.graph.getSelectionModel().addListener(s.CHANGE,(function(t,i){var n=e.graph.getSelectionCells();e.graph.bpmnCellsSelectionChanged(n,t,i)})),this.graph.connectionHandler.addListener(s.CONNECT,(function(t,i){var n=i.getProperty("cell");e.graph.bpmnCellsConnected(n,t,i)})),this.addListener(Q.NameChanged,(function(t,i){var n=i.getProperty("cell");e.graph.bpmnCellNameChanged(n,t,i)}))},n.prototype.destroy=function(){if(null!=this.graph&&this.graph.destroy(),null!=this.toolbar&&(this.toolbar.destroy(),this.toolbar=null),null!=this.sidebar&&(this.sidebar.destroy(),this.sidebar=null),null!=this.keyHandler&&(this.keyHandler.destroy(),this.keyHandler=null),null!=this.gestureHandler&&(s.removeGestureListeners(document,this.gestureHandler),this.gestureHandler=null),null!=this.resizeHandler&&(s.removeListener(window,"resize",this.resizeHandler),this.resizeHandler=null),null!=this.deleteKeyHandler&&(s.removeListener(document,"keydown",this.deleteKeyHandler),this.deleteKeyHandler=null),null!=this.destroyFunctions){for(var e=0;e<this.destroyFunctions.length;e++)this.destroyFunctions[e]();this.destroyFunctions=null}var t=[this.menubarContainer,this.toolbarContainer,this.sidebarContainer,this.formatContainer,this.diagramContainer,this.footerContainer,this.sidebarSplit];for(e=0;e<t.length;e++)null!=t[e]&&null!=t[e].parentNode&&t[e].parentNode.removeChild(t[e])},n}(n));!function(){if(null==window.mxiGIXBasePath){var e=window.top.gspframeworkService,t=e&&e.common&&e.common.getBasePath&&e.common.getBasePath.get?e.common.getBasePath.get():"";window.mxiGIXBasePath=t||""}var i=a.getDefaultBundle;a.getDefaultBundle=function(e,t){var n=i.apply(this,[e,t]);return n&&(n=n+"?v="+(new Date).getTime()),n};var n=a.getSpecialBundle;a.getSpecialBundle=function(e,t){var i=n.apply(this,[e,t]);return i&&(i=i+"?v="+(new Date).getTime()),i},a.add((window.mxiGIXBasePath?window.mxiGIXBasePath:"")+"/platform/runtime/common/web/@edp-pmf/grapheditor/resources/grapheditor")}();e("Utils",function(){function e(){}return e.isDescendant=function(e,t){for(var i=t.parentNode;i;){if(i===e)return!0;i=i.parentNode}return!1},e}())}}}));
//# sourceMappingURL=grapheditor.system.js.map
