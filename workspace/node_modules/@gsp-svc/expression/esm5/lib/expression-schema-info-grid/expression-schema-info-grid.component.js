/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, Input, Output, EventEmitter } from '@angular/core';
import { Property } from '../schema';
import { CurrentNode } from '../currentNode';
var ExpressionSchemaInfoGridComponent = /** @class */ (function () {
    function ExpressionSchemaInfoGridComponent() {
        this.schema = new Map();
        this.choseSchemaTableName = new CurrentNode;
        this.selectSchemaRow = new EventEmitter();
        this.dbclickInsert = new EventEmitter();
        this.selectString = "";
        this.items = [];
        this.columns = [{ field: 'name', title: '属性名称', filter: true }];
    }
    /**
     * @return {?}
     */
    ExpressionSchemaInfoGridComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
    };
    /**
     * @return {?}
     */
    ExpressionSchemaInfoGridComponent.prototype.ngOnChanges = /**
     * @return {?}
     */
    function () {
        var _this = this;
        /** @type {?} */
        var schemaName = this.choseSchemaTableName.parentName;
        /** @type {?} */
        var tableId = this.choseSchemaTableName.id;
        /** @type {?} */
        var tableName = this.choseSchemaTableName.name;
        /** @type {?} */
        var schemaItem = this.schema.get(schemaName);
        if (schemaItem) {
            /** @type {?} */
            var entityType = schemaItem.entityTypes.find((/**
             * @param {?} entitytype
             * @return {?}
             */
            function (entitytype) { return (entitytype.id == tableId && entitytype.name == tableName) || (entitytype.id == "" && entitytype.name == tableName); }));
            if (entityType) {
                this.items = entityType.properties;
                entityType.navigationProperties.forEach((/**
                 * @param {?} item
                 * @return {?}
                 */
                function (item) {
                    /** @type {?} */
                    var property = new Property;
                    property.name = item.name;
                    property.type = item.type.toString();
                    property.description = item.description;
                    _this.items = _this.items.filter((/**
                     * @param {?} item
                     * @return {?}
                     */
                    function (item) { return item.name !== property.name; }));
                    _this.items.push(property);
                }));
                this.selectString = entityType.name;
            }
            else {
                /** @type {?} */
                var entitySet_1 = schemaItem.entitySets.find((/**
                 * @param {?} entityset
                 * @return {?}
                 */
                function (entityset) { return entityset.name == tableName; }));
                if (entitySet_1) {
                    /** @type {?} */
                    var eType = schemaItem.entityTypes.find((/**
                     * @param {?} entitytype
                     * @return {?}
                     */
                    function (entitytype) { return entitytype.name == entitySet_1.entityType; }));
                    this.items = eType.properties;
                    eType.navigationProperties.forEach((/**
                     * @param {?} item
                     * @return {?}
                     */
                    function (item) {
                        /** @type {?} */
                        var property = new Property;
                        property.name = item.name;
                        property.type = item.type.toString();
                        property.description = item.description;
                        _this.items = _this.items.filter((/**
                         * @param {?} item
                         * @return {?}
                         */
                        function (item) { return item.name !== property.name; }));
                        _this.items.push(property);
                    }));
                    this.selectString = entitySet_1.name + ".[0]";
                }
            }
        }
    };
    /**
     * @param {?} $event
     * @return {?}
     */
    ExpressionSchemaInfoGridComponent.prototype.ondblclickRow = /**
     * @param {?} $event
     * @return {?}
     */
    function ($event) {
        this.dbclickInsert.emit(this.selectString + "." + $event.rowData.name);
    };
    /**
     * @param {?} $event
     * @return {?}
     */
    ExpressionSchemaInfoGridComponent.prototype.selectRowChange = /**
     * @param {?} $event
     * @return {?}
     */
    function ($event) {
        this.selectSchemaRow.emit($event.data);
    };
    ExpressionSchemaInfoGridComponent.decorators = [
        { type: Component, args: [{
                    selector: 'app-expression-schema-info-grid',
                    template: "<farris-datagrid\r\n[idField]=\"'name'\"\r\n[height]=\"268\"\r\n[width]=\"300\"\r\n[columns]=\"columns\" \r\n[data]=\"items\"\r\n[fit]=\"true\"\r\n[fitColumns]=\"true\"\r\n[striped]=\"false\"\r\n[showHeader]=\"true\"\r\n[pagination]=\"false\"\r\n[enableFilterRow]=\"true\"\r\n(dblclickRow)=\"ondblclickRow($event)\"\r\n(selectChanged)=\"selectRowChange($event)\"\r\n>\r\n</farris-datagrid>",
                    styles: [""]
                }] }
    ];
    /** @nocollapse */
    ExpressionSchemaInfoGridComponent.ctorParameters = function () { return []; };
    ExpressionSchemaInfoGridComponent.propDecorators = {
        schema: [{ type: Input }],
        choseSchemaTableName: [{ type: Input }],
        selectSchemaRow: [{ type: Output }],
        dbclickInsert: [{ type: Output }]
    };
    return ExpressionSchemaInfoGridComponent;
}());
export { ExpressionSchemaInfoGridComponent };
if (false) {
    /** @type {?} */
    ExpressionSchemaInfoGridComponent.prototype.schema;
    /** @type {?} */
    ExpressionSchemaInfoGridComponent.prototype.choseSchemaTableName;
    /** @type {?} */
    ExpressionSchemaInfoGridComponent.prototype.selectSchemaRow;
    /** @type {?} */
    ExpressionSchemaInfoGridComponent.prototype.dbclickInsert;
    /** @type {?} */
    ExpressionSchemaInfoGridComponent.prototype.selectString;
    /** @type {?} */
    ExpressionSchemaInfoGridComponent.prototype.items;
    /** @type {?} */
    ExpressionSchemaInfoGridComponent.prototype.columns;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZXhwcmVzc2lvbi1zY2hlbWEtaW5mby1ncmlkLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0Bnc3Atc3ZjL2V4cHJlc3Npb24vIiwic291cmNlcyI6WyJsaWIvZXhwcmVzc2lvbi1zY2hlbWEtaW5mby1ncmlkL2V4cHJlc3Npb24tc2NoZW1hLWluZm8tZ3JpZC5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUFBLE9BQU8sRUFBRSxTQUFTLEVBQVUsS0FBSyxFQUFhLE1BQU0sRUFBRSxZQUFZLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFDMUYsT0FBTyxFQUFzQixRQUFRLEVBQUUsTUFBTSxXQUFXLENBQUM7QUFDekQsT0FBTyxFQUFFLFdBQVcsRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBRTdDO0lBY0U7UUFQUyxXQUFNLEdBQUcsSUFBSSxHQUFHLEVBQWtCLENBQUM7UUFDbkMseUJBQW9CLEdBQUMsSUFBSSxXQUFXLENBQUM7UUFDcEMsb0JBQWUsR0FBRyxJQUFJLFlBQVksRUFBRSxDQUFDO1FBQ3JDLGtCQUFhLEdBQUcsSUFBSSxZQUFZLEVBQUUsQ0FBQztRQUM3QyxpQkFBWSxHQUFRLEVBQUUsQ0FBQztRQUN2QixVQUFLLEdBQVksRUFBRSxDQUFDO1FBQ3BCLFlBQU8sR0FBRyxDQUFDLEVBQUUsS0FBSyxFQUFFLE1BQU0sRUFBRSxLQUFLLEVBQUUsTUFBTSxFQUFDLE1BQU0sRUFBQyxJQUFJLEVBQUMsQ0FBQyxDQUFDO0lBQ3hDLENBQUM7Ozs7SUFFakIsb0RBQVE7OztJQUFSO0lBQ0EsQ0FBQzs7OztJQUNELHVEQUFXOzs7SUFBWDtRQUFBLGlCQXdDQzs7WUF2Q0ssVUFBVSxHQUFHLElBQUksQ0FBQyxvQkFBb0IsQ0FBQyxVQUFVOztZQUNqRCxPQUFPLEdBQUcsSUFBSSxDQUFDLG9CQUFvQixDQUFDLEVBQUU7O1lBQ3RDLFNBQVMsR0FBRyxJQUFJLENBQUMsb0JBQW9CLENBQUMsSUFBSTs7WUFDMUMsVUFBVSxHQUFH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QUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQztJQUNyRSxDQUFDOzs7OztJQUNELDJEQUFlOzs7O0lBQWYsVUFBZ0IsTUFBTTtRQUVwQixJQUFJLENBQUMsZUFBZSxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLENBQUM7SUFDekMsQ0FBQzs7Z0JBbEVGLFNBQVMsU0FBQztvQkFDVCxRQUFRLEVBQUUsaUNBQWlDO29CQUMzQyxpWkFBMkQ7O2lCQUU1RDs7Ozs7eUJBR0UsS0FBSzt1Q0FDTCxLQUFLO2tDQUNMLE1BQU07Z0NBQ04sTUFBTTs7SUF5RFQsd0NBQUM7Q0FBQSxBQW5FRCxJQW1FQztTQTlEWSxpQ0FBaUM7OztJQUU1QyxtREFBNEM7O0lBQzVDLGlFQUE4Qzs7SUFDOUMsNERBQStDOztJQUMvQywwREFBNkM7O0lBQzdDLHlEQUF1Qjs7SUFDdkIsa0RBQW9COztJQUNwQixvREFBd0QiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb21wb25lbnQsIE9uSW5pdCwgSW5wdXQsIE9uQ2hhbmdlcywgT3V0cHV0LCBFdmVudEVtaXR0ZXIgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgU2NoZW1hLCBFbnRpdHlUeXBlLCBQcm9wZXJ0eSB9IGZyb20gJy4uL3NjaGVtYSc7XHJcbmltcG9ydCB7IEN1cnJlbnROb2RlIH0gZnJvbSAnLi4vY3VycmVudE5vZGUnO1xyXG5cclxuQENvbXBvbmVudCh7XHJcbiAgc2VsZWN0b3I6ICdhcHAtZXhwcmVzc2lvbi1zY2hlbWEtaW5mby1ncmlkJyxcclxuICB0ZW1wbGF0ZVVybDogJy4vZXhwcmVzc2lvbi1zY2hlbWEtaW5mby1ncmlkLmNvbXBvbmVudC5odG1sJyxcclxuICBzdHlsZVVybHM6IFsnLi9leHByZXNzaW9uLXNjaGVtYS1pbmZvLWdyaWQuY29tcG9uZW50LmNzcyddXHJcbn0pXHJcbmV4cG9ydCBjbGFzcyBFeHByZXNzaW9uU2NoZW1hSW5mb0dyaWRDb21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQsT25DaGFuZ2VzIHtcclxuICBcclxuICBASW5wdXQoKSBzY2hlbWEgPSBuZXcgTWFwPHN0cmluZywgU2NoZW1hPigpO1xyXG4gIEBJbnB1dCgpIGNob3NlU2NoZW1hVGFibGVOYW1lPW5ldyBDdXJyZW50Tm9kZTtcclxuICBAT3V0cHV0KCkgc2VsZWN0U2NoZW1hUm93ID0gbmV3IEV2ZW50RW1pdHRlcigpO1xyXG4gIEBPdXRwdXQoKSBkYmNsaWNrSW5zZXJ0ID0gbmV3IEV2ZW50RW1pdHRlcigpO1xyXG4gIHNlbGVjdFN0cmluZzpzdHJpbmc9XCJcIjtcclxuICBpdGVtczpQcm9wZXJ0eVtdPVtdO1xyXG4gIGNvbHVtbnMgPSBbeyBmaWVsZDogJ25hbWUnLCB0aXRsZTogJ+WxnuaAp+WQjeensCcsZmlsdGVyOnRydWV9XTtcclxuICBjb25zdHJ1Y3RvcigpIHsgfVxyXG5cclxuICBuZ09uSW5pdCgpIHtcclxuICB9XHJcbiAgbmdPbkNoYW5nZXMoKTogdm9pZCB7XHJcbiAgICBsZXQgc2NoZW1hTmFtZSA9IHRoaXMuY2hvc2VTY2hlbWFUYWJsZU5hbWUucGFyZW50TmFtZTtcclxuICAgIGxldCB0YWJsZUlkID0gdGhpcy5jaG9zZVNjaGVtYVRhYmxlTmFtZS5pZDtcclxuICAgIGxldCB0YWJsZU5hbWUgPSB0aGlzLmNob3NlU2NoZW1hVGFibGVOYW1lLm5hbWU7XHJcbiAgICBsZXQgc2NoZW1hSXRlbSA9IHRoaXMuc2NoZW1hLmdldChzY2hlbWFOYW1lKTtcclxuICAgICAgaWYoc2NoZW1hSXRlbSlcclxuICAgICAge1xyXG4gICAgICAgIGxldCBlbnRpdHlUeXBlID0gc2NoZW1hSXRlbS5lbnRpdHlUeXBlcy5maW5kKGVudGl0eXR5cGUgPT4gKGVudGl0eXR5cGUuaWQ9PXRhYmxlSWQgJiYgZW50aXR5dHlwZS5uYW1lID09IHRhYmxlTmFtZSl8fChlbnRpdHl0eXBlLmlkPT1cIlwiICYmIGVudGl0eXR5cGUubmFtZSA9PSB0YWJsZU5hbWUpKTtcclxuICAgICAgICBpZihlbnRpdHlUeXBlKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgIHRoaXMuaXRlbXM9ZW50aXR5VHlwZS5wcm9wZXJ0aWVzO1xyXG4gICAgICAgICAgZW50aXR5VHlwZS5uYXZpZ2F0aW9uUHJvcGVydGllcy5mb3JFYWNoKGl0ZW09PntcclxuICAgICAgICAgICAgbGV0IHByb3BlcnR5ID0gbmV3IFByb3BlcnR5O1xyXG4gICAgICAgICAgICBwcm9wZXJ0eS5uYW1lID0gaXRlbS5uYW1lO1xyXG4gICAgICAgICAgICBwcm9wZXJ0eS50eXBlID0gaXRlbS50eXBlLnRvU3RyaW5nKCk7XHJcbiAgICAgICAgICAgIHByb3BlcnR5LmRlc2NyaXB0aW9uID0gaXRlbS5kZXNjcmlwdGlvbjtcclxuICAgICAgICAgICAgdGhpcy5pdGVtcyA9IHRoaXMuaXRlbXMuZmlsdGVyKGl0ZW09Pml0ZW0ubmFtZSE9PXByb3BlcnR5Lm5hbWUpO1xyXG4gICAgICAgICAgICB0aGlzLml0ZW1zLnB1c2gocHJvcGVydHkpO1xyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgICB0aGlzLnNlbGVjdFN0cmluZyA9IGVudGl0eVR5cGUubmFtZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZVxyXG4gICAgICAgIHtcclxuICAgICAgICAgIGxldCBlbnRpdHlTZXQgPSBzY2hlbWFJdGVtLmVudGl0eVNldHMuZmluZChlbnRpdHlzZXQgPT4gZW50aXR5c2V0Lm5hbWU9PXRhYmxlTmFtZSApO1xyXG4gICAgICAgICAgaWYoZW50aXR5U2V0KVxyXG4gICAgICAgICAge1xyXG4gICAgICAgICAgICAgbGV0IGVUeXBlPSBzY2hlbWFJdGVtLmVudGl0eVR5cGVzLmZpbmQoZW50aXR5dHlwZSA9PiBlbnRpdHl0eXBlLm5hbWU9PWVudGl0eVNldC5lbnRpdHlUeXBlKTtcclxuICAgICAgICAgICAgIHRoaXMuaXRlbXMgPSBlVHlwZS5wcm9wZXJ0aWVzO1xyXG4gICAgICAgICAgICAgZVR5cGUubmF2aWdhdGlvblByb3BlcnRpZXMuZm9yRWFjaChpdGVtPT57XHJcbiAgICAgICAgICAgICAgbGV0IHByb3BlcnR5ID0gbmV3IFByb3BlcnR5O1xyXG4gICAgICAgICAgICAgIHByb3BlcnR5Lm5hbWUgPSBpdGVtLm5hbWU7XHJcbiAgICAgICAgICAgICAgcHJvcGVydHkudHlwZSA9IGl0ZW0udHlwZS50b1N0cmluZygpO1xyXG4gICAgICAgICAgICAgIHByb3BlcnR5LmRlc2NyaXB0aW9uID0gaXRlbS5kZXNjcmlwdGlvbjtcclxuICAgICAgICAgICAgICB0aGlzLml0ZW1zID0gdGhpcy5pdGVtcy5maWx0ZXIoaXRlbT0+aXRlbS5uYW1lIT09cHJvcGVydHkubmFtZSk7XHJcbiAgICAgICAgICAgICAgdGhpcy5pdGVtcy5wdXNoKHByb3BlcnR5KTtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgdGhpcy5zZWxlY3RTdHJpbmcgPSBlbnRpdHlTZXQubmFtZStcIi5bMF1cIjtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICB9XHJcbiAgb25kYmxjbGlja1JvdygkZXZlbnQpXHJcbiAge1xyXG4gICAgdGhpcy5kYmNsaWNrSW5zZXJ0LmVtaXQodGhpcy5zZWxlY3RTdHJpbmcrXCIuXCIrJGV2ZW50LnJvd0RhdGEubmFtZSk7XHJcbiAgfVxyXG4gIHNlbGVjdFJvd0NoYW5nZSgkZXZlbnQpXHJcbiAge1xyXG4gICAgdGhpcy5zZWxlY3RTY2hlbWFSb3cuZW1pdCgkZXZlbnQuZGF0YSk7XHJcbiAgfVxyXG59XHJcbiJdfQ==