/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Injectable, Injector, ApplicationRef } from '@angular/core';
import { ComponentFactoryResolver } from '@angular/core';
import { PrintEntity } from './entitys/printEntity';
import { NotifyService } from '@farris/ui-notify';
import { Urls } from './utils/cloudprint.Urls';
import { AppService } from '@gsp-sys/rtf-common';
import { PrintFormatService } from './services/printFormatService';
import { WindowService } from '@progress/kendo-angular-dialog';
import { DataValidator } from './utils/cloudprint.datavalidator';
import { BsModalService } from '@farris/ui-modal';
var CloudprintInternalService = /** @class */ (function () {
    function CloudprintInternalService(formatSrv, resolver, injector, applicationRef, notifyService, appService, windowService, modalService) {
        this.formatSrv = formatSrv;
        this.resolver = resolver;
        this.injector = injector;
        this.applicationRef = applicationRef;
        this.notifyService = notifyService;
        this.appService = appService;
        this.windowService = windowService;
        this.modalService = modalService;
        /**
         * 打印参数实体
         */
        this.printEntity = new PrintEntity();
        // 设置printEntity的默认值
        this.printEntity.appUrl = Urls.CloudPrintBaseUrl;
        this.printEntity.isUseMetaData = true;
        this.printEntity.language = localStorage.getItem("languageCode") || 'zh-CHS';
        this.formatSrv.printEntity = this.printEntity;
    }
    Object.defineProperty(CloudprintInternalService.prototype, "setPrintEntity", {
        /**
         * 设置PrintEntity参数
         * @description 如果外界new新的PrintEntity，则需要调用该方法同步service的entity
         *              外界没有new新的PrintEntity，则不需要调用该方法
         */
        set: /**
         * 设置PrintEntity参数
         * \@description 如果外界new新的PrintEntity，则需要调用该方法同步service的entity
         *              外界没有new新的PrintEntity，则不需要调用该方法
         * @param {?} entity
         * @return {?}
         */
        function (entity) {
            this.printEntity = entity;
            // this.designerSrv.printEntity = this.printEntity;
            // this.viewerSrv.printEntity = this.printEntity;
            this.formatSrv.printEntity = this.printEntity;
        },
        enumerable: true,
        configurable: true
    });
    /**be数据源创建格式*/
    /**
     * be数据源创建格式
     * @param {?} beId
     * @return {?}
     */
    CloudprintInternalService.prototype.createPrintFormatWithBE = /**
     * be数据源创建格式
     * @param {?} beId
     * @return {?}
     */
    function (beId) {
        return this.formatSrv.createPrintFormatWithBE(beId);
    };
    /**vo数据源创建格式*/
    /**
     * vo数据源创建格式
     * @param {?} voId
     * @return {?}
     */
    CloudprintInternalService.prototype.createPrintFormatWithVO = /**
     * vo数据源创建格式
     * @param {?} voId
     * @return {?}
     */
    function (voId) {
        return this.formatSrv.createPrintFormatWithVO(voId);
    };
    /**根据数据源id获取格式*/
    /**
     * 根据数据源id获取格式
     * @param {?} sourceId
     * @return {?}
     */
    CloudprintInternalService.prototype.getPrintFormatByDataSrouceId = /**
     * 根据数据源id获取格式
     * @param {?} sourceId
     * @return {?}
     */
    function (sourceId) {
        return this.formatSrv.getFormatBySourceId(sourceId);
    };
    /**根据数据源和维度获取格式*/
    /**
     * 根据数据源和维度获取格式
     * @param {?} billCategoryId
     * @param {?} sourceId
     * @param {?} firstDimension
     * @param {?} secondDimension
     * @return {?}
     */
    CloudprintInternalService.prototype.getPrintFormatByDataSrouceAndDimension = /**
     * 根据数据源和维度获取格式
     * @param {?} billCategoryId
     * @param {?} sourceId
     * @param {?} firstDimension
     * @param {?} secondDimension
     * @return {?}
     */
    function (billCategoryId, sourceId, firstDimension, secondDimension) {
        return this.formatSrv.getPrintFormatByDataSrouceAndDimension(billCategoryId, sourceId, firstDimension, secondDimension);
    };
    /**根据业务对象id获取数据源*/
    /**
     * 根据业务对象id获取数据源
     * @param {?} boId
     * @return {?}
     */
    CloudprintInternalService.prototype.getDataSourceByBOId = /**
     * 根据业务对象id获取数据源
     * @param {?} boId
     * @return {?}
     */
    function (boId) {
        return this.formatSrv.getDataSourceByBOId(boId);
    };
    /**根据格式id获取格式*/
    /**
     * 根据格式id获取格式
     * @param {?} formatId
     * @return {?}
     */
    CloudprintInternalService.prototype.getFormatByFormatId = /**
     * 根据格式id获取格式
     * @param {?} formatId
     * @return {?}
     */
    function (formatId) {
        return this.formatSrv.getFormatByFormatId(formatId);
    };
    /**根据已有的格式id和数据源id，实时获取数据源结构后组成新的格式*/
    /**
     * 根据已有的格式id和数据源id，实时获取数据源结构后组成新的格式
     * @param {?} formatId
     * @return {?}
     */
    CloudprintInternalService.prototype.getNewSourceFormatByFormatId = /**
     * 根据已有的格式id和数据源id，实时获取数据源结构后组成新的格式
     * @param {?} formatId
     * @return {?}
     */
    function (formatId) {
        return this.formatSrv.getNewSourceFormatByFormatId(formatId);
    };
    /**根据已有的格式id和数据源id，语言，实时获取数据源结构后组成新的格式*/
    /**
     * 根据已有的格式id和数据源id，语言，实时获取数据源结构后组成新的格式
     * @param {?} formatId
     * @param {?} lang
     * @return {?}
     */
    CloudprintInternalService.prototype.getNewSourceFormatByFormatIdAndLang = /**
     * 根据已有的格式id和数据源id，语言，实时获取数据源结构后组成新的格式
     * @param {?} formatId
     * @param {?} lang
     * @return {?}
     */
    function (formatId, lang) {
        return this.formatSrv.getNewSourceFormatByFormatIdAndLang(formatId, lang);
    };
    /**保存格式*/
    /**
     * 保存格式
     * @param {?} data
     * @return {?}
     */
    CloudprintInternalService.prototype.save = /**
     * 保存格式
     * @param {?} data
     * @return {?}
     */
    function (data) {
        return this.formatSrv.save(data);
    };
    /**保存格式*/
    /**
     * 保存格式
     * @param {?} data
     * @return {?}
     */
    CloudprintInternalService.prototype.saveWithRes = /**
     * 保存格式
     * @param {?} data
     * @return {?}
     */
    function (data) {
        return this.formatSrv.saveWithRes(data);
    };
    /**删除格式*/
    /**
     * 删除格式
     * @param {?} formatId
     * @return {?}
     */
    CloudprintInternalService.prototype.remove = /**
     * 删除格式
     * @param {?} formatId
     * @return {?}
     */
    function (formatId) {
        return this.formatSrv.remove(formatId);
    };
    /**根据格式id获取格式*/
    /**
     * 根据格式id获取格式
     * @param {?} id
     * @return {?}
     */
    CloudprintInternalService.prototype.getFormatById = /**
     * 根据格式id获取格式
     * @param {?} id
     * @return {?}
     */
    function (id) {
        if (DataValidator.checkAppUrl(this.printEntity.appUrl) == false) {
            this.notifyService.info('未配置正确的appUrl');
            return;
        }
        return this.formatSrv.loadFormat(id, 'CloudPrint');
    };
    CloudprintInternalService.decorators = [
        { type: Injectable }
    ];
    /** @nocollapse */
    CloudprintInternalService.ctorParameters = function () { return [
        { type: PrintFormatService },
        { type: ComponentFactoryResolver },
        { type: Injector },
        { type: ApplicationRef },
        { type: NotifyService },
        { type: AppService },
        { type: WindowService },
        { type: BsModalService }
    ]; };
    return CloudprintInternalService;
}());
export { CloudprintInternalService };
if (false) {
    /**
     * 打印参数实体
     * @type {?}
     */
    CloudprintInternalService.prototype.printEntity;
    /**
     * @type {?}
     * @private
     */
    CloudprintInternalService.prototype.formatSrv;
    /**
     * @type {?}
     * @private
     */
    CloudprintInternalService.prototype.resolver;
    /**
     * @type {?}
     * @private
     */
    CloudprintInternalService.prototype.injector;
    /**
     * @type {?}
     * @private
     */
    CloudprintInternalService.prototype.applicationRef;
    /**
     * @type {?}
     * @private
     */
    CloudprintInternalService.prototype.notifyService;
    /**
     * @type {?}
     * @private
     */
    CloudprintInternalService.prototype.appService;
    /**
     * @type {?}
     * @private
     */
    CloudprintInternalService.prototype.windowService;
    /**
     * @type {?}
     * @private
     */
    CloudprintInternalService.prototype.modalService;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2xvdWRwcmludC5pbnRlcm5hbHNlcnZpY2UuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZ3NwLXN2Yy9jbG91ZHByaW50LyIsInNvdXJjZXMiOlsibGliL2Nsb3VkcHJpbnQuaW50ZXJuYWxzZXJ2aWNlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7QUFBQSxPQUFPLEVBQUUsVUFBVSxFQUFFLFFBQVEsRUFBRSxjQUFjLEVBQWtDLE1BQU0sZUFBZSxDQUFDO0FBQ3JHLE9BQU8sRUFBRSx3QkFBd0IsRUFBbUQsTUFBTSxlQUFlLENBQUM7QUFJMUcsT0FBTyxFQUFFLFdBQVcsRUFBRSxNQUFNLHVCQUF1QixDQUFDO0FBRXBELE9BQU8sRUFBRSxhQUFhLEVBQUUsTUFBTSxtQkFBbUIsQ0FBQztBQUVsRCxPQUFPLEVBQUUsSUFBSSxFQUFFLE1BQU0seUJBQXlCLENBQUM7QUFJL0MsT0FBTyxFQUFFLFVBQVUsRUFBd0MsTUFBTSxxQkFBcUIsQ0FBQztBQUl2RixPQUFPLEVBQUUsa0JBQWtCLEVBQUUsTUFBTSwrQkFBK0IsQ0FBQztBQU1uRSxPQUFPLEVBR0wsYUFBYSxFQUNkLE1BQU0sZ0NBQWdDLENBQUM7QUFReEMsT0FBTyxFQUFFLGFBQWEsRUFBRSxNQUFNLGtDQUFrQyxDQUFDO0FBR2pFLE9BQU8sRUFBRSxjQUFjLEVBQUUsTUFBTSxrQkFBa0IsQ0FBQztBQUlsRDtJQW1CRSxtQ0FDVSxTQUE2QixFQUM3QixRQUFrQyxFQUNsQyxRQUFrQixFQUNsQixjQUE4QixFQUM5QixhQUE0QixFQUM1QixVQUFzQixFQUN0QixhQUE0QixFQUM1QixZQUE0QjtRQVA1QixjQUFTLEdBQVQsU0FBUyxDQUFvQjtRQUM3QixhQUFRLEdBQVIsUUFBUSxDQUEwQjtRQUNsQyxhQUFRLEdBQVIsUUFBUSxDQUFVO1FBQ2xCLG1CQUFjLEdBQWQsY0FBYyxDQUFnQjtRQUM5QixrQkFBYSxHQUFiLGFBQWEsQ0FBZTtRQUM1QixlQUFVLEdBQVYsVUFBVSxDQUFZO1FBQ3RCLGtCQUFh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QzVDLENBQUM7SUFFRCxTQUFTOzs7Ozs7SUFDVCwwQ0FBTTs7Ozs7SUFBTixVQUFPLFFBQWdCO1FBQ25CLE9BQU8sSUFBSSxDQUFDLFNBQVMsQ0FBQyxNQUFNLENBQUMsUUFBUSxDQUFDLENBQUM7SUFDM0MsQ0FBQztJQUVELGVBQWU7Ozs7OztJQUNmLGlEQUFhOzs7OztJQUFiLFVBQWMsRUFBVTtRQUNwQixJQUFHLGFBQWEsQ0FBQyxXQUFXLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxNQUFNLENBQUMsSUFBRSxLQUFLLEVBQUM7WUFDekQsSUFBSSxDQUFDLGFBQWEsQ0FBQyxJQUFJLENBQUMsY0FBYyxDQUFDLENBQUM7WUFDeEMsT0FBTztTQUNWO1FBQ0QsT0FBTyxJQUFJLENBQUMsU0FBUyxDQUFDLFVBQVUsQ0FBQyxFQUFFLEVBQUUsWUFBWSxDQUFDLENBQUM7SUFFdkQsQ0FBQzs7Z0JBdkdKLFVBQVU7Ozs7Z0JBekJGLGtCQUFrQjtnQkFoQmxCLHdCQUF3QjtnQkFEWixRQUFRO2dCQUFFLGNBQWM7Z0JBT3BDLGFBQWE7Z0JBTWIsVUFBVTtnQkFhakIsYUFBYTtnQkFZTixjQUFjOztJQTZHdkIsZ0NBQUM7Q0FBQSxBQXpHRCxJQXlHQztTQXhHWSx5QkFBeUI7Ozs7OztJQUtwQyxnREFBZ0M7Ozs7O0lBYzlCLDhDQUFxQzs7Ozs7SUFDckMsNkNBQTBDOzs7OztJQUMxQyw2Q0FBMEI7Ozs7O0lBQzFCLG1EQUFzQzs7Ozs7SUFDdEMsa0RBQW9DOzs7OztJQUNwQywrQ0FBOEI7Ozs7O0lBQzlCLGtEQUFvQzs7Ozs7SUFDcEMsaURBQW9DIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgSW5qZWN0YWJsZSwgSW5qZWN0b3IsIEFwcGxpY2F0aW9uUmVmLCBFdmVudEVtaXR0ZXIsIFF1ZXJ5LCBMT0NBTEVfSUQgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgQ29tcG9uZW50RmFjdG9yeVJlc29sdmVyLCBDb21wb25lbnRSZWYsIEVtYmVkZGVkVmlld1JlZiwgVmlld0NvbnRhaW5lclJlZiB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5cclxuaW1wb3J0IHsgQ2xvdWRwcmludERlc2lnbmVyQ29tcG9uZW50IH0gZnJvbSAnLi9jbG91ZHByaW50LWRlc2lnbmVyL2Nsb3VkcHJpbnQtZGVzaWduZXIuY29tcG9uZW50JztcclxuaW1wb3J0IHsgQ2xvdWRwcmludFZpZXdlckNvbXBvbmVudCB9IGZyb20gJy4vY2xvdWRwcmludC12aWV3ZXIvY2xvdWRwcmludC12aWV3ZXIuY29tcG9uZW50JztcclxuaW1wb3J0IHsgUHJpbnRFbnRpdHkgfSBmcm9tICcuL2VudGl0eXMvcHJpbnRFbnRpdHknO1xyXG5cclxuaW1wb3J0IHsgTm90aWZ5U2VydmljZSB9IGZyb20gJ0BmYXJyaXMvdWktbm90aWZ5JztcclxuaW1wb3J0IHsgT3V0cHV0T3B0aW9ucyB9IGZyb20gJy4vZW50aXR5cy9vdXRwdXRvcHRpb25zL291dHB1dE9wdGlvbnMnO1xyXG5pbXBvcnQgeyBVcmxzIH0gZnJvbSAnLi91dGlscy9jbG91ZHByaW50LlVybHMnO1xyXG5pbXBvcnQgeyBTb3VyY2VPcHRpb25zIH0gZnJvbSAnLi9lbnRpdHlzL2RhdGFzb3VyY2VvcHRpb25zL3NvdXJjZU9wdGlvbnMnO1xyXG5pbXBvcnQgeyBTb3VyY2VGaWx0ZXJPcHRpb25zIH0gZnJvbSAnLi9lbnRpdHlzL2RhdGFzb3VyY2VvcHRpb25zL3NvdXJjZUZpbHRlck9wdGlvbnMnO1xyXG5pbXBvcnQgeyBCT09wdGlvbnMgfSBmcm9tICcuL2VudGl0eXMvZGF0YXNvdXJjZW9wdGlvbnMvYm9vcHRpb25zJztcclxuaW1wb3J0IHsgQXBwU2VydmljZSwgQXBwT3B0aW9ucywgRnJhbWV3b3JrVmFyaWFibGVTZXJ2aWNlIH0gZnJvbSAnQGdzcC1zeXMvcnRmLWNvbW1vbic7XHJcbmltcG9ydCB7IEZpbGVUeXBlIH0gZnJvbSAnLi9lbnRpdHlzL291dHB1dG9wdGlvbnMvZmlsZVR5cGUnO1xyXG5pbXBvcnQgeyBDbXBUeXBlIH0gZnJvbSAnLi9lbnRpdHlzL2VudW1zL2NtcFR5cGUnO1xyXG5pbXBvcnQgeyBPdXRwdXRQYXJhbSB9IGZyb20gJy4vZW50aXR5cy9vdXRwdXRvcHRpb25zL291dHB1dFBhcmFtJztcclxuaW1wb3J0IHsgUHJpbnRGb3JtYXRTZXJ2aWNlIH0gZnJvbSAnLi9zZXJ2aWNlcy9wcmludEZvcm1hdFNlcnZpY2UnO1xyXG5pbXBvcnQgeyBTb3VyY2VUeXBlIH0gZnJvbSAnLi9lbnRpdHlzL2VudW1zL3NvdXJjZVR5cGUnO1xyXG5cclxuaW1wb3J0IHsgUHJpbnRGb3JtYXQgfSBmcm9tICcuL2VudGl0eXMvcHJpbnRGb3JtYXQnO1xyXG5cclxuXHJcbmltcG9ydCB7XHJcbiAgV2luZG93UmVmLFxyXG4gIFdpbmRvd0Nsb3NlUmVzdWx0LFxyXG4gIFdpbmRvd1NlcnZpY2VcclxufSBmcm9tICdAcHJvZ3Jlc3Mva2VuZG8tYW5ndWxhci1kaWFsb2cnO1xyXG5pbXBvcnQgeyBGb3JtYXRsaXN0Q29tcG9uZW50IH0gZnJvbSAnLi9jbG91ZHByaW50LWZvcm1hdGxpc3QvZm9ybWF0bGlzdC5jb21wb25lbnQnO1xyXG5pbXBvcnQgeyBVdGlscyB9IGZyb20gJy4vdXRpbHMvY2xvdWRwcmludC51dGlscyc7XHJcbmltcG9ydCB7IENsb3VkcHJpbnRkZXNpZ25lclNlcnZpY2UgfSBmcm9tICcuL2Nsb3VkcHJpbnQtZGVzaWduZXIvY2xvdWRwcmludC1kZXNpZ25lci5zZXJ2aWNlJztcclxuaW1wb3J0IHsgQ2xvdWRwcmludHZpZXdlclNlcnZpY2UgfSBmcm9tICcuL2Nsb3VkcHJpbnQtdmlld2VyL2Nsb3VkcHJpbnQtdmlld2VyLnNlcnZpY2UnO1xyXG5pbXBvcnQgeyBTdWJqZWN0IH0gZnJvbSAncnhqcyc7XHJcbmltcG9ydCB7IFF1ZXJ5VHlwZSB9IGZyb20gJy4vZW50aXR5cy9lbnVtcy9xdWVyeXR5cGUnO1xyXG5pbXBvcnQgeyBQcmludFR5cGUgfSBmcm9tICcuL2VudGl0eXMvZW51bXMvcHJpbnR0eXBlJztcclxuaW1wb3J0IHsgRGF0YVZhbGlkYXRvciB9IGZyb20gJy4vdXRpbHMvY2xvdWRwcmludC5kYXRhdmFsaWRhdG9yJztcclxuaW1wb3J0IHsgQmFzZVNvdXJjZU9wdGlvbnMgfSBmcm9tICcuL2VudGl0eXMvZGF0YXNvdXJjZW9wdGlvbnMvYmFzZXNvdXJjZW9wdGlvbnMnO1xyXG5pbXBvcnQgeyBGb3JtYXRsaXN0am9iQ29tcG9uZW50IH0gZnJvbSAnLi9jbG91ZHByaW50LWZvcm1hdGxpc3Rqb2IvZm9ybWF0bGlzdGpvYi5jb21wb25lbnQnO1xyXG5pbXBvcnQgeyBCc01vZGFsU2VydmljZSB9IGZyb20gJ0BmYXJyaXMvdWktbW9kYWwnO1xyXG5pbXBvcnQgeyBMb2NhbExhbmdQaXBlIH0gZnJvbSAnLi9sb2NhbC5waXBlJztcclxuXHJcblxyXG5ASW5qZWN0YWJsZSgpXHJcbmV4cG9ydCBjbGFzcyBDbG91ZHByaW50SW50ZXJuYWxTZXJ2aWNlIHtcclxuIFxyXG4gIC8qKlxyXG4gICAqIOaJk+WNsOWPguaVsOWunuS9k1xyXG4gICAqL1xyXG4gIHByaW50RW50aXR5ID0gbmV3IFByaW50RW50aXR5KCk7XHJcblxyXG4gIC8qKlxyXG4gICAqIOiuvue9rlByaW50RW50aXR55Y+C5pWwXHJcbiAgICogQGRlc2NyaXB0aW9uIOWmguaenOWklueVjG5ld+aWsOeahFByaW50RW50aXR577yM5YiZ6ZyA6KaB6LCD55So6K+l5pa55rOV5ZCM5q2lc2VydmljZeeahGVudGl0eVxyXG4gICAqICAgICAgICAgICAgICDlpJbnlYzmsqHmnIluZXfmlrDnmoRQcmludEVudGl0ee+8jOWImeS4jemcgOimgeiwg+eUqOivpeaWueazlVxyXG4gICAqL1xyXG4gIHNldCBzZXRQcmludEVudGl0eShlbnRpdHkpIHtcclxuICAgIHRoaXMucHJpbnRFbnRpdHkgPSBlbnRpdHk7XHJcbiAgICAvLyB0aGlzLmRlc2lnbmVyU3J2LnByaW50RW50aXR5ID0gdGhpcy5wcmludEVudGl0eTtcclxuICAgIC8vIHRoaXMudmlld2VyU3J2LnByaW50RW50aXR5ID0gdGhpcy5wcmludEVudGl0eTtcclxuICAgIHRoaXMuZm9ybWF0U3J2LnByaW50RW50aXR5ID0gdGhpcy5wcmludEVudGl0eTtcclxuICB9XHJcbiAgY29uc3RydWN0b3IoXHJcbiAgICBwcml2YXRlIGZvcm1hdFNydjogUHJpbnRGb3JtYXRTZXJ2aWNlLFxyXG4gICAgcHJpdmF0ZSByZXNvbHZlcjogQ29tcG9uZW50RmFjdG9yeVJlc29sdmVyLFxyXG4gICAgcHJpdmF0ZSBpbmplY3RvcjogSW5qZWN0b3IsXHJcbiAgICBwcml2YXRlIGFwcGxpY2F0aW9uUmVmOiBBcHBsaWNhdGlvblJlZixcclxuICAgIHByaXZhdGUgbm90aWZ5U2VydmljZTogTm90aWZ5U2VydmljZSxcclxuICAgIHByaXZhdGUgYXBwU2VydmljZTogQXBwU2VydmljZSxcclxuICAgIHByaXZhdGUgd2luZG93U2VydmljZTogV2luZG93U2VydmljZSxcclxuICAgIHByaXZhdGUgbW9kYWxTZXJ2aWNlOiBCc01vZGFsU2VydmljZSxcclxuICAgICkge1xyXG4gICAgICBcclxuICAgICAgICAvLyDorr7nva5wcmludEVudGl0eeeahOm7mOiupOWAvFxyXG4gICAgICAgIHRoaXMucHJpbnRFbnRpdHkuYXBwVXJsID0gVXJscy5DbG91ZFByaW50QmFzZVVybDtcclxuICAgICAgICB0aGlzLnByaW50RW50aXR5LmlzVXNlTWV0YURhdGEgPSB0cnVlO1xyXG4gICAgICAgIHRoaXMucHJpbnRFbnRpdHkubGFuZ3VhZ2UgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShcImxhbmd1YWdlQ29kZVwiKSB8fCAnemgtQ0hTJztcclxuICAgIFxyXG4gICAgICAgIHRoaXMuZm9ybWF0U3J2LnByaW50RW50aXR5ID0gdGhpcy5wcmludEVudGl0eTtcclxuXHJcbiAgICB9XHJcblxyXG5cclxuICAgIC8qKmJl5pWw5o2u5rqQ5Yib5bu65qC85byPKi9cclxuICAgIGNyZWF0ZVByaW50Rm9ybWF0V2l0aEJFKGJlSWQ6IHN0cmluZyk6IFByb21pc2U8YW55PiB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZm9ybWF0U3J2LmNyZWF0ZVByaW50Rm9ybWF0V2l0aEJFKGJlSWQpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKnZv5pWw5o2u5rqQ5Yib5bu65qC85byPKi9cclxuICAgIGNyZWF0ZVByaW50Rm9ybWF0V2l0aFZPKHZvSWQ6IHN0cmluZyk6IFByb21pc2U8YW55PiB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZm9ybWF0U3J2LmNyZWF0ZVByaW50Rm9ybWF0V2l0aFZPKHZvSWQpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKuagueaNruaVsOaNrua6kGlk6I635Y+W5qC85byPKi9cclxuICAgIGdldFByaW50Rm9ybWF0QnlEYXRhU3JvdWNlSWQoc291cmNlSWQ6IHN0cmluZyk6IFByb21pc2U8YW55PntcclxuICAgICAgICByZXR1cm4gdGhpcy5mb3JtYXRTcnYuZ2V0Rm9ybWF0QnlTb3VyY2VJZChzb3VyY2VJZCk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoq5qC55o2u5pWw5o2u5rqQ5ZKM57u05bqm6I635Y+W5qC85byPKi9cclxuICAgIGdldFByaW50Rm9ybWF0QnlEYXRhU3JvdWNlQW5kRGltZW5zaW9uKGJpbGxDYXRlZ29yeUlkLHNvdXJjZUlkLGZpcnN0RGltZW5zaW9uLHNlY29uZERpbWVuc2lvbik6IFByb21pc2U8YW55PntcclxuICAgICAgICByZXR1cm4gdGhpcy5mb3JtYXRTcnYuZ2V0UHJpbnRGb3JtYXRCeURhdGFTcm91Y2VBbmREaW1lbnNpb24oYmlsbENhdGVnb3J5SWQsc291cmNlSWQsZmlyc3REaW1lbnNpb24sc2Vjb25kRGltZW5zaW9uKTtcclxuICAgIH1cclxuXHJcbiAgICAvKirmoLnmja7kuJrliqHlr7nosaFpZOiOt+WPluaVsOaNrua6kCovXHJcbiAgICBnZXREYXRhU291cmNlQnlCT0lkKGJvSWQ6IHN0cmluZyk6IFByb21pc2U8YW55PntcclxuICAgICAgICByZXR1cm4gdGhpcy5mb3JtYXRTcnYuZ2V0RGF0YVNvdXJjZUJ5Qk9JZChib0lkKTtcclxuICAgIH1cclxuXHJcbiAgICAvKirmoLnmja7moLzlvI9pZOiOt+WPluagvOW8jyovXHJcbiAgICBnZXRGb3JtYXRCeUZvcm1hdElkKGZvcm1hdElkOnN0cmluZykgOiBQcm9taXNlPGFueT57XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZm9ybWF0U3J2LmdldEZvcm1hdEJ5Rm9ybWF0SWQoZm9ybWF0SWQpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKuagueaNruW3suacieeahOagvOW8j2lk5ZKM5pWw5o2u5rqQaWTvvIzlrp7ml7bojrflj5bmlbDmja7mupDnu5PmnoTlkI7nu4TmiJDmlrDnmoTmoLzlvI8qL1xyXG4gICAgZ2V0TmV3U291cmNlRm9ybWF0QnlGb3JtYXRJZChmb3JtYXRJZDpzdHJpbmcpOiBQcm9taXNlPGFueT4ge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmZvcm1hdFNydi5nZXROZXdTb3VyY2VGb3JtYXRCeUZvcm1hdElkKGZvcm1hdElkKTtcclxuICAgIH1cclxuXHJcbiAgICAvKirmoLnmja7lt7LmnInnmoTmoLzlvI9pZOWSjOaVsOaNrua6kGlk77yM6K+t6KiA77yM5a6e5pe26I635Y+W5pWw5o2u5rqQ57uT5p6E5ZCO57uE5oiQ5paw55qE5qC85byPKi9cclxuICAgIGdldE5ld1NvdXJjZUZvcm1hdEJ5Rm9ybWF0SWRBbmRMYW5nKGZvcm1hdElkOnN0cmluZyxsYW5nOnN0cmluZyk6IFByb21pc2U8YW55PiB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZm9ybWF0U3J2LmdldE5ld1NvdXJjZUZvcm1hdEJ5Rm9ybWF0SWRBbmRMYW5nKGZvcm1hdElkLGxhbmcpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKuS/neWtmOagvOW8jyovXHJcbiAgICBzYXZlKGRhdGE6IFByaW50Rm9ybWF0KSA6IFByb21pc2U8YW55PiB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZm9ybWF0U3J2LnNhdmUoZGF0YSk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoq5L+d5a2Y5qC85byPKi9cclxuICAgIHNhdmVXaXRoUmVzKGRhdGE6IFByaW50Rm9ybWF0KSA6IFByb21pc2U8YW55PiB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZm9ybWF0U3J2LnNhdmVXaXRoUmVzKGRhdGEpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKuWIoOmZpOagvOW8jyovXHJcbiAgICByZW1vdmUoZm9ybWF0SWQ6IHN0cmluZykge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmZvcm1hdFNydi5yZW1vdmUoZm9ybWF0SWQpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKuagueaNruagvOW8j2lk6I635Y+W5qC85byPKi9cclxuICAgIGdldEZvcm1hdEJ5SWQoaWQ6IHN0cmluZyk6IGFueSB7XHJcbiAgICAgICAgaWYoRGF0YVZhbGlkYXRvci5jaGVja0FwcFVybCh0aGlzLnByaW50RW50aXR5LmFwcFVybCk9PWZhbHNlKXtcclxuICAgICAgICAgICAgdGhpcy5ub3RpZnlTZXJ2aWNlLmluZm8oJ+acqumFjee9ruato+ehrueahGFwcFVybCcpO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0aGlzLmZvcm1hdFNydi5sb2FkRm9ybWF0KGlkLCAnQ2xvdWRQcmludCcpO1xyXG5cclxuICAgIH1cclxuXHJcbn1cclxuIl19