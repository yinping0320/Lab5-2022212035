/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
/**
 * 云打印函数工具类
 */
var /**
 * 云打印函数工具类
 */
PrintFunctionUtils = /** @class */ (function () {
    function PrintFunctionUtils() {
    }
    /**
     * 将数字转为汉字
     * @param number 数值
     */
    /**
     * 将数字转为汉字
     * @param {?} number 数值
     * @return {?}
     */
    PrintFunctionUtils.FormatToCurrencyNumber = /**
     * 将数字转为汉字
     * @param {?} number 数值
     * @return {?}
     */
    function (number) {
        /** @type {?} */
        var result = PrintFunctionUtils.FormatToCurrencyNumberCN(number);
        // 把类似 【一十二】中的一去掉，改为【十二】
        if (result.startsWith('一十')) {
            result = result.substring(1);
        }
        return result;
    };
    /**
     * 将数字转换为汉字
     * @param number 数值
     */
    /**
     * 将数字转换为汉字
     * @param {?} number 数值
     * @return {?}
     */
    PrintFunctionUtils.FormatToCurrencyNumberCN = /**
     * 将数字转换为汉字
     * @param {?} number 数值
     * @return {?}
     */
    function (number) {
        /** @type {?} */
        var res = PrintFunctionUtils.ConvertCurrency(number);
        /** @type {?} */
        var result = res;
        result = result.replace(new RegExp("壹", "gm"), "一");
        result = result.replace(new RegExp("贰", "gm"), "二");
        result = result.replace(new RegExp("叁", "gm"), "三");
        result = result.replace(new RegExp("肆", "gm"), "四");
        result = result.replace(new RegExp("伍", "gm"), "五");
        result = result.replace(new RegExp("陆", "gm"), "六");
        result = result.replace(new RegExp("柒", "gm"), "七");
        result = result.replace(new RegExp("捌", "gm"), "八");
        result = result.replace(new RegExp("玖", "gm"), "九");
        result = result.replace(new RegExp("拾", "gm"), "十");
        result = result.replace(new RegExp("佰", "gm"), "百");
        result = result.replace(new RegExp("仟", "gm"), "千");
        result = result.replace("元", "点");
        result = result.replace("角", "");
        result = result.replace("分", "");
        result = result.replace("整", "");
        if (result[result.length - 1] == '点') {
            result = result.substring(0, result.length - 1);
        }
        return result;
    };
    /**
     * @param {?} money
     * @return {?}
     */
    PrintFunctionUtils.ConvertCurrency = /**
     * @param {?} money
     * @return {?}
     */
    function (money) {
        //汉字的数字
        /** @type {?} */
        var cnNums = new Array('零', '壹', '贰', '叁', '肆', '伍', '陆', '柒', '捌', '玖');
        //基本单位
        /** @type {?} */
        var cnIntRadice = new Array('', '拾', '佰', '仟');
        //对应整数部分扩展单位
        /** @type {?} */
        var cnIntUnits = new Array('', '万', '亿', '兆');
        //对应小数部分单位
        /** @type {?} */
        var cnDecUnits = new Array('角', '分', '毫', '厘');
        //整数金额时后面跟的字符
        /** @type {?} */
        var cnInteger = '整';
        //整型完以后的单位
        /** @type {?} */
        var cnIntLast = '元';
        //最大处理的数字
        /** @type {?} */
        var maxNum = 999999999999999.9999;
        //金额整数部分
        /** @type {?} */
        var integerNum;
        //金额小数部分
        /** @type {?} */
        var decimalNum;
        //输出的中文金额字符串
        /** @type {?} */
        var chineseStr = '';
        //分离金额后用的数组，预定义
        /** @type {?} */
        var parts;
        if (money == '') {
            return '';
        }
        money = parseFloat(money);
        if (money >= maxNum) {
            //超出最大处理数字
            return '';
        }
        if (money == 0) {
            chineseStr = cnNums[0] + cnIntLast + cnInteger;
            return chineseStr;
        }
        //转换为字符串
        money = money.toString();
        if (money.indexOf('.') == -1) {
            integerNum = money;
            decimalNum = '';
        }
        else {
            parts = money.split('.');
            integerNum = parts[0];
            decimalNum = parts[1].substr(0, 4);
        }
        //获取整型部分转换
        if (parseInt(integerNum, 10) > 0) {
            /** @type {?} */
            var zeroCount = 0;
            /** @type {?} */
            var IntLen = integerNum.length;
            for (var i = 0; i < IntLen; i++) {
                /** @type {?} */
                var n = integerNum.substr(i, 1);
                /** @type {?} */
                var p = IntLen - i - 1;
                /** @type {?} */
                var q = p / 4;
                /** @type {?} */
                var m = p % 4;
                if (n == '0') {
                    zeroCount++;
                }
                else {
                    if (zeroCount > 0) {
                        chineseStr += cnNums[0];
                    }
                    //归零
                    zeroCount = 0;
                    chineseStr += cnNums[parseInt(n)] + cnIntRadice[m];
                }
                if (m == 0 && zeroCount < 4) {
                    chineseStr += cnIntUnits[q];
                }
            }
            chineseStr += cnIntLast;
        }
        //小数部分
        if (decimalNum != '') {
            /** @type {?} */
            var decLen = decimalNum.length;
            //处理到分
            if (decLen > 2) {
                decLen = 2;
            }
            for (var i = 0; i < decLen; i++) {
                /** @type {?} */
                var n = decimalNum.substr(i, 1);
                if (n != '0') {
                    chineseStr += cnNums[Number(n)] + cnDecUnits[i];
                }
            }
        }
        if (chineseStr == '') {
            chineseStr += cnNums[0] + cnIntLast + cnInteger;
        }
        else if (decimalNum == '') {
            chineseStr += cnInteger;
        }
        return chineseStr;
    };
    /**
     * 将数值格式化为中文大写货币金额，形如【壹拾万柒仟元零伍角叁分】
     */
    /**
     * 将数值格式化为中文大写货币金额，形如【壹拾万柒仟元零伍角叁分】
     * @param {?} money
     * @return {?}
     */
    PrintFunctionUtils.FormatToCurrencyCN = /**
     * 将数值格式化为中文大写货币金额，形如【壹拾万柒仟元零伍角叁分】
     * @param {?} money
     * @return {?}
     */
    function (money) {
        return PrintFunctionUtils.ConvertCurrency(money);
    };
    /**
     * @param {?} money
     * @return {?}
     */
    PrintFunctionUtils.FormatToCurrency = /**
     * @param {?} money
     * @return {?}
     */
    function (money) {
        /** @type {?} */
        var str = this.FormatToCurrencyCN(money);
        str = str.replace('零', '');
        return str;
    };
    /**
     * @private
     * @param {?} str
     * @param {?} item
     * @param {?} index
     * @return {?}
     */
    PrintFunctionUtils.insert_item = /**
     * @private
     * @param {?} str
     * @param {?} item
     * @param {?} index
     * @return {?}
     */
    function (str, item, index) {
        // 初始化一个空字符串
        /** @type {?} */
        var newstr = '';
        /** @type {?} */
        var tmp = str.substring(0, index);
        /** @type {?} */
        var estr = str.substring(index, str.length);
        newstr += tmp + item + estr;
        return newstr;
    };
    /**
    * 对日期进行格式化， 和C#大致一致 默认yyyy-MM-dd HH:mm:ss
    * 可不带参数 一个日期参数 或一个格式化参数
    * @param date 要格式化的日期
    * @param format 进行格式化的模式字符串
    *     支持的模式字母有：
    *     y:年,
    *     M:年中的月份(1-12),
    *     d:月份中的天(1-31),
    *     H:小时(0-23),
    *     h:小时(0-11),
    *     m:分(0-59),
    *     s:秒(0-59),
    *     f:毫秒(0-999),
    *     q:季度(1-4)
    * @return String
    * @author adswads@gmail.com
    */
    /**
     * 对日期进行格式化， 和C#大致一致 默认yyyy-MM-dd HH:mm:ss
     * 可不带参数 一个日期参数 或一个格式化参数
     * @author adswads\@gmail.com
     * @param {?=} date 要格式化的日期
     * @param {?=} format 进行格式化的模式字符串
     *     支持的模式字母有：
     *     y:年,
     *     M:年中的月份(1-12),
     *     d:月份中的天(1-31),
     *     H:小时(0-23),
     *     h:小时(0-11),
     *     m:分(0-59),
     *     s:秒(0-59),
     *     f:毫秒(0-999),
     *     q:季度(1-4)
     * @return {?} String
     */
    PrintFunctionUtils.dateFormat = /**
     * 对日期进行格式化， 和C#大致一致 默认yyyy-MM-dd HH:mm:ss
     * 可不带参数 一个日期参数 或一个格式化参数
     * @author adswads\@gmail.com
     * @param {?=} date 要格式化的日期
     * @param {?=} format 进行格式化的模式字符串
     *     支持的模式字母有：
     *     y:年,
     *     M:年中的月份(1-12),
     *     d:月份中的天(1-31),
     *     H:小时(0-23),
     *     h:小时(0-11),
     *     m:分(0-59),
     *     s:秒(0-59),
     *     f:毫秒(0-999),
     *     q:季度(1-4)
     * @return {?} String
     */
    function (date, format) {
        // 无参数
        if (date === undefined && format === undefined) {
            date = new Date();
            format = 'yyyy-MM-dd HH:mm:ss';
        }
        else if (typeof (date) === 'string') { // 无日期
            format = date;
            date = new Date();
        }
        else if (format === undefined) { // 无格式化参数
            format = 'yyyy-MM-dd HH:mm:ss';
        }
        else { } // 没有分隔符的特殊处理
        // 没有分隔符的特殊处理
        /** @type {?} */
        var map = {
            y: date.getFullYear() + '',
            // 年份
            M: date.getMonth() + 1 + '',
            // 月份
            d: date.getDate() + '',
            // 日
            H: date.getHours(),
            // 小时 24
            m: date.getMinutes() + '',
            // 分
            s: date.getSeconds() + '',
            // 秒
            q: Math.floor((date.getMonth() + 3) / 3) + '',
            // 季度
            f: date.getMilliseconds() + '' // 毫秒
        };
        // 小时 12
        if (map['H'] > 12) {
            map['h'] = map['H'] - 12 + '';
        }
        else {
            map['h'] = map['H'] + '';
        }
        map['H'] += '';
        /** @type {?} */
        var reg = 'yMdHhmsqf';
        /** @type {?} */
        var all = '';
        /** @type {?} */
        var str = '';
        for (var i = 0, n = 0; i < reg.length; i++) {
            n = format.indexOf(reg[i]);
            if (n < 0) {
                continue;
            }
            all = '';
            for (; n < format.length; n++) {
                if (format[n] !== reg[i]) {
                    break;
                }
                all += reg[i];
            }
            if (all.length > 0) {
                if (all.length === map[reg[i]].length) {
                    str = map[reg[i]];
                }
                else if (all.length > map[reg[i]].length) {
                    if (reg[i] === 'f') {
                        str = map[reg[i]] + this.charString('0', all.length - map[reg[i]].length);
                    }
                    else {
                        str = this.charString('0', all.length - map[reg[i]].length) + map[reg[i]];
                    }
                }
                else {
                    switch (reg[i]) {
                        case 'y':
                            str = map[reg[i]].substr(map[reg[i]].length - all.length);
                            break;
                        case 'f':
                            str = map[reg[i]].substr(0, all.length);
                            break;
                        default:
                            str = map[reg[i]];
                            break;
                    }
                }
                format = format.replace(all, str);
            }
        }
        return format;
    };
    /**
    * 返回字符串 为n个char构成
    * @param char 重复的字符
    * @param count 次数
    * @return String
    * @author adswads@gmail.com
    */
    /**
     * 返回字符串 为n个char构成
     * @author adswads\@gmail.com
     * @private
     * @param {?} char 重复的字符
     * @param {?} count 次数
     * @return {?} String
     */
    PrintFunctionUtils.charString = /**
     * 返回字符串 为n个char构成
     * @author adswads\@gmail.com
     * @private
     * @param {?} char 重复的字符
     * @param {?} count 次数
     * @return {?} String
     */
    function (char, count) {
        /** @type {?} */
        var str = '';
        while (count--) {
            str += char;
        }
        return str;
    };
    /**
     * 格式化数字
     * @param  number  [要格式化的数字]
     * @param  decimals         [保留几位小数]
     * @param  dec_point        [小数点符号]
     * @param  thousands_sep    [千分位符号]
     * @param  roundtag         [舍入参数，默认 "ceil" 向上取,"floor"向下取,"round" 四舍五入]
     * @return  格式化后的结果
     */
    /**
     * 格式化数字
     * @private
     * @param {?} number  [要格式化的数字]
     * @param {?} decimals         [保留几位小数]
     * @param {?} dec_point        [小数点符号]
     * @param {?} thousands_sep    [千分位符号]
     * @param {?} roundtag         [舍入参数，默认 "ceil" 向上取,"floor"向下取,"round" 四舍五入]
     * @return {?} 格式化后的结果
     */
    PrintFunctionUtils.number_format = /**
     * 格式化数字
     * @private
     * @param {?} number  [要格式化的数字]
     * @param {?} decimals         [保留几位小数]
     * @param {?} dec_point        [小数点符号]
     * @param {?} thousands_sep    [千分位符号]
     * @param {?} roundtag         [舍入参数，默认 "ceil" 向上取,"floor"向下取,"round" 四舍五入]
     * @return {?} 格式化后的结果
     */
    function (number, decimals, dec_point, thousands_sep, roundtag) {
        number = (number + '').replace(/[^0-9+-Ee.]/g, '');
        roundtag = roundtag || 'ceil'; // "ceil","floor","round"
        // "ceil","floor","round"
        /** @type {?} */
        var n = !isFinite(+number) ? 0 : +number;
        /** @type {?} */
        var prec = !isFinite(+decimals) ? 0 : Math.abs(decimals);
        /** @type {?} */
        var sep = (typeof thousands_sep === 'undefined') ? ',' : thousands_sep;
        /** @type {?} */
        var dec = (typeof dec_point === 'undefined') ? '.' : dec_point;
        /** @type {?} */
        var s = [];
        /** @type {?} */
        var toFixedFix = (/**
         * @param {?} n
         * @param {?} prec
         * @return {?}
         */
        function (n, prec) {
            /** @type {?} */
            var k = Math.pow(10, prec);
            console.log();
            return '' + parseFloat(Math[roundtag](parseFloat((n * k).toFixed(prec * 2))).toFixed(prec * 2)) / k;
        });
        s = (prec ? toFixedFix(n, prec) : '' + Math.round(n)).split('.');
        /** @type {?} */
        var re = /(-?\d+)(\d{3})/;
        while (re.test(s[0])) {
            s[0] = s[0].replace(re, '$1' + sep + '$2');
        }
        if ((s[1] || '').length < prec) {
            s[1] = s[1] || '';
            s[1] += new Array(prec - s[1].length + 1).join('0');
        }
        return s.join(dec);
    };
    return PrintFunctionUtils;
}());
/**
 * 云打印函数工具类
 */
export { PrintFunctionUtils };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2xvdWRwcmludC5mdW5jdGlvbi51dGlscy5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0Bnc3Atc3ZjL2Nsb3VkcHJpbnQvIiwic291cmNlcyI6WyJsaWIvZnVuY3Rpb25zL2Nsb3VkcHJpbnQuZnVuY3Rpb24udXRpbHMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUdBOzs7O0lBQUE7SUF5U0EsQ0FBQztJQXRTRzs7O09BR0c7Ozs7OztJQUNXLHlDQUFzQjs7Ozs7SUFBcEMsVUFBcUMsTUFBYzs7WUFFM0MsTUFBTSxHQUFHLGtCQUFrQixDQUFDLHdCQUF3QixDQUFDLE1BQU0sQ0FBQztRQUNoRSx3QkFBd0I7UUFDeEIsSUFBSSxNQUFNLENBQUMsVUFBVSxDQUFDLElBQUksQ0FBQyxFQUFFO1lBQ3pCLE1BQU0sR0FBRyxNQUFNLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxDQUFDO1NBQ2hDO1FBQ0QsT0FBTyxNQUFNLENBQUM7SUFDbEIsQ0FBQztJQUVEOzs7T0FHRzs7Ozs7O0lBQ1csMkNBQXdCOzs7OztJQUF0QyxVQUF1QyxNQUFjOztZQUM3QyxHQUFHLEdBQUcsa0JBQWtCLENBQUMsZUFBZSxDQUFDLE1BQU0sQ0FBQzs7WUFDaEQsTUFBTSxHQUFHLEdBQUc7UUFFaEIsTUFBTSxHQUFHLE1BQU0sQ0FBQyxPQUFPLENBQUMsSUFBSSxNQUFNLENBQUMsR0FBRyxFQUFDLElBQUksQ0FBQyxFQUFFLEdBQUcsQ0FBQyxDQUFDO1FBQ25ELE1BQU0sR0FBRyxNQUFNLENBQUMsT0FBTyxDQUFDLElBQUksTUFBTSxDQUFDLEdBQUcsRUFBQyxJQUFJLENBQUMsRUFBRSxHQUFHLENBQUMsQ0FBQztRQUNuRCxNQUFNLEdBQUcsTUFBTSxDQUFDLE9BQU8sQ0FBQyxJQUFJLE1BQU0sQ0FBQyxHQUFHLEVBQUMsSUFBSSxDQUFDLEVBQUUsR0FBRyxDQUFDLENBQUM7UUFDbkQsTUFBTSxHQUFHLE1BQU0sQ0FBQyxPQUFPLENBQUMsSUFBSSxNQUFNLENBQUMsR0FBRyxFQUFDLElBQUksQ0FBQyxFQUFFLEdBQUcsQ0FBQyxDQUFDO1FBQ25ELE1BQU0sR0FBRyxNQUFNLENBQUMsT0FBTyxDQUFDLElBQUksTUFBTSxDQUFDLEdBQUcsRUFBQyxJQUFJLENBQUMsRUFBRSxHQUFHLENBQUMsQ0FBQztRQUNuRCxNQUFNLEdBQUcsTUFBTSxDQUFDLE9BQU8sQ0FBQyxJQUFJLE1BQU0sQ0FBQyxHQUFHLEVBQUMsSUFBSSxDQUFDLEVBQUUsR0FBRyxDQUFDLENBQUM7UUFDbkQsTUFBTSxHQUFHLE1BQU0sQ0FBQyxPQUFPLENBQUMsSUFBSSxNQUFNLENBQUMsR0FBRyxFQUFDLElBQUksQ0FBQyxFQUFFLEdBQUcsQ0FBQyxDQUFDO1FBQ25ELE1BQU0sR0FBRyxNQUFNLENBQUMsT0FBTyxDQUFDLElBQUksTUFBTSxDQUFDLEdBQUcsRUFBQyxJQUFJLENBQUMsRUFBRSxHQUFHLENBQUMsQ0FBQztRQUNuRCxNQUFNLEdBQUcsTUFBTSxDQUFDLE9BQU8sQ0FBQyxJQUFJLE1BQU0sQ0FBQyxHQUFHLEVBQUMsSUFBSSxDQUFDLEVBQUUsR0FBRyxDQUFDLENBQUM7UUFDbkQsTUFBTSxHQUFHLE1BQU0sQ0FBQyxPQUFPLENBQUMsSUFBSSxNQUFNLENBQUMsR0FBRyxFQUFDLElBQUksQ0FBQyxFQUFFLEdBQUcsQ0FBQyxDQUFDO1FBQ25ELE1BQU0sR0FBRyxNQUFNLENBQUMsT0FBTyxDQUFDLElBQUksTUFBTSxDQUFDLEdBQUcsRUFBQyxJQUFJLENBQUMsRUFBRSxHQUFHLENBQUMsQ0FBQztRQUNuRCxNQUFNLEdBQUcsTUFBTSxDQUFDLE9BQU8sQ0FBQyxJQUFJLE1BQU0sQ0FBQyxHQUFHLEVBQUMsSUFBSSxDQUFDLEVBQUUsR0FBRyxDQUFDLENBQUM7UUFFbkQsTUFBTSxHQUFHLE1BQU0sQ0FBQyxPQUFPLENBQUMsR0FBRyxFQUFFLEdBQUcsQ0FBQyxDQUFDO1FBQ2xDLE1BQU0sR0FBRyxNQUFNLENBQUMsT0FBTyxDQUFDLEdBQUcsRUFBRSxFQUFFLENBQUMsQ0FBQztRQUNqQyxNQUFNLEdB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KiDkupHmiZPljbDlh73mlbDlt6XlhbfnsbtcclxuICovXHJcbmV4cG9ydCBjbGFzcyBQcmludEZ1bmN0aW9uVXRpbHMge1xyXG5cclxuXHJcbiAgICAvKipcclxuICAgICAqIOWwhuaVsOWtl+i9rOS4uuaxieWtl1xyXG4gICAgICogQHBhcmFtIG51bWJlciDmlbDlgLxcclxuICAgICAqL1xyXG4gICAgcHVibGljIHN0YXRpYyBGb3JtYXRUb0N1cnJlbmN5TnVtYmVyKG51bWJlcjogbnVtYmVyKTogc3RyaW5nIHtcclxuXHJcbiAgICAgICAgdmFyIHJlc3VsdCA9IFByaW50RnVuY3Rpb25VdGlscy5Gb3JtYXRUb0N1cnJlbmN5TnVtYmVyQ04obnVtYmVyKTtcclxuICAgICAgICAvLyDmiornsbvkvLwg44CQ5LiA5Y2B5LqM44CR5Lit55qE5LiA5Y675o6J77yM5pS55Li644CQ5Y2B5LqM44CRXHJcbiAgICAgICAgaWYgKHJlc3VsdC5zdGFydHNXaXRoKCfkuIDljYEnKSkge1xyXG4gICAgICAgICAgICByZXN1bHQgPSByZXN1bHQuc3Vic3RyaW5nKDEpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog5bCG5pWw5a2X6L2s5o2i5Li65rGJ5a2XXHJcbiAgICAgKiBAcGFyYW0gbnVtYmVyIOaVsOWAvFxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgc3RhdGljIEZvcm1hdFRvQ3VycmVuY3lOdW1iZXJDTihudW1iZXI6IG51bWJlcik6IHN0cmluZyB7XHJcbiAgICAgICAgdmFyIHJlcyA9IFByaW50RnVuY3Rpb25VdGlscy5Db252ZXJ0Q3VycmVuY3kobnVtYmVyKTtcclxuICAgICAgICB2YXIgcmVzdWx0ID0gcmVzO1xyXG5cclxuICAgICAgICByZXN1bHQgPSByZXN1bHQucmVwbGFjZShuZXcgUmVnRXhwKFwi5aO5XCIsXCJnbVwiKSwgXCLkuIBcIik7XHJcbiAgICAgICAgcmVzdWx0ID0gcmVzdWx0LnJlcGxhY2UobmV3IFJlZ0V4cChcIui0sFwiLFwiZ21cIiksIFwi5LqMXCIpO1xyXG4gICAgICAgIHJlc3VsdCA9IHJlc3VsdC5yZXBsYWNlKG5ldyBSZWdFeHAoXCLlj4FcIixcImdtXCIpLCBcIuS4iVwiKTtcclxuICAgICAgICByZXN1bHQgPSByZXN1bHQucmVwbGFjZShuZXcgUmVnRXhwKFwi6IKGXCIsXCJnbVwiKSwgXCLlm5tcIik7XHJcbiAgICAgICAgcmVzdWx0ID0gcmVzdWx0LnJlcGxhY2UobmV3IFJlZ0V4cChcIuS8jVwiLFwiZ21cIiksIFwi5LqUXCIpO1xyXG4gICAgICAgIHJlc3VsdCA9IHJlc3VsdC5yZXBsYWNlKG5ldyBSZWdFeHAoXCLpmYZcIixcImdtXCIpLCBcIuWFrVwiKTtcclxuICAgICAgICByZXN1bHQgPSByZXN1bHQucmVwbGFjZShuZXcgUmVnRXhwKFwi5p+SXCIsXCJnbVwiKSwgXCLkuINcIik7XHJcbiAgICAgICAgcmVzdWx0ID0gcmVzdWx0LnJlcGxhY2UobmV3IFJlZ0V4cChcIuaNjFwiLFwiZ21cIiksIFwi5YWrXCIpO1xyXG4gICAgICAgIHJlc3VsdCA9IHJlc3VsdC5yZXBsYWNlKG5ldyBSZWdFeHAoXCLnjpZcIixcImdtXCIpLCBcIuS5nVwiKTtcclxuICAgICAgICByZXN1bHQgPSByZXN1bHQucmVwbGFjZShuZXcgUmVnRXhwKFwi5ou+XCIsXCJnbVwiKSwgXCLljYFcIik7XHJcbiAgICAgICAgcmVzdWx0ID0gcmVzdWx0LnJlcGxhY2UobmV3IFJlZ0V4cChcIuS9sFwiLFwiZ21cIiksIFwi55m+XCIpO1xyXG4gICAgICAgIHJlc3VsdCA9IHJlc3VsdC5yZXBsYWNlKG5ldyBSZWdFeHAoXCLku59cIixcImdtXCIpLCBcIuWNg1wiKTtcclxuXHJcbiAgICAgICAgcmVzdWx0ID0gcmVzdWx0LnJlcGxhY2UoXCLlhYNcIiwgXCLngrlcIik7XHJcbiAgICAgICAgcmVzdWx0ID0gcmVzdWx0LnJlcGxhY2UoXCLop5JcIiwgXCJcIik7XHJcbiAgICAgICAgcmVzdWx0ID0gcmVzdWx0LnJlcGxhY2UoXCLliIZcIiwgXCJcIik7XHJcbiAgICAgICAgcmVzdWx0ID0gcmVzdWx0LnJlcGxhY2UoXCLmlbRcIiwgXCJcIik7XHJcblxyXG4gICAgICAgIGlmIChyZXN1bHRbcmVzdWx0Lmxlbmd0aCAtIDFdID09ICfngrknKSBcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHJlc3VsdCA9IHJlc3VsdC5zdWJzdHJpbmcoMCwgcmVzdWx0Lmxlbmd0aC0xKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIHN0YXRpYyBDb252ZXJ0Q3VycmVuY3kobW9uZXkpIHtcclxuICAgICAgICAvL+axieWtl+eahOaVsOWtl1xyXG4gICAgICAgIHZhciBjbk51bXMgPSBuZXcgQXJyYXkoJ+mbticsICflo7knLCAn6LSwJywgJ+WPgScsICfogoYnLCAn5LyNJywgJ+mZhicsICfmn5InLCAn5o2MJywgJ+eOlicpO1xyXG4gICAgICAgIC8v5Z+65pys5Y2V5L2NXHJcbiAgICAgICAgdmFyIGNuSW50UmFkaWNlID0gbmV3IEFycmF5KCcnLCAn5ou+JywgJ+S9sCcsICfku58nKTtcclxuICAgICAgICAvL+WvueW6lOaVtOaVsOmDqOWIhuaJqeWxleWNleS9jVxyXG4gICAgICAgIHZhciBjbkludFVuaXRzID0gbmV3IEFycmF5KCcnLCAn5LiHJywgJ+S6vycsICflhYYnKTtcclxuICAgICAgICAvL+WvueW6lOWwj+aVsOmDqOWIhuWNleS9jVxyXG4gICAgICAgIHZhciBjbkRlY1VuaXRzID0gbmV3IEFycmF5KCfop5InLCAn5YiGJywgJ+avqycsICfljpgnKTtcclxuICAgICAgICAvL+aVtOaVsOmHkemineaXtuWQjumdoui3n+eahOWtl+esplxyXG4gICAgICAgIHZhciBjbkludGVnZXIgPSAn5pW0JztcclxuICAgICAgICAvL+aVtOWei+WujOS7peWQjueahOWNleS9jVxyXG4gICAgICAgIHZhciBjbkludExhc3QgPSAn5YWDJztcclxuICAgICAgICAvL+acgOWkp+WkhOeQhueahOaVsOWtl1xyXG4gICAgICAgIHZhciBtYXhOdW0gPSA5OTk5OTk5OTk5OTk5OTkuOTk5OTtcclxuICAgICAgICAvL+mHkemineaVtOaVsOmDqOWIhlxyXG4gICAgICAgIHZhciBpbnRlZ2VyTnVtO1xyXG4gICAgICAgIC8v6YeR6aKd5bCP5pWw6YOo5YiGXHJcbiAgICAgICAgdmFyIGRlY2ltYWxOdW07XHJcbiAgICAgICAgLy/ovpPlh7rnmoTkuK3mlofph5Hpop3lrZfnrKbkuLJcclxuICAgICAgICB2YXIgY2hpbmVzZVN0ciA9ICcnO1xyXG4gICAgICAgIC8v5YiG56a76YeR6aKd5ZCO55So55qE5pWw57uE77yM6aKE5a6a5LmJXHJcbiAgICAgICAgdmFyIHBhcnRzO1xyXG4gICAgICAgIGlmIChtb25leSA9PSAnJykgeyByZXR1cm4gJyc7IH1cclxuICAgICAgICBtb25leSA9IHBhcnNlRmxvYXQobW9uZXkpO1xyXG4gICAgICAgIGlmIChtb25leSA+PSBtYXhOdW0pIHtcclxuICAgICAgICAgIC8v6LaF5Ye65pyA5aSn5aSE55CG5pWw5a2XXHJcbiAgICAgICAgICByZXR1cm4gJyc7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChtb25leSA9PSAwKSB7XHJcbiAgICAgICAgICBjaGluZXNlU3RyID0gY25OdW1zWzBdICsgY25JbnRMYXN0ICsgY25JbnRlZ2VyO1xyXG4gICAgICAgICAgcmV0dXJuIGNoaW5lc2VTdHI7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8v6L2s5o2i5Li65a2X56ym5LiyXHJcbiAgICAgICAgbW9uZXkgPSBtb25leS50b1N0cmluZygpO1xyXG4gICAgICAgIGlmIChtb25leS5pbmRleE9mKCcuJykgPT0gLTEpIHtcclxuICAgICAgICAgIGludGVnZXJOdW0gPSBtb25leTtcclxuICAgICAgICAgIGRlY2ltYWxOdW0gPSAnJztcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgcGFydHMgPSBtb25leS5zcGxpdCgnLicpO1xyXG4gICAgICAgICAgaW50ZWdlck51bSA9IHBhcnRzWzBdO1xyXG4gICAgICAgICAgZGVjaW1hbE51bSA9IHBhcnRzWzFdLnN1YnN0cigwLCA0KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy/ojrflj5bmlbTlnovpg6jliIbovazmjaJcclxuICAgICAgICBpZiAocGFyc2VJbnQoaW50ZWdlck51bSwgMTApID4gMCkge1xyXG4gICAgICAgICAgdmFyIHplcm9Db3VudCA9IDA7XHJcbiAgICAgICAgICB2YXIgSW50TGVuID0gaW50ZWdlck51bS5sZW5ndGg7XHJcbiAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IEludExlbjsgaSsrKSB7XHJcbiAgICAgICAgICAgIHZhciBuID0gaW50ZWdlck51bS5zdWJzdHIoaSwgMSk7XHJcbiAgICAgICAgICAgIHZhciBwID0gSW50TGVuIC0gaSAtIDE7XHJcbiAgICAgICAgICAgIHZhciBxID0gcCAvIDQ7XHJcbiAgICAgICAgICAgIHZhciBtID0gcCAlIDQ7XHJcbiAgICAgICAgICAgIGlmIChuID09ICcwJykge1xyXG4gICAgICAgICAgICAgIHplcm9Db3VudCsrO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgIGlmICh6ZXJvQ291bnQgPiAwKSB7XHJcbiAgICAgICAgICAgICAgICBjaGluZXNlU3RyICs9IGNuTnVtc1swXTtcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgLy/lvZLpm7ZcclxuICAgICAgICAgICAgICB6ZXJvQ291bnQgPSAwO1xyXG4gICAgICAgICAgICAgIGNoaW5lc2VTdHIgKz0gY25OdW1zW3BhcnNlSW50KG4pXSArIGNuSW50UmFkaWNlW21dO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChtID09IDAgJiYgemVyb0NvdW50IDwgNCkge1xyXG4gICAgICAgICAgICAgIGNoaW5lc2VTdHIgKz0gY25JbnRVbml0c1txXTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgY2hpbmVzZVN0ciArPSBjbkludExhc3Q7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8v5bCP5pWw6YOo5YiGXHJcbiAgICAgICAgaWYgKGRlY2ltYWxOdW0gIT0gJycpIHtcclxuICAgICAgICAgIHZhciBkZWNMZW4gPSBkZWNpbWFsTnVtLmxlbmd0aDtcclxuICAgICAgICAgIC8v5aSE55CG5Yiw5YiGXHJcbiAgICAgICAgICBpZiAoZGVjTGVuID4gMikgXHJcbiAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgZGVjTGVuID0gMjtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZGVjTGVuOyBpKyspIHtcclxuICAgICAgICAgICAgdmFyIG4gPSBkZWNpbWFsTnVtLnN1YnN0cihpLCAxKTtcclxuICAgICAgICAgICAgaWYgKG4gIT0gJzAnKSB7XHJcbiAgICAgICAgICAgICAgY2hpbmVzZVN0ciArPSBjbk51bXNbTnVtYmVyKG4pXSArIGNuRGVjVW5pdHNbaV07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGNoaW5lc2VTdHIgPT0gJycpIHtcclxuICAgICAgICAgIGNoaW5lc2VTdHIgKz0gY25OdW1zWzBdICsgY25JbnRMYXN0ICsgY25JbnRlZ2VyO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoZGVjaW1hbE51bSA9PSAnJykge1xyXG4gICAgICAgICAgY2hpbmVzZVN0ciArPSBjbkludGVnZXI7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBjaGluZXNlU3RyO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog5bCG5pWw5YC85qC85byP5YyW5Li65Lit5paH5aSn5YaZ6LSn5biB6YeR6aKd77yM5b2i5aaC44CQ5aO55ou+5LiH5p+S5Luf5YWD6Zu25LyN6KeS5Y+B5YiG44CRXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBzdGF0aWMgRm9ybWF0VG9DdXJyZW5jeUNOKG1vbmV5OiBudW1iZXIpIHtcclxuICAgICAgICByZXR1cm4gUHJpbnRGdW5jdGlvblV0aWxzLkNvbnZlcnRDdXJyZW5jeShtb25leSk7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIHN0YXRpYyBGb3JtYXRUb0N1cnJlbmN5KG1vbmV5OiBudW1iZXIpe1xyXG4gICAgICAgIGxldCBzdHIgPSB0aGlzLkZvcm1hdFRvQ3VycmVuY3lDTihtb25leSk7XHJcbiAgICAgICAgc3RyID0gc3RyLnJlcGxhY2UoJ+mbticsJycpO1xyXG4gICAgICAgIHJldHVybiBzdHI7XHJcbiAgICB9XHJcblxyXG5cclxuICAgIHByaXZhdGUgc3RhdGljIGluc2VydF9pdGVtKHN0ciwgaXRlbSwgaW5kZXgpIHtcclxuICAgICAgICAvLyDliJ3lp4vljJbkuIDkuKrnqbrlrZfnrKbkuLJcclxuICAgICAgICBsZXQgbmV3c3RyID0gJyc7XHJcbiAgICAgICAgY29uc3QgdG1wID0gc3RyLnN1YnN0cmluZygwLCBpbmRleCk7XHJcbiAgICAgICAgY29uc3QgZXN0ciA9IHN0ci5zdWJzdHJpbmcoaW5kZXgsIHN0ci5sZW5ndGgpO1xyXG4gICAgICAgIG5ld3N0ciArPSB0bXAgKyBpdGVtICsgZXN0cjtcclxuICAgICAgICByZXR1cm4gbmV3c3RyO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgKiDlr7nml6XmnJ/ov5vooYzmoLzlvI/ljJbvvIwg5ZKMQyPlpKfoh7TkuIDoh7Qg6buY6K6keXl5eS1NTS1kZCBISDptbTpzc1xyXG4gICAgKiDlj6/kuI3luKblj4LmlbAg5LiA5Liq5pel5pyf5Y+C5pWwIOaIluS4gOS4quagvOW8j+WMluWPguaVsFxyXG4gICAgKiBAcGFyYW0gZGF0ZSDopoHmoLzlvI/ljJbnmoTml6XmnJ8gXHJcbiAgICAqIEBwYXJhbSBmb3JtYXQg6L+b6KGM5qC85byP5YyW55qE5qih5byP5a2X56ym5LiyXHJcbiAgICAqICAgICDmlK/mjIHnmoTmqKHlvI/lrZfmr43mnInvvJogXHJcbiAgICAqICAgICB5OuW5tCwgXHJcbiAgICAqICAgICBNOuW5tOS4reeahOaciOS7vSgxLTEyKSwgXHJcbiAgICAqICAgICBkOuaciOS7veS4reeahOWkqSgxLTMxKSwgXHJcbiAgICAqICAgICBIOuWwj+aXtigwLTIzKSwgXHJcbiAgICAqICAgICBoOuWwj+aXtigwLTExKSwgXHJcbiAgICAqICAgICBtOuWIhigwLTU5KSwgXHJcbiAgICAqICAgICBzOuenkigwLTU5KSwgXHJcbiAgICAqICAgICBmOuavq+enkigwLTk5OSksXHJcbiAgICAqICAgICBxOuWto+W6pigxLTQpXHJcbiAgICAqIEByZXR1cm4gU3RyaW5nXHJcbiAgICAqIEBhdXRob3IgYWRzd2Fkc0BnbWFpbC5jb21cclxuICAgICovXHJcbiAgICBwdWJsaWMgc3RhdGljIGRhdGVGb3JtYXQoZGF0ZT86IGFueSwgZm9ybWF0Pzogc3RyaW5nKTogc3RyaW5nIHtcclxuICAgICAgICAvLyDml6Dlj4LmlbBcclxuICAgICAgICBpZiAoZGF0ZSA9PT0gdW5kZWZpbmVkICYmIGZvcm1hdCA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIGRhdGUgPSBuZXcgRGF0ZSgpO1xyXG4gICAgICAgICAgICBmb3JtYXQgPSAneXl5eS1NTS1kZCBISDptbTpzcyc7XHJcbiAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgKGRhdGUpID09PSAnc3RyaW5nJykgey8vIOaXoOaXpeacn1xyXG4gICAgICAgICAgICBmb3JtYXQgPSBkYXRlO1xyXG4gICAgICAgICAgICBkYXRlID0gbmV3IERhdGUoKTtcclxuICAgICAgICB9IGVsc2UgaWYgKGZvcm1hdCA9PT0gdW5kZWZpbmVkKSB7Ly8g5peg5qC85byP5YyW5Y+C5pWwXHJcbiAgICAgICAgICAgIGZvcm1hdCA9ICd5eXl5LU1NLWRkIEhIOm1tOnNzJztcclxuICAgICAgICB9IGVsc2UgeyB9Ly8g5rKh5pyJ5YiG6ZqU56ym55qE54m55q6K5aSE55CGXHJcblxyXG4gICAgICAgIGNvbnN0IG1hcCA9IHtcclxuICAgICAgICAgICAgeTogZGF0ZS5nZXRGdWxsWWVhcigpICsgJycsIC8vIOW5tOS7vVxyXG4gICAgICAgICAgICBNOiBkYXRlLmdldE1vbnRoKCkgKyAxICsgJycsIC8vIOaciOS7vVxyXG4gICAgICAgICAgICBkOiBkYXRlLmdldERhdGUoKSArICcnLCAvLyDml6VcclxuICAgICAgICAgICAgSDogZGF0ZS5nZXRIb3VycygpLCAvLyDlsI/ml7YgMjRcclxuICAgICAgICAgICAgbTogZGF0ZS5nZXRNaW51dGVzKCkgKyAnJywgLy8g5YiGXHJcbiAgICAgICAgICAgIHM6IGRhdGUuZ2V0U2Vjb25kcygpICsgJycsIC8vIOenklxyXG4gICAgICAgICAgICBxOiBNYXRoLmZsb29yKChkYXRlLmdldE1vbnRoKCkgKyAzKSAvIDMpICsgJycsIC8vIOWto+W6plxyXG4gICAgICAgICAgICBmOiBkYXRlLmdldE1pbGxpc2Vjb25kcygpICsgJycgLy8g5q+r56eSXHJcbiAgICAgICAgfTtcclxuICAgICAgICAvLyDlsI/ml7YgMTJcclxuICAgICAgICBpZiAobWFwWydIJ10gPiAxMikgeyBtYXBbJ2gnXSA9IG1hcFsnSCddIC0gMTIgKyAnJzsgfSBlbHNlIHsgbWFwWydoJ10gPSBtYXBbJ0gnXSArICcnOyB9XHJcbiAgICAgICAgbWFwWydIJ10gKz0gJyc7XHJcblxyXG4gICAgICAgIGNvbnN0IHJlZyA9ICd5TWRIaG1zcWYnO1xyXG4gICAgICAgIGxldCBhbGwgPSAnJywgc3RyID0gJyc7XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDAsIG4gPSAwOyBpIDwgcmVnLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIG4gPSBmb3JtYXQuaW5kZXhPZihyZWdbaV0pO1xyXG4gICAgICAgICAgICBpZiAobiA8IDApIHsgY29udGludWU7IH1cclxuICAgICAgICAgICAgYWxsID0gJyc7XHJcbiAgICAgICAgICAgIGZvciAoOyBuIDwgZm9ybWF0Lmxlbmd0aDsgbisrKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoZm9ybWF0W25dICE9PSByZWdbaV0pIHtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGFsbCArPSByZWdbaV07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGFsbC5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoYWxsLmxlbmd0aCA9PT0gbWFwW3JlZ1tpXV0ubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc3RyID0gbWFwW3JlZ1tpXV07XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGFsbC5sZW5ndGggPiBtYXBbcmVnW2ldXS5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAocmVnW2ldID09PSAnZicpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc3RyID0gbWFwW3JlZ1tpXV0gKyB0aGlzLmNoYXJTdHJpbmcoJzAnLCBhbGwubGVuZ3RoIC0gbWFwW3JlZ1tpXV0ubGVuZ3RoKTtcclxuICAgICAgICAgICAgICAgICAgICB9ICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc3RyID0gdGhpcy5jaGFyU3RyaW5nKCcwJywgYWxsLmxlbmd0aCAtIG1hcFtyZWdbaV1dLmxlbmd0aCkgKyBtYXBbcmVnW2ldXTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHN3aXRjaCAocmVnW2ldKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ3knOiBzdHIgPSBtYXBbcmVnW2ldXS5zdWJzdHIobWFwW3JlZ1tpXV0ubGVuZ3RoIC0gYWxsLmxlbmd0aCk7IGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdmJzogc3RyID0gbWFwW3JlZ1tpXV0uc3Vic3RyKDAsIGFsbC5sZW5ndGgpOyBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDogc3RyID0gbWFwW3JlZ1tpXV07IGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGZvcm1hdCA9IGZvcm1hdC5yZXBsYWNlKGFsbCwgc3RyKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gZm9ybWF0O1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgKiDov5Tlm57lrZfnrKbkuLIg5Li6buS4qmNoYXLmnoTmiJBcclxuICAgICogQHBhcmFtIGNoYXIg6YeN5aSN55qE5a2X56ymXHJcbiAgICAqIEBwYXJhbSBjb3VudCDmrKHmlbBcclxuICAgICogQHJldHVybiBTdHJpbmdcclxuICAgICogQGF1dGhvciBhZHN3YWRzQGdtYWlsLmNvbVxyXG4gICAgKi9cclxuICAgcHJpdmF0ZSBzdGF0aWMgY2hhclN0cmluZyhjaGFyOiBzdHJpbmcsIGNvdW50OiBudW1iZXIpOiBzdHJpbmcge1xyXG4gICAgICAgIGxldCBzdHIgPSAnJztcclxuICAgICAgICB3aGlsZSAoY291bnQtLSkge1xyXG4gICAgICAgICAgICBzdHIgKz0gY2hhcjtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHN0cjtcclxuICAgIH1cclxuXHJcblxyXG5cclxuICAgIC8qKlxyXG4gICAgICog5qC85byP5YyW5pWw5a2XXHJcbiAgICAgKiBAcGFyYW0gIG51bWJlciAgW+imgeagvOW8j+WMlueahOaVsOWtl11cclxuICAgICAqIEBwYXJhbSAgZGVjaW1hbHMgICAgICAgICBb5L+d55WZ5Yeg5L2N5bCP5pWwXVxyXG4gICAgICogQHBhcmFtICBkZWNfcG9pbnQgICAgICAgIFvlsI/mlbDngrnnrKblj7ddXHJcbiAgICAgKiBAcGFyYW0gIHRob3VzYW5kc19zZXAgICAgW+WNg+WIhuS9jeespuWPt11cclxuICAgICAqIEBwYXJhbSAgcm91bmR0YWcgICAgICAgICBb6IiN5YWl5Y+C5pWw77yM6buY6K6kIFwiY2VpbFwiIOWQkeS4iuWPlixcImZsb29yXCLlkJHkuIvlj5YsXCJyb3VuZFwiIOWbm+iIjeS6lOWFpV1cclxuICAgICAqIEByZXR1cm4gIOagvOW8j+WMluWQjueahOe7k+aenFxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIHN0YXRpYyAgbnVtYmVyX2Zvcm1hdChudW1iZXIsIGRlY2ltYWxzLCBkZWNfcG9pbnQsIHRob3VzYW5kc19zZXAsIHJvdW5kdGFnKSB7XHJcbiAgICAgICAgbnVtYmVyID0gKG51bWJlciArICcnKS5yZXBsYWNlKC9bXjAtOSstRWUuXS9nLCAnJyk7XHJcbiAgICAgICAgcm91bmR0YWcgPSByb3VuZHRhZyB8fCAnY2VpbCc7IC8vIFwiY2VpbFwiLFwiZmxvb3JcIixcInJvdW5kXCJcclxuICAgICAgICBsZXQgbiA9ICFpc0Zpbml0ZSgrbnVtYmVyKSA/IDAgOiArbnVtYmVyLFxyXG4gICAgICAgICAgICBwcmVjID0gIWlzRmluaXRlKCtkZWNpbWFscykgPyAwIDogTWF0aC5hYnMoZGVjaW1hbHMpLFxyXG4gICAgICAgICAgICBzZXAgPSAodHlwZW9mIHRob3VzYW5kc19zZXAgPT09ICd1bmRlZmluZWQnKSA/ICcsJyA6IHRob3VzYW5kc19zZXAsXHJcbiAgICAgICAgICAgIGRlYyA9ICh0eXBlb2YgZGVjX3BvaW50ID09PSAndW5kZWZpbmVkJykgPyAnLicgOiBkZWNfcG9pbnQsXHJcbiAgICAgICAgICAgIHMgPSBbXSxcclxuICAgICAgICAgICAgdG9GaXhlZEZpeCA9IGZ1bmN0aW9uIChuLCBwcmVjKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgY29uc3QgayA9IE1hdGgucG93KDEwLCBwcmVjKTtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCk7XHJcbiAgICBcclxuICAgICAgICAgICAgICAgIHJldHVybiAnJyArIHBhcnNlRmxvYXQoTWF0aFtyb3VuZHRhZ10ocGFyc2VGbG9hdCgobiAqIGspLnRvRml4ZWQocHJlYyAqIDIpKSkudG9GaXhlZChwcmVjICogMikpIC8gaztcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICBzID0gKHByZWMgPyB0b0ZpeGVkRml4KG4sIHByZWMpIDogJycgKyBNYXRoLnJvdW5kKG4pKS5zcGxpdCgnLicpO1xyXG4gICAgICAgIGNvbnN0IHJlID0gLygtP1xcZCspKFxcZHszfSkvO1xyXG4gICAgICAgIHdoaWxlIChyZS50ZXN0KHNbMF0pKSB7XHJcbiAgICAgICAgICAgIHNbMF0gPSBzWzBdLnJlcGxhY2UocmUsICckMScgKyBzZXAgKyAnJDInKTtcclxuICAgICAgICB9XHJcbiAgICBcclxuICAgICAgICBpZiAoKHNbMV0gfHwgJycpLmxlbmd0aCA8IHByZWMpIHtcclxuICAgICAgICAgICAgc1sxXSA9IHNbMV0gfHwgJyc7XHJcbiAgICAgICAgICAgIHNbMV0gKz0gbmV3IEFycmF5KHByZWMgLSBzWzFdLmxlbmd0aCArIDEpLmpvaW4oJzAnKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHMuam9pbihkZWMpO1xyXG4gICAgfVxyXG5cclxufVxyXG4iXX0=