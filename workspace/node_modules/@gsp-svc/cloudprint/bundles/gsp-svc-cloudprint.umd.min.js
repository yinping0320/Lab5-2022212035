!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("rxjs"),require("@angular/common"),require("@angular/forms"),require("@progress/kendo-angular-grid"),require("@ecp-caf/caf-common"),require("@farris/ui-loading"),require("@farris/ui-button"),require("@farris/ui-datagrid"),require("@farris/ui-splitter"),require("@farris/ui-section"),require("@farris/ui-draggable"),require("@farris/ui-dialog"),require("@farris/ui-number-spinner"),require("@farris/ui-combo-list"),require("@farris/ui-forms"),require("@farris/ui-response-toolbar"),require("@progress/kendo-angular-dialog"),require("@angular/core"),require("@farris/ui-notify"),require("@gsp-sys/rtf-common"),require("@farris/ui-modal"),require("@angular/common/http")):"function"==typeof define&&define.amd?define("@gsp-svc/cloudprint",["exports","rxjs","@angular/common","@angular/forms","@progress/kendo-angular-grid","@ecp-caf/caf-common","@farris/ui-loading","@farris/ui-button","@farris/ui-datagrid","@farris/ui-splitter","@farris/ui-section","@farris/ui-draggable","@farris/ui-dialog","@farris/ui-number-spinner","@farris/ui-combo-list","@farris/ui-forms","@farris/ui-response-toolbar","@progress/kendo-angular-dialog","@angular/core","@farris/ui-notify","@gsp-sys/rtf-common","@farris/ui-modal","@angular/common/http"],e):e((t["gsp-svc"]=t["gsp-svc"]||{},t["gsp-svc"].cloudprint={}),t.rxjs,t.ng.common,t.ng.forms,t.kendoAngularGrid,t.cafCommon,t.uiLoading,t.uiButton,t.uiDatagrid,t.uiSplitter,t.uiSection,t.uiDraggable,t.uiDialog,t.uiNumberSpinner,t.uiComboList,t.uiForms,t.uiResponseToolbar,t.kendoAngularDialog,t.ng.core,t.uiNotify,t.rtfCommon,t.uiModal,t.ng.common.http)}(this,function(t,s,e,r,n,i,o,a,p,l,c,u,d,m,f,h,y,g,v,b,S,F,w){"use strict";var P=function(t,e){return(P=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};function C(t,e){function r(){this.constructor=t}P(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}function I(e,s,a,p){return new(a||(a=Promise))(function(t,r){function n(t){try{o(p.next(t))}catch(e){r(e)}}function i(t){try{o(p["throw"](t))}catch(e){r(e)}}function o(e){e.done?t(e.value):new a(function(t){t(e.value)}).then(n,i)}o((p=p.apply(e,s||[])).next())})}function E(n,i){var o,s,a,t,p={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return t={next:e(0),"throw":e(1),"return":e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function r(t){if(o)throw new TypeError("Generator is already executing.");for(;p;)try{if(o=1,s&&(a=2&t[0]?s["return"]:t[0]?s["throw"]||((a=s["return"])&&a.call(s),0):s.next)&&!(a=a.call(s,t[1])).done)return a;switch(s=0,a&&(t=[2&t[0],a.value]),t[0]){case 0:case 1:a=t;break;case 4:return p.label++,{value:t[1],done:!1};case 5:p.label++,s=t[1],t=[0];continue;case 7:t=p.ops.pop(),p.trys.pop();continue;default:if(!(a=0<(a=p.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){p=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3])){p.label=t[1];break}if(6===t[0]&&p.label<a[1]){p.label=a[1],a=t;break}if(a&&p.label<a[2]){p.label=a[2],p.ops.push(t);break}a[2]&&p.ops.pop(),p.trys.pop();continue}t=i.call(n,p)}catch(e){t=[6,e],s=0}finally{o=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([e,t])}}}function D(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,i,o=r.call(t),s=[];try{for(;(void 0===e||0<e--)&&!(n=o.next()).done;)s.push(n.value)}catch(a){i={error:a}}finally{try{n&&!n.done&&(r=o["return"])&&r.call(o)}finally{if(i)throw i.error}}return s}function B(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(D(arguments[e]));return t}var T=function vt(){this.downLoadFileName="PrintReport",this.onSaveReportEvent=new v.EventEmitter,this.onExitEvent=new v.EventEmitter,this.onGetPrintFormatIdEvent=new v.EventEmitter,this.onSavedReportEvent=new v.EventEmitter},N=function bt(){this.GetValue={Category:"IGixFucs",GroupFunctionName:"FilterData",FunctionName:"GetValue",Description:"获取指定数据源中指定行和指定列的值",TypeOfFunction:"void",ReturnType:String,ReturnDescription:"数据值",ArgumentTypes:[Object,Number,Number],ArgumentNames:["dataSource","row","col"],ArgumentDescriptions:["数据源","每页行数"],Function:function(t,e,r){var n=t.dataTable;return null==n?"":n.rows.list[e-1].columns.list[r-1].storage.values[e-1]}},this.GetFilterValues={Category:"IGixFucs",GroupFunctionName:"FilterData",FunctionName:"GetFilterValues",Description:"获取符合条件的目标列的值",TypeOfFunction:"void",ReturnType:String,ReturnDescription:"数据值",ArgumentTypes:[Object,String,String,String,Boolean],ArgumentNames:["dataSource","filterColumn","filterValue","targetColumnName","first"],ArgumentDescriptions:["数据源","过滤列","过滤值（必须是stirng）","目标列","是否获取第一个符合条件的值"],Function:function(t,e,r,n,i){var o=t.dataTable;if(null==o)return"";for(var s=o.columns.list.find(function(t){return t.columnName===e}).storage.values,a=[],p=0;p<s.length&&(s[p]!==r||(a.push(p),!i));p++);var l="",c=a.pop();return 0<=c&&(l+=o.columns.list.find(function(t){return t.columnName===n}).storage.values[c],l+=";"),l.substring(0,l.length-2)}}},R=function(){function r(){}return r.FormatToCurrencyNumber=function(t){var e=r.FormatToCurrencyNumberCN(t);return e.startsWith("一十")&&(e=e.substring(1)),e},r.FormatToCurrencyNumberCN=function(t){var e=r.ConvertCurrency(t);return"点"==(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=e.replace(new RegExp("壹","gm"),"一")).replace(new RegExp("贰","gm"),"二")).replace(new RegExp("叁","gm"),"三")).replace(new RegExp("肆","gm"),"四")).replace(new RegExp("伍","gm"),"五")).replace(new RegExp("陆","gm"),"六")).replace(new RegExp("柒","gm"),"七")).replace(new RegExp("捌","gm"),"八")).replace(new RegExp("玖","gm"),"九")).replace(new RegExp("拾","gm"),"十")).replace(new RegExp("佰","gm"),"百")).replace(new RegExp("仟","gm"),"千")).replace("元","点")).replace("角","")).replace("分","")).replace("整",""))[e.length-1]&&(e=e.substring(0,e.length-1)),e},r.ConvertCurrency=function(t){var e,r,n,i=new Array("零","壹","贰","叁","肆","伍","陆","柒","捌","玖"),o=new Array("","拾","佰","仟"),s=new Array("","万","亿","兆"),a=new Array("角","分","毫","厘"),p="";if(""==t)return"";if(1e15<=(t=parseFloat(t)))return"";if(0==t)return p=i[0]+"元整";if(r=-1==(t=t.toString()).indexOf(".")?(e=t,""):(e=(n=t.split("."))[0],n[1].substr(0,4)),0<parseInt(e,10)){for(var l=0,c=e.length,u=0;u<c;u++){var d=c-u-1,m=d/4,f=d%4;"0"==(y=e.substr(u,1))?l++:(0<l&&(p+=i[0]),l=0,p+=i[parseInt(y)]+o[f]),0==f&&l<4&&(p+=s[m])}p+="元"}if(""!=r){var h=r.length;2<h&&(h=2);for(u=0;u<h;u++){var y;"0"!=(y=r.substr(u,1))&&(p+=i[Number(y)]+a[u])}}return""==p?p+=i[0]+"元整":""==r&&(p+="整"),p},r.FormatToCurrencyCN=function(t){return r.ConvertCurrency(t)},r.FormatToCurrency=function(t){var e=this.FormatToCurrencyCN(t);return e=e.replace("零","")},r.insert_item=function(t,e,r){var n="";return n+=t.substring(0,r)+e+t.substring(r,t.length)},r.dateFormat=function(t,e){t===undefined&&e===undefined?(t=new Date,e="yyyy-MM-dd HH:mm:ss"):"string"==typeof t?(e=t,t=new Date):e===undefined&&(e="yyyy-MM-dd HH:mm:ss");var r={y:t.getFullYear()+"",M:t.getMonth()+1+"",d:t.getDate()+"",H:t.getHours(),m:t.getMinutes()+"",s:t.getSeconds()+"",q:Math.floor((t.getMonth()+3)/3)+"",f:t.getMilliseconds()+""};12<r.H?r.h=r.H-12+"":r.h=r.H+"",r.H+="";for(var n="yMdHhmsqf",i="",o="",s=0,a=0;s<n.length;s++)if(!((a=e.indexOf(n[s]))<0)){for(i="";a<e.length&&e[a]===n[s];a++)i+=n[s];if(0<i.length){if(i.length===r[n[s]].length)o=r[n[s]];else if(i.length>r[n[s]].length)o="f"===n[s]?r[n[s]]+this.charString("0",i.length-r[n[s]].length):this.charString("0",i.length-r[n[s]].length)+r[n[s]];else switch(n[s]){case"y":o=r[n[s]].substr(r[n[s]].length-i.length);break;case"f":o=r[n[s]].substr(0,i.length);break;default:o=r[n[s]]}e=e.replace(i,o)}}return e},r.charString=function(t,e){for(var r="";e--;)r+=t;return r},r.number_format=function(t,e,r,n,i){t=(t+"").replace(/[^0-9+-Ee.]/g,""),i=i||"ceil";var o,s,a,p=isFinite(+t)?+t:0,l=isFinite(+e)?Math.abs(e):0,c=void 0===n?",":n,u=void 0===r?".":r,d=[];d=(l?(o=p,s=l,a=Math.pow(10,s),console.log(),""+parseFloat(Math[i](parseFloat((o*a).toFixed(2*s))).toFixed(2*s))/a):""+Math.round(p)).split(".");for(var m=/(-?\d+)(\d{3})/;m.test(d[0]);)d[0]=d[0].replace(m,"$1"+c+"$2");return(d[1]||"").length<l&&(d[1]=d[1]||"",d[1]+=new Array(l-d[1].length+1).join("0")),d.join(u)},r}(),O=function St(){this.ParseEnumValue={Category:"IGixFucs",GroupFunctionName:"Format",FunctionName:"ParseEnumValue",Description:"将枚举值转换为显示值",TypeOfFunction:"void",ReturnType:String,ReturnDescription:"显示值",ArgumentTypes:[String,String,Object],ArgumentNames:["realValue","disPlayValue","enumObject"],ArgumentDescriptions:["枚举值(0/1/2)","显示值(中/英/法)","枚举实例"],Function:function(t,e,r){}},this.Format8CharDateTime={Category:"IGixFucs",GroupFunctionName:"Format",FunctionName:"Format8CharDateTime",Description:"将8位字符串形式的日期转换为指定格式的日期格式",TypeOfFunction:"void",ReturnType:String,ReturnDescription:"指定日期格式的字符串",ArgumentTypes:[String,String],ArgumentNames:["format","dataString"],ArgumentDescriptions:["枚举值(0/1/2)","显示值(中/英/法)","枚举实例"],Function:function(t,e){}},this.FormatDateTime={Category:"IGixFucs",GroupFunctionName:"Format",FunctionName:"FormatDateTime",Description:"将日期转换为指定格式的日期格式",TypeOfFunction:"void",ReturnType:String,ReturnDescription:"指定日期格式的字符串",ArgumentTypes:[String,Object],ArgumentNames:["format","datetime"],ArgumentDescriptions:["格式","日期(DateTime类型)"],Function:function(t,e){}},this.FormatDateTimeStr={Category:"IGixFucs",GroupFunctionName:"Format",FunctionName:"FormatDateTimeStr",Description:"将日期字符串转换为指定格式的日期格式",TypeOfFunction:"void",ReturnType:String,ReturnDescription:"指定日期格式的字符串",ArgumentTypes:[String,String],ArgumentNames:["format","datestring"],ArgumentDescriptions:["格式","日期字符串)"],Function:function(t,e){}},this.FormatDateTimeCN={Category:"IGixFucs",GroupFunctionName:"Format",FunctionName:"FormatDateTimeCN",Description:"将数字日期转换为汉字日期",TypeOfFunction:"void",ReturnType:String,ReturnDescription:"汉字日期",ArgumentTypes:[Object,Boolean,Boolean],ArgumentNames:["datetime","isSimple","isDeleteZero"],ArgumentDescriptions:["日期(DateTime类型)","是否简体汉字","是否去除零"],Function:function(t,e,r){}},this.FormatYearCN={Category:"IGixFucs",GroupFunctionName:"Format",FunctionName:"FormatYearCN",Description:"将数字日期转换为汉字年",TypeOfFunction:"void",ReturnType:String,ReturnDescription:"汉字年",ArgumentTypes:[Object,Boolean],ArgumentNames:["datetime","isSimple"],ArgumentDescriptions:["日期(DateTime类型)","是否简体汉字"],Function:function(t,e){}},this.FormatMonthCN={Category:"IGixFucs",GroupFunctionName:"Format",FunctionName:"FormatMonthCN",Description:"将数字日期转换为汉字月",TypeOfFunction:"void",ReturnType:String,ReturnDescription:"汉字月",ArgumentTypes:[Object,Boolean,Boolean],ArgumentNames:["datetime","isSimple","isDeleteZero"],ArgumentDescriptions:["日期(DateTime类型)","是否简体汉字","是否去除零"],Function:function(t,e,r){}},this.FormatDayCN={Category:"IGixFucs",GroupFunctionName:"Format",FunctionName:"FormatDayCN",Description:"将数字日期转换为汉字日",TypeOfFunction:"void",ReturnType:String,ReturnDescription:"汉字日",ArgumentTypes:[Object,Boolean,Boolean],ArgumentNames:["datetime","isSimple","isDeleteZero"],ArgumentDescriptions:["日期(DateTime类型)","是否简体汉字","是否去除零"],Function:function(t,e,r){}},this.FormatToCurrencyNumber={Category:"IGixFucs",GroupFunctionName:"Format",FunctionName:"FormatToCurrencyNumber",Description:"将数值格式化为大写中文，比如将12.38格式化为【十二点三八】",TypeOfFunction:"void",ReturnType:String,ReturnDescription:"大写中文数字",ArgumentTypes:[Number],ArgumentNames:["number"],ArgumentDescriptions:["数值"],Function:R.FormatToCurrencyNumber},this.FormatToCurrencyNumberCN={Category:"IGixFucs",GroupFunctionName:"Format",FunctionName:"FormatToCurrencyNumberCN",Description:"将数值格式化为大写中文金额数值，比如将12.38格式化为【一十二点三八】",TypeOfFunction:"void",ReturnType:String,ReturnDescription:"大写中文数值",ArgumentTypes:[Number],ArgumentNames:["number"],ArgumentDescriptions:["数值"],Function:R.FormatToCurrencyNumberCN},this.FormatToCurrencyCN={Category:"IGixFucs",GroupFunctionName:"Format",FunctionName:"FormatToCurrencyCN",Description:"将数值格式化为中文大写货币金额",TypeOfFunction:"void",ReturnType:String,ReturnDescription:"中文大写货币金额",ArgumentTypes:[Number],ArgumentNames:["money"],ArgumentDescriptions:["数值"],Function:R.FormatToCurrencyCN},this.FormatToCurrency={Category:"IGixFucs",GroupFunctionName:"Format",FunctionName:"FormatToCurrency",Description:"将数值格式化为中文大写货币金额",TypeOfFunction:"void",ReturnType:String,ReturnDescription:"中文大写货币金额",ArgumentTypes:[Number],ArgumentNames:["money"],ArgumentDescriptions:["数值"],Function:R.FormatToCurrency},this.FormatFloat={Category:"IGixFucs",GroupFunctionName:"Format",FunctionName:"FormatFloat",Description:"将浮点类型转化为指定的格式显示",TypeOfFunction:"void",ReturnType:String,ReturnDescription:"浮点型数字结果",ArgumentTypes:[Number,String],ArgumentNames:["f","format"],ArgumentDescriptions:["浮点型数字","格式"],Function:function(t,e){}},this.RemoveRepeatedJoiner={Category:"IGixFucs",GroupFunctionName:"Format",FunctionName:"RemoveRepeatedJoiner",Description:"将连续出现的连接符转换为单个字符，例如将12---32转换为12-32",TypeOfFunction:"void",ReturnType:String,ReturnDescription:"提换后的字符串",ArgumentTypes:[String,String],ArgumentNames:["joiner","str"],ArgumentDescriptions:["连接符","字符串"],Function:function(t,e){}},this.FormatPageIndexWithStartNumber={Category:"IGixFucs",GroupFunctionName:"Format",FunctionName:"FormatPageIndexWithStartNumber",Description:"根据起始页码重新计算页码，例如：起始页码为10，那第一页将显示10",TypeOfFunction:"void",ReturnType:String,ReturnDescription:"转化后的页码",ArgumentTypes:[String,Number],ArgumentNames:["page","start"],ArgumentDescriptions:["当前页码(来自系统变量)","起始页"],Function:function(t,e){}}},A=function Ft(){this.ConvertStringToBigDecimal={Category:"IGixFucs",GroupFunctionName:"Convert",FunctionName:"ConvertStringToBigDecimal",Description:"将字符串转化为BigDecimal",TypeOfFunction:"void",ReturnType:String,ReturnDescription:"显示值",ArgumentTypes:[String],ArgumentNames:["money"],ArgumentDescriptions:["金额字符串"],Function:function(t){}},this.ConvertDoubleToBigDecimal={Category:"IGixFucs",GroupFunctionName:"Convert",FunctionName:"ConvertDoubleToBigDecimal",Description:"将Double转化为BigDecimal",TypeOfFunction:"void",ReturnType:String,ReturnDescription:"显示值",ArgumentTypes:[Number],ArgumentNames:["money"],ArgumentDescriptions:["double类型的金额"],Function:function(t){}},this.SubStringMoney={Category:"IGixFucs",GroupFunctionName:"Convert",FunctionName:"SubStringMoney",Description:"按照位置截取金额数值",TypeOfFunction:"string",ReturnType:String,ReturnDescription:'截取的金额（例如：SubStringMoney("1232.32","-1")返回3）',ArgumentTypes:[Number,String,Boolean],ArgumentNames:["money","position","isZeroShow"],ArgumentDescriptions:["string类型的金额","string截取的位置（小数点往左位置是1,2,3依次类推，往右是-1,-2依次类推）"],Function:function(t,e,r){}},this.SubDoubleMoney={Category:"IGixFucs",GroupFunctionName:"Convert",FunctionName:"SubDoubleMoney",Description:"按照位置截取金额数值",TypeOfFunction:"string",ReturnType:String,ReturnDescription:'截取的金额（例如：SubStringMoney("1232.32","3")返回2）',ArgumentTypes:[Number,String,Boolean],ArgumentNames:["money","position","isZeroShow"],ArgumentDescriptions:["double类型的金额","string类型截取的位置（小数点往左位置是1,2,3依次类推，往右是-1,-2依次类推）"],Function:function(t,e,r){}}},x=function(){function t(t){this.http=t,this.httpoptions={},this.httpoptions.headers={SessionId:"","Content-Type":"application/json"}}return t.prototype.initCustomFunction=function(t){var e=this,r=new N,n=new O,i=new A;if(0===Stimulsoft.Report.Dictionary.StiFunctions.getFunctions("IGixFucs").length){for(var o in r){var s=r[o];Stimulsoft.Report.Dictionary.StiFunctions.addFunction(s.Category,s.GroupFunctionName,s.FunctionName,s.Description,s.TypeOfFunction,s.ReturnType,s.ReturnDescription,s.ArgumentTypes,s.ArgumentNames,s.ArgumentDescriptions,s.Function)}for(var o in n){s=n[o];Stimulsoft.Report.Dictionary.StiFunctions.addFunction(s.Category,s.GroupFunctionName,s.FunctionName,s.Description,s.TypeOfFunction,s.ReturnType,s.ReturnDescription,s.ArgumentTypes,s.ArgumentNames,s.ArgumentDescriptions,s.Function)}for(var o in i){s=i[o];Stimulsoft.Report.Dictionary.StiFunctions.addFunction(s.Category,s.GroupFunctionName,s.FunctionName,s.Description,s.TypeOfFunction,s.ReturnType,s.ReturnDescription,s.ArgumentTypes,s.ArgumentNames,s.ArgumentDescriptions,s.Function)}}return this.http.get(t,this.httpoptions).toPromise().then(function(s){if(s&&0<s.length)return e.addJsFuncPlugins(-1,s).then(function(){if(s){var t=[];if(0<s.length)for(var e in s)t.push(window[s[e].key]);if(0===Stimulsoft.Report.Dictionary.StiFunctions.getFunctions("CustomFucs").length&&0<t.length)for(var r in t){var n=t[r];for(var i in n){var o=n[i];Stimulsoft.Report.Dictionary.StiFunctions.addFunction("CustomFucs",o.GroupFunctionName,o.FunctionName,o.Description,o.TypeOfFunction,o.ReturnType,o.ReturnDescription,o.ArgumentTypes,o.ArgumentNames,o.ArgumentDescriptions,o.Function)}}}})})},t.prototype.addJsFuncPlugins=function(t,e){if(!e&&0==e.length){var r=new s.Subject;return r.complete(),r.toPromise()}var n=window.System;return t<e.length-1&&(t++,this.addJsFuncPlugins(t,e)),n["import"](e[t].path)},t.decorators=[{type:v.Injectable}],t.ctorParameters=function(){return[{type:w.HttpClient}]},t}(),M=function(){function t(){}return t.PRINT_SU="Prt",t}(),j={CloudPrintBaseUrl:"/api/runtime/"+M.PRINT_SU+"/v1.0/service",CloudPrintDimensionUrl:"/api/runtime/"+M.PRINT_SU+"/v1.0/demensionservice",CloudPrintDeviceUrl:"/api/runtime/"+M.PRINT_SU+"/v1.0/device",GetPrintFormatByDataSrouceId:"/GetPrintFormatByDataSrouceId?",GetPrintFormatByDataSrouceAndDimension:"/GetPrintFormatByDataSrouceAndDimension?",GetPrintFormatAndDevice:"/getPrintFormatAndDevice?",GetPrintDevice:"/getPrintDevice?",SavePrintFormat:"/SavePrintFormat",SavePrintFormatWithRes:"/savePrintFormatWithRes",DeletePrintFormat:"/DeletePrintFormat",GetDataSourceByBOId:"/GetDataSourceByBOId?",CreatePrintFormatWithBE:"/CreatePrintFormatWithBE?",CreatePrintFormatWithVO:"/CreatePrintFormatWithVO?",CreatePrintFormatWithBO:"/CreatePrintFormatWithBO?",CreatePrintFormatWithSchema:"/CreatePrintFormatWithSchema",LoadPrintFormatById:"/GetPrintFormatById?",LoadNewSourcePrintFormatById:"/getNewSourcePrintFormatById?",LoadNewSourcePrintFormatByIdAndLang:"/getNewSourcePrintFormatByIdAndLang?",LoadPrintData:"/GetPrintData?",GetDesigerHtml:"/GetDesigerHtml",GetCustomJsFunc:"/GetCustomJsFunc",PrintSingleById:"/OutputBEData?",PrintSingleByFilter:"/OutputBEDataWithFilter?",PrintMultiById:"/printMultiById?",PrintMultiByFilter:"/printMultiByFilter?",PrintSingleBOData:"/OutputBOData?",PrintTestData:"/printTestData?",SendPrintEvent:"/sendPrintEvent?",PrintAttachment:"/printAttachment?",IsRemotePrint:"/isRemotePrint?",GetEnableFonts:"/fonts?"},U=function wt(){this.nameMap={},this.nameMap={}},L=function(){function t(){}return t.checkForEmptyString=function(t,e){if(t||0===t.length)throw new Error(e+"为空")},t.checkForNullReference=function(t,e){if(null==t)throw new Error(e+"为null")},t.checkFlag=function(t){return!(!t||"CloudPrint"!==t)},t.checkAppUrl=function(t){return!!t},t}(),k=function(){function t(t){this.httpClient=t,this.printEntity=new T,this.curSu=M.PRINT_SU}return t.prototype.createPrintFormatWithBE=function(t){var e=this.printEntity.appUrl+j.CreatePrintFormatWithBE+"beId="+t+"&su="+this.curSu,r={};return r.headers={SessionId:this.printEntity.sessionId||"","Content-Type":"application/json"},this.httpClient.get(e,r).toPromise()},t.prototype.createPrintFormatWithVO=function(t){var e=this.printEntity.appUrl+j.CreatePrintFormatWithVO+"voId="+t+"&su="+this.curSu,r={};return r.headers={SessionId:this.printEntity.sessionId||"","Content-Type":"application/json"},this.httpClient.get(e,r).toPromise()},t.prototype.createPrintFormatWithBO=function(t){var e=this.printEntity.appUrl+j.CreatePrintFormatWithBO+"biznessObjectClassInfo="+t+"&su="+this.curSu,r={};return r.headers={SessionId:this.printEntity.sessionId||"","Content-Type":"application/json"},this.httpClient.get(e,r).toPromise()},t.prototype.getDataSourceByBOId=function(t){this.printEntity.sessionId;var e=this.printEntity.appUrl+j.GetDataSourceByBOId;return this.httpClient.get(e+"boId="+t+"&su="+this.curSu).toPromise()},t.prototype.getFormatBySourceId=function(t){var e={};return e.headers={SessionId:this.printEntity.sessionId||"","Content-Type":"application/json"},this.httpClient.get(this.printEntity.appUrl+j.GetPrintFormatByDataSrouceId+"dataSrouceId="+t+"&su="+this.curSu,e).toPromise().then(function(t){return t})},t.prototype.getPrintFormatByDataSrouceAndDimension=function(t,e,r,n){r=r||"",n=n||"";var i={};return i.headers={SessionId:this.printEntity.sessionId||"","Content-Type":"application/json"},this.httpClient.get(this.printEntity.appUrl+j.GetPrintFormatByDataSrouceAndDimension+"billCategoryId="+t+"&sourceId="+e+"&firstDimension="+r+"&secondDimension="+n+"&su="+this.curSu,i).toPromise().then(function(t){return t})},t.prototype.getPrintFormatAndDevice=function(t,e,r,n){r=r||"",n=n||"";var i={};i.headers={SessionId:this.printEntity.sessionId||"","Content-Type":"application/json"};var o={billCategoryId:t,sourceId:e,firstDimension:r,secondDimension:n};return this.httpClient.post(this.printEntity.appUrl+j.GetPrintFormatAndDevice+"su="+this.curSu,o,i).toPromise().then(function(t){return t})},t.prototype.getPrintDevice=function(){var t={};return t.headers={SessionId:this.printEntity.sessionId||"","Content-Type":"application/json"},this.httpClient.post(j.CloudPrintDeviceUrl+j.GetPrintDevice+"su="+this.curSu,null,t).toPromise().then(function(t){return t})},t.prototype.getFormatByFormatId=function(t){var e=this.printEntity.appUrl+j.LoadPrintFormatById+"metadataId="+t+"&su="+this.curSu,r={};return r.headers={SessionId:this.printEntity.sessionId||"","Content-Type":"application/json"},this.httpClient.get(e,r).toPromise().then(function(t){return t})},t.prototype.getNewSourceFormatByFormatId=function(t){var e=j.CloudPrintBaseUrl+j.LoadNewSourcePrintFormatById;return this.httpClient.get(e+"formatId="+t).toPromise()},t.prototype.getNewSourceFormatByFormatIdAndLang=function(t,e){var r=j.CloudPrintBaseUrl+j.LoadNewSourcePrintFormatByIdAndLang;return this.httpClient.get(r+"formatId="+t+"&lang="+e).toPromise()},t.prototype.save=function(t){var e={};return e.headers={SessionId:this.printEntity.sessionId||"","Content-Type":"application/json"},this.httpClient.post(this.printEntity.appUrl+j.SavePrintFormat+"?su="+this.curSu,t,e).toPromise().then(function(t){return t})},t.prototype.saveWithRes=function(t){var e={};return e.headers={SessionId:this.printEntity.sessionId||"","Content-Type":"application/json"},this.httpClient.post(this.printEntity.appUrl+j.SavePrintFormatWithRes+"?su="+this.curSu,t,e).toPromise().then(function(t){return t})},t.prototype.remove=function(t){var e={};return e.headers={SessionId:this.printEntity.sessionId||"","Content-Type":"application/json"},this.httpClient.post(this.printEntity.appUrl+j.DeletePrintFormat+"/"+t+"?su="+this.curSu,null,e).toPromise().then(function(t){return t})},t.prototype.loadFormat=function(t,e){var r,n=this;if(!1===L.checkFlag(e))return alert("内部方法，外部请使用cloudprint.service下的服务"),null;if(this.printEntity.format){var i=new s.Subject;return i.complete(),i.toPromise().then(function(){return n.printEntity.printFormat=n.printEntity.printFormat||new U,n.printEntity.printFormat.content=n.printEntity.format,n.printEntity.format})}var o={};if(o.headers={SessionId:this.printEntity.sessionId||"","Content-Type":"application/json"},t&&0<t.length)return r=this.printEntity.appUrl+j.LoadPrintFormatById+"metadataId="+t+"&su="+this.curSu,this.httpClient.get(r,o).toPromise().then(function(t){return n.printEntity.printFormat=t,n.printEntity.format=t.content,t.content});console.log(this.printEntity.format),console.log(t),console.error("格式id为空，无法获取格式信息")},t.prototype.loadData=function(t,e){var r=this;if(!1===L.checkFlag(e))return alert("内部方法，外部请使用cloudprint.service下的服务"),null;if(this.printEntity.data){var n=new s.Subject;return n.complete(),n.toPromise().then(function(){return r.printEntity.data})}var i={};return i.headers={SessionId:this.printEntity.sessionId||"","Content-Type":"application/json"},this.httpClient.get(this.printEntity.appUrl+j.LoadPrintData+"dataIds="+t+"&su="+this.curSu,i).toPromise().then(function(t){return t})},t.prototype.printSingleById=function(e,t,r,n){var i=this;if(!1===L.checkFlag(n))return alert("内部方法，外部请使用cloudprint.service下的服务"),null;var o={BEOptions:e,Options:t},s={responseType:"blob"};return s.headers={SessionId:this.printEntity.sessionId||"","Content-Type":"application/json"},e.ServiceUnit?(r=r||e.ServiceUnit,this.httpClient.post(this.printEntity.appUrl+j.PrintSingleById+"su="+r,o,s).toPromise().then(function(t){return t})):this.getSuByFormatId(e.FormatId).then(function(t){return e.ServiceUnit=t,r=r||e.ServiceUnit,i.httpClient.post(i.printEntity.appUrl+j.PrintSingleById+"su="+r,o,s).toPromise().then(function(t){return t})})},t.prototype.printSingleByFilter=function(e,t,r,n){var i=this;if(!1===L.checkFlag(n))return alert("内部方法，外部请使用cloudprint.service下的服务"),null;var o={BEOptions:e,Options:t},s={responseType:"blob"};return s.headers={SessionId:this.printEntity.sessionId||"","Content-Type":"application/json"},e.ServiceUnit?(r=r||e.ServiceUnit,this.httpClient.post(this.printEntity.appUrl+j.PrintSingleByFilter+"su="+r,o,s).toPromise().then(function(t){return t})):this.getSuByFormatId(e.FormatId).then(function(t){return e.ServiceUnit=t,r=r||e.ServiceUnit,i.httpClient.post(i.printEntity.appUrl+j.PrintSingleByFilter+"su="+r,o,s).toPromise().then(function(t){return t})})},t.prototype.printMultiById=function(t,e,r,n){if(!1===L.checkFlag(n))return alert("内部方法，外部请使用cloudprint.service下的服务"),null;var i={sourceOptionsList:t,options:e},o={responseType:"blob"};return o.headers={SessionId:this.printEntity.sessionId||"","Content-Type":"application/json"},this.httpClient.post(this.printEntity.appUrl+j.PrintMultiById+"su="+r,i,o).toPromise().then(function(t){return t})},t.prototype.printMultiByFilter=function(t,e,r,n){if(!1===L.checkFlag(n))return alert("内部方法，外部请使用cloudprint.service下的服务"),null;var i={sourceFilterOptionsList:t,options:e},o={responseType:"blob"};return o.headers={SessionId:this.printEntity.sessionId||"","Content-Type":"application/json"},this.httpClient.post(this.printEntity.appUrl+j.PrintMultiByFilter+"su="+r,i,o).toPromise().then(function(t){return t})},t.prototype.printTestData=function(t,e,r){if(!1===L.checkFlag(r))return alert("内部方法，外部请使用cloudprint.service下的服务"),null;var n={format:t,data:JSON.stringify(e)},i={responseType:"blob"};return i.headers={SessionId:this.printEntity.sessionId||"","Content-Type":"application/json"},this.httpClient.post(this.printEntity.appUrl+j.PrintTestData+"su="+this.curSu,n,i).toPromise().then(function(t){return t})},t.prototype.sendPrintEvent=function(t,e){if(!1===L.checkFlag(e))return alert("内部方法，外部请使用cloudprint.service下的服务"),null;var r={};return r.headers={SessionId:this.printEntity.sessionId||"","Content-Type":"application/json"},this.httpClient.post(this.printEntity.appUrl+j.SendPrintEvent+"su="+this.curSu,t,r).toPromise().then(function(t){return t})},t.prototype.isRemotePrint=function(){return I(this,void 0,void 0,function(){var e,r;return E(this,function(t){switch(t.label){case 0:return e=this.printEntity.appUrl+j.IsRemotePrint+"su="+this.curSu,(r={}).headers={SessionId:this.printEntity.sessionId||"","Content-Type":"application/json"},[4,this.httpClient.get(e,r).toPromise().then(function(t){return t})];case 1:return[2,t.sent()]}})})},t.prototype.getEnableFonts=function(){return I(this,void 0,void 0,function(){var e,r;return E(this,function(t){switch(t.label){case 0:return e=this.printEntity.appUrl+j.GetEnableFonts+"su="+this.curSu,(r={}).headers={SessionId:this.printEntity.sessionId||"","Content-Type":"application/json"},[4,this.httpClient.get(e,r).toPromise().then(function(t){return t})];case 1:return[2,t.sent()]}})})},t.prototype.getSuByFormatId=function(t){var e=this.printEntity.appUrl+"/getSuByFormatId?formatId="+t+"&su=cloudprint",r={responseType:"text/html"};return r.headers={SessionId:this.printEntity.sessionId||"","Content-Type":"application/json"},this.httpClient.get(e,r).toPromise().then(function(t){return t})},t.decorators=[{type:v.Injectable}],t.ctorParameters=function(){return[{type:w.HttpClient}]},t}(),G=function(){function t(t){this.http=t}return t.decorators=[{type:v.Injectable}],t.ctorParameters=function(){return[{type:w.HttpClient}]},t}(),W=function(){function t(){}return t.isPC=function(){return!navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i)},t.uuid=function(){return[this.gen(2),this.gen(1),this.gen(1),this.gen(1),this.gen(3)].join("-")},t.renderPdfByByte=function(p,l){if(p)var c=setInterval(function(){if(l){var t=document.getElementById("viewframe");if(t){var e=t.contentWindow.document.getElementById("openFile"),r=t.contentWindow.document.getElementById("print"),n=t.contentWindow.document.getElementById("download"),i=!1,o=!1,s=!1;e&&(e.style.display="none",i=!0),n&&(n.style.display="none",o=!0),r&&(r.style.display="none",s=!0),i&&o&&s&&clearInterval(c)}else{var a=[];a.push(new Uint8Array(p)),this.url=window.URL.createObjectURL(new Blob(a,{type:"application/pdf"})),l.innerHTML='<iframe id="viewframe" src="/platform/common/web/pdfjs/viewer.html?file='+encodeURIComponent(this.url)+'" height="100%" width="100%"></iframe>',l.hidden=!1}}},200)},t.gen=function(t){for(var e="",r=0;r<t;r++)e+=(65536*(1+Math.random())|0).toString(16).substring(1);return e},t}(),V=function(){function t(t,e,r,n,i,o){this.server=t,this.formatSrv=e,this.notifyService=r,this.functionRegister=n,this.editsrv=i,this.loadSrv=o,this.printEntity=new T,Stimulsoft.Base.StiLicense.key="6vJhGtLLLz2GNviWmUTrhSqnOItdDwjBylQzQcAOiHmUA7xxS8GDDAme3ObyU+jZAO9YGs0yUwkFhPz4MWHZaEdiyHffzbOBGSAkqiNry5YZGU/0ZeiKWcHEB38tgR/zaXp8v+ktUiBOl5B2Dll4y33a3osXfKmsg7lHgK/JYlcS08G7NgguH8vVnzvNulyD1uv6QdfRDQOP/FfeKHq3M70ZPvUspYpkCzGqP4nJJ5ktST13+f3E90Y0n1BkbAbYCI3JqheM988LYP2lmJ5mAzuV5t3ILzfUehp6/HIy8LPbzzVlU22X9I1t2xY6W1qsi/pKaXeAfJ0T5x/CUbywJ9JyKaTMwIUhDqUVIrleQbFvNFUrLznXCcd55QNngQjoC6Wx9CZ9ryjdPdp0dMfCC0exZXtQW0IR+lWjD9pdUkYPJWn5eACs0ToahpEvdwlW76eL5ufNRT6xYjBqlGQ/9VuV5LD9EROLqHxpucBoNPLl7s8ealNcm5seZjuR1iSiOPcqd05m3ellOoxBzSLWaB/sNMWTAOhBIWNv7dPOcq8KuAfwaJCkV3WTbQAhX2XJ",this.printEntity.isUseMetaData=!0,this.formatSrv.printEntity=this.printEntity}return t.prototype.ngOnInit=function(){this.docTitle=document.title,this.initDesigner(),console.log("加载设计器成功")},t.prototype.ngOnDestroy=function(){this.printEntity.onExitEvent.emit()},t.prototype.setPrintEntity=function(t){this.printEntity=t,this.formatSrv.printEntity=this.printEntity},t.prototype.setOptions=function(t){t.toolbar.showAboutButton=!1,t.toolbar.showFileMenuAbout=!1,t.toolbar.showFileMenuClose=!1,t.toolbar.showFileMenuExit=!1,t.toolbar.showFileMenuInfo=!1,t.toolbar.showFileMenuNew=!1,t.toolbar.showFileMenuOptions=!1,t.toolbar.showFileMenuReportSetup=!1,t.toolbar.showFileMenuSave=!1,t.toolbar.showPublishButton=!1,t.toolbar.showSaveButton=!(1==this.printEntity.state),t.toolbar.showSetupToolboxButton=!1,t.appearance.showTooltipsHelp=!1,t.appearance.fullScreenMode=this.printEntity.isFullScreen||!1,t.dictionary.dataSourcesPermissions=Stimulsoft.Designer.StiDesignerPermissions.ModifyView,t.dictionary.resourcesPermissions=Stimulsoft.Designer.StiDesignerPermissions.None,t.dictionary.dataRelationsPermissions=Stimulsoft.Designer.StiDesignerPermissions.ModifyView,t.dictionary.dataColumnsPermissions=Stimulsoft.Designer.StiDesignerPermissions.ModifyView},t.prototype.initEvents=function(){var i=this;this.designer.onSaveReport=function(t){var e=t.report.saveToJsonString();this.report.pages.list;i.printEntity.onSaveReportEvent.emit(e),window.parent&&window.parent.onSaveReportEvent&&window.parent.onSaveReportEvent({format:e}),i.printEntity.isUseMetaData&&(i.printEntity.printFormat.content=e,i.formatSrv.saveWithRes(i.printEntity.printFormat).then(function(t){var e=Stimulsoft.Base.Localization.StiLocalization.get("Custom","sucSave");i.notifyService.success(e),i.printEntity.printFormat=t,i.printEntity.onGetPrintFormatIdEvent.emit(i.printEntity.printFormat.id),i.printEntity.onSavedReportEvent.emit({printFormat:i.printEntity.printFormat}),window.parent&&window.parent.onSavedReportEvent&&window.parent.onSavedReportEvent({saved:!0,format:i.printEntity.printFormat})})["catch"](function(t){var e=Stimulsoft.Base.Localization.StiLocalization.get("Custom","failSave");i.notifyService.error(e),i.printEntity.onGetPrintFormatIdEvent.emit(""),console.log(t)}))},this.designer.onPreviewReport=function(t){var e=t.report.saveToJsonString(),n=document.getElementById("StiDesigner_ViewerReportPanel");return n.hidden=!0,i.loadSrv.show({message:"loading..."}),i.editsrv.printTestData(e,i.printEntity.data,"CloudPrint").then(function(t){var e=new Blob([t]),r=new FileReader;r.readAsArrayBuffer(e),r.onload=function(t){var e=r.result;W.renderPdfByByte(e,n)},i.loadSrv.close()}),!1}},t.prototype.checkBeforeSave=function(t){for(var e=!0,r=0;r<t.count;r++)if(0===t[r].components.count){e=!1;break}return e},t.prototype.initDesigner=function(){var n=this;return this.editsrv.getEnableFonts().then(function(t){var r=[];t.forEach(function(t){var e=new Stimulsoft.System.Drawing.FontFamily(t);r.push(e)}),Stimulsoft.System.Drawing.FontFamily._families=r;var e=new Stimulsoft.Designer.StiDesignerOptions;return n.designer=new Stimulsoft.Designer.StiDesigner(e,"StiDesigner",!1),n.designer.report=new Stimulsoft.Report.StiReport,n.initLocalizations(),n.setOptions(e),n.initEvents(),n.loadDesigner(n.printEntity.foramtId)})["catch"](function(){n.notifyService.error("Load Enable Fonts Error")})},t.prototype.initLocalizations=function(){var t=this.printEntity.language;Stimulsoft.Base.Localization.StiLocalization.addLocalizationFile("/platform/common/web/stimulsoft/languages/"+t+".xml",!1,t),Stimulsoft.Base.Localization.StiLocalization.cultureName=t},t.prototype.initCustomFunction=function(){return this.functionRegister.initCustomFunction(this.printEntity.appUrl+j.GetCustomJsFunc)},t.prototype.loadDesigner=function(t){var r=this;return this.formatSrv.loadFormat(t,"CloudPrint").then(function(t){return r.designer.report.load(t),r.formatSrv.loadData(r.printEntity.dataId,"CloudPrint")}).then(function(t){var e=new Stimulsoft.System.Data.DataSet("Data");return console.log("给数据源添加数据"),e.readJson(t),console.log("清空报表的数据源，以便重新赋值"),r.designer.report.dictionary.databases.clear(),r.designer.report.regData("Data","Data",e),r.initCustomFunction()}).then(function(){r.designer.renderHtml("designer"),r.setOptionsAfterRend(r.designer),document.getElementById("StiDesigner").style.height=r.printEntity.designerHeight,document.title=r.docTitle})["catch"](function(t){console.log(t)})},t.prototype.setOptionsAfterRend=function(t){t.jsObject.options.report.properties.reportFile="report.mrt",t.jsObject.options.buttons.dictionaryActions.hidden=!0,t.jsObject.options.buttons.dictionaryNewItem.hidden=!0,t.jsObject.options.buttons.pageToolButton.hidden=!0,t.jsObject.options.buttons.insertToolButton.hidden=!0,t.jsObject.options.buttons.propertiesToolbarEventsTab.hidden=!0,t.jsObject.options.buttons.redoButton.hidden=!0,t.jsObject.options.buttons.undoButton.hidden=!0,t.jsObject.options.buttons.reportCheckerButton.hidden=!0,t.jsObject.options.buttons.localizationButton.hidden=!0,t.jsObject.options.buttons.resizeDesigner.hidden=!0,t.jsObject.options.workPanel.changeVisibleState(!1),t.jsObject.options.workPanel.visibleState=!1;var e=t.jsObject.options.viewerContainer.firstChild;e.jsObject.controls.toolbar.style.display="none",e.jsObject.controls.buttons.Zoom.style.display="none",e.jsObject.controls.buttons.ZoomOnePage.style.display="none",e.jsObject.controls.buttons.ZoomPageWidth.style.display="none"},t.prototype.loadSystemFonts=function(){},t.decorators=[{type:v.Component,args:[{selector:"app-cloudprint-designer",template:'<div style="overflow:auto;height: 100%;width: 100%">\r\n    <div id="designer" style="height: 100%;width: 100%"></div>\r\n</div>\r\n',styles:["div #StiDesigner{height:100%}"]}]}],t.ctorParameters=function(){return[{type:G},{type:k},{type:b.NotifyService},{type:x},{type:k},{type:o.LoadingService}]},t}(),J=function(){function t(t){this.http=t}return t.decorators=[{type:v.Injectable}],t.ctorParameters=function(){return[{type:w.HttpClient}]},t}(),q=function(){function t(t,e,r,n,i,o,s,a){this.server=t,this.formatSrv=e,this.notifyService=r,this.functionRegister=n,this.langservice=i,this.loadSrv=o,this.elementRef=s,this.printSrv=a,this.printEntity=new T,Stimulsoft.Base.StiLicense.key="6vJhGtLLLz2GNviWmUTrhSqnOItdDwjBylQzQcAOiHmUA7xxS8GDDAme3ObyU+jZAO9YGs0yUwkFhPz4MWHZaEdiyHffzbOBGSAkqiNry5YZGU/0ZeiKWcHEB38tgR/zaXp8v+ktUiBOl5B2Dll4y33a3osXfKmsg7lHgK/JYlcS08G7NgguH8vVnzvNulyD1uv6QdfRDQOP/FfeKHq3M70ZPvUspYpkCzGqP4nJJ5ktST13+f3E90Y0n1BkbAbYCI3JqheM988LYP2lmJ5mAzuV5t3ILzfUehp6/HIy8LPbzzVlU22X9I1t2xY6W1qsi/pKaXeAfJ0T5x/CUbywJ9JyKaTMwIUhDqUVIrleQbFvNFUrLznXCcd55QNngQjoC6Wx9CZ9ryjdPdp0dMfCC0exZXtQW0IR+lWjD9pdUkYPJWn5eACs0ToahpEvdwlW76eL5ufNRT6xYjBqlGQ/9VuV5LD9EROLqHxpucBoNPLl7s8ealNcm5seZjuR1iSiOPcqd05m3ellOoxBzSLWaB/sNMWTAOhBIWNv7dPOcq8KuAfwaJCkV3WTbQAhX2XJ",this.printEntity.isUseMetaData=!0,this.formatSrv.printEntity=this.printEntity}return t.prototype.ngOnInit=function(){this.docTitle=document.title,this.initViewer(),console.log("组件初始：加载预览器成功")},t.prototype.ngOnDestroy=function(){this.printEntity.onExitEvent.emit(),console.log("组件销毁")},t.prototype.setPrintEntity=function(t){this.printEntity=t,this.formatSrv.printEntity=this.printEntity},t.prototype.initViewer=function(){var t=this;document.title=this.docTitle,this.loadSrv.show({message:"loading..."});var e=this.printEntity.rendedFormat,r=this.renderPdf(e);r&&r.then?r.then(function(){t.loadSrv.close()}):this.loadSrv.close()},t.prototype.renderPdf=function(t){var n=this;if(!t)return this.outputParam.prnOutputOps.printJob=!1,1<this.outputParam.prnSourceOptions.length?this.outputParam.isFilter?this.formatSrv.printMultiByFilter(this.outputParam.prnSourceOptions,this.outputParam.prnOutputOps,null,"CloudPrint").then(function(t){var e=new Blob([t]),r=new FileReader;r.readAsArrayBuffer(e),r.onload=function(t){n.renderPdf(r.result)}}):this.formatSrv.printMultiById(this.outputParam.prnSourceOptions,this.outputParam.prnOutputOps,null,"CloudPrint").then(function(t){var e=new Blob([t]),r=new FileReader;r.readAsArrayBuffer(e),r.onload=function(t){n.renderPdf(r.result)}}):this.outputParam.isFilter?this.formatSrv.printSingleByFilter(this.outputParam.prnSourceOptions[0],this.outputParam.prnOutputOps,null,"CloudPrint").then(function(t){var e=new Blob([t]),r=new FileReader;r.readAsArrayBuffer(e),r.onload=function(t){n.renderPdf(r.result)}}):this.formatSrv.printSingleById(this.outputParam.prnSourceOptions[0],this.outputParam.prnOutputOps,null,"CloudPrint").then(function(t){var e=new Blob([t]),r=new FileReader;r.readAsArrayBuffer(e),r.onload=function(t){n.renderPdf(r.result)}});var e=document.getElementById("viewer");W.renderPdfByByte(t,e)},t.prototype.printDirect=function(){var e=this;document.getElementById("viewer").firstChild.contentWindow.print();var t=this.outputParam.prnSourceOptions,r=[],n=[],i=[],o=[],s=[],a=[],p=[],l=[];t.forEach(function(t){r.push(t.ServiceUnit),n.push(t.FormatId),s.push(t.SourceId),l.push(e.outputParam.isFilter),e.outputParam.isFilter?a.push(JSON.stringify(t.EntityFilter)):p.push(t.DataIds),i.push(t.billCategoryId),o.push(t.bizTypeId)});var c={formatid:n,sourceid:s,entityfilter:a,dataid:p,isfilter:l,su:r,billcategory:i,biztype:o};this.formatSrv.sendPrintEvent(c,"CloudPrint")},t.prototype.printBox=function(){var t=this;return t.outputParam.prnOutputOps.printJob=!0,1<t.outputParam.prnSourceOptions.length?t.outputParam.isFilter?t.printSrv.printMultiByFilter4Job(t.outputParam.prnSourceOptions,t.outputParam.prnOutputOps):t.printSrv.printMultiById4Job(t.outputParam.prnSourceOptions,t.outputParam.prnOutputOps):t.outputParam.isFilter?t.printSrv.printSingleByFilter4Job(t.outputParam.prnSourceOptions[0],t.outputParam.prnOutputOps):t.printSrv.printSingleById4Job(t.outputParam.prnSourceOptions[0],t.outputParam.prnOutputOps)},t.decorators=[{type:v.Component,args:[{selector:"app-cloudprint-viewer",template:'\x3c!-- <div class="f-page f-page-navigate f-page-is-grid-grid">\r\n    <div class="f-page-header">\r\n        <nav class="f-page-header-base">    \r\n            <div class="f-title">\r\n                <span class="f-title-icon f-text-orna-bill">\r\n                    <i class="f-icon f-icon-page-title-administer"></i>\r\n                </span>\r\n                <h4 class="farris-form-title mr-auto">打印预览</h4>\r\n            </div>\r\n            <f-response-toolbar\r\n                class="col-7 f-toolbar"\r\n                [datas]="toolbarData"\r\n                (rtClickEvent)="responseToolbarClick($event)">\r\n            </f-response-toolbar>\r\n        </nav>\r\n    </div>\r\n    \r\n    <section class="f-page-main">\r\n        <div style="overflow:auto;height: 100%;width: 100%">\r\n            <div id="viewer"  style="height:100%"></div>\r\n        </div>\r\n    </section>    \r\n</div> --\x3e\r\n\r\n<div class="f-page f-page-is-managelist">\r\n    <div class="f-page-main">\r\n      <farris-section class="f-section-grid f-section-in-managelist" [showHeader]="false">\r\n        <div class="f-section-header" style="padding: 0px;margin: 0px">\r\n          <div class="f-title">\r\n            <h5 class="f-title__title">{{\'printview\' | locale}}</h5>\r\n          </div>\r\n          <div class="f-toolbar">\r\n            <div id="operate" style="text-align: right;padding: 10px;min-width: 300px;">\r\n                <farris-button style="padding: 3px" (click)="printDirect()">\r\n                    <span>{{\'PrintWithoutPreview\' | locale}}</span>\r\n                </farris-button>\r\n                <farris-button *ngIf="isRemotePrint" [type]="\'secondary\'" style="padding: 3px" (click)="printBox()">\r\n                    <span>{{\'PrintWithBox\' | locale}}</span>\r\n                </farris-button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n  \r\n        <div class="f-section-content">\r\n          <div class="f-component-grid">\r\n            <div style="overflow:auto;height: 100%;width: 100%">\r\n                <div id="viewer"  style="height:100%"></div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </farris-section>\r\n    </div>\r\n  </div>\r\n\r\n',styles:[""]}]}],t.ctorParameters=function(){return[{type:J},{type:k},{type:b.NotifyService},{type:x},{type:i.LanguageService},{type:o.LoadingService},{type:v.ElementRef},{type:nt,decorators:[{type:v.Inject,args:[v.forwardRef(function(){return nt})]}]}]},t.propDecorators={outputParam:[{type:v.Input}],isRemotePrint:[{type:v.Input}]},t}(),z={Designer:1,Viewer:2};z[z.Designer]="Designer",z[z.Viewer]="Viewer";var H=function Pt(){},_={BE:0,VO:1,BO:2,CO:3};_[_.BE]="BE",_[_.VO]="VO",_[_.BO]="BO",_[_.CO]="CO";var Q=function(){function t(t,e){this.notifyService=t,this.print=new v.EventEmitter,this.columns=[]}return t.prototype.ngOnInit=function(){this.columns=[{field:"code",title:this.localepip.transform("formatcode")},{field:"name",title:this.localepip.transform("formatname")}]},t.prototype.selectChange=function(t){this.formatId=t.id},t.prototype.printJob=function(){this.checkBeforePrint()&&this.print.emit({id:this.formatId})},t.prototype.checkBeforePrint=function(){return!!this.formatId||(this.notifyService.warning(this.localepip.transform("selectformat")),!1)},t.decorators=[{type:v.Component,args:[{selector:"lib-formatlist",template:'\r\n<div class="f-page f-page-navigate f-page-is-grid-card">\r\n    <section class="f-page-main">\r\n        <farris-section class="f-section-grid f-section-in-managelist" [showHeader]="false">\r\n    \r\n            <div class="f-section-content">\r\n                <div class="f-component-grid">\r\n                <farris-datagrid\r\n                    [fit]="true" \r\n                    [pagination]="false"\r\n                    [virtualized]="false"\r\n                    [columns]="columns"\r\n                    [pageSize]="50"\r\n                    [showBorder]="false"\r\n                    [striped]="false"\r\n                    [data]="formats"\r\n                    [fitColumns]="true"\r\n                    [nowrap]="false"\r\n                    (selectChanged)="selectChange($event)">\r\n                </farris-datagrid>\r\n                </div>\r\n            </div>\r\n        </farris-section>\r\n    </section>    \r\n</div>\r\n',styles:[""]}]}],t.ctorParameters=function(){return[{type:b.NotifyService},{type:String,decorators:[{type:v.Inject,args:[v.LOCALE_ID]}]}]},t.propDecorators={formats:[{type:v.Input}]},t}(),Z="Unknown",Y={Form:"Form",Query:"Query",LedgerPaper:"LedgerPaper",Attachment:"Attachment",Unknown:"Unknown"},X=function Ct(){},K={Portrait:"Portrait",Landscape:"Landscape"},$=[{key:"A2",value:"A2"},{key:"A3",value:"A3"},{key:"A4",value:"A4"},{key:"A5",value:"A5"},{key:"B4",value:"B4"},{key:"B5",value:"B5"},{key:"Legal",value:"Legal"},{key:"Letter",value:"Letter"},{key:"Statement",value:"Statement"},{key:"Tabloid",value:"Tabloid"}],tt=function(){function t(t,e){this.notifyService=t,this.print=new v.EventEmitter,this.paperlist=[],this.layoutlist=[],this.columns=[],this.isShowFormat=!0,this.printType=0,this.height=0,this.width=0,this.top=0,this.bottom=0,this.left=0,this.right=0,this.copy=1,this.paperkind="A4",this.layout="Portrait",this.printboxid="",this.isCustomPaper=!1,this.isCustomMargin=!1,this.custompaper="自定义纸张:",this.custommargin="自定义页边距:"}return t.prototype.ngOnInit=function(){this.custompaper=this.localepip.transform("custompaper"),this.custommargin=this.localepip.transform("custommargin"),this.columns=[{field:"code",title:this.localepip.transform("formatcode")},{field:"name",title:this.localepip.transform("formatname")}],this.paperlist=$,this.layoutlist=[{key:"Portrait",value:this.localepip.transform("portrait")},{key:"Landscape",value:this.localepip.transform("landscape")}]},t.prototype.printerSelectChange=function(t){this.printboxid=t.data.boxId},t.prototype.selectChange=function(t){this.formatId=t.id},t.prototype.printJob=function(){if(this.checkBeforePrint()){var t=new X;t.bottom=this.bottom,t.top=this.top,t.left=this.left,t.right=this.right,t.height=this.height,t.width=this.width,t.copys=this.copy,t.paperName=this.paperkind,this.isCustomPaper?t.centerPrint=!1:t.centerPrint=!0,K.Landscape.toString()==this.layout?t.printOritation=K.Landscape:t.printOritation=K.Portrait,this.print.emit({id:this.formatId,boxId:this.printboxid,printter:this.printter,printSetting:t})}},t.prototype.checkBeforePrint=function(){return this.formatId||1==this.printType?this.printter?this.layout?this.paperkind||0!=this.height||0!=this.width?!!this.printboxid||(this.notifyService.warning(this.localepip.transform("noagent")),!1):(this.notifyService.warning(this.localepip.transform("nopapersize")),!1):(this.notifyService.warning(this.localepip.transform("selectlayout")),!1):(this.notifyService.warning(this.localepip.transform("selectprinter")),!1):(this.notifyService.warning(this.localepip.transform("selectformat")),!1)},t.decorators=[{type:v.Component,args:[{selector:"lib-formatlistjob",template:'\r\n<div class="f-page f-page-navigate f-page-is-grid-card">\r\n  <section class="f-page-main">\r\n    <farris-splitter class="f-page-content">\r\n        <farris-splitter-pane *ngIf="isShowFormat"  class="f-col-w5 f-page-content-nav"\r\n        [ngResizable]="true" \r\n        [rzHandles]="\'e\'">\r\n            <farris-section class="f-section-grid f-section-in-managelist" [showHeader]="false">\r\n              <div class="f-section-header">\r\n                <div class="f-title">\r\n                  <h5 class="f-title__title">{{\'printformat\' | locale}}</h5>\r\n                </div>\r\n              </div>\r\n        \r\n              <div class="f-section-content">\r\n                <div class="f-component-grid">\r\n                  <farris-datagrid\r\n                      [fit]="true" \r\n                      [pagination]="false"\r\n                      [virtualized]="false"\r\n                      [columns]="columns"\r\n                      [pageSize]="50"\r\n                      [showBorder]="false"\r\n                      [fitColumns]="true"\r\n                      [striped]="false"\r\n                      [data]="formats"\r\n                      [nowrap]="false"\r\n                      (selectChanged)="selectChange($event)">\r\n                  </farris-datagrid>\r\n                </div>\r\n              </div>\r\n            </farris-section>\r\n        </farris-splitter-pane>\r\n\r\n        <farris-splitter-pane class="f-page-content-main">\r\n            <farris-section class="f-section-grid f-section-in-managelist farris-form-controls-inline" [showHeader]="false">\r\n              <div class="f-section-header">\r\n                <div class="f-title">\r\n                  <h5 class="f-title__title">{{\'printset\' | locale}}</h5>\r\n                </div>\r\n              </div>\r\n        \r\n              <fieldset class="f-section-formgroup">\r\n                <div class="f-section-formgroup-inputs">\r\n                  <div class="col-12">\r\n                      <div class="farris-group-wrap">\r\n                      <div class="form-group farris-form-group">\r\n                          <label class="col-form-label">\r\n                            <span class="farris-label-info text-danger">*</span>\r\n                            <span class="farris-label-text">{{\'printer\' | locale}}</span>\r\n                          </label>\r\n                          <div class="farris-input-wrap">\r\n                            <farris-combo-list \r\n                              [(ngModel)]="printter"\r\n                              [idField]="\'name\'"\r\n                              [textField]="\'description\'"\r\n                              [data]="boxlist"\r\n                              [editable]="false"\r\n                              (selectChange)="printerSelectChange($event)">\r\n                            </farris-combo-list>\r\n                          </div>\r\n                      </div>\r\n                      </div>\r\n                  </div>\r\n                  <div *ngIf="printType!=1" class="col-12">\r\n                      <div class="farris-group-wrap">\r\n                      <div class="form-group farris-form-group">\r\n                          <label class="col-form-label">\r\n                            <span class="farris-label-text">{{\'paper\' | locale}}</span>\r\n                          </label>\r\n                          <div class="farris-input-wrap">\r\n                            <farris-combo-list \r\n                              [disabled]="isCustomPaper"\r\n                              [(ngModel)]="paperkind"\r\n                              [idField]="\'key\'"\r\n                              [textField]="\'value\'"\r\n                              [data]="paperlist"\r\n                              [editable]="false">\r\n                            </farris-combo-list>\r\n                          </div>\r\n                      </div>\r\n                      </div>\r\n                  </div>\r\n                  <div *ngIf="printType!=1" class="col-12">\r\n                      <div class="farris-group-wrap">\r\n                      <div class="form-group farris-form-group">\r\n                          <label class="col-form-label">\r\n                            <span class="farris-label-text">{{\'paperway\' | locale}}</span>\r\n                          </label>\r\n                          <div class="farris-input-wrap">\r\n                            <farris-combo-list \r\n                              [(ngModel)]="layout"\r\n                              [idField]="\'key\'"\r\n                              [textField]="\'value\'"\r\n                              [data]="layoutlist"\r\n                              [editable]="false">\r\n                            </farris-combo-list>\r\n                          </div>\r\n                      </div>\r\n                      </div>\r\n                  </div>\r\n                  <div *ngIf="printType!=1" class="col-12">\r\n                    <div class="farris-group-wrap">\r\n                    <div class="form-group farris-form-group">\r\n                        <label class="col-form-label">\r\n                          <span class="farris-label-text">{{\'copys\' | locale}}</span>\r\n                        </label>\r\n                        <farris-number-spinner style="width: 100%;" [precision]="0" [min]="1" [(ngModel)]="copy"></farris-number-spinner>\r\n                    </div>\r\n                    </div>\r\n                  </div>\r\n                  <div *ngIf="printType!=1" class="col-12">\r\n                    <div class="farris-group-wrap">\r\n                    <div class="form-group farris-form-group">\r\n                      <farris-checkboxgroup style="font-weight: bold;" [(ngModel)]="isCustomPaper"\r\n                          [data]="[{value:true,name:custompaper}]">\r\n                      </farris-checkboxgroup>\r\n                      \x3c!-- <label class="col-form-label">\r\n                        <span style="font-weight: bold;" class="farris-label-text">自定义纸张:</span>\r\n                      </label> --\x3e\r\n                    </div>\r\n                    </div>\r\n                  </div>\r\n                  <div *ngIf="printType!=1" class="col-12 col-md-6">\r\n                      <div class="farris-group-wrap">\r\n                      <div class="form-group farris-form-group">\r\n                          <label class="col-form-label">\r\n                            <span class="farris-label-text">{{\'length\' | locale}}</span>\r\n                          </label>\r\n                          <farris-number-spinner [disabled]="!isCustomPaper" [precision]="0" [min]="1" [(ngModel)]="height"></farris-number-spinner>\r\n                      </div>\r\n                      </div>\r\n                  </div>\r\n                  <div *ngIf="printType!=1" class="col-12 col-md-6">\r\n                      <div class="farris-group-wrap">\r\n                      <div class="form-group farris-form-group">\r\n                          <label class="col-form-label">\r\n                            <span class="farris-label-text">{{\'width\' | locale}}</span>\r\n                          </label>\r\n                          <farris-number-spinner [disabled]="!isCustomPaper" [precision]="0" [min]="1" [(ngModel)]="width"></farris-number-spinner>\r\n                      </div>\r\n                      </div>\r\n                  </div>\r\n                  <div *ngIf="printType!=1" class="col-12">\r\n                    <div class="farris-group-wrap">\r\n                    <div class="form-group farris-form-group">\r\n                      <farris-checkboxgroup style="font-weight: bold;" [(ngModel)]="isCustomMargin"\r\n                          [data]="[{value:true,name:custommargin}]">\r\n                      </farris-checkboxgroup>\r\n                        \x3c!-- <label class="col-form-label">\r\n                          <span style="font-weight: bold;" class="farris-label-text">页边距:</span>\r\n                        </label> --\x3e\r\n                    </div>\r\n                    </div>\r\n                  </div>\r\n                  <div *ngIf="printType!=1" class="col-12 col-md-6">\r\n                      <div class="farris-group-wrap">\r\n                      <div class="form-group farris-form-group">\r\n                          <label for="hpinput01" class="col-form-label">\r\n                            <span class="farris-label-text">{{\'top\' | locale}}</span>\r\n                          </label>\r\n                            <farris-number-spinner [disabled]="!isCustomMargin" [precision]="0" [min]="1" [(ngModel)]="top"></farris-number-spinner>\r\n                      </div>\r\n                      </div>\r\n                  </div>\r\n                  <div *ngIf="printType!=1" class="col-12 col-md-6">\r\n                      <div class="farris-group-wrap">\r\n                      <div class="form-group farris-form-group">\r\n                          <label class="col-form-label">\r\n                            <span class="farris-label-text">{{\'bottom\' | locale}}</span>\r\n                          </label>\r\n                          <farris-number-spinner [disabled]="!isCustomMargin" [precision]="0" [min]="1" [(ngModel)]="bottom"></farris-number-spinner>\r\n                      </div>\r\n                      </div>\r\n                  </div>\r\n                  <div *ngIf="printType!=1" class="col-12 col-md-6">\r\n                      <div class="farris-group-wrap">\r\n                      <div class="form-group farris-form-group">\r\n                          <label class="col-form-label">\r\n                            <span class="farris-label-text">{{\'left\' | locale}}</span>\r\n                          </label>\r\n                          <farris-number-spinner [disabled]="!isCustomMargin" [precision]="0" [min]="1" [(ngModel)]="left"></farris-number-spinner>\r\n                      </div>\r\n                      </div>\r\n                  </div>\r\n                  <div *ngIf="printType!=1" class="col-12 col-md-6">\r\n                    <div class="farris-group-wrap">\r\n                    <div class="form-group farris-form-group">\r\n                        <label class="col-form-label">\r\n                          <span class="farris-label-text">{{\'right\' | locale}}</span>\r\n                        </label>\r\n                        <farris-number-spinner [disabled]="!isCustomMargin" [precision]="0" [min]="1" [(ngModel)]="right"></farris-number-spinner>\r\n                    </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </fieldset>\r\n            </farris-section>\r\n        </farris-splitter-pane>\r\n\r\n    </farris-splitter>\r\n\r\n    \x3c!-- <farris-section *ngIf="!isShowFormat" class="f-section-grid f-section-in-managelist farris-form-controls-inline" [showHeader]="false">\r\n      <div class="f-section-header">\r\n        <div class="f-title">\r\n          <h5 class="f-title__title">{{\'printset\' | locale}}</h5>\r\n        </div>\r\n      </div>\r\n\r\n      <fieldset class="f-section-formgroup">\r\n        <div class="f-section-formgroup-inputs">\r\n          <div class="col-12">\r\n              <div class="farris-group-wrap">\r\n              <div class="form-group farris-form-group">\r\n                  <label class="col-form-label">\r\n                    <span class="farris-label-info text-danger">*</span>\r\n                    <span class="farris-label-text">{{\'printer\' | locale}}</span>\r\n                  </label>\r\n                  <div class="farris-input-wrap">\r\n                    <farris-combo-list \r\n                      [(ngModel)]="printter"\r\n                      [idField]="\'name\'"\r\n                      [textField]="\'description\'"\r\n                      [data]="boxlist"\r\n                      [editable]="false"\r\n                      (selectChange)="printerSelectChange($event)">\r\n                    </farris-combo-list>\r\n                  </div>\r\n              </div>\r\n              </div>\r\n          </div>\r\n          <div class="col-12">\r\n              <div class="farris-group-wrap">\r\n              <div class="form-group farris-form-group">\r\n                  <label class="col-form-label">\r\n                    <span class="farris-label-text">{{\'paper\' | locale}}</span>\r\n                  </label>\r\n                  <div class="farris-input-wrap">\r\n                    <farris-combo-list \r\n                      [disabled]="isCustomPaper"\r\n                      [(ngModel)]="paperkind"\r\n                      [idField]="\'key\'"\r\n                      [textField]="\'value\'"\r\n                      [data]="paperlist"\r\n                      [editable]="false">\r\n                    </farris-combo-list>\r\n                  </div>\r\n              </div>\r\n              </div>\r\n          </div>\r\n          <div class="col-12">\r\n              <div class="farris-group-wrap">\r\n              <div class="form-group farris-form-group">\r\n                  <label class="col-form-label">\r\n                    <span class="farris-label-text">{{\'paperway\' | locale}}</span>\r\n                  </label>\r\n                  <div class="farris-input-wrap">\r\n                    <farris-combo-list \r\n                      [(ngModel)]="layout"\r\n                      [idField]="\'key\'"\r\n                      [textField]="\'value\'"\r\n                      [data]="layoutlist"\r\n                      [editable]="false">\r\n                    </farris-combo-list>\r\n                  </div>\r\n              </div>\r\n              </div>\r\n          </div>\r\n\r\n          <div class="col-12">\r\n            <div class="farris-group-wrap">\r\n            <div class="form-group farris-form-group">\r\n                <label class="col-form-label">\r\n                  <span class="farris-label-text">{{\'copys\' | locale}}</span>\r\n                </label>\r\n                <farris-number-spinner style="width: 100%;" [precision]="0" [min]="1" [(ngModel)]="copy"></farris-number-spinner>\r\n            </div>\r\n            </div>\r\n          </div>\r\n          <div class="col-12">\r\n              <div class="farris-group-wrap">\r\n              <div class="form-group farris-form-group">\r\n                <farris-checkboxgroup style="font-weight: bold;" [(ngModel)]="isCustomPaper"\r\n                    [data]="[{value:\'1\',name:custompaper}]">\r\n                </farris-checkboxgroup>\r\n              </div>\r\n              </div>\r\n          </div>\r\n          <div class="col-12 col-md-6">\r\n              <div class="farris-group-wrap">\r\n              <div class="form-group farris-form-group">\r\n                  <label class="col-form-label">\r\n                    <span class="farris-label-text">{{\'length\' | locale}}</span>\r\n                  </label>\r\n                  <farris-number-spinner [disabled]="!isCustomPaper" [precision]="0" [min]="1" [(ngModel)]="height"></farris-number-spinner>\r\n              </div>\r\n              </div>\r\n          </div>\r\n          <div class="col-12 col-md-6">\r\n              <div class="farris-group-wrap">\r\n              <div class="form-group farris-form-group">\r\n                  <label class="col-form-label">\r\n                    <span class="farris-label-text">{{\'width\' | locale}}</span>\r\n                  </label>\r\n                  <farris-number-spinner [disabled]="!isCustomPaper" [precision]="0" [min]="1" [(ngModel)]="width"></farris-number-spinner>\r\n              </div>\r\n              </div>\r\n          </div>\r\n          <div class="col-12">\r\n            <div class="farris-group-wrap">\r\n            <div class="form-group farris-form-group">\r\n              <farris-checkboxgroup style="font-weight: bold;" [(ngModel)]="isCustomMargin"\r\n                  [data]="[{value:\'1\',name:custommargin}]">\r\n              </farris-checkboxgroup>\r\n            </div>\r\n            </div>\r\n          </div>\r\n          <div class="col-12 col-md-6">\r\n              <div class="farris-group-wrap">\r\n              <div class="form-group farris-form-group">\r\n                  <label for="hpinput01" class="col-form-label">\r\n                    <span class="farris-label-text">{{\'top\' | locale}}</span>\r\n                  </label>\r\n                    <farris-number-spinner [disabled]="!isCustomMargin" [precision]="0" [min]="1" [(ngModel)]="top"></farris-number-spinner>\r\n              </div>\r\n              </div>\r\n          </div>\r\n          <div class="col-12 col-md-6">\r\n              <div class="farris-group-wrap">\r\n              <div class="form-group farris-form-group">\r\n                  <label class="col-form-label">\r\n                    <span class="farris-label-text">{{\'bottom\' | locale}}</span>\r\n                  </label>\r\n                  <farris-number-spinner [disabled]="!isCustomMargin" [precision]="0" [min]="1" [(ngModel)]="bottom"></farris-number-spinner>\r\n              </div>\r\n              </div>\r\n          </div>\r\n          <div class="col-12 col-md-6">\r\n              <div class="farris-group-wrap">\r\n              <div class="form-group farris-form-group">\r\n                  <label class="col-form-label">\r\n                    <span class="farris-label-text">{{\'left\' | locale}}</span>\r\n                  </label>\r\n                  <farris-number-spinner [disabled]="!isCustomMargin" [precision]="0" [min]="1" [(ngModel)]="left"></farris-number-spinner>\r\n              </div>\r\n              </div>\r\n          </div>\r\n          <div class="col-12 col-md-6">\r\n            <div class="farris-group-wrap">\r\n            <div class="form-group farris-form-group">\r\n                <label class="col-form-label">\r\n                  <span class="farris-label-text">{{\'right\' | locale}}</span>\r\n                </label>\r\n                <farris-number-spinner [disabled]="!isCustomMargin" [precision]="0" [min]="1" [(ngModel)]="right"></farris-number-spinner>\r\n            </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </fieldset>\r\n    </farris-section> --\x3e\r\n  </section>\r\n</div>\r\n\r\n',styles:[""]}]}],t.ctorParameters=function(){return[{type:b.NotifyService},{type:String,decorators:[{type:v.Inject,args:[v.LOCALE_ID]}]}]},t.propDecorators={formats:[{type:v.Input}],boxlist:[{type:v.Input}]},t}(),et={"zh-CHS":{printview:"打印预览",printformat:"打印格式",printdesigner:"打印设计器",printset:"打印配置",printer:"打印机",print:"打印",cancel:"取消",sendprintjob:"已成功发送打印任务",appurlerror:"未配置正确的appUrl",formatcode:"格式编号",formatname:"格式名称",portrait:"纵向",landscape:"横向",selectprinter:"请选择打印机",selectformat:"请选择打印格式",selectlayout:"请选择布局",noagent:"打印机对应的打印代理为空,后续打印将无法定位打印机",nopapersize:"纸张和自定义大小不可同时为空",paper:"纸张",paperway:"纸张方向",copys:"打印份数",length:"长(厘米)",width:"宽(厘米)",top:"上(厘米)",bottom:"下(厘米)",left:"左(厘米)",right:"右(厘米)",custompaper:"自定义纸张:",custommargin:"自定义页边距:",PrintWithoutPreview:"直接打印",PrintWithBox:"远程打印"},"en-US":{printview:"Print View",printformat:"Print Format",printdesigner:"Print Designer",printset:"Print Setting",print:"Print",cancel:"Cancel",printer:"Printer",sendprintjob:"Send Print Job Success",appurlerror:"AppUrl Error",formatcode:"Format Code",formatname:"Format Name",portrait:"Portrait",landscape:"Landscape",selectprinter:"Please Select Printer",selectformat:"Please Select Format",selectlayout:"Please Select Layout",noagent:"Agent Is Empty,It May Can Not Locate The Printer",nopapersize:"Paper Size Is Not Allowed Empty",paper:"Paper",paperway:"Paper Direction",copys:"Copy",length:"Length(centimetre)",width:"Width(centimetre)",top:"Top(centimetre)",bottom:"Bottom(centimetre)",left:"Left(centimetre)",right:"Right(centimetre)",custompaper:"Custom Paper:",custommargin:"Custom Margin:",PrintWithoutPreview:"Direct Print",PrintWithBox:"Remote Print"},en:{printview:"Print View",printformat:"Print Format",printdesigner:"Print Designer",printset:"Print Setting",print:"Print",cancel:"Cancel",printer:"Printer",sendprintjob:"Send Print Job Success",appurlerror:"AppUrl Error",formatcode:"Format Code",formatname:"Format Name",portrait:"Portrait",landscape:"Landscape",selectprinter:"Please Select Printer",selectformat:"Please Select Format",selectlayout:"Please Select Layout",noagent:"Agent Is Empty,It May Can Not Locate The Printer",nopapersize:"Paper Size Is Not Allowed Empty",paper:"Paper",paperway:"Paper Direction",copys:"Copy",length:"Length(centimetre)",width:"Width(centimetre)",top:"Top(centimetre)",bottom:"Bottom(centimetre)",left:"Left(centimetre)",right:"Right(centimetre)",custompaper:"Custom Paper:",custommargin:"Custom Margin:",PrintWithoutPreview:"Direct Print",PrintWithBox:"Remote Print"},"zh-CHT":{printview:"打印預覽",printformat:"打印格式",printdesigner:"打印設計器",printset:"打印配置",printer:"打印機",print:"打印",cancel:"取消",sendprintjob:"已成功發送打印任務",appurlerror:"未配置正確的appUrl",formatcode:"格式編號",formatname:"格式名稱",portrait:"縱向",landscape:"橫向",selectprinter:"請選擇打印機",selectformat:"請選擇打印格式",selectlayout:"請選擇佈局",noagent:"打印機對應的打印代理為空,後續打印將無法定位打印機",nopapersize:"紙張和自定義大小不可同時為空",paper:"紙張",paperway:"紙張方向",copys:"打印份數",length:"長(厘米)",width:"寬(厘米)",top:"上(厘米)",bottom:"下(厘米)",left:"左(厘米)",right:"右(厘米)",custompaper:"自定義紙張:",custommargin:"自定義頁邊距:",PrintWithoutPreview:"直接打印",PrintWithBox:"遠程打印"}},rt=function(){function t(t){this.defaultLang="zh-CHS",this.langCode=localStorage.getItem("languageCode")||t||this.defaultLang,this.lang=et[this.langCode]||et[this.defaultLang]}return t.prototype.transform=function(t){return this.lang[t]||t},t.decorators=[{type:v.Pipe,args:[{name:"locale"}]}],t.ctorParameters=function(){return[{type:String,decorators:[{type:v.Inject,args:[v.LOCALE_ID]}]}]},t}(),nt=function(){function t(t,e,r,n,i,o,s,a,p,l){this.formatSrv=t,this.resolver=e,this.designerSrv=r,this.viewerSrv=n,this.injector=i,this.applicationRef=o,this.notifyService=s,this.appService=a,this.windowService=p,this.modalService=l,this.printEntity=new T,this.windowRef=undefined,this.printEntity.appUrl=j.CloudPrintBaseUrl,this.printEntity.isUseMetaData=!0,this.printEntity.language=localStorage.getItem("languageCode")||"zh-CHS",this.formatSrv.printEntity=this.printEntity,this.injector&&(this.modalService=this.injector.get(F.BsModalService),this.localeid=localStorage.getItem("languageCode")||this.injector.get(v.LOCALE_ID),this.localpipe=new rt(this.localeid))}return Object.defineProperty(t.prototype,"setPrintEntity",{set:function(t){this.printEntity=t,this.formatSrv.printEntity=this.printEntity},enumerable:!0,configurable:!0}),t.prototype.openFormatListByDimension=function(i,o,s,a){var p=this,l=this,t=i.SourceId,e=i.billCategoryId;return this.formatSrv.getPrintFormatByDataSrouceAndDimension(e,t,i.FirstDimensionVal,i.SecondDimensionVal).then(function(t){var e=null!=t&&t.length!=undefined?t:[];if(1===e.length)return l.outputBySingleSelectionFormat({id:e[0].id,isFilter:a,beoptions:Object.assign({},i),options:o,isJob:!1,printerName:"",boxId:"",printSetting:null,ele:s});var r=l.resolver.resolveComponentFactory(Q).create(l.injector);r.instance.formats=B(e),r.instance.localepip=l.localpipe;var n=p.modalService.show(r,{title:p.localpipe.transform("printformat"),width:400,height:500,showButtons:!0,showMaxButton:!1,buttons:[{text:p.localpipe.transform("print"),cls:"btn btn-primary",handle:function(){r.instance.printJob()}},{text:p.localpipe.transform("cancel"),cls:"btn btn-secondary",handle:function(){n.close()}}]});r.instance.print.subscribe(function(t){return n.close(),l.outputBySingleSelectionFormat({id:t.id,isFilter:a,beoptions:Object.assign({},i),options:o,isJob:!1,printerName:"",boxId:"",printSetting:null,ele:s})})})},t.prototype.openFormatListByDimension4Job=function(o,s,a,t){var p=this,l=this;if(t)return this.formatSrv.getPrintDevice().then(function(t){var e=t||[],r="";o.forEach(function(t){return r+=t.FormatId+","});var n=l.resolver.resolveComponentFactory(tt).create(l.injector);n.instance.boxlist=e,n.instance.formatId=0<r.length?r.substr(0,r.length-1):r,n.instance.isShowFormat=!1,n.instance.localepip=l.localpipe;var i=p.modalService.show(n,{title:p.localpipe.transform("printset"),width:800,height:500,showButtons:!0,showMaxButton:!1,buttons:[{text:p.localpipe.transform("print"),cls:"btn btn-primary",handle:function(){n.instance.printJob()}},{text:p.localpipe.transform("cancel"),cls:"btn btn-secondary",handle:function(){i.close()}}]});n.instance.print.subscribe(function(t){return i.close(),l.outputByMultiSelectionFormat({isFilter:a,beoptions:B(o),options:Object.assign({},s),isJob:!0,printerName:t.printter,boxId:t.boxId,printSetting:t.printSetting,ele:null})})});var e=o[0].billCategoryId,r=o[0].SourceId;return this.formatSrv.getPrintFormatAndDevice(e,r,o.FirstDimensionVal,o.SecondDimensionVal).then(function(t){var e=t.format||[],r=t.device||[];1===e.length&&(o[0].FormatId=e[0].id);var n=l.resolver.resolveComponentFactory(tt).create(l.injector);n.instance.formats=e,n.instance.boxlist=r,n.instance.formatId=o[0].FormatId,n.instance.isShowFormat=!o[0].FormatId,n.instance.localepip=l.localpipe;var i=p.modalService.show(n,{title:p.localpipe.transform("printset"),width:800,height:500,showButtons:!0,showMaxButton:!1,buttons:[{text:p.localpipe.transform("print"),cls:"btn btn-primary",handle:function(){n.instance.printJob()}},{text:p.localpipe.transform("cancel"),cls:"btn btn-secondary",handle:function(){i.close()}}]});n.instance.print.subscribe(function(t){return i.close(),l.outputBySingleSelectionFormat({id:t.id,isFilter:a,beoptions:Object.assign({},o[0]),options:Object.assign({},s),isJob:!0,printerName:t.printter,boxId:t.boxId,printSetting:t.printSetting,ele:null})})})},t.prototype.outputBySingleSelectionFormat=function(t){var e=this;console.log("选完格式准备渲染: "+JSON.stringify(t));var r=this;if(t.id){if(t.beoptions.FormatId=t.id,t.options.DeviceId=t.boxId,t.options.printerName=t.printerName,t.options.printSetting=t.printSetting,t.options.printJob=t.isJob,t.isJob)return!0===t.isFilter?this.formatSrv.printSingleByFilter(t.beoptions,t.options,t.su,"CloudPrint").then(function(){r.notifyService.success(e.localpipe.transform("sendprintjob"))}):this.formatSrv.printSingleById(t.beoptions,t.options,t.su,"CloudPrint").then(function(){r.notifyService.success(e.localpipe.transform("sendprintjob"))});if(!t.ele)return!0===t.filter?this.formatSrv.printSingleByFilter(t.beoptions,t.options,t.su,"CloudPrint"):this.formatSrv.printSingleById(t.beoptions,t.options,t.su,"CloudPrint");if(!0===t.isFilter){if("download"===t.ele)return this.formatSrv.printSingleByFilter(t.beoptions,t.options,t.su,"CloudPrint").then(function(t){r.downloadFile(t)});r.openRendedViewer(t.ele,null,t.options,[t.beoptions],t.isFilter)}else{if("download"===t.ele)return this.formatSrv.printSingleById(t.beoptions,t.options,t.su,"CloudPrint").then(function(t){r.downloadFile(t)});r.openRendedViewer(t.ele,null,t.options,[t.beoptions],t.isFilter)}}},t.prototype.outputByMultiSelectionFormat=function(t){var e=this;console.log("选完格式准备渲染: "+JSON.stringify(t));var r=this;if(t.options.DeviceId=t.boxId,t.options.printerName=t.printerName,t.options.printSetting=t.printSetting,t.options.printJob=t.isJob,t.isJob)return!0===t.isFilter?this.formatSrv.printMultiByFilter(t.beoptions,t.options,t.su,"CloudPrint").then(function(){r.notifyService.success(e.localpipe.transform("sendprintjob"))}):this.formatSrv.printMultiById(t.beoptions,t.options,t.su,"CloudPrint").then(function(){r.notifyService.success(e.localpipe.transform("sendprintjob"))})},t.prototype.openDesigner=function(t,e,r,n){this.openDesignerInternal(window.document.body,t,e,r,n)},t.prototype.openDesignerOnEle=function(t,e,r,n,i){this.openDesignerInternal(t,e,r,n,i)},t.prototype.openDesignerNewTab=function(t,e,r,n){this.openDesignerInternal(null,t,e,r,n)},t.prototype.openDesignerOnEleForRuntime=function(e,t,r,n,i,o,s){var a=this;this.printEntity.printFormat=new U,this.printEntity.isUseMetaData=!0,t&&0<t.length?this.formatSrv.getNewSourceFormatByFormatId(t).then(function(t){a.printEntity.printFormat=t,a.openDesignerOnEle(e,a.printEntity.printFormat.content,{},"","")}):this.initPrintFormat(o,s).then(function(t){a.printEntity.printFormat.id=W.uuid(),a.printEntity.printFormat.code=r,a.printEntity.printFormat.name=n,a.printEntity.printFormat.bizObjectId=i,a.printEntity.printFormat.dataSourceId=o,a.printEntity.printFormat.sourceType=s,a.printEntity.printFormat.isUseTemplate=!1,a.printEntity.printFormat.content=t.format,a.printEntity.printFormat.dataSchema=t.printschema,a.openDesignerOnEle(e,a.printEntity.printFormat.content,{},"","")})},t.prototype.openDesignerInternal=function(t,e,r,n,i){if(t)this.printEntity.format=e,this.printEntity.data=r,this.printEntity.foramtId=n,this.printEntity.dataId=i,this.createDesignerRef(),t.appendChild(this.getComponentRootNode(this.designercomponentRef));else{var o=new H;o.prnFormat=e,o.prnData=r,o.prnFormatId=n,o.prnDataId=i,o.prnType=z.Designer,this.appService.openAppByOptions({appType:"app",funcId:"",tabName:this.localpipe.transform("printdesigner"),appId:"cloudprint-view-index",appEntrance:"cloudprint-view-index",tabId:W.uuid(),entityParams:{foramtParam:o,formatEntity:null}})}},t.prototype.initPrintFormat=function(t,e){return e===_.BE?this.formatSrv.createPrintFormatWithBE(t):e===_.VO?this.formatSrv.createPrintFormatWithVO(t):this.formatSrv.createPrintFormatWithBO(t)},t.prototype.createDesignerRef=function(){var e=this,t=this.resolver.resolveComponentFactory(V);this.viewContainer?(this.viewContainer.clear(),this.designercomponentRef=this.viewContainer.createComponent(t)):(this.designercomponentRef=t.create(this.injector),this.applicationRef.attachView(this.designercomponentRef.hostView)),this.designercomponentRef.instance.setPrintEntity(this.printEntity),this.designercomponentRef.instance.printEntity.onExitEvent.subscribe(function(t){e.designercomponentRef.destroy(),e.viewContainer?e.viewContainer.clear():e.applicationRef.detachView(e.designercomponentRef.hostView)})},t.prototype.openRendedViewer=function(t,e,r,n,i,o,s){if(void 0===n&&(n=null),void 0===i&&(i=!1),void 0===o&&(o=null),void 0===s&&(s=null),null!=o)for(var a in o)this.printEntity[a]=o[a];e?this.preViewLocal(t,e,r,n,o,i,s):this.preViewRemote(t,r,n,i,o,s)},t.prototype.openRendedViewer4Attachment=function(t,e,r){this.openRendedViewer(t,e,r,null,!1,this.printEntity)},t.prototype.preViewLocal=function(i,t,o,s,e,a,r){void 0===s&&(s=null),void 0===e&&(e=null),void 0===r&&(r=null);var p=this,n=new Blob([t]),l=new FileReader;l.readAsArrayBuffer(n),l.onload=function(t){return I(this,void 0,void 0,function(){var e,r,n;return E(this,function(t){switch(t.label){case 0:return e=l.result,(r=new H).prnRendedFormat=btoa(new Uint8Array(e)),r.prnType=z.Viewer,r.prnOutputOps=Object.assign({},o),r.prnSourceOptions=s?B(s):[],r.isFilter=a,"tab"!==i?[3,1]:(p.appService.openAppByOptions({appType:"app",funcId:"",tabName:p.localpipe.transform("printview"),appId:"cloudprint-view-index",appEntrance:"cloudprint-view-index",tabId:W.uuid(),entityParams:{foramtParam:r,formatEntity:null}}),[3,3]);case 1:return[4,p.formatSrv.isRemotePrint()];case 2:n=t.sent(),p.createViewerRef(),p.printEntity.rendedFormat=e,p.viewercomponentRef.instance.outputParam=r,p.viewercomponentRef.instance.isRemotePrint=n,i.appendChild(p.getComponentRootNode(p.viewercomponentRef)),t.label=3;case 3:return[2]}})})}},t.prototype.preViewRemote=function(i,o,s,a,t,e){return void 0===s&&(s=null),void 0===t&&(t=null),void 0===e&&(e=null),I(this,void 0,void 0,function(){var e,r,n;return E(this,function(t){switch(t.label){case 0:return e=this,(r=new H).prnType=z.Viewer,r.prnOutputOps=Object.assign({},o),r.prnSourceOptions=B(s),r.isFilter=a,"tab"!==i?[3,1]:(e.appService.openAppByOptions({appType:"app",funcId:"",tabName:e.localpipe.transform("printview"),appId:"cloudprint-view-index",appEntrance:"cloudprint-view-index",tabId:W.uuid(),entityParams:{foramtParam:r,formatEntity:null}}),[3,3]);case 1:return[4,e.formatSrv.isRemotePrint()];case 2:n=t.sent(),e.createViewerRef(),e.viewercomponentRef.instance.outputParam=r,e.viewercomponentRef.instance.isRemotePrint=n,i.appendChild(e.getComponentRootNode(e.viewercomponentRef)),t.label=3;case 3:return[2]}})})},t.prototype.createViewerRef=function(){var e=this,t=this.resolver.resolveComponentFactory(q);this.viewContainer?(this.viewContainer.clear(),this.viewercomponentRef=this.viewContainer.createComponent(t)):(this.viewercomponentRef=t.create(this.injector),this.applicationRef.attachView(this.viewercomponentRef.hostView)),this.viewercomponentRef.instance.setPrintEntity(this.printEntity),this.viewercomponentRef.instance.localpipe=this.localpipe,this.viewercomponentRef.instance.printEntity.onExitEvent.subscribe(function(t){e.viewercomponentRef.destroy(),e.viewContainer?e.viewContainer.clear():e.applicationRef.detachView(e.viewercomponentRef.hostView)})},t.prototype.getComponentRootNode=function(t){return t.hostView.rootNodes[0]},t.prototype.printSingleById=function(t,e,r,n,i){if(void 0===n&&(n=null),void 0===i&&(i=null),0!=L.checkAppUrl(this.printEntity.appUrl)){if(t.queryType==undefined&&(t.queryType=Z),e.printType==undefined&&(e.printType=Y.Form),t.FormatId==undefined||""==t.FormatId)return this.openFormatListByDimension(t,e,r,!1);if(!r)return this.formatSrv.printSingleById(t,e,n,"CloudPrint");var o=this;if("download"===r)return this.formatSrv.printSingleById(t,e,n,"CloudPrint").then(function(t){o.downloadFile(t)});o.openRendedViewer(r,null,e,[t],!1)}else this.notifyService.info(this.localpipe.transform("appurlerror"))},t.prototype.printSingleByFilter=function(t,e,r,n,i){if(void 0===n&&(n=null),void 0===i&&(i=null),0!=L.checkAppUrl(this.printEntity.appUrl)){if(t.queryType==undefined&&(t.queryType=Z),e.printType==undefined&&(e.printType=Y.Form),t.FormatId==undefined||""==t.FormatId)return this.openFormatListByDimension(t,e,r,!0);if(!r)return this.formatSrv.printSingleByFilter(t,e,n,"CloudPrint");var o=this;if("download"===r)return this.formatSrv.printSingleByFilter(t,e,n,"CloudPrint").then(function(t){o.downloadFile(t)});o.openRendedViewer(r,null,e,[t],!0)}else this.notifyService.info(this.localpipe.transform("appurlerror"))},t.prototype.printMultiById=function(t,e,r,n,i){var o=this;void 0===n&&(n=null),void 0===i&&(i=null);for(var s=0;s<t.length;s++)L.checkForNullReference(t[s].queryType,"queryType");if(L.checkForNullReference(e.printType,"printType"),0!=L.checkAppUrl(this.printEntity.appUrl)){if(!r)return this.formatSrv.printMultiById(t,e,n,"CloudPrint");if("download"===r)return this.formatSrv.printMultiById(t,e,n,"CloudPrint").then(function(t){o.downloadFile(t)});this.openRendedViewer(r,null,e,t,!1)}else this.notifyService.info(this.localpipe.transform("appurlerror"))},t.prototype.printMultiByFilter=function(t,e,r,n,i){var o=this;void 0===n&&(n=null),void 0===i&&(i=null);for(var s=0;s<t.length;s++)L.checkForNullReference(t[s].queryType,"queryType");if(L.checkForNullReference(e.printType,"printType"),0!=L.checkAppUrl(this.printEntity.appUrl)){if(!r)return this.formatSrv.printMultiByFilter(t,e,n,"CloudPrint");if("download"===r)return this.formatSrv.printMultiByFilter(t,e,n,"CloudPrint").then(function(t){o.downloadFile(t)});this.openRendedViewer(r,null,e,t,!0)}else this.notifyService.info(this.localpipe.transform("appurlerror"))},t.prototype.printSingleById4Job=function(t,e,r,n){if(void 0===r&&(r=null),void 0===n&&(n=null),0!=L.checkAppUrl(this.printEntity.appUrl))return t.queryType==undefined&&(t.queryType=Z),e.printType==undefined&&(e.printType=Y.Form),this.openFormatListByDimension4Job([t],e,!1,!1);this.notifyService.info(this.localpipe.transform("appurlerror"))},t.prototype.printSingleByFilter4Job=function(t,e,r,n){if(void 0===r&&(r=null),void 0===n&&(n=null),0!=L.checkAppUrl(this.printEntity.appUrl))return t.queryType==undefined&&(t.queryType=Z),e.printType==undefined&&(e.printType=Y.Form),this.openFormatListByDimension4Job([t],e,!0,!1);this.notifyService.info(this.localpipe.transform("appurlerror"))},t.prototype.printMultiById4Job=function(t,e,r,n){for(var i in void 0===r&&(r=null),void 0===n&&(n=null),t)L.checkForNullReference(t[0].queryType,"queryType");if(L.checkForNullReference(e.printType,"printType"),0!=L.checkAppUrl(this.printEntity.appUrl))return this.openFormatListByDimension4Job(t,e,!1,!0);this.notifyService.info(this.localpipe.transform("appurlerror"))},t.prototype.printMultiByFilter4Job=function(t,e,r,n){for(var i in void 0===r&&(r=null),void 0===n&&(n=null),t)L.checkForNullReference(t[0].queryType,"queryType");if(L.checkForNullReference(e.printType,"printType"),0!=L.checkAppUrl(this.printEntity.appUrl))return this.openFormatListByDimension4Job(t,e,!0,!0);this.notifyService.info(this.localpipe.transform("appurlerror"))},t.prototype.downloadFile=function(t){var e=document.createElement("a"),r=new Blob([t],{type:"application/pdf;charset=UTF-8"});e.setAttribute("href",window.URL.createObjectURL(r)),e.setAttribute("download",this.printEntity.downLoadFileName+".pdf"),e.style.visibility="hidden",document.body.appendChild(e),e.click(),document.body.removeChild(e)},t.prototype.outputBEData=function(t,e,r){return this.printSingleById(t,e,r)},t.prototype.outputBEDataWithFilter=function(t,e,r){return this.printSingleByFilter(t,e,r)},t.decorators=[{type:v.Injectable}],t.ctorParameters=function(){return[{type:k},{type:v.ComponentFactoryResolver},{type:G},{type:J},{type:v.Injector},{type:v.ApplicationRef},{type:b.NotifyService},{type:S.AppService},{type:g.WindowService},{type:F.BsModalService}]},t}(),it=localStorage.getItem("languageCode")||"zh-CHS",ot=function(){function t(){}return t.decorators=[{type:v.NgModule,args:[{imports:[e.CommonModule,w.HttpClientModule,b.NotifyModule,g.WindowModule,r.FormsModule,n.GridModule,g.DialogModule,o.LoadingModule,o.LoadingModule.forRoot(),d.FarrisDialogModule,a.FarrisButtonModule,l.SplitterModule,p.DatagridModule,u.AngularDraggableModule,c.FarrisSectionModule,F.ModalModule.forRoot(),m.NumberSpinnerModule,f.ComboListModule,h.FarrisFormsModule,y.FResponseToolbarModule],declarations:[V,q,Q,tt,rt],entryComponents:[V,q,b.NotifyContainerComponent,Q,tt],providers:[G,J,nt,b.NotifyService,x,S.AppService,k,i.LanguageService,o.LoadingService,{provide:v.LOCALE_ID,useValue:it}]}]}],t}(),st=function It(){this.includeChildData=!0},at=function(e){function t(){var t=e.call(this)||this;return t.queryType=Z,t}return C(t,e),t}(st),pt=function(e){function t(){var t=e.call(this)||this;return t.queryType=Z,t}return C(t,e),t}(st),lt=function Et(){},ct=function Dt(){},ut=function Bt(){},dt={CurrentData:0,TransactionalBuffer:1,Original:2};dt[dt.CurrentData]="CurrentData",dt[dt.TransactionalBuffer]="TransactionalBuffer",dt[dt.Original]="Original";var mt={Asc:0,Desc:1};mt[mt.Asc]="Asc",mt[mt.Desc]="Desc";var ft={None:"None",Pdf:"Pdf",Html5:"Html5"},ht=function Tt(){this.printJob=!1,this.printerName="",this.printSetting=new X,this.FileType=ft.Pdf,this.printType=Y.Form},yt=function(){function t(t,e,r,n,i,o,s,a){this.formatSrv=t,this.resolver=e,this.injector=r,this.applicationRef=n,this.notifyService=i,this.appService=o,this.windowService=s,this.modalService=a,this.printEntity=new T,this.printEntity.appUrl=j.CloudPrintBaseUrl,this.printEntity.isUseMetaData=!0,this.printEntity.language=localStorage.getItem("languageCode")||"zh-CHS",this.formatSrv.printEntity=this.printEntity}return Object.defineProperty(t.prototype,"setPrintEntity",{set:function(t){this.printEntity=t,this.formatSrv.printEntity=this.printEntity},enumerable:!0,configurable:!0}),t.prototype.createPrintFormatWithBE=function(t){return this.formatSrv.createPrintFormatWithBE(t)},t.prototype.createPrintFormatWithVO=function(t){return this.formatSrv.createPrintFormatWithVO(t)},t.prototype.getPrintFormatByDataSrouceId=function(t){return this.formatSrv.getFormatBySourceId(t)},t.prototype.getPrintFormatByDataSrouceAndDimension=function(t,e,r,n){return this.formatSrv.getPrintFormatByDataSrouceAndDimension(t,e,r,n)},t.prototype.getDataSourceByBOId=function(t){return this.formatSrv.getDataSourceByBOId(t)},t.prototype.getFormatByFormatId=function(t){return this.formatSrv.getFormatByFormatId(t)},t.prototype.getNewSourceFormatByFormatId=function(t){return this.formatSrv.getNewSourceFormatByFormatId(t)},t.prototype.getNewSourceFormatByFormatIdAndLang=function(t,e){return this.formatSrv.getNewSourceFormatByFormatIdAndLang(t,e)},t.prototype.save=function(t){return this.formatSrv.save(t)},t.prototype.saveWithRes=function(t){return this.formatSrv.saveWithRes(t)},t.prototype.remove=function(t){return this.formatSrv.remove(t)},t.prototype.getFormatById=function(t){if(0!=L.checkAppUrl(this.printEntity.appUrl))return this.formatSrv.loadFormat(t,"CloudPrint");this.notifyService.info("未配置正确的appUrl")},t.decorators=[{type:v.Injectable}],t.ctorParameters=function(){return[{type:k},{type:v.ComponentFactoryResolver},{type:v.Injector},{type:v.ApplicationRef},{type:b.NotifyService},{type:S.AppService},{type:g.WindowService},{type:F.BsModalService}]},t}(),gt=function(){function t(t,e,r,n,i,o,s,a){this.formatSrv=t,this.resolver=e,this.injector=r,this.applicationRef=n,this.notifyService=i,this.appService=o,this.modalService=s,this.httpClient=a,this.printEntity=new T,this.printEntity.appUrl=j.CloudPrintBaseUrl,this.printEntity.isUseMetaData=!0,this.printEntity.language=localStorage.getItem("languageCode")||"zh-CHS",this.formatSrv.printEntity=this.printEntity,this.injector&&(this.modalService=this.injector.get(F.BsModalService),this.localeid=localStorage.getItem("languageCode")||this.injector.get(v.LOCALE_ID),this.localpipe=new rt(this.localeid))}return Object.defineProperty(t.prototype,"setPrintEntity",{set:function(t){this.printEntity=t,this.formatSrv.printEntity=this.printEntity},enumerable:!0,configurable:!0}),t.prototype.printAttachment=function(s,a,t,e){return void 0===t&&(t=null),void 0===e&&(e=null),I(this,void 0,void 0,function(){var i,o=this;return E(this,function(t){return 0==L.checkAppUrl(this.printEntity.appUrl)?(this.notifyService.info(this.localpipe.transform("appurlerror")),[2]):(s.queryType==undefined&&(s.queryType=Z),a.printType==undefined&&(a.printType=Y.Attachment),[2,(i=this).formatSrv.getPrintDevice().then(function(t){var e=t||[],r=i.resolver.resolveComponentFactory(tt).create(i.injector);r.instance.boxlist=e,r.instance.formatId="",r.instance.isShowFormat=!1,r.instance.printType=1,r.instance.localepip=i.localpipe;var n=o.modalService.show(r,{title:o.localpipe.transform("printset"),width:800,height:500,showButtons:!0,showMaxButton:!1,buttons:[{text:o.localpipe.transform("print"),cls:"btn btn-primary",handle:function(){r.instance.printJob()}},{text:o.localpipe.transform("cancel"),cls:"btn btn-secondary",handle:function(){n.close()}}]});r.instance.print.subscribe(function(e){return I(o,void 0,void 0,function(){return E(this,function(t){switch(t.label){case 0:return n.close(),a.printSetting=e.printSetting,a.printerName=e.printter,a.DeviceId=e.boxId,a.printJob=!0,[4,this.printAttachmentJob(s,a)];case 1:return[2,t.sent()]}})})})})])})})},t.prototype.printAttachmentJob=function(o,s){return I(this,void 0,void 0,function(){var e,r,n,i=this;return E(this,function(t){switch(t.label){case 0:return e=this.printEntity.appUrl+j.PrintAttachment+"su="+M.PRINT_SU,(r={}).headers={SessionId:this.printEntity.sessionId||"","Content-Type":"application/json"},n={attachmentOptions:o,options:s},[4,this.httpClient.post(e,n,r).toPromise().then(function(){return i.notifyService.info(i.localpipe.transform("sendprintjob")),i.localpipe.transform("sendprintjob")})["catch"](function(t){return i.notifyService.warning(t.error.Message),t.error.Message})];case 1:return[2,t.sent()]}})})},t.decorators=[{type:v.Injectable}],t.ctorParameters=function(){return[{type:k},{type:v.ComponentFactoryResolver},{type:v.Injector},{type:v.ApplicationRef},{type:b.NotifyService},{type:S.AppService},{type:F.BsModalService},{type:w.HttpClient}]},t}();t.CloudprintService=nt,t.ɵa=k,t.CloudPrintModule=ot,t.CmpType=z,t.SourceType=_,t.PrintEntity=T,t.PrintFormat=U,t.SourceFilterOptions=at,t.SourceOptions=pt,t.RetrieveParam=lt,t.NodeSortInfos=ct,t.SortConditions=ut,t.RequestedBufferType=dt,t.SortType=mt,t.Utils=W,t.OutputOptions=ht,t.OutputParam=H,t.FileType=ft,t.OutputType={None:"None",PRINT:"PRINT",EXPORT:"EXPORT"},t.PrintType=Y,t.Config=M,t.PaperKind=$,t.PrintSetting=X,t.CloudprintInternalService=yt,t.CloudPrintAttachmentService=gt,t.ɵd=V,t.ɵb=G,t.ɵg=Q,t.ɵh=tt,t.ɵf=q,t.ɵc=J,t.ɵj=st,t.ɵe=x,t.ɵi=rt,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=gsp-svc-cloudprint.umd.min.js.map