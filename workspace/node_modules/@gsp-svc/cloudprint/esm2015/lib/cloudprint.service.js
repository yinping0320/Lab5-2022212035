/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
import { Injectable, Injector, ApplicationRef, LOCALE_ID } from '@angular/core';
import { ComponentFactoryResolver } from '@angular/core';
import { CloudprintDesignerComponent } from './cloudprint-designer/cloudprint-designer.component';
import { CloudprintViewerComponent } from './cloudprint-viewer/cloudprint-viewer.component';
import { PrintEntity } from './entitys/printEntity';
import { NotifyService } from '@farris/ui-notify';
import { Urls } from './utils/cloudprint.Urls';
import { AppService } from '@gsp-sys/rtf-common';
import { CmpType } from './entitys/enums/cmpType';
import { OutputParam } from './entitys/outputoptions/outputParam';
import { PrintFormatService } from './services/printFormatService';
import { SourceType } from './entitys/enums/sourceType';
import { PrintFormat } from './entitys/printFormat';
import { WindowService } from '@progress/kendo-angular-dialog';
import { FormatlistComponent } from './cloudprint-formatlist/formatlist.component';
import { Utils } from './utils/cloudprint.utils';
import { CloudprintdesignerService } from './cloudprint-designer/cloudprint-designer.service';
import { CloudprintviewerService } from './cloudprint-viewer/cloudprint-viewer.service';
import { QueryType } from './entitys/enums/querytype';
import { PrintType } from './entitys/enums/printtype';
import { DataValidator } from './utils/cloudprint.datavalidator';
import { FormatlistjobComponent } from './cloudprint-formatlistjob/formatlistjob.component';
import { BsModalService } from '@farris/ui-modal';
import { LocalLangPipe } from './local.pipe';
export class CloudprintService {
    /**
     * @param {?} formatSrv
     * @param {?} resolver
     * @param {?} designerSrv
     * @param {?} viewerSrv
     * @param {?} injector
     * @param {?} applicationRef
     * @param {?} notifyService
     * @param {?} appService
     * @param {?} windowService
     * @param {?} modalService
     */
    constructor(formatSrv, resolver, designerSrv, viewerSrv, injector, applicationRef, notifyService, appService, windowService, modalService) {
        this.formatSrv = formatSrv;
        this.resolver = resolver;
        this.designerSrv = designerSrv;
        this.viewerSrv = viewerSrv;
        this.injector = injector;
        this.applicationRef = applicationRef;
        this.notifyService = notifyService;
        this.appService = appService;
        this.windowService = windowService;
        this.modalService = modalService;
        /**
         * 打印参数实体
         */
        this.printEntity = new PrintEntity();
        //#region 格式选择列表相关接口
        this.windowRef = undefined;
        // 设置printEntity的默认值
        this.printEntity.appUrl = Urls.CloudPrintBaseUrl;
        this.printEntity.isUseMetaData = true;
        this.printEntity.language = localStorage.getItem("languageCode") || 'zh-CHS';
        // 将printEntity设置到designer service上（不设置，后面调用服务会发现服务的printEntity是空的）
        // this.designerSrv.printEntity = this.printEntity;
        // 将printEntity设置到viewer service上（不设置，后面调用服务会发现服务的printEntity是空的）
        // this.viewerSrv.printEntity = this.printEntity;
        this.formatSrv.printEntity = this.printEntity;
        if (this.injector) {
            this.modalService = this.injector.get(BsModalService);
            this.localeid = localStorage.getItem("languageCode") || this.injector.get(LOCALE_ID);
            this.localpipe = new LocalLangPipe(this.localeid);
        }
    }
    /**
     * 设置PrintEntity参数
     * \@description 如果外界new新的PrintEntity，则需要调用该方法同步service的entity
     *              外界没有new新的PrintEntity，则不需要调用该方法
     * @param {?} entity
     * @return {?}
     */
    set setPrintEntity(entity) {
        this.printEntity = entity;
        // this.designerSrv.printEntity = this.printEntity;
        // this.viewerSrv.printEntity = this.printEntity;
        this.formatSrv.printEntity = this.printEntity;
    }
    /**
     * 运行时打印时根据维度过滤弹出打印格式选择列表
     * @private
     * @param {?} beOptions beOptions
     * @param {?} options 输出options
     * @param {?} ele 指定的element元素
     * @param {?} filter 是否过滤条件
     * @return {?}
     */
    openFormatListByDimension(beOptions, options, ele, filter) {
        /** @type {?} */
        const that = this;
        /** @type {?} */
        const dataSourceId = beOptions.SourceId;
        /** @type {?} */
        const billCategoryId = beOptions.billCategoryId;
        return this.formatSrv.getPrintFormatByDataSrouceAndDimension(billCategoryId, dataSourceId, ((/** @type {?} */ (beOptions))).FirstDimensionVal, ((/** @type {?} */ (beOptions))).SecondDimensionVal).then((/**
         * @param {?} res
         * @return {?}
         */
        (res) => {
            /** @type {?} */
            const format = (res != null && res.length != undefined) ? res : [];
            //只有一条打印格式，直接输出预览
            if (format.length === 1) {
                return that.outputBySingleSelectionFormat({
                    'id': format[0].id,
                    'isFilter': filter,
                    'beoptions': Object.assign({}, beOptions),
                    'options': options,
                    'isJob': false,
                    'printerName': '',
                    'boxId': '',
                    'printSetting': null,
                    'ele': ele
                });
            }
            /** @type {?} */
            const factory = that.resolver.resolveComponentFactory(FormatlistComponent);
            /** @type {?} */
            const printsetting = factory.create(that.injector);
            printsetting.instance.formats = [...format];
            printsetting.instance.localepip = that.localpipe;
            /** @type {?} */
            const dlg = this.modalService.show(printsetting, {
                title: this.localpipe.transform('printformat'),
                width: 400,
                height: 500,
                showButtons: true,
                showMaxButton: false,
                buttons: [
                    { text: this.localpipe.transform('print'), cls: 'btn btn-primary', handle: (/**
                         * @return {?}
                         */
                        () => {
                            printsetting.instance.printJob();
                        }) },
                    { text: this.localpipe.transform('cancel'), cls: 'btn btn-secondary', handle: (/**
                         * @return {?}
                         */
                        () => {
                            dlg.close();
                        }) }
                ],
            });
            // printsetting.instance.dlg = dlg;
            //订阅了弹出的格式选择列表的关闭事件
            printsetting.instance.print.subscribe((/**
             * @param {?} data
             * @return {?}
             */
            (data) => {
                dlg.close();
                return that.outputBySingleSelectionFormat({
                    'id': data.id,
                    'isFilter': filter,
                    'beoptions': Object.assign({}, beOptions),
                    'options': options,
                    'isJob': false,
                    'printerName': '',
                    'boxId': '',
                    'printSetting': null,
                    'ele': ele
                });
            }));
        }));
    }
    /**
     * 后台打印任务的格式选择和打印配置列表
     * @private
     * @param {?} beOptions
     * @param {?} options
     * @param {?} filter
     * @param {?} isMulti
     * @return {?}
     */
    openFormatListByDimension4Job(beOptions, options, filter, isMulti) {
        /** @type {?} */
        const that = this;
        if (isMulti) { //批量打印
            return this.formatSrv.getPrintDevice().then((/**
             * @param {?} data
             * @return {?}
             */
            (data) => {
                /** @type {?} */
                const device = data || [];
                /** @type {?} */
                let ids = '';
                beOptions.forEach((/**
                 * @param {?} x
                 * @return {?}
                 */
                x => ids += x.FormatId + ','));
                /** @type {?} */
                const factory = that.resolver.resolveComponentFactory(FormatlistjobComponent);
                /** @type {?} */
                const printsetting = factory.create(that.injector);
                printsetting.instance.boxlist = device;
                printsetting.instance.formatId = ids.length > 0 ? ids.substr(0, ids.length - 1) : ids;
                printsetting.instance.isShowFormat = false;
                printsetting.instance.localepip = that.localpipe;
                /** @type {?} */
                const dlg = this.modalService.show(printsetting, {
                    title: this.localpipe.transform('printset'),
                    width: 800,
                    height: 500,
                    showButtons: true,
                    showMaxButton: false,
                    buttons: [
                        { text: this.localpipe.transform('print'), cls: 'btn btn-primary', handle: (/**
                             * @return {?}
                             */
                            () => {
                                printsetting.instance.printJob();
                            }) },
                        { text: this.localpipe.transform('cancel'), cls: 'btn btn-secondary', handle: (/**
                             * @return {?}
                             */
                            () => {
                                dlg.close();
                            }) }
                    ],
                });
                //订阅了弹出的格式选择列表的关闭事件
                printsetting.instance.print.subscribe((/**
                 * @param {?} data
                 * @return {?}
                 */
                (data) => {
                    dlg.close();
                    return that.outputByMultiSelectionFormat({
                        'isFilter': filter,
                        'beoptions': [...beOptions],
                        'options': Object.assign({}, options),
                        'isJob': true,
                        'printerName': data.printter,
                        'boxId': data.boxId,
                        'printSetting': data.printSetting,
                        'ele': null
                    });
                }));
            }));
        }
        else {
            /** @type {?} */
            const billCategoryId = beOptions[0].billCategoryId;
            /** @type {?} */
            const dataSourceId = beOptions[0].SourceId;
            return this.formatSrv.getPrintFormatAndDevice(billCategoryId, dataSourceId, ((/** @type {?} */ (beOptions))).FirstDimensionVal, ((/** @type {?} */ (beOptions))).SecondDimensionVal).then((/**
             * @param {?} res
             * @return {?}
             */
            (res) => {
                /** @type {?} */
                const format = res.format || [];
                /** @type {?} */
                const device = res.device || [];
                //只有一条打印格式，则不用再选择格式
                if (format.length === 1) {
                    beOptions[0].FormatId = format[0].id;
                }
                /** @type {?} */
                const factory = that.resolver.resolveComponentFactory(FormatlistjobComponent);
                /** @type {?} */
                const printsetting = factory.create(that.injector);
                printsetting.instance.formats = format;
                printsetting.instance.boxlist = device;
                printsetting.instance.formatId = beOptions[0].FormatId;
                printsetting.instance.isShowFormat = beOptions[0].FormatId ? false : true;
                printsetting.instance.localepip = that.localpipe;
                /** @type {?} */
                const dlg = this.modalService.show(printsetting, {
                    title: this.localpipe.transform('printset'),
                    width: 800,
                    height: 500,
                    showButtons: true,
                    showMaxButton: false,
                    buttons: [
                        { text: this.localpipe.transform('print'), cls: 'btn btn-primary', handle: (/**
                             * @return {?}
                             */
                            () => {
                                printsetting.instance.printJob();
                            }) },
                        { text: this.localpipe.transform('cancel'), cls: 'btn btn-secondary', handle: (/**
                             * @return {?}
                             */
                            () => {
                                dlg.close();
                            }) }
                    ],
                });
                //订阅了弹出的格式选择列表的关闭事件
                printsetting.instance.print.subscribe((/**
                 * @param {?} data
                 * @return {?}
                 */
                (data) => {
                    dlg.close();
                    return that.outputBySingleSelectionFormat({
                        'id': data.id,
                        'isFilter': filter,
                        'beoptions': Object.assign({}, beOptions[0]),
                        'options': Object.assign({}, options),
                        'isJob': true,
                        'printerName': data.printter,
                        'boxId': data.boxId,
                        'printSetting': data.printSetting,
                        'ele': null
                    });
                }));
            }));
        }
    }
    // 选了格式后的输出
    /**
     * @private
     * @param {?} res
     * @return {?}
     */
    outputBySingleSelectionFormat(res) {
        console.log('选完格式准备渲染: ' + JSON.stringify(res));
        /** @type {?} */
        const self = this;
        if (!res.id) {
            return;
        }
        res.beoptions.FormatId = res.id;
        res.options.DeviceId = res.boxId;
        res.options.printerName = res.printerName;
        res.options.printSetting = res.printSetting;
        res.options.printJob = res.isJob;
        if (res.isJob) { //后台打印
            if (res.isFilter === true) {
                return this.formatSrv.printSingleByFilter(res.beoptions, res.options, res.su, 'CloudPrint')
                    .then((/**
                 * @return {?}
                 */
                () => {
                    self.notifyService.success(this.localpipe.transform('sendprintjob'));
                }));
            }
            else {
                return this.formatSrv.printSingleById(res.beoptions, res.options, res.su, 'CloudPrint')
                    .then((/**
                 * @return {?}
                 */
                () => {
                    self.notifyService.success(this.localpipe.transform('sendprintjob'));
                }));
            }
        }
        else { //前台打印
            if (res.ele) { //有ele，则引擎负责渲染
                if (res.isFilter === true) {
                    if (res.ele === 'download') {
                        return this.formatSrv.printSingleByFilter(res.beoptions, res.options, res.su, 'CloudPrint')
                            .then((/**
                         * @param {?} data
                         * @return {?}
                         */
                        (data) => {
                            self.downloadFile(data);
                        }));
                    }
                    else {
                        self.openRendedViewer(res.ele, null, res.options, [res.beoptions], res.isFilter);
                    }
                }
                else {
                    if (res.ele === 'download') {
                        return this.formatSrv.printSingleById(res.beoptions, res.options, res.su, 'CloudPrint')
                            .then((/**
                         * @param {?} data
                         * @return {?}
                         */
                        (data) => {
                            self.downloadFile(data);
                        }));
                    }
                    else {
                        self.openRendedViewer(res.ele, null, res.options, [res.beoptions], res.isFilter);
                    }
                }
            }
            else { //没有ele，则只返回后台的渲染结果，给调用方自己处理
                if (res.filter === true) {
                    return this.formatSrv.printSingleByFilter(res.beoptions, res.options, res.su, 'CloudPrint');
                }
                else {
                    return this.formatSrv.printSingleById(res.beoptions, res.options, res.su, 'CloudPrint');
                }
            }
        }
    }
    /**
     * @private
     * @param {?} res
     * @return {?}
     */
    outputByMultiSelectionFormat(res) {
        console.log('选完格式准备渲染: ' + JSON.stringify(res));
        /** @type {?} */
        const self = this;
        res.options.DeviceId = res.boxId;
        res.options.printerName = res.printerName;
        res.options.printSetting = res.printSetting;
        res.options.printJob = res.isJob;
        if (res.isJob) { //后台打印
            if (res.isFilter === true) {
                return this.formatSrv.printMultiByFilter(res.beoptions, res.options, res.su, 'CloudPrint')
                    .then((/**
                 * @return {?}
                 */
                () => {
                    self.notifyService.success(this.localpipe.transform('sendprintjob'));
                }));
            }
            else {
                return this.formatSrv.printMultiById(res.beoptions, res.options, res.su, 'CloudPrint')
                    .then((/**
                 * @return {?}
                 */
                () => {
                    self.notifyService.success(this.localpipe.transform('sendprintjob'));
                }));
            }
        }
    }
    //#endregion
    //#region 对外设计器和预览器接口
    /**
     * 在当前页面Body上打开Designer
     * @param {?} format 格式
     * @param {?} data 数据
     * @param {?} formatId 格式id
     * @param {?} dataIds 数据ids
     * @return {?}
     */
    openDesigner(format, data, formatId, dataIds) {
        this.openDesignerInternal(window.document.body, format, data, formatId, dataIds);
    }
    /**
     * 在当前页面的指定的元素上打开Designer
     * @param {?} ele 指定的元素
     * @param {?} format 格式
     * @param {?} data 数据
     * @param {?} formatId 格式id
     * @param {?} dataIds 数据ids
     * @return {?}
     */
    openDesignerOnEle(ele, format, data, formatId, dataIds) {
        this.openDesignerInternal(ele, format, data, formatId, dataIds);
    }
    /**
     * 在新的tab页面上打开Designer
     * @param {?} format 格式
     * @param {?} data 数据
     * @param {?} formatId 格式id
     * @param {?} dataIds 数据ids
     * @return {?}
     */
    openDesignerNewTab(format, data, formatId, dataIds) {
        this.openDesignerInternal(null, format, data, formatId, dataIds);
    }
    /**
     * 运行时在当前页面的指定的元素上打开Designer
     * @param {?} ele 指定的元素
     * @param {?} formatId
     * @param {?} formatCode 格式编号
     * @param {?} formatName 格式名称
     * @param {?} bizObjectId 业务对象Id
     * @param {?} datasourceId 数据源Id, BEId/VOId/BesinessObjectClassInfo
     * @param {?} sourceType 数据源类型, SourceType.BE/SourceType.VO/SourceType.BO
     * @return {?}
     */
    openDesignerOnEleForRuntime(ele, formatId, formatCode, formatName, bizObjectId, datasourceId, sourceType) {
        this.printEntity.printFormat = new PrintFormat();
        this.printEntity.isUseMetaData = true;
        if (formatId && formatId.length > 0) {
            // 编辑
            this.formatSrv.getNewSourceFormatByFormatId(formatId)
                .then((/**
             * @param {?} res
             * @return {?}
             */
            (res) => {
                this.printEntity.printFormat = res;
                //打开设计器
                this.openDesignerOnEle(ele, this.printEntity.printFormat.content, {}, '', '');
            }));
        }
        else {
            //初始化
            this.initPrintFormat(datasourceId, sourceType)
                .then((/**
             * @param {?} res
             * @return {?}
             */
            (res) => {
                this.printEntity.printFormat.id = Utils.uuid();
                this.printEntity.printFormat.code = formatCode;
                this.printEntity.printFormat.name = formatName;
                this.printEntity.printFormat.bizObjectId = bizObjectId;
                this.printEntity.printFormat.dataSourceId = datasourceId;
                this.printEntity.printFormat.sourceType = sourceType;
                this.printEntity.printFormat.isUseTemplate = false;
                this.printEntity.printFormat.content = res.format; //打印格式mrt   
                this.printEntity.printFormat.dataSchema = res.printschema; //PrintDataSchemaView描述   
                //打开设计器
                this.openDesignerOnEle(ele, this.printEntity.printFormat.content, {}, '', '');
            }));
        }
    }
    /**
     * 在指定的元素上打开Designer(前端渲染)
     * @private
     * @param {?} ele 指定的元素
     * @param {?} format 格式
     * @param {?} data 数据
     * @param {?} formatId 格式id
     * @param {?} dataIds 数据ids
     * @return {?}
     */
    openDesignerInternal(ele, format, data, formatId, dataIds) {
        if (ele) {
            this.printEntity.format = format;
            this.printEntity.data = data;
            this.printEntity.foramtId = formatId;
            this.printEntity.dataId = dataIds;
            this.createDesignerRef();
            // 给视图添加脏检查(这个方式是配合@ViewChild的方法使用的)
            // this.applicationRef.attachView(this.designercomponentRef.hostView);
            // 将创建好的组件引用append到指定标签下
            // 这里将动态组件加载到指定的html里有两种方式：
            //  1.上面的@ViewChil
            //  2.如下的ele.appendChild(this.getComponentRootNode(this.viewercomponentRef));方式
            ele.appendChild(this.getComponentRootNode(this.designercomponentRef));
        }
        else {
            /** @type {?} */
            const param = new OutputParam();
            param.prnFormat = format;
            param.prnData = data;
            param.prnFormatId = formatId;
            param.prnDataId = dataIds;
            param.prnType = CmpType.Designer;
            this.appService.openAppByOptions({
                appType: 'app',
                funcId: '',
                tabName: this.localpipe.transform('printdesigner'),
                appId: 'cloudprint-view-index',
                appEntrance: 'cloudprint-view-index',
                tabId: Utils.uuid(),
                entityParams: {
                    foramtParam: param,
                    formatEntity: null,
                },
            });
        }
    }
    /**
     * 获取空白打印格式
     * @private
     * @param {?} datasourceId
     * @param {?} sourceType
     * @return {?}
     */
    initPrintFormat(datasourceId, sourceType) {
        if (sourceType === SourceType.BE) {
            //bo数据源
            return this.formatSrv.createPrintFormatWithBE(datasourceId);
        }
        else if (sourceType === SourceType.VO) {
            // vo数据源
            return this.formatSrv.createPrintFormatWithVO(datasourceId);
        }
        else {
            // 默认用BE数据源
            return this.formatSrv.createPrintFormatWithBO(datasourceId);
        }
    }
    /**
     * 创建Designer构件的引用对象
     * @private
     * @return {?}
     */
    createDesignerRef() {
        /** @type {?} */
        const factory = this.resolver.resolveComponentFactory(CloudprintDesignerComponent);
        if (!this.viewContainer) {
            this.designercomponentRef = factory.create(this.injector);
            this.applicationRef.attachView(this.designercomponentRef.hostView);
        }
        else {
            this.viewContainer.clear();
            this.designercomponentRef = this.viewContainer.createComponent(factory);
        }
        // 同步组件和组件上依赖的服务的printEntity
        this.designercomponentRef.instance.setPrintEntity(this.printEntity);
        // this.designercomponentRef.instance.localeid = this.localeid;
        // 订阅退出事件
        this.designercomponentRef.instance.printEntity.onExitEvent.subscribe((/**
         * @param {?} e
         * @return {?}
         */
        (e) => {
            this.designercomponentRef.destroy();
            if (!this.viewContainer) {
                this.applicationRef.detachView(this.designercomponentRef.hostView);
            }
            else {
                this.viewContainer.clear();
            }
        }));
    }
    /**
     * 打开已经渲染的Viewer（后端渲染）
     * @param {?} ele 指定的元素
     * @param {?} data 已经渲染的格式(后端渲染是pdf的二进制流)
     * @param {?} options
     * @param {?=} sourceOptions
     * @param {?=} isFilter
     * @param {?=} printEntity
     * @param {?=} param
     * @return {?}
     */
    openRendedViewer(ele, data, options, sourceOptions = null, isFilter = false, printEntity = null, param = null) {
        if (printEntity != null) { //用外界的printEntity属性覆盖当前的printEntity的属性
            // tslint:disable-next-line:forin
            for (const key in printEntity) {
                this.printEntity[key] = printEntity[key];
            }
        }
        if (data) { //数据已渲染，直接打印，不存在后台打印了
            this.preViewLocal(ele, data, options, sourceOptions, printEntity, isFilter, param);
        }
        else {
            this.preViewRemote(ele, options, sourceOptions, isFilter, printEntity, param);
        }
    }
    /**
     * 打开已经渲染的Viewer（后端渲染,给附件用的）
     * @param {?} ele 指定的元素
     * @param {?} data 已经渲染的格式(后端渲染是pdf的二进制流)
     * @param {?} options
     * @return {?}
     */
    openRendedViewer4Attachment(ele, data, options) {
        this.openRendedViewer(ele, data, options, null, false, this.printEntity);
    }
    /**
     * 本地直接打印
     * @private
     * @param {?} ele
     * @param {?} data
     * @param {?} options
     * @param {?=} sourceOptions
     * @param {?=} printEntity
     * @param {?=} isFilter
     * @param {?=} param
     * @return {?}
     */
    preViewLocal(ele, data, options, sourceOptions = null, printEntity = null, isFilter, param = null) {
        /** @type {?} */
        const self = this;
        /** @type {?} */
        const b = new Blob([data]);
        /** @type {?} */
        const reader = new FileReader();
        reader.readAsArrayBuffer(b);
        reader.onload = (/**
         * @param {?} e
         * @return {?}
         */
        function (e) {
            return tslib_1.__awaiter(this, void 0, void 0, function* () {
                /** @type {?} */
                const rendedFormat = (/** @type {?} */ (reader.result));
                /** @type {?} */
                const param = new OutputParam();
                param.prnRendedFormat = btoa((/** @type {?} */ (new Uint8Array(rendedFormat))));
                param.prnType = CmpType.Viewer;
                param.prnOutputOps = Object.assign({}, options);
                param.prnSourceOptions = sourceOptions ? [...sourceOptions] : [];
                param.isFilter = isFilter;
                if (ele === 'tab') {
                    self.appService.openAppByOptions({
                        appType: 'app',
                        funcId: '',
                        tabName: self.localpipe.transform('printview'),
                        appId: 'cloudprint-view-index',
                        appEntrance: 'cloudprint-view-index',
                        tabId: Utils.uuid(),
                        entityParams: {
                            foramtParam: param,
                            formatEntity: null,
                        },
                    });
                }
                else {
                    /** @type {?} */
                    const remotePrint = yield self.formatSrv.isRemotePrint();
                    self.createViewerRef();
                    self.printEntity.rendedFormat = rendedFormat;
                    self.viewercomponentRef.instance.outputParam = param;
                    self.viewercomponentRef.instance.isRemotePrint = remotePrint;
                    ele.appendChild(self.getComponentRootNode(self.viewercomponentRef));
                }
            });
        });
    }
    /**
     * 远程打印
     * @private
     * @param {?} ele
     * @param {?} options
     * @param {?=} sourceOptions
     * @param {?=} isFilter
     * @param {?=} printEntity
     * @param {?=} param
     * @return {?}
     */
    preViewRemote(ele, options, sourceOptions = null, isFilter, printEntity = null, param = null) {
        return tslib_1.__awaiter(this, void 0, void 0, function* () {
            /** @type {?} */
            const self = this;
            /** @type {?} */
            const outputparam = new OutputParam();
            outputparam.prnType = CmpType.Viewer;
            outputparam.prnOutputOps = Object.assign({}, options);
            outputparam.prnSourceOptions = [...sourceOptions];
            outputparam.isFilter = isFilter;
            if (ele === 'tab') {
                self.appService.openAppByOptions({
                    appType: 'app',
                    funcId: '',
                    tabName: self.localpipe.transform('printview'),
                    appId: 'cloudprint-view-index',
                    appEntrance: 'cloudprint-view-index',
                    tabId: Utils.uuid(),
                    entityParams: {
                        foramtParam: outputparam,
                        formatEntity: null,
                    },
                });
            }
            else {
                /** @type {?} */
                const remotePrint = yield self.formatSrv.isRemotePrint();
                self.createViewerRef();
                self.viewercomponentRef.instance.outputParam = outputparam;
                self.viewercomponentRef.instance.isRemotePrint = remotePrint;
                ele.appendChild(self.getComponentRootNode(self.viewercomponentRef));
            }
        });
    }
    /**
     * 创建Viewer构件的引用对象
     * @private
     * @return {?}
     */
    createViewerRef() {
        /** @type {?} */
        const factory = this.resolver.resolveComponentFactory(CloudprintViewerComponent);
        if (!this.viewContainer) {
            this.viewercomponentRef = factory.create(this.injector);
            this.applicationRef.attachView(this.viewercomponentRef.hostView);
        }
        else {
            this.viewContainer.clear();
            this.viewercomponentRef = this.viewContainer.createComponent(factory);
        }
        // 同步组件和组件上依赖的服务的printEntity
        this.viewercomponentRef.instance.setPrintEntity(this.printEntity);
        this.viewercomponentRef.instance.localpipe = this.localpipe;
        // 订阅退出事件
        this.viewercomponentRef.instance.printEntity.onExitEvent.subscribe((/**
         * @param {?} e
         * @return {?}
         */
        (e) => {
            this.viewercomponentRef.destroy();
            if (!this.viewContainer) {
                this.applicationRef.detachView(this.viewercomponentRef.hostView);
            }
            else {
                this.viewContainer.clear();
            }
        }));
    }
    /**
     * 将ComponentRef类型的组件引用转换为DOM节点（参考自Material2）
     * @private
     * @param {?} cpRef 组件的引用对象
     * @return {?}
     */
    getComponentRootNode(cpRef) {
        return (/** @type {?} */ (((/** @type {?} */ (cpRef.hostView))).rootNodes[0]));
    }
    //#endregion
    //#region 对外打印服务接口
    /**
     * 单格式数据id打印
     * su：双栈模式下nginx路由的su
     *
     * 1.带维度过滤格式选择器
     * @param {?} beoptions
     * @param {?} options
     * @param {?} ele
     * @param {?=} su
     * @param {?=} param
     * @return {?}
     */
    printSingleById(beoptions, options, ele, su = null, param = null) {
        if (DataValidator.checkAppUrl(this.printEntity.appUrl) == false) {
            this.notifyService.info(this.localpipe.transform('appurlerror'));
            return;
        }
        if (beoptions.queryType == undefined) { //兼容以前的逻辑
            beoptions.queryType = QueryType.Unknown;
        }
        if (options.printType == undefined) { //兼容以前的逻辑这里默认为表单打印
            options.printType = PrintType.Form;
        }
        //与表单集成时，表单打印时有多个打印格式，需要选择，这时候格式id是空的
        if (beoptions.FormatId == undefined || beoptions.FormatId == '') {
            return this.openFormatListByDimension(beoptions, options, ele, false);
        }
        else {
            if (ele) {
                /** @type {?} */
                const self = this;
                if (ele === 'download') {
                    return this.formatSrv.printSingleById(beoptions, options, su, 'CloudPrint')
                        .then((/**
                     * @param {?} data
                     * @return {?}
                     */
                    (data) => {
                        self.downloadFile(data);
                    }));
                }
                else {
                    self.openRendedViewer(ele, null, options, [beoptions], false);
                }
            }
            else {
                return this.formatSrv.printSingleById(beoptions, options, su, 'CloudPrint');
            }
        }
    }
    /**
     * 单格式过滤器打印
     * su：双栈模式下nginx路由的su
     *
     * 1.带维度过滤格式选择器
     * @param {?} beFilteroptions
     * @param {?} options
     * @param {?} ele
     * @param {?=} su
     * @param {?=} param
     * @return {?}
     */
    printSingleByFilter(beFilteroptions, options, ele, su = null, param = null) {
        if (DataValidator.checkAppUrl(this.printEntity.appUrl) == false) {
            this.notifyService.info(this.localpipe.transform('appurlerror'));
            return;
        }
        if (beFilteroptions.queryType == undefined) { //兼容以前的逻辑
            beFilteroptions.queryType = QueryType.Unknown;
        }
        if (options.printType == undefined) { //兼容以前的逻辑这里默认为表单打印
            options.printType = PrintType.Form;
        }
        //与表单集成时，表单打印时有多个打印格式，需要选择，这时候格式id是空的
        if (beFilteroptions.FormatId == undefined || beFilteroptions.FormatId == '') {
            return this.openFormatListByDimension(beFilteroptions, options, ele, true);
        }
        else {
            if (ele) {
                /** @type {?} */
                const self = this;
                if (ele === 'download') {
                    return this.formatSrv.printSingleByFilter(beFilteroptions, options, su, 'CloudPrint')
                        .then((/**
                     * @param {?} data
                     * @return {?}
                     */
                    (data) => {
                        self.downloadFile(data);
                    }));
                }
                else {
                    self.openRendedViewer(ele, null, options, [beFilteroptions], true);
                }
            }
            else {
                return this.formatSrv.printSingleByFilter(beFilteroptions, options, su, 'CloudPrint');
            }
        }
    }
    /**
     * 多格式数据id打印
     * su：双栈模式下nginx路由的su
     *
     * TODO: 目前不带格式选择器,需要外界组织好格式和数据的对应关系
     * @param {?} beOptionsList
     * @param {?} options
     * @param {?} ele
     * @param {?=} su
     * @param {?=} param
     * @return {?}
     */
    printMultiById(beOptionsList, options, ele, su = null, param = null) {
        for (let i = 0; i < beOptionsList.length; i++) {
            DataValidator.checkForNullReference(beOptionsList[i].queryType, 'queryType');
        }
        DataValidator.checkForNullReference(options.printType, 'printType');
        if (DataValidator.checkAppUrl(this.printEntity.appUrl) == false) {
            this.notifyService.info(this.localpipe.transform('appurlerror'));
            return;
        }
        if (ele) {
            /** @type {?} */
            const self = this;
            if (ele === 'download') {
                return this.formatSrv.printMultiById(beOptionsList, options, su, 'CloudPrint')
                    .then((/**
                 * @param {?} data
                 * @return {?}
                 */
                (data) => {
                    this.downloadFile(data);
                }));
            }
            else {
                self.openRendedViewer(ele, null, options, beOptionsList, false);
            }
        }
        else {
            return this.formatSrv.printMultiById(beOptionsList, options, su, 'CloudPrint');
        }
    }
    /**
     * 多格式过滤器打印
     * su：双栈模式下nginx路由的su
     *
     * TODO: 目前不带格式选择器,需要外界组织好格式和数据的对应关系
     * @param {?} beOptionsList
     * @param {?} options
     * @param {?} ele
     * @param {?=} su
     * @param {?=} param
     * @return {?}
     */
    printMultiByFilter(beOptionsList, options, ele, su = null, param = null) {
        for (let i = 0; i < beOptionsList.length; i++) {
            DataValidator.checkForNullReference(beOptionsList[i].queryType, 'queryType');
        }
        DataValidator.checkForNullReference(options.printType, 'printType');
        if (DataValidator.checkAppUrl(this.printEntity.appUrl) == false) {
            this.notifyService.info(this.localpipe.transform('appurlerror'));
            return;
        }
        if (ele) {
            /** @type {?} */
            const self = this;
            if (ele === 'download') {
                return this.formatSrv.printMultiByFilter(beOptionsList, options, su, 'CloudPrint')
                    .then((/**
                 * @param {?} data
                 * @return {?}
                 */
                (data) => {
                    this.downloadFile(data);
                }));
            }
            else {
                self.openRendedViewer(ele, null, options, beOptionsList, true);
            }
        }
        else {
            return this.formatSrv.printMultiByFilter(beOptionsList, options, su, 'CloudPrint');
        }
    }
    /**
     * 单格式数据id打印
     * su：双栈模式下nginx路由的su
     *
     * 1.带维度过滤格式选择器
     * @param {?} beoptions
     * @param {?} options
     * @param {?=} su
     * @param {?=} param
     * @return {?}
     */
    printSingleById4Job(beoptions, options, su = null, param = null) {
        if (DataValidator.checkAppUrl(this.printEntity.appUrl) == false) {
            this.notifyService.info(this.localpipe.transform('appurlerror'));
            return;
        }
        if (beoptions.queryType == undefined) { //兼容以前的逻辑
            beoptions.queryType = QueryType.Unknown;
        }
        if (options.printType == undefined) { //兼容以前的逻辑这里默认为表单打印
            options.printType = PrintType.Form;
        }
        return this.openFormatListByDimension4Job([beoptions], options, false, false);
    }
    /**
     * 单格式过滤器打印
     * su：双栈模式下nginx路由的su
     *
     * 1.带维度过滤格式选择器
     * @param {?} beFilteroptions
     * @param {?} options
     * @param {?=} su
     * @param {?=} param
     * @return {?}
     */
    printSingleByFilter4Job(beFilteroptions, options, su = null, param = null) {
        if (DataValidator.checkAppUrl(this.printEntity.appUrl) == false) {
            this.notifyService.info(this.localpipe.transform('appurlerror'));
            return;
        }
        if (beFilteroptions.queryType == undefined) { //兼容以前的逻辑
            beFilteroptions.queryType = QueryType.Unknown;
        }
        if (options.printType == undefined) { //兼容以前的逻辑这里默认为表单打印
            options.printType = PrintType.Form;
        }
        return this.openFormatListByDimension4Job([beFilteroptions], options, true, false);
    }
    /**
     * 多格式数据id打印
     * su：双栈模式下nginx路由的su
     *
     * TODO: 目前不带格式选择器
     * @param {?} beOptionsList
     * @param {?} options
     * @param {?=} su
     * @param {?=} param
     * @return {?}
     */
    printMultiById4Job(beOptionsList, options, su = null, param = null) {
        // tslint:disable-next-line:forin
        for (const b in beOptionsList) {
            DataValidator.checkForNullReference(beOptionsList[0].queryType, 'queryType');
        }
        DataValidator.checkForNullReference(options.printType, 'printType');
        if (DataValidator.checkAppUrl(this.printEntity.appUrl) == false) {
            this.notifyService.info(this.localpipe.transform('appurlerror'));
            return;
        }
        return this.openFormatListByDimension4Job(beOptionsList, options, false, true);
    }
    /**
     * 多格式过滤器打印
     * su：双栈模式下nginx路由的su
     *
     * TODO: 目前不带格式选择器
     * @param {?} beFilteroptions
     * @param {?} options
     * @param {?=} su
     * @param {?=} param
     * @return {?}
     */
    printMultiByFilter4Job(beFilteroptions, options, su = null, param = null) {
        // tslint:disable-next-line:forin
        for (const b in beFilteroptions) {
            DataValidator.checkForNullReference(beFilteroptions[0].queryType, 'queryType');
        }
        DataValidator.checkForNullReference(options.printType, 'printType');
        if (DataValidator.checkAppUrl(this.printEntity.appUrl) == false) {
            this.notifyService.info(this.localpipe.transform('appurlerror'));
            return;
        }
        return this.openFormatListByDimension4Job(beFilteroptions, options, true, true);
    }
    /**
     * 创建blob对象，并利用浏览器打开url进行下载
     * @param {?} data 文件流数据
     * @return {?}
     */
    downloadFile(data) {
        /** @type {?} */
        const link = document.createElement('a');
        /** @type {?} */
        const blob = new Blob([data], { type: 'application/pdf;charset=UTF-8' });
        link.setAttribute('href', window.URL.createObjectURL(blob));
        link.setAttribute('download', this.printEntity.downLoadFileName + '.pdf');
        link.style.visibility = 'hidden';
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
    }
    //#endregion
    /**
     * 打印（过期了，改为printSingleById）
     * @param {?} beoptions 数据源选项
     * @param {?} options 导出选项
     * @param {?} ele 预览时要渲染的主体
     * ele为空时：返回渲染流，
     * ele为tab字符串时：新的tab页打开预览器，
     * ele为download字符串时：下载，
     * ele为element元素时，当前页的element上渲染预览器
     *
     * 注意beoptions里的RetrieveParam内的属性值都需要小写字母开头
     * @return {?}
     */
    outputBEData(beoptions, options, ele) {
        return this.printSingleById(beoptions, options, ele);
    }
    /**
     * 打印（过期了，改为printSingleByFilter）
     * @param {?} beFilteroptions
     * @param {?} options 导出选项
     * @param {?} ele 预览时要渲染的主体
     * ele为空时：返回渲染流，
     * ele为tab字符串时：新的tab页打开预览器，
     * ele为download字符串时：下载
     * ele为element元素时，当前页的element上渲染预览器
     *
     * 注意beoptions里的RetrieveParam内的属性值都需要小写字母开头
     * @return {?}
     */
    outputBEDataWithFilter(beFilteroptions, options, ele) {
        return this.printSingleByFilter(beFilteroptions, options, ele);
    }
}
CloudprintService.decorators = [
    { type: Injectable }
];
/** @nocollapse */
CloudprintService.ctorParameters = () => [
    { type: PrintFormatService },
    { type: ComponentFactoryResolver },
    { type: CloudprintdesignerService },
    { type: CloudprintviewerService },
    { type: Injector },
    { type: ApplicationRef },
    { type: NotifyService },
    { type: AppService },
    { type: WindowService },
    { type: BsModalService }
];
if (false) {
    /**
     * @type {?}
     * @private
     */
    CloudprintService.prototype.designercomponentRef;
    /**
     * @type {?}
     * @private
     */
    CloudprintService.prototype.viewercomponentRef;
    /**
     * Saas应用通过构造函数注入的ViewContainerRef对象
     *
     * 例子：
     *    xxx.html
     *          <ng-container #prndesigner></ng-container>
     *
     *    xxx.component.ts
     * \@ViewChild('prndesigner', {read: ViewContainerRef})
     *          private container: ViewContainerRef;
     * @type {?}
     */
    CloudprintService.prototype.viewContainer;
    /**
     * 打印参数实体
     * @type {?}
     */
    CloudprintService.prototype.printEntity;
    /** @type {?} */
    CloudprintService.prototype.localeid;
    /** @type {?} */
    CloudprintService.prototype.localpipe;
    /** @type {?} */
    CloudprintService.prototype.windowRef;
    /**
     * @type {?}
     * @private
     */
    CloudprintService.prototype.formatSrv;
    /**
     * @type {?}
     * @private
     */
    CloudprintService.prototype.resolver;
    /**
     * @type {?}
     * @private
     */
    CloudprintService.prototype.designerSrv;
    /**
     * @type {?}
     * @private
     */
    CloudprintService.prototype.viewerSrv;
    /**
     * @type {?}
     * @private
     */
    CloudprintService.prototype.injector;
    /**
     * @type {?}
     * @private
     */
    CloudprintService.prototype.applicationRef;
    /**
     * @type {?}
     * @private
     */
    CloudprintService.prototype.notifyService;
    /**
     * @type {?}
     * @private
     */
    CloudprintService.prototype.appService;
    /**
     * @type {?}
     * @private
     */
    CloudprintService.prototype.windowService;
    /**
     * @type {?}
     * @private
     */
    CloudprintService.prototype.modalService;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2xvdWRwcmludC5zZXJ2aWNlLmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGdzcC1zdmMvY2xvdWRwcmludC8iLCJzb3VyY2VzIjpbImxpYi9jbG91ZHByaW50LnNlcnZpY2UudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQSxPQUFPLEVBQUUsVUFBVSxFQUFFLFFBQVEsRUFBRSxjQUFjLEVBQXVCLFNBQVMsRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUNyRyxPQUFPLEVBQUUsd0JBQXdCLEVBQW1ELE1BQU0sZUFBZSxDQUFDO0FBRTFHLE9BQU8sRUFBRSwyQkFBMkIsRUFBRSxNQUFNLHFEQUFxRCxDQUFDO0FBQ2xHLE9BQU8sRUFBRSx5QkFBeUIsRUFBRSxNQUFNLGlEQUFpRCxDQUFDO0FBQzVGLE9BQU8sRUFBRSxXQUFXLEVBQUUsTUFBTSx1QkFBdUIsQ0FBQztBQUVwRCxPQUFPLEVBQUUsYUFBYSxFQUFFLE1BQU0sbUJBQW1CLENBQUM7QUFFbEQsT0FBTyxFQUFFLElBQUksRUFBRSxNQUFNLHlCQUF5QixDQUFDO0FBSS9DLE9BQU8sRUFBRSxVQUFVLEVBQXdDLE1BQU0scUJBQXFCLENBQUM7QUFFdkYsT0FBTyxFQUFFLE9BQU8sRUFBRSxNQUFNLHlCQUF5QixDQUFDO0FBQ2xELE9BQU8sRUFBRSxXQUFXLEVBQUUsTUFBTSxxQ0FBcUMsQ0FBQztBQUNsRSxPQUFPLEVBQUUsa0JBQWtCLEVBQUUsTUFBTSwrQkFBK0IsQ0FBQztBQUNuRSxPQUFPLEVBQUUsVUFBVSxFQUFFLE1BQU0sNEJBQTRCLENBQUM7QUFFeEQsT0FBTyxFQUFFLFdBQVcsRUFBRSxNQUFNLHVCQUF1QixDQUFDO0FBR3BELE9BQU8sRUFHTCxhQUFhLEVBQ2QsTUFBTSxnQ0FBZ0MsQ0FBQztBQUN4QyxPQUFPLEVBQUUsbUJBQW1CLEVBQUUsTUFBTSw4Q0FBOEMsQ0FBQztBQUNuRixPQUFPLEVBQUUsS0FBSyxFQUFFLE1BQU0sMEJBQTBCLENBQUM7QUFDakQsT0FBTyxFQUFFLHlCQUF5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Ozs7Ozs7Ozs7O0lBZUQsWUFBWSxDQUFDLFNBQWMsRUFBRSxPQUFzQixFQUFFLEdBQVE7UUFDM0QsT0FBTyxJQUFJLENBQUMsZUFBZSxDQUFDLFNBQVMsRUFBQyxPQUFPLEVBQUMsR0FBRyxDQUFDLENBQUM7SUFDckQsQ0FBQzs7Ozs7Ozs7Ozs7Ozs7SUFjRCxzQkFBc0IsQ0FBQyxlQUFvQixFQUFFLE9BQXNCLEVBQUUsR0FBUTtRQUMzRSxPQUFPLElBQUksQ0FBQyxtQkFBbUIsQ0FBQyxlQUFlLEVBQUUsT0FBTyxFQUFDLEdBQUcsQ0FBQyxDQUFDO0lBQ2hFLENBQUM7OztZQWo2QkYsVUFBVTs7OztZQXpCRixrQkFBa0I7WUFoQmxCLHdCQUF3QjtZQTZCeEIseUJBQXlCO1lBQ3pCLHVCQUF1QjtZQS9CWCxRQUFRO1lBQUUsY0FBYztZQU9wQyxhQUFhO1lBTWIsVUFBVTtZQWFqQixhQUFhO1lBWU4sY0FBYzs7Ozs7OztJQU9yQixpREFBd0U7Ozs7O0lBQ3hFLCtDQUFvRTs7Ozs7Ozs7Ozs7OztJQVlwRSwwQ0FBZ0M7Ozs7O0lBS2hDLHdDQUFnQzs7SUFjaEMscUNBQWdCOztJQUNoQixzQ0FBeUI7O0lBcUN6QixzQ0FBaUM7Ozs7O0lBbEMvQixzQ0FBcUM7Ozs7O0lBQ3JDLHFDQUEwQzs7Ozs7SUFDMUMsd0NBQThDOzs7OztJQUM5QyxzQ0FBMEM7Ozs7O0lBQzFDLHFDQUEwQjs7Ozs7SUFDMUIsMkNBQXNDOzs7OztJQUN0QywwQ0FBb0M7Ozs7O0lBQ3BDLHVDQUE4Qjs7Ozs7SUFDOUIsMENBQW9DOzs7OztJQUNwQyx5Q0FBb0MiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBJbmplY3RhYmxlLCBJbmplY3RvciwgQXBwbGljYXRpb25SZWYsIEV2ZW50RW1pdHRlciwgUXVlcnksIExPQ0FMRV9JRCB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBDb21wb25lbnRGYWN0b3J5UmVzb2x2ZXIsIENvbXBvbmVudFJlZiwgRW1iZWRkZWRWaWV3UmVmLCBWaWV3Q29udGFpbmVyUmVmIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcblxyXG5pbXBvcnQgeyBDbG91ZHByaW50RGVzaWduZXJDb21wb25lbnQgfSBmcm9tICcuL2Nsb3VkcHJpbnQtZGVzaWduZXIvY2xvdWRwcmludC1kZXNpZ25lci5jb21wb25lbnQnO1xyXG5pbXBvcnQgeyBDbG91ZHByaW50Vmlld2VyQ29tcG9uZW50IH0gZnJvbSAnLi9jbG91ZHByaW50LXZpZXdlci9jbG91ZHByaW50LXZpZXdlci5jb21wb25lbnQnO1xyXG5pbXBvcnQgeyBQcmludEVudGl0eSB9IGZyb20gJy4vZW50aXR5cy9wcmludEVudGl0eSc7XHJcblxyXG5pbXBvcnQgeyBOb3RpZnlTZXJ2aWNlIH0gZnJvbSAnQGZhcnJpcy91aS1ub3RpZnknO1xyXG5pbXBvcnQgeyBPdXRwdXRPcHRpb25zIH0gZnJvbSAnLi9lbnRpdHlzL291dHB1dG9wdGlvbnMvb3V0cHV0T3B0aW9ucyc7XHJcbmltcG9ydCB7IFVybHMgfSBmcm9tICcuL3V0aWxzL2Nsb3VkcHJpbnQuVXJscyc7XHJcbmltcG9ydCB7IFNvdXJjZU9wdGlvbnMgfSBmcm9tICcuL2VudGl0eXMvZGF0YXNvdXJjZW9wdGlvbnMvc291cmNlT3B0aW9ucyc7XHJcbmltcG9ydCB7IFNvdXJjZUZpbHRlck9wdGlvbnMgfSBmcm9tICcuL2VudGl0eXMvZGF0YXNvdXJjZW9wdGlvbnMvc291cmNlRmlsdGVyT3B0aW9ucyc7XHJcbmltcG9ydCB7IEJPT3B0aW9ucyB9IGZyb20gJy4vZW50aXR5cy9kYXRhc291cmNlb3B0aW9ucy9ib29wdGlvbnMnO1xyXG5pbXBvcnQgeyBBcHBTZXJ2aWNlLCBBcHBPcHRpb25zLCBGcmFtZXdvcmtWYXJpYWJsZVNlcnZpY2UgfSBmcm9tICdAZ3NwLXN5cy9ydGYtY29tbW9uJztcclxuaW1wb3J0IHsgRmlsZVR5cGUgfSBmcm9tICcuL2VudGl0eXMvb3V0cHV0b3B0aW9ucy9maWxlVHlwZSc7XHJcbmltcG9ydCB7IENtcFR5cGUgfSBmcm9tICcuL2VudGl0eXMvZW51bXMvY21wVHlwZSc7XHJcbmltcG9ydCB7IE91dHB1dFBhcmFtIH0gZnJvbSAnLi9lbnRpdHlzL291dHB1dG9wdGlvbnMvb3V0cHV0UGFyYW0nO1xyXG5pbXBvcnQgeyBQcmludEZvcm1hdFNlcnZpY2UgfSBmcm9tICcuL3NlcnZpY2VzL3ByaW50Rm9ybWF0U2VydmljZSc7XHJcbmltcG9ydCB7IFNvdXJjZVR5cGUgfSBmcm9tICcuL2VudGl0eXMvZW51bXMvc291cmNlVHlwZSc7XHJcblxyXG5pbXBvcnQgeyBQcmludEZvcm1hdCB9IGZyb20gJy4vZW50aXR5cy9wcmludEZvcm1hdCc7XHJcblxyXG5cclxuaW1wb3J0IHtcclxuICBXaW5kb3dSZWYsXHJcbiAgV2luZG93Q2xvc2VSZXN1bHQsXHJcbiAgV2luZG93U2VydmljZVxyXG59IGZyb20gJ0Bwcm9ncmVzcy9rZW5kby1hbmd1bGFyLWRpYWxvZyc7XHJcbmltcG9ydCB7IEZvcm1hdGxpc3RDb21wb25lbnQgfSBmcm9tICcuL2Nsb3VkcHJpbnQtZm9ybWF0bGlzdC9mb3JtYXRsaXN0LmNvbXBvbmVudCc7XHJcbmltcG9ydCB7IFV0aWxzIH0gZnJvbSAnLi91dGlscy9jbG91ZHByaW50LnV0aWxzJztcclxuaW1wb3J0IHsgQ2xvdWRwcmludGRlc2lnbmVyU2VydmljZSB9IGZyb20gJy4vY2xvdWRwcmludC1kZXNpZ25lci9jbG91ZHByaW50LWRlc2lnbmVyLnNlcnZpY2UnO1xyXG5pbXBvcnQgeyBDbG91ZHByaW50dmlld2VyU2VydmljZSB9IGZyb20gJy4vY2xvdWRwcmludC12aWV3ZXIvY2xvdWRwcmludC12aWV3ZXIuc2VydmljZSc7XHJcbmltcG9ydCB7IFN1YmplY3QgfSBmcm9tICdyeGpzJztcclxuaW1wb3J0IHsgUXVlcnlUeXBlIH0gZnJvbSAnLi9lbnRpdHlzL2VudW1zL3F1ZXJ5dHlwZSc7XHJcbmltcG9ydCB7IFByaW50VHlwZSB9IGZyb20gJy4vZW50aXR5cy9lbnVtcy9wcmludHR5cGUnO1xyXG5pbXBvcnQgeyBEYXRhVmFsaWRhdG9yIH0gZnJvbSAnLi91dGlscy9jbG91ZHByaW50LmRhdGF2YWxpZGF0b3InO1xyXG5pbXBvcnQgeyBCYXNlU291cmNlT3B0aW9ucyB9IGZyb20gJy4vZW50aXR5cy9kYXRhc291cmNlb3B0aW9ucy9iYXNlc291cmNlb3B0aW9ucyc7XHJcbmltcG9ydCB7IEZvcm1hdGxpc3Rqb2JDb21wb25lbnQgfSBmcm9tICcuL2Nsb3VkcHJpbnQtZm9ybWF0bGlzdGpvYi9mb3JtYXRsaXN0am9iLmNvbXBvbmVudCc7XHJcbmltcG9ydCB7IEJzTW9kYWxTZXJ2aWNlIH0gZnJvbSAnQGZhcnJpcy91aS1tb2RhbCc7XHJcbmltcG9ydCB7IExvY2FsTGFuZ1BpcGUgfSBmcm9tICcuL2xvY2FsLnBpcGUnO1xyXG5cclxuXHJcbkBJbmplY3RhYmxlKClcclxuZXhwb3J0IGNsYXNzIENsb3VkcHJpbnRTZXJ2aWNlIHtcclxuICAvLyDnu4Tku7blvJXnlKjlj5jph49cclxuICBwcml2YXRlIGRlc2lnbmVyY29tcG9uZW50UmVmOiBDb21wb25lbnRSZWY8Q2xvdWRwcmludERlc2lnbmVyQ29tcG9uZW50PjtcclxuICBwcml2YXRlIHZpZXdlcmNvbXBvbmVudFJlZjogQ29tcG9uZW50UmVmPENsb3VkcHJpbnRWaWV3ZXJDb21wb25lbnQ+O1xyXG4gIC8qKlxyXG4gICAqIFNhYXPlupTnlKjpgJrov4fmnoTpgKDlh73mlbDms6jlhaXnmoRWaWV3Q29udGFpbmVyUmVm5a+56LGhXHJcbiAgICogXHJcbiAgICog5L6L5a2Q77yaXHJcbiAgICogICAgeHh4Lmh0bWxcclxuICAgKiAgICAgICAgICA8bmctY29udGFpbmVyICNwcm5kZXNpZ25lcj48L25nLWNvbnRhaW5lcj5cclxuICAgKiBcclxuICAgKiAgICB4eHguY29tcG9uZW50LnRzXHJcbiAgICogICAgICAgICAgQFZpZXdDaGlsZCgncHJuZGVzaWduZXInLCB7cmVhZDogVmlld0NvbnRhaW5lclJlZn0pIFxyXG4gICAqICAgICAgICAgIHByaXZhdGUgY29udGFpbmVyOiBWaWV3Q29udGFpbmVyUmVmO1xyXG4gICAqL1xyXG4gIHZpZXdDb250YWluZXI6IFZpZXdDb250YWluZXJSZWY7XHJcblxyXG4gIC8qKlxyXG4gICAqIOaJk+WNsOWPguaVsOWunuS9k1xyXG4gICAqL1xyXG4gIHByaW50RW50aXR5ID0gbmV3IFByaW50RW50aXR5KCk7XHJcblxyXG4gIC8qKlxyXG4gICAqIOiuvue9rlByaW50RW50aXR55Y+C5pWwXHJcbiAgICogQGRlc2NyaXB0aW9uIOWmguaenOWklueVjG5ld+aWsOeahFByaW50RW50aXR577yM5YiZ6ZyA6KaB6LCD55So6K+l5pa55rOV5ZCM5q2lc2VydmljZeeahGVudGl0eVxyXG4gICAqICAgICAgICAgICAgICDlpJbnlYzmsqHmnIluZXfmlrDnmoRQcmludEVudGl0ee+8jOWImeS4jemcgOimgeiwg+eUqOivpeaWueazlVxyXG4gICAqL1xyXG4gIHNldCBzZXRQcmludEVudGl0eShlbnRpdHkpIHtcclxuICAgIHRoaXMucHJpbnRFbnRpdHkgPSBlbnRpdHk7XHJcbiAgICAvLyB0aGlzLmRlc2lnbmVyU3J2LnByaW50RW50aXR5ID0gdGhpcy5wcmludEVudGl0eTtcclxuICAgIC8vIHRoaXMudmlld2VyU3J2LnByaW50RW50aXR5ID0gdGhpcy5wcmludEVudGl0eTtcclxuICAgIHRoaXMuZm9ybWF0U3J2LnByaW50RW50aXR5ID0gdGhpcy5wcmludEVudGl0eTtcclxuICB9XHJcblxyXG4gIGxvY2FsZWlkOnN0cmluZztcclxuICBsb2NhbHBpcGU6IExvY2FsTGFuZ1BpcGU7XHJcblxyXG4gIGNvbnN0cnVjdG9yKFxyXG4gICAgcHJpdmF0ZSBmb3JtYXRTcnY6IFByaW50Rm9ybWF0U2VydmljZSxcclxuICAgIHByaXZhdGUgcmVzb2x2ZXI6IENvbXBvbmVudEZhY3RvcnlSZXNvbHZlcixcclxuICAgIHByaXZhdGUgZGVzaWduZXJTcnY6IENsb3VkcHJpbnRkZXNpZ25lclNlcnZpY2UsXHJcbiAgICBwcml2YXRlIHZpZXdlclNydjogQ2xvdWRwcmludHZpZXdlclNlcnZpY2UsXHJcbiAgICBwcml2YXRlIGluamVjdG9yOiBJbmplY3RvcixcclxuICAgIHByaXZhdGUgYXBwbGljYXRpb25SZWY6IEFwcGxpY2F0aW9uUmVmLFxyXG4gICAgcHJpdmF0ZSBub3RpZnlTZXJ2aWNlOiBOb3RpZnlTZXJ2aWNlLFxyXG4gICAgcHJpdmF0ZSBhcHBTZXJ2aWNlOiBBcHBTZXJ2aWNlLFxyXG4gICAgcHJpdmF0ZSB3aW5kb3dTZXJ2aWNlOiBXaW5kb3dTZXJ2aWNlLFxyXG4gICAgcHJpdmF0ZSBtb2RhbFNlcnZpY2U6IEJzTW9kYWxTZXJ2aWNlLFxyXG4gICAgKSB7XHJcbiAgICAgIFxyXG4gICAgLy8g6K6+572ucHJpbnRFbnRpdHnnmoTpu5jorqTlgLxcclxuICAgIHRoaXMucHJpbnRFbnRpdHkuYXBwVXJsID0gVXJscy5DbG91ZFByaW50QmFzZVVybDtcclxuICAgIHRoaXMucHJpbnRFbnRpdHkuaXNVc2VNZXRhRGF0YSA9IHRydWU7XHJcbiAgICB0aGlzLnByaW50RW50aXR5Lmxhbmd1YWdlID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oXCJsYW5ndWFnZUNvZGVcIikgfHwgJ3poLUNIUyc7XHJcbiAgICBcclxuICAgIC8vIOWwhnByaW50RW50aXR56K6+572u5YiwZGVzaWduZXIgc2VydmljZeS4iu+8iOS4jeiuvue9ru+8jOWQjumdouiwg+eUqOacjeWKoeS8muWPkeeOsOacjeWKoeeahHByaW50RW50aXR55piv56m655qE77yJXHJcbiAgICAvLyB0aGlzLmRlc2lnbmVyU3J2LnByaW50RW50aXR5ID0gdGhpcy5wcmludEVudGl0eTtcclxuICAgIC8vIOWwhnByaW50RW50aXR56K6+572u5Yiwdmlld2VyIHNlcnZpY2XkuIrvvIjkuI3orr7nva7vvIzlkI7pnaLosIPnlKjmnI3liqHkvJrlj5HnjrDmnI3liqHnmoRwcmludEVudGl0eeaYr+epuueahO+8iVxyXG4gICAgLy8gdGhpcy52aWV3ZXJTcnYucHJpbnRFbnRpdHkgPSB0aGlzLnByaW50RW50aXR5O1xyXG4gICAgdGhpcy5mb3JtYXRTcnYucHJpbnRFbnRpdHkgPSB0aGlzLnByaW50RW50aXR5O1xyXG5cclxuICAgIGlmKHRoaXMuaW5qZWN0b3IpXHJcbiAgICB7XHJcbiAgICAgIHRoaXMubW9kYWxTZXJ2aWNlID0gdGhpcy5pbmplY3Rvci5nZXQoQnNNb2RhbFNlcnZpY2UpO1xyXG4gICAgICB0aGlzLmxvY2FsZWlkID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oXCJsYW5ndWFnZUNvZGVcIikgfHwgdGhpcy5pbmplY3Rvci5nZXQoTE9DQUxFX0lEKTtcclxuICAgICAgdGhpcy5sb2NhbHBpcGUgPSBuZXcgTG9jYWxMYW5nUGlwZSh0aGlzLmxvY2FsZWlkKTtcclxuICAgIH0gXHJcbiAgIFxyXG4gIH1cclxuXHJcblxyXG4gIC8vI3JlZ2lvbiDmoLzlvI/pgInmi6nliJfooajnm7jlhbPmjqXlj6NcclxuICB3aW5kb3dSZWY6IFdpbmRvd1JlZiA9IHVuZGVmaW5lZDtcclxuXHJcbiAgLyoqXHJcbiAgICog6L+Q6KGM5pe25omT5Y2w5pe25qC55o2u57u05bqm6L+H5ruk5by55Ye65omT5Y2w5qC85byP6YCJ5oup5YiX6KGoXHJcbiAgICogQHBhcmFtIGRhdGFTb3VyY2VJZCDmlbDmja7mupBJZFxyXG4gICAqIEBwYXJhbSBmaWx0ZXIg5piv5ZCm6L+H5ruk5p2h5Lu2XHJcbiAgICogQHBhcmFtIGJlT3B0aW9ucyBiZU9wdGlvbnNcclxuICAgKiBAcGFyYW0gb3B0aW9ucyDovpPlh7pvcHRpb25zXHJcbiAgICogQHBhcmFtIGVsZSDmjIflrprnmoRlbGVtZW505YWD57SgXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBvcGVuRm9ybWF0TGlzdEJ5RGltZW5zaW9uKGJlT3B0aW9uczpCYXNlU291cmNlT3B0aW9ucywgb3B0aW9uczogT3V0cHV0T3B0aW9ucywgZWxlOmFueSxmaWx0ZXI6Ym9vbGVhbil7XHJcbiAgICBjb25zdCB0aGF0ID0gdGhpcztcclxuICAgIGNvbnN0IGRhdGFTb3VyY2VJZCA9IGJlT3B0aW9ucy5Tb3VyY2VJZDtcclxuICAgIGNvbnN0IGJpbGxDYXRlZ29yeUlkID0gYmVPcHRpb25zLmJpbGxDYXRlZ29yeUlkO1xyXG4gICAgcmV0dXJuIHRoaXMuZm9ybWF0U3J2LmdldFByaW50Rm9ybWF0QnlEYXRhU3JvdWNlQW5kRGltZW5zaW9uKGJpbGxDYXRlZ29yeUlkLGRhdGFTb3VyY2VJZCwoYmVPcHRpb25zIGFzIGFueSkuRmlyc3REaW1lbnNpb25WYWwsKGJlT3B0aW9ucyBhcyBhbnkpLlNlY29uZERpbWVuc2lvblZhbCkudGhlbigocmVzKT0+e1xyXG4gICAgICBjb25zdCBmb3JtYXQgOiBQcmludEZvcm1hdFtdID0gKHJlcyAhPSBudWxsICYmIHJlcy5sZW5ndGggIT0gdW5kZWZpbmVkKSA/IHJlcyA6IFtdO1xyXG5cclxuICAgICAgLy/lj6rmnInkuIDmnaHmiZPljbDmoLzlvI/vvIznm7TmjqXovpPlh7rpooTop4hcclxuICAgICAgaWYoZm9ybWF0Lmxlbmd0aCA9PT0gMSl7XHJcbiAgICAgICAgcmV0dXJuIHRoYXQub3V0cHV0QnlTaW5nbGVTZWxlY3Rpb25Gb3JtYXQoe1xyXG4gICAgICAgICAgJ2lkJzogZm9ybWF0WzBdLmlkLCBcclxuICAgICAgICAgICdpc0ZpbHRlcicgOiBmaWx0ZXIsIFxyXG4gICAgICAgICAgJ2Jlb3B0aW9ucyc6IE9iamVjdC5hc3NpZ24oe30sIGJlT3B0aW9ucyksIFxyXG4gICAgICAgICAgJ29wdGlvbnMnOm9wdGlvbnMsXHJcbiAgICAgICAgICAnaXNKb2InOiBmYWxzZSwgXHJcbiAgICAgICAgICAncHJpbnRlck5hbWUnOicnLFxyXG4gICAgICAgICAgJ2JveElkJzonJyxcclxuICAgICAgICAgICdwcmludFNldHRpbmcnOm51bGwsXHJcbiAgICAgICAgICAnZWxlJzplbGV9KTtcclxuICAgICAgfVxyXG5cclxuICAgICAgY29uc3QgZmFjdG9yeSA9IHRoYXQucmVzb2x2ZXIucmVzb2x2ZUNvbXBvbmVudEZhY3RvcnkoRm9ybWF0bGlzdENvbXBvbmVudCk7XHJcbiAgICAgIGNvbnN0IHByaW50c2V0dGluZyA9IGZhY3RvcnkuY3JlYXRlKHRoYXQuaW5qZWN0b3IpO1xyXG4gICAgICBcclxuICAgICAgcHJpbnRzZXR0aW5nLmluc3RhbmNlLmZvcm1hdHMgPSBbLi4uZm9ybWF0XTtcclxuICAgICAgcHJpbnRzZXR0aW5nLmluc3RhbmNlLmxvY2FsZXBpcCA9IHRoYXQubG9jYWxwaXBlO1xyXG5cclxuICAgICAgY29uc3QgZGxnID0gdGhpcy5tb2RhbFNlcnZpY2Uuc2hvdyhwcmludHNldHRpbmcse1xyXG4gICAgICAgIHRpdGxlOiB0aGlzLmxvY2FscGlwZS50cmFuc2Zvcm0oJ3ByaW50Zm9ybWF0JyksXHJcbiAgICAgICAgd2lkdGg6NDAwLCBcclxuICAgICAgICBoZWlnaHQ6IDUwMCxcclxuICAgICAgICBzaG93QnV0dG9uczogdHJ1ZSxcclxuICAgICAgICBzaG93TWF4QnV0dG9uOmZhbHNlLFxyXG4gICAgICAgIGJ1dHRvbnM6IFtcclxuICAgICAgICAgIHsgdGV4dDogdGhpcy5sb2NhbHBpcGUudHJhbnNmb3JtKCdwcmludCcpLCBjbHM6ICdidG4gYnRuLXByaW1hcnknLCBoYW5kbGU6ICgpID0+IHtcclxuICAgICAgICAgICAgcHJpbnRzZXR0aW5nLmluc3RhbmNlLnByaW50Sm9iKCk7XHJcbiAgICAgICAgICB9fSxcclxuICAgICAgICAgIHsgdGV4dDogdGhpcy5sb2NhbHBpcGUudHJhbnNmb3JtKCdjYW5jZWwnKSwgY2xzOiAnYnRuIGJ0bi1zZWNvbmRhcnknLCBoYW5kbGU6ICgpID0+IHtcclxuICAgICAgICAgICAgZGxnLmNsb3NlKCk7XHJcbiAgICAgICAgICB9fVxyXG4gICAgICAgIF0sXHJcbiAgICAgIH0pO1xyXG4gICAgICAvLyBwcmludHNldHRpbmcuaW5zdGFuY2UuZGxnID0gZGxnO1xyXG4gICAgICAvL+iuoumYheS6huW8ueWHuueahOagvOW8j+mAieaLqeWIl+ihqOeahOWFs+mXreS6i+S7tlxyXG4gICAgICBwcmludHNldHRpbmcuaW5zdGFuY2UucHJpbnQuc3Vic2NyaWJlKChkYXRhKSA9PiB7XHJcbiAgICAgICAgICBkbGcuY2xvc2UoKTtcclxuICAgICAgICAgIHJldHVybiB0aGF0Lm91dHB1dEJ5U2luZ2xlU2VsZWN0aW9uRm9ybWF0KHtcclxuICAgICAgICAgICAgICAnaWQnOiBkYXRhLmlkLCBcclxuICAgICAgICAgICAgICAnaXNGaWx0ZXInIDogZmlsdGVyLCBcclxuICAgICAgICAgICAgICAnYmVvcHRpb25zJzogT2JqZWN0LmFzc2lnbih7fSwgYmVPcHRpb25zKSwgXHJcbiAgICAgICAgICAgICAgJ29wdGlvbnMnOm9wdGlvbnMsIFxyXG4gICAgICAgICAgICAgICdpc0pvYic6IGZhbHNlLFxyXG4gICAgICAgICAgICAgICdwcmludGVyTmFtZSc6JycsXHJcbiAgICAgICAgICAgICAgJ2JveElkJzonJyxcclxuICAgICAgICAgICAgICAncHJpbnRTZXR0aW5nJzpudWxsLFxyXG4gICAgICAgICAgICAgICdlbGUnOmVsZX0pO1xyXG4gICAgICB9KTtcclxuICAgICAgXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOWQjuWPsOaJk+WNsOS7u+WKoeeahOagvOW8j+mAieaLqeWSjOaJk+WNsOmFjee9ruWIl+ihqFxyXG4gICAqL1xyXG4gIHByaXZhdGUgb3BlbkZvcm1hdExpc3RCeURpbWVuc2lvbjRKb2IoYmVPcHRpb25zOkFycmF5PEJhc2VTb3VyY2VPcHRpb25zPiwgb3B0aW9uczogT3V0cHV0T3B0aW9ucyxmaWx0ZXI6Ym9vbGVhbixpc011bHRpOmJvb2xlYW4pe1xyXG4gICAgY29uc3QgdGhhdCA9IHRoaXM7XHJcblxyXG4gICAgaWYoaXNNdWx0aSl7Ly/mibnph4/miZPljbBcclxuICAgICAgcmV0dXJuIHRoaXMuZm9ybWF0U3J2LmdldFByaW50RGV2aWNlKCkudGhlbigoZGF0YSk9PntcclxuICAgICAgICBjb25zdCBkZXZpY2UgPSBkYXRhIHx8IFtdO1xyXG5cclxuICAgICAgICBsZXQgaWRzID0gJyc7XHJcbiAgICAgICAgYmVPcHRpb25zLmZvckVhY2goeD0+aWRzKz14LkZvcm1hdElkKycsJyk7XHJcbiAgXHJcbiAgICAgICAgY29uc3QgZmFjdG9yeSA9IHRoYXQucmVzb2x2ZXIucmVzb2x2ZUNvbXBvbmVudEZhY3RvcnkoRm9ybWF0bGlzdGpvYkNvbXBvbmVudCk7XHJcbiAgICAgICAgY29uc3QgcHJpbnRzZXR0aW5nID0gZmFjdG9yeS5jcmVhdGUodGhhdC5pbmplY3Rvcik7XHJcbiAgXHJcbiAgICAgICAgcHJpbnRzZXR0aW5nLmluc3RhbmNlLmJveGxpc3QgPSBkZXZpY2U7XHJcbiAgICAgICAgcHJpbnRzZXR0aW5nLmluc3RhbmNlLmZvcm1hdElkID0gaWRzLmxlbmd0aD4wP2lkcy5zdWJzdHIoMCxpZHMubGVuZ3RoLTEpOmlkcztcclxuICAgICAgICBwcmludHNldHRpbmcuaW5zdGFuY2UuaXNTaG93Rm9ybWF0ID0gZmFsc2U7XHJcbiAgICAgICAgcHJpbnRzZXR0aW5nLmluc3RhbmNlLmxvY2FsZXBpcCA9IHRoYXQubG9jYWxwaXBlO1xyXG5cclxuICAgICAgICBjb25zdCBkbGcgPSB0aGlzLm1vZGFsU2VydmljZS5zaG93KHByaW50c2V0dGluZyx7XHJcbiAgICAgICAgICB0aXRsZTogdGhpcy5sb2NhbHBpcGUudHJhbnNmb3JtKCdwcmludHNldCcpLFxyXG4gICAgICAgICAgd2lkdGg6IDgwMCwgXHJcbiAgICAgICAgICBoZWlnaHQ6IDUwMCxcclxuICAgICAgICAgIHNob3dCdXR0b25zOiB0cnVlLFxyXG4gICAgICAgICAgc2hvd01heEJ1dHRvbjpmYWxzZSxcclxuICAgICAgICAgIGJ1dHRvbnM6IFtcclxuICAgICAgICAgICAgeyB0ZXh0OiB0aGlzLmxvY2FscGlwZS50cmFuc2Zvcm0oJ3ByaW50JyksIGNsczogJ2J0biBidG4tcHJpbWFyeScsIGhhbmRsZTogKCkgPT4ge1xyXG4gICAgICAgICAgICAgIHByaW50c2V0dGluZy5pbnN0YW5jZS5wcmludEpvYigpO1xyXG4gICAgICAgICAgICB9fSxcclxuICAgICAgICAgICAgeyB0ZXh0OiB0aGlzLmxvY2FscGlwZS50cmFuc2Zvcm0oJ2NhbmNlbCcpLCBjbHM6ICdidG4gYnRuLXNlY29uZGFyeScsIGhhbmRsZTogKCkgPT4ge1xyXG4gICAgICAgICAgICAgIGRsZy5jbG9zZSgpO1xyXG4gICAgICAgICAgICB9fVxyXG4gICAgICAgICAgXSxcclxuICAgICAgICB9KTsgIFxyXG4gICAgICAgIC8v6K6i6ZiF5LqG5by55Ye655qE5qC85byP6YCJ5oup5YiX6KGo55qE5YWz6Zet5LqL5Lu2XHJcbiAgICAgICAgcHJpbnRzZXR0aW5nLmluc3RhbmNlLnByaW50LnN1YnNjcmliZSgoZGF0YSkgPT4ge1xyXG4gICAgICAgICAgICBkbGcuY2xvc2UoKTtcclxuICAgICAgICAgICAgcmV0dXJuIHRoYXQub3V0cHV0QnlNdWx0aVNlbGVjdGlvbkZvcm1hdCh7XHJcbiAgICAgICAgICAgICAgJ2lzRmlsdGVyJyA6IGZpbHRlciwgXHJcbiAgICAgICAgICAgICAgJ2Jlb3B0aW9ucyc6IFsuLi5iZU9wdGlvbnNdLCBcclxuICAgICAgICAgICAgICAnb3B0aW9ucyc6IE9iamVjdC5hc3NpZ24oe30sIG9wdGlvbnMpLFxyXG4gICAgICAgICAgICAgICdpc0pvYic6IHRydWUsXHJcbiAgICAgICAgICAgICAgJ3ByaW50ZXJOYW1lJzpkYXRhLnByaW50dGVyLFxyXG4gICAgICAgICAgICAgICdib3hJZCc6ZGF0YS5ib3hJZCxcclxuICAgICAgICAgICAgICAncHJpbnRTZXR0aW5nJzpkYXRhLnByaW50U2V0dGluZyxcclxuICAgICAgICAgICAgICAnZWxlJzpudWxsfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH0pO1xyXG4gICAgfWVsc2V7XHJcbiAgICAgIGNvbnN0IGJpbGxDYXRlZ29yeUlkID0gYmVPcHRpb25zWzBdLmJpbGxDYXRlZ29yeUlkO1xyXG4gICAgICBjb25zdCBkYXRhU291cmNlSWQgPSBiZU9wdGlvbnNbMF0uU291cmNlSWQ7XHJcbiAgICAgIHJldHVybiB0aGlzLmZvcm1hdFNydi5nZXRQcmludEZvcm1hdEFuZERldmljZShiaWxsQ2F0ZWdvcnlJZCxkYXRhU291cmNlSWQsKGJlT3B0aW9ucyBhcyBhbnkpLkZpcnN0RGltZW5zaW9uVmFsLChiZU9wdGlvbnMgYXMgYW55KS5TZWNvbmREaW1lbnNpb25WYWwpLnRoZW4oKHJlcyk9PntcclxuICAgICAgICBjb25zdCBmb3JtYXQgPSByZXMuZm9ybWF0IHx8IFtdO1xyXG4gICAgICAgIGNvbnN0IGRldmljZSA9IHJlcy5kZXZpY2UgfHwgW107XHJcbiAgICAgICAgLy/lj6rmnInkuIDmnaHmiZPljbDmoLzlvI/vvIzliJnkuI3nlKjlho3pgInmi6nmoLzlvI9cclxuICAgICAgICBpZihmb3JtYXQubGVuZ3RoID09PSAxKXtcclxuICAgICAgICAgIGJlT3B0aW9uc1swXS5Gb3JtYXRJZCA9IGZvcm1hdFswXS5pZDtcclxuICAgICAgICB9XHJcbiAgXHJcbiAgICAgICAgY29uc3QgZmFjdG9yeSA9IHRoYXQucmVzb2x2ZXIucmVzb2x2ZUNvbXBvbmVudEZhY3RvcnkoRm9ybWF0bGlzdGpvYkNvbXBvbmVudCk7XHJcbiAgICAgICAgY29uc3QgcHJpbnRzZXR0aW5nID0gZmFjdG9yeS5jcmVhdGUodGhhdC5pbmplY3Rvcik7XHJcbiAgIFxyXG4gICAgICAgIHByaW50c2V0dGluZy5pbnN0YW5jZS5mb3JtYXRzID0gZm9ybWF0O1xyXG4gICAgICAgIHByaW50c2V0dGluZy5pbnN0YW5jZS5ib3hsaXN0ID0gZGV2aWNlO1xyXG4gICAgICAgIHByaW50c2V0dGluZy5pbnN0YW5jZS5mb3JtYXRJZCA9IGJlT3B0aW9uc1swXS5Gb3JtYXRJZDtcclxuICAgICAgICBwcmludHNldHRpbmcuaW5zdGFuY2UuaXNTaG93Rm9ybWF0ID0gYmVPcHRpb25zWzBdLkZvcm1hdElkP2ZhbHNlOnRydWU7XHJcbiAgICAgICAgcHJpbnRzZXR0aW5nLmluc3RhbmNlLmxvY2FsZXBpcCA9IHRoYXQubG9jYWxwaXBlO1xyXG5cclxuICAgICAgICBjb25zdCBkbGcgPSB0aGlzLm1vZGFsU2VydmljZS5zaG93KHByaW50c2V0dGluZyx7XHJcbiAgICAgICAgICB0aXRsZTogdGhpcy5sb2NhbHBpcGUudHJhbnNmb3JtKCdwcmludHNldCcpLFxyXG4gICAgICAgICAgd2lkdGg6IDgwMCwgXHJcbiAgICAgICAgICBoZWlnaHQ6IDUwMCxcclxuICAgICAgICAgIHNob3dCdXR0b25zOiB0cnVlLFxyXG4gICAgICAgICAgc2hvd01heEJ1dHRvbjpmYWxzZSxcclxuICAgICAgICAgIGJ1dHRvbnM6IFtcclxuICAgICAgICAgICAgeyB0ZXh0OiB0aGlzLmxvY2FscGlwZS50cmFuc2Zvcm0oJ3ByaW50JyksIGNsczogJ2J0biBidG4tcHJpbWFyeScsIGhhbmRsZTogKCkgPT4ge1xyXG4gICAgICAgICAgICAgIHByaW50c2V0dGluZy5pbnN0YW5jZS5wcmludEpvYigpO1xyXG4gICAgICAgICAgICB9fSxcclxuICAgICAgICAgICAgeyB0ZXh0OiB0aGlzLmxvY2FscGlwZS50cmFuc2Zvcm0oJ2NhbmNlbCcpLCBjbHM6ICdidG4gYnRuLXNlY29uZGFyeScsIGhhbmRsZTogKCkgPT4ge1xyXG4gICAgICAgICAgICAgIGRsZy5jbG9zZSgpO1xyXG4gICAgICAgICAgICB9fVxyXG4gICAgICAgICAgXSxcclxuICAgICAgICB9KTsgIFxyXG4gICAgICAgIC8v6K6i6ZiF5LqG5by55Ye655qE5qC85byP6YCJ5oup5YiX6KGo55qE5YWz6Zet5LqL5Lu2XHJcbiAgICAgICAgcHJpbnRzZXR0aW5nLmluc3RhbmNlLnByaW50LnN1YnNjcmliZSgoZGF0YSkgPT4ge1xyXG4gICAgICAgICAgICBkbGcuY2xvc2UoKTtcclxuICAgICAgICAgICAgcmV0dXJuIHRoYXQub3V0cHV0QnlTaW5nbGVTZWxlY3Rpb25Gb3JtYXQoe1xyXG4gICAgICAgICAgICAgICdpZCc6IGRhdGEuaWQsIFxyXG4gICAgICAgICAgICAgICdpc0ZpbHRlcicgOiBmaWx0ZXIsIFxyXG4gICAgICAgICAgICAgICdiZW9wdGlvbnMnOiBPYmplY3QuYXNzaWduKHt9LCBiZU9wdGlvbnNbMF0pLCBcclxuICAgICAgICAgICAgICAnb3B0aW9ucyc6IE9iamVjdC5hc3NpZ24oe30sIG9wdGlvbnMpLFxyXG4gICAgICAgICAgICAgICdpc0pvYic6IHRydWUsXHJcbiAgICAgICAgICAgICAgJ3ByaW50ZXJOYW1lJzpkYXRhLnByaW50dGVyLFxyXG4gICAgICAgICAgICAgICdib3hJZCc6ZGF0YS5ib3hJZCxcclxuICAgICAgICAgICAgICAncHJpbnRTZXR0aW5nJzpkYXRhLnByaW50U2V0dGluZyxcclxuICAgICAgICAgICAgICAnZWxlJzpudWxsfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuXHJcbiAgfVxyXG5cclxuICAvLyDpgInkuobmoLzlvI/lkI7nmoTovpPlh7pcclxuICBwcml2YXRlIG91dHB1dEJ5U2luZ2xlU2VsZWN0aW9uRm9ybWF0KHJlczogYW55KTogYW55e1xyXG4gICAgY29uc29sZS5sb2coJ+mAieWujOagvOW8j+WHhuWkh+a4suafkzogJyArIEpTT04uc3RyaW5naWZ5KHJlcykpO1xyXG4gICAgY29uc3Qgc2VsZiA9IHRoaXM7XHJcblxyXG4gICAgaWYoIXJlcy5pZCl7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICBcclxuICAgIHJlcy5iZW9wdGlvbnMuRm9ybWF0SWQgPSByZXMuaWQ7XHJcbiAgICByZXMub3B0aW9ucy5EZXZpY2VJZCA9IHJlcy5ib3hJZDtcclxuICAgIHJlcy5vcHRpb25zLnByaW50ZXJOYW1lID0gcmVzLnByaW50ZXJOYW1lO1xyXG4gICAgcmVzLm9wdGlvbnMucHJpbnRTZXR0aW5nID0gcmVzLnByaW50U2V0dGluZztcclxuICAgIHJlcy5vcHRpb25zLnByaW50Sm9iID0gcmVzLmlzSm9iO1xyXG5cclxuICAgIGlmKHJlcy5pc0pvYil7Ly/lkI7lj7DmiZPljbBcclxuICAgICAgaWYocmVzLmlzRmlsdGVyID09PSB0cnVlKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZm9ybWF0U3J2LnByaW50U2luZ2xlQnlGaWx0ZXIocmVzLmJlb3B0aW9ucywgcmVzLm9wdGlvbnMsIHJlcy5zdSwnQ2xvdWRQcmludCcpXHJcbiAgICAgICAgLnRoZW4oKCk9PntcclxuICAgICAgICAgIHNlbGYubm90aWZ5U2VydmljZS5zdWNjZXNzKHRoaXMubG9jYWxwaXBlLnRyYW5zZm9ybSgnc2VuZHByaW50am9iJykpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9ZWxzZXtcclxuICAgICAgICByZXR1cm4gdGhpcy5mb3JtYXRTcnYucHJpbnRTaW5nbGVCeUlkKHJlcy5iZW9wdGlvbnMsIHJlcy5vcHRpb25zLCByZXMuc3UsJ0Nsb3VkUHJpbnQnKVxyXG4gICAgICAgIC50aGVuKCgpPT57XHJcbiAgICAgICAgICBzZWxmLm5vdGlmeVNlcnZpY2Uuc3VjY2Vzcyh0aGlzLmxvY2FscGlwZS50cmFuc2Zvcm0oJ3NlbmRwcmludGpvYicpKTtcclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG4gICAgfWVsc2V7Ly/liY3lj7DmiZPljbBcclxuICAgICAgaWYocmVzLmVsZSkgey8v5pyJZWxl77yM5YiZ5byV5pOO6LSf6LSj5riy5p+TXHJcbiAgICAgICAgaWYocmVzLmlzRmlsdGVyID09PSB0cnVlKSB7XHJcbiAgICAgICAgICBpZihyZXMuZWxlPT09J2Rvd25sb2FkJyl7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmZvcm1hdFNydi5wcmludFNpbmdsZUJ5RmlsdGVyKHJlcy5iZW9wdGlvbnMsIHJlcy5vcHRpb25zLCByZXMuc3UsJ0Nsb3VkUHJpbnQnKVxyXG4gICAgICAgICAgICAudGhlbigoZGF0YSkgPT4ge1xyXG4gICAgICAgICAgICAgIHNlbGYuZG93bmxvYWRGaWxlKGRhdGEpOyAgXHJcbiAgICAgICAgICAgIH0pOyBcclxuICAgICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICBzZWxmLm9wZW5SZW5kZWRWaWV3ZXIocmVzLmVsZSxudWxsLHJlcy5vcHRpb25zLFtyZXMuYmVvcHRpb25zXSxyZXMuaXNGaWx0ZXIpO1xyXG4gICAgICAgICAgfSAgXHJcbiAgICAgICAgfSBlbHNlIHsgIFxyXG4gICAgICAgICAgaWYocmVzLmVsZT09PSdkb3dubG9hZCcpe1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5mb3JtYXRTcnYucHJpbnRTaW5nbGVCeUlkKHJlcy5iZW9wdGlvbnMsIHJlcy5vcHRpb25zLCByZXMuc3UsJ0Nsb3VkUHJpbnQnKVxyXG4gICAgICAgICAgICAudGhlbigoZGF0YSkgPT4ge1xyXG4gICAgICAgICAgICAgIHNlbGYuZG93bmxvYWRGaWxlKGRhdGEpOyAgXHJcbiAgICAgICAgICAgIH0pOyBcclxuICAgICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICBzZWxmLm9wZW5SZW5kZWRWaWV3ZXIocmVzLmVsZSxudWxsLHJlcy5vcHRpb25zLFtyZXMuYmVvcHRpb25zXSxyZXMuaXNGaWx0ZXIpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfWVsc2V7Ly/msqHmnIllbGXvvIzliJnlj6rov5Tlm57lkI7lj7DnmoTmuLLmn5Pnu5PmnpzvvIznu5nosIPnlKjmlrnoh6rlt7HlpITnkIZcclxuICAgICAgICBpZihyZXMuZmlsdGVyID09PSB0cnVlKXtcclxuICAgICAgICAgIHJldHVybiB0aGlzLmZvcm1hdFNydi5wcmludFNpbmdsZUJ5RmlsdGVyKHJlcy5iZW9wdGlvbnMsIHJlcy5vcHRpb25zLCByZXMuc3UsJ0Nsb3VkUHJpbnQnKTtcclxuICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgIHJldHVybiB0aGlzLmZvcm1hdFNydi5wcmludFNpbmdsZUJ5SWQocmVzLmJlb3B0aW9ucywgcmVzLm9wdGlvbnMsIHJlcy5zdSwnQ2xvdWRQcmludCcpO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBvdXRwdXRCeU11bHRpU2VsZWN0aW9uRm9ybWF0KHJlczogYW55KTogYW55e1xyXG4gICAgY29uc29sZS5sb2coJ+mAieWujOagvOW8j+WHhuWkh+a4suafkzogJyArIEpTT04uc3RyaW5naWZ5KHJlcykpO1xyXG4gICAgY29uc3Qgc2VsZiA9IHRoaXM7XHJcblxyXG4gICAgcmVzLm9wdGlvbnMuRGV2aWNlSWQgPSByZXMuYm94SWQ7XHJcbiAgICByZXMub3B0aW9ucy5wcmludGVyTmFtZSA9IHJlcy5wcmludGVyTmFtZTtcclxuICAgIHJlcy5vcHRpb25zLnByaW50U2V0dGluZyA9IHJlcy5wcmludFNldHRpbmc7XHJcbiAgICByZXMub3B0aW9ucy5wcmludEpvYiA9IHJlcy5pc0pvYjtcclxuXHJcbiAgICBpZihyZXMuaXNKb2Ipey8v5ZCO5Y+w5omT5Y2wXHJcbiAgICAgIGlmKHJlcy5pc0ZpbHRlciA9PT0gdHJ1ZSkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmZvcm1hdFNydi5wcmludE11bHRpQnlGaWx0ZXIocmVzLmJlb3B0aW9ucywgcmVzLm9wdGlvbnMsIHJlcy5zdSwnQ2xvdWRQcmludCcpXHJcbiAgICAgICAgLnRoZW4oKCk9PntcclxuICAgICAgICAgIHNlbGYubm90aWZ5U2VydmljZS5zdWNjZXNzKHRoaXMubG9jYWxwaXBlLnRyYW5zZm9ybSgnc2VuZHByaW50am9iJykpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9ZWxzZXtcclxuICAgICAgICByZXR1cm4gdGhpcy5mb3JtYXRTcnYucHJpbnRNdWx0aUJ5SWQocmVzLmJlb3B0aW9ucywgcmVzLm9wdGlvbnMsIHJlcy5zdSwnQ2xvdWRQcmludCcpXHJcbiAgICAgICAgLnRoZW4oKCk9PntcclxuICAgICAgICAgIHNlbGYubm90aWZ5U2VydmljZS5zdWNjZXNzKHRoaXMubG9jYWxwaXBlLnRyYW5zZm9ybSgnc2VuZHByaW50am9iJykpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG4gIC8vI2VuZHJlZ2lvblxyXG5cclxuICAvLyNyZWdpb24g5a+55aSW6K6+6K6h5Zmo5ZKM6aKE6KeI5Zmo5o6l5Y+jXHJcblxyXG4gIC8qKlxyXG4gICAqIOWcqOW9k+WJjemhtemdokJvZHnkuIrmiZPlvIBEZXNpZ25lclxyXG4gICAqIEBwYXJhbSBmb3JtYXQg5qC85byPXHJcbiAgICogQHBhcmFtIGRhdGEg5pWw5o2uXHJcbiAgICogQHBhcmFtIGZvcm1hdElkIOagvOW8j2lkXHJcbiAgICogQHBhcmFtIGRhdGFJZHMg5pWw5o2uaWRzXHJcbiAgICovXHJcbiAgb3BlbkRlc2lnbmVyKGZvcm1hdDogc3RyaW5nLCBkYXRhOiBvYmplY3QsIGZvcm1hdElkOiBzdHJpbmcsIGRhdGFJZHM6IHN0cmluZykge1xyXG4gICAgdGhpcy5vcGVuRGVzaWduZXJJbnRlcm5hbCh3aW5kb3cuZG9jdW1lbnQuYm9keSwgZm9ybWF0LCBkYXRhLCBmb3JtYXRJZCwgZGF0YUlkcyk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDlnKjlvZPliY3pobXpnaLnmoTmjIflrprnmoTlhYPntKDkuIrmiZPlvIBEZXNpZ25lclxyXG4gICAqIEBwYXJhbSBlbGUg5oyH5a6a55qE5YWD57SgXHJcbiAgICogQHBhcmFtIGZvcm1hdCDmoLzlvI9cclxuICAgKiBAcGFyYW0gZGF0YSDmlbDmja5cclxuICAgKiBAcGFyYW0gZm9ybWF0SWQg5qC85byPaWRcclxuICAgKiBAcGFyYW0gZGF0YUlkcyDmlbDmja5pZHNcclxuICAgKi9cclxuICBvcGVuRGVzaWduZXJPbkVsZShlbGU6IEhUTUxFbGVtZW50LCBmb3JtYXQ6IHN0cmluZywgZGF0YTogb2JqZWN0LCBmb3JtYXRJZDogc3RyaW5nLCBkYXRhSWRzOiBzdHJpbmcpIHtcclxuICAgIHRoaXMub3BlbkRlc2lnbmVySW50ZXJuYWwoZWxlLCBmb3JtYXQsIGRhdGEsIGZvcm1hdElkLCBkYXRhSWRzKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOWcqOaWsOeahHRhYumhtemdouS4iuaJk+W8gERlc2lnbmVyXHJcbiAgICogQHBhcmFtIGZvcm1hdCDmoLzlvI9cclxuICAgKiBAcGFyYW0gZGF0YSDmlbDmja5cclxuICAgKiBAcGFyYW0gZm9ybWF0SWQg5qC85byPaWRcclxuICAgKiBAcGFyYW0gZGF0YUlkcyDmlbDmja5pZHNcclxuICAgKi9cclxuICBvcGVuRGVzaWduZXJOZXdUYWIoZm9ybWF0OiBzdHJpbmcsIGRhdGE6IG9iamVjdCwgZm9ybWF0SWQ6IHN0cmluZywgZGF0YUlkczogc3RyaW5nKSB7XHJcbiAgICB0aGlzLm9wZW5EZXNpZ25lckludGVybmFsKG51bGwsIGZvcm1hdCwgZGF0YSwgZm9ybWF0SWQsIGRhdGFJZHMpO1xyXG4gIH1cclxuICBcclxuICAvKipcclxuICAgKiDov5DooYzml7blnKjlvZPliY3pobXpnaLnmoTmjIflrprnmoTlhYPntKDkuIrmiZPlvIBEZXNpZ25lclxyXG4gICAqIEBwYXJhbSBlbGUg5oyH5a6a55qE5YWD57SgXHJcbiAgICogQHBhcmFtIGZvcm1hdENvZGUg5qC85byP57yW5Y+3XHJcbiAgICogQHBhcmFtIGZvcm1hdE5hbWUg5qC85byP5ZCN56ewXHJcbiAgICogQHBhcmFtIGJpek9iamVjdElkIOS4muWKoeWvueixoUlkXHJcbiAgICogQHBhcmFtIGRhdGFzb3VyY2VJZCDmlbDmja7mupBJZCwgQkVJZC9WT0lkL0Jlc2luZXNzT2JqZWN0Q2xhc3NJbmZvXHJcbiAgICogQHBhcmFtIHNvdXJjZVR5cGUg5pWw5o2u5rqQ57G75Z6LLCBTb3VyY2VUeXBlLkJFL1NvdXJjZVR5cGUuVk8vU291cmNlVHlwZS5CT1xyXG4gICAqL1xyXG4gIG9wZW5EZXNpZ25lck9uRWxlRm9yUnVudGltZShlbGU6IEhUTUxFbGVtZW50LGZvcm1hdElkOiBzdHJpbmcsIGZvcm1hdENvZGU6IHN0cmluZywgZm9ybWF0TmFtZTogc3RyaW5nLCBiaXpPYmplY3RJZDogc3RyaW5nLCBkYXRhc291cmNlSWQ6IHN0cmluZywgc291cmNlVHlwZTogU291cmNlVHlwZSkge1xyXG4gICAgdGhpcy5wcmludEVudGl0eS5wcmludEZvcm1hdCA9IG5ldyBQcmludEZvcm1hdCgpO1xyXG4gICAgdGhpcy5wcmludEVudGl0eS5pc1VzZU1ldGFEYXRhID0gdHJ1ZTtcclxuXHJcbiAgICBpZihmb3JtYXRJZCAmJiBmb3JtYXRJZC5sZW5ndGg+MCl7XHJcbiAgICAgIC8vIOe8lui+kVxyXG4gICAgICB0aGlzLmZvcm1hdFNydi5nZXROZXdTb3VyY2VGb3JtYXRCeUZvcm1hdElkKGZvcm1hdElkKVxyXG4gICAgICAudGhlbigocmVzKSA9PiB7XHJcbiAgICAgICAgdGhpcy5wcmludEVudGl0eS5wcmludEZvcm1hdCA9IHJlcztcclxuICAgICAgICAvL+aJk+W8gOiuvuiuoeWZqFxyXG4gICAgICAgIHRoaXMub3BlbkRlc2lnbmVyT25FbGUoZWxlLCB0aGlzLnByaW50RW50aXR5LnByaW50Rm9ybWF0LmNvbnRlbnQsIHt9LCAnJywgJycpO1xyXG4gICAgICB9KTtcclxuICAgIH1lbHNle1xyXG4gICAgICAvL+WIneWni+WMllxyXG4gICAgICB0aGlzLmluaXRQcmludEZvcm1hdChkYXRhc291cmNlSWQsIHNvdXJjZVR5cGUpXHJcbiAgICAgIC50aGVuKChyZXMpPT57XHJcbiAgICAgICAgdGhpcy5wcmludEVudGl0eS5wcmludEZvcm1hdC5pZCA9IFV0aWxzLnV1aWQoKTtcclxuICAgICAgICB0aGlzLnByaW50RW50aXR5LnByaW50Rm9ybWF0LmNvZGUgPSBmb3JtYXRDb2RlO1xyXG4gICAgICAgIHRoaXMucHJpbnRFbnRpdHkucHJpbnRGb3JtYXQubmFtZSA9IGZvcm1hdE5hbWU7XHJcblxyXG4gICAgICAgIHRoaXMucHJpbnRFbnRpdHkucHJpbnRGb3JtYXQuYml6T2JqZWN0SWQgPSBiaXpPYmplY3RJZDtcclxuICAgICAgICB0aGlzLnByaW50RW50aXR5LnByaW50Rm9ybWF0LmRhdGFTb3VyY2VJZCA9IGRhdGFzb3VyY2VJZDtcclxuICAgICAgICB0aGlzLnByaW50RW50aXR5LnByaW50Rm9ybWF0LnNvdXJjZVR5cGUgPSBzb3VyY2VUeXBlO1xyXG4gICAgICAgIHRoaXMucHJpbnRFbnRpdHkucHJpbnRGb3JtYXQuaXNVc2VUZW1wbGF0ZSA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMucHJpbnRFbnRpdHkucHJpbnRGb3JtYXQuY29udGVudCA9IHJlcy5mb3JtYXQ7IC8v5omT5Y2w5qC85byPbXJ0ICAgXHJcbiAgICAgICAgdGhpcy5wcmludEVudGl0eS5wcmludEZvcm1hdC5kYXRhU2NoZW1hID0gIHJlcy5wcmludHNjaGVtYTsvL1ByaW50RGF0YVNjaGVtYVZpZXfmj4/ov7AgICBcclxuXHJcbiAgICAgICAgLy/miZPlvIDorr7orqHlmahcclxuICAgICAgICB0aGlzLm9wZW5EZXNpZ25lck9uRWxlKGVsZSwgdGhpcy5wcmludEVudGl0eS5wcmludEZvcm1hdC5jb250ZW50LCB7fSwgJycsICcnKTtcclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDlnKjmjIflrprnmoTlhYPntKDkuIrmiZPlvIBEZXNpZ25lcijliY3nq6/muLLmn5MpXHJcbiAgICogQHBhcmFtIGVsZSDmjIflrprnmoTlhYPntKBcclxuICAgKiBAcGFyYW0gZm9ybWF0IOagvOW8j1xyXG4gICAqIEBwYXJhbSBkYXRhIOaVsOaNrlxyXG4gICAqIEBwYXJhbSBmb3JtYXRJZCDmoLzlvI9pZFxyXG4gICAqIEBwYXJhbSBkYXRhSWRzIOaVsOaNrmlkc1xyXG4gICAqL1xyXG4gIHByaXZhdGUgb3BlbkRlc2lnbmVySW50ZXJuYWwoZWxlOiBIVE1MRWxlbWVudCwgZm9ybWF0OiBzdHJpbmcsIGRhdGE6IG9iamVjdCwgZm9ybWF0SWQ6IHN0cmluZywgZGF0YUlkczogc3RyaW5nKSB7XHJcbiAgICBpZiAoZWxlKSB7XHJcbiAgICAgIHRoaXMucHJpbnRFbnRpdHkuZm9ybWF0ID0gZm9ybWF0O1xyXG4gICAgICB0aGlzLnByaW50RW50aXR5LmRhdGEgPSBkYXRhO1xyXG4gICAgICB0aGlzLnByaW50RW50aXR5LmZvcmFtdElkID0gZm9ybWF0SWQ7XHJcbiAgICAgIHRoaXMucHJpbnRFbnRpdHkuZGF0YUlkID0gZGF0YUlkcztcclxuICAgICAgdGhpcy5jcmVhdGVEZXNpZ25lclJlZigpO1xyXG4gICAgICAvLyDnu5nop4blm77mt7vliqDohI/mo4Dmn6Uo6L+Z5Liq5pa55byP5piv6YWN5ZCIQFZpZXdDaGlsZOeahOaWueazleS9v+eUqOeahClcclxuICAgICAgLy8gdGhpcy5hcHBsaWNhdGlvblJlZi5hdHRhY2hWaWV3KHRoaXMuZGVzaWduZXJjb21wb25lbnRSZWYuaG9zdFZpZXcpO1xyXG4gICAgICAvLyDlsIbliJvlu7rlpb3nmoTnu4Tku7blvJXnlKhhcHBlbmTliLDmjIflrprmoIfnrb7kuItcclxuICAgICAgLy8g6L+Z6YeM5bCG5Yqo5oCB57uE5Lu25Yqg6L295Yiw5oyH5a6a55qEaHRtbOmHjOacieS4pOenjeaWueW8j++8mlxyXG4gICAgICAvLyAgMS7kuIrpnaLnmoRAVmlld0NoaWxcclxuICAgICAgLy8gIDIu5aaC5LiL55qEZWxlLmFwcGVuZENoaWxkKHRoaXMuZ2V0Q29tcG9uZW50Um9vdE5vZGUodGhpcy52aWV3ZXJjb21wb25lbnRSZWYpKTvmlrnlvI9cclxuICAgICAgZWxlLmFwcGVuZENoaWxkKHRoaXMuZ2V0Q29tcG9uZW50Um9vdE5vZGUodGhpcy5kZXNpZ25lcmNvbXBvbmVudFJlZikpOyBcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGNvbnN0IHBhcmFtID0gbmV3IE91dHB1dFBhcmFtKCk7XHJcbiAgICAgIHBhcmFtLnBybkZvcm1hdCA9IGZvcm1hdDtcclxuICAgICAgcGFyYW0ucHJuRGF0YSA9IGRhdGE7XHJcbiAgICAgIHBhcmFtLnBybkZvcm1hdElkID0gZm9ybWF0SWQ7XHJcbiAgICAgIHBhcmFtLnBybkRhdGFJZCA9IGRhdGFJZHM7XHJcbiAgICAgIHBhcmFtLnByblR5cGUgPSBDbXBUeXBlLkRlc2lnbmVyO1xyXG5cclxuICAgICAgdGhpcy5hcHBTZXJ2aWNlLm9wZW5BcHBCeU9wdGlvbnMoe1xyXG4gICAgICAgIGFwcFR5cGU6J2FwcCcsXHJcbiAgICAgICAgZnVuY0lkOicnLFxyXG4gICAgICAgIHRhYk5hbWU6dGhpcy5sb2NhbHBpcGUudHJhbnNmb3JtKCdwcmludGRlc2lnbmVyJyksXHJcbiAgICAgICAgYXBwSWQ6J2Nsb3VkcHJpbnQtdmlldy1pbmRleCcsXHJcbiAgICAgICAgYXBwRW50cmFuY2U6J2Nsb3VkcHJpbnQtdmlldy1pbmRleCcsXHJcbiAgICAgICAgdGFiSWQ6VXRpbHMudXVpZCgpLFxyXG4gICAgICAgIGVudGl0eVBhcmFtczp7XHJcbiAgICAgICAgICBmb3JhbXRQYXJhbTpwYXJhbSxcclxuICAgICAgICAgIGZvcm1hdEVudGl0eTpudWxsLFxyXG4gICAgICAgIH0sXHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog6I635Y+W56m655m95omT5Y2w5qC85byPXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBpbml0UHJpbnRGb3JtYXQoZGF0YXNvdXJjZUlkOiBzdHJpbmcsIHNvdXJjZVR5cGU6IFNvdXJjZVR5cGUpOlByb21pc2U8YW55PntcclxuXHJcbiAgICBpZihzb3VyY2VUeXBlID09PSBTb3VyY2VUeXBlLkJFKVxyXG4gICAge1xyXG4gICAgICAvL2Jv5pWw5o2u5rqQXHJcbiAgICAgIHJldHVybiB0aGlzLmZvcm1hdFNydi5jcmVhdGVQcmludEZvcm1hdFdpdGhCRShkYXRhc291cmNlSWQpO1xyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAoc291cmNlVHlwZSA9PT0gU291cmNlVHlwZS5WTykgXHJcbiAgICB7XHJcbiAgICAgIC8vIHZv5pWw5o2u5rqQXHJcbiAgICAgIHJldHVybiB0aGlzLmZvcm1hdFNydi5jcmVhdGVQcmludEZvcm1hdFdpdGhWTyhkYXRhc291cmNlSWQpO1xyXG4gICAgfVxyXG4gICAgZWxzZVxyXG4gICAge1xyXG4gICAgICAvLyDpu5jorqTnlKhCReaVsOaNrua6kFxyXG4gICAgICByZXR1cm4gdGhpcy5mb3JtYXRTcnYuY3JlYXRlUHJpbnRGb3JtYXRXaXRoQk8oZGF0YXNvdXJjZUlkKTtcclxuICAgIH0gIFxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog5Yib5bu6RGVzaWduZXLmnoTku7bnmoTlvJXnlKjlr7nosaFcclxuICAgKi9cclxuICBwcml2YXRlIGNyZWF0ZURlc2lnbmVyUmVmKCk6IHZvaWQge1xyXG5cclxuICAgIGNvbnN0IGZhY3RvcnkgPSB0aGlzLnJlc29sdmVyLnJlc29sdmVDb21wb25lbnRGYWN0b3J5KENsb3VkcHJpbnREZXNpZ25lckNvbXBvbmVudCk7XHJcbiAgICBpZiAoIXRoaXMudmlld0NvbnRhaW5lcikge1xyXG4gICAgICB0aGlzLmRlc2lnbmVyY29tcG9uZW50UmVmID0gZmFjdG9yeS5jcmVhdGUodGhpcy5pbmplY3Rvcik7XHJcbiAgICAgIHRoaXMuYXBwbGljYXRpb25SZWYuYXR0YWNoVmlldyh0aGlzLmRlc2lnbmVyY29tcG9uZW50UmVmLmhvc3RWaWV3KTtcclxuXHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLnZpZXdDb250YWluZXIuY2xlYXIoKTtcclxuICAgICAgdGhpcy5kZXNpZ25lcmNvbXBvbmVudFJlZiA9IHRoaXMudmlld0NvbnRhaW5lci5jcmVhdGVDb21wb25lbnQoZmFjdG9yeSk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8g5ZCM5q2l57uE5Lu25ZKM57uE5Lu25LiK5L6d6LWW55qE5pyN5Yqh55qEcHJpbnRFbnRpdHlcclxuICAgIHRoaXMuZGVzaWduZXJjb21wb25lbnRSZWYuaW5zdGFuY2Uuc2V0UHJpbnRFbnRpdHkodGhpcy5wcmludEVudGl0eSk7XHJcbiAgICAvLyB0aGlzLmRlc2lnbmVyY29tcG9uZW50UmVmLmluc3RhbmNlLmxvY2FsZWlkID0gdGhpcy5sb2NhbGVpZDtcclxuXHJcbiAgICAvLyDorqLpmIXpgIDlh7rkuovku7ZcclxuICAgIHRoaXMuZGVzaWduZXJjb21wb25lbnRSZWYuaW5zdGFuY2UucHJpbnRFbnRpdHkub25FeGl0RXZlbnQuc3Vic2NyaWJlKChlKSA9PiB7XHJcbiAgICAgIHRoaXMuZGVzaWduZXJjb21wb25lbnRSZWYuZGVzdHJveSgpO1xyXG4gICAgICBpZiAoIXRoaXMudmlld0NvbnRhaW5lcikge1xyXG4gICAgICAgIHRoaXMuYXBwbGljYXRpb25SZWYuZGV0YWNoVmlldyh0aGlzLmRlc2lnbmVyY29tcG9uZW50UmVmLmhvc3RWaWV3KTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICB0aGlzLnZpZXdDb250YWluZXIuY2xlYXIoKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDmiZPlvIDlt7Lnu4/muLLmn5PnmoRWaWV3ZXLvvIjlkI7nq6/muLLmn5PvvIlcclxuICAgKiBAcGFyYW0gZWxlIOaMh+WumueahOWFg+e0oFxyXG4gICAqIEBwYXJhbSBkYXRhIOW3sue7j+a4suafk+eahOagvOW8jyjlkI7nq6/muLLmn5PmmK9wZGbnmoTkuozov5vliLbmtYEpXHJcbiAgICovXHJcbiAgb3BlblJlbmRlZFZpZXdlcihlbGU6IGFueSwgZGF0YTogYW55LCBvcHRpb25zOiBPdXRwdXRPcHRpb25zLHNvdXJjZU9wdGlvbnM6IEFycmF5PEJhc2VTb3VyY2VPcHRpb25zPj1udWxsLGlzRmlsdGVyOmJvb2xlYW49ZmFsc2UscHJpbnRFbnRpdHk6UHJpbnRFbnRpdHk9bnVsbCxwYXJhbTphbnk9bnVsbCkge1xyXG4gICAgXHJcbiAgICBpZihwcmludEVudGl0eSE9bnVsbCl7Ly/nlKjlpJbnlYznmoRwcmludEVudGl0eeWxnuaAp+imhuebluW9k+WJjeeahHByaW50RW50aXR555qE5bGe5oCnXHJcbiAgICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTpmb3JpblxyXG4gICAgICBmb3IgKGNvbnN0IGtleSBpbiBwcmludEVudGl0eSkge1xyXG4gICAgICAgIHRoaXMucHJpbnRFbnRpdHlba2V5XSA9IHByaW50RW50aXR5W2tleV07XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBpZihkYXRhKXsvL+aVsOaNruW3sua4suafk++8jOebtOaOpeaJk+WNsO+8jOS4jeWtmOWcqOWQjuWPsOaJk+WNsOS6hlxyXG4gICAgICB0aGlzLnByZVZpZXdMb2NhbChlbGUsZGF0YSxvcHRpb25zLHNvdXJjZU9wdGlvbnMscHJpbnRFbnRpdHksaXNGaWx0ZXIscGFyYW0pO1xyXG4gICAgfWVsc2V7XHJcbiAgICAgIHRoaXMucHJlVmlld1JlbW90ZShlbGUsb3B0aW9ucyxzb3VyY2VPcHRpb25zLGlzRmlsdGVyLHByaW50RW50aXR5LHBhcmFtKTtcclxuICAgIH1cclxuXHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDmiZPlvIDlt7Lnu4/muLLmn5PnmoRWaWV3ZXLvvIjlkI7nq6/muLLmn5Ms57uZ6ZmE5Lu255So55qE77yJXHJcbiAgICogQHBhcmFtIGVsZSDmjIflrprnmoTlhYPntKBcclxuICAgKiBAcGFyYW0gZGF0YSDlt7Lnu4/muLLmn5PnmoTmoLzlvI8o5ZCO56uv5riy5p+T5pivcGRm55qE5LqM6L+b5Yi25rWBKVxyXG4gICAqL1xyXG4gIG9wZW5SZW5kZWRWaWV3ZXI0QXR0YWNobWVudChlbGU6IGFueSwgZGF0YTogYW55LCBvcHRpb25zOiBPdXRwdXRPcHRpb25zKSB7XHJcbiAgICBcclxuICAgIHRoaXMub3BlblJlbmRlZFZpZXdlcihlbGUsZGF0YSxvcHRpb25zLG51bGwsZmFsc2UsdGhpcy5wcmludEVudGl0eSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDmnKzlnLDnm7TmjqXmiZPljbBcclxuICAgKi9cclxuICBwcml2YXRlIHByZVZpZXdMb2NhbChlbGU6IGFueSwgZGF0YTogYW55LCBvcHRpb25zOiBPdXRwdXRPcHRpb25zLHNvdXJjZU9wdGlvbnM6IEFycmF5PEJhc2VTb3VyY2VPcHRpb25zPj1udWxsLHByaW50RW50aXR5OlByaW50RW50aXR5PW51bGwsaXNGaWx0ZXI6Ym9vbGVhbixwYXJhbTphbnk9bnVsbCl7XHJcbiAgICBjb25zdCBzZWxmID0gdGhpcztcclxuXHJcbiAgICBjb25zdCBiID0gbmV3IEJsb2IoW2RhdGFdKTtcclxuICAgIGNvbnN0IHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7XHJcbiAgICByZWFkZXIucmVhZEFzQXJyYXlCdWZmZXIoYik7XHJcbiAgICByZWFkZXIub25sb2FkID0gYXN5bmMgZnVuY3Rpb24gKGUpIHtcclxuICAgICAgY29uc3QgcmVuZGVkRm9ybWF0ID0gcmVhZGVyLnJlc3VsdCBhcyBhbnk7XHJcbiAgICAgIGNvbnN0IHBhcmFtID0gbmV3IE91dHB1dFBhcmFtKCk7XHJcbiAgICAgIHBhcmFtLnByblJlbmRlZEZvcm1hdCA9IGJ0b2EobmV3IFVpbnQ4QXJyYXkocmVuZGVkRm9ybWF0KSBhcyBhbnkpO1xyXG4gICAgICBwYXJhbS5wcm5UeXBlID0gQ21wVHlwZS5WaWV3ZXI7XHJcbiAgICAgIHBhcmFtLnBybk91dHB1dE9wcyA9IE9iamVjdC5hc3NpZ24oe30sb3B0aW9ucyk7XHJcbiAgICAgIHBhcmFtLnByblNvdXJjZU9wdGlvbnMgPSBzb3VyY2VPcHRpb25zP1suLi5zb3VyY2VPcHRpb25zXTpbXTtcclxuICAgICAgcGFyYW0uaXNGaWx0ZXIgPSBpc0ZpbHRlcjtcclxuXHJcbiAgICAgIGlmIChlbGUgPT09ICd0YWInKSB7XHJcbiAgICAgICAgc2VsZi5hcHBTZXJ2aWNlLm9wZW5BcHBCeU9wdGlvbnMoe1xyXG4gICAgICAgICAgYXBwVHlwZTonYXBwJyxcclxuICAgICAgICAgIGZ1bmNJZDonJyxcclxuICAgICAgICAgIHRhYk5hbWU6c2VsZi5sb2NhbHBpcGUudHJhbnNmb3JtKCdwcmludHZpZXcnKSxcclxuICAgICAgICAgIGFwcElkOidjbG91ZHByaW50LXZpZXctaW5kZXgnLFxyXG4gICAgICAgICAgYXBwRW50cmFuY2U6J2Nsb3VkcHJpbnQtdmlldy1pbmRleCcsXHJcbiAgICAgICAgICB0YWJJZDpVdGlscy51dWlkKCksXHJcbiAgICAgICAgICBlbnRpdHlQYXJhbXM6e1xyXG4gICAgICAgICAgICBmb3JhbXRQYXJhbTpwYXJhbSxcclxuICAgICAgICAgICAgZm9ybWF0RW50aXR5Om51bGwsXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGNvbnN0IHJlbW90ZVByaW50ID0gYXdhaXQgc2VsZi5mb3JtYXRTcnYuaXNSZW1vdGVQcmludCgpO1xyXG4gICAgICAgIHNlbGYuY3JlYXRlVmlld2VyUmVmKCk7ICAgICAgICBcclxuICAgICAgICBzZWxmLnByaW50RW50aXR5LnJlbmRlZEZvcm1hdCA9IHJlbmRlZEZvcm1hdDtcclxuICAgICAgICBzZWxmLnZpZXdlcmNvbXBvbmVudFJlZi5pbnN0YW5jZS5vdXRwdXRQYXJhbSA9IHBhcmFtO1xyXG4gICAgICAgIHNlbGYudmlld2VyY29tcG9uZW50UmVmLmluc3RhbmNlLmlzUmVtb3RlUHJpbnQgPSByZW1vdGVQcmludDtcclxuICAgICAgICBlbGUuYXBwZW5kQ2hpbGQoc2VsZi5nZXRDb21wb25lbnRSb290Tm9kZShzZWxmLnZpZXdlcmNvbXBvbmVudFJlZikpO1xyXG4gICAgICB9XHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog6L+c56iL5omT5Y2wXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBhc3luYyBwcmVWaWV3UmVtb3RlKGVsZTogYW55LCBvcHRpb25zOiBPdXRwdXRPcHRpb25zLHNvdXJjZU9wdGlvbnM6IEFycmF5PEJhc2VTb3VyY2VPcHRpb25zPj1udWxsLGlzRmlsdGVyOmJvb2xlYW4scHJpbnRFbnRpdHk6UHJpbnRFbnRpdHk9bnVsbCxwYXJhbTphbnk9bnVsbCl7XHJcbiAgICBjb25zdCBzZWxmID0gdGhpcztcclxuXHJcbiAgICBjb25zdCBvdXRwdXRwYXJhbSA9IG5ldyBPdXRwdXRQYXJhbSgpO1xyXG4gICAgb3V0cHV0cGFyYW0ucHJuVHlwZSA9IENtcFR5cGUuVmlld2VyO1xyXG4gICAgb3V0cHV0cGFyYW0ucHJuT3V0cHV0T3BzID0gT2JqZWN0LmFzc2lnbih7fSxvcHRpb25zKTtcclxuICAgIG91dHB1dHBhcmFtLnByblNvdXJjZU9wdGlvbnMgPVsuLi5zb3VyY2VPcHRpb25zXTtcclxuICAgIG91dHB1dHBhcmFtLmlzRmlsdGVyID0gaXNGaWx0ZXI7XHJcbiAgICBpZiAoZWxlID09PSAndGFiJykge1xyXG5cclxuICAgICAgc2VsZi5hcHBTZXJ2aWNlLm9wZW5BcHBCeU9wdGlvbnMoe1xyXG4gICAgICAgIGFwcFR5cGU6J2FwcCcsXHJcbiAgICAgICAgZnVuY0lkOicnLFxyXG4gICAgICAgIHRhYk5hbWU6c2VsZi5sb2NhbHBpcGUudHJhbnNmb3JtKCdwcmludHZpZXcnKSxcclxuICAgICAgICBhcHBJZDonY2xvdWRwcmludC12aWV3LWluZGV4JyxcclxuICAgICAgICBhcHBFbnRyYW5jZTonY2xvdWRwcmludC12aWV3LWluZGV4JyxcclxuICAgICAgICB0YWJJZDpVdGlscy51dWlkKCksXHJcbiAgICAgICAgZW50aXR5UGFyYW1zOntcclxuICAgICAgICAgIGZvcmFtdFBhcmFtOm91dHB1dHBhcmFtLFxyXG4gICAgICAgICAgZm9ybWF0RW50aXR5Om51bGwsXHJcbiAgICAgICAgfSxcclxuICAgICAgfSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBjb25zdCByZW1vdGVQcmludCA9IGF3YWl0IHNlbGYuZm9ybWF0U3J2LmlzUmVtb3RlUHJpbnQoKTtcclxuICAgICAgc2VsZi5jcmVhdGVWaWV3ZXJSZWYoKTtcclxuICAgICAgc2VsZi52aWV3ZXJjb21wb25lbnRSZWYuaW5zdGFuY2Uub3V0cHV0UGFyYW0gPSBvdXRwdXRwYXJhbTtcclxuICAgICAgc2VsZi52aWV3ZXJjb21wb25lbnRSZWYuaW5zdGFuY2UuaXNSZW1vdGVQcmludCA9IHJlbW90ZVByaW50O1xyXG4gICAgICBlbGUuYXBwZW5kQ2hpbGQoc2VsZi5nZXRDb21wb25lbnRSb290Tm9kZShzZWxmLnZpZXdlcmNvbXBvbmVudFJlZikpO1xyXG4gICAgfVxyXG5cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOWIm+W7ulZpZXdlcuaehOS7tueahOW8leeUqOWvueixoVxyXG4gICAqL1xyXG4gIHByaXZhdGUgY3JlYXRlVmlld2VyUmVmKCk6IHZvaWQge1xyXG5cclxuICAgIGNvbnN0IGZhY3RvcnkgPSB0aGlzLnJlc29sdmVyLnJlc29sdmVDb21wb25lbnRGYWN0b3J5KENsb3VkcHJpbnRWaWV3ZXJDb21wb25lbnQpO1xyXG4gICAgaWYgKCF0aGlzLnZpZXdDb250YWluZXIpIHtcclxuICAgICAgdGhpcy52aWV3ZXJjb21wb25lbnRSZWYgPSBmYWN0b3J5LmNyZWF0ZSh0aGlzLmluamVjdG9yKTtcclxuICAgICAgdGhpcy5hcHBsaWNhdGlvblJlZi5hdHRhY2hWaWV3KHRoaXMudmlld2VyY29tcG9uZW50UmVmLmhvc3RWaWV3KTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMudmlld0NvbnRhaW5lci5jbGVhcigpO1xyXG4gICAgICB0aGlzLnZpZXdlcmNvbXBvbmVudFJlZiA9IHRoaXMudmlld0NvbnRhaW5lci5jcmVhdGVDb21wb25lbnQoZmFjdG9yeSk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8g5ZCM5q2l57uE5Lu25ZKM57uE5Lu25LiK5L6d6LWW55qE5pyN5Yqh55qEcHJpbnRFbnRpdHlcclxuICAgIHRoaXMudmlld2VyY29tcG9uZW50UmVmLmluc3RhbmNlLnNldFByaW50RW50aXR5KHRoaXMucHJpbnRFbnRpdHkpO1xyXG4gICAgdGhpcy52aWV3ZXJjb21wb25lbnRSZWYuaW5zdGFuY2UubG9jYWxwaXBlID0gdGhpcy5sb2NhbHBpcGU7XHJcbiAgICAvLyDorqLpmIXpgIDlh7rkuovku7ZcclxuICAgIHRoaXMudmlld2VyY29tcG9uZW50UmVmLmluc3RhbmNlLnByaW50RW50aXR5Lm9uRXhpdEV2ZW50LnN1YnNjcmliZSgoZSkgPT4ge1xyXG4gICAgICB0aGlzLnZpZXdlcmNvbXBvbmVudFJlZi5kZXN0cm95KCk7XHJcbiAgICAgIGlmICghdGhpcy52aWV3Q29udGFpbmVyKSB7XHJcbiAgICAgICAgdGhpcy5hcHBsaWNhdGlvblJlZi5kZXRhY2hWaWV3KHRoaXMudmlld2VyY29tcG9uZW50UmVmLmhvc3RWaWV3KTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICB0aGlzLnZpZXdDb250YWluZXIuY2xlYXIoKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDlsIZDb21wb25lbnRSZWbnsbvlnovnmoTnu4Tku7blvJXnlKjovazmjaLkuLpET03oioLngrnvvIjlj4LogIPoh6pNYXRlcmlhbDLvvIlcclxuICAgKiBAcGFyYW0gY3BSZWYg57uE5Lu255qE5byV55So5a+56LGhXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBnZXRDb21wb25lbnRSb290Tm9kZShjcFJlZjogQ29tcG9uZW50UmVmPGFueT4pOiBIVE1MRWxlbWVudCB7XHJcbiAgICByZXR1cm4gKGNwUmVmLmhvc3RWaWV3IGFzIEVtYmVkZGVkVmlld1JlZjxhbnk+KS5yb290Tm9kZXNbMF0gYXMgSFRNTEVsZW1lbnQ7XHJcbiAgfVxyXG4gIC8vI2VuZHJlZ2lvblxyXG5cclxuICAvLyNyZWdpb24g5a+55aSW5omT5Y2w5pyN5Yqh5o6l5Y+jXHJcbiAgLyoqXHJcbiAgICog5Y2V5qC85byP5pWw5o2uaWTmiZPljbBcclxuICAgKiBzde+8muWPjOagiOaooeW8j+S4i25naW546Lev55Sx55qEc3VcclxuICAgKiBcclxuICAgKiAxLuW4pue7tOW6pui/h+a7pOagvOW8j+mAieaLqeWZqFxyXG4gICAqL1xyXG4gIHByaW50U2luZ2xlQnlJZChiZW9wdGlvbnM6IFNvdXJjZU9wdGlvbnMsIG9wdGlvbnM6IE91dHB1dE9wdGlvbnMsIGVsZTogYW55LHN1PW51bGwscGFyYW09bnVsbCk6IGFueSB7XHJcbiAgICBpZihEYXRhVmFsaWRhdG9yLmNoZWNrQXBwVXJsKHRoaXMucHJpbnRFbnRpdHkuYXBwVXJsKT09ZmFsc2Upe1xyXG4gICAgICB0aGlzLm5vdGlmeVNlcnZpY2UuaW5mbyh0aGlzLmxvY2FscGlwZS50cmFuc2Zvcm0oJ2FwcHVybGVycm9yJykpO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcblxyXG4gICAgaWYoYmVvcHRpb25zLnF1ZXJ5VHlwZT09dW5kZWZpbmVkKXsvL+WFvOWuueS7peWJjeeahOmAu+i+kVxyXG4gICAgICBiZW9wdGlvbnMucXVlcnlUeXBlID0gUXVlcnlUeXBlLlVua25vd247XHJcbiAgICB9XHJcbiAgICBpZihvcHRpb25zLnByaW50VHlwZT09dW5kZWZpbmVkKXsvL+WFvOWuueS7peWJjeeahOmAu+i+kei/memHjOm7mOiupOS4uuihqOWNleaJk+WNsFxyXG4gICAgICBvcHRpb25zLnByaW50VHlwZSA9IFByaW50VHlwZS5Gb3JtO1xyXG4gICAgfVxyXG5cclxuICAgIC8v5LiO6KGo5Y2V6ZuG5oiQ5pe277yM6KGo5Y2V5omT5Y2w5pe25pyJ5aSa5Liq5omT5Y2w5qC85byP77yM6ZyA6KaB6YCJ5oup77yM6L+Z5pe25YCZ5qC85byPaWTmmK/nqbrnmoRcclxuICAgIGlmKGJlb3B0aW9ucy5Gb3JtYXRJZCA9PSB1bmRlZmluZWQgfHwgYmVvcHRpb25zLkZvcm1hdElkID09ICcnKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLm9wZW5Gb3JtYXRMaXN0QnlEaW1lbnNpb24oYmVvcHRpb25zLCBvcHRpb25zLCBlbGUsIGZhbHNlKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGlmIChlbGUpIHtcclxuICAgICAgICBjb25zdCBzZWxmID0gdGhpcztcclxuICAgICAgICBpZihlbGU9PT0nZG93bmxvYWQnKXtcclxuICAgICAgICAgIHJldHVybiB0aGlzLmZvcm1hdFNydi5wcmludFNpbmdsZUJ5SWQoYmVvcHRpb25zLCBvcHRpb25zLHN1LCAnQ2xvdWRQcmludCcpXHJcbiAgICAgICAgICAudGhlbigoZGF0YSkgPT4ge1xyXG4gICAgICAgICAgICBzZWxmLmRvd25sb2FkRmlsZShkYXRhKTsgXHJcbiAgICAgICAgICB9KTsgXHJcbiAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICBzZWxmLm9wZW5SZW5kZWRWaWV3ZXIoZWxlLG51bGwsb3B0aW9ucyxbYmVvcHRpb25zXSxmYWxzZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmZvcm1hdFNydi5wcmludFNpbmdsZUJ5SWQoYmVvcHRpb25zLCBvcHRpb25zLHN1LCAnQ2xvdWRQcmludCcpO1xyXG4gICAgICB9ICAgICAgXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDljZXmoLzlvI/ov4fmu6TlmajmiZPljbBcclxuICAgKiBzde+8muWPjOagiOaooeW8j+S4i25naW546Lev55Sx55qEc3VcclxuICAgKiBcclxuICAgKiAxLuW4pue7tOW6pui/h+a7pOagvOW8j+mAieaLqeWZqFxyXG4gICAqL1xyXG4gIHByaW50U2luZ2xlQnlGaWx0ZXIoYmVGaWx0ZXJvcHRpb25zOiBTb3VyY2VGaWx0ZXJPcHRpb25zLCBvcHRpb25zOiBPdXRwdXRPcHRpb25zLCBlbGU6IGFueSxzdT1udWxsLHBhcmFtPW51bGwpOiBhbnkge1xyXG4gICAgaWYoRGF0YVZhbGlkYXRvci5jaGVja0FwcFVybCh0aGlzLnByaW50RW50aXR5LmFwcFVybCk9PWZhbHNlKXtcclxuICAgICAgdGhpcy5ub3RpZnlTZXJ2aWNlLmluZm8odGhpcy5sb2NhbHBpcGUudHJhbnNmb3JtKCdhcHB1cmxlcnJvcicpKTtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBpZihiZUZpbHRlcm9wdGlvbnMucXVlcnlUeXBlPT11bmRlZmluZWQpey8v5YW85a655Lul5YmN55qE6YC76L6RXHJcbiAgICAgIGJlRmlsdGVyb3B0aW9ucy5xdWVyeVR5cGUgPSBRdWVyeVR5cGUuVW5rbm93bjtcclxuICAgIH1cclxuICAgIGlmKG9wdGlvbnMucHJpbnRUeXBlPT11bmRlZmluZWQpey8v5YW85a655Lul5YmN55qE6YC76L6R6L+Z6YeM6buY6K6k5Li66KGo5Y2V5omT5Y2wXHJcbiAgICAgIG9wdGlvbnMucHJpbnRUeXBlID0gUHJpbnRUeXBlLkZvcm07XHJcbiAgICB9XHJcblxyXG4gICAgLy/kuI7ooajljZXpm4bmiJDml7bvvIzooajljZXmiZPljbDml7bmnInlpJrkuKrmiZPljbDmoLzlvI/vvIzpnIDopoHpgInmi6nvvIzov5nml7blgJnmoLzlvI9pZOaYr+epuueahFxyXG4gICAgaWYoYmVGaWx0ZXJvcHRpb25zLkZvcm1hdElkID09IHVuZGVmaW5lZCB8fCBiZUZpbHRlcm9wdGlvbnMuRm9ybWF0SWQgPT0gJycpIHtcclxuICAgICAgcmV0dXJuIHRoaXMub3BlbkZvcm1hdExpc3RCeURpbWVuc2lvbihiZUZpbHRlcm9wdGlvbnMsIG9wdGlvbnMsIGVsZSwgdHJ1ZSk7XHJcbiAgICB9IGVsc2UgIHtcclxuICAgICAgaWYgKGVsZSkge1xyXG4gICAgICAgIGNvbnN0IHNlbGYgPSB0aGlzO1xyXG4gICAgICAgIGlmKGVsZT09PSdkb3dubG9hZCcpe1xyXG4gICAgICAgICAgcmV0dXJuIHRoaXMuZm9ybWF0U3J2LnByaW50U2luZ2xlQnlGaWx0ZXIoYmVGaWx0ZXJvcHRpb25zLCBvcHRpb25zLHN1LCAnQ2xvdWRQcmludCcpXHJcbiAgICAgICAgICAudGhlbigoZGF0YSkgPT4ge1xyXG4gICAgICAgICAgICBzZWxmLmRvd25sb2FkRmlsZShkYXRhKTtcclxuICAgIFxyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICBzZWxmLm9wZW5SZW5kZWRWaWV3ZXIoZWxlLG51bGwsb3B0aW9ucyxbYmVGaWx0ZXJvcHRpb25zXSx0cnVlKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZm9ybWF0U3J2LnByaW50U2luZ2xlQnlGaWx0ZXIoYmVGaWx0ZXJvcHRpb25zLCBvcHRpb25zLCBzdSwnQ2xvdWRQcmludCcpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDlpJrmoLzlvI/mlbDmja5pZOaJk+WNsFxyXG4gICAqIHN177ya5Y+M5qCI5qih5byP5LiLbmdpbnjot6/nlLHnmoRzdVxyXG4gICAqIFxyXG4gICAqIFRPRE86IOebruWJjeS4jeW4puagvOW8j+mAieaLqeWZqCzpnIDopoHlpJbnlYznu4Tnu4flpb3moLzlvI/lkozmlbDmja7nmoTlr7nlupTlhbPns7tcclxuICAgKi9cclxuICBwcmludE11bHRpQnlJZChiZU9wdGlvbnNMaXN0OiBBcnJheTxTb3VyY2VPcHRpb25zPiwgb3B0aW9uczogT3V0cHV0T3B0aW9ucyxlbGU6IGFueSwgc3U9bnVsbCwgcGFyYW09bnVsbCk6IGFueXtcclxuICAgIGZvcihsZXQgaT0wOyBpPCBiZU9wdGlvbnNMaXN0Lmxlbmd0aDtpKyspe1xyXG4gICAgICBEYXRhVmFsaWRhdG9yLmNoZWNrRm9yTnVsbFJlZmVyZW5jZShiZU9wdGlvbnNMaXN0W2ldLnF1ZXJ5VHlwZSwncXVlcnlUeXBlJyk7XHJcbiAgICB9XHJcblxyXG4gICAgRGF0YVZhbGlkYXRvci5jaGVja0Zvck51bGxSZWZlcmVuY2Uob3B0aW9ucy5wcmludFR5cGUsJ3ByaW50VHlwZScpO1xyXG5cclxuICAgIGlmKERhdGFWYWxpZGF0b3IuY2hlY2tBcHBVcmwodGhpcy5wcmludEVudGl0eS5hcHBVcmwpPT1mYWxzZSl7XHJcbiAgICAgIHRoaXMubm90aWZ5U2VydmljZS5pbmZvKHRoaXMubG9jYWxwaXBlLnRyYW5zZm9ybSgnYXBwdXJsZXJyb3InKSk7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuXHJcbiAgICBpZihlbGUpe1xyXG4gICAgICBjb25zdCBzZWxmID0gdGhpcztcclxuICAgICAgaWYoZWxlPT09J2Rvd25sb2FkJyl7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZm9ybWF0U3J2LnByaW50TXVsdGlCeUlkKGJlT3B0aW9uc0xpc3Qsb3B0aW9ucyxzdSwnQ2xvdWRQcmludCcpXHJcbiAgICAgICAgLnRoZW4oKGRhdGEpID0+IHtcclxuICAgICAgICAgIHRoaXMuZG93bmxvYWRGaWxlKGRhdGEpO1xyXG4gICAgICAgIH0pOyBcclxuICAgICAgfWVsc2V7XHJcbiAgICAgICAgc2VsZi5vcGVuUmVuZGVkVmlld2VyKGVsZSwgbnVsbCwgb3B0aW9ucyxiZU9wdGlvbnNMaXN0LGZhbHNlKTtcclxuICAgICAgfVxyXG4gICAgfWVsc2V7XHJcbiAgICAgIHJldHVybiB0aGlzLmZvcm1hdFNydi5wcmludE11bHRpQnlJZChiZU9wdGlvbnNMaXN0LG9wdGlvbnMsc3UsJ0Nsb3VkUHJpbnQnKTtcclxuICAgIH1cclxuXHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDlpJrmoLzlvI/ov4fmu6TlmajmiZPljbBcclxuICAgKiBzde+8muWPjOagiOaooeW8j+S4i25naW546Lev55Sx55qEc3VcclxuICAgKiBcclxuICAgKiBUT0RPOiDnm67liY3kuI3luKbmoLzlvI/pgInmi6nlmags6ZyA6KaB5aSW55WM57uE57uH5aW95qC85byP5ZKM5pWw5o2u55qE5a+55bqU5YWz57O7XHJcbiAgICovXHJcbiAgcHJpbnRNdWx0aUJ5RmlsdGVyKGJlT3B0aW9uc0xpc3Q6IEFycmF5PFNvdXJjZUZpbHRlck9wdGlvbnM+LCBvcHRpb25zOiBPdXRwdXRPcHRpb25zLCBlbGU6IGFueSxzdT1udWxsLCBwYXJhbT1udWxsKTogYW55e1xyXG4gICAgZm9yKGxldCBpPTA7IGk8IGJlT3B0aW9uc0xpc3QubGVuZ3RoO2krKyl7XHJcbiAgICAgIERhdGFWYWxpZGF0b3IuY2hlY2tGb3JOdWxsUmVmZXJlbmNlKGJlT3B0aW9uc0xpc3RbaV0ucXVlcnlUeXBlLCdxdWVyeVR5cGUnKTtcclxuICAgIH1cclxuXHJcbiAgICBEYXRhVmFsaWRhdG9yLmNoZWNrRm9yTnVsbFJlZmVyZW5jZShvcHRpb25zLnByaW50VHlwZSwncHJpbnRUeXBlJyk7XHJcbiAgICBpZihEYXRhVmFsaWRhdG9yLmNoZWNrQXBwVXJsKHRoaXMucHJpbnRFbnRpdHkuYXBwVXJsKSA9PSBmYWxzZSl7XHJcbiAgICAgIHRoaXMubm90aWZ5U2VydmljZS5pbmZvKHRoaXMubG9jYWxwaXBlLnRyYW5zZm9ybSgnYXBwdXJsZXJyb3InKSk7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIGlmKGVsZSl7XHJcbiAgICAgIGNvbnN0IHNlbGYgPSB0aGlzO1xyXG4gICAgICBpZihlbGU9PT0nZG93bmxvYWQnKXtcclxuICAgICAgICByZXR1cm4gdGhpcy5mb3JtYXRTcnYucHJpbnRNdWx0aUJ5RmlsdGVyKGJlT3B0aW9uc0xpc3Qsb3B0aW9ucyxzdSwnQ2xvdWRQcmludCcpXHJcbiAgICAgICAgLnRoZW4oKGRhdGEpID0+IHtcclxuICAgICAgICAgIHRoaXMuZG93bmxvYWRGaWxlKGRhdGEpO1xyXG4gICAgICAgIH0pOyAgXHJcbiAgICAgIH1lbHNle1xyXG4gICAgICAgIHNlbGYub3BlblJlbmRlZFZpZXdlcihlbGUsIG51bGwsIG9wdGlvbnMsYmVPcHRpb25zTGlzdCx0cnVlKTtcclxuICAgICAgfVxyXG4gICBcclxuICAgIH1lbHNle1xyXG4gICAgICByZXR1cm4gdGhpcy5mb3JtYXRTcnYucHJpbnRNdWx0aUJ5RmlsdGVyKGJlT3B0aW9uc0xpc3Qsb3B0aW9ucyxzdSwnQ2xvdWRQcmludCcpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog5Y2V5qC85byP5pWw5o2uaWTmiZPljbBcclxuICAgKiBzde+8muWPjOagiOaooeW8j+S4i25naW546Lev55Sx55qEc3VcclxuICAgKiBcclxuICAgKiAxLuW4pue7tOW6pui/h+a7pOagvOW8j+mAieaLqeWZqFxyXG4gICAqL1xyXG4gIHByaW50U2luZ2xlQnlJZDRKb2IoYmVvcHRpb25zOiBTb3VyY2VPcHRpb25zLCBvcHRpb25zOiBPdXRwdXRPcHRpb25zLHN1PW51bGwscGFyYW09bnVsbCk6IGFueSB7XHJcbiAgICBpZihEYXRhVmFsaWRhdG9yLmNoZWNrQXBwVXJsKHRoaXMucHJpbnRFbnRpdHkuYXBwVXJsKT09ZmFsc2Upe1xyXG4gICAgICB0aGlzLm5vdGlmeVNlcnZpY2UuaW5mbyh0aGlzLmxvY2FscGlwZS50cmFuc2Zvcm0oJ2FwcHVybGVycm9yJykpO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBpZihiZW9wdGlvbnMucXVlcnlUeXBlPT11bmRlZmluZWQpey8v5YW85a655Lul5YmN55qE6YC76L6RXHJcbiAgICAgIGJlb3B0aW9ucy5xdWVyeVR5cGUgPSBRdWVyeVR5cGUuVW5rbm93bjtcclxuICAgIH1cclxuICAgIGlmKG9wdGlvbnMucHJpbnRUeXBlPT11bmRlZmluZWQpey8v5YW85a655Lul5YmN55qE6YC76L6R6L+Z6YeM6buY6K6k5Li66KGo5Y2V5omT5Y2wXHJcbiAgICAgIG9wdGlvbnMucHJpbnRUeXBlID0gUHJpbnRUeXBlLkZvcm07XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHRoaXMub3BlbkZvcm1hdExpc3RCeURpbWVuc2lvbjRKb2IoW2Jlb3B0aW9uc10sIG9wdGlvbnMsIGZhbHNlLGZhbHNlKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOWNleagvOW8j+i/h+a7pOWZqOaJk+WNsFxyXG4gICAqIHN177ya5Y+M5qCI5qih5byP5LiLbmdpbnjot6/nlLHnmoRzdVxyXG4gICAqIFxyXG4gICAqIDEu5bim57u05bqm6L+H5ruk5qC85byP6YCJ5oup5ZmoXHJcbiAgICovXHJcbiAgcHJpbnRTaW5nbGVCeUZpbHRlcjRKb2IoYmVGaWx0ZXJvcHRpb25zOiBTb3VyY2VGaWx0ZXJPcHRpb25zLCBvcHRpb25zOiBPdXRwdXRPcHRpb25zLCBzdT1udWxsLHBhcmFtPW51bGwpOiBhbnkge1xyXG4gICAgaWYoRGF0YVZhbGlkYXRvci5jaGVja0FwcFVybCh0aGlzLnByaW50RW50aXR5LmFwcFVybCk9PWZhbHNlKXtcclxuICAgICAgdGhpcy5ub3RpZnlTZXJ2aWNlLmluZm8odGhpcy5sb2NhbHBpcGUudHJhbnNmb3JtKCdhcHB1cmxlcnJvcicpKTtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgaWYoYmVGaWx0ZXJvcHRpb25zLnF1ZXJ5VHlwZT09dW5kZWZpbmVkKXsvL+WFvOWuueS7peWJjeeahOmAu+i+kVxyXG4gICAgICBiZUZpbHRlcm9wdGlvbnMucXVlcnlUeXBlID0gUXVlcnlUeXBlLlVua25vd247XHJcbiAgICB9XHJcbiAgICBpZihvcHRpb25zLnByaW50VHlwZT09dW5kZWZpbmVkKXsvL+WFvOWuueS7peWJjeeahOmAu+i+kei/memHjOm7mOiupOS4uuihqOWNleaJk+WNsFxyXG4gICAgICBvcHRpb25zLnByaW50VHlwZSA9IFByaW50VHlwZS5Gb3JtO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHRoaXMub3BlbkZvcm1hdExpc3RCeURpbWVuc2lvbjRKb2IoW2JlRmlsdGVyb3B0aW9uc10sIG9wdGlvbnMsIHRydWUsZmFsc2UpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog5aSa5qC85byP5pWw5o2uaWTmiZPljbBcclxuICAgKiBzde+8muWPjOagiOaooeW8j+S4i25naW546Lev55Sx55qEc3VcclxuICAgKiBcclxuICAgKiBUT0RPOiDnm67liY3kuI3luKbmoLzlvI/pgInmi6nlmahcclxuICAgKi9cclxuICBwcmludE11bHRpQnlJZDRKb2IoYmVPcHRpb25zTGlzdDogQXJyYXk8U291cmNlT3B0aW9ucz4sIG9wdGlvbnM6IE91dHB1dE9wdGlvbnMsIHN1PW51bGwsIHBhcmFtPW51bGwpOiBhbnl7XHJcbiAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6Zm9yaW5cclxuICAgIGZvcihjb25zdCBiIGluIGJlT3B0aW9uc0xpc3Qpe1xyXG4gICAgICBEYXRhVmFsaWRhdG9yLmNoZWNrRm9yTnVsbFJlZmVyZW5jZShiZU9wdGlvbnNMaXN0WzBdLnF1ZXJ5VHlwZSwncXVlcnlUeXBlJyk7XHJcbiAgICB9XHJcblxyXG4gICAgRGF0YVZhbGlkYXRvci5jaGVja0Zvck51bGxSZWZlcmVuY2Uob3B0aW9ucy5wcmludFR5cGUsJ3ByaW50VHlwZScpO1xyXG4gICAgaWYoRGF0YVZhbGlkYXRvci5jaGVja0FwcFVybCh0aGlzLnByaW50RW50aXR5LmFwcFVybCk9PWZhbHNlKXtcclxuICAgICAgdGhpcy5ub3RpZnlTZXJ2aWNlLmluZm8odGhpcy5sb2NhbHBpcGUudHJhbnNmb3JtKCdhcHB1cmxlcnJvcicpKTtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHRoaXMub3BlbkZvcm1hdExpc3RCeURpbWVuc2lvbjRKb2IoYmVPcHRpb25zTGlzdCwgb3B0aW9ucywgZmFsc2UsdHJ1ZSk7XHJcblxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog5aSa5qC85byP6L+H5ruk5Zmo5omT5Y2wXHJcbiAgICogc3XvvJrlj4zmoIjmqKHlvI/kuItuZ2lueOi3r+eUseeahHN1XHJcbiAgICogXHJcbiAgICogVE9ETzog55uu5YmN5LiN5bim5qC85byP6YCJ5oup5ZmoXHJcbiAgICovXHJcbiAgcHJpbnRNdWx0aUJ5RmlsdGVyNEpvYihiZUZpbHRlcm9wdGlvbnM6IEFycmF5PFNvdXJjZUZpbHRlck9wdGlvbnM+LCBvcHRpb25zOiBPdXRwdXRPcHRpb25zLCBzdT1udWxsLCBwYXJhbT1udWxsKTogYW55e1xyXG5cclxuICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTpmb3JpblxyXG4gICAgZm9yKGNvbnN0IGIgaW4gYmVGaWx0ZXJvcHRpb25zKXtcclxuICAgICAgRGF0YVZhbGlkYXRvci5jaGVja0Zvck51bGxSZWZlcmVuY2UoYmVGaWx0ZXJvcHRpb25zWzBdLnF1ZXJ5VHlwZSwncXVlcnlUeXBlJyk7XHJcbiAgICB9XHJcblxyXG4gICAgRGF0YVZhbGlkYXRvci5jaGVja0Zvck51bGxSZWZlcmVuY2Uob3B0aW9ucy5wcmludFR5cGUsJ3ByaW50VHlwZScpO1xyXG4gICAgaWYoRGF0YVZhbGlkYXRvci5jaGVja0FwcFVybCh0aGlzLnByaW50RW50aXR5LmFwcFVybCk9PWZhbHNlKXtcclxuICAgICAgdGhpcy5ub3RpZnlTZXJ2aWNlLmluZm8odGhpcy5sb2NhbHBpcGUudHJhbnNmb3JtKCdhcHB1cmxlcnJvcicpKTtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHRoaXMub3BlbkZvcm1hdExpc3RCeURpbWVuc2lvbjRKb2IoYmVGaWx0ZXJvcHRpb25zLCBvcHRpb25zLCB0cnVlLHRydWUpO1xyXG4gIH1cclxuICBcclxuICAvKipcclxuICAgKiDliJvlu7pibG9i5a+56LGh77yM5bm25Yip55So5rWP6KeI5Zmo5omT5byAdXJs6L+b6KGM5LiL6L29XHJcbiAgICogQHBhcmFtIGRhdGEg5paH5Lu25rWB5pWw5o2uXHJcbiAgICovXHJcbiAgZG93bmxvYWRGaWxlKGRhdGEpIHtcclxuICBcclxuICAgIGNvbnN0IGxpbmsgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7XHJcbiAgICBjb25zdCBibG9iID0gbmV3IEJsb2IoW2RhdGFdLCB7dHlwZTogJ2FwcGxpY2F0aW9uL3BkZjtjaGFyc2V0PVVURi04J30pO1xyXG4gICAgbGluay5zZXRBdHRyaWJ1dGUoJ2hyZWYnLCB3aW5kb3cuVVJMLmNyZWF0ZU9iamVjdFVSTChibG9iKSk7XHJcbiAgICBsaW5rLnNldEF0dHJpYnV0ZSgnZG93bmxvYWQnLCB0aGlzLnByaW50RW50aXR5LmRvd25Mb2FkRmlsZU5hbWUrJy5wZGYnKTtcclxuICAgIGxpbmsuc3R5bGUudmlzaWJpbGl0eSA9ICdoaWRkZW4nO1xyXG4gICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChsaW5rKTtcclxuICAgIGxpbmsuY2xpY2soKTtcclxuICAgIGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQobGluayk7XHJcbiAgfVxyXG4gIC8vI2VuZHJlZ2lvblxyXG4gIFxyXG4gIC8qKlxyXG4gICAqIOaJk+WNsO+8iOi/h+acn+S6hu+8jOaUueS4unByaW50U2luZ2xlQnlJZO+8iVxyXG4gICAqIEBwYXJhbSBiZW9wdGlvbnMg5pWw5o2u5rqQ6YCJ6aG5XHJcbiAgICogQHBhcmFtIG9wdGlvbnMg5a+85Ye66YCJ6aG5XHJcbiAgICogQHBhcmFtIGVsZSDpooTop4jml7bopoHmuLLmn5PnmoTkuLvkvZNcclxuICAgKiBlbGXkuLrnqbrml7bvvJrov5Tlm57muLLmn5PmtYHvvIxcclxuICAgKiBlbGXkuLp0YWLlrZfnrKbkuLLml7bvvJrmlrDnmoR0YWLpobXmiZPlvIDpooTop4jlmajvvIxcclxuICAgKiBlbGXkuLpkb3dubG9hZOWtl+espuS4suaXtu+8muS4i+i9ve+8jFxyXG4gICAqIGVsZeS4umVsZW1lbnTlhYPntKDml7bvvIzlvZPliY3pobXnmoRlbGVtZW505LiK5riy5p+T6aKE6KeI5ZmoXHJcbiAgICogXHJcbiAgICog5rOo5oSPYmVvcHRpb25z6YeM55qEUmV0cmlldmVQYXJhbeWGheeahOWxnuaAp+WAvOmDvemcgOimgeWwj+WGmeWtl+avjeW8gOWktFxyXG4gICAqL1xyXG4gIG91dHB1dEJFRGF0YShiZW9wdGlvbnM6IGFueSwgb3B0aW9uczogT3V0cHV0T3B0aW9ucywgZWxlOiBhbnkpOiBhbnkge1xyXG4gICAgcmV0dXJuIHRoaXMucHJpbnRTaW5nbGVCeUlkKGJlb3B0aW9ucyxvcHRpb25zLGVsZSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDmiZPljbDvvIjov4fmnJ/kuobvvIzmlLnkuLpwcmludFNpbmdsZUJ5RmlsdGVy77yJXHJcbiAgICogQHBhcmFtIGJlb3B0aW9ucyBCRUZpbHRlcumAiemhuVxyXG4gICAqIEBwYXJhbSBvcHRpb25zIOWvvOWHuumAiemhuVxyXG4gICAqIEBwYXJhbSBlbGUg6aKE6KeI5pe26KaB5riy5p+T55qE5Li75L2TXHJcbiAgICogZWxl5Li656m65pe277ya6L+U5Zue5riy5p+T5rWB77yMXHJcbiAgICogZWxl5Li6dGFi5a2X56ym5Liy5pe277ya5paw55qEdGFi6aG15omT5byA6aKE6KeI5Zmo77yMXHJcbiAgICogZWxl5Li6ZG93bmxvYWTlrZfnrKbkuLLml7bvvJrkuIvovb1cclxuICAgKiBlbGXkuLplbGVtZW505YWD57Sg5pe277yM5b2T5YmN6aG155qEZWxlbWVudOS4iua4suafk+mihOiniOWZqFxyXG4gICAqIFxyXG4gICAqIOazqOaEj2Jlb3B0aW9uc+mHjOeahFJldHJpZXZlUGFyYW3lhoXnmoTlsZ7mgKflgLzpg73pnIDopoHlsI/lhpnlrZfmr43lvIDlpLRcclxuICAgKi9cclxuICBvdXRwdXRCRURhdGFXaXRoRmlsdGVyKGJlRmlsdGVyb3B0aW9uczogYW55LCBvcHRpb25zOiBPdXRwdXRPcHRpb25zLCBlbGU6IGFueSk6IGFueSB7XHJcbiAgICByZXR1cm4gdGhpcy5wcmludFNpbmdsZUJ5RmlsdGVyKGJlRmlsdGVyb3B0aW9ucywgb3B0aW9ucyxlbGUpO1xyXG4gIH1cclxuXHJcbn1cclxuIl19