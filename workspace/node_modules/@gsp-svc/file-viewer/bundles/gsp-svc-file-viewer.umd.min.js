!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("jquery"),require("@progress/kendo-angular-layout"),require("@progress/kendo-angular-buttons"),require("@ecp-caf/caf-common"),require("rxjs/operators"),require("@angular/common/http"),require("rxjs"),require("@angular/platform-browser"),require("@progress/kendo-angular-dialog"),require("@farris/ui-modal"),require("@gsp-svc/cloudprint"),require("@gsp-sys/rtf-common"),require("angular2-uuid"),require("@angular/common"),require("@angular/core"),require("@farris/ui-loading"),require("@farris/ui-messager"),require("@farris/ui-notify")):"function"==typeof define&&define.amd?define("@gsp-svc/file-viewer",["exports","jquery","@progress/kendo-angular-layout","@progress/kendo-angular-buttons","@ecp-caf/caf-common","rxjs/operators","@angular/common/http","rxjs","@angular/platform-browser","@progress/kendo-angular-dialog","@farris/ui-modal","@gsp-svc/cloudprint","@gsp-sys/rtf-common","angular2-uuid","@angular/common","@angular/core","@farris/ui-loading","@farris/ui-messager","@farris/ui-notify"],t):t((e["gsp-svc"]=e["gsp-svc"]||{},e["gsp-svc"]["file-viewer"]={}),e.jquery,e.kendoAngularLayout,e.kendoAngularButtons,e.i1,e.rxjs.operators,e.ng.common.http,e.rxjs,e.ng.platformBrowser,e.kendoAngularDialog,e.uiModal,e.cloudprint,e.rtfCommon,e.angular2Uuid,e.ng.common,e.ng.core,e.uiLoading,e.uiMessager,e.uiNotify)}(this,function(e,t,i,o,n,r,s,a,l,p,c,f,h,d,g,u,m,v,w){"use strict";var y="default"in t?t["default"]:t,b=function(){function e(){this.index=0,this.style={transform:"",msTransform:"",oTransform:"",webkitTransform:""},this.scale=1,this.rotation=0,this.translateX=0,this.translateY=0}return e.prototype.ngOnInit=function(){},e.prototype.zoomIn=function(){!(this.scale<4)||(this.scale+=.1),this.updateStyle()},e.prototype.zoomOut=function(){!(.3<this.scale)||(this.scale-=.1),this.scale=Number(this.scale.toFixed(1)),this.updateStyle()},e.prototype.zoomReset=function(){this.scale=1,this.updateStyle()},e.prototype.scrollZoom=function(e){return 0<e.deltaY?this.zoomOut():this.zoomIn(),!1},e.prototype.rotateClockwise=function(){this.rotation+=90,this.updateStyle()},e.prototype.rotateCounterClockwise=function(){this.rotation-=90,this.updateStyle()},e.prototype.onDragStart=function(e){this.prevX=e.clientX,this.prevY=e.clientY},e.prototype.onDragOver=function(e){this.translateX+=e.clientX-this.prevX,this.translateY+=e.clientY-this.prevY,this.prevX=e.clientX,this.prevY=e.clientY,this.updateStyle()},e.prototype.imageChange=function(e){this.imageUrl=e,this.reset()},e.prototype.reset=function(){this.scale=1,this.rotation=0,this.translateX=0,this.translateY=0,this.updateStyle()},e.prototype.updateStyle=function(){this.style.transform="translate("+this.translateX+"px, "+this.translateY+"px) rotate("+this.rotation+"deg) scale("+this.scale+")",this.style.msTransform=this.style.transform,this.style.webkitTransform=this.style.transform,this.style.oTransform=this.style.transform},e.decorators=[{type:u.Component,args:[{selector:"app-image-viewer",template:'<div (wheel)="scrollZoom($event)" (dragover)="onDragOver($event)" (dragstart)="onDragStart($event)"  >\n  <img [src]=\'imageUrl\' id="image" [ngStyle]="style">\n  \x3c!-- <div>\n      <button id="zoomin" kendoButton [icon]="\'zoom-in\'" (click)="zoomIn()"></button>\n      <button id="zoomout" kendoButton [icon]="\'zoom-out\'" (click)="zoomOut()"></button>\n      <button id="clockwise" kendoButton [icon]="\'reload\'" (click)="rotateClockwise()"></button>\n      <button id="counterclockwise" kendoButton [icon]="\'reset\'" (click)="rotateCounterClockwise()"></button>\n  </div> --\x3e\n  \x3c!--div id="picchange">\n      <button *ngIf="src.length>1" id="prepic" kendoButton [icon]="\'arrow-chevron-left\'" (click)="prePicture()"\n          [disabled]="index == 0"></button>\n\n      <button *ngIf="src.length>1" id="nextpic" kendoButton [icon]="\'arrow-chevron-right\'" (click)="nextPicture()"\n          [disabled]="index == src.length - 1"></button>\n  </div--\x3e\n</div>\n',styles:["#image{text-align:center;margin:auto;top:0;left:0;bottom:0;right:0;position:absolute;max-height:100%;max-width:100%;overflow:hidden}#zoomin{width:40px;height:40px;border-radius:20px;position:absolute;right:30px;bottom:285px;transform:scale(1.5);-ms-transform:scale(1.5);-moz-transform:scale(1.5);-webkit-transform:scale(1.5);-o-transform:scale(1.5)}#zoomout{width:40px;height:40px;border-radius:20px;position:absolute;right:30px;bottom:205px;transform:scale(1.5);-ms-transform:scale(1.5);-moz-transform:scale(1.5);-webkit-transform:scale(1.5);-o-transform:scale(1.5)}#clockwise{width:40px;height:40px;border-radius:20px;position:absolute;right:30px;bottom:125px;transform:scale(1.5) rotate(45deg);-ms-transform:scale(1.5) rotate(45deg);-moz-transform:scale(1.5) rotate(45deg);-webkit-transform:scale(1.5) rotate(45deg);-o-transform:scale(1.5) rotate(45deg)}#counterclockwise{width:40px;height:40px;border-radius:20px;position:absolute;right:30px;bottom:45px;transform:scale(1.5) rotate(-45deg);-ms-transform:scale(1.5) rotate(-45deg);-moz-transform:scale(1.5) rotate(-45deg);-webkit-transform:scale(1.5) rotate(-45deg);-o-transform:scale(1.5) rotate(-45deg)}#prepic{width:40px;height:40px;border-radius:20px;position:absolute;bottom:25px;right:50px;transform:scale(1.5);-ms-transform:scale(1.5);-moz-transform:scale(1.5);-webkit-transform:scale(1.5);-o-transform:scale(1.5)}#nextpic{width:40px;height:40px;border-radius:20px;position:relative;bottom:25px;left:50px;transform:scale(1.5);-ms-transform:scale(1.5);-moz-transform:scale(1.5);-webkit-transform:scale(1.5);-o-transform:scale(1.5)}#picchange{position:fixed;bottom:0;left:50%}"]}]}],e.ctorParameters=function(){return[]},e.propDecorators={imageUrl:[{type:u.Input}]},e}(),x=function(){function e(){}return e.decorators=[{type:u.NgModule,args:[{declarations:[b],imports:[g.CommonModule,o.ButtonsModule,v.MessagerModule.forRoot(),c.ModalModule.forRoot(),m.LoadingModule.forRoot({message:"Loading..."})],exports:[b],entryComponents:[b]}]}],e}(),P=function(e,t){return(P=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)};function I(e,t){function i(){this.constructor=e}P(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}var S=function Ce(){},C=function(){function e(){}return e.VIEWER_APP="/viewer",e.EDITOR_APP="/editor",e.COMPARISON_APP="/comparison",e.CONVERSION_APP="/conversion",e.DEFAULT_API_ENDPOINT=window.location.href,e.LOAD_FILE_TREE="/loadFileTree",e.LOAD_CONFIG="/loadConfig",e.LOAD_DOCUMENT_DESCRIPTION="/loadDocumentDescription",e.LOAD_DOCUMENT_PAGE="/loadDocumentPage",e.ROTATE_DOCUMENT_PAGE="/rotateDocumentPages",e.UPLOAD_DOCUMENTS="/uploadDocument",e.DOWNLOAD_DOCUMENTS="/downloadDocument",e.LOAD_PRINT="/loadPrint",e.LOAD_PRINT_PDF="/printPdf",e.LOAD_THUMBNAILS="/loadThumbnails",e.LOAD_FORMATS="/loadFormats",e.SAVE_FILE="/saveFile",e.COMPARE_FILES="/compare",e.CONVERT_FILE="/convert",e.httpOptionsJson={headers:new s.HttpHeaders({"Content-Type":"application/json"})},e.httpOptionsJsonResponseTypeBlob={headers:new s.HttpHeaders({"Content-Type":"application/json"}),responseType:"blob"},e}(),O=function(){function e(){this.apiEndpoint=C.DEFAULT_API_ENDPOINT}return Object.defineProperty(e.prototype,"apiEndpoint",{get:function(){return this._apiEndpoint},set:function(e){this._apiEndpoint=e&&e.trim().endsWith("/")?e.substring(0,e.length-1):e},enumerable:!0,configurable:!0}),e.prototype.getConfigEndpoint=function(e){return(this.apiEndpoint.endsWith(e)?this.apiEndpoint:this.apiEndpoint+e)+C.LOAD_CONFIG},e.prototype.getViewerApiEndpoint=function(){return this._apiEndpoint.endsWith(C.VIEWER_APP)?this._apiEndpoint:this._apiEndpoint+C.VIEWER_APP},e.prototype.getEditorApiEndpoint=function(){return this._apiEndpoint.trim().endsWith(C.EDITOR_APP)?this._apiEndpoint:this._apiEndpoint+C.EDITOR_APP},e.prototype.getComparisonApiEndpoint=function(){return this._apiEndpoint.trim().endsWith(C.COMPARISON_APP)?this._apiEndpoint:this._apiEndpoint+C.COMPARISON_APP},e.prototype.getConversionApiEndpoint=function(){return this._apiEndpoint.trim().endsWith(C.CONVERSION_APP)?this._apiEndpoint:this._apiEndpoint+C.CONVERSION_APP},e.decorators=[{type:u.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[]},e.ngInjectableDef=u.defineInjectable({factory:function(){return new e},token:e,providedIn:"root"}),e}(),_=function Oe(){},E=function(){function e(e,t,i){this.http=e,this._http=t,this._config=i}return e.prototype.setHeader=function(e){return e.headers={"Content-Type":"application/json","Access-Control-Allow-Origin":"*"},e},e.prototype.loadFileInfo=function(e){return this.http.request("Post","/api/runtime/dfs/v1.0/docviewer/loaddocument",this.setHeader({body:e})).pipe(r.tap(function(e){}),r.catchError(function(e){return a.of(e)}))},e.prototype.loadPage=function(e,t){return this._http.post("/api/runtime/dfs/v1.0/docviewer/loaddocumentPage",{filePath:e.guid,password:e.password,page:t},C.httpOptionsJson)},e.prototype.rotate=function(e,t,i){var o=new _;return o.filePath=e.guid,o.angle=t,o.pages=[i],this.http.request("Post","/api/runtime/dfs/v1.0/docviewer/rotatedocumentPage",this.setHeader({body:o})).pipe(r.tap(function(e){}),r.catchError(function(e){return a.of(e)}))},e.decorators=[{type:u.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:n.HttpService},{type:s.HttpClient},{type:O}]},e.ngInjectableDef=u.defineInjectable({factory:function(){return new e(u.inject(n.HttpService),u.inject(s.HttpClient),u.inject(O))},token:e,providedIn:"root"}),e}(),z=function(){function e(){this._observer=new a.Subject,this._zoomChange=this._observer.asObservable()}return Object.defineProperty(e.prototype,"zoom",{get:function(){return this._zoom},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"zoomChange",{get:function(){return this._zoomChange},enumerable:!0,configurable:!0}),e.prototype.changeZoom=function(e){this._zoom=e,this._observer.next(e)},e.prototype.createZoomOption=function(e,t,i){return void 0===i&&(i=!1),{value:e,name:t,separator:i}},e.prototype.zoomOptions=function(e,t){return[this.createZoomOption(25,"25%"),this.createZoomOption(50,"50%"),this.createZoomOption(100,"100%"),this.createZoomOption(150,"150%"),this.createZoomOption(200,"200%"),this.createZoomOption(300,"300%"),this.createZoomOption(0,"",!0),this.createZoomOption(e,"Fit Width"),this.createZoomOption(t,"Fit Height")]},e.decorators=[{type:u.Injectable}],e.ctorParameters=function(){return[]},e}(),k=function(){function e(){var t=this;this._checkPreload=new a.Observable(function(e){return t._observer=e})}return Object.defineProperty(e.prototype,"checkPreload",{get:function(){return this._checkPreload},enumerable:!0,configurable:!0}),e.prototype.changeLastPageInView=function(e){this._observer&&this._observer.next(e)},e.decorators=[{type:u.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[]},e.ngInjectableDef=u.defineInjectable({factory:function(){return new e},token:e,providedIn:"root"}),e}(),M=function(){function e(e){var t=this;this._pagePreloadService=e,this._currentPage=0,this._countPages=0,this._navigate=new a.Observable(function(e){return t._observer=e})}return Object.defineProperty(e.prototype,"navigate",{get:function(){return this._navigate},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"countPages",{get:function(){return this._countPages},set:function(e){this._countPages=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentPage",{get:function(){return this._currentPage},set:function(e){this._currentPage=e},enumerable:!0,configurable:!0}),e.prototype.nextPage=function(){this._currentPage<this._countPages&&(this._currentPage++,this.navigateTo(this._currentPage))},e.prototype.prevPage=function(){1<this._currentPage&&(this._currentPage--,this.navigateTo(this._currentPage))},e.prototype.toLastPage=function(){this._currentPage=this._countPages,this.navigateTo(this._currentPage)},e.prototype.toFirstPage=function(){this._currentPage=1,this.navigateTo(this._currentPage)},e.prototype.navigateTo=function(e){this.currentPage=e,this._pagePreloadService.changeLastPageInView(e),this._observer.next(e)},e.decorators=[{type:u.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:k}]},e.ngInjectableDef=u.defineInjectable({factory:function(){return new e(u.inject(k))},token:e,providedIn:"root"}),e}(),D=function(){function e(){var t=this;this.resizeSubject=new a.Subject,this.width=window.innerWidth,this.height=window.innerHeight,this._resize$=a.fromEvent(window,"resize").pipe(r.debounceTime(200),r.distinctUntilChanged(),r.startWith({target:{innerWidth:window.innerWidth,innerHeight:window.innerHeight}}),r.tap(function(e){t.resizeSubject.next(e.target),t.width=e.target.innerWidth,t.height=e.target.innerHeight})),this._resize$.subscribe()}return Object.defineProperty(e.prototype,"onResize",{get:function(){return this.resizeSubject.asObservable()},enumerable:!0,configurable:!0}),e.prototype.isMobile=function(){return this.width<=425},e.prototype.isTablet=function(){return this.width<=1024},e.prototype.isDesktop=function(){return!this.isMobile()&&!this.isTablet()},e.prototype.getWidth=function(){return this.width},e.prototype.getHeight=function(){return this.height},e.prototype.isEdge=function(){return-1<window.navigator.userAgent.toLowerCase().indexOf("edge")},e.prototype.isFirefox=function(){return-1<navigator.userAgent.toLowerCase().indexOf("firefox")},e.decorators=[{type:u.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[]},e.ngInjectableDef=u.defineInjectable({factory:function(){return new e},token:e,providedIn:"root"}),e}(),T=function(){function e(){}return e.prototype.getUpdatedPage=function(e){var t=(new DOMParser).parseFromString(e,"text/html"),i=t.querySelector("table"),o=0;t.querySelectorAll("table > tbody > tr:first-child td").forEach(function(e){o+=e.attributes.colspan?parseInt(e.attributes.colspan.value,10):1});var n=this.createHeader(o,i);return t.querySelector("table").replaceWith(n),(new XMLSerializer).serializeToString(t).replace(/a0:/g,"").replace(/:a0/g,"")},e.prototype.createHeader=function(e,t){var i=document.createElement("thead");i.append(document.createElement("tr"));for(var o=0;o<e;++o){var n=document.createElement("th");n.innerText=this.colName(o),i.querySelector("tr").append(n)}var r=t.querySelector("colgroup"),s=document.createElement("col");s.width="80px",r.prepend(s),t.prepend(i);var a=0;return t.querySelectorAll("tr").forEach(function(e){var t=document.createElement("div");if(0!==a){var i=document.createElement("td");i.className="excel",i.append(t),t.innerText=a.toString(),e.prepend(i)}else{var o=document.createElement("th");o.append(t),e.prepend(o)}a++}),t},e.prototype.colName=function(e){for(var t="a".charCodeAt(0),i="z".charCodeAt(0)-t+1,o="";0<=e;)o=String.fromCharCode(e%i+t)+o,e=Math.floor(e/i)-1;return o},e.decorators=[{type:u.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[]},e.ngInjectableDef=u.defineInjectable({factory:function(){return new e},token:e,providedIn:"root"}),e}(),F=function(){function e(e){this._excelPageService=e}return e.prototype.ngOnInit=function(){/*@cc_on!@*/!!/(MSIE|Trident\/|Edge\/)/i.test(navigator.userAgent)&&0===this.number&&(this.editable=!1)},e.prototype.ngOnChanges=function(e){this.isHtml?this.data=this.data?this.data.replace(/>\s+</g,"><").replace(/\uFEFF/g,""):null:this.data&&(this.imgData=this.data.startsWith("data:image")?this.data:"data:image/png;base64,"+this.data)},e.decorators=[{type:u.Component,args:[{selector:"app-excel-page",template:'<div id="page-{{number}}">\r\n    <div class="gd-wrapper" [innerHTML]="data | safeHtml" *ngIf="data && isHtml" [contentEditable]="(editable) ? true : false"></div>\r\n    <img class="gd-page-image" [style.width.px]="width" [style.height.px]="height" [attr.src]="imgData | safeResourceHtml" alt="" *ngIf="data && !isHtml">\r\n    <div class="gd-page-spinner" *ngIf="!data">\r\n        \x3c!-- <fa-icon [icon]="[\'fas\',\'circle-notch\']" [spin]="true"></fa-icon> --\x3e\r\n        \x3c!-- &nbsp;Loading... Please wait. --\x3e\r\n    </div>\r\n</div>',styles:[".gd-page-spinner{margin-top:150px;text-align:center}.gd-wrapper{width:inherit;height:inherit}.gd-wrapper div{width:100%}::ng-deep .gd-highlight{background-color:#ff0}::ng-deep .gd-highlight-select{background-color:#ff9b00}::ng-deep th{color:#959da5;background-color:#f4f4f4;font-weight:unset;border:1px solid #e7e7e7!important;text-transform:uppercase;font-size:14px;overflow:hidden}::ng-deep td{vertical-align:middle!important}::ng-deep .page-grid-lines td{border:1px solid #e7e7e7!important}::ng-deep .page td:nth-child(1){border:1px solid #e7e7e7!important}::ng-deep tr td.excel:first-child{color:#959da5;background-color:#f4f4f4;font-weight:unset;width:1%;text-align:center}::ng-deep tr td.excel:first-child div{width:80px}::ng-deep tr th.excel:first-child{background-color:#f4f4f4;width:1%}::ng-deep tr th.excel:first-child div{width:80px}.gd-page-image{height:100%!important;width:100%!important}"]}]}],e.ctorParameters=function(){return[{type:T}]},e.propDecorators={angle:[{type:u.Input}],width:[{type:u.Input}],height:[{type:u.Input}],number:[{type:u.Input}],data:[{type:u.Input}],isHtml:[{type:u.Input}],editable:[{type:u.Input}]},e}(),j=function(){function n(){}return n.find=function(e,t){if(!e||t)return n.map.folder;var i=e.split("."),o=i.pop().toLowerCase();return"undefined"==typeof n.map[o]?0<i.length?n.map.unknown:n.map.folder:n.map[o]},n.map={folder:{format:"",icon:"folder"},pdf:{format:"Portable Document Format",icon:"file-pdf"},doc:{format:"Microsoft Word",icon:"file-word"},docx:{format:"Microsoft Word",icon:"file-word"},docm:{format:"Microsoft Word",icon:"file-word"},dot:{format:"Microsoft Word",icon:"file-word"},dotx:{format:"Microsoft Word",icon:"file-word"},dotm:{format:"Microsoft Word",icon:"file-word"},xls:{format:"Microsoft Excel",icon:"file-excel"},xlsx:{format:"Microsoft Excel",icon:"file-excel"},xlsm:{format:"Microsoft Excel",icon:"file-excel"},xlsb:{format:"Microsoft Excel",icon:"file-excel"},xls2003:{format:"Microsoft Excel",icon:"file-excel"},xltx:{format:"Microsoft Excel",icon:"file-excel"},xltm:{format:"Microsoft Excel",icon:"file-excel"},ppt:{format:"Microsoft PowerPoint",icon:"file-powerpoint"},pptx:{format:"Microsoft PowerPoint",icon:"file-powerpoint"},pps:{format:"Microsoft PowerPoint",icon:"file-powerpoint"},ppsx:{format:"Microsoft PowerPoint",icon:"file-powerpoint"},vsd:{format:"Microsoft Visio",icon:"file-code"},vdx:{format:"Microsoft Visio",icon:"file-code"},vss:{format:"Microsoft Visio",icon:"file-code"},vsx:{format:"Microsoft Visio",icon:"file-code"},vst:{format:"Microsoft Visio",icon:"file-code"},vtx:{format:"Microsoft Visio",icon:"file-code"},vsdx:{format:"Microsoft Visio",icon:"file-code"},vdw:{format:"Microsoft Visio",icon:"file-code"},vstx:{format:"Microsoft Visio",icon:"file-code"},vssx:{format:"Microsoft Visio",icon:"file-code"},mpp:{format:"Microsoft Project",icon:"file-alt"},mpt:{format:"Microsoft Project",icon:"file-alt"},msg:{format:"Microsoft Outlook",icon:"file-alt"},eml:{format:"Microsoft Outlook",icon:"file-alt"},emlx:{format:"Microsoft Outlook",icon:"file-alt"},one:{format:"Microsoft OneNote",icon:"file-word"},odt:{format:"Open Document Text",icon:"file-word"},ott:{format:"Open Document Text Template",icon:"file-word"},ods:{format:"Open Document Spreadsheet",icon:"file-excel"},odp:{format:"Open Document Presentation",icon:"file-powerpoint"},otp:{format:"Open Document Presentation",icon:"file-powerpoint"},ots:{format:"Open Document Presentation",icon:"file-powerpoint"},potx:{format:"Open Document Presentation",icon:"file-powerpoint"},potm:{format:"Open Document Presentation",icon:"file-powerpoint"},pptm:{format:"Open Document Presentation",icon:"file-powerpoint"},ppsm:{format:"Open Document Presentation",icon:"file-powerpoint"},rtf:{format:"Rich Text Format",icon:"file-alt"},txt:{format:"Plain Text File",icon:"file-alt"},csv:{format:"Comma-Separated Values",icon:"file-excel"},html:{format:"HyperText Markup Language",icon:"file-word"},mht:{format:"HyperText Markup Language",icon:"file-word"},mhtml:{format:"HyperText Markup Language",icon:"file-word"},xml:{format:"Extensible Markup Language",icon:"file-word"},xps:{format:"XML Paper Specification",icon:"file-word"},dxf:{format:"AutoCAD Drawing File Format",icon:"file-image"},dwg:{format:"AutoCAD Drawing File Format",icon:"file-image"},bmp:{format:"Bitmap Picture",icon:"file-image"},gif:{format:"Graphics Interchange Format",icon:"file-image"},jpg:{format:"Joint Photographic Experts Group",icon:"file-image"},jpe:{format:"Joint Photographic Experts Group",icon:"file-image"},jpeg:{format:"Joint Photographic Experts Group",icon:"file-image"},jfif:{format:"Joint Photographic Experts Group",icon:"file-image"},png:{format:"Portable Network Graphics",icon:"file-image"},tiff:{format:"Tagged Image File Format",icon:"file-image"},tif:{format:"Tagged Image File Format",icon:"file-image"},psd:{format:"Tagged Image File Format",icon:"file-image"},svg:{format:"Tagged Image File Format",icon:"file-image"},jp2:{format:"Tagged Image File Format",icon:"file-image"},epub:{format:"Electronic Publication",icon:"file-pdf"},ico:{format:"Windows Icon",icon:"file-image"},webp:{format:"Compressed Image",icon:"file-image"},mobi:{format:"Mobipocket eBook",icon:"file-pdf"},tex:{format:"LaTeX Source Document",icon:"file-pdf"},djvu:{format:"Multi-Layer Raster Image",icon:"file-alt"},unknown:{format:"This format is not supported",icon:"file"}},n}(),L=function(){function e(e,t,i,o){var n=this;this._elementRef=e,this._zoomService=t,this._windowService=i,this._navigateService=o,this.wait=!1,this.docWidth=null,this.docHeight=null,this.viewportWidth=null,this.viewportHeight=null,this.scale=null,this.lastScale=null,this.container=null,this.doc=null,this.x=0,this.lastX=0,this.y=0,this.lastY=0,this.pinchCenter=null,this.pinchCenterOffset=null,this.curWidth=0,this.curHeight=0,t.zoomChange.subscribe(function(e){n.zoom=e}),this.isDesktop=i.isDesktop(),this._navigateService.navigate.subscribe(function(e){n.selectedPage=e})}return e.prototype.ngOnInit=function(){this.ifPresentation()&&(this.selectedPage=this._navigateService.currentPage)},e.prototype.ngOnChanges=function(){this.refreshView=!this.refreshView},e.prototype.ngAfterViewInit=function(){this.doc=this._elementRef.nativeElement.children.item(0).children.item(0),this.container=this._elementRef.nativeElement,this.docWidth=this.doc.clientWidth,this.docHeight=this.doc.clientHeight,this.viewportWidth=this.doc.offsetWidth,this.scale=this.viewportWidth/this.docWidth*this._zoomService.zoom/100,this.lastScale=this.scale,this.viewportHeight=this.container.offsetHeight,this.curWidth=this.docWidth*this.scale,this.curHeight=this.docHeight*this.scale},e.prototype.ifExcel=function(){return"Microsoft Excel"===j.find(this.file.filePath,!1).format},e.prototype.ifPresentation=function(){return"Microsoft PowerPoint"===j.find(this.file.filePath,!1).format},e.prototype.getDimensionWithUnit=function(e,t){return this.ifPresentation()&&this.showActiveSlide&&!this.isVisible(t)?0:e+(this.mode?j.find(this.file.filePath,!1).unit:"px")},e.prototype.ifChromeOrFirefox=function(){return-1<navigator.userAgent.toLowerCase().indexOf("chrome")||this.ifFirefox()},e.prototype.ifFirefox=function(){return-1<navigator.userAgent.toLowerCase().indexOf("firefox")},e.prototype.ifEdge=function(){return-1<navigator.userAgent.toLowerCase().indexOf("edge")},e.prototype.ngAfterViewChecked=function(){},e.prototype.isVisible=function(e){return!this.ifPresentation()||e===this.selectedPage},e.decorators=[{type:u.Component,args:[{selector:"app-gsp-document",template:'\x3c!-- <div id="document" class="document" gdScrollable [onRefresh]="refreshView">\n    <div class="panzoom" gdZoom [zoomActive]="!ifEdge()" gdSearchable>\n        <div [ngStyle]="divWidth" [ngClass]="(ifFirefox() && zoom > 110) ? \'page gsp-zoomed\' : \'page\'" *ngFor="let page of file?.pages" gdZoom [zoomActive]="ifEdge()" [isEdge]="ifEdge()" [style.width.pt]="ifPdf() ? page.width : \'unset\'" [style.height.pt]="(ifPdf() || ifImage()) && ifChromeOrFirefox() ? page.height : \'unset\'"\n            gdRotation [angle]="page.angle" [isHtmlMode]="mode" [width]="page.width" [height]="page.height">\n            <app-gsp-page [number]="page.number" [data]="page.data" [isHtml]="mode" [angle]="page.angle" [width]="page.width" [height]="page.height" [editable]="page.editable"></app-gsp-page>\n        </div>\n    </div>\n    <ng-content></ng-content>\n</div> --\x3e\n\n<div id="document" class="document" gdScrollable [onRefresh]="refreshView">\n    <div [ngClass]="isDesktop ? \'panzoom\' : \'panzoom mobile\'" gdZoom [zoomActive]="true" [file]="file" gdSearchable>\n        <div [ngClass]="ifExcel() ? \'page excel\' : ifPresentation() && showActiveSlide ? (isVisible(page.number) ? \'page presentation active\' : \'page presentation\') : \'page\'" *ngFor="let page of file?.pages" [style.height]="getDimensionWithUnit(page.height, page.number)"\n            [style.width]="getDimensionWithUnit(page.width, page.number)" gdRotation [angle]="page.angle" [isHtmlMode]="mode" [width]="page.width" [height]="page.height">\n            <app-gsp-page *ngIf="!showActiveSlide || isVisible(page.number)" [number]="page.number" [data]="page.data" [isHtml]="mode" [angle]="page.angle" [width]="page.width" [height]="page.height" [editable]="page.editable" gdPageMarker></app-gsp-page>\n        </div>\n    </div>\n    <ng-content></ng-content>\n</div>',styles:[".document{background-color:#e7e7e7;width:100%;height:100%;overflow-x:auto;overflow-y:auto!important;transition:.4s;padding:0;margin:0;position:relative}.page{display:inline-block;background-color:#fff;margin:20px 0;box-shadow:0 4px 12px -4px rgba(0,0,0,.38);transition:.3s}.panzoom{-webkit-transform:none;transform:none;-webkit-backface-visibility:hidden;backface-visibility:hidden;-webkit-transform-origin:0 50% 0;transform-origin:0 50% 0;display:flex;justify-content:center;flex-wrap:wrap}.gsp-zoomed{margin:10px 98px}@media (max-width:1025px){.document{overflow-x:auto!important}.page{min-width:unset!important;min-height:unset!important;margin:5px 0}}"]}]}],e.ctorParameters=function(){return[{type:u.ElementRef},{type:z},{type:D},{type:M}]},e.propDecorators={mode:[{type:u.Input}],preloadPageCount:[{type:u.Input}],file:[{type:u.Input}],selectedPage:[{type:u.Input}],showActiveSlide:[{type:u.Input}]},e}(),R=function(a){function e(e,t,i,o,n,r){var s=a.call(this,e,t,i,o)||this;return s.viewerService=n,s.renderer=r,s.panzoom=null,s.navigateService=o,s}return I(e,a),e.prototype.ngOnInit=function(){this.currentPageNo=1,document.getElementById("excelContent").style.height=document.getElementById("paneContent").offsetHeight-23+"px"},e.prototype.ngAfterViewInit=function(){var t=this;this.refreshExcelDocHeight(),this.pages.changes.subscribe(function(){t.refreshExcelDocHeight()}),this.navigateService.navigate.subscribe(function(e){e&&t.selectSheet(e)});var e=this.getScrollBarWidth();this.renderer.setStyle(this._elementRef.nativeElement.querySelector(".sheets"),"right",this.getScrollBarWidth()+"px"),this.renderer.setStyle(this._elementRef.nativeElement.querySelector(".sheets"),"bottom",this.getScrollBarWidth()+"px"),0===e&&this.renderer.setStyle(this._elementRef.nativeElement.querySelector(".sheets"),"padding-right","17px")},e.prototype.getScrollBarWidth=function(){var e=document.querySelector(".app-gsp-document");return e.offsetWidth-e.clientWidth},e.prototype.refreshExcelDocHeight=function(){this.doc=this._elementRef.nativeElement.children.item(0),this.panzoom=this._elementRef.nativeElement.children.item(0).children.item(0),this.doc.style.height=this.panzoom.scrollHeight+37+"px"},e.prototype.selectSheet=function(t){var i=this;if(this.currentPageNo=t,""==this.file.pages[t-1].data){var e={guid:this.file.filePath,password:""};this.viewerService.loadPage(e,t).subscribe(function(e){i.file.pages[t-1]=e})}},e.decorators=[{type:u.Component,args:[{selector:"app-excel-document",template:'\x3c!-- <div class="wait" *ngIf="wait">Please wait...</div> --\x3e\r\n<div class="f-utils-fill-flex-column" style="height: 100%;">\r\n    <div style="height: 100%;">\r\n        <div style="background-color: white; overflow: auto;">\r\n            <div id="document f-utils-fill" class="document">\r\n                <div id="excelContent" [ngClass]="isDesktop ? \'panzoom auto-height\' : \'panzoom mobile\'" style="overflow: auto;" gdZoom [zoomActive]="true" [file]="file" gdSearchable>\r\n                    <div [ngClass]="file.showGridLines ? \'page-grid-lines\' : \'page\'" *ngFor="let page of file?.pages" gdRotation [angle]="page.angle" [isHtmlMode]="mode">\r\n                        <app-excel-page *ngIf="currentPageNo == page.number" [number]="page.number" [data]="page.data" [isHtml]="mode" [angle]="page.angle" [width]="page.width" [height]="page.height" [editable]="page.editable">\r\n                        </app-excel-page>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <div class="sheets" style="position: absolute; bottom: 0px;">\r\n            <div class="sheets-wrapper">\r\n                <div *ngFor="let page of file?.pages">\r\n                    <button style="background-color: white; border: 0;" [ngClass]="{\'active\': currentPageNo == page.number }" (click)="selectSheet(page.number)">{{page.name}}</button>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>',styles:[":host{overflow:scroll;width:100%;background-color:#e7e7e7}.document{width:100%;transition:.4s;padding:0;margin:0;position:relative}.sheets{background-color:#fff;display:flex;border-top:1px solid #e7e7e7;position:fixed;width:100%}.sheets ::ng-deep gd-button.active .text{background-color:#272727;border-radius:10px;color:#eee}.sheets ::ng-deep gd-button .text{padding:1px 12px;color:#000}.sheets ::ng-deep gd-button fa-icon{display:none}.sheets-wrapper{margin-left:29px;display:flex}.page{position:relative;display:inline-block;background-color:#fff;transition:.3s}.wait{position:absolute;top:55px;left:Calc(30%)}.panzoom.auto-height{-webkit-transform:none;transform:none;-webkit-backface-visibility:hidden;backface-visibility:hidden;-webkit-transform-origin:50% 50% 0;transform-origin:50% 50% 0;display:flex;flex-wrap:wrap}.gd-zoomed{margin:10px 98px}.highlights{position:absolute;top:0;left:0;bottom:0;right:0}.page-grid-lines{background-color:#fff}@media (max-width:1037px){.document{overflow-x:auto!important}.page{min-width:unset!important;min-height:unset!important;margin:5px 0}}"]}]}],e.ctorParameters=function(){return[{type:u.ElementRef},{type:z},{type:D},{type:M},{type:E},{type:u.Renderer2}]},e.propDecorators={pages:[{type:u.ViewChildren,args:[F]}]},e}(L),V=function(){function e(e,t,i,o,n,r,s){this._viewerService=e,this._zoomService=t,this._navigateService=i,this._windowService=o,this.loadService=n,this.pagePreloadService=r,this.injector=s,this.title="GspCloudViewer",this.countPages=0,this.formatDisabled=!this.file,this.showThumbnails=!1,this.showSearch=!1,this._zoom=100,this.fileWasDropped=!1,this.style={transform:"",msTransform:"",oTransform:"",webkitTransform:""},this.scale=1,this.rotation=0,this.translateX=0,this.translateY=0}return e.prototype.preloadPages=function(e,t){for(var i=this,o=function(t){n._viewerService.loadPage(n.credentials,t).subscribe(function(e){i.file.pages[t-1]=e,i.file.thumbnails&&!i.file.thumbnails[t-1].data&&(e.data&&(e.data=e.data.replace(/>\s+</g,"><").replace(/\uFEFF/g,"")),i.file.thumbnails[t-1].data=e.data)})},n=this,r=e;r<=t;r++)o(r)},e.prototype.viewType=function(e){return e.filePath.endsWith(".pdf")},e.prototype.ngOnInit=function(){var i=this,e=new S;e.filePath=this.filePath;var o=this.loadService.show({message:"文档加载中"});this._viewerService.loadFileInfo(e).subscribe(function(e){if(o.close(),null!=e.error);else{if(i.file=e,i.credentials={guid:i.file.filePath,password:""},i.formatDisabled=!i.file,i.file){i.file.pages&&i.file.pages[0]&&(i._pageHeight=i.file.pages[0].height,i._pageWidth=i.file.pages[0].width,i.options=i.zoomOptions(),i.refreshZoom());var t=i.file.pages?i.file.pages.length:0;i._navigateService.countPages=t,i._navigateService.currentPage=1,i.countPages=t,i.pagePreloadService.checkPreload.subscribe(function(e){for(var t=e;t<e+2;t++)0<t&&t<=i.countPages&&!i.file.pages[t-1].data&&i.preloadPages(t,t)})}i.getFile()}i.injector&&i.injector.get(u.ChangeDetectorRef).detectChanges()})},e.prototype.rotate=function(e){var c=this;if(!this.formatDisabled){var t=this._navigateService.currentPage,f=this.loadService.show({message:"文档加载中"});if(this.saveRotateStateConfig&&this.file)this._viewerService.rotate(this.credentials,e,t).subscribe(function(e){var t,i;if(f.close(),null!=e.error);else{var o=e;try{for(var n=function l(e){var t="function"==typeof Symbol&&e[Symbol.iterator],i=0;return t?t.call(e):{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}}}(o),r=n.next();!r.done;r=n.next()){var s=r.value,a=c.file.pages[s.pageNumber-1];c.file&&c.file.pages&&a&&c.changeAngle(a,s.angle)}}catch(p){t={error:p}}finally{try{r&&!r.done&&(i=n["return"])&&i.call(n)}finally{if(t)throw t.error}}}});else{var i=this.file.pages[t-1];if(this.file&&this.file.pages&&i){var o=i.angle+e;360<o?this.changeAngle(i,90):o<-360?this.changeAngle(i,-90):this.changeAngle(i,o)}}}},e.prototype.changeAngle=function(e,t){e.angle=t},e.prototype.docChange=function(e){var i=this,t=new S;t.filePath=e;var o=this.loadService.show({message:"文档加载中"});this._viewerService.loadFileInfo(t).subscribe(function(e){if(o.close(),null!=e.error);else{if(i.file=e,i.credentials={guid:i.file.filePath,password:""},i.formatDisabled=!i.file,i.file){i.file.pages&&i.file.pages[0]&&(i._pageHeight=i.file.pages[0].height,i._pageWidth=i.file.pages[0].width,i.options=i.zoomOptions(),i.refreshZoom());var t=i.file.pages?i.file.pages.length:0;i._navigateService.countPages=t,i._navigateService.currentPage=1,i.countPages=t}i.getFile(),i.notExcel()||(i.excelView.currentPageNo=1)}})},e.prototype.getFile=function(){return this.file},e.prototype.notExcel=function(){return!(this.filePath.endsWith(".xls")||this.filePath.endsWith(".xlsx"))},Object.defineProperty(e.prototype,"rewriteConfig",{get:function(){return!this.viewerConfig||this.viewerConfig.rewrite},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"zoomConfig",{get:function(){return!this.viewerConfig||this.viewerConfig.zoom},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pageSelectorConfig",{get:function(){return!this.viewerConfig||this.viewerConfig.pageSelector},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"searchConfig",{get:function(){return!this.viewerConfig||this.viewerConfig.search},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"thumbnailsConfig",{get:function(){return!this.viewerConfig||this.viewerConfig.thumbnails},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rotateConfig",{get:function(){return!this.viewerConfig||this.viewerConfig.rotate},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"downloadConfig",{get:function(){return!this.viewerConfig||this.viewerConfig.download},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"uploadConfig",{get:function(){return!this.viewerConfig||this.viewerConfig.upload},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"printConfig",{get:function(){return!this.viewerConfig||this.viewerConfig.print},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"browseConfig",{get:function(){return!this.viewerConfig||this.viewerConfig.browse},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"htmlModeConfig",{get:function(){return!this.viewerConfig||this.viewerConfig.htmlMode},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"saveRotateStateConfig",{get:function(){return!this.viewerConfig||this.viewerConfig.saveRotateState},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"enableRightClickConfig",{get:function(){return!this.viewerConfig||this.viewerConfig.enableRightClick},enumerable:!0,configurable:!0}),e.prototype.rotateClockwise=function(){this.rotate(90)},e.prototype.rotateCounterClockwise=function(){this.rotate(-90)},Object.defineProperty(e.prototype,"currentPage",{get:function(){return this._navigateService.currentPage},enumerable:!0,configurable:!0}),e.prototype.nextPage=function(){this.formatDisabled||this._navigateService.nextPage()},e.prototype.prevPage=function(){this.formatDisabled||this._navigateService.prevPage()},e.prototype.toLastPage=function(){this.formatDisabled||this._navigateService.toLastPage()},e.prototype.toFirstPage=function(){this.formatDisabled||this._navigateService.toFirstPage()},e.prototype.navigateToPage=function(e){this.formatDisabled||this._navigateService.navigateTo(e)},e.prototype.zoomIn=function(){this.formatDisabled||this._zoom<490&&(this.zoom=this._zoom+10)},e.prototype.zoomOut=function(){this.formatDisabled||30<this._zoom&&(this.zoom=this._zoom-10)},e.prototype.zoomReset=function(){this.zoom=100},e.prototype.zoomOptions=function(){var e=this.getFitToWidth(),t=this.getFitToHeight();return this._zoomService.zoomOptions(e,t)},e.prototype.refreshZoom=function(){this.zoom=this._windowService.isDesktop()?100:this.getFitToWidth()},e.prototype.getFitToWidth=function(){var e=this.notExcel()?this.ptToPx(this._pageWidth):this._pageWidth,t=this.notExcel()?this.ptToPx(this._pageHeight):this._pageHeight,i=e||window.innerWidth;return e<t&&Math.round(i/window.innerWidth)<2?200-Math.round(100*i/window.innerWidth):Math.round(100*window.innerWidth/i)},e.prototype.getFitToHeight=function(){var e=this.notExcel()?this.ptToPx(this._pageWidth):this._pageWidth,t=this.notExcel()?this.ptToPx(this._pageHeight):this._pageHeight,i=e<t?window.innerHeight-100:window.innerHeight+100,o=t||i;return e<t?Math.round(100*i/o):Math.round(100*o/i)},e.prototype.ptToPx=function(e){return 96*e/72},Object.defineProperty(e.prototype,"zoom",{get:function(){return this._zoom},set:function(e){this._zoom=e,this._zoomService.changeZoom(this._zoom)},enumerable:!0,configurable:!0}),e.decorators=[{type:u.Component,args:[{selector:"app-doc-viewer",template:'\x3c!-- <gd-loading-mask [loadingMask]="isLoading"></gd-loading-mask> --\x3e\n<div class="f-page">\n    <div class="wrapper f-utils-fill-flex-column" style="overflow-x:auto;overflow-y: hidden;">\n        <div class="top-panel" *ngIf="notExcel()">\n            <app-gsp-top-toolbar class="toolbar-panel">\n                \x3c!-- <app-gsp-button [disabled]="formatDisabled" [icon]="\'angle-double-left\'" [tooltip]="\'First Page\'" (click)="toFirstPage()" *ngIf="pageSelectorConfig"></app-gsp-button> --\x3e\n                <div class="btn btn-secondary page-button" (click)="toFirstPage()">\n                    <img [src]="\'/platform/runtime/dfs/images/firstPage.png\'" title="\'第一页\'">\n                </div>\n                \x3c!-- <app-gsp-button [disabled]="formatDisabled" [icon]="\'angle-left\'" [tooltip]="\'Previous Page\'" (click)="prevPage()" *ngIf="pageSelectorConfig"></app-gsp-button> --\x3e\n                <div class="btn btn-secondary page-button" (click)="prevPage()">\n                    <img [src]="\'/platform/runtime/dfs/images/prePage.png\'" title="\'前一页\'">\n                </div>\n                <div class="current-page-number" [ngClass]="{\'active\': !formatDisabled}" style="position: relative;  bottom: 11px; right:-47px">{{currentPage}}/{{countPages}}\n                </div>\n                <div class="btn btn-secondary page-button" (click)="nextPage()">\n                    <img [src]="\'/platform/runtime/dfs/images/nextPage.png\'" title="\'后一页\'">\n                </div>\n                <div class="btn btn-secondary page-button" (click)="toLastPage()">\n                    <img [src]="\'/platform/runtime/dfs/images/lastPage.png\'" title="\'最后一页\'">\n                </div>\n                \x3c!-- <app-gsp-button [disabled]="formatDisabled" [icon]="\'angle-right\'" [tooltip]="\'Next Page\'" (click)="nextPage()" *ngIf="pageSelectorConfig"></app-gsp-button>\n                <app-gsp-button [disabled]="formatDisabled" [icon]="\'angle-double-right\'" [tooltip]="\'Last Page\'" (click)="nextPage()" *ngIf="pageSelectorConfig"></app-gsp-button> --\x3e\n            </app-gsp-top-toolbar>\n        </div>\n        <div class="doc-panel  f-utils-fill-flex-column" *ngIf="file">\n\n            <app-gsp-document class="gsp-document" *ngIf="file &&  notExcel()" [file]="getFile()" [mode]="htmlModeConfig" [preloadPageCount]="viewerConfig?.preloadPageCount" [ngStyle]="style"></app-gsp-document>\n            <app-excel-document class="gsp-document" *ngIf="file &&  !notExcel() " style="overflow: hidden;" [file]="getFile()" [mode]="htmlModeConfig" gdScrollable [preloadPageCount]="viewerConfig?.preloadPageCount">\n            </app-excel-document>\n\n        </div>\n    </div>\n</div>',styles:[":host *{font-family:'Open Sans',Arial,Helvetica,sans-serif}.current-page-number{margin-left:7px;font-size:14px;color:#959da5;width:37px;height:37px;line-height:37px;text-align:center}.current-page-number.active{color:#fff}.page-button{background-color:#212529;width:28px;height:28px;border:none;position:relative;bottom:14px;right:-50px}.page-button img{position:relative;left:-13px}.wrapper{align-items:stretch;height:100%;width:100%;position:absolute;top:0;bottom:0;left:0;right:0}.doc-panel{display:flex}.thumbnails-button{position:absolute;right:3px}.gsp-document{width:100%;height:100%}.top-panel{display:flex;align-items:center;width:100%;height:32px}.toolbar-panel{background-color:#3e4e5a;width:100%;height:32px}::ng-deep .tools .button,::ng-deep .tools .nav-caret,::ng-deep .tools .selected-value{color:#fff!important}::ng-deep .tools .button.inactive,::ng-deep .tools .nav-caret.inactive,::ng-deep .tools .selected-value.inactive{color:#959da5!important}::ng-deep .tools .button{flex-flow:column}::ng-deep .tools .dropdown-menu .option{color:#6e6e6e!important}::ng-deep .tools .dropdown-menu .option:hover{background-color:#4b566c!important}::ng-deep .tools .icon-button{margin:0 0 0 7px!important}::ng-deep .tools .select{width:65px;height:37px;margin-left:7px;line-height:37px;text-align:center}"]}]}],e.ctorParameters=function(){return[{type:E},{type:z},{type:M},{type:D},{type:m.LoadingService},{type:k},{type:u.Injector}]},e.propDecorators={excelView:[{type:u.ViewChild,args:[R]}],filePath:[{type:u.Input}]},e}(),H=function(){function e(){}return e.prototype.ngOnInit=function(){/*@cc_on!@*/!!/(MSIE|Trident\/|Edge\/)/i.test(navigator.userAgent)&&0===this.number&&(this.editable=!1)},e.prototype.ngOnChanges=function(e){this.isHtml?this.data=this.data?this.data.replace(/>\s+</g,"><").replace(/\uFEFF/g,""):null:this.data&&(this.imgData=this.data.startsWith("data:image")?this.data:"data:image/png;base64,"+this.data)},e.decorators=[{type:u.Component,args:[{selector:"app-gsp-page",template:'<div id="page-{{number}}">\n  <div class="gsp-wrapper" [innerHTML]="data | safeHtml" *ngIf="data && isHtml" [contentEditable]="(editable) ? true : false"></div>\n  <img class="gsp-page-image" [style.width.px]="width" [style.height.px]="height" [attr.src]="imgData | safeResourceHtml"\n       alt=""\n       *ngIf="data && !isHtml">\n  <div class="gsp-page-spinner" *ngIf="!data">\n  </div>\n</div>',styles:[".gsp-page-spinner{margin-top:150px;text-align:center}.gsp-wrapper{width:inherit;height:inherit}.gsp-wrapper img{width:inherit}.gsp-wrapper div{width:100%}.gsp-highlight{background-color:#ff0}.gsp-highlight-select{background-color:#ff9b00}.gsp-page-image{height:100%!important;width:100%!important}"]}]}],e.ctorParameters=function(){return[]},e.propDecorators={angle:[{type:u.Input}],width:[{type:u.Input}],height:[{type:u.Input}],number:[{type:u.Input}],data:[{type:u.Input}],isHtml:[{type:u.Input}],editable:[{type:u.Input}]},e}(),W=(function(){function e(){}e.decorators=[{type:u.Injectable,args:[{providedIn:"root"}]}],e.ngInjectableDef=u.defineInjectable({factory:function(){return new e},token:e,providedIn:"root"})}(),function(n){function e(e,t,i){var o=n.call(this,e,t)||this;return o.content=i,o}I(e,n)}(function _e(e,t){this.guid=e,this.password=t}),function(){function n(){}return n.find=function(e,t){if(!e||t)return n.map.folder;var i=e.split("."),o=i.pop().toLowerCase();return"undefined"==typeof n.map[o]?0<i.length?n.map.unknown:n.map.folder:n.map[o]},n.map={folder:{format:"",icon:"folder"},pdf:{format:"Portable Document Format",icon:"file-pdf"},doc:{format:"Microsoft Word",icon:"file-word"},docx:{format:"Microsoft Word",icon:"file-word"},docm:{format:"Microsoft Word",icon:"file-word"},dot:{format:"Microsoft Word",icon:"file-word"},dotx:{format:"Microsoft Word",icon:"file-word"},dotm:{format:"Microsoft Word",icon:"file-word"},xls:{format:"Microsoft Excel",icon:"file-excel"},xlsx:{format:"Microsoft Excel",icon:"file-excel"},xlsm:{format:"Microsoft Excel",icon:"file-excel"},xlsb:{format:"Microsoft Excel",icon:"file-excel"},xls2003:{format:"Microsoft Excel",icon:"file-excel"},xltx:{format:"Microsoft Excel",icon:"file-excel"},xltm:{format:"Microsoft Excel",icon:"file-excel"},ppt:{format:"Microsoft PowerPoint",icon:"file-powerpoint"},pptx:{format:"Microsoft PowerPoint",icon:"file-powerpoint"},pps:{format:"Microsoft PowerPoint",icon:"file-powerpoint"},ppsx:{format:"Microsoft PowerPoint",icon:"file-powerpoint"},vsd:{format:"Microsoft Visio",icon:"file-code"},vdx:{format:"Microsoft Visio",icon:"file-code"},vss:{format:"Microsoft Visio",icon:"file-code"},vsx:{format:"Microsoft Visio",icon:"file-code"},vst:{format:"Microsoft Visio",icon:"file-code"},vtx:{format:"Microsoft Visio",icon:"file-code"},vsdx:{format:"Microsoft Visio",icon:"file-code"},vdw:{format:"Microsoft Visio",icon:"file-code"},vstx:{format:"Microsoft Visio",icon:"file-code"},vssx:{format:"Microsoft Visio",icon:"file-code"},mpp:{format:"Microsoft Project",icon:"file-alt"},mpt:{format:"Microsoft Project",icon:"file-alt"},msg:{format:"Microsoft Outlook",icon:"file-alt"},eml:{format:"Microsoft Outlook",icon:"file-alt"},emlx:{format:"Microsoft Outlook",icon:"file-alt"},one:{format:"Microsoft OneNote",icon:"file-word"},odt:{format:"Open Document Text",icon:"file-word"},ott:{format:"Open Document Text Template",icon:"file-word"},ods:{format:"Open Document Spreadsheet",icon:"file-excel"},odp:{format:"Open Document Presentation",icon:"file-powerpoint"},otp:{format:"Open Document Presentation",icon:"file-powerpoint"},ots:{format:"Open Document Presentation",icon:"file-powerpoint"},potx:{format:"Open Document Presentation",icon:"file-powerpoint"},potm:{format:"Open Document Presentation",icon:"file-powerpoint"},pptm:{format:"Open Document Presentation",icon:"file-powerpoint"},ppsm:{format:"Open Document Presentation",icon:"file-powerpoint"},rtf:{format:"Rich Text Format",icon:"file-alt"},txt:{format:"Plain Text File",icon:"file-alt"},csv:{format:"Comma-Separated Values",icon:"file-excel"},html:{format:"HyperText Markup Language",icon:"file-word"},mht:{format:"HyperText Markup Language",icon:"file-word"},mhtml:{format:"HyperText Markup Language",icon:"file-word"},xml:{format:"Extensible Markup Language",icon:"file-word"},xps:{format:"XML Paper Specification",icon:"file-word"},dxf:{format:"AutoCAD Drawing File Format",icon:"file-image"},dwg:{format:"AutoCAD Drawing File Format",icon:"file-image"},bmp:{format:"Bitmap Picture",icon:"file-image"},gif:{format:"Graphics Interchange Format",icon:"file-image"},jpg:{format:"Joint Photographic Experts Group",icon:"file-image"},jpe:{format:"Joint Photographic Experts Group",icon:"file-image"},jpeg:{format:"Joint Photographic Experts Group",icon:"file-image"},jfif:{format:"Joint Photographic Experts Group",icon:"file-image"},png:{format:"Portable Network Graphics",icon:"file-image"},tiff:{format:"Tagged Image File Format",icon:"file-image"},tif:{format:"Tagged Image File Format",icon:"file-image"},psd:{format:"Tagged Image File Format",icon:"file-image"},svg:{format:"Tagged Image File Format",icon:"file-image"},jp2:{format:"Tagged Image File Format",icon:"file-image"},epub:{format:"Electronic Publication",icon:"file-pdf"},ico:{format:"Windows Icon",icon:"file-image"},webp:{format:"Compressed Image",icon:"file-image"},mobi:{format:"Mobipocket eBook",icon:"file-pdf"},tex:{format:"LaTeX Source Document",icon:"file-pdf"},djvu:{format:"Multi-Layer Raster Image",icon:"file-alt"},unknown:{format:"This format is not supported",icon:"file"}},n}()),A=function(){function e(e,t,i){this._zoomService=e,this._windowService=t,this.zoomActive=!0,this.el=i}return e.prototype.ngOnDestroy=function(){},e.prototype.ngOnChanges=function(){this.setStyles(this._zoomService.zoom),this.resizePages(this._zoomService.zoom)},e.prototype.ngOnInit=function(){var t=this;this.zoomActive&&(this.setStyles(this._zoomService.zoom),this._zoomService.zoomChange.subscribe(function(e){t.setStyles(e),t.resizePages(e)}))},e.prototype.setStyles=function(e){if(this.zoomActive){var t=100===e?1:e/100;this._windowService.isEdge()?this.zoomInt=t:this.zoomInt=null,this._windowService.isEdge()?(this.transform="",this.transformOrigin=""):(this.transform="scale("+t+")",this.transformOrigin="top left");var i=0;this.file.pages.forEach(function(e){e.width>i&&(i=e.width)}),this.minWidth=i+W.find(this.file.guid,!1).unit}},e.prototype.getScrollWidth=function(e){return e.offsetWidth-e.clientWidth},e.prototype.getScrollHeight=function(e){return e.offsetHeight-e.clientHeight},e.prototype.resizePages=function(e){var t=100===e?1:e/100,i=this.el.nativeElement.parentElement.offsetWidth,o=this.el.nativeElement.parentElement.offsetHeight,n=this.getScrollWidth(this.el.nativeElement.parentElement),r=this.getScrollHeight(this.el.nativeElement.parentElement);this.width=i/t-n/t+"px",this.height=o/t-r/t+"px"},e.prototype.ngAfterViewInit=function(){this.setStyles(this._zoomService.zoom)},e.decorators=[{type:u.Directive,args:[{selector:"[gdZoom]"}]}],e.ctorParameters=function(){return[{type:z},{type:D},{type:u.ElementRef}]},e.propDecorators={zoomActive:[{type:u.Input}],file:[{type:u.Input}],zoomInt:[{type:u.HostBinding,args:["style.zoom"]}],transform:[{type:u.HostBinding,args:["style.transform"]}],transformOrigin:[{type:u.HostBinding,args:["style.transform-origin"]}],width:[{type:u.HostBinding,args:["style.width"]}],height:[{type:u.HostBinding,args:["style.height"]}],minWidth:[{type:u.HostBinding,args:["style.min-width"]}]},e}(),N=function(){function e(){this.isIE=!!/(MSIE|Trident\/|Edge\/)/i.test(navigator.userAgent)}return e.prototype.restoreSelection=function(){(this.selection&&!this.selection.collapsed||this.isIE)&&this.putSelection(this.selection)},e.prototype.captureSelection=function(){var e=window.getSelection();0<e.rangeCount&&(this.selection=e.getRangeAt(0))},e.prototype.putSelection=function(e){var t=window.getSelection();t.removeAllRanges(),t.addRange(e.cloneRange())},e.prototype.refreshSelection=function(){this.captureSelection(),this.restoreSelection()},e.decorators=[{type:u.Injectable,args:[{providedIn:"root"}]}],e.ngInjectableDef=u.defineInjectable({factory:function(){return new e},token:e,providedIn:"root"}),e}(),U=function(){function e(){this._observer=new a.Subject,this._textChange=this._observer.asObservable(),this._observerCurrent=new a.Subject,this._currentChange=this._observerCurrent.asObservable(),this._observerTotal=new a.Subject,this._totalChange=this._observerTotal.asObservable()}return Object.defineProperty(e.prototype,"textChange",{get:function(){return this._textChange},enumerable:!0,configurable:!0}),e.prototype.setText=function(e){this._observer.next(e)},Object.defineProperty(e.prototype,"currentChange",{get:function(){return this._currentChange},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"totalChange",{get:function(){return this._totalChange},enumerable:!0,configurable:!0}),e.prototype.setCurrent=function(e){this._observerCurrent.next(e)},e.prototype.setTotal=function(e){this._observerTotal.next(e)},e.decorators=[{type:u.Injectable}],e.ctorParameters=function(){return[]},e}(),B=function(){function e(e,t,i){var o=this;this._elementRef=e,this._searchService=t,this._zoomService=i,this.current=0,this.total=0,this.zoom=100,t.currentChange.subscribe(function(e){o.current=e,o.current}),t.textChange.subscribe(function(e){o.text=e}),this.zoom=i.zoom?i.zoom:this.zoom,i.zoomChange.subscribe(function(e){o.zoom=e||o.zoom})}return e.prototype.getZoom=function(){return this.zoom/100},e.decorators=[{type:u.Directive,args:[{selector:"[gdSearchable]"}]}],e.ctorParameters=function(){return[{type:u.ElementRef},{type:U},{type:z}]},e}(),q=function(){function e(){this.withMargin=!0}return e.prototype.updateCursor=function(){"string"==typeof this.angle&&(this.angle=parseInt(this.angle,10)),this.angle?(this.animation="none",this.transition="none",this.transform="rotate("+this.angle+"deg)"):0===this.angle&&this.animation&&(this.animation=null,this.transition=null,this.transform=null),this.withMargin&&(90===this.angle||270===this.angle||-90===this.angle||-270===this.angle?this.isHtmlMode?this.isLandscape()?this.margin="164px 254px":this.margin="-111px 254px":this.isLandscape()?this.margin="129px 100px -79px":this.margin="-72px 100px -79px":-180===this.angle||180===this.angle?this.margin="280px":this.margin=null)},e.prototype.isLandscape=function(){return this.width>this.height},e.prototype.ngOnInit=function(){this.updateCursor()},e.prototype.ngOnChanges=function(e){this.updateCursor()},e.decorators=[{type:u.Directive,args:[{selector:"[gdRotation]"}]}],e.ctorParameters=function(){return[]},e.propDecorators={angle:[{type:u.Input}],isHtmlMode:[{type:u.Input}],width:[{type:u.Input}],height:[{type:u.Input}],withMargin:[{type:u.Input}],animation:[{type:u.HostBinding,args:["style.animation"]}],transition:[{type:u.HostBinding,args:["style.transition-property"]}],transform:[{type:u.HostBinding,args:["style.transform"]}],margin:[{type:u.HostBinding,args:["style.margin"]}]},e}(),Z=function(){function e(e){this.sanitizer=e}return e.prototype.transform=function(e){return this.sanitizer.bypassSecurityTrustHtml(e)},e.decorators=[{type:u.Pipe,args:[{name:"safeHtml"}]}],e.ctorParameters=function(){return[{type:l.DomSanitizer}]},e}(),G=function(){function e(e){this.sanitizer=e}return e.prototype.transform=function(e){return this.sanitizer.bypassSecurityTrustResourceUrl(e)},e.decorators=[{type:u.Pipe,args:[{name:"safeResourceHtml"}]}],e.ctorParameters=function(){return[{type:l.DomSanitizer}]},e}(),X=function(){function e(e){this.sanitizer=e}return e.prototype.transform=function(e){return this.sanitizer.bypassSecurityTrustStyle(e)},e.decorators=[{type:u.Pipe,args:[{name:"safeStyle"}]}],e.ctorParameters=function(){return[{type:l.DomSanitizer}]},e}(),J=y,Y=function(){function e(){}return e.prototype.checkInViewport=function(e,t,i,o){if(void 0===t&&(t=100),void 0===i&&(i=0),void 0===o&&(o=.5),!e)return!1;var n=o,r=J(window),s=r.scrollTop(),a=r.scrollLeft()+i,l=r.scrollLeft()+r.width()-10,p=r.scrollTop()+r.height();isNaN(t)&&(t=100);var c=t/100,f=J(e).outerHeight()*c,h=J(e).outerWidth()*c;if(!h||!f)return!1;var d=J(e).offset(),g=d.left*c+h,u=d.top*c+f;if(!!(l<d.left*c||g<a||p<d.top*c||u<s))return!1;var m=Math.min(1,(u-s)/f),v=Math.min(1,(p-d.top*c)/f);return n<=Math.min(1,(g-a)/h)*Math.min(1,(l-d.left*c)/h)&&.5<=m*v},e.decorators=[{type:u.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[]},e.ngInjectableDef=u.defineInjectable({factory:function(){return new e},token:e,providedIn:"root"}),e}(),$=t,K=function(){function e(e,t,i,o,n,r){var s=this;this._elementRef=e,this._navigateService=t,this._pagePreloadService=i,this._zoomService=o,this._windowService=n,this._viewportService=r,this.zoom=100,this.zoom=o.zoom?o.zoom:this.zoom,o.zoomChange.subscribe(function(e){s.zoom=e||s.zoom,s.refresh()})}return e.prototype.ngAfterViewInit=function(){var t=this;this.zoom=this._zoomService.zoom?this._zoomService.zoom:this.zoom,this._navigateService.navigate.subscribe(function(e){t.currentPage=e,t.scrollToPage(e)}),this.refresh()},e.prototype.scrolling=function(){this.refresh()},e.prototype.resizing=function(){this.refresh()},e.prototype.scrollToPage=function(e){var t=this._elementRef.nativeElement,i=this.getPage(e),o=0<e?this.getPage(e-1):null,n=o&&$(o).offset().top===$(i).offset().top;if(!this._viewportService.checkInViewport(i,this.zoom)||!n){var r={left:0,top:this.calculateOffset(e)};t&&t.scrollTo(r)}},e.prototype.getChildren=function(){var e=this._elementRef?this._elementRef.nativeElement:null;if(e)return e.children.item(0).children},e.prototype.getPage=function(e){var t=this._elementRef?this._elementRef.nativeElement:null;if(t)return t.children.item(0).children.item(e-1)},e.prototype.calculateOffset=function(e){for(var t=this.ifFirefox()?1:this.countPagesOnWidth(),i=this._windowService.isDesktop()?40:10,o=0,n=1;n<e/t;n++){var r=this.getPage(n),s=r?r.clientHeight:0;o+=0<s?s*this.getZoom()+i:0}return o},e.prototype.countPagesOnWidth=function(){var e=this.getPage(1),t=Math.floor((this.getWidth()-150)/(e.getBoundingClientRect().width*this.getZoom()));return 0===t?1:t},e.prototype.ifFirefox=function(){return-1<navigator.userAgent.toLowerCase().indexOf("firefox")},e.prototype.refresh=function(){var e,t=!1,i=this.getPage(this.currentPage),o=this.currentPage&&i?i.getBoundingClientRect():null;for(e=1;e<this.getChildren().length+1;e++){var n=this.getPage(e);this._viewportService.checkInViewport(n,this.zoom)&&(t||((!this.currentPage||!i||this.currentPage&&o&&n.getBoundingClientRect().top!==o.top)&&(this.currentPage=e,this._navigateService.currentPage=e),t=!0),this._pagePreloadService.changeLastPageInView(e))}},e.prototype.ngOnChanges=function(e){this.refresh()},e.prototype.ngOnInit=function(){this.zoom=this._zoomService.zoom?this._zoomService.zoom:this.zoom},e.prototype.getWidth=function(){return this._elementRef?this._elementRef.nativeElement.offsetWidth:window.innerWidth},e.prototype.getZoom=function(){return this.zoom/100},e.decorators=[{type:u.Directive,args:[{selector:"[gdScrollable]"}]}],e.ctorParameters=function(){return[{type:u.ElementRef},{type:M},{type:k},{type:z},{type:D},{type:Y}]},e.propDecorators={onRefresh:[{type:u.Input}],scrolling:[{type:u.HostListener,args:["scroll"]}],resizing:[{type:u.HostListener,args:["window:resize"]}]},e}(),Q=function(){function e(){}return e.decorators=[{type:u.NgModule,args:[{declarations:[L,H,R,F,A,B,q,Z,G,X,K],imports:[g.CommonModule],exports:[L,R,A,B],entryComponents:[L,R],providers:[z,N,U,k]}]}],e}(),ee=y,te=function(){function e(e,t,i){this._elementRef=e,this._viewportService=t,this._cdRef=i,this.leftOffset=!0}return e.prototype.ngOnInit=function(){this.refresh();var e=this.getToolsElem(),t=this;e.addEventListener("scroll",function(){t.refresh()})},e.prototype.moveLeft=function(){var e=this.getToolsElem();if(e){var t=this.canMoveTo(!0);if(t){var i={left:ee(t).offset().left+e.scrollLeft-this.getLeftOffset(),top:0};e.scrollTo(i)}}},e.prototype.moveRight=function(){var e=this.getToolsElem();if(e){var t=this.canMoveTo(!1);if(t){var i={left:ee(t).offset().left+e.scrollLeft-this.getLeftOffset(),top:0};e.scrollTo(i)}}},e.prototype.getToolsElem=function(){return this._elementRef?this._elementRef.nativeElement.children[0].querySelector("#tools"):null},e.prototype.canMoveTo=function(e){var t,i=this.getChildren(),o=i.length;for(t=0;t<o;t++){var n=this.getElem(t);if(this._viewportService.checkInViewport(n,100,this.getLeftOffset()))return e?0<t?i.item(t-1):null:t+1<o?i.item(t+1):null}},e.prototype.getElem=function(e){var t=this.getChildren();return t.item(null!==e?e:t.length-1)},e.prototype.getChildren=function(){var e=this.getToolsElem();if(e)return e.children},e.prototype.getLeftOffset=function(){if(!this.leftOffset)return 0;var e=this._elementRef.nativeElement?this._elementRef.nativeElement.parentElement.children[0]:null;return e?e.clientWidth:0},e.prototype.refresh=function(){this.showLeft=!this._viewportService.checkInViewport(this.getElem(0),100,this.getLeftOffset(),.8),this.showRight=!this._viewportService.checkInViewport(this.getElem(null),100,this.getLeftOffset(),.8)},e.prototype.ngAfterViewChecked=function(){var e=!this._viewportService.checkInViewport(this.getElem(0),100,this.getLeftOffset(),.8),t=!this._viewportService.checkInViewport(this.getElem(null),100,this.getLeftOffset(),.8);e===this.showLeft&&t===this.showRight||(this.showLeft=e,this.showRight=t,this._cdRef.detectChanges())},e.decorators=[{type:u.Component,args:[{selector:"app-gsp-top-toolbar",template:'<div class="top-toolbar">\n    \x3c!-- <app-gsp-button [className]="\'arrow-button\'" class="arrow-left" id="left" [icon]="\'caret-left\'" [tooltip]="\'Scroll left\'" (click)="moveLeft()" *ngIf="showLeft">\n    </app-gsp-button> --\x3e\n    <div id="tools" class="tools">\n        <ng-content></ng-content>\n    </div>\n    \x3c!-- <app-gsp-button [className]="\'arrow-button\'" class="arrow-right" id="right" [icon]="\'caret-right\'" [tooltip]="\'Scroll right\'" (click)="moveRight()" *ngIf="showRight">\n    </app-gsp-button> --\x3e\n</div>',styles:[".top-toolbar{width:100%;height:60px;z-index:999;display:flex;align-items:center}.tools{width:100%;height:100%;display:flex;align-items:center}@media (max-width:1037px){.top-toolbar{height:60px}.arrow-right{position:absolute;right:0}.arrow-left{position:absolute;left:0}.tools{height:100%;overflow-x:auto;display:flex;align-items:center;transition:.3s ease-in-out;scroll-behavior:smooth;-webkit-overflow-scrolling:touch}.tools::-webkit-scrollbar{width:0;height:0;background-color:#3e4e5a}}"]}]}],e.ctorParameters=function(){return[{type:u.ElementRef},{type:Y},{type:u.ChangeDetectorRef}]},e.propDecorators={leftOffset:[{type:u.Input}]},e}(),ie=function(){function e(){}return e.decorators=[{type:u.NgModule,args:[{declarations:[te],imports:[g.CommonModule],exports:[te],entryComponents:[te]}]}],e}(),oe=function(){function e(){}return e.decorators=[{type:u.NgModule,args:[{declarations:[V],imports:[g.CommonModule,Q,ie],exports:[V],entryComponents:[V],providers:[k,M]}]}],e}(),ne=function(){function e(){}return e.prototype.ngOnInit=function(){this.ocx=suwell.ofdReaderInit("ofdDiv","100%","100%"),this.ocx.setCompsiteVisible("f_open",!0),this.ocx.openFile(this.filePath,!0)},e.prototype.fileChange=function(e){this.filePath=e,this.ocx.openFile(e,!0)},e.decorators=[{type:u.Component,args:[{selector:"app-ofd-viewer",template:'<div id="ofdDiv" style="width:100%;height:100%;" ></div>\n',styles:[""]}]}],e.ctorParameters=function(){return[]},e.propDecorators={filePath:[{type:u.Input}]},e}(),re=function(){function e(){}return e.decorators=[{type:u.NgModule,args:[{declarations:[ne],imports:[g.CommonModule],exports:[ne],entryComponents:[ne]}]}],e}(),se={FileSystem:0,Url:1,UniFile:2,Customer:3};se[se.FileSystem]="FileSystem",se[se.Url]="Url",se[se.UniFile]="UniFile",se[se.Customer]="Customer";var ae=function Ee(){},le=function ze(){},pe=function ke(){},ce=function(){function e(e,t){this.http=e,this.httpClient=t}return e.prototype.getViewFile=function(e,t){var i=new ae;i.storageType=t,i.filePath=e;var o=i;return this.http.request("Post","/api/runtime/dfs/v1.0/fileviewer/file",this.setHeader({body:o})).pipe(r.tap(function(e){}),r.catchError(function(e){return a.of(e)}))},e.prototype.getFormFileList=function(e,t){var i=new le;i.formId=e,i.rootId=t;var o=new ae;o.storageType=se.UniFile,o.filePath=JSON.stringify(i);var n=o;return this.http.request("Post","/api/runtime/dfs/v1.0/fileviewer/filelist",this.setHeader({body:n})).pipe(r.tap(function(e){}),r.catchError(function(e){return a.of(e)}))},e.prototype.setHeader=function(e){return e.headers={"Content-Type":"application/json"},e},e.prototype.getFileList=function(e,t){void 0===t&&(t="");var i=new le;i.metadataIdList=e,i.rootId=t;var o=new ae;o.storageType=se.UniFile,o.filePath=JSON.stringify(i);var n=o;return this.http.request("Post","/api/runtime/dfs/v1.0/fileviewer/filelist",this.setHeader({body:n})).pipe(r.tap(function(e){}),r.catchError(function(e){return a.of(e)}))},e.prototype.getMergedFile=function(e,t){var i={responseType:"blob"},o=new pe;return o.metadataIdList=e,o.rootId=t,o.token=this.getToken(this.mergeString(e[0],t)),this.httpClient.post("/api/runtime/dfs/v1.0/doc/mergepdf",o,i).pipe(r.tap(function(e){}),r.catchError(function(e){return a.of(e)}))},e.prototype.mergeString=function(e,t){var i=e.length<t.length?e.length:t.length,o="",n=0;for(n=0;n<i;n++)o+=e.substring(n,n+1),o+=t.substring(n,n+1);return o+=e.length<t.length?t.substring(n):e.substring(n)},e.prototype.getToken=function(e){var t=[1,2,3];24<e.length&&(e=e.substring(0,24));var i=Math.floor(e.length/3),o=e.substring(0,i),n=e.substring(i,2*i),r=e.substring(2*i,3*i),s=[],a=Math.ceil(3*Math.random());s.push(t[a-1]),t.splice(a-1,1),a=Math.ceil(2*Math.random()),s.push(t[a-1]),t.splice(a-1,1),s.push(t[0]);var l=Math.round((new Date).getTime()/1e3)+"";return l.substring(0,5)+"times"+s[0]+s[1]+s[2]+this.switchStr(o,n,r,s[0])+this.switchStr(o,n,r,s[1])+this.switchStr(o,n,r,s[2])+"times"+l.substring(5)},e.prototype.switchStr=function(e,t,i,o){switch(o){case 1:return e;case 2:return t;case 3:return i}},e.decorators=[{type:u.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:n.HttpService},{type:s.HttpClient}]},e.ngInjectableDef=u.defineInjectable({factory:function(){return new e(u.inject(n.HttpService),u.inject(s.HttpClient))},token:e,providedIn:"root"}),e}(),fe={Image:0,Ofd:1,Pdf:2,Ppt:3,Document:4};fe[fe.Image]="Image",fe[fe.Ofd]="Ofd",fe[fe.Pdf]="Pdf",fe[fe.Ppt]="Ppt",fe[fe.Document]="Document";var he=function(){function e(e){this.sanitizer=e,this.pdfUrl="",this.baseUrl="/platform/common/web/pdfjs/viewer.html?file="}return e.prototype.ngOnInit=function(){this.viewUrl=this.sanitizer.bypassSecurityTrustResourceUrl(this.getViewUrl(this.baseUrl+encodeURIComponent(this.pdfUrl)))},e.prototype.pdfChange=function(e){this.viewUrl=this.sanitizer.bypassSecurityTrustResourceUrl(this.getViewUrl(this.baseUrl+encodeURIComponent(e)))},e.prototype.getViewUrl=function(e){return this.viewOptions.showPaging||(e+="&showpaging=false"),this.viewOptions.showHeader||(e+="&showheader=false"),this.viewOptions.showThumbnails||(e+="&showthumbnails=false"),this.viewOptions.showDownload||(e+="&showdownload=false"),this.viewOptions.showSearch||(e+="&showsearch=false"),this.viewOptions.showPrint||(e+="&showprint=false"),this.viewOptions.showZoom||(e+="&showzoom=false"),this.viewOptions.showSecondaryToolBar||(e+="&showsecondarytoolbar=false"),e},e.decorators=[{type:u.Component,args:[{selector:"app-pdf-viewer",template:'<iframe id="viewframe" [src]="viewUrl" height="100%" width="100%"></iframe>',styles:[""]}]}],e.ctorParameters=function(){return[{type:l.DomSanitizer}]},e.propDecorators={pdfUrl:[{type:u.Input}],viewOptions:[{type:u.Input}]},e}(),de=function(){function e(e){this.sanitizer=e}return e.prototype.ngOnInit=function(){this.viewUrl=this.sanitizer.bypassSecurityTrustResourceUrl(this.pptUrl)},e.prototype.pptChange=function(e){this.viewUrl=this.sanitizer.bypassSecurityTrustResourceUrl(e)},e.decorators=[{type:u.Component,args:[{selector:"app-ppt-viewer",template:'<div class="f-page"><iframe id="viewPpt" [src]="viewUrl" height="100%" width="100%"></iframe></div>',styles:[""]}]}],e.ctorParameters=function(){return[{type:l.DomSanitizer}]},e.propDecorators={pptUrl:[{type:u.Input}]},e}(),ge=function(){function e(e,t,i,o){this.listService=e,this.msgService=t,this.loadService=i,this.injector=o,this.formId="123456",this.rootId="default-root",this.metadataIdList=[],this.index=0,this.metadataId="",this.fileList=[],this.isImage=!0,this.isOfd=!0,this.isPdf=!0,this.isPpt=!0,this.isDocShow=!1,this.isOfdShow=!1,this.isPdfShow=!1,this.isPptShow=!1,this.isFileListOpend=!1}return e.prototype.ngOnInit=function(){var t=this,i=this.loadService.show({message:"拼命的请求中"});0<this.metadataIdList.length?this.listService.getFileList(this.metadataIdList,this.rootId).subscribe(function(e){(i.close(),null!=e.error)?t.msgService.warning("获取表单附件信息失败,请稍后重试。"):(t.fileList=e,t.getFileIcon(),t.getIndex(),t.fileChange(),t.injector&&t.injector.get(u.ChangeDetectorRef).detectChanges())}):this.listService.getFormFileList(this.formId,this.rootId).subscribe(function(e){(i.close(),null!=e.error)?t.msgService.warning("获取表单附件信息失败,请稍后重试。"):(t.fileList=e,t.getFileIcon(),t.getIndex(),t.fileChange(),t.injector&&t.injector.get(u.ChangeDetectorRef).detectChanges())})},e.prototype.getIndex=function(){var t=this;null==this.metadataId||""==this.metadataId?this.index=0:0==this.fileList.filter(function(e){return e.metadataId==t.metadataId}).length?this.index=0:this.index=this.fileList.indexOf(this.fileList.filter(function(e){return e.metadataId==t.metadataId})[0])},e.prototype.fileChange=function(){if(this.file=this.fileList[this.index],this.isImage=this.file.fileType==fe.Image||"Image"==this.file.fileType,this.isOfd=this.file.fileType==fe.Ofd||"Ofd"==this.file.fileType,this.isPdf=this.file.fileType==fe.Pdf||"Pdf"==this.file.fileType,this.isPpt=this.file.fileType==fe.Ppt||"Ppt"==this.file.fileType,this.isImage)return this.isDocShow=!1,this.isOfdShow=!1,void(this.isPptShow=!1);this.isOfd?this.isOfdShow?this.ofdChange(this.file.filePath):(this.isDocShow=!1,this.isOfdShow=!0,this.isPdfShow=!1,this.isPptShow=!1):this.isPdf?this.isPdfShow?this.pdfChange(this.file.filePath):(this.isDocShow=!1,this.isOfdShow=!1,this.isPdfShow=!0,this.isPptShow=!1):this.isPpt?this.isPptShow?this.pptChange(this.file.filePath):(this.isDocShow=!1,this.isOfdShow=!1,this.isPdfShow=!1,this.isPptShow=!0):this.isDocShow?this.docChange(this.file.filePath):(this.isDocShow=!0,this.isOfdShow=!1,this.isPdfShow=!1,this.isPptShow=!1)},e.prototype.listBackColor=function(e){if(this.file==e)return{"background-color":"#E6F7FF"}},e.prototype.fileSelect=function(e){this.index=this.fileList.indexOf(e),this.fileChange()},e.prototype.imageChange=function(e){this.imageUrl=e,this.imageViewer.imageChange(e)},e.prototype.docChange=function(e){this.docPath=e,this.docViewer.docChange(e)},e.prototype.pdfChange=function(e){this.pdfViewer.pdfChange(e)},e.prototype.pptChange=function(e){this.pptViewer.pptChange(e)},e.prototype.ofdChange=function(e){this.ofdViewer.fileChange(e)},e.prototype.getFileIcon=function(){var t=!0,i=!1;this.fileList.forEach(function(e){t=e.fileType==fe.Image||"Image"==e.fileType,i=e.fileType==fe.Ofd||"Ofd"==e.fileType,t||i||(e.fileName.substring(e.fileName.lastIndexOf(".")).includes("doc")||e.fileName.substring(e.fileName.lastIndexOf(".")).includes("docx")||e.fileName.substring(e.fileName.lastIndexOf(".")).includes("wps")?e.fileUrl="/platform/runtime/dfs/images/word.png":e.fileName.substring(e.fileName.lastIndexOf(".")).includes("xls")||e.fileName.substring(e.fileName.lastIndexOf(".")).includes("xlsx")||e.fileName.substring(e.fileName.lastIndexOf(".")).includes("et")?e.fileUrl="/platform/runtime/dfs/images/excel.png":e.fileName.substring(e.fileName.lastIndexOf(".")).includes("ppt")||e.fileName.substring(e.fileName.lastIndexOf(".")).includes("pptx")||e.fileName.substring(e.fileName.lastIndexOf(".")).includes("dps")?e.fileUrl="/platform/runtime/dfs/images/ppt.png":e.fileName.substring(e.fileName.lastIndexOf(".")).includes("pdf")?e.fileUrl="/platform/runtime/dfs/images/pdf.png":e.fileName.substring(e.fileName.lastIndexOf(".")).includes("txt")?e.fileUrl="/platform/runtime/dfs/images/txt.png":e.fileUrl="/platform/runtime/dfs/images/file.png"),i&&(e.fileUrl="/platform/runtime/dfs/images/file.png")})},e.prototype.isShowFileList=function(){this.isFileListOpend=!this.isFileListOpend},e.prototype.download=function(){window.open(this.file.downloadUrl)},e.prototype.zoomIn=function(){this.isImage?this.imageViewer.zoomIn():this.isOfd||this.docViewer.zoomIn()},e.prototype.zoomOut=function(){this.isImage?this.imageViewer.zoomOut():this.isOfd||this.docViewer.zoomOut()},e.prototype.zoomReset=function(){this.isImage?this.imageViewer.zoomReset():this.isOfd||this.docViewer.zoomReset()},e.prototype.rotateClockwise=function(){this.isImage?this.imageViewer.rotateClockwise():this.isOfd||this.docViewer.rotateClockwise()},e.prototype.rotateCounterClockwise=function(){this.isImage?this.imageViewer.rotateCounterClockwise():this.isOfd||this.docViewer.rotateCounterClockwise()},e.decorators=[{type:u.Component,args:[{selector:"app-file-list",template:'<div class="f-utils-absolute-all">\n    <kendo-splitter style="height:100%;width:100%" orientation="vertical">\n        <kendo-splitter-pane [collapsible]="true" size="50px" [resizable]=\'false\'>\n\n            <div style="width: 100%">\n                <div class="btn btn-secondary upload_button" (click)="isShowFileList()" style="left:40px;border:0">\n                    <img [src]="\'/platform/runtime/dfs/images/discount.png\'" class="upload_button" style="top:0;left:0" title="\'文档列表\'">\n                </div>\n                <div class="btn btn-secondary upload_button" (click)="download()" style="left:90px;border:0">\n                    <img [src]="\'/platform/runtime/dfs/images/download.png\'" class="upload_button" style="top:0;left:0" title="\'下载\'">\n                </div>\n                <div *ngIf="!isOfd && !isPdf && !isPpt" class="btn btn-secondary upload_button" (click)="zoomIn()" style="left:50%; margin-left: -12.5px;;border:0">\n                    <img [src]="\'/platform/runtime/dfs/images/zoomin.png\'" class="upload_button" style="top:0;left:0" title="\'放大\'">\n                </div>\n                <div *ngIf="!isOfd && !isPdf && !isPpt" class="btn btn-secondary upload_button" (click)="zoomOut()" style="left:50%; margin-left: -62.5px;;border:0">\n                    <img [src]="\'/platform/runtime/dfs/images/zoomout.png\'" class="upload_button" style="top:0;left:0" title="\'缩小\'">\n                </div>\n                <div *ngIf="!isOfd && !isPdf && !isPpt" class="btn btn-secondary upload_button" (click)="zoomReset()" style="left:50%; margin-left: 37.5px;;border:0">\n                    <img [src]="\'/platform/runtime/dfs/images/zoomreset.png\'" class="upload_button" style="top:2.5px;left:2.5px;width:20px;height:20px" title="\'重置\'">\n                </div>\n                <div *ngIf="!isOfd && !isPdf && !isPpt" class="btn btn-secondary upload_button" (click)="rotateClockwise()" style="right:40px;border:0">\n                    <img [src]="\'/platform/runtime/dfs/images/rotate.png\'" class="upload_button" style="top:0;left:0" title="\'顺时针旋转\'">\n                </div>\n                <div *ngIf="!isOfd && !isPdf && !isPpt" class="btn btn-secondary upload_button" (click)="rotateCounterClockwise()" style="right:90px;border:0">\n                    <img [src]="\'/platform/runtime/dfs/images/conrotate.png\'" class="upload_button" style="top:0;left:0" title="\'逆时针旋转\'">\n                </div>\n            </div>\n\n        </kendo-splitter-pane>\n        <kendo-splitter-pane>\n            <kendo-splitter style="height:100%;width:100%">\n                <kendo-splitter-pane [collapsible]="true" size="200px" [collapsed]="isFileListOpend" [resizable]=\'false\' [scrollable]=\'true\' style="overflow-x:hidden">\n                    <ul *ngFor="let src of fileList" class="pic_list" [ngStyle]="listBackColor(src)">\n                        <a (click)="fileSelect(src)">\n                            <div>\n                                <img [src]=\'src.fileUrl\'>\n                            </div>\n                            <p>{{src.fileName}}</p>\n                        </a>\n                    </ul>\n                </kendo-splitter-pane>\n                <kendo-splitter-pane id="paneContent" [scrollable]=\'true\'>\n                    <div *ngIf=\'isImage&&!isOfd&&!isPdf&&!isPpt\'>\n                        <app-image-viewer [imageUrl]="file.fileUrl"></app-image-viewer>\n                    </div>\n                    <div *ngIf=\'!isImage&&!isOfd&&!isPdf&&!isPpt\'>\n                        <app-doc-viewer [filePath]="file.filePath"></app-doc-viewer>\n                    </div>\n                    <div *ngIf=\'!isImage&&isOfd&&!isPdf&&!isPpt\'>\n                        <app-ofd-viewer [filePath]="file.filePath"></app-ofd-viewer>\n                    </div>\n                    <div *ngIf=\'!isImage&&!isOfd&&!isPdf&&isPpt\'>\n                        <app-ppt-viewer [pptUrl]="file.filePath"></app-ppt-viewer>\n                    </div>\n                    <div *ngIf=\'!isImage&&!isOfd&&isPdf&&!isPpt\' class="f-utils-fill" style="height: 100%">\n                        <app-pdf-viewer [pdfUrl]="file.filePath" [viewOptions]="viewOptions"></app-pdf-viewer>\n                    </div>\n                </kendo-splitter-pane>\n            </kendo-splitter>\n        </kendo-splitter-pane>\n    </kendo-splitter>\n</div>',styles:[".button-group{width:100%;height:50px;display:table-cell}.button-group button{width:25px;height:25px;vertical-align:middle;position:absolute;top:12.5px}.button-group button img{width:25px;height:25px;vertical-align:middle}.pic_list{border:1px solid #ddd;padding:0;list-style:none;width:200px;height:200px;text-align:center}.pic_list a div{display:table-cell;vertical-align:middle;text-align:center;width:120px;height:140px;margin:20px 40px 10px}.pic_list a div img{vertical-align:middle;text-align:center;max-width:120px;max-height:140px}.pic_list a p{width:170px;height:40px;font-size:14px;text-align:center;overflow:hidden;text-overflow:ellipsis;word-wrap:break-word;word-break:break-all;white-space:nowrap;margin:10px 15px 0}.upload_button{width:25px;height:25px;vertical-align:middle;position:absolute;top:12.5px}"]}]}],e.ctorParameters=function(){return[{type:ce},{type:v.MessagerService},{type:m.LoadingService},{type:u.Injector}]},e.propDecorators={formId:[{type:u.Input}],rootId:[{type:u.Input}],metadataIdList:[{type:u.Input}],index:[{type:u.Input}],metadataId:[{type:u.Input}],viewOptions:[{type:u.Input}],imageViewer:[{type:u.ViewChild,args:[b]}],docViewer:[{type:u.ViewChild,args:[V]}],ofdViewer:[{type:u.ViewChild,args:[ne]}],pdfViewer:[{type:u.ViewChild,args:[he]}],pptViewer:[{type:u.ViewChild,args:[de]}]},e}(),ue=function(){function e(){}return e.decorators=[{type:u.NgModule,args:[{declarations:[he],imports:[g.CommonModule],exports:[he],entryComponents:[he]}]}],e}(),me=function(){function e(){}return e.decorators=[{type:u.NgModule,args:[{declarations:[de],imports:[g.CommonModule],exports:[de],entryComponents:[de]}]}],e}(),ve=function(){function e(){}return e.decorators=[{type:u.NgModule,args:[{declarations:[ge],imports:[g.CommonModule,x,oe,re,i.LayoutModule,o.ButtonsModule,ue,me],exports:[ge],entryComponents:[ge],providers:[n.HttpService,n.SessionService,m.LoadingService,q,U,N,z,O,E,ce,M,k,D,f.CloudprintService,f.ɵa,f.ɵb,f.ɵc,h.AppService,p.WindowService,p.WindowContainerService]}]}],e}(),we=function Me(){this.showHeader=!0,this.showPaging=!0,this.showThumbnails=!0,this.showDownload=!0,this.showSearch=!0,this.showZoom=!0,this.showPrint=!0,this.showSecondaryToolBar=!0},ye=function(){function e(e,t,i,o,n,r,s){this.modalService=e,this.componentFactoryResolver=t,this.injector=i,this.fileListService=o,this.msgService=n,this.cloudprintService=r,this.appService=s,this.windowWidth=window.innerWidth,this.windowHeigth=window.innerHeight}return e.prototype.viewerFormFile=function(i,o,n){var r=this;return void 0===n&&(n=new we),new Promise(function(e){var t=r.componentFactoryResolver.resolveComponentFactory(ge).create(r.injector);t.instance.rootId=o,t.instance.formId=i,r.dlg=r.modalService.show(t,{title:"",width:document.scrollingElement.clientWidth-20,height:document.scrollingElement.clientWidth-20,showButtons:!1,showMaxButton:!1,resizable:!1}),r.dlg.content.viewOptions=n})},e.prototype.viewerFileList=function(i,o,n){var r=this;return void 0===n&&(n=new we),new Promise(function(e){var t=r.componentFactoryResolver.resolveComponentFactory(ge).create(r.injector);t.instance.rootId=o,t.instance.metadataIdList=i,r.dlg=r.modalService.show(t,{title:"",width:document.scrollingElement.clientWidth-20,height:document.scrollingElement.clientWidth-20,showButtons:!1,showMaxButton:!1,resizable:!1,opened:function(){setTimeout(function(){r.dlg.dialog.changeDetectorRef._appRef.tick()},500)}}),r.dlg.content.viewOptions=n})},e.prototype.viewerFormFileWithIndex=function(i,o,n,r){var s=this;return void 0===r&&(r=new we),new Promise(function(e){var t=s.componentFactoryResolver.resolveComponentFactory(ge).create(s.injector);t.instance.rootId=o,t.instance.formId=i,t.instance.metadataId=n,s.dlg=s.modalService.show(t,{title:"",width:document.scrollingElement.clientWidth-20,height:document.scrollingElement.clientWidth-20,showButtons:!1,showMaxButton:!1,resizable:!1,opened:function(){setTimeout(function(){s.dlg.dialog.changeDetectorRef._appRef.tick()},500)}}),s.dlg.content.viewOptions=r})},e.prototype.viewerFileListWithIndex=function(i,o,n,r){var s=this;return void 0===r&&(r=new we),new Promise(function(e){var t=s.componentFactoryResolver.resolveComponentFactory(ge).create(s.injector);t.instance.rootId=o,t.instance.metadataIdList=i,t.instance.metadataId=n,s.dlg=s.modalService.show(t,{title:"",width:document.scrollingElement.clientWidth-20,height:document.scrollingElement.clientWidth-20,showButtons:!1,showMaxButton:!1,resizable:!1,opened:function(){setTimeout(function(){s.dlg.dialog.changeDetectorRef._appRef.tick()},500)}}),s.dlg.content.viewOptions=r})},e.prototype.mergeAndViewPdfFiles=function(e,t){var i=this;this.fileListService.getMergedFile(e,t).subscribe(function(e){if(null!=e.error)i.msgService.error(e.error.Message);else{var t={OutputType:f.OutputType.PRINT,FileType:f.FileType.Pdf,Path:"",DeviceId:"",printType:f.PrintType.Form};i.cloudprintService.openRendedViewer4Attachment("tab",e,t)}})},e.prototype.viewerFormFileInpage=function(e,t,i){void 0===i&&(i=new we),this.viewerFormFileWithIndexInPage(e,t,null,i)},e.prototype.viewerFileListInPage=function(e,t,i){void 0===i&&(i=new we),this.viewerFileListWithIndexInPage(e,t,null,i)},e.prototype.viewerFormFileWithIndexInPage=function(e,t,i,o){void 0===o&&(o=new we),this.appService.openAppByOptions({appType:"app",funcId:"",tabName:"文档在线预览",appId:"6ccb476b-f2ba-df8f-6f47-d37d100c56e2",appEntrance:"docviewertab",tabId:d.UUID.UUID(),entityParams:{formId:e,rootId:t,metadataId:i,viewOptions:o}})},e.prototype.viewerFileListWithIndexInPage=function(e,t,i,o){void 0===o&&(o=new we),this.appService.openAppByOptions({appType:"app",funcId:"",tabName:"文档在线预览",appId:"6ccb476b-f2ba-df8f-6f47-d37d100c56e2",appEntrance:"docviewertab",tabId:d.UUID.UUID(),entityParams:{metadataIdList:e,rootId:t,metadataId:i,viewOptions:o}})},e.decorators=[{type:u.Injectable}],e.ctorParameters=function(){return[{type:c.BsModalService},{type:u.ComponentFactoryResolver},{type:u.Injector},{type:ce},{type:v.MessagerService},{type:f.CloudprintService},{type:h.AppService}]},e}(),be=function De(){},xe=function Te(){},Pe=function Fe(){},Ie=function(){function e(e,t,i){this.listService=e,this.msgService=t,this.loadService=i,this.viewOptions=new we,this.isImage=!0,this.isOfd=!0,this.isPdf=!0,this.isDocShow=!1,this.isOfdShow=!1,this.isPdfShow=!1}return e.prototype.ngOnInit=function(){this.viewFile(this.filePath,this.metadataId,this.rootId,this.fileType,this.fileName,this.serviceUnit,this.params)},e.prototype.ngOnChanges=function(e){this.viewFile(this.filePath,this.metadataId,this.rootId,this.fileType,this.fileName,this.serviceUnit,this.params)},e.prototype.viewFile=function(e,t,i,o,n,r,s){var a,l=this;o==se.UniFile&&((a=new be).metadataId=t,a.rootId=i,e=JSON.stringify(a));o==se.Url&&((a=new xe).fileUrl=e,a.fileName=n,e=JSON.stringify(a));o==se.Customer&&((a=new Pe).suName=r,a.param=s,e=JSON.stringify(a));var p=this.loadService.show({message:"拼命的请求中"});this.listService.getViewFile(e,o).subscribe(function(e){p.close(),null!=e.error?l.msgService.warning("获取预览文件失败"+e.error.Message):(l.file=e,l.fileChange())})},e.prototype.fileChange=function(){if(this.isImage=this.file.fileType==fe.Image||"Image"==this.file.fileType,this.isOfd=this.file.fileType==fe.Ofd||"Ofd"==this.file.fileType,this.isPdf=this.file.fileType==fe.Pdf||"Pdf"==this.file.fileType,this.isImage)return this.isDocShow=!1,void(this.isOfdShow=!1);this.isOfd?this.isOfdShow?this.ofdChange(this.file.filePath):(this.isDocShow=!1,this.isOfdShow=!0,this.isPdfShow=!1):this.isPdf?this.isPdfShow?this.pdfChange(this.file.filePath):(this.isDocShow=!1,this.isOfdShow=!1,this.isPdfShow=!0):this.isDocShow?this.docChange(this.file.filePath):(this.isDocShow=!0,this.isOfdShow=!1,this.isPdfShow=!1)},e.prototype.imageChange=function(e){this.imageUrl=e,this.imageViewer.imageChange(e)},e.prototype.docChange=function(e){this.docPath=e,this.docViewer.docChange(e)},e.prototype.pdfChange=function(e){this.pdfViewer.pdfChange(e)},e.prototype.ofdChange=function(e){this.ofdViewer.fileChange(e)},e.decorators=[{type:u.Component,args:[{selector:"gsp-viewer",template:'<div class="f-page">\n    <div *ngIf=\'isImage&&!isOfd&&!isPdf\'>\n        <app-image-viewer [imageUrl]="file.fileUrl"></app-image-viewer>\n    </div>\n    <div *ngIf=\'!isImage&&!isOfd&&!isPdf\'>\n        <app-doc-viewer [filePath]="file.filePath"></app-doc-viewer>\n    </div>\n    <div *ngIf=\'!isImage&&isOfd&&!isPdf\'>\n        <app-ofd-viewer [filePath]="file.filePath"></app-ofd-viewer>\n    </div>\n    <div *ngIf=\'!isImage&&!isOfd&&isPdf\' class="f-utils-fill" style="height: 100%">\n        <app-pdf-viewer [pdfUrl]="file.filePath" [viewOptions]="viewOptions"></app-pdf-viewer>\n    </div>\n</div>',styles:[""]}]}],e.ctorParameters=function(){return[{type:ce},{type:v.MessagerService},{type:m.LoadingService}]},e.propDecorators={filePath:[{type:u.Input}],metadataId:[{type:u.Input}],rootId:[{type:u.Input}],fileName:[{type:u.Input}],fileType:[{type:u.Input}],viewOptions:[{type:u.Input}],serviceUnit:[{type:u.Input}],params:[{type:u.Input}],imageViewer:[{type:u.ViewChild,args:[b]}],docViewer:[{type:u.ViewChild,args:[V]}],ofdViewer:[{type:u.ViewChild,args:[ne]}],pdfViewer:[{type:u.ViewChild,args:[he]}]},e}(),Se=function(){function e(){}return e.decorators=[{type:u.NgModule,args:[{declarations:[Ie],imports:[g.CommonModule,x,oe,re,ue,w.NotifyModule.forRoot()],exports:[Ie],entryComponents:[Ie],providers:[q,U,N,z,O,E,ce,M,k,D]}]}],e}();e.ɵg=oe,e.ɵc=V,e.ɵh=Q,e.ɵi=L,e.ɵk=H,e.ɵp=Z,e.ɵq=G,e.ɵr=X,e.ɵo=q,e.ɵn=U,e.ɵm=B,e.ɵs=N,e.ɵl=A,e.ɵj=z,e.ɵf=x,e.ɵb=b,e.ɵt=re,e.ɵe=ne,e.ɵz=O,e.ɵd=E,e.ɵa=ce,e.ɵv=M,e.ɵu=k,e.ɵy=D,e.FileListModule=ve,e.FileListComponent=ge,e.FileViewerService=ye,e.PdfViewOptions=we,e.GspViewerModule=Se,e.GspViewerComponent=Ie,e.ScrollableDirective=K,e.ɵw=R,e.ɵx=F,e.ɵbf=te,e.ɵbe=ie,e.ɵbg=ue,e.ɵbb=he,e.ɵbh=me,e.ɵbc=de,e.ɵba=T,e.ɵbd=Y,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=gsp-svc-file-viewer.umd.min.js.map