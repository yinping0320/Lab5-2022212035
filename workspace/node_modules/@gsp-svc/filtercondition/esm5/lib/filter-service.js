/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Injectable, Injector, ApplicationRef, ComponentFactoryResolver } from "@angular/core";
import { FilterConditionComponent } from "./filter-condition/filter-condition.component";
import { Schema } from "@gsp-svc/expression";
import { InjectedEntity } from "@gsp-svc/expression";
import { FilterInjectedEntity, FilterInjectedType } from "./injected-entity";
import { PropertyAdapter } from "./property-adapter";
import { Adapter } from "./adapter";
import { BsModalService } from '@farris/ui-modal';
import { HttpClient } from "@angular/common/http";
/**
 * 过滤表达式服务类
 * @author linchang 2018/12/10
 */
var FilterService = /** @class */ (function () {
    function FilterService(injector, applicationRef, compFactRes, http) {
        this.injector = injector;
        this.applicationRef = applicationRef;
        this.compFactRes = compFactRes;
        this.http = http;
        this.i = 0;
        this.adapter = new Adapter();
        //属性列表
        this.propertyList = [];
        //预置计算表达式变量
        this.contextEntity = [];
        this.expressionText = null;
        this.expressionSchema = Array();
        this.expressionInjectedEntities = [];
        this.expressionCDT = [];
        //预置条件表达式变量
        this.filterExpressionString = null; //过滤表达式序列化串
        //过滤表达式序列化串
        this.schemaMap = new Map();
        this.newSchemaMap = new Map(); //过滤表达式添加NewSchema
        this.exprWinWidth = 850;
        this.modalService = this.injector.get(BsModalService);
    }
    // 创建表达式
    // 创建表达式
    /**
     * @return {?}
     */
    FilterService.prototype.buildExpression = 
    // 创建表达式
    /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var that = this;
        return new Promise((/**
         * @param {?} resolve
         * @return {?}
         */
        function (resolve) {
            /** @type {?} */
            var compFactory = that.compFactRes.resolveComponentFactory(FilterConditionComponent);
            /** @type {?} */
            var compRef = compFactory.create(that.injector);
            compRef.instance.propertyList = that.propertyList;
            compRef.instance.contextEntity = that.contextEntity;
            compRef.instance.expressionCDT = that.expressionCDT;
            compRef.instance.expressionSchema = that.expressionSchema;
            compRef.instance.expressionText = that.expressionText;
            compRef.instance.expressionInjectedEntities = that.expressionInjectedEntities;
            compRef.instance.filterExpressionString = that.filterExpressionString;
            compRef.instance.schemaMap = that.schemaMap;
            //===================组件加入newSchemaMap===============
            compRef.instance.newSchemaMap = that.newSchemaMap;
            //=====================================================    
            compRef.instance.exprWinWidth = that.exprWinWidth;
            that.localePipe = compRef.instance.localePipe;
            /** @type {?} */
            var dialog = that.modalService.show(compRef, {
                title: that.localePipe.transform("WindowTitle"),
                width: 1010,
                height: 550,
                showButtons: false
            });
            compRef.instance.closed.subscribe((/**
             * @param {?} $event
             * @return {?}
             */
            function ($event) { return dialog.close(); }));
            compRef.instance.result.subscribe((/**
             * @param {?} expressionContent
             * @return {?}
             */
            function (expressionContent) {
                return resolve(expressionContent);
            }));
        }));
    };
    /**
     *  预置属性列表
     * @param name 属性语义
     * @param displayName 展示名称
     * @param propertyDataType 属性数据类型
     */
    /**
     *  预置属性列表
     * @param {?} name 属性语义
     * @param {?} displayName 展示名称
     * @param {?} propertyDataType 属性数据类型
     * @return {?}
     */
    FilterService.prototype.addProperty = /**
     *  预置属性列表
     * @param {?} name 属性语义
     * @param {?} displayName 展示名称
     * @param {?} propertyDataType 属性数据类型
     * @return {?}
     */
    function (name, displayName, propertyDataType) {
        /** @type {?} */
        var propertyEntity = {
            text: displayName,
            propertyDataType: propertyDataType,
            value: name,
            parentItem: null
        };
        this.propertyList = this.propertyList.filter((/**
         * @param {?} item
         * @return {?}
         */
        function (item) { return item.value !== name; }));
        this.propertyList.push(propertyEntity);
    };
    /**
     * 添加上下文变量
     * @param contextEntity 上下文变量
     */
    /**
     * 添加上下文变量
     * @param {?} contextEntity 上下文变量
     * @return {?}
     */
    FilterService.prototype.addExpressionContext = /**
     * 添加上下文变量
     * @param {?} contextEntity 上下文变量
     * @return {?}
     */
    function (contextEntity) {
        this.contextEntity = this.contextEntity.filter((/**
         * @param {?} item
         * @return {?}
         */
        function (item) { return item.key !== contextEntity.key; }));
        this.contextEntity.push(contextEntity);
    };
    /**
     * 预置表达式默认显示
     * @param text 预置文本
     */
    /**
     * 预置表达式默认显示
     * @param {?} text 预置文本
     * @return {?}
     */
    FilterService.prototype.addExpressionText = /**
     * 预置表达式默认显示
     * @param {?} text 预置文本
     * @return {?}
     */
    function (text) {
        this.expressionText = text;
    };
    /**
     * 预置Schema
     * @param name schema名称
     * @param schema schema实体
     */
    /**
     * 预置Schema
     * @param {?} name schema名称
     * @param {?} schema schema实体
     * @return {?}
     */
    FilterService.prototype.addExpressionSchema = /**
     * 预置Schema
     * @param {?} name schema名称
     * @param {?} schema schema实体
     * @return {?}
     */
    function (name, schema) {
        this.expressionSchema = this.expressionSchema.filter((/**
         * @param {?} item
         * @return {?}
         */
        function (item) { return item.name !== name; }));
        this.expressionSchema.push({ name: name, schema: schema });
    };
    /**
     * 预置注册实体
     * @param name 注册实体名
     * @param schemaName 所在schema的名
     * @param typeNameInSchema 在schema中名称
     * @param injectedType 注册的类型
     * @author linchang 2018/12/10
     */
    /**
     * 预置注册实体
     * @author linchang 2018/12/10
     * @param {?} name 注册实体名
     * @param {?} schemaName 所在schema的名
     * @param {?} typeNameInSchema 在schema中名称
     * @param {?} injectedType 注册的类型
     * @return {?}
     */
    FilterService.prototype.addExpressionInjectedEntity = /**
     * 预置注册实体
     * @author linchang 2018/12/10
     * @param {?} name 注册实体名
     * @param {?} schemaName 所在schema的名
     * @param {?} typeNameInSchema 在schema中名称
     * @param {?} injectedType 注册的类型
     * @return {?}
     */
    function (name, schemaName, typeNameInSchema, injectedType) {
        //构造注入实体对象
        /** @type {?} */
        var injectedEntity = new InjectedEntity();
        injectedEntity.name = name;
        injectedEntity.schemaName = schemaName;
        injectedEntity.injectedName = typeNameInSchema;
        injectedEntity.injectedType = injectedType;
        this.expressionInjectedEntities.push(injectedEntity);
    };
    /**
     * 预置CDT
     * @param gspCDTs 预置的CDT集合
     */
    /**
     * 预置CDT
     * @param {?} gspCDTs 预置的CDT集合
     * @return {?}
     */
    FilterService.prototype.addExpressionCDT = /**
     * 预置CDT
     * @param {?} gspCDTs 预置的CDT集合
     * @return {?}
     */
    function (gspCDTs) {
        this.expressionCDT = gspCDTs;
    };
    /**
     * 预置过滤条件表达式
     * @param filterExpression 预置的过滤表达式串
     */
    /**
     * 预置过滤条件表达式
     * @param {?} filterExpression 预置的过滤表达式串
     * @return {?}
     */
    FilterService.prototype.addFilterCondition = /**
     * 预置过滤条件表达式
     * @param {?} filterExpression 预置的过滤表达式串
     * @return {?}
     */
    function (filterExpression) {
        this.filterExpressionString = filterExpression;
    };
    /**
     * 预置schema
     * @param name schema名,默认为CO
     * @param filterSchema schema实体
     */
    /**
     * 预置schema
     * @param {?} name schema名,默认为CO
     * @param {?} filterSchema schema实体
     * @return {?}
     */
    FilterService.prototype.addSchema = /**
     * 预置schema
     * @param {?} name schema名,默认为CO
     * @param {?} filterSchema schema实体
     * @return {?}
     */
    function (name, filterSchema) {
        if (filterSchema == null) {
            alert("Schema Cannot Null");
        }
        else
            this.schemaMap.set(name, filterSchema);
    };
    /**
     * 添加注入实体
     * @param name 注入实体在schema中的名称
     * @param schemaName 注入实体所在的schema名
     * @param injectedType 注入类型，不填默认为EntityType
     */
    /**
     * 添加注入实体
     * @param {?} name 注入实体在schema中的名称
     * @param {?} schemaName 注入实体所在的schema名
     * @param {?=} injectedType 注入类型，不填默认为EntityType
     * @return {?}
     */
    FilterService.prototype.addInjectedEntity = /**
     * 添加注入实体
     * @param {?} name 注入实体在schema中的名称
     * @param {?} schemaName 注入实体所在的schema名
     * @param {?=} injectedType 注入类型，不填默认为EntityType
     * @return {?}
     */
    function (name, schemaName, injectedType) {
        if (injectedType === void 0) { injectedType = FilterInjectedType.EntityType; }
        this.injectedEntity = new FilterInjectedEntity();
        this.injectedEntity.name = name;
        this.injectedEntity.schemaName = schemaName;
        this.injectedEntity.injectedType = injectedType;
        /** @type {?} */
        var propertyAdapter = new PropertyAdapter();
        this.propertyList = propertyAdapter.adapter(this.injectedEntity, this.schemaMap);
    };
    /**
     * 添加GSPCommonObject
     * @param commonObject 待转化CO
     */
    /**
     * 添加GSPCommonObject
     * @param {?} commonObject 待转化CO
     * @return {?}
     */
    FilterService.prototype.addCommonObject = /**
     * 添加GSPCommonObject
     * @param {?} commonObject 待转化CO
     * @return {?}
     */
    function (commonObject) {
        /** @type {?} */
        var schema;
        //若schemaMap中存在CO的schema
        if (this.schemaMap.get("CommonObject")) {
            schema = this.schemaMap.get("CommonObject");
        }
        else
            schema = new Schema;
        //将每一个CO转化为schema内部结构中的entityType
        /** @type {?} */
        var entityTypes = this.adapter.convertCO(commonObject);
        entityTypes.forEach((/**
         * @param {?} entityType
         * @return {?}
         */
        function (entityType) {
            schema.entityTypes = schema.entityTypes.filter((/**
             * @param {?} item
             * @return {?}
             */
            function (item) { return item.name !== entityType.name; }));
            schema.entityTypes.push(entityType);
        }));
        //将合并后的schema放入内部上下文实体中
        this.addSchema("CommonObject", schema);
    };
    /**
     * 设置计算表达式弹出框宽度
     * @param exprWinWidth
     */
    /**
     * 设置计算表达式弹出框宽度
     * @param {?} exprWinWidth
     * @return {?}
     */
    FilterService.prototype.addExprWinWidth = /**
     * 设置计算表达式弹出框宽度
     * @param {?} exprWinWidth
     * @return {?}
     */
    function (exprWinWidth) {
        this.exprWinWidth = exprWinWidth;
    };
    //======================华丽分割线之统一结构Schema============================================================
    /**
     * @description 向newSchemaMap中添加NewSchema
     * @param name Map中的key值
     * @param schema Map的value
     */
    //======================华丽分割线之统一结构Schema============================================================
    /**
     * \@description 向newSchemaMap中添加NewSchema
     * @param {?} name Map中的key值
     * @param {?} schema Map的value
     * @return {?}
     */
    FilterService.prototype.addNewSchema = 
    //======================华丽分割线之统一结构Schema============================================================
    /**
     * \@description 向newSchemaMap中添加NewSchema
     * @param {?} name Map中的key值
     * @param {?} schema Map的value
     * @return {?}
     */
    function (name, schema) {
        if (name != null && name != "" && schema != null) {
            this.newSchemaMap.set(name, schema);
        }
        else {
            alert("Name or Schema is null !");
        }
    };
    /**
     * 添加注入实体
     * @param name 注入实体在schema中的名称
     * @param schemaName 注入实体所在的schema名
     * @param injectedType 注入类型，默认为EntityType
     */
    /**
     * 添加注入实体
     * @param {?} name 注入实体在schema中的名称
     * @param {?} schemaName 注入实体所在的schema名
     * @param {?=} injectedType 注入类型，默认为EntityType
     * @return {?}
     */
    FilterService.prototype.addInjectedEntityOfNewSchema = /**
     * 添加注入实体
     * @param {?} name 注入实体在schema中的名称
     * @param {?} schemaName 注入实体所在的schema名
     * @param {?=} injectedType 注入类型，默认为EntityType
     * @return {?}
     */
    function (name, schemaName, injectedType) {
        if (injectedType === void 0) { injectedType = FilterInjectedType.EntityType; }
        this.injectedEntity = new FilterInjectedEntity();
        this.injectedEntity.name = name;
        this.injectedEntity.schemaName = schemaName;
        this.injectedEntity.injectedType = injectedType;
        /** @type {?} */
        var propertyAdapter = new PropertyAdapter();
        this.propertyList = propertyAdapter.adapterOfNewSchema(this.injectedEntity, this.newSchemaMap);
    };
    FilterService.decorators = [
        { type: Injectable }
    ];
    /** @nocollapse */
    FilterService.ctorParameters = function () { return [
        { type: Injector },
        { type: ApplicationRef },
        { type: ComponentFactoryResolver },
        { type: HttpClient }
    ]; };
    return FilterService;
}());
export { FilterService };
if (false) {
    /** @type {?} */
    FilterService.prototype.i;
    /** @type {?} */
    FilterService.prototype.adapter;
    /** @type {?} */
    FilterService.prototype.propertyList;
    /** @type {?} */
    FilterService.prototype.contextEntity;
    /** @type {?} */
    FilterService.prototype.expressionText;
    /** @type {?} */
    FilterService.prototype.expressionSchema;
    /** @type {?} */
    FilterService.prototype.expressionInjectedEntities;
    /** @type {?} */
    FilterService.prototype.expressionCDT;
    /** @type {?} */
    FilterService.prototype.filterExpressionString;
    /** @type {?} */
    FilterService.prototype.schemaMap;
    /** @type {?} */
    FilterService.prototype.newSchemaMap;
    /** @type {?} */
    FilterService.prototype.injectedEntity;
    /** @type {?} */
    FilterService.prototype.exprWinWidth;
    /** @type {?} */
    FilterService.prototype.localePipe;
    /** @type {?} */
    FilterService.prototype.localeId;
    /**
     * @type {?}
     * @private
     */
    FilterService.prototype.modalService;
    /** @type {?} */
    FilterService.prototype.simpleModalConfig;
    /**
     * @type {?}
     * @private
     */
    FilterService.prototype.injector;
    /**
     * @type {?}
     * @private
     */
    FilterService.prototype.applicationRef;
    /**
     * @type {?}
     * @private
     */
    FilterService.prototype.compFactRes;
    /**
     * @type {?}
     * @private
     */
    FilterService.prototype.http;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZmlsdGVyLXNlcnZpY2UuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZ3NwLXN2Yy9maWx0ZXJjb25kaXRpb24vIiwic291cmNlcyI6WyJsaWIvZmlsdGVyLXNlcnZpY2UudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUFBLE9BQU8sRUFBRSxVQUFVLEVBQUUsUUFBUSxFQUFFLGNBQWMsRUFBRSx3QkFBd0IsRUFBcUIsTUFBTSxlQUFlLENBQUM7QUFDbEgsT0FBTyxFQUFFLHdCQUF3QixFQUFFLE1BQU0sK0NBQStDLENBQUM7QUFJekYsT0FBTyxFQUFFLE1BQU0sRUFBRSxNQUFNLHFCQUFxQixDQUFDO0FBQzdDLE9BQU8sRUFBRSxjQUFjLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQztBQUVyRCxPQUFPLEVBQUUsb0JBQW9CLEVBQUUsa0JBQWtCLEVBQUUsTUFBTSxtQkFBbUIsQ0FBQztBQUU3RSxPQUFPLEVBQUUsZUFBZSxFQUFFLE1BQU0sb0JBQW9CLENBQUM7QUFFckQsT0FBTyxFQUFFLE9BQU8sRUFBRSxNQUFNLFdBQVcsQ0FBQztBQUNwQyxPQUFPLEVBQUUsY0FBYyxFQUFFLE1BQU0sa0JBQWtCLENBQUM7QUFJbEQsT0FBTyxFQUFFLFVBQVUsRUFBRSxNQUFNLHNCQUFzQixDQUFDOzs7OztBQUtsRDtJQXNCSSx1QkFDWSxRQUFrQixFQUNsQixjQUE4QixFQUM5QixXQUFxQyxFQUNyQyxJQUFnQjtRQUhoQixhQUFRLEdBQVIsUUFBUSxDQUFVO1FBQ2xCLG1CQUFjLEdBQWQsY0FBYyxDQUFnQjtRQUM5QixnQkFBVyxHQUFYLFdBQVcsQ0FBMEI7UUFDckMsU0FBSSxHQUFKLElBQUksQ0FBWTtRQXhCNUIsTUFBQyxHQUFXLENBQUMsQ0FBQztRQUNkLFlBQU8sR0FBWSxJQUFJLE9BQU8sRUFBRSxDQUFDOztRQUVqQyxpQkFBWSxHQUFtRyxFQUFFLENBQUM7O1FBRWxILGtCQUFhLEdBQWdCLEVBQUUsQ0FBQztRQUNoQyxtQkFBYyxHQUFXLElBQUksQ0FBQztR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bEgsc0NBQWdDOztJQUNoQyx1Q0FBOEI7O0lBQzlCLHlDQUE2RDs7SUFDN0QsbURBQWtEOztJQUNsRCxzQ0FBd0M7O0lBRXhDLCtDQUFzQzs7SUFDdEMsa0NBQWtEOztJQUNsRCxxQ0FBNEM7O0lBQzVDLHVDQUFxQzs7SUFDckMscUNBQTJCOztJQUMzQixtQ0FBc0M7O0lBQ3RDLGlDQUFpQjs7Ozs7SUFDakIscUNBQXFDOztJQUNyQywwQ0FBa0I7Ozs7O0lBRWQsaUNBQTBCOzs7OztJQUMxQix1Q0FBc0M7Ozs7O0lBQ3RDLG9DQUE2Qzs7Ozs7SUFDN0MsNkJBQXdCIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgSW5qZWN0YWJsZSwgSW5qZWN0b3IsIEFwcGxpY2F0aW9uUmVmLCBDb21wb25lbnRGYWN0b3J5UmVzb2x2ZXIsIExPQ0FMRV9JRCwgSW5qZWN0IH0gZnJvbSBcIkBhbmd1bGFyL2NvcmVcIjtcclxuaW1wb3J0IHsgRmlsdGVyQ29uZGl0aW9uQ29tcG9uZW50IH0gZnJvbSBcIi4vZmlsdGVyLWNvbmRpdGlvbi9maWx0ZXItY29uZGl0aW9uLmNvbXBvbmVudFwiO1xyXG5pbXBvcnQgeyBHc3BDb21tb25EYXRhVHlwZSB9IGZyb20gXCJAZ3NwLWJlZi9nc3AtY20tbWV0YWRhdGFcIjtcclxuaW1wb3J0IHsgR1NQQ29tbW9uT2JqZWN0IH0gZnJvbSBcIkBnc3AtYmVmL2dzcC1jbS1tZXRhZGF0YVwiO1xyXG5pbXBvcnQgeyBWYXJFbnRpdHkgfSBmcm9tIFwiQGdzcC1zdmMvZXhwcmVzc2lvblwiO1xyXG5pbXBvcnQgeyBTY2hlbWEgfSBmcm9tIFwiQGdzcC1zdmMvZXhwcmVzc2lvblwiO1xyXG5pbXBvcnQgeyBJbmplY3RlZEVudGl0eSB9IGZyb20gXCJAZ3NwLXN2Yy9leHByZXNzaW9uXCI7XHJcbmltcG9ydCB7IEluamVjdGVkVHlwZSB9IGZyb20gJ0Bnc3Atc3ZjL2V4cHJlc3Npb24nO1xyXG5pbXBvcnQgeyBGaWx0ZXJJbmplY3RlZEVudGl0eSwgRmlsdGVySW5qZWN0ZWRUeXBlIH0gZnJvbSBcIi4vaW5qZWN0ZWQtZW50aXR5XCI7XHJcbmltcG9ydCB7IEZpbHRlckVudGl0eVNjaGVtYSB9IGZyb20gXCIuL3NjaGVtYVwiO1xyXG5pbXBvcnQgeyBQcm9wZXJ0eUFkYXB0ZXIgfSBmcm9tIFwiLi9wcm9wZXJ0eS1hZGFwdGVyXCI7XHJcbmltcG9ydCB7IFByb3BlcnR5RGF0YVR5cGUgfSBmcm9tIFwiLi9wcm9wZXJ0eS1lbnRpdHlcIjtcclxuaW1wb3J0IHsgQWRhcHRlciB9IGZyb20gXCIuL2FkYXB0ZXJcIjtcclxuaW1wb3J0IHsgQnNNb2RhbFNlcnZpY2UgfSBmcm9tICdAZmFycmlzL3VpLW1vZGFsJztcclxuaW1wb3J0IHsgRmlsdGVyQ29uZGl0aW9uTG9jYWxlUGlwZSB9IGZyb20gJy4vZmlsdGVyLWNvbmRpdGlvbi1sb2NhbGUucGlwZSc7XHJcbmltcG9ydCB7IE5ld1NjaGVtYSB9IGZyb20gXCIuL05ld1NjaGVtYVwiO1xyXG5pbXBvcnQgeyBPYnNlcnZhYmxlIH0gZnJvbSBcInJ4anNcIjtcclxuaW1wb3J0IHsgSHR0cENsaWVudCB9IGZyb20gXCJAYW5ndWxhci9jb21tb24vaHR0cFwiO1xyXG4vKipcclxuICog6L+H5ruk6KGo6L6+5byP5pyN5Yqh57G7XHJcbiAqIEBhdXRob3IgbGluY2hhbmcgMjAxOC8xMi8xMFxyXG4gKi9cclxuQEluamVjdGFibGUoKVxyXG5leHBvcnQgY2xhc3MgRmlsdGVyU2VydmljZSB7XHJcbiAgICBpOiBudW1iZXIgPSAwO1xyXG4gICAgYWRhcHRlcjogQWRhcHRlciA9IG5ldyBBZGFwdGVyKCk7XHJcbiAgICAvL+WxnuaAp+WIl+ihqFxyXG4gICAgcHJvcGVydHlMaXN0OiBBcnJheTx7IHRleHQ6IHN0cmluZywgcHJvcGVydHlEYXRhVHlwZTogUHJvcGVydHlEYXRhVHlwZSwgdmFsdWU6IHN0cmluZywgcGFyZW50SXRlbTogc3RyaW5nIH0+ID0gW107XHJcbiAgICAvL+mihOe9ruiuoeeul+ihqOi+vuW8j+WPmOmHj1xyXG4gICAgY29udGV4dEVudGl0eTogVmFyRW50aXR5W10gPSBbXTtcclxuICAgIGV4cHJlc3Npb25UZXh0OiBzdHJpbmcgPSBudWxsO1xyXG4gICAgZXhwcmVzc2lvblNjaGVtYSA9IEFycmF5PHsgbmFtZTogc3RyaW5nLCBzY2hlbWE6IFNjaGVtYSB9PigpO1xyXG4gICAgZXhwcmVzc2lvbkluamVjdGVkRW50aXRpZXM6IEluamVjdGVkRW50aXR5W10gPSBbXTtcclxuICAgIGV4cHJlc3Npb25DRFQ6IEdzcENvbW1vbkRhdGFUeXBlW10gPSBbXTtcclxuICAgIC8v6aKE572u5p2h5Lu26KGo6L6+5byP5Y+Y6YePXHJcbiAgICBmaWx0ZXJFeHByZXNzaW9uU3RyaW5nOiBzdHJpbmcgPSBudWxsOy8v6L+H5ruk6KGo6L6+5byP5bqP5YiX5YyW5LiyXHJcbiAgICBzY2hlbWFNYXAgPSBuZXcgTWFwPHN0cmluZywgRmlsdGVyRW50aXR5U2NoZW1hPigpO1xyXG4gICAgbmV3U2NoZW1hTWFwID0gbmV3IE1hcDxzdHJpbmcsIE5ld1NjaGVtYT4oKTsgICAgICAgICAgICAgICAgICAgICAgICAgLy/ov4fmu6Tooajovr7lvI/mt7vliqBOZXdTY2hlbWFcclxuICAgIGluamVjdGVkRW50aXR5OiBGaWx0ZXJJbmplY3RlZEVudGl0eTtcclxuICAgIGV4cHJXaW5XaWR0aDogbnVtYmVyID0gODUwO1xyXG4gICAgbG9jYWxlUGlwZTogRmlsdGVyQ29uZGl0aW9uTG9jYWxlUGlwZTtcclxuICAgIGxvY2FsZUlkOiBzdHJpbmc7XHJcbiAgICBwcml2YXRlIG1vZGFsU2VydmljZTogQnNNb2RhbFNlcnZpY2U7XHJcbiAgICBzaW1wbGVNb2RhbENvbmZpZztcclxuICAgIGNvbnN0cnVjdG9yKFxyXG4gICAgICAgIHByaXZhdGUgaW5qZWN0b3I6IEluamVjdG9yLFxyXG4gICAgICAgIHByaXZhdGUgYXBwbGljYXRpb25SZWY6IEFwcGxpY2F0aW9uUmVmLFxyXG4gICAgICAgIHByaXZhdGUgY29tcEZhY3RSZXM6IENvbXBvbmVudEZhY3RvcnlSZXNvbHZlcixcclxuICAgICAgICBwcml2YXRlIGh0dHA6IEh0dHBDbGllbnRcclxuICAgICkge1xyXG4gICAgICAgIHRoaXMubW9kYWxTZXJ2aWNlID0gdGhpcy5pbmplY3Rvci5nZXQoQnNNb2RhbFNlcnZpY2UpO1xyXG4gICAgfVxyXG4gICAgLy8g5Yib5bu66KGo6L6+5byPXHJcbiAgICBwdWJsaWMgYnVpbGRFeHByZXNzaW9uKCkge1xyXG4gICAgICAgIGxldCB0aGF0ID0gdGhpcztcclxuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoXHJcbiAgICAgICAgICAgIGZ1bmN0aW9uIChyZXNvbHZlKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBjb21wRmFjdG9yeSA9IHRoYXQuY29tcEZhY3RSZXMucmVzb2x2ZUNvbXBvbmVudEZhY3RvcnkoRmlsdGVyQ29uZGl0aW9uQ29tcG9uZW50KTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGNvbXBSZWYgPSBjb21wRmFjdG9yeS5jcmVhdGUodGhhdC5pbmplY3Rvcik7XHJcbiAgICAgICAgICAgICAgICBjb21wUmVmLmluc3RhbmNlLnByb3BlcnR5TGlzdCA9IHRoYXQucHJvcGVydHlMaXN0O1xyXG4gICAgICAgICAgICAgICAgY29tcFJlZi5pbnN0YW5jZS5jb250ZXh0RW50aXR5ID0gdGhhdC5jb250ZXh0RW50aXR5O1xyXG4gICAgICAgICAgICAgICAgY29tcFJlZi5pbnN0YW5jZS5leHByZXNzaW9uQ0RUID0gdGhhdC5leHByZXNzaW9uQ0RUO1xyXG4gICAgICAgICAgICAgICAgY29tcFJlZi5pbnN0YW5jZS5leHByZXNzaW9uU2NoZW1hID0gdGhhdC5leHByZXNzaW9uU2NoZW1hO1xyXG4gICAgICAgICAgICAgICAgY29tcFJlZi5pbnN0YW5jZS5leHByZXNzaW9uVGV4dCA9IHRoYXQuZXhwcmVzc2lvblRleHQ7XHJcbiAgICAgICAgICAgICAgICBjb21wUmVmLmluc3RhbmNlLmV4cHJlc3Npb25JbmplY3RlZEVudGl0aWVzID0gdGhhdC5leHByZXNzaW9uSW5qZWN0ZWRFbnRpdGllcztcclxuICAgICAgICAgICAgICAgIGNvbXBSZWYuaW5zdGFuY2UuZmlsdGVyRXhwcmVzc2lvblN0cmluZyA9IHRoYXQuZmlsdGVyRXhwcmVzc2lvblN0cmluZztcclxuICAgICAgICAgICAgICAgIGNvbXBSZWYuaW5zdGFuY2Uuc2NoZW1hTWFwID0gdGhhdC5zY2hlbWFNYXA7XHJcbiAgICAgICAgICAgICAgICAvLz09PT09PT09PT09PT09PT09PT3nu4Tku7bliqDlhaVuZXdTY2hlbWFNYXA9PT09PT09PT09PT09PT1cclxuICAgICAgICAgICAgICAgIGNvbXBSZWYuaW5zdGFuY2UubmV3U2NoZW1hTWFwID0gdGhhdC5uZXdTY2hlbWFNYXA7XHJcbiAgICAgICAgICAgICAgICAvLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ICAgIFxyXG4gICAgICAgICAgICAgICAgY29tcFJlZi5pbnN0YW5jZS5leHByV2luV2lkdGggPSB0aGF0LmV4cHJXaW5XaWR0aDtcclxuICAgICAgICAgICAgICAgIHRoYXQubG9jYWxlUGlwZSA9IGNvbXBSZWYuaW5zdGFuY2UubG9jYWxlUGlwZTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGRpYWxvZyA9IHRoYXQubW9kYWxTZXJ2aWNlLnNob3coY29tcFJlZiwge1xyXG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiB0aGF0LmxvY2FsZVBpcGUudHJhbnNmb3JtKFwiV2luZG93VGl0bGVcIiksXHJcbiAgICAgICAgICAgICAgICAgICAgd2lkdGg6IDEwMTAsXHJcbiAgICAgICAgICAgICAgICAgICAgaGVpZ2h0OiA1NTAsXHJcbiAgICAgICAgICAgICAgICAgICAgc2hvd0J1dHRvbnM6IGZhbHNlXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIGNvbXBSZWYuaW5zdGFuY2UuY2xvc2VkLnN1YnNjcmliZSgkZXZlbnQgPT4gZGlhbG9nLmNsb3NlKCkpO1xyXG4gICAgICAgICAgICAgICAgY29tcFJlZi5pbnN0YW5jZS5yZXN1bHQuc3Vic2NyaWJlKChleHByZXNzaW9uQ29udGVudCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiByZXNvbHZlKGV4cHJlc3Npb25Db250ZW50KTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiAg6aKE572u5bGe5oCn5YiX6KGoXHJcbiAgICAgKiBAcGFyYW0gbmFtZSDlsZ7mgKfor63kuYlcclxuICAgICAqIEBwYXJhbSBkaXNwbGF5TmFtZSDlsZXnpLrlkI3np7BcclxuICAgICAqIEBwYXJhbSBwcm9wZXJ0eURhdGFUeXBlIOWxnuaAp+aVsOaNruexu+Wei1xyXG4gICAgICovXHJcbiAgICBwdWJsaWMgYWRkUHJvcGVydHkobmFtZTogc3RyaW5nLCBkaXNwbGF5TmFtZTogc3RyaW5nLCBwcm9wZXJ0eURhdGFUeXBlOiBQcm9wZXJ0eURhdGFUeXBlKTogdm9pZCB7XHJcbiAgICAgICAgbGV0IHByb3BlcnR5RW50aXR5ID1cclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHRleHQ6IGRpc3BsYXlOYW1lLFxyXG4gICAgICAgICAgICBwcm9wZXJ0eURhdGFUeXBlOiBwcm9wZXJ0eURhdGFUeXBlLFxyXG4gICAgICAgICAgICB2YWx1ZTogbmFtZSxcclxuICAgICAgICAgICAgcGFyZW50SXRlbTogbnVsbFxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5wcm9wZXJ0eUxpc3QgPSB0aGlzLnByb3BlcnR5TGlzdC5maWx0ZXIoaXRlbSA9PiBpdGVtLnZhbHVlICE9PSBuYW1lKTtcclxuICAgICAgICB0aGlzLnByb3BlcnR5TGlzdC5wdXNoKHByb3BlcnR5RW50aXR5KTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOa3u+WKoOS4iuS4i+aWh+WPmOmHj1xyXG4gICAgICogQHBhcmFtIGNvbnRleHRFbnRpdHkg5LiK5LiL5paH5Y+Y6YePXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBhZGRFeHByZXNzaW9uQ29udGV4dChjb250ZXh0RW50aXR5OiBWYXJFbnRpdHkpOiB2b2lkIHtcclxuICAgICAgICB0aGlzLmNvbnRleHRFbnRpdHkgPSB0aGlzLmNvbnRleHRFbnRpdHkuZmlsdGVyKGl0ZW0gPT4gaXRlbS5rZXkgIT09IGNvbnRleHRFbnRpdHkua2V5KTtcclxuICAgICAgICB0aGlzLmNvbnRleHRFbnRpdHkucHVzaChjb250ZXh0RW50aXR5KTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICog6aKE572u6KGo6L6+5byP6buY6K6k5pi+56S6XHJcbiAgICAgKiBAcGFyYW0gdGV4dCDpooTnva7mlofmnKxcclxuICAgICAqL1xyXG4gICAgcHVibGljIGFkZEV4cHJlc3Npb25UZXh0KHRleHQ6IHN0cmluZyk6IHZvaWQge1xyXG4gICAgICAgIHRoaXMuZXhwcmVzc2lvblRleHQgPSB0ZXh0O1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiDpooTnva5TY2hlbWFcclxuICAgICAqIEBwYXJhbSBuYW1lIHNjaGVtYeWQjeensFxyXG4gICAgICogQHBhcmFtIHNjaGVtYSBzY2hlbWHlrp7kvZNcclxuICAgICAqL1xyXG4gICAgcHVibGljIGFkZEV4cHJlc3Npb25TY2hlbWEobmFtZTogc3RyaW5nLCBzY2hlbWE6IFNjaGVtYSk6IHZvaWQge1xyXG4gICAgICAgIHRoaXMuZXhwcmVzc2lvblNjaGVtYSA9IHRoaXMuZXhwcmVzc2lvblNjaGVtYS5maWx0ZXIoaXRlbSA9PiBpdGVtLm5hbWUgIT09IG5hbWUpO1xyXG4gICAgICAgIHRoaXMuZXhwcmVzc2lvblNjaGVtYS5wdXNoKHsgbmFtZSwgc2NoZW1hIH0pO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiDpooTnva7ms6jlhozlrp7kvZNcclxuICAgICAqIEBwYXJhbSBuYW1lIOazqOWGjOWunuS9k+WQjVxyXG4gICAgICogQHBhcmFtIHNjaGVtYU5hbWUg5omA5Zyoc2NoZW1h55qE5ZCNXHJcbiAgICAgKiBAcGFyYW0gdHlwZU5hbWVJblNjaGVtYSDlnKhzY2hlbWHkuK3lkI3np7BcclxuICAgICAqIEBwYXJhbSBpbmplY3RlZFR5cGUg5rOo5YaM55qE57G75Z6LXHJcbiAgICAgKiBAYXV0aG9yIGxpbmNoYW5nIDIwMTgvMTIvMTBcclxuICAgICAqL1xyXG4gICAgcHVibGljIGFkZEV4cHJlc3Npb25JbmplY3RlZEVudGl0eShuYW1lOiBzdHJpbmcsIHNjaGVtYU5hbWU6IHN0cmluZywgdHlwZU5hbWVJblNjaGVtYTogc3RyaW5nLCBpbmplY3RlZFR5cGU6IEluamVjdGVkVHlwZSk6IHZvaWQge1xyXG4gICAgICAgIC8v5p6E6YCg5rOo5YWl5a6e5L2T5a+56LGhXHJcbiAgICAgICAgbGV0IGluamVjdGVkRW50aXR5ID0gbmV3IEluamVjdGVkRW50aXR5KCk7XHJcbiAgICAgICAgaW5qZWN0ZWRFbnRpdHkubmFtZSA9IG5hbWU7XHJcbiAgICAgICAgaW5qZWN0ZWRFbnRpdHkuc2NoZW1hTmFtZSA9IHNjaGVtYU5hbWU7XHJcbiAgICAgICAgaW5qZWN0ZWRFbnRpdHkuaW5qZWN0ZWROYW1lID0gdHlwZU5hbWVJblNjaGVtYTtcclxuICAgICAgICBpbmplY3RlZEVudGl0eS5pbmplY3RlZFR5cGUgPSBpbmplY3RlZFR5cGU7XHJcbiAgICAgICAgdGhpcy5leHByZXNzaW9uSW5qZWN0ZWRFbnRpdGllcy5wdXNoKGluamVjdGVkRW50aXR5KTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICog6aKE572uQ0RUXHJcbiAgICAgKiBAcGFyYW0gZ3NwQ0RUcyDpooTnva7nmoRDRFTpm4blkIhcclxuICAgICAqL1xyXG4gICAgcHVibGljIGFkZEV4cHJlc3Npb25DRFQoZ3NwQ0RUczogR3NwQ29tbW9uRGF0YVR5cGVbXSk6IHZvaWQge1xyXG4gICAgICAgIHRoaXMuZXhwcmVzc2lvbkNEVCA9IGdzcENEVHM7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIOmihOe9rui/h+a7pOadoeS7tuihqOi+vuW8j1xyXG4gICAgICogQHBhcmFtIGZpbHRlckV4cHJlc3Npb24g6aKE572u55qE6L+H5ruk6KGo6L6+5byP5LiyXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBhZGRGaWx0ZXJDb25kaXRpb24oZmlsdGVyRXhwcmVzc2lvbjogc3RyaW5nKSB7XHJcbiAgICAgICAgdGhpcy5maWx0ZXJFeHByZXNzaW9uU3RyaW5nID0gZmlsdGVyRXhwcmVzc2lvbjtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICog6aKE572uc2NoZW1hXHJcbiAgICAgKiBAcGFyYW0gbmFtZSBzY2hlbWHlkI0s6buY6K6k5Li6Q09cclxuICAgICAqIEBwYXJhbSBmaWx0ZXJTY2hlbWEgc2NoZW1h5a6e5L2TXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBhZGRTY2hlbWEobmFtZTogc3RyaW5nLCBmaWx0ZXJTY2hlbWE6IEZpbHRlckVudGl0eVNjaGVtYSkge1xyXG4gICAgICAgIGlmIChmaWx0ZXJTY2hlbWEgPT0gbnVsbCkge1xyXG4gICAgICAgICAgICBhbGVydChcIlNjaGVtYSBDYW5ub3QgTnVsbFwiKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB0aGlzLnNjaGVtYU1hcC5zZXQobmFtZSwgZmlsdGVyU2NoZW1hKTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICog5re75Yqg5rOo5YWl5a6e5L2TXHJcbiAgICAgKiBAcGFyYW0gbmFtZSDms6jlhaXlrp7kvZPlnKhzY2hlbWHkuK3nmoTlkI3np7BcclxuICAgICAqIEBwYXJhbSBzY2hlbWFOYW1lIOazqOWFpeWunuS9k+aJgOWcqOeahHNjaGVtYeWQjVxyXG4gICAgICogQHBhcmFtIGluamVjdGVkVHlwZSDms6jlhaXnsbvlnovvvIzkuI3loavpu5jorqTkuLpFbnRpdHlUeXBlXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBhZGRJbmplY3RlZEVudGl0eShuYW1lOiBzdHJpbmcsIHNjaGVtYU5hbWU6IHN0cmluZywgaW5qZWN0ZWRUeXBlOiBGaWx0ZXJJbmplY3RlZFR5cGUgPSBGaWx0ZXJJbmplY3RlZFR5cGUuRW50aXR5VHlwZSkge1xyXG4gICAgICAgIHRoaXMuaW5qZWN0ZWRFbnRpdHkgPSBuZXcgRmlsdGVySW5qZWN0ZWRFbnRpdHkoKTtcclxuICAgICAgICB0aGlzLmluamVjdGVkRW50aXR5Lm5hbWUgPSBuYW1lO1xyXG4gICAgICAgIHRoaXMuaW5qZWN0ZWRFbnRpdHkuc2NoZW1hTmFtZSA9IHNjaGVtYU5hbWU7XHJcbiAgICAgICAgdGhpcy5pbmplY3RlZEVudGl0eS5pbmplY3RlZFR5cGUgPSBpbmplY3RlZFR5cGU7XHJcbiAgICAgICAgbGV0IHByb3BlcnR5QWRhcHRlciA9IG5ldyBQcm9wZXJ0eUFkYXB0ZXIoKTtcclxuICAgICAgICB0aGlzLnByb3BlcnR5TGlzdCA9IHByb3BlcnR5QWRhcHRlci5hZGFwdGVyKHRoaXMuaW5qZWN0ZWRFbnRpdHksIHRoaXMuc2NoZW1hTWFwKTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICog5re75YqgR1NQQ29tbW9uT2JqZWN0XHJcbiAgICAgKiBAcGFyYW0gY29tbW9uT2JqZWN0IOW+hei9rOWMlkNPXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBhZGRDb21tb25PYmplY3QoY29tbW9uT2JqZWN0OiBHU1BDb21tb25PYmplY3QpOiB2b2lkIHtcclxuICAgICAgICBsZXQgc2NoZW1hO1xyXG4gICAgICAgIC8v6Iulc2NoZW1hTWFw5Lit5a2Y5ZyoQ0/nmoRzY2hlbWFcclxuICAgICAgICBpZiAodGhpcy5zY2hlbWFNYXAuZ2V0KFwiQ29tbW9uT2JqZWN0XCIpKSB7XHJcbiAgICAgICAgICAgIHNjaGVtYSA9IHRoaXMuc2NoZW1hTWFwLmdldChcIkNvbW1vbk9iamVjdFwiKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBzY2hlbWEgPSBuZXcgU2NoZW1hO1xyXG4gICAgICAgIC8v5bCG5q+P5LiA5LiqQ0/ovazljJbkuLpzY2hlbWHlhoXpg6jnu5PmnoTkuK3nmoRlbnRpdHlUeXBlXHJcbiAgICAgICAgbGV0IGVudGl0eVR5cGVzID0gdGhpcy5hZGFwdGVyLmNvbnZlcnRDTyhjb21tb25PYmplY3QpO1xyXG4gICAgICAgIGVudGl0eVR5cGVzLmZvckVhY2goZW50aXR5VHlwZSA9PiB7XHJcbiAgICAgICAgICAgIHNjaGVtYS5lbnRpdHlUeXBlcyA9IHNjaGVtYS5lbnRpdHlUeXBlcy5maWx0ZXIoaXRlbSA9PiBpdGVtLm5hbWUgIT09IGVudGl0eVR5cGUubmFtZSk7XHJcbiAgICAgICAgICAgIHNjaGVtYS5lbnRpdHlUeXBlcy5wdXNoKGVudGl0eVR5cGUpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICAvL+WwhuWQiOW5tuWQjueahHNjaGVtYeaUvuWFpeWGhemDqOS4iuS4i+aWh+WunuS9k+S4rVxyXG4gICAgICAgIHRoaXMuYWRkU2NoZW1hKFwiQ29tbW9uT2JqZWN0XCIsIHNjaGVtYSk7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIOiuvue9ruiuoeeul+ihqOi+vuW8j+W8ueWHuuahhuWuveW6plxyXG4gICAgICogQHBhcmFtIGV4cHJXaW5XaWR0aCBcclxuICAgICAqL1xyXG4gICAgcHVibGljIGFkZEV4cHJXaW5XaWR0aChleHByV2luV2lkdGg6IG51bWJlcikge1xyXG4gICAgICAgIHRoaXMuZXhwcldpbldpZHRoID0gZXhwcldpbldpZHRoO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICAvLz09PT09PT09PT09PT09PT09PT09PT3ljY7kuL3liIblibLnur/kuYvnu5/kuIDnu5PmnoRTY2hlbWE9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEBkZXNjcmlwdGlvbiDlkJFuZXdTY2hlbWFNYXDkuK3mt7vliqBOZXdTY2hlbWFcclxuICAgICAqIEBwYXJhbSBuYW1lIE1hcOS4reeahGtleeWAvFxyXG4gICAgICogQHBhcmFtIHNjaGVtYSBNYXDnmoR2YWx1ZVxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgYWRkTmV3U2NoZW1hKG5hbWU6IHN0cmluZywgc2NoZW1hOiBOZXdTY2hlbWEpIHtcclxuICAgICAgICBpZiAobmFtZSAhPSBudWxsICYmIG5hbWUgIT0gXCJcIiAmJiBzY2hlbWEgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICB0aGlzLm5ld1NjaGVtYU1hcC5zZXQobmFtZSwgc2NoZW1hKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBhbGVydChcIk5hbWUgb3IgU2NoZW1hIGlzIG51bGwgIVwiKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDmt7vliqDms6jlhaXlrp7kvZNcclxuICAgICAqIEBwYXJhbSBuYW1lIOazqOWFpeWunuS9k+WcqHNjaGVtYeS4reeahOWQjeensFxyXG4gICAgICogQHBhcmFtIHNjaGVtYU5hbWUg5rOo5YWl5a6e5L2T5omA5Zyo55qEc2NoZW1h5ZCNXHJcbiAgICAgKiBAcGFyYW0gaW5qZWN0ZWRUeXBlIOazqOWFpeexu+Wei++8jOm7mOiupOS4ukVudGl0eVR5cGVcclxuICAgICAqL1xyXG4gICAgcHVibGljIGFkZEluamVjdGVkRW50aXR5T2ZOZXdTY2hlbWEobmFtZTogc3RyaW5nLCBzY2hlbWFOYW1lOiBzdHJpbmcsIGluamVjdGVkVHlwZTogRmlsdGVySW5qZWN0ZWRUeXBlID0gRmlsdGVySW5qZWN0ZWRUeXBlLkVudGl0eVR5cGUpIHtcclxuICAgICAgICB0aGlzLmluamVjdGVkRW50aXR5ID0gbmV3IEZpbHRlckluamVjdGVkRW50aXR5KCk7XHJcbiAgICAgICAgdGhpcy5pbmplY3RlZEVudGl0eS5uYW1lID0gbmFtZTtcclxuICAgICAgICB0aGlzLmluamVjdGVkRW50aXR5LnNjaGVtYU5hbWUgPSBzY2hlbWFOYW1lO1xyXG4gICAgICAgIHRoaXMuaW5qZWN0ZWRFbnRpdHkuaW5qZWN0ZWRUeXBlID0gaW5qZWN0ZWRUeXBlO1xyXG4gICAgICAgIGxldCBwcm9wZXJ0eUFkYXB0ZXIgPSBuZXcgUHJvcGVydHlBZGFwdGVyKCk7XHJcbiAgICAgICAgdGhpcy5wcm9wZXJ0eUxpc3QgPSBwcm9wZXJ0eUFkYXB0ZXIuYWRhcHRlck9mTmV3U2NoZW1hKHRoaXMuaW5qZWN0ZWRFbnRpdHksIHRoaXMubmV3U2NoZW1hTWFwKTtcclxuICAgIH1cclxuXHJcblxyXG4gICAgLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG59Il19