/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Injectable } from '@angular/core';
import { HttpService } from '@ecp-caf/caf-common';
import { catchError, tap } from 'rxjs/operators';
import { HttpClient } from '@angular/common/http';
import { GspFormRemoveListEntity } from './entity/gspformremovelistentity';
import { of } from 'rxjs/observable/of';
import { GspFormDocOperateEntity } from './entity/gspformdocoperateentity';
import { ChangeInstanceRequest } from './entity/changeinstancerequest';
import { OperatingModes } from './entity/operatingmodes';
import { CopyFileRequest } from './entity/copyfilerequest';
export class UploadService {
    /**
     * @param {?} http
     * @param {?} httpclient
     */
    constructor(http, httpclient) {
        this.http = http;
        this.httpclient = httpclient;
    }
    /**
     * @param {?} docListInfo
     * @param {?} rootId
     * @return {?}
     */
    uploadList(docListInfo, rootId) {
        /** @type {?} */
        let url;
        docListInfo.rootId = rootId;
        url = "/api/runtime/dfs/v1.0/formdoc/list";
        //url = "/api/runtime/dfs/v1.0/formdoc/list";
        return this.http.post(url, docListInfo).pipe(tap((/**
         * @param {?} res
         * @return {?}
         */
        res => { })), catchError((/**
         * @param {?} error
         * @return {?}
         */
        (error) => {
            return of(error);
        })));
    }
    /**
     * @param {?} metadataIdList
     * @param {?} rootId
     * @return {?}
     */
    commit(metadataIdList, rootId) {
        /** @type {?} */
        let url;
        /** @type {?} */
        let entity = new GspFormDocOperateEntity;
        entity.metadataIdList = metadataIdList;
        entity.rootId = rootId;
        url = "/api/runtime/dfs/v1.0/formdoc/commit";
        //url = "http://localhost:5000/api/runtime/dfs/v1.0/formdoc/commit";
        return this.http.post(url, entity).pipe();
    }
    /**
     * @param {?} metadataIdList
     * @param {?} rootId
     * @return {?}
     */
    cancel(metadataIdList, rootId) {
        /** @type {?} */
        let url;
        /** @type {?} */
        let entity = new GspFormDocOperateEntity;
        entity.metadataIdList = metadataIdList;
        entity.rootId = rootId;
        url = "/api/runtime/dfs/v1.0/formdoc/cancel";
        //url = "http://localhost:5000/api/runtime/dfs/v1.0/formdoc/cancel";
        //localStorage.setItem("SessionId","huoliang");
        return this.http.put(url, entity).pipe();
    }
    /**
     * @param {?} idList
     * @param {?} rootId
     * @return {?}
     */
    removeList(idList, rootId) {
        /** @type {?} */
        let url;
        //url = "http://localhost:5000/api/runtime/dfs/v1.0/formdoc/list";
        url = "/api/runtime/dfs/v1.0/formdoc/list";
        /** @type {?} */
        var idListInfo = new GspFormRemoveListEntity;
        idListInfo.metadataIdList = idList;
        idListInfo.mode = OperatingModes.Temp;
        idListInfo.rootId = rootId;
        return this.http.delete(url, idListInfo).pipe();
    }
    /**
     * @param {?} metadataId
     * @param {?} rootId
     * @return {?}
     */
    getFile(metadataId, rootId) {
        /** @type {?} */
        let url;
        if (rootId == "")
            url = "/api/runtime/dfs/v1.0/formdoc/file/" + metadataId;
        else
            url = "/api/runtime/dfs/v1.0/formdoc/file/" + metadataId + "/" + rootId;
        return this.http.get(url).pipe(tap((/**
         * @param {?} res
         * @return {?}
         */
        res => { })), catchError((/**
         * @param {?} error
         * @return {?}
         */
        (error) => {
            return of(error);
        })));
    }
    /**
     * @param {?} docInfo
     * @return {?}
     */
    uploadFile(docInfo) {
        /** @type {?} */
        let url = "/api/runtime/dfs/v1.0/formdoc";
        //url = "/api/runtime/dfs/v1.0/formdoc/list";
        return this.http.post(url, docInfo).pipe(tap((/**
         * @param {?} res
         * @return {?}
         */
        res => { })), catchError((/**
         * @param {?} error
         * @return {?}
         */
        (error) => {
            return of(error);
        })));
    }
    /**
     * @param {?} formdata
     * @return {?}
     */
    uploadSliceFile(formdata) {
        /** @type {?} */
        let url = "/api/runtime/dfs/v1.0/formdoc/slice";
        //url = "/api/runtime/dfs/v1.0/formdoc/list";
        return this.httpclient.post(url, formdata).pipe(tap((/**
         * @param {?} res
         * @return {?}
         */
        res => { })), catchError((/**
         * @param {?} error
         * @return {?}
         */
        (error) => {
            return of(error);
        })));
    }
    /**
     * @return {?}
     */
    getStorageExtensionInfo() {
        /** @type {?} */
        let url = "/api/runtime/dfs/v1.0/storagestrategy/extension";
        //url = "/api/runtime/dfs/v1.0/formdoc/list";
        return this.http.get(url).pipe(tap((/**
         * @param {?} res
         * @return {?}
         */
        res => { })), catchError((/**
         * @param {?} error
         * @return {?}
         */
        (error) => {
            return of(error);
        })));
    }
    /**
     * @param {?} baseInfo
     * @return {?}
     */
    getSecurityInfoList(baseInfo) {
        /** @type {?} */
        let url = "/api/runtime/dfs/v1.0/storagestrategy/security";
        url = url + "?id=" + baseInfo.securityId + "&level=" + baseInfo.securityLevel;
        return this.http.get(url).pipe(tap((/**
         * @param {?} res
         * @return {?}
         */
        res => { })), catchError((/**
         * @param {?} error
         * @return {?}
         */
        (error) => {
            return of(error);
        })));
    }
    /**
     * @param {?} storageInfoList
     * @param {?} rootId
     * @return {?}
     */
    changeStorageInstance(storageInfoList, rootId) {
        /** @type {?} */
        let url = "/api/runtime/dfs/v1.0/formdoc/changeinstance";
        /** @type {?} */
        let request = new ChangeInstanceRequest;
        request.fileInfoList = storageInfoList;
        request.rootId = rootId;
        return this.http.post(url, request).pipe(tap((/**
         * @param {?} res
         * @return {?}
         */
        res => { })), catchError((/**
         * @param {?} error
         * @return {?}
         */
        (error) => {
            return of(error);
        })));
    }
    /**
     * @param {?} metadataId
     * @param {?} rootId
     * @param {?} path
     * @return {?}
     */
    copyFile(metadataId, rootId, path) {
        /** @type {?} */
        let url = "/api/runtime/dfs/v1.0/formdoc/copy";
        /** @type {?} */
        let request = new CopyFileRequest;
        request.metadataId = metadataId;
        request.rootId = rootId;
        request.path = path;
        return this.httpclient.post(url, request, { responseType: 'text' }).pipe(tap((/**
         * @param {?} res
         * @return {?}
         */
        res => { })));
    }
    /**
     * @param {?} uploadFileInfoList
     * @param {?} rootId
     * @return {?}
     */
    saveSecurityInfo(uploadFileInfoList, rootId) {
        /** @type {?} */
        let url = "/api/runtime/dfs/v1.0/doc/exproperty";
        /** @type {?} */
        let reqList = [];
        uploadFileInfoList.forEach((/**
         * @param {?} element
         * @return {?}
         */
        element => {
            /** @type {?} */
            let request = { id: element.metadataId, rootId: rootId, exProperty: JSON.stringify(element.securityInfo) };
            reqList.push(request);
        }));
        return this.http.post(url, reqList).pipe(tap((/**
         * @param {?} res
         * @return {?}
         */
        res => { })), catchError((/**
         * @param {?} error
         * @return {?}
         */
        (error) => {
            return of(error);
        })));
    }
    /**
     * @param {?} formId
     * @param {?} rootId
     * @return {?}
     */
    getUploadedFileInfoList(formId, rootId) {
        /** @type {?} */
        let url = "/api/runtime/dfs/v1.0/formdoc/uploadedfile/infolist" + "?formid=" + formId + "&rootid=" + rootId;
        //url = "/api/runtime/dfs/v1.0/formdoc/list";
        return this.http.get(url).pipe(tap((/**
         * @param {?} res
         * @return {?}
         */
        res => { })), catchError((/**
         * @param {?} error
         * @return {?}
         */
        (error) => {
            return of(error);
        })));
    }
    /**
     * @param {?} rootId
     * @return {?}
     */
    getUploadInfo(rootId) {
        /** @type {?} */
        let url = "/api/runtime/dfs/v1.0/rootsetting/info?id=" + rootId;
        return this.http.get(url).pipe(tap((/**
         * @param {?} res
         * @return {?}
         */
        res => { })), catchError((/**
         * @param {?} error
         * @return {?}
         */
        (error) => {
            return of(error);
        })));
    }
}
UploadService.decorators = [
    { type: Injectable }
];
/** @nocollapse */
UploadService.ctorParameters = () => [
    { type: HttpService },
    { type: HttpClient }
];
if (false) {
    /**
     * @type {?}
     * @private
     */
    UploadService.prototype.http;
    /**
     * @type {?}
     * @private
     */
    UploadService.prototype.httpclient;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidXBsb2FkLnNlcnZpY2UuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZ3NwLXN2Yy9mb3JtZG9jLXVwbG9hZC8iLCJzb3VyY2VzIjpbImxpYi91cGxvYWQvdXBsb2FkLnNlcnZpY2UudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUFBLE9BQU8sRUFBRSxVQUFVLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFHM0MsT0FBTyxFQUFFLFdBQVcsRUFBRSxNQUFNLHFCQUFxQixDQUFDO0FBQ2xELE9BQU8sRUFBRSxVQUFVLEVBQUUsR0FBRyxFQUFFLE1BQU0sZ0JBQWdCLENBQUM7QUFDakQsT0FBTyxFQUFFLFVBQVUsRUFBcUIsTUFBTSxzQkFBc0IsQ0FBQztBQUNyRSxPQUFPLEVBQUUsdUJBQXVCLEVBQUUsTUFBTSxrQ0FBa0MsQ0FBQztBQUMzRSxPQUFPLEVBQUUsRUFBRSxFQUFFLE1BQU0sb0JBQW9CLENBQUM7QUFDeEMsT0FBTyxFQUFFLHVCQUF1QixFQUFFLE1BQU0sa0NBQWtDLENBQUM7QUFJM0UsT0FBTyxFQUFFLHFCQUFxQixFQUFFLE1BQU0sZ0NBQWdDLENBQUM7QUFDdkUsT0FBTyxFQUFFLGNBQWMsRUFBRSxNQUFNLHlCQUF5QixDQUFDO0FBSXpELE9BQU8sRUFBRSxlQUFlLEVBQUUsTUFBTSwwQkFBMEIsQ0FBQztBQUszRCxNQUFNLE9BQU8sYUFBYTs7Ozs7SUFFeEIsWUFBb0IsSUFBaUIsRUFBVSxVQUFzQjtRQUFqRCxTQUFJLEdBQUosSUFBSSxDQUFhO1FBQVUsZUFBVSxHQUFWLFVBQVUsQ0FBWTtJQUFJLENBQUM7Ozs7OztJQUUxRSxVQUFVLENBQUMsV0FBb0MsRUFBRSxNQUFjOztZQUN6RCxHQUFHO1FBQ1AsV0FBVyxDQUFDLE1BQU0sR0FBRyxNQUFNLENBQUM7UUFFNUIsR0FBRyxHQUFHLG9DQUFvQyxDQUFDO1FBQzNDLDZDQUE2QztRQUU3QyxPQUFPLElBQUksQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLEdBQUcsRUFBRSxXQUFXLENBQUMs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QUFDLEVBQUMsRUFDZixVQUFVOzs7O1FBQUMsQ0FBQyxLQUF3QixFQUFFLEVBQUU7WUFDdEMsT0FBTyxFQUFFLENBQUMsS0FBSyxDQUFDLENBQUM7UUFDbkIsQ0FBQyxFQUFDLENBQUMsQ0FBQztJQUNSLENBQUM7OztZQTlLRixVQUFVOzs7O1lBbEJGLFdBQVc7WUFFWCxVQUFVOzs7Ozs7O0lBbUJMLDZCQUF5Qjs7Ozs7SUFBRSxtQ0FBOEIiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBJbmplY3RhYmxlIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IE9ic2VydmFibGUgfSBmcm9tICdyeGpzJztcclxuaW1wb3J0IHsgR3NwRm9ybVVwbG9hZExpc3RFbnRpdHkgfSBmcm9tICcuL2VudGl0eS9nc3Bmb3JtdXBsb2FkbGlzdGVudGl0eSc7XHJcbmltcG9ydCB7IEh0dHBTZXJ2aWNlIH0gZnJvbSAnQGVjcC1jYWYvY2FmLWNvbW1vbic7XHJcbmltcG9ydCB7IGNhdGNoRXJyb3IsIHRhcCB9IGZyb20gJ3J4anMvb3BlcmF0b3JzJztcclxuaW1wb3J0IHsgSHR0cENsaWVudCwgSHR0cEVycm9yUmVzcG9uc2UgfSBmcm9tICdAYW5ndWxhci9jb21tb24vaHR0cCc7XHJcbmltcG9ydCB7IEdzcEZvcm1SZW1vdmVMaXN0RW50aXR5IH0gZnJvbSAnLi9lbnRpdHkvZ3NwZm9ybXJlbW92ZWxpc3RlbnRpdHknO1xyXG5pbXBvcnQgeyBvZiB9IGZyb20gJ3J4anMvb2JzZXJ2YWJsZS9vZic7XHJcbmltcG9ydCB7IEdzcEZvcm1Eb2NPcGVyYXRlRW50aXR5IH0gZnJvbSAnLi9lbnRpdHkvZ3NwZm9ybWRvY29wZXJhdGVlbnRpdHknO1xyXG5cclxuaW1wb3J0IHsgR3NwRm9ybVVwbG9hZEVudGl0eSB9IGZyb20gJy4vZW50aXR5L2dzcGZvcm11cGxvYWRlbnRpdHknO1xyXG5pbXBvcnQgeyBFeFN0b3JhZ2VGaWxlSW5mbyB9IGZyb20gJy4vZW50aXR5L2V4dGVuc2lvbnN0b3JhZ2VmaWxlaW5mbyc7XHJcbmltcG9ydCB7IENoYW5nZUluc3RhbmNlUmVxdWVzdCB9IGZyb20gJy4vZW50aXR5L2NoYW5nZWluc3RhbmNlcmVxdWVzdCc7XHJcbmltcG9ydCB7IE9wZXJhdGluZ01vZGVzIH0gZnJvbSAnLi9lbnRpdHkvb3BlcmF0aW5nbW9kZXMnO1xyXG5pbXBvcnQgeyBHc3BEb2NTZWN1cml0eUJhc2VJbmZvIH0gZnJvbSAnLi9lbnRpdHkvZ3NwZG9jc2VjdXJpdHliYXNlaW5mbyc7XHJcbmltcG9ydCB7IFVwbG9hZEZpbGVJbmZvIH0gZnJvbSAnLi9lbnRpdHkvdXBsb2FkZmlsZWluZm8nO1xyXG5pbXBvcnQgeyBFeFByb3BlcnR5UmVxdWVzdCB9IGZyb20gJy4vZW50aXR5L2V4cHJvcGVydHlyZXF1ZXN0JztcclxuaW1wb3J0IHsgQ29weUZpbGVSZXF1ZXN0IH0gZnJvbSAnLi9lbnRpdHkvY29weWZpbGVyZXF1ZXN0JztcclxuXHJcblxyXG5cclxuQEluamVjdGFibGUoKVxyXG5leHBvcnQgY2xhc3MgVXBsb2FkU2VydmljZSB7XHJcblxyXG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgaHR0cDogSHR0cFNlcnZpY2UsIHByaXZhdGUgaHR0cGNsaWVudDogSHR0cENsaWVudCkgeyB9XHJcblxyXG4gIHVwbG9hZExpc3QoZG9jTGlzdEluZm86IEdzcEZvcm1VcGxvYWRMaXN0RW50aXR5LCByb290SWQ6IHN0cmluZyk6IE9ic2VydmFibGU8YW55PiB7XHJcbiAgICBsZXQgdXJsO1xyXG4gICAgZG9jTGlzdEluZm8ucm9vdElkID0gcm9vdElkO1xyXG5cclxuICAgIHVybCA9IFwiL2FwaS9ydW50aW1lL2Rmcy92MS4wL2Zvcm1kb2MvbGlzdFwiO1xyXG4gICAgLy91cmwgPSBcIi9hcGkvcnVudGltZS9kZnMvdjEuMC9mb3JtZG9jL2xpc3RcIjtcclxuXHJcbiAgICByZXR1cm4gdGhpcy5odHRwLnBvc3QodXJsLCBkb2NMaXN0SW5mbykucGlwZShcclxuICAgICAgdGFwKHJlcyA9PiB7IH0pLFxyXG4gICAgICBjYXRjaEVycm9yKChlcnJvcjogSHR0cEVycm9yUmVzcG9uc2UpID0+IHtcclxuICAgICAgICByZXR1cm4gb2YoZXJyb3IpO1xyXG4gICAgICB9KSk7XHJcbiAgfVxyXG5cclxuXHJcbiAgY29tbWl0KG1ldGFkYXRhSWRMaXN0OiBzdHJpbmdbXSwgcm9vdElkOiBzdHJpbmcpOiBPYnNlcnZhYmxlPGFueT4ge1xyXG4gICAgbGV0IHVybDtcclxuICAgIGxldCBlbnRpdHk6IEdzcEZvcm1Eb2NPcGVyYXRlRW50aXR5ID0gbmV3IEdzcEZvcm1Eb2NPcGVyYXRlRW50aXR5O1xyXG4gICAgZW50aXR5Lm1ldGFkYXRhSWRMaXN0ID0gbWV0YWRhdGFJZExpc3Q7XHJcbiAgICBlbnRpdHkucm9vdElkID0gcm9vdElkO1xyXG4gICAgdXJsID0gXCIvYXBpL3J1bnRpbWUvZGZzL3YxLjAvZm9ybWRvYy9jb21taXRcIjtcclxuICAgIC8vdXJsID0gXCJodHRwOi8vbG9jYWxob3N0OjUwMDAvYXBpL3J1bnRpbWUvZGZzL3YxLjAvZm9ybWRvYy9jb21taXRcIjtcclxuXHJcbiAgICByZXR1cm4gdGhpcy5odHRwLnBvc3QodXJsLCBlbnRpdHkpLnBpcGUoKTtcclxuICB9XHJcblxyXG4gIGNhbmNlbChtZXRhZGF0YUlkTGlzdDogc3RyaW5nW10sIHJvb3RJZDogc3RyaW5nKTogT2JzZXJ2YWJsZTxhbnk+IHtcclxuICAgIGxldCB1cmw7XHJcbiAgICBsZXQgZW50aXR5OiBHc3BGb3JtRG9jT3BlcmF0ZUVudGl0eSA9IG5ldyBHc3BGb3JtRG9jT3BlcmF0ZUVudGl0eTtcclxuICAgIGVudGl0eS5tZXRhZGF0YUlkTGlzdCA9IG1ldGFkYXRhSWRMaXN0O1xyXG4gICAgZW50aXR5LnJvb3RJZCA9IHJvb3RJZDtcclxuICAgIHVybCA9IFwiL2FwaS9ydW50aW1lL2Rmcy92MS4wL2Zvcm1kb2MvY2FuY2VsXCI7XHJcbiAgICAvL3VybCA9IFwiaHR0cDovL2xvY2FsaG9zdDo1MDAwL2FwaS9ydW50aW1lL2Rmcy92MS4wL2Zvcm1kb2MvY2FuY2VsXCI7XHJcbiAgICAvL2xvY2FsU3RvcmFnZS5zZXRJdGVtKFwiU2Vzc2lvbklkXCIsXCJodW9saWFuZ1wiKTtcclxuICAgIHJldHVybiB0aGlzLmh0dHAucHV0KHVybCwgZW50aXR5KS5waXBlKCk7XHJcbiAgfVxyXG5cclxuICByZW1vdmVMaXN0KGlkTGlzdDogc3RyaW5nW10sIHJvb3RJZDogc3RyaW5nKSB7XHJcbiAgICBsZXQgdXJsO1xyXG4gICAgLy91cmwgPSBcImh0dHA6Ly9sb2NhbGhvc3Q6NTAwMC9hcGkvcnVudGltZS9kZnMvdjEuMC9mb3JtZG9jL2xpc3RcIjtcclxuICAgIHVybCA9IFwiL2FwaS9ydW50aW1lL2Rmcy92MS4wL2Zvcm1kb2MvbGlzdFwiO1xyXG4gICAgdmFyIGlkTGlzdEluZm8gPSBuZXcgR3NwRm9ybVJlbW92ZUxpc3RFbnRpdHk7XHJcbiAgICBpZExpc3RJbmZvLm1ldGFkYXRhSWRMaXN0ID0gaWRMaXN0O1xyXG4gICAgaWRMaXN0SW5mby5tb2RlID0gT3BlcmF0aW5nTW9kZXMuVGVtcDtcclxuICAgIGlkTGlzdEluZm8ucm9vdElkID0gcm9vdElkO1xyXG4gICAgcmV0dXJuIHRoaXMuaHR0cC5kZWxldGUodXJsLCBpZExpc3RJbmZvKS5waXBlKCk7XHJcbiAgfVxyXG5cclxuICBnZXRGaWxlKG1ldGFkYXRhSWQ6IHN0cmluZywgcm9vdElkOiBzdHJpbmcpIHtcclxuXHJcbiAgICBsZXQgdXJsO1xyXG4gICAgaWYgKHJvb3RJZCA9PSBcIlwiKVxyXG4gICAgICB1cmwgPSBcIi9hcGkvcnVudGltZS9kZnMvdjEuMC9mb3JtZG9jL2ZpbGUvXCIgKyBtZXRhZGF0YUlkO1xyXG4gICAgZWxzZVxyXG4gICAgICB1cmwgPSBcIi9hcGkvcnVudGltZS9kZnMvdjEuMC9mb3JtZG9jL2ZpbGUvXCIgKyBtZXRhZGF0YUlkICsgXCIvXCIgKyByb290SWQ7XHJcbiAgICByZXR1cm4gdGhpcy5odHRwLmdldCh1cmwpLnBpcGUodGFwKHJlcyA9PiB7IH0pLFxyXG4gICAgICBjYXRjaEVycm9yKChlcnJvcjogSHR0cEVycm9yUmVzcG9uc2UpID0+IHtcclxuICAgICAgICByZXR1cm4gb2YoZXJyb3IpO1xyXG4gICAgICB9KSk7XHJcblxyXG4gIH1cclxuXHJcbiAgdXBsb2FkRmlsZShkb2NJbmZvOiBHc3BGb3JtVXBsb2FkRW50aXR5KTogT2JzZXJ2YWJsZTxhbnk+IHtcclxuXHJcbiAgICBsZXQgdXJsID0gXCIvYXBpL3J1bnRpbWUvZGZzL3YxLjAvZm9ybWRvY1wiO1xyXG4gICAgLy91cmwgPSBcIi9hcGkvcnVudGltZS9kZnMvdjEuMC9mb3JtZG9jL2xpc3RcIjtcclxuXHJcbiAgICByZXR1cm4gdGhpcy5odHRwLnBvc3QodXJsLCBkb2NJbmZvKS5waXBlKFxyXG4gICAgICB0YXAocmVzID0+IHsgfSksXHJcbiAgICAgIGNhdGNoRXJyb3IoKGVycm9yOiBIdHRwRXJyb3JSZXNwb25zZSkgPT4ge1xyXG4gICAgICAgIHJldHVybiBvZihlcnJvcik7XHJcbiAgICAgIH0pKTtcclxuICB9XHJcblxyXG4gIHVwbG9hZFNsaWNlRmlsZShmb3JtZGF0YTogRm9ybURhdGEpOiBPYnNlcnZhYmxlPGFueT4ge1xyXG5cclxuICAgIGxldCB1cmwgPSBcIi9hcGkvcnVudGltZS9kZnMvdjEuMC9mb3JtZG9jL3NsaWNlXCI7XHJcbiAgICAvL3VybCA9IFwiL2FwaS9ydW50aW1lL2Rmcy92MS4wL2Zvcm1kb2MvbGlzdFwiO1xyXG5cclxuICAgIHJldHVybiB0aGlzLmh0dHBjbGllbnQucG9zdCh1cmwsIGZvcm1kYXRhKS5waXBlKFxyXG4gICAgICB0YXAocmVzID0+IHsgfSksXHJcbiAgICAgIGNhdGNoRXJyb3IoKGVycm9yOiBIdHRwRXJyb3JSZXNwb25zZSkgPT4ge1xyXG4gICAgICAgIHJldHVybiBvZihlcnJvcik7XHJcbiAgICAgIH0pKTtcclxuICB9XHJcblxyXG5cclxuICBnZXRTdG9yYWdlRXh0ZW5zaW9uSW5mbygpOiBPYnNlcnZhYmxlPGFueT4ge1xyXG4gICAgbGV0IHVybCA9IFwiL2FwaS9ydW50aW1lL2Rmcy92MS4wL3N0b3JhZ2VzdHJhdGVneS9leHRlbnNpb25cIjtcclxuICAgIC8vdXJsID0gXCIvYXBpL3J1bnRpbWUvZGZzL3YxLjAvZm9ybWRvYy9saXN0XCI7XHJcblxyXG4gICAgcmV0dXJuIHRoaXMuaHR0cC5nZXQodXJsKS5waXBlKFxyXG4gICAgICB0YXAocmVzID0+IHsgfSksXHJcbiAgICAgIGNhdGNoRXJyb3IoKGVycm9yOiBIdHRwRXJyb3JSZXNwb25zZSkgPT4ge1xyXG4gICAgICAgIHJldHVybiBvZihlcnJvcik7XHJcbiAgICAgIH0pKTtcclxuICB9XHJcblxyXG4gIGdldFNlY3VyaXR5SW5mb0xpc3QoYmFzZUluZm86IEdzcERvY1NlY3VyaXR5QmFzZUluZm8pOiBPYnNlcnZhYmxlPGFueT4ge1xyXG4gICAgbGV0IHVybCA9IFwiL2FwaS9ydW50aW1lL2Rmcy92MS4wL3N0b3JhZ2VzdHJhdGVneS9zZWN1cml0eVwiO1xyXG4gICAgdXJsID0gdXJsICsgXCI/aWQ9XCIgKyBiYXNlSW5mby5zZWN1cml0eUlkICsgXCImbGV2ZWw9XCIgKyBiYXNlSW5mby5zZWN1cml0eUxldmVsO1xyXG5cclxuICAgIHJldHVybiB0aGlzLmh0dHAuZ2V0KHVybCkucGlwZShcclxuICAgICAgdGFwKHJlcyA9PiB7IH0pLFxyXG4gICAgICBjYXRjaEVycm9yKChlcnJvcjogSHR0cEVycm9yUmVzcG9uc2UpID0+IHtcclxuICAgICAgICByZXR1cm4gb2YoZXJyb3IpO1xyXG4gICAgICB9KSk7XHJcbiAgfVxyXG5cclxuICBjaGFuZ2VTdG9yYWdlSW5zdGFuY2Uoc3RvcmFnZUluZm9MaXN0OiBFeFN0b3JhZ2VGaWxlSW5mb1tdLCByb290SWQ6IHN0cmluZyk6IE9ic2VydmFibGU8YW55PiB7XHJcbiAgICBsZXQgdXJsID0gXCIvYXBpL3J1bnRpbWUvZGZzL3YxLjAvZm9ybWRvYy9jaGFuZ2VpbnN0YW5jZVwiO1xyXG4gICAgbGV0IHJlcXVlc3Q6IENoYW5nZUluc3RhbmNlUmVxdWVzdCA9IG5ldyBDaGFuZ2VJbnN0YW5jZVJlcXVlc3Q7XHJcbiAgICByZXF1ZXN0LmZpbGVJbmZvTGlzdCA9IHN0b3JhZ2VJbmZvTGlzdDtcclxuICAgIHJlcXVlc3Qucm9vdElkID0gcm9vdElkO1xyXG4gICAgcmV0dXJuIHRoaXMuaHR0cC5wb3N0KHVybCwgcmVxdWVzdCkucGlwZShcclxuICAgICAgdGFwKHJlcyA9PiB7IH0pLFxyXG4gICAgICBjYXRjaEVycm9yKChlcnJvcjogSHR0cEVycm9yUmVzcG9uc2UpID0+IHtcclxuICAgICAgICByZXR1cm4gb2YoZXJyb3IpO1xyXG4gICAgICB9KSk7XHJcbiAgfVxyXG5cclxuICBjb3B5RmlsZShtZXRhZGF0YUlkOiBzdHJpbmcsIHJvb3RJZDogc3RyaW5nLCBwYXRoOiBzdHJpbmcpOiBPYnNlcnZhYmxlPGFueT4ge1xyXG4gICAgbGV0IHVybCA9IFwiL2FwaS9ydW50aW1lL2Rmcy92MS4wL2Zvcm1kb2MvY29weVwiO1xyXG4gICAgbGV0IHJlcXVlc3Q6IENvcHlGaWxlUmVxdWVzdCA9IG5ldyBDb3B5RmlsZVJlcXVlc3Q7XHJcbiAgICByZXF1ZXN0Lm1ldGFkYXRhSWQgPSBtZXRhZGF0YUlkO1xyXG4gICAgcmVxdWVzdC5yb290SWQgPSByb290SWQ7XHJcbiAgICByZXF1ZXN0LnBhdGggPSBwYXRoO1xyXG4gICAgcmV0dXJuIHRoaXMuaHR0cGNsaWVudC5wb3N0KHVybCwgcmVxdWVzdCx7cmVzcG9uc2VUeXBlOiAndGV4dCd9KS5waXBlKFxyXG4gICAgICB0YXAocmVzID0+IHsgfSksXHJcbiAgICAgIC8vIGNhdGNoRXJyb3IoKGVycm9yOiBIdHRwRXJyb3JSZXNwb25zZSkgPT4ge1xyXG4gICAgICAvLyAgIHJldHVybiBvZihlcnJvcik7XHJcbiAgICAgIC8vIH0pXHJcbiAgICAgICk7XHJcbiAgfVxyXG5cclxuICBzYXZlU2VjdXJpdHlJbmZvKHVwbG9hZEZpbGVJbmZvTGlzdDogVXBsb2FkRmlsZUluZm9bXSwgcm9vdElkOiBzdHJpbmcpOiBPYnNlcnZhYmxlPGFueT4ge1xyXG4gICAgbGV0IHVybCA9IFwiL2FwaS9ydW50aW1lL2Rmcy92MS4wL2RvYy9leHByb3BlcnR5XCI7XHJcbiAgICBsZXQgcmVxTGlzdDogRXhQcm9wZXJ0eVJlcXVlc3RbXSA9IFtdO1xyXG4gICAgdXBsb2FkRmlsZUluZm9MaXN0LmZvckVhY2goZWxlbWVudCA9PiB7XHJcbiAgICAgIGxldCByZXF1ZXN0OiBFeFByb3BlcnR5UmVxdWVzdCA9IHsgaWQ6IGVsZW1lbnQubWV0YWRhdGFJZCwgcm9vdElkOiByb290SWQsIGV4UHJvcGVydHk6IEpTT04uc3RyaW5naWZ5KGVsZW1lbnQuc2VjdXJpdHlJbmZvKSB9O1xyXG4gICAgICByZXFMaXN0LnB1c2gocmVxdWVzdCk7XHJcbiAgICB9KVxyXG4gICAgcmV0dXJuIHRoaXMuaHR0cC5wb3N0KHVybCwgcmVxTGlzdCkucGlwZShcclxuICAgICAgdGFwKHJlcyA9PiB7IH0pLFxyXG4gICAgICBjYXRjaEVycm9yKChlcnJvcjogSHR0cEVycm9yUmVzcG9uc2UpID0+IHtcclxuICAgICAgICByZXR1cm4gb2YoZXJyb3IpO1xyXG4gICAgICB9KSlcclxuICB9XHJcblxyXG5cclxuICBnZXRVcGxvYWRlZEZpbGVJbmZvTGlzdChmb3JtSWQ6IHN0cmluZywgcm9vdElkOiBzdHJpbmcpOiBPYnNlcnZhYmxlPGFueT4ge1xyXG4gICAgbGV0IHVybCA9IFwiL2FwaS9ydW50aW1lL2Rmcy92MS4wL2Zvcm1kb2MvdXBsb2FkZWRmaWxlL2luZm9saXN0XCIgKyBcIj9mb3JtaWQ9XCIgKyBmb3JtSWQgKyBcIiZyb290aWQ9XCIgKyByb290SWQ7XHJcbiAgICAvL3VybCA9IFwiL2FwaS9ydW50aW1lL2Rmcy92MS4wL2Zvcm1kb2MvbGlzdFwiO1xyXG5cclxuICAgIHJldHVybiB0aGlzLmh0dHAuZ2V0KHVybCkucGlwZShcclxuICAgICAgdGFwKHJlcyA9PiB7IH0pLFxyXG4gICAgICBjYXRjaEVycm9yKChlcnJvcjogSHR0cEVycm9yUmVzcG9uc2UpID0+IHtcclxuICAgICAgICByZXR1cm4gb2YoZXJyb3IpO1xyXG4gICAgICB9KSk7XHJcbiAgfVxyXG5cclxuICAgIGdldFVwbG9hZEluZm8ocm9vdElkOiBzdHJpbmcpOiBPYnNlcnZhYmxlPGFueT4ge1xyXG4gICAgbGV0IHVybCA9IFwiL2FwaS9ydW50aW1lL2Rmcy92MS4wL3Jvb3RzZXR0aW5nL2luZm8/aWQ9XCIgKyByb290SWQ7XHJcblxyXG4gICAgcmV0dXJuIHRoaXMuaHR0cC5nZXQodXJsKS5waXBlKFxyXG4gICAgICB0YXAocmVzID0+IHsgfSksXHJcbiAgICAgIGNhdGNoRXJyb3IoKGVycm9yOiBIdHRwRXJyb3JSZXNwb25zZSkgPT4ge1xyXG4gICAgICAgIHJldHVybiBvZihlcnJvcik7XHJcbiAgICAgIH0pKTtcclxuICB9XHJcblxyXG4gIC8vIGdldFJvb3RTZXR0aW5nKHJvb3RJZDogc3RyaW5nKTogT2JzZXJ2YWJsZTxhbnk+IHtcclxuICAvLyAgIGxldCB1cmwgPSBcIi9hcGkvcnVudGltZS9kZnMvdjEuMC9yb290c2V0dGluZy9cIiArIHJvb3RJZDtcclxuXHJcbiAgLy8gICByZXR1cm4gdGhpcy5odHRwLmdldCh1cmwpLnBpcGUoXHJcbiAgLy8gICAgIHRhcChyZXMgPT4geyB9KSxcclxuICAvLyAgICAgY2F0Y2hFcnJvcigoZXJyb3I6IEh0dHBFcnJvclJlc3BvbnNlKSA9PiB7XHJcbiAgLy8gICAgICAgcmV0dXJuIG9mKGVycm9yKTtcclxuICAvLyAgICAgfSkpO1xyXG4gIC8vIH1cclxuXHJcbiAgLy8gZ2V0VmFsaWRhdGlvbihpZDogc3RyaW5nKTogT2JzZXJ2YWJsZTxhbnk+IHtcclxuICAvLyAgIGxldCB1cmwgPSBcIi9hcGkvcnVudGltZS9kZnMvdjEuMC92YWxpZGF0aW9uL1wiICsgaWQ7XHJcblxyXG4gIC8vICAgcmV0dXJuIHRoaXMuaHR0cC5nZXQodXJsKS5waXBlKFxyXG4gIC8vICAgICB0YXAocmVzID0+IHsgfSksXHJcbiAgLy8gICAgIGNhdGNoRXJyb3IoKGVycm9yOiBIdHRwRXJyb3JSZXNwb25zZSkgPT4ge1xyXG4gIC8vICAgICAgIHJldHVybiBvZihlcnJvcik7XHJcbiAgLy8gICAgIH0pKTtcclxuICAvLyB9XHJcblxyXG59XHJcbiJdfQ==