{"version":3,"file":"gsp-svc-file-load.js.map","sources":["ng://@gsp-svc/file-load/lib/download.service.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\n\n\n@Injectable()\nexport class DownloadService {\n\n  constructor() { }\n\n  getDownloadUrl(metadataId: string, rootId: string) {\n    return \"/api/runtime/dfs/v1.0/doc/filecontent?metadataid=\" + metadataId + \"&rootid=\" + rootId + \"&token=\" + this.getToken(this.mergeString(metadataId, rootId));\n  }\n\n  getMultipleDownloadUrl(metadataIdList: string, rootId: string) {\n    let list: string[] = JSON.parse(metadataIdList);\n    return \"/api/runtime/dfs/v1.0/doc/multiple/download?metadataidlist=\" + metadataIdList + \"&rootid=\" + rootId + \"&token=\" + this.getToken(this.mergeString(list[0], rootId));\n  }\n\n  getHistoryDownloadUrl(metadataId: string, rootId: string, version: string) {\n    //let list:string[]=JSON.parse(metadataIdList);\n    return \"/api/runtime/dfs/v1.0/doc/historycontent?metadataid=\" + metadataId + \"&rootid=\" + rootId + \"&version=\" + version + \"&token=\" + this.getToken(this.mergeString(metadataId, rootId));\n  }\n\n\n\n  private mergeString(str: string, str1: string): string {\n    let min = str.length < str1.length ? str.length : str1.length;\n    let res: string = \"\";\n    let i = 0;\n    for (i = 0; i < min; i++) {\n      res += str.substring(i, i + 1);\n      res += str1.substring(i, i + 1);\n    }\n    res += str.length < str1.length ? str1.substring(i) : str.substring(i);\n    return res;\n  }\n\n  private getToken(str: string): string {\n    let array = [1, 2, 3];\n    if (str.length > 24)\n      str = str.substring(0, 24);\n    let length = Math.floor(str.length / 3);\n    let str1 = str.substring(0, length);\n    let str2 = str.substring(length, 2 * length);\n    let str3 = str.substring(2 * length, 3 * length);\n    let randomArray = [];\n    var random = Math.ceil(Math.random() * 3);\n    randomArray.push(array[random - 1]);\n    array.splice(random - 1, 1);\n    random = Math.ceil(Math.random() * 2);\n    randomArray.push(array[random - 1]);\n    array.splice(random - 1, 1);\n    randomArray.push(array[0]);\n    let timeStamp: string = Math.round(new Date().getTime() / 1000) + \"\";\n\n    return timeStamp.substring(0, 5) + \"times\" + randomArray[0] + \"\" + randomArray[1] + \"\" + randomArray[2] + this.switchStr(str1, str2, str3, randomArray[0]) + this.switchStr(str1, str2, str3, randomArray[1]) + this.switchStr(str1, str2, str3, randomArray[2]) + \"times\" + timeStamp.substring(5);\n  }\n\n  private switchStr(str1: string, str2: string, str3: string, i: number): string {\n    switch (i) {\n      case 1: return str1;\n      case 2: return str2;\n      case 3: return str3;\n    }\n  }\n\n\n}\n"],"names":[],"mappings":"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"}
