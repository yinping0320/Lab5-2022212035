/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Injectable, Injector, ComponentFactoryResolver } from "@angular/core";
import { HttpService } from "@ecp-caf/caf-common";
import { TrackType } from "../config/track-type.map";
import { AifDocumentsTrackManagerComponent } from "../aif-documents-track-manager/aif-documents-track-manager.component";
import { BsModalService } from '@farris/ui-modal';
import { AifDocumentsTrackManagerModuleConfig } from '../../entity/aif-documents-track-manager-module-config';
/**
 * 供内部和外部共同使用的单据追踪服务类，可输入参数自动查询并显示单据追踪模态框，也可以仅获取单据追踪查询结果
 */
export class AifDocumentsTrackService {
    /**
     * @param {?} http
     * @param {?} modalService
     * @param {?} injector
     * @param {?} cfr
     * @param {?} config
     */
    constructor(http, modalService, injector, cfr, config) {
        this.http = http;
        this.modalService = modalService;
        this.injector = injector;
        this.cfr = cfr;
        this.serverIP = "";
        this.baseUrl = '/api/runtime/aif/v1.0/associationcontroller/';
        this.serverIP = config == null || config.serverIP == null ? "" : config.serverIP;
    }
    /**
     * 根据参数追踪并显示追踪模态框，注意：调用该方法时应同时引用TrackType枚举类
     * @param {?} documentId 单据ID
     * @param {?} beType 单据类型编号
     * @param {?} trackType 追踪类型，仅可用“UpSearch”（上查）或“DownSearch”（下查)
     * @return {?}
     */
    showResultDialog(documentId, beType, trackType) {
        /** @type {?} */
        const cmpF = this.cfr.resolveComponentFactory(AifDocumentsTrackManagerComponent);
        /** @type {?} */
        const cmpR = cmpF.create(this.injector);
        if (trackType != TrackType.DownSearch && trackType != TrackType.UpSearch) {
            trackType = TrackType.DownSearch;
        }
        cmpR.instance.searchFromOut(documentId, beType, trackType);
        return this.modalService.show(cmpR, {
            title: '追踪',
            width: 1100,
            height: 600,
            buttons: null,
            showButtons: false
        });
    }
    /**
     * 根据参数追踪并将查询结果返回，注意：调用该方法时应同时引用TrackType枚举类
     * @param {?} documentId 单据ID
     * @param {?} beType 单据类型编号
     * @param {?} trackType 追踪类型，仅可用“UpSearch”（上查）或“DownSearch”（下查),
     * @return {?}
     */
    getTrackedDocumentData(documentId, beType, trackType) {
        if (trackType == TrackType.DownSearch) {
            return this.getTargetData(beType, documentId);
        }
        else {
            return this.getSourceData(beType, documentId);
        }
    }
    /**
     * @private
     * @param {?} srcBeType
     * @param {?} srcDataId
     * @return {?}
     */
    getTargetData(srcBeType, srcDataId) {
        /** @type {?} */
        const url = this.serverIP + this.baseUrl + `GetTargetData/${srcBeType}&${srcDataId}`;
        return this.http.get(url);
    }
    /**
     * @private
     * @param {?} tarBeType
     * @param {?} tarDataId
     * @return {?}
     */
    getSourceData(tarBeType, tarDataId) {
        /** @type {?} */
        const url = this.serverIP + this.baseUrl + `GetSourceData/${tarBeType}&${tarDataId}`;
        return this.http.get(url);
    }
}
AifDocumentsTrackService.decorators = [
    { type: Injectable }
];
/** @nocollapse */
AifDocumentsTrackService.ctorParameters = () => [
    { type: HttpService },
    { type: BsModalService },
    { type: Injector },
    { type: ComponentFactoryResolver },
    { type: AifDocumentsTrackManagerModuleConfig }
];
if (false) {
    /**
     * @type {?}
     * @private
     */
    AifDocumentsTrackService.prototype.serverIP;
    /**
     * @type {?}
     * @private
     */
    AifDocumentsTrackService.prototype.baseUrl;
    /**
     * @type {?}
     * @private
     */
    AifDocumentsTrackService.prototype.http;
    /**
     * @type {?}
     * @private
     */
    AifDocumentsTrackService.prototype.modalService;
    /**
     * @type {?}
     * @private
     */
    AifDocumentsTrackService.prototype.injector;
    /**
     * @type {?}
     * @private
     */
    AifDocumentsTrackService.prototype.cfr;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYWlmLWRvY3VtZW50cy10cmFjay5zZXJ2aWNlLmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGdzcC1haWYvcnVudGltZS1hcGkvIiwic291cmNlcyI6WyJsaWIvYWlmLWRvY3VtZW50cy10cmFjay9zZXJ2aWNlL2FpZi1kb2N1bWVudHMtdHJhY2suc2VydmljZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7O0FBQUEsT0FBTyxFQUFFLFVBQVUsRUFBRSxRQUFRLEVBQUUsd0JBQXdCLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFDL0UsT0FBTyxFQUFFLFdBQVcsRUFBRSxNQUFNLHFCQUFxQixDQUFDO0FBRWxELE9BQU8sRUFBRSxTQUFTLEVBQUUsTUFBTSwwQkFBMEIsQ0FBQztBQUNyRCxPQUFPLEVBQUUsaUNBQWlDLEVBQUUsTUFBTSxzRUFBc0UsQ0FBQztBQUN6SCxPQUFPLEVBQUUsY0FBYyxFQUFjLE1BQU0sa0JBQWtCLENBQUM7QUFDOUQsT0FBTyxFQUFFLG9DQUFvQyxFQUFFLE1BQU0sd0RBQXdELENBQUM7Ozs7QUFNOUcsTUFBTSxPQUFPLHdCQUF3Qjs7Ozs7Ozs7SUFJakMsWUFBMkIsSUFBaUIsRUFBVSxZQUE0QixFQUFVLFFBQWtCLEVBQVUsR0FBNkIsRUFBRSxNQUE0QztRQUF4SyxTQUFJLEdBQUosSUFBSSxDQUFhO1FBQVUsaUJBQVksR0FBWixZQUFZLENBQWdCO1FBQVUsYUFBUSxHQUFSLFFBQVEsQ0FBVTtRQUFVLFFBQUcsR0FBSCxHQUFHLENBQTBCO1FBSDdJLGFBQVEsR0FBVyxFQUFFLENBQUM7UUFDdEIsWUFBTyxHQUFHLDhDQUE4QyxDQUFDO1FBRzdELElBQUksQ0FBQyxRQUFRLEdBQUcsTUFBTSxJQUFJLElBQUksSUFBSSxNQUFNLENBQUMsUUFBUSxJQUFJLElBQUksQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsUUFBUSxDQUFDO0lBQ3JGLENBQUM7Ozs7Ozs7O0lBUU0sZ0JBQWdCLENBQUMsVUFBa0IsRUFBRSxNQUFjLEVBQUUsU0FBb0I7O2NBQ3RFLElBQUksR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLHVCQUF1QixDQUFDLGlDQUFpQyxDQUFDOztjQUMxRSxJQUFJLEdBQUcsSUFBSSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDO1FBRXZDLElBQUksU0FBUyxJQUFJLFNBQVMsQ0FBQyxVQUFVLElBQUksU0FBUyxJQUFJLFNBQVMsQ0FBQyxRQUFRLEVBQUU7WUFDdEUsU0FBUyxHQUFHLFNBQVMsQ0FBQyxVQUFVLENBQUM7U0FDcEM7UUFFRCxJQUFJLENBQUMsUUFBUSxDQUFDLGFBQWEsQ0FBQyxVQUFVLEVBQUUsTUFBTSxFQUFFLFNBQVMsQ0FBQyxDQUFDO1FBRTNELE9BQU8sSUFBSSxDQUFDLFlBQVksQ0FBQyxJQUFJLENBQUMsSUFBSSxFQUFFO1lBQ2hDLEtBQUssRUFBRSxJQUFJO1lBQ1gsS0FBSyxFQUFFLElBQUk7WUFDWCxNQUFNLEVBQUUsR0FBRztZQUNYLE9BQU8sRUFBRSxJQUFJO1lBQ2IsV0FBVyxFQUFFLEtBQUs7U0FDckIsQ0FBQyxDQUFDO0lBQ1AsQ0FBQzs7Ozs7Ozs7SUFRTSxzQkFBc0IsQ0FBQyxVQUFrQixFQUFFLE1BQWMsRUFBRSxTQUFvQjtRQUNsRixJQUFJLFNBQVMsSUFBSSxTQUFTLENBQUMsVUFBVSxFQUFFO1lBQ25DLE9BQU8sSUFBSSxDQUFDLGFBQWEsQ0FBQyxNQUFNLEVBQUUsVUFBVSxDQUFDLENBQUM7U0FDakQ7YUFBTTtZQUNILE9BQU8sSUFBSSxDQUFDLGFBQWEsQ0FBQyxNQUFNLEVBQUUsVUFBVSxDQUFDLENBQUM7U0FDakQ7SUFDTCxDQUFDOzs7Ozs7O0lBRU8sYUFBYSxDQUFDLFNBQWlCLEVBQUUsU0FBaUI7O2NBQ2hELEdBQUcsR0FBRyxJQUFJLENBQUMsUUFBUSxHQUFHLElBQUksQ0FBQyxPQUFPLEdBQUcsaUJBQWlCLFNBQVMsSUFBSSxTQUFTLEVBQUU7UUFDcEYsT0FBTyxJQUFJLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsQ0FBQztJQUM5QixDQUFDOzs7Ozs7O0lBRU8sYUFBYSxDQUFDLFNBQWlCLEVBQUUsU0FBaUI7O2NBQ2hELEdBQUcsR0FBRyxJQUFJLENBQUMsUUFBUSxHQUFHLElBQUksQ0FBQyxPQUFPLEdBQUcsaUJBQWlCLFNBQVMsSUFBSSxTQUFTLEVBQUU7UUFDcEYsT0FBTyxJQUFJLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsQ0FBQztJQUM5QixDQUFDOzs7WUF4REosVUFBVTs7OztZQVZGLFdBQVc7WUFJWCxjQUFjO1lBTEYsUUFBUTtZQUFFLHdCQUF3QjtZQU05QyxvQ0FBb0M7Ozs7Ozs7SUFPekMsNENBQThCOzs7OztJQUM5QiwyQ0FBaUU7Ozs7O0lBRTlDLHdDQUF5Qjs7Ozs7SUFBRSxnREFBb0M7Ozs7O0lBQUUsNENBQTBCOzs7OztJQUFFLHVDQUFxQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEluamVjdGFibGUsIEluamVjdG9yLCBDb21wb25lbnRGYWN0b3J5UmVzb2x2ZXIgfSBmcm9tIFwiQGFuZ3VsYXIvY29yZVwiO1xyXG5pbXBvcnQgeyBIdHRwU2VydmljZSB9IGZyb20gXCJAZWNwLWNhZi9jYWYtY29tbW9uXCI7XHJcbmltcG9ydCB7IE9ic2VydmFibGUgfSBmcm9tIFwicnhqc1wiO1xyXG5pbXBvcnQgeyBUcmFja1R5cGUgfSBmcm9tIFwiLi4vY29uZmlnL3RyYWNrLXR5cGUubWFwXCI7XHJcbmltcG9ydCB7IEFpZkRvY3VtZW50c1RyYWNrTWFuYWdlckNvbXBvbmVudCB9IGZyb20gXCIuLi9haWYtZG9jdW1lbnRzLXRyYWNrLW1hbmFnZXIvYWlmLWRvY3VtZW50cy10cmFjay1tYW5hZ2VyLmNvbXBvbmVudFwiO1xyXG5pbXBvcnQgeyBCc01vZGFsU2VydmljZSwgQnNNb2RhbFJlZiB9IGZyb20gJ0BmYXJyaXMvdWktbW9kYWwnO1xyXG5pbXBvcnQgeyBBaWZEb2N1bWVudHNUcmFja01hbmFnZXJNb2R1bGVDb25maWcgfSBmcm9tICcuLi8uLi9lbnRpdHkvYWlmLWRvY3VtZW50cy10cmFjay1tYW5hZ2VyLW1vZHVsZS1jb25maWcnO1xyXG5cclxuLyoqXHJcbiAqIOS+m+WGhemDqOWSjOWklumDqOWFseWQjOS9v+eUqOeahOWNleaNrui/vei4quacjeWKoeexu++8jOWPr+i+k+WFpeWPguaVsOiHquWKqOafpeivouW5tuaYvuekuuWNleaNrui/vei4quaooeaAgeahhu+8jOS5n+WPr+S7peS7heiOt+WPluWNleaNrui/vei4quafpeivoue7k+aenFxyXG4gKi9cclxuQEluamVjdGFibGUoKVxyXG5leHBvcnQgY2xhc3MgQWlmRG9jdW1lbnRzVHJhY2tTZXJ2aWNlIHtcclxuICAgIHByaXZhdGUgc2VydmVySVA6IHN0cmluZyA9IFwiXCI7XHJcbiAgICBwcml2YXRlIGJhc2VVcmwgPSAnL2FwaS9ydW50aW1lL2FpZi92MS4wL2Fzc29jaWF0aW9uY29udHJvbGxlci8nO1xyXG5cclxuICAgIHB1YmxpYyBjb25zdHJ1Y3Rvcihwcml2YXRlIGh0dHA6IEh0dHBTZXJ2aWNlLCBwcml2YXRlIG1vZGFsU2VydmljZTogQnNNb2RhbFNlcnZpY2UsIHByaXZhdGUgaW5qZWN0b3I6IEluamVjdG9yLCBwcml2YXRlIGNmcjogQ29tcG9uZW50RmFjdG9yeVJlc29sdmVyLCBjb25maWc6IEFpZkRvY3VtZW50c1RyYWNrTWFuYWdlck1vZHVsZUNvbmZpZykge1xyXG4gICAgICAgIHRoaXMuc2VydmVySVAgPSBjb25maWcgPT0gbnVsbCB8fCBjb25maWcuc2VydmVySVAgPT0gbnVsbCA/IFwiXCIgOiBjb25maWcuc2VydmVySVA7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDmoLnmja7lj4LmlbDov73ouKrlubbmmL7npLrov73ouKrmqKHmgIHmoYbvvIzms6jmhI/vvJrosIPnlKjor6Xmlrnms5Xml7blupTlkIzml7blvJXnlKhUcmFja1R5cGXmnprkuL7nsbtcclxuICAgICAqIEBwYXJhbSBkb2N1bWVudElkIOWNleaNrklEXHJcbiAgICAgKiBAcGFyYW0gYmVUeXBlIOWNleaNruexu+Wei+e8luWPt1xyXG4gICAgICogQHBhcmFtIHRyYWNrVHlwZSDov73ouKrnsbvlnovvvIzku4Xlj6/nlKjigJxVcFNlYXJjaOKAne+8iOS4iuafpe+8ieaIluKAnERvd25TZWFyY2jigJ3vvIjkuIvmn6UpXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBzaG93UmVzdWx0RGlhbG9nKGRvY3VtZW50SWQ6IHN0cmluZywgYmVUeXBlOiBzdHJpbmcsIHRyYWNrVHlwZTogVHJhY2tUeXBlKTogQnNNb2RhbFJlZiB7XHJcbiAgICAgICAgY29uc3QgY21wRiA9IHRoaXMuY2ZyLnJlc29sdmVDb21wb25lbnRGYWN0b3J5KEFpZkRvY3VtZW50c1RyYWNrTWFuYWdlckNvbXBvbmVudCk7XHJcbiAgICAgICAgY29uc3QgY21wUiA9IGNtcEYuY3JlYXRlKHRoaXMuaW5qZWN0b3IpO1xyXG5cclxuICAgICAgICBpZiAodHJhY2tUeXBlICE9IFRyYWNrVHlwZS5Eb3duU2VhcmNoICYmIHRyYWNrVHlwZSAhPSBUcmFja1R5cGUuVXBTZWFyY2gpIHtcclxuICAgICAgICAgICAgdHJhY2tUeXBlID0gVHJhY2tUeXBlLkRvd25TZWFyY2g7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjbXBSLmluc3RhbmNlLnNlYXJjaEZyb21PdXQoZG9jdW1lbnRJZCwgYmVUeXBlLCB0cmFja1R5cGUpO1xyXG5cclxuICAgICAgICByZXR1cm4gdGhpcy5tb2RhbFNlcnZpY2Uuc2hvdyhjbXBSLCB7XHJcbiAgICAgICAgICAgIHRpdGxlOiAn6L+96LiqJyxcclxuICAgICAgICAgICAgd2lkdGg6IDExMDAsXHJcbiAgICAgICAgICAgIGhlaWdodDogNjAwLFxyXG4gICAgICAgICAgICBidXR0b25zOiBudWxsLFxyXG4gICAgICAgICAgICBzaG93QnV0dG9uczogZmFsc2VcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOagueaNruWPguaVsOi/vei4quW5tuWwhuafpeivoue7k+aenOi/lOWbnu+8jOazqOaEj++8muiwg+eUqOivpeaWueazleaXtuW6lOWQjOaXtuW8leeUqFRyYWNrVHlwZeaemuS4vuexu1xyXG4gICAgICogQHBhcmFtIGRvY3VtZW50SWQg5Y2V5o2uSURcclxuICAgICAqIEBwYXJhbSBiZVR5cGUg5Y2V5o2u57G75Z6L57yW5Y+3XHJcbiAgICAgKiBAcGFyYW0gdHJhY2tUeXBlIOi/vei4quexu+Wei++8jOS7heWPr+eUqOKAnFVwU2VhcmNo4oCd77yI5LiK5p+l77yJ5oiW4oCcRG93blNlYXJjaOKAne+8iOS4i+afpSksXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBnZXRUcmFja2VkRG9jdW1lbnREYXRhKGRvY3VtZW50SWQ6IHN0cmluZywgYmVUeXBlOiBzdHJpbmcsIHRyYWNrVHlwZTogVHJhY2tUeXBlKTogT2JzZXJ2YWJsZTxhbnk+IHtcclxuICAgICAgICBpZiAodHJhY2tUeXBlID09IFRyYWNrVHlwZS5Eb3duU2VhcmNoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmdldFRhcmdldERhdGEoYmVUeXBlLCBkb2N1bWVudElkKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5nZXRTb3VyY2VEYXRhKGJlVHlwZSwgZG9jdW1lbnRJZCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgZ2V0VGFyZ2V0RGF0YShzcmNCZVR5cGU6IHN0cmluZywgc3JjRGF0YUlkOiBzdHJpbmcpOiBPYnNlcnZhYmxlPGFueT4ge1xyXG4gICAgICAgIGNvbnN0IHVybCA9IHRoaXMuc2VydmVySVAgKyB0aGlzLmJhc2VVcmwgKyBgR2V0VGFyZ2V0RGF0YS8ke3NyY0JlVHlwZX0mJHtzcmNEYXRhSWR9YDtcclxuICAgICAgICByZXR1cm4gdGhpcy5odHRwLmdldCh1cmwpO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgZ2V0U291cmNlRGF0YSh0YXJCZVR5cGU6IHN0cmluZywgdGFyRGF0YUlkOiBzdHJpbmcpOiBPYnNlcnZhYmxlPGFueT4ge1xyXG4gICAgICAgIGNvbnN0IHVybCA9IHRoaXMuc2VydmVySVAgKyB0aGlzLmJhc2VVcmwgKyBgR2V0U291cmNlRGF0YS8ke3RhckJlVHlwZX0mJHt0YXJEYXRhSWR9YDtcclxuICAgICAgICByZXR1cm4gdGhpcy5odHRwLmdldCh1cmwpO1xyXG4gICAgfVxyXG59Il19