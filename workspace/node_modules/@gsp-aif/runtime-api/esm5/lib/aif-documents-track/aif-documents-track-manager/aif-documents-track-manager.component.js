/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
import { Component, Input, Output } from '@angular/core';
import { TrackType } from '../config/track-type.map';
import { AifDocumentsTrackService } from '../service/aif-documents-track.service';
import { TrackTypeTextMap } from '../config/track-type-text.map';
/**
 * 单据追踪主组件
 */
var AifDocumentsTrackManagerComponent = /** @class */ (function () {
    function AifDocumentsTrackManagerComponent(trackService) {
        this.trackService = trackService;
        /**
         * 子组件显示控制
         */
        this.isHidden = true;
        this.isShowable = false;
        this.isResultEmpty = null;
        this.documentId = null;
        this.beTypeCode = null;
        this.selectedTrackType = null;
        this.trackTypes = [];
        /**
         * 传递给子组件的所选择的追踪方式
         */
        this.selectedTrackTypeToChildren = "";
        /**
         * 响应结果转化为组件内传输格式
         */
        this.beTypeCodes = [];
        this.documents = {};
        this.beTypeNames = {};
        //初始化追踪方式下拉框
        for (var item in TrackType) {
            this.trackTypes.push({ value: item, text: TrackTypeTextMap[item] });
        }
        //默认选择“下查”方式
        this.selectedTrackType = this.trackTypes[1].value;
        this.selectedTrackTypeToChildren = this.selectedTrackType;
    }
    /**
     * @return {?}
     */
    AifDocumentsTrackManagerComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
    };
    /**
     * @param {?} changes
     * @return {?}
     */
    AifDocumentsTrackManagerComponent.prototype.ngOnChanges = /**
     * @param {?} changes
     * @return {?}
     */
    function (changes) {
    };
    /**
     * @return {?}
     */
    AifDocumentsTrackManagerComponent.prototype.search = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this.selectedTrackTypeToChildren = this.selectedTrackType;
        this.trackService.getTrackedDocumentData(this.documentId, this.beTypeCode, this.selectedTrackType).subscribe((/**
         * @param {?} data
         * @return {?}
         */
        function (data) {
            var e_1, _a;
            /** @type {?} */
            var tempDocuments = {};
            /** @type {?} */
            var tempBeTypeNames = {};
            /** @type {?} */
            var tempBeTypeCodes = [];
            if (_this.isNullOrUndefined(data) == false && data.length > 0) {
                _this.isResultEmpty = false;
                _this.isShowable = true;
                _this.isHidden = false;
                try {
                    for (var data_1 = tslib_1.__values(data), data_1_1 = data_1.next(); !data_1_1.done; data_1_1 = data_1.next()) {
                        var item = data_1_1.value;
                        //查询结果不为空时
                        if (_this.isNullOrUndefined(tempDocuments[item.BeTypeCode]) == false) {
                            tempDocuments[item.BeTypeCode].push(item);
                        }
                        else {
                            tempBeTypeCodes.push(item.BeTypeCode);
                            tempBeTypeNames[item.BeTypeCode] = item.BeTypeName;
                            tempDocuments[item.BeTypeCode] = [item];
                        }
                    }
                }
                catch (e_1_1) { e_1 = { error: e_1_1 }; }
                finally {
                    try {
                        if (data_1_1 && !data_1_1.done && (_a = data_1.return)) _a.call(data_1);
                    }
                    finally { if (e_1) throw e_1.error; }
                }
            }
            else {
                //查询结果为空时
                _this.isResultEmpty = true;
                _this.isShowable = false;
                _this.isHidden = true;
            }
            _this.documents = tempDocuments;
            _this.beTypeCodes = tempBeTypeCodes;
            _this.beTypeNames = tempBeTypeNames;
        }));
    };
    /**
     * 为外部提供的方便递归调用的查询接口
     * @param documentId
     * @param beType
     * @param trackType
     */
    /**
     * 为外部提供的方便递归调用的查询接口
     * @param {?} documentId
     * @param {?} beType
     * @param {?} trackType
     * @return {?}
     */
    AifDocumentsTrackManagerComponent.prototype.searchFromOut = /**
     * 为外部提供的方便递归调用的查询接口
     * @param {?} documentId
     * @param {?} beType
     * @param {?} trackType
     * @return {?}
     */
    function (documentId, beType, trackType) {
        this.documentId = documentId;
        this.beTypeCode = beType;
        this.selectedTrackType = trackType;
        this.search();
    };
    /**
     * 从查询结果中选择单据继续追踪时，父组件接收到子组件传来的
     * 对象，并自动调用查询方法
     * @param $event
     */
    /**
     * 从查询结果中选择单据继续追踪时，父组件接收到子组件传来的
     * 对象，并自动调用查询方法
     * @param {?} $event
     * @return {?}
     */
    AifDocumentsTrackManagerComponent.prototype.trackGoingOn = /**
     * 从查询结果中选择单据继续追踪时，父组件接收到子组件传来的
     * 对象，并自动调用查询方法
     * @param {?} $event
     * @return {?}
     */
    function ($event) {
        this.documentId = $event.documentId;
        this.beTypeCode = $event.beTypeCode;
        this.selectedTrackType = $event.trackType;
        this.search();
    };
    /**
     * @private
     * @param {?} arg
     * @return {?}
     */
    AifDocumentsTrackManagerComponent.prototype.isNullOrUndefined = /**
     * @private
     * @param {?} arg
     * @return {?}
     */
    function (arg) {
        return arg == null;
    };
    AifDocumentsTrackManagerComponent.decorators = [
        { type: Component, args: [{
                    selector: 'app-aif-documents-track-manager',
                    template: "<div class=\"d-flex g-main\">\r\n  <div class=\"col\">\r\n    <div class=\"g-main d-flex flex-column px-2\">\r\n      <!--\u4E3B\u5185\u5BB9\u533A-->\r\n      <div class=\"mb-1 pr-2 position-relative clearfix\">\r\n        <!-- <div class=\"\" style=\"\"> -->\r\n        <div class=\"position-relative\" [style.display]=\"'inherit'\">\r\n          <div class=\"form-inline row py-1\">\r\n            <div class=\"form-group col-sm-12 col-md-4 mb-1\">\r\n              <div class=\"input-group w-100\">\r\n                <div class=\"input-group-prepend\"><span class=\"input-group-text\">\u5355\u636EID</span></div>\r\n                <input class=\"form-control\" placeholder=\"\" name=\"documentId\" [(ngModel)]=\"documentId\" type=\"text\" />\r\n              </div>\r\n            </div>\r\n\r\n            <div class=\"form-group col-sm-12 col-md-4 mb-1\">\r\n                <div class=\"input-group w-100\">\r\n                  <div class=\"input-group-prepend\"><span class=\"input-group-text\">BE\u7C7B\u578B\u7F16\u53F7</span></div>\r\n                  <input class=\"form-control\" placeholder=\"\" name=\"beTypeCode\" [(ngModel)]=\"beTypeCode\" type=\"text\" />\r\n                </div>\r\n            </div>\r\n\r\n            <div class=\"form-group col-sm-12 col-md-2 mb-1\">\r\n                <div class=\"input-group w-100\">\r\n                  <div class=\"input-group-prepend\"><span class=\"input-group-text\">\u8FFD\u8E2A\u65B9\u5F0F</span></div>\r\n                  <select [(ngModel)]=\"selectedTrackType\" class=\"form-control\">\r\n                      <option *ngFor=\"let tt of trackTypes\" value=\"{{tt.value}}\">{{tt.text}}</option>\r\n                    </select>\r\n                </div>\r\n            </div>\r\n\r\n            <div class=\" col-sm-12 col-md-1 mb-1\">\r\n              <div class=\"w-100\">\r\n                <button class=\"k-button btn btn-sm btn-default\" type=\"button\" (click)=\"search()\">\u67E5\u8BE2</button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n        </div>\r\n        <div class=\"k-form-field\" style=\"color:red; font-size: unset;\" *ngIf=\"isResultEmpty==true\">\u67E5\u8BE2\u7ED3\u679C\u4E3A\u7A7A</div>\r\n      </div>\r\n\r\n      <div class=\"flex-auto k-form-field pb-1\">\r\n        <app-aif-documents-tree [documents]=\"documents\" [beTypeNames]=\"beTypeNames\" [beTypeCodes]=\"beTypeCodes\"\r\n          [trackType]=\"selectedTrackTypeToChildren\" (trackClick)=\"trackGoingOn($event)\">\r\n        </app-aif-documents-tree>\r\n      </div>\r\n\r\n    </div>\r\n  </div>\r\n</div>",
                    styles: [""]
                }] }
    ];
    /** @nocollapse */
    AifDocumentsTrackManagerComponent.ctorParameters = function () { return [
        { type: AifDocumentsTrackService }
    ]; };
    AifDocumentsTrackManagerComponent.propDecorators = {
        documentId: [{ type: Input }],
        beTypeCode: [{ type: Input }],
        selectedTrackType: [{ type: Input }],
        trackTypes: [{ type: Output }]
    };
    return AifDocumentsTrackManagerComponent;
}());
export { AifDocumentsTrackManagerComponent };
if (false) {
    /**
     * 子组件显示控制
     * @type {?}
     */
    AifDocumentsTrackManagerComponent.prototype.isHidden;
    /** @type {?} */
    AifDocumentsTrackManagerComponent.prototype.isShowable;
    /** @type {?} */
    AifDocumentsTrackManagerComponent.prototype.isResultEmpty;
    /** @type {?} */
    AifDocumentsTrackManagerComponent.prototype.documentId;
    /** @type {?} */
    AifDocumentsTrackManagerComponent.prototype.beTypeCode;
    /** @type {?} */
    AifDocumentsTrackManagerComponent.prototype.selectedTrackType;
    /** @type {?} */
    AifDocumentsTrackManagerComponent.prototype.trackTypes;
    /**
     * 传递给子组件的所选择的追踪方式
     * @type {?}
     */
    AifDocumentsTrackManagerComponent.prototype.selectedTrackTypeToChildren;
    /**
     * 响应结果转化为组件内传输格式
     * @type {?}
     */
    AifDocumentsTrackManagerComponent.prototype.beTypeCodes;
    /** @type {?} */
    AifDocumentsTrackManagerComponent.prototype.documents;
    /** @type {?} */
    AifDocumentsTrackManagerComponent.prototype.beTypeNames;
    /**
     * @type {?}
     * @private
     */
    AifDocumentsTrackManagerComponent.prototype.trackService;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYWlmLWRvY3VtZW50cy10cmFjay1tYW5hZ2VyLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0Bnc3AtYWlmL3J1bnRpbWUtYXBpLyIsInNvdXJjZXMiOlsibGliL2FpZi1kb2N1bWVudHMtdHJhY2svYWlmLWRvY3VtZW50cy10cmFjay1tYW5hZ2VyL2FpZi1kb2N1bWVudHMtdHJhY2stbWFuYWdlci5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQSxPQUFPLEVBQUUsU0FBUyxFQUFVLEtBQUssRUFBRSxNQUFNLEVBQTRCLE1BQU0sZUFBZSxDQUFDO0FBQzNGLE9BQU8sRUFBRSxTQUFTLEVBQUUsTUFBTSwwQkFBMEIsQ0FBQztBQUNyRCxPQUFPLEVBQUUsd0JBQXdCLEVBQUUsTUFBTSx3Q0FBd0MsQ0FBQztBQUNsRixPQUFPLEVBQUUsZ0JBQWdCLEVBQUUsTUFBTSwrQkFBK0IsQ0FBQzs7OztBQU1qRTtJQTZCRSwyQ0FBb0IsWUFBc0M7UUFBdEMsaUJBQVksR0FBWixZQUFZLENBQTBCOzs7O1FBckIxRCxhQUFRLEdBQVksSUFBSSxDQUFDO1FBQ3pCLGVBQVUsR0FBWSxLQUFLLENBQUM7UUFDNUIsa0JBQWEsR0FBWSxJQUFJLENBQUM7UUFHOUIsZUFBVSxHQUFXLElBQUksQ0FBQztRQUUxQixlQUFVLEdBQVcsSUFBSSxDQUFDO1FBRTFCLHNCQUFpQixHQUFjLElBQUksQ0FBQztRQUVwQyxlQUFVLEdBQUcsRUFBRSxDQUFDOzs7O1FBR2hCLGdDQUEyQixHQUFXLEVBQUUsQ0FBQzs7OztRQUd6QyxnQkFBVyxHQUFVLEVBQUUsQ0FBQztRQUN4QixjQUFTLEdBQW9DLEVBQUUsQ0FBQztRQUNoRCxnQkFBVyxHQUFxQyxFQUFFLENBQUM7UUFHakQsWUFBWTtRQUNaLEtBQUssSUFBSSxJQUFJLElBQUksU0FBUyxFQUFFO1lBQzFCLElBQUksQ0FBQyxVQUFVLENBQUMsSUFBSSxDQUFDLEVBQUUsS0FBSyxFQUFFLElBQUksRUFB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QUM7UUFDcEMsSUFBSSxDQUFDLFVBQVUsR0FBRyxNQUFNLENBQUMsVUFBVSxDQUFDO1FBQ3BDLElBQUksQ0FBQyxpQkFBaUIsR0FBRyxNQUFNLENBQUMsU0FBUyxDQUFDO1FBQzFDLElBQUksQ0FBQyxNQUFNLEVBQUUsQ0FBQztJQUNoQixDQUFDOzs7Ozs7SUFFTyw2REFBaUI7Ozs7O0lBQXpCLFVBQTBCLEdBQVE7UUFDaEMsT0FBTyxHQUFHLElBQUksSUFBSSxDQUFDO0lBQ3JCLENBQUM7O2dCQTFHRixTQUFTLFNBQUM7b0JBQ1QsUUFBUSxFQUFFLGlDQUFpQztvQkFDM0Msb2pGQUEyRDs7aUJBRTVEOzs7O2dCQVhRLHdCQUF3Qjs7OzZCQW1COUIsS0FBSzs2QkFFTCxLQUFLO29DQUVMLEtBQUs7NkJBRUwsTUFBTTs7SUF5RlQsd0NBQUM7Q0FBQSxBQTNHRCxJQTJHQztTQXRHWSxpQ0FBaUM7Ozs7OztJQUc1QyxxREFBeUI7O0lBQ3pCLHVEQUE0Qjs7SUFDNUIsMERBQThCOztJQUU5Qix1REFDMEI7O0lBQzFCLHVEQUMwQjs7SUFDMUIsOERBQ29DOztJQUNwQyx1REFDZ0I7Ozs7O0lBR2hCLHdFQUF5Qzs7Ozs7SUFHekMsd0RBQXdCOztJQUN4QixzREFBZ0Q7O0lBQ2hELHdEQUFtRDs7Ozs7SUFFdkMseURBQThDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ29tcG9uZW50LCBPbkluaXQsIElucHV0LCBPdXRwdXQsIE9uQ2hhbmdlcywgU2ltcGxlQ2hhbmdlcyB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBUcmFja1R5cGUgfSBmcm9tICcuLi9jb25maWcvdHJhY2stdHlwZS5tYXAnO1xyXG5pbXBvcnQgeyBBaWZEb2N1bWVudHNUcmFja1NlcnZpY2UgfSBmcm9tICcuLi9zZXJ2aWNlL2FpZi1kb2N1bWVudHMtdHJhY2suc2VydmljZSc7XHJcbmltcG9ydCB7IFRyYWNrVHlwZVRleHRNYXAgfSBmcm9tICcuLi9jb25maWcvdHJhY2stdHlwZS10ZXh0Lm1hcCc7XHJcbmltcG9ydCB7IE9yZGVySW5mbyB9IGZyb20gJy4uLy4uL2VudGl0eS9vcmRlci1pbmZvJztcclxuXHJcbi8qKlxyXG4gKiDljZXmja7ov73ouKrkuLvnu4Tku7ZcclxuICovXHJcbkBDb21wb25lbnQoe1xyXG4gIHNlbGVjdG9yOiAnYXBwLWFpZi1kb2N1bWVudHMtdHJhY2stbWFuYWdlcicsXHJcbiAgdGVtcGxhdGVVcmw6ICcuL2FpZi1kb2N1bWVudHMtdHJhY2stbWFuYWdlci5jb21wb25lbnQuaHRtbCcsXHJcbiAgc3R5bGVVcmxzOiBbJy4vYWlmLWRvY3VtZW50cy10cmFjay1tYW5hZ2VyLmNvbXBvbmVudC5jc3MnXSxcclxufSlcclxuZXhwb3J0IGNsYXNzIEFpZkRvY3VtZW50c1RyYWNrTWFuYWdlckNvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCwgT25DaGFuZ2VzIHtcclxuXHJcbiAgLyoq5a2Q57uE5Lu25pi+56S65o6n5Yi2ICovXHJcbiAgaXNIaWRkZW46IGJvb2xlYW4gPSB0cnVlO1xyXG4gIGlzU2hvd2FibGU6IGJvb2xlYW4gPSBmYWxzZTtcclxuICBpc1Jlc3VsdEVtcHR5OiBib29sZWFuID0gbnVsbDtcclxuXHJcbiAgQElucHV0KClcclxuICBkb2N1bWVudElkOiBzdHJpbmcgPSBudWxsO1xyXG4gIEBJbnB1dCgpXHJcbiAgYmVUeXBlQ29kZTogc3RyaW5nID0gbnVsbDtcclxuICBASW5wdXQoKVxyXG4gIHNlbGVjdGVkVHJhY2tUeXBlOiBUcmFja1R5cGUgPSBudWxsO1xyXG4gIEBPdXRwdXQoKVxyXG4gIHRyYWNrVHlwZXMgPSBbXTtcclxuXHJcbiAgLyoq5Lyg6YCS57uZ5a2Q57uE5Lu255qE5omA6YCJ5oup55qE6L+96Liq5pa55byPICovXHJcbiAgc2VsZWN0ZWRUcmFja1R5cGVUb0NoaWxkcmVuOiBzdHJpbmcgPSBcIlwiO1xyXG5cclxuICAvKirlk43lupTnu5PmnpzovazljJbkuLrnu4Tku7blhoXkvKDovpPmoLzlvI8gKi9cclxuICBiZVR5cGVDb2RlczogYW55W10gPSBbXTtcclxuICBkb2N1bWVudHM6IHsgW2JlVHlwZUNvZGU6IHN0cmluZ106IGFueVtdIH0gPSB7fTtcclxuICBiZVR5cGVOYW1lczogeyBbYmVUeXBlQ29kZTogc3RyaW5nXTogc3RyaW5nIH0gPSB7fTtcclxuXHJcbiAgY29uc3RydWN0b3IocHJpdmF0ZSB0cmFja1NlcnZpY2U6IEFpZkRvY3VtZW50c1RyYWNrU2VydmljZSkge1xyXG4gICAgLy/liJ3lp4vljJbov73ouKrmlrnlvI/kuIvmi4nmoYZcclxuICAgIGZvciAobGV0IGl0ZW0gaW4gVHJhY2tUeXBlKSB7XHJcbiAgICAgIHRoaXMudHJhY2tUeXBlcy5wdXNoKHsgdmFsdWU6IGl0ZW0sIHRleHQ6IFRyYWNrVHlwZVRleHRNYXBbaXRlbV0gfSk7XHJcbiAgICB9XHJcbiAgICAvL+m7mOiupOmAieaLqeKAnOS4i+afpeKAneaWueW8j1xyXG4gICAgdGhpcy5zZWxlY3RlZFRyYWNrVHlwZSA9IHRoaXMudHJhY2tUeXBlc1sxXS52YWx1ZTtcclxuICAgIHRoaXMuc2VsZWN0ZWRUcmFja1R5cGVUb0NoaWxkcmVuID0gdGhpcy5zZWxlY3RlZFRyYWNrVHlwZTtcclxuICB9XHJcblxyXG4gIG5nT25Jbml0KCkge1xyXG4gIH1cclxuXHJcbiAgbmdPbkNoYW5nZXMoY2hhbmdlczogU2ltcGxlQ2hhbmdlcyk6IHZvaWQge1xyXG4gIH1cclxuXHJcbiAgc2VhcmNoKCk6IHZvaWQge1xyXG4gICAgdGhpcy5zZWxlY3RlZFRyYWNrVHlwZVRvQ2hpbGRyZW4gPSB0aGlzLnNlbGVjdGVkVHJhY2tUeXBlO1xyXG5cclxuICAgIHRoaXMudHJhY2tTZXJ2aWNlLmdldFRyYWNrZWREb2N1bWVudERhdGEodGhpcy5kb2N1bWVudElkLCB0aGlzLmJlVHlwZUNvZGUsIHRoaXMuc2VsZWN0ZWRUcmFja1R5cGUpLnN1YnNjcmliZSgoZGF0YTogT3JkZXJJbmZvW10pID0+IHtcclxuICAgICAgbGV0IHRlbXBEb2N1bWVudHM6IHsgW2JlVHlwZUNvZGU6IHN0cmluZ106IGFueVtdIH0gPSB7fTtcclxuICAgICAgbGV0IHRlbXBCZVR5cGVOYW1lczogeyBbYmVUeXBlQ29kZTogc3RyaW5nXTogc3RyaW5nIH0gPSB7fTtcclxuICAgICAgbGV0IHRlbXBCZVR5cGVDb2RlcyA9IFtdO1xyXG5cclxuICAgICAgaWYgKHRoaXMuaXNOdWxsT3JVbmRlZmluZWQoZGF0YSkgPT0gZmFsc2UgJiYgZGF0YS5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgdGhpcy5pc1Jlc3VsdEVtcHR5ID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5pc1Nob3dhYmxlID0gdHJ1ZTtcclxuICAgICAgICB0aGlzLmlzSGlkZGVuID0gZmFsc2U7XHJcbiAgICAgICAgZm9yIChsZXQgaXRlbSBvZiBkYXRhKSB7XHJcbiAgICAgICAgICAvL+afpeivoue7k+aenOS4jeS4uuepuuaXtlxyXG4gICAgICAgICAgaWYgKHRoaXMuaXNOdWxsT3JVbmRlZmluZWQodGVtcERvY3VtZW50c1tpdGVtLkJlVHlwZUNvZGVdKSA9PSBmYWxzZSkge1xyXG4gICAgICAgICAgICB0ZW1wRG9jdW1lbnRzW2l0ZW0uQmVUeXBlQ29kZV0ucHVzaChpdGVtKTtcclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRlbXBCZVR5cGVDb2Rlcy5wdXNoKGl0ZW0uQmVUeXBlQ29kZSk7XHJcbiAgICAgICAgICAgIHRlbXBCZVR5cGVOYW1lc1tpdGVtLkJlVHlwZUNvZGVdID0gaXRlbS5CZVR5cGVOYW1lO1xyXG4gICAgICAgICAgICB0ZW1wRG9jdW1lbnRzW2l0ZW0uQmVUeXBlQ29kZV0gPSBbaXRlbV07XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIC8v5p+l6K+i57uT5p6c5Li656m65pe2XHJcbiAgICAgICAgdGhpcy5pc1Jlc3VsdEVtcHR5ID0gdHJ1ZTtcclxuICAgICAgICB0aGlzLmlzU2hvd2FibGUgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLmlzSGlkZGVuID0gdHJ1ZTtcclxuICAgICAgfVxyXG4gICAgICB0aGlzLmRvY3VtZW50cyA9IHRlbXBEb2N1bWVudHM7XHJcbiAgICAgIHRoaXMuYmVUeXBlQ29kZXMgPSB0ZW1wQmVUeXBlQ29kZXM7XHJcbiAgICAgIHRoaXMuYmVUeXBlTmFtZXMgPSB0ZW1wQmVUeXBlTmFtZXM7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOS4uuWklumDqOaPkOS+m+eahOaWueS+v+mAkuW9kuiwg+eUqOeahOafpeivouaOpeWPo1xyXG4gICAqIEBwYXJhbSBkb2N1bWVudElkIFxyXG4gICAqIEBwYXJhbSBiZVR5cGUgXHJcbiAgICogQHBhcmFtIHRyYWNrVHlwZSBcclxuICAgKi9cclxuICBwdWJsaWMgc2VhcmNoRnJvbU91dChkb2N1bWVudElkOiBzdHJpbmcsIGJlVHlwZTogc3RyaW5nLCB0cmFja1R5cGU6IFRyYWNrVHlwZSk6IHZvaWQge1xyXG4gICAgdGhpcy5kb2N1bWVudElkID0gZG9jdW1lbnRJZDtcclxuICAgIHRoaXMuYmVUeXBlQ29kZSA9IGJlVHlwZTtcclxuICAgIHRoaXMuc2VsZWN0ZWRUcmFja1R5cGUgPSB0cmFja1R5cGU7XHJcbiAgICB0aGlzLnNlYXJjaCgpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog5LuO5p+l6K+i57uT5p6c5Lit6YCJ5oup5Y2V5o2u57un57ut6L+96Liq5pe277yM54i257uE5Lu25o6l5pS25Yiw5a2Q57uE5Lu25Lyg5p2l55qEXHJcbiAgICog5a+56LGh77yM5bm26Ieq5Yqo6LCD55So5p+l6K+i5pa55rOVXHJcbiAgICogQHBhcmFtICRldmVudCBcclxuICAgKi9cclxuICB0cmFja0dvaW5nT24oJGV2ZW50OiBhbnkpOiB2b2lkIHtcclxuICAgIHRoaXMuZG9jdW1lbnRJZCA9ICRldmVudC5kb2N1bWVudElkO1xyXG4gICAgdGhpcy5iZVR5cGVDb2RlID0gJGV2ZW50LmJlVHlwZUNvZGU7XHJcbiAgICB0aGlzLnNlbGVjdGVkVHJhY2tUeXBlID0gJGV2ZW50LnRyYWNrVHlwZTtcclxuICAgIHRoaXMuc2VhcmNoKCk7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGlzTnVsbE9yVW5kZWZpbmVkKGFyZzogYW55KTogYm9vbGVhbiB7XHJcbiAgICByZXR1cm4gYXJnID09IG51bGw7XHJcbiAgfVxyXG59XHJcbiJdfQ==