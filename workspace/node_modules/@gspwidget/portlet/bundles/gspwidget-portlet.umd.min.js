!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/common/http"),require("@gspwidget/util"),require("rxjs/operators"),require("@angular/common"),require("@angular/core"),require("@gspwidget/widget-core")):"function"==typeof define&&define.amd?define("@gspwidget/portlet",["exports","@angular/common/http","@gspwidget/util","rxjs/operators","@angular/common","@angular/core","@gspwidget/widget-core"],t):t((e.gspwidget=e.gspwidget||{},e.gspwidget.portlet={}),e.ng.common.http,e.util,e.rxjs.operators,e.ng.common,e.ng.core,e.widgetCore)}(this,function(e,t,a,o,n,i,r){"use strict";var u=(l.prototype.ngOnInit=function(){},l.prototype.ngOnChanges=function(e){var t=this;e.portletId&&e.portletId.currentValue?this.portletRepo.getPortletById(this.portletId).subscribe(function(e){t.innerPortlet=e,t.cd.markForCheck(),t.gotPortlet.emit(e)},function(e){t.widget.status=r.WCStatus.WidgetLoadError}):e.portlet&&e.portlet.currentValue?this.innerPortlet=e.portlet.currentValue:e.queryConditions&&e.queryConditions.currentValue&&this.widget.loadNSetData()},l.prototype.handleWidgetInit=function(){this.init.emit()},l.prototype.getDemoData=function(){var t=localStorage.getItem("languageCode")||"zh-CHS";return this.getHomeConfig().pipe(o.map(function(e){return e.data[t]}))},l.prototype.getHomeConfig=function(){return this.http.get("/platform/runtime/sys/web/home/assets/home.config.json")},l.decorators=[{type:i.Component,args:[{selector:"lib-portlet",template:'\n    \x3c!-- {{innerPortlet | json}} --\x3e\n    <lib-widget\n      #widget\n      [portlet]="innerPortlet"\n      [basicWidgetInfo]="innerPortlet?.widget"\n      [propValues]="innerPortlet?.propValues"\n      [instanceId]="instanceId"\n      [getData]="getData"\n      [linkMap]="linkMap"\n      (widgetInit)="handleWidgetInit()"\n    ></lib-widget>\n  '}]}],l.ctorParameters=function(){return[{type:a.PortletRepo},{type:a.DatasetRepo},{type:t.HttpClient},{type:i.ChangeDetectorRef}]},l.propDecorators={portletId:[{type:i.Input}],portlet:[{type:i.Input}],queryConditions:[{type:i.Input}],portletNamesUsingDemoData:[{type:i.Input}],getCustomizedData:[{type:i.Input}],instanceId:[{type:i.Input}],linkMap:[{type:i.Input}],init:[{type:i.Output}],gotPortlet:[{type:i.Output}],widget:[{type:i.ViewChild,args:["widget"]}]},l);function l(e,t,a,n){var r=this;this.portletRepo=e,this.dataResultsetRepo=t,this.http=a,this.cd=n,this.portletNamesUsingDemoData=[],this.init=new i.EventEmitter,this.gotPortlet=new i.EventEmitter,this.getData=function(e){return r.getCustomizedData?r.getCustomizedData().pipe(o.delay(0)):r.portletNamesUsingDemoData.some(function(e){return r.innerPortlet.name.includes(e)})?r.getDemoData().pipe(o.delay(0)):r.dataResultsetRepo.getResultByPortletId(r.innerPortlet.id,e.dpValues,function t(e){if(!e)return'""';var i={id:"undefined_null"};return e.forEach(function(e){var t,a=e.fieldCode,n=e.value;if(n&&(n.dateValue||n.value||n.numValue||n.yearValue||n.startTime||n.endTime||n.startValue||n.endValue)){switch(e.control.getControlType()){case 0:t=n.value;break;case 1:t=n.dateValue;break;case 2:t=n.value[n.valueField];break;case 3:t=n.value.value;break;case 4:t={beginValue:n.startTime?n.startTime:0,endValue:n.endTime?n.endTime:0};break;case 5:t={beginValue:n.startValue?n.startValue:0,endValue:n.endValue?n.endValue:0};break;case 6:t=n.numValue;break;case 7:t=n.yearValue;break;case 8:t=n.value&&n.value.length?n.value[0]:n.value;break;case 9:t={beginValue:n.startValue?n.startValue:0,endValue:n.endValue?n.endValue:0}}if(a&&a.includes(";")){var r=a.split(";")[0].split("."),o=a.split(";")[1].split(".");s(r,i,t.beginValue),s(o,i,t.endValue)}else{s(a.split("."),i,t)}}}),i}(r.queryConditions),e.runtimeAgg)},this.getDataWithDims=function(){}}function s(e,t,a){if(e.length&&1<e.length)for(var n=0;n<e.length;n++)t=p(e[n],0===n?t:t[e[n-1]]),n+1===e.length&&(t[e[n]]=a);else t[e[0]]=a}function p(e,t){t.hasOwnProperty(e)||(t[e]={})}function d(){}var g={Equal:0,GreaterThan:2,GreaterThanOrEqual:3,LessThan:4,LessThanOrEqual:5,BetWeen:6};g[g.Equal]="Equal",g[g.GreaterThan]="GreaterThan",g[g.GreaterThanOrEqual]="GreaterThanOrEqual",g[g.LessThan]="LessThan",g[g.LessThanOrEqual]="LessThanOrEqual",g[g.BetWeen]="BetWeen";var c={Value:0,SmartHelp:1,Enum:2,Express:3};c[c.Value]="Value",c[c.SmartHelp]="SmartHelp",c[c.Enum]="Enum",c[c.Express]="Express";var m={And:0,Or:1};m[m.And]="And",m[m.Or]="Or";var h={Text:0,Help:1,DropDown:2,DateRange:3,NumberRange:4,Search:5,Date:6,CheckboxGroup:7,DateRangeTime:8};h[h.Text]="Text",h[h.Help]="Help",h[h.DropDown]="DropDown",h[h.DateRange]="DateRange",h[h.NumberRange]="NumberRange",h[h.Search]="Search",h[h.Date]="Date",h[h.CheckboxGroup]="CheckboxGroup",h[h.DateRangeTime]="DateRangeTime";var f=(y.decorators=[{type:i.NgModule,args:[{declarations:[u],imports:[n.CommonModule,r.WidgetCoreModule],exports:[u]}]}],y);function y(){}e.PortletComponent=u,e.QueryCondition=d,e.CompareType=g,e.ValueType=c,e.RelationType=m,e.ControlType=h,e.PortletModule=f,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=gspwidget-portlet.umd.min.js.map