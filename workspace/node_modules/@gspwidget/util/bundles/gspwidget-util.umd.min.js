!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@ngx-translate/core"),require("change-case"),require("crypto-js"),require("rxjs"),require("@angular/common/http"),require("@angular/core"),require("rxjs/operators")):"function"==typeof define&&define.amd?define("@gspwidget/util",["exports","@ngx-translate/core","change-case","crypto-js","rxjs","@angular/common/http","@angular/core","rxjs/operators"],e):e((t.gspwidget=t.gspwidget||{},t.gspwidget.util={}),t.core,t.changeCase,t.CryptoJS,t.rxjs,t.ng.common.http,t.ng.core,t.rxjs.operators)}(this,function(t,e,o,n,r,i,a,p){"use strict";n=n&&n.hasOwnProperty("default")?n["default"]:n;var s=(u.prototype.uploadFile=function(t,e){var n=new FormData;return Object.keys(e).forEach(function(t){"file"===t?n.append(t,e[t]):"i18nName"===t||"i18nDesc"===t?n.append(t,JSON.stringify(e[t])):n.append(t,e[t])}),this.http.post(t,n,{responseType:"text"})},u.decorators=[{type:a.Injectable,args:[{providedIn:"root"}]}],u.ctorParameters=function(){return[{type:i.HttpClient}]},u.ngInjectableDef=a.defineInjectable({factory:function(){return new u(a.inject(i.HttpClient))},token:u,providedIn:"root"}),u);function u(t){this.http=t}var c=(l.prototype.ngOnInit=function(){},l.decorators=[{type:a.Component,args:[{selector:"lib-util",template:"\n    <p>\n      util works!\n    </p>\n  "}]}],l.ctorParameters=function(){return[]},l);function l(){}var f="gspframeworkService",g=(d.prototype.openMenu=function(t,e,n,r){window.gspframeworkService.rtf.func.openMenu({appType:"menu",funcId:t,tabId:n,isReload:r,appId:"",appEntrance:"",queryStringParams:new Map(e)})},d.prototype.closeMenu=function(t,e){window.gspframeworkService.rtf.func.close({appType:"menu",funcId:t,tabId:e,appId:"",appEntrance:""})},d.prototype.openApp=function(t){window.gspframeworkService.rtf.func.openMenu({appType:"app",funcId:"",appId:t,appEntrance:""})},d.prototype.openUserInfoMenu=function(){var t=window[f].rtf,e=t.frmEvent,n=t.adapter.adatperSerice().session;this.translate.get("userInfo").subscribe(function(t){e.eventFire("farrisapp-click",{active:!1,code:"userInfo",src:"/platform/runtime/sys/web/userinfo/index.html",sessionid:n.getUserSessionId(),id:"userinfo",appType:"",FuncName:t})})},d.prototype.closeCurRtfTab=function(t){var e=t.snapshot.queryParams,n=e.tabId,r=e.funcId;this.closeMenu(r,n)},d.prototype.onRtfTabChangeToMe=function(t,e){var n=new a.EventEmitter,r=t.snapshot.queryParams.tabId;return h().subscribe(function(t){(e=e||function(t,e){return t===e})(t.tabId,r)&&n.emit(t)}),n},d.decorators=[{type:a.Injectable}],d.ctorParameters=function(){return[{type:e.TranslateService}]},d);function d(t){this.translate=t}var E=new a.EventEmitter,m=!1;function h(){return!m&&window[f]&&(m=!0,window[f].rtf.frmEvent.eventListener("funcSwitchEvent",function(t){E.emit(t)})),E}var y=(T.prototype.ngOnDestroy=function(){},T.prototype.transform=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=this.translate,o=r.translations,i=r.currentLang;return o&&o[i]&&o[i][t]?o[i][t]:t},T.decorators=[{type:a.Injectable},{type:a.Pipe,args:[{name:"trans"}]}],T.ctorParameters=function(){return[{type:e.TranslateService}]},T);function T(t){this.translate=t}var _=(I.decorators=[{type:a.NgModule,args:[{declarations:[c,y],imports:[e.TranslateModule],providers:[g],exports:[c,y]}]}],I);function I(){}var A="LS_LOAD_LOCAL_ASSET",v=localStorage.getItem(A)?"":"/platform/runtime/sys/web/home/",D="/api/runtime/epp/v1.0/";function S(e){Object.keys(e).forEach(function(t){"string"==typeof e[t]?e[t]=D+e[t]:S(e[t])})}var P="data";function G(t){var e=t.replace(/\s/g,"");return e=(e=(e=(e=e.replace(/=/g,":")).replace(/:/g,'":')).replace(/,/g,',"')).replace(/{(?=\w)/g,'{"')}function L(r,t){var e=t.parentIdKey,o=void 0===e?"parentId":e,n=t.rootParentIdValue,i=void 0===n?null:n,a=t.idKey,p=void 0===a?"id":a,s=t.ifIgnore,u=void 0===s?function(t){return!1}:s,c=t.beforeProcess,l=void 0===c?null:c,f=t.afterProcess,g=void 0===f?null:f;var d=r.filter(function(t){return!t[o]||t[o]===i});return function E(t,n){void 0===n&&(n=0),t.forEach(function(e){l&&l(e),e.layer||(e.layer=n),e.value=e.key=e[p],e.label=e.title=e.name;var t=r.filter(function(t){return t[o]===e[p]&&!u(t)});0<t.length?(e.children=t,E(e.children,n+1)):e.isLeaf=!0,g&&g(e)})}(d),d}function R(e,t,n){if(void 0===n&&(n=!1),n||!Array.from(document.querySelectorAll("link")).some(function(t){return t.href===e})){if(t){var r=document.getElementById(t);if(r)return void(r.href=e)}var o=document.getElementsByTagName("head")[0],i=document.createElement("link");t&&(i.id=t),i.type="text/css",i.rel="stylesheet",i.href=e,o.appendChild(i)}}function O(t){return JSON.parse(JSON.stringify(t))}function B(){var t=localStorage.getItem("gsp_rtf_themesKey");if("default"===t||!t)return"blue"}var C=localStorage.getItem("languageCode")||"zh-CHS",b=(x.decorators=[{type:a.Injectable,args:[{providedIn:"root"}]}],x.ngInjectableDef=a.defineInjectable({factory:function(){return new x},token:x,providedIn:"root"}),x);function x(){}var N=function(t,e){return(N=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function w(t,e){function n(){this.constructor=t}N(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var U=function(){return(U=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},F=(j.prototype.getSize=function(t){return"rows"===t?this._getAxisSize("rows")||this._getAxisSize("minRows")||4:"cols"===t?this._getAxisSize("cols")||this._getAxisSize("minCols")||5:this._getAxisSize(t)},j);function j(){}var M,Y=(w(V,M=F),V.prototype._getAxisSize=function(t){return this.size&&this.size[t]||this.widget.layout&&this.widget.layout.grid&&this.widget.layout.grid[t]},V);function V(t){var e=M.call(this)||this;return e.widgetId=t,e.name="未命名部件",e.i18nName={},e.propValues={},e.dataOption={},e.dps=null,e}var k,W={rows:4,cols:5,minCols:2,minRows:2,maxCols:24,maxRows:24},H=(w(J,k=F),J.prototype._getAxisSize=function(t){return W[t]},J);function J(){var t=null!==k&&k.apply(this,arguments)||this;return t.isBA=!0,t}var q={GET_BY_ID:"metaportlet/",GET_USER_ALL:"metaportlet/all",CREATE:"metaportlet/upload",EDIT:"metaportlet/editor",DELETE:"metaportlet/",GET_PORTLET:"portlet/findByMetaId"};S(q);var z=location.origin+"/runtime/web/metaportlet";function Q(t){return t.href=z+t.href,t.logoImgUrl=z+t.logoImgUrl,t.previewImgUrl=z+t.previewImgUrl,t.baseUrl=z+t.baseUrl,t.layout=t.layout&&JSON.parse(G(t.layout)),t}var K=(X.prototype.getWidgets=function(){return this.http.get(q.GET_USER_ALL).pipe(p.map(function(t){return t.map(Q)}))},X.prototype.getWidgetById=function(t){return this.http.get(q.GET_BY_ID+t).pipe(p.map(function(t){return Q(t)}))},X.prototype.uploadWidget=function(t){return this.util.uploadFile(q.CREATE,t)},X.prototype.editorWidget=function(t){return this.util.uploadFile(q.EDIT,t)},X.prototype.deleteWidget=function(t){return this.http["delete"](q.DELETE+t,{})},X.prototype.findPortletByMeta=function(t){return this.http.get(q.GET_PORTLET,{params:{id:t}})},X.decorators=[{type:a.Injectable,args:[{providedIn:"root"}]}],X.ctorParameters=function(){return[{type:i.HttpClient},{type:s}]},X.ngInjectableDef=a.defineInjectable({factory:function(){return new X(a.inject(i.HttpClient),a.inject(s))},token:X,providedIn:"root"}),X);function X(t,e){this.http=t,this.util=e}var Z={GET_BY_ID:"portlet/",GET_USER_ALL:"portlet/all",SAVE:"portlet/",GET_BY_MODULE_ID:"portlet/findByModuleId",DELETE_BY_ID:"portlet/",GET_PAGE:"page/findByPortletId"},$={SAVE:"portletop/save?portletId=",GET_BY_PORTLET_ID:"portletop/getallpagerole?portletId="};S(Z),S($);var tt,et,nt=(rt.prototype.getPageByPortletId=function(t){return this.http.get(Z.GET_PAGE,{params:{portletId:t}})},rt.prototype.getPortlets=function(){return this.http.get(Z.GET_USER_ALL).pipe(p.map(function(t){return t.map(ot)}))},rt.prototype.getPortletsByModuleId=function(t){return this.http.get(Z.GET_BY_MODULE_ID,{params:t?{moduleId:t}:null}).pipe(p.map(function(t){return t.map(ot)}))},rt.prototype.getPortletById=function(t){return this.http.get(Z.GET_BY_ID+t).pipe(p.map(ot))},rt.prototype.savePortlet=function(t){var e=function n(t){var e=U({},t);return delete e.widget,e.propValues=JSON.stringify(t.propValues),e}(t);return t.id?this.http.post(Z.SAVE,e):this.http.put(Z.SAVE,e)},rt.prototype.getPortletOps=function(t){return this.http.get($.GET_BY_PORTLET_ID+t)},rt.prototype.savePortletOps=function(t,e){return this.http.post($.SAVE+t,e)},rt.prototype.deletePortletById=function(t){return this.http["delete"](Z.DELETE_BY_ID+t)},rt.decorators=[{type:a.Injectable,args:[{providedIn:"root"}]}],rt.ctorParameters=function(){return[{type:i.HttpClient}]},rt.ngInjectableDef=a.defineInjectable({factory:function(){return new rt(a.inject(i.HttpClient))},token:rt,providedIn:"root"}),rt);function rt(t){this.http=t}function ot(t){return t.widget=Q(t.widget),t.propValues&&(t.propValues=JSON.parse(t.propValues)),Object.assign(new Y(null),t)}try{tt=n.enc.Utf8.parse("1234567890123456"),et={iv:n.enc.Utf8.parse("0000000000000000"),mode:n.mode.CBC,padding:n.pad.Pkcs7}}catch(ee){}function it(t){var e=n.enc.Utf8.parse(t);return n.AES.encrypt(e,tt,et).toString()}function at(t){return n.AES.decrypt(t,tt,et).toString(n.enc.Utf8)}function pt(t){this.providerName=t,this.i18nName={},this.config={}}var st=(ut.ToDto=function(t){var e=t.i18nName,n=t.type,r=t.config;return{id:t.id,i18nName:e,config:r,type:o.camelCase(n),value:t["default"]}},ut.FromDto=function(t){return{id:t.id,i18nName:t.i18nName,type:o.constantCase(t.type),config:t.config,datasetId:t.datasetId,name:t.name,"default":t.value}},ut);function ut(){this.type="QUERY_PARAM",this["default"]=null}function ct(t,e,n,r){void 0===r&&(r=!0),this.name=t,this.value=e,this.sortNo=n,this.isExpression=r}var lt=(ft.create=function(){return new ft},ft.toDto=function(t){var e=t.id,n=t.name,r=t.datasrcId,o=t.datasrcName,i=t.cols,a=t.creationTime,p=t.config,s=t.dataParams;return{id:e,name:n,creationTime:a,i18nName:t.i18nName,datasourceId:r,datasourceName:o,dimensions:i.dimensions,config:it(JSON.stringify(p)),dataParamDto:s.map(st.ToDto)}},ft.fromDto=function(t){var e=t.id,n=t.name,r=t.datasourceId,o=t.datasourceName,i=t.dimensions,a=t.creationTime,p=(t.method,t.parameters,t.i18nName),s=t.config,u=t.dataParamDto,c=null;try{c=JSON.parse(at(s))}catch(ee){}return{id:e,name:n,creationTime:a,i18nName:p,datasrcId:r,datasrcName:o,cols:{dimensions:i},config:c=c||{},dataParams:u?u.map(st.FromDto):[]}},ft);function ft(){this.config={},this.cols={dimensions:[],measures:[]},this.dataParams=[]}function gt(){}var dt,Et={Count:"Count",Sum:"Sum",Max:"Max",Min:"Min",Avg:"Avg",Expression:"Expression"},mt=(w(ht,dt=gt),ht);function ht(t){var e=dt.call(this)||this;return e.expression=t,e.computeType=Et.Expression,e}var yt=(Tt.toDto=function(t){return{id:t.id,dataSetId:t.datasetId,resource:t.resource,resourceId:t.resourceId,aggregationType:t.aggType,columnConfigs:t.cols,rowConfigs:t.rows,filterConfigs:t.filters,computedExpressionConfigs:t.computedCols}},Tt.fromDto=function(t){return{id:t.id,datasetId:t.dataSetId,datasetName:t.dataSetName,resource:t.resource,resourceId:t.resourceId,aggType:t.aggregationType,cols:t.columnConfigs,rows:t.rowConfigs,filters:t.filterConfigs,computedCols:t.computedExpressionConfigs}},Tt);function Tt(){this.cols=[],this.rows=[],this.filters=[],this.computedCols=[]}var _t=(It.toDto=function(t){return{dataParamId:t.dpId,value:t.value}},It);function It(){}var At=function ne(){this.aggFn=4},vt=(Dt.toDto=function(t){if(t)return{dimensions:t.dimensions,indicators:t.indicators.map(function(t){return{type:t.aggFn,name:t.dimName}})}},Dt);function Dt(){this.dimensions=[],this.indicators=[new At]}var St={GET_BY_ID:P+"/DataSetService/find/",CREATE:P+"/DataSetService/create",IMPORT_QO:P+"/DataSetService/importQO",DELETE:P+"/DataSetService/delete",GET_ALL:P+"/DataSetService/findAll",GET_RAW_DIMS_BY_DATASET:P+"/DataResultSetService/tryGetDimensions",GET_RAW_DATA_BY_DATASET:P+"/DataResultSetService/getResultSet",UPDATE:P+"/DataSetService/update"},Pt={SAVE:P+"/DataSetService/saveAggConfig",GET_BY_RESOURCE:P+"/DataSetService/findAggConfigByResource"},Gt={GET_BY_AGG_ID:P+"/DataResultSetService/getAggResultSet/{aggId}",GET_BY_AGG:P+"/DataResultSetService/getAggResultSetForTest",GET_BY_DATASET:P+"/DataResultSetService/getResultSet",GET_BY_RESOURCE:P+"/DataResultSetService/getResultSetByResource"};S(St),S(Pt),S(Gt);var Lt=(Rt.prototype.getRawDimsByDataset=function(t){return this.http.post(St.GET_RAW_DIMS_BY_DATASET,t)},Rt.prototype.getRawColsNDataByDataset=function(t){return this.http.post(St.GET_RAW_DATA_BY_DATASET,t)},Rt.prototype.getDatasets=function(){return this.http.get(St.GET_ALL).pipe(p.map(function(t){return t.map(lt.fromDto)}))},Rt.prototype.getDatasetById=function(t){return this.http.get(St.GET_BY_ID+t).pipe(p.map(lt.fromDto))},Rt.prototype.saveDataset=function(t){return this.http.post(t.id?St.UPDATE:St.CREATE,t).pipe(p.map(lt.fromDto))},Rt.prototype.importQO=function(t){return this.http.post(St.IMPORT_QO,t)},Rt.prototype.deleteDataset=function(t){return this.http.post(St.DELETE,null,{params:{id:t}})},Rt.prototype.getAggByPortletId=function(t){return this.http.get(Pt.GET_BY_RESOURCE,{params:{resource:"portlet",resourceId:t}}).pipe(p.map(yt.fromDto))},Rt.prototype.saveAgg=function(t){return this.http.post(Pt.SAVE,yt.toDto(t))},Rt.prototype.getAggResultByAgg=function(t,e,n){void 0===e&&(e=[]);var r={aggDataDto:yt.toDto(t),aggregation:vt.toDto(n)};return e&&0<e.length&&(r.dataParam=e.map(_t.toDto)),this.http.post(Gt.GET_BY_AGG,r)},Rt.prototype.getResultByPortletId=function(t,e,n,r){void 0===e&&(e=[]),void 0===n&&(n='""');var o={filter:n,aggregation:vt.toDto(r)};return e&&0<e.length&&(o.dataParam=e.map(_t.toDto)),this.http.post(Gt.GET_BY_RESOURCE,o,{headers:new i.HttpHeaders({"Content-Type":"application/json"}),params:{resourceType:"portlet",resourceId:t}})},Rt.decorators=[{type:a.Injectable,args:[{providedIn:"root"}]}],Rt.ctorParameters=function(){return[{type:i.HttpClient}]},Rt.ngInjectableDef=a.defineInjectable({factory:function(){return new Rt(a.inject(i.HttpClient))},token:Rt,providedIn:"root"}),Rt);function Rt(t){this.http=t}var Ot={GET_BY_ID:P+"/DatasourceService/find/",CREATE:P+"/DatasourceService/create",DELETE:P+"/DatasourceService/delete",GET_ALL:P+"/DatasourceService/findAll",UPDATE:P+"/DatasourceService/update",TRY:P+"/DatasourceService/try",GET_PARAMS_BY_PROVIDER_NAME:P+"/DataService/getDatasourceParameters/",GET_ALL_PROVIDERS:P+"/DataService/getProvicerNames"};S(Ot);var Bt=(Ct.prototype.getDatasrcList=function(){return this.http.post(Ot.GET_ALL,null)},Ct.prototype.getDatasrcById=function(t){return this.http.get(Ot.GET_BY_ID+t)},Ct.prototype.saveDatasrc=function(t){return t.id?this.http.post(Ot.UPDATE,t):this.http.post(Ot.CREATE,t)},Ct.prototype.deleteDatasrc=function(t){return this.http.post(Ot.DELETE,null,{params:{id:t}})},Ct.prototype.tryDatasrc=function(t){return this.http.post(Ot.TRY,t,{responseType:"text"})},Ct.prototype.getProviders=function(){return this.http.get(Ot.GET_ALL_PROVIDERS)},Ct.prototype.getParamsByProviderName=function(t){return this.http.get(Ot.GET_PARAMS_BY_PROVIDER_NAME+t)},Ct.decorators=[{type:a.Injectable,args:[{providedIn:"root"}]}],Ct.ctorParameters=function(){return[{type:i.HttpClient}]},Ct.ngInjectableDef=a.defineInjectable({factory:function(){return new Ct(a.inject(i.HttpClient))},token:Ct,providedIn:"root"}),Ct);function Ct(t){this.http=t}function bt(){}var xt=function re(t,e){this.code=t,this.name=e},Nt={bo:{GET_ALL:"/api/dev/main/v1.0/business-objects"},funcOperations:{GET_BY_BO_ID:"/api/runtime/sys/v1.0/funcOperations/business/"},roleGroup:{GET_ALL:"/api/runtime/sys/v1.0/rolegroups/all"},role:{GET:"/api/runtime/sys/v1.0/roles"},userInfo:{GET:"/api/runtime/sys/v1.0/userinfos?infoType=user"},func:{GET_ALL_WITH_INVOKE:"/api/runtime/sys/v1.0/functions/allFuncs",GET_ALL:"/api/runtime/sys/v1.0/functions/funcGroups?funcType=4"},langs:{GET_ALL:"/api/runtime/sys/v1.0/loginInfo?infoType=supportedLanguage"},qoDataset:{GET_ECP_BIZ_TREE:"/api/gsp/bcc/v1.0/ecpbiztree/extension/query",GET_DETAIL_BY_ID:"/api/gsp/bcc/v1.0/datasetdetail_frm/extension/retrieve/",GET_DETAIL_QUERY:"/api/gsp/bcc/v1.0/datasetdetail_frm/extension/query"},ba:{GET_ALL_PORTLETS:"/api/ba/bap/v1.0/widget/getCloudWidgetList?allWidgetList=true"}},wt=(Ut.prototype.getBOTree=function(e){return void 0===e&&(e=Infinity),this.http.get(Nt.bo.GET_ALL).pipe(p.map(function(t){return L(t,{parentIdKey:"parentID",ifIgnore:function(t){return t.layer>e}})}))},Ut.prototype.getOpsByBOId=function(t){return this.http.get(Nt.funcOperations.GET_BY_BO_ID+t)},Ut.prototype.getRoleGroupTree=function(){return this.http.get(Nt.roleGroup.GET_ALL).pipe(p.map(function(t){return L(t,{})}))},Ut.prototype.getRolesByRoleGroupId=function(t){return this.http.get(Nt.role.GET,{params:{param:JSON.stringify({groupId:t})}}).pipe(p.map(function(t){return t.data}))},Ut.prototype.getAllRoles=function(){return this.http.get(Nt.role.GET).pipe(p.map(function(t){return t.data}))},Ut.prototype.getFuncTree12=function(){var e=this;return this.funcTree12?r.of(this.funcTree12):this.getAllFuncs().pipe(p.map(function(t){return t=t.filter(function(t){return parseInt(t.layer)<3}),e.funcTree12=L(t,{rootParentIdValue:"0",parentIdKey:"parentId"}),e.funcTree12}))},Ut.prototype.getQoDatasetDetailsByModuleId=function(t){return this.http.put(Nt.qoDataset.GET_DETAIL_QUERY,{},{params:{entityFilter:JSON.stringify({FilterConditions:[{FilterField:"moduleID",Compare:0,Value:t,Relation:0}],SortConditions:[],IsUsePagination:!0,Pagination:{PageIndex:1,PageSize:20,PageCount:0,TotalCount:0}})}}).pipe(p.map(function(t){return t.returnValue.result}))},Ut.prototype.getQoDatasetDetailById=function(t){return this.http.put(Nt.qoDataset.GET_DETAIL_BY_ID+t,{}).pipe(p.map(function(t){return t.returnValue}))},Ut.prototype.getUserInfo=function(t){return void 0===t&&(t=!1),t&&(this.userInfoPromise=null),this.userInfoPromise||(this.userInfoPromise=this.http.get(Nt.userInfo.GET).toPromise()),r.from(this.userInfoPromise)},Ut.prototype.getUserAvatar=function(t){return void 0===t&&(t=!1),this.getUserInfo(t).pipe(p.map(function(t){return t&&t.userSetting&&t.userSetting.imgblob?t.userSetting.imgblob:null}))},Ut.prototype.getAllFuncs=function(){return this.http.get(Nt.func.GET_ALL)},Ut.prototype.getBAPortletsAll=function(){return this.http.get(Nt.ba.GET_ALL_PORTLETS).pipe(p.map(function(t){return t.data.map(function(t){return Object.assign(new H,t)})}))},Ut.prototype.getLangs=function(){return this.getLangsPromise||(this.getLangsPromise=this.http.get(Nt.langs.GET_ALL).pipe(p.map(function(t){return t.map(function(t){return new xt(t.code,t.name)})})).toPromise()),this.getLangsPromise},Ut.decorators=[{type:a.Injectable,args:[{providedIn:"root"}]}],Ut.ctorParameters=function(){return[{type:i.HttpClient}]},Ut.ngInjectableDef=a.defineInjectable({factory:function(){return new Ut(a.inject(i.HttpClient))},token:Ut,providedIn:"root"}),Ut);function Ut(t){this.http=t}var Ft,jt={pageInfo:{title:"name"},portlet:{},widget:{}},Mt=(Ft={},Object.keys(jt).forEach(function(e){Ft[e]={},Object.keys(jt[e]).forEach(function(t){Ft[e][jt[e][t]]=t})}),Ft);function Yt(e,n,t){void 0===t&&(t=!1);var r=t?Mt:jt,o={};return Object.keys(e).forEach(function(t){r[n].hasOwnProperty(t)?o[r[n][t]]=e[t]:o[t]=e[t]}),o}var Vt={GET_BY_ID_MANAGE:"page/",GET_BY_ID_PERSONAL:"page/pageofuser?pageId=",GET_ALL_MANAGE:"page/all/mg",GET_ALL_PERSONAL:"page/pagelistofuser",GET_BY_ROLE:"pagerole/pagesbyrole?roleId=",GET_PAGES_WITH_ROLE:"pagerole/all",SET_TO_ROLE_DEFAULT:"pagerole/settingrolepageenable",DELETE:"page/",DELETE_MANAGE:"page/delete/mg",ADD:"page",ADD_MANAGE:"page/add/mg",UPDATE:"page",UPDATE_MANAGE:"page/update/mg",COPY:"page/copy",COPY_MANAGE:"page/copy/mg",RESET_PAGE:"page/resetsyspage?pageId=",SELECT_PAGE:"page/changepageselect?pageId="},kt={SAVE:"pagerole/save?pageId=",GET_BY_PAGE_ID:"pagerole/getallpagerole?pageId="};S(Vt),S(kt);var Wt=(Ht.prototype.getPagesManage=function(){return this.http.get(Vt.GET_ALL_MANAGE).pipe(p.map(function(t){return t.map(Jt)}))},Ht.prototype.getPagesUser=function(){return this.http.get(Vt.GET_ALL_PERSONAL)},Ht.prototype.getPagesByRole=function(t){return this.http.get(Vt.GET_BY_ROLE+t)},Ht.prototype.getPagesWithRole=function(){return this.http.get(Vt.GET_PAGES_WITH_ROLE)},Ht.prototype.setRoleDefaultPage=function(t,e){return this.http.post(Vt.SET_TO_ROLE_DEFAULT,null,{params:{pageId:e,roleId:t}}).pipe(this.success())},Ht.prototype.getPageInfoById=function(t,e){return void 0===e&&(e=!1),this.http.get((e?Vt.GET_BY_ID_MANAGE:Vt.GET_BY_ID_PERSONAL)+t).pipe(p.map(function(t){return Jt(t)}))},Ht.prototype.savePageInfo=function(t,e){return void 0===e&&(e=!1),t.id?this.http.post(e?Vt.UPDATE_MANAGE:Vt.UPDATE,qt(t)).pipe(this.success()):this.http.put(e?Vt.ADD_MANAGE:Vt.ADD,qt(t)).pipe(this.success())},Ht.prototype.deletePageInfo=function(t){return this.http["delete"](Vt.DELETE+t,{responseType:"text"}).pipe(this.success())},Ht.prototype.deletePageInfoManage=function(t){return this.http.post(Vt.DELETE_MANAGE,t).pipe(this.success())},Ht.prototype.copyPageInfo=function(t,e){return void 0===e&&(e=!1),this.http.post(e?Vt.COPY_MANAGE:Vt.COPY,t,{responseType:"text"})},Ht.prototype.resetPage=function(t){return this.http.post(Vt.RESET_PAGE+t,null)},Ht.prototype.selectPage=function(t){return this.http.post(Vt.SELECT_PAGE+t,null)},Ht.prototype.success=function(){return p.tap(function(){})},Ht.prototype.savePageRoles=function(t,e){return this.http.post(kt.SAVE+t,e)},Ht.prototype.getPageRoles=function(t){return this.http.get(kt.GET_BY_PAGE_ID+t)},Ht.decorators=[{type:a.Injectable,args:[{providedIn:"root"}]}],Ht.ctorParameters=function(){return[{type:i.HttpClient}]},Ht.ngInjectableDef=a.defineInjectable({factory:function(){return new Ht(a.inject(i.HttpClient))},token:Ht,providedIn:"root"}),Ht);function Ht(t){this.http=t}function Jt(t){var e=Yt(t,"pageInfo");return e.config=JSON.parse(e.config),e}function qt(t){var e=Yt(t,"pageInfo",!0);return e.config.layout=e.config.layout.map(function(t){return{instanceId:t.instanceId,isBAPortlet:t.isBAPortlet,gridsterItem:t.gridsterItem,portletId:t.portletId,link:t.link}}),e.config=JSON.stringify(e.config),e}function zt(t){this.id=t,this.name="",this.i18nName={},this.config=new Qt}var Qt=function oe(){this.type="gridster",this.layout=[]},Kt={AOT:0,DEV:1,JIT:2};Kt[Kt.AOT]="AOT",Kt[Kt.DEV]="DEV",Kt[Kt.JIT]="JIT";var Xt=(Zt.SwapByIndex=function(t,e,n){var r=t[e];t[e]=t[n],t[n]=r},Zt.Add=function(t,e){t.push(e)},Zt.Up=function(t,e){var n=t.indexOf(e);n<1||Zt.SwapByIndex(t,n,n-1)},Zt.Down=function(t,e){var n=t.indexOf(e);n>t.length-2||Zt.SwapByIndex(t,n,n+1)},Zt.Remove=function(t,e){var n=t.indexOf(e);-1!==n&&t.splice(n,1)},Zt.Unique=function(t){return Array.from(new Set(t))},Zt);function Zt(){}var $t=(te.SetColors=function(t,e){this.SetPure(t),this.SetGradient(e)},te.SetPure=function(t){t&&0<t.length&&(this.pure=t)},te.SetGradient=function(t){t&&0<t.length&&(this.gradient=t)},te.pure=["#F5B805","#FF9300","#EC7658","#897AFB","#5E6EEB","#4D97FF","#01BBC7","#3DDB88","#A4EA4D","#93A3D3","#000000","#ffffff"],te.gradient=["#FBDD0C,#F5B805","#FFB046,#FF9300","#FF9579,#EC7658","#8B99FF,#897AFB","#7F8DFF,#5E6EEB","#79B1FF,#4D97FF","#00DBE9,#01BBC7","#46FA9B,#3DDB88","#C1FF73,#A4EA4D","#B5C7FD,#93A3D3"],te);function te(){}t.UtilService=s,t.UtilComponent=c,t.UtilModule=_,t.backendString2Json=G,t.list2Tree=L,t.uuidv4=function ie(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0;return("x"==t?e:3&e|8).toString(16)})},t.appendScript=function ae(t){var e=document.getElementsByTagName("body")[0],n=document.createElement("script");n.src=t,e.appendChild(n)},t.loadCss=R,t.deepClone=O,t.setArrayLengthTo=function pe(t,e,n){t.length=e;for(var r=0;r<t.length;r++)t[r]||(t[r]=O(n))},t.getCurTheme=B,t.loadCommonStyleNTheme=function se(){var t=B();R(v+"xc-antd-"+t+".css"),R(v+"plain.css"),R(v+"xc-common.css"),R(v+"xc-common-"+t+".css")},t.objectLiteralEqual=function ue(t,e){return JSON.stringify(t)===JSON.stringify(e)},t.curLang=C,t.addBaseUrl=S,t.LS_LOAD_LOCAL_ASSET=A,t.IGIX_HOME_PATH=v,t.BASE_URL=D,t.DATA_PREFIX=P,t.FILTERS_WIDGET_NAME="filters",t.FILTERS_WIDGET_FILTERS_PROP_NAME="filters",t.FILTERS_WIDGET_PROP_NAME="change",t.DESIGNER_CONFIG={PAGE_DESIGNER_ID:"Epp-pagedesigner",PAGE_RUNTIME_ID:"Epp-pageruntime"},t.dimensionTypeConfig={text:{list:["STRING","TEXT"],color:"#2196F3",iconName:"texture"},number:{list:["SHORT","LONG","FLOAT","DOUBLE","DECIMAL","INTEGER","INTETER"],color:"#e91e63",iconName:"device_hub"},date:{list:["DATETIME"],color:"#ff9800",iconName:"access_time"},"byte":{list:["BYTE","BYTES"],color:"#4caf50",iconName:"texture"},"boolean":{list:["BOOLEAN","UNKNOWN"],color:"#3f51b5",iconName:"invert_colors"},unknown:{list:["UNKNOWN"],color:"#3f51b5",iconName:"help"}},t.IgixUtilService=b,t.onRtfTabChange=h,t.RtfUtilService=g,t.portletUrls=Z,t.portletOps=$,t.PortletRepo=nt,t.convertWidget=Q,t.widgetUrls=q,t.WidgetRepo=K,t.datasetUrls=St,t.aggUrls=Pt,t.dataResultSetUrls=Gt,t.DatasetRepo=Lt,t.datasrcUrls=Ot,t.DatasrcRepo=Bt,t.igixUrls=Nt,t.IgixRepo=wt,t.convertPageInfo=Jt,t.convertPageInfoInverse=qt,t.pageInfoUrls=Vt,t.pageRoles=kt,t.PageRepo=Wt,t.Lang=xt,t.I18nValue=bt,t.Datasrc=pt,t.DataParam=st,t.DatasetParameter=ct,t.Dataset=lt,t.Dimension=gt,t.ComputedType=Et,t.AggType={Table:"Table",CroosTable:"CroosTable"},t.ComputedCol=mt,t.Agg=yt,t.AggregationResultSetType={Table:"Table",CroosTable:"CroosTable"},t.DpValue=_t,t.Indicator=At,t.RuntimeAggOption=vt,t.FuncType={Products:"1",Module:"2",AppGroups:"3",App:"4"},t.PageInfo=zt,t.PageConfig=Qt,t.DEFAULT_PORTLET_COLS=5,t.DEFAULT_PORTLET_ROWS=4,t.Portlet=F,t.EppPortlet=Y,t.BAPortlet=H,t.WidgetContainerMode=Kt,t.encrypt=it,t.decrypt=at,t.mapEntityFeilds=Yt,t.TransPipe=y,t.ArrUtil=Xt,t.PlThemeColors=$t,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=gspwidget-util.umd.min.js.map