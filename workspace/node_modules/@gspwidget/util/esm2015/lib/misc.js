/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { IGIX_HOME_PATH } from "./const";
/**
 * 形如 {key={key=value, key=value}, key={}}
 * 转为 JSON 标准格式
 * @param {?} original
 * @return {?}
 */
export function backendString2Json(original) {
    /** @type {?} */
    let result = original.replace(/\s/g, '') // 去空格
    ;
    result = result.replace(/=/g, ':'); // = 变 :
    result = result.replace(/:/g, '\":'); // : 前加 "
    result = result.replace(/,/g, ',\"'); // , 后加 "
    result = result.replace(/{(?=\w)/g, '{\"'); // 后接字母的 { 后加 "
    return result;
}
/**
 * 用列表构造一棵树。
 * @param {?} list
 * @param {?} __1
 * @return {?}
 */
export function list2Tree(list, { parentIdKey = 'parentId', rootParentIdValue = null, idKey = 'id', 
// leafSelectableOnly = true
// ignoreLeaf = false
ifIgnore = (/**
 * @param {?} node
 * @return {?}
 */
(node) => false), 
// isLeaf = (node) => false,
beforeProcess = null, afterProcess = null, }) {
    /**
     * @param {?} nodes
     * @param {?=} layer
     * @return {?}
     */
    function recurseAddChildren(nodes, layer = 0) {
        nodes.forEach((/**
         * @param {?} node
         * @return {?}
         */
        node => {
            if (beforeProcess)
                beforeProcess(node);
            if (!node.layer)
                node.layer = layer;
            node.value = node.key = node[idKey];
            node.label = node.title = node.name;
            /** @type {?} */
            const children = list.filter((/**
             * @param {?} item
             * @return {?}
             */
            item => item[parentIdKey] === node[idKey] && !ifIgnore(item)));
            if (children.length > 0) {
                node.children = children;
                recurseAddChildren(node.children, layer + 1);
            }
            else {
                node.isLeaf = true;
            }
            if (afterProcess)
                afterProcess(node);
        }));
    }
    /** @type {?} */
    const tree = list.filter((/**
     * @param {?} item
     * @return {?}
     */
    item => !item[parentIdKey] || item[parentIdKey] === rootParentIdValue));
    recurseAddChildren(tree);
    return tree;
}
/**
 * @return {?}
 */
export function uuidv4() {
    return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, (/**
     * @param {?} c
     * @return {?}
     */
    c => {
        /** @type {?} */
        var r = Math.random() * 16 | 0;
        /** @type {?} */
        var v = c == 'x' ? r : (r & 0x3 | 0x8);
        return v.toString(16);
    }));
}
/**
 * @param {?} src
 * @return {?}
 */
export function appendScript(src) {
    /** @type {?} */
    const body = document.getElementsByTagName('body')[0];
    /** @type {?} */
    const script = document.createElement('script');
    script.src = src;
    body.appendChild(script);
}
/**
 * 加载 css
 * 1. 防重复：如果相同 href 的 link 标签已存在，不会重新加载
 * 2. 同 id 替换：可以替换同 id 的 link 标签
 * @param {?} href
 * @param {?=} eleId
 * @param {?=} allowRepeat
 * @return {?}
 */
export function loadCss(href, eleId, allowRepeat = false) {
    // 防重复
    if (!allowRepeat
        && Array.from(document.querySelectorAll('link')).some((/**
         * @param {?} link
         * @return {?}
         */
        link => link.href === href)))
        return;
    // 同 id 替换
    if (eleId) {
        /** @type {?} */
        const themeLink = (/** @type {?} */ (document.getElementById(eleId)));
        if (themeLink) {
            themeLink.href = href;
            return;
        }
    }
    /** @type {?} */
    const head = document.getElementsByTagName('head')[0];
    /** @type {?} */
    const style = document.createElement('link');
    if (eleId)
        style.id = eleId;
    style.type = 'text/css';
    style.rel = 'stylesheet';
    style.href = href;
    head.appendChild(style);
}
/**
 * @param {?} obj
 * @return {?}
 */
export function deepClone(obj) {
    return JSON.parse(JSON.stringify(obj));
}
/**
 * 直接改变数组
 * @param {?} arr
 * @param {?} targetLength
 * @param {?} fillItem
 * @return {?}
 */
export function setArrayLengthTo(arr, targetLength, fillItem) {
    arr.length = targetLength;
    for (let i = 0; i < arr.length; i++) {
        if (!arr[i])
            arr[i] = deepClone(fillItem);
    }
}
/**
 * @return {?}
 */
export function getCurTheme() {
    /** @type {?} */
    const rawThemeKey = localStorage.getItem('gsp_rtf_themesKey')
    // 可能是 default，归一化成 blue
    ;
    // 可能是 default，归一化成 blue
    if (rawThemeKey === 'default' || !rawThemeKey)
        return 'blue';
}
/**
 * 加载
 * 1. 公共 style
 * 2. 公共主题 style
 * @return {?}
 */
export function loadCommonStyleNTheme() {
    /** @type {?} */
    const curTheme = getCurTheme()
    // antd 优先级最低
    ;
    // antd 优先级最低
    loadCss(`${IGIX_HOME_PATH}xc-antd-${curTheme}.css`);
    loadCss(`${IGIX_HOME_PATH}plain.css`);
    loadCss(`${IGIX_HOME_PATH}xc-common.css`);
    loadCss(`${IGIX_HOME_PATH}xc-common-${curTheme}.css`);
}
/**
 * 两个 obj 是否结构相同、里面的所有字面值相等，及时内部引用
 * @param {?} obj1
 * @param {?} obj2
 * @return {?}
 */
export function objectLiteralEqual(obj1, obj2) {
    return JSON.stringify(obj1) === JSON.stringify(obj2);
}
/** @type {?} */
export const curLang = localStorage.getItem('languageCode') || 'zh-CHS';
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWlzYy5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0Bnc3B3aWRnZXQvdXRpbC8iLCJzb3VyY2VzIjpbImxpYi9taXNjLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7QUFBQSxPQUFPLEVBQUUsY0FBYyxFQUFFLE1BQU0sU0FBUyxDQUFBOzs7Ozs7O0FBTXhDLE1BQU0sVUFBVSxrQkFBa0IsQ0FBRSxRQUFnQjs7UUFDOUMsTUFBTSxHQUFHLFFBQVEsQ0FBQyxPQUFPLENBQUMsS0FBSyxFQUFFLEVBQUUsQ0FBQyxDQUFJLE1BQU07O0lBQ2xELE1BQU0sR0FBRyxNQUFNLENBQUMsT0FBTyxDQUFDLElBQUksRUFBRSxHQUFHLENBQUMsQ0FBQSxDQUFJLFFBQVE7SUFDOUMsTUFBTSxHQUFHLE1BQU0sQ0FBQyxPQUFPLENBQUMsSUFBSSxFQUFFLEtBQUssQ0FBQyxDQUFBLENBQUUsU0FBUztJQUMvQyxNQUFNLEdBQUcsTUFBTSxDQUFDLE9BQU8sQ0FBQyxJQUFJLEVBQUUsS0FBSyxDQUFDLENBQUEsQ0FBRSxTQUFTO0lBQy9DLE1BQU0sR0FBRyxNQUFNLENBQUMsT0FBTyxDQUFDLFVBQVUsRUFBRSxLQUFLLENBQUMsQ0FBQSxDQUFFLGVBQWU7SUFDM0QsT0FBTyxNQUFNLENBQUE7QUFDZixDQUFDOzs7Ozs7O0FBSUQsTUFBTSxVQUFVLFNBQVMsQ0FBRSxJQUFXLEVBQUUsRUFDdEMsV0FBVyxHQUFHLFVBQVUsRUFDeEIsaUJBQWlCLEdBQUcsSUFBSSxFQUN4QixLQUFLLEdBQUcsSUFBSTtBQUNaLDRCQUE0QjtBQUM1QixxQkFBcUI7QUFDckIsUUFBUTs7OztBQUFHLENBQUMsSUFBSSxFQUFFLEVBQUUsQ0FBQyxLQUFLLENBQUE7QUFDMUIsNEJBQTRCO0FBQzVCLGFBQWEsR0FBRyxJQUFJLEVBQ3BCLFlBQVksR0FBRyxJQUFJLEdBQ3BCOzs7Ozs7SUFDQyxTQUFTLGtCQUFrQixDQUFFLEtBQVksRUFBRSxLQUFLLEdBQUcsQ0FBQztRQUNsRCxLQUFLLENBQUMsT0FB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QUFFLE9BQU8sTUFBTSxDQUFBO0FBQzlELENBQUM7Ozs7Ozs7QUFNRCxNQUFNLFVBQVUscUJBQXFCOztVQUM3QixRQUFRLEdBQUcsV0FBVyxFQUFFO0lBQzlCLGFBQWE7O0lBQWIsYUFBYTtJQUNiLE9BQU8sQ0FBQyxHQUFHLGNBQWMsV0FBVyxRQUFRLE1BQU0sQ0FBQyxDQUFBO0lBQ25ELE9BQU8sQ0FBQyxHQUFHLGNBQWMsV0FBVyxDQUFDLENBQUE7SUFDckMsT0FBTyxDQUFDLEdBQUcsY0FBYyxlQUFlLENBQUMsQ0FBQTtJQUN6QyxPQUFPLENBQUMsR0FBRyxjQUFjLGFBQWEsUUFBUSxNQUFNLENBQUMsQ0FBQTtBQUN2RCxDQUFDOzs7Ozs7O0FBSUQsTUFBTSxVQUFVLGtCQUFrQixDQUFFLElBQUksRUFBRSxJQUFJO0lBQzVDLE9BQU8sSUFBSSxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsS0FBSyxJQUFJLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxDQUFBO0FBQ3RELENBQUM7O0FBQ0QsTUFBTSxPQUFPLE9BQU8sR0FBRyxZQUFZLENBQUMsT0FBTyxDQUFDLGNBQWMsQ0FBQyxJQUFJLFFBQVEiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBJR0lYX0hPTUVfUEFUSCB9IGZyb20gXCIuL2NvbnN0XCJcblxuLyoqXG4gKiDlvaLlpoIge2tleT17a2V5PXZhbHVlLCBrZXk9dmFsdWV9LCBrZXk9e319XG4gKiDovazkuLogSlNPTiDmoIflh4bmoLzlvI9cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGJhY2tlbmRTdHJpbmcySnNvbiAob3JpZ2luYWw6IHN0cmluZykge1xuICBsZXQgcmVzdWx0ID0gb3JpZ2luYWwucmVwbGFjZSgvXFxzL2csICcnKSAgICAvLyDljrvnqbrmoLxcbiAgcmVzdWx0ID0gcmVzdWx0LnJlcGxhY2UoLz0vZywgJzonKSAgICAvLyA9IOWPmCA6XG4gIHJlc3VsdCA9IHJlc3VsdC5yZXBsYWNlKC86L2csICdcXFwiOicpICAvLyA6IOWJjeWKoCBcIlxuICByZXN1bHQgPSByZXN1bHQucmVwbGFjZSgvLC9nLCAnLFxcXCInKSAgLy8gLCDlkI7liqAgXCJcbiAgcmVzdWx0ID0gcmVzdWx0LnJlcGxhY2UoL3soPz1cXHcpL2csICd7XFxcIicpICAvLyDlkI7mjqXlrZfmr43nmoQgeyDlkI7liqAgXCJcbiAgcmV0dXJuIHJlc3VsdFxufVxuLyoqXG4gKiDnlKjliJfooajmnoTpgKDkuIDmo7XmoJHjgIJcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGxpc3QyVHJlZSAobGlzdDogYW55W10sIHtcbiAgcGFyZW50SWRLZXkgPSAncGFyZW50SWQnLFxuICByb290UGFyZW50SWRWYWx1ZSA9IG51bGwsXG4gIGlkS2V5ID0gJ2lkJyxcbiAgLy8gbGVhZlNlbGVjdGFibGVPbmx5ID0gdHJ1ZVxuICAvLyBpZ25vcmVMZWFmID0gZmFsc2VcbiAgaWZJZ25vcmUgPSAobm9kZSkgPT4gZmFsc2UsXG4gIC8vIGlzTGVhZiA9IChub2RlKSA9PiBmYWxzZSxcbiAgYmVmb3JlUHJvY2VzcyA9IG51bGwsXG4gIGFmdGVyUHJvY2VzcyA9IG51bGwsXG59KSB7XG4gIGZ1bmN0aW9uIHJlY3Vyc2VBZGRDaGlsZHJlbiAobm9kZXM6IGFueVtdLCBsYXllciA9IDApIHtcbiAgICBub2Rlcy5mb3JFYWNoKG5vZGUgPT4ge1xuICAgICAgaWYgKGJlZm9yZVByb2Nlc3MpIGJlZm9yZVByb2Nlc3Mobm9kZSlcbiAgICAgIGlmICghbm9kZS5sYXllcikgbm9kZS5sYXllciA9IGxheWVyXG4gICAgICBub2RlLnZhbHVlID0gbm9kZS5rZXkgPSBub2RlW2lkS2V5XVxuICAgICAgbm9kZS5sYWJlbCA9IG5vZGUudGl0bGUgPSBub2RlLm5hbWVcbiAgICAgIGNvbnN0IGNoaWxkcmVuID0gbGlzdC5maWx0ZXIoaXRlbSA9PiBpdGVtW3BhcmVudElkS2V5XSA9PT0gbm9kZVtpZEtleV0gJiYgIWlmSWdub3JlKGl0ZW0pKVxuICAgICAgaWYgKGNoaWxkcmVuLmxlbmd0aCA+IDApIHtcbiAgICAgICAgbm9kZS5jaGlsZHJlbiA9IGNoaWxkcmVuXG4gICAgICAgIHJlY3Vyc2VBZGRDaGlsZHJlbihub2RlLmNoaWxkcmVuLCBsYXllciArIDEpXG4gICAgICB9IGVsc2Uge1xuICAgICAgICBub2RlLmlzTGVhZiA9IHRydWVcbiAgICAgIH1cbiAgICAgIGlmIChhZnRlclByb2Nlc3MpIGFmdGVyUHJvY2Vzcyhub2RlKVxuICAgIH0pXG4gIH1cblxuICBjb25zdCB0cmVlID0gbGlzdC5maWx0ZXIoaXRlbSA9PiAhaXRlbVtwYXJlbnRJZEtleV0gfHwgaXRlbVtwYXJlbnRJZEtleV0gPT09IHJvb3RQYXJlbnRJZFZhbHVlKVxuICByZWN1cnNlQWRkQ2hpbGRyZW4odHJlZSlcbiAgcmV0dXJuIHRyZWVcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHV1aWR2NCAoKSB7XG4gIHJldHVybiAneHh4eHh4eHgteHh4eC00eHh4LXl4eHgteHh4eHh4eHh4eHh4Jy5yZXBsYWNlKC9beHldL2csIGMgPT4ge1xuICAgIHZhciByID0gTWF0aC5yYW5kb20oKSAqIDE2IHwgMCwgdiA9IGMgPT0gJ3gnID8gciA6IChyICYgMHgzIHwgMHg4KTtcbiAgICByZXR1cm4gdi50b1N0cmluZygxNik7XG4gIH0pO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gYXBwZW5kU2NyaXB0IChzcmM6IHN0cmluZykge1xuICBjb25zdCBib2R5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2JvZHknKVswXTtcbiAgY29uc3Qgc2NyaXB0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc2NyaXB0Jyk7XG4gIHNjcmlwdC5zcmMgPSBzcmNcbiAgYm9keS5hcHBlbmRDaGlsZChzY3JpcHQpO1xufVxuXG4vKipcbiAqIOWKoOi9vSBjc3NcbiAqIDEuIOmYsumHjeWkje+8muWmguaenOebuOWQjCBocmVmIOeahCBsaW5rIOagh+etvuW3suWtmOWcqO+8jOS4jeS8mumHjeaWsOWKoOi9vVxuICogMi4g5ZCMIGlkIOabv+aNou+8muWPr+S7peabv+aNouWQjCBpZCDnmoQgbGluayDmoIfnrb5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGxvYWRDc3MgKGhyZWY6IHN0cmluZywgZWxlSWQ/OiBzdHJpbmcsIGFsbG93UmVwZWF0ID0gZmFsc2UpIHtcbiAgLy8g6Ziy6YeN5aSNXG4gIGlmIChcbiAgICAhYWxsb3dSZXBlYXRcbiAgICAmJiBBcnJheS5mcm9tKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ2xpbmsnKSkuc29tZShsaW5rID0+IGxpbmsuaHJlZiA9PT0gaHJlZilcbiAgKSByZXR1cm5cbiAgLy8g5ZCMIGlkIOabv+aNolxuICBpZiAoZWxlSWQpIHtcbiAgICBjb25zdCB0aGVtZUxpbmsgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChlbGVJZCkgYXMgSFRNTExpbmtFbGVtZW50O1xuICAgIGlmICh0aGVtZUxpbmspIHtcbiAgICAgIHRoZW1lTGluay5ocmVmID0gaHJlZlxuICAgICAgcmV0dXJuXG4gICAgfVxuICB9XG4gIGNvbnN0IGhlYWQgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgnaGVhZCcpWzBdO1xuICBjb25zdCBzdHlsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xpbmsnKTtcbiAgaWYgKGVsZUlkKSBzdHlsZS5pZCA9IGVsZUlkO1xuICBzdHlsZS50eXBlID0gJ3RleHQvY3NzJ1xuICBzdHlsZS5yZWwgPSAnc3R5bGVzaGVldCc7XG4gIHN0eWxlLmhyZWYgPSBocmVmO1xuICBoZWFkLmFwcGVuZENoaWxkKHN0eWxlKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGRlZXBDbG9uZSAob2JqKSB7XG4gIHJldHVybiBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KG9iaikpXG59XG5cbi8qKiDnm7TmjqXmlLnlj5jmlbDnu4QgKi9cbmV4cG9ydCBmdW5jdGlvbiBzZXRBcnJheUxlbmd0aFRvIChhcnI6IGFueVtdLCB0YXJnZXRMZW5ndGg6IG51bWJlciwgZmlsbEl0ZW0pIHtcbiAgYXJyLmxlbmd0aCA9IHRhcmdldExlbmd0aFxuICBmb3IgKGxldCBpID0gMDsgaSA8IGFyci5sZW5ndGg7IGkrKykge1xuICAgIGlmICghYXJyW2ldKSBhcnJbaV0gPSBkZWVwQ2xvbmUoZmlsbEl0ZW0pXG4gIH1cbn1cbmV4cG9ydCBmdW5jdGlvbiBnZXRDdXJUaGVtZSAoKSB7XG4gIGNvbnN0IHJhd1RoZW1lS2V5ID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2dzcF9ydGZfdGhlbWVzS2V5JylcbiAgLy8g5Y+v6IO95pivIGRlZmF1bHTvvIzlvZLkuIDljJbmiJAgYmx1ZVxuICBpZiAocmF3VGhlbWVLZXkgPT09ICdkZWZhdWx0JyB8fCAhcmF3VGhlbWVLZXkpIHJldHVybiAnYmx1ZSdcbn1cbi8qKlxuICog5Yqg6L29XG4gKiAxLiDlhazlhbEgc3R5bGVcbiAqIDIuIOWFrOWFseS4u+mimCBzdHlsZVxuICovXG5leHBvcnQgZnVuY3Rpb24gbG9hZENvbW1vblN0eWxlTlRoZW1lICgpIHtcbiAgY29uc3QgY3VyVGhlbWUgPSBnZXRDdXJUaGVtZSgpXG4gIC8vIGFudGQg5LyY5YWI57qn5pyA5L2OXG4gIGxvYWRDc3MoYCR7SUdJWF9IT01FX1BBVEh9eGMtYW50ZC0ke2N1clRoZW1lfS5jc3NgKVxuICBsb2FkQ3NzKGAke0lHSVhfSE9NRV9QQVRIfXBsYWluLmNzc2ApXG4gIGxvYWRDc3MoYCR7SUdJWF9IT01FX1BBVEh9eGMtY29tbW9uLmNzc2ApXG4gIGxvYWRDc3MoYCR7SUdJWF9IT01FX1BBVEh9eGMtY29tbW9uLSR7Y3VyVGhlbWV9LmNzc2ApXG59XG4vKipcbiAqIOS4pOS4qiBvYmog5piv5ZCm57uT5p6E55u45ZCM44CB6YeM6Z2i55qE5omA5pyJ5a2X6Z2i5YC855u4562J77yM5Y+K5pe25YaF6YOo5byV55SoXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBvYmplY3RMaXRlcmFsRXF1YWwgKG9iajEsIG9iajIpIHtcbiAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KG9iajEpID09PSBKU09OLnN0cmluZ2lmeShvYmoyKVxufVxuZXhwb3J0IGNvbnN0IGN1ckxhbmcgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnbGFuZ3VhZ2VDb2RlJykgfHwgJ3poLUNIUydcbiJdfQ==