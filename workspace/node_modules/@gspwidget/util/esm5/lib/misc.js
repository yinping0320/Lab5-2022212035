/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { IGIX_HOME_PATH } from "./const";
/**
 * 形如 {key={key=value, key=value}, key={}}
 * 转为 JSON 标准格式
 * @param {?} original
 * @return {?}
 */
export function backendString2Json(original) {
    /** @type {?} */
    var result = original.replace(/\s/g, '') // 去空格
    ;
    result = result.replace(/=/g, ':'); // = 变 :
    result = result.replace(/:/g, '\":'); // : 前加 "
    result = result.replace(/,/g, ',\"'); // , 后加 "
    result = result.replace(/{(?=\w)/g, '{\"'); // 后接字母的 { 后加 "
    return result;
}
/**
 * 用列表构造一棵树。
 * @param {?} list
 * @param {?} __1
 * @return {?}
 */
export function list2Tree(list, _a) {
    var _b = _a.parentIdKey, parentIdKey = _b === void 0 ? 'parentId' : _b, _c = _a.rootParentIdValue, rootParentIdValue = _c === void 0 ? null : _c, _d = _a.idKey, idKey = _d === void 0 ? 'id' : _d, 
    // leafSelectableOnly = true
    // ignoreLeaf = false
    _e = _a.ifIgnore, 
    // leafSelectableOnly = true
    // ignoreLeaf = false
    ifIgnore = _e === void 0 ? (/**
     * @param {?} node
     * @return {?}
     */
    function (node) { return false; }) : _e, 
    // isLeaf = (node) => false,
    _f = _a.beforeProcess, 
    // isLeaf = (node) => false,
    beforeProcess = _f === void 0 ? null : _f, _g = _a.afterProcess, afterProcess = _g === void 0 ? null : _g;
    /**
     * @param {?} nodes
     * @param {?=} layer
     * @return {?}
     */
    function recurseAddChildren(nodes, layer) {
        if (layer === void 0) { layer = 0; }
        nodes.forEach((/**
         * @param {?} node
         * @return {?}
         */
        function (node) {
            if (beforeProcess)
                beforeProcess(node);
            if (!node.layer)
                node.layer = layer;
            node.value = node.key = node[idKey];
            node.label = node.title = node.name;
            /** @type {?} */
            var children = list.filter((/**
             * @param {?} item
             * @return {?}
             */
            function (item) { return item[parentIdKey] === node[idKey] && !ifIgnore(item); }));
            if (children.length > 0) {
                node.children = children;
                recurseAddChildren(node.children, layer + 1);
            }
            else {
                node.isLeaf = true;
            }
            if (afterProcess)
                afterProcess(node);
        }));
    }
    /** @type {?} */
    var tree = list.filter((/**
     * @param {?} item
     * @return {?}
     */
    function (item) { return !item[parentIdKey] || item[parentIdKey] === rootParentIdValue; }));
    recurseAddChildren(tree);
    return tree;
}
/**
 * @return {?}
 */
export function uuidv4() {
    return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, (/**
     * @param {?} c
     * @return {?}
     */
    function (c) {
        /** @type {?} */
        var r = Math.random() * 16 | 0;
        /** @type {?} */
        var v = c == 'x' ? r : (r & 0x3 | 0x8);
        return v.toString(16);
    }));
}
/**
 * @param {?} src
 * @return {?}
 */
export function appendScript(src) {
    /** @type {?} */
    var body = document.getElementsByTagName('body')[0];
    /** @type {?} */
    var script = document.createElement('script');
    script.src = src;
    body.appendChild(script);
}
/**
 * 加载 css
 * 1. 防重复：如果相同 href 的 link 标签已存在，不会重新加载
 * 2. 同 id 替换：可以替换同 id 的 link 标签
 * @param {?} href
 * @param {?=} eleId
 * @param {?=} allowRepeat
 * @return {?}
 */
export function loadCss(href, eleId, allowRepeat) {
    if (allowRepeat === void 0) { allowRepeat = false; }
    // 防重复
    if (!allowRepeat
        && Array.from(document.querySelectorAll('link')).some((/**
         * @param {?} link
         * @return {?}
         */
        function (link) { return link.href === href; })))
        return;
    // 同 id 替换
    if (eleId) {
        /** @type {?} */
        var themeLink = (/** @type {?} */ (document.getElementById(eleId)));
        if (themeLink) {
            themeLink.href = href;
            return;
        }
    }
    /** @type {?} */
    var head = document.getElementsByTagName('head')[0];
    /** @type {?} */
    var style = document.createElement('link');
    if (eleId)
        style.id = eleId;
    style.type = 'text/css';
    style.rel = 'stylesheet';
    style.href = href;
    head.appendChild(style);
}
/**
 * @param {?} obj
 * @return {?}
 */
export function deepClone(obj) {
    return JSON.parse(JSON.stringify(obj));
}
/**
 * 直接改变数组
 * @param {?} arr
 * @param {?} targetLength
 * @param {?} fillItem
 * @return {?}
 */
export function setArrayLengthTo(arr, targetLength, fillItem) {
    arr.length = targetLength;
    for (var i = 0; i < arr.length; i++) {
        if (!arr[i])
            arr[i] = deepClone(fillItem);
    }
}
/**
 * @return {?}
 */
export function getCurTheme() {
    /** @type {?} */
    var rawThemeKey = localStorage.getItem('gsp_rtf_themesKey')
    // 可能是 default，归一化成 blue
    ;
    // 可能是 default，归一化成 blue
    if (rawThemeKey === 'default' || !rawThemeKey)
        return 'blue';
}
/**
 * 加载
 * 1. 公共 style
 * 2. 公共主题 style
 * @return {?}
 */
export function loadCommonStyleNTheme() {
    /** @type {?} */
    var curTheme = getCurTheme()
    // antd 优先级最低
    ;
    // antd 优先级最低
    loadCss(IGIX_HOME_PATH + "xc-antd-" + curTheme + ".css");
    loadCss(IGIX_HOME_PATH + "plain.css");
    loadCss(IGIX_HOME_PATH + "xc-common.css");
    loadCss(IGIX_HOME_PATH + "xc-common-" + curTheme + ".css");
}
/**
 * 两个 obj 是否结构相同、里面的所有字面值相等，及时内部引用
 * @param {?} obj1
 * @param {?} obj2
 * @return {?}
 */
export function objectLiteralEqual(obj1, obj2) {
    return JSON.stringify(obj1) === JSON.stringify(obj2);
}
/** @type {?} */
export var curLang = localStorage.getItem('languageCode') || 'zh-CHS';
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWlzYy5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0Bnc3B3aWRnZXQvdXRpbC8iLCJzb3VyY2VzIjpbImxpYi9taXNjLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7QUFBQSxPQUFPLEVBQUUsY0FBYyxFQUFFLE1BQU0sU0FBUyxDQUFBOzs7Ozs7O0FBTXhDLE1BQU0sVUFBVSxrQkFBa0IsQ0FBRSxRQUFnQjs7UUFDOUMsTUFBTSxHQUFHLFFBQVEsQ0FBQyxPQUFPLENBQUMsS0FBSyxFQUFFLEVBQUUsQ0FBQyxDQUFJLE1BQU07O0lBQ2xELE1BQU0sR0FBRyxNQUFNLENBQUMsT0FBTyxDQUFDLElBQUksRUFBRSxHQUFHLENBQUMsQ0FBQSxDQUFJLFFBQVE7SUFDOUMsTUFBTSxHQUFHLE1BQU0sQ0FBQyxPQUFPLENBQUMsSUFBSSxFQUFFLEtBQUssQ0FBQyxDQUFBLENBQUUsU0FBUztJQUMvQyxNQUFNLEdBQUcsTUFBTSxDQUFDLE9BQU8sQ0FBQyxJQUFJLEVBQUUsS0FBSyxDQUFDLENBQUEsQ0FBRSxTQUFTO0lBQy9DLE1BQU0sR0FBRyxNQUFNLENBQUMsT0FBTyxDQUFDLFVBQVUsRUFBRSxLQUFLLENBQUMsQ0FBQSxDQUFFLGVBQWU7SUFDM0QsT0FBTyxNQUFNLENBQUE7QUFDZixDQUFDOzs7Ozs7O0FBSUQsTUFBTSxVQUFVLFNBQVMsQ0FBRSxJQUFXLEVBQUUsRUFVdkM7UUFUQyxtQkFBd0IsRUFBeEIsNkNBQXdCLEVBQ3hCLHlCQUF3QixFQUF4Qiw2Q0FBd0IsRUFDeEIsYUFBWSxFQUFaLGlDQUFZO0lBQ1osNEJBQTRCO0lBQzVCLHFCQUFxQjtJQUNyQixnQkFBMEI7SUFGMUIsNEJBQTRCO0lBQzVCLHFCQUFxQjtJQUNyQjs7OzsyQ0FBMEI7SUFDMUIsNEJBQTRCO0lBQzVCLHFCQUFvQjtJQURwQiw0QkFBNEI7SUFDNUIseUNBQW9CLEVBQ3BCLG9CQUFtQixFQUFuQix3Q0FBbUI7Ozs7OztJQUVuQixTQUFTLGtCQUFrQixDQUFFLEtBQVksRUFBRSxL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QUFDLG1CQUFtQixDQUFDO0lBQzdELHdCQUF3Qjs7SUFBeEIsd0JBQXdCO0lBQ3hCLElBQUksV0FBVyxLQUFLLFNBQVMsSUFBSSxDQUFDLFdBQVc7UUFBRSxPQUFPLE1BQU0sQ0FBQTtBQUM5RCxDQUFDOzs7Ozs7O0FBTUQsTUFBTSxVQUFVLHFCQUFxQjs7UUFDN0IsUUFBUSxHQUFHLFdBQVcsRUFBRTtJQUM5QixhQUFhOztJQUFiLGFBQWE7SUFDYixPQUFPLENBQUksY0FBYyxnQkFBVyxRQUFRLFNBQU0sQ0FBQyxDQUFBO0lBQ25ELE9BQU8sQ0FBSSxjQUFjLGNBQVcsQ0FBQyxDQUFBO0lBQ3JDLE9BQU8sQ0FBSSxjQUFjLGtCQUFlLENBQUMsQ0FBQTtJQUN6QyxPQUFPLENBQUksY0FBYyxrQkFBYSxRQUFRLFNBQU0sQ0FBQyxDQUFBO0FBQ3ZELENBQUM7Ozs7Ozs7QUFJRCxNQUFNLFVBQVUsa0JBQWtCLENBQUUsSUFBSSxFQUFFLElBQUk7SUFDNUMsT0FBTyxJQUFJLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxLQUFLLElBQUksQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLENBQUE7QUFDdEQsQ0FBQzs7QUFDRCxNQUFNLEtBQU8sT0FBTyxHQUFHLFlBQVksQ0FBQyxPQUFPLENBQUMsY0FBYyxDQUFDLElBQUksUUFBUSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IElHSVhfSE9NRV9QQVRIIH0gZnJvbSBcIi4vY29uc3RcIlxuXG4vKipcbiAqIOW9ouWmgiB7a2V5PXtrZXk9dmFsdWUsIGtleT12YWx1ZX0sIGtleT17fX1cbiAqIOi9rOS4uiBKU09OIOagh+WHhuagvOW8j1xuICovXG5leHBvcnQgZnVuY3Rpb24gYmFja2VuZFN0cmluZzJKc29uIChvcmlnaW5hbDogc3RyaW5nKSB7XG4gIGxldCByZXN1bHQgPSBvcmlnaW5hbC5yZXBsYWNlKC9cXHMvZywgJycpICAgIC8vIOWOu+epuuagvFxuICByZXN1bHQgPSByZXN1bHQucmVwbGFjZSgvPS9nLCAnOicpICAgIC8vID0g5Y+YIDpcbiAgcmVzdWx0ID0gcmVzdWx0LnJlcGxhY2UoLzovZywgJ1xcXCI6JykgIC8vIDog5YmN5YqgIFwiXG4gIHJlc3VsdCA9IHJlc3VsdC5yZXBsYWNlKC8sL2csICcsXFxcIicpICAvLyAsIOWQjuWKoCBcIlxuICByZXN1bHQgPSByZXN1bHQucmVwbGFjZSgveyg/PVxcdykvZywgJ3tcXFwiJykgIC8vIOWQjuaOpeWtl+avjeeahCB7IOWQjuWKoCBcIlxuICByZXR1cm4gcmVzdWx0XG59XG4vKipcbiAqIOeUqOWIl+ihqOaehOmAoOS4gOajteagkeOAglxuICovXG5leHBvcnQgZnVuY3Rpb24gbGlzdDJUcmVlIChsaXN0OiBhbnlbXSwge1xuICBwYXJlbnRJZEtleSA9ICdwYXJlbnRJZCcsXG4gIHJvb3RQYXJlbnRJZFZhbHVlID0gbnVsbCxcbiAgaWRLZXkgPSAnaWQnLFxuICAvLyBsZWFmU2VsZWN0YWJsZU9ubHkgPSB0cnVlXG4gIC8vIGlnbm9yZUxlYWYgPSBmYWxzZVxuICBpZklnbm9yZSA9IChub2RlKSA9PiBmYWxzZSxcbiAgLy8gaXNMZWFmID0gKG5vZGUpID0+IGZhbHNlLFxuICBiZWZvcmVQcm9jZXNzID0gbnVsbCxcbiAgYWZ0ZXJQcm9jZXNzID0gbnVsbCxcbn0pIHtcbiAgZnVuY3Rpb24gcmVjdXJzZUFkZENoaWxkcmVuIChub2RlczogYW55W10sIGxheWVyID0gMCkge1xuICAgIG5vZGVzLmZvckVhY2gobm9kZSA9PiB7XG4gICAgICBpZiAoYmVmb3JlUHJvY2VzcykgYmVmb3JlUHJvY2Vzcyhub2RlKVxuICAgICAgaWYgKCFub2RlLmxheWVyKSBub2RlLmxheWVyID0gbGF5ZXJcbiAgICAgIG5vZGUudmFsdWUgPSBub2RlLmtleSA9IG5vZGVbaWRLZXldXG4gICAgICBub2RlLmxhYmVsID0gbm9kZS50aXRsZSA9IG5vZGUubmFtZVxuICAgICAgY29uc3QgY2hpbGRyZW4gPSBsaXN0LmZpbHRlcihpdGVtID0+IGl0ZW1bcGFyZW50SWRLZXldID09PSBub2RlW2lkS2V5XSAmJiAhaWZJZ25vcmUoaXRlbSkpXG4gICAgICBpZiAoY2hpbGRyZW4ubGVuZ3RoID4gMCkge1xuICAgICAgICBub2RlLmNoaWxkcmVuID0gY2hpbGRyZW5cbiAgICAgICAgcmVjdXJzZUFkZENoaWxkcmVuKG5vZGUuY2hpbGRyZW4sIGxheWVyICsgMSlcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIG5vZGUuaXNMZWFmID0gdHJ1ZVxuICAgICAgfVxuICAgICAgaWYgKGFmdGVyUHJvY2VzcykgYWZ0ZXJQcm9jZXNzKG5vZGUpXG4gICAgfSlcbiAgfVxuXG4gIGNvbnN0IHRyZWUgPSBsaXN0LmZpbHRlcihpdGVtID0+ICFpdGVtW3BhcmVudElkS2V5XSB8fCBpdGVtW3BhcmVudElkS2V5XSA9PT0gcm9vdFBhcmVudElkVmFsdWUpXG4gIHJlY3Vyc2VBZGRDaGlsZHJlbih0cmVlKVxuICByZXR1cm4gdHJlZVxufVxuXG5leHBvcnQgZnVuY3Rpb24gdXVpZHY0ICgpIHtcbiAgcmV0dXJuICd4eHh4eHh4eC14eHh4LTR4eHgteXh4eC14eHh4eHh4eHh4eHgnLnJlcGxhY2UoL1t4eV0vZywgYyA9PiB7XG4gICAgdmFyIHIgPSBNYXRoLnJhbmRvbSgpICogMTYgfCAwLCB2ID0gYyA9PSAneCcgPyByIDogKHIgJiAweDMgfCAweDgpO1xuICAgIHJldHVybiB2LnRvU3RyaW5nKDE2KTtcbiAgfSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBhcHBlbmRTY3JpcHQgKHNyYzogc3RyaW5nKSB7XG4gIGNvbnN0IGJvZHkgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgnYm9keScpWzBdO1xuICBjb25zdCBzY3JpcHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzY3JpcHQnKTtcbiAgc2NyaXB0LnNyYyA9IHNyY1xuICBib2R5LmFwcGVuZENoaWxkKHNjcmlwdCk7XG59XG5cbi8qKlxuICog5Yqg6L29IGNzc1xuICogMS4g6Ziy6YeN5aSN77ya5aaC5p6c55u45ZCMIGhyZWYg55qEIGxpbmsg5qCH562+5bey5a2Y5Zyo77yM5LiN5Lya6YeN5paw5Yqg6L29XG4gKiAyLiDlkIwgaWQg5pu/5o2i77ya5Y+v5Lul5pu/5o2i5ZCMIGlkIOeahCBsaW5rIOagh+etvlxuICovXG5leHBvcnQgZnVuY3Rpb24gbG9hZENzcyAoaHJlZjogc3RyaW5nLCBlbGVJZD86IHN0cmluZywgYWxsb3dSZXBlYXQgPSBmYWxzZSkge1xuICAvLyDpmLLph43lpI1cbiAgaWYgKFxuICAgICFhbGxvd1JlcGVhdFxuICAgICYmIEFycmF5LmZyb20oZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnbGluaycpKS5zb21lKGxpbmsgPT4gbGluay5ocmVmID09PSBocmVmKVxuICApIHJldHVyblxuICAvLyDlkIwgaWQg5pu/5o2iXG4gIGlmIChlbGVJZCkge1xuICAgIGNvbnN0IHRoZW1lTGluayA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGVsZUlkKSBhcyBIVE1MTGlua0VsZW1lbnQ7XG4gICAgaWYgKHRoZW1lTGluaykge1xuICAgICAgdGhlbWVMaW5rLmhyZWYgPSBocmVmXG4gICAgICByZXR1cm5cbiAgICB9XG4gIH1cbiAgY29uc3QgaGVhZCA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCdoZWFkJylbMF07XG4gIGNvbnN0IHN0eWxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGluaycpO1xuICBpZiAoZWxlSWQpIHN0eWxlLmlkID0gZWxlSWQ7XG4gIHN0eWxlLnR5cGUgPSAndGV4dC9jc3MnXG4gIHN0eWxlLnJlbCA9ICdzdHlsZXNoZWV0JztcbiAgc3R5bGUuaHJlZiA9IGhyZWY7XG4gIGhlYWQuYXBwZW5kQ2hpbGQoc3R5bGUpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZGVlcENsb25lIChvYmopIHtcbiAgcmV0dXJuIEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkob2JqKSlcbn1cblxuLyoqIOebtOaOpeaUueWPmOaVsOe7hCAqL1xuZXhwb3J0IGZ1bmN0aW9uIHNldEFycmF5TGVuZ3RoVG8gKGFycjogYW55W10sIHRhcmdldExlbmd0aDogbnVtYmVyLCBmaWxsSXRlbSkge1xuICBhcnIubGVuZ3RoID0gdGFyZ2V0TGVuZ3RoXG4gIGZvciAobGV0IGkgPSAwOyBpIDwgYXJyLmxlbmd0aDsgaSsrKSB7XG4gICAgaWYgKCFhcnJbaV0pIGFycltpXSA9IGRlZXBDbG9uZShmaWxsSXRlbSlcbiAgfVxufVxuZXhwb3J0IGZ1bmN0aW9uIGdldEN1clRoZW1lICgpIHtcbiAgY29uc3QgcmF3VGhlbWVLZXkgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnZ3NwX3J0Zl90aGVtZXNLZXknKVxuICAvLyDlj6/og73mmK8gZGVmYXVsdO+8jOW9kuS4gOWMluaIkCBibHVlXG4gIGlmIChyYXdUaGVtZUtleSA9PT0gJ2RlZmF1bHQnIHx8ICFyYXdUaGVtZUtleSkgcmV0dXJuICdibHVlJ1xufVxuLyoqXG4gKiDliqDovb1cbiAqIDEuIOWFrOWFsSBzdHlsZVxuICogMi4g5YWs5YWx5Li76aKYIHN0eWxlXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBsb2FkQ29tbW9uU3R5bGVOVGhlbWUgKCkge1xuICBjb25zdCBjdXJUaGVtZSA9IGdldEN1clRoZW1lKClcbiAgLy8gYW50ZCDkvJjlhYjnuqfmnIDkvY5cbiAgbG9hZENzcyhgJHtJR0lYX0hPTUVfUEFUSH14Yy1hbnRkLSR7Y3VyVGhlbWV9LmNzc2ApXG4gIGxvYWRDc3MoYCR7SUdJWF9IT01FX1BBVEh9cGxhaW4uY3NzYClcbiAgbG9hZENzcyhgJHtJR0lYX0hPTUVfUEFUSH14Yy1jb21tb24uY3NzYClcbiAgbG9hZENzcyhgJHtJR0lYX0hPTUVfUEFUSH14Yy1jb21tb24tJHtjdXJUaGVtZX0uY3NzYClcbn1cbi8qKlxuICog5Lik5LiqIG9iaiDmmK/lkKbnu5PmnoTnm7jlkIzjgIHph4zpnaLnmoTmiYDmnInlrZfpnaLlgLznm7jnrYnvvIzlj4rml7blhoXpg6jlvJXnlKhcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIG9iamVjdExpdGVyYWxFcXVhbCAob2JqMSwgb2JqMikge1xuICByZXR1cm4gSlNPTi5zdHJpbmdpZnkob2JqMSkgPT09IEpTT04uc3RyaW5naWZ5KG9iajIpXG59XG5leHBvcnQgY29uc3QgY3VyTGFuZyA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdsYW5ndWFnZUNvZGUnKSB8fCAnemgtQ0hTJ1xuIl19