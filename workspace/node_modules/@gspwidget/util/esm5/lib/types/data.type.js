/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
import { camelCase, constantCase } from 'change-case';
import { decrypt, encrypt } from '../utils/encryption';
/**
 * @record
 */
export function ProviderParam() { }
if (false) {
    /** @type {?|undefined} */
    ProviderParam.prototype.label;
    /** @type {?|undefined} */
    ProviderParam.prototype.name;
    /** @type {?|undefined} */
    ProviderParam.prototype.type;
    /** @type {?|undefined} */
    ProviderParam.prototype.sortNo;
    /** @type {?|undefined} */
    ProviderParam.prototype.value;
    /** @type {?|undefined} */
    ProviderParam.prototype.placeholder;
    /** @type {?|undefined} */
    ProviderParam.prototype.options;
    /** @type {?|undefined} */
    ProviderParam.prototype.checked;
    /** @type {?|undefined} */
    ProviderParam.prototype.required;
    /** @type {?|undefined} */
    ProviderParam.prototype.encrypted;
}
// TODO: 数据源相关的，要放在 dashboard core 中吗
var 
// TODO: 数据源相关的，要放在 dashboard core 中吗
Datasrc = /** @class */ (function () {
    function Datasrc(providerName) {
        this.providerName = providerName;
        this.i18nName = {};
        this.config = {};
    }
    return Datasrc;
}());
// TODO: 数据源相关的，要放在 dashboard core 中吗
export { Datasrc };
if (false) {
    /** @type {?} */
    Datasrc.prototype.id;
    /** @type {?} */
    Datasrc.prototype.name;
    /** @type {?} */
    Datasrc.prototype.i18nName;
    /** @type {?} */
    Datasrc.prototype.config;
    /** @type {?} */
    Datasrc.prototype.groupName;
    /** @type {?} */
    Datasrc.prototype.creator;
    /** @type {?} */
    Datasrc.prototype.createTime;
    /** @type {?} */
    Datasrc.prototype.providerName;
}
/**
 * @record
 */
export function DataProvider() { }
if (false) {
    /** @type {?} */
    DataProvider.prototype.label;
    /** @type {?} */
    DataProvider.prototype.name;
}
/**
 * @record
 */
export function DataParamDto() { }
if (false) {
    /** @type {?|undefined} */
    DataParamDto.prototype.id;
    /** @type {?|undefined} */
    DataParamDto.prototype.i18nName;
    /** @type {?|undefined} */
    DataParamDto.prototype.type;
    /** @type {?|undefined} */
    DataParamDto.prototype.config;
    /** @type {?|undefined} */
    DataParamDto.prototype.datasetId;
    /** @type {?|undefined} */
    DataParamDto.prototype.name;
    /** @type {?|undefined} */
    DataParamDto.prototype.value;
}
/**
 * 取数参数
 */
var /**
 * 取数参数
 */
DataParam = /** @class */ (function () {
    function DataParam() {
        this.type = 'QUERY_PARAM';
        this.default = null;
    }
    /**
     * @param {?} dp
     * @return {?}
     */
    DataParam.ToDto = /**
     * @param {?} dp
     * @return {?}
     */
    function (dp) {
        var i18nName = dp.i18nName, type = dp.type, config = dp.config, id = dp.id;
        return (/** @type {?} */ ({
            id: id, i18nName: i18nName, config: config,
            type: camelCase(type),
            value: dp.default,
        }));
    };
    /**
     * @param {?} dpDto
     * @return {?}
     */
    DataParam.FromDto = /**
     * @param {?} dpDto
     * @return {?}
     */
    function (dpDto) {
        return (/** @type {?} */ ({
            id: dpDto.id,
            i18nName: dpDto.i18nName,
            type: constantCase(dpDto.type),
            config: dpDto.config,
            datasetId: dpDto.datasetId,
            name: dpDto.name,
            default: dpDto.value,
        }));
    };
    return DataParam;
}());
/**
 * 取数参数
 */
export { DataParam };
if (false) {
    /** @type {?} */
    DataParam.prototype.id;
    /** @type {?} */
    DataParam.prototype.name;
    /** @type {?} */
    DataParam.prototype.i18nName;
    /** @type {?} */
    DataParam.prototype.type;
    /** @type {?} */
    DataParam.prototype.config;
    /** @type {?} */
    DataParam.prototype.default;
    /** @type {?} */
    DataParam.prototype.datasetId;
}
/**
 * @record
 */
export function DatasetDto() { }
if (false) {
    /** @type {?|undefined} */
    DatasetDto.prototype.id;
    /** @type {?|undefined} */
    DatasetDto.prototype.name;
    /** @type {?|undefined} */
    DatasetDto.prototype.datasourceId;
    /** @type {?|undefined} */
    DatasetDto.prototype.i18nName;
    /** @type {?|undefined} */
    DatasetDto.prototype.datasourceName;
    /** @type {?|undefined} */
    DatasetDto.prototype.dimensions;
    /** @type {?|undefined} */
    DatasetDto.prototype.creationTime;
    /** @type {?|undefined} */
    DatasetDto.prototype.method;
    /** @type {?|undefined} */
    DatasetDto.prototype.parameters;
    /** @type {?|undefined} */
    DatasetDto.prototype.config;
    /** @type {?|undefined} */
    DatasetDto.prototype.dataParamDto;
}
var DatasetParameter = /** @class */ (function () {
    function DatasetParameter(name, value, sortNo, isExpression) {
        if (isExpression === void 0) { isExpression = true; }
        this.name = name;
        this.value = value;
        this.sortNo = sortNo;
        this.isExpression = isExpression;
    }
    return DatasetParameter;
}());
export { DatasetParameter };
if (false) {
    /** @type {?} */
    DatasetParameter.prototype.name;
    /** @type {?} */
    DatasetParameter.prototype.value;
    /** @type {?} */
    DatasetParameter.prototype.sortNo;
    /** @type {?} */
    DatasetParameter.prototype.isExpression;
}
/**
 * @record
 */
function AnyKey() { }
var Dataset = /** @class */ (function () {
    function Dataset() {
        // datasrc?: Datasrc
        this.config = {};
        this.cols = {
            dimensions: [],
            measures: [],
        };
        this.dataParams = [];
    }
    /**
     * @return {?}
     */
    Dataset.create = /**
     * @return {?}
     */
    function () {
        return new Dataset();
    };
    /**
     * @param {?} dataset
     * @return {?}
     */
    Dataset.toDto = /**
     * @param {?} dataset
     * @return {?}
     */
    function (dataset) {
        var id = dataset.id, name = dataset.name, datasrcId = dataset.datasrcId, datasrcName = dataset.datasrcName, cols = dataset.cols, creationTime = dataset.creationTime, config = dataset.config, dataParams = dataset.dataParams, i18nName = dataset.i18nName;
        return {
            id: id, name: name, creationTime: creationTime, i18nName: i18nName,
            datasourceId: datasrcId,
            datasourceName: datasrcName,
            dimensions: cols.dimensions,
            config: encrypt(JSON.stringify(config)),
            dataParamDto: dataParams.map(DataParam.ToDto)
        };
    };
    /**
     * @param {?} datasetDto
     * @return {?}
     */
    Dataset.fromDto = /**
     * @param {?} datasetDto
     * @return {?}
     */
    function (datasetDto) {
        var id = datasetDto.id, name = datasetDto.name, datasourceId = datasetDto.datasourceId, datasourceName = datasetDto.datasourceName, dimensions = datasetDto.dimensions, creationTime = datasetDto.creationTime, method = datasetDto.method, parameters = datasetDto.parameters, i18nName = datasetDto.i18nName, config = datasetDto.config, dataParamDto = datasetDto.dataParamDto;
        /** @type {?} */
        var parsedConfig = null;
        try {
            parsedConfig = JSON.parse(decrypt(config));
        }
        catch (error) {
        }
        if (!parsedConfig)
            parsedConfig = {};
        return {
            // ...datasetDto,
            id: id, name: name, creationTime: creationTime, i18nName: i18nName,
            datasrcId: datasourceId,
            datasrcName: datasourceName,
            cols: { dimensions: dimensions },
            config: parsedConfig,
            dataParams: dataParamDto ? dataParamDto.map(DataParam.FromDto) : [],
        };
    };
    return Dataset;
}());
export { Dataset };
if (false) {
    /** @type {?} */
    Dataset.prototype.id;
    /** @type {?} */
    Dataset.prototype.name;
    /** @type {?} */
    Dataset.prototype.product;
    /** @type {?} */
    Dataset.prototype.module;
    /** @type {?} */
    Dataset.prototype.creator;
    /** @type {?} */
    Dataset.prototype.modifier;
    /** @type {?} */
    Dataset.prototype.creationTime;
    /** @type {?} */
    Dataset.prototype.modifyTime;
    /** @type {?} */
    Dataset.prototype.datasrcId;
    /** @type {?} */
    Dataset.prototype.datasrcName;
    /** @type {?} */
    Dataset.prototype.i18nName;
    /** @type {?} */
    Dataset.prototype.config;
    /** @type {?} */
    Dataset.prototype.cols;
    /** @type {?} */
    Dataset.prototype.dataParams;
}
var Dimension = /** @class */ (function () {
    function Dimension() {
    }
    return Dimension;
}());
export { Dimension };
if (false) {
    /** @type {?} */
    Dimension.prototype.name;
    /** @type {?} */
    Dimension.prototype.label;
    /** @type {?} */
    Dimension.prototype.i18nLabel;
    /** @type {?} */
    Dimension.prototype.type;
    /** @type {?} */
    Dimension.prototype.typeName;
    /** @type {?} */
    Dimension.prototype.javaClassName;
    /** @type {?} */
    Dimension.prototype.groupName;
    /** @type {?} */
    Dimension.prototype.comment;
    /** @type {?} */
    Dimension.prototype.notNull;
}
/**
 * @record
 */
export function Filter() { }
if (false) {
    /** @type {?|undefined} */
    Filter.prototype.hasValue;
    /** @type {?|undefined} */
    Filter.prototype.filterExpression;
}
/** @enum {string} */
var ComputedType = {
    Count: 'Count',
    Sum: 'Sum',
    Max: 'Max',
    Min: 'Min',
    Avg: 'Avg',
    Expression: 'Expression',
};
export { ComputedType };
/** @enum {string} */
var AggType = {
    Table: 'Table',
    CroosTable: 'CroosTable',
};
export { AggType };
var ComputedCol = /** @class */ (function (_super) {
    tslib_1.__extends(ComputedCol, _super);
    function ComputedCol(expression) {
        var _this = _super.call(this) || this;
        _this.expression = expression;
        _this.computeType = ComputedType.Expression;
        return _this;
    }
    return ComputedCol;
}(Dimension));
export { ComputedCol };
if (false) {
    /** @type {?} */
    ComputedCol.prototype.computeType;
    /**
     * @type {?}
     * @private
     */
    ComputedCol.prototype.expression;
}
/**
 * @record
 */
export function Col() { }
/**
 * @record
 */
export function Row() { }
/**
 * @record
 */
export function AggDto() { }
if (false) {
    /** @type {?|undefined} */
    AggDto.prototype.id;
    /** @type {?|undefined} */
    AggDto.prototype.dataSetId;
    /** @type {?|undefined} */
    AggDto.prototype.dataSetName;
    /** @type {?|undefined} */
    AggDto.prototype.resource;
    /** @type {?|undefined} */
    AggDto.prototype.resourceId;
    /** @type {?|undefined} */
    AggDto.prototype.aggregationType;
    /** @type {?|undefined} */
    AggDto.prototype.columnConfigs;
    /** @type {?|undefined} */
    AggDto.prototype.rowConfigs;
    /** @type {?|undefined} */
    AggDto.prototype.filterConfigs;
    /** @type {?|undefined} */
    AggDto.prototype.computedExpressionConfigs;
}
var Agg = /** @class */ (function () {
    function Agg() {
        this.cols = [];
        this.rows = [];
        this.filters = [];
        this.computedCols = [];
    }
    /**
     * @param {?} agg
     * @return {?}
     */
    Agg.toDto = /**
     * @param {?} agg
     * @return {?}
     */
    function (agg) {
        var id = agg.id, datasetId = agg.datasetId, resource = agg.resource, resourceId = agg.resourceId, aggType = agg.aggType, cols = agg.cols, rows = agg.rows, filters = agg.filters, computedCols = agg.computedCols;
        return (/** @type {?} */ ({
            id: id,
            dataSetId: datasetId,
            resource: resource,
            resourceId: resourceId,
            aggregationType: aggType,
            columnConfigs: cols,
            rowConfigs: rows,
            filterConfigs: filters,
            computedExpressionConfigs: computedCols
        }));
    };
    /**
     * @param {?} aggDto
     * @return {?}
     */
    Agg.fromDto = /**
     * @param {?} aggDto
     * @return {?}
     */
    function (aggDto) {
        var id = aggDto.id, dataSetId = aggDto.dataSetId, dataSetName = aggDto.dataSetName, resource = aggDto.resource, resourceId = aggDto.resourceId, aggregationType = aggDto.aggregationType, columnConfigs = aggDto.columnConfigs, rowConfigs = aggDto.rowConfigs, filterConfigs = aggDto.filterConfigs, computedExpressionConfigs = aggDto.computedExpressionConfigs;
        return (/** @type {?} */ ({
            id: id,
            datasetId: dataSetId,
            datasetName: dataSetName,
            resource: resource,
            resourceId: resourceId,
            aggType: aggregationType,
            cols: columnConfigs,
            rows: rowConfigs,
            filters: filterConfigs,
            computedCols: computedExpressionConfigs
        }));
    };
    return Agg;
}());
export { Agg };
if (false) {
    /** @type {?} */
    Agg.prototype.id;
    /** @type {?} */
    Agg.prototype.datasetId;
    /** @type {?} */
    Agg.prototype.datasetName;
    /** @type {?} */
    Agg.prototype.resource;
    /** @type {?} */
    Agg.prototype.resourceId;
    /** @type {?} */
    Agg.prototype.aggType;
    /** @type {?} */
    Agg.prototype.cols;
    /** @type {?} */
    Agg.prototype.rows;
    /** @type {?} */
    Agg.prototype.filters;
    /** @type {?} */
    Agg.prototype.computedCols;
}
/** @enum {string} */
var AggregationResultSetType = {
    Table: 'Table',
    CroosTable: 'CroosTable',
};
export { AggregationResultSetType };
/**
 * 数据服务实际返回的结构
 * @record
 */
export function AggResult() { }
if (false) {
    /** @type {?|undefined} */
    AggResult.prototype.tableData;
    /** @type {?|undefined} */
    AggResult.prototype.dimensions;
    /** @type {?|undefined} */
    AggResult.prototype.columns;
    /**
     * ?
     * @type {?|undefined}
     */
    AggResult.prototype.type;
    /**
     * ?
     * @type {?|undefined}
     */
    AggResult.prototype.getResultSet;
    /**
     * ?
     * @type {?|undefined}
     */
    AggResult.prototype.data;
}
/**
 * @record
 */
export function Result() { }
if (false) {
    /** @type {?} */
    Result.prototype.data;
    /** @type {?} */
    Result.prototype.columns;
}
/**
 * widget component 需要外部传入的数据格式。上面的服务符合此结构。
 * @record
 */
export function DataWithDims() { }
if (false) {
    /** @type {?|undefined} */
    DataWithDims.prototype.dimensions;
    /** @type {?|undefined} */
    DataWithDims.prototype.tableData;
}
/**
 * 获取数据时传服务端的 dp + value
 */
var /**
 * 获取数据时传服务端的 dp + value
 */
DpValue = /** @class */ (function () {
    function DpValue() {
    }
    /**
     * @param {?} dpValue
     * @return {?}
     */
    DpValue.toDto = /**
     * @param {?} dpValue
     * @return {?}
     */
    function (dpValue) {
        return (/** @type {?} */ ({
            dataParamId: dpValue.dpId,
            value: dpValue.value
        }));
    };
    return DpValue;
}());
/**
 * 获取数据时传服务端的 dp + value
 */
export { DpValue };
if (false) {
    /** @type {?} */
    DpValue.prototype.dpId;
    /** @type {?} */
    DpValue.prototype.value;
}
/**
 * @record
 */
export function DpValueDto() { }
if (false) {
    /** @type {?} */
    DpValueDto.prototype.dataParamId;
    /** @type {?} */
    DpValueDto.prototype.value;
}
/**
 * @record
 */
export function RuntimeAggOptionDto() { }
if (false) {
    /** @type {?} */
    RuntimeAggOptionDto.prototype.dimensions;
    /** @type {?} */
    RuntimeAggOptionDto.prototype.indicators;
}
var Indicator = /** @class */ (function () {
    function Indicator() {
        this.aggFn = 4;
    }
    return Indicator;
}());
export { Indicator };
if (false) {
    /** @type {?} */
    Indicator.prototype.dimName;
    /** @type {?} */
    Indicator.prototype.aggFn;
}
var RuntimeAggOption = /** @class */ (function () {
    function RuntimeAggOption() {
        this.dimensions = [];
        this.indicators = [new Indicator()];
    }
    /**
     * @param {?} runtimeAgg
     * @return {?}
     */
    RuntimeAggOption.toDto = /**
     * @param {?} runtimeAgg
     * @return {?}
     */
    function (runtimeAgg) {
        if (!runtimeAgg)
            return;
        return (/** @type {?} */ ({
            dimensions: runtimeAgg.dimensions,
            indicators: runtimeAgg.indicators.map((/**
             * @param {?} ind
             * @return {?}
             */
            function (ind) { return ({
                type: ind.aggFn,
                name: ind.dimName
            }); }))
        }));
    };
    return RuntimeAggOption;
}());
export { RuntimeAggOption };
if (false) {
    /** @type {?} */
    RuntimeAggOption.prototype.dimensions;
    /** @type {?} */
    RuntimeAggOption.prototype.indicators;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGF0YS50eXBlLmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGdzcHdpZGdldC91dGlsLyIsInNvdXJjZXMiOlsibGliL3R5cGVzL2RhdGEudHlwZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7OztBQUFBLE9BQU8sRUFBRSxTQUFTLEVBQUUsWUFBWSxFQUFFLE1BQU0sYUFBYSxDQUFDO0FBQ3RELE9BQU8sRUFBRSxPQUFPLEVBQUUsT0FBTyxFQUFFLE1BQU0scUJBQXFCLENBQUM7Ozs7QUFHdkQsbUNBV0M7OztJQVZDLDhCQUFjOztJQUNkLDZCQUFhOztJQUNiLDZCQUFnRTs7SUFDaEUsK0JBQWU7O0lBQ2YsOEJBQWM7O0lBQ2Qsb0NBQW9COztJQUNwQixnQ0FBa0I7O0lBQ2xCLGdDQUFpQjs7SUFDakIsaUNBQWtCOztJQUNsQixrQ0FBbUI7OztBQUdyQjs7O0lBU0UsaUJBQ1MsWUFBcUI7UUFBckIsaUJBQVksR0FBWixZQUFZLENBQVM7UUFQOUIsYUFBUSxHQUEyQixFQUFFLENBQUE7UUFDckMsV0FBTSxHQUE2QixFQUFFLENBQUE7SUFPbEMsQ0FBQztJQUNOLGNBQUM7QUFBRCxDQUFDLEFBWkQsSUFZQzs7Ozs7SUFYQyxxQkFBVzs7SUFDWCx1QkFBYTs7SUFDYiwyQkFBcUM7O0lBQ3JDLHlCQUFxQzs7SUFDckMsNEJBQWtCOztJQUNsQiwwQkFBZ0I7O0lBQ2hCLDZCQUFpQjs7SUFHZiwrQkFBNEI7Ozs7O0FBR2hDLGtDQUdDOzs7SUFGQyw2QkFBYTs7SUFDYiw0QkFBWTs7Ozs7QUFJZCxrQ0FRQzs7O0lBUEMsMEJBQVc7O0lBQ1gsZ0NBQVM7O0lBQ1QsNEJBQTBDOztJQUMxQyw4QkFBZTs7SUFDZixpQ0FBa0I7O0lBQ2xCLDRCQUFhOztJQUNiLDZCQUFjOzs7OztBQUtoQjs7OztJQUFBO1FBSUUsU0FBSSxHQUEyQyxhQUFhLENBQUE7UUFFNUQsWUFBTyxHQUFZLElBQUksQ0FBQTtJQXFCekIsQ0FBQzs7Ozs7SUFuQlEsZUFBSzs7OztJQUFaLFVBQWMs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QzFCLENBQUM7SUFDSCx1QkFBQztBQUFELENBQUMsQUFiRCxJQWFDOzs7O0lBWkMsc0NBQXlCOztJQUN6QixzQ0FBMkMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBjYW1lbENhc2UsIGNvbnN0YW50Q2FzZSB9IGZyb20gJ2NoYW5nZS1jYXNlJztcbmltcG9ydCB7IGRlY3J5cHQsIGVuY3J5cHQgfSBmcm9tICcuLi91dGlscy9lbmNyeXB0aW9uJztcbmltcG9ydCB7IEkxOG5WYWx1ZSB9IGZyb20gJy4vY29tbW9uLnR5cGUnO1xuXG5leHBvcnQgaW50ZXJmYWNlIFByb3ZpZGVyUGFyYW0ge1xuICBsYWJlbD86IHN0cmluZ1xuICBuYW1lPzogc3RyaW5nXG4gIHR5cGU/OiAnaW5wdXQnIHwgJ3RleHRhcmVhJyB8ICdwYXNzd29yZCcgfCAnY2hlY2tib3gnIHwgJ3NlbGVjdCdcbiAgc29ydE5vPzogbnVtYmVyXG4gIHZhbHVlPzogc3RyaW5nXG4gIHBsYWNlaG9sZGVyPzogc3RyaW5nXG4gIG9wdGlvbnM/OiBzdHJpbmdbXVxuICBjaGVja2VkPzogYm9vbGVhblxuICByZXF1aXJlZD86IGJvb2xlYW5cbiAgZW5jcnlwdGVkPzogYm9vbGVhblxufVxuLy8gVE9ETzog5pWw5o2u5rqQ55u45YWz55qE77yM6KaB5pS+5ZyoIGRhc2hib2FyZCBjb3JlIOS4reWQl1xuZXhwb3J0IGNsYXNzIERhdGFzcmMge1xuICBpZD86IHN0cmluZ1xuICBuYW1lPzogc3RyaW5nXG4gIGkxOG5OYW1lOiB7IFtrZXk6IHN0cmluZ106IGFueSB9ID0ge31cbiAgY29uZmlnPzogeyBbbmFtZTogc3RyaW5nXTogYW55IH0gPSB7fVxuICBncm91cE5hbWU/OiBzdHJpbmdcbiAgY3JlYXRvcj86IHN0cmluZ1xuICBjcmVhdGVUaW1lPzogRGF0ZVxuXG4gIGNvbnN0cnVjdG9yIChcbiAgICBwdWJsaWMgcHJvdmlkZXJOYW1lPzogc3RyaW5nXG4gICkge31cbn1cbmV4cG9ydCBpbnRlcmZhY2UgRGF0YVByb3ZpZGVyIHtcbiAgbGFiZWw6IHN0cmluZ1xuICBuYW1lOiBzdHJpbmdcbn1cblxuXG5leHBvcnQgaW50ZXJmYWNlIERhdGFQYXJhbUR0byB7XG4gIGlkPzogc3RyaW5nXG4gIGkxOG5OYW1lP1xuICB0eXBlPzogJ3F1ZXJ5UGFyYW0nIHwgJ3BhdGhQYXJhbScgfCAnYm9keSdcbiAgY29uZmlnPzogc3RyaW5nXG4gIGRhdGFzZXRJZD86IHN0cmluZ1xuICBuYW1lPzogc3RyaW5nXG4gIHZhbHVlPzogc3RyaW5nXG59XG4vKipcbiAqIOWPluaVsOWPguaVsFxuICovXG5leHBvcnQgY2xhc3MgRGF0YVBhcmFtIHtcbiAgaWQ/OiBzdHJpbmdcbiAgbmFtZT86IHN0cmluZ1xuICBpMThuTmFtZT9cbiAgdHlwZT86ICdRVUVSWV9QQVJBTScgfCAnUEFUSF9QQVJBTScgfCAnQk9EWScgPSAnUVVFUllfUEFSQU0nXG4gIGNvbmZpZz86IGFueVxuICBkZWZhdWx0Pzogc3RyaW5nID0gbnVsbFxuICBkYXRhc2V0SWQ/OiBzdHJpbmdcbiAgc3RhdGljIFRvRHRvIChkcDogRGF0YVBhcmFtKSB7XG4gICAgY29uc3QgeyBpMThuTmFtZSwgdHlwZSwgY29uZmlnLCBpZCB9ID0gZHBcbiAgICByZXR1cm4ge1xuICAgICAgaWQsIGkxOG5OYW1lLCBjb25maWcsXG4gICAgICB0eXBlOiBjYW1lbENhc2UodHlwZSksXG4gICAgICB2YWx1ZTogZHAuZGVmYXVsdCxcbiAgICB9IGFzIERhdGFQYXJhbUR0b1xuICB9XG4gIHN0YXRpYyBGcm9tRHRvIChkcER0bzogRGF0YVBhcmFtRHRvKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIGlkOiBkcER0by5pZCxcbiAgICAgIGkxOG5OYW1lOiBkcER0by5pMThuTmFtZSxcbiAgICAgIHR5cGU6IGNvbnN0YW50Q2FzZShkcER0by50eXBlKSxcbiAgICAgIGNvbmZpZzogZHBEdG8uY29uZmlnLFxuICAgICAgZGF0YXNldElkOiBkcER0by5kYXRhc2V0SWQsXG4gICAgICBuYW1lOiBkcER0by5uYW1lLFxuICAgICAgZGVmYXVsdDogZHBEdG8udmFsdWUsXG4gICAgfSBhcyBEYXRhUGFyYW1cbiAgfVxufVxuZXhwb3J0IGludGVyZmFjZSBEYXRhc2V0RHRvIHtcbiAgaWQ/OiBzdHJpbmcsXG4gIG5hbWU/OiBzdHJpbmcsXG4gIGRhdGFzb3VyY2VJZD86IHN0cmluZyxcbiAgaTE4bk5hbWU/Ontba2V5OnN0cmluZ106YW55fSxcbiAgZGF0YXNvdXJjZU5hbWU/OiBzdHJpbmdcbiAgZGltZW5zaW9ucz86IERpbWVuc2lvbltdXG4gIGNyZWF0aW9uVGltZT86IERhdGVcbiAgbWV0aG9kPzogc3RyaW5nXG4gIHBhcmFtZXRlcnM/OiBEYXRhc2V0UGFyYW1ldGVyW11cbiAgY29uZmlnPzogc3RyaW5nXG4gIGRhdGFQYXJhbUR0bz86IERhdGFQYXJhbUR0b1tdXG59XG5leHBvcnQgY2xhc3MgRGF0YXNldFBhcmFtZXRlciB7XG4gIGNvbnN0cnVjdG9yIChcbiAgICBwdWJsaWMgbmFtZTogc3RyaW5nLFxuICAgIHB1YmxpYyB2YWx1ZTogc3RyaW5nLFxuICAgIHB1YmxpYyBzb3J0Tm8/OiBudW1iZXIsXG4gICAgcHVibGljIGlzRXhwcmVzc2lvbiA9IHRydWVcbiAgICApIHsgfVxuICAvLyBuYW1lPzogc3RyaW5nXG4gIC8vIHZhbHVlPzogc3RyaW5nXG4gIC8vIGlzRXhwcmVzc2lvbiA9IHRydWVcbiAgLy8gc29ydE5vPzogbnVtYmVyXG59XG5pbnRlcmZhY2UgQW55S2V5IHtcbiAgW2tleTogc3RyaW5nXTogYW55XG59XG5leHBvcnQgY2xhc3MgRGF0YXNldCBpbXBsZW1lbnRzIEFueUtleSB7XG4gIGlkPzogc3RyaW5nXG4gIG5hbWU/OiBzdHJpbmdcbiAgcHJvZHVjdD86IHN0cmluZ1xuICBtb2R1bGU/OiBzdHJpbmdcbiAgY3JlYXRvcj86IHN0cmluZ1xuICBtb2RpZmllcj86IHN0cmluZ1xuICBjcmVhdGlvblRpbWU/OiBEYXRlXG4gIG1vZGlmeVRpbWU/OiBEYXRlXG4gIGRhdGFzcmNJZD86IHN0cmluZ1xuICBkYXRhc3JjTmFtZT86IHN0cmluZ1xuICBpMThuTmFtZT86IHsgW2tleTogc3RyaW5nXTogYW55IH0gXG4gIC8vIGRhdGFzcmM/OiBEYXRhc3JjXG4gIGNvbmZpZz86IHtcbiAgICBba2V5OiBzdHJpbmddOiBhbnlcbiAgfSA9IHt9XG4gIGNvbHM6IHtcbiAgICBkaW1lbnNpb25zPzogRGltZW5zaW9uW11cbiAgICBtZWFzdXJlcz86IERpbWVuc2lvbltdLFxuICB9ID0ge1xuICAgIGRpbWVuc2lvbnM6IFtdLFxuICAgIG1lYXN1cmVzOiBbXSxcbiAgICAvLyBjb21wdXRlZEZpZWxkczogW10sXG4gICAgLy8gZmlsdGVyczogW11cbiAgfVxuICBkYXRhUGFyYW1zPzogRGF0YVBhcmFtW10gPSBbXVxuXG4gIHN0YXRpYyBjcmVhdGUgKCkge1xuICAgIHJldHVybiBuZXcgRGF0YXNldCgpXG4gIH1cbiAgc3RhdGljIHRvRHRvIChkYXRhc2V0OiBEYXRhc2V0KTogRGF0YXNldER0byB7XG4gICAgY29uc3QgeyBpZCwgbmFtZSwgZGF0YXNyY0lkLCBkYXRhc3JjTmFtZSxcbiAgICAgIGNvbHMsIGNyZWF0aW9uVGltZSwgY29uZmlnLCBkYXRhUGFyYW1zLGkxOG5OYW1lIH0gPSBkYXRhc2V0XG4gICAgcmV0dXJuIHtcbiAgICAgIGlkLCBuYW1lLCBjcmVhdGlvblRpbWUsaTE4bk5hbWUsXG4gICAgICBkYXRhc291cmNlSWQ6IGRhdGFzcmNJZCxcbiAgICAgIGRhdGFzb3VyY2VOYW1lOiBkYXRhc3JjTmFtZSxcbiAgICAgIGRpbWVuc2lvbnM6IGNvbHMuZGltZW5zaW9ucyxcbiAgICAgIGNvbmZpZzogZW5jcnlwdChKU09OLnN0cmluZ2lmeShjb25maWcpKSxcbiAgICAgIGRhdGFQYXJhbUR0bzogZGF0YVBhcmFtcy5tYXAoRGF0YVBhcmFtLlRvRHRvKVxuICAgIH1cbiAgfVxuICBzdGF0aWMgZnJvbUR0byAoZGF0YXNldER0bzogRGF0YXNldER0byk6IERhdGFzZXQge1xuICAgIGNvbnN0IHsgaWQsIG5hbWUsIGRhdGFzb3VyY2VJZCwgZGF0YXNvdXJjZU5hbWUsIGRpbWVuc2lvbnMsXG4gICAgICBjcmVhdGlvblRpbWUsIG1ldGhvZCwgcGFyYW1ldGVycyxpMThuTmFtZSxcbiAgICAgIGNvbmZpZywgZGF0YVBhcmFtRHRvIH0gPSBkYXRhc2V0RHRvXG4gICAgbGV0IHBhcnNlZENvbmZpZyA9IG51bGxcbiAgICB0cnkge1xuICAgICAgcGFyc2VkQ29uZmlnID0gSlNPTi5wYXJzZShkZWNyeXB0KGNvbmZpZykpXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICB9XG4gICAgaWYgKCFwYXJzZWRDb25maWcpIHBhcnNlZENvbmZpZyA9IHt9XG4gICAgcmV0dXJuIHtcbiAgICAgIC8vIC4uLmRhdGFzZXREdG8sXG4gICAgICBpZCwgbmFtZSwgY3JlYXRpb25UaW1lLGkxOG5OYW1lLFxuICAgICAgZGF0YXNyY0lkOiBkYXRhc291cmNlSWQsXG4gICAgICBkYXRhc3JjTmFtZTogZGF0YXNvdXJjZU5hbWUsXG4gICAgICBjb2xzOiB7IGRpbWVuc2lvbnMgfSxcbiAgICAgIGNvbmZpZzogcGFyc2VkQ29uZmlnLFxuICAgICAgZGF0YVBhcmFtczogZGF0YVBhcmFtRHRvID8gZGF0YVBhcmFtRHRvLm1hcChEYXRhUGFyYW0uRnJvbUR0bykgOiBbXSxcbiAgICB9XG4gIH1cbn1cblxuZXhwb3J0IHR5cGUgRGltZW5zaW9uVHlwZU5hbWUgPSAnU1RSSU5HJyB8ICdURVhUJ1xuICB8ICdTSE9SVCcgfCAnTE9ORycgfCAnRkxPQVQnIHwgJ0RPVUJMRSdcbiAgfCAnREVDSU1BTCcgfCAnSU5URUdFUicgfCAnSU5URVRFUicgfCAnREFURVRJTUUnXG4gIHwgJ0JZVEUnIHwgJ0JZVEVTJyB8ICdCT09MRUFOJyB8ICdVTktOT1dOJ1xuZXhwb3J0IGNsYXNzIERpbWVuc2lvbiB7XG4gIG5hbWU/OiBzdHJpbmdcbiAgbGFiZWw/OiBzdHJpbmdcbiAgaTE4bkxhYmVsPzogSTE4blZhbHVlIHwgc3RyaW5nXG4gIHR5cGU/OiBudW1iZXJcbiAgdHlwZU5hbWU/OiBEaW1lbnNpb25UeXBlTmFtZVxuICBqYXZhQ2xhc3NOYW1lPzogc3RyaW5nXG4gIGdyb3VwTmFtZT86IHN0cmluZ1xuICBjb21tZW50Pzogc3RyaW5nXG4gIG5vdE51bGw/OiBib29sZWFuXG59XG5leHBvcnQgaW50ZXJmYWNlIEZpbHRlciBleHRlbmRzIERpbWVuc2lvbiB7XG4gIGhhc1ZhbHVlPzogYm9vbGVhblxuICAvLyBpc09wZW4/OiBib29sZWFuXG4gIGZpbHRlckV4cHJlc3Npb24/OiBzdHJpbmdcbn1cbmV4cG9ydCBlbnVtIENvbXB1dGVkVHlwZSB7XG4gIENvdW50ID0gJ0NvdW50JyxcbiAgU3VtID0gJ1N1bScsXG4gIE1heCA9ICdNYXgnLFxuICBNaW4gPSAnTWluJyxcbiAgQXZnID0gJ0F2ZycsXG4gIEV4cHJlc3Npb24gPSAnRXhwcmVzc2lvbicsXG59XG5leHBvcnQgZW51bSBBZ2dUeXBlIHtcbiAgVGFibGUgPSAnVGFibGUnLFxuICBDcm9vc1RhYmxlID0gJ0Nyb29zVGFibGUnLFxufVxuZXhwb3J0IGNsYXNzIENvbXB1dGVkQ29sIGV4dGVuZHMgRGltZW5zaW9uIHtcbiAgY29tcHV0ZVR5cGUgPSBDb21wdXRlZFR5cGUuRXhwcmVzc2lvblxuICBjb25zdHJ1Y3RvciAoXG4gICAgcHJpdmF0ZSBleHByZXNzaW9uPzogc3RyaW5nXG4gICkge1xuICAgIHN1cGVyKClcbiAgfVxufVxuZXhwb3J0IGludGVyZmFjZSBDb2wgZXh0ZW5kcyBGaWx0ZXIge1xufVxuZXhwb3J0IGludGVyZmFjZSBSb3cgZXh0ZW5kcyBGaWx0ZXIge1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIEFnZ0R0byB7XG4gIGlkPzogc3RyaW5nXG4gIGRhdGFTZXRJZD86IHN0cmluZ1xuICBkYXRhU2V0TmFtZT86IHN0cmluZ1xuICByZXNvdXJjZT86IHN0cmluZ1xuICByZXNvdXJjZUlkPzogc3RyaW5nXG4gIGFnZ3JlZ2F0aW9uVHlwZT86IEFnZ1R5cGVcbiAgY29sdW1uQ29uZmlncz86IENvbFtdXG4gIHJvd0NvbmZpZ3M/OiBSb3dbXVxuICBmaWx0ZXJDb25maWdzPzogRmlsdGVyW11cbiAgY29tcHV0ZWRFeHByZXNzaW9uQ29uZmlncz86IENvbXB1dGVkQ29sW11cbn1cbmV4cG9ydCBjbGFzcyBBZ2cge1xuICBpZD86IHN0cmluZ1xuICBkYXRhc2V0SWQ/OiBzdHJpbmdcbiAgZGF0YXNldE5hbWU/OiBzdHJpbmdcbiAgcmVzb3VyY2U/OiBzdHJpbmdcbiAgcmVzb3VyY2VJZD86IHN0cmluZ1xuICBhZ2dUeXBlPzogQWdnVHlwZVxuICBjb2xzPzogQ29sW10gPSBbXVxuICByb3dzPzogUm93W10gPSBbXVxuICBmaWx0ZXJzPzogRmlsdGVyW10gPSBbXVxuICBjb21wdXRlZENvbHM/OiBDb21wdXRlZENvbFtdID0gW11cblxuICBzdGF0aWMgdG9EdG8gKGFnZzogQWdnKSB7XG4gICAgY29uc3QgeyBpZCwgZGF0YXNldElkLCByZXNvdXJjZSwgcmVzb3VyY2VJZCxcbiAgICAgIGFnZ1R5cGUsIGNvbHMsIHJvd3MsIGZpbHRlcnMsIGNvbXB1dGVkQ29sc1xuICAgIH0gPSBhZ2dcbiAgICByZXR1cm4ge1xuICAgICAgaWQsXG4gICAgICBkYXRhU2V0SWQ6IGRhdGFzZXRJZCxcbiAgICAgIHJlc291cmNlLFxuICAgICAgcmVzb3VyY2VJZCxcbiAgICAgIGFnZ3JlZ2F0aW9uVHlwZTogYWdnVHlwZSxcbiAgICAgIGNvbHVtbkNvbmZpZ3M6IGNvbHMsXG4gICAgICByb3dDb25maWdzOiByb3dzLFxuICAgICAgZmlsdGVyQ29uZmlnczogZmlsdGVycyxcbiAgICAgIGNvbXB1dGVkRXhwcmVzc2lvbkNvbmZpZ3M6IGNvbXB1dGVkQ29sc1xuICAgIH0gYXMgQWdnRHRvXG4gIH1cbiAgc3RhdGljIGZyb21EdG8gKGFnZ0R0bzogQWdnRHRvKSB7XG4gICAgY29uc3QgeyBpZCwgZGF0YVNldElkLCBkYXRhU2V0TmFtZSwgcmVzb3VyY2UsIHJlc291cmNlSWQsXG4gICAgICBhZ2dyZWdhdGlvblR5cGUsIGNvbHVtbkNvbmZpZ3MsIHJvd0NvbmZpZ3MsXG4gICAgICBmaWx0ZXJDb25maWdzLCBjb21wdXRlZEV4cHJlc3Npb25Db25maWdzIH0gPSBhZ2dEdG9cbiAgICByZXR1cm4ge1xuICAgICAgaWQsXG4gICAgICBkYXRhc2V0SWQ6IGRhdGFTZXRJZCxcbiAgICAgIGRhdGFzZXROYW1lOiBkYXRhU2V0TmFtZSxcbiAgICAgIHJlc291cmNlLFxuICAgICAgcmVzb3VyY2VJZCxcbiAgICAgIGFnZ1R5cGU6IGFnZ3JlZ2F0aW9uVHlwZSxcbiAgICAgIGNvbHM6IGNvbHVtbkNvbmZpZ3MsXG4gICAgICByb3dzOiByb3dDb25maWdzLFxuICAgICAgZmlsdGVyczogZmlsdGVyQ29uZmlncyxcbiAgICAgIGNvbXB1dGVkQ29sczogY29tcHV0ZWRFeHByZXNzaW9uQ29uZmlnc1xuICAgIH0gYXMgQWdnXG4gIH1cbn1cbmV4cG9ydCBlbnVtIEFnZ3JlZ2F0aW9uUmVzdWx0U2V0VHlwZSB7XG4gICAgVGFibGUgPSAnVGFibGUnLFxuICAgIENyb29zVGFibGUgPSAnQ3Jvb3NUYWJsZSdcbn1cbi8qKiDmlbDmja7mnI3liqHlrp7pmYXov5Tlm57nmoTnu5PmnoQgKi9cbmV4cG9ydCBpbnRlcmZhY2UgQWdnUmVzdWx0IHtcbiAgdGFibGVEYXRhPzogeyBba2V5OiBzdHJpbmddOiBhbnkgfVtdXG4gIGRpbWVuc2lvbnM/OiBEaW1lbnNpb25bXVxuICBjb2x1bW5zPzogc3RyaW5nW11cbiAgLyoqID8gKi9cbiAgdHlwZT86IEFnZ3JlZ2F0aW9uUmVzdWx0U2V0VHlwZVxuICAvKiogPyAqL1xuICBnZXRSZXN1bHRTZXQ/OiBSZXN1bHRcbiAgLyoqID8gKi9cbiAgZGF0YT86IHsgW2tleTogc3RyaW5nXTogeyBba2V5OiBzdHJpbmddOiBhbnkgfSB9XG59XG5leHBvcnQgaW50ZXJmYWNlIFJlc3VsdCB7XG4gIGRhdGE6IG9iamVjdFtdXG4gIGNvbHVtbnM6IERpbWVuc2lvbltdXG59XG4vKiogd2lkZ2V0IGNvbXBvbmVudCDpnIDopoHlpJbpg6jkvKDlhaXnmoTmlbDmja7moLzlvI/jgILkuIrpnaLnmoTmnI3liqHnrKblkIjmraTnu5PmnoTjgIIgKi9cbmV4cG9ydCBpbnRlcmZhY2UgRGF0YVdpdGhEaW1zIHtcbiAgZGltZW5zaW9ucz86IERpbWVuc2lvbltdXG4gIHRhYmxlRGF0YT86IGFueVtdXG59XG4vKipcbiAqIOiOt+WPluaVsOaNruaXtuS8oOacjeWKoeerr+eahCBkcCArIHZhbHVlXG4gKi9cbmV4cG9ydCBjbGFzcyBEcFZhbHVlIHtcbiAgZHBJZDogc3RyaW5nXG4gIHZhbHVlOiBhbnlcbiAgc3RhdGljIHRvRHRvIChkcFZhbHVlKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIGRhdGFQYXJhbUlkOiBkcFZhbHVlLmRwSWQsXG4gICAgICB2YWx1ZTogZHBWYWx1ZS52YWx1ZVxuICAgIH0gYXMgRHBWYWx1ZUR0b1xuICB9XG59XG5leHBvcnQgaW50ZXJmYWNlIERwVmFsdWVEdG8ge1xuICBkYXRhUGFyYW1JZDogc3RyaW5nXG4gIHZhbHVlOiBzdHJpbmdcbn1cblxuZXhwb3J0IGludGVyZmFjZSBSdW50aW1lQWdnT3B0aW9uRHRvIHtcbiAgZGltZW5zaW9uczogc3RyaW5nW11cbiAgaW5kaWNhdG9yczoge1xuICAgIHR5cGU6IG51bWJlclxuICAgIG5hbWU6IHN0cmluZ1xuICB9W11cbn1cbmV4cG9ydCBjbGFzcyBJbmRpY2F0b3Ige1xuICBkaW1OYW1lPzogc3RyaW5nXG4gIGFnZ0ZuPzogMSB8IDIgfCAzIHwgNCB8IDUgPSA0XG59XG5leHBvcnQgY2xhc3MgUnVudGltZUFnZ09wdGlvbiB7XG4gIGRpbWVuc2lvbnM6IHN0cmluZ1tdID0gW11cbiAgaW5kaWNhdG9yczogSW5kaWNhdG9yW10gPSBbbmV3IEluZGljYXRvcigpXVxuICBzdGF0aWMgdG9EdG8gKHJ1bnRpbWVBZ2c6IFJ1bnRpbWVBZ2dPcHRpb24pIHtcbiAgICBpZiAoIXJ1bnRpbWVBZ2cpIHJldHVyblxuICAgIHJldHVybiB7XG4gICAgICBkaW1lbnNpb25zOiBydW50aW1lQWdnLmRpbWVuc2lvbnMsXG4gICAgICBpbmRpY2F0b3JzOiBydW50aW1lQWdnLmluZGljYXRvcnMubWFwKGluZCA9PiAoe1xuICAgICAgICB0eXBlOiBpbmQuYWdnRm4sXG4gICAgICAgIG5hbWU6IGluZC5kaW1OYW1lXG4gICAgICB9KSlcbiAgICB9IGFzIFJ1bnRpbWVBZ2dPcHRpb25EdG9cbiAgfVxufVxuIl19