!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("mxgraph"),require("@ngx-translate/core"),require("@farris/ui-tree"),require("@farris/ui-common"),require("@farris/ui-datagrid-editors"),require("@farris/ui-treetable"),require("@farris/ui-input-group"),require("@farris/ui-language-textbox"),require("@farris/ui-number-spinner"),require("@farris/ui-switch"),require("@angular/common"),require("@angular/common/http"),require("@ecp-caf/caf-common"),require("@farris/ui-draggable"),require("@farris/ui-text"),require("@farris/ui-section"),require("@farris/ui-dialog"),require("@farris/ui-datagrid"),require("rxjs/operators"),require("@gsp-sys/rtf-common"),require("@edp-bif/common-api"),require("@farris/ui-loading"),require("@farris/ui-modal"),require("@farris/ui-notify"),require("@angular/forms"),require("rxjs"),require("@edp-aif/runtime-api"),require("@edp-aif/common-api"),require("@farris/ui-messager"),require("@farris/devkit"),require("@farris/command-services"),require("@angular/core")):"function"==typeof define&&define.amd?define("@edp-bif/runtime-api",["exports","mxgraph","@ngx-translate/core","@farris/ui-tree","@farris/ui-common","@farris/ui-datagrid-editors","@farris/ui-treetable","@farris/ui-input-group","@farris/ui-language-textbox","@farris/ui-number-spinner","@farris/ui-switch","@angular/common","@angular/common/http","@ecp-caf/caf-common","@farris/ui-draggable","@farris/ui-text","@farris/ui-section","@farris/ui-dialog","@farris/ui-datagrid","rxjs/operators","@gsp-sys/rtf-common","@edp-bif/common-api","@farris/ui-loading","@farris/ui-modal","@farris/ui-notify","@angular/forms","rxjs","@edp-aif/runtime-api","@edp-aif/common-api","@farris/ui-messager","@farris/devkit","@farris/command-services","@angular/core"],t):t((e["edp-bif"]=e["edp-bif"]||{},e["edp-bif"]["runtime-api"]={}),e.mxgraphFactory,e.core,e.uiTree,e.uiCommon,e.uiDatagridEditors,e.uiTreetable,e.uiInputGroup,e.uiLanguageTextbox,e.uiNumberSpinner,e.uiSwitch,e.ng.common,e.ng.common.http,e.cafCommon,e.uiDraggable,e.uiText,e.uiSection,e.uiDialog,e.uiDatagrid,e.rxjs.operators,e.rtfCommon,e.commonApi,e.uiLoading,e.uiModal,e.uiNotify,e.ng.forms,e.rxjs,e.runtimeApi,e.commonApi$1,e.uiMessager,e.devkit,e.commandServices,e.ng.core)}(this,function(exports,mxgraphFactory,core,uiTree,uiCommon,uiDatagridEditors,uiTreetable,uiInputGroup,uiLanguageTextbox,uiNumberSpinner,uiSwitch,common,http,cafCommon,uiDraggable,uiText,uiSection,uiDialog,uiDatagrid,operators,rtfCommon,commonApi,uiLoading,uiModal,uiNotify,forms,rxjs,runtimeApi,commonApi$1,uiMessager,devkit,commandServices,core$1){"use strict";mxgraphFactory=mxgraphFactory&&mxgraphFactory.hasOwnProperty("default")?mxgraphFactory["default"]:mxgraphFactory,window.mxBasePath=window.mxBasePath||"/platform/runtime/common/web/@edp-pmf/mxgraph",window.mxLoadResources=window.mxLoadResources||undefined,window.mxForceIncludes=window.mxForceIncludes||undefined,window.mxResourceExtension=window.mxResourceExtension||undefined,window.mxLoadStylesheets=window.mxLoadStylesheets||undefined,window.imageBasePath=window.imageBasePath||undefined,window.mxLanguage=window.mxLanguage||undefined,window.mxDefaultLanguage=window.mxDefaultLanguage||undefined,window.mxLanguages=window.mxLanguages||undefined;var mxgraph=mxgraphFactory({}),mxDefaultKeyHandlerType=mxgraph.mxDefaultKeyHandler,mxDefaultPopupMenuType=mxgraph.mxDefaultPopupMenu,mxDefaultToolbarType=mxgraph.mxDefaultToolbar,mxEditorType=mxgraph.mxEditor,mxCellHighlightType=mxgraph.mxCellHighlight,mxCellMarkerType=mxgraph.mxCellMarker,mxCellTrackerType=mxgraph.mxCellTracker,mxConnectionHandlerType=mxgraph.mxConnectionHandler,mxConstraintHandlerType=mxgraph.mxConstraintHandler,mxEdgeHandlerType=mxgraph.mxEdgeHandler,mxEdgeSegmentHandlerType=mxgraph.mxEdgeSegmentHandler,mxElbowEdgeHandlerType=mxgraph.mxElbowEdgeHandler,mxGraphHandlerType=mxgraph.mxGraphHandler,mxHandleType=mxgraph.mxHandle,mxKeyHandlerType=mxgraph.mxKeyHandler,mxPanningHandlerType=mxgraph.mxPanningHandler,mxPopupMenuHandlerType=mxgraph.mxPopupMenuHandler,mxRubberbandType=mxgraph.mxRubberband,mxSelectionCellsHandlerType=mxgraph.mxSelectionCellsHandler,mxTooltipHandlerType=mxgraph.mxTooltipHandler,mxVertexHandlerType=mxgraph.mxVertexHandler,mxCellCodecType=mxgraph.mxCellCodec,mxChildChangeCodecType=mxgraph.mxChildChangeCodec,mxDefaultKeyHandlerCodecType=mxgraph.mxDefaultKeyHandlerCodec,mxDefaultPopupMenuCodecType=mxgraph.mxDefaultPopupMenuCodec,mxDefaultToolbarCodecType=mxgraph.mxDefaultToolbarCodec,mxEditorCodecType=mxgraph.mxEditorCodec,mxGenericChangeCodecType=mxgraph.mxGenericChangeCodec,mxGraphCodecType=mxgraph.mxGraphCodec,mxGraphViewCodecType=mxgraph.mxGraphViewCodec,mxModelCodecType=mxgraph.mxModelCodec,mxObjectCodecType=mxgraph.mxObjectCodec,mxRootChangeCodecType=mxgraph.mxRootChangeCodec,mxStylesheetCodecType=mxgraph.mxStylesheetCodec,mxTerminalChangeCodecType=mxgraph.mxTerminalChangeCodec,mxCircleLayoutType=mxgraph.mxCircleLayout,mxCompactTreeLayoutType=mxgraph.mxCompactTreeLayout,mxCompositeLayoutType=mxgraph.mxCompositeLayout,mxEdgeLabelLayoutType=mxgraph.mxEdgeLabelLayout,mxFastOrganicLayoutType=mxgraph.mxFastOrganicLayout,mxGraphLayoutType=mxgraph.mxGraphLayout,mxParallelEdgeLayoutType=mxgraph.mxParallelEdgeLayout,mxPartitionLayoutType=mxgraph.mxPartitionLayout,mxRadialTreeLayoutType=mxgraph.mxRadialTreeLayout,mxStackLayoutType=mxgraph.mxStackLayout,mxHierarchicalLayoutType=mxgraph.mxHierarchicalLayout,mxSwimlaneLayoutType=mxgraph.mxSwimlaneLayout,mxGraphAbstractHierarchyCellType=mxgraph.mxGraphAbstractHierarchyCell,mxGraphHierarchyEdgeType=mxgraph.mxGraphHierarchyEdge,mxGraphHierarchyModelType=mxgraph.mxGraphHierarchyModel,mxGraphHierarchyNodeType=mxgraph.mxGraphHierarchyNode,mxSwimlaneModelType=mxgraph.mxSwimlaneModel,mxCoordinateAssignmentType=mxgraph.mxCoordinateAssignment,mxHierarchicalLayoutStageType=mxgraph.mxHierarchicalLayoutStage,mxMedianHybridCrossingReductionType=mxgraph.mxMedianHybridCrossingReduction,mxMinimumCycleRemoverType=mxgraph.mxMinimumCycleRemover,mxSwimlaneOrderingType=mxgraph.mxSwimlaneOrdering,mxCellType=mxgraph.mxCell,mxCellPathType=mxgraph.mxCellPath,mxGeometryType=mxgraph.mxGeometry,mxGraphModelType=mxgraph.mxGraphModel,renderingHintType=mxgraph.renderingHint,mxActorType=mxgraph.mxActor,mxArrowType=mxgraph.mxArrow,mxArrowConnectorType=mxgraph.mxArrowConnector,mxCloudType=mxgraph.mxCloud,mxConnectorType=mxgraph.mxConnector,mxCylinderType=mxgraph.mxCylinder,mxDoubleEllipseType=mxgraph.mxDoubleEllipse,mxEllipseType=mxgraph.mxEllipse,mxHexagonType=mxgraph.mxHexagon,mxImageShapeType=mxgraph.mxImageShape,mxLabelType=mxgraph.mxLabel,mxLineType=mxgraph.mxLine,mxMarkerType=mxgraph.mxMarker,mxPolylineType=mxgraph.mxPolyline,mxRectangleShapeType=mxgraph.mxRectangleShape,mxRhombusType=mxgraph.mxRhombus,mxShapeType=mxgraph.mxShape,mxStencilType=mxgraph.mxStencil,mxStencilRegistryType=mxgraph.mxStencilRegistry,mxSwimlaneType=mxgraph.mxSwimlane,mxTextType=mxgraph.mxText,mxTriangleType=mxgraph.mxTriangle,mxAbstractCanvas2DType=mxgraph.mxAbstractCanvas2D,mxAnimationType=mxgraph.mxAnimation,mxAutoSaveManagerType=mxgraph.mxAutoSaveManager,mxClipboardType=mxgraph.mxClipboard,mxConstantsType=mxgraph.mxConstants,mxDictionaryType=mxgraph.mxDictionary,mxDivResizerType=mxgraph.mxDivResizer,mxDragSourceType=mxgraph.mxDragSource,mxEffectsType=mxgraph.mxEffects,mxEventType=mxgraph.mxEvent,mxEventObjectType=mxgraph.mxEventObject,mxEventSourceType=mxgraph.mxEventSource,mxFormType=mxgraph.mxForm,mxGuideType=mxgraph.mxGuide,mxImageType=mxgraph.mxImage,mxImageBundleType=mxgraph.mxImageBundle,mxImageExportType=mxgraph.mxImageExport,mxLogType=mxgraph.mxLog,mxMorphingType=mxgraph.mxMorphing,mxMouseEventType=mxgraph.mxMouseEvent,mxObjectIdentityType=mxgraph.mxObjectIdentity,mxPanningManagerType=mxgraph.mxPanningManager,mxPointType=mxgraph.mxPoint,mxPopupMenuType=mxgraph.mxPopupMenu,mxRectangleType=mxgraph.mxRectangle,mxResourcesType=mxgraph.mxResources,mxSvgCanvas2DType=mxgraph.mxSvgCanvas2D,mxToolbarType=mxgraph.mxToolbar,mxUndoableEditType=mxgraph.mxUndoableEdit,mxUndoManagerType=mxgraph.mxUndoManager,mxUrlConverterType=mxgraph.mxUrlConverter,mxUtilsType=mxgraph.mxUtils,mxVmlCanvas2DType=mxgraph.mxVmlCanvas2D,mxWindowType=mxgraph.mxWindow,mxXmlCanvas2DType=mxgraph.mxXmlCanvas2D,mxXmlRequestType=mxgraph.mxXmlRequest,mxCellEditorType=mxgraph.mxCellEditor,mxCellOverlayType=mxgraph.mxCellOverlay,mxCellRendererType=mxgraph.mxCellRenderer,mxCellStateType=mxgraph.mxCellState,mxCellStatePreviewType=mxgraph.mxCellStatePreview,mxConnectionConstraintType=mxgraph.mxConnectionConstraint,mxEdgeStyleType=mxgraph.mxEdgeStyle,mxGraphType=mxgraph.mxGraph,mxGraphSelectionModelType=mxgraph.mxGraphSelectionModel,mxGraphViewType=mxgraph.mxGraphView,mxLayoutManagerType=mxgraph.mxLayoutManager,mxMultiplicityType=mxgraph.mxMultiplicity,mxOutlineType=mxgraph.mxOutline,mxPerimeterType=mxgraph.mxPerimeter,mxPrintPreviewType=mxgraph.mxPrintPreview,mxStyleRegistryType=mxgraph.mxStyleRegistry,mxStylesheetType=mxgraph.mxStylesheet,mxSwimlaneManagerType=mxgraph.mxSwimlaneManager,mxTemporaryCellStatesType=mxgraph.mxTemporaryCellStates,mxClientType=mxgraph.mxClient,extendStatics=(exports.MxGraphNS||(exports.MxGraphNS={}),function(e,t){return(extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)});function __extends(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}extendStatics(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var __assign=function(){return(__assign=Object.assign||function __assign(e){for(var t,r=1,o=arguments.length;r<o;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};function __values(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],o=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return{value:(e=e&&o>=e.length?void 0:e)&&e[o++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function __read(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var o,n,i=r.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(o=i.next()).done;)a.push(o.value)}catch(l){n={error:l}}finally{try{o&&!o.done&&(r=i["return"])&&r.call(i)}finally{if(n)throw n.error}}return a}function __spread(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(__read(arguments[t]));return e}var BillData=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.ResetBeforeLoadFrom=function(){t.prototype.ResetBeforeLoadFrom.call(this),this.name=null,this.value=null},e.prototype.ConvertToJsonObject=function(){var e=t.prototype.ConvertToJsonObject.call(this);return commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"name",this.name),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"value",this.value),e},e.prototype.LoadFromJsonObject=function(e){t.prototype.LoadFromJsonObject.call(this,e),this.name=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"name"),this.value=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"value")},e}(commonApi$1.JsonConvertableImpl),ManualCreationMode={Push:"Push",Pull:"Pull",SpecificPush:"SpecificPush",SpecificPull:"SpecificPull"},FormBillCreationProcessExecutorArgs=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.sourceVoEntityDataIds=[],e}return __extends(e,t),e.prototype.ResetBeforeLoadFrom=function(){t.prototype.ResetBeforeLoadFrom.call(this),this.billCreationProcessId=null,this.creationRuleInstanceId=null},e.prototype.ConvertToJsonObject=function(){var e=t.prototype.ConvertToJsonObject.call(this);return commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"billCreationProcessId",this.billCreationProcessId),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"creationRuleInstanceId",this.creationRuleInstanceId),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"manualCreationMode",this.manualCreationMode),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"sourceVoEntityDataIds",commonApi$1.BpmnModelJsonHelper.StringListToJson(this.sourceVoEntityDataIds)),e},e.prototype.LoadFromJsonObject=function(e){t.prototype.LoadFromJsonObject.call(this,e),this.billCreationProcessId=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"billCreationProcessId"),this.creationRuleInstanceId=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"creationRuleInstanceId"),this.manualCreationMode=ManualCreationMode[commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"creationRuleInstanceId")],this.sourceVoEntityDataIds=commonApi$1.BpmnModelJsonHelper.StringListFromJson(commonApi$1.BpmnModelJsonHelper.GetAttributeValue(e,"sourceVoEntityDataIds"))},e}(runtimeApi.FormCreationRuleExecutorArgs),FormGetBillCreationProcessEntityExArgs=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.ResetBeforeLoadFrom=function(){t.prototype.ResetBeforeLoadFrom.call(this),this.upBillVoId=null,this.downBillVoId=null,this.manualCreationMode=null},e.prototype.ConvertToJsonObject=function(){var e=t.prototype.ConvertToJsonObject.call(this);return commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"upBillVoId",this.upBillVoId),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"downBillVoId",this.downBillVoId),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"manualCreationMode",this.manualCreationMode),e},e.prototype.LoadFromJsonObject=function(e){t.prototype.LoadFromJsonObject.call(this,e),this.upBillVoId=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"upBillVoId"),this.downBillVoId=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"downBillVoId"),this.manualCreationMode=ManualCreationMode[commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"manualCreationMode")]},e}(commonApi$1.JsonConvertableImpl),FormGetBillCreationProcessEntityExResult=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.ResetBeforeLoadFrom=function(){t.prototype.ResetBeforeLoadFrom.call(this),this.billCreationProcessEntityExes=new Array},e.prototype.ConvertToJsonObject=function(){var e=t.prototype.ConvertToJsonObject.call(this);return commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"billCreationProcessEntityExes",this.billCreationProcessEntityExes),e},e.prototype.LoadFromJsonObject=function(e){t.prototype.LoadFromJsonObject.call(this,e),this.billCreationProcessEntityExes=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsList(e,"billCreationProcessEntityExes",commonApi.RtSlimBillCreationProcessEntityEx)},e}(commonApi$1.JsonConvertableImpl),GeneralTextIdWithDataId=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.ResetBeforeLoadFrom=function(){t.prototype.ResetBeforeLoadFrom.call(this),this.generalTextId=null,this.dataId=null},e.prototype.ConvertToJsonObject=function(){var e=t.prototype.ConvertToJsonObject.call(this);return commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"generalTextId",this.generalTextId),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"dataId",this.dataId),e},e.prototype.LoadFromJsonObject=function(e){t.prototype.LoadFromJsonObject.call(this,e),this.generalTextId=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"generalTextId"),this.dataId=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"dataId")},e}(commonApi$1.JsonConvertableImpl),BillDetailInfo=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.detailIds=[],e}return __extends(e,t),e.prototype.ResetBeforeLoadFrom=function(){t.prototype.ResetBeforeLoadFrom.call(this),this.detailCode=null,this.detailIds=[]},e.prototype.ConvertToJsonObject=function(){var e=t.prototype.ConvertToJsonObject.call(this);return commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"detailCode",this.detailCode),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"detailIds",commonApi$1.BpmnModelJsonHelper.StringListToJson(this.detailIds)),e},e.prototype.LoadFromJsonObject=function(e){t.prototype.LoadFromJsonObject.call(this,e),this.detailCode=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"detailCode"),this.detailIds=commonApi$1.BpmnModelJsonHelper.StringListFromJson(commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"detailIds"))},e}(commonApi$1.JsonConvertableImpl),BillItemInfo=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.billDetailInfos=[],e}return __extends(e,t),e.prototype.ResetBeforeLoadFrom=function(){t.prototype.ResetBeforeLoadFrom.call(this),this.itemId=null,this.billDetailInfos=[]},e.prototype.ConvertToJsonObject=function(){var e=t.prototype.ConvertToJsonObject.call(this);return commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"itemId",this.itemId),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"billDetailInfos",this.billDetailInfos),e},e.prototype.LoadFromJsonObject=function(e){t.prototype.LoadFromJsonObject.call(this,e),this.itemId=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"itemId"),this.billDetailInfos=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsList(e,"billDetailInfos",BillDetailInfo)},e}(commonApi$1.JsonConvertableImpl),BillChildInfo=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.billItemInfos=[],e}return __extends(e,t),e.prototype.ResetBeforeLoadFrom=function(){t.prototype.ResetBeforeLoadFrom.call(this),this.itemCode=null,this.billItemInfos=[]},e.prototype.ConvertToJsonObject=function(){var e=t.prototype.ConvertToJsonObject.call(this);return commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"itemCode",this.itemCode),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"billItemInfos",this.billItemInfos),e},e.prototype.LoadFromJsonObject=function(e){t.prototype.LoadFromJsonObject.call(this,e),this.itemCode=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"itemCode"),this.billItemInfos=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsList(e,"billItemInfos",BillItemInfo)},e}(commonApi$1.JsonConvertableImpl),TrackingMappingAssociation=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.ResetBeforeLoadFrom=function(){t.prototype.ResetBeforeLoadFrom.call(this),this.upBillTableCodePath=null,this.upBillDataIdPath=null,this.downBillTableCodePath=null,this.downBillDataIdPath=null},e.prototype.ConvertToJsonObject=function(){var e=t.prototype.ConvertToJsonObject.call(this);return commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"upBillTableCodePath",this.upBillTableCodePath),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"upBillDataIdPath",this.upBillDataIdPath),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"downBillTableCodePath",this.downBillTableCodePath),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"downBillDataIdPath",this.downBillDataIdPath),e},e.prototype.LoadFromJsonObject=function(e){t.prototype.LoadFromJsonObject.call(this,e),this.upBillTableCodePath=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"upBillTableCodePath"),this.upBillDataIdPath=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"upBillDataIdPath"),this.downBillTableCodePath=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"downBillTableCodePath"),this.downBillDataIdPath=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"downBillDataIdPath")},e}(commonApi$1.JsonConvertableImpl),BillDataInfo=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.billChildInfos=[],e}return __extends(e,t),e.prototype.ResetBeforeLoadFrom=function(){t.prototype.ResetBeforeLoadFrom.call(this),this.dataId=null,this.caption=null,this.summary=null,this.canContinueTracking=!1,this.trackingMappingAssociations=null,this.billChildInfos=[],this.curYear=null},e.prototype.ConvertToJsonObject=function(){var e=t.prototype.ConvertToJsonObject.call(this);return commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"dataId",this.dataId),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"caption",this.caption),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"summary",this.summary),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"canContinueTracking",this.canContinueTracking),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"trackingMappingAssociations",this.trackingMappingAssociations),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"billChildInfos",this.billChildInfos),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"curYear",this.curYear),e},e.prototype.LoadFromJsonObject=function(e){t.prototype.LoadFromJsonObject.call(this,e),this.dataId=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"dataId"),this.caption=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"caption"),this.summary=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"summary"),this.canContinueTracking=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsBoolean(e,"canContinueTracking"),this.trackingMappingAssociations=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsList(e,"trackingMappingAssociations",TrackingMappingAssociation),this.billChildInfos=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsList(e,"billChildInfos",BillChildInfo),this.curYear=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"curYear")},e}(commonApi$1.JsonConvertableImpl),BillInfo=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.billDataInfos=[],e.jointQueryMode=commonApi.JointQueryMode.DEFAULT,e}return __extends(e,t),e.prototype.ResetBeforeLoadFrom=function(){t.prototype.ResetBeforeLoadFrom.call(this),this.billTrackingSettings=null,this.schemaId=null,this.suCode=null,this.documentTypeId=null,this.bizKind=null,this.bizType=null,this.billDataInfos=[],this.jointQueryMode=commonApi.JointQueryMode.DEFAULT,this.jointQueryParameters=null,this.trackingSourceType=null},e.prototype.ConvertToJsonObject=function(){var e=t.prototype.ConvertToJsonObject.call(this);return commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"billTrackingSettings",this.billTrackingSettings),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"schemaId",this.schemaId),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"suCode",this.suCode),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"documentTypeId",this.documentTypeId),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"bizKind",this.bizKind),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"bizType",this.bizType),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"billDataInfos",this.billDataInfos),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"jointQueryMode",this.jointQueryMode),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"jointQueryParameters",this.jointQueryParameters),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"trackingSourceType",this.trackingSourceType),e},e.prototype.LoadFromJsonObject=function(e){t.prototype.LoadFromJsonObject.call(this,e),this.billTrackingSettings=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"billTrackingSettings"),this.schemaId=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"schemaId"),this.suCode=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"suCode"),this.documentTypeId=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"documentTypeId"),this.bizKind=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"bizKind"),this.bizType=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"bizType"),this.billDataInfos=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsList(e,"billDataInfos",BillDataInfo),this.jointQueryMode=commonApi.JointQueryMode[commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"jointQueryMode")],this.jointQueryParameters=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"jointQueryParameters"),this.trackingSourceType=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"trackingSourceType")},e}(commonApi$1.JsonConvertableImpl),CanTrackingInfo=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.billChildInfos=[],e.jointQueryMode=commonApi.JointQueryMode.DEFAULT,e}return __extends(e,t),e.prototype.ResetBeforeLoadFrom=function(){t.prototype.ResetBeforeLoadFrom.call(this),this.canUpTracking=!1,this.canDownTracking=!1,this.documentTypeId=null,this.bizKind=null,this.bizType=null,this.dataId=null,this.caption=null,this.summary=null,this.suCode=null,this.schemaId=null,this.billChildInfos=[],this.jointQueryMode=commonApi.JointQueryMode.DEFAULT,this.jointQueryParameters=null,this.trackingSourceType=null,this.curYear=null},e.prototype.ConvertToJsonObject=function(){var e=t.prototype.ConvertToJsonObject.call(this);return commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"canUpTracking",this.canUpTracking),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"canDownTracking",this.canDownTracking),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"documentTypeId",this.documentTypeId),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"bizKind",this.bizKind),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"bizType",this.bizType),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"dataId",this.dataId),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"caption",this.caption),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"summary",this.summary),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"suCode",this.suCode),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"schemaId",this.schemaId),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"billChildInfos",this.billChildInfos),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"jointQueryMode",this.jointQueryMode),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"jointQueryParameters",this.jointQueryParameters),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"trackingSourceType",this.trackingSourceType),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"curYear",this.curYear),e},e.prototype.LoadFromJsonObject=function(e){t.prototype.LoadFromJsonObject.call(this,e),this.canUpTracking=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsBoolean(e,"canUpTracking"),this.canDownTracking=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsBoolean(e,"canDownTracking"),this.documentTypeId=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"documentTypeId"),this.bizKind=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"bizKind"),this.bizType=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"bizType"),this.dataId=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"dataId"),this.caption=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"caption"),this.summary=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"summary"),this.suCode=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"suCode"),this.schemaId=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"schemaId"),this.billChildInfos=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsList(e,"billChildInfos",BillChildInfo),this.jointQueryMode=commonApi.JointQueryMode[commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"jointQueryMode")],this.jointQueryParameters=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"jointQueryParameters"),this.trackingSourceType=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"trackingSourceType"),this.curYear=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"curYear")},e}(commonApi$1.JsonConvertableImpl),DownBillInfo=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(BillInfo),GetBillsInfoArgs=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.billChildInfos=[],e}return __extends(e,t),e.prototype.ResetBeforeLoadFrom=function(){t.prototype.ResetBeforeLoadFrom.call(this),this.documentTypeId=null,this.bizKind=null,this.bizType=null,this.billDataId=null,this.billChildInfos=[],this.curYear=null},e.prototype.ConvertToJsonObject=function(){var e=t.prototype.ConvertToJsonObject.call(this);return commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"documentTypeId",this.documentTypeId),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"bizKind",this.bizKind),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"bizType",this.bizType),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"billDataId",this.billDataId),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"billChildInfos",this.billChildInfos),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"curYear",this.curYear),e},e.prototype.LoadFromJsonObject=function(e){t.prototype.LoadFromJsonObject.call(this,e),this.documentTypeId=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"documentTypeId"),this.bizKind=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"bizKind"),this.bizType=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"bizType"),this.billDataId=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"billDataId"),this.billChildInfos=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsList(e,"billChildInfos",BillChildInfo),this.curYear=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"curYear")},e}(commonApi$1.JsonConvertableImpl),GetDownBillsInfoArgs=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(GetBillsInfoArgs),GetUpBillsInfoArgs=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(GetBillsInfoArgs),TrackingHelper=function(){function e(){}return e.concatDownBillInfos=function(e,t){var r,o,n,i;if(null==e&&(e=new Array),null!=t&&0!=t.length){var a=new Array;e.forEach(function(e){return a.push(e.schemaId)});try{for(var l=__values(t),s=l.next();!s.done;s=l.next()){var w=s.value;if(a.includes(w.schemaId)){var c=function(e){var t,r,o,n,i,a,l,s;if(e.schemaId==w.schemaId){var c=e.billDataInfos,p=new Array;c.forEach(function(e){return p.push(e.dataId)});try{for(var u=__values(w.billDataInfos),d=u.next();!d.done;d=u.next()){var m=d.value;if(p.includes(m.dataId))try{for(var h=__values(c),g=h.next();!g.done;g=h.next()){var f=g.value;if(f.dataId==m.dataId){var y=f.trackingMappingAssociations;try{for(var x=__values(m.trackingMappingAssociations),b=x.next();!b.done;b=x.next()){var C=b.value,v=0;try{for(var S=__values(y),T=S.next();!T.done;T=S.next()){var I=T.value;C.downBillDataIdPath==I.downBillDataIdPath&&C.downBillTableCodePath==I.downBillTableCodePath&&C.upBillDataIdPath==I.upBillDataIdPath&&C.upBillTableCodePath==I.upBillTableCodePath||v++}}catch(A){l={error:A}}finally{try{T&&!T.done&&(s=S["return"])&&s.call(S)}finally{if(l)throw l.error}}v==y.length&&y.push(C)}}catch(E){i={error:E}}finally{try{b&&!b.done&&(a=x["return"])&&a.call(x)}finally{if(i)throw i.error}}}}}catch(B){o={error:B}}finally{try{g&&!g.done&&(n=h["return"])&&n.call(h)}finally{if(o)throw o.error}}else c.push(m)}}catch(M){t={error:M}}finally{try{d&&!d.done&&(r=u["return"])&&r.call(u)}finally{if(t)throw t.error}}}};try{for(var p=__values(e),u=p.next();!u.done;u=p.next())c(u.value)}catch(d){n={error:d}}finally{try{u&&!u.done&&(i=p["return"])&&i.call(p)}finally{if(n)throw n.error}}}else a.push(w.schemaId),e.push(w)}}catch(m){r={error:m}}finally{try{s&&!s.done&&(o=l["return"])&&o.call(l)}finally{if(r)throw r.error}}}return e},e.concatUpBillInfos=function(e,t){var r,o,n,i;if(null==e&&(e=new Array),null!=t&&0!=t.length){var a=new Array;e.forEach(function(e){a.push(e.schemaId)});try{for(var l=__values(t),s=l.next();!s.done;s=l.next()){var w=s.value;if(a.includes(w.schemaId)){var c=function(e){var t,r,o,n,i,a,l,s;if(e.schemaId==w.schemaId){var c=e.billDataInfos,p=new Array;c.forEach(function(e){return p.push(e.dataId)});try{for(var u=__values(w.billDataInfos),d=u.next();!d.done;d=u.next()){var m=d.value;if(p.includes(m.dataId))try{for(var h=__values(c),g=h.next();!g.done;g=h.next()){var f=g.value;if(f.dataId==m.dataId){var y=f.trackingMappingAssociations;try{for(var x=__values(m.trackingMappingAssociations),b=x.next();!b.done;b=x.next()){var C=b.value,v=0;try{for(var S=__values(y),T=S.next();!T.done;T=S.next()){var I=T.value;C.downBillDataIdPath==I.downBillDataIdPath&&C.downBillTableCodePath==I.downBillTableCodePath&&C.upBillDataIdPath==I.upBillDataIdPath&&C.upBillTableCodePath==I.upBillTableCodePath||v++}}catch(A){l={error:A}}finally{try{T&&!T.done&&(s=S["return"])&&s.call(S)}finally{if(l)throw l.error}}v==y.length&&y.push(C)}}catch(E){i={error:E}}finally{try{b&&!b.done&&(a=x["return"])&&a.call(x)}finally{if(i)throw i.error}}}}}catch(B){o={error:B}}finally{try{g&&!g.done&&(n=h["return"])&&n.call(h)}finally{if(o)throw o.error}}else c.push(m)}}catch(M){t={error:M}}finally{try{d&&!d.done&&(r=u["return"])&&r.call(u)}finally{if(t)throw t.error}}}};try{for(var p=__values(e),u=p.next();!u.done;u=p.next())c(u.value)}catch(d){n={error:d}}finally{try{u&&!u.done&&(i=p["return"])&&i.call(p)}finally{if(n)throw n.error}}}else a.push(w.schemaId),e.push(w)}}catch(m){r={error:m}}finally{try{s&&!s.done&&(o=l["return"])&&o.call(l)}finally{if(r)throw r.error}}}return e},e}(),UpBillInfo=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(BillInfo),TypeToFormat={DEFAULT:"DEFAULT",DATE:"DATE",DECIMAL:"DECIMAL",STRING:"STRING"},FieldsWithOrder=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.typeToFormat=TypeToFormat.DEFAULT,e}return __extends(e,t),e.prototype.ResetBeforeLoadFrom=function(){t.prototype.ResetBeforeLoadFrom.call(this),this.order=0,this.fieldName=null,this.fieldPath=null,this.name=null,this.customName=null,this.colI18nValues=null,this.typeToFormat=TypeToFormat.DEFAULT,this.formatInfo=null,this.version=0},e.prototype.ConvertToJsonObject=function(){var e=t.prototype.ConvertToJsonObject.call(this);return commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"order",this.order),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"name",this.name),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"fieldName",this.fieldName),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"fieldPath",this.fieldPath),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"customName",this.customName),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"colI18nValues",this.colI18nValues),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"typeToFormat",this.typeToFormat),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"formatInfo",this.formatInfo),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"version",this.version),e},e.prototype.LoadFromJsonObject=function(e){t.prototype.LoadFromJsonObject.call(this,e),this.order=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsNumber(e,"order"),this.name=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"name"),this.fieldName=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"fieldName"),this.fieldPath=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"fieldPath"),this.customName=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"customName"),this.colI18nValues=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"colI18nValues"),this.typeToFormat=TypeToFormat[commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"typeToFormat")],this.formatInfo=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"formatInfo"),this.version=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsNumber(e,"version")},e}(commonApi$1.JsonConvertableImpl),SummaryFieldsInfo=function(t){function r(){var e=null!==t&&t.apply(this,arguments)||this;return e.fields=[],e.childFieldInfos=[],e}return __extends(r,t),r.prototype.ResetBeforeLoadFrom=function(){t.prototype.ResetBeforeLoadFrom.call(this),this.code=null,this.fields=[],this.childFieldInfos=[]},r.prototype.ConvertToJsonObject=function(){var e=t.prototype.ConvertToJsonObject.call(this);return commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"code",this.code),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"fields",this.fields),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"childFieldInfos",this.childFieldInfos),e},r.prototype.LoadFromJsonObject=function(e){t.prototype.LoadFromJsonObject.call(this,e),this.code=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"code"),this.fields=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsList(e,"fields",FieldsWithOrder),this.childFieldInfos=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsList(e,"childFieldInfos",r)},r}(commonApi$1.JsonConvertableImpl),FieldNameAndValue=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.ResetBeforeLoadFrom=function(){t.prototype.ResetBeforeLoadFrom.call(this),this.name=null,this.value=null},e.prototype.ConvertToJsonObject=function(){var e=t.prototype.ConvertToJsonObject.call(this);return commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"name",this.name),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"value",this.value),e},e.prototype.LoadFromJsonObject=function(e){t.prototype.LoadFromJsonObject.call(this,e),this.name=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"name"),this.value=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"value")},e}(commonApi$1.JsonConvertableImpl),DateTypeFormatInfo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.ResetBeforeLoadFrom=function(){t.prototype.ResetBeforeLoadFrom.call(this),this.displayFormat=null},e.prototype.ConvertToJsonObject=function(){var e=t.prototype.ConvertToJsonObject.call(this);return commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"displayFormat",this.displayFormat),e},e.prototype.LoadFromJsonObject=function(e){t.prototype.LoadFromJsonObject.call(this,e),this.displayFormat=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"displayFormat")},e}(commonApi$1.JsonConvertableImpl),ScaleMode={DEFAULT:"DEFAULT",NUMBER:"NUMBER",FIELD:"FIELD",EXPRESSION:"EXPRESSION"},DecimalTypeFormatInfo=function(r){function e(){var e=null!==r&&r.apply(this,arguments)||this;return e.scaleMode=ScaleMode.DEFAULT,e}return __extends(e,r),e.prototype.ResetBeforeLoadFrom=function(){r.prototype.ResetBeforeLoadFrom.call(this),this.scale=0,this.scaleMode=ScaleMode.DEFAULT,this.fieldPath=null,this.version=0},e.prototype.ConvertToJsonObject=function(){var e=r.prototype.ConvertToJsonObject.call(this);return commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"scale",this.scale),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"scale",this.scale),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"scaleMode",this.scaleMode),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"fieldPath",this.fieldPath),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"version",this.version),e},e.prototype.LoadFromJsonObject=function(e){r.prototype.LoadFromJsonObject.call(this,e),this.scale=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsNumber(e,"scale");var t=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"scaleMode");this.scaleMode=null==t?ScaleMode.DEFAULT:ScaleMode[t],this.fieldPath=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"fieldPath"),this.version=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsNumber(e,"version")},e}(commonApi$1.JsonConvertableImpl),TypeToFormat$1={DEFAULT:"DEFAULT",DATE:"DATE",DECIMAL:"DECIMAL",STRING:"STRING"},JointQueryParameterContent=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.ResetBeforeLoadFrom=function(){t.prototype.ResetBeforeLoadFrom.call(this),this.parameterCode=null},e.prototype.ConvertToJsonObject=function(){var e=t.prototype.ConvertToJsonObject.call(this);return commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"parameterCode",this.parameterCode),e},e.prototype.LoadFromJsonObject=function(e){t.prototype.LoadFromJsonObject.call(this,e),this.parameterCode=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"parameterCode")},e}(commonApi$1.JsonConvertableImpl),ExpressionJointQueryParameterContent=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.ResetBeforeLoadFrom=function(){t.prototype.ResetBeforeLoadFrom.call(this),this.expressionContent=null},e.prototype.ConvertToJsonObject=function(){var e=t.prototype.ConvertToJsonObject.call(this);return commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"expressionContent",this.expressionContent),e},e.prototype.LoadFromJsonObject=function(e){t.prototype.LoadFromJsonObject.call(this,e),this.expressionContent=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"expressionContent")},e}(JointQueryParameterContent),FieldJointQueryParameterContent=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.ResetBeforeLoadFrom=function(){t.prototype.ResetBeforeLoadFrom.call(this),this.fieldContent=null},e.prototype.ConvertToJsonObject=function(){var e=t.prototype.ConvertToJsonObject.call(this);return commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"fieldContent",this.fieldContent),e},e.prototype.LoadFromJsonObject=function(e){t.prototype.LoadFromJsonObject.call(this,e),this.fieldContent=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"fieldContent")},e}(JointQueryParameterContent),JointQueryParameterMode={FIELD:"FIELD",EXPRESSION:"EXPRESSION",COMPONENT:"COMPONENT"},JointQueryParameterResult=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.ResetBeforeLoadFrom=function(){t.prototype.ResetBeforeLoadFrom.call(this),this.code=null,this.value=null},e.prototype.ConvertToJsonObject=function(){var e=t.prototype.ConvertToJsonObject.call(this);return commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"code",this.code),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"value",this.value),e},e.prototype.LoadFromJsonObject=function(e){t.prototype.LoadFromJsonObject.call(this,e),this.code=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"code"),this.value=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"value")},e}(commonApi$1.JsonConvertableImpl),JointQueryParametersContent=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.jointQueryParameterMode=JointQueryParameterMode.FIELD,e}return __extends(e,t),e.prototype.ResetBeforeLoadFrom=function(){t.prototype.ResetBeforeLoadFrom.call(this),this.jointQueryParameterMode=JointQueryParameterMode.FIELD,this.content=null},e.prototype.ConvertToJsonObject=function(){var e=t.prototype.ConvertToJsonObject.call(this);return commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"jointQueryParameterMode",this.jointQueryParameterMode),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"content",this.content),e},e.prototype.LoadFromJsonObject=function(e){t.prototype.LoadFromJsonObject.call(this,e),this.jointQueryParameterMode=JointQueryParameterMode[commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"jointQueryParameterMode")],this.content=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"content")},e}(commonApi$1.JsonConvertableImpl),SimpleValueMappingInfo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.ResetBeforeLoadFrom=function(){t.prototype.ResetBeforeLoadFrom.call(this),this.displayValue=null,this.actualValue=null},e.prototype.ConvertToJsonObject=function(){var e=t.prototype.ConvertToJsonObject.call(this);return commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"displayValue",this.displayValue),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"actualValue",this.actualValue),e},e.prototype.LoadFromJsonObject=function(e){t.prototype.LoadFromJsonObject.call(this,e),this.displayValue=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"displayValue"),this.actualValue=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"actualValue")},e}(commonApi$1.JsonConvertableImpl),StringDisplayMode={SIMPLEVALUEMAPPING:"SIMPLEVALUEMAPPING"},StringTypeFormatInfo=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.stringDisplayMode=StringDisplayMode.SIMPLEVALUEMAPPING,e.simpleValueMappingInfos=[],e}return __extends(e,t),e.prototype.ResetBeforeLoadFrom=function(){t.prototype.ResetBeforeLoadFrom.call(this),this.stringDisplayMode=StringDisplayMode.SIMPLEVALUEMAPPING,this.simpleValueMappingInfos=[]},e.prototype.ConvertToJsonObject=function(){var e=t.prototype.ConvertToJsonObject.call(this);return commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"stringDisplayMode",this.stringDisplayMode),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"simpleValueMappingInfos",this.simpleValueMappingInfos),e},e.prototype.LoadFromJsonObject=function(e){t.prototype.LoadFromJsonObject.call(this,e),this.stringDisplayMode=StringDisplayMode[commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"stringDisplayMode")],this.simpleValueMappingInfos=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsList(e,"simpleValueMappingInfos",SimpleValueMappingInfo)},e}(commonApi$1.JsonConvertableImpl),Exceptions=function(){function e(){}return e.SCALE_FIELD_VALUE_IS_NAN="scale field value is NaN",e}(),BIF_UISTATE_KEY_OPEN_TYPE="abdbaec8-0bbe-4894-acee-b8d493bc4e1c",BIF_UISTATE_KEY_CREATION_RESULT="5eb32009-1d86-43df-96c8-8d685aea4e66",ModuleConfig=function(){},SELECTOR_ARGS_INJECTOR=new core$1.InjectionToken("SELECTOR_ARGS_INJECTOR"),DEFAULT_SELECTOR_ARGS={upBillVoId:null,downBillVoId:null,manaualCreationMode:null},PushTaskArgs=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.ResetBeforeLoadFrom=function(){t.prototype.ResetBeforeLoadFrom.call(this),this.suCode=null,this.creationRuleExecutorResult=null},e.prototype.ConvertToJsonObject=function(){var e=t.prototype.ConvertToJsonObject.call(this);return commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"suCode",this.suCode),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"creationRuleExecutorResult",this.creationRuleExecutorResult),e},e.prototype.LoadFromJsonObject=function(e){t.prototype.LoadFromJsonObject.call(this,e),this.suCode=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"suCode"),this.creationRuleExecutorResult=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsJsonSerializable(e,"creationRuleExecutorResult",runtimeApi.RpcCreationRuleExecutorResult)},e}(commonApi$1.JsonConvertableImpl),GetEntityDatasArgs=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.ResetBeforeLoadFrom=function(){t.prototype.ResetBeforeLoadFrom.call(this),this.voId=null,this.dataId=null,this.suCode=null},e.prototype.ConvertToJsonObject=function(){var e=t.prototype.ConvertToJsonObject.call(this);return commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"schemaId",this.voId),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"dataId",this.dataId),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"suCode",this.suCode),e},e.prototype.LoadFromJsonObject=function(e){t.prototype.LoadFromJsonObject.call(this,e),this.voId=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"schemaId"),this.dataId=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"dataId"),this.suCode=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"suCode")},e}(commonApi$1.JsonConvertableImpl),LANG_RESOURCES={"zh-CHS":{confirm:"确定",cancel:"取消",emptyResult:"查询结果为空",upstreamBill:"上游单据",downstreamBill:"下游单据",selectUpstreamBill:"请选择上游单据",selectDownstreamBill:"请选择下游单据",selectCreationProcess:"请选择生单流程",processDesciption:"流程描述",creationProcessSelector:"生单流程",upstreamBillSelector:"上游单据",creationExecutionError:"生单流程执行错误",creationResultEmpty:"生单结果为空",pushTaskCenterSuccess:"推送至任务中心",pushTaskCenterFailed:"推送任务中心失败",entitiesCantBeEmpty:"参数【参与生单的上游单据ID列表或实体列表】不可为空",creationResultCantBeEmpty:"参数【生单结果】不可为空",dataIdCantBeEmpty:"参数【单据Id】不可为空",voIdCantBeEmpty:"参数【VO Id】不可为空",suCodeCantBeEmpty:"参数【SU编号】不可为空",processIdCantBeEmpty:"参数【生单流程Id】不可为空",sourceVoIdCantBeEmpty:"参数【上游单据视图对象Id】不可为空",targetVoIdCantBeEmpty:"参数【下游单据视图对象Id】不可为空",processCode:"流程编号",processName:"流程名称",all:"全部",noDefaultUpBillSelector:"请确认生单流程中【集成场景】启用了【人工拉式生单】场景，并且【单据配置】-【拉式生单配置】-【上游应用入口】或【URL】不为空",pleaseSelectOneCreationProcess:"请选择一条生单流程"},en:{confirm:"confirm",cancel:"cancel",emptyResult:"The result is empty",upstreamBill:"Upstream bill",downstreamBill:"Downstream bill",selectUpstreamBill:"Select upstream bill",selectDownstreamBill:"Select downstream bill",selectCreationProcess:"Select creation process",processDesciption:"Desciption",creationProcessSelector:"Creation Process",upstreamBillSelector:"Upstream Bill Selector",creationExecutionError:"Creation Process Execution Error",creationResultEmpty:"Creation result is empty",pushTaskCenterSuccess:"Success to push data to task center",pushTaskCenterFailed:"Failed to push data to task center",entitiesCantBeEmpty:'The parameter "entities" can\'t be empty',dataIdCantBeEmpty:'The parameter "dataId" can\'t be empty',voIdCantBeEmpty:'The parameter "voId" can\'t be empty',suCodeCantBeEmpty:'The parameter "suCode" can\'t be empty',processIdCantBeEmpty:'The parameter "processId" can\'t be empty',sourceVoIdCantBeEmpty:'The parameter "sourceVoId" can\'t be empty',targetVoIdCantBeEmpty:'The parameter "targetVoId" can\'t be empty',processCode:"Process Code",processName:"Process Name",all:"All",noDefaultUpBillSelector:"Please ensure that the creation process configed [Manual Pull] in [integration scene], and configed [Up App Entrance] correctly.",pleaseSelectOneCreationProcess:"Please select on creation process"},"zh-CHT":{confirm:"確定",cancel:"取消",emptyResult:"查詢結果為空",upstreamBill:"上遊單據",downstreamBill:"下遊單據",selectUpstreamBill:"請選擇上遊單據",selectDownstreamBill:"請選擇下遊單據",selectCreationProcess:"請選擇生單流程",processDesciption:"流程描述",creationProcessSelector:"生單流程",upstreamBillSelector:"上遊單據選擇",creationExecutionError:"生單規則執行錯誤",creationResultEmpty:"生單結果為空",pushTaskCenterSuccess:"推送至任務中心",pushTaskCenterFailed:"推送任務中心失敗",entitiesCantBeEmpty:"參與生單的上遊單據ID列表或實體列表不可爲空",dataIdCantBeEmpty:"參數【單據Id】不可爲空",voIdCantBeEmpty:"參數【VO Id】不可爲空",suCodeCantBeEmpty:"參數【SU編號】不可爲空",processIdCantBeEmpty:"參數【生單流程Id】不可爲空",sourceVoIdCantBeEmpty:"參數【上遊單據視圖對象Id】不可爲空",targetVoIdCantBeEmpty:"參數【下遊單據視圖對象Id】不可爲空",processCode:"流程編號",processName:"流程名稱",all:"全部",noDefaultUpBillSelector:"請確認生單流程中【集成場景】啓用了【人工拉式生單】場景，並且【單據配置】-【拉式生單配置】-【上遊應用入口】或【URL】不爲空",pleaseSelectOneCreationProcess:"請選擇壹條生單流程"}},LocalePipe=function(){function e(e){this.langCode=e||"zh-CHS",this.lang=LANG_RESOURCES[this.langCode]}return e.prototype.transform=function(e){return this.lang[e]||e},e.prototype.instant=function(e){return this.transform(e)},e.decorators=[{type:core$1.Pipe,args:[{name:"locale"}]}],e.ctorParameters=function(){return[{type:String,decorators:[{type:core$1.Inject,args:[core$1.LOCALE_ID]}]}]},e}(),BifDataService=function(){function e(e,t,r,o,n,i,a,l,s,c,p,u){this.httpClient=e,this.injector=r,this.cfr=o,this.loader=n,this.modal=i,this.messager=a,this.frameContext=l,this.localeId=s,this.runtimeFrameworkService=c,this.localePipe=p,this.httpService=u,this.getBillCreationProcessEntityExByIdUrl="/api/runtime/aif/v1.0/manualcreationbill/getbillcreationprocessentityex",this.getBillCreationProcessEntityExByIdMethod="GET",this.getBillCreationProcessEntityExUrl="/api/runtime/aif/v1.0/manualcreationbill/getbillcreationprocessentityexes",this.getBillCreationProcessEntityExMethod="POST",this.executeBillCreationProcessUrl="/api/runtime/aif/v1.0/manualcreationbill/executebillcreationprocess",this.executeBillCreationProcessMethod="POST",this.formCreateUrl="/api/runtime/aif/v1.0/form/create",this.formCreateMethod="POST",this.formUpdateUrl="/api/runtime/aif/v1.0/form/update",this.formUpdateMethod="POST",this.generalTextUrl="/api/runtime/aif/v1.0/generaltext",this.generalTextMethod="GET",this.generalTextCreationMethod="POST",this.pushTaskUrl="/api/runtime/aif/v1.0/manualcreationbill/pushtask",this.pushTaskMethod="POST",this.getEntityDatasUrl="/api/runtime/aif/v1.0/manualcreationbill/getentitydatas",this.getEntityDatasMethod="POST",this.repository=t,this.injector=(null!=this.injector?this:this.repository.appContext).injector,this.cfr=null!=this.cfr?this.cfr:this.injector.get(core$1.ComponentFactoryResolver,null),this.loader=null!=this.loader?this.loader:this.injector.get(core$1.NgModuleFactoryLoader,null),this.modal=null!=this.modal?this.modal:this.injector.get(uiModal.BsModalService,null),this.messager=null!=this.messager?this.messager:this.injector.get(uiMessager.MessagerService,null),this.frameContext=null!=this.frameContext?this.frameContext:this.injector.get(devkit.FrameContext,null),this.localeId=null!=this.localeId?this.localeId:this.injector.get(core$1.LOCALE_ID,localStorage.getItem("languageCode")||"zh-CHS"),this.runtimeFrameworkService=null!=this.runtimeFrameworkService?this.runtimeFrameworkService:this.injector.get(commandServices.RuntimeFrameworkService,null),this.localePipe=null!=this.localePipe?this.localePipe:this.injector.get(LocalePipe,new LocalePipe(this.localeId)),this.httpService=null!=this.httpService?this.httpService:this.injector.get(cafCommon.HttpService,null)}return e.prototype.getSlimBillCreationProcessEntityExesByUpBillVoId4Push=function(e){var t=new FormGetBillCreationProcessEntityExArgs;return t.upBillVoId=e,t.manualCreationMode=ManualCreationMode.Push,this.getSlimBillCreationProcessEntityExes(t).pipe(operators.map(function(e){return e.billCreationProcessEntityExes}))},e.prototype.getSlimBillCreationProcessEntityExesByDownBillVoId4Pull=function(e){var t=new FormGetBillCreationProcessEntityExArgs;return t.downBillVoId=e,t.manualCreationMode=ManualCreationMode.Pull,this.getSlimBillCreationProcessEntityExes(t).pipe(operators.map(function(e){return e.billCreationProcessEntityExes}),operators.catchError(function(e){try{"string"==typeof e.error&&(e.error=JSON.parse(e.error))}catch(t){}throw e}))},e.prototype.getSlimBillCreationProcessEntityExesByUpBillVoIdAndDownBillVoId4SpecificPush=function(e,t){var r=new FormGetBillCreationProcessEntityExArgs;return r.upBillVoId=e,r.downBillVoId=t,r.manualCreationMode=ManualCreationMode.SpecificPush,this.getSlimBillCreationProcessEntityExes(r).pipe(operators.map(function(e){return e.billCreationProcessEntityExes}),operators.catchError(function(e){try{"string"==typeof e.error&&(e.error=JSON.parse(e.error))}catch(t){}throw e}))},e.prototype.getSlimBillCreationProcessEntityExesByUpBillVoIdAndDownBillVoId4SpecificPull=function(e,t){var r=new FormGetBillCreationProcessEntityExArgs;return r.upBillVoId=e,r.downBillVoId=t,r.manualCreationMode=ManualCreationMode.SpecificPull,this.getSlimBillCreationProcessEntityExes(r).pipe(operators.map(function(e){return e.billCreationProcessEntityExes}),operators.catchError(function(e){try{"string"==typeof e.error&&(e.error=JSON.parse(e.error))}catch(t){}throw e}))},e.prototype.getSlimBillCreationProcessEntityExById=function(e){return null!=this.httpService?this.httpService.request(this.getBillCreationProcessEntityExByIdMethod,this.getBillCreationProcessEntityExByIdUrl+"/"+e,{}):this.repository.proxy.request(this.getBillCreationProcessEntityExByIdUrl+"/"+e,this.getBillCreationProcessEntityExByIdMethod,null)},e.prototype.getFormSettingsById=function(e){if(null==e||""==e.trim())throw"FormSettingsId为空";return(null!=this.httpService?this.httpService.request(this.generalTextMethod,this.generalTextUrl+"/"+e,{responseType:"text"}):this.repository.proxy.request(this.generalTextUrl+"/"+e,this.generalTextMethod,null,{responseType:"text"})).pipe(operators.map(function(e){var t=new commonApi.GeneralTextEntity,e=(t.LoadFromJson(e),new commonApi.FormSettings);return e.LoadFromJson(t.text),e}),operators.catchError(function(e){try{"string"==typeof e.error&&(e.error=JSON.parse(e.error))}catch(t){}throw e}))},e.prototype.getCreationResultById=function(e){if(null==e||""==e.trim())throw"creationResultId为空";return(null!=this.httpService?this.httpService.request(this.generalTextMethod,this.generalTextUrl+"/"+e,{responseType:"text"}):this.repository.proxy.request(this.generalTextUrl+"/"+e,this.generalTextMethod,null,{responseType:"text"})).pipe(operators.map(function(e){var t=new commonApi.GeneralTextEntity,e=(t.LoadFromJson(e),new runtimeApi.FormBillCreationProcessExecutorResult);return e.LoadFromJson(t.text),e}),operators.catchError(function(e){try{"string"==typeof e.error&&(e.error=JSON.parse(e.error))}catch(t){}throw e}))},e.prototype.addFormBillCreationProcessExecutorResult=function(e){if(null==e)throw"参数creationResult不可为空";if("string"==typeof e){if(""==e)throw"参数creationResult不可为空";var t=new runtimeApi.FormBillCreationProcessExecutorResult;t.LoadFromJson(e),e=t}if(e instanceof runtimeApi.FormBillCreationProcessExecutorResult==0&&((t=new runtimeApi.FormBillCreationProcessExecutorResult).LoadFromJsonObject(e),e=t),0==e.conditionResult.conditionExecutionResult)this.messager.error(e.conditionResult.message||this.localePipe.transform("creationExecutionError"));else{if(null!=e.creationRuleExecutorResult&&null!=e.creationRuleExecutorResult.mappingResults&&0!=e.creationRuleExecutorResult.mappingResults.length)return t={body:e.ConvertToJson(),responseType:"text"},(null!=this.httpService?this.httpService.request(this.generalTextCreationMethod,""+this.generalTextUrl,t):this.repository.proxy.request(""+this.generalTextUrl,this.generalTextCreationMethod,null,t)).pipe(operators.map(function(e){return commonApi.BpmnModelJsonHelper.FromJson(e,GeneralTextIdWithDataId)}),operators.catchError(function(e){try{"string"==typeof e.error&&(e.error=JSON.parse(e.error))}catch(t){}throw e}));this.messager.error(this.localePipe.transform("creationResultEmpty"))}},e.prototype.executeBillCreationProcess=function(e){if(null==e.manualCreationMode)throw"manualCreationMode不可为空";e={body:e.ConvertToJson(),responseType:"text"};return(null!=this.httpService?this.httpService.request(this.executeBillCreationProcessMethod,this.executeBillCreationProcessUrl,e):this.repository.proxy.request(this.executeBillCreationProcessUrl,this.executeBillCreationProcessMethod,null,e)).pipe(operators.map(function(e){var t=new runtimeApi.FormBillCreationProcessExecutorResult;return t.LoadFromJson(e),t}),operators.catchError(function(e){try{"string"==typeof e.error&&(e.error=JSON.parse(e.error))}catch(t){}throw e}))},e.prototype.createEntityDatas=function(e){var o=this,e=e.ConvertToJson();return this.repository.proxy.request(this.formCreateUrl,this.formCreateMethod,null,{body:e,responseType:"text"}).pipe(operators.switchMap(function(e){var t=new runtimeApi.FormCreateResult,e=(t.LoadFromJson(e),t.entityDataList.map(function(e){e=o.repository.buildEntity(JSON.parse(e));return o.appendInitialData(e,e),e})),r=o.repository.entityCollection.getAllEntities();return null==r||0==r.length?o.repository.entityCollection.loadEntities(e):o.repository.entityCollection.addEntities(e),rxjs.of(t)}),operators.catchError(function(e){try{"string"==typeof e.error&&(e.error=JSON.parse(e.error))}catch(t){}throw e}))},e.prototype.updateEntityDatas=function(e){e=e.ConvertToJson();return this.repository.proxy.request(this.formUpdateUrl,this.formUpdateMethod,null,{body:e,responseType:"text"}).pipe(operators.map(function(e){var t=new runtimeApi.FormUpdateResult;return t.LoadFromJson(e),t}),operators.catchError(function(e){try{"string"==typeof e.error&&(e.error=JSON.parse(e.error))}catch(t){}throw e}))},e.prototype.pushTaskCenter=function(e){e={body:e.ConvertToJson(),responseType:"text"};return(null!=this.httpService?this.httpService.request(this.pushTaskMethod,this.pushTaskUrl,e):this.repository.proxy.request(this.pushTaskUrl,this.pushTaskMethod,null,e)).pipe(operators.catchError(function(e){try{"string"==typeof e.error&&(e.error=JSON.parse(e.error))}catch(t){}throw e}))},e.prototype.getEntityDatas=function(e){e={body:e.ConvertToJson(),responseType:"text"};return(null!=this.httpService?this.httpService.request(this.getEntityDatasMethod,this.getEntityDatasUrl,e):this.repository.proxy.request(this.getEntityDatasUrl,this.getEntityDatasMethod,null,e)).pipe(operators.catchError(function(e){try{"string"==typeof e.error&&(e.error=JSON.parse(e.error))}catch(t){}throw e}))},e.prototype.getSlimBillCreationProcessEntityExes=function(e){if(null==e)throw"args不可为空";if("string"==typeof e){if(""==e)throw"args不可为空";var t=new FormGetBillCreationProcessEntityExArgs;t.LoadFromJson(e),e=t}t={body:e.ConvertToJson(),responseType:"text"};return(null!=this.httpService?this.httpService.request(this.getBillCreationProcessEntityExMethod,this.getBillCreationProcessEntityExUrl,t):this.repository.proxy.request(this.getBillCreationProcessEntityExUrl,this.getBillCreationProcessEntityExMethod,null,t)).pipe(operators.map(function(e){var t=new FormGetBillCreationProcessEntityExResult;return t.LoadFromJson(e),t}),operators.catchError(function(e){try{"string"==typeof e.error&&(e.error=JSON.parse(e.error))}catch(t){}throw e}))},e.prototype.appendInitialData=function(e,t){t=Object.assign({},t);delete t.id,delete t.parentID,e.initialData=t},e.decorators=[{type:core$1.Injectable}],e.ctorParameters=function(){return[{type:http.HttpClient},{type:devkit.Repository},{type:core$1.Injector,decorators:[{type:core$1.Optional}]},{type:core$1.ComponentFactoryResolver,decorators:[{type:core$1.Optional}]},{type:core$1.NgModuleFactoryLoader,decorators:[{type:core$1.Optional}]},{type:uiModal.BsModalService,decorators:[{type:core$1.Optional}]},{type:uiMessager.MessagerService,decorators:[{type:core$1.Optional}]},{type:devkit.FrameContext,decorators:[{type:core$1.Optional}]},{type:String,decorators:[{type:core$1.Optional},{type:core$1.Inject,args:[core$1.LOCALE_ID]}]},{type:commandServices.RuntimeFrameworkService,decorators:[{type:core$1.Optional}]},{type:LocalePipe,decorators:[{type:core$1.Optional}]},{type:cafCommon.HttpService,decorators:[{type:core$1.Optional}]}]},e}(),AbstractBifDataSelectorService=function(){function e(){this.subject4EntityDatas=new rxjs.Subject}return e.decorators=[{type:core$1.Injectable}],e}(),DefaultBifDataSelectorService=function(i){function e(e,t,r,o){var n=i.call(this)||this;return n.frameContext=e,n.viewModel=t,n.cfr=r,n.injector=o,n.subject4EntityDatas=new rxjs.Subject,n.clickOk4BifSelector=function(){n.viewModel.frameContext.repository.getById(n.viewModel.bindingData.getObject().id).subscribe(function(e){n.subject4EntityDatas.next([e]),n.subject4EntityDatas.complete(),n.bsModalRef4BifSelector.close()})},n.clickClose4BifSelector=function(){n.subject4EntityDatas.complete(),n.bsModalRef4BifSelector.close()},n}return __extends(e,i),e.decorators=[{type:core$1.Injectable}],e.ctorParameters=function(){return[{type:devkit.FrameContext},{type:devkit.ViewModel},{type:core$1.ComponentFactoryResolver},{type:core$1.Injector}]},e}(AbstractBifDataSelectorService),AbstractUiService=function(){function e(e,t,r,o,n,i,a,l){this.frameContext=e,this.modalService=t,this.messager=r,this.injector=o,this.cfr=n,this.loader=i,this.localeId=a,this.defaultModalOptions={title:null,width:900,height:500,buttons:null,showButtons:null},this.runtimeFrameworkService=l||o.get(commandServices.RuntimeFrameworkService),this.localePipe=new LocalePipe(a)}return e.prototype.openBillCreationProcessSelector=function(e,t,r,o,n){var i=this;if("string"==typeof r){if(""==r)throw"modalOptions不可为空";r=JSON.parse(r)}(r=null==r?this.defaultModalOptions:r).title=null==r.title?this.localePipe.transform("creationProcessSelector"):r.title;var a=null;return null==o||""==o.trim()?(t=this.cfr.resolveComponentFactory(t),e=core$1.ReflectiveInjector.resolveAndCreate([{provide:SELECTOR_ARGS_INJECTOR,useValue:e.ConvertToJsonObject()},uiLoading.LoadingService],this.injector),a=t.create(e),this.configModalButtons(r,a),a.instance.bsModalRef4BifSelector=this.modalService.show(a,r),a.instance.subject4CreationProcess.asObservable()):rxjs.from(this.loader.load(o)).pipe(operators.switchMap(function(e){e=e.create(i.frameContext.root.injector).instance.createCreationProcessSelector(i.frameContext.root.injector,n);return e instanceof rxjs.Observable?e.pipe(operators.switchMap(function(e){return a=e,i.configModalButtons(r,a),a.instance.bsModalRef4BifSelector=i.modalService.show(a,r),a.instance.subject4CreationProcess.asObservable()})):e instanceof core$1.ComponentRef?(a=e,i.configModalButtons(r,a),a.instance.bsModalRef4BifSelector=i.modalService.show(a,r),a.instance.subject4CreationProcess.asObservable()):void 0}))},e.prototype.configModalButtons=function(e,t){e.buttons=[{text:this.localePipe.transform("confirm"),cls:"btn btn-primary",handle:t.instance.clickOk4BifSelector},{text:this.localePipe.transform("cancel"),cls:"btn btn-secondary",handle:t.instance.clickClose4BifSelector}],e.showButtons=!0},e.ctorParameters=function(){return[{type:devkit.FrameContext},{type:uiModal.BsModalService},{type:uiMessager.MessagerService},{type:core$1.Injector},{type:core$1.ComponentFactoryResolver},{type:core$1.NgModuleFactoryLoader},{type:String,decorators:[{type:core$1.Inject,args:[core$1.LOCALE_ID]}]},{type:commandServices.RuntimeFrameworkService,decorators:[{type:core$1.Optional}]}]},e}(),PushSelectorComponent=function(){function e(e,t,r,o,n,i,a,l){var s=this;this.dataService=t,this.loading=o,this.elementRef=n,this.inj=i,this.cfr=a,this.messagerService=l,this.ttData=[],this.ttIdField="voId",this.ttSearchFields=[],this.dgData=[],this.dgIdField="id",this.procData=[],this.bsModalRef4BifSelector=null,this.subject4CreationProcess=new rxjs.Subject,this.clickOk4BifSelector=function(){null==s.selectedEntity?s.messagerService.error(s.localePipe.instant("pleaseSelectOneCreationProcess")):(s.subject4CreationProcess.next(s.selectedEntity),s.subject4CreationProcess.complete(),s.bsModalRef4BifSelector.close())},this.clickClose4BifSelector=function(){s.bsModalRef4BifSelector.close()},this.args=new FormGetBillCreationProcessEntityExArgs,this.args.LoadFromJsonObject(e),this.localePipe=new LocalePipe(r),null==i&&(t=core$1.ReflectiveInjector.resolveAndCreate([uiMessager.MessagerService]),this.inj=t),this.cfr=a||this.inj.get(core$1.ComponentFactoryResolver),this.messagerService=l||this.inj.get(uiMessager.MessagerService,null)}return e.prototype.ngOnInit=function(){this.ttDataRoot={id:"*",data:{voId:"*",voName:this.localePipe.instant("all")},parent:null,expanded:!0,children:[]},this.ttData=[this.ttDataRoot],this.configTtColumns(),this.configDgColumns(),this.configTtEvents(),this.configDgEvents(),this.loadItems()},e.prototype.loadItems=function(){var t=this;this.loading.show({container:this.elementRef});(null==this.args.downBillVoId?this.dataService.getSlimBillCreationProcessEntityExesByUpBillVoId4Push(this.args.upBillVoId):this.dataService.getSlimBillCreationProcessEntityExesByUpBillVoIdAndDownBillVoId4SpecificPush(this.args.upBillVoId,this.args.downBillVoId)).subscribe(function(e){t.loading.close(),t.procData=e||[],t.dgData=__spread(t.procData);var r=[];t.procData.forEach(function(t){0==r.some(function(e){return e.voId==t.downBillVoId})&&r.push({voId:t.downBillVoId,voName:t.downBillVoName})}),t.ttDataRoot.children=r.map(function(e){return{id:e.voId,data:{voId:e.voId,voName:e.voName},expanded:!0}}),t.ttData=[t.ttDataRoot],t.dgData&&0<t.dgData.length&&(t.selectedEntity=t.dgData[0],setTimeout(function(){t.dg.clearSelections(),t.dg.selectRow(t.dgData[0].id)},0))},function(e){throw t.loading.close(),e})},e.prototype.configTtColumns=function(){this.ttCols=[{field:"voName",title:this.localePipe.instant("downstreamBill"),width:120}]},e.prototype.configDgColumns=function(){this.dgCols=[{field:"code",title:this.localePipe.transform("processCode"),width:120,sortable:!0},{field:"name",title:this.localePipe.transform("processName"),width:250,sortable:!0}]},e.prototype.configTtEvents=function(){var e=this;this.tt.nodeSelected.subscribe(function(t){"*"==t.node.id?e.dgData=__spread(e.procData):e.dgData=__spread(e.procData.filter(function(e){return e.downBillVoId==t.node.data.voId})),e.dgData&&0<e.dgData.length&&(e.selectedEntity=e.dgData[0],setTimeout(function(){e.dg.clearSelections(),e.dg.selectRow(e.dgData[0].id)},0))})},e.prototype.configDgEvents=function(){var t=this;this.dg.selectChanged.subscribe(function(e){t.selectedEntity=e.data})},e.decorators=[{type:core$1.Component,args:[{selector:"lib-bif-push-selector",template:'<div class="g-main" style="padding-left: 24px; padding-right: 24px;">\r\n  <div class="d-flex flex-row"\r\n    style="height: 100%; width: 100%; border: 1px solid #E9ECF3; box-shadow: 0 2px 6px 0 rgb(31 35 41 / 6%); border-radius: 6px;">\r\n    <div class="d-flex flex-column" style="width: 200px;" ngResizable rzAspectRatio="true" [rzHandles]="\'e\'">\r\n      <farris-treetable #tt class="f-utils-fill-flex-column" [data]="ttData" [columns]="ttCols" [idField]="ttIdField"\r\n        [fit]="true" [showHeader]="true" [fixedHeader]="true" [singleSelect]="true">\r\n      </farris-treetable>\r\n    </div>\r\n\r\n    <div class="f-utils-fill-flex-row" style="padding-left: 15px;">\r\n      <div class="d-flex flex-column" style="width: 100%;">\r\n        <div class="f-utils-fill-flex-column">\r\n          <farris-datagrid #dg [fit]="true" [fitColumns]="true" [data]="dgData" [columns]="dgCols" [idField]="dgIdField"\r\n            [showHeader]="true" [showBorder]="true" [striped]="true" [pagination]="false" [showLineNumber]="true">\r\n          </farris-datagrid>\r\n        </div>\r\n        <div class="form-group" style="">\r\n          <div>{{ \'processDesciption\' | locale }}</div>\r\n          <textarea readonly class="form-control" name="description" rows="3"\r\n            [ngModel]="selectedEntity&&selectedEntity.description"></textarea>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n',styles:[""]}]}],e.ctorParameters=function(){return[{type:undefined,decorators:[{type:core$1.Inject,args:[SELECTOR_ARGS_INJECTOR]}]},{type:BifDataService},{type:String,decorators:[{type:core$1.Inject,args:[core$1.LOCALE_ID]}]},{type:uiLoading.LoadingService},{type:core$1.ElementRef},{type:core$1.Injector,decorators:[{type:core$1.Optional}]},{type:core$1.ComponentFactoryResolver,decorators:[{type:core$1.Optional}]},{type:uiMessager.MessagerService,decorators:[{type:core$1.Optional}]}]},e.propDecorators={tt:[{type:core$1.ViewChild,args:["tt"]}],dg:[{type:core$1.ViewChild,args:["dg"]}]},e}();function judgeBrowserType(){var e={type:"Unknown",IEVersion:undefined},t=navigator.userAgent,r=-1<t.indexOf("Opera"),o=-1<t.indexOf("compatible")&&-1<t.indexOf("MSIE")&&!r||!!window.ActiveXObject||"ActiveXObject"in window,n=-1<t.indexOf("Windows NT 6.1; Trident/7.0;")&&!o,i=-1<t.indexOf("Firefox"),a=-1<t.indexOf("Safari")&&-1==t.indexOf("Chrome"),l=-1<t.indexOf("Chrome")&&-1<t.indexOf("Safari");return o&&(e.type="IE",null!=navigator.userAgent&&navigator.userAgent.match(/Trident\/7\./)?e.IEVersion="IE11":(new RegExp("MSIE (\\d+\\.\\d+);").test(t),o=parseFloat(RegExp.$1),e.IEVersion=7==o?"IE7":8==o?"IE8":9==o?"IE9":10==o?"IE10":11==o?"IE11":"Unknown")),i&&(e.type="FF"),r&&(e.type="Opera"),a&&(e.type="Safari"),l&&(e.type="Chrome"),n&&(e.type="Edge"),e}var BifSourceUiService=function(c){function e(e,t,r,o,n,i,a,l,s){s=c.call(this,t,r,o,n,i,a,l,s)||this;return s.navigationService=e,s.frameContext=t,s.modalService=r,s.messager=o,s.injector=n,s.cfr=i,s.loader=a,s.localeId=l,s.uiStateKeyCreationResult=BIF_UISTATE_KEY_CREATION_RESULT,s}return __extends(e,c),e.prototype.openBillCreationProcessSelector4Push=function(e,t,r,o,n){var i=new FormGetBillCreationProcessEntityExArgs;return i.upBillVoId=e,i.manualCreationMode=ManualCreationMode.Push,this.openBillCreationProcessSelector(i,PushSelectorComponent,r,o,n)},e.prototype.openBillCreationProcessSelector4SpecificPush=function(e,t,r,o,n,i){var a=new FormGetBillCreationProcessEntityExArgs;return a.upBillVoId=e,a.downBillVoId=t,a.manualCreationMode=ManualCreationMode.SpecificPush,this.openBillCreationProcessSelector(a,PushSelectorComponent,o,n,i)},e.prototype.openTargetForm=function(e,t,r){var o,n;if(null==e)throw"参数formSettings不可为空";if(null==t)throw"参数creationResult不可为空";if("string"==typeof t){if(""==t)throw"参数creationResult不可为空";var i=new runtimeApi.FormBillCreationProcessExecutorResult;i.LoadFromJson(t),t=i}if(t instanceof runtimeApi.FormBillCreationProcessExecutorResult==0&&((i=new runtimeApi.FormBillCreationProcessExecutorResult).LoadFromJsonObject(t),t=i),0==t.conditionResult.conditionExecutionResult)this.messager.error(t.conditionResult.message||this.localePipe.transform("creationExecutionError"));else if(null==t.creationRuleExecutorResult||null==t.creationRuleExecutorResult.mappingResults||0==t.creationRuleExecutorResult.mappingResults.length)this.messager.error(this.localePipe.transform("creationResultEmpty"));else if(1==t.creationRuleExecutorResult.mappingResults.length)null!=(s=e.targetCardAppLoadCmd)&&""!=s&&(null==r?r={action:s}:r.action=null!=r.action&&""!=r.action?r.action:s),this.openApp(t.creationRuleExecutorResult.mappingResults[0].associations[0].tarRootDataId,e.targetCardAppId,e.targetCardAppEntrance,t,r,!1);else{if(null!=e.targetListAppId)throw"暂不支持打开批量编辑界面";try{for(var a=__values(t.creationRuleExecutorResult.mappingResults),l=a.next();!l.done;l=a.next()){var s,c=l.value,p=new runtimeApi.FormBillCreationProcessExecutorResult;p.conditionResult=t.conditionResult,p.creationRuleExecutorResult=new runtimeApi.RpcCreationRuleExecutorResult,p.creationRuleExecutorResult.bizFlowchartId=t.creationRuleExecutorResult.bizFlowchartId,p.creationRuleExecutorResult.creationRuleId=t.creationRuleExecutorResult.creationRuleId,p.creationRuleExecutorResult.creationRuleInstanceId=t.creationRuleExecutorResult.creationRuleInstanceId,p.creationRuleExecutorResult.mappingResults=[c],null!=(s=e.targetCardAppLoadCmd)&&""!=s&&(null==r?r={action:s}:r.action=null!=r.action&&""!=r.action?r.action:s),this.openApp(c.associations[0].tarRootDataId,e.targetCardAppId,e.targetCardAppEntrance,p,r,!1)}}catch(u){o={error:u}}finally{try{l&&!l.done&&(n=a["return"])&&n.call(a)}finally{if(o)throw o.error}}}},e.prototype.openApp=function(e,t,r,o,n,i,a,l,s){n=null==n?{}:n;var c=judgeBrowserType();"IE"==c.type&&"IE11"==c.IEVersion?(window.top.localStorage.setItem(e,o.ConvertToJson()),this.navigationService.openApp(e,t,r,n,i,a,l,s)):this.navigationService.openApp(e,t,r,this.buildRouteParams(o,n),i,a,l,s)},e.prototype.buildRouteParams=function(e,t){return t[this.uiStateKeyCreationResult]=e.ConvertToJson(),null!=t.action&&""!=t.action||(t.action="rootviewmodelbifLoad1"),t},e.prototype.openTargetApp=function(e,t,r,o){var n,i;if(null==e)throw"参数formSettings不可为空";if(null==r)throw"参数creationResult不可为空";if("string"==typeof r){if(""==r)throw"参数creationResult不可为空";r=commonApi$1.BpmnModelJsonHelper.FromJson(r,GeneralTextIdWithDataId)}if(0==t.conditionExecutionResult)this.messager.error(t.message||this.localePipe.transform("creationExecutionError"));else if(null==r||null==r.length||r.length<=0)this.messager.error(this.localePipe.transform("creationResultEmpty"));else if(1==r.length)null!=(s=e.targetCardAppLoadCmd)&&""!=s&&(null==o?o={action:s}:o.action=null!=o.action&&""!=o.action?o.action:s),this.openAppWithGeneralText(r[0].dataId,e.targetCardAppId,e.targetCardAppEntrance,r[0].generalTextId,o,!1);else{if(null!=e.targetListAppId)throw"暂不支持打开批量编辑界面";try{for(var a=__values(r),l=a.next();!l.done;l=a.next()){var s,c=l.value;null!=(s=e.targetCardAppLoadCmd)&&""!=s&&(null==o?o={action:s}:o.action=null!=o.action&&""!=o.action?o.action:s),this.openAppWithGeneralText(c.dataId,e.targetCardAppId,e.targetCardAppEntrance,c.generalTextId,o,!1)}}catch(p){n={error:p}}finally{try{l&&!l.done&&(i=a["return"])&&i.call(a)}finally{if(n)throw n.error}}}},e.prototype.openAppWithGeneralText=function(e,t,r,o,n,i,a,l,s){n=null==n?{}:n;var c=judgeBrowserType();"IE"==c.type&&"IE11"==c.IEVersion&&window.top.localStorage.setItem(e,o),this.navigationService.openApp(e,t,r,this.buildRouteParamsWithGeneralText(o,n),i,a,l,s)},e.prototype.buildRouteParamsWithGeneralText=function(e,t){return t[this.uiStateKeyCreationResult]=e,null!=t.action&&""!=t.action||(t.action="rootviewmodelbifLoad1"),t},e.decorators=[{type:core$1.Injectable}],e.ctorParameters=function(){return[{type:commandServices.NavigationService},{type:devkit.FrameContext},{type:uiModal.BsModalService},{type:uiMessager.MessagerService},{type:core$1.Injector},{type:core$1.ComponentFactoryResolver},{type:core$1.NgModuleFactoryLoader},{type:String,decorators:[{type:core$1.Inject,args:[core$1.LOCALE_ID]}]},{type:commandServices.RuntimeFrameworkService,decorators:[{type:core$1.Optional}]}]},e}(AbstractUiService),PullSelectorComponent=function(){function e(e,t,r,o,n,i,a,l){var s=this;this.dataService=t,this.loading=o,this.elementRef=n,this.inj=i,this.cfr=a,this.messagerService=l,this.ttData=[],this.ttIdField="voId",this.ttSearchFields=[],this.dgData=[],this.dgIdField="id",this.procData=[],this.scene="Pull",this.bsModalRef4BifSelector=null,this.subject4CreationProcess=new rxjs.Subject,this.clickOk4BifSelector=function(){null==s.selectedEntity?s.messagerService.error(s.localePipe.instant("pleaseSelectOneCreationProcess")):(s.subject4CreationProcess.next(s.selectedEntity),s.subject4CreationProcess.complete(),s.bsModalRef4BifSelector.close())},this.clickClose4BifSelector=function(){s.bsModalRef4BifSelector.close()},this.args=new FormGetBillCreationProcessEntityExArgs,this.args.LoadFromJsonObject(e),this.localePipe=new LocalePipe(r),null==i&&(t=core$1.ReflectiveInjector.resolveAndCreate([uiMessager.MessagerService]),this.inj=t),this.cfr=a||this.inj.get(core$1.ComponentFactoryResolver),this.messagerService=l||this.inj.get(uiMessager.MessagerService,null)}return e.prototype.ngOnInit=function(){this.ttDataRoot={id:"*",data:{voId:"*",voName:this.localePipe.instant("all")},parent:null,expanded:!0,children:[]},this.ttData=[this.ttDataRoot],this.configTtColumns(),this.configDgColumns(),this.configTtEvents(),this.configDgEvents(),this.loadItems()},e.prototype.loadItems=function(){var t=this;this.loading.show({container:this.elementRef});(null==this.args.upBillVoId?this.dataService.getSlimBillCreationProcessEntityExesByDownBillVoId4Pull(this.args.downBillVoId):this.dataService.getSlimBillCreationProcessEntityExesByUpBillVoIdAndDownBillVoId4SpecificPull(this.args.upBillVoId,this.args.downBillVoId)).subscribe(function(e){t.loading.close(),t.procData=e||[],t.dgData=__spread(t.procData);var r=[];t.procData.forEach(function(t){0==r.some(function(e){return e.voId==t.upBillVoId})&&r.push({voId:t.upBillVoId,voName:t.upBillVoName})}),t.ttDataRoot.children=r.map(function(e){return{id:e.voId,data:{voId:e.voId,voName:e.voName},expanded:!0}}),t.ttData=[t.ttDataRoot],t.dgData&&0<t.dgData.length&&(t.selectedEntity=t.dgData[0],setTimeout(function(){t.dg.clearSelections(),t.dg.selectRow(t.dgData[0].id)},0))},function(e){throw t.loading.close(),e})},e.prototype.configTtColumns=function(){this.ttCols=[{field:"voName",title:this.localePipe.instant("upstreamBill"),width:120}]},e.prototype.configDgColumns=function(){this.dgCols=[{field:"code",title:this.localePipe.transform("processCode"),width:120,sortable:!0},{field:"name",title:this.localePipe.transform("processName"),width:250,sortable:!0}]},e.prototype.configTtEvents=function(){var e=this;this.tt.nodeSelected.subscribe(function(t){"*"==t.node.id?e.dgData=__spread(e.procData):e.dgData=__spread(e.procData.filter(function(e){return e.upBillVoId==t.node.data.voId})),e.dgData&&0<e.dgData.length&&(e.selectedEntity=e.dgData[0],setTimeout(function(){e.dg.clearSelections(),e.dg.selectRow(e.dgData[0].id)},0))})},e.prototype.configDgEvents=function(){var t=this;this.dg.selectChanged.subscribe(function(e){t.selectedEntity=e.data})},e.decorators=[{type:core$1.Component,args:[{selector:"lib-bif-pull-selector",template:'<div class="g-main" style="padding-left: 24px; padding-right: 24px;">\r\n  <div class="d-flex flex-row"\r\n    style="height: 100%; width: 100%; border: 1px solid #E9ECF3; box-shadow: 0 2px 6px 0 rgb(31 35 41 / 6%); border-radius: 6px;">\r\n    <div class="d-flex flex-column" style="width: 200px;" ngResizable rzAspectRatio="true" [rzHandles]="\'e\'">\r\n      <farris-treetable #tt class="f-utils-fill-flex-column" [data]="ttData" [columns]="ttCols" [idField]="ttIdField"\r\n        [fit]="true" [showHeader]="true" [fixedHeader]="true" [singleSelect]="true">\r\n      </farris-treetable>\r\n    </div>\r\n\r\n    <div class="f-utils-fill-flex-row" style="padding-left: 15px;">\r\n      <div class="d-flex flex-column" style="width: 100%;">\r\n        <div class="f-utils-fill-flex-column">\r\n          <farris-datagrid #dg [fit]="true" [fitColumns]="true" [data]="dgData" [columns]="dgCols" [idField]="dgIdField"\r\n            [showHeader]="true" [showBorder]="true" [striped]="true" [pagination]="false" [showLineNumber]="true">\r\n          </farris-datagrid>\r\n        </div>\r\n        <div class="form-group" style="">\r\n          <div>{{ \'processDesciption\' | locale }}</div>\r\n          <textarea readonly class="form-control" name="description" rows="3"\r\n            [ngModel]="selectedEntity&&selectedEntity.description"></textarea>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n',styles:[""]}]}],e.ctorParameters=function(){return[{type:undefined,decorators:[{type:core$1.Inject,args:[SELECTOR_ARGS_INJECTOR]}]},{type:BifDataService},{type:String,decorators:[{type:core$1.Inject,args:[core$1.LOCALE_ID]}]},{type:uiLoading.LoadingService},{type:core$1.ElementRef},{type:core$1.Injector,decorators:[{type:core$1.Optional}]},{type:core$1.ComponentFactoryResolver,decorators:[{type:core$1.Optional}]},{type:uiMessager.MessagerService,decorators:[{type:core$1.Optional}]}]},e.propDecorators={tt:[{type:core$1.ViewChild,args:["tt"]}],dg:[{type:core$1.ViewChild,args:["dg"]}]},e}();function canJSONParse(e){try{if("object"==typeof JSON.parse(e))return!0}catch(t){}return!1}var BifTargetUiService=function(c){function e(e,t,r,o,n,i,a,l,s){s=c.call(this,t,r,o,n,i,a,l,s)||this;return s.dataService=e,s.frameContext=t,s.modalService=r,s.messager=o,s.injector=n,s.cfr=i,s.loader=a,s.localeId=l,s.uiStateKeyCreationResult=BIF_UISTATE_KEY_CREATION_RESULT,s}return __extends(e,c),e.prototype.openBillCreationProcessSelector4Pull=function(e,t,r,o,n){var i=new FormGetBillCreationProcessEntityExArgs;return i.downBillVoId=e,i.manualCreationMode=ManualCreationMode.Pull,this.openBillCreationProcessSelector(i,PullSelectorComponent,r,o,n)},e.prototype.openBillCreationProcessSelector4SpecificPull=function(e,t,r,o,n,i){var a=new FormGetBillCreationProcessEntityExArgs;return a.upBillVoId=e,a.downBillVoId=t,a.manualCreationMode=ManualCreationMode.SpecificPull,this.openBillCreationProcessSelector(a,PullSelectorComponent,o,n,i)},e.prototype.openSourceDataSelector4Pull=function(o,n,i){var a=this,l=((n=null==n?this.defaultModalOptions:n).title=null==n.title?this.localePipe.transform("sourceDataSelector"):n.title,null);if(null==o||null==o.sourceDataSelectorModuleUrl)throw this.messager.error(this.localePipe.instant("noDefaultUpBillSelector")),"暂无默认实现，请使用自定义来源单据选择器。请确保生单流程中【集成场景】启用了【人工拉式生单】场景，并且【单据配置】-【拉式生单配置】-【上游应用入口】或【URL】不为空";return(null!=o.sourceDataSelectorAppId?rxjs.from(System["import"](o.sourceDataSelectorModuleUrl.toLowerCase()).then(function(e){return e})).pipe(operators.switchMap(function(e){for(var t in e)return rxjs.of(e[t]);return rxjs.of(null)})):rxjs.from(this.loader.load(o.sourceDataSelectorModuleUrl))).pipe(operators.switchMap(function(e){var t,r=e.create(a.frameContext.root.injector);return r.instance.createSourceDataSelector&&r.instance.createSourceDataSelector instanceof Function?(e=r.instance.createSourceDataSelector(a.frameContext.root.injector,null,i))instanceof rxjs.Observable?e.pipe(operators.switchMap(function(e){return l=e,a.configModalButtons(n,l),l.instance.bsModalRef4BifSelector=a.modalService.show(l,n),l.instance.subject4EntityDatas.asObservable()})):e instanceof core$1.ComponentRef?(l=e,a.configModalButtons(n,l),l.instance.bsModalRef4BifSelector=a.modalService.show(l,n),l.instance.subject4EntityDatas.asObservable()):void 0:(t=r.injector.get(core.TranslateService)).getTranslation(a.localeId).pipe(operators.switchMap(function(e){return t.setTranslation(a.localeId,e),t.defaultLang=a.localeId,t.currentLang=a.localeId,a.getEntityData(r,o,n,i)}),operators.catchError(function(e){return console.error(e),a.getEntityData(r,o,n,i)}))}))},e.prototype.getFormBillCreationProcessExecutorResult=function(){var e=this.runtimeFrameworkService.tabId||this.getQueryString("tabId")||"",e=e.substr(e.length-36),t=judgeBrowserType(),e=("IE"==t.type&&"IE11"==t.IEVersion&&(t=window.top.localStorage.getItem(e),window.top.localStorage.removeItem(e),this.frameContext.root.uiState.setPropertyValue(this.uiStateKeyCreationResult,t)),this.frameContext.root.uiState[this.uiStateKeyCreationResult]);if(null==e)throw"FormBillCreationProcessExecutorResult is null";t=new runtimeApi.FormBillCreationProcessExecutorResult;if("string"==typeof e)t.LoadFromJson(e);else{if("object"!=typeof e)throw"不合法的类型";t.LoadFromJsonObject(e)}return t},e.prototype.getQueryString=function(e){e=new RegExp("(^|&)"+e+"=([^&]*)(&|$)","i"),e=window.location.search.substr(1).match(e);return null!=e?unescape(e[2]):null},e.prototype.getCreationResult=function(){var e=this.runtimeFrameworkService.tabId||this.getQueryString("tabId")||"",e=e.substr(e.length-36),t=judgeBrowserType(),e=("IE"==t.type&&"IE11"==t.IEVersion&&(t=window.top.localStorage.getItem(e),window.top.localStorage.removeItem(e),this.frameContext.root.uiState.setPropertyValue(this.uiStateKeyCreationResult,t)),this.frameContext.root.uiState[this.uiStateKeyCreationResult]);if(null==e)throw"FormBillCreationProcessExecutorResult is null";t=new runtimeApi.FormBillCreationProcessExecutorResult;if("string"==typeof e)return canJSONParse(e)?(t.LoadFromJson(e),rxjs.of(t)):this.dataService.getCreationResultById(e);if("object"==typeof e)return t.LoadFromJsonObject(e),rxjs.of(t);throw"不合法的类型"},e.prototype.configModalButtonsByService=function(e,t){e.buttons=[{text:this.localePipe.transform("confirm"),cls:"btn btn-primary",handle:t.clickOk4BifSelector},{text:this.localePipe.transform("cancel"),cls:"btn btn-secondary",handle:t.clickClose4BifSelector}],e.showButtons=!0},e.prototype.getEntityData=function(o,e,t,r){var n=null,i=null,a="app-rootcomponent",l=o.componentFactoryResolver._factories,s=null,c=(r&&r.bootstrapComponentSelector?(a=r.bootstrapComponentSelector,l.forEach(function(e,t,r){e=e.selector;a==e&&(n=o.componentFactoryResolver.resolveComponentFactory(t),i=n.create(o.injector))})):(c=o._bootstrapComponents[0])?(n=o.componentFactoryResolver.resolveComponentFactory(c),i=n.create(o.injector)):l.forEach(function(e,t,r){e=e.selector;a==e&&(n=o.componentFactoryResolver.resolveComponentFactory(t),i=n.create(o.injector))}),i&&i.instance&&i.instance.viewModel&&i.instance.viewModel.uiState&&(i.instance.viewModel.uiState.setPropertyValue("action","Load1"),i.instance.viewModel.uiState.setPropertyValue("DEVKIT_DIALOG",!0)),i.injector.get(AbstractBifDataSelectorService,null)),s=(null!=c?(this.configModalButtonsByService(t,c),c.bsModalRef4BifSelector=this.modalService.show(i,t),c):(this.configModalButtons(t,i),i.instance.bsModalRef4BifSelector=this.modalService.show(i,t),i.instance)).subject4EntityDatas.asObservable();return i&&i.instance&&i.instance.viewModel&&r&&r.loadCommand&&(l=r.loadCommand,c=i.instance.viewModel[l])&&(t=undefined,r&&r.loadParams&&(t=Array.isArray(r.loadParams)?r.loadParams:[r.loadParams]),c.apply(i.instance.viewModel,t)),s},e.decorators=[{type:core$1.Injectable}],e.ctorParameters=function(){return[{type:BifDataService},{type:devkit.FrameContext},{type:uiModal.BsModalService},{type:uiMessager.MessagerService},{type:core$1.Injector},{type:core$1.ComponentFactoryResolver},{type:core$1.NgModuleFactoryLoader},{type:String,decorators:[{type:core$1.Inject,args:[core$1.LOCALE_ID]}]},{type:commandServices.RuntimeFrameworkService,decorators:[{type:core$1.Optional}]}]},e}(AbstractUiService),ɵ0=localStorage.getItem("languageCode")||"zh-CHS",ɵ1={},BifManualCreationModule=function(){function t(){}return t.forRoot=function(e){return{ngModule:t,providers:[{provide:ModuleConfig,useValue:e||{}},BifDataService,BifSourceUiService,BifTargetUiService]}},t.decorators=[{type:core$1.NgModule,args:[{declarations:[PushSelectorComponent,PullSelectorComponent,LocalePipe],imports:[common.CommonModule,forms.FormsModule,http.HttpClientModule,uiModal.ModalModule.forRoot(),uiDraggable.AngularDraggableModule,uiCommon.FarrisCommonModule.forRoot(),uiDatagridEditors.DatagridEditorsModule,uiDatagrid.DatagridModule.forRoot(__spread(uiDatagridEditors.EditorProviders)),uiTree.TreeModule,uiTreetable.TreeTableModule,uiLoading.LoadingModule.forRoot({message:"Loading..."}),uiNotify.NotifyModule.forRoot(),uiMessager.MessagerModule.forRoot({width:550,height:450}),uiInputGroup.InputGroupModule,uiLanguageTextbox.LanguageTextboxModule,uiNumberSpinner.NumberSpinnerModule,uiSwitch.SwitchModule,uiSection.FarrisSectionModule],providers:[{provide:core$1.LOCALE_ID,useValue:ɵ0},{provide:ModuleConfig,useValue:ɵ1},{provide:core$1.NgModuleFactoryLoader,useClass:core$1.SystemJsNgModuleLoader},BifDataService,BifSourceUiService,BifTargetUiService],exports:[PushSelectorComponent,PullSelectorComponent],entryComponents:[PushSelectorComponent,PullSelectorComponent]}]}],t}(),CanTrackingResult=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.ResetBeforeLoadFrom=function(){t.prototype.ResetBeforeLoadFrom.call(this),this.billTrackingSettings=null,this.voName=null},e.prototype.ConvertToJsonObject=function(){var e=t.prototype.ConvertToJsonObject.call(this);return commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"billTrackingSettings",this.billTrackingSettings),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"voName",this.voName),e},e.prototype.LoadFromJsonObject=function(e){t.prototype.LoadFromJsonObject.call(this,e),this.billTrackingSettings=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"billTrackingSettings"),this.voName=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"voName")},e}(CanTrackingInfo),GetChildrenEntityDataArgs=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.ResetBeforeLoadFrom=function(){t.prototype.ResetBeforeLoadFrom.call(this),this.voId=null,this.voMetadataId=null,this.suCode=null,this.nodeCodes=null,this.hierachyIdList=null},e.prototype.ConvertToJsonObject=function(){var e=t.prototype.ConvertToJsonObject.call(this);return commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"voId",this.voId),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"voMetadataId",this.voMetadataId),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"suCode",this.suCode),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"nodeCodes",commonApi$1.BpmnModelJsonHelper.StringListToJson(this.nodeCodes)),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"hierachyIdList",commonApi$1.BpmnModelJsonHelper.StringListToJson(this.hierachyIdList)),e},e.prototype.LoadFromJsonObject=function(e){t.prototype.LoadFromJsonObject.call(this,e),this.voId=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"voId"),this.voMetadataId=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"voMetadataId"),this.suCode=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"suCode"),this.nodeCodes=commonApi$1.BpmnModelJsonHelper.StringListFromJson(commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"nodeCodes")),this.hierachyIdList=commonApi$1.BpmnModelJsonHelper.StringListFromJson(commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"hierachyIdList"))},e}(commonApi$1.JsonConvertableImpl),DownBillInfoResult=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.ResetBeforeLoadFrom=function(){t.prototype.ResetBeforeLoadFrom.call(this),this.voName=null},e.prototype.ConvertToJsonObject=function(){var e=t.prototype.ConvertToJsonObject.call(this);return commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"voName",this.voName),e},e.prototype.LoadFromJsonObject=function(e){t.prototype.LoadFromJsonObject.call(this,e),this.voName=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"voName")},e}(DownBillInfo),EntityDataResult=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.ResetBeforeLoadFrom=function(){t.prototype.ResetBeforeLoadFrom.call(this),this.billSchema=null,this.billData=null},e.prototype.ConvertToJsonObject=function(){var e=t.prototype.ConvertToJsonObject.call(this);return commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"billSchema",this.billSchema),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"billData",this.billData),e},e.prototype.LoadFromJsonObject=function(e){t.prototype.LoadFromJsonObject.call(this,e),this.billSchema=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsJsonSerializable(e,"billSchema",commonApi$1.BillSchema),this.billData=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsJsonSerializable(e,"billData",commonApi$1.BillData)},e}(commonApi$1.JsonConvertableImpl),GetEntityDataArgs=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.billChildInfos=[],e}return __extends(e,t),e.prototype.ResetBeforeLoadFrom=function(){t.prototype.ResetBeforeLoadFrom.call(this),this.schemaId=null,this.dataId=null,this.suCode=null,this.voMetadataId=null,this.billChildInfos=[],this.trackingSourceType=null,this.curYear=null,this.documentTypeId=null},e.prototype.ConvertToJsonObject=function(){var e=t.prototype.ConvertToJsonObject.call(this);return commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"schemaId",this.schemaId),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"dataId",this.dataId),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"suCode",this.suCode),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"voMetadataId",this.voMetadataId),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"billChildInfos",this.billChildInfos),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"trackingSourceType",this.trackingSourceType),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"curYear",this.curYear),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"documentTypeId",this.documentTypeId),e},e.prototype.LoadFromJsonObject=function(e){t.prototype.LoadFromJsonObject.call(this,e),this.schemaId=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"schemaId"),this.dataId=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"dataId"),this.suCode=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"suCode"),this.voMetadataId=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"voMetadataId"),this.billChildInfos=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsList(e,"billChildInfos",BillChildInfo),this.trackingSourceType=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"trackingSourceType"),this.curYear=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"curYear"),this.documentTypeId=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"documentTypeId")},e}(commonApi$1.JsonConvertableImpl),GetMainEntityDataArgs=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(GetEntityDataArgs),UpBillInfoResult=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.ResetBeforeLoadFrom=function(){t.prototype.ResetBeforeLoadFrom.call(this),this.voName=null},e.prototype.ConvertToJsonObject=function(){var e=t.prototype.ConvertToJsonObject.call(this);return commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"voName",this.voName),e},e.prototype.LoadFromJsonObject=function(e){t.prototype.LoadFromJsonObject.call(this,e),this.voName=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"voName")},e}(UpBillInfo),GetJointQueryParametersArgs=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.contents=[],e}return __extends(e,t),e.prototype.ResetBeforeLoadFrom=function(){t.prototype.ResetBeforeLoadFrom.call(this),this.trackingSourceType=null,this.suCode=null,this.schemaId=null,this.dataId=null,this.contents=[],this.curYear=null},e.prototype.ConvertToJsonObject=function(){var e=t.prototype.ConvertToJsonObject.call(this);return commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"trackingSourceType",this.trackingSourceType),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"suCode",this.suCode),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"schemaId",this.schemaId),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"dataId",this.dataId),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"contents",this.contents),commonApi$1.BpmnModelJsonHelper.SetAttributeValue(e,"curYear",this.curYear),e},e.prototype.LoadFromJsonObject=function(e){t.prototype.LoadFromJsonObject.call(this,e),this.trackingSourceType=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"trackingSourceType"),this.suCode=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"suCode"),this.schemaId=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"schemaId"),this.dataId=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"dataId"),this.contents=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsList(e,"contents",JointQueryParametersContent),this.curYear=commonApi$1.BpmnModelJsonHelper.GetAttributeValueAsString(e,"curYear")},e}(commonApi$1.JsonConvertableImpl),BillTrackerArgs=function(){function e(){this.getBillsInfoArgs=null,this.canTrackingResult=null,this.direction=null,this.graphOptions=null,this.gridOptions=null}return e.decorators=[{type:core$1.Injectable}],e.ctorParameters=function(){return[]},e}(),BillTrackerConstant=function(){function e(){}return e.IMAGE_PATH="/platform/runtime/common/web/@edp-bif/runtime-api/images",e.DEFAULT_FUNC_ID="DefaultBillTracker",e.DEFAULT_APP_ID="BillIntegrationFrameworkRT",e.DEFAULT_APP_ENTRANCE="default-bill-tracker",e.BILL_VIEWER_FUNC_ID="BifBillViewer",e.BILL_VIEWER_APP_ID="BillIntegrationFrameworkRT",e.BILL_VIEWER_APP_ENTRANCE="bif-bill-viewer",e.BILL_VIEWER_PARAM_CODE_CUSTOM_TAB_NAME="__tab_name__",e}(),BillTrackerModuleConfig=function(){},BillTrackerDirection={Down:"Down",Up:"Up",Both:"Both"},BillTrackerGraphOptions=function(){this.nodeWidth=100,this.nodeHeight=60,this.overlayWidth=10,this.overlayHeight=10,this.showDownBills=!0,this.showUpBills=!0},BillTrackerGridOptions=function(){this.showEntryData=!0,this.defaultHeight=180},GraphView=function(o){function e(e){e=o.call(this,e)||this;return e.gridSteps=4,e.minGridSize=4,e.gridImage=mxClientType.IS_SVG?"data:image/gif;base64,R0lGODlhCgAKAJEAAAAAAP///8zMzP///yH5BAEAAAMALAAAAAAKAAoAAAIJ1I6py+0Po2wFADs=":BillTrackerConstant.IMAGE_PATH+"/grid.gif",e.gridColor="#e0e0e0",e}return __extends(e,o),e.prototype.validate=function(e){var t,r=this.graph;null!=r&&null!=r.container&&mxUtilsType.hasScrollbars(r.container)&&(t=r.getPagePadding(),r=r.getPageSize(),this.translate.x,this.translate.y,this.translate.x=t.x/this.scale-(this.x0||0)*r.width,this.translate.y=t.y/this.scale-(this.y0||0)*r.height),o.prototype.validate.call(this,e)},e.prototype.getBackgroundPageBounds=function(){var e=this.graph,t=e.getPageLayout(),e=e.getPageSize();return new mxRectangleType(this.scale*(this.translate.x+t.x*e.width),this.scale*(this.translate.y+t.y*e.height),this.scale*t.width*e.width,this.scale*t.height*e.height)},e}(mxGraphViewType),BillNodeShape=function(n){function e(e,t,r,o){return e=e||new mxRectangleType(0,0,0,0),t=t||"none",r=r||"#000000",o=o||undefined,n.call(this,e,t,r,o)||this}return __extends(e,n),e.prototype.init=function(e){n.prototype.init.call(this,e),this.fill="none",this.stroke="#000000"},e}(mxRectangleShapeType),BillAssociationLine=function(o){function e(e,t,r){return o.call(this,e,t,r)||this}return __extends(e,o),e}(mxLineType),Events=function(){function e(){}return e.RESET_GRAPH_VIEW="resetGraphView",e.CLICK_FIRST_SUMMARY="clickFirstSummary",e.BILL_CELLS_ADDED_AND_MOVED="billCellsAddedAndMoved",e}(),BillCell=function(i){function e(e,t,r,o,n){o=i.call(this,null,o,n)||this,o.THUMB_SCALE=.6,o.billDataInfo=e,o.billInfo=t,n=new commonApi.BillTrackingSettings;return t&&t.billTrackingSettings&&n.LoadFromJson(t.billTrackingSettings),o.entry=r,o}return __extends(e,i),e.prototype.getCaption=function(){var e=new commonApi.BillTrackingSettings;return this.billInfo&&this.billInfo.billTrackingSettings&&e.LoadFromJson(this.billInfo.billTrackingSettings),this.billDataInfo.caption||e.billNodeName||this.billInfo.voName||this.billDataInfo.dataId||this.billDataInfo.summary},e.prototype.buildHtmlTooltip=function(){return"            <span>"+this.billDataInfo.dataId+"</span>        "},e.prototype.buildHtmlLabel=function(e){return this.buildHtmlLabelByDOM(e)},e.prototype.buildHtmlLabelByDOM=function(i){var a=this,e=i.view.scale,t=(i.view.getState(this),this.geometry.width),r=this.geometry.height,o=new commonApi.BillTrackingSettings,o=(this.billInfo&&this.billInfo.billTrackingSettings&&o.LoadFromJson(this.billInfo.billTrackingSettings),this.billDataInfo.caption||o.billNodeName||this.billInfo.voName||this.billDataInfo.dataId||this.billDataInfo.summary),n=this.entry,l=document.createElement("div");if(l.classList.add("bif-cell-node"),l.style.width=t+"px",l.style.height=r+"px",n&&(t=document.createElement("div"),l.appendChild(t),t.classList.add("bif-cell-node-current"),s=document.createElement("span"),t.appendChild(s),s.classList.add("bif-cell-node-current-text"),s.innerHTML=i&&i.localePipe&&i.localePipe.transform("currentNode")||"当前"),e<this.THUMB_SCALE){var t=document.createElement("div"),s=(l.appendChild(t),t.classList.add("bif-cell-node-title-only"),document.createElement("div")),e=(t.appendChild(s),s.classList.add("bif-cell-node-title-only-text"),s.innerHTML=o,this.billInfo.jointQueryMode),t=JSON.parse(this.billInfo.jointQueryParameters);(e==commonApi.JointQueryMode.APP&&t.funcId||e==commonApi.JointQueryMode.URL&&t.url)&&(s.classList.add("bif-cell-node-title-link"),mxEventType.addListener(s,"click",function(){return i.fireEvent(new mxEventObjectType(Events.CLICK_FIRST_SUMMARY,"cell",a)),event.stopPropagation(),!1}))}else{var e=document.createElement("div"),t=(l.appendChild(e),e.classList.add("bif-cell-node-main"),document.createElement("div")),s=(e.appendChild(t),t.classList.add("bif-cell-node-title"),document.createElement("div")),c=(t.appendChild(s),s.classList.add("bif-cell-node-title-text"),s.innerHTML=o,s.title=o,document.createElement("div"));e.appendChild(c),c.classList.add("bif-cell-node-summary-list"),c.style.minHeight=r-46+"px";try{var p=commonApi$1.BpmnModelJsonHelper.FromJson(this.billDataInfo.summary,FieldNameAndValue);p&&p.forEach(function(e,t){var r=document.createElement("div"),o=(c.appendChild(r),r.classList.add("bif-cell-node-summary"),document.createElement("div")),n=(r.appendChild(o),o.classList.add("bif-cell-node-summary-caption"),document.createElement("div")),o=(o.appendChild(n),n.classList.add("bif-cell-node-summary-caption-text"),n.title=e.name,n.innerHTML=e.name,document.createElement("div")),n=(r.appendChild(o),o.classList.add("bif-cell-node-summary-value"),document.createElement("div"));o.appendChild(n),n.classList.add("bif-cell-node-summary-value-text"),n.title=e.value,n.innerText=e.value,0==t&&(r=a.billInfo.jointQueryMode,o=JSON.parse(a.billInfo.jointQueryParameters),r==commonApi.JointQueryMode.APP&&o.funcId||r==commonApi.JointQueryMode.URL&&o.url)&&(n.classList.add("bif-cell-node-title-link","bif-cell-node-title-link-color"),mxEventType.addListener(n,"click",function(){return i.fireEvent(new mxEventObjectType(Events.CLICK_FIRST_SUMMARY,"cell",a)),event.stopPropagation(),!1}))})}catch(m){console.error(m)}var u,d=document.createElement("div"),t=(e.appendChild(d),d.classList.add("bif-cell-node-btn-group","bif-cell-node-btn-group-control"),document.createElement("img"));d.appendChild(t),t.src=BillTrackerConstant.IMAGE_PATH+"/view.svg",t.title=i.localePipe.transform("viewBill"),t.classList.add("bif-cell-node-btn"),t.addEventListener("click",function(){i.setSelectionCell(a)}),0==n&&(u=document.createElement("img"),d.appendChild(u),u.src=BillTrackerConstant.IMAGE_PATH+"/more.svg",u.title=i.localePipe.transform("more"),u.classList.add("bif-cell-node-btn"),mxEventType.addListener(u,mxEventType.CLICK,function(e){var t=mxUtilsType.getOffset(u),r=(d.classList.remove("bif-cell-node-btn-group-control"),i.ngComp.morePopupMenu.hideMenu);i.ngComp.morePopupMenu.hideMenu=function(){r.apply(this,arguments),d.classList.add("bif-cell-node-btn-group-control")},i.ngComp.morePopupMenu.popup(t.x,t.y+u.offsetHeight,a,e),i.ngComp.currentMenu=i.ngComp.morePopupMenu}))}return l},e.prototype.buildHtmlLabelByTemplateText=function(e){var e=e.view.getState(this),t=(e&&e.width?e:this.geometry).width,e=(e&&e.height?e:this.geometry).height,r=new commonApi.BillTrackingSettings,r=(this.billInfo&&this.billInfo.billTrackingSettings&&r.LoadFromJson(this.billInfo.billTrackingSettings),this.billDataInfo.caption||r.billNodeName||this.billInfo.voName||this.billDataInfo.dataId||this.billDataInfo.summary),o=this.entry?"rgba(86,160,255,0.08)":"#FFFFFF",n="";try{var i=commonApi$1.BpmnModelJsonHelper.FromJson(this.billDataInfo.summary,FieldNameAndValue);i&&i.forEach(function(e,t){t=0==t?"<a href='javascript:void(0);'>"+e.value+"</a>":e.value;n+='                        <div class="bif-cell-node-summary">                            <div class="bif-cell-node-summary-caption">                                <div class="bif-cell-node-summary-caption-text" title="'+e.name+'">'+e.name+'</div>                            </div>                            <div class="bif-cell-node-summary-value">                                <div class="bif-cell-node-summary-value-text" title="'+e.value+'">'+t+"</div>                            </div>                        </div>                    "})}catch(a){console.error(a)}return'            <div class="bif-cell-node" style="width:'+t+'px;">                <div class="bif-cell-node-main" style="background: '+o+';">                    <div class="bif-cell-node-title">                        <div class="bif-cell-node-title-text">'+r+'</div>                    </div>                    <div class="bif-cell-node-summary-list" style="min-height: '+(e-30)+'px;">                        '+n+"                    </div>                </div>            </div>        "},e}(mxCellType),Base64=function(){function p(){}return p.encode=function(e,t){var r,o,n,i,a,l,s="",c=0;for((t=null!=t&&t)||(e=p._utf8_encode(e));c<e.length;)n=(r=e.charCodeAt(c++))>>2,i=(3&r)<<4|(r=e.charCodeAt(c++))>>4,a=(15&r)<<2|(o=e.charCodeAt(c++))>>6,l=63&o,isNaN(r)?a=l=64:isNaN(o)&&(l=64),s=s+p._keyStr.charAt(n)+p._keyStr.charAt(i)+p._keyStr.charAt(a)+p._keyStr.charAt(l);return s},p._utf8_encode=function(e){e=e.replace(/\r\n/g,"\n");for(var t="",r=0;r<e.length;r++){var o=e.charCodeAt(r);o<128?t+=String.fromCharCode(o):t=127<o&&o<2048?(t+=String.fromCharCode(o>>6|192))+String.fromCharCode(63&o|128):(t=(t+=String.fromCharCode(o>>12|224))+String.fromCharCode(o>>6&63|128))+String.fromCharCode(63&o|128)}return t},p.decode=function(e,t){t=null!=t&&t;var r,o,n,i,a,l,s="",c=0;for(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");c<e.length;)n=this._keyStr.indexOf(e.charAt(c++)),r=(15&(i=this._keyStr.indexOf(e.charAt(c++))))<<4|(a=this._keyStr.indexOf(e.charAt(c++)))>>2,o=(3&a)<<6|(l=this._keyStr.indexOf(e.charAt(c++))),s+=String.fromCharCode(n<<2|i>>4),64!=a&&(s+=String.fromCharCode(r)),64!=l&&(s+=String.fromCharCode(o));return s=t?s:p._utf8_decode(s)},p._utf8_decode=function(e){for(var t,r,o="",n=0,i=0;n<e.length;)(t=e.charCodeAt(n))<128?(o+=String.fromCharCode(t),n++):191<t&&t<224?(i=e.charCodeAt(n+1),o+=String.fromCharCode((31&t)<<6|63&i),n+=2):(i=e.charCodeAt(n+1),r=e.charCodeAt(n+2),o+=String.fromCharCode((15&t)<<12|(63&i)<<6|63&r),n+=3);return o},p._keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",p}(),VertexHandler=function(r){function e(e){return r.call(this,e)||this}return __extends(e,r),e.prototype.getSelectionBounds=function(e){return r.prototype.getSelectionBounds.call(this,e)},e.prototype.redrawHandles=function(){r.prototype.redrawHandles.call(this),null!=this.sizers&&7<this.sizers.length&&(this.sizers[1].node.style.display="none",this.sizers[3].node.style.display="none",this.sizers[4].node.style.display="none",this.sizers[6].node.style.display="none")},e.prototype.createSelectionShape=function(e){var t;return this.state.cell instanceof BillCell?((t=new mxRectangleShapeType(mxRectangleType.fromRectangle(e),null,this.getSelectionColor())).strokewidth=this.getSelectionStrokeWidth(),t.isDashed=this.isSelectionDashed(),t.isRounded=!0,t.style=t.style||[],t.style[mxConstantsType.STYLE_ARCSIZE]=4*this.state.view.scale,t):r.prototype.createSelectionShape.call(this,e)},e}(mxVertexHandlerType),Styles=function(){function e(){}return e.STYLE_BILL_NODE_NAME="billNode",e.STYLE_BILL_NODE_ENTRY_NAME="billNodeEntry",e.STYLE_BILL_ASSOCIATION_NAME="billAssociation",e}(),Graph=(mxCellRendererType.registerShape("billNodeShape",BillNodeShape),mxCellRendererType.registerShape("billAssociationLine",BillAssociationLine),function(a){function e(e,t,r,o){e=a.call(this,e,t,r,o)||this;return e.background="#ffffff",e.autoScroll=!1,e.autoExtend=!0,e.setCellsResizable(!1),e.setCellsEditable(!1),e.setTooltips(!1),e.setHtmlLabels(!0),e.setVertexLabelsMovable(!1),e.setAllowDanglingEdges(!1),e.defineInnerStylesNewBTS(),e.setPanning(!0),e.panningHandler.useLeftButtonForPanning=!0,e.container.style.cursor="grab",e.scrollTileSize=new mxRectangleType(0,0,400,400),e.addListener(Events.RESET_GRAPH_VIEW,e.resetGraphView),e}return __extends(e,a),e.prototype.createGraphView=function(){return new GraphView(this)},e.prototype.createVertexHandler=function(e){return new VertexHandler(e)},e.prototype.getPagePadding=function(){return new mxPointType(Math.max(0,Math.round(this.container.offsetWidth-34)),Math.max(0,Math.round(this.container.offsetHeight-34)))},e.prototype.getPageSize=function(){return this.pageVisible?new mxRectangleType(0,0,this.pageFormat.width*this.pageScale,this.pageFormat.height*this.pageScale):this.getScrollTileSize()},e.prototype.getPageLayout=function(){var e,t,r,o,n,i=this.pageVisible?this.getPageSize():this.getScrollTileSize(),a=this.getGraphBounds();return 0==a.width||0==a.height?new mxRectangleType(0,0,1,1):(o=Math.ceil(a.x/this.view.scale-this.view.translate.x),e=Math.ceil(a.y/this.view.scale-this.view.translate.y),n=Math.floor(a.width/this.view.scale),a=Math.floor(a.height/this.view.scale),t=Math.floor(o/i.width),r=Math.floor(e/i.height),o=Math.ceil((o+n)/i.width)-t,n=Math.ceil((e+a)/i.height)-r,new mxRectangleType(t,r,o,n))},e.prototype.getScrollTileSize=function(){return null==this.scrollTileSize&&(this.scrollTileSize=new mxRectangleType(0,0,400,600)),this.scrollTileSize},e.prototype.getPreferredPageSize=function(e,t,r){var o=this.getPageLayout(),n=this.getPageSize();return new mxRectangleType(0,0,o.width*n.width,o.height*n.height)},e.prototype.sizeDidChange=function(){var e,t,r,o,n,i;null!=this.container&&mxUtilsType.hasScrollbars(this.container)&&(e=this.getPageLayout(),i=this.getPagePadding(),t=this.getPageSize(),o=Math.ceil(2*i.x/this.view.scale+e.width*t.width),n=Math.ceil(2*i.y/this.view.scale+e.height*t.height),null!=(r=this.minimumGraphSize)&&r.width==o&&r.height==n||(this.minimumGraphSize=new mxRectangleType(0,0,o,n)),r=i.x/this.view.scale-e.x*t.width,o=i.y/this.view.scale-e.y*t.height,this.autoTranslate||this.view.translate.x==r&&this.view.translate.y==o?a.prototype.sizeDidChange.call(this):(this.autoTranslate=!0,this.view.x0=e.x,this.view.y0=e.y,n=this.view.translate.x,i=this.view.translate.y,this.view.setTranslate(r,o),this.container.scrollLeft+=(r-n)*this.view.scale,this.container.scrollTop+=(o-i)*this.view.scale,this.autoTranslate=!1))},e.prototype.resetGraphView=function(){var e=this.getGraphBounds(),t=0,t=(this.gridOptions.showEntryData&&(t="string"==typeof this.gridOptions.defaultHeight?0:this.gridOptions.defaultHeight),Math.min(this.container.clientWidth/e.width,(this.container.clientHeight-t-20)/e.height)),e=(this.zoomTo((t=1<=t?1:t)<=.6?.6:t,!0),this.getGraphBounds());Math.max(e.width,this.scrollTileSize.width*this.view.scale),Math.max(e.height,this.scrollTileSize.height*this.view.scale);this.container.scrollTop=Math.floor(Math.max(0,e.y-(this.container.clientHeight-e.height)/2+79)),this.container.scrollLeft=Math.floor(Math.max(0,e.x-(this.container.clientWidth-e.width)/2))},e.prototype.insertBillCell=function(e,t,r,o,n,i,a,l,s,c,p){t=this.createBillCell(e,t,r,o,n,i,a,l,s,c,p);return this.addCell(t,e)},e.prototype.createBillCell=function(e,t,r,o,n,i,a,l,s,c,p){i=new mxGeometryType(i,a,l,s),i.relative=null!=p&&p,a=new BillCell(r,o,n,i,c);return a.setId(t),a.setVertex(!0),a.setConnectable(!0),a},e.prototype.getTooltipForCell=function(e){return e instanceof BillCell?e.buildHtmlTooltip():a.prototype.getTooltipForCell.call(this,e)},e.prototype.getLabel=function(e){return 0 instanceof BillCell,a.prototype.getLabel.call(this,e)},e.prototype.convertValueToString=function(e){return e instanceof BillCell?e.buildHtmlLabel(this):a.prototype.convertValueToString.call(this,e)},e.prototype.defineInnerStylesNewBTS=function(){var e=Object.assign({},this.getStylesheet().getDefaultVertexStyle());e[mxConstantsType.STYLE_FILLCOLOR]="none",e[mxConstantsType.STYLE_STROKE_OPACITY]="0",e[mxConstantsType.STYLE_STROKEWIDTH]="1",e[mxConstantsType.STYLE_FONTCOLOR]="black",e[mxConstantsType.STYLE_FONTSIZE]="12",e[mxConstantsType.STYLE_FONTSTYLE]="1",e[mxConstantsType.STYLE_ROUNDED]="1",e[mxConstantsType.STYLE_SPACING]=8,e[mxConstantsType.STYLE_WHITE_SPACE]="wrap",e[mxConstantsType.STYLE_IMAGE_ASPECT]="0",e[mxConstantsType.STYLE_PERIMETER]=mxPerimeterType.RectanglePerimeter,e[mxConstantsType.STYLE_ALIGN]=mxConstantsType.ALIGN_CENTER,e[mxConstantsType.STYLE_VERTICAL_ALIGN]=mxConstantsType.ALIGN_MIDDLE,this.getStylesheet().putCellStyle(Styles.STYLE_BILL_NODE_NAME,e),e=Object.assign({},e),this.getStylesheet().putCellStyle(Styles.STYLE_BILL_NODE_ENTRY_NAME,e),(e=Object.assign({},this.getStylesheet().getDefaultEdgeStyle()))[mxConstantsType.STYLE_SHAPE]=mxConstantsType.SHAPE_CONNECTOR,e[mxConstantsType.STYLE_STROKECOLOR]="#2A87FF",e[mxConstantsType.STYLE_ENDARROW]=mxConstantsType.ARROW_CLASSIC,e[mxConstantsType.STYLE_VERTICAL_ALIGN]=mxConstantsType.ALIGN_MIDDLE,e[mxConstantsType.STYLE_ALIGN]=mxConstantsType.ALIGN_CENTER,e[mxConstantsType.STYLE_EDGE]=mxConstantsType.EDGESTYLE_ELBOW,e[mxConstantsType.STYLE_ELBOW]=mxConstantsType.ELBOW_HORIZONTAL,e[mxConstantsType.STYLE_STROKEWIDTH]=1.8,e[mxConstantsType.STYLE_DASHED]=1,e[mxConstantsType.STYLE_OPACITY]=80,this.getStylesheet().putCellStyle(Styles.STYLE_BILL_ASSOCIATION_NAME,e)},e.prototype.selectCellForEvent=function(e,t){a.prototype.selectCellForEvent.call(this,e,t)},e.prototype.createCellRenderer=function(){var r=a.prototype.createCellRenderer.call(this),o=r.isLabelEvent;return r.isLabelEvent=function(e,t){return(!(e.cell instanceof BillCell)||!(t&&t.target&&t.target.classList&&t.target.classList.value&&(t.target.classList.value.includes("bif-cell-node-title-link bif-cell-node-title-link-color")||t.target.classList.value.includes("bif-cell-node-btn"))))&&o.apply(r,[e,t])},r},e.createSvgImage=function(e,t,r){r=unescape(encodeURIComponent('<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="'+e+'px" height="'+t+'px" version="1.1">'+r+"</svg>"));return new mxImageType("data:image/svg+xml;base64,"+(window.btoa?btoa(r):Base64.encode(r,!0)),e,t)},e.prototype.destroy=function(){a.prototype.destroy.call(this),this.selectEventEmitter=null},e.handleFill="#29b6f2",e}(mxGraphType)),CompactTreeLayout=function(o){function e(e,t,r){e=o.call(this,e,t,r)||this;return e.useBoundingBox=!1,e}return __extends(e,o),e.prototype.dfs=function(e,t){var r=mxCellPathType.create(e),o=null;if(null!=e&&null==this.visited[r]&&!this.isVertexIgnored(e)){this.visited[r]=e;var o=this.createNode(e),n=this.graph.getModel(),i=null,a=this.graph.getEdges(e,t,this.invert,!this.invert,!1,!0),l=this.graph.getView();this.sortEdges&&this.sortOutgoingEdges(e,a);for(var s=0;s<a.length;s++){var c,p=a[s];this.isEdgeIgnored(p)||(this.resetEdges&&this.setEdgePoints(p,null),this.edgeRouting&&(this.setEdgeStyleEnabled(p,!1),this.setEdgePoints(p,null)),c=null!=(c=l.getState(p))?c.getVisibleTerminal(this.invert):l.getVisibleTerminal(p,this.invert),null!=(p=this.dfs(c,t))&&null!=n.getGeometry(c)&&(null==i?o.child=p:i.next=p,i=p))}}return o},e.prototype.sortIngoingEdges=function(o,e){var n=new mxDictionaryType;e.sort(function(e,t){var e=e.getTerminal(e.getTerminal(!0)==o),r=n.get(e),e=(null==r&&(r=mxCellPathType.create(e).split(mxCellPathType.PATH_SEPARATOR),n.put(e,r)),t.getTerminal(t.getTerminal(!0)==o)),t=n.get(e);return null==t&&(t=mxCellPathType.create(e).split(mxCellPathType.PATH_SEPARATOR),n.put(e,t)),mxCellPathType.compare(r,t)})},e.prototype.execute=function(e,t){this.parent=e;var r,o,n,i,a,l,s,c=this.graph.getModel();if(null==t)if(0<this.graph.getEdges(e,c.getParent(e),this.invert,!this.invert,!1).length)this.root=e;else{var p=this.graph.findTreeRoots(e,!0,this.invert);if(0<p.length)for(var u=0;u<p.length;u++)if(!this.isVertexIgnored(p[u])&&0<this.graph.getEdges(p[u],null,this.invert,!this.invert,!1).length){this.root=p[u];break}}else this.root=t;if(null!=this.root){this.resizeParent?this.parentsChanged=new Object:this.parentsChanged=null,this.parentX=null,this.parentY=null,e!=this.root&&null!=c.isVertex(e)&&this.maintainParentLocation&&null!=(l=this.graph.getCellGeometry(e))&&(this.parentX=l.x,this.parentY=l.y),c.beginUpdate();try{this.visited={},this.node=this.dfs(this.root,e),this.alignRanks&&(this.maxRankHeight=[],this.findRankHeights(this.node,0),this.setCellHeights(this.node,0)),null!=this.node&&(this.layout(this.node),o=r=this.graph.gridSize,this.moveTree||null!=(n=this.getVertexBounds(this.root))&&(r=n.x,o=n.y),(s=null)!=(s=this.isHorizontal()?this.horizontalLayout(this.node,r,o):this.verticalLayout(this.node,null,r,o))&&((a=i=0)<s.x&&(i=-1*Math.abs(r-s.x)),0<s.y&&(a=-1*Math.abs(o-s.y)),0==i&&0==a||this.moveNode(this.node,i,a),this.resizeParent&&this.adjustParents(),this.edgeRouting)&&this.localEdgeProcessing(this.node),null!=this.parentX)&&null!=this.parentY&&null!=(l=this.graph.getCellGeometry(e))&&((l=l.clone()).x=this.parentX,l.y=this.parentY,c.setGeometry(e,l))}finally{c.endUpdate()}}},e.prototype.horizontalLayout=function(e,t,r,o){e.x+=t+e.offsetX,e.y+=r+e.offsetY,o=this.apply(e,o);var n=e.child;if(null!=n){o=this.horizontalLayout(n,e.x,e.y,o);for(var i=e.y+n.offsetY,a=n.next;null!=a;)o=this.horizontalLayout(a,e.x+n.offsetX,i,o),i+=a.offsetY,a=a.next}return o},e}(mxCompactTreeLayoutType),RevertCompactTreeLayout=function(o){function e(e,t,r){e=o.call(this,e,t,r)||this;return e.useBoundingBox=!1,e}return __extends(e,o),e.prototype.dfs=function(e,t){var r=mxCellPathType.create(e),o=null;if(null!=e&&null==this.visited[r]&&!this.isVertexIgnored(e)){this.visited[r]=e;var o=this.createNode(e),n=this.graph.getModel(),i=null,a=this.graph.getEdges(e,t,!this.invert,this.invert,!1,!0),l=this.graph.getView();this.sortEdges&&this.sortIngoingEdges(e,a);for(var s=0;s<a.length;s++){var c,p=a[s];this.isEdgeIgnored(p)||(this.resetEdges&&this.setEdgePoints(p,null),this.edgeRouting&&(this.setEdgeStyleEnabled(p,!1),this.setEdgePoints(p,null)),c=null!=(c=l.getState(p))?c.getVisibleTerminal(!this.invert):l.getVisibleTerminal(p,!this.invert),null!=(p=this.dfs(c,t))&&null!=n.getGeometry(c)&&(null==i?o.child=p:i.next=p,i=p))}}return o},e.prototype.sortIngoingEdges=function(o,e){var n=new mxDictionaryType;e.sort(function(e,t){var e=e.getTerminal(e.getTerminal(!0)==o),r=n.get(e),e=(null==r&&(r=mxCellPathType.create(e).split(mxCellPathType.PATH_SEPARATOR),n.put(e,r)),t.getTerminal(t.getTerminal(!0)==o)),t=n.get(e);return null==t&&(t=mxCellPathType.create(e).split(mxCellPathType.PATH_SEPARATOR),n.put(e,t)),mxCellPathType.compare(r,t)})},e.prototype.execute=function(e,t){this.parent=e;var r,o,n,i,a,l,s,c=this.graph.getModel();if(null==t)if(0<this.graph.getEdges(e,c.getParent(e),!this.invert,this.invert,!1).length)this.root=e;else{var p=this.graph.findTreeRoots(e,!0,!0);if(0<p.length)for(var u=0;u<p.length;u++)if(!this.isVertexIgnored(p[u])&&0<this.graph.getEdges(p[u],null,!this.invert,this.invert,!1).length){this.root=p[u];break}}else this.root=t;if(null!=this.root){this.resizeParent?this.parentsChanged=new Object:this.parentsChanged=null,this.parentX=null,this.parentY=null,e!=this.root&&null!=c.isVertex(e)&&this.maintainParentLocation&&null!=(l=this.graph.getCellGeometry(e))&&(this.parentX=l.x,this.parentY=l.y),c.beginUpdate();try{this.visited={},this.node=this.dfs(this.root,e),this.alignRanks&&(this.maxRankHeight=[],this.findRankHeights(this.node,0),this.setCellHeights(this.node,0)),null!=this.node&&(this.layout(this.node),o=r=this.graph.gridSize,this.moveTree||null!=(n=this.getVertexBounds(this.root))&&(r=n.x,o=n.y),(s=null)!=(s=this.isHorizontal()?this.horizontalLayout(this.node,-r,o):this.verticalLayout(this.node,null,r,o))&&((a=i=0)<s.x&&(i=-1*Math.abs(r-s.x)),0<s.y&&(a=-1*Math.abs(o-s.y)),0==i&&0==a||this.moveNode(this.node,i,a),this.resizeParent&&this.adjustParents(),this.edgeRouting)&&this.localEdgeProcessing(this.node),null!=this.parentX)&&null!=this.parentY&&null!=(l=this.graph.getCellGeometry(e))&&((l=l.clone()).x=this.parentX,l.y=this.parentY,c.setGeometry(e,l))}finally{c.endUpdate()}}},e.prototype.horizontalLayout=function(e,t,r,o){e.x+=t-e.offsetX,e.y+=r+e.offsetY,o=this.apply(e,o);var n=e.child;if(null!=n){o=this.horizontalLayout(n,e.x,e.y,o);for(var i=e.y+n.offsetY,a=n.next;null!=a;)o=this.horizontalLayout(a,e.x-n.offsetX,i,o),i+=a.offsetY,a=a.next}return o},e}(mxCompactTreeLayoutType),CellOverlayState={Search:"Search",Fold:"Fold"},CellOverlay=function(l){function e(e,t,r,o,n,i,a){e=l.call(this,e,t,r,o,n,i)||this;return e.state=a||CellOverlayState.Search,e}return __extends(e,l),e}(mxCellOverlayType),Outline=function(r){function e(e,t){return r.call(this,e,t)||this}return __extends(e,r),e.prototype.createGraph=function(e){e=new mxGraphType(e,this.source.getModel(),this.graphRenderHint);return e.foldingEnabled=!1,e.autoScroll=!1,this.extendStyleSheets(e,this.source),e},e.prototype.extendStyleSheets=function(e,t){var r=Object.assign({},t.getStylesheet().getCellStyle(Styles.STYLE_BILL_NODE_NAME,t.getStylesheet().getDefaultVertexStyle()));r[mxConstantsType.STYLE_FILLCOLOR]="#2A87FF",e.getStylesheet().putCellStyle(Styles.STYLE_BILL_NODE_NAME,r),(r=Object.assign({},t.getStylesheet().getCellStyle(Styles.STYLE_BILL_NODE_ENTRY_NAME,t.getStylesheet().getDefaultVertexStyle())))[mxConstantsType.STYLE_FILLCOLOR]="#F5A144",e.getStylesheet().putCellStyle(Styles.STYLE_BILL_NODE_ENTRY_NAME,r),r=Object.assign({},t.getStylesheet().getCellStyle(Styles.STYLE_BILL_ASSOCIATION_NAME,t.getStylesheet().getDefaultEdgeStyle())),e.getStylesheet().putCellStyle(Styles.STYLE_BILL_ASSOCIATION_NAME,r)},e}(mxOutlineType),BillTrackerDataService=function(){function e(e,t){this.httpService=e,this.httpClient=t,this.baseUrl="/api/runtime/aif/v1.0/billtracking",this.canTrackingUrl=this.baseUrl+"/cantracking",this.canTrackingMethod="POST",this.getDownBillsInfoUrl=this.baseUrl+"/getdownbillsinfo",this.getDownBillsInfoMethod="POST",this.getUpBillsInfoUrl=this.baseUrl+"/getupbillsinfo",this.getUpBillsInfoMethod="POST",this.getEntityDataUrl=this.baseUrl+"/getentitydata",this.getEntityDataMethod="POST",this.jointQueryParserUrl="/api/runtime/aif/v1.0/jointquery",this.jointQueryParserMethod="POST"}return e.prototype.getJointQueryParameters=function(e){e=e.ConvertToJson(),e=this.httpService.setHeader({body:e});return this.httpService.request(this.jointQueryParserMethod,this.jointQueryParserUrl,e).pipe(operators.switchMap(function(e){e=commonApi$1.BpmnModelJsonHelper.FromJson(e.value,JointQueryParameterResult);return rxjs.of(e)}),operators.catchError(function(e){try{"string"==typeof e.error&&(e.error=JSON.parse(e.error))}catch(t){}throw e}))},e.prototype.canTracking=function(e){e=this.httpService.setHeader({body:e.ConvertToJson(),responseType:"text"});return this.httpService.request(this.canTrackingMethod,this.canTrackingUrl,e).pipe(operators.switchMap(function(e){var t=new CanTrackingResult;return t.LoadFromJson(e),rxjs.of(t)}),operators.catchError(function(e){try{"string"==typeof e.error&&(e.error=JSON.parse(e.error))}catch(t){}throw e}))},e.prototype.getDownBillsInfo=function(e){e=this.httpService.setHeader({body:e.ConvertToJson(),responseType:"text"});return this.httpService.request(this.getDownBillsInfoMethod,this.getDownBillsInfoUrl,e).pipe(operators.switchMap(function(e){e=commonApi$1.BpmnModelJsonHelper.FromJson(e,DownBillInfoResult);return rxjs.of(e)}),operators.catchError(function(e){try{"string"==typeof e.error&&(e.error=JSON.parse(e.error))}catch(t){}throw e}))},e.prototype.getUpBillsInfo=function(e){e=this.httpService.setHeader({body:e.ConvertToJson(),responseType:"text"});return this.httpService.request(this.getUpBillsInfoMethod,this.getUpBillsInfoUrl,e).pipe(operators.switchMap(function(e){e=commonApi$1.BpmnModelJsonHelper.FromJson(e,UpBillInfoResult);return rxjs.of(e)}),operators.catchError(function(e){try{"string"==typeof e.error&&(e.error=JSON.parse(e.error))}catch(t){}throw e}))},e.prototype.getEntityData=function(e){e=this.httpService.setHeader({body:e.ConvertToJson(),responseType:"text"});return this.httpService.request(this.getEntityDataMethod,this.getEntityDataUrl,e).pipe(operators.switchMap(function(e){var t=new EntityDataResult;return t.LoadFromJson(e),rxjs.of(t)}),operators.catchError(function(e){try{"string"==typeof e.error&&(e.error=JSON.parse(e.error))}catch(t){}throw e}))},e.prototype.buildEntryBillInfo=function(e){var t=new DownBillInfoResult,r=(t.schemaId=e.schemaId,t.suCode=e.suCode,t.voName=e.voName,t.billTrackingSettings=e.billTrackingSettings,t.bizKind=e.bizKind,t.bizType=e.bizType,t.jointQueryMode=e.jointQueryMode,t.jointQueryParameters=e.jointQueryParameters,t.trackingSourceType=e.trackingSourceType,new BillDataInfo);return r.caption=e.caption,r.dataId=e.dataId,r.summary=e.summary,r.trackingMappingAssociations=[],r.billChildInfos=e.billChildInfos,r.curYear=e.curYear,t.billDataInfos=[r],t.documentTypeId=e.documentTypeId,t},e.prototype.buildGetBillsInfoArgs=function(e){var t=new GetBillsInfoArgs;return t.billDataId=e.billDataInfo.dataId,t.documentTypeId=e.billInfo.documentTypeId,t.bizKind=e.billInfo.bizKind,t.bizType=e.billInfo.bizType,t.billChildInfos=e.billDataInfo.billChildInfos,t.curYear=e.billDataInfo.curYear,t},e.prototype.buildGetUpBillsInfoArgs=function(e){var t=new GetUpBillsInfoArgs;return t.LoadFromJsonObject(this.buildGetBillsInfoArgs(e).ConvertToJsonObject()),t},e.prototype.buildGetDownBillsInfoArgs=function(e){var t=new GetDownBillsInfoArgs;return t.LoadFromJsonObject(this.buildGetBillsInfoArgs(e).ConvertToJsonObject()),t},e.prototype.buildGetMainEntityDataArgs=function(e,t){var r=new GetMainEntityDataArgs;return r.dataId=t.dataId,r.suCode=e.suCode,r.schemaId=e.schemaId,r.trackingSourceType=e.trackingSourceType,r.billChildInfos=t.billChildInfos,r.curYear=t.curYear,r.documentTypeId=e.documentTypeId,r},e.prototype.hasDynamicParams=function(e){return!!e.params&&!!Array.isArray(e.params)&&null!=e.params.find(function(e){return e.type!=commonApi.JointQueryParameterType.Constant})},e.prototype.buildGetJointQueryParametersArgs=function(e,t,r){var o=new GetJointQueryParametersArgs;return o.dataId=r.dataId,o.suCode=t.suCode,o.schemaId=t.schemaId,o.trackingSourceType=t.trackingSourceType,o.curYear=r.curYear,o.contents=[],Array.isArray(e.params)&&e.params.forEach(function(e){var t,r;e.type!=commonApi.JointQueryParameterType.Constant&&(t=new JointQueryParametersContent,e.type==commonApi.JointQueryParameterType.Field?(t.jointQueryParameterMode=JointQueryParameterMode.FIELD,(r=new FieldJointQueryParameterContent).parameterCode=e.code,r.fieldContent=e.value,t.content=r.ConvertToJson()):e.type==commonApi.JointQueryParameterType.Expression&&(t.jointQueryParameterMode=JointQueryParameterMode.EXPRESSION,(r=new ExpressionJointQueryParameterContent).parameterCode=e.code,r.expressionContent=e.value,t.content=r.ConvertToJson()),o.contents.push(t))}),o},e.decorators=[{type:core$1.Injectable}],e.ctorParameters=function(){return[{type:cafCommon.HttpService},{type:http.HttpClient}]},e}(),BillTrackerDataInfoService=function(){function e(){}return e.prototype.isNewBTS=function(e){var t;return"string"==typeof e&&((t=new commonApi.BillTrackingSettings).LoadFromJson(e),e=t),null!=e&&"1.0"===e.version},e.prototype.extractDataRows=function(e,n,i,a){var t,r,l=this,s=[];try{for(var o=__values(e),c=o.next();!c.done;c=o.next())!function(t){var r={},o=(r[a]=t.dataId,[]);n.forEach(function(e){e.dataType==commonApi$1.DataType.Decimal?o.push(e):r[e.fieldPath]=l.getFieldValue(e,t.GetFieldMap(),i)}),o.forEach(function(e){r[e.fieldPath]=l.getFieldValue(e,t.GetFieldMap(),i)}),s.push(r)}(c.value)}catch(p){t={error:p}}finally{try{c&&!c.done&&(r=o["return"])&&r.call(o)}finally{if(t)throw t.error}}return s},e.prototype.extractCaptionPath=function(e){for(var t=e.caption,r=e;null!=r.attachedField;)t=r.attachedField.caption+"."+t,r=r.attachedField;return t},e.prototype.extractFieldPath=function(e){for(var t=e.fieldName,r=e;null!=r.attachedField;)t=r.attachedField.fieldName+"."+t,r=r.attachedField;return t},e.prototype.extractFFields=function(e,n,i){var a=this,l=[];return e.forEach(function(e){var t,r,o;e.show=!0,"Enum"==e.fieldType||"EnumSingleUdt"==e.fieldType?(t=a.extractFieldPath(e),o=null,i&&null==(o=n.find(function(e){return e.fieldPath==t}))&&(e.show=!1),e=a.setExtendProps(e,o,t+".Name"),l.push(e)):null!=e.GetSubFieldList()&&0<e.GetSubFieldList().length?l.push.apply(l,__spread(a.extractFFields(e.GetSubFieldList(),n,i))):(r=a.extractFieldPath(e),o=null,i&&null==(o=n.find(function(e){return e.fieldPath==r}))&&(e.show=!1),e=a.setExtendProps(e,o,r),l.push(e))}),l},e.prototype.hasChildData=function(e,t){var r,o,n=!1,i=this.getBillTrackerSchema(t),t=e.GetChildTableList();try{for(var a=__values(t),l=a.next();!l.done;l=a.next()){var s=l.value,c=!1,p=!1,u=i&&i[s.tableName],c=null==u||null==u.show||u.show;if(s.GetRowList()&&0<s.GetRowList().length&&(p=!0),1==(n=c&&p))break}}catch(d){r={error:d}}finally{try{l&&!l.done&&(o=a["return"])&&o.call(a)}finally{if(r)throw r.error}}return n},e.prototype.getFieldValue=function(e,t,r){for(var o=e.fieldPath?e.fieldPath.split("."):[e.fieldName],n=o&&t[o[0]],i=1;null!=n&&i<o.length;i++){var a=n.GetSubFieldMap();if(null==a)break;n=a[o[i]]}var l=n?n.GetTextValue():"";if(null==l)return null;if(e.dataType==commonApi$1.DataType.String)return null!=e.formatInfo&&null!=(s=e.formatInfo.stringMapFormatter)?(s=s[l]||l,e.fieldValue=s):(e.fieldValue=l)||"";if(e.dataType!=commonApi$1.DataType.Decimal)return e.dataType==commonApi$1.DataType.Boolean?""==l?(e.fieldValue=null,l):(e.fieldValue=JSON.parse(l),JSON.parse(l)):e.dataType==commonApi$1.DataType.DateTime?(s=commonApi$1.BpmnModelJsonHelper.DateTimeFromString(l),c="yyyy-MM-dd",c=e.formatInfo&&e.formatInfo.dateFormatter||"yyyy-MM-dd",e.fieldValue=s,this.dateFormat(s,c)):(e.fieldValue=l)||"";var s=e.scale;if(null!=e.formatInfo&&(null!=e.formatInfo.scale&&(s=e.formatInfo.scale),e.formatInfo.enableScaleExpression)&&null!=e.formatInfo.scaleExpression){var c=this.getFieldInFields(r,e.formatInfo.scaleExpression),r=c&&parseInt(String(this.getFieldValue(c,t)));if(null!=r){if(isNaN(r))throw Exceptions.SCALE_FIELD_VALUE_IS_NAN;s=r}}return e.fieldValue=parseFloat(String(l)),s<0?s=0:100<s&&(s=100),parseFloat(String(l)).toFixed(s).toString()||""},e.prototype.getFieldInFields=function(e,t){var r,o,n=null;try{for(var i=__values(e),a=i.next();!a.done;a=i.next()){for(var l=a.value,s=l,c=l;c.attachedField;)c=c.attachedField;var p=c;if(s.fullPath=commonApi.fullPathPrefix+p.attachedTable.tableName+"."+s.fieldPath,t==s.fullPath){n=s;break}var u=s.GetSubFieldList();if(u&&0<u.length&&null!=(n=this.getFieldInFields(u,t)))break}}catch(d){r={error:d}}finally{try{a&&!a.done&&(o=i["return"])&&o.call(i)}finally{if(r)throw r.error}}return n},e.prototype.getFieldValueInFieldsWithValue=function(e,t){var r,o,n=null;try{for(var i=__values(e),a=i.next();!a.done;a=i.next()){for(var l=a.value;l.attachedField;)l=l.attachedField;var s=l;if(s.fullPath=commonApi.fullPathPrefix+s.attachedTable.tableName+"."+s.fieldPath,t==s.fullPath){n=s.fieldValue;break}}}catch(c){r={error:c}}finally{try{a&&!a.done&&(o=i["return"])&&o.call(i)}finally{if(r)throw r.error}}return n},e.prototype.getBasicInfoFieldsWithValue=function(e,t,r,o){var n=this,o=(void 0===o&&(o=!0),[]),i=new commonApi.BillTrackingSettings,e=(e&&e.billTrackingSettings&&i.LoadFromJson(e.billTrackingSettings),this.getBillTrackerSchema(e)),e=e&&e[t.tableName]&&e[t.tableName].fields||[],i=i.billTrackingDataShownMode===commonApi.BillTrackingDataShownMode.CUSTOMFIELD,a=t.getFieldList(),l=r.GetRowList()[0].GetFieldMap(),t=this.extractFFields(a,e,i),s=[];return t.forEach(function(e){e.dataType==commonApi$1.DataType.Decimal?s.push(e):e.fieldValue=n.getFieldValue(e,l)}),s.forEach(function(e){e.fieldValue=n.getFieldValue(e,l,a)}),o.push.apply(o,__spread(t)),o},e.prototype.setExtendProps=function(e,t,r,o){return e.captionPath=this.extractCaptionPath(e),e.fieldPath=r,t&&(e.displayName=t.displayName,e.i18nCols=t.i18nCols,e.formatInfo=t.formatInfo,e.order=t.order),o&&(e.fieldValue=this.getFieldValue(e,o)),e},e.prototype.sortFieldsByOrder=function(e){return e.sort(function(e,t){return null!=e.order&&null!=t.order?e.order-t.order:null!=e.order&&null==t.order?-1:null==e.order&&null!=t.order?1:0})},e.prototype.dateFormat=function(e,t){var r,o,n={"y+":e.getUTCFullYear().toString(),"M+":(e.getUTCMonth()+1).toString(),"d+":e.getUTCDate().toString(),"H+":e.getUTCHours().toString(),"m+":e.getUTCMinutes().toString(),"s+":e.getUTCSeconds().toString(),"S+":e.getUTCMilliseconds().toString()};for(o in n)(r=new RegExp("("+o+")").exec(t))&&(t=String.prototype.padStart?t.replace(r[1],1==r[1].length?n[o]:n[o].padStart(r[1].length,"0")):t.replace(r[1],1==r[1].length?n[o]:this.myPadStart(n[o],r[1].length,"0")));return t},e.prototype.myPadStart=function(e,t,r){return t>>=0,r=String(void 0!==r?r:" "),e.length>t?String(e):((t-=e.length)>r.length&&(r+=r.repeat(t/r.length)),r.slice(0,t)+String(e))},e.prototype.getFieldLabel=function(e,t){return t&&e.i18nCols&&e.i18nCols.colI18nValues.displayName&&e.i18nCols.colI18nValues.displayName[t]||e.displayName||e.captionPath||e.caption},e.prototype.getTableLabel=function(e,t,r){var o,e=this.getBillTrackerSchema(e),e=e&&e[t.tableName];return null!=e?(o=e.i18nCols,r&&o&&o.colI18nValues.displayName&&o.colI18nValues.displayName[r]||e.displayName||e.caption||e.code):t.caption},e.prototype.getChildTables=function(e,t){var r=[],o=this.getBillTrackerSchema(e),e=t.GetChildTableList();return e&&e.forEach(function(e){var t=o&&o[e.tableName];null!=t&&null!=t.show?1==t.show&&(e.order=t.order,r.push(e)):r.push(e)}),r=this.sortTablesByOrder(r)},e.prototype.sortTablesByOrder=function(e){return e.sort(function(e,t){return null!=e.order&&null!=t.order?e.order-t.order:null!=e.order&&null==t.order?-1:null==e.order&&null!=t.order?1:0})},e.prototype.getBillTrackerSchema=function(e){var t=new commonApi.BillTrackingSettings,e=(e&&e.billTrackingSettings&&t.LoadFromJson(e.billTrackingSettings),t.customFieldContent),t=e&&("object"==typeof e?e:JSON.parse(e));return t&&t.schema},e.decorators=[{type:core$1.Injectable}],e}(),BILL_TRACKER_LANG_RESOURCES={"zh-CHS":{billTracker:"单据追踪",noAssoBill:"没有关联的业务单据",modalOptionsCantBeEmpty:"模态框配置不可为空",downSearch:"下查",upSearch:"上查",folder:"折叠",caption:"标题",summary:"摘要",basicInfo:"基本信息",lineNumber:"序号",childData:"明细",selectOneFirst:"请先选择一条数据",noChildData:"没有明细数据",zoomIn:"放大（Ctrl+滚轮）",zoomOut:"缩小（Ctrl+滚轮）",zoomReset:"还原",print:"打印",expandUp:"向上展开",expandUpAll:"向上展开全部",expandDown:"向下展开",expandDownAll:"向下展开全部",loading:"正在加载",yes:"是",no:"否",currentNode:"当前",goOnTracking:"穿透追踪",setAsCurrent:"设为当前",viewBill:"查看详情",more:"更多",tabNameLengthIsTooLong:"页签名称超长，取前200个字符显示",scaleFieldCantBeCastToInteger:"精度字段无法被转换为整型",trackerArgsCantBeEmpty:"参数【单据Id或者单据查询参数】不可为空"},en:{billTracker:"Bill Tracker",noAssoBill:"There is no associated business bill.",modalOptionsCantBeEmpty:"Modal options cant be empty",downSearch:"Down search",upSearch:"Up search",folder:"Folder",caption:"Caption",summary:"Summary",basicInfo:"Basic Information",lineNumber:"No",childData:"Detail",selectOneFirst:"Please select an item at first",noChildData:"No detail data",zoomIn:"Zoom In(Ctrl+MouseWheel)",zoomOut:"Zoom Out(Ctrl+MouseWheel)",zoomReset:"Zoom Reset",print:"Print",expandUp:"Expand Upward",expandUpAll:"Expand All Upward",expandDown:"Expand Downward",expandDownAll:"Expand All Downward",loading:"Loading...",yes:"Yes",no:"No",currentNode:"Entry",goOnTracking:"Go on",setAsCurrent:"Set as current",viewBill:"View Detail",more:"More",tabNameLengthIsTooLong:"The tab name is too long and displayed with the first 200 characters",scaleFieldCantBeCastToInteger:"Precision field cannot be converted to integers",trackerArgsCantBeEmpty:'The parameter "args" can\'t be empty'},"zh-CHT":{billTracker:"單據追蹤",noAssoBill:"沒有關聯的業務單據",modalOptionsCantBeEmpty:"模態框配置不可為空",downSearch:"下查",upSearch:"上查",folder:"折疊",caption:"標題",summary:"摘要",basicInfo:"基本信息",lineNumber:"序號",childData:"明細",selectOneFirst:"請先選擇壹條數據",noChildData:"沒有明細數據",zoomIn:"放大（Ctrl+滾輪）",zoomOut:"縮小（Ctrl+滾輪）",zoomReset:"還原",print:"打印",expandUp:"向上展開",expandUpAll:"向上展開全部",expandDown:"向下展開",expandDownAll:"向下展開全部",loading:"正在加載",yes:"是",no:"否",currentNode:"當前",goOnTracking:"穿透追蹤",setAsCurrent:"設爲當前",viewBill:"查看詳情",more:"更多",tabNameLengthIsTooLong:"頁簽名稱超長，取前200個字符顯示",scaleFieldCantBeCastToInteger:"精度字段無法被轉換爲整型",trackerArgsCantBeEmpty:"參數【單據Id或者單據查詢參數】不可爲空"}},BillTrackerLocalePipe=function(){function e(e){this.defaultLang="zh-CHS",this.langCode=e||this.defaultLang,this.lang=BILL_TRACKER_LANG_RESOURCES[this.langCode]||BILL_TRACKER_LANG_RESOURCES[this.defaultLang]}return e.prototype.transform=function(e){return this.lang[e]||e},e.decorators=[{type:core$1.Pipe,args:[{name:"billTrackerLocale"}]}],e.ctorParameters=function(){return[{type:String,decorators:[{type:core$1.Inject,args:[core$1.LOCALE_ID]}]}]},e}(),BillTrackerInternalUiService=function(){function BillTrackerInternalUiService(e,t,r,o,n,i,a,l,s,c){this.framework=e,this.messager=t,this.loading=r,this.dataService=n,this.dataInfoService=i,this.modalService=a,this.cfr=l,this.injector=s,this.localePipe=c}return BillTrackerInternalUiService.prototype.openBillDetail=function(e,t){var r,o=this,n=e.jointQueryMode,i=JSON.parse(e.jointQueryParameters),a=t.dataId;this.dataService.hasDynamicParams(i)?(e=this.dataService.buildGetJointQueryParametersArgs(i,e,t),r=this.loading.show({message:this.localePipe.transform("loading")}),this.dataService.getJointQueryParameters(e).subscribe(function(e){r.close(),n==commonApi.JointQueryMode.APP?o.openMenu(i,a,e):n==commonApi.JointQueryMode.URL&&o.openUrl(i,a,e)},function(e){throw r.close(),o.messager.error(null!=e.error&&(e.error.Message||e.error.message)||e.message),e})):n==commonApi.JointQueryMode.APP?this.openMenu(i,a):n==commonApi.JointQueryMode.URL&&this.openUrl(i,a)},BillTrackerInternalUiService.prototype.openBillDetailWithFields=function(e,t,r){var o,n=this,i=t.dataId,a=e.jointQueryMode,l=JSON.parse(e.jointQueryParameters);this.dataService.hasDynamicParams(l)?(o=this.loading.show({message:this.localePipe.transform("loading")}),e=this.dataService.buildGetJointQueryParametersArgs(l,e,t),this.dataService.getJointQueryParameters(e).subscribe(function(e){o.close(),a==commonApi.JointQueryMode.APP?n.openMenu(l,i,e):a==commonApi.JointQueryMode.URL&&n.openUrl(l,i,e)},function(e){throw o.close(),n.messager.error(null!=e.error&&(e.error.Message||e.error.message)||e.message),e})):a==commonApi.JointQueryMode.APP?this.openMenu(l,i):a==commonApi.JointQueryMode.URL&&this.openUrl(l,i)},BillTrackerInternalUiService.prototype.openMenu=function(e,t,r){var o={},n=(o.id=t,o.action="LoadAndView1",new Map),r=(n.set("id",t),n.set("action","LoadAndView1"),this.buildOpenMenuParams(e,n,o,r),o&&o[BillTrackerConstant.BILL_VIEWER_PARAM_CODE_CUSTOM_TAB_NAME]),i=(o&&o[BillTrackerConstant.BILL_VIEWER_PARAM_CODE_CUSTOM_TAB_NAME]&&(delete o[BillTrackerConstant.BILL_VIEWER_PARAM_CODE_CUSTOM_TAB_NAME],n["delete"](BillTrackerConstant.BILL_VIEWER_PARAM_CODE_CUSTOM_TAB_NAME)),encodeURIComponent(JSON.stringify(o))),i=(n.set("WEB_FORM_ROUTE_PARAMS",i),{appType:rtfCommon.AppType.Menu,funcId:e.funcId,appEntrance:null,appId:null,tabId:t,entityParams:o,queryStringParams:n});r&&(200<r.length&&(this.messager.warning(this.localePipe.transform("tabNameLengthIsTooLong")),r=r.substring(0,200)),i.tabName=r),this.framework.openMenu(i)},BillTrackerInternalUiService.prototype.openUrl=function(t,e,o){var n=this,i=this.appendQueryParam(t.url,"id",e),i=this.appendQueryParam(i,"action","LoadAndView1"),r=(new Date).getTime().toString(),r=(i=this.appendQueryParam(i,"cvft",r),Array.isArray(t.params)?t.params.forEach(function(t){var e,r=t.value;t.type!=commonApi.JointQueryParameterType.Field&&t.type!=commonApi.JointQueryParameterType.Expression||(r=(e=o.find(function(e){return e.code==t.code}))&&e.value),i=n.appendQueryParam(i,t.code,r)}):Object.keys(t.params).forEach(function(e){i=n.appendQueryParam(i,e,t.params[e])}),t.params||{}),a=(r.id=e,r.url=i,r.action="LoadAndView1",new Map),e=(a.set("url",i),a.set("id",e),a.set("action","LoadAndView1"),this.buildOpenMenuParams(t,a,undefined,o),{appType:rtfCommon.AppType.Menu,funcId:BillTrackerConstant.BILL_VIEWER_FUNC_ID,appEntrance:null,appId:null,tabId:e,entityParams:r,queryStringParams:a});this.framework.openMenu(e)},BillTrackerInternalUiService.prototype.buildOpenMenuParams=function(t,r,o,n){void 0===o&&(o={}),Array.isArray(t.params)?t.params.forEach(function(t){var e=t.value;t.type!=commonApi.JointQueryParameterType.Field&&t.type!=commonApi.JointQueryParameterType.Expression||n&&(e=n.find(function(e){return e.code==t.code}).value),o[t.code]=e,r.set(t.code,e)}):Object.keys(t.params).forEach(function(e){o[e]=t.params[e],r.set(e,t.params[e])})},BillTrackerInternalUiService.prototype.appendQueryParam=function(url,k,v){var idx=url.indexOf("?"),re1,re2,paraStr;return idx<0&&(url+="?"),idx=url.indexOf("?"),-1<url.indexOf(k,idx)?(re1=eval("/(\\?)("+k+"=)([^&]*)/gi"),url=url.replace(re1,"?"+k+"="+v),re2=eval("/(&)("+k+"=)([^&]*)/gi"),url=url.replace(re2,"&"+k+"="+v)):(paraStr=k+"="+v,idx<0?url+="?":0<=idx&&idx!=url.length-1&&(url+="&"),url+=paraStr),url},BillTrackerInternalUiService.decorators=[{type:core$1.Injectable}],BillTrackerInternalUiService.ctorParameters=function(){return[{type:rtfCommon.FrameworkService},{type:uiMessager.MessagerService},{type:uiLoading.LoadingService},{type:String,decorators:[{type:core$1.Inject,args:[core$1.LOCALE_ID]}]},{type:BillTrackerDataService},{type:BillTrackerDataInfoService},{type:uiModal.BsModalService},{type:core$1.ComponentFactoryResolver},{type:core$1.Injector},{type:BillTrackerLocalePipe}]},BillTrackerInternalUiService}(),BillTrackerComponent=function(){function e(e,t,r,o,n,i,a,l,s,c,p,u){this.localeId=t,this.dataService=r,this.notify=o,this.messager=n,this.loading=i,this.modal=a,this.cdf=l,this.vcr=s,this.appr=c,this.inj=p,this.cfr=u,this.defaultDataWrapperHeight=180,this.dataWrapperHeight=180,this.showData=!1,this.dataFullScreen=!1,this.billTrackerArgs=e,this.dataInfoService=new BillTrackerDataInfoService,this.newBTS=this.dataInfoService.isNewBTS(this.billTrackerArgs.canTrackingResult.billTrackingSettings);t=core$1.ReflectiveInjector.resolveAndCreate([BillTrackerInternalUiService],this.inj);this.internalUiService=t.get(BillTrackerInternalUiService,null),this.defaultDataWrapperHeight=e&&e.gridOptions&&e.gridOptions.defaultHeight?e.gridOptions.defaultHeight:this.defaultDataWrapperHeight,this.dataWrapperHeight=this.defaultDataWrapperHeight}return e.prototype.ngOnInit=function(){},e.prototype.ngAfterViewInit=function(){var e=this;setTimeout(function(){e.paintGraph()},0)},e.prototype.paintGraph=function(){var r=this;this.billGraph.paint(),this.graphZoomScale=this.billGraph.getZoomScale(),this.billGraph.graph.view.addListener(mxEventType.SCALE,function(e,t){r.graphZoomScale=r.billGraph.getZoomScale()})},e.prototype.selectHandler=function(e){var t,r;e?(t=e.billInfo,e=e.billDataInfo,t==this.lastBillInfo&&e==this.lastBillDataInfo&&1==this.showData||(r=this.dataService.buildGetMainEntityDataArgs(t,e),this.billData.showDataGrid(r,t,e,null),this.divDataWrapperER.nativeElement.scrollTo({top:0}),this.showData=!0,this.lastBillInfo=t,this.lastBillDataInfo=e)):(this.billData.clearDataRegion(),this.showData=!1)},e.prototype.stateChangeHandler=function(e){e.type==Events.CLICK_FIRST_SUMMARY&&this.openBillDetail(e.data)},e.prototype.setModalRef=function(e){this.modalRef=e,null!=this.billGraph&&this.billGraph.setModalRef(e)},e.prototype.resetGraphHeight=function(e){var t=this;e.host.style.top="",e.host.style.left="",this.graphContainerER.nativeElement.style.height=this.mainContainerER.nativeElement.clientHeight-e.size.height+"px",setTimeout(function(){t.billGraph.refresh()})},e.prototype.expandDataRegion=function(){this.dataFullScreen=!0,this.divDataWrapperER.nativeElement.style.height="100%",this.divDataWrapperER.nativeElement.style.top="0"},e.prototype.collapseDataRegion=function(){this.dataFullScreen=!1,this.dataWrapperHeight=this.defaultDataWrapperHeight,this.divDataWrapperER.nativeElement.style.height=this.dataWrapperHeight+"px",this.divDataWrapperER.nativeElement.style.top=null},e.prototype.onRzResized=function(e){e.position.top<0&&(this.divDataWrapperER.nativeElement.style.top="0",this.divDataWrapperER.nativeElement.style.height="100%",this.dataFullScreen=!0)},e.prototype.graphZoomIn=function(){this.billGraph.zoomIn()},e.prototype.graphZoomOut=function(){this.billGraph.zoomOut()},e.prototype.graphZoomActual=function(){this.billGraph.zoomActual()},e.prototype.graphPrint=function(){this.billGraph.print()},e.prototype.graphExpand=function(e,t){this.billGraph.expand(e,t=void 0===t?!1:t)},e.prototype.graphExpandUpAll=function(){this.graphExpand(BillTrackerDirection.Up,!0)},e.prototype.graphExpandUp=function(){this.graphExpand(BillTrackerDirection.Up,!1)},e.prototype.graphExpandDown=function(){this.graphExpand(BillTrackerDirection.Down,!1)},e.prototype.graphExpandDownAll=function(){this.graphExpand(BillTrackerDirection.Down,!0)},e.prototype.openBillDetail=function(e){this.internalUiService.openBillDetail(e.billInfo,e.billDataInfo)},e.decorators=[{type:core$1.Component,args:[{selector:"lib-bill-tracker",template:'<div class="g-main" style="height: 100%; background-color: #ffffff;" #mainContainer>\r\n  <div class="bill-tracker-toolbar-wrapper" *ngIf="modalRef!=null">\r\n    <button class="btn btn-secondary bill-tracker-toolbar-btn mr-1" (click)="graphExpandUpAll()">\r\n      {{\'expandUpAll\'|billTrackerLocale}}\r\n    </button>\r\n    <button class="btn btn-secondary bill-tracker-toolbar-btn mr-1" (click)="graphExpandUp()">\r\n      {{\'expandUp\'|billTrackerLocale}}\r\n    </button>\r\n    <button class="btn btn-secondary bill-tracker-toolbar-btn mr-1" (click)="graphExpandDown()">\r\n      {{\'expandDown\'|billTrackerLocale}}\r\n    </button>\r\n    <button class="btn btn-secondary bill-tracker-toolbar-btn mr-1" (click)="graphExpandDownAll()">\r\n      {{\'expandDownAll\'|billTrackerLocale}}\r\n    </button>\r\n    <div class="bill-tracker-toolbar-icon" (click)="graphZoomOut()">\r\n      <i class="f-icon f-icon-minus" title="{{\'zoomOut\' | billTrackerLocale}}"></i>\r\n    </div>\r\n    <div class="bill-tracker-toolbar-input">\r\n      <input *ngIf="false" type="text" style="border: 0; width: 30px; text-align: right;" readonly\r\n        [(ngModel)]="graphZoomScale">\r\n      <span style="border: 0; width: 30px; text-align: right;">{{graphZoomScale}}</span>\r\n      <span>%</span>\r\n    </div>\r\n    <div class="bill-tracker-toolbar-icon" (click)="graphZoomIn()">\r\n      <i class="f-icon f-icon-add" title="{{\'zoomIn\' | billTrackerLocale}}"></i>\r\n    </div>\r\n    <div class="bill-tracker-toolbar-icon" (click)="graphZoomActual()">\r\n      <i class="f-icon f-icon-reset" title="{{\'zoomReset\' | billTrackerLocale}}"></i>\r\n    </div>\r\n    <div class="bill-tracker-toolbar-icon" (click)="graphPrint()" *ngIf="false">\r\n      <i class="f-icon f-icon-print" title="{{\'print\' | billTrackerLocale}}"></i>\r\n    </div>\r\n  </div>\r\n  <div class="bill-tracker-graph-wrapper" #graphContainer>\r\n    <lib-bill-tracker-graph #billGraph [billTrackerArgs]="billTrackerArgs" (select)="selectHandler($event)"\r\n      (stateChange)="stateChangeHandler($event)">\r\n    </lib-bill-tracker-graph>\r\n  </div>\r\n</div>\r\n\x3c!-- todo: 分割条暂未加最大高度限制 --\x3e\r\n<div #divDataWrapper class="bill-tracker-data-wrapper" [style.height]="dataWrapperHeight + \'px\'"\r\n  [style.display]="showData ? null : \'none\'" ngResizable rzAspectRatio="false" [rzHandles]="\'n\'" [rzMinHeight]="40"\r\n  (rzStop)="onRzResized($event)">\r\n  <div class="bill-tracker-divider-wrapper">\r\n    <div class="bill-tracker-divider bill-tracker-divider-transparent bill-tracker-divider-img">\r\n    </div>\r\n  </div>\r\n  <div class="bill-tracker-fold-container">\r\n    <div class="bill-tracker-fold-wrapper">\r\n      <div class="bill-tracker-fold-icon">\r\n        <i class="f-icon f-icon-arrow-seek-up" *ngIf="dataFullScreen==false" (click)="expandDataRegion()"></i>\r\n        <i class="f-icon f-icon-arrow-seek-down" *ngIf="dataFullScreen==true" (click)="collapseDataRegion()"></i>\r\n      </div>\r\n    </div>\r\n  </div>\r\n  <div #divDataTable class="bill-tracker-data-table-wrapper">\r\n    <lib-bill-tracker-data #billData></lib-bill-tracker-data>\r\n  </div>\r\n</div>\r\n',providers:[BillTrackerDataService],changeDetection:core$1.ChangeDetectionStrategy.Default,styles:['.bill-tracker-divider{position:relative;height:5px}.bill-tracker-divider-transparent:before{content:"";position:absolute;top:1px;left:0;width:100%;height:2px;background-color:#e9ecf3}.bill-tracker-divider-transparent:hover:before{content:"";position:absolute;top:1px;left:0;width:100%;height:2px;background-color:#3f65ff}.bill-tracker-divider-img:after{content:"";position:absolute;top:-1px;left:50%;width:60px;height:5px;background-image:url(/platform/runtime/common/web/@edp-bif/runtime-api/images/separator.svg);background-repeat:no-repeat}.bill-tracker-divider-img:hover:after{content:"";position:absolute;top:-1px;left:50%;width:60px;height:5px;background-image:url(/platform/runtime/common/web/@edp-bif/runtime-api/images/separator-hover.svg);background-repeat:no-repeat}.bill-tracker-graph-wrapper{height:100%;position:relative}.bill-tracker-data-wrapper{z-index:2;overflow-y:auto;position:absolute;left:0;width:100%;bottom:0;height:200px;background-color:#fff;overflow:hidden}.bill-tracker-data-wrapper .ng-resizable-handle.ng-resizable-n{height:10px}.bill-tracker-data-table-wrapper{position:relative;width:100%;padding-top:6px;height:100%;overflow:auto}.bill-tracker-fold-wrapper{z-index:1;position:absolute;right:1rem;top:0;width:2rem;height:2rem}.bill-tracker-fold-icon{display:inline-flex;width:1.5em;height:1.5em;line-height:1.5em;text-align:center;color:#848c9a;background:#fff;border-radius:1.5em;border:1px solid #e9ecf3;justify-content:center;align-items:center;flex-shrink:0;overflow:hidden;margin:.5em .5em 0 0}.bill-tracker-fold-icon:hover{background-image:linear-gradient(214deg,#3f65ff 0,#4d9aff 100%);box-shadow:0 3px 8px 0 rgba(78,148,255,.4);color:#fff}.bill-tracker-toolbar-wrapper{z-index:1;position:absolute;right:0;top:0;display:flex;margin-right:14px;margin-top:14px;background-color:#fff}.bill-tracker-toolbar-icon{background:#fff;width:22px;height:22px;line-height:22px;text-align:center;color:#595d63;border:1px solid #e8ebf2;box-shadow:0 2px 6px 0 rgba(31,35,41,.06);border-radius:22px;justify-content:center;align-items:center;flex-shrink:0;overflow:hidden}.bill-tracker-toolbar-icon:hover{background-image:linear-gradient(214deg,#3f65ff 0,#4d9aff 100%);box-shadow:0 3px 8px 0 rgba(78,148,255,.4);color:#fff}.bill-tracker-toolbar-btn:hover{background-color:#fff}.bill-tracker-fold-container{position:fixed;height:2rem;width:100%;z-index:1}']}]}],e.ctorParameters=function(){return[{type:BillTrackerArgs},{type:String,decorators:[{type:core$1.Inject,args:[core$1.LOCALE_ID]}]},{type:BillTrackerDataService},{type:uiNotify.NotifyService},{type:uiMessager.MessagerService},{type:uiLoading.LoadingService},{type:uiModal.BsModalService},{type:core$1.ChangeDetectorRef},{type:core$1.ViewContainerRef},{type:core$1.ApplicationRef},{type:core$1.Injector,decorators:[{type:core$1.Optional}]},{type:core$1.ComponentFactoryResolver,decorators:[{type:core$1.Optional}]}]},e.propDecorators={billGraph:[{type:core$1.ViewChild,args:["billGraph"]}],billGraphVCR:[{type:core$1.ViewChild,args:["billGraph",{read:core$1.ViewContainerRef}]}],mainContainerER:[{type:core$1.ViewChild,args:["mainContainer"]}],graphContainerER:[{type:core$1.ViewChild,args:["graphContainer"]}],billData:[{type:core$1.ViewChild,args:["billData"]}],billDataVCR:[{type:core$1.ViewChild,args:["billData",{read:core$1.ViewContainerRef}]}],divDataTableER:[{type:core$1.ViewChild,args:["divDataTable"]}],divDataWrapperER:[{type:core$1.ViewChild,args:["divDataWrapper"]}],billTrackerArgs:[{type:core$1.Input,args:["billTrackerArgs"]}]},e}(),BillTrackerUiService=function(){function e(e,t,r,o,n,i,a,l){this.frameworkService=e,this.messager=t,this.loading=r,this.dataService=n,this.modalService=i,this.cfr=a,this.injector=l,this.defaultModalOptions={title:null,width:1100,height:480,buttons:null,showButtons:null},this.localePipe=new BillTrackerLocalePipe(o)}return e.prototype.openDefaultBillTrackerDialog=function(r,o,e,n,i){var a=this;if(void 0===o&&(o=!0),"string"==typeof e){if(""==e)return this.messager.info(this.localePipe.transform("modalOptionsCantBeEmpty")),rxjs.of(null);e=JSON.parse(e)}var l={title:this.localePipe.transform("billTracker")},l=Object.assign(l,this.defaultModalOptions,e),e=("string"==typeof n&&(n=""!=n?JSON.parse(n):null),"string"==typeof i&&(i=""!=i?JSON.parse(i):null),new GetDownBillsInfoArgs);return e.billDataId=r.billDataId,e.documentTypeId=r.documentTypeId,e.bizKind=r.bizKind,e.bizType=r.bizType,e.billChildInfos=r.billChildInfos,e.curYear=r.curYear,this.loading.show({message:this.localePipe.transform("loading")}),this.dataService.canTracking(e).pipe(operators.switchMap(function(e){var t;return e.canDownTracking||e.canUpTracking?((t=new BillTrackerArgs).canTrackingResult=e,t.getBillsInfoArgs=r,e=new BillTrackerGraphOptions,e=Object.assign(e,n),t.graphOptions=e,e=new BillTrackerGridOptions,e=Object.assign(e,i),t.gridOptions=e,e=a.createBillTrackerComponent(t),a.loading.close(),t=a.modalService.show(e,l),o&&t.dialog.instance.maxDialog(),e.instance.setModalRef(t),rxjs.of(e.instance)):(a.messager.info(a.localePipe.transform("noAssoBill")),a.loading.close(),rxjs.of(null))}),operators.catchError(function(e){throw a.loading.close(),a.messager.error(null!=e.error&&(e.error.Message||e.error.message)||e.message),e}))},e.prototype.openDefaultBillTrackerApp=function(r,o,n){var i=this;if("string"==typeof o){if(""==o)return void this.messager.info(this.localePipe.transform("modalOptionsCantBeEmpty"));o=JSON.parse(o)}if("string"==typeof n){if(""==n)return void this.messager.info(this.localePipe.transform("modalOptionsCantBeEmpty"));n=JSON.parse(n)}var e=new GetDownBillsInfoArgs;e.documentTypeId=r.documentTypeId,e.billDataId=r.billDataId,e.bizKind=r.bizKind,e.bizType=r.bizType,e.billChildInfos=r.billChildInfos,e.curYear=r.curYear,this.loading.show({message:this.localePipe.transform("loading")}),this.dataService.canTracking(e).subscribe(function(e){var t;e.canDownTracking||e.canUpTracking?((t=new BillTrackerArgs).canTrackingResult=e,t.getBillsInfoArgs=r,e=new BillTrackerGraphOptions,e=Object.assign(e,o),t.graphOptions=e,e=new BillTrackerGridOptions,e=Object.assign(e,n),t.gridOptions=e,e={appId:BillTrackerConstant.DEFAULT_APP_ID,appEntrance:BillTrackerConstant.DEFAULT_APP_ENTRANCE,funcId:BillTrackerConstant.DEFAULT_FUNC_ID,tabId:"billTracker"+Date.now(),tabName:i.localePipe.transform("billTracker"),appType:rtfCommon.AppType.App,entityParams:t,queryStringParams:i.buildQueryMap(t),isReload:undefined},i.frameworkService.openMenu(e)):i.messager.info(i.localePipe.transform("noAssoBill")),i.loading.close()},function(e){throw i.loading.close(),i.messager.error(null!=e.error&&(e.error.Message||e.error.message)||e.message),e})},e.prototype.createBillTrackerComponent=function(e,t,r,o){t=null==t?this.cfr:t,r=null==r?this.injector:r,o=null==o||0==Array.isArray(o)?[]:o;e=core$1.ReflectiveInjector.resolveAndCreate(__spread([{provide:BillTrackerArgs,useValue:e}],o),r);return t.resolveComponentFactory(BillTrackerComponent).create(e)},e.prototype.canTracking=function(e){return this.dataService.canTracking(e)},e.prototype.getDownBillsInfo=function(e){return this.dataService.getDownBillsInfo(e)},e.prototype.getUpBillsInfo=function(e){return this.dataService.getUpBillsInfo(e)},e.prototype.getEntityData=function(e){return this.dataService.getEntityData(e)},e.prototype.buildQueryMap=function(e){var t,r=new Map;for(t in e){var o=e[t];"object"==typeof o&&(o=o&&JSON.stringify(o)),r.set(t,btoa(encodeURIComponent(o)))}return r},e.decorators=[{type:core$1.Injectable}],e.ctorParameters=function(){return[{type:rtfCommon.FrameworkService},{type:uiMessager.MessagerService},{type:uiLoading.LoadingService},{type:String,decorators:[{type:core$1.Inject,args:[core$1.LOCALE_ID]}]},{type:BillTrackerDataService},{type:uiModal.BsModalService},{type:core$1.ComponentFactoryResolver},{type:core$1.Injector}]},e}(),CellData=function(){this.diagramInfo={x:null,y:null,width:null,height:null,extProps:{}}},EntryCellData=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ups=[],e.downs=[],e}return __extends(e,t),e}(CellData),UpCellData=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ups=[],e}return __extends(e,t),e}(CellData),DownCellData=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.downs=[],e}return __extends(e,t),e}(CellData),billTrackerPopupMenuCss="\nbody div.mxPopupMenu {\n  -webkit-box-shadow: 3px 3px 6px #C0C0C0;\n  -moz-box-shadow: 3px 3px 6px #C0C0C0;\n  box-shadow: 3px 3px 6px #C0C0C0;\n  background: white;\n  position: absolute;\n  border: 3px solid #e7e7e7;\n  padding: 3px;\n}\nbody table.mxPopupMenu {\n  border-collapse: collapse;\n  margin: 0px;\n}\nbody tr.mxPopupMenuItem {\n  color: black;\n  cursor: default;\n}\nbody td.mxPopupMenuItem {\n  padding: 6px 60px 6px 30px;\n  font-family: Arial;\n  font-size: 10pt;\n}\nbody td.mxPopupMenuIcon {\n  background-color: white;\n  padding: 0px;\n}\nbody tr.mxPopupMenuItemHover {\n  background-color: #eeeeee;\n  color: black;\n}\ntable.mxPopupMenu hr {\n  border-top: solid 1px #cccccc;\n}\ntable.mxPopupMenu tr {\n  font-size: 4pt;\n}\n",billTrackerCellCss="\n.bif-cell-node {\n    position: relative;\n    height: 100%;\n    font-weight: normal;\n    font-family: PingFangSC-Regular;\n    display:block;\n    text-align: left;\n}\n.bif-cell-node-main {\n    height: 100%;\n    background: #FFFFFF;\n    border: 1px solid rgba(230,233,240,1);\n    box-shadow: 0px 2px 10px 0px rgba(3,18,51,0.08);\n    border-radius: 8px;\n    border-left-width: 4px;\n    border-left-color: #2A87FF;\n}\n.bif-cell-node-current {\n    position: absolute;\n    right: 0;\n    top: 0;\n    width: 50px;\n    height: 28px;\n    background-image: linear-gradient(39deg, #F5A144 0%, #FFC527 100%);\n    box-shadow: 0px 2px 6px 0px rgba(245,161,68,0.4);\n    border-radius: 0px 8px 0px 64px;\n    color: white;\n    text-align: center;\n}\n.bif-cell-node-current-text {\n    display: block;\n    margin: auto;\n    line-height: 28px;\n}\n.bif-cell-node-title {\n    padding-left:19px;\n    padding-right:12px;\n    padding-top: 16px;\n    padding-bottom: 6px;\n}\n.bif-cell-node-title-text {\n    font-size: 16px;\n    color: #2D2F33;\n    letter-spacing: 0;\n    line-height: 24px;\n    font-weight: 400;\n    white-space: normal;\n    text-overflow: ellipsis;\n    overflow: hidden;\n    word-break: break-all;\n    display: -webkit-box;\n    -webkit-box-orient: vertical;\n    -webkit-line-clamp: 1;\n}\n.bif-cell-node-summary-list {\n\n}\n.bif-cell-node-summary {\n    display: flex;\n    padding-left: 19px;\n    padding-right:12px;\n    font-size: 13px;\n    color: #5A5E66;\n    line-height: 24px;\n    font-weight: 400;\n}\n.bif-cell-node-summary-caption {\n    letter-spacing: 0;\n    margin-right: 4px;\n    width: 65px;\n    min-width: 65px;\n    text-align: right;\n}\n.bif-cell-node-summary-caption-text {\n    white-space: normal;\n    text-overflow: ellipsis;\n    overflow: hidden;\n    word-break: break-all;\n    display: -webkit-box;\n    -webkit-box-orient: vertical;\n    -webkit-line-clamp: 1;\n}\n.bif-cell-node-summary-value {\n\n}\n.bif-cell-node-summary-value-text {\n    font-family: PingFangSC-Regular,HelveticaNeue,Helvetica,Arial,sans-serif;\n    color: rgba(0,0,0,0.85);\n    text-align: left;\n    white-space: normal;\n    display: -webkit-box;\n    -webkit-box-orient: vertical;\n    overflow: hidden;\n    -webkit-line-clamp: 1;\n    word-break: break-all;\n    overflow: hidden;\n    text-overflow: ellipsis;\n}\n.bif-cell-node-title-link {\n}\n.bif-cell-node-title-link:hover {\n    text-decoration: underline;\n    cursor: pointer;\n}\n.bif-cell-node-title-link-color {\n    color: #56A0FF;\n}\n.bif-cell-node-title-only {\n    justify-content: center;\n    height: 100%;\n    display: flex;\n    align-items: center;\n    border: 1px solid rgb(193,195,199,1);\n}\n.bif-cell-node-title-only-text {\n    font-size: xx-large;\n}\n.bif-cell-node-thumb {\n    height: 100%;\n    background: #FFFFFF;\n}\n.bif-cell-node-thumb-img-container {\n    height: 80%;\n}\n.bif-cell-node-thumb-img {\n    height: 100%;\n    width: 100%;\n}\n.bif-cell-node-thumb-title {\n    height: 20%;\n    display: flex;\n    justify-content: center;\n    display: flex;\n    align-items: center;\n}\n.bif-cell-node-thumb-title-text {\n    font-size: x-large;\n}\n.bif-cell-node-btn-group {\n    position: absolute;\n    bottom: 16px;\n    right: 16px;\n}\n.bif-cell-node-btn {\n    width: 22px;\n    height: 22px;\n    margin-left: 8px;\n    cursor: pointer;\n}\n.bif-cell-node .bif-cell-node-btn-group-control {\n    display: none;\n}\n.bif-cell-node:hover .bif-cell-node-btn-group-control {\n    display: unset;\n}\n";function addCustomCSS(t){var e,r=document.createElement("style"),o=document.head||document.getElementsByTagName("head")[0];r.type="text/css",r.styleSheet?(e=function(){try{r.styleSheet.cssText=t}catch(e){}},r.styleSheet.disabled?setTimeout(e,10):e()):(e=document.createTextNode(t),r.appendChild(e)),o.appendChild(r)}addCustomCSS(billTrackerCellCss),addCustomCSS(billTrackerPopupMenuCss);var BillTrackerGraphComponent=function(){function e(e,t,r,o,n,i,a,l,s,c,p){this.dataService=r,this.notify=o,this.messager=n,this.loading=i,this.modal=a,this.vcr=l,this.inj=s,this.cfr=c,this.cdr=p,this.selectEventEmitter=new core$1.EventEmitter,this.stateChangeEventEmitter=new core$1.EventEmitter,this.hspace=80,this.vspace=28,this.defaultWidth=250,this.defaultHeight=138,this.nodeWidth=this.defaultWidth,this.nodeHeight=this.defaultHeight,this.defaultNonEntryImage=mxClientType.IS_SVG?BillTrackerConstant.IMAGE_PATH+"/non-entry-bill.svg":BillTrackerConstant.IMAGE_PATH+"/non-entry-bill.png",this.defaultEntryImage=mxClientType.IS_SVG?BillTrackerConstant.IMAGE_PATH+"/entry-bill.svg":BillTrackerConstant.IMAGE_PATH+"/entry-bill.png",this.defaultOverlayWidth=26,this.defaultOverlayHeight=26,this.overlayWidth=this.defaultOverlayWidth,this.overlayHeight=this.defaultOverlayHeight,this.defaultUpSearchImage=new mxImageType(BillTrackerConstant.IMAGE_PATH+"/tracker-plus.svg",this.overlayWidth,this.overlayHeight),this.defaultDownSearchImage=new mxImageType(BillTrackerConstant.IMAGE_PATH+"/tracker-plus.svg",this.overlayWidth,this.overlayHeight),this.defaultUpFolderImage=new mxImageType(BillTrackerConstant.IMAGE_PATH+"/tracker-minus.svg",this.overlayWidth,this.overlayHeight),this.defaultDownFolderImage=new mxImageType(BillTrackerConstant.IMAGE_PATH+"/tracker-minus.svg",this.overlayWidth,this.overlayHeight),this.upSearchImage=this.defaultUpSearchImage,this.downSearchImage=this.defaultDownSearchImage,this.upFolderImage=this.defaultUpFolderImage,this.downFolderImage=this.defaultDownFolderImage,this.upSearchOffset=new mxPointType(-50,0),this.downSearchOffset=new mxPointType(50,0),this.numCellsAddingReq=0,this.localePipe=new BillTrackerLocalePipe(t),this.dataInfoService=new BillTrackerDataInfoService,this.billTrackerArgs=e,this.originBillTrackerArgs=this.billTrackerArgs;r=this.billTrackerArgs.graphOptions,this.graphOptions=r,o=this.billTrackerArgs.gridOptions;this.gridOptions=o,this.upSearchImage=r&&r.upSearchImage?new mxImageType(r.upSearchImage,this.overlayWidth,this.overlayHeight):this.upSearchImage,this.downSearchImage=r&&r.downSearchImage?new mxImageType(r.downSearchImage,this.overlayWidth,this.overlayHeight):this.downSearchImage,this.upFolderImage=r&&r.upFolderImage?new mxImageType(r.upFolderImage,this.overlayWidth,this.overlayHeight):this.upFolderImage,this.downFolderImage=r&&r.downFolderImage?new mxImageType(r.downFolderImage,this.overlayWidth,this.overlayHeight):this.downFolderImage}return e.prototype.ngOnInit=function(){var o=this;this.graph=this.createGraph(),this.createLayout(this.graph),this.layoutManager=new mxLayoutManagerType(this.graph),this.outline=new Outline(this.graph,this.mxOutlineContainer.nativeElement),this.morePopupMenu=new mxPopupMenuType(function(e,t,r){e.addItem(o.localePipe.transform("goOnTracking"),null,function(){o.goOnTrack(t)})})},e.prototype.ngAfterViewInit=function(){},e.prototype.refresh=function(e){(e=void 0===e?!0:e)&&null!=this.graph&&this.graph.sizeDidChange()},e.prototype.paint=function(){this.paintGraph(this.graph)},e.prototype.setModalRef=function(e){var t,r=this;this.modalRef=e,null!=this.modalRef&&(this.modalRef.dialog.instance.closed.subscribe(function(e){r.graph&&r.graph.destroy()}),t=0,this.modalRef.dialog.instance.resized.subscribe(function(e){2<=t&&r.refresh(),t++}))},e.prototype.createGraph=function(){mxGraphHandlerType.prototype.guidesEnabled=!0,mxEventType.disableContextMenu(this.mxContainerER.nativeElement),mxGraphHandlerType.prototype.scrollOnMove=!1,mxGraphHandlerType.prototype.scaleGrid=!0,mxConstantsType.HANDLE_FILLCOLOR="#29b6f2",mxHandleType.prototype.createShape=function(e){var t=new mxEllipseType(0,0,mxConstantsType.HANDLE_SIZE,mxConstantsType.HANDLE_SIZE);return new mxEllipseType(t,mxConstantsType.HANDLE_FILLCOLOR,mxConstantsType.HANDLE_STROKECOLOR)},mxVertexHandlerType.prototype.handleImage=mxClientType.IS_SVG?Graph.createSvgImage(18,18,'<circle cx="9" cy="9" r="3" stroke="#fff" fill="'+Graph.handleFill+'" stroke-width="1"/>'):new mxImageType(BillTrackerConstant.IMAGE_PATH+"/handle-main.png",mxConstantsType.HANDLE_SIZE,mxConstantsType.HANDLE_SIZE),mxConstantsType.DEFAULT_VALID_COLOR="#FFFFFF",mxConstantsType.HIGHLIGHT_STROKEWIDTH=1,mxConstantsType.GUIDE_COLOR="#0088cf",mxGuideType.prototype.createGuideShape=function(e){return new mxPolylineType([],mxConstantsType.GUIDE_COLOR,mxConstantsType.GUIDE_STROKEWIDTH)},mxConstantsType.VERTEX_SELECTION_STROKEWIDTH=1,mxConstantsType.VERTEX_SELECTION_COLOR="#3E8DFF",mxConstantsType.VERTEX_SELECTION_DASHED=!1,mxConnectionHandlerType.prototype.getEdgeWidth=function(e){return 1},mxConstantsType.VALID_COLOR="#00CD66";var e=new Graph(this.mxContainerER.nativeElement,undefined,undefined,undefined);return e.localePipe=this.localePipe,e.graphOptions=this.graphOptions,e.gridOptions=this.gridOptions,this.addListener(e),e.ngComp=this,e},e.prototype.createLayout=function(e){var t=new RevertCompactTreeLayout(e,!0),t=(t.levelDistance=this.hspace,t.edgeRouting=!1,t.resetEdges=!1,this.upLayout=t,new CompactTreeLayout(e,!0));t.levelDistance=this.hspace,t.edgeRouting=!1,t.resetEdges=!0,this.downLayout=t},e.prototype.addListener=function(r){var o=this;mxEventType.addListener(window,"resize",function(){window.setTimeout(function(){null!=o.graph&&o.refresh()},0)}),mxEventType.addMouseWheelListener(function(e,t){if(mxEventType.isControlDown(e)||mxClientType.IS_MAC&&e.metaKey)return t?o.zoomIn():o.zoomOut(),mxEventType.consume(e),!1},this.mxContainerER.nativeElement),r.selectEventEmitter=this.selectEventEmitter,r.getSelectionModel().addListener(mxEventType.CHANGE,function(e,t){e instanceof mxGraphSelectionModelType&&(null==(e=e).cells||1!=e.cells.length?o.selectEventEmitter.emit(null):!(e=e.cells[0]).edge&&e.vertex&&o.selectEventEmitter.emit(e))}),r.addListener(Events.CLICK_FIRST_SUMMARY,function(e,t){t=t.getProperty("cell");o.stateChangeEventEmitter.emit({type:Events.CLICK_FIRST_SUMMARY,data:t}),r.setSelectionCell(t)});mxEventType.addGestureListeners(document,function(e){null!=o.currentMenu&&mxEventType.getSource(e)!=o.currentMenu.div&&o.hideCurrentMenu()})},e.prototype.hideCurrentMenu=function(){null!=this.currentMenu&&(this.currentMenu.hideMenu(),this.resetCurrentMenu())},e.prototype.resetCurrentMenu=function(){this.currentMenu=null,this.currentMenuElt=null},e.prototype.paintGraph=function(e){e.getModel().beginUpdate(),this.entry=this.paintEntry(e),this.afterPaintGraph(this.graph,this.entry),e.getModel().endUpdate()},e.prototype.repaintGraph=function(e){e.getModel().beginUpdate(),e.removeCells(e.getChildCells(e.getDefaultParent())),this.paintGraph(e),e.getModel().endUpdate()},e.prototype.afterPaintGraph=function(e,t){null!=t&&(this.billTrackerArgs.gridOptions.showEntryData&&e.setSelectionCell(this.entry),t=this.billTrackerArgs.canTrackingResult,1==this.billTrackerArgs.graphOptions.showDownBills&&t.canDownTracking&&this.entry.downCellOverlay&&this.entry.downCellOverlay.fireEvent(new mxEventObjectType(mxEventType.CLICK,"resetView",!0)),1==this.billTrackerArgs.graphOptions.showUpBills)&&t.canUpTracking&&this.entry.upCellOverlay&&this.entry.upCellOverlay.fireEvent(new mxEventObjectType(mxEventType.CLICK,"resetView",!0))},e.prototype.paintEntry=function(e){var t=null;if(null!=this.billTrackerArgs&&null!=this.billTrackerArgs.canTrackingResult){var r=this.billTrackerArgs.canTrackingResult,o=this.dataService.buildEntryBillInfo(r),n=o.billDataInfos[0],i=((new commonApi.BillTrackingSettings).LoadFromJson(r.billTrackingSettings),e.getDefaultParent());e.getModel().beginUpdate();try{var a,l=new commonApi.BillTrackingSettings,t=(o&&o.billTrackingSettings&&l.LoadFromJson(o.billTrackingSettings),e.insertBillCell(i,null,n,o,!0,0,0,this.nodeWidth,this.nodeHeight,"billNode;billNodeEntry;"));e.getModel().getGeometry(t),e.getPreferredSizeForCell(t);this.entryCellData=new EntryCellData,this.setCellData(this.entryCellData,t),this.entryCellData.canTrackingResult=r,t.data=this.entryCellData,r.canDownTracking&&(a=this.addDownOverlay(e,t),t.downCellOverlay=a),r.canUpTracking&&(a=this.addUpOverlay(e,t),t.upCellOverlay=a),this.upParent=i.clone(),this.downParent=i.clone(),e.addCells([this.upParent,this.downParent],i)}finally{e.getModel().endUpdate()}}return t},e.prototype.addUpOverlay=function(o,n){var i=this,a=new CellOverlay(this.upSearchImage,this.localePipe.transform("upSearch"),mxConstantsType.ALIGN_LEFT,mxConstantsType.ALIGN_MIDDLE,this.upSearchOffset,"hand"),l=(a.state=CellOverlayState.Search,function(e,t){var r=t.getProperty("resetView"),t=null==t.getProperty("showLoading")||t.getProperty("showLoading");o.getModel().beginUpdate(),i.addUpAssoCell(o,n,r,t),a.removeListener(l),a.tooltip=i.localePipe.transform("folder"),a.image=i.upFolderImage,a.state=CellOverlayState.Fold,a.addListener(mxEventType.CLICK,s),o.removeCellOverlay(n,a),o.addCellOverlay(n,a),o.getModel().endUpdate()}),s=function(e,t){o.getModel().beginUpdate(),i.removeAssoCell(o,n,BillTrackerDirection.Up),a.removeListener(s),a.tooltip=i.localePipe.transform("upSearch"),a.image=i.upSearchImage,a.state=CellOverlayState.Search,a.addListener(mxEventType.CLICK,l),o.removeCellOverlay(n,a),o.addCellOverlay(n,a),o.model.endUpdate()};return a.addListener(mxEventType.CLICK,l),o.removeCellOverlay(n,a),o.addCellOverlay(n,a),a},e.prototype.addDownOverlay=function(o,n){var i=this,a=new CellOverlay(this.downSearchImage,this.localePipe.transform("downSearch"),mxConstantsType.ALIGN_RIGHT,mxConstantsType.ALIGN_MIDDLE,this.downSearchOffset,"hand"),l=(a.state=CellOverlayState.Search,function(e,t){var r=t.getProperty("resetView"),t=null==t.getProperty("showLoading")||t.getProperty("showLoading");o.getModel().beginUpdate(),i.addDownAssoCell(o,n,r,t),a.image=i.downFolderImage,a.tooltip=i.localePipe.transform("folder"),a.state=CellOverlayState.Fold,a.removeListener(l),a.addListener(mxEventType.CLICK,s),o.removeCellOverlay(n,a),o.addCellOverlay(n,a),o.getModel().endUpdate()}),s=function(e,t){o.getModel().beginUpdate(),i.removeAssoCell(o,n,BillTrackerDirection.Down),a.image=i.downSearchImage,a.tooltip=i.localePipe.transform("downSearch"),a.state=CellOverlayState.Search,a.removeListener(s),a.addListener(mxEventType.CLICK,l),o.removeCellOverlay(n,a),o.addCellOverlay(n,a),o.getModel().endUpdate()};return a.addListener(mxEventType.CLICK,l),o.removeCellOverlay(n,a),o.addCellOverlay(n,a),a},e.prototype.addUpAssoCell=function(O,k,_,e){var V=this,t=(void 0===_&&(_=!1),void 0===e&&(e=!0),O.getModel().beginUpdate(),this.dataService.buildGetUpBillsInfoArgs(k)),J=e&&(this.loading.clearAll(),this.loading.show({message:this.localePipe.transform("loading")}));this.numCellsAddingReq++,this.dataService.getUpBillsInfo(t).subscribe(function(e){var t,r,o,n,i,a,l,s,c=O.getDefaultParent(),p=[];try{try{for(var u=__values(e),d=u.next();!d.done;d=u.next()){var m=d.value;try{for(var h=__values(m.billDataInfos),g=h.next();!g.done;g=h.next()){var f=g.value,y=new commonApi.BillTrackingSettings,x=(m&&m.billTrackingSettings&&y.LoadFromJson(m.billTrackingSettings),O.insertBillCell(V.upParent,null,f,m,!1,k.geometry.x-V.hspace,k.geometry.y,V.nodeWidth,V.nodeHeight,"billNode;"));p.push(x)}}catch(R){o={error:R}}finally{try{g&&!g.done&&(n=h["return"])&&n.call(h)}finally{if(o)throw o.error}}}}catch(D){t={error:D}}finally{try{d&&!d.done&&(r=u["return"])&&r.call(u)}finally{if(t)throw t.error}}V.calCellsPosition(O,k,p,BillTrackerDirection.Up);try{for(var b,C=__values(p),v=C.next();!v.done;v=C.next())(w=v.value).billDataInfo.canContinueTracking&&(b=V.addUpOverlay(O,w),w.upCellOverlay=b),O.insertEdge(c,null,"",w,k,"billAssociation;")}catch(L){i={error:L}}finally{try{v&&!v.done&&(a=C["return"])&&a.call(C)}finally{if(i)throw i.error}}var S=V.entry.getGeometry().clone(),T=(V.upLayout.execute(V.upParent,V.entry),V.entry.getGeometry().clone()),I=S.x-T.x,A=S.y-T.y,E=(V.restoreEntryPosition(O,V.entry,I,A),k.data);E.ups.length=0;try{for(var B=__values(p),M=B.next();!M.done;M=B.next()){var w=M.value,P=new UpCellData;V.setCellData(P,w),((w.data=P).down=E).ups.push(P)}}catch(F){l={error:F}}finally{try{M&&!M.done&&(s=B["return"])&&s.call(B)}finally{if(l)throw l.error}}}finally{O.getModel().endUpdate()}_&&O.fireEvent(new mxEventObjectType(Events.RESET_GRAPH_VIEW)),V.numCellsAddingReq--,V.graph.fireEvent(new mxEventObjectType(Events.BILL_CELLS_ADDED_AND_MOVED,"cells",p,"parent",V.upParent)),J&&J.close()},function(e){throw V.numCellsAddingReq--,J&&J.close(),-1==V.messager.currentId&&V.messager.error(null!=e.error&&(e.error.Message||e.error.message)||e.message),e})},e.prototype.addDownAssoCell=function(O,k,_,e){var V=this,t=(void 0===_&&(_=!1),void 0===e&&(e=!0),O.getModel().beginUpdate(),this.dataService.buildGetDownBillsInfoArgs(k)),J=e&&(this.loading.clearAll(),this.loading.show({message:this.localePipe.transform("loading")}));this.numCellsAddingReq++,this.dataService.getDownBillsInfo(t).subscribe(function(e){O.getModel();var t,r,o,n,i,a,l,s,c=O.getDefaultParent(),p=[];try{try{for(var u=__values(e),d=u.next();!d.done;d=u.next()){var m=d.value;try{for(var h=__values(m.billDataInfos),g=h.next();!g.done;g=h.next()){var f=g.value,y=new commonApi.BillTrackingSettings,x=(m&&m.billTrackingSettings&&y.LoadFromJson(m.billTrackingSettings),O.insertBillCell(V.downParent,null,f,m,!1,k.geometry.x+V.hspace,k.geometry.y,V.nodeWidth,V.nodeHeight,"billNode;"));p.push(x)}}catch(R){o={error:R}}finally{try{g&&!g.done&&(n=h["return"])&&n.call(h)}finally{if(o)throw o.error}}}}catch(D){t={error:D}}finally{try{d&&!d.done&&(r=u["return"])&&r.call(u)}finally{if(t)throw t.error}}V.calCellsPosition(O,k,p,BillTrackerDirection.Down);try{for(var b,C=__values(p),v=C.next();!v.done;v=C.next())(w=v.value).billDataInfo.canContinueTracking&&(b=V.addDownOverlay(O,w),w.downCellOverlay=b),O.insertEdge(c,null,"",k,w,"billAssociation;")}catch(L){i={error:L}}finally{try{v&&!v.done&&(a=C["return"])&&a.call(C)}finally{if(i)throw i.error}}var S=V.entry.getGeometry().clone(),T=(V.downLayout.execute(V.downParent,V.entry),V.entry.getGeometry().clone()),I=S.x-T.x,A=S.y-T.y,E=(V.restoreEntryPosition(O,V.entry,I,A),k.data);E.downs.length=0;try{for(var B=__values(p),M=B.next();!M.done;M=B.next()){var w=M.value,P=new DownCellData;V.setCellData(P,w),((w.data=P).up=E).downs.push(P)}}catch(F){l={error:F}}finally{try{M&&!M.done&&(s=B["return"])&&s.call(B)}finally{if(l)throw l.error}}}finally{O.getModel().endUpdate()}_&&O.fireEvent(new mxEventObjectType(Events.RESET_GRAPH_VIEW)),V.numCellsAddingReq--,V.graph.fireEvent(new mxEventObjectType(Events.BILL_CELLS_ADDED_AND_MOVED,"cells",p,"parent",V.downParent)),J&&J.close()},function(e){throw V.numCellsAddingReq--,J&&J.close(),-1==V.messager.currentId&&V.messager.error(null!=e.error&&(e.error.Message||e.error.message)||e.message),e})},e.prototype.removeAssoCell=function(e,t,r){var o=e.getModel();e.getDefaultParent();e.getModel().beginUpdate();try{var n=[];if(r==BillTrackerDirection.Down)for(var i=o.getOutgoingEdges(t),a=0;i&&0<i.length&&a<i.length;)i[a].target&&i[a].target!=this.entry&&(n.push(i[a].target),i.push.apply(i,__spread(o.getOutgoingEdges(i[a].target)))),a++;else if(r==BillTrackerDirection.Up)for(i=o.getIncomingEdges(t),a=0;i&&0<i.length&&a<i.length;)i[a].source&&i[a].source!=this.entry&&(n.push(i[a].source),i.push.apply(i,__spread(o.getIncomingEdges(i[a].source)))),a++;r==BillTrackerDirection.Down?t.data.downs.length=0:r==BillTrackerDirection.Up&&(t.data.ups.length=0),e.removeCells(n);var l=this.entry.getGeometry().clone(),s=(this.upLayout.execute(this.upParent,this.entry),this.entry.getGeometry().clone()),c=l.x-s.x,p=l.y-s.y,u=(this.restoreEntryPosition(e,this.entry,c,p),this.entry.getGeometry().clone()),d=(this.downLayout.execute(this.downParent,this.entry),this.entry.getGeometry().clone()),m=u.x-d.x,h=u.y-d.y;this.restoreEntryPosition(e,this.entry,m,h)}finally{e.getModel().endUpdate()}},e.prototype.restoreEntryPosition=function(e,t,r,o){e.getModel().beginUpdate();try{var n=__spread([t],e.getChildCells(this.upParent,!0,!1),e.getChildCells(this.downParent,!0,!1));e.moveCells(n,r,o)}finally{e.getModel().endUpdate()}},e.prototype.calCellsPosition=function(e,t,r,o){o==BillTrackerDirection.Down?this.resetDownCellsPosition(e,t,r):o==BillTrackerDirection.Up&&this.resetUpCellsPosition(e,t,r)},e.prototype.resetDownCellsPosition=function(t,e,r){t.getModel().beginUpdate();try{for(var o=t.getOutgoingEdges(e).map(function(e){return e.target}),n=o.sort(function(e,t){return e.geometry&&t.geometry?t.geometry.y-e.geometry.y:Number.MIN_VALUE}),i=(0<n.length?n[n.length-1]:e).geometry.y,a=(0<n.length?n[0]:e).geometry.y,l=0;l<r.length;l++)a=0<o.length?a+this.vspace:a,t.translateCell(r[l],0,a-r[l].geometry.y),o.push(r[l]);var s,c,p,u=(a+i)/2,d=e.geometry.y-u;for(s in o.forEach(function(e){t.translateCell(e,0,d)}),i+=d,a+=d,t.model.cells)t.model.cells[s]==t.model.root||null==t.model.cells[s].geometry||1==t.model.cells[s].edge||t.model.cells[s]==e||-1!=r.indexOf(t.model.cells[s])||t.model.cells[s]==this.entry||t.model.cells[s].geometry.x<this.entry.geometry.x||(p=(c=t.model.cells[s]).geometry,t.translateCell(c,0,p.y<=e.geometry.y?i-(e.geometry.y-p.y)-p.y:a+(p.y-e.geometry.y)-p.y))}finally{t.getModel().endUpdate()}},e.prototype.resetUpCellsPosition=function(t,e,r){t.getModel().beginUpdate();try{for(var o=t.getIncomingEdges(e).map(function(e){return e.source}),n=o.sort(function(e,t){return e.geometry&&t.geometry?t.geometry.y-e.geometry.y:Number.MIN_VALUE}),i=(0<n.length?n[n.length-1]:e).geometry.y,a=(0<n.length?n[0]:e).geometry.y,l=0;l<r.length;l++)a=0<o.length?a+this.vspace:a,t.translateCell(r[l],0,a-r[l].geometry.y),o.push(r[l]);var s,c,p,u=(a+i)/2,d=e.geometry.y-u;for(s in o.forEach(function(e){t.translateCell(e,0,d)}),i+=d,a+=d,t.model.cells)t.model.cells[s]==t.model.root||null==t.model.cells[s].geometry||1==t.model.cells[s].edge||t.model.cells[s]==e||-1!=r.indexOf(t.model.cells[s])||t.model.cells[s]==this.entry||t.model.cells[s].geometry.x>this.entry.geometry.x||(p=(c=t.model.cells[s]).geometry,t.translateCell(c,0,p.y<=e.geometry.y?i-(e.geometry.y-p.y)-p.y:a+(p.y-e.geometry.y)-p.y))}finally{t.getModel().endUpdate()}},e.prototype.setCellData=function(e,t){e.billInfo=t.billInfo,e.billDataInfo=t.billDataInfo,e.visible=!0,e.diagramInfo.x=t.geometry.x,e.diagramInfo.y=t.geometry.y,e.diagramInfo.width=t.geometry.width,e.diagramInfo.height=t.geometry.height,e.diagramInfo.extProps={style:t.style}},e.prototype.zoomOut=function(){this.graph.zoomOut()},e.prototype.zoomIn=function(){this.graph.zoomIn()},e.prototype.zoomActual=function(){this.graph.zoomActual()},e.prototype.getZoomScale=function(){return Math.round(100*this.graph.view.scale)},e.prototype.print=function(){var e=new mxPrintPreviewType(this.graph,1);e.printOverlays=!0,e.printControls=!0,e.printBackgroundImage=!0,e.open(billTrackerCellCss)},e.prototype.expand=function(e,t){var r;(t=void 0!==t&&t)?this.expandAll(e):e==BillTrackerDirection.Up?(r=[this.entry],this.upParent.children&&r.push.apply(r,__spread(this.upParent.children)),r.forEach(function(e){e.upCellOverlay&&e.upCellOverlay.state==CellOverlayState.Search&&e.upCellOverlay.fireEvent(new mxEventObjectType(mxEventType.CLICK))})):e==BillTrackerDirection.Down&&(r=[this.entry],this.downParent.children&&r.push.apply(r,__spread(this.downParent.children)),r.forEach(function(e){e.downCellOverlay&&e.downCellOverlay.state==CellOverlayState.Search&&e.downCellOverlay.fireEvent(new mxEventObjectType(mxEventType.CLICK))}))},e.prototype.expandAll=function(e){var t,r,o=this;e!=BillTrackerDirection.Up&&e!=BillTrackerDirection.Down||(t=null,e==BillTrackerDirection.Up?t=function(){var e=[o.entry],e=(o.upParent.children&&e.push.apply(e,__spread(o.upParent.children)),e.filter(function(e){return e.upCellOverlay&&e.upCellOverlay.state==CellOverlayState.Search}));null==e||0==e.length?0===o.numCellsAddingReq&&(r&&r.close(),o.graph.removeListener(t)):e.forEach(function(e){e.upCellOverlay&&e.upCellOverlay.state==CellOverlayState.Search&&e.upCellOverlay.fireEvent(new mxEventObjectType(mxEventType.CLICK,"showLoading",!1))})}:e==BillTrackerDirection.Down&&(t=function(){var e=[o.entry],e=(o.downParent.children&&e.push.apply(e,__spread(o.downParent.children)),e.filter(function(e){return e.downCellOverlay&&e.downCellOverlay.state==CellOverlayState.Search}));null==e||0==e.length?0===o.numCellsAddingReq&&(r&&r.close(),o.graph.removeListener(t)):e.forEach(function(e){e.downCellOverlay&&e.downCellOverlay.state==CellOverlayState.Search&&e.downCellOverlay.fireEvent(new mxEventObjectType(mxEventType.CLICK,"showLoading",!1))})}),this.graph.addListener("billCellsAddedAndMoved",t),r=this.loading.show({message:this.localePipe.transform("loading")}),t())},e.prototype.goOnTrack=function(e){var t=this.inj.get(BillTrackerUiService),r=new GetBillsInfoArgs;r.billDataId=e.billDataInfo.dataId,r.curYear=e.billDataInfo.curYear,r.bizKind=e.billInfo.bizKind,r.bizType=e.billInfo.bizType,r.documentTypeId=e.billInfo.documentTypeId,this.localePipe.transform("billTracker");t.openDefaultBillTrackerApp(r,{showDownBills:!0,showUpBills:!0},{})},e.prototype.setAsCurrent=function(e){var r=this,o=this.dataService.buildGetBillsInfoArgs(e),e=new GetDownBillsInfoArgs;e.documentTypeId=o.documentTypeId,e.billDataId=o.billDataId,e.bizKind=o.bizKind,e.bizType=o.bizType,e.curYear=o.curYear,this.loading.show({message:this.localePipe.transform("loading")}),this.dataService.canTracking(e).subscribe(function(e){var t;r.loading.close(),e.canDownTracking||e.canUpTracking?((t=new BillTrackerArgs).canTrackingResult=e,t.getBillsInfoArgs=o,t.graphOptions=r.billTrackerArgs.graphOptions,t.gridOptions=r.billTrackerArgs.gridOptions,r.billTrackerArgs=t,r.repaintGraph(r.graph)):r.messager.info(r.localePipe.transform("noAssoBill"))},function(e){throw r.loading.close(),r.messager.error(null!=e.error&&(e.error.Message||e.error.message)||e.message),e})},e.decorators=[{type:core$1.Component,args:[{selector:"lib-bill-tracker-graph",template:'<div #mxContainer id="mx-container" class="mx-container-ng">\r\n\r\n</div>\r\n\r\n<div #mxOutlineContainer id="mx-outline-container" class="mx-outline-container" [style.top]="modalRef?\'50px\':null">\r\n\r\n</div>',styles:[".mx-container-ng{position:absolute;top:0;left:0;bottom:0;right:0;cursor:default;overflow:auto;padding-right:16px;padding-bottom:16px;margin:4px}.mx-outline-container{z-index:1;position:absolute;overflow:hidden;top:20px;right:20px;width:160px;height:120px;background:#fff;border:1px solid #d3d3d3}"]}]}],e.ctorParameters=function(){return[{type:BillTrackerArgs},{type:String,decorators:[{type:core$1.Inject,args:[core$1.LOCALE_ID]}]},{type:BillTrackerDataService},{type:uiNotify.NotifyService},{type:uiMessager.MessagerService},{type:uiLoading.LoadingService},{type:uiModal.BsModalService},{type:core$1.ViewContainerRef},{type:core$1.Injector},{type:core$1.ComponentFactoryResolver},{type:core$1.ChangeDetectorRef}]},e.propDecorators={mxContainerER:[{type:core$1.ViewChild,args:["mxContainer"]}],mxOutlineContainer:[{type:core$1.ViewChild,args:["mxOutlineContainer"]}],selectEventEmitter:[{type:core$1.Output,args:["select"]}],stateChangeEventEmitter:[{type:core$1.Output,args:["stateChange"]}],billTrackerArgs:[{type:core$1.Input,args:["billTrackerArgs"]}]},e}(),BillFrontField=function(){},BillFrontDataRow=function(){},BasicTableComponent=function(){function e(e,t,r,o){this.viewContainerRef=e,this.inj=t,this.cfr=r,this.cdr=o}return e.prototype.ngOnInit=function(){},e.prototype.clickHandler=function(e,t){e.expanded=!e.expanded},e.prototype.showMainTable=function(e){this.showTable(e.billSchema.mainTable,e.billData.mainTable)},e.prototype.showTable=function(e,t){this.billSchemaTable=e,this.billDataTable=t,this.loadData(e.getFieldList(),t.GetRowList()),this.cdr.detectChanges()},e.prototype.loadData=function(e,t){this.fields=e,this.rows=t;var r=new commonApi.BillTrackingSettings;this.billInfo&&this.billInfo.billTrackingSettings&&r.LoadFromJson(this.billInfo.billTrackingSettings),r.billTrackingDataShownMode==commonApi.BillTrackingDataShownMode.CUSTOMFIELD?this.ffields=this.extractFFieldsWithCustomFields(e,r.customFieldContent):this.ffields=this.extractFFields(e),this.frows=this.extractFRows(t,this.ffields)},e.prototype.extractFFields=function(e){var t,r,o=[];try{for(var n=__values(e),i=n.next();!i.done;i=n.next()){var a,l=i.value;"Enum"==l.fieldType||"EnumSingleUdt"==l.fieldType?((a=new BillFrontField).fieldName=l.fieldName,a.dataType=l.dataType,a.caption=l.caption,a.fieldType=l.fieldType,a.length=l.length,a.precision=l.precision,a.scale=l.scale,a.captionPath=this.extractCaptionPath(l),a.fieldPath=this.extractFieldPath(l)+".Name",o.push(a)):null!=l.GetSubFieldList()&&0<l.GetSubFieldList().length?o.push.apply(o,__spread(this.extractFSubFields(l.GetSubFieldList()))):((a=new BillFrontField).fieldName=l.fieldName,a.dataType=l.dataType,a.caption=l.caption,a.fieldType=l.fieldType,a.length=l.length,a.precision=l.precision,a.scale=l.scale,a.captionPath=this.extractCaptionPath(l),a.fieldPath=this.extractFieldPath(l),o.push(a))}}catch(s){t={error:s}}finally{try{i&&!i.done&&(r=n["return"])&&r.call(n)}finally{if(t)throw t.error}}return o},e.prototype.extractFSubFields=function(e,t){var r,o,n=[];try{for(var i=__values(e),a=i.next();!a.done;a=i.next()){var l,s=a.value;"Enum"==s.fieldType||"EnumSingleUdt"==s.fieldType?((l=new BillFrontField).fieldName=s.fieldName,l.dataType=s.dataType,l.caption=s.caption,l.fieldType=s.fieldType,l.length=s.length,l.precision=s.precision,l.scale=s.scale,l.captionPath=this.extractCaptionPath(s),l.fieldPath=this.extractFieldPath(s)+".Name",n.push(l)):null!=s.GetSubFieldList()&&0<s.GetSubFieldList().length?n.push.apply(n,__spread(this.extractFSubFields(s.GetSubFieldList()))):((l=new BillFrontField).fieldName=s.fieldName,l.dataType=s.dataType,l.caption=s.caption,l.fieldType=s.fieldType,l.length=s.length,l.precision=s.precision,l.scale=s.scale,l.captionPath=this.extractCaptionPath(s),l.fieldPath=this.extractFieldPath(s),n.push(l))}}catch(c){r={error:c}}finally{try{a&&!a.done&&(o=i["return"])&&o.call(i)}finally{if(r)throw r.error}}return n},e.prototype.extractFFieldsWithCustomFields=function(e,a){var t,r,l=this.billSchemaTable.tableName,o=new commonApi.BillTrackingSettings,s=(this.billInfo&&this.billInfo.billTrackingSettings&&o.LoadFromJson(this.billInfo.billTrackingSettings),"object"==typeof a?a:JSON.parse(a)),c=[],p=this;try{for(var n=__values(e),i=n.next();!i.done;i=n.next())!function(e){var t,r,o=p.extractFieldPath(e),n=null;for(t in s.schema)if("selectedAll"!=t&&t==l){var i=s.schema[t],n=i&&i.fields.find(function(e){return e.fieldPath==o});break}if(null==n)return;"Enum"==e.fieldType||"EnumSingleUdt"==e.fieldType?((r=new BillFrontField).fieldName=e.fieldName,r.dataType=e.dataType,r.caption=e.caption,r.fieldType=e.fieldType,r.length=e.length,r.precision=e.precision,r.scale=e.scale,r.captionPath=n.displayName||e.caption,r.fieldPath=p.extractFieldPath(e)+".Name",c.push(r)):null!=e.GetSubFieldList()&&0<e.GetSubFieldList().length?c.push.apply(c,__spread(p.extractFSubFieldsWithCustomFields(e.GetSubFieldList(),a,e))):((r=new BillFrontField).fieldName=e.fieldName,r.dataType=e.dataType,r.caption=e.caption,r.fieldType=e.fieldType,r.length=e.length,r.precision=e.precision,r.scale=e.scale,r.captionPath=n.displayName||e.caption,r.fieldPath=p.extractFieldPath(e),c.push(r))}(i.value)}catch(u){t={error:u}}finally{try{i&&!i.done&&(r=n["return"])&&r.call(n)}finally{if(t)throw t.error}}return c},e.prototype.extractFSubFieldsWithCustomFields=function(e,a,t){var r,o,l=this.billSchemaTable.tableName,n=new commonApi.BillTrackingSettings,s=(this.billInfo&&this.billInfo.billTrackingSettings&&n.LoadFromJson(this.billInfo.billTrackingSettings),"object"==typeof a?a:JSON.parse(a)),c=[],p=this;try{for(var i=__values(e),u=i.next();!u.done;u=i.next())!function(e){var t,r,o=p.extractFieldPath(e),n=null;for(t in s.schema)if("selectedAll"!=t&&t==l){var i=s.schema[t],n=i&&i.fields.find(function(e){return e.fieldPath==o});break}if(null==n)return;"Enum"==e.fieldType||"EnumSingleUdt"==e.fieldType?((r=new BillFrontField).fieldName=e.fieldName,r.dataType=e.dataType,r.caption=e.caption,r.fieldType=e.fieldType,r.length=e.length,r.precision=e.precision,r.scale=e.scale,r.captionPath=n.displayName||e.caption,r.fieldPath=p.extractFieldPath(e)+".Name",c.push(r)):null!=e.GetSubFieldList()&&0<e.GetSubFieldList().length?c.push.apply(c,__spread(p.extractFSubFieldsWithCustomFields(e.GetSubFieldList(),a,e))):((r=new BillFrontField).fieldName=e.fieldName,r.dataType=e.dataType,r.caption=e.caption,r.fieldType=e.fieldType,r.length=e.length,r.precision=e.precision,r.scale=e.scale,r.captionPath=n.displayName||e.caption,r.fieldPath=p.extractFieldPath(e),c.push(r))}(u.value)}catch(d){r={error:d}}finally{try{u&&!u.done&&(o=i["return"])&&o.call(i)}finally{if(r)throw r.error}}return c},e.prototype.extractCaptionPath=function(e){for(var t=e.caption,r=e;null!=r.attachedField;)t=r.attachedField.caption+"."+t,r=r.attachedField;return t},e.prototype.extractFieldPath=function(e){for(var t=e.fieldName,r=e;null!=r.attachedField;)t=r.attachedField.fieldName+"."+t,r=r.attachedField;return t},e.prototype.extractFRows=function(e,t){var r,o,n,i,a=[];try{for(var l=__values(e),s=l.next();!s.done;s=l.next()){var c=s.value,p=new BillFrontDataRow;p.expanded=0==c.GetChildTableList().length?null:!(!c.attachedTable||null!=c.attachedTable.attachedRow),p.hasChildren=this.hasChildren(c),p.data={};try{for(var u=__values(t),d=u.next();!d.done;d=u.next()){var m=d.value;p.data[m.fieldPath]=this.extractFieldPathValue(c.GetFieldMap(),m.fieldPath)}}catch(h){n={error:h}}finally{try{d&&!d.done&&(i=u["return"])&&i.call(u)}finally{if(n)throw n.error}}a.push(p)}}catch(g){r={error:g}}finally{try{s&&!s.done&&(o=l["return"])&&o.call(l)}finally{if(r)throw r.error}}return a},e.prototype.hasChildren=function(e){var t,r,o=e.GetChildTableList()&&0<e.GetChildTableList().length;if(o){var n=!1;try{for(var i=__values(e.GetChildTableList()),a=i.next();!a.done;a=i.next()){var l=a.value;if(l.GetRowList()&&0<l.GetRowList().length){n=!0;break}}}catch(s){t={error:s}}finally{try{a&&!a.done&&(r=i["return"])&&r.call(i)}finally{if(t)throw t.error}}o=n}return o},e.prototype.extractFieldPathValue=function(e,t){for(var r=t.split("."),o=e[r[0]],n=1;null!=o&&n<r.length;n++){var i=o.GetSubFieldMap();if(null==i)break;o=i[r[n]]}return o?o.GetTextValue():""},e.prototype.getShownText=function(e,t){var r;return null==e[t.fieldPath]?"":t.dataType==commonApi$1.DataType.String?e[t.fieldPath]||"":t.dataType==commonApi$1.DataType.Decimal?parseFloat(String(e[t.fieldPath])).toFixed(t.scale).toString()||"":t.dataType==commonApi$1.DataType.DateTime?(r=commonApi$1.BpmnModelJsonHelper.DateTimeFromString(e[t.fieldPath]),"DateTime"==t.fieldType?this.dateFormat(r,"yyyy-MM-dd HH:mm:ss.SSS"):(t.fieldType,this.dateFormat(r,"yyyy-MM-dd"))):e[t.fieldPath]||""},e.prototype.isObject=function(e){return"object"==typeof e},e.prototype.isArray=function(e){return Array.isArray(e)},e.prototype.dateFormat=function(e,t){var r,o,n={"y+":e.getUTCFullYear().toString(),"M+":(e.getUTCMonth()+1).toString(),"d+":e.getUTCDate().toString(),"H+":e.getUTCHours().toString(),"m+":e.getUTCMinutes().toString(),"s+":e.getUTCSeconds().toString(),"S+":e.getUTCMilliseconds().toString()};for(o in n)(r=new RegExp("("+o+")").exec(t))&&(t=String.prototype.padStart?t.replace(r[1],1==r[1].length?n[o]:n[o].padStart(r[1].length,"0")):t.replace(r[1],1==r[1].length?n[o]:this.myPadStart(n[o],r[1].length,"0")));return t},e.prototype.myPadStart=function(e,t,r){return t>>=0,r=String(void 0!==r?r:" "),e.length>t?String(e):((t-=e.length)>r.length&&(r+=r.repeat(t/r.length)),r.slice(0,t)+String(e))},e.decorators=[{type:core$1.Component,args:[{selector:"app-basic-table",template:'<table class="table table-striped table-hover text-nowrap" [ngStyle]="{\'margin-left\': isMain ? null : \'24px\'}"\r\n    style="min-width: 100%; width: auto;" *ngIf="ffields && ffields.length > 0 && frows && frows.length > 0">\r\n    <thead class="thead-light">\r\n        <tr>\r\n            <th style="width: 40px;"><span></span></th>\r\n            <th *ngFor="let ffield of ffields">\r\n                <span>{{ffield.captionPath}}</span>\r\n            </th>\r\n        </tr>\r\n    </thead>\r\n    <tbody>\r\n        <ng-container *ngFor="let frow of frows;let rowIdx = index;">\r\n            <tr #tr>\r\n                <td>\r\n                    <span *ngIf="frow.hasChildren" style="cursor:pointer;" (click)="clickHandler(frow, $event)"\r\n                        [ngClass]="{\'k-icon\': true, \'k-i-plus-outline\': !frow.expanded, \'k-i-minus-outline\': frow.expanded}"></span>\r\n                </td>\r\n                <ng-container *ngFor="let ffield of ffields">\r\n                    <td>\r\n                        <span>{{getShownText(frow.data, ffield)}}</span>\r\n                        <span *ngIf="ffield.showMore" class="f-icon f-icon-more"></span>\r\n                    </td>\r\n                </ng-container>\r\n            </tr>\r\n            <tr *ngIf="frow.expanded&&frow.hasChildren">\r\n                <td [attr.colspan]="tr.cells.length">\r\n                    <ng-container appChildRowTable [parentRow]="rows[rowIdx]" [parentSchemaTable]="billSchemaTable"\r\n                        [parentDataTable]="billDataTable" [billInfo]="billInfo" [expanded]="frow.expanded"\r\n                        [colspan]="tr.cells.length">\r\n                    </ng-container>\r\n                </td>\r\n            </tr>\r\n        </ng-container>\r\n    </tbody>\r\n    <tfoot>\r\n    </tfoot>\r\n</table>',changeDetection:core$1.ChangeDetectionStrategy.OnPush,styles:["./basic-table.component.css"]}]}],e.ctorParameters=function(){return[{type:core$1.ViewContainerRef},{type:core$1.Injector},{type:core$1.ComponentFactoryResolver},{type:core$1.ChangeDetectorRef}]},e.propDecorators={childTrTable:[{type:core$1.ViewChild,args:["childTrTable"]}],childTrTableVCR:[{type:core$1.ViewChild,args:["childTrTable",{read:core$1.ViewContainerRef}]}]},e}(),BasicInfoComponent=function(){function e(e,t,r,o,n,i,a,l,s,c,p,u){this.framework=e,this.dataInfoService=t,this.notify=r,this.messager=o,this.loading=n,this.modal=i,this.localePipe=a,this.vcr=l,this.inj=s,this.cfr=c,this.cdr=p,this.localeId=u,this.fieldsWithValue=[],this.childSchemaTables=[],this.childDataTableMap={},this.dataType=commonApi$1.DataType,this.secTitle="",this.localeId=u||this.inj.get(core$1.LOCALE_ID);e=core$1.ReflectiveInjector.resolveAndCreate([BillTrackerInternalUiService],this.inj);this.internalUiService=e.get(BillTrackerInternalUiService,null)}return e.prototype.ngOnInit=function(){this.secTitle=this.localePipe.transform("basicInfo"),this.secTitle=this.dataInfoService.getTableLabel(this.billInfo,this.schemaTable,this.localeId);try{this.fieldsWithValue=this.dataInfoService.getBasicInfoFieldsWithValue(this.billInfo,this.schemaTable,this.dataTable)}catch(t){throw this.fieldsWithValue=[],t==Exceptions.SCALE_FIELD_VALUE_IS_NAN&&this.messager.error(this.localePipe.transform("scaleFieldCantBeCastToInteger")),t}this.fieldsWithValue=this.dataInfoService.sortFieldsByOrder(this.fieldsWithValue);var e=this.dataTable.GetRowList()[0];this.childSchemaTables=this.dataInfoService.getChildTables(this.billInfo,this.schemaTable),this.childDataTableMap=e.GetChildTableMap(),null!=this.billInfo.jointQueryParameters?(e=JSON.parse(this.billInfo.jointQueryParameters),this.hasLink=this.billInfo.jointQueryMode==commonApi.JointQueryMode.APP&&null!=e.funcId||this.billInfo.jointQueryMode==commonApi.JointQueryMode.URL&&null!=e.url):this.hasLink=!1},e.prototype.clickLink=function(){return this.internalUiService.openBillDetailWithFields(this.billInfo,this.billDataInfo,this.fieldsWithValue),event.stopPropagation(),!1},e.decorators=[{type:core$1.Component,args:[{selector:"lib-bill-tracker-main-table",template:'<farris-section class="f-section-form f-section-in-mainsubcard" [mainTitle]="secTitle">\r\n  <div class="f-form-layout farris-form farris-form-controls-inline">\r\n    <ng-container *ngFor="let field of fieldsWithValue; let i = index">\r\n      <div class="col-12 col-md-6 col-xl-3 col-el-2" *ngIf="field.show">\r\n        \x3c!-- 仅显示show属性为true的字段 --\x3e\r\n        \x3c!-- <div class="farris-group-wrap" *ngIf="!(hasLink && i==0); else linkTemp"> --\x3e\r\n        <div class="farris-group-wrap">\r\n          \x3c!-- 非布尔值使用文本框 --\x3e\r\n          <div class="form-group farris-form-group" *ngIf="field.dataType!=dataType.Boolean">\r\n            <label class="col-form-label">\r\n              <span class="farris-label-text" title="{{field | billTrackerFieldLabel}}">\r\n                {{field | billTrackerFieldLabel}}\r\n              </span>\r\n            </label>\r\n            <div class="farris-input-wrap">\r\n              <div class="f-component-text" *ngIf="field.dataType!=dataType.Boolean">\r\n                <span class="f-form-control-text" title="{{field.fieldValue}}"\r\n                  [ngStyle]="{\'text-align\': field.dataType == dataType.Integer || field.dataType == dataType.Decimal ? \'right\':null}">\r\n                  {{field.fieldValue}}\r\n                </span>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          \x3c!-- 布尔值使用复选框 --\x3e\r\n          <div class="form-group farris-form-group" *ngIf="field.dataType==dataType.Boolean">\r\n            <label class="col-form-label">\r\n              <span class="farris-label-text" title="{{field | billTrackerFieldLabel}}">\r\n                {{field | billTrackerFieldLabel}}\r\n              </span>\r\n            </label>\r\n            <div class="farris-input-wrap">\r\n              <div class="custom-control custom-checkbox">\r\n                <input class="custom-control-input" type="checkbox" readonly [checked]="field.fieldValue" />\r\n                <label class="custom-control-label"></label>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        \x3c!-- 有联查配置时，默认取第一个字段作为超链接 --\x3e\r\n        \x3c!-- <ng-template #linkTemp> --\x3e\r\n        \x3c!-- <div class="farris-group-wrap"> --\x3e\r\n        \x3c!-- 非布尔值链接在value上 --\x3e\r\n        \x3c!-- <div class="form-group farris-form-group" *ngIf="field.dataType!=dataType.Boolean">\r\n                            <label class="col-form-label">\r\n                                <span class="farris-label-text" title="{{field | billTrackerFieldLabel}}">\r\n                                    {{field | billTrackerFieldLabel}}\r\n                                </span>\r\n                            </label>\r\n                            <div class="farris-input-wrap">\r\n                                <div class="f-component-text">\r\n                                    <span class="f-form-control-text" title="{{field.fieldValue}}">\r\n                                        <a href="javascript:void(0);" (click)="clickLink()">{{field.fieldValue}}</a>\r\n                                    </span>\r\n                                </div>\r\n                            </div>\r\n                        </div> --\x3e\r\n\r\n        \x3c!-- 布尔值链接在label上 --\x3e\r\n        \x3c!-- <div class="form-group farris-form-group" *ngIf="field.dataType==dataType.Boolean">\r\n                            <label class="col-form-label">\r\n                                <span class="farris-label-text" title="{{field | billTrackerFieldLabel}}">\r\n                                    <a href="javascript:void(0);" (click)="clickLink()">\r\n                                        {{field | billTrackerFieldLabel}}\r\n                                    </a>\r\n                                </span>\r\n                            </label>\r\n                            <div class="farris-input-wrap">\r\n                                <div class="farris-input-wrap">\r\n                                    <div class="custom-control custom-checkbox">\r\n                                        <input class="custom-control-input" type="checkbox" readonly\r\n                                            [checked]="field.fieldValue" />\r\n                                        <label class="custom-control-label"></label>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        </div> --\x3e\r\n        \x3c!-- </div> --\x3e\r\n        \x3c!-- </ng-template> --\x3e\r\n      </div>\r\n    </ng-container>\r\n  </div>\r\n</farris-section>\r\n<lib-bill-tracker-child-info-list [childSchemaTables]="childSchemaTables" [childDataTableMap]="childDataTableMap"\r\n  [billInfo]="billInfo">\r\n</lib-bill-tracker-child-info-list>\r\n'}]}],e.ctorParameters=function(){return[{type:rtfCommon.FrameworkService},{type:BillTrackerDataInfoService},{type:uiNotify.NotifyService},{type:uiMessager.MessagerService},{type:uiLoading.LoadingService},{type:uiModal.BsModalService},{type:BillTrackerLocalePipe},{type:core$1.ViewContainerRef},{type:core$1.Injector},{type:core$1.ComponentFactoryResolver},{type:core$1.ChangeDetectorRef},{type:String,decorators:[{type:core$1.Optional},{type:core$1.Inject,args:[core$1.LOCALE_ID]}]}]},e.propDecorators={schemaTable:[{type:core$1.Input,args:["schemaTable"]}],dataTable:[{type:core$1.Input,args:["dataTable"]}],billInfo:[{type:core$1.Input,args:["billInfo"]}],billDataInfo:[{type:core$1.Input,args:["billDataInfo"]}]},e}(),BillTrackerDataComponent=function(){function e(e,t,r,o,n,i,a,l,s,c,p,u){this.notify=e,this.messager=t,this.loading=r,this.modal=o,this.dataService=n,this.inj=i,this.cfr=a,this.cdf=l,this.loader=s,this.dataInfoService=new BillTrackerDataInfoService,this.localeId=c||this.inj.get(core$1.LOCALE_ID,null)||"zh-CHS",this.localePipe=new BillTrackerLocalePipe(c),this.vcr=p||this.inj.get(core$1.ViewContainerRef,null),this.er=u||this.inj.get(core$1.ElementRef,null)}return e.prototype.ngOnInit=function(){},e.prototype.ngAfterViewInit=function(){},e.prototype.clearDataRegion=function(){this.dataRegion.clear()},e.prototype.showDataGrid=function(e,t,r,o){var n=new commonApi.BillTrackingSettings;t&&t.billTrackingSettings&&n.LoadFromJson(t.billTrackingSettings),n.billTrackingDataShownMode==commonApi.BillTrackingDataShownMode.CUSTOMFORM?this.showCustomForm(e,t,r):this.showGeneralForm(e,t,r,o)},e.prototype.showGeneralForm=function(e,t,r,o,n){var i,a=this;null!=o?this.createDataComp(o,t,r):(i=this.loading.show({message:this.localePipe.transform("loading")}),this.dataService.getEntityData(e).subscribe(function(e){a.createDataComp(e,t,r),i.close()},function(e){throw i.close(),a.messager.error(null!=e.error&&(e.error.Message||e.error.message)||e.message),e}))},e.prototype.showCustomForm=function(t,e,r){var o=this,n=new commonApi.BillTrackingSettings,e=(e&&e.billTrackingSettings&&n.LoadFromJson(e.billTrackingSettings),JSON.parse(n.customFormContent));(e.form.endsWith(".js")?rxjs.from(System["import"](e.form.toLowerCase()).then(function(e){return e})).pipe(operators.switchMap(function(e){for(var t in e)return rxjs.of(e[t]);return rxjs.of(null)})):rxjs.from(this.loader.load(e.form))).subscribe(function(e){e=e.create(o.inj).instance.createDataShownComponent(o.inj,t);(e=e instanceof core$1.ComponentRef?rxjs.of(e):e).subscribe(function(e){o.dataRegion.element.nativeElement.parentElement.scrollTo({left:0}),o.dataRegion.clear(),o.dataRegion.insert(e.hostView)})})},e.prototype.createDataComp=function(e,t,r){this.dataInfoService.isNewBTS(t.billTrackingSettings);try{this.createNewDataComp(e,t,r)}catch(o){r=this.dataRegion.element.nativeElement.parentElement,r=(r&&r.scrollTo({left:0}),this.dataRegion.clear(),this.cfr.resolveComponentFactory(BasicTableComponent)),r=this.dataRegion.createComponent(r);r.instance.billInfo=t,r.instance.isMain=!0,r.instance.showMainTable(e),this.dataRegion.insert(r.hostView)}},e.prototype.createNewDataComp=function(e,t,r){var o=this.dataRegion.element.nativeElement.parentElement,o=(o&&o.scrollTo({left:0}),this.dataRegion.clear(),this.cfr.resolveComponentFactory(BasicInfoComponent)),o=this.dataRegion.createComponent(o);o.instance.schemaTable=e.billSchema.mainTable,o.instance.dataTable=e.billData.mainTable,o.instance.billInfo=t,o.instance.billDataInfo=r,this.dataRegion.insert(o.hostView)},e.decorators=[{type:core$1.Component,args:[{selector:"lib-bill-tracker-data",template:'<div style="">\r\n    <ng-container #dataRegion></ng-container>\r\n</div>',styles:[""]}]}],e.ctorParameters=function(){return[{type:uiNotify.NotifyService},{type:uiMessager.MessagerService},{type:uiLoading.LoadingService},{type:uiModal.BsModalService},{type:BillTrackerDataService},{type:core$1.Injector},{type:core$1.ComponentFactoryResolver},{type:core$1.ChangeDetectorRef},{type:core$1.NgModuleFactoryLoader},{type:String,decorators:[{type:core$1.Inject,args:[core$1.LOCALE_ID]}]},{type:core$1.ViewContainerRef,decorators:[{type:core$1.Optional}]},{type:core$1.ElementRef,decorators:[{type:core$1.Optional}]}]},e.propDecorators={dataRegion:[{type:core$1.ViewChild,args:["dataRegion",{read:core$1.ViewContainerRef}]}]},e}(),ChildRowTableDirective=function(){function e(e,t,r){this.cfr=e,this.vcRef=t,this.cdr=r,this.hasChildren=new core$1.EventEmitter}return Object.defineProperty(e.prototype,"expanded",{get:function(){return this._expanded},set:function(e){(this._expanded=e)?this.showChildTable():this.clearChildTable()},enumerable:!0,configurable:!0}),e.prototype.showChildTable=function(){var e,t;if(null!=this.parentRow){this.clearChildTable();var r=this.cfr.resolveComponentFactory(BasicTableComponent);try{for(var o=__values(this.parentRow.GetChildTableList()),n=o.next();!n.done;n=o.next()){var i=n.value,a=this.vcRef.createComponent(r);a.instance.billInfo=this.billInfo,a.instance.isMain=!1,a.instance.showTable(this.parentSchemaTable.GetChildTableMap()[i.tableName],i),this.vcRef.insert(a.hostView)}}catch(l){e={error:l}}finally{try{n&&!n.done&&(t=o["return"])&&t.call(o)}finally{if(e)throw e.error}}this.cdr.markForCheck()}},e.prototype.clearChildTable=function(){this.vcRef.clear()},e.decorators=[{type:core$1.Directive,args:[{selector:"[appChildRowTable]"}]}],e.ctorParameters=function(){return[{type:core$1.ComponentFactoryResolver},{type:core$1.ViewContainerRef},{type:core$1.ChangeDetectorRef}]},e.propDecorators={billInfo:[{type:core$1.Input,args:["billInfo"]}],colspan:[{type:core$1.Input,args:["colspan"]}],parentRow:[{type:core$1.Input,args:["parentRow"]}],parentSchemaTable:[{type:core$1.Input,args:["parentSchemaTable"]}],parentDataTable:[{type:core$1.Input,args:["parentDataTable"]}],expanded:[{type:core$1.Input,args:["expanded"]}],hasChildren:[{type:core$1.Output,args:["hasChildren"]}]},e}(),ChildInfoListComponent=function(){function e(e,t,r,o,n,i,a,l,s,c){this.dataInfoService=e,this.notify=t,this.messager=r,this.loading=o,this.modal=n,this.localePipe=i,this.vcr=a,this.inj=l,this.cfr=s,this.cdr=c}return e.prototype.ngOnInit=function(){},e.decorators=[{type:core$1.Component,args:[{selector:"lib-bill-tracker-child-info-list",template:'<ng-container *ngFor="let childTable of childSchemaTables">\r\n    <lib-bill-tracker-child-info [schemaTable]="childTable" [dataTable]="childDataTableMap[childTable.tableName]"\r\n        [billInfo]="billInfo">\r\n    </lib-bill-tracker-child-info>\r\n</ng-container>'}]}],e.ctorParameters=function(){return[{type:BillTrackerDataInfoService},{type:uiNotify.NotifyService},{type:uiMessager.MessagerService},{type:uiLoading.LoadingService},{type:uiModal.BsModalService},{type:BillTrackerLocalePipe},{type:core$1.ViewContainerRef},{type:core$1.Injector},{type:core$1.ComponentFactoryResolver},{type:core$1.ChangeDetectorRef}]},e.propDecorators={childSchemaTables:[{type:core$1.Input,args:["childSchemaTables"]}],childDataTableMap:[{type:core$1.Input,args:["childDataTableMap"]}],billInfo:[{type:core$1.Input,args:["billInfo"]}]},e}(),ChildInfoComponent=function(){function e(e,t,r,o,n,i,a,l,s,c,p){this.notify=e,this.messager=t,this.loading=r,this.modal=o,this.dataInfoService=n,this.localePipe=i,this.vcr=a,this.inj=l,this.cfr=s,this.cdr=c,this.localeId=p,this.secTitle=null,this.showDetail=!1,this.dgCols=[],this.dgData=[],this.dgLineNumberTitle=this.localePipe.transform("lineNumber"),this.dgIdField="bifDgId0d63",this.localeId=p||this.inj.get(core$1.LOCALE_ID)}return e.prototype.ngOnInit=function(){var o=this,e=(this.secTitle=this.localePipe.transform("basicInfo"),this.secTitle=this.dataInfoService.getTableLabel(this.billInfo,this.schemaTable,this.localeId),new commonApi.BillTrackingSettings),t=(this.billInfo&&this.billInfo.billTrackingSettings&&e.LoadFromJson(this.billInfo.billTrackingSettings),e.customFieldContent),t=t&&("object"==typeof t?t:JSON.parse(t)),t=t&&t.schema&&t.schema[this.schemaTable.tableName]&&t.schema[this.schemaTable.tableName].fields||[],e=e.billTrackingDataShownMode===commonApi.BillTrackingDataShownMode.CUSTOMFIELD,r=this.schemaTable.getFieldList(),t=(t=this.dataInfoService.extractFFields(r,t,e)).filter(function(e){return e.show}),e=(t=this.dataInfoService.sortFieldsByOrder(t),this.dgCols=[],t.forEach(function(e){var t={field:e.fieldPath||e.fieldName,title:o.dataInfoService.getFieldLabel(e,o.localeId),width:120};e.dataType==commonApi$1.DataType.Boolean&&(t.formatter=function(e,t,r){return 1==e?o.localePipe.transform("yes"):0==e?o.localePipe.transform("no"):"-"}),e.dataType!=commonApi$1.DataType.Integer&&e.dataType!=commonApi$1.DataType.Decimal||(t.halign="right",t.align="right"),o.dgCols.push(t)}),this.dataTable?this.dataTable.GetRowList():[]);try{this.dgData=__spread(this.dataInfoService.extractDataRows(e,t,r,this.dgIdField))}catch(n){throw this.dgData=[],n==Exceptions.SCALE_FIELD_VALUE_IS_NAN&&this.messager.error(this.localePipe.transform("scaleFieldCantBeCastToInteger")),n}0<this.dgData.length&&setTimeout(function(){o.dg&&o.dg.selectRow(o.dgData[0][o.dgIdField])},500)},e.prototype.selectChanged=function(e){e=this.dataTable?this.dataTable.GetRowMap()[e.id]:null;this.showDetail=null!=e&&this.dataInfoService.hasChildData(e,this.billInfo),this.cdr.detectChanges()},e.prototype.viewChildData=function(){var e,t,r;null==this.dg.selectedRow?this.notify.warning(this.localePipe.transform("selectOneFirst")):null!=(e=this.dataTable?this.dataTable.GetRowMap()[this.dg.selectedRow.id]:null)&&this.dataInfoService.hasChildData(e,this.billInfo)?(t=this.cfr.resolveComponentFactory(ChildInfoListComponent).create(this.inj,[]),r=this.dataInfoService.getChildTables(this.billInfo,this.schemaTable),t.instance.childSchemaTables=r,t.instance.childDataTableMap=e.GetChildTableMap(),t.instance.billInfo=this.billInfo,r=this.modal.show(t,{title:this.localePipe.transform("childData"),width:900,height:600,showButtons:!1}),t.instance.bsModalRef=r):this.notify.info(this.localePipe.transform("noChildData"))},e.decorators=[{type:core$1.Component,args:[{selector:"lib-bill-tracker-child-info",template:'<div class="f-struct-wrapper" *ngIf="dgCols&&dgCols.length>0&&dgData&&dgData.length>0">\r\n    <farris-section class="f-section-tabs f-section-in-mainsubcard" [mainTitle]="secTitle">\r\n        <ng-template farrisSectionToolbar [toolbarCls]="\'section-test-toolbar\'">\r\n            <button class="btn btn-secondary f-btn-ml" *ngIf="showDetail" (click)="viewChildData()">\r\n                {{ "childData" | billTrackerLocale}}\r\n            </button>\r\n        </ng-template>\r\n        <div class="">\r\n            <div class="f-utils-fill">\r\n                <farris-datagrid #dg [data]="dgData" [idField]="dgIdField" [fields]="dgCols" [showLineNumber]="true"\r\n                    [striped]="true" [virtualized]="false" [pagination]="false" [virtualizedAsyncLoad]="false"\r\n                    [multiSelect]="false" [fit]="true" [showCheckbox]="false" [showAllCheckbox]="false"\r\n                    [lineNumberTitle]="dgLineNumberTitle" [mergeCell]="false" [showBorder]="true"\r\n                    [checkOnSelect]="false" [selectOnCheck]="false" [nowrap]="true" [autoFitColumns]="true"\r\n                    [fitColumns]="true" [autoHeight]="false" (selectChanged)="selectChanged($event)">\r\n                </farris-datagrid>\r\n            </div>\r\n        </div>\r\n    </farris-section>\r\n</div>'}]}],e.ctorParameters=function(){return[{type:uiNotify.NotifyService},{type:uiMessager.MessagerService},{type:uiLoading.LoadingService},{type:uiModal.BsModalService},{type:BillTrackerDataInfoService},{type:BillTrackerLocalePipe},{type:core$1.ViewContainerRef},{type:core$1.Injector},{type:core$1.ComponentFactoryResolver},{type:core$1.ChangeDetectorRef},{type:String,decorators:[{type:core$1.Optional},{type:core$1.Inject,args:[core$1.LOCALE_ID]}]}]},e.propDecorators={schemaTable:[{type:core$1.Input,args:["schemaTable"]}],dataTable:[{type:core$1.Input,args:["dataTable"]}],billInfo:[{type:core$1.Input,args:["billInfo"]}],dg:[{type:core$1.ViewChild,args:["dg"]}]},e}(),BillTrackerFieldLabelPipe=function(){function e(e,t){this.dataInfoService=e,this.localeId=t}return e.prototype.transform=function(e,t){return this.dataInfoService.getFieldLabel(e,t||this.localeId)},e.decorators=[{type:core$1.Pipe,args:[{name:"billTrackerFieldLabel"}]}],e.ctorParameters=function(){return[{type:BillTrackerDataInfoService},{type:String,decorators:[{type:core$1.Inject,args:[core$1.LOCALE_ID]}]}]},e}(),ɵ0$1=localStorage.getItem("languageCode")||"zh-CHS",ɵ1$1={},BillTrackerModule=function(){function t(){}return t.forRoot=function(e){return{ngModule:t,providers:[{provide:BillTrackerModuleConfig,useValue:e||{}}]}},t.decorators=[{type:core$1.NgModule,args:[{declarations:[BillTrackerComponent,BillTrackerGraphComponent,BillTrackerDataComponent,BasicTableComponent,ChildRowTableDirective,BillTrackerLocalePipe,BasicInfoComponent,ChildInfoComponent,ChildInfoListComponent,BillTrackerFieldLabelPipe],imports:[common.CommonModule,http.HttpClientModule,forms.FormsModule,uiDraggable.AngularDraggableModule,uiMessager.MessagerModule.forRoot(),uiLoading.LoadingModule.forRoot(),uiNotify.NotifyModule,uiText.TextModule,uiSection.FarrisSectionModule,uiDatagrid.DatagridModule.forRoot(),uiDialog.FarrisDialogModule],providers:[{provide:core$1.LOCALE_ID,useValue:ɵ0$1},{provide:BillTrackerModuleConfig,useValue:ɵ1$1},{provide:core$1.NgModuleFactoryLoader,useClass:core$1.SystemJsNgModuleLoader},cafCommon.CacheService,cafCommon.SessionService,cafCommon.HttpService,rtfCommon.FrmEventBus,rtfCommon.FuncsService,rtfCommon.LoadingService,rtfCommon.AppService,rtfCommon.FrameworkService,BillTrackerDataService,BillTrackerUiService,BillTrackerInternalUiService,BillTrackerLocalePipe,BillTrackerDataInfoService],bootstrap:[BillTrackerComponent],exports:[BillTrackerComponent,BillTrackerDataComponent],entryComponents:[BillTrackerComponent,BillTrackerDataComponent,BasicTableComponent,BasicInfoComponent,ChildInfoComponent,ChildInfoListComponent]}]}],t}(),BifBillTrackerWebCmpService=function(){function e(e,t,r,o,n,i,a,l){this.trackerUiService=e,this.bindingData=t,this.viewModel=r,this.frameContext=o,this.inj=n,this.cfr=i,this.localeId=a,this.messagerService=l,null==n&&(e=core$1.ReflectiveInjector.resolveAndCreate([],this.frameContext&&this.frameContext.injector),this.inj=e),this.cfr=i||this.inj.get(core$1.ComponentFactoryResolver),this.localeId=a||this.inj.get(core$1.LOCALE_ID,null)||"zh-CHS",this.messagerService=l||this.inj.get(uiMessager.MessagerService,null),this.localePipe=this.trackerUiService&&this.trackerUiService.localePipe||new BillTrackerLocalePipe(a)}return e.prototype.openDialog=function(e,t,r,o,n){if(null==e||""==e||e.trim&&""==e.trim())throw this.messagerService.error(this.localePipe.transform("trackerArgsCantBeEmpty")),"参数args不可为空";"string"==typeof e&&canJSONParse(e)&&(e=JSON.parse(e)),null!=(t=""===t||null==t?undefined:t)&&"boolean"!=typeof t&&(t="false"!=t&&("true"==t||undefined)),r=""===r||null==r?undefined:r,o=""===o||null==o?undefined:o,n=""===n||null==n?undefined:n;var i=new GetBillsInfoArgs;return"string"==typeof e?i.billDataId=e:i.LoadFromJsonObject(e),this.trackerUiService.openDefaultBillTrackerDialog(i,t,r,o,n)},e.prototype.openApp=function(e,t,r){if(null==e||""==e||e.trim&&""==e.trim())throw this.messagerService.error(this.localePipe.transform("trackerArgsCantBeEmpty")),"参数args不可为空";"string"==typeof e&&canJSONParse(e)&&(e=JSON.parse(e)),t=""===t||null==t?undefined:t,r=""===r||null==r?undefined:r;var o=new GetBillsInfoArgs;"string"==typeof e?o.billDataId=e:o.LoadFromJsonObject(e),this.trackerUiService.openDefaultBillTrackerApp(o,t,r)},e.decorators=[{type:core$1.Injectable}],e.ctorParameters=function(){return[{type:BillTrackerUiService},{type:devkit.BindingData,decorators:[{type:core$1.Optional}]},{type:devkit.ViewModel,decorators:[{type:core$1.Optional}]},{type:devkit.FrameContext,decorators:[{type:core$1.Optional}]},{type:core$1.Injector,decorators:[{type:core$1.Optional}]},{type:core$1.ComponentFactoryResolver,decorators:[{type:core$1.Optional}]},{type:String,decorators:[{type:core$1.Inject,args:[core$1.LOCALE_ID]}]},{type:uiMessager.MessagerService,decorators:[{type:core$1.Optional}]}]},e}(),EntityParamUtils=function(){function e(){}return e.buildSourceVoEntityData=function(e){var t=null,r=null,r=e.some(function(e){return"string"!=typeof e||canJSONParse(e)})?(t=null,e.map(function(e){var t;return e instanceof devkit.Entity?JSON.stringify(e.toJSON(!1,!0)):"BindingObject"==e.__type__?JSON.stringify(e.toJSON({useFullMultiLangProperty:!0})):null!=e.toJSON?(t=e,JSON.stringify(t.toJSON(!1,!0))):(t=e,JSON.stringify(t))})):(t=e,null);return{sourceVoEntityDataIds:t,sourceVoEntityDatas:r}},e}(),BifManualCreationDataWebCmpService=function(){function e(e,t,r,o,n){this.dataService=e,this.bindingData=t,this.messagerService=r,this.viewModel=o,this.frameContext=n,this.localePipe=new LocalePipe(this.dataService&&this.dataService.localeId||"zh-CHS")}return e.prototype.getSlimBillCreationProcessEntityExById=function(e){if(null==e||""==e||""==e.trim())throw this.messagerService.error(this.localePipe.transform("processIdCantBeEmpty")),"参数processId不可为空";return this.dataService.getSlimBillCreationProcessEntityExById(e)},e.prototype.getFormSettingsById=function(e){return this.dataService.getFormSettingsById(e)},e.prototype.executeBillCreationProcess=function(e,t,r,o,n){if(null==e||""==e)throw this.messagerService.error(this.localePipe.transform("entitiesCantBeEmpty")),"参数entities不可为空";e instanceof Map&&(e=Array.from(e.values())),e=Array.isArray(e)?e:[e],n=n||ManualCreationMode.Push;var e=EntityParamUtils.buildSourceVoEntityData(e),i=e.sourceVoEntityDatas,e=e.sourceVoEntityDataIds,a=new FormBillCreationProcessExecutorArgs;return a.billCreationProcessId=t,a.creationRuleId=r,a.sourceVoEntityDatas=i,a.sourceVoEntityDataIds=e,a.targetVoDataIds=o,a.manualCreationMode=n,this.dataService.executeBillCreationProcess(a)},e.prototype.createEntityDatas=function(e,t){var r=new runtimeApi.FormCreateArgs;return r.formVoId=e,r.rpcCreationRuleExecutorResult=t.creationRuleExecutorResult.ConvertToJson(),this.dataService.createEntityDatas(r)},e.prototype.updateEntityDatas=function(e){var t=new runtimeApi.FormUpdateArgs;return 1==e.conditionResult.conditionExecutionResult?e.creationRuleExecutorResult&&e.creationRuleExecutorResult.mappingResults&&0<e.creationRuleExecutorResult.mappingResults.length?(t.rpcCreationRuleExecutorResult=e.creationRuleExecutorResult.ConvertToJson(),this.dataService.updateEntityDatas(t)):rxjs.throwError("creationRuleExecutorResult is empty!"):rxjs.throwError("conditionExecutionResult is false!")},e.prototype.pushTaskCenter=function(e){var t=new PushTaskArgs;return 1==e.conditionResult.conditionExecutionResult?e.creationRuleExecutorResult&&e.creationRuleExecutorResult.mappingResults&&0<e.creationRuleExecutorResult.mappingResults.length?e.pushCreationMode==commonApi$1.PushCreationMode.TASKCENTER?(t.suCode=e.downBillSuCode,t.creationRuleExecutorResult=e.creationRuleExecutorResult,this.dataService.pushTaskCenter(t)):rxjs.throwError("creationRuleExecutorResult can't be pushed to task center!"):rxjs.throwError("creationRuleExecutorResult is empty!"):rxjs.throwError("conditionExecutionResult is false!")},e.prototype.getCreationResultById=function(e){return this.dataService.getCreationResultById(e)},e.prototype.addFormBillCreationProcessExecutorResult=function(e){if(null==e)throw this.messagerService.error(this.localePipe.transform("creationResultCantBeEmpty")),"参数creationResult不可为空";if("string"==typeof e){if(""==e)throw this.messagerService.error(this.localePipe.transform("creationResultCantBeEmpty")),"参数creationResult不可为空";var t=new runtimeApi.FormBillCreationProcessExecutorResult;t.LoadFromJson(e),e=t}return e instanceof runtimeApi.FormBillCreationProcessExecutorResult==0&&((t=new runtimeApi.FormBillCreationProcessExecutorResult).LoadFromJsonObject(e),e=t),this.dataService.addFormBillCreationProcessExecutorResult(e)},e.prototype.getEntityDatas=function(e,t,r){if(null==e)throw this.messagerService.error(this.localePipe.transform("dataIdCantBeEmpty")),"参数dataId不可为空";if(null==t)throw this.messagerService.error(this.localePipe.transform("voIdCantBeEmpty")),"参数voId不可为空";if(null==r)throw this.messagerService.error(this.localePipe.transform("suCodeCantBeEmpty")),"参数suCode不可为空";var o=new GetEntityDatasArgs;return o.dataId=e,o.suCode=r,o.voId=t,this.dataService.getEntityDatas(o)},e.decorators=[{type:core$1.Injectable}],e.ctorParameters=function(){return[{type:BifDataService},{type:devkit.BindingData},{type:uiMessager.MessagerService},{type:devkit.ViewModel,decorators:[{type:core$1.Optional}]},{type:devkit.FrameContext,decorators:[{type:core$1.Optional}]}]},e}(),BifManualCreationSourceWebCmpService=function(){function e(e,t,r,o,n,i){this.sourceUiService=e,this.dataService=t,this.bindingData=r,this.messagerService=o,this.viewModel=n,this.frameContext=i,this.localePipe=new LocalePipe(this.sourceUiService&&this.sourceUiService.localeId||"zh-CHS")}return e.prototype.pushBySourceVoId=function(e,t,o,r,n,i,a,l){var s=this;if(null==e||""==e||e.trim&&""==e.trim())throw this.messagerService.error(this.localePipe.transform("sourceVoIdCantBeEmpty")),"参数sourceVoId不可为空";if(null==t||""==t){try{t=this.frameContext.root.bindingData.getObject().id}catch(u){}if(null==t||""==t)throw this.messagerService.error(this.localePipe.transform("entitiesCantBeEmpty")),"参数entities不可为空"}t instanceof Map&&(t=Array.from(t.values())),t=Array.isArray(t)?t:[t],r=""===r||null==r?undefined:r,n=""===n||null==n?undefined:n,i=""===i||null==i?undefined:i,a=""===a||null==a?undefined:a,l=""===l||null==l?undefined:l;var t=EntityParamUtils.buildSourceVoEntityData(t),c=t.sourceVoEntityDatas,p=t.sourceVoEntityDataIds;this.sourceUiService.openBillCreationProcessSelector4Push(e,r,n,i,a).subscribe(function(t){s.dataService.getFormSettingsById(t.formSettingsId).subscribe(function(r){var e=new FormBillCreationProcessExecutorArgs;e.billCreationProcessId=t.id,e.creationRuleId=t.creationRuleId,e.sourceVoEntityDatas=c,e.sourceVoEntityDataIds=p,e.targetVoDataIds=[],e.manualCreationMode=ManualCreationMode.Push,s.dataService.executeBillCreationProcess(e).subscribe(function(t){var e;1==t.conditionResult.conditionExecutionResult?t.creationRuleExecutorResult&&t.creationRuleExecutorResult.mappingResults&&0<t.creationRuleExecutorResult.mappingResults.length?null==t.pushCreationMode||t.pushCreationMode==commonApi$1.PushCreationMode.CREATION?s.dataService.addFormBillCreationProcessExecutorResult(t).subscribe(function(e){s.sourceUiService.openTargetApp(r,t.conditionResult,e,__assign({action:o},l))},function(e){s.messagerService.error(null!=e.error&&(e.error.Message||e.error.message)||e.message)}):t.pushCreationMode==commonApi$1.PushCreationMode.TASKCENTER&&((e=new PushTaskArgs).suCode=t.downBillSuCode,e.creationRuleExecutorResult=t.creationRuleExecutorResult,s.dataService.pushTaskCenter(e).subscribe(function(){s.messagerService.success(s.localePipe.transform("pushTaskCenterSuccess"))},function(e){s.messagerService.error(null!=e.error&&(e.error.innerMessage||e.error.Message||e.error.message)||e.message||s.localePipe.transform("pushTaskCenterFailed"))})):s.messagerService.error(s.localePipe.transform("creationResultEmpty")):s.messagerService.error(t.conditionResult.message||s.localePipe.transform("creationExecutionError"))},function(e){s.messagerService.error(null!=e.error&&(e.error.Message||e.error.message)||e.message)})},function(e){s.messagerService.error(null!=e.error&&(e.error.Message||e.error.message)||e.message)})},function(e){s.messagerService.error(null!=e.error&&(e.error.Message||e.error.message)||e.message)})},e.prototype.pushBySourceVoIdAndTargetVoId=function(e,t,r,o,n,i,a,l,s){var c=this;if(null==e||""==e||e.trim&&""==e.trim())throw this.messagerService.error(this.localePipe.transform("sourceVoIdCantBeEmpty")),"参数sourceVoId不可为空";if(null==t||""==t||t.trim&&""==t.trim())throw this.messagerService.error(this.localePipe.transform("targetVoIdVoIdCantBeEmpty")),"参数targetVoId不可为空";if(null==r||""==r)throw this.messagerService.error(this.localePipe.transform("entitiesCantBeEmpty")),"参数entities不可为空";r instanceof Map&&(r=Array.from(r.values())),r=Array.isArray(r)?r:[r],n=""===n||null==n?undefined:n,i=""===i||null==i?undefined:i,a=""===a||null==a?undefined:a,l=""===l||null==l?undefined:l,s=""===s||null==s?undefined:s;var r=EntityParamUtils.buildSourceVoEntityData(r),p=r.sourceVoEntityDatas,u=r.sourceVoEntityDataIds;this.sourceUiService.openBillCreationProcessSelector4SpecificPush(e,t,n,i,a,l).subscribe(function(t){c.dataService.getFormSettingsById(t.formSettingsId).subscribe(function(r){var e=new FormBillCreationProcessExecutorArgs;e.billCreationProcessId=t.id,e.creationRuleId=t.creationRuleId,e.sourceVoEntityDatas=p,e.sourceVoEntityDataIds=u,e.targetVoDataIds=[],e.manualCreationMode=ManualCreationMode.SpecificPush,c.dataService.executeBillCreationProcess(e).subscribe(function(t){var e;1==t.conditionResult.conditionExecutionResult?t.creationRuleExecutorResult&&t.creationRuleExecutorResult.mappingResults&&0<t.creationRuleExecutorResult.mappingResults.length?null==t.pushCreationMode||t.pushCreationMode==commonApi$1.PushCreationMode.CREATION?c.dataService.addFormBillCreationProcessExecutorResult(t).subscribe(function(e){c.sourceUiService.openTargetApp(r,t.conditionResult,e,__assign({action:o},s))},function(e){c.messagerService.error(null!=e.error&&(e.error.Message||e.error.message)||e.message)}):t.pushCreationMode==commonApi$1.PushCreationMode.TASKCENTER&&((e=new PushTaskArgs).suCode=t.downBillSuCode,e.creationRuleExecutorResult=t.creationRuleExecutorResult,c.dataService.pushTaskCenter(e).subscribe(function(){c.messagerService.success(c.localePipe.transform("pushTaskCenterSuccess"))},function(e){c.messagerService.error(null!=e.error&&(e.error.innerMessage||e.error.Message||e.error.message)||e.message||c.localePipe.transform("pushTaskCenterFailed"))})):c.messagerService.error(c.localePipe.transform("creationResultEmpty")):c.messagerService.error(t.conditionResult.message||c.localePipe.transform("creationExecutionError"))},function(e){c.messagerService.error(null!=e.error&&(e.error.Message||e.error.message)||e.message)})},function(e){c.messagerService.error(null!=e.error&&(e.error.Message||e.error.message)||e.message)})},function(e){c.messagerService.error(null!=e.error&&(e.error.Message||e.error.message)||e.message)})},e.prototype.pushByCreationProcessId=function(e,t,o,n){var i=this;if(null==e||""==e||""==e.trim())throw this.messagerService.error(this.localePipe.transform("processIdCantBeEmpty")),"参数processId不可为空";if(null==t||""==t)throw this.messagerService.error(this.localePipe.transform("entitiesCantBeEmpty")),"参数entities不可为空";t instanceof Map&&(t=Array.from(t.values())),t=Array.isArray(t)?t:[t],n=""===n||null==n?undefined:n;var t=EntityParamUtils.buildSourceVoEntityData(t),a=t.sourceVoEntityDatas,l=t.sourceVoEntityDataIds;this.dataService.getSlimBillCreationProcessEntityExById(e).subscribe(function(t){i.dataService.getFormSettingsById(t.formSettingsId).subscribe(function(r){var e=new FormBillCreationProcessExecutorArgs;e.billCreationProcessId=t.id,e.creationRuleId=t.creationRuleId,e.sourceVoEntityDatas=a,e.sourceVoEntityDataIds=l,e.targetVoDataIds=[],e.manualCreationMode=ManualCreationMode.SpecificPush,i.dataService.executeBillCreationProcess(e).subscribe(function(t){var e;1==t.conditionResult.conditionExecutionResult?t.creationRuleExecutorResult&&t.creationRuleExecutorResult.mappingResults&&0<t.creationRuleExecutorResult.mappingResults.length?null==t.pushCreationMode||t.pushCreationMode==commonApi$1.PushCreationMode.CREATION?i.dataService.addFormBillCreationProcessExecutorResult(t).subscribe(function(e){i.sourceUiService.openTargetApp(r,t.conditionResult,e,__assign({action:o},n))},function(e){i.messagerService.error(null!=e.error&&(e.error.Message||e.error.message)||e.message)}):t.pushCreationMode==commonApi$1.PushCreationMode.TASKCENTER&&((e=new PushTaskArgs).suCode=t.downBillSuCode,e.creationRuleExecutorResult=t.creationRuleExecutorResult,i.dataService.pushTaskCenter(e).subscribe(function(){i.messagerService.success(i.localePipe.transform("pushTaskCenterSuccess"))},function(e){i.messagerService.error(null!=e.error&&(e.error.innerMessage||e.error.Message||e.error.message)||e.message||i.localePipe.transform("pushTaskCenterFailed"))})):i.messagerService.error(i.localePipe.transform("creationResultEmpty")):i.messagerService.error(t.conditionResult.message||i.localePipe.transform("creationExecutionError"))},function(e){i.messagerService.error(null!=e.error&&(e.error.Message||e.error.message)||e.message)})},function(e){i.messagerService.error(null!=e.error&&(e.error.Message||e.error.message)||e.message)})},function(e){i.messagerService.error(null!=e.error&&(e.error.Message||e.error.message)||e.message)})},e.prototype.openBillCreationProcessSelector4Push=function(e,t,r,o,n){if(null==e||""==e||e.trim&&""==e.trim())throw this.messagerService.error(this.localePipe.transform("sourceVoIdCantBeEmpty")),"参数sourceVoId不可为空";return t=""===t||null==t?undefined:t,r=""===r||null==r?undefined:r,o=""===o||null==o?undefined:o,n=""===n||null==n?undefined:n,this.sourceUiService.openBillCreationProcessSelector4Push(e,t,r,o,n)},e.prototype.openBillCreationProcessSelector4SpecificPush=function(e,t,r,o,n,i){if(null==e||""==e||e.trim&&""==e.trim())throw this.messagerService.error(this.localePipe.transform("sourceVoIdCantBeEmpty")),"参数sourceVoId不可为空";if(null==t||""==t||t.trim&&""==t.trim())throw this.messagerService.error(this.localePipe.transform("targetVoIdVoIdCantBeEmpty")),"参数targetVoId不可为空";return r=""===r||null==r?undefined:r,o=""===o||null==o?undefined:o,n=""===n||null==n?undefined:n,i=""===i||null==i?undefined:i,this.sourceUiService.openBillCreationProcessSelector4SpecificPush(e,t,r,o,n,i)},e.prototype.openTargetForm=function(e,t,r,o){this.sourceUiService.openTargetForm(e,t,__assign({action:r},o))},e.prototype.openTargetApp=function(e,t,r,o,n){this.sourceUiService.openTargetApp(e,t,r,__assign({action:o},n))},e.decorators=[{type:core$1.Injectable}],e.ctorParameters=function(){return[{type:BifSourceUiService},{type:BifDataService},{type:devkit.BindingData},{type:uiMessager.MessagerService},{type:devkit.ViewModel,decorators:[{type:core$1.Optional}]},{type:devkit.FrameContext,decorators:[{type:core$1.Optional}]}]},e}(),BifManualCreationTargetWebCmpService=function(){function e(e,t,r,o,n,i,a,l){this.dataService=e,this.targetUiService=t,this.stateMachineService=r,this.bindingData=o,this.messagerService=n,this.cardDataService=i,this.viewModel=a,this.frameContext=l,this.localePipe=new LocalePipe(this.targetUiService&&this.targetUiService.localeId||"zh-CHS")}return e.prototype.bifLoad=function(e){var t=this,r=new runtimeApi.FormCreateArgs;r.formVoId=e,this.targetUiService.getCreationResult().subscribe(function(e){r.rpcCreationRuleExecutorResult=e.creationRuleExecutorResult.ConvertToJson(),t.dataService.createEntityDatas(r).subscribe(function(e){t.stateMachineService.transit("Create")},function(e){t.messagerService.error(null!=e.error&&(e.error.Message||e.error.message)||e.message)})})},e.prototype.referByTargetVoId=function(e,o,t,r,n,i,a,l){var s=this;if(null==e||""==e||e.trim&&""==e.trim())throw this.messagerService.error(this.localePipe.transform("targetVoIdVoIdCantBeEmpty")),"参数targetVoId不可为空";t=""===t||null==t?undefined:t,o=""===o||null==o?[this.bindingData.getObject().id]:o,r=""===r||null==r?undefined:r,n=""===n||null==n?undefined:n,i=""===i||null==i?{title:this.localePipe.transform("selectUpstreamBill"),width:1100,height:550}:i,a=""===a||null==a?undefined:a,l=""===l||null==l?undefined:l,this.cardDataService.update().subscribe(function(){s.targetUiService.openBillCreationProcessSelector4Pull(e,t,r,n,a).subscribe(function(r){s.dataService.getFormSettingsById(r.formSettingsId).subscribe(function(e){s.targetUiService.openSourceDataSelector4Pull(e,i,l).subscribe(function(e){var t=new FormBillCreationProcessExecutorArgs;t.billCreationProcessId=r.id,t.creationRuleId=r.creationRuleId,t.sourceVoEntityDatas=null,t.sourceVoEntityDataIds=e.map(function(e){return e.id||e.primaryValue}),t.targetVoDataIds=o,t.manualCreationMode=ManualCreationMode.Pull,s.dataService.executeBillCreationProcess(t).subscribe(function(e){var t=new runtimeApi.FormUpdateArgs;1==e.conditionResult.conditionExecutionResult?e.creationRuleExecutorResult&&e.creationRuleExecutorResult.mappingResults&&0<e.creationRuleExecutorResult.mappingResults.length?(t.rpcCreationRuleExecutorResult=e.creationRuleExecutorResult.ConvertToJson(),s.dataService.updateEntityDatas(t).subscribe(function(e){s.cardDataService.load(o[0]).subscribe()},function(e){s.messagerService.error(null!=e.error&&(e.error.Message||e.error.message)||e.message)})):s.messagerService.error(s.localePipe.transform("creationResultEmpty")):s.messagerService.error(e.conditionResult.message||s.localePipe.transform("creationExecutionError"))},function(e){s.messagerService.error(null!=e.error&&(e.error.Message||e.error.message)||e.message)})},function(e){s.messagerService.error(null!=e.error&&(e.error.Message||e.error.message)||e.message)})},function(e){s.messagerService.error(null!=e.error&&(e.error.Message||e.error.message)||e.message)})},function(e){s.messagerService.error(null!=e.error&&(e.error.Message||e.error.message)||e.message)})},function(e){s.messagerService.error(null!=e.error&&(e.error.Message||e.error.message)||e.message)})},e.prototype.referBySourceVoIdAndTargetVoId=function(e,t,o,r,n,i,a,l,s){var c=this;if(null==e||""==e||e.trim&&""==e.trim())throw this.messagerService.error(this.localePipe.transform("sourceVoIdCantBeEmpty")),"参数sourceVoId不可为空";if(null==t||""==t||t.trim&&""==t.trim())throw this.messagerService.error(this.localePipe.transform("targetVoIdVoIdCantBeEmpty")),"参数targetVoId不可为空";r=""===r||null==r?undefined:r,o=""===o||null==o?[this.bindingData.getObject().id]:o,n=""===n||null==n?undefined:n,i=""===i||null==i?undefined:i,a=""===a||null==a?{title:this.localePipe.transform("selectUpstreamBill"),width:1100,height:550}:a,l=""===l||null==l?undefined:l,s=""===s||null==s?undefined:s,this.cardDataService.update().subscribe(function(){c.targetUiService.openBillCreationProcessSelector4SpecificPull(e,t,r,n,i,l).subscribe(function(r){c.dataService.getFormSettingsById(r.formSettingsId).subscribe(function(e){c.targetUiService.openSourceDataSelector4Pull(e,a,s).subscribe(function(e){var t=new FormBillCreationProcessExecutorArgs;t.billCreationProcessId=r.id,t.creationRuleId=r.creationRuleId,t.sourceVoEntityDatas=null,t.sourceVoEntityDataIds=e.map(function(e){return e.id||e.primaryValue}),t.targetVoDataIds=o,t.manualCreationMode=ManualCreationMode.SpecificPull,c.dataService.executeBillCreationProcess(t).subscribe(function(e){var t=new runtimeApi.FormUpdateArgs;1==e.conditionResult.conditionExecutionResult?e.creationRuleExecutorResult&&e.creationRuleExecutorResult.mappingResults&&0<e.creationRuleExecutorResult.mappingResults.length?(t.rpcCreationRuleExecutorResult=e.creationRuleExecutorResult.ConvertToJson(),c.dataService.updateEntityDatas(t).subscribe(function(e){c.cardDataService.load(o[0]).subscribe()},function(e){c.messagerService.error(null!=e.error&&(e.error.Message||e.error.message)||e.message)})):c.messagerService.error(c.localePipe.transform("creationResultEmpty")):c.messagerService.error(e.conditionResult.message||c.localePipe.transform("creationExecutionError"))},function(e){c.messagerService.error(null!=e.error&&(e.error.Message||e.error.message)||e.message)})},function(e){c.messagerService.error(null!=e.error&&(e.error.Message||e.error.message)||e.message)})},function(e){c.messagerService.error(null!=e.error&&(e.error.Message||e.error.message)||e.message)})},function(e){c.messagerService.error(null!=e.error&&(e.error.Message||e.error.message)||e.message)})},function(e){c.messagerService.error(null!=e.error&&(e.error.Message||e.error.message)||e.message)})},e.prototype.referByCreationProcessId=function(e,o,t,n){var i=this;if(null==e||""==e||""==e.trim())throw this.messagerService.error(this.localePipe.transform("processIdCantBeEmpty")),"参数processId不可为空";o=""===o||null==o?[this.bindingData.getObject().id]:o,t=""===t||null==t?{title:this.localePipe.transform("selectUpstreamBill"),width:1100,height:550}:t,n=""===n||null==n?undefined:n,this.cardDataService.update().subscribe(function(){i.dataService.getSlimBillCreationProcessEntityExById(e).subscribe(function(r){i.dataService.getFormSettingsById(r.formSettingsId).subscribe(function(e){i.targetUiService.openSourceDataSelector4Pull(e,t,n).subscribe(function(e){var t=new FormBillCreationProcessExecutorArgs;t.billCreationProcessId=r.id,t.creationRuleId=r.creationRuleId,t.sourceVoEntityDatas=null,t.sourceVoEntityDataIds=e.map(function(e){return e.id||e.primaryValue}),t.targetVoDataIds=o,t.manualCreationMode=ManualCreationMode.SpecificPull,i.dataService.executeBillCreationProcess(t).subscribe(function(e){var t=new runtimeApi.FormUpdateArgs;1==e.conditionResult.conditionExecutionResult?e.creationRuleExecutorResult&&e.creationRuleExecutorResult.mappingResults&&0<e.creationRuleExecutorResult.mappingResults.length?(t.rpcCreationRuleExecutorResult=e.creationRuleExecutorResult.ConvertToJson(),i.dataService.updateEntityDatas(t).subscribe(function(e){i.cardDataService.load(o[0]).subscribe()},function(e){i.messagerService.error(null!=e.error&&(e.error.Message||e.error.message)||e.message)})):i.messagerService.error(i.localePipe.transform("creationResultEmpty")):i.messagerService.error(e.conditionResult.message||i.localePipe.transform("creationExecutionError"))},function(e){i.messagerService.error(null!=e.error&&(e.error.Message||e.error.message)||e.message)})},function(e){i.messagerService.error(null!=e.error&&(e.error.Message||e.error.message)||e.message)})},function(e){i.messagerService.error(null!=e.error&&(e.error.Message||e.error.message)||e.message)})},function(e){i.messagerService.error(null!=e.error&&(e.error.Message||e.error.message)||e.message)})},function(e){i.messagerService.error(null!=e.error&&(e.error.Message||e.error.message)||e.message)})},e.prototype.getFormBillCreationProcessExecutorResult=function(){return this.targetUiService.getFormBillCreationProcessExecutorResult()},e.prototype.openBillCreationProcessSelector4Pull=function(e,t,r,o,n){if(null==e||""==e||e.trim&&""==e.trim())throw this.messagerService.error(this.localePipe.transform("targetVoIdVoIdCantBeEmpty")),"参数targetVoId不可为空";return t=""===t||null==t?undefined:t,r=""===r||null==r?undefined:r,o=""===o||null==o?undefined:o,n=""===n||null==n?undefined:n,this.targetUiService.openBillCreationProcessSelector4Pull(e,t,r,o,n)},e.prototype.openBillCreationProcessSelector4SpecificPull=function(e,t,r,o,n,i){if(null==e||""==e||e.trim&&""==e.trim())throw this.messagerService.error(this.localePipe.transform("sourceVoIdCantBeEmpty")),"参数sourceVoId不可为空";if(null==t||""==t||t.trim&&""==t.trim())throw this.messagerService.error(this.localePipe.transform("targetVoIdVoIdCantBeEmpty")),"参数targetVoId不可为空";return r=""===r||null==r?undefined:r,o=""===o||null==o?undefined:o,n=""===n||null==n?undefined:n,i=""===i||null==i?undefined:i,this.targetUiService.openBillCreationProcessSelector4SpecificPull(e,t,r,o,n,i)},e.prototype.openSourceDataSelector4Pull=function(e,t,r){return t=""===t||null==t?{title:this.localePipe.transform("selectUpstreamBill"),width:1100,height:550}:t,r=""===r||null==r?undefined:r,this.targetUiService.openSourceDataSelector4Pull(e,t,r)},e.prototype.getCreationResult=function(){return this.targetUiService.getCreationResult()},e.decorators=[{type:core$1.Injectable}],e.ctorParameters=function(){return[{type:BifDataService},{type:BifTargetUiService},{type:commandServices.StateMachineService},{type:devkit.BindingData},{type:uiMessager.MessagerService},{type:commandServices.CardDataService},{type:devkit.ViewModel,decorators:[{type:core$1.Optional}]},{type:devkit.FrameContext,decorators:[{type:core$1.Optional}]}]},e}(),BIF_MANUAL_CREATION_PROVIDERS=[BifDataService,BifSourceUiService,BifTargetUiService,{provide:AbstractBifDataSelectorService,useClass:DefaultBifDataSelectorService},BifManualCreationDataWebCmpService,BifManualCreationSourceWebCmpService,BifManualCreationTargetWebCmpService],BIF_BILL_TRACKER_PROVIDERS=[BillTrackerUiService,BifBillTrackerWebCmpService],BIF_DEVKIT_PROVIDERS=__spread(BIF_MANUAL_CREATION_PROVIDERS,BIF_BILL_TRACKER_PROVIDERS),BifBillTrackerWebCmpModule=function(){function e(){}return e.forRoot=function(){return{ngModule:e,providers:[]}},e.decorators=[{type:core$1.NgModule,args:[{providers:__spread(BIF_BILL_TRACKER_PROVIDERS)}]}],e}(),BifManualCreationWebCmpModule=function(){function e(){}return e.forRoot=function(){return{ngModule:e,providers:[]}},e.decorators=[{type:core$1.NgModule,args:[{providers:__spread(BIF_MANUAL_CREATION_PROVIDERS)}]}],e}();exports.FormBillCreationProcessExecutorResult=runtimeApi.FormBillCreationProcessExecutorResult,exports.FormCreationRuleExecutorArgs=runtimeApi.FormCreationRuleExecutorArgs,exports.FormCreateArgs=runtimeApi.FormCreateArgs,exports.FormCreateResult=runtimeApi.FormCreateResult,exports.FormUpdateArgs=runtimeApi.FormUpdateArgs,exports.FormUpdateResult=runtimeApi.FormUpdateResult,exports.RpcCreationRuleExecutorResult=runtimeApi.RpcCreationRuleExecutorResult,exports.RpcCreationMappingResult=runtimeApi.RpcCreationMappingResult,exports.MappingAssociation=runtimeApi.MappingAssociation,exports.RpcMappingResult=runtimeApi.RpcMappingResult,exports.BifDataService=BifDataService,exports.AbstractBifDataSelectorService=AbstractBifDataSelectorService,exports.DefaultBifDataSelectorService=DefaultBifDataSelectorService,exports.BifSourceUiService=BifSourceUiService,exports.BifTargetUiService=BifTargetUiService,exports.PushSelectorComponent=PushSelectorComponent,exports.PullSelectorComponent=PullSelectorComponent,exports.BifManualCreationModule=BifManualCreationModule,exports.BillTrackerArgs=BillTrackerArgs,exports.BillTrackerUiService=BillTrackerUiService,exports.BillTrackerComponent=BillTrackerComponent,exports.BillTrackerModule=BillTrackerModule,exports.BifBillTrackerWebCmpService=BifBillTrackerWebCmpService,exports.BifManualCreationDataWebCmpService=BifManualCreationDataWebCmpService,exports.BifManualCreationSourceWebCmpService=BifManualCreationSourceWebCmpService,exports.BifManualCreationTargetWebCmpService=BifManualCreationTargetWebCmpService,exports.BifBillTrackerWebCmpModule=BifBillTrackerWebCmpModule,exports.BifManualCreationWebCmpModule=BifManualCreationWebCmpModule,exports.mxDefaultKeyHandler=mxDefaultKeyHandlerType,exports.mxDefaultPopupMenu=mxDefaultPopupMenuType,exports.mxDefaultToolbar=mxDefaultToolbarType,exports.mxEditor=mxEditorType,exports.mxCellHighlight=mxCellHighlightType,exports.mxCellMarker=mxCellMarkerType,exports.mxCellTracker=mxCellTrackerType,exports.mxConnectionHandler=mxConnectionHandlerType,exports.mxConstraintHandler=mxConstraintHandlerType,exports.mxEdgeHandler=mxEdgeHandlerType,exports.mxEdgeSegmentHandler=mxEdgeSegmentHandlerType,exports.mxElbowEdgeHandler=mxElbowEdgeHandlerType,exports.mxGraphHandler=mxGraphHandlerType,exports.mxHandle=mxHandleType,exports.mxKeyHandler=mxKeyHandlerType,exports.mxPanningHandler=mxPanningHandlerType,exports.mxPopupMenuHandler=mxPopupMenuHandlerType,exports.mxRubberband=mxRubberbandType,exports.mxSelectionCellsHandler=mxSelectionCellsHandlerType,exports.mxTooltipHandler=mxTooltipHandlerType,exports.mxVertexHandler=mxVertexHandlerType,exports.mxCellCodec=mxCellCodecType,exports.mxChildChangeCodec=mxChildChangeCodecType,exports.mxDefaultKeyHandlerCodec=mxDefaultKeyHandlerCodecType,exports.mxDefaultPopupMenuCodec=mxDefaultPopupMenuCodecType,exports.mxDefaultToolbarCodec=mxDefaultToolbarCodecType,exports.mxEditorCodec=mxEditorCodecType,exports.mxGenericChangeCodec=mxGenericChangeCodecType,exports.mxGraphCodec=mxGraphCodecType,exports.mxGraphViewCodec=mxGraphViewCodecType,exports.mxModelCodec=mxModelCodecType,exports.mxObjectCodec=mxObjectCodecType,exports.mxRootChangeCodec=mxRootChangeCodecType,exports.mxStylesheetCodec=mxStylesheetCodecType,exports.mxTerminalChangeCodec=mxTerminalChangeCodecType,exports.mxCircleLayout=mxCircleLayoutType,exports.mxCompactTreeLayout=mxCompactTreeLayoutType,exports.mxCompositeLayout=mxCompositeLayoutType,exports.mxEdgeLabelLayout=mxEdgeLabelLayoutType,exports.mxFastOrganicLayout=mxFastOrganicLayoutType,exports.mxGraphLayout=mxGraphLayoutType,exports.mxParallelEdgeLayout=mxParallelEdgeLayoutType,exports.mxPartitionLayout=mxPartitionLayoutType,exports.mxRadialTreeLayout=mxRadialTreeLayoutType,exports.mxStackLayout=mxStackLayoutType,exports.mxHierarchicalLayout=mxHierarchicalLayoutType,exports.mxSwimlaneLayout=mxSwimlaneLayoutType,exports.mxGraphAbstractHierarchyCell=mxGraphAbstractHierarchyCellType,exports.mxGraphHierarchyEdge=mxGraphHierarchyEdgeType,exports.mxGraphHierarchyModel=mxGraphHierarchyModelType,exports.mxGraphHierarchyNode=mxGraphHierarchyNodeType,exports.mxSwimlaneModel=mxSwimlaneModelType,exports.mxCoordinateAssignment=mxCoordinateAssignmentType,exports.mxHierarchicalLayoutStage=mxHierarchicalLayoutStageType,exports.mxMedianHybridCrossingReduction=mxMedianHybridCrossingReductionType,exports.mxMinimumCycleRemover=mxMinimumCycleRemoverType,exports.mxSwimlaneOrdering=mxSwimlaneOrderingType,exports.mxCell=mxCellType,exports.mxCellPath=mxCellPathType,exports.mxGeometry=mxGeometryType,exports.mxGraphModel=mxGraphModelType,exports.renderingHint=renderingHintType,exports.mxActor=mxActorType,exports.mxArrow=mxArrowType,exports.mxArrowConnector=mxArrowConnectorType,exports.mxCloud=mxCloudType,exports.mxConnector=mxConnectorType,exports.mxCylinder=mxCylinderType,exports.mxDoubleEllipse=mxDoubleEllipseType,exports.mxEllipse=mxEllipseType,exports.mxHexagon=mxHexagonType,exports.mxImageShape=mxImageShapeType,exports.mxLabel=mxLabelType,exports.mxLine=mxLineType,exports.mxMarker=mxMarkerType,exports.mxPolyline=mxPolylineType,exports.mxRectangleShape=mxRectangleShapeType,exports.mxRhombus=mxRhombusType,exports.mxShape=mxShapeType,exports.mxStencil=mxStencilType,exports.mxStencilRegistry=mxStencilRegistryType,exports.mxSwimlane=mxSwimlaneType,exports.mxText=mxTextType,exports.mxTriangle=mxTriangleType,exports.mxAbstractCanvas2D=mxAbstractCanvas2DType,exports.mxAnimation=mxAnimationType,exports.mxAutoSaveManager=mxAutoSaveManagerType,exports.mxClipboard=mxClipboardType,exports.mxConstants=mxConstantsType,exports.mxDictionary=mxDictionaryType,exports.mxDivResizer=mxDivResizerType,exports.mxDragSource=mxDragSourceType,exports.mxEffects=mxEffectsType,exports.mxEvent=mxEventType,exports.mxEventObject=mxEventObjectType,exports.mxEventSource=mxEventSourceType,exports.mxForm=mxFormType,exports.mxGuide=mxGuideType,exports.mxImage=mxImageType,exports.mxImageBundle=mxImageBundleType,exports.mxImageExport=mxImageExportType,exports.mxLog=mxLogType,exports.mxMorphing=mxMorphingType,exports.mxMouseEvent=mxMouseEventType,exports.mxObjectIdentity=mxObjectIdentityType,exports.mxPanningManager=mxPanningManagerType,exports.mxPoint=mxPointType,exports.mxPopupMenu=mxPopupMenuType,exports.mxRectangle=mxRectangleType,exports.mxResources=mxResourcesType,exports.mxSvgCanvas2D=mxSvgCanvas2DType,exports.mxToolbar=mxToolbarType,exports.mxUndoableEdit=mxUndoableEditType,exports.mxUndoManager=mxUndoManagerType,exports.mxUrlConverter=mxUrlConverterType,exports.mxUtils=mxUtilsType,exports.mxVmlCanvas2D=mxVmlCanvas2DType,exports.mxWindow=mxWindowType,exports.mxXmlCanvas2D=mxXmlCanvas2DType,exports.mxXmlRequest=mxXmlRequestType,exports.mxCellEditor=mxCellEditorType,exports.mxCellOverlay=mxCellOverlayType,exports.mxCellRenderer=mxCellRendererType,exports.mxCellState=mxCellStateType,exports.mxCellStatePreview=mxCellStatePreviewType,exports.mxConnectionConstraint=mxConnectionConstraintType,exports.mxEdgeStyle=mxEdgeStyleType,exports.mxGraph=mxGraphType,exports.mxGraphSelectionModel=mxGraphSelectionModelType,exports.mxGraphView=mxGraphViewType,exports.mxLayoutManager=mxLayoutManagerType,exports.mxMultiplicity=mxMultiplicityType,exports.mxOutline=mxOutlineType,exports.mxPerimeter=mxPerimeterType,exports.mxPrintPreview=mxPrintPreviewType,exports.mxStyleRegistry=mxStyleRegistryType,exports.mxStylesheet=mxStylesheetType,exports.mxSwimlaneManager=mxSwimlaneManagerType,exports.mxTemporaryCellStates=mxTemporaryCellStatesType,exports.mxClient=mxClientType,exports.mxgraph=mxgraph,exports.BillData=BillData,exports.FormBillCreationProcessExecutorArgs=FormBillCreationProcessExecutorArgs,exports.FormGetBillCreationProcessEntityExArgs=FormGetBillCreationProcessEntityExArgs,exports.FormGetBillCreationProcessEntityExResult=FormGetBillCreationProcessEntityExResult,exports.ManualCreationMode=ManualCreationMode,exports.GeneralTextIdWithDataId=GeneralTextIdWithDataId,exports.BillDataInfo=BillDataInfo,exports.BillInfo=BillInfo,exports.CanTrackingInfo=CanTrackingInfo,exports.DownBillInfo=DownBillInfo,exports.GetBillsInfoArgs=GetBillsInfoArgs,exports.GetDownBillsInfoArgs=GetDownBillsInfoArgs,exports.GetUpBillsInfoArgs=GetUpBillsInfoArgs,exports.TrackingHelper=TrackingHelper,exports.TrackingMappingAssociation=TrackingMappingAssociation,exports.UpBillInfo=UpBillInfo,exports.BillChildInfo=BillChildInfo,exports.BillDetailInfo=BillDetailInfo,exports.BillItemInfo=BillItemInfo,exports.FieldsWithOrder=FieldsWithOrder,exports.SummaryFieldsInfo=SummaryFieldsInfo,exports.FieldNameAndValue=FieldNameAndValue,exports.DateTypeFormatInfo=DateTypeFormatInfo,exports.DecimalTypeFormatInfo=DecimalTypeFormatInfo,exports.TypeToFormat=TypeToFormat$1,exports.ScaleMode=ScaleMode,exports.ExpressionJointQueryParameterContent=ExpressionJointQueryParameterContent,exports.FieldJointQueryParameterContent=FieldJointQueryParameterContent,exports.JointQueryParameterContent=JointQueryParameterContent,exports.JointQueryParameterMode=JointQueryParameterMode,exports.JointQueryParameterResult=JointQueryParameterResult,exports.JointQueryParametersContent=JointQueryParametersContent,exports.SimpleValueMappingInfo=SimpleValueMappingInfo,exports.StringDisplayMode=StringDisplayMode,exports.StringTypeFormatInfo=StringTypeFormatInfo,exports.Exceptions=Exceptions,exports.BIF_UISTATE_KEY_CREATION_RESULT=BIF_UISTATE_KEY_CREATION_RESULT,exports.BIF_UISTATE_KEY_OPEN_TYPE=BIF_UISTATE_KEY_OPEN_TYPE,exports.ModuleConfig=ModuleConfig,exports.SELECTOR_ARGS_INJECTOR=SELECTOR_ARGS_INJECTOR,exports.DEFAULT_SELECTOR_ARGS=DEFAULT_SELECTOR_ARGS,exports.PushTaskArgs=PushTaskArgs,exports.GetEntityDatasArgs=GetEntityDatasArgs,exports.CanTrackingResult=CanTrackingResult,exports.GetChildrenEntityDataArgs=GetChildrenEntityDataArgs,exports.DownBillInfoResult=DownBillInfoResult,exports.EntityDataResult=EntityDataResult,exports.GetEntityDataArgs=GetEntityDataArgs,exports.GetMainEntityDataArgs=GetMainEntityDataArgs,exports.UpBillInfoResult=UpBillInfoResult,exports.GetJointQueryParametersArgs=GetJointQueryParametersArgs,exports.BillTrackerConstant=BillTrackerConstant,exports.BillTrackerModuleConfig=BillTrackerModuleConfig,exports.BillTrackerDirection=BillTrackerDirection,exports.BillTrackerGraphOptions=BillTrackerGraphOptions,exports.BillTrackerGridOptions=BillTrackerGridOptions,exports.Graph=Graph,exports.GraphView=GraphView,exports.BillNodeShape=BillNodeShape,exports.BillAssociationLine=BillAssociationLine,exports.CompactTreeLayout=CompactTreeLayout,exports.RevertCompactTreeLayout=RevertCompactTreeLayout,exports.VertexHandler=VertexHandler,exports.Events=Events,exports.BillCell=BillCell,exports.CellOverlay=CellOverlay,exports.CellOverlayState=CellOverlayState,exports.Outline=Outline,exports.Styles=Styles,exports.BIF_MANUAL_CREATION_PROVIDERS=BIF_MANUAL_CREATION_PROVIDERS,exports.BIF_BILL_TRACKER_PROVIDERS=BIF_BILL_TRACKER_PROVIDERS,exports.BIF_DEVKIT_PROVIDERS=BIF_DEVKIT_PROVIDERS,exports.ɵe=ModuleConfig,exports.ɵd=SELECTOR_ARGS_INJECTOR,exports.ɵa=LocalePipe,exports.ɵb=AbstractUiService,exports.ɵl=BasicInfoComponent,exports.ɵi=BasicTableComponent,exports.ɵj=ChildRowTableDirective,exports.ɵh=BillTrackerDataComponent,exports.ɵg=BillTrackerGraphComponent,exports.ɵo=ChildInfoListComponent,exports.ɵn=ChildInfoComponent,exports.ɵq=BillTrackerModuleConfig,exports.ɵp=BillTrackerFieldLabelPipe,exports.ɵk=BillTrackerLocalePipe,exports.ɵm=BillTrackerDataInfoService,exports.ɵf=BillTrackerDataService,exports.ɵr=BillTrackerInternalUiService,Object.defineProperty(exports,"__esModule",{value:!0})});
//# sourceMappingURL=edp-bif-runtime-api.umd.min.js.map