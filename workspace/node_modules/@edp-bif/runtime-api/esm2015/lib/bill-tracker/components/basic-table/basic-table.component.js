/**
 * @fileoverview added by tsickle
 * Generated from: lib/bill-tracker/components/basic-table/basic-table.component.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, ViewContainerRef, Injector, ComponentFactoryResolver, ViewChild, TemplateRef, ChangeDetectionStrategy, ChangeDetectorRef } from "@angular/core";
import { DataType, BpmnModelJsonHelper } from '@edp-aif/common-api';
import { BillTrackingSettings, BillTrackingDataShownMode } from "@edp-bif/common-api";
import { BillFrontField } from './BillFrontField';
import { BillFrontDataRow } from './BillFrontDataRow';
export class BasicTableComponent {
    /**
     * @param {?} viewContainerRef
     * @param {?} inj
     * @param {?} cfr
     * @param {?} cdr
     */
    constructor(viewContainerRef, inj, cfr, cdr) {
        this.viewContainerRef = viewContainerRef;
        this.inj = inj;
        this.cfr = cfr;
        this.cdr = cdr;
    }
    /**
     * @return {?}
     */
    ngOnInit() {
    }
    /**
     * @param {?} item
     * @param {?} evt
     * @return {?}
     */
    clickHandler(item, evt) {
        item['expanded'] = !item['expanded'];
    }
    /**
     * @param {?} res
     * @return {?}
     */
    showMainTable(res) {
        this.showTable(res.billSchema.mainTable, res.billData.mainTable);
    }
    /**
     * @param {?} schemaTable
     * @param {?} dataTable
     * @return {?}
     */
    showTable(schemaTable, dataTable) {
        this.billSchemaTable = schemaTable;
        this.billDataTable = dataTable;
        this.loadData(schemaTable.getFieldList(), dataTable.GetRowList());
        this.cdr.detectChanges();
    }
    /**
     * @param {?} billSchemaFields
     * @param {?} billDataRows
     * @return {?}
     */
    loadData(billSchemaFields, billDataRows) {
        this.fields = billSchemaFields;
        this.rows = billDataRows;
        /** @type {?} */
        let bts = new BillTrackingSettings();
        if (this.billInfo && this.billInfo.billTrackingSettings) {
            bts.LoadFromJson(this.billInfo.billTrackingSettings);
        }
        if (bts.billTrackingDataShownMode == BillTrackingDataShownMode.CUSTOMFIELD) {
            this.ffields = this.extractFFieldsWithCustomFields(billSchemaFields, bts.customFieldContent);
            this.frows = this.extractFRows(billDataRows, this.ffields);
        }
        else {
            this.ffields = this.extractFFields(billSchemaFields);
            this.frows = this.extractFRows(billDataRows, this.ffields);
        }
    }
    /**
     * 默认展示方式
     * @private
     * @param {?} fields
     * @return {?}
     */
    extractFFields(fields) {
        /** @type {?} */
        let ffields = [];
        for (let field of fields) {
            //枚举或者枚举型单值UDT时默认取Name
            if (field.fieldType == "Enum" || field.fieldType == "EnumSingleUdt") {
                /** @type {?} */
                let ff = new BillFrontField();
                ff.fieldName = field.fieldName;
                ff.dataType = field.dataType;
                ff.caption = field.caption;
                ff.fieldType = field.fieldType;
                ff.length = field.length;
                ff.precision = field.precision;
                ff.scale = field.scale;
                ff.captionPath = this.extractCaptionPath(field);
                ff.fieldPath = this.extractFieldPath(field) + ".Name";
                ffields.push(ff);
            }
            else if (field.GetSubFieldList() != null && field.GetSubFieldList().length > 0) {
                ffields.push(...this.extractFSubFields(field.GetSubFieldList()));
            }
            else {
                /** @type {?} */
                let ff = new BillFrontField();
                ff.fieldName = field.fieldName;
                ff.dataType = field.dataType;
                ff.caption = field.caption;
                ff.fieldType = field.fieldType;
                ff.length = field.length;
                ff.precision = field.precision;
                ff.scale = field.scale;
                ff.captionPath = this.extractCaptionPath(field);
                ff.fieldPath = this.extractFieldPath(field);
                ffields.push(ff);
            }
        }
        return ffields;
    }
    /**
     * @private
     * @param {?} fields
     * @param {?=} parentField
     * @return {?}
     */
    extractFSubFields(fields, parentField) {
        /** @type {?} */
        let ffields = [];
        for (let field of fields) {
            //枚举或者枚举型单值UDT时默认取Name
            if (field.fieldType == "Enum" || field.fieldType == "EnumSingleUdt") {
                /** @type {?} */
                let ff = new BillFrontField();
                ff.fieldName = field.fieldName;
                ff.dataType = field.dataType;
                ff.caption = field.caption;
                ff.fieldType = field.fieldType;
                ff.length = field.length;
                ff.precision = field.precision;
                ff.scale = field.scale;
                ff.captionPath = this.extractCaptionPath(field);
                ff.fieldPath = this.extractFieldPath(field) + ".Name";
                ffields.push(ff);
            }
            else if (field.GetSubFieldList() != null && field.GetSubFieldList().length > 0) {
                ffields.push(...this.extractFSubFields(field.GetSubFieldList()));
            }
            else {
                /** @type {?} */
                let ff = new BillFrontField();
                ff.fieldName = field.fieldName;
                ff.dataType = field.dataType;
                ff.caption = field.caption;
                ff.fieldType = field.fieldType;
                ff.length = field.length;
                ff.precision = field.precision;
                ff.scale = field.scale;
                ff.captionPath = this.extractCaptionPath(field);
                ff.fieldPath = this.extractFieldPath(field);
                ffields.push(ff);
            }
        }
        return ffields;
    }
    /**
     * 自定义字段展示方式
     * @private
     * @param {?} fields
     * @param {?} fieldContent
     * @return {?}
     */
    extractFFieldsWithCustomFields(fields, fieldContent) {
        // 表code
        /** @type {?} */
        const tableCode = this.billSchemaTable.tableName;
        // 单据追踪配置
        /** @type {?} */
        let bts = new BillTrackingSettings();
        if (this.billInfo && this.billInfo.billTrackingSettings) {
            bts.LoadFromJson(this.billInfo.billTrackingSettings);
        }
        /** @type {?} */
        let fieldConfig = typeof fieldContent == "object" ? fieldContent : JSON.parse(fieldContent);
        /** @type {?} */
        let ffields = [];
        for (let field of fields) {
            // 字段ID
            /** @type {?} */
            const fieldPath = this.extractFieldPath(field);
            /** @type {?} */
            let sf = null;
            for (let k in fieldConfig.schema) {
                if (k == 'selectedAll') {
                    continue;
                }
                if (k == tableCode) {
                    /** @type {?} */
                    const s = fieldConfig.schema[k];
                    sf = s && s.fields.find((/**
                     * @param {?} elt
                     * @return {?}
                     */
                    (elt) => elt.fieldPath == fieldPath));
                    break;
                }
            }
            if (sf == null) {
                continue;
            }
            //枚举或者枚举型单值UDT时默认取Name
            if (field.fieldType == "Enum" || field.fieldType == "EnumSingleUdt") {
                /** @type {?} */
                let ff = new BillFrontField();
                ff.fieldName = field.fieldName;
                ff.dataType = field.dataType;
                ff.caption = field.caption;
                ff.fieldType = field.fieldType;
                ff.length = field.length;
                ff.precision = field.precision;
                ff.scale = field.scale;
                ff.captionPath = sf.displayName || field.caption;
                ff.fieldPath = this.extractFieldPath(field) + ".Name";
                ffields.push(ff);
            }
            else if (field.GetSubFieldList() != null && field.GetSubFieldList().length > 0) {
                ffields.push(...this.extractFSubFieldsWithCustomFields(field.GetSubFieldList(), fieldContent, field));
            }
            else {
                /** @type {?} */
                let ff = new BillFrontField();
                ff.fieldName = field.fieldName;
                ff.dataType = field.dataType;
                ff.caption = field.caption;
                ff.fieldType = field.fieldType;
                ff.length = field.length;
                ff.precision = field.precision;
                ff.scale = field.scale;
                ff.captionPath = sf.displayName || field.caption;
                ff.fieldPath = this.extractFieldPath(field);
                ffields.push(ff);
            }
        }
        return ffields;
    }
    /**
     * @private
     * @param {?} fields
     * @param {?} fieldContent
     * @param {?=} parentField
     * @return {?}
     */
    extractFSubFieldsWithCustomFields(fields, fieldContent, parentField) {
        // 表编号
        /** @type {?} */
        const tableCode = this.billSchemaTable.tableName;
        // 单据追踪配置
        /** @type {?} */
        let bts = new BillTrackingSettings();
        if (this.billInfo && this.billInfo.billTrackingSettings) {
            bts.LoadFromJson(this.billInfo.billTrackingSettings);
        }
        /** @type {?} */
        let fieldConfig = typeof fieldContent == "object" ? fieldContent : JSON.parse(fieldContent);
        /** @type {?} */
        let ffields = [];
        for (let field of fields) {
            // 字段ID
            /** @type {?} */
            const fieldPath = this.extractFieldPath(field);
            /** @type {?} */
            let sf = null;
            for (let k in fieldConfig.schema) {
                if (k == 'selectedAll') {
                    continue;
                }
                if (k == tableCode) {
                    /** @type {?} */
                    const s = fieldConfig.schema[k];
                    sf = s && s.fields.find((/**
                     * @param {?} elt
                     * @return {?}
                     */
                    (elt) => elt.fieldPath == fieldPath));
                    break;
                }
            }
            if (sf == null) {
                continue;
            }
            //枚举或者枚举型单值UDT时默认取Name
            if (field.fieldType == "Enum" || field.fieldType == "EnumSingleUdt") {
                /** @type {?} */
                let ff = new BillFrontField();
                ff.fieldName = field.fieldName;
                ff.dataType = field.dataType;
                ff.caption = field.caption;
                ff.fieldType = field.fieldType;
                ff.length = field.length;
                ff.precision = field.precision;
                ff.scale = field.scale;
                ff.captionPath = sf.displayName || field.caption;
                ff.fieldPath = this.extractFieldPath(field) + ".Name";
                ffields.push(ff);
            }
            else if (field.GetSubFieldList() != null && field.GetSubFieldList().length > 0) {
                ffields.push(...this.extractFSubFieldsWithCustomFields(field.GetSubFieldList(), fieldContent, field));
            }
            else {
                /** @type {?} */
                let ff = new BillFrontField();
                ff.fieldName = field.fieldName;
                ff.dataType = field.dataType;
                ff.caption = field.caption;
                ff.fieldType = field.fieldType;
                ff.length = field.length;
                ff.precision = field.precision;
                ff.scale = field.scale;
                ff.captionPath = sf.displayName || field.caption;
                ff.fieldPath = this.extractFieldPath(field);
                ffields.push(ff);
            }
        }
        return ffields;
    }
    /**
     * @private
     * @param {?} field
     * @return {?}
     */
    extractCaptionPath(field) {
        /** @type {?} */
        let s = field.caption;
        /** @type {?} */
        let tmp = (/** @type {?} */ (field));
        while (tmp.attachedField != null) {
            s = tmp.attachedField.caption + "." + s;
            tmp = (/** @type {?} */ (tmp.attachedField));
        }
        return s;
    }
    /**
     * @private
     * @param {?} field
     * @return {?}
     */
    extractFieldPath(field) {
        /** @type {?} */
        let s = field.fieldName;
        /** @type {?} */
        let tmp = (/** @type {?} */ (field));
        while (tmp.attachedField != null) {
            s = tmp.attachedField.fieldName + "." + s;
            tmp = (/** @type {?} */ (tmp.attachedField));
        }
        return s;
    }
    /**
     * @private
     * @param {?} rows
     * @param {?} ffields
     * @return {?}
     */
    extractFRows(rows, ffields) {
        /** @type {?} */
        let frows = [];
        for (let row of rows) {
            /** @type {?} */
            let fr = new BillFrontDataRow();
            fr.expanded = row.GetChildTableList().length == 0 ? null : row.attachedTable && row.attachedTable.attachedRow == null ? true : false;
            fr.hasChildren = this.hasChildren(row);
            fr.data = {};
            for (let ff of ffields) {
                fr.data[ff.fieldPath] = this.extractFieldPathValue(row.GetFieldMap(), ff.fieldPath);
            }
            frows.push(fr);
        }
        return frows;
    }
    /**
     * @param {?} row
     * @return {?}
     */
    hasChildren(row) {
        /** @type {?} */
        let flag = row.GetChildTableList() && row.GetChildTableList().length > 0;
        if (flag) {
            /** @type {?} */
            let cf = false;
            for (let ct of row.GetChildTableList()) {
                if (ct.GetRowList() && ct.GetRowList().length > 0) {
                    cf = true;
                    break;
                }
            }
            flag = cf;
        }
        return flag;
    }
    /**
     * @param {?} billDataFieldMap
     * @param {?} fieldPath
     * @return {?}
     */
    extractFieldPathValue(billDataFieldMap, fieldPath) {
        /** @type {?} */
        let fields = fieldPath.split(".");
        /** @type {?} */
        let bdf = billDataFieldMap[fields[0]];
        for (let i = 1; bdf != null && i < fields.length; i++) {
            /** @type {?} */
            const temp = bdf.GetSubFieldMap();
            if (temp == null) {
                break;
            }
            bdf = temp[fields[i]];
        }
        return bdf ? bdf.GetTextValue() : "";
    }
    /**
     * @param {?} obj
     * @param {?} ffield
     * @return {?}
     */
    getShownText(obj, ffield) {
        if (obj[ffield.fieldPath] == null) {
            return "";
        }
        if (ffield.dataType == DataType.String) {
            return obj[ffield.fieldPath] || "";
        }
        else if (ffield.dataType == DataType.Decimal) {
            /** @type {?} */
            let dec = parseFloat(String(obj[ffield.fieldPath])).toFixed(ffield.scale).toString();
            return dec || "";
        }
        else if (ffield.dataType == DataType.DateTime) {
            /** @type {?} */
            let date = BpmnModelJsonHelper.DateTimeFromString(obj[ffield.fieldPath]);
            if (ffield.fieldType == "DateTime") {
                return this.dateFormat(date, "yyyy-MM-dd HH:mm:ss.SSS");
            }
            else if (ffield.fieldType == "Date") {
                return this.dateFormat(date, "yyyy-MM-dd");
            }
            else {
                return this.dateFormat(date, "yyyy-MM-dd");
            }
        }
        else {
            return obj[ffield.fieldPath] || "";
        }
    }
    /**
     * @param {?} obj
     * @return {?}
     */
    isObject(obj) {
        return typeof (obj) == "object";
    }
    /**
     * @param {?} obj
     * @return {?}
     */
    isArray(obj) {
        return Array.isArray(obj);
    }
    /**
     * @private
     * @param {?} date
     * @param {?} fmt
     * @return {?}
     */
    dateFormat(date, fmt) {
        /** @type {?} */
        let ret;
        /** @type {?} */
        const opt = {
            "y+": date.getUTCFullYear().toString(),
            // 年
            "M+": (date.getUTCMonth() + 1).toString(),
            // 月
            "d+": date.getUTCDate().toString(),
            // 日
            "H+": date.getUTCHours().toString(),
            // 时
            "m+": date.getUTCMinutes().toString(),
            // 分
            "s+": date.getUTCSeconds().toString(),
            // 秒
            "S+": date.getUTCMilliseconds().toString(),
        };
        for (let k in opt) {
            ret = new RegExp("(" + k + ")").exec(fmt);
            if (ret) {
                if (!String.prototype.padStart) {
                    fmt = fmt.replace(ret[1], (ret[1].length == 1) ? (opt[k]) : (this.myPadStart(opt[k], ret[1].length, "0")));
                }
                else {
                    fmt = fmt.replace(ret[1], (ret[1].length == 1) ? (opt[k]) : (opt[k].padStart(ret[1].length, "0")));
                }
            }
        }
        return fmt;
    }
    /**
     * @private
     * @param {?} src
     * @param {?} targetLength
     * @param {?} padString
     * @return {?}
     */
    myPadStart(src, targetLength, padString) {
        targetLength = targetLength >> 0; //floor if number or convert non-number to 0;
        padString = String(typeof padString !== 'undefined' ? padString : ' ');
        if (src.length > targetLength) {
            return String(src);
        }
        else {
            targetLength = targetLength - src.length;
            if (targetLength > padString.length) {
                padString += padString.repeat(targetLength / padString.length); //append to original to ensure we are longer than needed
            }
            return padString.slice(0, targetLength) + String(src);
        }
    }
}
BasicTableComponent.decorators = [
    { type: Component, args: [{
                selector: "app-basic-table",
                template: "<table class=\"table table-striped table-hover text-nowrap\" [ngStyle]=\"{'margin-left': isMain ? null : '24px'}\"\r\n    style=\"min-width: 100%; width: auto;\" *ngIf=\"ffields && ffields.length > 0 && frows && frows.length > 0\">\r\n    <thead class=\"thead-light\">\r\n        <tr>\r\n            <th style=\"width: 40px;\"><span></span></th>\r\n            <th *ngFor=\"let ffield of ffields\">\r\n                <span>{{ffield.captionPath}}</span>\r\n            </th>\r\n        </tr>\r\n    </thead>\r\n    <tbody>\r\n        <ng-container *ngFor=\"let frow of frows;let rowIdx = index;\">\r\n            <tr #tr>\r\n                <td>\r\n                    <span *ngIf=\"frow.hasChildren\" style=\"cursor:pointer;\" (click)=\"clickHandler(frow, $event)\"\r\n                        [ngClass]=\"{'k-icon': true, 'k-i-plus-outline': !frow.expanded, 'k-i-minus-outline': frow.expanded}\"></span>\r\n                </td>\r\n                <ng-container *ngFor=\"let ffield of ffields\">\r\n                    <td>\r\n                        <span>{{getShownText(frow.data, ffield)}}</span>\r\n                        <span *ngIf=\"ffield.showMore\" class=\"f-icon f-icon-more\"></span>\r\n                    </td>\r\n                </ng-container>\r\n            </tr>\r\n            <tr *ngIf=\"frow.expanded&&frow.hasChildren\">\r\n                <td [attr.colspan]=\"tr.cells.length\">\r\n                    <ng-container appChildRowTable [parentRow]=\"rows[rowIdx]\" [parentSchemaTable]=\"billSchemaTable\"\r\n                        [parentDataTable]=\"billDataTable\" [billInfo]=\"billInfo\" [expanded]=\"frow.expanded\"\r\n                        [colspan]=\"tr.cells.length\">\r\n                    </ng-container>\r\n                </td>\r\n            </tr>\r\n        </ng-container>\r\n    </tbody>\r\n    <tfoot>\r\n    </tfoot>\r\n</table>",
                changeDetection: ChangeDetectionStrategy.OnPush,
                styles: ["./basic-table.component.css"]
            }] }
];
/** @nocollapse */
BasicTableComponent.ctorParameters = () => [
    { type: ViewContainerRef },
    { type: Injector },
    { type: ComponentFactoryResolver },
    { type: ChangeDetectorRef }
];
BasicTableComponent.propDecorators = {
    childTrTable: [{ type: ViewChild, args: ["childTrTable",] }],
    childTrTableVCR: [{ type: ViewChild, args: ["childTrTable", { read: ViewContainerRef },] }]
};
if (false) {
    /** @type {?} */
    BasicTableComponent.prototype.billInfo;
    /** @type {?} */
    BasicTableComponent.prototype.isMain;
    /** @type {?} */
    BasicTableComponent.prototype.billSchemaTable;
    /** @type {?} */
    BasicTableComponent.prototype.billDataTable;
    /** @type {?} */
    BasicTableComponent.prototype.fields;
    /** @type {?} */
    BasicTableComponent.prototype.rows;
    /** @type {?} */
    BasicTableComponent.prototype.ffields;
    /** @type {?} */
    BasicTableComponent.prototype.frows;
    /** @type {?} */
    BasicTableComponent.prototype.childTrTable;
    /** @type {?} */
    BasicTableComponent.prototype.childTrTableVCR;
    /** @type {?} */
    BasicTableComponent.prototype.viewContainerRef;
    /** @type {?} */
    BasicTableComponent.prototype.inj;
    /** @type {?} */
    BasicTableComponent.prototype.cfr;
    /** @type {?} */
    BasicTableComponent.prototype.cdr;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYmFzaWMtdGFibGUuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGVkcC1iaWYvcnVudGltZS1hcGkvIiwic291cmNlcyI6WyJsaWIvYmlsbC10cmFja2VyL2NvbXBvbmVudHMvYmFzaWMtdGFibGUvYmFzaWMtdGFibGUuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7O0FBQUEsT0FBTyxFQUFFLFNBQVMsRUFBVSxnQkFBZ0IsRUFBRSxRQUFRLEVBQUUsd0JBQXdCLEVBQUUsU0FBUyxFQUFFLFdBQVcsRUFBRSx1QkFBdUIsRUFBRSxpQkFBaUIsRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUM1SyxPQUFPLEVBQXFILFFBQVEsRUFBRSxtQkFBbUIsRUFBdUIsTUFBTSxxQkFBcUIsQ0FBQztBQUM1TSxPQUFPLEVBQUUsb0JBQW9CLEVBQUUseUJBQXlCLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQztBQUN0RixPQUFPLEVBQUUsY0FBYyxFQUFFLE1BQU0sa0JBQWtCLENBQUM7QUFDbEQsT0FBTyxFQUFFLGdCQUFnQixFQUFFLE1BQU0sb0JBQW9CLENBQUM7QUFVdEQsTUFBTSxPQUFPLG1CQUFtQjs7Ozs7OztJQW1CNUIsWUFDVyxnQkFBa0MsRUFDbEMsR0FBYSxFQUNiLEdBQTZCLEVBQzdCLEdBQXNCO1FBSHRCLHFCQUFnQixHQUFoQixnQkFBZ0IsQ0FBa0I7UUFDbEMsUUFBRyxHQUFILEdBQUcsQ0FBVTtRQUNiLFFBQUcsR0FBSCxHQUFHLENBQTBCO1FBQzdCLFFBQUcsR0FBSCxHQUFHLENBQW1CO0lBRWpDLENBQUM7Ozs7SUFFRCxRQUFRO0lBRVIsQ0FBQzs7Ozs7O0lBRUQsWUFBWSxDQUFDLElBQXlDLEVBQUUsR0FBVTtRQUM5RCxJQUFJLENBQUMsVUFBVSxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLENBQUM7SUFDekMsQ0FBQzs7Ozs7SUFFRCxhQUFhLENBQUMsR0FBcUI7UUFDL0IsSUFBSSxDQUFDLFNBQVMsQ0FB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QUcsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDO1NBQ3pEO0lBQ0wsQ0FBQzs7O1lBN2FKLFNBQVMsU0FBQztnQkFDUCxRQUFRLEVBQUUsaUJBQWlCO2dCQUUzQiwwMURBQTJDO2dCQUMzQyxlQUFlLEVBQUUsdUJBQXVCLENBQUMsTUFBTTt5QkFGdEMsNkJBQTZCO2FBR3pDOzs7O1lBYjJCLGdCQUFnQjtZQUFFLFFBQVE7WUFBRSx3QkFBd0I7WUFBbUQsaUJBQWlCOzs7MkJBMkIvSSxTQUFTLFNBQUMsY0FBYzs4QkFHeEIsU0FBUyxTQUFDLGNBQWMsRUFBRSxFQUFFLElBQUksRUFBRSxnQkFBZ0IsRUFBRTs7OztJQWZyRCx1Q0FBbUI7O0lBQ25CLHFDQUFnQjs7SUFFaEIsOENBQWlDOztJQUNqQyw0Q0FBNkI7O0lBRTdCLHFDQUEwQjs7SUFDMUIsbUNBQW9COztJQUVwQixzQ0FBMEI7O0lBQzFCLG9DQUEwQjs7SUFFMUIsMkNBQytCOztJQUUvQiw4Q0FDa0M7O0lBRzlCLCtDQUF5Qzs7SUFDekMsa0NBQW9COztJQUNwQixrQ0FBb0M7O0lBQ3BDLGtDQUE2QiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbXBvbmVudCwgT25Jbml0LCBWaWV3Q29udGFpbmVyUmVmLCBJbmplY3RvciwgQ29tcG9uZW50RmFjdG9yeVJlc29sdmVyLCBWaWV3Q2hpbGQsIFRlbXBsYXRlUmVmLCBDaGFuZ2VEZXRlY3Rpb25TdHJhdGVneSwgQ2hhbmdlRGV0ZWN0b3JSZWYgfSBmcm9tIFwiQGFuZ3VsYXIvY29yZVwiO1xyXG5pbXBvcnQgeyBCaWxsU2NoZW1hRmllbGQsIEJpbGxEYXRhVGFibGUsIEJpbGxEYXRhUm93LCBCaWxsRGF0YUZpZWxkLCBCaWxsU2NoZW1hVGFibGUsIEJpbGxTY2hlbWFTdWJGaWVsZCwgQmlsbERhdGFTdWJGaWVsZCwgRGF0YVR5cGUsIEJwbW5Nb2RlbEpzb25IZWxwZXIsIEJpbGxTY2hlbWFGaWVsZEJhc2UgfSBmcm9tICdAZWRwLWFpZi9jb21tb24tYXBpJztcclxuaW1wb3J0IHsgQmlsbFRyYWNraW5nU2V0dGluZ3MsIEJpbGxUcmFja2luZ0RhdGFTaG93bk1vZGUgfSBmcm9tIFwiQGVkcC1iaWYvY29tbW9uLWFwaVwiO1xyXG5pbXBvcnQgeyBCaWxsRnJvbnRGaWVsZCB9IGZyb20gJy4vQmlsbEZyb250RmllbGQnO1xyXG5pbXBvcnQgeyBCaWxsRnJvbnREYXRhUm93IH0gZnJvbSAnLi9CaWxsRnJvbnREYXRhUm93JztcclxuaW1wb3J0IHsgRW50aXR5RGF0YVJlc3VsdCB9IGZyb20gJy4uLy4uL2FyZ3MvRW50aXR5RGF0YVJlc3VsdCc7XHJcbmltcG9ydCB7IEJpbGxJbmZvIH0gZnJvbSAnLi4vLi4vLi4vZW50aXR5L3RyYWNraW5nL0JpbGxJbmZvJztcclxuXHJcbkBDb21wb25lbnQoe1xyXG4gICAgc2VsZWN0b3I6IFwiYXBwLWJhc2ljLXRhYmxlXCIsXHJcbiAgICBzdHlsZXM6IFtcIi4vYmFzaWMtdGFibGUuY29tcG9uZW50LmNzc1wiXSxcclxuICAgIHRlbXBsYXRlVXJsOiBcIi4vYmFzaWMtdGFibGUuY29tcG9uZW50Lmh0bWxcIixcclxuICAgIGNoYW5nZURldGVjdGlvbjogQ2hhbmdlRGV0ZWN0aW9uU3RyYXRlZ3kuT25QdXNoXHJcbn0pXHJcbmV4cG9ydCBjbGFzcyBCYXNpY1RhYmxlQ29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0IHtcclxuICAgIGJpbGxJbmZvOiBCaWxsSW5mbztcclxuICAgIGlzTWFpbjogYm9vbGVhbjtcclxuXHJcbiAgICBiaWxsU2NoZW1hVGFibGU6IEJpbGxTY2hlbWFUYWJsZTtcclxuICAgIGJpbGxEYXRhVGFibGU6IEJpbGxEYXRhVGFibGU7XHJcblxyXG4gICAgZmllbGRzOiBCaWxsU2NoZW1hRmllbGRbXTtcclxuICAgIHJvd3M6IEJpbGxEYXRhUm93W107XHJcblxyXG4gICAgZmZpZWxkczogQmlsbEZyb250RmllbGRbXTtcclxuICAgIGZyb3dzOiBCaWxsRnJvbnREYXRhUm93W107XHJcblxyXG4gICAgQFZpZXdDaGlsZChcImNoaWxkVHJUYWJsZVwiKVxyXG4gICAgY2hpbGRUclRhYmxlOiBUZW1wbGF0ZVJlZjxhbnk+O1xyXG5cclxuICAgIEBWaWV3Q2hpbGQoXCJjaGlsZFRyVGFibGVcIiwgeyByZWFkOiBWaWV3Q29udGFpbmVyUmVmIH0pXHJcbiAgICBjaGlsZFRyVGFibGVWQ1I6IFZpZXdDb250YWluZXJSZWY7XHJcblxyXG4gICAgY29uc3RydWN0b3IoXHJcbiAgICAgICAgcHVibGljIHZpZXdDb250YWluZXJSZWY6IFZpZXdDb250YWluZXJSZWYsXHJcbiAgICAgICAgcHVibGljIGluajogSW5qZWN0b3IsXHJcbiAgICAgICAgcHVibGljIGNmcjogQ29tcG9uZW50RmFjdG9yeVJlc29sdmVyLFxyXG4gICAgICAgIHB1YmxpYyBjZHI6IENoYW5nZURldGVjdG9yUmVmLFxyXG4gICAgKSB7XHJcbiAgICB9XHJcblxyXG4gICAgbmdPbkluaXQoKTogdm9pZCB7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIGNsaWNrSGFuZGxlcihpdGVtOiB7IHJvd0RhdGE6IGFueSwgZXhwYW5kZWQ6IGJvb2xlYW4gfSwgZXZ0OiBFdmVudCkge1xyXG4gICAgICAgIGl0ZW1bJ2V4cGFuZGVkJ10gPSAhaXRlbVsnZXhwYW5kZWQnXTtcclxuICAgIH1cclxuXHJcbiAgICBzaG93TWFpblRhYmxlKHJlczogRW50aXR5RGF0YVJlc3VsdCkge1xyXG4gICAgICAgIHRoaXMuc2hvd1RhYmxlKHJlcy5iaWxsU2NoZW1hLm1haW5UYWJsZSwgcmVzLmJpbGxEYXRhLm1haW5UYWJsZSk7XHJcbiAgICB9XHJcblxyXG4gICAgc2hvd1RhYmxlKHNjaGVtYVRhYmxlOiBCaWxsU2NoZW1hVGFibGUsIGRhdGFUYWJsZTogQmlsbERhdGFUYWJsZSkge1xyXG4gICAgICAgIHRoaXMuYmlsbFNjaGVtYVRhYmxlID0gc2NoZW1hVGFibGU7XHJcbiAgICAgICAgdGhpcy5iaWxsRGF0YVRhYmxlID0gZGF0YVRhYmxlO1xyXG5cclxuICAgICAgICB0aGlzLmxvYWREYXRhKHNjaGVtYVRhYmxlLmdldEZpZWxkTGlzdCgpLCBkYXRhVGFibGUuR2V0Um93TGlzdCgpKTtcclxuXHJcbiAgICAgICAgdGhpcy5jZHIuZGV0ZWN0Q2hhbmdlcygpO1xyXG4gICAgfVxyXG5cclxuICAgIGxvYWREYXRhKGJpbGxTY2hlbWFGaWVsZHM6IEJpbGxTY2hlbWFGaWVsZFtdLCBiaWxsRGF0YVJvd3M6IEJpbGxEYXRhUm93W10pIHtcclxuICAgICAgICB0aGlzLmZpZWxkcyA9IGJpbGxTY2hlbWFGaWVsZHM7XHJcbiAgICAgICAgdGhpcy5yb3dzID0gYmlsbERhdGFSb3dzO1xyXG5cclxuICAgICAgICBsZXQgYnRzID0gbmV3IEJpbGxUcmFja2luZ1NldHRpbmdzKCk7XHJcbiAgICAgICAgaWYgKHRoaXMuYmlsbEluZm8gJiYgdGhpcy5iaWxsSW5mby5iaWxsVHJhY2tpbmdTZXR0aW5ncykge1xyXG4gICAgICAgICAgICBidHMuTG9hZEZyb21Kc29uKHRoaXMuYmlsbEluZm8uYmlsbFRyYWNraW5nU2V0dGluZ3MpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoYnRzLmJpbGxUcmFja2luZ0RhdGFTaG93bk1vZGUgPT0gQmlsbFRyYWNraW5nRGF0YVNob3duTW9kZS5DVVNUT01GSUVMRCkge1xyXG4gICAgICAgICAgICB0aGlzLmZmaWVsZHMgPSB0aGlzLmV4dHJhY3RGRmllbGRzV2l0aEN1c3RvbUZpZWxkcyhiaWxsU2NoZW1hRmllbGRzLCBidHMuY3VzdG9tRmllbGRDb250ZW50KTtcclxuICAgICAgICAgICAgdGhpcy5mcm93cyA9IHRoaXMuZXh0cmFjdEZSb3dzKGJpbGxEYXRhUm93cywgdGhpcy5mZmllbGRzKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLmZmaWVsZHMgPSB0aGlzLmV4dHJhY3RGRmllbGRzKGJpbGxTY2hlbWFGaWVsZHMpO1xyXG4gICAgICAgICAgICB0aGlzLmZyb3dzID0gdGhpcy5leHRyYWN0RlJvd3MoYmlsbERhdGFSb3dzLCB0aGlzLmZmaWVsZHMpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDpu5jorqTlsZXnpLrmlrnlvI9cclxuICAgICAqIEBwYXJhbSBmaWVsZHMgXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgZXh0cmFjdEZGaWVsZHMoZmllbGRzOiBCaWxsU2NoZW1hRmllbGRbXSk6IEJpbGxGcm9udEZpZWxkW10ge1xyXG4gICAgICAgIGxldCBmZmllbGRzOiBCaWxsRnJvbnRGaWVsZFtdID0gW107XHJcbiAgICAgICAgZm9yIChsZXQgZmllbGQgb2YgZmllbGRzKSB7XHJcbiAgICAgICAgICAgIC8v5p6a5Li+5oiW6ICF5p6a5Li+5Z6L5Y2V5YC8VURU5pe26buY6K6k5Y+WTmFtZVxyXG4gICAgICAgICAgICBpZiAoZmllbGQuZmllbGRUeXBlID09IFwiRW51bVwiIHx8IGZpZWxkLmZpZWxkVHlwZSA9PSBcIkVudW1TaW5nbGVVZHRcIikge1xyXG4gICAgICAgICAgICAgICAgbGV0IGZmID0gbmV3IEJpbGxGcm9udEZpZWxkKCk7XHJcbiAgICAgICAgICAgICAgICBmZi5maWVsZE5hbWUgPSBmaWVsZC5maWVsZE5hbWU7XHJcbiAgICAgICAgICAgICAgICBmZi5kYXRhVHlwZSA9IGZpZWxkLmRhdGFUeXBlO1xyXG4gICAgICAgICAgICAgICAgZmYuY2FwdGlvbiA9IGZpZWxkLmNhcHRpb247XHJcbiAgICAgICAgICAgICAgICBmZi5maWVsZFR5cGUgPSBmaWVsZC5maWVsZFR5cGU7XHJcbiAgICAgICAgICAgICAgICBmZi5sZW5ndGggPSBmaWVsZC5sZW5ndGg7XHJcbiAgICAgICAgICAgICAgICBmZi5wcmVjaXNpb24gPSBmaWVsZC5wcmVjaXNpb247XHJcbiAgICAgICAgICAgICAgICBmZi5zY2FsZSA9IGZpZWxkLnNjYWxlO1xyXG4gICAgICAgICAgICAgICAgZmYuY2FwdGlvblBhdGggPSB0aGlzLmV4dHJhY3RDYXB0aW9uUGF0aChmaWVsZCk7XHJcbiAgICAgICAgICAgICAgICBmZi5maWVsZFBhdGggPSB0aGlzLmV4dHJhY3RGaWVsZFBhdGgoZmllbGQpICsgXCIuTmFtZVwiO1xyXG5cclxuICAgICAgICAgICAgICAgIGZmaWVsZHMucHVzaChmZik7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoZmllbGQuR2V0U3ViRmllbGRMaXN0KCkgIT0gbnVsbCAmJiBmaWVsZC5HZXRTdWJGaWVsZExpc3QoKS5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICBmZmllbGRzLnB1c2goLi4udGhpcy5leHRyYWN0RlN1YkZpZWxkcyhmaWVsZC5HZXRTdWJGaWVsZExpc3QoKSkpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgbGV0IGZmID0gbmV3IEJpbGxGcm9udEZpZWxkKCk7XHJcbiAgICAgICAgICAgICAgICBmZi5maWVsZE5hbWUgPSBmaWVsZC5maWVsZE5hbWU7XHJcbiAgICAgICAgICAgICAgICBmZi5kYXRhVHlwZSA9IGZpZWxkLmRhdGFUeXBlO1xyXG4gICAgICAgICAgICAgICAgZmYuY2FwdGlvbiA9IGZpZWxkLmNhcHRpb247XHJcbiAgICAgICAgICAgICAgICBmZi5maWVsZFR5cGUgPSBmaWVsZC5maWVsZFR5cGU7XHJcbiAgICAgICAgICAgICAgICBmZi5sZW5ndGggPSBmaWVsZC5sZW5ndGg7XHJcbiAgICAgICAgICAgICAgICBmZi5wcmVjaXNpb24gPSBmaWVsZC5wcmVjaXNpb247XHJcbiAgICAgICAgICAgICAgICBmZi5zY2FsZSA9IGZpZWxkLnNjYWxlO1xyXG4gICAgICAgICAgICAgICAgZmYuY2FwdGlvblBhdGggPSB0aGlzLmV4dHJhY3RDYXB0aW9uUGF0aChmaWVsZCk7XHJcbiAgICAgICAgICAgICAgICBmZi5maWVsZFBhdGggPSB0aGlzLmV4dHJhY3RGaWVsZFBhdGgoZmllbGQpO1xyXG5cclxuICAgICAgICAgICAgICAgIGZmaWVsZHMucHVzaChmZik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBmZmllbGRzO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgZXh0cmFjdEZTdWJGaWVsZHMoZmllbGRzOiBCaWxsU2NoZW1hU3ViRmllbGRbXSwgcGFyZW50RmllbGQ/OiBCaWxsU2NoZW1hRmllbGQpOiBCaWxsRnJvbnRGaWVsZFtdIHtcclxuICAgICAgICBsZXQgZmZpZWxkczogQmlsbEZyb250RmllbGRbXSA9IFtdO1xyXG4gICAgICAgIGZvciAobGV0IGZpZWxkIG9mIGZpZWxkcykge1xyXG4gICAgICAgICAgICAvL+aemuS4vuaIluiAheaemuS4vuWei+WNleWAvFVEVOaXtum7mOiupOWPlk5hbWVcclxuICAgICAgICAgICAgaWYgKGZpZWxkLmZpZWxkVHlwZSA9PSBcIkVudW1cIiB8fCBmaWVsZC5maWVsZFR5cGUgPT0gXCJFbnVtU2luZ2xlVWR0XCIpIHtcclxuICAgICAgICAgICAgICAgIGxldCBmZiA9IG5ldyBCaWxsRnJvbnRGaWVsZCgpO1xyXG4gICAgICAgICAgICAgICAgZmYuZmllbGROYW1lID0gZmllbGQuZmllbGROYW1lO1xyXG4gICAgICAgICAgICAgICAgZmYuZGF0YVR5cGUgPSBmaWVsZC5kYXRhVHlwZTtcclxuICAgICAgICAgICAgICAgIGZmLmNhcHRpb24gPSBmaWVsZC5jYXB0aW9uO1xyXG4gICAgICAgICAgICAgICAgZmYuZmllbGRUeXBlID0gZmllbGQuZmllbGRUeXBlO1xyXG4gICAgICAgICAgICAgICAgZmYubGVuZ3RoID0gZmllbGQubGVuZ3RoO1xyXG4gICAgICAgICAgICAgICAgZmYucHJlY2lzaW9uID0gZmllbGQucHJlY2lzaW9uO1xyXG4gICAgICAgICAgICAgICAgZmYuc2NhbGUgPSBmaWVsZC5zY2FsZTtcclxuICAgICAgICAgICAgICAgIGZmLmNhcHRpb25QYXRoID0gdGhpcy5leHRyYWN0Q2FwdGlvblBhdGgoZmllbGQpO1xyXG4gICAgICAgICAgICAgICAgZmYuZmllbGRQYXRoID0gdGhpcy5leHRyYWN0RmllbGRQYXRoKGZpZWxkKSArIFwiLk5hbWVcIjtcclxuXHJcbiAgICAgICAgICAgICAgICBmZmllbGRzLnB1c2goZmYpO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKGZpZWxkLkdldFN1YkZpZWxkTGlzdCgpICE9IG51bGwgJiYgZmllbGQuR2V0U3ViRmllbGRMaXN0KCkubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgZmZpZWxkcy5wdXNoKC4uLnRoaXMuZXh0cmFjdEZTdWJGaWVsZHMoZmllbGQuR2V0U3ViRmllbGRMaXN0KCkpKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGxldCBmZiA9IG5ldyBCaWxsRnJvbnRGaWVsZCgpO1xyXG4gICAgICAgICAgICAgICAgZmYuZmllbGROYW1lID0gZmllbGQuZmllbGROYW1lO1xyXG4gICAgICAgICAgICAgICAgZmYuZGF0YVR5cGUgPSBmaWVsZC5kYXRhVHlwZTtcclxuICAgICAgICAgICAgICAgIGZmLmNhcHRpb24gPSBmaWVsZC5jYXB0aW9uO1xyXG4gICAgICAgICAgICAgICAgZmYuZmllbGRUeXBlID0gZmllbGQuZmllbGRUeXBlO1xyXG4gICAgICAgICAgICAgICAgZmYubGVuZ3RoID0gZmllbGQubGVuZ3RoO1xyXG4gICAgICAgICAgICAgICAgZmYucHJlY2lzaW9uID0gZmllbGQucHJlY2lzaW9uO1xyXG4gICAgICAgICAgICAgICAgZmYuc2NhbGUgPSBmaWVsZC5zY2FsZTtcclxuICAgICAgICAgICAgICAgIGZmLmNhcHRpb25QYXRoID0gdGhpcy5leHRyYWN0Q2FwdGlvblBhdGgoZmllbGQpO1xyXG4gICAgICAgICAgICAgICAgZmYuZmllbGRQYXRoID0gdGhpcy5leHRyYWN0RmllbGRQYXRoKGZpZWxkKTtcclxuXHJcbiAgICAgICAgICAgICAgICBmZmllbGRzLnB1c2goZmYpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gZmZpZWxkcztcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOiHquWumuS5ieWtl+auteWxleekuuaWueW8j1xyXG4gICAgICovXHJcbiAgICBwcml2YXRlIGV4dHJhY3RGRmllbGRzV2l0aEN1c3RvbUZpZWxkcyhmaWVsZHM6IEJpbGxTY2hlbWFGaWVsZFtdLCBmaWVsZENvbnRlbnQ6IGFueSk6IEJpbGxGcm9udEZpZWxkW10ge1xyXG4gICAgICAgIC8vIOihqGNvZGVcclxuICAgICAgICBjb25zdCB0YWJsZUNvZGUgPSB0aGlzLmJpbGxTY2hlbWFUYWJsZS50YWJsZU5hbWU7XHJcblxyXG4gICAgICAgIC8vIOWNleaNrui/vei4qumFjee9rlxyXG4gICAgICAgIGxldCBidHM6IEJpbGxUcmFja2luZ1NldHRpbmdzID0gbmV3IEJpbGxUcmFja2luZ1NldHRpbmdzKCk7XHJcbiAgICAgICAgaWYgKHRoaXMuYmlsbEluZm8gJiYgdGhpcy5iaWxsSW5mby5iaWxsVHJhY2tpbmdTZXR0aW5ncykge1xyXG4gICAgICAgICAgICBidHMuTG9hZEZyb21Kc29uKHRoaXMuYmlsbEluZm8uYmlsbFRyYWNraW5nU2V0dGluZ3MpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgbGV0IGZpZWxkQ29uZmlnOiB7IHNjaGVtYT86IHsgc2VsZWN0ZWRBbGw/OiBhbnk7W2lkOiBzdHJpbmddOiB7IGNvZGU6IHN0cmluZywgY2FwdGlvbjogc3RyaW5nLCBmaWVsZHM6IGFueVtdIH0gfSwgW2s6IHN0cmluZ106IGFueSB9ID0gdHlwZW9mIGZpZWxkQ29udGVudCA9PSBcIm9iamVjdFwiID8gZmllbGRDb250ZW50IDogSlNPTi5wYXJzZShmaWVsZENvbnRlbnQpO1xyXG5cclxuICAgICAgICBsZXQgZmZpZWxkczogQmlsbEZyb250RmllbGRbXSA9IFtdO1xyXG4gICAgICAgIGZvciAobGV0IGZpZWxkIG9mIGZpZWxkcykge1xyXG4gICAgICAgICAgICAvLyDlrZfmrrVJRFxyXG4gICAgICAgICAgICBjb25zdCBmaWVsZFBhdGggPSB0aGlzLmV4dHJhY3RGaWVsZFBhdGgoZmllbGQpO1xyXG5cclxuICAgICAgICAgICAgbGV0IHNmID0gbnVsbDtcclxuICAgICAgICAgICAgZm9yIChsZXQgayBpbiBmaWVsZENvbmZpZy5zY2hlbWEpIHtcclxuICAgICAgICAgICAgICAgIGlmIChrID09ICdzZWxlY3RlZEFsbCcpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChrID09IHRhYmxlQ29kZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHMgPSBmaWVsZENvbmZpZy5zY2hlbWFba107XHJcbiAgICAgICAgICAgICAgICAgICAgc2YgPSBzICYmIHMuZmllbGRzLmZpbmQoKGVsdCkgPT4gZWx0LmZpZWxkUGF0aCA9PSBmaWVsZFBhdGgpO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChzZiA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgLy/mnprkuL7miJbogIXmnprkuL7lnovljZXlgLxVRFTml7bpu5jorqTlj5ZOYW1lXHJcbiAgICAgICAgICAgIGlmIChmaWVsZC5maWVsZFR5cGUgPT0gXCJFbnVtXCIgfHwgZmllbGQuZmllbGRUeXBlID09IFwiRW51bVNpbmdsZVVkdFwiKSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgZmYgPSBuZXcgQmlsbEZyb250RmllbGQoKTtcclxuICAgICAgICAgICAgICAgIGZmLmZpZWxkTmFtZSA9IGZpZWxkLmZpZWxkTmFtZTtcclxuICAgICAgICAgICAgICAgIGZmLmRhdGFUeXBlID0gZmllbGQuZGF0YVR5cGU7XHJcbiAgICAgICAgICAgICAgICBmZi5jYXB0aW9uID0gZmllbGQuY2FwdGlvbjtcclxuICAgICAgICAgICAgICAgIGZmLmZpZWxkVHlwZSA9IGZpZWxkLmZpZWxkVHlwZTtcclxuICAgICAgICAgICAgICAgIGZmLmxlbmd0aCA9IGZpZWxkLmxlbmd0aDtcclxuICAgICAgICAgICAgICAgIGZmLnByZWNpc2lvbiA9IGZpZWxkLnByZWNpc2lvbjtcclxuICAgICAgICAgICAgICAgIGZmLnNjYWxlID0gZmllbGQuc2NhbGU7XHJcbiAgICAgICAgICAgICAgICBmZi5jYXB0aW9uUGF0aCA9IHNmLmRpc3BsYXlOYW1lIHx8IGZpZWxkLmNhcHRpb247XHJcbiAgICAgICAgICAgICAgICBmZi5maWVsZFBhdGggPSB0aGlzLmV4dHJhY3RGaWVsZFBhdGgoZmllbGQpICsgXCIuTmFtZVwiO1xyXG5cclxuICAgICAgICAgICAgICAgIGZmaWVsZHMucHVzaChmZik7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoZmllbGQuR2V0U3ViRmllbGRMaXN0KCkgIT0gbnVsbCAmJiBmaWVsZC5HZXRTdWJGaWVsZExpc3QoKS5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICBmZmllbGRzLnB1c2goLi4udGhpcy5leHRyYWN0RlN1YkZpZWxkc1dpdGhDdXN0b21GaWVsZHMoZmllbGQuR2V0U3ViRmllbGRMaXN0KCksIGZpZWxkQ29udGVudCwgZmllbGQpKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGxldCBmZiA9IG5ldyBCaWxsRnJvbnRGaWVsZCgpO1xyXG4gICAgICAgICAgICAgICAgZmYuZmllbGROYW1lID0gZmllbGQuZmllbGROYW1lO1xyXG4gICAgICAgICAgICAgICAgZmYuZGF0YVR5cGUgPSBmaWVsZC5kYXRhVHlwZTtcclxuICAgICAgICAgICAgICAgIGZmLmNhcHRpb24gPSBmaWVsZC5jYXB0aW9uO1xyXG4gICAgICAgICAgICAgICAgZmYuZmllbGRUeXBlID0gZmllbGQuZmllbGRUeXBlO1xyXG4gICAgICAgICAgICAgICAgZmYubGVuZ3RoID0gZmllbGQubGVuZ3RoO1xyXG4gICAgICAgICAgICAgICAgZmYucHJlY2lzaW9uID0gZmllbGQucHJlY2lzaW9uO1xyXG4gICAgICAgICAgICAgICAgZmYuc2NhbGUgPSBmaWVsZC5zY2FsZTtcclxuICAgICAgICAgICAgICAgIGZmLmNhcHRpb25QYXRoID0gc2YuZGlzcGxheU5hbWUgfHwgZmllbGQuY2FwdGlvbjtcclxuICAgICAgICAgICAgICAgIGZmLmZpZWxkUGF0aCA9IHRoaXMuZXh0cmFjdEZpZWxkUGF0aChmaWVsZCk7XHJcblxyXG4gICAgICAgICAgICAgICAgZmZpZWxkcy5wdXNoKGZmKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIGZmaWVsZHM7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBleHRyYWN0RlN1YkZpZWxkc1dpdGhDdXN0b21GaWVsZHMoZmllbGRzOiBCaWxsU2NoZW1hU3ViRmllbGRbXSwgZmllbGRDb250ZW50OiBhbnksIHBhcmVudEZpZWxkPzogQmlsbFNjaGVtYUZpZWxkQmFzZSk6IEJpbGxGcm9udEZpZWxkW10ge1xyXG4gICAgICAgIC8vIOihqOe8luWPt1xyXG4gICAgICAgIGNvbnN0IHRhYmxlQ29kZSA9IHRoaXMuYmlsbFNjaGVtYVRhYmxlLnRhYmxlTmFtZTtcclxuXHJcbiAgICAgICAgLy8g5Y2V5o2u6L+96Liq6YWN572uXHJcbiAgICAgICAgbGV0IGJ0czogQmlsbFRyYWNraW5nU2V0dGluZ3MgPSBuZXcgQmlsbFRyYWNraW5nU2V0dGluZ3MoKTtcclxuICAgICAgICBpZiAodGhpcy5iaWxsSW5mbyAmJiB0aGlzLmJpbGxJbmZvLmJpbGxUcmFja2luZ1NldHRpbmdzKSB7XHJcbiAgICAgICAgICAgIGJ0cy5Mb2FkRnJvbUpzb24odGhpcy5iaWxsSW5mby5iaWxsVHJhY2tpbmdTZXR0aW5ncyk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBsZXQgZmllbGRDb25maWc6IHsgc2NoZW1hPzogeyBzZWxlY3RlZEFsbD86IGFueTtbaWQ6IHN0cmluZ106IHsgY29kZTogc3RyaW5nLCBuYW1lOiBzdHJpbmcsIGZpZWxkczogYW55W10gfSB9LCBbazogc3RyaW5nXTogYW55IH0gPSB0eXBlb2YgZmllbGRDb250ZW50ID09IFwib2JqZWN0XCIgPyBmaWVsZENvbnRlbnQgOiBKU09OLnBhcnNlKGZpZWxkQ29udGVudCk7XHJcblxyXG4gICAgICAgIGxldCBmZmllbGRzOiBCaWxsRnJvbnRGaWVsZFtdID0gW107XHJcbiAgICAgICAgZm9yIChsZXQgZmllbGQgb2YgZmllbGRzKSB7XHJcbiAgICAgICAgICAgIC8vIOWtl+autUlEXHJcbiAgICAgICAgICAgIGNvbnN0IGZpZWxkUGF0aCA9IHRoaXMuZXh0cmFjdEZpZWxkUGF0aChmaWVsZCk7XHJcblxyXG4gICAgICAgICAgICBsZXQgc2YgPSBudWxsO1xyXG4gICAgICAgICAgICBmb3IgKGxldCBrIGluIGZpZWxkQ29uZmlnLnNjaGVtYSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGsgPT0gJ3NlbGVjdGVkQWxsJykge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKGsgPT0gdGFibGVDb2RlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcyA9IGZpZWxkQ29uZmlnLnNjaGVtYVtrXTtcclxuICAgICAgICAgICAgICAgICAgICBzZiA9IHMgJiYgcy5maWVsZHMuZmluZCgoZWx0KSA9PiBlbHQuZmllbGRQYXRoID09IGZpZWxkUGF0aCk7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHNmID09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvL+aemuS4vuaIluiAheaemuS4vuWei+WNleWAvFVEVOaXtum7mOiupOWPlk5hbWVcclxuICAgICAgICAgICAgaWYgKGZpZWxkLmZpZWxkVHlwZSA9PSBcIkVudW1cIiB8fCBmaWVsZC5maWVsZFR5cGUgPT0gXCJFbnVtU2luZ2xlVWR0XCIpIHtcclxuICAgICAgICAgICAgICAgIGxldCBmZiA9IG5ldyBCaWxsRnJvbnRGaWVsZCgpO1xyXG4gICAgICAgICAgICAgICAgZmYuZmllbGROYW1lID0gZmllbGQuZmllbGROYW1lO1xyXG4gICAgICAgICAgICAgICAgZmYuZGF0YVR5cGUgPSBmaWVsZC5kYXRhVHlwZTtcclxuICAgICAgICAgICAgICAgIGZmLmNhcHRpb24gPSBmaWVsZC5jYXB0aW9uO1xyXG4gICAgICAgICAgICAgICAgZmYuZmllbGRUeXBlID0gZmllbGQuZmllbGRUeXBlO1xyXG4gICAgICAgICAgICAgICAgZmYubGVuZ3RoID0gZmllbGQubGVuZ3RoO1xyXG4gICAgICAgICAgICAgICAgZmYucHJlY2lzaW9uID0gZmllbGQucHJlY2lzaW9uO1xyXG4gICAgICAgICAgICAgICAgZmYuc2NhbGUgPSBmaWVsZC5zY2FsZTtcclxuICAgICAgICAgICAgICAgIGZmLmNhcHRpb25QYXRoID0gc2YuZGlzcGxheU5hbWUgfHwgZmllbGQuY2FwdGlvbjtcclxuICAgICAgICAgICAgICAgIGZmLmZpZWxkUGF0aCA9IHRoaXMuZXh0cmFjdEZpZWxkUGF0aChmaWVsZCkgKyBcIi5OYW1lXCI7XHJcblxyXG4gICAgICAgICAgICAgICAgZmZpZWxkcy5wdXNoKGZmKTtcclxuICAgICAgICAgICAgfSBlbHNlIGlmIChmaWVsZC5HZXRTdWJGaWVsZExpc3QoKSAhPSBudWxsICYmIGZpZWxkLkdldFN1YkZpZWxkTGlzdCgpLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgIGZmaWVsZHMucHVzaCguLi50aGlzLmV4dHJhY3RGU3ViRmllbGRzV2l0aEN1c3RvbUZpZWxkcyhmaWVsZC5HZXRTdWJGaWVsZExpc3QoKSwgZmllbGRDb250ZW50LCBmaWVsZCkpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgbGV0IGZmID0gbmV3IEJpbGxGcm9udEZpZWxkKCk7XHJcbiAgICAgICAgICAgICAgICBmZi5maWVsZE5hbWUgPSBmaWVsZC5maWVsZE5hbWU7XHJcbiAgICAgICAgICAgICAgICBmZi5kYXRhVHlwZSA9IGZpZWxkLmRhdGFUeXBlO1xyXG4gICAgICAgICAgICAgICAgZmYuY2FwdGlvbiA9IGZpZWxkLmNhcHRpb247XHJcbiAgICAgICAgICAgICAgICBmZi5maWVsZFR5cGUgPSBmaWVsZC5maWVsZFR5cGU7XHJcbiAgICAgICAgICAgICAgICBmZi5sZW5ndGggPSBmaWVsZC5sZW5ndGg7XHJcbiAgICAgICAgICAgICAgICBmZi5wcmVjaXNpb24gPSBmaWVsZC5wcmVjaXNpb247XHJcbiAgICAgICAgICAgICAgICBmZi5zY2FsZSA9IGZpZWxkLnNjYWxlO1xyXG4gICAgICAgICAgICAgICAgZmYuY2FwdGlvblBhdGggPSBzZi5kaXNwbGF5TmFtZSB8fCBmaWVsZC5jYXB0aW9uO1xyXG4gICAgICAgICAgICAgICAgZmYuZmllbGRQYXRoID0gdGhpcy5leHRyYWN0RmllbGRQYXRoKGZpZWxkKTtcclxuXHJcbiAgICAgICAgICAgICAgICBmZmllbGRzLnB1c2goZmYpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gZmZpZWxkcztcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGV4dHJhY3RDYXB0aW9uUGF0aChmaWVsZDogQmlsbFNjaGVtYUZpZWxkIHwgQmlsbFNjaGVtYVN1YkZpZWxkKSB7XHJcbiAgICAgICAgbGV0IHMgPSBmaWVsZC5jYXB0aW9uO1xyXG4gICAgICAgIGxldCB0bXAgPSBmaWVsZCBhcyBCaWxsU2NoZW1hU3ViRmllbGQ7XHJcbiAgICAgICAgd2hpbGUgKHRtcC5hdHRhY2hlZEZpZWxkICE9IG51bGwpIHtcclxuICAgICAgICAgICAgcyA9IHRtcC5hdHRhY2hlZEZpZWxkLmNhcHRpb24gKyBcIi5cIiArIHM7XHJcbiAgICAgICAgICAgIHRtcCA9IHRtcC5hdHRhY2hlZEZpZWxkIGFzIEJpbGxTY2hlbWFTdWJGaWVsZDtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHM7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBleHRyYWN0RmllbGRQYXRoKGZpZWxkOiBCaWxsU2NoZW1hRmllbGQgfCBCaWxsU2NoZW1hU3ViRmllbGQpIHtcclxuICAgICAgICBsZXQgcyA9IGZpZWxkLmZpZWxkTmFtZTtcclxuICAgICAgICBsZXQgdG1wID0gZmllbGQgYXMgQmlsbFNjaGVtYVN1YkZpZWxkO1xyXG4gICAgICAgIHdoaWxlICh0bXAuYXR0YWNoZWRGaWVsZCAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgIHMgPSB0bXAuYXR0YWNoZWRGaWVsZC5maWVsZE5hbWUgKyBcIi5cIiArIHM7XHJcbiAgICAgICAgICAgIHRtcCA9IHRtcC5hdHRhY2hlZEZpZWxkIGFzIEJpbGxTY2hlbWFTdWJGaWVsZDtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHM7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBleHRyYWN0RlJvd3Mocm93czogQmlsbERhdGFSb3dbXSwgZmZpZWxkczogQmlsbEZyb250RmllbGRbXSkge1xyXG4gICAgICAgIGxldCBmcm93czogQmlsbEZyb250RGF0YVJvd1tdID0gW107XHJcblxyXG4gICAgICAgIGZvciAobGV0IHJvdyBvZiByb3dzKSB7XHJcbiAgICAgICAgICAgIGxldCBmciA9IG5ldyBCaWxsRnJvbnREYXRhUm93KCk7XHJcbiAgICAgICAgICAgIGZyLmV4cGFuZGVkID0gcm93LkdldENoaWxkVGFibGVMaXN0KCkubGVuZ3RoID09IDAgPyBudWxsIDogcm93LmF0dGFjaGVkVGFibGUgJiYgcm93LmF0dGFjaGVkVGFibGUuYXR0YWNoZWRSb3cgPT0gbnVsbCA/IHRydWUgOiBmYWxzZTtcclxuICAgICAgICAgICAgZnIuaGFzQ2hpbGRyZW4gPSB0aGlzLmhhc0NoaWxkcmVuKHJvdyk7XHJcbiAgICAgICAgICAgIGZyLmRhdGEgPSB7fTtcclxuICAgICAgICAgICAgZm9yIChsZXQgZmYgb2YgZmZpZWxkcykge1xyXG4gICAgICAgICAgICAgICAgZnIuZGF0YVtmZi5maWVsZFBhdGhdID0gdGhpcy5leHRyYWN0RmllbGRQYXRoVmFsdWUocm93LkdldEZpZWxkTWFwKCksIGZmLmZpZWxkUGF0aCk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGZyb3dzLnB1c2goZnIpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIGZyb3dzO1xyXG4gICAgfVxyXG5cclxuICAgIGhhc0NoaWxkcmVuKHJvdzogQmlsbERhdGFSb3cpOiBib29sZWFuIHtcclxuICAgICAgICBsZXQgZmxhZyA9IHJvdy5HZXRDaGlsZFRhYmxlTGlzdCgpICYmIHJvdy5HZXRDaGlsZFRhYmxlTGlzdCgpLmxlbmd0aCA+IDA7XHJcblxyXG4gICAgICAgIGlmIChmbGFnKSB7XHJcbiAgICAgICAgICAgIGxldCBjZiA9IGZhbHNlO1xyXG4gICAgICAgICAgICBmb3IgKGxldCBjdCBvZiByb3cuR2V0Q2hpbGRUYWJsZUxpc3QoKSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGN0LkdldFJvd0xpc3QoKSAmJiBjdC5HZXRSb3dMaXN0KCkubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNmID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZmxhZyA9IGNmO1xyXG4gICAgICAgIH1cclxuXHJcblxyXG4gICAgICAgIHJldHVybiBmbGFnO1xyXG4gICAgfVxyXG5cclxuICAgIGV4dHJhY3RGaWVsZFBhdGhWYWx1ZShiaWxsRGF0YUZpZWxkTWFwOiB7IFtrZXk6IHN0cmluZ106IEJpbGxEYXRhRmllbGQ7IH0sIGZpZWxkUGF0aDogc3RyaW5nKTogYW55IHtcclxuICAgICAgICBsZXQgZmllbGRzID0gZmllbGRQYXRoLnNwbGl0KFwiLlwiKTtcclxuXHJcbiAgICAgICAgbGV0IGJkZjogQmlsbERhdGFGaWVsZCB8IEJpbGxEYXRhU3ViRmllbGQgPSBiaWxsRGF0YUZpZWxkTWFwW2ZpZWxkc1swXV07XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDE7IGJkZiAhPSBudWxsICYmIGkgPCBmaWVsZHMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgY29uc3QgdGVtcCA9IGJkZi5HZXRTdWJGaWVsZE1hcCgpO1xyXG4gICAgICAgICAgICBpZiAodGVtcCA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBiZGYgPSB0ZW1wW2ZpZWxkc1tpXV07XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gYmRmID8gYmRmLkdldFRleHRWYWx1ZSgpIDogXCJcIjtcclxuICAgIH1cclxuXHJcbiAgICBnZXRTaG93blRleHQob2JqOiB7IFtmaWVsZFBhdGg6IHN0cmluZ106IGFueSB9LCBmZmllbGQ6IEJpbGxGcm9udEZpZWxkKSB7XHJcbiAgICAgICAgaWYgKG9ialtmZmllbGQuZmllbGRQYXRoXSA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBcIlwiO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoZmZpZWxkLmRhdGFUeXBlID09IERhdGFUeXBlLlN0cmluZykge1xyXG4gICAgICAgICAgICByZXR1cm4gb2JqW2ZmaWVsZC5maWVsZFBhdGhdIHx8IFwiXCI7XHJcbiAgICAgICAgfSBlbHNlIGlmIChmZmllbGQuZGF0YVR5cGUgPT0gRGF0YVR5cGUuRGVjaW1hbCkge1xyXG4gICAgICAgICAgICBsZXQgZGVjID0gcGFyc2VGbG9hdChTdHJpbmcob2JqW2ZmaWVsZC5maWVsZFBhdGhdKSkudG9GaXhlZChmZmllbGQuc2NhbGUpLnRvU3RyaW5nKCk7XHJcbiAgICAgICAgICAgIHJldHVybiBkZWMgfHwgXCJcIjtcclxuICAgICAgICB9IGVsc2UgaWYgKGZmaWVsZC5kYXRhVHlwZSA9PSBEYXRhVHlwZS5EYXRlVGltZSkge1xyXG4gICAgICAgICAgICBsZXQgZGF0ZSA9IEJwbW5Nb2RlbEpzb25IZWxwZXIuRGF0ZVRpbWVGcm9tU3RyaW5nKG9ialtmZmllbGQuZmllbGRQYXRoXSk7XHJcbiAgICAgICAgICAgIGlmIChmZmllbGQuZmllbGRUeXBlID09IFwiRGF0ZVRpbWVcIikge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZGF0ZUZvcm1hdChkYXRlLCBcInl5eXktTU0tZGQgSEg6bW06c3MuU1NTXCIpO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKGZmaWVsZC5maWVsZFR5cGUgPT0gXCJEYXRlXCIpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmRhdGVGb3JtYXQoZGF0ZSwgXCJ5eXl5LU1NLWRkXCIpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZGF0ZUZvcm1hdChkYXRlLCBcInl5eXktTU0tZGRcIik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gb2JqW2ZmaWVsZC5maWVsZFBhdGhdIHx8IFwiXCI7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGlzT2JqZWN0KG9iaik6IGJvb2xlYW4ge1xyXG4gICAgICAgIHJldHVybiB0eXBlb2YgKG9iaikgPT0gXCJvYmplY3RcIjtcclxuICAgIH1cclxuXHJcbiAgICBpc0FycmF5KG9iaik6IGJvb2xlYW4ge1xyXG4gICAgICAgIHJldHVybiBBcnJheS5pc0FycmF5KG9iaik7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBkYXRlRm9ybWF0KGRhdGU6IERhdGUsIGZtdDogc3RyaW5nKTogc3RyaW5nIHtcclxuICAgICAgICBsZXQgcmV0O1xyXG4gICAgICAgIGNvbnN0IG9wdCA9IHtcclxuICAgICAgICAgICAgXCJ5K1wiOiBkYXRlLmdldFVUQ0Z1bGxZZWFyKCkudG9TdHJpbmcoKSwgICAgICAgIC8vIOW5tFxyXG4gICAgICAgICAgICBcIk0rXCI6IChkYXRlLmdldFVUQ01vbnRoKCkgKyAxKS50b1N0cmluZygpLCAgICAgLy8g5pyIXHJcbiAgICAgICAgICAgIFwiZCtcIjogZGF0ZS5nZXRVVENEYXRlKCkudG9TdHJpbmcoKSwgICAgICAgICAgICAvLyDml6VcclxuICAgICAgICAgICAgXCJIK1wiOiBkYXRlLmdldFVUQ0hvdXJzKCkudG9TdHJpbmcoKSwgICAgICAgICAgIC8vIOaXtlxyXG4gICAgICAgICAgICBcIm0rXCI6IGRhdGUuZ2V0VVRDTWludXRlcygpLnRvU3RyaW5nKCksICAgICAgICAgLy8g5YiGXHJcbiAgICAgICAgICAgIFwicytcIjogZGF0ZS5nZXRVVENTZWNvbmRzKCkudG9TdHJpbmcoKSwgICAgICAgICAvLyDnp5JcclxuICAgICAgICAgICAgXCJTK1wiOiBkYXRlLmdldFVUQ01pbGxpc2Vjb25kcygpLnRvU3RyaW5nKCksICAgIC8vIOenklxyXG4gICAgICAgICAgICAvLyDmnInlhbbku5bmoLzlvI/ljJblrZfnrKbpnIDmsYLlj6/ku6Xnu6fnu63mt7vliqDvvIzlv4XpobvovazljJbmiJDlrZfnrKbkuLJcclxuICAgICAgICB9O1xyXG4gICAgICAgIGZvciAobGV0IGsgaW4gb3B0KSB7XHJcbiAgICAgICAgICAgIHJldCA9IG5ldyBSZWdFeHAoXCIoXCIgKyBrICsgXCIpXCIpLmV4ZWMoZm10KTtcclxuICAgICAgICAgICAgaWYgKHJldCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCFTdHJpbmcucHJvdG90eXBlLnBhZFN0YXJ0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZm10ID0gZm10LnJlcGxhY2UocmV0WzFdLCAocmV0WzFdLmxlbmd0aCA9PSAxKSA/IChvcHRba10pIDogKHRoaXMubXlQYWRTdGFydChvcHRba10sIHJldFsxXS5sZW5ndGgsIFwiMFwiKSkpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBmbXQgPSBmbXQucmVwbGFjZShyZXRbMV0sIChyZXRbMV0ubGVuZ3RoID09IDEpID8gKG9wdFtrXSkgOiAob3B0W2tdLnBhZFN0YXJ0KHJldFsxXS5sZW5ndGgsIFwiMFwiKSkpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBmbXQ7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBteVBhZFN0YXJ0KHNyYzogc3RyaW5nLCB0YXJnZXRMZW5ndGg6IG51bWJlciwgcGFkU3RyaW5nOiBzdHJpbmcpIHtcclxuICAgICAgICB0YXJnZXRMZW5ndGggPSB0YXJnZXRMZW5ndGggPj4gMDsgLy9mbG9vciBpZiBudW1iZXIgb3IgY29udmVydCBub24tbnVtYmVyIHRvIDA7XHJcbiAgICAgICAgcGFkU3RyaW5nID0gU3RyaW5nKHR5cGVvZiBwYWRTdHJpbmcgIT09ICd1bmRlZmluZWQnID8gcGFkU3RyaW5nIDogJyAnKTtcclxuICAgICAgICBpZiAoc3JjLmxlbmd0aCA+IHRhcmdldExlbmd0aCkge1xyXG4gICAgICAgICAgICByZXR1cm4gU3RyaW5nKHNyYyk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGFyZ2V0TGVuZ3RoID0gdGFyZ2V0TGVuZ3RoIC0gc3JjLmxlbmd0aDtcclxuICAgICAgICAgICAgaWYgKHRhcmdldExlbmd0aCA+IHBhZFN0cmluZy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgIHBhZFN0cmluZyArPSBwYWRTdHJpbmcucmVwZWF0KHRhcmdldExlbmd0aCAvIHBhZFN0cmluZy5sZW5ndGgpOyAvL2FwcGVuZCB0byBvcmlnaW5hbCB0byBlbnN1cmUgd2UgYXJlIGxvbmdlciB0aGFuIG5lZWRlZFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBwYWRTdHJpbmcuc2xpY2UoMCwgdGFyZ2V0TGVuZ3RoKSArIFN0cmluZyhzcmMpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufSJdfQ==