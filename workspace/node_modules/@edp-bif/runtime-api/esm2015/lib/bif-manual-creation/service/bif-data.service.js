/**
 * @fileoverview added by tsickle
 * Generated from: lib/bif-manual-creation/service/bif-data.service.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { ComponentFactoryResolver, Inject, Injectable, Injector, LOCALE_ID, NgModuleFactoryLoader, Optional } from '@angular/core';
import { HttpClient, } from '@angular/common/http';
import { of } from 'rxjs';
import { catchError, map, switchMap } from 'rxjs/operators';
import { Repository, FrameContext } from '@farris/devkit';
import { BpmnModelJsonHelper, FormSettings } from '@edp-bif/common-api';
import { GeneralTextEntity } from '@edp-bif/common-api';
import { FormCreateResult, FormUpdateResult } from '../../ref';
import { FormGetBillCreationProcessEntityExArgs } from '../../entity/form-rest/FormGetBillCreationProcessEntityExArgs';
import { FormGetBillCreationProcessEntityExResult } from '../../entity/form-rest/FormGetBillCreationProcessEntityExResult';
import { FormBillCreationProcessExecutorResult } from '@edp-aif/runtime-api';
import { ManualCreationMode } from '../../entity/form-rest/ManualCreationMode';
import { GeneralTextIdWithDataId } from '../../entity';
import { RuntimeFrameworkService } from '@farris/command-services';
import { BsModalService } from '@farris/ui-modal';
import { MessagerService } from '@farris/ui-messager';
import { LocalePipe } from '../pipe/locale.pipe';
import { HttpService } from '@ecp-caf/caf-common';
export class BifDataService {
    /**
     * @param {?} httpClient
     * @param {?} repository
     * @param {?} injector
     * @param {?} cfr
     * @param {?} loader
     * @param {?} modal
     * @param {?} messager
     * @param {?} frameContext
     * @param {?} localeId
     * @param {?} runtimeFrameworkService
     * @param {?} localePipe
     * @param {?} httpService
     */
    constructor(httpClient, repository, injector, cfr, loader, modal, messager, frameContext, localeId, runtimeFrameworkService, localePipe, httpService) {
        this.httpClient = httpClient;
        this.injector = injector;
        this.cfr = cfr;
        this.loader = loader;
        this.modal = modal;
        this.messager = messager;
        this.frameContext = frameContext;
        this.localeId = localeId;
        this.runtimeFrameworkService = runtimeFrameworkService;
        this.localePipe = localePipe;
        this.httpService = httpService;
        this.getBillCreationProcessEntityExByIdUrl = "/api/runtime/aif/v1.0/manualcreationbill/getbillcreationprocessentityex";
        this.getBillCreationProcessEntityExByIdMethod = "GET";
        this.getBillCreationProcessEntityExUrl = "/api/runtime/aif/v1.0/manualcreationbill/getbillcreationprocessentityexes";
        this.getBillCreationProcessEntityExMethod = "POST";
        this.executeBillCreationProcessUrl = "/api/runtime/aif/v1.0/manualcreationbill/executebillcreationprocess";
        this.executeBillCreationProcessMethod = "POST";
        this.formCreateUrl = "/api/runtime/aif/v1.0/form/create";
        this.formCreateMethod = "POST";
        this.formUpdateUrl = "/api/runtime/aif/v1.0/form/update";
        this.formUpdateMethod = "POST";
        this.generalTextUrl = "/api/runtime/aif/v1.0/generaltext";
        this.generalTextMethod = "GET";
        this.generalTextCreationMethod = "POST";
        this.pushTaskUrl = "/api/runtime/aif/v1.0/manualcreationbill/pushtask";
        this.pushTaskMethod = "POST";
        this.getEntityDatasUrl = "/api/runtime/aif/v1.0/manualcreationbill/getentitydatas";
        this.getEntityDatasMethod = "POST";
        this.repository = (/** @type {?} */ (repository));
        this.injector = this.injector != null ? this.injector : this.repository.appContext.injector;
        this.cfr = this.cfr != null ? this.cfr : this.injector.get(ComponentFactoryResolver, null);
        this.loader = this.loader != null ? this.loader : this.injector.get(NgModuleFactoryLoader, null);
        this.modal = this.modal != null ? this.modal : this.injector.get(BsModalService, null);
        this.messager = this.messager != null ? this.messager : this.injector.get(MessagerService, null);
        this.frameContext = this.frameContext != null ? this.frameContext : this.injector.get(FrameContext, null);
        this.localeId = this.localeId != null ? this.localeId : this.injector.get(LOCALE_ID, localStorage.getItem('languageCode') || 'zh-CHS');
        this.runtimeFrameworkService = this.runtimeFrameworkService != null ? this.runtimeFrameworkService : this.injector.get(RuntimeFrameworkService, null);
        this.localePipe = this.localePipe != null ? this.localePipe : this.injector.get(LocalePipe, new LocalePipe(this.localeId));
        this.httpService = this.httpService != null ? this.httpService : this.injector.get(HttpService, null);
    }
    /**
     * 根据上游 VO Id获取单据流生单流程实体列表。
     *
     * @param {?} upBillVoId 上游 VO Id。
     * @return {?} 符合条件的单据流生单流程实体列表。
     */
    getSlimBillCreationProcessEntityExesByUpBillVoId4Push(upBillVoId) {
        /** @type {?} */
        const args = new FormGetBillCreationProcessEntityExArgs();
        args.upBillVoId = upBillVoId;
        args.manualCreationMode = ManualCreationMode.Push;
        return this.getSlimBillCreationProcessEntityExes(args).pipe(map((/**
         * @param {?} res
         * @return {?}
         */
        (res) => {
            return res.billCreationProcessEntityExes;
        })));
    }
    /**
     * 根据下游 VO Id获取单据流生单流程实体列表。
     *
     * @param {?} downBillVoId 下游 VO Id。
     * @return {?} 符合条件的单据流生单流程实体列表。
     */
    getSlimBillCreationProcessEntityExesByDownBillVoId4Pull(downBillVoId) {
        /** @type {?} */
        const args = new FormGetBillCreationProcessEntityExArgs();
        args.downBillVoId = downBillVoId;
        args.manualCreationMode = ManualCreationMode.Pull;
        return this.getSlimBillCreationProcessEntityExes(args).pipe(map((/**
         * @param {?} res
         * @return {?}
         */
        (res) => {
            return res.billCreationProcessEntityExes;
        })), catchError((/**
         * @param {?} err
         * @return {?}
         */
        (err) => {
            try {
                if (typeof err.error == "string") {
                    err.error = JSON.parse(err.error);
                }
            }
            catch (e) {
            }
            throw err;
        })));
    }
    /**
     * 根据上游 VO Id和下游 VO Id获取单据流生单流程实体列表。
     *
     * @param {?} upBillVoId 上游 VO Id。
     * @param {?} downBillVoId 下游 VO Id。
     * @return {?} 符合条件的单据流生单流程实体列表。
     */
    getSlimBillCreationProcessEntityExesByUpBillVoIdAndDownBillVoId4SpecificPush(upBillVoId, downBillVoId) {
        /** @type {?} */
        const args = new FormGetBillCreationProcessEntityExArgs();
        args.upBillVoId = upBillVoId;
        args.downBillVoId = downBillVoId;
        args.manualCreationMode = ManualCreationMode.SpecificPush;
        return this.getSlimBillCreationProcessEntityExes(args).pipe(map((/**
         * @param {?} res
         * @return {?}
         */
        (res) => {
            return res.billCreationProcessEntityExes;
        })), catchError((/**
         * @param {?} err
         * @return {?}
         */
        (err) => {
            try {
                if (typeof err.error == "string") {
                    err.error = JSON.parse(err.error);
                }
            }
            catch (e) {
            }
            throw err;
        })));
    }
    /**
     * 根据上游 VO Id和下游 VO Id获取单据流生单流程实体列表。
     *
     * @param {?} upBillVoId 上游 VO Id。
     * @param {?} downBillVoId 下游 VO Id。
     * @return {?} 符合条件的单据流生单流程实体列表。
     */
    getSlimBillCreationProcessEntityExesByUpBillVoIdAndDownBillVoId4SpecificPull(upBillVoId, downBillVoId) {
        /** @type {?} */
        const args = new FormGetBillCreationProcessEntityExArgs();
        args.upBillVoId = upBillVoId;
        args.downBillVoId = downBillVoId;
        args.manualCreationMode = ManualCreationMode.SpecificPull;
        return this.getSlimBillCreationProcessEntityExes(args).pipe(map((/**
         * @param {?} res
         * @return {?}
         */
        (res) => {
            return res.billCreationProcessEntityExes;
        })), catchError((/**
         * @param {?} err
         * @return {?}
         */
        (err) => {
            try {
                if (typeof err.error == "string") {
                    err.error = JSON.parse(err.error);
                }
            }
            catch (e) {
            }
            throw err;
        })));
    }
    /**
     * 获取单据流生单流程实体
     * @param {?} processId
     * @return {?}
     */
    getSlimBillCreationProcessEntityExById(processId) {
        /** @type {?} */
        let getCreationRuleById$ = null;
        if (this.httpService != null) {
            getCreationRuleById$ = (/** @type {?} */ (this.httpService.request(this.getBillCreationProcessEntityExByIdMethod, `${this.getBillCreationProcessEntityExByIdUrl}/${processId}`, {})));
        }
        else {
            getCreationRuleById$ = this.repository.proxy.request(`${this.getBillCreationProcessEntityExByIdUrl}/${processId}`, this.getBillCreationProcessEntityExByIdMethod, null);
        }
        return getCreationRuleById$;
    }
    /**
     * 获取表单配置实体
     * @param {?} formSettingsId
     * @return {?}
     */
    getFormSettingsById(formSettingsId) {
        if (formSettingsId == null || formSettingsId.trim() == "") {
            throw "FormSettingsId为空";
        }
        /** @type {?} */
        let formSettings$ = null;
        if (this.httpService != null) {
            formSettings$ = (/** @type {?} */ (this.httpService.request(this.generalTextMethod, `${this.generalTextUrl}/${formSettingsId}`, { responseType: "text" })));
        }
        else {
            formSettings$ = this.repository.proxy.request(`${this.generalTextUrl}/${formSettingsId}`, this.generalTextMethod, null, { responseType: "text" });
        }
        return formSettings$.pipe(map((/**
         * @param {?} data
         * @return {?}
         */
        (data) => {
            /** @type {?} */
            const generateText = new GeneralTextEntity();
            generateText.LoadFromJson(data);
            /** @type {?} */
            const formSettings = new FormSettings();
            formSettings.LoadFromJson(generateText.text);
            return formSettings;
        })), catchError((/**
         * @param {?} err
         * @return {?}
         */
        (err) => {
            try {
                if (typeof err.error == "string") {
                    err.error = JSON.parse(err.error);
                }
            }
            catch (e) {
            }
            throw err;
        })));
    }
    /**
     * 获取生单结果实体
     * @param {?} creationResultId
     * @return {?}
     */
    getCreationResultById(creationResultId) {
        if (creationResultId == null || creationResultId.trim() == "") {
            throw "creationResultId为空";
        }
        /** @type {?} */
        let creationResult$ = null;
        if (this.httpService != null) {
            creationResult$ = (/** @type {?} */ (this.httpService.request(this.generalTextMethod, `${this.generalTextUrl}/${creationResultId}`, { responseType: "text" })));
        }
        else {
            creationResult$ = this.repository.proxy.request(`${this.generalTextUrl}/${creationResultId}`, this.generalTextMethod, null, { responseType: "text" });
        }
        return creationResult$.pipe(map((/**
         * @param {?} data
         * @return {?}
         */
        (data) => {
            /** @type {?} */
            const generateText = new GeneralTextEntity();
            generateText.LoadFromJson(data);
            /** @type {?} */
            const creationResult = new FormBillCreationProcessExecutorResult();
            creationResult.LoadFromJson(generateText.text);
            return creationResult;
        })), catchError((/**
         * @param {?} err
         * @return {?}
         */
        (err) => {
            try {
                if (typeof err.error == "string") {
                    err.error = JSON.parse(err.error);
                }
            }
            catch (e) {
            }
            throw err;
        })));
    }
    /**
     * 生单结果存入中间表
     * @param {?} creationResult
     * @return {?}
     */
    addFormBillCreationProcessExecutorResult(creationResult) {
        if (creationResult == null) {
            throw "参数creationResult不可为空";
        }
        if (typeof creationResult == "string") {
            if (creationResult == "") {
                throw "参数creationResult不可为空";
            }
            /** @type {?} */
            const temp = new FormBillCreationProcessExecutorResult();
            temp.LoadFromJson(creationResult);
            creationResult = temp;
        }
        if ((creationResult instanceof FormBillCreationProcessExecutorResult) == false) {
            /** @type {?} */
            const res = new FormBillCreationProcessExecutorResult();
            res.LoadFromJsonObject(creationResult);
            creationResult = res;
        }
        if (creationResult.conditionResult.conditionExecutionResult == false) {
            this.messager.error(creationResult.conditionResult.message || this.localePipe.transform("creationExecutionError"));
            return;
        }
        if (creationResult.creationRuleExecutorResult == null || creationResult.creationRuleExecutorResult.mappingResults == null || creationResult.creationRuleExecutorResult.mappingResults.length == 0) {
            this.messager.error(this.localePipe.transform("creationResultEmpty"));
            return;
        }
        /** @type {?} */
        const body = creationResult.ConvertToJson();
        /** @type {?} */
        const options = {
            body: body,
            responseType: "text"
        };
        /** @type {?} */
        let creationResult$ = null;
        if (this.httpService != null) {
            creationResult$ = (/** @type {?} */ (this.httpService.request(this.generalTextCreationMethod, `${this.generalTextUrl}`, options)));
        }
        else {
            creationResult$ = this.repository.proxy.request(`${this.generalTextUrl}`, this.generalTextCreationMethod, null, options);
        }
        return creationResult$.pipe(map((/**
         * @param {?} data
         * @return {?}
         */
        (data) => {
            /** @type {?} */
            const texts = (/** @type {?} */ (BpmnModelJsonHelper.FromJson(data, GeneralTextIdWithDataId)));
            return texts;
        })), catchError((/**
         * @param {?} err
         * @return {?}
         */
        (err) => {
            try {
                if (typeof err.error == "string") {
                    err.error = JSON.parse(err.error);
                }
            }
            catch (e) {
            }
            throw err;
        })));
    }
    /**
     * 执行单据流生单流程
     * @param {?} args
     * @return {?}
     */
    executeBillCreationProcess(args) {
        if (args.manualCreationMode == null) {
            throw "manualCreationMode不可为空";
        }
        /** @type {?} */
        const body = args.ConvertToJson();
        /** @type {?} */
        const options = {
            body: body,
            responseType: "text"
        };
        /** @type {?} */
        let executeCreationRule$ = null;
        if (this.httpService != null) {
            executeCreationRule$ = this.httpService.request(this.executeBillCreationProcessMethod, this.executeBillCreationProcessUrl, options);
        }
        else {
            executeCreationRule$ = this.repository.proxy.request(this.executeBillCreationProcessUrl, this.executeBillCreationProcessMethod, null, options);
        }
        return executeCreationRule$.pipe(map((/**
         * @param {?} data
         * @return {?}
         */
        (data) => {
            /** @type {?} */
            const res = new FormBillCreationProcessExecutorResult();
            res.LoadFromJson(data);
            return res;
        })), catchError((/**
         * @param {?} err
         * @return {?}
         */
        (err) => {
            try {
                if (typeof err.error == "string") {
                    err.error = JSON.parse(err.error);
                }
            }
            catch (e) {
            }
            throw err;
        })));
    }
    /**
     * 创建单据
     * @param {?} args
     * @return {?}
     */
    createEntityDatas(args) {
        /** @type {?} */
        const body = args.ConvertToJson();
        /** @type {?} */
        const options = {
            body: body,
            responseType: 'text'
        };
        /** @type {?} */
        const create$ = this.repository.proxy.request(this.formCreateUrl, this.formCreateMethod, null, options);
        return create$.pipe(switchMap((/**
         * @param {?} res
         * @return {?}
         */
        (res) => {
            /** @type {?} */
            const result = new FormCreateResult();
            result.LoadFromJson(res);
            /** @type {?} */
            const entities = result.entityDataList.map((/**
             * @param {?} entityStr
             * @return {?}
             */
            (entityStr) => {
                /** @type {?} */
                const newEntity = this.repository.buildEntity(JSON.parse(entityStr));
                this.appendInitialData(newEntity, newEntity);
                return newEntity;
            }));
            /** @type {?} */
            let origin = this.repository.entityCollection.getAllEntities();
            if (origin == null || origin.length == 0) {
                this.repository.entityCollection.loadEntities(entities);
            }
            else {
                this.repository.entityCollection.addEntities(entities);
            }
            return of(result);
        })), catchError((/**
         * @param {?} err
         * @return {?}
         */
        (err) => {
            try {
                if (typeof err.error == "string") {
                    err.error = JSON.parse(err.error);
                }
            }
            catch (e) {
            }
            throw err;
        })));
    }
    /**
     * 修改单据
     * @param {?} args 表单更新参数
     * @return {?}
     */
    updateEntityDatas(args) {
        /** @type {?} */
        const body = args.ConvertToJson();
        /** @type {?} */
        const options = {
            body: body,
            responseType: "text"
        };
        /** @type {?} */
        const update$ = this.repository.proxy.request(this.formUpdateUrl, this.formUpdateMethod, null, options);
        return update$.pipe(map((/**
         * @param {?} data
         * @return {?}
         */
        (data) => {
            /** @type {?} */
            const res = new FormUpdateResult();
            res.LoadFromJson(data);
            return res;
        })), catchError((/**
         * @param {?} err
         * @return {?}
         */
        (err) => {
            try {
                if (typeof err.error == "string") {
                    err.error = JSON.parse(err.error);
                }
            }
            catch (e) {
            }
            throw err;
        })));
    }
    /**
     * 将生单结果推送至任务中心
     * @param {?} args 推送任务中心参数
     * @return {?}
     */
    pushTaskCenter(args) {
        /** @type {?} */
        const body = args.ConvertToJson();
        /** @type {?} */
        const options = {
            body: body,
            responseType: "text"
        };
        /** @type {?} */
        let update$ = null;
        if (this.httpService != null) {
            update$ = this.httpService.request(this.pushTaskMethod, this.pushTaskUrl, options);
        }
        else {
            update$ = this.repository.proxy.request(this.pushTaskUrl, this.pushTaskMethod, null, options);
        }
        return update$.pipe(catchError((/**
         * @param {?} err
         * @return {?}
         */
        (err) => {
            try {
                if (typeof err.error == "string") {
                    err.error = JSON.parse(err.error);
                }
            }
            catch (e) {
            }
            throw err;
        })));
    }
    /**
     * 获取VO序列化数据
     * @param {?} args
     * @return {?}
     */
    getEntityDatas(args) {
        /** @type {?} */
        const body = args.ConvertToJson();
        /** @type {?} */
        const options = {
            body: body,
            responseType: "text"
        };
        /** @type {?} */
        let datas$ = null;
        if (this.httpService != null) {
            datas$ = this.httpService.request(this.getEntityDatasMethod, this.getEntityDatasUrl, options);
        }
        else {
            datas$ = this.repository.proxy.request(this.getEntityDatasUrl, this.getEntityDatasMethod, null, options);
        }
        return datas$.pipe(catchError((/**
         * @param {?} err
         * @return {?}
         */
        (err) => {
            try {
                if (typeof err.error == "string") {
                    err.error = JSON.parse(err.error);
                }
            }
            catch (e) {
            }
            throw err;
        })));
    }
    /**
     * 查询单据生单流程扩展实体
     * @private
     * @param {?} args 查询参数
     * @return {?}
     */
    getSlimBillCreationProcessEntityExes(args) {
        if (args == null) {
            throw "args不可为空";
        }
        if (typeof args == "string") {
            if (args == "") {
                throw "args不可为空";
            }
            /** @type {?} */
            const temp = new FormGetBillCreationProcessEntityExArgs();
            temp.LoadFromJson(args);
            args = temp;
        }
        /** @type {?} */
        const options = { body: args.ConvertToJson(), responseType: "text" };
        /** @type {?} */
        let getEntity$ = null;
        if (this.httpService != null) {
            getEntity$ = this.httpService.request(this.getBillCreationProcessEntityExMethod, this.getBillCreationProcessEntityExUrl, options);
        }
        else {
            getEntity$ = this.repository.proxy.request(this.getBillCreationProcessEntityExUrl, this.getBillCreationProcessEntityExMethod, null, options);
        }
        return getEntity$.pipe(map((/**
         * @param {?} data
         * @return {?}
         */
        (data) => {
            /** @type {?} */
            const result = new FormGetBillCreationProcessEntityExResult();
            result.LoadFromJson(data);
            return result;
        })), catchError((/**
         * @param {?} err
         * @return {?}
         */
        (err) => {
            try {
                if (typeof err.error == "string") {
                    err.error = JSON.parse(err.error);
                }
            }
            catch (e) {
            }
            throw err;
        })));
    }
    /**
     * 参考farris/bef EntityUtil实现
     * @private
     * @param {?} entity
     * @param {?} initialData
     * @return {?}
     */
    appendInitialData(entity, initialData) {
        /** @type {?} */
        const data = Object.assign({}, initialData);
        delete data.id;
        delete data.parentID;
        entity['initialData'] = data;
    }
}
BifDataService.decorators = [
    { type: Injectable }
];
/** @nocollapse */
BifDataService.ctorParameters = () => [
    { type: HttpClient },
    { type: Repository },
    { type: Injector, decorators: [{ type: Optional }] },
    { type: ComponentFactoryResolver, decorators: [{ type: Optional }] },
    { type: NgModuleFactoryLoader, decorators: [{ type: Optional }] },
    { type: BsModalService, decorators: [{ type: Optional }] },
    { type: MessagerService, decorators: [{ type: Optional }] },
    { type: FrameContext, decorators: [{ type: Optional }] },
    { type: String, decorators: [{ type: Optional }, { type: Inject, args: [LOCALE_ID,] }] },
    { type: RuntimeFrameworkService, decorators: [{ type: Optional }] },
    { type: LocalePipe, decorators: [{ type: Optional }] },
    { type: HttpService, decorators: [{ type: Optional }] }
];
if (false) {
    /**
     * @type {?}
     * @private
     */
    BifDataService.prototype.getBillCreationProcessEntityExByIdUrl;
    /**
     * @type {?}
     * @private
     */
    BifDataService.prototype.getBillCreationProcessEntityExByIdMethod;
    /**
     * @type {?}
     * @private
     */
    BifDataService.prototype.getBillCreationProcessEntityExUrl;
    /**
     * @type {?}
     * @private
     */
    BifDataService.prototype.getBillCreationProcessEntityExMethod;
    /**
     * @type {?}
     * @private
     */
    BifDataService.prototype.executeBillCreationProcessUrl;
    /**
     * @type {?}
     * @private
     */
    BifDataService.prototype.executeBillCreationProcessMethod;
    /**
     * @type {?}
     * @private
     */
    BifDataService.prototype.formCreateUrl;
    /**
     * @type {?}
     * @private
     */
    BifDataService.prototype.formCreateMethod;
    /**
     * @type {?}
     * @private
     */
    BifDataService.prototype.formUpdateUrl;
    /**
     * @type {?}
     * @private
     */
    BifDataService.prototype.formUpdateMethod;
    /**
     * @type {?}
     * @private
     */
    BifDataService.prototype.generalTextUrl;
    /**
     * @type {?}
     * @private
     */
    BifDataService.prototype.generalTextMethod;
    /**
     * @type {?}
     * @private
     */
    BifDataService.prototype.generalTextCreationMethod;
    /**
     * @type {?}
     * @private
     */
    BifDataService.prototype.pushTaskUrl;
    /**
     * @type {?}
     * @private
     */
    BifDataService.prototype.pushTaskMethod;
    /**
     * @type {?}
     * @private
     */
    BifDataService.prototype.getEntityDatasUrl;
    /**
     * @type {?}
     * @private
     */
    BifDataService.prototype.getEntityDatasMethod;
    /**
     * @type {?}
     * @private
     */
    BifDataService.prototype.repository;
    /**
     * @type {?}
     * @private
     */
    BifDataService.prototype.httpClient;
    /** @type {?} */
    BifDataService.prototype.injector;
    /** @type {?} */
    BifDataService.prototype.cfr;
    /** @type {?} */
    BifDataService.prototype.loader;
    /** @type {?} */
    BifDataService.prototype.modal;
    /** @type {?} */
    BifDataService.prototype.messager;
    /** @type {?} */
    BifDataService.prototype.frameContext;
    /** @type {?} */
    BifDataService.prototype.localeId;
    /** @type {?} */
    BifDataService.prototype.runtimeFrameworkService;
    /** @type {?} */
    BifDataService.prototype.localePipe;
    /** @type {?} */
    BifDataService.prototype.httpService;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYmlmLWRhdGEuc2VydmljZS5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BlZHAtYmlmL3J1bnRpbWUtYXBpLyIsInNvdXJjZXMiOlsibGliL2JpZi1tYW51YWwtY3JlYXRpb24vc2VydmljZS9iaWYtZGF0YS5zZXJ2aWNlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7O0FBQUEsT0FBTyxFQUFFLHdCQUF3QixFQUFFLE1BQU0sRUFBRSxVQUFVLEVBQUUsUUFBUSxFQUFFLFNBQVMsRUFBRSxxQkFBcUIsRUFBRSxRQUFRLEVBQXNCLE1BQU0sZUFBZSxDQUFDO0FBQ3ZKLE9BQU8sRUFBRSxVQUFVLEdBQUcsTUFBTSxzQkFBc0IsQ0FBQztBQUNuRCxPQUFPLEVBQWMsRUFBRSxFQUFFLE1BQU0sTUFBTSxDQUFDO0FBQ3RDLE9BQU8sRUFBRSxVQUFVLEVBQUUsR0FBRyxFQUFFLFNBQVMsRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBRzVELE9BQU8sRUFBRSxVQUFVLEVBQVUsWUFBWSxFQUFFLE1BQU0sZ0JBQWdCLENBQUM7QUFFbEUsT0FBTyxFQUFFLG1CQUFtQixFQUFFLFlBQVksRUFBRSxNQUFNLHFCQUFxQixDQUFDO0FBQ3hFLE9BQU8sRUFBRSxpQkFBaUIsRUFBRSxNQUFNLHFCQUFxQixDQUFDO0FBR3hELE9BQU8sRUFBa0IsZ0JBQWdCLEVBQWtCLGdCQUFnQixFQUFFLE1BQU0sV0FBVyxDQUFDO0FBRS9GLE9BQU8sRUFBRSxzQ0FBc0MsRUFBRSxNQUFNLCtEQUErRCxDQUFDO0FBQ3ZILE9BQU8sRUFBRSx3Q0FBd0MsRUFBRSxNQUFNLGlFQUFpRSxDQUFDO0FBRTNILE9BQU8sRUFBRSxxQ0FBcUMsRUFBRSxNQUFNLHNCQUFzQixDQUFDO0FBQzdFLE9BQU8sRUFBRSxrQkFBa0IsRUFBRSxNQUFNLDJDQUEyQyxDQUFDO0FBRS9FLE9BQU8sRUFBRSx1QkFBdUIsRUFBRSxNQUFNLGNBQWMsQ0FBQztBQUN2RCxPQUFPLEVBQUUsdUJBQXVCLEVBQUUsTUFBTSwwQkFB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LENBQUMsUUFBUSxHQUFHLElBQUksQ0FBQyxRQUFRLElBQUksSUFBSSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLEdBQUcsQ0FBQyxlQUFlLEVBQUUsSUFBSSxDQUFDLENBQUM7UUFDakcsSUFBSSxDQUFDLFlBQVksR0FBRyxJQUFJLENBQUMsWUFBWSxJQUFJLElBQUksQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLFlBQVksQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxHQUFHLENBQUMsWUFBWSxFQUFFLElBQUksQ0FBQyxDQUFDO1FBQzFHLElBQUksQ0FBQyxRQUFRLEdBQUcsSUFBSSxDQUFDLFFBQVEsSUFBSSxJQUFJLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsR0FBRyxDQUFDLFNBQVMsRUFBRSxZQUFZLENBQUMsT0FBTyxDQUFDLGNBQWMsQ0FBQyxJQUFJLFFBQVEsQ0FBQyxDQUFDO1FBQ3ZJLElBQUksQ0FBQyx1QkFBdUIsR0FBRyxJQUFJLENBQUMsdUJBQXVCLElBQUksSUFBSSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsdUJBQXVCLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsR0FBRyxDQUFDLHVCQUF1QixFQUFFLElBQUksQ0FBQyxDQUFDO1FBQ3RKLElBQUksQ0FBQyxVQUFVLEdBQUcsSUFBSSxDQUFDLFVBQVUsSUFBSSxJQUFJLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxVQUFVLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsR0FBRyxDQUFDLFVBQVUsRUFBRSxJQUFJLFVBQVUsQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQztRQUMzSCxJQUFJLENBQUMsV0FBVyxHQUFHLElBQUksQ0FBQyxXQUFXLElBQUksSUFBSSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsV0FBVyxD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SUFDaEQsZ0NBQWdEOztJQUNoRCwrQkFBd0M7O0lBQ3hDLGtDQUE0Qzs7SUFDNUMsc0NBQTZDOztJQUM3QyxrQ0FBc0Q7O0lBQ3RELGlEQUFtRTs7SUFDbkUsb0NBQXlDOztJQUN6QyxxQ0FBMkMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb21wb25lbnRGYWN0b3J5UmVzb2x2ZXIsIEluamVjdCwgSW5qZWN0YWJsZSwgSW5qZWN0b3IsIExPQ0FMRV9JRCwgTmdNb2R1bGVGYWN0b3J5TG9hZGVyLCBPcHRpb25hbCwgUmVmbGVjdGl2ZUluamVjdG9yIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IEh0dHBDbGllbnQsIH0gZnJvbSAnQGFuZ3VsYXIvY29tbW9uL2h0dHAnO1xyXG5pbXBvcnQgeyBPYnNlcnZhYmxlLCBvZiB9IGZyb20gJ3J4anMnO1xyXG5pbXBvcnQgeyBjYXRjaEVycm9yLCBtYXAsIHN3aXRjaE1hcCB9IGZyb20gJ3J4anMvb3BlcmF0b3JzJztcclxuXHJcbmltcG9ydCB7IEJlZlJlcG9zaXRvcnkgfSBmcm9tICdAZmFycmlzL2JlZic7XHJcbmltcG9ydCB7IFJlcG9zaXRvcnksIEVudGl0eSwgRnJhbWVDb250ZXh0IH0gZnJvbSAnQGZhcnJpcy9kZXZraXQnO1xyXG5cclxuaW1wb3J0IHsgQnBtbk1vZGVsSnNvbkhlbHBlciwgRm9ybVNldHRpbmdzIH0gZnJvbSAnQGVkcC1iaWYvY29tbW9uLWFwaSc7XHJcbmltcG9ydCB7IEdlbmVyYWxUZXh0RW50aXR5IH0gZnJvbSAnQGVkcC1iaWYvY29tbW9uLWFwaSc7XHJcbmltcG9ydCB7IElSdFNsaW1CaWxsQ3JlYXRpb25Qcm9jZXNzRW50aXR5RXggfSBmcm9tICdAZWRwLWJpZi9jb21tb24tYXBpJztcclxuXHJcbmltcG9ydCB7IEZvcm1DcmVhdGVBcmdzLCBGb3JtQ3JlYXRlUmVzdWx0LCBGb3JtVXBkYXRlQXJncywgRm9ybVVwZGF0ZVJlc3VsdCB9IGZyb20gJy4uLy4uL3JlZic7XHJcblxyXG5pbXBvcnQgeyBGb3JtR2V0QmlsbENyZWF0aW9uUHJvY2Vzc0VudGl0eUV4QXJncyB9IGZyb20gJy4uLy4uL2VudGl0eS9mb3JtLXJlc3QvRm9ybUdldEJpbGxDcmVhdGlvblByb2Nlc3NFbnRpdHlFeEFyZ3MnO1xyXG5pbXBvcnQgeyBGb3JtR2V0QmlsbENyZWF0aW9uUHJvY2Vzc0VudGl0eUV4UmVzdWx0IH0gZnJvbSAnLi4vLi4vZW50aXR5L2Zvcm0tcmVzdC9Gb3JtR2V0QmlsbENyZWF0aW9uUHJvY2Vzc0VudGl0eUV4UmVzdWx0JztcclxuaW1wb3J0IHsgRm9ybUJpbGxDcmVhdGlvblByb2Nlc3NFeGVjdXRvckFyZ3MgfSBmcm9tICcuLi8uLi9lbnRpdHkvZm9ybS1yZXN0L0Zvcm1CaWxsQ3JlYXRpb25Qcm9jZXNzRXhlY3V0b3JBcmdzJztcclxuaW1wb3J0IHsgRm9ybUJpbGxDcmVhdGlvblByb2Nlc3NFeGVjdXRvclJlc3VsdCB9IGZyb20gJ0BlZHAtYWlmL3J1bnRpbWUtYXBpJztcclxuaW1wb3J0IHsgTWFudWFsQ3JlYXRpb25Nb2RlIH0gZnJvbSAnLi4vLi4vZW50aXR5L2Zvcm0tcmVzdC9NYW51YWxDcmVhdGlvbk1vZGUnO1xyXG5pbXBvcnQgeyBQdXNoVGFza0FyZ3MgfSBmcm9tICcuLi9hcmdzL1B1c2hUYXNrQXJncyc7XHJcbmltcG9ydCB7IEdlbmVyYWxUZXh0SWRXaXRoRGF0YUlkIH0gZnJvbSAnLi4vLi4vZW50aXR5JztcclxuaW1wb3J0IHsgUnVudGltZUZyYW1ld29ya1NlcnZpY2UgfSBmcm9tICdAZmFycmlzL2NvbW1hbmQtc2VydmljZXMnO1xyXG5pbXBvcnQgeyBCc01vZGFsU2VydmljZSB9IGZyb20gJ0BmYXJyaXMvdWktbW9kYWwnO1xyXG5pbXBvcnQgeyBNZXNzYWdlclNlcnZpY2UgfSBmcm9tICdAZmFycmlzL3VpLW1lc3NhZ2VyJztcclxuaW1wb3J0IHsgTG9jYWxlUGlwZSB9IGZyb20gJy4uL3BpcGUvbG9jYWxlLnBpcGUnO1xyXG5pbXBvcnQgeyBIdHRwU2VydmljZSB9IGZyb20gJ0BlY3AtY2FmL2NhZi1jb21tb24nO1xyXG5pbXBvcnQgeyBHZXRFbnRpdHlEYXRhc0FyZ3MgfSBmcm9tICcuLi9hcmdzL0dldEVudGl0eURhdGFzQXJncyc7XHJcblxyXG5ASW5qZWN0YWJsZSgpXHJcbmV4cG9ydCBjbGFzcyBCaWZEYXRhU2VydmljZSB7XHJcbiAgICBwcml2YXRlIHJlYWRvbmx5IGdldEJpbGxDcmVhdGlvblByb2Nlc3NFbnRpdHlFeEJ5SWRVcmwgPSBcIi9hcGkvcnVudGltZS9haWYvdjEuMC9tYW51YWxjcmVhdGlvbmJpbGwvZ2V0YmlsbGNyZWF0aW9ucHJvY2Vzc2VudGl0eWV4XCI7XHJcbiAgICBwcml2YXRlIHJlYWRvbmx5IGdldEJpbGxDcmVhdGlvblByb2Nlc3NFbnRpdHlFeEJ5SWRNZXRob2QgPSBcIkdFVFwiO1xyXG5cclxuICAgIHByaXZhdGUgcmVhZG9ubHkgZ2V0QmlsbENyZWF0aW9uUHJvY2Vzc0VudGl0eUV4VXJsOiBzdHJpbmcgPSBcIi9hcGkvcnVudGltZS9haWYvdjEuMC9tYW51YWxjcmVhdGlvbmJpbGwvZ2V0YmlsbGNyZWF0aW9ucHJvY2Vzc2VudGl0eWV4ZXNcIjtcclxuICAgIHByaXZhdGUgcmVhZG9ubHkgZ2V0QmlsbENyZWF0aW9uUHJvY2Vzc0VudGl0eUV4TWV0aG9kOiBzdHJpbmcgPSBcIlBPU1RcIjtcclxuXHJcbiAgICBwcml2YXRlIHJlYWRvbmx5IGV4ZWN1dGVCaWxsQ3JlYXRpb25Qcm9jZXNzVXJsOiBzdHJpbmcgPSBcIi9hcGkvcnVudGltZS9haWYvdjEuMC9tYW51YWxjcmVhdGlvbmJpbGwvZXhlY3V0ZWJpbGxjcmVhdGlvbnByb2Nlc3NcIjtcclxuICAgIHByaXZhdGUgcmVhZG9ubHkgZXhlY3V0ZUJpbGxDcmVhdGlvblByb2Nlc3NNZXRob2Q6IHN0cmluZyA9IFwiUE9TVFwiO1xyXG5cclxuICAgIHByaXZhdGUgcmVhZG9ubHkgZm9ybUNyZWF0ZVVybDogc3RyaW5nID0gXCIvYXBpL3J1bnRpbWUvYWlmL3YxLjAvZm9ybS9jcmVhdGVcIjtcclxuICAgIHByaXZhdGUgcmVhZG9ubHkgZm9ybUNyZWF0ZU1ldGhvZDogc3RyaW5nID0gXCJQT1NUXCI7XHJcblxyXG4gICAgcHJpdmF0ZSByZWFkb25seSBmb3JtVXBkYXRlVXJsOiBzdHJpbmcgPSBcIi9hcGkvcnVudGltZS9haWYvdjEuMC9mb3JtL3VwZGF0ZVwiO1xyXG4gICAgcHJpdmF0ZSByZWFkb25seSBmb3JtVXBkYXRlTWV0aG9kOiBzdHJpbmcgPSBcIlBPU1RcIjtcclxuXHJcbiAgICBwcml2YXRlIHJlYWRvbmx5IGdlbmVyYWxUZXh0VXJsOiBzdHJpbmcgPSBcIi9hcGkvcnVudGltZS9haWYvdjEuMC9nZW5lcmFsdGV4dFwiO1xyXG4gICAgcHJpdmF0ZSByZWFkb25seSBnZW5lcmFsVGV4dE1ldGhvZDogc3RyaW5nID0gXCJHRVRcIjtcclxuICAgIHByaXZhdGUgcmVhZG9ubHkgZ2VuZXJhbFRleHRDcmVhdGlvbk1ldGhvZDogc3RyaW5nID0gXCJQT1NUXCI7XHJcblxyXG4gICAgcHJpdmF0ZSByZWFkb25seSBwdXNoVGFza1VybDogc3RyaW5nID0gXCIvYXBpL3J1bnRpbWUvYWlmL3YxLjAvbWFudWFsY3JlYXRpb25iaWxsL3B1c2h0YXNrXCI7XHJcbiAgICBwcml2YXRlIHJlYWRvbmx5IHB1c2hUYXNrTWV0aG9kOiBzdHJpbmcgPSBcIlBPU1RcIjtcclxuXHJcbiAgICBwcml2YXRlIHJlYWRvbmx5IGdldEVudGl0eURhdGFzVXJsOiBzdHJpbmcgPSBcIi9hcGkvcnVudGltZS9haWYvdjEuMC9tYW51YWxjcmVhdGlvbmJpbGwvZ2V0ZW50aXR5ZGF0YXNcIjtcclxuICAgIHByaXZhdGUgcmVhZG9ubHkgZ2V0RW50aXR5RGF0YXNNZXRob2Q6IHN0cmluZyA9IFwiUE9TVFwiO1xyXG5cclxuICAgIHByaXZhdGUgcmVwb3NpdG9yeTogQmVmUmVwb3NpdG9yeTxFbnRpdHk+O1xyXG4gICAgY29uc3RydWN0b3IoXHJcbiAgICAgICAgcHJpdmF0ZSBodHRwQ2xpZW50OiBIdHRwQ2xpZW50LFxyXG4gICAgICAgIHJlcG9zaXRvcnk6IFJlcG9zaXRvcnk8RW50aXR5PixcclxuICAgICAgICBAT3B0aW9uYWwoKSBwdWJsaWMgaW5qZWN0b3I6IEluamVjdG9yLFxyXG4gICAgICAgIEBPcHRpb25hbCgpIHB1YmxpYyBjZnI6IENvbXBvbmVudEZhY3RvcnlSZXNvbHZlcixcclxuICAgICAgICBAT3B0aW9uYWwoKSBwdWJsaWMgbG9hZGVyOiBOZ01vZHVsZUZhY3RvcnlMb2FkZXIsXHJcbiAgICAgICAgQE9wdGlvbmFsKCkgcHVibGljIG1vZGFsOiBCc01vZGFsU2VydmljZSxcclxuICAgICAgICBAT3B0aW9uYWwoKSBwdWJsaWMgbWVzc2FnZXI6IE1lc3NhZ2VyU2VydmljZSxcclxuICAgICAgICBAT3B0aW9uYWwoKSBwdWJsaWMgZnJhbWVDb250ZXh0OiBGcmFtZUNvbnRleHQsXHJcbiAgICAgICAgQE9wdGlvbmFsKCkgQEluamVjdChMT0NBTEVfSUQpIHB1YmxpYyBsb2NhbGVJZDogc3RyaW5nLFxyXG4gICAgICAgIEBPcHRpb25hbCgpIHB1YmxpYyBydW50aW1lRnJhbWV3b3JrU2VydmljZTogUnVudGltZUZyYW1ld29ya1NlcnZpY2UsXHJcbiAgICAgICAgQE9wdGlvbmFsKCkgcHVibGljIGxvY2FsZVBpcGU6IExvY2FsZVBpcGUsXHJcbiAgICAgICAgQE9wdGlvbmFsKCkgcHVibGljIGh0dHBTZXJ2aWNlOiBIdHRwU2VydmljZSxcclxuICAgICkge1xyXG4gICAgICAgIHRoaXMucmVwb3NpdG9yeSA9IHJlcG9zaXRvcnkgYXMgQmVmUmVwb3NpdG9yeTxFbnRpdHk+O1xyXG4gICAgICAgIHRoaXMuaW5qZWN0b3IgPSB0aGlzLmluamVjdG9yICE9IG51bGwgPyB0aGlzLmluamVjdG9yIDogdGhpcy5yZXBvc2l0b3J5LmFwcENvbnRleHQuaW5qZWN0b3I7XHJcbiAgICAgICAgdGhpcy5jZnIgPSB0aGlzLmNmciAhPSBudWxsID8gdGhpcy5jZnIgOiB0aGlzLmluamVjdG9yLmdldChDb21wb25lbnRGYWN0b3J5UmVzb2x2ZXIsIG51bGwpO1xyXG4gICAgICAgIHRoaXMubG9hZGVyID0gdGhpcy5sb2FkZXIgIT0gbnVsbCA/IHRoaXMubG9hZGVyIDogdGhpcy5pbmplY3Rvci5nZXQoTmdNb2R1bGVGYWN0b3J5TG9hZGVyLCBudWxsKTtcclxuICAgICAgICB0aGlzLm1vZGFsID0gdGhpcy5tb2RhbCAhPSBudWxsID8gdGhpcy5tb2RhbCA6IHRoaXMuaW5qZWN0b3IuZ2V0KEJzTW9kYWxTZXJ2aWNlLCBudWxsKTtcclxuICAgICAgICB0aGlzLm1lc3NhZ2VyID0gdGhpcy5tZXNzYWdlciAhPSBudWxsID8gdGhpcy5tZXNzYWdlciA6IHRoaXMuaW5qZWN0b3IuZ2V0KE1lc3NhZ2VyU2VydmljZSwgbnVsbCk7XHJcbiAgICAgICAgdGhpcy5mcmFtZUNvbnRleHQgPSB0aGlzLmZyYW1lQ29udGV4dCAhPSBudWxsID8gdGhpcy5mcmFtZUNvbnRleHQgOiB0aGlzLmluamVjdG9yLmdldChGcmFtZUNvbnRleHQsIG51bGwpO1xyXG4gICAgICAgIHRoaXMubG9jYWxlSWQgPSB0aGlzLmxvY2FsZUlkICE9IG51bGwgPyB0aGlzLmxvY2FsZUlkIDogdGhpcy5pbmplY3Rvci5nZXQoTE9DQUxFX0lELCBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnbGFuZ3VhZ2VDb2RlJykgfHwgJ3poLUNIUycpO1xyXG4gICAgICAgIHRoaXMucnVudGltZUZyYW1ld29ya1NlcnZpY2UgPSB0aGlzLnJ1bnRpbWVGcmFtZXdvcmtTZXJ2aWNlICE9IG51bGwgPyB0aGlzLnJ1bnRpbWVGcmFtZXdvcmtTZXJ2aWNlIDogdGhpcy5pbmplY3Rvci5nZXQoUnVudGltZUZyYW1ld29ya1NlcnZpY2UsIG51bGwpO1xyXG4gICAgICAgIHRoaXMubG9jYWxlUGlwZSA9IHRoaXMubG9jYWxlUGlwZSAhPSBudWxsID8gdGhpcy5sb2NhbGVQaXBlIDogdGhpcy5pbmplY3Rvci5nZXQoTG9jYWxlUGlwZSwgbmV3IExvY2FsZVBpcGUodGhpcy5sb2NhbGVJZCkpO1xyXG4gICAgICAgIHRoaXMuaHR0cFNlcnZpY2UgPSB0aGlzLmh0dHBTZXJ2aWNlICE9IG51bGwgPyB0aGlzLmh0dHBTZXJ2aWNlIDogdGhpcy5pbmplY3Rvci5nZXQoSHR0cFNlcnZpY2UsIG51bGwpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog5qC55o2u5LiK5ri4IFZPIElk6I635Y+W5Y2V5o2u5rWB55Sf5Y2V5rWB56iL5a6e5L2T5YiX6KGo44CCXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHVwQmlsbFZvSWQg5LiK5ri4IFZPIElk44CCXHJcbiAgICAgKiBAcmV0dXJuIOespuWQiOadoeS7tueahOWNleaNrua1geeUn+WNlea1geeoi+WunuS9k+WIl+ihqOOAglxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgZ2V0U2xpbUJpbGxDcmVhdGlvblByb2Nlc3NFbnRpdHlFeGVzQnlVcEJpbGxWb0lkNFB1c2godXBCaWxsVm9JZDogc3RyaW5nKTogT2JzZXJ2YWJsZTxJUnRTbGltQmlsbENyZWF0aW9uUHJvY2Vzc0VudGl0eUV4W10+IHtcclxuICAgICAgICBjb25zdCBhcmdzID0gbmV3IEZvcm1HZXRCaWxsQ3JlYXRpb25Qcm9jZXNzRW50aXR5RXhBcmdzKCk7XHJcbiAgICAgICAgYXJncy51cEJpbGxWb0lkID0gdXBCaWxsVm9JZDtcclxuICAgICAgICBhcmdzLm1hbnVhbENyZWF0aW9uTW9kZSA9IE1hbnVhbENyZWF0aW9uTW9kZS5QdXNoO1xyXG4gICAgICAgIHJldHVybiB0aGlzLmdldFNsaW1CaWxsQ3JlYXRpb25Qcm9jZXNzRW50aXR5RXhlcyhhcmdzKS5waXBlKFxyXG4gICAgICAgICAgICBtYXAoXHJcbiAgICAgICAgICAgICAgICAocmVzOiBGb3JtR2V0QmlsbENyZWF0aW9uUHJvY2Vzc0VudGl0eUV4UmVzdWx0KSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlcy5iaWxsQ3JlYXRpb25Qcm9jZXNzRW50aXR5RXhlcztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgKVxyXG4gICAgICAgICk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDmoLnmja7kuIvmuLggVk8gSWTojrflj5bljZXmja7mtYHnlJ/ljZXmtYHnqIvlrp7kvZPliJfooajjgIJcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gZG93bkJpbGxWb0lkIOS4i+a4uCBWTyBJZOOAglxyXG4gICAgICogQHJldHVybiDnrKblkIjmnaHku7bnmoTljZXmja7mtYHnlJ/ljZXmtYHnqIvlrp7kvZPliJfooajjgIJcclxuICAgICAqL1xyXG4gICAgcHVibGljIGdldFNsaW1CaWxsQ3JlYXRpb25Qcm9jZXNzRW50aXR5RXhlc0J5RG93bkJpbGxWb0lkNFB1bGwoZG93bkJpbGxWb0lkOiBzdHJpbmcpOiBPYnNlcnZhYmxlPElSdFNsaW1CaWxsQ3JlYXRpb25Qcm9jZXNzRW50aXR5RXhbXT4ge1xyXG4gICAgICAgIGNvbnN0IGFyZ3MgPSBuZXcgRm9ybUdldEJpbGxDcmVhdGlvblByb2Nlc3NFbnRpdHlFeEFyZ3MoKTtcclxuICAgICAgICBhcmdzLmRvd25CaWxsVm9JZCA9IGRvd25CaWxsVm9JZDtcclxuICAgICAgICBhcmdzLm1hbnVhbENyZWF0aW9uTW9kZSA9IE1hbnVhbENyZWF0aW9uTW9kZS5QdWxsO1xyXG4gICAgICAgIHJldHVybiB0aGlzLmdldFNsaW1CaWxsQ3JlYXRpb25Qcm9jZXNzRW50aXR5RXhlcyhhcmdzKS5waXBlKFxyXG4gICAgICAgICAgICBtYXAoXHJcbiAgICAgICAgICAgICAgICAocmVzOiBGb3JtR2V0QmlsbENyZWF0aW9uUHJvY2Vzc0VudGl0eUV4UmVzdWx0KSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlcy5iaWxsQ3JlYXRpb25Qcm9jZXNzRW50aXR5RXhlcztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgKSxcclxuICAgICAgICAgICAgY2F0Y2hFcnJvcihcclxuICAgICAgICAgICAgICAgIChlcnI6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgZXJyLmVycm9yID09IFwic3RyaW5nXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVyci5lcnJvciA9IEpTT04ucGFyc2UoZXJyLmVycm9yKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IGVycjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgKVxyXG4gICAgICAgICk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDmoLnmja7kuIrmuLggVk8gSWTlkozkuIvmuLggVk8gSWTojrflj5bljZXmja7mtYHnlJ/ljZXmtYHnqIvlrp7kvZPliJfooajjgIJcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gdXBCaWxsVm9JZCDkuIrmuLggVk8gSWTjgIJcclxuICAgICAqIEBwYXJhbSBkb3duQmlsbFZvSWQg5LiL5ri4IFZPIElk44CCXHJcbiAgICAgKiBAcmV0dXJuIOespuWQiOadoeS7tueahOWNleaNrua1geeUn+WNlea1geeoi+WunuS9k+WIl+ihqOOAglxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgZ2V0U2xpbUJpbGxDcmVhdGlvblByb2Nlc3NFbnRpdHlFeGVzQnlVcEJpbGxWb0lkQW5kRG93bkJpbGxWb0lkNFNwZWNpZmljUHVzaCh1cEJpbGxWb0lkOiBzdHJpbmcsIGRvd25CaWxsVm9JZDogc3RyaW5nKTogT2JzZXJ2YWJsZTxJUnRTbGltQmlsbENyZWF0aW9uUHJvY2Vzc0VudGl0eUV4W10+IHtcclxuICAgICAgICBjb25zdCBhcmdzID0gbmV3IEZvcm1HZXRCaWxsQ3JlYXRpb25Qcm9jZXNzRW50aXR5RXhBcmdzKCk7XHJcbiAgICAgICAgYXJncy51cEJpbGxWb0lkID0gdXBCaWxsVm9JZDtcclxuICAgICAgICBhcmdzLmRvd25CaWxsVm9JZCA9IGRvd25CaWxsVm9JZDtcclxuICAgICAgICBhcmdzLm1hbnVhbENyZWF0aW9uTW9kZSA9IE1hbnVhbENyZWF0aW9uTW9kZS5TcGVjaWZpY1B1c2g7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0U2xpbUJpbGxDcmVhdGlvblByb2Nlc3NFbnRpdHlFeGVzKGFyZ3MpLnBpcGUoXHJcbiAgICAgICAgICAgIG1hcChcclxuICAgICAgICAgICAgICAgIChyZXM6IEZvcm1HZXRCaWxsQ3JlYXRpb25Qcm9jZXNzRW50aXR5RXhSZXN1bHQpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzLmJpbGxDcmVhdGlvblByb2Nlc3NFbnRpdHlFeGVzO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICApLFxyXG4gICAgICAgICAgICBjYXRjaEVycm9yKFxyXG4gICAgICAgICAgICAgICAgKGVycjogYW55KSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBlcnIuZXJyb3IgPT0gXCJzdHJpbmdcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyLmVycm9yID0gSlNPTi5wYXJzZShlcnIuZXJyb3IpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgZXJyO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICApXHJcbiAgICAgICAgKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOagueaNruS4iua4uCBWTyBJZOWSjOS4i+a4uCBWTyBJZOiOt+WPluWNleaNrua1geeUn+WNlea1geeoi+WunuS9k+WIl+ihqOOAglxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB1cEJpbGxWb0lkIOS4iua4uCBWTyBJZOOAglxyXG4gICAgICogQHBhcmFtIGRvd25CaWxsVm9JZCDkuIvmuLggVk8gSWTjgIJcclxuICAgICAqIEByZXR1cm4g56ym5ZCI5p2h5Lu255qE5Y2V5o2u5rWB55Sf5Y2V5rWB56iL5a6e5L2T5YiX6KGo44CCXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBnZXRTbGltQmlsbENyZWF0aW9uUHJvY2Vzc0VudGl0eUV4ZXNCeVVwQmlsbFZvSWRBbmREb3duQmlsbFZvSWQ0U3BlY2lmaWNQdWxsKHVwQmlsbFZvSWQ6IHN0cmluZywgZG93bkJpbGxWb0lkOiBzdHJpbmcpOiBPYnNlcnZhYmxlPElSdFNsaW1CaWxsQ3JlYXRpb25Qcm9jZXNzRW50aXR5RXhbXT4ge1xyXG4gICAgICAgIGNvbnN0IGFyZ3MgPSBuZXcgRm9ybUdldEJpbGxDcmVhdGlvblByb2Nlc3NFbnRpdHlFeEFyZ3MoKTtcclxuICAgICAgICBhcmdzLnVwQmlsbFZvSWQgPSB1cEJpbGxWb0lkO1xyXG4gICAgICAgIGFyZ3MuZG93bkJpbGxWb0lkID0gZG93bkJpbGxWb0lkO1xyXG4gICAgICAgIGFyZ3MubWFudWFsQ3JlYXRpb25Nb2RlID0gTWFudWFsQ3JlYXRpb25Nb2RlLlNwZWNpZmljUHVsbDtcclxuICAgICAgICByZXR1cm4gdGhpcy5nZXRTbGltQmlsbENyZWF0aW9uUHJvY2Vzc0VudGl0eUV4ZXMoYXJncykucGlwZShcclxuICAgICAgICAgICAgbWFwKFxyXG4gICAgICAgICAgICAgICAgKHJlczogRm9ybUdldEJpbGxDcmVhdGlvblByb2Nlc3NFbnRpdHlFeFJlc3VsdCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiByZXMuYmlsbENyZWF0aW9uUHJvY2Vzc0VudGl0eUV4ZXM7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICksXHJcbiAgICAgICAgICAgIGNhdGNoRXJyb3IoXHJcbiAgICAgICAgICAgICAgICAoZXJyOiBhbnkpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGVyci5lcnJvciA9PSBcInN0cmluZ1wiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnIuZXJyb3IgPSBKU09OLnBhcnNlKGVyci5lcnJvcik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBlcnI7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIClcclxuICAgICAgICApO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog6I635Y+W5Y2V5o2u5rWB55Sf5Y2V5rWB56iL5a6e5L2TXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBnZXRTbGltQmlsbENyZWF0aW9uUHJvY2Vzc0VudGl0eUV4QnlJZChwcm9jZXNzSWQ6IHN0cmluZyk6IE9ic2VydmFibGU8SVJ0U2xpbUJpbGxDcmVhdGlvblByb2Nlc3NFbnRpdHlFeD4ge1xyXG4gICAgICAgIGxldCBnZXRDcmVhdGlvblJ1bGVCeUlkJDogT2JzZXJ2YWJsZTxJUnRTbGltQmlsbENyZWF0aW9uUHJvY2Vzc0VudGl0eUV4PiA9IG51bGw7XHJcbiAgICAgICAgaWYgKHRoaXMuaHR0cFNlcnZpY2UgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICBnZXRDcmVhdGlvblJ1bGVCeUlkJCA9IHRoaXMuaHR0cFNlcnZpY2UucmVxdWVzdCh0aGlzLmdldEJpbGxDcmVhdGlvblByb2Nlc3NFbnRpdHlFeEJ5SWRNZXRob2QsIGAke3RoaXMuZ2V0QmlsbENyZWF0aW9uUHJvY2Vzc0VudGl0eUV4QnlJZFVybH0vJHtwcm9jZXNzSWR9YCwge30pIGFzIGFueTtcclxuXHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgZ2V0Q3JlYXRpb25SdWxlQnlJZCQgPSB0aGlzLnJlcG9zaXRvcnkucHJveHkucmVxdWVzdChgJHt0aGlzLmdldEJpbGxDcmVhdGlvblByb2Nlc3NFbnRpdHlFeEJ5SWRVcmx9LyR7cHJvY2Vzc0lkfWAsIHRoaXMuZ2V0QmlsbENyZWF0aW9uUHJvY2Vzc0VudGl0eUV4QnlJZE1ldGhvZCwgbnVsbCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBnZXRDcmVhdGlvblJ1bGVCeUlkJDtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOiOt+WPluihqOWNlemFjee9ruWunuS9k1xyXG4gICAgICogQHBhcmFtIGZvcm1TZXR0aW5nc0lkIFxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgZ2V0Rm9ybVNldHRpbmdzQnlJZChmb3JtU2V0dGluZ3NJZDogc3RyaW5nKTogT2JzZXJ2YWJsZTxGb3JtU2V0dGluZ3M+IHtcclxuICAgICAgICBpZiAoZm9ybVNldHRpbmdzSWQgPT0gbnVsbCB8fCBmb3JtU2V0dGluZ3NJZC50cmltKCkgPT0gXCJcIikge1xyXG4gICAgICAgICAgICB0aHJvdyBcIkZvcm1TZXR0aW5nc0lk5Li656m6XCI7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBsZXQgZm9ybVNldHRpbmdzJDogT2JzZXJ2YWJsZTxzdHJpbmc+ID0gbnVsbDtcclxuICAgICAgICBpZiAodGhpcy5odHRwU2VydmljZSAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgIGZvcm1TZXR0aW5ncyQgPSB0aGlzLmh0dHBTZXJ2aWNlLnJlcXVlc3QodGhpcy5nZW5lcmFsVGV4dE1ldGhvZCwgYCR7dGhpcy5nZW5lcmFsVGV4dFVybH0vJHtmb3JtU2V0dGluZ3NJZH1gLCB7IHJlc3BvbnNlVHlwZTogXCJ0ZXh0XCIgfSkgYXMgYW55O1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGZvcm1TZXR0aW5ncyQgPSB0aGlzLnJlcG9zaXRvcnkucHJveHkucmVxdWVzdChgJHt0aGlzLmdlbmVyYWxUZXh0VXJsfS8ke2Zvcm1TZXR0aW5nc0lkfWAsIHRoaXMuZ2VuZXJhbFRleHRNZXRob2QsIG51bGwsIHsgcmVzcG9uc2VUeXBlOiBcInRleHRcIiB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGZvcm1TZXR0aW5ncyQucGlwZShcclxuICAgICAgICAgICAgbWFwKFxyXG4gICAgICAgICAgICAgICAgKGRhdGE6IHN0cmluZykgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGdlbmVyYXRlVGV4dCA9IG5ldyBHZW5lcmFsVGV4dEVudGl0eSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIGdlbmVyYXRlVGV4dC5Mb2FkRnJvbUpzb24oZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZm9ybVNldHRpbmdzID0gbmV3IEZvcm1TZXR0aW5ncygpO1xyXG4gICAgICAgICAgICAgICAgICAgIGZvcm1TZXR0aW5ncy5Mb2FkRnJvbUpzb24oZ2VuZXJhdGVUZXh0LnRleHQpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmb3JtU2V0dGluZ3M7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICksXHJcbiAgICAgICAgICAgIGNhdGNoRXJyb3IoXHJcbiAgICAgICAgICAgICAgICAoZXJyOiBhbnkpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGVyci5lcnJvciA9PSBcInN0cmluZ1wiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnIuZXJyb3IgPSBKU09OLnBhcnNlKGVyci5lcnJvcik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBlcnI7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIClcclxuICAgICAgICApO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog6I635Y+W55Sf5Y2V57uT5p6c5a6e5L2TXHJcbiAgICAgKiBAcGFyYW0gY3JlYXRpb25SZXN1bHRJZCBcclxuICAgICAqL1xyXG4gICAgcHVibGljIGdldENyZWF0aW9uUmVzdWx0QnlJZChjcmVhdGlvblJlc3VsdElkOiBzdHJpbmcpOiBPYnNlcnZhYmxlPEZvcm1CaWxsQ3JlYXRpb25Qcm9jZXNzRXhlY3V0b3JSZXN1bHQ+IHtcclxuICAgICAgICBpZiAoY3JlYXRpb25SZXN1bHRJZCA9PSBudWxsIHx8IGNyZWF0aW9uUmVzdWx0SWQudHJpbSgpID09IFwiXCIpIHtcclxuICAgICAgICAgICAgdGhyb3cgXCJjcmVhdGlvblJlc3VsdElk5Li656m6XCI7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBsZXQgY3JlYXRpb25SZXN1bHQkOiBPYnNlcnZhYmxlPHN0cmluZz4gPSBudWxsO1xyXG4gICAgICAgIGlmICh0aGlzLmh0dHBTZXJ2aWNlICE9IG51bGwpIHtcclxuICAgICAgICAgICAgY3JlYXRpb25SZXN1bHQkID0gdGhpcy5odHRwU2VydmljZS5yZXF1ZXN0KHRoaXMuZ2VuZXJhbFRleHRNZXRob2QsIGAke3RoaXMuZ2VuZXJhbFRleHRVcmx9LyR7Y3JlYXRpb25SZXN1bHRJZH1gLCB7IHJlc3BvbnNlVHlwZTogXCJ0ZXh0XCIgfSkgYXMgYW55O1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGNyZWF0aW9uUmVzdWx0JCA9IHRoaXMucmVwb3NpdG9yeS5wcm94eS5yZXF1ZXN0KGAke3RoaXMuZ2VuZXJhbFRleHRVcmx9LyR7Y3JlYXRpb25SZXN1bHRJZH1gLCB0aGlzLmdlbmVyYWxUZXh0TWV0aG9kLCBudWxsLCB7IHJlc3BvbnNlVHlwZTogXCJ0ZXh0XCIgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBjcmVhdGlvblJlc3VsdCQucGlwZShcclxuICAgICAgICAgICAgbWFwKFxyXG4gICAgICAgICAgICAgICAgKGRhdGE6IHN0cmluZykgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGdlbmVyYXRlVGV4dCA9IG5ldyBHZW5lcmFsVGV4dEVudGl0eSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIGdlbmVyYXRlVGV4dC5Mb2FkRnJvbUpzb24oZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgY3JlYXRpb25SZXN1bHQgPSBuZXcgRm9ybUJpbGxDcmVhdGlvblByb2Nlc3NFeGVjdXRvclJlc3VsdCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNyZWF0aW9uUmVzdWx0LkxvYWRGcm9tSnNvbihnZW5lcmF0ZVRleHQudGV4dCk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNyZWF0aW9uUmVzdWx0O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICApLFxyXG4gICAgICAgICAgICBjYXRjaEVycm9yKFxyXG4gICAgICAgICAgICAgICAgKGVycjogYW55KSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBlcnIuZXJyb3IgPT0gXCJzdHJpbmdcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyLmVycm9yID0gSlNPTi5wYXJzZShlcnIuZXJyb3IpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgZXJyO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICApXHJcbiAgICAgICAgKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOeUn+WNlee7k+aenOWtmOWFpeS4remXtOihqFxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgYWRkRm9ybUJpbGxDcmVhdGlvblByb2Nlc3NFeGVjdXRvclJlc3VsdChjcmVhdGlvblJlc3VsdDogRm9ybUJpbGxDcmVhdGlvblByb2Nlc3NFeGVjdXRvclJlc3VsdCk6IE9ic2VydmFibGU8R2VuZXJhbFRleHRJZFdpdGhEYXRhSWRbXT4ge1xyXG4gICAgICAgIGlmIChjcmVhdGlvblJlc3VsdCA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHRocm93IFwi5Y+C5pWwY3JlYXRpb25SZXN1bHTkuI3lj6/kuLrnqbpcIjtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHR5cGVvZiBjcmVhdGlvblJlc3VsdCA9PSBcInN0cmluZ1wiKSB7XHJcbiAgICAgICAgICAgIGlmIChjcmVhdGlvblJlc3VsdCA9PSBcIlwiKSB7XHJcbiAgICAgICAgICAgICAgICB0aHJvdyBcIuWPguaVsGNyZWF0aW9uUmVzdWx05LiN5Y+v5Li656m6XCI7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY29uc3QgdGVtcCA9IG5ldyBGb3JtQmlsbENyZWF0aW9uUHJvY2Vzc0V4ZWN1dG9yUmVzdWx0KCk7XHJcbiAgICAgICAgICAgIHRlbXAuTG9hZEZyb21Kc29uKGNyZWF0aW9uUmVzdWx0KTtcclxuICAgICAgICAgICAgY3JlYXRpb25SZXN1bHQgPSB0ZW1wO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoKGNyZWF0aW9uUmVzdWx0IGluc3RhbmNlb2YgRm9ybUJpbGxDcmVhdGlvblByb2Nlc3NFeGVjdXRvclJlc3VsdCkgPT0gZmFsc2UpIHtcclxuICAgICAgICAgICAgY29uc3QgcmVzID0gbmV3IEZvcm1CaWxsQ3JlYXRpb25Qcm9jZXNzRXhlY3V0b3JSZXN1bHQoKTtcclxuICAgICAgICAgICAgcmVzLkxvYWRGcm9tSnNvbk9iamVjdChjcmVhdGlvblJlc3VsdCk7XHJcbiAgICAgICAgICAgIGNyZWF0aW9uUmVzdWx0ID0gcmVzO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKGNyZWF0aW9uUmVzdWx0LmNvbmRpdGlvblJlc3VsdC5jb25kaXRpb25FeGVjdXRpb25SZXN1bHQgPT0gZmFsc2UpIHtcclxuICAgICAgICAgICAgdGhpcy5tZXNzYWdlci5lcnJvcihjcmVhdGlvblJlc3VsdC5jb25kaXRpb25SZXN1bHQubWVzc2FnZSB8fCB0aGlzLmxvY2FsZVBpcGUudHJhbnNmb3JtKFwiY3JlYXRpb25FeGVjdXRpb25FcnJvclwiKSk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChjcmVhdGlvblJlc3VsdC5jcmVhdGlvblJ1bGVFeGVjdXRvclJlc3VsdCA9PSBudWxsIHx8IGNyZWF0aW9uUmVzdWx0LmNyZWF0aW9uUnVsZUV4ZWN1dG9yUmVzdWx0Lm1hcHBpbmdSZXN1bHRzID09IG51bGwgfHwgY3JlYXRpb25SZXN1bHQuY3JlYXRpb25SdWxlRXhlY3V0b3JSZXN1bHQubWFwcGluZ1Jlc3VsdHMubGVuZ3RoID09IDApIHtcclxuICAgICAgICAgICAgdGhpcy5tZXNzYWdlci5lcnJvcih0aGlzLmxvY2FsZVBpcGUudHJhbnNmb3JtKFwiY3JlYXRpb25SZXN1bHRFbXB0eVwiKSk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgYm9keSA9IGNyZWF0aW9uUmVzdWx0LkNvbnZlcnRUb0pzb24oKTtcclxuICAgICAgICBjb25zdCBvcHRpb25zID0ge1xyXG4gICAgICAgICAgICBib2R5OiBib2R5LFxyXG4gICAgICAgICAgICByZXNwb25zZVR5cGU6IFwidGV4dFwiXHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgbGV0IGNyZWF0aW9uUmVzdWx0JDogT2JzZXJ2YWJsZTxzdHJpbmc+ID0gbnVsbDtcclxuICAgICAgICBpZiAodGhpcy5odHRwU2VydmljZSAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgIGNyZWF0aW9uUmVzdWx0JCA9IHRoaXMuaHR0cFNlcnZpY2UucmVxdWVzdCh0aGlzLmdlbmVyYWxUZXh0Q3JlYXRpb25NZXRob2QsIGAke3RoaXMuZ2VuZXJhbFRleHRVcmx9YCwgb3B0aW9ucykgYXMgYW55O1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGNyZWF0aW9uUmVzdWx0JCA9IHRoaXMucmVwb3NpdG9yeS5wcm94eS5yZXF1ZXN0KGAke3RoaXMuZ2VuZXJhbFRleHRVcmx9YCwgdGhpcy5nZW5lcmFsVGV4dENyZWF0aW9uTWV0aG9kLCBudWxsLCBvcHRpb25zKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBjcmVhdGlvblJlc3VsdCQucGlwZShcclxuICAgICAgICAgICAgbWFwKFxyXG4gICAgICAgICAgICAgICAgKGRhdGE6IHN0cmluZykgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHRleHRzID0gQnBtbk1vZGVsSnNvbkhlbHBlci5Gcm9tSnNvbihkYXRhLCBHZW5lcmFsVGV4dElkV2l0aERhdGFJZCkgYXMgR2VuZXJhbFRleHRJZFdpdGhEYXRhSWRbXTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGV4dHM7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICksXHJcbiAgICAgICAgICAgIGNhdGNoRXJyb3IoXHJcbiAgICAgICAgICAgICAgICAoZXJyOiBhbnkpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGVyci5lcnJvciA9PSBcInN0cmluZ1wiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnIuZXJyb3IgPSBKU09OLnBhcnNlKGVyci5lcnJvcik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBlcnI7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIClcclxuICAgICAgICApO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog5omn6KGM5Y2V5o2u5rWB55Sf5Y2V5rWB56iLXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBleGVjdXRlQmlsbENyZWF0aW9uUHJvY2VzcyhhcmdzOiBGb3JtQmlsbENyZWF0aW9uUHJvY2Vzc0V4ZWN1dG9yQXJncyk6IE9ic2VydmFibGU8Rm9ybUJpbGxDcmVhdGlvblByb2Nlc3NFeGVjdXRvclJlc3VsdD4ge1xyXG4gICAgICAgIGlmIChhcmdzLm1hbnVhbENyZWF0aW9uTW9kZSA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHRocm93IFwibWFudWFsQ3JlYXRpb25Nb2Rl5LiN5Y+v5Li656m6XCI7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IGJvZHkgPSBhcmdzLkNvbnZlcnRUb0pzb24oKTtcclxuICAgICAgICBjb25zdCBvcHRpb25zID0ge1xyXG4gICAgICAgICAgICBib2R5OiBib2R5LFxyXG4gICAgICAgICAgICByZXNwb25zZVR5cGU6IFwidGV4dFwiXHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgbGV0IGV4ZWN1dGVDcmVhdGlvblJ1bGUkID0gbnVsbDtcclxuICAgICAgICBpZiAodGhpcy5odHRwU2VydmljZSAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgIGV4ZWN1dGVDcmVhdGlvblJ1bGUkID0gdGhpcy5odHRwU2VydmljZS5yZXF1ZXN0KHRoaXMuZXhlY3V0ZUJpbGxDcmVhdGlvblByb2Nlc3NNZXRob2QsIHRoaXMuZXhlY3V0ZUJpbGxDcmVhdGlvblByb2Nlc3NVcmwsIG9wdGlvbnMpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGV4ZWN1dGVDcmVhdGlvblJ1bGUkID0gdGhpcy5yZXBvc2l0b3J5LnByb3h5LnJlcXVlc3QodGhpcy5leGVjdXRlQmlsbENyZWF0aW9uUHJvY2Vzc1VybCwgdGhpcy5leGVjdXRlQmlsbENyZWF0aW9uUHJvY2Vzc01ldGhvZCwgbnVsbCwgb3B0aW9ucyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBleGVjdXRlQ3JlYXRpb25SdWxlJC5waXBlKFxyXG4gICAgICAgICAgICBtYXAoXHJcbiAgICAgICAgICAgICAgICAoZGF0YTogc3RyaW5nKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcmVzID0gbmV3IEZvcm1CaWxsQ3JlYXRpb25Qcm9jZXNzRXhlY3V0b3JSZXN1bHQoKTtcclxuICAgICAgICAgICAgICAgICAgICByZXMuTG9hZEZyb21Kc29uKGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiByZXM7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICksXHJcbiAgICAgICAgICAgIGNhdGNoRXJyb3IoXHJcbiAgICAgICAgICAgICAgICAoZXJyOiBhbnkpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGVyci5lcnJvciA9PSBcInN0cmluZ1wiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnIuZXJyb3IgPSBKU09OLnBhcnNlKGVyci5lcnJvcik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBlcnI7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIClcclxuICAgICAgICApO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog5Yib5bu65Y2V5o2uXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBjcmVhdGVFbnRpdHlEYXRhcyhhcmdzOiBGb3JtQ3JlYXRlQXJncyk6IE9ic2VydmFibGU8Rm9ybUNyZWF0ZVJlc3VsdD4ge1xyXG4gICAgICAgIGNvbnN0IGJvZHkgPSBhcmdzLkNvbnZlcnRUb0pzb24oKTtcclxuICAgICAgICBjb25zdCBvcHRpb25zID0ge1xyXG4gICAgICAgICAgICBib2R5OiBib2R5LFxyXG4gICAgICAgICAgICByZXNwb25zZVR5cGU6ICd0ZXh0J1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgY29uc3QgY3JlYXRlJDogT2JzZXJ2YWJsZTxzdHJpbmc+ID0gdGhpcy5yZXBvc2l0b3J5LnByb3h5LnJlcXVlc3QodGhpcy5mb3JtQ3JlYXRlVXJsLCB0aGlzLmZvcm1DcmVhdGVNZXRob2QsIG51bGwsIG9wdGlvbnMpO1xyXG4gICAgICAgIHJldHVybiBjcmVhdGUkLnBpcGUoXHJcbiAgICAgICAgICAgIHN3aXRjaE1hcChcclxuICAgICAgICAgICAgICAgIChyZXM6IHN0cmluZykgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IG5ldyBGb3JtQ3JlYXRlUmVzdWx0KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0LkxvYWRGcm9tSnNvbihyZXMpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGVudGl0aWVzOiBFbnRpdHlbXSA9IHJlc3VsdC5lbnRpdHlEYXRhTGlzdC5tYXAoKGVudGl0eVN0cjogc3RyaW5nKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG5ld0VudGl0eSA9IHRoaXMucmVwb3NpdG9yeS5idWlsZEVudGl0eShKU09OLnBhcnNlKGVudGl0eVN0cikpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFwcGVuZEluaXRpYWxEYXRhKG5ld0VudGl0eSwgbmV3RW50aXR5KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ld0VudGl0eTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgb3JpZ2luID0gdGhpcy5yZXBvc2l0b3J5LmVudGl0eUNvbGxlY3Rpb24uZ2V0QWxsRW50aXRpZXMoKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAob3JpZ2luID09IG51bGwgfHwgb3JpZ2luLmxlbmd0aCA9PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVwb3NpdG9yeS5lbnRpdHlDb2xsZWN0aW9uLmxvYWRFbnRpdGllcyhlbnRpdGllcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZXBvc2l0b3J5LmVudGl0eUNvbGxlY3Rpb24uYWRkRW50aXRpZXMoZW50aXRpZXMpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG9mKHJlc3VsdCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICksXHJcbiAgICAgICAgICAgIGNhdGNoRXJyb3IoXHJcbiAgICAgICAgICAgICAgICAoZXJyOiBhbnkpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGVyci5lcnJvciA9PSBcInN0cmluZ1wiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnIuZXJyb3IgPSBKU09OLnBhcnNlKGVyci5lcnJvcik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBlcnI7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIClcclxuICAgICAgICApO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog5L+u5pS55Y2V5o2uXHJcbiAgICAgKiBAcGFyYW0gYXJncyDooajljZXmm7TmlrDlj4LmlbBcclxuICAgICAqL1xyXG4gICAgcHVibGljIHVwZGF0ZUVudGl0eURhdGFzKGFyZ3M6IEZvcm1VcGRhdGVBcmdzKTogT2JzZXJ2YWJsZTxGb3JtVXBkYXRlUmVzdWx0PiB7XHJcbiAgICAgICAgY29uc3QgYm9keSA9IGFyZ3MuQ29udmVydFRvSnNvbigpO1xyXG4gICAgICAgIGNvbnN0IG9wdGlvbnMgPSB7XHJcbiAgICAgICAgICAgIGJvZHk6IGJvZHksXHJcbiAgICAgICAgICAgIHJlc3BvbnNlVHlwZTogXCJ0ZXh0XCJcclxuICAgICAgICB9O1xyXG4gICAgICAgIGNvbnN0IHVwZGF0ZSQgPSB0aGlzLnJlcG9zaXRvcnkucHJveHkucmVxdWVzdCh0aGlzLmZvcm1VcGRhdGVVcmwsIHRoaXMuZm9ybVVwZGF0ZU1ldGhvZCwgbnVsbCwgb3B0aW9ucyk7XHJcbiAgICAgICAgcmV0dXJuIHVwZGF0ZSQucGlwZShcclxuICAgICAgICAgICAgbWFwKFxyXG4gICAgICAgICAgICAgICAgKGRhdGE6IHN0cmluZykgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHJlczogRm9ybVVwZGF0ZVJlc3VsdCA9IG5ldyBGb3JtVXBkYXRlUmVzdWx0KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVzLkxvYWRGcm9tSnNvbihkYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICApLFxyXG4gICAgICAgICAgICBjYXRjaEVycm9yKFxyXG4gICAgICAgICAgICAgICAgKGVycjogYW55KSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBlcnIuZXJyb3IgPT0gXCJzdHJpbmdcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyLmVycm9yID0gSlNPTi5wYXJzZShlcnIuZXJyb3IpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgZXJyO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICApXHJcbiAgICAgICAgKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOWwhueUn+WNlee7k+aenOaOqOmAgeiHs+S7u+WKoeS4reW/g1xyXG4gICAgICogQHBhcmFtIGFyZ3Mg5o6o6YCB5Lu75Yqh5Lit5b+D5Y+C5pWwXHJcbiAgICAgKiBAcmV0dXJucyBcclxuICAgICAqL1xyXG4gICAgcHVibGljIHB1c2hUYXNrQ2VudGVyKGFyZ3M6IFB1c2hUYXNrQXJncyk6IE9ic2VydmFibGU8YW55PiB7XHJcbiAgICAgICAgY29uc3QgYm9keSA9IGFyZ3MuQ29udmVydFRvSnNvbigpO1xyXG4gICAgICAgIGNvbnN0IG9wdGlvbnMgPSB7XHJcbiAgICAgICAgICAgIGJvZHk6IGJvZHksXHJcbiAgICAgICAgICAgIHJlc3BvbnNlVHlwZTogXCJ0ZXh0XCJcclxuICAgICAgICB9O1xyXG4gICAgICAgIGxldCB1cGRhdGUkID0gbnVsbDtcclxuICAgICAgICBpZiAodGhpcy5odHRwU2VydmljZSAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgIHVwZGF0ZSQgPSB0aGlzLmh0dHBTZXJ2aWNlLnJlcXVlc3QodGhpcy5wdXNoVGFza01ldGhvZCwgdGhpcy5wdXNoVGFza1VybCwgb3B0aW9ucyk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdXBkYXRlJCA9IHRoaXMucmVwb3NpdG9yeS5wcm94eS5yZXF1ZXN0KHRoaXMucHVzaFRhc2tVcmwsIHRoaXMucHVzaFRhc2tNZXRob2QsIG51bGwsIG9wdGlvbnMpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdXBkYXRlJC5waXBlKFxyXG4gICAgICAgICAgICBjYXRjaEVycm9yKFxyXG4gICAgICAgICAgICAgICAgKGVycjogYW55KSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBlcnIuZXJyb3IgPT0gXCJzdHJpbmdcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyLmVycm9yID0gSlNPTi5wYXJzZShlcnIuZXJyb3IpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgZXJyO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICApXHJcbiAgICAgICAgKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOiOt+WPllZP5bqP5YiX5YyW5pWw5o2uXHJcbiAgICAgKiBAcGFyYW0gYXJncyBcclxuICAgICAqIEByZXR1cm5zIFxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgZ2V0RW50aXR5RGF0YXMoYXJnczogR2V0RW50aXR5RGF0YXNBcmdzKTogT2JzZXJ2YWJsZTxzdHJpbmc+IHtcclxuICAgICAgICBjb25zdCBib2R5ID0gYXJncy5Db252ZXJ0VG9Kc29uKCk7XHJcbiAgICAgICAgY29uc3Qgb3B0aW9ucyA9IHtcclxuICAgICAgICAgICAgYm9keTogYm9keSxcclxuICAgICAgICAgICAgcmVzcG9uc2VUeXBlOiBcInRleHRcIlxyXG4gICAgICAgIH07XHJcbiAgICAgICAgbGV0IGRhdGFzJCA9IG51bGw7XHJcbiAgICAgICAgaWYgKHRoaXMuaHR0cFNlcnZpY2UgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICBkYXRhcyQgPSB0aGlzLmh0dHBTZXJ2aWNlLnJlcXVlc3QodGhpcy5nZXRFbnRpdHlEYXRhc01ldGhvZCwgdGhpcy5nZXRFbnRpdHlEYXRhc1VybCwgb3B0aW9ucyk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgZGF0YXMkID0gdGhpcy5yZXBvc2l0b3J5LnByb3h5LnJlcXVlc3QodGhpcy5nZXRFbnRpdHlEYXRhc1VybCwgdGhpcy5nZXRFbnRpdHlEYXRhc01ldGhvZCwgbnVsbCwgb3B0aW9ucyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBkYXRhcyQucGlwZShcclxuICAgICAgICAgICAgY2F0Y2hFcnJvcihcclxuICAgICAgICAgICAgICAgIChlcnI6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgZXJyLmVycm9yID09IFwic3RyaW5nXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVyci5lcnJvciA9IEpTT04ucGFyc2UoZXJyLmVycm9yKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IGVycjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgKVxyXG4gICAgICAgICk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDmn6Xor6LljZXmja7nlJ/ljZXmtYHnqIvmianlsZXlrp7kvZNcclxuICAgICAqIEBwYXJhbSBhcmdzIOafpeivouWPguaVsFxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIGdldFNsaW1CaWxsQ3JlYXRpb25Qcm9jZXNzRW50aXR5RXhlcyhhcmdzOiBGb3JtR2V0QmlsbENyZWF0aW9uUHJvY2Vzc0VudGl0eUV4QXJncyB8IHN0cmluZyk6IE9ic2VydmFibGU8Rm9ybUdldEJpbGxDcmVhdGlvblByb2Nlc3NFbnRpdHlFeFJlc3VsdD4ge1xyXG4gICAgICAgIGlmIChhcmdzID09IG51bGwpIHtcclxuICAgICAgICAgICAgdGhyb3cgXCJhcmdz5LiN5Y+v5Li656m6XCI7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0eXBlb2YgYXJncyA9PSBcInN0cmluZ1wiKSB7XHJcbiAgICAgICAgICAgIGlmIChhcmdzID09IFwiXCIpIHtcclxuICAgICAgICAgICAgICAgIHRocm93IFwiYXJnc+S4jeWPr+S4uuepulwiO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNvbnN0IHRlbXAgPSBuZXcgRm9ybUdldEJpbGxDcmVhdGlvblByb2Nlc3NFbnRpdHlFeEFyZ3MoKTtcclxuICAgICAgICAgICAgdGVtcC5Mb2FkRnJvbUpzb24oYXJncyk7XHJcbiAgICAgICAgICAgIGFyZ3MgPSB0ZW1wO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCBvcHRpb25zID0geyBib2R5OiBhcmdzLkNvbnZlcnRUb0pzb24oKSwgcmVzcG9uc2VUeXBlOiBcInRleHRcIiB9O1xyXG4gICAgICAgIGxldCBnZXRFbnRpdHkkID0gbnVsbDtcclxuICAgICAgICBpZiAodGhpcy5odHRwU2VydmljZSAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgIGdldEVudGl0eSQgPSB0aGlzLmh0dHBTZXJ2aWNlLnJlcXVlc3QodGhpcy5nZXRCaWxsQ3JlYXRpb25Qcm9jZXNzRW50aXR5RXhNZXRob2QsIHRoaXMuZ2V0QmlsbENyZWF0aW9uUHJvY2Vzc0VudGl0eUV4VXJsLCBvcHRpb25zKTtcclxuXHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgZ2V0RW50aXR5JCA9IHRoaXMucmVwb3NpdG9yeS5wcm94eS5yZXF1ZXN0KHRoaXMuZ2V0QmlsbENyZWF0aW9uUHJvY2Vzc0VudGl0eUV4VXJsLCB0aGlzLmdldEJpbGxDcmVhdGlvblByb2Nlc3NFbnRpdHlFeE1ldGhvZCwgbnVsbCwgb3B0aW9ucyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBnZXRFbnRpdHkkLnBpcGUoXHJcbiAgICAgICAgICAgIG1hcChcclxuICAgICAgICAgICAgICAgIChkYXRhOiBzdHJpbmcpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCByZXN1bHQgPSBuZXcgRm9ybUdldEJpbGxDcmVhdGlvblByb2Nlc3NFbnRpdHlFeFJlc3VsdCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdC5Mb2FkRnJvbUpzb24oZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgKSxcclxuICAgICAgICAgICAgY2F0Y2hFcnJvcihcclxuICAgICAgICAgICAgICAgIChlcnI6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgZXJyLmVycm9yID09IFwic3RyaW5nXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVyci5lcnJvciA9IEpTT04ucGFyc2UoZXJyLmVycm9yKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IGVycjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgKVxyXG4gICAgICAgICk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqIFxyXG4gICAgICog5Y+C6ICDZmFycmlzL2JlZiBFbnRpdHlVdGls5a6e546wXHJcbiAgICAgKiBAcGFyYW0gZW50aXR5IFxyXG4gICAgICogQHBhcmFtIGluaXRpYWxEYXRhIFxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIGFwcGVuZEluaXRpYWxEYXRhKGVudGl0eSwgaW5pdGlhbERhdGEpIHtcclxuICAgICAgICBjb25zdCBkYXRhID0gT2JqZWN0LmFzc2lnbih7fSwgaW5pdGlhbERhdGEpO1xyXG4gICAgICAgIGRlbGV0ZSBkYXRhLmlkO1xyXG4gICAgICAgIGRlbGV0ZSBkYXRhLnBhcmVudElEO1xyXG4gICAgICAgIGVudGl0eVsnaW5pdGlhbERhdGEnXSA9IGRhdGE7XHJcbiAgICB9XHJcbn0iXX0=