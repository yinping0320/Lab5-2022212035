/**
 * @fileoverview added by tsickle
 * Generated from: lib/webcmp/bif-bill-tracker.webcmp.service.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { ComponentFactoryResolver, Inject, Injectable, Injector, LOCALE_ID, Optional, ReflectiveInjector } from '@angular/core';
import { BillTrackerUiService } from '../bill-tracker/services/bill-tracker-ui.service';
import { GetBillsInfoArgs } from '../entity/tracking/GetBillsInfoArgs';
import { BindingData, ViewModel, FrameContext } from '@farris/devkit';
import { canJSONParse } from '../utils/ObjectUtils';
import { MessagerService } from '@farris/ui-messager';
import { BillTrackerLocalePipe } from '../bill-tracker/pipe/bill-tracker-locale.pipe';
/**
 * 单据追踪web构件服务类
 */
var BifBillTrackerWebCmpService = /** @class */ (function () {
    function BifBillTrackerWebCmpService(trackerUiService, bindingData, viewModel, frameContext, inj, cfr, localeId, messagerService) {
        this.trackerUiService = trackerUiService;
        this.bindingData = bindingData;
        this.viewModel = viewModel;
        this.frameContext = frameContext;
        this.inj = inj;
        this.cfr = cfr;
        this.localeId = localeId;
        this.messagerService = messagerService;
        if (inj == null) {
            /** @type {?} */
            var refInj = ReflectiveInjector.resolveAndCreate([], this.frameContext && this.frameContext.injector);
            this.inj = refInj;
        }
        this.cfr = cfr || this.inj.get(ComponentFactoryResolver);
        this.localeId = localeId || this.inj.get(LOCALE_ID, null) || 'zh-CHS';
        this.messagerService = messagerService || this.inj.get(MessagerService, null);
        this.localePipe = this.trackerUiService && this.trackerUiService.localePipe || new BillTrackerLocalePipe(localeId);
    }
    /**
     * 打开单据追踪弹窗
     * @param args 单据Id或者单据查询参数
     * @param maximized 是否最大化弹窗
     * @param modalOptions 弹窗配置
     * @param graphOptions 单据追踪图配置
     * @param gridOptions 单据追踪数据表配置
     * @returns billTrackerComponent 单据追踪组件 @type { Observable<BillTrackerComponent> }
     */
    /**
     * 打开单据追踪弹窗
     * @param {?} args 单据Id或者单据查询参数
     * @param {?=} maximized 是否最大化弹窗
     * @param {?=} modalOptions 弹窗配置
     * @param {?=} graphOptions 单据追踪图配置
     * @param {?=} gridOptions 单据追踪数据表配置
     * @return {?} billTrackerComponent 单据追踪组件 \@type { Observable<BillTrackerComponent> }
     */
    BifBillTrackerWebCmpService.prototype.openDialog = /**
     * 打开单据追踪弹窗
     * @param {?} args 单据Id或者单据查询参数
     * @param {?=} maximized 是否最大化弹窗
     * @param {?=} modalOptions 弹窗配置
     * @param {?=} graphOptions 单据追踪图配置
     * @param {?=} gridOptions 单据追踪数据表配置
     * @return {?} billTrackerComponent 单据追踪组件 \@type { Observable<BillTrackerComponent> }
     */
    function (args, maximized, modalOptions, graphOptions, gridOptions) {
        if (args == null || args == "" || ((/** @type {?} */ (args))).trim && ((/** @type {?} */ (args))).trim() == "") {
            this.messagerService.error(this.localePipe.transform("trackerArgsCantBeEmpty"));
            throw "参数args不可为空";
        }
        if (typeof args == "string" && canJSONParse((/** @type {?} */ (args)))) {
            args = JSON.parse((/** @type {?} */ (args)));
        }
        else {
            args = (/** @type {?} */ (args));
        }
        maximized = (/** @type {?} */ (maximized)) === "" || maximized == null ? undefined : maximized;
        if (maximized != null && typeof maximized != "boolean") {
            if (maximized == "false") {
                maximized = false;
            }
            else if (maximized == "true") {
                maximized = true;
            }
            else {
                maximized = undefined;
            }
        }
        modalOptions = (/** @type {?} */ (modalOptions)) === "" || modalOptions == null ? undefined : modalOptions;
        graphOptions = (/** @type {?} */ (graphOptions)) === "" || graphOptions == null ? undefined : graphOptions;
        gridOptions = (/** @type {?} */ (gridOptions)) === "" || gridOptions == null ? undefined : gridOptions;
        /** @type {?} */
        var argz = new GetBillsInfoArgs();
        if (typeof args == "string") {
            argz.billDataId = args;
        }
        else {
            argz.LoadFromJsonObject(args);
        }
        return this.trackerUiService.openDefaultBillTrackerDialog(argz, maximized, modalOptions, graphOptions, gridOptions);
    };
    /**
     * 打开单据追踪App
     * @param args 单据Id或者单据查询参数
     * @param graphOptions 单据追踪图配置
     * @param gridOptions 单据追踪数据表配置
     */
    /**
     * 打开单据追踪App
     * @param {?} args 单据Id或者单据查询参数
     * @param {?=} graphOptions 单据追踪图配置
     * @param {?=} gridOptions 单据追踪数据表配置
     * @return {?}
     */
    BifBillTrackerWebCmpService.prototype.openApp = /**
     * 打开单据追踪App
     * @param {?} args 单据Id或者单据查询参数
     * @param {?=} graphOptions 单据追踪图配置
     * @param {?=} gridOptions 单据追踪数据表配置
     * @return {?}
     */
    function (args, graphOptions, gridOptions) {
        if (args == null || args == "" || ((/** @type {?} */ (args))).trim && ((/** @type {?} */ (args))).trim() == "") {
            this.messagerService.error(this.localePipe.transform("trackerArgsCantBeEmpty"));
            throw "参数args不可为空";
        }
        if (typeof args == "string" && canJSONParse((/** @type {?} */ (args)))) {
            args = JSON.parse((/** @type {?} */ (args)));
        }
        else {
            args = (/** @type {?} */ (args));
        }
        graphOptions = (/** @type {?} */ (graphOptions)) === "" || graphOptions == null ? undefined : graphOptions;
        gridOptions = (/** @type {?} */ (gridOptions)) === "" || gridOptions == null ? undefined : gridOptions;
        /** @type {?} */
        var argz = new GetBillsInfoArgs();
        if (typeof args == "string") {
            argz.billDataId = args;
        }
        else {
            argz.LoadFromJsonObject(args);
        }
        this.trackerUiService.openDefaultBillTrackerApp(argz, graphOptions, gridOptions);
    };
    BifBillTrackerWebCmpService.decorators = [
        { type: Injectable }
    ];
    /** @nocollapse */
    BifBillTrackerWebCmpService.ctorParameters = function () { return [
        { type: BillTrackerUiService },
        { type: BindingData, decorators: [{ type: Optional }] },
        { type: ViewModel, decorators: [{ type: Optional }] },
        { type: FrameContext, decorators: [{ type: Optional }] },
        { type: Injector, decorators: [{ type: Optional }] },
        { type: ComponentFactoryResolver, decorators: [{ type: Optional }] },
        { type: String, decorators: [{ type: Inject, args: [LOCALE_ID,] }] },
        { type: MessagerService, decorators: [{ type: Optional }] }
    ]; };
    return BifBillTrackerWebCmpService;
}());
export { BifBillTrackerWebCmpService };
if (false) {
    /** @type {?} */
    BifBillTrackerWebCmpService.prototype.localePipe;
    /** @type {?} */
    BifBillTrackerWebCmpService.prototype.trackerUiService;
    /** @type {?} */
    BifBillTrackerWebCmpService.prototype.bindingData;
    /** @type {?} */
    BifBillTrackerWebCmpService.prototype.viewModel;
    /** @type {?} */
    BifBillTrackerWebCmpService.prototype.frameContext;
    /** @type {?} */
    BifBillTrackerWebCmpService.prototype.inj;
    /** @type {?} */
    BifBillTrackerWebCmpService.prototype.cfr;
    /** @type {?} */
    BifBillTrackerWebCmpService.prototype.localeId;
    /** @type {?} */
    BifBillTrackerWebCmpService.prototype.messagerService;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYmlmLWJpbGwtdHJhY2tlci53ZWJjbXAuc2VydmljZS5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BlZHAtYmlmL3J1bnRpbWUtYXBpLyIsInNvdXJjZXMiOlsibGliL3dlYmNtcC9iaWYtYmlsbC10cmFja2VyLndlYmNtcC5zZXJ2aWNlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7O0FBQUEsT0FBTyxFQUFFLHdCQUF3QixFQUFFLE1BQU0sRUFBRSxVQUFVLEVBQUUsUUFBUSxFQUFFLFNBQVMsRUFBRSxRQUFRLEVBQUUsa0JBQWtCLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFDaEksT0FBTyxFQUFFLG9CQUFvQixFQUFFLE1BQU0sa0RBQWtELENBQUM7QUFDeEYsT0FBTyxFQUFFLGdCQUFnQixFQUFFLE1BQU0scUNBQXFDLENBQUM7QUFJdkUsT0FBTyxFQUFFLFdBQVcsRUFBRSxTQUFTLEVBQUUsWUFBWSxFQUFFLE1BQU0sZ0JBQWdCLENBQUM7QUFHdEUsT0FBTyxFQUFFLFlBQVksRUFBRSxNQUFNLHNCQUFzQixDQUFDO0FBQ3BELE9BQU8sRUFBRSxlQUFlLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQztBQUN0RCxPQUFPLEVBQUUscUJBQXFCLEVBQUUsTUFBTSwrQ0FBK0MsQ0FBQzs7OztBQUt0RjtJQUlFLHFDQUNTLGdCQUFzQyxFQUMxQixXQUF3QixFQUN4QixTQUFvQixFQUNwQixZQUEwQixFQUMxQixHQUFhLEVBQ2IsR0FBNkIsRUFDdEIsUUFBZ0IsRUFDdkIsZUFBZ0M7UUFQNUMscUJBQWdCLEdBQWhCLGdCQUFnQixDQUFzQjtRQUMxQixnQkFBVyxHQUFYLFdBQVcsQ0FBYTtRQUN4QixjQUFTLEdBQVQsU0FBUyxDQUFXO1FBQ3BCLGlCQUFZLEdBQVosWUFBWSxDQUFjO1FBQzFCLFFBQUcsR0FBSCxHQUFHLENBQVU7UUFDYixRQUFHLEdBQUgsR0FBRyxDQUEwQjtRQUN0QixhQUFRLEdBQVIsUUFBUSxDQUFRO1FBQ3ZCLG9CQUFlLEdBQWYsZUFBZSxDQUFp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QUFHLG1CQUFBLFdBQVcsRUFBTyxLQUFLLEVBQUUsSUFBSSxXQUFXLElBQUksSUFBSSxDQUFDLENBQUMsQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDLFdBQVcsQ0FBQzs7WUFFbkYsSUFBSSxHQUFHLElBQUksZ0JBQWdCLEVBQUU7UUFDbkMsSUFBSSxPQUFPLElBQUksSUFBSSxRQUFRLEVBQUU7WUFDM0IsSUFBSSxDQUFDLFVBQVUsR0FBRyxJQUFJLENBQUM7U0FDeEI7YUFBTTtZQUNMLElBQUksQ0FBQyxrQkFBa0IsQ0FBQyxJQUFJLENBQUMsQ0FBQztTQUMvQjtRQUVELElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyx5QkFBeUIsQ0FBQyxJQUFJLEVBQUUsWUFBWSxFQUFFLFdBQVcsQ0FBQyxDQUFDO0lBQ25GLENBQUM7O2dCQS9GRixVQUFVOzs7O2dCQWZGLG9CQUFvQjtnQkFLcEIsV0FBVyx1QkFnQmYsUUFBUTtnQkFoQlMsU0FBUyx1QkFpQjFCLFFBQVE7Z0JBakJvQixZQUFZLHVCQWtCeEMsUUFBUTtnQkF4QjBDLFFBQVEsdUJBeUIxRCxRQUFRO2dCQXpCSix3QkFBd0IsdUJBMEI1QixRQUFROzZDQUNSLE1BQU0sU0FBQyxTQUFTO2dCQWpCWixlQUFlLHVCQWtCbkIsUUFBUTs7SUFvRmIsa0NBQUM7Q0FBQSxBQWhHRCxJQWdHQztTQS9GWSwyQkFBMkI7OztJQUN0QyxpREFBa0M7O0lBR2hDLHVEQUE2Qzs7SUFDN0Msa0RBQTJDOztJQUMzQyxnREFBdUM7O0lBQ3ZDLG1EQUE2Qzs7SUFDN0MsMENBQWdDOztJQUNoQywwQ0FBZ0Q7O0lBQ2hELCtDQUEwQzs7SUFDMUMsc0RBQW1EIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ29tcG9uZW50RmFjdG9yeVJlc29sdmVyLCBJbmplY3QsIEluamVjdGFibGUsIEluamVjdG9yLCBMT0NBTEVfSUQsIE9wdGlvbmFsLCBSZWZsZWN0aXZlSW5qZWN0b3IgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgQmlsbFRyYWNrZXJVaVNlcnZpY2UgfSBmcm9tICcuLi9iaWxsLXRyYWNrZXIvc2VydmljZXMvYmlsbC10cmFja2VyLXVpLnNlcnZpY2UnO1xyXG5pbXBvcnQgeyBHZXRCaWxsc0luZm9BcmdzIH0gZnJvbSAnLi4vZW50aXR5L3RyYWNraW5nL0dldEJpbGxzSW5mb0FyZ3MnO1xyXG5pbXBvcnQgeyBNb2RhbE9wdGlvbnMgfSBmcm9tICdAZmFycmlzL3VpLW1vZGFsJztcclxuaW1wb3J0IHsgQmlsbFRyYWNrZXJHcmFwaE9wdGlvbnMgfSBmcm9tICcuLi9iaWxsLXRyYWNrZXIvY29uZmlnL2JpbGwtdHJhY2tlci1ncmFwaC1vcHRpb25zJztcclxuaW1wb3J0IHsgQmlsbFRyYWNrZXJHcmlkT3B0aW9ucyB9IGZyb20gJy4uL2JpbGwtdHJhY2tlci9jb25maWcvYmlsbC10cmFja2VyLWdyaWQtb3B0aW9ucyc7XHJcbmltcG9ydCB7IEJpbmRpbmdEYXRhLCBWaWV3TW9kZWwsIEZyYW1lQ29udGV4dCB9IGZyb20gJ0BmYXJyaXMvZGV2a2l0JztcclxuaW1wb3J0IHsgT2JzZXJ2YWJsZSB9IGZyb20gJ3J4anMnO1xyXG5pbXBvcnQgeyBCaWxsVHJhY2tlckNvbXBvbmVudCB9IGZyb20gJy4uL2JpbGwtdHJhY2tlci9jb21wb25lbnRzL2JpbGwtdHJhY2tlci9iaWxsLXRyYWNrZXIuY29tcG9uZW50JztcclxuaW1wb3J0IHsgY2FuSlNPTlBhcnNlIH0gZnJvbSAnLi4vdXRpbHMvT2JqZWN0VXRpbHMnO1xyXG5pbXBvcnQgeyBNZXNzYWdlclNlcnZpY2UgfSBmcm9tICdAZmFycmlzL3VpLW1lc3NhZ2VyJztcclxuaW1wb3J0IHsgQmlsbFRyYWNrZXJMb2NhbGVQaXBlIH0gZnJvbSAnLi4vYmlsbC10cmFja2VyL3BpcGUvYmlsbC10cmFja2VyLWxvY2FsZS5waXBlJztcclxuXHJcbi8qKlxyXG4gKiDljZXmja7ov73ouKp3ZWLmnoTku7bmnI3liqHnsbtcclxuICovXHJcbkBJbmplY3RhYmxlKClcclxuZXhwb3J0IGNsYXNzIEJpZkJpbGxUcmFja2VyV2ViQ21wU2VydmljZSB7XHJcbiAgbG9jYWxlUGlwZTogQmlsbFRyYWNrZXJMb2NhbGVQaXBlO1xyXG5cclxuICBjb25zdHJ1Y3RvcihcclxuICAgIHB1YmxpYyB0cmFja2VyVWlTZXJ2aWNlOiBCaWxsVHJhY2tlclVpU2VydmljZSxcclxuICAgIEBPcHRpb25hbCgpIHB1YmxpYyBiaW5kaW5nRGF0YTogQmluZGluZ0RhdGEsXHJcbiAgICBAT3B0aW9uYWwoKSBwdWJsaWMgdmlld01vZGVsOiBWaWV3TW9kZWwsXHJcbiAgICBAT3B0aW9uYWwoKSBwdWJsaWMgZnJhbWVDb250ZXh0OiBGcmFtZUNvbnRleHQsXHJcbiAgICBAT3B0aW9uYWwoKSBwdWJsaWMgaW5qOiBJbmplY3RvcixcclxuICAgIEBPcHRpb25hbCgpIHB1YmxpYyBjZnI6IENvbXBvbmVudEZhY3RvcnlSZXNvbHZlcixcclxuICAgIEBJbmplY3QoTE9DQUxFX0lEKSBwdWJsaWMgbG9jYWxlSWQ6IHN0cmluZyxcclxuICAgIEBPcHRpb25hbCgpIHB1YmxpYyBtZXNzYWdlclNlcnZpY2U6IE1lc3NhZ2VyU2VydmljZSxcclxuICApIHtcclxuICAgIGlmIChpbmogPT0gbnVsbCkge1xyXG4gICAgICBjb25zdCByZWZJbmogPSBSZWZsZWN0aXZlSW5qZWN0b3IucmVzb2x2ZUFuZENyZWF0ZShbXSwgdGhpcy5mcmFtZUNvbnRleHQgJiYgdGhpcy5mcmFtZUNvbnRleHQuaW5qZWN0b3IpO1xyXG4gICAgICB0aGlzLmluaiA9IHJlZkluajtcclxuICAgIH1cclxuXHJcbiAgICB0aGlzLmNmciA9IGNmciB8fCB0aGlzLmluai5nZXQoQ29tcG9uZW50RmFjdG9yeVJlc29sdmVyKTtcclxuICAgIHRoaXMubG9jYWxlSWQgPSBsb2NhbGVJZCB8fCB0aGlzLmluai5nZXQoTE9DQUxFX0lELCBudWxsKSB8fCAnemgtQ0hTJztcclxuICAgIHRoaXMubWVzc2FnZXJTZXJ2aWNlID0gbWVzc2FnZXJTZXJ2aWNlIHx8IHRoaXMuaW5qLmdldChNZXNzYWdlclNlcnZpY2UsIG51bGwpO1xyXG4gICAgdGhpcy5sb2NhbGVQaXBlID0gdGhpcy50cmFja2VyVWlTZXJ2aWNlICYmIHRoaXMudHJhY2tlclVpU2VydmljZS5sb2NhbGVQaXBlIHx8IG5ldyBCaWxsVHJhY2tlckxvY2FsZVBpcGUobG9jYWxlSWQpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog5omT5byA5Y2V5o2u6L+96Liq5by556qXXHJcbiAgICogQHBhcmFtIGFyZ3Mg5Y2V5o2uSWTmiJbogIXljZXmja7mn6Xor6Llj4LmlbBcclxuICAgKiBAcGFyYW0gbWF4aW1pemVkIOaYr+WQpuacgOWkp+WMluW8ueeql1xyXG4gICAqIEBwYXJhbSBtb2RhbE9wdGlvbnMg5by556qX6YWN572uXHJcbiAgICogQHBhcmFtIGdyYXBoT3B0aW9ucyDljZXmja7ov73ouKrlm77phY3nva5cclxuICAgKiBAcGFyYW0gZ3JpZE9wdGlvbnMg5Y2V5o2u6L+96Liq5pWw5o2u6KGo6YWN572uXHJcbiAgICogQHJldHVybnMgYmlsbFRyYWNrZXJDb21wb25lbnQg5Y2V5o2u6L+96Liq57uE5Lu2IEB0eXBlIHsgT2JzZXJ2YWJsZTxCaWxsVHJhY2tlckNvbXBvbmVudD4gfVxyXG4gICAqL1xyXG4gIHB1YmxpYyBvcGVuRGlhbG9nKGFyZ3M6IHN0cmluZyB8IEdldEJpbGxzSW5mb0FyZ3MsIG1heGltaXplZD86IGJvb2xlYW4sIG1vZGFsT3B0aW9ucz86IE1vZGFsT3B0aW9ucywgZ3JhcGhPcHRpb25zPzogQmlsbFRyYWNrZXJHcmFwaE9wdGlvbnMsIGdyaWRPcHRpb25zPzogQmlsbFRyYWNrZXJHcmlkT3B0aW9ucyk6IE9ic2VydmFibGU8QmlsbFRyYWNrZXJDb21wb25lbnQ+IHtcclxuICAgIGlmIChhcmdzID09IG51bGwgfHwgYXJncyA9PSBcIlwiIHx8IChhcmdzIGFzIGFueSkudHJpbSAmJiAoYXJncyBhcyBhbnkpLnRyaW0oKSA9PSBcIlwiKSB7XHJcbiAgICAgIHRoaXMubWVzc2FnZXJTZXJ2aWNlLmVycm9yKHRoaXMubG9jYWxlUGlwZS50cmFuc2Zvcm0oXCJ0cmFja2VyQXJnc0NhbnRCZUVtcHR5XCIpKTtcclxuICAgICAgdGhyb3cgXCLlj4LmlbBhcmdz5LiN5Y+v5Li656m6XCI7XHJcbiAgICB9XHJcbiAgICBpZiAodHlwZW9mIGFyZ3MgPT0gXCJzdHJpbmdcIiAmJiBjYW5KU09OUGFyc2UoYXJncyBhcyBzdHJpbmcpKSB7XHJcbiAgICAgIGFyZ3MgPSBKU09OLnBhcnNlKGFyZ3MgYXMgc3RyaW5nKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGFyZ3MgPSBhcmdzIGFzIHN0cmluZztcclxuICAgIH1cclxuICAgIG1heGltaXplZCA9IG1heGltaXplZCBhcyBhbnkgPT09IFwiXCIgfHwgbWF4aW1pemVkID09IG51bGwgPyB1bmRlZmluZWQgOiBtYXhpbWl6ZWQ7XHJcbiAgICBpZiAobWF4aW1pemVkICE9IG51bGwgJiYgdHlwZW9mIG1heGltaXplZCAhPSBcImJvb2xlYW5cIikge1xyXG4gICAgICBpZiAobWF4aW1pemVkID09IFwiZmFsc2VcIikge1xyXG4gICAgICAgIG1heGltaXplZCA9IGZhbHNlO1xyXG4gICAgICB9IGVsc2UgaWYgKG1heGltaXplZCA9PSBcInRydWVcIikge1xyXG4gICAgICAgIG1heGltaXplZCA9IHRydWU7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgbWF4aW1pemVkID0gdW5kZWZpbmVkO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBtb2RhbE9wdGlvbnMgPSBtb2RhbE9wdGlvbnMgYXMgYW55ID09PSBcIlwiIHx8IG1vZGFsT3B0aW9ucyA9PSBudWxsID8gdW5kZWZpbmVkIDogbW9kYWxPcHRpb25zO1xyXG4gICAgZ3JhcGhPcHRpb25zID0gZ3JhcGhPcHRpb25zIGFzIGFueSA9PT0gXCJcIiB8fCBncmFwaE9wdGlvbnMgPT0gbnVsbCA/IHVuZGVmaW5lZCA6IGdyYXBoT3B0aW9ucztcclxuICAgIGdyaWRPcHRpb25zID0gZ3JpZE9wdGlvbnMgYXMgYW55ID09PSBcIlwiIHx8IGdyaWRPcHRpb25zID09IG51bGwgPyB1bmRlZmluZWQgOiBncmlkT3B0aW9ucztcclxuXHJcbiAgICBjb25zdCBhcmd6ID0gbmV3IEdldEJpbGxzSW5mb0FyZ3MoKTtcclxuICAgIGlmICh0eXBlb2YgYXJncyA9PSBcInN0cmluZ1wiKSB7XHJcbiAgICAgIGFyZ3ouYmlsbERhdGFJZCA9IGFyZ3M7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBhcmd6LkxvYWRGcm9tSnNvbk9iamVjdChhcmdzKTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gdGhpcy50cmFja2VyVWlTZXJ2aWNlLm9wZW5EZWZhdWx0QmlsbFRyYWNrZXJEaWFsb2coYXJneiwgbWF4aW1pemVkLCBtb2RhbE9wdGlvbnMsIGdyYXBoT3B0aW9ucywgZ3JpZE9wdGlvbnMpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog5omT5byA5Y2V5o2u6L+96LiqQXBwXHJcbiAgICogQHBhcmFtIGFyZ3Mg5Y2V5o2uSWTmiJbogIXljZXmja7mn6Xor6Llj4LmlbBcclxuICAgKiBAcGFyYW0gZ3JhcGhPcHRpb25zIOWNleaNrui/vei4quWbvumFjee9rlxyXG4gICAqIEBwYXJhbSBncmlkT3B0aW9ucyDljZXmja7ov73ouKrmlbDmja7ooajphY3nva5cclxuICAgKi9cclxuICBwdWJsaWMgb3BlbkFwcChhcmdzOiBzdHJpbmcgfCBHZXRCaWxsc0luZm9BcmdzLCBncmFwaE9wdGlvbnM/OiBCaWxsVHJhY2tlckdyYXBoT3B0aW9ucywgZ3JpZE9wdGlvbnM/OiBCaWxsVHJhY2tlckdyaWRPcHRpb25zKSB7XHJcbiAgICBpZiAoYXJncyA9PSBudWxsIHx8IGFyZ3MgPT0gXCJcIiB8fCAoYXJncyBhcyBhbnkpLnRyaW0gJiYgKGFyZ3MgYXMgYW55KS50cmltKCkgPT0gXCJcIikge1xyXG4gICAgICB0aGlzLm1lc3NhZ2VyU2VydmljZS5lcnJvcih0aGlzLmxvY2FsZVBpcGUudHJhbnNmb3JtKFwidHJhY2tlckFyZ3NDYW50QmVFbXB0eVwiKSk7XHJcbiAgICAgIHRocm93IFwi5Y+C5pWwYXJnc+S4jeWPr+S4uuepulwiO1xyXG4gICAgfVxyXG4gICAgaWYgKHR5cGVvZiBhcmdzID09IFwic3RyaW5nXCIgJiYgY2FuSlNPTlBhcnNlKGFyZ3MgYXMgc3RyaW5nKSkge1xyXG4gICAgICBhcmdzID0gSlNPTi5wYXJzZShhcmdzIGFzIHN0cmluZyk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBhcmdzID0gYXJncyBhcyBzdHJpbmc7XHJcbiAgICB9XHJcbiAgICBncmFwaE9wdGlvbnMgPSBncmFwaE9wdGlvbnMgYXMgYW55ID09PSBcIlwiIHx8IGdyYXBoT3B0aW9ucyA9PSBudWxsID8gdW5kZWZpbmVkIDogZ3JhcGhPcHRpb25zO1xyXG4gICAgZ3JpZE9wdGlvbnMgPSBncmlkT3B0aW9ucyBhcyBhbnkgPT09IFwiXCIgfHwgZ3JpZE9wdGlvbnMgPT0gbnVsbCA/IHVuZGVmaW5lZCA6IGdyaWRPcHRpb25zO1xyXG5cclxuICAgIGNvbnN0IGFyZ3ogPSBuZXcgR2V0QmlsbHNJbmZvQXJncygpO1xyXG4gICAgaWYgKHR5cGVvZiBhcmdzID09IFwic3RyaW5nXCIpIHtcclxuICAgICAgYXJnei5iaWxsRGF0YUlkID0gYXJncztcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGFyZ3ouTG9hZEZyb21Kc29uT2JqZWN0KGFyZ3MpO1xyXG4gICAgfVxyXG5cclxuICAgIHRoaXMudHJhY2tlclVpU2VydmljZS5vcGVuRGVmYXVsdEJpbGxUcmFja2VyQXBwKGFyZ3osIGdyYXBoT3B0aW9ucywgZ3JpZE9wdGlvbnMpO1xyXG4gIH1cclxufVxyXG4iXX0=