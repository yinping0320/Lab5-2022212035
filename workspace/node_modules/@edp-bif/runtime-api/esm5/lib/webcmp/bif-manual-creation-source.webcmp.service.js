/**
 * @fileoverview added by tsickle
 * Generated from: lib/webcmp/bif-manual-creation-source.webcmp.service.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
import { Injectable, Optional } from '@angular/core';
import { MessagerService } from "@farris/ui-messager";
import { BindingData, ViewModel, FrameContext } from "@farris/devkit";
import { PushCreationMode } from "@edp-aif/common-api";
import { FormBillCreationProcessExecutorArgs } from '../entity/form-rest/FormBillCreationProcessExecutorArgs';
import { BifDataService } from '../bif-manual-creation/service/bif-data.service';
import { BifSourceUiService } from '../bif-manual-creation/service/bif-source-ui.service';
import { LocalePipe } from '../bif-manual-creation/pipe/locale.pipe';
import { PushTaskArgs } from '../bif-manual-creation/args/PushTaskArgs';
import { ManualCreationMode } from '../entity/form-rest/ManualCreationMode';
import { EntityParamUtils } from './EntityParamUtils';
/**
 * 手工生单来源端服务类
 */
var BifManualCreationSourceWebCmpService = /** @class */ (function () {
    function BifManualCreationSourceWebCmpService(sourceUiService, dataService, bindingData, messagerService, viewModel, frameContext) {
        this.sourceUiService = sourceUiService;
        this.dataService = dataService;
        this.bindingData = bindingData;
        this.messagerService = messagerService;
        this.viewModel = viewModel;
        this.frameContext = frameContext;
        this.localePipe = new LocalePipe(this.sourceUiService && this.sourceUiService.localeId || 'zh-CHS');
    }
    /**
     * 下推，根据来源VO Id打开生单流程选择器并执行选中的生单流程
     *
     * @param sourceVoId 单据流来源视图对象 Id
     * @param entities 参与生单的上游单据ID列表或实体列表
     * @param targetCommand 目标单据'单据流加载'命令的编号
     * @param bizFlowchartId 业务场景图Id
     * @param modalOptions 弹窗配置
     * @param customSelectorModuleUrl 自定义选择器url
     * @param extParams1 打开生单流程选择器弹窗扩展参数
     * @param extParams2 打开目标单据制单界面扩展参数
     */
    /**
     * 下推，根据来源VO Id打开生单流程选择器并执行选中的生单流程
     *
     * @param {?} sourceVoId 单据流来源视图对象 Id
     * @param {?} entities 参与生单的上游单据ID列表或实体列表
     * @param {?=} targetCommand 目标单据'单据流加载'命令的编号
     * @param {?=} bizFlowchartId 业务场景图Id
     * @param {?=} modalOptions 弹窗配置
     * @param {?=} customSelectorModuleUrl 自定义选择器url
     * @param {?=} extParams1 打开生单流程选择器弹窗扩展参数
     * @param {?=} extParams2 打开目标单据制单界面扩展参数
     * @return {?}
     */
    BifManualCreationSourceWebCmpService.prototype.pushBySourceVoId = /**
     * 下推，根据来源VO Id打开生单流程选择器并执行选中的生单流程
     *
     * @param {?} sourceVoId 单据流来源视图对象 Id
     * @param {?} entities 参与生单的上游单据ID列表或实体列表
     * @param {?=} targetCommand 目标单据'单据流加载'命令的编号
     * @param {?=} bizFlowchartId 业务场景图Id
     * @param {?=} modalOptions 弹窗配置
     * @param {?=} customSelectorModuleUrl 自定义选择器url
     * @param {?=} extParams1 打开生单流程选择器弹窗扩展参数
     * @param {?=} extParams2 打开目标单据制单界面扩展参数
     * @return {?}
     */
    function (sourceVoId, entities, targetCommand, bizFlowchartId, modalOptions, customSelectorModuleUrl, extParams1, extParams2) {
        var _this = this;
        if (sourceVoId == null || sourceVoId == "" || sourceVoId.trim && sourceVoId.trim() == "") {
            this.messagerService.error(this.localePipe.transform("sourceVoIdCantBeEmpty"));
            throw "参数sourceVoId不可为空";
        }
        // 参数为空时尝试从根组件BindingData上取id，获取后仍为空则报错
        if (entities == null || ((/** @type {?} */ (entities))) == "") {
            try {
                entities = this.frameContext.root.bindingData.getObject().id;
            }
            catch (e) {
            }
            if (entities == null || ((/** @type {?} */ (entities))) == "") {
                this.messagerService.error(this.localePipe.transform("entitiesCantBeEmpty"));
                throw "参数entities不可为空";
            }
        }
        if (entities instanceof Map) {
            entities = Array.from(entities.values());
        }
        entities = Array.isArray(entities) ? entities : [entities];
        bizFlowchartId = bizFlowchartId === "" || bizFlowchartId == null ? undefined : bizFlowchartId;
        modalOptions = (/** @type {?} */ (modalOptions)) === "" || modalOptions == null ? undefined : modalOptions;
        customSelectorModuleUrl = customSelectorModuleUrl === "" || customSelectorModuleUrl == null ? undefined : customSelectorModuleUrl;
        extParams1 = extParams1 === "" || extParams1 == null ? undefined : extParams1;
        extParams2 = extParams2 === "" || extParams2 == null ? undefined : extParams2;
        var _a = EntityParamUtils.buildSourceVoEntityData(entities), sourceVoEntityDatas = _a.sourceVoEntityDatas, sourceVoEntityDataIds = _a.sourceVoEntityDataIds;
        //打开生单流程选择器
        this.sourceUiService.openBillCreationProcessSelector4Push(sourceVoId, bizFlowchartId, modalOptions, customSelectorModuleUrl, extParams1).subscribe((/**
         * @param {?} cp
         * @return {?}
         */
        function (cp) {
            //查询表单配置
            _this.dataService.getFormSettingsById(cp.formSettingsId).subscribe((/**
             * @param {?} formSettings
             * @return {?}
             */
            function (formSettings) {
                //创建执行生单流程参数对象
                /** @type {?} */
                var args = new FormBillCreationProcessExecutorArgs();
                args.billCreationProcessId = cp.id;
                args.creationRuleId = cp.creationRuleId;
                //FormCreationRuleExecutorArgs的sourceVoEntityDatas属性为前端实体序列化后的字符串列表
                //sourceVoEntityDatas列表中的每个字符串，在结构上应与单据流定义中所选中的上游视图对象一致。
                args.sourceVoEntityDatas = sourceVoEntityDatas;
                args.sourceVoEntityDataIds = sourceVoEntityDataIds;
                //下推过程中不存在目标主表单据Id，所以targetVoDataIds为空列表。
                args.targetVoDataIds = [];
                args.manualCreationMode = ManualCreationMode.Push;
                //执行生单流程
                _this.dataService.executeBillCreationProcess(args).subscribe((/**
                 * @param {?} result
                 * @return {?}
                 */
                function (result) {
                    //Mapping执行条件判断结果为true时才会执行生单流程得到生单结果
                    if (result.conditionResult.conditionExecutionResult == true) {
                        //生单结果不为空
                        if (result.creationRuleExecutorResult && result.creationRuleExecutorResult.mappingResults && result.creationRuleExecutorResult.mappingResults.length > 0) {
                            if (result.pushCreationMode == null || result.pushCreationMode == PushCreationMode.CREATION) {
                                _this.dataService.addFormBillCreationProcessExecutorResult(result).subscribe((/**
                                 * @param {?} res
                                 * @return {?}
                                 */
                                function (res) {
                                    //打开目标单据制单界面
                                    _this.sourceUiService.openTargetApp(formSettings, result.conditionResult, res, tslib_1.__assign({ action: targetCommand }, extParams2));
                                }), (/**
                                 * @param {?} err
                                 * @return {?}
                                 */
                                function (err) {
                                    _this.messagerService.error(err.error == null ? err.message : (err.error.Message || err.error.message || err.message));
                                }));
                            }
                            else if (result.pushCreationMode == PushCreationMode.TASKCENTER) {
                                //推送任务中心
                                /** @type {?} */
                                var pushTaskArgs = new PushTaskArgs();
                                pushTaskArgs.suCode = result.downBillSuCode;
                                pushTaskArgs.creationRuleExecutorResult = result.creationRuleExecutorResult;
                                _this.dataService.pushTaskCenter(pushTaskArgs).subscribe((/**
                                 * @return {?}
                                 */
                                function () {
                                    _this.messagerService.success(_this.localePipe.transform("pushTaskCenterSuccess"));
                                }), (/**
                                 * @param {?} err
                                 * @return {?}
                                 */
                                function (err) {
                                    _this.messagerService.error((err.error == null ? err.message : (err.error.innerMessage || err.error.Message || err.error.message || err.message)) || _this.localePipe.transform("pushTaskCenterFailed"));
                                }));
                            }
                        }
                        else {
                            _this.messagerService.error(_this.localePipe.transform("creationResultEmpty"));
                        }
                    }
                    else {
                        //为false时可得到配置的错误提示信息
                        _this.messagerService.error(result.conditionResult.message || _this.localePipe.transform("creationExecutionError"));
                    }
                }), (/**
                 * @param {?} err
                 * @return {?}
                 */
                function (err) {
                    _this.messagerService.error(err.error == null ? err.message : (err.error.Message || err.error.message || err.message));
                }));
            }), (/**
             * @param {?} err
             * @return {?}
             */
            function (err) {
                _this.messagerService.error(err.error == null ? err.message : (err.error.Message || err.error.message || err.message));
            }));
        }), (/**
         * @param {?} err
         * @return {?}
         */
        function (err) {
            _this.messagerService.error(err.error == null ? err.message : (err.error.Message || err.error.message || err.message));
        }));
    };
    /**
     * 特定下推，根据来源VO Id和目标VO Id打开生单流程选择器并执行选中的生单流程
     *
     * @param sourceVoId 单据流来源视图对象 Id
     * @param targetVoId 单据流目标视图对象 Id
     * @param entities 参与生单的上游单据ID列表或实体列表
     * @param targetCommand 目标单据'单据流加载'命令的编号
     * @param bizFlowchartId 业务场景图Id
     * @param modalOptions 弹窗配置
     * @param customSelectorModuleUrl 自定义选择器url
     * @param extParams1 打开生单流程选择器弹窗扩展参数
     * @param extParams2 打开目标单据制单界面扩展参数
     */
    /**
     * 特定下推，根据来源VO Id和目标VO Id打开生单流程选择器并执行选中的生单流程
     *
     * @param {?} sourceVoId 单据流来源视图对象 Id
     * @param {?} targetVoId 单据流目标视图对象 Id
     * @param {?} entities 参与生单的上游单据ID列表或实体列表
     * @param {?=} targetCommand 目标单据'单据流加载'命令的编号
     * @param {?=} bizFlowchartId 业务场景图Id
     * @param {?=} modalOptions 弹窗配置
     * @param {?=} customSelectorModuleUrl 自定义选择器url
     * @param {?=} extParams1 打开生单流程选择器弹窗扩展参数
     * @param {?=} extParams2 打开目标单据制单界面扩展参数
     * @return {?}
     */
    BifManualCreationSourceWebCmpService.prototype.pushBySourceVoIdAndTargetVoId = /**
     * 特定下推，根据来源VO Id和目标VO Id打开生单流程选择器并执行选中的生单流程
     *
     * @param {?} sourceVoId 单据流来源视图对象 Id
     * @param {?} targetVoId 单据流目标视图对象 Id
     * @param {?} entities 参与生单的上游单据ID列表或实体列表
     * @param {?=} targetCommand 目标单据'单据流加载'命令的编号
     * @param {?=} bizFlowchartId 业务场景图Id
     * @param {?=} modalOptions 弹窗配置
     * @param {?=} customSelectorModuleUrl 自定义选择器url
     * @param {?=} extParams1 打开生单流程选择器弹窗扩展参数
     * @param {?=} extParams2 打开目标单据制单界面扩展参数
     * @return {?}
     */
    function (sourceVoId, targetVoId, entities, targetCommand, bizFlowchartId, modalOptions, customSelectorModuleUrl, extParams1, extParams2) {
        var _this = this;
        if (sourceVoId == null || sourceVoId == "" || sourceVoId.trim && sourceVoId.trim() == "") {
            this.messagerService.error(this.localePipe.transform("sourceVoIdCantBeEmpty"));
            throw "参数sourceVoId不可为空";
        }
        if (targetVoId == null || targetVoId == "" || targetVoId.trim && targetVoId.trim() == "") {
            this.messagerService.error(this.localePipe.transform("targetVoIdVoIdCantBeEmpty"));
            throw "参数targetVoId不可为空";
        }
        if (entities == null || ((/** @type {?} */ (entities))) == "") {
            this.messagerService.error(this.localePipe.transform("entitiesCantBeEmpty"));
            throw "参数entities不可为空";
        }
        if (entities instanceof Map) {
            entities = Array.from(entities.values());
        }
        entities = Array.isArray(entities) ? entities : [entities];
        bizFlowchartId = bizFlowchartId === "" || bizFlowchartId == null ? undefined : bizFlowchartId;
        modalOptions = (/** @type {?} */ (modalOptions)) === "" || modalOptions == null ? undefined : modalOptions;
        customSelectorModuleUrl = customSelectorModuleUrl === "" || customSelectorModuleUrl == null ? undefined : customSelectorModuleUrl;
        extParams1 = extParams1 === "" || extParams1 == null ? undefined : extParams1;
        extParams2 = extParams2 === "" || extParams2 == null ? undefined : extParams2;
        var _a = EntityParamUtils.buildSourceVoEntityData(entities), sourceVoEntityDatas = _a.sourceVoEntityDatas, sourceVoEntityDataIds = _a.sourceVoEntityDataIds;
        //打开生单流程选择器
        this.sourceUiService.openBillCreationProcessSelector4SpecificPush(sourceVoId, targetVoId, bizFlowchartId, modalOptions, customSelectorModuleUrl, extParams1).subscribe((/**
         * @param {?} cp
         * @return {?}
         */
        function (cp) {
            //查询表单配置
            _this.dataService.getFormSettingsById(cp.formSettingsId).subscribe((/**
             * @param {?} formSettings
             * @return {?}
             */
            function (formSettings) {
                //创建执行生单流程参数对象
                /** @type {?} */
                var args = new FormBillCreationProcessExecutorArgs();
                args.billCreationProcessId = cp.id;
                args.creationRuleId = cp.creationRuleId;
                //FormCreationRuleExecutorArgs的sourceVoEntityDatas属性为前端实体序列化后的字符串列表
                //sourceVoEntityDatas列表中的每个字符串，在结构上应与单据流定义中所选中的上游视图对象一致。
                args.sourceVoEntityDatas = sourceVoEntityDatas;
                args.sourceVoEntityDataIds = sourceVoEntityDataIds;
                //下推过程中不存在目标主表单据Id，所以targetVoDataIds为空列表。
                args.targetVoDataIds = [];
                args.manualCreationMode = ManualCreationMode.SpecificPush;
                //执行生单流程
                _this.dataService.executeBillCreationProcess(args).subscribe((/**
                 * @param {?} result
                 * @return {?}
                 */
                function (result) {
                    //Mapping执行条件判断结果为true时才会执行生单流程得到生单结果
                    if (result.conditionResult.conditionExecutionResult == true) {
                        //生单结果不为空
                        if (result.creationRuleExecutorResult && result.creationRuleExecutorResult.mappingResults && result.creationRuleExecutorResult.mappingResults.length > 0) {
                            if (result.pushCreationMode == null || result.pushCreationMode == PushCreationMode.CREATION) {
                                _this.dataService.addFormBillCreationProcessExecutorResult(result).subscribe((/**
                                 * @param {?} res
                                 * @return {?}
                                 */
                                function (res) {
                                    //打开目标单据制单界面
                                    _this.sourceUiService.openTargetApp(formSettings, result.conditionResult, res, tslib_1.__assign({ action: targetCommand }, extParams2));
                                }), (/**
                                 * @param {?} err
                                 * @return {?}
                                 */
                                function (err) {
                                    _this.messagerService.error(err.error == null ? err.message : (err.error.Message || err.error.message || err.message));
                                }));
                            }
                            else if (result.pushCreationMode == PushCreationMode.TASKCENTER) {
                                //推送任务中心
                                /** @type {?} */
                                var pushTaskArgs = new PushTaskArgs();
                                pushTaskArgs.suCode = result.downBillSuCode;
                                pushTaskArgs.creationRuleExecutorResult = result.creationRuleExecutorResult;
                                _this.dataService.pushTaskCenter(pushTaskArgs).subscribe((/**
                                 * @return {?}
                                 */
                                function () {
                                    _this.messagerService.success(_this.localePipe.transform("pushTaskCenterSuccess"));
                                }), (/**
                                 * @param {?} err
                                 * @return {?}
                                 */
                                function (err) {
                                    _this.messagerService.error((err.error == null ? err.message : (err.error.innerMessage || err.error.Message || err.error.message || err.message)) || _this.localePipe.transform("pushTaskCenterFailed"));
                                }));
                            }
                        }
                        else {
                            _this.messagerService.error(_this.localePipe.transform("creationResultEmpty"));
                        }
                    }
                    else {
                        //为false时可得到配置的错误提示信息
                        _this.messagerService.error(result.conditionResult.message || _this.localePipe.transform("creationExecutionError"));
                    }
                }), (/**
                 * @param {?} err
                 * @return {?}
                 */
                function (err) {
                    _this.messagerService.error(err.error == null ? err.message : (err.error.Message || err.error.message || err.message));
                }));
            }), (/**
             * @param {?} err
             * @return {?}
             */
            function (err) {
                _this.messagerService.error(err.error == null ? err.message : (err.error.Message || err.error.message || err.message));
            }));
        }), (/**
         * @param {?} err
         * @return {?}
         */
        function (err) {
            _this.messagerService.error(err.error == null ? err.message : (err.error.Message || err.error.message || err.message));
        }));
    };
    /**
     * 特定下推，根据生单流程ID执行选中的生单流程
     *
     * @param processId 单据流生单流程 Id
     * @param entities 参与生单的上游单据ID列表或实体列表
     * @param targetCommand 目标单据'单据流加载'命令的编号
     * @param extParams 打开目标单据制单界面扩展参数
     */
    /**
     * 特定下推，根据生单流程ID执行选中的生单流程
     *
     * @param {?} processId 单据流生单流程 Id
     * @param {?} entities 参与生单的上游单据ID列表或实体列表
     * @param {?=} targetCommand 目标单据'单据流加载'命令的编号
     * @param {?=} extParams 打开目标单据制单界面扩展参数
     * @return {?}
     */
    BifManualCreationSourceWebCmpService.prototype.pushByCreationProcessId = /**
     * 特定下推，根据生单流程ID执行选中的生单流程
     *
     * @param {?} processId 单据流生单流程 Id
     * @param {?} entities 参与生单的上游单据ID列表或实体列表
     * @param {?=} targetCommand 目标单据'单据流加载'命令的编号
     * @param {?=} extParams 打开目标单据制单界面扩展参数
     * @return {?}
     */
    function (processId, entities, targetCommand, extParams) {
        var _this = this;
        if (processId == null || processId == "" || processId.trim() == "") {
            this.messagerService.error(this.localePipe.transform("processIdCantBeEmpty"));
            throw "参数processId不可为空";
        }
        if (entities == null || ((/** @type {?} */ (entities))) == "") {
            this.messagerService.error(this.localePipe.transform("entitiesCantBeEmpty"));
            throw "参数entities不可为空";
        }
        if (entities instanceof Map) {
            entities = Array.from(entities.values());
        }
        entities = Array.isArray(entities) ? entities : [entities];
        extParams = extParams === "" || extParams == null ? undefined : extParams;
        var _a = EntityParamUtils.buildSourceVoEntityData(entities), sourceVoEntityDatas = _a.sourceVoEntityDatas, sourceVoEntityDataIds = _a.sourceVoEntityDataIds;
        //查找生单流程
        this.dataService.getSlimBillCreationProcessEntityExById(processId).subscribe((/**
         * @param {?} cp
         * @return {?}
         */
        function (cp) {
            //查询表单配置
            _this.dataService.getFormSettingsById(cp.formSettingsId).subscribe((/**
             * @param {?} formSettings
             * @return {?}
             */
            function (formSettings) {
                //创建执行生单流程参数对象
                /** @type {?} */
                var args = new FormBillCreationProcessExecutorArgs();
                args.billCreationProcessId = cp.id;
                args.creationRuleId = cp.creationRuleId;
                //FormCreationRuleExecutorArgs的sourceVoEntityDatas属性为前端实体序列化后的字符串列表
                //sourceVoEntityDatas列表中的每个字符串，在结构上应与单据流定义中所选中的上游视图对象一致。
                args.sourceVoEntityDatas = sourceVoEntityDatas;
                args.sourceVoEntityDataIds = sourceVoEntityDataIds;
                //下推过程中不存在目标主表单据Id，所以targetVoDataIds为空列表。
                args.targetVoDataIds = [];
                args.manualCreationMode = ManualCreationMode.SpecificPush;
                //执行生单流程
                _this.dataService.executeBillCreationProcess(args).subscribe((/**
                 * @param {?} result
                 * @return {?}
                 */
                function (result) {
                    //Mapping执行条件判断结果为true时才会执行生单流程得到生单结果
                    if (result.conditionResult.conditionExecutionResult == true) {
                        //生单结果不为空
                        if (result.creationRuleExecutorResult && result.creationRuleExecutorResult.mappingResults && result.creationRuleExecutorResult.mappingResults.length > 0) {
                            if (result.pushCreationMode == null || result.pushCreationMode == PushCreationMode.CREATION) {
                                _this.dataService.addFormBillCreationProcessExecutorResult(result).subscribe((/**
                                 * @param {?} res
                                 * @return {?}
                                 */
                                function (res) {
                                    //打开目标单据制单界面
                                    _this.sourceUiService.openTargetApp(formSettings, result.conditionResult, res, tslib_1.__assign({ action: targetCommand }, extParams));
                                }), (/**
                                 * @param {?} err
                                 * @return {?}
                                 */
                                function (err) {
                                    _this.messagerService.error(err.error == null ? err.message : (err.error.Message || err.error.message || err.message));
                                }));
                            }
                            else if (result.pushCreationMode == PushCreationMode.TASKCENTER) {
                                //推送任务中心
                                /** @type {?} */
                                var pushTaskArgs = new PushTaskArgs();
                                pushTaskArgs.suCode = result.downBillSuCode;
                                pushTaskArgs.creationRuleExecutorResult = result.creationRuleExecutorResult;
                                _this.dataService.pushTaskCenter(pushTaskArgs).subscribe((/**
                                 * @return {?}
                                 */
                                function () {
                                    _this.messagerService.success(_this.localePipe.transform("pushTaskCenterSuccess"));
                                }), (/**
                                 * @param {?} err
                                 * @return {?}
                                 */
                                function (err) {
                                    _this.messagerService.error((err.error == null ? err.message : (err.error.innerMessage || err.error.Message || err.error.message || err.message)) || _this.localePipe.transform("pushTaskCenterFailed"));
                                }));
                            }
                        }
                        else {
                            _this.messagerService.error(_this.localePipe.transform("creationResultEmpty"));
                        }
                    }
                    else {
                        //为false时可得到配置的错误提示信息
                        _this.messagerService.error(result.conditionResult.message || _this.localePipe.transform("creationExecutionError"));
                    }
                }), (/**
                 * @param {?} err
                 * @return {?}
                 */
                function (err) {
                    _this.messagerService.error(err.error == null ? err.message : (err.error.Message || err.error.message || err.message));
                }));
            }), (/**
             * @param {?} err
             * @return {?}
             */
            function (err) {
                _this.messagerService.error(err.error == null ? err.message : (err.error.Message || err.error.message || err.message));
            }));
        }), (/**
         * @param {?} err
         * @return {?}
         */
        function (err) {
            _this.messagerService.error(err.error == null ? err.message : (err.error.Message || err.error.message || err.message));
        }));
    };
    /**
     * 根据来源VO Id打开生单流程选择器选择生单流程
     * @param sourceVoId 来源VO Id
     * @param bizFlowchartId 业务场景图Id
     * @param modalOptions 模态框配置
     * @param customSelectorModuleUrl 自定义选择器Url
     * @param extParams 扩展参数
     * @returns creationProcess 生单流程 @type { Observable<IRtSlimBillCreationProcessEntityEx> }
     */
    /**
     * 根据来源VO Id打开生单流程选择器选择生单流程
     * @param {?} sourceVoId 来源VO Id
     * @param {?=} bizFlowchartId 业务场景图Id
     * @param {?=} modalOptions 模态框配置
     * @param {?=} customSelectorModuleUrl 自定义选择器Url
     * @param {?=} extParams 扩展参数
     * @return {?} creationProcess 生单流程 \@type { Observable<IRtSlimBillCreationProcessEntityEx> }
     */
    BifManualCreationSourceWebCmpService.prototype.openBillCreationProcessSelector4Push = /**
     * 根据来源VO Id打开生单流程选择器选择生单流程
     * @param {?} sourceVoId 来源VO Id
     * @param {?=} bizFlowchartId 业务场景图Id
     * @param {?=} modalOptions 模态框配置
     * @param {?=} customSelectorModuleUrl 自定义选择器Url
     * @param {?=} extParams 扩展参数
     * @return {?} creationProcess 生单流程 \@type { Observable<IRtSlimBillCreationProcessEntityEx> }
     */
    function (sourceVoId, bizFlowchartId, modalOptions, customSelectorModuleUrl, extParams) {
        if (sourceVoId == null || sourceVoId == "" || sourceVoId.trim && sourceVoId.trim() == "") {
            this.messagerService.error(this.localePipe.transform("sourceVoIdCantBeEmpty"));
            throw "参数sourceVoId不可为空";
        }
        bizFlowchartId = bizFlowchartId === "" || bizFlowchartId == null ? undefined : bizFlowchartId;
        modalOptions = (/** @type {?} */ (modalOptions)) === "" || modalOptions == null ? undefined : modalOptions;
        customSelectorModuleUrl = customSelectorModuleUrl === "" || customSelectorModuleUrl == null ? undefined : customSelectorModuleUrl;
        extParams = extParams === "" || extParams == null ? undefined : extParams;
        return this.sourceUiService.openBillCreationProcessSelector4Push(sourceVoId, bizFlowchartId, modalOptions, customSelectorModuleUrl, extParams);
    };
    /**
     * 根据来源VO Id和目标VO Id打开生单流程选择器选择生单流程
     * @param sourceVoId 来源VO Id
     * @param targetVoId 目标VO Id
     * @param bizFlowchartId 业务场景图Id
     * @param modalOptions 模态框配置
     * @param customSelectorModuleUrl 自定义选择器Url
     * @param extParams 扩展参数
     * @returns creationProcess 生单流程 @type { Observable<IRtSlimBillCreationProcessEntityEx> }
     */
    /**
     * 根据来源VO Id和目标VO Id打开生单流程选择器选择生单流程
     * @param {?} sourceVoId 来源VO Id
     * @param {?} targetVoId 目标VO Id
     * @param {?=} bizFlowchartId 业务场景图Id
     * @param {?=} modalOptions 模态框配置
     * @param {?=} customSelectorModuleUrl 自定义选择器Url
     * @param {?=} extParams 扩展参数
     * @return {?} creationProcess 生单流程 \@type { Observable<IRtSlimBillCreationProcessEntityEx> }
     */
    BifManualCreationSourceWebCmpService.prototype.openBillCreationProcessSelector4SpecificPush = /**
     * 根据来源VO Id和目标VO Id打开生单流程选择器选择生单流程
     * @param {?} sourceVoId 来源VO Id
     * @param {?} targetVoId 目标VO Id
     * @param {?=} bizFlowchartId 业务场景图Id
     * @param {?=} modalOptions 模态框配置
     * @param {?=} customSelectorModuleUrl 自定义选择器Url
     * @param {?=} extParams 扩展参数
     * @return {?} creationProcess 生单流程 \@type { Observable<IRtSlimBillCreationProcessEntityEx> }
     */
    function (sourceVoId, targetVoId, bizFlowchartId, modalOptions, customSelectorModuleUrl, extParams) {
        if (sourceVoId == null || sourceVoId == "" || sourceVoId.trim && sourceVoId.trim() == "") {
            this.messagerService.error(this.localePipe.transform("sourceVoIdCantBeEmpty"));
            throw "参数sourceVoId不可为空";
        }
        if (targetVoId == null || targetVoId == "" || targetVoId.trim && targetVoId.trim() == "") {
            this.messagerService.error(this.localePipe.transform("targetVoIdVoIdCantBeEmpty"));
            throw "参数targetVoId不可为空";
        }
        bizFlowchartId = bizFlowchartId === "" || bizFlowchartId == null ? undefined : bizFlowchartId;
        modalOptions = (/** @type {?} */ (modalOptions)) === "" || modalOptions == null ? undefined : modalOptions;
        customSelectorModuleUrl = customSelectorModuleUrl === "" || customSelectorModuleUrl == null ? undefined : customSelectorModuleUrl;
        extParams = extParams === "" || extParams == null ? undefined : extParams;
        //打开生单流程选择器
        return this.sourceUiService.openBillCreationProcessSelector4SpecificPush(sourceVoId, targetVoId, bizFlowchartId, modalOptions, customSelectorModuleUrl, extParams);
    };
    /**
     * @Deprecated 已弃用，请使用 {@link openTargetApp }
     * 打开目标单据制单界面
     * @param formSettings 表单配置
     * @param result 生单流程执行结果
     * @param targetCommand 目标表单命令
     * @param extParams 扩展参数
     */
    /**
     * \@Deprecated 已弃用，请使用 {\@link openTargetApp }
     * 打开目标单据制单界面
     * @param {?} formSettings 表单配置
     * @param {?} result 生单流程执行结果
     * @param {?=} targetCommand 目标表单命令
     * @param {?=} extParams 扩展参数
     * @return {?}
     */
    BifManualCreationSourceWebCmpService.prototype.openTargetForm = /**
     * \@Deprecated 已弃用，请使用 {\@link openTargetApp }
     * 打开目标单据制单界面
     * @param {?} formSettings 表单配置
     * @param {?} result 生单流程执行结果
     * @param {?=} targetCommand 目标表单命令
     * @param {?=} extParams 扩展参数
     * @return {?}
     */
    function (formSettings, result, targetCommand, extParams) {
        this.sourceUiService.openTargetForm(formSettings, result, tslib_1.__assign({ action: targetCommand }, extParams));
    };
    /**
     * 打开目标单据制单界面
     * @param formSettings 表单配置
     * @param conditionResult 执行条件计算结果
     * @param targetCommand 目标表单命令
     * @param extParams 扩展参数
     */
    /**
     * 打开目标单据制单界面
     * @param {?} formSettings 表单配置
     * @param {?} conditionResult 执行条件计算结果
     * @param {?} textIdWithDataIds
     * @param {?=} targetCommand 目标表单命令
     * @param {?=} extParams 扩展参数
     * @return {?}
     */
    BifManualCreationSourceWebCmpService.prototype.openTargetApp = /**
     * 打开目标单据制单界面
     * @param {?} formSettings 表单配置
     * @param {?} conditionResult 执行条件计算结果
     * @param {?} textIdWithDataIds
     * @param {?=} targetCommand 目标表单命令
     * @param {?=} extParams 扩展参数
     * @return {?}
     */
    function (formSettings, conditionResult, textIdWithDataIds, targetCommand, extParams) {
        this.sourceUiService.openTargetApp(formSettings, conditionResult, textIdWithDataIds, tslib_1.__assign({ action: targetCommand }, extParams));
    };
    BifManualCreationSourceWebCmpService.decorators = [
        { type: Injectable }
    ];
    /** @nocollapse */
    BifManualCreationSourceWebCmpService.ctorParameters = function () { return [
        { type: BifSourceUiService },
        { type: BifDataService },
        { type: BindingData },
        { type: MessagerService },
        { type: ViewModel, decorators: [{ type: Optional }] },
        { type: FrameContext, decorators: [{ type: Optional }] }
    ]; };
    return BifManualCreationSourceWebCmpService;
}());
export { BifManualCreationSourceWebCmpService };
if (false) {
    /** @type {?} */
    BifManualCreationSourceWebCmpService.prototype.localePipe;
    /** @type {?} */
    BifManualCreationSourceWebCmpService.prototype.sourceUiService;
    /** @type {?} */
    BifManualCreationSourceWebCmpService.prototype.dataService;
    /** @type {?} */
    BifManualCreationSourceWebCmpService.prototype.bindingData;
    /** @type {?} */
    BifManualCreationSourceWebCmpService.prototype.messagerService;
    /** @type {?} */
    BifManualCreationSourceWebCmpService.prototype.viewModel;
    /** @type {?} */
    BifManualCreationSourceWebCmpService.prototype.frameContext;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYmlmLW1hbnVhbC1jcmVhdGlvbi1zb3VyY2Uud2ViY21wLnNlcnZpY2UuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZWRwLWJpZi9ydW50aW1lLWFwaS8iLCJzb3VyY2VzIjpbImxpYi93ZWJjbXAvYmlmLW1hbnVhbC1jcmVhdGlvbi1zb3VyY2Uud2ViY21wLnNlcnZpY2UudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUEsT0FBTyxFQUFFLFVBQVUsRUFBRSxRQUFRLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFHckQsT0FBTyxFQUFFLGVBQWUsRUFBRSxNQUFNLHFCQUFxQixDQUFDO0FBR3RELE9BQU8sRUFBVSxXQUFXLEVBQUUsU0FBUyxFQUFFLFlBQVksRUFBaUIsTUFBTSxnQkFBZ0IsQ0FBQztBQUU3RixPQUFPLEVBQWdCLGdCQUFnQixFQUFFLE1BQU0scUJBQXFCLENBQUM7QUFFckUsT0FBTyxFQUFFLG1DQUFtQyxFQUFFLE1BQU0seURBQXlELENBQUM7QUFFOUcsT0FBTyxFQUFFLGNBQWMsRUFBRSxNQUFNLGlEQUFpRCxDQUFDO0FBQ2pGLE9BQU8sRUFBRSxrQkFBa0IsRUFBRSxNQUFNLHNEQUFzRCxDQUFDO0FBQzFGLE9BQU8sRUFBRSxVQUFVLEVBQUUsTUFBTSx5Q0FBeUMsQ0FBQztBQUNyRSxPQUFPLEVBQUUsWUFBWSxFQUFFLE1BQU0sMENBQTBDLENBQUM7QUFFeEUsT0FBTyxFQUFFLGtCQUFrQixFQUFFLE1BQU0sd0NBQXdDLENBQUM7QUFDNUUsT0FBTyxFQUFFLGdCQUFnQixFQUFFLE1BQU0sb0JBQW9CLENBQUM7Ozs7QUFLdEQ7SUFJRSw4Q0FDUyxlQUFtQyxFQUNuQyxXQUEyQixFQUMzQixXQUF3QixFQUN4QixlQUFnQyxFQUNwQixTQUFvQixFQUNwQixZQUEwQjtRQUx0QyxvQkFBZSxHQUFmLGVBQWUsQ0FBb0I7UUFDbkMsZ0JBQVcsR0FBWCxXQUFXLENBQWdCO1FBQzNCLGdCQUFXLEdBQVgsV0FBVyxDQUFhO1FBQ3hCLG9CQUFl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QyxVQUFVLEVBQUUsVUFBVSxFQUFFLGNBQWMsRUFBRSxZQUFZLEVBQUUsdUJBQXVCLEVBQUUsU0FBUyxDQUFDLENBQUM7SUFDckssQ0FBQztJQUVEOzs7Ozs7O09BT0c7Ozs7Ozs7Ozs7SUFDSSw2REFBYzs7Ozs7Ozs7O0lBQXJCLFVBQXNCLFlBQTBCLEVBQUUsTUFBNkMsRUFBRSxhQUFzQixFQUFFLFNBQWM7UUFDckksSUFBSSxDQUFDLGVBQWUsQ0FBQyxjQUFjLENBQUMsWUFBWSxFQUFFLE1BQU0scUJBQUksTUFBTSxFQUFFLGFBQWEsSUFBSyxTQUFTLEVBQUcsQ0FBQztJQUNyRyxDQUFDO0lBRUQ7Ozs7OztPQU1HOzs7Ozs7Ozs7O0lBQ0ksNERBQWE7Ozs7Ozs7OztJQUFwQixVQUFxQixZQUEwQixFQUFFLGVBQWdDLEVBQUUsaUJBQTRDLEVBQUUsYUFBc0IsRUFBRSxTQUFjO1FBQ3JLLElBQUksQ0FBQyxlQUFlLENBQUMsYUFBYSxDQUFDLFlBQVksRUFBRSxlQUFlLEVBQUUsaUJBQWlCLHFCQUFJLE1BQU0sRUFBRSxhQUFhLElBQUssU0FBUyxFQUFHLENBQUM7SUFDaEksQ0FBQzs7Z0JBclpGLFVBQVU7Ozs7Z0JBVkYsa0JBQWtCO2dCQURsQixjQUFjO2dCQU5OLFdBQVc7Z0JBSG5CLGVBQWU7Z0JBR00sU0FBUyx1QkEwQmxDLFFBQVE7Z0JBMUI0QixZQUFZLHVCQTJCaEQsUUFBUTs7SUE0WWIsMkNBQUM7Q0FBQSxBQXRaRCxJQXNaQztTQXJaWSxvQ0FBb0M7OztJQUMvQywwREFBOEI7O0lBRzVCLCtEQUEwQzs7SUFDMUMsMkRBQWtDOztJQUNsQywyREFBK0I7O0lBQy9CLCtEQUF1Qzs7SUFDdkMseURBQXVDOztJQUN2Qyw0REFBNkMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBJbmplY3RhYmxlLCBPcHRpb25hbCB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBPYnNlcnZhYmxlIH0gZnJvbSAncnhqcyc7XHJcblxyXG5pbXBvcnQgeyBNZXNzYWdlclNlcnZpY2UgfSBmcm9tIFwiQGZhcnJpcy91aS1tZXNzYWdlclwiO1xyXG5pbXBvcnQgeyBNb2RhbE9wdGlvbnMgfSBmcm9tICdAZmFycmlzL3VpLW1vZGFsJztcclxuXHJcbmltcG9ydCB7IEVudGl0eSwgQmluZGluZ0RhdGEsIFZpZXdNb2RlbCwgRnJhbWVDb250ZXh0LCBCaW5kaW5nT2JqZWN0IH0gZnJvbSBcIkBmYXJyaXMvZGV2a2l0XCI7XHJcblxyXG5pbXBvcnQgeyBGb3JtU2V0dGluZ3MsIFB1c2hDcmVhdGlvbk1vZGUgfSBmcm9tIFwiQGVkcC1haWYvY29tbW9uLWFwaVwiO1xyXG5pbXBvcnQgeyBJUnRTbGltQmlsbENyZWF0aW9uUHJvY2Vzc0VudGl0eUV4IH0gZnJvbSBcIkBlZHAtYmlmL2NvbW1vbi1hcGlcIjtcclxuaW1wb3J0IHsgRm9ybUJpbGxDcmVhdGlvblByb2Nlc3NFeGVjdXRvckFyZ3MgfSBmcm9tICcuLi9lbnRpdHkvZm9ybS1yZXN0L0Zvcm1CaWxsQ3JlYXRpb25Qcm9jZXNzRXhlY3V0b3JBcmdzJztcclxuaW1wb3J0IHsgQ29uZGl0aW9uUmVzdWx0LCBGb3JtQmlsbENyZWF0aW9uUHJvY2Vzc0V4ZWN1dG9yUmVzdWx0IH0gZnJvbSAnQGVkcC1haWYvcnVudGltZS1hcGknO1xyXG5pbXBvcnQgeyBCaWZEYXRhU2VydmljZSB9IGZyb20gJy4uL2JpZi1tYW51YWwtY3JlYXRpb24vc2VydmljZS9iaWYtZGF0YS5zZXJ2aWNlJztcclxuaW1wb3J0IHsgQmlmU291cmNlVWlTZXJ2aWNlIH0gZnJvbSAnLi4vYmlmLW1hbnVhbC1jcmVhdGlvbi9zZXJ2aWNlL2JpZi1zb3VyY2UtdWkuc2VydmljZSc7XHJcbmltcG9ydCB7IExvY2FsZVBpcGUgfSBmcm9tICcuLi9iaWYtbWFudWFsLWNyZWF0aW9uL3BpcGUvbG9jYWxlLnBpcGUnO1xyXG5pbXBvcnQgeyBQdXNoVGFza0FyZ3MgfSBmcm9tICcuLi9iaWYtbWFudWFsLWNyZWF0aW9uL2FyZ3MvUHVzaFRhc2tBcmdzJztcclxuaW1wb3J0IHsgR2VuZXJhbFRleHRJZFdpdGhEYXRhSWQgfSBmcm9tICcuLi9lbnRpdHkvZm9ybS1yZXN0L0dlbmVyYWxUZXh0SWRXaXRoRGF0YUlkJztcclxuaW1wb3J0IHsgTWFudWFsQ3JlYXRpb25Nb2RlIH0gZnJvbSAnLi4vZW50aXR5L2Zvcm0tcmVzdC9NYW51YWxDcmVhdGlvbk1vZGUnO1xyXG5pbXBvcnQgeyBFbnRpdHlQYXJhbVV0aWxzIH0gZnJvbSAnLi9FbnRpdHlQYXJhbVV0aWxzJztcclxuXHJcbi8qKlxyXG4gKiDmiYvlt6XnlJ/ljZXmnaXmupDnq6/mnI3liqHnsbtcclxuICovXHJcbkBJbmplY3RhYmxlKClcclxuZXhwb3J0IGNsYXNzIEJpZk1hbnVhbENyZWF0aW9uU291cmNlV2ViQ21wU2VydmljZSB7XHJcbiAgcHVibGljIGxvY2FsZVBpcGU6IExvY2FsZVBpcGU7XHJcblxyXG4gIGNvbnN0cnVjdG9yKFxyXG4gICAgcHVibGljIHNvdXJjZVVpU2VydmljZTogQmlmU291cmNlVWlTZXJ2aWNlLFxyXG4gICAgcHVibGljIGRhdGFTZXJ2aWNlOiBCaWZEYXRhU2VydmljZSxcclxuICAgIHB1YmxpYyBiaW5kaW5nRGF0YTogQmluZGluZ0RhdGEsXHJcbiAgICBwdWJsaWMgbWVzc2FnZXJTZXJ2aWNlOiBNZXNzYWdlclNlcnZpY2UsXHJcbiAgICBAT3B0aW9uYWwoKSBwdWJsaWMgdmlld01vZGVsOiBWaWV3TW9kZWwsXHJcbiAgICBAT3B0aW9uYWwoKSBwdWJsaWMgZnJhbWVDb250ZXh0OiBGcmFtZUNvbnRleHQsXHJcbiAgKSB7XHJcbiAgICB0aGlzLmxvY2FsZVBpcGUgPSBuZXcgTG9jYWxlUGlwZSh0aGlzLnNvdXJjZVVpU2VydmljZSAmJiB0aGlzLnNvdXJjZVVpU2VydmljZS5sb2NhbGVJZCB8fCAnemgtQ0hTJyk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDkuIvmjqjvvIzmoLnmja7mnaXmupBWTyBJZOaJk+W8gOeUn+WNlea1geeoi+mAieaLqeWZqOW5tuaJp+ihjOmAieS4reeahOeUn+WNlea1geeoi1xyXG4gICAqXHJcbiAgICogQHBhcmFtIHNvdXJjZVZvSWQg5Y2V5o2u5rWB5p2l5rqQ6KeG5Zu+5a+56LGhIElkXHJcbiAgICogQHBhcmFtIGVudGl0aWVzIOWPguS4jueUn+WNleeahOS4iua4uOWNleaNrklE5YiX6KGo5oiW5a6e5L2T5YiX6KGoXHJcbiAgICogQHBhcmFtIHRhcmdldENvbW1hbmQg55uu5qCH5Y2V5o2uJ+WNleaNrua1geWKoOi9vSflkb3ku6TnmoTnvJblj7dcclxuICAgKiBAcGFyYW0gYml6Rmxvd2NoYXJ0SWQg5Lia5Yqh5Zy65pmv5Zu+SWRcclxuICAgKiBAcGFyYW0gbW9kYWxPcHRpb25zIOW8ueeql+mFjee9rlxyXG4gICAqIEBwYXJhbSBjdXN0b21TZWxlY3Rvck1vZHVsZVVybCDoh6rlrprkuYnpgInmi6nlmah1cmxcclxuICAgKiBAcGFyYW0gZXh0UGFyYW1zMSDmiZPlvIDnlJ/ljZXmtYHnqIvpgInmi6nlmajlvLnnqpfmianlsZXlj4LmlbBcclxuICAgKiBAcGFyYW0gZXh0UGFyYW1zMiDmiZPlvIDnm67moIfljZXmja7liLbljZXnlYzpnaLmianlsZXlj4LmlbBcclxuICAgKi9cclxuICBwdWJsaWMgcHVzaEJ5U291cmNlVm9JZChzb3VyY2VWb0lkOiBzdHJpbmcsIGVudGl0aWVzOiBhbnlbXSwgdGFyZ2V0Q29tbWFuZD86IHN0cmluZywgYml6Rmxvd2NoYXJ0SWQ/OiBzdHJpbmcsIG1vZGFsT3B0aW9ucz86IE1vZGFsT3B0aW9ucywgY3VzdG9tU2VsZWN0b3JNb2R1bGVVcmw/OiBzdHJpbmcsIGV4dFBhcmFtczE/OiB7fSwgZXh0UGFyYW1zMj86IHt9KSB7XHJcbiAgICBpZiAoc291cmNlVm9JZCA9PSBudWxsIHx8IHNvdXJjZVZvSWQgPT0gXCJcIiB8fCBzb3VyY2VWb0lkLnRyaW0gJiYgc291cmNlVm9JZC50cmltKCkgPT0gXCJcIikge1xyXG4gICAgICB0aGlzLm1lc3NhZ2VyU2VydmljZS5lcnJvcih0aGlzLmxvY2FsZVBpcGUudHJhbnNmb3JtKFwic291cmNlVm9JZENhbnRCZUVtcHR5XCIpKTtcclxuICAgICAgdGhyb3cgXCLlj4LmlbBzb3VyY2VWb0lk5LiN5Y+v5Li656m6XCI7XHJcbiAgICB9XHJcbiAgICAvLyDlj4LmlbDkuLrnqbrml7blsJ3or5Xku47moLnnu4Tku7ZCaW5kaW5nRGF0YeS4iuWPlmlk77yM6I635Y+W5ZCO5LuN5Li656m65YiZ5oql6ZSZXHJcbiAgICBpZiAoZW50aXRpZXMgPT0gbnVsbCB8fCAoZW50aXRpZXMgYXMgYW55KSA9PSBcIlwiKSB7XHJcbiAgICAgIHRyeSB7XHJcbiAgICAgICAgZW50aXRpZXMgPSB0aGlzLmZyYW1lQ29udGV4dC5yb290LmJpbmRpbmdEYXRhLmdldE9iamVjdCgpLmlkO1xyXG4gICAgICB9IGNhdGNoIChlKSB7XHJcblxyXG4gICAgICB9XHJcbiAgICAgIGlmIChlbnRpdGllcyA9PSBudWxsIHx8IChlbnRpdGllcyBhcyBhbnkpID09IFwiXCIpIHtcclxuICAgICAgICB0aGlzLm1lc3NhZ2VyU2VydmljZS5lcnJvcih0aGlzLmxvY2FsZVBpcGUudHJhbnNmb3JtKFwiZW50aXRpZXNDYW50QmVFbXB0eVwiKSk7XHJcbiAgICAgICAgdGhyb3cgXCLlj4LmlbBlbnRpdGllc+S4jeWPr+S4uuepulwiO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBpZiAoZW50aXRpZXMgaW5zdGFuY2VvZiBNYXApIHtcclxuICAgICAgZW50aXRpZXMgPSBBcnJheS5mcm9tKGVudGl0aWVzLnZhbHVlcygpKTtcclxuICAgIH1cclxuICAgIGVudGl0aWVzID0gQXJyYXkuaXNBcnJheShlbnRpdGllcykgPyBlbnRpdGllcyA6IFtlbnRpdGllc107XHJcblxyXG4gICAgYml6Rmxvd2NoYXJ0SWQgPSBiaXpGbG93Y2hhcnRJZCA9PT0gXCJcIiB8fCBiaXpGbG93Y2hhcnRJZCA9PSBudWxsID8gdW5kZWZpbmVkIDogYml6Rmxvd2NoYXJ0SWQ7XHJcbiAgICBtb2RhbE9wdGlvbnMgPSBtb2RhbE9wdGlvbnMgYXMgYW55ID09PSBcIlwiIHx8IG1vZGFsT3B0aW9ucyA9PSBudWxsID8gdW5kZWZpbmVkIDogbW9kYWxPcHRpb25zO1xyXG4gICAgY3VzdG9tU2VsZWN0b3JNb2R1bGVVcmwgPSBjdXN0b21TZWxlY3Rvck1vZHVsZVVybCA9PT0gXCJcIiB8fCBjdXN0b21TZWxlY3Rvck1vZHVsZVVybCA9PSBudWxsID8gdW5kZWZpbmVkIDogY3VzdG9tU2VsZWN0b3JNb2R1bGVVcmw7XHJcbiAgICBleHRQYXJhbXMxID0gZXh0UGFyYW1zMSA9PT0gXCJcIiB8fCBleHRQYXJhbXMxID09IG51bGwgPyB1bmRlZmluZWQgOiBleHRQYXJhbXMxO1xyXG4gICAgZXh0UGFyYW1zMiA9IGV4dFBhcmFtczIgPT09IFwiXCIgfHwgZXh0UGFyYW1zMiA9PSBudWxsID8gdW5kZWZpbmVkIDogZXh0UGFyYW1zMjtcclxuXHJcbiAgICBjb25zdCB7IHNvdXJjZVZvRW50aXR5RGF0YXMsIHNvdXJjZVZvRW50aXR5RGF0YUlkcyB9ID0gRW50aXR5UGFyYW1VdGlscy5idWlsZFNvdXJjZVZvRW50aXR5RGF0YShlbnRpdGllcyk7XHJcblxyXG4gICAgLy/miZPlvIDnlJ/ljZXmtYHnqIvpgInmi6nlmahcclxuICAgIHRoaXMuc291cmNlVWlTZXJ2aWNlLm9wZW5CaWxsQ3JlYXRpb25Qcm9jZXNzU2VsZWN0b3I0UHVzaChzb3VyY2VWb0lkLCBiaXpGbG93Y2hhcnRJZCwgbW9kYWxPcHRpb25zLCBjdXN0b21TZWxlY3Rvck1vZHVsZVVybCwgZXh0UGFyYW1zMSkuc3Vic2NyaWJlKFxyXG4gICAgICAoY3A6IElSdFNsaW1CaWxsQ3JlYXRpb25Qcm9jZXNzRW50aXR5RXgpID0+IHtcclxuICAgICAgICAvL+afpeivouihqOWNlemFjee9rlxyXG4gICAgICAgIHRoaXMuZGF0YVNlcnZpY2UuZ2V0Rm9ybVNldHRpbmdzQnlJZChjcC5mb3JtU2V0dGluZ3NJZCkuc3Vic2NyaWJlKFxyXG4gICAgICAgICAgKGZvcm1TZXR0aW5nczogRm9ybVNldHRpbmdzKSA9PiB7XHJcbiAgICAgICAgICAgIC8v5Yib5bu65omn6KGM55Sf5Y2V5rWB56iL5Y+C5pWw5a+56LGhXHJcbiAgICAgICAgICAgIGNvbnN0IGFyZ3MgPSBuZXcgRm9ybUJpbGxDcmVhdGlvblByb2Nlc3NFeGVjdXRvckFyZ3MoKTtcclxuICAgICAgICAgICAgYXJncy5iaWxsQ3JlYXRpb25Qcm9jZXNzSWQgPSBjcC5pZDtcclxuICAgICAgICAgICAgYXJncy5jcmVhdGlvblJ1bGVJZCA9IGNwLmNyZWF0aW9uUnVsZUlkO1xyXG4gICAgICAgICAgICAvL0Zvcm1DcmVhdGlvblJ1bGVFeGVjdXRvckFyZ3PnmoRzb3VyY2VWb0VudGl0eURhdGFz5bGe5oCn5Li65YmN56uv5a6e5L2T5bqP5YiX5YyW5ZCO55qE5a2X56ym5Liy5YiX6KGoXHJcbiAgICAgICAgICAgIC8vc291cmNlVm9FbnRpdHlEYXRhc+WIl+ihqOS4reeahOavj+S4quWtl+espuS4su+8jOWcqOe7k+aehOS4iuW6lOS4juWNleaNrua1geWumuS5ieS4reaJgOmAieS4reeahOS4iua4uOinhuWbvuWvueixoeS4gOiHtOOAglxyXG4gICAgICAgICAgICBhcmdzLnNvdXJjZVZvRW50aXR5RGF0YXMgPSBzb3VyY2VWb0VudGl0eURhdGFzO1xyXG4gICAgICAgICAgICBhcmdzLnNvdXJjZVZvRW50aXR5RGF0YUlkcyA9IHNvdXJjZVZvRW50aXR5RGF0YUlkcztcclxuICAgICAgICAgICAgLy/kuIvmjqjov4fnqIvkuK3kuI3lrZjlnKjnm67moIfkuLvooajljZXmja5JZO+8jOaJgOS7pXRhcmdldFZvRGF0YUlkc+S4uuepuuWIl+ihqOOAglxyXG4gICAgICAgICAgICBhcmdzLnRhcmdldFZvRGF0YUlkcyA9IFtdO1xyXG4gICAgICAgICAgICBhcmdzLm1hbnVhbENyZWF0aW9uTW9kZSA9IE1hbnVhbENyZWF0aW9uTW9kZS5QdXNoO1xyXG4gICAgICAgICAgICAvL+aJp+ihjOeUn+WNlea1geeoi1xyXG4gICAgICAgICAgICB0aGlzLmRhdGFTZXJ2aWNlLmV4ZWN1dGVCaWxsQ3JlYXRpb25Qcm9jZXNzKGFyZ3MpLnN1YnNjcmliZShcclxuICAgICAgICAgICAgICAocmVzdWx0OiBGb3JtQmlsbENyZWF0aW9uUHJvY2Vzc0V4ZWN1dG9yUmVzdWx0KSA9PiB7XHJcbiAgICAgICAgICAgICAgICAvL01hcHBpbmfmiafooYzmnaHku7bliKTmlq3nu5PmnpzkuLp0cnVl5pe25omN5Lya5omn6KGM55Sf5Y2V5rWB56iL5b6X5Yiw55Sf5Y2V57uT5p6cXHJcbiAgICAgICAgICAgICAgICBpZiAocmVzdWx0LmNvbmRpdGlvblJlc3VsdC5jb25kaXRpb25FeGVjdXRpb25SZXN1bHQgPT0gdHJ1ZSkge1xyXG4gICAgICAgICAgICAgICAgICAvL+eUn+WNlee7k+aenOS4jeS4uuepulxyXG4gICAgICAgICAgICAgICAgICBpZiAocmVzdWx0LmNyZWF0aW9uUnVsZUV4ZWN1dG9yUmVzdWx0ICYmIHJlc3VsdC5jcmVhdGlvblJ1bGVFeGVjdXRvclJlc3VsdC5tYXBwaW5nUmVzdWx0cyAmJiByZXN1bHQuY3JlYXRpb25SdWxlRXhlY3V0b3JSZXN1bHQubWFwcGluZ1Jlc3VsdHMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChyZXN1bHQucHVzaENyZWF0aW9uTW9kZSA9PSBudWxsIHx8IHJlc3VsdC5wdXNoQ3JlYXRpb25Nb2RlID09IFB1c2hDcmVhdGlvbk1vZGUuQ1JFQVRJT04pIHtcclxuICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZGF0YVNlcnZpY2UuYWRkRm9ybUJpbGxDcmVhdGlvblByb2Nlc3NFeGVjdXRvclJlc3VsdChyZXN1bHQpLnN1YnNjcmliZShcclxuICAgICAgICAgICAgICAgICAgICAgICAgKHJlcykgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIC8v5omT5byA55uu5qCH5Y2V5o2u5Yi25Y2V55WM6Z2iXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zb3VyY2VVaVNlcnZpY2Uub3BlblRhcmdldEFwcChmb3JtU2V0dGluZ3MsIHJlc3VsdC5jb25kaXRpb25SZXN1bHQsIHJlcywgeyBhY3Rpb246IHRhcmdldENvbW1hbmQsIC4uLmV4dFBhcmFtczIgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIChlcnIpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm1lc3NhZ2VyU2VydmljZS5lcnJvcihlcnIuZXJyb3IgPT0gbnVsbCA/IGVyci5tZXNzYWdlIDogKGVyci5lcnJvci5NZXNzYWdlIHx8IGVyci5lcnJvci5tZXNzYWdlIHx8IGVyci5tZXNzYWdlKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChyZXN1bHQucHVzaENyZWF0aW9uTW9kZSA9PSBQdXNoQ3JlYXRpb25Nb2RlLlRBU0tDRU5URVIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgIC8v5o6o6YCB5Lu75Yqh5Lit5b+DXHJcbiAgICAgICAgICAgICAgICAgICAgICBjb25zdCBwdXNoVGFza0FyZ3MgPSBuZXcgUHVzaFRhc2tBcmdzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICBwdXNoVGFza0FyZ3Muc3VDb2RlID0gcmVzdWx0LmRvd25CaWxsU3VDb2RlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgcHVzaFRhc2tBcmdzLmNyZWF0aW9uUnVsZUV4ZWN1dG9yUmVzdWx0ID0gcmVzdWx0LmNyZWF0aW9uUnVsZUV4ZWN1dG9yUmVzdWx0O1xyXG4gICAgICAgICAgICAgICAgICAgICAgdGhpcy5kYXRhU2VydmljZS5wdXNoVGFza0NlbnRlcihwdXNoVGFza0FyZ3MpLnN1YnNjcmliZShcclxuICAgICAgICAgICAgICAgICAgICAgICAgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubWVzc2FnZXJTZXJ2aWNlLnN1Y2Nlc3ModGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybShcInB1c2hUYXNrQ2VudGVyU3VjY2Vzc1wiKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIChlcnIpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm1lc3NhZ2VyU2VydmljZS5lcnJvcigoZXJyLmVycm9yID09IG51bGwgPyBlcnIubWVzc2FnZSA6IChlcnIuZXJyb3IuaW5uZXJNZXNzYWdlIHx8IGVyci5lcnJvci5NZXNzYWdlIHx8IGVyci5lcnJvci5tZXNzYWdlIHx8IGVyci5tZXNzYWdlKSkgfHwgdGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybShcInB1c2hUYXNrQ2VudGVyRmFpbGVkXCIpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5tZXNzYWdlclNlcnZpY2UuZXJyb3IodGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybShcImNyZWF0aW9uUmVzdWx0RW1wdHlcIikpO1xyXG4gICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAvL+S4umZhbHNl5pe25Y+v5b6X5Yiw6YWN572u55qE6ZSZ6K+v5o+Q56S65L+h5oGvXHJcbiAgICAgICAgICAgICAgICAgIHRoaXMubWVzc2FnZXJTZXJ2aWNlLmVycm9yKHJlc3VsdC5jb25kaXRpb25SZXN1bHQubWVzc2FnZSB8fCB0aGlzLmxvY2FsZVBpcGUudHJhbnNmb3JtKFwiY3JlYXRpb25FeGVjdXRpb25FcnJvclwiKSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAoZXJyKSA9PiB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm1lc3NhZ2VyU2VydmljZS5lcnJvcihlcnIuZXJyb3IgPT0gbnVsbCA/IGVyci5tZXNzYWdlIDogKGVyci5lcnJvci5NZXNzYWdlIHx8IGVyci5lcnJvci5tZXNzYWdlIHx8IGVyci5tZXNzYWdlKSk7XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgICAgfSxcclxuICAgICAgICAgIChlcnIpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5tZXNzYWdlclNlcnZpY2UuZXJyb3IoZXJyLmVycm9yID09IG51bGwgPyBlcnIubWVzc2FnZSA6IChlcnIuZXJyb3IuTWVzc2FnZSB8fCBlcnIuZXJyb3IubWVzc2FnZSB8fCBlcnIubWVzc2FnZSkpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICk7XHJcbiAgICAgIH0sXHJcbiAgICAgIChlcnIpID0+IHtcclxuICAgICAgICB0aGlzLm1lc3NhZ2VyU2VydmljZS5lcnJvcihlcnIuZXJyb3IgPT0gbnVsbCA/IGVyci5tZXNzYWdlIDogKGVyci5lcnJvci5NZXNzYWdlIHx8IGVyci5lcnJvci5tZXNzYWdlIHx8IGVyci5tZXNzYWdlKSk7XHJcbiAgICAgIH1cclxuICAgICk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDnibnlrprkuIvmjqjvvIzmoLnmja7mnaXmupBWTyBJZOWSjOebruagh1ZPIElk5omT5byA55Sf5Y2V5rWB56iL6YCJ5oup5Zmo5bm25omn6KGM6YCJ5Lit55qE55Sf5Y2V5rWB56iLXHJcbiAgICpcclxuICAgKiBAcGFyYW0gc291cmNlVm9JZCDljZXmja7mtYHmnaXmupDop4blm77lr7nosaEgSWRcclxuICAgKiBAcGFyYW0gdGFyZ2V0Vm9JZCDljZXmja7mtYHnm67moIfop4blm77lr7nosaEgSWRcclxuICAgKiBAcGFyYW0gZW50aXRpZXMg5Y+C5LiO55Sf5Y2V55qE5LiK5ri45Y2V5o2uSUTliJfooajmiJblrp7kvZPliJfooahcclxuICAgKiBAcGFyYW0gdGFyZ2V0Q29tbWFuZCDnm67moIfljZXmja4n5Y2V5o2u5rWB5Yqg6L29J+WRveS7pOeahOe8luWPt1xyXG4gICAqIEBwYXJhbSBiaXpGbG93Y2hhcnRJZCDkuJrliqHlnLrmma/lm75JZFxyXG4gICAqIEBwYXJhbSBtb2RhbE9wdGlvbnMg5by556qX6YWN572uXHJcbiAgICogQHBhcmFtIGN1c3RvbVNlbGVjdG9yTW9kdWxlVXJsIOiHquWumuS5iemAieaLqeWZqHVybFxyXG4gICAqIEBwYXJhbSBleHRQYXJhbXMxIOaJk+W8gOeUn+WNlea1geeoi+mAieaLqeWZqOW8ueeql+aJqeWxleWPguaVsFxyXG4gICAqIEBwYXJhbSBleHRQYXJhbXMyIOaJk+W8gOebruagh+WNleaNruWItuWNleeVjOmdouaJqeWxleWPguaVsFxyXG4gICAqL1xyXG4gIHB1YmxpYyBwdXNoQnlTb3VyY2VWb0lkQW5kVGFyZ2V0Vm9JZChzb3VyY2VWb0lkOiBzdHJpbmcsIHRhcmdldFZvSWQ6IHN0cmluZywgZW50aXRpZXM6IEVudGl0eVtdLCB0YXJnZXRDb21tYW5kPzogc3RyaW5nLCBiaXpGbG93Y2hhcnRJZD86IHN0cmluZywgbW9kYWxPcHRpb25zPzogTW9kYWxPcHRpb25zLCBjdXN0b21TZWxlY3Rvck1vZHVsZVVybD86IHN0cmluZywgZXh0UGFyYW1zMT86IHt9LCBleHRQYXJhbXMyPzoge30pIHtcclxuICAgIGlmIChzb3VyY2VWb0lkID09IG51bGwgfHwgc291cmNlVm9JZCA9PSBcIlwiIHx8IHNvdXJjZVZvSWQudHJpbSAmJiBzb3VyY2VWb0lkLnRyaW0oKSA9PSBcIlwiKSB7XHJcbiAgICAgIHRoaXMubWVzc2FnZXJTZXJ2aWNlLmVycm9yKHRoaXMubG9jYWxlUGlwZS50cmFuc2Zvcm0oXCJzb3VyY2VWb0lkQ2FudEJlRW1wdHlcIikpO1xyXG4gICAgICB0aHJvdyBcIuWPguaVsHNvdXJjZVZvSWTkuI3lj6/kuLrnqbpcIjtcclxuICAgIH1cclxuICAgIGlmICh0YXJnZXRWb0lkID09IG51bGwgfHwgdGFyZ2V0Vm9JZCA9PSBcIlwiIHx8IHRhcmdldFZvSWQudHJpbSAmJiB0YXJnZXRWb0lkLnRyaW0oKSA9PSBcIlwiKSB7XHJcbiAgICAgIHRoaXMubWVzc2FnZXJTZXJ2aWNlLmVycm9yKHRoaXMubG9jYWxlUGlwZS50cmFuc2Zvcm0oXCJ0YXJnZXRWb0lkVm9JZENhbnRCZUVtcHR5XCIpKTtcclxuICAgICAgdGhyb3cgXCLlj4LmlbB0YXJnZXRWb0lk5LiN5Y+v5Li656m6XCI7XHJcbiAgICB9XHJcbiAgICBpZiAoZW50aXRpZXMgPT0gbnVsbCB8fCAoZW50aXRpZXMgYXMgYW55KSA9PSBcIlwiKSB7XHJcbiAgICAgIHRoaXMubWVzc2FnZXJTZXJ2aWNlLmVycm9yKHRoaXMubG9jYWxlUGlwZS50cmFuc2Zvcm0oXCJlbnRpdGllc0NhbnRCZUVtcHR5XCIpKTtcclxuICAgICAgdGhyb3cgXCLlj4LmlbBlbnRpdGllc+S4jeWPr+S4uuepulwiO1xyXG4gICAgfVxyXG4gICAgaWYgKGVudGl0aWVzIGluc3RhbmNlb2YgTWFwKSB7XHJcbiAgICAgIGVudGl0aWVzID0gQXJyYXkuZnJvbShlbnRpdGllcy52YWx1ZXMoKSk7XHJcbiAgICB9XHJcbiAgICBlbnRpdGllcyA9IEFycmF5LmlzQXJyYXkoZW50aXRpZXMpID8gZW50aXRpZXMgOiBbZW50aXRpZXNdO1xyXG5cclxuICAgIGJpekZsb3djaGFydElkID0gYml6Rmxvd2NoYXJ0SWQgPT09IFwiXCIgfHwgYml6Rmxvd2NoYXJ0SWQgPT0gbnVsbCA/IHVuZGVmaW5lZCA6IGJpekZsb3djaGFydElkO1xyXG4gICAgbW9kYWxPcHRpb25zID0gbW9kYWxPcHRpb25zIGFzIGFueSA9PT0gXCJcIiB8fCBtb2RhbE9wdGlvbnMgPT0gbnVsbCA/IHVuZGVmaW5lZCA6IG1vZGFsT3B0aW9ucztcclxuICAgIGN1c3RvbVNlbGVjdG9yTW9kdWxlVXJsID0gY3VzdG9tU2VsZWN0b3JNb2R1bGVVcmwgPT09IFwiXCIgfHwgY3VzdG9tU2VsZWN0b3JNb2R1bGVVcmwgPT0gbnVsbCA/IHVuZGVmaW5lZCA6IGN1c3RvbVNlbGVjdG9yTW9kdWxlVXJsO1xyXG4gICAgZXh0UGFyYW1zMSA9IGV4dFBhcmFtczEgPT09IFwiXCIgfHwgZXh0UGFyYW1zMSA9PSBudWxsID8gdW5kZWZpbmVkIDogZXh0UGFyYW1zMTtcclxuICAgIGV4dFBhcmFtczIgPSBleHRQYXJhbXMyID09PSBcIlwiIHx8IGV4dFBhcmFtczIgPT0gbnVsbCA/IHVuZGVmaW5lZCA6IGV4dFBhcmFtczI7XHJcblxyXG4gICAgY29uc3QgeyBzb3VyY2VWb0VudGl0eURhdGFzLCBzb3VyY2VWb0VudGl0eURhdGFJZHMgfSA9IEVudGl0eVBhcmFtVXRpbHMuYnVpbGRTb3VyY2VWb0VudGl0eURhdGEoZW50aXRpZXMpO1xyXG4gICAgLy/miZPlvIDnlJ/ljZXmtYHnqIvpgInmi6nlmahcclxuICAgIHRoaXMuc291cmNlVWlTZXJ2aWNlLm9wZW5CaWxsQ3JlYXRpb25Qcm9jZXNzU2VsZWN0b3I0U3BlY2lmaWNQdXNoKHNvdXJjZVZvSWQsIHRhcmdldFZvSWQsIGJpekZsb3djaGFydElkLCBtb2RhbE9wdGlvbnMsIGN1c3RvbVNlbGVjdG9yTW9kdWxlVXJsLCBleHRQYXJhbXMxKS5zdWJzY3JpYmUoXHJcbiAgICAgIChjcDogSVJ0U2xpbUJpbGxDcmVhdGlvblByb2Nlc3NFbnRpdHlFeCkgPT4ge1xyXG4gICAgICAgIC8v5p+l6K+i6KGo5Y2V6YWN572uXHJcbiAgICAgICAgdGhpcy5kYXRhU2VydmljZS5nZXRGb3JtU2V0dGluZ3NCeUlkKGNwLmZvcm1TZXR0aW5nc0lkKS5zdWJzY3JpYmUoXHJcbiAgICAgICAgICAoZm9ybVNldHRpbmdzOiBGb3JtU2V0dGluZ3MpID0+IHtcclxuICAgICAgICAgICAgLy/liJvlu7rmiafooYznlJ/ljZXmtYHnqIvlj4LmlbDlr7nosaFcclxuICAgICAgICAgICAgY29uc3QgYXJncyA9IG5ldyBGb3JtQmlsbENyZWF0aW9uUHJvY2Vzc0V4ZWN1dG9yQXJncygpO1xyXG4gICAgICAgICAgICBhcmdzLmJpbGxDcmVhdGlvblByb2Nlc3NJZCA9IGNwLmlkO1xyXG4gICAgICAgICAgICBhcmdzLmNyZWF0aW9uUnVsZUlkID0gY3AuY3JlYXRpb25SdWxlSWQ7XHJcbiAgICAgICAgICAgIC8vRm9ybUNyZWF0aW9uUnVsZUV4ZWN1dG9yQXJnc+eahHNvdXJjZVZvRW50aXR5RGF0YXPlsZ7mgKfkuLrliY3nq6/lrp7kvZPluo/liJfljJblkI7nmoTlrZfnrKbkuLLliJfooahcclxuICAgICAgICAgICAgLy9zb3VyY2VWb0VudGl0eURhdGFz5YiX6KGo5Lit55qE5q+P5Liq5a2X56ym5Liy77yM5Zyo57uT5p6E5LiK5bqU5LiO5Y2V5o2u5rWB5a6a5LmJ5Lit5omA6YCJ5Lit55qE5LiK5ri46KeG5Zu+5a+56LGh5LiA6Ie044CCXHJcbiAgICAgICAgICAgIGFyZ3Muc291cmNlVm9FbnRpdHlEYXRhcyA9IHNvdXJjZVZvRW50aXR5RGF0YXM7XHJcbiAgICAgICAgICAgIGFyZ3Muc291cmNlVm9FbnRpdHlEYXRhSWRzID0gc291cmNlVm9FbnRpdHlEYXRhSWRzO1xyXG4gICAgICAgICAgICAvL+S4i+aOqOi/h+eoi+S4reS4jeWtmOWcqOebruagh+S4u+ihqOWNleaNrklk77yM5omA5LuldGFyZ2V0Vm9EYXRhSWRz5Li656m65YiX6KGo44CCXHJcbiAgICAgICAgICAgIGFyZ3MudGFyZ2V0Vm9EYXRhSWRzID0gW107XHJcbiAgICAgICAgICAgIGFyZ3MubWFudWFsQ3JlYXRpb25Nb2RlID0gTWFudWFsQ3JlYXRpb25Nb2RlLlNwZWNpZmljUHVzaDtcclxuICAgICAgICAgICAgLy/miafooYznlJ/ljZXmtYHnqItcclxuICAgICAgICAgICAgdGhpcy5kYXRhU2VydmljZS5leGVjdXRlQmlsbENyZWF0aW9uUHJvY2VzcyhhcmdzKS5zdWJzY3JpYmUoXHJcbiAgICAgICAgICAgICAgKHJlc3VsdDogRm9ybUJpbGxDcmVhdGlvblByb2Nlc3NFeGVjdXRvclJlc3VsdCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgLy9NYXBwaW5n5omn6KGM5p2h5Lu25Yik5pat57uT5p6c5Li6dHJ1ZeaXtuaJjeS8muaJp+ihjOeUn+WNlea1geeoi+W+l+WIsOeUn+WNlee7k+aenFxyXG4gICAgICAgICAgICAgICAgaWYgKHJlc3VsdC5jb25kaXRpb25SZXN1bHQuY29uZGl0aW9uRXhlY3V0aW9uUmVzdWx0ID09IHRydWUpIHtcclxuICAgICAgICAgICAgICAgICAgLy/nlJ/ljZXnu5PmnpzkuI3kuLrnqbpcclxuICAgICAgICAgICAgICAgICAgaWYgKHJlc3VsdC5jcmVhdGlvblJ1bGVFeGVjdXRvclJlc3VsdCAmJiByZXN1bHQuY3JlYXRpb25SdWxlRXhlY3V0b3JSZXN1bHQubWFwcGluZ1Jlc3VsdHMgJiYgcmVzdWx0LmNyZWF0aW9uUnVsZUV4ZWN1dG9yUmVzdWx0Lm1hcHBpbmdSZXN1bHRzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAocmVzdWx0LnB1c2hDcmVhdGlvbk1vZGUgPT0gbnVsbCB8fCByZXN1bHQucHVzaENyZWF0aW9uTW9kZSA9PSBQdXNoQ3JlYXRpb25Nb2RlLkNSRUFUSU9OKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRhdGFTZXJ2aWNlLmFkZEZvcm1CaWxsQ3JlYXRpb25Qcm9jZXNzRXhlY3V0b3JSZXN1bHQocmVzdWx0KS5zdWJzY3JpYmUoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIChyZXMpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAvL+aJk+W8gOebruagh+WNleaNruWItuWNleeVjOmdolxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc291cmNlVWlTZXJ2aWNlLm9wZW5UYXJnZXRBcHAoZm9ybVNldHRpbmdzLCByZXN1bHQuY29uZGl0aW9uUmVzdWx0LCByZXMsIHsgYWN0aW9uOiB0YXJnZXRDb21tYW5kLCAuLi5leHRQYXJhbXMyIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAoZXJyKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5tZXNzYWdlclNlcnZpY2UuZXJyb3IoZXJyLmVycm9yID09IG51bGwgPyBlcnIubWVzc2FnZSA6IChlcnIuZXJyb3IuTWVzc2FnZSB8fCBlcnIuZXJyb3IubWVzc2FnZSB8fCBlcnIubWVzc2FnZSkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAocmVzdWx0LnB1c2hDcmVhdGlvbk1vZGUgPT0gUHVzaENyZWF0aW9uTW9kZS5UQVNLQ0VOVEVSKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAvL+aOqOmAgeS7u+WKoeS4reW/g1xyXG4gICAgICAgICAgICAgICAgICAgICAgY29uc3QgcHVzaFRhc2tBcmdzID0gbmV3IFB1c2hUYXNrQXJncygpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgcHVzaFRhc2tBcmdzLnN1Q29kZSA9IHJlc3VsdC5kb3duQmlsbFN1Q29kZTtcclxuICAgICAgICAgICAgICAgICAgICAgIHB1c2hUYXNrQXJncy5jcmVhdGlvblJ1bGVFeGVjdXRvclJlc3VsdCA9IHJlc3VsdC5jcmVhdGlvblJ1bGVFeGVjdXRvclJlc3VsdDtcclxuICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZGF0YVNlcnZpY2UucHVzaFRhc2tDZW50ZXIocHVzaFRhc2tBcmdzKS5zdWJzY3JpYmUoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm1lc3NhZ2VyU2VydmljZS5zdWNjZXNzKHRoaXMubG9jYWxlUGlwZS50cmFuc2Zvcm0oXCJwdXNoVGFza0NlbnRlclN1Y2Nlc3NcIikpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAoZXJyKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5tZXNzYWdlclNlcnZpY2UuZXJyb3IoKGVyci5lcnJvciA9PSBudWxsID8gZXJyLm1lc3NhZ2UgOiAoZXJyLmVycm9yLmlubmVyTWVzc2FnZSB8fCBlcnIuZXJyb3IuTWVzc2FnZSB8fCBlcnIuZXJyb3IubWVzc2FnZSB8fCBlcnIubWVzc2FnZSkpIHx8IHRoaXMubG9jYWxlUGlwZS50cmFuc2Zvcm0oXCJwdXNoVGFza0NlbnRlckZhaWxlZFwiKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMubWVzc2FnZXJTZXJ2aWNlLmVycm9yKHRoaXMubG9jYWxlUGlwZS50cmFuc2Zvcm0oXCJjcmVhdGlvblJlc3VsdEVtcHR5XCIpKTtcclxuICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgLy/kuLpmYWxzZeaXtuWPr+W+l+WIsOmFjee9rueahOmUmeivr+aPkOekuuS/oeaBr1xyXG4gICAgICAgICAgICAgICAgICB0aGlzLm1lc3NhZ2VyU2VydmljZS5lcnJvcihyZXN1bHQuY29uZGl0aW9uUmVzdWx0Lm1lc3NhZ2UgfHwgdGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybShcImNyZWF0aW9uRXhlY3V0aW9uRXJyb3JcIikpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgKGVycikgPT4ge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5tZXNzYWdlclNlcnZpY2UuZXJyb3IoZXJyLmVycm9yID09IG51bGwgPyBlcnIubWVzc2FnZSA6IChlcnIuZXJyb3IuTWVzc2FnZSB8fCBlcnIuZXJyb3IubWVzc2FnZSB8fCBlcnIubWVzc2FnZSkpO1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgKTtcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICAoZXJyKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMubWVzc2FnZXJTZXJ2aWNlLmVycm9yKGVyci5lcnJvciA9PSBudWxsID8gZXJyLm1lc3NhZ2UgOiAoZXJyLmVycm9yLk1lc3NhZ2UgfHwgZXJyLmVycm9yLm1lc3NhZ2UgfHwgZXJyLm1lc3NhZ2UpKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICApO1xyXG4gICAgICB9LFxyXG4gICAgICAoZXJyKSA9PiB7XHJcbiAgICAgICAgdGhpcy5tZXNzYWdlclNlcnZpY2UuZXJyb3IoZXJyLmVycm9yID09IG51bGwgPyBlcnIubWVzc2FnZSA6IChlcnIuZXJyb3IuTWVzc2FnZSB8fCBlcnIuZXJyb3IubWVzc2FnZSB8fCBlcnIubWVzc2FnZSkpO1xyXG4gICAgICB9XHJcbiAgICApO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog54m55a6a5LiL5o6o77yM5qC55o2u55Sf5Y2V5rWB56iLSUTmiafooYzpgInkuK3nmoTnlJ/ljZXmtYHnqItcclxuICAgKlxyXG4gICAqIEBwYXJhbSBwcm9jZXNzSWQg5Y2V5o2u5rWB55Sf5Y2V5rWB56iLIElkXHJcbiAgICogQHBhcmFtIGVudGl0aWVzIOWPguS4jueUn+WNleeahOS4iua4uOWNleaNrklE5YiX6KGo5oiW5a6e5L2T5YiX6KGoXHJcbiAgICogQHBhcmFtIHRhcmdldENvbW1hbmQg55uu5qCH5Y2V5o2uJ+WNleaNrua1geWKoOi9vSflkb3ku6TnmoTnvJblj7dcclxuICAgKiBAcGFyYW0gZXh0UGFyYW1zIOaJk+W8gOebruagh+WNleaNruWItuWNleeVjOmdouaJqeWxleWPguaVsFxyXG4gICAqL1xyXG4gIHB1YmxpYyBwdXNoQnlDcmVhdGlvblByb2Nlc3NJZChwcm9jZXNzSWQ6IHN0cmluZywgZW50aXRpZXM6IEVudGl0eVtdLCB0YXJnZXRDb21tYW5kPzogc3RyaW5nLCBleHRQYXJhbXM/OiB7fSkge1xyXG4gICAgaWYgKHByb2Nlc3NJZCA9PSBudWxsIHx8IHByb2Nlc3NJZCA9PSBcIlwiIHx8IHByb2Nlc3NJZC50cmltKCkgPT0gXCJcIikge1xyXG4gICAgICB0aGlzLm1lc3NhZ2VyU2VydmljZS5lcnJvcih0aGlzLmxvY2FsZVBpcGUudHJhbnNmb3JtKFwicHJvY2Vzc0lkQ2FudEJlRW1wdHlcIikpO1xyXG4gICAgICB0aHJvdyBcIuWPguaVsHByb2Nlc3NJZOS4jeWPr+S4uuepulwiO1xyXG4gICAgfVxyXG4gICAgaWYgKGVudGl0aWVzID09IG51bGwgfHwgKGVudGl0aWVzIGFzIGFueSkgPT0gXCJcIikge1xyXG4gICAgICB0aGlzLm1lc3NhZ2VyU2VydmljZS5lcnJvcih0aGlzLmxvY2FsZVBpcGUudHJhbnNmb3JtKFwiZW50aXRpZXNDYW50QmVFbXB0eVwiKSk7XHJcbiAgICAgIHRocm93IFwi5Y+C5pWwZW50aXRpZXPkuI3lj6/kuLrnqbpcIjtcclxuICAgIH1cclxuICAgIGlmIChlbnRpdGllcyBpbnN0YW5jZW9mIE1hcCkge1xyXG4gICAgICBlbnRpdGllcyA9IEFycmF5LmZyb20oZW50aXRpZXMudmFsdWVzKCkpO1xyXG4gICAgfVxyXG4gICAgZW50aXRpZXMgPSBBcnJheS5pc0FycmF5KGVudGl0aWVzKSA/IGVudGl0aWVzIDogW2VudGl0aWVzXTtcclxuICAgIGV4dFBhcmFtcyA9IGV4dFBhcmFtcyA9PT0gXCJcIiB8fCBleHRQYXJhbXMgPT0gbnVsbCA/IHVuZGVmaW5lZCA6IGV4dFBhcmFtcztcclxuXHJcbiAgICBjb25zdCB7IHNvdXJjZVZvRW50aXR5RGF0YXMsIHNvdXJjZVZvRW50aXR5RGF0YUlkcyB9ID0gRW50aXR5UGFyYW1VdGlscy5idWlsZFNvdXJjZVZvRW50aXR5RGF0YShlbnRpdGllcyk7XHJcblxyXG4gICAgLy/mn6Xmib7nlJ/ljZXmtYHnqItcclxuICAgIHRoaXMuZGF0YVNlcnZpY2UuZ2V0U2xpbUJpbGxDcmVhdGlvblByb2Nlc3NFbnRpdHlFeEJ5SWQocHJvY2Vzc0lkKS5zdWJzY3JpYmUoXHJcbiAgICAgIChjcDogSVJ0U2xpbUJpbGxDcmVhdGlvblByb2Nlc3NFbnRpdHlFeCkgPT4ge1xyXG4gICAgICAgIC8v5p+l6K+i6KGo5Y2V6YWN572uXHJcbiAgICAgICAgdGhpcy5kYXRhU2VydmljZS5nZXRGb3JtU2V0dGluZ3NCeUlkKGNwLmZvcm1TZXR0aW5nc0lkKS5zdWJzY3JpYmUoXHJcbiAgICAgICAgICAoZm9ybVNldHRpbmdzOiBGb3JtU2V0dGluZ3MpID0+IHtcclxuICAgICAgICAgICAgLy/liJvlu7rmiafooYznlJ/ljZXmtYHnqIvlj4LmlbDlr7nosaFcclxuICAgICAgICAgICAgY29uc3QgYXJncyA9IG5ldyBGb3JtQmlsbENyZWF0aW9uUHJvY2Vzc0V4ZWN1dG9yQXJncygpO1xyXG4gICAgICAgICAgICBhcmdzLmJpbGxDcmVhdGlvblByb2Nlc3NJZCA9IGNwLmlkO1xyXG4gICAgICAgICAgICBhcmdzLmNyZWF0aW9uUnVsZUlkID0gY3AuY3JlYXRpb25SdWxlSWQ7XHJcbiAgICAgICAgICAgIC8vRm9ybUNyZWF0aW9uUnVsZUV4ZWN1dG9yQXJnc+eahHNvdXJjZVZvRW50aXR5RGF0YXPlsZ7mgKfkuLrliY3nq6/lrp7kvZPluo/liJfljJblkI7nmoTlrZfnrKbkuLLliJfooahcclxuICAgICAgICAgICAgLy9zb3VyY2VWb0VudGl0eURhdGFz5YiX6KGo5Lit55qE5q+P5Liq5a2X56ym5Liy77yM5Zyo57uT5p6E5LiK5bqU5LiO5Y2V5o2u5rWB5a6a5LmJ5Lit5omA6YCJ5Lit55qE5LiK5ri46KeG5Zu+5a+56LGh5LiA6Ie044CCXHJcbiAgICAgICAgICAgIGFyZ3Muc291cmNlVm9FbnRpdHlEYXRhcyA9IHNvdXJjZVZvRW50aXR5RGF0YXM7XHJcbiAgICAgICAgICAgIGFyZ3Muc291cmNlVm9FbnRpdHlEYXRhSWRzID0gc291cmNlVm9FbnRpdHlEYXRhSWRzO1xyXG4gICAgICAgICAgICAvL+S4i+aOqOi/h+eoi+S4reS4jeWtmOWcqOebruagh+S4u+ihqOWNleaNrklk77yM5omA5LuldGFyZ2V0Vm9EYXRhSWRz5Li656m65YiX6KGo44CCXHJcbiAgICAgICAgICAgIGFyZ3MudGFyZ2V0Vm9EYXRhSWRzID0gW107XHJcbiAgICAgICAgICAgIGFyZ3MubWFudWFsQ3JlYXRpb25Nb2RlID0gTWFudWFsQ3JlYXRpb25Nb2RlLlNwZWNpZmljUHVzaDtcclxuICAgICAgICAgICAgLy/miafooYznlJ/ljZXmtYHnqItcclxuICAgICAgICAgICAgdGhpcy5kYXRhU2VydmljZS5leGVjdXRlQmlsbENyZWF0aW9uUHJvY2VzcyhhcmdzKS5zdWJzY3JpYmUoXHJcbiAgICAgICAgICAgICAgKHJlc3VsdDogRm9ybUJpbGxDcmVhdGlvblByb2Nlc3NFeGVjdXRvclJlc3VsdCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgLy9NYXBwaW5n5omn6KGM5p2h5Lu25Yik5pat57uT5p6c5Li6dHJ1ZeaXtuaJjeS8muaJp+ihjOeUn+WNlea1geeoi+W+l+WIsOeUn+WNlee7k+aenFxyXG4gICAgICAgICAgICAgICAgaWYgKHJlc3VsdC5jb25kaXRpb25SZXN1bHQuY29uZGl0aW9uRXhlY3V0aW9uUmVzdWx0ID09IHRydWUpIHtcclxuICAgICAgICAgICAgICAgICAgLy/nlJ/ljZXnu5PmnpzkuI3kuLrnqbpcclxuICAgICAgICAgICAgICAgICAgaWYgKHJlc3VsdC5jcmVhdGlvblJ1bGVFeGVjdXRvclJlc3VsdCAmJiByZXN1bHQuY3JlYXRpb25SdWxlRXhlY3V0b3JSZXN1bHQubWFwcGluZ1Jlc3VsdHMgJiYgcmVzdWx0LmNyZWF0aW9uUnVsZUV4ZWN1dG9yUmVzdWx0Lm1hcHBpbmdSZXN1bHRzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAocmVzdWx0LnB1c2hDcmVhdGlvbk1vZGUgPT0gbnVsbCB8fCByZXN1bHQucHVzaENyZWF0aW9uTW9kZSA9PSBQdXNoQ3JlYXRpb25Nb2RlLkNSRUFUSU9OKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRhdGFTZXJ2aWNlLmFkZEZvcm1CaWxsQ3JlYXRpb25Qcm9jZXNzRXhlY3V0b3JSZXN1bHQocmVzdWx0KS5zdWJzY3JpYmUoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIChyZXMpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAvL+aJk+W8gOebruagh+WNleaNruWItuWNleeVjOmdolxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc291cmNlVWlTZXJ2aWNlLm9wZW5UYXJnZXRBcHAoZm9ybVNldHRpbmdzLCByZXN1bHQuY29uZGl0aW9uUmVzdWx0LCByZXMsIHsgYWN0aW9uOiB0YXJnZXRDb21tYW5kLCAuLi5leHRQYXJhbXMgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIChlcnIpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm1lc3NhZ2VyU2VydmljZS5lcnJvcihlcnIuZXJyb3IgPT0gbnVsbCA/IGVyci5tZXNzYWdlIDogKGVyci5lcnJvci5NZXNzYWdlIHx8IGVyci5lcnJvci5tZXNzYWdlIHx8IGVyci5tZXNzYWdlKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChyZXN1bHQucHVzaENyZWF0aW9uTW9kZSA9PSBQdXNoQ3JlYXRpb25Nb2RlLlRBU0tDRU5URVIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgIC8v5o6o6YCB5Lu75Yqh5Lit5b+DXHJcbiAgICAgICAgICAgICAgICAgICAgICBjb25zdCBwdXNoVGFza0FyZ3MgPSBuZXcgUHVzaFRhc2tBcmdzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICBwdXNoVGFza0FyZ3Muc3VDb2RlID0gcmVzdWx0LmRvd25CaWxsU3VDb2RlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgcHVzaFRhc2tBcmdzLmNyZWF0aW9uUnVsZUV4ZWN1dG9yUmVzdWx0ID0gcmVzdWx0LmNyZWF0aW9uUnVsZUV4ZWN1dG9yUmVzdWx0O1xyXG4gICAgICAgICAgICAgICAgICAgICAgdGhpcy5kYXRhU2VydmljZS5wdXNoVGFza0NlbnRlcihwdXNoVGFza0FyZ3MpLnN1YnNjcmliZShcclxuICAgICAgICAgICAgICAgICAgICAgICAgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubWVzc2FnZXJTZXJ2aWNlLnN1Y2Nlc3ModGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybShcInB1c2hUYXNrQ2VudGVyU3VjY2Vzc1wiKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIChlcnIpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm1lc3NhZ2VyU2VydmljZS5lcnJvcigoZXJyLmVycm9yID09IG51bGwgPyBlcnIubWVzc2FnZSA6IChlcnIuZXJyb3IuaW5uZXJNZXNzYWdlIHx8IGVyci5lcnJvci5NZXNzYWdlIHx8IGVyci5lcnJvci5tZXNzYWdlIHx8IGVyci5tZXNzYWdlKSkgfHwgdGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybShcInB1c2hUYXNrQ2VudGVyRmFpbGVkXCIpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5tZXNzYWdlclNlcnZpY2UuZXJyb3IodGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybShcImNyZWF0aW9uUmVzdWx0RW1wdHlcIikpO1xyXG4gICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAvL+S4umZhbHNl5pe25Y+v5b6X5Yiw6YWN572u55qE6ZSZ6K+v5o+Q56S65L+h5oGvXHJcbiAgICAgICAgICAgICAgICAgIHRoaXMubWVzc2FnZXJTZXJ2aWNlLmVycm9yKHJlc3VsdC5jb25kaXRpb25SZXN1bHQubWVzc2FnZSB8fCB0aGlzLmxvY2FsZVBpcGUudHJhbnNmb3JtKFwiY3JlYXRpb25FeGVjdXRpb25FcnJvclwiKSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAoZXJyKSA9PiB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm1lc3NhZ2VyU2VydmljZS5lcnJvcihlcnIuZXJyb3IgPT0gbnVsbCA/IGVyci5tZXNzYWdlIDogKGVyci5lcnJvci5NZXNzYWdlIHx8IGVyci5lcnJvci5tZXNzYWdlIHx8IGVyci5tZXNzYWdlKSk7XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgICAgfSxcclxuICAgICAgICAgIChlcnIpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5tZXNzYWdlclNlcnZpY2UuZXJyb3IoZXJyLmVycm9yID09IG51bGwgPyBlcnIubWVzc2FnZSA6IChlcnIuZXJyb3IuTWVzc2FnZSB8fCBlcnIuZXJyb3IubWVzc2FnZSB8fCBlcnIubWVzc2FnZSkpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICk7XHJcbiAgICAgIH0sXHJcbiAgICAgIChlcnIpID0+IHtcclxuICAgICAgICB0aGlzLm1lc3NhZ2VyU2VydmljZS5lcnJvcihlcnIuZXJyb3IgPT0gbnVsbCA/IGVyci5tZXNzYWdlIDogKGVyci5lcnJvci5NZXNzYWdlIHx8IGVyci5lcnJvci5tZXNzYWdlIHx8IGVyci5tZXNzYWdlKSk7XHJcbiAgICAgIH1cclxuICAgICk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDmoLnmja7mnaXmupBWTyBJZOaJk+W8gOeUn+WNlea1geeoi+mAieaLqeWZqOmAieaLqeeUn+WNlea1geeoi1xyXG4gICAqIEBwYXJhbSBzb3VyY2VWb0lkIOadpea6kFZPIElkXHJcbiAgICogQHBhcmFtIGJpekZsb3djaGFydElkIOS4muWKoeWcuuaZr+WbvklkXHJcbiAgICogQHBhcmFtIG1vZGFsT3B0aW9ucyDmqKHmgIHmoYbphY3nva5cclxuICAgKiBAcGFyYW0gY3VzdG9tU2VsZWN0b3JNb2R1bGVVcmwg6Ieq5a6a5LmJ6YCJ5oup5ZmoVXJsXHJcbiAgICogQHBhcmFtIGV4dFBhcmFtcyDmianlsZXlj4LmlbBcclxuICAgKiBAcmV0dXJucyBjcmVhdGlvblByb2Nlc3Mg55Sf5Y2V5rWB56iLIEB0eXBlIHsgT2JzZXJ2YWJsZTxJUnRTbGltQmlsbENyZWF0aW9uUHJvY2Vzc0VudGl0eUV4PiB9XHJcbiAgICovXHJcbiAgcHVibGljIG9wZW5CaWxsQ3JlYXRpb25Qcm9jZXNzU2VsZWN0b3I0UHVzaChzb3VyY2VWb0lkOiBzdHJpbmcsIGJpekZsb3djaGFydElkPzogc3RyaW5nLCBtb2RhbE9wdGlvbnM/OiBNb2RhbE9wdGlvbnMsIGN1c3RvbVNlbGVjdG9yTW9kdWxlVXJsPzogc3RyaW5nLCBleHRQYXJhbXM/OiB7fSk6IE9ic2VydmFibGU8SVJ0U2xpbUJpbGxDcmVhdGlvblByb2Nlc3NFbnRpdHlFeD4ge1xyXG4gICAgaWYgKHNvdXJjZVZvSWQgPT0gbnVsbCB8fCBzb3VyY2VWb0lkID09IFwiXCIgfHwgc291cmNlVm9JZC50cmltICYmIHNvdXJjZVZvSWQudHJpbSgpID09IFwiXCIpIHtcclxuICAgICAgdGhpcy5tZXNzYWdlclNlcnZpY2UuZXJyb3IodGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybShcInNvdXJjZVZvSWRDYW50QmVFbXB0eVwiKSk7XHJcbiAgICAgIHRocm93IFwi5Y+C5pWwc291cmNlVm9JZOS4jeWPr+S4uuepulwiO1xyXG4gICAgfVxyXG4gICAgYml6Rmxvd2NoYXJ0SWQgPSBiaXpGbG93Y2hhcnRJZCA9PT0gXCJcIiB8fCBiaXpGbG93Y2hhcnRJZCA9PSBudWxsID8gdW5kZWZpbmVkIDogYml6Rmxvd2NoYXJ0SWQ7XHJcbiAgICBtb2RhbE9wdGlvbnMgPSBtb2RhbE9wdGlvbnMgYXMgYW55ID09PSBcIlwiIHx8IG1vZGFsT3B0aW9ucyA9PSBudWxsID8gdW5kZWZpbmVkIDogbW9kYWxPcHRpb25zO1xyXG4gICAgY3VzdG9tU2VsZWN0b3JNb2R1bGVVcmwgPSBjdXN0b21TZWxlY3Rvck1vZHVsZVVybCA9PT0gXCJcIiB8fCBjdXN0b21TZWxlY3Rvck1vZHVsZVVybCA9PSBudWxsID8gdW5kZWZpbmVkIDogY3VzdG9tU2VsZWN0b3JNb2R1bGVVcmw7XHJcbiAgICBleHRQYXJhbXMgPSBleHRQYXJhbXMgPT09IFwiXCIgfHwgZXh0UGFyYW1zID09IG51bGwgPyB1bmRlZmluZWQgOiBleHRQYXJhbXM7XHJcbiAgICByZXR1cm4gdGhpcy5zb3VyY2VVaVNlcnZpY2Uub3BlbkJpbGxDcmVhdGlvblByb2Nlc3NTZWxlY3RvcjRQdXNoKHNvdXJjZVZvSWQsIGJpekZsb3djaGFydElkLCBtb2RhbE9wdGlvbnMsIGN1c3RvbVNlbGVjdG9yTW9kdWxlVXJsLCBleHRQYXJhbXMpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog5qC55o2u5p2l5rqQVk8gSWTlkoznm67moIdWTyBJZOaJk+W8gOeUn+WNlea1geeoi+mAieaLqeWZqOmAieaLqeeUn+WNlea1geeoi1xyXG4gICAqIEBwYXJhbSBzb3VyY2VWb0lkIOadpea6kFZPIElkXHJcbiAgICogQHBhcmFtIHRhcmdldFZvSWQg55uu5qCHVk8gSWRcclxuICAgKiBAcGFyYW0gYml6Rmxvd2NoYXJ0SWQg5Lia5Yqh5Zy65pmv5Zu+SWRcclxuICAgKiBAcGFyYW0gbW9kYWxPcHRpb25zIOaooeaAgeahhumFjee9rlxyXG4gICAqIEBwYXJhbSBjdXN0b21TZWxlY3Rvck1vZHVsZVVybCDoh6rlrprkuYnpgInmi6nlmahVcmxcclxuICAgKiBAcGFyYW0gZXh0UGFyYW1zIOaJqeWxleWPguaVsFxyXG4gICAqIEByZXR1cm5zIGNyZWF0aW9uUHJvY2VzcyDnlJ/ljZXmtYHnqIsgQHR5cGUgeyBPYnNlcnZhYmxlPElSdFNsaW1CaWxsQ3JlYXRpb25Qcm9jZXNzRW50aXR5RXg+IH1cclxuICAgKi9cclxuICBwdWJsaWMgb3BlbkJpbGxDcmVhdGlvblByb2Nlc3NTZWxlY3RvcjRTcGVjaWZpY1B1c2goc291cmNlVm9JZDogc3RyaW5nLCB0YXJnZXRWb0lkOiBzdHJpbmcsIGJpekZsb3djaGFydElkPzogc3RyaW5nLCBtb2RhbE9wdGlvbnM/OiBNb2RhbE9wdGlvbnMsIGN1c3RvbVNlbGVjdG9yTW9kdWxlVXJsPzogc3RyaW5nLCBleHRQYXJhbXM/OiB7fSk6IE9ic2VydmFibGU8SVJ0U2xpbUJpbGxDcmVhdGlvblByb2Nlc3NFbnRpdHlFeD4ge1xyXG4gICAgaWYgKHNvdXJjZVZvSWQgPT0gbnVsbCB8fCBzb3VyY2VWb0lkID09IFwiXCIgfHwgc291cmNlVm9JZC50cmltICYmIHNvdXJjZVZvSWQudHJpbSgpID09IFwiXCIpIHtcclxuICAgICAgdGhpcy5tZXNzYWdlclNlcnZpY2UuZXJyb3IodGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybShcInNvdXJjZVZvSWRDYW50QmVFbXB0eVwiKSk7XHJcbiAgICAgIHRocm93IFwi5Y+C5pWwc291cmNlVm9JZOS4jeWPr+S4uuepulwiO1xyXG4gICAgfVxyXG4gICAgaWYgKHRhcmdldFZvSWQgPT0gbnVsbCB8fCB0YXJnZXRWb0lkID09IFwiXCIgfHwgdGFyZ2V0Vm9JZC50cmltICYmIHRhcmdldFZvSWQudHJpbSgpID09IFwiXCIpIHtcclxuICAgICAgdGhpcy5tZXNzYWdlclNlcnZpY2UuZXJyb3IodGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybShcInRhcmdldFZvSWRWb0lkQ2FudEJlRW1wdHlcIikpO1xyXG4gICAgICB0aHJvdyBcIuWPguaVsHRhcmdldFZvSWTkuI3lj6/kuLrnqbpcIjtcclxuICAgIH1cclxuICAgIGJpekZsb3djaGFydElkID0gYml6Rmxvd2NoYXJ0SWQgPT09IFwiXCIgfHwgYml6Rmxvd2NoYXJ0SWQgPT0gbnVsbCA/IHVuZGVmaW5lZCA6IGJpekZsb3djaGFydElkO1xyXG4gICAgbW9kYWxPcHRpb25zID0gbW9kYWxPcHRpb25zIGFzIGFueSA9PT0gXCJcIiB8fCBtb2RhbE9wdGlvbnMgPT0gbnVsbCA/IHVuZGVmaW5lZCA6IG1vZGFsT3B0aW9ucztcclxuICAgIGN1c3RvbVNlbGVjdG9yTW9kdWxlVXJsID0gY3VzdG9tU2VsZWN0b3JNb2R1bGVVcmwgPT09IFwiXCIgfHwgY3VzdG9tU2VsZWN0b3JNb2R1bGVVcmwgPT0gbnVsbCA/IHVuZGVmaW5lZCA6IGN1c3RvbVNlbGVjdG9yTW9kdWxlVXJsO1xyXG4gICAgZXh0UGFyYW1zID0gZXh0UGFyYW1zID09PSBcIlwiIHx8IGV4dFBhcmFtcyA9PSBudWxsID8gdW5kZWZpbmVkIDogZXh0UGFyYW1zO1xyXG4gICAgLy/miZPlvIDnlJ/ljZXmtYHnqIvpgInmi6nlmahcclxuICAgIHJldHVybiB0aGlzLnNvdXJjZVVpU2VydmljZS5vcGVuQmlsbENyZWF0aW9uUHJvY2Vzc1NlbGVjdG9yNFNwZWNpZmljUHVzaChzb3VyY2VWb0lkLCB0YXJnZXRWb0lkLCBiaXpGbG93Y2hhcnRJZCwgbW9kYWxPcHRpb25zLCBjdXN0b21TZWxlY3Rvck1vZHVsZVVybCwgZXh0UGFyYW1zKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEBEZXByZWNhdGVkIOW3suW8g+eUqO+8jOivt+S9v+eUqCB7QGxpbmsgb3BlblRhcmdldEFwcCB9XHJcbiAgICog5omT5byA55uu5qCH5Y2V5o2u5Yi25Y2V55WM6Z2iXHJcbiAgICogQHBhcmFtIGZvcm1TZXR0aW5ncyDooajljZXphY3nva5cclxuICAgKiBAcGFyYW0gcmVzdWx0IOeUn+WNlea1geeoi+aJp+ihjOe7k+aenFxyXG4gICAqIEBwYXJhbSB0YXJnZXRDb21tYW5kIOebruagh+ihqOWNleWRveS7pFxyXG4gICAqIEBwYXJhbSBleHRQYXJhbXMg5omp5bGV5Y+C5pWwXHJcbiAgICovXHJcbiAgcHVibGljIG9wZW5UYXJnZXRGb3JtKGZvcm1TZXR0aW5nczogRm9ybVNldHRpbmdzLCByZXN1bHQ6IEZvcm1CaWxsQ3JlYXRpb25Qcm9jZXNzRXhlY3V0b3JSZXN1bHQsIHRhcmdldENvbW1hbmQ/OiBzdHJpbmcsIGV4dFBhcmFtcz86IHt9KSB7XHJcbiAgICB0aGlzLnNvdXJjZVVpU2VydmljZS5vcGVuVGFyZ2V0Rm9ybShmb3JtU2V0dGluZ3MsIHJlc3VsdCwgeyBhY3Rpb246IHRhcmdldENvbW1hbmQsIC4uLmV4dFBhcmFtcyB9KTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOaJk+W8gOebruagh+WNleaNruWItuWNleeVjOmdolxyXG4gICAqIEBwYXJhbSBmb3JtU2V0dGluZ3Mg6KGo5Y2V6YWN572uXHJcbiAgICogQHBhcmFtIGNvbmRpdGlvblJlc3VsdCDmiafooYzmnaHku7borqHnrpfnu5PmnpxcclxuICAgKiBAcGFyYW0gdGFyZ2V0Q29tbWFuZCDnm67moIfooajljZXlkb3ku6RcclxuICAgKiBAcGFyYW0gZXh0UGFyYW1zIOaJqeWxleWPguaVsFxyXG4gICAqL1xyXG4gIHB1YmxpYyBvcGVuVGFyZ2V0QXBwKGZvcm1TZXR0aW5nczogRm9ybVNldHRpbmdzLCBjb25kaXRpb25SZXN1bHQ6IENvbmRpdGlvblJlc3VsdCwgdGV4dElkV2l0aERhdGFJZHM6IEdlbmVyYWxUZXh0SWRXaXRoRGF0YUlkW10sIHRhcmdldENvbW1hbmQ/OiBzdHJpbmcsIGV4dFBhcmFtcz86IHt9KSB7XHJcbiAgICB0aGlzLnNvdXJjZVVpU2VydmljZS5vcGVuVGFyZ2V0QXBwKGZvcm1TZXR0aW5ncywgY29uZGl0aW9uUmVzdWx0LCB0ZXh0SWRXaXRoRGF0YUlkcywgeyBhY3Rpb246IHRhcmdldENvbW1hbmQsIC4uLmV4dFBhcmFtcyB9KTtcclxuICB9XHJcbn1cclxuIl19