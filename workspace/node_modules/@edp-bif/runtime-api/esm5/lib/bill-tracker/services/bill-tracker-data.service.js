/**
 * @fileoverview added by tsickle
 * Generated from: lib/bill-tracker/services/bill-tracker-data.service.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Injectable } from '@angular/core';
import { HttpService } from '@ecp-caf/caf-common';
import { of } from 'rxjs';
import { switchMap, catchError } from 'rxjs/operators';
import { HttpClient } from '@angular/common/http';
import { BpmnModelJsonHelper } from '@edp-aif/common-api';
import { GetDownBillsInfoArgs } from '../../entity/tracking/GetDownBillsInfoArgs';
import { GetUpBillsInfoArgs } from '../../entity/tracking/GetUpBillsInfoArgs';
import { GetMainEntityDataArgs } from '../args/GetMainEntityDataArgs';
import { CanTrackingResult } from '../args/CanTrackingResult';
import { DownBillInfoResult } from '../args/DownBillInfoResult';
import { UpBillInfoResult } from '../args/UpBillInfoResult';
import { EntityDataResult } from '../args/EntityDataResult';
import { BillDataInfo } from '../../entity/tracking/BillDataInfo';
import { GetBillsInfoArgs } from '../../entity/tracking/GetBillsInfoArgs';
import { JointQueryParameterType } from '@edp-bif/common-api';
import { GetJointQueryParametersArgs } from '../args';
import { JointQueryParameterResult } from '../../entity/tracking/JointQueryParameterResult';
import { JointQueryParametersContent } from '../../entity/tracking/JointQueryParametersContent';
import { ExpressionJointQueryParameterContent } from '../../entity/tracking/ExpressionJointQueryParameterContent';
import { FieldJointQueryParameterContent } from "../../entity/tracking/FieldJointQueryParameterContent";
import { JointQueryParameterMode } from '../../entity/tracking/JointQueryParameterMode';
var BillTrackerDataService = /** @class */ (function () {
    function BillTrackerDataService(httpService, httpClient) {
        this.httpService = httpService;
        this.httpClient = httpClient;
        this.baseUrl = "/api/runtime/aif/v1.0/billtracking";
        this.canTrackingUrl = this.baseUrl + "/cantracking";
        this.canTrackingMethod = "POST";
        this.getDownBillsInfoUrl = this.baseUrl + "/getdownbillsinfo";
        this.getDownBillsInfoMethod = "POST";
        this.getUpBillsInfoUrl = this.baseUrl + "/getupbillsinfo";
        this.getUpBillsInfoMethod = "POST";
        this.getEntityDataUrl = this.baseUrl + "/getentitydata";
        this.getEntityDataMethod = "POST";
        this.jointQueryParserUrl = "/api/runtime/aif/v1.0/jointquery";
        this.jointQueryParserMethod = "POST";
    }
    /**
     * @param {?} args
     * @return {?}
     */
    BillTrackerDataService.prototype.getJointQueryParameters = /**
     * @param {?} args
     * @return {?}
     */
    function (args) {
        /** @type {?} */
        var body = args.ConvertToJson();
        /** @type {?} */
        var opt = this.httpService.setHeader({ body: body });
        return this.httpService.request(this.jointQueryParserMethod, this.jointQueryParserUrl, opt).pipe(switchMap((/**
         * @param {?} res
         * @return {?}
         */
        function (res) {
            /** @type {?} */
            var obj = res;
            /** @type {?} */
            var results = (/** @type {?} */ (BpmnModelJsonHelper.FromJson(obj.value, JointQueryParameterResult)));
            return of(results);
        })), catchError((/**
         * @param {?} err
         * @return {?}
         */
        function (err) {
            try {
                if (typeof err.error == "string") {
                    err.error = JSON.parse(err.error);
                }
            }
            catch (e) {
            }
            throw err;
        })));
    };
    /**
     * @param {?} args
     * @return {?}
     */
    BillTrackerDataService.prototype.canTracking = /**
     * @param {?} args
     * @return {?}
     */
    function (args) {
        /** @type {?} */
        var opt = this.httpService.setHeader({ body: args.ConvertToJson(), responseType: "text" });
        return this.httpService.request(this.canTrackingMethod, this.canTrackingUrl, opt).pipe(switchMap((/**
         * @param {?} res
         * @return {?}
         */
        function (res) {
            /** @type {?} */
            var result = new CanTrackingResult();
            result.LoadFromJson(res);
            return of(result);
        })), catchError((/**
         * @param {?} err
         * @return {?}
         */
        function (err) {
            try {
                if (typeof err.error == "string") {
                    err.error = JSON.parse(err.error);
                }
            }
            catch (e) {
            }
            throw err;
        })));
    };
    /**
     * @param {?} args
     * @return {?}
     */
    BillTrackerDataService.prototype.getDownBillsInfo = /**
     * @param {?} args
     * @return {?}
     */
    function (args) {
        /** @type {?} */
        var opt = this.httpService.setHeader({ body: args.ConvertToJson(), responseType: "text" });
        return this.httpService.request(this.getDownBillsInfoMethod, this.getDownBillsInfoUrl, opt).pipe(switchMap((/**
         * @param {?} res
         * @return {?}
         */
        function (res) {
            /** @type {?} */
            var result = BpmnModelJsonHelper.FromJson(res, DownBillInfoResult);
            return of(result);
        })), catchError((/**
         * @param {?} err
         * @return {?}
         */
        function (err) {
            try {
                if (typeof err.error == "string") {
                    err.error = JSON.parse(err.error);
                }
            }
            catch (e) {
            }
            throw err;
        })));
    };
    /**
     * @param {?} args
     * @return {?}
     */
    BillTrackerDataService.prototype.getUpBillsInfo = /**
     * @param {?} args
     * @return {?}
     */
    function (args) {
        /** @type {?} */
        var opt = this.httpService.setHeader({ body: args.ConvertToJson(), responseType: "text" });
        return this.httpService.request(this.getUpBillsInfoMethod, this.getUpBillsInfoUrl, opt).pipe(switchMap((/**
         * @param {?} res
         * @return {?}
         */
        function (res) {
            /** @type {?} */
            var result = BpmnModelJsonHelper.FromJson(res, UpBillInfoResult);
            return of(result);
        })), catchError((/**
         * @param {?} err
         * @return {?}
         */
        function (err) {
            try {
                if (typeof err.error == "string") {
                    err.error = JSON.parse(err.error);
                }
            }
            catch (e) {
            }
            throw err;
        })));
    };
    /**
     * @param {?} args
     * @return {?}
     */
    BillTrackerDataService.prototype.getEntityData = /**
     * @param {?} args
     * @return {?}
     */
    function (args) {
        /** @type {?} */
        var opt = this.httpService.setHeader({ body: args.ConvertToJson(), responseType: "text" });
        return this.httpService.request(this.getEntityDataMethod, this.getEntityDataUrl, opt).pipe(switchMap((/**
         * @param {?} res
         * @return {?}
         */
        function (res) {
            /** @type {?} */
            var result = new EntityDataResult();
            result.LoadFromJson(res);
            return of(result);
        })), catchError((/**
         * @param {?} err
         * @return {?}
         */
        function (err) {
            try {
                if (typeof err.error == "string") {
                    err.error = JSON.parse(err.error);
                }
            }
            catch (e) {
            }
            throw err;
        })));
    };
    /**
     * @param {?} canTrackingResult
     * @return {?}
     */
    BillTrackerDataService.prototype.buildEntryBillInfo = /**
     * @param {?} canTrackingResult
     * @return {?}
     */
    function (canTrackingResult) {
        /** @type {?} */
        var info = new DownBillInfoResult();
        info.schemaId = canTrackingResult.schemaId;
        info.suCode = canTrackingResult.suCode;
        info.voName = canTrackingResult.voName;
        info.billTrackingSettings = canTrackingResult.billTrackingSettings;
        info.bizKind = canTrackingResult.bizKind;
        info.bizType = canTrackingResult.bizType;
        info.jointQueryMode = canTrackingResult.jointQueryMode;
        info.jointQueryParameters = canTrackingResult.jointQueryParameters;
        info.trackingSourceType = canTrackingResult.trackingSourceType;
        /** @type {?} */
        var dataInfo = new BillDataInfo();
        dataInfo.caption = canTrackingResult.caption;
        dataInfo.dataId = canTrackingResult.dataId;
        dataInfo.summary = canTrackingResult.summary;
        dataInfo.trackingMappingAssociations = [];
        dataInfo.billChildInfos = canTrackingResult.billChildInfos;
        dataInfo.curYear = canTrackingResult.curYear;
        info.billDataInfos = [dataInfo];
        info.documentTypeId = canTrackingResult.documentTypeId;
        return info;
    };
    /**
     * @param {?} cell
     * @return {?}
     */
    BillTrackerDataService.prototype.buildGetBillsInfoArgs = /**
     * @param {?} cell
     * @return {?}
     */
    function (cell) {
        /** @type {?} */
        var args = new GetBillsInfoArgs();
        args.billDataId = cell.billDataInfo.dataId;
        args.documentTypeId = cell.billInfo.documentTypeId;
        args.bizKind = cell.billInfo.bizKind;
        args.bizType = cell.billInfo.bizType;
        args.billChildInfos = cell.billDataInfo.billChildInfos;
        args.curYear = cell.billDataInfo.curYear;
        return args;
    };
    /**
     * @param {?} cell
     * @return {?}
     */
    BillTrackerDataService.prototype.buildGetUpBillsInfoArgs = /**
     * @param {?} cell
     * @return {?}
     */
    function (cell) {
        /** @type {?} */
        var args = new GetUpBillsInfoArgs();
        args.LoadFromJsonObject(this.buildGetBillsInfoArgs(cell).ConvertToJsonObject());
        return args;
    };
    /**
     * @param {?} cell
     * @return {?}
     */
    BillTrackerDataService.prototype.buildGetDownBillsInfoArgs = /**
     * @param {?} cell
     * @return {?}
     */
    function (cell) {
        /** @type {?} */
        var args = new GetDownBillsInfoArgs();
        args.LoadFromJsonObject(this.buildGetBillsInfoArgs(cell).ConvertToJsonObject());
        return args;
    };
    /**
     * @param {?} billInfo
     * @param {?} billDataInfo
     * @return {?}
     */
    BillTrackerDataService.prototype.buildGetMainEntityDataArgs = /**
     * @param {?} billInfo
     * @param {?} billDataInfo
     * @return {?}
     */
    function (billInfo, billDataInfo) {
        /** @type {?} */
        var args = new GetMainEntityDataArgs();
        args.dataId = billDataInfo.dataId;
        args.suCode = billInfo.suCode;
        args.schemaId = billInfo.schemaId;
        args.trackingSourceType = billInfo.trackingSourceType;
        args.billChildInfos = billDataInfo.billChildInfos;
        args.curYear = billDataInfo.curYear;
        args.documentTypeId = billInfo.documentTypeId;
        return args;
    };
    /**
     * @param {?} jointQueryParameters
     * @return {?}
     */
    BillTrackerDataService.prototype.hasDynamicParams = /**
     * @param {?} jointQueryParameters
     * @return {?}
     */
    function (jointQueryParameters) {
        if (!jointQueryParameters.params) {
            return false;
        }
        // 添加自定义参数
        if (Array.isArray(jointQueryParameters.params)) {
            return jointQueryParameters.params.find((/**
             * @param {?} p
             * @return {?}
             */
            function (p) { return p.type != JointQueryParameterType.Constant; })) != null;
        }
        else {
            return false;
        }
    };
    /**
     * 构造联查参数解析器参数
     * @param jointQueryParameters
     * @param billInfo
     * @param billDataInfo
     * @returns
     */
    /**
     * 构造联查参数解析器参数
     * @param {?} jointQueryParameters
     * @param {?} billInfo
     * @param {?} billDataInfo
     * @return {?}
     */
    BillTrackerDataService.prototype.buildGetJointQueryParametersArgs = /**
     * 构造联查参数解析器参数
     * @param {?} jointQueryParameters
     * @param {?} billInfo
     * @param {?} billDataInfo
     * @return {?}
     */
    function (jointQueryParameters, billInfo, billDataInfo) {
        /** @type {?} */
        var args = new GetJointQueryParametersArgs();
        args.dataId = billDataInfo.dataId;
        args.suCode = billInfo.suCode;
        args.schemaId = billInfo.schemaId;
        args.trackingSourceType = billInfo.trackingSourceType;
        args.curYear = billDataInfo.curYear;
        args.contents = [];
        if (Array.isArray(jointQueryParameters.params)) {
            jointQueryParameters.params.forEach((/**
             * @param {?} it
             * @return {?}
             */
            function (it) {
                if (it.type == JointQueryParameterType.Constant) {
                    return;
                }
                /** @type {?} */
                var jointQueryParametersContent = new JointQueryParametersContent();
                if (it.type == JointQueryParameterType.Field) {
                    jointQueryParametersContent.jointQueryParameterMode = JointQueryParameterMode.FIELD;
                    /** @type {?} */
                    var content = new FieldJointQueryParameterContent();
                    content.parameterCode = it.code;
                    content.fieldContent = it.value;
                    jointQueryParametersContent.content = content.ConvertToJson();
                }
                else if (it.type == JointQueryParameterType.Expression) {
                    jointQueryParametersContent.jointQueryParameterMode = JointQueryParameterMode.EXPRESSION;
                    /** @type {?} */
                    var content = new ExpressionJointQueryParameterContent();
                    content.parameterCode = it.code;
                    content.expressionContent = it.value;
                    jointQueryParametersContent.content = content.ConvertToJson();
                }
                args.contents.push(jointQueryParametersContent);
            }));
        }
        return args;
    };
    BillTrackerDataService.decorators = [
        { type: Injectable }
    ];
    /** @nocollapse */
    BillTrackerDataService.ctorParameters = function () { return [
        { type: HttpService },
        { type: HttpClient }
    ]; };
    return BillTrackerDataService;
}());
export { BillTrackerDataService };
if (false) {
    /** @type {?} */
    BillTrackerDataService.prototype.baseUrl;
    /** @type {?} */
    BillTrackerDataService.prototype.canTrackingUrl;
    /** @type {?} */
    BillTrackerDataService.prototype.canTrackingMethod;
    /** @type {?} */
    BillTrackerDataService.prototype.getDownBillsInfoUrl;
    /** @type {?} */
    BillTrackerDataService.prototype.getDownBillsInfoMethod;
    /** @type {?} */
    BillTrackerDataService.prototype.getUpBillsInfoUrl;
    /** @type {?} */
    BillTrackerDataService.prototype.getUpBillsInfoMethod;
    /** @type {?} */
    BillTrackerDataService.prototype.getEntityDataUrl;
    /** @type {?} */
    BillTrackerDataService.prototype.getEntityDataMethod;
    /** @type {?} */
    BillTrackerDataService.prototype.jointQueryParserUrl;
    /** @type {?} */
    BillTrackerDataService.prototype.jointQueryParserMethod;
    /** @type {?} */
    BillTrackerDataService.prototype.httpService;
    /** @type {?} */
    BillTrackerDataService.prototype.httpClient;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYmlsbC10cmFja2VyLWRhdGEuc2VydmljZS5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BlZHAtYmlmL3J1bnRpbWUtYXBpLyIsInNvdXJjZXMiOlsibGliL2JpbGwtdHJhY2tlci9zZXJ2aWNlcy9iaWxsLXRyYWNrZXItZGF0YS5zZXJ2aWNlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7O0FBQUEsT0FBTyxFQUFFLFVBQVUsRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUMzQyxPQUFPLEVBQUUsV0FBVyxFQUFFLE1BQU0scUJBQXFCLENBQUM7QUFDbEQsT0FBTyxFQUFjLEVBQUUsRUFBRSxNQUFNLE1BQU0sQ0FBQztBQUN0QyxPQUFPLEVBQUUsU0FBUyxFQUFFLFVBQVUsRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBQ3ZELE9BQU8sRUFBRSxVQUFVLEVBQUUsTUFBTSxzQkFBc0IsQ0FBQztBQUNsRCxPQUFPLEVBQUUsbUJBQW1CLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQztBQUMxRCxPQUFPLEVBQUUsb0JBQW9CLEVBQUUsTUFBTSw0Q0FBNEMsQ0FBQztBQUNsRixPQUFPLEVBQUUsa0JBQWtCLEVBQUUsTUFBTSwwQ0FBMEMsQ0FBQztBQUM5RSxPQUFPLEVBQUUscUJBQXFCLEVBQUUsTUFBTSwrQkFBK0IsQ0FBQztBQUN0RSxPQUFPLEVBQUUsaUJBQWlCLEVBQUUsTUFBTSwyQkFBMkIsQ0FBQztBQUM5RCxPQUFPLEVBQUUsa0JBQWtCLEVBQUUsTUFBTSw0QkFBNEIsQ0FBQztBQUNoRSxPQUFPLEVBQUUsZ0JBQWdCLEVBQUUsTUFBTSwwQkFBMEIsQ0FBQztBQUM1RCxPQUFPLEVBQUUsZ0JBQWdCLEVBQUUsTUFBTSwwQkFBMEIsQ0FBQztBQUU1RCxPQUFPLEVBQUUsWUFBWSxFQUFFLE1BQU0sb0NBQW9DLENBQUM7QUFFbEUsT0FBTyxFQUFFLGdCQUFnQixFQUFFLE1BQU0sd0NBQXdDLENBQUM7QUFFMUUsT0FBTyxFQUE2Qyx1QkFBdUIsRUFBRSxNQUFNLHFCQUFxQixD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SUFDOUQsc0RBQXVDOztJQUV2QyxrREFBNEQ7O0lBQzVELHFEQUFzQzs7SUFFdEMscURBQWtFOztJQUNsRSx3REFBeUM7O0lBR3JDLDZDQUErQjs7SUFDL0IsNENBQTZCIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgSW5qZWN0YWJsZSB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBIdHRwU2VydmljZSB9IGZyb20gJ0BlY3AtY2FmL2NhZi1jb21tb24nO1xyXG5pbXBvcnQgeyBPYnNlcnZhYmxlLCBvZiB9IGZyb20gJ3J4anMnO1xyXG5pbXBvcnQgeyBzd2l0Y2hNYXAsIGNhdGNoRXJyb3IgfSBmcm9tICdyeGpzL29wZXJhdG9ycyc7XHJcbmltcG9ydCB7IEh0dHBDbGllbnQgfSBmcm9tICdAYW5ndWxhci9jb21tb24vaHR0cCc7XHJcbmltcG9ydCB7IEJwbW5Nb2RlbEpzb25IZWxwZXIgfSBmcm9tICdAZWRwLWFpZi9jb21tb24tYXBpJztcclxuaW1wb3J0IHsgR2V0RG93bkJpbGxzSW5mb0FyZ3MgfSBmcm9tICcuLi8uLi9lbnRpdHkvdHJhY2tpbmcvR2V0RG93bkJpbGxzSW5mb0FyZ3MnO1xyXG5pbXBvcnQgeyBHZXRVcEJpbGxzSW5mb0FyZ3MgfSBmcm9tICcuLi8uLi9lbnRpdHkvdHJhY2tpbmcvR2V0VXBCaWxsc0luZm9BcmdzJztcclxuaW1wb3J0IHsgR2V0TWFpbkVudGl0eURhdGFBcmdzIH0gZnJvbSAnLi4vYXJncy9HZXRNYWluRW50aXR5RGF0YUFyZ3MnO1xyXG5pbXBvcnQgeyBDYW5UcmFja2luZ1Jlc3VsdCB9IGZyb20gJy4uL2FyZ3MvQ2FuVHJhY2tpbmdSZXN1bHQnO1xyXG5pbXBvcnQgeyBEb3duQmlsbEluZm9SZXN1bHQgfSBmcm9tICcuLi9hcmdzL0Rvd25CaWxsSW5mb1Jlc3VsdCc7XHJcbmltcG9ydCB7IFVwQmlsbEluZm9SZXN1bHQgfSBmcm9tICcuLi9hcmdzL1VwQmlsbEluZm9SZXN1bHQnO1xyXG5pbXBvcnQgeyBFbnRpdHlEYXRhUmVzdWx0IH0gZnJvbSAnLi4vYXJncy9FbnRpdHlEYXRhUmVzdWx0JztcclxuaW1wb3J0IHsgSUJpbGxUcmFja2VyRGF0YVNlcnZpY2UgfSBmcm9tICcuLi9iYXNlL0lCaWxsVHJhY2tlckRhdGFTZXJ2aWNlJztcclxuaW1wb3J0IHsgQmlsbERhdGFJbmZvIH0gZnJvbSAnLi4vLi4vZW50aXR5L3RyYWNraW5nL0JpbGxEYXRhSW5mbyc7XHJcbmltcG9ydCB7IEJpbGxDZWxsIH0gZnJvbSAnLi4vbXhncmFwaC1leHQvQmlsbENlbGwnO1xyXG5pbXBvcnQgeyBHZXRCaWxsc0luZm9BcmdzIH0gZnJvbSAnLi4vLi4vZW50aXR5L3RyYWNraW5nL0dldEJpbGxzSW5mb0FyZ3MnO1xyXG5pbXBvcnQgeyBCaWxsSW5mbyB9IGZyb20gJy4uLy4uL2VudGl0eS90cmFja2luZy9CaWxsSW5mbyc7XHJcbmltcG9ydCB7IEpvaW50UXVlcnlQYXJhbWV0ZXIsIEpvaW50UXVlcnlQYXJhbWV0ZXJzLCBKb2ludFF1ZXJ5UGFyYW1ldGVyVHlwZSB9IGZyb20gJ0BlZHAtYmlmL2NvbW1vbi1hcGknO1xyXG5pbXBvcnQgeyBHZXRKb2ludFF1ZXJ5UGFyYW1ldGVyc0FyZ3MgfSBmcm9tICcuLi9hcmdzJztcclxuaW1wb3J0IHsgSm9pbnRRdWVyeVBhcmFtZXRlclJlc3VsdCB9IGZyb20gJy4uLy4uL2VudGl0eS90cmFja2luZy9Kb2ludFF1ZXJ5UGFyYW1ldGVyUmVzdWx0JztcclxuaW1wb3J0IHsgSm9pbnRRdWVyeVBhcmFtZXRlcnNDb250ZW50IH0gZnJvbSAnLi4vLi4vZW50aXR5L3RyYWNraW5nL0pvaW50UXVlcnlQYXJhbWV0ZXJzQ29udGVudCc7XHJcbmltcG9ydCB7IEV4cHJlc3Npb25Kb2ludFF1ZXJ5UGFyYW1ldGVyQ29udGVudCB9IGZyb20gJy4uLy4uL2VudGl0eS90cmFja2luZy9FeHByZXNzaW9uSm9pbnRRdWVyeVBhcmFtZXRlckNvbnRlbnQnO1xyXG5pbXBvcnQgeyBGaWVsZEpvaW50UXVlcnlQYXJhbWV0ZXJDb250ZW50IH0gZnJvbSBcIi4uLy4uL2VudGl0eS90cmFja2luZy9GaWVsZEpvaW50UXVlcnlQYXJhbWV0ZXJDb250ZW50XCI7XHJcbmltcG9ydCB7IEpvaW50UXVlcnlQYXJhbWV0ZXJNb2RlIH0gZnJvbSAnLi4vLi4vZW50aXR5L3RyYWNraW5nL0pvaW50UXVlcnlQYXJhbWV0ZXJNb2RlJztcclxuXHJcbkBJbmplY3RhYmxlKClcclxuZXhwb3J0IGNsYXNzIEJpbGxUcmFja2VyRGF0YVNlcnZpY2UgaW1wbGVtZW50cyBJQmlsbFRyYWNrZXJEYXRhU2VydmljZSB7XHJcbiAgICByZWFkb25seSBiYXNlVXJsID0gXCIvYXBpL3J1bnRpbWUvYWlmL3YxLjAvYmlsbHRyYWNraW5nXCI7XHJcblxyXG4gICAgcmVhZG9ubHkgY2FuVHJhY2tpbmdVcmwgPSB0aGlzLmJhc2VVcmwgKyBcIi9jYW50cmFja2luZ1wiO1xyXG4gICAgcmVhZG9ubHkgY2FuVHJhY2tpbmdNZXRob2QgPSBcIlBPU1RcIjtcclxuXHJcbiAgICByZWFkb25seSBnZXREb3duQmlsbHNJbmZvVXJsID0gdGhpcy5iYXNlVXJsICsgXCIvZ2V0ZG93bmJpbGxzaW5mb1wiO1xyXG4gICAgcmVhZG9ubHkgZ2V0RG93bkJpbGxzSW5mb01ldGhvZCA9IFwiUE9TVFwiO1xyXG5cclxuICAgIHJlYWRvbmx5IGdldFVwQmlsbHNJbmZvVXJsID0gdGhpcy5iYXNlVXJsICsgXCIvZ2V0dXBiaWxsc2luZm9cIjtcclxuICAgIHJlYWRvbmx5IGdldFVwQmlsbHNJbmZvTWV0aG9kID0gXCJQT1NUXCI7XHJcblxyXG4gICAgcmVhZG9ubHkgZ2V0RW50aXR5RGF0YVVybCA9IHRoaXMuYmFzZVVybCArIFwiL2dldGVudGl0eWRhdGFcIjtcclxuICAgIHJlYWRvbmx5IGdldEVudGl0eURhdGFNZXRob2QgPSBcIlBPU1RcIjtcclxuXHJcbiAgICByZWFkb25seSBqb2ludFF1ZXJ5UGFyc2VyVXJsID0gXCIvYXBpL3J1bnRpbWUvYWlmL3YxLjAvam9pbnRxdWVyeVwiO1xyXG4gICAgcmVhZG9ubHkgam9pbnRRdWVyeVBhcnNlck1ldGhvZCA9IFwiUE9TVFwiO1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKFxyXG4gICAgICAgIHB1YmxpYyBodHRwU2VydmljZTogSHR0cFNlcnZpY2UsXHJcbiAgICAgICAgcHVibGljIGh0dHBDbGllbnQ6IEh0dHBDbGllbnQsXHJcbiAgICApIHtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGdldEpvaW50UXVlcnlQYXJhbWV0ZXJzKGFyZ3M6IEdldEpvaW50UXVlcnlQYXJhbWV0ZXJzQXJncyk6IE9ic2VydmFibGU8Sm9pbnRRdWVyeVBhcmFtZXRlclJlc3VsdFtdPiB7XHJcbiAgICAgICAgY29uc3QgYm9keSA9IGFyZ3MuQ29udmVydFRvSnNvbigpO1xyXG4gICAgICAgIGNvbnN0IG9wdCA9IHRoaXMuaHR0cFNlcnZpY2Uuc2V0SGVhZGVyKHsgYm9keTogYm9keSB9KTtcclxuICAgICAgICByZXR1cm4gdGhpcy5odHRwU2VydmljZS5yZXF1ZXN0KHRoaXMuam9pbnRRdWVyeVBhcnNlck1ldGhvZCwgdGhpcy5qb2ludFF1ZXJ5UGFyc2VyVXJsLCBvcHQpLnBpcGUoXHJcbiAgICAgICAgICAgIHN3aXRjaE1hcChcclxuICAgICAgICAgICAgICAgIChyZXM6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCBvYmo6IHsgdmFsdWU6IHN0cmluZyB9ID0gcmVzO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHJlc3VsdHMgPSBCcG1uTW9kZWxKc29uSGVscGVyLkZyb21Kc29uKG9iai52YWx1ZSwgSm9pbnRRdWVyeVBhcmFtZXRlclJlc3VsdCkgYXMgSm9pbnRRdWVyeVBhcmFtZXRlclJlc3VsdFtdO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBvZihyZXN1bHRzKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgKSxcclxuICAgICAgICAgICAgY2F0Y2hFcnJvcihcclxuICAgICAgICAgICAgICAgIChlcnI6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgZXJyLmVycm9yID09IFwic3RyaW5nXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVyci5lcnJvciA9IEpTT04ucGFyc2UoZXJyLmVycm9yKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IGVycjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgKVxyXG4gICAgICAgICk7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGNhblRyYWNraW5nKGFyZ3M6IEdldERvd25CaWxsc0luZm9BcmdzKTogT2JzZXJ2YWJsZTxDYW5UcmFja2luZ1Jlc3VsdD4ge1xyXG4gICAgICAgIGNvbnN0IG9wdCA9IHRoaXMuaHR0cFNlcnZpY2Uuc2V0SGVhZGVyKHsgYm9keTogYXJncy5Db252ZXJ0VG9Kc29uKCksIHJlc3BvbnNlVHlwZTogXCJ0ZXh0XCIgfSk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuaHR0cFNlcnZpY2UucmVxdWVzdCh0aGlzLmNhblRyYWNraW5nTWV0aG9kLCB0aGlzLmNhblRyYWNraW5nVXJsLCBvcHQpLnBpcGUoXHJcbiAgICAgICAgICAgIHN3aXRjaE1hcChcclxuICAgICAgICAgICAgICAgIChyZXM6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCByZXN1bHQ6IENhblRyYWNraW5nUmVzdWx0ID0gbmV3IENhblRyYWNraW5nUmVzdWx0KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0LkxvYWRGcm9tSnNvbihyZXMpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBvZihyZXN1bHQpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICApLFxyXG4gICAgICAgICAgICBjYXRjaEVycm9yKFxyXG4gICAgICAgICAgICAgICAgKGVycjogYW55KSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBlcnIuZXJyb3IgPT0gXCJzdHJpbmdcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyLmVycm9yID0gSlNPTi5wYXJzZShlcnIuZXJyb3IpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgZXJyO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICApXHJcbiAgICAgICAgKTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgZ2V0RG93bkJpbGxzSW5mbyhhcmdzOiBHZXREb3duQmlsbHNJbmZvQXJncyk6IE9ic2VydmFibGU8RG93bkJpbGxJbmZvUmVzdWx0W10+IHtcclxuICAgICAgICBjb25zdCBvcHQgPSB0aGlzLmh0dHBTZXJ2aWNlLnNldEhlYWRlcih7IGJvZHk6IGFyZ3MuQ29udmVydFRvSnNvbigpLCByZXNwb25zZVR5cGU6IFwidGV4dFwiIH0pO1xyXG4gICAgICAgIHJldHVybiB0aGlzLmh0dHBTZXJ2aWNlLnJlcXVlc3QodGhpcy5nZXREb3duQmlsbHNJbmZvTWV0aG9kLCB0aGlzLmdldERvd25CaWxsc0luZm9VcmwsIG9wdCkucGlwZShcclxuICAgICAgICAgICAgc3dpdGNoTWFwKFxyXG4gICAgICAgICAgICAgICAgKHJlczogYW55KSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IHJlc3VsdDogRG93bkJpbGxJbmZvUmVzdWx0W10gPSBCcG1uTW9kZWxKc29uSGVscGVyLkZyb21Kc29uKHJlcywgRG93bkJpbGxJbmZvUmVzdWx0KTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gb2YocmVzdWx0KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgKSxcclxuICAgICAgICAgICAgY2F0Y2hFcnJvcihcclxuICAgICAgICAgICAgICAgIChlcnI6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgZXJyLmVycm9yID09IFwic3RyaW5nXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVyci5lcnJvciA9IEpTT04ucGFyc2UoZXJyLmVycm9yKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IGVycjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgKVxyXG4gICAgICAgICk7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGdldFVwQmlsbHNJbmZvKGFyZ3M6IEdldFVwQmlsbHNJbmZvQXJncyk6IE9ic2VydmFibGU8VXBCaWxsSW5mb1Jlc3VsdFtdPiB7XHJcbiAgICAgICAgY29uc3Qgb3B0ID0gdGhpcy5odHRwU2VydmljZS5zZXRIZWFkZXIoeyBib2R5OiBhcmdzLkNvbnZlcnRUb0pzb24oKSwgcmVzcG9uc2VUeXBlOiBcInRleHRcIiB9KTtcclxuICAgICAgICByZXR1cm4gdGhpcy5odHRwU2VydmljZS5yZXF1ZXN0KHRoaXMuZ2V0VXBCaWxsc0luZm9NZXRob2QsIHRoaXMuZ2V0VXBCaWxsc0luZm9VcmwsIG9wdCkucGlwZShcclxuICAgICAgICAgICAgc3dpdGNoTWFwKFxyXG4gICAgICAgICAgICAgICAgKHJlczogYW55KSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IHJlc3VsdDogVXBCaWxsSW5mb1Jlc3VsdFtdID0gQnBtbk1vZGVsSnNvbkhlbHBlci5Gcm9tSnNvbihyZXMsIFVwQmlsbEluZm9SZXN1bHQpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBvZihyZXN1bHQpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICApLFxyXG4gICAgICAgICAgICBjYXRjaEVycm9yKFxyXG4gICAgICAgICAgICAgICAgKGVycjogYW55KSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBlcnIuZXJyb3IgPT0gXCJzdHJpbmdcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyLmVycm9yID0gSlNPTi5wYXJzZShlcnIuZXJyb3IpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgZXJyO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICApXHJcbiAgICAgICAgKTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgZ2V0RW50aXR5RGF0YShhcmdzOiBHZXRNYWluRW50aXR5RGF0YUFyZ3MpOiBPYnNlcnZhYmxlPEVudGl0eURhdGFSZXN1bHQ+IHtcclxuICAgICAgICBjb25zdCBvcHQgPSB0aGlzLmh0dHBTZXJ2aWNlLnNldEhlYWRlcih7IGJvZHk6IGFyZ3MuQ29udmVydFRvSnNvbigpLCByZXNwb25zZVR5cGU6IFwidGV4dFwiIH0pO1xyXG4gICAgICAgIHJldHVybiB0aGlzLmh0dHBTZXJ2aWNlLnJlcXVlc3QodGhpcy5nZXRFbnRpdHlEYXRhTWV0aG9kLCB0aGlzLmdldEVudGl0eURhdGFVcmwsIG9wdCkucGlwZShcclxuICAgICAgICAgICAgc3dpdGNoTWFwKFxyXG4gICAgICAgICAgICAgICAgKHJlczogYW55KSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gbmV3IEVudGl0eURhdGFSZXN1bHQoKTtcclxuICAgICAgICAgICAgICAgICAgICByZXN1bHQuTG9hZEZyb21Kc29uKHJlcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG9mKHJlc3VsdCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICksXHJcbiAgICAgICAgICAgIGNhdGNoRXJyb3IoXHJcbiAgICAgICAgICAgICAgICAoZXJyOiBhbnkpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGVyci5lcnJvciA9PSBcInN0cmluZ1wiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnIuZXJyb3IgPSBKU09OLnBhcnNlKGVyci5lcnJvcik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBlcnI7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIClcclxuICAgICAgICApO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBidWlsZEVudHJ5QmlsbEluZm8oY2FuVHJhY2tpbmdSZXN1bHQ6IENhblRyYWNraW5nUmVzdWx0KSB7XHJcbiAgICAgICAgY29uc3QgaW5mbyA9IG5ldyBEb3duQmlsbEluZm9SZXN1bHQoKTtcclxuICAgICAgICBpbmZvLnNjaGVtYUlkID0gY2FuVHJhY2tpbmdSZXN1bHQuc2NoZW1hSWQ7XHJcbiAgICAgICAgaW5mby5zdUNvZGUgPSBjYW5UcmFja2luZ1Jlc3VsdC5zdUNvZGU7XHJcbiAgICAgICAgaW5mby52b05hbWUgPSBjYW5UcmFja2luZ1Jlc3VsdC52b05hbWU7XHJcbiAgICAgICAgaW5mby5iaWxsVHJhY2tpbmdTZXR0aW5ncyA9IGNhblRyYWNraW5nUmVzdWx0LmJpbGxUcmFja2luZ1NldHRpbmdzO1xyXG4gICAgICAgIGluZm8uYml6S2luZCA9IGNhblRyYWNraW5nUmVzdWx0LmJpektpbmQ7XHJcbiAgICAgICAgaW5mby5iaXpUeXBlID0gY2FuVHJhY2tpbmdSZXN1bHQuYml6VHlwZTtcclxuICAgICAgICBpbmZvLmpvaW50UXVlcnlNb2RlID0gY2FuVHJhY2tpbmdSZXN1bHQuam9pbnRRdWVyeU1vZGU7XHJcbiAgICAgICAgaW5mby5qb2ludFF1ZXJ5UGFyYW1ldGVycyA9IGNhblRyYWNraW5nUmVzdWx0LmpvaW50UXVlcnlQYXJhbWV0ZXJzO1xyXG4gICAgICAgIGluZm8udHJhY2tpbmdTb3VyY2VUeXBlID0gY2FuVHJhY2tpbmdSZXN1bHQudHJhY2tpbmdTb3VyY2VUeXBlO1xyXG4gICAgICAgIGNvbnN0IGRhdGFJbmZvID0gbmV3IEJpbGxEYXRhSW5mbygpO1xyXG4gICAgICAgIGRhdGFJbmZvLmNhcHRpb24gPSBjYW5UcmFja2luZ1Jlc3VsdC5jYXB0aW9uO1xyXG4gICAgICAgIGRhdGFJbmZvLmRhdGFJZCA9IGNhblRyYWNraW5nUmVzdWx0LmRhdGFJZDtcclxuICAgICAgICBkYXRhSW5mby5zdW1tYXJ5ID0gY2FuVHJhY2tpbmdSZXN1bHQuc3VtbWFyeTtcclxuICAgICAgICBkYXRhSW5mby50cmFja2luZ01hcHBpbmdBc3NvY2lhdGlvbnMgPSBbXTtcclxuICAgICAgICBkYXRhSW5mby5iaWxsQ2hpbGRJbmZvcyA9IGNhblRyYWNraW5nUmVzdWx0LmJpbGxDaGlsZEluZm9zO1xyXG4gICAgICAgIGRhdGFJbmZvLmN1clllYXIgPSBjYW5UcmFja2luZ1Jlc3VsdC5jdXJZZWFyO1xyXG4gICAgICAgIGluZm8uYmlsbERhdGFJbmZvcyA9IFtkYXRhSW5mb107XHJcbiAgICAgICAgaW5mby5kb2N1bWVudFR5cGVJZCA9IGNhblRyYWNraW5nUmVzdWx0LmRvY3VtZW50VHlwZUlkO1xyXG5cclxuICAgICAgICByZXR1cm4gaW5mbztcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgYnVpbGRHZXRCaWxsc0luZm9BcmdzKGNlbGw6IEJpbGxDZWxsKSB7XHJcbiAgICAgICAgY29uc3QgYXJncyA9IG5ldyBHZXRCaWxsc0luZm9BcmdzKCk7XHJcbiAgICAgICAgYXJncy5iaWxsRGF0YUlkID0gY2VsbC5iaWxsRGF0YUluZm8uZGF0YUlkO1xyXG4gICAgICAgIGFyZ3MuZG9jdW1lbnRUeXBlSWQgPSBjZWxsLmJpbGxJbmZvLmRvY3VtZW50VHlwZUlkO1xyXG4gICAgICAgIGFyZ3MuYml6S2luZCA9IGNlbGwuYmlsbEluZm8uYml6S2luZDtcclxuICAgICAgICBhcmdzLmJpelR5cGUgPSBjZWxsLmJpbGxJbmZvLmJpelR5cGU7XHJcbiAgICAgICAgYXJncy5iaWxsQ2hpbGRJbmZvcyA9IGNlbGwuYmlsbERhdGFJbmZvLmJpbGxDaGlsZEluZm9zO1xyXG4gICAgICAgIGFyZ3MuY3VyWWVhciA9IGNlbGwuYmlsbERhdGFJbmZvLmN1clllYXI7XHJcbiAgICAgICAgcmV0dXJuIGFyZ3M7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGJ1aWxkR2V0VXBCaWxsc0luZm9BcmdzKGNlbGw6IEJpbGxDZWxsKSB7XHJcbiAgICAgICAgY29uc3QgYXJncyA9IG5ldyBHZXRVcEJpbGxzSW5mb0FyZ3MoKTtcclxuICAgICAgICBhcmdzLkxvYWRGcm9tSnNvbk9iamVjdCh0aGlzLmJ1aWxkR2V0QmlsbHNJbmZvQXJncyhjZWxsKS5Db252ZXJ0VG9Kc29uT2JqZWN0KCkpO1xyXG4gICAgICAgIHJldHVybiBhcmdzO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBidWlsZEdldERvd25CaWxsc0luZm9BcmdzKGNlbGw6IEJpbGxDZWxsKSB7XHJcbiAgICAgICAgY29uc3QgYXJncyA9IG5ldyBHZXREb3duQmlsbHNJbmZvQXJncygpO1xyXG4gICAgICAgIGFyZ3MuTG9hZEZyb21Kc29uT2JqZWN0KHRoaXMuYnVpbGRHZXRCaWxsc0luZm9BcmdzKGNlbGwpLkNvbnZlcnRUb0pzb25PYmplY3QoKSk7XHJcbiAgICAgICAgcmV0dXJuIGFyZ3M7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGJ1aWxkR2V0TWFpbkVudGl0eURhdGFBcmdzKGJpbGxJbmZvOiBCaWxsSW5mbywgYmlsbERhdGFJbmZvOiBCaWxsRGF0YUluZm8pOiBHZXRNYWluRW50aXR5RGF0YUFyZ3Mge1xyXG4gICAgICAgIGNvbnN0IGFyZ3MgPSBuZXcgR2V0TWFpbkVudGl0eURhdGFBcmdzKCk7XHJcbiAgICAgICAgYXJncy5kYXRhSWQgPSBiaWxsRGF0YUluZm8uZGF0YUlkO1xyXG4gICAgICAgIGFyZ3Muc3VDb2RlID0gYmlsbEluZm8uc3VDb2RlO1xyXG4gICAgICAgIGFyZ3Muc2NoZW1hSWQgPSBiaWxsSW5mby5zY2hlbWFJZDtcclxuICAgICAgICBhcmdzLnRyYWNraW5nU291cmNlVHlwZSA9IGJpbGxJbmZvLnRyYWNraW5nU291cmNlVHlwZTtcclxuICAgICAgICBhcmdzLmJpbGxDaGlsZEluZm9zID0gYmlsbERhdGFJbmZvLmJpbGxDaGlsZEluZm9zO1xyXG4gICAgICAgIGFyZ3MuY3VyWWVhciA9IGJpbGxEYXRhSW5mby5jdXJZZWFyO1xyXG4gICAgICAgIGFyZ3MuZG9jdW1lbnRUeXBlSWQgPSBiaWxsSW5mby5kb2N1bWVudFR5cGVJZDtcclxuXHJcbiAgICAgICAgcmV0dXJuIGFyZ3M7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGhhc0R5bmFtaWNQYXJhbXMoam9pbnRRdWVyeVBhcmFtZXRlcnM6IEpvaW50UXVlcnlQYXJhbWV0ZXJzKSB7XHJcbiAgICAgICAgaWYgKCFqb2ludFF1ZXJ5UGFyYW1ldGVycy5wYXJhbXMpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyDmt7vliqDoh6rlrprkuYnlj4LmlbBcclxuICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShqb2ludFF1ZXJ5UGFyYW1ldGVycy5wYXJhbXMpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBqb2ludFF1ZXJ5UGFyYW1ldGVycy5wYXJhbXMuZmluZCgocCkgPT4gcC50eXBlICE9IEpvaW50UXVlcnlQYXJhbWV0ZXJUeXBlLkNvbnN0YW50KSAhPSBudWxsO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDmnoTpgKDogZTmn6Xlj4LmlbDop6PmnpDlmajlj4LmlbBcclxuICAgICAqIEBwYXJhbSBqb2ludFF1ZXJ5UGFyYW1ldGVycyBcclxuICAgICAqIEBwYXJhbSBiaWxsSW5mbyBcclxuICAgICAqIEBwYXJhbSBiaWxsRGF0YUluZm8gXHJcbiAgICAgKiBAcmV0dXJucyBcclxuICAgICAqL1xyXG4gICAgcHVibGljIGJ1aWxkR2V0Sm9pbnRRdWVyeVBhcmFtZXRlcnNBcmdzKGpvaW50UXVlcnlQYXJhbWV0ZXJzOiBKb2ludFF1ZXJ5UGFyYW1ldGVycywgYmlsbEluZm86IEJpbGxJbmZvLCBiaWxsRGF0YUluZm86IEJpbGxEYXRhSW5mbyk6IEdldEpvaW50UXVlcnlQYXJhbWV0ZXJzQXJncyB7XHJcbiAgICAgICAgY29uc3QgYXJncyA9IG5ldyBHZXRKb2ludFF1ZXJ5UGFyYW1ldGVyc0FyZ3MoKTtcclxuXHJcbiAgICAgICAgYXJncy5kYXRhSWQgPSBiaWxsRGF0YUluZm8uZGF0YUlkO1xyXG4gICAgICAgIGFyZ3Muc3VDb2RlID0gYmlsbEluZm8uc3VDb2RlO1xyXG4gICAgICAgIGFyZ3Muc2NoZW1hSWQgPSBiaWxsSW5mby5zY2hlbWFJZDtcclxuICAgICAgICBhcmdzLnRyYWNraW5nU291cmNlVHlwZSA9IGJpbGxJbmZvLnRyYWNraW5nU291cmNlVHlwZTtcclxuICAgICAgICBhcmdzLmN1clllYXIgPSBiaWxsRGF0YUluZm8uY3VyWWVhcjtcclxuXHJcbiAgICAgICAgYXJncy5jb250ZW50cyA9IFtdO1xyXG4gICAgICAgIGlmIChBcnJheS5pc0FycmF5KGpvaW50UXVlcnlQYXJhbWV0ZXJzLnBhcmFtcykpIHtcclxuICAgICAgICAgICAgam9pbnRRdWVyeVBhcmFtZXRlcnMucGFyYW1zLmZvckVhY2goaXQgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKGl0LnR5cGUgPT0gSm9pbnRRdWVyeVBhcmFtZXRlclR5cGUuQ29uc3RhbnQpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjb25zdCBqb2ludFF1ZXJ5UGFyYW1ldGVyc0NvbnRlbnQgPSBuZXcgSm9pbnRRdWVyeVBhcmFtZXRlcnNDb250ZW50KCk7XHJcbiAgICAgICAgICAgICAgICBpZiAoaXQudHlwZSA9PSBKb2ludFF1ZXJ5UGFyYW1ldGVyVHlwZS5GaWVsZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGpvaW50UXVlcnlQYXJhbWV0ZXJzQ29udGVudC5qb2ludFF1ZXJ5UGFyYW1ldGVyTW9kZSA9IEpvaW50UXVlcnlQYXJhbWV0ZXJNb2RlLkZJRUxEO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGNvbnRlbnQgPSBuZXcgRmllbGRKb2ludFF1ZXJ5UGFyYW1ldGVyQ29udGVudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRlbnQucGFyYW1ldGVyQ29kZSA9IGl0LmNvZGU7XHJcbiAgICAgICAgICAgICAgICAgICAgY29udGVudC5maWVsZENvbnRlbnQgPSBpdC52YWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICBqb2ludFF1ZXJ5UGFyYW1ldGVyc0NvbnRlbnQuY29udGVudCA9IGNvbnRlbnQuQ29udmVydFRvSnNvbigpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChpdC50eXBlID09IEpvaW50UXVlcnlQYXJhbWV0ZXJUeXBlLkV4cHJlc3Npb24pIHtcclxuICAgICAgICAgICAgICAgICAgICBqb2ludFF1ZXJ5UGFyYW1ldGVyc0NvbnRlbnQuam9pbnRRdWVyeVBhcmFtZXRlck1vZGUgPSBKb2ludFF1ZXJ5UGFyYW1ldGVyTW9kZS5FWFBSRVNTSU9OO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGNvbnRlbnQgPSBuZXcgRXhwcmVzc2lvbkpvaW50UXVlcnlQYXJhbWV0ZXJDb250ZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgY29udGVudC5wYXJhbWV0ZXJDb2RlID0gaXQuY29kZTtcclxuICAgICAgICAgICAgICAgICAgICBjb250ZW50LmV4cHJlc3Npb25Db250ZW50ID0gaXQudmFsdWU7XHJcbiAgICAgICAgICAgICAgICAgICAgam9pbnRRdWVyeVBhcmFtZXRlcnNDb250ZW50LmNvbnRlbnQgPSBjb250ZW50LkNvbnZlcnRUb0pzb24oKTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBhcmdzLmNvbnRlbnRzLnB1c2goam9pbnRRdWVyeVBhcmFtZXRlcnNDb250ZW50KTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBhcmdzO1xyXG4gICAgfVxyXG59Il19