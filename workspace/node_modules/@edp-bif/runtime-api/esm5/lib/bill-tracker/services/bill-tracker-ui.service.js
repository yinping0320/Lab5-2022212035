/**
 * @fileoverview added by tsickle
 * Generated from: lib/bill-tracker/services/bill-tracker-ui.service.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
import { Injectable, Injector, ComponentFactoryResolver, ReflectiveInjector, Inject, LOCALE_ID } from '@angular/core';
import { BsModalService } from '@farris/ui-modal';
import { BillTrackerDataService } from './bill-tracker-data.service';
import { BillTrackerComponent } from '../components/bill-tracker/bill-tracker.component';
import { BillTrackerArgs } from '../config/bill-tracker-args';
import { GetDownBillsInfoArgs } from '../../entity/tracking/GetDownBillsInfoArgs';
import { BillTrackerLocalePipe } from '../pipe/bill-tracker-locale.pipe';
import { of } from 'rxjs';
import { switchMap, catchError } from 'rxjs/operators';
import { MessagerService } from '@farris/ui-messager';
import { LoadingService } from '@farris/ui-loading';
import { FrameworkService, AppType } from '@gsp-sys/rtf-common';
import { BillTrackerConstant } from '../config/bill-tracker-constant';
import { BillTrackerGraphOptions } from '../config/bill-tracker-graph-options';
import { BillTrackerGridOptions } from '../config/bill-tracker-grid-options';
var BillTrackerUiService = /** @class */ (function () {
    function BillTrackerUiService(frameworkService, messager, loading, localeId, dataService, modalService, cfr, injector) {
        this.frameworkService = frameworkService;
        this.messager = messager;
        this.loading = loading;
        this.dataService = dataService;
        this.modalService = modalService;
        this.cfr = cfr;
        this.injector = injector;
        /**
         * 内置模态框配置
         */
        this.defaultModalOptions = {
            title: null,
            width: 1100,
            height: 480,
            buttons: null,
            showButtons: null,
        };
        this.localePipe = new BillTrackerLocalePipe(localeId);
    }
    /**
     * 打开单据追踪弹窗
     * todo: spa模式下，弹窗在body中，位于最上层，打开联查时会盖住新tab页，此问题待解决
     * @param args 单据追踪参数
     * @param maximized 是否最大化弹窗
     * @param modalOptions 弹窗配置
     * @param graphOptions 追踪图配置
     * @param gridOptions 数据表配置
     */
    /**
     * 打开单据追踪弹窗
     * todo: spa模式下，弹窗在body中，位于最上层，打开联查时会盖住新tab页，此问题待解决
     * @param {?} args 单据追踪参数
     * @param {?=} maximized 是否最大化弹窗
     * @param {?=} modalOptions 弹窗配置
     * @param {?=} graphOptions 追踪图配置
     * @param {?=} gridOptions 数据表配置
     * @return {?}
     */
    BillTrackerUiService.prototype.openDefaultBillTrackerDialog = /**
     * 打开单据追踪弹窗
     * todo: spa模式下，弹窗在body中，位于最上层，打开联查时会盖住新tab页，此问题待解决
     * @param {?} args 单据追踪参数
     * @param {?=} maximized 是否最大化弹窗
     * @param {?=} modalOptions 弹窗配置
     * @param {?=} graphOptions 追踪图配置
     * @param {?=} gridOptions 数据表配置
     * @return {?}
     */
    function (args, maximized, modalOptions, graphOptions, gridOptions) {
        var _this = this;
        if (maximized === void 0) { maximized = true; }
        if (typeof modalOptions == "string") {
            if (modalOptions == "") {
                this.messager.info(this.localePipe.transform("modalOptionsCantBeEmpty"));
                return of(null);
            }
            modalOptions = JSON.parse(modalOptions);
        }
        /** @type {?} */
        var modalOpts = {
            title: this.localePipe.transform("billTracker")
        };
        modalOpts = Object.assign(modalOpts, this.defaultModalOptions, modalOptions);
        if (typeof graphOptions == "string") {
            if (graphOptions != "") {
                graphOptions = JSON.parse(graphOptions);
            }
            else {
                graphOptions = null;
            }
        }
        if (typeof gridOptions == "string") {
            if (gridOptions != "") {
                gridOptions = JSON.parse(gridOptions);
            }
            else {
                gridOptions = null;
            }
        }
        /** @type {?} */
        var downArgs = new GetDownBillsInfoArgs();
        downArgs.billDataId = args.billDataId;
        downArgs.documentTypeId = args.documentTypeId;
        downArgs.bizKind = args.bizKind;
        downArgs.bizType = args.bizType;
        downArgs.billChildInfos = args.billChildInfos;
        downArgs.curYear = args.curYear;
        this.loading.show({ message: this.localePipe.transform("loading") });
        return this.dataService.canTracking(downArgs).pipe(switchMap((/**
         * @param {?} res
         * @return {?}
         */
        function (res) {
            if (!res.canDownTracking && !res.canUpTracking) {
                _this.messager.info(_this.localePipe.transform("noAssoBill"));
                _this.loading.close();
                return of(null);
            }
            /** @type {?} */
            var billTrackerArgs = new BillTrackerArgs();
            billTrackerArgs.canTrackingResult = res;
            billTrackerArgs.getBillsInfoArgs = args;
            /** @type {?} */
            var graphOpt = new BillTrackerGraphOptions();
            graphOpt = Object.assign(graphOpt, graphOptions);
            billTrackerArgs.graphOptions = graphOpt;
            /** @type {?} */
            var gridOpt = new BillTrackerGridOptions();
            gridOpt = Object.assign(gridOpt, gridOptions);
            billTrackerArgs.gridOptions = gridOpt;
            /** @type {?} */
            var cmpR = _this.createBillTrackerComponent(billTrackerArgs);
            _this.loading.close();
            /** @type {?} */
            var modalRef = _this.modalService.show(cmpR, modalOpts);
            if (maximized) {
                modalRef.dialog.instance.maxDialog();
            }
            cmpR.instance.setModalRef(modalRef);
            return of(cmpR.instance);
        })), catchError((/**
         * @param {?} err
         * @return {?}
         */
        function (err) {
            _this.loading.close();
            //todo 确定异常结构, 目前采用兼容取值方式
            _this.messager.error(err.error == null ? err.message : (err.error.Message || err.error.message || err.message));
            throw err;
        })));
    };
    /**
     * 打开单据追踪应用
     * @param args 单据追踪参数
     * @param graphOptions 追踪图配置
     * @param gridOptions 数据表配置
     */
    /**
     * 打开单据追踪应用
     * @param {?} args 单据追踪参数
     * @param {?=} graphOptions 追踪图配置
     * @param {?=} gridOptions 数据表配置
     * @return {?}
     */
    BillTrackerUiService.prototype.openDefaultBillTrackerApp = /**
     * 打开单据追踪应用
     * @param {?} args 单据追踪参数
     * @param {?=} graphOptions 追踪图配置
     * @param {?=} gridOptions 数据表配置
     * @return {?}
     */
    function (args, graphOptions, gridOptions) {
        var _this = this;
        if (typeof graphOptions == "string") {
            if (graphOptions == "") {
                this.messager.info(this.localePipe.transform("modalOptionsCantBeEmpty"));
                return;
            }
            graphOptions = JSON.parse(graphOptions);
        }
        if (typeof gridOptions == "string") {
            if (gridOptions == "") {
                this.messager.info(this.localePipe.transform("modalOptionsCantBeEmpty"));
                return;
            }
            gridOptions = JSON.parse(gridOptions);
        }
        /** @type {?} */
        var downArgs = new GetDownBillsInfoArgs();
        downArgs.documentTypeId = args.documentTypeId;
        downArgs.billDataId = args.billDataId;
        downArgs.bizKind = args.bizKind;
        downArgs.bizType = args.bizType;
        downArgs.billChildInfos = args.billChildInfos;
        downArgs.curYear = args.curYear;
        this.loading.show({ message: this.localePipe.transform("loading") });
        this.dataService.canTracking(downArgs).subscribe((/**
         * @param {?} res
         * @return {?}
         */
        function (res) {
            if (!res.canDownTracking && !res.canUpTracking) {
                _this.messager.info(_this.localePipe.transform("noAssoBill"));
                _this.loading.close();
                return;
            }
            /** @type {?} */
            var billTrackerArgs = new BillTrackerArgs();
            // warning：如果存在特殊字符或者长度超长，可能会打开空白的单据追踪应用
            billTrackerArgs.canTrackingResult = res;
            billTrackerArgs.getBillsInfoArgs = args;
            /** @type {?} */
            var graphOpt = new BillTrackerGraphOptions();
            graphOpt = Object.assign(graphOpt, graphOptions);
            billTrackerArgs.graphOptions = graphOpt;
            /** @type {?} */
            var gridOpt = new BillTrackerGridOptions();
            gridOpt = Object.assign(gridOpt, gridOptions);
            billTrackerArgs.gridOptions = gridOpt;
            /** @type {?} */
            var opt = {
                appId: BillTrackerConstant.DEFAULT_APP_ID,
                appEntrance: BillTrackerConstant.DEFAULT_APP_ENTRANCE,
                funcId: BillTrackerConstant.DEFAULT_FUNC_ID,
                tabId: "billTracker" + Date.now(),
                tabName: _this.localePipe.transform("billTracker"),
                appType: AppType.App,
                entityParams: billTrackerArgs,
                queryStringParams: _this.buildQueryMap(billTrackerArgs),
                isReload: undefined,
            };
            _this.frameworkService.openMenu(opt);
            _this.loading.close();
        }), (/**
         * @param {?} err
         * @return {?}
         */
        function (err) {
            _this.loading.close();
            //todo 确定异常结构, 目前采用兼容取值方式
            _this.messager.error(err.error == null ? err.message : (err.error.Message || err.error.message || err.message));
            throw err;
        }));
    };
    /**
     * 创建单据追踪组件
     * @param billTrackerArgs 单据追踪参数
     * @param cfr ComponentFactoryResolver
     * @param injector Injector
     * @param custProviders 自定义Provider
     * @returns
     */
    /**
     * 创建单据追踪组件
     * @param {?} billTrackerArgs 单据追踪参数
     * @param {?=} cfr ComponentFactoryResolver
     * @param {?=} injector Injector
     * @param {?=} custProviders 自定义Provider
     * @return {?}
     */
    BillTrackerUiService.prototype.createBillTrackerComponent = /**
     * 创建单据追踪组件
     * @param {?} billTrackerArgs 单据追踪参数
     * @param {?=} cfr ComponentFactoryResolver
     * @param {?=} injector Injector
     * @param {?=} custProviders 自定义Provider
     * @return {?}
     */
    function (billTrackerArgs, cfr, injector, custProviders) {
        cfr = cfr == null ? this.cfr : cfr;
        injector = injector == null ? this.injector : injector;
        custProviders = custProviders == null || Array.isArray(custProviders) == false ? [] : custProviders;
        /** @type {?} */
        var inj = ReflectiveInjector.resolveAndCreate(tslib_1.__spread([
            { provide: BillTrackerArgs, useValue: billTrackerArgs }
        ], custProviders), injector);
        /** @type {?} */
        var cmpF = cfr.resolveComponentFactory(BillTrackerComponent);
        /** @type {?} */
        var cmpR = cmpF.create(inj);
        return cmpR;
    };
    /**
     * 能否继续追踪
     * @param args
     * @returns
     */
    /**
     * 能否继续追踪
     * @param {?} args
     * @return {?}
     */
    BillTrackerUiService.prototype.canTracking = /**
     * 能否继续追踪
     * @param {?} args
     * @return {?}
     */
    function (args) {
        return this.dataService.canTracking(args);
    };
    /**
     * 获取下游单据信息
     * @param args
     * @returns
     */
    /**
     * 获取下游单据信息
     * @param {?} args
     * @return {?}
     */
    BillTrackerUiService.prototype.getDownBillsInfo = /**
     * 获取下游单据信息
     * @param {?} args
     * @return {?}
     */
    function (args) {
        return this.dataService.getDownBillsInfo(args);
    };
    /**
     * 获取上游单据信息
     * @param args
     * @returns
     */
    /**
     * 获取上游单据信息
     * @param {?} args
     * @return {?}
     */
    BillTrackerUiService.prototype.getUpBillsInfo = /**
     * 获取上游单据信息
     * @param {?} args
     * @return {?}
     */
    function (args) {
        return this.dataService.getUpBillsInfo(args);
    };
    /**
     * 查询实体数据
     * @param args
     * @returns
     */
    /**
     * 查询实体数据
     * @param {?} args
     * @return {?}
     */
    BillTrackerUiService.prototype.getEntityData = /**
     * 查询实体数据
     * @param {?} args
     * @return {?}
     */
    function (args) {
        return this.dataService.getEntityData(args);
    };
    /**
     * @private
     * @param {?} billTrackerArgs
     * @return {?}
     */
    BillTrackerUiService.prototype.buildQueryMap = /**
     * @private
     * @param {?} billTrackerArgs
     * @return {?}
     */
    function (billTrackerArgs) {
        /** @type {?} */
        var map = new Map();
        for (var key in billTrackerArgs) {
            /** @type {?} */
            var value = billTrackerArgs[key];
            if (typeof value == "object") {
                value = value && JSON.stringify(value);
            }
            // url编码后base64加密，避免url中出现特殊字符
            // 在default-bill-tracker中解码时应先atob在decodeURIComponent
            map.set(key, btoa(encodeURIComponent(value)));
        }
        return map;
    };
    BillTrackerUiService.decorators = [
        { type: Injectable }
    ];
    /** @nocollapse */
    BillTrackerUiService.ctorParameters = function () { return [
        { type: FrameworkService },
        { type: MessagerService },
        { type: LoadingService },
        { type: String, decorators: [{ type: Inject, args: [LOCALE_ID,] }] },
        { type: BillTrackerDataService },
        { type: BsModalService },
        { type: ComponentFactoryResolver },
        { type: Injector }
    ]; };
    return BillTrackerUiService;
}());
export { BillTrackerUiService };
if (false) {
    /**
     * 内置模态框配置
     * @type {?}
     */
    BillTrackerUiService.prototype.defaultModalOptions;
    /** @type {?} */
    BillTrackerUiService.prototype.localePipe;
    /** @type {?} */
    BillTrackerUiService.prototype.frameworkService;
    /** @type {?} */
    BillTrackerUiService.prototype.messager;
    /** @type {?} */
    BillTrackerUiService.prototype.loading;
    /** @type {?} */
    BillTrackerUiService.prototype.dataService;
    /** @type {?} */
    BillTrackerUiService.prototype.modalService;
    /** @type {?} */
    BillTrackerUiService.prototype.cfr;
    /** @type {?} */
    BillTrackerUiService.prototype.injector;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYmlsbC10cmFja2VyLXVpLnNlcnZpY2UuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZWRwLWJpZi9ydW50aW1lLWFwaS8iLCJzb3VyY2VzIjpbImxpYi9iaWxsLXRyYWNrZXIvc2VydmljZXMvYmlsbC10cmFja2VyLXVpLnNlcnZpY2UudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUEsT0FBTyxFQUFFLFVBQVUsRUFBRSxRQUFRLEVBQUUsd0JBQXdCLEVBQUUsa0JBQWtCLEVBQUUsTUFBTSxFQUFFLFNBQVMsRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUN0SCxPQUFPLEVBQUUsY0FBYyxFQUFnQixNQUFNLGtCQUFrQixDQUFDO0FBQ2hFLE9BQU8sRUFBRSxzQkFBc0IsRUFBRSxNQUFNLDZCQUE2QixDQUFDO0FBQ3JFLE9BQU8sRUFBRSxvQkFBb0IsRUFBRSxNQUFNLG1EQUFtRCxDQUFDO0FBQ3pGLE9BQU8sRUFBRSxlQUFlLEVBQUUsTUFBTSw2QkFBNkIsQ0FBQztBQUU5RCxPQUFPLEVBQUUsb0JBQW9CLEVBQUUsTUFBTSw0Q0FBNEMsQ0FBQztBQUNsRixPQUFPLEVBQUUscUJBQXFCLEVBQUUsTUFBTSxrQ0FBa0MsQ0FBQztBQUN6RSxPQUFPLEVBQUUsRUFBRSxFQUFjLE1BQU0sTUFBTSxDQUFDO0FBQ3RDLE9BQU8sRUFBRSxTQUFTLEVBQUUsVUFBVSxFQUFFLE1BQU0sZ0JBQWdCLENBQUM7QUFDdkQsT0FBTyxFQUFFLGVBQWUsRUFBRSxNQUFNLHFCQUFxQixDQUFDO0FBRXRELE9BQU8sRUFBRSxjQUFjLEVBQUUsTUFBTSxvQkFBb0IsQ0FBQztBQUNwRCxPQUFPLEVBQUUsZ0JBQWdCLEVBQWMsT0FBTyxFQUFFLE1BQU0scUJBQXFCLENBQUM7QUFDNUUsT0FBTyxFQUFFLG1CQUFtQixFQUFFLE1BQU0saUNBQWlDLENBQUM7QUFFdEUsT0FBTyxFQUFFLHVCQUF1QixFQUFFLE1BQU0sc0NBQXNDLENBQUM7QUFDL0UsT0FBTyxFQUFFLHNCQUFzQixFQUFF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LFNBQVM7Z0JBMUNaLHNCQUFzQjtnQkFEdEIsY0FBYztnQkFEUSx3QkFBd0I7Z0JBQWxDLFFBQVE7O0lBc1M3QiwyQkFBQztDQUFBLEFBN1FELElBNlFDO1NBNVFZLG9CQUFvQjs7Ozs7O0lBSS9CLG1EQU1FOztJQUVGLDBDQUFrQzs7SUFHaEMsZ0RBQXlDOztJQUN6Qyx3Q0FBZ0M7O0lBQ2hDLHVDQUE4Qjs7SUFFOUIsMkNBQTBDOztJQUMxQyw0Q0FBbUM7O0lBQ25DLG1DQUFvQzs7SUFDcEMsd0NBQXlCIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgSW5qZWN0YWJsZSwgSW5qZWN0b3IsIENvbXBvbmVudEZhY3RvcnlSZXNvbHZlciwgUmVmbGVjdGl2ZUluamVjdG9yLCBJbmplY3QsIExPQ0FMRV9JRCB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBCc01vZGFsU2VydmljZSwgTW9kYWxPcHRpb25zIH0gZnJvbSAnQGZhcnJpcy91aS1tb2RhbCc7XHJcbmltcG9ydCB7IEJpbGxUcmFja2VyRGF0YVNlcnZpY2UgfSBmcm9tICcuL2JpbGwtdHJhY2tlci1kYXRhLnNlcnZpY2UnO1xyXG5pbXBvcnQgeyBCaWxsVHJhY2tlckNvbXBvbmVudCB9IGZyb20gJy4uL2NvbXBvbmVudHMvYmlsbC10cmFja2VyL2JpbGwtdHJhY2tlci5jb21wb25lbnQnO1xyXG5pbXBvcnQgeyBCaWxsVHJhY2tlckFyZ3MgfSBmcm9tICcuLi9jb25maWcvYmlsbC10cmFja2VyLWFyZ3MnO1xyXG5pbXBvcnQgeyBHZXRCaWxsc0luZm9BcmdzIH0gZnJvbSAnLi4vLi4vZW50aXR5L3RyYWNraW5nL0dldEJpbGxzSW5mb0FyZ3MnO1xyXG5pbXBvcnQgeyBHZXREb3duQmlsbHNJbmZvQXJncyB9IGZyb20gJy4uLy4uL2VudGl0eS90cmFja2luZy9HZXREb3duQmlsbHNJbmZvQXJncyc7XHJcbmltcG9ydCB7IEJpbGxUcmFja2VyTG9jYWxlUGlwZSB9IGZyb20gJy4uL3BpcGUvYmlsbC10cmFja2VyLWxvY2FsZS5waXBlJztcclxuaW1wb3J0IHsgb2YsIE9ic2VydmFibGUgfSBmcm9tICdyeGpzJztcclxuaW1wb3J0IHsgc3dpdGNoTWFwLCBjYXRjaEVycm9yIH0gZnJvbSAncnhqcy9vcGVyYXRvcnMnO1xyXG5pbXBvcnQgeyBNZXNzYWdlclNlcnZpY2UgfSBmcm9tICdAZmFycmlzL3VpLW1lc3NhZ2VyJztcclxuaW1wb3J0IHsgQ2FuVHJhY2tpbmdSZXN1bHQgfSBmcm9tICcuLi9hcmdzL0NhblRyYWNraW5nUmVzdWx0JztcclxuaW1wb3J0IHsgTG9hZGluZ1NlcnZpY2UgfSBmcm9tICdAZmFycmlzL3VpLWxvYWRpbmcnO1xyXG5pbXBvcnQgeyBGcmFtZXdvcmtTZXJ2aWNlLCBBcHBPcHRpb25zLCBBcHBUeXBlIH0gZnJvbSAnQGdzcC1zeXMvcnRmLWNvbW1vbic7XHJcbmltcG9ydCB7IEJpbGxUcmFja2VyQ29uc3RhbnQgfSBmcm9tICcuLi9jb25maWcvYmlsbC10cmFja2VyLWNvbnN0YW50JztcclxuaW1wb3J0IHsgSUJpbGxUcmFja2VyVWlTZXJ2aWNlIH0gZnJvbSAnLi4vYmFzZS9JQmlsbFRyYWNrZXJVaVNlcnZpY2UnO1xyXG5pbXBvcnQgeyBCaWxsVHJhY2tlckdyYXBoT3B0aW9ucyB9IGZyb20gJy4uL2NvbmZpZy9iaWxsLXRyYWNrZXItZ3JhcGgtb3B0aW9ucyc7XHJcbmltcG9ydCB7IEJpbGxUcmFja2VyR3JpZE9wdGlvbnMgfSBmcm9tICcuLi9jb25maWcvYmlsbC10cmFja2VyLWdyaWQtb3B0aW9ucyc7XHJcbmltcG9ydCB7IEdldE1haW5FbnRpdHlEYXRhQXJncyB9IGZyb20gJy4uL2FyZ3MvR2V0TWFpbkVudGl0eURhdGFBcmdzJztcclxuaW1wb3J0IHsgRW50aXR5RGF0YVJlc3VsdCB9IGZyb20gJy4uL2FyZ3MvRW50aXR5RGF0YVJlc3VsdCc7XHJcbmltcG9ydCB7IEdldFVwQmlsbHNJbmZvQXJncyB9IGZyb20gJy4uLy4uL2VudGl0eS90cmFja2luZy9HZXRVcEJpbGxzSW5mb0FyZ3MnO1xyXG5pbXBvcnQgeyBVcEJpbGxJbmZvUmVzdWx0IH0gZnJvbSAnLi4vYXJncy9VcEJpbGxJbmZvUmVzdWx0JztcclxuaW1wb3J0IHsgRG93bkJpbGxJbmZvUmVzdWx0IH0gZnJvbSAnLi4vYXJncy9Eb3duQmlsbEluZm9SZXN1bHQnO1xyXG5pbXBvcnQgeyBCYXNlNjQgfSBmcm9tICcuLi91dGlscy9CYXNlNjQnO1xyXG5cclxuQEluamVjdGFibGUoKVxyXG5leHBvcnQgY2xhc3MgQmlsbFRyYWNrZXJVaVNlcnZpY2UgaW1wbGVtZW50cyBJQmlsbFRyYWNrZXJVaVNlcnZpY2Uge1xyXG4gIC8qKlxyXG4gICAqIOWGhee9ruaooeaAgeahhumFjee9rlxyXG4gICAqL1xyXG4gIHB1YmxpYyByZWFkb25seSBkZWZhdWx0TW9kYWxPcHRpb25zOiBNb2RhbE9wdGlvbnMgPSB7XHJcbiAgICB0aXRsZTogbnVsbCxcclxuICAgIHdpZHRoOiAxMTAwLFxyXG4gICAgaGVpZ2h0OiA0ODAsXHJcbiAgICBidXR0b25zOiBudWxsLFxyXG4gICAgc2hvd0J1dHRvbnM6IG51bGwsXHJcbiAgfTtcclxuXHJcbiAgbG9jYWxlUGlwZTogQmlsbFRyYWNrZXJMb2NhbGVQaXBlO1xyXG5cclxuICBjb25zdHJ1Y3RvcihcclxuICAgIHB1YmxpYyBmcmFtZXdvcmtTZXJ2aWNlOiBGcmFtZXdvcmtTZXJ2aWNlLFxyXG4gICAgcHVibGljIG1lc3NhZ2VyOiBNZXNzYWdlclNlcnZpY2UsXHJcbiAgICBwdWJsaWMgbG9hZGluZzogTG9hZGluZ1NlcnZpY2UsXHJcbiAgICBASW5qZWN0KExPQ0FMRV9JRCkgbG9jYWxlSWQ6IHN0cmluZyxcclxuICAgIHB1YmxpYyBkYXRhU2VydmljZTogQmlsbFRyYWNrZXJEYXRhU2VydmljZSxcclxuICAgIHB1YmxpYyBtb2RhbFNlcnZpY2U6IEJzTW9kYWxTZXJ2aWNlLFxyXG4gICAgcHVibGljIGNmcjogQ29tcG9uZW50RmFjdG9yeVJlc29sdmVyLFxyXG4gICAgcHVibGljIGluamVjdG9yOiBJbmplY3RvcixcclxuICApIHtcclxuICAgIHRoaXMubG9jYWxlUGlwZSA9IG5ldyBCaWxsVHJhY2tlckxvY2FsZVBpcGUobG9jYWxlSWQpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog5omT5byA5Y2V5o2u6L+96Liq5by556qXXHJcbiAgICogdG9kbzogc3Bh5qih5byP5LiL77yM5by556qX5ZyoYm9keeS4re+8jOS9jeS6juacgOS4iuWxgu+8jOaJk+W8gOiBlOafpeaXtuS8muebluS9j+aWsHRhYumhte+8jOatpOmXrumimOW+heino+WGs1xyXG4gICAqIEBwYXJhbSBhcmdzIOWNleaNrui/vei4quWPguaVsFxyXG4gICAqIEBwYXJhbSBtYXhpbWl6ZWQg5piv5ZCm5pyA5aSn5YyW5by556qXXHJcbiAgICogQHBhcmFtIG1vZGFsT3B0aW9ucyDlvLnnqpfphY3nva5cclxuICAgKiBAcGFyYW0gZ3JhcGhPcHRpb25zIOi/vei4quWbvumFjee9rlxyXG4gICAqIEBwYXJhbSBncmlkT3B0aW9ucyDmlbDmja7ooajphY3nva5cclxuICAgKi9cclxuICBwdWJsaWMgb3BlbkRlZmF1bHRCaWxsVHJhY2tlckRpYWxvZyhhcmdzOiBHZXRCaWxsc0luZm9BcmdzLCBtYXhpbWl6ZWQ6IGJvb2xlYW4gPSB0cnVlLCBtb2RhbE9wdGlvbnM/OiBNb2RhbE9wdGlvbnMsIGdyYXBoT3B0aW9ucz86IEJpbGxUcmFja2VyR3JhcGhPcHRpb25zLCBncmlkT3B0aW9ucz86IEJpbGxUcmFja2VyR3JpZE9wdGlvbnMpOiBPYnNlcnZhYmxlPEJpbGxUcmFja2VyQ29tcG9uZW50PiB7XHJcbiAgICBpZiAodHlwZW9mIG1vZGFsT3B0aW9ucyA9PSBcInN0cmluZ1wiKSB7XHJcbiAgICAgIGlmIChtb2RhbE9wdGlvbnMgPT0gXCJcIikge1xyXG4gICAgICAgIHRoaXMubWVzc2FnZXIuaW5mbyh0aGlzLmxvY2FsZVBpcGUudHJhbnNmb3JtKFwibW9kYWxPcHRpb25zQ2FudEJlRW1wdHlcIikpO1xyXG4gICAgICAgIHJldHVybiBvZihudWxsKTtcclxuICAgICAgfVxyXG4gICAgICBtb2RhbE9wdGlvbnMgPSBKU09OLnBhcnNlKG1vZGFsT3B0aW9ucyk7XHJcbiAgICB9XHJcblxyXG4gICAgbGV0IG1vZGFsT3B0czogTW9kYWxPcHRpb25zID0ge1xyXG4gICAgICB0aXRsZTogdGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybShcImJpbGxUcmFja2VyXCIpXHJcbiAgICB9O1xyXG4gICAgbW9kYWxPcHRzID0gT2JqZWN0LmFzc2lnbihtb2RhbE9wdHMsIHRoaXMuZGVmYXVsdE1vZGFsT3B0aW9ucywgbW9kYWxPcHRpb25zKTtcclxuXHJcbiAgICBpZiAodHlwZW9mIGdyYXBoT3B0aW9ucyA9PSBcInN0cmluZ1wiKSB7XHJcbiAgICAgIGlmIChncmFwaE9wdGlvbnMgIT0gXCJcIikge1xyXG4gICAgICAgIGdyYXBoT3B0aW9ucyA9IEpTT04ucGFyc2UoZ3JhcGhPcHRpb25zKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBncmFwaE9wdGlvbnMgPSBudWxsO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKHR5cGVvZiBncmlkT3B0aW9ucyA9PSBcInN0cmluZ1wiKSB7XHJcbiAgICAgIGlmIChncmlkT3B0aW9ucyAhPSBcIlwiKSB7XHJcbiAgICAgICAgZ3JpZE9wdGlvbnMgPSBKU09OLnBhcnNlKGdyaWRPcHRpb25zKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBncmlkT3B0aW9ucyA9IG51bGw7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBkb3duQXJncyA9IG5ldyBHZXREb3duQmlsbHNJbmZvQXJncygpO1xyXG4gICAgZG93bkFyZ3MuYmlsbERhdGFJZCA9IGFyZ3MuYmlsbERhdGFJZDtcclxuICAgIGRvd25BcmdzLmRvY3VtZW50VHlwZUlkID0gYXJncy5kb2N1bWVudFR5cGVJZDtcclxuICAgIGRvd25BcmdzLmJpektpbmQgPSBhcmdzLmJpektpbmQ7XHJcbiAgICBkb3duQXJncy5iaXpUeXBlID0gYXJncy5iaXpUeXBlO1xyXG4gICAgZG93bkFyZ3MuYmlsbENoaWxkSW5mb3MgPSBhcmdzLmJpbGxDaGlsZEluZm9zO1xyXG4gICAgZG93bkFyZ3MuY3VyWWVhciA9IGFyZ3MuY3VyWWVhcjtcclxuXHJcbiAgICB0aGlzLmxvYWRpbmcuc2hvdyh7IG1lc3NhZ2U6IHRoaXMubG9jYWxlUGlwZS50cmFuc2Zvcm0oXCJsb2FkaW5nXCIpIH0pO1xyXG4gICAgcmV0dXJuIHRoaXMuZGF0YVNlcnZpY2UuY2FuVHJhY2tpbmcoZG93bkFyZ3MpLnBpcGUoXHJcbiAgICAgIHN3aXRjaE1hcChcclxuICAgICAgICAocmVzOiBDYW5UcmFja2luZ1Jlc3VsdCkgPT4ge1xyXG4gICAgICAgICAgaWYgKCFyZXMuY2FuRG93blRyYWNraW5nICYmICFyZXMuY2FuVXBUcmFja2luZykge1xyXG4gICAgICAgICAgICB0aGlzLm1lc3NhZ2VyLmluZm8odGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybShcIm5vQXNzb0JpbGxcIikpO1xyXG4gICAgICAgICAgICB0aGlzLmxvYWRpbmcuY2xvc2UoKTtcclxuICAgICAgICAgICAgcmV0dXJuIG9mKG51bGwpO1xyXG4gICAgICAgICAgfVxyXG5cclxuICAgICAgICAgIGNvbnN0IGJpbGxUcmFja2VyQXJnczogQmlsbFRyYWNrZXJBcmdzID0gbmV3IEJpbGxUcmFja2VyQXJncygpO1xyXG4gICAgICAgICAgYmlsbFRyYWNrZXJBcmdzLmNhblRyYWNraW5nUmVzdWx0ID0gcmVzO1xyXG4gICAgICAgICAgYmlsbFRyYWNrZXJBcmdzLmdldEJpbGxzSW5mb0FyZ3MgPSBhcmdzO1xyXG5cclxuICAgICAgICAgIGxldCBncmFwaE9wdCA9IG5ldyBCaWxsVHJhY2tlckdyYXBoT3B0aW9ucygpO1xyXG4gICAgICAgICAgZ3JhcGhPcHQgPSBPYmplY3QuYXNzaWduKGdyYXBoT3B0LCBncmFwaE9wdGlvbnMpO1xyXG4gICAgICAgICAgYmlsbFRyYWNrZXJBcmdzLmdyYXBoT3B0aW9ucyA9IGdyYXBoT3B0O1xyXG5cclxuICAgICAgICAgIGxldCBncmlkT3B0ID0gbmV3IEJpbGxUcmFja2VyR3JpZE9wdGlvbnMoKTtcclxuICAgICAgICAgIGdyaWRPcHQgPSBPYmplY3QuYXNzaWduKGdyaWRPcHQsIGdyaWRPcHRpb25zKTtcclxuICAgICAgICAgIGJpbGxUcmFja2VyQXJncy5ncmlkT3B0aW9ucyA9IGdyaWRPcHQ7XHJcblxyXG4gICAgICAgICAgY29uc3QgY21wUiA9IHRoaXMuY3JlYXRlQmlsbFRyYWNrZXJDb21wb25lbnQoYmlsbFRyYWNrZXJBcmdzKTtcclxuXHJcbiAgICAgICAgICB0aGlzLmxvYWRpbmcuY2xvc2UoKTtcclxuICAgICAgICAgIGNvbnN0IG1vZGFsUmVmID0gdGhpcy5tb2RhbFNlcnZpY2Uuc2hvdyhjbXBSLCBtb2RhbE9wdHMpO1xyXG4gICAgICAgICAgaWYgKG1heGltaXplZCkge1xyXG4gICAgICAgICAgICBtb2RhbFJlZi5kaWFsb2cuaW5zdGFuY2UubWF4RGlhbG9nKCk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBjbXBSLmluc3RhbmNlLnNldE1vZGFsUmVmKG1vZGFsUmVmKTtcclxuXHJcbiAgICAgICAgICByZXR1cm4gb2YoY21wUi5pbnN0YW5jZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICApLFxyXG4gICAgICBjYXRjaEVycm9yKFxyXG4gICAgICAgIChlcnIpID0+IHtcclxuICAgICAgICAgIHRoaXMubG9hZGluZy5jbG9zZSgpO1xyXG4gICAgICAgICAgLy90b2RvIOehruWumuW8guW4uOe7k+aehCwg55uu5YmN6YeH55So5YW85a655Y+W5YC85pa55byPXHJcbiAgICAgICAgICB0aGlzLm1lc3NhZ2VyLmVycm9yKGVyci5lcnJvciA9PSBudWxsID8gZXJyLm1lc3NhZ2UgOiAoZXJyLmVycm9yLk1lc3NhZ2UgfHwgZXJyLmVycm9yLm1lc3NhZ2UgfHwgZXJyLm1lc3NhZ2UpKTtcclxuICAgICAgICAgIHRocm93IGVycjtcclxuICAgICAgICB9XHJcbiAgICAgIClcclxuICAgICk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDmiZPlvIDljZXmja7ov73ouKrlupTnlKhcclxuICAgKiBAcGFyYW0gYXJncyDljZXmja7ov73ouKrlj4LmlbBcclxuICAgKiBAcGFyYW0gZ3JhcGhPcHRpb25zIOi/vei4quWbvumFjee9rlxyXG4gICAqIEBwYXJhbSBncmlkT3B0aW9ucyDmlbDmja7ooajphY3nva5cclxuICAgKi9cclxuICBwdWJsaWMgb3BlbkRlZmF1bHRCaWxsVHJhY2tlckFwcChhcmdzOiBHZXRCaWxsc0luZm9BcmdzLCBncmFwaE9wdGlvbnM/OiBCaWxsVHJhY2tlckdyYXBoT3B0aW9ucywgZ3JpZE9wdGlvbnM/OiBCaWxsVHJhY2tlckdyaWRPcHRpb25zKTogdm9pZCB7XHJcbiAgICBpZiAodHlwZW9mIGdyYXBoT3B0aW9ucyA9PSBcInN0cmluZ1wiKSB7XHJcbiAgICAgIGlmIChncmFwaE9wdGlvbnMgPT0gXCJcIikge1xyXG4gICAgICAgIHRoaXMubWVzc2FnZXIuaW5mbyh0aGlzLmxvY2FsZVBpcGUudHJhbnNmb3JtKFwibW9kYWxPcHRpb25zQ2FudEJlRW1wdHlcIikpO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG4gICAgICBncmFwaE9wdGlvbnMgPSBKU09OLnBhcnNlKGdyYXBoT3B0aW9ucyk7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKHR5cGVvZiBncmlkT3B0aW9ucyA9PSBcInN0cmluZ1wiKSB7XHJcbiAgICAgIGlmIChncmlkT3B0aW9ucyA9PSBcIlwiKSB7XHJcbiAgICAgICAgdGhpcy5tZXNzYWdlci5pbmZvKHRoaXMubG9jYWxlUGlwZS50cmFuc2Zvcm0oXCJtb2RhbE9wdGlvbnNDYW50QmVFbXB0eVwiKSk7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgICB9XHJcbiAgICAgIGdyaWRPcHRpb25zID0gSlNPTi5wYXJzZShncmlkT3B0aW9ucyk7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgZG93bkFyZ3MgPSBuZXcgR2V0RG93bkJpbGxzSW5mb0FyZ3MoKTtcclxuICAgIGRvd25BcmdzLmRvY3VtZW50VHlwZUlkID0gYXJncy5kb2N1bWVudFR5cGVJZDtcclxuICAgIGRvd25BcmdzLmJpbGxEYXRhSWQgPSBhcmdzLmJpbGxEYXRhSWQ7XHJcbiAgICBkb3duQXJncy5iaXpLaW5kID0gYXJncy5iaXpLaW5kO1xyXG4gICAgZG93bkFyZ3MuYml6VHlwZSA9IGFyZ3MuYml6VHlwZTtcclxuICAgIGRvd25BcmdzLmJpbGxDaGlsZEluZm9zID0gYXJncy5iaWxsQ2hpbGRJbmZvcztcclxuICAgIGRvd25BcmdzLmN1clllYXIgPSBhcmdzLmN1clllYXI7XHJcblxyXG4gICAgdGhpcy5sb2FkaW5nLnNob3coeyBtZXNzYWdlOiB0aGlzLmxvY2FsZVBpcGUudHJhbnNmb3JtKFwibG9hZGluZ1wiKSB9KTtcclxuICAgIHRoaXMuZGF0YVNlcnZpY2UuY2FuVHJhY2tpbmcoZG93bkFyZ3MpLnN1YnNjcmliZShcclxuICAgICAgKHJlczogQ2FuVHJhY2tpbmdSZXN1bHQpID0+IHtcclxuICAgICAgICBpZiAoIXJlcy5jYW5Eb3duVHJhY2tpbmcgJiYgIXJlcy5jYW5VcFRyYWNraW5nKSB7XHJcbiAgICAgICAgICB0aGlzLm1lc3NhZ2VyLmluZm8odGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybShcIm5vQXNzb0JpbGxcIikpO1xyXG4gICAgICAgICAgdGhpcy5sb2FkaW5nLmNsb3NlKCk7XHJcbiAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zdCBiaWxsVHJhY2tlckFyZ3M6IEJpbGxUcmFja2VyQXJncyA9IG5ldyBCaWxsVHJhY2tlckFyZ3MoKTtcclxuICAgICAgICAvLyB3YXJuaW5n77ya5aaC5p6c5a2Y5Zyo54m55q6K5a2X56ym5oiW6ICF6ZW/5bqm6LaF6ZW/77yM5Y+v6IO95Lya5omT5byA56m655m955qE5Y2V5o2u6L+96Liq5bqU55SoXHJcbiAgICAgICAgYmlsbFRyYWNrZXJBcmdzLmNhblRyYWNraW5nUmVzdWx0ID0gcmVzO1xyXG4gICAgICAgIGJpbGxUcmFja2VyQXJncy5nZXRCaWxsc0luZm9BcmdzID0gYXJncztcclxuXHJcbiAgICAgICAgbGV0IGdyYXBoT3B0ID0gbmV3IEJpbGxUcmFja2VyR3JhcGhPcHRpb25zKCk7XHJcbiAgICAgICAgZ3JhcGhPcHQgPSBPYmplY3QuYXNzaWduKGdyYXBoT3B0LCBncmFwaE9wdGlvbnMpO1xyXG4gICAgICAgIGJpbGxUcmFja2VyQXJncy5ncmFwaE9wdGlvbnMgPSBncmFwaE9wdDtcclxuXHJcbiAgICAgICAgbGV0IGdyaWRPcHQgPSBuZXcgQmlsbFRyYWNrZXJHcmlkT3B0aW9ucygpO1xyXG4gICAgICAgIGdyaWRPcHQgPSBPYmplY3QuYXNzaWduKGdyaWRPcHQsIGdyaWRPcHRpb25zKTtcclxuICAgICAgICBiaWxsVHJhY2tlckFyZ3MuZ3JpZE9wdGlvbnMgPSBncmlkT3B0O1xyXG5cclxuICAgICAgICBjb25zdCBvcHQ6IEFwcE9wdGlvbnMgPSB7XHJcbiAgICAgICAgICBhcHBJZDogQmlsbFRyYWNrZXJDb25zdGFudC5ERUZBVUxUX0FQUF9JRCxcclxuICAgICAgICAgIGFwcEVudHJhbmNlOiBCaWxsVHJhY2tlckNvbnN0YW50LkRFRkFVTFRfQVBQX0VOVFJBTkNFLFxyXG4gICAgICAgICAgZnVuY0lkOiBCaWxsVHJhY2tlckNvbnN0YW50LkRFRkFVTFRfRlVOQ19JRCxcclxuICAgICAgICAgIHRhYklkOiBcImJpbGxUcmFja2VyXCIgKyBEYXRlLm5vdygpLFxyXG4gICAgICAgICAgdGFiTmFtZTogdGhpcy5sb2NhbGVQaXBlLnRyYW5zZm9ybShcImJpbGxUcmFja2VyXCIpLFxyXG4gICAgICAgICAgYXBwVHlwZTogQXBwVHlwZS5BcHAsXHJcbiAgICAgICAgICBlbnRpdHlQYXJhbXM6IGJpbGxUcmFja2VyQXJncyxcclxuICAgICAgICAgIHF1ZXJ5U3RyaW5nUGFyYW1zOiB0aGlzLmJ1aWxkUXVlcnlNYXAoYmlsbFRyYWNrZXJBcmdzKSxcclxuICAgICAgICAgIGlzUmVsb2FkOiB1bmRlZmluZWQsXHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdGhpcy5mcmFtZXdvcmtTZXJ2aWNlLm9wZW5NZW51KG9wdCk7XHJcbiAgICAgICAgdGhpcy5sb2FkaW5nLmNsb3NlKCk7XHJcbiAgICAgIH0sXHJcbiAgICAgIChlcnIpID0+IHtcclxuICAgICAgICB0aGlzLmxvYWRpbmcuY2xvc2UoKTtcclxuICAgICAgICAvL3RvZG8g56Gu5a6a5byC5bi457uT5p6ELCDnm67liY3ph4fnlKjlhbzlrrnlj5blgLzmlrnlvI9cclxuICAgICAgICB0aGlzLm1lc3NhZ2VyLmVycm9yKGVyci5lcnJvciA9PSBudWxsID8gZXJyLm1lc3NhZ2UgOiAoZXJyLmVycm9yLk1lc3NhZ2UgfHwgZXJyLmVycm9yLm1lc3NhZ2UgfHwgZXJyLm1lc3NhZ2UpKTtcclxuICAgICAgICB0aHJvdyBlcnI7XHJcbiAgICAgIH1cclxuICAgICk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDliJvlu7rljZXmja7ov73ouKrnu4Tku7ZcclxuICAgKiBAcGFyYW0gYmlsbFRyYWNrZXJBcmdzIOWNleaNrui/vei4quWPguaVsFxyXG4gICAqIEBwYXJhbSBjZnIgQ29tcG9uZW50RmFjdG9yeVJlc29sdmVyXHJcbiAgICogQHBhcmFtIGluamVjdG9yIEluamVjdG9yXHJcbiAgICogQHBhcmFtIGN1c3RQcm92aWRlcnMg6Ieq5a6a5LmJUHJvdmlkZXJcclxuICAgKiBAcmV0dXJuc1xyXG4gICAqL1xyXG4gIHB1YmxpYyBjcmVhdGVCaWxsVHJhY2tlckNvbXBvbmVudChiaWxsVHJhY2tlckFyZ3M6IEJpbGxUcmFja2VyQXJncywgY2ZyPzogQ29tcG9uZW50RmFjdG9yeVJlc29sdmVyLCBpbmplY3Rvcj86IEluamVjdG9yLCBjdXN0UHJvdmlkZXJzPzogYW55W10pIHtcclxuICAgIGNmciA9IGNmciA9PSBudWxsID8gdGhpcy5jZnIgOiBjZnI7XHJcbiAgICBpbmplY3RvciA9IGluamVjdG9yID09IG51bGwgPyB0aGlzLmluamVjdG9yIDogaW5qZWN0b3I7XHJcbiAgICBjdXN0UHJvdmlkZXJzID0gY3VzdFByb3ZpZGVycyA9PSBudWxsIHx8IEFycmF5LmlzQXJyYXkoY3VzdFByb3ZpZGVycykgPT0gZmFsc2UgPyBbXSA6IGN1c3RQcm92aWRlcnM7XHJcblxyXG4gICAgY29uc3QgaW5qID0gUmVmbGVjdGl2ZUluamVjdG9yLnJlc29sdmVBbmRDcmVhdGUoW1xyXG4gICAgICB7IHByb3ZpZGU6IEJpbGxUcmFja2VyQXJncywgdXNlVmFsdWU6IGJpbGxUcmFja2VyQXJncyB9LFxyXG4gICAgICAuLi5jdXN0UHJvdmlkZXJzXHJcbiAgICBdLCBpbmplY3Rvcik7XHJcbiAgICBjb25zdCBjbXBGID0gY2ZyLnJlc29sdmVDb21wb25lbnRGYWN0b3J5KEJpbGxUcmFja2VyQ29tcG9uZW50KTtcclxuICAgIGNvbnN0IGNtcFIgPSBjbXBGLmNyZWF0ZShpbmopO1xyXG4gICAgcmV0dXJuIGNtcFI7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDog73lkKbnu6fnu63ov73ouKpcclxuICAgKiBAcGFyYW0gYXJnc1xyXG4gICAqIEByZXR1cm5zXHJcbiAgICovXHJcbiAgcHVibGljIGNhblRyYWNraW5nKGFyZ3M6IEdldERvd25CaWxsc0luZm9BcmdzKTogT2JzZXJ2YWJsZTxDYW5UcmFja2luZ1Jlc3VsdD4ge1xyXG4gICAgcmV0dXJuIHRoaXMuZGF0YVNlcnZpY2UuY2FuVHJhY2tpbmcoYXJncyk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDojrflj5bkuIvmuLjljZXmja7kv6Hmga9cclxuICAgKiBAcGFyYW0gYXJnc1xyXG4gICAqIEByZXR1cm5zXHJcbiAgICovXHJcbiAgcHVibGljIGdldERvd25CaWxsc0luZm8oYXJnczogR2V0RG93bkJpbGxzSW5mb0FyZ3MpOiBPYnNlcnZhYmxlPERvd25CaWxsSW5mb1Jlc3VsdFtdPiB7XHJcbiAgICByZXR1cm4gdGhpcy5kYXRhU2VydmljZS5nZXREb3duQmlsbHNJbmZvKGFyZ3MpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog6I635Y+W5LiK5ri45Y2V5o2u5L+h5oGvXHJcbiAgICogQHBhcmFtIGFyZ3NcclxuICAgKiBAcmV0dXJuc1xyXG4gICAqL1xyXG4gIHB1YmxpYyBnZXRVcEJpbGxzSW5mbyhhcmdzOiBHZXRVcEJpbGxzSW5mb0FyZ3MpOiBPYnNlcnZhYmxlPFVwQmlsbEluZm9SZXN1bHRbXT4ge1xyXG4gICAgcmV0dXJuIHRoaXMuZGF0YVNlcnZpY2UuZ2V0VXBCaWxsc0luZm8oYXJncyk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDmn6Xor6Llrp7kvZPmlbDmja5cclxuICAgKiBAcGFyYW0gYXJnc1xyXG4gICAqIEByZXR1cm5zXHJcbiAgICovXHJcbiAgcHVibGljIGdldEVudGl0eURhdGEoYXJnczogR2V0TWFpbkVudGl0eURhdGFBcmdzKTogT2JzZXJ2YWJsZTxFbnRpdHlEYXRhUmVzdWx0PiB7XHJcbiAgICByZXR1cm4gdGhpcy5kYXRhU2VydmljZS5nZXRFbnRpdHlEYXRhKGFyZ3MpO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBidWlsZFF1ZXJ5TWFwKGJpbGxUcmFja2VyQXJnczogQmlsbFRyYWNrZXJBcmdzKTogTWFwPHN0cmluZywgc3RyaW5nPiB7XHJcbiAgICBsZXQgbWFwID0gbmV3IE1hcCgpO1xyXG4gICAgZm9yIChsZXQga2V5IGluIGJpbGxUcmFja2VyQXJncykge1xyXG4gICAgICBsZXQgdmFsdWUgPSBiaWxsVHJhY2tlckFyZ3Nba2V5XTtcclxuICAgICAgaWYgKHR5cGVvZiB2YWx1ZSA9PSBcIm9iamVjdFwiKSB7XHJcbiAgICAgICAgdmFsdWUgPSB2YWx1ZSAmJiBKU09OLnN0cmluZ2lmeSh2YWx1ZSk7XHJcbiAgICAgIH1cclxuICAgICAgLy8gdXJs57yW56CB5ZCOYmFzZTY05Yqg5a+G77yM6YG/5YWNdXJs5Lit5Ye6546w54m55q6K5a2X56ymXHJcbiAgICAgIC8vIOWcqGRlZmF1bHQtYmlsbC10cmFja2Vy5Lit6Kej56CB5pe25bqU5YWIYXRvYuWcqGRlY29kZVVSSUNvbXBvbmVudFxyXG4gICAgICBtYXAuc2V0KGtleSwgYnRvYShlbmNvZGVVUklDb21wb25lbnQodmFsdWUpKSk7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIG1hcDtcclxuICB9XHJcbn1cclxuIl19