/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
// tslint:disable-next-line:import-blacklist
import { BehaviorSubject, Subscription, Subject } from 'rxjs';
import { Injectable } from '@angular/core';
var EventBusPipe = /** @class */ (function () {
    function EventBusPipe(tokenValue, parentEventPipeList, sub) {
        this.tokenValue = tokenValue;
        this.parentEventPipeList = parentEventPipeList;
        this.eventSubject = sub || new BehaviorSubject(null);
        this.subscription = new Subscription();
        this.onceSubscription = new Subscription();
        this.observers = new Map();
        if (this.parentEventPipeList) {
            this.parentEventPipeList.push(this);
        }
    }
    /**
     * @param {?} bizPara
     * @return {?}
     */
    EventBusPipe.prototype.post = /**
     * @param {?} bizPara
     * @return {?}
     */
    function (bizPara) {
        this.eventSubject.next(bizPara);
    };
    /**
     * @param {?} eventHandler
     * @return {?}
     */
    EventBusPipe.prototype.subscribe = /**
     * @param {?} eventHandler
     * @return {?}
     */
    function (eventHandler) {
        this.subscription = this.eventSubject.subscribe((/**
         * @param {?} value
         * @return {?}
         */
        function (value) {
            eventHandler(value);
        }));
        return this;
    };
    /**
     * @param {?} observerKey
     * @param {?} eventHandler
     * @return {?}
     */
    EventBusPipe.prototype.subscribeWithObkey = /**
     * @param {?} observerKey
     * @param {?} eventHandler
     * @return {?}
     */
    function (observerKey, eventHandler) {
        /** @type {?} */
        var observer = this.observers.get(observerKey);
        if (observer) {
            observer.unsubscribe();
        }
        /** @type {?} */
        var sub = this.eventSubject.subscribe((/**
         * @param {?} value
         * @return {?}
         */
        function (value) {
            eventHandler(value);
        }));
        this.observers.set(observerKey, sub);
        return this;
    };
    /**
     * @param {?} eventHandler
     * @return {?}
     */
    EventBusPipe.prototype.subscribeOnce = /**
     * @param {?} eventHandler
     * @return {?}
     */
    function (eventHandler) {
        /** @type {?} */
        var self = this;
        /** @type {?} */
        var scription = this.eventSubject.subscribe((/**
         * @param {?} value
         * @return {?}
         */
        function (value) {
            eventHandler(value);
            if (scription) {
                scription.unsubscribe();
            }
            self.parentEventPipeList = new Array();
        }));
        return this;
    };
    /**
     * @return {?}
     */
    EventBusPipe.prototype.unSubscribe = /**
     * @return {?}
     */
    function () {
        if (this.subscription) {
            this.subscription.unsubscribe();
            this.subscription = null;
        }
    };
    // 注销使用once方法注册的订阅。
    // 注销使用once方法注册的订阅。
    /**
     * @return {?}
     */
    EventBusPipe.prototype.unSubscribeForOnce = 
    // 注销使用once方法注册的订阅。
    /**
     * @return {?}
     */
    function () {
        this.onceSubscription.unsubscribe();
    };
    /**
     * 取消某观察者的订阅
     * @param observerKey 观察者唯一标识
     */
    /**
     * 取消某观察者的订阅
     * @param {?} observerKey 观察者唯一标识
     * @return {?}
     */
    EventBusPipe.prototype.unSubscribeWithObkey = /**
     * 取消某观察者的订阅
     * @param {?} observerKey 观察者唯一标识
     * @return {?}
     */
    function (observerKey) {
        /** @type {?} */
        var scription = this.observers.get(observerKey);
        if (scription) {
            scription.unsubscribe();
        }
    };
    /**
     * @param {?} tokenValue
     * @return {?}
     */
    EventBusPipe.prototype.matchEmitterToken = /**
     * @param {?} tokenValue
     * @return {?}
     */
    function (tokenValue) {
        if (this.tokenValue && tokenValue && this.tokenValue !== tokenValue) {
            return false;
        }
        return true;
    };
    /**
     * @param {?} tokenValue
     * @return {?}
     */
    EventBusPipe.prototype.examByTargetToken = /**
     * @param {?} tokenValue
     * @return {?}
     */
    function (tokenValue) {
        if (this.tokenValue !== tokenValue) {
            return false;
        }
        return true;
    };
    /**
     * @param {?} subscriber
     * @return {?}
     */
    EventBusPipe.prototype.dispose = /**
     * @param {?} subscriber
     * @return {?}
     */
    function (subscriber) {
    };
    EventBusPipe.decorators = [
        { type: Injectable }
    ];
    /** @nocollapse */
    EventBusPipe.ctorParameters = function () { return [
        { type: String },
        { type: Array },
        { type: Subject }
    ]; };
    return EventBusPipe;
}());
export { EventBusPipe };
if (false) {
    /** @type {?} */
    EventBusPipe.prototype.eventSubject;
    /** @type {?} */
    EventBusPipe.prototype.observers;
    /** @type {?} */
    EventBusPipe.prototype.pipeCode;
    /**
     * @type {?}
     * @private
     */
    EventBusPipe.prototype.subscription;
    /**
     * @type {?}
     * @private
     */
    EventBusPipe.prototype.onceSubscription;
    /**
     * @type {?}
     * @private
     */
    EventBusPipe.prototype.tokenValue;
    /**
     * @type {?}
     * @private
     */
    EventBusPipe.prototype.parentEventPipeList;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZnJtLWV2ZW50cGlwZS5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0Bnc3Atc3lzL3J0Zi1jb21tb24vIiwic291cmNlcyI6WyJsaWIvZXZlbnRidXMvZnJtLWV2ZW50cGlwZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7OztBQUNBLE9BQU8sRUFBRSxlQUFlLEVBQUUsWUFBWSxFQUFFLE9BQU8sRUFBRSxNQUFNLE1BQU0sQ0FBQztBQUM5RCxPQUFPLEVBQUUsVUFBVSxFQUFRLE1BQU0sZUFBZSxDQUFDO0FBR2pEO0lBU0ksc0JBQW9CLFVBQWtCLEVBQVUsbUJBQXdDLEVBQUUsR0FBaUI7UUFBdkYsZUFBVSxHQUFWLFVBQVUsQ0FBUTtRQUFVLHdCQUFtQixHQUFuQixtQkFBbUIsQ0FBcUI7UUFDcEYsSUFBSSxDQUFDLFlBQVksR0FBRyxHQUFHLElBQUksSUFBSSxlQUFlLENBQU0sSUFBSSxDQUFDLENBQUM7UUFDMUQsSUFBSSxDQUFDLFlBQVksR0FBRyxJQUFJLFlBQVksRUFBRSxDQUFDO1FBQ3ZDLElBQUksQ0FBQyxnQkFBZ0IsR0FBRyxJQUFJLFlBQVksRUFBRSxDQUFDO1FBQzNDLElBQUksQ0FBQyxTQUFTLEdBQUcsSUFBSSxHQUFHLEVBQXdCLENBQUM7UUFFakQsSUFBSSxJQUFJLENBQUMsbUJBQW1CLEVBQUU7WUFDMUIsSUFBSSxDQUFDLG1CQUFtQixDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztTQUN2QztJQUNMLENBQUM7Ozs7O0lBRUQsMkJBQUk7Ozs7SUFBSixVQUFLLE9BQVk7UUFDYixJQUFJLENBQUMsWUFBWSxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQztJQUNwQyxDQUFDOzs7OztJQUVELGdDQUFTOzs7O0lBQVQsVUFBVSxZQUFrQztRQUN4QyxJQUFJLENBQUMsWUFBWSxHQUFHLElBQUksQ0FBQyxZQUFZLENBQUMsU0FBUzs7OztRQUFDLFVBQUMsS0FBSztZQUNsRCxZQUFZLENBQUMsS0FBSyxDQUFDLENBQUM7UUFDeEIsQ0FBQyxFQUFDLENBQUM7UUFDSCxPQUFPLElBQUksQ0FBQztJQUNoQixDQUFDOzs7Ozs7SUFFRCx5Q0FBa0I7Ozs7O0lBQWxCLFVBQW1CLFdBQW1CLEVBQUUsWUFBa0M7O1lBQ2hFLFFBQVEsR0FBRyxJQUFJLENBQUMsU0FBUyxDQUFDLEdBQUcsQ0FBQyxXQUFXLENBQUM7UUFDaEQsSUFBSSxRQUFRLEVBQUU7WUFDVixRQUFRLENBQUMsV0FBVyxFQUFFLENBQUM7U0FDMUI7O1lBQ0ssR0FBRyxHQUFHLElBQUksQ0FBQyxZQUFZLENBQUMsU0FBUzs7OztRQUFDLFVBQUMsS0FBSztZQUMxQyxZQUFZLENBQUMsS0FBSyxDQUFDLENBQUM7UUFDeEIsQ0FBQyxFQUFDO1FBQ0YsSUFBSSxDQUFDLFNBQVMsQ0FBQyxHQUFHLENBQUMsV0FBVyxFQUFFLEdBQUcsQ0FBQyxDQUFDO1FBQ3JDLE9BQU8sSUFBSSxDQUFDO0lBQ2hCLENBQUM7Ozs7O0lBRUQsb0NBQWE7Ozs7SUFBYixVQUFjLFlBQWtDOztZQUN0QyxJQUFJLEdBQUcsSUFBSTs7WUFDWCxTQUFTLEdBQUcsSUFBSSxDQUFDLFlBQVksQ0FBQyxTQUFTOzs7O1FBQUMsVUFBQyxLQUFLO1lBQ2hELFlBQVksQ0FBQyxLQUFLLENBQUMsQ0FBQztZQUNwQixJQUFJLFNBQVMsRUFBRTtnQkFDWCxTQUFTLENBQUMsV0FBVyxFQUFFLENBQUM7YUFDM0I7WUFDRCxJQUFJLENBQUMsbUJBQW1CLEdBQUcsSUFBSSxLQUFLLEVBQWdCLENBQUM7UUFDekQsQ0FBQyxFQUFDO1FBQ0YsT0FBTyxJQUFJLENBQUM7SUFDaEIsQ0FBQzs7OztJQUVELGtDQUFXOzs7SUFBWDtRQUNJLElBQUksSUFBSSxDQUFDLFlBQVksRUFBRTtZQUNuQixJQUFJLENBQUMsWUFBWSxDQUFDLFdBQVcsRUFBRSxDQUFDO1lBQ2hDLElBQUksQ0FBQyxZQUFZLEdBQUcsSUFBSSxDQUFDO1NBQzVCO0lBQ0wsQ0FBQztJQUNELG1CQUFtQjs7Ozs7SUFDbkIseUNBQWtCOzs7OztJQUFsQjtRQUNJLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxXQUFXLEVBQUUsQ0FBQztJQUN4QyxDQUFDO0lBRUQ7OztPQUdHOzs7Ozs7SUFDSCwyQ0FBb0I7Ozs7O0lBQXBCLFVBQXFCLFdBQW1COztZQUM5QixTQUFTLEdBQUcsSUFBSSxDQUFDLFNBQVMsQ0FBQyxHQUFHLENBQUMsV0FBVyxDQUFDO1FBQ2pELElBQUksU0FBUyxFQUFFO1lBQ1gsU0FBUyxDQUFDLFdBQVcsRUFBRSxDQUFDO1NBQzNCO0lBQ0wsQ0FBQzs7Ozs7SUFHRCx3Q0FBaUI7Ozs7SUFBakIsVUFBa0IsVUFBa0I7UUFDaEMsSUFBSSxJQUFJLENBQUMsVUFBVSxJQUFJLFVBQVUsSUFBSSxJQUFJLENBQUMsVUFBVSxLQUFLLFVBQVUsRUFBRTtZQUNqRSxPQUFPLEtBQUssQ0FBQztTQUNoQjtRQUNELE9BQU8sSUFBSSxDQUFDO0lBQ2hCLENBQUM7Ozs7O0lBRUQsd0NBQWlCOzs7O0lBQWpCLFVBQWtCLFVBQWtCO1FBQ2hDLElBQUksSUFBSSxDQUFDLFVBQVUsS0FBSyxVQUFVLEVBQUU7WUFDaEMsT0FBTyxLQUFLLENBQUM7U0FDaEI7UUFDRCxPQUFPLElBQUksQ0FBQztJQUNoQixDQUFDOzs7OztJQUVELDhCQUFPOzs7O0lBQVAsVUFBUSxVQUF3QjtJQUNoQyxDQUFDOztnQkE3RkosVUFBVTs7Ozs7Z0JBUzhELEtBQUs7Z0JBYnRDLE9BQU87O0lBa0cvQyxtQkFBQztDQUFBLEFBOUZELElBOEZDO1NBN0ZZLFlBQVk7OztJQUVyQixvQ0FBa0M7O0lBQ2xDLGlDQUE0Qzs7SUFDNUMsZ0NBQXdCOzs7OztJQUN4QixvQ0FBbUM7Ozs7O0lBQ25DLHdDQUF1Qzs7Ozs7SUFFM0Isa0NBQTBCOzs7OztJQUFFLDJDQUFnRCIsInNvdXJjZXNDb250ZW50IjpbIi8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTppbXBvcnQtYmxhY2tsaXN0XHJcbmltcG9ydCB7IEJlaGF2aW9yU3ViamVjdCwgU3Vic2NyaXB0aW9uLCBTdWJqZWN0IH0gZnJvbSAncnhqcyc7XHJcbmltcG9ydCB7IEluamVjdGFibGUsIFR5cGUgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgSURpc3Bvc2FibGUgfSBmcm9tICcuL3R5cGVzJztcclxuXHJcbkBJbmplY3RhYmxlKClcclxuZXhwb3J0IGNsYXNzIEV2ZW50QnVzUGlwZSBpbXBsZW1lbnRzIElEaXNwb3NhYmxlIHtcclxuXHJcbiAgICBwdWJsaWMgZXZlbnRTdWJqZWN0OiBTdWJqZWN0PGFueT47XHJcbiAgICBwdWJsaWMgb2JzZXJ2ZXJzOiBNYXA8c3RyaW5nLCBTdWJzY3JpcHRpb24+O1xyXG4gICAgcHVibGljIHBpcGVDb2RlOiBzdHJpbmc7XHJcbiAgICBwcml2YXRlIHN1YnNjcmlwdGlvbjogU3Vic2NyaXB0aW9uO1xyXG4gICAgcHJpdmF0ZSBvbmNlU3Vic2NyaXB0aW9uOiBTdWJzY3JpcHRpb247XHJcblxyXG4gICAgY29uc3RydWN0b3IocHJpdmF0ZSB0b2tlblZhbHVlOiBzdHJpbmcsIHByaXZhdGUgcGFyZW50RXZlbnRQaXBlTGlzdDogQXJyYXk8RXZlbnRCdXNQaXBlPiwgc3ViOiBTdWJqZWN0PGFueT4pIHtcclxuICAgICAgICB0aGlzLmV2ZW50U3ViamVjdCA9IHN1YiB8fCBuZXcgQmVoYXZpb3JTdWJqZWN0PGFueT4obnVsbCk7XHJcbiAgICAgICAgdGhpcy5zdWJzY3JpcHRpb24gPSBuZXcgU3Vic2NyaXB0aW9uKCk7XHJcbiAgICAgICAgdGhpcy5vbmNlU3Vic2NyaXB0aW9uID0gbmV3IFN1YnNjcmlwdGlvbigpO1xyXG4gICAgICAgIHRoaXMub2JzZXJ2ZXJzID0gbmV3IE1hcDxzdHJpbmcsIFN1YnNjcmlwdGlvbj4oKTtcclxuXHJcbiAgICAgICAgaWYgKHRoaXMucGFyZW50RXZlbnRQaXBlTGlzdCkge1xyXG4gICAgICAgICAgICB0aGlzLnBhcmVudEV2ZW50UGlwZUxpc3QucHVzaCh0aGlzKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcG9zdChiaXpQYXJhOiBhbnkpIHtcclxuICAgICAgICB0aGlzLmV2ZW50U3ViamVjdC5uZXh0KGJpelBhcmEpO1xyXG4gICAgfVxyXG5cclxuICAgIHN1YnNjcmliZShldmVudEhhbmRsZXI6ICh2YWx1ZTogYW55KSA9PiB2b2lkKTogSURpc3Bvc2FibGUge1xyXG4gICAgICAgIHRoaXMuc3Vic2NyaXB0aW9uID0gdGhpcy5ldmVudFN1YmplY3Quc3Vic2NyaWJlKCh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgICBldmVudEhhbmRsZXIodmFsdWUpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgfVxyXG5cclxuICAgIHN1YnNjcmliZVdpdGhPYmtleShvYnNlcnZlcktleTogc3RyaW5nLCBldmVudEhhbmRsZXI6ICh2YWx1ZTogYW55KSA9PiB2b2lkKTogSURpc3Bvc2FibGUge1xyXG4gICAgICAgIGNvbnN0IG9ic2VydmVyID0gdGhpcy5vYnNlcnZlcnMuZ2V0KG9ic2VydmVyS2V5KTtcclxuICAgICAgICBpZiAob2JzZXJ2ZXIpIHtcclxuICAgICAgICAgICAgb2JzZXJ2ZXIudW5zdWJzY3JpYmUoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3Qgc3ViID0gdGhpcy5ldmVudFN1YmplY3Quc3Vic2NyaWJlKCh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgICBldmVudEhhbmRsZXIodmFsdWUpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMub2JzZXJ2ZXJzLnNldChvYnNlcnZlcktleSwgc3ViKTtcclxuICAgICAgICByZXR1cm4gdGhpcztcclxuICAgIH1cclxuXHJcbiAgICBzdWJzY3JpYmVPbmNlKGV2ZW50SGFuZGxlcjogKHZhbHVlOiBhbnkpID0+IHZvaWQpOiBJRGlzcG9zYWJsZSB7XHJcbiAgICAgICAgY29uc3Qgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgY29uc3Qgc2NyaXB0aW9uID0gdGhpcy5ldmVudFN1YmplY3Quc3Vic2NyaWJlKCh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgICBldmVudEhhbmRsZXIodmFsdWUpO1xyXG4gICAgICAgICAgICBpZiAoc2NyaXB0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICBzY3JpcHRpb24udW5zdWJzY3JpYmUoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBzZWxmLnBhcmVudEV2ZW50UGlwZUxpc3QgPSBuZXcgQXJyYXk8RXZlbnRCdXNQaXBlPigpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgfVxyXG5cclxuICAgIHVuU3Vic2NyaWJlKCkge1xyXG4gICAgICAgIGlmICh0aGlzLnN1YnNjcmlwdGlvbikge1xyXG4gICAgICAgICAgICB0aGlzLnN1YnNjcmlwdGlvbi51bnN1YnNjcmliZSgpO1xyXG4gICAgICAgICAgICB0aGlzLnN1YnNjcmlwdGlvbiA9IG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgLy8g5rOo6ZSA5L2/55Sob25jZeaWueazleazqOWGjOeahOiuoumYheOAglxyXG4gICAgdW5TdWJzY3JpYmVGb3JPbmNlKCkge1xyXG4gICAgICAgIHRoaXMub25jZVN1YnNjcmlwdGlvbi51bnN1YnNjcmliZSgpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog5Y+W5raI5p+Q6KeC5a+f6ICF55qE6K6i6ZiFXHJcbiAgICAgKiBAcGFyYW0gb2JzZXJ2ZXJLZXkg6KeC5a+f6ICF5ZSv5LiA5qCH6K+GXHJcbiAgICAgKi9cclxuICAgIHVuU3Vic2NyaWJlV2l0aE9ia2V5KG9ic2VydmVyS2V5OiBzdHJpbmcpIHtcclxuICAgICAgICBjb25zdCBzY3JpcHRpb24gPSB0aGlzLm9ic2VydmVycy5nZXQob2JzZXJ2ZXJLZXkpO1xyXG4gICAgICAgIGlmIChzY3JpcHRpb24pIHtcclxuICAgICAgICAgICAgc2NyaXB0aW9uLnVuc3Vic2NyaWJlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuXHJcbiAgICBtYXRjaEVtaXR0ZXJUb2tlbih0b2tlblZhbHVlOiBzdHJpbmcpOiBib29sZWFuIHtcclxuICAgICAgICBpZiAodGhpcy50b2tlblZhbHVlICYmIHRva2VuVmFsdWUgJiYgdGhpcy50b2tlblZhbHVlICE9PSB0b2tlblZhbHVlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9XHJcblxyXG4gICAgZXhhbUJ5VGFyZ2V0VG9rZW4odG9rZW5WYWx1ZTogc3RyaW5nKTogYm9vbGVhbiB7XHJcbiAgICAgICAgaWYgKHRoaXMudG9rZW5WYWx1ZSAhPT0gdG9rZW5WYWx1ZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfVxyXG5cclxuICAgIGRpc3Bvc2Uoc3Vic2NyaWJlcjogU3Vic2NyaXB0aW9uKTogdm9pZCB7XHJcbiAgICB9XHJcbn1cclxuIl19