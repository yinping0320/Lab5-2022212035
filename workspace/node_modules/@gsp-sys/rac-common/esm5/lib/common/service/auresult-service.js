/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Injectable } from '@angular/core';
import { RestfulService } from '@farris/devkit';
import { RacCommonUtil } from '../../common/util/rac-util';
import { AuthDataSource } from '../entity/auth-data-source.entity';
// import { isNullOrEmptyString } from '@progress/kendo-angular-grid/dist/es2015/utils';
var AuresultService = /** @class */ (function () {
    function AuresultService(rest, session) {
        this.rest = rest;
        this.session = session;
    }
    /**
     * 获取权限需要分配的业务数据的数据源
     */
    /**
     * 获取权限需要分配的业务数据的数据源
     * @param {?} authField
     * @param {?} resultContext
     * @return {?}
     */
    AuresultService.prototype.getDataSourceByContext = /**
     * 获取权限需要分配的业务数据的数据源
     * @param {?} authField
     * @param {?} resultContext
     * @return {?}
     */
    function (authField, resultContext) {
        // mock数据
        // return of(dataSource);this.resultContext.dictDimensionValue
        /** @type {?} */
        var headers = this.session.getHeader();
        /** @type {?} */
        var url = this.session.getResultPath();
        /** @type {?} */
        var urlNew = url + '/datasource';
        /** @type {?} */
        var year = '';
        if (resultContext.yearObj && resultContext.yearObj.value) {
            year = resultContext.yearObj.value;
        }
        resultContext.year = year;
        if (resultContext.auVarValues && resultContext.auVarValues.length > 0) {
            return this.rest.post(urlNew + '/var', resultContext, null, headers);
        }
        /** @type {?} */
        var ownerId = resultContext.ownerId;
        /** @type {?} */
        var ownerType = resultContext.ownerType;
        /** @type {?} */
        var param = {
            ownerId: ownerId,
            ownerType: ownerType,
            authfield: authField,
            year: year,
        };
        return this.rest.get(urlNew, param, headers);
    };
    /**
     * 获取权限可以分配的业务数据的数据源
     */
    /**
     * 获取权限可以分配的业务数据的数据源
     * @param {?} authField
     * @return {?}
     */
    AuresultService.prototype.getDataSource = /**
     * 获取权限可以分配的业务数据的数据源
     * @param {?} authField
     * @return {?}
     */
    function (authField) {
        /** @type {?} */
        var ownerId = this.session.ownerId;
        /** @type {?} */
        var ownerType = this.session.ownerType;
        /** @type {?} */
        var authDataSource = new AuthDataSource();
        /** @type {?} */
        var headers = this.session.getHeader();
        /** @type {?} */
        var url = this.session.getResultPath();
        /**
         * ownerId  权限所有者Id,此处用户受全局业务组织过滤的，查找已分配的业务组织使用，这里不需要
         * ownerType 权限所有者类型 岗位1，用户2
         * @type {?}
         */
        var param = {
            ownerId: '',
            ownerType: 2,
            authfield: authField,
            year: ''
        };
        /** @type {?} */
        var urlNew = url + '/datasource';
        return this.rest.get(urlNew, param, headers);
    };
    /**
     * 获取权限可以分配的业务数据的数据源
     */
    /**
     * 获取权限可以分配的业务数据的数据源
     * @param {?} authField
     * @param {?} year
     * @return {?}
     */
    AuresultService.prototype.getNoUsersDataSource = /**
     * 获取权限可以分配的业务数据的数据源
     * @param {?} authField
     * @param {?} year
     * @return {?}
     */
    function (authField, year) {
        /** @type {?} */
        var ownerId = 'nouser';
        /** @type {?} */
        var ownerType = this.session.ownerType;
        /** @type {?} */
        var authDataSource = new AuthDataSource();
        /** @type {?} */
        var headers = this.session.getHeader();
        /** @type {?} */
        var url = this.session.getResultPath();
        /**
         * ownerId  权限所有者Id,此处用户受全局业务组织过滤的，查找已分配的业务组织使用，这里不需要
         * ownerType 权限所有者类型 岗位1，用户2
         * @type {?}
         */
        var param = {
            ownerId: ownerId,
            ownerType: 2,
            authfield: authField,
            year: year
        };
        /** @type {?} */
        var urlNew = url + '/datasource';
        return this.rest.get(urlNew, param, headers);
    };
    /**
     * 获取权限需要分配的业务数据的数据源
     */
    /**
     * 获取权限需要分配的业务数据的数据源
     * @param {?} authField
     * @param {?} year
     * @param {?} assid1
     * @param {?} assid2
     * @return {?}
     */
    AuresultService.prototype.getNoUsersDataSourceByGroup = /**
     * 获取权限需要分配的业务数据的数据源
     * @param {?} authField
     * @param {?} year
     * @param {?} assid1
     * @param {?} assid2
     * @return {?}
     */
    function (authField, year, assid1, assid2) {
        // mock数据
        // return of(dataSource);
        /** @type {?} */
        var authDataSource = new AuthDataSource();
        /** @type {?} */
        var headers = this.session.getHeader();
        /** @type {?} */
        var url = this.session.getResultPath();
        /** @type {?} */
        var param = {
            ownerId: 'nouser',
            ownerType: 2,
            authfield: authField,
            year: year,
            assid1: assid1,
            assid2: assid2,
        };
        /** @type {?} */
        var urlNew = url + '/datasource/group';
        return this.rest.get(urlNew, param, headers);
    };
    /**
     * 获取年度
     */
    /**
     * 获取年度
     * @param {?} su
     * @return {?}
     */
    AuresultService.prototype.getYears = /**
     * 获取年度
     * @param {?} su
     * @return {?}
     */
    function (su) {
        /** @type {?} */
        var authDataSource = new AuthDataSource();
        /** @type {?} */
        var headers = this.session.getHeader();
        /** @type {?} */
        var url = this.session.getResultPath();
        if (!su) {
            su = '*';
        }
        /** @type {?} */
        var urlNew = url + '/years/' + su;
        return this.rest.get(urlNew, null, headers);
    };
    AuresultService.decorators = [
        { type: Injectable }
    ];
    /** @nocollapse */
    AuresultService.ctorParameters = function () { return [
        { type: RestfulService },
        { type: RacCommonUtil }
    ]; };
    return AuresultService;
}());
export { AuresultService };
if (false) {
    /**
     * @type {?}
     * @private
     */
    AuresultService.prototype.rest;
    /**
     * @type {?}
     * @private
     */
    AuresultService.prototype.session;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXVyZXN1bHQtc2VydmljZS5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0Bnc3Atc3lzL3JhYy1jb21tb24vIiwic291cmNlcyI6WyJsaWIvY29tbW9uL3NlcnZpY2UvYXVyZXN1bHQtc2VydmljZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7O0FBQUEsT0FBTyxFQUFFLFVBQVUsRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUczQyxPQUFPLEVBQUUsY0FBYyxFQUFFLE1BQU0sZ0JBQWdCLENBQUM7QUFFaEQsT0FBTyxFQUFFLGFBQWEsRUFBRSxNQUFNLDRCQUE0QixDQUFDO0FBQzNELE9BQU8sRUFBRSxjQUFjLEVBQUUsTUFBTSxtQ0FBbUMsQ0FBQzs7QUFNbkU7SUFFSSx5QkFDWSxJQUFvQixFQUNwQixPQUFzQjtRQUR0QixTQUFJLEdBQUosSUFBSSxDQUFnQjtRQUNwQixZQUFPLEdBQVAsT0FBTyxDQUFlO0lBQzlCLENBQUM7SUFJTDs7T0FFRzs7Ozs7OztJQUNILGdEQUFzQjs7Ozs7O0lBQXRCLFVBQXVCLFNBQWlCLEVBQUUsYUFBa0M7Ozs7WUFHbEUsT0FBTyxHQUFHLElBQUksQ0FBQyxPQUFPLENBQUMsU0FBUyxFQUFFOztZQUNsQyxHQUFHLEdBQUcsSUFBSSxDQUFDLE9BQU8sQ0FBQyxhQUFhLEVBQUU7O1lBQ2xDLE1BQU0sR0FBRyxHQUFHLEdBQUcsYUFBYTs7WUFDOUIsSUFBSSxHQUFHLEVBQUU7UUFDYixJQUFLLGFBQWEsQ0FBQyxPQUFPLElBQUksYUFBYSxDQUFDLE9BQU8sQ0FBQyxLQUFLLEVBQUc7WUFDeEQsSUFBSSxHQUFHLGFBQWEsQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFDO1NBQ3RDO1FBQ0QsYUFBYSxDQUFDLElBQUksR0FBRyxJQUFJLENBQUM7UUFDMUIsSUFBSyxhQUFhLENBQUMsV0FBVyxJQUFJLGFBQWEsQ0FBQyxXQUFXLENBQUMsTUFBTSxHQUFHLENBQUMsRUFBRztZQUNyRSxPQUFPLElBQUksQ0FBQyxJQUFJLENBQUMsSUFBSSxD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QUFVOztZQUNULGNBQWMsR0FBRyxJQUFJLGNBQWMsRUFBRTs7WUFDckMsT0FBTyxHQUFHLElBQUksQ0FBQyxPQUFPLENBQUMsU0FBUyxFQUFFOztZQUNsQyxHQUFHLEdBQUcsSUFBSSxDQUFDLE9BQU8sQ0FBQyxhQUFhLEVBQUU7UUFDeEMsSUFBSSxDQUFDLEVBQUUsRUFBRTtZQUNMLEVBQUUsR0FBRyxHQUFHLENBQUM7U0FDWjs7WUFDSyxNQUFNLEdBQUcsR0FBRyxHQUFHLFNBQVMsR0FBRyxFQUFFO1FBQ25DLE9BQU8sSUFBSSxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsTUFBTSxFQUFFLElBQUksRUFBRSxPQUFPLENBQUMsQ0FBQztJQUNoRCxDQUFDOztnQkF0SEosVUFBVTs7OztnQkFURixjQUFjO2dCQUVkLGFBQWE7O0lBK0h0QixzQkFBQztDQUFBLEFBeEhELElBd0hDO1NBdkhZLGVBQWU7Ozs7OztJQUVwQiwrQkFBNEI7Ozs7O0lBQzVCLGtDQUE4QiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEluamVjdGFibGUgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgT2JzZXJ2YWJsZSB9IGZyb20gJ3J4anMvT2JzZXJ2YWJsZSc7XHJcbmltcG9ydCB7IG9mIH0gZnJvbSAncnhqcy9vYnNlcnZhYmxlL29mJztcclxuaW1wb3J0IHsgUmVzdGZ1bFNlcnZpY2UgfSBmcm9tICdAZmFycmlzL2RldmtpdCc7XHJcbmltcG9ydCB7IEh0dHBIZWFkZXJzLCBIdHRwUGFyYW1zIH0gZnJvbSAnQGFuZ3VsYXIvY29tbW9uL2h0dHAnO1xyXG5pbXBvcnQgeyBSYWNDb21tb25VdGlsIH0gZnJvbSAnLi4vLi4vY29tbW9uL3V0aWwvcmFjLXV0aWwnO1xyXG5pbXBvcnQgeyBBdXRoRGF0YVNvdXJjZSB9IGZyb20gJy4uL2VudGl0eS9hdXRoLWRhdGEtc291cmNlLmVudGl0eSc7XHJcbmltcG9ydCB7IEF1cmVzdWx0Q2hhbmdlc0VudGl0eSwgQXVyZXN1bHRTYXZlIH0gZnJvbSAnLi4vZW50aXR5L2F1cmVzdXQtY2hhbmdlcy5lbnRpdHknO1xyXG5pbXBvcnQgeyBBdXJlc3VsdEVudGl0eSB9IGZyb20gJy4uL2VudGl0eS9hdXJlc3VsdC5lbnRpdHknO1xyXG5pbXBvcnQgeyBSZXN1bHRDb250ZXh0RW50aXR5IH0gZnJvbSAnLi4vZW50aXR5L3Jlc3VsdGNvbnRleHQuZW50aXR5JztcclxuLy8gaW1wb3J0IHsgaXNOdWxsT3JFbXB0eVN0cmluZyB9IGZyb20gJ0Bwcm9ncmVzcy9rZW5kby1hbmd1bGFyLWdyaWQvZGlzdC9lczIwMTUvdXRpbHMnO1xyXG5cclxuQEluamVjdGFibGUoKVxyXG5leHBvcnQgY2xhc3MgQXVyZXN1bHRTZXJ2aWNlIHtcclxuICAgIGNvbnN0cnVjdG9yKFxyXG4gICAgICAgIHByaXZhdGUgcmVzdDogUmVzdGZ1bFNlcnZpY2UsXHJcbiAgICAgICAgcHJpdmF0ZSBzZXNzaW9uOiBSYWNDb21tb25VdGlsLFxyXG4gICAgKSB7IH1cclxuXHJcblxyXG5cclxuICAgIC8qKlxyXG4gICAgICog6I635Y+W5p2D6ZmQ6ZyA6KaB5YiG6YWN55qE5Lia5Yqh5pWw5o2u55qE5pWw5o2u5rqQXHJcbiAgICAgKi9cclxuICAgIGdldERhdGFTb3VyY2VCeUNvbnRleHQoYXV0aEZpZWxkOiBzdHJpbmcsIHJlc3VsdENvbnRleHQ6IFJlc3VsdENvbnRleHRFbnRpdHkpOiBPYnNlcnZhYmxlPGFueT4ge1xyXG4gICAgICAgIC8vIG1vY2vmlbDmja5cclxuICAgICAgICAvLyByZXR1cm4gb2YoZGF0YVNvdXJjZSk7dGhpcy5yZXN1bHRDb250ZXh0LmRpY3REaW1lbnNpb25WYWx1ZVxyXG4gICAgICAgIGNvbnN0IGhlYWRlcnMgPSB0aGlzLnNlc3Npb24uZ2V0SGVhZGVyKCk7XHJcbiAgICAgICAgY29uc3QgdXJsID0gdGhpcy5zZXNzaW9uLmdldFJlc3VsdFBhdGgoKTtcclxuICAgICAgICBjb25zdCB1cmxOZXcgPSB1cmwgKyAnL2RhdGFzb3VyY2UnO1xyXG4gICAgICAgIGxldCB5ZWFyID0gJyc7XHJcbiAgICAgICAgaWYgKCByZXN1bHRDb250ZXh0LnllYXJPYmogJiYgcmVzdWx0Q29udGV4dC55ZWFyT2JqLnZhbHVlICkge1xyXG4gICAgICAgICAgICB5ZWFyID0gcmVzdWx0Q29udGV4dC55ZWFyT2JqLnZhbHVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXN1bHRDb250ZXh0LnllYXIgPSB5ZWFyO1xyXG4gICAgICAgIGlmICggcmVzdWx0Q29udGV4dC5hdVZhclZhbHVlcyAmJiByZXN1bHRDb250ZXh0LmF1VmFyVmFsdWVzLmxlbmd0aCA+IDAgKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnJlc3QucG9zdCh1cmxOZXcgKyAnL3ZhcicsIHJlc3VsdENvbnRleHQsIG51bGwsIGhlYWRlcnMpO1xyXG4gICAgICAgfVxyXG4gICAgICAgIGNvbnN0IG93bmVySWQgPSByZXN1bHRDb250ZXh0Lm93bmVySWQ7XHJcbiAgICAgICAgY29uc3Qgb3duZXJUeXBlID0gcmVzdWx0Q29udGV4dC5vd25lclR5cGU7XHJcbiAgICAgICAgY29uc3QgcGFyYW0gPSB7XHJcbiAgICAgICAgICAgIG93bmVySWQ6IG93bmVySWQsXHJcbiAgICAgICAgICAgIG93bmVyVHlwZTogb3duZXJUeXBlLFxyXG4gICAgICAgICAgICBhdXRoZmllbGQ6IGF1dGhGaWVsZCxcclxuICAgICAgICAgICAgeWVhcjogeWVhcixcclxuICAgICAgICB9O1xyXG4gICAgICAgIHJldHVybiB0aGlzLnJlc3QuZ2V0KHVybE5ldywgcGFyYW0sIGhlYWRlcnMpO1xyXG4gICAgfVxyXG5cclxuXHJcbiAgICAvKipcclxuICAgICAqIOiOt+WPluadg+mZkOWPr+S7peWIhumFjeeahOS4muWKoeaVsOaNrueahOaVsOaNrua6kFxyXG4gICAgICovXHJcbiAgICBnZXREYXRhU291cmNlKGF1dGhGaWVsZDogc3RyaW5nKTogT2JzZXJ2YWJsZTxhbnk+IHtcclxuICAgICAgICBjb25zdCBvd25lcklkID0gdGhpcy5zZXNzaW9uLm93bmVySWQ7XHJcbiAgICAgICAgY29uc3Qgb3duZXJUeXBlID0gdGhpcy5zZXNzaW9uLm93bmVyVHlwZTtcclxuICAgICAgICBjb25zdCBhdXRoRGF0YVNvdXJjZSA9IG5ldyBBdXRoRGF0YVNvdXJjZSgpO1xyXG4gICAgICAgIGNvbnN0IGhlYWRlcnMgPSB0aGlzLnNlc3Npb24uZ2V0SGVhZGVyKCk7XHJcbiAgICAgICAgY29uc3QgdXJsID0gdGhpcy5zZXNzaW9uLmdldFJlc3VsdFBhdGgoKTtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBvd25lcklkICDmnYPpmZDmiYDmnInogIVJZCzmraTlpITnlKjmiLflj5flhajlsYDkuJrliqHnu4Tnu4fov4fmu6TnmoTvvIzmn6Xmib7lt7LliIbphY3nmoTkuJrliqHnu4Tnu4fkvb/nlKjvvIzov5nph4zkuI3pnIDopoFcclxuICAgICAgICAgKiBvd25lclR5cGUg5p2D6ZmQ5omA5pyJ6ICF57G75Z6LIOWyl+S9jTHvvIznlKjmiLcyXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgY29uc3QgcGFyYW0gPSB7XHJcbiAgICAgICAgICAgIG93bmVySWQ6ICcnLFxyXG4gICAgICAgICAgICBvd25lclR5cGU6IDIsXHJcbiAgICAgICAgICAgIGF1dGhmaWVsZDogYXV0aEZpZWxkLFxyXG4gICAgICAgICAgICB5ZWFyOiAnJ1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgY29uc3QgdXJsTmV3ID0gdXJsICsgJy9kYXRhc291cmNlJztcclxuICAgICAgICByZXR1cm4gdGhpcy5yZXN0LmdldCh1cmxOZXcsIHBhcmFtLCBoZWFkZXJzKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOiOt+WPluadg+mZkOWPr+S7peWIhumFjeeahOS4muWKoeaVsOaNrueahOaVsOaNrua6kFxyXG4gICAgICovXHJcbiAgICBnZXROb1VzZXJzRGF0YVNvdXJjZShhdXRoRmllbGQ6IHN0cmluZywgeWVhcjogc3RyaW5nICk6IE9ic2VydmFibGU8YW55PiB7XHJcbiAgICAgICAgY29uc3Qgb3duZXJJZCA9ICdub3VzZXInO1xyXG4gICAgICAgIGNvbnN0IG93bmVyVHlwZSA9IHRoaXMuc2Vzc2lvbi5vd25lclR5cGU7XHJcbiAgICAgICAgY29uc3QgYXV0aERhdGFTb3VyY2UgPSBuZXcgQXV0aERhdGFTb3VyY2UoKTtcclxuICAgICAgICBjb25zdCBoZWFkZXJzID0gdGhpcy5zZXNzaW9uLmdldEhlYWRlcigpO1xyXG4gICAgICAgIGNvbnN0IHVybCA9IHRoaXMuc2Vzc2lvbi5nZXRSZXN1bHRQYXRoKCk7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogb3duZXJJZCAg5p2D6ZmQ5omA5pyJ6ICFSWQs5q2k5aSE55So5oi35Y+X5YWo5bGA5Lia5Yqh57uE57uH6L+H5ruk55qE77yM5p+l5om+5bey5YiG6YWN55qE5Lia5Yqh57uE57uH5L2/55So77yM6L+Z6YeM5LiN6ZyA6KaBXHJcbiAgICAgICAgICogb3duZXJUeXBlIOadg+mZkOaJgOacieiAheexu+WeiyDlspfkvY0x77yM55So5oi3MlxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGNvbnN0IHBhcmFtID0ge1xyXG4gICAgICAgICAgICBvd25lcklkOiBvd25lcklkLFxyXG4gICAgICAgICAgICBvd25lclR5cGU6IDIsXHJcbiAgICAgICAgICAgIGF1dGhmaWVsZDogYXV0aEZpZWxkLFxyXG4gICAgICAgICAgICB5ZWFyOiB5ZWFyXHJcbiAgICAgICAgfTtcclxuICAgICAgICBjb25zdCB1cmxOZXcgPSB1cmwgKyAnL2RhdGFzb3VyY2UnO1xyXG4gICAgICAgIHJldHVybiB0aGlzLnJlc3QuZ2V0KHVybE5ldywgcGFyYW0sIGhlYWRlcnMpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog6I635Y+W5p2D6ZmQ6ZyA6KaB5YiG6YWN55qE5Lia5Yqh5pWw5o2u55qE5pWw5o2u5rqQXHJcbiAgICAgKi9cclxuICAgIGdldE5vVXNlcnNEYXRhU291cmNlQnlHcm91cChhdXRoRmllbGQ6IHN0cmluZywgeWVhcjogc3RyaW5nLCBhc3NpZDE6IHN0cmluZywgYXNzaWQyOiBzdHJpbmcpOiBPYnNlcnZhYmxlPGFueT4ge1xyXG4gICAgICAgIC8vIG1vY2vmlbDmja5cclxuICAgICAgICAvLyByZXR1cm4gb2YoZGF0YVNvdXJjZSk7XHJcbiAgICAgICAgY29uc3QgYXV0aERhdGFTb3VyY2UgPSBuZXcgQXV0aERhdGFTb3VyY2UoKTtcclxuICAgICAgICBjb25zdCBoZWFkZXJzID0gdGhpcy5zZXNzaW9uLmdldEhlYWRlcigpO1xyXG4gICAgICAgIGNvbnN0IHVybCA9IHRoaXMuc2Vzc2lvbi5nZXRSZXN1bHRQYXRoKCk7XHJcbiAgICAgICAgY29uc3QgcGFyYW0gPSB7XHJcbiAgICAgICAgICAgIG93bmVySWQ6ICdub3VzZXInLFxyXG4gICAgICAgICAgICBvd25lclR5cGU6IDIsXHJcbiAgICAgICAgICAgIGF1dGhmaWVsZDogYXV0aEZpZWxkLFxyXG4gICAgICAgICAgICB5ZWFyOiB5ZWFyLFxyXG4gICAgICAgICAgICBhc3NpZDE6IGFzc2lkMSxcclxuICAgICAgICAgICAgYXNzaWQyOiBhc3NpZDIsXHJcbiAgICAgICAgfTtcclxuICAgICAgICBjb25zdCB1cmxOZXcgPSB1cmwgKyAnL2RhdGFzb3VyY2UvZ3JvdXAnO1xyXG4gICAgICAgIHJldHVybiB0aGlzLnJlc3QuZ2V0KHVybE5ldywgcGFyYW0sIGhlYWRlcnMpO1xyXG4gICAgfVxyXG5cclxuXHJcbiAgICAvKipcclxuICAgICAqIOiOt+WPluW5tOW6plxyXG4gICAgICovXHJcbiAgICBnZXRZZWFycyhzdTogc3RyaW5nKTogT2JzZXJ2YWJsZTxhbnk+IHtcclxuICAgICAgICBjb25zdCBhdXRoRGF0YVNvdXJjZSA9IG5ldyBBdXRoRGF0YVNvdXJjZSgpO1xyXG4gICAgICAgIGNvbnN0IGhlYWRlcnMgPSB0aGlzLnNlc3Npb24uZ2V0SGVhZGVyKCk7XHJcbiAgICAgICAgY29uc3QgdXJsID0gdGhpcy5zZXNzaW9uLmdldFJlc3VsdFBhdGgoKTtcclxuICAgICAgICBpZiAoIXN1KSB7XHJcbiAgICAgICAgICAgIHN1ID0gJyonO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCB1cmxOZXcgPSB1cmwgKyAnL3llYXJzLycgKyBzdTtcclxuICAgICAgICByZXR1cm4gdGhpcy5yZXN0LmdldCh1cmxOZXcsIG51bGwsIGhlYWRlcnMpO1xyXG4gICAgfVxyXG5cclxufVxyXG5cclxuXHJcblxyXG4iXX0=