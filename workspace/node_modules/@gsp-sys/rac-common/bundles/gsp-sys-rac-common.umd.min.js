!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@ecp-caf/caf-common"),require("@angular/common"),require("@angular/common/http"),require("@progress/kendo-angular-grid"),require("@angular/forms"),require("@progress/kendo-angular-layout"),require("@progress/kendo-angular-treeview"),require("@progress/kendo-angular-buttons"),require("@farris/ui-modal"),require("@farris/ui-layout"),require("@farris/ui-lookup"),require("@farris/ui-panel"),require("@farris/ui-treetable"),require("@farris/ui-datatable"),require("@farris/ui-datagrid"),require("@farris/devkit"),require("rxjs/observable/of"),require("@farris/ui-notify"),require("@farris/ui-messager"),require("rxjs"),require("@ngx-translate/core"),require("@angular/core")):"function"==typeof define&&define.amd?define("@gsp-sys/rac-common",["exports","@ecp-caf/caf-common","@angular/common","@angular/common/http","@progress/kendo-angular-grid","@angular/forms","@progress/kendo-angular-layout","@progress/kendo-angular-treeview","@progress/kendo-angular-buttons","@farris/ui-modal","@farris/ui-layout","@farris/ui-lookup","@farris/ui-panel","@farris/ui-treetable","@farris/ui-datatable","@farris/ui-datagrid","@farris/devkit","rxjs/observable/of","@farris/ui-notify","@farris/ui-messager","rxjs","@ngx-translate/core","@angular/core"],t):t((e["gsp-sys"]=e["gsp-sys"]||{},e["gsp-sys"]["rac-common"]={}),e.cafCommon,e.ng.common,e.ng.common.http,e.kendoAngularGrid,e.ng.forms,e.kendoAngularLayout,e.kendoAngularTreeview,e.kendoAngularButtons,e.uiModal,e.uiLayout,e.uiLookup,e.uiPanel,e.uiTreetable,e.uiDatatable,e.uiDatagrid,e.devkit,e.rxjs["observable/of"],e.uiNotify,e.uiMessager,e.rxjs,e.core,e.ng.core)}(this,function(e,t,i,s,r,n,a,o,l,c,h,d,u,p,f,y,g,m,v,k,S,b,A){"use strict";var I=function oe(){},T=function le(){},C=function ce(){},D=function he(){},K=function de(){},w=function ue(){},x=function pe(){},O={None:0,DataRow:1,Column:2,Rule:3};O[O.None]="None",O[O.DataRow]="DataRow",O[O.Column]="Column",O[O.Rule]="Rule";var E=function fe(){},M=function ye(){},P=function ge(){},N=function me(){},F={Undefined:0,Parent:1,Path:2,ParentAndPath:3};F[F.Undefined]="Undefined",F[F.Parent]="Parent",F[F.Path]="Path",F[F.ParentAndPath]="ParentAndPath";var j=function ve(){},R={Undefined:0,None:1,ReadOnly:2,Full:3};R[R.Undefined]="Undefined",R[R.None]="None",R[R.ReadOnly]="ReadOnly",R[R.Full]="Full";var B=function ke(){},L=function Se(){},H=function be(){},U=function Ae(){},q={True:1,Common:2};q[q.True]="True",q[q.Common]="Common";var z=function Ie(){this.inheritPermission=!1,this.assid1="",this.assid2="",this.auVarValues=[]},G=function Te(){},V=function(){function e(e){this.sessionSv=e,this.assid1="",this.assid2="",this.AUDATACONTROL="AuDataControl",this.expandIcon="f-icon f-icon-file-folder-open text-warning",this.collapseIcon="f-icon f-icon-file-folder-close text-warning",this.leafIcon="f-icon f-icon-file-txt text-warning"}return e.prototype.getHeader=function(){var e=this.sessionSv.getCurrentSeesionId();return{headers:(new s.HttpHeaders).set("SessionId",e)}},e.prototype.getCurrentUserId=function(){return"admin"},e.prototype.getGuid36=function(){function e(){return(65536*(1+Math.random())|0).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()},e.prototype.getResultPath=function(){return"/api/runtime/sys/v1.0/assignresults"},e.prototype.getAuthorizationPath=function(){return"/api/runtime/sys/v1.0/authorizations"},e.prototype.getAuthfieldPath=function(){return"/api/runtime/sys/v1.0/authfields"},e.prototype.getReAssignPath=function(){return"/api/runtime/sys/v1.0/reassigns"},e.prototype.getAddIds=function(e,t){var i=[];return e.forEach(function(e){t.includes(e)||i.push(e)}),i},e.prototype.getRemoveIds=function(e,t){return this.getAddIds(t,e)},e.prototype.convertToBizDataDTO=function(e){return e.map(function(e){var t=new E;return t.data=e,t})},e.prototype.isNullOrEmptyString=function(e){return this.isBlank(e)||0===e.toString().trim().length},e.prototype.isBlank=function(e){return null===e||e===undefined},e.prototype.isNotNullOrEmptyString=function(e){return!this.isNullOrEmptyString(e)},e.prototype.findLayer1ByParentId=function(e,i,s){var r=[];return e.forEach(function(t){e.find(function(e){return e[i]===t[s]})||t.type===undefined||null===t.type||"99"!==t.type.toString()||(t.parentId=undefined,r.push(t))}),r},e.prototype.isNav=function(e){return"99"===e||"0"===e},e.prototype.setTreeIcon=function(e){e.expandIcon=this.expandIcon,e.collapseIcon=this.collapseIcon,e.leafIcon=this.leafIcon,e.detectChanges()},e.decorators=[{type:A.Injectable}],e.ctorParameters=function(){return[{type:t.SessionService}]},e}(),$=function(){function e(e){this.util=e}return e.prototype.makeTreeByPath=function(i,s){var r=this,e=i.filter(function(t){if(r.util.isNullOrEmptyString(t[s]))return!0;var e=i.find(function(e){return e[s]===t[s].substring(0,t[s].length-4)});return e===undefined||null===e||void 0}),n=[];return e.forEach(function(e){var t={};t.data=e,t.children=[],n.push(t)}),n.forEach(function(e){r.findChildrenByPath(e,i,s)}),n},e.prototype.findChildrenByPath=function(i,s,r){var n=this,e=s.filter(function(e){if(e[r].substring(0,e[r].length-4)===i.data[r])return!0});e&&0<e.length&&e.forEach(function(e){var t={};t.data=e,t.children=[],i.children.push(t),n.findChildrenByPath(t,s,r)})},e.prototype.makeTreeByParent=function(i,s,r){var n=this,e=i.filter(function(t){return!!n.util.isNullOrEmptyString(t[s])||(!i.find(function(e){return e[r]===t[s]})||void 0)}),a=[];return e.forEach(function(e){var t={};t.data=e,t.children=[],a.push(t)}),a.forEach(function(e){n.findChildrenByParent(e,i,s,r)}),a},e.prototype.findChildrenByParent=function(i,s,r,n){var a=this,e=s.filter(function(e){if(e[r]===i.data[n])return!0});e&&0<e.length&&e.forEach(function(e){var t={};t.data=e,t.children=[],i.children.push(t),a.findChildrenByParent(t,s,r,n)})},e.decorators=[{type:A.Injectable}],e.ctorParameters=function(){return[{type:V}]},e}(),_=function(){function e(e,t,i){this.rest=e,this.util=t,this.msgService=i}return e.prototype.getAll=function(){var e=this.util.getHeader(),t=this.util.getReAssignPath()+"";return this.rest.get(t,null,e)},e.decorators=[{type:A.Injectable}],e.ctorParameters=function(){return[{type:g.RestfulService},{type:V},{type:k.MessagerService}]},e}(),Z=function(){function e(e,t){this.rest=e,this.session=t}return e.prototype.getDataSourceByContext=function(e,t){var i=this.session.getHeader(),s=this.session.getResultPath()+"/datasource",r="";if(t.yearObj&&t.yearObj.value&&(r=t.yearObj.value),t.year=r,t.auVarValues&&0<t.auVarValues.length)return this.rest.post(s+"/var",t,null,i);var n={ownerId:t.ownerId,ownerType:t.ownerType,authfield:e,year:r};return this.rest.get(s,n,i)},e.prototype.getDataSource=function(e){this.session.ownerId,this.session.ownerType;var t=this.session.getHeader(),i={ownerId:"",ownerType:2,authfield:e,year:""},s=this.session.getResultPath()+"/datasource";return this.rest.get(s,i,t)},e.prototype.getNoUsersDataSource=function(e,t){this.session.ownerType;var i=this.session.getHeader(),s={ownerId:"nouser",ownerType:2,authfield:e,year:t},r=this.session.getResultPath()+"/datasource";return this.rest.get(r,s,i)},e.prototype.getNoUsersDataSourceByGroup=function(e,t,i,s){var r=this.session.getHeader(),n={ownerId:"nouser",ownerType:2,authfield:e,year:t,assid1:i,assid2:s},a=this.session.getResultPath()+"/datasource/group";return this.rest.get(a,n,r)},e.prototype.getYears=function(e){var t=this.session.getHeader();e||(e="*");var i=this.session.getResultPath()+"/years/"+e;return this.rest.get(i,null,t)},e.decorators=[{type:A.Injectable}],e.ctorParameters=function(){return[{type:g.RestfulService},{type:V}]},e}(),X=function(){function e(e,t,i){this.rest=e,this.util=t,this.msgService=i}return e.prototype.getbyId=function(e){var t=this.util.getHeader(),i=this.util.getAuthfieldPath()+"/"+e;return this.rest.get(i,null,t)},e.prototype.handlerError=function(e){console.log(e),this.msgService.error(e.error.Message)},e.prototype.handleError=function(e,t){return void 0===e&&(e="operation"),function(e){return console.error(e),m.of(t)}},e.decorators=[{type:A.Injectable}],e.ctorParameters=function(){return[{type:g.RestfulService},{type:V},{type:k.MessagerService}]},e}(),Y=[20,50,100,200],J=function(){function e(e,t,i){this.rest=e,this.util=t,this.msgService=i}return e.prototype.getAuthEntryByOp=function(e,t){var i=this.util.getAuthorizationPath()+"/"+e+"/"+t,s=this.util.getHeader();return this.rest.get(i,null,s)},e.prototype.getAll=function(){var e=this.util.getHeader(),t=this.util.getAuthorizationPath()+"/designtime";return this.rest.get(t,null,e)},e.prototype.getAllReAssign=function(){var e=this.util.getHeader(),t=this.util.getAuthorizationPath()+"/reassign";return this.rest.get(t,null,e)},e.prototype.handlerError=function(e){console.log(e),this.msgService.error(e.error.Message)},e.prototype.handleError=function(e,t){return void 0===e&&(e="operation"),function(e){return console.error(e),m.of(t)}},e.decorators=[{type:A.Injectable}],e.ctorParameters=function(){return[{type:g.RestfulService},{type:V},{type:k.MessagerService}]},e}(),Q=function(){function e(){this.mapAuresults=new Map,this.mapDataSource=new Map}return e.decorators=[{type:A.Injectable}],e.ctorParameters=function(){return[]},e}(),W=function(){function e(e,t,i,s){this.session=e,this.msgService=t,this.notifyService=i,this.treeService=s,this.closeModalEmitter=new A.EventEmitter,this.selectEmitter=new A.EventEmitter,this.selectedModels=[],this.hasSelectKeys=[],this.isHasSelectAll=!1,this.authField="",this.ownerId="",this.canAssignDatas=[],this.isDisplayTree=!1,this.isShowSearch=!1,this.isSelectAll=!1,this.selectKeys=[],this.singleSelect=!1,this.treeHeight="342px",this.isAuGroup=!0,this.selectByGroupEmitter=new A.EventEmitter,this.dataKey="",this.helpFields=[],this.showFields=[],this.codeOrNameFields=[],this.authDataSource=new P,this.isEnable=!0,this.isAllAuth=!1,this.skip=0,this.pageSize=20,this.pageIndex=1,this.treedata=[],this.flatData=[],this.root="",this.saveSelections=[],this.treeCols=[],this.loadDataType="all",this.cascadeCheck=!1,this.cascadeUp=!1,this.cascadeDown=!0,this.isTreeLoaded=!1,this.searchInfo="",this.searchDatas=[],this.searchTitle="查找",this.oldTreeSearch="",this.treeSearchIndex=0,this.pageSetting={buttonCount:0,info:!0,pageSizes:Y,previousNext:!0}}return e.prototype.ngOnInit=function(){},e.prototype.getAuthDataSource=function(){if(this.isSelectAll=!1,this.session.ownerId=this.ownerId,this.session.ownerType=2,this.selectKeys=[],this.treeCols=[],this.treedata=[],this.cascadeCheck=!1,this.session.isNullOrEmptyString(this.authField))return this.canAssignDatas=[],void(this.isSelectAll=!1)},e.prototype.displayData=function(){var t=this;if(this.selectKeys=[],this.treeCols=[],this.treedata=[],this.cascadeCheck=!1,this.session.isNullOrEmptyString(this.authField))return this.canAssignDatas=[],void(this.isSelectAll=!1);this.showElement("checkall"),this.isSelectAll=!1,this.authDataSource.data=this.data.data,this.authDataSource.showFields=this.data.showFields,this.authDataSource.keyField=this.data.keyField,this.authDataSource.helpFields=this.data.helpFields,this.authDataSource.hierarchicalType=this.data.hierarchicalType,this.authDataSource.hierarchicalInfo=this.data.hierarchicalInfo,this.canAssignDatas=this.authDataSource.data,this.searchDatas=this.canAssignDatas,this.dataKey=this.authDataSource.keyField,this.helpFields=this.authDataSource.helpFields,this.showFields=this.authDataSource.showFields,this.codeOrNameFields=this.getCodeOrNameFields(),this.hasSelectKeys.find(function(e){return"*"===e})&&(this.isSelectAll=this.isHasSelectAll=!0),this.isAllAuth&&(this.isSelectAll=this.isHasSelectAll=!0),this.isSelectAll?this.canAssignDatas.forEach(function(e){t.selectKeys.push(e[t.dataKey])}):this.hasSelectKeys&&this.hasSelectKeys.forEach(function(e){t.selectKeys.push(e)}),!1!==this.isDisplayTree?this.showTreeInfo():this.queryByPage()},e.prototype.showTreeInfo=function(){var t=this;this.hideElement("checkall"),this.authDataSource.showFields.forEach(function(e){t.treeCols.push({field:e.field,title:e.title,width:100})});var e=this.authDataSource.hierarchicalType,i=this.authDataSource.hierarchicalInfo;if(e===F.Parent){var s=this.dataKey;i.parentKeyField&&0<i.parentKeyField.length&&(s=i.parentKeyField),this.treedata=this.treeService.makeTreeByParent(this.canAssignDatas,i.parentField,s)}else this.treedata=this.treeService.makeTreeByPath(this.canAssignDatas,i.pathField);this.farrisTree.cascadeCheck=!1,this.isTreeLoaded=!1,this.farrisTree.loadedData.subscribe(function(e){!0!==t.isTreeLoaded&&(t.farrisTree.cascadeCheck=!1,t.root&&""!==t.root&&t.farrisTree.expandNode(t.root),t.isSelectAll?t.farrisTree.checkAllNodes():0<t.hasSelectKeys.length&&t.farrisTree.checkedNodes(t.hasSelectKeys),t.farrisTree.cascadeCheck=!0,t.isTreeLoaded=!0)})},e.prototype.handleError=function(e){this.authDataSource.data=[],console.log(e),console.log(e.error.Message),this.msgService.error(e.error.Message)},Object.defineProperty(e.prototype,"selectableSettings",{get:function(){return{checkboxOnly:!0,mode:this.singleSelect?"single":"multiple",enabled:!0}},enumerable:!0,configurable:!0}),e.prototype.iconClass=function(e){e.type;return{"k-i-folder":!0,"k-icon":!0}},e.prototype.getSelectInfo=function(){var i=this;this.selectedModels=[];var e={data:[],selectedKey:[]};if(this.isSelectAll&&this.isIntegrityData&&this.data.length===this.selectKeys){return this.selectedModels.push({data:"*"}),e.data=["*"],e.selectedKey=["*"],e}if(this.isDisplayTree)if(this.farrisTree.checkeds){var t=this.farrisTree.checkeds.map(function(e){return e.data});this.selectKeys=t.map(function(e){return e[i.dataKey]})}else this.selectKeys=[];return 0<this.selectKeys.length&&this.selectKeys.map(function(t){var e=i.canAssignDatas.find(function(e){return e[i.dataKey]===t});i.selectedModels.push(e)}),e.data=this.selectedModels,e.selectedKey=this.selectKeys,e},e.prototype.getIsAllAuth=function(){return this.isSelectAll&&this.isIntegrityData&&this.data.length===this.selectKeys},e.prototype.confirm=function(){var i=this;if(this.closeModalEmitter.next(),this.selectedModels=[],this.getIsAllAuth()){return this.selectedModels.push({data:"*"}),void this.selectEmitter.next({data:["*"],selectedKey:["*"]})}if(this.isDisplayTree)if(this.farrisTree.checkeds){var e=this.farrisTree.checkeds.map(function(e){return e.data});this.selectKeys=e.map(function(e){return e[i.dataKey]})}else this.selectKeys=[];0<this.selectKeys.length&&this.selectKeys.map(function(t){var e=i.canAssignDatas.find(function(e){return e[i.dataKey]===t});i.selectedModels.push(e)}),this.selectEmitter.next({data:this.selectedModels,selectedKey:this.selectKeys})},e.prototype.cancle=function(){this.closeModalEmitter.next()},e.prototype.checkAllClick=function(){var i=this;this.isSelectAll=!this.isSelectAll;var s="";this.isSelectAll?(this.searchDatas.forEach(function(e){s=e[i.dataKey],i.selectKeys.findIndex(function(e){return e===s})<0&&i.selectKeys.push(s)}),this.isDisplayTree&&this.farrisTree&&this.farrisTree.checkAllNodes()):this.isDisplayTree?this.farrisTree&&this.farrisTree.unCheckAllNodes():this.searchDatas.forEach(function(e){s=e[i.dataKey];var t=i.selectKeys.findIndex(function(e){return e===s});-1<t&&i.selectKeys.splice(t,1)})},e.prototype.checkClick=function(){var t=this;this.isSelectAll=!this.isSelectAll,this.isSelectAll?(this.canAssignDatas.forEach(function(e){t.selectKeys.push(e[t.dataKey])}),this.farrisTree.checkAllNodes(),this.selectByGroupEmitter.next(["*"])):(this.selectKeys=[],this.selectByGroupEmitter.next([]))},e.prototype.onSelectedKeysChange=function(e){this.selectKeys.length!==this.canAssignDatas.length&&(this.isSelectAll=!1),this.isSelectAll?this.selectByGroupEmitter.next(["*"]):this.selectByGroupEmitter.next(this.selectKeys)},e.prototype.pageChange=function(e){this.skip=e.skip,this.pageSize=e.take,this.pageIndex=this.skip/this.pageSize+1,this.queryByPage()},e.prototype.queryByPage=function(){this.gridView={data:this.searchDatas.slice(this.skip,this.skip+this.pageSize),total:this.searchDatas.length}},e.prototype.searchClick=function(){this.search(this.searchInfo)},e.prototype.search=function(e){var i=this;if(this.isDisplayTree)this.searchTree(e);else{if(this.searchInfo=e,this.session.isNullOrEmptyString(this.searchInfo))return this.searchDatas=this.canAssignDatas,void this.queryByPage();this.searchDatas=[],this.canAssignDatas.forEach(function(e){for(var t=0;t<i.showFields.length;t++)if(-1<e[i.showFields[t].field].toString().indexOf(i.searchInfo)){i.searchDatas.push(e);break}}),this.queryByPage()}},e.prototype.getCodeOrNameFields=function(){var t=[];return this.showFields.forEach(function(e){(-1<e.field.toLocaleLowerCase().indexOf("code")||-1<e.field.toLocaleLowerCase().indexOf("name"))&&t.push(e)}),0===t.length&&t.push(this.showFields[0]),t},e.prototype.searchTreeSelf=function(e){this.searchTree(e.value)},e.prototype.searchTree=function(i){var s=this;if(i)if(this.farrisTree.clearSelections(),this.oldTreeSearch!==i&&(this.searchDatas=[],this.canAssignDatas.forEach(function(e){for(var t=0;t<s.codeOrNameFields.length;t++){if(-1<e[s.codeOrNameFields[t].field].indexOf(i)){s.searchDatas.push(e);break}}}),this.treeSearchIndex=0),0!==this.searchDatas.length){var e=this.searchDatas[this.treeSearchIndex][this.dataKey];this.farrisTree.selectNode(e),this.farrisTree.collapseAll(),this.expandParent(e),this.oldTreeSearch=i,this.treeSearchIndex=this.treeSearchIndex+1,this.treeSearchIndex===this.searchDatas.length&&(this.oldTreeSearch="",this.treeSearchIndex=0)}else this.msgService.warning("没有满足条件的数据!");else this.treeSearchIndex=0},e.prototype.expandParent=function(e){var t=this.farrisTree.findRowNode(e).parent;if(t)for(;t;)this.farrisTree.expandNode(t.id),t=t.parent;else this.farrisTree.expandNode(e)},e.prototype.treeCheckAll=function(){this.isSelectAll=!0},e.prototype.treeUnCheckAll=function(){this.isSelectAll=!1},e.prototype.nodeUnChecked=function(){this.isSelectAll&&(this.isSelectAll=!1)},e.prototype.showElement=function(e){document.getElementById(e)&&(document.getElementById(e).style.display="")},e.prototype.hideElement=function(e){document.getElementById(e)&&(document.getElementById(e).style.display="none")},e.decorators=[{type:A.Component,args:[{selector:"rac-data-help",template:'\r\n\r\n<div *ngIf="!isDisplayTree" class="f-page flex-column" style="background-color:#ffffff;">\r\n    \x3c!-- 条件搜索(click)="" --\x3e\r\n    <div *ngIf="isShowSearch" class="mt-1 form-group row ml-1">\r\n            <div pr-2 text-left class="col-xs-3">\r\n                        <input id="checkAllData" class="k-checkbox" type="checkbox" name="sysinit" [checked]="isSelectAll"\r\n                            [readOnly]="!isEnable" [disabled]="!isEnable" (click)="checkAllClick()" />\r\n                        <label class="ml-2 k-checkbox-label" for="checkAllData">全选</label>\r\n             </div>\r\n            <label class="ml-2">查找：</label>\r\n            <input type="text" name="searchInfo" [(ngModel)]="searchInfo" style="width: 200px;" />\r\n            <button kendoButton [icon]="\'search\'" (click)="searchClick()"></button>\r\n    </div>\r\n    <div class="f-utils-fill-auto">\r\n        <kendo-grid #dataGrid [class]="\'flex-fill\'" [selectable]="selectableSettings"\r\n            [kendoGridSelectBy]="authDataSource.keyField" [selectedKeys]="selectKeys" [data]="gridView" [height]="360"\r\n            (selectedKeysChange)="onSelectedKeysChange($event)" [skip]="skip" [pageable]="pageSetting"\r\n            [pageSize]="pageSize" (pageChange)="pageChange($event)">\r\n            <kendo-grid-checkbox-column title="选择" width="60px"\r\n          ></kendo-grid-checkbox-column>\r\n            <ng-template ngFor [ngForOf]="showFields" let-column>\r\n                <kendo-grid-column field="{{column.field}}" title="{{column.title}}">\r\n                </kendo-grid-column>\r\n            </ng-template>\r\n        </kendo-grid>\r\n    </div>\r\n</div>\r\n\r\n<div *ngIf="isDisplayTree" class="f-page flex-column" style="background-color:#ffffff;">\r\n    <div *ngIf="isShowSearch" class="mt-1 form-group row ml-1">\r\n        <div *ngIf="!singleSelect" id="treehead" class="k-form-field">\r\n            <input id="cascadeDown" class="k-checkbox" type="checkbox" name="cascadeDown" [checked]="cascadeDown"\r\n                [(ngModel)]="cascadeDown" />\r\n            <label class="k-checkbox-label" for="cascadeDown">同步下级</label>\r\n        </div>\r\n        <div pr-2 text-left class="col-xs-3">\r\n                <input id="checkAllDataTree" class="k-checkbox" type="checkbox" name="sysinit" [checked]="isSelectAll"\r\n                    [readOnly]="!isEnable" [disabled]="!isEnable" (click)="checkAllClick()" />\r\n                <label class="ml-2 k-checkbox-label" for="checkAllDataTree">全选</label>\r\n        </div>\r\n    </div>\r\n    <div id="treebody" class="f-struct-wrapper f-utils-fill-flex-column"  [style.height]="treeHeight">\r\n    <farris-treetable #farrisTree class="f-utils-fill-flex-column" [data]="this.treedata" [columns]="treeCols" [idField]="dataKey"\r\n    [showCheckAll]="true"\r\n    [fit]="true"\r\n    [fixedHeader]="true"\r\n    [enableFindText]="true"\r\n    [singleSelect]="singleSelect" \r\n    [resizableColumns]="true" \r\n    [showIcon]="true"\r\n    [selectOnCheck]="false"\r\n    (onlySelectSelf)="true" \r\n    [(cascadeDown)]="this.cascadeDown"\r\n    [(cascadeUp)]="this.cascadeUp"\r\n    [keepSelect]="false" \r\n    [showCheckbox]="true" \r\n    [(loadDataType)]="this.loadDataType" \r\n    (checkAll)="treeCheckAll()" \r\n    (unCheckAll)="treeUnCheckAll()"\r\n    (nodeUnChecked)="nodeUnChecked()"\r\n    [(showFilterBar)] = "isShowSearch"\r\n    (search) = "searchTreeSelf($event)"\r\n    [allColumnsTitle] = "searchTitle">\r\n     </farris-treetable>\r\n    </div>\r\n</div>\r\n\x3c!--全选不在这里\r\n  <div id="checkall" >\r\n    <div pr-2 text-left class="col-xs-3">\r\n      <input id="checkAllData" class="k-checkbox" type="checkbox" name="sysinit" [checked]="isSelectAll"\r\n        [readOnly]="!isEnable" [disabled]="!isEnable" (click)="checkClick()" />\r\n      <label class="k-checkbox-label" for="checkAllData">{{ \'chkCheckAll\' | translate }}</label>\r\n    </div>\r\n  </div>\r\n--\x3e',styles:[""]}]}],e.ctorParameters=function(){return[{type:V},{type:k.MessagerService},{type:v.NotifyService},{type:$}]},e.propDecorators={btnOkAndCancleRef:[{type:A.ViewChild,args:["btnOkAndCancle"]}],farrisTree:[{type:A.ViewChild,args:["farrisTree"]}],selectEmitter:[{type:A.Output}],hasSelectKeys:[{type:A.Input}],isHasSelectAll:[{type:A.Input}],authField:[{type:A.Input}],ownerId:[{type:A.Input}],canAssignDatas:[{type:A.Input}],data:[{type:A.Input}],isIntegrityData:[{type:A.Input}],isDisplayTree:[{type:A.Input}],isShowSearch:[{type:A.Input}],singleSelect:[{type:A.Input}],treeHeight:[{type:A.Input}]},e}(),ee=function(){function e(){this.displayText="",this.selectedKeyOld="",this.selectedChanged=new A.EventEmitter}return e.prototype.ngOnInit=function(){this.curKeyIdList=[],this.curKeyIdList.push(this.curKeyId)},e.prototype.afterKeySelected=function(e){var t=this;this.curAuthObj=new D,this.curKeyIdList=[],S.from(e).subscribe(function(e){t.curAuthObj.id=e.id,t.curAuthObj.name=e.name,t.curKeyId=e.id,t.curKeyIdList.push(e.id),t.displayText=e.name,t.selectedChanged.emit(t.curAuthObj)}),this.auobjLookup.closeDialog()},e.prototype.handleSelection=function(e){this.curKeyId=e.node.data.id,this.curAuthObj=e.node.data,""===this.curKeyId?(this.selectedKeyOld=this.curKeyId,this.selectedChanged.emit(this.curAuthObj)):this.selectedKeyOld!==this.curKeyId&&(this.selectedKeyOld=this.curKeyId,this.selectedChanged.emit(this.curAuthObj))},e.decorators=[{type:A.Component,args:[{selector:"rac-auobj-help",template:'<farris-lookup #auobjLookup [displayText]="displayText"  name="auobjLookup"\r\n[showButtons]="true" [title]="\'请选择权限对象\'" [buttonsRef]="this.auobjHelp.btnOkAndCancleRef">\r\n  <div style="padding: 10px">\r\n    <rac-auobj-tree #auobjHelp [initSelectedKeys]="this.curKeyIdList" [dataMode] = \'dataMode\'\r\n      (selectedAfterOk)="afterKeySelected($event)" (closeModalEmitter)="this.auobjLookup.closeDialog()">\r\n    </rac-auobj-tree>\r\n  </div>\r\n</farris-lookup>\r\n',styles:[""]}]}],e.ctorParameters=function(){return[]},e.propDecorators={dataMode:[{type:A.Input}],displayText:[{type:A.Input}],curKeyId:[{type:A.Input}],auobjLookup:[{type:A.ViewChild,args:["auobjLookup"]}],selectedChanged:[{type:A.Output}]},e}(),te=function(){function e(e,t,i){this.service=e,this.racUtil=t,this.translate=i,this.data=[],this.selectedKey="",this.selectedKeyOld="",this.cols=[],this.selectedchanged=new A.EventEmitter,this.selectedAfterOk=new A.EventEmitter,this.closeModalEmitter=new A.EventEmitter}return e.prototype.ngOnInit=function(){this.cols=[{field:"name",title:"名称"}]},e.prototype.initData=function(){var s=this;this.service.getAll();("reassign"===this.dataMode?this.service.getAllReAssign():this.service.getAll()).subscribe(function(e){if(s.data=e,s.data){var i=[];s.racUtil.findLayer1ByParentId(s.data,"id","parentId").forEach(function(e){var t=s.convertToTreeNode(e);i.push(t),s.initTreeNodeList(t)}),s.treeNodeData=i,s.racUtil.setTreeIcon(s.farrisTt)}})},e.prototype.initTreeNodeList=function(i){var s=this,e=this.data.filter(function(e){return e.parentId===i.data.id});e&&0<e.length&&e.forEach(function(e){var t=s.convertToTreeNode(e);i.leaf=!1,i.children.push(t),s.initTreeNodeList(t)})},e.prototype.convertToTreeNode=function(e){var t={data:e,leaf:!0,children:[],icon:this.racUtil.leafIcon};return this.racUtil.isNav(e.type.toString())&&(t.leaf=!1,t.children=[],t.expandedIcon=this.racUtil.expandIcon,t.collapseIcon=this.racUtil.collapseIcon),t},e.prototype.appendNode=function(e){this.farrisTt.findRowNode(e.parentId);var t=this.farrisTt.selectedRow;this.racUtil.isNav(t.data.type)?this.farrisTt.append(e,this.farrisTt.selectedRow):this.farrisTt.append(e,this.farrisTt.selectedRow.parent),this.farrisTt.selectNode(e.id)},e.prototype.removeNode=function(e){this.farrisTt.remove(e.id)},e.prototype.updateNode=function(e){},e.prototype.handleSelection=function(e){this.selectedKey=e.node.data.id,this.selectedModel=e.node.data,""===this.selectedKeyOld?(this.selectedKeyOld=this.selectedKey,this.selectedchanged.emit(this.selectedModel)):this.selectedKeyOld!==this.selectedKey&&(this.selectedKeyOld=this.selectedKey,this.selectedchanged.emit(this.selectedModel))},e.prototype.iconClass=function(e){e.id;return{"k-i-folder":!0,"k-icon":!0}},e.prototype.confirm=function(){this.selectedKeyOld=this.selectedKey,this.selectedAfterOk.emit(this.selectedModel)},e.prototype.cancle=function(){this.closeModalEmitter.next()},e.decorators=[{type:A.Component,args:[{selector:"rac-auobj-tree",template:'<farris-treetable class ="f-utils-fill-flex-column"  #farrisTt  \r\n[data]="treeNodeData"\r\n[columns]="cols"\r\n[idField]="\'id\'" \r\n[fixedHeader]="true"\r\n[fit]="true"\r\n[showIcon]="true"\r\n(nodeSelected)="handleSelection($event)">\r\n</farris-treetable>\r\n\r\n<ng-template #btnOkAndCancle >\r\n    <button class="btn btn-sm btn-primary" (click)="confirm()">确认</button>\r\n    <button class="btn btn-sm btn-default" (click)="cancle()">取消</button>\r\n  </ng-template>\r\n\r\n',styles:[""]}]}],e.ctorParameters=function(){return[{type:J},{type:V},{type:b.TranslateService}]},e.propDecorators={dataMode:[{type:A.Input}],initSelectedKeys:[{type:A.Input}],farrisTt:[{type:A.ViewChild,args:["farrisTt"]}],selectedchanged:[{type:A.Output}],selectedAfterOk:[{type:A.Output}],closeModalEmitter:[{type:A.Output}],btnOkAndCancleRef:[{type:A.ViewChild,args:["btnOkAndCancle"]}]},e}(),ie=function(){function e(){}return e.prototype.ngOnInit=function(){},e.decorators=[{type:A.Component,args:[{selector:"rac-authfield-help",template:"<p>\r\n  authfield-help works!\r\n</p>\r\n",styles:[""]}]}],e.ctorParameters=function(){return[]},e}(),se=function(){function e(){}return e.prototype.ngOnInit=function(){},e.decorators=[{type:A.Component,args:[{selector:"rac-authfield-tree",template:"<p>\r\n  authfield-tree works!\r\n</p>\r\n",styles:[""]}]}],e.ctorParameters=function(){return[]},e}(),re=function(){function e(e){this.reAssignService=e,this.selectedKey="",this.selectedKeyOld="",this.selectedChanged=new A.EventEmitter,this.selectedAfterOk=new A.EventEmitter,this.closeModalEmitter=new A.EventEmitter}return e.prototype.ngOnInit=function(){this.columns=[{field:"authorizationCode",title:"权限对象编号",width:"0"},{field:"authorizationName",title:"权限对象名称",width:"200"},{field:"authfieldCode",title:"权限字段编号",width:"0"},{field:"authfieldName",title:"权限字段名称"}]},e.prototype.initData=function(){var t=this;this.reAssignService.getAll().subscribe(function(e){t.datas=e})},e.prototype.ngOnChanges=function(e){(!this.datas||this.datas.length<=0)&&this.initData()},e.prototype.handleSelection=function(e){this.selectedModel=e.data,this.selectedModel?(this.selectedKey=this.selectedModel.id,""===this.selectedKeyOld?(this.selectedKeyOld=this.selectedKey,this.selectedChanged.emit(this.selectedModel)):this.selectedKeyOld!==this.selectedKey&&(this.selectedKeyOld=this.selectedKey,this.selectedChanged.emit(this.selectedModel))):this.selectedKey=""},e.prototype.iconClass=function(e){e.id;return{"k-i-folder":!0,"k-icon":!0}},e.prototype.confirm=function(){this.selectedKeyOld=this.selectedKey,this.selectedAfterOk.emit(this.selectedModel)},e.prototype.cancle=function(){this.closeModalEmitter.next()},e.decorators=[{type:A.Component,args:[{selector:"rac-reassign-grid",template:'\r\n<div class="f-utils-flex-column" style="height:450px;">\r\n    <farris-datagrid   #farrisGrid  class="f-utils-flex-column f-utils-fill" [columns]="columns" [data]="datas" [showBorder]="false"\r\n        [idField]="\'id\'"\r\n        [showLineNumber]="true" [fitColumns]="true" [fit]="true" [striped]="true" \r\n        (selectChanged)="handleSelection($event)">\r\n    </farris-datagrid>\r\n</div>\r\n\r\n<ng-template #btnOkAndCancle >\r\n      <button class="btn btn-sm btn-primary" (click)="confirm()">确认</button>\r\n      <button class="btn btn-sm btn-default" (click)="cancle()">取消</button>\r\n</ng-template>',styles:[""]}]}],e.ctorParameters=function(){return[{type:_}]},e.propDecorators={datas:[{type:A.Input}],selectedChanged:[{type:A.Output}],selectedAfterOk:[{type:A.Output}],closeModalEmitter:[{type:A.Output}],btnOkAndCancleRef:[{type:A.ViewChild,args:["btnOkAndCancle"]}]},e}(),ne=function(){function e(){this.displayText="",this.selectedKeyOld="",this.selectedChanged=new A.EventEmitter}return e.prototype.ngOnInit=function(){},e.prototype.afterKeySelected=function(e){this.curObj=new K,this.curKeyIdList=[],this.curObj.id=e.id,this.curObj.authorizationCode=e.authorizationCode,this.curObj.authorizationName=e.authorizationName,this.curObj.authfieldCode=e.authfieldCode,this.curObj.authfieldName=e.authfieldName,this.displayText=e.authorizationName+" "+e.authfieldName,this.selectedChanged.emit(this.curObj),this.reassignLookup.closeDialog()},e.prototype.handleSelection=function(e){this.curKeyId=e.node.data.id,this.curObj=e.node.data,""===this.curKeyId?(this.selectedKeyOld=this.curKeyId,this.selectedChanged.emit(this.curObj)):this.selectedKeyOld!==this.curKeyId&&(this.selectedKeyOld=this.curKeyId,this.selectedChanged.emit(this.curObj))},e.decorators=[{type:A.Component,args:[{selector:"rac-reassign-help",template:'<farris-lookup #reassignLookup [displayText]="displayText" style="width:350px"  name="reassignLookup" \r\n[showButtons]="true" [title]="\'请选择权限\'" [buttonsRef]="this.reassignHelp.btnOkAndCancleRef">\r\n  <div style="padding: 10px">\r\n    <rac-reassign-grid #reassignHelp style="height:450px;width:540px" [datas]="datas" calss="f-utils-fill"\r\n      (selectedAfterOk)="afterKeySelected($event)" (closeModalEmitter)="this.reassignLookup.closeDialog()">\r\n    </rac-reassign-grid>\r\n  </div>\r\n</farris-lookup>\r\n\r\n',styles:[""]}]}],e.ctorParameters=function(){return[]},e.propDecorators={displayText:[{type:A.Input}],curKeyId:[{type:A.Input}],datas:[{type:A.Input}],reassignLookup:[{type:A.ViewChild,args:["reassignLookup"]}],selectedChanged:[{type:A.Output}]},e}(),ae=function(){function e(){}return e.decorators=[{type:A.NgModule,args:[{declarations:[W,ee,te,ie,se,re,ne],imports:[i.CommonModule,s.HttpClientModule,l.ButtonsModule,n.FormsModule,n.ReactiveFormsModule,r.GridModule,y.DatagridModule,a.LayoutModule,h.LayoutModule,u.FarrisPanelModule,p.TreeTableModule,f.DataTableModule,o.TreeViewModule,d.LookupModule,c.ModalModule.forRoot(),k.MessagerModule.forRoot()],entryComponents:[W,ee,te,ie,se,ne,re],providers:[V,Q,Z,J,_,X],exports:[W,ee,te,ie,se,ne,re]}]}],e}();e.AuthEntryEntity=I,e.AuthFieldEntity=T,e.AuthobjEntity=D,e.DataSourceContextEntity=x,e.FetcherType=O,e.ReAssignEntity=K,e.GSPAuthFieldGroup=C,e.BizDataDTO=E,e.AuresultEntity=M,e.AuthDataField=N,e.AuthDataSource=P,e.HierarchicalType=F,e.HierarchicalInfoEntity=j,e.FieldAccessType=R,e.OperationEntity=w,e.AuresultChangesEntity=B,e.AuresultSave=L,e.DataFetcherEntity=H,e.DBOColumnEntity=U,e.RuleType=q,e.ResultContextEntity=z,e.AuthfieldVarEntity=G,e.TreeService=$,e.ReAssignService=_,e.AuresultService=Z,e.AuthfieldService=X,e.RacCommonUtil=V,e.INIT_SKIP=0,e.BUTTONCOUNT=0,e.PAGESIZES=Y,e.INIT_PAGEINDEX=1,e.INIT_PAGESIZE=20,e.RacCommonModule=ae,e.ɵd=J,e.ɵi=Q,e.ɵb=ee,e.ɵc=te,e.ɵe=ie,e.ɵf=se,e.ɵa=W,e.ɵg=re,e.ɵh=ne,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=gsp-sys-rac-common.umd.min.js.map