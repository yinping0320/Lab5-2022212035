/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, Output, EventEmitter, ViewChild, TemplateRef, Input } from '@angular/core';
import { SysFuncOperationService } from '../service/sys-func-operation.service';
/**
 * 系统管理：功能操作左树有、右列表展示
 */
var SysFuncOperationComponent = /** @class */ (function () {
    function SysFuncOperationComponent(funcOpService) {
        this.funcOpService = funcOpService;
        /**
         * 是否只显示分组
         */
        this.onlyShowGroup = false;
        /**
         * 确认事件
         */
        this.afterConfirm = new EventEmitter();
        /**
         * 关闭事件
         */
        this.afterCancle = new EventEmitter();
        /**
         * 当前选中数据
         */
        this.curSelectedKeys = [];
        this.title = '功能操作帮助';
    }
    /**
     * @return {?}
     */
    SysFuncOperationComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () { };
    /**
     * @return {?}
     */
    SysFuncOperationComponent.prototype.loadData = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this.selectableSettings = {
            checkboxOnly: true,
            // 默认单选
            mode: !this.gridSelectMode ? 'single' : this.gridSelectMode,
            enabled: true
        };
        this.funcOpService.getFuncOperations().subscribe((/**
         * @param {?} res
         * @return {?}
         */
        function (res) {
            _this.data = [];
            /** @type {?} */
            var funcList = res;
            if (_this.onlyShowGroup) {
                _this.data = funcList.filter((/**
                 * @param {?} item
                 * @return {?}
                 */
                function (item) { return item.type == 0; }));
            }
            else {
                _this.data = funcList;
            }
            // funcList.forEach(item => {
            //     this.data.push(item);
            //     // 如果有明细节点
            //     if (this.onlyShowGroup === false && item['children'] !== null && item['children'].length > 0) {
            //         item['children'].forEach(child => this.data.push(child));
            //     }
            // });
            _this.gridData = [];
            // 复制一份
            _this.gridData = _this.data.concat();
        }), (/**
         * @param {?} error
         * @return {?}
         */
        function (error) {
            console.log('获取功能操作对象列表失败');
        }));
    };
    /**
     * 搜索
     * @param filterValue 查询条件
     */
    /**
     * 搜索
     * @param {?} filterValue 查询条件
     * @return {?}
     */
    SysFuncOperationComponent.prototype.searchData = /**
     * 搜索
     * @param {?} filterValue 查询条件
     * @return {?}
     */
    function (filterValue) {
        var _this = this;
        // 测试
        if (filterValue === null || filterValue === '') {
            // 全量的数据
            this.gridData = this.data.concat();
            return;
        }
        /** @type {?} */
        var filter = filterValue.toLowerCase();
        // 搜索到上级时
        this.gridData = this.data.filter((/**
         * @param {?} item
         * @return {?}
         */
        function (item) {
            return item['code'].toLowerCase().includes(filter) ||
                item['name'].toLowerCase().includes(filter) ||
                _this.getFuncGroup(item).toLowerCase().includes(filter);
        }));
    };
    /**
     * 业务对象变化后
     * @param arg 业务对象参数
     */
    /**
     * 业务对象变化后
     * @param {?} arg 业务对象参数
     * @return {?}
     */
    SysFuncOperationComponent.prototype.bizObjectChanged = /**
     * 业务对象变化后
     * @param {?} arg 业务对象参数
     * @return {?}
     */
    function (arg) {
        if (!this.data || this.data.length === 0) {
            return;
        }
        /** @type {?} */
        var busId = arg;
        // 根据业务对象过滤
        this.gridData = this.data.filter((/**
         * @param {?} item
         * @return {?}
         */
        function (item) {
            return item['businessId'] === busId;
        }));
    };
    /**
     * 获取功能分组
     */
    /**
     * 获取功能分组
     * @param {?} funcOpObj
     * @return {?}
     */
    SysFuncOperationComponent.prototype.getFuncGroup = /**
     * 获取功能分组
     * @param {?} funcOpObj
     * @return {?}
     */
    function (funcOpObj) {
        // 获取父节点
        /** @type {?} */
        var parentId = funcOpObj['parentId'];
        if (parentId !== null && parentId !== undefined && parentId !== '') {
            /** @type {?} */
            var parentObj = this.data.filter((/**
             * @param {?} item
             * @return {?}
             */
            function (item) { return item['id'] === parentId; }));
            if (parentObj !== null && parentObj.length > 0) {
                return parentObj[0]['name'];
            }
        }
        else {
            return '无';
        }
    };
    /**
     * 获取选中数据
     */
    /**
     * 获取选中数据
     * @return {?}
     */
    SysFuncOperationComponent.prototype.getSelectedObject = /**
     * 获取选中数据
     * @return {?}
     */
    function () {
        var _this = this;
        /** @type {?} */
        var result = this.data.filter((/**
         * @param {?} item
         * @return {?}
         */
        function (item) {
            return _this.curSelectedKeys.findIndex((/**
             * @param {?} select
             * @return {?}
             */
            function (select) { return select === item['id']; })) >= 0;
        }));
        return result;
    };
    /**
     * 确认
     */
    /**
     * 确认
     * @return {?}
     */
    SysFuncOperationComponent.prototype.confirm = /**
     * 确认
     * @return {?}
     */
    function () {
        /** @type {?} */
        var result = this.getSelectedObject();
        this.afterConfirm.next(result);
        // 取消-目的是在这里让模态框消失
        this.cancle();
    };
    /**
     * 取消
     */
    /**
     * 取消
     * @return {?}
     */
    SysFuncOperationComponent.prototype.cancle = /**
     * 取消
     * @return {?}
     */
    function () {
        this.afterCancle.next();
    };
    SysFuncOperationComponent.decorators = [
        { type: Component, args: [{
                    selector: 'app-sys-func-operation',
                    template: "<div class=\"d-flex flex-row\" style=\"\r\nwidth: 800px; \r\nborder:2px;\r\nposition:absolute;\r\ntop:0px;\r\nbottom: 0px;\r\nright:0px;\r\nleft:0px;\r\noverflow: hidden;\r\nheight: 100%;\">\r\n  <div class=\"flex-fill\">\r\n    <kendo-splitter style=\"height:100%\" orientation=\"horizontal\">\r\n      <kendo-splitter-pane size=\"40%\" min=\"20%\" max=\"50%\">\r\n        <div class=\"d-flex flex-column flex-fill\" style=\"height:100%\">\r\n          <div class=\"p-2\" style=\"height: 35px;\">\r\n            <h5>\u4E1A\u52A1\u5BF9\u8C61</h5>\r\n            <hr class=\"m-0 p-0\" />\r\n          </div>\r\n          <div class=\"flex-fill\" style=\"overflow: auto;\">\r\n            <app-biz-object [bizObjectId]=\"bizObjectId\" (bizObjectChanged)=\"bizObjectChanged($event)\"></app-biz-object>\r\n          </div>\r\n        </div>\r\n      </kendo-splitter-pane>\r\n      <kendo-splitter-pane>\r\n        <div class=\"d-flex flex-column flex-fill\" style=\"height:100%\">\r\n          <div class=\"p-2\" style=\"height: 35px;\">\r\n            <h5>\u529F\u80FD\u64CD\u4F5C</h5>\r\n            <hr class=\"m-0 p-0\" />\r\n          </div>\r\n          <div class=\"clearfix mt-1 mb-1 ml-1\">\r\n            <input #filter placeholder=\"\u8F93\u5165\u7F16\u53F7\u6216\u540D\u79F0\u67E5\u627E\" type=\"text\" />\r\n            <button class=\"btn btn-sm btn-default\" (click)=\"searchData(filter.value)\">\u67E5\u627E</button>\r\n          </div>\r\n          <div class=\"d-flex flex-fill\" style=\"position:relative;\">\r\n            <kendo-grid [class]=\"'flex-fill'\" [selectable]=\"selectableSettings\" [kendoGridBinding]=\"gridData\"\r\n              [kendoGridSelectBy]=\"'id'\" [selectedKeys]=\"curSelectedKeys\">\r\n              <kendo-grid-checkbox-column width=\"40\"></kendo-grid-checkbox-column>\r\n              <kendo-grid-column field=\"code\" title=\"\u7F16\u53F7\"></kendo-grid-column>\r\n              <kendo-grid-column field=\"name\" title=\"\u540D\u79F0\"></kendo-grid-column>\r\n              <kendo-grid-column *ngIf=\"!onlyShowGroup\" title=\"\u529F\u80FD\u5206\u7EC4\">\r\n                <ng-template kendoGridCellTemplate let-dataItem>\r\n                  {{getFuncGroup(dataItem)}}\r\n                </ng-template>\r\n              </kendo-grid-column>\r\n            </kendo-grid>\r\n          </div>\r\n        </div>\r\n      </kendo-splitter-pane>\r\n    </kendo-splitter>\r\n  </div>\r\n</div>\r\n\r\n<ng-template #btnOkAndCancle>\r\n  <button class=\"btn btn-sm btn-primary\" (click)=\"confirm()\">\u786E\u8BA4</button>\r\n  <button class=\"btn btn-sm btn-default\" (click)=\"cancle()\">\u53D6\u6D88</button>\r\n</ng-template>\r\n",
                    styles: [""]
                }] }
    ];
    /** @nocollapse */
    SysFuncOperationComponent.ctorParameters = function () { return [
        { type: SysFuncOperationService }
    ]; };
    SysFuncOperationComponent.propDecorators = {
        bizObjectId: [{ type: Input }],
        gridSelectMode: [{ type: Input }],
        sessionId: [{ type: Input }],
        onlyShowGroup: [{ type: Input }],
        isGroupCanSelected: [{ type: Input }],
        afterConfirm: [{ type: Output }],
        afterCancle: [{ type: Output }],
        btnOkAndCancleRef: [{ type: ViewChild, args: ['btnOkAndCancle',] }]
    };
    return SysFuncOperationComponent;
}());
export { SysFuncOperationComponent };
if (false) {
    /**
     * 业务对象,负责传递
     * @type {?}
     */
    SysFuncOperationComponent.prototype.bizObjectId;
    /**
     * 选择模式
     * @type {?}
     */
    SysFuncOperationComponent.prototype.gridSelectMode;
    /**
     * sessionId
     * @type {?}
     */
    SysFuncOperationComponent.prototype.sessionId;
    /**
     * 是否只显示分组
     * @type {?}
     */
    SysFuncOperationComponent.prototype.onlyShowGroup;
    /**
     * 分组能否被选择
     * @type {?}
     */
    SysFuncOperationComponent.prototype.isGroupCanSelected;
    /**
     * 确认事件
     * @type {?}
     */
    SysFuncOperationComponent.prototype.afterConfirm;
    /**
     * 关闭事件
     * @type {?}
     */
    SysFuncOperationComponent.prototype.afterCancle;
    /** @type {?} */
    SysFuncOperationComponent.prototype.btnOkAndCancleRef;
    /**
     * 功能操作全量数据
     * @type {?}
     */
    SysFuncOperationComponent.prototype.data;
    /**
     * 当前UI显示动能操作列表数据
     * @type {?}
     */
    SysFuncOperationComponent.prototype.gridData;
    /**
     * 当前选中数据
     * @type {?}
     */
    SysFuncOperationComponent.prototype.curSelectedKeys;
    /** @type {?} */
    SysFuncOperationComponent.prototype.selectableSettings;
    /** @type {?} */
    SysFuncOperationComponent.prototype.title;
    /**
     * @type {?}
     * @private
     */
    SysFuncOperationComponent.prototype.funcOpService;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3lzLWZ1bmMtb3BlcmF0aW9uLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0Bnc3Atc3lzL3N5c21nci11aS8iLCJzb3VyY2VzIjpbImxpYi9mdW5jLW9wLWhlbHAvc3lzLWZ1bmMtb3BlcmF0aW9uL3N5cy1mdW5jLW9wZXJhdGlvbi5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUFBLE9BQU8sRUFBRSxTQUFTLEVBQVUsTUFBTSxFQUFFLFlBQVksRUFBRSxTQUFTLEVBQUUsV0FBVyxFQUFFLEtBQUssRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUV2RyxPQUFPLEVBQUUsdUJBQXVCLEVBQUUsTUFBTSx1Q0FBdUMsQ0FBQzs7OztBQUtoRjtJQWdESSxtQ0FDWSxhQUFzQztRQUF0QyxrQkFBYSxHQUFiLGFBQWEsQ0FBeUI7Ozs7UUFoQ2xELGtCQUFhLEdBQVksS0FBSyxDQUFDOzs7O1FBUS9CLGlCQUFZLEdBQUcsSUFBSSxZQUFZLEVBQVksQ0FBQzs7OztRQUs1QyxnQkFBVyxHQUFHLElBQUksWUFBWSxFQUFPLENBQUM7Ozs7UUFldEMsb0JBQWUsR0FBYSxFQUFFLENBQUM7UUFFL0IsVUFBSyxHQUFHLFFBQVEsQ0FBQztJQUlqQixDQUFDOzs7O0lBRUQsNENBQVE7OztJQUFSLGNBQWEsQ0FBQzs7OztJQUVmLDRDQUFROzs7SUFBUjtRQUFBLGlCQThCRTtRQTdCRyxJQUFJLENBQUMsa0JBQWtCLEdBQUc7WUFDdEIsWUFBWSxFQUFFLElBQUk7O1lBRWxCLElBQUksRUFBRSxDQUFDLElBQUksQ0FBQyxjQUFjLENBQUMsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLGNBQWM7WUFDM0QsT0FBTyxFQUFFLElBQUk7U0FDaEIsQ0FBQztRQUNGLElBQUksQ0FBQyxhQUFhLENBQUMsaUJBQWlCLEVBQUUsQ0FBQyxTQUFTOzs7O1FBQUMsVUFBQSxHQUFHO1lBQ2hELEtBQUksQ0FBQyxJQUFJLEdBQUcsRUFBRSxD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NUIsaURBQzRDOzs7OztJQUk1QyxnREFDc0M7O0lBRXRDLHNEQUNvQzs7Ozs7SUFJcEMseUNBQWU7Ozs7O0lBSWYsNkNBQW1COzs7OztJQUluQixvREFBK0I7O0lBQy9CLHVEQUF1Qzs7SUFDdkMsMENBQWlCOzs7OztJQUViLGtEQUE4QyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbXBvbmVudCwgT25Jbml0LCBPdXRwdXQsIEV2ZW50RW1pdHRlciwgVmlld0NoaWxkLCBUZW1wbGF0ZVJlZiwgSW5wdXQgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgU2VsZWN0YWJsZVNldHRpbmdzIH0gZnJvbSAnQHByb2dyZXNzL2tlbmRvLWFuZ3VsYXItZ3JpZCc7XHJcbmltcG9ydCB7IFN5c0Z1bmNPcGVyYXRpb25TZXJ2aWNlIH0gZnJvbSAnLi4vc2VydmljZS9zeXMtZnVuYy1vcGVyYXRpb24uc2VydmljZSc7XHJcblxyXG4vKipcclxuICog57O757uf566h55CG77ya5Yqf6IO95pON5L2c5bem5qCR5pyJ44CB5Y+z5YiX6KGo5bGV56S6XHJcbiAqL1xyXG5AQ29tcG9uZW50KHtcclxuICAgIHNlbGVjdG9yOiAnYXBwLXN5cy1mdW5jLW9wZXJhdGlvbicsXHJcbiAgICB0ZW1wbGF0ZVVybDogJy4vc3lzLWZ1bmMtb3BlcmF0aW9uLmNvbXBvbmVudC5odG1sJyxcclxuICAgIHN0eWxlVXJsczogWycuL3N5cy1mdW5jLW9wZXJhdGlvbi5jb21wb25lbnQuY3NzJ11cclxufSlcclxuZXhwb3J0IGNsYXNzIFN5c0Z1bmNPcGVyYXRpb25Db21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQge1xyXG5cclxuICAgIC8qKuS4muWKoeWvueixoSzotJ/otKPkvKDpgJIgKi9cclxuICAgIEBJbnB1dCgpIGJpek9iamVjdElkOiBzdHJpbmc7XHJcbiAgICAvKirpgInmi6nmqKHlvI8gKi9cclxuICAgIEBJbnB1dCgpXHJcbiAgICBncmlkU2VsZWN0TW9kZTogJ3NpbmdsZScgfCAnbXVsdGlwbGUnO1xyXG4gICAgLyoqc2Vzc2lvbklkICovXHJcbiAgICBASW5wdXQoKVxyXG4gICAgc2Vzc2lvbklkOiBzdHJpbmc7XHJcbiAgICAvKirmmK/lkKblj6rmmL7npLrliIbnu4QgKi9cclxuICAgIEBJbnB1dCgpXHJcbiAgICBvbmx5U2hvd0dyb3VwOiBib29sZWFuID0gZmFsc2U7XHJcbiAgICAvKirliIbnu4Tog73lkKbooqvpgInmi6kgKi9cclxuICAgIEBJbnB1dCgpXHJcbiAgICBpc0dyb3VwQ2FuU2VsZWN0ZWQ6IGJvb2xlYW47XHJcbiAgICAvKipcclxuICAgICAqIOehruiupOS6i+S7tlxyXG4gICAgICovXHJcbiAgICBAT3V0cHV0KClcclxuICAgIGFmdGVyQ29uZmlybSA9IG5ldyBFdmVudEVtaXR0ZXI8b2JqZWN0W10+KCk7XHJcbiAgICAvKipcclxuICAgICAqIOWFs+mXreS6i+S7tlxyXG4gICAgICovXHJcbiAgICBAT3V0cHV0KClcclxuICAgIGFmdGVyQ2FuY2xlID0gbmV3IEV2ZW50RW1pdHRlcjxhbnk+KCk7XHJcbiAgICAvLyDms6jlhaXliLDluK7liqnnmoTnoa7orqTlkozlj5bmtojmjInpkq5cclxuICAgIEBWaWV3Q2hpbGQoJ2J0bk9rQW5kQ2FuY2xlJylcclxuICAgIGJ0bk9rQW5kQ2FuY2xlUmVmOiBUZW1wbGF0ZVJlZjxhbnk+O1xyXG4gICAgLyoqXHJcbiAgICAgKiDlip/og73mk43kvZzlhajph4/mlbDmja5cclxuICAgICAqL1xyXG4gICAgZGF0YTogb2JqZWN0W107XHJcbiAgICAvKipcclxuICAgICAqIOW9k+WJjVVJ5pi+56S65Yqo6IO95pON5L2c5YiX6KGo5pWw5o2uXHJcbiAgICAgKi9cclxuICAgIGdyaWREYXRhOiBvYmplY3RbXTtcclxuICAgIC8qKlxyXG4gICAgICog5b2T5YmN6YCJ5Lit5pWw5o2uXHJcbiAgICAgKi9cclxuICAgIGN1clNlbGVjdGVkS2V5czogc3RyaW5nW10gPSBbXTtcclxuICAgIHNlbGVjdGFibGVTZXR0aW5nczogU2VsZWN0YWJsZVNldHRpbmdzO1xyXG4gICAgdGl0bGUgPSAn5Yqf6IO95pON5L2c5biu5YqpJztcclxuICAgIGNvbnN0cnVjdG9yIChcclxuICAgICAgICBwcml2YXRlIGZ1bmNPcFNlcnZpY2U6IFN5c0Z1bmNPcGVyYXRpb25TZXJ2aWNlXHJcbiAgICApIHtcclxuICAgIH1cclxuXHJcbiAgICBuZ09uSW5pdCAoKSB7fVxyXG5cclxuICAgbG9hZERhdGEgKCkge1xyXG4gICAgICAgIHRoaXMuc2VsZWN0YWJsZVNldHRpbmdzID0ge1xyXG4gICAgICAgICAgICBjaGVja2JveE9ubHk6IHRydWUsXHJcbiAgICAgICAgICAgIC8vIOm7mOiupOWNlemAiVxyXG4gICAgICAgICAgICBtb2RlOiAhdGhpcy5ncmlkU2VsZWN0TW9kZSA/ICdzaW5nbGUnIDogdGhpcy5ncmlkU2VsZWN0TW9kZSxcclxuICAgICAgICAgICAgZW5hYmxlZDogdHJ1ZVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5mdW5jT3BTZXJ2aWNlLmdldEZ1bmNPcGVyYXRpb25zKCkuc3Vic2NyaWJlKHJlcyA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuZGF0YSA9IFtdO1xyXG4gICAgICAgICAgICBjb25zdCBmdW5jTGlzdDogYW55W10gPSByZXM7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLm9ubHlTaG93R3JvdXApIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZGF0YSA9IGZ1bmNMaXN0LmZpbHRlcihpdGVtID0+IGl0ZW0udHlwZSA9PSAwKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZGF0YSA9IGZ1bmNMaXN0O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vIGZ1bmNMaXN0LmZvckVhY2goaXRlbSA9PiB7XHJcbiAgICAgICAgICAgIC8vICAgICB0aGlzLmRhdGEucHVzaChpdGVtKTtcclxuICAgICAgICAgICAgLy8gICAgIC8vIOWmguaenOacieaYjue7huiKgueCuVxyXG4gICAgICAgICAgICAvLyAgICAgaWYgKHRoaXMub25seVNob3dHcm91cCA9PT0gZmFsc2UgJiYgaXRlbVsnY2hpbGRyZW4nXSAhPT0gbnVsbCAmJiBpdGVtWydjaGlsZHJlbiddLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgLy8gICAgICAgICBpdGVtWydjaGlsZHJlbiddLmZvckVhY2goY2hpbGQgPT4gdGhpcy5kYXRhLnB1c2goY2hpbGQpKTtcclxuICAgICAgICAgICAgLy8gICAgIH1cclxuICAgICAgICAgICAgLy8gfSk7XHJcbiAgICAgICAgICAgIHRoaXMuZ3JpZERhdGEgPSBbXTtcclxuICAgICAgICAgICAgLy8g5aSN5Yi25LiA5Lu9XHJcbiAgICAgICAgICAgIHRoaXMuZ3JpZERhdGEgPSB0aGlzLmRhdGEuY29uY2F0KCk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICAgICAgZXJyb3IgPT4ge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ+iOt+WPluWKn+iDveaTjeS9nOWvueixoeWIl+ihqOWksei0pScpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOaQnOe0olxyXG4gICAgICogQHBhcmFtIGZpbHRlclZhbHVlIOafpeivouadoeS7tlxyXG4gICAgICovXHJcbiAgICBzZWFyY2hEYXRhIChmaWx0ZXJWYWx1ZTogc3RyaW5nKSB7XHJcbiAgICAgICAgLy8g5rWL6K+VXHJcbiAgICAgICAgaWYgKGZpbHRlclZhbHVlID09PSBudWxsIHx8IGZpbHRlclZhbHVlID09PSAnJykge1xyXG4gICAgICAgICAgICAvLyDlhajph4/nmoTmlbDmja5cclxuICAgICAgICAgICAgdGhpcy5ncmlkRGF0YSA9IHRoaXMuZGF0YS5jb25jYXQoKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCBmaWx0ZXIgPSBmaWx0ZXJWYWx1ZS50b0xvd2VyQ2FzZSgpO1xyXG4gICAgICAgIC8vIOaQnOe0ouWIsOS4iue6p+aXtlxyXG4gICAgICAgIHRoaXMuZ3JpZERhdGEgPSB0aGlzLmRhdGEuZmlsdGVyKGl0ZW0gPT5cclxuICAgICAgICAgICAgaXRlbVsnY29kZSddLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoZmlsdGVyKSB8fFxyXG4gICAgICAgICAgICBpdGVtWyduYW1lJ10udG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhmaWx0ZXIpIHx8XHJcbiAgICAgICAgICAgIHRoaXMuZ2V0RnVuY0dyb3VwKGl0ZW0pLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoZmlsdGVyKSk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDkuJrliqHlr7nosaHlj5jljJblkI5cclxuICAgICAqIEBwYXJhbSBhcmcg5Lia5Yqh5a+56LGh5Y+C5pWwXHJcbiAgICAgKi9cclxuICAgIGJpek9iamVjdENoYW5nZWQgKGFyZzogYW55KSB7XHJcbiAgICAgICAgaWYgKCF0aGlzLmRhdGEgfHwgdGhpcy5kYXRhLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IGJ1c0lkID0gYXJnO1xyXG4gICAgICAgIC8vIOagueaNruS4muWKoeWvueixoei/h+a7pFxyXG4gICAgICAgIHRoaXMuZ3JpZERhdGEgPSB0aGlzLmRhdGEuZmlsdGVyKGl0ZW0gPT5cclxuICAgICAgICAgICAgaXRlbVsnYnVzaW5lc3NJZCddID09PSBidXNJZCk7XHJcbiAgICB9XHJcblxyXG5cclxuICAgIC8qKlxyXG4gICAgICog6I635Y+W5Yqf6IO95YiG57uEXHJcbiAgICAgKi9cclxuICAgIGdldEZ1bmNHcm91cCAoZnVuY09wT2JqOiBhbnkpOiBzdHJpbmcge1xyXG4gICAgICAgIC8vIOiOt+WPlueItuiKgueCuVxyXG4gICAgICAgIGNvbnN0IHBhcmVudElkID0gZnVuY09wT2JqWydwYXJlbnRJZCddO1xyXG4gICAgICAgIGlmIChwYXJlbnRJZCAhPT0gbnVsbCAmJiBwYXJlbnRJZCAhPT0gdW5kZWZpbmVkICYmIHBhcmVudElkICE9PSAnJykge1xyXG4gICAgICAgICAgICBjb25zdCBwYXJlbnRPYmogPSB0aGlzLmRhdGEuZmlsdGVyKGl0ZW0gPT4gaXRlbVsnaWQnXSA9PT0gcGFyZW50SWQpO1xyXG4gICAgICAgICAgICBpZiAocGFyZW50T2JqICE9PSBudWxsICYmIHBhcmVudE9iai5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcGFyZW50T2JqWzBdWyduYW1lJ107XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gJ+aXoCc7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog6I635Y+W6YCJ5Lit5pWw5o2uXHJcbiAgICAgKi9cclxuICAgIGdldFNlbGVjdGVkT2JqZWN0ICgpOiBhbnkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IHRoaXMuZGF0YS5maWx0ZXIoaXRlbSA9PlxyXG4gICAgICAgICAgICB0aGlzLmN1clNlbGVjdGVkS2V5cy5maW5kSW5kZXgoc2VsZWN0ID0+IHNlbGVjdCA9PT0gaXRlbVsnaWQnXSkgPj0gMCk7XHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOehruiupFxyXG4gICAgICovXHJcbiAgICBjb25maXJtICgpIHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSB0aGlzLmdldFNlbGVjdGVkT2JqZWN0KCk7XHJcbiAgICAgICAgdGhpcy5hZnRlckNvbmZpcm0ubmV4dChyZXN1bHQpO1xyXG4gICAgICAgIC8vIOWPlua2iC3nm67nmoTmmK/lnKjov5nph4zorqnmqKHmgIHmoYbmtojlpLFcclxuICAgICAgICB0aGlzLmNhbmNsZSgpO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiDlj5bmtohcclxuICAgICAqL1xyXG4gICAgY2FuY2xlICgpIHtcclxuICAgICAgICB0aGlzLmFmdGVyQ2FuY2xlLm5leHQoKTtcclxuICAgIH1cclxufVxyXG5cclxuIl19