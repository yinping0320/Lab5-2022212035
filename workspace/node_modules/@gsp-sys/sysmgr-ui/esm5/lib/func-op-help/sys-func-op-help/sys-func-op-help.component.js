/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, EventEmitter, Input, Output, Injector, ComponentFactoryResolver } from '@angular/core';
import { SysFuncOperationComponent } from '../sys-func-operation/sys-func-operation.component';
import { SysFrontUtil } from '../../sys-common/sys-front.util';
import { BsModalService } from '@farris/ui-modal';
import { SysFarrisFuncOperationComponent } from '../sys-farris-func-operation/sys-farris-func-operation.component';
import { SysLocaleService } from '../../locale/sys-locale.service';
import { HELP_LOCALE_ZHCHS } from '../../locale/locales/zh-cn/help';
var SysFuncOpHelpComponent = /** @class */ (function () {
    function SysFuncOpHelpComponent(modalService, injector, cfr, sysUtil, localService) {
        this.modalService = modalService;
        this.injector = injector;
        this.cfr = cfr;
        this.sysUtil = sysUtil;
        this.localService = localService;
        /**
         * 是否启用新UI,启用后性能提升
         */
        this.useNewUI = false;
        /**
         * 初始选中的权限对象内码
         */
        this.initSelectKeys = [];
        /**
         * 是否只显示分组
         */
        this.onlyShowGroup = false;
        /**
         * 输出事件
         */
        this.afterHelpConfirm = new EventEmitter();
        if (this.localService) {
            this.i18nRes = this.localService.getComponentOpt('help');
        }
        else {
            this.i18nRes = HELP_LOCALE_ZHCHS;
        }
    }
    /**
     * @return {?}
     */
    SysFuncOpHelpComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
    };
    /**
     * 新UI
     */
    /**
     * 新UI
     * @param {?} sessionId
     * @return {?}
     */
    SysFuncOpHelpComponent.prototype.showNewHelp = /**
     * 新UI
     * @param {?} sessionId
     * @return {?}
     */
    function (sessionId) {
        var _this = this;
        // 调用帮助时必须传递sessionId
        this.sysUtil.sessionId = sessionId;
        /** @type {?} */
        var compFactory = this.cfr.resolveComponentFactory(SysFarrisFuncOperationComponent);
        /** @type {?} */
        var funcOpCompNew = compFactory.create(this.injector);
        // 获取功能操作的实例组件
        if (this.initSelectKeys != null && this.initSelectKeys.length > 0) {
            this.initSelectKeys.forEach((/**
             * @param {?} key
             * @return {?}
             */
            function (key) { return funcOpCompNew.instance.curSelectedKeys.push(key); }));
        }
        // 初始化选择的业务操作
        if (this.bizObjectId && this.bizObjectId !== '') {
            funcOpCompNew.instance.bizObjectId = this.bizObjectId;
        }
        if (this.gridSelectMode) {
            funcOpCompNew.instance.gridSelectMode = this.gridSelectMode;
        }
        funcOpCompNew.instance.onlyShowGroup = this.onlyShowGroup;
        funcOpCompNew.instance.isGroupCanSelected = this.isGroupCanSelected;
        /** @type {?} */
        var modalConfig = {
            title: this.i18nRes.operationTitle,
            width: 850,
            height: 550,
            buttons: funcOpCompNew.instance.btnOkAndCancleRef,
            showButtons: true,
            showMaxButton: true,
            resizable: true
        };
        // 弹出帮助框
        this.funcOpDialog = this.modalService.show(funcOpCompNew, modalConfig);
        // 取消后
        funcOpCompNew.instance.afterCancle.subscribe((/**
         * @param {?} res
         * @return {?}
         */
        function (res) {
            // 消失模态框
            _this.funcOpDialog.close();
        }));
        // 确认后
        funcOpCompNew.instance.afterConfirm.subscribe((/**
         * @param {?} res
         * @return {?}
         */
        function (res) {
            _this.afterHelpConfirm.next(res);
        }));
    };
    /**
     * 弹出Farris模态框帮助
     */
    /**
     * 弹出Farris模态框帮助
     * @param {?} sessionId
     * @return {?}
     */
    SysFuncOpHelpComponent.prototype.showHelp = /**
     * 弹出Farris模态框帮助
     * @param {?} sessionId
     * @return {?}
     */
    function (sessionId) {
        var _this = this;
        if (this.useNewUI) {
            this.showNewHelp(sessionId);
            return;
        }
        // 调用帮助时必须传递sessionId
        this.sysUtil.sessionId = sessionId;
        /** @type {?} */
        var compFactory = this.cfr.resolveComponentFactory(SysFuncOperationComponent);
        this.funcOpComp = compFactory.create(this.injector);
        // 获取功能操作的实例组件
        if (this.initSelectKeys != null && this.initSelectKeys.length > 0) {
            this.initSelectKeys
                .forEach((/**
             * @param {?} key
             * @return {?}
             */
            function (key) { return _this.funcOpComp.instance.curSelectedKeys.push(key); }));
        }
        // 初始化选择的业务操作
        if (this.bizObjectId && this.bizObjectId !== '') {
            this.funcOpComp.instance.bizObjectId = this.bizObjectId;
        }
        if (this.gridSelectMode) {
            this.funcOpComp.instance.gridSelectMode = this.gridSelectMode;
        }
        this.funcOpComp.instance.onlyShowGroup = this.onlyShowGroup;
        this.funcOpComp.instance.isGroupCanSelected = this.isGroupCanSelected;
        // 旧版本的需要在这里loaddata
        this.funcOpComp.instance.loadData();
        /** @type {?} */
        var modalConfig = {
            title: '功能操作帮助',
            width: 800,
            height: 550,
            buttons: this.funcOpComp.instance.btnOkAndCancleRef,
            showButtons: true,
            showMaxButton: false,
            resizable: false
        };
        // 弹出帮助框
        this.funcOpDialog = this.modalService.show(this.funcOpComp, modalConfig);
        // 取消后
        this.funcOpComp.instance.afterCancle.subscribe((/**
         * @param {?} res
         * @return {?}
         */
        function (res) {
            // 消失模态框
            _this.funcOpDialog.close();
        }));
        // 确认后
        this.funcOpComp.instance.afterConfirm.subscribe((/**
         * @param {?} res
         * @return {?}
         */
        function (res) {
            _this.afterHelpConfirm.next(res);
        }));
    };
    SysFuncOpHelpComponent.decorators = [
        { type: Component, args: [{
                    selector: 'app-sys-func-op-help',
                    template: "",
                    styles: [""]
                }] }
    ];
    /** @nocollapse */
    SysFuncOpHelpComponent.ctorParameters = function () { return [
        { type: BsModalService },
        { type: Injector },
        { type: ComponentFactoryResolver },
        { type: SysFrontUtil },
        { type: SysLocaleService }
    ]; };
    SysFuncOpHelpComponent.propDecorators = {
        bizObjectId: [{ type: Input }],
        useNewUI: [{ type: Input }],
        initSelectKeys: [{ type: Input }],
        onlyShowGroup: [{ type: Input }],
        gridSelectMode: [{ type: Input }],
        isGroupCanSelected: [{ type: Input }],
        afterHelpConfirm: [{ type: Output }]
    };
    return SysFuncOpHelpComponent;
}());
export { SysFuncOpHelpComponent };
if (false) {
    /**
     * 所属的业务对象内码
     * @type {?}
     */
    SysFuncOpHelpComponent.prototype.bizObjectId;
    /**
     * 是否启用新UI,启用后性能提升
     * @type {?}
     */
    SysFuncOpHelpComponent.prototype.useNewUI;
    /**
     * 初始选中的权限对象内码
     * @type {?}
     */
    SysFuncOpHelpComponent.prototype.initSelectKeys;
    /**
     * 是否只显示分组
     * @type {?}
     */
    SysFuncOpHelpComponent.prototype.onlyShowGroup;
    /** @type {?} */
    SysFuncOpHelpComponent.prototype.gridSelectMode;
    /**
     * 分组能否被选择
     * @type {?}
     */
    SysFuncOpHelpComponent.prototype.isGroupCanSelected;
    /**
     * 输出事件
     * @type {?}
     */
    SysFuncOpHelpComponent.prototype.afterHelpConfirm;
    /**
     * @type {?}
     * @private
     */
    SysFuncOpHelpComponent.prototype.funcOpComp;
    /**
     * @type {?}
     * @private
     */
    SysFuncOpHelpComponent.prototype.funcOpDialog;
    /** @type {?} */
    SysFuncOpHelpComponent.prototype.i18nRes;
    /**
     * @type {?}
     * @private
     */
    SysFuncOpHelpComponent.prototype.modalService;
    /**
     * @type {?}
     * @private
     */
    SysFuncOpHelpComponent.prototype.injector;
    /**
     * @type {?}
     * @private
     */
    SysFuncOpHelpComponent.prototype.cfr;
    /**
     * @type {?}
     * @private
     */
    SysFuncOpHelpComponent.prototype.sysUtil;
    /**
     * @type {?}
     * @private
     */
    SysFuncOpHelpComponent.prototype.localService;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3lzLWZ1bmMtb3AtaGVscC5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZ3NwLXN5cy9zeXNtZ3ItdWkvIiwic291cmNlcyI6WyJsaWIvZnVuYy1vcC1oZWxwL3N5cy1mdW5jLW9wLWhlbHAvc3lzLWZ1bmMtb3AtaGVscC5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUFBLE9BQU8sRUFDSCxTQUFTLEVBRVQsWUFBWSxFQUNaLEtBQUssRUFFTCxNQUFNLEVBQ04sUUFBUSxFQUNSLHdCQUF3QixFQUMzQixNQUFNLGVBQWUsQ0FBQztBQUN2QixPQUFPLEVBQUUseUJBQXlCLEVBQUUsTUFBTSxvREFBb0QsQ0FBQztBQUMvRixPQUFPLEVBQUUsWUFBWSxFQUFFLE1BQU0saUNBQWlDLENBQUM7QUFDL0QsT0FBTyxFQUFjLGNBQWMsRUFBRSxNQUFNLGtCQUFrQixDQUFDO0FBRTlELE9BQU8sRUFBRSwrQkFBK0IsRUFBRSxNQUFNLGtFQUFrRSxDQUFDO0FBQ25ILE9BQU8sRUFBRSxnQkFBZ0IsRUFBRSxNQUFNLGlDQUFpQyxDQUFDO0FBQ25FLE9BQU8sRUFBRSxpQkFBaUIsRUFBRSxNQUFNLGlDQUFpQyxDQUFDO0FBRXBFO0lBcUNJLGdDQUNZLFlBQTRCLEVBQzVCLFFBQWtCLEVBQ2xCLEdBQTZCLEVBQzdCLE9BQXFCLEVBQ3JCLFlBQThCO1FBSjlCLGlCQUFZLEdBQVosWUFBWSxDQUFnQjtRQUM1QixhQUFRLEdBQVIsUUFBUSxDQUFVO1FBQ2xCLFFBQUcsR0FBSCxHQUFHLENBQTBCO1FBQzdCLFlBQU8sR0FBUCxPQUFPLENBQWM7UUFDckIsaUJBQVksR0FBWixZQUFZLENBQWtCOzs7O1FBL0JqQyxhQUFRLEdBQUcsS0FBSyxDQUFDOzs7O1FBSzFCLG1CQUFjLEdBQWEsRUFBRSxDQUFDOzs7O1FBRzlCLGtCQUFhLEdBQUcsS0FBSyxDQUFDOzs7O1FBWXRCLHFCQUFnQixHQUFHLElBQUksWUFBWSxFQUFZLENBQUM7UUFhNUMs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NEQ7Ozs7O0lBRTVELDhDQUFpQzs7SUFDakMseUNBQWE7Ozs7O0lBRVQsOENBQW9DOzs7OztJQUNwQywwQ0FBMEI7Ozs7O0lBQzFCLHFDQUFxQzs7Ozs7SUFDckMseUNBQTZCOzs7OztJQUM3Qiw4Q0FBc0MiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xyXG4gICAgQ29tcG9uZW50LFxyXG4gICAgT25Jbml0LFxyXG4gICAgRXZlbnRFbWl0dGVyLFxyXG4gICAgSW5wdXQsXHJcbiAgICBDb21wb25lbnRSZWYsXHJcbiAgICBPdXRwdXQsXHJcbiAgICBJbmplY3RvcixcclxuICAgIENvbXBvbmVudEZhY3RvcnlSZXNvbHZlclxyXG59IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBTeXNGdW5jT3BlcmF0aW9uQ29tcG9uZW50IH0gZnJvbSAnLi4vc3lzLWZ1bmMtb3BlcmF0aW9uL3N5cy1mdW5jLW9wZXJhdGlvbi5jb21wb25lbnQnO1xyXG5pbXBvcnQgeyBTeXNGcm9udFV0aWwgfSBmcm9tICcuLi8uLi9zeXMtY29tbW9uL3N5cy1mcm9udC51dGlsJztcclxuaW1wb3J0IHsgQnNNb2RhbFJlZiwgQnNNb2RhbFNlcnZpY2UgfSBmcm9tICdAZmFycmlzL3VpLW1vZGFsJztcclxuaW1wb3J0IHsgTWVzc2FnZXJTZXJ2aWNlIH0gZnJvbSAnQGZhcnJpcy91aS1tZXNzYWdlcic7XHJcbmltcG9ydCB7IFN5c0ZhcnJpc0Z1bmNPcGVyYXRpb25Db21wb25lbnQgfSBmcm9tICcuLi9zeXMtZmFycmlzLWZ1bmMtb3BlcmF0aW9uL3N5cy1mYXJyaXMtZnVuYy1vcGVyYXRpb24uY29tcG9uZW50JztcclxuaW1wb3J0IHsgU3lzTG9jYWxlU2VydmljZSB9IGZyb20gJy4uLy4uL2xvY2FsZS9zeXMtbG9jYWxlLnNlcnZpY2UnO1xyXG5pbXBvcnQgeyBIRUxQX0xPQ0FMRV9aSENIUyB9IGZyb20gJy4uLy4uL2xvY2FsZS9sb2NhbGVzL3poLWNuL2hlbHAnO1xyXG5cclxuQENvbXBvbmVudCh7XHJcbiAgICBzZWxlY3RvcjogJ2FwcC1zeXMtZnVuYy1vcC1oZWxwJyxcclxuICAgIHRlbXBsYXRlVXJsOiAnLi9zeXMtZnVuYy1vcC1oZWxwLmNvbXBvbmVudC5odG1sJyxcclxuICAgIHN0eWxlVXJsczogWycuL3N5cy1mdW5jLW9wLWhlbHAuY29tcG9uZW50LmNzcyddXHJcbn0pXHJcbmV4cG9ydCBjbGFzcyBTeXNGdW5jT3BIZWxwQ29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0IHtcclxuXHJcbiAgICAvKiog5omA5bGe55qE5Lia5Yqh5a+56LGh5YaF56CBICovXHJcbiAgICBASW5wdXQoKSBiaXpPYmplY3RJZDogc3RyaW5nO1xyXG5cclxuICAgIC8qKiDmmK/lkKblkK/nlKjmlrBVSSzlkK/nlKjlkI7mgKfog73mj5DljYcgKi9cclxuICAgIEBJbnB1dCgpIHVzZU5ld1VJID0gZmFsc2U7XHJcbiAgICAvKipcclxuICAgICAqIOWIneWni+mAieS4reeahOadg+mZkOWvueixoeWGheeggVxyXG4gICAgICovXHJcbiAgICBASW5wdXQoKVxyXG4gICAgaW5pdFNlbGVjdEtleXM6IHN0cmluZ1tdID0gW107XHJcbiAgICAvKiog5piv5ZCm5Y+q5pi+56S65YiG57uEICovXHJcbiAgICBASW5wdXQoKVxyXG4gICAgb25seVNob3dHcm91cCA9IGZhbHNlO1xyXG5cclxuICAgIEBJbnB1dCgpXHJcbiAgICBncmlkU2VsZWN0TW9kZTogJ3NpbmdsZScgfCAnbXVsdGlwbGUnO1xyXG5cclxuICAgIC8qKiDliIbnu4Tog73lkKbooqvpgInmi6kgKi9cclxuICAgIEBJbnB1dCgpXHJcbiAgICBpc0dyb3VwQ2FuU2VsZWN0ZWQ6IGJvb2xlYW47XHJcbiAgICAvKipcclxuICAgICAqIOi+k+WHuuS6i+S7tlxyXG4gICAgICovXHJcbiAgICBAT3V0cHV0KClcclxuICAgIGFmdGVySGVscENvbmZpcm0gPSBuZXcgRXZlbnRFbWl0dGVyPG9iamVjdFtdPigpO1xyXG4gICAgLy8g5biu5Yqp5LiK5Yqo5oCB5Yib5bu655qE5pi+56S65qih5p2/XHJcbiAgICBwcml2YXRlIGZ1bmNPcENvbXA6IENvbXBvbmVudFJlZjxTeXNGdW5jT3BlcmF0aW9uQ29tcG9uZW50PjtcclxuICAgIC8vIOaooeaAgeahhuacjeWKoVxyXG4gICAgcHJpdmF0ZSBmdW5jT3BEaWFsb2c6IEJzTW9kYWxSZWY7XHJcbiAgICBpMThuUmVzOiBhbnk7XHJcbiAgICBjb25zdHJ1Y3RvciAoXHJcbiAgICAgICAgcHJpdmF0ZSBtb2RhbFNlcnZpY2U6IEJzTW9kYWxTZXJ2aWNlLFxyXG4gICAgICAgIHByaXZhdGUgaW5qZWN0b3I6IEluamVjdG9yLFxyXG4gICAgICAgIHByaXZhdGUgY2ZyOiBDb21wb25lbnRGYWN0b3J5UmVzb2x2ZXIsXHJcbiAgICAgICAgcHJpdmF0ZSBzeXNVdGlsOiBTeXNGcm9udFV0aWwsXHJcbiAgICAgICAgcHJpdmF0ZSBsb2NhbFNlcnZpY2U6IFN5c0xvY2FsZVNlcnZpY2VcclxuICAgICkge1xyXG4gICAgICAgIGlmICh0aGlzLmxvY2FsU2VydmljZSkge1xyXG4gICAgICAgICAgICB0aGlzLmkxOG5SZXMgPSB0aGlzLmxvY2FsU2VydmljZS5nZXRDb21wb25lbnRPcHQoJ2hlbHAnKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLmkxOG5SZXMgPSBIRUxQX0xPQ0FMRV9aSENIUztcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgbmdPbkluaXQgKCkge1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog5pawVUlcclxuICAgICAqL1xyXG4gICAgc2hvd05ld0hlbHAgKHNlc3Npb25JZCkge1xyXG4gICAgICAgIC8vIOiwg+eUqOW4ruWKqeaXtuW/hemhu+S8oOmAknNlc3Npb25JZFxyXG4gICAgICAgIHRoaXMuc3lzVXRpbC5zZXNzaW9uSWQgPSBzZXNzaW9uSWQ7XHJcbiAgICAgICAgY29uc3QgY29tcEZhY3RvcnkgPSB0aGlzLmNmci5yZXNvbHZlQ29tcG9uZW50RmFjdG9yeShTeXNGYXJyaXNGdW5jT3BlcmF0aW9uQ29tcG9uZW50KTtcclxuICAgICAgICBjb25zdCBmdW5jT3BDb21wTmV3OiBDb21wb25lbnRSZWY8U3lzRmFycmlzRnVuY09wZXJhdGlvbkNvbXBvbmVudD4gPSBjb21wRmFjdG9yeS5jcmVhdGUodGhpcy5pbmplY3Rvcik7XHJcbiAgICAgICAgLy8g6I635Y+W5Yqf6IO95pON5L2c55qE5a6e5L6L57uE5Lu2XHJcbiAgICAgICAgaWYgKHRoaXMuaW5pdFNlbGVjdEtleXMgIT0gbnVsbCAmJiB0aGlzLmluaXRTZWxlY3RLZXlzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgdGhpcy5pbml0U2VsZWN0S2V5cy5mb3JFYWNoKGtleSA9PiBmdW5jT3BDb21wTmV3Lmluc3RhbmNlLmN1clNlbGVjdGVkS2V5cy5wdXNoKGtleSkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyDliJ3lp4vljJbpgInmi6nnmoTkuJrliqHmk43kvZxcclxuICAgICAgICBpZiAodGhpcy5iaXpPYmplY3RJZCAmJiB0aGlzLmJpek9iamVjdElkICE9PSAnJykge1xyXG4gICAgICAgICAgICBmdW5jT3BDb21wTmV3Lmluc3RhbmNlLmJpek9iamVjdElkID0gdGhpcy5iaXpPYmplY3RJZDtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMuZ3JpZFNlbGVjdE1vZGUpIHtcclxuICAgICAgICAgICAgZnVuY09wQ29tcE5ldy5pbnN0YW5jZS5ncmlkU2VsZWN0TW9kZSA9IHRoaXMuZ3JpZFNlbGVjdE1vZGU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZ1bmNPcENvbXBOZXcuaW5zdGFuY2Uub25seVNob3dHcm91cCA9IHRoaXMub25seVNob3dHcm91cDtcclxuICAgICAgICBmdW5jT3BDb21wTmV3Lmluc3RhbmNlLmlzR3JvdXBDYW5TZWxlY3RlZCA9IHRoaXMuaXNHcm91cENhblNlbGVjdGVkO1xyXG4gICAgICAgIGNvbnN0IG1vZGFsQ29uZmlnID0ge1xyXG4gICAgICAgICAgICB0aXRsZTogdGhpcy5pMThuUmVzLm9wZXJhdGlvblRpdGxlLFxyXG4gICAgICAgICAgICB3aWR0aDogODUwLFxyXG4gICAgICAgICAgICBoZWlnaHQ6IDU1MCxcclxuICAgICAgICAgICAgYnV0dG9uczogZnVuY09wQ29tcE5ldy5pbnN0YW5jZS5idG5Pa0FuZENhbmNsZVJlZixcclxuICAgICAgICAgICAgc2hvd0J1dHRvbnM6IHRydWUsXHJcbiAgICAgICAgICAgIHNob3dNYXhCdXR0b246IHRydWUsXHJcbiAgICAgICAgICAgIHJlc2l6YWJsZTogdHJ1ZVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgLy8g5by55Ye65biu5Yqp5qGGXHJcbiAgICAgICAgdGhpcy5mdW5jT3BEaWFsb2cgPSB0aGlzLm1vZGFsU2VydmljZS5zaG93KGZ1bmNPcENvbXBOZXcsIG1vZGFsQ29uZmlnKTtcclxuICAgICAgICAvLyDlj5bmtojlkI5cclxuICAgICAgICBmdW5jT3BDb21wTmV3Lmluc3RhbmNlLmFmdGVyQ2FuY2xlLnN1YnNjcmliZShcclxuICAgICAgICAgICAgcmVzID0+IHtcclxuICAgICAgICAgICAgICAgIC8vIOa2iOWkseaooeaAgeahhlxyXG4gICAgICAgICAgICAgICAgdGhpcy5mdW5jT3BEaWFsb2cuY2xvc2UoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICk7XHJcbiAgICAgICAgLy8g56Gu6K6k5ZCOXHJcbiAgICAgICAgZnVuY09wQ29tcE5ldy5pbnN0YW5jZS5hZnRlckNvbmZpcm0uc3Vic2NyaWJlKHJlcyA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuYWZ0ZXJIZWxwQ29uZmlybS5uZXh0KHJlcyk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDlvLnlh7pGYXJyaXPmqKHmgIHmoYbluK7liqlcclxuICAgICAqL1xyXG4gICAgc2hvd0hlbHAgKHNlc3Npb25JZDogc3RyaW5nKSB7XHJcbiAgICAgICAgaWYgKHRoaXMudXNlTmV3VUkpIHtcclxuICAgICAgICAgICAgdGhpcy5zaG93TmV3SGVscChzZXNzaW9uSWQpO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIOiwg+eUqOW4ruWKqeaXtuW/hemhu+S8oOmAknNlc3Npb25JZFxyXG4gICAgICAgIHRoaXMuc3lzVXRpbC5zZXNzaW9uSWQgPSBzZXNzaW9uSWQ7XHJcbiAgICAgICAgY29uc3QgY29tcEZhY3RvcnkgPSB0aGlzLmNmci5yZXNvbHZlQ29tcG9uZW50RmFjdG9yeShTeXNGdW5jT3BlcmF0aW9uQ29tcG9uZW50KTtcclxuICAgICAgICB0aGlzLmZ1bmNPcENvbXAgPSBjb21wRmFjdG9yeS5jcmVhdGUodGhpcy5pbmplY3Rvcik7XHJcbiAgICAgICAgLy8g6I635Y+W5Yqf6IO95pON5L2c55qE5a6e5L6L57uE5Lu2XHJcbiAgICAgICAgaWYgKHRoaXMuaW5pdFNlbGVjdEtleXMgIT0gbnVsbCAmJiB0aGlzLmluaXRTZWxlY3RLZXlzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgdGhpcy5pbml0U2VsZWN0S2V5c1xyXG4gICAgICAgICAgICAgICAgLmZvckVhY2goa2V5ID0+IHRoaXMuZnVuY09wQ29tcC5pbnN0YW5jZS5jdXJTZWxlY3RlZEtleXMucHVzaChrZXkpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8g5Yid5aeL5YyW6YCJ5oup55qE5Lia5Yqh5pON5L2cXHJcbiAgICAgICAgaWYgKHRoaXMuYml6T2JqZWN0SWQgJiYgdGhpcy5iaXpPYmplY3RJZCAhPT0gJycpIHtcclxuICAgICAgICAgICAgdGhpcy5mdW5jT3BDb21wLmluc3RhbmNlLmJpek9iamVjdElkID0gdGhpcy5iaXpPYmplY3RJZDtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMuZ3JpZFNlbGVjdE1vZGUpIHtcclxuICAgICAgICAgICAgdGhpcy5mdW5jT3BDb21wLmluc3RhbmNlLmdyaWRTZWxlY3RNb2RlID0gdGhpcy5ncmlkU2VsZWN0TW9kZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5mdW5jT3BDb21wLmluc3RhbmNlLm9ubHlTaG93R3JvdXAgPSB0aGlzLm9ubHlTaG93R3JvdXA7XHJcbiAgICAgICAgdGhpcy5mdW5jT3BDb21wLmluc3RhbmNlLmlzR3JvdXBDYW5TZWxlY3RlZCA9IHRoaXMuaXNHcm91cENhblNlbGVjdGVkO1xyXG4gICAgICAgIC8vIOaXp+eJiOacrOeahOmcgOimgeWcqOi/memHjGxvYWRkYXRhXHJcbiAgICAgICAgdGhpcy5mdW5jT3BDb21wLmluc3RhbmNlLmxvYWREYXRhKCk7XHJcbiAgICAgICAgY29uc3QgbW9kYWxDb25maWcgPSB7XHJcbiAgICAgICAgICAgIHRpdGxlOiAn5Yqf6IO95pON5L2c5biu5YqpJyxcclxuICAgICAgICAgICAgd2lkdGg6IDgwMCxcclxuICAgICAgICAgICAgaGVpZ2h0OiA1NTAsXHJcbiAgICAgICAgICAgIGJ1dHRvbnM6IHRoaXMuZnVuY09wQ29tcC5pbnN0YW5jZS5idG5Pa0FuZENhbmNsZVJlZixcclxuICAgICAgICAgICAgc2hvd0J1dHRvbnM6IHRydWUsXHJcbiAgICAgICAgICAgIHNob3dNYXhCdXR0b246IGZhbHNlLFxyXG4gICAgICAgICAgICByZXNpemFibGU6IGZhbHNlXHJcbiAgICAgICAgfTtcclxuICAgICAgICAvLyDlvLnlh7rluK7liqnmoYZcclxuICAgICAgICB0aGlzLmZ1bmNPcERpYWxvZyA9IHRoaXMubW9kYWxTZXJ2aWNlLnNob3codGhpcy5mdW5jT3BDb21wLCBtb2RhbENvbmZpZyk7XHJcbiAgICAgICAgLy8g5Y+W5raI5ZCOXHJcbiAgICAgICAgdGhpcy5mdW5jT3BDb21wLmluc3RhbmNlLmFmdGVyQ2FuY2xlLnN1YnNjcmliZShcclxuICAgICAgICAgICAgcmVzID0+IHtcclxuICAgICAgICAgICAgICAgIC8vIOa2iOWkseaooeaAgeahhlxyXG4gICAgICAgICAgICAgICAgdGhpcy5mdW5jT3BEaWFsb2cuY2xvc2UoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICk7XHJcbiAgICAgICAgLy8g56Gu6K6k5ZCOXHJcbiAgICAgICAgdGhpcy5mdW5jT3BDb21wLmluc3RhbmNlLmFmdGVyQ29uZmlybS5zdWJzY3JpYmUocmVzID0+IHtcclxuICAgICAgICAgICAgdGhpcy5hZnRlckhlbHBDb25maXJtLm5leHQocmVzKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxufVxyXG4iXX0=