/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, Input, Output, EventEmitter, ViewChild } from '@angular/core';
import { userHelp, posHelp, roleHelp } from '../help-meta/sys-help-meta';
import { SysCommonUtilService } from '@gsp-sys/sysmgr-common';
import { ServerSideToken, LookupGridComponent } from '@farris/ui-lookup';
import { SysFarrisLookupService } from '../service/sys-farris-lookup.service';
import { of } from 'rxjs';
import { SysLocaleService } from '../../locale/sys-locale.service';
import { HELP_LOCALE_ZHCHS } from '../../locale/locales/zh-cn/help';
import { map } from 'rxjs/operators';
var SysFarrisLookupComponent = /** @class */ (function () {
    function SysFarrisLookupComponent(sysUtil, localService) {
        var _this = this;
        this.sysUtil = sysUtil;
        this.localService = localService;
        /**
         * 宽度
         */
        this.width = 550;
        /**
         * 是否显示用户排序字段，WF使用
         */
        this.showUserOrderField = false;
        /**
         * 显示用户的单位信息，WF使用
         */
        this.showUserUnitInfo = false;
        /**
         * 只读
         */
        this.disabled = false;
        /**
         * 必填
         */
        this.required = true;
        /**
         * 打开帮助后是否有选中数据
         */
        this.enableToSelect = true;
        /**
         * 是否分页，默认true
         */
        this.pagination = true;
        /**
         * 首次加载第几页，默认1
         */
        this.pageIndex = 1;
        /**
         * 每页加载数，默认20
         */
        this.pageSize = 20;
        /**
         * 是否开始数据权限过滤
         */
        this.withPermission = false;
        /**
         * 启用关闭前事件
         */
        this.useBeforeCloseEvent = false;
        this.typeMode = 0;
        /**
         * 帮助选择后事件
         */
        this.afterConfirm = new EventEmitter();
        /**
         * 帮助选择后事件，会返回选中和删除的id
         */
        this.afterConfirmData = new EventEmitter();
        /**
         * 清空后事件-暂时不用
         */
        this.clear = new EventEmitter();
        /**
         * 关闭前-暂时不用
         */
        this.loadSuccessEvent = new EventEmitter();
        this.valueChangedEvent = new EventEmitter();
        this.selectDataEvent = new EventEmitter();
        this.dialogClosed = new EventEmitter();
        this.selectedData = [];
        this.farrisSelectedData = [];
        this.mapFields = { id: 'id', name: 'name' };
        /**
         * 帮助前事件,强行传递过滤条件
         */
        this.beforeOpen = (/**
         * @param {?} arg
         * @return {?}
         */
        function (arg) {
            if (!_this.filter) {
                // 可能调用方不传递，识别为非空
                _this.filter = {};
            }
            /**
             * WF使用，如果显示用户的单位信息，需要查询条件中增加如下标识，
             * 服务器端解析
             */
            if (_this.showUserUnitInfo) {
                _this.filter.queryMode = '0002';
            }
            _this.filter.pageIndex = _this.pageIndex;
            _this.filter.pageSize = _this.pageSize;
            _this.allData.length = 0;
            _this.farrisSelectedData = [];
            _this.selectedData = [];
            if (_this.bindingData != null && _this.bindingData.id != null && _this.bindingData.id != "") {
                _this.selectedData = _this.bindingData.id.split(',');
                _this.selectedData.forEach((/**
                 * @param {?} item
                 * @return {?}
                 */
                function (item) {
                    _this.farrisSelectedData.push({ "id": item });
                }));
            }
            // 把过滤数据和当前的数据传递到service层
            return of({
                showDialog: true, data: {
                    filter: _this.filter,
                    allData: _this.allData,
                    farrisSelectedData: _this.farrisSelectedData
                }
            });
        });
        /**
         * 帮助关闭前事件,目前无论是否都会继续走afterOk映射事件
         */
        this.dictPicked = (/**
         * @param {?} arg
         * @return {?}
         */
        function (arg) {
            if (_this.useBeforeCloseEvent && _this.beforeClose) {
                return _this.beforeClose(arg).pipe(map((/**
                 * @param {?} val
                 * @return {?}
                 */
                function (val) {
                    // 如果能关闭，调用后事件
                    if (val.closeDialog) {
                        _this.afterConfirm.next(arg);
                    }
                    return val;
                })));
            }
            else {
                return of({ closeDialog: true });
            }
        });
        /**
         * 帮助映射后事件
         */
        this.afterOk = (/**
         * @param {?} helpdata
         * @param {?} mapfields
         * @return {?}
         */
        function (helpdata, mapfields) {
            if (_this.useBeforeCloseEvent) {
                return;
            }
            if (_this.typeMode && _this.typeMode === 1) {
                if (!_this.singleSelect) {
                    _this.selectedData = _this.selectedData.filter((/**
                     * @param {?} item
                     * @return {?}
                     */
                    function (item) {
                        if (_this.allData.findIndex((/**
                         * @param {?} element
                         * @return {?}
                         */
                        function (element) {
                            if (item.hasOwnProperty("id")) {
                                return element.id === item.id;
                            }
                            else {
                                return element.id === item;
                            }
                        })) > -1) {
                            return true;
                        }
                        else {
                            return false;
                        }
                    }));
                    _this.selectedData.forEach((/**
                     * @param {?} item
                     * @param {?} index
                     * @return {?}
                     */
                    function (item, index) {
                        if (!item.hasOwnProperty("id")) {
                            _this.allData.forEach((/**
                             * @param {?} element
                             * @return {?}
                             */
                            function (element) {
                                if (element.id === item) {
                                    _this.selectedData[index] = element;
                                }
                            }));
                        }
                    }));
                    helpdata = _this.selectedData;
                }
            }
            if (helpdata) {
                // 多选的话需要处理,帮助已逗号为间隔
                if (!_this.singleSelect) {
                    /** @type {?} */
                    var idList = helpdata.map((/**
                     * @param {?} item
                     * @return {?}
                     */
                    function (item) { return item.id; }));
                    /** @type {?} */
                    var nameList = helpdata.map((/**
                     * @param {?} item
                     * @return {?}
                     */
                    function (item) { return item.name; }));
                    /** @type {?} */
                    var nameStr = nameList.join();
                    /** @type {?} */
                    var idStr = idList.join();
                    _this.displayTxt = nameStr;
                    _this.bindingData.id = idStr;
                    _this.bindingData.name = nameStr;
                }
                else {
                    _this.displayTxt = helpdata.name;
                }
            }
            else { // 目前清空会走这里，而且两次
            }
            // 触发事件
            _this.afterConfirm.next(helpdata);
            // this.afterConfirmData.next(this.selctedData);
        });
        this.onOkClick = (/**
         * @return {?}
         */
        function () {
            if (_this.useBeforeCloseEvent) {
                return;
            }
            /** @type {?} */
            var helpdata;
            if (!_this.selectedData || _this.selectedData.length === 0) {
                if (_this.singleSelect) {
                    _this.afterConfirm.next(helpdata);
                }
                else {
                    _this.afterConfirm.next([]);
                }
                _this.farrisLookUp.closeDialog();
                return;
            }
            _this.selectedData = _this.selectedData.filter((/**
             * @param {?} item
             * @return {?}
             */
            function (item) {
                if (_this.allData.findIndex((/**
                 * @param {?} element
                 * @return {?}
                 */
                function (element) {
                    if (item.hasOwnProperty("id")) {
                        return element.id === item.id;
                    }
                    else {
                        return element.id === item;
                    }
                })) > -1) {
                    return true;
                }
                else {
                    return false;
                }
            }));
            _this.selectedData.forEach((/**
             * @param {?} item
             * @param {?} index
             * @return {?}
             */
            function (item, index) {
                if (!item.hasOwnProperty("id")) {
                    _this.allData.forEach((/**
                     * @param {?} element
                     * @return {?}
                     */
                    function (element) {
                        if (element.id === item) {
                            _this.selectedData[index] = element;
                        }
                    }));
                }
            }));
            helpdata = _this.selectedData;
            if (helpdata && helpdata.length > 0) {
                // 多选的话需要处理,帮助已逗号为间隔
                if (!_this.singleSelect) {
                    /** @type {?} */
                    var idList = helpdata.map((/**
                     * @param {?} item
                     * @return {?}
                     */
                    function (item) { return item.id; }));
                    /** @type {?} */
                    var nameList = helpdata.map((/**
                     * @param {?} item
                     * @return {?}
                     */
                    function (item) { return item.name; }));
                    /** @type {?} */
                    var nameStr = nameList.join();
                    /** @type {?} */
                    var idStr = idList.join();
                    _this.displayTxt = nameStr;
                    _this.bindingData.id = idStr;
                    _this.bindingData.name = nameStr;
                    _this.afterConfirm.next(helpdata);
                }
                else {
                    /** @type {?} */
                    var nameStr = helpdata[0].name;
                    _this.displayTxt = nameStr;
                    _this.afterConfirm.next(helpdata[0]);
                }
            }
            else { // 目前清空会走这里，而且两次
                _this.afterConfirm.next(helpdata);
            }
            // 触发事件
            _this.farrisLookUp.closeDialog();
        });
        this.selectedData = [];
    }
    /**
     * @return {?}
     */
    SysFarrisLookupComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        if (this.localService) {
            this.i18nRes = this.localService.getComponentOpt('help');
        }
        else {
            this.i18nRes = HELP_LOCALE_ZHCHS;
        }
        this.columns = [
            { title: this.i18nRes.codeField, field: 'code', searchField: 'code', width: '160' },
            { title: this.i18nRes.nameField, field: 'name', searchField: 'name', width: '200' },
        ];
        // 显示用户的单位路径信息，WF使用
        if (this.showUserUnitInfo) {
            this.width = 850;
            this.columns.push({ title: this.i18nRes.orgNamePathField, field: 'orgNamePath' });
            this.width = 850;
            this.columns.push({ title: this.i18nRes.orgName, field: 'sysOrgName' });
        }
        // 显示排序字段，WF使用
        if (this.showUserOrderField) {
            this.columns.push({ title: this.i18nRes.orderField, field: 'orderNum' });
        }
        // 初始化
        this.allData = [];
        // webapi初始
        switch (this.sourceType) {
            case 'position':
                this.dataUri = posHelp + this.sysUtil.positionWebApi;
                if (!this.title) {
                    this.title = this.i18nRes.positionTitle;
                }
                break;
            case 'role':
                this.dataUri = roleHelp + this.sysUtil.roleWebApi;
                if (!this.title) {
                    this.title = this.i18nRes.roleTitle;
                }
                break;
            case 'user':
            default:
                this.dataUri = userHelp + this.sysUtil.userWebApi;
                if (!this.title) {
                    this.title = this.i18nRes.userTitle;
                }
                break;
        }
        // 必须要有，否则初始选中不起作用
        this.farrisLookUp.mapFields = { id: 'id', name: 'name' };
        // 帮助关闭后事件
        this.farrisLookUp.dialogClosed.subscribe((/**
         * @param {?} val
         * @return {?}
         */
        function (val) {
            console.log(val);
            _this.dialogClosed.next(val);
        }));
    };
    /** 清空后 */
    /**
     * 清空后
     * @param {?} arg
     * @return {?}
     */
    SysFarrisLookupComponent.prototype.afterClear = /**
     * 清空后
     * @param {?} arg
     * @return {?}
     */
    function (arg) {
        this.clear.next(arg);
    };
    /** 手动显示帮助 */
    /**
     * 手动显示帮助
     * @return {?}
     */
    SysFarrisLookupComponent.prototype.showHelp = /**
     * 手动显示帮助
     * @return {?}
     */
    function () {
        this.farrisLookUp.showDialog();
    };
    /**
     * @param {?} arg
     * @return {?}
     */
    SysFarrisLookupComponent.prototype.oncheckedChange = /**
     * @param {?} arg
     * @return {?}
     */
    function (arg) {
        var _this = this;
        if (this.singleSelect) {
            this.selectedData = [];
        }
        if (arg.isCheck) {
            arg.data.forEach((/**
             * @param {?} item
             * @return {?}
             */
            function (item) {
                if (_this.selectedData.indexOf(item.id) === -1) {
                    _this.selectedData.push(item);
                }
            }));
        }
        else {
            this.selectedData = this.selectedData.filter((/**
             * @param {?} item
             * @return {?}
             */
            function (item) {
                if (arg.data.findIndex((/**
                 * @param {?} element
                 * @return {?}
                 */
                function (element) { return item.hasOwnProperty("id") ? item.id === element.id : item === element.id; })) > -1) {
                    return false;
                }
                else {
                    return true;
                }
            }));
        }
    };
    SysFarrisLookupComponent.decorators = [
        { type: Component, args: [{
                    selector: 'sys-farris-grid-lookup',
                    template: "<farris-lookup-grid #farrislookup\r\n    [disabled]=\"disabled\"\r\n    [editable]=\"false\"\r\n    [bindingData]=\"bindingData\"\r\n    [(ngModel)]=\"displayTxt\"\r\n    [columns]=\"columns\"\r\n    [singleSelect]=\"singleSelect\"\r\n    [title]=\"title\"\r\n    [displayType]=\"'List'\"\r\n    [uri]=\"dataUri\"\r\n    [idField]=\"'id'\"\r\n    [pageIndex]=\"pageIndex\"\r\n    [pageSize]=\"pageSize\"\r\n    [enableToSelect]=\"enableToSelect\"\r\n    [pagination]=\"pagination\"\r\n    [valueField]=\"'id'\" \r\n    [textField]=\"'name'\"\r\n    (clear)=\"afterClear($event)\"\r\n    [mapFields]=\"mapFields\"\r\n    [dictPicking]=\"beforeOpen\"\r\n    [dictPicked]=\"beforeClose\"\r\n    [mappingFn]= \"afterOk\"\r\n    [dialogWidth]=\"width\"\r\n    (checkedChange)=\"oncheckedChange($event)\"\r\n\r\n    [required]=\"required\"></farris-lookup-grid>\r\n\r\n    <!--\r\n        \u786E\u5B9A\u7684\u81EA\u5B9A\u4E49\u4E8B\u4EF6\uFF0C\u9700\u8981\u5220\u9664\r\n        [okHandler]=\"onOkClick\" -->\r\n\r\n",
                    providers: [
                        { provide: ServerSideToken, useClass: SysFarrisLookupService }
                    ],
                    styles: [""]
                }] }
    ];
    /** @nocollapse */
    SysFarrisLookupComponent.ctorParameters = function () { return [
        { type: SysCommonUtilService },
        { type: SysLocaleService }
    ]; };
    SysFarrisLookupComponent.propDecorators = {
        title: [{ type: Input }],
        width: [{ type: Input }],
        showUserOrderField: [{ type: Input }],
        showUserUnitInfo: [{ type: Input }],
        sourceType: [{ type: Input }],
        disabled: [{ type: Input }],
        required: [{ type: Input }],
        enableToSelect: [{ type: Input }],
        singleSelect: [{ type: Input }],
        pagination: [{ type: Input }],
        pageIndex: [{ type: Input }],
        pageSize: [{ type: Input }],
        displayTxt: [{ type: Input }],
        bindingData: [{ type: Input }],
        filter: [{ type: Input }],
        withPermission: [{ type: Input }],
        useBeforeCloseEvent: [{ type: Input }],
        beforeClose: [{ type: Input }],
        typeMode: [{ type: Input }],
        afterConfirm: [{ type: Output }],
        afterConfirmData: [{ type: Output }],
        clear: [{ type: Output }],
        loadSuccessEvent: [{ type: Output }],
        valueChangedEvent: [{ type: Output }],
        selectDataEvent: [{ type: Output }],
        dialogClosed: [{ type: Output }],
        farrisLookUp: [{ type: ViewChild, args: ['farrislookup',] }]
    };
    return SysFarrisLookupComponent;
}());
export { SysFarrisLookupComponent };
if (false) {
    /**
     * 标题
     * @type {?}
     */
    SysFarrisLookupComponent.prototype.title;
    /**
     * 宽度
     * @type {?}
     */
    SysFarrisLookupComponent.prototype.width;
    /**
     * 是否显示用户排序字段，WF使用
     * @type {?}
     */
    SysFarrisLookupComponent.prototype.showUserOrderField;
    /**
     * 显示用户的单位信息，WF使用
     * @type {?}
     */
    SysFarrisLookupComponent.prototype.showUserUnitInfo;
    /**
     * 取数源
     * @type {?}
     */
    SysFarrisLookupComponent.prototype.sourceType;
    /**
     * 只读
     * @type {?}
     */
    SysFarrisLookupComponent.prototype.disabled;
    /**
     * 必填
     * @type {?}
     */
    SysFarrisLookupComponent.prototype.required;
    /**
     * 打开帮助后是否有选中数据
     * @type {?}
     */
    SysFarrisLookupComponent.prototype.enableToSelect;
    /**
     * 是否单选
     * @type {?}
     */
    SysFarrisLookupComponent.prototype.singleSelect;
    /**
     * 是否分页，默认true
     * @type {?}
     */
    SysFarrisLookupComponent.prototype.pagination;
    /**
     * 首次加载第几页，默认1
     * @type {?}
     */
    SysFarrisLookupComponent.prototype.pageIndex;
    /**
     * 每页加载数，默认20
     * @type {?}
     */
    SysFarrisLookupComponent.prototype.pageSize;
    /**
     * 绑定到帮助上的数据，初始显示值用
     * @type {?}
     */
    SysFarrisLookupComponent.prototype.displayTxt;
    /**
     * 存储帮助选择的对象
     * @type {?}
     */
    SysFarrisLookupComponent.prototype.bindingData;
    /**
     * 过滤条件
     * @type {?}
     */
    SysFarrisLookupComponent.prototype.filter;
    /**
     * 是否开始数据权限过滤
     * @type {?}
     */
    SysFarrisLookupComponent.prototype.withPermission;
    /**
     * 启用关闭前事件
     * @type {?}
     */
    SysFarrisLookupComponent.prototype.useBeforeCloseEvent;
    /** @type {?} */
    SysFarrisLookupComponent.prototype.beforeClose;
    /** @type {?} */
    SysFarrisLookupComponent.prototype.typeMode;
    /**
     * 帮助选择后事件
     * @type {?}
     */
    SysFarrisLookupComponent.prototype.afterConfirm;
    /**
     * 帮助选择后事件，会返回选中和删除的id
     * @type {?}
     */
    SysFarrisLookupComponent.prototype.afterConfirmData;
    /**
     * 清空后事件-暂时不用
     * @type {?}
     */
    SysFarrisLookupComponent.prototype.clear;
    /**
     * 关闭前-暂时不用
     * @type {?}
     */
    SysFarrisLookupComponent.prototype.loadSuccessEvent;
    /** @type {?} */
    SysFarrisLookupComponent.prototype.valueChangedEvent;
    /** @type {?} */
    SysFarrisLookupComponent.prototype.selectDataEvent;
    /** @type {?} */
    SysFarrisLookupComponent.prototype.dialogClosed;
    /** @type {?} */
    SysFarrisLookupComponent.prototype.dataUri;
    /** @type {?} */
    SysFarrisLookupComponent.prototype.columns;
    /** @type {?} */
    SysFarrisLookupComponent.prototype.selectedData;
    /** @type {?} */
    SysFarrisLookupComponent.prototype.farrisSelectedData;
    /** @type {?} */
    SysFarrisLookupComponent.prototype.farrisLookUp;
    /** @type {?} */
    SysFarrisLookupComponent.prototype.mapFields;
    /**
     * 每次关闭前数据
     * @type {?}
     */
    SysFarrisLookupComponent.prototype.allData;
    /** @type {?} */
    SysFarrisLookupComponent.prototype.i18nRes;
    /**
     * 帮助前事件,强行传递过滤条件
     * @type {?}
     */
    SysFarrisLookupComponent.prototype.beforeOpen;
    /**
     * 帮助关闭前事件,目前无论是否都会继续走afterOk映射事件
     * @type {?}
     */
    SysFarrisLookupComponent.prototype.dictPicked;
    /**
     * 帮助映射后事件
     * @type {?}
     */
    SysFarrisLookupComponent.prototype.afterOk;
    /** @type {?} */
    SysFarrisLookupComponent.prototype.onOkClick;
    /** @type {?} */
    SysFarrisLookupComponent.prototype.sysUtil;
    /** @type {?} */
    SysFarrisLookupComponent.prototype.localService;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3lzLWZhcnJpcy1sb29rdXAuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGdzcC1zeXMvc3lzbWdyLXVpLyIsInNvdXJjZXMiOlsibGliL3N5cy1tYW5hZ2VyLXVpL3N5cy1mYXJyaXMtbG9va3VwL3N5cy1mYXJyaXMtbG9va3VwLmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7O0FBQ0EsT0FBTyxFQUFFLFNBQVMsRUFBVSxLQUFLLEVBQUUsTUFBTSxFQUFFLFlBQVksRUFBRSxTQUFTLEVBQVksTUFBTSxlQUFlLENBQUM7QUFDcEcsT0FBTyxFQUFFLFFBQVEsRUFBRSxPQUFPLEVBQUUsUUFBUSxFQUFFLE1BQU0sNEJBQTRCLENBQUM7QUFDekUsT0FBTyxFQUFFLG9CQUFvQixFQUFFLE1BQU0sd0JBQXdCLENBQUM7QUFDOUQsT0FBTyxFQUFFLGVBQWUsRUFBRSxtQkFBbUIsRUFBK0IsTUFBTSxtQkFBbUIsQ0FBQztBQUN0RyxPQUFPLEVBQUUsc0JBQXNCLEVBQUUsTUFBTSxzQ0FBc0MsQ0FBQztBQUk5RSxPQUFPLEVBQWMsRUFBRSxFQUFFLE1BQU0sTUFBTSxDQUFDO0FBQ3RDLE9BQU8sRUFBRSxnQkFBZ0IsRUFBRSxNQUFNLGlDQUFpQyxDQUFDO0FBQ25FLE9BQU8sRUFBRSxpQkFBaUIsRUFBRSxNQUFNLGlDQUFpQyxDQUFDO0FBQ3BFLE9BQU8sRUFBRSxHQUFHLEVBQVUsTUFBTSxnQkFBZ0IsQ0FBQztBQUc3QztJQXdFSSxrQ0FDVyxPQUE2QixFQUM3QixZQUE4QjtRQUZ6QyxpQkFNQztRQUxVLFlBQU8sR0FBUCxPQUFPLENBQXNCO1FBQzdCLGlCQUFZLEdBQVosWUFBWSxDQUFrQjs7OztRQTdEaEMsVUFBSyxHQUFHLEdBQUcsQ0FBQzs7OztRQUVaLHVCQUFrQixHQUFHLEtBQUssQ0FBQzs7OztRQUUzQixxQkFBZ0IsR0FBRyxLQUFLLENBQUM7Ozs7UUFJekIsYUFBUSxHQUFHLEtBQUssQ0FBQzs7OztRQUlqQixhQUFR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QUMsY0FBYzs7SUE0UTdCLCtCQUFDO0NBQUEsQUEvVUQsSUErVUM7U0F2VVksd0JBQXdCOzs7Ozs7SUFHakMseUNBQXVCOzs7OztJQUV2Qix5Q0FBcUI7Ozs7O0lBRXJCLHNEQUFvQzs7Ozs7SUFFcEMsb0RBQWtDOzs7OztJQUVsQyw4Q0FBa0Q7Ozs7O0lBRWxELDRDQUEwQjs7Ozs7SUFJMUIsNENBQXVCOzs7OztJQUl2QixrREFBNkI7Ozs7O0lBRTdCLGdEQUErQjs7Ozs7SUFFL0IsOENBQTJCOzs7OztJQUUzQiw2Q0FBdUI7Ozs7O0lBRXZCLDRDQUF1Qjs7Ozs7SUFFdkIsOENBQTRCOzs7OztJQUU1QiwrQ0FBbUQ7Ozs7O0lBRW5ELDBDQUF5RTs7Ozs7SUFFekUsa0RBQWdDOzs7OztJQUVoQyx1REFBcUM7O0lBQ3JDLCtDQUFvRTs7SUFDcEUsNENBQW9COzs7OztJQUVwQixnREFBb0U7Ozs7O0lBR3BFLG9EQUF3RTs7Ozs7SUFHeEUseUNBQTZEOzs7OztJQUU3RCxvREFBd0U7O0lBQ3hFLHFEQUF5RTs7SUFDekUsbURBQXVFOztJQUN2RSxnREFBb0U7O0lBQ3BFLDJDQUFnQjs7SUFDaEIsMkNBQWU7O0lBQ2YsZ0RBQXVCOztJQUN2QixzREFBNEI7O0lBQzVCLGdEQUFvRTs7SUFDcEUsNkNBQXVDOzs7OztJQUV2QywyQ0FBc0I7O0lBQ3RCLDJDQUFvQjs7Ozs7SUFnRXBCLDhDQWtDQzs7Ozs7SUFHRCw4Q0FZQzs7Ozs7SUFHRCwyQ0FtREM7O0lBaUNELDZDQThEQzs7SUFwUUcsMkNBQW9DOztJQUNwQyxnREFBcUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBmb3JFYWNoIH0gZnJvbSAnQGFuZ3VsYXIvcm91dGVyL3NyYy91dGlscy9jb2xsZWN0aW9uJztcclxuaW1wb3J0IHsgQ29tcG9uZW50LCBPbkluaXQsIElucHV0LCBPdXRwdXQsIEV2ZW50RW1pdHRlciwgVmlld0NoaWxkLCBPcHRpb25hbCB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyB1c2VySGVscCwgcG9zSGVscCwgcm9sZUhlbHAgfSBmcm9tICcuLi9oZWxwLW1ldGEvc3lzLWhlbHAtbWV0YSc7XHJcbmltcG9ydCB7IFN5c0NvbW1vblV0aWxTZXJ2aWNlIH0gZnJvbSAnQGdzcC1zeXMvc3lzbWdyLWNvbW1vbic7XHJcbmltcG9ydCB7IFNlcnZlclNpZGVUb2tlbiwgTG9va3VwR3JpZENvbXBvbmVudCwgUGlja2luZ1Jlc3VsdCwgUGlja2VkUmVzdWx0IH0gZnJvbSAnQGZhcnJpcy91aS1sb29rdXAnO1xyXG5pbXBvcnQgeyBTeXNGYXJyaXNMb29rdXBTZXJ2aWNlIH0gZnJvbSAnLi4vc2VydmljZS9zeXMtZmFycmlzLWxvb2t1cC5zZXJ2aWNlJztcclxuaW1wb3J0IHsgR3NwVXNlckZpbHRlciB9IGZyb20gJy4uL2ZpbHRlci9nc3AtdXNlci1maWx0ZXInO1xyXG5pbXBvcnQgeyBHc3BQb3NpdGlvbkZpbHRlciB9IGZyb20gJy4uL2ZpbHRlci9nc3AtcG9zaXRpb24tZmlsdGVyJztcclxuaW1wb3J0IHsgR3NwUm9sZUZpbHRlciB9IGZyb20gJy4uL2ZpbHRlci9nc3Atcm9sZS1maWx0ZXInO1xyXG5pbXBvcnQgeyBPYnNlcnZhYmxlLCBvZiB9IGZyb20gJ3J4anMnO1xyXG5pbXBvcnQgeyBTeXNMb2NhbGVTZXJ2aWNlIH0gZnJvbSAnLi4vLi4vbG9jYWxlL3N5cy1sb2NhbGUuc2VydmljZSc7XHJcbmltcG9ydCB7IEhFTFBfTE9DQUxFX1pIQ0hTIH0gZnJvbSAnLi4vLi4vbG9jYWxlL2xvY2FsZXMvemgtY24vaGVscCc7XHJcbmltcG9ydCB7IG1hcCwgZmlsdGVyIH0gZnJvbSAncnhqcy9vcGVyYXRvcnMnO1xyXG5pbXBvcnQgeyBlbGVtZW50IH0gZnJvbSAncHJvdHJhY3Rvcic7XHJcblxyXG5AQ29tcG9uZW50KHtcclxuICAgIHNlbGVjdG9yOiAnc3lzLWZhcnJpcy1ncmlkLWxvb2t1cCcsXHJcbiAgICB0ZW1wbGF0ZVVybDogJy4vc3lzLWZhcnJpcy1sb29rdXAuY29tcG9uZW50Lmh0bWwnLFxyXG4gICAgc3R5bGVVcmxzOiBbJy4vc3lzLWZhcnJpcy1sb29rdXAuY29tcG9uZW50LmNzcyddLFxyXG4gICAgcHJvdmlkZXJzOiBbXHJcbiAgICAgICAgeyBwcm92aWRlOiBTZXJ2ZXJTaWRlVG9rZW4sIHVzZUNsYXNzOiBTeXNGYXJyaXNMb29rdXBTZXJ2aWNlIH1cclxuICAgIF1cclxufSlcclxuZXhwb3J0IGNsYXNzIFN5c0ZhcnJpc0xvb2t1cENvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCB7XHJcblxyXG4gICAgLyoqIOagh+mimCAqL1xyXG4gICAgQElucHV0KCkgdGl0bGU6IHN0cmluZztcclxuICAgIC8qKuWuveW6piAqL1xyXG4gICAgQElucHV0KCkgd2lkdGggPSA1NTA7XHJcbiAgICAvKiog5piv5ZCm5pi+56S655So5oi35o6S5bqP5a2X5q6177yMV0bkvb/nlKggKi9cclxuICAgIEBJbnB1dCgpIHNob3dVc2VyT3JkZXJGaWVsZCA9IGZhbHNlO1xyXG4gICAgLyoqIOaYvuekuueUqOaIt+eahOWNleS9jeS/oeaBr++8jFdG5L2/55SoICovXHJcbiAgICBASW5wdXQoKSBzaG93VXNlclVuaXRJbmZvID0gZmFsc2U7XHJcbiAgICAvKiog5Y+W5pWw5rqQICovXHJcbiAgICBASW5wdXQoKSBzb3VyY2VUeXBlOiAndXNlcicgfCAncG9zaXRpb24nIHwgJ3JvbGUnO1xyXG4gICAgLyoqIOWPquivuyAqL1xyXG4gICAgQElucHV0KCkgZGlzYWJsZWQgPSBmYWxzZTtcclxuICAgIC8qKlxyXG4gICAgICog5b+F5aGrXHJcbiAgICAgKi9cclxuICAgIEBJbnB1dCgpIHJlcXVpcmVkPXRydWU7XHJcbiAgICAvKipcclxuICAgICAqIOaJk+W8gOW4ruWKqeWQjuaYr+WQpuaciemAieS4reaVsOaNrlxyXG4gICAgICovXHJcbiAgICBASW5wdXQoKSBlbmFibGVUb1NlbGVjdD10cnVlO1xyXG4gICAgLyoqIOaYr+WQpuWNlemAiSAqL1xyXG4gICAgQElucHV0KCkgc2luZ2xlU2VsZWN0OiBib29sZWFuO1xyXG4gICAgLyoqIOaYr+WQpuWIhumhte+8jOm7mOiupHRydWUgKi9cclxuICAgIEBJbnB1dCgpIHBhZ2luYXRpb24gPSB0cnVlO1xyXG4gICAgLyoqIOmmluasoeWKoOi9veesrOWHoOmhte+8jOm7mOiupDEgKi9cclxuICAgIEBJbnB1dCgpIHBhZ2VJbmRleCA9IDE7XHJcbiAgICAvKiog5q+P6aG15Yqg6L295pWw77yM6buY6K6kMjAgKi9cclxuICAgIEBJbnB1dCgpIHBhZ2VTaXplID0gMjA7XHJcbiAgICAvKiog57uR5a6a5Yiw5biu5Yqp5LiK55qE5pWw5o2u77yM5Yid5aeL5pi+56S65YC855SoICovXHJcbiAgICBASW5wdXQoKSBkaXNwbGF5VHh0OiBzdHJpbmc7XHJcbiAgICAvKiog5a2Y5YKo5biu5Yqp6YCJ5oup55qE5a+56LGhICovXHJcbiAgICBASW5wdXQoKSBiaW5kaW5nRGF0YTogeyBpZDogc3RyaW5nLCBuYW1lOiBzdHJpbmcgfTtcclxuICAgIC8qKiDov4fmu6TmnaHku7YgKi9cclxuICAgIEBJbnB1dCgpIGZpbHRlcjogR3NwVXNlckZpbHRlciB8IEdzcFBvc2l0aW9uRmlsdGVyIHwgR3NwUm9sZUZpbHRlciB8IGFueTtcclxuICAgIC8qKiDmmK/lkKblvIDlp4vmlbDmja7mnYPpmZDov4fmu6QgKi9cclxuICAgIEBJbnB1dCgpIHdpdGhQZXJtaXNzaW9uID0gZmFsc2U7XHJcbiAgICAvKiog5ZCv55So5YWz6Zet5YmN5LqL5Lu2ICovXHJcbiAgICBASW5wdXQoKSB1c2VCZWZvcmVDbG9zZUV2ZW50ID0gZmFsc2U7XHJcbiAgICBASW5wdXQoKSBiZWZvcmVDbG9zZTogKHNlbGVjdERhdGE6IGFueSkgPT4gT2JzZXJ2YWJsZTxQaWNrZWRSZXN1bHQ+O1xyXG4gICAgQElucHV0KCkgdHlwZU1vZGU9MDtcclxuICAgIC8qKiDluK7liqnpgInmi6nlkI7kuovku7YgKi9cclxuICAgIEBPdXRwdXQoKSBhZnRlckNvbmZpcm06IEV2ZW50RW1pdHRlcjxhbnk+ID0gbmV3IEV2ZW50RW1pdHRlcjxhbnk+KCk7XHJcblxyXG4gICAgLyoqIOW4ruWKqemAieaLqeWQjuS6i+S7tu+8jOS8mui/lOWbnumAieS4reWSjOWIoOmZpOeahGlkICovXHJcbiAgICBAT3V0cHV0KCkgYWZ0ZXJDb25maXJtRGF0YTogRXZlbnRFbWl0dGVyPGFueT4gPSBuZXcgRXZlbnRFbWl0dGVyPGFueT4oKTtcclxuXHJcbiAgICAvKiog5riF56m65ZCO5LqL5Lu2LeaaguaXtuS4jeeUqCAqL1xyXG4gICAgQE91dHB1dCgpIGNsZWFyOiBFdmVudEVtaXR0ZXI8YW55PiA9IG5ldyBFdmVudEVtaXR0ZXI8YW55PigpO1xyXG4gICAgLyoqIOWFs+mXreWJjS3mmoLml7bkuI3nlKggKi9cclxuICAgIEBPdXRwdXQoKSBsb2FkU3VjY2Vzc0V2ZW50OiBFdmVudEVtaXR0ZXI8YW55PiA9IG5ldyBFdmVudEVtaXR0ZXI8YW55PigpO1xyXG4gICAgQE91dHB1dCgpIHZhbHVlQ2hhbmdlZEV2ZW50OiBFdmVudEVtaXR0ZXI8YW55PiA9IG5ldyBFdmVudEVtaXR0ZXI8YW55PigpO1xyXG4gICAgQE91dHB1dCgpIHNlbGVjdERhdGFFdmVudDogRXZlbnRFbWl0dGVyPGFueT4gPSBuZXcgRXZlbnRFbWl0dGVyPGFueT4oKTtcclxuICAgIEBPdXRwdXQoKSBkaWFsb2dDbG9zZWQ6IEV2ZW50RW1pdHRlcjxhbnk+ID0gbmV3IEV2ZW50RW1pdHRlcjxhbnk+KCk7XHJcbiAgICBkYXRhVXJpOiBzdHJpbmc7XHJcbiAgICBjb2x1bW5zOiBhbnlbXTtcclxuICAgIHNlbGVjdGVkRGF0YSA6YW55W109W107XHJcbiAgICBmYXJyaXNTZWxlY3RlZERhdGE6YW55W109W107XHJcbiAgICBAVmlld0NoaWxkKCdmYXJyaXNsb29rdXAnKSBwdWJsaWMgZmFycmlzTG9va1VwOiBMb29rdXBHcmlkQ29tcG9uZW50O1xyXG4gICAgbWFwRmllbGRzID0geyBpZDogJ2lkJywgbmFtZTogJ25hbWUnIH07XHJcbiAgICAvKiog5q+P5qyh5YWz6Zet5YmN5pWw5o2uICovXHJcbiAgICBwdWJsaWMgYWxsRGF0YTogYW55W107XHJcbiAgICBwdWJsaWMgaTE4blJlczogYW55O1xyXG4gICAgY29uc3RydWN0b3IoXHJcbiAgICAgICAgcHVibGljIHN5c1V0aWw6IFN5c0NvbW1vblV0aWxTZXJ2aWNlLFxyXG4gICAgICAgIHB1YmxpYyBsb2NhbFNlcnZpY2U6IFN5c0xvY2FsZVNlcnZpY2VcclxuICAgICkge1xyXG4gICAgICAgIHRoaXMuc2VsZWN0ZWREYXRhID0gW107XHJcblxyXG4gICAgfVxyXG5cclxuICAgIG5nT25Jbml0KCkge1xyXG4gICAgICAgIGlmICh0aGlzLmxvY2FsU2VydmljZSkge1xyXG4gICAgICAgICAgICB0aGlzLmkxOG5SZXMgPSB0aGlzLmxvY2FsU2VydmljZS5nZXRDb21wb25lbnRPcHQoJ2hlbHAnKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLmkxOG5SZXMgPSBIRUxQX0xPQ0FMRV9aSENIUztcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5jb2x1bW5zID0gW1xyXG4gICAgICAgICAgICB7IHRpdGxlOiB0aGlzLmkxOG5SZXMuY29kZUZpZWxkLCBmaWVsZDogJ2NvZGUnLCBzZWFyY2hGaWVsZDogJ2NvZGUnLCB3aWR0aDogJzE2MCcgfSxcclxuICAgICAgICAgICAgeyB0aXRsZTogdGhpcy5pMThuUmVzLm5hbWVGaWVsZCwgZmllbGQ6ICduYW1lJywgc2VhcmNoRmllbGQ6ICduYW1lJywgd2lkdGg6ICcyMDAnIH0sXHJcbiAgICAgICAgXTtcclxuICAgICAgICAvLyDmmL7npLrnlKjmiLfnmoTljZXkvY3ot6/lvoTkv6Hmga/vvIxXRuS9v+eUqFxyXG4gICAgICAgIGlmICh0aGlzLnNob3dVc2VyVW5pdEluZm8pIHtcclxuICAgICAgICAgICAgdGhpcy53aWR0aCA9IDg1MDtcclxuICAgICAgICAgICAgdGhpcy5jb2x1bW5zLnB1c2goeyB0aXRsZTogdGhpcy5pMThuUmVzLm9yZ05hbWVQYXRoRmllbGQsIGZpZWxkOiAnb3JnTmFtZVBhdGgnIH0pO1xyXG4gICAgICAgICAgICB0aGlzLndpZHRoID0gODUwO1xyXG4gICAgICAgICAgICB0aGlzLmNvbHVtbnMucHVzaCh7IHRpdGxlOiB0aGlzLmkxOG5SZXMub3JnTmFtZSwgZmllbGQ6ICdzeXNPcmdOYW1lJyB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8g5pi+56S65o6S5bqP5a2X5q6177yMV0bkvb/nlKhcclxuICAgICAgICBpZiAodGhpcy5zaG93VXNlck9yZGVyRmllbGQpIHtcclxuICAgICAgICAgICAgdGhpcy5jb2x1bW5zLnB1c2goeyB0aXRsZTogdGhpcy5pMThuUmVzLm9yZGVyRmllbGQsIGZpZWxkOiAnb3JkZXJOdW0nIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyDliJ3lp4vljJZcclxuICAgICAgICB0aGlzLmFsbERhdGEgPSBbXTtcclxuICAgICAgICAvLyB3ZWJhcGnliJ3lp4tcclxuICAgICAgICBzd2l0Y2ggKHRoaXMuc291cmNlVHlwZSkge1xyXG4gICAgICAgICAgICBjYXNlICdwb3NpdGlvbic6XHJcbiAgICAgICAgICAgICAgICB0aGlzLmRhdGFVcmkgPSBwb3NIZWxwICsgdGhpcy5zeXNVdGlsLnBvc2l0aW9uV2ViQXBpO1xyXG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLnRpdGxlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy50aXRsZSA9IHRoaXMuaTE4blJlcy5wb3NpdGlvblRpdGxlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgJ3JvbGUnOlxyXG4gICAgICAgICAgICAgICAgdGhpcy5kYXRhVXJpID0gcm9sZUhlbHAgKyB0aGlzLnN5c1V0aWwucm9sZVdlYkFwaTtcclxuICAgICAgICAgICAgICAgIGlmICghdGhpcy50aXRsZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMudGl0bGUgPSB0aGlzLmkxOG5SZXMucm9sZVRpdGxlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgJ3VzZXInOlxyXG4gICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgdGhpcy5kYXRhVXJpID0gdXNlckhlbHAgKyB0aGlzLnN5c1V0aWwudXNlcldlYkFwaTtcclxuICAgICAgICAgICAgICAgIGlmICghdGhpcy50aXRsZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMudGl0bGUgPSB0aGlzLmkxOG5SZXMudXNlclRpdGxlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIOW/hemhu+imgeacie+8jOWQpuWImeWIneWni+mAieS4reS4jei1t+S9nOeUqFxyXG4gICAgICAgIHRoaXMuZmFycmlzTG9va1VwLm1hcEZpZWxkcyA9IHsgaWQ6ICdpZCcsIG5hbWU6ICduYW1lJyB9O1xyXG4gICAgICAgIC8vIOW4ruWKqeWFs+mXreWQjuS6i+S7tlxyXG4gICAgICAgIHRoaXMuZmFycmlzTG9va1VwLmRpYWxvZ0Nsb3NlZC5zdWJzY3JpYmUodmFsID0+IHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2codmFsKTtcclxuICAgICAgICAgICAgdGhpcy5kaWFsb2dDbG9zZWQubmV4dCh2YWwpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKiDluK7liqnliY3kuovku7Ys5by66KGM5Lyg6YCS6L+H5ruk5p2h5Lu2ICovXHJcbiAgICBiZWZvcmVPcGVuID0gKGFyZykgPT4ge1xyXG4gICAgICAgIGlmICghdGhpcy5maWx0ZXIpIHtcclxuICAgICAgICAgICAgLy8g5Y+v6IO96LCD55So5pa55LiN5Lyg6YCS77yM6K+G5Yir5Li66Z2e56m6XHJcbiAgICAgICAgICAgIHRoaXMuZmlsdGVyID0ge307XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIFdG5L2/55So77yM5aaC5p6c5pi+56S655So5oi355qE5Y2V5L2N5L+h5oGv77yM6ZyA6KaB5p+l6K+i5p2h5Lu25Lit5aKe5Yqg5aaC5LiL5qCH6K+G77yMXHJcbiAgICAgICAgICog5pyN5Yqh5Zmo56uv6Kej5p6QXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgaWYgKHRoaXMuc2hvd1VzZXJVbml0SW5mbykge1xyXG4gICAgICAgICAgICB0aGlzLmZpbHRlci5xdWVyeU1vZGUgPSAnMDAwMic7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuZmlsdGVyLnBhZ2VJbmRleCA9IHRoaXMucGFnZUluZGV4O1xyXG4gICAgICAgIHRoaXMuZmlsdGVyLnBhZ2VTaXplID0gdGhpcy5wYWdlU2l6ZTtcclxuICAgICAgICB0aGlzLmFsbERhdGEubGVuZ3RoID0gMDtcclxuICAgICAgICB0aGlzLmZhcnJpc1NlbGVjdGVkRGF0YSA9IFtdO1xyXG4gICAgICAgIHRoaXMuc2VsZWN0ZWREYXRhID0gW107XHJcblxyXG4gICAgICAgIGlmKHRoaXMuYmluZGluZ0RhdGEhPW51bGwmJnRoaXMuYmluZGluZ0RhdGEuaWQhPW51bGwmJnRoaXMuYmluZGluZ0RhdGEuaWQhPVwiXCIpe1xyXG4gICAgICAgICAgICB0aGlzLnNlbGVjdGVkRGF0YSA9IHRoaXMuYmluZGluZ0RhdGEuaWQuc3BsaXQoJywnKTtcclxuICAgICAgICAgICAgdGhpcy5zZWxlY3RlZERhdGEuZm9yRWFjaChpdGVtPT57XHJcbiAgICAgICAgICAgICAgICB0aGlzLmZhcnJpc1NlbGVjdGVkRGF0YS5wdXNoKHtcImlkXCI6aXRlbX0pO1xyXG5cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyDmiorov4fmu6TmlbDmja7lkozlvZPliY3nmoTmlbDmja7kvKDpgJLliLBzZXJ2aWNl5bGCXHJcbiAgICAgICAgcmV0dXJuIG9mKHtcclxuICAgICAgICAgICAgc2hvd0RpYWxvZzogdHJ1ZSwgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgZmlsdGVyOiB0aGlzLmZpbHRlcixcclxuICAgICAgICAgICAgICAgIGFsbERhdGE6IHRoaXMuYWxsRGF0YSxcclxuICAgICAgICAgICAgICAgIGZhcnJpc1NlbGVjdGVkRGF0YTp0aGlzLmZhcnJpc1NlbGVjdGVkRGF0YVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqIOW4ruWKqeWFs+mXreWJjeS6i+S7tiznm67liY3ml6DorrrmmK/lkKbpg73kvJrnu6fnu63otbBhZnRlck9r5pig5bCE5LqL5Lu2ICovXHJcbiAgICBkaWN0UGlja2VkID0gKGFyZzogYW55KTogT2JzZXJ2YWJsZTxQaWNrZWRSZXN1bHQ+ID0+IHtcclxuICAgICAgICBpZiAodGhpcy51c2VCZWZvcmVDbG9zZUV2ZW50ICYmIHRoaXMuYmVmb3JlQ2xvc2UpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuYmVmb3JlQ2xvc2UoYXJnKS5waXBlKG1hcCh2YWwgPT4ge1xyXG4gICAgICAgICAgICAgICAgLy8g5aaC5p6c6IO95YWz6Zet77yM6LCD55So5ZCO5LqL5Lu2XHJcbiAgICAgICAgICAgICAgICBpZiAodmFsLmNsb3NlRGlhbG9nKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5hZnRlckNvbmZpcm0ubmV4dChhcmcpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHZhbDtcclxuICAgICAgICAgICAgfSkpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiBvZih7IGNsb3NlRGlhbG9nOiB0cnVlIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvKiog5biu5Yqp5pig5bCE5ZCO5LqL5Lu2ICovXHJcbiAgICBhZnRlck9rID0gKGhlbHBkYXRhLCBtYXBmaWVsZHMpID0+IHtcclxuICAgICAgICBpZiAodGhpcy51c2VCZWZvcmVDbG9zZUV2ZW50KSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYodGhpcy50eXBlTW9kZSYmdGhpcy50eXBlTW9kZT09PTEpe1xyXG4gICAgICAgICAgICBpZighdGhpcy5zaW5nbGVTZWxlY3Qpe1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RlZERhdGEgPSB0aGlzLnNlbGVjdGVkRGF0YS5maWx0ZXIoaXRlbT0+e1xyXG4gICAgICAgICAgICAgICAgICAgIGlmKHRoaXMuYWxsRGF0YS5maW5kSW5kZXgoZWxlbWVudD0+e1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZihpdGVtLmhhc093blByb3BlcnR5KFwiaWRcIikpe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGVsZW1lbnQuaWQ9PT1pdGVtLmlkO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBlbGVtZW50LmlkPT09aXRlbTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0pPi0xKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICBcclxuICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWREYXRhLmZvckVhY2goKGl0ZW0saW5kZXgpPT57XHJcbiAgICAgICAgICAgICAgICAgICAgaWYoIWl0ZW0uaGFzT3duUHJvcGVydHkoXCJpZFwiKSl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYWxsRGF0YS5mb3JFYWNoKGVsZW1lbnQ9PntcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKGVsZW1lbnQuaWQ9PT1pdGVtKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGVkRGF0YVtpbmRleF0gPSBlbGVtZW50O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgaGVscGRhdGEgPSB0aGlzLnNlbGVjdGVkRGF0YTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKGhlbHBkYXRhKSB7XHJcbiAgICAgICAgICAgIC8vIOWkmumAieeahOivnemcgOimgeWkhOeQhizluK7liqnlt7LpgJflj7fkuLrpl7TpmpRcclxuICAgICAgICAgICAgaWYgKCF0aGlzLnNpbmdsZVNlbGVjdCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaWRMaXN0OiBzdHJpbmdbXSA9IGhlbHBkYXRhLm1hcChpdGVtID0+IGl0ZW0uaWQpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbmFtZUxpc3Q6IHN0cmluZ1tdID0gaGVscGRhdGEubWFwKGl0ZW0gPT4gaXRlbS5uYW1lKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG5hbWVTdHIgPSBuYW1lTGlzdC5qb2luKCk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpZFN0ciA9IGlkTGlzdC5qb2luKCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmRpc3BsYXlUeHQgPSBuYW1lU3RyO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5iaW5kaW5nRGF0YS5pZCA9IGlkU3RyO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5iaW5kaW5nRGF0YS5uYW1lID0gbmFtZVN0cjtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZGlzcGxheVR4dCA9IGhlbHBkYXRhLm5hbWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Ugey8vIOebruWJjea4heepuuS8mui1sOi/memHjO+8jOiAjOS4lOS4pOasoVxyXG4gICAgICAgIH1cclxuICAgICAgICAvLyDop6blj5Hkuovku7ZcclxuICAgICAgICB0aGlzLmFmdGVyQ29uZmlybS5uZXh0KGhlbHBkYXRhKTtcclxuICAgICAgICAvLyB0aGlzLmFmdGVyQ29uZmlybURhdGEubmV4dCh0aGlzLnNlbGN0ZWREYXRhKTtcclxuICAgIH1cclxuXHJcbiAgICAvKiog5riF56m65ZCOICovXHJcbiAgICBhZnRlckNsZWFyIChhcmc6IGFueSkge1xyXG4gICAgICAgIHRoaXMuY2xlYXIubmV4dChhcmcpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKiDmiYvliqjmmL7npLrluK7liqkgKi9cclxuICAgIHB1YmxpYyBzaG93SGVscCgpIHtcclxuICAgICAgICB0aGlzLmZhcnJpc0xvb2tVcC5zaG93RGlhbG9nKCk7XHJcbiAgICB9XHJcblxyXG4gICAgb25jaGVja2VkQ2hhbmdlKGFyZzphbnkpeyBcclxuICAgICAgICBpZih0aGlzLnNpbmdsZVNlbGVjdCl7XHJcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWREYXRhPVtdO1xyXG4gICAgICAgIH0gICAgICAgXHJcbiAgICAgICAgaWYoYXJnLmlzQ2hlY2spe1xyXG4gICAgICAgICAgICBhcmcuZGF0YS5mb3JFYWNoKGl0ZW09PntcclxuICAgICAgICAgICAgICAgIGlmKHRoaXMuc2VsZWN0ZWREYXRhLmluZGV4T2YoaXRlbS5pZCk9PT0tMSl7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RlZERhdGEucHVzaChpdGVtKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWREYXRhID0gdGhpcy5zZWxlY3RlZERhdGEuZmlsdGVyKGl0ZW09PntcclxuICAgICAgICAgICAgICAgIGlmKGFyZy5kYXRhLmZpbmRJbmRleChlbGVtZW50PT57cmV0dXJuIGl0ZW0uaGFzT3duUHJvcGVydHkoXCJpZFwiKT9pdGVtLmlkPT09ZWxlbWVudC5pZDppdGVtPT09ZWxlbWVudC5pZH0pPi0xKXtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIG9uT2tDbGljaz0oKT0+e1xyXG4gICAgICAgIGlmICh0aGlzLnVzZUJlZm9yZUNsb3NlRXZlbnQpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBsZXQgaGVscGRhdGEgOmFueTtcclxuICAgICAgICBpZighdGhpcy5zZWxlY3RlZERhdGF8fHRoaXMuc2VsZWN0ZWREYXRhLmxlbmd0aD09PTApe1xyXG4gICAgICAgICAgICBpZih0aGlzLnNpbmdsZVNlbGVjdCl7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmFmdGVyQ29uZmlybS5uZXh0KGhlbHBkYXRhKTtcclxuICAgICAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmFmdGVyQ29uZmlybS5uZXh0KFtdKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLmZhcnJpc0xvb2tVcC5jbG9zZURpYWxvZygpO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLnNlbGVjdGVkRGF0YSA9IHRoaXMuc2VsZWN0ZWREYXRhLmZpbHRlcihpdGVtPT57XHJcbiAgICAgICAgICAgIGlmKHRoaXMuYWxsRGF0YS5maW5kSW5kZXgoZWxlbWVudD0+e1xyXG4gICAgICAgICAgICAgICAgaWYoaXRlbS5oYXNPd25Qcm9wZXJ0eShcImlkXCIpKXtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZWxlbWVudC5pZD09PWl0ZW0uaWQ7XHJcbiAgICAgICAgICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZWxlbWVudC5pZD09PWl0ZW07XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pPi0xKXtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICB0aGlzLnNlbGVjdGVkRGF0YS5mb3JFYWNoKChpdGVtLGluZGV4KT0+e1xyXG4gICAgICAgICAgICBpZighaXRlbS5oYXNPd25Qcm9wZXJ0eShcImlkXCIpKXtcclxuICAgICAgICAgICAgICAgIHRoaXMuYWxsRGF0YS5mb3JFYWNoKGVsZW1lbnQ9PntcclxuICAgICAgICAgICAgICAgICAgICBpZihlbGVtZW50LmlkPT09aXRlbSl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWREYXRhW2luZGV4XSA9IGVsZW1lbnQ7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGhlbHBkYXRhID0gdGhpcy5zZWxlY3RlZERhdGE7XHJcblxyXG4gICAgICAgIGlmIChoZWxwZGF0YSYmaGVscGRhdGEubGVuZ3RoPjApIHtcclxuICAgICAgICAgICAgLy8g5aSa6YCJ55qE6K+d6ZyA6KaB5aSE55CGLOW4ruWKqeW3sumAl+WPt+S4uumXtOmalFxyXG4gICAgICAgICAgICBpZiAoIXRoaXMuc2luZ2xlU2VsZWN0KSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpZExpc3Q6IHN0cmluZ1tdID0gaGVscGRhdGEubWFwKGl0ZW0gPT4gaXRlbS5pZCk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBuYW1lTGlzdDogc3RyaW5nW10gPSBoZWxwZGF0YS5tYXAoaXRlbSA9PiBpdGVtLm5hbWUpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbmFtZVN0ciA9IG5hbWVMaXN0LmpvaW4oKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGlkU3RyID0gaWRMaXN0LmpvaW4oKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuZGlzcGxheVR4dCA9IG5hbWVTdHI7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmJpbmRpbmdEYXRhLmlkID0gaWRTdHI7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmJpbmRpbmdEYXRhLm5hbWUgPSBuYW1lU3RyO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5hZnRlckNvbmZpcm0ubmV4dChoZWxwZGF0YSk7XHJcblxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgbGV0IG5hbWVTdHIgPSBoZWxwZGF0YVswXS5uYW1lO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5kaXNwbGF5VHh0ID0gbmFtZVN0cjtcclxuICAgICAgICAgICAgICAgIHRoaXMuYWZ0ZXJDb25maXJtLm5leHQoaGVscGRhdGFbMF0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIHsvLyDnm67liY3muIXnqbrkvJrotbDov5nph4zvvIzogIzkuJTkuKTmrKFcclxuICAgICAgICAgICAgdGhpcy5hZnRlckNvbmZpcm0ubmV4dChoZWxwZGF0YSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIOinpuWPkeS6i+S7tlxyXG4gICAgICAgIHRoaXMuZmFycmlzTG9va1VwLmNsb3NlRGlhbG9nKCk7XHJcbiAgICB9XHJcblxyXG59XHJcblxyXG4iXX0=