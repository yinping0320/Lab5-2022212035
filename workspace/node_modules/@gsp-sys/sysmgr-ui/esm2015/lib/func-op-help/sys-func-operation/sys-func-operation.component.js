/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, Output, EventEmitter, ViewChild, TemplateRef, Input } from '@angular/core';
import { SysFuncOperationService } from '../service/sys-func-operation.service';
/**
 * 系统管理：功能操作左树有、右列表展示
 */
export class SysFuncOperationComponent {
    /**
     * @param {?} funcOpService
     */
    constructor(funcOpService) {
        this.funcOpService = funcOpService;
        /**
         * 是否只显示分组
         */
        this.onlyShowGroup = false;
        /**
         * 确认事件
         */
        this.afterConfirm = new EventEmitter();
        /**
         * 关闭事件
         */
        this.afterCancle = new EventEmitter();
        /**
         * 当前选中数据
         */
        this.curSelectedKeys = [];
        this.title = '功能操作帮助';
    }
    /**
     * @return {?}
     */
    ngOnInit() { }
    /**
     * @return {?}
     */
    loadData() {
        this.selectableSettings = {
            checkboxOnly: true,
            // 默认单选
            mode: !this.gridSelectMode ? 'single' : this.gridSelectMode,
            enabled: true
        };
        this.funcOpService.getFuncOperations().subscribe((/**
         * @param {?} res
         * @return {?}
         */
        res => {
            this.data = [];
            /** @type {?} */
            const funcList = res;
            if (this.onlyShowGroup) {
                this.data = funcList.filter((/**
                 * @param {?} item
                 * @return {?}
                 */
                item => item.type == 0));
            }
            else {
                this.data = funcList;
            }
            // funcList.forEach(item => {
            //     this.data.push(item);
            //     // 如果有明细节点
            //     if (this.onlyShowGroup === false && item['children'] !== null && item['children'].length > 0) {
            //         item['children'].forEach(child => this.data.push(child));
            //     }
            // });
            this.gridData = [];
            // 复制一份
            this.gridData = this.data.concat();
        }), (/**
         * @param {?} error
         * @return {?}
         */
        error => {
            console.log('获取功能操作对象列表失败');
        }));
    }
    /**
     * 搜索
     * @param {?} filterValue 查询条件
     * @return {?}
     */
    searchData(filterValue) {
        // 测试
        if (filterValue === null || filterValue === '') {
            // 全量的数据
            this.gridData = this.data.concat();
            return;
        }
        /** @type {?} */
        const filter = filterValue.toLowerCase();
        // 搜索到上级时
        this.gridData = this.data.filter((/**
         * @param {?} item
         * @return {?}
         */
        item => item['code'].toLowerCase().includes(filter) ||
            item['name'].toLowerCase().includes(filter) ||
            this.getFuncGroup(item).toLowerCase().includes(filter)));
    }
    /**
     * 业务对象变化后
     * @param {?} arg 业务对象参数
     * @return {?}
     */
    bizObjectChanged(arg) {
        if (!this.data || this.data.length === 0) {
            return;
        }
        /** @type {?} */
        const busId = arg;
        // 根据业务对象过滤
        this.gridData = this.data.filter((/**
         * @param {?} item
         * @return {?}
         */
        item => item['businessId'] === busId));
    }
    /**
     * 获取功能分组
     * @param {?} funcOpObj
     * @return {?}
     */
    getFuncGroup(funcOpObj) {
        // 获取父节点
        /** @type {?} */
        const parentId = funcOpObj['parentId'];
        if (parentId !== null && parentId !== undefined && parentId !== '') {
            /** @type {?} */
            const parentObj = this.data.filter((/**
             * @param {?} item
             * @return {?}
             */
            item => item['id'] === parentId));
            if (parentObj !== null && parentObj.length > 0) {
                return parentObj[0]['name'];
            }
        }
        else {
            return '无';
        }
    }
    /**
     * 获取选中数据
     * @return {?}
     */
    getSelectedObject() {
        /** @type {?} */
        const result = this.data.filter((/**
         * @param {?} item
         * @return {?}
         */
        item => this.curSelectedKeys.findIndex((/**
         * @param {?} select
         * @return {?}
         */
        select => select === item['id'])) >= 0));
        return result;
    }
    /**
     * 确认
     * @return {?}
     */
    confirm() {
        /** @type {?} */
        const result = this.getSelectedObject();
        this.afterConfirm.next(result);
        // 取消-目的是在这里让模态框消失
        this.cancle();
    }
    /**
     * 取消
     * @return {?}
     */
    cancle() {
        this.afterCancle.next();
    }
}
SysFuncOperationComponent.decorators = [
    { type: Component, args: [{
                selector: 'app-sys-func-operation',
                template: "<div class=\"d-flex flex-row\" style=\"\r\nwidth: 800px; \r\nborder:2px;\r\nposition:absolute;\r\ntop:0px;\r\nbottom: 0px;\r\nright:0px;\r\nleft:0px;\r\noverflow: hidden;\r\nheight: 100%;\">\r\n  <div class=\"flex-fill\">\r\n    <kendo-splitter style=\"height:100%\" orientation=\"horizontal\">\r\n      <kendo-splitter-pane size=\"40%\" min=\"20%\" max=\"50%\">\r\n        <div class=\"d-flex flex-column flex-fill\" style=\"height:100%\">\r\n          <div class=\"p-2\" style=\"height: 35px;\">\r\n            <h5>\u4E1A\u52A1\u5BF9\u8C61</h5>\r\n            <hr class=\"m-0 p-0\" />\r\n          </div>\r\n          <div class=\"flex-fill\" style=\"overflow: auto;\">\r\n            <app-biz-object [bizObjectId]=\"bizObjectId\" (bizObjectChanged)=\"bizObjectChanged($event)\"></app-biz-object>\r\n          </div>\r\n        </div>\r\n      </kendo-splitter-pane>\r\n      <kendo-splitter-pane>\r\n        <div class=\"d-flex flex-column flex-fill\" style=\"height:100%\">\r\n          <div class=\"p-2\" style=\"height: 35px;\">\r\n            <h5>\u529F\u80FD\u64CD\u4F5C</h5>\r\n            <hr class=\"m-0 p-0\" />\r\n          </div>\r\n          <div class=\"clearfix mt-1 mb-1 ml-1\">\r\n            <input #filter placeholder=\"\u8F93\u5165\u7F16\u53F7\u6216\u540D\u79F0\u67E5\u627E\" type=\"text\" />\r\n            <button class=\"btn btn-sm btn-default\" (click)=\"searchData(filter.value)\">\u67E5\u627E</button>\r\n          </div>\r\n          <div class=\"d-flex flex-fill\" style=\"position:relative;\">\r\n            <kendo-grid [class]=\"'flex-fill'\" [selectable]=\"selectableSettings\" [kendoGridBinding]=\"gridData\"\r\n              [kendoGridSelectBy]=\"'id'\" [selectedKeys]=\"curSelectedKeys\">\r\n              <kendo-grid-checkbox-column width=\"40\"></kendo-grid-checkbox-column>\r\n              <kendo-grid-column field=\"code\" title=\"\u7F16\u53F7\"></kendo-grid-column>\r\n              <kendo-grid-column field=\"name\" title=\"\u540D\u79F0\"></kendo-grid-column>\r\n              <kendo-grid-column *ngIf=\"!onlyShowGroup\" title=\"\u529F\u80FD\u5206\u7EC4\">\r\n                <ng-template kendoGridCellTemplate let-dataItem>\r\n                  {{getFuncGroup(dataItem)}}\r\n                </ng-template>\r\n              </kendo-grid-column>\r\n            </kendo-grid>\r\n          </div>\r\n        </div>\r\n      </kendo-splitter-pane>\r\n    </kendo-splitter>\r\n  </div>\r\n</div>\r\n\r\n<ng-template #btnOkAndCancle>\r\n  <button class=\"btn btn-sm btn-primary\" (click)=\"confirm()\">\u786E\u8BA4</button>\r\n  <button class=\"btn btn-sm btn-default\" (click)=\"cancle()\">\u53D6\u6D88</button>\r\n</ng-template>\r\n",
                styles: [""]
            }] }
];
/** @nocollapse */
SysFuncOperationComponent.ctorParameters = () => [
    { type: SysFuncOperationService }
];
SysFuncOperationComponent.propDecorators = {
    bizObjectId: [{ type: Input }],
    gridSelectMode: [{ type: Input }],
    sessionId: [{ type: Input }],
    onlyShowGroup: [{ type: Input }],
    isGroupCanSelected: [{ type: Input }],
    afterConfirm: [{ type: Output }],
    afterCancle: [{ type: Output }],
    btnOkAndCancleRef: [{ type: ViewChild, args: ['btnOkAndCancle',] }]
};
if (false) {
    /**
     * 业务对象,负责传递
     * @type {?}
     */
    SysFuncOperationComponent.prototype.bizObjectId;
    /**
     * 选择模式
     * @type {?}
     */
    SysFuncOperationComponent.prototype.gridSelectMode;
    /**
     * sessionId
     * @type {?}
     */
    SysFuncOperationComponent.prototype.sessionId;
    /**
     * 是否只显示分组
     * @type {?}
     */
    SysFuncOperationComponent.prototype.onlyShowGroup;
    /**
     * 分组能否被选择
     * @type {?}
     */
    SysFuncOperationComponent.prototype.isGroupCanSelected;
    /**
     * 确认事件
     * @type {?}
     */
    SysFuncOperationComponent.prototype.afterConfirm;
    /**
     * 关闭事件
     * @type {?}
     */
    SysFuncOperationComponent.prototype.afterCancle;
    /** @type {?} */
    SysFuncOperationComponent.prototype.btnOkAndCancleRef;
    /**
     * 功能操作全量数据
     * @type {?}
     */
    SysFuncOperationComponent.prototype.data;
    /**
     * 当前UI显示动能操作列表数据
     * @type {?}
     */
    SysFuncOperationComponent.prototype.gridData;
    /**
     * 当前选中数据
     * @type {?}
     */
    SysFuncOperationComponent.prototype.curSelectedKeys;
    /** @type {?} */
    SysFuncOperationComponent.prototype.selectableSettings;
    /** @type {?} */
    SysFuncOperationComponent.prototype.title;
    /**
     * @type {?}
     * @private
     */
    SysFuncOperationComponent.prototype.funcOpService;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3lzLWZ1bmMtb3BlcmF0aW9uLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0Bnc3Atc3lzL3N5c21nci11aS8iLCJzb3VyY2VzIjpbImxpYi9mdW5jLW9wLWhlbHAvc3lzLWZ1bmMtb3BlcmF0aW9uL3N5cy1mdW5jLW9wZXJhdGlvbi5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUFBLE9BQU8sRUFBRSxTQUFTLEVBQVUsTUFBTSxFQUFFLFlBQVksRUFBRSxTQUFTLEVBQUUsV0FBVyxFQUFFLEtBQUssRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUV2RyxPQUFPLEVBQUUsdUJBQXVCLEVBQUUsTUFBTSx1Q0FBdUMsQ0FBQzs7OztBQVVoRixNQUFNLE9BQU8seUJBQXlCOzs7O0lBMkNsQyxZQUNZLGFBQXNDO1FBQXRDLGtCQUFhLEdBQWIsYUFBYSxDQUF5Qjs7OztRQWhDbEQsa0JBQWEsR0FBWSxLQUFLLENBQUM7Ozs7UUFRL0IsaUJBQVksR0FBRyxJQUFJLFlBQVksRUFBWSxDQUFDOzs7O1FBSzVDLGdCQUFXLEdBQUcsSUFBSSxZQUFZLEVBQU8sQ0FBQzs7OztRQWV0QyxvQkFBZSxHQUFhLEVBQUUsQ0FBQztRQUUvQixVQUFLLEdBQUcsUUFBUSxDQUFDO0lBSWpCLENBQUM7Ozs7SUFFRCxRQUFRLEtBQUssQ0FBQzs7OztJQUVmLFFBQVE7UUFDSCxJQUFJLENBQUMsa0JBQWtCLEdBQUc7WUFDdEIsWUFBWSxFQUFFLElBQUk7O1lBRWxCLElBQUksRUFBRSxDQUFDLElBQUksQ0FBQyxjQUFjLENBQUMsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLGNBQWM7WUFDM0QsT0FBTyxFQUFFLElBQUk7U0FDaEIsQ0FBQztRQUNGLElBQUksQ0FBQyxhQUFhLENBQUMsaUJBQWlCLEVBQUUsQ0FBQyxTQUFTOzs7O1FBQUMsR0FBRyxDQUFDLEVBQUU7WUFDbkQsSUFBSSxDQUFDLElBQUksR0FBRyxFQUFFLENBQUM7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bkMsSUFBSSxDQUFDLGVBQWUsQ0FBQyxTQUFTOzs7O1FBQUMsTUFBTSxDQUFDLEVBQUUsQ0FBQyxNQUFNLEtBQUssSUFBSSxDQUFDLElBQUksQ0FBQyxFQUFDLElBQUksQ0FBQyxFQUFDO1FBQ3pFLE9BQU8sTUFBTSxDQUFDO0lBQ2xCLENBQUM7Ozs7O0lBS0QsT0FBTzs7Y0FDRyxNQUFNLEdBQUcsSUFBSSxDQUFDLGlCQUFpQixFQUFFO1FBQ3ZDLElBQUksQ0FBQyxZQUFZLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFDO1FBQy9CLGtCQUFrQjtRQUNsQixJQUFJLENBQUMsTUFBTSxFQUFFLENBQUM7SUFDbEIsQ0FBQzs7Ozs7SUFJRCxNQUFNO1FBQ0YsSUFBSSxDQUFDLFdBQVcsQ0FBQyxJQUFJLEVBQUUsQ0FBQztJQUM1QixDQUFDOzs7WUFoS0osU0FBUyxTQUFDO2dCQUNQLFFBQVEsRUFBRSx3QkFBd0I7Z0JBQ2xDLDRuRkFBa0Q7O2FBRXJEOzs7O1lBVFEsdUJBQXVCOzs7MEJBYTNCLEtBQUs7NkJBRUwsS0FBSzt3QkFHTCxLQUFLOzRCQUdMLEtBQUs7aUNBR0wsS0FBSzsyQkFLTCxNQUFNOzBCQUtOLE1BQU07Z0NBR04sU0FBUyxTQUFDLGdCQUFnQjs7Ozs7OztJQXhCM0IsZ0RBQTZCOzs7OztJQUU3QixtREFDc0M7Ozs7O0lBRXRDLDhDQUNrQjs7Ozs7SUFFbEIsa0RBQytCOzs7OztJQUUvQix1REFDNEI7Ozs7O0lBSTVCLGlEQUM0Qzs7Ozs7SUFJNUMsZ0RBQ3NDOztJQUV0QyxzREFDb0M7Ozs7O0lBSXBDLHlDQUFlOzs7OztJQUlmLDZDQUFtQjs7Ozs7SUFJbkIsb0RBQStCOztJQUMvQix1REFBdUM7O0lBQ3ZDLDBDQUFpQjs7Ozs7SUFFYixrREFBOEMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb21wb25lbnQsIE9uSW5pdCwgT3V0cHV0LCBFdmVudEVtaXR0ZXIsIFZpZXdDaGlsZCwgVGVtcGxhdGVSZWYsIElucHV0IH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IFNlbGVjdGFibGVTZXR0aW5ncyB9IGZyb20gJ0Bwcm9ncmVzcy9rZW5kby1hbmd1bGFyLWdyaWQnO1xyXG5pbXBvcnQgeyBTeXNGdW5jT3BlcmF0aW9uU2VydmljZSB9IGZyb20gJy4uL3NlcnZpY2Uvc3lzLWZ1bmMtb3BlcmF0aW9uLnNlcnZpY2UnO1xyXG5cclxuLyoqXHJcbiAqIOezu+e7n+euoeeQhu+8muWKn+iDveaTjeS9nOW3puagkeacieOAgeWPs+WIl+ihqOWxleekulxyXG4gKi9cclxuQENvbXBvbmVudCh7XHJcbiAgICBzZWxlY3RvcjogJ2FwcC1zeXMtZnVuYy1vcGVyYXRpb24nLFxyXG4gICAgdGVtcGxhdGVVcmw6ICcuL3N5cy1mdW5jLW9wZXJhdGlvbi5jb21wb25lbnQuaHRtbCcsXHJcbiAgICBzdHlsZVVybHM6IFsnLi9zeXMtZnVuYy1vcGVyYXRpb24uY29tcG9uZW50LmNzcyddXHJcbn0pXHJcbmV4cG9ydCBjbGFzcyBTeXNGdW5jT3BlcmF0aW9uQ29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0IHtcclxuXHJcbiAgICAvKirkuJrliqHlr7nosaEs6LSf6LSj5Lyg6YCSICovXHJcbiAgICBASW5wdXQoKSBiaXpPYmplY3RJZDogc3RyaW5nO1xyXG4gICAgLyoq6YCJ5oup5qih5byPICovXHJcbiAgICBASW5wdXQoKVxyXG4gICAgZ3JpZFNlbGVjdE1vZGU6ICdzaW5nbGUnIHwgJ211bHRpcGxlJztcclxuICAgIC8qKnNlc3Npb25JZCAqL1xyXG4gICAgQElucHV0KClcclxuICAgIHNlc3Npb25JZDogc3RyaW5nO1xyXG4gICAgLyoq5piv5ZCm5Y+q5pi+56S65YiG57uEICovXHJcbiAgICBASW5wdXQoKVxyXG4gICAgb25seVNob3dHcm91cDogYm9vbGVhbiA9IGZhbHNlO1xyXG4gICAgLyoq5YiG57uE6IO95ZCm6KKr6YCJ5oupICovXHJcbiAgICBASW5wdXQoKVxyXG4gICAgaXNHcm91cENhblNlbGVjdGVkOiBib29sZWFuO1xyXG4gICAgLyoqXHJcbiAgICAgKiDnoa7orqTkuovku7ZcclxuICAgICAqL1xyXG4gICAgQE91dHB1dCgpXHJcbiAgICBhZnRlckNvbmZpcm0gPSBuZXcgRXZlbnRFbWl0dGVyPG9iamVjdFtdPigpO1xyXG4gICAgLyoqXHJcbiAgICAgKiDlhbPpl63kuovku7ZcclxuICAgICAqL1xyXG4gICAgQE91dHB1dCgpXHJcbiAgICBhZnRlckNhbmNsZSA9IG5ldyBFdmVudEVtaXR0ZXI8YW55PigpO1xyXG4gICAgLy8g5rOo5YWl5Yiw5biu5Yqp55qE56Gu6K6k5ZKM5Y+W5raI5oyJ6ZKuXHJcbiAgICBAVmlld0NoaWxkKCdidG5Pa0FuZENhbmNsZScpXHJcbiAgICBidG5Pa0FuZENhbmNsZVJlZjogVGVtcGxhdGVSZWY8YW55PjtcclxuICAgIC8qKlxyXG4gICAgICog5Yqf6IO95pON5L2c5YWo6YeP5pWw5o2uXHJcbiAgICAgKi9cclxuICAgIGRhdGE6IG9iamVjdFtdO1xyXG4gICAgLyoqXHJcbiAgICAgKiDlvZPliY1VSeaYvuekuuWKqOiDveaTjeS9nOWIl+ihqOaVsOaNrlxyXG4gICAgICovXHJcbiAgICBncmlkRGF0YTogb2JqZWN0W107XHJcbiAgICAvKipcclxuICAgICAqIOW9k+WJjemAieS4reaVsOaNrlxyXG4gICAgICovXHJcbiAgICBjdXJTZWxlY3RlZEtleXM6IHN0cmluZ1tdID0gW107XHJcbiAgICBzZWxlY3RhYmxlU2V0dGluZ3M6IFNlbGVjdGFibGVTZXR0aW5ncztcclxuICAgIHRpdGxlID0gJ+WKn+iDveaTjeS9nOW4ruWKqSc7XHJcbiAgICBjb25zdHJ1Y3RvciAoXHJcbiAgICAgICAgcHJpdmF0ZSBmdW5jT3BTZXJ2aWNlOiBTeXNGdW5jT3BlcmF0aW9uU2VydmljZVxyXG4gICAgKSB7XHJcbiAgICB9XHJcblxyXG4gICAgbmdPbkluaXQgKCkge31cclxuXHJcbiAgIGxvYWREYXRhICgpIHtcclxuICAgICAgICB0aGlzLnNlbGVjdGFibGVTZXR0aW5ncyA9IHtcclxuICAgICAgICAgICAgY2hlY2tib3hPbmx5OiB0cnVlLFxyXG4gICAgICAgICAgICAvLyDpu5jorqTljZXpgIlcclxuICAgICAgICAgICAgbW9kZTogIXRoaXMuZ3JpZFNlbGVjdE1vZGUgPyAnc2luZ2xlJyA6IHRoaXMuZ3JpZFNlbGVjdE1vZGUsXHJcbiAgICAgICAgICAgIGVuYWJsZWQ6IHRydWVcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMuZnVuY09wU2VydmljZS5nZXRGdW5jT3BlcmF0aW9ucygpLnN1YnNjcmliZShyZXMgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLmRhdGEgPSBbXTtcclxuICAgICAgICAgICAgY29uc3QgZnVuY0xpc3Q6IGFueVtdID0gcmVzO1xyXG4gICAgICAgICAgICBpZiAodGhpcy5vbmx5U2hvd0dyb3VwKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmRhdGEgPSBmdW5jTGlzdC5maWx0ZXIoaXRlbSA9PiBpdGVtLnR5cGUgPT0gMCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmRhdGEgPSBmdW5jTGlzdDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvLyBmdW5jTGlzdC5mb3JFYWNoKGl0ZW0gPT4ge1xyXG4gICAgICAgICAgICAvLyAgICAgdGhpcy5kYXRhLnB1c2goaXRlbSk7XHJcbiAgICAgICAgICAgIC8vICAgICAvLyDlpoLmnpzmnInmmI7nu4boioLngrlcclxuICAgICAgICAgICAgLy8gICAgIGlmICh0aGlzLm9ubHlTaG93R3JvdXAgPT09IGZhbHNlICYmIGl0ZW1bJ2NoaWxkcmVuJ10gIT09IG51bGwgJiYgaXRlbVsnY2hpbGRyZW4nXS5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIC8vICAgICAgICAgaXRlbVsnY2hpbGRyZW4nXS5mb3JFYWNoKGNoaWxkID0+IHRoaXMuZGF0YS5wdXNoKGNoaWxkKSk7XHJcbiAgICAgICAgICAgIC8vICAgICB9XHJcbiAgICAgICAgICAgIC8vIH0pO1xyXG4gICAgICAgICAgICB0aGlzLmdyaWREYXRhID0gW107XHJcbiAgICAgICAgICAgIC8vIOWkjeWItuS4gOS7vVxyXG4gICAgICAgICAgICB0aGlzLmdyaWREYXRhID0gdGhpcy5kYXRhLmNvbmNhdCgpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgICAgIGVycm9yID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCfojrflj5blip/og73mk43kvZzlr7nosaHliJfooajlpLHotKUnKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDmkJzntKJcclxuICAgICAqIEBwYXJhbSBmaWx0ZXJWYWx1ZSDmn6Xor6LmnaHku7ZcclxuICAgICAqL1xyXG4gICAgc2VhcmNoRGF0YSAoZmlsdGVyVmFsdWU6IHN0cmluZykge1xyXG4gICAgICAgIC8vIOa1i+ivlVxyXG4gICAgICAgIGlmIChmaWx0ZXJWYWx1ZSA9PT0gbnVsbCB8fCBmaWx0ZXJWYWx1ZSA9PT0gJycpIHtcclxuICAgICAgICAgICAgLy8g5YWo6YeP55qE5pWw5o2uXHJcbiAgICAgICAgICAgIHRoaXMuZ3JpZERhdGEgPSB0aGlzLmRhdGEuY29uY2F0KCk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgZmlsdGVyID0gZmlsdGVyVmFsdWUudG9Mb3dlckNhc2UoKTtcclxuICAgICAgICAvLyDmkJzntKLliLDkuIrnuqfml7ZcclxuICAgICAgICB0aGlzLmdyaWREYXRhID0gdGhpcy5kYXRhLmZpbHRlcihpdGVtID0+XHJcbiAgICAgICAgICAgIGl0ZW1bJ2NvZGUnXS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKGZpbHRlcikgfHxcclxuICAgICAgICAgICAgaXRlbVsnbmFtZSddLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoZmlsdGVyKSB8fFxyXG4gICAgICAgICAgICB0aGlzLmdldEZ1bmNHcm91cChpdGVtKS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKGZpbHRlcikpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog5Lia5Yqh5a+56LGh5Y+Y5YyW5ZCOXHJcbiAgICAgKiBAcGFyYW0gYXJnIOS4muWKoeWvueixoeWPguaVsFxyXG4gICAgICovXHJcbiAgICBiaXpPYmplY3RDaGFuZ2VkIChhcmc6IGFueSkge1xyXG4gICAgICAgIGlmICghdGhpcy5kYXRhIHx8IHRoaXMuZGF0YS5sZW5ndGggPT09IDApIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCBidXNJZCA9IGFyZztcclxuICAgICAgICAvLyDmoLnmja7kuJrliqHlr7nosaHov4fmu6RcclxuICAgICAgICB0aGlzLmdyaWREYXRhID0gdGhpcy5kYXRhLmZpbHRlcihpdGVtID0+XHJcbiAgICAgICAgICAgIGl0ZW1bJ2J1c2luZXNzSWQnXSA9PT0gYnVzSWQpO1xyXG4gICAgfVxyXG5cclxuXHJcbiAgICAvKipcclxuICAgICAqIOiOt+WPluWKn+iDveWIhue7hFxyXG4gICAgICovXHJcbiAgICBnZXRGdW5jR3JvdXAgKGZ1bmNPcE9iajogYW55KTogc3RyaW5nIHtcclxuICAgICAgICAvLyDojrflj5bniLboioLngrlcclxuICAgICAgICBjb25zdCBwYXJlbnRJZCA9IGZ1bmNPcE9ialsncGFyZW50SWQnXTtcclxuICAgICAgICBpZiAocGFyZW50SWQgIT09IG51bGwgJiYgcGFyZW50SWQgIT09IHVuZGVmaW5lZCAmJiBwYXJlbnRJZCAhPT0gJycpIHtcclxuICAgICAgICAgICAgY29uc3QgcGFyZW50T2JqID0gdGhpcy5kYXRhLmZpbHRlcihpdGVtID0+IGl0ZW1bJ2lkJ10gPT09IHBhcmVudElkKTtcclxuICAgICAgICAgICAgaWYgKHBhcmVudE9iaiAhPT0gbnVsbCAmJiBwYXJlbnRPYmoubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHBhcmVudE9ialswXVsnbmFtZSddO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuICfml6AnO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOiOt+WPlumAieS4reaVsOaNrlxyXG4gICAgICovXHJcbiAgICBnZXRTZWxlY3RlZE9iamVjdCAoKTogYW55IHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSB0aGlzLmRhdGEuZmlsdGVyKGl0ZW0gPT5cclxuICAgICAgICAgICAgdGhpcy5jdXJTZWxlY3RlZEtleXMuZmluZEluZGV4KHNlbGVjdCA9PiBzZWxlY3QgPT09IGl0ZW1bJ2lkJ10pID49IDApO1xyXG4gICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDnoa7orqRcclxuICAgICAqL1xyXG4gICAgY29uZmlybSAoKSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gdGhpcy5nZXRTZWxlY3RlZE9iamVjdCgpO1xyXG4gICAgICAgIHRoaXMuYWZ0ZXJDb25maXJtLm5leHQocmVzdWx0KTtcclxuICAgICAgICAvLyDlj5bmtogt55uu55qE5piv5Zyo6L+Z6YeM6K6p5qih5oCB5qGG5raI5aSxXHJcbiAgICAgICAgdGhpcy5jYW5jbGUoKTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICog5Y+W5raIXHJcbiAgICAgKi9cclxuICAgIGNhbmNsZSAoKSB7XHJcbiAgICAgICAgdGhpcy5hZnRlckNhbmNsZS5uZXh0KCk7XHJcbiAgICB9XHJcbn1cclxuXHJcbiJdfQ==