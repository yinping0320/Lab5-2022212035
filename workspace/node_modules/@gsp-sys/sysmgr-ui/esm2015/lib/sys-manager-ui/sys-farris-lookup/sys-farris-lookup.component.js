/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, Input, Output, EventEmitter, ViewChild } from '@angular/core';
import { userHelp, posHelp, roleHelp } from '../help-meta/sys-help-meta';
import { SysCommonUtilService } from '@gsp-sys/sysmgr-common';
import { ServerSideToken, LookupGridComponent } from '@farris/ui-lookup';
import { SysFarrisLookupService } from '../service/sys-farris-lookup.service';
import { of } from 'rxjs';
import { SysLocaleService } from '../../locale/sys-locale.service';
import { HELP_LOCALE_ZHCHS } from '../../locale/locales/zh-cn/help';
import { map } from 'rxjs/operators';
export class SysFarrisLookupComponent {
    /**
     * @param {?} sysUtil
     * @param {?} localService
     */
    constructor(sysUtil, localService) {
        this.sysUtil = sysUtil;
        this.localService = localService;
        /**
         * 宽度
         */
        this.width = 550;
        /**
         * 是否显示用户排序字段，WF使用
         */
        this.showUserOrderField = false;
        /**
         * 显示用户的单位信息，WF使用
         */
        this.showUserUnitInfo = false;
        /**
         * 只读
         */
        this.disabled = false;
        /**
         * 必填
         */
        this.required = true;
        /**
         * 打开帮助后是否有选中数据
         */
        this.enableToSelect = true;
        /**
         * 是否分页，默认true
         */
        this.pagination = true;
        /**
         * 首次加载第几页，默认1
         */
        this.pageIndex = 1;
        /**
         * 每页加载数，默认20
         */
        this.pageSize = 20;
        /**
         * 是否开始数据权限过滤
         */
        this.withPermission = false;
        /**
         * 启用关闭前事件
         */
        this.useBeforeCloseEvent = false;
        this.typeMode = 0;
        /**
         * 帮助选择后事件
         */
        this.afterConfirm = new EventEmitter();
        /**
         * 帮助选择后事件，会返回选中和删除的id
         */
        this.afterConfirmData = new EventEmitter();
        /**
         * 清空后事件-暂时不用
         */
        this.clear = new EventEmitter();
        /**
         * 关闭前-暂时不用
         */
        this.loadSuccessEvent = new EventEmitter();
        this.valueChangedEvent = new EventEmitter();
        this.selectDataEvent = new EventEmitter();
        this.dialogClosed = new EventEmitter();
        this.selectedData = [];
        this.farrisSelectedData = [];
        this.mapFields = { id: 'id', name: 'name' };
        /**
         * 帮助前事件,强行传递过滤条件
         */
        this.beforeOpen = (/**
         * @param {?} arg
         * @return {?}
         */
        (arg) => {
            if (!this.filter) {
                // 可能调用方不传递，识别为非空
                this.filter = {};
            }
            /**
             * WF使用，如果显示用户的单位信息，需要查询条件中增加如下标识，
             * 服务器端解析
             */
            if (this.showUserUnitInfo) {
                this.filter.queryMode = '0002';
            }
            this.filter.pageIndex = this.pageIndex;
            this.filter.pageSize = this.pageSize;
            this.allData.length = 0;
            this.farrisSelectedData = [];
            this.selectedData = [];
            if (this.bindingData != null && this.bindingData.id != null && this.bindingData.id != "") {
                this.selectedData = this.bindingData.id.split(',');
                this.selectedData.forEach((/**
                 * @param {?} item
                 * @return {?}
                 */
                item => {
                    this.farrisSelectedData.push({ "id": item });
                }));
            }
            // 把过滤数据和当前的数据传递到service层
            return of({
                showDialog: true, data: {
                    filter: this.filter,
                    allData: this.allData,
                    farrisSelectedData: this.farrisSelectedData
                }
            });
        });
        /**
         * 帮助关闭前事件,目前无论是否都会继续走afterOk映射事件
         */
        this.dictPicked = (/**
         * @param {?} arg
         * @return {?}
         */
        (arg) => {
            if (this.useBeforeCloseEvent && this.beforeClose) {
                return this.beforeClose(arg).pipe(map((/**
                 * @param {?} val
                 * @return {?}
                 */
                val => {
                    // 如果能关闭，调用后事件
                    if (val.closeDialog) {
                        this.afterConfirm.next(arg);
                    }
                    return val;
                })));
            }
            else {
                return of({ closeDialog: true });
            }
        });
        /**
         * 帮助映射后事件
         */
        this.afterOk = (/**
         * @param {?} helpdata
         * @param {?} mapfields
         * @return {?}
         */
        (helpdata, mapfields) => {
            if (this.useBeforeCloseEvent) {
                return;
            }
            if (this.typeMode && this.typeMode === 1) {
                if (!this.singleSelect) {
                    this.selectedData = this.selectedData.filter((/**
                     * @param {?} item
                     * @return {?}
                     */
                    item => {
                        if (this.allData.findIndex((/**
                         * @param {?} element
                         * @return {?}
                         */
                        element => {
                            if (item.hasOwnProperty("id")) {
                                return element.id === item.id;
                            }
                            else {
                                return element.id === item;
                            }
                        })) > -1) {
                            return true;
                        }
                        else {
                            return false;
                        }
                    }));
                    this.selectedData.forEach((/**
                     * @param {?} item
                     * @param {?} index
                     * @return {?}
                     */
                    (item, index) => {
                        if (!item.hasOwnProperty("id")) {
                            this.allData.forEach((/**
                             * @param {?} element
                             * @return {?}
                             */
                            element => {
                                if (element.id === item) {
                                    this.selectedData[index] = element;
                                }
                            }));
                        }
                    }));
                    helpdata = this.selectedData;
                }
            }
            if (helpdata) {
                // 多选的话需要处理,帮助已逗号为间隔
                if (!this.singleSelect) {
                    /** @type {?} */
                    const idList = helpdata.map((/**
                     * @param {?} item
                     * @return {?}
                     */
                    item => item.id));
                    /** @type {?} */
                    const nameList = helpdata.map((/**
                     * @param {?} item
                     * @return {?}
                     */
                    item => item.name));
                    /** @type {?} */
                    const nameStr = nameList.join();
                    /** @type {?} */
                    const idStr = idList.join();
                    this.displayTxt = nameStr;
                    this.bindingData.id = idStr;
                    this.bindingData.name = nameStr;
                }
                else {
                    this.displayTxt = helpdata.name;
                }
            }
            else { // 目前清空会走这里，而且两次
            }
            // 触发事件
            this.afterConfirm.next(helpdata);
            // this.afterConfirmData.next(this.selctedData);
        });
        this.onOkClick = (/**
         * @return {?}
         */
        () => {
            if (this.useBeforeCloseEvent) {
                return;
            }
            /** @type {?} */
            let helpdata;
            if (!this.selectedData || this.selectedData.length === 0) {
                if (this.singleSelect) {
                    this.afterConfirm.next(helpdata);
                }
                else {
                    this.afterConfirm.next([]);
                }
                this.farrisLookUp.closeDialog();
                return;
            }
            this.selectedData = this.selectedData.filter((/**
             * @param {?} item
             * @return {?}
             */
            item => {
                if (this.allData.findIndex((/**
                 * @param {?} element
                 * @return {?}
                 */
                element => {
                    if (item.hasOwnProperty("id")) {
                        return element.id === item.id;
                    }
                    else {
                        return element.id === item;
                    }
                })) > -1) {
                    return true;
                }
                else {
                    return false;
                }
            }));
            this.selectedData.forEach((/**
             * @param {?} item
             * @param {?} index
             * @return {?}
             */
            (item, index) => {
                if (!item.hasOwnProperty("id")) {
                    this.allData.forEach((/**
                     * @param {?} element
                     * @return {?}
                     */
                    element => {
                        if (element.id === item) {
                            this.selectedData[index] = element;
                        }
                    }));
                }
            }));
            helpdata = this.selectedData;
            if (helpdata && helpdata.length > 0) {
                // 多选的话需要处理,帮助已逗号为间隔
                if (!this.singleSelect) {
                    /** @type {?} */
                    const idList = helpdata.map((/**
                     * @param {?} item
                     * @return {?}
                     */
                    item => item.id));
                    /** @type {?} */
                    const nameList = helpdata.map((/**
                     * @param {?} item
                     * @return {?}
                     */
                    item => item.name));
                    /** @type {?} */
                    const nameStr = nameList.join();
                    /** @type {?} */
                    const idStr = idList.join();
                    this.displayTxt = nameStr;
                    this.bindingData.id = idStr;
                    this.bindingData.name = nameStr;
                    this.afterConfirm.next(helpdata);
                }
                else {
                    /** @type {?} */
                    let nameStr = helpdata[0].name;
                    this.displayTxt = nameStr;
                    this.afterConfirm.next(helpdata[0]);
                }
            }
            else { // 目前清空会走这里，而且两次
                this.afterConfirm.next(helpdata);
            }
            // 触发事件
            this.farrisLookUp.closeDialog();
        });
        this.selectedData = [];
    }
    /**
     * @return {?}
     */
    ngOnInit() {
        if (this.localService) {
            this.i18nRes = this.localService.getComponentOpt('help');
        }
        else {
            this.i18nRes = HELP_LOCALE_ZHCHS;
        }
        this.columns = [
            { title: this.i18nRes.codeField, field: 'code', searchField: 'code', width: '160' },
            { title: this.i18nRes.nameField, field: 'name', searchField: 'name', width: '200' },
        ];
        // 显示用户的单位路径信息，WF使用
        if (this.showUserUnitInfo) {
            this.width = 850;
            this.columns.push({ title: this.i18nRes.orgNamePathField, field: 'orgNamePath' });
            this.width = 850;
            this.columns.push({ title: this.i18nRes.orgName, field: 'sysOrgName' });
        }
        // 显示排序字段，WF使用
        if (this.showUserOrderField) {
            this.columns.push({ title: this.i18nRes.orderField, field: 'orderNum' });
        }
        // 初始化
        this.allData = [];
        // webapi初始
        switch (this.sourceType) {
            case 'position':
                this.dataUri = posHelp + this.sysUtil.positionWebApi;
                if (!this.title) {
                    this.title = this.i18nRes.positionTitle;
                }
                break;
            case 'role':
                this.dataUri = roleHelp + this.sysUtil.roleWebApi;
                if (!this.title) {
                    this.title = this.i18nRes.roleTitle;
                }
                break;
            case 'user':
            default:
                this.dataUri = userHelp + this.sysUtil.userWebApi;
                if (!this.title) {
                    this.title = this.i18nRes.userTitle;
                }
                break;
        }
        // 必须要有，否则初始选中不起作用
        this.farrisLookUp.mapFields = { id: 'id', name: 'name' };
        // 帮助关闭后事件
        this.farrisLookUp.dialogClosed.subscribe((/**
         * @param {?} val
         * @return {?}
         */
        val => {
            console.log(val);
            this.dialogClosed.next(val);
        }));
    }
    /**
     * 清空后
     * @param {?} arg
     * @return {?}
     */
    afterClear(arg) {
        this.clear.next(arg);
    }
    /**
     * 手动显示帮助
     * @return {?}
     */
    showHelp() {
        this.farrisLookUp.showDialog();
    }
    /**
     * @param {?} arg
     * @return {?}
     */
    oncheckedChange(arg) {
        if (this.singleSelect) {
            this.selectedData = [];
        }
        if (arg.isCheck) {
            arg.data.forEach((/**
             * @param {?} item
             * @return {?}
             */
            item => {
                if (this.selectedData.indexOf(item.id) === -1) {
                    this.selectedData.push(item);
                }
            }));
        }
        else {
            this.selectedData = this.selectedData.filter((/**
             * @param {?} item
             * @return {?}
             */
            item => {
                if (arg.data.findIndex((/**
                 * @param {?} element
                 * @return {?}
                 */
                element => { return item.hasOwnProperty("id") ? item.id === element.id : item === element.id; })) > -1) {
                    return false;
                }
                else {
                    return true;
                }
            }));
        }
    }
}
SysFarrisLookupComponent.decorators = [
    { type: Component, args: [{
                selector: 'sys-farris-grid-lookup',
                template: "<farris-lookup-grid #farrislookup\r\n    [disabled]=\"disabled\"\r\n    [editable]=\"false\"\r\n    [bindingData]=\"bindingData\"\r\n    [(ngModel)]=\"displayTxt\"\r\n    [columns]=\"columns\"\r\n    [singleSelect]=\"singleSelect\"\r\n    [title]=\"title\"\r\n    [displayType]=\"'List'\"\r\n    [uri]=\"dataUri\"\r\n    [idField]=\"'id'\"\r\n    [pageIndex]=\"pageIndex\"\r\n    [pageSize]=\"pageSize\"\r\n    [enableToSelect]=\"enableToSelect\"\r\n    [pagination]=\"pagination\"\r\n    [valueField]=\"'id'\" \r\n    [textField]=\"'name'\"\r\n    (clear)=\"afterClear($event)\"\r\n    [mapFields]=\"mapFields\"\r\n    [dictPicking]=\"beforeOpen\"\r\n    [dictPicked]=\"beforeClose\"\r\n    [mappingFn]= \"afterOk\"\r\n    [dialogWidth]=\"width\"\r\n    (checkedChange)=\"oncheckedChange($event)\"\r\n\r\n    [required]=\"required\"></farris-lookup-grid>\r\n\r\n    <!--\r\n        \u786E\u5B9A\u7684\u81EA\u5B9A\u4E49\u4E8B\u4EF6\uFF0C\u9700\u8981\u5220\u9664\r\n        [okHandler]=\"onOkClick\" -->\r\n\r\n",
                providers: [
                    { provide: ServerSideToken, useClass: SysFarrisLookupService }
                ],
                styles: [""]
            }] }
];
/** @nocollapse */
SysFarrisLookupComponent.ctorParameters = () => [
    { type: SysCommonUtilService },
    { type: SysLocaleService }
];
SysFarrisLookupComponent.propDecorators = {
    title: [{ type: Input }],
    width: [{ type: Input }],
    showUserOrderField: [{ type: Input }],
    showUserUnitInfo: [{ type: Input }],
    sourceType: [{ type: Input }],
    disabled: [{ type: Input }],
    required: [{ type: Input }],
    enableToSelect: [{ type: Input }],
    singleSelect: [{ type: Input }],
    pagination: [{ type: Input }],
    pageIndex: [{ type: Input }],
    pageSize: [{ type: Input }],
    displayTxt: [{ type: Input }],
    bindingData: [{ type: Input }],
    filter: [{ type: Input }],
    withPermission: [{ type: Input }],
    useBeforeCloseEvent: [{ type: Input }],
    beforeClose: [{ type: Input }],
    typeMode: [{ type: Input }],
    afterConfirm: [{ type: Output }],
    afterConfirmData: [{ type: Output }],
    clear: [{ type: Output }],
    loadSuccessEvent: [{ type: Output }],
    valueChangedEvent: [{ type: Output }],
    selectDataEvent: [{ type: Output }],
    dialogClosed: [{ type: Output }],
    farrisLookUp: [{ type: ViewChild, args: ['farrislookup',] }]
};
if (false) {
    /**
     * 标题
     * @type {?}
     */
    SysFarrisLookupComponent.prototype.title;
    /**
     * 宽度
     * @type {?}
     */
    SysFarrisLookupComponent.prototype.width;
    /**
     * 是否显示用户排序字段，WF使用
     * @type {?}
     */
    SysFarrisLookupComponent.prototype.showUserOrderField;
    /**
     * 显示用户的单位信息，WF使用
     * @type {?}
     */
    SysFarrisLookupComponent.prototype.showUserUnitInfo;
    /**
     * 取数源
     * @type {?}
     */
    SysFarrisLookupComponent.prototype.sourceType;
    /**
     * 只读
     * @type {?}
     */
    SysFarrisLookupComponent.prototype.disabled;
    /**
     * 必填
     * @type {?}
     */
    SysFarrisLookupComponent.prototype.required;
    /**
     * 打开帮助后是否有选中数据
     * @type {?}
     */
    SysFarrisLookupComponent.prototype.enableToSelect;
    /**
     * 是否单选
     * @type {?}
     */
    SysFarrisLookupComponent.prototype.singleSelect;
    /**
     * 是否分页，默认true
     * @type {?}
     */
    SysFarrisLookupComponent.prototype.pagination;
    /**
     * 首次加载第几页，默认1
     * @type {?}
     */
    SysFarrisLookupComponent.prototype.pageIndex;
    /**
     * 每页加载数，默认20
     * @type {?}
     */
    SysFarrisLookupComponent.prototype.pageSize;
    /**
     * 绑定到帮助上的数据，初始显示值用
     * @type {?}
     */
    SysFarrisLookupComponent.prototype.displayTxt;
    /**
     * 存储帮助选择的对象
     * @type {?}
     */
    SysFarrisLookupComponent.prototype.bindingData;
    /**
     * 过滤条件
     * @type {?}
     */
    SysFarrisLookupComponent.prototype.filter;
    /**
     * 是否开始数据权限过滤
     * @type {?}
     */
    SysFarrisLookupComponent.prototype.withPermission;
    /**
     * 启用关闭前事件
     * @type {?}
     */
    SysFarrisLookupComponent.prototype.useBeforeCloseEvent;
    /** @type {?} */
    SysFarrisLookupComponent.prototype.beforeClose;
    /** @type {?} */
    SysFarrisLookupComponent.prototype.typeMode;
    /**
     * 帮助选择后事件
     * @type {?}
     */
    SysFarrisLookupComponent.prototype.afterConfirm;
    /**
     * 帮助选择后事件，会返回选中和删除的id
     * @type {?}
     */
    SysFarrisLookupComponent.prototype.afterConfirmData;
    /**
     * 清空后事件-暂时不用
     * @type {?}
     */
    SysFarrisLookupComponent.prototype.clear;
    /**
     * 关闭前-暂时不用
     * @type {?}
     */
    SysFarrisLookupComponent.prototype.loadSuccessEvent;
    /** @type {?} */
    SysFarrisLookupComponent.prototype.valueChangedEvent;
    /** @type {?} */
    SysFarrisLookupComponent.prototype.selectDataEvent;
    /** @type {?} */
    SysFarrisLookupComponent.prototype.dialogClosed;
    /** @type {?} */
    SysFarrisLookupComponent.prototype.dataUri;
    /** @type {?} */
    SysFarrisLookupComponent.prototype.columns;
    /** @type {?} */
    SysFarrisLookupComponent.prototype.selectedData;
    /** @type {?} */
    SysFarrisLookupComponent.prototype.farrisSelectedData;
    /** @type {?} */
    SysFarrisLookupComponent.prototype.farrisLookUp;
    /** @type {?} */
    SysFarrisLookupComponent.prototype.mapFields;
    /**
     * 每次关闭前数据
     * @type {?}
     */
    SysFarrisLookupComponent.prototype.allData;
    /** @type {?} */
    SysFarrisLookupComponent.prototype.i18nRes;
    /**
     * 帮助前事件,强行传递过滤条件
     * @type {?}
     */
    SysFarrisLookupComponent.prototype.beforeOpen;
    /**
     * 帮助关闭前事件,目前无论是否都会继续走afterOk映射事件
     * @type {?}
     */
    SysFarrisLookupComponent.prototype.dictPicked;
    /**
     * 帮助映射后事件
     * @type {?}
     */
    SysFarrisLookupComponent.prototype.afterOk;
    /** @type {?} */
    SysFarrisLookupComponent.prototype.onOkClick;
    /** @type {?} */
    SysFarrisLookupComponent.prototype.sysUtil;
    /** @type {?} */
    SysFarrisLookupComponent.prototype.localService;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3lzLWZhcnJpcy1sb29rdXAuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGdzcC1zeXMvc3lzbWdyLXVpLyIsInNvdXJjZXMiOlsibGliL3N5cy1tYW5hZ2VyLXVpL3N5cy1mYXJyaXMtbG9va3VwL3N5cy1mYXJyaXMtbG9va3VwLmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7O0FBQ0EsT0FBTyxFQUFFLFNBQVMsRUFBVSxLQUFLLEVBQUUsTUFBTSxFQUFFLFlBQVksRUFBRSxTQUFTLEVBQVksTUFBTSxlQUFlLENBQUM7QUFDcEcsT0FBTyxFQUFFLFFBQVEsRUFBRSxPQUFPLEVBQUUsUUFBUSxFQUFFLE1BQU0sNEJBQTRCLENBQUM7QUFDekUsT0FBTyxFQUFFLG9CQUFvQixFQUFFLE1BQU0sd0JBQXdCLENBQUM7QUFDOUQsT0FBTyxFQUFFLGVBQWUsRUFBRSxtQkFBbUIsRUFBK0IsTUFBTSxtQkFBbUIsQ0FBQztBQUN0RyxPQUFPLEVBQUUsc0JBQXNCLEVBQUUsTUFBTSxzQ0FBc0MsQ0FBQztBQUk5RSxPQUFPLEVBQWMsRUFBRSxFQUFFLE1BQU0sTUFBTSxDQUFDO0FBQ3RDLE9BQU8sRUFBRSxnQkFBZ0IsRUFBRSxNQUFNLGlDQUFpQyxDQUFDO0FBQ25FLE9BQU8sRUFBRSxpQkFBaUIsRUFBRSxNQUFNLGlDQUFpQyxDQUFDO0FBQ3BFLE9BQU8sRUFBRSxHQUFHLEVBQVUsTUFBTSxnQkFBZ0IsQ0FBQztBQVc3QyxNQUFNLE9BQU8sd0JBQXdCOzs7OztJQWdFakMsWUFDVyxPQUE2QixFQUM3QixZQUE4QjtRQUQ5QixZQUFPLEdBQVAsT0FBTyxDQUFzQjtRQUM3QixpQkFBWSxHQUFaLFlBQVksQ0FBa0I7Ozs7UUE3RGhDLFVBQUssR0FBRyxHQUFHLENBQUM7Ozs7UUFFWix1QkFBa0IsR0FBRyxLQUFLLENBQUM7Ozs7UUFFM0IscUJBQWdCLEdBQUcsS0FBSyxDQUFDOzs7O1FBSXpCLGFBQVEsR0FBRyxLQUFLLENBQUM7Ozs7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QUFTLFNBQUMsY0FBYzs7Ozs7OztJQXhEekIseUNBQXVCOzs7OztJQUV2Qix5Q0FBcUI7Ozs7O0lBRXJCLHNEQUFvQzs7Ozs7SUFFcEMsb0RBQWtDOzs7OztJQUVsQyw4Q0FBa0Q7Ozs7O0lBRWxELDRDQUEwQjs7Ozs7SUFJMUIsNENBQXVCOzs7OztJQUl2QixrREFBNkI7Ozs7O0lBRTdCLGdEQUErQjs7Ozs7SUFFL0IsOENBQTJCOzs7OztJQUUzQiw2Q0FBdUI7Ozs7O0lBRXZCLDRDQUF1Qjs7Ozs7SUFFdkIsOENBQTRCOzs7OztJQUU1QiwrQ0FBbUQ7Ozs7O0lBRW5ELDBDQUF5RTs7Ozs7SUFFekUsa0RBQWdDOzs7OztJQUVoQyx1REFBcUM7O0lBQ3JDLCtDQUFvRTs7SUFDcEUsNENBQW9COzs7OztJQUVwQixnREFBb0U7Ozs7O0lBR3BFLG9EQUF3RTs7Ozs7SUFHeEUseUNBQTZEOzs7OztJQUU3RCxvREFBd0U7O0lBQ3hFLHFEQUF5RTs7SUFDekUsbURBQXVFOztJQUN2RSxnREFBb0U7O0lBQ3BFLDJDQUFnQjs7SUFDaEIsMkNBQWU7O0lBQ2YsZ0RBQXVCOztJQUN2QixzREFBNEI7O0lBQzVCLGdEQUFvRTs7SUFDcEUsNkNBQXVDOzs7OztJQUV2QywyQ0FBc0I7O0lBQ3RCLDJDQUFvQjs7Ozs7SUFnRXBCLDhDQWtDQzs7Ozs7SUFHRCw4Q0FZQzs7Ozs7SUFHRCwyQ0FtREM7O0lBaUNELDZDQThEQzs7SUFwUUcsMkNBQW9DOztJQUNwQyxnREFBcUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBmb3JFYWNoIH0gZnJvbSAnQGFuZ3VsYXIvcm91dGVyL3NyYy91dGlscy9jb2xsZWN0aW9uJztcclxuaW1wb3J0IHsgQ29tcG9uZW50LCBPbkluaXQsIElucHV0LCBPdXRwdXQsIEV2ZW50RW1pdHRlciwgVmlld0NoaWxkLCBPcHRpb25hbCB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyB1c2VySGVscCwgcG9zSGVscCwgcm9sZUhlbHAgfSBmcm9tICcuLi9oZWxwLW1ldGEvc3lzLWhlbHAtbWV0YSc7XHJcbmltcG9ydCB7IFN5c0NvbW1vblV0aWxTZXJ2aWNlIH0gZnJvbSAnQGdzcC1zeXMvc3lzbWdyLWNvbW1vbic7XHJcbmltcG9ydCB7IFNlcnZlclNpZGVUb2tlbiwgTG9va3VwR3JpZENvbXBvbmVudCwgUGlja2luZ1Jlc3VsdCwgUGlja2VkUmVzdWx0IH0gZnJvbSAnQGZhcnJpcy91aS1sb29rdXAnO1xyXG5pbXBvcnQgeyBTeXNGYXJyaXNMb29rdXBTZXJ2aWNlIH0gZnJvbSAnLi4vc2VydmljZS9zeXMtZmFycmlzLWxvb2t1cC5zZXJ2aWNlJztcclxuaW1wb3J0IHsgR3NwVXNlckZpbHRlciB9IGZyb20gJy4uL2ZpbHRlci9nc3AtdXNlci1maWx0ZXInO1xyXG5pbXBvcnQgeyBHc3BQb3NpdGlvbkZpbHRlciB9IGZyb20gJy4uL2ZpbHRlci9nc3AtcG9zaXRpb24tZmlsdGVyJztcclxuaW1wb3J0IHsgR3NwUm9sZUZpbHRlciB9IGZyb20gJy4uL2ZpbHRlci9nc3Atcm9sZS1maWx0ZXInO1xyXG5pbXBvcnQgeyBPYnNlcnZhYmxlLCBvZiB9IGZyb20gJ3J4anMnO1xyXG5pbXBvcnQgeyBTeXNMb2NhbGVTZXJ2aWNlIH0gZnJvbSAnLi4vLi4vbG9jYWxlL3N5cy1sb2NhbGUuc2VydmljZSc7XHJcbmltcG9ydCB7IEhFTFBfTE9DQUxFX1pIQ0hTIH0gZnJvbSAnLi4vLi4vbG9jYWxlL2xvY2FsZXMvemgtY24vaGVscCc7XHJcbmltcG9ydCB7IG1hcCwgZmlsdGVyIH0gZnJvbSAncnhqcy9vcGVyYXRvcnMnO1xyXG5pbXBvcnQgeyBlbGVtZW50IH0gZnJvbSAncHJvdHJhY3Rvcic7XHJcblxyXG5AQ29tcG9uZW50KHtcclxuICAgIHNlbGVjdG9yOiAnc3lzLWZhcnJpcy1ncmlkLWxvb2t1cCcsXHJcbiAgICB0ZW1wbGF0ZVVybDogJy4vc3lzLWZhcnJpcy1sb29rdXAuY29tcG9uZW50Lmh0bWwnLFxyXG4gICAgc3R5bGVVcmxzOiBbJy4vc3lzLWZhcnJpcy1sb29rdXAuY29tcG9uZW50LmNzcyddLFxyXG4gICAgcHJvdmlkZXJzOiBbXHJcbiAgICAgICAgeyBwcm92aWRlOiBTZXJ2ZXJTaWRlVG9rZW4sIHVzZUNsYXNzOiBTeXNGYXJyaXNMb29rdXBTZXJ2aWNlIH1cclxuICAgIF1cclxufSlcclxuZXhwb3J0IGNsYXNzIFN5c0ZhcnJpc0xvb2t1cENvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCB7XHJcblxyXG4gICAgLyoqIOagh+mimCAqL1xyXG4gICAgQElucHV0KCkgdGl0bGU6IHN0cmluZztcclxuICAgIC8qKuWuveW6piAqL1xyXG4gICAgQElucHV0KCkgd2lkdGggPSA1NTA7XHJcbiAgICAvKiog5piv5ZCm5pi+56S655So5oi35o6S5bqP5a2X5q6177yMV0bkvb/nlKggKi9cclxuICAgIEBJbnB1dCgpIHNob3dVc2VyT3JkZXJGaWVsZCA9IGZhbHNlO1xyXG4gICAgLyoqIOaYvuekuueUqOaIt+eahOWNleS9jeS/oeaBr++8jFdG5L2/55SoICovXHJcbiAgICBASW5wdXQoKSBzaG93VXNlclVuaXRJbmZvID0gZmFsc2U7XHJcbiAgICAvKiog5Y+W5pWw5rqQICovXHJcbiAgICBASW5wdXQoKSBzb3VyY2VUeXBlOiAndXNlcicgfCAncG9zaXRpb24nIHwgJ3JvbGUnO1xyXG4gICAgLyoqIOWPquivuyAqL1xyXG4gICAgQElucHV0KCkgZGlzYWJsZWQgPSBmYWxzZTtcclxuICAgIC8qKlxyXG4gICAgICog5b+F5aGrXHJcbiAgICAgKi9cclxuICAgIEBJbnB1dCgpIHJlcXVpcmVkPXRydWU7XHJcbiAgICAvKipcclxuICAgICAqIOaJk+W8gOW4ruWKqeWQjuaYr+WQpuaciemAieS4reaVsOaNrlxyXG4gICAgICovXHJcbiAgICBASW5wdXQoKSBlbmFibGVUb1NlbGVjdD10cnVlO1xyXG4gICAgLyoqIOaYr+WQpuWNlemAiSAqL1xyXG4gICAgQElucHV0KCkgc2luZ2xlU2VsZWN0OiBib29sZWFuO1xyXG4gICAgLyoqIOaYr+WQpuWIhumhte+8jOm7mOiupHRydWUgKi9cclxuICAgIEBJbnB1dCgpIHBhZ2luYXRpb24gPSB0cnVlO1xyXG4gICAgLyoqIOmmluasoeWKoOi9veesrOWHoOmhte+8jOm7mOiupDEgKi9cclxuICAgIEBJbnB1dCgpIHBhZ2VJbmRleCA9IDE7XHJcbiAgICAvKiog5q+P6aG15Yqg6L295pWw77yM6buY6K6kMjAgKi9cclxuICAgIEBJbnB1dCgpIHBhZ2VTaXplID0gMjA7XHJcbiAgICAvKiog57uR5a6a5Yiw5biu5Yqp5LiK55qE5pWw5o2u77yM5Yid5aeL5pi+56S65YC855SoICovXHJcbiAgICBASW5wdXQoKSBkaXNwbGF5VHh0OiBzdHJpbmc7XHJcbiAgICAvKiog5a2Y5YKo5biu5Yqp6YCJ5oup55qE5a+56LGhICovXHJcbiAgICBASW5wdXQoKSBiaW5kaW5nRGF0YTogeyBpZDogc3RyaW5nLCBuYW1lOiBzdHJpbmcgfTtcclxuICAgIC8qKiDov4fmu6TmnaHku7YgKi9cclxuICAgIEBJbnB1dCgpIGZpbHRlcjogR3NwVXNlckZpbHRlciB8IEdzcFBvc2l0aW9uRmlsdGVyIHwgR3NwUm9sZUZpbHRlciB8IGFueTtcclxuICAgIC8qKiDmmK/lkKblvIDlp4vmlbDmja7mnYPpmZDov4fmu6QgKi9cclxuICAgIEBJbnB1dCgpIHdpdGhQZXJtaXNzaW9uID0gZmFsc2U7XHJcbiAgICAvKiog5ZCv55So5YWz6Zet5YmN5LqL5Lu2ICovXHJcbiAgICBASW5wdXQoKSB1c2VCZWZvcmVDbG9zZUV2ZW50ID0gZmFsc2U7XHJcbiAgICBASW5wdXQoKSBiZWZvcmVDbG9zZTogKHNlbGVjdERhdGE6IGFueSkgPT4gT2JzZXJ2YWJsZTxQaWNrZWRSZXN1bHQ+O1xyXG4gICAgQElucHV0KCkgdHlwZU1vZGU9MDtcclxuICAgIC8qKiDluK7liqnpgInmi6nlkI7kuovku7YgKi9cclxuICAgIEBPdXRwdXQoKSBhZnRlckNvbmZpcm06IEV2ZW50RW1pdHRlcjxhbnk+ID0gbmV3IEV2ZW50RW1pdHRlcjxhbnk+KCk7XHJcblxyXG4gICAgLyoqIOW4ruWKqemAieaLqeWQjuS6i+S7tu+8jOS8mui/lOWbnumAieS4reWSjOWIoOmZpOeahGlkICovXHJcbiAgICBAT3V0cHV0KCkgYWZ0ZXJDb25maXJtRGF0YTogRXZlbnRFbWl0dGVyPGFueT4gPSBuZXcgRXZlbnRFbWl0dGVyPGFueT4oKTtcclxuXHJcbiAgICAvKiog5riF56m65ZCO5LqL5Lu2LeaaguaXtuS4jeeUqCAqL1xyXG4gICAgQE91dHB1dCgpIGNsZWFyOiBFdmVudEVtaXR0ZXI8YW55PiA9IG5ldyBFdmVudEVtaXR0ZXI8YW55PigpO1xyXG4gICAgLyoqIOWFs+mXreWJjS3mmoLml7bkuI3nlKggKi9cclxuICAgIEBPdXRwdXQoKSBsb2FkU3VjY2Vzc0V2ZW50OiBFdmVudEVtaXR0ZXI8YW55PiA9IG5ldyBFdmVudEVtaXR0ZXI8YW55PigpO1xyXG4gICAgQE91dHB1dCgpIHZhbHVlQ2hhbmdlZEV2ZW50OiBFdmVudEVtaXR0ZXI8YW55PiA9IG5ldyBFdmVudEVtaXR0ZXI8YW55PigpO1xyXG4gICAgQE91dHB1dCgpIHNlbGVjdERhdGFFdmVudDogRXZlbnRFbWl0dGVyPGFueT4gPSBuZXcgRXZlbnRFbWl0dGVyPGFueT4oKTtcclxuICAgIEBPdXRwdXQoKSBkaWFsb2dDbG9zZWQ6IEV2ZW50RW1pdHRlcjxhbnk+ID0gbmV3IEV2ZW50RW1pdHRlcjxhbnk+KCk7XHJcbiAgICBkYXRhVXJpOiBzdHJpbmc7XHJcbiAgICBjb2x1bW5zOiBhbnlbXTtcclxuICAgIHNlbGVjdGVkRGF0YSA6YW55W109W107XHJcbiAgICBmYXJyaXNTZWxlY3RlZERhdGE6YW55W109W107XHJcbiAgICBAVmlld0NoaWxkKCdmYXJyaXNsb29rdXAnKSBwdWJsaWMgZmFycmlzTG9va1VwOiBMb29rdXBHcmlkQ29tcG9uZW50O1xyXG4gICAgbWFwRmllbGRzID0geyBpZDogJ2lkJywgbmFtZTogJ25hbWUnIH07XHJcbiAgICAvKiog5q+P5qyh5YWz6Zet5YmN5pWw5o2uICovXHJcbiAgICBwdWJsaWMgYWxsRGF0YTogYW55W107XHJcbiAgICBwdWJsaWMgaTE4blJlczogYW55O1xyXG4gICAgY29uc3RydWN0b3IoXHJcbiAgICAgICAgcHVibGljIHN5c1V0aWw6IFN5c0NvbW1vblV0aWxTZXJ2aWNlLFxyXG4gICAgICAgIHB1YmxpYyBsb2NhbFNlcnZpY2U6IFN5c0xvY2FsZVNlcnZpY2VcclxuICAgICkge1xyXG4gICAgICAgIHRoaXMuc2VsZWN0ZWREYXRhID0gW107XHJcblxyXG4gICAgfVxyXG5cclxuICAgIG5nT25Jbml0KCkge1xyXG4gICAgICAgIGlmICh0aGlzLmxvY2FsU2VydmljZSkge1xyXG4gICAgICAgICAgICB0aGlzLmkxOG5SZXMgPSB0aGlzLmxvY2FsU2VydmljZS5nZXRDb21wb25lbnRPcHQoJ2hlbHAnKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLmkxOG5SZXMgPSBIRUxQX0xPQ0FMRV9aSENIUztcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5jb2x1bW5zID0gW1xyXG4gICAgICAgICAgICB7IHRpdGxlOiB0aGlzLmkxOG5SZXMuY29kZUZpZWxkLCBmaWVsZDogJ2NvZGUnLCBzZWFyY2hGaWVsZDogJ2NvZGUnLCB3aWR0aDogJzE2MCcgfSxcclxuICAgICAgICAgICAgeyB0aXRsZTogdGhpcy5pMThuUmVzLm5hbWVGaWVsZCwgZmllbGQ6ICduYW1lJywgc2VhcmNoRmllbGQ6ICduYW1lJywgd2lkdGg6ICcyMDAnIH0sXHJcbiAgICAgICAgXTtcclxuICAgICAgICAvLyDmmL7npLrnlKjmiLfnmoTljZXkvY3ot6/lvoTkv6Hmga/vvIxXRuS9v+eUqFxyXG4gICAgICAgIGlmICh0aGlzLnNob3dVc2VyVW5pdEluZm8pIHtcclxuICAgICAgICAgICAgdGhpcy53aWR0aCA9IDg1MDtcclxuICAgICAgICAgICAgdGhpcy5jb2x1bW5zLnB1c2goeyB0aXRsZTogdGhpcy5pMThuUmVzLm9yZ05hbWVQYXRoRmllbGQsIGZpZWxkOiAnb3JnTmFtZVBhdGgnIH0pO1xyXG4gICAgICAgICAgICB0aGlzLndpZHRoID0gODUwO1xyXG4gICAgICAgICAgICB0aGlzLmNvbHVtbnMucHVzaCh7IHRpdGxlOiB0aGlzLmkxOG5SZXMub3JnTmFtZSwgZmllbGQ6ICdzeXNPcmdOYW1lJyB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8g5pi+56S65o6S5bqP5a2X5q6177yMV0bkvb/nlKhcclxuICAgICAgICBpZiAodGhpcy5zaG93VXNlck9yZGVyRmllbGQpIHtcclxuICAgICAgICAgICAgdGhpcy5jb2x1bW5zLnB1c2goeyB0aXRsZTogdGhpcy5pMThuUmVzLm9yZGVyRmllbGQsIGZpZWxkOiAnb3JkZXJOdW0nIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyDliJ3lp4vljJZcclxuICAgICAgICB0aGlzLmFsbERhdGEgPSBbXTtcclxuICAgICAgICAvLyB3ZWJhcGnliJ3lp4tcclxuICAgICAgICBzd2l0Y2ggKHRoaXMuc291cmNlVHlwZSkge1xyXG4gICAgICAgICAgICBjYXNlICdwb3NpdGlvbic6XHJcbiAgICAgICAgICAgICAgICB0aGlzLmRhdGFVcmkgPSBwb3NIZWxwICsgdGhpcy5zeXNVdGlsLnBvc2l0aW9uV2ViQXBpO1xyXG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLnRpdGxlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy50aXRsZSA9IHRoaXMuaTE4blJlcy5wb3NpdGlvblRpdGxlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgJ3JvbGUnOlxyXG4gICAgICAgICAgICAgICAgdGhpcy5kYXRhVXJpID0gcm9sZUhlbHAgKyB0aGlzLnN5c1V0aWwucm9sZVdlYkFwaTtcclxuICAgICAgICAgICAgICAgIGlmICghdGhpcy50aXRsZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMudGl0bGUgPSB0aGlzLmkxOG5SZXMucm9sZVRpdGxlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgJ3VzZXInOlxyXG4gICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgdGhpcy5kYXRhVXJpID0gdXNlckhlbHAgKyB0aGlzLnN5c1V0aWwudXNlcldlYkFwaTtcclxuICAgICAgICAgICAgICAgIGlmICghdGhpcy50aXRsZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMudGl0bGUgPSB0aGlzLmkxOG5SZXMudXNlclRpdGxlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIOW/hemhu+imgeacie+8jOWQpuWImeWIneWni+mAieS4reS4jei1t+S9nOeUqFxyXG4gICAgICAgIHRoaXMuZmFycmlzTG9va1VwLm1hcEZpZWxkcyA9IHsgaWQ6ICdpZCcsIG5hbWU6ICduYW1lJyB9O1xyXG4gICAgICAgIC8vIOW4ruWKqeWFs+mXreWQjuS6i+S7tlxyXG4gICAgICAgIHRoaXMuZmFycmlzTG9va1VwLmRpYWxvZ0Nsb3NlZC5zdWJzY3JpYmUodmFsID0+IHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2codmFsKTtcclxuICAgICAgICAgICAgdGhpcy5kaWFsb2dDbG9zZWQubmV4dCh2YWwpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKiDluK7liqnliY3kuovku7Ys5by66KGM5Lyg6YCS6L+H5ruk5p2h5Lu2ICovXHJcbiAgICBiZWZvcmVPcGVuID0gKGFyZykgPT4ge1xyXG4gICAgICAgIGlmICghdGhpcy5maWx0ZXIpIHtcclxuICAgICAgICAgICAgLy8g5Y+v6IO96LCD55So5pa55LiN5Lyg6YCS77yM6K+G5Yir5Li66Z2e56m6XHJcbiAgICAgICAgICAgIHRoaXMuZmlsdGVyID0ge307XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIFdG5L2/55So77yM5aaC5p6c5pi+56S655So5oi355qE5Y2V5L2N5L+h5oGv77yM6ZyA6KaB5p+l6K+i5p2h5Lu25Lit5aKe5Yqg5aaC5LiL5qCH6K+G77yMXHJcbiAgICAgICAgICog5pyN5Yqh5Zmo56uv6Kej5p6QXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgaWYgKHRoaXMuc2hvd1VzZXJVbml0SW5mbykge1xyXG4gICAgICAgICAgICB0aGlzLmZpbHRlci5xdWVyeU1vZGUgPSAnMDAwMic7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuZmlsdGVyLnBhZ2VJbmRleCA9IHRoaXMucGFnZUluZGV4O1xyXG4gICAgICAgIHRoaXMuZmlsdGVyLnBhZ2VTaXplID0gdGhpcy5wYWdlU2l6ZTtcclxuICAgICAgICB0aGlzLmFsbERhdGEubGVuZ3RoID0gMDtcclxuICAgICAgICB0aGlzLmZhcnJpc1NlbGVjdGVkRGF0YSA9IFtdO1xyXG4gICAgICAgIHRoaXMuc2VsZWN0ZWREYXRhID0gW107XHJcblxyXG4gICAgICAgIGlmKHRoaXMuYmluZGluZ0RhdGEhPW51bGwmJnRoaXMuYmluZGluZ0RhdGEuaWQhPW51bGwmJnRoaXMuYmluZGluZ0RhdGEuaWQhPVwiXCIpe1xyXG4gICAgICAgICAgICB0aGlzLnNlbGVjdGVkRGF0YSA9IHRoaXMuYmluZGluZ0RhdGEuaWQuc3BsaXQoJywnKTtcclxuICAgICAgICAgICAgdGhpcy5zZWxlY3RlZERhdGEuZm9yRWFjaChpdGVtPT57XHJcbiAgICAgICAgICAgICAgICB0aGlzLmZhcnJpc1NlbGVjdGVkRGF0YS5wdXNoKHtcImlkXCI6aXRlbX0pO1xyXG5cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyDmiorov4fmu6TmlbDmja7lkozlvZPliY3nmoTmlbDmja7kvKDpgJLliLBzZXJ2aWNl5bGCXHJcbiAgICAgICAgcmV0dXJuIG9mKHtcclxuICAgICAgICAgICAgc2hvd0RpYWxvZzogdHJ1ZSwgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgZmlsdGVyOiB0aGlzLmZpbHRlcixcclxuICAgICAgICAgICAgICAgIGFsbERhdGE6IHRoaXMuYWxsRGF0YSxcclxuICAgICAgICAgICAgICAgIGZhcnJpc1NlbGVjdGVkRGF0YTp0aGlzLmZhcnJpc1NlbGVjdGVkRGF0YVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqIOW4ruWKqeWFs+mXreWJjeS6i+S7tiznm67liY3ml6DorrrmmK/lkKbpg73kvJrnu6fnu63otbBhZnRlck9r5pig5bCE5LqL5Lu2ICovXHJcbiAgICBkaWN0UGlja2VkID0gKGFyZzogYW55KTogT2JzZXJ2YWJsZTxQaWNrZWRSZXN1bHQ+ID0+IHtcclxuICAgICAgICBpZiAodGhpcy51c2VCZWZvcmVDbG9zZUV2ZW50ICYmIHRoaXMuYmVmb3JlQ2xvc2UpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuYmVmb3JlQ2xvc2UoYXJnKS5waXBlKG1hcCh2YWwgPT4ge1xyXG4gICAgICAgICAgICAgICAgLy8g5aaC5p6c6IO95YWz6Zet77yM6LCD55So5ZCO5LqL5Lu2XHJcbiAgICAgICAgICAgICAgICBpZiAodmFsLmNsb3NlRGlhbG9nKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5hZnRlckNvbmZpcm0ubmV4dChhcmcpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHZhbDtcclxuICAgICAgICAgICAgfSkpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiBvZih7IGNsb3NlRGlhbG9nOiB0cnVlIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvKiog5biu5Yqp5pig5bCE5ZCO5LqL5Lu2ICovXHJcbiAgICBhZnRlck9rID0gKGhlbHBkYXRhLCBtYXBmaWVsZHMpID0+IHtcclxuICAgICAgICBpZiAodGhpcy51c2VCZWZvcmVDbG9zZUV2ZW50KSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYodGhpcy50eXBlTW9kZSYmdGhpcy50eXBlTW9kZT09PTEpe1xyXG4gICAgICAgICAgICBpZighdGhpcy5zaW5nbGVTZWxlY3Qpe1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RlZERhdGEgPSB0aGlzLnNlbGVjdGVkRGF0YS5maWx0ZXIoaXRlbT0+e1xyXG4gICAgICAgICAgICAgICAgICAgIGlmKHRoaXMuYWxsRGF0YS5maW5kSW5kZXgoZWxlbWVudD0+e1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZihpdGVtLmhhc093blByb3BlcnR5KFwiaWRcIikpe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGVsZW1lbnQuaWQ9PT1pdGVtLmlkO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBlbGVtZW50LmlkPT09aXRlbTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0pPi0xKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICBcclxuICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWREYXRhLmZvckVhY2goKGl0ZW0saW5kZXgpPT57XHJcbiAgICAgICAgICAgICAgICAgICAgaWYoIWl0ZW0uaGFzT3duUHJvcGVydHkoXCJpZFwiKSl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYWxsRGF0YS5mb3JFYWNoKGVsZW1lbnQ9PntcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKGVsZW1lbnQuaWQ9PT1pdGVtKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGVkRGF0YVtpbmRleF0gPSBlbGVtZW50O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgaGVscGRhdGEgPSB0aGlzLnNlbGVjdGVkRGF0YTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKGhlbHBkYXRhKSB7XHJcbiAgICAgICAgICAgIC8vIOWkmumAieeahOivnemcgOimgeWkhOeQhizluK7liqnlt7LpgJflj7fkuLrpl7TpmpRcclxuICAgICAgICAgICAgaWYgKCF0aGlzLnNpbmdsZVNlbGVjdCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaWRMaXN0OiBzdHJpbmdbXSA9IGhlbHBkYXRhLm1hcChpdGVtID0+IGl0ZW0uaWQpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbmFtZUxpc3Q6IHN0cmluZ1tdID0gaGVscGRhdGEubWFwKGl0ZW0gPT4gaXRlbS5uYW1lKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG5hbWVTdHIgPSBuYW1lTGlzdC5qb2luKCk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpZFN0ciA9IGlkTGlzdC5qb2luKCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmRpc3BsYXlUeHQgPSBuYW1lU3RyO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5iaW5kaW5nRGF0YS5pZCA9IGlkU3RyO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5iaW5kaW5nRGF0YS5uYW1lID0gbmFtZVN0cjtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZGlzcGxheVR4dCA9IGhlbHBkYXRhLm5hbWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Ugey8vIOebruWJjea4heepuuS8mui1sOi/memHjO+8jOiAjOS4lOS4pOasoVxyXG4gICAgICAgIH1cclxuICAgICAgICAvLyDop6blj5Hkuovku7ZcclxuICAgICAgICB0aGlzLmFmdGVyQ29uZmlybS5uZXh0KGhlbHBkYXRhKTtcclxuICAgICAgICAvLyB0aGlzLmFmdGVyQ29uZmlybURhdGEubmV4dCh0aGlzLnNlbGN0ZWREYXRhKTtcclxuICAgIH1cclxuXHJcbiAgICAvKiog5riF56m65ZCOICovXHJcbiAgICBhZnRlckNsZWFyIChhcmc6IGFueSkge1xyXG4gICAgICAgIHRoaXMuY2xlYXIubmV4dChhcmcpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKiDmiYvliqjmmL7npLrluK7liqkgKi9cclxuICAgIHB1YmxpYyBzaG93SGVscCgpIHtcclxuICAgICAgICB0aGlzLmZhcnJpc0xvb2tVcC5zaG93RGlhbG9nKCk7XHJcbiAgICB9XHJcblxyXG4gICAgb25jaGVja2VkQ2hhbmdlKGFyZzphbnkpeyBcclxuICAgICAgICBpZih0aGlzLnNpbmdsZVNlbGVjdCl7XHJcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWREYXRhPVtdO1xyXG4gICAgICAgIH0gICAgICAgXHJcbiAgICAgICAgaWYoYXJnLmlzQ2hlY2spe1xyXG4gICAgICAgICAgICBhcmcuZGF0YS5mb3JFYWNoKGl0ZW09PntcclxuICAgICAgICAgICAgICAgIGlmKHRoaXMuc2VsZWN0ZWREYXRhLmluZGV4T2YoaXRlbS5pZCk9PT0tMSl7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RlZERhdGEucHVzaChpdGVtKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWREYXRhID0gdGhpcy5zZWxlY3RlZERhdGEuZmlsdGVyKGl0ZW09PntcclxuICAgICAgICAgICAgICAgIGlmKGFyZy5kYXRhLmZpbmRJbmRleChlbGVtZW50PT57cmV0dXJuIGl0ZW0uaGFzT3duUHJvcGVydHkoXCJpZFwiKT9pdGVtLmlkPT09ZWxlbWVudC5pZDppdGVtPT09ZWxlbWVudC5pZH0pPi0xKXtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIG9uT2tDbGljaz0oKT0+e1xyXG4gICAgICAgIGlmICh0aGlzLnVzZUJlZm9yZUNsb3NlRXZlbnQpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBsZXQgaGVscGRhdGEgOmFueTtcclxuICAgICAgICBpZighdGhpcy5zZWxlY3RlZERhdGF8fHRoaXMuc2VsZWN0ZWREYXRhLmxlbmd0aD09PTApe1xyXG4gICAgICAgICAgICBpZih0aGlzLnNpbmdsZVNlbGVjdCl7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmFmdGVyQ29uZmlybS5uZXh0KGhlbHBkYXRhKTtcclxuICAgICAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmFmdGVyQ29uZmlybS5uZXh0KFtdKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLmZhcnJpc0xvb2tVcC5jbG9zZURpYWxvZygpO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLnNlbGVjdGVkRGF0YSA9IHRoaXMuc2VsZWN0ZWREYXRhLmZpbHRlcihpdGVtPT57XHJcbiAgICAgICAgICAgIGlmKHRoaXMuYWxsRGF0YS5maW5kSW5kZXgoZWxlbWVudD0+e1xyXG4gICAgICAgICAgICAgICAgaWYoaXRlbS5oYXNPd25Qcm9wZXJ0eShcImlkXCIpKXtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZWxlbWVudC5pZD09PWl0ZW0uaWQ7XHJcbiAgICAgICAgICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZWxlbWVudC5pZD09PWl0ZW07XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pPi0xKXtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICB0aGlzLnNlbGVjdGVkRGF0YS5mb3JFYWNoKChpdGVtLGluZGV4KT0+e1xyXG4gICAgICAgICAgICBpZighaXRlbS5oYXNPd25Qcm9wZXJ0eShcImlkXCIpKXtcclxuICAgICAgICAgICAgICAgIHRoaXMuYWxsRGF0YS5mb3JFYWNoKGVsZW1lbnQ9PntcclxuICAgICAgICAgICAgICAgICAgICBpZihlbGVtZW50LmlkPT09aXRlbSl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWREYXRhW2luZGV4XSA9IGVsZW1lbnQ7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGhlbHBkYXRhID0gdGhpcy5zZWxlY3RlZERhdGE7XHJcblxyXG4gICAgICAgIGlmIChoZWxwZGF0YSYmaGVscGRhdGEubGVuZ3RoPjApIHtcclxuICAgICAgICAgICAgLy8g5aSa6YCJ55qE6K+d6ZyA6KaB5aSE55CGLOW4ruWKqeW3sumAl+WPt+S4uumXtOmalFxyXG4gICAgICAgICAgICBpZiAoIXRoaXMuc2luZ2xlU2VsZWN0KSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpZExpc3Q6IHN0cmluZ1tdID0gaGVscGRhdGEubWFwKGl0ZW0gPT4gaXRlbS5pZCk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBuYW1lTGlzdDogc3RyaW5nW10gPSBoZWxwZGF0YS5tYXAoaXRlbSA9PiBpdGVtLm5hbWUpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbmFtZVN0ciA9IG5hbWVMaXN0LmpvaW4oKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGlkU3RyID0gaWRMaXN0LmpvaW4oKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuZGlzcGxheVR4dCA9IG5hbWVTdHI7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmJpbmRpbmdEYXRhLmlkID0gaWRTdHI7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmJpbmRpbmdEYXRhLm5hbWUgPSBuYW1lU3RyO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5hZnRlckNvbmZpcm0ubmV4dChoZWxwZGF0YSk7XHJcblxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgbGV0IG5hbWVTdHIgPSBoZWxwZGF0YVswXS5uYW1lO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5kaXNwbGF5VHh0ID0gbmFtZVN0cjtcclxuICAgICAgICAgICAgICAgIHRoaXMuYWZ0ZXJDb25maXJtLm5leHQoaGVscGRhdGFbMF0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIHsvLyDnm67liY3muIXnqbrkvJrotbDov5nph4zvvIzogIzkuJTkuKTmrKFcclxuICAgICAgICAgICAgdGhpcy5hZnRlckNvbmZpcm0ubmV4dChoZWxwZGF0YSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIOinpuWPkeS6i+S7tlxyXG4gICAgICAgIHRoaXMuZmFycmlzTG9va1VwLmNsb3NlRGlhbG9nKCk7XHJcbiAgICB9XHJcblxyXG59XHJcblxyXG4iXX0=