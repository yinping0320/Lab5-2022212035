!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@farris/ui-messager"),require("@farris/ui-modal"),require("rxjs"),require("@angular/core"),require("@angular/common"),require("@gsp-svc/file-viewer"),require("@angular/forms")):"function"==typeof define&&define.amd?define("@gsp-wf/wf-approval-logs",["exports","@farris/ui-messager","@farris/ui-modal","rxjs","@angular/core","@angular/common","@gsp-svc/file-viewer","@angular/forms"],t):t((e["gsp-wf"]=e["gsp-wf"]||{},e["gsp-wf"]["wf-approval-logs"]={}),e.uiMessager,e.uiModal,e.rxjs,e.ng.core,e.ng.common,e.fileViewer,e.ng.forms)}(this,function(e,t,o,r,n,i,a,s){"use strict";var p={"zh-CHS":{"static":{approvalLogs:{title:"审批记录",approvalOpinion:"审批意见",startTime:"接收时间",endTime:"处理时间",processTime:"处理时长",todo:"待办理",done:"已办理",undo:"未分配",toAssign:"未指派",toRead:"待阅",processNotFound:"流程实例ID为空",workItemNotFound:"工作项ID为空",attachment:"附件",noResolvedUser:"未解析出用户",terminal:"来自",web:"电脑端",mobile:"移动端",submit:"已提交"},flowchart:{title:"查看流程",processNotFound:"流程实例ID为空"}}},en:{"static":{approvalLogs:{title:"Approval Logs",approvalOpinion:"Approval opinion",startTime:"StartTime",endTime:"EndTime",processTime:"ProcessTime",todo:"Todo",done:"Done",undo:"Undo",toAssign:"To assign",toRead:"To read",processNotFound:"process instance id is null",workItemNotFound:"work item id is null",attachment:"attachment",noResolvedUser:"No Resolved User",terminal:"From",web:"Web",mobile:"Mobile",submit:"Submit"},flowchart:{title:"Flow Chart",processNotFound:"process instance id is null"}}},"zh-CHT":{"static":{approvalLogs:{title:"審批記錄",approvalOpinion:"審批意見",startTime:"接收時間",endTime:"處理時間",processTime:"處理時長",todo:"待辦理",done:"已辦理",undo:"未分配",toAssign:"未指派",toRead:"待阅",processNotFound:"流程實例ID為空",workItemNotFound:"工作項ID為空",attachment:"附件",noResolvedUser:"未解析出用戶",terminal:"來自",web:"電腦端",mobile:"移動端",submit:"已提交"},flowchart:{title:"查看流程",processNotFound:"流程實例ID為空"}}}},l=(Object.defineProperty(d.prototype,"DataId",{set:function(e){e&&(this.dataId=e,this.dataIdSubStr=e.substring(0,5),this.getTaskLogs())},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"ProcInstId",{set:function(e){e&&(this.procInstId=e,this.getTaskLogs())},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"ActivityDefinitionId",{set:function(e){e&&this.getTaskLogs(e)},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"IfForecast",{set:function(e){e&&(this.ifForecast="true"==e,this.getTaskLogs())},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"Type",{set:function(e){"process"!=e&&"activity"!=e||this.type==e||"process"===(this.type=e)&&this.getTaskLogs()},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"processForecastPayload",{set:function(e){e&&(this.ifForecast=!0,this.getTaskLogs("",e))},enumerable:!0,configurable:!0}),d.prototype.ngOnInit=function(){},d.prototype.fill=function(){this.cls="d-flex flex-fill h-100 f-utils-absolute-all px-4 py-3"},d.prototype.getTaskLogs=function(t,o){var r=this;(this.dataId||this.procInstId||o)&&System["import"]("/platform/runtime/wf/webapp/mobiletaskcenter/taskComment.js?v=20230602").then(function(){r.dataId?r.logContainer=window.document.querySelector(".dataId"+r.dataIdSubStr):r.logContainer=window.document.querySelector(".procInstId"+r.procInstId);var e={bizInstId:r.dataId,processInstanceId:r.procInstId,activityDefinitionId:t,container:r.logContainer,terminal:"web",typeId:"wf",ifForecast:r.ifForecast,showHeader:r.ShowHeader,showViewProcess:r.ShowViewProcess,wfForecastPayload:o,onlyIncludeCurrentProcInst:r.OnlyIncludeCurrentProcInst,isIncludeHistory:r.IncludeHistory,includeRetrieve:r.IncludeAdminOperate,includeAdminOperate:r.IncludeAdminOperate};r.Style&&"datagrid"==r.Style?window.gspTaskCenterBizLog.ApprovalLogUtil.getWebHtml(e).then(function(e){}):window.gspTaskCenterBizLog.ApprovalLogUtil.getWebLogsHtml(e).then(function(e){})})},d.prototype.ifShowOperateLogChange=function(){this.getTaskLogs()},d.prototype.i18nTranslate=function(e){var t=localStorage.getItem("languageCode"),o={"zh-CHS":{showOperateLog:"显示操作日志"},"zh-CHT":{showOperateLog:"顯示操作日誌"},en:{showOperateLog:"Show operate log"}},t=(t&&-1<["zh-CHS","zh-CHT","en"].indexOf(t)?o[t]:o["zh-CHS"])[e];return t},d.decorators=[{type:n.Component,args:[{selector:"wf-approval-logs",template:'<div\r\n  [class]="dataId ? \'dataId\' + dataIdSubStr : \'procInstId\' + procInstId"\r\n  style="width: 100%; height: 100%; overflow: auto"\r\n></div>\r\n\r\n<ng-template #taskDialogFooter>\r\n  <div style="display: flex; flex-grow: 1">\r\n    <div class="custom-control custom-checkbox custom-control-inline">\r\n      <input\r\n        type="checkbox"\r\n        class="custom-control-input"\r\n        [(ngModel)]="IncludeAdminOperate"\r\n        (ngModelChange)="ifShowOperateLogChange()"\r\n        id="taskShowOperateLog"\r\n        name="taskShowOperateLog"\r\n      />\r\n      <label class="custom-control-label" for="taskShowOperateLog">\r\n        {{ i18nTranslate("showOperateLog") }}\r\n      </label>\r\n    </div>\r\n  </div>\r\n</ng-template>\r\n',styles:[".approval-log-background{width:100%;background:#f9f9f9;padding:16px 14px;border-radius:4px}.log-activity-name{font-size:14px}.receive-time{font-size:12px;-moz-columns:#565656;columns:#565656;padding-left:40px;white-space:nowrap;color:#a1a1a1}.log-creator-name{font-size:14px;color:#4297fa;text-align:left}.log-action-name-do{font-size:12px;color:#fff;margin-left:40px;margin-right:16px;border-radius:10px;padding:2px 8px;background:#59a1ff;white-space:nowrap;float:right}.log-action-name-todo{font-size:12px;color:#fff;margin-left:40px;margin-right:16px;border-radius:10px;padding:2px 8px;background:#f59c24;white-space:nowrap;float:right}.log-action-name-undo{font-size:12px;color:#fff;margin-left:40px;margin-right:16px;border-radius:10px;padding:2px 8px;background:#5ac1c3;white-space:nowrap;float:right}.work-item-state-done{font-size:13px;border-radius:2px;padding:0 10px;background:#f6faff;margin-left:20px;color:#5f637a;border:1px solid #e6e6e6}.timeline-item{position:relative;padding:0 0 14px 10px;margin:0;font-size:14px;list-style:none}.timeline-item-tail{position:absolute;top:.75em;left:7px;height:100%;border-left:2px dashed #e8e8e8}.timeline-item-head-blue{position:absolute;width:16px;height:16px;background-color:#388fff;border:4px solid #bdd9ff;border-radius:100px;left:0;top:10px}.timeline-item-head-green{position:absolute;width:16px;height:16px;background-color:#5ac1c3;border:4px solid #7fffd4;border-radius:100px;left:0;top:10px}.timeline-item-head-yellow{position:absolute;width:16px;height:16px;background-color:#f59c24;border:4px solid #fbd7a7;border-radius:100px;left:0;top:10px}.timeline-item-content{position:relative;top:-6px;margin:0 0 0 18px}.user-avatar{height:30px;width:30px;border-radius:50%}li{list-style:none}.wf-docFile{flex-shrink:1;flex-grow:1;flex-basis:0;display:flex;flex-direction:row;align-items:flex-start;border-top:1px solid #f8f9fa;border-left:1px solid #f8f9fa}.wf-docFileIcon{width:20px;height:20px;line-height:20px;text-align:center;overflow:hidden;white-space:nowrap;padding:2px}.wf-docFileInfo{flex-shrink:1;flex-grow:1;flex-basis:0;padding:2px 6px 0 0;margin-left:0}.wf-docFileSize{font-size:11px;color:#888}.wf-doc-delete{margin:auto;font-size:18px;color:#f8f9fa}.attachment-delete:hover{color:#4297fa}.approval-log-message{font-size:14px;padding:10px 0 10px 40px}.approval-log-signature{padding-left:40px;display:flex;justify-content:flex-end}.approval-log-user-name{display:flex;align-items:center;justify-content:space-between;padding-top:14px}.log-attachment-array{padding-top:10px;padding-left:40px}.log-attachment-file-name{font-size:12px;color:#4297fa;float:left;cursor:pointer;margin-left:5px}"]}]}],d.ctorParameters=function(){return[]},d.propDecorators={cls:[{type:n.HostBinding,args:["class"]}],ShowHeader:[{type:n.Input}],ShowViewProcess:[{type:n.Input}],OnlyIncludeCurrentProcInst:[{type:n.Input}],IncludeAdminOperate:[{type:n.Input}],IncludeHistory:[{type:n.Input}],taskDialogFooter:[{type:n.ViewChild,args:["taskDialogFooter"]}],DataId:[{type:n.Input}],ProcInstId:[{type:n.Input}],ActivityDefinitionId:[{type:n.Input}],IfForecast:[{type:n.Input}],Type:[{type:n.Input}],processForecastPayload:[{type:n.Input}],Style:[{type:n.Input}]},d);function d(){this.ifForecast=!1,this.cls="",this.ShowHeader=!1,this.ShowViewProcess=!1,this.OnlyIncludeCurrentProcInst=!1,this.IncludeAdminOperate=!1,this.IncludeHistory=!1}f.prototype.showByProcInstId=function(e){e?this.showApprovalLog({procInstId:e}):console.error("查看审批记录，procInstId参数为空")},f.prototype.showByDataId=function(e){e?this.showApprovalLog({dataId:e}):console.error("查看审批记录，dataId参数为空")},f.prototype.showApprovalLog=function(e){var t=this.resolver.resolveComponentFactory(l).create(this.injector),e=(t.instance.DataId=e.dataId,t.instance.Style=e.style,t.instance.ProcInstId=e.procInstId,t.instance.IncludeAdminOperate=e.includeAdminOperate,t.instance.IncludeHistory=e.includeHistory,t.instance.fill(),{title:this.getI18nValue("static.approvalLogs.title"),width:"datagrid"==e.style?960:520,height:"datagrid"==e.style?500:520,showButtons:"datagrid"==e.style,buttons:t.instance.taskDialogFooter,beforeClose:this.beforeClose});this.dialog=this.modalService.show(t,e),this.addEventListener()},f.prototype.getI18nValue=function(e){var t;return e?(t=(t=localStorage.getItem("languageCode"))?p[t]:p["zh-CHS"],-1===e.indexOf(".")?t[e]:e.split(".").reduce(function(e,t){return e?e[t]:null},t)):""},f.prototype.addEventListener=function(){var t=this;window.addEventListener("message",function(e){-1<window.document.location.origin.search(e.origin)&&"TaskCloseLogDialog"==e.data&&t.dialog&&t.dialog.close()},!1)},f.prototype.beforeClose=function(e){return window.removeEventListener("message",function(){}),r.of(!0)},f.decorators=[{type:n.Injectable}],f.ctorParameters=function(){return[{type:t.MessagerService},{type:n.Injector},{type:n.ComponentFactoryResolver},{type:o.BsModalService}]};var c=f;function f(e,t,o,r){this.msgService=e,this.injector=t,this.resolver=o,this.modalService=r}g.prototype.transform=function(e,t){void 0===t&&(t="");e=this.getI18nValue(e);return e||t},g.prototype.getI18nValue=function(e){var t;return e?(t=(t=localStorage.getItem("languageCode"))?p[t]:p["zh-CHS"],-1===e.indexOf(".")?t[e]:e.split(".").reduce(function(e,t){return e?e[t]:null},t)):""},g.decorators=[{type:n.Pipe,args:[{name:"translate"}]}],g.ctorParameters=function(){return[]};var u=g;function g(){}m.decorators=[{type:n.NgModule,args:[{declarations:[l,u],imports:[i.CommonModule,a.FileListModule,s.FormsModule],providers:[c],exports:[l],entryComponents:[l]}]}];i=m;function m(){}e.WfApprovalLogsService=c,e.WfApprovalLogsComponent=l,e.WfApprovalLogsModule=i,e.ɵa=u,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=gsp-wf-wf-approval-logs.umd.min.js.map