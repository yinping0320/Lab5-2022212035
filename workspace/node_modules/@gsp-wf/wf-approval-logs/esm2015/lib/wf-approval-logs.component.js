/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, Input, HostBinding, ViewChild, TemplateRef } from '@angular/core';
export class WfApprovalLogsComponent {
    //样式，card 卡片版；datagrid 表格版
    constructor() {
        // 流程实例id
        this.ifForecast = false; // 是否预测日志
        //查看日志类型
        this.cls = ''; // 弹框显示时，增加样式
        // 弹框显示时，增加样式
        this.ShowHeader = false; //是否显示日志头部
        //是否显示日志头部
        this.ShowViewProcess = false; //是否显示查看流程按钮
        //是否显示查看流程按钮
        this.OnlyIncludeCurrentProcInst = false; //是否只包含当前流程的日志
        //是否只包含当前流程的日志
        this.IncludeAdminOperate = false; //是否显示操作日志
        //是否显示操作日志
        this.IncludeHistory = false; //是否包含历史日志
    }
    //日志容器
    /**
     * @param {?} dataId
     * @return {?}
     */
    set DataId(dataId) {
        if (dataId) {
            this.dataId = dataId;
            this.dataIdSubStr = dataId.substring(0, 5);
            this.getTaskLogs();
        }
    }
    /**
     * @param {?} procInstId
     * @return {?}
     */
    set ProcInstId(procInstId) {
        if (procInstId) {
            this.procInstId = procInstId;
            this.getTaskLogs();
        }
    }
    /**
     * @param {?} actDefId
     * @return {?}
     */
    set ActivityDefinitionId(actDefId) {
        if (actDefId) {
            this.getTaskLogs(actDefId);
        }
    }
    /**
     * @param {?} ifForecast
     * @return {?}
     */
    set IfForecast(ifForecast) {
        if (ifForecast) {
            this.ifForecast = ifForecast == 'true' ? true : false;
            this.getTaskLogs();
        }
    }
    /**
     * @param {?} type
     * @return {?}
     */
    set Type(type) {
        if ((type == 'process' || type == 'activity') && this.type != type) {
            this.type = type;
            if (type === 'process') { // type = 'process'查看流程日志；type = 'activity'，查看节点日志 sequence，转移线
                this.getTaskLogs();
            }
        }
    }
    /**
     * @param {?} payload
     * @return {?}
     */
    set processForecastPayload(payload) {
        if (payload) {
            this.ifForecast = true;
            this.getTaskLogs('', payload);
        }
    }
    /**
     * @return {?}
     */
    ngOnInit() {
        // this.getTaskLogs();
    }
    /**
     * @return {?}
     */
    fill() {
        this.cls = 'd-flex flex-fill h-100 f-utils-absolute-all px-4 py-3';
    }
    /**
     * @private
     * @param {?=} actDefId
     * @param {?=} wfForecastPayload
     * @return {?}
     */
    getTaskLogs(actDefId, wfForecastPayload) {
        if (this.dataId || this.procInstId || wfForecastPayload) {
            System.import('/platform/runtime/wf/webapp/mobiletaskcenter/taskComment.js' + '?v=20230602').then((/**
             * @return {?}
             */
            () => {
                if (this.dataId) {
                    this.logContainer = window.document.querySelector('.dataId' + this.dataIdSubStr);
                }
                else {
                    this.logContainer = window.document.querySelector('.procInstId' + this.procInstId);
                }
                /** @type {?} */
                let payload = {
                    bizInstId: this.dataId,
                    processInstanceId: this.procInstId,
                    activityDefinitionId: actDefId,
                    container: this.logContainer,
                    terminal: 'web',
                    typeId: 'wf',
                    ifForecast: this.ifForecast,
                    showHeader: this.ShowHeader,
                    showViewProcess: this.ShowViewProcess,
                    wfForecastPayload: wfForecastPayload,
                    onlyIncludeCurrentProcInst: this.OnlyIncludeCurrentProcInst,
                    isIncludeHistory: this.IncludeHistory,
                    includeRetrieve: this.IncludeAdminOperate,
                    includeAdminOperate: this.IncludeAdminOperate,
                };
                if (this.Style && this.Style == 'datagrid') { //表格版
                    ((/** @type {?} */ (window))).gspTaskCenterBizLog.ApprovalLogUtil.getWebHtml(payload).then((/**
                     * @param {?} result
                     * @return {?}
                     */
                    (result) => { }));
                }
                else { //卡片版
                    ((/** @type {?} */ (window))).gspTaskCenterBizLog.ApprovalLogUtil.getWebLogsHtml(payload).then((/**
                     * @param {?} result
                     * @return {?}
                     */
                    (result) => { }));
                }
            }));
        }
    }
    /**
     * 是否显示操作日志
     * @return {?}
     */
    ifShowOperateLogChange() {
        this.getTaskLogs();
    }
    /**
     * 国际化
     * @param {?} code
     * @return {?}
     */
    i18nTranslate(code) {
        /** @type {?} */
        var result;
        /** @type {?} */
        const supportLanguage = ["zh-CHS", "zh-CHT", "en"];
        /** @type {?} */
        const curLanguage = localStorage.getItem("languageCode");
        /** @type {?} */
        const translate = {
            "zh-CHS": {
                showOperateLog: "显示操作日志"
            },
            "zh-CHT": {
                showOperateLog: "顯示操作日誌"
            },
            en: {
                showOperateLog: "Show operate log"
            },
        };
        if (curLanguage && supportLanguage.indexOf(curLanguage) > -1) {
            result = translate[curLanguage][code];
        }
        else {
            result = translate["zh-CHS"][code];
        }
        return result;
    }
}
WfApprovalLogsComponent.decorators = [
    { type: Component, args: [{
                selector: 'wf-approval-logs',
                template: "<div\r\n  [class]=\"dataId ? 'dataId' + dataIdSubStr : 'procInstId' + procInstId\"\r\n  style=\"width: 100%; height: 100%; overflow: auto\"\r\n></div>\r\n\r\n<ng-template #taskDialogFooter>\r\n  <div style=\"display: flex; flex-grow: 1\">\r\n    <div class=\"custom-control custom-checkbox custom-control-inline\">\r\n      <input\r\n        type=\"checkbox\"\r\n        class=\"custom-control-input\"\r\n        [(ngModel)]=\"IncludeAdminOperate\"\r\n        (ngModelChange)=\"ifShowOperateLogChange()\"\r\n        id=\"taskShowOperateLog\"\r\n        name=\"taskShowOperateLog\"\r\n      />\r\n      <label class=\"custom-control-label\" for=\"taskShowOperateLog\">\r\n        {{ i18nTranslate(\"showOperateLog\") }}\r\n      </label>\r\n    </div>\r\n  </div>\r\n</ng-template>\r\n",
                styles: [".approval-log-background{width:100%;background:#f9f9f9;padding:16px 14px;border-radius:4px}.log-activity-name{font-size:14px}.receive-time{font-size:12px;-moz-columns:#565656;columns:#565656;padding-left:40px;white-space:nowrap;color:#a1a1a1}.log-creator-name{font-size:14px;color:#4297fa;text-align:left}.log-action-name-do{font-size:12px;color:#fff;margin-left:40px;margin-right:16px;border-radius:10px;padding:2px 8px;background:#59a1ff;white-space:nowrap;float:right}.log-action-name-todo{font-size:12px;color:#fff;margin-left:40px;margin-right:16px;border-radius:10px;padding:2px 8px;background:#f59c24;white-space:nowrap;float:right}.log-action-name-undo{font-size:12px;color:#fff;margin-left:40px;margin-right:16px;border-radius:10px;padding:2px 8px;background:#5ac1c3;white-space:nowrap;float:right}.work-item-state-done{font-size:13px;border-radius:2px;padding:0 10px;background:#f6faff;margin-left:20px;color:#5f637a;border:1px solid #e6e6e6}.timeline-item{position:relative;padding:0 0 14px 10px;margin:0;font-size:14px;list-style:none}.timeline-item-tail{position:absolute;top:.75em;left:7px;height:100%;border-left:2px dashed #e8e8e8}.timeline-item-head-blue{position:absolute;width:16px;height:16px;background-color:#388fff;border:4px solid #bdd9ff;border-radius:100px;left:0;top:10px}.timeline-item-head-green{position:absolute;width:16px;height:16px;background-color:#5ac1c3;border:4px solid #7fffd4;border-radius:100px;left:0;top:10px}.timeline-item-head-yellow{position:absolute;width:16px;height:16px;background-color:#f59c24;border:4px solid #fbd7a7;border-radius:100px;left:0;top:10px}.timeline-item-content{position:relative;top:-6px;margin:0 0 0 18px}.user-avatar{height:30px;width:30px;border-radius:50%}li{list-style:none}.wf-docFile{flex-shrink:1;flex-grow:1;flex-basis:0;display:flex;flex-direction:row;align-items:flex-start;border-top:1px solid #f8f9fa;border-left:1px solid #f8f9fa}.wf-docFileIcon{width:20px;height:20px;line-height:20px;text-align:center;overflow:hidden;white-space:nowrap;padding:2px}.wf-docFileInfo{flex-shrink:1;flex-grow:1;flex-basis:0;padding:2px 6px 0 0;margin-left:0}.wf-docFileSize{font-size:11px;color:#888}.wf-doc-delete{margin:auto;font-size:18px;color:#f8f9fa}.attachment-delete:hover{color:#4297fa}.approval-log-message{font-size:14px;padding:10px 0 10px 40px}.approval-log-signature{padding-left:40px;display:flex;justify-content:flex-end}.approval-log-user-name{display:flex;align-items:center;justify-content:space-between;padding-top:14px}.log-attachment-array{padding-top:10px;padding-left:40px}.log-attachment-file-name{font-size:12px;color:#4297fa;float:left;cursor:pointer;margin-left:5px}"]
            }] }
];
/** @nocollapse */
WfApprovalLogsComponent.ctorParameters = () => [];
WfApprovalLogsComponent.propDecorators = {
    cls: [{ type: HostBinding, args: ['class',] }],
    ShowHeader: [{ type: Input }],
    ShowViewProcess: [{ type: Input }],
    OnlyIncludeCurrentProcInst: [{ type: Input }],
    IncludeAdminOperate: [{ type: Input }],
    IncludeHistory: [{ type: Input }],
    taskDialogFooter: [{ type: ViewChild, args: ['taskDialogFooter',] }],
    DataId: [{ type: Input }],
    ProcInstId: [{ type: Input }],
    ActivityDefinitionId: [{ type: Input }],
    IfForecast: [{ type: Input }],
    Type: [{ type: Input }],
    processForecastPayload: [{ type: Input }],
    Style: [{ type: Input }]
};
if (false) {
    /** @type {?} */
    WfApprovalLogsComponent.prototype.dataId;
    /** @type {?} */
    WfApprovalLogsComponent.prototype.dataIdSubStr;
    /** @type {?} */
    WfApprovalLogsComponent.prototype.procInstId;
    /** @type {?} */
    WfApprovalLogsComponent.prototype.ifForecast;
    /** @type {?} */
    WfApprovalLogsComponent.prototype.type;
    /** @type {?} */
    WfApprovalLogsComponent.prototype.cls;
    /** @type {?} */
    WfApprovalLogsComponent.prototype.ShowHeader;
    /** @type {?} */
    WfApprovalLogsComponent.prototype.ShowViewProcess;
    /** @type {?} */
    WfApprovalLogsComponent.prototype.OnlyIncludeCurrentProcInst;
    /** @type {?} */
    WfApprovalLogsComponent.prototype.IncludeAdminOperate;
    /** @type {?} */
    WfApprovalLogsComponent.prototype.IncludeHistory;
    /** @type {?} */
    WfApprovalLogsComponent.prototype.taskDialogFooter;
    /** @type {?} */
    WfApprovalLogsComponent.prototype.logContainer;
    /** @type {?} */
    WfApprovalLogsComponent.prototype.Style;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoid2YtYXBwcm92YWwtbG9ncy5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZ3NwLXdmL3dmLWFwcHJvdmFsLWxvZ3MvIiwic291cmNlcyI6WyJsaWIvd2YtYXBwcm92YWwtbG9ncy5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUFBLE9BQU8sRUFBRSxTQUFTLEVBQVUsS0FBSyxFQUFFLFdBQVcsRUFBRSxTQUFTLEVBQUUsV0FBVyxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBUzlGLE1BQU0sT0FBTyx1QkFBdUI7O0lBc0VsQzs7UUFqRUEsZUFBVSxHQUFZLEtBQUssQ0FBQyxDQUFDLFNBQVM7O1FBRWhCLFFBQUcsR0FBRyxFQUFFLENBQUMsQ0FBQyxhQUFhOztRQUVwQyxlQUFVLEdBQVksS0FBSyxDQUFDLENBQUEsVUFBVTs7UUFDdEMsb0JBQWUsR0FBWSxLQUFLLENBQUMsQ0FBQSxZQUFZOztRQUM3QywrQkFBMEIsR0FBWSxLQUFLLENBQUMsQ0FBQSxjQUFjOztRQUMxRCx3QkFBbUIsR0FBWSxLQUFLLENBQUMsQ0FBQSxVQUFVOztRQUMvQyxtQkFBYyxHQUFZLEtBQUssQ0FBQyxDQUFBLFVBQVU7SUF5RG5DLENBQUM7Ozs7OztJQXBEakIsSUFDSSxNQUFNLENBQUMsTUFBYztRQUN2QixJQUFJLE1BQU0sRUFBRTtZQUNWLElBQUksQ0FBQyxNQUFNLEdBQUcsTUFBTSxDQUFDO1lBQ3JCLElBQUksQ0FBQyxZQUFZLEdBQUcsTUFBTSxDQUFDLFNBQVMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUM7WUFDM0MsSUFBSSxDQUFDLFdBQVcsRUFBRSxDQUFDO1NBQ3BCO0lBQ0gsQ0FBQzs7Ozs7SUFFRCxJQUNJLFVBQVUsQ0FBQyxVQUFrQjtRQUMvQixJQUFJLFVBQVUsRUFBRTtZQUNkLElBQUksQ0FBQyxVQUFVLEdBQUcsVUFBVSxDQUFDO1lBQzdCLElBQUksQ0FBQyxXQUFXLEVBQUUsQ0FBQztTQUNwQjtJQUNILENBQUM7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QUVqRDs7Ozs7a0JBUUUsV0FBVyxTQUFDLE9BQU87eUJBRW5CLEtBQUs7OEJBQ0wsS0FBSzt5Q0FDTCxLQUFLO2tDQUNMLEtBQUs7NkJBQ0wsS0FBSzsrQkFDTCxTQUFTLFNBQUMsa0JBQWtCO3FCQUk1QixLQUFLO3lCQVNMLEtBQUs7bUNBUUwsS0FBSzt5QkFPTCxLQUFLO21CQVFMLEtBQUs7cUNBVUwsS0FBSztvQkFRTCxLQUFLOzs7O0lBbEVOLHlDQUFlOztJQUNmLCtDQUFxQjs7SUFDckIsNkNBQW1COztJQUNuQiw2Q0FBNEI7O0lBQzVCLHVDQUFhOztJQUNiLHNDQUErQjs7SUFFL0IsNkNBQXFDOztJQUNyQyxrREFBMEM7O0lBQzFDLDZEQUFxRDs7SUFDckQsc0RBQThDOztJQUM5QyxpREFBeUM7O0lBQ3pDLG1EQUFrRTs7SUFFbEUsK0NBQWtCOztJQW9EbEIsd0NBQXVCIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ29tcG9uZW50LCBPbkluaXQsIElucHV0LCBIb3N0QmluZGluZywgVmlld0NoaWxkLCBUZW1wbGF0ZVJlZiB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5cclxuZGVjbGFyZSB2YXIgU3lzdGVtOiBhbnk7XHJcblxyXG5AQ29tcG9uZW50KHtcclxuICBzZWxlY3RvcjogJ3dmLWFwcHJvdmFsLWxvZ3MnLFxyXG4gIHRlbXBsYXRlVXJsOiAnLi93Zi1hcHByb3ZhbC1sb2dzLmNvbXBvbmVudC5odG1sJyxcclxuICBzdHlsZVVybHM6IFsnLi93Zi1hcHByb3ZhbC1sb2dzLmNvbXBvbmVudC5jc3MnXSxcclxufSlcclxuZXhwb3J0IGNsYXNzIFdmQXBwcm92YWxMb2dzQ29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0IHtcclxuXHJcbiAgZGF0YUlkOiBzdHJpbmc7IC8vIOWNleaNrmlkXHJcbiAgZGF0YUlkU3ViU3RyOiBzdHJpbmc7Ly/ljZXmja5pZCDnmoQgc3ViU3Ry77yM6Kej5Yaz5a2Q6KGoZGF0YUlk6L+Y6KaB6YCX5Y+377yMcXVlcnlTZWxlY3TmiqXplJnpl67pophcclxuICBwcm9jSW5zdElkOiBzdHJpbmc7IC8vIOa1geeoi+WunuS+i2lkXHJcbiAgaWZGb3JlY2FzdDogYm9vbGVhbiA9IGZhbHNlOyAvLyDmmK/lkKbpooTmtYvml6Xlv5dcclxuICB0eXBlOiBzdHJpbmc7Ly/mn6XnnIvml6Xlv5fnsbvlnotcclxuICBASG9zdEJpbmRpbmcoJ2NsYXNzJykgY2xzID0gJyc7IC8vIOW8ueahhuaYvuekuuaXtu+8jOWinuWKoOagt+W8j1xyXG5cclxuICBASW5wdXQoKSBTaG93SGVhZGVyOiBib29sZWFuID0gZmFsc2U7Ly/mmK/lkKbmmL7npLrml6Xlv5flpLTpg6hcclxuICBASW5wdXQoKSBTaG93Vmlld1Byb2Nlc3M6IGJvb2xlYW4gPSBmYWxzZTsvL+aYr+WQpuaYvuekuuafpeeci+a1geeoi+aMiemSrlxyXG4gIEBJbnB1dCgpIE9ubHlJbmNsdWRlQ3VycmVudFByb2NJbnN0OiBib29sZWFuID0gZmFsc2U7Ly/mmK/lkKblj6rljIXlkKvlvZPliY3mtYHnqIvnmoTml6Xlv5dcclxuICBASW5wdXQoKSBJbmNsdWRlQWRtaW5PcGVyYXRlOiBib29sZWFuID0gZmFsc2U7Ly/mmK/lkKbmmL7npLrmk43kvZzml6Xlv5dcclxuICBASW5wdXQoKSBJbmNsdWRlSGlzdG9yeTogYm9vbGVhbiA9IGZhbHNlOy8v5piv5ZCm5YyF5ZCr5Y6G5Y+y5pel5b+XXHJcbiAgQFZpZXdDaGlsZCgndGFza0RpYWxvZ0Zvb3RlcicpIHRhc2tEaWFsb2dGb290ZXI6IFRlbXBsYXRlUmVmPGFueT47Ly/lupXpg6jljLrln59cclxuXHJcbiAgbG9nQ29udGFpbmVyOiBhbnk7Ly/ml6Xlv5flrrnlmahcclxuXHJcbiAgQElucHV0KClcclxuICBzZXQgRGF0YUlkKGRhdGFJZDogc3RyaW5nKSB7XHJcbiAgICBpZiAoZGF0YUlkKSB7XHJcbiAgICAgIHRoaXMuZGF0YUlkID0gZGF0YUlkO1xyXG4gICAgICB0aGlzLmRhdGFJZFN1YlN0ciA9IGRhdGFJZC5zdWJzdHJpbmcoMCwgNSk7XHJcbiAgICAgIHRoaXMuZ2V0VGFza0xvZ3MoKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIEBJbnB1dCgpXHJcbiAgc2V0IFByb2NJbnN0SWQocHJvY0luc3RJZDogc3RyaW5nKSB7XHJcbiAgICBpZiAocHJvY0luc3RJZCkge1xyXG4gICAgICB0aGlzLnByb2NJbnN0SWQgPSBwcm9jSW5zdElkO1xyXG4gICAgICB0aGlzLmdldFRhc2tMb2dzKCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBASW5wdXQoKVxyXG4gIHNldCBBY3Rpdml0eURlZmluaXRpb25JZChhY3REZWZJZDogc3RyaW5nKSB7XHJcbiAgICBpZiAoYWN0RGVmSWQpIHtcclxuICAgICAgdGhpcy5nZXRUYXNrTG9ncyhhY3REZWZJZCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBASW5wdXQoKVxyXG4gIHNldCBJZkZvcmVjYXN0KGlmRm9yZWNhc3Q6IHN0cmluZykge1xyXG4gICAgaWYgKGlmRm9yZWNhc3QpIHtcclxuICAgICAgdGhpcy5pZkZvcmVjYXN0ID0gaWZGb3JlY2FzdCA9PSAndHJ1ZScgPyB0cnVlIDogZmFsc2U7XHJcbiAgICAgIHRoaXMuZ2V0VGFza0xvZ3MoKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIEBJbnB1dCgpXHJcbiAgc2V0IFR5cGUodHlwZTogc3RyaW5nKSB7XHJcbiAgICBpZiAoKHR5cGUgPT0gJ3Byb2Nlc3MnIHx8IHR5cGUgPT0gJ2FjdGl2aXR5JykgJiYgdGhpcy50eXBlICE9IHR5cGUpIHtcclxuICAgICAgdGhpcy50eXBlID0gdHlwZTtcclxuICAgICAgaWYgKHR5cGUgPT09ICdwcm9jZXNzJykgey8vIHR5cGUgPSAncHJvY2Vzcyfmn6XnnIvmtYHnqIvml6Xlv5fvvJt0eXBlID0gJ2FjdGl2aXR5J++8jOafpeeci+iKgueCueaXpeW/lyBzZXF1ZW5jZe+8jOi9rOenu+e6v1xyXG4gICAgICAgIHRoaXMuZ2V0VGFza0xvZ3MoKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgQElucHV0KClcclxuICBzZXQgcHJvY2Vzc0ZvcmVjYXN0UGF5bG9hZChwYXlsb2FkOiBhbnkpIHtcclxuICAgIGlmIChwYXlsb2FkKSB7XHJcbiAgICAgIHRoaXMuaWZGb3JlY2FzdCA9IHRydWU7XHJcbiAgICAgIHRoaXMuZ2V0VGFza0xvZ3MoJycsIHBheWxvYWQpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgQElucHV0KCkgU3R5bGU6IHN0cmluZzsvL+agt+W8j++8jGNhcmQg5Y2h54mH54mI77ybZGF0YWdyaWQg6KGo5qC854mIXHJcblxyXG4gIGNvbnN0cnVjdG9yKCkgeyB9XHJcblxyXG4gIG5nT25Jbml0KCkge1xyXG4gICAgLy8gdGhpcy5nZXRUYXNrTG9ncygpO1xyXG4gIH1cclxuXHJcbiAgZmlsbCgpIHtcclxuICAgIHRoaXMuY2xzID0gJ2QtZmxleCBmbGV4LWZpbGwgaC0xMDAgZi11dGlscy1hYnNvbHV0ZS1hbGwgcHgtNCBweS0zJztcclxuICB9XHJcblxyXG4gIHByaXZhdGUgZ2V0VGFza0xvZ3MoYWN0RGVmSWQ/OiBzdHJpbmcsIHdmRm9yZWNhc3RQYXlsb2FkPzogYW55KSB7XHJcbiAgICBpZiAodGhpcy5kYXRhSWQgfHwgdGhpcy5wcm9jSW5zdElkIHx8IHdmRm9yZWNhc3RQYXlsb2FkKSB7XHJcbiAgICAgIFN5c3RlbS5pbXBvcnQoJy9wbGF0Zm9ybS9ydW50aW1lL3dmL3dlYmFwcC9tb2JpbGV0YXNrY2VudGVyL3Rhc2tDb21tZW50LmpzJyArICc/dj0yMDIzMDYwMicpLnRoZW4oKCkgPT4ge1xyXG4gICAgICAgIGlmICh0aGlzLmRhdGFJZCkge1xyXG4gICAgICAgICAgdGhpcy5sb2dDb250YWluZXIgPSB3aW5kb3cuZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmRhdGFJZCcgKyB0aGlzLmRhdGFJZFN1YlN0cik7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIHRoaXMubG9nQ29udGFpbmVyID0gd2luZG93LmRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9jSW5zdElkJyArIHRoaXMucHJvY0luc3RJZCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGxldCBwYXlsb2FkOiBhbnkgPSB7XHJcbiAgICAgICAgICBiaXpJbnN0SWQ6IHRoaXMuZGF0YUlkLFxyXG4gICAgICAgICAgcHJvY2Vzc0luc3RhbmNlSWQ6IHRoaXMucHJvY0luc3RJZCxcclxuICAgICAgICAgIGFjdGl2aXR5RGVmaW5pdGlvbklkOiBhY3REZWZJZCxcclxuICAgICAgICAgIGNvbnRhaW5lcjogdGhpcy5sb2dDb250YWluZXIsXHJcbiAgICAgICAgICB0ZXJtaW5hbDogJ3dlYicsXHJcbiAgICAgICAgICB0eXBlSWQ6ICd3ZicsXHJcbiAgICAgICAgICBpZkZvcmVjYXN0OiB0aGlzLmlmRm9yZWNhc3QsXHJcbiAgICAgICAgICBzaG93SGVhZGVyOiB0aGlzLlNob3dIZWFkZXIsXHJcbiAgICAgICAgICBzaG93Vmlld1Byb2Nlc3M6IHRoaXMuU2hvd1ZpZXdQcm9jZXNzLFxyXG4gICAgICAgICAgd2ZGb3JlY2FzdFBheWxvYWQ6IHdmRm9yZWNhc3RQYXlsb2FkLFxyXG4gICAgICAgICAgb25seUluY2x1ZGVDdXJyZW50UHJvY0luc3Q6IHRoaXMuT25seUluY2x1ZGVDdXJyZW50UHJvY0luc3QsXHJcbiAgICAgICAgICBpc0luY2x1ZGVIaXN0b3J5OiB0aGlzLkluY2x1ZGVIaXN0b3J5LFxyXG4gICAgICAgICAgaW5jbHVkZVJldHJpZXZlOiB0aGlzLkluY2x1ZGVBZG1pbk9wZXJhdGUsXHJcbiAgICAgICAgICBpbmNsdWRlQWRtaW5PcGVyYXRlOiB0aGlzLkluY2x1ZGVBZG1pbk9wZXJhdGUsXHJcbiAgICAgICAgfTtcclxuICAgICAgICBpZiAodGhpcy5TdHlsZSAmJiB0aGlzLlN0eWxlID09ICdkYXRhZ3JpZCcpIHsvL+ihqOagvOeJiFxyXG4gICAgICAgICAgKHdpbmRvdyBhcyBhbnkpLmdzcFRhc2tDZW50ZXJCaXpMb2cuQXBwcm92YWxMb2dVdGlsLmdldFdlYkh0bWwocGF5bG9hZCkudGhlbigocmVzdWx0KSA9PiB7IH0pO1xyXG4gICAgICAgIH0gZWxzZSB7Ly/ljaHniYfniYhcclxuICAgICAgICAgICh3aW5kb3cgYXMgYW55KS5nc3BUYXNrQ2VudGVyQml6TG9nLkFwcHJvdmFsTG9nVXRpbC5nZXRXZWJMb2dzSHRtbChwYXlsb2FkKS50aGVuKChyZXN1bHQpID0+IHsgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOaYr+WQpuaYvuekuuaTjeS9nOaXpeW/l1xyXG4gICAqL1xyXG4gIGlmU2hvd09wZXJhdGVMb2dDaGFuZ2UoKSB7XHJcbiAgICB0aGlzLmdldFRhc2tMb2dzKCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAqIOWbvemZheWMllxyXG4gICovXHJcbiAgaTE4blRyYW5zbGF0ZShjb2RlOiBzdHJpbmcpIHtcclxuICAgIHZhciByZXN1bHQ6IHN0cmluZztcclxuICAgIGNvbnN0IHN1cHBvcnRMYW5ndWFnZSA9IFtcInpoLUNIU1wiLCBcInpoLUNIVFwiLCBcImVuXCJdO1xyXG4gICAgY29uc3QgY3VyTGFuZ3VhZ2UgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShcImxhbmd1YWdlQ29kZVwiKTtcclxuICAgIGNvbnN0IHRyYW5zbGF0ZSA9IHtcclxuICAgICAgXCJ6aC1DSFNcIjoge1xyXG4gICAgICAgIHNob3dPcGVyYXRlTG9nOiBcIuaYvuekuuaTjeS9nOaXpeW/l1wiXHJcbiAgICAgIH0sXHJcbiAgICAgIFwiemgtQ0hUXCI6IHtcclxuICAgICAgICBzaG93T3BlcmF0ZUxvZzogXCLpoa/npLrmk43kvZzml6XoqoxcIlxyXG4gICAgICB9LFxyXG4gICAgICBlbjoge1xyXG4gICAgICAgIHNob3dPcGVyYXRlTG9nOiBcIlNob3cgb3BlcmF0ZSBsb2dcIlxyXG4gICAgICB9LFxyXG4gICAgfTtcclxuICAgIGlmIChjdXJMYW5ndWFnZSAmJiBzdXBwb3J0TGFuZ3VhZ2UuaW5kZXhPZihjdXJMYW5ndWFnZSkgPiAtMSkge1xyXG4gICAgICByZXN1bHQgPSB0cmFuc2xhdGVbY3VyTGFuZ3VhZ2VdW2NvZGVdO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgcmVzdWx0ID0gdHJhbnNsYXRlW1wiemgtQ0hTXCJdW2NvZGVdO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHJlc3VsdDtcclxuICB9XHJcbn1cclxuIl19