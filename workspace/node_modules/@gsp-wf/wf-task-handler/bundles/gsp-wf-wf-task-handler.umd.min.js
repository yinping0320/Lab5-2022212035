!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@farris/ui-modal"),require("@gsp-sys/sysmgr-ui"),require("@angular/common"),require("@farris/ui-datatable"),require("@farris/ui-dialog"),require("@farris/ui-pagination"),require("@farris/ui-combo-list"),require("@farris/ui-input-group"),require("@farris/ui-datagrid"),require("@farris/ui-datagrid-editors"),require("@farris/ui-forms"),require("@farris/ui-switch"),require("@farris/ui-section"),require("@gsp-wf/wf-approval-logs"),require("@gsp-wf/ui-flowchart"),require("@gsp-wf/task-impl-api"),require("@farris/ui-avatar"),require("@farris/ui-dropdown"),require("@gsp-wf/wf-sign"),require("@gsp-sys/rtf-common"),require("@ecp-caf/caf-common"),require("@farris/ui-notify"),require("rxjs"),require("rxjs/operators"),require("@angular/core"),require("@angular/forms"),require("@gsp-svc/formdoc-upload"),require("@farris/ui-messager"),require("@gsp-svc/file-load"),require("@farris/ui-loading")):"function"==typeof define&&define.amd?define("@gsp-wf/wf-task-handler",["exports","@farris/ui-modal","@gsp-sys/sysmgr-ui","@angular/common","@farris/ui-datatable","@farris/ui-dialog","@farris/ui-pagination","@farris/ui-combo-list","@farris/ui-input-group","@farris/ui-datagrid","@farris/ui-datagrid-editors","@farris/ui-forms","@farris/ui-switch","@farris/ui-section","@gsp-wf/wf-approval-logs","@gsp-wf/ui-flowchart","@gsp-wf/task-impl-api","@farris/ui-avatar","@farris/ui-dropdown","@gsp-wf/wf-sign","@gsp-sys/rtf-common","@ecp-caf/caf-common","@farris/ui-notify","rxjs","rxjs/operators","@angular/core","@angular/forms","@gsp-svc/formdoc-upload","@farris/ui-messager","@gsp-svc/file-load","@farris/ui-loading"],t):t((e["gsp-wf"]=e["gsp-wf"]||{},e["gsp-wf"]["wf-task-handler"]={}),e.uiModal,e.sysmgrUi,e.ng.common,e.uiDatatable,e.uiDialog,e.uiPagination,e.uiComboList,e.uiInputGroup,e.uiDatagrid,e.uiDatagridEditors,e.uiForms,e.uiSwitch,e.uiSection,e.wfApprovalLogs,e.uiFlowchart,e.taskImplApi,e.uiAvatar,e.uiDropdown,e.wfSign,e.rtfCommon,e.cafCommon,e.uiNotify,e.rxjs,e.rxjs.operators,e.ng.core,e.ng.forms,e.formdocUpload,e.uiMessager,e.fileLoad,e.uiLoading)}(this,function(e,t,n,s,i,r,o,a,c,l,u,d,h,g,f,m,p,v,b,y,S,w,I,x,k,C,T,N,A,P,D){"use strict";var j=function(e,t){return(j=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};function M(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}j(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}function U(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],s=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return{value:(e=e&&s>=e.length?void 0:e)&&e[s++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function H(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var s,i,r=n.call(e),o=[];try{for(;(void 0===t||0<t--)&&!(s=r.next()).done;)o.push(s.value)}catch(a){i={error:a}}finally{try{s&&!s.done&&(n=r["return"])&&n.call(r)}finally{if(i)throw i.error}}return o}function E(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(H(arguments[t]));return e}var O=(V.prototype.getUsersByIds=function(e){var t=this;return x.forkJoin(e.map(function(e){return t.httpSvc.get("/api/runtime/sys/v1.0/users/"+e+"?mode=0002")}))},V.prototype.getWorkItemActions=function(e){return this.httpSvc.get("/api/runtime/wf/v1.0/workItems/"+e+"/actions")},V.prototype.complete=function(e){return this.httpSvc.post("/api/runtime/wf/v1.0/workItems/complete",e)},V.prototype.completeSimulate=function(e){return this.httpSvc.post("/api/runtime/wf/v1.0/workItems/complete-simulation",e)},V.prototype.getDestinationScope=function(e,t){return this.httpSvc.get("/api/runtime/wf/v1.0/workItems/"+e+"/nextNodes/"+t)},V.prototype.getSimulationAssigneeInfo=function(e,t){return this.httpSvc.get("/api/runtime/wf/v1.0/workItems/"+e+"/simulation-assigneeInfo?nodeIds=["+t+"]")},V.prototype.addSign=function(e){return this.httpSvc.post("/api/runtime/wf/v1.0/workItems/counterSignAdd",e)},V.prototype.readTask=function(e){return this.httpSvc.post("/api/runtime/wf/v1.0/workItems/read",e)},V.prototype.getTaskFormInfo=function(e){var t=new x.Subject,n="gspWfTaskFormInfo"+e,s=localStorage.getItem(n);return s?setTimeout(function(){t.next(JSON.parse(s))},10):this.httpSvc.get("/api/runtime/wf/v1.0/workItems/"+e+"/formInfo").subscribe(function(e){t.next(e),localStorage.setItem(n,JSON.stringify(e))},function(e){t.error(e)}),t.asObservable()},V.prototype.getAssigneeInfo=function(e){return this.httpSvc.get("/api/runtime/wf/v1.0/workItems/"+e+"/assigneeInfo")},V.prototype.getOrganizationScope=function(e,t){return this.httpSvc.get("/api/runtime/wf/v1.0/workItems/"+e+"/organizationScope/"+t)},V.prototype.getTaskByProcInstId=function(e,t){return this.httpSvc.get("/api/runtime/task/v1.0/tasks/processInstanceId?procInstId="+e+"&state="+t)},V.prototype.getTaskByWorkItemId=function(e){return this.httpSvc.get("/api/runtime/task/v1.0/tasks/sourceId/"+e)},V.prototype.assignNextUsersByWorkItemId=function(e){return this.httpSvc.post("/api/runtime/wf/v1.0/workItems/assignUser",e)},V.prototype.retrieve=function(e){return this.httpSvc.post("/api/runtime/wf/v1.0/workItems/retrieve",e)},V.prototype.transfer=function(e){return this.httpSvc.post("/api/runtime/wf/v1.0/workItems/transfer",e)},V.prototype.comment=function(e){return this.httpSvc.post("/api/runtime/wf/v1.0/workItems/comment",e)},V.prototype.claim=function(e,t){return this.httpSvc.post("/api/runtime/wf/v1.0/workItems/claim",{workItemId:e,comment:t})},V.prototype.unClaim=function(e,t){return this.httpSvc.post("/api/runtime/wf/v1.0/workItems/unclaim",{workItemId:e,comment:t})},V.prototype.error=function(e){e&&e.error&&e.error.Message&&(e=e.error.Message,this.message.show("warning",e,{safeHtml:!1}))},V.prototype.startProcess=function(e){return this.httpSvc.post("/api/runtime/wf/v1.0/processInstances/startProcess",e)},V.prototype.startProcessSimulate=function(e){return this.httpSvc.post("/api/runtime/wf/v1.0/processInstances/startProcess-simulation",e)},V.prototype.cancelSubmit=function(e){return this.httpSvc.post("/api/runtime/wf/v1.0/processInstances/cancelSubmit",e)},V.newId=function(){var e=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)};return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()},V.prototype.getCommentList=function(e){var t="/api/runtime/wf/v1.0/commonComments";return e&&e.type&&(t+="?type="+e.type),this.httpSvc.get(t)},V.prototype.addComment=function(e){return this.httpSvc.post("/api/runtime/wf/v1.0/commonComments",e)},V.prototype.deleteComment=function(e){return this.httpSvc["delete"]("/api/runtime/wf/v1.0/commonComments/"+e,null)},V.prototype.getTaskCenterConfigByCode=function(e,t,n){e="/api/runtime/task/v1.0/task-center-setting/code?code="+e;return t&&(e+="&ownerType="+t),n&&(e+="&ownerId="+n),this.httpSvc.get(e)},V.prototype.getAllTaskCenterConfig=function(){var t=this,n=new x.Subject,s="gspWfTaskAllConfig",i=s+this.getCurrentDateString(),e=localStorage.getItem(i);return e?setTimeout(function(){n.next(JSON.parse(e))},10):this.httpSvc.get("/api/runtime/task/v1.0/task-center-setting/all?ownerType=all&ownerId=*").subscribe(function(e){localStorage.setItem(i,JSON.stringify(e)),n.next(e),t.removeConfig(s)},function(e){n.error(e)}),n.asObservable()},V.prototype.getTaskCategoryCenterConfig=function(e){var t,n=this,s=new x.Subject,i="gspWfTaskCategoryConfig"+e,r=i+this.getCurrentDateString(),o=localStorage.getItem(r);return o?setTimeout(function(){s.next(JSON.parse(o))},10):(t="/api/runtime/task/v1.0/task-center-setting/all",this.httpSvc.get(t+="?ownerType=category&ownerId="+e).subscribe(function(e){localStorage.setItem(r,JSON.stringify(e)),s.next(e),n.removeConfig(i)},function(e){s.error(e)})),s.asObservable()},V.prototype.getAllUserConfig=function(){var t=this,n=new x.Subject,s="gspWfTaskUserConfig",i=s+this.getCurrentDateString(),e=localStorage.getItem(i);return e?setTimeout(function(){n.next(JSON.parse(e))},10):this.httpSvc.get("/api/runtime/task/v1.0/task-center-setting/all").subscribe(function(e){localStorage.setItem(i,JSON.stringify(e)),t.removeConfig(s),n.next(e)},function(e){n.error(e)}),n.asObservable()},V.prototype.addUserConfig=function(t,e){var n,s="gspWfTaskUserConfig"+this.getCurrentDateString(),i=localStorage.getItem(s);return!i||(n=JSON.parse(i))&&n.length&&((i=n.find(function(e){return e.configCode==t}))&&(i.currentValue=e,localStorage.setItem(s,JSON.stringify(n)))),this.httpSvc.post("/api/runtime/task/v1.0/task-center-setting/add?configCode="+t+"&currentValue="+e,null)},V.prototype.getUserAvatar=function(e){var t=this,n=new x.Subject,s="gspWfTaskUserAvatar",i=s+this.getCurrentDateString()+e,r=localStorage.getItem(i);return r?setTimeout(function(){n.next(JSON.parse(r))},100):this.httpSvc.get("/api/runtime/sys/v1.0/userinfos/setting/users?userId="+e).subscribe(function(e){n.next(e),localStorage.setItem(i,JSON.stringify(e)),t.removeConfig(s)}),n.asObservable()},V.prototype.getCurrentDateString=function(){var e=new Date;return e.getFullYear().toString()+(e.getMonth()+1).toString()+e.getDate().toString()},V.prototype.removeConfig=function(e){var t,n=e+this.getCurrentDateString();for(t in localStorage)-1<t.indexOf(e)&&t.indexOf(n)<0&&localStorage.removeItem(t)},V.prototype.uploadAttachment=function(e){return this.httpSvc.put("/api/runtime/dfs/v1.0/doc/commit",e)},V.prototype.deleteAttachment=function(e){return this.httpSvc["delete"]("/api/runtime/dfs/v1.0/doc",e)},V.prototype.createNM=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})},V.prototype.getUserInfo=function(){return this.httpSvc.get("/api/runtime/sys/v1.0/userinfos?infoType=user")},V.prototype.getUserSignId=function(e){var t=this,n=new x.Subject,s="gspWfTaskUserSign"+e,i=s+this.getCurrentDateString(),r=localStorage.getItem(i);return r?setTimeout(function(){n.next(r)},100):this.httpSvc.get("/api/runtime/dfs/v1.0/formdoc/fileinfo/form?formid="+e+"&rootid=taskcentersignature").subscribe(function(e){e&&e.length?(e=1==e.length?e[0]:e.filter(function(e){return e&&e.lastModifiedTime}).reduce(function(e,t){return e.lastModifiedTime>t.lastModifiedTime?e:t}),n.next(e.id),localStorage.setItem(i,e.id),t.removeConfig(s)):n.next("")},function(e){n.error(e)}),n.asObservable()},V.prototype.uploadSignature=function(e){e=this.httpSvc.setHeader({body:e,responseType:"text"});return this.httpSvc.request("Post","/api/runtime/dfs/v1.0/doc",e)},V.prototype.createItem=function(e){var t=e.fileName.lastIndexOf("."),e=""==(e=e.fileName.substring(t+1))?"Default":e.toLowerCase();return e=0<="doc-docx-htm-html-js-pdf-ppt-pptx-rar-zip-txt-xls-xlsx".indexOf(e)?e.toLowerCase():0<="wav-aif-aiff-au-mp1-mp2-mp3-ra-rm-ram-mid-rmi".indexOf(e)?"video":0<="avi-rm-rmvb-mpeg-mpg-dat-mov-qt-asf-wm-mp4".indexOf(e)?"audio":0<="webp-baibmp-dupcx-tif-gif-jpeg-tga-exif-fpx-svg-psd-cdr-pcd-dxf-ufo-eps-ai-png-hdri-raw-wmf-flic-emf-ico-jpg".indexOf(e)?"picture":"default"},V.prototype.subjectRegister=function(e,t){return window.gspframeworkService.rtf.broadcast.subjectRegister(e,{funcId:t})},V.prototype.subjectRemove=function(e){window.gspframeworkService.rtf.broadcast.subjectRemove(e)},V.prototype.subjectNotify=function(e,t){window.gspframeworkService.rtf.broadcast.notify(e,t)},V.prototype.subjectResponse=function(e,t,n){window.gspframeworkService.rtf.broadcast.response(e,t,n)},V.prototype.urgeHandleSimulate=function(e){return this.httpSvc.post("/api/runtime/wf/v1.0/processInstances/getUrgeHandleInfo",e)},V.prototype.urgeHandle=function(e){return this.httpSvc.post("/api/runtime/wf/v1.0/processInstances/urgeHandle",e)},V.prototype.batchVerifySigned=function(e){return this.httpSvc.post("/api/runtime/wf/v1.0/workItems/batchVerifySigned",e)},V.prototype.getWfUserHelpConfig=function(){var e=new Date,t=e.getFullYear(),n=e.getMonth()+1,e=e.getDate();return this.httpSvc.get("/platform/runtime/wf/web/wf-user-help/config.json?v="+t+n+e)},V.prototype.getAdhocConfig=function(e){return this.httpSvc.get("/api/runtime/wf/v1.0/workItems/"+e+"/adhocConfig/AddSignBehind")},V.prototype.adhocAssignee=function(e){return this.httpSvc.post("/api/runtime/wf/v1.0/workItems/adhocAssignee",e)},V.prototype.cancelConsult=function(e){return this.httpSvc.post("/api/runtime/wf/v1.0/workItems/cancelConsult",e)},V.prototype.isInSuite=function(){var e=window.gspframeworkService;if(e&&e.rtf){e=e.rtf.extendMethod;if(e&&e.getExtObj())if(e.getExtObj().iGIX4inSuiteMode())return!0}return!1},V.prototype.getBytesLength=function(e){return e.replace(/[^\x00-\xff]/g,"xx").length},V.prototype.getTopWindow=function(){var e=window.self;try{for(;e.location.origin===e.parent.location.origin&&e!==e.parent&&!e.isRTFTopWin;)e=e.parent}catch(t){}return e},V.prototype.handleErrorLevel=function(e){var t,n,s,i,r=this;e&&e.status<500||(t=(s=e.error).Message||"",e=s.date||new Date,n=s.Detail||s.Message+"\r\n发生时间："+e+"\r\n详细信息："+s.innerMessage||"",s=s.innerMessage||null,i=this.message.show("exception",t,{showMaxButton:!1,buttons:[{text:"知道了",cls:"btn btn-primary btn-lg",handle:function(){i.close()}}],width:440,height:200,safeHtml:!1,exception:{date:e,message:s,copyButton:{text:"复制详细信息",onClick:function(e){var t=r.copyToClipboard(n);i.content.showMiniNotify(t,1500)}}}}))},V.prototype.copyToClipboard=function(e){var t=window;if(t.clipboardData&&t.clipboardData.setData)return t.clipboardData.setData("Text",e);if(document.queryCommandSupported&&document.queryCommandSupported("copy")){t=document.createElement("textarea");t.textContent=e,t.style.position="fixed",document.body.appendChild(t),t.select();try{return document.execCommand("copy")}catch(n){console.warn("Copy to clipboard failed.",n)}finally{document.body.removeChild(t)}}return!1},V.decorators=[{type:C.Injectable}],V.ctorParameters=function(){return[{type:w.HttpService},{type:A.MessagerService}]},V);function V(e,t){this.httpSvc=e,this.message=t}var L,F=(M(B,L=function(){}),B);function B(){return null!==L&&L.apply(this,arguments)||this}var _={"zh-CHS":{"static":{assignee:{noAssignee:"请选择办理人员"},columnName:{name:"名称",code:"编号",department:"组织信息"},title:"审批确认",inputLabel:"审批意见",inputHolder:"请输入审批意见",footOk:"确定",footCancel:"取消",selectUser:"选择用户",hideComment:"意见隐藏",taskForm:"任务办理",success:"成功"},cueWords:{successPass:"审批通过",inputOpinion:"请输入审批意见",selectNode:"请选择下一环节",select:"请选择",processor:"办理人",attachmentsRequired:"请上传附件",signatureRequired:"请设置签名",assignUser:"指派",operateSuccess:"操作成功",commonCommentTooLong:"意见超长（最长255字符），请重新编辑"},task:{selectPlaceholder:"请选择",passComment:"通过",processAlone:"请单独处理",urgeText:"接收人员",backNodeText:"节点",selectProcessor:"请选择办理人员",notFoundBill:"该单据不支持在电脑端办理，请尝试去移动端进行办理",nextNodeText:"下一环节",assignText:"办理人员",noUser:"无",title:"任务办理",noTask:"未找到对应的任务",commentTooLong:"处理意见超出 4000 个英文字符限制，建议以附件方式提交意见",activityName:"办理人员",receiver:"接收人员",urgeComment:"请输入催办信息",noUrgeUsers:"没有符合条件的催办用户",noUrgeSubject:"消息主题未配置",noUrgeContent:"消息内容未配置",person:"人员",addSign:"加签",priority:"紧急程度",selectPriority:"请选择紧急程度"},startProcess:{selectProcess:"请选择流程",title:"提交确认",selectNode:"请选择下一环节",submitSuccess:"提交审批成功",submitFailed:"提交审批失败",cancelSubmitSuccess:"取消提交成功",cancelSubmitFailed:"取消提交失败",dataIdIsNull:"请选择一条数据",dataIdIsEmpty:"请选择一条数据",bizDefKeyIsNull:"流程分类ID不能为空",success:"取消成功",row:"条<br/>",failed:"取消失败",node:"节点，",noUser:"没有找到合适的办理人",cancelSubmitInfo:"已撤回至流程的开始节点，请修改后重新提交",procDef:"流程定义",processTowards:"即将流向",otherNodesAssign:"指定其他节点办理人"},batchSubmit:{row:"条，<br/>",success:"办理成功",error:"办理失败",failed:"需要交互",single:"失败的任务请单独处理",selected:"已选择",item:"项，",time:"预计处理时间较长（大于",second:"秒）"},batchStartProcess:{row:"条，<br/>",success:"提交成功",error:"提交失败",failed:"需要交互",validationFailed:"验签失败",single:"失败的单据请单独处理"},comment:{"static":{title:"常用意见管理",add:"新增","delete":"删除",save:"保存",cancel:"取消",content:"常用意见",order:"顺序",inputLabel:"常用意见",manage:"意见管理",attachmentUpload:"附件",repeatFile:"包含重复文件：",type:"类别",operate:"操作",confirm:"确认",clickToAdd:"新增常用意见","public":"公有","private":"个人",messageSubject:"消息主题",messageContent:"消息内容",comment:"处理意见",tooLongTips:"超出 4000 个英文字符限制，建议以附件方式提交意见"},attachment:{tips:"点击上传附件"},signature:{title:"签名",reset:"清空",ok:"确定",sign:"手写签名，",upload:"上传图片",tips:"点击设置签名",dialogTitle:"电子签名",note1:"电子签名可",note2:"也可通过",note3:"进行设置",disable:"不启用签名",download:"下载",view:"查看","delete":"删除"}},addSign:{allowSignToSign:"允许再",multiInstanceType:"多人审批方式",parallel:"并行会签",preempt:"任意人处理",sequential:"按顺序依次处理"},backWardConfig:{sequence:"按顺序流转",backToMe:"返回我",backToCurrentNode:"返回本节点",title:"驳回的节点通过后",allowResubmitToThisNode:"后再次提交时直接回到本节点"}},en:{"static":{assignee:{noAssignee:"Please select at least one approver."},columnName:{name:"Name",code:"Code",department:"Department"},title:"Approval confirmation",inputLabel:"Approval comments",inputHolder:"comments",footOk:"OK",footCancel:"Cancel",selectUser:"Select User",hideComment:"Hide comment",taskForm:"Task Handle",success:" success"},cueWords:{successPass:"Approved successfully.",inputOpinion:"Please input your opinion",selectNode:"Please select target nodes",select:"Please select",processor:"processor",attachmentsRequired:"Please upload the attachment",signatureRequired:"Please upload the signature",assignUser:"Assign user",operateSuccess:"Operate successfully",commonCommentTooLong:"Comment is too long"},task:{selectPlaceholder:"Please select",passComment:"Pass",processAlone:"Please handle it separately",urgeText:"Receiver",backNodeText:" node",selectProcessor:"Please select the user",notFoundBill:"This document cannot be processed on the computer. Please try to process it on the mobile terminal",nextNodeText:"Next node",assignText:"Assign to",noUser:"No one",title:"Handle Task",noTask:"There is no task.",commentTooLong:"Comments exceed the 4000 English character limit, it is recommended to submit comments by uploading attachments",activityName:"processor",receiver:"receiver",urgeComment:"Please input your comment",noUrgeUsers:"There is no user to urge handle",noUrgeSubject:"no urge subject",noUrgeContent:"no urge content",person:" people",addSign:"Add sign",priority:"Priority",selectPriority:"Please select the priority"},startProcess:{selectProcess:"Please select process",title:"Select process",selectNode:"Please select next node",submitSuccess:"Start process successfully",submitFailed:"Start process failed",cancelSubmitSuccess:"Cancel submit successfully",cancelSubmitFailed:"Cancel submit failed",dataIdIsNull:"Please select a data",dataIdIsEmpty:"Please select a data",bizDefKeyIsNull:"Biz definition key is null",success:"Success",row:"",failed:", failed",node:"node, ",noUser:"no suitable handler was found",cancelSubmitInfo:"Please resubmit",procDef:"Process",processTowards:"Process towards",otherNodesAssign:"Assign other nodes"},batchSubmit:{row:"",success:"Success",error:"Error",failed:"Failed",validationFailed:"Signature verification failed",single:"Failed tasks please process it singly",selected:"Selected",item:"items,",time:"time more than",second:"seconds"},batchStartProcess:{row:"<br/>",success:"Success",error:"Error",failed:"Failed",single:"Failed tasks please process it singly"},comment:{"static":{title:"Approval comments",add:"Add","delete":"Delete",save:"Save",cancel:"Cancel",content:"Content",order:"Order",inputLabel:"Comments",manage:"Comments management",attachmentUpload:"Attachment",repeatFile:"Contains repeat files:",type:"Type",operate:"Operate",confirm:"Confirm",clickToAdd:"Click to add","public":"public","private":"private",messageSubject:"message subject",messageContent:"message content",comment:"Comments",tooLongTips:"exceed the 4000 English character limit, it is recommended to submit comments by uploading attachments"},attachment:{tips:"click to upload attachments"},signature:{title:"Signature",reset:"Reset",ok:"OK",sign:"Sign, ",upload:"Upload",tips:"click to sign or upload a picture",dialogTitle:"Signature",note1:"",note2:"or",note3:"",disable:"disable signature",download:"download",view:"view","delete":"delete"}},addSign:{allowSignToSign:"Allow",multiInstanceType:"Multi instance type",parallel:"parallel",preempt:"preempt",sequential:"sequential"},backWardConfig:{sequence:"Sequence",backToMe:"Back to me",backToCurrentNode:"Back to current node",allowResubmitToThisNode:",resubmit to this node"}},"zh-CHT":{"static":{assignee:{noAssignee:"請選擇辦理人員"},columnName:{name:"名稱",code:"編號",department:"組織信息"},title:"審批確認",inputLabel:"審批意見",inputHolder:"請輸入審批意見",footOk:"確定",footCancel:"取消",selectUser:"選擇用戶",hideComment:"意見隱藏",taskForm:"任务办理",success:"成功"},cueWords:{successPass:"審批通過",inputOpinion:"請輸入審批意見",selectNode:"請選擇下一環節",select:"請選擇",processor:"辦理人",attachmentsRequired:"請上傳附件",signatureRequired:"請設置簽名",assignUser:"指派",operateSuccess:"操作成功",commonCommentTooLong:"意見超長（最長255字符），請重新編輯"},task:{selectPlaceholder:"請選擇",passComment:"通過",processAlone:"請單獨處理",urgeText:"接收人员",backNodeText:"節點",selectProcessor:"請選擇辦理人員",notFoundBill:"該單據不支持在電腦端辦理，請嘗試去移動端進行辦理",nextNodeText:"下一環節",assignText:"辦理人員",noUser:"無",title:"任務辦理",noTask:"未找到對應的任務",commentTooLong:"處理意見超出 4000 個英文字符限制，建議以附件方式提交意見",activityName:"辦理人員",receiver:"接收人員",urgeComment:"請輸入催辦信息",noUrgeUsers:"沒有符合條件的催辦用戶",noUrgeSubject:"消息主題未配置",noUrgeContent:"消息內容未配置",person:"人员",addSign:"加签",priority:"紧急程度",selectPriority:"请选择紧急程度"},startProcess:{selectProcess:"請選擇流程",title:"提交確認",selectNode:"請選擇下一環節",submitSuccess:"提交審批成功",submitFailed:"提交審批失敗",cancelSubmitSuccess:"取消提交成功",cancelSubmitFailed:"取消提交失敗",dataIdIsNull:"請選擇一條數據",dataIdIsEmpty:"請選擇一條數據",bizDefKeyIsNull:"流程分類ID不能為空",success:"取消成功",row:"條<br/>",failed:"取消失敗",node:"節點，",noUser:"沒有找到合適的辦理人",cancelSubmitInfo:"已撤回至流程的開始節點，請修改後重新提交",procDef:"流程定义",processTowards:"即將流向",otherNodesAssign:"指定其他節點辦理人"},batchSubmit:{row:"條，<br/>",success:"辦理成功",error:"辦理失敗",failed:"需要交互",single:"失敗的任務請單獨處理",selected:"已選中",item:"項，",time:"預計處理時間較長（大於",second:"秒）"},batchStartProcess:{row:"條，<br/>",success:"提交成功",error:"提交失敗",failed:"需要交互",validationFailed:"驗簽失敗",single:"失敗的單據請單獨處理"},comment:{"static":{title:"常用意見管理",add:"新增","delete":"刪除",save:"保存",cancel:"取消",content:"常用意見",order:"順序",inputLabel:"常用意見",manage:"意見管理",attachmentUpload:"附件",repeatFile:"包含重復文件：",type:"類別",operate:"操作",confirm:"確認",clickToAdd:"新增常用意見","public":"公有","private":"個人",messageSubject:"消息主題",messageContent:"消息內容",comment:"處理意見",tooLongTips:"超出 4000 個英文字符限制，建議以附件方式提交意見"},attachment:{tips:"點擊上傳附件"},signature:{title:"簽名",reset:"清空",ok:"確定",sign:"手寫簽名，",upload:"上傳圖片",tips:"點擊設置簽名",dialogTitle:"電子簽名",note1:"電子簽名可",note2:"也可通過",note3:"進行設置",disable:"不啟用簽名",download:"下載",view:"查看","delete":"删除"}},addSign:{allowSignToSign:"允許再",multiInstanceType:"多人審批方式",parallel:"並行會簽",preempt:"任意人處理",sequential:"按順序依次處理"},backWardConfig:{sequence:"按順序流轉",backToMe:"返回我",backToCurrentNode:"返回本節點",allowResubmitToThisNode:"后再次提交时直接回到本节点"}}},z=(W.prototype.getValue=function(e){if(!e)return"";return-1===e.indexOf(".")?this.langData[e]:e.split(".").reduce(function(e,t){return e?e[t]:null},this.langData)},W.decorators=[{type:C.Injectable}],W.ctorParameters=function(){return[]},W);function W(){this.defaultLang=localStorage.getItem("languageCode"),this.defaultLang?this.langData=_[this.defaultLang]:this.langData=_["zh-CHS"]}var R,q=function(){},G=function(){},K=function(){},J=function(){},X=function(){},$="If_Show_Submit_Dialog",Y="Info_After_Submit",Q="Info_After_Cancel_Submit",Z="If_Use_Sign_By_Default",ee="If_Show_Attachment",te="If_Show_Signature",ne="Default_Approval_Comment",se="If_Store_Comment",ie="If_Can_Edit_Signature",re="bizdefkey",oe=function(){};M(ae,R=oe);function ae(){return null!==R&&R.apply(this,arguments)||this}var ce,le=function(){};M(ue,ce=function(){});function ue(){return null!==ce&&ce.apply(this,arguments)||this}var de=function(){},he=function(){},ge=function(){},fe=(me.prototype.ngOnInit=function(){},me.decorators=[{type:C.Component,args:[{selector:"urge-handle",template:'<div class="wf-task-handler-help-div">\r\n  <div class="wf-task-handler-help-text">\r\n    {{ "comment.static.messageSubject" | translate }}\r\n  </div>\r\n  <div class="farris-input-wrap">\r\n    <input\r\n      class="form-control"\r\n      type="text"\r\n      value="subject"\r\n      name="subject"\r\n      [placeholder]="placeholder"\r\n      [(ngModel)]="urgeMessageSubject"\r\n      [readOnly]="!subjectEditable"\r\n    />\r\n  </div>\r\n</div>\r\n\r\n<div class="wf-task-handler-help-div">\r\n  <div class="wf-task-handler-help-text">\r\n    {{ "comment.static.messageContent" | translate }}\r\n  </div>\r\n  <textarea\r\n    class="form-control content-textarea"\r\n    [(ngModel)]="urgeMessageContent"\r\n    [attr.placeholder]="placeholder"\r\n    [style.height.px]="textAreaHeight"\r\n    [readOnly]="!contentEditable"\r\n  ></textarea>\r\n</div>\r\n',styles:["",".wf-task-handler-help-div{font-size:13px;color:#2d2f33;margin-bottom:14px}.wf-task-handler-help-div-submit{margin-bottom:14px}.wf-task-handler-help-text{padding-bottom:8px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.wf-task-batch-selected{padding-left:8px}.wf-task-batch-rows{font-size:13px;font-weight:500;padding:0 4px;color:#2a87ff}.wf-task-batch-time{font-size:13px;font-weight:500;padding:0 4px;color:#424347}.wf-task-batch-message{display:flex;background:#edf9ff;border:1px solid rgba(196,235,255,1);border-radius:8px;margin-bottom:6px;align-items:center;font-size:12px;padding:4px 10px}.wf-submit-section{padding:4px 24px 0}.wf-submit-item{display:flex;align-items:baseline}.wf-submit-item-label{padding-right:10px;width:88px;text-align:right}.wf-task-splitter{display:flex;align-items:center;color:rgba(0,0,0,.4);font-size:12px;margin-bottom:10px}.wf-task-splitter-line{border-bottom:1px dashed rgba(0,0,0,.1);flex-grow:1}"]}]}],me.ctorParameters=function(){return[]},me.propDecorators={placeholder:[{type:C.Input}],showMessageSubject:[{type:C.Input}],textAreaHeight:[{type:C.Input}],urgeMessageSubject:[{type:C.Input}],urgeMessageContent:[{type:C.Input}],subjectEditable:[{type:C.Input}],contentEditable:[{type:C.Input}]},me);function me(){this.placeholder="",this.showMessageSubject=!1,this.subjectEditable=!1,this.contentEditable=!1}var pe,ve={Preempt:"Preempt",Parallel:"Parallel",Sequential:"Sequential"};M(be,pe=function(){});function be(){return null!==pe&&pe.apply(this,arguments)||this}var ye,Se=function(){this.showDialog=!0},we=(M(Ie,ye=p.ActionBaseImplComponent),Ie.prototype.ngOnDestroy=function(){this.actionToken&&this.taskService.subjectRemove(this.actionToken),this.simulateToken&&this.taskService.subjectRemove(this.simulateToken)},Ie.prototype.ngAfterViewInit=function(){},Ie.prototype.ngOnInit=function(){var s=this,i=this.loadingService.show();this.taskService.getAllUserConfig().subscribe(function(e){i.close();var t,n=(s.configList=e).find(function(e){return e.configCode===ne}),e=e.find(function(e){return e.configCode===se});n&&n.currentValue&&(n="zh-CHS"==s.language?(t=JSON.parse(n.currentValue).pass,JSON.parse(n.currentValue).back):(t=JSON.parse(n.currentValue)["pass_"+s.language],JSON.parse(n.currentValue)["back_"+s.language]),"Pass"===s.actionEntity.code&&(s.comment=t,s.defaultComment=t),"Back"===s.actionEntity.code&&(s.comment=n,s.defaultComment=n)),e&&"true"===e.currentValue&&s.wfCacheComment&&("Back"==s.actionEntity.code&&s.wfCacheComment==t||(s.comment=s.wfCacheComment))},function(){i.close()}),this.origin===p.ActionOrigin.TaskForm&&(this.initFormEvent(),this.taskService.getTaskFormInfo(this.workItemId).subscribe(function(e){e&&e.billMethodConfigs&&e.billMethodConfigs.length&&(s.billMethodConfigs=e.billMethodConfigs)})),(new le).procInstId=this.processInstanceId},Ie.prototype.addMessageListener=function(){window.addEventListener("message",this.eventHandler,!1),Ie.func=this.eventHandler},Ie.prototype.setTask=function(e){e&&(this.task=e,this.workItemId=e.sourceId,this.processInstanceId=e.processInstanceId,this.wfContext.processCategoryId=e.categoryId,this.selectedPriority=e.priority)},Ie.prototype.setTaskList=function(e){20<e.length&&(this.dialogHeight=290),this.taskList=e,this.batchSecond=Math.ceil(this.taskList.length/6)},Ie.prototype.setAction=function(e){var t=new x.Subject,n=new Se;if(e){if(this.actionEntity=e,this.task)return this.simulate(this.actionEntity);if(this.taskList&&this.taskList.length)return this.batchSimulate()}return setTimeout(function(){t.next(n)},100),t.asObservable()},Ie.prototype.initFormEvent=function(){var n=this;this.actionToken=this.workItemId+"action";var s=this.actionToken,i="FormSubjectCode";window.gspWfEventService=window.gspWfEventService||{},window.gspWfEventService.register=function(e){n.taskService.subjectRegister(i,s),n.ifRegistered=!0,n.formObject=e},window.gspWfEventService.notify=function(e){var t;n.ifRegistered?n.taskService.subjectNotify(s,e):(n.simulateToken=n.workItemId+"simulate",t=n.simulateToken,n.taskService.subjectRegister(i,t),n.taskService.subjectResponse(t,"",function(e){e&&e.dataChanged&&n.completeSimulate()}),n.taskService.subjectNotify(t,e))}},Ie.prototype.beforeCompleteSubmit=function(){var e,t=this;this.origin==p.ActionOrigin.TaskForm&&(e=this.billMethodConfigs.filter(function(e){return e.action===t.actionEntity.code&&"Pre"===e.executionTime}).sort(function(e,t){return e.sortOrder-t.sortOrder}))&&e.length?this.executeFormActions(E(e)):this.completeSubmit()},Ie.prototype.executeFormActions=function(t){var e,n=this;0<t.length?(this.messageSubject=new x.Subject,this.messageSubject.subscribe(function(e){e=e.data.data;if(!0!==e.result)throw n.subject.next({result:!1,isClose:!1}),new Error("审批前表单操作执行失败！");!0===e.dataChanged?n.completeSimulate().subscribe(function(e){e.result?n.executeFormActions(t):n.subject.next({result:!1,isClose:!1})}):n.executeFormActions(t)}),e=t.shift(),this.sendMessage(this.workItemId,e)):this.completeSubmit()},Ie.prototype.simulate=function(e){switch(e.code){case"AssignUser":return this.assignSimulate();case"Claim":case"Unclaim":case"Retrieve":return this.defaultSubjectNext();case"Transfer":return this.transferSimulate();case"AddSign":return this.addSignSimulate();case"AddSignFront":return this.addSignFrontSimulate();case"Notify":return this.notifySimulate();case"Refuse":case"Obsolete":case"Comment":return this.defaultSubjectNext();case"ReadTask":return this.ifShowCommentToMySelf=!0,this.defaultSubjectNext(295);case"UrgeHandle":return this.urgeHandleSimulate();case"CancelConsult":return this.defaultSubjectNext();default:return this.completeSimulate()}},Ie.prototype.batchSimulate=function(){switch(this.actionEntity.code){case"ReadTask":return this.ifShowCommentToMySelf=!0,this.defaultSubjectNext(295);case"Retrieve":return this.defaultSubjectNext();case"Transfer":return this.ifSelectUser=!0,this.selectUserText=this.i18nService.getValue("task.receiver"),this.singleSelect=!0,this.defaultSubjectNext(this.dialogHeight+this.dialogHeightBase);default:return this.defaultSubjectNext()}},Ie.prototype.defaultSubjectNext=function(e){var t=new x.Subject,n=new Se;return n.showDialog=!0,n.dialogHeight=e||this.dialogHeight,n.result=!0,setTimeout(function(){t.next(n)},100),t.asObservable()},Ie.prototype.submit=function(){switch(this.actionEntity.code){case"AssignUser":this.assignSubmit();break;case"Claim":this.claimSubmit();break;case"Unclaim":this.unClaimSubmit();break;case"Retrieve":this.retrieveSubmit();break;case"Transfer":this.transferSubmit();break;case"AddSign":this.addSignSubmit();break;case"AddSignFront":this.addSignFrontSubmit();break;case"Comment":this.commentSubmit();break;case"Notify":this.notifySubmit();break;case"ReadTask":this.readSubmit();break;case"UrgeHandle":this.urgeHandleSubmit();break;case"CancelConsult":this.cancelConsultSubmit();break;default:this.beforeCompleteSubmit()}return this.subject.asObservable()},Ie.prototype.batchSubmit=function(e){switch(this.actionEntity.code){case"ReadTask":return this.batchReadTaskSubmit(e);case"Retrieve":return this.batchRetrieveSubmit(e);case"Claim":return this.batchClaimSubmit(e);case"Unclaim":return this.batchUnclaimSubmit(e);case"Transfer":return this.batchTransferSubmit(e);default:return this.batchCompleteSubmit(e)}},Ie.prototype.batchCompleteSubmit=function(a){var e,t,c=this,l=0,u=new x.BehaviorSubject(null),d={result:!0,isClose:!0};if("Back"!==this.actionEntity.code&&"Refuse"!==this.actionEntity.code||this.comment)if(this.taskService.getBytesLength(this.comment)>this.MAX_COMMENT_LENGTH)this.notify.warning(this.i18nService.getValue("task.commentTooLong")),u.next({result:!1,isClose:!1});else{var n=a.filter(function(e){return-1===e.actions.findIndex(function(e){return e.code===c.actionEntity.code})});if(n&&0<n.length)try{for(var s=U(n),i=s.next();!i.done;i=s.next()){i.value;++l===a.length&&(u.next(d),this.showBatchSubmitInfo(0,l,0,0))}}catch(r){e={error:r}}finally{try{i&&!i.done&&(t=s["return"])&&t.call(s)}finally{if(e)throw e.error}}var h=a.filter(function(e){return e.actions.some(function(e){return e.code===c.actionEntity.code})});h&&0<h.length&&this.executeBatchEvent(E(this.actionEntity.preEvents.filter(function(e){return e.batch})),h,this.actionEntity,function(e){var t,n;if(e&&e.result){if(e.passTasks){var s=h.filter(function(t){return-1===e.passTasks.findIndex(function(e){return e===t.id})});if(s&&0<s.length)try{for(var i=U(s),r=i.next();!r.done;r=i.next()){r.value;++l===a.length&&(u.next(d),c.showBatchSubmitInfo(0,l,0,0))}}catch(o){n={error:o}}finally{try{r&&!r.done&&(t=i["return"])&&t.call(i)}finally{if(n)throw n.error}}h=h.filter(function(t){return-1<e.passTasks.findIndex(function(e){return e===t.id})})}0<h.length&&(n=new he,c.batchVerifySubmit(h,l,n).subscribe(function(e){e&&e.successSubmit&&e.successSubmit.result&&c.executeBatchEvent(E(c.actionEntity.postEvents.filter(function(e){return e.batch})),e.successHandleTasks,c.actionEntity,function(){u.next(e.successSubmit)},{result:!0,passTasks:e.successHandleTasks.map(function(e){return e.id})})}))}else u.next({result:!1,isClose:!1})},{result:!0,passTasks:h.map(function(e){return e.id})})}else this.notify.warning(this.i18nService.getValue("cueWords.inputOpinion")),u.next({result:!1,isClose:!1});return u.asObservable()},Ie.prototype.batchVerifySubmit=function(n,s,i){var t=this;void 0===s&&(s=0);var r,o=new x.Subject,a=n.filter(function(e){e=e.actions.find(function(e){return e.code===t.actionEntity.code});return!!e&&!!e.parameters.some(function(e){return"CertificationNecessary"===e.code&&"true"===e.value})}),c=a.length;return 0<a.length?(r=this,window.gspframeworkService&&window.gspframeworkService.rtf&&window.gspframeworkService.rtf.caEvent.on(window.gspframeworkService.rtf.caEvent.signedMsgOverToken(),"signedMsgOver",function(e){var t;e&&"true"===e[0]&&0<e.length?(t=gspCA.getCurCert(),r.verifySigned={certBase64Info:gspCA.getCertBase64(t),msg:["BatchDigitalSignature"],signedmsg:e[1][0],useCase:null},i.verifySigned=r.verifySigned,r.taskService.batchVerifySigned(i).subscribe(function(){r.batchComplete(n,s,0).subscribe(function(e){o.next(e)})},function(e){var t=n.filter(function(t){return-1===a.findIndex(function(e){return e.id===t.id})});r.batchComplete(t,s,c).subscribe(function(e){o.next(e)})})):(r.notify.error(e[1]),o.next({successSubmit:{result:!1,isClose:!1},successHandleTasks:new Array}))}),gspCA.getSignedMsg(["BatchDigitalSignature"])):this.batchComplete(n,s,c).subscribe(function(e){o.next(e)}),o.asObservable()},Ie.prototype.batchComplete=function(s,i,r){var e,t,o=this;void 0===i&&(i=0);var a=new x.Subject,c=0,l=0,u=0,d={result:!0,isClose:!0},h=new Array,g=this.loadingService.show(),f=this;try{for(var n=U(s),m=n.next();!m.done;m=n.next())!function(t){var n=new G;n.workItemId=t.sourceId,n.conclusionValue=f.actionEntity.code,n.comment=f.comment,n.addendum=f.addendum,f.taskService.completeSimulate(n).subscribe(function(e){e&&!0===e.needInteraction?c+ ++l+u===s.length&&(g.close(),a.next({successSubmit:d,successHandleTasks:h}),o.showBatchSubmitInfo(c,l+i,u,r)):o.taskService.complete(n).subscribe(function(){c++,h.push(t),c+l+u===s.length&&(g.close(),a.next({successSubmit:d,successHandleTasks:h}),o.showBatchSubmitInfo(c,l+i,u,r))},function(){c+l+ ++u===s.length&&(g.close(),a.next({successSubmit:d,successHandleTasks:h}),o.showBatchSubmitInfo(c,l+i,u,r))})},function(){c+l+ ++u===s.length&&(g.close(),a.next({successSubmit:d,successHandleTasks:h}),o.showBatchSubmitInfo(c,l+i,u,r))})}(m.value)}catch(p){e={error:p}}finally{try{m&&!m.done&&(t=n["return"])&&t.call(n)}finally{if(e)throw e.error}}return a.asObservable()},Ie.prototype.batchReadTaskSubmit=function(t){var n,s,i,r=this,o=new x.BehaviorSubject(null);return this.taskService.getBytesLength(this.comment)>this.MAX_COMMENT_LENGTH?(this.notify.warning(this.i18nService.getValue("task.commentTooLong")),o.next({result:!1,isClose:!1})):(s=n=0,i=this.loadingService.show(),t.forEach(function(e){e={workItemId:e.sourceId,comment:r.comment,addendum:r.addendum};r.taskService.readTask(e).subscribe(function(e){++n+s==t.length&&(i.close(),o.next({result:!0,isClose:!0}),r.showBatchSubmitInfo(n,0,s,0))},function(e){n+ ++s==t.length&&(i.close(),o.next({result:!1,isClose:!1}),r.showBatchSubmitInfo(n,0,s,0))})})),o.asObservable()},Ie.prototype.batchRetrieveSubmit=function(t){var n,s,i,r=this,o=new x.BehaviorSubject(null);return this.taskService.getBytesLength(this.comment)>this.MAX_COMMENT_LENGTH?(this.notify.warning(this.i18nService.getValue("task.commentTooLong")),o.next({result:!1,isClose:!1})):(s=n=0,i=this.loadingService.show(),t.forEach(function(e){e={workItemId:e.sourceId,comment:r.comment,addendum:r.addendum};r.taskService.retrieve(e).subscribe(function(e){++n+s==t.length&&(i.close(),r.showBatchSubmitInfo(n,0,s,0),o.next({result:!0,isClose:!0}))},function(e){n+ ++s==t.length&&(i.close(),o.next({result:!1,isClose:!1}),r.showBatchSubmitInfo(n,0,s,0))})})),o.asObservable()},Ie.prototype.batchClaimSubmit=function(t){var n,s,i,r=this,o=new x.BehaviorSubject(null);return this.taskService.getBytesLength(this.comment)>this.MAX_COMMENT_LENGTH?(this.notify.warning(this.i18nService.getValue("task.commentTooLong")),o.next({result:!1,isClose:!1})):(s=n=0,i=this.loadingService.show(),t.forEach(function(e){r.taskService.claim(e.sourceId,r.comment).subscribe(function(e){++n+s==t.length&&(i.close(),r.showBatchSubmitInfo(n,0,s,0),o.next({result:!0,isClose:!0}))},function(e){n+ ++s==t.length&&(i.close(),o.next({result:!1,isClose:!1}),r.showBatchSubmitInfo(n,0,s,0))})})),o.asObservable()},Ie.prototype.batchUnclaimSubmit=function(t){var n,s,i,r=this,o=new x.BehaviorSubject(null);return this.taskService.getBytesLength(this.comment)>this.MAX_COMMENT_LENGTH?(this.notify.warning(this.i18nService.getValue("task.commentTooLong")),o.next({result:!1,isClose:!1})):(s=n=0,i=this.loadingService.show(),t.forEach(function(e){r.taskService.unClaim(e.sourceId,r.comment).subscribe(function(e){++n+s==t.length&&(i.close(),r.showBatchSubmitInfo(n,0,s,0),o.next({result:!0,isClose:!0}))},function(e){n+ ++s==t.length&&(i.close(),o.next({result:!1,isClose:!1}),r.showBatchSubmitInfo(n,0,s,0))})})),o.asObservable()},Ie.prototype.batchTransferSubmit=function(t){var n,s,i,r=this,o=new x.BehaviorSubject(null);return this.taskService.getBytesLength(this.comment)>this.MAX_COMMENT_LENGTH?(this.notify.warning(this.i18nService.getValue("task.commentTooLong")),o.next({result:!1,isClose:!1})):0===this.selectedUsers.length?(this.notify.warning(this.i18nService.getValue("task.selectPlaceholder")+this.selectUserText),o.next({result:!1,isClose:!1})):(s=n=0,i=this.loadingService.show(),t.forEach(function(e){e={workItemId:e.sourceId,assignee:r.selectedUsers[0],comment:r.comment,addendum:r.addendum};r.taskService.transfer(e).subscribe(function(e){++n+s==t.length&&(i.close(),r.showBatchSubmitInfo(n,0,s,0),o.next({result:!0,isClose:!0}))},function(e){n+ ++s==t.length&&(i.close(),o.next({result:!1,isClose:!1}),r.showBatchSubmitInfo(n,0,s,0))})})),o.asObservable()},Ie.prototype.showBatchSubmitInfo=function(e,t,n,s){var i="";!e||t||n||s?(e&&(i+=this.i18nService.getValue("batchSubmit.success")+"【"+e+"】"+this.i18nService.getValue("batchSubmit.row")),n&&(i+=this.i18nService.getValue("batchSubmit.error")+"【"+n+"】"+this.i18nService.getValue("batchSubmit.row")),t&&(i+=this.i18nService.getValue("batchSubmit.failed")+"【"+t+"】"+this.i18nService.getValue("batchSubmit.row")),s&&(i+=this.i18nService.getValue("batchSubmit.validationFailed")+"【"+s+"】"+this.i18nService.getValue("batchSubmit.row")),i+=this.i18nService.getValue("batchSubmit.single"),this.message.show("warning",i,{safeHtml:!1})):this.notify.success(this.actionEntity.name+this.i18nService.getValue("static.success"))},Ie.prototype.executeBatchEvent=function(t,n,s,i,r){var e,o,a,c=this;this.injector&&t&&0<t.length&&n&&0<n.length?(o=(e=t.shift()).eventImpl.split("#")[0],a=e.eventImpl.split("#")[1],System["import"](o+"?v="+(new Date).getTime().toString()).then(function(e){e=Object.values(e)[0].create(c.injector);e.instance[a].apply(e.instance,[{action:s,taskList:n,origin:"TaskCenter",preEventResult:r}]).subscribe(function(e){e&&e.result?c.executeBatchEvent(t,n,s,i,e):i(e)})})):i(r)},Ie.prototype.assignSimulate=function(){var t=this,n=new x.Subject,s=new Se;return this.ifAssignUser=!0,this.dialogHeight+=this.dialogHeightBase,this.enablePriority=!0,this.task.priority&&(this.dialogHeight+=this.dialogHeightBase),this.taskService.getAssigneeInfo(this.workItemId).subscribe(function(e){t.assignInfos=[{selectedAssignees:e.selectedAssignees,assigneeInfo:e.assigneeInfo,assignees:e.selectedAssignees.map(function(e){return{id:e.id,name:e.name}}),activityDefinitionName:e.activityDefinitionName,activityDefinitionId:e.activityDefinitionId,dependency:e.dependency,anonymous:e.anonymous,anonymousText:e.anonymousText,resolved:e.resolved}],s.dialogHeight=t.dialogHeight,s.result=!0,s.showDialog=!0,n.next(s)},function(e){s.result=!1,s.showDialog=!1,n.next(s),t.taskService.error(e)}),n.asObservable()},Ie.prototype.transferSimulate=function(){return this.ifSelectUser=!0,this.selectUserText=this.i18nService.getValue("task.receiver"),this.singleSelect=!0,this.dialogHeight+=this.dialogHeightBase,this.enablePriority=!0,this.task.priority&&(this.dialogHeight+=this.dialogHeightBase),this.getOrganizationScope()},Ie.prototype.addSignFrontSimulate=function(){return this.ifSelectUser=!0,this.selectUserText=this.actionEntity.name+this.i18nService.getValue("task.person"),this.dialogHeight+=this.dialogHeightBase,this.enablePriority=!0,this.task.priority&&(this.dialogHeight+=this.dialogHeightBase),this.getOrganizationScope()},Ie.prototype.addSignSimulate=function(){var t=this,n=new x.Subject,s=new Se;this.ifSelectUser=!0,this.selectUserText=this.actionEntity.name+this.i18nService.getValue("task.person"),this.dialogHeight+=2*this.dialogHeightBase,this.enablePriority=!0,this.task.priority&&(this.dialogHeight+=this.dialogHeightBase);var i=this.loadingService.show();return this.taskService.getAdhocConfig(this.workItemId).subscribe(function(e){i.close(),t.addSign.showSignToSign=e.showSignToSign,t.addSign.originMultiInstType=e.multiInstanceType,e.organization&&(t.filter.orgId=e.organization.id,t.filter.withAllOrg=e.organization.includeChildren),s.dialogHeight=t.dialogHeight,s.showDialog=!0,s.result=!0,n.next(s)},function(e){i.close(),t.taskService.error(e),s.showDialog=!1,s.result=!1,n.next(s)}),n.asObservable()},Ie.prototype.notifySimulate=function(){return this.ifSelectUser=!0,this.selectUserText=this.actionEntity.name+this.i18nService.getValue("task.person"),this.dialogHeight+=this.dialogHeightBase,this.singleSelect=!1,this.enablePriority=!0,this.task.priority&&(this.dialogHeight+=this.dialogHeightBase),this.getOrganizationScope()},Ie.prototype.getOrganizationScope=function(){var t=this,n=new x.Subject,s=new Se,i=this.loadingService.show();return this.taskService.getOrganizationScope(this.workItemId,this.actionEntity.code).subscribe(function(e){i.close(),e.length&&(t.filter.orgId=e[0].id,t.filter.withAllOrg=e[0].includeChildren),s.dialogHeight=t.dialogHeight,s.showDialog=!0,s.result=!0,n.next(s)},function(e){i.close(),t.taskService.error(e),s.showDialog=!1,s.result=!1,n.next(s)}),n.asObservable()},Ie.prototype.urgeHandleSimulate=function(){var n=this,s=new x.Subject,i=new Se;this.ifSelectNode=!1,this.ifSelectUser=!1,this.ifAssignUser=!1,this.ifUrgeType=!0,this.commentPlaceHolder=this.i18nService.getValue("task.urgeComment"),this.showCommonComment=!1,this.showAttachment=!1,this.showUrgeMessageSubject=!0,this.showSign=!1,this.dialogHeight+=2*this.dialogHeightBase;var r=this.loadingService.show(),e=new le;return e.procInstId=this.processInstanceId,this.taskService.urgeHandleSimulate(e).subscribe(function(e){var t;r.close(),(n.urgeHandleResponse=e)&&e.urgeUsers&&e.urgeUsers.length?(n.urgeMessageSubject=e.urgeUsers[0].urgeInfos[0].urgeMessageSubject,n.urgeMessageContent=e.urgeUsers[0].urgeInfos[0].urgeMessageContent,n.subjectEditable=e.urgeUsers[0].urgeInfos[0].subjectEditable,n.contentEditable=e.urgeUsers[0].urgeInfos[0].contentEditable,n.addReminder=e.urgeUsers[0].urgeInfos[0].addReminder,t=e.urgeUsers,e=new X,t.forEach(function(e){e.anonymousText&&(e.name=e.anonymousText,e.code="",e.orgName="")}),e.assigneeUsers=t,e.selectAssignee=1<t.length,e.multiSelect=!0,n.assignInfos[0].assigneeInfo=e,n.assignInfos[0].assignees=1==t.length?t:[],i.showDialog=!0):(n.notify.warning(n.i18nService.getValue("task.noUrgeUsers")),i.showDialog=!1),i.dialogHeight=n.dialogHeight,i.result=!0,s.next(i)},function(e){r.close(),n.taskService.error(e),i.showDialog=!1,i.result=!1,s.next(i)}),s.asObservable()},Ie.prototype.completeSimulate=function(){var n=this,s=new x.Subject,i=new Se;this.actionEntity.parameters&&this.actionEntity.parameters.length&&this.actionEntity.parameters.forEach(function(e){var t;"AddSignBehindAble"===e.code&&"true"===e.value&&(n.ifSelectUser=!0,n.selectUserText=n.i18nService.getValue("task.addSign")+n.i18nService.getValue("task.person"),n.dialogHeight+=n.dialogHeightBase,t=n.loadingService.show(),n.taskService.getOrganizationScope(n.workItemId,"AddSignBehind").subscribe(function(e){t.close(),e.length&&(n.filter.orgId=e[0].id,n.filter.withAllOrg=e[0].includeChildren)},function(e){t.close(),n.taskService.error(e)}))}),"Back"===this.actionEntity.code&&(this.selectNodeText=this.actionEntity.name+this.i18nService.getValue("task.backNodeText"));var e=new G;e.workItemId=this.workItemId,e.conclusionValue=this.actionEntity.code;var r=this.loadingService.show();return this.taskService.completeSimulate(e).subscribe(function(e){var t;r.close(),n.clearSimulateResult(),n.response=e,n.task.priority&&(n.enablePriority=!0,n.dialogHeight+=n.dialogHeightBase),n.selectTargetAble=e.selectTargetAble,e.dynamicBackWardRuleConfig&&(n.showBackWardConfig.dynamicBackWardRuleAble=e.dynamicBackWardRuleConfig.dynamicBackWardRuleAble,n.showBackWardConfig.displayPlaceholder=e.dynamicBackWardRuleConfig.resubmitEffect),e.simulationPaths.length?(n.ifSelectNode=!0,n.ifAssignUser=!0,n.dialogHeight+=2*n.dialogHeightBase,n.destNodes=e.simulationPaths&&e.simulationPaths.map(function(e){return{id:e.nodeInfoList.map(function(e){return e.activityDefinitionId}).join("，"),name:e.nodeInfoList.map(function(e){return e.activityDefinitionName}).join("，")}}),-1<(t=(t=e.simulationPaths.findIndex(function(e){return e["default"]}))<0&&!e.selectTargetAble?e.simulationPaths.findIndex(function(e){return e.nodeInfoList&&0<e.nodeInfoList.length}):t)&&(n.selectedNodeId=n.destNodes[t].id,n.nodeDefaultValue=(-1<n.destNodes[t].name.indexOf("，")?e.simulationPaths:n.destNodes)[t].name,n.setAssignInfo(e.simulationPaths[t].nodeInfoList),e.simulationPaths[t].id.startsWith("EndEvent")&&(n.dialogHeight=340))):(n.ifSelectNode=!1,n.ifAssignUser=!1),n.setOtherAssignInfo(e),n.dialogHeight=n.showBackWardConfig.dynamicBackWardRuleAble?n.dialogHeight+n.dialogHeightBase:n.dialogHeight,i.result=!0,i.showDialog=!0,i.dialogHeight=n.dialogHeight,s.next(i)},function(e){r.close(),i.result=!1,i.showDialog=!1,s.next(i),n.taskService.error(e)}),s.asObservable()},Ie.prototype.clearSimulateResult=function(){this.assignInfos=[{selectedAssignees:[],assigneeInfo:null,assignees:[],activityDefinitionName:"",activityDefinitionId:"",dependency:"",anonymous:!1,anonymousText:"",resolved:!1}],this.destNodes=[],this.selectedNodeId=""},Ie.prototype.setAssignInfo=function(n){var s=this;this.assignInfos=[],this.selectedNodeId.split("，").forEach(function(t){var e=n.find(function(e){return e.activityDefinitionId===t});e?s.assignInfos.push({selectedAssignees:e.selectedAssignees,assigneeInfo:e.assigneeInfo,assignees:e.selectedAssignees.map(function(e){return{id:e.id,name:e.name}}),activityDefinitionName:e.activityDefinitionName,activityDefinitionId:e.activityDefinitionId,dependency:e.dependency,anonymous:e.anonymous,anonymousText:e.anonymousText,resolved:e.resolved}):s.assignInfos.push({selectedAssignees:[],assigneeInfo:null,assignees:[],activityDefinitionName:"",activityDefinitionId:"",dependency:"",anonymous:!1,anonymousText:"",resolved:!1})})},Ie.prototype.setOtherAssignInfo=function(e){var n=this;this.otherAssignInfos=[];var t=[],e=e.otherAssignNodes;e&&e.length&&(e.forEach(function(e){t.push({selectedAssignees:e.selectedAssignees,assigneeInfo:e.assigneeInfo,assignees:e.selectedAssignees.map(function(e){return{id:e.id,name:e.name}}),activityDefinitionName:e.activityDefinitionName,activityDefinitionId:e.activityDefinitionId,dependency:e.dependency,anonymous:e.anonymous,anonymousText:e.anonymousText,resolved:e.resolved})}),this.originOtherAssignInfos=E(t),this.assignInfos&&this.assignInfos.length&&(t=t.filter(function(t){return n.assignInfos.findIndex(function(e){return e.activityDefinitionId==t.activityDefinitionId})<0})),this.otherAssignInfos=t)},Ie.prototype.setOtherAssignInfoAgain=function(e){e&&e.length&&(this.otherAssignInfos=this.originOtherAssignInfos.filter(function(t){return e.findIndex(function(e){return e.activityDefinitionId==t.activityDefinitionId})<0}))},Ie.prototype.assignSubmit=function(){var e,t=this;this.taskService.getBytesLength(this.comment)>this.MAX_COMMENT_LENGTH?(this.notify.warning(this.i18nService.getValue("task.commentTooLong")),this.subject.next({result:!1,isClose:!1})):this.assignInfos[0].assignees.length?(e={workItemId:this.workItemId,assigneeIds:this.assignInfos[0].assignees.map(function(e){return e.id}),comment:this.comment,addendum:this.addendum,priority:this.selectedPriority},this.taskService.assignNextUsersByWorkItemId(e).subscribe(function(){t.notify.success(t.i18nService.getValue("cueWords.operateSuccess")),t.subject.next(t.submitResult)},function(e){t.subject.next({result:!1,isClose:!1}),t.taskService.error(e)})):(this.notify.warning(this.i18nService.getValue("static.assignee.noAssignee")),this.subject.next({result:!1,isClose:!1}))},Ie.prototype.claimSubmit=function(){var t=this;this.taskService.getBytesLength(this.comment)>this.MAX_COMMENT_LENGTH?(this.notify.warning(this.i18nService.getValue("task.commentTooLong")),this.subject.next({result:!1,isClose:!1})):this.taskService.claim(this.workItemId,this.comment).subscribe(function(){t.notify.success(t.actionEntity.name+t.i18nService.getValue("static.success")),t.subject.next(t.submitResult)},function(e){t.subject.next({result:!1,isClose:!1}),t.taskService.error(e)})},Ie.prototype.unClaimSubmit=function(){var t=this;this.taskService.getBytesLength(this.comment)>this.MAX_COMMENT_LENGTH?(this.notify.warning(this.i18nService.getValue("task.commentTooLong")),this.subject.next({result:!1,isClose:!1})):this.taskService.unClaim(this.workItemId,this.comment).subscribe(function(){t.notify.success(t.actionEntity.name+t.i18nService.getValue("static.success")),t.subject.next(t.submitResult)},function(e){t.subject.next({result:!1,isClose:!1}),t.taskService.error(e)})},Ie.prototype.retrieveSubmit=function(){var e,t=this;this.taskService.getBytesLength(this.comment)>this.MAX_COMMENT_LENGTH?(this.notify.warning(this.i18nService.getValue("task.commentTooLong")),this.subject.next({result:!1,isClose:!1})):(e={workItemId:this.workItemId,comment:this.comment},this.taskService.retrieve(e).subscribe(function(){t.notify.success(t.actionEntity.name+t.i18nService.getValue("static.success")),t.subject.next(t.submitResult)},function(e){t.subject.next({result:!1,isClose:!1}),t.taskService.error(e)}))},Ie.prototype.transferSubmit=function(){var e,t=this;this.taskService.getBytesLength(this.comment)>this.MAX_COMMENT_LENGTH?(this.notify.warning(this.i18nService.getValue("task.commentTooLong")),this.subject.next({result:!1,isClose:!1})):0===this.selectedUsers.length?(this.notify.warning(this.i18nService.getValue("task.selectPlaceholder")+this.selectUserText),this.subject.next({result:!1,isClose:!1})):(e={workItemId:this.workItemId,assignee:this.selectedUsers[0],comment:this.comment,addendum:this.addendum,priority:this.selectedPriority},this.submitDisable=!0,this.taskService.transfer(e).subscribe(function(){t.notify.success(t.actionEntity.name+t.i18nService.getValue("static.success")),t.subject.next(t.submitResult)},function(e){t.subject.next({result:!1,isClose:!1}),t.taskService.error(e)}))},Ie.prototype.commentSubmit=function(){var e,t=this;this.comment&&0!==this.comment.length?this.taskService.getBytesLength(this.comment)>this.MAX_COMMENT_LENGTH?(this.notify.warning(this.i18nService.getValue("task.commentTooLong")),this.subject.next({result:!1,isClose:!1})):(e={workItemId:this.workItemId,comment:this.comment,addendum:this.addendum},this.taskService.comment(e).subscribe(function(){t.notify.success(t.actionEntity.name+t.i18nService.getValue("static.success")),t.submitResult.isClose=!1,t.subject.next(t.submitResult)},function(e){t.subject.next({result:!1,isClose:!1}),t.taskService.error(e)}),this.comment=""):(this.notify.warning(this.i18nService.getValue("cueWords.inputOpinion")),this.subject.next({result:!1,isClose:!1}))},Ie.prototype.addSignFrontSubmit=function(){var e,t=this;this.taskService.getBytesLength(this.comment)>this.MAX_COMMENT_LENGTH?(this.notify.warning(this.i18nService.getValue("task.commentTooLong")),this.subject.next({result:!1,isClose:!1})):0===this.selectedUsers.length?(this.notify.warning(this.i18nService.getValue("task.selectPlaceholder")+this.selectUserText),this.subject.next({result:!1,isClose:!1})):(e={workItemId:this.workItemId,action:this.actionEntity.code,assignees:this.selectedUsers,comment:this.comment,addendum:this.addendum,priority:this.selectedPriority},this.submitDisable=!0,this.taskService.addSign(e).subscribe(function(){t.notify.success(t.actionEntity.name+t.i18nService.getValue("static.success")),t.subject.next(t.submitResult)},function(e){t.subject.next({result:!1,isClose:!1}),t.taskService.error(e)}))},Ie.prototype.addSignSubmit=function(){var e,t,n=this;this.taskService.getBytesLength(this.comment)>this.MAX_COMMENT_LENGTH?(this.notify.warning(this.i18nService.getValue("task.commentTooLong")),this.subject.next({result:!1,isClose:!1})):0===this.selectedUsers.length?(this.notify.warning(this.i18nService.getValue("task.selectPlaceholder")+this.selectUserText),this.subject.next({result:!1,isClose:!1})):(e={workItemId:this.workItemId,comment:this.comment,conclusionValue:"Pass",signAssignees:this.selectedUsers,actionCode:"AddSignBehind",multiInstanceType:this.addSign.showMultiInstanceType?this.addSign.curMultiInstType:this.addSign.originMultiInstType,counterSignRule:"allPass",completedRule:"all",allowSignToSign:this.addSign.allowSignToSIgn,activityName:"",addendum:this.addendum,priority:this.selectedPriority},t=this.loadingService.show(),this.taskService.adhocAssignee(e).subscribe(function(e){n.notify.success(n.actionEntity.name+n.i18nService.getValue("static.success")),n.subject.next({result:!0,isClose:!0}),t.close()},function(e){t.close(),n.subject.next({result:!1,isClose:!1}),n.taskService.error(e)}))},Ie.prototype.readSubmit=function(){var e,t=this;this.taskService.getBytesLength(this.comment)>this.MAX_COMMENT_LENGTH?(this.notify.warning(this.i18nService.getValue("task.commentTooLong")),this.subject.next({result:!1,isClose:!1})):(e={workItemId:this.workItemId,comment:this.comment,addendum:this.addendum,hideComment:this.hideComment},this.taskService.readTask(e).subscribe(function(){t.notify.success(t.actionEntity.name+t.i18nService.getValue("static.success")),t.subject.next({result:!0,isClose:!0})},function(e){t.taskService.error(e),t.subject.next({result:!1,isClose:!1})}))},Ie.prototype.notifySubmit=function(){var e,t=this;this.taskService.getBytesLength(this.comment)>this.MAX_COMMENT_LENGTH?(this.notify.warning(this.i18nService.getValue("task.commentTooLong")),this.subject.next({result:!1,isClose:!1})):0===this.selectedUsers.length?(this.notify.warning(this.i18nService.getValue("task.selectPlaceholder")+this.selectUserText),this.subject.next({result:!1,isClose:!1})):(e={workItemId:this.workItemId,comment:this.comment,addendum:this.addendum,action:this.actionEntity.code,assignees:this.selectedUsers,priority:this.selectedPriority},this.taskService.addSign(e).subscribe(function(){t.notify.success(t.actionEntity.name+t.i18nService.getValue("static.success")),t.subject.next({result:!0,isClose:!1})},function(e){t.subject.next({result:!1,isClose:!1}),t.taskService.error(e)}))},Ie.prototype.urgeHandleSubmit=function(){var e,t,n=this;this.taskService.getBytesLength(this.comment)>this.MAX_COMMENT_LENGTH?(this.notify.warning(this.i18nService.getValue("task.commentTooLong")),this.subject.next({result:!1,isClose:!1})):this.urgeHandleResponse.urgeUsers&&this.urgeHandleResponse.urgeUsers.length?this.assignInfos[0].assignees.length?this.urgeHandleComponent.urgeMessageSubject?this.urgeHandleComponent.urgeMessageContent?((e=new de).procInstId=this.processInstanceId,e.urgeUsers=this.urgeHandleResponse.urgeUsers.filter(function(t){return n.assignInfos[0].assignees.some(function(e){return e.id==t.id})}),e.urgeMessageSubject=this.urgeHandleComponent.urgeMessageSubject,e.urgeMessageContent=this.urgeHandleComponent.urgeMessageContent,e.addReminder=this.addReminder,t=this.loadingService.show(),this.taskService.urgeHandle(e).subscribe(function(e){n.notify.success(n.actionEntity.name+n.i18nService.getValue("static.success")),n.subject.next({result:!0,isClose:!0}),t.close()},function(e){t.close(),n.subject.next({result:!1,isClose:!1}),n.taskService.error(e)})):(this.notify.warning(this.i18nService.getValue("task.noUrgeContent")),this.subject.next({result:!1,isClose:!1})):(this.notify.warning(this.i18nService.getValue("task.noUrgeSubject")),this.subject.next({result:!1,isClose:!1})):(this.notify.warning(this.i18nService.getValue("task.selectPlaceholder")+this.i18nService.getValue("task.receiver")),this.subject.next({result:!1,isClose:!1})):(this.notify.warning(this.i18nService.getValue("task.noUrgeUsers")),this.subject.next({result:!1,isClose:!1}))},Ie.prototype.cancelConsultSubmit=function(){var t=this,e=new oe;e.workItemId=this.workItemId,e.comment=this.comment,e.addendum=this.addendum;var n=this.loadingService.show();this.taskService.cancelConsult(e).subscribe(function(){n.close(),t.notify.success(t.actionEntity.name+t.i18nService.getValue("static.success")),t.subject.next({result:!0,isClose:!0})},function(e){n.close(),t.subject.next({result:!1,isClose:!1}),t.taskService.error(e)})},Ie.prototype.completeSubmit=function(){var e={workItemId:this.workItemId,conclusionValue:this.actionEntity.code,comment:this.comment,signAssignees:this.selectedUsers,nextFlowNodes:[],otherAssignNodes:[],addendum:this.addendum,dynamicBackWardRule:this.showBackWardConfig.dynamicBackWardRuleAble?this.showBackWardConfig.displayPlaceholder:"",priority:this.selectedPriority};if(!e.signAssignees.length&&this.response&&this.response.simulationPaths.length){if(this.selectedNodeId){for(var t=[],n=this.selectedNodeId.split("，"),s=0;s<n.length;s++){var i={activityDefinitionId:n[s],activityDefinitionName:this.assignInfos[s].activityDefinitionName,dependency:this.assignInfos[s].dependency,selectedAssignees:this.assignInfos[s].assigneeInfo?this.assignInfos[s].assignees:[],assigneeInfo:null,resolved:!1,anonymous:this.assignInfos[s].anonymous,anonymousText:this.assignInfos[s].anonymousText};if(this.response&&this.response.simulationPaths.length&&!this.response.simulationPaths[0].id.startsWith("ParallelGateway")&&1==n.length&&n[s].startsWith("UserActivity")&&this.assignInfos[s].resolved&&!this.assignInfos[s].assigneeInfo&&!this.assignInfos[s].selectedAssignees.length){var r=this.assignInfos[s].activityDefinitionName+this.i18nService.getValue("startProcess.node")+this.i18nService.getValue("startProcess.noUser");return this.notify.warning(r),void this.subject.next({result:!1,isClose:!1})}t.push(i)}e.nextFlowNodes=t}if(this.otherAssignInfos&&this.otherAssignInfos.length)for(s=0;s<this.otherAssignInfos.length;s++){i={activityDefinitionId:this.otherAssignInfos[s].activityDefinitionId,activityDefinitionName:this.otherAssignInfos[s].activityDefinitionName,dependency:this.otherAssignInfos[s].dependency,selectedAssignees:this.otherAssignInfos[s].assigneeInfo?this.otherAssignInfos[s].assignees:[],assigneeInfo:null,resolved:!1,anonymous:!1,anonymousText:""};e.otherAssignNodes.push(i)}this.response.selectTargetAble&&1<this.destNodes.length&&e.nextFlowNodes.length<=0?(this.notify.warning(this.i18nService.getValue("cueWords.selectNode")),this.subject.next({result:!1,isClose:!1})):this.assignInfos.filter(function(e){return e.assigneeInfo&&e.assigneeInfo.selectAssignee&&!e.assignees.length}).length?(this.notify.warning(this.i18nService.getValue("task.selectProcessor")),this.subject.next({result:!1,isClose:!1})):this.completeTask(e)}else this.completeTask(e)},Ie.prototype.completeTask=function(e){var t=this,n=this.actionEntity.parameters.find(function(e){return"AttachmentNecessary"===e.code}),s=this.actionEntity.parameters.find(function(e){return"CertificationNecessary"===e.code}),i=this.actionEntity.parameters.find(function(e){return"CommentNecessary"===e.code});!n||"true"!==n.value||e.addendum.attachment&&"[]"!==e.addendum.attachment?i&&"true"===i.value&&!e.comment?(this.notify.warning(this.i18nService.getValue("cueWords.inputOpinion")),this.subject.next({result:!1,isClose:!1})):this.taskService.getBytesLength(this.comment)>this.MAX_COMMENT_LENGTH?(this.notify.warning(this.i18nService.getValue("task.commentTooLong")),this.subject.next({result:!1,isClose:!1})):s&&"true"===s.value?(this.verifySignature(function(){e.verifySigned=t.verifySigned,t.taskComplete(e)}),s=[this.workItemId],gspCA.getSignedMsg(s)):this.taskComplete(e):(this.notify.warning(this.i18nService.getValue("cueWords.attachmentsRequired")),this.subject.next({result:!1,isClose:!1}))},Ie.prototype.executeFormActionsAfterCompleteTask=function(e){var t,n=this;this.origin==p.ActionOrigin.TaskForm&&this.ifRegistered&&this.formObject?(t=this.billMethodConfigs.filter(function(e){return e.action===n.actionEntity.code&&"Post"===e.executionTime}).sort(function(e,t){return e.sortOrder-t.sortOrder}))&&t.length&&this.executePostFormActions(t,e):e()},Ie.prototype.executePostFormActions=function(t,n){var e,s=this;0<t.length?(this.messageSubject=new x.Subject,this.messageSubject.subscribe(function(e){if(!0!==e.data.data.result)throw s.subject.next({result:!1,isClose:!1}),new Error("审批后表单操作执行失败！");s.executePostFormActions(t,n)}),e=t.shift(),this.sendMessage(this.workItemId,e)):n()},Ie.prototype.afterConfirmForTransfer=function(e){e&&e.length?(this.selectedUsers=e.map(function(e){return e.id}),this.selectedUserNgModule=e.map(function(e){return e.name}).join()):this.selectedUsers=[],"AddSign"==this.actionEntity.code&&this.addSign.originMultiInstType==ve.Preempt.toString()&&1<this.selectedUsers.length?this.addSign.showMultiInstanceType=!0:this.addSign.showMultiInstanceType=!1},Ie.prototype.cancel=function(){return this.submitResult.isClose=!1,this.subject.next(this.submitResult),this.subject.asObservable()},Ie.prototype.getSubject=function(){return this.subject.asObservable()},Ie.prototype.selectNodeChange=function(e){var t,n=this;this.selectedNodeId=e&&e.data&&e.data.id,this.response.simulationPaths[e.index].nodeInfoList.every(function(e){return!0===e.resolved})?(this.setAssignInfo(this.response.simulationPaths[e.index].nodeInfoList),this.setOtherAssignInfoAgain(this.response.simulationPaths[e.index].nodeInfoList)):(e=this.selectedNodeId.split("，").map(function(e){return'"'+e+'"'}).join(),t=this.loadingService.show(),this.taskService.getSimulationAssigneeInfo(this.workItemId,e).subscribe(function(e){t.close(),n.setAssignInfo(e),n.setOtherAssignInfoAgain(e)},function(e){t.close(),n.taskService.error(e)}))},Ie.prototype.selectNodeClear=function(){this.selectedNodeId=null,this.assignInfos=[{selectedAssignees:[],assigneeInfo:null,assignees:[],activityDefinitionName:"",activityDefinitionId:"",dependency:"",anonymous:!1,anonymousText:"",resolved:!1}]},Ie.prototype.afterConfirmForAssign=function(e,t){this.assignInfos[t].assignees=e},Ie.prototype.afterConfirmForOtherAssign=function(e,t){this.otherAssignInfos[t].assignees=e},Ie.prototype.addAttachment=function(e){this.addendum.attachment=JSON.stringify(e)},Ie.prototype.addSignature=function(e){this.addendum.signature=e?JSON.stringify({id:e,waterMarking:null}):""},Ie.prototype.addPadding=function(){this.cls="f-utils-fill-flex-column h-100 px-4 py-2"},Ie.prototype.sendMessage=function(e,t){var n;this.iframe?(n=this.iframe.nativeElement.contentWindow,t={target:e,data:{command:t.method,arguments:t.methodParameters}},n.postMessage(t,this.POST_MESSAGE_TARGET)):(this.subject.next({result:!1,isClose:!1}),this.notify.warning("请等待表单加载完成后再试"))},Ie.prototype.verifySignature=function(n){var s=this;window.gspframeworkService&&window.gspframeworkService.rtf&&window.gspframeworkService.rtf.caEvent.on(window.gspframeworkService.rtf.caEvent.signedMsgOverToken(),"signedMsgOver",function(e){if(!(e&&"true"===e[0]&&0<e.length))throw s.loadingService.close(),s.subject.next({result:!1,isClose:!1}),s.notify.error(e[1]),new Error(e[1]);var t=gspCA.getCurCert();s.verifySigned={certBase64Info:gspCA.getCertBase64(t),msg:[s.workItemId],signedmsg:e[1][0],useCase:null},n()})},Ie.prototype.taskComplete=function(s){var i=this;this.taskService.complete(s).subscribe(function(n){i.executeFormActionsAfterCompleteTask(function(){var e,t;n.needInteraction?(i.origin==p.ActionOrigin.TaskCenter?i.subject.next({result:!0,isClose:!1}):i.subject.next({result:!1,isClose:!1}),i.notify.info(i.i18nService.getValue("cueWords.select")+"【"+n.nextFlowNodes[0].activityDefinitionName+"】"+i.i18nService.getValue("cueWords.processor")),e=new q,t=new F,e.sourceId=n.nextFlowNodes[0].assigneeInfo.workItemId,t.code="AssignUser",t.name=i.i18nService.getValue("cueWords.assignUser"),i.handlerService.execute(e,t).subscribe(function(e){e&&i.subject.next({result:!0,isClose:!0})})):("Pass"===s.conclusionValue?i.notify.success(i.i18nService.getValue("cueWords.successPass")):(s.conclusionValue,i.notify.success(i.actionEntity.name+i.i18nService.getValue("static.success"))),i.subject.next({result:!0,isClose:!0}))})},function(e){i.subject.next({result:!1,isClose:!1}),i.taskService.error(e)})},Ie.func=null,Ie.decorators=[{type:C.Component,args:[{selector:"lib-task-execute",template:'\x3c!-- 批量审批时提示 --\x3e\r\n<div *ngIf="taskList?.length > 20" class="wf-task-batch-message">\r\n  <span class="f-icon f-icon-info"></span>\r\n  <span class="wf-task-batch-selected">{{\r\n    "batchSubmit.selected" | translate\r\n  }}</span>\r\n  <span class="wf-task-batch-rows">{{ taskList.length }}</span>\r\n  <span>{{ "batchSubmit.item" | translate }}</span>\r\n  <span>{{ "batchSubmit.time" | translate }}</span>\r\n  <span class="wf-task-batch-time">{{ batchSecond }}</span>\r\n  <span>{{ "batchSubmit.second" | translate }}</span>\r\n</div>\r\n\r\n\x3c!-- 意见输入 --\x3e\r\n<wf-comment\r\n  *ngIf="!showUrgeMessageSubject"\r\n  class="w-100"\r\n  name="comment"\r\n  [(ngModel)]="comment"\r\n  [defaultComment]="defaultComment"\r\n  [placeholder]="commentPlaceHolder"\r\n  [processInstanceId]="processInstanceId"\r\n  [showAttachment]="showAttachment"\r\n  [showCommonComment]="showCommonComment"\r\n  [showSign]="showSign"\r\n  [textAreaHeight]="textAreaHeight"\r\n  [TaskCenterConfig]="configList"\r\n  [curUserId]="\r\n    task ? task.owner : taskList && taskList.length ? taskList[0].owner : \'\'\r\n  "\r\n  [taskOrigin]="origin"\r\n  (attachment)="addAttachment($event)"\r\n  (signature)="addSignature($event)"\r\n>\r\n</wf-comment>\r\n\r\n\x3c!--催办消息--\x3e\r\n<urge-handle\r\n  *ngIf="showUrgeMessageSubject"\r\n  [placeholder]="commentPlaceHolder"\r\n  [showMessageSubject]="showUrgeMessageSubject"\r\n  [urgeMessageSubject]="urgeMessageSubject"\r\n  [urgeMessageContent]="urgeMessageContent"\r\n  [subjectEditable]="subjectEditable"\r\n  [contentEditable]="contentEditable"\r\n  [textAreaHeight]="textAreaHeight"\r\n>\r\n</urge-handle>\r\n\r\n\x3c!-- 审批记录隐藏（仅对自己可见） --\x3e\r\n<div\r\n  *ngIf="ifShowCommentToMySelf"\r\n  class="custom-control custom-checkbox custom-control-inline"\r\n  style="margin-bottom: 10px"\r\n>\r\n  <input\r\n    type="checkbox"\r\n    class="custom-control-input"\r\n    [(ngModel)]="hideComment"\r\n    id="taskcenterhidecomment"\r\n    name="taskcenterhidecomment"\r\n  />\r\n  <label class="custom-control-label" for="taskcenterhidecomment">{{\r\n    "static.hideComment" | translate\r\n  }}</label>\r\n</div>\r\n\r\n\x3c!-- 下一环节 --\x3e\r\n<div *ngIf="ifSelectNode" class="wf-task-handler-help-div">\r\n  <div class="wf-task-handler-help-text">{{ selectNodeText }}</div>\r\n  <div class="d-flex" style="flex: 1">\r\n    <farris-combo-list\r\n      style="flex: 1"\r\n      [(ngModel)]="nodeDefaultValue"\r\n      [data]="destNodes"\r\n      [editable]="false"\r\n      [textField]="\'name\'"\r\n      [valueField]="\'id\'"\r\n      [idField]="\'id\'"\r\n      [readonly]="selectTargetAble && destNodes.length > 1 ? false : true"\r\n      (selectChange)="selectNodeChange($event)"\r\n      (clear)="selectNodeClear()"\r\n      [placeholder]="\'task.selectPlaceholder\' | translate"\r\n    >\r\n    </farris-combo-list>\r\n  </div>\r\n</div>\r\n\r\n\x3c!-- 下一环节办理人员（指派） --\x3e\r\n<div *ngIf="ifAssignUser || ifUrgeType">\r\n  <lib-assignee-info\r\n    *ngFor="let assignInfo of assignInfos; let i = index"\r\n    [assigneeInfo]="assignInfo.assigneeInfo"\r\n    [setAnonymous]="assignInfo.anonymous"\r\n    [setAnonymousText]="assignInfo.anonymousText"\r\n    [selectedAssignees]="assignInfo.selectedAssignees"\r\n    [activityName]="\r\n      assignInfos.length > 1\r\n        ? assignInfo.activityDefinitionName\r\n        : ifUrgeType\r\n        ? (\'task.urgeText\' | translate)\r\n        : \'\'\r\n    "\r\n    [ifShowBlank]="false"\r\n    [wfContext]="wfContext"\r\n    (afterConfirm)="afterConfirmForAssign($event, i)"\r\n  ></lib-assignee-info>\r\n</div>\r\n\r\n\x3c!-- 移交、加签、征询、知会 人员帮助--\x3e\r\n<lib-assignee-info\r\n  *ngIf="ifSelectUser"\r\n  [activityName]="selectUserText"\r\n  [singleSelect]="singleSelect"\r\n  [filter]="filter"\r\n  [disabled]="false"\r\n  [placeholder]="\'task.selectPlaceholder\' | translate"\r\n  [allowGlobalAssign]="true"\r\n  [wfContext]="wfContext"\r\n  (afterConfirm)="afterConfirmForTransfer($event)"\r\n>\r\n</lib-assignee-info>\r\n\r\n\x3c!-- 加签 --\x3e\r\n\x3c!-- 审批策略 --\x3e\r\n<div *ngIf="addSign.showMultiInstanceType" class="wf-task-handler-help-div">\r\n  <div class="wf-task-handler-help-text">\r\n    {{ "addSign.multiInstanceType" | translate }}\r\n  </div>\r\n  <div class="d-flex" style="flex: 1">\r\n    <farris-radiogroup\r\n      [(ngModel)]="addSign.curMultiInstType"\r\n      [data]="addSign.multiInstanceType"\r\n      [horizontal]="true"\r\n    >\r\n    </farris-radiogroup>\r\n  </div>\r\n</div>\r\n\r\n\x3c!-- 允许再加签 --\x3e\r\n<div *ngIf="addSign.showSignToSign" class="wf-task-handler-help-div">\r\n  <div class="wf-task-handler-help-text">\r\n    {{ "addSign.allowSignToSign" | translate }}{{ actionEntity.name }}\r\n  </div>\r\n  <farris-switch [(ngModel)]="addSign.allowSignToSIgn" [size]="\'small\'">\r\n  </farris-switch>\r\n</div>\r\n\r\n\x3c!-- 驳回后再次提交时直接回到本节点 --\x3e\r\n<div\r\n  *ngIf="showBackWardConfig.dynamicBackWardRuleAble"\r\n  class="wf-task-handler-help-div"\r\n>\r\n  <div class="wf-task-handler-help-text">{{ showBackWardConfig.title }}</div>\r\n  <div class="d-flex" style="flex: 1">\r\n    <farris-combo-list\r\n      style="flex: 1"\r\n      [(ngModel)]="showBackWardConfig.displayPlaceholder"\r\n      [data]="showBackWardConfig.backWardRules"\r\n      [editable]="false"\r\n      [textField]="\'name\'"\r\n      [valueField]="\'value\'"\r\n      [idField]="\'value\'"\r\n      [readonly]="false"\r\n      [enableClear]="false"\r\n      [placeholder]="showBackWardConfig.displayPlaceholder"\r\n    >\r\n    </farris-combo-list>\r\n  </div>\r\n</div>\r\n\r\n\x3c!-- 紧急程度，下一环节为结束时不展示 --\x3e\r\n<div\r\n  *ngIf="\r\n    task?.priority &&\r\n    enablePriority &&\r\n    task.priorityItemList &&\r\n    !selectedNodeId?.startsWith(\'EndEvent\')\r\n  "\r\n  class="wf-task-handler-help-div"\r\n>\r\n  <div class="wf-task-handler-help-text">\r\n    {{ "task.priority" | translate }}\r\n  </div>\r\n  <farris-radiogroup\r\n    [(ngModel)]="selectedPriority"\r\n    [data]="task.priorityItemList"\r\n    [horizontal]="true"\r\n  >\r\n  </farris-radiogroup>\r\n</div>\r\n\r\n\x3c!-- 其他节点办理人员（指派） --\x3e\r\n<div *ngIf="otherAssignInfos?.length">\r\n  <div class="wf-task-splitter">\r\n    {{ "startProcess.otherNodesAssign" | translate\r\n    }}<span class="wf-task-splitter-line"></span>\r\n  </div>\r\n  <lib-assignee-info\r\n    *ngFor="let assignInfo of otherAssignInfos; let i = index"\r\n    [assigneeInfo]="assignInfo.assigneeInfo"\r\n    [setAnonymous]="assignInfo.anonymous"\r\n    [setAnonymousText]="assignInfo.anonymousText"\r\n    [selectedAssignees]="assignInfo.selectedAssignees"\r\n    [activityName]="assignInfo.activityDefinitionName"\r\n    [ifShowBlank]="true"\r\n    [wfContext]="wfContext"\r\n    (afterConfirm)="afterConfirmForOtherAssign($event, i)"\r\n  ></lib-assignee-info>\r\n</div>\r\n\r\n\x3c!-- 按钮 --\x3e\r\n<ng-template #taskExecuteButtons>\r\n  <button type="button" class="btn btn-secondary" (click)="cancel()">\r\n    {{ "static.footCancel" | translate }}\r\n  </button>\r\n  <button\r\n    type="button"\r\n    class="btn btn-primary"\r\n    (click)="submit()"\r\n    [disabled]="submitDisable"\r\n  >\r\n    {{ "static.footOk" | translate }}\r\n  </button>\r\n</ng-template>\r\n',styles:[".wf-task-handler-help-div{font-size:13px;color:#2d2f33;margin-bottom:14px}.wf-task-handler-help-div-submit{margin-bottom:14px}.wf-task-handler-help-text{padding-bottom:8px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.wf-task-batch-selected{padding-left:8px}.wf-task-batch-rows{font-size:13px;font-weight:500;padding:0 4px;color:#2a87ff}.wf-task-batch-time{font-size:13px;font-weight:500;padding:0 4px;color:#424347}.wf-task-batch-message{display:flex;background:#edf9ff;border:1px solid rgba(196,235,255,1);border-radius:8px;margin-bottom:6px;align-items:center;font-size:12px;padding:4px 10px}.wf-submit-section{padding:4px 24px 0}.wf-submit-item{display:flex;align-items:baseline}.wf-submit-item-label{padding-right:10px;width:88px;text-align:right}.wf-task-splitter{display:flex;align-items:center;color:rgba(0,0,0,.4);font-size:12px;margin-bottom:10px}.wf-task-splitter-line{border-bottom:1px dashed rgba(0,0,0,.1);flex-grow:1}"]}]}],Ie.ctorParameters=function(){return[{type:O},{type:I.NotifyService},{type:z},{type:Ve},{type:D.LoadingService},{type:A.MessagerService},{type:C.Injector}]},Ie.propDecorators={buttons:[{type:C.ViewChild,args:["taskExecuteButtons"]}],sysUserHelp:[{type:C.ViewChild,args:[n.SysFarrisLookupComponent]}],urgeHandleComponent:[{type:C.ViewChild,args:[fe]}],cls:[{type:C.HostBinding,args:["class"]}]},Ie);function Ie(e,t,n,s,i,r,o){var a=ye.call(this)||this;return a.taskService=e,a.notify=t,a.i18nService=n,a.handlerService=s,a.loadingService=i,a.message=r,a.injector=o,a.actionEntity=new F,a.comment="",a.MAX_COMMENT_LENGTH=4e3,a.taskList=[],a.batchSecond=0,a.ifSelectNode=!1,a.ifSelectUser=!1,a.ifAssignUser=!1,a.ifUrgeType=!1,a.ifShowCommentToMySelf=!1,a.singleSelect=!1,a.selectTargetAble=!1,a.hideComment=!1,a.filter={notGetCurrentUser:!0,notGetStopUser:!0,orderField:"order",withAllOrg:!0,orgId:""},a.selectedUsers=[],a.subject=new x.BehaviorSubject(null),a.submitResult={result:!0,isClose:!0},a.bindingData={},a.selectNodeText=a.i18nService.getValue("task.nextNodeText"),a.commentPlaceHolder=a.i18nService.getValue("static.inputHolder"),a.showAttachment=!0,a.showSign=!0,a.showCommonComment=!0,a.textAreaHeight=84,a.billMethodConfigs=[],a.destNodes=[],a.dialogHeight=270,a.dialogHeightBase=70,a.addendum=new K,a.groupIcon='<i class="f-icon f-icon-lookup"></i>',a.assignInfos=[{selectedAssignees:[],assigneeInfo:null,assignees:[],activityDefinitionName:"",activityDefinitionId:"",dependency:"",anonymous:!1,anonymousText:null,resolved:!1}],a.otherAssignInfos=[],a.originOtherAssignInfos=[],a.ifRegistered=!1,a.configList=[],a.verifySigned=new J,a.submitDisable=!1,a.addSign={showSignToSign:!1,allowSignToSIgn:!0,showMultiInstanceType:!1,multiInstanceType:[{value:"Parallel",name:a.i18nService.getValue("addSign.parallel")},{value:"Sequential",name:a.i18nService.getValue("addSign.sequential")},{value:"Preempt",name:a.i18nService.getValue("addSign.preempt")}],originMultiInstType:"",curMultiInstType:ve.Parallel.toString()},a.showBackWardConfig={title:a.i18nService.getValue("backWardConfig.title"),dynamicBackWardRuleAble:!1,displayPlaceholder:"",showTips:!1,enable:!1,backWardRules:[{name:a.i18nService.getValue("backWardConfig.sequence"),value:"sequence"},{name:a.i18nService.getValue("backWardConfig.backToMe"),value:"backToMe"},{name:a.i18nService.getValue("backWardConfig.backToCurrentNode"),value:"backToCurrentNode"}]},a.showUrgeMessageSubject=!1,a.wfContext=new ge,a.enablePriority=!1,a.cls="",a.POST_MESSAGE_TARGET=window.document.location.origin,a.language=localStorage.getItem("languageCode")||"zh-CHS",a.eventHandler=function(e){a.messageSubject.next(e)},Ie.func&&window.removeEventListener("message",Ie.func,!1),a.addMessageListener(),a}var xe=function(){},ke=function(){},Ce=function(){},Te=function(){},Ne="SubmitSuccess",Ae="Cancel",Pe=function(){},De=function(e,t,n){this.logTime=new Date,this.processCategory=e,this.processDefinitionId=t,this.processDefinitionName=n,this.logTime=new Date},je=(Me.prototype.ngOnInit=function(){},Object.defineProperty(Me.prototype,"parameter",{set:function(e){e&&(this.showButtons=!0,this.setParam(e))},enumerable:!0,configurable:!0}),Me.prototype.setParam=function(e){var t=new x.Subject;if(e)return this.payload.id=e.id,this.payload.processDefinitionId=e.processDefinitionId,this.payload.processDefinitionKey=e.processDefinitionKey,this.payload.bizDefKey=e.bizDefKey,this.payload.dataModelId=e.dataModelId,this.payload.dataId=e.dataId,this.payload.name=e.name,this.payload.startUserId=e.startUserId,this.payload.nextFlowNodes=[],this.payload.otherAssignNodes=[],this.wfContext.processCategoryId=e.bizDefKey,this.startProcessSimulate(this.payload,t),t.asObservable()},Me.prototype.startProcessSimulate=function(e,n){var s=this,i=this.loadingService.show();this.taskService.startProcessSimulate(e).subscribe(function(e){var t;i.close(),(s.response=e).priorityInfo&&e.priorityInfo.enable&&(s.dialogHeight+=40),s.destProcesses=e.procDefs.map(function(e){return{id:e.procDefId,name:e.procDefName+("(v"+e.version)+".0)"}}),1===s.destProcesses.length?(s.selectedProcessId=s.destProcesses[0].id,s.setNextNode(e),s.processDefaultValue=s.destProcesses[0].name):((t=s.getSelectedProcessCache(s.payload.bizDefKey))&&-1<s.destProcesses.findIndex(function(e){return e.id===t.processDefinitionId})?(s.getDestNodes(t.processDefinitionId),s.processDefaultValue=t.processDefinitionName):s.processPlaceholder=s.i18nService.getValue("task.selectPlaceholder"),s.dialogHeight=330),s.assignInfos&&s.assignInfos.length&&(s.dialogHeight+=40*s.assignInfos.length),s.otherAssignInfos&&s.otherAssignInfos.length&&(s.dialogHeight+=40*(s.otherAssignInfos.length+1)),s.dialogHeight=440<s.dialogHeight?440:s.dialogHeight,n.next({result:!0,dialogHeight:s.dialogHeight})},function(e){i.close(),n.error(e),s.taskService.error(e)})},Me.prototype.selectProcessChange=function(e){this.nodeCombo.onClear(),this.getDestNodes(e.data.id)},Me.prototype.getDestNodes=function(e){var t=this;this.selectedProcessId=e,this.destNodes=[],this.nodePlaceholder="",this.clearAssignInfos();e=new xe;e.processDefinitionId=this.selectedProcessId,e.dataId=this.payload.dataId;var n=this.loadingService.show();this.taskService.startProcessSimulate(e).subscribe(function(e){n.close(),t.response=e,t.setNextNode(e)},function(e){n.close(),t.taskService.error(e)})},Me.prototype.selectNodeChange=function(e){var t=this;this.clearAssignInfos(),this.selectedNodeId=e.data.id;var s,n,i=e.data.name.split("，");this.response.simulationPaths[e.index].nodeInfoList.every(function(e){return!0===e.resolved})?(this.setAssignInfo(this.response.simulationPaths[e.index]),this.setOtherAssignInfo(this.response)):((s=new xe).processDefinitionId=this.selectedProcessId,s.dataId=this.payload.dataId,s.nextFlowNodes=[],this.selectedNodeId.split("，").forEach(function(e,t){var n=new ke;n.activityDefinitionId=e,n.activityDefinitionName=i[t],s.nextFlowNodes.push(n)}),n=this.loadingService.show(),this.taskService.startProcessSimulate(s).subscribe(function(e){n.close(),t.setAssignInfo(e.simulationPaths[0]),t.setOtherAssignInfo(e)},function(e){n.close(),t.taskService.error(e)}))},Me.prototype.startProcessSubmit=function(){var s=this;if(this.selectedProcessId)if(this.selectedNodeId)if(this.assignInfos.filter(function(e){return(e.assigneeInfo||e.selectedAssignees.length)&&!e.assignees.length}).length)(this.openFromIframe?this.messager:this.notify).warning(this.i18nService.getValue("task.selectProcessor"));else if(this.response.priorityInfo&&this.response.priorityInfo.enable&&!this.response.priorityInfo.priority)(this.openFromIframe?this.messager:this.notify).warning(this.i18nService.getValue("task.selectPriority"));else{for(var e=this.selectedNodeId.split("，"),t=0;t<e.length;t++){var n={activityDefinitionId:e[t],activityDefinitionName:this.assignInfos[t].activityDefinitionName,dependency:this.assignInfos[t].dependency,selectedAssignees:this.assignInfos[t].assigneeInfo?this.assignInfos[t].assignees:[],assigneeInfo:null,resolved:!1,anonymous:!1,anonymousText:""};if(this.response&&this.response.simulationPaths.length&&!this.response.simulationPaths[0].id.startsWith("ParallelGateway")&&1==e.length&&e[t].startsWith("UserActivity")&&this.assignInfos[t].resolved&&!this.assignInfos[t].assigneeInfo&&!this.assignInfos[t].selectedAssignees.length){var i=this.assignInfos[t].activityDefinitionName+this.i18nService.getValue("startProcess.node")+this.i18nService.getValue("startProcess.noUser");return void(this.openFromIframe?this.messager:this.notify).warning(i)}this.payload.nextFlowNodes.push(n)}if(this.otherAssignInfos&&this.otherAssignInfos.length)for(t=0;t<this.otherAssignInfos.length;t++){n={activityDefinitionId:this.otherAssignInfos[t].activityDefinitionId,activityDefinitionName:this.otherAssignInfos[t].activityDefinitionName,dependency:this.otherAssignInfos[t].dependency,selectedAssignees:this.otherAssignInfos[t].assigneeInfo?this.otherAssignInfos[t].assignees:[],assigneeInfo:null,resolved:!1,anonymous:!1,anonymousText:""};this.payload.otherAssignNodes.push(n)}this.payload.processDefinitionId=this.selectedProcessId,this.submitDisable=!0,this.response.priorityInfo&&this.response.priorityInfo.enable&&(this.payload.priority=this.response.priorityInfo.priority);var r=this.loadingService.show();this.taskService.startProcess(this.payload).subscribe(function(e){r.close(),s.submitDisable=!1,s.subject.next(!0),s.subjectWithResponse.next(e);var t,n=s.i18nService.getValue("startProcess.submitSuccess");s.openFromIframe?window.parent.gspWfService.eventHandler({data:{type:Ne,message:n}}):s.handlerService.handleSubmitMessage(Y,s.payload.bizDefKey),!s.openFromIframe&&e.needInteraction&&(s.notify.info(s.i18nService.getValue("cueWords.select")+e.nextFlowNodes[0].activityDefinitionName+s.i18nService.getValue("cueWords.processor")),t=new q,n=new F,t.sourceId=e.nextFlowNodes[0].assigneeInfo.workItemId,n.code="AssignUser",n.name=s.i18nService.getValue("cueWords.assignUser"),s.handlerService.execute(t,n).subscribe(function(e){})),s.setSelectedProcessCache()},function(e){r.close(),s.payload.nextFlowNodes=[],s.submitDisable=!1,s.subject.next(!1),s.taskService.error(e)})}else(this.openFromIframe?this.messager:this.notify).warning(this.i18nService.getValue("startProcess.selectNode"));else(this.openFromIframe?this.messager:this.notify).warning(this.i18nService.getValue("startProcess.selectProcess"))},Me.prototype.selectProcessClear=function(){this.selectedProcessId="",this.destNodes=[],this.nodePlaceholder="",this.selectedNodeId="",this.clearAssignInfos(),this.response=null},Me.prototype.selectNodeClear=function(){this.selectedNodeId="",this.clearAssignInfos()},Me.prototype.afterConfirm=function(e,t){this.assignInfos[t].assignees=e},Me.prototype.otherAssignInfosAfterConfirm=function(e,t){this.otherAssignInfos[t].assignees=e},Me.prototype.cancel=function(){this.openFromIframe?window.parent.gspWfService.eventHandler({data:{type:Ae,message:""}}):this.subjectCancel.next(!1)},Me.prototype.getSubject=function(){return this.subject.asObservable()},Me.prototype.getSubjectWithResponse=function(){return this.subjectWithResponse.asObservable()},Me.prototype.getSubjectCancel=function(){return this.subjectCancel.asObservable()},Me.prototype.setNextNode=function(e){this.destNodes=e.simulationPaths&&e.simulationPaths.map(function(e){return{id:e.nodeInfoList.map(function(e){return e.activityDefinitionId}).join("，"),name:e.nodeInfoList.map(function(e){return e.activityDefinitionName}).join("，")}});var t=e.simulationPaths.findIndex(function(e){return e["default"]});-1<t?(this.selectedNodeId=this.destNodes[t].id,this.nodeDefaultValue=(-1<this.destNodes[t].name.indexOf("，")?e.simulationPaths:this.destNodes)[t].name,this.setAssignInfo(e.simulationPaths[t]),this.setOtherAssignInfo(e)):this.nodePlaceholder=this.i18nService.getValue("task.selectPlaceholder")},Me.prototype.setAssignInfo=function(n){var s=this;this.assignInfos=[],this.selectedNodeId.split("，").forEach(function(t){var e=n.nodeInfoList.find(function(e){return e.activityDefinitionId===t});e?s.assignInfos.push({selectedAssignees:e.selectedAssignees,assigneeInfo:e.assigneeInfo,assignees:e.selectedAssignees.map(function(e){return{id:e.id,name:e.name}}),activityDefinitionName:e.activityDefinitionName,activityDefinitionId:e.activityDefinitionId,dependency:e.dependency,anonymous:e.anonymous,anonymousText:e.anonymousText,resolved:e.resolved}):s.assignInfos.push({selectedAssignees:[],assigneeInfo:null,assignees:[],activityDefinitionName:"",activityDefinitionId:"",dependency:"",anonymous:!1,anonymousText:"",resolved:!1})})},Me.prototype.setOtherAssignInfo=function(e){var n=this;this.otherAssignInfos=[];var t=[],e=e.otherAssignNodes;e&&e.length&&(e.forEach(function(e){t.push({selectedAssignees:e.selectedAssignees,assigneeInfo:e.assigneeInfo,assignees:e.selectedAssignees.map(function(e){return{id:e.id,name:e.name}}),activityDefinitionName:e.activityDefinitionName,activityDefinitionId:e.activityDefinitionId,dependency:e.dependency,anonymous:e.anonymous,anonymousText:e.anonymousText,resolved:e.resolved})}),this.assignInfos&&this.assignInfos.length&&(t=t.filter(function(t){return n.assignInfos.findIndex(function(e){return e.activityDefinitionId==t.activityDefinitionId})<0})),this.otherAssignInfos=t)},Me.prototype.clearAssignInfos=function(){this.assignInfos=[{selectedAssignees:[],assigneeInfo:null,assignees:[],activityDefinitionName:"",activityDefinitionId:"",dependency:"",anonymous:!1,anonymousText:"",resolved:!1}],this.otherAssignInfos=[]},Me.prototype.getSelectedProcessCache=function(t){var e=JSON.parse(localStorage.getItem("gspWfStartProcess"));return e&&e.selectedProcessList?e.selectedProcessList.find(function(e){return e.processCategory==t}):undefined},Me.prototype.setSelectedProcessCache=function(){var e,t,n=this.payload.bizDefKey,s=this.payload.processDefinitionId,i=this.destProcesses.find(function(e){return e.id==s}),r=i&&i.name,i=JSON.parse(localStorage.getItem("gspWfStartProcess"));i&&i.selectedProcessList?(-1<(e=i.selectedProcessList).findIndex(function(e){return e.processCategory==n})?e.map(function(e){e.processCategory==n&&(e.processDefinitionId=s,e.processDefinitionName=r,e.logTime=new Date)}):(t=new De(n,s,r),e.push(t)),i.selectedProcessList=e,localStorage.setItem("gspWfStartProcess",JSON.stringify(i))):(i=new Pe,e=[],t=new De(n,s,r),e.push(t),i.selectedProcessList=e,localStorage.setItem("gspWfStartProcess",JSON.stringify(i)))},Me.decorators=[{type:C.Component,args:[{selector:"lib-process-selector",template:'<div>\r\n  \x3c!-- 即将流向 --\x3e\r\n  <farris-section\r\n    [mainTitle]="\'startProcess.processTowards\' | translate"\r\n    style="padding: 0 24px"\r\n  >\r\n    <div class="wf-submit-section">\r\n      \x3c!-- 选择流程定义，下拉 --\x3e\r\n      <div class="wf-task-handler-help-div wf-submit-item">\r\n        <div class="wf-task-handler-help-text wf-submit-item-label">\r\n          {{ "startProcess.procDef" | translate }}\r\n        </div>\r\n        <div class="d-flex" style="flex: 1">\r\n          <farris-combo-list\r\n            style="flex: 1"\r\n            [(ngModel)]="processDefaultValue"\r\n            [data]="destProcesses"\r\n            [editable]="false"\r\n            [textField]="\'name\'"\r\n            [valueField]="\'id\'"\r\n            [idField]="\'id\'"\r\n            [readonly]="destProcesses.length > 1 ? false : true"\r\n            (selectChange)="selectProcessChange($event)"\r\n            (clear)="selectProcessClear()"\r\n            [placeholder]="processPlaceholder"\r\n          >\r\n          </farris-combo-list>\r\n        </div>\r\n      </div>\r\n\r\n      \x3c!-- 下一节点，下拉 --\x3e\r\n      <div class="wf-task-handler-help-div wf-submit-item">\r\n        <div class="wf-task-handler-help-text wf-submit-item-label">\r\n          {{ "task.nextNodeText" | translate }}\r\n        </div>\r\n        <div class="d-flex" style="flex: 1">\r\n          <farris-combo-list\r\n            style="flex: 1"\r\n            #nodeCombo\r\n            [(ngModel)]="nodeDefaultValue"\r\n            [data]="destNodes"\r\n            [editable]="false"\r\n            [textField]="\'name\'"\r\n            [valueField]="\'id\'"\r\n            [idField]="\'id\'"\r\n            [readonly]="destNodes.length > 1 ? false : true"\r\n            [placeholder]="nodePlaceholder"\r\n            (selectChange)="selectNodeChange($event)"\r\n            (clear)="selectNodeClear()"\r\n          >\r\n          </farris-combo-list>\r\n        </div>\r\n      </div>\r\n\r\n      \x3c!-- 办理人员 --\x3e\r\n      <lib-assignee-info\r\n        *ngFor="let assignInfo of assignInfos; let i = index"\r\n        [assigneeInfo]="assignInfo.assigneeInfo"\r\n        [setAnonymous]="assignInfo.anonymous"\r\n        [setAnonymousText]="assignInfo.anonymousText"\r\n        [selectedAssignees]="assignInfo.selectedAssignees"\r\n        [activityName]="\r\n          assignInfos.length > 1 ? assignInfo.activityDefinitionName : \'\'\r\n        "\r\n        [ifShowBlank]="assignInfos.length > 1 ? false : true"\r\n        [openFromIframe]="openFromIframe"\r\n        [wfContext]="wfContext"\r\n        [index]="i"\r\n        [ifHorizontal]="true"\r\n        (afterConfirm)="afterConfirm($event, i)"\r\n      ></lib-assignee-info>\r\n\r\n      \x3c!-- 紧急程度 --\x3e\r\n      <div\r\n        *ngIf="\r\n          response?.priorityInfo?.enable &&\r\n          response?.priorityInfo?.priorityItemList?.length\r\n        "\r\n        class="wf-task-handler-help-div wf-submit-item"\r\n      >\r\n        <div class="wf-task-handler-help-text wf-submit-item-label">\r\n          {{ "task.priority" | translate }}\r\n        </div>\r\n        <farris-radiogroup\r\n          [(ngModel)]="response.priorityInfo.priority"\r\n          [data]="response.priorityInfo.priorityItemList"\r\n          [horizontal]="true"\r\n        >\r\n        </farris-radiogroup>\r\n      </div>\r\n    </div>\r\n  </farris-section>\r\n\r\n  \x3c!-- 修改其他节点办理人 --\x3e\r\n  <farris-section\r\n    *ngIf="otherAssignInfos && otherAssignInfos.length"\r\n    [mainTitle]="\'startProcess.otherNodesAssign\' | translate"\r\n    style="padding: 0 24px"\r\n  >\r\n    <div class="wf-submit-section">\r\n      \x3c!-- 办理人员 --\x3e\r\n      <lib-assignee-info\r\n        *ngFor="let assignInfo of otherAssignInfos; let i = index"\r\n        [assigneeInfo]="assignInfo.assigneeInfo"\r\n        [setAnonymous]="assignInfo.anonymous"\r\n        [setAnonymousText]="assignInfo.anonymousText"\r\n        [selectedAssignees]="assignInfo.selectedAssignees"\r\n        [activityName]="assignInfo.activityDefinitionName"\r\n        [ifShowBlank]="true"\r\n        [openFromIframe]="openFromIframe"\r\n        [wfContext]="wfContext"\r\n        [index]="i + \'other\'"\r\n        [ifHorizontal]="true"\r\n        (afterConfirm)="otherAssignInfosAfterConfirm($event, i)"\r\n      ></lib-assignee-info>\r\n    </div>\r\n  </farris-section>\r\n</div>\r\n\r\n\x3c!-- 弹框显示时，显示按钮 --\x3e\r\n<div *ngIf="showButtons" class="modal-footer">\r\n  <div *ngIf="showButtons; then buttons"></div>\r\n</div>\r\n\r\n\x3c!-- 按钮 --\x3e\r\n<ng-template #buttons>\r\n  <button type="button" class="btn btn-secondary" (click)="cancel()">\r\n    {{ "static.footCancel" | translate }}\r\n  </button>\r\n  <button\r\n    type="button"\r\n    class="btn btn-primary"\r\n    [disabled]="submitDisable"\r\n    directive-throttle\r\n    (throttleClick)="startProcessSubmit()"\r\n  >\r\n    {{ "static.footOk" | translate }}\r\n  </button>\r\n</ng-template>\r\n',styles:[".wf-task-handler-help-div{font-size:13px;color:#2d2f33;margin-bottom:14px}.wf-task-handler-help-div-submit{margin-bottom:14px}.wf-task-handler-help-text{padding-bottom:8px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.wf-task-batch-selected{padding-left:8px}.wf-task-batch-rows{font-size:13px;font-weight:500;padding:0 4px;color:#2a87ff}.wf-task-batch-time{font-size:13px;font-weight:500;padding:0 4px;color:#424347}.wf-task-batch-message{display:flex;background:#edf9ff;border:1px solid rgba(196,235,255,1);border-radius:8px;margin-bottom:6px;align-items:center;font-size:12px;padding:4px 10px}.wf-submit-section{padding:4px 24px 0}.wf-submit-item{display:flex;align-items:baseline}.wf-submit-item-label{padding-right:10px;width:88px;text-align:right}.wf-task-splitter{display:flex;align-items:center;color:rgba(0,0,0,.4);font-size:12px;margin-bottom:10px}.wf-task-splitter-line{border-bottom:1px dashed rgba(0,0,0,.1);flex-grow:1}"]}]}],Me.ctorParameters=function(){return[{type:O},{type:D.LoadingService},{type:I.NotifyService},{type:z},{type:A.MessagerService},{type:C.Injector},{type:Ve}]},Me.propDecorators={nodeCombo:[{type:C.ViewChild,args:["nodeCombo"]}],buttons:[{type:C.ViewChild,args:["buttons"]}],openFromIframe:[{type:C.Input}],parameter:[{type:C.Input}]},Me);function Me(e,t,n,s,i,r,o){this.taskService=e,this.loadingService=t,this.notify=n,this.i18nService=s,this.messager=i,this.injector=r,this.handlerService=o,this.destProcesses=[],this.destNodes=[],this.assignInfos=[{selectedAssignees:[],assigneeInfo:null,assignees:[],activityDefinitionName:"",activityDefinitionId:"",dependency:"",anonymous:!1,anonymousText:null,resolved:!1}],this.otherAssignInfos=[],this.payload=new xe,this.subject=new x.Subject,this.subjectWithResponse=new x.Subject,this.subjectCancel=new x.Subject,this.submitDisable=!1,this.showButtons=!1,this.curLanguage=localStorage.getItem("languageCode")||"zh-CHS",this.wfContext=new ge,this.dialogHeight=240,this.openFromIframe=!1}var Ue=(He.newEntity=function(){return{id:O.newId(),message:""}},He);function He(){}var Ee=(Oe.prototype.ngOnInit=function(){this.commentColumns=[{field:"message",width:100,title:this.i18nService.getValue("comment.static.content"),editor:{type:u.EditorTypes.TEXTBOX,options:{}}},{field:"userId",width:20,title:this.i18nService.getValue("comment.static.type"),template:this.commentTypeCell},{field:"operate",width:20,title:this.i18nService.getValue("comment.static.operate"),template:this.commentOperateCell}],this.loadComments()},Oe.prototype.loadComments=function(){var t=this,n=this.loadingService.show();this.taskService.getCommentList(this.filter).subscribe(function(e){n.close(),t.commentList=e,t.originCommentList=JSON.parse(JSON.stringify(e))},function(){n.close()})},Oe.prototype.addCommonComment=function(){var e=this,t=Ue.newEntity();t.sortOrder=this.commentList.length+1,this.filter&&this.filter.type&&(t.type=this.filter.type),this.commentList=this.commentList.concat(t),setTimeout(function(){e.dataGrid.editCell(t.id,"message")},100)},Oe.prototype.deleteComment=function(t){"*"!==t.rowData.userId&&(this.commentList=this.commentList.filter(function(e){return e.id!=t.rowData.id}),this.originCommentList=this.originCommentList.filter(function(e){return e.id!=t.rowData.id}),this.dataGrid.loadData(this.commentList),this.taskService.deleteComment(t.rowData.id).subscribe(function(){}))},Oe.prototype.saveCommonComment=function(){var n=this;this.dataGrid.endCellEdit(),this.commentList=this.commentList.filter(function(e){return e.message}),this.commentList.forEach(function(e){if(255<n.taskService.getBytesLength(e.message))throw n.notify.warning(n.i18nService.getValue("cueWords.commonCommentTooLong")),n.dataGrid.editCell(e.id,"message"),new Error("")}),this.commentList.forEach(function(t){var e=n.originCommentList.find(function(e){return e.id==t.id});e&&t.message===e.message&&t.sortOrder==e.sortOrder||n.taskService.addComment(t).subscribe(function(){})}),this.confirmSubject.next({action:"submit",data:this.commentList})},Oe.prototype.clickCancel=function(){this.commentList=this.commentList.filter(function(e){return e.message}),this.cancelSubject.next({action:"cancel",data:this.originCommentList})},Oe.prototype.getConfirmSUbject=function(){return this.confirmSubject.asObservable()},Oe.prototype.getCancelSubject=function(){return this.cancelSubject.asObservable()},Oe.decorators=[{type:C.Component,args:[{selector:"lib-comment-manage",template:'<div class="task-comment-div">\r\n  <div class="task-comment-datagrid-div">\r\n    <farris-datagrid\r\n      #dataGrid\r\n      [data]="commentList"\r\n      [columns]="commentColumns"\r\n      [editable]="true"\r\n      [fit]="true"\r\n      [editMode]="\'cell\'"\r\n      [pagination]="false"\r\n      [fitColumns]="true"\r\n      [clickToEdit]="true"\r\n      [beforeEdit]="beforeEdit"\r\n      [idField]="\'id\'"\r\n    >\r\n    </farris-datagrid>\r\n  </div>\r\n  <div\r\n    class="task-comment-add task-comment-add-common"\r\n    (click)="addCommonComment()"\r\n  >\r\n    <span class="f-icon f-icon-plus mr-1"></span>\r\n    <span>{{ "comment.static.clickToAdd" | translate }}</span>\r\n  </div>\r\n</div>\r\n\r\n\x3c!-- 常用意见类别 --\x3e\r\n<ng-template #commentTypeCell let-ctx>\r\n  <div>\r\n    <span\r\n      *ngIf="ctx.rowData.userId === \'*\'"\r\n      class="task-comment-type task-comment-type-blue"\r\n      >{{ "comment.static.public" | translate }}</span\r\n    >\r\n    <span\r\n      *ngIf="ctx.rowData.userId !== \'*\'"\r\n      class="task-comment-type task-comment-type-yellow"\r\n      >{{ "comment.static.private" | translate }}</span\r\n    >\r\n  </div>\r\n</ng-template>\r\n\r\n\x3c!-- 常用意见操作 --\x3e\r\n<ng-template #commentOperateCell let-ctx>\r\n  <div\r\n    *ngIf="ctx.rowData.userId !== \'*\'"\r\n    class="btn-link"\r\n    style="padding: 5px 0"\r\n    (click)="deleteComment(ctx)"\r\n  >\r\n    {{ "comment.static.delete" | translate }}\r\n  </div>\r\n</ng-template>\r\n\r\n\x3c!-- 常用意见维护按钮 --\x3e\r\n<ng-template #formButtonRef>\r\n  <button class="btn btn-secondary mr-2" (click)="clickCancel()">\r\n    {{ "comment.static.cancel" | translate }}\r\n  </button>\r\n  <button class="btn btn-primary" (click)="saveCommonComment()">\r\n    {{ "comment.static.confirm" | translate }}\r\n  </button>\r\n</ng-template>\r\n',styles:[".task-comment-div{display:flex;flex-direction:column;height:100%}.task-comment-datagrid-div{display:flex;flex-grow:0;overflow:hidden;padding:0 24px;height:100%}.task-comment-type{padding:2px 6px;border-radius:4px;font-size:12px}.task-comment-type-blue{background:#eef5ff;border:0 solid #aed1ff;color:#5ea4ff}.task-comment-type-yellow{background:#fef5ec;border:0 solid #fad0a1;color:#f5a144}.task-comment-add{display:flex;justify-content:center;align-items:center;margin:0 24px;cursor:pointer;overflow:hidden;font-size:12px;text-align:center;padding:6px;border-radius:4px}.task-comment-add-common{color:#a8adb8;background:#f4f6fc;border:1px dashed #d2d7e2}.task-comment-add:hover{background:rgba(238,245,255,.8);border:1px solid rgba(82,157,255,.4)}"]}]}],Oe.ctorParameters=function(){return[{type:z},{type:O},{type:I.NotifyService},{type:D.LoadingService}]},Oe.propDecorators={filter:[{type:C.Input}],dataGrid:[{type:C.ViewChild,args:["dataGrid"]}],commentTypeCell:[{type:C.ViewChild,args:["commentTypeCell"]}],commentOperateCell:[{type:C.ViewChild,args:["commentOperateCell"]}],buttons:[{type:C.ViewChild,args:["formButtonRef"]}]},Oe);function Oe(e,t,n,s){this.i18nService=e,this.taskService=t,this.notify=n,this.loadingService=s,this.commentList=[],this.originCommentList=[],this.commentColumns=[],this.confirmSubject=new x.Subject,this.cancelSubject=new x.Subject,this.beforeEdit=function(e){return"*"==e.rowData.userId?x.of(!1):x.of(!0)}}var Ve=(Le.prototype.execute=function(e,t,n){switch(t.code){case"ViewBizLog":this.logService.showByProcInstId(e.processInstanceId);break;case"ViewFlowChart":this.flowchartService.viewFlowchartByProcInstIdAndDataId(e.processInstanceId,e.refBizId);break;case"ViewExecuteForm":this.openApp(e,t,n);break;default:this.complete(e,t)}return this.subject.asObservable()},Le.prototype.assignByInfo=function(e,t){return(new x.Subject).asObservable()},Le.prototype.complete=function(e,t){var n=this,s=this.resolver.resolveComponentFactory(we).create(this.injector);s.instance.setTask(e),s.instance.setAction(t),s.instance.addPadding();var t={title:t.name||this.i18nService.getValue("task.title"),width:550,height:s.instance.dialogHeight,showButtons:!0,buttons:s.instance.buttons},i=this.modalService.show(s,t);s.instance.getSubject().subscribe(function(e){e&&e.result&&n.subject.next(!0),e&&e.result&&i.close()})},Le.prototype.openApp=function(s,i,r){var o=this,a=s.sourceId,c=this.loading.show();this.taskService.getTaskFormInfo(a).subscribe(function(e){if(c.close(),e){var t={appType:"menu",funcId:"",appId:"",appEntrance:"",tabId:a,isNewTab:!0},n=new Map;if(e.appId)"1"===e.formType?(n.set("workItemId",a),n.set("procInstId",i.parameters[0].value),n.set("taskState",s.state),n.set("isAssign",s.actions.some(function(e){return"AssignUser"===e.code})),e.parameters.forEach(function(e){return n.set(e.code,e.value)}),t.funcId=e.appId):(t.funcId="WF0120",n.set("task",s),n.set("formInfo",e),r&&n.set("taskFilter",r.taskFilter));else{if(!e.url)return void o.notify.info(o.i18nService.getValue("task.notFoundBill"));t.funcId="WF0120",n.set("task",s),n.set("formInfo",e),r&&n.set("taskFilter",r.taskFilter)}t.entityParams=n,t.queryStringParams=n,o.openMenu(t,o.i18nService.getValue("static.taskForm"))}else o.notify.info(o.i18nService.getValue("task.notFoundBill"))},function(e){c.close(),o.taskService.error(e)})},Le.prototype.openMenu=function(e,t){var n,s=this;this.taskService.isInSuite()?(e.menuTitle=t,window.gspframeworkService.rtf.extendMethod.getExtObj().iGIXMenuOpen(e)):(n=this.loading.show(),this.frameworkService.openMenu$(e).subscribe(function(e){n.close()},function(e){n.close(),s.taskService.error(e)}))},Le.prototype.refreshActions=function(e){return this.taskService.getWorkItemActions(e).pipe(k.switchMap(function(e){return x.of(e.filter(function(e){return"ViewBizLog"!==e.code&&"ViewFlowChart"!==e.code&&"ViewExecuteForm"!==e.code}))}))},Le.prototype.executeByProcInstId=function(e,t,n){var s=this,i=new F;i.code=n;var r=new x.Subject;return this.taskService.getTaskByProcInstId(e,t).subscribe(function(e){e?s.execute(e,i).subscribe(function(e){r.next(e)}):s.notify.info(s.i18nService.getValue("task.noTask"))}),r.asObservable()},Le.prototype.executeByWorkItemId=function(e,t){var n=new q;return n.sourceId=e,this.execute(n,t)},Le.prototype.startProcess=function(s){var i=this,r=new x.Subject,t=this.loading.show();return this.taskService.getTaskCenterConfigByCode($,re,s.bizDefKey).subscribe(function(e){var n;t.close(),e&&"false"===e.currentValue?(n=i.loading.show(),i.taskService.startProcessSimulate(s).subscribe(function(e){var t;n.close(),e&&!1!==e.needInteraction?i.showStartProcessDialog(s).subscribe(function(e){r.next(e)}):(t=i.loading.show(),i.taskService.startProcess(s).subscribe(function(e){t.close(),s.withResponse?r.next(e):r.next(!0),i.handleSubmitMessage(Y,s.bizDefKey)},function(e){t.close(),s.withResponse?r.next(null):r.next(!1),i.taskService.error(e)}))},function(e){n.close(),r.next(null),i.taskService.error(e)})):i.showStartProcessDialog(s).subscribe(function(e){r.next(e)})},function(e){t.close(),i.taskService.error(e)}),r.asObservable()},Le.prototype.showStartProcessDialog=function(n){var s=this,i=new x.Subject,r=this.resolver.resolveComponentFactory(je).create(this.injector);return r.instance.setParam(n).subscribe(function(e){var e={title:s.i18nService.getValue("startProcess.title"),width:520,height:e&&e.dialogHeight,showButtons:!0,buttons:r.instance.buttons,opened:function(){setTimeout(function(){r.changeDetectorRef&&r.changeDetectorRef.detectChanges()},100)}},t=s.modalService.show(r,e);!0===n.withResponse?(r.instance.getSubjectWithResponse().subscribe(function(e){i.next(e),t.close()}),r.instance.getSubjectCancel().subscribe(function(){t.close()})):(r.instance.getSubject().subscribe(function(e){i.next(e),t.close()}),r.instance.getSubjectCancel().subscribe(function(e){i.next(e),t.close()}))}),i.asObservable()},Le.prototype.cancelSubmit=function(t){var n=this,s=new x.Subject,i=this.loading.show();return this.taskService.cancelSubmit(t).subscribe(function(e){i.close(),s.next(!0),e&&e.needInteraction?n.notify.info(n.i18nService.getValue("startProcess.cancelSubmitInfo")):n.handleSubmitMessage(Q,t.bizDefKey)},function(e){i.close(),s.error(!1),n.taskService.error(e)}),s.asObservable()},Le.prototype.submitWithBizDefKey=function(e,t){if(e){if(t){var n=new xe;return n.dataId=e,n.bizDefKey=t,n.withResponse=!0,this.startProcess(n)}this.message.error(this.i18nService.getValue("startProcess.bizDefKeyIsNull"))}else this.notify.warning(this.i18nService.getValue("startProcess.dataIdIsNull"))},Le.prototype.cancelSubmitWithDataId=function(e,t){if(e){if(t){var n=new Te;return n.dataId=e,n.bizDefKey=t,this.cancelSubmit(n)}this.message.error(this.i18nService.getValue("startProcess.bizDefKeyIsNull"))}else this.notify.warning(this.i18nService.getValue("startProcess.dataIdIsNull"))},Le.prototype.batchSubmitWithBizDefKey=function(e,t){if(e&&e.length){if(t){if(1===e.length){var n=new xe;return n.bizDefKey=t,n.dataId=e[0],this.startProcess(n)}var s=new x.Subject,i=this.loading.show();return this.batchSubmitNum.successNum=0,this.batchSubmitNum.failedNum=0,this.batchSubmitNum.errorNum=0,this.batchSubmitHelpFunction(E(e),t,function(){i.close(),s.next(!0)}),s.asObservable()}this.message.error(this.i18nService.getValue("startProcess.bizDefKeyIsNull"))}else this.notify.warning(this.i18nService.getValue("startProcess.dataIdIsEmpty"))},Le.prototype.batchSubmitHelpFunction=function(t,n,s){var e,i,r=this;t&&0<t.length?(e=t.shift(),(i=new xe).bizDefKey=n,i.dataId=e,i.variables={simulate:!0},this.taskService.startProcess(i).subscribe(function(e){e.needInteraction?(r.batchSubmitNum.failedNum++,r.batchSubmitHelpFunction(t,n,s)):(i.variables={simulate:!1},r.taskService.startProcess(i).subscribe(function(e){r.batchSubmitNum.successNum++,r.batchSubmitHelpFunction(t,n,s)},function(){r.batchSubmitNum.errorNum++,r.batchSubmitHelpFunction(t,n,s)}))},function(){r.batchSubmitNum.errorNum++,r.batchSubmitHelpFunction(t,n,s)})):(this.showBatchSubmitInfo(this.batchSubmitNum,n),s())},Le.prototype.batchCancelSubmitWithDataId=function(e,t){if(e&&e.length){if(t){if(1===e.length)return this.cancelSubmitWithDataId(e[0],t);var n=new x.Subject,s=this.loading.show();return this.batchCancelNum.successNum=0,this.batchCancelNum.errorNum=0,this.batchCancelHelpFunction(E(e),t,function(){s.close(),n.next(!0)}),n.asObservable()}this.message.error(this.i18nService.getValue("startProcess.bizDefKeyIsNull"))}else this.notify.warning(this.i18nService.getValue("startProcess.dataIdIsEmpty"))},Le.prototype.batchCancelHelpFunction=function(e,t,n){var s,i,r=this;e&&e.length?(s=e.shift(),(i=new Te).dataId=s,i.bizDefKey=t,this.taskService.cancelSubmit(i).subscribe(function(){r.batchCancelNum.successNum++,r.batchCancelHelpFunction(e,t,n)},function(){r.batchCancelNum.errorNum++,r.batchCancelHelpFunction(e,t,n)})):(this.showBatchCancelSubmitInfo(this.batchCancelNum,t),n())},Le.prototype.childSubmit=function(e,t,n){if(e&&t){if(n){var s=new xe;return s.dataId=e+","+t,s.bizDefKey=n,this.startProcess(s)}this.message.error(this.i18nService.getValue("startProcess.bizDefKeyIsNull"))}else this.notify.warning(this.i18nService.getValue("startProcess.dataIdIsNull"))},Le.prototype.childCancelSubmit=function(e,t,n){if(e&&t){if(n){var s=new Te;return s.dataId=e+","+t,s.bizDefKey=n,this.cancelSubmit(s)}this.message.error(this.i18nService.getValue("startProcess.bizDefKeyIsNull"))}else this.notify.warning(this.i18nService.getValue("startProcess.dataIdIsNull"))},Le.prototype.childBatchSubmit=function(t,e,n){if(t&&e){if(n){e=e.map(function(e){return t+","+e});return this.batchSubmitWithBizDefKey(e,n)}this.message.error(this.i18nService.getValue("startProcess.bizDefKeyIsNull"))}else this.notify.warning(this.i18nService.getValue("startProcess.dataIdIsNull"))},Le.prototype.childBatchCancelSubmit=function(t,e,n){if(t&&e){if(n){e=e.map(function(e){return t+","+e});return this.batchCancelSubmitWithDataId(e,n)}this.message.error(this.i18nService.getValue("startProcess.bizDefKeyIsNull"))}else this.notify.warning(this.i18nService.getValue("startProcess.dataIdIsNull"))},Le.prototype.showBatchSubmitInfo=function(e,t){var n,s=this;!e.successNum||e.failedNum||e.errorNum?(n="",e.successNum&&(n+=this.i18nService.getValue("batchStartProcess.success")+("【"+e.successNum)+"】"+this.i18nService.getValue("batchStartProcess.row")),e.errorNum&&(n+=this.i18nService.getValue("batchStartProcess.error")+("【"+e.errorNum)+"】"+this.i18nService.getValue("batchStartProcess.row")),e.failedNum&&(n+=this.i18nService.getValue("batchStartProcess.failed")+("【"+e.failedNum)+"】"+this.i18nService.getValue("batchStartProcess.row")),n+=this.i18nService.getValue("batchStartProcess.single"),this.message.show("warning",n,{safeHtml:!1})):this.taskService.getTaskCenterConfigByCode(Y,re,t).subscribe(function(e){"en"===s.curLanguage&&s.notify.success(JSON.parse(e.currentValue).en),"zh-CHS"===s.curLanguage&&s.notify.success(JSON.parse(e.currentValue).zh_CHS)})},Le.prototype.showBatchCancelSubmitInfo=function(e,t){var n=this;e.successNum&&!e.errorNum?this.taskService.getTaskCenterConfigByCode(Q,re,t).subscribe(function(e){"en"===n.curLanguage&&n.notify.success(JSON.parse(e.currentValue).en),"zh-CHS"===n.curLanguage&&n.notify.success(JSON.parse(e.currentValue).zh_CHS)}):(t="",e.successNum&&(t+=this.i18nService.getValue("startProcess.success")+("【"+e.successNum)+"】"+this.i18nService.getValue("startProcess.row")),e.errorNum&&(t+=this.i18nService.getValue("startProcess.failed")+("【"+e.errorNum)+"】"+this.i18nService.getValue("startProcess.row")),this.message.show("warning",t,{safeHtml:!1}))},Le.prototype.handleSubmitMessage=function(n,e){var s=this,i=this.loading.show();this.taskService.getTaskCenterConfigByCode(n,re,e).subscribe(function(e){var t;i.close(),e&&e.currentValue?(t="",e=JSON.parse(e.currentValue),"zh-CHS"===s.curLanguage&&(t=e.zh_CHS),"en"===s.curLanguage&&(t=e.en),"zh-CHT"===s.curLanguage&&(t=e.zh_CHT),s.notify.success(t)):(n===Y&&s.notify.success(s.i18nService.getValue("startProcess.submitSuccess")),n===Q&&s.notify.success(s.i18nService.getValue("startProcess.cancelSubmitSuccess")))},function(e){i.close(),s.taskService.error(e)})},Le.prototype.processSimulate=function(){var e=new x.Subject;return window.parent.gspWfEventService.simulate(function(){e.next(!0)}),e.asObservable()},Le.prototype.viewFlowChartByDataId=function(e){e?this.flowchartService.viewFlowChartByDataId(e):this.notify.warning(this.i18nService.getValue("startProcess.dataIdIsNull"))},Le.prototype.viewFlowChartWithForecast=function(e,t){var n;t?e?((n=new m.ForecastProcessPayload).bizDefKey=e,n.dataId=t,this.flowchartService.viewProcess(n)):this.message.error(this.i18nService.getValue("startProcess.bizDefKeyIsNull")):this.notify.warning(this.i18nService.getValue("startProcess.dataIdIsNull"))},Le.prototype.viewApprovalLog=function(e,t){e?this.logService.showApprovalLog({dataId:e,style:t}):this.notify.warning(this.i18nService.getValue("startProcess.dataIdIsNull"))},Le.prototype.getCommonComments=function(e){return this.taskService.getCommentList(e)},Le.prototype.showCommentManageDialog=function(e){var t=new x.Subject,n=this.resolver.resolveComponentFactory(Ee).create(this.injector),s={title:this.i18nService.getValue("comment.static.title"),width:740,height:440,showButtons:!0,buttons:n.instance.buttons};n.instance.filter=e;var i=this.modalService.show(n,s);return n.instance.getConfirmSUbject().subscribe(function(e){i.close(),t.next(e)}),n.instance.getCancelSubject().subscribe(function(e){i.close(),t.next(e)}),t.asObservable()},Le.decorators=[{type:C.Injectable}],Le.ctorParameters=function(){return[{type:f.WfApprovalLogsService},{type:m.WFFlowchartService},{type:C.Injector},{type:C.ComponentFactoryResolver},{type:t.BsModalService},{type:O},{type:I.NotifyService},{type:z},{type:S.FrameworkService},{type:C.ApplicationRef}]},Le);function Le(e,t,n,s,i,r,o,a,c,l){this.logService=e,this.flowchartService=t,this.injector=n,this.resolver=s,this.modalService=i,this.taskService=r,this.notify=o,this.i18nService=a,this.frameworkService=c,this.appRef=l,this.subject=new x.Subject,this.curLanguage=localStorage.getItem("languageCode")||"zh-CHS",this.batchSubmitNum={successNum:0,failedNum:0,errorNum:0},this.batchCancelNum={successNum:0,errorNum:0},this.loading=this.injector.get(D.LoadingService),this.message=this.injector.get(A.MessagerService)}var Fe=(Be.prototype.transform=function(e,t){if(void 0===t&&(t=""),this.i18nService){e=this.i18nService.getValue(e);return e||t}return t},Be.decorators=[{type:C.Pipe,args:[{name:"translate"}]}],Be.ctorParameters=function(){return[{type:z,decorators:[{type:C.Optional}]}]},Be);function Be(e){this.i18nService=e}var _e=(ze.prototype.ngOnInit=function(){},ze.decorators=[{type:C.Component,args:[{selector:"lib-task-assigninfo",template:"",styles:[""]}]}],ze);function ze(){}var We=function(){this.readonly=!1,this.includeJobLeavers=!1,this.includeStopUser=!1,this.personnelOrderField="orderby_ordernum",this.userTypeMode="WfMode"},Re=(qe.prototype.ngOnInit=function(){this.openFromIframe&&top.System["import"]("/platform/common/web/@farris/common-personnel-select/psc.js?v="+(new Date).getTime().toString()).then(function(e){},function(e){console.error(e)})},Object.defineProperty(qe.prototype,"assigneeInfo",{set:function(e){this.disabled=!1,this.placeholder=null,this.assignUserNgModule=null,this._assigneeInfo=e,this._assigneeInfo?(this._assigneeInfo.selectAssignee?(this.disabled=!1,this.placeholder=this.i18nService.getValue("task.selectPlaceholder")):(this.disabled=!0,this._assigneeInfo.assigneeUsers&&this._assigneeInfo.assigneeUsers.length?this.defaultParticipant=this.anonymous?this.anonymousText:this._assigneeInfo.assigneeUsers.map(function(e){return e.name}).join():this.defaultParticipant=this.i18nService.getValue("task.noUser")),this.singleSelect=!this._assigneeInfo.multiSelect,this.allowGlobalAssign=this._assigneeInfo.allowGlobalAssign,this._assigneeInfo.organizationScope&&this._assigneeInfo.organizationScope.length&&(e=this._assigneeInfo.organizationScope[0],this.filter.orgId=e.id,this.filter.withAllOrg=e.includeChildren)):this.disabled=!0},enumerable:!0,configurable:!0}),Object.defineProperty(qe.prototype,"setAnonymous",{set:function(e){this.anonymous=e},enumerable:!0,configurable:!0}),Object.defineProperty(qe.prototype,"setAnonymousText",{set:function(e){this.anonymousText=e},enumerable:!0,configurable:!0}),Object.defineProperty(qe.prototype,"selectedAssignees",{set:function(e){this._assigneeInfo||(this.placeholder=null),(this._selectedAssignees=e).length&&(this.defaultParticipant=this.anonymous?this.anonymousText:e.map(function(e){return e.name}).join())},enumerable:!0,configurable:!0}),qe.prototype.clickAssignUser=function(){this.isUseNewSelectUserHelp&&(this.extendUserHelp=!0,this.extendUserHelpUrl="/platform/runtime/wf/web/wf-user-help/wf-user-help-farris/wf-user-help-farris.js?v="+(new Date).getTime().toString());var e={singleSelect:this.singleSelect,allowGlobalAssign:this.allowGlobalAssign,assigneeUsers:this._assigneeInfo&&this._assigneeInfo.assigneeUsers&&this._assigneeInfo.assigneeUsers.length?this._assigneeInfo.assigneeUsers:[],filter:this.filter,selectedUsers:this.assignees&&this.assignees.length?this.assignees:this._selectedAssignees,wfContext:this.wfContext};this.extendUserHelp&&this.openFromIframe?this.showFarrisUserHelpFromWindow(e):this.showExtendUserHelp(e)},qe.prototype.showExtendUserHelp=function(t){var n=this;System["import"](this.extendUserHelpUrl).then(function(e){Object.values(e)[0].create(n.injector).instance.showHelp(t).subscribe(function(e){e=e.userList;e&&e.length?(n.assignees=e.map(function(e){return{id:e.id,name:e.name}}),n.assignUserNgModule=n.assignees.map(function(e){return e.name}).join()):(n.assignees=[],n.assignUserNgModule=""),n.afterConfirm.emit(n.assignees),n.cd.detectChanges()},function(e){console.error(e)})},function(e){console.error(e)})},qe.prototype.showFarrisUserHelpFromWindow=function(e){var t=this,n=new We;e.wfContext&&(n.filterId=e.wfContext.processCategoryId),n.multiSelect=!e.singleSelect;var s=!1;(e.allowGlobalAssign||e.filter&&e.filter.orgId)&&(s=!0);var i="";e.assigneeUsers&&e.assigneeUsers.length&&(i=e.assigneeUsers.map(function(e){return e.id}).join(),n.unSelectedUserIds=i),s&&i&&(n.showTabIds="candidate,recent,organization,favorites,group",n.activeTabId="candidate"),s&&!i&&(n.showTabIds="recent,organization,favorites,group",n.activeTabId="recent"),!s&&i&&(n.showTabIds="candidate",n.activeTabId="candidate"),e.filter&&(i=e.filter,n.includeCurrentUser=!i.notGetCurrentUser,n.orgId=i.orgId||"*",n.enableChildHierarchy=i.withAllOrg),e.selectedUsers&&e.selectedUsers.length&&(n.userIds=e.selectedUsers.map(function(e){return e.id}).join());var r="gspWfTask"+this.index;top.window.CommonPersonnelSelect.component.farrisDialogShowInWf(n,r),this.pscChange||(this.pscChange=top.window.FARRIS_PSC.selectionsChange.subscribe(function(e){e.token==r&&((e=e.data)&&e.length?(t.assignees=e.map(function(e){return{id:e.userId,name:e.name}}),t.assignUserNgModule=t.assignees.map(function(e){return e.name}).join()):(t.assignees=[],t.assignUserNgModule=""),t.afterConfirm.emit(t.assignees),t.cd.detectChanges())}))},qe.prototype.assignUserClear=function(){this.assignees=[],this.assignUserNgModule=null,this.afterConfirm.emit([])},qe.decorators=[{type:C.Component,args:[{selector:"lib-assignee-info",template:'\x3c!-- 指定参与者（指派） --\x3e\r\n<div\r\n  *ngIf="\r\n    ifShowBlank ||\r\n    _assigneeInfo ||\r\n    (_selectedAssignees && _selectedAssignees.length)\r\n  "\r\n  [ngClass]="\r\n    ifHorizontal\r\n      ? \'wf-task-handler-help-div wf-submit-item\'\r\n      : \'wf-task-handler-help-div\'\r\n  "\r\n>\r\n  <div\r\n    [ngClass]="\r\n      ifHorizontal\r\n        ? \'wf-task-handler-help-text wf-submit-item-label\'\r\n        : \'wf-task-handler-help-text\'\r\n    "\r\n    title="{{ activityName }}"\r\n  >\r\n    {{ activityName ? activityName : ("task.assignText" | translate) }}\r\n  </div>\r\n  <div\r\n    style="flex: 1"\r\n    title="{{ assignUserNgModule ? assignUserNgModule : placeholder }}"\r\n  >\r\n    <input-group\r\n      [(ngModel)]="defaultParticipant"\r\n      [editable]="false"\r\n      [readonly]="disabled"\r\n      [customCls]="\'custom-cls\'"\r\n      [groupText]="groupIcon"\r\n      [placeholder]="placeholder"\r\n      [(value)]="assignUserNgModule"\r\n      (clickHandle)="clickAssignUser()"\r\n      (clear)="assignUserClear()"\r\n    ></input-group>\r\n  </div>\r\n</div>\r\n',styles:[".wf-task-handler-help-div{font-size:13px;color:#2d2f33;margin-bottom:14px}.wf-task-handler-help-div-submit{margin-bottom:14px}.wf-task-handler-help-text{padding-bottom:8px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.wf-task-batch-selected{padding-left:8px}.wf-task-batch-rows{font-size:13px;font-weight:500;padding:0 4px;color:#2a87ff}.wf-task-batch-time{font-size:13px;font-weight:500;padding:0 4px;color:#424347}.wf-task-batch-message{display:flex;background:#edf9ff;border:1px solid rgba(196,235,255,1);border-radius:8px;margin-bottom:6px;align-items:center;font-size:12px;padding:4px 10px}.wf-submit-section{padding:4px 24px 0}.wf-submit-item{display:flex;align-items:baseline}.wf-submit-item-label{padding-right:10px;width:88px;text-align:right}.wf-task-splitter{display:flex;align-items:center;color:rgba(0,0,0,.4);font-size:12px;margin-bottom:10px}.wf-task-splitter-line{border-bottom:1px dashed rgba(0,0,0,.1);flex-grow:1}"]}]}],qe.ctorParameters=function(){return[{type:z},{type:I.NotifyService},{type:C.ChangeDetectorRef},{type:O},{type:C.Injector}]},qe.propDecorators={disabled:[{type:C.Input}],placeholder:[{type:C.Input}],singleSelect:[{type:C.Input}],filter:[{type:C.Input}],ifShowBlank:[{type:C.Input}],openFromIframe:[{type:C.Input}],activityName:[{type:C.Input}],allowGlobalAssign:[{type:C.Input}],wfContext:[{type:C.Input}],index:[{type:C.Input}],isUseNewSelectUserHelp:[{type:C.Input}],ifHorizontal:[{type:C.Input}],afterConfirm:[{type:C.Output}],assigneeInfo:[{type:C.Input}],setAnonymous:[{type:C.Input}],setAnonymousText:[{type:C.Input}],selectedAssignees:[{type:C.Input}]},qe);function qe(e,t,n,s,i){var r=this;this.i18nService=e,this.notify=t,this.cd=n,this.taskService=s,this.injector=i,this.assignees=[],this.anonymous=!1,this.anonymousText="",this.pscChange=null,this.disabled=!1,this.filter={notGetCurrentUser:!1,notGetStopUser:!0,orderField:"order",withAllOrg:!0,orgId:""},this.ifShowBlank=!0,this.openFromIframe=!1,this.isUseNewSelectUserHelp=!1,this.ifHorizontal=!1,this.afterConfirm=new C.EventEmitter,this.groupIcon='<i class="f-icon f-icon-plus-circle text-primary"></i>',this.extendUserHelp=!1,this.taskService.getWfUserHelpConfig().subscribe(function(e){e&&e.userHelpConfig&&"true"==e.userHelpConfig.isExtend&&(r.extendUserHelp=!0,r.extendUserHelpUrl=e.userHelpConfig.url+"?v=20221114")},function(e){console.error(e)})}var Ge=(Ke.prototype.ngOnInit=function(){var t=this,e=this.subject.pipe(k.throttleTime(this.THROTTLE_TIME));this.click=e.subscribe(function(e){t.throttleClick.emit(e)})},Ke.prototype.ngOnDestroy=function(){this.click.unsubscribe()},Ke.prototype.onClick=function(e){this.subject.next(e)},Ke.decorators=[{type:C.Directive,args:[{selector:"[directive-throttle]"}]}],Ke.ctorParameters=function(){return[]},Ke.propDecorators={throttleClick:[{type:C.Output}],onClick:[{type:C.HostListener,args:["click",["$event"]]}]},Ke);function Ke(){this.THROTTLE_TIME=2e3,this.subject=new x.Subject,this.throttleClick=new C.EventEmitter}var Je=function(){},Xe=function(){},$e=function(){},n=(Object.defineProperty(Ye.prototype,"TaskCenterConfig",{set:function(e){var t,n,s;e&&e.length&&(t=e.find(function(e){return e.configCode==ee}),n=e.find(function(e){return e.configCode==te}),s=e.find(function(e){return e.configCode==Z}),e=e.find(function(e){return e.configCode===ie}),t&&"true"===t.currentValue&&(this.ifShowAttachment=!0),n&&"true"===n.currentValue&&(this.ifShowSign=!0),s&&"false"===s.currentValue&&(this.ifEnableSign=!1),e&&"false"===e.currentValue&&(this.ifCanEditSign=!1),this.ifShowSign&&this.ifEnableSign&&this.getUserSign(this.curUserId))},enumerable:!0,configurable:!0}),Object.defineProperty(Ye.prototype,"value",{get:function(){return this._value},set:function(e){this._value!==e&&(this._value=e,this.onModelChange(e))},enumerable:!0,configurable:!0}),Ye.prototype.ngOnInit=function(){var t=this;this.commentManageComp.getConfirmSUbject().subscribe(function(e){t.commentDialog&&t.commentDialog.close()}),this.commentManageComp.getCancelSubject().subscribe(function(){t.commentDialog&&t.commentDialog.close()})},Ye.prototype.showCommentDialog=function(){this.dropDownEl&&this.dropDownEl.close(),this.commentDialog.show()},Ye.prototype.loadComments=function(){var t=this;this.taskService.getCommentList().subscribe(function(e){t.commentList=e})},Ye.prototype.writeValue=function(e){e!==this.value&&(this.value=e)},Ye.prototype.registerOnChange=function(e){this.onModelChange=e},Ye.prototype.registerOnTouched=function(e){this.onModelTouched=e},Ye.prototype.buttonClick=function(e){this.dropDownEl.close(),this.value=this.value==this.defaultComment?e:this.value+e},Ye.prototype.uploadAttachment=function(){var g=this,f=!1;this.uploadDialog.uploadFile(this.processInstanceId||"gspwftaskattachment","wf_attachment").then(function(e){var t,n,s,i;try{for(var r=U(e),o=r.next();!o.done;o=r.next()){var a=o.value;f=!1;try{for(var c=U(g.attachmentList),l=c.next();!l.done;l=c.next())if(l.value.fileName===a.fileName){g.messageService.info("包含重复文件"+a.fileName),f=!0;break}}catch(d){s={error:d}}finally{try{l&&!l.done&&(i=c["return"])&&i.call(c)}finally{if(s)throw s.error}}f||g.attachmentList.push(a)}}catch(h){t={error:h}}finally{try{o&&!o.done&&(n=r["return"])&&n.call(r)}finally{if(t)throw t.error}}g.attachment.emit(g.attachmentList);var u=new Je;u.rootId="wf_attachment",u.metadataIdList=[],g.attachmentList.forEach(function(e){u.metadataIdList.push(e.metadataId)}),u.metadataIdList.length&&g.taskService.uploadAttachment(u).subscribe(function(){})})},Ye.prototype.attachmentDelete=function(e){var t={rootId:"wf_attachment",metadataId:e.metadataId,mode:"Formal"},e=this.attachmentList.indexOf(e);-1<e&&this.attachmentList.splice(e,1),this.attachment.emit(this.attachmentList),this.taskService.deleteAttachment(t).subscribe(function(){})},Ye.prototype.attachmentPreview=function(e){e={appType:"app",funcId:"",tabName:"文档在线预览",appId:"6ccb476b-f2ba-df8f-6f47-d37d100c56e2",appEntrance:"docviewertab",tabId:(new Date).getTime(),entityParams:{metadataIdList:[e],rootId:"wf_attachment",metadataId:null,viewOptions:{showHeader:!0,showPaging:!0,showThumbnails:!0,showDownload:!0,showSearch:!0,showZoom:!0,showPrint:!0,showSecondaryToolBar:!0}}};window.gspframeworkService.rtf.func.openMenu(e)},Ye.prototype.imageUrl=function(e){return"/platform/runtime/wf/webapp/mobiletaskcenter/assets/accessory/"+this.taskService.createItem(e)+".svg?v=20220303"},Ye.prototype.showSignDialog=function(){this.signDialog.show(),this.ifEnableSign||this.getUserSign(this.curUserId)},Ye.prototype.clickToDeleteImage=function(){this.signatureImage="",this.signature.emit(null);var t=this.loadingService.show();this.taskService.addUserConfig(Z,"false").subscribe(function(e){t.close()},function(){t.close()})},Ye.prototype.clickToUseSign=function(){this.ifUseImg=!1,this.ifUseSign=!0;var e=this.signaturePad.canvasDiv.nativeElement.querySelector("canvas");e.height=252,e.width=665},Ye.prototype.clickToUploadImg=function(){this.farrisAvatar.onClick()},Ye.prototype.clickToConfirm=function(){var e;this.signaturePad&&this.signaturePad.isDraw?e=this.signaturePad.confirm():this.ifUploadImg&&(e=this.tmpSignatureImage),e?this.uploadSignatureImg(e):(this.signatureImage=this.tmpSignatureImage,this.signature.emit(this.originSignId),this.signDialog.close());var t=this.loadingService.show();this.taskService.addUserConfig(Z,"true").subscribe(function(e){t.close()},function(){t.close()})},Ye.prototype.clickToReset=function(){this.ifUseSign=!1,this.ifUseImg=!0,this.signatureImage="",this.tmpSignatureImage="",this.signature.emit(""),this.signaturePad&&(this.signaturePad.isDraw=!1),this.ifUploadImg=!1},Ye.prototype.clickToCancel=function(){this.signDialog.close()},Ye.prototype.imgChange=function(e){this.ifUseImg=!0,this.ifUseSign=!1,this.ifUploadImg=!0;e=e.base64;this.tmpSignatureImage=e,this.signatureImage=e},Ye.prototype.uploadSignatureImg=function(t){var n=this,e=new Xe;e.fileContent=t.split(",")[1],e.filePath=this.curUserId,e.mode="Formal",e.metadata=new $e,e.metadata.id=this.taskService.createNM(),e.metadata.fileName=this.taskService.createNM()+".png",e.metadata.rootId="taskcentersignature",e.metadata.docType="png";var s=this.loadingService.show();this.taskService.uploadSignature(e).subscribe(function(e){s.close(),n.originSignId=e,n.signature.emit(e),n.signatureImage=t,n.signDialog.close(),localStorage.setItem("gspWfTaskUserSign"+n.curUserId+n.taskService.getCurrentDateString(),e)},function(e){s.close(),n.messageService.error("上传签名失败")})},Ye.prototype.getUserSign=function(e){var t=this,n=this.loadingService.show();this.taskService.getUserSignId(e).subscribe(function(e){n.close(),e&&(t.signature.emit(e),t.originSignId=e,t.signatureImage=t.downloadService.getDownloadUrl(e,"taskcentersignature"),t.tmpSignatureImage=t.signatureImage)},function(e){console.error(e),n.close()})},Ye.prototype.valueChange=function(e){4e3<this.taskService.getBytesLength(this.value)?this.isShowCommonTips=!0:this.isShowCommonTips=!1},Ye.decorators=[{type:C.Component,args:[{selector:"wf-comment",template:'<div\r\n  class="fa-approve-comment fa-approve-common-gutter"\r\n  style="margin-bottom: 14px"\r\n>\r\n  \x3c!-- 输入框 --\x3e\r\n  <div class="fa-approve-comment--content">\r\n    <textarea\r\n      class="form-control content-textarea"\r\n      style="font-size: 13px"\r\n      [(ngModel)]="value"\r\n      (ngModelChange)="valueChange($event)"\r\n      [attr.placeholder]="placeholder"\r\n      [style.height.px]="textAreaHeight"\r\n    ></textarea>\r\n  </div>\r\n  <div\r\n    class="fa-approve-comment--footer wf-approve-comment--footer"\r\n    *ngIf="isShowCommonTips"\r\n  >\r\n    <div class="wf-feature-warning"></div>\r\n    <span\r\n      ><span class="wf-feature-span">{{\r\n        "comment.static.comment" | translate\r\n      }}</span\r\n      >{{ "comment.static.tooLongTips" | translate }}</span\r\n    >\r\n  </div>\r\n  \x3c!-- 输入框下方一排按钮 --\x3e\r\n  <div class="fa-approve-comment--footer">\r\n    <div\r\n      *ngIf="showAttachment || showSign || showCommonComment"\r\n      class="approve-comment--text-btns"\r\n    >\r\n      \x3c!-- 常用意见 --\x3e\r\n      <div\r\n        *ngIf="showCommonComment"\r\n        class="text-btns-item"\r\n        (click)="loadComments()"\r\n        (mouseover)="btnHover.commentHover = true"\r\n        (mouseleave)="btnHover.commentHover = false"\r\n        [ngClass]="btnHover.commentHover && \'text-primary\'"\r\n      >\r\n        <div fDropdown #dropdownEl="fDropdown">\r\n          <div fDropdownToggle>\r\n            <span class="f-icon f-icon-message"></span>\r\n            <span>\r\n              {{ "comment.static.inputLabel" | translate }}\r\n            </span>\r\n          </div>\r\n          <div class="dropdown-menu task-drop-down-menu" fDropdownMenu>\r\n            <li\r\n              class="dropdown-item"\r\n              *ngFor="let comment of commentList"\r\n              (click)="buttonClick(comment.message)"\r\n            >\r\n              <span>{{ comment.message }}</span>\r\n            </li>\r\n            <div class="dropdown-divider"></div>\r\n            \x3c!-- 意见管理 --\x3e\r\n            <div\r\n              class="dropdown-item"\r\n              style="display: flex; align-items: center"\r\n              (click)="showCommentDialog()"\r\n            >\r\n              <span class="f-icon f-icon-home-setup"></span>\r\n              <span style="padding-left: 6px">{{\r\n                "comment.static.manage" | translate\r\n              }}</span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      \x3c!-- 上传附件 --\x3e\r\n      <div\r\n        class="text-btns-item"\r\n        *ngIf="ifShowAttachment && showAttachment"\r\n        (click)="uploadAttachment()"\r\n        (mouseover)="btnHover.attachmentHover = true"\r\n        (mouseleave)="btnHover.attachmentHover = false"\r\n        [ngClass]="btnHover.attachmentHover && \'text-primary\'"\r\n        title="{{ \'comment.attachment.tips\' | translate }}"\r\n      >\r\n        <span class="f-icon f-icon-attachment"></span>\r\n        <span class="text-btns-item--text">\r\n          {{ "comment.static.attachmentUpload" | translate }}\r\n        </span>\r\n      </div>\r\n      \x3c!-- 手写签名 --\x3e\r\n      <div\r\n        class="text-btns-item"\r\n        *ngIf="showSign && ifShowSign && ifCanEditSign && curUserId"\r\n        title="{{ \'comment.signature.tips\' | translate }}"\r\n        (click)="showSignDialog()"\r\n        (mouseover)="btnHover.signHover = true"\r\n        (mouseleave)="btnHover.signHover = false"\r\n        [ngClass]="btnHover.signHover && \'text-primary\'"\r\n      >\r\n        <span class="f-icon f-icon-edit"></span>\r\n        <span>{{ "comment.signature.title" | translate }}</span>\r\n      </div>\r\n      \x3c!-- 手写签名预览 --\x3e\r\n      <div\r\n        *ngIf="showSign && ifShowSign && signatureImage"\r\n        class="signatureImage"\r\n      >\r\n        <img [src]="signatureImage" style="width: 70px; height: 26px" />\r\n        <div\r\n          *ngIf="ifCanEditSign"\r\n          class="attachment-delete"\r\n          (click)="clickToDeleteImage()"\r\n          title="{{ \'comment.signature.disable\' | translate }}"\r\n        >\r\n          <span class="f-icon f-icon-x"></span>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n\x3c!-- 上传后的附件预览 --\x3e\r\n<div *ngIf="attachmentList?.length > 0" style="margin-bottom: 20px">\r\n  <div\r\n    class="task-comment-attachment"\r\n    *ngFor="let attachment of attachmentList"\r\n  >\r\n    \x3c!-- 附件名称 --\x3e\r\n    <div class="task-comment-attachment-title">\r\n      <img class="task-comment-attachment-img" [src]="imageUrl(attachment)" />\r\n      <span>{{ attachment.fileName }}</span>\r\n    </div>\r\n    <div style="display: flex; align-items: center">\r\n      \x3c!-- 附件大小 --\x3e\r\n      <div *ngIf="attachment.fileSize" class="task-comment-attachment-size">\r\n        {{ attachment.fileSize }}\r\n      </div>\r\n      \x3c!-- 查看 --\x3e\r\n      <div\r\n        *ngIf="taskOrigin == \'TaskForm\'"\r\n        class="task-comment-attach-icon"\r\n        (click)="attachmentPreview(attachment.metadataId)"\r\n        title="{{ \'comment.signature.view\' | translate }}"\r\n      >\r\n        <span class="f-icon f-icon-enclosure_browse"></span>\r\n      </div>\r\n      \x3c!-- 删除 --\x3e\r\n      <div\r\n        class="task-comment-attach-icon"\r\n        (click)="attachmentDelete(attachment)"\r\n        title="{{ \'comment.signature.delete\' | translate }}"\r\n      >\r\n        <span class="f-icon f-icon-enclosure_delete"></span>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n\x3c!-- 常用意见维护 --\x3e\r\n<farris-dialog\r\n  #commentDialog\r\n  [width]="740"\r\n  [height]="440"\r\n  [buttons]="commentManageComp.buttons"\r\n  [title]="\'comment.static.title\' | translate"\r\n>\r\n  <lib-comment-manage #commentManageComp></lib-comment-manage>\r\n</farris-dialog>\r\n\r\n\x3c!-- 签名弹框 --\x3e\r\n<farris-dialog\r\n  #signDialog\r\n  [buttons]="signButtons"\r\n  [width]="710"\r\n  [height]="420"\r\n  [title]="\'comment.signature.dialogTitle\' | translate"\r\n  [resizable]="false"\r\n  [showMaxButton]="false"\r\n>\r\n  <wf-sign-here\r\n    #wfSignHere\r\n    [title]="\'\'"\r\n    [ngStyle]="!ifUseSign ? { display: \'none\' } : null"\r\n  ></wf-sign-here>\r\n  <div *ngIf="ifUseImg && tmpSignatureImage" class="signature-img-default">\r\n    <img [src]="tmpSignatureImage" style="height: 252px" />\r\n  </div>\r\n  <div *ngIf="ifUseImg && !tmpSignatureImage" class="signature-img-div">\r\n    <div class="signature-img-main">\r\n      <div style="margin-bottom: 28px">\r\n        <img\r\n          src="/platform/runtime/common/web/@gsp-wf/wf-task-handler/assets/img/signIcon.svg?v=20210623"\r\n        />\r\n      </div>\r\n      <div class="signature-img-text">\r\n        <span>{{ "comment.signature.note1" | translate }}</span>\r\n        <span class="signature-text-action" (click)="clickToUseSign()">{{\r\n          "comment.signature.sign" | translate\r\n        }}</span>\r\n        <span>{{ "comment.signature.note2" | translate }}</span>\r\n        <span class="signature-text-action" (click)="clickToUploadImg()">{{\r\n          "comment.signature.upload" | translate\r\n        }}</span>\r\n        <span>{{ "comment.signature.note3" | translate }}</span>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</farris-dialog>\r\n\r\n\x3c!-- 手写签名按钮 --\x3e\r\n<ng-template #signButtons>\r\n  <button class="btn btn-secondary" (click)="clickToCancel()">\r\n    {{ "comment.static.cancel" | translate }}\r\n  </button>\r\n  <button class="btn btn-secondary mr-2" (click)="clickToReset()">\r\n    {{ "comment.signature.reset" | translate }}\r\n  </button>\r\n  <button class="btn btn-primary mr-2" (click)="clickToConfirm()">\r\n    {{ "comment.signature.ok" | translate }}\r\n  </button>\r\n</ng-template>\r\n\r\n\x3c!-- 使用头像组件做图片上传 --\x3e\r\n<farris-avatar\r\n  #farrisAvatar\r\n  (imgChange)="imgChange($event)"\r\n  style="display: none"\r\n></farris-avatar>\r\n',providers:[{provide:T.NG_VALUE_ACCESSOR,useExisting:C.forwardRef(function(){return Ye}),multi:!0}],styles:[':host ::ng-deep .dropdown .btn{padding:0}:host ::ng-deep .dropdown .btn-secondary{box-shadow:none}:host ::ng-deep .dropdown .btn-secondary:focus{box-shadow:none}:host ::ng-deep .dropdown .btn-secondary:hover{color:#388fff}.signatureImage:hover .attachment-delete{display:block}.fa-approve-common-gutter{margin:0 0 12px}.fa-approve-comment .approve-comment--title{display:inline-block;color:#667580;border-radius:4px 4px 0 0;height:26px;padding:0 9px;position:relative;background:#f7f7f7;cursor:pointer}.fa-approve-comment .approve-comment--title:after{content:"";height:100%;position:absolute;right:-10px;top:0;bottom:0;border-right:5px solid transparent;border-left:5px solid #f7f7f7;border-bottom:13px solid #f7f7f7;border-top:13px solid transparent}.fa-approve-comment .approve-comment--title .fa-btn-like-dropdown{font-size:12px;padding:2px 0}.fa-approve-comment .fa-approve-comment--content .content-textarea{border-color:#dcdcdc;border-radius:0 0 2px 2px}.fa-approve-comment .fa-approve-comment--footer{font-size:13px;color:#667580;background:#f7f7f7;align-items:center;padding:5px 0}.fa-approve-comment .approve-comment--text-btns{display:flex;flex-direction:row;padding:0 5px}.fa-approve-comment .approve-comment--text-btns .text-btns-item{display:flex;flex-direction:row;align-items:center;font-size:12px;line-height:18px;color:#667580;margin-right:12px;cursor:pointer}.fa-approve-comment .approve-comment--text-btns .text-btns-item .f-icon{margin-right:4px}li{list-style:none}.attachment-delete{float:right;cursor:pointer;display:none;text-align:right;padding-right:10px}.attachment-delete:hover{color:#4297fa}.signature-img-div{display:flex;justify-content:center;align-items:center;height:100%;background:#fafcfd;border:1px solid #d8dfed;border-radius:8px;margin:0 10px}.signature-img-main{display:flex;flex-direction:column;justify-content:center;align-items:center}.signature-img-text{font-size:13px;color:rgba(106,111,121,.85)}.signature-text-action{color:#529efe;padding:0 2px;cursor:pointer}.signature-img-default{display:flex;justify-content:center;align-items:center;height:inherit}.wf-feature-warning{display:inline-block;width:16px;height:16px;line-height:1px;vertical-align:text-bottom;background:url(/platform/runtime/wf/webapp/mobiletaskcenter/assets/img/icon_validator.png)}.wf-approve-comment--footer{font-weight:700;align-items:center;font-family:"PingFang SC","Lantinghei SC","Helvetica Neue",Arial,"Microsoft YaHei","WenQuanYi Micro Hei","Heiti SC","Segoe UI",sans-serif}.wf-feature-span{color:#f60;padding:0 2px}.task-comment-attachment{display:flex;justify-content:space-between;align-items:center;background:rgba(249,252,255,.87);border:0 solid rgba(229,232,237,.71);border-radius:3px;margin-top:10px;padding:4px;cursor:pointer;font-size:13px}.task-comment-attachment-title{display:flex;align-items:center;font-size:12px}.task-comment-attachment-img{width:20px;margin-right:10px}.task-comment-attachment-size{font-size:12px;padding:0 10px;color:rgba(45,47,51,.45)}.task-comment-attach-icon{margin-left:10px;height:16px;width:16px;color:var(--primary);border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:10px;background:#e8f2ff;cursor:pointer}.task-drop-down-menu{max-height:200px;overflow:auto}']}]}],Ye.ctorParameters=function(){return[{type:O},{type:N.UploadDialogService},{type:A.MessagerService},{type:D.LoadingService}]},Ye.propDecorators={showAttachment:[{type:C.Input}],showSign:[{type:C.Input}],showCommonComment:[{type:C.Input}],comment:[{type:C.Input}],placeholder:[{type:C.Input}],processInstanceId:[{type:C.Input}],textAreaHeight:[{type:C.Input}],defaultComment:[{type:C.Input}],curUserId:[{type:C.Input}],taskOrigin:[{type:C.Input}],TaskCenterConfig:[{type:C.Input}],attachment:[{type:C.Output}],signature:[{type:C.Output}],commentDialog:[{type:C.ViewChild,args:["commentDialog"]}],signDialog:[{type:C.ViewChild,args:["signDialog"]}],dropDownEl:[{type:C.ViewChild,args:["dropdownEl"]}],signaturePad:[{type:C.ViewChild,args:["wfSignHere"]}],farrisAvatar:[{type:C.ViewChild,args:["farrisAvatar"]}],commentManageComp:[{type:C.ViewChild,args:["commentManageComp"]}]},Ye);function Ye(e,t,n,s){this.taskService=e,this.uploadDialog=t,this.messageService=n,this.loadingService=s,this.showAttachment=!0,this.showSign=!0,this.showCommonComment=!0,this.placeholder="",this.textAreaHeight=120,this.attachment=new C.EventEmitter,this.signature=new C.EventEmitter,this._value="",this.attachmentList=[],this.ifShowAttachment=!1,this.ifShowSign=!1,this.downloadService=new P.DownloadService,this.ifUseSign=!1,this.ifUseImg=!0,this.ifEnableSign=!0,this.ifUploadImg=!1,this.ifCanEditSign=!0,this.isShowCommonTips=!1,this.commentList=[],this.btnHover={commentHover:!1,attachmentHover:!1,signHover:!1},this.onModelChange=function(e){},this.onModelTouched=function(e){}}Qe.decorators=[{type:C.NgModule,args:[{declarations:[Fe,we,_e,je,Re,Ge,n,fe,Ee],imports:[s.CommonModule,T.FormsModule,i.DataTableModule,r.FarrisDialogModule,o.PaginationModule,I.NotifyModule,a.ComboListModule,f.WfApprovalLogsModule,m.UiFlowchartModule,S.CommonSharedModule,D.LoadingModule,p.TaskImplApiModule,A.MessagerModule,c.InputGroupModule,y.WfSignModule,v.AvatarModule,b.FDropdownDirectiveTypeModule,l.DatagridModule,u.DatagridEditorsModule,l.DatagridModule.forRoot(E(u.EditorProviders)),d.FarrisFormsModule,h.SwitchModule,g.FarrisSectionModule],providers:[O,z,Ve,S.FrameworkService,w.SessionService,w.HttpService,w.CacheService,S.FrmEventBus,S.FuncsService],exports:[we,_e,je,Re,n,Ee],entryComponents:[we,_e,je,Re,n,Ee]}]}],h=Qe;function Qe(){}g=function(){};e.WfTaskHandlerService=Ve,e.WfTaskHandlerModule=h,e.TaskService=O,e.I18nService=z,e.TranslatePipe=Fe,e.StartProcessPayload=xe,e.FlowNodeInfo=ke,e.Assignee=Ce,e.CancelSubmitPayload=Te,e.CommonCommentFilter=g,e.AssigneeInfoComponent=Re,e.TaskCommentComponent=n,e.ProcessSelectorComponent=je,e.TaskAssigninfoComponent=_e,e.TaskExecuteComponent=we,e.CommentManageComponent=Ee,e.ɵa=fe,e.ɵb=Ge,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=gsp-wf-wf-task-handler.umd.min.js.map