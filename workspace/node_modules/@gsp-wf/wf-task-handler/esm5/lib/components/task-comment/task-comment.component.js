/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
import { Component, Input, ViewChild, forwardRef, Output, EventEmitter } from '@angular/core';
import { DialogComponent } from '@farris/ui-dialog';
import { NG_VALUE_ACCESSOR } from '@angular/forms';
import { FDropdownDirective } from '@farris/ui-dropdown';
import { UploadDialogService } from '@gsp-svc/formdoc-upload';
import { MessagerService } from '@farris/ui-messager';
import { FileUploadEntity, GspDocMetadata, GspDocUploadEntity } from '../../entity/attachment';
import { SignHereComponent } from '@gsp-wf/wf-sign';
import { AvatarComponent } from '@farris/ui-avatar';
import { DownloadService } from '@gsp-svc/file-load';
import { TaskService } from '../../service/task.service';
import { LoadingService } from '@farris/ui-loading';
import { ConfigCode } from '../../entity/task-center-config';
import { CommentManageComponent } from '../comment-manage/comment-manage.component';
var TaskCommentComponent = /** @class */ (function () {
    function TaskCommentComponent(taskService, uploadDialog, messageService, loadingService) {
        this.taskService = taskService;
        this.uploadDialog = uploadDialog;
        this.messageService = messageService;
        this.loadingService = loadingService;
        this.showAttachment = true; //是否显示附件上传，组件控制
        //是否显示附件上传，组件控制
        this.showSign = true; //是否显示签名，组件控制（不同动作可能会不显示）
        //是否显示签名，组件控制（不同动作可能会不显示）
        this.showCommonComment = true; //是否显示常用意见
        this.placeholder = '';
        this.textAreaHeight = 120; //文字框的高度
        this.attachment = new EventEmitter(); //附件
        //附件
        this.signature = new EventEmitter(); //上传签名之后，发送签名id
        //意见维护组件
        this._value = '';
        this.attachmentList = [];
        this.ifShowAttachment = false; //任务中心配置，是否显示附件上传
        //任务中心配置，是否显示附件上传
        this.ifShowSign = false; //任务中心配置，是否显示手写签名
        //临时保存上传的图片
        this.downloadService = new DownloadService();
        this.ifUseSign = false; //是否使用手写
        //是否使用手写
        this.ifUseImg = true; //是否使用上传图片
        //是否使用上传图片
        this.ifEnableSign = true; //是否默认启用签名
        //是否默认启用签名
        this.ifUploadImg = false; //是否上传过图片
        //是否上传过图片
        this.ifCanEditSign = true; //是否允许编辑签名
        //原始的签名id
        this.isShowCommonTips = false; //是否展示提示
        //是否展示提示
        this.commentList = [];
        this.btnHover = {
            //按钮hover样式变化
            commentHover: false,
            attachmentHover: false,
            signHover: false
        };
        this.onModelChange = (/**
         * @param {?} obj
         * @return {?}
         */
        function (obj) { });
        this.onModelTouched = (/**
         * @param {?} obj
         * @return {?}
         */
        function (obj) { });
    }
    Object.defineProperty(TaskCommentComponent.prototype, "TaskCenterConfig", {
        set: 
        //当前是任务列表打开还是任务办理界面打开
        /**
         * @param {?} configList
         * @return {?}
         */
        function (configList) {
            if (configList && configList.length) {
                /** @type {?} */
                var attachment = configList.find((/**
                 * @param {?} a
                 * @return {?}
                 */
                function (a) { return a.configCode == ConfigCode.If_Show_Attachment; }));
                /** @type {?} */
                var sign = configList.find((/**
                 * @param {?} a
                 * @return {?}
                 */
                function (a) { return a.configCode == ConfigCode.If_Show_Signature; }));
                /** @type {?} */
                var enableSign = configList.find((/**
                 * @param {?} a
                 * @return {?}
                 */
                function (a) { return a.configCode == ConfigCode.If_Use_Sign_By_Default; }));
                /** @type {?} */
                var editSign = configList.find((/**
                 * @param {?} a
                 * @return {?}
                 */
                function (a) { return a.configCode === ConfigCode.If_Can_Edit_Signature; }));
                attachment && attachment.currentValue === 'true' && (this.ifShowAttachment = true);
                sign && sign.currentValue === 'true' && (this.ifShowSign = true);
                enableSign && enableSign.currentValue === 'false' && (this.ifEnableSign = false);
                editSign && editSign.currentValue === 'false' && (this.ifCanEditSign = false);
                if (this.ifShowSign && this.ifEnableSign) {
                    this.getUserSign(this.curUserId);
                }
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TaskCommentComponent.prototype, "value", {
        get: /**
         * @return {?}
         */
        function () {
            return this._value;
        },
        set: /**
         * @param {?} v
         * @return {?}
         */
        function (v) {
            if (this._value !== v) {
                this._value = v;
                this.onModelChange(v);
            }
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    TaskCommentComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this.commentManageComp.getConfirmSUbject().subscribe((/**
         * @param {?} re
         * @return {?}
         */
        function (re) {
            _this.commentDialog && _this.commentDialog.close();
        }));
        this.commentManageComp.getCancelSubject().subscribe((/**
         * @return {?}
         */
        function () {
            _this.commentDialog && _this.commentDialog.close();
        }));
    };
    /**
     * 弹出常用意见管理框
     */
    /**
     * 弹出常用意见管理框
     * @return {?}
     */
    TaskCommentComponent.prototype.showCommentDialog = /**
     * 弹出常用意见管理框
     * @return {?}
     */
    function () {
        this.dropDownEl && this.dropDownEl.close();
        this.commentDialog.show();
    };
    /**
     * 点击常用意见，获取用户常用意见列表
     */
    /**
     * 点击常用意见，获取用户常用意见列表
     * @return {?}
     */
    TaskCommentComponent.prototype.loadComments = /**
     * 点击常用意见，获取用户常用意见列表
     * @return {?}
     */
    function () {
        var _this = this;
        this.taskService.getCommentList().subscribe((/**
         * @param {?} data
         * @return {?}
         */
        function (data) {
            _this.commentList = data;
        }));
    };
    /**
     * ControlValueAccessor必须实现的方法
     */
    /**
     * ControlValueAccessor必须实现的方法
     * @param {?} value
     * @return {?}
     */
    TaskCommentComponent.prototype.writeValue = /**
     * ControlValueAccessor必须实现的方法
     * @param {?} value
     * @return {?}
     */
    function (value) {
        if (value !== this.value) {
            this.value = value;
        }
    };
    /**
     * @param {?} fn
     * @return {?}
     */
    TaskCommentComponent.prototype.registerOnChange = /**
     * @param {?} fn
     * @return {?}
     */
    function (fn) {
        this.onModelChange = fn;
    };
    /**
     * @param {?} fn
     * @return {?}
     */
    TaskCommentComponent.prototype.registerOnTouched = /**
     * @param {?} fn
     * @return {?}
     */
    function (fn) {
        this.onModelTouched = fn;
    };
    /**
     * 选择一条常用意见后事件
     */
    /**
     * 选择一条常用意见后事件
     * @param {?} data
     * @return {?}
     */
    TaskCommentComponent.prototype.buttonClick = /**
     * 选择一条常用意见后事件
     * @param {?} data
     * @return {?}
     */
    function (data) {
        this.dropDownEl.close();
        this.value = this.value == this.defaultComment ? data : this.value + data;
    };
    /**
     * 上传附件
     */
    /**
     * 上传附件
     * @return {?}
     */
    TaskCommentComponent.prototype.uploadAttachment = /**
     * 上传附件
     * @return {?}
     */
    function () {
        var _this = this;
        /** @type {?} */
        var isRepeat = false;
        this.uploadDialog.uploadFile(this.processInstanceId ? this.processInstanceId : 'gspwftaskattachment', 'wf_attachment').then((/**
         * @param {?} re
         * @return {?}
         */
        function (re) {
            var e_1, _a, e_2, _b;
            try {
                for (var _c = tslib_1.__values(((/** @type {?} */ (re)))), _d = _c.next(); !_d.done; _d = _c.next()) {
                    var i = _d.value;
                    isRepeat = false;
                    try {
                        for (var _e = tslib_1.__values(_this.attachmentList), _f = _e.next(); !_f.done; _f = _e.next()) {
                            var attach = _f.value;
                            if (attach.fileName === i.fileName) {
                                _this.messageService.info('包含重复文件' + i.fileName);
                                isRepeat = true;
                                break;
                            }
                        }
                    }
                    catch (e_2_1) { e_2 = { error: e_2_1 }; }
                    finally {
                        try {
                            if (_f && !_f.done && (_b = _e.return)) _b.call(_e);
                        }
                        finally { if (e_2) throw e_2.error; }
                    }
                    if (!isRepeat) {
                        _this.attachmentList.push(i);
                    }
                }
            }
            catch (e_1_1) { e_1 = { error: e_1_1 }; }
            finally {
                try {
                    if (_d && !_d.done && (_a = _c.return)) _a.call(_c);
                }
                finally { if (e_1) throw e_1.error; }
            }
            _this.attachment.emit(_this.attachmentList);
            //执行上传附件
            /** @type {?} */
            var files = new FileUploadEntity();
            files.rootId = "wf_attachment";
            files.metadataIdList = [];
            _this.attachmentList.forEach((/**
             * @param {?} a
             * @return {?}
             */
            function (a) {
                files.metadataIdList.push(a.metadataId);
            }));
            files.metadataIdList.length && _this.taskService.uploadAttachment(files).subscribe((/**
             * @return {?}
             */
            function () { }));
        }));
    };
    /**
     * 删除附件
     */
    /**
     * 删除附件
     * @param {?} attachment
     * @return {?}
     */
    TaskCommentComponent.prototype.attachmentDelete = /**
     * 删除附件
     * @param {?} attachment
     * @return {?}
     */
    function (attachment) {
        /** @type {?} */
        var gspDocDeleteEntity = {
            rootId: "wf_attachment",
            metadataId: attachment.metadataId,
            mode: "Formal"
        };
        /** @type {?} */
        var index = this.attachmentList.indexOf(attachment);
        if (index > -1) {
            this.attachmentList.splice(index, 1);
        }
        this.attachment.emit(this.attachmentList);
        this.taskService.deleteAttachment(gspDocDeleteEntity).subscribe((/**
         * @return {?}
         */
        function () { }));
    };
    /**
    * web端打开附件预览
    */
    /**
     * web端打开附件预览
     * @param {?} metadataId
     * @return {?}
     */
    TaskCommentComponent.prototype.attachmentPreview = /**
     * web端打开附件预览
     * @param {?} metadataId
     * @return {?}
     */
    function (metadataId) {
        /** @type {?} */
        var options = {
            appType: "app",
            funcId: "",
            tabName: "文档在线预览",
            appId: "6ccb476b-f2ba-df8f-6f47-d37d100c56e2",
            appEntrance: "docviewertab",
            tabId: new Date().getTime(),
            entityParams: {
                metadataIdList: [metadataId],
                rootId: "wf_attachment",
                metadataId: null,
                viewOptions: {
                    showHeader: true,
                    showPaging: true,
                    showThumbnails: true,
                    showDownload: true,
                    showSearch: true,
                    showZoom: true,
                    showPrint: true,
                    showSecondaryToolBar: true,
                },
            },
        };
        ((/** @type {?} */ (window))).gspframeworkService.rtf.func.openMenu(options);
    };
    /**
     * 获取不同格式附件的缩略图
     */
    /**
     * 获取不同格式附件的缩略图
     * @param {?} attachmentInfo
     * @return {?}
     */
    TaskCommentComponent.prototype.imageUrl = /**
     * 获取不同格式附件的缩略图
     * @param {?} attachmentInfo
     * @return {?}
     */
    function (attachmentInfo) {
        /** @type {?} */
        var url = '/platform/runtime/wf/webapp/mobiletaskcenter/assets/accessory/';
        return url + this.taskService.createItem(attachmentInfo) + '.svg?v=20220303';
    };
    /**
     * 展示手写签名dialog
     */
    /**
     * 展示手写签名dialog
     * @return {?}
     */
    TaskCommentComponent.prototype.showSignDialog = /**
     * 展示手写签名dialog
     * @return {?}
     */
    function () {
        this.signDialog.show();
        if (!this.ifEnableSign) {
            this.getUserSign(this.curUserId);
        }
    };
    /**
     * 点击删除签名
     */
    /**
     * 点击删除签名
     * @return {?}
     */
    TaskCommentComponent.prototype.clickToDeleteImage = /**
     * 点击删除签名
     * @return {?}
     */
    function () {
        this.signatureImage = '';
        this.signature.emit(null);
        /** @type {?} */
        var load = this.loadingService.show();
        this.taskService.addUserConfig(ConfigCode.If_Use_Sign_By_Default, 'false').subscribe((/**
         * @param {?} re
         * @return {?}
         */
        function (re) {
            load.close();
        }), (/**
         * @return {?}
         */
        function () {
            load.close();
        }));
    };
    /**
     * @return {?}
     */
    TaskCommentComponent.prototype.clickToUseSign = /**
     * @return {?}
     */
    function () {
        this.ifUseImg = false;
        this.ifUseSign = true;
        /** @type {?} */
        var canvas = this.signaturePad.canvasDiv.nativeElement.querySelector('canvas');
        canvas.height = 252;
        canvas.width = 665;
    };
    /**
     * @return {?}
     */
    TaskCommentComponent.prototype.clickToUploadImg = /**
     * @return {?}
     */
    function () {
        this.farrisAvatar.onClick();
    };
    /**
     * 手写签名点确定
     */
    /**
     * 手写签名点确定
     * @return {?}
     */
    TaskCommentComponent.prototype.clickToConfirm = /**
     * 手写签名点确定
     * @return {?}
     */
    function () {
        /** @type {?} */
        var image;
        if (this.signaturePad && this.signaturePad.isDraw) { //如果签过名
            image = this.signaturePad.confirm();
        }
        else if (this.ifUploadImg) { //如果上传过图片
            image = this.tmpSignatureImage;
        }
        if (image) {
            this.uploadSignatureImg(image);
        }
        else {
            this.signatureImage = this.tmpSignatureImage;
            this.signature.emit(this.originSignId);
            this.signDialog.close();
        }
        //添加启用签名配置
        /** @type {?} */
        var load = this.loadingService.show();
        this.taskService.addUserConfig(ConfigCode.If_Use_Sign_By_Default, 'true').subscribe((/**
         * @param {?} re
         * @return {?}
         */
        function (re) {
            load.close();
        }), (/**
         * @return {?}
         */
        function () {
            load.close();
        }));
    };
    /**
     * 点击清空
     */
    /**
     * 点击清空
     * @return {?}
     */
    TaskCommentComponent.prototype.clickToReset = /**
     * 点击清空
     * @return {?}
     */
    function () {
        this.ifUseSign = false;
        this.ifUseImg = true;
        this.signatureImage = '';
        this.tmpSignatureImage = '';
        this.signature.emit('');
        this.signaturePad && (this.signaturePad.isDraw = false);
        this.ifUploadImg = false;
    };
    /**
     * 点击取消
     */
    /**
     * 点击取消
     * @return {?}
     */
    TaskCommentComponent.prototype.clickToCancel = /**
     * 点击取消
     * @return {?}
     */
    function () {
        this.signDialog.close();
    };
    /**
     * 上传图片后事件
     * event.base64 是图片信息,event.name是带后缀的图片名，event.type如image/jpeg
     */
    /**
     * 上传图片后事件
     * event.base64 是图片信息,event.name是带后缀的图片名，event.type如image/jpeg
     * @param {?} event
     * @return {?}
     */
    TaskCommentComponent.prototype.imgChange = /**
     * 上传图片后事件
     * event.base64 是图片信息,event.name是带后缀的图片名，event.type如image/jpeg
     * @param {?} event
     * @return {?}
     */
    function (event) {
        this.ifUseImg = true;
        this.ifUseSign = false;
        this.ifUploadImg = true;
        /** @type {?} */
        var image = event.base64;
        this.tmpSignatureImage = image;
        this.signatureImage = image;
    };
    /**
     * 上传签名
     * @param image
     */
    /**
     * 上传签名
     * @private
     * @param {?} image
     * @return {?}
     */
    TaskCommentComponent.prototype.uploadSignatureImg = /**
     * 上传签名
     * @private
     * @param {?} image
     * @return {?}
     */
    function (image) {
        var _this = this;
        /** @type {?} */
        var uploadSignature = new GspDocUploadEntity();
        uploadSignature.fileContent = image.split(',')[1];
        uploadSignature.filePath = this.curUserId;
        uploadSignature.mode = "Formal";
        uploadSignature.metadata = new GspDocMetadata();
        uploadSignature.metadata.id = this.taskService.createNM();
        uploadSignature.metadata.fileName = this.taskService.createNM() + ".png";
        uploadSignature.metadata.rootId = "taskcentersignature";
        uploadSignature.metadata.docType = "png";
        /** @type {?} */
        var load = this.loadingService.show();
        this.taskService.uploadSignature(uploadSignature).subscribe((/**
         * @param {?} signId
         * @return {?}
         */
        function (signId) {
            load.close();
            _this.originSignId = signId;
            _this.signature.emit(signId);
            _this.signatureImage = image;
            _this.signDialog.close();
            localStorage.setItem('gspWfTaskUserSign' + _this.curUserId + _this.taskService.getCurrentDateString(), signId);
        }), (/**
         * @param {?} error
         * @return {?}
         */
        function (error) {
            load.close();
            _this.messageService.error('上传签名失败');
        }));
    };
    /**
     * 获取用户的最近一次签名
     */
    /**
     * 获取用户的最近一次签名
     * @private
     * @param {?} userId
     * @return {?}
     */
    TaskCommentComponent.prototype.getUserSign = /**
     * 获取用户的最近一次签名
     * @private
     * @param {?} userId
     * @return {?}
     */
    function (userId) {
        var _this = this;
        /** @type {?} */
        var load = this.loadingService.show();
        this.taskService.getUserSignId(userId).subscribe((/**
         * @param {?} signId
         * @return {?}
         */
        function (signId) {
            load.close();
            if (signId) {
                _this.signature.emit(signId);
                _this.originSignId = signId;
                _this.signatureImage = _this.downloadService.getDownloadUrl(signId, 'taskcentersignature');
                _this.tmpSignatureImage = _this.signatureImage;
            }
        }), (/**
         * @param {?} error
         * @return {?}
         */
        function (error) {
            console.error(error);
            load.close();
        }));
    };
    //文本框值变动监听事件
    //文本框值变动监听事件
    /**
     * @param {?} e
     * @return {?}
     */
    TaskCommentComponent.prototype.valueChange = 
    //文本框值变动监听事件
    /**
     * @param {?} e
     * @return {?}
     */
    function (e) {
        if (this.taskService.getBytesLength(this.value) > 4000) {
            this.isShowCommonTips = true;
        }
        else {
            this.isShowCommonTips = false;
        }
        ;
    };
    TaskCommentComponent.decorators = [
        { type: Component, args: [{
                    selector: 'wf-comment',
                    template: "<div\r\n  class=\"fa-approve-comment fa-approve-common-gutter\"\r\n  style=\"margin-bottom: 14px\"\r\n>\r\n  <!-- \u8F93\u5165\u6846 -->\r\n  <div class=\"fa-approve-comment--content\">\r\n    <textarea\r\n      class=\"form-control content-textarea\"\r\n      style=\"font-size: 13px\"\r\n      [(ngModel)]=\"value\"\r\n      (ngModelChange)=\"valueChange($event)\"\r\n      [attr.placeholder]=\"placeholder\"\r\n      [style.height.px]=\"textAreaHeight\"\r\n    ></textarea>\r\n  </div>\r\n  <div\r\n    class=\"fa-approve-comment--footer wf-approve-comment--footer\"\r\n    *ngIf=\"isShowCommonTips\"\r\n  >\r\n    <div class=\"wf-feature-warning\"></div>\r\n    <span\r\n      ><span class=\"wf-feature-span\">{{\r\n        \"comment.static.comment\" | translate\r\n      }}</span\r\n      >{{ \"comment.static.tooLongTips\" | translate }}</span\r\n    >\r\n  </div>\r\n  <!-- \u8F93\u5165\u6846\u4E0B\u65B9\u4E00\u6392\u6309\u94AE -->\r\n  <div class=\"fa-approve-comment--footer\">\r\n    <div\r\n      *ngIf=\"showAttachment || showSign || showCommonComment\"\r\n      class=\"approve-comment--text-btns\"\r\n    >\r\n      <!-- \u5E38\u7528\u610F\u89C1 -->\r\n      <div\r\n        *ngIf=\"showCommonComment\"\r\n        class=\"text-btns-item\"\r\n        (click)=\"loadComments()\"\r\n        (mouseover)=\"btnHover.commentHover = true\"\r\n        (mouseleave)=\"btnHover.commentHover = false\"\r\n        [ngClass]=\"btnHover.commentHover && 'text-primary'\"\r\n      >\r\n        <div fDropdown #dropdownEl=\"fDropdown\">\r\n          <div fDropdownToggle>\r\n            <span class=\"f-icon f-icon-message\"></span>\r\n            <span>\r\n              {{ \"comment.static.inputLabel\" | translate }}\r\n            </span>\r\n          </div>\r\n          <div class=\"dropdown-menu task-drop-down-menu\" fDropdownMenu>\r\n            <li\r\n              class=\"dropdown-item\"\r\n              *ngFor=\"let comment of commentList\"\r\n              (click)=\"buttonClick(comment.message)\"\r\n            >\r\n              <span>{{ comment.message }}</span>\r\n            </li>\r\n            <div class=\"dropdown-divider\"></div>\r\n            <!-- \u610F\u89C1\u7BA1\u7406 -->\r\n            <div\r\n              class=\"dropdown-item\"\r\n              style=\"display: flex; align-items: center\"\r\n              (click)=\"showCommentDialog()\"\r\n            >\r\n              <span class=\"f-icon f-icon-home-setup\"></span>\r\n              <span style=\"padding-left: 6px\">{{\r\n                \"comment.static.manage\" | translate\r\n              }}</span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <!-- \u4E0A\u4F20\u9644\u4EF6 -->\r\n      <div\r\n        class=\"text-btns-item\"\r\n        *ngIf=\"ifShowAttachment && showAttachment\"\r\n        (click)=\"uploadAttachment()\"\r\n        (mouseover)=\"btnHover.attachmentHover = true\"\r\n        (mouseleave)=\"btnHover.attachmentHover = false\"\r\n        [ngClass]=\"btnHover.attachmentHover && 'text-primary'\"\r\n        title=\"{{ 'comment.attachment.tips' | translate }}\"\r\n      >\r\n        <span class=\"f-icon f-icon-attachment\"></span>\r\n        <span class=\"text-btns-item--text\">\r\n          {{ \"comment.static.attachmentUpload\" | translate }}\r\n        </span>\r\n      </div>\r\n      <!-- \u624B\u5199\u7B7E\u540D -->\r\n      <div\r\n        class=\"text-btns-item\"\r\n        *ngIf=\"showSign && ifShowSign && ifCanEditSign && curUserId\"\r\n        title=\"{{ 'comment.signature.tips' | translate }}\"\r\n        (click)=\"showSignDialog()\"\r\n        (mouseover)=\"btnHover.signHover = true\"\r\n        (mouseleave)=\"btnHover.signHover = false\"\r\n        [ngClass]=\"btnHover.signHover && 'text-primary'\"\r\n      >\r\n        <span class=\"f-icon f-icon-edit\"></span>\r\n        <span>{{ \"comment.signature.title\" | translate }}</span>\r\n      </div>\r\n      <!-- \u624B\u5199\u7B7E\u540D\u9884\u89C8 -->\r\n      <div\r\n        *ngIf=\"showSign && ifShowSign && signatureImage\"\r\n        class=\"signatureImage\"\r\n      >\r\n        <img [src]=\"signatureImage\" style=\"width: 70px; height: 26px\" />\r\n        <div\r\n          *ngIf=\"ifCanEditSign\"\r\n          class=\"attachment-delete\"\r\n          (click)=\"clickToDeleteImage()\"\r\n          title=\"{{ 'comment.signature.disable' | translate }}\"\r\n        >\r\n          <span class=\"f-icon f-icon-x\"></span>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n<!-- \u4E0A\u4F20\u540E\u7684\u9644\u4EF6\u9884\u89C8 -->\r\n<div *ngIf=\"attachmentList?.length > 0\" style=\"margin-bottom: 20px\">\r\n  <div\r\n    class=\"task-comment-attachment\"\r\n    *ngFor=\"let attachment of attachmentList\"\r\n  >\r\n    <!-- \u9644\u4EF6\u540D\u79F0 -->\r\n    <div class=\"task-comment-attachment-title\">\r\n      <img class=\"task-comment-attachment-img\" [src]=\"imageUrl(attachment)\" />\r\n      <span>{{ attachment.fileName }}</span>\r\n    </div>\r\n    <div style=\"display: flex; align-items: center\">\r\n      <!-- \u9644\u4EF6\u5927\u5C0F -->\r\n      <div *ngIf=\"attachment.fileSize\" class=\"task-comment-attachment-size\">\r\n        {{ attachment.fileSize }}\r\n      </div>\r\n      <!-- \u67E5\u770B -->\r\n      <div\r\n        *ngIf=\"taskOrigin == 'TaskForm'\"\r\n        class=\"task-comment-attach-icon\"\r\n        (click)=\"attachmentPreview(attachment.metadataId)\"\r\n        title=\"{{ 'comment.signature.view' | translate }}\"\r\n      >\r\n        <span class=\"f-icon f-icon-enclosure_browse\"></span>\r\n      </div>\r\n      <!-- \u5220\u9664 -->\r\n      <div\r\n        class=\"task-comment-attach-icon\"\r\n        (click)=\"attachmentDelete(attachment)\"\r\n        title=\"{{ 'comment.signature.delete' | translate }}\"\r\n      >\r\n        <span class=\"f-icon f-icon-enclosure_delete\"></span>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n<!-- \u5E38\u7528\u610F\u89C1\u7EF4\u62A4 -->\r\n<farris-dialog\r\n  #commentDialog\r\n  [width]=\"740\"\r\n  [height]=\"440\"\r\n  [buttons]=\"commentManageComp.buttons\"\r\n  [title]=\"'comment.static.title' | translate\"\r\n>\r\n  <lib-comment-manage #commentManageComp></lib-comment-manage>\r\n</farris-dialog>\r\n\r\n<!-- \u7B7E\u540D\u5F39\u6846 -->\r\n<farris-dialog\r\n  #signDialog\r\n  [buttons]=\"signButtons\"\r\n  [width]=\"710\"\r\n  [height]=\"420\"\r\n  [title]=\"'comment.signature.dialogTitle' | translate\"\r\n  [resizable]=\"false\"\r\n  [showMaxButton]=\"false\"\r\n>\r\n  <wf-sign-here\r\n    #wfSignHere\r\n    [title]=\"''\"\r\n    [ngStyle]=\"!ifUseSign ? { display: 'none' } : null\"\r\n  ></wf-sign-here>\r\n  <div *ngIf=\"ifUseImg && tmpSignatureImage\" class=\"signature-img-default\">\r\n    <img [src]=\"tmpSignatureImage\" style=\"height: 252px\" />\r\n  </div>\r\n  <div *ngIf=\"ifUseImg && !tmpSignatureImage\" class=\"signature-img-div\">\r\n    <div class=\"signature-img-main\">\r\n      <div style=\"margin-bottom: 28px\">\r\n        <img\r\n          src=\"/platform/runtime/common/web/@gsp-wf/wf-task-handler/assets/img/signIcon.svg?v=20210623\"\r\n        />\r\n      </div>\r\n      <div class=\"signature-img-text\">\r\n        <span>{{ \"comment.signature.note1\" | translate }}</span>\r\n        <span class=\"signature-text-action\" (click)=\"clickToUseSign()\">{{\r\n          \"comment.signature.sign\" | translate\r\n        }}</span>\r\n        <span>{{ \"comment.signature.note2\" | translate }}</span>\r\n        <span class=\"signature-text-action\" (click)=\"clickToUploadImg()\">{{\r\n          \"comment.signature.upload\" | translate\r\n        }}</span>\r\n        <span>{{ \"comment.signature.note3\" | translate }}</span>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</farris-dialog>\r\n\r\n<!-- \u624B\u5199\u7B7E\u540D\u6309\u94AE -->\r\n<ng-template #signButtons>\r\n  <button class=\"btn btn-secondary\" (click)=\"clickToCancel()\">\r\n    {{ \"comment.static.cancel\" | translate }}\r\n  </button>\r\n  <button class=\"btn btn-secondary mr-2\" (click)=\"clickToReset()\">\r\n    {{ \"comment.signature.reset\" | translate }}\r\n  </button>\r\n  <button class=\"btn btn-primary mr-2\" (click)=\"clickToConfirm()\">\r\n    {{ \"comment.signature.ok\" | translate }}\r\n  </button>\r\n</ng-template>\r\n\r\n<!-- \u4F7F\u7528\u5934\u50CF\u7EC4\u4EF6\u505A\u56FE\u7247\u4E0A\u4F20 -->\r\n<farris-avatar\r\n  #farrisAvatar\r\n  (imgChange)=\"imgChange($event)\"\r\n  style=\"display: none\"\r\n></farris-avatar>\r\n",
                    providers: [{
                            provide: NG_VALUE_ACCESSOR,
                            useExisting: forwardRef((/**
                             * @return {?}
                             */
                            function () { return TaskCommentComponent; })),
                            multi: true
                        },],
                    styles: [":host ::ng-deep .dropdown .btn{padding:0}:host ::ng-deep .dropdown .btn-secondary{box-shadow:none}:host ::ng-deep .dropdown .btn-secondary:focus{box-shadow:none}:host ::ng-deep .dropdown .btn-secondary:hover{color:#388fff}.signatureImage:hover .attachment-delete{display:block}.fa-approve-common-gutter{margin:0 0 12px}.fa-approve-comment .approve-comment--title{display:inline-block;color:#667580;border-radius:4px 4px 0 0;height:26px;padding:0 9px;position:relative;background:#f7f7f7;cursor:pointer}.fa-approve-comment .approve-comment--title:after{content:\"\";height:100%;position:absolute;right:-10px;top:0;bottom:0;border-right:5px solid transparent;border-left:5px solid #f7f7f7;border-bottom:13px solid #f7f7f7;border-top:13px solid transparent}.fa-approve-comment .approve-comment--title .fa-btn-like-dropdown{font-size:12px;padding:2px 0}.fa-approve-comment .fa-approve-comment--content .content-textarea{border-color:#dcdcdc;border-radius:0 0 2px 2px}.fa-approve-comment .fa-approve-comment--footer{font-size:13px;color:#667580;background:#f7f7f7;align-items:center;padding:5px 0}.fa-approve-comment .approve-comment--text-btns{display:flex;flex-direction:row;padding:0 5px}.fa-approve-comment .approve-comment--text-btns .text-btns-item{display:flex;flex-direction:row;align-items:center;font-size:12px;line-height:18px;color:#667580;margin-right:12px;cursor:pointer}.fa-approve-comment .approve-comment--text-btns .text-btns-item .f-icon{margin-right:4px}li{list-style:none}.attachment-delete{float:right;cursor:pointer;display:none;text-align:right;padding-right:10px}.attachment-delete:hover{color:#4297fa}.signature-img-div{display:flex;justify-content:center;align-items:center;height:100%;background:#fafcfd;border:1px solid #d8dfed;border-radius:8px;margin:0 10px}.signature-img-main{display:flex;flex-direction:column;justify-content:center;align-items:center}.signature-img-text{font-size:13px;color:rgba(106,111,121,.85)}.signature-text-action{color:#529efe;padding:0 2px;cursor:pointer}.signature-img-default{display:flex;justify-content:center;align-items:center;height:inherit}.wf-feature-warning{display:inline-block;width:16px;height:16px;line-height:1px;vertical-align:text-bottom;background:url(/platform/runtime/wf/webapp/mobiletaskcenter/assets/img/icon_validator.png)}.wf-approve-comment--footer{font-weight:700;align-items:center;font-family:\"PingFang SC\",\"Lantinghei SC\",\"Helvetica Neue\",Arial,\"Microsoft YaHei\",\"WenQuanYi Micro Hei\",\"Heiti SC\",\"Segoe UI\",sans-serif}.wf-feature-span{color:#f60;padding:0 2px}.task-comment-attachment{display:flex;justify-content:space-between;align-items:center;background:rgba(249,252,255,.87);border:0 solid rgba(229,232,237,.71);border-radius:3px;margin-top:10px;padding:4px;cursor:pointer;font-size:13px}.task-comment-attachment-title{display:flex;align-items:center;font-size:12px}.task-comment-attachment-img{width:20px;margin-right:10px}.task-comment-attachment-size{font-size:12px;padding:0 10px;color:rgba(45,47,51,.45)}.task-comment-attach-icon{margin-left:10px;height:16px;width:16px;color:var(--primary);border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:10px;background:#e8f2ff;cursor:pointer}.task-drop-down-menu{max-height:200px;overflow:auto}"]
                }] }
    ];
    /** @nocollapse */
    TaskCommentComponent.ctorParameters = function () { return [
        { type: TaskService },
        { type: UploadDialogService },
        { type: MessagerService },
        { type: LoadingService }
    ]; };
    TaskCommentComponent.propDecorators = {
        showAttachment: [{ type: Input }],
        showSign: [{ type: Input }],
        showCommonComment: [{ type: Input }],
        comment: [{ type: Input }],
        placeholder: [{ type: Input }],
        processInstanceId: [{ type: Input }],
        textAreaHeight: [{ type: Input }],
        defaultComment: [{ type: Input }],
        curUserId: [{ type: Input }],
        taskOrigin: [{ type: Input }],
        TaskCenterConfig: [{ type: Input }],
        attachment: [{ type: Output }],
        signature: [{ type: Output }],
        commentDialog: [{ type: ViewChild, args: ['commentDialog',] }],
        signDialog: [{ type: ViewChild, args: ['signDialog',] }],
        dropDownEl: [{ type: ViewChild, args: ['dropdownEl',] }],
        signaturePad: [{ type: ViewChild, args: ['wfSignHere',] }],
        farrisAvatar: [{ type: ViewChild, args: ['farrisAvatar',] }],
        commentManageComp: [{ type: ViewChild, args: ['commentManageComp',] }]
    };
    return TaskCommentComponent;
}());
export { TaskCommentComponent };
if (false) {
    /** @type {?} */
    TaskCommentComponent.prototype.showAttachment;
    /** @type {?} */
    TaskCommentComponent.prototype.showSign;
    /** @type {?} */
    TaskCommentComponent.prototype.showCommonComment;
    /** @type {?} */
    TaskCommentComponent.prototype.comment;
    /** @type {?} */
    TaskCommentComponent.prototype.placeholder;
    /** @type {?} */
    TaskCommentComponent.prototype.processInstanceId;
    /** @type {?} */
    TaskCommentComponent.prototype.textAreaHeight;
    /** @type {?} */
    TaskCommentComponent.prototype.defaultComment;
    /** @type {?} */
    TaskCommentComponent.prototype.curUserId;
    /** @type {?} */
    TaskCommentComponent.prototype.taskOrigin;
    /** @type {?} */
    TaskCommentComponent.prototype.attachment;
    /** @type {?} */
    TaskCommentComponent.prototype.signature;
    /** @type {?} */
    TaskCommentComponent.prototype.commentDialog;
    /** @type {?} */
    TaskCommentComponent.prototype.signDialog;
    /** @type {?} */
    TaskCommentComponent.prototype.dropDownEl;
    /** @type {?} */
    TaskCommentComponent.prototype.signaturePad;
    /** @type {?} */
    TaskCommentComponent.prototype.farrisAvatar;
    /** @type {?} */
    TaskCommentComponent.prototype.commentManageComp;
    /**
     * @type {?}
     * @private
     */
    TaskCommentComponent.prototype._value;
    /** @type {?} */
    TaskCommentComponent.prototype.attachmentList;
    /** @type {?} */
    TaskCommentComponent.prototype.ifShowAttachment;
    /** @type {?} */
    TaskCommentComponent.prototype.ifShowSign;
    /** @type {?} */
    TaskCommentComponent.prototype.signatureImage;
    /** @type {?} */
    TaskCommentComponent.prototype.tmpSignatureImage;
    /** @type {?} */
    TaskCommentComponent.prototype.downloadService;
    /** @type {?} */
    TaskCommentComponent.prototype.ifUseSign;
    /** @type {?} */
    TaskCommentComponent.prototype.ifUseImg;
    /** @type {?} */
    TaskCommentComponent.prototype.ifEnableSign;
    /** @type {?} */
    TaskCommentComponent.prototype.ifUploadImg;
    /** @type {?} */
    TaskCommentComponent.prototype.ifCanEditSign;
    /** @type {?} */
    TaskCommentComponent.prototype.originSignId;
    /** @type {?} */
    TaskCommentComponent.prototype.isShowCommonTips;
    /** @type {?} */
    TaskCommentComponent.prototype.commentList;
    /** @type {?} */
    TaskCommentComponent.prototype.btnHover;
    /** @type {?} */
    TaskCommentComponent.prototype.onModelChange;
    /** @type {?} */
    TaskCommentComponent.prototype.onModelTouched;
    /**
     * @type {?}
     * @private
     */
    TaskCommentComponent.prototype.taskService;
    /**
     * @type {?}
     * @private
     */
    TaskCommentComponent.prototype.uploadDialog;
    /**
     * @type {?}
     * @private
     */
    TaskCommentComponent.prototype.messageService;
    /**
     * @type {?}
     * @private
     */
    TaskCommentComponent.prototype.loadingService;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidGFzay1jb21tZW50LmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0Bnc3Atd2Yvd2YtdGFzay1oYW5kbGVyLyIsInNvdXJjZXMiOlsibGliL2NvbXBvbmVudHMvdGFzay1jb21tZW50L3Rhc2stY29tbWVudC5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQSxPQUFPLEVBQUUsU0FBUyxFQUFVLEtBQUssRUFBRSxTQUFTLEVBQUUsVUFBVSxFQUFFLE1BQU0sRUFBRSxZQUFZLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFDdEcsT0FBTyxFQUFFLGVBQWUsRUFBRSxNQUFNLG1CQUFtQixDQUFDO0FBQ3BELE9BQU8sRUFBd0IsaUJBQWlCLEVBQUUsTUFBTSxnQkFBZ0IsQ0FBQztBQUN6RSxPQUFPLEVBQUUsa0JBQWtCLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQztBQUN6RCxPQUFPLEVBQUUsbUJBQW1CLEVBQUUsTUFBTSx5QkFBeUIsQ0FBQztBQUM5RCxPQUFPLEVBQUUsZUFBZSxFQUFFLE1BQU0scUJBQXFCLENBQUM7QUFDdEQsT0FBTyxFQUFvQixnQkFBZ0IsRUFBRSxjQUFjLEVBQUUsa0JBQWtCLEVBQUUsTUFBTSx5QkFBeUIsQ0FBQztBQUNqSCxPQUFPLEVBQUUsaUJBQWlCLEVBQUUsTUFBTSxpQkFBaUIsQ0FBQztBQUNwRCxPQUFPLEVBQUUsZUFBZSxFQUFFLE1BQU0sbUJBQW1CLENBQUM7QUFDcEQsT0FBTyxFQUFFLGVBQWUsRUFBRSxNQUFNLG9CQUFvQixDQUFDO0FBQ3JELE9BQU8sRUFBRSxXQUFXLEVBQUUsTUFBTSw0QkFBNEIsQ0FBQztBQUV6RCxPQUFPLEVBQUUsY0FBYyxFQUFFLE1BQU0sb0JBQW9CLENBQUM7QUFDcEQsT0FBTyxFQUFFLFVBQVUsRUFBb0IsTUFBTSxpQ0FBaUMsQ0FBQztBQUMvRSxPQUFPLEVBQUUsc0JBQXNCLEVBQUUsTUFBTSw0Q0FBNEMsQ0FBQztBQUVwRjtJQXVGRSw4QkFDVSxXQUF3QixF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QXNDOztJQUN0Qyw4Q0FBZ0M7O0lBQ2hDLHlDQUEyQjs7SUFDM0IsMENBQTRCOztJQW1CNUIsMENBQTBDOztJQUMxQyx5Q0FBeUM7O0lBQ3pDLDZDQUEyRDs7SUFDM0QsMENBQXFEOztJQUNyRCwwQ0FBd0Q7O0lBQ3hELDRDQUF5RDs7SUFDekQsNENBQXlEOztJQUN6RCxpREFBMEU7Ozs7O0lBRzFFLHNDQUFvQjs7SUFDcEIsOENBQTJCOztJQUMzQixnREFBa0M7O0lBQ2xDLDBDQUE0Qjs7SUFDNUIsOENBQXVCOztJQUN2QixpREFBMEI7O0lBQzFCLCtDQUF3Qzs7SUFDeEMseUNBQTJCOztJQUMzQix3Q0FBeUI7O0lBQ3pCLDRDQUE2Qjs7SUFDN0IsMkNBQTZCOztJQUM3Qiw2Q0FBOEI7O0lBQzlCLDRDQUFxQjs7SUFDckIsZ0RBQWtDOztJQUNsQywyQ0FBa0M7O0lBR2xDLHdDQUlDOztJQWFELDZDQUFrQzs7SUFDbEMsOENBQW1DOzs7OztJQUdqQywyQ0FBZ0M7Ozs7O0lBQ2hDLDRDQUF5Qzs7Ozs7SUFDekMsOENBQXVDOzs7OztJQUN2Qyw4Q0FBc0MiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb21wb25lbnQsIE9uSW5pdCwgSW5wdXQsIFZpZXdDaGlsZCwgZm9yd2FyZFJlZiwgT3V0cHV0LCBFdmVudEVtaXR0ZXIgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgRGlhbG9nQ29tcG9uZW50IH0gZnJvbSAnQGZhcnJpcy91aS1kaWFsb2cnO1xyXG5pbXBvcnQgeyBDb250cm9sVmFsdWVBY2Nlc3NvciwgTkdfVkFMVUVfQUNDRVNTT1IgfSBmcm9tICdAYW5ndWxhci9mb3Jtcyc7XHJcbmltcG9ydCB7IEZEcm9wZG93bkRpcmVjdGl2ZSB9IGZyb20gJ0BmYXJyaXMvdWktZHJvcGRvd24nO1xyXG5pbXBvcnQgeyBVcGxvYWREaWFsb2dTZXJ2aWNlIH0gZnJvbSAnQGdzcC1zdmMvZm9ybWRvYy11cGxvYWQnO1xyXG5pbXBvcnQgeyBNZXNzYWdlclNlcnZpY2UgfSBmcm9tICdAZmFycmlzL3VpLW1lc3NhZ2VyJztcclxuaW1wb3J0IHsgRmlsZURlbGV0ZUVudGl0eSwgRmlsZVVwbG9hZEVudGl0eSwgR3NwRG9jTWV0YWRhdGEsIEdzcERvY1VwbG9hZEVudGl0eSB9IGZyb20gJy4uLy4uL2VudGl0eS9hdHRhY2htZW50JztcclxuaW1wb3J0IHsgU2lnbkhlcmVDb21wb25lbnQgfSBmcm9tICdAZ3NwLXdmL3dmLXNpZ24nO1xyXG5pbXBvcnQgeyBBdmF0YXJDb21wb25lbnQgfSBmcm9tICdAZmFycmlzL3VpLWF2YXRhcic7XHJcbmltcG9ydCB7IERvd25sb2FkU2VydmljZSB9IGZyb20gJ0Bnc3Atc3ZjL2ZpbGUtbG9hZCc7XHJcbmltcG9ydCB7IFRhc2tTZXJ2aWNlIH0gZnJvbSAnLi4vLi4vc2VydmljZS90YXNrLnNlcnZpY2UnO1xyXG5pbXBvcnQgeyBDb21tb25Db21tZW50IH0gZnJvbSAnLi4vLi4vZW50aXR5L2NvbW1lbnQnO1xyXG5pbXBvcnQgeyBMb2FkaW5nU2VydmljZSB9IGZyb20gJ0BmYXJyaXMvdWktbG9hZGluZyc7XHJcbmltcG9ydCB7IENvbmZpZ0NvZGUsIFRhc2tDZW50ZXJDb25maWcgfSBmcm9tICcuLi8uLi9lbnRpdHkvdGFzay1jZW50ZXItY29uZmlnJztcclxuaW1wb3J0IHsgQ29tbWVudE1hbmFnZUNvbXBvbmVudCB9IGZyb20gJy4uL2NvbW1lbnQtbWFuYWdlL2NvbW1lbnQtbWFuYWdlLmNvbXBvbmVudCc7XHJcblxyXG5AQ29tcG9uZW50KHtcclxuICBzZWxlY3RvcjogJ3dmLWNvbW1lbnQnLFxyXG4gIHRlbXBsYXRlVXJsOiAnLi90YXNrLWNvbW1lbnQuY29tcG9uZW50Lmh0bWwnLFxyXG4gIHN0eWxlVXJsczogWycuL3Rhc2stY29tbWVudC5jb21wb25lbnQuc2NzcyddLFxyXG4gIHByb3ZpZGVyczogW3tcclxuICAgIHByb3ZpZGU6IE5HX1ZBTFVFX0FDQ0VTU09SLFxyXG4gICAgdXNlRXhpc3Rpbmc6IGZvcndhcmRSZWYoKCkgPT4gVGFza0NvbW1lbnRDb21wb25lbnQpLFxyXG4gICAgbXVsdGk6IHRydWVcclxuICB9LF1cclxufSlcclxuZXhwb3J0IGNsYXNzIFRhc2tDb21tZW50Q29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0LCBDb250cm9sVmFsdWVBY2Nlc3NvciB7XHJcblxyXG4gIEBJbnB1dCgpIHNob3dBdHRhY2htZW50OiBib29sZWFuID0gdHJ1ZTsvL+aYr+WQpuaYvuekuumZhOS7tuS4iuS8oO+8jOe7hOS7tuaOp+WItlxyXG4gIEBJbnB1dCgpIHNob3dTaWduOiBib29sZWFuID0gdHJ1ZTsvL+aYr+WQpuaYvuekuuetvuWQje+8jOe7hOS7tuaOp+WItu+8iOS4jeWQjOWKqOS9nOWPr+iDveS8muS4jeaYvuekuu+8iVxyXG4gIEBJbnB1dCgpIHNob3dDb21tb25Db21tZW50ID0gdHJ1ZTsvL+aYr+WQpuaYvuekuuW4uOeUqOaEj+ingVxyXG4gIEBJbnB1dCgpIGNvbW1lbnQ6IHN0cmluZztcclxuICBASW5wdXQoKSBwbGFjZWhvbGRlciA9ICcnO1xyXG4gIEBJbnB1dCgpIHByb2Nlc3NJbnN0YW5jZUlkOiBzdHJpbmc7XHJcbiAgQElucHV0KCkgdGV4dEFyZWFIZWlnaHQ6IG51bWJlciA9IDEyMDsvL+aWh+Wtl+ahhueahOmrmOW6plxyXG4gIEBJbnB1dCgpIGRlZmF1bHRDb21tZW50OiBzdHJpbmc7Ly/pu5jorqTnmoTmhI/op4FcclxuICBASW5wdXQoKSBjdXJVc2VySWQ6IHN0cmluZzsvL+W9k+WJjeeUqOaIt2lkXHJcbiAgQElucHV0KCkgdGFza09yaWdpbjogc3RyaW5nOy8v5b2T5YmN5piv5Lu75Yqh5YiX6KGo5omT5byA6L+Y5piv5Lu75Yqh5Yqe55CG55WM6Z2i5omT5byAXHJcblxyXG4gIEBJbnB1dCgpXHJcbiAgc2V0IFRhc2tDZW50ZXJDb25maWcoY29uZmlnTGlzdDogVGFza0NlbnRlckNvbmZpZ1tdKSB7XHJcbiAgICBpZiAoY29uZmlnTGlzdCAmJiBjb25maWdMaXN0Lmxlbmd0aCkge1xyXG4gICAgICBjb25zdCBhdHRhY2htZW50ID0gY29uZmlnTGlzdC5maW5kKGEgPT4gYS5jb25maWdDb2RlID09IENvbmZpZ0NvZGUuSWZfU2hvd19BdHRhY2htZW50KTtcclxuICAgICAgY29uc3Qgc2lnbiA9IGNvbmZpZ0xpc3QuZmluZChhID0+IGEuY29uZmlnQ29kZSA9PSBDb25maWdDb2RlLklmX1Nob3dfU2lnbmF0dXJlKTtcclxuICAgICAgY29uc3QgZW5hYmxlU2lnbiA9IGNvbmZpZ0xpc3QuZmluZChhID0+IGEuY29uZmlnQ29kZSA9PSBDb25maWdDb2RlLklmX1VzZV9TaWduX0J5X0RlZmF1bHQpO1xyXG4gICAgICBjb25zdCBlZGl0U2lnbiA9IGNvbmZpZ0xpc3QuZmluZChhID0+IGEuY29uZmlnQ29kZSA9PT0gQ29uZmlnQ29kZS5JZl9DYW5fRWRpdF9TaWduYXR1cmUpO1xyXG4gICAgICBhdHRhY2htZW50ICYmIGF0dGFjaG1lbnQuY3VycmVudFZhbHVlID09PSAndHJ1ZScgJiYgKHRoaXMuaWZTaG93QXR0YWNobWVudCA9IHRydWUpO1xyXG4gICAgICBzaWduICYmIHNpZ24uY3VycmVudFZhbHVlID09PSAndHJ1ZScgJiYgKHRoaXMuaWZTaG93U2lnbiA9IHRydWUpO1xyXG4gICAgICBlbmFibGVTaWduICYmIGVuYWJsZVNpZ24uY3VycmVudFZhbHVlID09PSAnZmFsc2UnICYmICh0aGlzLmlmRW5hYmxlU2lnbiA9IGZhbHNlKTtcclxuICAgICAgZWRpdFNpZ24gJiYgZWRpdFNpZ24uY3VycmVudFZhbHVlID09PSAnZmFsc2UnICYmICh0aGlzLmlmQ2FuRWRpdFNpZ24gPSBmYWxzZSk7XHJcbiAgICAgIGlmICh0aGlzLmlmU2hvd1NpZ24gJiYgdGhpcy5pZkVuYWJsZVNpZ24pIHtcclxuICAgICAgICB0aGlzLmdldFVzZXJTaWduKHRoaXMuY3VyVXNlcklkKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgQE91dHB1dCgpIGF0dGFjaG1lbnQgPSBuZXcgRXZlbnRFbWl0dGVyKCk7Ly/pmYTku7ZcclxuICBAT3V0cHV0KCkgc2lnbmF0dXJlID0gbmV3IEV2ZW50RW1pdHRlcigpOy8v5LiK5Lyg562+5ZCN5LmL5ZCO77yM5Y+R6YCB562+5ZCNaWRcclxuICBAVmlld0NoaWxkKCdjb21tZW50RGlhbG9nJykgY29tbWVudERpYWxvZzogRGlhbG9nQ29tcG9uZW50Oy8v5bi455So5oSP6KeB566h55CGXHJcbiAgQFZpZXdDaGlsZCgnc2lnbkRpYWxvZycpIHNpZ25EaWFsb2c6IERpYWxvZ0NvbXBvbmVudDsvL+aJi+WGmeetvuWQjeW8ueahhlxyXG4gIEBWaWV3Q2hpbGQoJ2Ryb3Bkb3duRWwnKSBkcm9wRG93bkVsOiBGRHJvcGRvd25EaXJlY3RpdmU7Ly/op6PlhrPpgInmi6nmhI/op4HlkI7vvIzkuIvmi4noj5zljZXml6Dms5XmlLbmipjnmoTpl67pophcclxuICBAVmlld0NoaWxkKCd3ZlNpZ25IZXJlJykgc2lnbmF0dXJlUGFkOiBTaWduSGVyZUNvbXBvbmVudDsvL+aJi+WGmeetvuWQjee7hOS7tlxyXG4gIEBWaWV3Q2hpbGQoJ2ZhcnJpc0F2YXRhcicpIGZhcnJpc0F2YXRhcjogQXZhdGFyQ29tcG9uZW50Oy8v5aS05YOP57uE5Lu277yM55So5L2c562+5ZCN5Zu+54mH5LiK5LygXHJcbiAgQFZpZXdDaGlsZCgnY29tbWVudE1hbmFnZUNvbXAnKSBjb21tZW50TWFuYWdlQ29tcDogQ29tbWVudE1hbmFnZUNvbXBvbmVudDsvL+aEj+ingee7tOaKpOe7hOS7tlxyXG5cclxuXHJcbiAgcHJpdmF0ZSBfdmFsdWUgPSAnJztcclxuICBhdHRhY2htZW50TGlzdDogYW55W10gPSBbXTtcclxuICBpZlNob3dBdHRhY2htZW50OiBib29sZWFuID0gZmFsc2U7Ly/ku7vliqHkuK3lv4PphY3nva7vvIzmmK/lkKbmmL7npLrpmYTku7bkuIrkvKBcclxuICBpZlNob3dTaWduOiBib29sZWFuID0gZmFsc2U7Ly/ku7vliqHkuK3lv4PphY3nva7vvIzmmK/lkKbmmL7npLrmiYvlhpnnrb7lkI1cclxuICBzaWduYXR1cmVJbWFnZTogc3RyaW5nOy8v562+5ZCN5Zu+54mH55qEYmFzZTY05YC8XHJcbiAgdG1wU2lnbmF0dXJlSW1hZ2U6IHN0cmluZzsvL+S4tOaXtuS/neWtmOS4iuS8oOeahOWbvueJh1xyXG4gIGRvd25sb2FkU2VydmljZSA9IG5ldyBEb3dubG9hZFNlcnZpY2UoKTtcclxuICBpZlVzZVNpZ246IGJvb2xlYW4gPSBmYWxzZTsvL+aYr+WQpuS9v+eUqOaJi+WGmVxyXG4gIGlmVXNlSW1nOiBib29sZWFuID0gdHJ1ZTsvL+aYr+WQpuS9v+eUqOS4iuS8oOWbvueJh1xyXG4gIGlmRW5hYmxlU2lnbjogYm9vbGVhbiA9IHRydWU7Ly/mmK/lkKbpu5jorqTlkK/nlKjnrb7lkI1cclxuICBpZlVwbG9hZEltZzogYm9vbGVhbiA9IGZhbHNlOy8v5piv5ZCm5LiK5Lyg6L+H5Zu+54mHXHJcbiAgaWZDYW5FZGl0U2lnbjogYm9vbGVhbiA9IHRydWU7Ly/mmK/lkKblhYHorrjnvJbovpHnrb7lkI1cclxuICBvcmlnaW5TaWduSWQ6IHN0cmluZzsvL+WOn+Wni+eahOetvuWQjWlkXHJcbiAgaXNTaG93Q29tbW9uVGlwczogYm9vbGVhbiA9IGZhbHNlOy8v5piv5ZCm5bGV56S65o+Q56S6XHJcbiAgY29tbWVudExpc3Q6IENvbW1vbkNvbW1lbnRbXSA9IFtdO1xyXG5cclxuXHJcbiAgYnRuSG92ZXIgPSB7Ly/mjInpkq5ob3Zlcuagt+W8j+WPmOWMllxyXG4gICAgY29tbWVudEhvdmVyOiBmYWxzZSxcclxuICAgIGF0dGFjaG1lbnRIb3ZlcjogZmFsc2UsXHJcbiAgICBzaWduSG92ZXI6IGZhbHNlXHJcbiAgfVxyXG5cclxuICBzZXQgdmFsdWUodikge1xyXG4gICAgaWYgKHRoaXMuX3ZhbHVlICE9PSB2KSB7XHJcbiAgICAgIHRoaXMuX3ZhbHVlID0gdjtcclxuICAgICAgdGhpcy5vbk1vZGVsQ2hhbmdlKHYpO1xyXG4gICAgfVxyXG5cclxuICB9XHJcbiAgZ2V0IHZhbHVlKCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX3ZhbHVlO1xyXG4gIH1cclxuXHJcbiAgb25Nb2RlbENoYW5nZSA9IChvYmo6IGFueSkgPT4geyB9O1xyXG4gIG9uTW9kZWxUb3VjaGVkID0gKG9iajogYW55KSA9PiB7IH07XHJcblxyXG4gIGNvbnN0cnVjdG9yKFxyXG4gICAgcHJpdmF0ZSB0YXNrU2VydmljZTogVGFza1NlcnZpY2UsXHJcbiAgICBwcml2YXRlIHVwbG9hZERpYWxvZzogVXBsb2FkRGlhbG9nU2VydmljZSxcclxuICAgIHByaXZhdGUgbWVzc2FnZVNlcnZpY2U6IE1lc3NhZ2VyU2VydmljZSxcclxuICAgIHByaXZhdGUgbG9hZGluZ1NlcnZpY2U6IExvYWRpbmdTZXJ2aWNlLFxyXG4gICkge1xyXG5cclxuICB9XHJcblxyXG4gIG5nT25Jbml0KCkge1xyXG4gICAgdGhpcy5jb21tZW50TWFuYWdlQ29tcC5nZXRDb25maXJtU1ViamVjdCgpLnN1YnNjcmliZShyZSA9PiB7XHJcbiAgICAgIHRoaXMuY29tbWVudERpYWxvZyAmJiB0aGlzLmNvbW1lbnREaWFsb2cuY2xvc2UoKTtcclxuICAgIH0pXHJcbiAgICB0aGlzLmNvbW1lbnRNYW5hZ2VDb21wLmdldENhbmNlbFN1YmplY3QoKS5zdWJzY3JpYmUoKCkgPT4ge1xyXG4gICAgICB0aGlzLmNvbW1lbnREaWFsb2cgJiYgdGhpcy5jb21tZW50RGlhbG9nLmNsb3NlKCk7XHJcbiAgICB9KVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog5by55Ye65bi455So5oSP6KeB566h55CG5qGGXHJcbiAgICovXHJcbiAgc2hvd0NvbW1lbnREaWFsb2coKSB7XHJcbiAgICB0aGlzLmRyb3BEb3duRWwgJiYgdGhpcy5kcm9wRG93bkVsLmNsb3NlKCk7XHJcbiAgICB0aGlzLmNvbW1lbnREaWFsb2cuc2hvdygpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog54K55Ye75bi455So5oSP6KeB77yM6I635Y+W55So5oi35bi455So5oSP6KeB5YiX6KGoXHJcbiAgICovXHJcbiAgbG9hZENvbW1lbnRzKCkge1xyXG4gICAgdGhpcy50YXNrU2VydmljZS5nZXRDb21tZW50TGlzdCgpLnN1YnNjcmliZSgoZGF0YTogYW55W10pID0+IHtcclxuICAgICAgdGhpcy5jb21tZW50TGlzdCA9IGRhdGE7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIENvbnRyb2xWYWx1ZUFjY2Vzc29y5b+F6aG75a6e546w55qE5pa55rOVXHJcbiAgICovXHJcbiAgd3JpdGVWYWx1ZSh2YWx1ZTogc3RyaW5nKSB7XHJcbiAgICBpZiAodmFsdWUgIT09IHRoaXMudmFsdWUpIHtcclxuICAgICAgdGhpcy52YWx1ZSA9IHZhbHVlO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcmVnaXN0ZXJPbkNoYW5nZShmbikge1xyXG4gICAgdGhpcy5vbk1vZGVsQ2hhbmdlID0gZm47XHJcbiAgfVxyXG5cclxuICByZWdpc3Rlck9uVG91Y2hlZChmbikge1xyXG4gICAgdGhpcy5vbk1vZGVsVG91Y2hlZCA9IGZuO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog6YCJ5oup5LiA5p2h5bi455So5oSP6KeB5ZCO5LqL5Lu2XHJcbiAgICovXHJcbiAgYnV0dG9uQ2xpY2soZGF0YTogYW55KSB7XHJcbiAgICB0aGlzLmRyb3BEb3duRWwuY2xvc2UoKTtcclxuICAgIHRoaXMudmFsdWUgPSB0aGlzLnZhbHVlID09IHRoaXMuZGVmYXVsdENvbW1lbnQgPyBkYXRhIDogdGhpcy52YWx1ZSArIGRhdGE7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDkuIrkvKDpmYTku7ZcclxuICAgKi9cclxuICB1cGxvYWRBdHRhY2htZW50KCkge1xyXG4gICAgbGV0IGlzUmVwZWF0ID0gZmFsc2U7XHJcbiAgICB0aGlzLnVwbG9hZERpYWxvZy51cGxvYWRGaWxlKHRoaXMucHJvY2Vzc0luc3RhbmNlSWQgPyB0aGlzLnByb2Nlc3NJbnN0YW5jZUlkIDogJ2dzcHdmdGFza2F0dGFjaG1lbnQnLCAnd2ZfYXR0YWNobWVudCcpLnRoZW4ocmUgPT4ge1xyXG4gICAgICBmb3IgKGxldCBpIG9mIChyZSBhcyBhbnlbXSkpIHtcclxuICAgICAgICBpc1JlcGVhdCA9IGZhbHNlO1xyXG4gICAgICAgIGZvciAobGV0IGF0dGFjaCBvZiB0aGlzLmF0dGFjaG1lbnRMaXN0KSB7XHJcbiAgICAgICAgICBpZiAoYXR0YWNoLmZpbGVOYW1lID09PSBpLmZpbGVOYW1lKSB7XHJcbiAgICAgICAgICAgIHRoaXMubWVzc2FnZVNlcnZpY2UuaW5mbygn5YyF5ZCr6YeN5aSN5paH5Lu2JyArIGkuZmlsZU5hbWUpO1xyXG4gICAgICAgICAgICBpc1JlcGVhdCA9IHRydWU7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoIWlzUmVwZWF0KSB7XHJcbiAgICAgICAgICB0aGlzLmF0dGFjaG1lbnRMaXN0LnB1c2goaSk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIHRoaXMuYXR0YWNobWVudC5lbWl0KHRoaXMuYXR0YWNobWVudExpc3QpO1xyXG4gICAgICAvL+aJp+ihjOS4iuS8oOmZhOS7tlxyXG4gICAgICBsZXQgZmlsZXMgPSBuZXcgRmlsZVVwbG9hZEVudGl0eSgpO1xyXG4gICAgICBmaWxlcy5yb290SWQgPSBcIndmX2F0dGFjaG1lbnRcIjtcclxuICAgICAgZmlsZXMubWV0YWRhdGFJZExpc3QgPSBbXTtcclxuICAgICAgdGhpcy5hdHRhY2htZW50TGlzdC5mb3JFYWNoKGEgPT4ge1xyXG4gICAgICAgIGZpbGVzLm1ldGFkYXRhSWRMaXN0LnB1c2goYS5tZXRhZGF0YUlkKTtcclxuICAgICAgfSlcclxuICAgICAgZmlsZXMubWV0YWRhdGFJZExpc3QubGVuZ3RoICYmIHRoaXMudGFza1NlcnZpY2UudXBsb2FkQXR0YWNobWVudChmaWxlcykuc3Vic2NyaWJlKCgpID0+IHsgfSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOWIoOmZpOmZhOS7tlxyXG4gICAqL1xyXG4gIGF0dGFjaG1lbnREZWxldGUoYXR0YWNobWVudCkge1xyXG4gICAgdmFyIGdzcERvY0RlbGV0ZUVudGl0eTogRmlsZURlbGV0ZUVudGl0eSA9IHtcclxuICAgICAgcm9vdElkOiBcIndmX2F0dGFjaG1lbnRcIixcclxuICAgICAgbWV0YWRhdGFJZDogYXR0YWNobWVudC5tZXRhZGF0YUlkLFxyXG4gICAgICBtb2RlOiBcIkZvcm1hbFwiXHJcbiAgICB9XHJcbiAgICBsZXQgaW5kZXggPSB0aGlzLmF0dGFjaG1lbnRMaXN0LmluZGV4T2YoYXR0YWNobWVudCk7XHJcbiAgICBpZiAoaW5kZXggPiAtMSkge1xyXG4gICAgICB0aGlzLmF0dGFjaG1lbnRMaXN0LnNwbGljZShpbmRleCwgMSk7XHJcbiAgICB9XHJcbiAgICB0aGlzLmF0dGFjaG1lbnQuZW1pdCh0aGlzLmF0dGFjaG1lbnRMaXN0KTtcclxuICAgIHRoaXMudGFza1NlcnZpY2UuZGVsZXRlQXR0YWNobWVudChnc3BEb2NEZWxldGVFbnRpdHkpLnN1YnNjcmliZSgoKSA9PiB7IH0pO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgKiB3ZWLnq6/miZPlvIDpmYTku7bpooTop4hcclxuICAqL1xyXG4gIGF0dGFjaG1lbnRQcmV2aWV3KG1ldGFkYXRhSWQpIHtcclxuICAgIGNvbnN0IG9wdGlvbnMgPSB7XHJcbiAgICAgIGFwcFR5cGU6IFwiYXBwXCIsXHJcbiAgICAgIGZ1bmNJZDogXCJcIixcclxuICAgICAgdGFiTmFtZTogXCLmlofmoaPlnKjnur/pooTop4hcIixcclxuICAgICAgYXBwSWQ6IFwiNmNjYjQ3NmItZjJiYS1kZjhmLTZmNDctZDM3ZDEwMGM1NmUyXCIsXHJcbiAgICAgIGFwcEVudHJhbmNlOiBcImRvY3ZpZXdlcnRhYlwiLFxyXG4gICAgICB0YWJJZDogbmV3IERhdGUoKS5nZXRUaW1lKCksXHJcbiAgICAgIGVudGl0eVBhcmFtczoge1xyXG4gICAgICAgIG1ldGFkYXRhSWRMaXN0OiBbbWV0YWRhdGFJZF0sXHJcbiAgICAgICAgcm9vdElkOiBcIndmX2F0dGFjaG1lbnRcIixcclxuICAgICAgICBtZXRhZGF0YUlkOiBudWxsLFxyXG4gICAgICAgIHZpZXdPcHRpb25zOiB7XHJcbiAgICAgICAgICBzaG93SGVhZGVyOiB0cnVlLFxyXG4gICAgICAgICAgc2hvd1BhZ2luZzogdHJ1ZSxcclxuICAgICAgICAgIHNob3dUaHVtYm5haWxzOiB0cnVlLFxyXG4gICAgICAgICAgc2hvd0Rvd25sb2FkOiB0cnVlLFxyXG4gICAgICAgICAgc2hvd1NlYXJjaDogdHJ1ZSxcclxuICAgICAgICAgIHNob3dab29tOiB0cnVlLFxyXG4gICAgICAgICAgc2hvd1ByaW50OiB0cnVlLFxyXG4gICAgICAgICAgc2hvd1NlY29uZGFyeVRvb2xCYXI6IHRydWUsXHJcbiAgICAgICAgfSxcclxuICAgICAgfSxcclxuICAgIH07XHJcbiAgICAod2luZG93IGFzIGFueSkuZ3NwZnJhbWV3b3JrU2VydmljZS5ydGYuZnVuYy5vcGVuTWVudShvcHRpb25zKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOiOt+WPluS4jeWQjOagvOW8j+mZhOS7tueahOe8qeeVpeWbvlxyXG4gICAqL1xyXG4gIGltYWdlVXJsKGF0dGFjaG1lbnRJbmZvKSB7XHJcbiAgICBjb25zdCB1cmwgPSAnL3BsYXRmb3JtL3J1bnRpbWUvd2Yvd2ViYXBwL21vYmlsZXRhc2tjZW50ZXIvYXNzZXRzL2FjY2Vzc29yeS8nO1xyXG4gICAgcmV0dXJuIHVybCArIHRoaXMudGFza1NlcnZpY2UuY3JlYXRlSXRlbShhdHRhY2htZW50SW5mbykgKyAnLnN2Zz92PTIwMjIwMzAzJztcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOWxleekuuaJi+WGmeetvuWQjWRpYWxvZ1xyXG4gICAqL1xyXG4gIHNob3dTaWduRGlhbG9nKCkge1xyXG4gICAgdGhpcy5zaWduRGlhbG9nLnNob3coKTtcclxuICAgIGlmICghdGhpcy5pZkVuYWJsZVNpZ24pIHtcclxuICAgICAgdGhpcy5nZXRVc2VyU2lnbih0aGlzLmN1clVzZXJJZCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDngrnlh7vliKDpmaTnrb7lkI1cclxuICAgKi9cclxuICBjbGlja1RvRGVsZXRlSW1hZ2UoKSB7XHJcbiAgICB0aGlzLnNpZ25hdHVyZUltYWdlID0gJyc7XHJcbiAgICB0aGlzLnNpZ25hdHVyZS5lbWl0KG51bGwpO1xyXG4gICAgY29uc3QgbG9hZCA9IHRoaXMubG9hZGluZ1NlcnZpY2Uuc2hvdygpO1xyXG4gICAgdGhpcy50YXNrU2VydmljZS5hZGRVc2VyQ29uZmlnKENvbmZpZ0NvZGUuSWZfVXNlX1NpZ25fQnlfRGVmYXVsdCwgJ2ZhbHNlJykuc3Vic2NyaWJlKHJlID0+IHtcclxuICAgICAgbG9hZC5jbG9zZSgpO1xyXG4gICAgfSwgKCkgPT4ge1xyXG4gICAgICBsb2FkLmNsb3NlKCk7XHJcbiAgICB9KVxyXG4gIH1cclxuXHJcbiAgY2xpY2tUb1VzZVNpZ24oKSB7XHJcbiAgICB0aGlzLmlmVXNlSW1nID0gZmFsc2U7XHJcbiAgICB0aGlzLmlmVXNlU2lnbiA9IHRydWU7XHJcbiAgICBjb25zdCBjYW52YXM6IGFueSA9IHRoaXMuc2lnbmF0dXJlUGFkLmNhbnZhc0Rpdi5uYXRpdmVFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ2NhbnZhcycpO1xyXG4gICAgY2FudmFzLmhlaWdodCA9IDI1MjtcclxuICAgIGNhbnZhcy53aWR0aCA9IDY2NTtcclxuICB9XHJcblxyXG4gIGNsaWNrVG9VcGxvYWRJbWcoKSB7XHJcbiAgICB0aGlzLmZhcnJpc0F2YXRhci5vbkNsaWNrKCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDmiYvlhpnnrb7lkI3ngrnnoa7lrppcclxuICAgKi9cclxuICBjbGlja1RvQ29uZmlybSgpIHtcclxuICAgIGxldCBpbWFnZTogYW55O1xyXG4gICAgaWYgKHRoaXMuc2lnbmF0dXJlUGFkICYmIHRoaXMuc2lnbmF0dXJlUGFkLmlzRHJhdykgey8v5aaC5p6c562+6L+H5ZCNXHJcbiAgICAgIGltYWdlID0gdGhpcy5zaWduYXR1cmVQYWQuY29uZmlybSgpO1xyXG4gICAgfSBlbHNlIGlmICh0aGlzLmlmVXBsb2FkSW1nKSB7Ly/lpoLmnpzkuIrkvKDov4flm77niYdcclxuICAgICAgaW1hZ2UgPSB0aGlzLnRtcFNpZ25hdHVyZUltYWdlO1xyXG4gICAgfVxyXG4gICAgaWYgKGltYWdlKSB7XHJcbiAgICAgIHRoaXMudXBsb2FkU2lnbmF0dXJlSW1nKGltYWdlKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuc2lnbmF0dXJlSW1hZ2UgPSB0aGlzLnRtcFNpZ25hdHVyZUltYWdlO1xyXG4gICAgICB0aGlzLnNpZ25hdHVyZS5lbWl0KHRoaXMub3JpZ2luU2lnbklkKTtcclxuICAgICAgdGhpcy5zaWduRGlhbG9nLmNsb3NlKCk7XHJcbiAgICB9XHJcbiAgICAvL+a3u+WKoOWQr+eUqOetvuWQjemFjee9rlxyXG4gICAgY29uc3QgbG9hZCA9IHRoaXMubG9hZGluZ1NlcnZpY2Uuc2hvdygpO1xyXG4gICAgdGhpcy50YXNrU2VydmljZS5hZGRVc2VyQ29uZmlnKENvbmZpZ0NvZGUuSWZfVXNlX1NpZ25fQnlfRGVmYXVsdCwgJ3RydWUnKS5zdWJzY3JpYmUocmUgPT4ge1xyXG4gICAgICBsb2FkLmNsb3NlKCk7XHJcbiAgICB9LCAoKSA9PiB7XHJcbiAgICAgIGxvYWQuY2xvc2UoKTtcclxuICAgIH0pXHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDngrnlh7vmuIXnqbpcclxuICAgKi9cclxuICBjbGlja1RvUmVzZXQoKSB7XHJcbiAgICB0aGlzLmlmVXNlU2lnbiA9IGZhbHNlO1xyXG4gICAgdGhpcy5pZlVzZUltZyA9IHRydWU7XHJcbiAgICB0aGlzLnNpZ25hdHVyZUltYWdlID0gJyc7XHJcbiAgICB0aGlzLnRtcFNpZ25hdHVyZUltYWdlID0gJyc7XHJcbiAgICB0aGlzLnNpZ25hdHVyZS5lbWl0KCcnKTtcclxuICAgIHRoaXMuc2lnbmF0dXJlUGFkICYmICh0aGlzLnNpZ25hdHVyZVBhZC5pc0RyYXcgPSBmYWxzZSk7XHJcbiAgICB0aGlzLmlmVXBsb2FkSW1nID0gZmFsc2U7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDngrnlh7vlj5bmtohcclxuICAgKi9cclxuICBjbGlja1RvQ2FuY2VsKCkge1xyXG4gICAgdGhpcy5zaWduRGlhbG9nLmNsb3NlKCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDkuIrkvKDlm77niYflkI7kuovku7ZcclxuICAgKiBldmVudC5iYXNlNjQg5piv5Zu+54mH5L+h5oGvLGV2ZW50Lm5hbWXmmK/luKblkI7nvIDnmoTlm77niYflkI3vvIxldmVudC50eXBl5aaCaW1hZ2UvanBlZ1xyXG4gICAqL1xyXG4gIGltZ0NoYW5nZShldmVudDogYW55KSB7XHJcbiAgICB0aGlzLmlmVXNlSW1nID0gdHJ1ZTtcclxuICAgIHRoaXMuaWZVc2VTaWduID0gZmFsc2U7XHJcbiAgICB0aGlzLmlmVXBsb2FkSW1nID0gdHJ1ZTtcclxuICAgIGNvbnN0IGltYWdlID0gZXZlbnQuYmFzZTY0O1xyXG4gICAgdGhpcy50bXBTaWduYXR1cmVJbWFnZSA9IGltYWdlO1xyXG4gICAgdGhpcy5zaWduYXR1cmVJbWFnZSA9IGltYWdlO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog5LiK5Lyg562+5ZCNXHJcbiAgICogQHBhcmFtIGltYWdlIFxyXG4gICAqL1xyXG4gIHByaXZhdGUgdXBsb2FkU2lnbmF0dXJlSW1nKGltYWdlOiBhbnkpIHtcclxuICAgIHZhciB1cGxvYWRTaWduYXR1cmUgPSBuZXcgR3NwRG9jVXBsb2FkRW50aXR5KCk7XHJcbiAgICB1cGxvYWRTaWduYXR1cmUuZmlsZUNvbnRlbnQgPSBpbWFnZS5zcGxpdCgnLCcpWzFdO1xyXG4gICAgdXBsb2FkU2lnbmF0dXJlLmZpbGVQYXRoID0gdGhpcy5jdXJVc2VySWQ7XHJcbiAgICB1cGxvYWRTaWduYXR1cmUubW9kZSA9IFwiRm9ybWFsXCI7XHJcbiAgICB1cGxvYWRTaWduYXR1cmUubWV0YWRhdGEgPSBuZXcgR3NwRG9jTWV0YWRhdGEoKTtcclxuICAgIHVwbG9hZFNpZ25hdHVyZS5tZXRhZGF0YS5pZCA9IHRoaXMudGFza1NlcnZpY2UuY3JlYXRlTk0oKTtcclxuICAgIHVwbG9hZFNpZ25hdHVyZS5tZXRhZGF0YS5maWxlTmFtZSA9IHRoaXMudGFza1NlcnZpY2UuY3JlYXRlTk0oKSArIFwiLnBuZ1wiO1xyXG4gICAgdXBsb2FkU2lnbmF0dXJlLm1ldGFkYXRhLnJvb3RJZCA9IFwidGFza2NlbnRlcnNpZ25hdHVyZVwiO1xyXG4gICAgdXBsb2FkU2lnbmF0dXJlLm1ldGFkYXRhLmRvY1R5cGUgPSBcInBuZ1wiO1xyXG4gICAgY29uc3QgbG9hZCA9IHRoaXMubG9hZGluZ1NlcnZpY2Uuc2hvdygpO1xyXG4gICAgdGhpcy50YXNrU2VydmljZS51cGxvYWRTaWduYXR1cmUodXBsb2FkU2lnbmF0dXJlKS5zdWJzY3JpYmUoc2lnbklkID0+IHtcclxuICAgICAgbG9hZC5jbG9zZSgpO1xyXG4gICAgICB0aGlzLm9yaWdpblNpZ25JZCA9IHNpZ25JZDtcclxuICAgICAgdGhpcy5zaWduYXR1cmUuZW1pdChzaWduSWQpO1xyXG4gICAgICB0aGlzLnNpZ25hdHVyZUltYWdlID0gaW1hZ2U7XHJcbiAgICAgIHRoaXMuc2lnbkRpYWxvZy5jbG9zZSgpO1xyXG4gICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnZ3NwV2ZUYXNrVXNlclNpZ24nICsgdGhpcy5jdXJVc2VySWQgKyB0aGlzLnRhc2tTZXJ2aWNlLmdldEN1cnJlbnREYXRlU3RyaW5nKCksIHNpZ25JZCk7XHJcbiAgICB9LCBlcnJvciA9PiB7XHJcbiAgICAgIGxvYWQuY2xvc2UoKTtcclxuICAgICAgdGhpcy5tZXNzYWdlU2VydmljZS5lcnJvcign5LiK5Lyg562+5ZCN5aSx6LSlJyk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOiOt+WPlueUqOaIt+eahOacgOi/keS4gOasoeetvuWQjVxyXG4gICAqL1xyXG4gIHByaXZhdGUgZ2V0VXNlclNpZ24odXNlcklkOiBzdHJpbmcpIHtcclxuICAgIGNvbnN0IGxvYWQgPSB0aGlzLmxvYWRpbmdTZXJ2aWNlLnNob3coKTtcclxuICAgIHRoaXMudGFza1NlcnZpY2UuZ2V0VXNlclNpZ25JZCh1c2VySWQpLnN1YnNjcmliZShzaWduSWQgPT4ge1xyXG4gICAgICBsb2FkLmNsb3NlKCk7XHJcbiAgICAgIGlmIChzaWduSWQpIHtcclxuICAgICAgICB0aGlzLnNpZ25hdHVyZS5lbWl0KHNpZ25JZCk7XHJcbiAgICAgICAgdGhpcy5vcmlnaW5TaWduSWQgPSBzaWduSWQ7XHJcbiAgICAgICAgdGhpcy5zaWduYXR1cmVJbWFnZSA9IHRoaXMuZG93bmxvYWRTZXJ2aWNlLmdldERvd25sb2FkVXJsKHNpZ25JZCwgJ3Rhc2tjZW50ZXJzaWduYXR1cmUnKTtcclxuICAgICAgICB0aGlzLnRtcFNpZ25hdHVyZUltYWdlID0gdGhpcy5zaWduYXR1cmVJbWFnZTtcclxuICAgICAgfVxyXG4gICAgfSwgZXJyb3IgPT4ge1xyXG4gICAgICBjb25zb2xlLmVycm9yKGVycm9yKTtcclxuICAgICAgbG9hZC5jbG9zZSgpO1xyXG4gICAgfSlcclxuICB9XHJcblxyXG4gIC8v5paH5pys5qGG5YC85Y+Y5Yqo55uR5ZCs5LqL5Lu2XHJcbiAgdmFsdWVDaGFuZ2UoZSkge1xyXG4gICAgaWYgKHRoaXMudGFza1NlcnZpY2UuZ2V0Qnl0ZXNMZW5ndGgodGhpcy52YWx1ZSkgPiA0MDAwKSB7XHJcbiAgICAgIHRoaXMuaXNTaG93Q29tbW9uVGlwcyA9IHRydWU7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLmlzU2hvd0NvbW1vblRpcHMgPSBmYWxzZTtcclxuICAgIH07XHJcbiAgfVxyXG5cclxuXHJcbn1cclxuIl19