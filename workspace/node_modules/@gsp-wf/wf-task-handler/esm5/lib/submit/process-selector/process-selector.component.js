/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, ViewChild, TemplateRef, Input, Injector } from '@angular/core';
import { TaskService } from '../../service/task.service';
import { StartProcessPayload, FlowNodeInfo } from '../../entity/start-process-payload';
import { LoadingService } from '@farris/ui-loading';
import { Subject } from 'rxjs';
import { NotifyService } from '@farris/ui-notify';
import { I18nService } from '../../service/i18n/i18n.service';
import { ComboListComponent } from '@farris/ui-combo-list';
import { MessageType } from '../../entity/postMessage';
import { MessagerService } from '@farris/ui-messager';
import { WfTaskHandlerService } from '../../wf-task-handler.service';
import { ConfigCode } from '../../entity/task-center-config';
import { WfContext } from '../../entity/wfContext';
import { TaskEntity } from '../../entity/task-entity';
import { TaskAction } from '../../entity/task-action';
import { SelectedProcessItem, StartProcessCache } from '../../entity/process-cache';
var ProcessSelectorComponent = /** @class */ (function () {
    // task center-ui中start-process-menu使用了此选择器，构造方法改动时，需重新编译
    function ProcessSelectorComponent(taskService, loadingService, notify, i18nService, messager, injector, handlerService) {
        this.taskService = taskService;
        this.loadingService = loadingService;
        this.notify = notify;
        this.i18nService = i18nService;
        this.messager = messager;
        this.injector = injector;
        this.handlerService = handlerService;
        this.destProcesses = []; //候选流程
        //候选流程
        this.destNodes = []; //候选下一环节
        //保存模拟流程后返回的内容，选择节点时使用
        this.assignInfos = [{
                selectedAssignees: [],
                assigneeInfo: null,
                assignees: [],
                activityDefinitionName: '',
                activityDefinitionId: '',
                dependency: '',
                anonymous: false,
                anonymousText: null,
                resolved: false,
            }]; //节点返回的指派信息（多个）
        //节点返回的指派信息（多个）
        this.otherAssignInfos = []; //节点返回的指派信息（多个）
        //选择的下一环节ID，后续环节id的拼接
        this.payload = new StartProcessPayload; //保存表单上传来的payload
        //保存表单上传来的payload
        this.subject = new Subject(); //返回bool
        //返回bool
        this.subjectWithResponse = new Subject(); //返回流程上下文
        //返回流程上下文
        this.subjectCancel = new Subject(); //点击取消后的subject
        //点击取消后的subject
        this.submitDisable = false; //提交按钮是否禁用
        //提交按钮是否禁用
        this.showButtons = false;
        this.curLanguage = localStorage.getItem('languageCode') || 'zh-CHS'; //系统当前语言
        //选择流程的placeholder
        this.wfContext = new WfContext(); //工作流上下文
        //默认下一环节（提示用）
        this.dialogHeight = 240; //弹框基本高度
        //确认取消按钮
        this.openFromIframe = false; //是否从iframe打开，应用IDP提交审批集成
    }
    /**
     * @return {?}
     */
    ProcessSelectorComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
    };
    Object.defineProperty(ProcessSelectorComponent.prototype, "parameter", {
        set: 
        //是否从iframe打开，应用IDP提交审批集成
        /**
         * @param {?} parameter
         * @return {?}
         */
        function (parameter) {
            if (parameter) {
                this.showButtons = true;
                this.setParam(parameter);
            }
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @param {?} param
     * @return {?}
     */
    ProcessSelectorComponent.prototype.setParam = /**
     * @param {?} param
     * @return {?}
     */
    function (param) {
        /** @type {?} */
        var subject = new Subject();
        if (!param) {
            return;
        }
        this.payload.id = param.id;
        this.payload.processDefinitionId = param.processDefinitionId;
        this.payload.processDefinitionKey = param.processDefinitionKey;
        this.payload.bizDefKey = param.bizDefKey;
        this.payload.dataModelId = param.dataModelId;
        this.payload.dataId = param.dataId;
        this.payload.name = param.name;
        this.payload.startUserId = param.startUserId;
        this.payload.nextFlowNodes = [];
        this.payload.otherAssignNodes = [];
        this.wfContext.processCategoryId = param.bizDefKey;
        this.startProcessSimulate(this.payload, subject);
        return subject.asObservable();
    };
    /**
     * @param {?} payload
     * @param {?} subject
     * @return {?}
     */
    ProcessSelectorComponent.prototype.startProcessSimulate = /**
     * @param {?} payload
     * @param {?} subject
     * @return {?}
     */
    function (payload, subject) {
        var _this = this;
        /** @type {?} */
        var load = this.loadingService.show();
        this.taskService.startProcessSimulate(payload).subscribe((/**
         * @param {?} response
         * @return {?}
         */
        function (response) {
            load.close();
            _this.response = response;
            response.priorityInfo && response.priorityInfo.enable && (_this.dialogHeight += 40);
            _this.destProcesses = response.procDefs.map((/**
             * @param {?} process
             * @return {?}
             */
            function (process) { return ({ id: process.procDefId, name: process.procDefName + ("(v" + process.version + ".0)") }); })); //增加流程的版本信息
            if (_this.destProcesses.length === 1) { //只有一个候选流程时
                _this.selectedProcessId = _this.destProcesses[0].id;
                _this.setNextNode(response);
                _this.processDefaultValue = _this.destProcesses[0].name;
            }
            else { //多个流程时，取上一次选择的
                //多个流程时，取上一次选择的
                /** @type {?} */
                var selectedProcessId_1 = _this.getSelectedProcessCache(_this.payload.bizDefKey);
                if (selectedProcessId_1 && _this.destProcesses.findIndex((/**
                 * @param {?} p
                 * @return {?}
                 */
                function (p) { return p.id === selectedProcessId_1.processDefinitionId; })) > -1) {
                    _this.getDestNodes(selectedProcessId_1.processDefinitionId);
                    _this.processDefaultValue = selectedProcessId_1.processDefinitionName;
                }
                else {
                    _this.processPlaceholder = _this.i18nService.getValue('task.selectPlaceholder');
                }
                _this.dialogHeight = 330;
            }
            if (_this.assignInfos && _this.assignInfos.length) {
                _this.dialogHeight += (_this.assignInfos.length) * 40;
            }
            if (_this.otherAssignInfos && _this.otherAssignInfos.length) {
                _this.dialogHeight += (_this.otherAssignInfos.length + 1) * 40;
            }
            _this.dialogHeight = _this.dialogHeight > 440 ? 440 : _this.dialogHeight;
            subject.next({ result: true, dialogHeight: _this.dialogHeight });
        }), (/**
         * @param {?} error
         * @return {?}
         */
        function (error) {
            load.close();
            subject.error(error);
            _this.taskService.error(error);
        }));
    };
    /**
     * 选择某个流程后
     * @param data
     */
    /**
     * 选择某个流程后
     * @param {?} data
     * @return {?}
     */
    ProcessSelectorComponent.prototype.selectProcessChange = /**
     * 选择某个流程后
     * @param {?} data
     * @return {?}
     */
    function (data) {
        this.nodeCombo.onClear();
        this.getDestNodes(data.data.id);
    };
    /**
     * 根据选择的流程定义id获取下一环节信息
     * @param selectedProcessId
     */
    /**
     * 根据选择的流程定义id获取下一环节信息
     * @private
     * @param {?} selectedProcessId
     * @return {?}
     */
    ProcessSelectorComponent.prototype.getDestNodes = /**
     * 根据选择的流程定义id获取下一环节信息
     * @private
     * @param {?} selectedProcessId
     * @return {?}
     */
    function (selectedProcessId) {
        var _this = this;
        this.selectedProcessId = selectedProcessId;
        this.destNodes = [];
        this.nodePlaceholder = '';
        this.clearAssignInfos();
        /** @type {?} */
        var payload = new StartProcessPayload();
        payload.processDefinitionId = this.selectedProcessId;
        payload.dataId = this.payload.dataId;
        /** @type {?} */
        var load = this.loadingService.show();
        this.taskService.startProcessSimulate(payload).subscribe((/**
         * @param {?} response
         * @return {?}
         */
        function (response) {
            load.close();
            _this.response = response;
            _this.setNextNode(response);
        }), (/**
         * @param {?} error
         * @return {?}
         */
        function (error) {
            load.close();
            _this.taskService.error(error);
        }));
    };
    /**
     * 选择节点后事件
     */
    /**
     * 选择节点后事件
     * @param {?} data
     * @return {?}
     */
    ProcessSelectorComponent.prototype.selectNodeChange = /**
     * 选择节点后事件
     * @param {?} data
     * @return {?}
     */
    function (data) {
        var _this = this;
        this.clearAssignInfos();
        this.selectedNodeId = data.data.id;
        /** @type {?} */
        var nodeNames = data.data.name.split('，');
        if (this.response.simulationPaths[data.index].nodeInfoList.every((/**
         * @param {?} node
         * @return {?}
         */
        function (node) { return node.resolved === true; }))) { //已预解析参与者
            this.setAssignInfo(this.response.simulationPaths[data.index]);
            this.setOtherAssignInfo(this.response); //切换节点后，其他节点指派需要更新，重新去重
        }
        else { //未预解析参与者
            //未预解析参与者
            /** @type {?} */
            var payload_1 = new StartProcessPayload();
            payload_1.processDefinitionId = this.selectedProcessId;
            payload_1.dataId = this.payload.dataId;
            payload_1.nextFlowNodes = [];
            this.selectedNodeId.split('，').forEach((/**
             * @param {?} nodeId
             * @param {?} index
             * @return {?}
             */
            function (nodeId, index) {
                /** @type {?} */
                var nextFlowNode = new FlowNodeInfo();
                nextFlowNode.activityDefinitionId = nodeId;
                nextFlowNode.activityDefinitionName = nodeNames[index];
                payload_1.nextFlowNodes.push(nextFlowNode);
            }));
            /** @type {?} */
            var load_1 = this.loadingService.show();
            this.taskService.startProcessSimulate(payload_1).subscribe((/**
             * @param {?} response
             * @return {?}
             */
            function (response) {
                load_1.close();
                _this.setAssignInfo(response.simulationPaths[0]); //选择的下一环节应该在同一条路径上，故取simulationPaths[0]
                _this.setOtherAssignInfo(response); //切换节点后，其他节点指派需要更新，重新去重
            }), (/**
             * @param {?} error
             * @return {?}
             */
            function (error) {
                load_1.close();
                _this.taskService.error(error);
            }));
        }
    };
    /**
   * 实现真正的提交
   */
    /**
     * 实现真正的提交
     * @return {?}
     */
    ProcessSelectorComponent.prototype.startProcessSubmit = /**
     * 实现真正的提交
     * @return {?}
     */
    function () {
        var _this = this;
        if (!this.selectedProcessId) {
            this.openFromIframe ? this.messager.warning(this.i18nService.getValue('startProcess.selectProcess')) :
                this.notify.warning(this.i18nService.getValue('startProcess.selectProcess'));
            return;
        }
        if (!this.selectedNodeId) {
            this.openFromIframe ? this.messager.warning(this.i18nService.getValue('startProcess.selectNode')) :
                this.notify.warning(this.i18nService.getValue('startProcess.selectNode'));
            return;
        }
        if (this.assignInfos.filter((/**
         * @param {?} info
         * @return {?}
         */
        function (info) { return (info.assigneeInfo || info.selectedAssignees.length) && !info.assignees.length; })).length) { //空参与者策略时，不提示选人
            this.openFromIframe ? this.messager.warning(this.i18nService.getValue('task.selectProcessor')) :
                this.notify.warning(this.i18nService.getValue('task.selectProcessor'));
            return;
        }
        if (this.response.priorityInfo && this.response.priorityInfo.enable && !this.response.priorityInfo.priority) {
            this.openFromIframe ? this.messager.warning(this.i18nService.getValue('task.selectPriority')) :
                this.notify.warning(this.i18nService.getValue('task.selectPriority'));
            return;
        }
        /** @type {?} */
        var nodes = this.selectedNodeId.split('，');
        for (var i = 0; i < nodes.length; i++) {
            /** @type {?} */
            var nextFlowNode = {
                activityDefinitionId: nodes[i],
                activityDefinitionName: this.assignInfos[i].activityDefinitionName,
                dependency: this.assignInfos[i].dependency,
                selectedAssignees: this.assignInfos[i].assigneeInfo ? this.assignInfos[i].assignees : [],
                assigneeInfo: null,
                resolved: false,
                anonymous: false,
                anonymousText: ''
            }
            //节点找不到人，且异常提示，前端控制住，不允许走提交请求（构件事务问题）。并行场景下暂不处理
            ;
            //节点找不到人，且异常提示，前端控制住，不允许走提交请求（构件事务问题）。并行场景下暂不处理
            if (this.response && this.response.simulationPaths.length && !this.response.simulationPaths[0].id.startsWith('ParallelGateway')) {
                if (nodes.length == 1 && nodes[i].startsWith('UserActivity') && this.assignInfos[i].resolved && !this.assignInfos[i].assigneeInfo && !this.assignInfos[i].selectedAssignees.length) {
                    /** @type {?} */
                    var str = this.assignInfos[i].activityDefinitionName + this.i18nService.getValue('startProcess.node') + this.i18nService.getValue('startProcess.noUser');
                    this.openFromIframe ? this.messager.warning(str) : this.notify.warning(str);
                    return;
                }
            }
            this.payload.nextFlowNodes.push(nextFlowNode);
        }
        //拼接其他节点选人结果
        if (this.otherAssignInfos && this.otherAssignInfos.length) {
            for (var i = 0; i < this.otherAssignInfos.length; i++) {
                /** @type {?} */
                var nextFlowNode = {
                    activityDefinitionId: this.otherAssignInfos[i].activityDefinitionId,
                    activityDefinitionName: this.otherAssignInfos[i].activityDefinitionName,
                    dependency: this.otherAssignInfos[i].dependency,
                    selectedAssignees: this.otherAssignInfos[i].assigneeInfo ? this.otherAssignInfos[i].assignees : [],
                    assigneeInfo: null,
                    resolved: false,
                    anonymous: false,
                    anonymousText: ''
                };
                this.payload.otherAssignNodes.push(nextFlowNode);
            }
        }
        this.payload.processDefinitionId = this.selectedProcessId;
        this.submitDisable = true;
        //紧急程度
        if (this.response.priorityInfo && this.response.priorityInfo.enable) {
            this.payload.priority = this.response.priorityInfo.priority;
        }
        /** @type {?} */
        var load = this.loadingService.show();
        this.taskService.startProcess(this.payload).subscribe((/**
         * @param {?} response
         * @return {?}
         */
        function (response) {
            load.close();
            _this.submitDisable = false;
            _this.subject.next(true);
            _this.subjectWithResponse.next(response);
            /** @type {?} */
            var messageAfterSubmit = _this.i18nService.getValue('startProcess.submitSuccess');
            if (_this.openFromIframe) {
                ((/** @type {?} */ (window.parent))).gspWfService.eventHandler({ data: { type: MessageType.SubmitSuccess, message: messageAfterSubmit } });
            }
            else {
                _this.handlerService.handleSubmitMessage(ConfigCode.Info_After_Submit, _this.payload.bizDefKey);
            }
            if (!_this.openFromIframe && response.needInteraction) { //提交审批后需要指派场景
                _this.notify.info(_this.i18nService.getValue('cueWords.select')
                    + response.nextFlowNodes[0].activityDefinitionName
                    + _this.i18nService.getValue('cueWords.processor'));
                /** @type {?} */
                var task = new TaskEntity();
                /** @type {?} */
                var action = new TaskAction();
                task.sourceId = response.nextFlowNodes[0].assigneeInfo.workItemId;
                action.code = 'AssignUser';
                action.name = _this.i18nService.getValue('cueWords.assignUser');
                _this.handlerService.execute(task, action).subscribe((/**
                 * @param {?} re
                 * @return {?}
                 */
                function (re) { }));
            }
            _this.setSelectedProcessCache();
        }), (/**
         * @param {?} error
         * @return {?}
         */
        function (error) {
            load.close();
            _this.payload.nextFlowNodes = [];
            _this.submitDisable = false;
            _this.subject.next(false); //已经有人用了这个subject，提交失败的话返回false by fangpengfei@20210324
            _this.taskService.error(error);
        }));
    };
    /**
     * 选择流程清空
     */
    /**
     * 选择流程清空
     * @return {?}
     */
    ProcessSelectorComponent.prototype.selectProcessClear = /**
     * 选择流程清空
     * @return {?}
     */
    function () {
        this.selectedProcessId = '';
        this.destNodes = [];
        this.nodePlaceholder = '';
        this.selectedNodeId = '';
        this.clearAssignInfos();
        this.response = null;
    };
    /**
     * 选择节点清空
     */
    /**
     * 选择节点清空
     * @return {?}
     */
    ProcessSelectorComponent.prototype.selectNodeClear = /**
     * 选择节点清空
     * @return {?}
     */
    function () {
        this.selectedNodeId = '';
        this.clearAssignInfos();
    };
    /**
     * 用户帮助选人
     */
    /**
     * 用户帮助选人
     * @param {?} data
     * @param {?} index
     * @return {?}
     */
    ProcessSelectorComponent.prototype.afterConfirm = /**
     * 用户帮助选人
     * @param {?} data
     * @param {?} index
     * @return {?}
     */
    function (data, index) {
        this.assignInfos[index].assignees = data;
    };
    /**
     * 其他节点用户帮助选人
     * @param data
     * @param index
     */
    /**
     * 其他节点用户帮助选人
     * @param {?} data
     * @param {?} index
     * @return {?}
     */
    ProcessSelectorComponent.prototype.otherAssignInfosAfterConfirm = /**
     * 其他节点用户帮助选人
     * @param {?} data
     * @param {?} index
     * @return {?}
     */
    function (data, index) {
        this.otherAssignInfos[index].assignees = data;
    };
    /**
     * 弹框点击取消
     */
    /**
     * 弹框点击取消
     * @return {?}
     */
    ProcessSelectorComponent.prototype.cancel = /**
     * 弹框点击取消
     * @return {?}
     */
    function () {
        if (this.openFromIframe) {
            ((/** @type {?} */ (window.parent))).gspWfService.eventHandler({ data: { type: MessageType.Cancel, message: '' } });
        }
        else {
            this.subjectCancel.next(false);
        }
    };
    /**
     * 获取提交审批后返回值（bool型，兼容历史）
     */
    /**
     * 获取提交审批后返回值（bool型，兼容历史）
     * @return {?}
     */
    ProcessSelectorComponent.prototype.getSubject = /**
     * 获取提交审批后返回值（bool型，兼容历史）
     * @return {?}
     */
    function () {
        return this.subject.asObservable();
    };
    /**
     * 获取提交审批后返回值（实体型，带流程上下文）
     */
    /**
     * 获取提交审批后返回值（实体型，带流程上下文）
     * @return {?}
     */
    ProcessSelectorComponent.prototype.getSubjectWithResponse = /**
     * 获取提交审批后返回值（实体型，带流程上下文）
     * @return {?}
     */
    function () {
        return this.subjectWithResponse.asObservable();
    };
    /**
     * 点击取消后的subject，关闭窗口使用
     * @returns
     */
    /**
     * 点击取消后的subject，关闭窗口使用
     * @return {?}
     */
    ProcessSelectorComponent.prototype.getSubjectCancel = /**
     * 点击取消后的subject，关闭窗口使用
     * @return {?}
     */
    function () {
        return this.subjectCancel.asObservable();
    };
    /**
     * 设置下一环节
     */
    /**
     * 设置下一环节
     * @private
     * @param {?} response
     * @return {?}
     */
    ProcessSelectorComponent.prototype.setNextNode = /**
     * 设置下一环节
     * @private
     * @param {?} response
     * @return {?}
     */
    function (response) {
        this.destNodes = response.simulationPaths && response.simulationPaths.map((/**
         * @param {?} path
         * @return {?}
         */
        function (path) { return ({
            id: path.nodeInfoList.map((/**
             * @param {?} node
             * @return {?}
             */
            function (node) { return node.activityDefinitionId; })).join('，'),
            name: path.nodeInfoList.map((/**
             * @param {?} node
             * @return {?}
             */
            function (node) { return node.activityDefinitionName; })).join('，')
        }); }));
        //处理默认分支，无默认分支返回-1
        /** @type {?} */
        var defaultIndex = response.simulationPaths.findIndex((/**
         * @param {?} a
         * @return {?}
         */
        function (a) { return a.default; }));
        if (defaultIndex > -1) {
            this.selectedNodeId = this.destNodes[defaultIndex].id;
            this.nodeDefaultValue = this.destNodes[defaultIndex].name.indexOf('，') > -1 ? response.simulationPaths[defaultIndex].name : this.destNodes[defaultIndex].name;
            this.setAssignInfo(response.simulationPaths[defaultIndex]);
            this.setOtherAssignInfo(response);
        }
        else {
            this.nodePlaceholder = this.i18nService.getValue('task.selectPlaceholder');
        }
    };
    /**
     * 设置当前指派信息帮助参数
     */
    /**
     * 设置当前指派信息帮助参数
     * @private
     * @param {?} simulationPaths
     * @return {?}
     */
    ProcessSelectorComponent.prototype.setAssignInfo = /**
     * 设置当前指派信息帮助参数
     * @private
     * @param {?} simulationPaths
     * @return {?}
     */
    function (simulationPaths) {
        var _this = this;
        this.assignInfos = [];
        this.selectedNodeId.split('，').forEach((/**
         * @param {?} nodeId
         * @return {?}
         */
        function (nodeId) {
            /** @type {?} */
            var node = simulationPaths.nodeInfoList.find((/**
             * @param {?} node
             * @return {?}
             */
            function (node) { return node.activityDefinitionId === nodeId; }));
            if (node) {
                _this.assignInfos.push({
                    selectedAssignees: node.selectedAssignees,
                    assigneeInfo: node.assigneeInfo,
                    assignees: node.selectedAssignees.map((/**
                     * @param {?} user
                     * @return {?}
                     */
                    function (user) { return { id: user.id, name: user.name }; })),
                    activityDefinitionName: node.activityDefinitionName,
                    activityDefinitionId: node.activityDefinitionId,
                    dependency: node.dependency,
                    anonymous: node.anonymous,
                    anonymousText: node.anonymousText,
                    resolved: node.resolved
                });
            }
            else {
                _this.assignInfos.push({
                    selectedAssignees: [],
                    assigneeInfo: null,
                    assignees: [],
                    activityDefinitionName: '',
                    activityDefinitionId: '',
                    dependency: '',
                    anonymous: false,
                    anonymousText: '',
                    resolved: false,
                });
            }
        }));
    };
    /**
     * 设置其他节点指派
     * @param response
     */
    /**
     * 设置其他节点指派
     * @private
     * @param {?} response
     * @return {?}
     */
    ProcessSelectorComponent.prototype.setOtherAssignInfo = /**
     * 设置其他节点指派
     * @private
     * @param {?} response
     * @return {?}
     */
    function (response) {
        var _this = this;
        this.otherAssignInfos = [];
        /** @type {?} */
        var tmpOtherAssignInfos = [];
        /** @type {?} */
        var otherAssignNodes = response.otherAssignNodes;
        if (otherAssignNodes && otherAssignNodes.length) {
            otherAssignNodes.forEach((/**
             * @param {?} node
             * @return {?}
             */
            function (node) {
                tmpOtherAssignInfos.push({
                    selectedAssignees: node.selectedAssignees,
                    assigneeInfo: node.assigneeInfo,
                    assignees: node.selectedAssignees.map((/**
                     * @param {?} user
                     * @return {?}
                     */
                    function (user) { return { id: user.id, name: user.name }; })),
                    activityDefinitionName: node.activityDefinitionName,
                    activityDefinitionId: node.activityDefinitionId,
                    dependency: node.dependency,
                    anonymous: node.anonymous,
                    anonymousText: node.anonymousText,
                    resolved: node.resolved
                });
            }));
            //其他节点与下一节点去重
            if (this.assignInfos && this.assignInfos.length) {
                tmpOtherAssignInfos = tmpOtherAssignInfos.filter((/**
                 * @param {?} a
                 * @return {?}
                 */
                function (a) { return _this.assignInfos.findIndex((/**
                 * @param {?} b
                 * @return {?}
                 */
                function (b) { return b.activityDefinitionId == a.activityDefinitionId; })) < 0; }));
            }
            this.otherAssignInfos = tmpOtherAssignInfos;
        }
    };
    /**
     * 清空当前指派信息帮助参数
     */
    /**
     * 清空当前指派信息帮助参数
     * @private
     * @return {?}
     */
    ProcessSelectorComponent.prototype.clearAssignInfos = /**
     * 清空当前指派信息帮助参数
     * @private
     * @return {?}
     */
    function () {
        this.assignInfos = [{
                selectedAssignees: [],
                assigneeInfo: null,
                assignees: [],
                activityDefinitionName: '',
                activityDefinitionId: '',
                dependency: '',
                anonymous: false,
                anonymousText: '',
                resolved: false,
            }];
        this.otherAssignInfos = [];
    };
    /**
     * 获取浏览器缓存，上次流程选择的结果
     */
    /**
     * 获取浏览器缓存，上次流程选择的结果
     * @private
     * @param {?} processCategoryId
     * @return {?}
     */
    ProcessSelectorComponent.prototype.getSelectedProcessCache = /**
     * 获取浏览器缓存，上次流程选择的结果
     * @private
     * @param {?} processCategoryId
     * @return {?}
     */
    function (processCategoryId) {
        /** @type {?} */
        var browserCache = (/** @type {?} */ (JSON.parse(localStorage.getItem("gspWfStartProcess"))));
        if (browserCache && browserCache.selectedProcessList) {
            return browserCache.selectedProcessList.find((/**
             * @param {?} a
             * @return {?}
             */
            function (a) { return a.processCategory == processCategoryId; }));
        }
        return undefined;
    };
    /**
     * 浏览器缓存记下流程选择的结果
     */
    /**
     * 浏览器缓存记下流程选择的结果
     * @private
     * @return {?}
     */
    ProcessSelectorComponent.prototype.setSelectedProcessCache = /**
     * 浏览器缓存记下流程选择的结果
     * @private
     * @return {?}
     */
    function () {
        /** @type {?} */
        var processCategoryId = this.payload.bizDefKey;
        /** @type {?} */
        var processDefinitionId = this.payload.processDefinitionId;
        /** @type {?} */
        var process = this.destProcesses.find((/**
         * @param {?} a
         * @return {?}
         */
        function (a) { return a.id == processDefinitionId; }));
        /** @type {?} */
        var processDefinitionName = process && process.name;
        /** @type {?} */
        var browserCache = (/** @type {?} */ (JSON.parse(localStorage.getItem("gspWfStartProcess"))));
        if (browserCache && browserCache.selectedProcessList) {
            /** @type {?} */
            var selectedProcessList = browserCache.selectedProcessList;
            if (selectedProcessList.findIndex((/**
             * @param {?} a
             * @return {?}
             */
            function (a) { return a.processCategory == processCategoryId; })) > -1) {
                selectedProcessList.map((/**
                 * @param {?} item
                 * @return {?}
                 */
                function (item) {
                    if (item.processCategory == processCategoryId) {
                        item.processDefinitionId = processDefinitionId;
                        item.processDefinitionName = processDefinitionName;
                        item.logTime = new Date();
                    }
                }));
                browserCache.selectedProcessList = selectedProcessList;
                localStorage.setItem("gspWfStartProcess", JSON.stringify(browserCache));
            }
            else {
                /** @type {?} */
                var item = new SelectedProcessItem(processCategoryId, processDefinitionId, processDefinitionName);
                selectedProcessList.push(item);
                browserCache.selectedProcessList = selectedProcessList;
                localStorage.setItem("gspWfStartProcess", JSON.stringify(browserCache));
            }
        }
        else {
            /** @type {?} */
            var browserCache_1 = new StartProcessCache();
            /** @type {?} */
            var selectedProcessList = [];
            /** @type {?} */
            var item = new SelectedProcessItem(processCategoryId, processDefinitionId, processDefinitionName);
            selectedProcessList.push(item);
            browserCache_1.selectedProcessList = selectedProcessList;
            localStorage.setItem("gspWfStartProcess", JSON.stringify(browserCache_1));
        }
    };
    ProcessSelectorComponent.decorators = [
        { type: Component, args: [{
                    selector: 'lib-process-selector',
                    template: "<div>\r\n  <!-- \u5373\u5C06\u6D41\u5411 -->\r\n  <farris-section\r\n    [mainTitle]=\"'startProcess.processTowards' | translate\"\r\n    style=\"padding: 0 24px\"\r\n  >\r\n    <div class=\"wf-submit-section\">\r\n      <!-- \u9009\u62E9\u6D41\u7A0B\u5B9A\u4E49\uFF0C\u4E0B\u62C9 -->\r\n      <div class=\"wf-task-handler-help-div wf-submit-item\">\r\n        <div class=\"wf-task-handler-help-text wf-submit-item-label\">\r\n          {{ \"startProcess.procDef\" | translate }}\r\n        </div>\r\n        <div class=\"d-flex\" style=\"flex: 1\">\r\n          <farris-combo-list\r\n            style=\"flex: 1\"\r\n            [(ngModel)]=\"processDefaultValue\"\r\n            [data]=\"destProcesses\"\r\n            [editable]=\"false\"\r\n            [textField]=\"'name'\"\r\n            [valueField]=\"'id'\"\r\n            [idField]=\"'id'\"\r\n            [readonly]=\"destProcesses.length > 1 ? false : true\"\r\n            (selectChange)=\"selectProcessChange($event)\"\r\n            (clear)=\"selectProcessClear()\"\r\n            [placeholder]=\"processPlaceholder\"\r\n          >\r\n          </farris-combo-list>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- \u4E0B\u4E00\u8282\u70B9\uFF0C\u4E0B\u62C9 -->\r\n      <div class=\"wf-task-handler-help-div wf-submit-item\">\r\n        <div class=\"wf-task-handler-help-text wf-submit-item-label\">\r\n          {{ \"task.nextNodeText\" | translate }}\r\n        </div>\r\n        <div class=\"d-flex\" style=\"flex: 1\">\r\n          <farris-combo-list\r\n            style=\"flex: 1\"\r\n            #nodeCombo\r\n            [(ngModel)]=\"nodeDefaultValue\"\r\n            [data]=\"destNodes\"\r\n            [editable]=\"false\"\r\n            [textField]=\"'name'\"\r\n            [valueField]=\"'id'\"\r\n            [idField]=\"'id'\"\r\n            [readonly]=\"destNodes.length > 1 ? false : true\"\r\n            [placeholder]=\"nodePlaceholder\"\r\n            (selectChange)=\"selectNodeChange($event)\"\r\n            (clear)=\"selectNodeClear()\"\r\n          >\r\n          </farris-combo-list>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- \u529E\u7406\u4EBA\u5458 -->\r\n      <lib-assignee-info\r\n        *ngFor=\"let assignInfo of assignInfos; let i = index\"\r\n        [assigneeInfo]=\"assignInfo.assigneeInfo\"\r\n        [setAnonymous]=\"assignInfo.anonymous\"\r\n        [setAnonymousText]=\"assignInfo.anonymousText\"\r\n        [selectedAssignees]=\"assignInfo.selectedAssignees\"\r\n        [activityName]=\"\r\n          assignInfos.length > 1 ? assignInfo.activityDefinitionName : ''\r\n        \"\r\n        [ifShowBlank]=\"assignInfos.length > 1 ? false : true\"\r\n        [openFromIframe]=\"openFromIframe\"\r\n        [wfContext]=\"wfContext\"\r\n        [index]=\"i\"\r\n        [ifHorizontal]=\"true\"\r\n        (afterConfirm)=\"afterConfirm($event, i)\"\r\n      ></lib-assignee-info>\r\n\r\n      <!-- \u7D27\u6025\u7A0B\u5EA6 -->\r\n      <div\r\n        *ngIf=\"\r\n          response?.priorityInfo?.enable &&\r\n          response?.priorityInfo?.priorityItemList?.length\r\n        \"\r\n        class=\"wf-task-handler-help-div wf-submit-item\"\r\n      >\r\n        <div class=\"wf-task-handler-help-text wf-submit-item-label\">\r\n          {{ \"task.priority\" | translate }}\r\n        </div>\r\n        <farris-radiogroup\r\n          [(ngModel)]=\"response.priorityInfo.priority\"\r\n          [data]=\"response.priorityInfo.priorityItemList\"\r\n          [horizontal]=\"true\"\r\n        >\r\n        </farris-radiogroup>\r\n      </div>\r\n    </div>\r\n  </farris-section>\r\n\r\n  <!-- \u4FEE\u6539\u5176\u4ED6\u8282\u70B9\u529E\u7406\u4EBA -->\r\n  <farris-section\r\n    *ngIf=\"otherAssignInfos && otherAssignInfos.length\"\r\n    [mainTitle]=\"'startProcess.otherNodesAssign' | translate\"\r\n    style=\"padding: 0 24px\"\r\n  >\r\n    <div class=\"wf-submit-section\">\r\n      <!-- \u529E\u7406\u4EBA\u5458 -->\r\n      <lib-assignee-info\r\n        *ngFor=\"let assignInfo of otherAssignInfos; let i = index\"\r\n        [assigneeInfo]=\"assignInfo.assigneeInfo\"\r\n        [setAnonymous]=\"assignInfo.anonymous\"\r\n        [setAnonymousText]=\"assignInfo.anonymousText\"\r\n        [selectedAssignees]=\"assignInfo.selectedAssignees\"\r\n        [activityName]=\"assignInfo.activityDefinitionName\"\r\n        [ifShowBlank]=\"true\"\r\n        [openFromIframe]=\"openFromIframe\"\r\n        [wfContext]=\"wfContext\"\r\n        [index]=\"i + 'other'\"\r\n        [ifHorizontal]=\"true\"\r\n        (afterConfirm)=\"otherAssignInfosAfterConfirm($event, i)\"\r\n      ></lib-assignee-info>\r\n    </div>\r\n  </farris-section>\r\n</div>\r\n\r\n<!-- \u5F39\u6846\u663E\u793A\u65F6\uFF0C\u663E\u793A\u6309\u94AE -->\r\n<div *ngIf=\"showButtons\" class=\"modal-footer\">\r\n  <div *ngIf=\"showButtons; then buttons\"></div>\r\n</div>\r\n\r\n<!-- \u6309\u94AE -->\r\n<ng-template #buttons>\r\n  <button type=\"button\" class=\"btn btn-secondary\" (click)=\"cancel()\">\r\n    {{ \"static.footCancel\" | translate }}\r\n  </button>\r\n  <button\r\n    type=\"button\"\r\n    class=\"btn btn-primary\"\r\n    [disabled]=\"submitDisable\"\r\n    directive-throttle\r\n    (throttleClick)=\"startProcessSubmit()\"\r\n  >\r\n    {{ \"static.footOk\" | translate }}\r\n  </button>\r\n</ng-template>\r\n",
                    styles: [".wf-task-handler-help-div{font-size:13px;color:#2d2f33;margin-bottom:14px}.wf-task-handler-help-div-submit{margin-bottom:14px}.wf-task-handler-help-text{padding-bottom:8px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.wf-task-batch-selected{padding-left:8px}.wf-task-batch-rows{font-size:13px;font-weight:500;padding:0 4px;color:#2a87ff}.wf-task-batch-time{font-size:13px;font-weight:500;padding:0 4px;color:#424347}.wf-task-batch-message{display:flex;background:#edf9ff;border:1px solid rgba(196,235,255,1);border-radius:8px;margin-bottom:6px;align-items:center;font-size:12px;padding:4px 10px}.wf-submit-section{padding:4px 24px 0}.wf-submit-item{display:flex;align-items:baseline}.wf-submit-item-label{padding-right:10px;width:88px;text-align:right}.wf-task-splitter{display:flex;align-items:center;color:rgba(0,0,0,.4);font-size:12px;margin-bottom:10px}.wf-task-splitter-line{border-bottom:1px dashed rgba(0,0,0,.1);flex-grow:1}"]
                }] }
    ];
    /** @nocollapse */
    ProcessSelectorComponent.ctorParameters = function () { return [
        { type: TaskService },
        { type: LoadingService },
        { type: NotifyService },
        { type: I18nService },
        { type: MessagerService },
        { type: Injector },
        { type: WfTaskHandlerService }
    ]; };
    ProcessSelectorComponent.propDecorators = {
        nodeCombo: [{ type: ViewChild, args: ['nodeCombo',] }],
        buttons: [{ type: ViewChild, args: ['buttons',] }],
        openFromIframe: [{ type: Input }],
        parameter: [{ type: Input }]
    };
    return ProcessSelectorComponent;
}());
export { ProcessSelectorComponent };
if (false) {
    /** @type {?} */
    ProcessSelectorComponent.prototype.destProcesses;
    /** @type {?} */
    ProcessSelectorComponent.prototype.destNodes;
    /** @type {?} */
    ProcessSelectorComponent.prototype.response;
    /** @type {?} */
    ProcessSelectorComponent.prototype.assignInfos;
    /** @type {?} */
    ProcessSelectorComponent.prototype.otherAssignInfos;
    /** @type {?} */
    ProcessSelectorComponent.prototype.selectedProcessId;
    /** @type {?} */
    ProcessSelectorComponent.prototype.selectedNodeId;
    /** @type {?} */
    ProcessSelectorComponent.prototype.payload;
    /** @type {?} */
    ProcessSelectorComponent.prototype.subject;
    /** @type {?} */
    ProcessSelectorComponent.prototype.subjectWithResponse;
    /** @type {?} */
    ProcessSelectorComponent.prototype.subjectCancel;
    /** @type {?} */
    ProcessSelectorComponent.prototype.submitDisable;
    /** @type {?} */
    ProcessSelectorComponent.prototype.showButtons;
    /** @type {?} */
    ProcessSelectorComponent.prototype.curLanguage;
    /** @type {?} */
    ProcessSelectorComponent.prototype.nodePlaceholder;
    /** @type {?} */
    ProcessSelectorComponent.prototype.processPlaceholder;
    /** @type {?} */
    ProcessSelectorComponent.prototype.wfContext;
    /** @type {?} */
    ProcessSelectorComponent.prototype.processDefaultValue;
    /** @type {?} */
    ProcessSelectorComponent.prototype.nodeDefaultValue;
    /** @type {?} */
    ProcessSelectorComponent.prototype.dialogHeight;
    /** @type {?} */
    ProcessSelectorComponent.prototype.nodeCombo;
    /** @type {?} */
    ProcessSelectorComponent.prototype.buttons;
    /** @type {?} */
    ProcessSelectorComponent.prototype.openFromIframe;
    /**
     * @type {?}
     * @private
     */
    ProcessSelectorComponent.prototype.taskService;
    /**
     * @type {?}
     * @private
     */
    ProcessSelectorComponent.prototype.loadingService;
    /**
     * @type {?}
     * @private
     */
    ProcessSelectorComponent.prototype.notify;
    /**
     * @type {?}
     * @private
     */
    ProcessSelectorComponent.prototype.i18nService;
    /**
     * @type {?}
     * @private
     */
    ProcessSelectorComponent.prototype.messager;
    /**
     * @type {?}
     * @private
     */
    ProcessSelectorComponent.prototype.injector;
    /**
     * @type {?}
     * @private
     */
    ProcessSelectorComponent.prototype.handlerService;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicHJvY2Vzcy1zZWxlY3Rvci5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZ3NwLXdmL3dmLXRhc2staGFuZGxlci8iLCJzb3VyY2VzIjpbImxpYi9zdWJtaXQvcHJvY2Vzcy1zZWxlY3Rvci9wcm9jZXNzLXNlbGVjdG9yLmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7O0FBQUEsT0FBTyxFQUFFLFNBQVMsRUFBVSxTQUFTLEVBQUUsV0FBVyxFQUFFLEtBQUssRUFBRSxRQUFRLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFDM0YsT0FBTyxFQUFFLFdBQVcsRUFBRSxNQUFNLDRCQUE0QixDQUFDO0FBQ3pELE9BQU8sRUFBRSxtQkFBbUIsRUFBRSxZQUFZLEVBQVksTUFBTSxvQ0FBb0MsQ0FBQztBQUVqRyxPQUFPLEVBQUUsY0FBYyxFQUFFLE1BQU0sb0JBQW9CLENBQUE7QUFDbkQsT0FBTyxFQUFjLE9BQU8sRUFBRSxNQUFNLE1BQU0sQ0FBQztBQUMzQyxPQUFPLEVBQUUsYUFBYSxFQUFFLE1BQU0sbUJBQW1CLENBQUM7QUFDbEQsT0FBTyxFQUFFLFdBQVcsRUFBRSxNQUFNLGlDQUFpQyxDQUFDO0FBQzlELE9BQU8sRUFBRSxrQkFBa0IsRUFBRSxNQUFNLHVCQUF1QixDQUFDO0FBQzNELE9BQU8sRUFBRSxXQUFXLEVBQUUsTUFBTSwwQkFBMEIsQ0FBQztBQUN2RCxPQUFPLEVBQUUsZUFBZSxFQUFFLE1BQU0scUJBQXFCLENBQUE7QUFHckQsT0FBTyxFQUFFLG9CQUFvQixFQUFFLE1BQU0sK0JBQStCLENBQUM7QUFDckUsT0FBTyxFQUFFLFVBQVUsRUFBRSxNQUFNLGlDQUFpQyxDQUFDO0FBQzdELE9BQU8sRUFBRSxTQUFTLEVBQUUsTUFBTSx3QkFBd0IsQ0FBQztBQUNuRCxPQUFPLEVBQUUsVUFBVSxFQUFFLE1BQU0sMEJBQTBCLENBQUM7QUFDdEQsT0FBTyxFQUFFLFVBQVUsRUFBRSxNQUFNLDBCQUEwQixDQUFDO0FBQ3RELE9B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c0RBQTJCOztJQUMzQiw2Q0FBNEI7O0lBQzVCLHVEQUE0Qjs7SUFDNUIsb0RBQXlCOztJQUN6QixnREFBMkI7O0lBRTNCLDZDQUFxRDs7SUFDckQsMkNBQWdEOztJQUNoRCxrREFBeUM7Ozs7O0lBakR2QywrQ0FBZ0M7Ozs7O0lBQ2hDLGtEQUFzQzs7Ozs7SUFDdEMsMENBQTZCOzs7OztJQUM3QiwrQ0FBZ0M7Ozs7O0lBQ2hDLDRDQUFpQzs7Ozs7SUFDakMsNENBQTBCOzs7OztJQUMxQixrREFBNEMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb21wb25lbnQsIE9uSW5pdCwgVmlld0NoaWxkLCBUZW1wbGF0ZVJlZiwgSW5wdXQsIEluamVjdG9yIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IFRhc2tTZXJ2aWNlIH0gZnJvbSAnLi4vLi4vc2VydmljZS90YXNrLnNlcnZpY2UnO1xyXG5pbXBvcnQgeyBTdGFydFByb2Nlc3NQYXlsb2FkLCBGbG93Tm9kZUluZm8sIEFzc2lnbmVlIH0gZnJvbSAnLi4vLi4vZW50aXR5L3N0YXJ0LXByb2Nlc3MtcGF5bG9hZCc7XHJcbmltcG9ydCB7IEV4ZWN1dGlvblJlc3BvbnNlIH0gZnJvbSAnLi4vLi4vZW50aXR5L2V4ZWN1dGlvbi1yZXNwb25zZSc7XHJcbmltcG9ydCB7IExvYWRpbmdTZXJ2aWNlIH0gZnJvbSAnQGZhcnJpcy91aS1sb2FkaW5nJ1xyXG5pbXBvcnQgeyBPYnNlcnZhYmxlLCBTdWJqZWN0IH0gZnJvbSAncnhqcyc7XHJcbmltcG9ydCB7IE5vdGlmeVNlcnZpY2UgfSBmcm9tICdAZmFycmlzL3VpLW5vdGlmeSc7XHJcbmltcG9ydCB7IEkxOG5TZXJ2aWNlIH0gZnJvbSAnLi4vLi4vc2VydmljZS9pMThuL2kxOG4uc2VydmljZSc7XHJcbmltcG9ydCB7IENvbWJvTGlzdENvbXBvbmVudCB9IGZyb20gJ0BmYXJyaXMvdWktY29tYm8tbGlzdCc7XHJcbmltcG9ydCB7IE1lc3NhZ2VUeXBlIH0gZnJvbSAnLi4vLi4vZW50aXR5L3Bvc3RNZXNzYWdlJztcclxuaW1wb3J0IHsgTWVzc2FnZXJTZXJ2aWNlIH0gZnJvbSAnQGZhcnJpcy91aS1tZXNzYWdlcidcclxuaW1wb3J0IHsgUHJpb3JpdHlJbmZvLCBTaW11bGF0ZVJlc3BvbnNlLCBTaW11bGF0aW9uUGF0aCB9IGZyb20gJy4uLy4uL2VudGl0eS9zaW11bGF0ZS1yZXNwb25zZSc7XHJcbmltcG9ydCB7IEFzc2lnbkluZm9IZWxwRW50aXR5IH0gZnJvbSAnLi4vLi4vZW50aXR5L2Fzc2lnbkluZm9IZWxwJztcclxuaW1wb3J0IHsgV2ZUYXNrSGFuZGxlclNlcnZpY2UgfSBmcm9tICcuLi8uLi93Zi10YXNrLWhhbmRsZXIuc2VydmljZSc7XHJcbmltcG9ydCB7IENvbmZpZ0NvZGUgfSBmcm9tICcuLi8uLi9lbnRpdHkvdGFzay1jZW50ZXItY29uZmlnJztcclxuaW1wb3J0IHsgV2ZDb250ZXh0IH0gZnJvbSAnLi4vLi4vZW50aXR5L3dmQ29udGV4dCc7XHJcbmltcG9ydCB7IFRhc2tFbnRpdHkgfSBmcm9tICcuLi8uLi9lbnRpdHkvdGFzay1lbnRpdHknO1xyXG5pbXBvcnQgeyBUYXNrQWN0aW9uIH0gZnJvbSAnLi4vLi4vZW50aXR5L3Rhc2stYWN0aW9uJztcclxuaW1wb3J0IHsgU2VsZWN0ZWRQcm9jZXNzSXRlbSwgU3RhcnRQcm9jZXNzQ2FjaGUgfSBmcm9tICcuLi8uLi9lbnRpdHkvcHJvY2Vzcy1jYWNoZSc7XHJcblxyXG5AQ29tcG9uZW50KHtcclxuICBzZWxlY3RvcjogJ2xpYi1wcm9jZXNzLXNlbGVjdG9yJyxcclxuICB0ZW1wbGF0ZVVybDogJy4vcHJvY2Vzcy1zZWxlY3Rvci5jb21wb25lbnQuaHRtbCcsXHJcbiAgc3R5bGVVcmxzOiBbJy4uLy4uL2NvbXBvbmVudHMvdGFzay1leGVjdXRlL3Rhc2stZXhlY3V0ZS5jb21wb25lbnQuY3NzJ10sXHJcbn0pXHJcbmV4cG9ydCBjbGFzcyBQcm9jZXNzU2VsZWN0b3JDb21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQge1xyXG5cclxuICAvLyB0YXNrIGNlbnRlci11aeS4rXN0YXJ0LXByb2Nlc3MtbWVudeS9v+eUqOS6huatpOmAieaLqeWZqO+8jOaehOmAoOaWueazleaUueWKqOaXtu+8jOmcgOmHjeaWsOe8luivkVxyXG4gIGNvbnN0cnVjdG9yKFxyXG4gICAgcHJpdmF0ZSB0YXNrU2VydmljZTogVGFza1NlcnZpY2UsXHJcbiAgICBwcml2YXRlIGxvYWRpbmdTZXJ2aWNlOiBMb2FkaW5nU2VydmljZSxcclxuICAgIHByaXZhdGUgbm90aWZ5OiBOb3RpZnlTZXJ2aWNlLFxyXG4gICAgcHJpdmF0ZSBpMThuU2VydmljZTogSTE4blNlcnZpY2UsXHJcbiAgICBwcml2YXRlIG1lc3NhZ2VyOiBNZXNzYWdlclNlcnZpY2UsXHJcbiAgICBwcml2YXRlIGluamVjdG9yOiBJbmplY3RvcixcclxuICAgIHByaXZhdGUgaGFuZGxlclNlcnZpY2U6IFdmVGFza0hhbmRsZXJTZXJ2aWNlXHJcbiAgKSB7XHJcbiAgfVxyXG5cclxuICBuZ09uSW5pdCgpIHtcclxuICB9XHJcblxyXG4gIGRlc3RQcm9jZXNzZXM6IHsgaWQ6IHN0cmluZywgbmFtZTogc3RyaW5nIH1bXSA9IFtdOy8v5YCZ6YCJ5rWB56iLXHJcbiAgZGVzdE5vZGVzOiB7IGlkOiBzdHJpbmcsIG5hbWU6IHN0cmluZyB9W10gPSBbXTsvL+WAmemAieS4i+S4gOeOr+iKglxyXG4gIHJlc3BvbnNlOiBTaW11bGF0ZVJlc3BvbnNlOy8v5L+d5a2Y5qih5ouf5rWB56iL5ZCO6L+U5Zue55qE5YaF5a6577yM6YCJ5oup6IqC54K55pe25L2/55SoXHJcbiAgYXNzaWduSW5mb3M6IEFzc2lnbkluZm9IZWxwRW50aXR5W10gPVxyXG4gICAgW3tcclxuICAgICAgc2VsZWN0ZWRBc3NpZ25lZXM6IFtdLFxyXG4gICAgICBhc3NpZ25lZUluZm86IG51bGwsXHJcbiAgICAgIGFzc2lnbmVlczogW10sXHJcbiAgICAgIGFjdGl2aXR5RGVmaW5pdGlvbk5hbWU6ICcnLFxyXG4gICAgICBhY3Rpdml0eURlZmluaXRpb25JZDogJycsXHJcbiAgICAgIGRlcGVuZGVuY3k6ICcnLFxyXG4gICAgICBhbm9ueW1vdXM6IGZhbHNlLFxyXG4gICAgICBhbm9ueW1vdXNUZXh0OiBudWxsLFxyXG4gICAgICByZXNvbHZlZDogZmFsc2UsXHJcbiAgICB9XTsvL+iKgueCuei/lOWbnueahOaMh+a0vuS/oeaBr++8iOWkmuS4qu+8iVxyXG5cclxuICBvdGhlckFzc2lnbkluZm9zOiBBc3NpZ25JbmZvSGVscEVudGl0eVtdID0gW107Ly/oioLngrnov5Tlm57nmoTmjIfmtL7kv6Hmga/vvIjlpJrkuKrvvIlcclxuXHJcbiAgc2VsZWN0ZWRQcm9jZXNzSWQ6IHN0cmluZzsvL+mAieaLqeeahOa1geeoi+WumuS5iUlEXHJcbiAgc2VsZWN0ZWROb2RlSWQ6IHN0cmluZzsgLy/pgInmi6nnmoTkuIvkuIDnjq/oioJJRO+8jOWQjue7reeOr+iKgmlk55qE5ou85o6lXHJcbiAgcGF5bG9hZCA9IG5ldyBTdGFydFByb2Nlc3NQYXlsb2FkOy8v5L+d5a2Y6KGo5Y2V5LiK5Lyg5p2l55qEcGF5bG9hZFxyXG4gIHN1YmplY3QgPSBuZXcgU3ViamVjdCgpOy8v6L+U5ZueYm9vbFxyXG4gIHN1YmplY3RXaXRoUmVzcG9uc2UgPSBuZXcgU3ViamVjdDxhbnk+KCk7Ly/ov5Tlm57mtYHnqIvkuIrkuIvmlodcclxuICBzdWJqZWN0Q2FuY2VsID0gbmV3IFN1YmplY3QoKTsvL+eCueWHu+WPlua2iOWQjueahHN1YmplY3RcclxuICBzdWJtaXREaXNhYmxlOiBib29sZWFuID0gZmFsc2U7Ly/mj5DkuqTmjInpkq7mmK/lkKbnpoHnlKhcclxuICBzaG93QnV0dG9uczogYm9vbGVhbiA9IGZhbHNlO1xyXG4gIGN1ckxhbmd1YWdlOiBzdHJpbmcgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnbGFuZ3VhZ2VDb2RlJykgfHwgJ3poLUNIUyc7Ly/ns7vnu5/lvZPliY3or63oqIBcclxuICBub2RlUGxhY2Vob2xkZXI6IHN0cmluZzsvL+S4i+S4gOeOr+iKgueahHBsYWNlaG9sZGVyXHJcbiAgcHJvY2Vzc1BsYWNlaG9sZGVyOiBzdHJpbmc7Ly/pgInmi6nmtYHnqIvnmoRwbGFjZWhvbGRlclxyXG4gIHdmQ29udGV4dCA9IG5ldyBXZkNvbnRleHQoKTsvL+W3peS9nOa1geS4iuS4i+aWh1xyXG4gIHByb2Nlc3NEZWZhdWx0VmFsdWU6IHN0cmluZzsvL+m7mOiupOa1geeoi++8iOaPkOekuueUqO+8iVxyXG4gIG5vZGVEZWZhdWx0VmFsdWU6IHN0cmluZzsvL+m7mOiupOS4i+S4gOeOr+iKgu+8iOaPkOekuueUqO+8iVxyXG4gIGRpYWxvZ0hlaWdodDogbnVtYmVyID0gMjQwOy8v5by55qGG5Z+65pys6auY5bqmXHJcblxyXG4gIEBWaWV3Q2hpbGQoJ25vZGVDb21ibycpIG5vZGVDb21ibzogQ29tYm9MaXN0Q29tcG9uZW50XHJcbiAgQFZpZXdDaGlsZCgnYnV0dG9ucycpIGJ1dHRvbnM6IFRlbXBsYXRlUmVmPGFueT47Ly/noa7orqTlj5bmtojmjInpkq5cclxuICBASW5wdXQoKSBvcGVuRnJvbUlmcmFtZTogYm9vbGVhbiA9IGZhbHNlOy8v5piv5ZCm5LuOaWZyYW1l5omT5byA77yM5bqU55SoSURQ5o+Q5Lqk5a6h5om56ZuG5oiQXHJcblxyXG4gIEBJbnB1dCgpLy/ljp/nlJ9KU+aPkOS6pOWuoeaJueS9v+eUqFxyXG4gIHNldCBwYXJhbWV0ZXIocGFyYW1ldGVyOiBhbnkpIHtcclxuICAgIGlmIChwYXJhbWV0ZXIpIHtcclxuICAgICAgdGhpcy5zaG93QnV0dG9ucyA9IHRydWU7XHJcbiAgICAgIHRoaXMuc2V0UGFyYW0ocGFyYW1ldGVyKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHNldFBhcmFtKHBhcmFtOiBTdGFydFByb2Nlc3NQYXlsb2FkKTogT2JzZXJ2YWJsZTxhbnk+IHtcclxuICAgIGxldCBzdWJqZWN0ID0gbmV3IFN1YmplY3Q8YW55PigpO1xyXG4gICAgaWYgKCFwYXJhbSkgeyByZXR1cm47IH1cclxuICAgIHRoaXMucGF5bG9hZC5pZCA9IHBhcmFtLmlkO1xyXG4gICAgdGhpcy5wYXlsb2FkLnByb2Nlc3NEZWZpbml0aW9uSWQgPSBwYXJhbS5wcm9jZXNzRGVmaW5pdGlvbklkO1xyXG4gICAgdGhpcy5wYXlsb2FkLnByb2Nlc3NEZWZpbml0aW9uS2V5ID0gcGFyYW0ucHJvY2Vzc0RlZmluaXRpb25LZXk7XHJcbiAgICB0aGlzLnBheWxvYWQuYml6RGVmS2V5ID0gcGFyYW0uYml6RGVmS2V5O1xyXG4gICAgdGhpcy5wYXlsb2FkLmRhdGFNb2RlbElkID0gcGFyYW0uZGF0YU1vZGVsSWQ7XHJcbiAgICB0aGlzLnBheWxvYWQuZGF0YUlkID0gcGFyYW0uZGF0YUlkO1xyXG4gICAgdGhpcy5wYXlsb2FkLm5hbWUgPSBwYXJhbS5uYW1lO1xyXG4gICAgdGhpcy5wYXlsb2FkLnN0YXJ0VXNlcklkID0gcGFyYW0uc3RhcnRVc2VySWQ7XHJcbiAgICB0aGlzLnBheWxvYWQubmV4dEZsb3dOb2RlcyA9IFtdO1xyXG4gICAgdGhpcy5wYXlsb2FkLm90aGVyQXNzaWduTm9kZXMgPSBbXTtcclxuICAgIHRoaXMud2ZDb250ZXh0LnByb2Nlc3NDYXRlZ29yeUlkID0gcGFyYW0uYml6RGVmS2V5O1xyXG4gICAgdGhpcy5zdGFydFByb2Nlc3NTaW11bGF0ZSh0aGlzLnBheWxvYWQsIHN1YmplY3QpO1xyXG4gICAgcmV0dXJuIHN1YmplY3QuYXNPYnNlcnZhYmxlKCk7XHJcbiAgfVxyXG5cclxuICBzdGFydFByb2Nlc3NTaW11bGF0ZShwYXlsb2FkOiBTdGFydFByb2Nlc3NQYXlsb2FkLCBzdWJqZWN0OiBTdWJqZWN0PGFueT4pIHtcclxuICAgIGNvbnN0IGxvYWQgPSB0aGlzLmxvYWRpbmdTZXJ2aWNlLnNob3coKTtcclxuICAgIHRoaXMudGFza1NlcnZpY2Uuc3RhcnRQcm9jZXNzU2ltdWxhdGUocGF5bG9hZCkuc3Vic2NyaWJlKChyZXNwb25zZTogU2ltdWxhdGVSZXNwb25zZSkgPT4ge1xyXG4gICAgICBsb2FkLmNsb3NlKCk7XHJcbiAgICAgIHRoaXMucmVzcG9uc2UgPSByZXNwb25zZTtcclxuICAgICAgcmVzcG9uc2UucHJpb3JpdHlJbmZvICYmIHJlc3BvbnNlLnByaW9yaXR5SW5mby5lbmFibGUgJiYgKHRoaXMuZGlhbG9nSGVpZ2h0ICs9IDQwKTtcclxuICAgICAgdGhpcy5kZXN0UHJvY2Vzc2VzID0gcmVzcG9uc2UucHJvY0RlZnMubWFwKHByb2Nlc3MgPT4gKHsgaWQ6IHByb2Nlc3MucHJvY0RlZklkLCBuYW1lOiBwcm9jZXNzLnByb2NEZWZOYW1lICsgYCh2JHtwcm9jZXNzLnZlcnNpb259LjApYCB9KSk7Ly/lop7liqDmtYHnqIvnmoTniYjmnKzkv6Hmga9cclxuICAgICAgaWYgKHRoaXMuZGVzdFByb2Nlc3Nlcy5sZW5ndGggPT09IDEpIHsvL+WPquacieS4gOS4quWAmemAiea1geeoi+aXtlxyXG4gICAgICAgIHRoaXMuc2VsZWN0ZWRQcm9jZXNzSWQgPSB0aGlzLmRlc3RQcm9jZXNzZXNbMF0uaWQ7XHJcbiAgICAgICAgdGhpcy5zZXROZXh0Tm9kZShyZXNwb25zZSk7XHJcbiAgICAgICAgdGhpcy5wcm9jZXNzRGVmYXVsdFZhbHVlID0gdGhpcy5kZXN0UHJvY2Vzc2VzWzBdLm5hbWU7XHJcbiAgICAgICAgXHJcbiAgICAgIH0gZWxzZSB7Ly/lpJrkuKrmtYHnqIvml7bvvIzlj5bkuIrkuIDmrKHpgInmi6nnmoRcclxuICAgICAgICBjb25zdCBzZWxlY3RlZFByb2Nlc3NJZCA9IHRoaXMuZ2V0U2VsZWN0ZWRQcm9jZXNzQ2FjaGUodGhpcy5wYXlsb2FkLmJpekRlZktleSk7XHJcbiAgICAgICAgaWYgKHNlbGVjdGVkUHJvY2Vzc0lkICYmIHRoaXMuZGVzdFByb2Nlc3Nlcy5maW5kSW5kZXgocCA9PiBwLmlkID09PSBzZWxlY3RlZFByb2Nlc3NJZC5wcm9jZXNzRGVmaW5pdGlvbklkKSA+IC0xKSB7XHJcbiAgICAgICAgICB0aGlzLmdldERlc3ROb2RlcyhzZWxlY3RlZFByb2Nlc3NJZC5wcm9jZXNzRGVmaW5pdGlvbklkKTtcclxuICAgICAgICAgIHRoaXMucHJvY2Vzc0RlZmF1bHRWYWx1ZSA9IHNlbGVjdGVkUHJvY2Vzc0lkLnByb2Nlc3NEZWZpbml0aW9uTmFtZTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgdGhpcy5wcm9jZXNzUGxhY2Vob2xkZXIgPSB0aGlzLmkxOG5TZXJ2aWNlLmdldFZhbHVlKCd0YXNrLnNlbGVjdFBsYWNlaG9sZGVyJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuZGlhbG9nSGVpZ2h0ID0gMzMwO1xyXG4gICAgICB9XHJcbiAgICAgIGlmICh0aGlzLmFzc2lnbkluZm9zICYmIHRoaXMuYXNzaWduSW5mb3MubGVuZ3RoKSB7XHJcbiAgICAgICAgdGhpcy5kaWFsb2dIZWlnaHQgKz0gKHRoaXMuYXNzaWduSW5mb3MubGVuZ3RoKSAqIDQwO1xyXG4gICAgICB9XHJcbiAgICAgIGlmICh0aGlzLm90aGVyQXNzaWduSW5mb3MgJiYgdGhpcy5vdGhlckFzc2lnbkluZm9zLmxlbmd0aCkge1xyXG4gICAgICAgIHRoaXMuZGlhbG9nSGVpZ2h0ICs9ICh0aGlzLm90aGVyQXNzaWduSW5mb3MubGVuZ3RoICsgMSkgKiA0MDtcclxuICAgICAgfVxyXG4gICAgICB0aGlzLmRpYWxvZ0hlaWdodCA9IHRoaXMuZGlhbG9nSGVpZ2h0ID4gNDQwID8gNDQwIDogdGhpcy5kaWFsb2dIZWlnaHQ7XHJcbiAgICAgIHN1YmplY3QubmV4dCh7IHJlc3VsdDogdHJ1ZSwgZGlhbG9nSGVpZ2h0OiB0aGlzLmRpYWxvZ0hlaWdodCB9KTtcclxuICAgIH0sIGVycm9yID0+IHtcclxuICAgICAgbG9hZC5jbG9zZSgpO1xyXG4gICAgICBzdWJqZWN0LmVycm9yKGVycm9yKTtcclxuICAgICAgdGhpcy50YXNrU2VydmljZS5lcnJvcihlcnJvcik7XHJcbiAgICB9KVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog6YCJ5oup5p+Q5Liq5rWB56iL5ZCOXHJcbiAgICogQHBhcmFtIGRhdGFcclxuICAgKi9cclxuICBzZWxlY3RQcm9jZXNzQ2hhbmdlKGRhdGE6IGFueSkge1xyXG4gICAgdGhpcy5ub2RlQ29tYm8ub25DbGVhcigpO1xyXG4gICAgdGhpcy5nZXREZXN0Tm9kZXMoZGF0YS5kYXRhLmlkKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOagueaNrumAieaLqeeahOa1geeoi+WumuS5iWlk6I635Y+W5LiL5LiA546v6IqC5L+h5oGvXHJcbiAgICogQHBhcmFtIHNlbGVjdGVkUHJvY2Vzc0lkIFxyXG4gICAqL1xyXG4gIHByaXZhdGUgZ2V0RGVzdE5vZGVzKHNlbGVjdGVkUHJvY2Vzc0lkOiBzdHJpbmcpIHtcclxuICAgIHRoaXMuc2VsZWN0ZWRQcm9jZXNzSWQgPSBzZWxlY3RlZFByb2Nlc3NJZDtcclxuICAgIHRoaXMuZGVzdE5vZGVzID0gW107XHJcbiAgICB0aGlzLm5vZGVQbGFjZWhvbGRlciA9ICcnO1xyXG4gICAgdGhpcy5jbGVhckFzc2lnbkluZm9zKCk7XHJcblxyXG4gICAgdmFyIHBheWxvYWQgPSBuZXcgU3RhcnRQcm9jZXNzUGF5bG9hZCgpO1xyXG4gICAgcGF5bG9hZC5wcm9jZXNzRGVmaW5pdGlvbklkID0gdGhpcy5zZWxlY3RlZFByb2Nlc3NJZDtcclxuICAgIHBheWxvYWQuZGF0YUlkID0gdGhpcy5wYXlsb2FkLmRhdGFJZDtcclxuXHJcbiAgICBjb25zdCBsb2FkID0gdGhpcy5sb2FkaW5nU2VydmljZS5zaG93KCk7XHJcbiAgICB0aGlzLnRhc2tTZXJ2aWNlLnN0YXJ0UHJvY2Vzc1NpbXVsYXRlKHBheWxvYWQpLnN1YnNjcmliZSgocmVzcG9uc2U6IFNpbXVsYXRlUmVzcG9uc2UpID0+IHtcclxuICAgICAgbG9hZC5jbG9zZSgpO1xyXG4gICAgICB0aGlzLnJlc3BvbnNlID0gcmVzcG9uc2U7XHJcbiAgICAgIHRoaXMuc2V0TmV4dE5vZGUocmVzcG9uc2UpO1xyXG4gICAgfSwgZXJyb3IgPT4ge1xyXG4gICAgICBsb2FkLmNsb3NlKCk7XHJcbiAgICAgIHRoaXMudGFza1NlcnZpY2UuZXJyb3IoZXJyb3IpO1xyXG4gICAgfSlcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOmAieaLqeiKgueCueWQjuS6i+S7tlxyXG4gICAqL1xyXG4gIHNlbGVjdE5vZGVDaGFuZ2UoZGF0YTogYW55KSB7XHJcbiAgICB0aGlzLmNsZWFyQXNzaWduSW5mb3MoKTtcclxuICAgIHRoaXMuc2VsZWN0ZWROb2RlSWQgPSBkYXRhLmRhdGEuaWQ7XHJcbiAgICBjb25zdCBub2RlTmFtZXMgPSBkYXRhLmRhdGEubmFtZS5zcGxpdCgn77yMJyk7XHJcblxyXG4gICAgaWYgKHRoaXMucmVzcG9uc2Uuc2ltdWxhdGlvblBhdGhzW2RhdGEuaW5kZXhdLm5vZGVJbmZvTGlzdC5ldmVyeShub2RlID0+IG5vZGUucmVzb2x2ZWQgPT09IHRydWUpKSB7Ly/lt7LpooTop6PmnpDlj4LkuI7ogIVcclxuICAgICAgdGhpcy5zZXRBc3NpZ25JbmZvKHRoaXMucmVzcG9uc2Uuc2ltdWxhdGlvblBhdGhzW2RhdGEuaW5kZXhdKTtcclxuICAgICAgdGhpcy5zZXRPdGhlckFzc2lnbkluZm8odGhpcy5yZXNwb25zZSk7Ly/liIfmjaLoioLngrnlkI7vvIzlhbbku5boioLngrnmjIfmtL7pnIDopoHmm7TmlrDvvIzph43mlrDljrvph41cclxuICAgIH0gZWxzZSB7Ly/mnKrpooTop6PmnpDlj4LkuI7ogIVcclxuICAgICAgbGV0IHBheWxvYWQgPSBuZXcgU3RhcnRQcm9jZXNzUGF5bG9hZCgpO1xyXG4gICAgICBwYXlsb2FkLnByb2Nlc3NEZWZpbml0aW9uSWQgPSB0aGlzLnNlbGVjdGVkUHJvY2Vzc0lkO1xyXG4gICAgICBwYXlsb2FkLmRhdGFJZCA9IHRoaXMucGF5bG9hZC5kYXRhSWQ7XHJcbiAgICAgIHBheWxvYWQubmV4dEZsb3dOb2RlcyA9IFtdO1xyXG5cclxuICAgICAgdGhpcy5zZWxlY3RlZE5vZGVJZC5zcGxpdCgn77yMJykuZm9yRWFjaCgobm9kZUlkLCBpbmRleCkgPT4ge1xyXG4gICAgICAgIGxldCBuZXh0Rmxvd05vZGUgPSBuZXcgRmxvd05vZGVJbmZvKCk7XHJcbiAgICAgICAgbmV4dEZsb3dOb2RlLmFjdGl2aXR5RGVmaW5pdGlvbklkID0gbm9kZUlkO1xyXG4gICAgICAgIG5leHRGbG93Tm9kZS5hY3Rpdml0eURlZmluaXRpb25OYW1lID0gbm9kZU5hbWVzW2luZGV4XTtcclxuICAgICAgICBwYXlsb2FkLm5leHRGbG93Tm9kZXMucHVzaChuZXh0Rmxvd05vZGUpO1xyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIGNvbnN0IGxvYWQgPSB0aGlzLmxvYWRpbmdTZXJ2aWNlLnNob3coKTtcclxuICAgICAgdGhpcy50YXNrU2VydmljZS5zdGFydFByb2Nlc3NTaW11bGF0ZShwYXlsb2FkKS5zdWJzY3JpYmUoKHJlc3BvbnNlOiBTaW11bGF0ZVJlc3BvbnNlKSA9PiB7XHJcbiAgICAgICAgbG9hZC5jbG9zZSgpO1xyXG4gICAgICAgIHRoaXMuc2V0QXNzaWduSW5mbyhyZXNwb25zZS5zaW11bGF0aW9uUGF0aHNbMF0pOy8v6YCJ5oup55qE5LiL5LiA546v6IqC5bqU6K+l5Zyo5ZCM5LiA5p2h6Lev5b6E5LiK77yM5pWF5Y+Wc2ltdWxhdGlvblBhdGhzWzBdXHJcbiAgICAgICAgdGhpcy5zZXRPdGhlckFzc2lnbkluZm8ocmVzcG9uc2UpOy8v5YiH5o2i6IqC54K55ZCO77yM5YW25LuW6IqC54K55oyH5rS+6ZyA6KaB5pu05paw77yM6YeN5paw5Y676YeNXHJcbiAgICAgIH0sIGVycm9yID0+IHtcclxuICAgICAgICBsb2FkLmNsb3NlKCk7XHJcbiAgICAgICAgdGhpcy50YXNrU2VydmljZS5lcnJvcihlcnJvcik7XHJcbiAgICAgIH0pXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICog5a6e546w55yf5q2j55qE5o+Q5LqkXHJcbiAqL1xyXG4gIHN0YXJ0UHJvY2Vzc1N1Ym1pdCgpIHtcclxuICAgIGlmICghdGhpcy5zZWxlY3RlZFByb2Nlc3NJZCkge1xyXG4gICAgICB0aGlzLm9wZW5Gcm9tSWZyYW1lID8gdGhpcy5tZXNzYWdlci53YXJuaW5nKHRoaXMuaTE4blNlcnZpY2UuZ2V0VmFsdWUoJ3N0YXJ0UHJvY2Vzcy5zZWxlY3RQcm9jZXNzJykpIDpcclxuICAgICAgICB0aGlzLm5vdGlmeS53YXJuaW5nKHRoaXMuaTE4blNlcnZpY2UuZ2V0VmFsdWUoJ3N0YXJ0UHJvY2Vzcy5zZWxlY3RQcm9jZXNzJykpO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBpZiAoIXRoaXMuc2VsZWN0ZWROb2RlSWQpIHtcclxuICAgICAgdGhpcy5vcGVuRnJvbUlmcmFtZSA/IHRoaXMubWVzc2FnZXIud2FybmluZyh0aGlzLmkxOG5TZXJ2aWNlLmdldFZhbHVlKCdzdGFydFByb2Nlc3Muc2VsZWN0Tm9kZScpKSA6XHJcbiAgICAgICAgdGhpcy5ub3RpZnkud2FybmluZyh0aGlzLmkxOG5TZXJ2aWNlLmdldFZhbHVlKCdzdGFydFByb2Nlc3Muc2VsZWN0Tm9kZScpKTtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgaWYgKHRoaXMuYXNzaWduSW5mb3MuZmlsdGVyKGluZm8gPT4gKGluZm8uYXNzaWduZWVJbmZvIHx8IGluZm8uc2VsZWN0ZWRBc3NpZ25lZXMubGVuZ3RoKSAmJiAhaW5mby5hc3NpZ25lZXMubGVuZ3RoKS5sZW5ndGgpIHsvL+epuuWPguS4juiAheetlueVpeaXtu+8jOS4jeaPkOekuumAieS6ulxyXG4gICAgICB0aGlzLm9wZW5Gcm9tSWZyYW1lID8gdGhpcy5tZXNzYWdlci53YXJuaW5nKHRoaXMuaTE4blNlcnZpY2UuZ2V0VmFsdWUoJ3Rhc2suc2VsZWN0UHJvY2Vzc29yJykpIDpcclxuICAgICAgICB0aGlzLm5vdGlmeS53YXJuaW5nKHRoaXMuaTE4blNlcnZpY2UuZ2V0VmFsdWUoJ3Rhc2suc2VsZWN0UHJvY2Vzc29yJykpO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBpZiAodGhpcy5yZXNwb25zZS5wcmlvcml0eUluZm8gJiYgdGhpcy5yZXNwb25zZS5wcmlvcml0eUluZm8uZW5hYmxlICYmICF0aGlzLnJlc3BvbnNlLnByaW9yaXR5SW5mby5wcmlvcml0eSkge1xyXG4gICAgICB0aGlzLm9wZW5Gcm9tSWZyYW1lID8gdGhpcy5tZXNzYWdlci53YXJuaW5nKHRoaXMuaTE4blNlcnZpY2UuZ2V0VmFsdWUoJ3Rhc2suc2VsZWN0UHJpb3JpdHknKSkgOlxyXG4gICAgICAgIHRoaXMubm90aWZ5Lndhcm5pbmcodGhpcy5pMThuU2VydmljZS5nZXRWYWx1ZSgndGFzay5zZWxlY3RQcmlvcml0eScpKTtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IG5vZGVzOiBzdHJpbmdbXSA9IHRoaXMuc2VsZWN0ZWROb2RlSWQuc3BsaXQoJ++8jCcpO1xyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBub2Rlcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICBsZXQgbmV4dEZsb3dOb2RlOiBGbG93Tm9kZUluZm8gPSB7XHJcbiAgICAgICAgYWN0aXZpdHlEZWZpbml0aW9uSWQ6IG5vZGVzW2ldLFxyXG4gICAgICAgIGFjdGl2aXR5RGVmaW5pdGlvbk5hbWU6IHRoaXMuYXNzaWduSW5mb3NbaV0uYWN0aXZpdHlEZWZpbml0aW9uTmFtZSxcclxuICAgICAgICBkZXBlbmRlbmN5OiB0aGlzLmFzc2lnbkluZm9zW2ldLmRlcGVuZGVuY3ksXHJcbiAgICAgICAgc2VsZWN0ZWRBc3NpZ25lZXM6IHRoaXMuYXNzaWduSW5mb3NbaV0uYXNzaWduZWVJbmZvID8gdGhpcy5hc3NpZ25JbmZvc1tpXS5hc3NpZ25lZXMgOiBbXSxcclxuICAgICAgICBhc3NpZ25lZUluZm86IG51bGwsXHJcbiAgICAgICAgcmVzb2x2ZWQ6IGZhbHNlLFxyXG4gICAgICAgIGFub255bW91czogZmFsc2UsXHJcbiAgICAgICAgYW5vbnltb3VzVGV4dDogJydcclxuICAgICAgfVxyXG4gICAgICAvL+iKgueCueaJvuS4jeWIsOS6uu+8jOS4lOW8guW4uOaPkOekuu+8jOWJjeerr+aOp+WItuS9j++8jOS4jeWFgeiuuOi1sOaPkOS6pOivt+axgu+8iOaehOS7tuS6i+WKoemXrumimO+8ieOAguW5tuihjOWcuuaZr+S4i+aaguS4jeWkhOeQhlxyXG4gICAgICBpZiAodGhpcy5yZXNwb25zZSAmJiB0aGlzLnJlc3BvbnNlLnNpbXVsYXRpb25QYXRocy5sZW5ndGggJiYgIXRoaXMucmVzcG9uc2Uuc2ltdWxhdGlvblBhdGhzWzBdLmlkLnN0YXJ0c1dpdGgoJ1BhcmFsbGVsR2F0ZXdheScpKSB7XHJcbiAgICAgICAgaWYgKG5vZGVzLmxlbmd0aCA9PSAxICYmIG5vZGVzW2ldLnN0YXJ0c1dpdGgoJ1VzZXJBY3Rpdml0eScpICYmIHRoaXMuYXNzaWduSW5mb3NbaV0ucmVzb2x2ZWQgJiYgIXRoaXMuYXNzaWduSW5mb3NbaV0uYXNzaWduZWVJbmZvICYmICF0aGlzLmFzc2lnbkluZm9zW2ldLnNlbGVjdGVkQXNzaWduZWVzLmxlbmd0aCkge1xyXG4gICAgICAgICAgY29uc3Qgc3RyID0gdGhpcy5hc3NpZ25JbmZvc1tpXS5hY3Rpdml0eURlZmluaXRpb25OYW1lICsgdGhpcy5pMThuU2VydmljZS5nZXRWYWx1ZSgnc3RhcnRQcm9jZXNzLm5vZGUnKSArIHRoaXMuaTE4blNlcnZpY2UuZ2V0VmFsdWUoJ3N0YXJ0UHJvY2Vzcy5ub1VzZXInKTtcclxuICAgICAgICAgIHRoaXMub3BlbkZyb21JZnJhbWUgPyB0aGlzLm1lc3NhZ2VyLndhcm5pbmcoc3RyKSA6IHRoaXMubm90aWZ5Lndhcm5pbmcoc3RyKTtcclxuICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgdGhpcy5wYXlsb2FkLm5leHRGbG93Tm9kZXMucHVzaChuZXh0Rmxvd05vZGUpO1xyXG4gICAgfVxyXG4gICAgLy/mi7zmjqXlhbbku5boioLngrnpgInkurrnu5PmnpxcclxuICAgIGlmICh0aGlzLm90aGVyQXNzaWduSW5mb3MgJiYgdGhpcy5vdGhlckFzc2lnbkluZm9zLmxlbmd0aCkge1xyXG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMub3RoZXJBc3NpZ25JbmZvcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgIGxldCBuZXh0Rmxvd05vZGU6IEZsb3dOb2RlSW5mbyA9IHtcclxuICAgICAgICAgIGFjdGl2aXR5RGVmaW5pdGlvbklkOiB0aGlzLm90aGVyQXNzaWduSW5mb3NbaV0uYWN0aXZpdHlEZWZpbml0aW9uSWQsXHJcbiAgICAgICAgICBhY3Rpdml0eURlZmluaXRpb25OYW1lOiB0aGlzLm90aGVyQXNzaWduSW5mb3NbaV0uYWN0aXZpdHlEZWZpbml0aW9uTmFtZSxcclxuICAgICAgICAgIGRlcGVuZGVuY3k6IHRoaXMub3RoZXJBc3NpZ25JbmZvc1tpXS5kZXBlbmRlbmN5LFxyXG4gICAgICAgICAgc2VsZWN0ZWRBc3NpZ25lZXM6IHRoaXMub3RoZXJBc3NpZ25JbmZvc1tpXS5hc3NpZ25lZUluZm8gPyB0aGlzLm90aGVyQXNzaWduSW5mb3NbaV0uYXNzaWduZWVzIDogW10sXHJcbiAgICAgICAgICBhc3NpZ25lZUluZm86IG51bGwsXHJcbiAgICAgICAgICByZXNvbHZlZDogZmFsc2UsXHJcbiAgICAgICAgICBhbm9ueW1vdXM6IGZhbHNlLFxyXG4gICAgICAgICAgYW5vbnltb3VzVGV4dDogJydcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5wYXlsb2FkLm90aGVyQXNzaWduTm9kZXMucHVzaChuZXh0Rmxvd05vZGUpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICB0aGlzLnBheWxvYWQucHJvY2Vzc0RlZmluaXRpb25JZCA9IHRoaXMuc2VsZWN0ZWRQcm9jZXNzSWQ7XHJcbiAgICB0aGlzLnN1Ym1pdERpc2FibGUgPSB0cnVlO1xyXG4gICAgLy/ntKfmgKXnqIvluqZcclxuICAgIGlmICh0aGlzLnJlc3BvbnNlLnByaW9yaXR5SW5mbyAmJiB0aGlzLnJlc3BvbnNlLnByaW9yaXR5SW5mby5lbmFibGUpIHtcclxuICAgICAgdGhpcy5wYXlsb2FkLnByaW9yaXR5ID0gdGhpcy5yZXNwb25zZS5wcmlvcml0eUluZm8ucHJpb3JpdHk7XHJcbiAgICB9XHJcbiAgICBjb25zdCBsb2FkID0gdGhpcy5sb2FkaW5nU2VydmljZS5zaG93KCk7XHJcbiAgICB0aGlzLnRhc2tTZXJ2aWNlLnN0YXJ0UHJvY2Vzcyh0aGlzLnBheWxvYWQpLnN1YnNjcmliZSgocmVzcG9uc2U6IEV4ZWN1dGlvblJlc3BvbnNlKSA9PiB7XHJcbiAgICAgIGxvYWQuY2xvc2UoKTtcclxuICAgICAgdGhpcy5zdWJtaXREaXNhYmxlID0gZmFsc2U7XHJcbiAgICAgIHRoaXMuc3ViamVjdC5uZXh0KHRydWUpO1xyXG4gICAgICB0aGlzLnN1YmplY3RXaXRoUmVzcG9uc2UubmV4dChyZXNwb25zZSk7XHJcbiAgICAgIGxldCBtZXNzYWdlQWZ0ZXJTdWJtaXQgPSB0aGlzLmkxOG5TZXJ2aWNlLmdldFZhbHVlKCdzdGFydFByb2Nlc3Muc3VibWl0U3VjY2VzcycpO1xyXG4gICAgICBpZiAodGhpcy5vcGVuRnJvbUlmcmFtZSkge1xyXG4gICAgICAgICh3aW5kb3cucGFyZW50IGFzIGFueSkuZ3NwV2ZTZXJ2aWNlLmV2ZW50SGFuZGxlcih7IGRhdGE6IHsgdHlwZTogTWVzc2FnZVR5cGUuU3VibWl0U3VjY2VzcywgbWVzc2FnZTogbWVzc2FnZUFmdGVyU3VibWl0IH0gfSk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgdGhpcy5oYW5kbGVyU2VydmljZS5oYW5kbGVTdWJtaXRNZXNzYWdlKENvbmZpZ0NvZGUuSW5mb19BZnRlcl9TdWJtaXQsIHRoaXMucGF5bG9hZC5iaXpEZWZLZXkpO1xyXG4gICAgICB9XHJcbiAgICAgIGlmICghdGhpcy5vcGVuRnJvbUlmcmFtZSAmJiByZXNwb25zZS5uZWVkSW50ZXJhY3Rpb24pIHsvL+aPkOS6pOWuoeaJueWQjumcgOimgeaMh+a0vuWcuuaZr1xyXG4gICAgICAgIHRoaXMubm90aWZ5LmluZm8odGhpcy5pMThuU2VydmljZS5nZXRWYWx1ZSgnY3VlV29yZHMuc2VsZWN0JylcclxuICAgICAgICAgICsgcmVzcG9uc2UubmV4dEZsb3dOb2Rlc1swXS5hY3Rpdml0eURlZmluaXRpb25OYW1lXHJcbiAgICAgICAgICArIHRoaXMuaTE4blNlcnZpY2UuZ2V0VmFsdWUoJ2N1ZVdvcmRzLnByb2Nlc3NvcicpKTtcclxuICAgICAgICBsZXQgdGFzayA9IG5ldyBUYXNrRW50aXR5KCk7XHJcbiAgICAgICAgbGV0IGFjdGlvbiA9IG5ldyBUYXNrQWN0aW9uKCk7XHJcbiAgICAgICAgdGFzay5zb3VyY2VJZCA9IHJlc3BvbnNlLm5leHRGbG93Tm9kZXNbMF0uYXNzaWduZWVJbmZvLndvcmtJdGVtSWQ7XHJcbiAgICAgICAgYWN0aW9uLmNvZGUgPSAnQXNzaWduVXNlcic7XHJcbiAgICAgICAgYWN0aW9uLm5hbWUgPSB0aGlzLmkxOG5TZXJ2aWNlLmdldFZhbHVlKCdjdWVXb3Jkcy5hc3NpZ25Vc2VyJyk7XHJcbiAgICAgICAgdGhpcy5oYW5kbGVyU2VydmljZS5leGVjdXRlKHRhc2ssIGFjdGlvbikuc3Vic2NyaWJlKHJlID0+IHsgfSk7XHJcbiAgICAgIH1cclxuICAgICAgdGhpcy5zZXRTZWxlY3RlZFByb2Nlc3NDYWNoZSgpO1xyXG4gICAgfSwgKGVycm9yKSA9PiB7XHJcbiAgICAgIGxvYWQuY2xvc2UoKTtcclxuICAgICAgdGhpcy5wYXlsb2FkLm5leHRGbG93Tm9kZXMgPSBbXTtcclxuICAgICAgdGhpcy5zdWJtaXREaXNhYmxlID0gZmFsc2U7XHJcbiAgICAgIHRoaXMuc3ViamVjdC5uZXh0KGZhbHNlKTsvL+W3sue7j+acieS6uueUqOS6hui/meS4qnN1YmplY3TvvIzmj5DkuqTlpLHotKXnmoTor53ov5Tlm55mYWxzZSBieSBmYW5ncGVuZ2ZlaUAyMDIxMDMyNFxyXG4gICAgICB0aGlzLnRhc2tTZXJ2aWNlLmVycm9yKGVycm9yKTtcclxuICAgIH0pXHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDpgInmi6nmtYHnqIvmuIXnqbpcclxuICAgKi9cclxuICBzZWxlY3RQcm9jZXNzQ2xlYXIoKSB7XHJcbiAgICB0aGlzLnNlbGVjdGVkUHJvY2Vzc0lkID0gJyc7XHJcbiAgICB0aGlzLmRlc3ROb2RlcyA9IFtdO1xyXG4gICAgdGhpcy5ub2RlUGxhY2Vob2xkZXIgPSAnJztcclxuICAgIHRoaXMuc2VsZWN0ZWROb2RlSWQgPSAnJztcclxuICAgIHRoaXMuY2xlYXJBc3NpZ25JbmZvcygpO1xyXG4gICAgdGhpcy5yZXNwb25zZSA9IG51bGw7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDpgInmi6noioLngrnmuIXnqbpcclxuICAgKi9cclxuICBzZWxlY3ROb2RlQ2xlYXIoKSB7XHJcbiAgICB0aGlzLnNlbGVjdGVkTm9kZUlkID0gJyc7XHJcbiAgICB0aGlzLmNsZWFyQXNzaWduSW5mb3MoKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOeUqOaIt+W4ruWKqemAieS6ulxyXG4gICAqL1xyXG4gIGFmdGVyQ29uZmlybShkYXRhOiBBc3NpZ25lZVtdLCBpbmRleDogbnVtYmVyKSB7XHJcbiAgICB0aGlzLmFzc2lnbkluZm9zW2luZGV4XS5hc3NpZ25lZXMgPSBkYXRhO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog5YW25LuW6IqC54K555So5oi35biu5Yqp6YCJ5Lq6XHJcbiAgICogQHBhcmFtIGRhdGEgXHJcbiAgICogQHBhcmFtIGluZGV4IFxyXG4gICAqL1xyXG4gIG90aGVyQXNzaWduSW5mb3NBZnRlckNvbmZpcm0oZGF0YTogQXNzaWduZWVbXSwgaW5kZXg6IG51bWJlcikge1xyXG4gICAgdGhpcy5vdGhlckFzc2lnbkluZm9zW2luZGV4XS5hc3NpZ25lZXMgPSBkYXRhO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog5by55qGG54K55Ye75Y+W5raIXHJcbiAgICovXHJcbiAgY2FuY2VsKCkge1xyXG4gICAgaWYgKHRoaXMub3BlbkZyb21JZnJhbWUpIHtcclxuICAgICAgKHdpbmRvdy5wYXJlbnQgYXMgYW55KS5nc3BXZlNlcnZpY2UuZXZlbnRIYW5kbGVyKHsgZGF0YTogeyB0eXBlOiBNZXNzYWdlVHlwZS5DYW5jZWwsIG1lc3NhZ2U6ICcnIH0gfSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLnN1YmplY3RDYW5jZWwubmV4dChmYWxzZSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDojrflj5bmj5DkuqTlrqHmibnlkI7ov5Tlm57lgLzvvIhib29s5Z6L77yM5YW85a655Y6G5Y+y77yJXHJcbiAgICovXHJcbiAgZ2V0U3ViamVjdCgpIHtcclxuICAgIHJldHVybiB0aGlzLnN1YmplY3QuYXNPYnNlcnZhYmxlKCk7XHJcbiAgfVxyXG4gIC8qKlxyXG4gICAqIOiOt+WPluaPkOS6pOWuoeaJueWQjui/lOWbnuWAvO+8iOWunuS9k+Wei++8jOW4pua1geeoi+S4iuS4i+aWh++8iVxyXG4gICAqL1xyXG4gIGdldFN1YmplY3RXaXRoUmVzcG9uc2UoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5zdWJqZWN0V2l0aFJlc3BvbnNlLmFzT2JzZXJ2YWJsZSgpO1xyXG4gIH1cclxuICAvKipcclxuICAgKiDngrnlh7vlj5bmtojlkI7nmoRzdWJqZWN077yM5YWz6Zet56qX5Y+j5L2/55SoXHJcbiAgICogQHJldHVybnNcclxuICAgKi9cclxuICBnZXRTdWJqZWN0Q2FuY2VsKCkge1xyXG4gICAgcmV0dXJuIHRoaXMuc3ViamVjdENhbmNlbC5hc09ic2VydmFibGUoKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOiuvue9ruS4i+S4gOeOr+iKglxyXG4gICAqL1xyXG4gIHByaXZhdGUgc2V0TmV4dE5vZGUocmVzcG9uc2U6IFNpbXVsYXRlUmVzcG9uc2UpIHtcclxuICAgIHRoaXMuZGVzdE5vZGVzID0gcmVzcG9uc2Uuc2ltdWxhdGlvblBhdGhzICYmIHJlc3BvbnNlLnNpbXVsYXRpb25QYXRocy5tYXAocGF0aCA9PiAoe1xyXG4gICAgICBpZDogcGF0aC5ub2RlSW5mb0xpc3QubWFwKG5vZGUgPT4gbm9kZS5hY3Rpdml0eURlZmluaXRpb25JZCkuam9pbign77yMJyksXHJcbiAgICAgIG5hbWU6IHBhdGgubm9kZUluZm9MaXN0Lm1hcChub2RlID0+IG5vZGUuYWN0aXZpdHlEZWZpbml0aW9uTmFtZSkuam9pbign77yMJylcclxuICAgIH0pKTtcclxuICAgIC8v5aSE55CG6buY6K6k5YiG5pSv77yM5peg6buY6K6k5YiG5pSv6L+U5ZueLTFcclxuICAgIGNvbnN0IGRlZmF1bHRJbmRleCA9IHJlc3BvbnNlLnNpbXVsYXRpb25QYXRocy5maW5kSW5kZXgoYSA9PiBhLmRlZmF1bHQpO1xyXG4gICAgaWYgKGRlZmF1bHRJbmRleCA+IC0xKSB7XHJcbiAgICAgIHRoaXMuc2VsZWN0ZWROb2RlSWQgPSB0aGlzLmRlc3ROb2Rlc1tkZWZhdWx0SW5kZXhdLmlkO1xyXG4gICAgICB0aGlzLm5vZGVEZWZhdWx0VmFsdWUgPSB0aGlzLmRlc3ROb2Rlc1tkZWZhdWx0SW5kZXhdLm5hbWUuaW5kZXhPZign77yMJykgPiAtMSA/IHJlc3BvbnNlLnNpbXVsYXRpb25QYXRoc1tkZWZhdWx0SW5kZXhdLm5hbWUgOiB0aGlzLmRlc3ROb2Rlc1tkZWZhdWx0SW5kZXhdLm5hbWU7XHJcbiAgICAgIHRoaXMuc2V0QXNzaWduSW5mbyhyZXNwb25zZS5zaW11bGF0aW9uUGF0aHNbZGVmYXVsdEluZGV4XSk7XHJcbiAgICAgIHRoaXMuc2V0T3RoZXJBc3NpZ25JbmZvKHJlc3BvbnNlKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMubm9kZVBsYWNlaG9sZGVyID0gdGhpcy5pMThuU2VydmljZS5nZXRWYWx1ZSgndGFzay5zZWxlY3RQbGFjZWhvbGRlcicpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog6K6+572u5b2T5YmN5oyH5rS+5L+h5oGv5biu5Yqp5Y+C5pWwXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBzZXRBc3NpZ25JbmZvKHNpbXVsYXRpb25QYXRoczogU2ltdWxhdGlvblBhdGgpIHtcclxuICAgIHRoaXMuYXNzaWduSW5mb3MgPSBbXTtcclxuICAgIHRoaXMuc2VsZWN0ZWROb2RlSWQuc3BsaXQoJ++8jCcpLmZvckVhY2gobm9kZUlkID0+IHtcclxuICAgICAgY29uc3Qgbm9kZSA9IHNpbXVsYXRpb25QYXRocy5ub2RlSW5mb0xpc3QuZmluZChub2RlID0+IG5vZGUuYWN0aXZpdHlEZWZpbml0aW9uSWQgPT09IG5vZGVJZCk7XHJcbiAgICAgIGlmIChub2RlKSB7XHJcbiAgICAgICAgdGhpcy5hc3NpZ25JbmZvcy5wdXNoKHtcclxuICAgICAgICAgIHNlbGVjdGVkQXNzaWduZWVzOiBub2RlLnNlbGVjdGVkQXNzaWduZWVzLFxyXG4gICAgICAgICAgYXNzaWduZWVJbmZvOiBub2RlLmFzc2lnbmVlSW5mbyxcclxuICAgICAgICAgIGFzc2lnbmVlczogbm9kZS5zZWxlY3RlZEFzc2lnbmVlcy5tYXAodXNlciA9PiB7IHJldHVybiB7IGlkOiB1c2VyLmlkLCBuYW1lOiB1c2VyLm5hbWUgfSB9KSxcclxuICAgICAgICAgIGFjdGl2aXR5RGVmaW5pdGlvbk5hbWU6IG5vZGUuYWN0aXZpdHlEZWZpbml0aW9uTmFtZSxcclxuICAgICAgICAgIGFjdGl2aXR5RGVmaW5pdGlvbklkOiBub2RlLmFjdGl2aXR5RGVmaW5pdGlvbklkLFxyXG4gICAgICAgICAgZGVwZW5kZW5jeTogbm9kZS5kZXBlbmRlbmN5LFxyXG4gICAgICAgICAgYW5vbnltb3VzOiBub2RlLmFub255bW91cyxcclxuICAgICAgICAgIGFub255bW91c1RleHQ6IG5vZGUuYW5vbnltb3VzVGV4dCxcclxuICAgICAgICAgIHJlc29sdmVkOiBub2RlLnJlc29sdmVkXHJcbiAgICAgICAgfSlcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICB0aGlzLmFzc2lnbkluZm9zLnB1c2goe1xyXG4gICAgICAgICAgc2VsZWN0ZWRBc3NpZ25lZXM6IFtdLFxyXG4gICAgICAgICAgYXNzaWduZWVJbmZvOiBudWxsLFxyXG4gICAgICAgICAgYXNzaWduZWVzOiBbXSxcclxuICAgICAgICAgIGFjdGl2aXR5RGVmaW5pdGlvbk5hbWU6ICcnLFxyXG4gICAgICAgICAgYWN0aXZpdHlEZWZpbml0aW9uSWQ6ICcnLFxyXG4gICAgICAgICAgZGVwZW5kZW5jeTogJycsXHJcbiAgICAgICAgICBhbm9ueW1vdXM6IGZhbHNlLFxyXG4gICAgICAgICAgYW5vbnltb3VzVGV4dDogJycsXHJcbiAgICAgICAgICByZXNvbHZlZDogZmFsc2UsXHJcbiAgICAgICAgfSlcclxuICAgICAgfVxyXG4gICAgfSlcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOiuvue9ruWFtuS7luiKgueCueaMh+a0vlxyXG4gICAqIEBwYXJhbSByZXNwb25zZSBcclxuICAgKi9cclxuICBwcml2YXRlIHNldE90aGVyQXNzaWduSW5mbyhyZXNwb25zZTogU2ltdWxhdGVSZXNwb25zZSkge1xyXG4gICAgdGhpcy5vdGhlckFzc2lnbkluZm9zID0gW107XHJcbiAgICBsZXQgdG1wT3RoZXJBc3NpZ25JbmZvcyA9IFtdO1xyXG4gICAgbGV0IG90aGVyQXNzaWduTm9kZXMgPSByZXNwb25zZS5vdGhlckFzc2lnbk5vZGVzO1xyXG4gICAgaWYgKG90aGVyQXNzaWduTm9kZXMgJiYgb3RoZXJBc3NpZ25Ob2Rlcy5sZW5ndGgpIHtcclxuICAgICAgb3RoZXJBc3NpZ25Ob2Rlcy5mb3JFYWNoKG5vZGUgPT4ge1xyXG4gICAgICAgIHRtcE90aGVyQXNzaWduSW5mb3MucHVzaCh7XHJcbiAgICAgICAgICBzZWxlY3RlZEFzc2lnbmVlczogbm9kZS5zZWxlY3RlZEFzc2lnbmVlcyxcclxuICAgICAgICAgIGFzc2lnbmVlSW5mbzogbm9kZS5hc3NpZ25lZUluZm8sXHJcbiAgICAgICAgICBhc3NpZ25lZXM6IG5vZGUuc2VsZWN0ZWRBc3NpZ25lZXMubWFwKHVzZXIgPT4geyByZXR1cm4geyBpZDogdXNlci5pZCwgbmFtZTogdXNlci5uYW1lIH0gfSksXHJcbiAgICAgICAgICBhY3Rpdml0eURlZmluaXRpb25OYW1lOiBub2RlLmFjdGl2aXR5RGVmaW5pdGlvbk5hbWUsXHJcbiAgICAgICAgICBhY3Rpdml0eURlZmluaXRpb25JZDogbm9kZS5hY3Rpdml0eURlZmluaXRpb25JZCxcclxuICAgICAgICAgIGRlcGVuZGVuY3k6IG5vZGUuZGVwZW5kZW5jeSxcclxuICAgICAgICAgIGFub255bW91czogbm9kZS5hbm9ueW1vdXMsXHJcbiAgICAgICAgICBhbm9ueW1vdXNUZXh0OiBub2RlLmFub255bW91c1RleHQsXHJcbiAgICAgICAgICByZXNvbHZlZDogbm9kZS5yZXNvbHZlZFxyXG4gICAgICAgIH0pXHJcbiAgICAgIH0pXHJcbiAgICAgIC8v5YW25LuW6IqC54K55LiO5LiL5LiA6IqC54K55Y676YeNXHJcbiAgICAgIGlmICh0aGlzLmFzc2lnbkluZm9zICYmIHRoaXMuYXNzaWduSW5mb3MubGVuZ3RoKSB7XHJcbiAgICAgICAgdG1wT3RoZXJBc3NpZ25JbmZvcyA9IHRtcE90aGVyQXNzaWduSW5mb3MuZmlsdGVyKGEgPT4gdGhpcy5hc3NpZ25JbmZvcy5maW5kSW5kZXgoYiA9PiBiLmFjdGl2aXR5RGVmaW5pdGlvbklkID09IGEuYWN0aXZpdHlEZWZpbml0aW9uSWQpIDwgMCk7XHJcbiAgICAgIH1cclxuICAgICAgdGhpcy5vdGhlckFzc2lnbkluZm9zID0gdG1wT3RoZXJBc3NpZ25JbmZvcztcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOa4heepuuW9k+WJjeaMh+a0vuS/oeaBr+W4ruWKqeWPguaVsFxyXG4gICAqL1xyXG4gIHByaXZhdGUgY2xlYXJBc3NpZ25JbmZvcygpIHtcclxuICAgIHRoaXMuYXNzaWduSW5mb3MgPSBbe1xyXG4gICAgICBzZWxlY3RlZEFzc2lnbmVlczogW10sXHJcbiAgICAgIGFzc2lnbmVlSW5mbzogbnVsbCxcclxuICAgICAgYXNzaWduZWVzOiBbXSxcclxuICAgICAgYWN0aXZpdHlEZWZpbml0aW9uTmFtZTogJycsXHJcbiAgICAgIGFjdGl2aXR5RGVmaW5pdGlvbklkOiAnJyxcclxuICAgICAgZGVwZW5kZW5jeTogJycsXHJcbiAgICAgIGFub255bW91czogZmFsc2UsXHJcbiAgICAgIGFub255bW91c1RleHQ6ICcnLFxyXG4gICAgICByZXNvbHZlZDogZmFsc2UsXHJcbiAgICB9XTtcclxuICAgIHRoaXMub3RoZXJBc3NpZ25JbmZvcyA9IFtdO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog6I635Y+W5rWP6KeI5Zmo57yT5a2Y77yM5LiK5qyh5rWB56iL6YCJ5oup55qE57uT5p6cXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBnZXRTZWxlY3RlZFByb2Nlc3NDYWNoZShwcm9jZXNzQ2F0ZWdvcnlJZDogc3RyaW5nKSB7XHJcbiAgICBsZXQgYnJvd3NlckNhY2hlID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbShcImdzcFdmU3RhcnRQcm9jZXNzXCIpKSBhcyBTdGFydFByb2Nlc3NDYWNoZTtcclxuICAgIGlmIChicm93c2VyQ2FjaGUgJiYgYnJvd3NlckNhY2hlLnNlbGVjdGVkUHJvY2Vzc0xpc3QpIHtcclxuICAgICAgcmV0dXJuIGJyb3dzZXJDYWNoZS5zZWxlY3RlZFByb2Nlc3NMaXN0LmZpbmQoYSA9PiBhLnByb2Nlc3NDYXRlZ29yeSA9PSBwcm9jZXNzQ2F0ZWdvcnlJZCk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gdW5kZWZpbmVkO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog5rWP6KeI5Zmo57yT5a2Y6K6w5LiL5rWB56iL6YCJ5oup55qE57uT5p6cXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBzZXRTZWxlY3RlZFByb2Nlc3NDYWNoZSgpIHtcclxuICAgIGNvbnN0IHByb2Nlc3NDYXRlZ29yeUlkID0gdGhpcy5wYXlsb2FkLmJpekRlZktleTtcclxuICAgIGNvbnN0IHByb2Nlc3NEZWZpbml0aW9uSWQgPSB0aGlzLnBheWxvYWQucHJvY2Vzc0RlZmluaXRpb25JZDtcclxuICAgIGxldCBwcm9jZXNzID0gdGhpcy5kZXN0UHJvY2Vzc2VzLmZpbmQoYSA9PiBhLmlkID09IHByb2Nlc3NEZWZpbml0aW9uSWQpO1xyXG4gICAgY29uc3QgcHJvY2Vzc0RlZmluaXRpb25OYW1lID0gcHJvY2VzcyAmJiBwcm9jZXNzLm5hbWU7XHJcblxyXG4gICAgbGV0IGJyb3dzZXJDYWNoZSA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oXCJnc3BXZlN0YXJ0UHJvY2Vzc1wiKSkgYXMgU3RhcnRQcm9jZXNzQ2FjaGU7XHJcbiAgICBpZiAoYnJvd3NlckNhY2hlICYmIGJyb3dzZXJDYWNoZS5zZWxlY3RlZFByb2Nlc3NMaXN0KSB7XHJcbiAgICAgIGxldCBzZWxlY3RlZFByb2Nlc3NMaXN0ID0gYnJvd3NlckNhY2hlLnNlbGVjdGVkUHJvY2Vzc0xpc3Q7XHJcbiAgICAgIGlmIChzZWxlY3RlZFByb2Nlc3NMaXN0LmZpbmRJbmRleChhID0+IGEucHJvY2Vzc0NhdGVnb3J5ID09IHByb2Nlc3NDYXRlZ29yeUlkKSA+IC0xKSB7XHJcbiAgICAgICAgc2VsZWN0ZWRQcm9jZXNzTGlzdC5tYXAoaXRlbSA9PiB7XHJcbiAgICAgICAgICBpZiAoaXRlbS5wcm9jZXNzQ2F0ZWdvcnkgPT0gcHJvY2Vzc0NhdGVnb3J5SWQpIHtcclxuICAgICAgICAgICAgaXRlbS5wcm9jZXNzRGVmaW5pdGlvbklkID0gcHJvY2Vzc0RlZmluaXRpb25JZDtcclxuICAgICAgICAgICAgaXRlbS5wcm9jZXNzRGVmaW5pdGlvbk5hbWUgPSBwcm9jZXNzRGVmaW5pdGlvbk5hbWU7XHJcbiAgICAgICAgICAgIGl0ZW0ubG9nVGltZSA9IG5ldyBEYXRlKCk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgYnJvd3NlckNhY2hlLnNlbGVjdGVkUHJvY2Vzc0xpc3QgPSBzZWxlY3RlZFByb2Nlc3NMaXN0O1xyXG4gICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKFwiZ3NwV2ZTdGFydFByb2Nlc3NcIiwgSlNPTi5zdHJpbmdpZnkoYnJvd3NlckNhY2hlKSk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgbGV0IGl0ZW0gPSBuZXcgU2VsZWN0ZWRQcm9jZXNzSXRlbShwcm9jZXNzQ2F0ZWdvcnlJZCwgcHJvY2Vzc0RlZmluaXRpb25JZCwgcHJvY2Vzc0RlZmluaXRpb25OYW1lKTtcclxuICAgICAgICBzZWxlY3RlZFByb2Nlc3NMaXN0LnB1c2goaXRlbSk7XHJcbiAgICAgICAgYnJvd3NlckNhY2hlLnNlbGVjdGVkUHJvY2Vzc0xpc3QgPSBzZWxlY3RlZFByb2Nlc3NMaXN0O1xyXG4gICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKFwiZ3NwV2ZTdGFydFByb2Nlc3NcIiwgSlNPTi5zdHJpbmdpZnkoYnJvd3NlckNhY2hlKSk7XHJcbiAgICAgIH1cclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGxldCBicm93c2VyQ2FjaGUgPSBuZXcgU3RhcnRQcm9jZXNzQ2FjaGUoKTtcclxuICAgICAgbGV0IHNlbGVjdGVkUHJvY2Vzc0xpc3QgPSBbXTtcclxuICAgICAgbGV0IGl0ZW0gPSBuZXcgU2VsZWN0ZWRQcm9jZXNzSXRlbShwcm9jZXNzQ2F0ZWdvcnlJZCwgcHJvY2Vzc0RlZmluaXRpb25JZCwgcHJvY2Vzc0RlZmluaXRpb25OYW1lKTtcclxuICAgICAgc2VsZWN0ZWRQcm9jZXNzTGlzdC5wdXNoKGl0ZW0pO1xyXG4gICAgICBicm93c2VyQ2FjaGUuc2VsZWN0ZWRQcm9jZXNzTGlzdCA9IHNlbGVjdGVkUHJvY2Vzc0xpc3Q7XHJcbiAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKFwiZ3NwV2ZTdGFydFByb2Nlc3NcIiwgSlNPTi5zdHJpbmdpZnkoYnJvd3NlckNhY2hlKSk7XHJcblxyXG4gICAgfVxyXG5cclxuICB9XHJcblxyXG59XHJcbiJdfQ==