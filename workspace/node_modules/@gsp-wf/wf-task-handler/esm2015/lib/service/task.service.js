/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Injectable } from '@angular/core';
import { HttpService } from '@ecp-caf/caf-common';
import { forkJoin, Subject } from 'rxjs';
import { MessagerService } from '@farris/ui-messager';
export class TaskService {
    /**
     * @param {?} httpSvc
     * @param {?} message
     */
    constructor(httpSvc, message) {
        this.httpSvc = httpSvc;
        this.message = message;
    }
    /**
     * @param {?} ids
     * @return {?}
     */
    getUsersByIds(ids) {
        /** @type {?} */
        var pathUrl = '/api/runtime/sys/v1.0/users';
        return forkJoin(ids.map((/**
         * @param {?} id
         * @return {?}
         */
        id => this.httpSvc.get(pathUrl + `/${id}` + `?mode=0002`))));
    }
    /**
     * 获取工作项操作列表
     * @param {?} workItemId
     * @return {?}
     */
    getWorkItemActions(workItemId) {
        /** @type {?} */
        const url = `/api/runtime/wf/v1.0/workItems/${workItemId}/actions`;
        return this.httpSvc.get(url);
    }
    /**
     * 执行审批操作
     * @param {?} context 执行审批上下文
     * @return {?}
     */
    complete(context) {
        /** @type {?} */
        const url = `/api/runtime/wf/v1.0/workItems/complete`;
        return this.httpSvc.post(url, context);
    }
    /**
     * 执行审批预解析
     * @param {?} context 执行审批上下文
     * @return {?}
     */
    completeSimulate(context) {
        /** @type {?} */
        const url = `/api/runtime/wf/v1.0/workItems/complete-simulation`;
        return this.httpSvc.post(url, context);
    }
    /**
     * 获取跳转活动信息
     * @param {?} workItemId 工作项Id
     * @param {?} action 动作编号
     * @return {?}
     */
    getDestinationScope(workItemId, action) {
        /** @type {?} */
        const url = `/api/runtime/wf/v1.0/workItems/${workItemId}/nextNodes/${action}`;
        return this.httpSvc.get(url);
    }
    /**
     * 根据节点ID获取指定参与者的结果
     * @param {?} workItemId
     * @param {?} nodeId 说明：nodeIds=["node1","node2",···]
     * @return {?} 指派信息的数组 re: FlowNodeInfo[]
     */
    getSimulationAssigneeInfo(workItemId, nodeId) {
        /** @type {?} */
        const url = `/api/runtime/wf/v1.0/workItems/${workItemId}/simulation-assigneeInfo?nodeIds=[${nodeId}]`;
        return this.httpSvc.get(url);
    }
    /**
     * 执行征询、知会
     * @param {?} context 上下文
     * @return {?}
     */
    addSign(context) {
        /** @type {?} */
        const url = `/api/runtime/wf/v1.0/workItems/counterSignAdd`;
        return this.httpSvc.post(url, context);
    }
    /**
     * 已阅
     * @param {?} context 参数
     * @return {?}
     */
    readTask(context) {
        /** @type {?} */
        const url = `/api/runtime/wf/v1.0/workItems/read`;
        return this.httpSvc.post(url, context);
    }
    /**
     * 查询单据信息（方法名不要动，其他地方有引用）
     * @param {?} workItemId 工作项Id
     * @return {?}
     */
    getTaskFormInfo(workItemId) {
        /** @type {?} */
        let subject = new Subject();
        /** @type {?} */
        let cacheCode = "gspWfTaskFormInfo" + workItemId;
        /** @type {?} */
        const taskForm = localStorage.getItem(cacheCode);
        if (taskForm) {
            setTimeout((/**
             * @return {?}
             */
            () => {
                subject.next(JSON.parse(taskForm));
            }), 10);
        }
        else {
            /** @type {?} */
            const formParUrl = `/api/runtime/wf/v1.0/workItems/${workItemId}/formInfo`;
            this.httpSvc.get(formParUrl).subscribe((/**
             * @param {?} re
             * @return {?}
             */
            re => {
                subject.next(re);
                localStorage.setItem(cacheCode, JSON.stringify(re));
            }), (/**
             * @param {?} error
             * @return {?}
             */
            error => {
                subject.error(error);
            }));
        }
        return subject.asObservable();
    }
    /**
     * 获取指派信息
     * @param {?} taskId 工作项Id
     * 此接口只返回一个AssignInfo类序列化后的信息，不是多个
     * @return {?}
     */
    getAssigneeInfo(taskId) {
        /** @type {?} */
        const url = `/api/runtime/wf/v1.0/workItems/${taskId}/assigneeInfo`;
        return this.httpSvc.get(url);
    }
    /**
     * 获取加签移交范围设置
     * @param {?} workItemId
     * @param {?} actionCode
     * @return {?}
     */
    getOrganizationScope(workItemId, actionCode) {
        /** @type {?} */
        const url = `/api/runtime/wf/v1.0/workItems/${workItemId}/organizationScope/${actionCode}`;
        return this.httpSvc.get(url);
    }
    /**
     * 根据流程实例ID和任务状态办理任务
     * @param {?} procInstId 流程实例id
     * @param {?} state 任务状态 2或5
     * @return {?}
     */
    getTaskByProcInstId(procInstId, state) {
        /** @type {?} */
        const url = `/api/runtime/task/v1.0/tasks/processInstanceId?procInstId=${procInstId}&state=${state}`;
        return this.httpSvc.get(url);
    }
    /**
     * 根据workitemID获取任务实体
     * @param {?} workItemId
     * @return {?}
     */
    getTaskByWorkItemId(workItemId) {
        /** @type {?} */
        const url = `/api/runtime/task/v1.0/tasks/sourceId/${workItemId}`;
        return this.httpSvc.get(url);
    }
    /**
     * 根据工作项ID指派任务
     * @param {?} assigneesPa 指派参数
     * @return {?}
     */
    assignNextUsersByWorkItemId(assigneesPa) {
        /** @type {?} */
        const url = `/api/runtime/wf/v1.0/workItems/assignUser`;
        return this.httpSvc.post(url, assigneesPa);
    }
    /**
     * 取回
     * @param {?} context
     * @return {?}
     */
    retrieve(context) {
        /** @type {?} */
        const url = `/api/runtime/wf/v1.0/workItems/retrieve`;
        return this.httpSvc.post(url, context);
    }
    /**
     * 任务移交
     * @param {?} transferContext
     * @return {?}
     */
    transfer(transferContext) {
        /** @type {?} */
        const url = `/api/runtime/wf/v1.0/workItems/transfer`;
        return this.httpSvc.post(url, transferContext);
    }
    /**
     * 任务评论
     * @param {?} commentContext
     * @return {?}
     */
    comment(commentContext) {
        /** @type {?} */
        const url = `/api/runtime/wf/v1.0/workItems/comment`;
        return this.httpSvc.post(url, commentContext);
    }
    /**
     * 领用任务
     * @param {?} taskId 工作项Id
     * @param {?} comment
     * @return {?}
     */
    claim(taskId, comment) {
        /** @type {?} */
        const url = `/api/runtime/wf/v1.0/workItems/claim`;
        /** @type {?} */
        const options = {
            workItemId: taskId,
            comment: comment
        };
        return this.httpSvc.post(url, options);
    }
    /**
     * 取消领用
     * @param {?} taskId 任务Id
     * @param {?} comment
     * @return {?}
     */
    unClaim(taskId, comment) {
        /** @type {?} */
        const url = `/api/runtime/wf/v1.0/workItems/unclaim`;
        /** @type {?} */
        const options = {
            workItemId: taskId,
            comment: comment
        };
        return this.httpSvc.post(url, options);
    }
    /**
     * 报错提示
     * @param {?} error
     * @return {?}
     */
    error(error) {
        if (error && error.error && error.error.Message) {
            /** @type {?} */
            var message = error.error.Message;
            this.message.show('warning', message, { safeHtml: false });
        }
    }
    /**
     * 启动流程接口
     * @param {?} payload API所需的上下文参数
     * @return {?}
     */
    startProcess(payload) {
        /** @type {?} */
        const url = `/api/runtime/wf/v1.0/processInstances/startProcess`;
        return this.httpSvc.post(url, payload);
    }
    /**
     * 启动流程预解析
     * @param {?} payload API所需的上下文参数
     * @return {?}
     */
    startProcessSimulate(payload) {
        /** @type {?} */
        const url = `/api/runtime/wf/v1.0/processInstances/startProcess-simulation`;
        return this.httpSvc.post(url, payload);
    }
    /**
     * 取消提交
     * @param {?} param 参数
     * @return {?}
     */
    cancelSubmit(param) {
        /** @type {?} */
        const url = `/api/runtime/wf/v1.0/processInstances/cancelSubmit`;
        return this.httpSvc.post(url, param);
    }
    /**
     * @return {?}
     */
    static newId() {
        /** @type {?} */
        const S4 = (/**
         * @return {?}
         */
        () => (((1 + Math.random()) * 0x10000) | 0).toString(16).substring(1));
        return (S4() + S4() + '-' + S4() + '-' + S4() + '-' + S4() + '-' + S4() + S4() + S4());
    }
    /**
     * 获取用户常用意见列表
     * @param {?=} filter
     * @return {?}
     */
    getCommentList(filter) {
        /** @type {?} */
        let url = `/api/runtime/wf/v1.0/commonComments`;
        filter && filter.type && (url += `?type=${filter.type}`);
        return this.httpSvc.get(url);
    }
    /**
     * 添加常用意见
     * @param {?} comment
     * @return {?}
     */
    addComment(comment) {
        /** @type {?} */
        const url = `/api/runtime/wf/v1.0/commonComments`;
        return this.httpSvc.post(url, comment);
    }
    /**
     * 删除一条常用意见
     * @param {?} id 常用意见id
     * @return {?}
     */
    deleteComment(id) {
        /** @type {?} */
        const url = `/api/runtime/wf/v1.0/commonComments/${id}`;
        return this.httpSvc.delete(url, null);
    }
    /**
     * 获取任务中心配置项
     * @param {?} code 配置项的Code
     * @param {?=} ownerType
     * @param {?=} ownerId
     * @return {?}
     */
    getTaskCenterConfigByCode(code, ownerType, ownerId) {
        /** @type {?} */
        let url = `/api/runtime/task/v1.0/task-center-setting/code?code=${code}`;
        ownerType && (url += `&ownerType=${ownerType}`);
        ownerId && (url += `&ownerId=${ownerId}`);
        return this.httpSvc.get(url);
    }
    /**
     * 获取系统级别配置（缓存为一天）
     * @return {?}
     */
    getAllTaskCenterConfig() {
        /** @type {?} */
        let subject = new Subject();
        /** @type {?} */
        let code = "gspWfTaskAllConfig";
        /** @type {?} */
        let todayCode = code + this.getCurrentDateString();
        /** @type {?} */
        let configStr = localStorage.getItem(todayCode);
        if (configStr) {
            setTimeout((/**
             * @return {?}
             */
            () => {
                subject.next(JSON.parse(configStr));
            }), 10);
        }
        else {
            /** @type {?} */
            let url = `/api/runtime/task/v1.0/task-center-setting/all?ownerType=all&ownerId=*`;
            this.httpSvc.get(url).subscribe((/**
             * @param {?} re
             * @return {?}
             */
            re => {
                localStorage.setItem(todayCode, JSON.stringify(re));
                subject.next(re);
                this.removeConfig(code);
            }), (/**
             * @param {?} error
             * @return {?}
             */
            error => {
                subject.error(error);
            }));
        }
        return subject.asObservable();
    }
    /**
     * 获取任务分类级别配置
     * @param {?} categoryId
     * @return {?}
     */
    getTaskCategoryCenterConfig(categoryId) {
        /** @type {?} */
        let subject = new Subject();
        /** @type {?} */
        let code = "gspWfTaskCategoryConfig" + categoryId;
        /** @type {?} */
        let todayCode = code + this.getCurrentDateString();
        /** @type {?} */
        let configStr = localStorage.getItem(todayCode);
        if (configStr) {
            setTimeout((/**
             * @return {?}
             */
            () => {
                subject.next(JSON.parse(configStr));
            }), 10);
        }
        else {
            /** @type {?} */
            let url = `/api/runtime/task/v1.0/task-center-setting/all`;
            url += `?ownerType=category&ownerId=${categoryId}`;
            this.httpSvc.get(url).subscribe((/**
             * @param {?} re
             * @return {?}
             */
            re => {
                localStorage.setItem(todayCode, JSON.stringify(re));
                subject.next(re);
                this.removeConfig(code);
            }), (/**
             * @param {?} error
             * @return {?}
             */
            error => {
                subject.error(error);
            }));
        }
        return subject.asObservable();
    }
    /**
     * 获取任务中心个人用户配置（缓存为一天）
     * @return {?}
     */
    getAllUserConfig() {
        /** @type {?} */
        let subject = new Subject();
        /** @type {?} */
        let code = "gspWfTaskUserConfig";
        /** @type {?} */
        let todayCode = code + this.getCurrentDateString();
        /** @type {?} */
        let configStr = localStorage.getItem(todayCode);
        if (configStr) {
            setTimeout((/**
             * @return {?}
             */
            () => {
                subject.next(JSON.parse(configStr));
            }), 10);
        }
        else {
            /** @type {?} */
            let url = `/api/runtime/task/v1.0/task-center-setting/all`;
            this.httpSvc.get(url).subscribe((/**
             * @param {?} re
             * @return {?}
             */
            re => {
                localStorage.setItem(todayCode, JSON.stringify(re));
                this.removeConfig(code);
                subject.next(re);
            }), (/**
             * @param {?} error
             * @return {?}
             */
            error => {
                subject.error(error);
            }));
        }
        return subject.asObservable();
    }
    /**
     * 添加用户级别自定义配置
     * @param {?} code 配置项编号
     * @param {?} currentValue
     * @return {?}
     */
    addUserConfig(code, currentValue) {
        /** @type {?} */
        let configCode = "gspWfTaskUserConfig";
        /** @type {?} */
        let todayCode = configCode + this.getCurrentDateString();
        /** @type {?} */
        let configStr = localStorage.getItem(todayCode);
        if (configStr) {
            /** @type {?} */
            let list = JSON.parse(configStr);
            if (list && list.length) {
                /** @type {?} */
                let item = ((/** @type {?} */ (list))).find((/**
                 * @param {?} l
                 * @return {?}
                 */
                l => l.configCode == code));
                if (item) {
                    item.currentValue = currentValue;
                    localStorage.setItem(todayCode, JSON.stringify(list));
                }
            }
        }
        /** @type {?} */
        let url = `/api/runtime/task/v1.0/task-center-setting/add?configCode=${code}&currentValue=${currentValue}`;
        return this.httpSvc.post(url, null);
    }
    /**
     * 获取用户头像（已被任务中心调用）
     * @param {?} userId 用户ID
     * @return {?}
     */
    getUserAvatar(userId) {
        /** @type {?} */
        let subject = new Subject();
        /** @type {?} */
        let code = "gspWfTaskUserAvatar";
        /** @type {?} */
        let todayCode = code + this.getCurrentDateString();
        /** @type {?} */
        let todayUserCode = todayCode + userId;
        /** @type {?} */
        let avatarStr = localStorage.getItem(todayUserCode);
        if (avatarStr) {
            setTimeout((/**
             * @return {?}
             */
            () => {
                subject.next(JSON.parse(avatarStr));
            }), 100);
        }
        else {
            /** @type {?} */
            const url = `/api/runtime/sys/v1.0/userinfos/setting/users?userId=${userId}`;
            this.httpSvc.get(url).subscribe((/**
             * @param {?} re
             * @return {?}
             */
            re => {
                subject.next(re);
                localStorage.setItem(todayUserCode, JSON.stringify(re));
                this.removeConfig(code);
            }));
        }
        return subject.asObservable();
    }
    /**
     * 获取当前日期
     * @return {?}
     */
    getCurrentDateString() {
        /** @type {?} */
        let date = new Date();
        /** @type {?} */
        let year = date.getFullYear().toString();
        /** @type {?} */
        let month = (date.getMonth() + 1).toString();
        /** @type {?} */
        let day = date.getDate().toString();
        return year + month + day;
    }
    /**
     * 移除localStorage缓存
     * @private
     * @param {?} key
     * @return {?}
     */
    removeConfig(key) {
        /** @type {?} */
        let todayKey = key + this.getCurrentDateString();
        for (let item in localStorage) {
            if (item.indexOf(key) > -1 && item.indexOf(todayKey) < 0) {
                localStorage.removeItem(item);
            }
        }
    }
    /**
     * 真正上传附件
     * @param {?} files
     * @return {?}
     */
    uploadAttachment(files) {
        /** @type {?} */
        let url = `/api/runtime/dfs/v1.0/doc/commit`;
        return this.httpSvc.put(url, files);
    }
    /**
     * 删除附件
     * @param {?} fileDeleteEntity
     * @return {?}
     */
    deleteAttachment(fileDeleteEntity) {
        /** @type {?} */
        let url = `/api/runtime/dfs/v1.0/doc`;
        return this.httpSvc.delete(url, fileDeleteEntity);
    }
    /**
     * 创建内码
     * @return {?}
     */
    createNM() {
        return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, (/**
         * @param {?} c
         * @return {?}
         */
        function (c) {
            /** @type {?} */
            const r = Math.random() * 16 | 0;
            /** @type {?} */
            const v = c === 'x' ? r : (r & 0x3 | 0x8);
            return v.toString(16);
        }));
    }
    /**
     * 获取当前用户信息
     * @return {?}
     */
    getUserInfo() {
        /** @type {?} */
        let url = `/api/runtime/sys/v1.0/userinfos?infoType=user`;
        return this.httpSvc.get(url);
    }
    /**
     * 获取用户所有签名
     * @param {?} userId
     * @return {?}
     */
    getUserSignId(userId) {
        /** @type {?} */
        let subject = new Subject();
        /** @type {?} */
        let code = 'gspWfTaskUserSign' + userId;
        /** @type {?} */
        let todayCode = code + this.getCurrentDateString();
        /** @type {?} */
        let signId = localStorage.getItem(todayCode);
        if (signId) {
            setTimeout((/**
             * @return {?}
             */
            () => {
                subject.next(signId);
            }), 100);
        }
        else {
            /** @type {?} */
            let url = `/api/runtime/dfs/v1.0/formdoc/fileinfo/form?formid=${userId}&rootid=taskcentersignature`;
            this.httpSvc.get(url).subscribe((/**
             * @param {?} result
             * @return {?}
             */
            (result) => {
                if (result && result.length) {
                    /** @type {?} */
                    var sign;
                    if (result.length == 1) {
                        sign = result[0];
                    }
                    else {
                        /** @type {?} */
                        const list = result.filter((/**
                         * @param {?} a
                         * @return {?}
                         */
                        a => a && a.lastModifiedTime));
                        sign = list.reduce((/**
                         * @param {?} a
                         * @param {?} b
                         * @return {?}
                         */
                        function (a, b) {
                            return a.lastModifiedTime > b.lastModifiedTime ? a : b;
                        }));
                    }
                    subject.next(sign.id);
                    localStorage.setItem(todayCode, sign.id);
                    this.removeConfig(code);
                }
                else {
                    subject.next('');
                }
            }), (/**
             * @param {?} error
             * @return {?}
             */
            error => {
                subject.error(error);
            }));
        }
        return subject.asObservable();
    }
    /**
     * 上传签名，返回长传后的签名id
     * @param {?} gspDocUploadEntity
     * @return {?}
     */
    uploadSignature(gspDocUploadEntity) {
        /** @type {?} */
        let url = `/api/runtime/dfs/v1.0/doc`;
        /** @type {?} */
        let header = this.httpSvc.setHeader({
            body: gspDocUploadEntity,
            responseType: 'text'
        });
        return this.httpSvc.request('Post', url, header);
    }
    /**
     * 解析文件类型，给出缩略图
     * @param {?} attachmentInfo
     * @return {?}
     */
    createItem(attachmentInfo) {
        /** @type {?} */
        var pos = attachmentInfo.fileName.lastIndexOf(".");
        /** @type {?} */
        var type = attachmentInfo.fileName.substring(pos + 1);
        type = (type == '' ? 'Default' : type.toLowerCase());
        /** @type {?} */
        var docLib = 'doc-docx-htm-html-js-pdf-ppt-pptx-rar-zip-txt-xls-xlsx';
        /** @type {?} */
        var videoLib = 'wav-aif-aiff-au-mp1-mp2-mp3-ra-rm-ram-mid-rmi';
        /** @type {?} */
        var audioLib = 'avi-rm-rmvb-mpeg-mpg-dat-mov-qt-asf-wm-mp4';
        /** @type {?} */
        var imgLib = 'webp-baibmp-dupcx-tif-gif-jpeg-tga-exif-fpx-svg-psd-cdr-pcd-dxf-ufo-eps-ai-png-hdri-raw-wmf-flic-emf-ico-jpg';
        if (docLib.indexOf(type) >= 0) {
            type = type.toLowerCase();
        }
        else if (videoLib.indexOf(type) >= 0) {
            type = 'video';
        }
        else if (audioLib.indexOf(type) >= 0) {
            type = 'audio';
        }
        else if (imgLib.indexOf(type) >= 0) {
            type = 'picture';
        }
        else {
            type = 'default';
        }
        return type;
    }
    /**
     * 注册主题，并获取当前主题唯一标识token
     * @param {?} subjectCode 主题编码，非唯一标识，token为唯一标识
     * @param {?} token 主题唯一标识。
     * @return {?} 主题的唯一标识。
     */
    subjectRegister(subjectCode, token) {
        return ((/** @type {?} */ (window))).gspframeworkService.rtf.broadcast.subjectRegister(subjectCode, { funcId: token });
    }
    /**
     * 监听移除
     * @param {?} token
     * @return {?}
     */
    subjectRemove(token) {
        ((/** @type {?} */ (window))).gspframeworkService.rtf.broadcast.subjectRemove(token);
    }
    /**
     * 通过某个token发送消息
     * @param {?} subjectToken 主题唯一的token标识
     * @param {?} message 要发送的消息
     * @return {?}
     */
    subjectNotify(subjectToken, message) {
        ((/** @type {?} */ (window))).gspframeworkService.rtf.broadcast.notify(subjectToken, message);
    }
    /**
     * 添加观察者，并监听消息
     * @param {?} subjectToken 主题token
     * @param {?} observerToken 当前监听主题的观察者唯一标识token。此处固定
     * @param {?} handler 监听到消息后执行的动作
     * @return {?}
     */
    subjectResponse(subjectToken, observerToken, handler) {
        ((/** @type {?} */ (window))).gspframeworkService.rtf.broadcast.response(subjectToken, observerToken, handler);
    }
    /**
     * 获取催办模拟结果
     * @param {?} context 参数
     * @return {?}
     */
    urgeHandleSimulate(context) {
        /** @type {?} */
        let url = `/api/runtime/wf/v1.0/processInstances/getUrgeHandleInfo`;
        return this.httpSvc.post(url, context);
    }
    /**
     * 执行催办
     * @param {?} context 参数
     * @return {?}
     */
    urgeHandle(context) {
        /** @type {?} */
        let url = `/api/runtime/wf/v1.0/processInstances/urgeHandle`;
        return this.httpSvc.post(url, context);
    }
    /**
     * 批量数字签名
     * @param {?} context 参数
     * @return {?}
     */
    batchVerifySigned(context) {
        /** @type {?} */
        const url = `/api/runtime/wf/v1.0/workItems/batchVerifySigned`;
        return this.httpSvc.post(url, context);
    }
    /**
     * 获取用户帮助前端配置
     * @return {?}
     */
    getWfUserHelpConfig() {
        /** @type {?} */
        let date = new Date();
        /** @type {?} */
        let year = date.getFullYear();
        /** @type {?} */
        let month = date.getMonth() + 1;
        /** @type {?} */
        let day = date.getDate();
        /** @type {?} */
        const url = `/platform/runtime/wf/web/wf-user-help/config.json?v=` + year + month + day;
        return this.httpSvc.get(url);
    }
    /**
     * 获取加签配置
     * @param {?} workItemId
     * @return {?}
     */
    getAdhocConfig(workItemId) {
        /** @type {?} */
        let url = `/api/runtime/wf/v1.0/workItems/${workItemId}/adhocConfig/AddSignBehind`;
        return this.httpSvc.get(url);
    }
    /**
     * 加签提交
     * @param {?} payload
     * @return {?}
     */
    adhocAssignee(payload) {
        /** @type {?} */
        let url = `/api/runtime/wf/v1.0/workItems/adhocAssignee`;
        return this.httpSvc.post(url, payload);
    }
    /**
     * 取消征询
     * @param {?} payload
     * @return {?}
     */
    cancelConsult(payload) {
        /** @type {?} */
        let url = `/api/runtime/wf/v1.0/workItems/cancelConsult`;
        return this.httpSvc.post(url, payload);
    }
    /**
     * 判断是否inSuite环境
     * @return {?}
     */
    isInSuite() {
        /** @type {?} */
        const frameWorkService = ((/** @type {?} */ (window))).gspframeworkService;
        if (frameWorkService && frameWorkService.rtf) {
            /** @type {?} */
            const extendMethod = frameWorkService.rtf.extendMethod;
            if (extendMethod && extendMethod.getExtObj()) {
                /** @type {?} */
                var extObj = extendMethod.getExtObj();
                /** @type {?} */
                const mode = extObj.iGIX4inSuiteMode();
                if (mode) {
                    return true;
                }
            }
        }
        return false;
    }
    /**
     * 获取字符串字节长度
     * @param {?} str
     * @return {?}
     */
    getBytesLength(str) {
        // 在GBK编码里，除了ASCII字符，其它都占两个字符宽
        return str.replace(/[^\x00-\xff]/g, 'xx').length;
    }
    /**
     * 获取top window
     * @return {?}
     */
    getTopWindow() {
        /** @type {?} */
        let curWin = window.self;
        try {
            while (curWin.location.origin === curWin.parent.location.origin) {
                if (curWin !== curWin.parent && !((/** @type {?} */ (curWin))).isRTFTopWin) {
                    curWin = curWin.parent;
                }
                else {
                    break;
                }
            }
        }
        catch (e) { }
        return curWin;
    }
    /**
     * 弹出错误提示
     * @param {?} errorMessage
     * @return {?}
     */
    handleErrorLevel(errorMessage) {
        if (errorMessage && errorMessage.status < 500) {
            return;
        }
        /** @type {?} */
        let error = (/** @type {?} */ (errorMessage.error));
        /** @type {?} */
        const exceptionMsg = error.Message || '';
        /** @type {?} */
        const date = error.date || new Date();
        /** @type {?} */
        const localDate = date;
        /** @type {?} */
        const detail = error.Detail || `${error.Message}\r\n发生时间：${localDate}\r\n详细信息：${error.innerMessage}` || '';
        /** @type {?} */
        const innerMessage = error.innerMessage || null;
        /** @type {?} */
        let bsModalRef;
        /** @type {?} */
        const options = {
            showMaxButton: false,
            buttons: [
                {
                    text: '知道了',
                    cls: 'btn btn-primary btn-lg',
                    handle: (/**
                     * @return {?}
                     */
                    () => {
                        bsModalRef.close();
                    })
                }
            ],
            width: 440,
            height: 200,
            safeHtml: false,
            exception: {
                date: localDate,
                message: innerMessage,
                copyButton: {
                    text: '复制详细信息',
                    onClick: (/**
                     * @param {?} e
                     * @return {?}
                     */
                    (e) => {
                        /** @type {?} */
                        const result = this.copyToClipboard(detail);
                        bsModalRef.content.showMiniNotify(result, 1500);
                    })
                }
            }
        };
        bsModalRef = this.message.show('exception', exceptionMsg, options);
    }
    /**
     * 赋值到粘贴板
     * @private
     * @param {?} text
     * @return {?}
     */
    copyToClipboard(text) {
        /** @type {?} */
        const windowRef = window;
        if (windowRef.clipboardData && windowRef.clipboardData.setData) {
            return windowRef.clipboardData.setData("Text", text);
        }
        else if (document.queryCommandSupported && document.queryCommandSupported("copy")) {
            /** @type {?} */
            var textarea = document.createElement("textarea");
            textarea.textContent = text;
            textarea.style.position = "fixed";
            document.body.appendChild(textarea);
            textarea.select();
            try {
                return document.execCommand("copy");
            }
            catch (ex) {
                console.warn("Copy to clipboard failed.", ex);
            }
            finally {
                document.body.removeChild(textarea);
            }
        }
        return false;
    }
}
TaskService.decorators = [
    { type: Injectable }
];
/** @nocollapse */
TaskService.ctorParameters = () => [
    { type: HttpService },
    { type: MessagerService }
];
if (false) {
    /**
     * @type {?}
     * @private
     */
    TaskService.prototype.httpSvc;
    /**
     * @type {?}
     * @private
     */
    TaskService.prototype.message;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidGFzay5zZXJ2aWNlLmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGdzcC13Zi93Zi10YXNrLWhhbmRsZXIvIiwic291cmNlcyI6WyJsaWIvc2VydmljZS90YXNrLnNlcnZpY2UudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUFBLE9BQU8sRUFBRSxVQUFVLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFDM0MsT0FBTyxFQUFFLFdBQVcsRUFBRSxNQUFNLHFCQUFxQixDQUFDO0FBQ2xELE9BQU8sRUFBYyxRQUFRLEVBQUUsT0FBTyxFQUFFLE1BQU0sTUFBTSxDQUFDO0FBSXJELE9BQU8sRUFBRSxlQUFlLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQztBQWF0RCxNQUFNLE9BQU8sV0FBVzs7Ozs7SUFFcEIsWUFDWSxPQUFvQixFQUNwQixPQUF3QjtRQUR4QixZQUFPLEdBQVAsT0FBTyxDQUFhO1FBQ3BCLFlBQU8sR0FBUCxPQUFPLENBQWlCO0lBQ2hDLENBQUM7Ozs7O0lBRUwsYUFBYSxDQUFDLEdBQWE7O1lBQ25CLE9BQU8sR0FBRyw2QkFBNkI7UUFDM0MsT0FBTyxRQUFRLENBQUMsR0FBRyxDQUFDLEdBQUc7Ozs7UUFBQyxFQUFFLENBQUMsRUFBRSxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLE9BQU8sR0FBRyxJQUFJLEVBQUUsRUFBRSxHQUFHLFlBQVksQ0FBQyxFQUFDLENBQUMsQ0FBQztJQUN4RixDQUFDOzs7Ozs7SUFJRCxrQkFBa0IsQ0FBQyxVQUFrQjs7Y0FDM0IsR0FBRyxHQUFHLGtDQUFrQyxVQUFVLFVBQVU7UUFDbEUsT0FBTyxJQUFJLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsQ0FBQztJQUNqQyxDQUFDOzs7Ozs7SUFNRCxRQUFRLENBQUMsT0FBd0I7O2NBQ3ZCLEdBQUcsR0FBRyx5Q0FBeUM7UUFDckQsT0FBTyxJQUFJLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxHQUFHLEVBQUUsT0FBTyxDQUFDLENBQUM7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QVMsQ0FBQyxhQUFhLElBQUksU0FBUyxDQUFDLGFBQWEsQ0FBQyxPQUFPLEVBQUU7WUFDNUQsT0FBTyxTQUFTLENBQUMsYUFBYSxDQUFDLE9BQU8sQ0FBQyxNQUFNLEVBQUUsSUFBSSxDQUFDLENBQUM7U0FDeEQ7YUFBTSxJQUFJLFFBQVEsQ0FBQyxxQkFBcUIsSUFBSSxRQUFRLENBQUMscUJBQXFCLENBQUMsTUFBTSxDQUFDLEVBQUU7O2dCQUM3RSxRQUFRLEdBQUcsUUFBUSxDQUFDLGFBQWEsQ0FBQyxVQUFVLENBQUM7WUFDakQsUUFBUSxDQUFDLFdBQVcsR0FBRyxJQUFJLENBQUM7WUFDNUIsUUFBUSxDQUFDLEtBQUssQ0FBQyxRQUFRLEdBQUcsT0FBTyxDQUFDO1lBQ2xDLFFBQVEsQ0FBQyxJQUFJLENBQUMsV0FBVyxDQUFDLFFBQVEsQ0FBQyxDQUFDO1lBQ3BDLFFBQVEsQ0FBQyxNQUFNLEVBQUUsQ0FBQztZQUNsQixJQUFJO2dCQUNBLE9BQU8sUUFBUSxDQUFDLFdBQVcsQ0FBQyxNQUFNLENBQUMsQ0FBQzthQUN2QztZQUFDLE9BQU8sRUFBRSxFQUFFO2dCQUNULE9BQU8sQ0FBQyxJQUFJLENBQUMsMkJBQTJCLEVBQUUsRUFBRSxDQUFDLENBQUM7YUFDakQ7b0JBQVM7Z0JBQ04sUUFBUSxDQUFDLElBQUksQ0FBQyxXQUFXLENBQUMsUUFBUSxDQUFDLENBQUM7YUFDdkM7U0FDSjtRQUNELE9BQU8sS0FBSyxDQUFDO0lBQ2pCLENBQUM7OztZQXp2QkosVUFBVTs7OztZQWpCRixXQUFXO1lBS1gsZUFBZTs7Ozs7OztJQWdCaEIsOEJBQTRCOzs7OztJQUM1Qiw4QkFBZ0MiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBJbmplY3RhYmxlIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IEh0dHBTZXJ2aWNlIH0gZnJvbSAnQGVjcC1jYWYvY2FmLWNvbW1vbic7XHJcbmltcG9ydCB7IE9ic2VydmFibGUsIGZvcmtKb2luLCBTdWJqZWN0IH0gZnJvbSAncnhqcyc7XHJcbmltcG9ydCB7IEFzc2lnblBhcmFtZXRlciB9IGZyb20gJy4uL2VudGl0eS9jb21wbGV0ZS1yZXNwb25zZSc7XHJcbmltcG9ydCB7IENvbXBsZXRlQ29udGV4dCB9IGZyb20gJy4uL2VudGl0eS9jb21wbGV0ZS1jb250ZXh0JztcclxuaW1wb3J0IHsgQmF0Y2hWZXJpZnlTaWduZWRDb250ZXh0IH0gZnJvbSAnLi4vZW50aXR5L2JhdGNoVmVyaWZ5c2lnbmVkJztcclxuaW1wb3J0IHsgTWVzc2FnZXJTZXJ2aWNlIH0gZnJvbSAnQGZhcnJpcy91aS1tZXNzYWdlcic7XHJcbmltcG9ydCB7IENhbmNlbFN1Ym1pdFBheWxvYWQsIFN0YXJ0UHJvY2Vzc1BheWxvYWQgfSBmcm9tICcuLi9lbnRpdHkvc3RhcnQtcHJvY2Vzcy1wYXlsb2FkJztcclxuaW1wb3J0IHsgRmlsZURlbGV0ZUVudGl0eSwgRmlsZVVwbG9hZEVudGl0eSwgR3NwRG9jVXBsb2FkRW50aXR5IH0gZnJvbSAnLi4vZW50aXR5L2F0dGFjaG1lbnQnO1xyXG5pbXBvcnQgeyBXb3JrSXRlbUV4ZWN1dGVQYXJhbSB9IGZyb20gJy4uL2VudGl0eS93b3JraXRlbS1leGVjdXRlLXBhcmFtJztcclxuaW1wb3J0IHsgVXJnZUhhbmRsZUNvbnRleHQsIFVyZ2VIYW5kbGVTaW11bGF0ZUNvbnRleHQgfSBmcm9tICcuLi9lbnRpdHkvdXJnZS1oYW5kbGUnO1xyXG5pbXBvcnQgeyBBZGRTaWduUGF5bG9hZCB9IGZyb20gJy4uL2VudGl0eS9hZGQtc2lnbic7XHJcbmltcG9ydCB7IFNlcnZlckV4Y2VwdGlvbkVudGl0eSB9IGZyb20gJy4uL2VudGl0eS9leGNlcHRpb24tZW50aXR5JztcclxuaW1wb3J0IHsgQnNNb2RhbFJlZiB9IGZyb20gJ0BmYXJyaXMvdWktbW9kYWwnO1xyXG5pbXBvcnQgeyBUYXNrQ2VudGVyQ29uZmlnIH0gZnJvbSAnLi4vZW50aXR5L3Rhc2stY2VudGVyLWNvbmZpZyc7XHJcbmltcG9ydCB7IENvbW1vbkNvbW1lbnQgfSBmcm9tICcuLi9lbnRpdHkvY29tbWVudCc7XHJcbmltcG9ydCB7IENvbW1vbkNvbW1lbnRGaWx0ZXIgfSBmcm9tICcuLi9lbnRpdHkvY29tbW9uQ29tbWVudEZpbHRlcic7XHJcblxyXG5ASW5qZWN0YWJsZSgpXHJcbmV4cG9ydCBjbGFzcyBUYXNrU2VydmljZSB7XHJcblxyXG4gICAgY29uc3RydWN0b3IoXHJcbiAgICAgICAgcHJpdmF0ZSBodHRwU3ZjOiBIdHRwU2VydmljZSxcclxuICAgICAgICBwcml2YXRlIG1lc3NhZ2U6IE1lc3NhZ2VyU2VydmljZSxcclxuICAgICkgeyB9XHJcblxyXG4gICAgZ2V0VXNlcnNCeUlkcyhpZHM6IHN0cmluZ1tdKTogT2JzZXJ2YWJsZTxhbnk+IHtcclxuICAgICAgICB2YXIgcGF0aFVybCA9ICcvYXBpL3J1bnRpbWUvc3lzL3YxLjAvdXNlcnMnO1xyXG4gICAgICAgIHJldHVybiBmb3JrSm9pbihpZHMubWFwKGlkID0+IHRoaXMuaHR0cFN2Yy5nZXQocGF0aFVybCArIGAvJHtpZH1gICsgYD9tb2RlPTAwMDJgKSkpO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiDojrflj5blt6XkvZzpobnmk43kvZzliJfooahcclxuICAgICAqL1xyXG4gICAgZ2V0V29ya0l0ZW1BY3Rpb25zKHdvcmtJdGVtSWQ6IHN0cmluZyk6IE9ic2VydmFibGU8YW55PiB7XHJcbiAgICAgICAgY29uc3QgdXJsID0gYC9hcGkvcnVudGltZS93Zi92MS4wL3dvcmtJdGVtcy8ke3dvcmtJdGVtSWR9L2FjdGlvbnNgO1xyXG4gICAgICAgIHJldHVybiB0aGlzLmh0dHBTdmMuZ2V0KHVybCk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDmiafooYzlrqHmibnmk43kvZxcclxuICAgICAqIEBwYXJhbSBjb250ZXh0IOaJp+ihjOWuoeaJueS4iuS4i+aWh1xyXG4gICAgICovXHJcbiAgICBjb21wbGV0ZShjb250ZXh0OiBDb21wbGV0ZUNvbnRleHQpOiBPYnNlcnZhYmxlPGFueT4ge1xyXG4gICAgICAgIGNvbnN0IHVybCA9IGAvYXBpL3J1bnRpbWUvd2YvdjEuMC93b3JrSXRlbXMvY29tcGxldGVgO1xyXG4gICAgICAgIHJldHVybiB0aGlzLmh0dHBTdmMucG9zdCh1cmwsIGNvbnRleHQpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog5omn6KGM5a6h5om56aKE6Kej5p6QXHJcbiAgICAgKiBAcGFyYW0gY29udGV4dCDmiafooYzlrqHmibnkuIrkuIvmlodcclxuICAgICAqL1xyXG4gICAgY29tcGxldGVTaW11bGF0ZShjb250ZXh0OiBDb21wbGV0ZUNvbnRleHQpOiBPYnNlcnZhYmxlPGFueT4ge1xyXG4gICAgICAgIGNvbnN0IHVybCA9IGAvYXBpL3J1bnRpbWUvd2YvdjEuMC93b3JrSXRlbXMvY29tcGxldGUtc2ltdWxhdGlvbmA7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuaHR0cFN2Yy5wb3N0KHVybCwgY29udGV4dCk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDojrflj5bot7PovazmtLvliqjkv6Hmga9cclxuICAgICAqIEBwYXJhbSB3b3JrSXRlbUlkIOW3peS9nOmhuUlkXHJcbiAgICAgKiBAcGFyYW0gYWN0aW9uIOWKqOS9nOe8luWPt1xyXG4gICAgICovXHJcbiAgICBnZXREZXN0aW5hdGlvblNjb3BlKHdvcmtJdGVtSWQ6IHN0cmluZywgYWN0aW9uOiBzdHJpbmcpOiBPYnNlcnZhYmxlPGFueT4ge1xyXG4gICAgICAgIGNvbnN0IHVybCA9IGAvYXBpL3J1bnRpbWUvd2YvdjEuMC93b3JrSXRlbXMvJHt3b3JrSXRlbUlkfS9uZXh0Tm9kZXMvJHthY3Rpb259YDtcclxuICAgICAgICByZXR1cm4gdGhpcy5odHRwU3ZjLmdldCh1cmwpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog5qC55o2u6IqC54K5SUTojrflj5bmjIflrprlj4LkuI7ogIXnmoTnu5PmnpxcclxuICAgICAqIEBwYXJhbSB3b3JrSXRlbUlkXHJcbiAgICAgKiBAcGFyYW0gbm9kZUlkIOivtOaYju+8mm5vZGVJZHM9W1wibm9kZTFcIixcIm5vZGUyXCIswrfCt8K3XVxyXG4gICAgICogQHJldHVybnMg5oyH5rS+5L+h5oGv55qE5pWw57uEIHJlOiBGbG93Tm9kZUluZm9bXVxyXG4gICAgICovXHJcbiAgICBnZXRTaW11bGF0aW9uQXNzaWduZWVJbmZvKHdvcmtJdGVtSWQ6IHN0cmluZywgbm9kZUlkOiBzdHJpbmcpOiBPYnNlcnZhYmxlPGFueT4ge1xyXG4gICAgICAgIGNvbnN0IHVybCA9IGAvYXBpL3J1bnRpbWUvd2YvdjEuMC93b3JrSXRlbXMvJHt3b3JrSXRlbUlkfS9zaW11bGF0aW9uLWFzc2lnbmVlSW5mbz9ub2RlSWRzPVske25vZGVJZH1dYDtcclxuICAgICAgICByZXR1cm4gdGhpcy5odHRwU3ZjLmdldCh1cmwpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog5omn6KGM5b6B6K+i44CB55+l5LyaXHJcbiAgICAgKiBAcGFyYW0gY29udGV4dCDkuIrkuIvmlodcclxuICAgICAqL1xyXG4gICAgYWRkU2lnbihjb250ZXh0OiBhbnkpOiBPYnNlcnZhYmxlPGFueT4ge1xyXG4gICAgICAgIGNvbnN0IHVybCA9IGAvYXBpL3J1bnRpbWUvd2YvdjEuMC93b3JrSXRlbXMvY291bnRlclNpZ25BZGRgO1xyXG4gICAgICAgIHJldHVybiB0aGlzLmh0dHBTdmMucG9zdCh1cmwsIGNvbnRleHQpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog5bey6ZiFXHJcbiAgICAgKiBAcGFyYW0gY29udGV4dCDlj4LmlbBcclxuICAgICAqL1xyXG4gICAgcmVhZFRhc2soY29udGV4dDogV29ya0l0ZW1FeGVjdXRlUGFyYW0pOiBPYnNlcnZhYmxlPGFueT4ge1xyXG4gICAgICAgIGNvbnN0IHVybCA9IGAvYXBpL3J1bnRpbWUvd2YvdjEuMC93b3JrSXRlbXMvcmVhZGA7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuaHR0cFN2Yy5wb3N0KHVybCwgY29udGV4dCk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDmn6Xor6LljZXmja7kv6Hmga/vvIjmlrnms5XlkI3kuI3opoHliqjvvIzlhbbku5blnLDmlrnmnInlvJXnlKjvvIlcclxuICAgICAqIEBwYXJhbSB3b3JrSXRlbUlkIOW3peS9nOmhuUlkXHJcbiAgICAgKi9cclxuICAgIGdldFRhc2tGb3JtSW5mbyh3b3JrSXRlbUlkOiBzdHJpbmcpOiBPYnNlcnZhYmxlPGFueT4ge1xyXG4gICAgICAgIGxldCBzdWJqZWN0ID0gbmV3IFN1YmplY3QoKTtcclxuICAgICAgICBsZXQgY2FjaGVDb2RlID0gXCJnc3BXZlRhc2tGb3JtSW5mb1wiICsgd29ya0l0ZW1JZDtcclxuICAgICAgICBjb25zdCB0YXNrRm9ybSA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKGNhY2hlQ29kZSk7XHJcbiAgICAgICAgaWYgKHRhc2tGb3JtKSB7XHJcbiAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgc3ViamVjdC5uZXh0KEpTT04ucGFyc2UodGFza0Zvcm0pKTtcclxuICAgICAgICAgICAgfSwgMTApO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGZvcm1QYXJVcmwgPSBgL2FwaS9ydW50aW1lL3dmL3YxLjAvd29ya0l0ZW1zLyR7d29ya0l0ZW1JZH0vZm9ybUluZm9gO1xyXG4gICAgICAgICAgICB0aGlzLmh0dHBTdmMuZ2V0KGZvcm1QYXJVcmwpLnN1YnNjcmliZShyZSA9PiB7XHJcbiAgICAgICAgICAgICAgICBzdWJqZWN0Lm5leHQocmUpO1xyXG4gICAgICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oY2FjaGVDb2RlLCBKU09OLnN0cmluZ2lmeShyZSkpO1xyXG4gICAgICAgICAgICB9LCBlcnJvciA9PiB7XHJcbiAgICAgICAgICAgICAgICBzdWJqZWN0LmVycm9yKGVycm9yKTtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHN1YmplY3QuYXNPYnNlcnZhYmxlKCk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDojrflj5bmjIfmtL7kv6Hmga9cclxuICAgICAqIEBwYXJhbSB0YXNrSWQg5bel5L2c6aG5SWRcclxuICAgICAqIOatpOaOpeWPo+WPqui/lOWbnuS4gOS4qkFzc2lnbkluZm/nsbvluo/liJfljJblkI7nmoTkv6Hmga/vvIzkuI3mmK/lpJrkuKpcclxuICAgICAqL1xyXG4gICAgZ2V0QXNzaWduZWVJbmZvKHRhc2tJZDogc3RyaW5nKTogT2JzZXJ2YWJsZTxhbnk+IHtcclxuICAgICAgICBjb25zdCB1cmwgPSBgL2FwaS9ydW50aW1lL3dmL3YxLjAvd29ya0l0ZW1zLyR7dGFza0lkfS9hc3NpZ25lZUluZm9gO1xyXG4gICAgICAgIHJldHVybiB0aGlzLmh0dHBTdmMuZ2V0KHVybCk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDojrflj5bliqDnrb7np7vkuqTojIPlm7Torr7nva5cclxuICAgICAqIEBwYXJhbSB3b3JrSXRlbUlkXHJcbiAgICAgKiBAcGFyYW0gYWN0aW9uQ29kZVxyXG4gICAgICovXHJcbiAgICBnZXRPcmdhbml6YXRpb25TY29wZSh3b3JrSXRlbUlkOiBzdHJpbmcsIGFjdGlvbkNvZGU6IHN0cmluZyk6IE9ic2VydmFibGU8YW55PiB7XHJcbiAgICAgICAgY29uc3QgdXJsID0gYC9hcGkvcnVudGltZS93Zi92MS4wL3dvcmtJdGVtcy8ke3dvcmtJdGVtSWR9L29yZ2FuaXphdGlvblNjb3BlLyR7YWN0aW9uQ29kZX1gO1xyXG4gICAgICAgIHJldHVybiB0aGlzLmh0dHBTdmMuZ2V0KHVybCk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDmoLnmja7mtYHnqIvlrp7kvotJROWSjOS7u+WKoeeKtuaAgeWKnueQhuS7u+WKoVxyXG4gICAgICogQHBhcmFtIHByb2NJbnN0SWQg5rWB56iL5a6e5L6LaWRcclxuICAgICAqIEBwYXJhbSBzdGF0ZSDku7vliqHnirbmgIEgMuaIljVcclxuICAgICAqL1xyXG4gICAgZ2V0VGFza0J5UHJvY0luc3RJZChwcm9jSW5zdElkOiBzdHJpbmcsIHN0YXRlOiBudW1iZXIpOiBPYnNlcnZhYmxlPGFueT4ge1xyXG4gICAgICAgIGNvbnN0IHVybCA9IGAvYXBpL3J1bnRpbWUvdGFzay92MS4wL3Rhc2tzL3Byb2Nlc3NJbnN0YW5jZUlkP3Byb2NJbnN0SWQ9JHtwcm9jSW5zdElkfSZzdGF0ZT0ke3N0YXRlfWA7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuaHR0cFN2Yy5nZXQodXJsKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOagueaNrndvcmtpdGVtSUTojrflj5bku7vliqHlrp7kvZNcclxuICAgICAqIEBwYXJhbSB3b3JrSXRlbUlkXHJcbiAgICAgKi9cclxuICAgIGdldFRhc2tCeVdvcmtJdGVtSWQod29ya0l0ZW1JZDogc3RyaW5nKTogT2JzZXJ2YWJsZTxhbnk+IHtcclxuICAgICAgICBjb25zdCB1cmwgPSBgL2FwaS9ydW50aW1lL3Rhc2svdjEuMC90YXNrcy9zb3VyY2VJZC8ke3dvcmtJdGVtSWR9YDtcclxuICAgICAgICByZXR1cm4gdGhpcy5odHRwU3ZjLmdldCh1cmwpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog5qC55o2u5bel5L2c6aG5SUTmjIfmtL7ku7vliqFcclxuICAgICAqIEBwYXJhbSBhc3NpZ25lZXNQYSDmjIfmtL7lj4LmlbBcclxuICAgICAqL1xyXG4gICAgYXNzaWduTmV4dFVzZXJzQnlXb3JrSXRlbUlkKGFzc2lnbmVlc1BhOiBBc3NpZ25QYXJhbWV0ZXIpOiBPYnNlcnZhYmxlPGFueT4ge1xyXG4gICAgICAgIGNvbnN0IHVybCA9IGAvYXBpL3J1bnRpbWUvd2YvdjEuMC93b3JrSXRlbXMvYXNzaWduVXNlcmA7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuaHR0cFN2Yy5wb3N0KHVybCwgYXNzaWduZWVzUGEpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog5Y+W5ZueXHJcbiAgICAgKiBAcGFyYW0gd29ya0l0ZW1JZCB0YXNrIGlkXHJcbiAgICAgKiBAcGFyYW0gY29tbWVudCBjb21tZW50XHJcbiAgICAgKi9cclxuICAgIHJldHJpZXZlKGNvbnRleHQ6IHsgd29ya0l0ZW1JZDogc3RyaW5nLCBjb21tZW50Pzogc3RyaW5nIH0pOiBPYnNlcnZhYmxlPGFueT4ge1xyXG4gICAgICAgIGNvbnN0IHVybCA9IGAvYXBpL3J1bnRpbWUvd2YvdjEuMC93b3JrSXRlbXMvcmV0cmlldmVgO1xyXG4gICAgICAgIHJldHVybiB0aGlzLmh0dHBTdmMucG9zdCh1cmwsIGNvbnRleHQpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog5Lu75Yqh56e75LqkXHJcbiAgICAgKiBAcGFyYW0gdGFza0lkIOW3peS9nOmhuUlkXHJcbiAgICAgKiBAcGFyYW0gdGFyZ2V0VUlkIOebruagh+eUqOaIt0lkXHJcbiAgICAgKi9cclxuICAgIHRyYW5zZmVyKHRyYW5zZmVyQ29udGV4dDogYW55KTogT2JzZXJ2YWJsZTxhbnk+IHtcclxuICAgICAgICBjb25zdCB1cmwgPSBgL2FwaS9ydW50aW1lL3dmL3YxLjAvd29ya0l0ZW1zL3RyYW5zZmVyYDtcclxuICAgICAgICByZXR1cm4gdGhpcy5odHRwU3ZjLnBvc3QodXJsLCB0cmFuc2ZlckNvbnRleHQpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog5Lu75Yqh6K+E6K66XHJcbiAgICAgKiBAcGFyYW0gdGFza0lkIOW3peS9nOmhuUlkXHJcbiAgICAgKiBAcGFyYW0gdGFyZ2V0VUlkIOebruagh+eUqOaIt0lkXHJcbiAgICAgKi9cclxuICAgIGNvbW1lbnQoY29tbWVudENvbnRleHQ6IGFueSk6IE9ic2VydmFibGU8YW55PiB7XHJcbiAgICAgICAgY29uc3QgdXJsID0gYC9hcGkvcnVudGltZS93Zi92MS4wL3dvcmtJdGVtcy9jb21tZW50YDtcclxuICAgICAgICByZXR1cm4gdGhpcy5odHRwU3ZjLnBvc3QodXJsLCBjb21tZW50Q29udGV4dCk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDpoobnlKjku7vliqFcclxuICAgICAqIEBwYXJhbSB0YXNrSWQg5bel5L2c6aG5SWRcclxuICAgICAqL1xyXG4gICAgY2xhaW0odGFza0lkOiBzdHJpbmcsIGNvbW1lbnQ6IHN0cmluZyk6IE9ic2VydmFibGU8YW55PiB7XHJcbiAgICAgICAgY29uc3QgdXJsID0gYC9hcGkvcnVudGltZS93Zi92MS4wL3dvcmtJdGVtcy9jbGFpbWA7XHJcbiAgICAgICAgY29uc3Qgb3B0aW9ucyA9IHtcclxuICAgICAgICAgICAgd29ya0l0ZW1JZDogdGFza0lkLFxyXG4gICAgICAgICAgICBjb21tZW50OiBjb21tZW50XHJcbiAgICAgICAgfTtcclxuICAgICAgICByZXR1cm4gdGhpcy5odHRwU3ZjLnBvc3QodXJsLCBvcHRpb25zKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOWPlua2iOmihueUqFxyXG4gICAgICogQHBhcmFtIHRhc2tJZCDku7vliqFJZFxyXG4gICAgICovXHJcbiAgICB1bkNsYWltKHRhc2tJZDogc3RyaW5nLCBjb21tZW50OiBzdHJpbmcpOiBPYnNlcnZhYmxlPGFueT4ge1xyXG4gICAgICAgIGNvbnN0IHVybCA9IGAvYXBpL3J1bnRpbWUvd2YvdjEuMC93b3JrSXRlbXMvdW5jbGFpbWA7XHJcbiAgICAgICAgY29uc3Qgb3B0aW9ucyA9IHtcclxuICAgICAgICAgICAgd29ya0l0ZW1JZDogdGFza0lkLFxyXG4gICAgICAgICAgICBjb21tZW50OiBjb21tZW50XHJcbiAgICAgICAgfTtcclxuICAgICAgICByZXR1cm4gdGhpcy5odHRwU3ZjLnBvc3QodXJsLCBvcHRpb25zKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOaKpemUmeaPkOekulxyXG4gICAgICogQHBhcmFtIGVycm9yXHJcbiAgICAgKi9cclxuICAgIGVycm9yKGVycm9yOiBhbnkpIHtcclxuICAgICAgICBpZiAoZXJyb3IgJiYgZXJyb3IuZXJyb3IgJiYgZXJyb3IuZXJyb3IuTWVzc2FnZSkge1xyXG4gICAgICAgICAgICB2YXIgbWVzc2FnZSA9IGVycm9yLmVycm9yLk1lc3NhZ2U7XHJcbiAgICAgICAgICAgIHRoaXMubWVzc2FnZS5zaG93KCd3YXJuaW5nJywgbWVzc2FnZSwgeyBzYWZlSHRtbDogZmFsc2UgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog5ZCv5Yqo5rWB56iL5o6l5Y+jXHJcbiAgICAgKiBAcGFyYW0gcGF5bG9hZCBBUEnmiYDpnIDnmoTkuIrkuIvmloflj4LmlbBcclxuICAgICAqL1xyXG4gICAgc3RhcnRQcm9jZXNzKHBheWxvYWQ6IFN0YXJ0UHJvY2Vzc1BheWxvYWQpOiBPYnNlcnZhYmxlPGFueT4ge1xyXG4gICAgICAgIGNvbnN0IHVybCA9IGAvYXBpL3J1bnRpbWUvd2YvdjEuMC9wcm9jZXNzSW5zdGFuY2VzL3N0YXJ0UHJvY2Vzc2A7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuaHR0cFN2Yy5wb3N0KHVybCwgcGF5bG9hZCk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDlkK/liqjmtYHnqIvpooTop6PmnpBcclxuICAgICAqIEBwYXJhbSBwYXlsb2FkIEFQSeaJgOmcgOeahOS4iuS4i+aWh+WPguaVsFxyXG4gICAgICovXHJcbiAgICBzdGFydFByb2Nlc3NTaW11bGF0ZShwYXlsb2FkOiBTdGFydFByb2Nlc3NQYXlsb2FkKTogT2JzZXJ2YWJsZTxhbnk+IHtcclxuICAgICAgICBjb25zdCB1cmwgPSBgL2FwaS9ydW50aW1lL3dmL3YxLjAvcHJvY2Vzc0luc3RhbmNlcy9zdGFydFByb2Nlc3Mtc2ltdWxhdGlvbmA7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuaHR0cFN2Yy5wb3N0KHVybCwgcGF5bG9hZCk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDlj5bmtojmj5DkuqRcclxuICAgICAqIEBwYXJhbSBwYXJhbSDlj4LmlbBcclxuICAgICAqL1xyXG4gICAgY2FuY2VsU3VibWl0KHBhcmFtOiBDYW5jZWxTdWJtaXRQYXlsb2FkKTogT2JzZXJ2YWJsZTxhbnk+IHtcclxuICAgICAgICBjb25zdCB1cmwgPSBgL2FwaS9ydW50aW1lL3dmL3YxLjAvcHJvY2Vzc0luc3RhbmNlcy9jYW5jZWxTdWJtaXRgO1xyXG4gICAgICAgIHJldHVybiB0aGlzLmh0dHBTdmMucG9zdCh1cmwsIHBhcmFtKTtcclxuICAgIH1cclxuXHJcbiAgICBzdGF0aWMgbmV3SWQoKSB7XHJcbiAgICAgICAgY29uc3QgUzQgPSAoKSA9PiAoKCgxICsgTWF0aC5yYW5kb20oKSkgKiAweDEwMDAwKSB8IDApLnRvU3RyaW5nKDE2KS5zdWJzdHJpbmcoMSk7XHJcbiAgICAgICAgcmV0dXJuIChTNCgpICsgUzQoKSArICctJyArIFM0KCkgKyAnLScgKyBTNCgpICsgJy0nICsgUzQoKSArICctJyArIFM0KCkgKyBTNCgpICsgUzQoKSk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDojrflj5bnlKjmiLfluLjnlKjmhI/op4HliJfooahcclxuICAgICAqIEByZXR1cm5zIFxyXG4gICAgICovXHJcbiAgICBnZXRDb21tZW50TGlzdChmaWx0ZXI/OiBDb21tb25Db21tZW50RmlsdGVyKTogT2JzZXJ2YWJsZTxhbnk+IHtcclxuICAgICAgICBsZXQgdXJsID0gYC9hcGkvcnVudGltZS93Zi92MS4wL2NvbW1vbkNvbW1lbnRzYDtcclxuICAgICAgICBmaWx0ZXIgJiYgZmlsdGVyLnR5cGUgJiYgKHVybCArPSBgP3R5cGU9JHtmaWx0ZXIudHlwZX1gKVxyXG4gICAgICAgIHJldHVybiB0aGlzLmh0dHBTdmMuZ2V0KHVybCk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDmt7vliqDluLjnlKjmhI/op4FcclxuICAgICAqIEByZXR1cm5zIFxyXG4gICAgICovXHJcbiAgICBhZGRDb21tZW50KGNvbW1lbnQ6IENvbW1vbkNvbW1lbnQpOiBPYnNlcnZhYmxlPGFueT4ge1xyXG4gICAgICAgIGNvbnN0IHVybCA9IGAvYXBpL3J1bnRpbWUvd2YvdjEuMC9jb21tb25Db21tZW50c2A7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuaHR0cFN2Yy5wb3N0KHVybCwgY29tbWVudCk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDliKDpmaTkuIDmnaHluLjnlKjmhI/op4FcclxuICAgICAqIEBwYXJhbSBpZCDluLjnlKjmhI/op4FpZFxyXG4gICAgICogQHJldHVybnMgXHJcbiAgICAgKi9cclxuICAgIGRlbGV0ZUNvbW1lbnQoaWQ6IHN0cmluZyk6IE9ic2VydmFibGU8YW55PiB7XHJcbiAgICAgICAgY29uc3QgdXJsID0gYC9hcGkvcnVudGltZS93Zi92MS4wL2NvbW1vbkNvbW1lbnRzLyR7aWR9YDtcclxuICAgICAgICByZXR1cm4gdGhpcy5odHRwU3ZjLmRlbGV0ZSh1cmwsIG51bGwpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog6I635Y+W5Lu75Yqh5Lit5b+D6YWN572u6aG5XHJcbiAgICAgKiBAcGFyYW0gY29kZSDphY3nva7pobnnmoRDb2RlXHJcbiAgICAgKi9cclxuICAgIGdldFRhc2tDZW50ZXJDb25maWdCeUNvZGUoY29kZTogc3RyaW5nLCBvd25lclR5cGU/OiBzdHJpbmcsIG93bmVySWQ/OiBzdHJpbmcpOiBPYnNlcnZhYmxlPGFueT4ge1xyXG4gICAgICAgIGxldCB1cmwgPSBgL2FwaS9ydW50aW1lL3Rhc2svdjEuMC90YXNrLWNlbnRlci1zZXR0aW5nL2NvZGU/Y29kZT0ke2NvZGV9YDtcclxuICAgICAgICBvd25lclR5cGUgJiYgKHVybCArPSBgJm93bmVyVHlwZT0ke293bmVyVHlwZX1gKTtcclxuICAgICAgICBvd25lcklkICYmICh1cmwgKz0gYCZvd25lcklkPSR7b3duZXJJZH1gKTtcclxuICAgICAgICByZXR1cm4gdGhpcy5odHRwU3ZjLmdldCh1cmwpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog6I635Y+W57O757uf57qn5Yir6YWN572u77yI57yT5a2Y5Li65LiA5aSp77yJXHJcbiAgICAgKi9cclxuICAgIGdldEFsbFRhc2tDZW50ZXJDb25maWcoKTogT2JzZXJ2YWJsZTxhbnk+IHtcclxuICAgICAgICBsZXQgc3ViamVjdCA9IG5ldyBTdWJqZWN0KCk7XHJcbiAgICAgICAgbGV0IGNvZGUgPSBcImdzcFdmVGFza0FsbENvbmZpZ1wiO1xyXG4gICAgICAgIGxldCB0b2RheUNvZGUgPSBjb2RlICsgdGhpcy5nZXRDdXJyZW50RGF0ZVN0cmluZygpO1xyXG4gICAgICAgIGxldCBjb25maWdTdHIgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSh0b2RheUNvZGUpO1xyXG4gICAgICAgIGlmIChjb25maWdTdHIpIHtcclxuICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBzdWJqZWN0Lm5leHQoSlNPTi5wYXJzZShjb25maWdTdHIpKTtcclxuICAgICAgICAgICAgfSwgMTApO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGxldCB1cmwgPSBgL2FwaS9ydW50aW1lL3Rhc2svdjEuMC90YXNrLWNlbnRlci1zZXR0aW5nL2FsbD9vd25lclR5cGU9YWxsJm93bmVySWQ9KmA7XHJcbiAgICAgICAgICAgIHRoaXMuaHR0cFN2Yy5nZXQodXJsKS5zdWJzY3JpYmUocmUgPT4ge1xyXG4gICAgICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0odG9kYXlDb2RlLCBKU09OLnN0cmluZ2lmeShyZSkpO1xyXG4gICAgICAgICAgICAgICAgc3ViamVjdC5uZXh0KHJlKTtcclxuICAgICAgICAgICAgICAgIHRoaXMucmVtb3ZlQ29uZmlnKGNvZGUpO1xyXG4gICAgICAgICAgICB9LCBlcnJvciA9PiB7XHJcbiAgICAgICAgICAgICAgICBzdWJqZWN0LmVycm9yKGVycm9yKTtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHN1YmplY3QuYXNPYnNlcnZhYmxlKCk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDojrflj5bku7vliqHliIbnsbvnuqfliKvphY3nva5cclxuICAgICAqL1xyXG4gICAgZ2V0VGFza0NhdGVnb3J5Q2VudGVyQ29uZmlnKGNhdGVnb3J5SWQ6IHN0cmluZyk6IE9ic2VydmFibGU8YW55PiB7XHJcbiAgICAgICAgbGV0IHN1YmplY3QgPSBuZXcgU3ViamVjdCgpO1xyXG4gICAgICAgIGxldCBjb2RlID0gXCJnc3BXZlRhc2tDYXRlZ29yeUNvbmZpZ1wiICsgY2F0ZWdvcnlJZDtcclxuICAgICAgICBsZXQgdG9kYXlDb2RlID0gY29kZSArIHRoaXMuZ2V0Q3VycmVudERhdGVTdHJpbmcoKTtcclxuICAgICAgICBsZXQgY29uZmlnU3RyID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0odG9kYXlDb2RlKTtcclxuICAgICAgICBpZiAoY29uZmlnU3RyKSB7XHJcbiAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgc3ViamVjdC5uZXh0KEpTT04ucGFyc2UoY29uZmlnU3RyKSk7XHJcbiAgICAgICAgICAgIH0sIDEwKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBsZXQgdXJsID0gYC9hcGkvcnVudGltZS90YXNrL3YxLjAvdGFzay1jZW50ZXItc2V0dGluZy9hbGxgO1xyXG4gICAgICAgICAgICB1cmwgKz0gYD9vd25lclR5cGU9Y2F0ZWdvcnkmb3duZXJJZD0ke2NhdGVnb3J5SWR9YDtcclxuICAgICAgICAgICAgdGhpcy5odHRwU3ZjLmdldCh1cmwpLnN1YnNjcmliZShyZSA9PiB7XHJcbiAgICAgICAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSh0b2RheUNvZGUsIEpTT04uc3RyaW5naWZ5KHJlKSk7XHJcbiAgICAgICAgICAgICAgICBzdWJqZWN0Lm5leHQocmUpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5yZW1vdmVDb25maWcoY29kZSk7XHJcbiAgICAgICAgICAgIH0sIGVycm9yID0+IHtcclxuICAgICAgICAgICAgICAgIHN1YmplY3QuZXJyb3IoZXJyb3IpO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gc3ViamVjdC5hc09ic2VydmFibGUoKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICog6I635Y+W5Lu75Yqh5Lit5b+D5Liq5Lq655So5oi36YWN572u77yI57yT5a2Y5Li65LiA5aSp77yJXHJcbiAgICAqL1xyXG4gICAgZ2V0QWxsVXNlckNvbmZpZygpOiBPYnNlcnZhYmxlPGFueT4ge1xyXG4gICAgICAgIGxldCBzdWJqZWN0ID0gbmV3IFN1YmplY3QoKTtcclxuICAgICAgICBsZXQgY29kZSA9IFwiZ3NwV2ZUYXNrVXNlckNvbmZpZ1wiO1xyXG4gICAgICAgIGxldCB0b2RheUNvZGUgPSBjb2RlICsgdGhpcy5nZXRDdXJyZW50RGF0ZVN0cmluZygpO1xyXG4gICAgICAgIGxldCBjb25maWdTdHIgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSh0b2RheUNvZGUpO1xyXG4gICAgICAgIGlmIChjb25maWdTdHIpIHtcclxuICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBzdWJqZWN0Lm5leHQoSlNPTi5wYXJzZShjb25maWdTdHIpKTtcclxuICAgICAgICAgICAgfSwgMTApO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGxldCB1cmwgPSBgL2FwaS9ydW50aW1lL3Rhc2svdjEuMC90YXNrLWNlbnRlci1zZXR0aW5nL2FsbGA7XHJcbiAgICAgICAgICAgIHRoaXMuaHR0cFN2Yy5nZXQodXJsKS5zdWJzY3JpYmUocmUgPT4ge1xyXG4gICAgICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0odG9kYXlDb2RlLCBKU09OLnN0cmluZ2lmeShyZSkpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5yZW1vdmVDb25maWcoY29kZSk7XHJcbiAgICAgICAgICAgICAgICBzdWJqZWN0Lm5leHQocmUpO1xyXG4gICAgICAgICAgICB9LCBlcnJvciA9PiB7XHJcbiAgICAgICAgICAgICAgICBzdWJqZWN0LmVycm9yKGVycm9yKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBzdWJqZWN0LmFzT2JzZXJ2YWJsZSgpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog5re75Yqg55So5oi357qn5Yir6Ieq5a6a5LmJ6YWN572uXHJcbiAgICAgKiBAcGFyYW0gY29kZSDphY3nva7pobnnvJblj7dcclxuICAgICAqL1xyXG4gICAgYWRkVXNlckNvbmZpZyhjb2RlOiBzdHJpbmcsIGN1cnJlbnRWYWx1ZTogc3RyaW5nKTogT2JzZXJ2YWJsZTxhbnk+IHtcclxuICAgICAgICBsZXQgY29uZmlnQ29kZSA9IFwiZ3NwV2ZUYXNrVXNlckNvbmZpZ1wiO1xyXG4gICAgICAgIGxldCB0b2RheUNvZGUgPSBjb25maWdDb2RlICsgdGhpcy5nZXRDdXJyZW50RGF0ZVN0cmluZygpO1xyXG4gICAgICAgIGxldCBjb25maWdTdHIgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSh0b2RheUNvZGUpO1xyXG4gICAgICAgIGlmIChjb25maWdTdHIpIHtcclxuICAgICAgICAgICAgbGV0IGxpc3QgPSBKU09OLnBhcnNlKGNvbmZpZ1N0cik7XHJcbiAgICAgICAgICAgIGlmIChsaXN0ICYmIGxpc3QubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgaXRlbSA9IChsaXN0IGFzIFRhc2tDZW50ZXJDb25maWdbXSkuZmluZChsID0+IGwuY29uZmlnQ29kZSA9PSBjb2RlKTtcclxuICAgICAgICAgICAgICAgIGlmIChpdGVtKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaXRlbS5jdXJyZW50VmFsdWUgPSBjdXJyZW50VmFsdWU7XHJcbiAgICAgICAgICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0odG9kYXlDb2RlLCBKU09OLnN0cmluZ2lmeShsaXN0KSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgbGV0IHVybCA9IGAvYXBpL3J1bnRpbWUvdGFzay92MS4wL3Rhc2stY2VudGVyLXNldHRpbmcvYWRkP2NvbmZpZ0NvZGU9JHtjb2RlfSZjdXJyZW50VmFsdWU9JHtjdXJyZW50VmFsdWV9YDtcclxuICAgICAgICByZXR1cm4gdGhpcy5odHRwU3ZjLnBvc3QodXJsLCBudWxsKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOiOt+WPlueUqOaIt+WktOWDj++8iOW3suiiq+S7u+WKoeS4reW/g+iwg+eUqO+8iVxyXG4gICAgICogQHBhcmFtIHVzZXJJZCDnlKjmiLdJRFxyXG4gICAgICovXHJcbiAgICBnZXRVc2VyQXZhdGFyKHVzZXJJZDogc3RyaW5nKTogT2JzZXJ2YWJsZTxhbnk+IHtcclxuICAgICAgICBsZXQgc3ViamVjdCA9IG5ldyBTdWJqZWN0KCk7XHJcbiAgICAgICAgbGV0IGNvZGUgPSBcImdzcFdmVGFza1VzZXJBdmF0YXJcIjtcclxuICAgICAgICBsZXQgdG9kYXlDb2RlID0gY29kZSArIHRoaXMuZ2V0Q3VycmVudERhdGVTdHJpbmcoKTtcclxuICAgICAgICBsZXQgdG9kYXlVc2VyQ29kZSA9IHRvZGF5Q29kZSArIHVzZXJJZDtcclxuICAgICAgICBsZXQgYXZhdGFyU3RyID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0odG9kYXlVc2VyQ29kZSk7XHJcbiAgICAgICAgaWYgKGF2YXRhclN0cikge1xyXG4gICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICAgICAgICAgIHN1YmplY3QubmV4dChKU09OLnBhcnNlKGF2YXRhclN0cikpO1xyXG4gICAgICAgICAgICB9LCAxMDApO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHVybCA9IGAvYXBpL3J1bnRpbWUvc3lzL3YxLjAvdXNlcmluZm9zL3NldHRpbmcvdXNlcnM/dXNlcklkPSR7dXNlcklkfWA7XHJcbiAgICAgICAgICAgIHRoaXMuaHR0cFN2Yy5nZXQodXJsKS5zdWJzY3JpYmUocmUgPT4ge1xyXG4gICAgICAgICAgICAgICAgc3ViamVjdC5uZXh0KHJlKTtcclxuICAgICAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKHRvZGF5VXNlckNvZGUsIEpTT04uc3RyaW5naWZ5KHJlKSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnJlbW92ZUNvbmZpZyhjb2RlKTtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHN1YmplY3QuYXNPYnNlcnZhYmxlKCk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDojrflj5blvZPliY3ml6XmnJ9cclxuICAgICAqL1xyXG4gICAgZ2V0Q3VycmVudERhdGVTdHJpbmcoKSB7XHJcbiAgICAgICAgbGV0IGRhdGUgPSBuZXcgRGF0ZSgpO1xyXG4gICAgICAgIGxldCB5ZWFyID0gZGF0ZS5nZXRGdWxsWWVhcigpLnRvU3RyaW5nKCk7XHJcbiAgICAgICAgbGV0IG1vbnRoID0gKGRhdGUuZ2V0TW9udGgoKSArIDEpLnRvU3RyaW5nKCk7XHJcbiAgICAgICAgbGV0IGRheSA9IGRhdGUuZ2V0RGF0ZSgpLnRvU3RyaW5nKCk7XHJcbiAgICAgICAgcmV0dXJuIHllYXIgKyBtb250aCArIGRheTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOenu+mZpGxvY2FsU3RvcmFnZee8k+WtmFxyXG4gICAgICogQHBhcmFtIGtleSBcclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSByZW1vdmVDb25maWcoa2V5OiBzdHJpbmcpIHtcclxuICAgICAgICBsZXQgdG9kYXlLZXkgPSBrZXkgKyB0aGlzLmdldEN1cnJlbnREYXRlU3RyaW5nKCk7XHJcbiAgICAgICAgZm9yIChsZXQgaXRlbSBpbiBsb2NhbFN0b3JhZ2UpIHtcclxuICAgICAgICAgICAgaWYgKGl0ZW0uaW5kZXhPZihrZXkpID4gLTEgJiYgaXRlbS5pbmRleE9mKHRvZGF5S2V5KSA8IDApIHtcclxuICAgICAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKGl0ZW0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog55yf5q2j5LiK5Lyg6ZmE5Lu2XHJcbiAgICAgKiBAcGFyYW0gZmlsZXNcclxuICAgICAqL1xyXG4gICAgdXBsb2FkQXR0YWNobWVudChmaWxlczogRmlsZVVwbG9hZEVudGl0eSk6IE9ic2VydmFibGU8YW55PiB7XHJcbiAgICAgICAgbGV0IHVybCA9IGAvYXBpL3J1bnRpbWUvZGZzL3YxLjAvZG9jL2NvbW1pdGA7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuaHR0cFN2Yy5wdXQodXJsLCBmaWxlcyk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDliKDpmaTpmYTku7ZcclxuICAgICAqIEBwYXJhbSBmaWxlRGVsZXRlRW50aXR5XHJcbiAgICAgKi9cclxuICAgIGRlbGV0ZUF0dGFjaG1lbnQoZmlsZURlbGV0ZUVudGl0eTogRmlsZURlbGV0ZUVudGl0eSk6IE9ic2VydmFibGU8YW55PiB7XHJcbiAgICAgICAgbGV0IHVybCA9IGAvYXBpL3J1bnRpbWUvZGZzL3YxLjAvZG9jYDtcclxuICAgICAgICByZXR1cm4gdGhpcy5odHRwU3ZjLmRlbGV0ZSh1cmwsIGZpbGVEZWxldGVFbnRpdHkpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog5Yib5bu65YaF56CBXHJcbiAgICAgKi9cclxuICAgIGNyZWF0ZU5NKCkge1xyXG4gICAgICAgIHJldHVybiAneHh4eHh4eHgteHh4eC00eHh4LXl4eHgteHh4eHh4eHh4eHh4Jy5yZXBsYWNlKC9beHldL2csIGZ1bmN0aW9uIChjKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHIgPSBNYXRoLnJhbmRvbSgpICogMTYgfCAwLCB2ID0gYyA9PT0gJ3gnID8gciA6IChyICYgMHgzIHwgMHg4KTtcclxuICAgICAgICAgICAgcmV0dXJuIHYudG9TdHJpbmcoMTYpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog6I635Y+W5b2T5YmN55So5oi35L+h5oGvXHJcbiAgICAgKi9cclxuICAgIGdldFVzZXJJbmZvKCk6IE9ic2VydmFibGU8YW55PiB7XHJcbiAgICAgICAgbGV0IHVybCA9IGAvYXBpL3J1bnRpbWUvc3lzL3YxLjAvdXNlcmluZm9zP2luZm9UeXBlPXVzZXJgO1xyXG4gICAgICAgIHJldHVybiB0aGlzLmh0dHBTdmMuZ2V0KHVybCk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDojrflj5bnlKjmiLfmiYDmnInnrb7lkI1cclxuICAgICAqL1xyXG4gICAgZ2V0VXNlclNpZ25JZCh1c2VySWQ6IHN0cmluZyk6IE9ic2VydmFibGU8YW55PiB7XHJcbiAgICAgICAgbGV0IHN1YmplY3QgPSBuZXcgU3ViamVjdCgpO1xyXG4gICAgICAgIGxldCBjb2RlID0gJ2dzcFdmVGFza1VzZXJTaWduJyArIHVzZXJJZDtcclxuICAgICAgICBsZXQgdG9kYXlDb2RlID0gY29kZSArIHRoaXMuZ2V0Q3VycmVudERhdGVTdHJpbmcoKTtcclxuICAgICAgICBsZXQgc2lnbklkID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0odG9kYXlDb2RlKTtcclxuICAgICAgICBpZiAoc2lnbklkKSB7XHJcbiAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgc3ViamVjdC5uZXh0KHNpZ25JZCk7XHJcbiAgICAgICAgICAgIH0sIDEwMCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgbGV0IHVybCA9IGAvYXBpL3J1bnRpbWUvZGZzL3YxLjAvZm9ybWRvYy9maWxlaW5mby9mb3JtP2Zvcm1pZD0ke3VzZXJJZH0mcm9vdGlkPXRhc2tjZW50ZXJzaWduYXR1cmVgO1xyXG4gICAgICAgICAgICB0aGlzLmh0dHBTdmMuZ2V0KHVybCkuc3Vic2NyaWJlKChyZXN1bHQ6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKHJlc3VsdCAmJiByZXN1bHQubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHNpZ247XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3VsdC5sZW5ndGggPT0gMSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzaWduID0gcmVzdWx0WzBdO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGxpc3QgPSByZXN1bHQuZmlsdGVyKGEgPT4gYSAmJiBhLmxhc3RNb2RpZmllZFRpbWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzaWduID0gbGlzdC5yZWR1Y2UoZnVuY3Rpb24gKGEsIGIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhLmxhc3RNb2RpZmllZFRpbWUgPiBiLmxhc3RNb2RpZmllZFRpbWUgPyBhIDogYjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgc3ViamVjdC5uZXh0KHNpZ24uaWQpO1xyXG4gICAgICAgICAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKHRvZGF5Q29kZSwgc2lnbi5pZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW1vdmVDb25maWcoY29kZSk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHN1YmplY3QubmV4dCgnJyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sIGVycm9yID0+IHtcclxuICAgICAgICAgICAgICAgIHN1YmplY3QuZXJyb3IoZXJyb3IpO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gc3ViamVjdC5hc09ic2VydmFibGUoKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOS4iuS8oOetvuWQje+8jOi/lOWbnumVv+S8oOWQjueahOetvuWQjWlkXHJcbiAgICAgKi9cclxuICAgIHVwbG9hZFNpZ25hdHVyZShnc3BEb2NVcGxvYWRFbnRpdHk6IEdzcERvY1VwbG9hZEVudGl0eSk6IE9ic2VydmFibGU8YW55PiB7XHJcbiAgICAgICAgbGV0IHVybCA9IGAvYXBpL3J1bnRpbWUvZGZzL3YxLjAvZG9jYDtcclxuICAgICAgICBsZXQgaGVhZGVyID0gdGhpcy5odHRwU3ZjLnNldEhlYWRlcih7XHJcbiAgICAgICAgICAgIGJvZHk6IGdzcERvY1VwbG9hZEVudGl0eSxcclxuICAgICAgICAgICAgcmVzcG9uc2VUeXBlOiAndGV4dCdcclxuICAgICAgICB9KVxyXG4gICAgICAgIHJldHVybiB0aGlzLmh0dHBTdmMucmVxdWVzdCgnUG9zdCcsIHVybCwgaGVhZGVyKTtcclxuICAgIH1cclxuXHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDop6PmnpDmlofku7bnsbvlnovvvIznu5nlh7rnvKnnlaXlm75cclxuICAgICAqIEBwYXJhbSBhdHRhY2htZW50SW5mb1xyXG4gICAgICovXHJcbiAgICBjcmVhdGVJdGVtKGF0dGFjaG1lbnRJbmZvOiBhbnkpIHtcclxuICAgICAgICB2YXIgcG9zID0gYXR0YWNobWVudEluZm8uZmlsZU5hbWUubGFzdEluZGV4T2YoXCIuXCIpO1xyXG4gICAgICAgIHZhciB0eXBlID0gYXR0YWNobWVudEluZm8uZmlsZU5hbWUuc3Vic3RyaW5nKHBvcyArIDEpO1xyXG4gICAgICAgIHR5cGUgPSAodHlwZSA9PSAnJyA/ICdEZWZhdWx0JyA6IHR5cGUudG9Mb3dlckNhc2UoKSk7XHJcbiAgICAgICAgdmFyIGRvY0xpYiA9ICdkb2MtZG9jeC1odG0taHRtbC1qcy1wZGYtcHB0LXBwdHgtcmFyLXppcC10eHQteGxzLXhsc3gnO1xyXG4gICAgICAgIHZhciB2aWRlb0xpYiA9ICd3YXYtYWlmLWFpZmYtYXUtbXAxLW1wMi1tcDMtcmEtcm0tcmFtLW1pZC1ybWknO1xyXG4gICAgICAgIHZhciBhdWRpb0xpYiA9ICdhdmktcm0tcm12Yi1tcGVnLW1wZy1kYXQtbW92LXF0LWFzZi13bS1tcDQnO1xyXG4gICAgICAgIHZhciBpbWdMaWIgPSAnd2VicC1iYWlibXAtZHVwY3gtdGlmLWdpZi1qcGVnLXRnYS1leGlmLWZweC1zdmctcHNkLWNkci1wY2QtZHhmLXVmby1lcHMtYWktcG5nLWhkcmktcmF3LXdtZi1mbGljLWVtZi1pY28tanBnJztcclxuICAgICAgICBpZiAoZG9jTGliLmluZGV4T2YodHlwZSkgPj0gMCkge1xyXG4gICAgICAgICAgICB0eXBlID0gdHlwZS50b0xvd2VyQ2FzZSgpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAodmlkZW9MaWIuaW5kZXhPZih0eXBlKSA+PSAwKSB7XHJcbiAgICAgICAgICAgIHR5cGUgPSAndmlkZW8nO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoYXVkaW9MaWIuaW5kZXhPZih0eXBlKSA+PSAwKSB7XHJcbiAgICAgICAgICAgIHR5cGUgPSAnYXVkaW8nO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoaW1nTGliLmluZGV4T2YodHlwZSkgPj0gMCkge1xyXG4gICAgICAgICAgICB0eXBlID0gJ3BpY3R1cmUnO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHR5cGUgPSAnZGVmYXVsdCc7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0eXBlO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog5rOo5YaM5Li76aKY77yM5bm26I635Y+W5b2T5YmN5Li76aKY5ZSv5LiA5qCH6K+GdG9rZW5cclxuICAgICAqIEBwYXJhbSBzdWJqZWN0Q29kZSDkuLvpopjnvJbnoIHvvIzpnZ7llK/kuIDmoIfor4bvvIx0b2tlbuS4uuWUr+S4gOagh+ivhlxyXG4gICAgICogQHBhcmFtIHRva2VuIOS4u+mimOWUr+S4gOagh+ivhuOAglxyXG4gICAgICogQHJldHVybnMg5Li76aKY55qE5ZSv5LiA5qCH6K+G44CCXHJcbiAgICAgKi9cclxuICAgIHN1YmplY3RSZWdpc3RlcihzdWJqZWN0Q29kZTogc3RyaW5nLCB0b2tlbjogc3RyaW5nKSB7XHJcbiAgICAgICAgcmV0dXJuICh3aW5kb3cgYXMgYW55KS5nc3BmcmFtZXdvcmtTZXJ2aWNlLnJ0Zi5icm9hZGNhc3Quc3ViamVjdFJlZ2lzdGVyKHN1YmplY3RDb2RlLCB7IGZ1bmNJZDogdG9rZW4gfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDnm5HlkKznp7vpmaRcclxuICAgICAqIEBwYXJhbSB0b2tlblxyXG4gICAgICovXHJcbiAgICBzdWJqZWN0UmVtb3ZlKHRva2VuOiBzdHJpbmcpIHtcclxuICAgICAgICAod2luZG93IGFzIGFueSkuZ3NwZnJhbWV3b3JrU2VydmljZS5ydGYuYnJvYWRjYXN0LnN1YmplY3RSZW1vdmUodG9rZW4pO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog6YCa6L+H5p+Q5LiqdG9rZW7lj5HpgIHmtojmga9cclxuICAgICAqIEBwYXJhbSBzdWJqZWN0VG9rZW4g5Li76aKY5ZSv5LiA55qEdG9rZW7moIfor4ZcclxuICAgICAqIEBwYXJhbSBtZXNzYWdlIOimgeWPkemAgeeahOa2iOaBr1xyXG4gICAgICovXHJcbiAgICBzdWJqZWN0Tm90aWZ5KHN1YmplY3RUb2tlbjogc3RyaW5nLCBtZXNzYWdlOiBhbnkpIHtcclxuICAgICAgICAod2luZG93IGFzIGFueSkuZ3NwZnJhbWV3b3JrU2VydmljZS5ydGYuYnJvYWRjYXN0Lm5vdGlmeShzdWJqZWN0VG9rZW4sIG1lc3NhZ2UpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog5re75Yqg6KeC5a+f6ICF77yM5bm255uR5ZCs5raI5oGvXHJcbiAgICAgKiBAcGFyYW0gc3ViamVjdFRva2VuIOS4u+mimHRva2VuXHJcbiAgICAgKiBAcGFyYW0gb2JzZXJ2ZXJUb2tlbiDlvZPliY3nm5HlkKzkuLvpopjnmoTop4Llr5/ogIXllK/kuIDmoIfor4Z0b2tlbuOAguatpOWkhOWbuuWumlxyXG4gICAgICogQHBhcmFtIGhhbmRsZXIg55uR5ZCs5Yiw5raI5oGv5ZCO5omn6KGM55qE5Yqo5L2cXHJcbiAgICAgKi9cclxuICAgIHN1YmplY3RSZXNwb25zZShzdWJqZWN0VG9rZW46IHN0cmluZywgb2JzZXJ2ZXJUb2tlbjogc3RyaW5nLCBoYW5kbGVyOiAodmFsdWU6IGFueSkgPT4gdm9pZCkge1xyXG4gICAgICAgICh3aW5kb3cgYXMgYW55KS5nc3BmcmFtZXdvcmtTZXJ2aWNlLnJ0Zi5icm9hZGNhc3QucmVzcG9uc2Uoc3ViamVjdFRva2VuLCBvYnNlcnZlclRva2VuLCBoYW5kbGVyKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOiOt+WPluWCrOWKnuaooeaLn+e7k+aenFxyXG4gICAgICogQHBhcmFtIGNvbnRleHQg5Y+C5pWwXHJcbiAgICAgKiBAcmV0dXJuc1xyXG4gICAgICovXHJcbiAgICB1cmdlSGFuZGxlU2ltdWxhdGUoY29udGV4dDogVXJnZUhhbmRsZVNpbXVsYXRlQ29udGV4dCk6IE9ic2VydmFibGU8YW55PiB7XHJcbiAgICAgICAgbGV0IHVybCA9IGAvYXBpL3J1bnRpbWUvd2YvdjEuMC9wcm9jZXNzSW5zdGFuY2VzL2dldFVyZ2VIYW5kbGVJbmZvYDtcclxuICAgICAgICByZXR1cm4gdGhpcy5odHRwU3ZjLnBvc3QodXJsLCBjb250ZXh0KTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOaJp+ihjOWCrOWKnlxyXG4gICAgICogQHBhcmFtIGNvbnRleHQg5Y+C5pWwXHJcbiAgICAgKiBAcmV0dXJuc1xyXG4gICAgICovXHJcbiAgICB1cmdlSGFuZGxlKGNvbnRleHQ6IFVyZ2VIYW5kbGVDb250ZXh0KTogT2JzZXJ2YWJsZTxhbnk+IHtcclxuICAgICAgICBsZXQgdXJsID0gYC9hcGkvcnVudGltZS93Zi92MS4wL3Byb2Nlc3NJbnN0YW5jZXMvdXJnZUhhbmRsZWA7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuaHR0cFN2Yy5wb3N0KHVybCwgY29udGV4dCk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoq5om56YeP5pWw5a2X562+5ZCNXHJcbiAgICAgKiBAcGFyYW0gY29udGV4dCDlj4LmlbBcclxuICAgICAqL1xyXG4gICAgYmF0Y2hWZXJpZnlTaWduZWQoY29udGV4dDogQmF0Y2hWZXJpZnlTaWduZWRDb250ZXh0KTogT2JzZXJ2YWJsZTxhbnk+IHtcclxuICAgICAgICBjb25zdCB1cmwgPSBgL2FwaS9ydW50aW1lL3dmL3YxLjAvd29ya0l0ZW1zL2JhdGNoVmVyaWZ5U2lnbmVkYDtcclxuICAgICAgICByZXR1cm4gdGhpcy5odHRwU3ZjLnBvc3QodXJsLCBjb250ZXh0KTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOiOt+WPlueUqOaIt+W4ruWKqeWJjeerr+mFjee9rlxyXG4gICAgICogQHJldHVybnMgXHJcbiAgICAgKi9cclxuICAgIGdldFdmVXNlckhlbHBDb25maWcoKTogT2JzZXJ2YWJsZTxhbnk+IHtcclxuICAgICAgICBsZXQgZGF0ZSA9IG5ldyBEYXRlKCk7XHJcbiAgICAgICAgbGV0IHllYXIgPSBkYXRlLmdldEZ1bGxZZWFyKCk7XHJcbiAgICAgICAgbGV0IG1vbnRoID0gZGF0ZS5nZXRNb250aCgpICsgMTtcclxuICAgICAgICBsZXQgZGF5ID0gZGF0ZS5nZXREYXRlKCk7XHJcbiAgICAgICAgY29uc3QgdXJsID0gYC9wbGF0Zm9ybS9ydW50aW1lL3dmL3dlYi93Zi11c2VyLWhlbHAvY29uZmlnLmpzb24/dj1gICsgeWVhciArIG1vbnRoICsgZGF5O1xyXG4gICAgICAgIHJldHVybiB0aGlzLmh0dHBTdmMuZ2V0KHVybCk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDojrflj5bliqDnrb7phY3nva5cclxuICAgICAqL1xyXG4gICAgZ2V0QWRob2NDb25maWcod29ya0l0ZW1JZDogc3RyaW5nKTogT2JzZXJ2YWJsZTxhbnk+IHtcclxuICAgICAgICBsZXQgdXJsID0gYC9hcGkvcnVudGltZS93Zi92MS4wL3dvcmtJdGVtcy8ke3dvcmtJdGVtSWR9L2FkaG9jQ29uZmlnL0FkZFNpZ25CZWhpbmRgO1xyXG4gICAgICAgIHJldHVybiB0aGlzLmh0dHBTdmMuZ2V0KHVybCk7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIOWKoOetvuaPkOS6pFxyXG4gICAgICovXHJcbiAgICBhZGhvY0Fzc2lnbmVlKHBheWxvYWQ6IEFkZFNpZ25QYXlsb2FkKSB7XHJcbiAgICAgICAgbGV0IHVybCA9IGAvYXBpL3J1bnRpbWUvd2YvdjEuMC93b3JrSXRlbXMvYWRob2NBc3NpZ25lZWA7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuaHR0cFN2Yy5wb3N0KHVybCwgcGF5bG9hZCk7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIOWPlua2iOW+geivolxyXG4gICAgICovXHJcbiAgICBjYW5jZWxDb25zdWx0KHBheWxvYWQ6IFdvcmtJdGVtRXhlY3V0ZVBhcmFtKSB7XHJcbiAgICAgICAgbGV0IHVybCA9IGAvYXBpL3J1bnRpbWUvd2YvdjEuMC93b3JrSXRlbXMvY2FuY2VsQ29uc3VsdGA7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuaHR0cFN2Yy5wb3N0KHVybCwgcGF5bG9hZCk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDliKTmlq3mmK/lkKZpblN1aXRl546v5aKDXHJcbiAgICAgKi9cclxuICAgIGlzSW5TdWl0ZSgpOiBib29sZWFuIHtcclxuICAgICAgICBjb25zdCBmcmFtZVdvcmtTZXJ2aWNlID0gKHdpbmRvdyBhcyBhbnkpLmdzcGZyYW1ld29ya1NlcnZpY2U7XHJcbiAgICAgICAgaWYgKGZyYW1lV29ya1NlcnZpY2UgJiYgZnJhbWVXb3JrU2VydmljZS5ydGYpIHtcclxuICAgICAgICAgICAgY29uc3QgZXh0ZW5kTWV0aG9kID0gZnJhbWVXb3JrU2VydmljZS5ydGYuZXh0ZW5kTWV0aG9kO1xyXG4gICAgICAgICAgICBpZiAoZXh0ZW5kTWV0aG9kICYmIGV4dGVuZE1ldGhvZC5nZXRFeHRPYmooKSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGV4dE9iaiA9IGV4dGVuZE1ldGhvZC5nZXRFeHRPYmooKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG1vZGUgPSBleHRPYmouaUdJWDRpblN1aXRlTW9kZSgpO1xyXG4gICAgICAgICAgICAgICAgaWYgKG1vZGUpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDojrflj5blrZfnrKbkuLLlrZfoioLplb/luqZcclxuICAgICAqL1xyXG4gICAgZ2V0Qnl0ZXNMZW5ndGgoc3RyKSB7XHJcbiAgICAgICAgLy8g5ZyoR0JL57yW56CB6YeM77yM6Zmk5LqGQVNDSUnlrZfnrKbvvIzlhbblroPpg73ljaDkuKTkuKrlrZfnrKblrr1cclxuICAgICAgICByZXR1cm4gc3RyLnJlcGxhY2UoL1teXFx4MDAtXFx4ZmZdL2csICd4eCcpLmxlbmd0aDtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOiOt+WPlnRvcCB3aW5kb3dcclxuICAgICAqIEByZXR1cm5zIFxyXG4gICAgICovXHJcbiAgICBnZXRUb3BXaW5kb3coKTogV2luZG93IHtcclxuICAgICAgICBsZXQgY3VyV2luOiBXaW5kb3cgPSB3aW5kb3cuc2VsZjtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICB3aGlsZSAoY3VyV2luLmxvY2F0aW9uLm9yaWdpbiA9PT0gY3VyV2luLnBhcmVudC5sb2NhdGlvbi5vcmlnaW4pIHtcclxuICAgICAgICAgICAgICAgIGlmIChjdXJXaW4gIT09IGN1cldpbi5wYXJlbnQgJiYgIShjdXJXaW4gYXMgYW55KS5pc1JURlRvcFdpbikge1xyXG4gICAgICAgICAgICAgICAgICAgIGN1cldpbiA9IGN1cldpbi5wYXJlbnQ7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBjYXRjaCAoZSkgeyB9XHJcbiAgICAgICAgcmV0dXJuIGN1cldpbjtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOW8ueWHuumUmeivr+aPkOekulxyXG4gICAgICogQHBhcmFtIGVycm9yIFxyXG4gICAgICovXHJcbiAgICBoYW5kbGVFcnJvckxldmVsKGVycm9yTWVzc2FnZTogYW55KTogdm9pZCB7XHJcbiAgICAgICAgaWYgKGVycm9yTWVzc2FnZSAmJiBlcnJvck1lc3NhZ2Uuc3RhdHVzIDwgNTAwKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgbGV0IGVycm9yID0gZXJyb3JNZXNzYWdlLmVycm9yIGFzIFNlcnZlckV4Y2VwdGlvbkVudGl0eTtcclxuICAgICAgICBjb25zdCBleGNlcHRpb25Nc2cgPSBlcnJvci5NZXNzYWdlIHx8ICcnO1xyXG4gICAgICAgIGNvbnN0IGRhdGUgPSBlcnJvci5kYXRlIHx8IG5ldyBEYXRlKCk7XHJcbiAgICAgICAgY29uc3QgbG9jYWxEYXRlID0gZGF0ZTtcclxuICAgICAgICBjb25zdCBkZXRhaWwgPSBlcnJvci5EZXRhaWwgfHwgYCR7ZXJyb3IuTWVzc2FnZX1cXHJcXG7lj5HnlJ/ml7bpl7TvvJoke2xvY2FsRGF0ZX1cXHJcXG7or6bnu4bkv6Hmga/vvJoke2Vycm9yLmlubmVyTWVzc2FnZX1gIHx8ICcnO1xyXG5cclxuICAgICAgICBjb25zdCBpbm5lck1lc3NhZ2UgPSBlcnJvci5pbm5lck1lc3NhZ2UgfHwgbnVsbDtcclxuICAgICAgICBsZXQgYnNNb2RhbFJlZjogQnNNb2RhbFJlZjtcclxuICAgICAgICBjb25zdCBvcHRpb25zID0ge1xyXG4gICAgICAgICAgICBzaG93TWF4QnV0dG9uOiBmYWxzZSxcclxuICAgICAgICAgICAgYnV0dG9uczogW1xyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIHRleHQ6ICfnn6XpgZPkuoYnLFxyXG4gICAgICAgICAgICAgICAgICAgIGNsczogJ2J0biBidG4tcHJpbWFyeSBidG4tbGcnLFxyXG4gICAgICAgICAgICAgICAgICAgIGhhbmRsZTogKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBic01vZGFsUmVmLmNsb3NlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBdLFxyXG4gICAgICAgICAgICB3aWR0aDogNDQwLFxyXG4gICAgICAgICAgICBoZWlnaHQ6IDIwMCxcclxuICAgICAgICAgICAgc2FmZUh0bWw6IGZhbHNlLFxyXG4gICAgICAgICAgICBleGNlcHRpb246IHtcclxuICAgICAgICAgICAgICAgIGRhdGU6IGxvY2FsRGF0ZSxcclxuICAgICAgICAgICAgICAgIG1lc3NhZ2U6IGlubmVyTWVzc2FnZSxcclxuICAgICAgICAgICAgICAgIGNvcHlCdXR0b246IHtcclxuICAgICAgICAgICAgICAgICAgICB0ZXh0OiAn5aSN5Yi26K+m57uG5L+h5oGvJyxcclxuICAgICAgICAgICAgICAgICAgICBvbkNsaWNrOiAoZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCByZXN1bHQgPSB0aGlzLmNvcHlUb0NsaXBib2FyZChkZXRhaWwpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBic01vZGFsUmVmLmNvbnRlbnQuc2hvd01pbmlOb3RpZnkocmVzdWx0LCAxNTAwKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICAgIGJzTW9kYWxSZWYgPSB0aGlzLm1lc3NhZ2Uuc2hvdygnZXhjZXB0aW9uJywgZXhjZXB0aW9uTXNnLCBvcHRpb25zKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOi1i+WAvOWIsOeymOi0tOadv1xyXG4gICAgICogQHBhcmFtIHRleHQgXHJcbiAgICAgKiBAcmV0dXJucyBcclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBjb3B5VG9DbGlwYm9hcmQodGV4dCk6IGJvb2xlYW4ge1xyXG4gICAgICAgIGNvbnN0IHdpbmRvd1JlZjogYW55ID0gd2luZG93O1xyXG4gICAgICAgIGlmICh3aW5kb3dSZWYuY2xpcGJvYXJkRGF0YSAmJiB3aW5kb3dSZWYuY2xpcGJvYXJkRGF0YS5zZXREYXRhKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB3aW5kb3dSZWYuY2xpcGJvYXJkRGF0YS5zZXREYXRhKFwiVGV4dFwiLCB0ZXh0KTtcclxuICAgICAgICB9IGVsc2UgaWYgKGRvY3VtZW50LnF1ZXJ5Q29tbWFuZFN1cHBvcnRlZCAmJiBkb2N1bWVudC5xdWVyeUNvbW1hbmRTdXBwb3J0ZWQoXCJjb3B5XCIpKSB7XHJcbiAgICAgICAgICAgIHZhciB0ZXh0YXJlYSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJ0ZXh0YXJlYVwiKTtcclxuICAgICAgICAgICAgdGV4dGFyZWEudGV4dENvbnRlbnQgPSB0ZXh0O1xyXG4gICAgICAgICAgICB0ZXh0YXJlYS5zdHlsZS5wb3NpdGlvbiA9IFwiZml4ZWRcIjtcclxuICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZCh0ZXh0YXJlYSk7XHJcbiAgICAgICAgICAgIHRleHRhcmVhLnNlbGVjdCgpO1xyXG4gICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGRvY3VtZW50LmV4ZWNDb21tYW5kKFwiY29weVwiKTtcclxuICAgICAgICAgICAgfSBjYXRjaCAoZXgpIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybihcIkNvcHkgdG8gY2xpcGJvYXJkIGZhaWxlZC5cIiwgZXgpO1xyXG4gICAgICAgICAgICB9IGZpbmFsbHkge1xyXG4gICAgICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZCh0ZXh0YXJlYSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG5cclxufVxyXG4iXX0=