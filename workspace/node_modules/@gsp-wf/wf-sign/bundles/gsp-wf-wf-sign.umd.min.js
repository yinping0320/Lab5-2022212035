!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("signature_pad/dist/signature_pad.umd"),require("@angular/core")):"function"==typeof define&&define.amd?define("@gsp-wf/wf-sign",["exports","signature_pad/dist/signature_pad.umd","@angular/core"],e):e((t["gsp-wf"]=t["gsp-wf"]||{},t["gsp-wf"]["wf-sign"]={}),t.sp,t.ng.core)}(this,function(t,e,n){"use strict";e=e&&e.hasOwnProperty("default")?e["default"]:e;var i=function(){function t(){}return t.decorators=[{type:n.Injectable,args:[{providedIn:"root"}]}],t.ctorParameters=function(){return[]},t.ngInjectableDef=n.defineInjectable({factory:function(){return new t},token:t,providedIn:"root"}),t}(),a=function(){function t(){}return t.prototype.ngOnInit=function(){},t.decorators=[{type:n.Component,args:[{selector:"wf-sign-wf-sign",template:"\n    <p>\n      wf-sign works!\n    </p>\n  "}]}],t.ctorParameters=function(){return[]},t}(),s=function(){function t(t){this.elementRef=t,this.options=this.options||{},this.onBeginEvent=new n.EventEmitter,this.onEndEvent=new n.EventEmitter}return t.prototype.ngAfterContentInit=function(){var t=this.elementRef.nativeElement.querySelector("canvas");this.options.canvasHeight&&(t.height=this.options.canvasHeight),this.options.canvasWidth&&(t.width=this.options.canvasWidth),this.signaturePad=new e(t,this.options),this.signaturePad.onBegin=this.onBegin.bind(this),this.signaturePad.onEnd=this.onEnd.bind(this)},t.prototype.ngOnDestroy=function(){var t=this.elementRef.nativeElement.querySelector("canvas");t.width=0,t.height=0},t.prototype.resizeCanvas=function(){var t=Math.max(window.devicePixelRatio||1,1),e=this.signaturePad.canvas;e.width=e.offsetWidth*t,e.height=e.offsetHeight*t,e.getContext("2d").scale(t,t),this.signaturePad.clear()},t.prototype.setWaterMark=function(t){var e=this.elementRef.nativeElement.querySelector("canvas").getContext("2d");e.font="20px 微软雅黑",e.fillStyle="#888",e.fillText(t,10,50)},t.prototype.setImageBackground=function(){for(var t=this.elementRef.nativeElement.querySelector("canvas").getContext("2d"),e=t.getImageData(0,0,this.options.canvasWidth,this.options.canvasHeight),n=0;n<e.data.length;n+=4)0==e.data[n+3]&&(e.data[n]=255,e.data[n+1]=255,e.data[n+2]=255,e.data[n+3]=255);t.putImageData(e,0,0)},t.prototype.setBackgroundImage=function(t){this.elementRef.nativeElement.querySelector("canvas").getContext("2d").drawImage(t,0,0)},t.prototype.toData=function(){return this.signaturePad?this.signaturePad.toData():[]},t.prototype.fromData=function(t){this.signaturePad.fromData(t)},t.prototype.toDataURL=function(t,e){return this.signaturePad.toDataURL(t,e)},t.prototype.fromDataURL=function(t,e){void 0===e&&(e={}),!e.hasOwnProperty("height")&&this.options.canvasHeight&&(e.height=this.options.canvasHeight),!e.hasOwnProperty("width")&&this.options.canvasWidth&&(e.width=this.options.canvasWidth),this.signaturePad.fromDataURL(t,e)},t.prototype.clear=function(){this.signaturePad.clear()},t.prototype.isEmpty=function(){return this.signaturePad.isEmpty()},t.prototype.off=function(){this.signaturePad.off()},t.prototype.on=function(){this.signaturePad.on()},t.prototype.set=function(t,e){switch(t){case"canvasHeight":this.signaturePad.canvas.height=e;break;case"canvasWidth":this.signaturePad.canvas.width=e;break;default:this.signaturePad[t]=e}},t.prototype.onBegin=function(){this.onBeginEvent.emit(!0)},t.prototype.onEnd=function(){this.onEndEvent.emit(!0)},t.prototype.queryPad=function(){return this.signaturePad},t.decorators=[{type:n.Component,args:[{template:"<canvas></canvas>",selector:"wf-sign-signature"}]}],t.ctorParameters=function(){return[{type:n.ElementRef}]},t.propDecorators={options:[{type:n.Input}],onBeginEvent:[{type:n.Output}],onEndEvent:[{type:n.Output}]},t}(),o=function(){function t(){this.toDataUrlEvent=new n.EventEmitter,this.isDrawEvent=new n.EventEmitter,this.imageType="image/png",this.imageQuality=1,this.isDraw=!1,this.signaturePadOptions={minWidth:1,canvasWidth:500,canvasHeight:240}}return t.prototype.ngOnInit=function(){},t.prototype.ngAfterViewInit=function(){this.signaturePad.set("minWidth",1),this.signaturePad.set("canvasWidth",this.canvasDiv.nativeElement.clientWidth),this.signaturePad.clear(),this.signaturePad.setImageBackground()},t.prototype.confirm=function(){console.log(this.signaturePad.toDataURL(this.imageType,this.imageQuality)),this.signaturePad.setWaterMark(new Date),this.toDataUrlEvent.emit(this.signaturePad.toDataURL(this.imageType,this.imageQuality))},t.prototype.reset=function(){this.signaturePad.clear(),this.isDraw=!1,this.isDrawEvent.emit(this.isDraw)},t.prototype.drawComplete=function(){this.isDraw=!0,this.isDrawEvent.emit(this.isDraw)},t.prototype.drawStart=function(){console.log("begin drawing")},t.decorators=[{type:n.Component,args:[{selector:"wf-sign-sign",template:'<div class="fm-feature-suggestion fm-feature-section--gutter">\r\n    <div #canvastitle style="padding:2px 2px 2px 0;text-align:left;width:100%;height: 21px;">\r\n        <span style="font-size: 15px;color: #999999;">签名区域</span>\r\n      </div>\r\n      <wf-sign-signature  [options]="signaturePadOptions" (onBeginEvent)="drawStart()" (onEndEvent)="drawComplete()"></wf-sign-signature>\r\n  <div class="fm-feature-suggestion--bar">\r\n    <ul class="suggestion--bar-common">\r\n      <li class="suggestion--bar-item" (click)="confirm()">\r\n        <span>确认</span>\r\n      </li>\r\n      <li class="suggestion--bar-item" (click)="reset()">\r\n        <span>重置</span>\r\n      </li>\r\n    </ul>\r\n  </div>\r\n</div>\r\n',styles:[".fm-page-main1{overflow:hidden}.fm-utils-flex-column{display:flex;flex-direction:column}.fm-page{position:absolute;top:0;left:0;bottom:0;right:0;display:flex;flex-direction:column;background:#fff;font-size:13px;line-height:18px}.fm-page-main{flex-basis:0;flex-shrink:1;flex-grow:1;overflow-x:hidden;overflow-y:auto;position:relative}.fm-feature-section--gutter{margin:0 0 12px}.fm-feature-suggestion{background:#fff;padding:12px 16px}.fm-feature-suggestion .fm-feature-suggestion--bar{display:flex;flex-direction:row;align-items:center;color:#888}"]}]}],t.ctorParameters=function(){return[]},t.propDecorators={signaturePad:[{type:n.ViewChild,args:[s]}],canvasDiv:[{type:n.ViewChild,args:["canvastitle"]}],toDataUrlEvent:[{type:n.Output}],isDrawEvent:[{type:n.Output}],imageType:[{type:n.Input}],imageQuality:[{type:n.Input}]},t}(),r=function(){function t(){this.imageType="image/png",this.imageQuality=1,this.title="请对审批意见进行签字确认",this.isDraw=!1,this.signaturePadOptions={minWidth:1,canvasWidth:500,canvasHeight:240}}return t.prototype.ngOnInit=function(){},t.prototype.ngAfterViewInit=function(){if(this.signaturePad.set("minWidth",1),this.signaturePad.set("canvasWidth",this.canvasDiv.nativeElement.clientWidth),this.signaturePad.clear(),this.signaturePad.setImageBackground(),this.image){var t=new Image;t.src=this.image,this.signaturePad.setBackgroundImage(t)}},t.prototype.confirm=function(){return console.log(this.signaturePad.toDataURL(this.imageType,this.imageQuality)),this.signaturePad.toDataURL(this.imageType,this.imageQuality)},t.prototype.reset=function(){this.signaturePad.clear(),this.signaturePad.setImageBackground(),this.isDraw=!1},t.prototype.drawComplete=function(){this.isDraw=!0},t.prototype.drawStart=function(){console.log("begin drawing")},t.prototype.initCanvasByImage=function(t){this.signaturePad.setBackgroundImage(t)},t.decorators=[{type:n.Component,args:[{selector:"wf-sign-here",template:'<div class="fm-feature-suggestion fm-feature-section--gutter">\r\n    <div style="padding:2px 2px 2px 0;text-align:left;width:100%;height: 21px;">\r\n        <span style="font-size: 15px;color: #999999;">{{title}}</span>\r\n      </div>\r\n      <div class="wf-sign-signature-docker">\r\n      <div #canvastitle class="wf-sign-signature">\r\n      <wf-sign-signature  [options]="signaturePadOptions" (onBeginEvent)="drawStart()" (onEndEvent)="drawComplete()"></wf-sign-signature>\r\n    </div>\r\n</div>\r\n</div>\r\n',styles:[".fm-page-main1{overflow:hidden}.fm-utils-flex-column{display:flex;flex-direction:column}.fm-page{position:absolute;top:0;left:0;bottom:0;right:0;display:flex;flex-direction:column;background:#fff;font-size:13px;line-height:18px}.fm-page-main{flex-basis:0;flex-shrink:1;flex-grow:1;overflow-x:hidden;overflow-y:auto;position:relative}.fm-feature-section--gutter{margin:0 0 12px}.fm-feature-suggestion{background:#fff;padding:12px 16px}.fm-feature-suggestion .fm-feature-suggestion--bar{display:flex;flex-direction:row;align-items:center;color:#888}.wf-sign-signature{margin:1px}.wf-sign-signature-docker{border:1px dashed #ddd;margin-left:4px;margin-right:4px}"]}]}],t.ctorParameters=function(){return[]},t.propDecorators={signaturePad:[{type:n.ViewChild,args:[s]}],canvasDiv:[{type:n.ViewChild,args:["canvastitle"]}],imageType:[{type:n.Input}],imageQuality:[{type:n.Input}],title:[{type:n.Input}],image:[{type:n.Input}]},t}(),g=function(){function t(){}return t.decorators=[{type:n.NgModule,args:[{declarations:[a,s,o,r],imports:[],exports:[a,s,o,r]}]}],t}();t.WfSignService=i,t.WfSignComponent=a,t.WfSignModule=g,t.SignHereComponent=r,t.ɵb=o,t.ɵa=s,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=gsp-wf-wf-sign.umd.min.js.map