{"version":3,"file":"gsp-wf-ui-comment.umd.js.map","sources":["ng://@gsp-wf/ui-comment/lib/services/task-comment.service.ts","node_modules/tslib/tslib.es6.js","ng://@gsp-wf/ui-comment/lib/task-comment/task-comment.uistate.ts","ng://@gsp-wf/ui-comment/lib/entities/comment.ts","ng://@gsp-wf/ui-comment/lib/task-comment/task-comment.viewmodel.ts","ng://@gsp-wf/ui-comment/lib/entities/attachment.ts","ng://@gsp-wf/ui-comment/lib/task-comment/task-comment.component.ts","ng://@gsp-wf/ui-comment/lib/services/i18n/en.ts","ng://@gsp-wf/ui-comment/lib/services/i18n/zh-chs.ts","ng://@gsp-wf/ui-comment/lib/services/i18n/zh-cht.ts","ng://@gsp-wf/ui-comment/lib/services/i18n/index.ts","ng://@gsp-wf/ui-comment/lib/services/i18n.service.ts","ng://@gsp-wf/ui-comment/lib/services/translate.pipe.ts","ng://@gsp-wf/ui-comment/lib/model/task-comment.repository.ts","ng://@gsp-wf/ui-comment/lib/wf-comment.module.ts"],"sourcesContent":["import { HttpHeaders } from '@angular/common/http';\r\nimport { Injectable } from '@angular/core';\r\nimport { HttpService } from '@ecp-caf/caf-common';\r\nimport { Observable } from 'rxjs';\r\nimport { FileDeleteEntity, FileUploadEntity } from '../entities/attachment';\r\n\r\n@Injectable()\r\nexport class TaskCommentService {\r\n\r\n  constructor(\r\n    private httpSvc: HttpService,\r\n  ) { }\r\n\r\n  static newId() {\r\n    const S4 = () => (((1 + Math.random()) * 0x10000) | 0).toString(16).substring(1);\r\n    return (S4() + S4() + '-' + S4() + '-' + S4() + '-' + S4() + '-' + S4() + S4() + S4());\r\n  }\r\n\r\n\r\n  getCommentList(): Observable<any> {\r\n    const url = `/api/runtime/wf/v1.0/commonComments`;\r\n    return this.httpSvc.get(url);\r\n  }\r\n\r\n  addComment(): Observable<any> {\r\n    const url = `/api/runtime/wf/v1.0/commonComments`;\r\n    return this.httpSvc.post(url, {});\r\n  }\r\n\r\n  /**\r\n    * è·åä»»å¡ä¸­å¿éç½®é¡¹\r\n    * @param code éç½®é¡¹çCode\r\n    */\r\n  getTaskCenterConfigByCode(code: string): Observable<any> {\r\n    const url = `/api/runtime/task/v1.0/task-center-setting/code?code=${code}`;\r\n    return this.httpSvc.get(url);\r\n  }\r\n\r\n  /**\r\n   * çæ­£ä¸ä¼ éä»¶\r\n   * @param files\r\n   */\r\n  uploadAttachment(files: FileUploadEntity): Observable<any> {\r\n    let url = `/api/runtime/dfs/v1.0/doc/commit`;\r\n    return this.httpSvc.put(url, files);\r\n  }\r\n\r\n  /**\r\n   * å é¤éä»¶\r\n   * @param fileDeleteEntity \r\n   */\r\n  deleteAttachment(fileDeleteEntity: FileDeleteEntity): Observable<any> {\r\n    let url = `/api/runtime/dfs/v1.0/doc`;\r\n    return this.httpSvc.delete(url, fileDeleteEntity);\r\n  }\r\n}\r\n","/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    if (typeof b !== \"function\" && b !== null)\r\n        throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport var __createBinding = Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n});\r\n\r\nexport function __exportStar(m, o) {\r\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(o, p)) __createBinding(o, m, p);\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n}\r\n\r\nexport function __spreadArray(to, from, pack) {\r\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\r\n        if (ar || !(i in from)) {\r\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\r\n            ar[i] = from[i];\r\n        }\r\n    }\r\n    return to.concat(ar || Array.prototype.slice.call(from));\r\n}\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nvar __setModuleDefault = Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, state, kind, f) {\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\r\n    return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, state, value, kind, f) {\r\n    if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\r\n    return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { CommonComment } from '../entities/comment';\r\n\r\n@Injectable()\r\nexport class TaskCommentUIState {\r\n    commentList: CommonComment[] = [];\r\n    comments: string[] = [];\r\n    originCommentIds: string[];\r\n    changesCommentIds: string[] = [];\r\n    curComment: CommonComment;\r\n}\r\n","import { TaskCommentService } from '../services/task-comment.service';\r\n\r\nexport class CommonComment {\r\n    id: string;\r\n    userId?: string;\r\n    message: string;\r\n    sortOrder?: number;\r\n    static newEntity(): CommonComment {\r\n        return {\r\n            id: TaskCommentService.newId(),\r\n            message: ''\r\n        };\r\n    }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { TaskCommentUIState } from './task-comment.uistate';\r\nimport { CommonComment } from '../entities/comment';\r\nimport { Observable, forkJoin } from 'rxjs';\r\nimport { HttpService } from '@ecp-caf/caf-common';\r\n\r\n@Injectable()\r\nexport class TaskCommentViewModel {\r\n    constructor(\r\n        private uiState: TaskCommentUIState,\r\n        private httpSvc: HttpService) {\r\n    }\r\n    add() {\r\n        const newEntity = CommonComment.newEntity();\r\n        newEntity.sortOrder = this.uiState.commentList.length + 1;\r\n        this.uiState.commentList.push(newEntity);\r\n    }\r\n    delete() {\r\n        if (this.uiState.curComment) {\r\n            const index = this.uiState.commentList.findIndex(c => c.id === this.uiState.curComment.id);\r\n            if (index > -1) {\r\n                this.uiState.commentList.splice(index, 1);\r\n            }\r\n        }\r\n    }\r\n\r\n    save(): Observable<any> {\r\n        const url = `/api/runtime/wf/v1.0/commonComments`;\r\n\r\n        const deleteIds = this.uiState.originCommentIds.filter(id => this.uiState.commentList.findIndex(c => c.id === id) < 0);\r\n        const addEntities = this.uiState.commentList.filter(item => this.uiState.originCommentIds.indexOf(item.id) < 0);\r\n        const changesList = this.uiState.commentList.filter(item => addEntities.findIndex(aItem => aItem.id === item.id) < 0\r\n            && this.uiState.changesCommentIds.indexOf(item.id) > -1);\r\n        return forkJoin(deleteIds.map(id => this.httpSvc.delete(url + `/${id}`, null))\r\n            .concat(changesList.map(change => this.httpSvc.patch(url, change)))\r\n            .concat(addEntities.map(add => this.httpSvc.post(url, add))));\r\n    }\r\n}\r\n","\r\n/**\r\n * æ§è¡ä¸ä¼ éä»¶å®ä½\r\n */\r\nexport class FileUploadEntity {\r\n\r\n    rootId: string;\r\n\r\n    metadataIdList: string[];\r\n}\r\n\r\n/**\r\n * æ§è¡å é¤éä»¶æéå®ä½\r\n */\r\nexport class FileDeleteEntity {\r\n\r\n    rootId: String;\r\n\r\n    metadataId: String;\r\n\r\n    mode: String;\r\n}","import {\r\n  Component,\r\n  OnInit,\r\n  Input,\r\n  ViewChild,\r\n  forwardRef,\r\n  Injector,\r\n  ComponentFactoryResolver,\r\n  Output, EventEmitter, Optional\r\n} from '@angular/core';\r\nimport { TaskCommentService } from '../services/task-comment.service';\r\nimport { TaskCommentViewModel } from './task-comment.viewmodel';\r\nimport { TaskCommentUIState } from './task-comment.uistate';\r\nimport { DialogComponent } from '@farris/ui-dialog';\r\nimport { ControlValueAccessor, NG_VALUE_ACCESSOR, FormGroup, FormBuilder } from '@angular/forms';\r\nimport { CommonComment } from '../entities/comment';\r\nimport { GridComponent } from '@progress/kendo-angular-grid';\r\nimport { FDropdownDirective } from '@farris/ui-dropdown';\r\nimport { UploadDialogService } from '@gsp-svc/formdoc-upload';\r\nimport { DatagridComponent } from \"@farris/ui-datagrid\";\r\nimport { MessagerService } from '@farris/ui-messager';\r\nimport { FileDeleteEntity, FileUploadEntity } from '../entities/attachment';\r\n\r\n@Component({\r\n  selector: 'wf-comment',\r\n  templateUrl: './task-comment.component.html',\r\n  styleUrls: ['./task-comment.component.scss'],\r\n  providers: [{\r\n    provide: NG_VALUE_ACCESSOR,\r\n    useExisting: forwardRef(() => TaskCommentComponent),\r\n    multi: true\r\n  },]\r\n})\r\n\r\n/**\r\n * æ­¤å·¥ç¨å·²åºå¼ä¸åä½¿ç¨ï¼æ´æ°ä¸ºwf-task-handlerçtask-commentç»ä»¶ by fangpengfei@2021.1.13\r\n */\r\nexport class TaskCommentComponent implements OnInit, ControlValueAccessor {\r\n\r\n  // é»è®¤åçæè§\r\n  @Input() comment: string;\r\n  @Input() placeholder = '';\r\n  @Input() processInstanceId: string;\r\n  @Input() set actionCode(actionCode: string) {\r\n    if (actionCode === 'Claim' || actionCode === 'AssignUser') {\r\n      this.showUploadAttachment = false;\r\n    } else {\r\n      this.showUploadAttachment = true;\r\n    }\r\n  }\r\n\r\n  @Output() attachment: any = new EventEmitter();\r\n  @ViewChild(DialogComponent) commentDialog: DialogComponent;\r\n  @ViewChild('commentGrid') commentGrid: GridComponent;\r\n  @ViewChild('dropdownEl') dropDownEl: FDropdownDirective;//è§£å³éæ©æè§åï¼ä¸æèåæ æ³æ¶æçé®é¢\r\n  @ViewChild('grid') grid: DatagridComponent;\r\n  \r\n  private _value = '';\r\n  attachmentList: any[] = [];\r\n  selectValue: string;\r\n  textAreaHeight: number = 120;\r\n  messageService: MessagerService;\r\n  isRepeat = false; // éå¤éä»¶æ ¡éª\r\n  ifShowAttachment: boolean = true;//ä»»å¡ä¸­å¿éç½®ï¼æ¯å¦æ¾ç¤ºéä»¶ä¸ä¼ \r\n  showUploadAttachment = true;\r\n\r\n  set value(v) {\r\n    if (this._value !== v) {\r\n      this._value = v;\r\n      this.onModelChange(v);\r\n    }\r\n\r\n  }\r\n  get value() {\r\n    return this._value;\r\n  }\r\n\r\n  @Input()\r\n  set TextAreaHeight(height: number) {\r\n    this.textAreaHeight = height;\r\n  }\r\n\r\n  onModelChange = (obj: any) => { };\r\n  onModelTouched = (obj: any) => { };\r\n\r\n  uploadDialog: UploadDialogService;\r\n  resolver: ComponentFactoryResolver;\r\n  // æé æ¹æ³ä¸å¯å¨ï¼é¡ºåºä¸è¦æ¹åï¼ä½¿ç¨æ°ç\r\n  constructor(\r\n    private commentSvc: TaskCommentService,\r\n    public viewModel: TaskCommentViewModel,\r\n    public uiState: TaskCommentUIState,\r\n    private formBuilder: FormBuilder,\r\n    @Optional() private injector: Injector,\r\n  ) {\r\n    this.injector && (this.uploadDialog = this.injector.get(UploadDialogService));\r\n    this.injector && (this.messageService = this.injector.get(MessagerService));\r\n  }\r\n\r\n  ngOnInit() {\r\n    // è·åå¸¸ç¨æè§åè¡¨\r\n    this.loadComments();\r\n    this.commentSvc.getTaskCenterConfigByCode('If_Show_Attachment').subscribe(re => {\r\n      re && re.currentValue === 'false' && (this.ifShowAttachment = false);\r\n    })\r\n  }\r\n\r\n  onEditComment() {\r\n    this.commentDialog.show();\r\n  }\r\n\r\n  save() {\r\n    this.commentGrid.closeCell();\r\n    this.viewModel.save().subscribe(r => {\r\n      this.loadComments();\r\n      this.commentDialog.close();\r\n    });\r\n  }\r\n\r\n  loadComments() {\r\n    this.commentSvc.getCommentList().subscribe((data: any[]) => {\r\n      this.uiState.commentList = data;\r\n      this.uiState.originCommentIds = data.map(d => d.id);\r\n      this.uiState.comments = data.map(d => d.message);\r\n    });\r\n  }\r\n\r\n  public cellClickHandler({ sender, rowIndex, columnIndex, dataItem, isEdited }) {\r\n    this.uiState.curComment = dataItem;\r\n    if (!isEdited) {\r\n      sender.editCell(rowIndex, columnIndex, this.createFormGroup(dataItem));\r\n    }\r\n  }\r\n\r\n  public cellCloseHandler(args: any) {\r\n    const { formGroup, dataItem, column } = args;\r\n    if (!formGroup.valid) {\r\n      args.preventDefault();\r\n    } else if (formGroup.dirty) {\r\n      if (this.uiState.originCommentIds.findIndex(d => d === dataItem.id) > -1\r\n        && this.uiState.changesCommentIds.findIndex(id => id === dataItem.id) < 0) {\r\n        this.uiState.changesCommentIds.push(dataItem.id);\r\n      }\r\n      Object.assign(dataItem, formGroup.value);\r\n    }\r\n  }\r\n\r\n  public createFormGroup(dataItem: CommonComment): FormGroup {\r\n    return this.formBuilder.group({\r\n      message: dataItem.message,\r\n      sortOrder: dataItem.sortOrder,\r\n    });\r\n  }\r\n\r\n  writeValue(value: string) {\r\n    if (value !== this.value) {\r\n      this.value = value;\r\n    }\r\n  }\r\n\r\n  registerOnChange(fn) {\r\n    this.onModelChange = fn;\r\n  }\r\n\r\n  registerOnTouched(fn) {\r\n    this.onModelTouched = fn;\r\n  }\r\n\r\n  buttonClick(data: any) {\r\n    this.dropDownEl.close();\r\n    this.value = data;\r\n  }\r\n\r\n  uploadAttachment() {\r\n    if (this.uploadDialog) {\r\n      this.uploadDialog.uploadFile(this.processInstanceId, 'wf_attachment').then(re => {\r\n        for (let i of (re as any[])) {\r\n          this.isRepeat = false;\r\n          for (let attach of this.attachmentList) {\r\n            if (attach.fileName === i.fileName) {\r\n              this.messageService.info('åå«éå¤æä»¶' + i.fileName);\r\n              this.isRepeat = true;\r\n              break;\r\n            }\r\n          }\r\n          if (!this.isRepeat) {\r\n            this.attachmentList.push(i);\r\n          }\r\n        }\r\n        this.attachment.emit(this.attachmentList);\r\n        //æ§è¡ä¸ä¼ éä»¶\r\n        let files = new FileUploadEntity();\r\n        files.rootId = \"wf_attachment\";\r\n        files.metadataIdList = [];\r\n        this.attachmentList.forEach( a => {\r\n          files.metadataIdList.push(a.metadataId);\r\n        })\r\n        files.metadataIdList.length && this.commentSvc.uploadAttachment(files).subscribe(() => {});\r\n      });\r\n    } else {\r\n      throw new Error(\"ä½¿ç¨éä»¶ä¸ä¼ åè½ï¼è¯·åçº§è¡¨å\");\r\n    }\r\n  }\r\n\r\n  attachmentDelete(attachment) {\r\n    var gspDocDeleteEntity: FileDeleteEntity = {\r\n      rootId: \"wf_attachment\",\r\n      metadataId: attachment.metadataId,\r\n      mode: \"Formal\"\r\n    }\r\n    let index = this.attachmentList.indexOf(attachment);\r\n    if (index > -1) {\r\n      this.attachmentList.splice(index, 1);\r\n    }\r\n    this.attachment.emit(this.attachmentList);\r\n    this.commentSvc.deleteAttachment(gspDocDeleteEntity).subscribe(() => {});\r\n  }\r\n\r\n  imageUrl(attachmentInfo) {\r\n    return '/platform/runtime/wf/webapp/mobiletaskcenter/assets/accessory/' + this.createItem(attachmentInfo) + '.svg';\r\n  }\r\n\r\n  //è§£ææä»¶ç±»åï¼ç»åºç¼©ç¥å¾\r\n  createItem(attachmentInfo) {\r\n    var pos = attachmentInfo.fileName.lastIndexOf(\".\");\r\n    var type = attachmentInfo.fileName.substring(pos + 1);\r\n    type = (type == '' ? 'Default' : type.toLowerCase());\r\n    var docLib = 'doc-docx-htm-html-js-pdf-ppt-pptx-rar-zip-txt-xls-xlsx';\r\n    var videoLib = 'wav-aif-aiff-au-mp1-mp2-mp3-ra-rm-ram-mid-rmi';\r\n    var audioLib = 'avi-rm-rmvb-mpeg-mpg-dat-mov-qt-asf-wm-mp4';\r\n    var imgLib = 'webp-baibmp-dupcx-tif-gif-jpeg-tga-exif-fpx-svg-psd-cdr-pcd-dxf-ufo-eps-ai-png-hdri-raw-wmf-flic-emf-ico-jpg';\r\n    if (docLib.indexOf(type) >= 0) {\r\n      type = type.toLowerCase();\r\n    } else if (videoLib.indexOf(type) >= 0) {\r\n      type = 'video';\r\n    } else if (audioLib.indexOf(type) >= 0) {\r\n      type = 'audio';\r\n    } else if (imgLib.indexOf(type) >= 0) {\r\n      type = 'picture';\r\n    } else {\r\n      type = 'default';\r\n    }\r\n    return type;\r\n  }\r\n}\r\n","export const en = {\r\n    static: {\r\n        title: 'Approval comments',\r\n        add: 'Add',\r\n        delete: 'Delete',\r\n        save: 'Save',\r\n        cancel: 'Cancel',\r\n        content: 'Content',\r\n        order: 'Order',\r\n        inputLabel: 'Comments',\r\n        manage: 'Comments management',\r\n        attachmentUpload: 'attachment upload',\r\n        repeatFile: 'Contains repeat files:'\r\n    }\r\n};\r\n","export const zh_CHS = {\r\n    static: {\r\n        title: 'å¸¸ç¨æè§ç®¡ç',\r\n        add: 'æ°å¢',\r\n        delete: 'å é¤',\r\n        save: 'ä¿å­',\r\n        cancel: 'åæ¶',\r\n        content: 'åå®¹',\r\n        order: 'é¡ºåº',\r\n        inputLabel: 'å¸¸ç¨æè§',\r\n        manage: 'æè§ç»´æ¤',\r\n        attachmentUpload: 'ä¸ä¼ éä»¶',\r\n        repeatFile: 'åå«éå¤æä»¶ï¼'\r\n    }\r\n};\r\n","export const zh_CHT = {\r\n    static: {\r\n        title: 'å¸¸ç¨æè¦ç®¡ç',\r\n        add: 'æ°å¢',\r\n        delete: 'åªé¤',\r\n        save: 'ä¿å­',\r\n        cancel: 'åæ¶',\r\n        content: 'å§å®¹',\r\n        order: 'é åº',\r\n        inputLabel: 'å¸¸ç¨æè¦',\r\n        manage: 'æè¦ç¶­è­·',\r\n        attachmentUpload: 'ä¸å³éä»¶',\r\n        repeatFile: 'åå«éå¾©æä»¶ï¼'\r\n    }\r\n};\r\n","import { en } from './en';\r\nimport { zh_CHS } from './zh-chs';\r\nimport { zh_CHT } from './zh-cht';\r\n\r\nexport const translate = {\r\n    'zh-CHS': zh_CHS,\r\n    'en': en,\r\n    'zh-CHT': zh_CHT\r\n};\r\n","import { Pipe, PipeTransform, Injectable } from '@angular/core';\r\nimport { Observable, of } from 'rxjs';\r\nimport { translate } from './i18n/index';\r\n\r\n@Injectable()\r\nexport class I18nService {\r\n    defaultLang: string;\r\n    langData: any;\r\n    constructor() {\r\n        this.defaultLang = localStorage.getItem('languageCode');\r\n        if (!this.defaultLang) {\r\n            this.langData = translate['zh-CHS'];\r\n        } else {\r\n            this.langData = translate[this.defaultLang];\r\n        }\r\n    }\r\n\r\n    getValue(name: string): any {\r\n        if (!name) {\r\n            return '';\r\n        }\r\n        let resultVal = '';\r\n        if (name.indexOf('.') === -1) {\r\n            resultVal = this.langData[name];\r\n        } else {\r\n            resultVal = name.split('.').reduce((obj, key) => {\r\n                if (obj) {\r\n                    return obj[key];\r\n                } else {\r\n                    return null;\r\n                }\r\n            }, this.langData);\r\n        }\r\n        return resultVal;\r\n    }\r\n}\r\n","import { Pipe, PipeTransform } from '@angular/core';\r\nimport { I18nService } from './i18n.service';\r\n\r\n@Pipe({ name: 'translate' })\r\nexport class TranslatePipe implements PipeTransform {\r\n    constructor(public i18nService: I18nService) { }\r\n    transform(name: any, defaultVal = ''): any {\r\n        const r = this.i18nService.getValue(name);\r\n        return r ? r : defaultVal;\r\n    }\r\n}\r\n","import { Injectable } from '@angular/core';\r\n\r\n//ä¸è¦å ï¼å¦åä¼å¼èµ·å¶ä»ä½¿ç¨æäº¤å®¡æ¹è¡¨åæ¥é by fangpengfei@20201228\r\n@Injectable()\r\nexport class TaskCommentRepository {\r\n\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FormsModule } from '@angular/forms';\r\nimport { FarrisDialogModule } from '@farris/ui-dialog';\r\nimport { TaskCommentComponent } from './task-comment/task-comment.component';\r\nimport { TaskCommentService } from './services/task-comment.service';\r\nimport { ModalModule } from '@farris/ui-modal';\r\nimport { GridModule } from '@progress/kendo-angular-grid';\r\nimport { TaskCommentUIState } from './task-comment/task-comment.uistate';\r\nimport { TaskCommentViewModel } from './task-comment/task-comment.viewmodel';\r\nimport { HttpService } from '@ecp-caf/caf-common';\r\nimport { TranslatePipe } from './services/translate.pipe';\r\nimport { I18nService } from './services/i18n.service';\r\nimport { ComboListModule } from '@farris/ui-combo-list';\r\nimport { FDropdownDirectiveTypeModule } from '@farris/ui-dropdown';\r\nimport { UploadDialogMoudle } from '@gsp-svc/formdoc-upload';\r\nimport { TaskCommentRepository } from './model/task-comment.repository';\r\n\r\n\r\n@NgModule({\r\n  declarations: [\r\n    TaskCommentComponent,\r\n    TranslatePipe,\r\n  ],\r\n  imports: [\r\n    CommonModule,\r\n    FormsModule,\r\n    FarrisDialogModule,\r\n    ModalModule.forRoot(),\r\n    GridModule,\r\n    ComboListModule,\r\n    FDropdownDirectiveTypeModule,\r\n    UploadDialogMoudle,\r\n  ],\r\n  exports: [\r\n    TaskCommentComponent,\r\n  ],\r\n  providers: [\r\n    HttpService,\r\n    TaskCommentService,\r\n    TaskCommentUIState,\r\n    TaskCommentViewModel,\r\n    I18nService,\r\n    TaskCommentRepository\r\n  ],\r\n})\r\nexport class WFCommentModule { }\r\n"],"names":["Injectable","HttpService","forkJoin","EventEmitter","UploadDialogService","MessagerService","tslib_1.__values","Component","NG_VALUE_ACCESSOR","forwardRef","FormBuilder","Injector","Optional","Input","Output","ViewChild","DialogComponent","Pipe","NgModule","CommonModule","FormsModule","FarrisDialogModule","ModalModule","GridModule","ComboListModule","FDropdownDirectiveTypeModule","UploadDialogMoudle"],"mappings":"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"}
