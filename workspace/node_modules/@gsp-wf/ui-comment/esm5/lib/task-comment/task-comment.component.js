/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
import { Component, Input, ViewChild, forwardRef, Injector, Output, EventEmitter, Optional } from '@angular/core';
import { TaskCommentService } from '../services/task-comment.service';
import { TaskCommentViewModel } from './task-comment.viewmodel';
import { TaskCommentUIState } from './task-comment.uistate';
import { DialogComponent } from '@farris/ui-dialog';
import { NG_VALUE_ACCESSOR, FormBuilder } from '@angular/forms';
import { GridComponent } from '@progress/kendo-angular-grid';
import { FDropdownDirective } from '@farris/ui-dropdown';
import { UploadDialogService } from '@gsp-svc/formdoc-upload';
import { DatagridComponent } from "@farris/ui-datagrid";
import { MessagerService } from '@farris/ui-messager';
import { FileUploadEntity } from '../entities/attachment';
var TaskCommentComponent = /** @class */ (function () {
    // 构造方法不可动，顺序不要改变，使用新的
    function TaskCommentComponent(commentSvc, viewModel, uiState, formBuilder, injector) {
        this.commentSvc = commentSvc;
        this.viewModel = viewModel;
        this.uiState = uiState;
        this.formBuilder = formBuilder;
        this.injector = injector;
        this.placeholder = '';
        this.attachment = new EventEmitter();
        this._value = '';
        this.attachmentList = [];
        this.textAreaHeight = 120;
        this.isRepeat = false; // 重复附件校验
        // 重复附件校验
        this.ifShowAttachment = true; //任务中心配置，是否显示附件上传
        //任务中心配置，是否显示附件上传
        this.showUploadAttachment = true;
        this.onModelChange = function (obj) { };
        this.onModelTouched = function (obj) { };
        this.injector && (this.uploadDialog = this.injector.get(UploadDialogService));
        this.injector && (this.messageService = this.injector.get(MessagerService));
    }
    Object.defineProperty(TaskCommentComponent.prototype, "actionCode", {
        set: /**
         * @param {?} actionCode
         * @return {?}
         */
        function (actionCode) {
            if (actionCode === 'Claim' || actionCode === 'AssignUser') {
                this.showUploadAttachment = false;
            }
            else {
                this.showUploadAttachment = true;
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TaskCommentComponent.prototype, "value", {
        get: /**
         * @return {?}
         */
        function () {
            return this._value;
        },
        set: /**
         * @param {?} v
         * @return {?}
         */
        function (v) {
            if (this._value !== v) {
                this._value = v;
                this.onModelChange(v);
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TaskCommentComponent.prototype, "TextAreaHeight", {
        set: /**
         * @param {?} height
         * @return {?}
         */
        function (height) {
            this.textAreaHeight = height;
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    TaskCommentComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        // 获取常用意见列表
        this.loadComments();
        this.commentSvc.getTaskCenterConfigByCode('If_Show_Attachment').subscribe(function (re) {
            re && re.currentValue === 'false' && (_this.ifShowAttachment = false);
        });
    };
    /**
     * @return {?}
     */
    TaskCommentComponent.prototype.onEditComment = /**
     * @return {?}
     */
    function () {
        this.commentDialog.show();
    };
    /**
     * @return {?}
     */
    TaskCommentComponent.prototype.save = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this.commentGrid.closeCell();
        this.viewModel.save().subscribe(function (r) {
            _this.loadComments();
            _this.commentDialog.close();
        });
    };
    /**
     * @return {?}
     */
    TaskCommentComponent.prototype.loadComments = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this.commentSvc.getCommentList().subscribe(function (data) {
            _this.uiState.commentList = data;
            _this.uiState.originCommentIds = data.map(function (d) { return d.id; });
            _this.uiState.comments = data.map(function (d) { return d.message; });
        });
    };
    /**
     * @param {?} __0
     * @return {?}
     */
    TaskCommentComponent.prototype.cellClickHandler = /**
     * @param {?} __0
     * @return {?}
     */
    function (_a) {
        var sender = _a.sender, rowIndex = _a.rowIndex, columnIndex = _a.columnIndex, dataItem = _a.dataItem, isEdited = _a.isEdited;
        this.uiState.curComment = dataItem;
        if (!isEdited) {
            sender.editCell(rowIndex, columnIndex, this.createFormGroup(dataItem));
        }
    };
    /**
     * @param {?} args
     * @return {?}
     */
    TaskCommentComponent.prototype.cellCloseHandler = /**
     * @param {?} args
     * @return {?}
     */
    function (args) {
        var formGroup = args.formGroup, dataItem = args.dataItem, column = args.column;
        if (!formGroup.valid) {
            args.preventDefault();
        }
        else if (formGroup.dirty) {
            if (this.uiState.originCommentIds.findIndex(function (d) { return d === dataItem.id; }) > -1
                && this.uiState.changesCommentIds.findIndex(function (id) { return id === dataItem.id; }) < 0) {
                this.uiState.changesCommentIds.push(dataItem.id);
            }
            Object.assign(dataItem, formGroup.value);
        }
    };
    /**
     * @param {?} dataItem
     * @return {?}
     */
    TaskCommentComponent.prototype.createFormGroup = /**
     * @param {?} dataItem
     * @return {?}
     */
    function (dataItem) {
        return this.formBuilder.group({
            message: dataItem.message,
            sortOrder: dataItem.sortOrder,
        });
    };
    /**
     * @param {?} value
     * @return {?}
     */
    TaskCommentComponent.prototype.writeValue = /**
     * @param {?} value
     * @return {?}
     */
    function (value) {
        if (value !== this.value) {
            this.value = value;
        }
    };
    /**
     * @param {?} fn
     * @return {?}
     */
    TaskCommentComponent.prototype.registerOnChange = /**
     * @param {?} fn
     * @return {?}
     */
    function (fn) {
        this.onModelChange = fn;
    };
    /**
     * @param {?} fn
     * @return {?}
     */
    TaskCommentComponent.prototype.registerOnTouched = /**
     * @param {?} fn
     * @return {?}
     */
    function (fn) {
        this.onModelTouched = fn;
    };
    /**
     * @param {?} data
     * @return {?}
     */
    TaskCommentComponent.prototype.buttonClick = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        this.dropDownEl.close();
        this.value = data;
    };
    /**
     * @return {?}
     */
    TaskCommentComponent.prototype.uploadAttachment = /**
     * @return {?}
     */
    function () {
        var _this = this;
        if (this.uploadDialog) {
            this.uploadDialog.uploadFile(this.processInstanceId, 'wf_attachment').then(function (re) {
                var e_1, _a, e_2, _b;
                try {
                    for (var _c = tslib_1.__values(((/** @type {?} */ (re)))), _d = _c.next(); !_d.done; _d = _c.next()) {
                        var i = _d.value;
                        _this.isRepeat = false;
                        try {
                            for (var _e = tslib_1.__values(_this.attachmentList), _f = _e.next(); !_f.done; _f = _e.next()) {
                                var attach = _f.value;
                                if (attach.fileName === i.fileName) {
                                    _this.messageService.info('包含重复文件' + i.fileName);
                                    _this.isRepeat = true;
                                    break;
                                }
                            }
                        }
                        catch (e_2_1) { e_2 = { error: e_2_1 }; }
                        finally {
                            try {
                                if (_f && !_f.done && (_b = _e.return)) _b.call(_e);
                            }
                            finally { if (e_2) throw e_2.error; }
                        }
                        if (!_this.isRepeat) {
                            _this.attachmentList.push(i);
                        }
                    }
                }
                catch (e_1_1) { e_1 = { error: e_1_1 }; }
                finally {
                    try {
                        if (_d && !_d.done && (_a = _c.return)) _a.call(_c);
                    }
                    finally { if (e_1) throw e_1.error; }
                }
                _this.attachment.emit(_this.attachmentList);
                //执行上传附件
                /** @type {?} */
                var files = new FileUploadEntity();
                files.rootId = "wf_attachment";
                files.metadataIdList = [];
                _this.attachmentList.forEach(function (a) {
                    files.metadataIdList.push(a.metadataId);
                });
                files.metadataIdList.length && _this.commentSvc.uploadAttachment(files).subscribe(function () { });
            });
        }
        else {
            throw new Error("使用附件上传功能，请升级表单");
        }
    };
    /**
     * @param {?} attachment
     * @return {?}
     */
    TaskCommentComponent.prototype.attachmentDelete = /**
     * @param {?} attachment
     * @return {?}
     */
    function (attachment) {
        /** @type {?} */
        var gspDocDeleteEntity = {
            rootId: "wf_attachment",
            metadataId: attachment.metadataId,
            mode: "Formal"
        };
        /** @type {?} */
        var index = this.attachmentList.indexOf(attachment);
        if (index > -1) {
            this.attachmentList.splice(index, 1);
        }
        this.attachment.emit(this.attachmentList);
        this.commentSvc.deleteAttachment(gspDocDeleteEntity).subscribe(function () { });
    };
    /**
     * @param {?} attachmentInfo
     * @return {?}
     */
    TaskCommentComponent.prototype.imageUrl = /**
     * @param {?} attachmentInfo
     * @return {?}
     */
    function (attachmentInfo) {
        return '/platform/runtime/wf/webapp/mobiletaskcenter/assets/accessory/' + this.createItem(attachmentInfo) + '.svg';
    };
    //解析文件类型，给出缩略图
    //解析文件类型，给出缩略图
    /**
     * @param {?} attachmentInfo
     * @return {?}
     */
    TaskCommentComponent.prototype.createItem = 
    //解析文件类型，给出缩略图
    /**
     * @param {?} attachmentInfo
     * @return {?}
     */
    function (attachmentInfo) {
        /** @type {?} */
        var pos = attachmentInfo.fileName.lastIndexOf(".");
        /** @type {?} */
        var type = attachmentInfo.fileName.substring(pos + 1);
        type = (type == '' ? 'Default' : type.toLowerCase());
        /** @type {?} */
        var docLib = 'doc-docx-htm-html-js-pdf-ppt-pptx-rar-zip-txt-xls-xlsx';
        /** @type {?} */
        var videoLib = 'wav-aif-aiff-au-mp1-mp2-mp3-ra-rm-ram-mid-rmi';
        /** @type {?} */
        var audioLib = 'avi-rm-rmvb-mpeg-mpg-dat-mov-qt-asf-wm-mp4';
        /** @type {?} */
        var imgLib = 'webp-baibmp-dupcx-tif-gif-jpeg-tga-exif-fpx-svg-psd-cdr-pcd-dxf-ufo-eps-ai-png-hdri-raw-wmf-flic-emf-ico-jpg';
        if (docLib.indexOf(type) >= 0) {
            type = type.toLowerCase();
        }
        else if (videoLib.indexOf(type) >= 0) {
            type = 'video';
        }
        else if (audioLib.indexOf(type) >= 0) {
            type = 'audio';
        }
        else if (imgLib.indexOf(type) >= 0) {
            type = 'picture';
        }
        else {
            type = 'default';
        }
        return type;
    };
    TaskCommentComponent.decorators = [
        { type: Component, args: [{
                    selector: 'wf-comment',
                    template: "<div class=\"fa-approve-comment fa-approve-common-gutter\">\r\n  <div class=\"fa-approve-comment--header\">\r\n    <div class=\"approve-comment--title\">\r\n      <div class=\"fa-btn-like-dropdown\">\r\n        <div class=\"btn-group\" fDropdown #dropdownEl=\"fDropdown\">\r\n          <button class=\"btn btn-secondary dropdown-toggle fa-dropdown-button\" fDropdownToggle type=\"button\">\r\n            {{ \"static.inputLabel\" | translate }}\r\n          </button>\r\n          <div *ngIf=\"uiState.commentList.length\" class=\"dropdown-menu\" fDropdownMenu>\r\n            <li class=\"dropdown-item\" *ngFor=\"let comment of uiState.commentList\" (click)=\"buttonClick(comment.message)\">\r\n              <span>{{ comment.message }}</span>\r\n            </li>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n  <div class=\"fa-approve-comment--content\">\r\n    <textarea\r\n      class=\"form-control content-textarea\"\r\n      [(ngModel)]=\"value\"\r\n      [attr.placeholder]=\"placeholder\"\r\n      [style.height.px]=\"textAreaHeight\"\r\n    ></textarea>\r\n  </div>\r\n  <div class=\"fa-approve-comment--footer\">\r\n    <div class=\"approve-comment--text-btns\">\r\n      <div class=\"text-btns-item\">\r\n        <span class=\"f-icon f-icon-gear\"></span>\r\n        <span class=\"text-btns-item--text\" (click)=\"onEditComment()\">\r\n          {{\"static.manage\" | translate}}\r\n        </span>\r\n      </div>\r\n      <div class=\"text-btns-item\" *ngIf=\"ifShowAttachment && showUploadAttachment\">\r\n        <span  class=\"f-icon f-icon-attachment\"></span>\r\n        <span  class=\"text-btns-item--text\" (click)=\"uploadAttachment()\">\r\n          {{\"static.attachmentUpload\" | translate}}\r\n        </span>\r\n      </div>\r\n    </div>\r\n    <div *ngIf=\"attachmentList.length > 0\">\r\n      <li *ngFor=\"let attachment of attachmentList\">\r\n        <div class=\"wf-docFile\">\r\n          <div><img class=\"wf-docFileIcon\" [src]=\"imageUrl(attachment)\"></div>\r\n          <div class=\"wf-docFileInfo\" >\r\n            <div class=\"attachment-list\">\r\n              <a>{{attachment.fileName}}</a>\r\n            </div>\r\n            <div class=\"attachment-delete\" (click)=\"attachmentDelete(attachment)\">\r\n              <span class=\"f-icon f-icon-close-outline\"></span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </li>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n<farris-dialog #commentDialog [buttons]=\"formButtonRef\" [width]=\"550\" [height]=\"360\" [title]=\"'static.title' | translate\">\r\n    <kendo-grid #commentGrid [data]=\"uiState.commentList\" [selectable]=\"true\" (cellClick)=\"cellClickHandler($event)\"\r\n        (cellClose)=\"cellCloseHandler($event)\" style=\"padding: 10px;\">\r\n        <kendo-grid-column field=\"message\" title=\"{{'static.content' | translate}}\" width=\"80%\"></kendo-grid-column>\r\n        <kendo-grid-column field=\"sortOrder\" title=\"{{'static.order' | translate}}\" width=\"20%\"></kendo-grid-column>\r\n    </kendo-grid>\r\n</farris-dialog>\r\n<ng-template #formButtonRef>\r\n    <button class=\"btn btn-primary mr-2\" (click)=\"viewModel.add()\">{{'static.add' | translate}}</button>\r\n    <button class=\"btn btn-secondary mr-2\" (click)=\"viewModel.delete()\">{{'static.delete' | translate}}</button>\r\n    <button class=\"btn btn-secondary mr-2\" (click)=\"save()\">{{'static.save' | translate}}</button>\r\n    <button class=\"btn btn-secondary\" (click)=\"commentDialog.close()\">{{'static.cancel' | translate}}</button>\r\n</ng-template>\r\n",
                    providers: [{
                            provide: NG_VALUE_ACCESSOR,
                            useExisting: forwardRef(function () { return TaskCommentComponent; }),
                            multi: true
                        },],
                    styles: [".fa-approval-operate-list{display:flex;flex-direction:row;align-items:center}.fa-approval-operate-list .approval-operate--label{position:relative;margin-right:8px;padding:3px 16px;border:1px solid rgba(0,0,0,.15);border-radius:2px;overflow:hidden;cursor:pointer;margin-bottom:0;color:#595959}.fa-approval-operate-list .approval-operate--label .label-title{font-size:14px;line-height:20px;white-space:nowrap}.fa-approval-operate-list .approval-operate--label .label-tip{position:absolute;display:block;right:0;bottom:0;width:14px;height:14px;border:7px solid #dadada;border-top:7px solid transparent;border-left:7px solid transparent}.fa-approval-operate-list .approval-operate--label .label-icon{position:absolute;display:block;right:-3px;bottom:-2px;font-size:12px;color:#fff}.fa-approval-operate-list .approval-operate--label .label-icon::before{content:'\\e118'}.fa-approval-operate-list .approval-operate--radio{display:none}.fa-approval-operate-list .approval-operate--radio:checked~.approval-operate--label{color:#388fff;border-color:#388fff;background:rgba(23,145,255,.05)}.fa-approval-operate-list .approval-operate--radio:checked~.approval-operate--label .label-tip{border-right-color:#388fff;border-bottom-color:#388fff}.fa-dropdown-button{border-color:#f7f7f7;font-size:12px;color:#667580;background:#f7f7f7}.fa-btn-like-dropdown{display:flex;align-items:center}.fa-btn-like-dropdown .like-dropdown--text{margin:0 4px 0 0}.fa-btn-like-dropdown .like-dropdown--icon{color:rgba(0,0,0,.25)}.fa-approve-common-gutter{margin:0 0 12px}.fa-approve-comment .approve-comment--title{display:inline-block;color:#667580;border-radius:4px 4px 0 0;height:26px;padding:0 9px;position:relative;background:#f7f7f7;cursor:pointer}.fa-approve-comment .approve-comment--title:after{content:'';height:100%;position:absolute;right:-10px;top:0;bottom:0;border-right:5px solid transparent;border-left:5px solid #f7f7f7;border-bottom:13px solid #f7f7f7;border-top:13px solid transparent}.fa-approve-comment .approve-comment--title .fa-btn-like-dropdown{font-size:12px;padding:2px 0}.fa-approve-comment .fa-approve-comment--content .content-textarea{border-color:#dcdcdc;border-radius:0 0 2px 2px}.fa-approve-comment .fa-approve-comment--footer{font-size:13px;color:#667580;background:#f7f7f7;padding:5px 0}.fa-approve-comment .approve-comment--text-btns{display:flex;flex-direction:row}.fa-approve-comment .approve-comment--text-btns .text-btns-item{display:flex;flex-direction:row;align-items:center;font-size:12px;line-height:18px;color:#667580;padding:4px;margin-right:8px;cursor:pointer}.fa-approve-comment .approve-comment--text-btns .text-btns-item:hover{color:#388fff}.fa-approve-comment .approve-comment--text-btns .text-btns-item .f-icon{margin-right:6px}.fa-approveal-links::after{content:\".\";display:block;height:0;clear:both;visibility:hidden}.fa-approveal-links .approveal-links--link{font-size:14px;position:relative;padding:0 16px 0 0;display:flex;align-items:center;float:left}.fa-approveal-links .approveal-links--link .link-text{color:rgba(0,0,0,.65);margin:0 8px 0 0}.fa-approveal-links .approveal-links--link+.approveal-links--link{padding-left:16px}.fa-approveal-links .approveal-links--link+.approveal-links--link::before{content:'';position:absolute;width:1px;height:80%;left:0;top:10%;background:#dbdbdb}.fa-btn-group-lg .btn{padding-top:6px;padding-bottom:6px;min-width:100px;text-align:center}.fa-approve-record{padding:0 0 16px;position:relative}.fa-approve-record .fa-approve-record--timeline{position:absolute;width:34px;top:0;bottom:0;z-index:100}.fa-approve-record .fa-approve-record--timeline::after{content:'';position:absolute;width:1px;height:100%;overflow:hidden;left:50%;top:0;z-index:101;border-left:1px dashed #dcdcdc}.fa-approve-record .fa-approve-record--timeline .fa-approve-star{position:relative;z-index:103;margin:20px auto}.fa-approve-record.fa-state-running .fa-approve-record--timeline::after{top:20px}.fa-approve-record:last-child .fa-approve-record--timeline::after{height:20px}.fa-approve-record .fa-approve-record--content{margin:0 0 0 34px;padding:16px 14px;background:#f9f9f9;border-radius:2px}.fa-approve-record .fa-approve-record--content .approve-record--header{margin:0 0 12px;display:flex;align-items:center}.fa-approve-record .fa-approve-record--content .approve-record--header .header--title{margin-bottom:0;color:rgba(0,0,0,.85)}.fa-approve-record .fa-approve-record--content .approve-record--header>*{margin:0 19px 0 0}.fa-approve-record .approve-record--list-item{display:flex;flex-direction:row}.fa-approve-record .approve-record--list-item+.approve-record--list-item{padding-top:8px}.fa-approve-record .approve-record--list-item .list-item--auxiliary{width:30px;margin:0 10px 0 0}.fa-approve-record .approve-record--list-item .list-item--main{flex-grow:1;flex-shrink:1;flex-basis:auto;padding:6px 0 0;background:#f9f9f9}.fa-approve-record .approve-record--list-item .list-item--content{padding:20px 0 0}.fa-approve-record .approve-record--list-item .list-item--content .list-item--info{font-size:12px;margin-bottom:0}.fa-approve-record .approve-record--list-item .list-item--content .list-item--info .info-label{color:rgba(0,0,0,.65)}.fa-approve-record .approve-record--list-item .list-item--content .list-item--info .info-text{color:rgba(0,0,0,.85)}.fa-approve-record .approve-record--list-item .list-item--header{display:flex;align-items:center}.fa-approve-record .approve-record--list-item .list-item--header>*{margin:0 16px 0 0}.fa-approve-record .approve-record--list-item .list-item--header .list-item--info{margin-bottom:0;font-size:12px}.fa-approve-record .approve-record--list-item .list-item--header .list-item--info .info-label{color:rgba(0,0,0,.35)}.fa-approve-record .approve-record--list-item .list-item--header .list-item--info .info-text{color:rgba(0,0,0,.65)}.fa-approve-record .approve-record--list-item .list-item--name{color:#4297fa}.fa-approve-record .approve-record--avatar{width:30px;height:30px;border-radius:15px}.fa-approve-round-bg{margin:4px auto 0;width:30px;height:30px;background:#59a1ff;border-radius:18px;line-height:30px;text-align:center;white-space:nowrap;font-size:12px;overflow:hidden}.fa-approve-round-bg-text{color:#fff}.fa-approve-star{width:14px;height:14px;display:block;background:rgba(56,143,255,.4);border-radius:7px;position:relative}.fa-approve-star::after{content:'';width:8px;height:8px;position:absolute;top:50%;left:50%;margin:-4px 0 0 -4px;border-radius:4px;background:#388fff}.fa-approve-star.bg-warning{background:rgba(245,156,36,.4)!important}.fa-approve-star.bg-warning::after{background:#f59c24}.fa-approve-badge{padding-top:4px;padding-bottom:4px;border-radius:10px}.fa-approve-badge-light{font-size:13px;line-height:20px;padding:0 8px;color:#5f637a;border:1px solid #e6e6e6;background:#f6faff}.fa-approve-link-border{cursor:pointer;display:inline-block;border:1px solid #60a5ff;border-radius:13px;font-size:12px;line-height:16px;color:#388fff;padding:3px 10px;background:#ebf5ff}.fa-approve-link-border:hover{background:#2881ff;color:#fff}.fm-toolbar{flex-direction:row;display:flex}.wf-docFile{flex-shrink:1;flex-grow:1;flex-basis:0;display:flex;flex-direction:row;align-items:flex-start;border-top:1px solid #f8f9fa;border-left:1px solid #f8f9fa}.wf-docFileIcon{margin:0 0 0 10px;width:20px;height:20px;line-height:20px;text-align:center;overflow:hidden;white-space:nowrap;padding:2px}.wf-docFileInfo{flex-shrink:1;flex-grow:1;flex-basis:0;padding:2px 6px 0 9px;margin-left:0}.wf-docFileInfo:hover .attachment-delete{display:block}.wf-docFileSize{font-size:11px;color:#888}.wf-doc-delete{margin:auto;font-size:18px;color:#f8f9fa}li{list-style:none}.attachment-delete{float:right;cursor:pointer;display:none;text-align:right;padding-right:10px}.attachment-delete:hover{color:#4297fa}.attachment-list{float:left;font-size:12px;margin-left:8px;width:180px}"]
                }] }
    ];
    /** @nocollapse */
    TaskCommentComponent.ctorParameters = function () { return [
        { type: TaskCommentService },
        { type: TaskCommentViewModel },
        { type: TaskCommentUIState },
        { type: FormBuilder },
        { type: Injector, decorators: [{ type: Optional }] }
    ]; };
    TaskCommentComponent.propDecorators = {
        comment: [{ type: Input }],
        placeholder: [{ type: Input }],
        processInstanceId: [{ type: Input }],
        actionCode: [{ type: Input }],
        attachment: [{ type: Output }],
        commentDialog: [{ type: ViewChild, args: [DialogComponent,] }],
        commentGrid: [{ type: ViewChild, args: ['commentGrid',] }],
        dropDownEl: [{ type: ViewChild, args: ['dropdownEl',] }],
        grid: [{ type: ViewChild, args: ['grid',] }],
        TextAreaHeight: [{ type: Input }]
    };
    return TaskCommentComponent;
}());
export { TaskCommentComponent };
if (false) {
    /** @type {?} */
    TaskCommentComponent.prototype.comment;
    /** @type {?} */
    TaskCommentComponent.prototype.placeholder;
    /** @type {?} */
    TaskCommentComponent.prototype.processInstanceId;
    /** @type {?} */
    TaskCommentComponent.prototype.attachment;
    /** @type {?} */
    TaskCommentComponent.prototype.commentDialog;
    /** @type {?} */
    TaskCommentComponent.prototype.commentGrid;
    /** @type {?} */
    TaskCommentComponent.prototype.dropDownEl;
    /** @type {?} */
    TaskCommentComponent.prototype.grid;
    /**
     * @type {?}
     * @private
     */
    TaskCommentComponent.prototype._value;
    /** @type {?} */
    TaskCommentComponent.prototype.attachmentList;
    /** @type {?} */
    TaskCommentComponent.prototype.selectValue;
    /** @type {?} */
    TaskCommentComponent.prototype.textAreaHeight;
    /** @type {?} */
    TaskCommentComponent.prototype.messageService;
    /** @type {?} */
    TaskCommentComponent.prototype.isRepeat;
    /** @type {?} */
    TaskCommentComponent.prototype.ifShowAttachment;
    /** @type {?} */
    TaskCommentComponent.prototype.showUploadAttachment;
    /** @type {?} */
    TaskCommentComponent.prototype.onModelChange;
    /** @type {?} */
    TaskCommentComponent.prototype.onModelTouched;
    /** @type {?} */
    TaskCommentComponent.prototype.uploadDialog;
    /** @type {?} */
    TaskCommentComponent.prototype.resolver;
    /**
     * @type {?}
     * @private
     */
    TaskCommentComponent.prototype.commentSvc;
    /** @type {?} */
    TaskCommentComponent.prototype.viewModel;
    /** @type {?} */
    TaskCommentComponent.prototype.uiState;
    /**
     * @type {?}
     * @private
     */
    TaskCommentComponent.prototype.formBuilder;
    /**
     * @type {?}
     * @private
     */
    TaskCommentComponent.prototype.injector;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidGFzay1jb21tZW50LmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0Bnc3Atd2YvdWktY29tbWVudC8iLCJzb3VyY2VzIjpbImxpYi90YXNrLWNvbW1lbnQvdGFzay1jb21tZW50LmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7OztBQUFBLE9BQU8sRUFDTCxTQUFTLEVBRVQsS0FBSyxFQUNMLFNBQVMsRUFDVCxVQUFVLEVBQ1YsUUFBUSxFQUVSLE1BQU0sRUFBRSxZQUFZLEVBQUUsUUFBUSxFQUMvQixNQUFNLGVBQWUsQ0FBQztBQUN2QixPQUFPLEVBQUUsa0JBQWtCLEVBQUUsTUFBTSxrQ0FBa0MsQ0FBQztBQUN0RSxPQUFPLEVBQUUsb0JBQW9CLEVBQUUsTUFBTSwwQkFBMEIsQ0FBQztBQUNoRSxPQUFPLEVBQUUsa0JBQWtCLEVBQUUsTUFBTSx3QkFBd0IsQ0FBQztBQUM1RCxPQUFPLEVBQUUsZUFBZSxFQUFFLE1BQU0sbUJBQW1CLENBQUM7QUFDcEQsT0FBTyxFQUF3QixpQkFBaUIsRUFBYSxXQUFXLEVBQUUsTUFBTSxnQkFBZ0IsQ0FBQztBQUVqRyxPQUFPLEVBQUUsYUFBYSxFQUFFLE1BQU0sOEJBQThCLENBQUM7QUFDN0QsT0FBTyxFQUFFLGtCQUFrQixFQUFFLE1BQU0scUJBQXFCLENBQUM7QUFDekQsT0FBTyxFQUFFLG1CQUFtQixFQUFFLE1BQU0seUJBQXlCLENBQUM7QUFDOUQsT0FBTyxFQUFFLGlCQUFpQixFQUFFLE1BQU0scUJBQXFCLENBQUM7QUFDeEQsT0FBTyxFQUFFLGVBQWUsRUFBRSxNQUFNLHFCQUFxQixDQUFDO0FBQ3RELE9BQU8sRUFBb0IsZ0JBQWdCLEVBQUUsTUFBTSx3QkFBd0IsQ0FBQztBQUU1RTtJQWdFRSxzQkFBc0I7SUFDdEIsOEJBQ1UsVUFBOEIsRUFDL0IsU0FBK0IsRUFDL0IsT0FBMkIsRUFDMUIsV0FBd0IsRUFDWixRQUFrQjtRQUo5QixlQUFVLEdBQVYsVUFBVSxDQUFvQjtRQUMv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LEVBQUU7O2lCQUNKOzs7O2dCQXRCUSxrQkFBa0I7Z0JBQ2xCLG9CQUFvQjtnQkFDcEIsa0JBQWtCO2dCQUVrQyxXQUFXO2dCQVJ0RSxRQUFRLHVCQXVGTCxRQUFROzs7MEJBckRWLEtBQUs7OEJBQ0wsS0FBSztvQ0FDTCxLQUFLOzZCQUNMLEtBQUs7NkJBUUwsTUFBTTtnQ0FDTixTQUFTLFNBQUMsZUFBZTs4QkFDekIsU0FBUyxTQUFDLGFBQWE7NkJBQ3ZCLFNBQVMsU0FBQyxZQUFZO3VCQUN0QixTQUFTLFNBQUMsTUFBTTtpQ0FzQmhCLEtBQUs7O0lBdUtSLDJCQUFDO0NBQUEsQUE3TkQsSUE2TkM7U0EvTVksb0JBQW9COzs7SUFHL0IsdUNBQXlCOztJQUN6QiwyQ0FBMEI7O0lBQzFCLGlEQUFtQzs7SUFTbkMsMENBQStDOztJQUMvQyw2Q0FBMkQ7O0lBQzNELDJDQUFxRDs7SUFDckQsMENBQXdEOztJQUN4RCxvQ0FBMkM7Ozs7O0lBRTNDLHNDQUFvQjs7SUFDcEIsOENBQTJCOztJQUMzQiwyQ0FBb0I7O0lBQ3BCLDhDQUE2Qjs7SUFDN0IsOENBQWdDOztJQUNoQyx3Q0FBaUI7O0lBQ2pCLGdEQUFpQzs7SUFDakMsb0RBQTRCOztJQWtCNUIsNkNBQWtDOztJQUNsQyw4Q0FBbUM7O0lBRW5DLDRDQUFrQzs7SUFDbEMsd0NBQW1DOzs7OztJQUdqQywwQ0FBc0M7O0lBQ3RDLHlDQUFzQzs7SUFDdEMsdUNBQWtDOzs7OztJQUNsQywyQ0FBZ0M7Ozs7O0lBQ2hDLHdDQUFzQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XHJcbiAgQ29tcG9uZW50LFxyXG4gIE9uSW5pdCxcclxuICBJbnB1dCxcclxuICBWaWV3Q2hpbGQsXHJcbiAgZm9yd2FyZFJlZixcclxuICBJbmplY3RvcixcclxuICBDb21wb25lbnRGYWN0b3J5UmVzb2x2ZXIsXHJcbiAgT3V0cHV0LCBFdmVudEVtaXR0ZXIsIE9wdGlvbmFsXHJcbn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IFRhc2tDb21tZW50U2VydmljZSB9IGZyb20gJy4uL3NlcnZpY2VzL3Rhc2stY29tbWVudC5zZXJ2aWNlJztcclxuaW1wb3J0IHsgVGFza0NvbW1lbnRWaWV3TW9kZWwgfSBmcm9tICcuL3Rhc2stY29tbWVudC52aWV3bW9kZWwnO1xyXG5pbXBvcnQgeyBUYXNrQ29tbWVudFVJU3RhdGUgfSBmcm9tICcuL3Rhc2stY29tbWVudC51aXN0YXRlJztcclxuaW1wb3J0IHsgRGlhbG9nQ29tcG9uZW50IH0gZnJvbSAnQGZhcnJpcy91aS1kaWFsb2cnO1xyXG5pbXBvcnQgeyBDb250cm9sVmFsdWVBY2Nlc3NvciwgTkdfVkFMVUVfQUNDRVNTT1IsIEZvcm1Hcm91cCwgRm9ybUJ1aWxkZXIgfSBmcm9tICdAYW5ndWxhci9mb3Jtcyc7XHJcbmltcG9ydCB7IENvbW1vbkNvbW1lbnQgfSBmcm9tICcuLi9lbnRpdGllcy9jb21tZW50JztcclxuaW1wb3J0IHsgR3JpZENvbXBvbmVudCB9IGZyb20gJ0Bwcm9ncmVzcy9rZW5kby1hbmd1bGFyLWdyaWQnO1xyXG5pbXBvcnQgeyBGRHJvcGRvd25EaXJlY3RpdmUgfSBmcm9tICdAZmFycmlzL3VpLWRyb3Bkb3duJztcclxuaW1wb3J0IHsgVXBsb2FkRGlhbG9nU2VydmljZSB9IGZyb20gJ0Bnc3Atc3ZjL2Zvcm1kb2MtdXBsb2FkJztcclxuaW1wb3J0IHsgRGF0YWdyaWRDb21wb25lbnQgfSBmcm9tIFwiQGZhcnJpcy91aS1kYXRhZ3JpZFwiO1xyXG5pbXBvcnQgeyBNZXNzYWdlclNlcnZpY2UgfSBmcm9tICdAZmFycmlzL3VpLW1lc3NhZ2VyJztcclxuaW1wb3J0IHsgRmlsZURlbGV0ZUVudGl0eSwgRmlsZVVwbG9hZEVudGl0eSB9IGZyb20gJy4uL2VudGl0aWVzL2F0dGFjaG1lbnQnO1xyXG5cclxuQENvbXBvbmVudCh7XHJcbiAgc2VsZWN0b3I6ICd3Zi1jb21tZW50JyxcclxuICB0ZW1wbGF0ZVVybDogJy4vdGFzay1jb21tZW50LmNvbXBvbmVudC5odG1sJyxcclxuICBzdHlsZVVybHM6IFsnLi90YXNrLWNvbW1lbnQuY29tcG9uZW50LnNjc3MnXSxcclxuICBwcm92aWRlcnM6IFt7XHJcbiAgICBwcm92aWRlOiBOR19WQUxVRV9BQ0NFU1NPUixcclxuICAgIHVzZUV4aXN0aW5nOiBmb3J3YXJkUmVmKCgpID0+IFRhc2tDb21tZW50Q29tcG9uZW50KSxcclxuICAgIG11bHRpOiB0cnVlXHJcbiAgfSxdXHJcbn0pXHJcblxyXG4vKipcclxuICog5q2k5bel56iL5bey5bqf5byD5LiN5YaN5L2/55So77yM5pu05paw5Li6d2YtdGFzay1oYW5kbGVy55qEdGFzay1jb21tZW5057uE5Lu2IGJ5IGZhbmdwZW5nZmVpQDIwMjEuMS4xM1xyXG4gKi9cclxuZXhwb3J0IGNsYXNzIFRhc2tDb21tZW50Q29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0LCBDb250cm9sVmFsdWVBY2Nlc3NvciB7XHJcblxyXG4gIC8vIOm7mOiupOWKnueQhuaEj+ingVxyXG4gIEBJbnB1dCgpIGNvbW1lbnQ6IHN0cmluZztcclxuICBASW5wdXQoKSBwbGFjZWhvbGRlciA9ICcnO1xyXG4gIEBJbnB1dCgpIHByb2Nlc3NJbnN0YW5jZUlkOiBzdHJpbmc7XHJcbiAgQElucHV0KCkgc2V0IGFjdGlvbkNvZGUoYWN0aW9uQ29kZTogc3RyaW5nKSB7XHJcbiAgICBpZiAoYWN0aW9uQ29kZSA9PT0gJ0NsYWltJyB8fCBhY3Rpb25Db2RlID09PSAnQXNzaWduVXNlcicpIHtcclxuICAgICAgdGhpcy5zaG93VXBsb2FkQXR0YWNobWVudCA9IGZhbHNlO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5zaG93VXBsb2FkQXR0YWNobWVudCA9IHRydWU7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBAT3V0cHV0KCkgYXR0YWNobWVudDogYW55ID0gbmV3IEV2ZW50RW1pdHRlcigpO1xyXG4gIEBWaWV3Q2hpbGQoRGlhbG9nQ29tcG9uZW50KSBjb21tZW50RGlhbG9nOiBEaWFsb2dDb21wb25lbnQ7XHJcbiAgQFZpZXdDaGlsZCgnY29tbWVudEdyaWQnKSBjb21tZW50R3JpZDogR3JpZENvbXBvbmVudDtcclxuICBAVmlld0NoaWxkKCdkcm9wZG93bkVsJykgZHJvcERvd25FbDogRkRyb3Bkb3duRGlyZWN0aXZlOy8v6Kej5Yaz6YCJ5oup5oSP6KeB5ZCO77yM5LiL5ouJ6I+c5Y2V5peg5rOV5pS25oqY55qE6Zeu6aKYXHJcbiAgQFZpZXdDaGlsZCgnZ3JpZCcpIGdyaWQ6IERhdGFncmlkQ29tcG9uZW50O1xyXG4gIFxyXG4gIHByaXZhdGUgX3ZhbHVlID0gJyc7XHJcbiAgYXR0YWNobWVudExpc3Q6IGFueVtdID0gW107XHJcbiAgc2VsZWN0VmFsdWU6IHN0cmluZztcclxuICB0ZXh0QXJlYUhlaWdodDogbnVtYmVyID0gMTIwO1xyXG4gIG1lc3NhZ2VTZXJ2aWNlOiBNZXNzYWdlclNlcnZpY2U7XHJcbiAgaXNSZXBlYXQgPSBmYWxzZTsgLy8g6YeN5aSN6ZmE5Lu25qCh6aqMXHJcbiAgaWZTaG93QXR0YWNobWVudDogYm9vbGVhbiA9IHRydWU7Ly/ku7vliqHkuK3lv4PphY3nva7vvIzmmK/lkKbmmL7npLrpmYTku7bkuIrkvKBcclxuICBzaG93VXBsb2FkQXR0YWNobWVudCA9IHRydWU7XHJcblxyXG4gIHNldCB2YWx1ZSh2KSB7XHJcbiAgICBpZiAodGhpcy5fdmFsdWUgIT09IHYpIHtcclxuICAgICAgdGhpcy5fdmFsdWUgPSB2O1xyXG4gICAgICB0aGlzLm9uTW9kZWxDaGFuZ2Uodik7XHJcbiAgICB9XHJcblxyXG4gIH1cclxuICBnZXQgdmFsdWUoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5fdmFsdWU7XHJcbiAgfVxyXG5cclxuICBASW5wdXQoKVxyXG4gIHNldCBUZXh0QXJlYUhlaWdodChoZWlnaHQ6IG51bWJlcikge1xyXG4gICAgdGhpcy50ZXh0QXJlYUhlaWdodCA9IGhlaWdodDtcclxuICB9XHJcblxyXG4gIG9uTW9kZWxDaGFuZ2UgPSAob2JqOiBhbnkpID0+IHsgfTtcclxuICBvbk1vZGVsVG91Y2hlZCA9IChvYmo6IGFueSkgPT4geyB9O1xyXG5cclxuICB1cGxvYWREaWFsb2c6IFVwbG9hZERpYWxvZ1NlcnZpY2U7XHJcbiAgcmVzb2x2ZXI6IENvbXBvbmVudEZhY3RvcnlSZXNvbHZlcjtcclxuICAvLyDmnoTpgKDmlrnms5XkuI3lj6/liqjvvIzpobrluo/kuI3opoHmlLnlj5jvvIzkvb/nlKjmlrDnmoRcclxuICBjb25zdHJ1Y3RvcihcclxuICAgIHByaXZhdGUgY29tbWVudFN2YzogVGFza0NvbW1lbnRTZXJ2aWNlLFxyXG4gICAgcHVibGljIHZpZXdNb2RlbDogVGFza0NvbW1lbnRWaWV3TW9kZWwsXHJcbiAgICBwdWJsaWMgdWlTdGF0ZTogVGFza0NvbW1lbnRVSVN0YXRlLFxyXG4gICAgcHJpdmF0ZSBmb3JtQnVpbGRlcjogRm9ybUJ1aWxkZXIsXHJcbiAgICBAT3B0aW9uYWwoKSBwcml2YXRlIGluamVjdG9yOiBJbmplY3RvcixcclxuICApIHtcclxuICAgIHRoaXMuaW5qZWN0b3IgJiYgKHRoaXMudXBsb2FkRGlhbG9nID0gdGhpcy5pbmplY3Rvci5nZXQoVXBsb2FkRGlhbG9nU2VydmljZSkpO1xyXG4gICAgdGhpcy5pbmplY3RvciAmJiAodGhpcy5tZXNzYWdlU2VydmljZSA9IHRoaXMuaW5qZWN0b3IuZ2V0KE1lc3NhZ2VyU2VydmljZSkpO1xyXG4gIH1cclxuXHJcbiAgbmdPbkluaXQoKSB7XHJcbiAgICAvLyDojrflj5bluLjnlKjmhI/op4HliJfooahcclxuICAgIHRoaXMubG9hZENvbW1lbnRzKCk7XHJcbiAgICB0aGlzLmNvbW1lbnRTdmMuZ2V0VGFza0NlbnRlckNvbmZpZ0J5Q29kZSgnSWZfU2hvd19BdHRhY2htZW50Jykuc3Vic2NyaWJlKHJlID0+IHtcclxuICAgICAgcmUgJiYgcmUuY3VycmVudFZhbHVlID09PSAnZmFsc2UnICYmICh0aGlzLmlmU2hvd0F0dGFjaG1lbnQgPSBmYWxzZSk7XHJcbiAgICB9KVxyXG4gIH1cclxuXHJcbiAgb25FZGl0Q29tbWVudCgpIHtcclxuICAgIHRoaXMuY29tbWVudERpYWxvZy5zaG93KCk7XHJcbiAgfVxyXG5cclxuICBzYXZlKCkge1xyXG4gICAgdGhpcy5jb21tZW50R3JpZC5jbG9zZUNlbGwoKTtcclxuICAgIHRoaXMudmlld01vZGVsLnNhdmUoKS5zdWJzY3JpYmUociA9PiB7XHJcbiAgICAgIHRoaXMubG9hZENvbW1lbnRzKCk7XHJcbiAgICAgIHRoaXMuY29tbWVudERpYWxvZy5jbG9zZSgpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBsb2FkQ29tbWVudHMoKSB7XHJcbiAgICB0aGlzLmNvbW1lbnRTdmMuZ2V0Q29tbWVudExpc3QoKS5zdWJzY3JpYmUoKGRhdGE6IGFueVtdKSA9PiB7XHJcbiAgICAgIHRoaXMudWlTdGF0ZS5jb21tZW50TGlzdCA9IGRhdGE7XHJcbiAgICAgIHRoaXMudWlTdGF0ZS5vcmlnaW5Db21tZW50SWRzID0gZGF0YS5tYXAoZCA9PiBkLmlkKTtcclxuICAgICAgdGhpcy51aVN0YXRlLmNvbW1lbnRzID0gZGF0YS5tYXAoZCA9PiBkLm1lc3NhZ2UpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgY2VsbENsaWNrSGFuZGxlcih7IHNlbmRlciwgcm93SW5kZXgsIGNvbHVtbkluZGV4LCBkYXRhSXRlbSwgaXNFZGl0ZWQgfSkge1xyXG4gICAgdGhpcy51aVN0YXRlLmN1ckNvbW1lbnQgPSBkYXRhSXRlbTtcclxuICAgIGlmICghaXNFZGl0ZWQpIHtcclxuICAgICAgc2VuZGVyLmVkaXRDZWxsKHJvd0luZGV4LCBjb2x1bW5JbmRleCwgdGhpcy5jcmVhdGVGb3JtR3JvdXAoZGF0YUl0ZW0pKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHB1YmxpYyBjZWxsQ2xvc2VIYW5kbGVyKGFyZ3M6IGFueSkge1xyXG4gICAgY29uc3QgeyBmb3JtR3JvdXAsIGRhdGFJdGVtLCBjb2x1bW4gfSA9IGFyZ3M7XHJcbiAgICBpZiAoIWZvcm1Hcm91cC52YWxpZCkge1xyXG4gICAgICBhcmdzLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICB9IGVsc2UgaWYgKGZvcm1Hcm91cC5kaXJ0eSkge1xyXG4gICAgICBpZiAodGhpcy51aVN0YXRlLm9yaWdpbkNvbW1lbnRJZHMuZmluZEluZGV4KGQgPT4gZCA9PT0gZGF0YUl0ZW0uaWQpID4gLTFcclxuICAgICAgICAmJiB0aGlzLnVpU3RhdGUuY2hhbmdlc0NvbW1lbnRJZHMuZmluZEluZGV4KGlkID0+IGlkID09PSBkYXRhSXRlbS5pZCkgPCAwKSB7XHJcbiAgICAgICAgdGhpcy51aVN0YXRlLmNoYW5nZXNDb21tZW50SWRzLnB1c2goZGF0YUl0ZW0uaWQpO1xyXG4gICAgICB9XHJcbiAgICAgIE9iamVjdC5hc3NpZ24oZGF0YUl0ZW0sIGZvcm1Hcm91cC52YWx1ZSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgY3JlYXRlRm9ybUdyb3VwKGRhdGFJdGVtOiBDb21tb25Db21tZW50KTogRm9ybUdyb3VwIHtcclxuICAgIHJldHVybiB0aGlzLmZvcm1CdWlsZGVyLmdyb3VwKHtcclxuICAgICAgbWVzc2FnZTogZGF0YUl0ZW0ubWVzc2FnZSxcclxuICAgICAgc29ydE9yZGVyOiBkYXRhSXRlbS5zb3J0T3JkZXIsXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIHdyaXRlVmFsdWUodmFsdWU6IHN0cmluZykge1xyXG4gICAgaWYgKHZhbHVlICE9PSB0aGlzLnZhbHVlKSB7XHJcbiAgICAgIHRoaXMudmFsdWUgPSB2YWx1ZTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHJlZ2lzdGVyT25DaGFuZ2UoZm4pIHtcclxuICAgIHRoaXMub25Nb2RlbENoYW5nZSA9IGZuO1xyXG4gIH1cclxuXHJcbiAgcmVnaXN0ZXJPblRvdWNoZWQoZm4pIHtcclxuICAgIHRoaXMub25Nb2RlbFRvdWNoZWQgPSBmbjtcclxuICB9XHJcblxyXG4gIGJ1dHRvbkNsaWNrKGRhdGE6IGFueSkge1xyXG4gICAgdGhpcy5kcm9wRG93bkVsLmNsb3NlKCk7XHJcbiAgICB0aGlzLnZhbHVlID0gZGF0YTtcclxuICB9XHJcblxyXG4gIHVwbG9hZEF0dGFjaG1lbnQoKSB7XHJcbiAgICBpZiAodGhpcy51cGxvYWREaWFsb2cpIHtcclxuICAgICAgdGhpcy51cGxvYWREaWFsb2cudXBsb2FkRmlsZSh0aGlzLnByb2Nlc3NJbnN0YW5jZUlkLCAnd2ZfYXR0YWNobWVudCcpLnRoZW4ocmUgPT4ge1xyXG4gICAgICAgIGZvciAobGV0IGkgb2YgKHJlIGFzIGFueVtdKSkge1xyXG4gICAgICAgICAgdGhpcy5pc1JlcGVhdCA9IGZhbHNlO1xyXG4gICAgICAgICAgZm9yIChsZXQgYXR0YWNoIG9mIHRoaXMuYXR0YWNobWVudExpc3QpIHtcclxuICAgICAgICAgICAgaWYgKGF0dGFjaC5maWxlTmFtZSA9PT0gaS5maWxlTmFtZSkge1xyXG4gICAgICAgICAgICAgIHRoaXMubWVzc2FnZVNlcnZpY2UuaW5mbygn5YyF5ZCr6YeN5aSN5paH5Lu2JyArIGkuZmlsZU5hbWUpO1xyXG4gICAgICAgICAgICAgIHRoaXMuaXNSZXBlYXQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBpZiAoIXRoaXMuaXNSZXBlYXQpIHtcclxuICAgICAgICAgICAgdGhpcy5hdHRhY2htZW50TGlzdC5wdXNoKGkpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmF0dGFjaG1lbnQuZW1pdCh0aGlzLmF0dGFjaG1lbnRMaXN0KTtcclxuICAgICAgICAvL+aJp+ihjOS4iuS8oOmZhOS7tlxyXG4gICAgICAgIGxldCBmaWxlcyA9IG5ldyBGaWxlVXBsb2FkRW50aXR5KCk7XHJcbiAgICAgICAgZmlsZXMucm9vdElkID0gXCJ3Zl9hdHRhY2htZW50XCI7XHJcbiAgICAgICAgZmlsZXMubWV0YWRhdGFJZExpc3QgPSBbXTtcclxuICAgICAgICB0aGlzLmF0dGFjaG1lbnRMaXN0LmZvckVhY2goIGEgPT4ge1xyXG4gICAgICAgICAgZmlsZXMubWV0YWRhdGFJZExpc3QucHVzaChhLm1ldGFkYXRhSWQpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgZmlsZXMubWV0YWRhdGFJZExpc3QubGVuZ3RoICYmIHRoaXMuY29tbWVudFN2Yy51cGxvYWRBdHRhY2htZW50KGZpbGVzKS5zdWJzY3JpYmUoKCkgPT4ge30pO1xyXG4gICAgICB9KTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIuS9v+eUqOmZhOS7tuS4iuS8oOWKn+iDve+8jOivt+WNh+e6p+ihqOWNlVwiKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGF0dGFjaG1lbnREZWxldGUoYXR0YWNobWVudCkge1xyXG4gICAgdmFyIGdzcERvY0RlbGV0ZUVudGl0eTogRmlsZURlbGV0ZUVudGl0eSA9IHtcclxuICAgICAgcm9vdElkOiBcIndmX2F0dGFjaG1lbnRcIixcclxuICAgICAgbWV0YWRhdGFJZDogYXR0YWNobWVudC5tZXRhZGF0YUlkLFxyXG4gICAgICBtb2RlOiBcIkZvcm1hbFwiXHJcbiAgICB9XHJcbiAgICBsZXQgaW5kZXggPSB0aGlzLmF0dGFjaG1lbnRMaXN0LmluZGV4T2YoYXR0YWNobWVudCk7XHJcbiAgICBpZiAoaW5kZXggPiAtMSkge1xyXG4gICAgICB0aGlzLmF0dGFjaG1lbnRMaXN0LnNwbGljZShpbmRleCwgMSk7XHJcbiAgICB9XHJcbiAgICB0aGlzLmF0dGFjaG1lbnQuZW1pdCh0aGlzLmF0dGFjaG1lbnRMaXN0KTtcclxuICAgIHRoaXMuY29tbWVudFN2Yy5kZWxldGVBdHRhY2htZW50KGdzcERvY0RlbGV0ZUVudGl0eSkuc3Vic2NyaWJlKCgpID0+IHt9KTtcclxuICB9XHJcblxyXG4gIGltYWdlVXJsKGF0dGFjaG1lbnRJbmZvKSB7XHJcbiAgICByZXR1cm4gJy9wbGF0Zm9ybS9ydW50aW1lL3dmL3dlYmFwcC9tb2JpbGV0YXNrY2VudGVyL2Fzc2V0cy9hY2Nlc3NvcnkvJyArIHRoaXMuY3JlYXRlSXRlbShhdHRhY2htZW50SW5mbykgKyAnLnN2Zyc7XHJcbiAgfVxyXG5cclxuICAvL+ino+aekOaWh+S7tuexu+Wei++8jOe7meWHuue8qeeVpeWbvlxyXG4gIGNyZWF0ZUl0ZW0oYXR0YWNobWVudEluZm8pIHtcclxuICAgIHZhciBwb3MgPSBhdHRhY2htZW50SW5mby5maWxlTmFtZS5sYXN0SW5kZXhPZihcIi5cIik7XHJcbiAgICB2YXIgdHlwZSA9IGF0dGFjaG1lbnRJbmZvLmZpbGVOYW1lLnN1YnN0cmluZyhwb3MgKyAxKTtcclxuICAgIHR5cGUgPSAodHlwZSA9PSAnJyA/ICdEZWZhdWx0JyA6IHR5cGUudG9Mb3dlckNhc2UoKSk7XHJcbiAgICB2YXIgZG9jTGliID0gJ2RvYy1kb2N4LWh0bS1odG1sLWpzLXBkZi1wcHQtcHB0eC1yYXItemlwLXR4dC14bHMteGxzeCc7XHJcbiAgICB2YXIgdmlkZW9MaWIgPSAnd2F2LWFpZi1haWZmLWF1LW1wMS1tcDItbXAzLXJhLXJtLXJhbS1taWQtcm1pJztcclxuICAgIHZhciBhdWRpb0xpYiA9ICdhdmktcm0tcm12Yi1tcGVnLW1wZy1kYXQtbW92LXF0LWFzZi13bS1tcDQnO1xyXG4gICAgdmFyIGltZ0xpYiA9ICd3ZWJwLWJhaWJtcC1kdXBjeC10aWYtZ2lmLWpwZWctdGdhLWV4aWYtZnB4LXN2Zy1wc2QtY2RyLXBjZC1keGYtdWZvLWVwcy1haS1wbmctaGRyaS1yYXctd21mLWZsaWMtZW1mLWljby1qcGcnO1xyXG4gICAgaWYgKGRvY0xpYi5pbmRleE9mKHR5cGUpID49IDApIHtcclxuICAgICAgdHlwZSA9IHR5cGUudG9Mb3dlckNhc2UoKTtcclxuICAgIH0gZWxzZSBpZiAodmlkZW9MaWIuaW5kZXhPZih0eXBlKSA+PSAwKSB7XHJcbiAgICAgIHR5cGUgPSAndmlkZW8nO1xyXG4gICAgfSBlbHNlIGlmIChhdWRpb0xpYi5pbmRleE9mKHR5cGUpID49IDApIHtcclxuICAgICAgdHlwZSA9ICdhdWRpbyc7XHJcbiAgICB9IGVsc2UgaWYgKGltZ0xpYi5pbmRleE9mKHR5cGUpID49IDApIHtcclxuICAgICAgdHlwZSA9ICdwaWN0dXJlJztcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHR5cGUgPSAnZGVmYXVsdCc7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gdHlwZTtcclxuICB9XHJcbn1cclxuIl19