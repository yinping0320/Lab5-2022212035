/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, ViewChild, Optional, Output, EventEmitter } from '@angular/core';
import { UserService } from '../../services/user.service';
import { DataTableComponent } from '@farris/ui-datatable';
import { NotifyService } from '@farris/ui-notify';
import { DialogComponent } from '@farris/ui-dialog';
import { I18nService } from '../../services/i18n.service';
export class UserHelperComponent {
    /**
     * @param {?} i18nService
     * @param {?} userSvc
     * @param {?=} notify
     */
    constructor(i18nService, userSvc, notify) {
        this.i18nService = i18nService;
        this.userSvc = userSvc;
        this.notify = notify;
        this.pageList = [10, 20, 30, 50, 100];
        this.paginationOptions = {
            id: 'WF-Users-DataTable-Pagination',
            currentPage: 1,
            itemsPerPage: 10,
            pageList: this.pageList,
            totalItems: 0
        };
        this.columns = [
            { title: this.i18nService ? this.i18nService.getValue('static.columnName.code') : '编号', field: 'Code', width: 80 },
            { title: this.i18nService ? this.i18nService.getValue('static.columnName.name') : '姓名', field: 'Name', width: 90 },
            { title: this.i18nService ? this.i18nService.getValue('static.columnName.department') : '部门', field: 'OrgName', width: 200 }
        ];
        this.searchValue = null;
        this.userListData = [];
        // 是否允许多选,默认多选
        this.singleSelect = false;
        this.selectedUsers = [];
        this.completed = new EventEmitter();
    }
    /**
     * @return {?}
     */
    ngOnInit() {
    }
    /**
     * @return {?}
     */
    handleOk() {
        throw new Error('没有实现，需要子组件实现');
    }
    /**
     * @return {?}
     */
    handleCancel() {
        this.completed.emit(false);
        this.showModal(false);
    }
    /**
     * @param {?} pageSize
     * @return {?}
     */
    onPageSizeChange(pageSize) {
        this.paginationOptions.itemsPerPage = pageSize;
        this.getUserList();
    }
    /**
     * @param {?} event
     * @return {?}
     */
    onPageChange(event) {
        this.paginationOptions.currentPage = event.pageIndex;
        this.getUserList();
    }
    /**
     * @protected
     * @return {?}
     */
    getUserList() {
        this.userSvc.getUserList(this.searchValue, this.paginationOptions.currentPage, this.paginationOptions.itemsPerPage)
            .subscribe((/**
         * @param {?} re
         * @return {?}
         */
        (re) => {
            this.paginationOptions.totalItems = re.totalCount;
            this.userListData = re.data.map((/**
             * @param {?} u
             * @return {?}
             */
            u => ({
                ID: u.id,
                Code: u.code,
                Name: u.name,
                OrgId: u.sysOrgId,
                OrgName: u.sysOrgName,
                Checked: false
            })));
        }));
    }
    /**
     * @param {?} event
     * @return {?}
     */
    search(event) {
        this.paginationOptions.currentPage = 1;
        this.searchValue = encodeURIComponent(event.value);
        if (event.field === '*') {
            this.getUserList();
        }
        else if (event.field === 'Name') {
            this.getUserList();
        }
        else {
            this.notify.warning('只支持用户名称过滤！');
        }
    }
    /**
     * @protected
     * @param {?} show
     * @return {?}
     */
    showModal(show) {
        if (show) {
            this.userDialog.show();
            this.getUserList();
        }
        else {
            // 临时处理方案
            if (this.userDialog.beforeClose) {
                this.userDialog.close();
            }
        }
    }
}
UserHelperComponent.decorators = [
    { type: Component, args: [{
                selector: 'wf-user-helper',
                template: "<farris-dialog #allUserDialog [buttons]=\"buttonRef\" [width]=\"850\" [height]=\"520\" [title]=\"'\u7CFB\u7EDF\u7528\u6237'\">\r\n  <div class=\"d-flex flex-column my-data-grid h-100\" style=\"padding: 0 14px;\">\r\n    <div class=\"flex-auto\" style=\"position:relative;\">\r\n      <farris-datatable #allUserTable [columns]=\"columns\" [data]=\"userListData | paginate: paginationOptions\"\r\n        [showFilterBar]='true' [singleSelect]=\"singleSelect\" [idField]=\"'ID'\" [remote]=\"'server'\" (search)=\"search($event)\"\r\n        [pagination]='false'></farris-datatable>\r\n    </div>\r\n    <div style=\"position:relative;\">\r\n      <pagination-controls [id]=\"paginationOptions.id\" [previousLabel]=\"' '\" [nextLabel]=\"' '\"\r\n        (pageChange)=\"onPageChange($event)\" (pageSizeChange)=\"onPageSizeChange($event)\">\r\n      </pagination-controls>\r\n    </div>\r\n  </div>\r\n</farris-dialog>\r\n<ng-template #buttonRef>\r\n  <button class=\"btn btn-sm btn-primary px-3\" (click)=\"handleOk()\">\u786E\u5B9A</button>\r\n  <button class=\"btn btn-sm btn-default px-3\" (click)=\"handleCancel()\">\u53D6\u6D88</button>\r\n</ng-template>",
                styles: [".my-data-grid .filter-row .search-fields{padding-left:0!important}.my-data-grid .filter-row .search-text{padding-right:0!important}"]
            }] }
];
/** @nocollapse */
UserHelperComponent.ctorParameters = () => [
    { type: I18nService, decorators: [{ type: Optional }] },
    { type: UserService },
    { type: NotifyService }
];
UserHelperComponent.propDecorators = {
    userTable: [{ type: ViewChild, args: ['allUserTable',] }],
    userDialog: [{ type: ViewChild, args: ['allUserDialog',] }],
    completed: [{ type: Output }]
};
if (false) {
    /**
     * @type {?}
     * @private
     */
    UserHelperComponent.prototype.pageList;
    /** @type {?} */
    UserHelperComponent.prototype.paginationOptions;
    /** @type {?} */
    UserHelperComponent.prototype.columns;
    /** @type {?} */
    UserHelperComponent.prototype.searchValue;
    /** @type {?} */
    UserHelperComponent.prototype.userListData;
    /** @type {?} */
    UserHelperComponent.prototype.singleSelect;
    /** @type {?} */
    UserHelperComponent.prototype.selectedUsers;
    /** @type {?} */
    UserHelperComponent.prototype.userTable;
    /** @type {?} */
    UserHelperComponent.prototype.userDialog;
    /** @type {?} */
    UserHelperComponent.prototype.completed;
    /**
     * @type {?}
     * @protected
     */
    UserHelperComponent.prototype.i18nService;
    /**
     * @type {?}
     * @protected
     */
    UserHelperComponent.prototype.userSvc;
    /**
     * @type {?}
     * @protected
     */
    UserHelperComponent.prototype.notify;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidXNlci1oZWxwZXIuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGdzcC13Zi9ydGRldmtpdC8iLCJzb3VyY2VzIjpbImxpYi9ydW50aW1lL2NvbXBvbmVudHMvdXNlci1oZWxwZXIvdXNlci1oZWxwZXIuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7QUFBQSxPQUFPLEVBQUUsU0FBUyxFQUFVLFNBQVMsRUFBRSxRQUFRLEVBQUUsTUFBTSxFQUFFLFlBQVksRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUM3RixPQUFPLEVBQUUsV0FBVyxFQUFFLE1BQU0sNkJBQTZCLENBQUM7QUFFMUQsT0FBTyxFQUFFLGtCQUFrQixFQUFFLE1BQU0sc0JBQXNCLENBQUM7QUFDMUQsT0FBTyxFQUFFLGFBQWEsRUFBRSxNQUFNLG1CQUFtQixDQUFDO0FBQ2xELE9BQU8sRUFBRSxlQUFlLEVBQUUsTUFBTSxtQkFBbUIsQ0FBQztBQUNwRCxPQUFPLEVBQUUsV0FBVyxFQUFFLE1BQU0sNkJBQTZCLENBQUM7QUFPMUQsTUFBTSxPQUFPLG1CQUFtQjs7Ozs7O0lBNEI5QixZQUN3QixXQUF3QixFQUNwQyxPQUFvQixFQUNwQixNQUFzQjtRQUZWLGdCQUFXLEdBQVgsV0FBVyxDQUFhO1FBQ3BDLFlBQU8sR0FBUCxPQUFPLENBQWE7UUFDcEIsV0FBTSxHQUFOLE1BQU0sQ0FBZ0I7UUE3QjFCLGFBQVEsR0FBRyxDQUFDLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxHQUFHLENBQUMsQ0FBQztRQUN6QyxzQkFBaUIsR0FBdUI7WUFDdEMsRUFBRSxFQUFFLCtCQUErQjtZQUNuQyxXQUFXLEVBQUUsQ0FBQztZQUNkLFlBQVksRUFBRSxFQUFFO1lBQ2hCLFFBQVEsRUFBRSxJQUFJLENBQUMsUUFBUTtZQUN2QixVQUFVLEVBQUUsQ0FBQztTQUNkLENBQUM7UUFDRixZQUFPLEdBQUc7WUFDUixFQUFFLEtBQUssRUFBRSxJQUFJLENBQUMs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O1NBQ3BCO2FBQU0sSUFBSSxLQUFLLENBQUMsS0FBSyxLQUFLLE1BQU0sRUFBRTtZQUNqQyxJQUFJLENBQUMsV0FBVyxFQUFFLENBQUM7U0FDcEI7YUFBTTtZQUNMLElBQUksQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLFlBQVksQ0FBQyxDQUFDO1NBQ25DO0lBQ0gsQ0FBQzs7Ozs7O0lBRVMsU0FBUyxDQUFDLElBQWE7UUFDL0IsSUFBSSxJQUFJLEVBQUU7WUFDUixJQUFJLENBQUMsVUFBVSxDQUFDLElBQUksRUFBRSxDQUFDO1lBQ3ZCLElBQUksQ0FBQyxXQUFXLEVBQUUsQ0FBQztTQUNwQjthQUFNO1lBQ0wsU0FBUztZQUNULElBQUksSUFBSSxDQUFDLFVBQVUsQ0FBQyxXQUFXLEVBQUU7Z0JBQy9CLElBQUksQ0FBQyxVQUFVLENBQUMsS0FBSyxFQUFFLENBQUM7YUFDekI7U0FDRjtJQUNILENBQUM7OztZQXRHRixTQUFTLFNBQUM7Z0JBQ1QsUUFBUSxFQUFFLGdCQUFnQjtnQkFDMUIsOG9DQUEyQzs7YUFFNUM7Ozs7WUFOUSxXQUFXLHVCQW9DZixRQUFRO1lBekNKLFdBQVc7WUFHWCxhQUFhOzs7d0JBbUNuQixTQUFTLFNBQUMsY0FBYzt5QkFDeEIsU0FBUyxTQUFDLGVBQWU7d0JBT3pCLE1BQU07Ozs7Ozs7SUFoQ1AsdUNBQXlDOztJQUN6QyxnREFNRTs7SUFDRixzQ0FHZ0k7O0lBRWhJLDBDQUFtQjs7SUFDbkIsMkNBQWtCOztJQUVsQiwyQ0FBcUI7O0lBQ3JCLDRDQU1TOztJQUNULHdDQUF5RDs7SUFDekQseUNBQXlEOztJQU96RCx3Q0FDd0M7Ozs7O0lBTnRDLDBDQUE4Qzs7Ozs7SUFDOUMsc0NBQThCOzs7OztJQUM5QixxQ0FBZ0MiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb21wb25lbnQsIE9uSW5pdCwgVmlld0NoaWxkLCBPcHRpb25hbCwgT3V0cHV0LCBFdmVudEVtaXR0ZXIgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgVXNlclNlcnZpY2UgfSBmcm9tICcuLi8uLi9zZXJ2aWNlcy91c2VyLnNlcnZpY2UnO1xyXG5pbXBvcnQgeyBQYWdpbmF0aW9uSW5zdGFuY2UgfSBmcm9tICdAZmFycmlzL3VpLXBhZ2luYXRpb24nO1xyXG5pbXBvcnQgeyBEYXRhVGFibGVDb21wb25lbnQgfSBmcm9tICdAZmFycmlzL3VpLWRhdGF0YWJsZSc7XHJcbmltcG9ydCB7IE5vdGlmeVNlcnZpY2UgfSBmcm9tICdAZmFycmlzL3VpLW5vdGlmeSc7XHJcbmltcG9ydCB7IERpYWxvZ0NvbXBvbmVudCB9IGZyb20gJ0BmYXJyaXMvdWktZGlhbG9nJztcclxuaW1wb3J0IHsgSTE4blNlcnZpY2UgfSBmcm9tICcuLi8uLi9zZXJ2aWNlcy9pMThuLnNlcnZpY2UnO1xyXG5cclxuQENvbXBvbmVudCh7XHJcbiAgc2VsZWN0b3I6ICd3Zi11c2VyLWhlbHBlcicsXHJcbiAgdGVtcGxhdGVVcmw6ICcuL3VzZXItaGVscGVyLmNvbXBvbmVudC5odG1sJyxcclxuICBzdHlsZVVybHM6IFsnLi91c2VyLWhlbHBlci5jb21wb25lbnQuY3NzJ11cclxufSlcclxuZXhwb3J0IGNsYXNzIFVzZXJIZWxwZXJDb21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQge1xyXG5cclxuICBwcml2YXRlIHBhZ2VMaXN0ID0gWzEwLCAyMCwgMzAsIDUwLCAxMDBdO1xyXG4gIHBhZ2luYXRpb25PcHRpb25zOiBQYWdpbmF0aW9uSW5zdGFuY2UgPSB7XHJcbiAgICBpZDogJ1dGLVVzZXJzLURhdGFUYWJsZS1QYWdpbmF0aW9uJyxcclxuICAgIGN1cnJlbnRQYWdlOiAxLFxyXG4gICAgaXRlbXNQZXJQYWdlOiAxMCxcclxuICAgIHBhZ2VMaXN0OiB0aGlzLnBhZ2VMaXN0LFxyXG4gICAgdG90YWxJdGVtczogMFxyXG4gIH07XHJcbiAgY29sdW1ucyA9IFtcclxuICAgIHsgdGl0bGU6IHRoaXMuaTE4blNlcnZpY2UgPyB0aGlzLmkxOG5TZXJ2aWNlLmdldFZhbHVlKCdzdGF0aWMuY29sdW1uTmFtZS5jb2RlJykgOiAn57yW5Y+3JywgZmllbGQ6ICdDb2RlJywgd2lkdGg6IDgwIH0sXHJcbiAgICB7IHRpdGxlOiB0aGlzLmkxOG5TZXJ2aWNlID8gdGhpcy5pMThuU2VydmljZS5nZXRWYWx1ZSgnc3RhdGljLmNvbHVtbk5hbWUubmFtZScpIDogJ+Wnk+WQjScsIGZpZWxkOiAnTmFtZScsIHdpZHRoOiA5MCB9LFxyXG4gICAgeyB0aXRsZTogdGhpcy5pMThuU2VydmljZSA/IHRoaXMuaTE4blNlcnZpY2UuZ2V0VmFsdWUoJ3N0YXRpYy5jb2x1bW5OYW1lLmRlcGFydG1lbnQnKSA6ICfpg6jpl6gnLCBmaWVsZDogJ09yZ05hbWUnLCB3aWR0aDogMjAwIH1dO1xyXG5cclxuICBzZWFyY2hWYWx1ZSA9IG51bGw7XHJcbiAgdXNlckxpc3REYXRhID0gW107XHJcbiAgLy8g5piv5ZCm5YWB6K645aSa6YCJLOm7mOiupOWkmumAiVxyXG4gIHNpbmdsZVNlbGVjdCA9IGZhbHNlO1xyXG4gIHNlbGVjdGVkVXNlcnM6IHtcclxuICAgIElEOiBzdHJpbmcsXHJcbiAgICBDb2RlOiBzdHJpbmcsXHJcbiAgICBOYW1lOiBzdHJpbmcsXHJcbiAgICBPcmdJZDogc3RyaW5nLFxyXG4gICAgT3JnTmFtZTogc3RyaW5nXHJcbiAgfVtdID0gW107XHJcbiAgQFZpZXdDaGlsZCgnYWxsVXNlclRhYmxlJykgdXNlclRhYmxlOiBEYXRhVGFibGVDb21wb25lbnQ7XHJcbiAgQFZpZXdDaGlsZCgnYWxsVXNlckRpYWxvZycpIHVzZXJEaWFsb2c/OiBEaWFsb2dDb21wb25lbnQ7XHJcbiAgY29uc3RydWN0b3IoXHJcbiAgICBAT3B0aW9uYWwoKSBwcm90ZWN0ZWQgaTE4blNlcnZpY2U6IEkxOG5TZXJ2aWNlLFxyXG4gICAgcHJvdGVjdGVkIHVzZXJTdmM6IFVzZXJTZXJ2aWNlLFxyXG4gICAgcHJvdGVjdGVkIG5vdGlmeT86IE5vdGlmeVNlcnZpY2UsXHJcbiAgKSB7IH1cclxuXHJcbiAgQE91dHB1dCgpXHJcbiAgY29tcGxldGVkID0gbmV3IEV2ZW50RW1pdHRlcjxib29sZWFuPigpO1xyXG4gIFxyXG4gIG5nT25Jbml0KCkge1xyXG4gIH1cclxuXHJcbiAgaGFuZGxlT2soKTogdm9pZCB7XHJcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ+ayoeacieWunueOsO+8jOmcgOimgeWtkOe7hOS7tuWunueOsCcpO1xyXG4gIH1cclxuXHJcbiAgaGFuZGxlQ2FuY2VsKCk6IHZvaWQge1xyXG4gICAgdGhpcy5jb21wbGV0ZWQuZW1pdChmYWxzZSk7XHJcbiAgICB0aGlzLnNob3dNb2RhbChmYWxzZSk7XHJcbiAgfVxyXG5cclxuICBvblBhZ2VTaXplQ2hhbmdlKHBhZ2VTaXplKSB7XHJcbiAgICB0aGlzLnBhZ2luYXRpb25PcHRpb25zLml0ZW1zUGVyUGFnZSA9IHBhZ2VTaXplO1xyXG4gICAgdGhpcy5nZXRVc2VyTGlzdCgpO1xyXG4gIH1cclxuXHJcbiAgb25QYWdlQ2hhbmdlKGV2ZW50KSB7XHJcbiAgICB0aGlzLnBhZ2luYXRpb25PcHRpb25zLmN1cnJlbnRQYWdlID0gZXZlbnQucGFnZUluZGV4O1xyXG4gICAgdGhpcy5nZXRVc2VyTGlzdCgpO1xyXG4gIH1cclxuXHJcbiAgcHJvdGVjdGVkIGdldFVzZXJMaXN0KCkge1xyXG4gICAgdGhpcy51c2VyU3ZjLmdldFVzZXJMaXN0KHRoaXMuc2VhcmNoVmFsdWUsIHRoaXMucGFnaW5hdGlvbk9wdGlvbnMuY3VycmVudFBhZ2UsIHRoaXMucGFnaW5hdGlvbk9wdGlvbnMuaXRlbXNQZXJQYWdlKVxyXG4gICAgICAuc3Vic2NyaWJlKChyZTogeyB0b3RhbENvdW50OiBudW1iZXIsIGRhdGE6IGFueVtdIH0pID0+IHtcclxuICAgICAgICB0aGlzLnBhZ2luYXRpb25PcHRpb25zLnRvdGFsSXRlbXMgPSByZS50b3RhbENvdW50O1xyXG4gICAgICAgIHRoaXMudXNlckxpc3REYXRhID0gcmUuZGF0YS5tYXAodSA9PiAoe1xyXG4gICAgICAgICAgSUQ6IHUuaWQsXHJcbiAgICAgICAgICBDb2RlOiB1LmNvZGUsXHJcbiAgICAgICAgICBOYW1lOiB1Lm5hbWUsXHJcbiAgICAgICAgICBPcmdJZDogdS5zeXNPcmdJZCxcclxuICAgICAgICAgIE9yZ05hbWU6IHUuc3lzT3JnTmFtZSxcclxuICAgICAgICAgIENoZWNrZWQ6IGZhbHNlXHJcbiAgICAgICAgfSkpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBzZWFyY2goZXZlbnQpIHtcclxuICAgIHRoaXMucGFnaW5hdGlvbk9wdGlvbnMuY3VycmVudFBhZ2UgPSAxO1xyXG4gICAgdGhpcy5zZWFyY2hWYWx1ZSA9IGVuY29kZVVSSUNvbXBvbmVudChldmVudC52YWx1ZSk7XHJcblxyXG4gICAgaWYgKGV2ZW50LmZpZWxkID09PSAnKicpIHtcclxuICAgICAgdGhpcy5nZXRVc2VyTGlzdCgpO1xyXG4gICAgfSBlbHNlIGlmIChldmVudC5maWVsZCA9PT0gJ05hbWUnKSB7XHJcbiAgICAgIHRoaXMuZ2V0VXNlckxpc3QoKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMubm90aWZ5Lndhcm5pbmcoJ+WPquaUr+aMgeeUqOaIt+WQjeensOi/h+a7pO+8gScpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcHJvdGVjdGVkIHNob3dNb2RhbChzaG93OiBib29sZWFuKTogdm9pZCB7XHJcbiAgICBpZiAoc2hvdykge1xyXG4gICAgICB0aGlzLnVzZXJEaWFsb2cuc2hvdygpO1xyXG4gICAgICB0aGlzLmdldFVzZXJMaXN0KCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAvLyDkuLTml7blpITnkIbmlrnmoYhcclxuICAgICAgaWYgKHRoaXMudXNlckRpYWxvZy5iZWZvcmVDbG9zZSkge1xyXG4gICAgICAgIHRoaXMudXNlckRpYWxvZy5jbG9zZSgpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG59XHJcbiJdfQ==