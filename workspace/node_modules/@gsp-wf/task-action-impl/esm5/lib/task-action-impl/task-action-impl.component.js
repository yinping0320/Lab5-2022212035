/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
import { Component, ViewChild, ViewContainerRef, Injector, ComponentFactoryResolver, Input, Output, EventEmitter, ElementRef, NgZone } from '@angular/core';
import { TaskExecuteComponent } from '@gsp-wf/wf-task-handler';
import { TaskEntity } from '@gsp-wf/task-impl-api';
import { Subject } from 'rxjs';
import { LoadingService } from '@farris/ui-loading';
import { MessagerService } from '@farris/ui-messager';
import { ActionOrigin } from '@gsp-wf/task-impl-api';
import { TaskActionImplService } from '../task-action-impl.service';
var TaskActionImplComponent = /** @class */ (function () {
    // 注意：修改构造方法需要重新打包task-main和task form
    function TaskActionImplComponent(injector, cfr, loadingService, msgService, taskService) {
        this.injector = injector;
        this.cfr = cfr;
        this.loadingService = loadingService;
        this.msgService = msgService;
        this.taskService = taskService;
        this.showButtons = true; //是否展示提交按钮。任务办理界面展示，任务列表不展示
        //是否展示提交按钮。任务办理界面展示，任务列表不展示
        this.batch = false;
        // 来源，从哪打开的
        this.submited = new EventEmitter();
        this.actionCode = new EventEmitter();
        this.actionCodeMap = new Map();
        this.index = 0;
        this.submitDisable = false; // 提交按钮是否禁用
        // 提交按钮是否禁用
        this.ifFocused = false; // 是否关注了此任务
        // 是否关注了此任务
        this.focus = this.i18nService("focus"); //关注此流程
        //关注此流程
        this.ifShowFocus = true; // 是否启用我的关注功能
        this.ngZone = this.injector.get(NgZone);
    }
    Object.defineProperty(TaskActionImplComponent.prototype, "iframe", {
        get: /**
         * @return {?}
         */
        function () {
            return this._iframe;
        },
        set: /**
         * @param {?} iframe
         * @return {?}
         */
        function (iframe) {
            this._iframe = iframe;
            if (this.iframe && this.componentRef) {
                this.componentRef.instance.iframe = this.iframe;
            }
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    TaskActionImplComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        //表单触发预解析，重新加载组件
        ((/** @type {?} */ (window))).gspWfEventService = ((/** @type {?} */ (window))).gspWfEventService || {};
        ((/** @type {?} */ (window))).gspWfEventService.simulate = function (func) {
            _this.ngZone.run(function () {
                _this.actionSelect(_this.actions[0], 0).subscribe(function () { return func && typeof func === 'function' && func(); });
            });
        };
        // 是否启用我的关注功能
        /** @type {?} */
        var load = this.loadingService.show();
        this.taskService.getTaskCenterConfigByCode("If_Show_My_Focus", 'all', '*').subscribe(function (re) {
            load.close();
            re && re.currentValue === 'false' && (_this.ifShowFocus = false);
            // 是否关注了该任务(从详情打开)
            if (_this.ifShowFocus && _this.task && _this.showButtons) {
                /** @type {?} */
                var load_1 = _this.loadingService.show();
                _this.taskService.ifFocused(_this.task.processInstanceId).subscribe(function (re) {
                    load_1.close();
                    _this.ifFocused = re && re.length ? true : false;
                }, function () {
                    load_1.close();
                });
            }
        }, function () {
            load.close();
        });
    };
    /**
     * 选中动作按钮
     * @param action
     * @param index
     * @returns
     */
    /**
     * 选中动作按钮
     * @param {?} action
     * @param {?=} index
     * @return {?}
     */
    TaskActionImplComponent.prototype.actionSelect = /**
     * 选中动作按钮
     * @param {?} action
     * @param {?=} index
     * @return {?}
     */
    function (action, index) {
        var _this = this;
        /** @type {?} */
        var subject = new Subject();
        this.selectAction = action;
        if (index) {
            this.index = index;
        }
        /** @type {?} */
        var cmpFactory;
        if (action.typeId === 'wf') {
            cmpFactory = this.cfr.resolveComponentFactory(TaskExecuteComponent);
            this.loadComponentFactory(cmpFactory);
            setTimeout(function () {
                subject.next({ result: true });
            }, 100);
        }
        else {
            System.import(action.impl + '?v=' + new Date().getTime().toString()).then(function (moduleFactories) {
                /** @type {?} */
                var moduleFactory = Object.values(moduleFactories)[0];
                /** @type {?} */
                var moduleRef = moduleFactory.create(_this.injector);
                cmpFactory = moduleRef.instance.getActionComponentFactory(action);
                _this.loadComponentFactory(cmpFactory);
                subject.next({ result: true });
            });
        }
        return subject.asObservable();
    };
    /**
     * 动态加载审批组件
     * @param cmpFactory
     */
    /**
     * 动态加载审批组件
     * @private
     * @param {?} cmpFactory
     * @return {?}
     */
    TaskActionImplComponent.prototype.loadComponentFactory = /**
     * 动态加载审批组件
     * @private
     * @param {?} cmpFactory
     * @return {?}
     */
    function (cmpFactory) {
        /** @type {?} */
        var comment;
        if (this.componentRef && this.componentRef.instance) {
            comment = ((/** @type {?} */ (this.componentRef.instance))).comment;
        }
        this.container.clear();
        this.componentRef = this.container.createComponent(cmpFactory, 0, this.injector);
        this.componentRef.instance.origin = this.showButtons ? ActionOrigin.TaskForm : ActionOrigin.TaskCenter;
        if (this.task && this.componentRef.instance.setTask) {
            this.componentRef.instance.setTask(this.task);
        }
        if (this.componentRef.instance.setAction) {
            this.componentRef.instance.setAction(this.selectAction);
        }
        if (this.componentRef.instance.dialogHeight) {
            this.dialogHeight = this.componentRef.instance.dialogHeight;
        }
        if (this.componentRef.instance.dialogWidth) {
            this.dialogWidth = this.componentRef.instance.dialogWidth;
        }
        // 暂存wf的审批意见
        ((/** @type {?} */ (this.componentRef.instance))).wfCacheComment = comment;
        this.container.insert(this.componentRef.hostView);
    };
    /**
     * 点击提交
     */
    /**
     * 点击提交
     * @return {?}
     */
    TaskActionImplComponent.prototype.submit = /**
     * 点击提交
     * @return {?}
     */
    function () {
        var _this = this;
        //表单前事件
        if (this.showButtons && window['taskCenterBeforeLoad']) {
            this.submitDisable = true;
            /** @type {?} */
            var context = {
                task: this.task,
                action: this.selectAction
            };
            window['taskCenterBeforeLoad'](context).then(function (re) {
                _this.submitDisable = false;
                if (re && re.result == true) {
                    _this.showConfirmDialog();
                }
            }, function (error) {
                _this.submitDisable = false;
                console.error(error);
            });
        }
        else {
            this.showConfirmDialog();
        }
    };
    /**
     * 是否提交前确认
     */
    /**
     * 是否提交前确认
     * @private
     * @return {?}
     */
    TaskActionImplComponent.prototype.showConfirmDialog = /**
     * 是否提交前确认
     * @private
     * @return {?}
     */
    function () {
        var _this = this;
        this.taskService.getTaskCenterConfigByCode('Is_Confirm_Commit').subscribe(function (config) {
            if (config.currentValue === 'true') {
                _this.msgService.question(_this.i18nService("confirm") + _this.selectAction.name + '？', function () {
                    _this.executeSubmit();
                });
            }
            else {
                _this.executeSubmit();
            }
        });
    };
    /**
     * @private
     * @return {?}
     */
    TaskActionImplComponent.prototype.executeSubmit = /**
     * @private
     * @return {?}
     */
    function () {
        var _this = this;
        this.submitDisable = true;
        if (this.selectAction.preEvents && this.selectAction.preEvents.length > 0
            && this.selectAction.preEvents.filter(function (e) { return !e.batch; }).length > 0) {
            /** @type {?} */
            var taskComment_1;
            /** @type {?} */
            var action = (/** @type {?} */ (this.selectAction));
            if (action.typeId === 'wf') {
                // 取意见框里的意见存放在taskComment里
                taskComment_1 = ((/** @type {?} */ (this.componentRef.instance))).comment;
            }
            else {
            }
            this.executeEvents(tslib_1.__spread(this.selectAction.preEvents.filter(function (e) { return !e.batch; })), function () {
                _this.confirmSubmit(taskComment_1);
            }, taskComment_1);
        }
        else {
            this.confirmSubmit();
        }
    };
    /**
     * @private
     * @param {?=} taskComment
     * @return {?}
     */
    TaskActionImplComponent.prototype.confirmSubmit = /**
     * @private
     * @param {?=} taskComment
     * @return {?}
     */
    function (taskComment) {
        var _this = this;
        /** @type {?} */
        var load = this.loadingService.show();
        this.handleSubmit().subscribe(function (re) {
            if (re) {
                load.close();
                if (re.result) {
                    if (_this.selectAction && _this.selectAction.postEvents.length > 0
                        && _this.selectAction.postEvents.filter(function (e) { return !e.batch; }).length > 0) {
                        _this.executeEvents(tslib_1.__spread(_this.selectAction.postEvents.filter(function (e) { return !e.batch; })), function () {
                            _this.submited.emit(re);
                            setTimeout(function () {
                                _this.submitDisable = false;
                            }, 2000);
                        }, taskComment);
                    }
                    else {
                        _this.submited.emit(re);
                        setTimeout(function () {
                            _this.submitDisable = false;
                        }, 2000);
                    }
                }
                else {
                    _this.submitDisable = false;
                }
            }
            _this.actionCodeMap.set('isTransfer', _this.selectAction.code === 'Transfer');
            _this.actionCodeMap.set('isAddSignFront', _this.selectAction.code === 'AddSignFront');
            _this.actionCodeMap.set('isUnClaim', _this.selectAction.code === 'Unclaim');
            _this.actionCodeMap.set('isComment', _this.selectAction.code === 'Comment');
            _this.actionCodeMap.set('isClaim', _this.selectAction.code === 'Claim');
            _this.actionCode.emit(_this.actionCodeMap);
        });
    };
    /**
     * @return {?}
     */
    TaskActionImplComponent.prototype.handleSubmit = /**
     * @return {?}
     */
    function () {
        return this.componentRef.instance.submit();
    };
    /**
     * @param {?} tasks
     * @return {?}
     */
    TaskActionImplComponent.prototype.batchHandleSubmit = /**
     * @param {?} tasks
     * @return {?}
     */
    function (tasks) {
        return this.componentRef.instance.batchSubmit(tasks);
    };
    /**
     * @private
     * @param {?} events
     * @param {?} handler
     * @param {?=} taskComment
     * @return {?}
     */
    TaskActionImplComponent.prototype.executeEvents = /**
     * @private
     * @param {?} events
     * @param {?} handler
     * @param {?=} taskComment
     * @return {?}
     */
    function (events, handler, taskComment) {
        var _this = this;
        if (events && events.length > 0) {
            /** @type {?} */
            var event_1 = events.shift();
            /** @type {?} */
            var url = event_1.eventImpl.split('#')[0];
            /** @type {?} */
            var func_1 = event_1.eventImpl.split('#')[1];
            System.import(url + '?v=' + new Date().getTime().toString())
                .then(function (moduleFactories) {
                /** @type {?} */
                var moduleFactory = Object.values(moduleFactories)[0];
                /** @type {?} */
                var moduleRef = moduleFactory.create(_this.injector);
                /** @type {?} */
                var context = {
                    task: _this.task,
                    action: _this.selectAction,
                    origin: 'TaskForm',
                    formIframe: _this.iframe,
                    comment: taskComment,
                };
                moduleRef.instance[func_1].apply(moduleRef.instance, [context]).subscribe(function (re) {
                    // 兼容旧的布尔类型参数
                    if (typeof re === 'boolean') {
                        if (re) {
                            _this.executeEvents(events, handler, taskComment);
                        }
                        else {
                            _this.submitDisable = false;
                        }
                    }
                    else {
                        if (re.result) {
                            if (re.comment) {
                                taskComment = re.comment;
                                // 取到的前事件意见包含在taskComment里
                            }
                            _this.executeEvents(events, handler, taskComment);
                        }
                        else {
                            _this.submitDisable = false;
                        }
                    }
                });
            });
        }
        else {
            ((/** @type {?} */ (this.componentRef.instance))).comment = taskComment;
            handler();
        }
    };
    /**
     * 点击添加/取消关注
     */
    /**
     * 点击添加/取消关注
     * @return {?}
     */
    TaskActionImplComponent.prototype.focusTask = /**
     * 点击添加/取消关注
     * @return {?}
     */
    function () {
        /** @type {?} */
        var load = this.loadingService.show();
        if (this.ifFocused) {
            this.taskService.addFocus(this.task.sourceId).subscribe(function () {
                load.close();
            }, function () {
                load.close();
            });
        }
        else {
            this.taskService.removeFocus(this.task.processInstanceId).subscribe(function () {
                load.close();
            }, function () {
                load.close();
            });
        }
    };
    /**
     * 国际化
     * @param code
     * @returns
     */
    /**
     * 国际化
     * @param {?} code
     * @return {?}
     */
    TaskActionImplComponent.prototype.i18nService = /**
     * 国际化
     * @param {?} code
     * @return {?}
     */
    function (code) {
        /** @type {?} */
        var result;
        /** @type {?} */
        var supportLanguage = ["zh-CHS", "zh-CHT", "en"];
        /** @type {?} */
        var curLanguage = localStorage.getItem("languageCode");
        /** @type {?} */
        var translate = {
            "zh-CHS": {
                focus: "关注此流程",
                focused: "已关注此流程",
                confirm: "确认"
            },
            "zh-CHT": {
                focus: "關註此流程",
                focused: "已關註此流程",
                confirm: "確認"
            },
            en: {
                focus: "Focus this process",
                focused: "Focused this process",
                confirm: "Confirm"
            },
        };
        if (curLanguage && supportLanguage.includes(curLanguage)) {
            result = translate[curLanguage][code];
        }
        else {
            result = translate["zh-CHS"][code];
        }
        return result;
    };
    TaskActionImplComponent.decorators = [
        { type: Component, args: [{
                    selector: 'task-action-impl',
                    template: "<form\r\n  [class]=\"showButtons ? '' : 'px-4 py-2'\"\r\n  style=\"display: flex; flex-direction: column\"\r\n>\r\n  <div\r\n    *ngIf=\"showButtons\"\r\n    class=\"fa-approval-operate-list fa-approve-common-gutter flex-wrap\"\r\n  >\r\n    <div\r\n      *ngFor=\"let action of actions; let i = index\"\r\n      class=\"fa-approval-operate\"\r\n    >\r\n      <input\r\n        type=\"radio\"\r\n        name=\"operate\"\r\n        [value]=\"i\"\r\n        [id]=\"i\"\r\n        class=\"approval-operate--radio\"\r\n        [checked]=\"i === 0 ? true : false\"\r\n      />\r\n      <label\r\n        class=\"approval-operate--label\"\r\n        [for]=\"i\"\r\n        (click)=\"actionSelect(action, i)\"\r\n      >\r\n        <span class=\"label-title\">{{ action.name }}</span>\r\n        <div class=\"label-tip\"></div>\r\n        <span class=\"f-icon label-icon\"></span>\r\n      </label>\r\n    </div>\r\n  </div>\r\n  <!--\u7EC4\u4EF6\u5BB9\u5668-->\r\n  <ng-container #container></ng-container>\r\n\r\n  <!-- \u5173\u6CE8\u6B64\u6D41\u7A0B -->\r\n  <div\r\n    *ngIf=\"\r\n      showButtons && selectAction && selectAction.typeId === 'wf' && ifShowFocus\r\n    \"\r\n    class=\"custom-control custom-checkbox custom-control-inline\"\r\n    style=\"margin-bottom: 20px\"\r\n  >\r\n    <input\r\n      type=\"checkbox\"\r\n      class=\"custom-control-input\"\r\n      [(ngModel)]=\"ifFocused\"\r\n      (ngModelChange)=\"focusTask()\"\r\n      id=\"taskcenterfocus\"\r\n      name=\"taskcenterfocus\"\r\n    />\r\n    <label class=\"custom-control-label\" for=\"taskcenterfocus\">{{\r\n      focus\r\n    }}</label>\r\n  </div>\r\n\r\n  <!-- \u63D0\u4EA4\u6309\u94AE -->\r\n  <div class=\"fa-btn-group-lg\">\r\n    <button\r\n      *ngIf=\"showButtons && actions.length\"\r\n      type=\"button\"\r\n      class=\"btn btn-primary\"\r\n      [disabled]=\"submitDisable\"\r\n      directive-throttle\r\n      (throttleClick)=\"submit()\"\r\n    >\r\n      {{ submitName }}\r\n    </button>\r\n  </div>\r\n</form>\r\n",
                    styles: [".fa-approval-operate-list{display:flex;flex-direction:row;align-items:center}.fa-approval-operate-list .fa-approval-operate{margin-right:8px;margin-bottom:8px}.fa-approval-operate-list .approval-operate--label{position:relative;padding:4px 21px;overflow:hidden;cursor:pointer;margin-bottom:0;background:#f2f4f7;border-radius:6px;color:#424347;font-weight:500;font-size:13px}.fa-approval-operate-list .approval-operate--label:hover{color:#388fff;border-color:#388fff}.fa-approval-operate-list .approval-operate--label .label-title{line-height:20px;white-space:nowrap}.fa-approval-operate-list .approval-operate--label .label-tip{position:absolute;display:none;right:0;bottom:0;width:14px;height:14px;border:7px solid #dadada;border-top:7px solid transparent;border-left:7px solid transparent}.fa-approval-operate-list .approval-operate--label .label-icon{position:absolute;display:none;right:-3px;bottom:-2px;font-size:12px;color:#fff}.fa-approval-operate-list .approval-operate--label .label-icon::before{content:\"\\e118\"}.fa-approval-operate-list .approval-operate--radio{display:none}.fa-approval-operate-list .approval-operate--radio:checked~.approval-operate--label{padding:3px 19px;font-size:14px;background:rgba(23,145,255,.05);box-shadow:0 4px 10px 0 rgba(69,144,255,.3);border-radius:6px;border:1px solid #388fff;color:#388fff}.fa-approval-operate-list .approval-operate--radio:checked~.approval-operate--label .label-tip{display:block;border-right-color:#388fff;border-bottom-color:#388fff}.fa-approval-operate-list .approval-operate--radio:checked~.approval-operate--label .label-icon{display:block}.fa-btn-like-dropdown{display:flex;align-items:center}.fa-btn-like-dropdown .like-dropdown--text{margin:0 4px 0 0}.fa-btn-like-dropdown .like-dropdown--icon{color:rgba(0,0,0,.25)}.fa-approve-common-gutter{margin-bottom:20px}.fa-approve-comment .approve-comment--title{display:inline-block;color:#667580;border-radius:4px 4px 0 0;height:26px;padding:0 9px;position:relative;background:#f7f7f7;cursor:pointer}.fa-approve-comment .approve-comment--title:after{content:\"\";height:100%;position:absolute;right:-10px;top:0;bottom:0;border-right:5px solid transparent;border-left:5px solid #f7f7f7;border-bottom:13px solid #f7f7f7;border-top:13px solid transparent}.fa-approve-comment .approve-comment--title:hover{background:rgba(23,145,255,.05);color:#1791ff}.fa-approve-comment .approve-comment--title:hover:after{border-bottom-color:rgba(23,145,255,.05);border-left-color:rgba(23,145,255,.05)}.fa-approve-comment .approve-comment--title .fa-btn-like-dropdown{font-size:12px;padding:5px 0}.fa-approve-comment .fa-approve-comment--content .content-textarea{border-color:#dcdcdc;border-radius:0 0 2px 2px;height:140px}.fa-approve-comment .fa-approve-comment--footer{font-size:13px;color:#667580;background:#f7f7f7;padding:10px 0}.fa-approve-comment .approve-comment--text-btns{display:flex;flex-direction:row}.fa-approve-comment .approve-comment--text-btns .text-btns-item{display:flex;flex-direction:row;align-items:center;font-size:12px;line-height:18px;color:#667580;padding:4px;margin-right:8px;cursor:pointer}.fa-approve-comment .approve-comment--text-btns .text-btns-item:hover{color:#388fff}.fa-approve-comment .approve-comment--text-btns .text-btns-item .f-icon{margin-right:6px}.fa-approveal-links::after{content:\".\";display:block;height:0;clear:both;visibility:hidden}.fa-approveal-links .approveal-links--link{font-size:14px;position:relative;padding:0 16px 0 0;display:flex;align-items:center;float:left}.fa-approveal-links .approveal-links--link .link-text{color:rgba(0,0,0,.65);margin:0 8px 0 0}.fa-approveal-links .approveal-links--link+.approveal-links--link{padding-left:16px}.fa-approveal-links .approveal-links--link+.approveal-links--link::before{content:\"\";position:absolute;width:1px;height:80%;left:0;top:10%;background:#dbdbdb}.fa-btn-group-lg .btn{width:180px;height:32px;box-shadow:0 4px 10px 0 rgba(69,144,255,.25);border-radius:6px;min-width:100px;text-align:center;font-size:13px}.fa-approve-record{padding:0 0 16px;position:relative}.fa-approve-record .fa-approve-record--timeline{position:absolute;width:34px;top:0;bottom:0;z-index:100}.fa-approve-record .fa-approve-record--timeline::after{content:\"\";position:absolute;width:1px;height:100%;overflow:hidden;left:50%;top:0;z-index:101;border-left:1px dashed #dcdcdc}.fa-approve-record .fa-approve-record--timeline .fa-approve-star{position:relative;z-index:103;margin:20px auto}.fa-approve-record.fa-state-running .fa-approve-record--timeline::after{top:20px}.fa-approve-record:last-child .fa-approve-record--timeline::after{height:20px}.fa-approve-record .fa-approve-record--content{margin:0 0 0 34px;padding:16px 14px;background:#f9f9f9;border-radius:2px}.fa-approve-record .fa-approve-record--content .approve-record--header{margin:0 0 12px;display:flex;align-items:center}.fa-approve-record .fa-approve-record--content .approve-record--header .header--title{margin-bottom:0;color:rgba(0,0,0,.85)}.fa-approve-record .fa-approve-record--content .approve-record--header>*{margin:0 19px 0 0}.fa-approve-record .approve-record--list-item{display:flex;flex-direction:row}.fa-approve-record .approve-record--list-item+.approve-record--list-item{padding-top:8px}.fa-approve-record .approve-record--list-item .list-item--auxiliary{width:30px;margin:0 10px 0 0}.fa-approve-record .approve-record--list-item .list-item--main{flex-grow:1;flex-shrink:1;flex-basis:auto;padding:6px 0 0;background:#f9f9f9}.fa-approve-record .approve-record--list-item .list-item--content{padding:20px 0 0}.fa-approve-record .approve-record--list-item .list-item--content .list-item--info{font-size:12px;margin-bottom:0}.fa-approve-record .approve-record--list-item .list-item--content .list-item--info .info-label{color:rgba(0,0,0,.65)}.fa-approve-record .approve-record--list-item .list-item--content .list-item--info .info-text{color:rgba(0,0,0,.85)}.fa-approve-record .approve-record--list-item .list-item--header{display:flex;align-items:center}.fa-approve-record .approve-record--list-item .list-item--header>*{margin:0 16px 0 0}.fa-approve-record .approve-record--list-item .list-item--header .list-item--info{margin-bottom:0;font-size:12px}.fa-approve-record .approve-record--list-item .list-item--header .list-item--info .info-label{color:rgba(0,0,0,.35)}.fa-approve-record .approve-record--list-item .list-item--header .list-item--info .info-text{color:rgba(0,0,0,.65)}.fa-approve-record .approve-record--list-item .list-item--name{color:#4297fa}.fa-approve-record .approve-record--avatar{width:30px;height:30px;border-radius:15px}.fa-approve-round-bg{margin:4px auto 0;width:30px;height:30px;background:#59a1ff;border-radius:18px;line-height:30px;text-align:center;white-space:nowrap;font-size:12px;overflow:hidden}.fa-approve-round-bg-text{color:#fff}.fa-approve-star{width:14px;height:14px;display:block;background:rgba(56,143,255,.4);border-radius:7px;position:relative}.fa-approve-star::after{content:\"\";width:8px;height:8px;position:absolute;top:50%;left:50%;margin:-4px 0 0 -4px;border-radius:4px;background:#388fff}.fa-approve-star.bg-warning{background:rgba(245,156,36,.4)!important}.fa-approve-star.bg-warning::after{background:#f59c24}.fa-approve-badge{padding-top:4px;padding-bottom:4px;border-radius:10px}.fa-approve-badge-light{font-size:13px;line-height:20px;padding:0 8px;color:#5f637a;border:1px solid #e6e6e6;background:#f6faff}.fa-approve-link-border{cursor:pointer;display:inline-block;border:1px solid #60a5ff;border-radius:13px;font-size:12px;line-height:16px;color:#388fff;padding:3px 10px;background:#ebf5ff}.fa-approve-link-border:hover{background:#2881ff;color:#fff}"]
                }] }
    ];
    /** @nocollapse */
    TaskActionImplComponent.ctorParameters = function () { return [
        { type: Injector },
        { type: ComponentFactoryResolver },
        { type: LoadingService },
        { type: MessagerService },
        { type: TaskActionImplService }
    ]; };
    TaskActionImplComponent.propDecorators = {
        container: [{ type: ViewChild, args: ['container', { read: ViewContainerRef },] }],
        actions: [{ type: Input }],
        submitName: [{ type: Input }],
        showButtons: [{ type: Input }],
        batch: [{ type: Input }],
        task: [{ type: Input }],
        iframe: [{ type: Input }],
        origin: [{ type: Input }],
        submited: [{ type: Output }],
        actionCode: [{ type: Output }]
    };
    return TaskActionImplComponent;
}());
export { TaskActionImplComponent };
if (false) {
    /** @type {?} */
    TaskActionImplComponent.prototype.container;
    /** @type {?} */
    TaskActionImplComponent.prototype.actions;
    /** @type {?} */
    TaskActionImplComponent.prototype.submitName;
    /** @type {?} */
    TaskActionImplComponent.prototype.showButtons;
    /** @type {?} */
    TaskActionImplComponent.prototype.batch;
    /** @type {?} */
    TaskActionImplComponent.prototype.task;
    /** @type {?} */
    TaskActionImplComponent.prototype._iframe;
    /** @type {?} */
    TaskActionImplComponent.prototype.origin;
    /** @type {?} */
    TaskActionImplComponent.prototype.submited;
    /** @type {?} */
    TaskActionImplComponent.prototype.actionCode;
    /** @type {?} */
    TaskActionImplComponent.prototype.selectAction;
    /** @type {?} */
    TaskActionImplComponent.prototype.actionCodeMap;
    /** @type {?} */
    TaskActionImplComponent.prototype.componentRef;
    /** @type {?} */
    TaskActionImplComponent.prototype.index;
    /** @type {?} */
    TaskActionImplComponent.prototype.submitDisable;
    /** @type {?} */
    TaskActionImplComponent.prototype.ifFocused;
    /** @type {?} */
    TaskActionImplComponent.prototype.focus;
    /** @type {?} */
    TaskActionImplComponent.prototype.ifShowFocus;
    /** @type {?} */
    TaskActionImplComponent.prototype.dialogHeight;
    /** @type {?} */
    TaskActionImplComponent.prototype.dialogWidth;
    /** @type {?} */
    TaskActionImplComponent.prototype.ngZone;
    /**
     * @type {?}
     * @private
     */
    TaskActionImplComponent.prototype.injector;
    /**
     * @type {?}
     * @private
     */
    TaskActionImplComponent.prototype.cfr;
    /**
     * @type {?}
     * @private
     */
    TaskActionImplComponent.prototype.loadingService;
    /**
     * @type {?}
     * @private
     */
    TaskActionImplComponent.prototype.msgService;
    /**
     * @type {?}
     * @private
     */
    TaskActionImplComponent.prototype.taskService;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidGFzay1hY3Rpb24taW1wbC5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZ3NwLXdmL3Rhc2stYWN0aW9uLWltcGwvIiwic291cmNlcyI6WyJsaWIvdGFzay1hY3Rpb24taW1wbC90YXNrLWFjdGlvbi1pbXBsLmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7OztBQUFBLE9BQU8sRUFBRSxTQUFTLEVBQVUsU0FBUyxFQUFFLGdCQUFnQixFQUFFLFFBQVEsRUFBRSx3QkFBd0IsRUFBa0MsS0FBSyxFQUFFLE1BQU0sRUFBRSxZQUFZLEVBQUUsVUFBVSxFQUFFLE1BQU0sRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUNwTSxPQUFPLEVBQUUsb0JBQW9CLEVBQUUsTUFBTSx5QkFBeUIsQ0FBQztBQUMvRCxPQUFPLEVBQWMsVUFBVSxFQUFzRCxNQUFNLHVCQUF1QixDQUFDO0FBQ25ILE9BQU8sRUFBYyxPQUFPLEVBQUUsTUFBTSxNQUFNLENBQUM7QUFDM0MsT0FBTyxFQUFFLGNBQWMsRUFBRSxNQUFNLG9CQUFvQixDQUFDO0FBQ3BELE9BQU8sRUFBRSxlQUFlLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQztBQUN0RCxPQUFPLEVBQUUsWUFBWSxFQUFFLE1BQU0sdUJBQXVCLENBQUM7QUFDckQsT0FBTyxFQUFFLHFCQUFxQixFQUFFLE1BQU0sNkJBQTZCLENBQUM7QUFJcEU7SUE2Q0UscUNBQXFDO0lBQ3JDLGlDQUNVLFFBQWtCLEVBQ2xCLEdBQTZCLEVBQzdCLGNBQThCLEVBQzlCLFVBQTJCLEVBQzNCLFdBQWtDO1FBSmxDLGFBQVEsR0FBUixRQUFRLENBQVU7UUFDbEIsUUFBRyxHQUFILEdBQUcsQ0FBMEI7UUFDN0IsbUJBQWMsR0FBZCxjQUFjLENBQWdCO1FBQzlCLGVBQVUsR0FBVixVQUFVLENBQWlCO1FBQzNCLGdCQUFXLEdBQVgsV0FBVyxDQUF1QjtRQXpDbkMsZ0JBQVcsR0FBRyxJQUFJLENBQUMsQ0FBQywyQkFBMkI7O1FBQy9DLFVB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dCI6WyJpbXBvcnQgeyBDb21wb25lbnQsIE9uSW5pdCwgVmlld0NoaWxkLCBWaWV3Q29udGFpbmVyUmVmLCBJbmplY3RvciwgQ29tcG9uZW50RmFjdG9yeVJlc29sdmVyLCBDb21wb25lbnRSZWYsIENvbXBvbmVudEZhY3RvcnksIElucHV0LCBPdXRwdXQsIEV2ZW50RW1pdHRlciwgRWxlbWVudFJlZiwgTmdab25lIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IFRhc2tFeGVjdXRlQ29tcG9uZW50IH0gZnJvbSAnQGdzcC13Zi93Zi10YXNrLWhhbmRsZXInO1xyXG5pbXBvcnQgeyBUYXNrQWN0aW9uLCBUYXNrRW50aXR5LCBBY3Rpb25CYXNlSW1wbENvbXBvbmVudCwgU3VibWl0UmVzdWx0LCBBY3Rpb25FdmVudCB9IGZyb20gJ0Bnc3Atd2YvdGFzay1pbXBsLWFwaSc7XHJcbmltcG9ydCB7IE9ic2VydmFibGUsIFN1YmplY3QgfSBmcm9tICdyeGpzJztcclxuaW1wb3J0IHsgTG9hZGluZ1NlcnZpY2UgfSBmcm9tICdAZmFycmlzL3VpLWxvYWRpbmcnO1xyXG5pbXBvcnQgeyBNZXNzYWdlclNlcnZpY2UgfSBmcm9tICdAZmFycmlzL3VpLW1lc3NhZ2VyJztcclxuaW1wb3J0IHsgQWN0aW9uT3JpZ2luIH0gZnJvbSAnQGdzcC13Zi90YXNrLWltcGwtYXBpJztcclxuaW1wb3J0IHsgVGFza0FjdGlvbkltcGxTZXJ2aWNlIH0gZnJvbSAnLi4vdGFzay1hY3Rpb24taW1wbC5zZXJ2aWNlJztcclxuXHJcbmRlY2xhcmUgdmFyIFN5c3RlbTogYW55O1xyXG5cclxuQENvbXBvbmVudCh7XHJcbiAgc2VsZWN0b3I6ICd0YXNrLWFjdGlvbi1pbXBsJyxcclxuICB0ZW1wbGF0ZVVybDogJy4vdGFzay1hY3Rpb24taW1wbC5jb21wb25lbnQuaHRtbCcsXHJcbiAgc3R5bGVVcmxzOiBbJy4vdGFzay1hY3Rpb24taW1wbC5jb21wb25lbnQuc2NzcyddLFxyXG59KVxyXG5leHBvcnQgY2xhc3MgVGFza0FjdGlvbkltcGxDb21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQge1xyXG5cclxuICBAVmlld0NoaWxkKCdjb250YWluZXInLCB7IHJlYWQ6IFZpZXdDb250YWluZXJSZWYgfSkgY29udGFpbmVyOiBWaWV3Q29udGFpbmVyUmVmO1xyXG4gIEBJbnB1dCgpIGFjdGlvbnM6IFRhc2tBY3Rpb25bXTtcclxuICBASW5wdXQoKSBzdWJtaXROYW1lOiBzdHJpbmc7XHJcbiAgQElucHV0KCkgc2hvd0J1dHRvbnMgPSB0cnVlOyAvL+aYr+WQpuWxleekuuaPkOS6pOaMiemSruOAguS7u+WKoeWKnueQhueVjOmdouWxleekuu+8jOS7u+WKoeWIl+ihqOS4jeWxleekulxyXG4gIEBJbnB1dCgpIGJhdGNoID0gZmFsc2U7XHJcbiAgQElucHV0KCkgdGFzazogVGFza0VudGl0eTtcclxuXHJcbiAgX2lmcmFtZTogRWxlbWVudFJlZjxIVE1MSUZyYW1lRWxlbWVudD47XHJcbiAgQElucHV0KClcclxuICBzZXQgaWZyYW1lKGlmcmFtZTogRWxlbWVudFJlZjxIVE1MSUZyYW1lRWxlbWVudD4pIHtcclxuICAgIHRoaXMuX2lmcmFtZSA9IGlmcmFtZTtcclxuICAgIGlmICh0aGlzLmlmcmFtZSAmJiB0aGlzLmNvbXBvbmVudFJlZikge1xyXG4gICAgICB0aGlzLmNvbXBvbmVudFJlZi5pbnN0YW5jZS5pZnJhbWUgPSB0aGlzLmlmcmFtZTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGdldCBpZnJhbWUoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5faWZyYW1lO1xyXG4gIH1cclxuICBASW5wdXQoKSBvcmlnaW46IHN0cmluZzsgLy8g5p2l5rqQ77yM5LuO5ZOq5omT5byA55qEXHJcblxyXG4gIEBPdXRwdXQoKSBzdWJtaXRlZCA9IG5ldyBFdmVudEVtaXR0ZXI8U3VibWl0UmVzdWx0PigpO1xyXG4gIEBPdXRwdXQoKSBhY3Rpb25Db2RlID0gbmV3IEV2ZW50RW1pdHRlcjxhbnk+KCk7XHJcblxyXG4gIHNlbGVjdEFjdGlvbjogVGFza0FjdGlvbjtcclxuICBhY3Rpb25Db2RlTWFwID0gbmV3IE1hcCgpO1xyXG4gIGNvbXBvbmVudFJlZjogQ29tcG9uZW50UmVmPEFjdGlvbkJhc2VJbXBsQ29tcG9uZW50PjtcclxuXHJcbiAgaW5kZXggPSAwO1xyXG4gIHN1Ym1pdERpc2FibGU6IGJvb2xlYW4gPSBmYWxzZTsgLy8g5o+Q5Lqk5oyJ6ZKu5piv5ZCm56aB55SoXHJcbiAgaWZGb2N1c2VkOiBib29sZWFuID0gZmFsc2U7IC8vIOaYr+WQpuWFs+azqOS6huatpOS7u+WKoVxyXG4gIGZvY3VzOiBzdHJpbmcgPSB0aGlzLmkxOG5TZXJ2aWNlKFwiZm9jdXNcIik7Ly/lhbPms6jmraTmtYHnqItcclxuICBpZlNob3dGb2N1czogYm9vbGVhbiA9IHRydWU7IC8vIOaYr+WQpuWQr+eUqOaIkeeahOWFs+azqOWKn+iDvVxyXG4gIGRpYWxvZ0hlaWdodDogbnVtYmVyOyAvLyDku7vliqHliJfooajkuIrlvLnmoYbnmoTpq5jluqZcclxuICBkaWFsb2dXaWR0aDogbnVtYmVyOyAvLyDku7vliqHliJfooajkuIrlvLnmoYbnmoTlrr3luqZcclxuXHJcbiAgbmdab25lOiBOZ1pvbmU7XHJcblxyXG4gIC8vIOazqOaEj++8muS/ruaUueaehOmAoOaWueazlemcgOimgemHjeaWsOaJk+WMhXRhc2stbWFpbuWSjHRhc2sgZm9ybVxyXG4gIGNvbnN0cnVjdG9yKFxyXG4gICAgcHJpdmF0ZSBpbmplY3RvcjogSW5qZWN0b3IsXHJcbiAgICBwcml2YXRlIGNmcjogQ29tcG9uZW50RmFjdG9yeVJlc29sdmVyLFxyXG4gICAgcHJpdmF0ZSBsb2FkaW5nU2VydmljZTogTG9hZGluZ1NlcnZpY2UsXHJcbiAgICBwcml2YXRlIG1zZ1NlcnZpY2U6IE1lc3NhZ2VyU2VydmljZSxcclxuICAgIHByaXZhdGUgdGFza1NlcnZpY2U6IFRhc2tBY3Rpb25JbXBsU2VydmljZVxyXG4gICkge1xyXG4gICAgdGhpcy5uZ1pvbmUgPSB0aGlzLmluamVjdG9yLmdldChOZ1pvbmUpO1xyXG4gIH1cclxuXHJcbiAgbmdPbkluaXQoKSB7XHJcbiAgICAvL+ihqOWNleinpuWPkemihOino+aekO+8jOmHjeaWsOWKoOi9vee7hOS7tlxyXG4gICAgKHdpbmRvdyBhcyBhbnkpLmdzcFdmRXZlbnRTZXJ2aWNlID0gKHdpbmRvdyBhcyBhbnkpLmdzcFdmRXZlbnRTZXJ2aWNlIHx8IHt9O1xyXG4gICAgKHdpbmRvdyBhcyBhbnkpLmdzcFdmRXZlbnRTZXJ2aWNlLnNpbXVsYXRlID0gKGZ1bmM6IEZ1bmN0aW9uKSA9PiB7XHJcbiAgICAgIHRoaXMubmdab25lLnJ1bigoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5hY3Rpb25TZWxlY3QodGhpcy5hY3Rpb25zWzBdLCAwKS5zdWJzY3JpYmUoKCkgPT4gZnVuYyAmJiB0eXBlb2YgZnVuYyA9PT0gJ2Z1bmN0aW9uJyAmJiBmdW5jKCkpO1xyXG4gICAgICB9KVxyXG4gICAgfTtcclxuICAgIC8vIOaYr+WQpuWQr+eUqOaIkeeahOWFs+azqOWKn+iDvVxyXG4gICAgY29uc3QgbG9hZCA9IHRoaXMubG9hZGluZ1NlcnZpY2Uuc2hvdygpO1xyXG4gICAgdGhpcy50YXNrU2VydmljZS5nZXRUYXNrQ2VudGVyQ29uZmlnQnlDb2RlKFwiSWZfU2hvd19NeV9Gb2N1c1wiLCAnYWxsJywgJyonKS5zdWJzY3JpYmUocmUgPT4ge1xyXG4gICAgICBsb2FkLmNsb3NlKCk7XHJcbiAgICAgIHJlICYmIHJlLmN1cnJlbnRWYWx1ZSA9PT0gJ2ZhbHNlJyAmJiAodGhpcy5pZlNob3dGb2N1cyA9IGZhbHNlKTtcclxuICAgICAgLy8g5piv5ZCm5YWz5rOo5LqG6K+l5Lu75YqhKOS7juivpuaDheaJk+W8gClcclxuICAgICAgaWYgKHRoaXMuaWZTaG93Rm9jdXMgJiYgdGhpcy50YXNrICYmIHRoaXMuc2hvd0J1dHRvbnMpIHtcclxuICAgICAgICBjb25zdCBsb2FkID0gdGhpcy5sb2FkaW5nU2VydmljZS5zaG93KCk7XHJcbiAgICAgICAgdGhpcy50YXNrU2VydmljZS5pZkZvY3VzZWQodGhpcy50YXNrLnByb2Nlc3NJbnN0YW5jZUlkKS5zdWJzY3JpYmUocmUgPT4ge1xyXG4gICAgICAgICAgbG9hZC5jbG9zZSgpO1xyXG4gICAgICAgICAgdGhpcy5pZkZvY3VzZWQgPSByZSAmJiByZS5sZW5ndGggPyB0cnVlIDogZmFsc2U7XHJcbiAgICAgICAgfSwgKCkgPT4ge1xyXG4gICAgICAgICAgbG9hZC5jbG9zZSgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcbiAgICB9LCAoKSA9PiB7XHJcbiAgICAgIGxvYWQuY2xvc2UoKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog6YCJ5Lit5Yqo5L2c5oyJ6ZKuXHJcbiAgICogQHBhcmFtIGFjdGlvbiBcclxuICAgKiBAcGFyYW0gaW5kZXggXHJcbiAgICogQHJldHVybnMgXHJcbiAgICovXHJcbiAgYWN0aW9uU2VsZWN0KGFjdGlvbjogVGFza0FjdGlvbiwgaW5kZXg/OiBudW1iZXIpOiBPYnNlcnZhYmxlPGFueT4ge1xyXG4gICAgbGV0IHN1YmplY3QgPSBuZXcgU3ViamVjdCgpO1xyXG4gICAgdGhpcy5zZWxlY3RBY3Rpb24gPSBhY3Rpb247XHJcbiAgICBpZiAoaW5kZXgpIHtcclxuICAgICAgdGhpcy5pbmRleCA9IGluZGV4O1xyXG4gICAgfVxyXG4gICAgbGV0IGNtcEZhY3Rvcnk6IENvbXBvbmVudEZhY3Rvcnk8QWN0aW9uQmFzZUltcGxDb21wb25lbnQ+O1xyXG4gICAgaWYgKGFjdGlvbi50eXBlSWQgPT09ICd3ZicpIHtcclxuICAgICAgY21wRmFjdG9yeSA9IHRoaXMuY2ZyLnJlc29sdmVDb21wb25lbnRGYWN0b3J5KFRhc2tFeGVjdXRlQ29tcG9uZW50KTtcclxuICAgICAgdGhpcy5sb2FkQ29tcG9uZW50RmFjdG9yeShjbXBGYWN0b3J5KTtcclxuICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgc3ViamVjdC5uZXh0KHsgcmVzdWx0OiB0cnVlIH0pO1xyXG4gICAgICB9LCAxMDApO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgU3lzdGVtLmltcG9ydChhY3Rpb24uaW1wbCArICc/dj0nICsgbmV3IERhdGUoKS5nZXRUaW1lKCkudG9TdHJpbmcoKSkudGhlbigobW9kdWxlRmFjdG9yaWVzOiBhbnkpID0+IHtcclxuICAgICAgICBjb25zdCBtb2R1bGVGYWN0b3J5OiBhbnkgPSBPYmplY3QudmFsdWVzKG1vZHVsZUZhY3RvcmllcylbMF07XHJcbiAgICAgICAgY29uc3QgbW9kdWxlUmVmID0gbW9kdWxlRmFjdG9yeS5jcmVhdGUodGhpcy5pbmplY3Rvcik7XHJcbiAgICAgICAgY21wRmFjdG9yeSA9IG1vZHVsZVJlZi5pbnN0YW5jZS5nZXRBY3Rpb25Db21wb25lbnRGYWN0b3J5KGFjdGlvbik7XHJcbiAgICAgICAgdGhpcy5sb2FkQ29tcG9uZW50RmFjdG9yeShjbXBGYWN0b3J5KTtcclxuICAgICAgICBzdWJqZWN0Lm5leHQoeyByZXN1bHQ6IHRydWUgfSk7XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHN1YmplY3QuYXNPYnNlcnZhYmxlKCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDliqjmgIHliqDovb3lrqHmibnnu4Tku7ZcclxuICAgKiBAcGFyYW0gY21wRmFjdG9yeSBcclxuICAgKi9cclxuICBwcml2YXRlIGxvYWRDb21wb25lbnRGYWN0b3J5KGNtcEZhY3Rvcnk6IENvbXBvbmVudEZhY3Rvcnk8QWN0aW9uQmFzZUltcGxDb21wb25lbnQ+KSB7XHJcbiAgICBsZXQgY29tbWVudDtcclxuICAgIGlmICh0aGlzLmNvbXBvbmVudFJlZiAmJiB0aGlzLmNvbXBvbmVudFJlZi5pbnN0YW5jZSkge1xyXG4gICAgICBjb21tZW50ID0gKHRoaXMuY29tcG9uZW50UmVmLmluc3RhbmNlIGFzIGFueSkuY29tbWVudDtcclxuICAgIH1cclxuICAgIHRoaXMuY29udGFpbmVyLmNsZWFyKCk7XHJcbiAgICB0aGlzLmNvbXBvbmVudFJlZiA9IHRoaXMuY29udGFpbmVyLmNyZWF0ZUNvbXBvbmVudChjbXBGYWN0b3J5LCAwLCB0aGlzLmluamVjdG9yKTtcclxuICAgIHRoaXMuY29tcG9uZW50UmVmLmluc3RhbmNlLm9yaWdpbiA9IHRoaXMuc2hvd0J1dHRvbnMgPyBBY3Rpb25PcmlnaW4uVGFza0Zvcm0gOiBBY3Rpb25PcmlnaW4uVGFza0NlbnRlcjtcclxuICAgIGlmICh0aGlzLnRhc2sgJiYgdGhpcy5jb21wb25lbnRSZWYuaW5zdGFuY2Uuc2V0VGFzaykge1xyXG4gICAgICB0aGlzLmNvbXBvbmVudFJlZi5pbnN0YW5jZS5zZXRUYXNrKHRoaXMudGFzayk7XHJcbiAgICB9XHJcbiAgICBpZiAodGhpcy5jb21wb25lbnRSZWYuaW5zdGFuY2Uuc2V0QWN0aW9uKSB7XHJcbiAgICAgIHRoaXMuY29tcG9uZW50UmVmLmluc3RhbmNlLnNldEFjdGlvbih0aGlzLnNlbGVjdEFjdGlvbik7XHJcbiAgICB9XHJcbiAgICBpZiAodGhpcy5jb21wb25lbnRSZWYuaW5zdGFuY2UuZGlhbG9nSGVpZ2h0KSB7XHJcbiAgICAgIHRoaXMuZGlhbG9nSGVpZ2h0ID0gdGhpcy5jb21wb25lbnRSZWYuaW5zdGFuY2UuZGlhbG9nSGVpZ2h0O1xyXG4gICAgfVxyXG4gICAgaWYgKHRoaXMuY29tcG9uZW50UmVmLmluc3RhbmNlLmRpYWxvZ1dpZHRoKSB7XHJcbiAgICAgIHRoaXMuZGlhbG9nV2lkdGggPSB0aGlzLmNvbXBvbmVudFJlZi5pbnN0YW5jZS5kaWFsb2dXaWR0aDtcclxuICAgIH1cclxuICAgIC8vIOaaguWtmHdm55qE5a6h5om55oSP6KeBXHJcbiAgICAodGhpcy5jb21wb25lbnRSZWYuaW5zdGFuY2UgYXMgYW55KS53ZkNhY2hlQ29tbWVudCA9IGNvbW1lbnQ7XHJcbiAgICB0aGlzLmNvbnRhaW5lci5pbnNlcnQodGhpcy5jb21wb25lbnRSZWYuaG9zdFZpZXcpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog54K55Ye75o+Q5LqkXHJcbiAgICovXHJcbiAgc3VibWl0KCkge1xyXG4gICAgLy/ooajljZXliY3kuovku7ZcclxuICAgIGlmICh0aGlzLnNob3dCdXR0b25zICYmIHdpbmRvd1sndGFza0NlbnRlckJlZm9yZUxvYWQnXSkge1xyXG4gICAgICB0aGlzLnN1Ym1pdERpc2FibGUgPSB0cnVlO1xyXG4gICAgICBjb25zdCBjb250ZXh0ID0ge1xyXG4gICAgICAgIHRhc2s6IHRoaXMudGFzayxcclxuICAgICAgICBhY3Rpb246IHRoaXMuc2VsZWN0QWN0aW9uXHJcbiAgICAgIH1cclxuICAgICAgd2luZG93Wyd0YXNrQ2VudGVyQmVmb3JlTG9hZCddKGNvbnRleHQpLnRoZW4ocmUgPT4ge1xyXG4gICAgICAgIHRoaXMuc3VibWl0RGlzYWJsZSA9IGZhbHNlO1xyXG4gICAgICAgIGlmIChyZSAmJiByZS5yZXN1bHQgPT0gdHJ1ZSkge1xyXG4gICAgICAgICAgdGhpcy5zaG93Q29uZmlybURpYWxvZygpO1xyXG4gICAgICAgIH1cclxuICAgICAgfSwgZXJyb3IgPT4ge1xyXG4gICAgICAgIHRoaXMuc3VibWl0RGlzYWJsZSA9IGZhbHNlO1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xyXG4gICAgICB9KVxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5zaG93Q29uZmlybURpYWxvZygpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog5piv5ZCm5o+Q5Lqk5YmN56Gu6K6kXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBzaG93Q29uZmlybURpYWxvZygpIHtcclxuICAgIHRoaXMudGFza1NlcnZpY2UuZ2V0VGFza0NlbnRlckNvbmZpZ0J5Q29kZSgnSXNfQ29uZmlybV9Db21taXQnKS5zdWJzY3JpYmUoKGNvbmZpZzogYW55KSA9PiB7XHJcbiAgICAgIGlmIChjb25maWcuY3VycmVudFZhbHVlID09PSAndHJ1ZScpIHtcclxuICAgICAgICB0aGlzLm1zZ1NlcnZpY2UucXVlc3Rpb24odGhpcy5pMThuU2VydmljZShcImNvbmZpcm1cIikgKyB0aGlzLnNlbGVjdEFjdGlvbi5uYW1lICsgJ++8nycsICgpID0+IHtcclxuICAgICAgICAgIHRoaXMuZXhlY3V0ZVN1Ym1pdCgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHRoaXMuZXhlY3V0ZVN1Ym1pdCgpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgZXhlY3V0ZVN1Ym1pdCgpIHtcclxuICAgIHRoaXMuc3VibWl0RGlzYWJsZSA9IHRydWU7XHJcbiAgICBpZiAodGhpcy5zZWxlY3RBY3Rpb24ucHJlRXZlbnRzICYmIHRoaXMuc2VsZWN0QWN0aW9uLnByZUV2ZW50cy5sZW5ndGggPiAwXHJcbiAgICAgICYmIHRoaXMuc2VsZWN0QWN0aW9uLnByZUV2ZW50cy5maWx0ZXIoZSA9PiAhZS5iYXRjaCkubGVuZ3RoID4gMCkge1xyXG4gICAgICBsZXQgdGFza0NvbW1lbnQ6IHN0cmluZztcclxuICAgICAgY29uc3QgYWN0aW9uID0gdGhpcy5zZWxlY3RBY3Rpb24gYXMgVGFza0FjdGlvbjtcclxuICAgICAgaWYgKGFjdGlvbi50eXBlSWQgPT09ICd3ZicpIHtcclxuICAgICAgICAvLyDlj5bmhI/op4HmoYbph4znmoTmhI/op4HlrZjmlL7lnKh0YXNrQ29tbWVudOmHjFxyXG4gICAgICAgIHRhc2tDb21tZW50ID0gKHRoaXMuY29tcG9uZW50UmVmLmluc3RhbmNlIGFzIGFueSkuY29tbWVudDtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgfVxyXG4gICAgICB0aGlzLmV4ZWN1dGVFdmVudHMoWy4uLnRoaXMuc2VsZWN0QWN0aW9uLnByZUV2ZW50cy5maWx0ZXIoZSA9PiAhZS5iYXRjaCldLCAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5jb25maXJtU3VibWl0KHRhc2tDb21tZW50KTtcclxuICAgICAgfSwgdGFza0NvbW1lbnQpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5jb25maXJtU3VibWl0KCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGNvbmZpcm1TdWJtaXQodGFza0NvbW1lbnQ/OiBzdHJpbmcpIHtcclxuICAgIGNvbnN0IGxvYWQgPSB0aGlzLmxvYWRpbmdTZXJ2aWNlLnNob3coKTtcclxuICAgIHRoaXMuaGFuZGxlU3VibWl0KCkuc3Vic2NyaWJlKChyZTogYW55KSA9PiB7XHJcbiAgICAgIGlmIChyZSkge1xyXG4gICAgICAgIGxvYWQuY2xvc2UoKTtcclxuICAgICAgICBpZiAocmUucmVzdWx0KSB7XHJcbiAgICAgICAgICBpZiAodGhpcy5zZWxlY3RBY3Rpb24gJiYgdGhpcy5zZWxlY3RBY3Rpb24ucG9zdEV2ZW50cy5sZW5ndGggPiAwXHJcbiAgICAgICAgICAgICYmIHRoaXMuc2VsZWN0QWN0aW9uLnBvc3RFdmVudHMuZmlsdGVyKGUgPT4gIWUuYmF0Y2gpLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgdGhpcy5leGVjdXRlRXZlbnRzKFsuLi50aGlzLnNlbGVjdEFjdGlvbi5wb3N0RXZlbnRzLmZpbHRlcihlID0+ICFlLmJhdGNoKV0sICgpID0+IHtcclxuICAgICAgICAgICAgICB0aGlzLnN1Ym1pdGVkLmVtaXQocmUpO1xyXG4gICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zdWJtaXREaXNhYmxlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgfSwgMjAwMCk7XHJcbiAgICAgICAgICAgIH0sIHRhc2tDb21tZW50KTtcclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuc3VibWl0ZWQuZW1pdChyZSk7XHJcbiAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgICAgIHRoaXMuc3VibWl0RGlzYWJsZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICB9LCAyMDAwKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgdGhpcy5zdWJtaXREaXNhYmxlID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIHRoaXMuYWN0aW9uQ29kZU1hcC5zZXQoJ2lzVHJhbnNmZXInLCB0aGlzLnNlbGVjdEFjdGlvbi5jb2RlID09PSAnVHJhbnNmZXInKTtcclxuICAgICAgdGhpcy5hY3Rpb25Db2RlTWFwLnNldCgnaXNBZGRTaWduRnJvbnQnLCB0aGlzLnNlbGVjdEFjdGlvbi5jb2RlID09PSAnQWRkU2lnbkZyb250Jyk7XHJcbiAgICAgIHRoaXMuYWN0aW9uQ29kZU1hcC5zZXQoJ2lzVW5DbGFpbScsIHRoaXMuc2VsZWN0QWN0aW9uLmNvZGUgPT09ICdVbmNsYWltJyk7XHJcbiAgICAgIHRoaXMuYWN0aW9uQ29kZU1hcC5zZXQoJ2lzQ29tbWVudCcsIHRoaXMuc2VsZWN0QWN0aW9uLmNvZGUgPT09ICdDb21tZW50Jyk7XHJcbiAgICAgIHRoaXMuYWN0aW9uQ29kZU1hcC5zZXQoJ2lzQ2xhaW0nLCB0aGlzLnNlbGVjdEFjdGlvbi5jb2RlID09PSAnQ2xhaW0nKTtcclxuICAgICAgdGhpcy5hY3Rpb25Db2RlLmVtaXQodGhpcy5hY3Rpb25Db2RlTWFwKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcblxyXG4gIGhhbmRsZVN1Ym1pdCgpOiBPYnNlcnZhYmxlPFN1Ym1pdFJlc3VsdD4ge1xyXG4gICAgcmV0dXJuIHRoaXMuY29tcG9uZW50UmVmLmluc3RhbmNlLnN1Ym1pdCgpO1xyXG4gIH1cclxuXHJcbiAgYmF0Y2hIYW5kbGVTdWJtaXQodGFza3M6IFRhc2tFbnRpdHlbXSkge1xyXG4gICAgcmV0dXJuIHRoaXMuY29tcG9uZW50UmVmLmluc3RhbmNlLmJhdGNoU3VibWl0KHRhc2tzKTtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgZXhlY3V0ZUV2ZW50cyhldmVudHM6IEFjdGlvbkV2ZW50W10sIGhhbmRsZXI6IGFueSwgdGFza0NvbW1lbnQ/OiBzdHJpbmcpIHtcclxuICAgIGlmIChldmVudHMgJiYgZXZlbnRzLmxlbmd0aCA+IDApIHtcclxuICAgICAgY29uc3QgZXZlbnQgPSBldmVudHMuc2hpZnQoKTtcclxuICAgICAgY29uc3QgdXJsID0gZXZlbnQuZXZlbnRJbXBsLnNwbGl0KCcjJylbMF07XHJcbiAgICAgIGNvbnN0IGZ1bmMgPSBldmVudC5ldmVudEltcGwuc3BsaXQoJyMnKVsxXTtcclxuICAgICAgU3lzdGVtLmltcG9ydCh1cmwgKyAnP3Y9JyArIG5ldyBEYXRlKCkuZ2V0VGltZSgpLnRvU3RyaW5nKCkpXHJcbiAgICAgICAgLnRoZW4oKG1vZHVsZUZhY3RvcmllczogYW55KSA9PiB7XHJcbiAgICAgICAgICBjb25zdCBtb2R1bGVGYWN0b3J5OiBhbnkgPSBPYmplY3QudmFsdWVzKG1vZHVsZUZhY3RvcmllcylbMF07XHJcbiAgICAgICAgICBjb25zdCBtb2R1bGVSZWYgPSBtb2R1bGVGYWN0b3J5LmNyZWF0ZSh0aGlzLmluamVjdG9yKTtcclxuICAgICAgICAgIGNvbnN0IGNvbnRleHQ6IGFueSA9IHtcclxuICAgICAgICAgICAgdGFzazogdGhpcy50YXNrLFxyXG4gICAgICAgICAgICBhY3Rpb246IHRoaXMuc2VsZWN0QWN0aW9uLFxyXG4gICAgICAgICAgICBvcmlnaW46ICdUYXNrRm9ybScsXHJcbiAgICAgICAgICAgIGZvcm1JZnJhbWU6IHRoaXMuaWZyYW1lLFxyXG4gICAgICAgICAgICBjb21tZW50OiB0YXNrQ29tbWVudCxcclxuICAgICAgICAgIH07XHJcbiAgICAgICAgICBtb2R1bGVSZWYuaW5zdGFuY2VbZnVuY10uYXBwbHkobW9kdWxlUmVmLmluc3RhbmNlLCBbY29udGV4dF0pLnN1YnNjcmliZSgocmU6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICAvLyDlhbzlrrnml6fnmoTluIPlsJTnsbvlnovlj4LmlbBcclxuICAgICAgICAgICAgaWYgKHR5cGVvZiByZSA9PT0gJ2Jvb2xlYW4nKSB7XHJcbiAgICAgICAgICAgICAgaWYgKHJlKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmV4ZWN1dGVFdmVudHMoZXZlbnRzLCBoYW5kbGVyLCB0YXNrQ29tbWVudCk7XHJcbiAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuc3VibWl0RGlzYWJsZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICBpZiAocmUucmVzdWx0KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAocmUuY29tbWVudCkge1xyXG4gICAgICAgICAgICAgICAgICB0YXNrQ29tbWVudCA9IHJlLmNvbW1lbnQ7XHJcbiAgICAgICAgICAgICAgICAgIC8vIOWPluWIsOeahOWJjeS6i+S7tuaEj+ingeWMheWQq+WcqHRhc2tDb21tZW506YeMXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0aGlzLmV4ZWN1dGVFdmVudHMoZXZlbnRzLCBoYW5kbGVyLCB0YXNrQ29tbWVudCk7XHJcbiAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuc3VibWl0RGlzYWJsZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAodGhpcy5jb21wb25lbnRSZWYuaW5zdGFuY2UgYXMgYW55KS5jb21tZW50ID0gdGFza0NvbW1lbnQ7XHJcbiAgICAgIGhhbmRsZXIoKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOeCueWHu+a3u+WKoC/lj5bmtojlhbPms6hcclxuICAgKi9cclxuICBmb2N1c1Rhc2soKSB7XHJcbiAgICBjb25zdCBsb2FkID0gdGhpcy5sb2FkaW5nU2VydmljZS5zaG93KCk7XHJcbiAgICBpZiAodGhpcy5pZkZvY3VzZWQpIHtcclxuICAgICAgdGhpcy50YXNrU2VydmljZS5hZGRGb2N1cyh0aGlzLnRhc2suc291cmNlSWQpLnN1YnNjcmliZSgoKSA9PiB7XHJcbiAgICAgICAgbG9hZC5jbG9zZSgpO1xyXG4gICAgICB9LCAoKSA9PiB7XHJcbiAgICAgICAgbG9hZC5jbG9zZSgpO1xyXG4gICAgICB9KTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMudGFza1NlcnZpY2UucmVtb3ZlRm9jdXModGhpcy50YXNrLnByb2Nlc3NJbnN0YW5jZUlkKS5zdWJzY3JpYmUoKCkgPT4ge1xyXG4gICAgICAgIGxvYWQuY2xvc2UoKTtcclxuICAgICAgfSwgKCkgPT4ge1xyXG4gICAgICAgIGxvYWQuY2xvc2UoKTtcclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDlm73pmYXljJZcclxuICAgKiBAcGFyYW0gY29kZSBcclxuICAgKiBAcmV0dXJucyBcclxuICAgKi9cclxuICBpMThuU2VydmljZShjb2RlOiBzdHJpbmcpIHtcclxuICAgIHZhciByZXN1bHQ7XHJcbiAgICBjb25zdCBzdXBwb3J0TGFuZ3VhZ2UgPSBbXCJ6aC1DSFNcIiwgXCJ6aC1DSFRcIiwgXCJlblwiXTtcclxuICAgIGNvbnN0IGN1ckxhbmd1YWdlID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oXCJsYW5ndWFnZUNvZGVcIik7XHJcbiAgICBjb25zdCB0cmFuc2xhdGUgPSB7XHJcbiAgICAgIFwiemgtQ0hTXCI6IHtcclxuICAgICAgICBmb2N1czogXCLlhbPms6jmraTmtYHnqItcIixcclxuICAgICAgICBmb2N1c2VkOiBcIuW3suWFs+azqOatpOa1geeoi1wiLFxyXG4gICAgICAgIGNvbmZpcm06IFwi56Gu6K6kXCJcclxuICAgICAgfSxcclxuICAgICAgXCJ6aC1DSFRcIjoge1xyXG4gICAgICAgIGZvY3VzOiBcIumXnOiou+atpOa1geeoi1wiLFxyXG4gICAgICAgIGZvY3VzZWQ6IFwi5bey6Zec6Ki75q2k5rWB56iLXCIsXHJcbiAgICAgICAgY29uZmlybTogXCLnorroqo1cIlxyXG4gICAgICB9LFxyXG4gICAgICBlbjoge1xyXG4gICAgICAgIGZvY3VzOiBcIkZvY3VzIHRoaXMgcHJvY2Vzc1wiLFxyXG4gICAgICAgIGZvY3VzZWQ6IFwiRm9jdXNlZCB0aGlzIHByb2Nlc3NcIixcclxuICAgICAgICBjb25maXJtOiBcIkNvbmZpcm1cIlxyXG4gICAgICB9LFxyXG4gICAgfTtcclxuICAgIGlmIChjdXJMYW5ndWFnZSAmJiBzdXBwb3J0TGFuZ3VhZ2UuaW5jbHVkZXMoY3VyTGFuZ3VhZ2UpKSB7XHJcbiAgICAgIHJlc3VsdCA9IHRyYW5zbGF0ZVtjdXJMYW5ndWFnZV1bY29kZV07XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICByZXN1bHQgPSB0cmFuc2xhdGVbXCJ6aC1DSFNcIl1bY29kZV07XHJcbiAgICB9XHJcbiAgICByZXR1cm4gcmVzdWx0O1xyXG4gIH1cclxuXHJcblxyXG5cclxufVxyXG4iXX0=