{"version":3,"file":"gsp-wf-wf-bizprocess-lookup.js.map","sources":["ng://@gsp-wf/wf-bizprocess-lookup/lib/wf-bizprocess-lookup.service.ts","ng://@gsp-wf/wf-bizprocess-lookup/lib/service/wf-bizprocess-lookup.uistate.ts","ng://@gsp-wf/wf-bizprocess-lookup/lib/service/wf-bizprocess-lookup.service.ts","ng://@gsp-wf/wf-bizprocess-lookup/lib/wf-bizprocess-lookup.component.ts","ng://@gsp-wf/wf-bizprocess-lookup/lib/wf-bizprocess-lookup.module.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class WfBizprocessLookupService {\r\n\r\n  constructor() { }\r\n}\r\n","import { Injectable } from '@angular/core';\r\n\r\n@Injectable()\r\nexport class WFBizProcessLookUpUIState {\r\n\r\n    rtProcessUri = '/api/runtime/wf/v1.0/procDefs/processDefinitionKeys/query';\r\n    flowFormUri = '/api/runtime/wf/v1.0/flowForm/query';\r\n    constructor(\r\n    ) {\r\n    }\r\n\r\n}\r\n","import { ILookupHttpService, RemoteParams, LookupGridResult } from '@farris/ui-lookup';\r\nimport { Injectable } from '@angular/core';\r\nimport { HttpService } from '@ecp-caf/caf-common';\r\nimport { Observable, of } from 'rxjs';\r\nimport { map } from 'rxjs/operators';\r\n\r\n@Injectable()\r\nexport class WFBizProcessLookUpService implements ILookupHttpService {\r\n    constructor(\r\n        private http: HttpService,\r\n    ) {\r\n    }\r\n    getData(url: string, params?: RemoteParams): Observable<LookupGridResult> {\r\n        const customData = params.customData;\r\n        const index = params.pageIndex || 1;\r\n        const size = params.pageSize || 20;\r\n        const searchValue = JSON.parse(params.searchValue);\r\n        if (searchValue.searchValue || customData.filter) {\r\n            let query = '?param=';\r\n            let filter = '{';\r\n            if (searchValue.searchValue) {\r\n                if (searchValue.searchField === '*') {\r\n                    filter += `\"allColumns\":\"${searchValue.searchValue}\",`;\r\n                } else {\r\n                    filter += `\"${searchValue.searchField}\":\"${searchValue.searchValue}\",`;\r\n                }\r\n            }\r\n            if (customData.filter) {\r\n                const keys = Object.keys(customData.filter);\r\n                if (keys && keys.length > 0) {\r\n                    for (const key of keys) {\r\n                        if (customData.filter[key]) {\r\n                            filter += `\"${key}\":\"${customData.filter[key]}\",`;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            if (filter.substr(filter.length - 1, 1) === ',') {\r\n                filter = filter.substring(0, filter.length - 1);\r\n            }\r\n            filter += '}';\r\n            filter = encodeURIComponent(filter);\r\n            query += (filter + `&pageNum=${index}&pageSize=${size}`);\r\n            url += query;\r\n        } else {\r\n            url += `?pageNum=${index}&pageSize=${size}`;\r\n        }\r\n        return this.http.get(url).pipe(\r\n            map((re: any) => ({\r\n                items: re.content,\r\n                total: re.totalElements,\r\n                pageInfo: {\r\n                    pageIndex: re.pageable.pageNumber + 1,\r\n                    pageSize: re.pageable.pageSize,\r\n                    pageList: [20, 40, 60, 80, 100],\r\n                    enablePager: true\r\n                }\r\n            }))\r\n        );\r\n    }\r\n}\r\n\r\n","import { Component, OnInit, Input, Output, EventEmitter, ViewChild } from '@angular/core';\r\nimport { Observable, of } from 'rxjs';\r\nimport { PickedResult, LookupGridComponent, ServerSideToken } from '@farris/ui-lookup';\r\nimport { WFBizProcessLookUpUIState } from './service/wf-bizprocess-lookup.uistate';\r\nimport { WFBizProcessLookUpService } from './service/wf-bizprocess-lookup.service';\r\n\r\n@Component({\r\n  selector: 'wf-bizprocess-lookup',\r\n  template: `\r\n    <farris-lookup-grid #lookup\r\n      [disabled]=\"disabled\"\r\n      [editable]=\"false\"\r\n      [bindingData]=\"bindingData\"\r\n      [(ngModel)]=\"displayTxt\"\r\n      [columns]=\"columns\"\r\n      [singleSelect]=\"singleSelect\"\r\n      [title]=\"title\"\r\n      [displayType]=\"'List'\"\r\n      [uri]=\"dataUri\"\r\n      [idField]=\"'id'\"\r\n      [pageIndex]=\"pageIndex\"\r\n      [pageSize]=\"pageSize\"\r\n      [pagination]=\"pagination\"\r\n      [valueField]=\"'id'\"\r\n      [textField]=\"'name'\"\r\n      (clear)=\"afterClear($event)\"\r\n      [dialogWidth]=\"width\"\r\n      [dictPicking]=\"beforeOpen\"\r\n      [dictPicked]=\"dictPicked\">\r\n    </farris-lookup-grid>\r\n  `,\r\n  styles: [],\r\n  providers: [{ provide: ServerSideToken, useClass: WFBizProcessLookUpService }]\r\n})\r\nexport class WfBizprocessLookupComponent implements OnInit {\r\n\r\n  /** æ é¢ */\r\n  @Input() title: string;\r\n  /** å®½åº¦ */\r\n  @Input() width = 550;\r\n  /** åæ°æº */\r\n  @Input() sourceType: 'rtProcess' | 'flowform' = 'rtProcess';\r\n  /** åªè¯» */\r\n  @Input() disabled = false;\r\n  /** æ¯å¦åé */\r\n  @Input() singleSelect = true;\r\n  /** æ¯å¦åé¡µï¼é»è®¤true */\r\n  @Input() pagination = true;\r\n  /** é¦æ¬¡å è½½ç¬¬å é¡µï¼é»è®¤1 */\r\n  @Input() pageIndex = 1;\r\n  /** æ¯é¡µå è½½æ°ï¼é»è®¤20 */\r\n  @Input() pageSize = 20;\r\n  /** ç»å®å°å¸®å©ä¸çæ°æ®ï¼åå§æ¾ç¤ºå¼ç¨ */\r\n  @Input() displayTxt: string;\r\n  /** å­å¨å¸®å©éæ©çå¯¹è±¡ */\r\n  @Input() bindingData: { id: string, name: string };\r\n  /** è¿æ»¤æ¡ä»¶ */\r\n  @Input() filter: any;\r\n\r\n  // @Input() beforeClose: (selectData: any) => Observable<PickedResult>;\r\n  /** å¸®å©éæ©åäºä»¶ */\r\n  @Output() afterConfirm: EventEmitter<any> = new EventEmitter<any>();\r\n  @Output() dialogClosed: EventEmitter<any> = new EventEmitter<any>();\r\n  @Output() clear: EventEmitter<any> = new EventEmitter<any>();\r\n  dataUri: string;\r\n  columns: any[] = [];\r\n\r\n  @ViewChild('lookup') public lookUp: LookupGridComponent;\r\n\r\n  constructor(\r\n    private uiState: WFBizProcessLookUpUIState\r\n  ) { }\r\n\r\n  ngOnInit() {\r\n    switch (this.sourceType) {\r\n      case 'rtProcess':\r\n        this.columns = [\r\n          { title: 'Keyå¼', field: 'id', width: '80', searchField: 'id', },\r\n          { title: 'åç§°', field: 'name', width: '100', searchField: 'name', }\r\n        ];\r\n        this.dataUri = this.uiState.rtProcessUri;\r\n        break;\r\n      case 'flowform':\r\n        this.columns = [\r\n          { title: 'ç¼å·', field: 'code', width: '80', searchField: 'code', },\r\n          { title: 'åç§°', field: 'name', width: '100', searchField: 'name', }\r\n        ];\r\n        this.dataUri = this.uiState.flowFormUri;\r\n        break;\r\n      default:\r\n        break;\r\n    }\r\n  }\r\n\r\n  afterClear(arg: any) {\r\n    this.clear.next(arg);\r\n  }\r\n\r\n  /** å¸®å©åäºä»¶,å¼ºè¡ä¼ éè¿æ»¤æ¡ä»¶ */\r\n  beforeOpen = (arg) => {\r\n    // if (!this.filter) {\r\n    //   // å¯è½è°ç¨æ¹ä¸ä¼ éï¼è¯å«ä¸ºéç©º\r\n    //   this.filter = {};\r\n    // }\r\n    // this.filter.pageIndex = this.pageIndex;\r\n    // this.filter.pageSize = this.pageSize;\r\n    // æè¿æ»¤æ°æ®åå½åçæ°æ®ä¼ éå°serviceå±\r\n    return of({\r\n      showDialog: true, data: {\r\n        filter: this.filter\r\n      }\r\n    });\r\n  }\r\n  dictPicked = (arg: any): Observable<PickedResult> => {\r\n    this.afterConfirm.next(arg);\r\n    return of({ closeDialog: true });\r\n  }\r\n\r\n\r\n  /** æå¨æ¾ç¤ºå¸®å© */\r\n  public showHelp() {\r\n    this.lookUp.showDialog();\r\n  }\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { WfBizprocessLookupComponent } from './wf-bizprocess-lookup.component';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FormsModule } from '@angular/forms';\r\nimport { HttpClientModule } from '@angular/common/http';\r\nimport { LookupModule } from '@farris/ui-lookup';\r\nimport { ModalModule } from '@farris/ui-modal';\r\nimport { MessagerModule } from '@farris/ui-messager';\r\nimport { HttpService } from '@ecp-caf/caf-common';\r\nimport { WFBizProcessLookUpUIState } from './service/wf-bizprocess-lookup.uistate';\r\n\r\n@NgModule({\r\n  declarations: [WfBizprocessLookupComponent],\r\n  imports: [\r\n    CommonModule,\r\n    FormsModule,\r\n    HttpClientModule,\r\n    LookupModule,\r\n    ModalModule.forRoot(),\r\n    MessagerModule.forRoot(),\r\n  ],\r\n  providers: [\r\n    HttpService,\r\n    WFBizProcessLookUpUIState\r\n  ],\r\n  exports: [WfBizprocessLookupComponent]\r\n})\r\nexport class WfBizprocessLookupModule { }\r\n"],"names":[],"mappings":"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"}
